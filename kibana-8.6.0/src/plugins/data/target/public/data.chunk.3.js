(window.data_bundle_jsonpfunction=window.data_bundle_jsonpfunction||[]).push([[3],{117:function(e,a,t){"use strict";t.r(a),t.d(a,"default",(function(){return O}));var s=t(10),r=t.n(s),o=t(47),i=t(14),l=t(30),n=t(25),d=t(0),c=t(99),u=t(100),h=t(8);function p(e){return["shard","index","node"].filter((a=>"number"==typeof e[a]||"string"==typeof e[a])).map((a=>({key:a,value:String(e[a])})))}function j(e,a){const t=e.reason.type,s="string"==typeof a?a:function(e){return p(e).map((({key:e,value:a})=>`${e}: ${a}`)).join(", ")}(e);return d.i18n.translate("data.search.searchSource.fetch.shardsFailedModal.failureHeader",{defaultMessage:"{failureName} at {failureDetails}",values:{failureName:t,failureDetails:s},description:'Summary of shard failures, e.g. "IllegalArgumentException at shard 0 node xyz"'})}function b(e){const a=p(e).map((e=>Object(h.jsx)("span",{className:"shardFailureModal__keyValueTitle",key:e.key},Object(h.jsx)(i.EuiCode,null,e.key)," ",e.value)));return Object(h.jsx)(i.EuiTitle,{size:"xs"},Object(h.jsx)("h2",null,j(e,""),a))}function f(e){return(e.charAt(0).toUpperCase()+e.slice(1)).replace(/[\._]/g," ")}function M(e,a){if("script"===a||"script_stack"===a){const a=Array.isArray(e)?e.join("\n"):String(e);return Object(h.jsx)(i.EuiCodeBlock,{language:"java",paddingSize:"s",isCopyable:!0},a)}return String(e)}function x(e){const a=Object(u.getFlattenedObject)(e.reason),t=Object.entries(a).map((([e,a])=>({title:f(e),description:M(a,e)})));return Object(h.jsx)("div",null,Object(h.jsx)(b,e),Object(h.jsx)(i.EuiSpacer,{size:"m"}),Object(h.jsx)(i.EuiDescriptionList,{listItems:t,type:"column",compressed:!0,className:"shardFailureModal__desc",titleProps:{className:"shardFailureModal__descTitle"},descriptionProps:{className:"shardFailureModal__descValue"}}))}function g({failures:e}){const a=e.map(((e,a)=>({id:String(a),...e}))),[t,r]=Object(s.useState)({}),o=[{align:c.RIGHT_ALIGNMENT,width:"40px",isExpander:!0,render:e=>{const a=j(e),s=d.i18n.translate("data.search.searchSource.fetch.shardsFailedModal.tableRowCollapse",{defaultMessage:"Collapse {rowDescription}",description:"Collapse a row of a table with failures",values:{rowDescription:a}}),o=d.i18n.translate("data.search.searchSource.fetch.shardsFailedModal.tableRowExpand",{defaultMessage:"Expand {rowDescription}",description:"Expand a row of a table with failures",values:{rowDescription:a}});return Object(h.jsx)(i.EuiButtonIcon,{onClick:()=>{const a=Object.assign({},t);a[e.id]?delete a[e.id]:a[e.id]=Object(h.jsx)(x,e),r(a)},"aria-label":t[e.id]?s:o,iconType:t[e.id]?"arrowUp":"arrowDown"})}},{field:"shard",name:d.i18n.translate("data.search.searchSource.fetch.shardsFailedModal.tableColShard",{defaultMessage:"Shard"}),sortable:!0,truncateText:!0,width:"80px"},{field:"index",name:d.i18n.translate("data.search.searchSource.fetch.shardsFailedModal.tableColIndex",{defaultMessage:"Index"}),sortable:!0,truncateText:!0},{field:"node",name:d.i18n.translate("data.search.searchSource.fetch.shardsFailedModal.tableColNode",{defaultMessage:"Node"}),sortable:!0,truncateText:!0},{field:"reason.type",name:d.i18n.translate("data.search.searchSource.fetch.shardsFailedModal.tableColReason",{defaultMessage:"Reason"}),truncateText:!0}];return Object(h.jsx)(i.EuiInMemoryTable,{itemId:"id",items:a,columns:o,pagination:!0,sorting:{sort:{field:"index",direction:"desc"}},itemIdToExpandedRowMap:t})}function m({request:e,response:a,title:t,onClose:s}){if(!(a&&a._shards&&Array.isArray(a._shards.failures)&&e))return Object(h.jsx)(i.EuiCallOut,{title:"Sorry, there was an error",color:"danger",iconType:"alert"},"The ShardFailureModal component received invalid properties");const l=a._shards.failures,n=JSON.stringify(e,null,2),c=JSON.stringify(a,null,2),u=[{id:"table",name:d.i18n.translate("data.search.searchSource.fetch.shardsFailedModal.tabHeaderShardFailures",{defaultMessage:"Shard failures",description:"Name of the tab displaying shard failures"}),content:Object(h.jsx)(g,{failures:l}),"data-test-subj":"shardFailuresModalShardButton"},{id:"json-request",name:d.i18n.translate("data.search.searchSource.fetch.shardsFailedModal.tabHeaderRequest",{defaultMessage:"Request",description:"Name of the tab displaying the JSON request"}),content:Object(h.jsx)(i.EuiCodeBlock,{language:"json",isCopyable:!0,"data-test-subj":"shardsFailedModalRequestBlock"},n),"data-test-subj":"shardFailuresModalRequestButton"},{id:"json-response",name:d.i18n.translate("data.search.searchSource.fetch.shardsFailedModal.tabHeaderResponse",{defaultMessage:"Response",description:"Name of the tab displaying the JSON response"}),content:Object(h.jsx)(i.EuiCodeBlock,{language:"json",isCopyable:!0,"data-test-subj":"shardsFailedModalResponseBlock"},c),"data-test-subj":"shardFailuresModalResponseButton"}];return Object(h.jsx)(r.a.Fragment,null,Object(h.jsx)(i.EuiModalHeader,null,Object(h.jsx)(i.EuiModalHeaderTitle,{"data-test-subj":"shardFailureModalTitle"},t)),Object(h.jsx)(i.EuiModalBody,null,Object(h.jsx)(i.EuiTabbedContent,{tabs:u,initialSelectedTab:u[0],autoFocus:"selected"})),Object(h.jsx)(i.EuiModalFooter,null,Object(h.jsx)(i.EuiCopy,{textToCopy:c},(e=>Object(h.jsx)(i.EuiButtonEmpty,{onClick:e},Object(h.jsx)(o.FormattedMessage,{id:"data.search.searchSource.fetch.shardsFailedModal.copyToClipboard",defaultMessage:"Copy response to clipboard"})))),Object(h.jsx)(i.EuiButton,{onClick:()=>s(),fill:!0,"data-test-subj":"closeShardFailureModal"},Object(h.jsx)(o.FormattedMessage,{id:"data.search.searchSource.fetch.shardsFailedModal.close",defaultMessage:"Close",description:"Closing the Modal"}))))}function O({getRequestMeta:e,theme:a,title:t,size:r="s",color:d="warning",isButtonEmpty:c=!1}){const u=Object(s.useCallback)((()=>{const{request:s,response:r}=e(),o=Object(n.c)().openModal(Object(l.toMountPoint)(Object(h.jsx)(m,{request:s,response:r,title:t,onClose:()=>o.close()}),{theme$:a.theme$}),{className:"shardFailureModal"})}),[e,a.theme$,t]),p=c?i.EuiLink:i.EuiButton;return Object(h.jsx)(p,{color:d,size:r,onClick:u,"data-test-subj":"openShardFailureModalBtn"},Object(h.jsx)(o.FormattedMessage,{id:"data.search.searchSource.fetch.shardsFailedModal.showDetails",defaultMessage:"Show details",description:"Open the modal to show details"}))}}}]);