!function(e){function t(t){for(var n,a,o=t[0],s=t[1],i=0,c=[];i<o.length;i++)a=o[i],Object.prototype.hasOwnProperty.call(r,a)&&r[a]&&c.push(r[a][0]),r[a]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);for(l&&l(t);c.length;)c.shift()()}var n={},r={0:0};function a(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.e=function(e){var t=[],n=r[e];if(0!==n)if(n)t.push(n[2]);else{var o=new Promise((function(t,a){n=r[e]=[t,a]}));t.push(n[2]=o);var s,i=document.createElement("script");i.charset="utf-8",i.timeout=120,a.nc&&i.setAttribute("nonce",a.nc),i.src=function(e){return a.p+"visTypeHeatmap.chunk."+e+".js"}(e);var l=new Error;s=function(t){i.onerror=i.onload=null,clearTimeout(c);var n=r[e];if(0!==n){if(n){var a=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+a+": "+o+")",l.name="ChunkLoadError",l.type=a,l.request=o,n[1](l)}r[e]=void 0}};var c=setTimeout((function(){s({type:"timeout",target:i})}),12e4);i.onerror=i.onload=s,document.head.appendChild(i)}return Promise.all(t)},a.m=e,a.c=n,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a.oe=function(e){throw console.error(e),e};var o=window.visTypeHeatmap_bundle_jsonpfunction=window.visTypeHeatmap_bundle_jsonpfunction||[],s=o.push.bind(o);o.push=t,o=o.slice();for(var i=0;i<o.length;i++)t(o[i]);var l=s;a(a.s=17)}([function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/expressions/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/visualizations/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t){e.exports=__kbnSharedDeps__.KbnI18n},function(e,t){e.exports=__kbnSharedDeps__.EmotionReact},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/data/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t){e.exports=__kbnSharedDeps__.React},function(e,t,n){"use strict";n.r(t),n.d(t,"LEGACY_HEATMAP_CHARTS_LIBRARY",(function(){return r}));const r="visualization:visualize:legacyHeatmapChartsLibrary"},function(e,t,n){"use strict";let r,a,o;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a})),function(e){e.Linear="linear",e.Log="log",e.SquareRoot="square root"}(r||(r={})),function(e){e.Category="category",e.Value="value"}(a||(a={})),function(e){e.Normal="normal",e.Percentage="percentage",e.Wiggle="wiggle",e.Silhouette="silhouette"}(o||(o={}))},function(e,t,n){var r=n(20),a=n(21),o=a;o.v1=r,o.v4=a,e.exports=o},function(e,t){e.exports=__kbnSharedDeps__.ElasticCharts},function(e,t){e.exports=__kbnSharedDeps__.KbnI18nReact},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/charts/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t,n){e.exports=n(19)(3)},function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var a=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),a[t]=e>>>((3&t)<<3)&255;return a}}},function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,a=n;return[a[e[r++]],a[e[r++]],a[e[r++]],a[e[r++]],"-",a[e[r++]],a[e[r++]],"-",a[e[r++]],a[e[r++]],"-",a[e[r++]],a[e[r++]],"-",a[e[r++]],a[e[r++]],a[e[r++]],a[e[r++]],a[e[r++]],a[e[r++]]].join("")}},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/charts/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/kibanaUtils/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t,n){n(18),__kbnBundles__.define("plugin/visTypeHeatmap/public",n,22),__kbnBundles__.define("plugin/visTypeHeatmap/common/index",n,6)},function(e,t,n){n.p=window.__kbnPublicPath__.visTypeHeatmap},function(e,t){e.exports=__kbnSharedDeps_npm__},function(e,t,n){var r,a,o=n(13),s=n(14),i=0,l=0;e.exports=function(e,t,n){var c=t&&n||0,u=t||[],p=(e=e||{}).node||r,d=void 0!==e.clockseq?e.clockseq:a;if(null==p||null==d){var g=o();null==p&&(p=r=[1|g[0],g[1],g[2],g[3],g[4],g[5]]),null==d&&(d=a=16383&(g[6]<<8|g[7]))}var m=void 0!==e.msecs?e.msecs:(new Date).getTime(),f=void 0!==e.nsecs?e.nsecs:l+1,b=m-i+(f-l)/1e4;if(b<0&&void 0===e.clockseq&&(d=d+1&16383),(b<0||m>i)&&void 0===e.nsecs&&(f=0),f>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");i=m,l=f,a=d;var h=(1e4*(268435455&(m+=122192928e5))+f)%4294967296;u[c++]=h>>>24&255,u[c++]=h>>>16&255,u[c++]=h>>>8&255,u[c++]=255&h;var v=m/4294967296*1e4&268435455;u[c++]=v>>>8&255,u[c++]=255&v,u[c++]=v>>>24&15|16,u[c++]=v>>>16&255,u[c++]=d>>>8|128,u[c++]=255&d;for(var _=0;_<6;++_)u[c+_]=p[_];return t||s(u)}},function(e,t,n){var r=n(13),a=n(14);e.exports=function(e,t,n){var o=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var s=(e=e||{}).random||(e.rng||r)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t)for(var i=0;i<16;++i)t[o+i]=s[i];return t||a(s)}},function(e,t,n){"use strict";n.r(t),n.d(t,"heatmapVisType",(function(){return M})),n.d(t,"plugin",(function(){return H}));var r=n(6),a=n(5),o=n(2),s=n(9),i=n(4),l=n(11),c=n(1),u=n(7),p=n(0),d=n(15);const g="rgba(0, 0, 0, 0)",m=(e,t,n,r=!1)=>{const a=r?1-e/t:e/t;return Object(d.getHeatmapColors)(a,n)},f=(e,t,n=!1,r=!1)=>{const a=[],o=[];if(!e)return{color:[]};r&&(a.push(g),o.push(0));const s=100/e;for(let r=0;r<e;r++)a.push(m(r,e,t,n)),o.push(s+r*s);return{color:null!=a?a:[],stop:null!=o?o:[]}},b=e=>{var t,n;const r=Object(p.buildExpressionFunction)("heatmap_legend",{isVisible:e.addLegend,position:e.legendPosition,shouldTruncate:null===(t=e.truncateLegend)||void 0===t||t,maxLines:null!==(n=e.maxLegendLines)&&void 0!==n?n:1,legendSize:e.legendSize});return Object(p.buildExpression)([r])},h=e=>{const t=Object(p.buildExpressionFunction)("visdimension",{accessor:e.accessor});return e.format&&(t.addArgument("format",e.format.id),t.addArgument("formatParams",JSON.stringify(e.format.params))),Object(p.buildExpression)([t])},v=e=>{var t,n;const r=Object(p.buildExpressionFunction)("heatmap_grid",{isCellLabelVisible:null!==(t=null===(n=e.valueAxes)||void 0===n?void 0:n[0].labels.show)&&void 0!==t&&t,isXAxisLabelVisible:!0,isYAxisLabelVisible:!0,isYAxisTitleVisible:!0,isXAxisTitleVisible:!0});return Object(p.buildExpression)([r])},_=async(e,t)=>{var n;const r=Object(c.getVisSchemas)(e,t);!0===e.params.percentageMode&&r.metric.forEach((t=>{var n;t.format={id:"percent",params:{pattern:null!==(n=e.params.percentageFormatPattern)&&void 0!==n?n:`0,0.[${"0".repeat(2)}]%`}}}));const a={showTooltip:e.params.addTooltip,highlightInHover:e.params.enableHover,lastRangeIsRightOpen:null!==(n=e.params.lastRangeIsRightOpen)&&void 0!==n&&n,percentageMode:e.params.percentageMode,legend:b(e.params),gridConfig:v(e.params)},o=Object(p.buildExpressionFunction)("heatmap",a);let s;if(r.metric.length&&o.addArgument("valueAccessor",h(r.metric[0])),r.segment&&r.segment.length&&o.addArgument("xAccessor",h(r.segment[0])),r.group&&r.group.length&&o.addArgument("yAccessor",h(r.group[0])),r.split_row&&r.split_row.length&&o.addArgument("splitRowAccessor",h(r.split_row[0])),r.split_column&&r.split_column.length&&o.addArgument("splitColumnAccessor",h(r.split_column[0])),e.params.setColorRange&&e.params.colorsRange&&e.params.colorsRange.length){var i;const t=((e,t,n=!1)=>e.reduce(((e,r,a,o)=>(a&&r.from!==o[a-1].to&&(e.color.push(g),e.stop.push(r.from)),e.color.push(m(a,o.length,t,n)),e.stop.push(r.to),e)),{color:[],stop:[]}))(e.params.colorsRange,e.params.colorSchema,e.params.invertColors);s=Object(p.buildExpressionFunction)("palette",{...t,range:"number",continuity:"none",rangeMin:e.params.setColorRange&&e.params.colorsRange&&e.params.colorsRange.length?e.params.colorsRange[0].from:void 0,rangeMax:e.params.setColorRange&&e.params.colorsRange&&e.params.colorsRange.length?e.params.colorsRange[(null===(i=e.params)||void 0===i?void 0:i.colorsRange.length)-1].to:void 0})}else{const t=f(e.params.colorsNumber,e.params.colorSchema,e.params.invertColors);s=Object(p.buildExpressionFunction)("palette",{...t,range:"percent",continuity:"none",rangeMin:0,rangeMax:100})}return o.addArgument("palette",Object(p.buildExpression)([s])),Object(p.buildExpression)([o]).toAst()};var y=n(12),x=n.n(y),O=n(3);const w=Object(a.lazy)((()=>n.e(1).then(n.bind(null,25)))),T=({showElasticChartsOptions:e,palettes:t})=>n=>Object(O.jsx)(w,x()({},n,{palettes:t,showElasticChartsOptions:e}));var j=n(10);function A(){return Object(O.jsx)(j.FormattedMessage,{id:"visTypeHeatmap.splitTitle.tooltip",defaultMessage:"Split chart aggregation is not yet supported with the new charts library. Please enable the heatmap legacy charts library advanced setting to use split chart aggregation."})}var C=n(8),P=n.n(C),R=n(16);const[S,k]=Object(R.createGetterSetter)("dataViews"),E=e=>{if((e=>!!e.meta)(e)){const{meta:t,...n}=e;return n}return e},V=async(e,t)=>{var n;if(!t)return null;const r=S(),a=await Object(c.getDataViewByIndexPatternId)(null===(n=e.data.indexPattern)||void 0===n?void 0:n.id,r);if(!a)return null;const{getColumnsFromVis:o,convertToFiltersColumn:s}=await c.convertToLensModule,i=o(e,t,a,{buckets:["segment"],splits:["group"],unsupported:["split_row","split_column"]});if(null===i)return null;const[l]=i,u=l.columns.find((({isBucketed:e,isSplit:t})=>e&&!t)),p=null!=u?u:s(P()(),{filters:[{input:{language:"lucene",query:"*"}}]});(null==u?void 0:u.columnId)!==(null==p?void 0:p.columnId)&&(l.buckets.all.push(p.columnId),l.columns.push(p));const d=l.columns.find((({isBucketed:e,isSplit:t})=>e&&t));if(!l.buckets.all.length||l.metrics.length>1)return null;const g=P()(),m=a.id,b=await(async(e,t,{metrics:n,buckets:r})=>{var a,o,s;const[i]=n,[l,u]=r,{params:p,uiState:d}=t,g=null!==(a=d.get("vis",{}))&&void 0!==a?a:{},m=await(async e=>{const{getPalette:t,getPaletteFromStopsWithColors:n,getPercentageModeConfig:r}=await c.convertToLensModule;if((e=>Boolean(e.setColorRange&&e.colorsRange&&e.colorsRange.length))(e))return t(e,r(e,!1),e.percentageMode);const{color:a,stop:o=[]}=f(e.colorsNumber,e.colorSchema,e.invertColors,!0),s=[{from:o[0],to:o[o.length-1],type:"range"}],{colorSchema:i,invertColors:l}=e;return n({color:a,stop:null!=o?o:[]},r({colorsRange:s,colorSchema:i,invertColors:l,percentageMode:!0},!1),!0)})(p);return{layerId:e,layerType:"data",shape:"heatmap",legend:{type:"heatmap_legend",isVisible:g.legendOpen,position:p.legendPosition},gridConfig:{type:"heatmap_grid",isCellLabelVisible:null!==(o=null===(s=p.valueAxes)||void 0===s?void 0:s[0].labels.show)&&void 0!==o&&o,isXAxisLabelVisible:!0,isYAxisLabelVisible:!0,isYAxisTitleVisible:!0,isXAxisTitleVisible:!0},valueAccessor:i,xAccessor:l,yAccessor:u,palette:m?{...m,accessor:i}:void 0}})(g,e,{metrics:l.metrics,buckets:[p.columnId,null==d?void 0:d.columnId].filter((e=>Boolean(e)))});return{type:"lnsHeatmap",layers:[{indexPatternId:m,layerId:g,columns:l.columns.map(E),columnOrder:[]}],configuration:b,indexPatternIds:[m]}},M=e=>(({showElasticChartsOptions:e=!1,palettes:t})=>({name:"heatmap",title:o.i18n.translate("visTypeHeatmap.heatmap.heatmapTitle",{defaultMessage:"Heat map"}),icon:"heatmap",description:o.i18n.translate("visTypeHeatmap.heatmap.heatmapDescription",{defaultMessage:"Display values as colors in a matrix."}),fetchDatatable:!0,toExpressionAst:_,getSupportedTriggers:()=>[c.VIS_EVENT_TO_TRIGGER.filter],visConfig:{defaults:{type:"heatmap",addTooltip:!0,addLegend:!0,enableHover:!1,legendPosition:s.Position.Right,colorsNumber:4,colorSchema:l.ColorSchemas.GreenToRed,setColorRange:!1,colorsRange:[],invertColors:!1,percentageMode:!1,valueAxes:[{show:!1,id:"ValueAxis-1",type:u.a.Value,scale:{type:u.b.Linear,defaultYExtents:!1},labels:{show:!1,rotate:0,overwriteColor:!1,color:"black"}}]}},editorConfig:{enableDataViewChange:!0,optionsTemplate:T({showElasticChartsOptions:e,palettes:t}),schemas:[{group:i.AggGroupNames.Metrics,name:"metric",title:o.i18n.translate("visTypeHeatmap.heatmap.metricTitle",{defaultMessage:"Value"}),min:1,max:1,aggFilter:["count","avg","median","sum","min","max","cardinality","std_dev","top_hits","!filtered_metric","!single_percentile","!single_percentile_rank"],defaults:[{schema:"metric",type:"count"}]},{group:i.AggGroupNames.Buckets,name:"segment",title:o.i18n.translate("visTypeHeatmap.heatmap.segmentTitle",{defaultMessage:"X-axis"}),min:0,max:1,aggFilter:["!geohash_grid","!geotile_grid","!filter","!sampler","!diversified_sampler","!rare_terms","!multi_terms","!significant_text"]},{group:i.AggGroupNames.Buckets,name:"group",title:o.i18n.translate("visTypeHeatmap.heatmap.groupTitle",{defaultMessage:"Y-axis"}),min:0,max:1,aggFilter:["!geohash_grid","!geotile_grid","!filter","!sampler","!diversified_sampler","!rare_terms","!multi_terms","!significant_text"]},{group:i.AggGroupNames.Buckets,name:"split",...e&&{disabled:!0,tooltip:Object(O.jsx)(A,null)},title:o.i18n.translate("visTypeHeatmap.heatmap.splitTitle",{defaultMessage:"Split chart"}),min:0,max:1,aggFilter:["!geohash_grid","!geotile_grid","!filter","!sampler","!diversified_sampler","!rare_terms","!multi_terms","!significant_text"]}]},requiresSearch:!0,navigateToLens:async(e,t)=>e?V(e,t):null,getExpressionVariables:async(e,t)=>({canNavigateToLens:Boolean(null!=e&&e.params?await V(e,t):null)})}))(e);class plugin_VisTypeHeatmapPlugin{setup(e,{visualizations:t,charts:n,usageCollection:a}){return e.uiSettings.get(r.LEGACY_HEATMAP_CHARTS_LIBRARY)||t.createBaseVisualization(M({showElasticChartsOptions:!0,palettes:n.palettes})),{}}start(e,{dataViews:t}){k(t)}}const H=()=>new plugin_VisTypeHeatmapPlugin},function(e,t){e.exports=__kbnSharedDeps__.ElasticEui},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/visDefaultEditor/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))}]);