(window.dataViewManagement_bundle_jsonpfunction=window.dataViewManagement_bundle_jsonpfunction||[]).push([[1],Array(23).concat([function(e,t,a){"use strict";a.r(t),a.d(t,"mountManagementSection",(function(){return la}));var n=a(6),i=a.n(n),s=a(16),r=a.n(s),l=a(10),d=a(0),o=a(8),c=a(9),u=a(7),p=a(5),m={name:"1azakc",styles:"text-align:center"},g=function(){var e=m;return Object(p.jsx)("div",{css:e},Object(p.jsx)(u.EuiLoadingSpinner,null))},b=a(25),j=a.n(b);function x(e){var t=e.href;return Object(p.jsx)("dl",null,Object(p.jsx)(u.EuiTitle,{size:"xxs"},Object(p.jsx)("dt",{className:"eui-displayInline"},Object(p.jsx)(o.FormattedMessage,{id:"sharedUXPackages.noDataViewsPrompt.learnMore",defaultMessage:"Want to learn more?"}))),"â€ƒ",Object(p.jsx)("dd",{className:"eui-displayInline"},Object(p.jsx)(u.EuiLink,{href:t,target:"_blank",external:!0},Object(p.jsx)(o.FormattedMessage,{id:"sharedUXPackages.noDataViewsPrompt.readDocumentation",defaultMessage:"Read the docs"}))))}var f=d.i18n.translate("sharedUXPackages.noDataViewsPrompt.addDataViewText",{defaultMessage:"Create data view"}),h=function(e){var t=e.onClickCreate,s=e.canCreateNewDataView,r=e.dataViewsDocLink,l=e.emptyPromptColor,d=void 0===l?"plain":l,c=s&&Object(p.jsx)(u.EuiButton,{onClick:t,iconType:"plusInCircle",fill:!0,"data-test-subj":"createDataViewButton"},f),m=s?Object(p.jsx)("h2",null,Object(p.jsx)(o.FormattedMessage,{id:"sharedUXPackages.noDataViewsPrompt.youHaveData",defaultMessage:"You have data in Elasticsearch."}),Object(p.jsx)("br",null),Object(p.jsx)(o.FormattedMessage,{id:"sharedUXPackages.noDataViewsPrompt.nowCreate",defaultMessage:"Now, create a data view."})):Object(p.jsx)("h2",null,Object(p.jsx)(o.FormattedMessage,{id:"sharedUXPackages.noDataViewsPrompt.noPermission.title",defaultMessage:"You need permission to create data views"})),b=s?Object(p.jsx)("p",null,Object(p.jsx)(o.FormattedMessage,{id:"sharedUXPackages.noDataViewsPrompt.dataViewExplanation",defaultMessage:"Data views identify the Elasticsearch data you want to explore. You can point data views to one or more data streams, indices, and index aliases, such as your log data from yesterday, or all indices that contain your log data."})):Object(p.jsx)("p",null,Object(p.jsx)(o.FormattedMessage,{id:"sharedUXPackages.noDataViewsPrompt.noPermission.dataViewExplanation",defaultMessage:"Data views identify the Elasticsearch data that you want to explore. To create data views, ask your administrator for the required permissions."})),h=r?Object(p.jsx)(x,{href:r}):void 0,O=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object(p.jsx)(g,null);return i.a.forwardRef((function(a,i){return Object(p.jsx)(u.EuiErrorBoundary,null,Object(p.jsx)(n.Suspense,{fallback:t},Object(p.jsx)(e,j()({},a,{ref:i}))))}))}(i.a.lazy((function(){return a.e(2).then(a.bind(null,54)).then((function(e){return{default:e.DataViewIllustration}}))})),Object(p.jsx)(u.EuiPanel,{color:"subdued",style:{width:226,height:206}})),M=Object(p.jsx)(O,null);return Object(p.jsx)(u.EuiEmptyPrompt,{"data-test-subj":"noDataViewsPrompt",layout:"horizontal",css:Object(p.css)("max-width:",830,"px!important;flex-grow:0;",""),color:d,actions:c,icon:M,title:m,body:b,footer:h})},O=a(26),M=a.n(O);a(32);const y=({onRefresh:e,createAnyway:t,canSaveIndexPattern:a,addDataUrl:n,navigateToApp:s})=>{const r=Object(p.jsx)(u.EuiText,{color:"subdued",textAlign:"center",size:"xs"},Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.createDataView.emptyState.createAnywayTxt",defaultMessage:"You can also {link}",values:{link:Object(p.jsx)(u.EuiLink,{onClick:()=>t(),"data-test-subj":"createAnyway"},Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.createDataView.emptyState.createAnywayLink",defaultMessage:"create a data view against hidden, system or default indices."}))}}));return Object(p.jsx)(i.a.Fragment,null,Object(p.jsx)(u.EuiPageContent_Deprecated,{className:"inpEmptyState",grow:!1,"data-test-subj":"indexPatternEmptyState",verticalPosition:"center",horizontalPosition:"center",color:"subdued"},Object(p.jsx)(u.EuiPageContentHeader_Deprecated,null,Object(p.jsx)(u.EuiPageContentHeaderSection_Deprecated,null,Object(p.jsx)(u.EuiTitle,null,Object(p.jsx)("h2",null,Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.createDataView.emptyState.noDataTitle",defaultMessage:"Ready to try Kibana? First, you need data."}))))),Object(p.jsx)(u.EuiSpacer,{size:"m"}),Object(p.jsx)(u.EuiPageContentBody_Deprecated,null,Object(p.jsx)(u.EuiFlexGrid,{className:"inpEmptyState__cardGrid",columns:3,responsive:!0},Object(p.jsx)(u.EuiFlexItem,null,Object(p.jsx)(u.EuiCard,{className:"inpEmptyState__card",onClick:()=>{s("integrations",{path:"/browse"})},icon:Object(p.jsx)(u.EuiIcon,{size:"xl",type:"database",color:"subdued"}),title:Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.createDataView.emptyState.integrationCardTitle",defaultMessage:"Add integration"}),description:Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.createDataView.emptyState.integrationCardDescription",defaultMessage:"Add data from a variety of sources."})})),Object(p.jsx)(u.EuiFlexItem,null,Object(p.jsx)(u.EuiCard,{onClick:()=>s("home",{path:"#/tutorial_directory/fileDataViz"}),className:"inpEmptyState__card",icon:Object(p.jsx)(u.EuiIcon,{size:"xl",type:"document",color:"subdued"}),title:Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.createDataView.emptyState.uploadCardTitle",defaultMessage:"Upload a file"}),description:Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.createDataView.emptyState.uploadCardDescription",defaultMessage:"Import a CSV, NDJSON, or log file."})})),Object(p.jsx)(u.EuiFlexItem,null,Object(p.jsx)(u.EuiCard,{className:"inpEmptyState__card",onClick:()=>{s("home",{path:"#/tutorial_directory/sampleData"})},icon:Object(p.jsx)(u.EuiIcon,{size:"xl",type:"heatmap",color:"subdued"}),title:Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.createDataView.emptyState.sampleDataCardTitle",defaultMessage:"Add sample data"}),description:Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.createDataView.emptyState.sampleDataCardDescription",defaultMessage:"Load a data set and a Kibana dashboard."})}))),Object(p.jsx)(u.EuiSpacer,{size:"xxl"}),Object(p.jsx)("div",{className:"inpEmptyState__footer"},Object(p.jsx)(u.EuiFlexGroup,{justifyContent:"center"},Object(p.jsx)(u.EuiFlexItem,{grow:!1,className:"inpEmptyState__footerFlexItem"},Object(p.jsx)(u.EuiDescriptionList,{listItems:[{title:Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.createDataView.emptyState.learnMore",defaultMessage:"Want to learn more?"}),description:Object(p.jsx)(u.EuiLink,{href:n,target:"_blank",external:!0},Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.createDataView.emptyState.readDocs",defaultMessage:"Read documentation"}))}]})),Object(p.jsx)(u.EuiFlexItem,{grow:!1,className:"inpEmptyState__footerFlexItem"},Object(p.jsx)(u.EuiDescriptionList,{listItems:[{title:Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.createDataView.emptyState.haveData",defaultMessage:"Think you already have data?"}),description:Object(p.jsx)(u.EuiLink,{onClick:e,"data-test-subj":"refreshIndicesButton"},Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.createDataView.emptyState.checkDataButton",defaultMessage:"Check for new data"})," ",Object(p.jsx)(u.EuiIcon,{type:"refresh",size:"s"}))}]}))),Object(p.jsx)(u.EuiSpacer,null),a&&r))))},F=d.i18n.translate("indexPatternManagement.editIndexPattern.list.defaultIndexPatternListName",{defaultMessage:"Default"}),v=d.i18n.translate("indexPatternManagement.editIndexPattern.list.rollupIndexPatternListName",{defaultMessage:"Rollup"}),P=(e="")=>"rollup"===e,E=(e,t)=>{const a=[];return t&&a.push({key:"default",name:F}),P(e.type)&&a.push({key:"rollup",name:v}),a},S=(e,t)=>{var a;if(!P(e.type))return[];const n=null===(a=e.typeMeta)||void 0===a?void 0:a.aggs,i=n&&Object.keys(n).filter((e=>n[e][t.name]));return i&&i.length?["Rollup aggregations:"].concat(i.map((e=>{const a=n[e][t.name];switch(e){case"date_histogram":return d.i18n.translate("indexPatternManagement.editIndexPattern.list.dateHistogramSummary",{defaultMessage:"{aggName} (interval: {interval}, {delay} {time_zone})",values:{aggName:e,interval:a.fixed_interval,delay:a.delay?d.i18n.translate("indexPatternManagement.editIndexPattern.list.DateHistogramDelaySummary",{defaultMessage:"delay: {delay},",values:{delay:a.delay}}):"",time_zone:a.time_zone}});case"histogram":return d.i18n.translate("indexPatternManagement.editIndexPattern.list.histogramSummary",{defaultMessage:"{aggName} (interval: {interval})",values:{aggName:e,interval:a.interval}});default:return e}}))):[]};function T(e){return[{text:d.i18n.translate("indexPatternManagement.dataViews.listBreadcrumb",{defaultMessage:"Data views"}),href:e?"/":""}]}function w(e,t){return[...T(!0),{text:e.getName(),href:t?`/patterns/${e.id}`:""}]}var C=a(13);const I=d.i18n.translate("indexPatternManagement.indexPatternTable.savedObjectName",{defaultMessage:"data view"}),D=({spacesApi:e,capabilities:t,spaceIds:a,id:s,title:r,refresh:l})=>{const[d,o]=Object(n.useState)(!1),c=e.ui.components.getSpaceList,u=e.ui.components.getShareToSpaceFlyout,m={savedObjectTarget:{type:C.DATA_VIEW_SAVED_OBJECT_TYPE,namespaces:a,id:s,title:r,noun:I},onUpdate:l,onClose:function(){o(!1)}},g=!t||t.savedObjectsManagement.shareIntoSpace?{cursorStyle:"pointer",listOnClick:()=>o(!0)}:{cursorStyle:"not-allowed"};return Object(p.jsx)(i.a.Fragment,null,Object(p.jsx)(c,j()({namespaces:a,displayLimit:8,behaviorContext:"outside-space"},g)),d&&Object(p.jsx)(u,m))};var L=a(11),_=a(14),N=a(17);const k="indexedFields",A="scriptedFields",R="sourceFilters",B="relationships";var V=a(24),U=a.n(V),z=a(29);const H=d.i18n.translate("indexPatternManagement.editIndexPattern.sourcePlaceholder",{defaultMessage:"field filter, accepts wildcards (e.g., `user*` to filter fields starting with 'user')"}),G=({onAddFilter:e})=>{const[t,a]=Object(n.useState)(""),i=Object(n.useCallback)((()=>{e(t),a("")}),[t,e]);return Object(p.jsx)(u.EuiFlexGroup,null,Object(p.jsx)(u.EuiFlexItem,{grow:10},Object(p.jsx)(u.EuiFieldText,{fullWidth:!0,value:t,"data-test-subj":"fieldFilterInput",onChange:e=>a(e.target.value.trim()),placeholder:H})),Object(p.jsx)(u.EuiFlexItem,null,Object(p.jsx)(u.EuiButton,{"data-test-subj":"addFieldFilterButton",isDisabled:0===t.length,onClick:i},Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.source.addButtonLabel",defaultMessage:"Add"}))))},K=({filterToDeleteValue:e,onCancelConfirmationModal:t,onDeleteFilter:a})=>Object(p.jsx)(u.EuiConfirmModal,{title:Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.source.deleteSourceFilterLabel",defaultMessage:"Delete field filter '{value}'?",values:{value:e}}),onCancel:t,onConfirm:a,cancelButtonText:Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.source.deleteFilter.cancelButtonLabel",defaultMessage:"Cancel"}),buttonColor:"danger",confirmButtonText:Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.source.deleteFilter.deleteButtonLabel",defaultMessage:"Delete"}),defaultFocusedButton:u.EUI_MODAL_CONFIRM_BUTTON}),W=()=>Object(p.jsx)(i.a.Fragment,null,Object(p.jsx)(u.EuiText,{size:"s"},Object(p.jsx)("p",null,Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.sourceLabel",defaultMessage:"Field filters can be used to exclude one or more fields when fetching a document. This happens when viewing a document in the Discover app, or with a table displaying results from a saved search in the Dashboard app. If you have documents with large or unimportant fields you may benefit from filtering those out at this lower level."})),Object(p.jsx)("p",null,Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.source.noteLabel",defaultMessage:"Note that multi-fields will incorrectly appear as matches in the table below. These filters only actually apply to fields in the original source document, so matching multi-fields are not actually being filtered."}))),Object(p.jsx)(u.EuiSpacer,{size:"s"})),q=d.i18n.translate("indexPatternManagement.editIndexPattern.source.table.filterHeader",{defaultMessage:"Filter"}),$=d.i18n.translate("indexPatternManagement.editIndexPattern.source.table.filterDescription",{defaultMessage:"Filter name"}),Y=d.i18n.translate("indexPatternManagement.editIndexPattern.source.table.matchesHeader",{defaultMessage:"Matches"}),J=d.i18n.translate("indexPatternManagement.editIndexPattern.source.table.matchesDescription",{defaultMessage:"Language used for the field"}),X=d.i18n.translate("indexPatternManagement.editIndexPattern.source.table.editAria",{defaultMessage:"Edit"}),Q=d.i18n.translate("indexPatternManagement.editIndexPattern.source.table.saveAria",{defaultMessage:"Save"}),Z=d.i18n.translate("indexPatternManagement.editIndexPattern.source.table.deleteAria",{defaultMessage:"Delete"}),ee=d.i18n.translate("indexPatternManagement.editIndexPattern.source.table.cancelAria",{defaultMessage:"Cancel"});class table_Table extends n.Component{constructor(e){super(e),U()(this,"startEditingFilter",((e,t)=>this.setState({editingFilterId:e,editingFilterValue:t}))),U()(this,"stopEditingFilter",(()=>this.setState({editingFilterId:""}))),U()(this,"onEditingFilterChange",(e=>this.setState({editingFilterValue:e.target.value}))),U()(this,"onEditFieldKeyDown",(({key:e})=>{u.keys.ENTER===e&&this.state.editingFilterId&&this.state.editingFilterValue&&(this.props.saveFilter({clientId:this.state.editingFilterId,value:this.state.editingFilterValue}),this.stopEditingFilter()),u.keys.ESCAPE===e&&this.stopEditingFilter()})),this.state={editingFilterId:"",editingFilterValue:""}}getColumns(){const{deleteFilter:e,fieldWildcardMatcher:t,indexPattern:a,saveFilter:n}=this.props;return[{field:"value",name:q,description:$,dataType:"string",sortable:!0,render:(e,t)=>this.state.editingFilterId&&this.state.editingFilterId===t.clientId?Object(p.jsx)(u.EuiFieldText,{autoFocus:!0,value:this.state.editingFilterValue,onChange:this.onEditingFilterChange,onKeyDown:this.onEditFieldKeyDown}):Object(p.jsx)("span",null,e)},{field:"value",name:Y,description:J,dataType:"string",sortable:!0,render:(e,n)=>{const i=t([this.state.editingFilterId===n.clientId?this.state.editingFilterValue:e]),s=a.getNonScriptedFields().map((e=>e.name)).filter(i).sort();return s.length?Object(p.jsx)("span",null,s.join(", ")):Object(p.jsx)("em",null,Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.source.table.notMatchedLabel",defaultMessage:"The source filter doesn't match any known fields."}))}},{name:"",align:u.RIGHT_ALIGNMENT,width:"100",render:t=>this.state.editingFilterId===t.clientId?Object(p.jsx)(i.a.Fragment,null,Object(p.jsx)(u.EuiButtonIcon,{size:"s",onClick:()=>{n({clientId:this.state.editingFilterId,value:this.state.editingFilterValue}),this.stopEditingFilter()},iconType:"checkInCircleFilled","aria-label":Q}),Object(p.jsx)(u.EuiButtonIcon,{size:"s",onClick:()=>{this.stopEditingFilter()},iconType:"cross","aria-label":ee})):Object(p.jsx)(i.a.Fragment,null,Object(p.jsx)(u.EuiButtonIcon,{size:"s",onClick:()=>this.startEditingFilter(t.clientId,t.value),iconType:"pencil","aria-label":X}),Object(p.jsx)(u.EuiButtonIcon,{size:"s",color:"danger",onClick:()=>e(t),iconType:"trash","aria-label":Z}))}]}render(){const{items:e,isSaving:t}=this.props,a=this.getColumns();return Object(p.jsx)(u.EuiInMemoryTable,{loading:t,items:e,columns:a,pagination:{initialPageSize:10,pageSizeOptions:[5,10,25,50]},sorting:!0})}}class source_filters_table_SourceFiltersTable extends n.Component{constructor(e){super(e),U()(this,"clientSideId",0),U()(this,"updateFilters",(()=>{const e=(this.props.indexPattern.sourceFilters||[]).map((e=>({...e,clientId:++this.clientSideId})));this.setState({filters:e})})),U()(this,"getFilteredFilters",Object(z.createSelector)((e=>e.filters),((e,t)=>t.filterFilter),((e,t)=>{if(t){const a=t.toLowerCase();return e.filter((e=>e.value.toLowerCase().includes(a)))}return e}))),U()(this,"startDeleteFilter",(e=>{this.setState({filterToDelete:e,isDeleteConfirmationModalVisible:!0})})),U()(this,"hideDeleteConfirmationModal",(()=>{this.setState({filterToDelete:void 0,isDeleteConfirmationModalVisible:!1})})),U()(this,"deleteFilter",(async()=>{const{indexPattern:e,onAddOrRemoveFilter:t,saveIndexPattern:a}=this.props,{filterToDelete:n,filters:i}=this.state;e.sourceFilters=i.filter((e=>e.clientId!==(null==n?void 0:n.clientId))),this.setState({isSaving:!0}),await a(e),t&&t(),this.updateFilters(),this.setState({isSaving:!1}),this.hideDeleteConfirmationModal()})),U()(this,"onAddFilter",(async e=>{const{indexPattern:t,onAddOrRemoveFilter:a,saveIndexPattern:n}=this.props;t.sourceFilters=[...t.sourceFilters||[],{value:e}],this.setState({isSaving:!0}),await n(t),a&&a(),this.updateFilters(),this.setState({isSaving:!1})})),U()(this,"saveFilter",(async({clientId:e,value:t})=>{const{indexPattern:a,saveIndexPattern:n}=this.props,{filters:i}=this.state;a.sourceFilters=i.map((a=>a.clientId===e?{value:t,clientId:e}:a)),this.setState({isSaving:!0}),await n(a),this.updateFilters(),this.setState({isSaving:!1})})),this.state={filterToDelete:void 0,isDeleteConfirmationModalVisible:!1,isSaving:!1,filters:[]}}UNSAFE_componentWillMount(){this.updateFilters()}render(){const{indexPattern:e,fieldWildcardMatcher:t}=this.props,{isSaving:a,filterToDelete:n}=this.state,s=this.getFilteredFilters(this.state,this.props);return Object(p.jsx)(i.a.Fragment,null,Object(p.jsx)(W,null),Object(p.jsx)(G,{onAddFilter:this.onAddFilter}),Object(p.jsx)(u.EuiSpacer,{size:"l"}),Object(p.jsx)(table_Table,{isSaving:a,indexPattern:e,items:s,fieldWildcardMatcher:t,deleteFilter:this.startDeleteFilter,saveFilter:this.saveFilter}),n&&Object(p.jsx)(K,{filterToDeleteValue:n.value,onCancelConfirmationModal:this.hideDeleteConfirmationModal,onDeleteFilter:this.deleteFilter}))}}const te=e=>{var t,a;return!e.isMapped&&e.isUserEditable&&"composite"!==(null===(t=e.runtimeField)||void 0===t?void 0:t.type)||"composite"===(null===(a=e.runtimeField)||void 0===a?void 0:a.type)&&"composite"===e.type},ae=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.additionalInfoAriaLabel",{defaultMessage:"Additional field information"}),ne=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.conflictDetailIconAria",{defaultMessage:"Conflict Detail"}),ie=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.primaryTimeAriaLabel",{defaultMessage:"Primary time field"}),se=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.primaryTimeTooltip",{defaultMessage:"This field represents the time that events occurred."}),re=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.nameHeader",{defaultMessage:"Name"}),le=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.typeHeader",{defaultMessage:"Type"}),de=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.formatHeader",{defaultMessage:"Format"}),oe=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.searchableHeader",{defaultMessage:"Searchable"}),ce=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.searchableDescription",{defaultMessage:"These fields can be used in the filter bar"}),ue=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.isSearchableAria",{defaultMessage:"Is searchable"}),pe=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.aggregatableLabel",{defaultMessage:"Aggregatable"}),me=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.aggregatableDescription",{defaultMessage:"These fields can be used in visualization aggregations"}),ge=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.isAggregatableAria",{defaultMessage:"Is aggregatable"}),be=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.excludedLabel",{defaultMessage:"Excluded"}),je=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.excludedDescription",{defaultMessage:"Fields that are excluded from _source when it is fetched"}),xe=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.isExcludedAria",{defaultMessage:"Is excluded"}),fe=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.editLabel",{defaultMessage:"Edit"}),he=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.editDescription",{defaultMessage:"Edit"}),Oe=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.deleteLabel",{defaultMessage:"Delete"}),Me=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.deleteDescription",{defaultMessage:"Delete"}),ye=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.customLabelTooltip",{defaultMessage:"A custom label for the field."}),Fe=d.i18n.translate("indexPatternManagement.editDataView.fields.table.runtimeIconTipText",{defaultMessage:"This field exists on the data view only."}),ve=d.i18n.translate("indexPatternManagement.editDataView.fields.table.conflictType",{defaultMessage:"Conflict"}),Pe=e=>{const t=[];return Object.keys(e).forEach((a=>{t.push({type:a,indices:e[a].slice(0,99).join(", ")})})),t},Ee=[{field:"type",name:d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.conflictModalTypeColumn",{defaultMessage:"Type"})},{field:"indices",name:d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.conflictModalIndicesColumn",{defaultMessage:"Indices"})}];class table_table_Table extends n.PureComponent{renderBooleanTemplate(e,t){return e?Object(p.jsx)(u.EuiIcon,{type:"dot",color:"success","aria-label":t}):Object(p.jsx)("span",null)}renderFieldType(e,t){const a=t.conflictDescriptions&&t.conflictDescriptions[t.name];return Object(p.jsx)("span",null,"conflict"===e&&a?"":e,t.conflictDescriptions?((e,t,a,n)=>{const s=()=>{const s=a(Object(c.toMountPoint)((({closeFn:e,fieldName:t,conflictDescriptions:a})=>Object(p.jsx)(i.a.Fragment,null,Object(p.jsx)(u.EuiModalHeader,null,Object(p.jsx)(u.EuiModalHeaderTitle,null,Object(p.jsx)("h1",null,Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.fields.conflictModal.title",defaultMessage:"This field has a type conflict"})))),Object(p.jsx)(u.EuiModalBody,null,Object(p.jsx)(u.EuiText,null,Object(p.jsx)("p",null,Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.fields.conflictModal.description",defaultMessage:"The type of the {fieldName} field changes across indices and might not be available for search, visualizations, and other analysis.",values:{fieldName:Object(p.jsx)(u.EuiCode,null,t)}})),Object(p.jsx)(u.EuiBasicTable,{tableCaption:"Demo of EuiBasicTable",items:Pe(a),rowHeader:"firstName",columns:Ee,tableLayout:"auto"}))),Object(p.jsx)(u.EuiModalFooter,null,Object(p.jsx)(u.EuiButton,{onClick:e,fill:!0},Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.fields.conflictModal.closeBtn",defaultMessage:"Close"})))))({closeFn:()=>{s.close()},fieldName:e,conflictDescriptions:t}),{theme$:n.theme$}))};return Object(p.jsx)("span",null,Object(p.jsx)(u.EuiBadge,{color:"warning",iconType:"alert",onClick:s,iconOnClick:s,iconOnClickAriaLabel:ne,onClickAriaLabel:ne},ve))})(t.name,t.conflictDescriptions,this.props.openModal,this.props.theme):"")}render(){const{items:e,editField:t,deleteField:a,indexPattern:n}=this.props,i=[{field:"displayName",name:re,dataType:"string",sortable:!0,render:(e,t)=>((e,t)=>{return Object(p.jsx)("span",null,e.name,e.info&&e.info.length?Object(p.jsx)("span",null,"Â ",Object(p.jsx)(u.EuiIconTip,{type:"questionInCircle",color:"primary","aria-label":ae,content:e.info.map(((e,t)=>Object(p.jsx)("div",{key:t},e)))})):null,t===e.name?Object(p.jsx)("span",null,"Â ",Object(p.jsx)(u.EuiIconTip,{type:"clock",color:"primary","aria-label":ie,content:se})):null,!e.isMapped&&e.hasRuntime?Object(p.jsx)("span",null,"Â ",Object(p.jsx)(u.EuiIconTip,{type:"indexRuntime",title:(a=e,"composite"===(null===(n=a.runtimeField)||void 0===n?void 0:n.type)?"composite"!==a.type?d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.runtimeIconTipTitleCompositeSubfield",{defaultMessage:"Composite runtime subfield"}):d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.runtimeIconTipTitleComposite",{defaultMessage:"Composite runtime field"}):d.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.runtimeIconTipTitle",{defaultMessage:"Runtime field"})),content:Fe})):null,e.customLabel&&e.customLabel!==e.name?Object(p.jsx)("div",null,Object(p.jsx)(u.EuiToolTip,{content:ye},Object(p.jsx)(u.EuiBadge,{iconType:"flag",iconSide:"left"},e.customLabel))):null);var a,n})(t,n.timeFieldName),width:"38%","data-test-subj":"indexedFieldName"},{field:"type",name:le,dataType:"string",sortable:!0,render:(e,t)=>this.renderFieldType(e,t),"data-test-subj":"indexedFieldType"},{field:"format",name:de,dataType:"string",sortable:!0},{field:"searchable",name:oe,description:ce,dataType:"boolean",sortable:!0,render:e=>this.renderBooleanTemplate(e,ue)},{field:"aggregatable",name:pe,description:me,dataType:"boolean",sortable:!0,render:e=>this.renderBooleanTemplate(e,ge)},{field:"excluded",name:be,description:je,dataType:"boolean",sortable:!0,render:e=>this.renderBooleanTemplate(e,xe)},{name:"",actions:[{name:fe,description:he,icon:"pencil",onClick:t,type:"icon","data-test-subj":"editFieldFormat",available:e=>e.isUserEditable}],width:"40px"},{name:"",actions:[{name:Oe,description:Me,icon:"trash",onClick:e=>{var t,n;const i=[e.name];if(null!==(t=e.spec)&&void 0!==t&&null!==(n=t.runtimeField)&&void 0!==n&&n.fields){const t=Object.keys(e.spec.runtimeField.fields).map((t=>`${e.name}.${t}`));i.push(...t)}a(i)},type:"icon","data-test-subj":"deleteField",available:te}],width:"40px"}];return Object(p.jsx)(u.EuiInMemoryTable,{items:e,columns:i,pagination:{initialPageSize:10,pageSizeOptions:[5,10,25,50]},sorting:{sort:{field:"displayName",direction:"asc"}}})}}class indexed_fields_table_IndexedFieldsTable extends n.Component{constructor(e){super(e),U()(this,"getFilteredFields",Object(z.createSelector)((e=>e.fields),((e,t)=>t.fieldFilter),((e,t)=>t.indexedFieldTypeFilter),((e,t)=>t.schemaFieldTypeFilter),((e,t,a,n)=>{if(t){const a=t.toLowerCase();e=e.filter((e=>e.name.toLowerCase().includes(a)||e.displayName&&e.displayName.toLowerCase().includes(a)))}return a.length&&(e=e.filter((e=>{var t,n,i;return!(!a.includes("conflict")||"conflict"!==e.kbnType)||!!("runtimeField"in e&&null!==(t=e.runtimeField)&&void 0!==t&&t.type&&a.includes(null===(n=e.runtimeField)||void 0===n?void 0:n.type))||(null===(i=e.esTypes)||void 0===i?void 0:i.length)&&e.esTypes.filter((e=>a.includes(e))).length}))),n.length&&(e=e.filter((e=>n.includes("runtime")&&"runtimeField"in e||n.includes("indexed")&&!("runtimeField"in e)))),e}))),this.state={fields:[...this.mapCompositeRuntimeFields(this.props.compositeRuntimeFields),...this.mapFields(this.props.fields)]}}UNSAFE_componentWillReceiveProps(e){e.fields===this.props.fields&&e.compositeRuntimeFields===this.props.compositeRuntimeFields||this.setState({fields:[...this.mapCompositeRuntimeFields(e.compositeRuntimeFields),...this.mapFields(e.fields)]})}mapFields(e){const{indexPattern:t,fieldWildcardMatcher:a,helpers:n,userEditPermission:i}=this.props,s=a(t.sourceFilters&&t.sourceFilters.map((e=>e.value))||[]);return e&&e.map((e=>{var a,r,l;return{...e.spec,type:(null===(a=e.esTypes)||void 0===a?void 0:a.join(", "))||"",kbnType:e.type,displayName:e.displayName,format:(null===(r=t.getFormatterForFieldNoDefault(e.name))||void 0===r||null===(l=r.type)||void 0===l?void 0:l.title)||"",excluded:!!s&&s(e.name),info:n.getFieldInfo&&n.getFieldInfo(t,e),isMapped:!!e.isMapped,isUserEditable:i,hasRuntime:!!e.runtimeField}}))||[]}mapCompositeRuntimeFields(e){const{indexPattern:t,fieldWildcardMatcher:a,userEditPermission:n}=this.props,i=a(t.sourceFilters&&t.sourceFilters.map((e=>e.value))||[]);return Object.entries(e).map((([e,t])=>({spec:{searchable:!1,aggregatable:!1,name:e,type:"composite",runtimeField:{type:"composite",script:t.script,fields:t.fields}},name:e,type:"composite",kbnType:"",displayName:e,excluded:!!i&&i(e),info:[],isMapped:!1,isUserEditable:n,hasRuntime:!0,runtimeField:{type:"composite",script:t.script,fields:t.fields}})))}render(){const{indexPattern:e}=this.props,t=this.getFilteredFields(this.state,this.props);return Object(p.jsx)("div",null,Object(p.jsx)(table_table_Table,{indexPattern:e,items:t,editField:e=>this.props.helpers.editField(e.name),deleteField:e=>this.props.helpers.deleteField(e),openModal:this.props.openModal,theme:this.props.theme}))}}class components_table_table_Table extends n.PureComponent{constructor(...e){super(...e),U()(this,"renderFormatCell",(e=>{const{indexPattern:t}=this.props,a=Object(L.get)(t,["fieldFormatMap",e,"type","title"],"");return Object(p.jsx)("span",null,a)}))}render(){const{items:e,editField:t,deleteField:a}=this.props,n=[{field:"displayName",name:d.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.nameHeader",{defaultMessage:"Name"}),description:d.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.nameDescription",{defaultMessage:"Name of the field"}),dataType:"string",sortable:!0,width:"38%"},{field:"lang",name:d.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.langHeader",{defaultMessage:"Lang"}),description:d.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.langDescription",{defaultMessage:"Language used for the field"}),dataType:"string",sortable:!0,"data-test-subj":"scriptedFieldLang"},{field:"script",name:d.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.scriptHeader",{defaultMessage:"Script"}),description:d.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.scriptDescription",{defaultMessage:"Script for the field"}),dataType:"string",sortable:!0},{field:"name",name:d.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.formatHeader",{defaultMessage:"Format"}),description:d.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.formatDescription",{defaultMessage:"Format used for the field"}),render:this.renderFormatCell,sortable:!1},{name:"",actions:[{type:"icon",name:d.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.editHeader",{defaultMessage:"Edit"}),description:d.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.editDescription",{defaultMessage:"Edit this field"}),icon:"pencil",onClick:t,available:e=>!!e.isUserEditable},{type:"icon",name:d.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.deleteHeader",{defaultMessage:"Delete"}),description:d.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.deleteDescription",{defaultMessage:"Delete this field"}),icon:"trash",color:"danger",onClick:a,available:e=>!!e.isUserEditable}],width:"40px"}];return Object(p.jsx)(u.EuiInMemoryTable,{items:e,columns:n,pagination:{initialPageSize:10,pageSizeOptions:[5,10,25,50]},sorting:!0})}}const Se=Object(l.withRouter)((({indexPatternId:e,history:t})=>{const{dataViews:a,docLinks:n}=Object(c.useKibana)().services,i=null==n?void 0:n.links,s=a.getCanSaveSync();return Object(p.jsx)(u.EuiFlexGroup,{alignItems:"center"},Object(p.jsx)(u.EuiFlexItem,null,Object(p.jsx)(u.EuiText,{size:"s"},Object(p.jsx)("p",null,Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.scriptedLabel",defaultMessage:"Scripted fields can be used in visualizations and displayed in documents. However, they cannot be searched."}),Object(p.jsx)("br",null),Object(p.jsx)(u.EuiIcon,{type:"alert",color:"warning",style:{marginRight:"4px"}}),Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.deprecation",defaultMessage:"Scripted fields are deprecated. Use {runtimeDocs} instead.",values:{runtimeDocs:Object(p.jsx)(u.EuiLink,{target:"_blank",href:i.runtimeFields.overview},Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.header.runtimeLink",defaultMessage:"runtime fields"}))}})))),s&&Object(p.jsx)(u.EuiFlexItem,{grow:!1},Object(p.jsx)(u.EuiButton,j()({"data-test-subj":"addScriptedFieldLink"},Object(c.reactRouterNavigate)(t,`patterns/${e}/create-field/`)),Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.scripted.addFieldButton",defaultMessage:"Add scripted field"}))))})),Te=({deprecatedLangsInUse:e,painlessDocLink:t})=>e.length?Object(p.jsx)(i.a.Fragment,null,Object(p.jsx)(u.EuiCallOut,{title:Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.scripted.deprecationLangHeader",defaultMessage:"Deprecation languages in use"}),color:"danger",iconType:"cross"},Object(p.jsx)("p",null,Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.scripted.deprecationLangLabel.deprecationLangDetail",defaultMessage:"The following deprecated languages are in use: {deprecatedLangsInUse}. Support for these languages will be removed in the next major version of Kibana and Elasticsearch. Convert you scripted fields to {link} to avoid any problems.",values:{deprecatedLangsInUse:e.join(", "),link:Object(p.jsx)(u.EuiLink,{href:t},Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.scripted.deprecationLangLabel.painlessDescription",defaultMessage:"Painless"}))}}))),Object(p.jsx)(u.EuiSpacer,{size:"m"})):null,we=({field:e,hideDeleteConfirmationModal:t,deleteField:a})=>{const n=d.i18n.translate("indexPatternManagement.editIndexPattern.scripted.deleteFieldLabel",{defaultMessage:"Delete scripted field '{fieldName}'?",values:{fieldName:e.name}}),i=d.i18n.translate("indexPatternManagement.editIndexPattern.scripted.deleteField.cancelButton",{defaultMessage:"Cancel"}),s=d.i18n.translate("indexPatternManagement.editIndexPattern.scripted.deleteField.deleteButton",{defaultMessage:"Delete"});return Object(p.jsx)(u.EuiConfirmModal,{title:n,onCancel:t,onConfirm:a,cancelButtonText:i,confirmButtonText:s,defaultFocusedButton:u.EUI_MODAL_CONFIRM_BUTTON})};class scripted_fields_table_ScriptedFieldsTable extends n.Component{constructor(e){super(e),U()(this,"fetchFields",(async()=>{const e=await this.props.indexPattern.getScriptedFields(),t=[],a=[],n=["painless"];for(const i of e){const e=i.lang;!a.includes(e)&&n.includes(e)||t.push(e)}this.setState({fields:e,deprecatedLangsInUse:t})})),U()(this,"getFilteredItems",(()=>{const{fields:e}=this.state,{fieldFilter:t,scriptedFieldLanguageFilter:a,userEditPermission:n}=this.props;let i=e;a.length&&(i=e.filter((e=>a.includes(e.lang))));let s=i;if(t){const e=t.toLowerCase();s=i.filter((t=>t.name.toLowerCase().includes(e)))}return s.forEach((e=>e.isUserEditable=n)),s})),U()(this,"startDeleteField",(e=>{this.setState({fieldToDelete:e,isDeleteConfirmationModalVisible:!0})})),U()(this,"hideDeleteConfirmationModal",(()=>{this.setState({fieldToDelete:void 0,isDeleteConfirmationModalVisible:!1})})),U()(this,"deleteField",(()=>{const{indexPattern:e,onRemoveField:t,saveIndexPattern:a}=this.props,{fieldToDelete:n}=this.state;e.removeScriptedField(n.name),a(e),t&&t(),this.fetchFields(),this.hideDeleteConfirmationModal()})),this.state={deprecatedLangsInUse:[],fieldToDelete:void 0,isDeleteConfirmationModalVisible:!1,fields:[]}}UNSAFE_componentWillMount(){this.fetchFields()}render(){const{indexPattern:e,painlessDocLink:t}=this.props,{fieldToDelete:a,deprecatedLangsInUse:n}=this.state,s=this.getFilteredItems();return Object(p.jsx)(i.a.Fragment,null,Object(p.jsx)(Se,{indexPatternId:e.id||""}),Object(p.jsx)(Te,{deprecatedLangsInUse:n,painlessDocLink:t}),Object(p.jsx)(u.EuiSpacer,{size:"l"}),Object(p.jsx)(components_table_table_Table,{indexPattern:e,items:s,editField:e=>this.props.helpers.redirectToRoute(e),deleteField:this.startDeleteField}),a&&Object(p.jsx)(we,{deleteField:this.deleteField,field:a,hideDeleteConfirmationModal:this.hideDeleteConfirmationModal}))}}var Ce=a(38),Ie=a.n(Ce),De=["children"],Le=i.a.createContext(null),_e=function(e){var t=e.children,a=M()(e,De),n=a.navigateToUrl,i=a.currentAppId;return Object(p.jsx)(Le.Provider,{value:{navigateToUrl:n,currentAppId:i}},t)},Ne=function(e){var t=e.children,a=e.coreStart.application,n=a.navigateToUrl,i=a.currentAppId$,s=Ie()(i,void 0);return Object(p.jsx)(Le.Provider,{value:{navigateToUrl:n,currentAppId:s}},t)},ke={name:"36bnqj",styles:"display:flex;flex:1"},Ae=function(e){var t=e.children,a=e.navigateToUrl,i=e.currentAppId,s=Object(n.useRef)(null),r=Object(n.useCallback)((function(e){return function(e){var t=e.event,a=e.container,n=e.navigateToUrl,i=e.currentAppId;if(a&&i){var s=function(e,t){var a=e;do{var n,i;if("a"===(null===(n=a)||void 0===n?void 0:n.tagName.toLowerCase()))return a;var s=null===(i=a)||void 0===i?void 0:i.parentElement;if(!s||s===document.body||s===t)break;a=s}while(parent||parent!==document.body||parent!==t)}(t.target,a);if(s){var r=s.href,l=""===s.target||"_self"===s.target,d=0===t.button;r&&l&&d&&!t.defaultPrevented&&!function(e){return e.metaKey||e.altKey||e.ctrlKey||e.shiftKey}(t)&&(t.preventDefault(),n(s.href))}}}({event:e,currentAppId:i,navigateToUrl:a,container:s.current})}),[i,a]);return Object(p.jsx)("div",{onClick:r,ref:s,css:ke},t)},Re=function(e){var t=e.children;return Object(p.jsx)(Ae,function(){var e=Object(n.useContext)(Le);if(!e)throw new Error("RedirectAppLinksContext is missing.  Ensure your component or React root is wrapped with RedirectAppLinksProvider.");return e}(),t)},Be=["children"],Ve=function(e){var t=e.children,a=M()(e,Be),n=Object(p.jsx)(Re,null,t);if(void 0!==a.coreStart){var i=a.coreStart;return Object(p.jsx)(Ne,{coreStart:i},n)}var s=a.navigateToUrl,r=a.currentAppId;return Object(p.jsx)(_e,{currentAppId:r,navigateToUrl:s},n)},Ue=a(1);const ze=d.i18n.translate("indexPatternManagement.objectsTable.relationships.columnTypeName",{defaultMessage:"Type"}),He=d.i18n.translate("indexPatternManagement.objectsTable.relationships.columnTypeDescription",{defaultMessage:"Type of the saved object"}),Ge=d.i18n.translate("indexPatternManagement.objectsTable.relationships.columnTitleName",{defaultMessage:"Title"}),Ke=d.i18n.translate("indexPatternManagement.objectsTable.relationships.columnTitleDescription",{defaultMessage:"Title of the saved object"}),We=d.i18n.translate("indexPatternManagement.objectsTable.relationships.search.filters.type.name",{defaultMessage:"Type"}),qe=({basePath:e,capabilities:t,id:a,navigateToUrl:n,getDefaultTitle:i,getSavedObjectLabel:s,relationships:r,allowedTypes:l})=>{const d=[{field:"type",name:ze,width:"50px",align:"center",description:He,sortable:!1,render:(e,t)=>{const a=s(e,l);return Object(p.jsx)(u.EuiToolTip,{position:"top",content:a},Object(p.jsx)(u.EuiIcon,{"aria-label":a,type:t.meta.icon||"apps",size:"s","data-test-subj":"relationshipsObjectType"}))}},{field:"title",name:Ge,description:Ke,dataType:"string",sortable:!1,render:(a,n)=>{var s;const r=(null===(s=n.meta.inAppUrl)||void 0===s?void 0:s.path)||"",l=((e,t)=>{const{inAppUrl:a}=e.meta;return!!a&&(!a.uiCapabilitiesPath||Boolean(Object(L.get)(t,a.uiCapabilitiesPath)))})(n,t),d=a||i(n);return l?Object(p.jsx)(u.EuiLink,{href:e.prepend(r),"data-test-subj":"relationshipsTitle"},d):Object(p.jsx)(u.EuiText,{size:"s","data-test-subj":"relationshipsTitle"},d)}}],o=new Map(r.map((e=>[e.type,{value:e.type,name:e.type,view:e.type}]))),c={box:{incremental:!0,schema:!0},filters:[{type:"field_value_selection",field:"type",name:We,multiSelect:"or",options:[...o.values()]}]};return Object(p.jsx)(Ve,{currentAppId:Ue.a,navigateToUrl:n},Object(p.jsx)(u.EuiInMemoryTable,{items:r,columns:d,pagination:!0,search:c,rowProps:()=>({"data-test-subj":"relationshipsTableRow"})}))};function $e(e,t,a=""){const n=Object(L.countBy)(function(e,t){const a=(t||"").toLowerCase();return e.filter((e=>e.name.toLowerCase().includes(a)))}(e,a),(function(e){return e.scripted?"scripted":"indexed"}));return Object(L.defaults)(n,{indexed:0,scripted:0,sourceFilters:t.excludes?t.excludes.filter((e=>e.toLowerCase().includes(a.toLowerCase()))).length:0}),n}function Ye(e,t,a){let n="";switch(e){case"indexed":n=d.i18n.translate("indexPatternManagement.editIndexPattern.tabs.fieldsHeader",{defaultMessage:"Fields"});break;case"scripted":n=d.i18n.translate("indexPatternManagement.editIndexPattern.tabs.scriptedHeader",{defaultMessage:"Scripted fields"});break;case"sourceFilters":n=d.i18n.translate("indexPatternManagement.editIndexPattern.tabs.sourceHeader",{defaultMessage:"Field filters"})}return n+` (${t[e]===a[e]?t[e]:t[e]+" / "+a[e]})`}function Je(e){return Object(L.uniq)(e).map((e=>({value:e,name:e})))}const Xe=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.searchAria",{defaultMessage:"Search fields"}),Qe=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.filter",{defaultMessage:"Field type"}),Ze=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.filterAria",{defaultMessage:"Filter field types"}),et=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.schema",{defaultMessage:"Schema type"}),tt=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.schemaAria",{defaultMessage:"Filter schema types"}),at=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.scriptedFieldFilter",{defaultMessage:"All languages"}),nt=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.scriptedFieldFilterAria",{defaultMessage:"Filter scripted field languages"}),it=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.runtime",{defaultMessage:"Runtime"}),st=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.indexed",{defaultMessage:"Indexed"}),rt=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.filterPlaceholder",{defaultMessage:"Search"}),lt=d.i18n.translate("indexPatternManagement.editIndexPattern.fields.addFieldButtonLabel",{defaultMessage:"Add field"});function dt({indexPattern:e,saveIndexPattern:t,fields:a,history:s,refreshFields:r,relationships:l,allowedTypes:o,compositeRuntimeFields:m}){const{uiSettings:g,docLinks:b,dataViewFieldEditor:j,overlays:x,theme:f,dataViews:h,http:O,application:M,savedObjectsManagement:y}=Object(c.useKibana)().services,[F,v]=Object(n.useState)(""),[E,T]=Object(n.useState)({getCurrentTab:()=>k}),[w,I]=Object(n.useState)([]),[D,L]=Object(n.useState)(!1),[V,U]=Object(n.useState)([]),[z,H]=Object(n.useState)([]),[G,K]=Object(n.useState)(!1),[W,q]=Object(n.useState)([]),[$,Y]=Object(n.useState)([]),[J,X]=Object(n.useState)(!1),[Q,Z]=Object(n.useState)([{value:"runtime",name:it},{value:"indexed",name:st}]),ee=Object(n.useRef)(),{DeleteRuntimeFieldProvider:te}=j,ae=(e,t,a)=>{if(!e[t])return;const n=[...e];"on"===n[t].checked?n[t].checked=void 0:n[t].checked="on",a(n)},ne=Object(n.useCallback)((()=>{const t=[],a=[];e.fields.getAll().forEach((e=>{e.scripted?e.lang&&a.push(e.lang):("conflict"===e.type&&t.push("conflict"),e.esTypes&&e.esTypes.forEach((e=>t.push(e))))})),q(Je(t)),U(Je(a))}),[e]),ie=Object(n.useCallback)((()=>{ee.current&&ee.current()}),[]),se=Object(n.useCallback)((t=>{ee.current=j.openEditor({ctx:{dataView:e},onSave:r,fieldName:t})}),[j,e,r]);Object(n.useEffect)((()=>{ne()}),[e,e.fields,ne]),Object(n.useEffect)((()=>()=>{ie()}),[ie]);const re=Object(n.useCallback)((e=>Object(_.fieldWildcardMatcher)(e,g.get(C.META_FIELDS))),[g]),le=h.getCanSaveSync(),de=Object(n.useCallback)((e=>Object(p.jsx)(u.EuiFlexGroup,null,Object(p.jsx)(u.EuiFlexItem,{grow:!0},Object(p.jsx)(u.EuiFieldSearch,{fullWidth:!0,placeholder:rt,value:F,onChange:e=>v(e.target.value),"data-test-subj":"indexPatternFieldFilter","aria-label":Xe})),e===k&&W.length>0&&Object(p.jsx)(i.a.Fragment,null,Object(p.jsx)(u.EuiFlexItem,{grow:!1},Object(p.jsx)(u.EuiFilterGroup,null,Object(p.jsx)(u.EuiPopover,{anchorPosition:"downCenter","data-test-subj":"indexedFieldTypeFilterDropdown-popover",button:Object(p.jsx)(u.EuiFilterButton,{"aria-label":Ze,"data-test-subj":"indexedFieldTypeFilterDropdown",iconType:"arrowDown",onClick:()=>K(!G),isSelected:G,numFilters:W.length,hasActiveFilters:!!W.find((e=>"on"===e.checked)),numActiveFilters:W.filter((e=>"on"===e.checked)).length},Qe),isOpen:G,closePopover:()=>K(!1)},W.map(((e,t)=>Object(p.jsx)(u.EuiFilterSelectItem,{checked:e.checked,key:e.value,onClick:()=>{H(e.checked?z.filter((t=>t!==e.value)):[...z,e.value]),ae(W,t,q)},"data-test-subj":`indexedFieldTypeFilterDropdown-option-${e.value}${e.checked?"-checked":""}`},e.name)))),Object(p.jsx)(u.EuiPopover,{anchorPosition:"downCenter","data-test-subj":"schemaFieldTypeFilterDropdown-popover",button:Object(p.jsx)(u.EuiFilterButton,{"aria-label":tt,"data-test-subj":"schemaFieldTypeFilterDropdown",iconType:"arrowDown",onClick:()=>X(!J),isSelected:J,numFilters:Q.length,hasActiveFilters:!!Q.find((e=>"on"===e.checked)),numActiveFilters:Q.filter((e=>"on"===e.checked)).length},et),isOpen:J,closePopover:()=>X(!1)},Q.map(((e,t)=>Object(p.jsx)(u.EuiFilterSelectItem,{checked:e.checked,key:e.value,onClick:()=>{Y(e.checked?$.filter((t=>t!==e.value)):[...$,e.value]),ae(Q,t,Z)},"data-test-subj":`schemaFieldTypeFilterDropdown-option-${e.value}${e.checked?"-checked":""}`},e.name)))))),le&&Object(p.jsx)(u.EuiFlexItem,{grow:!1},Object(p.jsx)(u.EuiButton,{fill:!0,onClick:()=>se(),"data-test-subj":"addField"},lt))),e===A&&V.length>0&&Object(p.jsx)(u.EuiFlexItem,{grow:!1},Object(p.jsx)(u.EuiFilterGroup,null,Object(p.jsx)(u.EuiPopover,{anchorPosition:"downCenter","data-test-subj":"scriptedFieldLanguageFilterDropdown-popover",button:Object(p.jsx)(u.EuiFilterButton,{"aria-label":nt,"data-test-subj":"scriptedFieldLanguageFilterDropdown",iconType:"arrowDown",onClick:()=>L(!D),isSelected:D,numFilters:V.length,hasActiveFilters:!!V.find((e=>"on"===e.checked)),numActiveFilters:V.filter((e=>"on"===e.checked)).length},at),isOpen:D,closePopover:()=>L(!1)},V.map(((e,t)=>Object(p.jsx)(u.EuiFilterSelectItem,{checked:e.checked,key:e.value,onClick:()=>{I(e.checked?w.filter((t=>t!==e.value)):[...w,e.value]),ae(V,t,U)},"data-test-subj":`scriptedFieldLanguageFilterDropdown-option-${e.value}${e.checked?"-checked":""}`},e.name)))))))),[F,z,W,G,w,V,D,Q,$,J,se,le]),oe=Object(n.useCallback)((i=>{switch(i){case k:return Object(p.jsx)(n.Fragment,null,Object(p.jsx)(u.EuiSpacer,{size:"m"}),de(i),Object(p.jsx)(u.EuiSpacer,{size:"m"}),Object(p.jsx)(te,{dataView:e,onDelete:r},(t=>Object(p.jsx)(indexed_fields_table_IndexedFieldsTable,{fields:a,compositeRuntimeFields:m,indexPattern:e,fieldFilter:F,fieldWildcardMatcher:re,indexedFieldTypeFilter:z,schemaFieldTypeFilter:$,helpers:{editField:se,deleteField:t,getFieldInfo:S},openModal:x.openModal,theme:f,userEditPermission:h.getCanSaveSync()}))));case A:return Object(p.jsx)(n.Fragment,null,Object(p.jsx)(u.EuiSpacer,{size:"m"}),de(i),Object(p.jsx)(u.EuiSpacer,{size:"m"}),Object(p.jsx)(scripted_fields_table_ScriptedFieldsTable,{indexPattern:e,saveIndexPattern:t,fieldFilter:F,scriptedFieldLanguageFilter:w,helpers:{redirectToRoute:t=>{s.push(function(e,t){return`/dataView/${null==t?void 0:t.id}/field/${encodeURIComponent(e.name)}`}(t,e))}},onRemoveField:ne,painlessDocLink:b.links.scriptedFields.painless,userEditPermission:h.getCanSaveSync()}));case R:return Object(p.jsx)(n.Fragment,null,Object(p.jsx)(u.EuiSpacer,{size:"m"}),de(i),Object(p.jsx)(u.EuiSpacer,{size:"m"}),Object(p.jsx)(source_filters_table_SourceFiltersTable,{saveIndexPattern:t,indexPattern:e,filterFilter:F,fieldWildcardMatcher:re,onAddOrRemoveFilter:ne}));case B:return Object(p.jsx)(n.Fragment,null,Object(p.jsx)(u.EuiSpacer,{size:"m"}),Object(p.jsx)(qe,{basePath:O.basePath,id:e.id,capabilities:M.capabilities,relationships:l,allowedTypes:o,navigateToUrl:M.navigateToUrl,getDefaultTitle:y.getDefaultTitle,getSavedObjectLabel:y.getSavedObjectLabel}))}}),[b.links.scriptedFields.painless,F,re,a,de,s,e,z,$,ne,w,t,se,te,r,x,f,h,m,O,M,y,o,l]),ce=Object(n.useMemo)((()=>function(e,t,a=0){const n=$e(e.fields.getAll(),e.getSourceFiltering()),i=$e(e.fields.getAll(),e.getSourceFiltering(),t),s=[];return s.push({name:Ye("indexed",i,n),id:k,"data-test-subj":"tab-indexedFields"}),(e=>!P(e.type))(e)&&s.push({name:Ye("scripted",i,n),id:A,"data-test-subj":"tab-scriptedFields"}),s.push({name:Ye("sourceFilters",i,n),id:R,"data-test-subj":"tab-sourceFilters"}),s.push({name:d.i18n.translate("indexPatternManagement.editIndexPattern.tabs.relationshipsHeader",{defaultMessage:"Relationships ({count})",values:{count:a}}),id:B,"data-test-subj":"tab-relationships"}),s}(e,F,l.length).map((e=>({...e,content:oe(e.id)})))),[F,oe,e,l]),[ue,pe]=Object(n.useState)(ce[0].id);return Object(n.useEffect)((()=>{const{startSyncingState:e,stopSyncingState:t,setCurrentTab:a,getCurrentTab:n}=function({defaultTab:e,useHashedUrl:t}){const a=Object(N.createHashHistory)(),n="_a",i={tab:e},s=Object(_.createKbnUrlStateStorage)({useHash:t,history:a}),r=s.get(n),l=Object(_.createStateContainer)({...i,...r},{setTab:e=>t=>({...e,tab:t})},{tab:e=>()=>e.tab}),{start:d,stop:o}=Object(_.syncState)({storageKey:n,stateContainer:{...l,set:e=>e&&l.set(e)},stateStorage:s});return s.set(n,l.getState(),{replace:!0}),{startSyncingState:d,stopSyncingState:o,setCurrentTab:e=>l.transitions.setTab(e),getCurrentTab:()=>l.selectors.tab()}}({useHashedUrl:g.get("state:storeInSessionStorage"),defaultTab:k});return e(),T({setCurrentTab:a,getCurrentTab:n}),pe(n()),()=>{t()}}),[g]),Object(p.jsx)(u.EuiTabbedContent,{tabs:ce,selectedTab:ce.find((e=>e.id===ue)),onTabClick:e=>{var t;pe(e.id),null===(t=E.setCurrentTab)||void 0===t||t.call(E,e.id)}})}const ot=d.i18n.translate("indexPatternManagement.editDataView.setDefaultAria",{defaultMessage:"Set as default data view."}),ct=d.i18n.translate("indexPatternManagement.editDataView.setDefaultTooltip",{defaultMessage:"Set as default"}),ut=d.i18n.translate("indexPatternManagement.editDataView.editAria",{defaultMessage:"Edit data view."}),pt=d.i18n.translate("indexPatternManagement.editDataView.editTooltip",{defaultMessage:"Edit"}),mt=d.i18n.translate("indexPatternManagement.editDataView.removeAria",{defaultMessage:"Delete data view."}),gt=d.i18n.translate("indexPatternManagement.editDataView.removeTooltip",{defaultMessage:"Delete"}),bt=({defaultIndex:e,indexPattern:t,setDefault:a,editIndexPatternClick:n,deleteIndexPatternClick:i,children:s,canSave:r})=>Object(p.jsx)(u.EuiPageHeader,{pageTitle:Object(p.jsx)("span",{"data-test-subj":"indexPatternTitle"},t.getName()),rightSideItems:[r&&Object(p.jsx)(u.EuiButton,{onClick:n,iconType:"pencil","aria-label":ut,"data-test-subj":"editIndexPatternButton"},pt),e!==t.id&&a&&r&&t.isPersisted()&&Object(p.jsx)(u.EuiButton,{onClick:a,iconType:"starFilled","aria-label":ot,"data-test-subj":"setDefaultIndexPatternButton"},ct),r&&t.isPersisted()&&Object(p.jsx)(u.EuiButtonEmpty,{color:"danger",onClick:i,iconType:"trash","aria-label":mt,"data-test-subj":"deleteIndexPatternButton"},gt)].filter(Boolean)},s);var jt=a(19);const xt={confirmButtonText:d.i18n.translate("indexPatternManagement.editIndexPattern.deleteButton",{defaultMessage:"Delete"}),title:d.i18n.translate("indexPatternManagement.editDataView.deleteHeader",{defaultMessage:"Delete data view"}),buttonColor:"danger"},ft=({dataViews:e,overlays:t,onDelete:a})=>(n,i)=>{t.openConfirm(Object(c.toMountPoint)(i),xt).then((async t=>{t&&(await Object(jt.asyncForEach)(n,(async({id:t})=>e.delete(t))),a())}))},ht={marginLeft:"8px"},Ot=d.i18n.translate("indexPatternManagement.editIndexPattern.mappingConflictHeader",{defaultMessage:"Mapping conflict"}),Mt=d.i18n.translate("indexPatternManagement.editIndexPattern.badge.securityDataViewTitle",{defaultMessage:"Security Data View"}),yt=e=>Object(L.pickBy)(e.getAllRuntimeFields(),(e=>"composite"===e.type)),Ft=Object(l.withRouter)((({indexPattern:e,history:t,location:a})=>{const{uiSettings:s,overlays:r,chrome:m,dataViews:g,IndexPatternEditor:b,savedObjectsManagement:j}=Object(c.useKibana)().services,[x,f]=Object(n.useState)(e.getNonScriptedFields()),[h,O]=Object(n.useState)((()=>yt(e))),[M,y]=Object(n.useState)(e.fields.getAll().filter((e=>"conflict"===e.type))),[F,v]=Object(n.useState)(s.get("defaultIndex")),[P,S]=Object(n.useState)([]),[T,w]=Object(n.useState)(!1),[I,D]=Object(n.useState)([]),[L,_]=Object(n.useState)([]);Object(n.useEffect)((()=>{j.getAllowedTypes().then((e=>{_(e)}))}),[j]),Object(n.useEffect)((()=>{if(0===L.length||!e.isPersisted())return;const t=L.map((e=>e.name));j.getRelationships(C.DATA_VIEW_SAVED_OBJECT_TYPE,e.id,t).then((e=>{D(e.relations.map((e=>({...e,title:e.meta.title}))))}))}),[j,e,L]),Object(n.useEffect)((()=>{f(e.getNonScriptedFields()),y(e.fields.getAll().filter((e=>"conflict"===e.type)))}),[e]),Object(n.useEffect)((()=>{S(E(e,e.id===F))}),[F,e]);const N=Object(n.useCallback)((()=>{s.set("defaultIndex",e.id),v(e.id||"")}),[s,e.id]),k=ft({dataViews:g,uiSettings:s,overlays:r,onDelete:()=>{t.push("")}}),A="rollup"===new URLSearchParams(Object(l.useLocation)().search).get("type"),R=T?Object(p.jsx)(b,{onSave:()=>w(!1),onCancel:()=>w(!1),defaultTypeIsRollup:A,editData:e}):Object(p.jsx)(i.a.Fragment,null),B=d.i18n.translate("indexPatternManagement.editIndexPattern.indexPatternHeading",{defaultMessage:"Index pattern:"}),V=d.i18n.translate("indexPatternManagement.editIndexPattern.timeFilterHeading",{defaultMessage:"Time field:"}),U=d.i18n.translate("indexPatternManagement.editIndexPattern.mappingConflictLabel",{defaultMessage:"{conflictFieldsLength, plural, one {A field is} other {# fields are}} defined as several types (string, integer, etc) across the indices that match this pattern. You may still be able to use these conflict fields in parts of Kibana, but they will be unavailable for functions that require Kibana to know their type. Correcting this issue will require reindexing your data.",values:{conflictFieldsLength:M.length}}),z=d.i18n.translate("indexPatternManagement.editDataView.detailsAria",{defaultMessage:"Data view details"});m.docTitle.change(e.getName());const H=g.getCanSaveSync(),G=e.namespaces&&e.namespaces.length>1||e.namespaces.includes("*")?Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.editDataView.deleteWarningWithNamespaces",defaultMessage:"Delete the data view {dataViewName} from every space it is shared in. You can't undo this action.",values:{dataViewName:Object(p.jsx)(u.EuiCode,null,e.getName())}}):Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.editDataView.deleteWarning",defaultMessage:"The data view {dataViewName} will be deleted. You can't undo this action.",values:{dataViewName:Object(p.jsx)(u.EuiCode,null,e.getName())}});return Object(p.jsx)("div",{"data-test-subj":"editIndexPattern",role:"region","aria-label":z},Object(p.jsx)(bt,{indexPattern:e,setDefault:N,editIndexPatternClick:()=>{w(!0)},deleteIndexPatternClick:()=>k([e],Object(p.jsx)("div",null,G)),defaultIndex:F,canSave:H},Object(p.jsx)(u.EuiHorizontalRule,{margin:"none"}),Object(p.jsx)(u.EuiSpacer,{size:"l"}),Object(p.jsx)(u.EuiFlexGroup,{wrap:!0,gutterSize:"l",alignItems:"center"},Boolean(e.title)&&Object(p.jsx)(u.EuiFlexItem,{grow:!1},Object(p.jsx)(u.EuiFlexGroup,{gutterSize:"none",alignItems:"center"},Object(p.jsx)(u.EuiText,{size:"s"},B),Object(p.jsx)(u.EuiCode,{style:ht},e.title))),Boolean(e.timeFieldName)&&Object(p.jsx)(u.EuiFlexItem,{grow:!1},Object(p.jsx)(u.EuiFlexGroup,{gutterSize:"none",alignItems:"center"},Object(p.jsx)(u.EuiText,{size:"s"},V),Object(p.jsx)(u.EuiCode,{style:ht},e.timeFieldName))),e.id&&0===e.id.indexOf("security-solution")&&Object(p.jsx)(u.EuiFlexItem,{grow:!1},Object(p.jsx)(u.EuiBadge,null,Mt)),P.map((e=>Object(p.jsx)(u.EuiFlexItem,{grow:!1,key:e.key},"default"===e.key?Object(p.jsx)(u.EuiBadge,{iconType:"starFilled",color:"default"},e.name):Object(p.jsx)(u.EuiBadge,{color:"hollow"},e.name))))),M.length>0&&Object(p.jsx)(i.a.Fragment,null,Object(p.jsx)(u.EuiSpacer,null),Object(p.jsx)(u.EuiCallOut,{title:Ot,color:"warning",iconType:"alert"},Object(p.jsx)("p",null,U)))),Object(p.jsx)(u.EuiSpacer,{size:"xl"}),Object(p.jsx)(dt,{indexPattern:e,saveIndexPattern:g.updateSavedObject.bind(g),fields:x,relationships:I,allowedTypes:L,history:t,location:a,compositeRuntimeFields:h,refreshFields:()=>{f(e.getNonScriptedFields()),O(yt(e))}}),R)})),vt=Object(l.withRouter)((({...e})=>{const{dataViews:t,setBreadcrumbs:a,notifications:i}=Object(c.useKibana)().services,[s,r]=Object(n.useState)(),[l,o]=Object(n.useState)();if(Object(n.useEffect)((()=>{t.get(e.match.params.id).then((e=>{o(e),a(w(e))})).catch((e=>{r(e)}))}),[t,e.match.params.id,a,r]),s){const[t,a]=[d.i18n.translate("indexPatternManagement.editIndexPattern.couldNotLoadTitle",{defaultMessage:"Unable to load data view"}),d.i18n.translate("indexPatternManagement.editIndexPattern.couldNotLoadMessage",{defaultMessage:"The data view with id:{objectId} could not be loaded. Try creating a new one.",values:{objectId:e.match.params.id}})];i.toasts.addError(null!=s?s:new Error(t),{title:t,toastMessage:a}),e.history.push("/")}return null!=l?Object(p.jsx)(Ft,{indexPattern:l}):null}));var Pt=a(20);const Et=({isVisible:e=!1})=>e?Object(p.jsx)(n.Fragment,null,Object(p.jsx)(u.EuiCallOut,{title:Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.disabledCallOutHeader",defaultMessage:"Scripting disabled",description:"Showing the status that scripting is disabled in Elasticsearch. Not an update message, that it JUST got disabled."}),color:"danger",iconType:"alert"},Object(p.jsx)("p",null,Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.disabledCallOutLabel",defaultMessage:"All inline scripting has been disabled in Elasticsearch. You must enable inline scripting for at least one language in order to use scripted fields in Kibana."}))),Object(p.jsx)(u.EuiSpacer,{size:"m"})):null;Et.displayName="ScriptingDisabledCallOut";const St=({isVisible:e=!1})=>{var t;const a=null===(t=Object(c.useKibana)().services.docLinks)||void 0===t?void 0:t.links;return e?Object(p.jsx)(n.Fragment,null,Object(p.jsx)(u.EuiText,{size:"s"},Object(p.jsx)("p",null,Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.warningCallOutLabel.callOutDetail",defaultMessage:"Familiarize yourself with {scripFields} and {scriptsInAggregation} before using this feature. Scripted fields can be used to display and aggregate calculated values. As such, they can be very slow and, if done incorrectly, can cause Kibana to become unusable.",values:{scripFields:Object(p.jsx)(u.EuiLink,{target:"_blank",href:a.scriptedFields.scriptFields},Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.warningCallOutLabel.scripFieldsLink",defaultMessage:"scripted fields"})),scriptsInAggregation:Object(p.jsx)(u.EuiLink,{target:"_blank",href:a.scriptedFields.scriptAggs},Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.warningCallOutLabel.scriptsInAggregationLink",defaultMessage:"scripts in aggregations"}))}}))),Object(p.jsx)(u.EuiSpacer,{size:"m"}),Object(p.jsx)(u.EuiCallOut,{color:"warning",iconType:"alert",title:Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.scriptedFieldsDeprecatedTitle",defaultMessage:"Scripted fields are deprecated",description:"Deprecation warning title within scripted field editor"})},Object(p.jsx)(u.EuiText,{size:"s"},Object(p.jsx)("p",null,Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.scriptedFieldsDeprecatedBody",defaultMessage:"For greater flexibility and Painless script support, use {runtimeDocs}.",values:{runtimeDocs:Object(p.jsx)(u.EuiLink,{target:"_blank",href:a.runtimeFields.overview},Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.warningCallOutLabel.runtimeLink",defaultMessage:"runtime fields"}))}})))),Object(p.jsx)(u.EuiSpacer,{size:"m"})):null};St.displayName="ScriptingWarningCallOut";const Tt=()=>{var e;const t=null===(e=Object(c.useKibana)().services.docLinks)||void 0===e?void 0:e.links.scriptedFields;return Object(p.jsx)(n.Fragment,null,Object(p.jsx)(u.EuiSpacer,null),Object(p.jsx)(u.EuiText,null,Object(p.jsx)("h3",null,Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.syntaxHeader",defaultMessage:"Syntax"})),Object(p.jsx)("p",null,Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.syntax.defaultLabel.defaultDetail",defaultMessage:"By default, Kibana scripted fields use {painless}, a simple and secure scripting language designed specifically for use with Elasticsearch, to access values in the document use the following format:",values:{painless:Object(p.jsx)(u.EuiLink,{target:"_blank",href:t.painless},Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.syntax.defaultLabel.painlessLink",defaultMessage:"Painless"})," ",Object(p.jsx)(u.EuiIcon,{type:"link"}))}})),Object(p.jsx)("p",null,Object(p.jsx)(u.EuiCode,null,Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.syntax.default.formatLabel",defaultMessage:"doc['some_field'].value"}))),Object(p.jsx)("p",null,Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.syntax.painlessLabel.painlessDetail",defaultMessage:"Painless is powerful but easy to use. It provides access to many {javaAPIs}. Read up on its {syntax} and you'll be up to speed in no time!",values:{javaAPIs:Object(p.jsx)(u.EuiLink,{target:"_blank",href:t.painlessApi},Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.syntax.painlessLabel.javaAPIsLink",defaultMessage:"native Java APIs"}),"Â ",Object(p.jsx)(u.EuiIcon,{type:"link"})),syntax:Object(p.jsx)(u.EuiLink,{target:"_blank",href:t.painlessSyntax},Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.syntax.painlessLabel.syntaxLink",defaultMessage:"syntax"}),"Â ",Object(p.jsx)(u.EuiIcon,{type:"link"}))}})),Object(p.jsx)("p",null,Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.syntax.kibanaLabel",defaultMessage:"Kibana currently imposes one special limitation on the painless scripts you write. They cannot contain named functions."})),Object(p.jsx)("p",null,Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.commonLabel.commonDetail",defaultMessage:"Coming from an older version of Kibana? The {lucene} you know and love are still available. Lucene expressions are a lot like JavaScript, but limited to basic arithmetic, bitwise and comparison operations.",values:{lucene:Object(p.jsx)(u.EuiLink,{target:"_blank",href:t.luceneExpressions},Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.commonLabel.luceneLink",defaultMessage:"Lucene Expressions"}),"Â ",Object(p.jsx)(u.EuiIcon,{type:"link"}))}})),Object(p.jsx)("p",null,Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.limitsLabel",defaultMessage:"There are a few limitations when using Lucene Expressions:"})),Object(p.jsx)("ul",null,Object(p.jsx)("li",null,Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.limits.typesLabel",defaultMessage:"Only numeric, boolean, date, and geo_point fields may be accessed"})),Object(p.jsx)("li",null,Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.limits.fieldsLabel",defaultMessage:"Stored fields are not available"})),Object(p.jsx)("li",null,Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.limits.sparseLabel",defaultMessage:"If a field is sparse (only some documents contain a value), documents missing the field will have a value of 0"}))),Object(p.jsx)("p",null,Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.operationsLabel",defaultMessage:"Here are all the operations available to lucene expressions:"})),Object(p.jsx)("ul",null,Object(p.jsx)("li",null,Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.operations.arithmeticLabel",defaultMessage:"Arithmetic operators: {operators}",values:{operators:Object(p.jsx)("code",null,"+ - * / %")}})),Object(p.jsx)("li",null,Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.operations.bitwiseLabel",defaultMessage:"Bitwise operators: {operators}",values:{operators:Object(p.jsx)("code",null,"| & ^ ~ << >> >>>")}})),Object(p.jsx)("li",null,Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.operations.booleanLabel",defaultMessage:"Boolean operators (including the ternary operator): {operators}",values:{operators:Object(p.jsx)("code",null,"&& || ! ?:")}})),Object(p.jsx)("li",null,Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.operations.comparisonLabel",defaultMessage:"Comparison operators: {operators}",values:{operators:Object(p.jsx)("code",null,"< <= == >= >")}})),Object(p.jsx)("li",null,Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.operations.mathLabel",defaultMessage:"Common mathematic functions: {operators}",values:{operators:Object(p.jsx)("code",null,"abs ceil exp floor ln log10 logn max min sqrt pow")}})),Object(p.jsx)("li",null,Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.operations.trigLabel",defaultMessage:"Trigonometric library functions: {operators}",values:{operators:Object(p.jsx)("code",null,"acosh acos asinh asin atanh atan atan2 cosh cos sinh sin tanh tan")}})),Object(p.jsx)("li",null,Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.operations.distanceLabel",defaultMessage:"Distance functions: {operators}",values:{operators:Object(p.jsx)("code",null,"haversin")}})),Object(p.jsx)("li",null,Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.operations.miscellaneousLabel",defaultMessage:"Miscellaneous functions: {operators}",values:{operators:Object(p.jsx)("code",null,"min, max")}})))))};var wt=a(21),Ct=a(22);class test_script_TestScript extends n.Component{constructor(...e){super(...e),U()(this,"defaultProps",{name:"myScriptedField"}),U()(this,"state",{isLoading:!1,additionalFields:[],previewData:void 0}),U()(this,"previewScript",(async e=>{var t;const{indexPattern:a,name:n,script:i,executeScript:s}=this.props;if(!i||0===i.length)return;let r;if(this.setState({isLoading:!0}),e){const t=Object(Ct.getEsQueryConfig)(this.context.services.uiSettings);r=Object(wt.buildEsQuery)(this.props.indexPattern,e.query||[],[],t)}const l=await s({name:n,script:i,indexPatternTitle:a.title,query:r,additionalFields:this.state.additionalFields.map((e=>e.value)),http:this.context.services.http});200===l.status?this.setState({isLoading:!1,previewData:null===(t=l.hits)||void 0===t?void 0:t.hits.map((e=>({_id:e._id,...e._source,...e.fields})))}):this.setState({isLoading:!1,previewData:l})})),U()(this,"onAdditionalFieldsChange",(e=>{this.setState({additionalFields:e})}))}componentDidMount(){this.props.script&&this.previewScript()}renderPreview(e){return e?e.error?Object(p.jsx)(u.EuiCallOut,{title:d.i18n.translate("indexPatternManagement.testScript.errorMessage",{defaultMessage:"There's an error in your script"}),color:"danger",iconType:"cross"},Object(p.jsx)(u.EuiCodeBlock,{language:"json",className:"scriptPreviewCodeBlock","data-test-subj":"scriptedFieldPreview"},JSON.stringify(e.error,null," "))):Object(p.jsx)(n.Fragment,null,Object(p.jsx)(u.EuiTitle,{size:"xs"},Object(p.jsx)("p",null,Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.testScript.resultsLabel",defaultMessage:"First 10 results"}))),Object(p.jsx)(u.EuiSpacer,{size:"s"}),Object(p.jsx)(u.EuiCodeBlock,{language:"json",className:"scriptPreviewCodeBlock","data-test-subj":"scriptedFieldPreview"},JSON.stringify(e,null," "))):null}renderToolbar(){const e=new Map,t=[];return this.props.indexPattern.fields.getAll().filter((e=>{const t=e.isSubtypeMulti();return!e.name.startsWith("_")&&!t&&!e.scripted})).forEach((t=>{if(e.has(t.type)){const a=e.get(t.type);a.push(t.name),e.set(t.type,a)}else e.set(t.type,[t.name])})),e.forEach(((e,a)=>{t.push({label:a,options:e.sort().map((e=>({value:e,label:e})))})})),t.sort(((e,t)=>e.label<t.label?-1:e.label>t.label?1:0)),Object(p.jsx)(n.Fragment,null,Object(p.jsx)(u.EuiFormRow,{label:d.i18n.translate("indexPatternManagement.testScript.fieldsLabel",{defaultMessage:"Additional fields"}),fullWidth:!0},Object(p.jsx)(u.EuiComboBox,{placeholder:d.i18n.translate("indexPatternManagement.testScript.fieldsPlaceholder",{defaultMessage:"Select..."}),options:t,selectedOptions:this.state.additionalFields,onChange:e=>this.onAdditionalFieldsChange(e),"data-test-subj":"additionalFieldsSelect",fullWidth:!0})),Object(p.jsx)(u.EuiSpacer,{size:"s"}),Object(p.jsx)("div",{className:"testScript__searchBar"},Object(p.jsx)(this.context.services.unifiedSearch.ui.SearchBar,{displayStyle:"inPage",appName:"indexPatternManagement",showFilterBar:!1,showDatePicker:!1,showQueryInput:!0,query:this.context.services.data.query.queryString.getDefaultQuery(),onQuerySubmit:this.previewScript,indexPatterns:[this.props.indexPattern],customSubmitButton:Object(p.jsx)(u.EuiButton,{disabled:!this.props.script,isLoading:this.state.isLoading,"data-test-subj":"runScriptButton"},Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.testScript.submitButtonLabel",defaultMessage:"Run script"}))})))}render(){return Object(p.jsx)(n.Fragment,null,Object(p.jsx)(u.EuiSpacer,null),Object(p.jsx)(u.EuiText,null,Object(p.jsx)("h3",null,Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.testScript.resultsTitle",defaultMessage:"Preview results"})),Object(p.jsx)("p",null,Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.testScript.instructions",defaultMessage:"Run your script to preview the first 10 results. You can also select some additional fields to include in your results to gain more context or add a query to filter on specific documents."}))),Object(p.jsx)(u.EuiSpacer,null),this.renderToolbar(),Object(p.jsx)(u.EuiSpacer,null),this.renderPreview(this.state.previewData))}}U()(test_script_TestScript,"contextType",c.context);const It=({isVisible:e=!1,onClose:t=(()=>{}),indexPattern:a,lang:n,name:i,script:s,executeScript:r})=>{const l=[{id:"syntax",name:"Syntax","data-test-subj":"syntaxTab",content:Object(p.jsx)(Tt,null)},{id:"test",name:"Preview results","data-test-subj":"testTab",content:Object(p.jsx)(test_script_TestScript,{indexPattern:a,lang:n,name:i,script:s,executeScript:r})}];return e?Object(p.jsx)(u.EuiFlyout,{onClose:t,"data-test-subj":"scriptedFieldsHelpFlyout"},Object(p.jsx)(u.EuiFlyoutBody,null,Object(p.jsx)(u.EuiTabbedContent,{tabs:l,initialSelectedTab:l[0]}))):null};It.displayName="ScriptingHelpFlyout";const Dt=Object(L.memoize)((e=>e?i.a.lazy((()=>e().then((e=>({default:e}))))):null));class field_format_editor_FieldFormatEditor extends n.PureComponent{constructor(e){super(e),this.state={EditorComponent:Dt(e.fieldFormatEditors.getById(e.fieldFormatId))}}static getDerivedStateFromProps(e){return{EditorComponent:Dt(e.fieldFormatEditors.getById(e.fieldFormatId))}}render(){const{EditorComponent:e}=this.state,{fieldType:t,fieldFormat:a,fieldFormatParams:n,onChange:s,onError:r}=this.props;return Object(p.jsx)(i.a.Fragment,null,e?Object(p.jsx)(i.a.Suspense,{fallback:Object(p.jsx)("div",{style:{minHeight:430,marginTop:8}},Object(p.jsx)(u.EuiDelayRender,null,Object(p.jsx)(u.EuiLoadingContent,{lines:4})))},Object(p.jsx)(e,{fieldType:t,format:a,formatParams:n,onChange:s,onError:r})):null)}}var Lt,_t,Nt=a(40),kt=a.n(Nt),At=a(41),Rt=a.n(At);!function(e){e._ID="_id",e._INDEX="_index",e._SOURCE="_source",e._TYPE="_type",e.STRING="string",e.TEXT="text",e.MATCH_ONLY_TEXT="match_only_text",e.KEYWORD="keyword",e.VERSION="version",e.BOOLEAN="boolean",e.OBJECT="object",e.DATE="date",e.DATE_NANOS="date_nanos",e.DATE_RANGE="date_range",e.GEO_POINT="geo_point",e.GEO_SHAPE="geo_shape",e.FLOAT="float",e.HALF_FLOAT="half_float",e.SCALED_FLOAT="scaled_float",e.DOUBLE="double",e.INTEGER="integer",e.LONG="long",e.SHORT="short",e.UNSIGNED_LONG="unsigned_long",e.AGGREGATE_METRIC_DOUBLE="aggregate_metric_double",e.FLOAT_RANGE="float_range",e.DOUBLE_RANGE="double_range",e.INTEGER_RANGE="integer_range",e.LONG_RANGE="long_range",e.NESTED="nested",e.BYTE="byte",e.IP="ip",e.IP_RANGE="ip_range",e.ATTACHMENT="attachment",e.TOKEN_COUNT="token_count",e.MURMUR3="murmur3",e.HISTOGRAM="histogram"}(Lt||(Lt={})),function(e){e._SOURCE="_source",e.ATTACHMENT="attachment",e.BOOLEAN="boolean",e.DATE="date",e.DATE_RANGE="date_range",e.GEO_POINT="geo_point",e.GEO_SHAPE="geo_shape",e.IP="ip",e.IP_RANGE="ip_range",e.MURMUR3="murmur3",e.NUMBER="number",e.NUMBER_RANGE="number_range",e.STRING="string",e.UNKNOWN="unknown",e.CONFLICT="conflict",e.OBJECT="object",e.NESTED="nested",e.HISTOGRAM="histogram",e.MISSING="missing"}(_t||(_t={}));var Bt=kt()((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Rt()(this,e),U()(this,"name",void 0),U()(this,"sortable",void 0),U()(this,"filterable",void 0),U()(this,"esTypes",void 0),this.name=t.name||_t.UNKNOWN,this.sortable=t.sortable||!1,this.filterable=t.filterable||!1,this.esTypes=Object.freeze((t.esTypes||[]).slice())})),Vt=new Bt({name:_t.UNKNOWN}),Ut=[new Bt({name:_t.STRING,sortable:!0,filterable:!0,esTypes:[Lt.STRING,Lt.TEXT,Lt.MATCH_ONLY_TEXT,Lt.KEYWORD,Lt.VERSION,Lt._TYPE,Lt._ID]}),new Bt({name:_t.NUMBER,sortable:!0,filterable:!0,esTypes:[Lt.FLOAT,Lt.HALF_FLOAT,Lt.SCALED_FLOAT,Lt.DOUBLE,Lt.INTEGER,Lt.LONG,Lt.UNSIGNED_LONG,Lt.SHORT,Lt.BYTE,Lt.TOKEN_COUNT,Lt.AGGREGATE_METRIC_DOUBLE]}),new Bt({name:_t.NUMBER_RANGE,sortable:!0,filterable:!0,esTypes:[Lt.FLOAT_RANGE,Lt.DOUBLE_RANGE,Lt.INTEGER_RANGE,Lt.LONG_RANGE]}),new Bt({name:_t.DATE,sortable:!0,filterable:!0,esTypes:[Lt.DATE,Lt.DATE_NANOS]}),new Bt({name:_t.DATE_RANGE,sortable:!0,filterable:!0,esTypes:[Lt.DATE_RANGE]}),new Bt({name:_t.IP,sortable:!0,filterable:!0,esTypes:[Lt.IP]}),new Bt({name:_t.IP_RANGE,sortable:!0,filterable:!0,esTypes:[Lt.IP_RANGE]}),new Bt({name:_t.BOOLEAN,sortable:!0,filterable:!0,esTypes:[Lt.BOOLEAN]}),new Bt({name:_t.OBJECT,esTypes:[Lt.OBJECT]}),new Bt({name:_t.NESTED,esTypes:[Lt.NESTED]}),new Bt({name:_t.GEO_POINT,esTypes:[Lt.GEO_POINT]}),new Bt({name:_t.GEO_SHAPE,esTypes:[Lt.GEO_SHAPE]}),new Bt({name:_t.ATTACHMENT,esTypes:[Lt.ATTACHMENT]}),new Bt({name:_t.MURMUR3,esTypes:[Lt.MURMUR3]}),new Bt({name:_t._SOURCE,esTypes:[Lt._SOURCE]}),new Bt({name:_t.HISTOGRAM,filterable:!0,esTypes:[Lt.HISTOGRAM]}),new Bt({name:_t.CONFLICT}),Vt];const zt={painless:["number","string","date","boolean"],expression:["number"]},Ht=Ut.filter((function(e){return e.name})).map((function(e){return e.name})),Gt=async({name:e,script:t,indexPatternTitle:a,query:n,additionalFields:i=[],http:s})=>s.post("/internal/index-pattern-management/preview_scripted_field",{body:JSON.stringify({index:a,name:e,script:t,query:n,additionalFields:i})}).then((e=>({status:e.statusCode,hits:e.body.hits}))).catch((e=>({status:e.statusCode,error:e.body.attributes.error}))),Kt=(e,t,a)=>{const n=a.getByFieldType(e.type).map((({id:e,title:t})=>({id:e,title:t})));return[{id:"",defaultFieldFormat:t,title:d.i18n.translate("indexPatternManagement.defaultFormatDropDown",{defaultMessage:"- Default -"})},...n]};class field_editor_FieldEditor extends n.PureComponent{constructor(e,t){super(e,t),U()(this,"supportedLangs",[]),U()(this,"deprecatedLangs",[]),U()(this,"onFieldChange",((e,t)=>{const{spec:a}=this.state;a[e]=t,this.forceUpdate()})),U()(this,"onTypeChange",(e=>{const{fieldFormats:t}=this.context.services,{spec:a,format:n}=this.state,i=t.getDefaultType(e);a.type=e,this.setState({fieldTypeFormats:Kt(a,i,t),fieldFormatId:i.id,fieldFormatParams:n.params()})})),U()(this,"onLangChange",(e=>{const{spec:t}=this.state,a=Object(L.get)(zt,e,Ht);t.lang=e,t.type=a.includes(t.type)?t.type:a[0],this.setState({fieldTypes:a})})),U()(this,"onFormatChange",((e,t)=>{const{fieldTypeFormats:a}=this.state,{uiSettings:n,fieldFormats:i}=this.context.services,s=new(i.getType(e||a[0].defaultFieldFormat.id))(t,(e=>n.get(e)));this.setState({fieldFormatId:e,fieldFormatParams:t,format:s})})),U()(this,"onFormatParamsChange",(e=>{const{fieldFormatId:t}=this.state;this.onFormatChange(t,e)})),U()(this,"onFormatParamsError",(e=>{this.setState({hasFormatError:!!e})})),U()(this,"onScriptChange",(e=>{this.setState({hasScriptError:!1}),this.onFieldChange("script",e)})),U()(this,"showScriptingHelp",(()=>{this.setState({showScriptingHelp:!0})})),U()(this,"hideScriptingHelp",(()=>{this.setState({showScriptingHelp:!1})})),U()(this,"renderDeleteModal",(()=>{const{spec:e}=this.state;return this.state.showDeleteModal?Object(p.jsx)(u.EuiConfirmModal,{title:d.i18n.translate("indexPatternManagement.deleteFieldHeader",{defaultMessage:"Delete field '{fieldName}'",values:{fieldName:e.name}}),onCancel:this.hideDeleteModal,onConfirm:()=>{this.hideDeleteModal(),this.deleteField()},cancelButtonText:d.i18n.translate("indexPatternManagement.deleteField.cancelButton",{defaultMessage:"Cancel"}),confirmButtonText:d.i18n.translate("indexPatternManagement.deleteField.deleteButton",{defaultMessage:"Delete"}),buttonColor:"danger",defaultFocusedButton:u.EUI_MODAL_CONFIRM_BUTTON},Object(p.jsx)("p",null,Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.deleteFieldLabel",defaultMessage:"You can't recover a deleted field.{separator}Are you sure you want to do this?",values:{separator:Object(p.jsx)("span",null,Object(p.jsx)("br",null),Object(p.jsx)("br",null))}}))):null})),U()(this,"showDeleteModal",(()=>{this.setState({showDeleteModal:!0})})),U()(this,"hideDeleteModal",(()=>{this.setState({showDeleteModal:!1})})),U()(this,"renderScriptingPanels",(()=>{const{scriptingLangs:e,spec:t,showScriptingHelp:a}=this.state;if(t.scripted)return Object(p.jsx)(n.Fragment,null,Object(p.jsx)(Et,{isVisible:!e.length}),Object(p.jsx)(St,{isVisible:!0}),Object(p.jsx)(It,{isVisible:a,onClose:this.hideScriptingHelp,indexPattern:this.props.indexPattern,lang:t.lang,name:t.name,script:t.script,executeScript:Gt}))})),U()(this,"deleteField",(()=>{const{redirectAway:e,indexPatternService:t}=this.props.services,{indexPattern:a}=this.props,{spec:n}=this.state;a.removeScriptedField(n.name),t.updateSavedObject(a).then((()=>{const t=d.i18n.translate("indexPatternManagement.deleteField.deletedHeader",{defaultMessage:"Deleted '{fieldName}'",values:{fieldName:n.name}});this.context.services.notifications.toasts.addSuccess(t),e()}))})),U()(this,"saveField",(async()=>{const e=this.state.spec,{indexPattern:t}=this.props,{fieldFormatId:a,fieldFormatParams:n,customLabel:i}=this.state;if(e.scripted&&(this.setState({isSaving:!0}),!await(async({name:e,script:t,indexPatternTitle:a,http:n})=>200===(await Gt({name:e,script:t,indexPatternTitle:a,http:n})).status)({name:e.name,script:e.script,indexPatternTitle:t.title,http:this.context.services.http})))return void this.setState({hasScriptError:!0,isSaving:!1});const{redirectAway:s,indexPatternService:r}=this.props.services;let l;return t.fields.getByName(e.name)?(l=t.fields.getByName(e.name).spec,t.fields.update(e)):t.fields.add(e),a?t.setFieldFormat(e.name,{id:a,params:n}):t.deleteFieldFormat(e.name),e.customLabel!==i&&(e.customLabel=i,t.fields.update(e)),r.updateSavedObject(t).then((()=>{const t=d.i18n.translate("indexPatternManagement.deleteField.savedHeader",{defaultMessage:"Saved '{fieldName}'",values:{fieldName:e.name}});this.context.services.notifications.toasts.addSuccess(t),s()})).catch((()=>{l?t.fields.update(l):t.fields.remove(e)}))}));const{spec:a,indexPattern:i}=e;this.state={isReady:!1,isCreating:!1,isDeprecatedLang:!1,scriptingLangs:[],fieldTypes:[],fieldTypeFormats:[],existingFieldNames:i.fields.getAll().map((e=>e.name)),fieldFormatId:void 0,fieldFormatParams:{},showScriptingHelp:!1,showDeleteModal:!1,hasFormatError:!1,hasScriptError:!1,isSaving:!1,format:e.indexPattern.getFormatterForField(a),spec:{...a},customLabel:""},this.supportedLangs=["painless"],this.deprecatedLangs=[],this.init(t)}async init(e){var t,a;const{http:n,notifications:i,fieldFormats:s}=e.services,{format:r,spec:l}=this.state,{indexPattern:o}=this.props,c=await((e,t)=>e.get("/api/kibana/scripts/languages").catch((()=>(t.addDanger(d.i18n.translate("indexPatternManagement.scriptingLanguages.errorFetchingToastDescription",{defaultMessage:"Error getting available scripting languages from Elasticsearch"})),[]))))(n,i.toasts),u=Object(L.intersection)(c,Object(L.union)(this.supportedLangs,this.deprecatedLangs));l.lang=l.lang&&u.includes(l.lang)?l.lang:void 0,l.scripted&&!l.lang&&(l.lang=u[0]);const p=Object(L.get)(zt,l.lang||"",Ht);l.type=p.includes(l.type)?l.type:p[0];const m=s.getDefaultType(l.type,l.esTypes);this.setState({isReady:!0,isCreating:!o.fields.getByName(l.name),isDeprecatedLang:this.deprecatedLangs.includes(l.lang||""),errors:[],scriptingLangs:u,fieldTypes:p,fieldTypeFormats:Kt(l,m,s),fieldFormatId:null===(t=o.getFormatterForFieldNoDefault(l.name))||void 0===t||null===(a=t.type)||void 0===a?void 0:a.id,customLabel:l.customLabel||"",fieldFormatParams:r.params()})}isDuplicateName(){const{isCreating:e,spec:t,existingFieldNames:a}=this.state;return e&&a.includes(t.name)}renderName(){var e;const{isCreating:t,spec:a}=this.state,n=null==a||null===(e=a.name)||void 0===e?void 0:e.includes("*"),i=!a.name||!a.name.trim()||n;return t?Object(p.jsx)(u.EuiFormRow,{label:d.i18n.translate("indexPatternManagement.nameLabel",{defaultMessage:"Name"}),helpText:this.isDuplicateName()?Object(p.jsx)("span",null,Object(p.jsx)(u.EuiIcon,{type:"alert",color:"warning",size:"s"}),"Â ",Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.mappingConflictLabel.mappingConflictDetail",defaultMessage:"{mappingConflict} You already have a field with the name {fieldName}. Naming your scripted field with the same name means you won't be able to query both fields at the same time.",values:{mappingConflict:Object(p.jsx)("strong",null,Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.mappingConflictLabel.mappingConflictLabel",defaultMessage:"Mapping Conflict:"})),fieldName:Object(p.jsx)(u.EuiCode,null,a.name)}})):null,isInvalid:i,error:i&&(n?d.i18n.translate("indexPatternManagement.starCharacterNotAllowedValidationErrorMessage",{defaultMessage:"The field cannot have * in the name."}):d.i18n.translate("indexPatternManagement.nameErrorMessage",{defaultMessage:"Name is required"}))},Object(p.jsx)(u.EuiFieldText,{value:a.name||"",placeholder:d.i18n.translate("indexPatternManagement.namePlaceholder",{defaultMessage:"New scripted field"}),"data-test-subj":"editorFieldName",onChange:e=>{this.onFieldChange("name",e.target.value)},isInvalid:i})):null}renderLanguage(){const{spec:e,scriptingLangs:t,isDeprecatedLang:a}=this.state;return e.scripted?Object(p.jsx)(u.EuiFormRow,{label:d.i18n.translate("indexPatternManagement.languageLabel",{defaultMessage:"Language"}),helpText:a?Object(p.jsx)("span",null,Object(p.jsx)(u.EuiIcon,{type:"alert",color:"warning",size:"s"}),"Â ",Object(p.jsx)("strong",null,Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.warningHeader",defaultMessage:"Deprecation Warning:"})),"Â ",Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.warningLabel.warningDetail",defaultMessage:"{language} is deprecated and support will be removed in the next major version of Kibana and Elasticsearch. We recommend using {painlessLink} for new scripted fields.",values:{language:Object(p.jsx)(u.EuiCode,null,e.lang),painlessLink:Object(p.jsx)(u.EuiLink,{target:"_blank",href:this.context.services.docLinks.links.scriptedFields.painless},Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.warningLabel.painlessLinkLabel",defaultMessage:"Painless"}))}})):null},Object(p.jsx)(u.EuiSelect,{value:e.lang,options:t.map((e=>({value:e,text:e}))),"data-test-subj":"editorFieldLang",onChange:e=>{this.onLangChange(e.target.value)}})):null}renderType(){const{spec:e,fieldTypes:t}=this.state;return Object(p.jsx)(u.EuiFormRow,{label:d.i18n.translate("indexPatternManagement.typeLabel",{defaultMessage:"Type"})},Object(p.jsx)(u.EuiSelect,{value:e.type,disabled:!e.scripted,options:t.map((e=>({value:e,text:e}))),"data-test-subj":"editorFieldType",onChange:e=>{this.onTypeChange(e.target.value)}}))}renderCustomLabel(){const{customLabel:e,spec:t}=this.state;return Object(p.jsx)(u.EuiFormRow,{label:d.i18n.translate("indexPatternManagement.customLabel",{defaultMessage:"Custom label"}),helpText:Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.labelHelpText",defaultMessage:"Set a custom label to use when this field is displayed in Discover, Maps, and Visualize. Queries and filters don't currently support a custom label and will use the original field name."})},Object(p.jsx)(u.EuiFieldText,{value:e||"",placeholder:t.name,"data-test-subj":"editorFieldCustomLabel",onChange:e=>{this.setState({customLabel:e.target.value})}}))}renderTypeConflict(){const{spec:e}=this.state;if(!e.conflictDescriptions||"object"!=typeof e.conflictDescriptions)return null;const t=[{field:"type",name:d.i18n.translate("indexPatternManagement.typeLabel",{defaultMessage:"Type"}),width:"100px"},{field:"indices",name:d.i18n.translate("indexPatternManagement.indexNameLabel",{defaultMessage:"Index names"})}],a=Object.entries(e.conflictDescriptions).map((([e,t])=>({type:e,indices:Array.isArray(t)?t.join(", "):"Index names unavailable"})));return Object(p.jsx)("div",null,Object(p.jsx)(u.EuiSpacer,{size:"m"}),Object(p.jsx)(u.EuiCallOut,{color:"warning",iconType:"alert",title:Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.fieldTypeConflict",defaultMessage:"Field type conflict"}),size:"s"},Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.multiTypeLabelDesc",defaultMessage:"The type of this field changes across indices. It is unavailable for many analysis functions. The indices per type are as follows:"})),Object(p.jsx)(u.EuiSpacer,{size:"m"}),Object(p.jsx)(u.EuiBasicTable,{items:a,columns:t}),Object(p.jsx)(u.EuiSpacer,{size:"m"}))}renderFormat(){const{spec:e,fieldTypeFormats:t,fieldFormatId:a,fieldFormatParams:i,format:s}=this.state,{fieldFormatEditors:r}=this.context.services,l=t[0].defaultFieldFormat.title,d=l?Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.defaultFormatHeader",defaultMessage:"Format (Default: {defaultFormat})",values:{defaultFormat:Object(p.jsx)(u.EuiCode,null,l)}}):Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.formatHeader",defaultMessage:"Format"});return Object(p.jsx)(n.Fragment,null,Object(p.jsx)(u.EuiFormRow,{label:d,helpText:Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.formatLabel",defaultMessage:"Formatting controls how values are displayed. Changing this setting might also affect the field value and highlighting in Discover."})},Object(p.jsx)(u.EuiSelect,{value:a,options:t.map((e=>({value:e.id||"",text:e.title}))),"data-test-subj":"editorSelectedFormatId",onChange:e=>{this.onFormatChange(e.target.value)}})),a?Object(p.jsx)(field_format_editor_FieldFormatEditor,{fieldType:e.type,fieldFormat:s,fieldFormatId:a,fieldFormatParams:i||{},fieldFormatEditors:r,onChange:this.onFormatParamsChange,onError:this.onFormatParamsError}):null)}renderPopularity(){const{spec:e}=this.state;return Object(p.jsx)(u.EuiFormRow,{label:d.i18n.translate("indexPatternManagement.popularityLabel",{defaultMessage:"Popularity",description:'"Popularity" refers to Kibana\'s measurement how popular a field is (i.e. how commonly it is used).'})},Object(p.jsx)(u.EuiFieldNumber,{value:e.count,"data-test-subj":"editorFieldCount",onChange:e=>{this.onFieldChange("count",e.target.value?Number(e.target.value):"")}}))}renderScript(){var e;const{spec:t,hasScriptError:a}=this.state,i=!t.script||!t.script.trim()||a,s=a?Object(p.jsx)("span",{"data-test-subj":"invalidScriptError"},Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.scriptInvalidErrorMessage",defaultMessage:"Script is invalid. View script preview for details"})):Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.scriptRequiredErrorMessage",defaultMessage:"Script is required"});return t.scripted?Object(p.jsx)(n.Fragment,null,Object(p.jsx)(u.EuiFormRow,{fullWidth:!0,label:d.i18n.translate("indexPatternManagement.scriptLabel",{defaultMessage:"Script"}),isInvalid:i,error:i?s:null},Object(p.jsx)(c.CodeEditor,{languageId:Pt.PainlessLang.ID,width:"100%",height:"300px",value:null!==(e=t.script)&&void 0!==e?e:"",onChange:this.onScriptChange,"data-test-subj":"editorFieldScript","aria-label":d.i18n.translate("indexPatternManagement.scriptLabelAriaLabel",{defaultMessage:"Script editor"})})),Object(p.jsx)(u.EuiFormRow,null,Object(p.jsx)(n.Fragment,null,Object(p.jsx)(u.EuiText,null,Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.script.accessWithLabel",defaultMessage:"Access fields with {code}.",values:{code:Object(p.jsx)("code",null,"doc['some_field'].value")}})),Object(p.jsx)("br",null),Object(p.jsx)(u.EuiLink,{onClick:this.showScriptingHelp,"data-test-subj":"scriptedFieldsHelpLink"},Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.script.getHelpLabel",defaultMessage:"Get help with the syntax and preview the results of your script."}))))):null}renderActions(){const{isCreating:e,spec:t,isSaving:a}=this.state,{redirectAway:n}=this.props.services;return Object(p.jsx)(u.EuiFormRow,null,Object(p.jsx)(u.EuiFlexGroup,null,Object(p.jsx)(u.EuiFlexItem,{grow:!1},Object(p.jsx)(u.EuiButton,{fill:!0,onClick:this.saveField,isDisabled:this.isSavingDisabled(),isLoading:a,"data-test-subj":"fieldSaveButton"},e?Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.actions.createButton",defaultMessage:"Create field"}):Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.actions.saveButton",defaultMessage:"Save field"}))),Object(p.jsx)(u.EuiFlexItem,{grow:!1},Object(p.jsx)(u.EuiButtonEmpty,{onClick:n,"data-test-subj":"fieldCancelButton"},Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.actions.cancelButton",defaultMessage:"Cancel"}))),!e&&t.scripted?Object(p.jsx)(u.EuiFlexItem,null,Object(p.jsx)(u.EuiFlexGroup,{justifyContent:"flexEnd"},Object(p.jsx)(u.EuiFlexItem,{grow:!1},Object(p.jsx)(u.EuiButtonEmpty,{color:"danger",onClick:this.showDeleteModal},Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.actions.deleteButton",defaultMessage:"Delete"}))))):null))}isSavingDisabled(){const{spec:e,hasFormatError:t,hasScriptError:a}=this.state;return!(!t&&!a&&e.name&&e.name.trim()&&(!e.scripted||e.script&&e.script.trim()))}render(){const{isReady:e,isCreating:t,spec:a}=this.state;return e?Object(p.jsx)("div",null,Object(p.jsx)(u.EuiText,null,Object(p.jsx)("h3",null,t?Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.createHeader",defaultMessage:"Create scripted field"}):Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.editHeader",defaultMessage:"Edit {fieldName}",values:{fieldName:a.name}}))),Object(p.jsx)(u.EuiSpacer,{size:"m"}),Object(p.jsx)(u.EuiForm,null,this.renderScriptingPanels(),this.renderName(),this.renderCustomLabel(),this.renderLanguage(),this.renderType(),this.renderTypeConflict(),this.renderFormat(),this.renderPopularity(),this.renderScript(),this.renderActions(),this.renderDeleteModal()),Object(p.jsx)(u.EuiSpacer,{size:"l"})):null}}U()(field_editor_FieldEditor,"contextType",c.context);const Wt=d.i18n.translate("indexPatternManagement.editIndexPattern.scripted.newFieldPlaceholder",{defaultMessage:"New Scripted Field"}),qt=Object(l.withRouter)((({indexPattern:e,mode:t,fieldName:a,history:n})=>{var s;const{uiSettings:r,chrome:l,notifications:o,dataViews:m}=Object(c.useKibana)().services,g="edit"===t&&a?null===(s=e.fields.getByName(a))||void 0===s?void 0:s.spec:{scripted:!0,type:"number",name:void 0},b=`/dataView/${e.id}`;if("edit"===t&&!g){const t=d.i18n.translate("indexPatternManagement.editDataView.scripted.noFieldLabel",{defaultMessage:"'{dataViewTitle}' data view doesn't have a scripted field called '{fieldName}'",values:{dataViewTitle:e.title,fieldName:a}});o.toasts.addWarning(t),n.push(b)}const j=(null==g?void 0:g.name)||Wt;l.docTitle.change([j,e.getName()]);return g?Object(p.jsx)(i.a.Fragment,null,Object(p.jsx)(bt,{indexPattern:e,defaultIndex:r.get("defaultIndex"),canSave:m.getCanSaveSync()}),Object(p.jsx)(u.EuiSpacer,{size:"l"}),Object(p.jsx)(field_editor_FieldEditor,{indexPattern:e,spec:g,services:{indexPatternService:m,redirectAway:()=>{n.push(`${b}#/?_a=(tab:${null!=g&&g.scripted?A:k})`)}}})):Object(p.jsx)(i.a.Fragment,null)})),$t=Object(l.withRouter)((({...e})=>{const{setBreadcrumbs:t,dataViews:a}=Object(c.useKibana)().services,[s,r]=Object(n.useState)(),l=e.match.params.fieldName&&decodeURIComponent(e.match.params.fieldName);return Object(n.useEffect)((()=>{a.get(e.match.params.id).then((e=>{r(e),e&&t(l?function(e,t){return[...w(e,!0),{text:t}]}(e,l):function(e){return[...w(e,!0),{text:d.i18n.translate("indexPatternManagement.indexPatterns.createFieldBreadcrumb",{defaultMessage:"Create field"})}]}(e))}))}),[e.match.params.id,l,t,a]),s?Object(p.jsx)(qt,{indexPattern:s,mode:l?"edit":"create",fieldName:l}):Object(p.jsx)(i.a.Fragment,null)})),Yt=d.i18n.translate("indexPatternManagement.dataViewTable.spaceCountAll",{defaultMessage:"all"}),Jt=d.i18n.translate("indexPatternManagement.dataViewTable.dataViewColumnName",{defaultMessage:"Data view"}),Xt=d.i18n.translate("indexPatternManagement.dataViewTable.spacesColumnName",{defaultMessage:"Spaces"}),Qt=d.i18n.translate("indexPatternManagement.dataViewTable.tableTitle",{defaultMessage:"Data views selected for deletion"}),Zt=(e,t)=>{const a=[{field:"name",name:Jt,sortable:!0}];return t&&a.push({field:"namespaces",name:Xt,sortable:!0,width:"100px",align:"right",render:e=>-1!==e.indexOf("*")?Yt:e.length}),e.forEach((e=>e.name=e.getName())),Object(p.jsx)("div",null,Object(p.jsx)(u.EuiCallOut,{color:"warning",iconType:"alert",title:"Data views are deleted from every space they are shared in."}),Object(p.jsx)(u.EuiSpacer,{size:"m"}),Object(p.jsx)("div",null,Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.dataViewTable.deleteConfirmSummary",defaultMessage:"You'll permanently delete {count, number} {count, plural, one {data view} other {data views}\n}.",values:{count:e.length}})),Object(p.jsx)(u.EuiSpacer,{size:"m"}),Object(p.jsx)(u.EuiBasicTable,{tableCaption:Qt,items:e,columns:a}))},ea={initialPageSize:10,pageSizeOptions:[5,10,25,50]},ta={sort:{field:"title",direction:"asc"}},aa=d.i18n.translate("indexPatternManagement.dataViewTable.title",{defaultMessage:"Data Views"}),na=d.i18n.translate("indexPatternManagement.indexPatternTable.badge.securityDataViewTitle",{defaultMessage:"Security Data View"}),ia=({children:e})=>Object(p.jsx)(i.a.Fragment,null,e),sa=Object(l.withRouter)((({history:e,canSave:t,showCreateDialog:a=!1})=>{const{setBreadcrumbs:s,uiSettings:r,indexPatternManagementStart:m,application:g,chrome:b,dataViews:j,IndexPatternEditor:x,spaces:f,overlays:O,docLinks:M}=Object(c.useKibana)().services,[F,v]=Object(n.useState)(""),[P,S]=Object(n.useState)([]),[w,C]=Object(n.useState)(!0),[I,L]=Object(n.useState)(a),[_,N]=Object(n.useState)([]),[k,A]=Object(n.useState)(!0),[R,B]=Object(n.useState)({}),{hasDataView:V,hasESData:U}=R,z=(()=>{const e=ft({dataViews:j,overlays:O,uiSettings:r,onDelete:()=>{N([]),G()}});if(0!==_.length)return Object(p.jsx)(u.EuiButton,{color:"danger",iconType:"trash",onClick:()=>e(_,Zt(_,!!f))},Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.dataViewTable.deleteButtonLabel",defaultMessage:"Delete {selectedItems, number} {selectedItems, plural, one {Data View} other {Data Views}\n}",values:{selectedItems:_.length}}))})(),H={toolsLeft:z&&[z],query:F,onChange:({queryText:e,error:t})=>{t||v(e)},box:{incremental:!0,schema:{fields:{title:{type:"string"}}}}},G=Object(n.useCallback)((async()=>{C(!0),B({hasDataView:await j.hasData.hasDataView(),hasESData:await j.hasData.hasESData()}),A(!1);const e=await async function(e,t){return(await t.getIdsWithTitle(!0)).map((t=>{const{id:a,title:n,namespaces:i,name:s}=t,r=e===a,l=E(t,r),d=s||n;return{id:a,namespaces:i,title:n,name:s,default:r,tags:l,sort:`${r?"0":"1"}${d}`,getName:()=>d}})).sort(((e,t)=>e.sort<t.sort?-1:e.sort>t.sort?1:0))||[]}(r.get("defaultIndex"),j);return S(e),C(!1),e}),[j,r]);s(T()),Object(n.useEffect)((()=>{!async function(){await G()}()}),[m,r,G]),b.docTitle.change(aa);const K="rollup"===new URLSearchParams(Object(l.useLocation)().search).get("type"),W=Object(n.useMemo)((()=>f?f.ui.components.getSpacesContextProvider:ia),[f]),q=ft({dataViews:j,uiSettings:r,overlays:O,onDelete:()=>G()}),$={name:"Actions",field:"id",width:"10%",actions:[{name:d.i18n.translate("indexPatternManagement.dataViewTable.columnDelete",{defaultMessage:"Delete"}),description:d.i18n.translate("indexPatternManagement.dataViewTable.columnDeleteDescription",{defaultMessage:"Delete this data view"}),icon:"trash",color:"danger",type:"icon",onClick:e=>q([e],Zt([e],!!f)),isPrimary:!0,"data-test-subj":"action-delete"}]},Y=[{field:"title",name:d.i18n.translate("indexPatternManagement.dataViewTable.nameColumn",{defaultMessage:"Name"}),width:"70%",render:(t,a)=>{var n,s;return Object(p.jsx)("div",null,Object(p.jsx)(u.EuiLink,Object(c.reactRouterNavigate)(e,`patterns/${a.id}`),a.getName(),a.name?Object(p.jsx)(i.a.Fragment,null,"Â ",Object(p.jsx)(u.EuiIconTip,{type:"iInCircle",color:"text","aria-label":a.title,content:a.title})):null),0===(null==a||null===(n=a.id)||void 0===n?void 0:n.indexOf("security-solution"))&&Object(p.jsx)(i.a.Fragment,null,"â€ƒ",Object(p.jsx)(u.EuiBadge,null,na)),null==a||null===(s=a.tags)||void 0===s?void 0:s.map((({key:e,name:t})=>Object(p.jsx)(i.a.Fragment,null,"â€ƒ",Object(p.jsx)(u.EuiBadge,{key:e},t)))))},dataType:"string",sortable:({sort:e})=>e},{field:"namespaces",name:d.i18n.translate("indexPatternManagement.dataViewTable.spacesColumn",{defaultMessage:"Spaces"}),width:"20%",render:(e,t)=>f?Object(p.jsx)(D,{spacesApi:f,capabilities:null==g?void 0:g.capabilities,spaceIds:t.namespaces||[],id:t.id,title:t.title,refresh:()=>{j.clearInstanceCache(t.id),G()}}):Object(p.jsx)(i.a.Fragment,null)}];j.getCanSaveSync()&&Y.push($);const J=t?Object(p.jsx)(u.EuiButton,{fill:!0,iconType:"plusInCircle",onClick:()=>L(!0),"data-test-subj":"createIndexPatternButton"},Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.dataViewTable.createBtn",defaultMessage:"Create data view"})):Object(p.jsx)(i.a.Fragment,null);if(w)return Object(p.jsx)(i.a.Fragment,null);const X=I?Object(p.jsx)(x,{onSave:t=>{e.push(`patterns/${t.id}`)},onCancel:()=>L(!1),defaultTypeIsRollup:K}):Object(p.jsx)(i.a.Fragment,null),Q={onSelectionChange:N};let Z=Object(p.jsx)(i.a.Fragment,null,Object(p.jsx)(u.EuiPageHeader,{pageTitle:aa,description:Object(p.jsx)(o.FormattedMessage,{id:"indexPatternManagement.dataViewTable.indexPatternExplanation",defaultMessage:"Create and manage the data views that help you retrieve your data from Elasticsearch."}),bottomBorder:!0,rightSideItems:[J]}),Object(p.jsx)(u.EuiSpacer,{size:"l"}),Object(p.jsx)(W,null,Object(p.jsx)(u.EuiInMemoryTable,{allowNeutralSort:!1,itemId:"id",isSelectable:j.getCanSaveSync(),items:P,columns:Y,pagination:ea,sorting:ta,search:H,selection:j.getCanSaveSync()?Q:void 0})));return V||(Z=Object(p.jsx)(i.a.Fragment,null,Object(p.jsx)(u.EuiSpacer,{size:"xxl"}),Object(p.jsx)(h,{onClickCreate:()=>L(!0),canCreateNewDataView:g.capabilities.indexPatterns.save,dataViewsDocLink:M.links.indexPatterns.introduction,emptyPromptColor:"subdued"}))),V||U||(Z=Object(p.jsx)(i.a.Fragment,null,Object(p.jsx)(u.EuiSpacer,{size:"xxl"}),Object(p.jsx)(y,{onRefresh:G,createAnyway:()=>L(!0),canSaveIndexPattern:!!g.capabilities.indexPatterns.save,navigateToApp:g.navigateToApp,addDataUrl:M.links.indexPatterns.introduction}))),Object(p.jsx)("div",{"data-test-subj":"indexPatternTable",role:"region","aria-label":aa},k?Object(p.jsx)("div",{style:{display:"flex",justifyContent:"center"}},Object(p.jsx)(u.EuiLoadingSpinner,{size:"xxl"})):Z,X)})),ra={text:d.i18n.translate("indexPatternManagement.indexPatterns.badge.readOnly.text",{defaultMessage:"Read only"}),tooltip:d.i18n.translate("indexPatternManagement.dataViews.badge.readOnly.tooltip",{defaultMessage:"Unable to save data views"}),iconType:"glasses"};async function la(e,t){const[{application:a,chrome:n,uiSettings:i,notifications:s,overlays:d,http:u,docLinks:m,theme:g},{data:b,dataViewFieldEditor:j,dataViewEditor:x,dataViews:f,fieldFormats:h,unifiedSearch:O,spaces:M,savedObjectsManagement:y},F]=await e(),v=f.getCanSaveSync();v||n.setBadge(ra);const P={application:a,chrome:n,uiSettings:i,notifications:s,overlays:d,unifiedSearch:O,http:u,docLinks:m,data:b,dataViewFieldEditor:j,dataViews:f,indexPatternManagementStart:F,setBreadcrumbs:t.setBreadcrumbs,fieldFormatEditors:j.fieldFormatEditors,IndexPatternEditor:x.IndexPatternEditorComponent,fieldFormats:h,spaces:M,theme:g,savedObjectsManagement:y};return r.a.render(Object(p.jsx)(c.KibanaContextProvider,{services:P},Object(p.jsx)(c.KibanaThemeProvider,{theme$:g.theme$},Object(p.jsx)(o.I18nProvider,null,Object(p.jsx)(l.Router,{history:t.history},Object(p.jsx)(l.Switch,null,Object(p.jsx)(l.Route,{path:["/create"]},Object(p.jsx)(sa,{canSave:v,showCreateDialog:!0})),Object(p.jsx)(l.Route,{path:["/dataView/:id/field/:fieldName","/dataView/:id/create-field/"]},Object(p.jsx)($t,null)),Object(p.jsx)(l.Route,{path:["/dataView/:id"]},Object(p.jsx)(vt,null)),Object(p.jsx)(l.Redirect,{path:"/patterns*",to:"dataView*"}),Object(p.jsx)(l.Route,{path:["/"]},Object(p.jsx)(sa,{canSave:v}))))))),t.element),()=>{n.docTitle.reset(),r.a.unmountComponentAtNode(t.element)}}},function(e,t,a){e.exports=a(12)(2)},function(e,t,a){e.exports=a(12)(3)},function(e,t,a){e.exports=a(12)(6)},function(e,t,a){"use strict";var n,i=function(){var e={};return function(t){if(void 0===e[t]){var a=document.querySelector(t);if(window.HTMLIFrameElement&&a instanceof window.HTMLIFrameElement)try{a=a.contentDocument.head}catch(e){a=null}e[t]=a}return e[t]}}(),s=[];function r(e){for(var t=-1,a=0;a<s.length;a++)if(s[a].identifier===e){t=a;break}return t}function l(e,t){for(var a={},n=[],i=0;i<e.length;i++){var l=e[i],d=t.base?l[0]+t.base:l[0],o=a[d]||0,c="".concat(d," ").concat(o);a[d]=o+1;var u=r(c),p={css:l[1],media:l[2],sourceMap:l[3]};-1!==u?(s[u].references++,s[u].updater(p)):s.push({identifier:c,updater:b(p,t),references:1}),n.push(c)}return n}function d(e){var t=document.createElement("style"),n=e.attributes||{};if(void 0===n.nonce){var s=a.nc;s&&(n.nonce=s)}if(Object.keys(n).forEach((function(e){t.setAttribute(e,n[e])})),"function"==typeof e.insert)e.insert(t);else{var r=i(e.insert||"head");if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(t)}return t}var o,c=(o=[],function(e,t){return o[e]=t,o.filter(Boolean).join("\n")});function u(e,t,a,n){var i=a?"":n.media?"@media ".concat(n.media," {").concat(n.css,"}"):n.css;if(e.styleSheet)e.styleSheet.cssText=c(t,i);else{var s=document.createTextNode(i),r=e.childNodes;r[t]&&e.removeChild(r[t]),r.length?e.insertBefore(s,r[t]):e.appendChild(s)}}function p(e,t,a){var n=a.css,i=a.media,s=a.sourceMap;if(i?e.setAttribute("media",i):e.removeAttribute("media"),s&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}var m=null,g=0;function b(e,t){var a,n,i;if(t.singleton){var s=g++;a=m||(m=d(t)),n=u.bind(null,a,s,!1),i=u.bind(null,a,s,!0)}else a=d(t),n=p.bind(null,a,t),i=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(a)};return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else i()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===n&&(n=Boolean(window&&document&&document.all&&!window.atob)),n));var a=l(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var n=0;n<a.length;n++){var i=r(a[n]);s[i].references--}for(var d=l(e,t),o=0;o<a.length;o++){var c=r(a[o]);0===s[c].references&&(s[c].updater(),s.splice(c,1))}a=d}}}},function(e,t,a){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var a=function(e,t){var a,n,i,s=e[1]||"",r=e[3];if(!r)return s;if(t&&"function"==typeof btoa){var l=(a=r,n=btoa(unescape(encodeURIComponent(JSON.stringify(a)))),i="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(n),"/*# ".concat(i," */")),d=r.sources.map((function(e){return"/*# sourceURL=".concat(r.sourceRoot||"").concat(e," */")}));return[s].concat(d).concat([l]).join("\n")}return[s].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(a,"}"):a})).join("")},t.i=function(e,a,n){"string"==typeof e&&(e=[[null,e,""]]);var i={};if(n)for(var s=0;s<this.length;s++){var r=this[s][0];null!=r&&(i[r]=!0)}for(var l=0;l<e.length;l++){var d=[].concat(e[l]);n&&i[d[0]]||(a&&(d[2]?d[2]="".concat(a," and ").concat(d[2]):d[2]=a),t.push(d))}},t}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createSelector=void 0,t.createSelectorCreator=s,t.createStructuredSelector=void 0,Object.defineProperty(t,"defaultEqualityCheck",{enumerable:!0,get:function(){return n.defaultEqualityCheck}}),Object.defineProperty(t,"defaultMemoize",{enumerable:!0,get:function(){return n.defaultMemoize}});var n=a(37);function i(e){var t=Array.isArray(e[0])?e[0]:e;if(!t.every((function(e){return"function"==typeof e}))){var a=t.map((function(e){return"function"==typeof e?"function "+(e.name||"unnamed")+"()":typeof e})).join(", ");throw new Error("createSelector expects all input-selectors to be functions, but received the following types: ["+a+"]")}return t}function s(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n];var s=function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];var r,l=0,d={memoizeOptions:void 0},o=n.pop();if("object"==typeof o&&(d=o,o=n.pop()),"function"!=typeof o)throw new Error("createSelector expects an output function after the inputs, but received: ["+typeof o+"]");var c=d,u=c.memoizeOptions,p=void 0===u?a:u,m=Array.isArray(p)?p:[p],g=i(n),b=e.apply(void 0,[function(){return l++,o.apply(null,arguments)}].concat(m)),j=e((function(){for(var e=[],t=g.length,a=0;a<t;a++)e.push(g[a].apply(null,arguments));return r=b.apply(null,e)}));return Object.assign(j,{resultFunc:o,memoizedResultFunc:b,dependencies:g,lastResult:function(){return r},recomputations:function(){return l},resetRecomputations:function(){return l=0}}),j};return s}var r=s(n.defaultMemoize);t.createSelector=r,t.createStructuredSelector=function(e,t){if(void 0===t&&(t=r),"object"!=typeof e)throw new Error("createStructuredSelector expects first argument to be an object where each property is a selector, instead received a "+typeof e);var a=Object.keys(e),n=t(a.map((function(t){return e[t]})),(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((function(e,t,n){return e[a[n]]=t,e}),{})}));return n}},,,function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(33);case"v8light":return a(35)}},function(e,t,a){var n=a(27),i=a(34);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);n(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,a){(t=a(28)(!1)).push([e.i,".inpEmptyState__footer{background:#25262e;border-radius:0 0 6px 6px;margin:0 -24px -24px;padding:24px}@media only screen and (max-width:574px){.inpEmptyState__footer{text-align:center}}@media only screen and (min-width:575px) and (max-width:767px){.inpEmptyState__footer{text-align:center}}.inpEmptyState{max-width:760px!important}.inpEmptyState__cardGrid{justify-content:center}.inpEmptyState__card{min-width:192px}.inpEmptyState__footerFlexItem{min-width:224px}",""]),e.exports=t},function(e,t,a){var n=a(27),i=a(36);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);n(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,a){(t=a(28)(!1)).push([e.i,".inpEmptyState__footer{background:#f5f7fa;border-radius:0 0 6px 6px;margin:0 -24px -24px;padding:24px}@media only screen and (max-width:574px){.inpEmptyState__footer{text-align:center}}@media only screen and (min-width:575px) and (max-width:767px){.inpEmptyState__footer{text-align:center}}.inpEmptyState{max-width:760px!important}.inpEmptyState__cardGrid{justify-content:center}.inpEmptyState__card{min-width:192px}.inpEmptyState__footerFlexItem{min-width:224px}",""]),e.exports=t},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createCacheKeyComparator=s,t.defaultEqualityCheck=void 0,t.defaultMemoize=function(e,t){var a,r,l="object"==typeof t?t:{equalityCheck:t},d=l.equalityCheck,o=void 0===d?i:d,c=l.maxSize,u=void 0===c?1:c,p=l.resultEqualityCheck,m=s(o),g=1===u?(a=m,{get:function(e){return r&&a(r.key,e)?r.value:n},put:function(e,t){r={key:e,value:t}},getEntries:function(){return r?[r]:[]},clear:function(){r=void 0}}):function(e,t){var a=[];function i(e){var i=a.findIndex((function(a){return t(e,a.key)}));if(i>-1){var s=a[i];return i>0&&(a.splice(i,1),a.unshift(s)),s.value}return n}return{get:i,put:function(t,s){i(t)===n&&(a.unshift({key:t,value:s}),a.length>e&&a.pop())},getEntries:function(){return a},clear:function(){a=[]}}}(u,m);function b(){var t=g.get(arguments);if(t===n){if(t=e.apply(null,arguments),p){var a=g.getEntries(),i=a.find((function(e){return p(e.value,t)}));i&&(t=i.value)}g.put(arguments,t)}return t}return b.clearCache=function(){return g.clear()},b};var n="NOT_FOUND",i=function(e,t){return e===t};function s(e){return function(t,a){if(null===t||null===a||t.length!==a.length)return!1;for(var n=t.length,i=0;i<n;i++)if(!e(t[i],a[i]))return!1;return!0}}t.defaultEqualityCheck=i},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(18),i=a(6),s=n.__importDefault(a(39));t.default=function(e,t){var a=i.useState(t),n=a[0],r=a[1];return s.default((function(){var t=e.subscribe(r);return function(){return t.unsubscribe()}}),[e]),n}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(6),i="undefined"!=typeof window?n.useLayoutEffect:n.useEffect;t.default=i},function(e,t,a){e.exports=a(12)(17)},function(e,t,a){e.exports=a(12)(16)}])]);