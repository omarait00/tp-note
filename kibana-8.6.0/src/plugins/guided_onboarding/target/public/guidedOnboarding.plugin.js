!function(e){var t={};function i(a){if(t[a])return t[a].exports;var n=t[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=t,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(a,n,function(t){return e[t]}.bind(null,n));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=9)}([function(e,t){e.exports=__kbnSharedDeps__.EmotionReact},function(e,t){e.exports=__kbnSharedDeps__.KbnI18n},function(e,t){e.exports=__kbnSharedDeps__.ElasticEui},function(e,t){e.exports=__kbnSharedDeps__.React},function(e,t){e.exports=__kbnSharedDeps__.Rxjs},function(e,t,i){e.exports=i(11)(2)},function(e,t){e.exports=__kbnSharedDeps__.KbnI18nReact},function(e,t){e.exports=__kbnSharedDeps__.ReactDom},function(e,t,i){i.r(t);var a=__kbnBundles__.get("plugin/kibanaReact/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(a))},function(e,t,i){i(10),__kbnBundles__.define("plugin/guidedOnboarding/public",i,12)},function(e,t,i){i.p=window.__kbnPublicPath__.guidedOnboarding},function(e,t){e.exports=__kbnSharedDeps_npm__},function(e,t,i){"use strict";i.r(t),i.d(t,"plugin",(function(){return L})),i.d(t,"guidesConfig",(function(){return g}));var a=i(7),n=i.n(a),s=i(3),o=i.n(s),r=i(6),d=i(8),u=i(2),l=i(1);const c={title:l.i18n.translate("guidedOnboarding.securityGuide.title",{defaultMessage:"Elastic Security guided setup"}),guideName:"Security",completedGuideRedirectLocation:{appID:"securitySolutionUI",path:"/dashboards"},description:l.i18n.translate("guidedOnboarding.securityGuide.description",{defaultMessage:"We'll help you get set up quickly, using Elastic Defend."}),steps:[{id:"add_data",title:l.i18n.translate("guidedOnboarding.securityGuide.addDataStep.title",{defaultMessage:"Add data with Elastic Defend"}),descriptionList:[l.i18n.translate("guidedOnboarding.securityGuide.addDataStep.description1",{defaultMessage:"Use Elastic Defend to add your data."}),l.i18n.translate("guidedOnboarding.securityGuide.addDataStep.description2",{defaultMessage:"See data coming in to your SIEM."})],integration:"endpoint",location:{appID:"integrations",path:"/browse/security"}},{id:"rules",title:l.i18n.translate("guidedOnboarding.securityGuide.rulesStep.title",{defaultMessage:"Turn on rules"}),descriptionList:[l.i18n.translate("guidedOnboarding.securityGuide.rulesStep.description1",{defaultMessage:"Load the Elastic prebuilt rules."}),l.i18n.translate("guidedOnboarding.securityGuide.rulesStep.description2",{defaultMessage:"Select and enable rules."}),l.i18n.translate("guidedOnboarding.securityGuide.rulesStep.description3",{defaultMessage:"Enable rules to generate alerts."})],manualCompletion:{title:l.i18n.translate("guidedOnboarding.securityGuide.rulesStep.manualCompletion.title",{defaultMessage:"Continue with the guide"}),description:l.i18n.translate("guidedOnboarding.securityGuide.rulesStep.manualCompletion.description",{defaultMessage:"After you’ve enabled the rules you need, continue."})},location:{appID:"securitySolutionUI",path:"/rules"}},{id:"alertsCases",title:l.i18n.translate("guidedOnboarding.securityGuide.alertsStep.title",{defaultMessage:"Manage alerts and cases"}),descriptionList:[l.i18n.translate("guidedOnboarding.securityGuide.alertsStep.description1",{defaultMessage:"View and triage alerts."}),l.i18n.translate("guidedOnboarding.securityGuide.alertsStep.description2",{defaultMessage:"Create a case."})],location:{appID:"securitySolutionUI",path:"/alerts"},manualCompletion:{title:l.i18n.translate("guidedOnboarding.securityGuide.alertsStep.manualCompletion.title",{defaultMessage:"Continue the guide"}),description:l.i18n.translate("guidedOnboarding.securityGuide.alertsStep.manualCompletion.description",{defaultMessage:"After you've explored the case, continue."})}}]};var p=i(0);const g={security:c,observability:{title:l.i18n.translate("guidedOnboarding.observabilityGuide.title",{defaultMessage:"Observe my Kubernetes infrastructure"}),description:l.i18n.translate("guidedOnboarding.observabilityGuide.description",{defaultMessage:"We'll help you quickly get visibility into your Kubernetes environment with our Elastic integration. Gain deep insights from your logs, metrics, and traces to proactively detect issues and take action to resolve them."}),guideName:"Kubernetes",docs:{text:l.i18n.translate("guidedOnboarding.observabilityGuide.documentationLink",{defaultMessage:"Learn more"}),url:"https://docs.elastic.co/en/integrations/kubernetes"},steps:[{id:"add_data",title:l.i18n.translate("guidedOnboarding.observabilityGuide.addDataStep.title",{defaultMessage:"Add and verify your data"}),integration:"kubernetes",descriptionList:[Object(p.jsx)(r.FormattedMessage,{id:"guidedOnboarding.observabilityGuide.addDataStep.descriptionList.item1",defaultMessage:"Deploy {kubeStateMetricsLink} service to your Kubernetes.",values:{kubeStateMetricsLink:Object(p.jsx)(u.EuiLink,{external:!0,target:"_blank",href:"https://github.com/kubernetes/kube-state-metrics"},"kube-state-metrics")}}),l.i18n.translate("guidedOnboarding.observabilityGuide.addDataStep.descriptionList.item2",{defaultMessage:"Add the Elastic Kubernetes integration."})],location:{appID:"integrations",path:"/detail/kubernetes/overview"}},{id:"view_dashboard",title:l.i18n.translate("guidedOnboarding.observabilityGuide.viewDashboardStep.title",{defaultMessage:"Explore Kubernetes metrics"}),description:l.i18n.translate("guidedOnboarding.observabilityGuide.viewDashboardStep.description",{defaultMessage:"Stream, visualize, and analyze your Kubernetes infrastructure metrics."}),location:{appID:"dashboards",path:"#/view/kubernetes-f4dc26db-1b53-4ea2-a78b-1bfab8ea267c"},manualCompletion:{title:l.i18n.translate("guidedOnboarding.observabilityGuide.viewDashboardStep.manualCompletionPopoverTitle",{defaultMessage:"Explore Kubernetes dashboards"}),description:l.i18n.translate("guidedOnboarding.observabilityGuide.viewDashboardStep.manualCompletionPopoverDescription",{defaultMessage:"Take your time to explore these pre-built dashboards included with the Kubernetes integration. When you’re ready, click the Setup guide button to continue."}),readyToCompleteOnNavigation:!0}},{id:"tour_observability",title:l.i18n.translate("guidedOnboarding.observabilityGuide.tourObservabilityStep.title",{defaultMessage:"Tour Elastic Observability"}),description:l.i18n.translate("guidedOnboarding.observabilityGuide.tourObservabilityStep.description",{defaultMessage:"Get familiar with the rest of Elastic Observability and explore even more integrations."}),location:{appID:"observability",path:"/overview"}}]},search:{title:l.i18n.translate("guidedOnboarding.searchGuide.title",{defaultMessage:"Search my data"}),description:l.i18n.translate("guidedOnboarding.searchGuide.description",{defaultMessage:"Build custom search experiences with your data using Elastic’s out-of-the-box web crawler, connectors, and robust APIs. Gain deep insights from the built-in search analytics to curate results and optimize relevance."}),guideName:"Enterprise Search",steps:[{id:"add_data",title:l.i18n.translate("guidedOnboarding.searchGuide.addDataStep.title",{defaultMessage:"Add data"}),descriptionList:[l.i18n.translate("guidedOnboarding.searchGuide.addDataStep.description1",{defaultMessage:"Select an ingestion method."}),l.i18n.translate("guidedOnboarding.searchGuide.addDataStep.description2",{defaultMessage:"Create a new Elasticsearch index."}),l.i18n.translate("guidedOnboarding.searchGuide.addDataStep.description3",{defaultMessage:"Configure your ingestion settings."})],location:{appID:"enterpriseSearchContent",path:"/search_indices/new_index"}},{id:"search_experience",title:l.i18n.translate("guidedOnboarding.searchGuide.searchExperienceStep.title",{defaultMessage:"Build a search experience"}),descriptionList:[l.i18n.translate("guidedOnboarding.searchGuide.searchExperienceStep.descriptionList.item1",{defaultMessage:"Learn more about Elastic’s Search UI framework."}),l.i18n.translate("guidedOnboarding.searchGuide.searchExperienceStep.descriptionList.item2",{defaultMessage:"Try the Search UI tutorial for Elasticsearch."}),l.i18n.translate("guidedOnboarding.searchGuide.searchExperienceStep.descriptionList.item3",{defaultMessage:"Build a world-class search experience for your customers, employees, or users."})],location:{appID:"searchExperiences",path:""},manualCompletion:{title:l.i18n.translate("guidedOnboarding.searchGuide.searchExperienceStep.manualCompletionPopoverTitle",{defaultMessage:"Explore Search UI"}),description:l.i18n.translate("guidedOnboarding.searchGuide.searchExperienceStep.manualCompletionPopoverDescription",{defaultMessage:"Take your time to explore how to use Search UI to build world-class search experiences. When you’re ready, click the Setup guide button to continue."}),readyToCompleteOnNavigation:!0}}]},testGuide:{title:"Test guide for development",description:"This guide is used to test the guided onboarding UI while in development and to run automated tests for the API and UI components.",guideName:"Testing example",completedGuideRedirectLocation:{appID:"guidedOnboardingExample",path:"/"},docs:{text:"Testing example docs",url:"example.com"},steps:[{id:"step1",title:"Step 1 (completed via an API request)",descriptionList:["This step is directly completed by clicking the button that uses the API function 'completeGuideStep","Navigate to /guidedOnboardingExample/stepOne to complete the step."],location:{appID:"guidedOnboardingExample",path:"stepOne"},integration:"testIntegration"},{id:"step2",title:"Step 2 (manual completion after navigation)",descriptionList:["This step is set to ready_to_complete on page navigation.","After that click the popover on the guide button in the header and mark the step done"],location:{appID:"guidedOnboardingExample",path:"stepTwo"},manualCompletion:{title:"Manual completion step title",description:'Mark the step complete by opening the panel and clicking the button "Mark done"',readyToCompleteOnNavigation:!0}},{id:"step3",title:"Step 3 (manual completion after click)",description:"This step is completed by clicking a button on the page and then clicking the popover on the guide button in the header and marking the step done",manualCompletion:{title:"Manual completion step title",description:'Mark the step complete by opening the panel and clicking the button "Mark done"'},location:{appID:"guidedOnboardingExample",path:"stepThree"}}]}},b=e=>{if(e&&Object.keys(g).includes(e))return g[e]},h=(e,t)=>{const i=b(e);return null==i?void 0:i.steps.find((e=>e.id===t))},m=e=>{const t=e.steps.find((e=>"in_progress"===e.status));return t?t.id:void 0},f=(e,t)=>{if(!e||!e.isActive)return!1;const i=(e=>{const t=m(e);if(t){const i=b(e.guideId);if(i)return i.steps.find((e=>e.id===t))}})(e);return!!i&&i.integration===t},O=(e,t)=>{if(!e||"in_progress"!==e.status||!e.activeGuide)return!1;if(t){const{activeGuide:i}=e;return!(!i.isActive||i.guideId!==t)}return!0},j=(e,t,i)=>{if(!e||!e.isActive)return!1;const a=e.steps.find((e=>e.id===i));return!!a&&"in_progress"===a.status},x=(e,t,i)=>{if(!e||!e.isActive)return!1;const a=e.steps.find((e=>e.id===i));return!!a&&"ready_to_complete"===a.status},v=(e,t,i)=>{const a=h(t,i),n=(null==a?void 0:a.manualCompletion)||!1,s=((e,t)=>{const i=b(e),a=((e,t)=>{const i=b(e);return i?i.steps.findIndex((e=>e.id===t)):-1})(e,t),n=(null==i?void 0:i.steps.length)||0;return n>0&&a===n-1})(t,i),o=x(e,0,i);return s&&!n||s&&n&&o?"ready_to_complete":"in_progress"};var y={name:"1se9e8c",styles:"p{margin-left:32px;margin-block-end:0;}ul{padding-left:28px;}"};const S=({accordionId:e,stepStatus:t,stepNumber:i,stepConfig:a,handleButtonClick:n,telemetryGuideId:s})=>{const{euiTheme:r}=Object(u.useEuiTheme)(),d=((e,t)=>({stepNumber:Object(p.css)("width:24px;height:24px;border-radius:50%;border:2px solid ","inactive"===t?e.colors.lightShade:e.colors.success,";font-weight:",e.font.weight.medium,";text-align:center;line-height:1.4;color:","inactive"===t?e.colors.subduedText:e.colors.text,";",""),stepTitle:Object(p.css)("font-weight:",e.font.weight.semiBold,";color:","inactive"===t?e.colors.subduedText:e.colors.text,";.euiAccordion-isOpen &{color:",e.colors.title,";}",""),description:y}))(r,t),c=Object(p.jsx)(u.EuiFlexGroup,{gutterSize:"s",responsive:!1},Object(p.jsx)(u.EuiFlexItem,{grow:!1},"complete"===t?Object(p.jsx)(u.EuiIcon,{type:"checkInCircleFilled",size:"l",color:r.colors.success}):Object(p.jsx)("span",{css:d.stepNumber},i)),Object(p.jsx)(u.EuiFlexItem,{grow:!1},Object(p.jsx)(u.EuiText,{size:"m",css:d.stepTitle},a.title))),g="in_progress"===t||"active"===t||"ready_to_complete"===t;return Object(p.jsx)("div",{"data-test-subj":"guidePanelStep"},"complete"===t?Object(p.jsx)(o.a.Fragment,null,c):Object(p.jsx)(u.EuiAccordion,{id:e,buttonContent:c,arrowDisplay:"right",initialIsOpen:g},Object(p.jsx)(o.a.Fragment,null,Object(p.jsx)(u.EuiSpacer,{size:"s"}),Object(p.jsx)(u.EuiText,{size:"s","data-test-subj":"guidePanelStepDescription",css:d.description},a.description&&Object(p.jsx)("p",null,a.description),a.descriptionList&&Object(p.jsx)("ul",null,a.descriptionList.map(((e,t)=>Object(p.jsx)("li",{key:`description-${t}`},e))))),Object(p.jsx)(u.EuiSpacer,null),g&&Object(p.jsx)(u.EuiFlexGroup,{justifyContent:"flexEnd"},Object(p.jsx)(u.EuiFlexItem,{grow:!1},Object(p.jsx)(u.EuiButton,{onClick:()=>n(),fill:!0,"data-test-subj":`onboarding--stepButton--${s}--step${i}`},(()=>{switch(t){case"active":return l.i18n.translate("guidedOnboarding.dropdownPanel.startStepButtonLabel",{defaultMessage:"Start"});case"in_progress":return l.i18n.translate("guidedOnboarding.dropdownPanel.continueStepButtonLabel",{defaultMessage:"Continue"});case"ready_to_complete":return l.i18n.translate("guidedOnboarding.dropdownPanel.markDoneStepButtonLabel",{defaultMessage:"Mark done"})}return""})()))))),Object(p.jsx)(u.EuiHorizontalRule,{margin:"l"}))};var G=i(5),E=i.n(G),w=i(4);const _="/api/guided_onboarding",M=new class api_ApiService{constructor(){E()(this,"isEnabled",void 0),E()(this,"client",void 0),E()(this,"pluginState$",void 0),E()(this,"isPluginStateLoading",void 0),E()(this,"isGuidePanelOpen$",new w.BehaviorSubject(!1))}setup(e,t){this.isEnabled=t,this.client=e,this.pluginState$=new w.BehaviorSubject(void 0),this.isGuidePanelOpen$=new w.BehaviorSubject(!1)}createGetPluginStateObservable(){return new w.Observable((e=>{const t=new AbortController,i=t.signal;return this.isPluginStateLoading=!0,this.client.get(`${_}/state`,{signal:i}).then((({pluginState:t})=>{this.isPluginStateLoading=!1,e.next(t),this.pluginState$.next(t),e.complete()})).catch((t=>{this.isPluginStateLoading=!1,e.next({status:"error",isActivePeriod:!1}),this.pluginState$.next({status:"error",isActivePeriod:!1}),e.complete()})),()=>{this.isPluginStateLoading=!1,t.abort()}}))}fetchPluginState$(){if(!this.isEnabled)return Object(w.of)(void 0);if(!this.client)throw new Error("ApiService has not be initialized.");return this.pluginState$.value||this.isPluginStateLoading?this.pluginState$:(this.isPluginStateLoading=!0,Object(w.concat)(this.createGetPluginStateObservable(),this.pluginState$))}async fetchAllGuidesState(){if(this.isEnabled){if(!this.client)throw new Error("ApiService has not be initialized.");try{return await this.client.get(`${_}/guides`)}catch(e){throw e}}}async updatePluginState(e,t){if(this.isEnabled){if(!this.client)throw new Error("ApiService has not be initialized.");try{const i=await this.client.put(`${_}/state`,{body:JSON.stringify(e)});return this.pluginState$.next(i.pluginState),this.isGuidePanelOpen$.next(t),i}catch(e){throw e}}}async activateGuide(e,t){if(t)return await this.updatePluginState({status:"in_progress",guide:{...t,isActive:!0}},!0);const i=b(e);if(i){const t={guideId:e,isActive:!0,status:"not_started",steps:i.steps.map(((e,t)=>{const i=0===t;return{id:e.id,status:i?"active":"inactive"}}))};return await this.updatePluginState({status:"in_progress",guide:t},!0)}}async deactivateGuide(e){return await this.updatePluginState({status:"quit",guide:{...e,isActive:!1}},!1)}async completeGuide(e){const t=await Object(w.firstValueFrom)(this.fetchPluginState$());if(!O(t,e))return;const{activeGuide:i}=t;if(!1===Boolean(i.steps.find((e=>"complete"!==e.status)))){const e={...i,isActive:!1,status:"complete"};return await this.updatePluginState({status:"complete",guide:e},!1)}}isGuideStepActive$(e,t){return this.fetchPluginState$().pipe(Object(w.map)((i=>!!O(i,e)&&j(i.activeGuide,0,t))))}async startGuideStep(e,t){const i=await Object(w.firstValueFrom)(this.fetchPluginState$());if(!O(i,e))return;const{activeGuide:a}=i,n={guideId:e,isActive:!0,status:"in_progress",steps:a.steps.map((e=>e.id===t?{id:e.id,status:"in_progress"}:e))};return await this.updatePluginState({guide:n},!1)}async completeGuideStep(e,t){const i=await Object(w.firstValueFrom)(this.fetchPluginState$());if(!O(i,e))return;const{activeGuide:a}=i,n=j(a,0,t),s=x(a,0,t),o=h(a.guideId,t),r=!!o&&!!o.manualCompletion;if(n||s){const i=((e,t,i)=>{const a=e.steps.findIndex((e=>e.id===t)),n=e.steps[a];return e.steps.map(((e,t)=>{const s=e.id===n.id,o=t===a+1;return s?{id:e.id,status:i?"ready_to_complete":"complete"}:o?i?e:{id:e.id,status:"active"}:e}))})(a,t,r&&n),o={guideId:e,isActive:!0,status:v(a,e,t),steps:i};return await this.updatePluginState({guide:o},!r||s)}}isGuidedOnboardingActiveForIntegration$(e){return this.fetchPluginState$().pipe(Object(w.map)((t=>f(null==t?void 0:t.activeGuide,e))))}async completeGuidedOnboardingForIntegration(e){if(!e)return;const t=await Object(w.firstValueFrom)(this.fetchPluginState$());if(!O(t))return;const{activeGuide:i}=t,a=m(i);return a&&f(i,e)?await this.completeGuideStep(i.guideId,a):void 0}async skipGuidedOnboarding(){return await this.updatePluginState({status:"skipped"},!1)}},k=({closeModal:e,currentGuide:t,telemetryGuideId:i,notifications:a})=>{const[n,o]=Object(s.useState)(!1);return Object(p.jsx)(u.EuiModal,{"aria-label":"quitGuideModal","data-test-subj":"onboarding--quitGuideModal",maxWidth:448,onClose:e},Object(p.jsx)(u.EuiModalHeader,null,Object(p.jsx)(u.EuiModalHeaderTitle,null,l.i18n.translate("guidedOnboarding.quitGuideModal.modalTitle",{defaultMessage:"Quit this guide?"}))),Object(p.jsx)(u.EuiModalBody,null,Object(p.jsx)(u.EuiText,null,Object(p.jsx)("p",null,l.i18n.translate("guidedOnboarding.quitGuideModal.modalDescription",{defaultMessage:"You can restart the setup guide any time from the Help menu."})))),Object(p.jsx)(u.EuiModalFooter,null,Object(p.jsx)(u.EuiButtonEmpty,{"data-test-subj":`onboarding--cancelQuitGuideButton--${i}`,onClick:e},l.i18n.translate("guidedOnboarding.quitGuideModal.cancelButtonLabel",{defaultMessage:"Cancel"})),Object(p.jsx)(u.EuiButton,{"data-test-subj":`onboarding--quitGuideButton--${i}`,onClick:async()=>{try{o(!0),await M.deactivateGuide(t),e()}catch(e){o(!1),a.toasts.addDanger({title:l.i18n.translate("guidedOnboarding.quitGuideModal.deactivateGuideError",{defaultMessage:"Unable to update the guide. Wait a moment and try again."}),text:e.message})}},isLoading:n,fill:!0,color:"warning"},l.i18n.translate("guidedOnboarding.quitGuideModal.quitButtonLabel",{defaultMessage:"Quit guide"}))))};var P={name:"mfmby2",styles:"border-radius:0 0 6px 6px;background:transparent;padding:24px 30px"};const I=({button:e,isGuidePanelOpen:t,title:i,description:a})=>{const n=Object(s.useRef)(!0);Object(s.useEffect)((()=>{n.current=!1}),[]);const[o,r]=Object(s.useState)(!0);return Object(s.useEffect)((()=>{t&&!n.current&&r(!1)}),[t]),Object(p.jsx)(u.EuiPopover,{"data-test-subj":"manualCompletionPopover",button:e,isOpen:o,repositionOnScroll:!0,closePopover:()=>{}},i&&Object(p.jsx)(u.EuiTitle,{size:"xxs"},Object(p.jsx)("h3",null,i)),Object(p.jsx)(u.EuiSpacer,null),Object(p.jsx)(u.EuiText,{size:"s",style:{width:300}},a&&Object(p.jsx)("p",null,a)))},C=({pluginState:e,toggleGuidePanel:t,isGuidePanelOpen:i,navigateToLandingPage:a})=>{if(!e||!e.activeGuide||!e.activeGuide.isActive)return null==e||!e.isActivePeriod||"not_started"!==(null==e?void 0:e.status)&&"skipped"!==(null==e?void 0:e.status)?null:Object(p.jsx)(u.EuiButton,{onClick:a,color:"success",fill:!0,size:"s","data-test-subj":"guideButtonRedirect"},l.i18n.translate("guidedOnboarding.guidedSetupRedirectButtonLabel",{defaultMessage:"Setup guides"}));const n=(e=>{let t;return e.steps.forEach(((e,i)=>{"in_progress"!==e.status&&"ready_to_complete"!==e.status||(t=i+1),"active"===e.status&&(t=i)})),t})(e.activeGuide),s=e.activeGuide.steps.find((e=>"ready_to_complete"===e.status)),o=Object(p.jsx)(u.EuiButton,{onClick:t,color:"success",fill:!0,size:"s","data-test-subj":"guideButton"},Boolean(n)?l.i18n.translate("guidedOnboarding.guidedSetupStepButtonLabel",{defaultMessage:"Setup guide: step {stepNumber}",values:{stepNumber:n}}):l.i18n.translate("guidedOnboarding.guidedSetupButtonLabel",{defaultMessage:"Setup guide"}));if(s){const t=h(e.activeGuide.guideId,s.id);if(t&&t.manualCompletion)return Object(p.jsx)(I,{button:o,isGuidePanelOpen:i,title:t.manualCompletion.title,description:t.manualCompletion.description})}return o},D=({api:e,application:t,notifications:i})=>{var a,n,r;const{euiTheme:d}=Object(u.useEuiTheme)(),[c,g]=Object(s.useState)(!1),[h,m]=Object(s.useState)(!1),[f,O]=Object(s.useState)(void 0),j=(e=>({setupButton:Object(p.css)("margin-right:",e.size.m,";",""),flyoutOverrides:{flyoutContainer:Object(p.css)("top:55px!important;bottom:25px!important;right:calc(",e.size.s," + 128px);border-radius:6px;inline-size:480px!important;height:auto;animation:euiModal 350ms cubic-bezier(0.34, 1.61, 0.7, 1);box-shadow:none;@media (max-width: ",e.breakpoint.s,"px){right:25px!important;}",""),flyoutBody:Object(p.css)(".euiFlyoutBody__overflowContent{width:480px;padding-top:10px;@media (max-width: ",e.breakpoint.s,"px){width:100%;}}",""),flyoutFooter:P,flyoutFooterLink:Object(p.css)("color:",e.colors.darkShade,";font-weight:400;","")}}))(d),x=()=>{g((e=>!e))},v=()=>{g(!1),t.navigateToApp("home",{path:"#getting_started"})};Object(s.useEffect)((()=>{const t=e.fetchPluginState$().subscribe((e=>{O(e)}));return()=>t.unsubscribe()}),[e]),Object(s.useEffect)((()=>{const t=e.isGuidePanelOpen$.subscribe((e=>{g(e)}));return()=>t.unsubscribe()}),[e]);const y=b(null==f||null===(a=f.activeGuide)||void 0===a?void 0:a.guideId),G=(E=null==f?void 0:f.activeGuide)?E.steps.reduce(((e,t)=>("complete"===t.status&&(e+=1),e)),0):0;var E;const w="ready_to_complete"===(null==f||null===(n=f.activeGuide)||void 0===n?void 0:n.status),_=(e=>{switch(e){case"security":return"siem";case"observability":return"kubernetes";default:return e}})(null==f||null===(r=f.activeGuide)||void 0===r?void 0:r.guideId);return Object(p.jsx)(o.a.Fragment,null,Object(p.jsx)("div",{css:j.setupButton},Object(p.jsx)(C,{pluginState:f,toggleGuidePanel:x,isGuidePanelOpen:c,navigateToLandingPage:v})),c&&y&&Object(p.jsx)(u.EuiFlyout,{ownFocus:!0,onClose:x,"aria-labelledby":"onboarding-guide",css:j.flyoutOverrides.flyoutContainer,maskProps:{headerZindexLocation:"above"},"data-test-subj":"guidePanel"},Object(p.jsx)(u.EuiFlyoutHeader,null,Object(p.jsx)(u.EuiButtonEmpty,{onClick:v,iconSide:"left",iconType:"arrowLeft",flush:"left",color:"text"},l.i18n.translate("guidedOnboarding.dropdownPanel.backToGuidesLink",{defaultMessage:"Back to guides"})),Object(p.jsx)(u.EuiTitle,{size:"m"},Object(p.jsx)("h2",{"data-test-subj":"guideTitle"},w?l.i18n.translate("guidedOnboarding.dropdownPanel.completeGuideFlyoutTitle",{defaultMessage:"Well done!"}):y.title)),Object(p.jsx)(u.EuiSpacer,{size:"s"}),Object(p.jsx)(u.EuiHorizontalRule,{margin:"s"})),Object(p.jsx)(u.EuiFlyoutBody,{css:j.flyoutOverrides.flyoutBody},Object(p.jsx)("div",null,Object(p.jsx)(u.EuiText,{size:"m"},Object(p.jsx)("p",{"data-test-subj":"guideDescription"},w?l.i18n.translate("guidedOnboarding.dropdownPanel.completeGuideFlyoutDescription",{defaultMessage:"You've completed the Elastic {guideName} guide.",values:{guideName:y.guideName}}):y.description)),y.docs&&Object(p.jsx)(o.a.Fragment,null,Object(p.jsx)(u.EuiSpacer,{size:"s"}),Object(p.jsx)(u.EuiText,{size:"m"},Object(p.jsx)(u.EuiLink,{external:!0,target:"_blank",href:y.docs.url},y.docs.text))),G>0&&Object(p.jsx)(o.a.Fragment,null,Object(p.jsx)(u.EuiSpacer,{size:"xl"}),Object(p.jsx)(u.EuiProgress,{"data-test-subj":"guideProgress",label:w?l.i18n.translate("guidedOnboarding.dropdownPanel.completedLabel",{defaultMessage:"Completed"}):l.i18n.translate("guidedOnboarding.dropdownPanel.progressLabel",{defaultMessage:"Progress"}),value:G,valueText:l.i18n.translate("guidedOnboarding.dropdownPanel.progressValueLabel",{defaultMessage:"{stepCount} steps",values:{stepCount:`${G} / ${y.steps.length}`}}),max:y.steps.length,size:"l"}),Object(p.jsx)(u.EuiSpacer,{size:"s"})),Object(p.jsx)(u.EuiHorizontalRule,null),null==y?void 0:y.steps.map(((a,n)=>{var s;const o=Object(u.htmlIdGenerator)(`accordion${n}`)(),r=null==f||null===(s=f.activeGuide)||void 0===s?void 0:s.steps[n];if(r)return Object(p.jsx)(S,{accordionId:o,stepStatus:r.status,stepConfig:a,stepNumber:n+1,handleButtonClick:()=>(async(a,n)=>{if(f){const{id:o,status:r}=a,d=f.activeGuide.guideId;try{if("ready_to_complete"===r)return await e.completeGuideStep(d,o);var s;"active"!==r&&"in_progress"!==r||(await e.startGuideStep(d,o),n.location&&(await t.navigateToApp(n.location.appID,{path:n.location.path}),null!==(s=n.manualCompletion)&&void 0!==s&&s.readyToCompleteOnNavigation&&await e.completeGuideStep(d,o)))}catch(e){i.toasts.addDanger({title:l.i18n.translate("guidedOnboarding.dropdownPanel.stepHandlerError",{defaultMessage:"Unable to update the guide. Wait a moment and try again."}),text:e.message})}}})(r,a),key:o,telemetryGuideId:_})})),w&&Object(p.jsx)(u.EuiFlexGroup,{justifyContent:"flexEnd"},Object(p.jsx)(u.EuiFlexItem,{grow:!1},Object(p.jsx)(u.EuiButton,{onClick:()=>(async a=>{try{if(await e.completeGuide(f.activeGuide.guideId),a){const{appID:e,path:i}=a;t.navigateToApp(e,{path:i})}}catch(e){i.toasts.addDanger({title:l.i18n.translate("guidedOnboarding.dropdownPanel.completeGuideError",{defaultMessage:"Unable to update the guide. Wait a moment and try again."}),text:e.message})}})(y.completedGuideRedirectLocation),fill:!0,"data-test-subj":`onboarding--completeGuideButton--${_}`},l.i18n.translate("guidedOnboarding.dropdownPanel.elasticButtonLabel",{defaultMessage:"Continue using Elastic"})))))),Object(p.jsx)(u.EuiFlyoutFooter,{css:j.flyoutOverrides.flyoutFooter},Object(p.jsx)(u.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"xs",responsive:!1,wrap:!0},Object(p.jsx)(u.EuiFlexItem,{grow:!1},Object(p.jsx)(u.EuiButtonEmpty,{iconType:"questionInCircle",iconSide:"right",href:"https://cloud.elastic.co/support ",target:"_blank",css:j.flyoutOverrides.flyoutFooterLink,iconSize:"m"},l.i18n.translate("guidedOnboarding.dropdownPanel.footer.support",{defaultMessage:"Need help?"}))),Object(p.jsx)(u.EuiFlexItem,{grow:!1},Object(p.jsx)(u.EuiText,{size:"xs",color:d.colors.disabled},"|")),Object(p.jsx)(u.EuiFlexItem,{grow:!1},Object(p.jsx)(u.EuiButtonEmpty,{iconType:"faceHappy",iconSide:"right",href:"https://www.elastic.co/kibana/feedback",target:"_blank",css:j.flyoutOverrides.flyoutFooterLink,iconSize:"s"},l.i18n.translate("guidedOnboarding.dropdownPanel.footer.feedback",{defaultMessage:"Give feedback"}))),Object(p.jsx)(u.EuiFlexItem,{grow:!1},Object(p.jsx)(u.EuiText,{size:"xs",color:d.colors.disabled},"|")),Object(p.jsx)(u.EuiFlexItem,{grow:!1},Object(p.jsx)(u.EuiButtonEmpty,{iconType:"exit",iconSide:"right",onClick:()=>{g(!1),m(!0)},"data-test-subj":"quitGuideButton",css:j.flyoutOverrides.flyoutFooterLink,iconSize:"s"},l.i18n.translate("guidedOnboarding.dropdownPanel.footer.exitGuideButtonLabel",{defaultMessage:"Quit guide"})))))),h&&Object(p.jsx)(k,{closeModal:()=>{m(!1)},currentGuide:f.activeGuide,telemetryGuideId:_,notifications:i}))};class plugin_GuidedOnboardingPlugin{constructor(e){this.ctx=e}setup(e){return{}}start(e,{cloud:t}){const{chrome:i,http:a,theme:n,application:s,notifications:o}=e,{ui:r}=this.ctx.config.get();return M.setup(a,!(null==t||!t.isCloudEnabled)&&r),r&&null!=t&&t.isCloudEnabled&&i.navControls.registerExtension({order:1e3,mount:e=>this.mount({targetDomElement:e,theme$:n.theme$,api:M,application:s,notifications:o})}),{guidedOnboardingApi:M}}stop(){}mount({targetDomElement:e,theme$:t,api:i,application:a,notifications:s}){return n.a.render(Object(p.jsx)(d.KibanaThemeProvider,{theme$:t},Object(p.jsx)(r.I18nProvider,null,Object(p.jsx)(D,{api:i,application:a,notifications:s}))),e),()=>n.a.unmountComponentAtNode(e)}}function L(e){return new plugin_GuidedOnboardingPlugin(e)}}]);