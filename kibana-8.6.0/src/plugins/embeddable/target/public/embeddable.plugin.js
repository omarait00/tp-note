!function(e){var t={};function n(i){if(t[i])return t[i].exports;var a=t[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(i,a,function(t){return e[t]}.bind(null,a));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=30)}([function(e,t,n){e.exports=n(23)(2)},function(e,t){e.exports=__kbnSharedDeps__.EmotionReact},function(e,t){e.exports=__kbnSharedDeps__.ElasticEui},function(e,t){e.exports=__kbnSharedDeps__.React},function(e,t){e.exports=__kbnSharedDeps__.KbnI18n},function(e,t){e.exports=__kbnSharedDeps__.Lodash},function(e,t){e.exports=__kbnSharedDeps__.RxjsOperators},function(e,t){e.exports=__kbnSharedDeps__.Rxjs},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return o}));const i=(e,t)=>t,a=e=>({state:e,references:[]}),s=(e,t)=>e,o={}},function(e,t,n){"use strict";e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var i,a,s;if(Array.isArray(t)){if((i=t.length)!=n.length)return!1;for(a=i;0!=a--;)if(!e(t[a],n[a]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((i=(s=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(a=i;0!=a--;)if(!Object.prototype.hasOwnProperty.call(n,s[a]))return!1;for(a=i;0!=a--;){var o=s[a];if(!e(t[o],n[o]))return!1}return!0}return t!=t&&n!=n}},function(e,t){e.exports=__kbnSharedDeps__.KbnI18nReact},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/kibanaReact/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t){e.exports=__kbnSharedDeps__.Classnames},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return r})),n.d(t,"e",(function(){return d.a}));var i=n(8);const a=e=>t=>{const n=t.enhancements||{},a=e.getEmbeddableFactory(t.type),s=Object(i.b)(t);let o=s.state;const r=s.references;if(a){const e=a.extract(t);o=e.state,r.push(...e.references)}return o.enhancements={},Object.keys(n).forEach((t=>{if(!n[t])return;const i=e.getEnhancement(t).extract(n[t]);r.push(...i.references),o.enhancements[t]=i.state})),{state:o,references:r}},s=e=>(t,n)=>{const a=t.enhancements||{},s=e.getEmbeddableFactory(t.type);let o=Object(i.c)(t,n);return s&&(o=s.inject(o,n)),o.enhancements={},Object.keys(a).forEach((t=>{a[t]&&(o.enhancements[t]=e.getEnhancement(t).inject(a[t],n))})),o},o=e=>{const t=(n,a)=>{const s=n.enhancements||{},o=e.getEmbeddableFactory(n.type);let r=i.a[a]?i.a[a](n):n;const d="function"==typeof(null==o?void 0:o.migrations)?null==o?void 0:o.migrations():(null==o?void 0:o.migrations)||{};return d[a]&&(r=d[a](r)),null!=o&&o.isContainerType&&(r.panels=(n.panels||[]).map((e=>t(e,a)))),r.enhancements={},Object.keys(s).forEach((t=>{if(!s[t])return;const n=e.getEnhancement(t),i="function"==typeof(null==n?void 0:n.migrations)?null==n?void 0:n.migrations():(null==n?void 0:n.migrations)||{},o=i[a]?i[a](s[t]):s[t];r.enhancements[t]=o})),r};return t},r=e=>(t,n={})=>{const a=t.enhancements||{},s=e.getEmbeddableFactory(t.type);let o=Object(i.d)(t,n);return s&&(o=s.telemetry(t,o)),Object.keys(a).map((t=>{a[t]&&(o=e.getEnhancement(t).telemetry(a[t],o))})),o};var d=n(15)},function(e,t,n){"use strict";let i;n.d(t,"a",(function(){return i})),function(e){e.EDIT="edit",e.PREVIEW="preview",e.PRINT="print",e.VIEW="view"}(i||(i={}))},function(e,t,n){"use strict";function i(e){return Boolean(e.savedObjectId)}n.d(t,"a",(function(){return i}))},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/kibanaUtils/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t){e.exports=__kbnSharedDeps__.KbnStd},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/savedObjects/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t,n){e.exports=n(23)(3)},function(e,t,n){"use strict";var i=n(26);n.o(i,"IncompatibleActionError")&&n.d(t,"IncompatibleActionError",(function(){return i.IncompatibleActionError})),n.o(i,"buildContextMenuForActions")&&n.d(t,"buildContextMenuForActions",(function(){return i.buildContextMenuForActions}))},function(e,t,n){"use strict";var i,a=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),s=[];function o(e){for(var t=-1,n=0;n<s.length;n++)if(s[n].identifier===e){t=n;break}return t}function r(e,t){for(var n={},i=[],a=0;a<e.length;a++){var r=e[a],d=t.base?r[0]+t.base:r[0],l=n[d]||0,c="".concat(d," ").concat(l);n[d]=l+1;var u=o(c),p={css:r[1],media:r[2],sourceMap:r[3]};-1!==u?(s[u].references++,s[u].updater(p)):s.push({identifier:c,updater:m(p,t),references:1}),i.push(c)}return i}function d(e){var t=document.createElement("style"),i=e.attributes||{};if(void 0===i.nonce){var s=n.nc;s&&(i.nonce=s)}if(Object.keys(i).forEach((function(e){t.setAttribute(e,i[e])})),"function"==typeof e.insert)e.insert(t);else{var o=a(e.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}return t}var l,c=(l=[],function(e,t){return l[e]=t,l.filter(Boolean).join("\n")});function u(e,t,n,i){var a=n?"":i.media?"@media ".concat(i.media," {").concat(i.css,"}"):i.css;if(e.styleSheet)e.styleSheet.cssText=c(t,a);else{var s=document.createTextNode(a),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(s,o[t]):e.appendChild(s)}}function p(e,t,n){var i=n.css,a=n.media,s=n.sourceMap;if(a?e.setAttribute("media",a):e.removeAttribute("media"),s&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}var b=null,h=0;function m(e,t){var n,i,a;if(t.singleton){var s=h++;n=b||(b=d(t)),i=u.bind(null,n,s,!1),a=u.bind(null,n,s,!0)}else n=d(t),i=p.bind(null,n,t),a=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return i(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;i(e=t)}else a()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===i&&(i=Boolean(window&&document&&document.all&&!window.atob)),i));var n=r(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var i=0;i<n.length;i++){var a=o(n[i]);s[a].references--}for(var d=r(e,t),l=0;l<n.length;l++){var c=o(n[l]);0===s[c].references&&(s[c].updater(),s.splice(c,1))}n=d}}}},function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n,i,a,s=e[1]||"",o=e[3];if(!o)return s;if(t&&"function"==typeof btoa){var r=(n=o,i=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),a="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(i),"/*# ".concat(a," */")),d=o.sources.map((function(e){return"/*# sourceURL=".concat(o.sourceRoot||"").concat(e," */")}));return[s].concat(d).concat([r]).join("\n")}return[s].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,i){"string"==typeof e&&(e=[[null,e,""]]);var a={};if(i)for(var s=0;s<this.length;s++){var o=this[s][0];null!=o&&(a[o]=!0)}for(var r=0;r<e.length;r++){var d=[].concat(e[r]);i&&a[d[0]]||(n&&(d[2]?d[2]="".concat(n," and ").concat(d[2]):d[2]=n),t.push(d))}},t}},function(e,t){e.exports=__kbnSharedDeps_npm__},function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var i=new Uint8Array(16);e.exports=function(){return n(i),i}}else{var a=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),a[t]=e>>>((3&t)<<3)&255;return a}}},function(e,t){for(var n=[],i=0;i<256;++i)n[i]=(i+256).toString(16).substr(1);e.exports=function(e,t){var i=t||0,a=n;return[a[e[i++]],a[e[i++]],a[e[i++]],a[e[i++]],"-",a[e[i++]],a[e[i++]],"-",a[e[i++]],a[e[i++]],"-",a[e[i++]],a[e[i++]],"-",a[e[i++]],a[e[i++]],a[e[i++]],a[e[i++]],a[e[i++]],a[e[i++]]].join("")}},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/uiActions/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/kibanaUtils/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t,n){var i=n(37),a=n(38),s=a;s.v1=i,s.v4=a,e.exports=s},function(e,t){e.exports=__kbnSharedDeps__.KbnAnalytics},function(e,t,n){n(31),__kbnBundles__.define("plugin/embeddable/public",n,40),__kbnBundles__.define("plugin/embeddable/common",n,39)},function(e,t,n){n.p=window.__kbnPublicPath__.embeddable},function(e,t,n){switch(window.__kbnThemeTag__){case"v8dark":return n(33);case"v8light":return n(35)}},function(e,t,n){var i=n(21),a=n(34);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);i(a,{insert:"head",singleton:!1}),e.exports=a.locals||{}},function(e,t,n){(t=n(22)(!1)).push([e.i,".embPanel{display:flex;flex:1;flex-direction:column;height:100%;min-height:26px;position:relative;z-index:auto}.embPanel-isLoading{align-items:center;justify-content:center}.embPanel .embPanel__content{display:flex;flex:1 1 100%;min-height:0;z-index:1}.embPanel .embPanel__content[data-error]{display:none}.embPanel .embPanel__content--fullWidth{width:100%}.embPanel__header{display:flex;flex:0 0 auto;justify-content:flex-end}.embPanel__title{align-items:center;color:#dfe5ef;display:flex;flex-grow:1;flex-wrap:wrap;font-size:12px;font-size:.85714rem;font-weight:700;line-height:1.14286rem;line-height:1.5;overflow:hidden;overflow-wrap:break-word!important;word-break:break-word}.embPanel__title:not(:empty){line-height:24px;padding-left:8px}.embPanel__title .embPanel__titleInner{align-items:center;display:flex;overflow:hidden;padding-right:8px}.embPanel__title .embPanel__titleTooltipAnchor{max-width:100%}.embPanel__title .embPanel__titleText{font-weight:700;max-width:100%;overflow:hidden!important;text-overflow:ellipsis!important;white-space:nowrap!important}.embPanel__title .embPanel__placeholderTitleText{color:#535966;font-weight:400}.embPanel__dragger:not(.embPanel__title){flex-grow:1}.embPanel__header--floater{left:0;position:absolute;right:0;top:0}.embPanel__header--floater *{z-index:1000}.embPanel__optionsMenuButton{background-color:#d4dae51a;border-bottom-right-radius:0;border-top-left-radius:0}.embPanel__optionsMenuButton:focus{background-color:#36a2ef33}.embPanel .embPanel__optionsMenuButton{opacity:0}.embPanel .embPanel__optionsMenuButton:focus,.embPanel:hover .embPanel__optionsMenuButton{opacity:1}.embPanel--editing{border-color:#535966!important;border-style:dashed!important;border-width:1px;transition:all .15s cubic-bezier(.694,.0482,.335,1)}.embPanel--editing:focus,.embPanel--editing:hover{box-shadow:0 1px 5px #00000040,0 3.6px 13px rgba(0,0,0,.175),0 8.4px 23px #00000026,0 23px 35px rgba(0,0,0,.125)}.embPanel--editing .embPanel__dragger{transition:background-color .15s cubic-bezier(.694,.0482,.335,1)}.embPanel--editing .embPanel__dragger:hover{background-color:#f3d3714d;cursor:move}.embPanel--editing .embPanel__optionsMenuButton{opacity:1}.embPanel--loading .embPanel__title{color:#7a7f89}.embPanel__error{padding:24px}.embPanel__error>*{max-height:100%;overflow:auto}.embPanel__label{padding-left:8px;position:absolute;z-index:1000}.embPanel__optionsMenuForm{padding:16px}",""]),e.exports=t},function(e,t,n){var i=n(21),a=n(36);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);i(a,{insert:"head",singleton:!1}),e.exports=a.locals||{}},function(e,t,n){(t=n(22)(!1)).push([e.i,".embPanel{display:flex;flex:1;flex-direction:column;height:100%;min-height:26px;position:relative;z-index:auto}.embPanel-isLoading{align-items:center;justify-content:center}.embPanel .embPanel__content{display:flex;flex:1 1 100%;min-height:0;z-index:1}.embPanel .embPanel__content[data-error]{display:none}.embPanel .embPanel__content--fullWidth{width:100%}.embPanel__header{display:flex;flex:0 0 auto;justify-content:flex-end}.embPanel__title{align-items:center;color:#1a1c21;display:flex;flex-grow:1;flex-wrap:wrap;font-size:12px;font-size:.85714rem;font-weight:700;line-height:1.14286rem;line-height:1.5;overflow:hidden;overflow-wrap:break-word!important;word-break:break-word}.embPanel__title:not(:empty){line-height:24px;padding-left:8px}.embPanel__title .embPanel__titleInner{align-items:center;display:flex;overflow:hidden;padding-right:8px}.embPanel__title .embPanel__titleTooltipAnchor{max-width:100%}.embPanel__title .embPanel__titleText{font-weight:700;max-width:100%;overflow:hidden!important;text-overflow:ellipsis!important;white-space:nowrap!important}.embPanel__title .embPanel__placeholderTitleText{color:#98a2b3;font-weight:400}.embPanel__dragger:not(.embPanel__title){flex-grow:1}.embPanel__header--floater{left:0;position:absolute;right:0;top:0}.embPanel__header--floater *{z-index:1000}.embPanel__optionsMenuButton{background-color:#3437411a;border-bottom-right-radius:0;border-top-left-radius:0}.embPanel__optionsMenuButton:focus{background-color:#0077cc1a}.embPanel .embPanel__optionsMenuButton{opacity:0}.embPanel .embPanel__optionsMenuButton:focus,.embPanel:hover .embPanel__optionsMenuButton{opacity:1}.embPanel--editing{border-color:#98a2b3!important;border-style:dashed!important;border-width:1px;transition:all .15s cubic-bezier(.694,.0482,.335,1)}.embPanel--editing:focus,.embPanel--editing:hover{box-shadow:0 1px 5px #0000001a,0 3.6px 13px #00000012,0 8.4px 23px #0000000f,0 23px 35px #0000000d}.embPanel--editing .embPanel__dragger{transition:background-color .15s cubic-bezier(.694,.0482,.335,1)}.embPanel--editing .embPanel__dragger:hover{background-color:#fec5141a;cursor:move}.embPanel--editing .embPanel__optionsMenuButton{opacity:1}.embPanel--loading .embPanel__title{color:#69707d}.embPanel__error{padding:24px}.embPanel__error>*{max-height:100%;overflow:auto}.embPanel__label{padding-left:8px;position:absolute;z-index:1000}.embPanel__optionsMenuForm{padding:16px}",""]),e.exports=t},function(e,t,n){var i,a,s=n(24),o=n(25),r=0,d=0;e.exports=function(e,t,n){var l=t&&n||0,c=t||[],u=(e=e||{}).node||i,p=void 0!==e.clockseq?e.clockseq:a;if(null==u||null==p){var b=s();null==u&&(u=i=[1|b[0],b[1],b[2],b[3],b[4],b[5]]),null==p&&(p=a=16383&(b[6]<<8|b[7]))}var h=void 0!==e.msecs?e.msecs:(new Date).getTime(),m=void 0!==e.nsecs?e.nsecs:d+1,g=h-r+(m-d)/1e4;if(g<0&&void 0===e.clockseq&&(p=p+1&16383),(g<0||h>r)&&void 0===e.nsecs&&(m=0),m>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");r=h,d=m,a=p;var f=(1e4*(268435455&(h+=122192928e5))+m)%4294967296;c[l++]=f>>>24&255,c[l++]=f>>>16&255,c[l++]=f>>>8&255,c[l++]=255&f;var v=h/4294967296*1e4&268435455;c[l++]=v>>>8&255,c[l++]=255&v,c[l++]=v>>>24&15|16,c[l++]=v>>>16&255,c[l++]=p>>>8|128,c[l++]=255&p;for(var y=0;y<6;++y)c[l+y]=u[y];return t||o(c)}},function(e,t,n){var i=n(24),a=n(25);e.exports=function(e,t,n){var s=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||i)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var r=0;r<16;++r)t[s+r]=o[r];return t||a(o)}},function(e,t,n){"use strict";n.r(t);var i=n(14);n.d(t,"ViewMode",(function(){return i.a}));var a=n(13);n.d(t,"isSavedObjectEmbeddableInput",(function(){return a.e}))},function(e,t,n){"use strict";n.r(t),n.d(t,"ACTION_ADD_PANEL",(function(){return ce})),n.d(t,"ACTION_EDIT_PANEL",(function(){return L})),n.d(t,"AddPanelAction",(function(){return add_panel_action_AddPanelAction})),n.d(t,"isReferenceOrValueEmbeddable",(function(){return je})),n.d(t,"Container",(function(){return container_Container})),n.d(t,"CONTEXT_MENU_TRIGGER",(function(){return B})),n.d(t,"contextMenuTrigger",(function(){return z})),n.d(t,"defaultEmbeddableFactoryProvider",(function(){return T})),n.d(t,"EditPanelAction",(function(){return edit_panel_action_EditPanelAction})),n.d(t,"Embeddable",(function(){return embeddable_Embeddable})),n.d(t,"EmbeddableChildPanel",(function(){return embeddable_child_panel_EmbeddableChildPanel})),n.d(t,"EmbeddableFactoryNotFoundError",(function(){return errors_EmbeddableFactoryNotFoundError})),n.d(t,"EmbeddablePanel",(function(){return embeddable_panel_EmbeddablePanel})),n.d(t,"EmbeddableRoot",(function(){return embeddable_root_EmbeddableRoot})),n.d(t,"ErrorEmbeddable",(function(){return error_embeddable_ErrorEmbeddable})),n.d(t,"isEmbeddable",(function(){return u})),n.d(t,"isErrorEmbeddable",(function(){return A})),n.d(t,"openAddPanelFlyout",(function(){return le})),n.d(t,"PANEL_BADGE_TRIGGER",(function(){return $})),n.d(t,"panelBadgeTrigger",(function(){return U})),n.d(t,"PANEL_NOTIFICATION_TRIGGER",(function(){return G})),n.d(t,"panelNotificationTrigger",(function(){return V})),n.d(t,"PanelNotFoundError",(function(){return errors_PanelNotFoundError})),n.d(t,"SELECT_RANGE_TRIGGER",(function(){return H})),n.d(t,"VALUE_CLICK_TRIGGER",(function(){return q})),n.d(t,"ViewMode",(function(){return f.a})),n.d(t,"withEmbeddableSubscription",(function(){return F})),n.d(t,"genericEmbeddableInputIsEqual",(function(){return j})),n.d(t,"omitGenericEmbeddableInput",(function(){return _})),n.d(t,"isSavedObjectEmbeddableInput",(function(){return N.a})),n.d(t,"isRangeSelectTriggerContext",(function(){return J})),n.d(t,"isValueClickTriggerContext",(function(){return Y})),n.d(t,"isRowClickTriggerContext",(function(){return X})),n.d(t,"isContextMenuTriggerContext",(function(){return Q})),n.d(t,"EmbeddableStateTransfer",(function(){return embeddable_state_transfer_EmbeddableStateTransfer})),n.d(t,"EmbeddableRenderer",(function(){return k})),n.d(t,"useEmbeddableFactory",(function(){return R})),n.d(t,"isFilterableEmbeddable",(function(){return Ee})),n.d(t,"AttributeService",(function(){return attribute_service_AttributeService})),n.d(t,"ATTRIBUTE_SERVICE_KEY",(function(){return xe})),n.d(t,"plugin",(function(){return we})),n(32);var i=n(0),a=n.n(i),s=n(3),o=n.n(s),r=n(5),d=n(18),l=n(27),c=n(4);class errors_PanelNotFoundError extends Error{constructor(){super(c.i18n.translate("embeddableApi.errors.paneldoesNotExist",{defaultMessage:"Panel not found"})),a()(this,"code","PANEL_NOT_FOUND")}}class errors_EmbeddableFactoryNotFoundError extends Error{constructor(e){super(c.i18n.translate("embeddableApi.errors.embeddableFactoryNotFound",{defaultMessage:"{type} can't be loaded. Please upgrade to the default distribution of Elasticsearch and Kibana with the appropriate license.",values:{type:e}})),a()(this,"code","EMBEDDABLE_FACTORY_NOT_FOUND")}}const u=e=>!!e&&"object"==typeof e&&"string"==typeof e.id&&"function"==typeof e.getInput&&"function"==typeof e.supportedTriggers;var p=n(9),b=n.n(p),h=n(7),m=n(6),g=n(16),f=n(14);const v=["lastReloadRequestTime","executionContext","searchSessionId","hidePanelTitles","disabledActions","disableTriggers","enhancements","syncColors","syncCursor","syncTooltips","viewMode","title","id"],y=["hidePanelTitles","disabledActions","disableTriggers","enhancements","syncColors","syncCursor","syncTooltips","title","id"],_=e=>Object(r.omit)(e,v),j=(e,t)=>{const{title:n,hidePanelTitles:i,...a}=Object(r.pick)(e,y),{title:s,hidePanelTitles:o,...d}=Object(r.pick)(t,y);return n===s&&Boolean(i)===Boolean(o)&&!!b()(a,d)};function E(e,t){return e.hidePanelTitles?"":void 0===e.title?t.defaultTitle:e.title}class embeddable_Embeddable{constructor(e,t,n){a()(this,"runtimeId",embeddable_Embeddable.runtimeId++),a()(this,"parent",void 0),a()(this,"isContainer",!1),a()(this,"deferEmbeddableLoad",!1),a()(this,"type",void 0),a()(this,"id",void 0),a()(this,"fatalError",void 0),a()(this,"output",void 0),a()(this,"input",void 0),a()(this,"inputSubject",new h.ReplaySubject(1)),a()(this,"outputSubject",new h.ReplaySubject(1)),a()(this,"input$",this.inputSubject.asObservable()),a()(this,"output$",this.outputSubject.asObservable()),a()(this,"renderComplete",new g.RenderCompleteDispatcher),a()(this,"parentSubscription",void 0),a()(this,"destroyed",!1),this.id=e.id,this.output={title:E(e,t),...this.reportsEmbeddableLoad()?{}:{loading:!1,rendered:!0},...t},this.input={viewMode:f.a.EDIT,...e},this.parent=n,this.inputSubject.next(this.input),this.outputSubject.next(this.output),n&&(this.parentSubscription=h.merge(n.getInput$(),n.getOutput$()).subscribe((()=>{if(!n.getInput().panels[this.id])return;const e=n.getInputForChild(this.id);this.onResetInput(e)}))),this.getOutput$().pipe(Object(m.map)((({title:e})=>e||"")),Object(m.distinctUntilChanged)()).subscribe((e=>this.renderComplete.setTitle(e)))}reportsEmbeddableLoad(){return!1}refreshInputFromParent(){if(!this.parent)return;if(!this.parent.getInput().panels[this.id])return;const e=this.parent.getInputForChild(this.id);this.onResetInput(e)}getIsContainer(){return!0===this.isContainer}getUpdated$(){return Object(h.merge)(this.getInput$().pipe(Object(m.skip)(1)),this.getOutput$().pipe(Object(m.skip)(1))).pipe(Object(m.debounceTime)(0))}getInput$(){return this.input$}getOutput$(){return this.output$}getOutput(){return this.output}async getExplicitInputIsEqual(e){const t=this.getExplicitInput();return j(e,t)&&b()(_(e),_(t))}getExplicitInput(){const e=this.getRoot();var t,n,i;return e.getIsContainer()&&null!==(t=null===(n=e.getInput().panels)||void 0===n||null===(i=n[this.id])||void 0===i?void 0:i.explicitInput)&&void 0!==t?t:this.getInput()}getPersistableInput(){return this.getExplicitInput()}getInput(){return this.input}getTitle(){return this.output.title||""}getRoot(){let e=this;for(;e.parent;)e=e.parent;return e}updateInput(e){if(this.destroyed)throw new Error("Embeddable has been destroyed");this.parent?this.parent.updateInputForChild(this.id,e):this.onInputChanged(e)}render(e){if(this.renderComplete.setEl(e),this.renderComplete.setTitle(this.output.title||""),this.destroyed)throw new Error("Embeddable has been destroyed")}getInspectorAdapters(){}destroy(){this.destroyed=!0,this.inputSubject.complete(),this.outputSubject.complete(),this.parentSubscription&&this.parentSubscription.unsubscribe()}setInitializationFinished(){var e;this.deferEmbeddableLoad&&null!==(e=this.parent)&&void 0!==e&&e.isContainer&&this.parent.setChildLoaded(this)}updateOutput(e){const t={...this.output,...e};b()(this.output,t)||(this.output=t,this.outputSubject.next(this.output))}onFatalError(e){var t;this.fatalError=e,this.outputSubject.error(e),this.deferEmbeddableLoad&&null!==(t=this.parent)&&void 0!==t&&t.isContainer&&this.parent.setChildLoaded(this)}onResetInput(e){if(!b()(this.input,e)){const t=this.input.lastReloadRequestTime;this.input=e,this.inputSubject.next(e),this.updateOutput({title:E(this.input,this.output)}),t!==e.lastReloadRequestTime&&this.reload()}}onInputChanged(e){const t=Object(r.cloneDeep)({...this.input,...e});this.onResetInput(t)}supportedTriggers(){return[]}}a()(embeddable_Embeddable,"runtimeId",0);var x=n(17),P=n(1);function O({children:e,embeddable:t,error:n}){const[i,a]=Object(s.useState)(),o=Object(s.useRef)(null);return Object(s.useEffect)((()=>{var i,s;if(!o.current)return;const d=null!==(i=null==t||null===(s=t.catchError)||void 0===s?void 0:s.bind(t))&&void 0!==i?i:e;if(!d)return;const l=d("string"==typeof n?{message:n,name:""}:n,o.current);if(Object(r.isFunction)(l))return l;Object(x.isPromise)(l)?l.then(a):a(l)}),[e,t,n]),Object(P.jsx)("div",{ref:o},i)}const T=e=>{var t;return{isContainerType:null!==(t=e.isContainerType)&&void 0!==t&&t,canCreateNew:e.canCreateNew?e.canCreateNew.bind(e):()=>!0,getDefaultInput:e.getDefaultInput?e.getDefaultInput.bind(e):()=>({}),getExplicitInput:e.getExplicitInput?e.getExplicitInput.bind(e):()=>Promise.resolve({}),createFromSavedObject:e.createFromSavedObject?e.createFromSavedObject.bind(e):(t,n,i)=>{throw new Error(`Creation from saved object not supported by type ${e.type}`)},create:e.create.bind(e),type:e.type,isEditable:e.isEditable.bind(e),getDisplayName:e.getDisplayName.bind(e),getDescription:e.getDescription?e.getDescription.bind(e):()=>"",getIconType:e.getIconType?e.getIconType.bind(e):()=>"empty",savedObjectMetaData:e.savedObjectMetaData,telemetry:e.telemetry||((e,t)=>t),inject:e.inject||(e=>e),extract:e.extract||(e=>({state:e,references:[]})),migrations:e.migrations||{},grouping:e.grouping}};var I=n(2),w=n(11);function C({editPanelAction:e,embeddable:t,error:n}){const[i,a]=Object(s.useState)(!1),o=Object(s.useMemo)((()=>i?()=>null==e?void 0:e.execute({embeddable:t}):void 0),[e,t,i]),r=Object(s.useMemo)((()=>null==e?void 0:e.getDisplayName({embeddable:t})),[e,t]),d=Object(s.useMemo)((()=>t.getTitle()),[t]),l=Object(s.useMemo)((()=>d?c.i18n.translate("embeddableApi.panel.editPanel.displayName",{defaultMessage:"Edit {value}",values:{value:d}}):r),[r,d]);return Object(s.useEffect)((()=>{const n=Object(h.merge)(t.getInput$(),t.getOutput$()).pipe(Object(h.switchMap)((()=>{var n;return null!==(n=null==e?void 0:e.isCompatible({embeddable:t}))&&void 0!==n?n:Object(h.of)(!1)})),Object(h.distinctUntilChanged)()).subscribe(a);return()=>n.unsubscribe()}),[e,t]),Object(P.jsx)(I.EuiEmptyPrompt,{body:Object(P.jsx)(I.EuiText,{size:"s"},Object(P.jsx)(w.Markdown,{markdown:n.message,openLinksInNewTab:!0,"data-test-subj":"errorMessageMarkdown"})),"data-test-subj":"embeddableStackError",iconType:"alert",iconColor:"danger",layout:"vertical",actions:i&&Object(P.jsx)(I.EuiButtonEmpty,{"aria-label":l,onClick:o,size:"s"},r)})}function A(e){return Boolean(e.fatalError||void 0!==e.error)}class error_embeddable_ErrorEmbeddable extends embeddable_Embeddable{constructor(e,t,n){super(t,{},n),a()(this,"type","error"),a()(this,"error",void 0),this.error=e}reload(){}render(){const e="string"==typeof this.error?{message:this.error,name:""}:this.error;return Object(P.jsx)(C,{embeddable:this,error:e})}}var M=n(19),S=n.n(M);const F=e=>class WithEmbeddableSubscription extends o.a.Component{constructor(e){super(e),a()(this,"subscription",void 0),a()(this,"mounted",!1),this.state={input:this.props.embeddable.getInput(),output:this.props.embeddable.getOutput()}}componentDidMount(){this.mounted=!0,this.subscription=h.merge(this.props.embeddable.getOutput$(),this.props.embeddable.getInput$()).subscribe((()=>{this.mounted&&this.setState({input:this.props.embeddable.getInput(),output:this.props.embeddable.getOutput()})}))}componentWillUnmount(){this.mounted=!1,this.subscription&&this.subscription.unsubscribe()}render(){return Object(P.jsx)(e,S()({input:this.state.input,output:this.state.output},this.props))}};class embeddable_root_EmbeddableRoot extends o.a.Component{constructor(e){super(e),a()(this,"root",void 0),a()(this,"alreadyMounted",!1),a()(this,"updateNode",(e=>{Object(x.isPromise)(e)?e.then(this.updateNode):this.setState({node:e})})),this.root=o.a.createRef(),this.state={}}componentDidMount(){var e,t;null!==(e=this.root)&&void 0!==e&&e.current&&this.props.embeddable&&(this.alreadyMounted=!0,this.updateNode(null!==(t=this.props.embeddable.render(this.root.current))&&void 0!==t?t:void 0))}componentDidUpdate(e){var t;let n=!1;var i;null!==(t=this.root)&&void 0!==t&&t.current&&this.props.embeddable&&!this.alreadyMounted&&(this.alreadyMounted=!0,this.updateNode(null!==(i=this.props.embeddable.render(this.root.current))&&void 0!==i?i:void 0),n=!0),!n&&this.root&&this.root.current&&this.props.embeddable&&this.alreadyMounted&&this.props.input&&(null==e?void 0:e.input)!==this.props.input&&this.props.embeddable.updateInput(this.props.input)}shouldComponentUpdate({embeddable:e,error:t,input:n,loading:i},{node:a}){return Boolean(t!==this.props.error||i!==this.props.loading||e!==this.props.embeddable||this.root&&this.root.current&&e&&!this.alreadyMounted||n!==this.props.input||a!==this.state.node)}render(){return Object(P.jsx)(o.a.Fragment,null,Object(P.jsx)("div",{ref:this.root},this.state.node),this.props.loading&&Object(P.jsx)(I.EuiLoadingSpinner,{"data-test-subj":"embedSpinner"}),this.props.error&&Object(P.jsx)(O,{embeddable:this.props.embeddable,error:this.props.error},(({message:e})=>Object(P.jsx)(I.EuiText,{"data-test-subj":"embedError"},e))))}}var N=n(15);function R({input:e,factory:t,onInputUpdated:n}){const[i,a]=Object(s.useState)(void 0),[r,d]=Object(s.useState)(!1),[l,c]=Object(s.useState)(),u=o.a.useRef(e);return Object(s.useEffect)((()=>{u.current=e}),[e]),Object(s.useEffect)((()=>{let e,n=!1;return a(void 0),d(!0),t.create(u.current).then((t=>{n?t&&t.destroy():(e=t,a(t))})).catch((e=>{n||c(null==e?void 0:e.message)})).finally((()=>{n||d(!1)})),()=>{n=!0,e&&e.destroy()}}),[t]),Object(s.useEffect)((()=>{if(!i)return;if(A(i))return;if(!n)return;const e=i.getInput$().subscribe((e=>{n(e)}));return()=>{e.unsubscribe()}}),[i,n]),[i,r,l]}const k=e=>function(e){return"factory"in e}(e)?Object(P.jsx)(D,e):Object(P.jsx)(embeddable_root_EmbeddableRoot,{embeddable:e.embeddable,input:e.input}),D=({factory:e,input:t,onInputUpdated:n})=>{const[i,a,s]=R({factory:e,input:t,onInputUpdated:n});return Object(P.jsx)(embeddable_root_EmbeddableRoot,{embeddable:i,loading:a,error:s,input:t})},L="editPanel";class edit_panel_action_EditPanelAction{constructor(e,t,n,i){var s;a()(this,"type",L),a()(this,"id",L),a()(this,"order",50),a()(this,"currentAppId",void 0),this.getEmbeddableFactory=e,this.application=t,this.stateTransfer=n,this.getOriginatingPath=i,null!==(s=this.application)&&void 0!==s&&s.currentAppId$&&this.application.currentAppId$.pipe(Object(m.take)(1)).subscribe((e=>this.currentAppId=e))}getDisplayName({embeddable:e}){const t=this.getEmbeddableFactory(e.type);if(!t)throw new errors_EmbeddableFactoryNotFoundError(e.type);return c.i18n.translate("embeddableApi.panel.editPanel.displayName",{defaultMessage:"Edit {value}",values:{value:t.getDisplayName()}})}getIconType(){return"pencil"}async isCompatible({embeddable:e}){const t=Boolean(e&&e.getOutput().editable&&(e.getOutput().editUrl||e.getOutput().editApp&&e.getOutput().editPath)),n=e.getInput().viewMode===f.a.EDIT;return Boolean(t&&n)}async execute(e){const t=this.getAppTarget(e);if(t)return void(this.stateTransfer&&t.state?await this.stateTransfer.navigateToEditor(t.app,{path:t.path,state:t.state}):await this.application.navigateToApp(t.app,{path:t.path}));const n=await this.getHref(e);n&&(window.location.href=n)}getAppTarget({embeddable:e}){const t=e?e.getOutput().editApp:void 0,n=e?e.getOutput().editPath:void 0;if(t&&n){if(this.currentAppId){var i;const a=!e.getInput().savedObjectId,s=null===(i=this.getOriginatingPath)||void 0===i?void 0:i.call(this);return{app:t,path:n,state:{originatingApp:this.currentAppId,valueInput:a?this.getExplicitInput({embeddable:e}):void 0,embeddableId:e.id,searchSessionId:e.getInput().searchSessionId,originatingPath:s}}}return{app:t,path:n}}}async getHref({embeddable:e}){return(e?e.getOutput().editUrl:void 0)||""}getExplicitInput({embeddable:e}){var t,n,i,a,s;return null!==(t=null===(n=e.getRoot())||void 0===n||null===(i=n.getInput())||void 0===i||null===(a=i.panels)||void 0===a||null===(s=a[e.id])||void 0===s?void 0:s.explicitInput)&&void 0!==t?t:e.getInput()}}const B="CONTEXT_MENU_TRIGGER",z={id:B,title:c.i18n.translate("embeddableApi.contextMenuTrigger.title",{defaultMessage:"Context menu"}),description:c.i18n.translate("embeddableApi.contextMenuTrigger.description",{defaultMessage:"A panel top-right corner context menu click."})},$="PANEL_BADGE_TRIGGER",U={id:$,title:c.i18n.translate("embeddableApi.panelBadgeTrigger.title",{defaultMessage:"Panel badges"}),description:c.i18n.translate("embeddableApi.panelBadgeTrigger.description",{defaultMessage:"Actions appear in title bar when an embeddable loads in a panel."})},G="PANEL_NOTIFICATION_TRIGGER",V={id:G,title:c.i18n.translate("embeddableApi.panelNotificationTrigger.title",{defaultMessage:"Panel notifications"}),description:c.i18n.translate("embeddableApi.panelNotificationTrigger.description",{defaultMessage:"Actions appear in top-right corner of a panel."})},H="SELECT_RANGE_TRIGGER",W={id:H,title:c.i18n.translate("embeddableApi.selectRangeTrigger.title",{defaultMessage:"Range selection"}),description:c.i18n.translate("embeddableApi.selectRangeTrigger.description",{defaultMessage:"A range of values on the visualization"})},q="VALUE_CLICK_TRIGGER",K={id:q,title:c.i18n.translate("embeddableApi.valueClickTrigger.title",{defaultMessage:"Single click"}),description:c.i18n.translate("embeddableApi.valueClickTrigger.description",{defaultMessage:"A data point click on the visualization"})},Y=e=>e.data&&"data"in e.data,J=e=>e.data&&"range"in e.data,X=e=>!!e.data&&"object"==typeof e.data&&"number"==typeof e.data.rowIndex,Q=e=>!!e&&"object"==typeof e&&!!e.embeddable&&"object"==typeof e.embeddable;var Z=n(28),ee=n.n(Z);const te=e=>Object.keys(e);class container_Container extends embeddable_Embeddable{constructor(e,t,n,i,s){super(e,t,i),a()(this,"isContainer",!0),a()(this,"children",{}),a()(this,"subscription",void 0),a()(this,"anyChildOutputChange$",void 0),this.getFactory=n,this.getFactory=n;const o=Boolean((null==s?void 0:s.initializeSequentially)||(null==s?void 0:s.childIdInitializeOrder)),r=this.getInput$().pipe(Object(m.take)(1),Object(m.mergeMap)((async()=>{const t=this.initializeChildEmbeddables(e,s);o&&await t}))),d=this.getInput$().pipe(Object(m.pairwise)());this.subscription=r.pipe(Object(m.combineLatestWith)(d)).subscribe((([e,[{panels:t},{panels:n}]])=>{this.maybeUpdateChildren(n,t)})),this.anyChildOutputChange$=this.getOutput$().pipe(Object(m.map)((()=>this.getChildIds())),Object(m.distinctUntilChanged)(b.a),Object(m.switchMap)((e=>Object(h.merge)(...e.map((e=>this.getChild(e).getOutput$().pipe(Object(m.catchError)((()=>h.EMPTY)),Object(m.map)((()=>e)))))))))}setChildLoaded(e){this.input.panels[e.id]?(this.children[e.id]=e,this.updateOutput({embeddableLoaded:{...this.output.embeddableLoaded,[e.id]:!0}})):e.destroy()}updateInputForChild(e,t){if(!this.input.panels[e])throw new errors_PanelNotFoundError;const n={panels:{...this.input.panels,[e]:{...this.input.panels[e],explicitInput:{...this.input.panels[e].explicitInput,...t}}}};this.updateInput(n)}reload(){Object.values(this.children).forEach((e=>e.reload()))}async addNewEmbeddable(e,t){const n=this.getFactory(e);if(!n)throw new errors_EmbeddableFactoryNotFoundError(e);const i=this.createNewPanelState(n,t);return this.createAndSaveEmbeddable(e,i)}async replaceEmbeddable(e,t,n){if(!this.input.panels[e])throw new errors_PanelNotFoundError;if(n&&n!==this.input.panels[e].type){if(!this.getFactory(n))throw new errors_EmbeddableFactoryNotFoundError(n);this.updateInput({panels:{...this.input.panels,[e]:{...this.input.panels[e],explicitInput:{...t,id:e},type:n}}})}else this.updateInputForChild(e,t);await this.untilEmbeddableLoaded(e)}removeEmbeddable(e){const t=this.onRemoveEmbeddable(e);this.updateInput({panels:t})}onRemoveEmbeddable(e){const t={...this.input.panels};return delete t[e],t}getChildIds(){return Object.keys(this.children)}getChild(e){return this.children[e]}getInputForChild(e){const t=this.getInheritedInput(e),n=this.getPanelState(e),i=n.explicitInput,a={};return te(n.explicitInput).forEach((e=>{void 0===i[e]&&void 0!==t[e]||(a[e]=i[e])})),{...t,...a}}getAnyChildOutputChange$(){return this.anyChildOutputChange$}destroy(){var e;super.destroy(),Object.values(this.children).forEach((e=>e.destroy())),null===(e=this.subscription)||void 0===e||e.unsubscribe()}async untilEmbeddableLoaded(e){if(!this.input.panels[e])throw new errors_PanelNotFoundError;return this.output.embeddableLoaded[e]?this.children[e]:new Promise(((t,n)=>{const i=Object(h.merge)(this.getOutput$(),this.getInput$()).subscribe((()=>{this.output.embeddableLoaded[e]&&(i.unsubscribe(),t(this.children[e])),void 0===this.input.panels[e]&&(i.unsubscribe(),t(void 0))}))}))}async getExplicitInputIsEqual(e){const{panels:t,...n}=e,{panels:i,...a}=this.getInput();if(!Object(r.isEqual)(n,a))return!1;const s=Object.keys(t),o=Object.keys(i);if(s.length!==o.length||Object(r.xor)(s,o).length>0)return!1;for(const e of s){const n=await this.untilEmbeddableLoaded(e),i=t[e].explicitInput;if(!A(n)&&!await n.getExplicitInputIsEqual(i))return!1}return!0}createNewPanelState(e,t={}){const n=t.id||ee.a.v4(),i=this.createNewExplicitEmbeddableInput(n,e,t);return{type:e.type,explicitInput:{...i,id:n}}}getPanelState(e){if(void 0===this.input.panels[e])throw new errors_PanelNotFoundError;return this.input.panels[e]}async initializeChildEmbeddables(e,t){let n=Object.keys(e.panels);if(null!=t&&t.childIdInitializeOrder){const e=new Set;for(const i of[...t.childIdInitializeOrder,...n])!e.has(i)&&Boolean(this.getInput().panels[i])&&e.add(i);n=Array.from(e)}for(const i of n)if(null!=t&&t.initializeSequentially){const t=await this.onPanelAdded(e.panels[i]);t&&!A(t)&&await this.untilEmbeddableLoaded(i)}else this.onPanelAdded(e.panels[i])}async createAndSaveEmbeddable(e,t){return this.updateInput({panels:{...this.input.panels,[t.explicitInput.id]:t}}),await this.untilEmbeddableLoaded(t.explicitInput.id)}createNewExplicitEmbeddableInput(e,t,n={}){const i=this.getInheritedInput(e),a=t.getDefaultInput(n),s=n;return te(a).forEach((e=>{void 0===i[e]&&void 0===s[e]&&(s[e]=a[e])})),s}onPanelRemoved(e){const t=this.getChild(e);t&&(t.destroy(),delete this.children[e]),this.updateOutput({embeddableLoaded:{...this.output.embeddableLoaded,[e]:void 0}})}async onPanelAdded(e){let t;this.updateOutput({embeddableLoaded:{...this.output.embeddableLoaded,[e.explicitInput.id]:!1}});const n=this.getInputForChild(e.explicitInput.id);try{const i=this.getFactory(e.type);if(!i)throw new errors_EmbeddableFactoryNotFoundError(e.type);t=Object(N.a)(n)?await i.createFromSavedObject(n.savedObjectId,n,this):await i.create(n,this)}catch(n){t=new error_embeddable_ErrorEmbeddable(n,{id:e.explicitInput.id},this)}return t?t.deferEmbeddableLoad||this.setChildLoaded(t):void 0===t&&this.removeEmbeddable(e.explicitInput.id),t}panelHasChanged(e,t){if(e.type!==t.type)return!0}maybeUpdateChildren(e,t){Object.keys({...e,...this.output.embeddableLoaded}).forEach((n=>void 0!==e[n]&&void 0===this.output.embeddableLoaded[n]?this.onPanelAdded(e[n]):void 0===e[n]&&void 0!==this.output.embeddableLoaded[n]?this.onPanelRemoved(n):void(e[n]&&t[n]&&this.panelHasChanged(e[n],t[n])&&(this.onPanelRemoved(n),this.onPanelAdded(e[n])))))}}var ne=n(12),ie=n.n(ne);class embeddable_child_panel_EmbeddableChildPanel extends o.a.Component{constructor(e){super(e),a()(this,"mounted",void 0),a()(this,"embeddable",void 0),a()(this,"subscription",new h.Subscription),this.state={firstTimeLoading:!0},this.mounted=!1}getEventStatus(e){return Object(r.isNil)(e.error)?!0===e.rendered?"rendered":!1===e.loading?"loaded":"loading":"error"}async componentDidMount(){this.mounted=!0;const{container:e}=this.props;if(this.embeddable=await e.untilEmbeddableLoaded(this.props.embeddableId),this.mounted){var t;let e=0;null===(t=this.subscription)||void 0===t||t.add(this.embeddable.getOutput$().pipe(Object(m.map)((t=>(!0===t.loading&&(e=performance.now()),{id:this.embeddable.id,status:this.getEventStatus(t),error:t.error}))),Object(m.distinct)((t=>e+t.id+t.status+!!t.error)),Object(m.map)((t=>({...t,timeToEvent:performance.now()-e})))).subscribe((e=>{this.props.onPanelStatusChange&&this.props.onPanelStatusChange(e)}))),this.setState({firstTimeLoading:!1})}}componentWillUnmount(){this.mounted=!1,this.subscription&&this.subscription.unsubscribe()}render(){const{PanelComponent:e,index:t}=this.props,n=ie()("embPanel",{"embPanel-isLoading":this.state.firstTimeLoading});return Object(P.jsx)("div",{className:n},this.state.firstTimeLoading||!this.embeddable?Object(P.jsx)(I.EuiLoadingChart,{size:"l",mono:!0}):Object(P.jsx)(e,{embeddable:this.embeddable,index:t}))}}var ae=n(20);const se="openInspector";class inspect_panel_action_InspectPanelAction{constructor(e){a()(this,"type",se),a()(this,"id",se),a()(this,"order",20),this.inspector=e}getDisplayName(){return c.i18n.translate("embeddableApi.panel.inspectPanel.displayName",{defaultMessage:"Inspect"})}getIconType(){return"inspect"}async isCompatible({embeddable:e}){return this.inspector.isAvailable(e.getInspectorAdapters())}async execute({embeddable:e}){const t=e.getInspectorAdapters();if(!await this.isCompatible({embeddable:e})||void 0===t)throw new Error("Action not compatible with context");const n=this.inspector.open(t,{title:e.getTitle(),options:{fileName:e.getTitle()||e.getInput().title||e.getOutput().defaultTitle||c.i18n.translate("embeddableApi.panel.inspectPanel.untitledEmbeddableFilename",{defaultMessage:"untitled"})}}),i=e.destroy;e.destroy=()=>{n.close(),i&&i.call(e)},n.onClose.finally((()=>{e.destroy=i}))}}var oe=n(10),re=n(29);function de({menuItems:e}){const[t,n]=Object(s.useState)(!1);return Object(P.jsx)(I.EuiPopover,{id:"createNew",button:Object(P.jsx)(I.EuiButton,{"data-test-subj":"createNew",iconType:"plusInCircle",iconSide:"left",onClick:()=>{n(!t)},fill:!0},Object(P.jsx)(oe.FormattedMessage,{id:"embeddableApi.addPanel.createNewDefaultOption",defaultMessage:"Create new"})),isOpen:t,closePopover:()=>{n(!1)},panelPaddingSize:"none",anchorPosition:"downRight"},Object(P.jsx)(I.EuiContextMenuPanel,{items:e}))}class add_panel_flyout_AddPanelFlyout extends o.a.Component{constructor(e){super(e),a()(this,"lastToast",void 0),a()(this,"state",{isCreateMenuOpen:!1}),a()(this,"showToast",(e=>{this.lastToast&&this.props.notifications.toasts.remove(this.lastToast),this.lastToast=this.props.notifications.toasts.addSuccess({title:c.i18n.translate("embeddableApi.addPanel.savedObjectAddedToContainerSuccessMessageTitle",{defaultMessage:"{savedObjectName} was added",values:{savedObjectName:e}}),"data-test-subj":"addObjectToContainerSuccess"})})),a()(this,"createNewEmbeddable",(async e=>{this.props.onClose();const t=this.props.getFactory(e);if(!t)throw new errors_EmbeddableFactoryNotFoundError(e);const n=await t.getExplicitInput(),i=await this.props.container.addNewEmbeddable(e,n);i&&this.showToast(i.getInput().title||"")})),a()(this,"onAddPanel",(async(e,t,n,i)=>{const a=[...this.props.getAllFactories()].find((e=>e.savedObjectMetaData&&e.savedObjectMetaData.type===t));if(!a)throw new errors_EmbeddableFactoryNotFoundError(t);this.props.container.addNewEmbeddable(a.type,{savedObjectId:e}),this.doTelemetryForAddEvent(this.props.container.type,a,i),this.showToast(n)}))}doTelemetryForAddEvent(e,t,n){const{reportUiCounter:i}=this.props;if(i){var a;const s=null!==(a=t.savedObjectMetaData)&&void 0!==a&&a.getSavedObjectSubType?t.savedObjectMetaData.getSavedObjectSubType(n):t.type;i(e,re.METRIC_TYPE.CLICK,`${s}:add`)}}getCreateMenuItems(){return[...this.props.getAllFactories()].filter((e=>e.isEditable()&&!e.isContainerType&&e.canCreateNew())).map((e=>Object(P.jsx)(I.EuiContextMenuItem,{key:e.type,"data-test-subj":`createNew-${e.type}`,onClick:()=>this.createNewEmbeddable(e.type),className:"embPanel__addItem"},function([e,...t]){return`${e.toUpperCase()}${t.join("")}`}(e.getDisplayName()))))}render(){const e=this.props.SavedObjectFinder,t=[...this.props.getAllFactories()].filter((e=>Boolean(e.savedObjectMetaData)&&!e.isContainerType)).map((({savedObjectMetaData:e})=>e)),n=Object(P.jsx)(e,{onChoose:this.onAddPanel,savedObjectMetaData:t,showFilter:!0,noItemsMessage:c.i18n.translate("embeddableApi.addPanel.noMatchingObjectsMessage",{defaultMessage:"No matching objects found."})},this.props.showCreateNewMenu?Object(P.jsx)(de,{menuItems:this.getCreateMenuItems()}):null);return Object(P.jsx)(o.a.Fragment,null,Object(P.jsx)(I.EuiFlyoutHeader,{hasBorder:!0},Object(P.jsx)(I.EuiTitle,{size:"m"},Object(P.jsx)("h2",null,Object(P.jsx)(oe.FormattedMessage,{id:"embeddableApi.addPanel.Title",defaultMessage:"Add from library"})))),Object(P.jsx)(I.EuiFlyoutBody,null,n))}}function le(e){const{embeddable:t,getFactory:n,getAllFactories:i,overlays:a,notifications:s,SavedObjectFinder:o,showCreateNewMenu:r,reportUiCounter:d,theme:l}=e,c=a.openFlyout(Object(w.toMountPoint)(Object(P.jsx)(add_panel_flyout_AddPanelFlyout,{container:t,onClose:()=>{c&&c.close()},getFactory:n,getAllFactories:i,notifications:s,reportUiCounter:d,SavedObjectFinder:o,showCreateNewMenu:r}),{theme$:l.theme$}),{"data-test-subj":"dashboardAddPanel",ownFocus:!0});return c}const ce="ACTION_ADD_PANEL";class add_panel_action_AddPanelAction{constructor(e,t,n,i,s,o,r){a()(this,"type",ce),a()(this,"id",ce),this.getFactory=e,this.getAllFactories=t,this.overlays=n,this.notifications=i,this.SavedObjectFinder=s,this.theme=o,this.reportUiCounter=r}getDisplayName(){return c.i18n.translate("embeddableApi.addPanel.displayName",{defaultMessage:"Add panel"})}getIconType(){return"plusInCircleFilled"}async isCompatible(e){const{embeddable:t}=e;return t.getIsContainer()&&t.getInput().viewMode===f.a.EDIT}async execute(e){const{embeddable:t}=e;if(!t.getIsContainer()||!await this.isCompatible(e))throw new Error("Context is incompatible");le({embeddable:t,getFactory:this.getFactory,getAllFactories:this.getAllFactories,overlays:this.overlays,notifications:this.notifications,SavedObjectFinder:this.SavedObjectFinder,reportUiCounter:this.reportUiCounter,theme:this.theme})}}const ue="deletePanel";class remove_panel_action_RemovePanelAction{constructor(){a()(this,"type",ue),a()(this,"id",ue),a()(this,"order",1)}getDisplayName(){return c.i18n.translate("embeddableApi.panel.removePanel.displayName",{defaultMessage:"Delete from dashboard"})}getIconType(){return"trash"}async isCompatible({embeddable:e}){const t=e.parent&&void 0!==e.parent.getInput().expandedPanelId&&e.parent.getInput().expandedPanelId===e.id;return Boolean(e.parent&&e.getInput().viewMode===f.a.EDIT&&!t)}async execute({embeddable:e}){if(!e.parent||!await this.isCompatible({embeddable:e}))throw new ae.IncompatibleActionError;e.parent.removeEmbeddable(e.id)}}const pe="ACTION_CUSTOMIZE_PANEL";class customize_panel_action_CustomizePanelTitleAction{constructor(e){a()(this,"type",pe),a()(this,"id",pe),a()(this,"order",40),this.getDataFromUser=e}getDisplayName(){return c.i18n.translate("embeddableApi.customizePanel.action.displayName",{defaultMessage:"Edit panel title"})}getIconType(){return"pencil"}async isCompatible({embeddable:e}){return e.getInput().viewMode===f.a.EDIT}async execute({embeddable:e}){const t=await this.getDataFromUser({embeddable:e}),{title:n,hideTitle:i}=t;e.updateInput({title:n,hidePanelTitles:i})}}class panel_options_menu_PanelOptionsMenu extends o.a.Component{static getDerivedStateFromProps(e,t){return e.closeContextMenu?{...t,isPopoverOpen:!1}:t}constructor(e){super(e),a()(this,"mounted",!1),a()(this,"closePopover",(()=>{this.mounted&&this.setState({isPopoverOpen:!1})})),a()(this,"toggleContextMenu",(()=>{this.mounted&&this.setState((({isPopoverOpen:e})=>({isPopoverOpen:!e})),(()=>{this.state.isPopoverOpen&&(this.setState({actionContextMenuPanel:void 0}),this.props.getActionContextMenuPanel().then((e=>{this.mounted&&this.setState({actionContextMenuPanel:e})})).catch((e=>console.error(e))))}))})),this.state={actionContextMenuPanel:void 0,isPopoverOpen:!1}}async componentDidMount(){this.mounted=!0,this.setState({actionContextMenuPanel:void 0});const e=await this.props.getActionContextMenuPanel();this.mounted&&this.setState({actionContextMenuPanel:e})}componentWillUnmount(){this.mounted=!1}render(){const{isViewMode:e,title:t,index:n}=this.props,i=c.i18n.translate("embeddableApi.panel.optionsMenu.panelOptionsButtonEnhancedAriaLabel",{defaultMessage:"Panel options for {title}",values:{title:t}}),a=void 0===n?c.i18n.translate("embeddableApi.panel.optionsMenu.panelOptionsButtonAriaLabel",{defaultMessage:"Panel options"}):c.i18n.translate("embeddableApi.panel.optionsMenu.panelOptionsButtonAriaLabelWithIndex",{defaultMessage:"Options for panel {index}",values:{index:n}}),s=Object(P.jsx)(I.EuiButtonIcon,{iconType:e?"boxesHorizontal":"gear",color:"text",className:"embPanel__optionsMenuButton","aria-label":t?i:a,"data-test-subj":"embeddablePanelToggleMenuIcon",onClick:this.toggleContextMenu});return Object(P.jsx)(I.EuiPopover,{className:"embPanel__optionsMenuPopover",button:s,isOpen:this.state.isPopoverOpen,closePopover:this.closePopover,panelPaddingSize:"none",anchorPosition:"downRight","data-test-subj":this.state.isPopoverOpen?"embeddablePanelContextMenuOpen":"embeddablePanelContextMenuClosed"},Object(P.jsx)(I.EuiContextMenu,{initialPanelId:"mainMenu",panels:this.state.actionContextMenuPanel||[]}))}}function be({title:e,index:t,isViewMode:n,hidePanelTitle:i,getActionContextMenuPanel:a,closeContextMenu:s,badges:r,notifications:d,embeddable:l,headerId:u,customizeTitle:p}){const b=function(e){if("getDescription"in e){const t=e.getDescription();if(t)return t}return""}(l),h=!i&&(!n||e),m=!n||r.length>0||d.length>0||h||b,g=ie()("embPanel__header",{"embPanel__header--floater":!m}),f=c.i18n.translate("embeddableApi.panel.placeholderTitle",{defaultMessage:"[No Title]"}),v=()=>Object(P.jsx)("span",{id:u},m&&e?c.i18n.translate("embeddableApi.panel.enhancedDashboardPanelAriaLabel",{defaultMessage:"Dashboard panel: {title}",values:{title:e||f}}):c.i18n.translate("embeddableApi.panel.dashboardPanelAriaLabel",{defaultMessage:"Dashboard panel"}));return m?Object(P.jsx)("figcaption",{className:g,"data-test-subj":`embeddablePanelHeading-${(e||"").replace(/\s/g,"")}`},Object(P.jsx)("h2",{"data-test-subj":"dashboardPanelTitle",className:"embPanel__title embPanel__dragger"},Object(P.jsx)(I.EuiScreenReaderOnly,null,v()),(()=>{let t;return h&&(t=n?Object(P.jsx)("span",{className:ie()("embPanel__titleText",{embPanel__placeholderTitleText:!e})},e||f):p?Object(P.jsx)(I.EuiLink,{color:"text","data-test-subj":"embeddablePanelTitleLink",className:ie()("embPanel__titleText",{embPanel__placeholderTitleText:!e}),"aria-label":c.i18n.translate("embeddableApi.panel.editTitleAriaLabel",{defaultMessage:"Click to edit title: {title}",values:{title:e||f}}),onClick:()=>p.execute({embeddable:l})},e||f):null),b?Object(P.jsx)(I.EuiToolTip,{content:b,delay:"regular",position:"top",anchorClassName:"embPanel__titleTooltipAnchor"},Object(P.jsx)("span",{className:"embPanel__titleInner"},t," ",Object(P.jsx)(I.EuiIcon,{type:"iInCircle",color:"subdued"}))):Object(P.jsx)("span",{className:"embPanel__titleInner"},t)})(),function(e,t){return e.map((e=>Object(P.jsx)(I.EuiBadge,{key:e.id,className:"embPanel__headerBadge",iconType:e.getIconType({embeddable:t,trigger:U}),onClick:()=>e.execute({embeddable:t,trigger:U}),onClickAriaLabel:e.getDisplayName({embeddable:t,trigger:U})},e.getDisplayName({embeddable:t,trigger:U}))))}(r,l)),function(e,t){return e.map((e=>{const n={embeddable:t};let i=e.MenuItem?o.a.createElement(Object(w.uiToReactComponent)(e.MenuItem),{key:e.id,context:{embeddable:t,trigger:V}}):Object(P.jsx)(I.EuiNotificationBadge,{"data-test-subj":`embeddablePanelNotification-${e.id}`,key:e.id,style:{marginTop:"4px",marginRight:"4px"},onClick:()=>e.execute({...n,trigger:V})},e.getDisplayName({...n,trigger:V}));if(e.getDisplayNameTooltip){const t=e.getDisplayNameTooltip({...n,trigger:V});t&&(i=Object(P.jsx)(I.EuiToolTip,{position:"top",delay:"regular",content:t,key:e.id},i))}return i}))}(d,l),Object(P.jsx)(panel_options_menu_PanelOptionsMenu,{isViewMode:n,getActionContextMenuPanel:a,closeContextMenu:s,title:e,index:t})):Object(P.jsx)("div",{className:g},Object(P.jsx)(panel_options_menu_PanelOptionsMenu,{getActionContextMenuPanel:a,isViewMode:n,closeContextMenu:s,title:e,index:t}),Object(P.jsx)(I.EuiScreenReaderOnly,null,v()))}class customize_panel_modal_CustomizePanelModal extends s.Component{constructor(e){var t;super(e),a()(this,"reset",(()=>{this.setState({title:this.props.embeddable.getOutput().defaultTitle})})),a()(this,"onHideTitleToggle",(()=>{this.setState((e=>({hideTitle:!e.hideTitle})))})),a()(this,"save",(()=>{const e=this.state.title===this.props.embeddable.getOutput().defaultTitle?void 0:this.state.title;this.props.updateTitle(e,this.state.hideTitle)})),this.state={hideTitle:e.embeddable.getInput().hidePanelTitles,title:null!==(t=e.embeddable.getInput().title)&&void 0!==t?t:this.props.embeddable.getOutput().defaultTitle}}render(){const e="customizePanelModalTitle";return Object(P.jsx)(I.EuiFocusTrap,{clickOutsideDisables:!0,initialFocus:".panelTitleInputText"},Object(P.jsx)(I.EuiOutsideClickDetector,{onOutsideClick:this.props.cancel},Object(P.jsx)("div",{role:"dialog","aria-modal":"true","aria-labelledby":e,className:"euiModal__flex"},Object(P.jsx)("form",{onSubmit:e=>{e.preventDefault(),this.save()}},Object(P.jsx)(I.EuiModalHeader,null,Object(P.jsx)(I.EuiModalHeaderTitle,{"data-test-subj":"customizePanelTitle"},Object(P.jsx)("h2",{id:e},"Customize panel"))),Object(P.jsx)(I.EuiModalBody,null,Object(P.jsx)(I.EuiFormRow,null,Object(P.jsx)(I.EuiSwitch,{checked:!this.state.hideTitle,"data-test-subj":"customizePanelHideTitle",id:"hideTitle",label:Object(P.jsx)(oe.FormattedMessage,{defaultMessage:"Show panel title",id:"embeddableApi.customizePanel.modal.showTitle"}),onChange:this.onHideTitleToggle})),Object(P.jsx)(I.EuiFormRow,{label:c.i18n.translate("embeddableApi.customizePanel.modal.optionsMenuForm.panelTitleFormRowLabel",{defaultMessage:"Panel title"})},Object(P.jsx)(I.EuiFieldText,{id:"panelTitleInput",className:"panelTitleInputText","data-test-subj":"customEmbeddablePanelTitleInput",name:"min",type:"text",disabled:this.state.hideTitle,value:this.state.title||"",onChange:e=>this.setState({title:e.target.value}),"aria-label":c.i18n.translate("embeddableApi.customizePanel.modal.optionsMenuForm.panelTitleInputAriaLabel",{defaultMessage:"Enter a custom title for your panel"}),append:Object(P.jsx)(I.EuiButtonEmpty,{"data-test-subj":"resetCustomEmbeddablePanelTitle",onClick:this.reset,disabled:this.state.hideTitle},Object(P.jsx)(oe.FormattedMessage,{id:"embeddableApi.customizePanel.modal.optionsMenuForm.resetCustomDashboardButtonLabel",defaultMessage:"Reset"}))}))),Object(P.jsx)(I.EuiModalFooter,null,Object(P.jsx)(I.EuiButtonEmpty,{onClick:()=>this.props.cancel()},Object(P.jsx)(oe.FormattedMessage,{id:"embeddableApi.customizePanel.modal.cancel",defaultMessage:"Cancel"})),Object(P.jsx)(I.EuiButton,{"data-test-subj":"saveNewTitleButton",onClick:this.save,fill:!0},Object(P.jsx)(oe.FormattedMessage,{id:"embeddableApi.customizePanel.modal.saveButtonTitle",defaultMessage:"Save"})))))))}}const he=({order:e},{order:t})=>(t||0)-(e||0);class embeddable_panel_EmbeddablePanel extends o.a.Component{constructor(e){var t,n,i,s;super(e),a()(this,"embeddableRoot",o.a.createRef()),a()(this,"parentSubscription",void 0),a()(this,"subscription",new h.Subscription),a()(this,"mounted",!1),a()(this,"generateId",Object(I.htmlIdGenerator)()),a()(this,"onFocus",(e=>{this.setState({focusedPanelIndex:e})})),a()(this,"onBlur",(e=>{this.state.focusedPanelIndex===e&&this.setState({focusedPanelIndex:void 0})})),a()(this,"closeMyContextMenuPanel",(()=>{this.mounted&&this.setState({closeContextMenu:!0},(()=>{this.mounted&&this.setState({closeContextMenu:!1})}))})),a()(this,"getUniversalActions",(()=>{var e;let t={};return this.props.inspector&&(t={inspectPanel:new inspect_panel_action_InspectPanelAction(this.props.inspector)}),this.props.getEmbeddableFactory&&this.props.getAllEmbeddableFactories&&this.props.overlays&&this.props.notifications&&this.props.SavedObjectFinder&&this.props.application?{...t,customizePanelTitle:new customize_panel_action_CustomizePanelTitleAction((n=this.props.overlays,i=this.props.theme,async function(e){return new Promise((t=>{const a=n.openModal(Object(w.toMountPoint)(Object(P.jsx)(customize_panel_modal_CustomizePanelModal,{embeddable:e.embeddable,updateTitle:(e,n)=>{a.close(),t({title:e,hideTitle:n})},cancel:()=>a.close()}),{theme$:i.theme$}),{"data-test-subj":"customizePanel"})}))})),addPanel:new add_panel_action_AddPanelAction(this.props.getEmbeddableFactory,this.props.getAllEmbeddableFactories,this.props.overlays,this.props.notifications,this.props.SavedObjectFinder,this.props.theme,this.props.reportUiCounter),removePanel:new remove_panel_action_RemovePanelAction,editPanel:new edit_panel_action_EditPanelAction(this.props.getEmbeddableFactory,this.props.application,this.props.stateTransfer,null===(e=this.props.containerContext)||void 0===e?void 0:e.getCurrentPath)}:t;var n,i})),a()(this,"getActionContextMenuPanel",(async()=>{var e,t,n;let i=null!==(e=await(null===(t=(n=this.props).getActions)||void 0===t?void 0:t.call(n,B,{embeddable:this.props.embeddable})))&&void 0!==e?e:[];const{disabledActions:a}=this.props.embeddable.getInput();if(a){const e=(e=>({id:t})=>-1===e.indexOf(t))(a);i=i.filter(e)}let s=i.concat(Object.values(this.state.universalActions||{})).sort(he);return this.props.actionPredicate&&(s=s.filter((({id:e})=>this.props.actionPredicate(e)))),await Object(ae.buildContextMenuForActions)({actions:s.map((e=>({action:e,context:{embeddable:this.props.embeddable},trigger:z}))),closeMenu:this.closeMyContextMenuPanel})}));const{embeddable:r}=this.props,d=null!==(t=r.getInput().viewMode)&&void 0!==t?t:f.a.EDIT,l=Boolean(null===(n=r.parent)||void 0===n||null===(i=n.getInput())||void 0===i?void 0:i.hidePanelTitles)||Boolean(null===(s=r.getInput())||void 0===s?void 0:s.hidePanelTitles);this.state={universalActions:this.getUniversalActions(),panels:[],viewMode:d,hidePanelTitle:l,closeContextMenu:!1,badges:[],notifications:[]}}async refreshBadges(){var e,t,n;if(!this.mounted)return;if(!1===this.props.showBadges)return;let i=null!==(e=await(null===(t=(n=this.props).getActions)||void 0===t?void 0:t.call(n,$,{embeddable:this.props.embeddable})))&&void 0!==e?e:[];const{disabledActions:a}=this.props.embeddable.getInput();a&&(i=i.filter((e=>-1===a.indexOf(e.id)))),b()(this.state.badges,i)||this.setState({badges:i})}async refreshNotifications(){var e,t,n;if(!this.mounted)return;if(!1===this.props.showNotifications)return;let i=null!==(e=await(null===(t=(n=this.props).getActions)||void 0===t?void 0:t.call(n,G,{embeddable:this.props.embeddable})))&&void 0!==e?e:[];const{disabledActions:a}=this.props.embeddable.getInput();a&&(i=i.filter((e=>-1===a.indexOf(e.id)))),b()(this.state.notifications,i)||this.setState({notifications:i})}UNSAFE_componentWillMount(){this.mounted=!0;const{embeddable:e}=this.props,{parent:t}=e;this.subscription.add(e.getInput$().subscribe((async()=>{var t;this.mounted&&(this.setState({viewMode:null!==(t=e.getInput().viewMode)&&void 0!==t?t:f.a.EDIT}),this.refreshBadges(),this.refreshNotifications())}))),t&&(this.parentSubscription=t.getInput$().subscribe((async()=>{var n,i,a;this.mounted&&t&&(this.setState({hidePanelTitle:Boolean(null===(n=e.parent)||void 0===n||null===(i=n.getInput())||void 0===i?void 0:i.hidePanelTitles)||Boolean(null===(a=e.getInput())||void 0===a?void 0:a.hidePanelTitles)}),this.refreshBadges(),this.refreshNotifications())})))}componentWillUnmount(){var e,t;this.mounted=!1,this.subscription.unsubscribe(),this.parentSubscription&&this.parentSubscription.unsubscribe(),null===(e=(t=this.state).destroyError)||void 0===e||e.call(t),this.props.embeddable.destroy()}render(){const e=[f.a.VIEW,f.a.PRINT].includes(this.state.viewMode),t=ie()("embPanel",{"embPanel--editing":!e,"embPanel--loading":this.state.loading}),n={};this.state.loading&&(n["data-loading"]=!0),this.state.error&&(n["data-error"]=!0);const i=this.props.embeddable.getTitle(),a=this.generateId(),s=this.props.embeddable.getSelfStyledOptions?this.props.embeddable.getSelfStyledOptions():void 0;return Object(P.jsx)(I.EuiPanel,{className:t,"data-test-subj":"embeddablePanel","data-test-embeddable-id":this.props.embeddable.id,paddingSize:"none",role:"figure","aria-labelledby":a,hasShadow:this.props.showShadow},!this.props.hideHeader&&Object(P.jsx)(be,{getActionContextMenuPanel:this.getActionContextMenuPanel,hidePanelTitle:this.state.hidePanelTitle||!(null==s||!s.hideTitle),isViewMode:e,customizeTitle:"customizePanelTitle"in this.state.universalActions?this.state.universalActions.customizePanelTitle:void 0,closeContextMenu:this.state.closeContextMenu,title:i,index:this.props.index,badges:this.state.badges,notifications:this.state.notifications,embeddable:this.props.embeddable,headerId:a}),this.state.error&&Object(P.jsx)(I.EuiFlexGroup,{alignItems:"center",className:"eui-fullHeight embPanel__error","data-test-subj":"embeddableError",justifyContent:"center"},Object(P.jsx)(I.EuiFlexItem,null,Object(P.jsx)(O,{embeddable:this.props.embeddable,error:this.state.error},(e=>Object(P.jsx)(C,{editPanelAction:this.state.universalActions.editPanel,embeddable:this.props.embeddable,error:e}))))),Object(P.jsx)("div",S()({className:"embPanel__content",ref:this.embeddableRoot},n),this.state.node))}componentDidMount(){var e;if(!this.embeddableRoot.current)return;this.subscription.add(this.props.embeddable.getOutput$().subscribe((e=>{this.setState({error:e.error,loading:e.loading})}),(e=>{this.setState({error:e})})));const t=null!==(e=this.props.embeddable.render(this.embeddableRoot.current))&&void 0!==e?e:void 0;Object(x.isPromise)(t)?t.then((e=>this.setState({node:e}))):this.setState({node:t})}}const me="embeddable_editor_state";function ge(e){return ye("originatingApp",e,"string")}const fe="embeddable_package_state";function ve(e){return ye("type",e,"string")&&ye("input",e,"object")}function ye(e,t,n){return Boolean(t)&&e in t&&(!n||typeof t[e]===n)}const _e="EMBEDDABLE_STATE_TRANSFER";class embeddable_state_transfer_EmbeddableStateTransfer{constructor(e,t,n,i){a()(this,"isTransferInProgress",void 0),a()(this,"storage",void 0),a()(this,"appList",void 0),a()(this,"getAppNameFromId",(e=>{var t,n;return null===(t=this.appList)||void 0===t||null===(n=t.get(e))||void 0===n?void 0:n.title})),this.navigateToApp=e,this.storage=i||new g.Storage(sessionStorage),this.isTransferInProgress=!1,this.appList=n,t.subscribe((()=>{this.isTransferInProgress=!1}))}getIncomingEditorState(e,t){return this.getIncomingState(ge,e,me,{keysToRemoveAfterFetch:t?[me]:void 0})}clearEditorState(e){const t=this.storage.get(_e);var n;t&&(e?null===(n=t.embeddable_editor_state)||void 0===n||delete n[e]:delete t.embeddable_editor_state,this.storage.set(_e,t))}getIncomingEmbeddablePackage(e,t){return this.getIncomingState(ve,e,fe,{keysToRemoveAfterFetch:t?[fe]:void 0})}async navigateToEditor(e,t){this.isTransferInProgress=!0,await this.navigateToWithState(e,me,{...t})}async navigateToWithEmbeddablePackage(e,t){this.isTransferInProgress=!0,await this.navigateToWithState(e,fe,{...t})}getIncomingState(e,t,n,i){var a,s;const o=null===(a=this.storage.get(_e))||void 0===a||null===(s=a[n])||void 0===s?void 0:s[t],d=!e||e(o)?Object(r.cloneDeep)(o):void 0;if(d&&null!=i&&i.keysToRemoveAfterFetch){const e={...this.storage.get(_e)};i.keysToRemoveAfterFetch.forEach((t=>{delete e[t]})),this.storage.set(_e,e)}return d}async navigateToWithState(e,t,n){var i;const a=(null===(i=this.storage.get(_e))||void 0===i?void 0:i[t])||{},s={...this.storage.get(_e),[t]:{...a,[e]:null==n?void 0:n.state}};this.storage.set(_e,s),await this.navigateToApp(e,{path:null==n?void 0:n.path,openInNewTab:null==n?void 0:n.openInNewTab,skipAppLeave:null==n?void 0:n.skipAppLeave})}}function je(e){return!!e.inputIsRefType&&!!e.getInputAsValueType&&!!e.getInputAsRefType}function Ee(e){return!!e.getFilters&&!!e.getQuery}const xe="attributes";class attribute_service_AttributeService{constructor(e,t,n,i,s,o){if(a()(this,"inputIsRefType",(e=>Object(N.a)(e))),a()(this,"getInputAsValueType",(async e=>{if(!this.inputIsRefType(e))return e;const{attributes:t}=await this.unwrapAttributes(e),n=t.title,{savedObjectId:i,...a}=e;return{...a,attributes:Object(r.omit)(t,["title","description"]),title:n}})),a()(this,"getInputAsRefType",(async(e,t)=>this.inputIsRefType(e)?e:new Promise(((n,i)=>{t&&t.showSaveModal&&this.showSaveModal(Object(P.jsx)(d.SavedObjectSaveModal,{onSave:async t=>{await this.options.checkForDuplicateTitle(t);try{const i={...e[xe]};i.title=t.newTitle;const a=await this.wrapAttributes(i,!0),s=Object(r.omit)(e,[xe,"title"]);return n({...s,...a}),{id:a.savedObjectId}}catch(e){return i(e),{error:e}}},onClose:()=>{},title:Object(r.get)(t,"saveModalTitle",e[xe].title),showCopyOnSave:!1,objectType:this.type,showDescription:!1}),this.i18nContext)})))),this.type=e,this.showSaveModal=t,this.i18nContext=n,this.toasts=i,this.options=s,o&&!o(this.type))throw new errors_EmbeddableFactoryNotFoundError(this.type)}async defaultUnwrapMethod(e){return Promise.resolve({attributes:{...e}})}async unwrapAttributes(e){return this.inputIsRefType(e)?this.options.unwrapMethod?await this.options.unwrapMethod(e.savedObjectId):await this.defaultUnwrapMethod(e):{attributes:e[xe]}}async wrapAttributes(e,t,n){const i=n||{},a=n&&this.inputIsRefType(n)?n.savedObjectId:void 0;if(!t)return{[xe]:e};try{const t=await this.options.saveMethod(e,a);return"id"in t?{...i,savedObjectId:t.id}:{...i}}catch(e){return this.toasts.addDanger({title:c.i18n.translate("embeddableApi.attributeService.saveToLibraryError",{defaultMessage:"An error occurred while saving. Error: {errorMessage}",values:{errorMessage:e.message}}),"data-test-subj":"attributeServiceSaveFailure"}),Promise.reject({error:e})}}}var Pe=n(13),Oe=n(8);const[Te,Ie]=Object(g.createGetterSetter)("Theme");class plugin_EmbeddablePublicPlugin{constructor(e){a()(this,"embeddableFactoryDefinitions",new Map),a()(this,"embeddableFactories",new Map),a()(this,"enhancements",new Map),a()(this,"customEmbeddableFactoryProvider",void 0),a()(this,"stateTransferService",{}),a()(this,"isRegistryReady",!1),a()(this,"appList",void 0),a()(this,"appListSubscription",void 0),a()(this,"registerEnhancement",(e=>{if(this.enhancements.has(e.id))throw new Error(`enhancement with id ${e.id} already exists in the registry`);this.enhancements.set(e.id,{id:e.id,telemetry:e.telemetry||((e,t)=>t),inject:e.inject||r.identity,extract:e.extract||(e=>({state:e,references:[]})),migrations:e.migrations||{}})})),a()(this,"getEnhancement",(e=>this.enhancements.get(e)||{id:"unknown",telemetry:(e,t)=>t,inject:r.identity,extract:e=>({state:e,references:[]}),migrations:{}})),a()(this,"getEmbeddableFactories",(()=>(this.ensureFactoriesExist(),this.embeddableFactories.values()))),a()(this,"registerEmbeddableFactory",((e,t)=>{if(this.embeddableFactoryDefinitions.has(e))throw new Error(`Embeddable factory [embeddableFactoryId = ${e}] already registered in Embeddables API.`);return this.embeddableFactoryDefinitions.set(e,t),()=>this.getEmbeddableFactory(e)})),a()(this,"getEmbeddableFactory",(e=>{if(!this.isRegistryReady)throw new Error("Embeddable factories can only be retrieved after setup lifecycle.");return this.ensureFactoryExists(e),this.embeddableFactories.get(e)})),a()(this,"ensureFactoriesExist",(()=>{this.embeddableFactoryDefinitions.forEach((e=>this.ensureFactoryExists(e.type)))})),a()(this,"ensureFactoryExists",(e=>{if(!this.embeddableFactories.get(e)){const t=this.embeddableFactoryDefinitions.get(e);if(!t)return;this.embeddableFactories.set(e,this.customEmbeddableFactoryProvider?this.customEmbeddableFactoryProvider(t):T(t))}}))}setup(e,{uiActions:t}){return Ie(e.theme),(e=>{e.registerTrigger(z),e.registerTrigger(U),e.registerTrigger(V),e.registerTrigger(W),e.registerTrigger(K)})(t),{registerEmbeddableFactory:this.registerEmbeddableFactory,registerEnhancement:this.registerEnhancement,setCustomEmbeddableFactoryProvider:e=>{if(this.customEmbeddableFactoryProvider)throw new Error("Custom embeddable factory provider is already set, and can only be set once");this.customEmbeddableFactoryProvider=e}}}start(e,{uiActions:t,inspector:n}){this.embeddableFactoryDefinitions.forEach((e=>{this.embeddableFactories.set(e.type,this.customEmbeddableFactoryProvider?this.customEmbeddableFactoryProvider(e):T(e))})),this.appListSubscription=e.application.applications$.subscribe((e=>{this.appList=e})),this.stateTransferService=new embeddable_state_transfer_EmbeddableStateTransfer(e.application.navigateToApp,e.application.currentAppId$,this.appList),this.isRegistryReady=!0;const i={getEmbeddableFactory:this.getEmbeddableFactory,getEnhancement:this.getEnhancement},a=()=>((e,t,n)=>{const i=new Set;for(const e of Object.keys(Oe.a))i.add(e);for(const t of e){const e=t.migrations,n="function"==typeof e?e():e;Object.keys(n).forEach((e=>i.add(e)))}for(const e of t){const t=e.migrations,n="function"==typeof t?t():t;Object.keys(n).forEach((e=>i.add(e)))}const a={};return i.forEach((e=>{a[e]=t=>({...n(t,e)})})),a})(Array.from(this.embeddableFactories.values()),Array.from(this.enhancements.values()),Object(Pe.c)(i));return{getEmbeddableFactory:this.getEmbeddableFactory,getEmbeddableFactories:this.getEmbeddableFactories,getAttributeService:(t,n)=>new attribute_service_AttributeService(t,d.showSaveModal,e.i18n.Context,e.notifications.toasts,n,this.getEmbeddableFactory),getStateTransfer:t=>t?new embeddable_state_transfer_EmbeddableStateTransfer(e.application.navigateToApp,e.application.currentAppId$,this.appList,t):this.stateTransferService,EmbeddablePanel:(()=>({embeddable:i,hideHeader:a,containerContext:s,index:o})=>Object(P.jsx)(embeddable_panel_EmbeddablePanel,{hideHeader:a,embeddable:i,index:o,stateTransfer:this.stateTransferService,getActions:t.getTriggerCompatibleActions,getEmbeddableFactory:this.getEmbeddableFactory,getAllEmbeddableFactories:this.getEmbeddableFactories,overlays:e.overlays,notifications:e.notifications,application:e.application,inspector:n,SavedObjectFinder:Object(d.getSavedObjectFinder)(e.savedObjects,e.uiSettings),containerContext:s,theme:e.theme}))(),telemetry:Object(Pe.d)(i),extract:Object(Pe.a)(i),inject:Object(Pe.b)(i),getAllMigrations:a,migrateToLatest:e=>Object(l.migrateToLatest)(a(),e)}}stop(){this.appListSubscription&&this.appListSubscription.unsubscribe()}}function we(e){return new plugin_EmbeddablePublicPlugin(e)}}]);