(window.unifiedFieldList_bundle_jsonpfunction=window.unifiedFieldList_bundle_jsonpfunction||[]).push([[2,4],{30:function(e,t,a){"use strict";a.d(t,"a",(function(){return u})),a.d(t,"c",(function(){return c})),a.d(t,"b",(function(){return m}));var s=a(25),i=a.n(s),l=a(10),o=a(24);const n=e=>"_score"!==e.name&&["string","text","keyword","version","ip","number"].includes(e.type);const r=5e3;function u({dataViewPattern:e,timeFieldName:t,fromDate:a,toDate:s,dslQuery:i,runtimeMappings:l,aggs:o,fields:n,size:r}){const u=t?[{range:{[t]:{gte:a,lte:s}}},i]:[i];return 1===(null==n?void 0:n.length)&&u.push({exists:n[0]}),{index:e,body:{query:{bool:{filter:u}},aggs:o,fields:n,runtime_mappings:l,_source:(null==n||!n.length)&&void 0},track_total_hits:!0,size:null!=r?r:0}}async function c({searchHandler:e,dataView:t,field:a,fromDate:s,toDate:u,size:c}){return a.aggregatable?d(a)?"histogram"===a.type?await g(e,a,!1):"number"===a.type?await g(e,a):"date"===a.type?await async function(e,t,a){const s=i.a.parse(a.fromDate),l=i.a.parse(a.toDate);if(!s)throw Error("Invalid fromDate value");if(!l)throw Error("Invalid toDate value");const o=Math.round((l.valueOf()-s.valueOf())/10);if(o<1)return{totalDocuments:0,histogram:{buckets:[]}};const n=`${o}ms`,r={histo:{date_histogram:{...p(t),fixed_interval:n}}},u=await e({aggs:r});return{totalDocuments:b(u),histogram:{buckets:u.aggregations.histo.buckets.map((e=>({count:e.doc_count,key:e.key})))}}}(e,a,{fromDate:s,toDate:u}):await async function(e,t,a=10){const s=p(t),i={sample:{sampler:{shard_size:r},aggs:{sample_count:{value_count:{...s}},top_values:{terms:{...s,size:a,shard_size:a<=10?25:void 0}}}}},l=await e({aggs:i}),o={buckets:l.aggregations.sample.top_values.buckets.map((e=>({count:e.doc_count,key:e.key})))};return{totalDocuments:b(l),sampledDocuments:l.aggregations.sample.doc_count,sampledValues:f(o,l.aggregations.sample.top_values.sum_other_doc_count)||l.aggregations.sample.sample_count.value,topValues:o}}(e,a,c):{}:n(a)?await async function(e,t,a){try{const s={size:100,fields:[p(t)]},i=await e(s),r=function(e){if(e=Object(l.defaults)(e,{count:5}),!n(e.field))throw new Error(`Analysis is not available this field type: "${e.field.type}". Field name: "${e.field.name}"`);const t=(a=e.hits,s=e.field,i=e.dataView,Object(l.map)(a,(function(e){return Object(o.flattenHit)(e,i,{includeIgnoredValues:!0})[s.name]})));var a,s,i;const{groups:r,sampledValues:u}=function(e){const t={};let a=0;return e.forEach((function(e){if(Object(l.isObject)(e)&&!Array.isArray(e))throw new Error("Analysis is not available for object fields.");let s,i=0;const o={};s=Array.isArray(e)?e:null==e?[]:[e],s.forEach((e=>{o[e]||(t.hasOwnProperty(e)?t[e].count++:t[e]={key:e,count:1,order:i++},o[e]=!0,a++)}))})),{groups:t,sampledValues:a}}(t);return{buckets:Object(l.sortBy)(r,["count","order"]).reverse().slice(0,e.count).map((e=>Object(l.pick)(e,["key","count"]))),sampledValues:u,sampledDocuments:e.hits.length}}({hits:i.hits.hits,field:t,dataView:a,count:10});return{totalDocuments:b(i),sampledDocuments:r.sampledDocuments,sampledValues:r.sampledValues,topValues:{buckets:r.buckets}}}catch(e){return console.error(e),{}}}(e,a,t):{}}function d(e){return!("document"===e.type||e.type.includes("range")||"geo_point"===e.type||"geo_shape"===e.type||"murmur3"===e.type||"attachment"===e.type)}function m(e){return e.aggregatable&&d(e)||!e.aggregatable&&n(e)}async function g(e,t,a=!0){const s=p(t),i={min_value:{min:{field:t.name}},max_value:{max:{field:t.name}},sample_count:{value_count:{...s}}},l={sample:{sampler:{shard_size:r},aggs:{...i}}},o={sample:{sampler:{shard_size:r},aggs:{...i,top_values:{terms:{...s,size:10}}}}},n=await e({aggs:a?o:l}),u=n.aggregations.sample.min_value.value,c=n.aggregations.sample.max_value.value,d="top_values"in n.aggregations.sample?n.aggregations.sample.top_values:{buckets:[],sum_other_doc_count:0},m={buckets:d.buckets.map((e=>({count:e.doc_count,key:e.key})))};let g=(c-u)/10;if(Number.isInteger(u)&&Number.isInteger(c)&&(g=Math.ceil(g)),0===g)return{totalDocuments:b(n),sampledValues:f(m,d.sum_other_doc_count)||n.aggregations.sample.sample_count.value,sampledDocuments:n.aggregations.sample.doc_count,topValues:m,histogram:a?{buckets:[]}:{buckets:[{count:n.aggregations.sample.doc_count,key:u}]}};const j={sample:{sampler:{shard_size:r},aggs:{histo:{histogram:{field:t.name,interval:g}}}}},h=await e({aggs:j});return{totalDocuments:b(n),sampledDocuments:n.aggregations.sample.doc_count,sampledValues:f(m,d.sum_other_doc_count)||n.aggregations.sample.sample_count.value,histogram:{buckets:h.aggregations.sample.histo.buckets.map((e=>({count:e.doc_count,key:e.key})))},topValues:m}}function p(e){return e.scripted?{script:{lang:e.lang,source:e.script}}:{field:e.name}}const b=e=>{var t,a;return null!==(t=null!==(a=e.hits.total.value)&&void 0!==a?a:e.hits.total)&&void 0!==t?t:0};function f(e,t){var a;return((null==e||null===(a=e.buckets)||void 0===a?void 0:a.reduce(((e,t)=>t.count+e),0))||0)+(t||0)}},31:function(e,t,a){"use strict";a.r(t);var s=a(4),i=a.n(s),l=(a(0),a(2)),o=a(3),n=a(1),r={name:"5iz1wr",styles:"width:48px"},u={name:"ovk77c",styles:"min-width:0"};t.default=({"data-test-subj":e,onAddFilter:t,overrideFieldTopValueBar:a,...s})=>{var c,d,m,g;const p=a?a(s):{},{field:b,type:f,fieldValue:j,formattedFieldValue:h,formattedPercentage:v,progressValue:x,count:O,color:y,textProps:F={}}={...s,...p},_=null!==(c=null==b||null===(d=b.subType)||void 0===d||null===(m=d.multi)||void 0===m?void 0:m.parent)&&void 0!==c?c:b.name;return Object(n.jsx)(l.EuiFlexGroup,{alignItems:"stretch",gutterSize:"s",responsive:!1,"data-test-subj":`${e}-topValues-bucket`},Object(n.jsx)(l.EuiFlexItem,{grow:1,css:u},Object(n.jsx)(l.EuiFlexGroup,{alignItems:"stretch",gutterSize:"s",responsive:!1},Object(n.jsx)(l.EuiFlexItem,{grow:!0,className:"eui-textTruncate","data-test-subj":`${e}-topValues-formattedFieldValue`},(null!==(g=null==h?void 0:h.length)&&void 0!==g?g:0)>0?Object(n.jsx)(l.EuiToolTip,{content:h,delay:"long"},Object(n.jsx)(l.EuiText,i()({size:"xs",className:"eui-textTruncate",color:"subdued"},F),h)):Object(n.jsx)(l.EuiText,{size:"xs"},"other"===f?o.i18n.translate("unifiedFieldList.fieldStats.otherDocsLabel",{defaultMessage:"Other"}):""===h?o.i18n.translate("unifiedFieldList.fieldStats.emptyStringValueLabel",{defaultMessage:"(empty)"}):"-")),Object(n.jsx)(l.EuiFlexItem,{grow:!1,"data-test-subj":`${e}-topValues-formattedPercentage`},Object(n.jsx)(l.EuiToolTip,{content:o.i18n.translate("unifiedFieldList.fieldStats.bucketPercentageTooltip",{defaultMessage:"{formattedPercentage} ({count, plural, one {# record} other {# records}})",values:{formattedPercentage:v,count:O}}),delay:"long"},Object(n.jsx)(l.EuiText,{size:"xs",textAlign:"left",color:y},v)))),Object(n.jsx)(l.EuiProgress,{value:x,max:1,size:"s",color:"other"===f?"subdued":y,"aria-label":`${h} (${v})`})),t&&b.filterable&&Object(n.jsx)(l.EuiFlexItem,{grow:!1},"other"===f?Object(n.jsx)("div",{css:r}):Object(n.jsx)("div",null,Object(n.jsx)(l.EuiButtonIcon,{iconSize:"s",iconType:"plusInCircle",onClick:()=>t(b,j,"+"),"aria-label":o.i18n.translate("unifiedFieldList.fieldStats.filterValueButtonAriaLabel",{defaultMessage:'Filter for {field}: "{value}"',values:{value:h,field:_}}),"data-test-subj":`plus-${_}-${j}`,style:{minHeight:"auto",minWidth:"auto",paddingRight:2,paddingLeft:2,paddingTop:0,paddingBottom:0}}),Object(n.jsx)(l.EuiButtonIcon,{iconSize:"s",iconType:"minusInCircle",onClick:()=>t(b,j,"-"),"aria-label":o.i18n.translate("unifiedFieldList.fieldStats.filterOutValueButtonAriaLabel",{defaultMessage:'Filter out {field}: "{value}"',values:{value:h,field:_}}),"data-test-subj":`minus-${_}-${j}`,style:{minHeight:"auto",minWidth:"auto",paddingTop:0,paddingBottom:0,paddingRight:2,paddingLeft:2}}))))}},43:function(e,t,a){"use strict";a.r(t);var s=a(0),i=a.n(s),l=a(24),o=a(25),n=a.n(o),r=a(2),u=a(13),c=a(27),d=a(3),m=a(28),g=a(30),p=a(11),b=a(31),f=a(1);const j=({buckets:e,dataView:t,field:a,sampledValuesCount:l,color:o=h(),"data-test-subj":n,onAddFilter:u,overrideFieldTopValueBar:c})=>{if(null==e||!e.length)return null;const d=t.getFormatterForField(a),m=y(O(e),l),g=e.some((e=>!Number.isInteger(e.count/l)));return Object(f.jsx)("div",{"data-test-subj":`${n}-topValues`},e.map(((e,t)=>{const i=e.key,m=d.convert(i);return Object(f.jsx)(s.Fragment,{key:i},t>0&&Object(f.jsx)(r.EuiSpacer,{size:"s"}),Object(f.jsx)(b.default,{field:a,fieldValue:i,formattedFieldValue:m,formattedPercentage:v(e.count,l,g),progressValue:x(e.count,l),count:e.count,color:o,"data-test-subj":n,onAddFilter:u,overrideFieldTopValueBar:c}))})),m>0&&Object(f.jsx)(i.a.Fragment,null,Object(f.jsx)(r.EuiSpacer,{size:"s"}),Object(f.jsx)(b.default,{type:"other",field:a,fieldValue:void 0,formattedPercentage:v(m,l,g),progressValue:x(m,l),count:m,color:o,"data-test-subj":n,onAddFilter:u,overrideFieldTopValueBar:c})))},h=()=>Object(r.euiPaletteColorBlind)()[1],v=(e,t,a)=>t>0?`${(Math.round(e/t*1e3)/10).toFixed(a?1:0)}%`:"",x=(e,t)=>t>0?e/t:0,O=e=>(null==e?void 0:e.reduce(((e,t)=>t.count+e),0))||0,y=(e,t)=>t&&e?t-e:0,F=({message:e})=>Object(f.jsx)(r.EuiText,{size:"s"},e),_=({services:e,query:t,dslQuery:a,filters:o,fromDate:b,toDate:v,dataViewOrDataViewId:x,field:_,color:D=h(),"data-test-subj":E="fieldStats",overrideMissingContent:S,overrideFooter:k,onAddFilter:T,overrideFieldTopValueBar:V,onStateChange:L})=>{const{fieldFormats:w,uiSettings:z,charts:I,dataViews:B,data:M}=e,[A,C]=Object(s.useState)({isLoading:!1}),[P,$]=Object(s.useState)(null),N=Object(s.useRef)(null),R=Object(s.useRef)(!1),G=Object(s.useCallback)((e=>{R.current||C(e)}),[C,R]);Object(s.useEffect)((function(){L&&L(A)}),[L,A]);const H=Object(s.useCallback)((e=>{R.current||$(e)}),[$,R]);Object(s.useEffect)((()=>(async function(){if(!R.current)try{var e;const s="string"==typeof x?await B.get(x):x;if(H(s),A.isLoading)return;G((e=>({...e,isLoading:!0}))),null===(e=N.current)||void 0===e||e.abort(),N.current=new AbortController;const i=await Object(p.a)({services:{data:M},dataView:s,field:_,fromDate:b,toDate:v,dslQuery:null!=a?a:Object(m.buildEsQuery)(s,null!=t?t:[],null!=o?o:[],Object(l.getEsQueryConfig)(z)),abortController:N.current});N.current=null,G((e=>({...e,isLoading:!1,totalDocuments:i.totalDocuments,sampledDocuments:i.sampledDocuments,sampledValues:i.sampledValues,histogram:i.histogram,topValues:i.topValues})))}catch(e){G((e=>({...e,isLoading:!1})))}}(),()=>{var e;R.current=!0,null===(e=N.current)||void 0===e||e.abort()})),[]);const Y=I.theme.useChartsTheme(),Q=I.theme.useChartsBaseTheme(),K=Object(s.useMemo)((()=>{var e;return D?{...Y,barSeriesStyle:{...Y.barSeriesStyle,rect:{...(null===(e=Y.barSeriesStyle)||void 0===e?void 0:e.rect)||{},fill:D}}}:Y}),[Y,D]),{isLoading:U,histogram:W,topValues:q,sampledValues:Z,sampledDocuments:J,totalDocuments:X}=A;let ee=!!A.histogram;const te=n.a.parse(b),ae=n.a.parse(v),se=O(null==q?void 0:q.buckets),ie=y(se,Z);se&&W&&W.buckets.length&&q&&q.buckets.length&&(ee=ie/se>.9);const[le,oe]=Object(s.useState)(ee);if(U)return Object(f.jsx)(r.EuiLoadingSpinner,null);if(!P)return null;const ne=P.getFormatterForField(_);let re=Object(f.jsx)(i.a.Fragment,null);function ue(e){const t=X?Object(f.jsx)(r.EuiText,{color:"subdued",size:"xs","data-test-subj":`${E}-statsFooter`},J&&J<X?Object(f.jsx)(u.FormattedMessage,{id:"unifiedFieldList.fieldStats.calculatedFromSampleRecordsLabel",defaultMessage:"Calculated from {sampledDocumentsFormatted} sample {sampledDocuments, plural, one {record} other {records}}.",values:{sampledDocuments:J,sampledDocumentsFormatted:Object(f.jsx)("strong",null,w.getDefaultInstance(l.KBN_FIELD_TYPES.NUMBER,[l.ES_FIELD_TYPES.INTEGER]).convert(J))}}):Object(f.jsx)(u.FormattedMessage,{id:"unifiedFieldList.fieldStats.calculatedFromTotalRecordsLabel",defaultMessage:"Calculated from {totalDocumentsFormatted} {totalDocuments, plural, one {record} other {records}}.",values:{totalDocuments:X,totalDocumentsFormatted:Object(f.jsx)("strong",null,w.getDefaultInstance(l.KBN_FIELD_TYPES.NUMBER,[l.ES_FIELD_TYPES.INTEGER]).convert(X))}})):Object(f.jsx)(i.a.Fragment,null);return Object(f.jsx)(i.a.Fragment,null,re?Object(f.jsx)("div",{"data-test-subj":`${E}-title`},re):Object(f.jsx)(i.a.Fragment,null),Object(f.jsx)(r.EuiSpacer,{size:"s"}),e,k?null==k?void 0:k({element:t,totalDocuments:X,sampledDocuments:J}):Object(f.jsx)(i.a.Fragment,null,Object(f.jsx)(r.EuiSpacer,{size:"m"}),t))}if(!Object(g.b)(_)){const e=Object(f.jsx)(F,{message:d.i18n.translate("unifiedFieldList.fieldStats.notAvailableForThisFieldDescription",{defaultMessage:"Analysis is not available for this field."})});return S?S({reason:"unsupported",element:e}):e}if(!(W&&0!==W.buckets.length||q&&0!==q.buckets.length)){const e=J&&X&&J<X?Object(f.jsx)(F,{message:d.i18n.translate("unifiedFieldList.fieldStats.noFieldDataInSampleDescription",{defaultMessage:"No field data for {sampledDocumentsFormatted} sample {sampledDocuments, plural, one {record} other {records}}.",values:{sampledDocuments:J,sampledDocumentsFormatted:w.getDefaultInstance(l.KBN_FIELD_TYPES.NUMBER,[l.ES_FIELD_TYPES.INTEGER]).convert(J)}})}):Object(f.jsx)(F,{message:d.i18n.translate("unifiedFieldList.fieldStats.noFieldDataDescription",{defaultMessage:"No field data for the current search."})});return S?S({reason:"no-data",element:e}):e}if(W&&W.buckets.length&&q&&q.buckets.length?re=Object(f.jsx)(r.EuiButtonGroup,{buttonSize:"compressed",isFullWidth:!0,legend:d.i18n.translate("unifiedFieldList.fieldStats.displayToggleLegend",{defaultMessage:"Toggle either the"}),options:[{label:d.i18n.translate("unifiedFieldList.fieldStats.topValuesLabel",{defaultMessage:"Top values"}),id:"topValues","data-test-subj":`${E}-buttonGroup-topValuesButton`},{label:d.i18n.translate("unifiedFieldList.fieldStats.fieldDistributionLabel",{defaultMessage:"Distribution"}),id:"histogram","data-test-subj":`${E}-buttonGroup-distributionButton`}],onChange:e=>{oe("histogram"===e)},idSelected:le?"histogram":"topValues"}):"date"===_.type?re=Object(f.jsx)(r.EuiTitle,{size:"xxxs"},Object(f.jsx)("h6",null,d.i18n.translate("unifiedFieldList.fieldStats.fieldTimeDistributionLabel",{defaultMessage:"Time distribution"}))):q&&q.buckets.length&&(re=Object(f.jsx)(r.EuiTitle,{size:"xxxs"},Object(f.jsx)("h6",null,_.aggregatable?d.i18n.translate("unifiedFieldList.fieldStats.topValuesLabel",{defaultMessage:"Top values"}):d.i18n.translate("unifiedFieldList.fieldStats.examplesLabel",{defaultMessage:"Examples"})))),W&&W.buckets.length){const e=d.i18n.translate("unifiedFieldList.fieldStats.countLabel",{defaultMessage:"Count"});if("date"===_.type)return ue(Object(f.jsx)("div",{"data-test-subj":`${E}-histogram`},Object(f.jsx)(c.Chart,{size:{height:200,width:268}},Object(f.jsx)(c.Settings,{tooltip:{type:c.TooltipType.None},theme:K,baseTheme:Q,xDomain:te&&ae?{min:te.valueOf(),max:ae.valueOf(),minInterval:Math.round((ae.valueOf()-te.valueOf())/10)}:void 0}),Object(f.jsx)(c.Axis,{id:"key",position:c.Position.Bottom,tickFormat:te&&ae?Object(c.niceTimeFormatter)([te.valueOf(),ae.valueOf()]):void 0,showOverlappingTicks:!0}),Object(f.jsx)(c.HistogramBarSeries,{data:W.buckets,id:e,xAccessor:"key",yAccessors:["count"],xScaleType:c.ScaleType.Time,yScaleType:c.ScaleType.Linear,timeZone:"local"}))));if(le||!q||!q.buckets.length)return ue(Object(f.jsx)(c.Chart,{"data-test-subj":`${E}-histogram`,size:{height:200,width:"100%"}},Object(f.jsx)(c.Settings,{rotation:90,tooltip:{type:c.TooltipType.None},theme:K,baseTheme:Q}),Object(f.jsx)(c.Axis,{id:"key",position:c.Position.Left,showOverlappingTicks:!0,tickFormat:e=>ne.convert(e)}),Object(f.jsx)(c.HistogramBarSeries,{data:W.buckets,id:e,xAccessor:"key",yAccessors:["count"],xScaleType:c.ScaleType.Linear,yScaleType:c.ScaleType.Linear})))}return q&&q.buckets.length?ue(Object(f.jsx)(j,{buckets:q.buckets,dataView:P,field:_,sampledValuesCount:Z,color:D,"data-test-subj":E,onAddFilter:T,overrideFieldTopValueBar:V})):null};class field_stats_ErrorBoundary extends i.a.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}render(){return this.state.hasError?null:this.props.children}}t.default=e=>Object(f.jsx)(field_stats_ErrorBoundary,null,Object(f.jsx)(_,e))}}]);