(window.unifiedFieldList_bundle_jsonpfunction=window.unifiedFieldList_bundle_jsonpfunction||[]).push([[3],{29:function(e,t,a){"use strict";a.r(t),a.d(t,"loadFieldStats",(function(){return o}));var s=a(12),n=a(30);const o=async({services:e,dataView:t,field:a,fromDate:o,toDate:r,dslQuery:i,size:u,abortController:l})=>{const{data:c}=e;try{if(null==t||!t.id||null==a||!a.type)return{};const e=async e=>(await Object(s.lastValueFrom)(c.search.search({params:Object(n.a)({dataViewPattern:t.title,timeFieldName:t.timeFieldName,fromDate:o,toDate:r,dslQuery:i,runtimeMappings:t.getRuntimeMappings(),...e})},{abortSignal:null==l?void 0:l.signal}))).rawResponse;return await Object(n.c)({searchHandler:e,dataView:t,field:a,fromDate:o,toDate:r,size:u})}catch(e){throw new Error("Could not provide field stats",{cause:e})}}},30:function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),a.d(t,"c",(function(){return c})),a.d(t,"b",(function(){return d}));var s=a(25),n=a.n(s),o=a(10),r=a(24);const i=e=>"_score"!==e.name&&["string","text","keyword","version","ip","number"].includes(e.type);const u=5e3;function l({dataViewPattern:e,timeFieldName:t,fromDate:a,toDate:s,dslQuery:n,runtimeMappings:o,aggs:r,fields:i,size:u}){const l=t?[{range:{[t]:{gte:a,lte:s}}},n]:[n];return 1===(null==i?void 0:i.length)&&l.push({exists:i[0]}),{index:e,body:{query:{bool:{filter:l}},aggs:r,fields:i,runtime_mappings:o,_source:(null==i||!i.length)&&void 0},track_total_hits:!0,size:null!=u?u:0}}async function c({searchHandler:e,dataView:t,field:a,fromDate:s,toDate:l,size:c}){return a.aggregatable?m(a)?"histogram"===a.type?await g(e,a,!1):"number"===a.type?await g(e,a):"date"===a.type?await async function(e,t,a){const s=n.a.parse(a.fromDate),o=n.a.parse(a.toDate);if(!s)throw Error("Invalid fromDate value");if(!o)throw Error("Invalid toDate value");const r=Math.round((o.valueOf()-s.valueOf())/10);if(r<1)return{totalDocuments:0,histogram:{buckets:[]}};const i=`${r}ms`,u={histo:{date_histogram:{...p(t),fixed_interval:i}}},l=await e({aggs:u});return{totalDocuments:f(l),histogram:{buckets:l.aggregations.histo.buckets.map((e=>({count:e.doc_count,key:e.key})))}}}(e,a,{fromDate:s,toDate:l}):await async function(e,t,a=10){const s=p(t),n={sample:{sampler:{shard_size:u},aggs:{sample_count:{value_count:{...s}},top_values:{terms:{...s,size:a,shard_size:a<=10?25:void 0}}}}},o=await e({aggs:n}),r={buckets:o.aggregations.sample.top_values.buckets.map((e=>({count:e.doc_count,key:e.key})))};return{totalDocuments:f(o),sampledDocuments:o.aggregations.sample.doc_count,sampledValues:_(r,o.aggregations.sample.top_values.sum_other_doc_count)||o.aggregations.sample.sample_count.value,topValues:r}}(e,a,c):{}:i(a)?await async function(e,t,a){try{const s={size:100,fields:[p(t)]},n=await e(s),u=function(e){if(e=Object(o.defaults)(e,{count:5}),!i(e.field))throw new Error(`Analysis is not available this field type: "${e.field.type}". Field name: "${e.field.name}"`);const t=(a=e.hits,s=e.field,n=e.dataView,Object(o.map)(a,(function(e){return Object(r.flattenHit)(e,n,{includeIgnoredValues:!0})[s.name]})));var a,s,n;const{groups:u,sampledValues:l}=function(e){const t={};let a=0;return e.forEach((function(e){if(Object(o.isObject)(e)&&!Array.isArray(e))throw new Error("Analysis is not available for object fields.");let s,n=0;const r={};s=Array.isArray(e)?e:null==e?[]:[e],s.forEach((e=>{r[e]||(t.hasOwnProperty(e)?t[e].count++:t[e]={key:e,count:1,order:n++},r[e]=!0,a++)}))})),{groups:t,sampledValues:a}}(t);return{buckets:Object(o.sortBy)(u,["count","order"]).reverse().slice(0,e.count).map((e=>Object(o.pick)(e,["key","count"]))),sampledValues:l,sampledDocuments:e.hits.length}}({hits:n.hits.hits,field:t,dataView:a,count:10});return{totalDocuments:f(n),sampledDocuments:u.sampledDocuments,sampledValues:u.sampledValues,topValues:{buckets:u.buckets}}}catch(e){return console.error(e),{}}}(e,a,t):{}}function m(e){return!("document"===e.type||e.type.includes("range")||"geo_point"===e.type||"geo_shape"===e.type||"murmur3"===e.type||"attachment"===e.type)}function d(e){return e.aggregatable&&m(e)||!e.aggregatable&&i(e)}async function g(e,t,a=!0){const s=p(t),n={min_value:{min:{field:t.name}},max_value:{max:{field:t.name}},sample_count:{value_count:{...s}}},o={sample:{sampler:{shard_size:u},aggs:{...n}}},r={sample:{sampler:{shard_size:u},aggs:{...n,top_values:{terms:{...s,size:10}}}}},i=await e({aggs:a?r:o}),l=i.aggregations.sample.min_value.value,c=i.aggregations.sample.max_value.value,m="top_values"in i.aggregations.sample?i.aggregations.sample.top_values:{buckets:[],sum_other_doc_count:0},d={buckets:m.buckets.map((e=>({count:e.doc_count,key:e.key})))};let g=(c-l)/10;if(Number.isInteger(l)&&Number.isInteger(c)&&(g=Math.ceil(g)),0===g)return{totalDocuments:f(i),sampledValues:_(d,m.sum_other_doc_count)||i.aggregations.sample.sample_count.value,sampledDocuments:i.aggregations.sample.doc_count,topValues:d,histogram:a?{buckets:[]}:{buckets:[{count:i.aggregations.sample.doc_count,key:l}]}};const h={sample:{sampler:{shard_size:u},aggs:{histo:{histogram:{field:t.name,interval:g}}}}},y=await e({aggs:h});return{totalDocuments:f(i),sampledDocuments:i.aggregations.sample.doc_count,sampledValues:_(d,m.sum_other_doc_count)||i.aggregations.sample.sample_count.value,histogram:{buckets:y.aggregations.sample.histo.buckets.map((e=>({count:e.doc_count,key:e.key})))},topValues:d}}function p(e){return e.scripted?{script:{lang:e.lang,source:e.script}}:{field:e.name}}const f=e=>{var t,a;return null!==(t=null!==(a=e.hits.total.value)&&void 0!==a?a:e.hits.total)&&void 0!==t?t:0};function _(e,t){var a;return((null==e||null===(a=e.buckets)||void 0===a?void 0:a.reduce(((e,t)=>t.count+e),0))||0)+(t||0)}}}]);