!function(e){function t(t){for(var i,a,s=t[0],r=t[1],o=0,l=[];o<s.length;o++)a=s[o],Object.prototype.hasOwnProperty.call(n,a)&&n[a]&&l.push(n[a][0]),n[a]=0;for(i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i]);for(u&&u(t);l.length;)l.shift()()}var i={},n={0:0};function a(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.e=function(e){var t=[],i=n[e];if(0!==i)if(i)t.push(i[2]);else{var s=new Promise((function(t,a){i=n[e]=[t,a]}));t.push(i[2]=s);var r,o=document.createElement("script");o.charset="utf-8",o.timeout=120,a.nc&&o.setAttribute("nonce",a.nc),o.src=function(e){return a.p+"unifiedHistogram.chunk."+e+".js"}(e);var u=new Error;r=function(t){o.onerror=o.onload=null,clearTimeout(l);var i=n[e];if(0!==i){if(i){var a=t&&("load"===t.type?"missing":t.type),s=t&&t.target&&t.target.src;u.message="Loading chunk "+e+" failed.\n("+a+": "+s+")",u.name="ChunkLoadError",u.type=a,u.request=s,i[1](u)}n[e]=void 0}};var l=setTimeout((function(){r({type:"timeout",target:o})}),12e4);o.onerror=o.onload=r,document.head.appendChild(o)}return Promise.all(t)},a.m=e,a.c=i,a.d=function(e,t,i){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(i,n,function(t){return e[t]}.bind(null,n));return i},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a.oe=function(e){throw console.error(e),e};var s=window.unifiedHistogram_bundle_jsonpfunction=window.unifiedHistogram_bundle_jsonpfunction||[],r=s.push.bind(s);s.push=t,s=s.slice();for(var o=0;o<s.length;o++)t(s[o]);var u=r;a(a.s=15)}([function(e,t){e.exports=__kbnSharedDeps__.EmotionReact},function(e,t){e.exports=__kbnSharedDeps__.ElasticEui},function(e,t){e.exports=__kbnSharedDeps__.React},function(e,t){e.exports=__kbnSharedDeps__.KbnI18n},function(e,t){e.exports=__kbnSharedDeps__.ElasticCharts},function(e,t,i){i.r(t);var n=__kbnBundles__.get("plugin/data/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(n))},function(e,t){e.exports=__kbnSharedDeps__.KbnI18nReact},function(e,t){e.exports=__kbnSharedDeps__.KbnDatemath},function(e,t){e.exports=__kbnSharedDeps__.Moment},function(e,t,i){i.r(t);var n=__kbnBundles__.get("plugin/charts/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(n))},function(e,t){e.exports=__kbnSharedDeps__.MomentTimezone},function(e,t,i){"use strict";i.d(t,"a",(function(){return C})),i.d(t,"c",(function(){return I})),i.d(t,"b",(function(){return S}));var n=i(2),a=i.n(n),s=i(8),r=i.n(s),o=i(1),u=i(3),l=i(0),c=i(6),d={name:"y6n6nb",styles:"flex-grow:0"};function m({hits:e,append:t}){var i;if(!e.total&&"loading"===e.status)return null;const n=Object(l.jsx)("strong",{"data-test-subj":"partial"===e.status?"unifiedHistogramQueryHitsPartial":"unifiedHistogramQueryHits"},Object(l.jsx)(c.FormattedNumber,{value:null!==(i=e.total)&&void 0!==i?i:0})),a=d;return Object(l.jsx)(o.EuiFlexGroup,{gutterSize:"s",responsive:!1,justifyContent:"center",alignItems:"center",css:a},Object(l.jsx)(o.EuiFlexItem,{grow:!1,"aria-live":"polite"},Object(l.jsx)(o.EuiText,null,"partial"===e.status&&Object(l.jsx)(c.FormattedMessage,{id:"unifiedHistogram.partialHits",defaultMessage:"â‰¥{formattedHits} {hits, plural, one {hit} other {hits}}",values:{hits:e.total,formattedHits:n}}),"partial"!==e.status&&Object(l.jsx)(c.FormattedMessage,{id:"unifiedHistogram.hitsPluralTitle",defaultMessage:"{formattedHits} {hits, plural, one {hit} other {hits}}",values:{hits:e.total,formattedHits:n}}))),"partial"===e.status&&Object(l.jsx)(o.EuiFlexItem,{grow:!1},Object(l.jsx)(o.EuiLoadingSpinner,{size:"m","aria-label":u.i18n.translate("unifiedHistogram.hitCountSpinnerAriaLabel",{defaultMessage:"Final hit count still loading"})})),t)}var g=i(10),f=i.n(g),p=i(7),b=i.n(p),j=i(4),x=i(9),h=i(12),v={name:"y6n6nb",styles:"flex-grow:0"},O={name:"1xqbz8u",styles:"display:flex;flex-direction:column;justify-content:center;flex:1 0 100%;text-align:center;height:100%;width:100%"};function _({services:{data:e,theme:t,uiSettings:i,fieldFormats:s},chart:{status:r,timeInterval:d,bucketInterval:m,data:g,error:p},timefilterUpdateHandler:_}){var y;const E=t.useChartsTheme(),H=t.useChartsBaseTheme(),C=function(e){return e.isDefault("dateFormat:tz")?f.a.tz.guess()||f()().format("Z"):e.get("dateFormat:tz","Browser")}(i),I=Object(n.useCallback)((({x:e})=>{if(!e)return;const[t,i]=e;_({from:t,to:i})}),[_]),k=Object(n.useCallback)((e=>([t])=>{const i=t[0].x;_({from:i,to:i+e})}),[_]),{timefilter:S}=e.query.timefilter,{from:T,to:z}=S.getAbsoluteTime(),F=Object(n.useMemo)((()=>i.get("dateFormat")),[i]),w=Object(n.useCallback)((e=>e?F?e.format(F):String(e):""),[F]),M=Object(n.useMemo)((()=>{const e={from:b.a.parse(T),to:b.a.parse(z,{roundUp:!0})},t=u.i18n.translate("unifiedHistogram.histogramTimeRangeIntervalDescription",{defaultMessage:"(interval: {value})",values:{value:`${"auto"===d?`${u.i18n.translate("unifiedHistogram.histogramTimeRangeIntervalAuto",{defaultMessage:"Auto"})} - `:""}${null==m?void 0:m.description}`}});return`${w(e.from)} - ${w(e.to)} ${t}`}),[T,z,d,null==m?void 0:m.description,w]),{euiTheme:A}=Object(o.useEuiTheme)(),D=Object(l.css)("flex-grow:1;padding:0 ",A.size.s," ",A.size.s," ",A.size.s,";","");if(!g&&"loading"===r){const e=O;return Object(l.jsx)("div",{"data-test-subj":"unifiedHistogramChart",css:D},Object(l.jsx)("div",{css:e,"data-test-subj":"unifiedHistogramChartLoading"},Object(l.jsx)(o.EuiText,{size:"xs",color:"subdued"},Object(l.jsx)(o.EuiLoadingChart,{mono:!0,size:"l"}),Object(l.jsx)(o.EuiSpacer,{size:"s"}),Object(l.jsx)(c.FormattedMessage,{id:"unifiedHistogram.loadingChartResults",defaultMessage:"Loading chart"}))))}if("error"===r&&p){const e=Object(l.css)("padding:0 ",A.size.s," 0 ",A.size.s,";",""),t=Object(l.css)("padding-top:0.5 * ",A.size.xs,";",""),i=Object(l.css)("margin-left:",A.size.xs,"!important;",""),n=Object(l.css)("margin-top:",A.size.s,";","");return Object(l.jsx)("div",{css:e,"data-test-subj":"unifiedHistogramErrorChartContainer"},Object(l.jsx)(o.EuiFlexGroup,{gutterSize:"s"},Object(l.jsx)(o.EuiFlexItem,{grow:!1,css:t},Object(l.jsx)(o.EuiIcon,{type:"visBarVertical",color:"danger",size:"m"})),Object(l.jsx)(o.EuiFlexItem,{css:i},Object(l.jsx)(o.EuiText,{size:"s",color:"danger"},Object(l.jsx)(c.FormattedMessage,{id:"unifiedHistogram.errorLoadingChart",defaultMessage:"Error loading chart"})))),Object(l.jsx)(o.EuiText,{size:"s",css:n,"data-test-subj":"unifiedHistogramErrorChartText"},p.message))}if(!g)return null;const P=e=>{const t=g.xAxisFormat.params.pattern;return f()(e).format(t)},B=i.get("theme:darkMode"),{intervalESValue:L,intervalESUnit:R,interval:V}=g.ordered,U=V.asMilliseconds(),N=g.xAxisOrderedValues,q=N[N.length-1],G=g.ordered,$=G.min.valueOf(),W=G.max.valueOf(),K={min:Math.min(null===(y=g.values[0])||void 0===y?void 0:y.x,$),max:Math.max(W-U,q),minInterval:Object(x.getAdjustedInterval)(N,L,R,C)},Y={headerFormatter:Object(x.renderEndzoneTooltip)(U,$,W,P),type:j.TooltipType.VerticalCursor},Q=s.deserialize(g.yAxisFormat),X=i.get(h.LEGACY_TIME_AXIS,!1),Z=u.i18n.translate("unifiedHistogram.timeIntervalWithValueWarning",{defaultMessage:"Warning"}),J=u.i18n.translate("unifiedHistogram.bucketIntervalTooltip",{defaultMessage:"This interval creates {bucketsDescription} to show in the selected time range, so it has been scaled to {bucketIntervalDescription}.",values:{bucketsDescription:m.scale&&m.scale>1?u.i18n.translate("unifiedHistogram.bucketIntervalTooltip.tooLargeBucketsText",{defaultMessage:"buckets that are too large"}):u.i18n.translate("unifiedHistogram.bucketIntervalTooltip.tooManyBucketsText",{defaultMessage:"too many buckets"}),bucketIntervalDescription:null==m?void 0:m.description}}),ee=Object(l.css)("padding:0 ",A.size.s," 0 ",A.size.s,";","");let te=Object(l.jsx)(o.EuiText,{size:"xs",textAlign:"center",css:ee},M);if(null!=m&&m.scaled){const e=v;te=Object(l.jsx)(o.EuiFlexGroup,{alignItems:"baseline",justifyContent:"center",gutterSize:"none",responsive:!1,css:e},Object(l.jsx)(o.EuiFlexItem,{grow:!1},te),Object(l.jsx)(o.EuiFlexItem,{grow:!1},Object(l.jsx)(o.EuiIconTip,{type:"alert",color:"warning",title:Z,content:J})))}return Object(l.jsx)(a.a.Fragment,null,Object(l.jsx)("div",{"data-test-subj":"unifiedHistogramChart","data-time-range":M,css:D},Object(l.jsx)(j.Chart,{size:"100%"},Object(l.jsx)(j.Settings,{xDomain:K,onBrushEnd:I,onElementClick:k(U),tooltip:Y,theme:E,baseTheme:H,allowBrushingLastHistogramBin:!0}),Object(l.jsx)(j.Axis,{id:"unifiedHistogramLeftAxis",position:j.Position.Left,ticks:2,integersOnly:!0,tickFormat:e=>Q.convert(e)}),Object(l.jsx)(j.Axis,{id:"unifiedHistogramBottomAxis",position:j.Position.Bottom,tickFormat:P,timeAxisLayerCount:X?0:2,style:X?{}:h.MULTILAYER_TIME_AXIS_STYLE}),Object(l.jsx)(x.CurrentTime,{isDarkMode:B,domainEnd:W}),Object(l.jsx)(x.Endzones,{isDarkMode:B,domainStart:$,domainEnd:W,interval:K.minInterval,domainMin:K.min,domainMax:K.max}),Object(l.jsx)(j.HistogramBarSeries,{id:"unifiedHistogramBarSeries",minBarHeight:2,xScaleType:j.ScaleType.Time,yScaleType:j.ScaleType.Linear,xAccessor:"x",yAccessors:["y"],data:g.values,yNice:!0,timeZone:C,name:g.yAxisLabel}))),te)}var y=i(5);const E=Object(n.memo)(_);var H={name:"x4odxv",styles:"flex-grow:1;display:flex;flex-direction:column;position:relative;.series>rect{fill-opacity:0.5;stroke-width:1;}"};function C({className:e,services:t,hits:i,chart:a,appendHitsCounter:s,appendHistogram:c,onEditVisualization:d,onResetChartHeight:g,onChartHiddenChange:f,onTimeIntervalChange:p}){const{data:b}=t,[j,x]=Object(n.useState)(!1),h=Object(n.useRef)({element:null,moveFocus:!1}),v=Object(n.useCallback)((()=>{x(!j)}),[j]),O=Object(n.useCallback)((()=>{x(!1)}),[x]);Object(n.useEffect)((()=>{h.current.moveFocus&&h.current.element&&h.current.element.focus()}),[null==a?void 0:a.hidden]);const _=Object(n.useCallback)((()=>{const e=!(null!=a&&a.hidden);h.current.moveFocus=!e,null==f||f(e)}),[null==a?void 0:a.hidden,f]),C=Object(n.useCallback)((e=>{b.query.timefilter.timefilter.setTime({from:r()(e.from).toISOString(),to:r()(e.to).toISOString(),mode:"absolute"})}),[b]),I=function({chart:e,toggleHideChart:t,onTimeIntervalChange:i,closePopover:n,onResetChartHeight:a}){if(!e)return[];const s=y.search.aggs.intervalOptions.findIndex((t=>t.val===e.timeInterval)),r=s>-1?y.search.aggs.intervalOptions[s].display:y.search.aggs.intervalOptions[0].display,o=[{name:e.hidden?u.i18n.translate("unifiedHistogram.showChart",{defaultMessage:"Show chart"}):u.i18n.translate("unifiedHistogram.hideChart",{defaultMessage:"Hide chart"}),icon:e.hidden?"eye":"eyeClosed",onClick:()=>{t(),n()},"data-test-subj":"unifiedHistogramChartToggle"}];e.hidden||(a&&o.push({name:u.i18n.translate("unifiedHistogram.resetChartHeight",{defaultMessage:"Reset to default height"}),icon:"refresh",onClick:()=>{a(),n()},"data-test-subj":"unifiedHistogramChartResetHeight"}),o.push({name:u.i18n.translate("unifiedHistogram.timeIntervalWithValue",{defaultMessage:"Time interval: {timeInterval}",values:{timeInterval:r}}),panel:1,"data-test-subj":"unifiedHistogramTimeIntervalPanel"}));const l=[{id:0,title:u.i18n.translate("unifiedHistogram.chartOptions",{defaultMessage:"Chart options"}),items:o}];return e.hidden||l.push({id:1,initialFocusedItemIndex:s>-1?s:0,title:u.i18n.translate("unifiedHistogram.timeIntervals",{defaultMessage:"Time intervals"}),items:y.search.aggs.intervalOptions.filter((({val:e})=>"custom"!==e)).map((({display:t,val:a})=>({name:t,label:t,icon:a===e.timeInterval?"check":"empty",onClick:()=>{i(a),n()},"data-test-subj":`unifiedHistogramTimeInterval-${t}`,className:a===e.timeInterval?"unifiedHistogramIntervalSelected":""})))}),l}({chart:a,toggleHideChart:_,onTimeIntervalChange:e=>null==p?void 0:p(e),closePopover:()=>x(!1),onResetChartHeight:g}),{euiTheme:k}=Object(o.useEuiTheme)(),S=Object(l.css)("padding:",k.size.s,";min-height:",3*k.base,"px;",""),T=Object(l.css)(Object(o.useEuiBreakpoint)(["xs","s"]),"{margin-bottom:0!important;}",""),z=Object(l.css)(Object(o.useEuiBreakpoint)(["xs","s"]),"{align-items:flex-end;}",""),F=H;return Object(l.jsx)(o.EuiFlexGroup,{className:e,direction:"column",alignItems:"stretch",gutterSize:"none",responsive:!1},Object(l.jsx)(o.EuiFlexItem,{grow:!1,css:S},Object(l.jsx)(o.EuiFlexGroup,{justifyContent:"spaceBetween",gutterSize:"none",responsive:!1},Object(l.jsx)(o.EuiFlexItem,{grow:!1,className:"eui-textTruncate eui-textNoWrap",css:T},i&&Object(l.jsx)(m,{hits:i,append:s})),a&&Object(l.jsx)(o.EuiFlexItem,{grow:!1,css:z},Object(l.jsx)(o.EuiFlexGroup,{direction:"row",gutterSize:"s",responsive:!1},d&&Object(l.jsx)(o.EuiFlexItem,{grow:!1},Object(l.jsx)(o.EuiToolTip,{content:u.i18n.translate("unifiedHistogram.editVisualizationButton",{defaultMessage:"Edit visualization"})},Object(l.jsx)(o.EuiButtonIcon,{size:"xs",iconType:"lensApp",onClick:d,"data-test-subj":"unifiedHistogramEditVisualization","aria-label":u.i18n.translate("unifiedHistogram.editVisualizationButton",{defaultMessage:"Edit visualization"})}))),Object(l.jsx)(o.EuiFlexItem,{grow:!1},Object(l.jsx)(o.EuiPopover,{id:"unifiedHistogramChartOptions",button:Object(l.jsx)(o.EuiToolTip,{content:u.i18n.translate("unifiedHistogram.chartOptionsButton",{defaultMessage:"Chart options"})},Object(l.jsx)(o.EuiButtonIcon,{size:"xs",iconType:"gear",onClick:v,"data-test-subj":"unifiedHistogramChartOptionsToggle","aria-label":u.i18n.translate("unifiedHistogram.chartOptionsButton",{defaultMessage:"Chart options"})})),isOpen:j,closePopover:O,panelPaddingSize:"none",anchorPosition:"downLeft"},Object(l.jsx)(o.EuiContextMenu,{initialPanelId:0,panels:I}))))))),a&&!a.hidden&&Object(l.jsx)(o.EuiFlexItem,null,Object(l.jsx)("section",{ref:e=>h.current.element=e,tabIndex:-1,"aria-label":u.i18n.translate("unifiedHistogram.histogramOfFoundDocumentsAriaLabel",{defaultMessage:"Histogram of found documents"}),css:F},Object(l.jsx)(E,{services:t,chart:a,timefilterUpdateHandler:C})),c))}function I({dataView:e,timeInterval:t,data:i}){const n=[{type:"count",schema:"metric"},{type:"date_histogram",schema:"segment",params:{field:e.timeFieldName,interval:t,timeRange:i.query.timefilter.timefilter.getTime()}}];return i.search.aggs.createAggConfigs(e,n)}var k=i(14);const S=({data:e,dataView:t,timeInterval:i,response:n})=>{var a;if(!i||!n)return{};const s=I({dataView:t,timeInterval:i,data:e}),o=s.aggs[1],u=Object(y.tabifyAggResponse)(s,n),l=function(e,t){const[i,n]=e.aggs,{from:a,to:s}=t.query.timefilter.timefilter.getTime();n.params.timeRange={from:b.a.parse(a),to:b.a.parse(s,{roundUp:!0})};const o=n.params.timeRange?t.query.timefilter.timefilter.calculateBounds(n.params.timeRange):null,u=y.search.aggs.isDateHistogramBucketAggConfig(n)?n.buckets:void 0;if(!u||!o)return;const{esUnit:l,esValue:c}=u.getInterval();return{x:{accessor:0,label:n.makeLabel(),format:n.toSerializedFieldFormat(),params:{date:!0,interval:r.a.duration(c,l),intervalESValue:c,intervalESUnit:l,format:u.getScaledDateFormat(),bounds:o}},y:{accessor:1,format:i.toSerializedFieldFormat(),label:i.makeLabel()}}}(s,e),c=y.search.aggs.isDateHistogramBucketAggConfig(o)?null==o||null===(a=o.buckets)||void 0===a?void 0:a.getInterval():void 0,d=((e,t)=>{const{x:i,y:n}=t,a=e.columns[i.accessor].id,s=e.columns[n.accessor].id,r={};r.xAxisOrderedValues=Object(k.uniq)(e.rows.map((e=>e[a]))),r.xAxisFormat=i.format,r.xAxisLabel=e.columns[i.accessor].name,r.yAxisFormat=n.format;const{intervalESUnit:o,intervalESValue:u,interval:l,bounds:c}=i.params;return r.ordered={date:!0,interval:l,intervalESUnit:o,intervalESValue:u,min:c.min,max:c.max},r.yAxisLabel=e.columns[n.accessor].name,r.values=e.rows.filter((e=>e&&"NaN"!==e[s])).map((e=>({x:e[a],y:e[s]}))),r})(u,l);return{bucketInterval:c,chartData:d}}},function(e,t,i){i.r(t);var n=__kbnBundles__.get("plugin/charts/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(n))},function(e,t,i){e.exports=i(17)(3)},function(e,t){e.exports=__kbnSharedDeps__.Lodash},function(e,t,i){i(16),__kbnBundles__.define("plugin/unifiedHistogram/public",i,18)},function(e,t,i){i.p=window.__kbnPublicPath__.unifiedHistogram},function(e,t){e.exports=__kbnSharedDeps_npm__},function(e,t,i){"use strict";i.r(t),i.d(t,"UnifiedHistogramLayout",(function(){return d})),i.d(t,"getChartAggConfigs",(function(){return m.c})),i.d(t,"buildChartData",(function(){return m.b})),i.d(t,"plugin",(function(){return g}));class UnifiedHistogramPublicPlugin{setup(){return{}}start(){return{}}}var n=i(1),a=i(2),s=i.n(a),r=i(0),o={name:"1azakc",styles:"text-align:center"},u=function(){var e=o;return Object(r.jsx)("div",{css:e},Object(r.jsx)(n.EuiLoadingSpinner,null))},l=i(13),c=i.n(l);const d=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object(r.jsx)(u,null);return s.a.forwardRef((function(i,s){return Object(r.jsx)(n.EuiErrorBoundary,null,Object(r.jsx)(a.Suspense,{fallback:t},Object(r.jsx)(e,c()({},i,{ref:s}))))}))}(Object(a.lazy)((()=>i.e(1).then(i.bind(null,34)))),Object(r.jsx)(n.EuiDelayRender,{delay:300},Object(r.jsx)(n.EuiFlexGroup,{className:"eui-fullHeight",alignItems:"center",justifyContent:"center",gutterSize:"none",responsive:!1},Object(r.jsx)(n.EuiLoadingSpinner,{size:"l"}))));var m=i(11);const g=()=>new UnifiedHistogramPublicPlugin},function(e,t){e.exports=__kbnSharedDeps__.EmotionCache},function(e,t){e.exports=__kbnSharedDeps__.ReactDom}]);