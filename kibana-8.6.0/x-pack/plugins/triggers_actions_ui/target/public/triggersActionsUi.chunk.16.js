/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.triggersActionsUi_bundle_jsonpfunction=window.triggersActionsUi_bundle_jsonpfunction||[]).push([[16],{112:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return j}));var s=n(1),i=n(88),a=n(4),o=n(3),r=(n(180),n(123)),c=n(120),l=n(22),u=n(140),d=n(133),b=n(0);const j=({actionType:e,onClose:t,postSaveEventHandler:n,actionTypeRegistry:j})=>{const{application:{capabilities:g}}=Object(l.b)().services,{isLoading:p,createConnector:m}=Object(u.a)(),f=Object(s.useRef)(!1),O={actionTypeId:e.id,isDeprecated:!1,isMissingSecrets:!1,config:{},secrets:{}},x=Object(c.e)(g),v=j.get(e.id),[h,y]=Object(s.useState)(null),[F,C]=Object(s.useState)({isSubmitted:!1,isSubmitting:!1,isValid:void 0,submit:async()=>({isValid:!1,data:{}}),preSubmitValidator:null}),{preSubmitValidator:E,submit:S,isValid:M,isSubmitting:k}=F,T=!1===M,I=p||k,L=Object(s.useCallback)((async()=>{y(null);const{isValid:e,data:t}=await S();if(f.current&&e){if(E){const e=await E();if(e)return void y(e.message)}const{actionTypeId:e,name:n,config:s,secrets:i}=t,a={actionTypeId:e,name:null!=n?n:"",config:s,secrets:i};return await m(a)}}),[S,E,m]),w=Object(s.useCallback)((()=>{t()}),[t]),A=Object(s.useCallback)((async()=>{const e=await L();e&&(w(),n&&n(e))}),[L,w,n]);return Object(s.useEffect)((()=>(f.current=!0,()=>{f.current=!1})),[]),Object(b.jsx)(a.EuiModal,{className:"actConnectorModal","data-test-subj":"connectorAddModal",onClose:w},Object(b.jsx)(a.EuiModalHeader,null,Object(b.jsx)(a.EuiModalHeaderTitle,null,Object(b.jsx)(a.EuiFlexGroup,{gutterSize:"m",alignItems:"center"},v&&v.iconClass?Object(b.jsx)(a.EuiFlexItem,{grow:!1},Object(b.jsx)(a.EuiIcon,{type:v.iconClass,size:"xl"})):null,Object(b.jsx)(a.EuiFlexItem,{grow:!1},Object(b.jsx)(a.EuiFlexGroup,{gutterSize:"s",justifyContent:"center",alignItems:"center"},Object(b.jsx)(a.EuiFlexItem,null,Object(b.jsx)(a.EuiTitle,{size:"s"},Object(b.jsx)("h3",{id:"flyoutTitle"},Object(b.jsx)(i.FormattedMessage,{defaultMessage:"{actionTypeName} connector",id:"xpack.triggersActionsUI.sections.addModalConnectorForm.flyoutTitle",values:{actionTypeName:e.name}})))),v&&v.isExperimental&&Object(b.jsx)(a.EuiFlexItem,{className:"betaBadgeFlexItem",grow:!1},Object(b.jsx)(a.EuiBetaBadge,{label:r.a.label,tooltipContent:r.a.tooltipContent}))))))),Object(b.jsx)(a.EuiModalBody,null,Object(b.jsx)(d.a,{actionTypeModel:v,connector:O,isEdit:!1,onChange:C}),h),Object(b.jsx)(a.EuiModalFooter,null,Object(b.jsx)(a.EuiButtonEmpty,{onClick:w,isLoading:I},o.i18n.translate("xpack.triggersActionsUI.sections.addModalConnectorForm.cancelButtonLabel",{defaultMessage:"Cancel"})),x?Object(b.jsx)(a.EuiButton,{fill:!0,color:"success","data-test-subj":"saveActionButtonModal",type:"submit",iconType:"check",isLoading:I,disabled:T,onClick:A},Object(b.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.addModalConnectorForm.saveButtonLabel",defaultMessage:"Save"})):null))}},120:function(e,t,n){"use strict";n.d(t,"f",(function(){return s})),n.d(t,"e",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return c}));const s=e=>{var t;return null==e||null===(t=e.actions)||void 0===t?void 0:t.show},i=e=>{var t;return null==e||null===(t=e.actions)||void 0===t?void 0:t.save},a=e=>{var t;return null==e||null===(t=e.actions)||void 0===t?void 0:t.execute},o=e=>{var t;return null==e||null===(t=e.actions)||void 0===t?void 0:t.delete};function r(e,t){var n,s;return null!==(n=null==t||null===(s=t.authorizedConsumers[e.consumer])||void 0===s?void 0:s.all)&&void 0!==n&&n}const c=e=>{var t,n;return null==e||null===(t=e.management)||void 0===t||null===(n=t.security)||void 0===n?void 0:n.api_keys}},123:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var s=n(3);const i={label:s.i18n.translate("xpack.triggersActionsUI.technicalPreviewBadgeLabel",{defaultMessage:"Technical preview"}),tooltipContent:s.i18n.translate("xpack.triggersActionsUI.technicalPreviewBadgeDescription",{defaultMessage:"This functionality is in technical preview and may be changed or removed completely in a future release. Elastic will take a best effort approach to fix any issues, but features in technical preview are not subject to the support SLA of official GA features."})}},133:function(e,t,n){"use strict";n.d(t,"a",(function(){return I}));var s=n(1),i=n.n(s),a=n(21),o=n(10),r=n(4),c=n(88),l=n(62),u=n(120),d=n(22),b=n(25),j=n(66),g=n(3),p=n(65),m=n(0);const{emptyField:f}=b.fieldValidators,O={label:"Connector name",validations:[{validator:f(g.i18n.translate("xpack.triggersActionsUI.sections.actionConnectorForm.error.requiredNameText",{defaultMessage:"Name is required."}))}]},x=({canSave:e})=>Object(m.jsx)(i.a.Fragment,null,Object(m.jsx)(p.a,{path:"id"}),Object(m.jsx)(p.a,{path:"actionTypeId"}),Object(m.jsx)(p.a,{path:"isDeprecated"}),Object(m.jsx)(o.UseField,{path:"name",config:O,component:j.Field,componentProps:{euiFieldProps:{readOnly:!e,"data-test-subj":"nameInput",fullWidth:!0}}})),v=Object(s.memo)(x),h=({actionTypeModel:e,isEdit:t,registerPreSubmitValidator:n})=>{var a;const{application:{capabilities:o}}=Object(d.b)().services,b=Object(u.e)(o),j=null!==(a=null==e?void 0:e.actionConnectorFields)&&void 0!==a?a:null;return Object(m.jsx)(i.a.Fragment,null,Object(m.jsx)(v,{canSave:b}),Object(m.jsx)(r.EuiSpacer,{size:"m"}),null!==j?Object(m.jsx)(i.a.Fragment,null,Object(m.jsx)(r.EuiTitle,{size:"xxs","data-test-subj":"connector-settings-label"},Object(m.jsx)("h4",null,Object(m.jsx)(c.FormattedMessage,{id:"xpack.triggersActionsUI.sections.actionConnectorForm.connectorSettingsLabel",defaultMessage:"Connector settings"}))),Object(m.jsx)(r.EuiSpacer,{size:"s"}),Object(m.jsx)(r.EuiErrorBoundary,null,Object(m.jsx)(s.Suspense,{fallback:Object(m.jsx)(l.a,null,Object(m.jsx)(c.FormattedMessage,{id:"xpack.triggersActionsUI.sections.actionConnectorForm.loadingConnectorSettingsDescription",defaultMessage:"Loading connector settingsâ€¦"}))},Object(m.jsx)(j,{readOnly:!b,isEdit:t,registerPreSubmitValidator:n})))):null)},y=Object(s.memo)(h),F=({title:e,dataTestSubj:t})=>Object(m.jsx)(i.a.Fragment,null,Object(m.jsx)(r.EuiSpacer,{size:"s"}),Object(m.jsx)(r.EuiCallOut,{size:"s",iconType:"iInCircle","data-test-subj":t,title:e}),Object(m.jsx)(r.EuiSpacer,{size:"m"})),C=e=>null!=e||!C(e),E=({isEdit:e,isMissingSecrets:t})=>{const[n]=Object(o.useFormData)(),{getFields:s}=Object(o.useFormContext)(),i=s(),a=(r=i,Object.keys(r).filter((e=>e.includes("secrets"))).reduce(((e,t)=>({...e,[t]:r[t]})),{}));var r;const c=Object.keys(a).length,l=(e=>{if(0===e.length)return"";if(1===e.length)return`${e[0]}`;if(2===e.length)return e.join(" and ");const t=e[e.length-1];return`${e.slice(0,-1).join(", ")}, and ${t}`})((e=>Object.keys(e).map((t=>e[t].label)).filter(C))(a));return 0===Object.keys(a).length?null:t?Object(m.jsx)(F,{title:g.i18n.translate("xpack.triggersActionsUI.components.builtinActionTypes.missingSecretsValuesLabel",{values:{secretFieldsLabel:l,encryptedFieldsLength:c},defaultMessage:"Sensitive information is not imported. Please enter value{encryptedFieldsLength, plural, one {} other {s}} for the following field{encryptedFieldsLength, plural, one {} other {s}} {secretFieldsLabel}."}),dataTestSubj:"missing-secrets-callout"}):e?e?Object(m.jsx)(F,{title:g.i18n.translate("xpack.triggersActionsUI.components.simpleConnectorForm.secrets.reenterValuesMessage",{values:{secretFieldsLabel:l,encryptedFieldsLength:c},defaultMessage:"Value{encryptedFieldsLength, plural, one {} other {s}} {secretFieldsLabel} {encryptedFieldsLength, plural, one {is} other {are}} encrypted. Please reenter value{encryptedFieldsLength, plural, one {} other {s}} for {encryptedFieldsLength, plural, one {this} other {these}} field{encryptedFieldsLength, plural, one {} other {s}}."}),dataTestSubj:"edit-connector-secrets-callout"}):null:Object(m.jsx)(F,{title:g.i18n.translate("xpack.triggersActionsUI.components.simpleConnectorForm.secrets.reenterValuesLabel",{values:{secretFieldsLabel:l,encryptedFieldsLength:c},defaultMessage:"Remember value{encryptedFieldsLength, plural, one {} other {s}} {secretFieldsLabel}. You must reenter {encryptedFieldsLength, plural, one {it} other {them}} each time you edit the connector."}),dataTestSubj:"create-connector-secrets-callout"})},S=Object(s.memo)(E),M=e=>{var t,n;if(".webhook"!==e.actionTypeId&&".cases-webhook"!==e.actionTypeId)return e;const s=e,i=Object.entries(null!==(t=null==s||null===(n=s.config)||void 0===n?void 0:n.headers)&&void 0!==t?t:{}).map((([e,t])=>({key:e,value:t})));return{...e,config:{...e.config,headers:Object(a.isEmpty)(i)?void 0:i}}},k=e=>{var t,n;if(".webhook"!==e.actionTypeId&&".cases-webhook"!==e.actionTypeId)return e;const s=(null!==(t=null==e||null===(n=e.config)||void 0===n?void 0:n.headers)&&void 0!==t?t:[]).reduce(((e,t)=>({...e,[t.key]:t.value})),{});return{...e,config:{...e.config,headers:Object(a.isEmpty)(s)?null:s}}},T=({actionTypeModel:e,connector:t,isEdit:n,onChange:i,onFormModifiedChange:a})=>{const{form:c}=Object(o.useForm)({defaultValue:t,serializer:k,deserializer:M}),{submit:l,isValid:u,isSubmitted:d,isSubmitting:b}=c,[j,g]=Object(s.useState)(null),p=Object(s.useCallback)((e=>{g((()=>e))}),[]),f=Object(o.useFormIsModified)({form:c,discard:["__internal__"]});return Object(s.useEffect)((()=>{i&&i({isValid:u,isSubmitted:d,isSubmitting:b,submit:l,preSubmitValidator:j})}),[i,u,d,b,l,j]),Object(s.useEffect)((()=>{a&&a(f)}),[f,a]),Object(m.jsx)(o.Form,{form:c},Object(m.jsx)(y,{actionTypeModel:e,isEdit:n,registerPreSubmitValidator:p}),Object(m.jsx)(r.EuiSpacer,{size:"m"}),Object(m.jsx)(S,{isEdit:n,isMissingSecrets:t.isMissingSecrets}))},I=i.a.memo(T)},140:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var s=n(1),i=n(3),a=n(23),o=n(22);const r=()=>{const{http:e,notifications:{toasts:t}}=Object(o.b)().services,[n,r]=Object(s.useState)(!1),c=Object(s.useRef)(new AbortController),l=Object(s.useRef)(!1);return Object(s.useEffect)((()=>(l.current=!0,()=>{l.current=!1,c.current.abort()})),[]),{isLoading:n,createConnector:async function(n){r(!0),l.current=!0,c.current.abort(),c.current=new AbortController;try{const s=await Object(a.a)({http:e,connector:n});return l.current&&(r(!1),t.addSuccess(i.i18n.translate("xpack.triggersActionsUI.sections.addConnectorForm.updateSuccessNotificationText",{defaultMessage:"Created '{connectorName}'",values:{connectorName:s.name}}))),s}catch(e){var s,o;l.current&&(r(!1),"AbortError"!==e.name&&t.addDanger(null!==(s=null===(o=e.body)||void 0===o?void 0:o.message)&&void 0!==s?s:i.i18n.translate("xpack.triggersActionsUI.sections.useCreateConnector.updateErrorNotificationText",{defaultMessage:"Cannot create a connector."})))}}}}},180:function(e,t,n){switch(window.__kbnThemeTag__){case"v8dark":return n(181);case"v8light":return n(183)}},181:function(e,t,n){var s=n(58),i=n(182);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);s(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},182:function(e,t,n){(t=n(59)(!1)).push([e.i,".actConnectorModal{z-index:9000}.euiComboBoxOptionsList{z-index:9001}",""]),e.exports=t},183:function(e,t,n){var s=n(58),i=n(184);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);s(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},184:function(e,t,n){(t=n(59)(!1)).push([e.i,".actConnectorModal{z-index:9000}.euiComboBoxOptionsList{z-index:9001}",""]),e.exports=t}}]);