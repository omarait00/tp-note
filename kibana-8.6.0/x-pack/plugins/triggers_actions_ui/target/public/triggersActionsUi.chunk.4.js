/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.triggersActionsUi_bundle_jsonpfunction=window.triggersActionsUi_bundle_jsonpfunction||[]).push([[4],{120:function(e,t,n){"use strict";n.d(t,"f",(function(){return o})),n.d(t,"e",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return a}));const o=e=>{var t;return null==e||null===(t=e.actions)||void 0===t?void 0:t.show},r=e=>{var t;return null==e||null===(t=e.actions)||void 0===t?void 0:t.save},i=e=>{var t;return null==e||null===(t=e.actions)||void 0===t?void 0:t.execute},s=e=>{var t;return null==e||null===(t=e.actions)||void 0===t?void 0:t.delete};function c(e,t){var n,o;return null!==(n=null==t||null===(o=t.authorizedConsumers[e.consumer])||void 0===o?void 0:o.all)&&void 0!==n&&n}const a=e=>{var t,n;return null==e||null===(t=e.management)||void 0===t||null===(n=t.security)||void 0===n?void 0:n.api_keys}},123:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var o=n(3);const r={label:o.i18n.translate("xpack.triggersActionsUI.technicalPreviewBadgeLabel",{defaultMessage:"Technical preview"}),tooltipContent:o.i18n.translate("xpack.triggersActionsUI.technicalPreviewBadgeDescription",{defaultMessage:"This functionality is in technical preview and may be changed or removed completely in a future release. Elastic will take a best effort approach to fix any issues, but features in technical preview are not subject to the support SLA of official GA features."})}},124:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.apS=t.bind=t.bindTo=t.getRefinement=t.exists=t.elem=t.option=t.MonadThrow=t.Witherable=t.Traversable=t.Filterable=t.Compactable=t.Extend=t.Alternative=t.Alt=t.Foldable=t.Monad=t.Applicative=t.Functor=t.getMonoid=t.getLastMonoid=t.getFirstMonoid=t.getApplyMonoid=t.getApplySemigroup=t.getOrd=t.getEq=t.getShow=t.URI=t.wilt=t.wither=t.sequence=t.traverse=t.partitionMap=t.partition=t.filterMap=t.filter=t.separate=t.compact=t.reduceRight=t.foldMap=t.reduce=t.duplicate=t.extend=t.throwError=t.zero=t.alt=t.flatten=t.chainFirst=t.chain=t.of=t.apSecond=t.apFirst=t.ap=t.map=t.mapNullable=t.getOrElse=t.getOrElseW=t.toUndefined=t.toNullable=t.fold=t.fromEither=t.getRight=t.getLeft=t.tryCatch=t.fromPredicate=t.fromNullable=t.some=t.none=t.isNone=t.isSome=void 0;var o=n(64);function r(e){return null==e?t.none:t.some(e)}function i(e){return"Right"===e._tag?t.none:t.some(e.left)}function s(e){return"Left"===e._tag?t.none:t.some(e.right)}t.isSome=function(e){return"Some"===e._tag},t.isNone=function(e){return"None"===e._tag},t.none={_tag:"None"},t.some=function(e){return{_tag:"Some",value:e}},t.fromNullable=r,t.fromPredicate=function(e){return function(n){return e(n)?t.some(n):t.none}},t.tryCatch=function(e){try{return t.some(e())}catch(e){return t.none}},t.getLeft=i,t.getRight=s,t.fromEither=function(e){return"Left"===e._tag?t.none:t.some(e.right)},t.fold=function(e,n){return function(o){return t.isNone(o)?e():n(o.value)}},t.toNullable=function(e){return t.isNone(e)?null:e.value},t.toUndefined=function(e){return t.isNone(e)?void 0:e.value},t.getOrElseW=function(e){return function(n){return t.isNone(n)?e():n.value}},t.getOrElse=t.getOrElseW,t.mapNullable=function(e){return function(n){return t.isNone(n)?t.none:r(e(n.value))}};var c=function(e,n){return o.pipe(e,t.map(n))},a=function(e,n){return o.pipe(e,t.ap(n))},u=function(e,n){return o.pipe(e,t.chain(n))},l=function(e,n,r){return o.pipe(e,t.reduce(n,r))},d=function(e){var n=t.foldMap(e);return function(e,t){return o.pipe(e,n(t))}},p=function(e,n,r){return o.pipe(e,t.reduceRight(n,r))},f=function(e){var n=t.traverse(e);return function(e,t){return o.pipe(e,n(t))}},g=function(e,n){return o.pipe(e,t.alt(n))},b=function(e,n){return o.pipe(e,t.filter(n))},j=function(e,n){return o.pipe(e,t.filterMap(n))},m=function(e,n){return o.pipe(e,t.extend(n))},x=function(e,n){return o.pipe(e,t.partition(n))},O=function(e,n){return o.pipe(e,t.partitionMap(n))},h=function(e){var n=t.wither(e);return function(e,t){return o.pipe(e,n(t))}},v=function(e){var n=t.wilt(e);return function(e,t){return o.pipe(e,n(t))}};t.map=function(e){return function(n){return t.isNone(n)?t.none:t.some(e(n.value))}},t.ap=function(e){return function(n){return t.isNone(n)||t.isNone(e)?t.none:t.some(n.value(e.value))}},t.apFirst=function(e){return o.flow(t.map((function(e){return function(){return e}})),t.ap(e))},t.apSecond=function(e){return o.flow(t.map((function(){return function(e){return e}})),t.ap(e))},t.of=t.some,t.chain=function(e){return function(n){return t.isNone(n)?t.none:e(n.value)}},t.chainFirst=function(e){return t.chain((function(n){return o.pipe(e(n),t.map((function(){return n})))}))},t.flatten=t.chain(o.identity),t.alt=function(e){return function(n){return t.isNone(n)?e():n}},t.zero=function(){return t.none},t.throwError=function(){return t.none},t.extend=function(e){return function(n){return t.isNone(n)?t.none:t.some(e(n))}},t.duplicate=t.extend(o.identity),t.reduce=function(e,n){return function(o){return t.isNone(o)?e:n(e,o.value)}},t.foldMap=function(e){return function(n){return function(o){return t.isNone(o)?e.empty:n(o.value)}}},t.reduceRight=function(e,n){return function(o){return t.isNone(o)?e:n(o.value,e)}},t.compact=t.flatten;var F={left:t.none,right:t.none};function y(e){return{equals:function(n,o){return n===o||(t.isNone(n)?t.isNone(o):!t.isNone(o)&&e.equals(n.value,o.value))}}}function C(e){return{concat:function(n,o){return t.isSome(n)&&t.isSome(o)?t.some(e.concat(n.value,o.value)):t.none}}}t.separate=function(e){var n=o.pipe(e,t.map((function(e){return{left:i(e),right:s(e)}})));return t.isNone(n)?F:n.value},t.filter=function(e){return function(n){return t.isNone(n)?t.none:e(n.value)?n:t.none}},t.filterMap=function(e){return function(n){return t.isNone(n)?t.none:e(n.value)}},t.partition=function(e){return function(n){return{left:o.pipe(n,t.filter((function(t){return!e(t)}))),right:o.pipe(n,t.filter(e))}}},t.partitionMap=function(e){return function(n){return t.separate(o.pipe(n,t.map(e)))}},t.traverse=function(e){return function(n){return function(o){return t.isNone(o)?e.of(t.none):e.map(n(o.value),t.some)}}},t.sequence=function(e){return function(n){return t.isNone(n)?e.of(t.none):e.map(n.value,t.some)}},t.wither=function(e){return function(n){return function(o){return t.isNone(o)?e.of(t.none):n(o.value)}}},t.wilt=function(e){return function(n){return function(r){var c=o.pipe(r,t.map((function(t){return e.map(n(t),(function(e){return{left:i(e),right:s(e)}}))})));return t.isNone(c)?e.of({left:t.none,right:t.none}):c.value}}},t.URI="Option",t.getShow=function(e){return{show:function(n){return t.isNone(n)?"none":"some("+e.show(n.value)+")"}}},t.getEq=y,t.getOrd=function(e){return{equals:y(e).equals,compare:function(n,o){return n===o?0:t.isSome(n)?t.isSome(o)?e.compare(n.value,o.value):1:-1}}},t.getApplySemigroup=C,t.getApplyMonoid=function(e){return{concat:C(e).concat,empty:t.some(e.empty)}},t.getFirstMonoid=function(){return{concat:function(e,n){return t.isNone(e)?n:e},empty:t.none}},t.getLastMonoid=function(){return{concat:function(e,n){return t.isNone(n)?e:n},empty:t.none}},t.getMonoid=function(e){return{concat:function(n,o){return t.isNone(n)?o:t.isNone(o)?n:t.some(e.concat(n.value,o.value))},empty:t.none}},t.Functor={URI:t.URI,map:c},t.Applicative={URI:t.URI,map:c,ap:a,of:t.of},t.Monad={URI:t.URI,map:c,ap:a,of:t.of,chain:u},t.Foldable={URI:t.URI,reduce:l,foldMap:d,reduceRight:p},t.Alt={URI:t.URI,map:c,alt:g},t.Alternative={URI:t.URI,map:c,ap:a,of:t.of,alt:g,zero:t.zero},t.Extend={URI:t.URI,map:c,extend:m},t.Compactable={URI:t.URI,compact:t.compact,separate:t.separate},t.Filterable={URI:t.URI,map:c,compact:t.compact,separate:t.separate,filter:b,filterMap:j,partition:x,partitionMap:O},t.Traversable={URI:t.URI,map:c,reduce:l,foldMap:d,reduceRight:p,traverse:f,sequence:t.sequence},t.Witherable={URI:t.URI,map:c,reduce:l,foldMap:d,reduceRight:p,traverse:f,sequence:t.sequence,compact:t.compact,separate:t.separate,filter:b,filterMap:j,partition:x,partitionMap:O,wither:h,wilt:v},t.MonadThrow={URI:t.URI,map:c,ap:a,of:t.of,chain:u,throwError:t.throwError},t.option={URI:t.URI,map:c,of:t.of,ap:a,chain:u,reduce:l,foldMap:d,reduceRight:p,traverse:f,sequence:t.sequence,zero:t.zero,alt:g,extend:m,compact:t.compact,separate:t.separate,filter:b,filterMap:j,partition:x,partitionMap:O,wither:h,wilt:v,throwError:t.throwError},t.elem=function(e){return function(n,o){return!t.isNone(o)&&e.equals(n,o.value)}},t.exists=function(e){return function(n){return!t.isNone(n)&&e(n.value)}},t.getRefinement=function(e){return function(n){return t.isSome(e(n))}},t.bindTo=function(e){return t.map(o.bindTo_(e))},t.bind=function(e,n){return t.chain((function(r){return o.pipe(n(r),t.map((function(t){return o.bind_(r,e,t)})))}))},t.apS=function(e,n){return o.flow(t.map((function(t){return function(n){return o.bind_(t,e,n)}})),t.ap(n))}},133:function(e,t,n){"use strict";n.d(t,"a",(function(){return U}));var o=n(1),r=n.n(o),i=n(21),s=n(10),c=n(4),a=n(88),u=n(62),l=n(120),d=n(22),p=n(25),f=n(66),g=n(3),b=n(65),j=n(0);const{emptyField:m}=p.fieldValidators,x={label:"Connector name",validations:[{validator:m(g.i18n.translate("xpack.triggersActionsUI.sections.actionConnectorForm.error.requiredNameText",{defaultMessage:"Name is required."}))}]},O=({canSave:e})=>Object(j.jsx)(r.a.Fragment,null,Object(j.jsx)(b.a,{path:"id"}),Object(j.jsx)(b.a,{path:"actionTypeId"}),Object(j.jsx)(b.a,{path:"isDeprecated"}),Object(j.jsx)(s.UseField,{path:"name",config:x,component:f.Field,componentProps:{euiFieldProps:{readOnly:!e,"data-test-subj":"nameInput",fullWidth:!0}}})),h=Object(o.memo)(O),v=({actionTypeModel:e,isEdit:t,registerPreSubmitValidator:n})=>{var i;const{application:{capabilities:s}}=Object(d.b)().services,p=Object(l.e)(s),f=null!==(i=null==e?void 0:e.actionConnectorFields)&&void 0!==i?i:null;return Object(j.jsx)(r.a.Fragment,null,Object(j.jsx)(h,{canSave:p}),Object(j.jsx)(c.EuiSpacer,{size:"m"}),null!==f?Object(j.jsx)(r.a.Fragment,null,Object(j.jsx)(c.EuiTitle,{size:"xxs","data-test-subj":"connector-settings-label"},Object(j.jsx)("h4",null,Object(j.jsx)(a.FormattedMessage,{id:"xpack.triggersActionsUI.sections.actionConnectorForm.connectorSettingsLabel",defaultMessage:"Connector settings"}))),Object(j.jsx)(c.EuiSpacer,{size:"s"}),Object(j.jsx)(c.EuiErrorBoundary,null,Object(j.jsx)(o.Suspense,{fallback:Object(j.jsx)(u.a,null,Object(j.jsx)(a.FormattedMessage,{id:"xpack.triggersActionsUI.sections.actionConnectorForm.loadingConnectorSettingsDescription",defaultMessage:"Loading connector settingsâ€¦"}))},Object(j.jsx)(f,{readOnly:!p,isEdit:t,registerPreSubmitValidator:n})))):null)},F=Object(o.memo)(v),y=({title:e,dataTestSubj:t})=>Object(j.jsx)(r.a.Fragment,null,Object(j.jsx)(c.EuiSpacer,{size:"s"}),Object(j.jsx)(c.EuiCallOut,{size:"s",iconType:"iInCircle","data-test-subj":t,title:e}),Object(j.jsx)(c.EuiSpacer,{size:"m"})),C=e=>null!=e||!C(e),E=({isEdit:e,isMissingSecrets:t})=>{const[n]=Object(s.useFormData)(),{getFields:o}=Object(s.useFormContext)(),r=o(),i=(c=r,Object.keys(c).filter((e=>e.includes("secrets"))).reduce(((e,t)=>({...e,[t]:c[t]})),{}));var c;const a=Object.keys(i).length,u=(e=>{if(0===e.length)return"";if(1===e.length)return`${e[0]}`;if(2===e.length)return e.join(" and ");const t=e[e.length-1];return`${e.slice(0,-1).join(", ")}, and ${t}`})((e=>Object.keys(e).map((t=>e[t].label)).filter(C))(i));return 0===Object.keys(i).length?null:t?Object(j.jsx)(y,{title:g.i18n.translate("xpack.triggersActionsUI.components.builtinActionTypes.missingSecretsValuesLabel",{values:{secretFieldsLabel:u,encryptedFieldsLength:a},defaultMessage:"Sensitive information is not imported. Please enter value{encryptedFieldsLength, plural, one {} other {s}} for the following field{encryptedFieldsLength, plural, one {} other {s}} {secretFieldsLabel}."}),dataTestSubj:"missing-secrets-callout"}):e?e?Object(j.jsx)(y,{title:g.i18n.translate("xpack.triggersActionsUI.components.simpleConnectorForm.secrets.reenterValuesMessage",{values:{secretFieldsLabel:u,encryptedFieldsLength:a},defaultMessage:"Value{encryptedFieldsLength, plural, one {} other {s}} {secretFieldsLabel} {encryptedFieldsLength, plural, one {is} other {are}} encrypted. Please reenter value{encryptedFieldsLength, plural, one {} other {s}} for {encryptedFieldsLength, plural, one {this} other {these}} field{encryptedFieldsLength, plural, one {} other {s}}."}),dataTestSubj:"edit-connector-secrets-callout"}):null:Object(j.jsx)(y,{title:g.i18n.translate("xpack.triggersActionsUI.components.simpleConnectorForm.secrets.reenterValuesLabel",{values:{secretFieldsLabel:u,encryptedFieldsLength:a},defaultMessage:"Remember value{encryptedFieldsLength, plural, one {} other {s}} {secretFieldsLabel}. You must reenter {encryptedFieldsLength, plural, one {it} other {them}} each time you edit the connector."}),dataTestSubj:"create-connector-secrets-callout"})},M=Object(o.memo)(E),I=e=>{var t,n;if(".webhook"!==e.actionTypeId&&".cases-webhook"!==e.actionTypeId)return e;const o=e,r=Object.entries(null!==(t=null==o||null===(n=o.config)||void 0===n?void 0:n.headers)&&void 0!==t?t:{}).map((([e,t])=>({key:e,value:t})));return{...e,config:{...e.config,headers:Object(i.isEmpty)(r)?void 0:r}}},T=e=>{var t,n;if(".webhook"!==e.actionTypeId&&".cases-webhook"!==e.actionTypeId)return e;const o=(null!==(t=null==e||null===(n=e.config)||void 0===n?void 0:n.headers)&&void 0!==t?t:[]).reduce(((e,t)=>({...e,[t.key]:t.value})),{});return{...e,config:{...e.config,headers:Object(i.isEmpty)(o)?null:o}}},S=({actionTypeModel:e,connector:t,isEdit:n,onChange:r,onFormModifiedChange:i})=>{const{form:a}=Object(s.useForm)({defaultValue:t,serializer:T,deserializer:I}),{submit:u,isValid:l,isSubmitted:d,isSubmitting:p}=a,[f,g]=Object(o.useState)(null),b=Object(o.useCallback)((e=>{g((()=>e))}),[]),m=Object(s.useFormIsModified)({form:a,discard:["__internal__"]});return Object(o.useEffect)((()=>{r&&r({isValid:l,isSubmitted:d,isSubmitting:p,submit:u,preSubmitValidator:f})}),[r,l,d,p,u,f]),Object(o.useEffect)((()=>{i&&i(m)}),[m,i]),Object(j.jsx)(s.Form,{form:a},Object(j.jsx)(F,{actionTypeModel:e,isEdit:n,registerPreSubmitValidator:b}),Object(j.jsx)(c.EuiSpacer,{size:"m"}),Object(j.jsx)(M,{isEdit:n,isMissingSecrets:t.isMissingSecrets}))},U=r.a.memo(S)},77:function(e,t,n){"use strict";n.r(t),n.d(t,"EditConnectorFlyout",(function(){return S})),n.d(t,"default",(function(){return S}));var o=n(1),r=n.n(o),i=n(4),s=n(88),c=n(3),a=n(19),u=n(124),l=n(15),d=n(133),p=n(23),f=n(22),g=n(120),b=n(63),j=n(0);const m=({connector:e,executeEnabled:t,executionResult:n,actionParams:a,setActionParams:d,onExecutionAction:p,isExecutingAction:f,actionTypeRegistry:g})=>{const[m,v]=Object(o.useState)({}),[F,y]=Object(o.useState)(!1),C=g.get(e.actionTypeId),E=C.actionParamsFields;Object(o.useEffect)((()=>{(async()=>{const e=(await(null==C?void 0:C.validateParams(a))).errors;v({...e}),y(!!Object.values(e).find((e=>e.length>0)))})()}),[C,a]);const M=[{title:c.i18n.translate("xpack.triggersActionsUI.sections.testConnectorForm.createActionHeader",{defaultMessage:"Create an action"}),children:E?Object(j.jsx)(i.EuiErrorBoundary,null,Object(j.jsx)(o.Suspense,{fallback:Object(j.jsx)(i.EuiFlexGroup,{justifyContent:"center"},Object(j.jsx)(i.EuiFlexItem,{grow:!1},Object(j.jsx)(i.EuiLoadingSpinner,{size:"m"})))},Object(j.jsx)(E,{actionParams:a,index:0,errors:m,editAction:(e,t)=>d({...a,[e]:t}),messageVariables:[],actionConnector:e,executionMode:l.b.Test}))):Object(j.jsx)(i.EuiText,null,Object(j.jsx)("p",null,Object(j.jsx)(s.FormattedMessage,{id:"xpack.triggersActionsUI.sections.testConnectorForm.noActionParametersRequiredText",defaultMessage:"This Connector does not require any Action Parameter."})))},{title:c.i18n.translate("xpack.triggersActionsUI.sections.testConnectorForm.runTestHeader",{defaultMessage:"Run the test"}),children:Object(j.jsx)(r.a.Fragment,null,t?null:Object(j.jsx)(r.a.Fragment,null,Object(j.jsx)(i.EuiCallOut,{iconType:"alert",color:"warning"},Object(j.jsx)("p",null,Object(j.jsx)(s.FormattedMessage,{defaultMessage:"Save your changes before testing the connector.",id:"xpack.triggersActionsUI.sections.testConnectorForm.executeTestDisabled"}))),Object(j.jsx)(i.EuiSpacer,{size:"s"})),Object(j.jsx)(i.EuiText,null,Object(j.jsx)(i.EuiButton,{iconType:"play",isLoading:f,isDisabled:!t||F||f,"data-test-subj":"executeActionButton",onClick:p},Object(j.jsx)(s.FormattedMessage,{defaultMessage:"Run",id:"xpack.triggersActionsUI.sections.testConnectorForm.executeTestButton"}))))},{title:c.i18n.translate("xpack.triggersActionsUI.sections.testConnectorForm.testResultsHeader",{defaultMessage:"Results"}),children:Object(b.pipe)(n,Object(u.map)((e=>"ok"===(null==e?void 0:e.status)?Object(j.jsx)(O,null):Object(j.jsx)(h,{executionResult:e}))),Object(u.getOrElse)((()=>Object(j.jsx)(x,null))))}];return Object(j.jsx)(i.EuiSteps,{steps:M,"data-test-subj":"test-connector-form"})},x=()=>Object(j.jsx)(i.EuiCallOut,{"data-test-subj":"executionAwaiting"},Object(j.jsx)("p",null,Object(j.jsx)(s.FormattedMessage,{defaultMessage:"When you run the test, the results will show up here.",id:"xpack.triggersActionsUI.sections.testConnectorForm.awaitingExecutionDescription"}))),O=()=>Object(j.jsx)(i.EuiCallOut,{title:c.i18n.translate("xpack.triggersActionsUI.sections.testConnectorForm.executionSuccessfulTitle",{defaultMessage:"Test was successful",values:{}}),color:"success","data-test-subj":"executionSuccessfulResult",iconType:"check"},Object(j.jsx)("p",null,Object(j.jsx)(s.FormattedMessage,{defaultMessage:"Ensure the results are what you expect.",id:"xpack.triggersActionsUI.sections.testConnectorForm.executionSuccessfulDescription"}))),h=({executionResult:e})=>{var t;const n=[{title:c.i18n.translate("xpack.triggersActionsUI.sections.testConnectorForm.executionFailureDescription",{defaultMessage:"The following error was found:"}),description:null!==(t=null==e?void 0:e.message)&&void 0!==t?t:c.i18n.translate("xpack.triggersActionsUI.sections.testConnectorForm.executionFailureUnknownReason",{defaultMessage:"Unknown reason"})}];return null!=e&&e.serviceMessage&&n.push({title:c.i18n.translate("xpack.triggersActionsUI.sections.testConnectorForm.executionFailureAdditionalDetails",{defaultMessage:"Details:"}),description:e.serviceMessage}),Object(j.jsx)(i.EuiCallOut,{title:c.i18n.translate("xpack.triggersActionsUI.sections.testConnectorForm.executionFailureTitle",{defaultMessage:"Test failed to run"}),"data-test-subj":"executionFailureResult",color:"danger",iconType:"alert"},Object(j.jsx)(i.EuiDescriptionList,{textStyle:"reverse",listItems:n}))};var v=n(123);const F=({icon:e,isExperimental:t=!1,isPreconfigured:n,connectorName:o,connectorTypeDesc:a,selectedTab:u,setTab:d})=>{const{euiTheme:p}=Object(i.useEuiTheme)();return Object(j.jsx)(i.EuiFlyoutHeader,{hasBorder:!0,"data-test-subj":"edit-connector-flyout-header"},Object(j.jsx)(i.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},e?Object(j.jsx)(i.EuiFlexItem,{grow:!1},Object(j.jsx)(i.EuiIcon,{type:e,size:"m","data-test-subj":"edit-connector-flyout-header-icon"})):null,Object(j.jsx)(i.EuiFlexItem,{grow:!1},n?Object(j.jsx)(r.a.Fragment,null,Object(j.jsx)(i.EuiFlexGroup,{gutterSize:"s",justifyContent:"center",alignItems:"center"},Object(j.jsx)(i.EuiFlexItem,{grow:!1},Object(j.jsx)(i.EuiTitle,{size:"s"},Object(j.jsx)("h3",{id:"flyoutTitle"},Object(j.jsx)(s.FormattedMessage,{defaultMessage:"{connectorName}",id:"xpack.triggersActionsUI.sections.preconfiguredConnectorForm.flyoutTitle",values:{connectorName:o}})))),Object(j.jsx)(i.EuiFlexItem,{grow:!1},Object(j.jsx)(i.EuiBetaBadge,{label:"Preconfigured","data-test-subj":"preconfiguredBadge",tooltipContent:c.i18n.translate("xpack.triggersActionsUI.sections.preconfiguredConnectorForm.tooltipContent",{defaultMessage:"This connector is preconfigured and cannot be edited"})})),Object(j.jsx)(i.EuiFlexItem,{grow:!1},t&&Object(j.jsx)(i.EuiBetaBadge,{label:v.a.label,tooltipContent:v.a.tooltipContent}))),Object(j.jsx)(i.EuiText,{size:"s"},Object(j.jsx)(s.FormattedMessage,{defaultMessage:"{connectorTypeDesc}",id:"xpack.triggersActionsUI.sections.editConnectorForm.actionTypeDescription",values:{connectorTypeDesc:a}}))):Object(j.jsx)(i.EuiFlexGroup,{gutterSize:"s",justifyContent:"center",alignItems:"center"},Object(j.jsx)(i.EuiFlexItem,null,Object(j.jsx)(i.EuiTitle,{size:"s"},Object(j.jsx)("h3",{id:"flyoutTitle"},Object(j.jsx)(s.FormattedMessage,{defaultMessage:"Edit connector",id:"xpack.triggersActionsUI.sections.editConnectorForm.flyoutPreconfiguredTitle"})))),t&&Object(j.jsx)(i.EuiFlexItem,{grow:!1},Object(j.jsx)(i.EuiBetaBadge,{label:v.a.label,tooltipContent:v.a.tooltipContent}))))),Object(j.jsx)(i.EuiTabs,{className:"connectorEditFlyoutTabs",bottomBorder:!1,css:Object(j.css)("margin-bottom:-",p.size.l,";","")},Object(j.jsx)(i.EuiTab,{onClick:d,"data-test-subj":"configureConnectorTab",isSelected:l.i.Configuration===u},c.i18n.translate("xpack.triggersActionsUI.sections.editConnectorForm.tabText",{defaultMessage:"Configuration"})),Object(j.jsx)(i.EuiTab,{onClick:d,"data-test-subj":"testConnectorTab",isSelected:l.i.Test===u},c.i18n.translate("xpack.triggersActionsUI.sections.testConnectorForm.tabText",{defaultMessage:"Test"}))))},y=Object(o.memo)(F),C=({onClose:e})=>Object(j.jsx)(i.EuiFlyoutFooter,{"data-test-subj":"edit-connector-flyout-footer"},Object(j.jsx)(i.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(j.jsx)(i.EuiFlexItem,{grow:!1},Object(j.jsx)(i.EuiButtonEmpty,{onClick:e,"data-test-subj":"edit-connector-flyout-close-btn"},c.i18n.translate("xpack.triggersActionsUI.sections.editConnectorForm.closeButtonLabel",{defaultMessage:"Close"}))),Object(j.jsx)(i.EuiFlexItem,{grow:!1}))),E=Object(o.memo)(C),M=e=>{var t;return{...e,isMissingSecrets:null!==(t=e.isMissingSecrets)&&void 0!==t&&t,secrets:{}}},I=({href:e})=>Object(j.jsx)(r.a.Fragment,null,Object(j.jsx)(i.EuiText,null,c.i18n.translate("xpack.triggersActionsUI.sections.editConnectorForm.descriptionText",{defaultMessage:"This connector is readonly."})),Object(j.jsx)(i.EuiLink,{href:e,target:"_blank"},Object(j.jsx)(s.FormattedMessage,{id:"xpack.triggersActionsUI.sections.editConnectorForm.preconfiguredHelpLabel",defaultMessage:"Learn more about preconfigured connectors."}))),T=({actionTypeRegistry:e,connector:t,onClose:n,tab:b=l.i.Configuration,onConnectorUpdated:x})=>{const{docLinks:O,application:{capabilities:h}}=Object(f.b)().services,v=Object(o.useRef)(!1),F=Object(g.e)(h),{isLoading:C,updateConnector:T}=(()=>{const{http:e,notifications:{toasts:t}}=Object(f.b)().services,[n,r]=Object(o.useState)(!1),i=Object(o.useRef)(new AbortController),s=Object(o.useRef)(!1);return Object(o.useEffect)((()=>(s.current=!0,()=>{s.current=!1,i.current.abort()})),[]),{isLoading:n,updateConnector:async function(n){r(!0),s.current=!0,i.current.abort(),i.current=new AbortController;try{const o=await Object(p.f)({http:e,connector:n,id:n.id});return s.current&&(r(!1),t.addSuccess(c.i18n.translate("xpack.triggersActionsUI.sections.editConnectorForm.updateSuccessNotificationText",{defaultMessage:"Updated '{connectorName}'",values:{connectorName:o.name}}))),o}catch(e){var o,a;s.current&&(r(!1),"AbortError"!==e.name&&t.addDanger(null!==(o=null===(a=e.body)||void 0===a?void 0:a.message)&&void 0!==o?o:c.i18n.translate("xpack.triggersActionsUI.sections.editConnectorForm.updateErrorNotificationText",{defaultMessage:"Cannot update a connector."})))}}}})(),{isLoading:S,executeConnector:U}=(()=>{const{http:e}=Object(f.b)().services,[t,n]=Object(o.useState)(!1),r=Object(o.useRef)(new AbortController),i=Object(o.useRef)(!1);return Object(o.useEffect)((()=>(i.current=!0,()=>{i.current=!1,r.current.abort()})),[]),{isLoading:t,executeConnector:async function({connectorId:t,params:o}){n(!0),i.current=!0,r.current.abort(),r.current=new AbortController;try{const r=await Object(p.c)({http:e,id:t,params:o});return i.current&&n(!1),r}catch(e){if(i.current&&(n(!1),"AbortError"!==e.name))throw e}}}})(),[w,A]=Object(o.useState)(null),[k,R]=Object(o.useState)({isSubmitted:!1,isSubmitting:!1,isValid:void 0,submit:async()=>({isValid:!1,data:{}}),preSubmitValidator:null}),[N,L]=Object(o.useState)(b),[P,z]=Object(o.useState)({}),[B,_]=Object(o.useState)(u.none),D=Object(o.useCallback)((()=>L((e=>e===l.i.Configuration?l.i.Test:(B!==u.none&&_(u.none),l.i.Configuration)))),[B]),[q,V]=Object(o.useState)(!1),[W,G]=Object(o.useState)(!1),[H,$]=Object(o.useState)(!0),[Y,J]=Object(o.useState)(!1),{preSubmitValidator:K,submit:Q,isValid:X,isSubmitting:Z}=k,ee=!1===X,te=C||Z||S,ne=e.get(t.actionTypeId),oe=F&&ne&&!t.isPreconfigured,re=Object(o.useCallback)((async()=>{try{const e=await U({connectorId:t.id,params:P});_(Object(u.some)(e))}catch(e){const n=Object(a.isActionTypeExecutorResult)(e)?e:{actionId:t.id,status:"error",message:e.message};_(Object(u.some)(n))}}),[t.id,U,P]),ie=Object(o.useCallback)((e=>{e&&J(!1),V(e),_(u.none)}),[V]),se=Object(o.useCallback)((()=>{q?G(!0):n()}),[n,q,G]),ce=Object(o.useCallback)((async()=>{A(null);const{isValid:e,data:n}=await Q();if(v.current&&e){if(K){const e=await K();if(e)return void A(e.message)}const{name:e,config:o,secrets:r}=n,i={id:t.id,name:null!=e?e:"",config:null!=o?o:{},secrets:null!=r?r:{}},s=await T(i);return s&&(ie(!1),x&&x(s),J(!0),$(!1),$(!0)),s}}),[x,Q,K,t.id,T,ie]);return Object(o.useEffect)((()=>(v.current=!0,()=>{v.current=!1})),[]),Object(j.jsx)(r.a.Fragment,null,Object(j.jsx)(i.EuiFlyout,{onClose:se,"aria-labelledby":"flyoutActionEditTitle",size:"m","data-test-subj":"edit-connector-flyout"},Object(j.jsx)(y,{isPreconfigured:t.isPreconfigured,connectorName:t.name,connectorTypeDesc:null==ne?void 0:ne.selectMessage,setTab:D,selectedTab:N,icon:null==ne?void 0:ne.iconClass,isExperimental:null==ne?void 0:ne.isExperimental}),Object(j.jsx)(i.EuiFlyoutBody,null,N===l.i.Configuration?t.isPreconfigured?Object(j.jsx)(I,{href:O.links.alerting.preconfiguredConnectors}):Object(j.jsx)(r.a.Fragment,null,H&&Object(j.jsx)(r.a.Fragment,null,Object(j.jsx)(d.a,{actionTypeModel:ne,connector:M(t),isEdit:H,onChange:R,onFormModifiedChange:ie}),!!w&&Object(j.jsx)("p",null,w),oe&&Object(j.jsx)(i.EuiButton,{fill:!0,iconType:Y?"check":void 0,color:"success","data-test-subj":"edit-connector-flyout-save-btn",isLoading:te,onClick:ce,disabled:!q||ee||te},Y?Object(j.jsx)(s.FormattedMessage,{id:"xpack.triggersActionsUI.sections.editConnectorForm.saveButtonSavedLabel",defaultMessage:"Changes Saved"}):Object(j.jsx)(s.FormattedMessage,{id:"xpack.triggersActionsUI.sections.editConnectorForm.saveButtonLabel",defaultMessage:"Save"})))):Object(j.jsx)(m,{connector:t,executeEnabled:!q,actionParams:P,setActionParams:z,onExecutionAction:re,isExecutingAction:S,executionResult:B,actionTypeRegistry:e})),Object(j.jsx)(E,{onClose:se})),W&&Object(j.jsx)(i.EuiConfirmModal,{buttonColor:"danger","data-test-subj":"closeConnectorEditConfirm",title:c.i18n.translate("xpack.triggersActionsUI.sections.confirmConnectorEditClose.title",{defaultMessage:"Discard unsaved changes to connector?"}),onCancel:()=>{G(!1)},onConfirm:n,cancelButtonText:c.i18n.translate("xpack.triggersActionsUI.sections.confirmConnectorEditClose.cancelButtonLabel",{defaultMessage:"Cancel"}),confirmButtonText:c.i18n.translate("xpack.triggersActionsUI.sections.confirmConnectorEditClose.discardButtonLabel",{defaultMessage:"Discard Changes"})},Object(j.jsx)(s.FormattedMessage,{id:"xpack.triggersActionsUI.sections.confirmConnectorEditClose.confirmConnectorCloseMessage",defaultMessage:"You can't recover unsaved changes."})))},S=Object(o.memo)(T)}}]);