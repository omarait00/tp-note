/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.kubernetesSecurity_bundle_jsonpfunction=window.kubernetesSecurity_bundle_jsonpfunction||[]).push([[1],[,,,,,,,,,,,,,,,function(e,t,r){e.exports=r(13)(3)},function(e,t,r){e.exports=r.p+"94cccf20036d014924e63d4d595e88e1.svg"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),s=r(18),a=function(){};t.default=function(e,t,r){if(!s.isClient)return[t,a,a];if(!e)throw new Error("useLocalStorage key may not be falsy");var i=r?r.raw?function(e){return e}:r.deserializer:JSON.parse,o=n.useState((function(){try{var n=r?r.raw?String:r.serializer:JSON.stringify,s=localStorage.getItem(e);return null!==s?i(s):(t&&localStorage.setItem(e,n(t)),t)}catch(e){return t}})),u=o[0],l=o[1],c=n.useCallback((function(t){try{var n="function"==typeof t?t(u):t;if(void 0===n)return;var s;s=r?r.raw?"string"==typeof n?n:JSON.stringify(n):r.serializer?r.serializer(n):JSON.stringify(n):JSON.stringify(n),localStorage.setItem(e,s),l(i(s))}catch(e){}}),[e,l]),d=n.useCallback((function(){try{localStorage.removeItem(e),l(void 0)}catch(e){}}),[e,l]);return[u,c,d]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDeepEqual=t.off=t.on=t.isClient=void 0;var n=r(14).__importDefault(r(19));t.isClient="object"==typeof window,t.on=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return e.addEventListener.apply(e,t)},t.off=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return e.removeEventListener.apply(e,t)},t.isDeepEqual=n.default},function(e,t,r){"use strict";e.exports=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var n,s,a;if(Array.isArray(t)){if((n=t.length)!=r.length)return!1;for(s=n;0!=s--;)if(!e(t[s],r[s]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((n=(a=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(s=n;0!=s--;)if(!Object.prototype.hasOwnProperty.call(r,a[s]))return!1;for(s=n;0!=s--;){var i=a[s];if(!("_owner"===i&&t.$$typeof||e(t[i],r[i])))return!1}return!0}return t!=t&&r!=r}},function(e,t,r){"use strict";r.r(t),r.d(t,"KubernetesSecurityRoutes",(function(){return Le})),r.d(t,"default",(function(){return Le}));var n=r(1),s=r.n(n),a=r(11),i=r(17),o=r.n(i),u=r(3),l=r(8),c=r(9),d=r(10);const b="/internal/kubernetes_security/aggregate",g="process.entry_leader.interactive",p="process.entry_leader.user.id",m="process.entry_leader.entity_id",j="orchestrator.cluster.id",x="orchestrator.cluster.name",f="orchestrator.namespace",y="cloud.instance.name",h="orchestrator.resource.name",O="container.image.name",k="CountNodesWidgets",v='{"bool":{"must":[],"filter":[],"should":[],"must_not":[]}}',w='{"bool":{"must":[],"filter":[{"bool": {"should": [{"exists": {"field": "process.entry_leader.entity_id"}}]}}],"should":[],"must_not":[]}}',S={bool:{should:[{exists:{field:m}}],minimum_should_match:1}};var I=r(0);const B=(...e)=>{const t=Object(u.useEuiTheme)(...e),r=Object(n.useMemo)((()=>{const e="DARK"===t.colorMode?d.euiDarkVars:d.euiLightVars,r={euiColorVis6_asText:Object(u.shade)(e.euiColorVis6,.335),buttonsBackgroundNormalDefaultPrimary:"#006DE4"};return{...e,...r}}),[t.colorMode]);return{...t,euiVars:r}};var T=r(7);const N=()=>{const{data:e,timelines:t}=Object(T.useKibana)().services,{getFilterForValueButton:r,getFilterOutValueButton:s,getCopyButton:a}=t.getHoverActions();return{getFilterForValueButton:r,getFilterOutValueButton:s,getCopyButton:a,filterManager:Object(n.useMemo)((()=>e.query.filterManager),[e.query.filterManager])}};var E=r(12),M=r.n(E);const C=(e,t,r)=>{if(!e||isNaN(Date.parse(t))||isNaN(Date.parse(r)))return w;try{const n=JSON.parse(e);if(!n.bool)throw new Error("Field 'bool' does not exist in query.");const s={range:{"@timestamp":{gte:t,lte:r}}};return n.bool.filter?n.bool.filter=[S,...n.bool.filter,s]:n.bool.filter=[s],JSON.stringify(n)}catch{return w}};var F=r(2);const _=({title:e,dataValueMap:t,widgetKey:r,indexPattern:s,globalFilter:a,groupedBy:i,countBy:o,onReduce:l})=>{const[c,d]=Object(n.useState)(null),g=(()=>{const{euiTheme:e}=B();return Object(n.useMemo)((()=>{const{size:t,colors:r,font:n,border:s}=e;return{container:{padding:t.base,border:s.thin,borderRadius:s.radius.medium,overflow:"auto",position:"relative"},title:{marginBottom:t.m},dataInfo:{marginBottom:t.xs,display:"flex",alignItems:"center",height:"18px"},dataValue:{fontWeight:n.weight.semiBold,marginLeft:"auto"},filters:{marginLeft:t.s},percentageBackground:{position:"relative",backgroundColor:r.lightShade,height:t.xs,borderRadius:s.radius.small},percentageBar:{position:"absolute",height:t.xs,borderRadius:s.radius.small},loadingSpinner:{alignItems:"center",margin:`${t.xs} auto ${t.xl} auto`}}}),[e])})(),p=Object(n.useMemo)((()=>C(a.filterQuery,a.startDate,a.endDate)),[a.filterQuery,a.startDate,a.endDate]),{data:m,isLoading:j}=((e,t,r,n,s,a)=>{const{http:i}=Object(T.useKibana)().services,o=["kubernetesSecurityPercentWidget",r,t,n,s,a];return Object(F.useQuery)(o,(async()=>{const r=await i.get(b,{query:{query:t,groupBy:n,countBy:s,page:0,index:a}});return e(r)}))})(l,p,r,i,o,null==s?void 0:s.title),{getFilterForValueButton:x,getFilterOutValueButton:f,filterManager:y}=N(),h=Object(n.useMemo)((()=>m?Object.keys(m).reduce(((e,t)=>e+m[t]),0):0),[m]),O=Object(n.useMemo)((()=>{const e={filterForButtons:[],filterOutButtons:[]};return Object.keys(t).forEach((r=>{t[r].shouldHideFilter||(e.filterForButtons.push(x({field:t[r].fieldName,filterManager:y,size:"xs",onClick:()=>{},onFilterAdded:()=>{},ownFocus:!1,showTooltip:!0,value:[r]})),e.filterOutButtons.push(f({field:t[r].fieldName,filterManager:y,size:"xs",onClick:()=>{},onFilterAdded:()=>{},ownFocus:!1,showTooltip:!0,value:[r]})))})),e}),[t,y,x,f]);return Object(I.jsx)("div",{css:g.container},j&&Object(I.jsx)(u.EuiProgress,{size:"xs",color:"accent",position:"absolute","data-test-subj":"kubernetesSecurity:percentWidgetLoading"}),Object(I.jsx)("div",{css:g.title},e),Object(I.jsx)(u.EuiFlexGroup,{direction:"column",gutterSize:"s"},Object.keys(t).map(((e,r)=>{const n=(null==m?void 0:m[e])||0;return Object(I.jsx)(u.EuiFlexItem,{key:`percentage-widget--${t[e].name}`,onMouseEnter:()=>d(r),onMouseLeave:()=>d(null),"data-test-subj":"kubernetesSecurity:percentWidgetData"},Object(I.jsx)(u.EuiText,{size:"xs",css:g.dataInfo},t[e].name,c===r&&Object(I.jsx)("div",{css:g.filters},O.filterForButtons[r],O.filterOutButtons[r]),Object(I.jsx)("span",{css:g.dataValue},n)),Object(I.jsx)("div",{css:g.percentageBackground},Object(I.jsx)("div",{css:Object(I.css)({...g.percentageBar,width:100*(n/h||0)+"%",backgroundColor:t[e].color},"","")})))}))))};function P(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}const V=({title:e,widgetKey:t,indexPattern:r,globalFilter:s,groupedBy:a})=>{const i=(()=>{const{euiTheme:e}=B();return Object(n.useMemo)((()=>{const{size:t,font:r,border:n}=e;return{container:{padding:t.base,border:n.thin,borderRadius:n.radius.medium,overflow:"auto",position:"relative",height:"100%"},title:{marginBottom:t.s,fontSize:t.m,fontWeight:r.weight.bold,whiteSpace:"nowrap"},dataInfo:{fontSize:`calc(${t.l} - ${t.xxs})`,lineHeight:t.l,fontWeight:r.weight.bold},dataValue:{fontWeight:r.weight.semiBold,marginLeft:"auto"},filters:{marginLeft:t.s},loadingSpinner:{alignItems:"center",margin:`${t.xs} auto ${t.xl} auto`}}}),[e])})(),o=Object(n.useMemo)((()=>{let e=s.filterQuery;return"CountPodsWidgets"===t&&(e=((e,t)=>{let r=v;try{var n;const t=JSON.parse(e||"{}");if(null==t||null===(n=t.bool)||void 0===n||!n.filter||!Array.isArray(t.bool.filter))throw new Error("Invalid filter query");t.bool.filter.push({bool:{should:[{match_phrase:{"orchestrator.resource.type":"pod"}}]}}),r=JSON.stringify(t)}catch{}return r})(s.filterQuery)),C(e,s.startDate,s.endDate)}),[s.filterQuery,s.startDate,s.endDate,t]),{data:l,isLoading:c}=((e,t,r,n)=>{const{http:s}=Object(T.useKibana)().services,a=["kubernetesSecurityCountWidget",e,t,r,n];return Object(F.useInfiniteQuery)(a,(async()=>await s.get("/internal/kubernetes_security/count",{query:{query:t,field:r,index:n}})),{refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1})})(t,o,a,null==r?void 0:r.title),d=Object(n.useMemo)((()=>l?null==l?void 0:l.pages[0]:0),[l]),b=Object(n.useMemo)((()=>(e=>{if(Number.isFinite(e)&&e>=0){if(e>=999999999999999){const t=1e12*Math.floor(e/1e12);return new Intl.NumberFormat("en-GB",{notation:"compact",compactDisplay:"short"}).format(t)}if(e>=999999999999){const t=1e9*Math.floor(e/1e9);return new Intl.NumberFormat("en-GB",{notation:"compact",compactDisplay:"short"}).format(t)}if(e>=999999999){const t=1e6*Math.floor(e/1e6);return new Intl.NumberFormat("en-GB",{notation:"compact",compactDisplay:"short"}).format(t)}if(e>=999999){const t=1e3*Math.floor(e/1e3);return new Intl.NumberFormat("en-GB",{notation:"compact",compactDisplay:"short"}).format(t)}if(e>=999){const t=1e3*Math.floor(e/1e3);return new Intl.NumberFormat("en-GB",{notation:"compact",compactDisplay:"short"}).format(t)}return e<1e3?e.toString():new Intl.NumberFormat("en-GB",{notation:"compact",compactDisplay:"short"}).format(e)}return"NaN"})(d)),[d]);return Object(I.jsx)("div",{css:i.container},Object(I.jsx)("div",{css:i.title},e),Object(I.jsx)(u.EuiToolTip,{content:c?null:P(d),"data-test-subj":"kubernetesSecurity:countWidgetTooltip","aria-label":"Info",position:"top"},Object(I.jsx)(u.EuiText,{css:i.dataInfo,"data-test-subj":"kubernetesSecurity:countWidgetValue"},c?Object(I.jsx)(u.EuiLoadingSpinner,{size:"l","data-test-subj":"kubernetesSecurity:countWidgetLoading"}):b)))},W=l.i18n.translate("xpack.kubernetesSecurity.beta",{defaultMessage:"Beta"}),R=(l.i18n.translate("xpack.kubernetesSecurity.searchGroup.cluster",{defaultMessage:"Cluster"}),l.i18n.translate("xpack.kubernetesSecurity.searchGroup.groupBy",{defaultMessage:"Group by"}),l.i18n.translate("xpack.kubernetesSecurity.searchGroup.sortBy",{defaultMessage:"Sort by"}),l.i18n.translate("xpack.kubernetesSecurity.treeView.logicalView",{defaultMessage:"Logical view"})),D=l.i18n.translate("xpack.kubernetesSecurity.treeView.infrastructureView",{defaultMessage:"Infrastructure view"}),z=l.i18n.translate("xpack.kubernetesSecurity.treeView.switherLegend",{defaultMessage:"You can switch between the Logical and Infrastructure view"}),L=l.i18n.translate("xpack.kubernetesSecurity.treeNavigation.loading",{defaultMessage:"Loading"}),$=e=>l.i18n.translate("xpack.kubernetesSecurity.treeNavigation.loadMore",{values:{name:e},defaultMessage:"Show more {name}"}),A=l.i18n.translate("xpack.kubernetesSecurity.treeNavigation.collapse",{defaultMessage:"Collapse Tree Navigation"}),G=l.i18n.translate("xpack.kubernetesSecurity.treeNavigation.expand",{defaultMessage:"Expand Tree Navigation"}),q=l.i18n.translate("xpack.kubernetesSecurity.chartsToggle.show",{defaultMessage:"Show charts"}),K=l.i18n.translate("xpack.kubernetesSecurity.chartsToggle.hide",{defaultMessage:"Hide charts"}),H=l.i18n.translate("xpack.kubernetesSecurity.countWidget.clusters",{defaultMessage:"Clusters"}),Q=l.i18n.translate("xpack.kubernetesSecurity.countWidget.namespace",{defaultMessage:"Namespace"}),J=l.i18n.translate("xpack.kubernetesSecurity.countWidget.nodes",{defaultMessage:"Nodes"}),U=l.i18n.translate("xpack.kubernetesSecurity.countWidget.pods",{defaultMessage:"Pods"}),Y=l.i18n.translate("xpack.kubernetesSecurity.countWidget.containerImages",{defaultMessage:"Container Images"}),X=l.i18n.translate("xpack.kubernetesSecurity.containerNameWidget.containerImage",{defaultMessage:"Container images"}),Z=l.i18n.translate("xpack.kubernetesSecurity.containerNameWidget.containerImageCountColumn",{defaultMessage:"Session count"}),ee=l.i18n.translate("xpack.kubernetesSecurity.containerNameWidget.containerImageAriaLabel",{defaultMessage:"Container Name Session Widget"});var te=r(15),re=r.n(te);const ne={clusterId:j,clusterName:x,namespace:f,node:y,pod:h,containerImage:O},se={clusterId:{type:"cluster",euiVarColor:"euiColorVis0"},clusterName:{type:"cluster",euiVarColor:"euiColorVis0"},namespace:{type:"namespace",euiVarColor:"euiColorVis1"},node:{type:"kubernetesNode",euiVarColor:"euiColorVis3"},pod:{type:"kubernetesPod",euiVarColor:"euiColorVis9"},containerImage:{type:"container",euiVarColor:"euiColorVis8"}},ae=e=>{const{euiTheme:t}=B();return Object(n.useMemo)((()=>{const{size:r,colors:n}=t;return{loadMoreButton:{position:"relative",cursor:"pointer",zIndex:2},loadMoreButtonWrapper:{position:"relative",textAlign:"center",width:`calc(100% + ${24*e}px)`,marginLeft:`-${24*e}px`,"&:after":{content:"''",position:"absolute",top:"50%",width:"100%",border:`1px dashed ${n.mediumShade}`,left:0}},loadMoreText:{marginRight:r.s},loadMoreTextLeft:{marginLeft:r.s},leafNodeButton:{marginLeft:r.l,width:`calc(100% - ${r.l})`,paddingLeft:0},labelIcon:{marginRight:r.s,marginLeft:r.s},treeViewWrapper:e=>({display:e?"inherit":"none",".euiTreeView__node--selected > .euiTreeView__nodeInner":{backgroundColor:Object(u.transparentize)(n.darkestShade,.1)},".euiTreeView__node--expanded":{maxHeight:"100%"},".euiTreeView__nodeInner .euiToolTipAnchor":{maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",wordWrap:"normal"}})}}),[t,e])},ie=e=>{e.preventDefault(),e.stopPropagation()},oe=(e,t,r)=>{const n=Array.from(document.querySelectorAll(t)),s=n.indexOf(e.currentTarget);if(s>-1){const t=n[s+("next"===r?1:-1)];t&&(ie(e),t.focus())}},ue=({globalFilter:e,indexPattern:t})=>{const[r,s]=Object(n.useState)(!1),[a,i]=Object(n.useState)({}),[o,u]=Object(n.useState)(!1),l=Object(n.useMemo)((()=>JSON.parse(C(e.filterQuery,e.startDate,e.endDate))),[e.filterQuery,e.startDate,e.endDate]),c=Object(n.useCallback)((e=>{u(!1),i(e)}),[]),d=Object(n.useMemo)((()=>((e,t)=>{let r=v;try{var n;const s=JSON.parse(e||"{}");if(null==s||null===(n=s.bool)||void 0===n||!n.filter||!Array.isArray(s.bool.filter))throw new Error("Invalid filter query");s.bool.filter.push(...Object.entries(t).filter((([e])=>"clusterName"!==e)).map((e=>{const[t,r]=e;return{bool:{should:[{match:{[ne[t]]:r}}]}}}))),r=JSON.stringify(s)}catch{}return r})(e.filterQuery,a)),[e.filterQuery,a]);return Object(n.useEffect)((()=>{s(!1),i({})}),[l]),Object(n.useEffect)((()=>{a.clusterId&&(u(!0),i(a))}),[a]),{noResults:r,setNoResults:s,filterQueryWithTimeRange:l,indexPattern:(null==t?void 0:t.title)||"",onTreeNavSelect:c,hasSelection:o,treeNavSelection:a,sessionViewFilter:d}},le=Object(n.createContext)(null),ce=()=>{const e=Object(n.useContext)(le);if(!e)throw new Error("useTreeViewContext must be called within an TreeViewContextProvider");return e},de=({children:e,...t})=>Object(I.jsx)(le.Provider,{value:ue(t)},e),be=({euiVarColor:e,...t})=>{const{euiVars:r}=B(),n=r[e]?{style:{color:r[e]}}:{};return Object(I.jsx)(u.EuiIcon,re()({},t,n))},ge="kubernetesSecurity:dynamicTreeViewButton",pe=e=>{oe(e,`[data-test-subj="${ge}"]`,"next")},me=e=>{oe(e,`[data-test-subj="${ge}"]`,"prev")},je=({children:e})=>{const[t,r]=Object(n.useState)(!1);return e({isExpanded:t,onToggleExpand:()=>{r((e=>!e))}})},xe=({tree:e,depth:t=0,selectionDepth:r={},query:s,onSelect:a,selected:i="",expanded:o=!0,...l})=>{var c;const d=ae(t),{indexPattern:g,setNoResults:p}=ce(),{data:m,fetchNextPage:j,isFetchingNextPage:f,hasNextPage:y,isLoading:h}=((e,t,r,n)=>{const{http:s}=Object(T.useKibana)().services,a=["kubernetesSecurityProcessEvents",e,t,r];return Object(F.useInfiniteQuery)(a,(async({pageParam:n=0})=>{if(t===ne.clusterId){const{buckets:a}=await s.get("/internal/kubernetes_security/multi_terms_aggregate",{query:{query:JSON.stringify(e),groupBys:JSON.stringify([{field:t},{field:x,missing:""}]),page:n,perPage:50,index:r}});return{buckets:a.map((e=>({...e,key_as_string:e.key[1],key:e.key[0]})))}}return await s.get(b,{query:{query:JSON.stringify(e),groupBy:t,page:n,perPage:50,index:r}})}),{enabled:n,getNextPageParam:(e,t)=>e.hasNextPage?t.length:void 0})})(s,e[t].key,g,o),O=l["aria-label"];Object(n.useEffect)((()=>{var e;0===t&&m&&0===(null===(e=m.pages)||void 0===e?void 0:e[0].buckets.length)&&p(!0)}),[m,t,p]),Object(n.useEffect)((()=>{o&&j()}),[j,o]),Object(n.useEffect)((()=>{var r,n,s;!i&&!t&&m&&null!==(r=m.pages)&&void 0!==r&&null!==(n=r[0].buckets)&&void 0!==n&&null!==(s=n[0])&&void 0!==s&&s.key&&a({},e[t].type,m.pages[0].buckets[0].key,m.pages[0].buckets[0].key_as_string)}),[m,t,i,a,e]);const k=Object(n.useMemo)((()=>{var e;return(null==m||null===(e=m.pages)||void 0===e?void 0:e.map((e=>null==e?void 0:e.buckets)).flat())||[]}),[null==m?void 0:m.pages]);return Object(I.jsx)(u.EuiText,{size:"s",className:"euiTreeView__wrapper "+(o?"":"euiTreeView__wrapper--hidden"),css:d.treeViewWrapper(o)},h&&Object(I.jsx)("div",null,Object(I.jsx)(u.EuiLoadingSpinner,{size:"s"}),Object(I.jsx)("span",{css:d.loadMoreTextLeft},L)),0===t&&Object(I.jsx)(u.EuiI18n,{token:"euiTreeView.listNavigationInstructions",default:"You can quickly navigate this list using arrow keys."},(e=>Object(I.jsx)(u.EuiScreenReaderOnly,null,Object(I.jsx)("p",{id:"dynamicTreeViewInstructionId"},e)))),Object(I.jsx)("ul",{className:"euiTreeView","aria-describedby":null!=m&&null!==(c=m.pages)&&void 0!==c&&c.length?"dynamicTreeViewInstructionId":void 0,"aria-label":O},k.map((n=>{const u={...s,bool:{...s.bool,filter:[...s.bool.filter,{term:{[e[t].key]:n.key}}]}};return Object(I.jsx)(je,{key:n.key},(({isExpanded:s,onToggleExpand:l})=>Object(I.jsx)(fe,{aggData:n,"aria-label":O,depth:t,expanded:o,isExpanded:s,onSelect:a,onToggleExpand:l,query:u,selected:i,selectionDepth:r,tree:e})))})),y&&Object(I.jsx)("li",{key:"load_more",className:"euiTreeView__node",css:d.loadMoreButtonWrapper},Object(I.jsx)(u.EuiBadge,{css:d.loadMoreButton,onClickAriaLabel:$(e[t].namePlural),"data-test-subj":ge,onKeyDown:e=>(e=>{switch(e.key){case u.keys.ARROW_DOWN:pe(e);break;case u.keys.ARROW_UP:me(e);break;case u.keys.ARROW_RIGHT:ie(e),j()}})(e),onClick:()=>{j()}},Object(I.jsx)("span",{css:d.loadMoreText},f?L:$(e[t].namePlural)),f?Object(I.jsx)(u.EuiLoadingSpinner,{size:"s"}):Object(I.jsx)(u.EuiIcon,{size:"s",type:"arrowDown"})))))},fe=({depth:e,tree:t,onToggleExpand:r,onSelect:s,aggData:a,selectionDepth:i,isExpanded:o,selected:l,expanded:c,query:d,...b})=>{const g=e===t.length-1,p=ae(e),m=Object(n.useRef)({}),j=()=>{"clusterId"===t[e].type?s(i,t[e].type,a.key,a.key_as_string):s(i,t[e].type,a.key)},x=()=>{g||r(),j()},f=Object(n.useMemo)((()=>l===Object.entries({...i,[t[e].type]:a.key,..."clusterId"===t[e].type&&a.key_as_string&&{clusterName:a.key_as_string}}).map((([e,t])=>`${e}.${t}`)).join()),[a.key,a.key_as_string,e,l,i,t]);return Object(I.jsx)("li",{className:`euiTreeView__node\n        ${o?"euiTreeView__node--expanded":""}\n        ${f?"euiTreeView__node--selected":""}\n      `},Object(I.jsx)("button",{"data-test-subj":c?ge:"",className:"euiTreeView__nodeInner euiTreeView__nodeInner--withArrows",onClick:()=>{g||o||r(),j()},onKeyDown:e=>{switch(e.key){case u.keys.ARROW_DOWN:pe(e);break;case u.keys.ARROW_UP:me(e);break;case u.keys.ARROW_RIGHT:o||g||(ie(e),x());break;case u.keys.ARROW_LEFT:o&&(ie(e),x())}},ref:e=>m.current[a.key]=e,css:g?p.leafNodeButton:void 0},!g&&Object(I.jsx)(u.EuiIcon,{className:"euiTreeView__expansionArrow",type:o?"arrowDown":"arrowRight",onClick:e=>{ie(e),g||r()}}),Object(I.jsx)(be,re()({},t[e].iconProps,{css:p.labelIcon})),Object(I.jsx)(u.EuiToolTip,{content:a.key},Object(I.jsx)("span",{className:"euiTreeView__nodeLabel"},a.key_as_string||a.key))),Object(I.jsx)("div",{onKeyDown:e=>((e,t)=>{e.key===u.keys.ARROW_LEFT&&(ie(e),m.current[t].focus())})(e,a.key.toString())},!g&&Object(I.jsx)(xe,{expanded:o,query:d,depth:e+1,selectionDepth:{...i,[t[e].type]:a.key,..."clusterId"===t[e].type&&{clusterName:a.key_as_string}},tree:t,onSelect:s,selected:l,"aria-label":`${a.key} child of ${b["aria-label"]}`})))},ye=(e=!1)=>l.i18n.translate("xpack.kubernetesSecurity.treeNav.cluster",{defaultMessage:"{isPlural, plural, =true {clusters} other {cluster}}",values:{isPlural:e}}),he=(e=!1)=>l.i18n.translate("xpack.kubernetesSecurity.treeNav.namespace",{defaultMessage:"{isPlural, plural, =true {namespaces} other {namespace}}",values:{isPlural:e}}),Oe=(e=!1)=>l.i18n.translate("xpack.kubernetesSecurity.treeNav.pod",{defaultMessage:"{isPlural, plural, =true {pods} other {pod}}",values:{isPlural:e}}),ke=(e=!1)=>l.i18n.translate("xpack.kubernetesSecurity.treeNav.containerImage",{defaultMessage:"{isPlural, plural, =true {container images} other { container image}}",values:{isPlural:e}}),ve=(e=!1)=>l.i18n.translate("xpack.kubernetesSecurity.treeNav.node",{defaultMessage:"{isPlural, plural, =true {nodes} other {node}}",values:{isPlural:e}}),we=[{key:ne.clusterId,iconProps:se.clusterId,type:"clusterId",name:ye(),namePlural:ye(!0)},{key:ne.namespace,iconProps:se.namespace,type:"namespace",name:he(),namePlural:he(!0)},{key:ne.pod,iconProps:se.pod,type:"pod",name:Oe(),namePlural:Oe(!0)},{key:ne.containerImage,iconProps:se.containerImage,type:"containerImage",name:ke(),namePlural:ke(!0)}],Se=we.map(((e,t)=>1===t?{key:ne.node,iconProps:se.node,type:"node",name:ve(),namePlural:ve(!0)}:e)),Ie={logical:we,infrastructure:Se},Be=()=>{const e=(()=>{const{euiTheme:e}=B();return Object(n.useMemo)((()=>{const{size:t}=e;return{treeViewSwitcher:{".euiButton__text":{fontSize:t.m}},treeViewContainer:{height:"600px",width:"288px",overflowY:"auto"},treeViewLegend:{textTransform:"capitalize"}}}),[e])})(),[t,r]=Object(n.useState)(Ie.logical),[a,i]=Object(n.useState)(""),[o,l]=Object(n.useState)(!1),c=Object(u.useGeneratedHtmlId)({prefix:"treeNavType"}),d=`${c}logical`,[b,g]=Object(n.useState)(d),{filterQueryWithTimeRange:p,onTreeNavSelect:m}=ce(),j=()=>{l(!o)},x=Object(n.useMemo)((()=>[{id:d,label:R,value:"logical"},{id:`${c}infrastructure`,label:D,value:"infrastructure"}]),[d,c]),f=Object(n.useMemo)((()=>x.find((e=>e.id===b)).label),[x,b]);return Object(I.jsx)(s.a.Fragment,null,o&&Object(I.jsx)(u.EuiToolTip,{content:G},Object(I.jsx)(u.EuiButtonIcon,{onClick:j,iconType:"menuRight","aria-label":G})),Object(I.jsx)("div",{style:{display:o?"none":"inherit"}},Object(I.jsx)(u.EuiFlexGroup,{responsive:!1,gutterSize:"s",alignItems:"center"},Object(I.jsx)(u.EuiFlexItem,null,Object(I.jsx)(u.EuiButtonGroup,{name:"coarsness",legend:z,options:x,idSelected:b,onChange:(e,t)=>{g(e),r(Ie[t])},buttonSize:"compressed",isFullWidth:!0,color:"primary",css:e.treeViewSwitcher})),Object(I.jsx)(u.EuiFlexItem,{grow:!1},Object(I.jsx)(u.EuiToolTip,{content:A},Object(I.jsx)(u.EuiButtonIcon,{onClick:j,iconType:"menuLeft","aria-label":A})))),Object(I.jsx)(u.EuiSpacer,{size:"xs"}),Object(I.jsx)(u.EuiText,{color:"subdued",size:"xs",css:e.treeViewLegend},t.map((e=>e.name)).join(" / ")),Object(I.jsx)(u.EuiSpacer,{size:"s"}),Object(I.jsx)("div",{css:e.treeViewContainer,className:"eui-scrollBar"},Object(I.jsx)(xe,{query:p,tree:t,"aria-label":f,selected:a,onSelect:(e,t,r,n)=>{const s={...e,[t]:r,...n&&{clusterName:n}};i(Object.entries(s).map((([e,t])=>`${e}.${t}`)).join()),m(s)}}))))},Te=({treeNavSelection:e,onSelect:t})=>{const r=(()=>{const{euiTheme:e}=B();return Object(n.useMemo)((()=>{const{colors:t,size:r,font:n,border:s}=e,a={borderBottom:s.thin,borderColor:t.lightShade,paddingBottom:r.s,marginBottom:r.m},i={height:"fit-content",maxWidth:"248px",fontSize:r.m,fontWeight:n.weight.regular,".euiButtonEmpty__content":{paddingLeft:r.xs,paddingRight:r.xs}};return{breadcrumb:a,breadcrumbButton:i,breadcrumbButtonBold:{...i,fontWeight:n.weight.semiBold},breadcrumbRightIcon:{marginRight:r.xs}}}),[e])})(),a=Object(n.useCallback)((r=>{const n={...e};switch(r){case"clusterId":t({clusterId:e.clusterId,clusterName:e.clusterName});break;case"namespace":case"node":delete n.pod,delete n.containerImage,t(n);break;case"pod":delete n.containerImage,t(n)}}),[t,e]),i=Object(n.useCallback)(((t,n,i,o=!0)=>{const l="clusterId"===t?e.clusterName||e.clusterId:e[t];return Object(I.jsx)(s.a.Fragment,null,o&&Object(I.jsx)(u.EuiIcon,{css:r.breadcrumbRightIcon,type:"arrowRight",size:"s"}),n,Object(I.jsx)(u.EuiToolTip,{content:l},Object(I.jsx)(u.EuiButtonEmpty,{css:i?r.breadcrumbButtonBold:r.breadcrumbButton,color:"text",onClick:()=>a(t)},l)))}),[a,r.breadcrumbButton,r.breadcrumbButtonBold,r.breadcrumbRightIcon,e]);return e.clusterId?Object(I.jsx)("div",{css:r.breadcrumb},i("clusterId",Object(I.jsx)(be,se.clusterId),!(e.namespace||e.node),!1),e.namespace&&i("namespace",Object(I.jsx)(be,se.namespace),!e.pod),e.node&&i("node",Object(I.jsx)(be,se.node),!e.pod),e.pod&&i("pod",Object(I.jsx)(be,se.pod),!e.containerImage),e.containerImage&&i("containerImage",Object(I.jsx)(be,se.containerImage),!0)):null};var Ne=r(16),Ee=r.n(Ne);const Me={maxWidth:500},Ce={height:262},Fe=()=>Object(I.jsx)(u.EuiPanel,{color:"subdued","data-test-subj":"kubernetesSecurity:treeEmptyState"},Object(I.jsx)(u.EuiFlexGroup,{css:Ce,alignItems:"center",justifyContent:"center"},Object(I.jsx)(u.EuiFlexItem,{grow:!1},Object(I.jsx)(u.EuiPanel,{hasBorder:!0,css:Me},Object(I.jsx)(u.EuiFlexGroup,null,Object(I.jsx)(u.EuiFlexItem,null,Object(I.jsx)(u.EuiText,{size:"s"},Object(I.jsx)(u.EuiTitle,null,Object(I.jsx)("h3",null,Object(I.jsx)(c.FormattedMessage,{id:"xpack.kubernetesSecurity.treeView.empty.title",defaultMessage:"No results match your search criteria"}))),Object(I.jsx)("p",null,Object(I.jsx)(c.FormattedMessage,{id:"xpack.kubernetesSecurity.treeView.empty.description",defaultMessage:"Try searching over a longer period of time or modifying your search"})))),Object(I.jsx)(u.EuiFlexItem,{grow:!1},Object(I.jsx)(u.EuiImage,{size:"200",alt:"",url:Ee.a}))))))),_e=({globalFilter:e,renderSessionsView:t,indexPattern:r})=>Object(I.jsx)(de,{indexPattern:r,globalFilter:e},Object(I.jsx)(Pe,{renderSessionsView:t})),Pe=({renderSessionsView:e})=>{const t=(()=>{const{euiTheme:e}=B();return Object(n.useMemo)((()=>{const{border:t}=e;return{outerPanel:{minHeight:"262px"},navPanel:{borderRight:t.thin},sessionsPanel:{overflowX:"auto"}}}),[e])})(),{hasSelection:r,treeNavSelection:a,sessionViewFilter:i,onTreeNavSelect:o,noResults:l}=ce();return Object(I.jsx)(u.EuiSplitPanel.Outer,{direction:"row",hasBorder:!0,borderRadius:"m",css:t.outerPanel},l?Object(I.jsx)(Fe,null):Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(u.EuiSplitPanel.Inner,{color:"subdued",grow:!1,css:t.navPanel},Object(I.jsx)(u.EuiText,null,Object(I.jsx)(Be,null))),Object(I.jsx)(u.EuiSplitPanel.Inner,{css:t.sessionsPanel},Object(I.jsx)(Te,{treeNavSelection:a,onSelect:o}),r&&e(i))))},Ve=({handleToggleHideCharts:e,shouldHideCharts:t=!1})=>Object(I.jsx)(u.EuiButtonEmpty,{onClick:e,iconType:t?"eye":"eyeClosed","data-test-subj":"kubernetesSecurity:chartToggle"},t?q:K),We=()=>{const{euiTheme:e}=B();return Object(n.useMemo)((()=>{const{size:t,colors:r}=e;return{container:{paddingTop:t.s,paddingBottom:t.s,paddingRight:t.base,paddingLeft:t.base,border:e.border.thin,borderRadius:e.border.radius.medium,overflow:"auto",height:"228px",position:"relative",marginBottom:t.l},dataInfo:{display:"flex",alignItems:"center",height:t.base,position:"relative"},filters:{marginLeft:t.s,position:"absolute",left:"50%",backgroundColor:r.emptyShade,borderRadius:e.border.radius.small,border:e.border.thin,bottom:"-25px",boxShadow:`0 ${t.xs} ${t.xs} ${Object(u.transparentize)(e.colors.shadow,.04)}`,display:"flex",zIndex:1},countValue:{fontSize:t.m},truncate:{width:"100%",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},flexWidth:{width:"100%"},cellPad:{paddingBottom:"5px",paddingTop:"5px"}}}),[e])},Re=({name:e,filterButtonIn:t,filterButtonOut:r,copyToClipboardButton:s})=>{const[a,i]=Object(n.useState)(!1),o=We();return Object(I.jsx)(u.EuiFlexItem,{onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),"data-test-subj":"kubernetesSecurity:containerNameSessionRow",css:o.flexWidth},Object(I.jsx)(u.EuiText,{size:"xs",css:o.dataInfo},Object(I.jsx)("div",{css:o.truncate},e),a&&Object(I.jsx)("div",{css:o.filters},t,r,s)))},De=({widgetKey:e,indexPattern:t,globalFilter:r,groupedBy:s,countBy:a})=>{const[i,o]=Object(n.useState)("count"),[l,c]=Object(n.useState)("desc"),d=We(),g=Object(n.useMemo)((()=>C(r.filterQuery,r.startDate,r.endDate)),[r.filterQuery,r.startDate,r.endDate]),{data:p,fetchNextPage:m,isFetchingNextPage:j,isLoading:x}=((e,t,r,n,s,a,i)=>{const{http:o}=Object(T.useKibana)().services,u=["kubernetesSecurityContainerNameWidget",t,e,r,n,a,void 0];return Object(F.useInfiniteQuery)(u,(async({pageParam:t=0})=>await o.get(b,{query:{query:e,groupBy:r,countBy:n,page:t,index:s,sortByCount:a}})),{refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1,getNextPageParam:(e,t)=>e.hasNextPage?t.length:void 0})})(g,e,s,a,null==t?void 0:t.title,l),f=Object(n.useCallback)((({sort:e={}})=>{const{field:t,direction:r}=e;o(t),c(r)}),[]),y={sort:{field:i,direction:l},enableAllColumns:!0},{getFilterForValueButton:h,getFilterOutValueButton:k,getCopyButton:v,filterManager:w}=N(),S=Object(n.useMemo)((()=>{var e,t;return{filterForButtons:(null==p||null===(e=p.pages)||void 0===e?void 0:e.map((e=>null==e?void 0:e.buckets.map((e=>h({field:O,filterManager:w,size:"xs",onClick:()=>{},onFilterAdded:()=>{},ownFocus:!1,showTooltip:!0,value:e.key}))))).flat())||[],filterOutButtons:(null==p||null===(t=p.pages)||void 0===t?void 0:t.map((e=>null==e?void 0:e.buckets.map((e=>k({field:O,filterManager:w,size:"xs",onClick:()=>{},onFilterAdded:()=>{},ownFocus:!1,showTooltip:!0,value:e.key}))))).flat())||[]}}),[p,h,k,w]),B=Object(n.useMemo)((()=>{var e;return{copyButtons:(null==p||null===(e=p.pages)||void 0===e?void 0:e.map((e=>null==e?void 0:e.buckets.map((e=>v({field:O,size:"xs",onClick:()=>{},ownFocus:!1,showTooltip:!0,value:e.key}))))).flat())||[]}}),[p,v]),E=Object(n.useMemo)((()=>{var e;return p?null==p||null===(e=p.pages)||void 0===e?void 0:e.map((e=>null==e?void 0:e.buckets.map((e=>{var t,r;return{name:e.key,count:P(null!==(t=null===(r=e.count_by_aggs)||void 0===r?void 0:r.value)&&void 0!==t?t:0)}})))).flat():[]}),[p]),_=Object(n.useMemo)((()=>[{field:"name",name:X,"data-test-subj":"kubernetesSecurity:containerImageNameSessionNameColumn",render:e=>{const t=E.findIndex((t=>t.name===e));return Object(I.jsx)(Re,{name:e,filterButtonIn:S.filterForButtons[t],filterButtonOut:S.filterOutButtons[t],copyToClipboardButton:B.copyButtons[t]})},align:"left",width:"67%",sortable:!1},{field:"count",name:Z,width:"33%","data-test-subj":"kubernetesSecurity:containerImageNameSessionCountColumn",render:e=>Object(I.jsx)("span",{css:d.countValue},e),sortable:!0,align:"right"}]),[S.filterForButtons,S.filterOutButtons,B.copyButtons,E,d]),V=Object(n.useRef)(null);!function({div:e,handler:t}){Object(n.useEffect)((()=>{if(e){const r=M.a.debounce((()=>{const r=function(e){return e?e.scrollTop:document.documentElement.scrollTop||document.body.scrollTop}(e),n=r+e.offsetHeight>e.scrollHeight-20;t(r,n)}),500);return e.onscroll=r,()=>{r.cancel(),e.onscroll=null}}}),[e,t])}({div:V.current,handler:(e,t)=>{!j&&t&&m()}});const W=Object(n.useMemo)((()=>({css:d.cellPad})),[d.cellPad]);return Object(I.jsx)("div",{"data-test-subj":"kubernetesSecurity:containerNameSessionTable",className:"eui-yScroll",css:d.container,ref:V},x&&Object(I.jsx)(u.EuiProgress,{size:"xs",color:"accent",position:"absolute","data-test-subj":"kubernetesSecurity:containerNameWidgetLoading"}),Object(I.jsx)(u.EuiBasicTable,{"aria-label":ee,items:E,columns:_,sorting:y,onChange:f,cellProps:W}))},ze=({filter:e,indexPattern:t,globalFilter:r,renderSessionsView:i})=>{const[b,x]=o()("kubernetesSecurity:shouldHideWidgets",!1),v=(()=>{const{euiTheme:e}=B();return Object(n.useMemo)((()=>{const{size:t,font:r}=e,n={marginBottom:t.l},s={marginRight:t.m},a={position:"absolute",bottom:t.base,left:t.base,width:`calc(100% - ${t.xl})`,fontSize:t.m,lineHeight:"18px",padding:`${t.xs} ${t.s}`,display:"flex"},i={position:"relative",border:e.border.thin,borderRadius:e.border.radius.medium,padding:t.base,height:"500px"},o={marginBottom:t.m};return{titleSection:n,titleText:{display:"flex",alignItems:"center"},titleActions:{marginLeft:"auto",flexDirection:"row",alignItems:"center"},updatedAt:s,widgetBadge:a,treeViewContainer:i,countWidgetsGroup:{...o,flexWrap:"wrap",[`@media (max-width:${e.breakpoint.xl}px)`]:{flexDirection:"column"}},leftWidgetsGroup:{[`@media (max-width:${e.breakpoint.xl}px)`]:{marginBottom:"0 !important"},minWidth:`calc(70% - ${t.xxxl})`},rightWidgetsGroup:{[`@media (max-width:${e.breakpoint.xl}px)`]:{marginTop:"0 !important"},minWidth:"30%"},widgetsBottomSpacing:o,percentageChartTitle:{marginRight:t.xs,display:"inline",fontWeight:r.weight.bold},widgetsGroup:{[`@media (max-width:${e.breakpoint.xl}px)`]:{flexDirection:"column"}},betaBadge:{marginLeft:t.m}}}),[e])})(),w=(e=>{const{timelines:t}=Object(T.useKibana)().services,r=Object(n.useMemo)((()=>Date.now()),[e]);return t.getLastUpdated({updatedAt:r||Date.now()})})(r),S=Object(n.useMemo)((()=>{var e;return{...r,filterQuery:JSON.stringify({...JSON.parse(null!==(e=null==r?void 0:r.filterQuery)&&void 0!==e?e:""),...JSON.parse('{"bool":{"must":[],"filter":[{"bool": {"should": [{"exists": {"field": "orchestrator.cluster.id"}}]}}],"should":[],"must_not":[]}}')})}}),[r]),N=Object(n.useCallback)((e=>e.buckets.reduce(((e,t)=>{var r,n;return e[t.key_as_string||t.key.toString()]=null!==(r=null===(n=t.count_by_aggs)||void 0===n?void 0:n.value)&&void 0!==r?r:0,e}),{})),[]),E=Object(n.useCallback)((e=>e.buckets.reduce(((e,t)=>{var r,n,s,a;return"0"===t.key.toString()?e[t.key]=null!==(r=null===(n=t.count_by_aggs)||void 0===n?void 0:n.value)&&void 0!==r?r:0:e.nonRoot=(e.nonRoot||0)+(null!==(s=null===(a=t.count_by_aggs)||void 0===a?void 0:a.value)&&void 0!==s?s:0),e}),{})),[]),M=Object(n.useCallback)((()=>{x(!b)}),[x,b]);return Object(I.jsx)(a.Switch,null,Object(I.jsx)(a.Route,{strict:!0,exact:!0,path:"/kubernetes"},e,Object(I.jsx)(u.EuiFlexGroup,{gutterSize:"none",css:v.titleSection},Object(I.jsx)(u.EuiFlexItem,null,Object(I.jsx)(u.EuiTitle,{size:"l"},Object(I.jsx)("h1",{css:v.titleText},"Kubernetes",Object(I.jsx)(u.EuiBetaBadge,{label:W,size:"s",css:v.betaBadge})))),Object(I.jsx)(u.EuiFlexItem,{grow:!1,css:v.titleActions},Object(I.jsx)("div",{css:v.updatedAt},w),Object(I.jsx)(Ve,{shouldHideCharts:b,handleToggleHideCharts:M}))),!b&&Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(u.EuiFlexGroup,{css:v.widgetsGroup},Object(I.jsx)(u.EuiFlexItem,{css:v.leftWidgetsGroup},Object(I.jsx)(u.EuiFlexGroup,{css:v.countWidgetsGroup},Object(I.jsx)(u.EuiFlexItem,null,Object(I.jsx)(V,{title:H,indexPattern:t,globalFilter:S,widgetKey:"CountClustersWidget",groupedBy:j})),Object(I.jsx)(u.EuiFlexItem,null,Object(I.jsx)(V,{title:Q,indexPattern:t,globalFilter:S,widgetKey:"CountNamespaceWidgets",groupedBy:f})),Object(I.jsx)(u.EuiFlexItem,null,Object(I.jsx)(V,{title:J,indexPattern:t,globalFilter:S,widgetKey:k,groupedBy:y})),Object(I.jsx)(u.EuiFlexItem,null,Object(I.jsx)(V,{title:U,indexPattern:t,globalFilter:S,widgetKey:k,groupedBy:h})),Object(I.jsx)(u.EuiFlexItem,null,Object(I.jsx)(V,{title:Y,indexPattern:t,globalFilter:S,widgetKey:"CountContainerImagesWidgets",groupedBy:O}))),Object(I.jsx)(u.EuiFlexGroup,{css:v.widgetsBottomSpacing},Object(I.jsx)(u.EuiFlexItem,null,Object(I.jsx)(_,{title:Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(u.EuiText,{size:"xs",css:v.percentageChartTitle},Object(I.jsx)(c.FormattedMessage,{id:"xpack.kubernetesSecurity.sessionChart.title",defaultMessage:"Session Interactivity"})),Object(I.jsx)(u.EuiIconTip,{content:Object(I.jsx)(c.FormattedMessage,{id:"xpack.kubernetesSecurity.sessionChart.tooltip",defaultMessage:"Interactive sessions have a controlling terminal and often imply that a human is entering the commands."})})),widgetKey:"sessionsPercentage",indexPattern:t,globalFilter:S,dataValueMap:{true:{name:l.i18n.translate("xpack.kubernetesSecurity.sessionChart.interactive",{defaultMessage:"Interactive"}),fieldName:g,color:d.euiThemeVars.euiColorVis0},false:{name:l.i18n.translate("xpack.kubernetesSecurity.sessionChart.nonInteractive",{defaultMessage:"Non-interactive"}),fieldName:g,color:d.euiThemeVars.euiColorVis1,shouldHideFilter:!0}},groupedBy:g,countBy:m,onReduce:N})),Object(I.jsx)(u.EuiFlexItem,null,Object(I.jsx)(_,{title:Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(u.EuiText,{size:"xs",css:v.percentageChartTitle},Object(I.jsx)(c.FormattedMessage,{id:"xpack.kubernetesSecurity.entryUserChart.title",defaultMessage:"Session Entry Users"})),Object(I.jsx)(u.EuiIconTip,{content:Object(I.jsx)(c.FormattedMessage,{id:"xpack.kubernetesSecurity.entryUserChart.tooltip",defaultMessage:"The session user is the initial Linux user associated with the session. This user may be set from authentication of a remote login or automatically for service sessions started by init."})})),widgetKey:"rootLoginPercentage",indexPattern:t,globalFilter:S,dataValueMap:{0:{name:l.i18n.translate("xpack.kubernetesSecurity.entryUserChart.root",{defaultMessage:"Root"}),fieldName:p,color:d.euiThemeVars.euiColorVis2},nonRoot:{name:l.i18n.translate("xpack.kubernetesSecurity.entryUserChart.nonRoot",{defaultMessage:"Non-root"}),fieldName:p,color:d.euiThemeVars.euiColorVis3,shouldHideFilter:!0}},groupedBy:p,countBy:m,onReduce:E})))),Object(I.jsx)(u.EuiFlexItem,{grow:!1,css:v.rightWidgetsGroup},Object(I.jsx)(De,{widgetKey:"containerNameSessions",indexPattern:t,globalFilter:S,groupedBy:O,countBy:m})))),Object(I.jsx)(_e,{globalFilter:S,renderSessionsView:i,indexPattern:t})))},Le=s.a.memo(ze)}]]);