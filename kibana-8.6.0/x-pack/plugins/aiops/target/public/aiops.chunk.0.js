/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.aiops_bundle_jsonpfunction=window.aiops_bundle_jsonpfunction||[]).push([[0],{142:function(e,t,r){"use strict";r.d(t,"a",(function(){return S}));var n=r(1),o=r(13),s=r(22),i=r(9),a=r(11),u=r.n(a),c=r(15),l=r.n(c);const d=new RegExp("^([0-9]*)\\s*("+l.a.units.join("|")+")$"),f=["ms","s","m","h"],b=["ms","s","m","h","d"],{duration:p}=u.a,m=l.a.unitsDesc,g=m.indexOf("w"),h=function(){const e=[[p(500,"ms"),p(100,"ms")],[p(5,"second"),p(1,"second")],[p(10,"second"),p(5,"second")],[p(15,"second"),p(10,"second")],[p(30,"second"),p(15,"second")],[p(1,"minute"),p(30,"second")],[p(5,"minute"),p(1,"minute")],[p(10,"minute"),p(5,"minute")],[p(15,"minute"),p(10,"minute")],[p(30,"minute"),p(10,"minute")],[p(1,"hour"),p(30,"minute")],[p(2,"hour"),p(1,"hour")],[p(4,"hour"),p(2,"hour")],[p(6,"hour"),p(4,"hour")],[p(8,"hour"),p(6,"hour")],[p(12,"hour"),p(8,"hour")],[p(24,"hour"),p(12,"hour")],[p(2,"d"),p(1,"d")],[p(4,"d"),p(2,"d")],[p(1,"week"),p(4,"d")],[p(1,"month"),p(1,"week")],[p(1,"year"),p(1,"month")],[1/0,p(1,"year")]].slice(0).reverse();function t(e,t,r){return function(n,o){const s=function(n,o){const s=o/n;let i;for(let n=0;n<e.length;n++){const o=e[n],a=t(o[0],o[1],s);if(null==a){if(!r)continue;if(i)return i;break}if(!r)return a;i=a}const a=Math.max(Math.floor(s),1);return u.a.duration(a,"ms")}(n,o);if(s)return u.a.duration(s._data)}}return{near:t(e,(function(e,t,r){if(e>r){if(e===1/0)return t;const n=e.asMilliseconds(),o=t.asMilliseconds();return Math.abs(n-r)<=Math.abs(o)?e:t}}),!0),lessThan:t(e,(function(e,t,r){if(t<r)return e!==1/0?e:t})),atLeast:t(e,(function(e,t,r){if(t<=r)return t}))}}();function j(e,t){this._timeBucketsConfig=e,this._fieldFormats=t,this.barTarget=this._timeBucketsConfig[o.UI_SETTINGS.HISTOGRAM_BAR_TARGET],this.maxBars=this._timeBucketsConfig[o.UI_SETTINGS.HISTOGRAM_MAX_BARS]}function y(e,t){const r=function(e){for(let t=0;t<m.length;t++){const r=m[t],n=e.as(r);if(n>=1&&Math.floor(n)===n){if(t<=g)continue;return{value:n,unit:r,expression:n+r}}}const t=e.as("ms");return{value:t,unit:"ms",expression:t+"ms"}}(e);e.esValue=r.value,e.esUnit=r.unit,e.expression=r.expression,e.overflow=t>e&&u.a.duration(e-t);const n=u.a.normalizeUnits(r.unit);return 1===r.value?e.description=n:e.description=`${r.value} ${n}s`,e}function O(e){return e&&"isValid"in e&&e.isValid()}j.prototype.setBarTarget=function(e){this.barTarget=e},j.prototype.setMaxBars=function(e){this.maxBars=e},j.prototype.setBounds=function(e){if(!e)return this.clearBounds();let t;t=Object(i.isPlainObject)(e)?[e.min,e.max]:Array.isArray(e)?e:[];const r=Object(i.sortBy)(t.map(Object(i.ary)(u.a,1)),Number);if(2!==r.length||!r.every(O))throw this.clearBounds(),new Error("invalid bounds set: "+e);if(this._lb=r.shift(),this._ub=r.pop(),this.getDuration().asSeconds()<0)throw new TypeError("Intervals must be positive")},j.prototype.clearBounds=function(){this._lb=this._ub=null},j.prototype.hasBounds=function(){return O(this._ub)&&O(this._lb)},j.prototype.getBounds=function(){if(this.hasBounds())return{min:this._lb,max:this._ub}},j.prototype.getDuration=function(){if(this.hasBounds())return u.a.duration(this._ub-this._lb,"ms")},j.prototype.setInterval=function(e){this.originalInterval=e;let t=e;if(t&&"auto"!==t){if(Object(i.isString)(t)&&(e=t,t=function(e,t=!1){const r=String(e).trim().match(d);if(!Array.isArray(r)||r.length<3)return null;try{const e=parseInt(r[1],10),n=r[2];return isNaN(e)||e<1&&-1===f.indexOf(n)||!0===t&&-1===b.indexOf(n)?null:Object(a.duration)(e,n)}catch(e){return null}}(t),0==+t&&(t=null)),!u.a.isDuration(t))throw new TypeError('"'+e+'" is not a valid interval.');this._i=t}else this._i="auto"},j.prototype.getInterval=function(){const e=this,t=e.getDuration();return y(function(r){if(!e.hasBounds())return r;const n=e.maxBars;let o;return t/r>n?(o=h.lessThan(n,t),+o==+r?r:(y(r,t),Object(i.assign)(o,{preScaled:r,scale:r/o,scaled:!0}))):r}(function(){const r=e._i;return u.a.isDuration(r)?r:h.near(e.barTarget,t)}()),t)},j.prototype.getIntervalToNearestMultiple=function(e){const t=this.getInterval(),r=t.asSeconds(),n=r%e;if(0===n)return t;let o=n>e/2?r+e-n:r-n;o=0===o?e:o;const s=u.a.duration(o,"seconds");y(s,this.getDuration());const i=t.preScaled;return void 0!==i&&i<s&&(s.preScaled=i,s.scale=i/s,s.scaled=!0),s},j.prototype.getScaledDateFormat=function(){const e=this.getInterval(),t=this._timeBucketsConfig["dateFormat:scaled"];for(let r=t.length-1;r>=0;r--){const n=t[r];if(!n[0]||e>=u.a.duration(n[0]))return n[1]}return this._timeBucketsConfig.dateFormat},j.prototype.getScaledDateFormatter=function(){return new(this._fieldFormats.getType(s.FIELD_FORMAT_IDS.DATE))({pattern:this.getScaledDateFormat()},this._timeBucketsConfig)};var v=r(29);const S=()=>{const{uiSettings:e}=Object(v.b)();return Object(n.useMemo)((()=>new j({[o.UI_SETTINGS.HISTOGRAM_MAX_BARS]:e.get(o.UI_SETTINGS.HISTOGRAM_MAX_BARS),[o.UI_SETTINGS.HISTOGRAM_BAR_TARGET]:e.get(o.UI_SETTINGS.HISTOGRAM_BAR_TARGET),dateFormat:e.get("dateFormat"),"dateFormat:scaled":e.get("dateFormat:scaled")})),[e])}},147:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isPopulatedObject=void 0,t.isPopulatedObject=(e,t=[])=>"object"==typeof e&&null!==e&&Object.keys(e).length>0&&(0===t.length||t.every((t=>({}.hasOwnProperty.call(e,t)))))},148:function(e,t,r){"use strict";const n=r(149),o=r(150),s=r(151);function i(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function a(e,t){return t.encode?t.strict?n(e):encodeURIComponent(e):e}function u(e,t){return t.decode?o(e):e}function c(e){return Array.isArray(e)?e.sort():"object"==typeof e?c(Object.keys(e)).sort(((e,t)=>Number(e)-Number(t))).map((t=>e[t])):e}function l(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function d(e){const t=(e=l(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function f(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function b(e,t){i((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const r=function(e){let t;switch(e.arrayFormat){case"index":return(e,r,n)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===n[e]&&(n[e]={}),n[e][t[1]]=r):n[e]=r};case"bracket":return(e,r,n)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==n[e]?n[e]=[].concat(n[e],r):n[e]=[r]:n[e]=r};case"comma":case"separator":return(t,r,n)=>{const o="string"==typeof r&&r.split("").indexOf(e.arrayFormatSeparator)>-1?r.split(e.arrayFormatSeparator).map((t=>u(t,e))):null===r?r:u(r,e);n[t]=o};default:return(e,t,r)=>{void 0!==r[e]?r[e]=[].concat(r[e],t):r[e]=t}}}(t),n=Object.create(null);if("string"!=typeof e)return n;if(!(e=e.trim().replace(/^[?#&]/,"")))return n;for(const o of e.split("&")){let[e,i]=s(t.decode?o.replace(/\+/g," "):o,"=");i=void 0===i?null:["comma","separator"].includes(t.arrayFormat)?i:u(i,t),r(u(e,t),i,n)}for(const e of Object.keys(n)){const r=n[e];if("object"==typeof r&&null!==r)for(const e of Object.keys(r))r[e]=f(r[e],t);else n[e]=f(r,t)}return!1===t.sort?n:(!0===t.sort?Object.keys(n).sort():Object.keys(n).sort(t.sort)).reduce(((e,t)=>{const r=n[t];return Boolean(r)&&"object"==typeof r&&!Array.isArray(r)?e[t]=c(r):e[t]=r,e}),Object.create(null))}t.extract=d,t.parse=b,t.stringify=(e,t)=>{if(!e)return"";i((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const r=r=>t.skipNull&&null==e[r]||t.skipEmptyString&&""===e[r],n=function(e){switch(e.arrayFormat){case"index":return t=>(r,n)=>{const o=r.length;return void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,[a(t,e),"[",o,"]"].join("")]:[...r,[a(t,e),"[",a(o,e),"]=",a(n,e)].join("")]};case"bracket":return t=>(r,n)=>void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,[a(t,e),"[]"].join("")]:[...r,[a(t,e),"[]=",a(n,e)].join("")];case"comma":case"separator":return t=>(r,n)=>null==n||0===n.length?r:0===r.length?[[a(t,e),"=",a(n,e)].join("")]:[[r,a(n,e)].join(e.arrayFormatSeparator)];default:return t=>(r,n)=>void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,a(t,e)]:[...r,[a(t,e),"=",a(n,e)].join("")]}}(t),o={};for(const t of Object.keys(e))r(t)||(o[t]=e[t]);const s=Object.keys(o);return!1!==t.sort&&s.sort(t.sort),s.map((r=>{const o=e[r];return void 0===o?"":null===o?a(r,t):Array.isArray(o)?o.reduce(n(r),[]).join("&"):a(r,t)+"="+a(o,t)})).filter((e=>e.length>0)).join("&")},t.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[r,n]=s(e,"#");return Object.assign({url:r.split("?")[0]||"",query:b(d(e),t)},t&&t.parseFragmentIdentifier&&n?{fragmentIdentifier:u(n,t)}:{})},t.stringifyUrl=(e,r)=>{r=Object.assign({encode:!0,strict:!0},r);const n=l(e.url).split("?")[0]||"",o=t.extract(e.url),s=t.parse(o,{sort:!1}),i=Object.assign(s,e.query);let u=t.stringify(i,r);u&&(u=`?${u}`);let c=function(e){let t="";const r=e.indexOf("#");return-1!==r&&(t=e.slice(r)),t}(e.url);return e.fragmentIdentifier&&(c=`#${a(e.fragmentIdentifier,r)}`),`${n}${u}${c}`}},149:function(e,t,r){"use strict";e.exports=e=>encodeURIComponent(e).replace(/[!'()*]/g,(e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`))},150:function(e,t,r){"use strict";var n="%[a-f0-9]{2}",o=new RegExp(n,"gi"),s=new RegExp("("+n+")+","gi");function i(e,t){try{return decodeURIComponent(e.join(""))}catch(e){}if(1===e.length)return e;t=t||1;var r=e.slice(0,t),n=e.slice(t);return Array.prototype.concat.call([],i(r),i(n))}function a(e){try{return decodeURIComponent(e)}catch(n){for(var t=e.match(o),r=1;r<t.length;r++)t=(e=i(t,r).join("")).match(o);return e}}e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"��","%FF%FE":"��"},r=s.exec(e);r;){try{t[r[0]]=decodeURIComponent(r[0])}catch(e){var n=a(r[0]);n!==r[0]&&(t[r[0]]=n)}r=s.exec(e)}t["%C2"]="�";for(var o=Object.keys(t),i=0;i<o.length;i++){var u=o[i];e=e.replace(new RegExp(u,"g"),t[u])}return e}(e)}}},151:function(e,t,r){"use strict";e.exports=(e,t)=>{if("string"!=typeof e||"string"!=typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===t)return[e];const r=e.indexOf(t);return-1===r?[e]:[e.slice(0,r),e.slice(r+t.length)]}},152:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(19),o=r(1),s=n.__importDefault(r(153));t.default=function(e,t){var r=o.useState(t),n=r[0],i=r[1];return s.default((function(){var t=e.subscribe(i);return function(){return t.unsubscribe()}}),[e]),n}},153:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o="undefined"!=typeof window?n.useLayoutEffect:n.useEffect;t.default=o},29:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return s}));var n=r(1);const o=Object(n.createContext)(void 0),s=()=>{const e=Object(n.useContext)(o);if(void 0===e)throw new Error("useAiopsAppContext was used outside of its Provider");return e}},43:function(e,t,r){"use strict";r.d(t,"b",(function(){return p})),r.d(t,"d",(function(){return m})),r.d(t,"a",(function(){return g})),r.d(t,"c",(function(){return h}));var n=r(1),o=r(148),s=r(17),i=r(21),a=r(9),u=r(0);const c=new Set(["_a","_g"]);function l(e){return c.has(e)}function d(e){const t={},r=Object(o.parse)(e,{sort:!1});try{Object.keys(r).forEach((e=>{l(e)?t[e]=Object(s.decode)(r[e]):t[e]=r[e]}))}catch(e){console.error("Could not read url state",e)}return t}const f=Object(n.createContext)({searchString:"",setUrlState:()=>{}}),{Provider:b}=f,p=({children:e})=>{const{Provider:t}=f,r=Object(i.useHistory)(),{search:c}=Object(i.useLocation)(),b=Object(n.useCallback)(((e,t,n,i)=>{const u=c,f=d(u),b=Object(o.parse)(u,{sort:!1});if(Object.prototype.hasOwnProperty.call(f,e)||(f[e]={}),"string"==typeof t){if(Object(a.isEqual)(((e,t,r)=>{const n=t.split(".").reduce(((e,t)=>null==e?void 0:e[t]),e);return void 0===n?void 0:n})(f,`${e}.${t}`),n))return u;f[e][t]=n}else{const r=t;Object.keys(r).forEach((t=>{f[e][t]=r[t]}))}try{const e=Object(o.stringify)(b,{sort:!1,encode:!1});if(Object.keys(f).forEach((e=>{l(e)?b[e]=Object(s.encode)(f[e]):b[e]=f[e]})),e!==Object(o.stringify)(b,{sort:!1,encode:!1})){const e=Object(o.stringify)(b,{sort:!1});i?r.replace({search:e}):r.push({search:e})}}catch(e){console.error("Could not save url state",e)}}),[r,c]);return Object(u.jsx)(t,{value:{searchString:c,setUrlState:b}},e)},m=e=>{const{searchString:t,setUrlState:r}=Object(n.useContext)(f);return[Object(n.useMemo)((()=>{const r=d(t);if("object"==typeof r)return r[e]}),[t]),Object(n.useCallback)(((t,n,o)=>{r(e,t,n,o)}),[e,r])]},g="AIOPS_INDEX_VIEWER",h=(e,t)=>{const[r,o]=m("_a"),s=null==r?void 0:r[e],i=Object(n.useMemo)((()=>({...null!=t?t:{},...null!=s?s:{}})),[s]),a=Object(n.useCallback)(((t,r)=>{o(e,{...i,...t},r)}),[e,i,o]);return Object(n.useMemo)((()=>[i,a]),[i,a])}},45:function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return l})),r.d(t,"c",(function(){return d}));var n=r(9),o=r(13),s=r(12),i=r(50);const a={bool:{must:[{match_all:{}}]}},u={KUERY:"kuery",LUCENE:"lucene"};function c(){return Object(n.cloneDeep)(a)}function l(e,t,r,n){let i=c();if(e&&e.language===u.KUERY){const n=Object(s.fromKueryExpression)(e.query);if(""!==e.query&&(i=Object(s.toElasticsearchQuery)(n,r)),void 0!==i.bool){const e=Object(s.buildQueryFromFilters)(t,r);Array.isArray(i.bool.filter)||(i.bool.filter=void 0===i.bool.filter?[]:[i.bool.filter]),Array.isArray(i.bool.must_not)||(i.bool.must_not=void 0===i.bool.must_not?[]:[i.bool.must_not]),i.bool.filter=[...i.bool.filter,...e.filter],i.bool.must_not=[...i.bool.must_not,...e.must_not]}}else i=Object(s.buildEsQuery)(r,e?[e]:[],t||[],n?Object(o.getEsQueryConfig)(n):void 0);return i}function d({dataView:e,uiSettings:t,savedSearch:r,query:s,filters:a,filterManager:u}){if(!e||!r)return;const d=s,f=a;if(r&&"searchSource"in r&&(null==r?void 0:r.searchSource)instanceof o.SearchSource&&void 0!==r.searchSource.getParent()&&d){var b,p,m;const e=null!==(b=Object(n.cloneDeep)(null===(p=r.searchSource.getSearchRequestBody())||void 0===p?void 0:p.query))&&void 0!==b?b:c(),t=null===(m=r.searchSource.getField("index"))||void 0===m?void 0:m.timeFieldName;return Array.isArray(e.bool.filter)&&void 0!==t&&(e.bool.filter=e.bool.filter.filter((e=>{var r;return!(e.hasOwnProperty("range")&&null!==(r=e.range)&&void 0!==r&&r.hasOwnProperty(t))}))),{searchQuery:e,searchString:d.query,queryLanguage:d.language}}const g=function(e){var t;const r=(n=e,Object(i.isPopulatedObject)(n,["id","type","attributes"])?null==e||null===(t=e.attributes)||void 0===t?void 0:t.kibanaSavedObjectMeta:null==e?void 0:e.kibanaSavedObjectMeta);var n;const o="string"==typeof(null==r?void 0:r.searchSourceJSON)?JSON.parse(r.searchSourceJSON):void 0;return o&&Array.isArray(o.filter)&&o.filter.forEach((e=>{e.meta.indexRefName=void 0})),o}(r);if(!g&&d)return u&&f&&u.addFilters(f),{searchQuery:l(d,Array.isArray(f)?f:[],e,t),searchString:d.query,queryLanguage:d.language};if(g){const r=null==u?void 0:u.getGlobalFilters(),n=null!=d?d:null==g?void 0:g.query,o=null!=f?f:null==g?void 0:g.filter;return u&&u.setFilters(o),r&&(null==u||u.addFilters(r)),{searchQuery:l(n,u?null==u?void 0:u.getFilters():o,e,t),searchString:n.query,queryLanguage:n.language}}}},50:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"isPopulatedObject",{enumerable:!0,get:function(){return n.isPopulatedObject}});var n=r(147)},51:function(e,t,r){"use strict";r.d(t,"c",(function(){return c})),r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return d}));var n=r(1),o=r(152),s=r.n(o),i=r(18),a=r(9),u=r(29);const c=({timeRangeSelector:e,autoRefreshSelector:t}={})=>{const{data:{query:{timefilter:{timefilter:r}}}}=Object(u.b)();return Object(n.useEffect)((()=>{!0!==e||r.isTimeRangeSelectorEnabled()?!1===e&&r.isTimeRangeSelectorEnabled()&&r.disableTimeRangeSelector():r.enableTimeRangeSelector(),!0!==t||r.isAutoRefreshSelectorEnabled()?!1===t&&r.isAutoRefreshSelectorEnabled()&&r.disableAutoRefreshSelector():r.enableAutoRefreshSelector()}),[e,t,r]),r},l=()=>{const e=c(),t=Object(n.useMemo)((()=>e.getRefreshIntervalUpdate$().pipe(Object(i.map)(e.getRefreshInterval))),[e]);return s()(t,e.getRefreshInterval())},d=(e=!1)=>{const t=c(),r=Object(n.useMemo)((()=>e?t.getAbsoluteTime.bind(t):t.getTime.bind(t)),[e,t]),o=Object(n.useMemo)((()=>t.getTimeUpdate$().pipe(Object(i.map)(r),Object(i.distinctUntilChanged)(a.isEqual))),[t,r]);return s()(o,r())}},89:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n=r(1),o=r(10),s=r(2),i=r(7),a=r(29),u=r(11),c=r.n(u),l=(r(15),r(50)),d=r(94);var f=r(0);const b="exclude-frozen",p=({timefilter:e,dataView:t,query:r,disabled:u,callback:p})=>{const{http:m,notifications:{toasts:g}}=Object(a.b)(),h=Object(n.useCallback)((async(t,r,n)=>{try{const o=await async function(e,t,r,n,o,s){const a=t.getRuntimeMappings(),u=await async function({index:e,timeFieldName:t,query:r,runtimeMappings:n,http:o}){const s=JSON.stringify({index:e,timeFieldName:t,query:r,runtimeMappings:n});return await o.fetch({path:"/internal/file_upload/time_field_range",method:"POST",body:s})}({index:t.getIndexPattern(),timeFieldName:t.timeFieldName,query:s?Object(d.a)(o):o,...Object(l.isPopulatedObject)(a)?{runtimeMappings:a}:{},http:n});return u.start.epoch&&u.end.epoch?e.setTime({from:c()(u.start.epoch).toISOString(),to:c()(u.end.epoch).toISOString()}):r.addWarning({title:i.i18n.translate("xpack.aiops.index.fullTimeRangeSelector.noResults",{defaultMessage:"No results match your search criteria"})}),u}(e,t,g,m,r,n);"function"==typeof p&&p(o)}catch(e){g.addDanger(i.i18n.translate("xpack.aiops.index.fullTimeRangeSelector.errorSettingTimeRangeNotification",{defaultMessage:"An error occurred setting the time range."}))}}),[p,m,e,g]),[j,y]=Object(n.useState)(!1),[O,v]=function(e,t){var r;const{storage:o}=Object(a.b)(),[s,i]=Object(n.useState)(null!==(r=o.get(e))&&void 0!==r?r:"exclude-frozen");return[s,Object(n.useCallback)((t=>{try{o.set(e,t),i(t)}catch(e){throw new Error("Unable to update storage with provided value")}}),[e,o])]}("aiops.frozenDataTierPreference"),S=Object(n.useCallback)((e=>{v(e),h(t,r,e===b),x()}),[t,r,v,h]),x=()=>{y(!1)},_=Object(n.useMemo)((()=>[{id:b,label:i.i18n.translate("xpack.aiops.index.fullTimeRangeSelector.useFullDataExcludingFrozenMenuLabel",{defaultMessage:"Exclude frozen data tier"})},{id:"include-frozen",label:i.i18n.translate("xpack.aiops.index.fullTimeRangeSelector.useFullDataIncludingFrozenMenuLabel",{defaultMessage:"Include frozen data tier"})}]),[]),E=Object(n.useMemo)((()=>Object(f.jsx)(s.EuiPanel,null,Object(f.jsx)(s.EuiRadioGroup,{options:_,idSelected:O,onChange:S,compressed:!0}))),[_,O,S]),R=Object(n.useMemo)((()=>O===b?Object(f.jsx)(o.FormattedMessage,{id:"xpack.aiops.fullTimeRangeSelector.useFullDataExcludingFrozenButtonTooltip",defaultMessage:"Use full range of data excluding frozen data tier."}):Object(f.jsx)(o.FormattedMessage,{id:"xpack.aiops.fullTimeRangeSelector.useFullDataIncludingFrozenButtonTooltip",defaultMessage:"Use full range of data including frozen data tier, which might have slower search results."})),[O]);return Object(f.jsx)(s.EuiFlexGroup,{responsive:!1,gutterSize:"xs",alignItems:"center"},Object(f.jsx)(s.EuiToolTip,{content:R},Object(f.jsx)(s.EuiButton,{isDisabled:u,onClick:()=>h(t,r,!0),"data-test-subj":"aiopsExplainLogRatesSpikeButtonUseFullData"},Object(f.jsx)(o.FormattedMessage,{id:"xpack.aiops.index.fullTimeRangeSelector.useFullDataButtonLabel",defaultMessage:"Use full data"}))),Object(f.jsx)(s.EuiFlexItem,{grow:!1},Object(f.jsx)(s.EuiPopover,{id:"mlFullTimeRangeSelectorOption",button:Object(f.jsx)(s.EuiButtonIcon,{display:"base",size:"m",iconType:"boxesVertical","aria-label":i.i18n.translate("xpack.aiops.index.fullTimeRangeSelector.moreOptionsButtonAriaLabel",{defaultMessage:"More options"}),onClick:()=>{y(!j)}}),isOpen:j,closePopover:x,panelPaddingSize:"none",anchorPosition:"downRight"},E)))}},90:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n=r(1),o=r(14),s=r(9),i=r(2),a=r(20),u=r(7),c=r(10),l=r(25),d=r(51),f=r(43),b=r(29),p=r(93),m=r(0);const g=5e3;function h(e){p.a.next({lastRefresh:Date.now(),timeRange:e})}var j={name:"1xelnrc",styles:"width:100%;min-width:0"},y={name:"1d3w5wq",styles:"width:100%"},O={name:"1xelnrc",styles:"width:100%;min-width:0"};const v=()=>{var e,t,r;const p=Object(b.b)(),{toasts:v}=p.notifications,S=p.uiSettings,{timefilter:x,history:_}=p.data.query.timefilter,E=p.theme.theme$,[R,I]=Object(f.d)("_g"),T=(F=_,function(){var e,t;return null!==(e=null===(t=F.get())||void 0===t?void 0:t.map((({from:e,to:t})=>({start:e,end:t}))))&&void 0!==e?e:[]});var F;const w=Object(d.a)(),M=Object(d.b)();Object(n.useEffect)((function(){void 0!==(null==R?void 0:R.time)&&x.setTime({from:R.time.from,to:R.time.to})}),[null==R||null===(e=R.time)||void 0===e?void 0:e.from,null==R||null===(t=R.time)||void 0===t?void 0:t.to,null==R||null===(r=R.time)||void 0===r?void 0:r.ts]),Object(n.useEffect)((function(){var e,t;void 0!==(null==R?void 0:R.refreshInterval)&&x.setRefreshInterval({pause:!(null==R||null===(e=R.refreshInterval)||void 0===e||!e.pause),value:null==R||null===(t=R.refreshInterval)||void 0===t?void 0:t.value})}),[null==R?void 0:R.refreshInterval]);const k=Object(n.useCallback)(Object(s.debounce)((e=>{I("refreshInterval",e,!0)}),200),[I]),[A,C]=Object(n.useState)(T()),[N,B]=Object(n.useState)(x.isAutoRefreshSelectorEnabled()),[P,U]=Object(n.useState)(x.isTimeRangeSelectorEnabled()),D=Object(n.useMemo)((()=>{var e;return null!==(e=null==R?void 0:R.refreshInterval)&&void 0!==e?e:w}),[JSON.stringify(null==R?void 0:R.refreshInterval),w]);Object(n.useEffect)((function(){const e=!(null==R||!R.refreshInterval);D.value<g&&!D.pause&&v.addWarning({title:e?u.i18n.translate("xpack.aiops.datePicker.shortRefreshIntervalURLWarningMessage",{defaultMessage:"The refresh interval in the URL is shorter than the minimum supported by Machine Learning."}):u.i18n.translate("xpack.aiops.datePicker.shortRefreshIntervalTimeFilterWarningMessage",{defaultMessage:"The refresh interval in Advanced Settings is shorter than the minimum supported by Machine Learning."}),text:Object(l.toMountPoint)(Object(l.wrapWithTheme)(Object(m.jsx)(i.EuiButton,{onClick:k.bind(null,{pause:D.pause,value:g})},Object(m.jsx)(c.FormattedMessage,{id:"xpack.aiops.index.pageRefreshResetButton",defaultMessage:"Set to {defaultInterval}",values:{defaultInterval:"5s"}})),E))},{toastLifeTimeMs:3e4})}),[JSON.stringify(D),JSON.stringify(null==R?void 0:R.refreshInterval),k]);const q=S.get("dateFormat"),G=S.get(a.UI_SETTINGS.TIMEPICKER_QUICK_RANGES),L=Object(n.useMemo)((()=>G.map((({from:e,to:t,display:r})=>({start:e,end:t,label:r})))),[G]);Object(n.useEffect)((()=>{const e=new o.Subscription,t=x.getEnabledUpdated$();return void 0!==t&&e.add(t.subscribe((e=>{B(x.isAutoRefreshSelectorEnabled()),U(x.isTimeRangeSelectorEnabled())}))),function(){e.unsubscribe()}}),[]);const $=Object(n.useCallback)((({start:e,end:t})=>{C(T()),I("time",{from:e,to:t,..."now"===e||"now"===t?{ts:Date.now()}:{}})}),[I]);return N||P?Object(m.jsx)(i.EuiFlexGroup,{gutterSize:"s",alignItems:"center",css:j},Object(m.jsx)(i.EuiFlexItem,{grow:!0,css:y},Object(m.jsx)(i.EuiSuperDatePicker,{css:O,start:M.from,end:M.to,isPaused:D.pause,isAutoRefreshOnly:!P,refreshInterval:D.value||g,onTimeChange:$,onRefresh:h,onRefreshChange:function({isPaused:e,refreshInterval:t}){k({pause:e,value:t})},recentlyUsedRanges:A,dateFormat:q,commonlyUsedRanges:L})),P?null:Object(m.jsx)(i.EuiFlexItem,{grow:!1},Object(m.jsx)(i.EuiButton,{fill:!0,color:"primary",iconType:"refresh",onClick:()=>h(),"data-test-subj":"aiOpsRefreshPageButton"},Object(m.jsx)(c.FormattedMessage,{id:"xpack.aiops.pageRefreshButton",defaultMessage:"Refresh"})))):null}},93:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));const n=new(r(14).Subject)},94:function(e,t,r){"use strict";r.d(t,"b",(function(){return s})),r.d(t,"a",(function(){return i}));var n=r(9),o=r(50);function s(e,t,r,n,o,s=!0,i){const a=[];e&&t&&r&&a.push({range:{[e]:{gte:t,lte:r,format:"epoch_millis"}}}),n&&"object"==typeof n&&a.push(n);const u=[];if(i){const e=[...i.group,...i.repeatedValues];for(const t of e){const{fieldName:e,fieldValue:r}=t;u.push({term:{[e]:r}})}}return s?o?a.push({term:{[o.fieldName]:o.fieldValue}}):i&&a.push(...u):o&&!s?a.push({bool:{must_not:[{term:{[o.fieldName]:o.fieldValue}}]}}):i&&!s&&a.push({bool:{must_not:[{bool:{filter:[...u]}}]}}),a}const i=e=>{const t={term:{_tier:{value:"data_frozen"}}};if(!e)return{bool:{must_not:[t]}};const r=Object(n.cloneDeep)(e);return delete r.match_all,Object(o.isPopulatedObject)(r.bool)?Array.isArray(r.bool.must_not)?r.bool.must_not.push(t):(Object(o.isPopulatedObject)(r.bool.must_not)&&(r.bool.must_not=[r.bool.must_not,t]),void 0===r.bool.must_not&&(r.bool.must_not=[t])):r.bool={must_not:[t]},r}}}]);