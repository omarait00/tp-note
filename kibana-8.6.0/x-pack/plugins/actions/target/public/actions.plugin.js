/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */!function(n){var t={};function e(r){if(t[r])return t[r].exports;var u=t[r]={i:r,l:!1,exports:{}};return n[r].call(u.exports,u,u.exports,e),u.l=!0,u.exports}e.m=n,e.c=t,e.d=function(n,t,r){e.o(n,t)||Object.defineProperty(n,t,{enumerable:!0,get:r})},e.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},e.t=function(n,t){if(1&t&&(n=e(n)),8&t)return n;if(4&t&&"object"==typeof n&&n&&n.__esModule)return n;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:n}),2&t&&"string"!=typeof n)for(var u in n)e.d(r,u,function(t){return n[t]}.bind(null,u));return r},e.n=function(n){var t=n&&n.__esModule?function(){return n.default}:function(){return n};return e.d(t,"a",t),t},e.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},e.p="",e(e.s=5)}([function(n,t){n.exports=__kbnSharedDeps__.KbnI18n},function(n,t){n.exports=__kbnSharedDeps__.Lodash},function(n,t,e){"use strict";e.r(t),e.d(t,"AlertingConnectorFeatureId",(function(){return u})),e.d(t,"CasesConnectorFeatureId",(function(){return i})),e.d(t,"UptimeConnectorFeatureId",(function(){return o})),e.d(t,"SecurityConnectorFeatureId",(function(){return a})),e.d(t,"InvalidEmailReason",(function(){return h})),e.d(t,"isActionTypeExecutorResult",(function(){return A})),e.d(t,"ALERT_HISTORY_PREFIX",(function(){return x})),e.d(t,"AlertHistoryDefaultIndexName",(function(){return C})),e.d(t,"AlertHistoryEsIndexConnectorId",(function(){return S})),e.d(t,"buildAlertHistoryDocument",(function(){return I})),e.d(t,"AlertHistoryDocumentTemplate",(function(){return O})),e.d(t,"MustacheInEmailRegExp",(function(){return E})),e.d(t,"hasMustacheTemplate",(function(){return j})),e.d(t,"withoutMustacheTemplate",(function(){return w})),e.d(t,"validateEmailAddressesAsAlwaysValid",(function(){return F})),e.d(t,"validateEmailAddresses",(function(){return T})),e.d(t,"invalidEmailsAsMessage",(function(){return N})),e.d(t,"AlertingConnectorFeature",(function(){return c})),e.d(t,"CasesConnectorFeature",(function(){return f})),e.d(t,"UptimeConnectorFeature",(function(){return d})),e.d(t,"SecuritySolutionFeature",(function(){return p})),e.d(t,"areValidFeatures",(function(){return g})),e.d(t,"getConnectorFeatureName",(function(){return v})),e.d(t,"getConnectorCompatibility",(function(){return b})),e.d(t,"BASE_ACTION_API_PATH",(function(){return P})),e.d(t,"INTERNAL_BASE_ACTION_API_PATH",(function(){return M})),e.d(t,"ACTIONS_FEATURE_ID",(function(){return R}));var r=e(0);const u="alerting",i="cases",o="uptime",a="siem",l=r.i18n.translate("xpack.actions.availableConnectorFeatures.compatibility.alertingRules",{defaultMessage:"Alerting Rules"}),s=r.i18n.translate("xpack.actions.availableConnectorFeatures.compatibility.cases",{defaultMessage:"Cases"}),c={id:u,name:r.i18n.translate("xpack.actions.availableConnectorFeatures.alerting",{defaultMessage:"Alerting"}),compatibility:l},f={id:i,name:r.i18n.translate("xpack.actions.availableConnectorFeatures.cases",{defaultMessage:"Cases"}),compatibility:s},d={id:o,name:r.i18n.translate("xpack.actions.availableConnectorFeatures.uptime",{defaultMessage:"Uptime"}),compatibility:l},p={id:a,name:r.i18n.translate("xpack.actions.availableConnectorFeatures.securitySolution",{defaultMessage:"Security Solution"}),compatibility:l},m={[c.id]:c,[f.id]:f,[d.id]:d,[p.id]:p};function g(n){return n.every((n=>!!m[n]))}function v(n){const t=m[n];return t?t.name:n}function b(n){const t=new Set;if(n&&n.length>0)for(const e of n)m[e]&&t.add(m[e].compatibility);return Array.from(t)}let h;!function(n){n.invalid="invalid",n.notAllowed="notAllowed"}(h||(h={}));const y=["ok","error"];function A(n){const t=n;return t&&"string"==typeof(null==t?void 0:t.actionId)&&y.includes(null==t?void 0:t.status)}var _=e(1);const x="kibana-alert-history-",C=`${x}default`,S="preconfigured-alert-history-es-index",I=n=>{const{date:t,alert:e,context:r,params:u,tags:i,rule:o}=n;if(!e||!o)return null;const{actionGroup:a,actionGroupName:l,id:s}=e,{id:c,name:f,spaceId:d,type:p}=o;if(!p)return null;const m=p.replace(/\./g,"__"),g={...c?{id:c}:{},...f?{name:f}:{},...Object(_.isEmpty)(u)?{}:{params:{[m]:u}},...d?{space:d}:{},...p?{type:p}:{}},v={...s?{id:s}:{},...Object(_.isEmpty)(r)?{}:{context:{[m]:r}},...a?{actionGroup:a}:{},...l?{actionGroupName:l}:{}},b={"@timestamp":t||(new Date).toISOString(),...i&&i.length>0?{tags:i}:{},...null!=r&&r.message?{message:r.message}:{},...Object(_.isEmpty)(g)?{}:{rule:g},...Object(_.isEmpty)(v)?{}:{kibana:{alert:v}}};return Object(_.isEmpty)(b)?null:{...b,event:{kind:"alert"}}},O=Object.freeze(I({rule:{id:"{{rule.id}}",name:"{{rule.name}}",type:"{{rule.type}}",spaceId:"{{rule.spaceId}}"},context:"{{context}}",params:"{{params}}",tags:"{{rule.tags}}",alert:{id:"{{alert.id}}",actionGroup:"{{alert.actionGroup}}",actionGroupName:"{{alert.actionGroupName}}"}})),E=/\{\{((.|\n)*)\}\}/;function j(n){return!!n.match(E)}function w(n){return n.filter((n=>!j(n)))}var k=e(4);function F(n){return n.map((n=>({address:n,valid:!0})))}function T(n,t,e={}){return t.map((t=>function(n,t,e){if(e.treatMustacheTemplatesAsValid&&j(t))return{address:t,valid:!0};try{return function(n,t){const e=Object(k.parseAddressList)(t);if(null==e)return{address:t,valid:!1,reason:h.invalid};if(null!==n){const r=new Set(n);for(const n of e){let e=[];if("group"===n.type)e=n.addresses.map((n=>n.domain));else{if("mailbox"!==n.type)return{address:t,valid:!1,reason:h.invalid};e=[n.domain]}for(const n of e)if(!r.has(n))return{address:t,valid:!1,reason:h.notAllowed}}}return{address:t,valid:!0}}(n,t)}catch(n){return{address:t,valid:!1,reason:h.invalid}}}(n,t,e)))}function N(n){const t=n.filter((n=>!n.valid&&n.reason===h.invalid)),e=n.filter((n=>!n.valid&&n.reason===h.notAllowed)),r=[];if(0!==t.length&&r.push(`not valid emails: ${D(t).join(", ")}`),0!==e.length&&r.push(`not allowed emails: ${D(e).join(", ")}`),0!==r.length)return r.join("; ")}function D(n){return n.map((n=>n.address))}const P="/api/actions",M="/internal/actions",R="actions"},function(n,t,e){n.exports=e(7)(2)},function(n,t,e){!function(t){"use strict";function e(n){function t(){return In<On}function e(){return In}function u(n){In=n}function i(){In=0,On=Sn.length}function o(n,t){return{name:n,tokens:t||"",semantic:t||"",children:[]}}function a(n,t){var e;return null===t?null:((e=o(n)).tokens=t.tokens,e.semantic=t.semantic,e.children.push(t),e)}function l(n,t){return null!==t&&(n.tokens+=t.tokens,n.semantic+=t.semantic),n.children.push(t),n}function s(n){var e;return t()&&n(e=Sn[In])?(In+=1,o("token",e)):null}function c(){return null}function f(n){return function(){return a("literal",s((function(t){return t===n})))}}function d(){var n=arguments;return function(){var t,r,i,a;for(a=e(),r=o("and"),t=0;t<n.length;t+=1){if(null===(i=n[t]()))return u(a),null;l(r,i)}return r}}function p(){var n=arguments;return function(){var t,r,i;for(i=e(),t=0;t<n.length;t+=1){if(null!==(r=n[t]()))return r;u(i)}return null}}function m(n){return function(){var t,r;return r=e(),null!==(t=n())?t:(u(r),o("opt"))}}function g(n){return function(){var t=n();return null!==t&&(t.semantic=""),t}}function v(n){return function(){var t=n();return null!==t&&t.semantic.length>0&&(t.semantic=" "),t}}function b(n,t){return function(){var r,i,a,s,c;for(s=e(),r=o("star"),a=0,c=void 0===t?0:t;null!==(i=n());)a+=1,l(r,i);return a>=c?r:(u(s),null)}}function h(n){return n.charCodeAt(0)>=128}function y(){return a("cr",f("\r")())}function A(){return a("crlf",d(y,C)())}function _(){return a("dquote",f('"')())}function x(){return a("htab",f("\t")())}function C(){return a("lf",f("\n")())}function S(){return a("sp",f(" ")())}function I(){return a("vchar",s((function(t){var e=t.charCodeAt(0),r=33<=e&&e<=126;return n.rfc6532&&(r=r||h(t)),r})))}function O(){return a("wsp",p(S,x)())}function E(){var n=a("quoted-pair",p(d(f("\\"),p(I,O)),un)());return null===n?null:(n.semantic=n.semantic[1],n)}function j(){return a("fws",p(an,d(m(d(b(O),g(A))),b(O,1)))())}function w(){return a("ctext",p((function(){return s((function(t){var e=t.charCodeAt(0),r=33<=e&&e<=39||42<=e&&e<=91||93<=e&&e<=126;return n.rfc6532&&(r=r||h(t)),r}))}),en)())}function k(){return a("ccontent",p(w,E,F)())}function F(){return a("comment",d(f("("),b(d(m(j),k)),m(j),f(")"))())}function T(){return a("cfws",p(d(b(d(m(j),F),1),m(j)),j)())}function N(){return a("atext",s((function(t){var e="a"<=t&&t<="z"||"A"<=t&&t<="Z"||"0"<=t&&t<="9"||["!","#","$","%","&","'","*","+","-","/","=","?","^","_","`","{","|","}","~"].indexOf(t)>=0;return n.rfc6532&&(e=e||h(t)),e})))}function D(){return a("atom",d(v(m(T)),b(N,1),v(m(T)))())}function P(){var n,t;return null===(n=a("dot-atom-text",b(N,1)()))||null!==(t=b(d(f("."),b(N,1)))())&&l(n,t),n}function M(){return a("dot-atom",d(g(m(T)),P,g(m(T)))())}function R(){return a("qtext",p((function(){return s((function(t){var e=t.charCodeAt(0),r=33===e||35<=e&&e<=91||93<=e&&e<=126;return n.rfc6532&&(r=r||h(t)),r}))}),rn)())}function L(){return a("qcontent",p(R,E)())}function G(){return a("quoted-string",d(g(m(T)),g(_),b(d(m(v(j)),L)),m(g(j)),g(_),g(m(T)))())}function q(){return a("word",p(D,G)())}function H(){return a("address",p($,V)())}function $(){return a("mailbox",p(B,nn)())}function B(){return a("name-addr",d(m(z),U)())}function U(){return a("angle-addr",p(d(g(m(T)),f("<"),nn,f(">"),g(m(T))),ln)())}function V(){return a("group",d(z,f(":"),m(X),f(";"),g(m(T)))())}function z(){return a("display-name",(null!==(n=a("phrase",p(on,b(q,1))()))&&(n.semantic=n.semantic.replace(/([ \t]|\r\n)+/g," ").replace(/^\s*/,"").replace(/\s*$/,"")),n));var n}function W(){return a("mailbox-list",p(d($,b(d(f(","),$))),fn)())}function K(){return a("address-list",p(d(H,b(d(f(n.addressListSeparator),H))),dn)())}function X(){return a("group-list",p(W,g(T),pn)())}function Y(){return a("local-part",p(mn,M,G)())}function Z(){return a("dtext",p((function(){return s((function(t){var e=t.charCodeAt(0),r=33<=e&&e<=90||94<=e&&e<=126;return n.rfc6532&&(r=r||h(t)),r}))}),vn)())}function J(){return a("domain-literal",d(g(m(T)),f("["),b(d(m(j),Z)),m(j),f("]"),g(m(T)))())}function Q(){return a("domain",(t=p(gn,M,J)(),n.rejectTLD&&t&&t.semantic&&t.semantic.indexOf(".")<0?null:(t&&(t.semantic=t.semantic.replace(/\s+/g,"")),t)));var t}function nn(){return a("addr-spec",d(Y,f("@"),Q)())}function tn(){return n.strict?null:a("obs-NO-WS-CTL",s((function(n){var t=n.charCodeAt(0);return 1<=t&&t<=8||11===t||12===t||14<=t&&t<=31||127===t})))}function en(){return n.strict?null:a("obs-ctext",tn())}function rn(){return n.strict?null:a("obs-qtext",tn())}function un(){return n.strict?null:a("obs-qp",d(f("\\"),p(f("\0"),tn,C,y))())}function on(){return n.strict?null:a("obs-phrase",d(q,b(p(q,f("."),n.atInDisplayName?f("@"):c,n.commaInDisplayName?f(","):c,v(T))))())}function an(){return n.strict?null:a("obs-FWS",b(d(g(m(A)),O),1)())}function ln(){return n.strict?null:a("obs-angle-addr",d(g(m(T)),f("<"),sn,nn,f(">"),g(m(T)))())}function sn(){return n.strict?null:a("obs-route",d(cn,f(":"))())}function cn(){return n.strict?null:a("obs-domain-list",d(b(p(g(T),f(","))),f("@"),Q,b(d(f(","),g(m(T)),m(d(f("@"),Q)))))())}function fn(){return n.strict?null:a("obs-mbox-list",d(b(d(g(m(T)),f(","))),$,b(d(f(","),m(d($,g(T))))))())}function dn(){return n.strict?null:a("obs-addr-list",d(b(d(g(m(T)),f(","))),H,b(d(f(","),m(d(H,g(T))))))())}function pn(){return n.strict?null:a("obs-group-list",d(b(d(g(m(T)),f(",")),1),g(m(T)))())}function mn(){return n.strict?null:a("obs-local-part",d(q,b(d(f("."),q)))())}function gn(){return n.strict?null:a("obs-domain",d(D,b(d(f("."),D)))())}function vn(){return n.strict?null:a("obs-dtext",p(tn,E)())}function bn(n,t){var e,r,u;if(null==t)return null;for(r=[t];r.length>0;){if((u=r.pop()).name===n)return u;for(e=u.children.length-1;e>=0;e-=1)r.push(u.children[e])}return null}function hn(n,t){var e,r,u,i,o;if(null==t)return null;for(r=[t],i=[],o={},e=0;e<n.length;e+=1)o[n[e]]=!0;for(;r.length>0;)if((u=r.pop()).name in o)i.push(u);else for(e=u.children.length-1;e>=0;e-=1)r.push(u.children[e]);return i}function yn(t){var e,r,u,i,o;if(null===t)return null;for(e=[],r=hn(["group","mailbox"],t),u=0;u<r.length;u+=1)"group"===(i=r[u]).name?e.push(An(i)):"mailbox"===i.name&&e.push(_n(i));return o={ast:t,addresses:e},n.simple&&(o=function(n){var t;if(n&&n.addresses)for(t=0;t<n.addresses.length;t+=1)delete n.addresses[t].node;return n}(o)),n.oneResult?function(t){return t?!n.partial&&t.addresses.length>1?null:t.addresses&&t.addresses[0]:null}(o):n.simple?o&&o.addresses:o}function An(n){var t,e=bn("display-name",n),r=[],u=hn(["mailbox"],n);for(t=0;t<u.length;t+=1)r.push(_n(u[t]));return{node:n,parts:{name:e},type:n.name,name:xn(e),addresses:r}}function _n(n){var t=bn("display-name",n),e=bn("addr-spec",n),r=function(n,t){var e,r,u,i;if(null==t)return null;for(r=[t],i=[];r.length>0;)for("cfws"===(u=r.pop()).name&&i.push(u),e=u.children.length-1;e>=0;e-=1)r.push(u.children[e]);return i}(0,n),u=hn(["comment"],n),i=bn("local-part",e),o=bn("domain",e);return{node:n,parts:{name:t,address:e,local:i,domain:o,comments:r},type:n.name,name:xn(t),address:xn(e),local:xn(i),domain:xn(o),comments:Cn(u),groupName:xn(n.groupName)}}function xn(n){return null!=n?n.semantic:null}function Cn(n){var t="";if(n)for(var e=0;e<n.length;e+=1)t+=xn(n[e]);return t}var Sn,In,On,En,jn;if(null===(n=r(n,{})))return null;if(Sn=n.input,jn={address:H,"address-list":K,"angle-addr":U,from:function(){return a("from",p(W,K)())},group:V,mailbox:$,"mailbox-list":W,"reply-to":function(){return a("reply-to",K())},sender:function(){return a("sender",p($,H)())}}[n.startAt]||K,!n.strict){if(i(),n.strict=!0,En=jn(Sn),n.partial||!t())return yn(En);n.strict=!1}return i(),En=jn(Sn),!n.partial&&t()?null:yn(En)}function r(n,t){function e(n){return"[object String]"===Object.prototype.toString.call(n)}function r(n){return null==n}var u,i;if(e(n))n={input:n};else if(!function(n){return n===Object(n)}(n))return null;if(!e(n.input))return null;if(!t)return null;for(i in u={oneResult:!1,partial:!1,rejectTLD:!1,rfc6532:!1,simple:!1,startAt:"address-list",strict:!1,atInDisplayName:!1,commaInDisplayName:!1,addressListSeparator:","})r(n[i])&&(n[i]=r(t[i])?u[i]:t[i]);return n}e.parseOneAddress=function(n){return e(r(n,{oneResult:!0,rfc6532:!0,simple:!0,startAt:"address-list"}))},e.parseAddressList=function(n){return e(r(n,{rfc6532:!0,simple:!0,startAt:"address-list"}))},e.parseFrom=function(n){return e(r(n,{rfc6532:!0,simple:!0,startAt:"from"}))},e.parseSender=function(n){return e(r(n,{oneResult:!0,rfc6532:!0,simple:!0,startAt:"sender"}))},e.parseReplyTo=function(n){return e(r(n,{rfc6532:!0,simple:!0,startAt:"reply-to"}))},void 0!==n.exports?n.exports=e:t.emailAddresses=e}(this)},function(n,t,e){e(6),__kbnBundles__.define("plugin/actions/public",e,8),__kbnBundles__.define("plugin/actions/common",e,2)},function(n,t,e){e.p=window.__kbnPublicPath__.actions},function(n,t){n.exports=__kbnSharedDeps_npm__},function(n,t,e){"use strict";e.r(t),e.d(t,"Plugin",(function(){return plugin_Plugin})),e.d(t,"plugin",(function(){return o}));var r=e(3),u=e.n(r),i=e(2);class plugin_Plugin{constructor(n){var t;u()(this,"allowedEmailDomains",null);const e=n.config.get();this.allowedEmailDomains=(null===(t=e.email)||void 0===t?void 0:t.domain_allowlist)||null}setup(){return{validateEmailAddresses:(n,t)=>Object(i.validateEmailAddresses)(this.allowedEmailDomains,n,t)}}start(){}}function o(n){return new plugin_Plugin(n)}}]);