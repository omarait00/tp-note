/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[27],{1114:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var i=a(4),r=a.n(i),n=a(78),l=a(184);const o=({id:e,inputId:t,inspect:a,loading:r,refetch:o,skip:s})=>{const d=Object(n.useDispatch)();return Object(i.useEffect)((()=>{s||d(l.b.setQuery({id:e,inputId:t,inspect:a,loading:r,refetch:o}))}),[d,e,t,r,o,a,s]),null},s=r.a.memo(o)},1127:function(e,t,a){"use strict";a.d(t,"a",(function(){return v}));var i=a(32),r=a(4),n=a.n(r),l=a(78),o=a(90),s=a(145),d=a(81),c=a(0);const u=c.i18n.translate("xpack.securitySolution.timeline.properties.lockDatePickerTooltip",{defaultMessage:"Disable syncing of date/time range between the currently viewed page and your timeline"}),m=c.i18n.translate("xpack.securitySolution.timeline.properties.unlockDatePickerTooltip",{defaultMessage:"Enable syncing of date/time range between the currently viewed page and your timeline"}),p=c.i18n.translate("xpack.securitySolution.timeline.properties.lockDatePickerDescription",{defaultMessage:"Lock global date picker to timeline date picker"}),g=c.i18n.translate("xpack.securitySolution.timeline.properties.unlockDatePickerDescription",{defaultMessage:"Unlock global date picker from timeline date picker"}),h=()=>{const e=Object(l.useDispatch)(),t=Object(r.useMemo)((()=>s.d.globalSelector()),[]),a=Object(d.b)((e=>t(e).linkTo.includes(o.a.timeline))),c=Object(r.useCallback)((()=>e(s.b.toggleTimelineLinkTo())),[e]);return n.a.createElement(i.EuiToolTip,{"data-test-subj":"timeline-date-picker-lock-tooltip",position:"top",content:a?u:m},n.a.createElement(i.EuiButtonIcon,{"data-test-subj":`timeline-date-picker-${a?"lock":"unlock"}-button`,color:"primary",onClick:c,iconType:a?"lock":"lockOpen","aria-label":a?g:p}))};h.displayName="TimelineDatePickerLockComponent";const v=n.a.memo(h)},1290:function(e,t,a){"use strict";a.r(t),a.d(t,"QueryTabContentComponent",(function(){return bt})),a.d(t,"default",(function(){return ft}));var i=a(32),r=a(34),n=a(4),l=a.n(n),o=a(33),s=a.n(o),d=a(78),c=a(92),u=a.n(c),m=a(287),p=a(48),g=a(42),h=a(90),v=a(233),y=a(86),b=a(520),f=a(77),E=a(158),I=a(1120),x=a(1126),O=a(284),k=a(117),w=a.n(k),S=a(83),P=a(95),C=a(94),j=a(81),F=a(82),M=a.n(F),D=a(57);const N=s.a.div.withConfig({displayName:"ReactDndDropTarget",componentId:"sc-zu5fvf-0"})(["transition:background-color 0.7s ease;width:100%;height:",";.flyout-overlay{.euiPanel{background-color:",";}}"," > div.timeline-drop-area{.drop-and-provider-timeline{display:none;}& + div{display:none !important;}}"],(({height:e})=>e),(e=>e.theme.eui.euiFormBackgroundColor),(e=>e.isDraggingOver?`\n    .drop-and-provider-timeline {\n      &:hover {\n        background-color: ${Object(O.rgba)(e.theme.eui.euiColorSuccess,.3)};\n      }\n    }\n    .drop-and-provider-timeline:hover {\n        background-color: ${Object(O.rgba)(e.theme.eui.euiColorSuccess,.3)};\n    }\n  > div.timeline-drop-area-empty {\n     color: ${e.theme.eui.euiColorSuccess};\n     background-color: ${Object(O.rgba)(e.theme.eui.euiColorSuccess,.2)};\n\n     & .timeline-drop-area-empty__text {\n      color: ${e.theme.eui.euiColorSuccess};\n     }\n  }\n  > div.timeline-drop-area {\n    background-color: ${Object(O.rgba)(e.theme.eui.euiColorSuccess,.2)};\n    .provider-item-filter-container div:first-child{\n      /* Override dragNdrop beautiful so we do not have our droppable moving around for no good reason */\n      transform: none !important;\n    }\n    .drop-and-provider-timeline {\n      display: block !important;\n      + div {\n        display: none;\n      }\n    }\n\n    & .euiFormHelpText {\n      color: ${e.theme.eui.euiColorSuccess};\n    }\n  }\n  .flyout-overlay {\n    .euiPanel {\n      background-color: ${e.theme.eui.euiColorLightShade};\n    }\n    + div {\n      /* Override dragNdrop beautiful so we do not have our droppable moving around for no good reason */\n      display: none !important;\n    }\n  }\n  `:""));N.displayName="ReactDndDropTarget";const T=l.a.memo((({children:e=null,droppableId:t,height:a="100%",isDropDisabled:i=!1,type:r,render:o=null,renderClone:s})=>{const d=Object(n.useCallback)(((t,i)=>l.a.createElement(N,M()({height:a,ref:t.innerRef},t.droppableProps,{isDraggingOver:i.isDraggingOver}),null==o?e:o({isDraggingOver:i.isDraggingOver}),t.placeholder)),[e,a,o]);return l.a.createElement(D.Droppable,{isDropDisabled:i,droppableId:t,direction:"horizontal",type:r,renderClone:s},d)}));T.displayName="DroppableWrapper";var q=a(102),Q=a(421),z=a(79),_=a(907),K=a(429),R=a(106),B=a(410);const $=s.a.div.withConfig({displayName:"AddFieldPopoverContainer",componentId:"sc-gueb-0"})(["min-width:350px;"]),A=({browserFields:e,timelineId:t})=>{const a=Object(d.useDispatch)(),[o,s]=Object(n.useState)(!1),c=Object(n.useMemo)((()=>y.b.getTimelineByIdSelector()),[]),{dataProviders:u,timelineType:m}=Object(j.a)((e=>Object(r.pick)(["dataProviders","timelineType"],c(e,t)))),p=Object(n.useCallback)((()=>s(!o)),[s,o]),g=Object(n.useCallback)((()=>s(!1)),[s]),h=Object(n.useCallback)((({andProviderId:e,excluded:i,field:r,id:n,operator:l,providerId:o,value:s,type:d})=>{Object(K.b)({dataProviders:u,destination:{droppableId:`droppableId.timelineProviders.${t}.group.${u.length}`,index:0},dispatch:a,onAddedToTimeline:g,providerToAdd:{id:o,name:r,enabled:!0,excluded:i,kqlQuery:"",type:d,queryMatch:{displayField:void 0,displayValue:Object(K.d)(s),field:r,value:s,operator:l},and:[]},timelineId:t})}),[u,t,a,g]),v=Object(n.useMemo)((()=>[{id:0,width:400,items:[{name:B.a,icon:l.a.createElement(i.EuiIcon,{type:"plusInCircle",size:"m"}),panel:1},m===z.n.template?{disabled:m!==z.n.template,name:B.b,icon:l.a.createElement(i.EuiIcon,{type:"visText",size:"m"}),panel:2}:null].filter((e=>null!==e))},{id:1,title:B.a,width:400,content:l.a.createElement(_.a,{browserFields:e,field:"",isExcluded:!1,onDataProviderEdited:h,operator:":",timelineId:t,value:"",type:R.a.default,providerId:`${t}-${w.a.v4()}`})},{id:2,title:B.b,width:400,content:l.a.createElement(_.a,{browserFields:e,field:"",isExcluded:!1,onDataProviderEdited:h,operator:":",timelineId:t,value:"",type:R.a.template,providerId:`${t}-${w.a.v4()}`})}]),[e,h,t,m]),b=Object(n.useMemo)((()=>m===z.n.template?l.a.createElement(i.EuiButton,{size:"s",onClick:p,"data-test-subj":"addField",iconType:"arrowDown",fill:!0,iconSide:"right"},l.a.createElement(i.EuiText,{size:"s"},B.a)):l.a.createElement(i.EuiButtonEmpty,{size:"s",onClick:p,"data-test-subj":"addField",iconSide:"right"},l.a.createElement(i.EuiText,{size:"s"},`+ ${B.a}`))),[p,m]),f=Object(n.useMemo)((()=>m===z.n.template?l.a.createElement(i.EuiContextMenu,{initialPanelId:0,panels:v}):l.a.createElement(_.a,{browserFields:e,field:"",isExcluded:!1,onDataProviderEdited:h,operator:":",timelineId:t,value:"",type:R.a.default,providerId:`${t}-${w.a.v4()}`})),[e,h,v,t,m]);return l.a.createElement(i.EuiPopover,{id:"addFieldsPopover",button:b,isOpen:o,closePopover:g,anchorPosition:"downLeft",panelPaddingSize:"none",repositionOnScroll:!0},l.a.createElement($,null,f))};A.displayName="AddDataProviderPopoverComponent";const L=l.a.memo(A);L.displayName="AddDataProviderPopover";const W=s()(i.EuiText).withConfig({displayName:"Text",componentId:"sc-1dcwhn2-0"})(["overflow:hidden;margin:5px 0 5px 0;padding:3px;white-space:nowrap;"]);W.displayName="Text";const H=s()(i.EuiBadge).withConfig({displayName:"BadgeHighlighted",componentId:"sc-1dcwhn2-1"})(["height:20px;margin:0 5px 0 5px;maxwidth:85px;minwidth:85px;"]);H.displayName="BadgeHighlighted";const U=s.a.span.withConfig({displayName:"HighlightedBackground",componentId:"sc-1dcwhn2-2"})(["background-color:",";"],(e=>e.theme.eui.euiColorLightShade));U.displayName="HighlightedBackground";const G=s.a.div.withConfig({displayName:"EmptyContainer",componentId:"sc-1dcwhn2-3"})(["width:",";align-items:center;display:flex;flex-direction:column;flex-wrap:wrap;justify-content:center;user-select:none;align-content:center;",""],(e=>e.showSmallMsg?"60px":"auto"),(e=>e.showSmallMsg?`\n      border-right: 1px solid ${e.theme.eui.euiColorMediumShade};\n      margin-right: 10px;\n    `:"\n  min-height: 100px;\n  + div {\n    display: none !important;\n   }\n  "));G.displayName="EmptyContainer";const V=s.a.div.withConfig({displayName:"NoWrap",componentId:"sc-1dcwhn2-4"})(["align-items:center;display:flex;flex-direction:row;flex-wrap:no-wrap;"]);V.displayName="NoWrap";const X=l.a.memo((({showSmallMsg:e=!1,browserFields:t,timelineId:a})=>l.a.createElement(G,{className:"timeline-drop-area-empty","data-test-subj":"empty",showSmallMsg:e},!e&&l.a.createElement(l.a.Fragment,null,l.a.createElement(V,null,l.a.createElement(W,{color:"subdued",size:"s",className:"timeline-drop-area-empty__text"},B.f),l.a.createElement(U,null,l.a.createElement(H,{className:"highlighted-drop-target"},B.n)),l.a.createElement(W,{color:"subdued",size:"s",className:"timeline-drop-area-empty__text"},B.m),l.a.createElement(Q.a,{type:"or"}),l.a.createElement(W,{color:"subdued",size:"s",className:"timeline-drop-area-empty__text"},B.q)),l.a.createElement(L,{browserFields:t,timelineId:a})),e&&l.a.createElement(Q.a,{type:"or"}))));X.displayName="Empty";var Y=a(916);const J={alignItems:"center",display:"flex",height:"36px",minWidth:"125px"},Z=s.a.div.withConfig({displayName:"DroppableContainer",componentId:"sc-cfhrc0-0"})(["min-height:","px;height:auto !important;."," &:hover{background-color:"," !important;}"],36,S.d,(({theme:e})=>Object(O.rgba)(e.eui.euiColorSuccess,.2))),ee=s.a.span.withConfig({displayName:"Parens",componentId:"sc-cfhrc0-1"})(["color:",";font-size:32px;padding:2px;user-select:none;"],(({theme:e})=>e.eui.euiColorMediumShade)),te=s.a.div.withConfig({displayName:"AndOrBadgeContainer",componentId:"sc-cfhrc0-2"})(["span{visibility:",";}"],(({hideBadge:e})=>e?"hidden":"inherit")),ae=s.a.div.withConfig({displayName:"LastAndOrBadgeInGroup",componentId:"sc-cfhrc0-3"})(["display:none;."," &{display:initial;}"],S.d),ie=s()(i.EuiFlexItem).withConfig({displayName:"OrFlexItem",componentId:"sc-cfhrc0-4"})(["padding-left:9px;"]);s()(i.EuiFormHelpText).withConfig({displayName:"TimelineEuiFormHelpText",componentId:"sc-cfhrc0-5"})(["padding-top:0px;position:absolute;bottom:0px;left:4px;"]).displayName="TimelineEuiFormHelpText";const re=s()(i.EuiFlexItem).withConfig({displayName:"ParensContainer",componentId:"sc-cfhrc0-6"})(["align-self:center;"]),ne=l.a.memo((({browserFields:e,timelineId:t,dataProviders:a})=>{const i=Object(n.useMemo)((()=>[...Object(K.c)(a),...K.a]),[a]),r=Object(n.useMemo)((()=>i.map(((r,n)=>l.a.createElement(oe,{key:`droppable-${n}`,group:r,groupIndex:n,isLastGroup:n===i.length-1,browserFields:e,timelineId:t,dataProviders:a})))),[e,i,a,t]);return l.a.createElement("div",null,r)}));ne.displayName="Providers";const le=l.a.memo((({browserFields:e,group:t,groupIndex:a,dataProvider:r,index:o,timelineId:s})=>{var c;const u=Object(n.useRef)(null),[m,p]=Object(n.useState)(!1),[,g]=Object(n.useState)(!1),h=Object(d.useDispatch)(),{timelines:v}=Object(f.k)().services,b=Object(n.useCallback)((()=>{g((e=>!e))}),[]),E=Object(n.useMemo)((()=>Object(q.m)({dataProviderId:r.id,groupIndex:a,timelineId:s})),[r.id,a,s]),I=Object(n.useCallback)((()=>{const e={id:s,providerId:o>0?t[0].id:r.id,andProviderId:o>0?r.id:void 0};h(y.a.removeProvider(e))}),[r.id,h,t,o,s]),x=Object(n.useCallback)((()=>{const e={id:s,providerId:o>0?t[0].id:r.id,enabled:!r.enabled,andProviderId:o>0?r.id:void 0};h(y.a.updateDataProviderEnabled(e))}),[r.enabled,r.id,h,t,o,s]),O=Object(n.useCallback)((()=>{const e={id:s,providerId:o>0?t[0].id:r.id,excluded:!r.excluded,andProviderId:o>0?r.id:void 0};h(y.a.updateDataProviderExcluded(e))}),[r.excluded,r.id,h,t,o,s]),k=Object(n.useCallback)((()=>{const e={id:s,providerId:o>0?t[0].id:r.id,type:r.type===R.a.template?R.a.default:R.a.template,andProviderId:o>0?r.id:void 0};h(y.a.updateDataProviderType(e))}),[r.id,r.type,h,t,o,s]),w=Object(n.useCallback)((({andProviderId:e,excluded:t,field:a,operator:i,providerId:r,value:n})=>h(y.a.dataProviderEdited({andProviderId:e,excluded:t,field:a,id:s,operator:i,providerId:r,value:n}))),[h,s]),P=Object(n.useCallback)((()=>{var e;null===(e=u.current)||void 0===e||e.focus()}),[]),C=Object(n.useCallback)((()=>{p(!0)}),[]),{onBlur:j,onKeyDown:F}=v.getUseDraggableKeyboardWrapper()({closePopover:b,draggableId:E,fieldName:r.queryMatch.field,keyboardHandlerRef:u,openPopover:C}),N=Object(n.useCallback)((e=>{u.current===document.activeElement&&F(e)}),[F]),T=String(null!==(c=r.queryMatch.displayValue)&&void 0!==c?c:r.queryMatch.value),z=Object(n.useCallback)(((a,n)=>{var d,c,g,h,v;return l.a.createElement("div",M()({ref:a.innerRef},a.draggableProps,a.dragHandleProps,{style:(v=a.draggableProps.style,{...v,userSelect:"none"}),"data-test-subj":"providerContainer",tabIndex:-1}),l.a.createElement(i.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},l.a.createElement(i.EuiFlexItem,{grow:!1},l.a.createElement(Y.a,{andProviderId:o>0?r.id:void 0,browserFields:e,deleteProvider:I,field:o>0?null!==(d=r.queryMatch.displayField)&&void 0!==d?d:r.queryMatch.field:null!==(c=t[0].queryMatch.displayField)&&void 0!==c?c:t[0].queryMatch.field,kqlQuery:o>0?r.kqlQuery:t[0].kqlQuery,isEnabled:o>0?r.enabled:t[0].enabled,isExcluded:o>0?r.excluded:t[0].excluded,isPopoverOpen:m,onDataProviderEdited:w,operator:o>0?null!==(g=r.queryMatch.operator)&&void 0!==g?g:R.d:null!==(h=t[0].queryMatch.operator)&&void 0!==h?h:R.d,register:r,providerId:o>0?t[0].id:r.id,timelineId:s,setIsPopoverOpen:p,toggleEnabledProvider:x,toggleExcludedProvider:O,toggleTypeProvider:k,displayValue:T,val:r.queryMatch.value,type:r.type,wrapperRef:u})),l.a.createElement(i.EuiFlexItem,{grow:!1},!n.isDragging&&(o<t.length-1?l.a.createElement(Q.a,{type:"and"}):l.a.createElement(ae,null,l.a.createElement(Q.a,{type:"and"}))))))}),[e,r,T,t,w,I,x,O,k,o,m,u,p,s]);return l.a.createElement("div",{className:S.a,"data-test-subj":"draggableWrapperKeyboardHandler",onClick:P,onBlur:j,onKeyDown:N,ref:u,role:"button",tabIndex:0},l.a.createElement(D.Draggable,{disableInteractiveElementBlocking:!0,draggableId:E,index:o,key:r.id},z))}));le.displayName="DataProvidersGroupItem";const oe=l.a.memo((({browserFields:e,timelineId:t,group:a,groupIndex:r,isLastGroup:o})=>{const s=Object(n.useMemo)((()=>Object(q.n)({groupIndex:r,timelineId:t})),[r,t]),d=Object(n.useMemo)((()=>a.map(((i,n)=>l.a.createElement(le,{key:i.id,browserFields:e,dataProvider:i,index:n,timelineId:t,group:a,groupIndex:r})))),[e,a,r,t]),c=Object(n.useCallback)((e=>l.a.createElement(Z,M()({className:o?"empty-providers-group":"",ref:e.innerRef,style:J},e.droppableProps),d,e.placeholder)),[d,o]);return l.a.createElement(l.a.Fragment,null,0!==r&&l.a.createElement(i.EuiSpacer,{size:"xs"}),l.a.createElement(i.EuiFlexGroup,{"aria-label":B.l(r),alignItems:"center",gutterSize:"none"},l.a.createElement(ie,{grow:!1},l.a.createElement(te,{hideBadge:0===r},l.a.createElement(Q.a,{type:"or"}))),l.a.createElement(re,{grow:!1},l.a.createElement(ee,null,"(")),l.a.createElement(i.EuiFlexItem,{grow:!1},l.a.createElement(D.Droppable,{droppableId:s,direction:"horizontal"},c)),l.a.createElement(re,{grow:!1},l.a.createElement(ee,null,")")),o&&l.a.createElement(L,{browserFields:e,timelineId:t})))}));oe.displayName="DataProvidersGroup";var se=a(112);const de=s.a.div.withConfig({displayName:"DropTargetDataProvidersContainer",componentId:"sc-rnh8sd-0"})(["padding:2px 0 4px 0;."," & .drop-target-data-providers{background:",";border:0.2rem dashed ",";& .timeline-drop-area-empty__text{color:",";}& .euiFormHelpText{color:",";}}"],S.d,(({theme:e})=>Object(O.rgba)(e.eui.euiColorSuccess,.1)),(({theme:e})=>e.eui.euiColorSuccess),(({theme:e})=>e.eui.euiColorSuccess),(({theme:e})=>e.eui.euiColorSuccess)),ce=s.a.div.withConfig({displayName:"DropTargetDataProviders",componentId:"sc-rnh8sd-1"})(["display:flex;flex-direction:column;justify-content:flex-start;padding-bottom:2px;position:relative;border:0.2rem dashed ",";border-radius:5px;padding:"," 0;margin:2px 0 2px 0;max-height:33vh;min-height:100px;overflow:auto;resize:vertical;background-color:",";"],(({theme:e})=>e.eui.euiColorMediumShade),(({theme:e})=>e.eui.euiSizeXS),(({theme:e})=>e.eui.euiFormBackgroundColor));ce.displayName="DropTargetDataProviders";const ue=l.a.memo((({timelineId:e})=>{const{browserFields:t}=Object(C.d)(P.SourcererScopeName.timeline),a=Object(n.useMemo)((()=>y.b.getTimelineByIdSelector()),[]),i=Object(j.a)((t=>{var i;return(null!==(i=a(t,e))&&void 0!==i?i:se.b).isLoading})),r=Object(j.a)((t=>{var i;return(null!==(i=a(t,e))&&void 0!==i?i:se.b).dataProviders})),o=Object(n.useMemo)((()=>{return t=e,`${q.g}${t}${w.a.v4()}`;var t}),[e]);return l.a.createElement(de,{"aria-label":B.r,className:"drop-target-data-providers-container"},l.a.createElement(ce,{className:"drop-target-data-providers","data-test-subj":"dataProviders"},null!=r&&r.length?l.a.createElement(ne,{browserFields:t,timelineId:e,dataProviders:r}):l.a.createElement(T,{isDropDisabled:i,droppableId:o},l.a.createElement(X,{browserFields:t,timelineId:e}))))}));ue.displayName="DataProviders";var me,pe=a(98),ge=a(286),he=a(880),ve=a(6),ye=a.n(ve),be=a(47),fe=a.n(be);!function(e){e.BACK="back",e.FORWARD="forward"}(me||(me={}));class super_select_EuiSuperSelect extends n.Component{constructor(...e){super(...e),ye()(this,"itemNodes",[]),ye()(this,"_isMounted",!1),ye()(this,"state",{isPopoverOpen:this.props.isOpen||!1}),ye()(this,"setItemNode",((e,t)=>{this.itemNodes[t]=e})),ye()(this,"openPopover",(()=>{this.setState({isPopoverOpen:!0});const e=()=>{const t=this.props.options.reduce(((e,t,a)=>null!=e?e:null==t?null:t.value===this.props.valueOfSelected?a:null),null);requestAnimationFrame((()=>{this._isMounted&&null!=this.props.valueOfSelected&&(null!=t?this.focusItemAt(t):e())}))};requestAnimationFrame(e)})),ye()(this,"closePopover",(()=>{this.setState({isPopoverOpen:!1})})),ye()(this,"itemClicked",(e=>{this.setState({isPopoverOpen:!1}),this.props.onChange&&this.props.onChange(e)})),ye()(this,"onSelectKeyDown",(e=>{e.key!==i.keys.ARROW_UP&&e.key!==i.keys.ARROW_DOWN||(e.preventDefault(),e.stopPropagation(),this.openPopover())})),ye()(this,"onItemKeyDown",(e=>{switch(e.key){case i.keys.ESCAPE:e.preventDefault(),e.stopPropagation(),this.closePopover();break;case i.keys.TAB:e.preventDefault(),e.stopPropagation();break;case i.keys.ARROW_UP:e.preventDefault(),e.stopPropagation(),this.shiftFocus(me.BACK);break;case i.keys.ARROW_DOWN:e.preventDefault(),e.stopPropagation(),this.shiftFocus(me.FORWARD)}}))}componentDidMount(){this._isMounted=!0,this.props.isOpen&&this.openPopover()}componentWillUnmount(){this._isMounted=!1}focusItemAt(e){const t=this.itemNodes[e];null!=t&&t.focus()}shiftFocus(e){const t=this.itemNodes.indexOf(document.activeElement);let a;a=-1===t?0:e===me.BACK?0===t?this.itemNodes.length-1:t-1:t===this.itemNodes.length-1?0:t+1,this.focusItemAt(a)}render(){const{className:e,options:t,valueOfSelected:a,onChange:r,isOpen:n,isInvalid:o,hasDividers:s,itemClassName:d,itemLayoutAlign:c,fullWidth:u,popoverProps:m,compressed:p,...g}=this.props,h=fe()("euiSuperSelect",null==m?void 0:m.className),v=fe()({"euiSuperSelect--isOpen__button":this.state.isPopoverOpen},e),y=fe()("euiSuperSelect__item",{"euiSuperSelect__item--hasDividers":s},d),b=l.a.createElement(i.EuiSuperSelectControl,M()({options:t,value:a,onClick:this.state.isPopoverOpen?this.closePopover:this.openPopover,onKeyDown:this.onSelectKeyDown,className:v,fullWidth:u,isInvalid:o,compressed:p},g)),f=t.map(((e,t)=>{const{value:r,dropdownDisplay:n,inputDisplay:o,...s}=e;return l.a.createElement(i.EuiContextMenuItem,M()({key:t,className:y,icon:a===r?"check":"empty",onClick:()=>this.itemClicked(r),onKeyDown:this.onItemKeyDown,layoutAlign:c,buttonRef:e=>this.setItemNode(e,t),role:"option",id:r,"aria-selected":a===r},s),n||o)}));return l.a.createElement(i.EuiInputPopover,M()({},m,{className:h,input:b,isOpen:n||this.state.isPopoverOpen,closePopover:this.closePopover,panelPaddingSize:"none",panelClassName:h,fullWidth:u,repositionOnScroll:!0,anchorPosition:"downCenter"}),l.a.createElement(i.EuiScreenReaderOnly,null,l.a.createElement("p",{role:"alert"},l.a.createElement(i.EuiI18n,{token:"euiSuperSelect.screenReaderAnnouncement",default:"You are in a form selector of {optionsCount} items and must select a single option. Use the up and down keys to navigate or escape to close.",values:{optionsCount:t.length}}))),l.a.createElement("div",{className:"euiSuperSelect__listbox",role:"listbox","aria-activedescendant":a,tabIndex:0},f))}}ye()(super_select_EuiSuperSelect,"defaultProps",{compressed:!1,fullWidth:!1,hasDividers:!1,isInvalid:!1,isLoading:!1});var Ee=a(0);const Ie=Ee.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.filterDescription",{defaultMessage:"Events from the data providers above are filtered by the adjacent KQL"}),xe=Ee.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.filterKqlTooltip",{defaultMessage:"Events from the data providers above are filtered by this KQL"}),Oe=Ee.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.filterKqlPlaceholder",{defaultMessage:"Filter events"}),ke=Ee.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.filterKqlSelectedText",{defaultMessage:"Filter"}),we=Ee.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.searchDescription",{defaultMessage:"Events from the data providers above are combined with results from the adjacent KQL"}),Se=Ee.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.searchKqlTooltip",{defaultMessage:"Events from the data providers above are combined with results from this KQL"}),Pe=Ee.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.searchKqlPlaceholder",{defaultMessage:"Search events"}),Ce=Ee.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.searchKqlSelectedText",{defaultMessage:"Search"}),je=Ee.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.filterOrSearchWithKql",{defaultMessage:"Filter or Search with KQL"}),Fe=s.a.div.withConfig({displayName:"AndOrContainer",componentId:"sc-1mndpti-0"})(["position:relative;top:-1px;"]);Fe.displayName="AndOrContainer";const Me={filter:{mode:"filter",description:Ie,kqlBarTooltip:xe,placeholder:Oe,selectText:ke},search:{mode:"search",description:we,kqlBarTooltip:Se,placeholder:Pe,selectText:Ce}},De=[{value:Me.filter.mode,inputDisplay:l.a.createElement(Fe,null,l.a.createElement(Q.a,{type:"and"}),Me.filter.selectText),dropdownDisplay:l.a.createElement(l.a.Fragment,null,l.a.createElement(Q.a,{type:"and"}),l.a.createElement("strong",null,Me.filter.selectText),l.a.createElement(i.EuiSpacer,{size:"xs"}),l.a.createElement(i.EuiText,{size:"s",color:"subdued"},l.a.createElement("p",null,Me.filter.description))),"data-test-subj":"kqlModePopoverFilter"},{value:Me.search.mode,inputDisplay:l.a.createElement(Fe,null,l.a.createElement(Q.a,{type:"or"}),Me.search.selectText),dropdownDisplay:l.a.createElement(l.a.Fragment,null,l.a.createElement(Q.a,{type:"or"}),l.a.createElement("strong",null,Me.search.selectText),l.a.createElement(i.EuiSpacer,{size:"xs"}),l.a.createElement(i.EuiText,{size:"s",color:"subdued"},l.a.createElement("p",null,Me.search.description))),"data-test-subj":"kqlModePopoverSearch"}],Ne="timelineSelectModeItemsClassName",Te="searchOrFilterPopover",qe="352px",Qe=Object(o.createGlobalStyle)([".","{width:350px !important;}.",".euiPopover__panel{width:"," !important;.euiSuperSelect__listbox{width:"," !important;}}"],Ne,Te,qe,qe),ze=s.a.div.withConfig({displayName:"SearchOrFilterContainer",componentId:"sc-izkbfu-0"})([""," user-select:none;"],(({theme:e})=>`margin-top: ${e.eui.euiSizeXS};`));ze.displayName="SearchOrFilterContainer";const _e=s()(i.EuiFlexItem).withConfig({displayName:"ModeFlexItem",componentId:"sc-izkbfu-1"})(["user-select:none;"]);_e.displayName="ModeFlexItem";const Ke=l.a.memo((({dataProviders:e,isRefreshPaused:t,filters:a,filterManager:r,filterQuery:o,from:s,fromStr:d,kqlMode:c,timelineId:u,refreshInterval:m,savedQueryId:p,setFilters:g,setSavedQueryId:h,to:v,toStr:y,updateKqlMode:b,updateReduxTime:f})=>{const E=Object(n.useCallback)((e=>b({id:u,kqlMode:e})),[u,b]);return l.a.createElement(l.a.Fragment,null,l.a.createElement(ze,null,l.a.createElement(i.EuiFlexGroup,{"data-test-subj":"timeline-search-or-filter",gutterSize:"xs"},l.a.createElement(_e,{grow:!1},l.a.createElement(i.EuiToolTip,{content:je},l.a.createElement(super_select_EuiSuperSelect,{"data-test-subj":"timeline-select-search-or-filter",hasDividers:!0,itemLayoutAlign:"top",itemClassName:Ne,onChange:E,options:De,popoverProps:{className:Te},valueOfSelected:c}))),l.a.createElement(i.EuiFlexItem,{"data-test-subj":"timeline-search-or-filter-search-container"},l.a.createElement(he.a,{dataProviders:e,filters:a,filterManager:r,filterQuery:o,from:s,fromStr:d,kqlMode:c,isRefreshPaused:t,refreshInterval:m,savedQueryId:p,setFilters:g,setSavedQueryId:h,timelineId:u,to:v,toStr:y,updateReduxTime:f})))),l.a.createElement(Qe,null))}));Ke.displayName="SearchOrFilter";const Re=l.a.memo((({dataProviders:e,filters:t,filterManager:a,filterQuery:i,from:r,fromStr:o,isRefreshPaused:s,kqlMode:d,refreshInterval:c,savedQueryId:u,setFilters:m,setSavedQueryId:p,timelineId:g,to:h,toStr:v,updateKqlMode:y,updateReduxTime:b})=>{const f=Object(n.useCallback)((e=>m({id:g,filters:e})),[g,m]),E=Object(n.useCallback)((e=>p({id:g,savedQueryId:e})),[g,p]);return l.a.createElement(Ke,{dataProviders:e,filters:t,filterManager:a,filterQuery:i,from:r,fromStr:o,isRefreshPaused:s,kqlMode:d,refreshInterval:c,savedQueryId:u,setFilters:f,setSavedQueryId:E,timelineId:g,to:h,toStr:v,updateKqlMode:y,updateReduxTime:b})}),((e,t)=>e.filterManager===t.filterManager&&e.from===t.from&&e.fromStr===t.fromStr&&e.to===t.to&&e.toStr===t.toStr&&e.isRefreshPaused===t.isRefreshPaused&&e.refreshInterval===t.refreshInterval&&e.timelineId===t.timelineId&&u()(e.dataProviders,t.dataProviders)&&u()(e.filters,t.filters)&&u()(e.filterQuery,t.filterQuery)&&u()(e.kqlMode,t.kqlMode)&&u()(e.savedQueryId,t.savedQueryId)&&u()(e.timelineId,t.timelineId)));Re.displayName="StatefulSearchOrFilterComponent";const Be=Object(d.connect)((()=>{const e=y.b.getTimelineByIdSelector(),t=y.b.getKqlFilterKuerySelector(),a=pe.d.getTimelineSelector(),i=pe.d.getTimelinePolicySelector();return(n,{timelineId:l})=>{var o;const s=null!==(o=e(n,l))&&void 0!==o?o:se.b,d=a(n),c=i(n);return{dataProviders:s.dataProviders,filterQuery:t(n,l),filters:s.filters,from:d.timerange.from,fromStr:d.timerange.fromStr,isRefreshPaused:"manual"===c.kind,kqlMode:Object(r.getOr)("filter","kqlMode",s),refreshInterval:c.duration,savedQueryId:Object(r.getOr)(null,"savedQueryId",s),to:d.timerange.to,toStr:d.timerange.toStr}}}),(e=>({applyKqlFilterQuery:({id:t,filterQuery:a})=>e(y.a.applyKqlFilterQuery({id:t,filterQuery:a})),updateKqlMode:({id:t,kqlMode:a})=>e(y.a.updateKqlMode({id:t,kqlMode:a})),setSavedQueryId:({id:t,savedQueryId:a})=>e(y.a.setSavedQueryId({id:t,savedQueryId:a})),setFilters:({id:t,filters:a})=>e(y.a.setFilters({id:t,filters:a})),updateReduxTime:Object(ge.b)(e)})))(Re);var $e=a(553);const Ae=({filterManager:e,show:t,showCallOutUnauthorizedMsg:a,status:r,timelineId:n})=>l.a.createElement(l.a.Fragment,null,a&&l.a.createElement(i.EuiCallOut,{"data-test-subj":"timelineCallOutUnauthorized",title:$e.b,color:"warning",iconType:"alert",size:"s"}),r===z.l.immutable&&l.a.createElement(i.EuiCallOut,{"data-test-subj":"timelineImmutableCallOut",title:$e.a,color:"primary",iconType:"alert",size:"s"}),t&&l.a.createElement(ue,{timelineId:n}),l.a.createElement(Be,{filterManager:e,timelineId:n})),Le=l.a.memo(Ae);var We=a(123),He=a(146),Ue=a(1114),Ge=a(274),Ve=a(1067),Xe=a(529),Ye=a(1127),Je=a(148),Ze=a(228),et=a(504),tt=a(616),at=a(1116),it=a(419),rt=a(1119),nt=a(13);const lt=s.a.div.withConfig({displayName:"TimelineHeaderContainer",componentId:"sc-fm1ksw-0"})(["margin-top:6px;width:100%;"]);lt.displayName="TimelineHeaderContainer";const ot=s()(i.EuiFlyoutHeader).withConfig({displayName:"StyledEuiFlyoutHeader",componentId:"sc-fm1ksw-1"})(["align-items:stretch;box-shadow:none;display:flex;flex-direction:column;&.euiFlyoutHeader{","}"],(({theme:e})=>`padding: ${e.eui.euiSizeM} ${e.eui.euiSizeS} 0 ${e.eui.euiSizeS};`)),st=s()(i.EuiFlyoutBody).withConfig({displayName:"StyledEuiFlyoutBody",componentId:"sc-fm1ksw-2"})(["overflow-y:hidden;flex:1;.euiFlyoutBody__overflow{overflow:hidden;mask-image:none;}.euiFlyoutBody__overflowContent{padding:0;height:100%;display:flex;}"]),dt=s()(i.EuiFlyoutFooter).withConfig({displayName:"StyledEuiFlyoutFooter",componentId:"sc-fm1ksw-3"})(["background:none;&.euiFlyoutFooter{","}"],(({theme:e})=>`padding: ${e.eui.euiSizeS} 0;`)),ct=s()(i.EuiFlexGroup).withConfig({displayName:"FullWidthFlexGroup",componentId:"sc-fm1ksw-4"})(["margin:0;width:100%;overflow:hidden;"]),ut=s()(i.EuiFlexItem).withConfig({displayName:"ScrollableFlexItem",componentId:"sc-fm1ksw-5"})([""," overflow:hidden;"],(({theme:e})=>`margin: 0 ${e.eui.euiSizeM};`)),mt=s()(i.EuiFlexItem).withConfig({displayName:"DatePicker",componentId:"sc-fm1ksw-6"})([".euiSuperDatePicker__flexWrapper{max-width:none;width:auto;}"]);mt.displayName="DatePicker";const pt=s()(i.EuiFlexItem).withConfig({displayName:"SourcererFlex",componentId:"sc-fm1ksw-7"})(["align-items:flex-end;"]);pt.displayName="SourcererFlex";const gt=s.a.div.withConfig({displayName:"VerticalRule",componentId:"sc-fm1ksw-8"})(["width:2px;height:100%;background:",";"],(({theme:e})=>e.eui.euiColorLightShade));gt.displayName="VerticalRule";const ht=s()(i.EuiBadge).withConfig({displayName:"EventsCountBadge",componentId:"sc-fm1ksw-9"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeS)),vt=[],yt=[],bt=({activeTab:e,columns:t,dataProviders:a,end:o,expandedDetail:s,filters:c,timelineId:u,isLive:O,itemsPerPage:k,itemsPerPageOptions:w,kqlMode:S,kqlQueryExpression:F,kqlQueryLanguage:M,onEventClosed:D,renderCellValue:N,rowRenderers:T,show:q,showCallOutUnauthorizedMsg:Q,showExpandedDetails:_,start:K,status:R,sort:B,timerangeKind:$})=>{var A;const L=Object(d.useDispatch)(),{portalNode:W}=Object(Xe.d)(),{setTimelineFullScreen:H,timelineFullScreen:U}=Object(Je.c)(),{browserFields:G,dataViewId:V,loading:X,indexPattern:Y,runtimeMappings:J,selectedPatterns:Z}=Object(C.d)(P.SourcererScopeName.timeline),{uiSettings:ee}=Object(f.k)().services,te=Object(nt.b)().isEnterprise()?6:5,ae=Object(n.useMemo)((()=>y.b.getTimelineByIdSelector()),[]),ie=Object(j.a)((e=>ae(e,null!=u?u:z.j.active))),re=ie.filterManager,ne=Object(n.useMemo)((()=>null!=re?re:new p.FilterManager(ee)),[re,ee]),le=Object(n.useMemo)((()=>Object(g.getEsQueryConfig)(ee)),[ee]),oe=Object(n.useMemo)((()=>({query:F.trim(),language:M})),[F,M]),se=Object(He.a)({config:le,dataProviders:a,indexPattern:Y,browserFields:G,filters:c,kqlQuery:oe,kqlMode:S});Object(v.a)({id:u,filterQuery:null==se?void 0:se.filterQuery,kqlError:null==se?void 0:se.kqlError,query:oe,startDate:K,endDate:o});const de=Object(r.isEmpty)(a)&&Object(r.isEmpty)(c)&&Object(r.isEmpty)(oe.query)&&void 0===(null==se?void 0:se.filterQuery),ce=Object(n.useMemo)((()=>null!=se&&null!=X&&!X&&!Object(r.isEmpty)(K)&&!Object(r.isEmpty)(o)&&void 0!==(null==se?void 0:se.filterQuery)),[se,o,X,K]),ue=B.map((({columnId:e,columnType:t,esTypes:a,sortDirection:i})=>({field:e,direction:i,esTypes:null!=a?a:[],type:t})));Object(n.useEffect)((()=>{L(y.a.initializeTimelineSettings({filterManager:ne,id:u}))}),[re,ie,L,ne,u,ee]);const[me,{events:pe,inspect:he,totalCount:ve,pageInfo:ye,loadPage:be,updatedAt:fe,refetch:Ee}]=Object(b.a)({dataViewId:V,endDate:o,fields:[...(Object(r.isEmpty)(t)?E.b:t).map((e=>e.id)),...Ge.h],filterQuery:null==se?void 0:se.filterQuery,id:u,indexNames:Z,language:oe.language,limit:k,runtimeMappings:J,skip:!ce,sort:ue,startDate:K,timerangeKind:$}),Ie=Object(n.useCallback)((()=>{var e;D({tabType:z.m.query,id:u}),null!==(e=s[z.m.query])&&void 0!==e&&e.panelView&&u===z.j.active&&_&&Ze.a.toggleExpandedDetail({})}),[D,u,s,_]);Object(n.useEffect)((()=>{L(y.a.updateIsLoading({id:u,isLoading:me||X}))}),[X,u,me,L]);const xe=Object(n.useMemo)((()=>se&&null!=se.kqlError||!1),[se]),Oe=Object(n.useMemo)((()=>Object(it.a)(te).map((e=>({...e,headerCellRender:at.a})))),[te]);return l.a.createElement(l.a.Fragment,null,l.a.createElement(m.a,{node:W},ve>=0?l.a.createElement(ht,null,ve):null),l.a.createElement(Ue.a,{id:`${u}-${z.m.query}`,inputId:h.a.timeline,inspect:he,loading:me,refetch:Ee,skip:!ce}),l.a.createElement(ct,{gutterSize:"none"},l.a.createElement(ut,{grow:2},l.a.createElement(ot,{"data-test-subj":`${e}-tab-flyout-header`,hasBorder:!1},l.a.createElement(i.EuiFlexGroup,{alignItems:"center",gutterSize:"s","data-test-subj":"timeline-date-picker-container"},U&&null!=H&&l.a.createElement(tt.b,{fullScreen:U,setFullScreen:H}),l.a.createElement(mt,{grow:10},l.a.createElement(ge.a,{id:h.a.timeline,timelineId:u,disabled:xe})),l.a.createElement(i.EuiFlexItem,{grow:!1},l.a.createElement(Ye.a,null)),l.a.createElement(pt,{grow:1},e===z.m.query&&l.a.createElement(rt.a,{scope:P.SourcererScopeName.timeline}))),l.a.createElement(lt,{"data-test-subj":"timelineHeader"},l.a.createElement(Le,{filterManager:ne,show:q&&e===z.m.query,showCallOutUnauthorizedMsg:Q,status:R,timelineId:u}))),l.a.createElement(Ve.a,null,l.a.createElement(st,{"data-test-subj":`${z.m.query}-tab-flyout-body`,className:"timeline-flyout-body"},l.a.createElement(I.a,{activePage:ye.activePage,browserFields:G,data:de?vt:pe,id:u,refetch:Ee,renderCellValue:N,rowRenderers:T,sort:B,tabType:z.m.query,totalPages:Object(We.h)({itemsCount:ve,itemsPerPage:k}),leadingControlColumns:Oe,trailingControlColumns:yt})),l.a.createElement(dt,{"data-test-subj":`${z.m.query}-tab-flyout-footer`,className:"timeline-flyout-footer"},!de&&l.a.createElement(x.a,{activePage:null!==(A=null==ye?void 0:ye.activePage)&&void 0!==A?A:0,"data-test-subj":"timeline-footer",updatedAt:fe,height:x.b,id:u,isLive:O,isLoading:me||X,itemsCount:de?0:pe.length,itemsPerPage:k,itemsPerPageOptions:w,onChangePage:be,totalCount:de?0:ve})))),_&&l.a.createElement(l.a.Fragment,null,l.a.createElement(gt,null),l.a.createElement(ut,{grow:1},l.a.createElement(et.a,{browserFields:G,handleOnPanelClosed:Ie,runtimeMappings:J,tabType:z.m.query,scopeId:u})))))},ft=Object(d.connect)((()=>{const e=y.b.getShowCallOutUnauthorizedMsg(),t=y.b.getTimelineByIdSelector(),a=y.b.getKqlFilterKuerySelector(),i=pe.d.getTimelineSelector();return(n,{timelineId:l})=>{var o,s,d,c,u;const m=null!==(o=t(n,l))&&void 0!==o?o:se.b,p=i(n),{activeTab:g,columns:h,dataProviders:v,expandedDetail:y,filters:b,itemsPerPage:f,itemsPerPageOptions:E,kqlMode:I,show:x,sort:O,status:k,timelineType:w}=m,S=a(n,l),P="filter"===I&&b||[],C=Object(r.isEmpty)(v)&&Object(r.isEmpty)(null!==(s=null==S?void 0:S.expression)&&void 0!==s?s:"")&&"template"===w?" ":null!==(d=null==S?void 0:S.expression)&&void 0!==d?d:"",j=Object(r.isEmpty)(v)&&"template"===w?"kuery":null!==(c=null==S?void 0:S.kind)&&void 0!==c?c:"kuery";return{activeTab:g,columns:h,dataProviders:v,end:p.timerange.to,expandedDetail:y,filters:P,timelineId:l,isLive:"interval"===p.policy.kind,itemsPerPage:f,itemsPerPageOptions:E,kqlMode:I,kqlQueryExpression:C,kqlQueryLanguage:j,showCallOutUnauthorizedMsg:e(n),show:x,showExpandedDetails:!!y[z.m.query]&&!(null===(u=y[z.m.query])||void 0===u||!u.panelView),sort:O,start:p.timerange.from,status:k,timerangeKind:p.timerange.kind}}}),((e,{timelineId:t})=>({onEventClosed:t=>{e(y.a.toggleDetailPanel(t))}})))(l.a.memo(bt,((e,t)=>((e,t)=>e.kqlMode===t.kqlMode&&e.kqlQueryExpression===t.kqlQueryExpression&&u()(e.filters,t.filters))(e,t)&&e.activeTab===t.activeTab&&((e,t)=>e.end===t.end&&e.start===t.start&&e.timerangeKind===t.timerangeKind)(e,t)&&e.isLive===t.isLive&&e.itemsPerPage===t.itemsPerPage&&e.onEventClosed===t.onEventClosed&&e.show===t.show&&e.showCallOutUnauthorizedMsg===t.showCallOutUnauthorizedMsg&&e.showExpandedDetails===t.showExpandedDetails&&e.status===t.status&&e.timelineId===t.timelineId&&u()(e.columns,t.columns)&&u()(e.dataProviders,t.dataProviders)&&u()(e.itemsPerPageOptions,t.itemsPerPageOptions)&&u()(e.sort,t.sort))))}}]);