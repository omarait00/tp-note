/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[11],{1119:function(e,t,a){"use strict";a.d(t,"a",(function(){return Fe}));var i=a(32),n=a(4),s=a.n(n),l=a(78),r=a(0);const o=r.i18n.translate("xpack.securitySolution.indexPatterns.callOutTitle",{defaultMessage:"Data view cannot be modified on this page"}),c=r.i18n.translate("xpack.securitySolution.indexPatterns.callOutDeprecxatedTitle",{defaultMessage:"This timeline uses a legacy data view selector"}),u=r.i18n.translate("xpack.securitySolution.indexPatterns.callOutDeprecxatedTemplateTitle",{defaultMessage:"This timeline template uses a legacy data view selector"}),d=r.i18n.translate("xpack.securitySolution.indexPatterns.callOutMissingPatternsTitle",{defaultMessage:"This timeline is out of date with the Security Data View"}),m=r.i18n.translate("xpack.securitySolution.indexPatterns.callOutMissingPatternsTemplateTitle",{defaultMessage:"This timeline template is out of date with the Security Data View"}),p=r.i18n.translate("xpack.securitySolution.indexPatterns.callOutTimelineTitle",{defaultMessage:"Data view cannot be modified when show only detection alerts is selected"}),g=r.i18n.translate("xpack.securitySolution.indexPatterns.toggleToNewSourcerer.link",{defaultMessage:"here"}),b=r.i18n.translate("xpack.securitySolution.indexPatterns.dataViewLabel",{defaultMessage:"Data view"}),y=r.i18n.translate("xpack.securitySolution.indexPatterns.updateDataView",{defaultMessage:"Would you like to add this index pattern to Security Data View? Otherwise, we can recreate the data view without the missing index patterns."}),f=r.i18n.translate("xpack.securitySolution.indexPatterns.updateSecurityDataView",{defaultMessage:"Update Security Data View"}),E=r.i18n.translate("xpack.securitySolution.indexPatterns.continue",{defaultMessage:"Continue without adding"}),x=r.i18n.translate("xpack.securitySolution.indexPatterns.add",{defaultMessage:"Add index pattern"}),h=r.i18n.translate("xpack.securitySolution.indexPatterns.modifiedBadgeTitle",{defaultMessage:"Modified"}),S=r.i18n.translate("xpack.securitySolution.indexPatterns.alertsBadgeTitle",{defaultMessage:"Alerts"}),w=r.i18n.translate("xpack.securitySolution.indexPatterns.updateAvailableBadgeTitle",{defaultMessage:"Update available"}),k=r.i18n.translate("xpack.securitySolution.indexPatterns.securityDefaultDataViewLabel",{defaultMessage:"Security Default Data View"}),P=r.i18n.translate("xpack.securitySolution.indexPatterns.securityDataViewLabel",{defaultMessage:"Security Data View"}),j=r.i18n.translate("xpack.securitySolution.indexPatterns.selectDataView",{defaultMessage:"Data view selection"}),v=r.i18n.translate("xpack.securitySolution.indexPatterns.save",{defaultMessage:"Save"}),O=r.i18n.translate("xpack.securitySolution.indexPatterns.chooseDataViewLabel",{defaultMessage:"Choose data view"}),M=r.i18n.translate("xpack.securitySolution.indexPatterns.advancedOptionsTitle",{defaultMessage:"Advanced options"}),C=r.i18n.translate("xpack.securitySolution.indexPatterns.indexPatternsLabel",{defaultMessage:"Index patterns"}),T=r.i18n.translate("xpack.securitySolution.indexPatterns.descriptionsLabel",{defaultMessage:"These are the index patterns currently selected. Filtering out index patterns from your data view can help improve overall performance."}),D=r.i18n.translate("xpack.securitySolution.sourcerer.disabled",{defaultMessage:"The updates to the Data view require a page reload to take effect."}),I=r.i18n.translate("xpack.securitySolution.indexPatterns.update",{defaultMessage:"Update and recreate data view"}),V=r.i18n.translate("xpack.securitySolution.indexPatterns.resetButton",{defaultMessage:"Reset"}),F=r.i18n.translate("xpack.securitySolution.indexPatterns.closeButton",{defaultMessage:"Close"}),N=r.i18n.translate("xpack.securitySolution.indexPatterns.inactive",{defaultMessage:"Inactive index patterns"}),B=r.i18n.translate("xpack.securitySolution.indexPatterns.noData",{defaultMessage:"The index pattern on this timeline doesn't match any data streams, indices, or index aliases."}),z=r.i18n.translate("xpack.securitySolution.indexPatterns.pickIndexPatternsCombo",{defaultMessage:"Pick index patterns"}),L=r.i18n.translate("xpack.securitySolution.indexPatterns.onlyDetectionAlertsLabel",{defaultMessage:"Show only detection alerts"}),R=r.i18n.translate("xpack.securitySolution.indexPatterns.successToastTitle",{defaultMessage:"One or more settings require you to reload the page to take effect"}),A=r.i18n.translate("xpack.securitySolution.indexPatterns.reloadPageTitle",{defaultMessage:"Reload page"}),U=r.i18n.translate("xpack.securitySolution.indexPatterns.failureToastTitle",{defaultMessage:"Unable to update data view"});var q=a(177),W=a(81),_=a(95),$=a(317),Y=a(741),G=a(33),H=a.n(G);const K=H()(i.EuiFormRow).withConfig({displayName:"FormRow",componentId:"sc-tzfq9h-0"})(["display:",";max-width:none;"],(({$expandAdvancedOptions:e})=>e?"flex":"none")),J=H()(i.EuiFormRow).withConfig({displayName:"StyledFormRow",componentId:"sc-tzfq9h-1"})(["max-width:none;"]),Q=H()(i.EuiButtonEmpty).withConfig({displayName:"StyledButton",componentId:"sc-tzfq9h-2"})(["&:enabled:focus,&:focus{background-color:transparent;}"]),X=H()(i.EuiButtonEmpty).withConfig({displayName:"ResetButton",componentId:"sc-tzfq9h-3"})(["width:fit-content;&:enabled:focus,&:focus{background-color:transparent;}"]),Z=H.a.div.withConfig({displayName:"PopoverContent",componentId:"sc-tzfq9h-4"})(["width:600px;"]),ee=H()(i.EuiBadge).withConfig({displayName:"StyledBadge",componentId:"sc-tzfq9h-5"})(["margin-left:8px;&,.euiBadge__text{cursor:pointer;}"]),te=H.a.span.withConfig({displayName:"Blockquote",componentId:"sc-tzfq9h-6"})(["",""],(({theme:e})=>Object(G.css)(["display:block;border-color:",";border-left:",";margin:"," 0 "," ",";padding:",";"],e.eui.euiColorDarkShade,e.eui.euiBorderThick,e.eui.euiSizeS,e.eui.euiSizeS,e.eui.euiSizeS,e.eui.euiSizeS))),ae=(e,t)=>e.filter((e=>e!==t));var ie=a(742);const ne=(e,t)=>Object(ie.b)(e).map((e=>({label:e,value:e,...null!=t?{disabled:!t.includes(e)}:{}})));var se=a(35);const le=H()(i.EuiModal).withConfig({displayName:"MyEuiModal",componentId:"sc-1c0zuny-0"})([".euiModal__flex{width:60vw;}.euiCodeBlock{height:auto !important;max-width:718px;}z-index:99999999;"]),re=s.a.memo((({isShowing:e,onDismissModal:t,onContinue:a,onUpdate:n,missingPatterns:l})=>e?s.a.createElement(le,{onClose:t,"data-test-subj":"sourcerer-update-data-view-modal"},s.a.createElement(i.EuiModalHeader,null,s.a.createElement(i.EuiModalHeaderTitle,null,s.a.createElement("h1",null,f))),s.a.createElement(i.EuiModalBody,null,s.a.createElement(i.EuiText,{size:"s"},s.a.createElement(i.EuiTextColor,{color:"subdued"},s.a.createElement("p",null,s.a.createElement(se.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.missingPatterns",defaultMessage:"Security Data View is missing the following index patterns in order to recreate the previous timeline's data view: {callout}",values:{callout:s.a.createElement(te,null,l.join(", "))}}),y))),s.a.createElement(i.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd"},s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(X,{"aria-label":E,"data-test-subj":"sourcerer-continue-close",flush:"left",onClick:a,title:E},E)),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiButton,{"data-test-subj":"sourcerer-update-data-view",fill:!0,fullWidth:!0,onClick:n,size:"s"},x))))):null));re.displayName="UpdateDefaultDataViewModal";var oe=a(104),ce=a(86),ue=a(112);const de=({activePatterns:e,deadPatterns:t,selectedPatterns:a,timelineType:l})=>{const r=Object(n.useMemo)((()=>t.length>0?s.a.createElement(i.EuiToolTip,{content:s.a.createElement(me,{activePatterns:e,selectedPatterns:a,timelineType:l})},s.a.createElement(i.EuiIcon,{type:"questionInCircle",title:N})):null),[e,t.length,a,l]);return l===oe.g.template?s.a.createElement(se.FormattedMessage,{"data-test-subj":"sourcerer-current-patterns-message",id:"xpack.securitySolution.indexPatterns.timelineTemplate.currentPatterns",defaultMessage:"The active index patterns in this timeline template are{tooltip}: {callout}",values:{tooltip:r,callout:s.a.createElement(te,null,e.join(", "))}}):s.a.createElement(se.FormattedMessage,{"data-test-subj":"sourcerer-current-patterns-message",id:"xpack.securitySolution.indexPatterns.timeline.currentPatterns",defaultMessage:"The active index patterns in this timeline are{tooltip}: {callout}",values:{tooltip:r,callout:s.a.createElement(te,null,e.join(", "))}})},me=({activePatterns:e,selectedPatterns:t,timelineType:a})=>{const i=Object(n.useMemo)((()=>t.filter((t=>!e.includes(t))).join(", ")),[e,t]);return a===oe.g.template?s.a.createElement(se.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timelineTemplate.noMatchData",defaultMessage:"The following index patterns are saved to this timeline template but do not match any data streams, indices, or index aliases: {aliases}",values:{aliases:i}}):s.a.createElement(se.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timeline.noMatchData",defaultMessage:"The following index patterns are saved to this timeline but do not match any data streams, indices, or index aliases: {aliases}",values:{aliases:i}})},pe=({timelineType:e,selectedPatterns:t})=>{const a=Object(n.useMemo)((()=>s.a.createElement(te,null,t.join(", "))),[t]);return e===oe.g.template?s.a.createElement(se.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timelineTemplate.currentPatternsBad",defaultMessage:"The current index patterns in this timeline template are: {callout}",values:{callout:a}}):s.a.createElement(se.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timeline.currentPatternsBad",defaultMessage:"The current index patterns in this timeline are: {callout}",values:{callout:a}})},ge=({onReset:e,timelineType:t})=>t===oe.g.template?s.a.createElement(se.FormattedMessage,{"data-test-subj":"sourcerer-deprecated-message",id:"xpack.securitySolution.indexPatterns.timelineTemplate.toggleToNewSourcerer",defaultMessage:"We have preserved your timeline template by creating a temporary data view. If you'd like to modify your data, we can recreate your temporary data view with the new data view selector. You can also manually select a data view {link}.",values:{link:s.a.createElement(i.EuiLink,{onClick:e},g)}}):s.a.createElement(se.FormattedMessage,{"data-test-subj":"sourcerer-deprecated-message",id:"xpack.securitySolution.indexPatterns.timeline.toggleToNewSourcerer",defaultMessage:"We have preserved your timeline by creating a temporary data view. If you'd like to modify your data, we can recreate your temporary data view with the new data view selector. You can also manually select a data view {link}.",values:{link:s.a.createElement(i.EuiLink,{onClick:e},g)}}),be=({onReset:e,timelineType:t})=>t===oe.g.template?s.a.createElement(se.FormattedMessage,{"data-test-subj":"sourcerer-missing-patterns-message",id:"xpack.securitySolution.indexPatterns.missingPatterns.timelineTemplate.description",defaultMessage:"We have preserved your timeline template by creating a temporary data view. If you'd like to modify your data, we can add the missing index patterns to the Security Data View. You can also manually select a data view {link}.",values:{link:s.a.createElement(i.EuiLink,{onClick:e},g)}}):s.a.createElement(se.FormattedMessage,{"data-test-subj":"sourcerer-missing-patterns-message",id:"xpack.securitySolution.indexPatterns.missingPatterns.timeline.description",defaultMessage:"We have preserved your timeline by creating a temporary data view. If you'd like to modify your data, we can add the missing index patterns to the Security Data View. You can also manually select a data view {link}.",values:{link:s.a.createElement(i.EuiLink,{onClick:e},g)}}),ye={deprecated:{title:{[oe.g.default]:c,[oe.g.template]:u},update:I},missingPatterns:{title:{[oe.g.default]:d,[oe.g.template]:m},update:x}},fe=s.a.memo((({activePatterns:e,indicesExist:t,isModified:a,onDismiss:l,onReset:r,onUpdate:o,selectedPatterns:c,missingPatterns:u})=>{const d=Object(n.useMemo)((()=>s.a.createElement(i.EuiButton,{"data-test-subj":"sourcerer-deprecated-update",fill:!0,fullWidth:!0,onClick:o,size:"s",disabled:!t},ye[a].update)),[t,a,o]),m=Object(n.useMemo)((()=>t?d:s.a.createElement(i.EuiToolTip,{position:"top",content:B,"data-test-subj":"sourcerer-tooltip"},d)),[t,d]),p=e&&e.length>0?c.filter((t=>!e.includes(t))):[],g=Object(n.useMemo)((()=>ce.b.getTimelineByIdSelector()),[]),b=Object(W.a)((e=>{var t;return(null!==(t=g(e,oe.d.active))&&void 0!==t?t:ue.b).timelineType}));return s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiCallOut,{color:"warning","data-test-subj":"sourcerer-deprecated-callout",iconType:"alert",size:"s",title:ye[a].title[b]}),s.a.createElement(i.EuiSpacer,{size:"s"}),s.a.createElement(i.EuiText,{size:"s"},s.a.createElement(i.EuiTextColor,{color:"subdued"},s.a.createElement("p",null,e&&e.length>0?s.a.createElement(de,{timelineType:b,activePatterns:e,deadPatterns:p,selectedPatterns:c}):s.a.createElement(pe,{timelineType:b,selectedPatterns:c}),"deprecated"===a&&s.a.createElement(ge,{timelineType:b,onReset:r}),"missingPatterns"===a&&s.a.createElement(s.a.Fragment,null,s.a.createElement(se.FormattedMessage,{"data-test-subj":"sourcerer-missing-patterns-callout",id:"xpack.securitySolution.indexPatterns.missingPatterns.callout",defaultMessage:"Security Data View is missing the following index patterns: {callout}",values:{callout:s.a.createElement(te,null,u.join(", "))}}),s.a.createElement(be,{timelineType:b,onReset:r}))))),s.a.createElement(i.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd"},s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(X,{"aria-label":F,"data-test-subj":"sourcerer-deprecated-close",flush:"left",onClick:l,title:F},F)),s.a.createElement(i.EuiFlexItem,{grow:!1},m)))}));fe.displayName="TemporarySourcererComp";const Ee=s.a.memo((({activePatterns:e,indicesExist:t,isModified:a,missingPatterns:i,onContinueWithoutUpdate:n,onDismiss:l,onReset:r,onUpdateStepOne:o,onUpdateStepTwo:c,selectedPatterns:u,isShowingUpdateModal:d,onDismissModal:m})=>s.a.createElement(s.a.Fragment,null,s.a.createElement(fe,{activePatterns:e,indicesExist:t,isModified:a,missingPatterns:i,onDismiss:l,onReset:r,onUpdate:o,selectedPatterns:u}),s.a.createElement(re,{isShowing:d,missingPatterns:i,onDismissModal:m,onContinue:n,onUpdate:c}))));Ee.displayName="TemporarySourcerer";var xe=a(94),he=a(41),Se=a(77),we=a(1);const ke=H()(i.EuiButton).withConfig({displayName:"StyledRefreshButton",componentId:"sc-1lqcqbd-0"})(["float:right;"]),Pe=s.a.memo((()=>{const e=Object(n.useCallback)((()=>{document.location.reload()}),[]);return s.a.createElement(ke,{onClick:e,"data-test-subj":"page-refresh"},A)}));Pe.displayName="RefreshButton";var je=a(84);const ve=({activePatterns:e,disabled:t,isModified:a,isOnlyDetectionAlerts:l,isPopoverOpen:r,isTimelineSourcerer:o,loading:c,onClick:u,selectedPatterns:d,signalIndexName:m})=>{const p=Object(n.useMemo)((()=>{switch(a){case"modified":return s.a.createElement(ee,{"data-test-subj":"sourcerer-modified-badge"},h);case"alerts":return s.a.createElement(ee,{"data-test-subj":"sourcerer-alerts-badge"},S);case"deprecated":return s.a.createElement(ee,{color:"warning","data-test-subj":"sourcerer-deprecated-badge"},w);case"missingPatterns":return s.a.createElement(ee,{color:"warning","data-test-subj":"sourcerer-missingPatterns-badge"},w);default:return null}}),[a]),g=Object(n.useMemo)((()=>s.a.createElement(Q,{"aria-label":b,"data-test-subj":o?"timeline-sourcerer-trigger":"sourcerer-trigger",flush:"left",iconSide:"right",iconType:"arrowDown",disabled:t,isLoading:c,onClick:u,title:b},b,!t&&p)),[t,p,o,c,u]),y=Object(n.useMemo)((()=>t?D:(({isOnlyDetectionAlerts:e,isPopoverOpen:t,selectedPatterns:a,signalIndexName:i})=>t||e&&!i?null:(e?[i]:a).join(", "))({isOnlyDetectionAlerts:l,isPopoverOpen:r,selectedPatterns:null!=e?e:d,signalIndexName:m})),[e,t,l,r,d,m]);return y?s.a.createElement(i.EuiToolTip,{position:"top",content:y,"data-test-subj":"sourcerer-tooltip"},g):g},Oe=Object(n.memo)(ve),Me=s.a.memo((({isOnlyDetectionAlerts:e,title:t})=>e?s.a.createElement(i.EuiCallOut,{"data-test-subj":"sourcerer-callout",iconType:"iInCircle",size:"s",title:t}):null));Me.displayName="SourcererCallout";const Ce=s.a.memo((({onChange:e,checked:t,isShow:a})=>a?s.a.createElement(J,null,s.a.createElement(i.EuiCheckbox,{checked:t,"data-test-subj":"sourcerer-alert-only-checkbox",id:"sourcerer-alert-only-checkbox",label:L,onChange:e})):null));Ce.displayName="AlertsCheckbox";const Te=s.a.memo((({disableSave:e,isShow:t,onReset:a,onSave:n})=>t?s.a.createElement(J,null,s.a.createElement(i.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd"},s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(X,{"aria-label":V,"data-test-subj":"sourcerer-reset",flush:"left",onClick:a,title:V},V)),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiButton,{onClick:n,disabled:e,"data-test-subj":"sourcerer-save",fill:!0,fullWidth:!0,size:"s"},v)))):null));Te.displayName="SaveButtons";var De=a(683),Ie=a(169),Ve=a(281);const Fe=s.a.memo((({scope:e})=>{const t=Object(l.useDispatch)(),a=e===_.SourcererScopeName.detections,r=e===_.SourcererScopeName.timeline,c=e===_.SourcererScopeName.default,u=Object(Ie.d)(Ve.a.sourcerer),d=Object(n.useMemo)((()=>q.d.getSourcererScopeSelector()),[]),{defaultDataView:m,kibanaDataViews:b,signalIndexName:y,sourcererScope:{selectedDataViewId:f,selectedPatterns:E,missingPatterns:x}}=Object(W.a)((t=>d(t,e))),{pollForSignalIndex:w}=Object(De.a)();Object(n.useEffect)((()=>{null!=w&&(r||a)&&w()}),[a,r,w]);const{activePatterns:v,indicesExist:D,loading:I}=Object(xe.d)(e),[V,F]=Object(n.useState)(v&&v.length>0?x.filter((e=>v.includes(e))):[]);Object(n.useEffect)((()=>{v&&v.length>0&&F(x.filter((e=>v.includes(e))))}),[v,x]);const[N,B]=Object(n.useState)(r&&E.join()===y),L=Object(n.useCallback)((()=>{B(r&&E.join()===y)}),[r,E,y]);Object(n.useEffect)((()=>{L()}),[E]);const A=a||r&&N,[G,H]=Object(n.useState)(!1),[X,te]=Object(n.useState)(f),{allOptions:le,dataViewSelectOptions:re,loadingIndexPatterns:oe,isModified:ce,handleOutsideClick:ue,onChangeCombo:de,renderOption:me,selectedOptions:pe,setIndexPatternsByDataView:ge}=(({dataViewId:e,defaultDataViewId:t,isOnlyDetectionAlerts:a,kibanaDataViews:r,missingPatterns:o,scopeId:c,selectedDataViewId:u,selectedPatterns:d,signalIndexName:m})=>{const p=Object(l.useDispatch)(),g=Object(n.useRef)(!0),[b,y]=Object(n.useState)(!1),f=Object(n.useMemo)((()=>m?ne([m]):[]),[m]),[E,x]=Object(n.useState)(a?f:ne(d)),[w,j]=Object(n.useState)(null==e?"deprecated":o.length>0?"missingPatterns":""),{allPatterns:v,selectablePatterns:O}=Object(n.useMemo)((()=>{if(a&&m)return{allPatterns:[m],selectablePatterns:[m]};const t=r.find((t=>t.id===e));if(null==t)return{allPatterns:[],selectablePatterns:[]};const i=[...new Set(t.title.split(","))];return c===q.b.SourcererScopeName.default?{allPatterns:ae(i,m),selectablePatterns:ae(t.patternList,m)}:{allPatterns:i,selectablePatterns:t.patternList}}),[e,a,r,c,m]),M=Object(n.useMemo)((()=>ne(v,O)),[v,O]),C=Object(n.useCallback)(((e,a=!1)=>c===_.SourcererScopeName.detections||a?f:ne(Object(Y.b)(r.find((t=>t.id===e)),c,m,e===t))),[f,r,c,m,t]),T=Object(n.useMemo)((()=>null!=e?C(e):[]),[e,C]),D=Object(n.useCallback)(((e,t)=>{if(null==t)return j("deprecated");if(o.length>0)return j("missingPatterns");if(a)return j("alerts");const i=T.length!==e.length||!T.every((t=>e.find((e=>t.value===e))));return j(i?"modified":"")}),[T,a,o.length]);Object(n.useEffect)((()=>{x(c===_.SourcererScopeName.detections?f:ne(d))}),[d,c]),Object(n.useEffect)((()=>{D(d.map((e=>e)),u)}),[a,u,o,c,d]);const I=Object(n.useCallback)((e=>{x(e)}),[]),V=Object(n.useCallback)((({value:e})=>s.a.createElement("span",{"data-test-subj":"sourcerer-combo-option"},e)),[]),F=Object(n.useCallback)((async(e,t)=>{if(r.some((t=>t.id===e&&0===t.indexFields.length))){try{y(!0),x([]);const t=await Object($.a)(e);g.current&&(p(q.a.setDataView(t)),x(a?f:ne(t.patternList)))}catch(e){}y(!1)}else x(C(e,t))}),[f,p,C,a,r]),N=Object(n.useMemo)((()=>null!=e?(({dataViewId:e,defaultDataViewId:t,isModified:a,isOnlyDetectionAlerts:n,kibanaDataViews:l})=>n?[{inputDisplay:s.a.createElement("span",{"data-test-subj":"security-alerts-option-super"},s.a.createElement(i.EuiIcon,{type:"logoSecurity",size:"s"})," ",P,s.a.createElement(ee,{"data-test-subj":"security-alerts-option-badge"},S)),value:t}]:l.map((({title:n,id:l})=>({inputDisplay:l===t?s.a.createElement("span",{"data-test-subj":"security-option-super"},s.a.createElement(i.EuiIcon,{type:"logoSecurity",size:"s"})," ",k,a&&l===e&&s.a.createElement(ee,{"data-test-subj":"security-modified-option-badge"},h)):s.a.createElement("span",{"data-test-subj":"dataView-option-super"},s.a.createElement(i.EuiIcon,{type:"logoKibana",size:"s"})," ",n,a&&l===e&&s.a.createElement(ee,{"data-test-subj":"security-modified-option-badge"},h)),value:l}))))({dataViewId:e,defaultDataViewId:t,isModified:"modified"===w,isOnlyDetectionAlerts:a,kibanaDataViews:r}):[]),[e,t,w,a,r]);return Object(n.useEffect)((()=>(g.current=!0,()=>{g.current=!1})),[]),{allOptions:M,dataViewSelectOptions:N,loadingIndexPatterns:b,handleOutsideClick:Object(n.useCallback)((()=>{x(ne(d))}),[d]),isModified:w,onChangeCombo:I,renderOption:V,selectedOptions:E,setIndexPatternsByDataView:F}})({dataViewId:X,defaultDataViewId:m.id,isOnlyDetectionAlerts:A,kibanaDataViews:b,missingPatterns:V,scopeId:e,selectedDataViewId:f,selectedPatterns:E,signalIndexName:y}),be=Object(n.useCallback)((e=>{B(e.target.checked),te(m.id),ge(m.id,e.target.checked)}),[m.id,ge]),[ye,fe]=Object(n.useState)(!1),[ke,ve]=Object(n.useState)(!1),Fe=Object(n.useCallback)((()=>{H((e=>!e)),fe(!1)}),[]),Ne=Object(n.useCallback)(((a,i,n)=>{t(q.a.setSelectedDataView({id:e,selectedDataViewId:a,selectedPatterns:i,shouldValidateSelectedPatterns:n})),c&&u({[_.SourcererScopeName.default]:{id:a,selectedPatterns:i}})}),[t,e,c,u]),Be=Object(n.useCallback)((e=>{te(e),ge(e)}),[ge]),ze=Object(n.useCallback)((()=>{te(m.id),ge(m.id),B(!1),F([])}),[m.id,ge]),Le=Object(n.useCallback)((()=>{const e=pe.map((e=>e.label));null!=X&&Ne(X,e),H(!1)}),[Ne,X,pe]),Re=Object(n.useCallback)((()=>{H(!1),fe(!1)}),[]),Ae=Object(n.useCallback)((()=>{ve(!1);const e=E.filter((e=>m.patternList.includes(e)));Ne(m.id,e),H(!1)}),[m.id,m.patternList,Ne,E]),Ue=Object(n.useCallback)((()=>{0===V.length?Ae():ve(!0)}),[V,Ae]),[qe,We]=Object(n.useState)(!1),_e=(e=>{const{theme:t,uiSettings:a}=Object(Se.k)().services,{addSuccess:l,addError:r}=Object(je.a)();return Object(n.useCallback)((async n=>{const[o,c]=await(async()=>{try{const e=[...a.get(we.S),...n];return[await a.set(we.S,Object(ie.a)(e)),null]}catch(e){return[!1,e]}})();return o?(l({color:"success",title:Object(he.toMountPoint)(R,{theme$:t.theme$}),text:Object(he.toMountPoint)(s.a.createElement(Pe,null),{theme$:t.theme$}),iconType:void 0,toastLifeTimeMs:6e5}),!0):(r(null!==c?c:new Error(U),{title:U,toastMessage:s.a.createElement(s.a.Fragment,null,s.a.createElement(se.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.failureToastText",defaultMessage:"Unexpected error occurred on update. If you would like to modify your data, you can manually select a data view {link}.",values:{link:s.a.createElement(i.EuiLink,{onClick:e,"data-test-subj":"failureToastLink"},g)}}))}),!1)}),[r,l,e,t.theme$,a])})(Object(n.useCallback)((()=>{H(!0),ze()}),[ze])),$e=Object(n.useCallback)((async()=>{const e=await _e(V);ve(!1),H(!1),e&&(Ne(m.id,null!=v?v:E,!1),We(!0))}),[v,m.id,V,Ne,E,_e]);Object(n.useEffect)((()=>{te(f)}),[f]);const Ye=Object(n.useCallback)((()=>{te(f),F(x),L(),ue()}),[ue,L,f,x]),Ge=Object(n.useCallback)((()=>{fe((e=>!e))}),[]);return D||e===_.SourcererScopeName.timeline?s.a.createElement(i.EuiPopover,{panelClassName:"sourcererPopoverPanel",button:s.a.createElement(Oe,{activePatterns:v,disabled:qe,isModified:ce,isOnlyDetectionAlerts:A,isPopoverOpen:G,isTimelineSourcerer:r,loading:I,onClick:Fe,selectedPatterns:E,signalIndexName:y}),closePopover:Re,"data-test-subj":r?"timeline-sourcerer-popover":"sourcerer-popover",display:"block",isOpen:G,ownFocus:!0,repositionOnScroll:!0},s.a.createElement(i.EuiOutsideClickDetector,{onOutsideClick:Ye},s.a.createElement(Z,null,s.a.createElement(i.EuiPopoverTitle,{"data-test-subj":"sourcerer-title"},s.a.createElement(s.a.Fragment,null,j)),s.a.createElement(Me,{isOnlyDetectionAlerts:A,title:r?p:o}),s.a.createElement(i.EuiSpacer,{size:"s"}),null===X&&"deprecated"===ce||"missingPatterns"===ce?s.a.createElement(Ee,{activePatterns:v,indicesExist:D,isModified:ce,isShowingUpdateModal:ke,missingPatterns:V,onContinueWithoutUpdate:Ae,onDismiss:Fe,onDismissModal:()=>ve(!1),onReset:ze,onUpdateStepOne:"deprecated"===ce?Ue:$e,onUpdateStepTwo:$e,selectedPatterns:E}):s.a.createElement(i.EuiForm,{component:"form"},s.a.createElement(s.a.Fragment,null,s.a.createElement(Ce,{isShow:r,checked:N,onChange:be}),X&&s.a.createElement(J,{label:O},s.a.createElement(i.EuiSuperSelect,{"data-test-subj":"sourcerer-select",isLoading:oe,disabled:A,fullWidth:!0,onChange:Be,options:re,placeholder:O,valueOfSelected:X})),s.a.createElement(i.EuiSpacer,{size:"m"}),s.a.createElement(Q,{color:"text","data-test-subj":"sourcerer-advanced-options-toggle",iconType:ye?"arrowDown":"arrowRight",onClick:Ge},M),ye&&s.a.createElement(i.EuiSpacer,{size:"m"}),s.a.createElement(K,{isDisabled:oe,$expandAdvancedOptions:ye,helpText:A?void 0:T,label:C},s.a.createElement(i.EuiComboBox,{"data-test-subj":"sourcerer-combo-box",fullWidth:!0,isDisabled:A||oe,onChange:de,options:le,placeholder:z,renderOption:me,selectedOptions:pe})),s.a.createElement(Te,{disableSave:0===pe.length,isShow:!a,onReset:ze,onSave:Le})),s.a.createElement(i.EuiSpacer,{size:"s"}))))):null}));Fe.displayName="Sourcerer"}}]);