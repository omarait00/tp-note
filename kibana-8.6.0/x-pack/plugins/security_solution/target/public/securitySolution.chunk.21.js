/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[21],Array(88).concat([function(e,t,n){"use strict";n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return h}));var a=n(32),i=n(4),r=n.n(i),o=n(33),s=n.n(o),l=n(133),c=n(102),u=n(87),d=n(106),p=n(150);const m=({field:e,tooltipContent:t})=>null!=t?t:e,g=r.a.memo((({children:e,field:t,tooltipContent:n,tooltipPosition:i,value:o})=>(e=>null===e)(n)?r.a.createElement(r.a.Fragment,null,e||o):r.a.createElement(a.EuiToolTip,{"data-test-subj":`${t}-tooltip`,position:i,content:m({tooltipContent:n,field:t})},r.a.createElement(r.a.Fragment,null,e||o))));g.displayName="Content";const f=r.a.memo((({hideTopN:e=!1,id:t,isDraggable:n=!0,field:a,fieldType:o="",isAggregatable:s=!1,value:u,name:m,children:f,scopeId:b,tooltipContent:y,tooltipPosition:h,queryValue:v})=>{const E=Object(i.useMemo)((()=>{var e;return{and:[],enabled:!0,id:Object(c.h)(t),name:m||(null!==(e=null==u?void 0:u.toString())&&void 0!==e?e:""),excluded:!1,kqlQuery:"",queryMatch:{field:a,value:v||(null!=u?u:""),operator:d.d}}}),[a,t,m,v,u]),x=Object(i.useCallback)(((e,t,n)=>n.isDragging?r.a.createElement(l.a,null,r.a.createElement(p.a,{dataProvider:e})):r.a.createElement(g,{field:a,tooltipContent:y,tooltipPosition:h,value:u},f)),[f,a,y,h,u]);return null==u?null:r.a.createElement(l.b,{dataProvider:E,fieldType:o,isAggregatable:s,hideTopN:e,isDraggable:n,render:x,scopeId:b})}));f.displayName="DefaultDraggable";const b=s()(a.EuiBadge).withConfig({displayName:"Badge",componentId:"sc-ymm8sh-0"})(["vertical-align:top;"]);b.displayName="Badge";const y=({contextId:e,eventId:t,field:n,value:a,iconType:i,isDraggable:o,isAggregatable:s,fieldType:l,name:c,color:d="hollow",children:p,scopeId:m,tooltipContent:g,queryValue:y})=>null!=a?r.a.createElement(f,{id:`draggable-badge-default-draggable-${e}-${t}-${n}-${a}`,isDraggable:o,isAggregatable:s,fieldType:l,field:n,name:c,value:a,scopeId:m,tooltipContent:g,queryValue:y},r.a.createElement(b,{iconType:i,color:d,title:""},p||(""!==a?a:Object(u.c)()))):null;y.displayName="DraggableBadgeComponent";const h=r.a.memo(y);h.displayName="DraggableBadge"},,,,,,function(e,t,n){"use strict";n.d(t,"c",(function(){return k})),n.d(t,"d",(function(){return S})),n.d(t,"a",(function(){return j})),n.d(t,"b",(function(){return I}));var a=n(4),i=n(78),r=n(0),o=n(37),s=n(177),l=n(95),c=n(165),u=n(86),d=n(1),p=n(104),m=n(81),g=n(741),f=n(84),b=n(317),y=n(285),h=n(175),v=n(169),E=n(281),x=n(742);const k=(e=l.SourcererScopeName.default)=>{const t=Object(i.useDispatch)(),n=Object(a.useRef)(new AbortController),o=Object(a.useRef)(!0),d=Object(a.useRef)(!0),{loading:h,isSignalIndexExists:x,signalIndexName:k}=Object(c.c)(),S=Object(v.d)(E.a.sourcerer),w=Object(a.useMemo)((()=>s.d.getSourcererDataViewsSelector()),[]),{defaultDataView:j,signalIndexName:O}=Object(m.a)((e=>w(e))),{addError:I,addWarning:T}=Object(f.a)();Object(a.useEffect)((()=>{null!=j.error&&T({title:r.i18n.translate("xpack.securitySolution.sourcerer.permissions.title",{defaultMessage:"Write role required to generate data"}),text:r.i18n.translate("xpack.securitySolution.sourcerer.permissions.toastMessage",{defaultMessage:"Users with write permission need to access the Elastic Security app to initialize the app source data."})})}),[T,j.error]);const C=Object(a.useMemo)((()=>u.b.getTimelineByIdSelector()),[]),M=Object(m.a)((e=>C(e,p.d.active))),N=Object(a.useMemo)((()=>s.d.getSourcererScopeSelector()),[]),{sourcererScope:{selectedDataViewId:D,selectedPatterns:F,missingPatterns:A}}=Object(m.a)((t=>N(t,e))),{selectedDataView:_,sourcererScope:{selectedDataViewId:R,selectedPatterns:P,missingPatterns:L}}=Object(m.a)((e=>N(e,l.SourcererScopeName.timeline))),{indexFieldsSearch:q}=Object(y.b)(),B=Object(a.useCallback)((n=>{null!=n?Object.keys(n).forEach((a=>{var i,r,o,c;a===l.SourcererScopeName.default&&e===l.SourcererScopeName.detections||t(s.a.setSelectedDataView({id:a,selectedDataViewId:null!==(i=null===(r=n[a])||void 0===r?void 0:r.id)&&void 0!==i?i:null,selectedPatterns:null!==(o=null===(c=n[a])||void 0===c?void 0:c.selectedPatterns)&&void 0!==o?o:[]}))})):D&&S({[l.SourcererScopeName.default]:{id:D,selectedPatterns:F}})}),[t,D,e,F,S]);Object(v.b)(E.a.sourcerer,B);const z=Object(a.useRef)([]);Object(a.useEffect)((()=>{[...new Set([D,R])].forEach(((e,t)=>{if(null!=e&&e.length>0&&!z.current.includes(e)){z.current=[...z.current,e];const n=0===t?l.SourcererScopeName.default:l.SourcererScopeName.timeline,a=e===D?0===F.length&&0===A.length:R===e&&0===L.length&&0===(null==_?void 0:_.patternList.length);q({dataViewId:e,scopeId:n,needToBeInit:a,...a&&n===l.SourcererScopeName.timeline?{skipScopeUpdate:P.length>0}:{}})}}))}),[q,A.length,D,F.length,R,L.length,_,P.length]),Object(a.useEffect)((()=>{!h&&null!=k&&null==O&&(null==M||null==M.savedObjectId)&&o.current&&j.id.length>0?(o.current=!1,t(s.a.setSelectedDataView({id:l.SourcererScopeName.timeline,selectedDataViewId:j.id,selectedPatterns:Object(g.b)(j,l.SourcererScopeName.timeline,k,!0)}))):null!=O&&(null==M||null==M.savedObjectId)&&o.current&&j.id.length>0&&(o.current=!1,t(s.a.setSelectedDataView({id:l.SourcererScopeName.timeline,selectedDataViewId:j.id,selectedPatterns:Object(g.b)(j,l.SourcererScopeName.timeline,O,!0)})))}),[M,j,t,h,k,O]);const $=Object(a.useCallback)((e=>{-1===j.title.indexOf(e)&&(n.current.abort(),(async a=>{n.current=new AbortController,t(s.a.setSourcererScopeLoading({loading:!0}));try{const i=await Object(b.b)({body:{patternList:a},signal:n.current.signal});i.defaultDataView.patternList.includes(e)&&q({dataViewId:i.defaultDataView.id}),t(s.a.setSourcererDataViews(i)),t(s.a.setSourcererScopeLoading({loading:!1}))}catch(e){I(e,{title:r.i18n.translate("xpack.securitySolution.sourcerer.error.title",{defaultMessage:"Error updating Security Data View"}),toastMessage:r.i18n.translate("xpack.securitySolution.sourcerer.error.toastMessage",{defaultMessage:"Refresh the page"})}),t(s.a.setSourcererScopeLoading({loading:!1}))}})([...j.title.split(","),e]))}),[j.title,t,q,I]),V=Object(a.useCallback)((()=>{!h&&null!=k&&null==O&&j.id.length>0&&($(k),t(s.a.setSignalIndexName({signalIndexName:k})))}),[j.id.length,t,h,k,O,$]);Object(a.useEffect)((()=>{V()}),[k]),Object(a.useEffect)((()=>{e===l.SourcererScopeName.detections&&x&&null!=k&&d.current&&j.id.length>0?(d.current=!1,t(s.a.setSelectedDataView({id:l.SourcererScopeName.detections,selectedDataViewId:j.id,selectedPatterns:Object(g.b)(j,l.SourcererScopeName.detections,k,!0)}))):e===l.SourcererScopeName.detections&&null!=O&&o.current&&j.id.length>0&&(d.current=!1,s.a.setSelectedDataView({id:l.SourcererScopeName.detections,selectedDataViewId:j.id,selectedPatterns:Object(g.b)(j,l.SourcererScopeName.detections,O,!0)}))}),[j,t,x,e,k,O])},S=(e=l.SourcererScopeName.default)=>{const{getDataViewsSelector:t,getSourcererDataViewSelector:n,getScopeSelector:i}=Object(a.useMemo)((()=>({getDataViewsSelector:s.d.getSourcererDataViewsSelector(),getSourcererDataViewSelector:s.d.sourcererDataViewSelector(),getScopeSelector:s.d.scopeIdSelector()})),[]),{signalIndexName:r,selectedDataView:o,sourcererScope:{missingPatterns:c,selectedPatterns:u,loading:d}}=Object(m.a)((a=>{const r=i(a,e);return{...t(a),selectedDataView:n(a,r.selectedDataViewId),sourcererScope:r}})),p=Object(a.useMemo)((()=>Object(x.b)(u)),[u]),[f,b]=Object(a.useState)([]),[y,v]=Object(h.b)(f),E=Object(a.useMemo)((()=>{var e;return{...v,runtimeMappings:{},title:"",id:null!==(e=null==o?void 0:o.id)&&void 0!==e?e:null,loading:y,patternList:v.indexes,indexFields:v.indexPatterns.fields}}),[v,y,o]);Object(a.useEffect)((()=>{null==o||c.length>0?b(p):b([])}),[c,o,p]);const k=Object(a.useMemo)((()=>null==o||c.length>0?E:o),[E,c.length,o]),S=Object(a.useMemo)((()=>!(!d&&!k.loading)||Object(g.a)({scopeId:e,signalIndexName:r,patternList:k.patternList})),[d,e,r,k.loading,k.patternList]);return Object(a.useMemo)((()=>({browserFields:k.browserFields,dataViewId:k.id,indexPattern:{fields:k.indexFields,title:p.join(",")},indicesExist:S,loading:d||k.loading,runtimeMappings:k.runtimeMappings,patternList:k.title.split(","),selectedPatterns:p,...f.length>0?{activePatterns:k.patternList}:{}})),[k,p,S,d,f.length])},w=[d.d,`${d.lc}/id/:id`,`${d.H}/:detailName`],j=e=>null==Object(o.matchPath)(e,{path:w,strict:!1})?l.SourcererScopeName.default:l.SourcererScopeName.detections,O=[d.d,`${d.lc}/id/:id`,d.Hb,d.Gc,d.Sb,d.Zb],I=e=>null!=Object(o.matchPath)(e,{path:O,strict:!1})},,function(e,t,n){"use strict";n.d(t,"A",(function(){return g})),n.d(t,"e",(function(){return f})),n.d(t,"H",(function(){return b})),n.d(t,"O",(function(){return y})),n.d(t,"m",(function(){return h})),n.d(t,"F",(function(){return v})),n.d(t,"s",(function(){return E})),n.d(t,"M",(function(){return x})),n.d(t,"N",(function(){return k})),n.d(t,"f",(function(){return S})),n.d(t,"E",(function(){return w})),n.d(t,"x",(function(){return j})),n.d(t,"C",(function(){return O})),n.d(t,"n",(function(){return I})),n.d(t,"d",(function(){return T})),n.d(t,"K",(function(){return C})),n.d(t,"a",(function(){return M})),n.d(t,"I",(function(){return N})),n.d(t,"q",(function(){return _})),n.d(t,"i",(function(){return R})),n.d(t,"k",(function(){return P})),n.d(t,"j",(function(){return L})),n.d(t,"l",(function(){return q})),n.d(t,"J",(function(){return $})),n.d(t,"P",(function(){return V})),n.d(t,"c",(function(){return U})),n.d(t,"y",(function(){return H})),n.d(t,"b",(function(){return G})),n.d(t,"z",(function(){return Q})),n.d(t,"D",(function(){return W})),n.d(t,"L",(function(){return K})),n.d(t,"B",(function(){return Y})),n.d(t,"w",(function(){return J})),n.d(t,"r",(function(){return X})),n.d(t,"h",(function(){return Z})),n.d(t,"p",(function(){return ee})),n.d(t,"o",(function(){return te})),n.d(t,"v",(function(){return ne})),n.d(t,"u",(function(){return ae})),n.d(t,"g",(function(){return ie})),n.d(t,"t",(function(){return re})),n.d(t,"G",(function(){return oe}));var a=n(108),i=n(346),r=n(508),o=n(54),s=n(347),l=n(341);const c=Object(a.createSelector)((e=>e),(({ariaActiveDescendant:e})=>e)),u=Object(a.createSelector)((e=>e),(({selectedNode:e})=>e)),d=Object(a.createSelector)((e=>e.locationSearch),(e=>e.resolverComponentInstanceID),((e,t)=>Object(s.a)({locationSearch:e,resolverComponentInstanceID:t}))),p=Object(a.createSelector)((e=>e.locationSearch),(e=>e.resolverComponentInstanceID),((e,t)=>n=>{if(void 0===e||void 0===t)return;const a=new URLSearchParams(e),i=Object(o.encode)(n);return a.set(Object(l.a)(t),i),`?${a.toString()}`}));var m=n(144);const g=se(D,i.c),f=(se(D,i.f),se(F,r.d)),b=(se(D,i.a),se(D,i.d),se(D,i.e)),y=se(D,i.g),h=se(D,i.b),v=se(F,r.B),E=se(F,r.q),x=se(F,r.G),k=se(F,r.H),S=se(F,r.e),w=se(F,r.A),j=se(F,r.u),O=se(F,r.z),I=se(F,r.l),T=se(F,r.c),C=se(F,r.E),M=se(A,c),N=se(A,u);function D(e){return e.camera}function F(e){return e.data}function A(e){return e.ui}const _=se(F,r.o),R=se(F,r.h),P=se(F,r.j),L=se(F,r.i),q=se(F,r.k),B=se(D,i.h),z=se(F,r.v),$=se(F,r.D),V=Object(a.createSelector)(z,B,(function(e,t){return n=>e(t(n))})),U=se(F,r.b),H=se(F,r.w),G=Object(a.createSelector)(V,se(F,r.a),(function(e,t){return Object(a.defaultMemoize)((n=>{const{processNodePositions:a}=e(n),i=new Set;for(const e of a.keys()){const t=m.b(e);void 0!==t&&i.add(t)}return e=>{const n=t(e);return null===n||!1===i.has(n)?null:n}}))})),Q=se(A,d),W=se(A,p),K=se(F,r.F),Y=se(F,r.y),J=se(F,r.t),X=se(F,r.p),Z=se(F,r.g),ee=se(F,r.n),te=se(F,r.m),ne=se(F,r.s),ae=se(F,r.r),ie=se(F,r.f),re=Object(a.createSelector)(se(F,(e=>e.nodeData)),V,(function(e,t){return Object(a.defaultMemoize)((n=>{const{processNodePositions:a}=t(n),i=new Set;for(const t of a.keys()){const n=m.b(t);void 0===n||e&&e.has(n)||i.add(n)}return i}))})),oe=se(F,r.C);function se(e,t){return n=>t(e(n))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"f",(function(){return p})),n.d(t,"g",(function(){return m}));var a=n(32),i=n(34),r=n(33),o=n.n(r);const s="details",l=o.a.div.attrs((()=>({className:s}))).withConfig({displayName:"Details",componentId:"sc-1qa889y-0"})(["margin:5px 0 5px 10px;& .euiBadge{margin:2px 0 2px 0;}& .euiFlexGroup{justify-content:center;}"]);l.displayName="Details";const c=o()(a.EuiFlexItem).withConfig({displayName:"TokensFlexItem",componentId:"sc-1qa889y-1"})(["margin-left:3px;"]);function u(e){return Object(i.isNumber)(e)?!isFinite(e):Object(i.isEmpty)(e)}c.displayName="TokensFlexItem";const d=({eventCategory:e,eventDataset:t})=>"file"===(null==e?void 0:e.toLowerCase())||"file"===(null==t?void 0:t.toLowerCase())||"endpoint.events.file"===(null==t?void 0:t.toLowerCase()),p=e=>["process_stopped","termination_event"].includes(`${e}`.toLowerCase()),m=e=>["created","creation","deleted","deletion","file_create_event","file_delete_event","files-encrypted","load","modification","overwrite","rename"].includes(`${e}`.toLowerCase())},,,function(e,t,n){"use strict";var a=n(46);n.d(t,"j",(function(){return a.getUseField})),n.d(t,"i",(function(){return a.getFieldValidityAndErrorMessage})),n.d(t,"a",(function(){return a.FIELD_TYPES})),n.d(t,"c",(function(){return a.Form})),n.d(t,"e",(function(){return a.UseField})),n.d(t,"f",(function(){return a.UseMultiFields})),n.d(t,"k",(function(){return a.useForm})),n.d(t,"l",(function(){return a.useFormContext})),n.d(t,"m",(function(){return a.useFormData})),n.d(t,"g",(function(){return a.VALIDATION_TYPES}));var i=n(61);n.d(t,"b",(function(){return i.Field})),n.d(t,"d",(function(){return i.SelectField}));var r=n(65);n.d(t,"h",(function(){return r.fieldValidators}))},,function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return s}));var a=n(83),i=n(184),r=n(429);n.d(t,"e",(function(){return a.f})),n.d(t,"g",(function(){return a.h})),n.d(t,"f",(function(){return a.g})),n.d(t,"k",(function(){return a.l})),n.d(t,"j",(function(){return a.k})),n.d(t,"n",(function(){return a.p})),n.d(t,"m",(function(){return a.o})),n.d(t,"l",(function(){return a.m})),n.d(t,"h",(function(){return a.i})),n.d(t,"o",(function(){return a.u})),n.d(t,"p",(function(){return a.v})),n.d(t,"i",(function(){return a.j})),n.d(t,"a",(function(){return a.b})),n.d(t,"b",(function(){return a.e}));const o=({activeTimelineDataProviders:e,dataProviders:t,dispatch:n,result:o,timelineId:s,noProviderFound:l=i.a.noProviderFound,onAddedToTimeline:c})=>{const u=Object(a.n)(o),d=t[u];d?Object(r.b)({dataProviders:e,destination:o.destination,dispatch:n,onAddedToTimeline:c,providerToAdd:d,timelineId:s}):n(l({id:u}))},s=({isAggregatable:e,fieldType:t,fieldName:n,hideTopN:a})=>{const i=["boolean","geo-point","geo-shape","ip","keyword","number","numeric","string"].includes(t),r=["kibana.alert.ancestors.depth","kibana.alert.ancestors.id","kibana.alert.ancestors.rule","kibana.alert.ancestors.type","kibana.alert.original_event.action","kibana.alert.original_event.category","kibana.alert.original_event.code","kibana.alert.original_event.created","kibana.alert.original_event.dataset","kibana.alert.original_event.duration","kibana.alert.original_event.end","kibana.alert.original_event.hash","kibana.alert.original_event.id","kibana.alert.original_event.kind","kibana.alert.original_event.module","kibana.alert.original_event.original","kibana.alert.original_event.outcome","kibana.alert.original_event.provider","kibana.alert.original_event.risk_score","kibana.alert.original_event.risk_score_norm","kibana.alert.original_event.sequence","kibana.alert.original_event.severity","kibana.alert.original_event.start","kibana.alert.original_event.timezone","kibana.alert.original_event.type","kibana.alert.original_time","kibana.alert.rule.created_by","kibana.alert.rule.description","kibana.alert.rule.enabled","kibana.alert.rule.false_positives","kibana.alert.rule.from","kibana.alert.rule.uuid","kibana.alert.rule.immutable","kibana.alert.rule.interval","kibana.alert.rule.max_signals","kibana.alert.rule.name","kibana.alert.rule.note","kibana.alert.rule.references","kibana.alert.risk_score","kibana.alert.rule.rule_id","kibana.alert.severity","kibana.alert.rule.size","kibana.alert.rule.tags","kibana.alert.rule.threat","kibana.alert.rule.threat.tactic.id","kibana.alert.rule.threat.tactic.name","kibana.alert.rule.threat.tactic.reference","kibana.alert.rule.threat.technique.id","kibana.alert.rule.threat.technique.name","kibana.alert.rule.threat.technique.reference","kibana.alert.rule.timeline_id","kibana.alert.rule.timeline_title","kibana.alert.rule.to","kibana.alert.rule.type","kibana.alert.rule.updated_by","kibana.alert.rule.version","kibana.alert.workflow_status"].includes(n);return!a&&(r||e&&i)}},,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(4),i=n(77),r=n(183);const o=e=>{var t;const[{pageName:n}]=Object(r.a)(),{services:{storage:o}}=Object(i.k)(),s=((e,t)=>t&&e.length>0?`kibana.siem:${t}.query.toggle:${e}`:null)(n,e),[l,c]=Object(a.useState)(null==s||null===(t=o.get(s))||void 0===t||t);Object(a.useEffect)((()=>{var e;null!=s&&c(null===(e=o.get(s))||void 0===e||e)}),[o,s]);const u=Object(a.useCallback)((e=>{null!=s&&(o.set(s,e),c(e))}),[o,s]);return e?{toggleStatus:l,setToggleStatus:u}:{toggleStatus:!0,setToggleStatus:()=>{}}}},,function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"e",(function(){return a})),n.d(t,"a",(function(){return g})),n.d(t,"d",(function(){return f}));var a={};n.r(a),n.d(a,"dnsSelector",(function(){return v})),n.d(a,"topNFlowSelector",(function(){return x})),n.d(a,"tlsSelector",(function(){return S})),n.d(a,"topCountriesSelector",(function(){return j})),n.d(a,"httpSelector",(function(){return I})),n.d(a,"usersSelector",(function(){return T})),n.d(a,"networkAnomaliesJobIdFilterSelector",(function(){return C})),n.d(a,"networkAnomaliesIntervalSelector",(function(){return M}));var i=n(355),r=n(229),o=n(108),s=n(34),l=n(192),c=n(328),u=n(85),d=n(253);const p=e=>({...e.page.queries,[r.NetworkTableType.topCountriesSource]:{...e.page.queries[r.NetworkTableType.topCountriesSource],activePage:d.a},[r.NetworkTableType.topCountriesDestination]:{...e.page.queries[r.NetworkTableType.topCountriesDestination],activePage:d.a},[r.NetworkTableType.topNFlowSource]:{...e.page.queries[r.NetworkTableType.topNFlowSource],activePage:d.a},[r.NetworkTableType.topNFlowDestination]:{...e.page.queries[r.NetworkTableType.topNFlowDestination],activePage:d.a},[r.NetworkTableType.dns]:{...e.page.queries[r.NetworkTableType.dns],activePage:d.a},[r.NetworkTableType.tls]:{...e.page.queries[r.NetworkTableType.tls],activePage:d.a},[r.NetworkTableType.http]:{...e.page.queries[r.NetworkTableType.http],activePage:d.a}}),m=e=>({...e.details.queries,[r.NetworkDetailsTableType.topCountriesSource]:{...e.details.queries[r.NetworkDetailsTableType.topCountriesSource],activePage:d.a},[r.NetworkDetailsTableType.topCountriesDestination]:{...e.details.queries[r.NetworkDetailsTableType.topCountriesDestination],activePage:d.a},[r.NetworkDetailsTableType.topNFlowSource]:{...e.details.queries[r.NetworkDetailsTableType.topNFlowSource],activePage:d.a},[r.NetworkDetailsTableType.topNFlowDestination]:{...e.details.queries[r.NetworkDetailsTableType.topNFlowDestination],activePage:d.a},[r.NetworkDetailsTableType.tls]:{...e.details.queries[r.NetworkDetailsTableType.tls],activePage:d.a},[r.NetworkDetailsTableType.users]:{...e.details.queries[r.NetworkDetailsTableType.users],activePage:d.a},[r.NetworkDetailsTableType.http]:{...e.details.queries[r.NetworkDetailsTableType.http],activePage:d.a}}),g={page:{queries:{[r.NetworkTableType.topNFlowSource]:{activePage:d.a,limit:d.b,sort:{field:u.s.bytes_out,direction:u.b.desc}},[r.NetworkTableType.topNFlowDestination]:{activePage:d.a,limit:d.b,sort:{field:u.s.bytes_in,direction:u.b.desc}},[r.NetworkTableType.dns]:{activePage:d.a,limit:d.b,sort:{field:u.n.uniqueDomains,direction:u.b.desc},isPtrIncluded:!1},[r.NetworkTableType.http]:{activePage:d.a,limit:d.b,sort:{direction:u.b.desc}},[r.NetworkTableType.tls]:{activePage:d.a,limit:d.b,sort:{field:u.r._id,direction:u.b.desc}},[r.NetworkTableType.topCountriesSource]:{activePage:d.a,limit:d.b,sort:{field:u.s.bytes_out,direction:u.b.desc}},[r.NetworkTableType.topCountriesDestination]:{activePage:d.a,limit:d.b,sort:{field:u.s.bytes_in,direction:u.b.desc}},[r.NetworkTableType.alerts]:{activePage:d.a,limit:d.b},[r.NetworkTableType.anomalies]:{jobIdSelection:[],intervalSelection:"auto"}}},details:{queries:{[r.NetworkDetailsTableType.http]:{activePage:d.a,limit:d.b,sort:{direction:u.b.desc}},[r.NetworkDetailsTableType.topCountriesSource]:{activePage:d.a,limit:d.b,sort:{field:u.s.bytes_out,direction:u.b.desc}},[r.NetworkDetailsTableType.topCountriesDestination]:{activePage:d.a,limit:d.b,sort:{field:u.s.bytes_in,direction:u.b.desc}},[r.NetworkDetailsTableType.topNFlowSource]:{activePage:d.a,limit:d.b,sort:{field:u.s.bytes_out,direction:u.b.desc}},[r.NetworkDetailsTableType.topNFlowDestination]:{activePage:d.a,limit:d.b,sort:{field:u.s.bytes_in,direction:u.b.desc}},[r.NetworkDetailsTableType.tls]:{activePage:d.a,limit:d.b,sort:{field:u.r._id,direction:u.b.desc}},[r.NetworkDetailsTableType.users]:{activePage:d.a,limit:d.b,sort:{field:u.t.name,direction:u.b.asc}},[r.NetworkDetailsTableType.anomalies]:{jobIdSelection:[],intervalSelection:"auto"}},flowTarget:u.f.source}},f=Object(c.reducerWithInitialState)(g).case(i.updateNetworkTable,((e,{networkType:t,tableType:n,updates:a})=>({...e,[t]:{...e[t],queries:{...e[t].queries,[n]:{...Object(s.get)([t,"queries",n],e),...a}}}}))).case(i.setNetworkTablesActivePageToZero,(e=>({...e,page:{...e.page,queries:p(e)},details:{...e.details,queries:m(e)}}))).case(i.setNetworkDetailsTablesActivePageToZero,(e=>({...e,details:{...e.details,queries:m(e)}}))).case(i.updateNetworkAnomaliesJobIdFilter,((e,{jobIds:t,networkType:n})=>n===r.NetworkType.page?Object(s.set)("page.queries.anomalies.jobIdSelection",t,e):Object(s.set)("details.queries.anomalies.jobIdSelection",t,e))).case(i.updateNetworkAnomaliesInterval,((e,{interval:t,networkType:n})=>n===r.NetworkType.page?Object(s.set)("page.queries.anomalies.intervalSelection",t,e):Object(s.set)("details.queries.anomalies.intervalSelection",t,e))).build(),b=(e,t)=>Object(s.get)(t,e.network),y=e=>e.network.page,h=e=>e.network.details,v=()=>Object(o.createSelector)(y,(e=>e.queries.dns)),E=(e,t,n)=>{const a=n===l.b.source?"topNFlowSource":"topNFlowDestination",i=t===r.NetworkType.page?r.NetworkTableType[a]:r.NetworkDetailsTableType[a];return Object(s.get)([t,"queries",i],e.network)||Object(s.get)([t,"queries",i],g)},x=()=>Object(o.createSelector)(E,(e=>e)),k=(e,t)=>{const n=t===r.NetworkType.page?r.NetworkTableType.tls:r.NetworkDetailsTableType.tls;return Object(s.get)([t,"queries",n],e.network)||Object(s.get)([t,"queries",n],g)},S=()=>Object(o.createSelector)(k,(e=>e)),w=(e,t,n)=>{const a=n===l.b.source?"topCountriesSource":"topCountriesDestination",i=t===r.NetworkType.page?r.NetworkTableType[a]:r.NetworkDetailsTableType[a];return Object(s.get)([t,"queries",i],e.network)||Object(s.get)([t,"queries",i],g)},j=()=>Object(o.createSelector)(w,(e=>e)),O=(e,t)=>{const n=t===r.NetworkType.page?r.NetworkTableType.http:r.NetworkDetailsTableType.http;return Object(s.get)([t,"queries",n],e.network)||Object(s.get)([t,"queries",n],g)},I=()=>Object(o.createSelector)(O,(e=>e)),T=()=>Object(o.createSelector)(h,(e=>e.queries.users)),C=()=>Object(o.createSelector)(b,(e=>e.queries[r.NetworkTableType.anomalies].jobIdSelection)),M=()=>Object(o.createSelector)(b,(e=>e.queries[r.NetworkTableType.anomalies].intervalSelection))},,function(e,t,n){"use strict";n.d(t,"Xb",(function(){return i})),n.d(t,"Kb",(function(){return r})),n.d(t,"Mb",(function(){return o})),n.d(t,"Pc",(function(){return s})),n.d(t,"d",(function(){return l})),n.d(t,"Wb",(function(){return c})),n.d(t,"Fb",(function(){return u})),n.d(t,"Eb",(function(){return d})),n.d(t,"Db",(function(){return p})),n.d(t,"e",(function(){return m})),n.d(t,"Ab",(function(){return g})),n.d(t,"Yb",(function(){return f})),n.d(t,"f",(function(){return b})),n.d(t,"s",(function(){return y})),n.d(t,"q",(function(){return h})),n.d(t,"t",(function(){return v})),n.d(t,"r",(function(){return E})),n.d(t,"n",(function(){return x})),n.d(t,"u",(function(){return k})),n.d(t,"x",(function(){return S})),n.d(t,"h",(function(){return w})),n.d(t,"o",(function(){return j})),n.d(t,"j",(function(){return O})),n.d(t,"p",(function(){return I})),n.d(t,"k",(function(){return T})),n.d(t,"i",(function(){return C})),n.d(t,"w",(function(){return M})),n.d(t,"v",(function(){return N})),n.d(t,"W",(function(){return D})),n.d(t,"U",(function(){return F})),n.d(t,"V",(function(){return A})),n.d(t,"Y",(function(){return _})),n.d(t,"A",(function(){return R})),n.d(t,"m",(function(){return P})),n.d(t,"y",(function(){return L})),n.d(t,"l",(function(){return q})),n.d(t,"z",(function(){return B})),n.d(t,"X",(function(){return z})),n.d(t,"S",(function(){return $})),n.d(t,"K",(function(){return V})),n.d(t,"B",(function(){return U})),n.d(t,"M",(function(){return H})),n.d(t,"C",(function(){return G})),n.d(t,"E",(function(){return Q})),n.d(t,"F",(function(){return W})),n.d(t,"D",(function(){return K})),n.d(t,"L",(function(){return Y})),n.d(t,"N",(function(){return J})),n.d(t,"O",(function(){return X})),n.d(t,"G",(function(){return Z})),n.d(t,"P",(function(){return ee})),n.d(t,"H",(function(){return te})),n.d(t,"T",(function(){return ne})),n.d(t,"J",(function(){return ae})),n.d(t,"I",(function(){return ie})),n.d(t,"Q",(function(){return re})),n.d(t,"R",(function(){return oe})),n.d(t,"g",(function(){return se})),n.d(t,"Gb",(function(){return le})),n.d(t,"Ic",(function(){return ce})),n.d(t,"Hc",(function(){return ue})),n.d(t,"Mc",(function(){return de})),n.d(t,"Kc",(function(){return pe})),n.d(t,"Z",(function(){return me})),n.d(t,"Jc",(function(){return ge})),n.d(t,"Bb",(function(){return fe})),n.d(t,"Ob",(function(){return be})),n.d(t,"Pb",(function(){return ye})),n.d(t,"zb",(function(){return he})),n.d(t,"Hb",(function(){return ve})),n.d(t,"yb",(function(){return Ee})),n.d(t,"lb",(function(){return xe})),n.d(t,"kb",(function(){return ke})),n.d(t,"mb",(function(){return Se})),n.d(t,"fb",(function(){return we})),n.d(t,"hb",(function(){return je})),n.d(t,"gb",(function(){return Oe})),n.d(t,"ob",(function(){return Ie})),n.d(t,"nb",(function(){return Te})),n.d(t,"ab",(function(){return Ce})),n.d(t,"db",(function(){return Me})),n.d(t,"eb",(function(){return Ne})),n.d(t,"ib",(function(){return De})),n.d(t,"jb",(function(){return Fe})),n.d(t,"bb",(function(){return Ae})),n.d(t,"cb",(function(){return _e})),n.d(t,"Bc",(function(){return Re})),n.d(t,"Qb",(function(){return Pe})),n.d(t,"qb",(function(){return Le})),n.d(t,"Cb",(function(){return qe})),n.d(t,"Oc",(function(){return Be})),n.d(t,"Tb",(function(){return ze})),n.d(t,"Rb",(function(){return $e})),n.d(t,"Sb",(function(){return Ve})),n.d(t,"rb",(function(){return Ue})),n.d(t,"b",(function(){return He})),n.d(t,"Gc",(function(){return Ge})),n.d(t,"Cc",(function(){return Qe})),n.d(t,"sb",(function(){return We})),n.d(t,"a",(function(){return Ke})),n.d(t,"Fc",(function(){return Ye})),n.d(t,"c",(function(){return Je})),n.d(t,"Ub",(function(){return Xe})),n.d(t,"pb",(function(){return Ze})),n.d(t,"tb",(function(){return et})),n.d(t,"Lb",(function(){return tt})),n.d(t,"Lc",(function(){return nt})),n.d(t,"Nb",(function(){return at})),n.d(t,"Vb",(function(){return it})),n.d(t,"Nc",(function(){return rt})),n.d(t,"Ib",(function(){return ot})),n.d(t,"Jb",(function(){return st})),n.d(t,"xb",(function(){return lt})),n.d(t,"wb",(function(){return ct})),n.d(t,"vb",(function(){return ut})),n.d(t,"ub",(function(){return dt})),n.d(t,"Zb",(function(){return pt})),n.d(t,"ac",(function(){return mt})),n.d(t,"zc",(function(){return gt})),n.d(t,"Ac",(function(){return ft})),n.d(t,"yc",(function(){return bt})),n.d(t,"wc",(function(){return yt})),n.d(t,"xc",(function(){return ht})),n.d(t,"lc",(function(){return vt})),n.d(t,"mc",(function(){return Et})),n.d(t,"jc",(function(){return xt})),n.d(t,"kc",(function(){return kt})),n.d(t,"dc",(function(){return St})),n.d(t,"ec",(function(){return wt})),n.d(t,"bc",(function(){return jt})),n.d(t,"cc",(function(){return Ot})),n.d(t,"uc",(function(){return It})),n.d(t,"vc",(function(){return Tt})),n.d(t,"sc",(function(){return Ct})),n.d(t,"tc",(function(){return Mt})),n.d(t,"hc",(function(){return Nt})),n.d(t,"ic",(function(){return Dt})),n.d(t,"fc",(function(){return Ft})),n.d(t,"gc",(function(){return At})),n.d(t,"pc",(function(){return _t})),n.d(t,"qc",(function(){return Rt})),n.d(t,"rc",(function(){return Pt})),n.d(t,"nc",(function(){return Lt})),n.d(t,"oc",(function(){return qt})),n.d(t,"Dc",(function(){return Bt})),n.d(t,"Ec",(function(){return zt}));var a=n(0);const i=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.popoverTooltip.ariaLabel",{defaultMessage:"Tooltip for column: {columnName}",values:{columnName:e}}),r=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.importRuleTitle",{defaultMessage:"Import rules"}),o=a.i18n.translate("xpack.securitySolution.lists.detectionEngine.rules.importValueListsButton",{defaultMessage:"Import value lists"}),s=a.i18n.translate("xpack.securitySolution.lists.detectionEngine.rules.uploadValueListsButtonTooltip",{defaultMessage:"Use value lists to create an exception when a field value matches a value found in a list"}),l=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.addNewRuleTitle",{defaultMessage:"Create new rule"}),c=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.pageTitle",{defaultMessage:"Rules"}),u=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.experimentalOn",{defaultMessage:"Advanced sorting"}),d=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.experimentalOff",{defaultMessage:"Advanced sorting"}),p=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.experimentalDescription",{defaultMessage:"Turn this on to enable sorting for all table columns. You can turn it off if you encounter table performance issues."}),m=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.addPageTitle",{defaultMessage:"Create"}),g=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.editPageTitle",{defaultMessage:"Edit"}),f=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.refreshTitle",{defaultMessage:"Refresh"}),b=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.batchActionsTitle",{defaultMessage:"Bulk actions"}),y=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.enableTitle",{defaultMessage:"Enable"}),h=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disableTitle",{defaultMessage:"Disable"}),v=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.exportTitle",{defaultMessage:"Export"}),E=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicateTitle",{defaultMessage:"Duplicate"}),x=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.deleteTitle",{defaultMessage:"Delete"}),k=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.indexPatternsTitle",{defaultMessage:"Index patterns"}),S=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.tagsTitle",{defaultMessage:"Tags"}),w=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.addIndexPatternsTitle",{defaultMessage:"Add index patterns"}),j=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.deleteIndexPatternsTitle",{defaultMessage:"Delete index patterns"}),O=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.addTagsTitle",{defaultMessage:"Add tags"}),I=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.deleteTagsTitle",{defaultMessage:"Delete tags"}),T=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.applyTimelineTemplateTitle",{defaultMessage:"Apply Timeline template"}),C=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.addRuleActionsTitle",{defaultMessage:"Add rule actions"}),M=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.setScheduleTitle",{defaultMessage:"Update rule schedules"}),N=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.contextMenuTitle",{defaultMessage:"Options"}),D=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkEditWarningToastTitle",{defaultMessage:"Rules updates are in progress"}),F=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkEditWarningToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} updating."}),A=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkEditWarningToastNotifyButtonLabel",{defaultMessage:"Notify me when done"}),_=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkExportConfirmationDeniedTitle",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule} other {# rules}} cannot be exported"}),R=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkEditConfirmationDeniedTitle",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule} other {# rules}} cannot be edited"}),P=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkActionConfirmationPartlyTitle",{values:{customRulesCount:e},defaultMessage:"This action can only be applied to {customRulesCount, plural, =1 {# custom rule} other {# custom rules}}"}),L=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditConfirmationCancelButtonLabel",{defaultMessage:"Cancel"}),q=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkActionConfirmationCloseButtonLabel",{defaultMessage:"Close"}),B=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditConfirmation.confirmButtonLabel",{values:{customRulesCount:e},defaultMessage:"Edit {customRulesCount, plural, =1 {# custom rule} other {# custom rules}}"}),z=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkExportConfirmation.confirmButtonLabel",{values:{customRulesCount:e},defaultMessage:"Export {customRulesCount, plural, =1 {# custom rule} other {# custom rules}}"}),$=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.saveButtonLabel",{defaultMessage:"Save"}),V=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.cancelButtonLabel",{defaultMessage:"Cancel"}),U=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addIndexPatternsComboboxHelpText",{defaultMessage:"Enter the pattern of Elasticsearch indices that you would like to add. By default, the dropdown includes index patterns defined in Security Solution advanced settings."}),H=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteIndexPatternsComboboxHelpText",{defaultMessage:"Enter the pattern of Elasticsearch indices that you would like to delete. By default, the dropdown includes index patterns defined in Security Solution advanced settings."}),G=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addIndexPatternsComboboxLabel",{defaultMessage:"Add index patterns for selected rules"}),Q=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.indexPatternsRequiredErrorMessage",{defaultMessage:"A minimum of one index pattern is required."}),W=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addIndexPatternsTitle",{defaultMessage:"Add index patterns"}),K=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addIndexPatternsOverwriteCheckboxLabel",{defaultMessage:"Overwrite all selected rules' index patterns"}),Y=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.dataViewsOverwriteCheckboxLabel",{defaultMessage:"Apply changes to rules configured with data views"}),J=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteIndexPatternsComboboxLabel",{defaultMessage:"Delete index patterns for selected rules"}),X=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteIndexPatternsTitle",{defaultMessage:"Delete index patterns"}),Z=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addTagsComboboxHelpText",{defaultMessage:"Add one or more tags for selected rules from the dropdown. You can also enter custom identifying tags and press Enter to begin a new one."}),ee=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteTagsComboboxHelpText",{defaultMessage:"Delete one or more tags for selected rules from the dropdown. You can also enter custom identifying tags and press Enter to begin a new one."}),te=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addTagsComboboxLabel",{defaultMessage:"Add tags for selected rules"}),ne=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.tagsComoboxRequiredErrorMessage",{defaultMessage:"A minimum of one tag is required."}),ae=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addTagsTitle",{defaultMessage:"Add tags"}),ie=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addTagsOverwriteCheckboxLabel",{defaultMessage:"Overwrite all selected rules' tags"}),re=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteTagsComboboxLabel",{defaultMessage:"Delete tags for selected rules"}),oe=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteTagsTitle",{defaultMessage:"Delete tags"}),se=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.batchActions.deleteSelectedImmutableTitle",{defaultMessage:"Selection contains immutable rules which cannot be deleted"}),le=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.exportFilenameTitle",{defaultMessage:"rules_export"}),ce=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.searchAriaLabel",{defaultMessage:"Search rules"}),ue=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.searchPlaceholder",{defaultMessage:'Rule name, index pattern (e.g., "filebeat-*"), or MITRE ATT&CKâ„¢ tactic or technique (e.g., "Defense Evasion" or "TA0005")'}),de=(e,t,n)=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.showingRulesTitle",{values:{firstInPage:e,lastOfPage:t,totalRules:n},defaultMessage:"Showing {firstInPage}-{lastOfPage} of {totalRules} {totalRules, plural, =1 {rule} other {rules}}"}),pe=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.selectAllRulesTitle",{values:{totalRules:e},defaultMessage:"Select all {totalRules} {totalRules, plural, =1 {rule} other {rules}}"}),me=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.clearSelectionTitle",{defaultMessage:"Clear selection"}),ge=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.selectedRulesTitle",{values:{selectedRules:e},defaultMessage:"Selected {selectedRules} {selectedRules, plural, =1 {rule} other {rules}}"}),fe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.editRuleSettingsDescription",{defaultMessage:"Edit rule settings"}),be=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.lackOfKibanaActionsFeaturePrivileges",{defaultMessage:"You do not have Kibana Actions privileges"}),ye=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.lackOfKibanaSecurityPrivileges",{defaultMessage:"You do not have Kibana Security privileges"}),he=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.duplicateRuleDescription",{defaultMessage:"Duplicate rule"}),ve=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.exportRuleDescription",{defaultMessage:"Export rule"}),Ee=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.deleteRuleDescription",{defaultMessage:"Delete rule"}),xe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.ruleTitle",{defaultMessage:"Rule"}),ke=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.riskScoreTitle",{defaultMessage:"Risk score"}),Se=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.severityTitle",{defaultMessage:"Severity"}),we=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.lastRunTitle",{defaultMessage:"Last run"}),je=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.lastUpdateTitle",{defaultMessage:"Last updated"}),Oe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.lastResponseTitle",{defaultMessage:"Last response"}),Ie=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.versionTitle",{defaultMessage:"Version"}),Te=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.tagsTitle",{defaultMessage:"Tags"}),Ce=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.enabledTitle",{defaultMessage:"Enabled"}),Me=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.indexingTimes",{defaultMessage:"Indexing Time (ms)"}),Ne=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.indexingTimesTooltip",{defaultMessage:"Total time spent indexing alerts during last Rule execution"}),De=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.queryTimes",{defaultMessage:"Query Time (ms)"}),Fe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.queryTimesTooltip",{defaultMessage:"Total time spent querying source indices during last Rule execution"}),Ae=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.gap",{defaultMessage:"Last Gap (if any)"}),_e=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.gapTooltipSeeDocsDescription",{defaultMessage:"see documentation"}),Re=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.tabs.rules",{defaultMessage:"Rules"}),Pe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.tabs.monitoring",{defaultMessage:"Rule Monitoring"}),Le=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.customRulesTitle",{defaultMessage:"Custom rules"}),qe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.elasticRulesTitle",{defaultMessage:"Elastic rules"}),Be=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.tagsLabel",{defaultMessage:"Tags"}),ze=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.noTagsAvailableDescription",{defaultMessage:"No tags available"}),$e=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.noRulesTitle",{defaultMessage:"No rules found"}),Ve=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.noRulesBodyTitle",{defaultMessage:"We weren't able to find any rules with the above filters."}),Ue=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.defineRuleTitle",{defaultMessage:"Define rule"}),He=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.aboutRuleTitle",{defaultMessage:"About rule"}),Ge=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.scheduleRuleTitle",{defaultMessage:"Schedule rule"}),Qe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.ruleActionsTitle",{defaultMessage:"Rule actions"}),We=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.stepDefinitionTitle",{defaultMessage:"Definition"}),Ke=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.stepAboutTitle",{defaultMessage:"About"}),Ye=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.stepScheduleTitle",{defaultMessage:"Schedule"}),Je=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.stepActionsTitle",{defaultMessage:"Actions"}),Xe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.optionalFieldDescription",{defaultMessage:"Optional"}),Ze=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.continueButtonTitle",{defaultMessage:"Continue"}),et=(a.i18n.translate("xpack.securitySolution.detectionEngine.rules.updateButtonTitle",{defaultMessage:"Update"}),a.i18n.translate("xpack.securitySolution.detectionEngine.rules.deleteDescription",{defaultMessage:"Delete"})),tt=a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importRuleTitle",{defaultMessage:"Import"}),nt=a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.selectRuleDescription",{defaultMessage:"Select rules to import. Associated rule actions and exceptions can be included."}),at=a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.initialPromptTextDescription",{defaultMessage:"Select or drag and drop a valid rules_export.ndjson file"}),it=a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.overwriteDescription",{defaultMessage:'Overwrite existing detection rules with conflicting "rule_id"'}),rt=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.successfullyImportedRulesTitle",{values:{totalRules:e},defaultMessage:"Successfully imported {totalRules} {totalRules, plural, =1 {rule} other {rules}}"}),ot=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importFailedTitle",{values:{totalRules:e},defaultMessage:"Failed to import {totalRules} {totalRules, plural, =1 {rule} other {rules}}"}),st=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importFailedDetailedTitle",{values:{message:e},defaultMessage:"{message}"}),lt=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.deleteConfirmationTitle",{defaultMessage:"Confirm bulk deletion"}),ct=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.deleteConfirmationConfirm",{defaultMessage:"Confirm"}),ut=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.deleteConfirmationCancel",{defaultMessage:"Cancel"}),dt=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.deleteConfirmationBody",{defaultMessage:'This action will delete all rules that match current filter query. Click "Confirm" to continue.'}),pt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.refreshRulePopoverDescription",{defaultMessage:"Automatically refresh table"}),mt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.refreshRulePopoverLabel",{defaultMessage:"Refresh settings"}),gt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.successToastTitle",{defaultMessage:"Rules exported"}),ft=(e,t)=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.successToastDescription",{values:{totalRules:t,exportedRules:e},defaultMessage:"Successfully exported {exportedRules} of {totalRules} {totalRules, plural, =1 {rule} other {rules}}."}),bt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.prebuiltRulesExcludedToastDescription",{defaultMessage:"Prebuilt rules were excluded from the resulting file."}),yt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.errorToastTitle",{defaultMessage:"Error exporting rules"}),ht=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to export."}),vt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.successToastTitle",{defaultMessage:"Rules duplicated"}),Et=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.successToastDescription",{values:{totalRules:e},defaultMessage:"Successfully duplicated {totalRules, plural, =1 {{totalRules} rule} other {{totalRules} rules}}"}),xt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.errorToastTitle",{defaultMessage:"Error duplicating rule"}),kt=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to duplicate."}),St=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.delete.successToastTitle",{defaultMessage:"Rules deleted"}),wt=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.delete.successToastDescription",{values:{totalRules:e},defaultMessage:"Successfully deleted {totalRules, plural, =1 {{totalRules} rule} other {{totalRules} rules}}"}),jt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.delete.errorToastTitle",{defaultMessage:"Error deleting rules"}),Ot=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.delete.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to delete."}),It=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.enable.successToastTitle",{defaultMessage:"Rules enabled"}),Tt=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkAction.enable.successToastDescription",{values:{totalRules:e},defaultMessage:"Successfully enabled {totalRules, plural, =1 {{totalRules} rule} other {{totalRules} rules}}"}),Ct=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.enable.errorToastTitle",{defaultMessage:"Error enabling rules"}),Mt=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.enable.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to enable."}),Nt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disable.successToastTitle",{defaultMessage:"Rules disabled"}),Dt=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disable.successToastDescription",{values:{totalRules:e},defaultMessage:"Successfully disabled {totalRules, plural, =1 {{totalRules} rule} other {{totalRules} rules}}"}),Ft=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disable.errorToastTitle",{defaultMessage:"Error disabling rules"}),At=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disable.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to disable."}),_t=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.successToastTitle",{defaultMessage:"Rules updated"}),Rt=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.successToastDescription",{values:{rulesCount:e},defaultMessage:"You've successfully updated {rulesCount, plural, =1 {# rule} other {# rules}}"}),Pt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.successIndexEditToastDescription",{defaultMessage:"If you did not select to apply changes to rules using Kibana data views, those rules were not updated and will continue using data views."}),Lt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.errorToastTitle",{defaultMessage:"Error updating rules"}),qt=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule} other {# rules}} failed to update."}),Bt=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.rulePreviewTitle",{defaultMessage:"Rule preview"}),zt=(a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.rulePreviewDescription",{defaultMessage:"Rule preview reflects the current configuration of your rule settings and exceptions, click refresh icon to see the updated preview."}),a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.cancelButtonLabel",{defaultMessage:"Cancel"}),a.i18n.translate("xpack.securitySolution.hooks.useGetSavedQuery.errorToastMessage",{defaultMessage:"Failed to load the saved query"}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(34),i=n(4),r=n(78),o=n(90),s=n(81),l=n(98),c=n(184);const u=(e=!0)=>{const t=Object(r.useDispatch)(),{from:n,to:u}=Object(s.a)((e=>Object(a.pick)(["from","to"],l.d.globalTimeRangeSelector(e)))),[d,p]=Object(i.useState)(!0),m=Object(i.useCallback)((({id:e,inspect:n,loading:a,refetch:i,searchSessionId:r})=>t(c.b.setQuery({inputId:o.a.global,id:e,inspect:n,loading:a,refetch:i,searchSessionId:r}))),[t]),g=Object(i.useCallback)((({id:e})=>t(c.b.deleteOneQuery({inputId:o.a.global,id:e}))),[t]);return Object(i.useEffect)((()=>{p(!1)}),[]),Object(i.useEffect)((()=>()=>{e&&t(c.b.deleteAllQuery({id:o.a.global}))}),[t,e]),Object(i.useMemo)((()=>({isInitializing:d,from:n,to:u,setQuery:m,deleteQuery:g})),[g,n,d,m,u])}},function(e,t,n){"use strict";e.exports=function(e){return e<-2}},,,function(e,t,n){"use strict";n.d(t,"k",(function(){return i})),n.d(t,"B",(function(){return r})),n.d(t,"x",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"z",(function(){return l})),n.d(t,"p",(function(){return c})),n.d(t,"q",(function(){return u})),n.d(t,"r",(function(){return d})),n.d(t,"n",(function(){return p})),n.d(t,"o",(function(){return m})),n.d(t,"t",(function(){return g})),n.d(t,"u",(function(){return f})),n.d(t,"s",(function(){return b})),n.d(t,"l",(function(){return y})),n.d(t,"m",(function(){return h})),n.d(t,"f",(function(){return v})),n.d(t,"g",(function(){return E})),n.d(t,"e",(function(){return x})),n.d(t,"c",(function(){return k})),n.d(t,"d",(function(){return S})),n.d(t,"b",(function(){return w})),n.d(t,"A",(function(){return j})),n.d(t,"v",(function(){return O})),n.d(t,"w",(function(){return I})),n.d(t,"C",(function(){return T})),n.d(t,"i",(function(){return C})),n.d(t,"j",(function(){return M})),n.d(t,"h",(function(){return N})),n.d(t,"y",(function(){return D}));var a=n(0);a.i18n.translate("xpack.securitySolution.detectionEngine.pageTitle",{defaultMessage:"Detection engine"});const i=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.documentTypeTitle",{defaultMessage:"Alerts"}),r=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.openAlertsTitle",{defaultMessage:"Open"}),o=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.closedAlertsTitle",{defaultMessage:"Closed"}),s=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.acknowledgedAlertsTitle",{defaultMessage:"Acknowledged"}),l=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.loadingAlertsTitle",{defaultMessage:"Loading Alerts"}),c=(a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.totalCountOfAlertsTitle",{defaultMessage:"alerts"}),a.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.ruleTitle",{defaultMessage:"Rule"})),u=(a.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.ruleNameTitle",{defaultMessage:"Rule name"}),a.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.ruleDescriptionTitle",{defaultMessage:"Rule description"})),d=a.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.severityTitle",{defaultMessage:"Severity"}),p=a.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.reasonTitle",{defaultMessage:"Reason"}),m=a.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.riskScoreTitle",{defaultMessage:"Risk Score"}),g=a.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.thresholdCount",{defaultMessage:"Event Count"}),f=a.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.thresholdTerms",{defaultMessage:"Threshold Terms"}),b=a.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.thresholdCardinality",{defaultMessage:"Event Cardinality"}),y=a.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.newTerms",{defaultMessage:"New Terms"}),h=a.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.newTermsFields",{defaultMessage:"New Terms fields"}),v=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.actions.investigateInTimelineTitle",{defaultMessage:"Investigate in timeline"}),E=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.actions.investigateInTimelineAriaLabel",{defaultMessage:"Send alert to timeline"}),x=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.actions.addException",{defaultMessage:"Add rule exception"}),k=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.actions.addEventFilter",{defaultMessage:"Add Endpoint event filter"}),S=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.actions.addEventFilter.disabled.tooltip",{defaultMessage:"Endpoint event filters can be created from the Events section of the Hosts page."}),w=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.actions.addEndpointException",{defaultMessage:"Add Endpoint exception"}),j=(a.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.alertDurationTitle",{defaultMessage:"Alert duration"}),a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.closedAlertFailedToastMessage",{defaultMessage:"Failed to close alert(s)."}),a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.openedAlertFailedToastMessage",{defaultMessage:"Failed to open alert(s)"}),a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.acknowledgedAlertFailedToastMessage",{defaultMessage:"Failed to mark alert(s) as acknowledged"}),a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.moreActionsAriaLabel",{defaultMessage:"More actions"})),O=(a.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.statusTitle",{defaultMessage:"Status"}),a.i18n.translate("xpack.securitySolution.eventsViewer.alerts.overview.changeAlertStatus",{defaultMessage:"Change alert status"})),I=a.i18n.translate("xpack.securitySolution.eventsViewer.alerts.overview.clickToChangeAlertStatus",{defaultMessage:"Click to change alert status"}),T=a.i18n.translate("xpack.securitySolution.eventsViewer.alerts.overviewTable.signalStatusTitle",{defaultMessage:"Status"}),C=(a.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.triggeredTitle",{defaultMessage:"Triggered"}),a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.actions.addToCase",{defaultMessage:"Add to existing case"})),M=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.actions.addToNewCase",{defaultMessage:"Add to new case"}),N=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.actions.addToCaseDisabled",{defaultMessage:"Add to case is not supported for this selection"}),D=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.actions.addBulkToTimeline",{defaultMessage:"Investigate in timeline"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n(32),i=n(4),r=n.n(i),o=n(33),s=n.n(o),l=n(47),c=n.n(l),u=n(124),d=n(615),p=n(856);const m=s.a.header.withConfig({displayName:"Header",componentId:"sc-g1ve9j-0"})(["&.toggle-expand{margin-bottom:",";}.no-margin{margin-top:0 !important;margin-bottom:0 !important;}"," margin-bottom:0;user-select:text;",""],(({theme:e})=>e.eui.euiSizeL),(({height:e})=>e&&Object(o.css)(["height:","px;"],e)),(({border:e})=>e&&Object(o.css)(["border-bottom:",";padding-bottom:",";"],(({theme:e})=>e.eui.euiBorderThin),(({theme:e})=>e.eui.euiSizeL))));m.displayName="Header";const g=({alignHeader:e,stackHeader:t})=>null!=e?e:t?void 0:"center",f=({alignHeader:e,border:t,children:n,outerDirection:o="column",growLeftSplit:s=!0,headerFilters:l,height:f,hideSubtitle:b=!1,id:y,inspectMultiple:h=!1,inspectTitle:v,isInspectDisabled:E,showInspectButton:x=!0,split:k,stackHeader:S,subtitle:w,title:j,titleSize:O="m",toggleQuery:I,toggleStatus:T=!0,tooltip:C})=>{const M=Object(i.useCallback)((()=>{I&&I(!T)}),[I,T]),N=c()({"toggle-expand":T,siemHeaderSection:!0});return r.a.createElement(m,{"data-test-subj":"header-section",border:t,height:f,className:N,$hideSubtitle:b},r.a.createElement(a.EuiFlexGroup,{"data-test-subj":"headerSectionOuterFlexGroup",direction:o,gutterSize:"xs",responsive:!1},r.a.createElement(a.EuiFlexItem,{grow:s},r.a.createElement(a.EuiFlexGroup,{alignItems:g({alignHeader:e,stackHeader:S}),"data-test-subj":"headerSectionInnerFlexGroup",direction:S?"column":"row",gutterSize:"s"},r.a.createElement(a.EuiFlexItem,{grow:s,className:T?"":"no-margin"},r.a.createElement(a.EuiFlexGroup,{alignItems:"center",responsive:!1,gutterSize:"s"},r.a.createElement(a.EuiFlexItem,null,r.a.createElement(a.EuiFlexGroup,{responsive:!1,gutterSize:"none",className:"header-section-titles"},I&&r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiButtonIcon,{"data-test-subj":"query-toggle-header","aria-label":p.a(T),color:"text",display:"empty",iconType:T?"arrowDown":"arrowRight",onClick:M,size:"s",title:p.a(T)})),r.a.createElement(a.EuiFlexItem,null,r.a.createElement(a.EuiTitle,{size:O},r.a.createElement("h4",{"data-test-subj":"header-section-title"},r.a.createElement("span",{className:"eui-textBreakNormal"},j),C&&r.a.createElement(r.a.Fragment,null," ",r.a.createElement(a.EuiIconTip,{color:"subdued",content:C,size:"l",type:"iInCircle"}))))))),y&&T&&r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(u.b,{isDisabled:E,queryId:y,multiple:h,showInspectButton:x,title:null!=v?v:j})),l&&T&&r.a.createElement(a.EuiFlexItem,{"data-test-subj":"header-section-filters",grow:!1},l))),n&&T&&r.a.createElement(a.EuiFlexItem,{"data-test-subj":"header-section-supplements",grow:!!k},n))),!b&&T&&r.a.createElement(a.EuiFlexItem,null,r.a.createElement(d.a,{"data-test-subj":"header-section-subtitle",items:w}))))},b=r.a.memo(f)},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(4),i=n(699);const r=()=>Object(a.useContext)(i.a)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"g",(function(){return l})),n.d(t,"i",(function(){return c})),n.d(t,"h",(function(){return u})),n.d(t,"j",(function(){return d})),n.d(t,"k",(function(){return p})),n.d(t,"l",(function(){return m})),n.d(t,"m",(function(){return g})),n.d(t,"o",(function(){return f})),n.d(t,"n",(function(){return b})),n.d(t,"w",(function(){return y})),n.d(t,"y",(function(){return h})),n.d(t,"z",(function(){return v})),n.d(t,"A",(function(){return E})),n.d(t,"B",(function(){return x})),n.d(t,"d",(function(){return k})),n.d(t,"e",(function(){return S})),n.d(t,"C",(function(){return w})),n.d(t,"D",(function(){return j})),n.d(t,"E",(function(){return O})),n.d(t,"F",(function(){return I})),n.d(t,"H",(function(){return T})),n.d(t,"I",(function(){return C})),n.d(t,"J",(function(){return M})),n.d(t,"K",(function(){return N})),n.d(t,"W",(function(){return D})),n.d(t,"X",(function(){return F})),n.d(t,"Y",(function(){return A})),n.d(t,"Z",(function(){return _})),n.d(t,"x",(function(){return R})),n.d(t,"ab",(function(){return P})),n.d(t,"bb",(function(){return L})),n.d(t,"L",(function(){return q})),n.d(t,"M",(function(){return B})),n.d(t,"O",(function(){return z})),n.d(t,"R",(function(){return $})),n.d(t,"S",(function(){return V})),n.d(t,"P",(function(){return U})),n.d(t,"Q",(function(){return H})),n.d(t,"V",(function(){return G})),n.d(t,"U",(function(){return Q})),n.d(t,"q",(function(){return W})),n.d(t,"p",(function(){return K})),n.d(t,"u",(function(){return Y})),n.d(t,"N",(function(){return J})),n.d(t,"v",(function(){return X})),n.d(t,"G",(function(){return Z})),n.d(t,"T",(function(){return ee})),n.d(t,"r",(function(){return te})),n.d(t,"t",(function(){return ne})),n.d(t,"s",(function(){return ae}));var a=n(0);const i=a.i18n.translate("xpack.securitySolution.open.timeline.batchActionsTitle",{defaultMessage:"Bulk actions"}),r=a.i18n.translate("xpack.securitySolution.open.timeline.cancelButton",{defaultMessage:"Cancel"}),o=a.i18n.translate("xpack.securitySolution.open.timeline.collapseButton",{defaultMessage:"Collapse"}),s=a.i18n.translate("xpack.securitySolution.open.timeline.deleteButton",{defaultMessage:"Delete"}),l=a.i18n.translate("xpack.securitySolution.open.timeline.deleteSelectedButton",{defaultMessage:"Delete selected"}),c=a.i18n.translate("xpack.securitySolution.open.timeline.deleteWarningLabel",{defaultMessage:"You will not be able to recover this timeline or its notes once deleted."}),u=a.i18n.translate("xpack.securitySolution.open.timeline.deleteTemplateWarningLabel",{defaultMessage:"You will not be able to recover this timeline template or its notes once deleted."}),d=a.i18n.translate("xpack.securitySolution.open.timeline.descriptionTableHeader",{defaultMessage:"Description"}),p=a.i18n.translate("xpack.securitySolution.open.timeline.expandButton",{defaultMessage:"Expand"}),m=a.i18n.translate("xpack.securitySolution.open.timeline.exportFileNameTitle",{defaultMessage:"timelines_export"}),g=a.i18n.translate("xpack.securitySolution.open.timeline.exportSelectedButton",{defaultMessage:"Export selected"}),f=a.i18n.translate("xpack.securitySolution.open.timeline.favoriteSelectedButton",{defaultMessage:"Favorite selected"}),b=a.i18n.translate("xpack.securitySolution.open.timeline.favoritesTooltip",{defaultMessage:"Favorites"}),y=a.i18n.translate("xpack.securitySolution.open.timeline.lastModifiedTableHeader",{defaultMessage:"Last modified"}),h=a.i18n.translate("xpack.securitySolution.open.timeline.missingSavedObjectIdTooltip",{defaultMessage:"Missing savedObjectId"}),v=a.i18n.translate("xpack.securitySolution.open.timeline.modifiedByTableHeader",{defaultMessage:"Modified by"}),E=a.i18n.translate("xpack.securitySolution.open.timeline.notesTooltip",{defaultMessage:"Notes"}),x=a.i18n.translate("xpack.securitySolution.open.timeline.onlyFavoritesButtonLabel",{defaultMessage:"Only favorites"}),k=a.i18n.translate("xpack.securitySolution.open.timeline.createTemplateFromTimelineTooltip",{defaultMessage:"Create template from timeline"}),S=a.i18n.translate("xpack.securitySolution.open.timeline.createTimelineFromTemplateTooltip",{defaultMessage:"Create timeline from template"}),w=a.i18n.translate("xpack.securitySolution.open.timeline.openAsDuplicateTooltip",{defaultMessage:"Duplicate timeline"}),j=a.i18n.translate("xpack.securitySolution.open.timeline.openAsDuplicateTemplateTooltip",{defaultMessage:"Duplicate template"}),O=a.i18n.translate("xpack.securitySolution.open.timeline.openTimelineButton",{defaultMessage:"Open Timelineâ€¦"}),I=a.i18n.translate("xpack.securitySolution.open.timeline.openTimelineTitle",{defaultMessage:"Open"}),T=a.i18n.translate("xpack.securitySolution.open.timeline.pinnedEventsTooltip",{defaultMessage:"Pinned events"}),C=a.i18n.translate("xpack.securitySolution.open.timeline.refreshTitle",{defaultMessage:"Refresh"}),M=a.i18n.translate("xpack.securitySolution.open.timeline.searchPlaceholder",{defaultMessage:"e.g. timeline name, or description"}),N=a.i18n.translate("xpack.securitySolution.open.timeline.searchTemplatePlaceholder",{defaultMessage:"e.g. template name, or description"}),D=a.i18n.translate("xpack.securitySolution.open.timeline.timelineNameTableHeader",{defaultMessage:"Timeline name"}),F=a.i18n.translate("xpack.securitySolution.open.timeline.timelineTemplateNameTableHeader",{defaultMessage:"Template name"}),A=a.i18n.translate("xpack.securitySolution.open.timeline.untitledTimelineLabel",{defaultMessage:"Untitled timeline"}),_=a.i18n.translate("xpack.securitySolution.open.timeline.withLabel",{defaultMessage:"with"}),R=a.i18n.translate("xpack.securitySolution.open.timeline.loadingLabel",{defaultMessage:"Loading..."}),P=a.i18n.translate("xpack.securitySolution.open.timeline.zeroTimelinesMatchLabel",{defaultMessage:"0 timelines match the search criteria"}),L=a.i18n.translate("xpack.securitySolution.open.timeline.zeroTimelineTemplatesMatchLabel",{defaultMessage:"0 timeline templates match the search criteria"}),q=e=>a.i18n.translate("xpack.securitySolution.open.timeline.selectedTemplatesTitle",{values:{selectedTemplates:e},defaultMessage:"Selected {selectedTemplates} {selectedTemplates, plural, =1 {template} other {templates}}"}),B=e=>a.i18n.translate("xpack.securitySolution.open.timeline.selectedTimelinesTitle",{values:{selectedTimelines:e},defaultMessage:"Selected {selectedTimelines} {selectedTimelines, plural, =1 {timeline} other {timelines}}"}),z=a.i18n.translate("xpack.securitySolution.open.timeline.showingLabel",{defaultMessage:"Showing:"}),$=e=>a.i18n.translate("xpack.securitySolution.open.timeline.successfullyExportedTimelinesTitle",{values:{totalTimelines:e},defaultMessage:"Successfully exported {totalTimelines, plural, =0 {all timelines} =1 {{totalTimelines} timeline} other {{totalTimelines} timelines}}"}),V=e=>a.i18n.translate("xpack.securitySolution.open.timeline.successfullyExportedTimelineTemplatesTitle",{values:{totalTimelineTemplates:e},defaultMessage:"Successfully exported {totalTimelineTemplates, plural, =0 {all timelines} =1 {{totalTimelineTemplates} timeline template} other {{totalTimelineTemplates} timeline templates}}"}),U=e=>a.i18n.translate("xpack.securitySolution.open.timeline.successfullyDeletedTimelinesTitle",{values:{totalTimelines:e},defaultMessage:"Successfully deleted {totalTimelines, plural, =0 {all timelines} =1 {{totalTimelines} timeline} other {{totalTimelines} timelines}}"}),H=e=>a.i18n.translate("xpack.securitySolution.open.timeline.successfullyDeletedTimelineTemplatesTitle",{values:{totalTimelineTemplates:e},defaultMessage:"Successfully deleted {totalTimelineTemplates, plural, =0 {all timelines} =1 {{totalTimelineTemplates} timeline template} other {{totalTimelineTemplates} timeline templates}}"}),G=a.i18n.translate("xpack.securitySolution.timelines.components.tabs.timelinesTitle",{defaultMessage:"Timelines"}),Q=a.i18n.translate("xpack.securitySolution.timelines.components.tabs.templatesTitle",{defaultMessage:"Templates"}),W=a.i18n.translate("xpack.securitySolution.timelines.components.templateFilter.elasticTitle",{defaultMessage:"Elastic templates"}),K=a.i18n.translate("xpack.securitySolution.timelines.components.templateFilter.customizedTitle",{defaultMessage:"Custom templates"}),Y=a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.importTimelineTitle",{defaultMessage:"Import"}),J=a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.selectTimelineDescription",{defaultMessage:"Select a timeline or timeline template file to import"}),X=a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.initialPromptTextDescription",{defaultMessage:"Select or drag and drop a valid timelines_export.ndjson file"}),Z=a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.overwriteDescription",{defaultMessage:"Automatically overwrite saved objects with the same timeline ID"}),ee=e=>a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.successfullyImportedTimelinesTitle",{values:{totalCount:e},defaultMessage:"Successfully imported {totalCount} {totalCount, plural, =1 {item} other {items}}"}),te=e=>a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.importFailedTitle",{values:{totalTimelines:e},defaultMessage:"Failed to import {totalTimelines} {totalTimelines, plural, =1 {timeline} other {timelines}}"}),ne=a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.importTitle",{defaultMessage:"Importâ€¦"}),ae=e=>a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.importFailedDetailedTitle",{values:{message:e},defaultMessage:"{message}"})},function(e,t,n){"use strict";var a=n(189);e.exports=function(e,t,n,i){var r=i?i-1:1/0,o=0;return function(i){return a(i)?(e.enter(n),s(i)):t(i)};function s(i){return a(i)&&o++<r?(e.consume(i),s):(e.exit(n),t(i))}}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return p})),n.d(t,"b",(function(){return g}));var a=n(32),i=n(4),r=n.n(i),o=n(90),s=n(211),l=n(554),c=n(556),u=n(555);const d="inspectButtonComponent",p=({children:e,show:t=!0})=>r.a.createElement(s.a,{show:t,targetClassNames:[d]},e),m=({compact:e=!1,inputId:t=o.a.global,inspectIndex:n=0,isDisabled:i,multiple:s=!1,onCloseInspect:p,queryId:m="",showInspectButton:g=!0,title:f=""})=>{const{additionalRequests:b,additionalResponses:y,handleClick:h,handleCloseModal:v,isButtonDisabled:E,isShowingModal:x,loading:k,request:S,response:w}=Object(c.a)({inputId:t,inspectIndex:n,isDisabled:i,multiple:s,onCloseInspect:p,queryId:m});return r.a.createElement(r.a.Fragment,null,t===o.a.timeline&&!e&&g&&r.a.createElement(a.EuiButtonEmpty,{className:d,"aria-label":u.d,"data-test-subj":"inspect-empty-button",color:"text",iconSide:"left",iconType:"inspect",isDisabled:E,isLoading:k,onClick:h},u.d),(t===o.a.global||e)&&g&&r.a.createElement(a.EuiButtonIcon,{className:d,"aria-label":u.d,"data-test-subj":"inspect-icon-button",iconSize:"m",iconType:"inspect",isDisabled:E,title:u.d,onClick:h}),x&&null!==S&&null!==w&&r.a.createElement(l.a,{additionalRequests:b,additionalResponses:y,closeModal:v,"data-test-subj":"inspect-modal",inputId:t,request:S,response:w,title:f}))};m.displayName="InspectButtonComponent";const g=r.a.memo(m)},function(e,t,n){const a=n(307),{MAX_LENGTH:i,MAX_SAFE_INTEGER:r}=n(308),{re:o,t:s}=n(235),l=n(322),{compareIdentifiers:c}=n(391);class SemVer{constructor(e,t){if(t=l(t),e instanceof SemVer){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError(`Invalid Version: ${e}`);if(e.length>i)throw new TypeError(`version is longer than ${i} characters`);a("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const n=e.trim().match(t.loose?o[s.LOOSE]:o[s.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>r||this.major<0)throw new TypeError("Invalid major version");if(this.minor>r||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>r||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<r)return t}return e})):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(a("SemVer.compare",this.version,this.options,e),!(e instanceof SemVer)){if("string"==typeof e&&e===this.version)return 0;e=new SemVer(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof SemVer||(e=new SemVer(e,this.options)),c(this.major,e.major)||c(this.minor,e.minor)||c(this.patch,e.patch)}comparePre(e){if(e instanceof SemVer||(e=new SemVer(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const n=this.prerelease[t],i=e.prerelease[t];if(a("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return c(n,i)}while(++t)}compareBuild(e){e instanceof SemVer||(e=new SemVer(e,this.options));let t=0;do{const n=this.build[t],i=e.build[t];if(a("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return c(n,i)}while(++t)}inc(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{let e=this.prerelease.length;for(;--e>=0;)"number"==typeof this.prerelease[e]&&(this.prerelease[e]++,e=-2);-1===e&&this.prerelease.push(0)}t&&(0===c(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error(`invalid increment argument: ${e}`)}return this.format(),this.raw=this.version,this}}e.exports=SemVer},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(34);const i=e=>Object(a.isString)(e)?e:JSON.stringify(e)},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var a=n(34),i=n(4),r=n.n(i);function o(e){var t;const n=t=>{const{deleteQuery:n,id:i,inspect:o=null,loading:l,refetch:c,setQuery:u,searchSessionId:d}=t;s({deleteQuery:n,inspect:o,loading:l,queryId:i,refetch:c,searchSessionId:d,setQuery:u});const p=Object(a.omit)(["refetch","setQuery"],t);return r.a.createElement(e,p)};return n.displayName=`ManageQuery (${null!==(t=null==e?void 0:e.displayName)&&void 0!==t?t:"Unknown"})`,n}const s=({setQuery:e,deleteQuery:t,refetch:n,inspect:a,loading:r,queryId:o,searchSessionId:s})=>{Object(i.useEffect)((()=>{e({id:o,inspect:null!=a?a:null,loading:r,refetch:n,searchSessionId:s})}),[t,e,o,n,a,r,s]),Object(i.useEffect)((()=>()=>{t&&t({id:o})}),[t,o])}},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var a=n(15),i=n(34),r=n(4),o=n(129),s=n(48),l=n(69),c=n(0);const u=e=>c.i18n.translate("xpack.securitySolution.searchStrategy.error",{values:{factoryQueryType:e},defaultMessage:"Failed to run search: {factoryQueryType}"});var d=n(99),p=n(77),m=n(84),g=n(231),f=n(1);const b={dsl:[],response:[]},y=({factoryQueryType:e,initialResult:t,errorMessage:n,abort:y=!1,showErrorToast:h=!0})=>{const v=Object(r.useRef)(new AbortController),E=Object(r.useRef)(i.noop),{addError:x}=Object(m.a)(),k=(e=>{const{data:t}=Object(p.k)().services,{addWarning:n}=Object(m.a)(),{startTracking:i}=Object(g.a)();return Object(r.useCallback)((({abortSignal:r,request:o})=>{const{endTracking:l}=i({name:`${f.B} searchStrategy ${e}`,spanName:"batched search"}),u=t.search.search({...o,factoryQueryType:e},{strategy:"securitySolutionSearchStrategy",abortSignal:r}).pipe(Object(a.filter)((e=>Object(s.isErrorResponse)(e)||Object(s.isCompleteResponse)(e))));return u.subscribe({next:t=>{Object(s.isErrorResponse)(t)?(n((e=>c.i18n.translate("xpack.securitySolution.searchStrategy.warning",{values:{factoryQueryType:e},defaultMessage:"An error has occurred running search: {factoryQueryType}"}))(e)),l("invalid")):l("success")},error:()=>{l(r.aborted?"aborted":"error")}}),u}),[n,t.search,e,i])})(e),{start:S,error:w,result:j,loading:O}=Object(o.c)(k);Object(r.useEffect)((()=>{!h||null==w||w instanceof l.AbortError||x(w,{title:null!=n?n:u(e)})}),[x,w,n,e,h]);const I=Object(r.useCallback)((e=>{const t=()=>{v.current=new AbortController,S({request:e,abortSignal:v.current.signal})};v.current.abort(),t(),E.current=t}),[S]);Object(r.useEffect)((()=>()=>{v.current.abort()}),[]),Object(r.useEffect)((()=>{y&&v.current.abort()}),[y]);const[T,C]=Object(r.useMemo)((()=>Object(s.isErrorResponse)(j)?[t,b]:[Object(i.omit)("rawResponse",j),Object(d.getInspectResponse)(j,b)]),[j,t]);return{loading:O,result:T,error:w,search:I,refetch:E.current,inspect:C}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return l}));var a=n(80),i=n(103),r=n(502),o=n(244);let s,l;!function(e){e.enable="enable",e.disable="disable",e.export="export",e.delete="delete",e.duplicate="duplicate",e.edit="edit"}(s||(s={})),function(e){e.add_tags="add_tags",e.delete_tags="delete_tags",e.set_tags="set_tags",e.add_index_patterns="add_index_patterns",e.delete_index_patterns="delete_index_patterns",e.set_index_patterns="set_index_patterns",e.set_timeline="set_timeline",e.add_rule_actions="add_rule_actions",e.set_rule_actions="set_rule_actions",e.set_schedule="set_schedule"}(l||(l={}));const c=a.union([a.literal("rule"),Object(i.q)({allowedDurations:[[1,"h"],[1,"d"],[7,"d"]]})]),u=a.type({type:a.union([a.literal(l.add_tags),a.literal(l.delete_tags),a.literal(l.set_tags)]),value:o.z}),d=a.intersection([a.type({type:a.union([a.literal(l.add_index_patterns),a.literal(l.delete_index_patterns),a.literal(l.set_index_patterns)]),value:o.h}),a.exact(a.partial({overwrite_data_views:a.boolean}))]),p=a.type({type:a.literal(l.set_timeline),value:a.type({timeline_id:o.I,timeline_title:o.J})}),m=a.exact(a.type({group:r.f,id:r.g,params:r.h})),g=a.type({type:a.union([a.literal(l.add_rule_actions),a.literal(l.set_rule_actions)]),value:a.type({throttle:c,actions:a.array(m)})}),f=a.type({type:a.literal(l.set_schedule),value:a.type({interval:Object(i.q)({allowedUnits:["s","m","h"]}),lookback:Object(i.q)({allowedUnits:["s","m","h"]})})}),b=a.union([u,d,p,g,f]),y=a.exact(a.type({include_exceptions:a.boolean}));a.intersection([a.exact(a.type({query:a.union([o.w,a[void 0]])})),a.exact(a.partial({ids:Object(i.j)(a.string)})),a.union([a.exact(a.type({action:a.union([a.literal(s.delete),a.literal(s.disable),a.literal(s.enable),a.literal(s.export)])})),a.intersection([a.exact(a.type({action:a.literal(s.duplicate)})),a.exact(a.partial({[s.duplicate]:y}))]),a.exact(a.type({action:a.literal(s.edit),[s.edit]:Object(i.j)(b)}))])]),a.exact(a.partial({dry_run:a.union([a.literal("true"),a.literal("false")])}))},,function(e,t,n){"use strict";n.d(t,"a",(function(){return I})),n.d(t,"c",(function(){return C})),n.d(t,"b",(function(){return F}));var a=n(82),i=n.n(a),r=n(32),o=n(83),s=n(4),l=n.n(s),c=n(57),u=n(78),d=n(33),p=n.n(d),m=n(104),g=n(395),f=n(241),b=n(203),y=n(552),h=n(102),v=n(604),E=n(605),x=n(77),k=n(38),S=n(585),w=n(594),j=n(462);const O=({dataProvider:e,isAggregatable:t,fieldType:n,hideTopN:a,isDraggable:i,onFilterAdded:r,render:o,scopeId:c})=>{const{timelineId:u}=Object(s.useContext)(S.b),{tableId:d}=Object(s.useContext)(k.TableContext),p=Object(s.useRef)(null),m=Object(s.useRef)(null),[g,f]=Object(s.useState)(!1),[b,y]=Object(s.useState)(!1),v=Object(s.useMemo)((()=>c||(null!=u?u:d)),[c,d,u]),E=Object(s.useCallback)((()=>{f((e=>!e)),y((e=>(e&&setTimeout((()=>{var e;null===(e=m.current)||void 0===e||e.focus()}),0),!1))),setTimeout((()=>{y(!1)}),0)}),[m]),{closeTopN:x,toggleTopN:O,isShowingTopN:I}=Object(j.b)(E),T=Object(s.useMemo)((()=>{const t=e.queryMatch.value;return"number"==typeof t?t.toString():Array.isArray(t)?t.map((e=>String(e))):t}),[e.queryMatch.value]),M=Object(s.useMemo)((()=>{const s=b&&!I&&(null!==(u=null==(c=p.current)?void 0:c.querySelectorAll(".euiLink"))&&void 0!==u?u:[]).length>0?l.a.createElement(C,{"data-test-subj":`draggable-link-content-${e.queryMatch.field}`},o(e,null,{isDragging:!1,isDropAnimating:!1})):null;var c,u;return l.a.createElement(w.a,{additionalContent:s,closeTopN:x,closePopOver:E,dataProvider:e,draggableId:i?Object(h.k)(e.id):void 0,field:e.queryMatch.field,isAggregatable:t,fieldType:n,hideTopN:a,isObjectArray:!1,onFilterAdded:r,ownFocus:b,showOwnFocus:!1,showTopN:I,scopeId:v,toggleTopN:O,values:T})}),[b,I,e,o,x,E,i,t,n,a,r,v,O,T]),N=Object(s.useCallback)((e=>{p.current=e}),[]),D=Object(s.useCallback)((()=>{var e;b||null===(e=m.current)||void 0===e||e.focus()}),[b,m]),F=Object(s.useCallback)((()=>{x(),b&&(y(!1),setTimeout((()=>{D()}),0))}),[D,b,x]),A=Object(s.useCallback)((()=>{y(!0)}),[]);return Object(s.useMemo)((()=>({closePopOverTrigger:g,handleClosePopOverTrigger:E,hoverActionsOwnFocus:b,hoverContent:M,keyboardHandlerRef:m,onCloseRequested:F,onFocus:D,openPopover:A,setContainerRef:N,isShowingTopN:I})),[g,E,b,M,F,D,A,N,I])},I=p.a.div.withConfig({displayName:"DragEffects",componentId:"sc-m7vcsn-0"})([""]);I.displayName="DragEffects";class draggable_wrapper_DragDropErrorBoundary extends l.a.PureComponent{componentDidCatch(){this.forceUpdate()}render(){return this.props.children}}const T=p.a.div.withConfig({displayName:"Wrapper",componentId:"sc-m7vcsn-1"})(["display:inline-block;max-width:100%;[data-rbd-placeholder-context-id]{display:none !important;}",""],(({disabled:e})=>e&&"\n    [data-rbd-draggable-id]:hover,\n    .euiBadge:hover,\n    .euiBadge__text:hover {\n      cursor: default;\n    }\n  "));T.displayName="Wrapper";const C=p.a.span.withConfig({displayName:"ProviderContentWrapper",componentId:"sc-m7vcsn-2"})(["> span.euiToolTipAnchor{display:block;}> span.euiToolTipAnchor.eui-textTruncate{display:inline-block;}"]),M=(e,t)=>t.isDropAnimating?{...e,transitionDuration:"0.00000001s"}:e,N=({dataProvider:e,hideTopN:t=!1,onFilterAdded:n,render:a,fieldType:d="",isAggregatable:p=!1,scopeId:m,truncate:k})=>{const[S,w]=Object(s.useState)(!1),j=e.id.includes(`-${f.a}-`),I=Object(u.useDispatch)(),{timelines:N}=Object(x.k)().services,{closePopOverTrigger:D,handleClosePopOverTrigger:F,hoverActionsOwnFocus:_,hoverContent:R,keyboardHandlerRef:P,onCloseRequested:L,openPopover:q,onFocus:B,setContainerRef:z,isShowingTopN:$}=O({dataProvider:e,hideTopN:t,onFilterAdded:n,render:a,fieldType:d,isAggregatable:p,scopeId:m,truncate:k}),V=Object(s.useCallback)((()=>{j||(I(g.a.registerProvider({provider:e})),w(!0))}),[j,I,e]),U=Object(s.useCallback)((()=>S&&I(g.a.unRegisterProvider({id:e.id}))),[S,I,e.id]);Object(s.useEffect)((()=>()=>{U()}),[U]);const H=Object(s.useCallback)(((t,n)=>l.a.createElement(A,{registerProvider:V},l.a.createElement("div",i()({},t.draggableProps,t.dragHandleProps,{style:M(t.draggableProps.style,n),ref:t.innerRef,"data-test-subj":"providerContainer",tabIndex:-1}),l.a.createElement(C,{"data-test-subj":`draggable-content-${e.queryMatch.field}`},a(e,t,n))))),[e,V,a]),G=Object(s.useCallback)(((t,n)=>l.a.createElement(v.a,i()({},t.draggableProps,t.dragHandleProps,{ref:e=>{t.innerRef(e),z(e)},"data-test-subj":"providerContainer",isDragging:n.isDragging,registerProvider:V,tabIndex:-1}),l.a.createElement(r.EuiScreenReaderOnly,{"data-test-subj":"screenReaderOnlyField"},l.a.createElement("p",null,e.queryMatch.field)),k&&!n.isDragging?l.a.createElement(b.b,{"data-test-subj":"draggable-truncatable-content"},a(e,t,n)):l.a.createElement(C,{"data-test-subj":`draggable-content-${e.queryMatch.field}`},a(e,t,n)),!n.isDragging&&l.a.createElement(r.EuiScreenReaderOnly,{"data-test-subj":"draggableKeyboardInstructionsNotDragging"},l.a.createElement("p",null,E.b)))),[e,V,a,z,k]),{onBlur:Q,onKeyDown:W}=N.getUseDraggableKeyboardWrapper()({closePopover:F,draggableId:Object(h.k)(e.id),fieldName:e.queryMatch.field,keyboardHandlerRef:P,openPopover:q}),K=Object(s.useCallback)((t=>l.a.createElement("div",i()({ref:t.innerRef},t.droppableProps),l.a.createElement("div",{className:o.a,"data-test-subj":"draggableWrapperKeyboardHandler",onClick:B,onBlur:Q,onKeyDown:W,ref:P,role:"button",tabIndex:0},l.a.createElement(c.Draggable,{draggableId:Object(h.k)(e.id),index:0,key:Object(h.k)(e.id),isDragDisabled:j},G)),t.placeholder)),[G,e.id,j,P,Q,B,W]),Y=Object(s.useMemo)((()=>l.a.createElement(T,{"data-test-subj":"draggableWrapperDiv",disabled:j},l.a.createElement(draggable_wrapper_DragDropErrorBoundary,null,l.a.createElement(c.Droppable,{isDropDisabled:!0,droppableId:Object(h.l)(e.id),renderClone:H},K)))),[K,H,e.id,j]),J=Object(s.useCallback)((()=>Y),[Y]);return j?l.a.createElement(l.a.Fragment,null,Y):l.a.createElement(y.a,{alwaysShow:$||_,closePopOverTrigger:D,hoverContent:R,onCloseRequested:L,render:J})},D=({dataProvider:e,hideTopN:t=!1,isDraggable:n=!1,onFilterAdded:a,render:i,isAggregatable:r=!1,fieldType:o="",scopeId:c,truncate:u})=>{const{closePopOverTrigger:d,hoverActionsOwnFocus:p,hoverContent:g,onCloseRequested:v,setContainerRef:E,isShowingTopN:x}=O({dataProvider:e,hideTopN:t,isDraggable:n,isAggregatable:r,fieldType:o,onFilterAdded:a,render:i,scopeId:c,truncate:u}),k=Object(s.useCallback)((()=>l.a.createElement("div",{ref:e=>{E(e)},tabIndex:-1,"data-provider-id":Object(h.k)(e.id)},u?l.a.createElement(b.b,{"data-test-subj":"render-truncatable-content"},i(e,null,{isDragging:!1,isDropAnimating:!1})):l.a.createElement(C,{"data-test-subj":`render-content-${e.queryMatch.field}`},i(e,null,{isDragging:!1,isDropAnimating:!1})))),[e,i,E,u]);return n?l.a.createElement(N,{dataProvider:e,hideTopN:t,onFilterAdded:a,fieldType:o,isAggregatable:r,render:i,scopeId:c,truncate:u}):l.a.createElement(y.a,{alwaysShow:x||p,closePopOverTrigger:d,hoverContent:(S=c,[m.c.rulePreview,f.a].includes(null!=S?S:"")?void 0:g),onCloseRequested:v,render:k});var S},F=l.a.memo(D);F.displayName="DraggableWrapper";const A=l.a.memo((({children:e,registerProvider:t})=>(Object(s.useEffect)((()=>{t()}),[t]),l.a.createElement(l.a.Fragment,null,e))));A.displayName="ConditionalPortal"},function(e,t,n){"use strict";let a,i;n.r(t),n.d(t,"HostsType",(function(){return a})),n.d(t,"HostsTableType",(function(){return i})),function(e){e.page="page",e.details="details"}(a||(a={})),function(e){e.authentications="authentications",e.hosts="allHosts",e.events="events",e.uncommonProcesses="uncommonProcesses",e.anomalies="anomalies",e.risk="hostRisk",e.sessions="sessions"}(i||(i={}))},,function(e,t,n){"use strict";n.d(t,"a",(function(){return w})),n.d(t,"e",(function(){return j})),n.d(t,"d",(function(){return O})),n.d(t,"f",(function(){return I})),n.d(t,"g",(function(){return C})),n.d(t,"c",(function(){return $})),n.d(t,"h",(function(){return V})),n.d(t,"b",(function(){return U}));var a=n(528),i=n(34),r=n(117),o=n.n(r),s=n(252),l=n.n(s),c=n(90),u=n(79),d=n(402),p=n(143),m=n(12),g=n(112),f=n(158),b=n(159),y=n(549),h=n(106),v=n(526),E=n(177),x=n(95),k=n(381),S=n(227);const w="open-timeline",j=({pinnedEventIds:e})=>null!=e?Object.keys(e).length:0,O=({eventIdToNoteIds:e,noteIds:t})=>(null!=e?Object.keys(e).reduce(((t,n)=>t+e[n].length),0):0)+(null!=t?t.length:0),I=({title:e})=>null==e||0===e.trim().length,T=(e,t)=>"__typename"===e?void 0:t,C=e=>JSON.parse(JSON.stringify(e),T),M=e=>{try{return JSON.parse(e)}catch{return e}},N=e=>Object.entries(e).reduce(((e,[t,n])=>"id"!==t&&null!=n?{...e,[t]:n}:e),{columnHeaderType:f.a,id:null!=e.id?e.id:"unknown",initialWidth:"@timestamp"===e.id?b.b:b.a}),D=e=>({$state:{store:"appState"},meta:{...e.meta,...e.meta&&null!=e.meta.field?{params:M(e.meta.field)}:{},...e.meta&&null!=e.meta.params?{params:M(e.meta.params)}:{},...e.meta&&null!=e.meta.value?{value:M(e.meta.value)}:{}},...null!=e.exists?{exists:M(e.exists)}:{},...null!=e.match_all?{exists:M(e.match_all)}:{},...null!=e.missing?{exists:M(e.missing)}:{},...null!=e.query?{query:M(e.query)}:{},...null!=e.range?{range:M(e.range)}:{},...null!=e.script?{exists:M(e.script)}:{}}),F=(e,t)=>e?{}:null!=t?t.reduce(((e,t)=>{if(null!=t.eventId){const n=Object(i.getOr)([],t.eventId,e);return{...e,[t.eventId]:[...n,t.noteId]}}return e}),{}):{},A=(e,t)=>e?{}:null!=t?t.reduce(((e,t)=>({...e,...null!=t.eventId?{[t.eventId]:t}:{}})),{}):{},_=(e,t)=>e?{}:null!=t?t.reduce(((e,t)=>({...e,[t]:!0})),{}):{},R=(e,t,n)=>n===u.n.default&&e.timelineType===u.n.template?e.templateTimelineId:t&&e.timelineType===u.n.template?o.a.v4():e.templateTimelineId,P=({and:e,...t})=>t.type===u.a.template?l()(t,{type:u.a.default,enabled:t.queryMatch.operator!==h.d,queryMatch:{value:t.queryMatch.operator===h.d?"":t.queryMatch.value}}):t,L=(e,t,n)=>e&&t&&n===u.n.default?t.map((e=>{var t,n;return{...P(e),and:null!==(t=null===(n=e.and)||void 0===n?void 0:n.map(P))&&void 0!==t?t:[]}})):t,q=(e,t,n)=>n&&e.timelineType!==n?"":t?`${e.title} - Duplicate`:e.title||"",B=(e,t,n)=>n&&e.timelineType!==n?u.l.draft:t?u.l.active:e.status,z=(e,t,n)=>{const i=e.timelineType===u.n.template,r={...e,columns:null!=e.columns?e.columns.map(N):f.b,defaultColumns:f.b,dateRange:e.status===u.l.immutable&&e.timelineType===u.n.template?{start:k.a.toISOString(),end:k.b.toISOString()}:e.dateRange,dataProviders:L(t,e.dataProviders,n),eventIdToNoteIds:F(t,e.eventIdToNoteIds),filters:null!=e.filters?e.filters.map(D):[],isFavorite:!t&&null!=e.favorite&&e.favorite.length>0,noteIds:t?[]:null!=e.noteIds?e.noteIds:[],pinnedEventIds:_(t,e.pinnedEventIds),pinnedEventsSaveObject:A(t,e.pinnedEventsSaveObject),id:t?"":e.savedObjectId,status:B(e,t,n),savedObjectId:t?null:e.savedObjectId,version:t?null:e.version,timelineType:null!=n?n:e.timelineType,title:q(e,t,n),templateTimelineId:R(e,t,n),templateTimelineVersion:t&&i?1:e.templateTimelineVersion};return Object.entries(r).reduce(((e,[t,n])=>null!=n?Object(a.set)(t,n,e):e),{...g.b,id:""})},$=(e,t=!1,n)=>{const{notes:a,...i}=e;return{notes:a,timeline:z(i,t,n)}},V=({activeTimelineTab:e=u.m.query,duplicate:t=!1,graphEventId:n="",timelineId:a,timelineType:r,onError:o,onOpenTimeline:s,openTimeline:l=!0,updateIsLoading:c,updateTimeline:d})=>{c({id:u.j.active,isLoading:!0}),Promise.resolve(Object(S.i)(a)).then((a=>{const o=Object(i.getOr)(null,"data",a);if(!o)return;const c=C(o.timeline),{timeline:p,notes:m}=$(c,t,r);if(null!=s)s(p);else if(d){const{from:a,to:r}=Object(v.a)({from:Object(i.getOr)(null,"dateRange.start",p),to:Object(i.getOr)(null,"dateRange.end",p)});d({duplicate:t,from:a,id:u.j.active,notes:m,resolveTimelineConfig:{outcome:o.outcome,alias_target_id:o.alias_target_id,alias_purpose:o.alias_purpose},timeline:{...p,activeTab:e,graphEventId:n,show:l,dateRange:{start:a,end:r}},to:r})()}})).catch((e=>{null!=o&&o(e,a)})).finally((()=>{c({id:u.j.active,isLoading:!1})}))},U=e=>({duplicate:t,id:n,forceNotes:a=!1,from:r,notes:o,resolveTimelineConfig:s,timeline:l,to:g,ruleNote:f})=>()=>{var b;if(Object(i.isEmpty)(l.indexNames)||e(E.a.setSelectedDataView({id:x.SourcererScopeName.timeline,selectedDataViewId:l.dataViewId,selectedPatterns:l.indexNames})),l.status===u.l.immutable&&l.timelineType===u.n.template?e(Object(p.setRelativeRangeDatePicker)({id:c.a.timeline,fromStr:"now-24h",toStr:"now",from:k.a.toISOString(),to:k.b.toISOString()})):e(Object(p.setTimelineRangeDatePicker)({from:r,to:g})),e(Object(m.addTimeline)({id:n,timeline:l,resolveTimelineConfig:s,savedTimeline:t})),null!=l.kqlQuery&&null!=l.kqlQuery.filterQuery&&null!=l.kqlQuery.filterQuery.kuery&&""!==l.kqlQuery.filterQuery.kuery.expression&&e(Object(m.applyKqlFilterQuery)({id:n,filterQuery:{kuery:{kind:null!==(b=l.kqlQuery.filterQuery.kuery.kind)&&void 0!==b?b:"kuery",expression:l.kqlQuery.filterQuery.kuery.expression||""},serializedQuery:l.kqlQuery.filterQuery.serializedQuery||""}})),t&&null!=f&&!Object(i.isEmpty)(f)){const t=Object(y.a)({newNote:f});e(Object(d.updateNote)({note:t})),e(Object(m.addNote)({noteId:t.id,id:n}))}t&&!a||e(Object(d.addNotes)({notes:null!=o?o.map((e=>{var t,n;return{created:null!=e.created?new Date(e.created):new Date,id:e.noteId,lastEdit:null!=e.updated?new Date(e.updated):new Date,note:e.note||"",user:e.updatedBy||"unknown",saveObjectId:e.noteId,version:e.version,eventId:null!==(t=e.eventId)&&void 0!==t?t:null,timelineId:null!==(n=e.timelineId)&&void 0!==n?n:null}})):[]}))}},function(e,t,n){"use strict";let a,i,r;n.r(t),n.d(t,"UsersType",(function(){return a})),n.d(t,"UsersTableType",(function(){return i})),n.d(t,"UsersDetailsTableType",(function(){return r})),function(e){e.page="page",e.details="details"}(a||(a={})),function(e){e.allUsers="allUsers",e.authentications="authentications",e.anomalies="anomalies",e.risk="userRisk",e.events="events"}(i||(i={})),function(e){e.authentications="authentications",e.anomalies="anomalies",e.risk="userRisk",e.events="events"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"d",(function(){return h})),n.d(t,"n",(function(){return v})),n.d(t,"k",(function(){return E})),n.d(t,"m",(function(){return x})),n.d(t,"f",(function(){return k})),n.d(t,"e",(function(){return S})),n.d(t,"l",(function(){return w})),n.d(t,"b",(function(){return j})),n.d(t,"c",(function(){return O})),n.d(t,"j",(function(){return I})),n.d(t,"g",(function(){return T})),n.d(t,"i",(function(){return C})),n.d(t,"h",(function(){return M})),n.d(t,"a",(function(){return N}));var a=n(7),i=n(1),r=n(80),o=n(103);r.exact(r.type({rules_custom_installed:o.n,rules_installed:o.n,rules_not_installed:o.n,rules_not_updated:o.n,timelines_installed:o.n,timelines_not_installed:o.n,timelines_not_updated:o.n})),r.exact(r.type({rules_installed:o.n,rules_updated:o.n,timelines_installed:o.n,timelines_updated:o.n}));var s=n(407),l=n(244);r.intersection([l.c,l.N,r.exact(r.type({rule_id:l.y,version:l.A})),r.exact(r.partial({related_integrations:l.m,required_fields:l.n,setup:l.E}))]);var c=n(93);r.exact(r.type({id:l.v})),r.exact(r.type({items:r.array(c.i)})),r.intersection([r.exact(r.type({namespace_types:c.a})),r.exact(r.partial({ids:o.l,list_ids:o.l}))]);const u=r.exact(r.type({name:l.t,id:l.v,rule_id:l.y,exception_lists:c.x})),d=r.intersection([c.o,r.exact(r.type({referenced_rules:r.array(u)}))]),p=r.record(c.A,d),m=(r.exact(r.type({references:r.array(p)})),`${i.Jb}/rules`),g=(i.pb,`${m}/exceptions/_find_references`);var f=n(131),b=n(77),y=(n(113),n(814));const h=async({rule:e,signal:t})=>b.b.get().http.fetch(i.pb,{method:"POST",body:JSON.stringify(e),signal:t}),v=async({rule:e,signal:t})=>b.b.get().http.fetch(i.pb,{method:"PUT",body:JSON.stringify(e),signal:t}),E=async({ruleProperties:e,signal:t})=>b.b.get().http.fetch(i.pb,{method:"PATCH",body:JSON.stringify(e),signal:t}),x=async({rule:e,signal:t})=>b.b.get().http.fetch(i.ob,{method:"POST",body:JSON.stringify(e),signal:t}),k=async({filterOptions:e={filter:"",showCustomRules:!1,showElasticRules:!1,tags:[]},sortingOptions:t={field:"enabled",order:"desc"},pagination:n={page:1,perPage:20},signal:r})=>{const o=Object(y.a)(e),s={page:n.page,per_page:n.perPage,sort_field:(l=t.field,"name"===l?`${l}.keyword`:Object(a.camelCase)(l)),sort_order:t.order,...""!==o?{filter:o}:{}};var l;return b.b.get().http.fetch(i.qb,{method:"GET",query:s,signal:r})},S=async({id:e,signal:t})=>b.b.get().http.fetch(i.pb,{method:"GET",query:{id:e},signal:t});async function w({bulkAction:e,dryRun:t=!1}){const n={action:e.type,query:e.query,ids:e.ids,edit:e.type===f.b.edit?e.editPayload:void 0,duplicate:e.type===f.b.duplicate?e.duplicatePayload:void 0};return b.b.get().http.fetch(i.nb,{method:"POST",body:JSON.stringify(n),query:{dry_run:t}})}async function j(e){const t={action:f.b.export,query:e.query,ids:e.ids};return b.b.get().http.fetch(i.nb,{method:"POST",body:JSON.stringify(t)})}const O=async()=>await b.b.get().http.fetch(s.b,{method:"PUT"}),I=async({fileToImport:e,overwrite:t=!1,overwriteExceptions:n=!1,signal:a})=>{const r=new FormData;return r.append("file",e),b.b.get().http.fetch(`${i.pb}/_import`,{method:"POST",headers:{"Content-Type":void 0},query:{overwrite:t,overwrite_exceptions:n},body:r,signal:a})},T=async({signal:e})=>b.b.get().http.fetch(i.sb,{method:"GET",signal:e}),C=async({signal:e})=>b.b.get().http.fetch(s.a,{method:"GET",signal:e}),M=async({lists:e,signal:t})=>{const n=e.some((({id:e})=>void 0===e))?{namespace_types:e.map((({namespaceType:e})=>e)).join(",")}:{ids:e.map((({id:e})=>e)).join(","),list_ids:e.map((({listId:e})=>e)).join(","),namespace_types:e.map((({namespaceType:e})=>e)).join(",")};return b.b.get().http.fetch(g,{method:"GET",query:n,signal:t})},N=async({ruleId:e,items:t,signal:n})=>b.b.get().http.fetch(`${i.pb}/${e}/exceptions`,{method:"POST",body:JSON.stringify({items:t}),signal:n})},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return s}));var a=n(110);const i="policy:",r=`${i}all`,o=[a.m,a.e,a.h,a.b],s=["name","description","entries.value","entries.entries.value","item_id"]},,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return r})),n.d(t,"e",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return l}));var a=n(276);function i(e){return null!=e&&e.id?String(Object(a.a)(e.id)):void 0}function r(e){return null!=e&&e.parent?String(Object(a.a)(null==e?void 0:e.parent)):void 0}function o(e){const t=s(e);if(void 0===t)return;const n=new Date(t);return isFinite(n.getTime())?n:void 0}function s(e){return Object(a.a)(null==e?void 0:e.data["@timestamp"])}function l(e){return null!=e&&e.name?String(Object(a.a)(e.name)):void 0}},,,,,function(e,t,n){"use strict";n.d(t,"g",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"e",(function(){return p})),n.d(t,"i",(function(){return m})),n.d(t,"b",(function(){return g})),n.d(t,"c",(function(){return f})),n.d(t,"j",(function(){return b})),n.d(t,"d",(function(){return y})),n.d(t,"h",(function(){return h})),n.d(t,"f",(function(){return v}));var a=n(7),i=n(108),r=n(90);const o=e=>e.policy,s=e=>e.timerange,l=e=>e.queries,c=(e,t)=>{const n=e.inputs[t];return Object(a.isEmpty)(n.linkTo)?n.queries:n.linkTo.reduce(((t,n)=>{if(n===r.a.socTrends)return t;const a=e.inputs[n];return[...t,...a.queries]}),n.queries)},u=()=>Object(i.createSelector)(o,(e=>e.kind)),d=()=>Object(i.createSelector)(o,(e=>e.duration)),p=()=>Object(i.createSelector)(s,(e=>e.kind)),m=()=>Object(i.createSelector)(s,(e=>e.from)),g=()=>Object(i.createSelector)(s,(e=>e.to)),f=()=>Object(i.createSelector)(s,(e=>e.fromStr)),b=()=>Object(i.createSelector)(s,(e=>e.toStr)),y=()=>Object(i.createSelector)(l,(e=>e.some((e=>!0===e.loading)))),h=()=>Object(i.createSelector)(c,(e=>e.filter((e=>"kql"!==e.id)))),v=()=>Object(i.createSelector)(l,(e=>e.find((e=>"kql"===e.id))))},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(34),i=n(4),r=n.n(i),o=n(106),s=n(916);const l=r.a.memo((({dataProvider:e})=>{var t;const[n,l]=Object(i.useState)(!1);return r.a.createElement(s.a,{deleteProvider:a.noop,field:e.queryMatch.displayField||e.queryMatch.field,kqlQuery:e.kqlQuery,isEnabled:e.enabled,isExcluded:e.excluded,providerId:e.id,isPopoverOpen:n,setIsPopoverOpen:l,toggleExcludedProvider:a.noop,toggleEnabledProvider:a.noop,toggleTypeProvider:a.noop,displayValue:String(null!==(t=e.queryMatch.displayValue)&&void 0!==t?t:e.queryMatch.value),val:e.queryMatch.value,operator:e.queryMatch.operator||o.d,type:e.type||o.a.default})}));l.displayName="Provider"},function(e,t,n){"use strict";n.d(t,"i",(function(){return i})),n.d(t,"m",(function(){return r})),n.d(t,"g",(function(){return o})),n.d(t,"o",(function(){return s})),n.d(t,"k",(function(){return l})),n.d(t,"j",(function(){return c})),n.d(t,"a",(function(){return u})),n.d(t,"n",(function(){return d})),n.d(t,"l",(function(){return p})),n.d(t,"e",(function(){return m})),n.d(t,"p",(function(){return g})),n.d(t,"c",(function(){return f})),n.d(t,"b",(function(){return b})),n.d(t,"d",(function(){return y})),n.d(t,"h",(function(){return h})),n.d(t,"f",(function(){return v}));var a=n(276);function i(e){return"endgame"in e&&void 0!==e.endgame}function r(e){return Object(a.a)(null==e?void 0:e["@timestamp"])}function o(e){return Object(a.a)(e["@timestamp"])}function s(e){var t;if(!i(e))return Object(a.a)(null===(t=e.user)||void 0===t?void 0:t.name)}function l(e){var t,n;return Object(a.a)(i(e)?e.endgame.ppid:null===(t=e.process)||void 0===t||null===(n=t.parent)||void 0===n?void 0:n.pid)}function c(e){var t,n;return Object(a.a)(i(e)||null===(t=e.process)||void 0===t||null===(n=t.hash)||void 0===n?void 0:n.md5)}function u(e){var t;if(!i(e))return Object(a.c)(null===(t=e.process)||void 0===t?void 0:t.args)}function d(e){var t;if(!i(e))return Object(a.a)(null===(t=e.user)||void 0===t?void 0:t.domain)}function p(e){return i(e)?Object(a.a)(e.endgame.process_name):Object(a.a)(null===(t=e.process)||void 0===t?void 0:t.name);var t}function m(e){var t,n;return i(e)?Object(a.a)(null===(t=e.endgame)||void 0===t?void 0:t.serial_event_id):Object(a.a)(null===(n=e.event)||void 0===n?void 0:n.id)}function g(e){var t;return Object(a.a)(null===(t=e.winlog)||void 0===t?void 0:t.record_id)}function f(e){var t;return i(e)?e.endgame.unique_pid?String(e.endgame.unique_pid):"":Object(a.a)(null===(t=e.process)||void 0===t?void 0:t.entity_id)}function b(e){var t,n;return i(e)?void 0===(null===(t=e.endgame)||void 0===t?void 0:t.unique_pid)?void 0:String(Object(a.a)(e.endgame.unique_pid)):Object(a.a)(null===(n=e.process)||void 0===n?void 0:n.entity_id)}function y(e){var t;return Object(a.c)(i(e)?e.endgame.event_type_full:null===(t=e.event)||void 0===t?void 0:t.category)}function h(e){var t;return Object(a.c)(i(e)?e.endgame.event_subtype_full:null===(t=e.event)||void 0===t?void 0:t.type)}function v(e){return i(e)?[]:Object(a.c)(null===(t=e.event)||void 0===t?void 0:t.kind);var t}},function(e,t,n){const a=n(125);e.exports=(e,t,n)=>new a(e,n).compare(new a(t,n))},function(e,t,n){"use strict";n.d(t,"e",(function(){return g})),n.d(t,"d",(function(){return f})),n.d(t,"h",(function(){return b})),n.d(t,"j",(function(){return y})),n.d(t,"n",(function(){return h})),n.d(t,"l",(function(){return v})),n.d(t,"a",(function(){return j})),n.d(t,"o",(function(){return O})),n.d(t,"b",(function(){return I})),n.d(t,"k",(function(){return T})),n.d(t,"f",(function(){return C})),n.d(t,"g",(function(){return M})),n.d(t,"m",(function(){return N})),n.d(t,"c",(function(){return D})),n.d(t,"i",(function(){return F}));var a=n(34),i=n(271),r=n.n(i),o=n(37),s=n(209),l=n(405),c=n(522),u=n(105);const d=(e,t)=>void 0===e||e===t||0===e,p=(e,t={})=>`${e}${Object(s.a)(r.a.stringify(((e={})=>({...d(e.page,1)?{}:{page:e.page},...d(e.pageSize,u.c)?{}:{pageSize:e.pageSize},...d(e.show,void 0)?{}:{show:e.show},...d(e.itemId,void 0)?{}:{itemId:e.itemId},...d(e.filter,"")?"":{filter:e.filter},...d(e.includedPolicies,"")?"":{includedPolicies:e.includedPolicies}}))(t)))}`,m=e=>r.a.stringify(e),g=(e,t)=>{const{name:n,...i}=e,r=m(i),l=`${r&&!Object(a.isEmpty)(t)?"&":""}${null!=t?t:""}`;return"endpointList"===n?`${Object(o.generatePath)(u.h,{tabName:c.a.endpoints})}${Object(s.a)(`${r?`${r}${l}`:l}`)}`:`${Object(s.a)(`${r?`${r}${l}`:l}`)}`},f=(e,t)=>{const{name:n,show:i,...r}=e,l={...r};switch(e.name){case"endpointDetails":l.show="details";break;case"endpointIsolate":l.show="isolate";break;case"endpointUnIsolate":l.show="unisolate";break;case"endpointPolicyResponse":l.show="policy_response";break;case"endpointActivityLog":l.show="activity_log"}const d=m(l),p=`${d&&!Object(a.isEmpty)(t)?"&":""}${null!=t?t:""}`;return`${Object(o.generatePath)(u.h,{tabName:c.a.endpoints})}${Object(s.a)(`${d?`${d}${p}`:p}`)}`},b=e=>`${Object(o.generatePath)(u.k,{tabName:c.a.policies})}${Object(s.a)(e)}`,y=(e,t)=>`${Object(o.generatePath)(u.n,{tabName:c.a.policies,policyId:e})}${Object(s.a)(t)}`,h=(e,t)=>`${Object(o.generatePath)(u.q,{tabName:c.a.policies,policyId:e})}${Object(s.a)(t)}`,v=(e,t)=>`${Object(o.generatePath)(u.m,{tabName:c.a.policies,policyId:e})}${Object(s.a)(r.a.stringify(E(t)))}`,E=e=>e?{...d(e.page,u.b+1)?{}:{page:e.page},...d(e.pageSize,u.c)?{}:{pageSize:e.pageSize},...d(e.show,void 0)?{}:{show:e.show},...d(e.filter,"")?"":{filter:e.filter}}:{},x=(e,t)=>{const n=e[t];return Array.isArray(n)?n[n.length-1]:n},k=e=>{const t=Number(x(e,"page_index"));return!Number.isFinite(t)||t<0?u.b:t},S=e=>{const t=Number(x(e,"page_size"));return u.f.includes(t)?t:u.c},w=e=>x(e,"filter")||"",j=e=>({page_index:k(e),page_size:S(e),filter:w(e)}),O=e=>{const t=Object(o.generatePath)(u.s,{tabName:c.a.trustedApps});return p(t,e)},I=e=>{const t=x(e,"show"),n=Object(l.a)(e);return{page:n.page,pageSize:n.pageSize,filter:e.filter,show:t&&"list"===t?t:void 0}},T=(e,t)=>`${Object(o.generatePath)(u.q,{tabName:c.a.policies,policyId:e})}${Object(s.a)(r.a.stringify(E(t)))}`,C=e=>`${Object(o.generatePath)(u.i,{tabName:c.a.eventFilters})}${Object(s.a)(r.a.stringify((e=>e?{...d(e.page_index,u.b)?{}:{page_index:e.page_index},...d(e.page_size,u.c)?{}:{page_size:e.page_size},...d(e.show,void 0)?{}:{show:e.show},...d(e.id,void 0)?{}:{id:e.id},...d(e.filter,"")?"":{filter:e.filter},...d(e.included_policies,"")?"":{included_policies:e.included_policies}}:{})(e)))}`,M=e=>{const t=Object(o.generatePath)(u.j,{tabName:c.a.hostIsolationExceptions});return p(t,e)},N=(e,t)=>`${Object(o.generatePath)(u.o,{tabName:c.a.policies,policyId:e})}${Object(s.a)(r.a.stringify(E(t)))}`,D=e=>{const t=Object(o.generatePath)(u.g,{tabName:c.a.blocklist});return p(t,e)},F=(e,t)=>`${Object(o.generatePath)(u.l,{tabName:c.a.policies,policyId:e})}${Object(s.a)(r.a.stringify(E(t)))}`},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(4),i=n(77);const r={managed:!0},o=()=>{const{services:{apm:e}}=Object(i.k)();return{startTransaction:Object(a.useCallback)((({name:t,type:n="user-interaction",options:a})=>e.startTransaction(t,n,null!=a?a:r)),[e])}}},,,function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return l})),n.d(t,"d",(function(){return c}));const a=["started","opened"],i=["starting","stopping","opening","closing"],r=["deleted","failed"],o=(e,t)=>a.includes(e)&&a.includes(t),s=(e,t)=>i.includes(e)||i.includes(t),l=(e,t)=>r.includes(e)||r.includes(t),c=e=>"machine_learning"===e},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(4),i=n(37),r=n(92),o=n.n(r),s=n(183);const l=Object(a.memo)((({location:{pathname:e,search:t},history:n,match:{params:{detailName:i,tabName:r,flowTarget:l}},pageName:c,state:u})=>{const[d,p]=Object(a.useState)(!0),[m,g]=Object(s.a)();return Object(a.useEffect)((()=>{d&&""!==t?(g({type:"updateSearch",search:t}),p(!1)):""!==t&&t!==m.search&&g({type:"updateSearch",search:t})}),[t]),Object(a.useEffect)((()=>{c&&!o()(m.pathName,e)?d&&null==i?(g({type:"updateRouteWithOutSearch",route:{detailName:i,flowTarget:l,history:n,pageName:c,pathName:e,state:u,tabName:r}}),p(!1)):g({type:"updateRoute",route:{detailName:i,flowTarget:l,history:n,pageName:c,pathName:e,search:t,state:u,tabName:r}}):c&&!o()(u,m.state)&&g({type:"updateRoute",route:{detailName:i,flowTarget:l,history:n,pageName:c,pathName:e,search:t,state:u,tabName:r}})}),[e,t,c,i,r,l,u]),null}));l.displayName="SpyRouteComponent";const c=Object(i.withRouter)(l)},function(e,t,n){"use strict";function a(e,t){return[e[0]+t[0],e[1]+t[1]]}function i(e,t){return[e[0]-t[0],e[1]-t[1]]}function r(e,t){return[e[0]/t[0],e[1]/t[1]]}function o(e,t){return[e[0]*t[0],e[1]*t[1]]}function s([e,t],[n,a,i,r,o,s]){return[e*n+t*a+i,e*r+t*o+s]}function l([e,t],[n,a]){return e===n&&t===a}function c(e,t){const[n,a]=e,[i,r]=t;return Math.sqrt(Math.pow(i-n,2)+Math.pow(r-a,2))}function u(e,t){const n=t[0]-e[0],a=t[1]-e[1];return Math.atan2(a,n)}function d(e,t){return[e[0]*t,e[1]*t]}function p(e,t,n){return a(d(e,1-n),d(t,n))}n.d(t,"a",(function(){return a})),n.d(t,"j",(function(){return i})),n.d(t,"e",(function(){return r})),n.d(t,"h",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"f",(function(){return l})),n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"i",(function(){return d})),n.d(t,"g",(function(){return p}))},function(e,t,n){class Range{constructor(e,t){if(t=i(t),e instanceof Range)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new Range(e.raw,t);if(e instanceof r)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split("||").map((e=>this.parseRange(e.trim()))).filter((e=>e.length)),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${e}`);if(this.set.length>1){const e=this.set[0];if(this.set=this.set.filter((e=>!m(e[0]))),0===this.set.length)this.set=[e];else if(this.set.length>1)for(const e of this.set)if(1===e.length&&g(e[0])){this.set=[e];break}}this.format()}format(){return this.range=this.set.map((e=>e.join(" ").trim())).join("||").trim(),this.range}toString(){return this.range}parseRange(e){e=e.trim();const t=`parseRange:${Object.keys(this.options).join(",")}:${e}`,n=a.get(t);if(n)return n;const i=this.options.loose,s=i?l[c.HYPHENRANGELOOSE]:l[c.HYPHENRANGE];e=e.replace(s,O(this.options.includePrerelease)),o("hyphen replace",e),e=e.replace(l[c.COMPARATORTRIM],u),o("comparator trim",e);let g=(e=(e=(e=e.replace(l[c.TILDETRIM],d)).replace(l[c.CARETTRIM],p)).split(/\s+/).join(" ")).split(" ").map((e=>b(e,this.options))).join(" ").split(/\s+/).map((e=>j(e,this.options)));i&&(g=g.filter((e=>(o("loose invalid filter",e,this.options),!!e.match(l[c.COMPARATORLOOSE]))))),o("range list",g);const f=new Map,y=g.map((e=>new r(e,this.options)));for(const e of y){if(m(e))return[e];f.set(e.value,e)}f.size>1&&f.has("")&&f.delete("");const h=[...f.values()];return a.set(t,h),h}intersects(e,t){if(!(e instanceof Range))throw new TypeError("a Range is required");return this.set.some((n=>f(n,t)&&e.set.some((e=>f(e,t)&&n.every((n=>e.every((e=>n.intersects(e,t)))))))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new s(e,this.options)}catch(e){return!1}for(let t=0;t<this.set.length;t++)if(I(this.set[t],e,this.options))return!0;return!1}}e.exports=Range;const a=new(n(982))({max:1e3}),i=n(322),r=n(364),o=n(307),s=n(125),{re:l,t:c,comparatorTrimReplace:u,tildeTrimReplace:d,caretTrimReplace:p}=n(235),m=e=>"<0.0.0-0"===e.value,g=e=>""===e.value,f=(e,t)=>{let n=!0;const a=e.slice();let i=a.pop();for(;n&&a.length;)n=a.every((e=>i.intersects(e,t))),i=a.pop();return n},b=(e,t)=>(o("comp",e,t),e=E(e,t),o("caret",e),e=h(e,t),o("tildes",e),e=k(e,t),o("xrange",e),e=w(e,t),o("stars",e),e),y=e=>!e||"x"===e.toLowerCase()||"*"===e,h=(e,t)=>e.trim().split(/\s+/).map((e=>v(e,t))).join(" "),v=(e,t)=>{const n=t.loose?l[c.TILDELOOSE]:l[c.TILDE];return e.replace(n,((t,n,a,i,r)=>{let s;return o("tilde",e,t,n,a,i,r),y(n)?s="":y(a)?s=`>=${n}.0.0 <${+n+1}.0.0-0`:y(i)?s=`>=${n}.${a}.0 <${n}.${+a+1}.0-0`:r?(o("replaceTilde pr",r),s=`>=${n}.${a}.${i}-${r} <${n}.${+a+1}.0-0`):s=`>=${n}.${a}.${i} <${n}.${+a+1}.0-0`,o("tilde return",s),s}))},E=(e,t)=>e.trim().split(/\s+/).map((e=>x(e,t))).join(" "),x=(e,t)=>{o("caret",e,t);const n=t.loose?l[c.CARETLOOSE]:l[c.CARET],a=t.includePrerelease?"-0":"";return e.replace(n,((t,n,i,r,s)=>{let l;return o("caret",e,t,n,i,r,s),y(n)?l="":y(i)?l=`>=${n}.0.0${a} <${+n+1}.0.0-0`:y(r)?l="0"===n?`>=${n}.${i}.0${a} <${n}.${+i+1}.0-0`:`>=${n}.${i}.0${a} <${+n+1}.0.0-0`:s?(o("replaceCaret pr",s),l="0"===n?"0"===i?`>=${n}.${i}.${r}-${s} <${n}.${i}.${+r+1}-0`:`>=${n}.${i}.${r}-${s} <${n}.${+i+1}.0-0`:`>=${n}.${i}.${r}-${s} <${+n+1}.0.0-0`):(o("no pr"),l="0"===n?"0"===i?`>=${n}.${i}.${r}${a} <${n}.${i}.${+r+1}-0`:`>=${n}.${i}.${r}${a} <${n}.${+i+1}.0-0`:`>=${n}.${i}.${r} <${+n+1}.0.0-0`),o("caret return",l),l}))},k=(e,t)=>(o("replaceXRanges",e,t),e.split(/\s+/).map((e=>S(e,t))).join(" ")),S=(e,t)=>{e=e.trim();const n=t.loose?l[c.XRANGELOOSE]:l[c.XRANGE];return e.replace(n,((n,a,i,r,s,l)=>{o("xRange",e,n,a,i,r,s,l);const c=y(i),u=c||y(r),d=u||y(s),p=d;return"="===a&&p&&(a=""),l=t.includePrerelease?"-0":"",c?n=">"===a||"<"===a?"<0.0.0-0":"*":a&&p?(u&&(r=0),s=0,">"===a?(a=">=",u?(i=+i+1,r=0,s=0):(r=+r+1,s=0)):"<="===a&&(a="<",u?i=+i+1:r=+r+1),"<"===a&&(l="-0"),n=`${a+i}.${r}.${s}${l}`):u?n=`>=${i}.0.0${l} <${+i+1}.0.0-0`:d&&(n=`>=${i}.${r}.0${l} <${i}.${+r+1}.0-0`),o("xRange return",n),n}))},w=(e,t)=>(o("replaceStars",e,t),e.trim().replace(l[c.STAR],"")),j=(e,t)=>(o("replaceGTE0",e,t),e.trim().replace(l[t.includePrerelease?c.GTE0PRE:c.GTE0],"")),O=e=>(t,n,a,i,r,o,s,l,c,u,d,p,m)=>`${n=y(a)?"":y(i)?`>=${a}.0.0${e?"-0":""}`:y(r)?`>=${a}.${i}.0${e?"-0":""}`:o?`>=${n}`:`>=${n}${e?"-0":""}`} ${l=y(c)?"":y(u)?`<${+c+1}.0.0-0`:y(d)?`<${c}.${+u+1}.0-0`:p?`<=${c}.${u}.${d}-${p}`:e?`<${c}.${u}.${+d+1}-0`:`<=${l}`}`.trim(),I=(e,t,n)=>{for(let n=0;n<e.length;n++)if(!e[n].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(let n=0;n<e.length;n++)if(o(e[n].semver),e[n].semver!==r.ANY&&e[n].semver.prerelease.length>0){const a=e[n].semver;if(a.major===t.major&&a.minor===t.minor&&a.patch===t.patch)return!0}return!1}return!0}},,function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return p})),n.d(t,"c",(function(){return m}));var a=n(34),i=n(4),r=n.n(i),o=n(217),s=n(230);const l={canUserCRUD:null,canUserREAD:null,hasIndexManage:null,hasIndexMaintenance:null,hasIndexWrite:null,hasIndexRead:null,hasIndexUpdateDelete:null,isSignalIndexExists:null,isAuthenticated:null,hasEncryptionKey:null,loading:!0,signalIndexName:null,signalIndexMappingOutdated:null},c=(e,t)=>{switch(t.type){case"updateLoading":return{...e,loading:t.loading};case"updateHasIndexManage":return{...e,hasIndexManage:t.hasIndexManage};case"updateHasIndexMaintenance":return{...e,hasIndexMaintenance:t.hasIndexMaintenance};case"updateHasIndexWrite":return{...e,hasIndexWrite:t.hasIndexWrite};case"updateHasIndexRead":return{...e,hasIndexRead:t.hasIndexRead};case"updateHasIndexUpdateDelete":return{...e,hasIndexUpdateDelete:t.hasIndexUpdateDelete};case"updateIsSignalIndexExists":return{...e,isSignalIndexExists:t.isSignalIndexExists};case"updateIsAuthenticated":return{...e,isAuthenticated:t.isAuthenticated};case"updateHasEncryptionKey":return{...e,hasEncryptionKey:t.hasEncryptionKey};case"updateSignalIndexName":return{...e,signalIndexName:t.signalIndexName};case"updateSignalIndexMappingOutdated":return{...e,signalIndexMappingOutdated:t.signalIndexMappingOutdated};case"updateCanUserCRUD":return{...e,canUserCRUD:t.canUserCRUD};case"updateCanUserREAD":return{...e,canUserREAD:t.canUserREAD};default:return e}},u=Object(i.createContext)([l,()=>a.noop]),d=()=>Object(i.useContext)(u),p=({children:e})=>r.a.createElement(u.Provider,{value:Object(i.useReducer)(c,l)},e),m=()=>{const[{canUserCRUD:e,canUserREAD:t,hasIndexManage:n,hasIndexMaintenance:a,hasIndexWrite:r,hasIndexRead:l,hasIndexUpdateDelete:c,isSignalIndexExists:u,isAuthenticated:p,hasEncryptionKey:m,loading:g,signalIndexName:f,signalIndexMappingOutdated:b},y]=d(),{loading:h,isAuthenticated:v,hasEncryptionKey:E,hasIndexManage:x,hasIndexMaintenance:k,hasIndexUpdateDelete:S,hasIndexWrite:w,hasIndexRead:j,hasKibanaCRUD:O,hasKibanaREAD:I}=Object(o.a)(),{loading:T,signalIndexExists:C,signalIndexName:M,signalIndexMappingOutdated:N,createDeSignalIndex:D}=Object(s.a)();return Object(i.useEffect)((()=>{g||e===O||y({type:"updateCanUserCRUD",canUserCRUD:O})}),[y,g,e,O]),Object(i.useEffect)((()=>{g||t===I||y({type:"updateCanUserREAD",canUserREAD:I})}),[y,g,t,I]),Object(i.useEffect)((()=>{g!==(h||T)&&y({type:"updateLoading",loading:h||T})}),[y,g,h,T]),Object(i.useEffect)((()=>{g||n===x||null==x||y({type:"updateHasIndexManage",hasIndexManage:x})}),[y,g,n,x]),Object(i.useEffect)((()=>{g||r===w||null==w||y({type:"updateHasIndexWrite",hasIndexWrite:w})}),[y,g,r,w]),Object(i.useEffect)((()=>{g||l===j||null==j||y({type:"updateHasIndexRead",hasIndexRead:j})}),[y,g,l,j]),Object(i.useEffect)((()=>{g||c===S||null==S||y({type:"updateHasIndexUpdateDelete",hasIndexUpdateDelete:S})}),[y,g,c,S]),Object(i.useEffect)((()=>{g||a===k||null==k||y({type:"updateHasIndexMaintenance",hasIndexMaintenance:k})}),[y,g,a,k]),Object(i.useEffect)((()=>{g||u===C||null==C||y({type:"updateIsSignalIndexExists",isSignalIndexExists:C})}),[y,g,u,C]),Object(i.useEffect)((()=>{g||p===v||null==v||y({type:"updateIsAuthenticated",isAuthenticated:v})}),[y,g,p,v]),Object(i.useEffect)((()=>{g||m===E||null==E||y({type:"updateHasEncryptionKey",hasEncryptionKey:E})}),[y,g,m,E]),Object(i.useEffect)((()=>{g||f===M||null==M||y({type:"updateSignalIndexName",signalIndexName:M})}),[y,g,f,M]),Object(i.useEffect)((()=>{g||b===N||null==N||y({type:"updateSignalIndexMappingOutdated",signalIndexMappingOutdated:N})}),[y,g,b,N]),Object(i.useEffect)((()=>{p&&m&&n&&(null!=u&&!u||null!=b&&b)&&null!=D&&D()}),[D,p,m,u,n,b]),{loading:g,isSignalIndexExists:u,isAuthenticated:p,hasEncryptionKey:m,canUserCRUD:e,canUserREAD:t,hasIndexManage:n,hasIndexMaintenance:a,hasIndexWrite:r,hasIndexRead:l,hasIndexUpdateDelete:c,signalIndexName:f,signalIndexMappingOutdated:b}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"g",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return l})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"h",(function(){return d}));var a=n(7);n(245);const i=e=>{if(null!=e){const t=e.trim().split(/[ \t\r\n]+/);return"sequence"===t[0]&&"where"!==t[1]}return!1},r=e=>"eql"===e,o=e=>"threshold"===e,s=e=>"query"===e||"saved_query"===e,l=e=>"threat_match"===e,c=e=>"machine_learning"===e,u=e=>"new_terms"===e,d=e=>Array.isArray(e)?e:Object(a.isEmpty)(e)?[]:[e]},function(e,t,n){"use strict";let a,i;n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i})),function(e){e.defineRule="define-rule",e.aboutRule="about-rule",e.scheduleRule="schedule-rule",e.ruleActions="rule-actions"}(a||(a={})),function(e){e.IndexPatterns="indexPatterns",e.DataView="dataView"}(i||(i={}))},function(e,t,n){"use strict";n.d(t,"x",(function(){return i})),n.d(t,"u",(function(){return r})),n.d(t,"w",(function(){return o})),n.d(t,"v",(function(){return s})),n.d(t,"t",(function(){return l})),n.d(t,"s",(function(){return c})),n.d(t,"n",(function(){return u})),n.d(t,"m",(function(){return d})),n.d(t,"r",(function(){return p})),n.d(t,"q",(function(){return m})),n.d(t,"y",(function(){return g})),n.d(t,"J",(function(){return f})),n.d(t,"M",(function(){return b})),n.d(t,"L",(function(){return y})),n.d(t,"K",(function(){return h})),n.d(t,"j",(function(){return v})),n.d(t,"C",(function(){return E})),n.d(t,"A",(function(){return x})),n.d(t,"B",(function(){return k})),n.d(t,"p",(function(){return S})),n.d(t,"T",(function(){return w.G})),n.d(t,"l",(function(){return w.o})),n.d(t,"o",(function(){return w.q})),n.d(t,"ab",(function(){return w.O})),n.d(t,"Q",(function(){return w.D})),n.d(t,"Z",(function(){return w.N})),n.d(t,"O",(function(){return w.B})),n.d(t,"P",(function(){return w.C})),n.d(t,"cb",(function(){return w.Q})),n.d(t,"z",(function(){return w.s})),n.d(t,"R",(function(){return w.E})),n.d(t,"W",(function(){return w.K})),n.d(t,"db",(function(){return w.R})),n.d(t,"Y",(function(){return w.M})),n.d(t,"X",(function(){return w.L})),n.d(t,"F",(function(){return w.w})),n.d(t,"E",(function(){return w.u})),n.d(t,"H",(function(){return w.y})),n.d(t,"G",(function(){return w.x})),n.d(t,"D",(function(){return w.t})),n.d(t,"N",(function(){return w.A})),n.d(t,"a",(function(){return w.b})),n.d(t,"I",(function(){return w.z})),n.d(t,"S",(function(){return w.F})),n.d(t,"b",(function(){return w.c})),n.d(t,"i",(function(){return w.l})),n.d(t,"k",(function(){return w.n})),n.d(t,"h",(function(){return w.k})),n.d(t,"f",(function(){return w.i})),n.d(t,"g",(function(){return w.j})),n.d(t,"d",(function(){return w.g})),n.d(t,"e",(function(){return w.h})),n.d(t,"c",(function(){return w.d})),n.d(t,"bb",(function(){return w.P})),n.d(t,"V",(function(){return w.J})),n.d(t,"U",(function(){return w.H}));var a=n(0);const i=a.i18n.translate("xpack.securitySolution.exception.list.empty.viewer_title",{defaultMessage:"Create exceptions to this list"}),r=e=>a.i18n.translate("xpack.securitySolution.exception.list.empty.viewer_body",{values:{listName:e},defaultMessage:"There is no exception in your [{listName}]. Create rule exceptions to this list."}),o=a.i18n.translate("xpack.securitySolution.exception.list.empty.viewer_button_endpoint",{defaultMessage:"Create endpoint exception"}),s=a.i18n.translate("xpack.securitySolution.exception.list.empty.viewer_button",{defaultMessage:"Create rule exception"}),l=a.i18n.translate("xpack.securitySolution.exception.list.search_bar_button_enpoint",{defaultMessage:"Add endpoint exception to list"}),c=a.i18n.translate("xpack.securitySolution.exception.list.search_bar_button",{defaultMessage:"Add rule exception to list"}),u=(a.i18n.translate("xpack.securitySolution.exceptions.list.exceptionItemSearchErrorTitle",{defaultMessage:"Error searching"}),a.i18n.translate("xpack.securitySolution.exceptions.list.exceptionItemSearchErrorBody",{defaultMessage:"An error occurred searching for exception items. Please try again."}),a.i18n.translate("xpack.securitySolution.exceptions.list.exceptionItemsFetchError",{defaultMessage:"Unable to load exception items"})),d=a.i18n.translate("xpack.securitySolution.exceptions.list.exceptionItemsFetchErrorDescription",{defaultMessage:"There was an error loading the exception items. Contact your administrator for help."}),p=a.i18n.translate("xpack.securitySolution.exceptions.list.exception.item.card.exceptionItemDeleteSuccessTitle",{defaultMessage:"Exception deleted"}),m=e=>a.i18n.translate("xpack.securitySolution.exceptions.list.exception.item.card.exceptionItemDeleteSuccessText",{values:{itemName:e},defaultMessage:'"{itemName}" deleted successfully.'}),g=e=>a.i18n.translate("xpack.securitySolution.exceptions.list.exported_successfully",{values:{listName:e},defaultMessage:"{listName} exported successfully"}),f=a.i18n.translate("xpack.securitySolution.exceptions.list.manage_rules_cancel",{defaultMessage:"Cancel"}),b=a.i18n.translate("xpack.securitySolution.exceptions.list.manage_rules_save",{defaultMessage:"Save"}),y=a.i18n.translate("xpack.securitySolution.exceptions.list.manage_rules_header",{defaultMessage:"Manage rules"}),h=a.i18n.translate("xpack.securitySolution.exceptions.list.manage_rules_description",{defaultMessage:"Link or unlink rules to this exception list."}),v=a.i18n.translate("xpack.securitySolution.exceptionsTable.deleteExceptionList",{defaultMessage:"Delete exception list"}),E=a.i18n.translate("xpack.securitySolution.exceptionsTable.exportExceptionList",{defaultMessage:"Export exception list"}),x=a.i18n.translate("xpack.securitySolution.exceptionsTable.manageRulesError",{defaultMessage:"Manage rules error"}),k=a.i18n.translate("xpack.securitySolution.exceptionsTable.manageRulesErrorDescription",{defaultMessage:"An error occurred linking or unlinking rules"}),S=a.i18n.translate("xpack.securitySolution.exceptionsTable.exportListDescription",{defaultMessage:"An error occurred exporting a list"});n(481);var w=n(564)},,function(e,t,n){"use strict";n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return m}));var a=n(4),i=n(37),r=n(78),o=n(110),s=n(105),l=n(153),c=n(178),u=n(1);function d(e){return Object(r.useSelector)((t=>e(t[s.u][s.v])))}function p(e){const t=d(c.c),n=Object(i.useHistory)(),r=d(c.o),s=Object(a.useCallback)((n=>e===o.m?Object(l.k)(r,{...t,...n}):e===o.e?Object(l.l)(r,{...t,...n}):e===o.b?Object(l.i)(r,{...t,...n}):Object(l.m)(r,{...t,...n})),[e,t,r]);return Object(a.useCallback)((e=>n.push(s(e))),[s,n])}const m=()=>window.location.pathname.includes(u.bc)&&window.location.pathname.includes("/settings")},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=e=>e.capabilities.canGetJobs&&e.capabilities.canGetDatafeeds&&e.capabilities.canGetCalendars},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return v}));var a=n(34),i=n(294),r=n.n(i),o=n(4),s=n(53),l=n.n(s),c=n(11),u=n(42),d=n(77),p=n(431),m=n(84),g=n(285);const f=e=>Object(a.keyBy)("name",function(e){const t=[];for(const n of Object.values(e))n.fields&&t.push(...Object.values(n.fields));return t}(e)),b=r()(((e,t)=>t&&t.length>0?{fields:t.map((e=>Object(a.pick)(["name","searchable","type","aggregatable","esTypes","subType"],e))),title:e}:{fields:[],title:e}),((e,t)=>e[0]===t[0]&&e[1].length===t[1].length)),y=(r()(((e,t)=>t.reduce(((e,t)=>(null==e[t.category]&&(e[t.category]={}),null==e[t.category].fields&&(e[t.category].fields={}),e[t.category].fields[t.name]=t,e)),{})),((e,t)=>e[0]===t[0]&&e[1].length===t[1].length)),{}),h={fields:[],title:""},v=(e,t=!1)=>{const{data:n}=Object(d.k)().services,i=Object(o.useRef)(new AbortController),r=Object(o.useRef)(new c.Subscription),s=Object(o.useRef)([]),[f,v]=Object(o.useState)(!1),[E,x]=Object(o.useState)({browserFields:y,indexes:e,indexExists:!0,indexPatterns:h}),{addError:k,addWarning:S}=Object(m.a)(),w=Object(o.useCallback)((e=>{r.current.unsubscribe(),i.current.abort(),(async()=>{i.current=new AbortController,v(!0),r.current=n.search.search({indices:e,onlyCheckIfIndicesExist:t},{abortSignal:i.current.signal,strategy:"indexFields"}).subscribe({next:e=>{Object(u.isCompleteResponse)(e)?Promise.resolve().then((()=>{l.a.unstable_batchedUpdates((()=>{const t=e.indicesExist.sort().join();s.current=e.indicesExist;const{browserFields:n}=Object(g.a)(t,e.indexFields);v(!1),x({browserFields:n,indexes:e.indicesExist,indexExists:e.indicesExist.length>0,indexPatterns:b(t,e.indexFields)}),r.current.unsubscribe()}))})):Object(u.isErrorResponse)(e)&&(v(!1),S(p.a),r.current.unsubscribe())},error:e=>{v(!1),k(e,{title:p.b}),r.current.unsubscribe()}})})()}),[n.search,k,S,t,v,x]);return Object(o.useEffect)((()=>(Object(a.isEmpty)(e)||Object(a.isEqual)(s.current,e)||w(e),()=>{r.current.unsubscribe(),i.current.abort()})),[e,w,s]),[f,E]}},function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"f",(function(){return i})),n.d(t,"n",(function(){return r})),n.d(t,"g",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"h",(function(){return l})),n.d(t,"c",(function(){return c})),n.d(t,"k",(function(){return u})),n.d(t,"j",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"l",(function(){return m})),n.d(t,"m",(function(){return g})),n.d(t,"a",(function(){return f})),n.d(t,"i",(function(){return b}));const a="date",i="host.name",r="user.name",o="ip",s="geo_point",l="message",c="event.module",u="rule.reference",d="reference.url",p="event.url",m="kibana.alert.rule.name",g="kibana.alert.workflow_status",f="agent.status",b="kibana.alert.reason"},,function(e,t,n){"use strict";var a=n(399);n.d(t,"a",(function(){return a.a})),n.d(t,"b",(function(){return a.b})),n.d(t,"d",(function(){return a.d})),n.d(t,"e",(function(){return a.e})),n.d(t,"f",(function(){return a.f})),n.d(t,"l",(function(){return a.j})),n.d(t,"m",(function(){return a.k})),n.d(t,"n",(function(){return a.l})),n.d(t,"o",(function(){return a.m})),n.d(t,"p",(function(){return a.n}));var i=n(386);n.d(t,"c",(function(){return i.a})),n.d(t,"g",(function(){return i.b})),n.d(t,"h",(function(){return i.c})),n.d(t,"i",(function(){return i.d})),n.d(t,"j",(function(){return i.e})),n.d(t,"k",(function(){return i.f}))},function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return c}));var a=n(1);const i={ENABLE:`${a.B} singleRuleActions enable`,DISABLE:`${a.B} singleRuleActions disable`,DUPLICATE:`${a.B} singleRuleActions duplicate`,EXPORT:`${a.B} singleRuleActions export`,DELETE:`${a.B} singleRuleActions delete`,PREVIEW:`${a.B} singleRuleActions preview`,SAVE:`${a.B} singleRuleActions save`},r={ENABLE:`${a.B} bulkRuleActions enable`,DISABLE:`${a.B} bulkRuleActions disable`,DUPLICATE:`${a.B} bulkRuleActions duplicate`,EXPORT:`${a.B} bulkRuleActions export`,DELETE:`${a.B} bulkRuleActions delete`,EDIT:`${a.B} bulkRuleActions edit`},o={REFRESH:`${a.B} rulesTable refresh`,FILTER:`${a.B} rulesTable filter`,LOAD_PREBUILT:`${a.B} rulesTable loadPrebuilt`,PREVIEW_ON:`${a.B} rulesTable technicalPreview on`,PREVIEW_OFF:`${a.B} rulesTable technicalPreview off`},s={SAVE:`${a.B} timeline save`,DUPLICATE:`${a.B} timeline duplicate`,DELETE:`${a.B} timeline delete`,BULK_DELETE:`${a.B} timeline bulkDelete`},l={OPEN_ANALYZER:`${a.B} alerts openAnalyzer`,OPEN_SESSION_VIEW:`${a.B} alerts openSessionView`,INVESTIGATE_IN_TIMELINE:`${a.B} alerts investigateInTimeline`},c={FIELD_SAVED:`${a.B} fieldBrowser fieldSaved`,FIELD_DELETED:`${a.B} fieldBrowser fieldDeleted`}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(158);const i={defaultColumns:a.b,dataViewId:null,deletedEventIds:[],expandedDetail:{},filters:[],indexNames:[],isSelectAllChecked:!1,isLoading:!1,itemsPerPage:25,itemsPerPageOptions:[10,25,50,100],loadingEventIds:[],selectedEventIds:{},showCheckboxes:!1,sort:[{columnId:"@timestamp",columnType:"date",esTypes:["date"],sortDirection:"desc"}],selectAll:!1,graphEventId:"",sessionViewConfig:null,columns:a.b,queryFields:[],totalCount:0}},function(e,t,n){"use strict";n.d(t,"b",(function(){return y})),n.d(t,"c",(function(){return h})),n.d(t,"a",(function(){return w}));var a=n(4),i=n.n(a),r=n(35),o=n(32),s=n(33),l=n.n(s),c=n(133),u=n(102),d=n(87),p=n(160),m=n(106),g=n(150),f=n(221);const b=l.a.div.withConfig({displayName:"Subtext",componentId:"sc-1au6na0-0"})(["font-size:",";"],(e=>e.theme.eui.euiFontSizeXS)),y=({rowItem:e,attrName:t,idPrefix:n,fieldType:a,isAggregatable:r,render:o,dragDisplayValue:s})=>{if(null!=e){const l=Object(u.h)(`${n}-${t}-${e}`);return i.a.createElement(c.b,{key:l,dataProvider:{and:[],enabled:!0,id:l,name:e,excluded:!1,kqlQuery:"",queryMatch:{field:t,value:e,displayValue:s||e,operator:m.d}},fieldType:a,isAggregatable:r,render:(t,n,a)=>a.isDragging?i.a.createElement(c.a,null,i.a.createElement(g.a,{dataProvider:t})):i.a.createElement(i.a.Fragment,null,o?o(e):Object(d.a)(e))})}return Object(d.d)()},h=({rowItems:e,attrName:t,idPrefix:n,render:a,dragDisplayValue:r,fieldType:o="keyword",isAggregatable:s=!1,displayCount:l=5,maxOverflow:p=5})=>{if(null!=e&&e.length>0){const f=e.slice(0,l).map(((e,l)=>{const p=Object(u.h)(`${n}-${t}-${e}-${l}`);return i.a.createElement(i.a.Fragment,{key:p},i.a.createElement(c.b,{key:p,dataProvider:{and:[],enabled:!0,id:p,name:e,excluded:!1,kqlQuery:"",queryMatch:{field:t,value:e,displayValue:r||e,operator:m.d}},fieldType:o,isAggregatable:s,render:(t,n,r)=>r.isDragging?i.a.createElement(c.a,null,i.a.createElement(g.a,{dataProvider:t})):i.a.createElement(i.a.Fragment,null,a?a(e):Object(d.a)(e))}))}));return f.length>0?i.a.createElement(i.a.Fragment,null,f," ",i.a.createElement(E,{attrName:t,dragDisplayValue:r,idPrefix:n,maxOverflowItems:p,overflowIndexStart:l,rowItems:e,fieldType:o,isAggregatable:s})):Object(d.d)()}return Object(d.d)()},v=({attrName:e,dragDisplayValue:t,idPrefix:n,maxOverflowItems:a=5,overflowIndexStart:s=5,rowItems:l,fieldType:c,isAggregatable:u})=>i.a.createElement(i.a.Fragment,null,l.length>s&&i.a.createElement(k,{count:l.length-s,idPrefix:n},i.a.createElement(o.EuiText,{size:"xs"},i.a.createElement(f.c,{attrName:e,dragDisplayValue:t,idPrefix:n,overflowIndexStart:s,rowItems:l,moreMaxHeight:"none",fieldType:c,isAggregatable:u}),l.length>s+a&&i.a.createElement("p",{"data-test-subj":"popover-additional-overflow"},i.a.createElement(o.EuiTextColor,{color:"subdued"},l.length-s-a," ",i.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.tables.rowItemHelper.moreDescription",defaultMessage:"more not shown"}))))));v.displayName="RowItemOverflowComponent";const E=i.a.memo(v),x=({children:e,count:t,idPrefix:n})=>{const[s,l]=Object(a.useState)(!1),c=Object(a.useCallback)((()=>{l(!s)}),[s]);return i.a.createElement(b,null,i.a.createElement(o.EuiPopover,{button:i.a.createElement(o.EuiLink,{onClick:c,"data-test-subj":"overflow-button"},i.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.tables.rowItemHelper.overflowButtonDescription",defaultMessage:"+{count} More",values:{count:t}})),closePopover:()=>l(!s),id:`${n}-popover`,isOpen:s,panelClassName:"withHoverActions__popover",repositionOnScroll:!0},e))};x.displayName="PopoverComponent";const k=i.a.memo(x);k.displayName="Popover";const S=({value:e,showToolTip:t=!0,overflowLength:n=50})=>i.a.createElement("span",null,t?i.a.createElement(o.EuiToolTip,{"data-test-subj":"message-tooltip",content:"message"},i.a.createElement(i.a.Fragment,null,e.substring(0,n))):i.a.createElement(i.a.Fragment,null,e.substring(0,n)),e.length>n&&i.a.createElement(o.EuiToolTip,{content:e},i.a.createElement(p.f,{type:"boxesHorizontal"})));S.displayName="OverflowFieldComponent";const w=i.a.memo(S);w.displayName="OverflowField"},function(e,t,n){"use strict";n.d(t,"g",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return c})),n.d(t,"a",(function(){return u})),n.d(t,"f",(function(){return p})),n.d(t,"b",(function(){return m})),n.d(t,"e",(function(){return f}));var a=n(34),i=n(38),r=n(188),o=n(176);const s={box:{incremental:!0,placeholder:r.q,schema:!0}},l=e=>Object(a.isEmpty)(e)?"":`Example: ${e}`,c=e=>{switch(e){case"string":case"keyword":return"string";case"number":case"long":case"float":return"number";case"date":return"clock";case"ip":case"geo_point":return"globe";default:return"questionInCircle"}},u="event-fields-table",d=e=>Object(i.elementOrChildrenHasFocus)(null==e?void 0:e.querySelector(`.${u}`)),p=({containerElement:e,keyboardEvent:t,onSkipFocusBeforeEventsTable:n,onSkipFocusAfterEventsTable:a})=>{const{shiftKey:r}=t,o=Object(i.getTableSkipFocus)({containerElement:e,getFocusedCell:i.getFocusedDataColindexCell,shiftKey:r,tableHasFocus:d,tableClassName:u});"SKIP_FOCUS_NOOP"!==o&&(Object(i.stopPropagationAndPreventDefault)(t),Object(i.handleSkipFocus)({onSkipFocusBackwards:n,onSkipFocusForward:a,skipFocus:o}))};function m({browserFields:e,contextId:t,eventId:n,field:i,item:r,linkValueField:o,scopeId:s}){var l,c,u,d;const p={contextId:t,eventId:n,fieldType:"string",linkValue:void 0,scopeId:s},m=Object(a.getOr)(null,"originalValue.0",o),g=null!==(l=r.category)&&void 0!==l?l:"",f=null!==(c=r.field)&&void 0!==c?c:"",b=Object(a.get)([g,"fields",f],e),y=null==i?void 0:i.overrideField;return{...p,data:{field:null!=y?y:f,format:null!==(u=null==b?void 0:b.format)&&void 0!==u?u:"",type:null!==(d=null==b?void 0:b.type)&&void 0!==d?d:"",isObjectArray:r.isObjectArray},values:r.values,linkValue:null!=m?m:void 0,fieldFromBrowserField:b}}const g={[o.a]:!0};function f(e){return!g[e]}},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(1);const i={ADD_EXCEPTION_FLYOUT:`${a.B} fetchAlerts addExceptionFlyout`,ALERTS_COUNT_BY_STATUS:`${a.B} fetchAlerts byRulebyCount`,BY_ID:`${a.B} fetchAlerts byId`,BY_RULE_BY_STATUS:`${a.B} fetchAlerts byRulebyStatus`,BY_RULE_ID:`${a.B} fetchAlerts byRuleId`,BY_SEVERITY:`${a.B} fetchAlerts bySeverity`,BY_STATUS:`${a.B} fetchAlerts byStatus`,CASES:`${a.B} fetchAlerts cases`,COUNT:`${a.B} fetchAlerts count`,HISTOGRAM:`${a.B} fetchAlerts histogram`,PREVALENCE:`${a.B} fetchAlerts prevalence`,SOC_TRENDS:`${a.B} fetchAlerts socTrends`,TREE_MAP:`${a.B} fetchAlerts treeMap`,VULNERABLE_HOSTS:`${a.B} fetchAlerts vulnerableHosts`,VULNERABLE_USERS:`${a.B} fetchAlerts vulnerableUsers`}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(7),i=n(4),r=n(193),o=n(231);const s=({fetchMethod:e=r.e,query:t,indexName:n,skip:s,queryName:l})=>{const[c,u]=Object(i.useState)(t),[d,p]=Object(i.useState)({data:null,response:"",request:"",setQuery:u,refetch:null}),[m,g]=Object(i.useState)(!1),f=((e,t)=>{const{startTracking:n}=Object(o.a)();return Object(i.useMemo)((()=>async a=>{const{endTracking:i}=n({name:t});let r;try{r=await e(a),i("success")}catch(e){throw i(a.signal.aborted?"aborted":"error"),e}return r}),[e,t,n])})(e,l);return Object(i.useEffect)((()=>{let e=!0;const t=new AbortController,i=async()=>{try{g(!0);const r=await f({query:c,signal:t.signal});var a;e&&p({data:r,response:JSON.stringify(r,null,2),request:JSON.stringify({index:null!==(a=[n])&&void 0!==a?a:[""],body:c},null,2),setQuery:u,refetch:i})}catch(t){e&&p({data:null,response:"",request:"",setQuery:u,refetch:i})}e&&g(!1)};return Object(a.isEmpty)(c)||s||i(),s&&(g(!1),e=!1,t.abort()),()=>{e=!1,t.abort()}}),[c,n,s,f]),{loading:m,...d}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(32),i=n(284),r=n(4),o=n.n(r),s=n(33),l=n.n(s);const c=l.a.aside.withConfig({displayName:"Aside",componentId:"sc-10s9ue6-0"})(["padding:",";",""],(({theme:e})=>e.eui.euiSizeM),(({overlay:e,overlayBackground:t,theme:n})=>e&&Object(s.css)(["background:",";bottom:0;left:0;position:absolute;right:0;top:0;z-index:",";"],t?Object(i.rgba)(t,.9):Object(i.rgba)(n.eui.euiColorEmptyShade,.9),n.eui.euiZLevel1)));c.displayName="Aside";const u=l()(a.EuiFlexGroup).attrs((()=>({alignItems:"center",direction:"column",gutterSize:"s",justifyContent:"center"}))).withConfig({displayName:"FlexGroup",componentId:"sc-10s9ue6-1"})(["",""],(({overlay:e})=>e&&Object(s.css)(["height:100%;"])));u.displayName="FlexGroup";const d=o.a.memo((({children:e,overlay:t,overlayBackground:n,size:i})=>o.a.createElement(c,{overlay:t,overlayBackground:n},o.a.createElement(u,{overlay:{overlay:t}},o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(a.EuiLoadingSpinner,{"data-test-subj":"loading-spinner",size:i})),e&&o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(a.EuiText,{color:"subdued",size:"s"},o.a.createElement("p",null,e)))))));d.displayName="Loader"},function(e,t,n){"use strict";n.d(t,"t",(function(){return i})),n.d(t,"j",(function(){return r})),n.d(t,"p",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"h",(function(){return l})),n.d(t,"i",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"g",(function(){return d})),n.d(t,"s",(function(){return p})),n.d(t,"k",(function(){return m})),n.d(t,"o",(function(){return g})),n.d(t,"d",(function(){return f})),n.d(t,"u",(function(){return b})),n.d(t,"q",(function(){return y})),n.d(t,"w",(function(){return h})),n.d(t,"n",(function(){return v})),n.d(t,"b",(function(){return E})),n.d(t,"r",(function(){return x})),n.d(t,"m",(function(){return k})),n.d(t,"l",(function(){return S})),n.d(t,"a",(function(){return w})),n.d(t,"c",(function(){return j})),n.d(t,"v",(function(){return O}));var a=n(0);const i=a.i18n.translate("xpack.securitySolution.alertDetails.threatIntel",{defaultMessage:"Threat Intel"}),r=a.i18n.translate("xpack.securitySolution.alertDetails.overview.investigationGuide",{defaultMessage:"Investigation guide"}),o=a.i18n.translate("xpack.securitySolution.alertDetails.overview",{defaultMessage:"Overview"}),s=a.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields",{defaultMessage:"Highlighted fields"}),l=a.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields.field",{defaultMessage:"Field"}),c=a.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields.value",{defaultMessage:"Value"}),u=a.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields.alertPrevalence",{defaultMessage:"Alert prevalence"}),d=a.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields.alertPrevalenceTooltip",{defaultMessage:"The total count of alerts with the same value within the currently selected timerange. This value is not affected by additional filters."}),p=a.i18n.translate("xpack.securitySolution.eventDetails.table",{defaultMessage:"Table"}),m=a.i18n.translate("xpack.securitySolution.eventDetails.jsonView",{defaultMessage:"JSON"}),g=a.i18n.translate("xpack.securitySolution.eventDetails.osqueryView",{defaultMessage:"Osquery Results"}),f=a.i18n.translate("xpack.securitySolution.eventDetails.field",{defaultMessage:"Field"}),b=a.i18n.translate("xpack.securitySolution.eventDetails.value",{defaultMessage:"Value"}),y=(a.i18n.translate("xpack.securitySolution.eventDetails.description",{defaultMessage:"Description"}),a.i18n.translate("xpack.securitySolution.eventDetails.filter.placeholder",{defaultMessage:"Filter by Field, Value, or Description..."})),h=e=>a.i18n.translate("xpack.securitySolution.eventDetails.viewColumnCheckboxAriaLabel",{values:{field:e},defaultMessage:"View {field} column"}),v=e=>a.i18n.translate("xpack.securitySolution.eventDetails.nestedColumnCheckboxAriaLabel",{values:{field:e},defaultMessage:"The {field} field is an object, and is broken down into nested fields which can be added as column"}),E=a.i18n.translate("xpack.securitySolution.detections.alerts.agentStatus",{defaultMessage:"Agent status"}),x=a.i18n.translate("xpack.securitySolution.detections.alerts.ruleType",{defaultMessage:"Rule type"}),k=a.i18n.translate("xpack.securitySolution.eventDetails.multiFieldTooltipContent",{defaultMessage:"Multi-fields can have multiple values per field"}),S=a.i18n.translate("xpack.securitySolution.eventDetails.multiFieldBadge",{defaultMessage:"multi-field"}),w=a.i18n.translate("xpack.securitySolution.eventDetails.table.actions",{defaultMessage:"Actions"}),j=a.i18n.translate("xpack.securitySolution.eventDetails.alertReason",{defaultMessage:"Alert reason"}),O=a.i18n.translate("xpack.securitySolution.eventDetails.viewAllFields",{defaultMessage:"View all fields in table"})},function(e,t,n){"use strict";e.exports=function(e){return-2===e||-1===e||32===e}},function(e,t,n){"use strict";n.d(t,"h",(function(){return v})),n.d(t,"j",(function(){return E})),n.d(t,"i",(function(){return x})),n.d(t,"l",(function(){return k})),n.d(t,"d",(function(){return S})),n.d(t,"a",(function(){return w})),n.d(t,"c",(function(){return j})),n.d(t,"m",(function(){return O})),n.d(t,"k",(function(){return I})),n.d(t,"b",(function(){return F})),n.d(t,"e",(function(){return A})),n.d(t,"f",(function(){return _})),n.d(t,"g",(function(){return R}));var a=n(4),i=n.n(a),r=n(32),o=n(7),s=n(43),l=n.n(s),c=n(93),u=n(245),d=n(172),p=n(361),m=n(710),g=n(965),f=n(966),b=n(967);const y=["@timestamp","agent.id","agent.name","agent.type","agent.version","data_stream.dataset","data_stream.namespace","data_stream.type","destination.address","destination.bytes","destination.domain","destination.geo.city_name","destination.geo.continent_name","destination.geo.country_iso_code","destination.geo.country_name","destination.geo.location","destination.geo.name","destination.geo.region_iso_code","destination.geo.region_name","destination.ip","destination.packets","destination.port","destination.registered_domain","destination.top_level_domain","dll.code_signature.exists","dll.code_signature.status","dll.code_signature.subject_name","dll.code_signature.trusted","dll.code_signature.valid","dll.Ext","dll.Ext.code_signature","dll.Ext.code_signature.exists","dll.Ext.code_signature.status","dll.Ext.code_signature.subject_name","dll.Ext.code_signature.trusted","dll.Ext.code_signature.valid","dll.Ext.load_index","dll.hash.md5","dll.hash.sha1","dll.hash.sha256","dll.hash.sha512","dll.name","dll.path","dll.pe.company","dll.pe.description","dll.pe.file_version","dll.pe.imphash","dll.pe.original_file_name","dll.pe.product","dns.Ext","dns.Ext.options","dns.Ext.status","dns.question.name","dns.question.registered_domain","dns.question.subdomain","dns.question.top_level_domain","dns.question.type","dns.resolved_ip","ecs.version","elastic.agent","elastic.agent.id","Endpoint.policy","Endpoint.policy.applied","Endpoint.policy.applied.id","Endpoint.policy.applied.name","Endpoint.policy.applied.status","Endpoint.status","event.action","event.category","event.code","event.created","event.dataset","event.Ext","event.Ext.correlation","event.Ext.correlation.id","event.hash","event.id","event.ingested","event.module","event.outcome","event.provider","event.sequence","event.severity","event.type","file.accessed","file.attributes","file.created","file.ctime","file.device","file.directory","file.drive_letter","file.Ext","file.Ext.code_signature","file.Ext.code_signature.exists","file.Ext.code_signature.status","file.Ext.code_signature.subject_name","file.Ext.code_signature.trusted","file.Ext.code_signature.valid","file.Ext.entropy","file.Ext.header_data","file.Ext.monotonic_id","file.Ext.original","file.Ext.original.gid","file.Ext.original.group","file.Ext.original.mode","file.Ext.original.name","file.Ext.original.owner","file.Ext.original.path","file.Ext.original.uid","file.Ext.windows","file.Ext.windows.zone_identifier","file.extension","file.gid","file.group","file.hash.md5","file.hash.sha1","file.hash.sha256","file.hash.sha512","file.inode","file.mime_type","file.mode","file.mtime","file.name","file.owner","file.path","file.path.caseless","file.path.text","file.pe.company","file.pe.description","file.pe.file_version","file.pe.imphash","file.pe.original_file_name","file.pe.product","file.size","file.target_path","file.target_path.caseless","file.target_path.text","file.type","file.uid","group.domain","group.Ext","group.Ext.real","group.Ext.real.id","group.Ext.real.name","group.id","group.name","host.architecture","host.domain","host.hostname","host.id","host.ip","host.mac","host.name","host.os.Ext","host.os.Ext.variant","host.os.family","host.os.full","host.os.full.caseless","host.os.full.text","host.os.kernel","host.os.name","host.os.name.caseless","host.os.name.text","host.os.platform","host.os.version","host.type","host.uptime","http.request.body.bytes","http.request.body.content","http.request.body.content.text","http.request.bytes","http.response.body.bytes","http.response.body.content","http.response.body.content.text","http.response.bytes","http.response.Ext","http.response.Ext.version","http.response.status_code","message","network.bytes","network.community_id","network.direction","network.iana_number","network.packets","network.protocol","network.transport","network.type","package.name","process.args","process.args_count","process.code_signature.exists","process.code_signature.status","process.code_signature.subject_name","process.code_signature.trusted","process.code_signature.valid","process.command_line","process.command_line.caseless","process.command_line.text","process.entity_id","process.entry_leader.interactive","process.executable","process.executable.caseless","process.executable.text","process.exit_code","process.Ext","process.Ext.ancestry","process.Ext.authentication_id","process.Ext.code_signature","process.Ext.code_signature.exists","process.Ext.code_signature.status","process.Ext.code_signature.subject_name","process.Ext.code_signature.trusted","process.Ext.code_signature.valid","process.Ext.defense_evasions","process.Ext.session","process.Ext.token.elevation","process.Ext.token.elevation_type","process.Ext.token.integrity_level_name","process.hash.md5","process.hash.sha1","process.hash.sha256","process.hash.sha512","process.name","process.name.caseless","process.name.text","process.parent.args","process.parent.args_count","process.parent.code_signature.exists","process.parent.code_signature.status","process.parent.code_signature.subject_name","process.parent.code_signature.trusted","process.parent.code_signature.valid","process.parent.command_line","process.parent.command_line.caseless","process.parent.command_line.text","process.parent.entity_id","process.parent.executable","process.parent.executable.caseless","process.parent.executable.text","process.parent.exit_code","process.parent.Ext","process.parent.Ext.code_signature","process.parent.Ext.code_signature.exists","process.parent.Ext.code_signature.status","process.parent.Ext.code_signature.subject_name","process.parent.Ext.code_signature.trusted","process.parent.Ext.code_signature.valid","process.parent.Ext.real","process.parent.Ext.real.pid","process.parent.hash.md5","process.parent.hash.sha1","process.parent.hash.sha256","process.parent.hash.sha512","process.parent.name","process.parent.name.caseless","process.parent.name.text","process.parent.pe.company","process.parent.pe.description","process.parent.pe.file_version","process.parent.pe.imphash","process.parent.pe.original_file_name","process.parent.pe.product","process.parent.pgid","process.parent.pid","process.parent.ppid","process.parent.thread.id","process.parent.thread.name","process.parent.title","process.parent.title.text","process.parent.uptime","process.parent.working_directory","process.parent.working_directory.caseless","process.parent.working_directory.text","process.pe.company","process.pe.description","process.pe.file_version","process.pe.imphash","process.pe.original_file_name","process.pe.product","process.pgid","process.pid","process.ppid","process.thread.id","process.thread.name","process.title","process.title.text","process.uptime","process.working_directory","process.working_directory.caseless","process.working_directory.text","registry.data.bytes","registry.data.strings","registry.hive","registry.key","registry.path","registry.value","source.address","source.bytes","source.domain","source.geo.city_name","source.geo.continent_name","source.geo.country_iso_code","source.geo.country_name","source.geo.location","source.geo.name","source.geo.region_iso_code","source.geo.region_name","source.ip","source.packets","source.port","source.registered_domain","source.top_level_domain","user.domain","user.email","user.Ext","user.Ext.real","user.Ext.real.id","user.Ext.real.name","user.full_name","user.full_name.text","user.group.domain","user.group.Ext","user.group.Ext.real","user.group.Ext.real.id","user.group.Ext.real.name","user.group.id","user.group.name","user.hash","user.id","user.name","user.name.text"];var h=n(471);const v=(e,t,n)=>{switch(t){case"endpoint":const t=null!=n&&n.includes("linux")?e=>g.includes(e)||b.includes(e):e=>f.includes(e)||b.includes(e);return{...e,fields:e.fields.filter((({name:e})=>t(e)))};case"endpoint_events":return{...e,fields:e.fields.filter((({name:e})=>y.includes(e)))};default:return e}},E=e=>e.map((e=>({username:e.created_by,timestamp:l()(e.created_at).format("on MMM Do YYYY @ HH:mm:ss"),event:p.b,timelineAvatar:i.a.createElement(r.EuiAvatar,{size:"l",name:e.created_by.toUpperCase()}),children:i.a.createElement(r.EuiText,{size:"s"},e.comment),actions:i.a.createElement(m.a,{"data-test-subj":"copy-to-clipboard",text:e.comment,titleSummary:p.a})}))),x=e=>{const{created_at:t,created_by:n,list_id:a,tie_breaker_id:i,updated_at:r,updated_by:o,...s}=e;return{...s}},k=e=>e.map((e=>{if(void 0!==e.entries){const t=e.entries.map((e=>{const t=Object(o.omit)(e,"id");return{...t,field:t.field.startsWith("event.")?t.field.replace(/^event./,`${h.d}.`):t.field}}));return{...e,entries:t}}return e})),S=(e,t)=>e.map((e=>({...e,comments:t}))),w=e=>({query:{match:{_id:{query:e||""}}}}),j=(e,t)=>e.map((e=>({...e,os_types:t}))),O=e=>{const t=["windows","macos"];if(null!=e){var n,a,i,r,o,s;const l="endpoint"===(null==e||null===(n=e.agent)||void 0===n?void 0:n.type)?null===(a=e.host)||void 0===a||null===(i=a.os)||void 0===i||null===(r=i.name)||void 0===r?void 0:r.toLowerCase():null===(o=e.host)||void 0===o||null===(s=o.os)||void 0===s?void 0:s.family;if(null!=l)return c.C.is(l)?[l]:t}return t},I=e=>e.map((e=>{const t=e.entries.map((e=>{if(e.field.includes(".hash")){if("match"===e.type)return{...e,value:e.value.toLowerCase()};if("match_any"===e.type)return{...e,value:e.value.map((e=>e.toLowerCase()))}}return e}));return{...e,entries:t}})),T=e=>{if(Array.isArray(e)&&e.length>0)return e.map((e=>{var t,n,a;return{subjectName:null!==(t=null==e?void 0:e.subject_name)&&void 0!==t?t:"",trusted:null!==(n=null==e||null===(a=e.trusted)||void 0===a?void 0:a.toString())&&void 0!==n?n:""}}));{var t,n;const a=Array.isArray(e)?void 0:e;return[{subjectName:null!==(t=null==a?void 0:a.subject_name)&&void 0!==t?t:"",trusted:null!==(n=null==a?void 0:a.trusted)&&void 0!==n?n:""}]}};function C(e){const t=[];for(const n of e)void 0!==n.entries?(n.entries=n.entries.filter((e=>void 0!==e.value&&e.value.length>0)),t.push(n)):void 0!==n.value&&n.value.length>0&&t.push(n);return t}const M=({listId:e,name:t,eventCode:n,listNamespace:a="agnostic",alertEcsData:i})=>{var r,o,s,l,c,d;const{process:p}=i,m=C([{field:"Memory_protection.feature",operator:"included",type:"match",value:null!==(r=null===(o=i.Memory_protection)||void 0===o?void 0:o.feature)&&void 0!==r?r:""},{field:"process.executable.caseless",operator:"included",type:"match",value:null!==(s=null==p?void 0:p.executable)&&void 0!==s?s:""},{field:"process.name.caseless",operator:"included",type:"match",value:null!==(l=null==p?void 0:p.name)&&void 0!==l?l:""},{field:"process.hash.sha256",operator:"included",type:"match",value:null!==(c=null==p||null===(d=p.hash)||void 0===d?void 0:d.sha256)&&void 0!==c?c:""}]);return{...Object(u.h)({listId:e,namespaceType:a,name:t}),entries:Object(u.c)(m)}},N=({listId:e,name:t,eventCode:n,listNamespace:a="agnostic",alertEcsData:i})=>{var r,o,s,l,c,d,p,m,g;const{process:f}=i,b=C([{field:"Memory_protection.feature",operator:"included",type:"match",value:null!==(r=null===(o=i.Memory_protection)||void 0===o?void 0:o.feature)&&void 0!==r?r:""},{field:"Memory_protection.self_injection",operator:"included",type:"match",value:null!==(s=String(null===(l=i.Memory_protection)||void 0===l?void 0:l.self_injection))&&void 0!==s?s:""},{field:"process.executable.caseless",operator:"included",type:"match",value:null!==(c=null==f?void 0:f.executable)&&void 0!==c?c:""},{field:"process.name.caseless",operator:"included",type:"match",value:null!==(d=null==f?void 0:f.name)&&void 0!==d?d:""},{field:"process.Ext.token.integrity_level_name",operator:"included",type:"match",value:null!==(p=null==f||null===(m=f.Ext)||void 0===m||null===(g=m.token)||void 0===g?void 0:g.integrity_level_name)&&void 0!==p?p:""}]);return{...Object(u.h)({listId:e,namespaceType:a,name:t}),entries:Object(u.c)(b)}},D=({listId:e,name:t,eventCode:n,listNamespace:a="agnostic",alertEcsData:i})=>{var r,o,s,l,c,d,p,m,g,f,b,y,h,v,E,x,k,S,w,j,O,I,T,M,N,D,F,A,_,R,P,L,q,B,z,$,V,U,H;const{process:G}=i,Q=C([{field:"rule.id",operator:"included",type:"match",value:null!==(r=null===(o=i.rule)||void 0===o?void 0:o.id)&&void 0!==r?r:""},{field:"process.executable.caseless",operator:"included",type:"match",value:null!==(s=null==G?void 0:G.executable)&&void 0!==s?s:""},{field:"process.command_line",operator:"included",type:"match",value:null!==(l=null==G?void 0:G.command_line)&&void 0!==l?l:""},{field:"process.parent.executable",operator:"included",type:"match",value:null!==(c=null==G||null===(d=G.parent)||void 0===d?void 0:d.executable)&&void 0!==c?c:""},{field:"process.code_signature.subject_name",operator:"included",type:"match",value:null!==(p=null==G||null===(m=G.code_signature)||void 0===m?void 0:m.subject_name)&&void 0!==p?p:""},{field:"file.path",operator:"included",type:"match",value:null!==(g=null===(f=i.file)||void 0===f?void 0:f.path)&&void 0!==g?g:""},{field:"file.name",operator:"included",type:"match",value:null!==(b=null===(y=i.file)||void 0===y?void 0:y.name)&&void 0!==b?b:""},{field:"source.ip",operator:"included",type:"match",value:null!==(h=null===(v=i.source)||void 0===v?void 0:v.ip)&&void 0!==h?h:""},{field:"destination.ip",operator:"included",type:"match",value:null!==(E=null===(x=i.destination)||void 0===x?void 0:x.ip)&&void 0!==E?E:""},{field:"registry.path",operator:"included",type:"match",value:null!==(k=null===(S=i.registry)||void 0===S?void 0:S.path)&&void 0!==k?k:""},{field:"registry.value",operator:"included",type:"match",value:null!==(w=null===(j=i.registry)||void 0===j?void 0:j.value)&&void 0!==w?w:""},{field:"registry.data.strings",operator:"included",type:"match",value:null!==(O=null===(I=i.registry)||void 0===I||null===(T=I.data)||void 0===T?void 0:T.strings)&&void 0!==O?O:""},{field:"dll.path",operator:"included",type:"match",value:null!==(M=null===(N=i.dll)||void 0===N?void 0:N.path)&&void 0!==M?M:""},{field:"dll.code_signature.subject_name",operator:"included",type:"match",value:null!==(D=null===(F=i.dll)||void 0===F||null===(A=F.code_signature)||void 0===A?void 0:A.subject_name)&&void 0!==D?D:""},{field:"dll.pe.original_file_name",operator:"included",type:"match",value:null!==(_=null===(R=i.dll)||void 0===R||null===(P=R.pe)||void 0===P?void 0:P.original_file_name)&&void 0!==_?_:""},{field:"dns.question.name",operator:"included",type:"match",value:null!==(L=null===(q=i.dns)||void 0===q||null===(B=q.question)||void 0===B?void 0:B.name)&&void 0!==L?L:""},{field:"dns.question.type",operator:"included",type:"match",value:null!==(z=null===($=i.dns)||void 0===$||null===(V=$.question)||void 0===V?void 0:V.type)&&void 0!==z?z:""},{field:"user.id",operator:"included",type:"match",value:null!==(U=null===(H=i.user)||void 0===H?void 0:H.id)&&void 0!==U?U:""}]);return{...Object(u.h)({listId:e,namespaceType:a,name:t}),entries:Object(u.c)(Q)}},F=(e,t,n)=>{var a,i;const r=null!==(a=n["event.code"])&&void 0!==a?a:null===(i=n.event)||void 0===i?void 0:i.code;switch(r){case"behavior":return[D({listId:e,name:t,eventCode:r,alertEcsData:n})];case"memory_signature":return[M({listId:e,name:t,eventCode:r,alertEcsData:n})];case"shellcode_thread":return[N({listId:e,name:t,eventCode:r,alertEcsData:n})];case"ransomware":return(e=>{const{process:t}=e,n=t&&t.Ext&&t.Ext.code_signature;return T(n)})(n).map((a=>(({listId:e,name:t,codeSignature:n,eventCode:a,listNamespace:i="agnostic",alertEcsData:r})=>{var o,s,l,c;const{process:d,Ransomware:p}=r,m=null!==(o=null==d||null===(s=d.hash)||void 0===s?void 0:s.sha256)&&void 0!==o?o:"",g=null!==(l=null==d?void 0:d.executable)&&void 0!==l?l:"",f=null!==(c=null==p?void 0:p.feature)&&void 0!==c?c:"";return{...Object(u.h)({listId:e,namespaceType:i,name:t}),entries:Object(u.c)([{field:"process.Ext.code_signature",type:"nested",entries:[{field:"subject_name",operator:"included",type:"match",value:null!=n?n.subjectName:""},{field:"trusted",operator:"included",type:"match",value:null!=n?n.trusted:""}]},{field:"process.executable",operator:"included",type:"match",value:null!=g?g:""},{field:"process.hash.sha256",operator:"included",type:"match",value:null!=m?m:""},{field:"Ransomware.feature",operator:"included",type:"match",value:null!=f?f:""},{field:"event.code",operator:"included",type:"match",value:null!=a?a:""}])}})({listId:e,name:t,eventCode:r,codeSignature:a,alertEcsData:n})));default:return(e=>{const{file:t}=e,n=t&&t.Ext&&t.Ext.code_signature;return T(n)})(n).map((a=>(({listId:e,name:t,codeSignature:n,eventCode:a,listNamespace:i="agnostic",alertEcsData:r})=>{var o,s,l,c;const{file:d,host:p}=r,m=null!==(o=null==d?void 0:d.path)&&void 0!==o?o:"",g=null!==(s=null==d||null===(l=d.hash)||void 0===l?void 0:l.sha256)&&void 0!==s?s:"",f="Linux"===(null==p||null===(c=p.os)||void 0===c?void 0:c.name),b=[{field:f?"file.path":"file.path.caseless",operator:"included",type:"match",value:null!=m?m:""},{field:"file.hash.sha256",operator:"included",type:"match",value:null!=g?g:""},{field:"event.code",operator:"included",type:"match",value:null!=a?a:""}];return{...Object(u.h)({listId:e,namespaceType:i,name:t}),entries:f?Object(u.c)(b):Object(u.c)([{field:"file.Ext.code_signature",type:"nested",entries:[{field:"subject_name",operator:"included",type:"match",value:null!=n?n.subjectName:""},{field:"trusted",operator:"included",type:"match",value:null!=n?n.trusted:""}]},...b])}})({listId:e,name:t,eventCode:null!=r?r:"",codeSignature:a,alertEcsData:n})))}},A=(e,t)=>e.map((e=>({...e,name:t}))),_=e=>e.map((e=>({...Object(d.a)(e),list_id:void 0,namespace_type:"single"}))),R=(e,t)=>t.flatMap((t=>e.map((e=>({...Object(d.a)(e),list_id:t.list_id,namespace_type:t.namespace_type})))))},,,,function(e,t,n){"use strict";n.d(t,"j",(function(){return i})),n.d(t,"i",(function(){return r})),n.d(t,"k",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return c})),n.d(t,"l",(function(){return u})),n.d(t,"g",(function(){return d})),n.d(t,"m",(function(){return p})),n.d(t,"e",(function(){return m})),n.d(t,"h",(function(){return g})),n.d(t,"d",(function(){return f})),n.d(t,"o",(function(){return b})),n.d(t,"n",(function(){return y})),n.d(t,"f",(function(){return h}));var a=n(0);const i=a.i18n.translate("xpack.securitySolution.visualizationActions.moreActions",{defaultMessage:"More actions"}),r=a.i18n.translate("xpack.securitySolution.visualizationActions.inspect",{defaultMessage:"Inspect"}),o=a.i18n.translate("xpack.securitySolution.visualizationActions.openInLens",{defaultMessage:"Open in Lens"}),s=a.i18n.translate("xpack.securitySolution.visualizationActions.addToNewCase",{defaultMessage:"Add to new case"}),l=a.i18n.translate("xpack.securitySolution.visualizationActions.addToExistingCase",{defaultMessage:"Add to existing case"}),c=a.i18n.translate("xpack.securitySolution.visualizationActions.addToCaseSuccessContent",{defaultMessage:"Successfully added visualization to the case"}),u=a.i18n.translate("xpack.securitySolution.visualizationActions.uniqueIps.sourceChartLabel",{defaultMessage:"Src."}),d=a.i18n.translate("xpack.securitySolution.visualizationActions.uniqueIps.destinationChartLabel",{defaultMessage:"Dest."}),p=a.i18n.translate("xpack.securitySolution.visualizationActions.userAuthentications.successChartLabel",{defaultMessage:"Succ."}),m=a.i18n.translate("xpack.securitySolution.visualizationActions.userAuthentications.authentication.successChartLabel",{defaultMessage:"Success"}),g=a.i18n.translate("xpack.securitySolution.visualizationActions.userAuthentications.failChartLabel",{defaultMessage:"Fail"}),f=a.i18n.translate("xpack.securitySolution.visualizationActions.userAuthentications.authentication.failureChartLabel",{defaultMessage:"Failure"}),b=e=>a.i18n.translate("xpack.securitySolution.visualizationActions.uniqueCountLabel",{values:{field:e},defaultMessage:"Unique count of {field}"}),y=e=>a.i18n.translate("xpack.securitySolution.visualizationActions.topValueLabel",{values:{field:e},defaultMessage:"Top values of {field}"}),h=a.i18n.translate("xpack.securitySolution.visualizationActions.countLabel",{defaultMessage:"Count of records"})},function(e,t,n){"use strict";n.d(t,"g",(function(){return c})),n.d(t,"a",(function(){return P})),n.d(t,"f",(function(){return q})),n.d(t,"c",(function(){return $})),n.d(t,"b",(function(){return Ge})),n.d(t,"h",(function(){return Ke})),n.d(t,"i",(function(){return u})),n.d(t,"d",(function(){return pt})),n.d(t,"e",(function(){return Ae})),n.d(t,"j",(function(){return Be}));var a=n(4),i=n.n(a),r=n(32),o=n(36),s={strict:!0,fields:{created_by:{type:"string"},description:{type:"string"},id:{type:"string"},item_id:{type:"string"},list_id:{type:"string"},name:{type:"string"},os_types:{type:"string"},tags:{type:"string"}}},l=function(e){var t=e.addExceptionButtonText,n=e.placeholdertext,i=e.canAddException,l=e.listType,c=e.isSearching,u=e.dataTestSubj,d=e.filters,p=void 0===d?[]:d,m=e.isButtonFilled,g=void 0===m||m,f=e.buttonIconType,b=e.onSearch,y=e.onAddExceptionClick,h=Object(a.useCallback)((function(e){var t=e.queryText;b({search:t})}),[b]),v=Object(a.useCallback)((function(){y(l)}),[y,l]);return Object(o.jsx)(r.EuiFlexGroup,{alignItems:"center"},Object(o.jsx)(r.EuiFlexItem,{grow:!0},Object(o.jsx)(r.EuiSearchBar,{box:{placeholder:n,incremental:!1,schema:s,"data-test-subj":"".concat(u||"","searchBar")},filters:p,onChange:h})),!i&&Object(o.jsx)(r.EuiFlexItem,{grow:!1},Object(o.jsx)(r.EuiButton,{"data-test-subj":"".concat(u||"","Button"),onClick:v,isDisabled:c,fill:g,iconType:f},t)))};l.displayName="SearchBarComponent";var c=i.a.memo(l);c.displayName="SearchBar";var u,d,p=n(40);!function(e){e.ERROR="error",e.EMPTY="empty",e.EMPTY_SEARCH="empty_search",e.LOADING="loading",e.SEARCHING="searching",e.DELETING="deleting"}(u||(u={})),function(e){e.ENDPOINT="endpoint",e.DETECTION="empty",e.RULE_DEFAULT="empty_search"}(d||(d={}));var m=n(0),g=m.i18n.translate("exceptionList-components.empty.viewer.state.empty.title",{defaultMessage:"Add exceptions to this list"}),f=m.i18n.translate("exceptionList-components.empty.viewer.state.empty.body",{defaultMessage:"There is no exception in your list. Create your first exception."}),b=m.i18n.translate("exceptionList-components.empty.viewer.state.empty_search.search.title",{defaultMessage:"No results match your search criteria"}),y=m.i18n.translate("exceptionList-components.empty.viewer.state.empty_search.body",{defaultMessage:"Try modifying your search"}),h=m.i18n.translate("exceptionList-components.empty.viewer.state.error_title",{defaultMessage:"Unable to load exception items"}),v=m.i18n.translate("exceptionList-components.empty.viewer.state.error_body",{defaultMessage:"There was an error loading the exception items. Contact your administrator for help."}),E=m.i18n.translate("exceptionList-components.exception_list_header_export_action",{defaultMessage:"Export exception list"}),x=m.i18n.translate("exceptionList-components.exception_list_header_delete_action",{defaultMessage:"Delete exception list"}),k=m.i18n.translate("exceptionList-components.exception_list_header_manage_rules_button",{defaultMessage:"Manage rules"}),S=function(e){return m.i18n.translate("exceptionList-components.exception_list_header_linked_rules",{values:{noOfRules:e},defaultMessage:"Linked to {noOfRules} rules"})},w=m.i18n.translate("exceptionList-components.exception_list_header_breadcrumb",{defaultMessage:"Rule exceptions"}),j=m.i18n.translate("exceptionList-components.exception_list_header_list_id",{defaultMessage:"List ID"}),O=m.i18n.translate("exceptionList-components.exception_list_header_name",{defaultMessage:"Add a name"}),I=m.i18n.translate("exceptionList-components.exception_list_header_description",{defaultMessage:"Add a description"}),T=m.i18n.translate("exceptionList-components.exception_list_header_edit_modal_save_button",{defaultMessage:"Save"}),C=m.i18n.translate("exceptionList-components.exception_list_header_edit_modal_cancel_button",{defaultMessage:"Cancel"}),M=m.i18n.translate("exceptionList-components.exception_list_header_Name_textbox",{defaultMessage:"Name"}),N=m.i18n.translate("exceptionList-components.exception_list_header_description_textbox",{defaultMessage:"Description (optional)"}),D=m.i18n.translate("exceptionList-components.exception_list_header_description_textboxexceptionList-components.exception_list_header_name_required_eror",{defaultMessage:"List name cannot be empty"}),F=n(968),A=n.n(F),_=Object(o.css)("margin:",p.euiThemeVars.euiSizeL," 0;padding:",p.euiThemeVars.euiSizeL," 0;",""),R=function(e){var t=e.title,n=e.body,i=e.buttonText,s=e.listType,l=e.isReadOnly,c=e.viewerStatus,d=e.onCreateExceptionListItem,p=Object(r.useEuiTheme)().euiTheme,E=Object(a.useMemo)((function(){switch(c){case u.ERROR:return{color:"danger",iconType:"alert",title:Object(o.jsx)("h2",{"data-test-subj":"errorTitle"},t||h),body:Object(o.jsx)("p",{"data-test-subj":"errorBody"},n||v),"data-test-subj":"errorViewerState"};case u.EMPTY:return{color:"subdued",iconType:"plusInCircle",iconColor:p.colors.darkestShade,title:Object(o.jsx)("h2",{"data-test-subj":"emptyTitle"},t||g),body:Object(o.jsx)("p",{"data-test-subj":"emptyBody"},n||f),"data-test-subj":"emptyViewerState",actions:[Object(o.jsx)(r.EuiButton,{"data-test-subj":"emptyStateButton",onClick:d,iconType:"plusInCircle",color:"primary",isDisabled:l,fill:!0},i||(e=s||"rule",m.i18n.translate("exceptionList-components.empty.viewer.state.empty.viewer_button",{values:{exceptionType:e},defaultMessage:"Create {exceptionType} exception"})))]};case u.EMPTY_SEARCH:return{color:"plain",layout:"horizontal",hasBorder:!0,hasShadow:!1,icon:Object(o.jsx)(r.EuiImage,{size:"fullWidth",alt:"",src:A.a}),title:Object(o.jsx)("h3",{"data-test-subj":"emptySearchTitle"},t||b),body:Object(o.jsx)("p",{"data-test-subj":"emptySearchBody"},n||y),"data-test-subj":"emptySearchViewerState"}}var e}),[c,p.colors.darkestShade,t,n,d,l,i,s]);return c===u.LOADING||c===u.SEARCHING?Object(o.jsx)(r.EuiLoadingContent,{lines:4,"data-test-subj":"loadingViewerState"}):Object(o.jsx)(r.EuiPanel,{css:_,color:"empty_search"===c?"subdued":"transparent"},Object(o.jsx)(r.EuiEmptyPrompt,E))},P=i.a.memo(R);P.displayName="EmptyViewerState";var L=function(e){var t=e.dataTestSubj,n=e.ariaLabel,i=function(e){var t=e.pagination,n=e.onPaginationChange,i=t.pageIndex,r=t.totalItemCount,o=t.pageSize,s=t.pageSizeOptions,l=Object(a.useMemo)((function(){return isFinite(r/o)?Math.ceil(r/o):0}),[o,r]),c=Object(a.useCallback)((function(e){n({pagination:{pageIndex:i,pageSize:e,totalItemCount:r}})}),[i,r,n]),u=Object(a.useCallback)((function(e){n({pagination:{pageIndex:e,pageSize:o,totalItemCount:r}})}),[o,r,n]);return{pageCount:l,pageIndex:i,pageSize:o,pageSizeOptions:s,handleItemsPerPageChange:c,handlePageIndexChange:u}}({pagination:e.pagination,onPaginationChange:e.onPaginationChange}),s=i.pageIndex,l=i.pageCount,c=i.pageSize,u=i.pageSizeOptions,d=i.handleItemsPerPageChange,p=i.handlePageIndexChange;return Object(o.jsx)(r.EuiTablePagination,{"data-test-subj":t,"aria-label":n,pageCount:l,activePage:s,itemsPerPage:c,onChangePage:p,onChangeItemsPerPage:d,itemsPerPageOptions:u})};L.displayName="PaginationComponent";var q=i.a.memo(L);q.displayName="Pagination";var B=Object(o.css)("margin:",p.euiThemeVars.euiSize," 0;&div:first-child{margin:",p.euiThemeVars.euiSizeXS," 0 ",p.euiThemeVars.euiSize,";}",""),z=function(e){var t=e.lastUpdated,n=e.viewerStatus,a=e.isReadOnly,s=e.exceptions,l=e.listType,c=e.ruleReferences,u=e.emptyViewerTitle,d=e.emptyViewerBody,p=e.emptyViewerButtonText,m=e.pagination,g=e.dataTestSubj,f=e.editActionLabel,b=e.deleteActionLabel,y=e.securityLinkAnchorComponent,h=e.exceptionsUtilityComponent,v=e.formattedDateComponent,E=e.getFormattedComments,x=e.onPaginationChange,k=e.onDeleteException,S=e.onEditExceptionItem,w=e.onCreateExceptionListItem,j=h;return!s.length||n?Object(o.jsx)(P,{isReadOnly:a,title:u,viewerStatus:n,buttonText:p,body:d,onCreateExceptionListItem:w}):Object(o.jsx)(i.a.Fragment,null,Object(o.jsx)(j,{pagination:m,lastUpdated:t}),Object(o.jsx)(r.EuiFlexGroup,{direction:"column",gutterSize:"none",className:"eui-yScrollWithShadows"},Object(o.jsx)(r.EuiFlexItem,{grow:!1},Object(o.jsx)(r.EuiFlexGroup,{css:B,"data-test-subj":"".concat(g||"","exceptionsContainer"),direction:"column",gutterSize:"s"},s.map((function(e){return Object(o.jsx)(r.EuiFlexItem,{"data-test-subj":"".concat(g||"","exceptionItemContainer"),grow:!1,key:e.id},Object(o.jsx)(Ge,{key:"".concat(e.id,"exceptionItemCardKey"),dataTestSubj:"".concat(g||"","exceptionItemCard"),disableActions:a,exceptionItem:e,listType:l,ruleReferences:Object.keys(c).length&&c[e.list_id]?c[e.list_id].referenced_rules:[],editActionLabel:f,deleteActionLabel:b,onDeleteException:k,onEditException:S,securityLinkAnchorComponent:y,formattedDateComponent:v,getFormattedComments:E}))}))))),Object(o.jsx)(q,{dataTestSubj:"".concat(g||"","pagination"),pagination:m,onPaginationChange:x}))};z.displayName="ExceptionItemsComponent";var $=i.a.memo(z);$.displayName="ExceptionsItems";var V,U,H=n(349),G=Object(o.css)("margin-left:",p.euiThemeVars.euiSizeXL,";margin-bottom:",p.euiThemeVars.euiSizeXS,";padding-top:",p.euiThemeVars.euiSizeXS,";",""),Q=Object(H.cx)("eui-xScroll","\n  border: 1px;\n  border-color: #d3dae6;\n  border-style: solid;\n"),W=Object(o.css)("display:flex;align-items:center;margin-left:",p.euiThemeVars.euiSizeS,";",""),K={name:"s5xdrg",styles:"display:flex;align-items:center"},Y=function(e){return m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.editItemButton",{values:{listType:e},defaultMessage:"Edit {listType} exception"})},J=function(e){return m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.deleteItemButton",{values:{listType:e},defaultMessage:"Delete {listType} exception"})},X=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.createdLabel",{defaultMessage:"Created"}),Z=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.updatedLabel",{defaultMessage:"Updated"}),ee=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.metaDetailsBy",{defaultMessage:"by"}),te=function(e){return m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.showCommentsLabel",{values:{comments:e},defaultMessage:"Show {comments, plural, =1 {comment} other {comments}} ({comments})"})},ne=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.matchOperator",{defaultMessage:"IS"}),ae=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.matchOperator.not",{defaultMessage:"IS NOT"}),ie=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.wildcardMatchesOperator",{defaultMessage:"MATCHES"}),re=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.wildcardDoesNotMatchOperator",{defaultMessage:"DOES NOT MATCH"}),oe=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.nestedOperator",{defaultMessage:"has"}),se=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.matchAnyOperator",{defaultMessage:"is one of"}),le=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.matchAnyOperator.not",{defaultMessage:"is not one of"}),ce=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.existsOperator",{defaultMessage:"exists"}),ue=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.existsOperator.not",{defaultMessage:"does not exist"}),de=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.listOperator",{defaultMessage:"included in"}),pe=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.listOperator.not",{defaultMessage:"is not included in"}),me=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.and",{defaultMessage:"AND"}),ge=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.os",{defaultMessage:"OS"}),fe=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.windows",{defaultMessage:"Windows"}),be=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.linux",{defaultMessage:"Linux"}),ye=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.macos",{defaultMessage:"Mac"}),he=n(6),ve=n.n(he),Ee=n(93),xe=Object.freeze({linux:be,mac:ye,macos:ye,windows:fe}),ke=Object.freeze((V={},ve()(V,Ee.d.NESTED,oe),ve()(V,Ee.d.MATCH_ANY,se),ve()(V,Ee.d.MATCH,ne),ve()(V,Ee.d.WILDCARD,ie),ve()(V,Ee.d.EXISTS,ce),ve()(V,Ee.d.LIST,de),V)),Se=Object.freeze((U={},ve()(U,Ee.d.MATCH_ANY,le),ve()(U,Ee.d.MATCH,ae),ve()(U,Ee.d.WILDCARD,re),ve()(U,Ee.d.EXISTS,ue),ve()(U,Ee.d.LIST,pe),U)),we=function(e,t){return"match_any"===e&&Array.isArray(t)?t.map((function(e,t){return Object(o.jsx)(r.EuiBadge,{key:t,"data-test-subj":"matchAnyBadge".concat(t),color:"hollow"},e)})):null!=t?t:""},je=function(e,t){var n,a;return"nested"===e?"":"included"===t?null!==(n=ke[e])&&void 0!==n?n:e:null!==(a=Se[e])&&void 0!==a?a:e},Oe=function(e,t,n){return Object(o.jsx)(i.a.Fragment,null,Object(o.jsx)(r.EuiExpression,{description:je(e,t),value:we(e,n),"data-test-subj":"entryValueExpression"}),Object(o.jsx)(Ke,{value:n}))},Ie=Object(a.memo)((function(e){var t=e.entry,n=e.index,a=e.isNestedEntry,s=void 0!==a&&a,l=e.dataTestSubj,c=t.field,u=t.type,d=function(e){return"list"===e.type?e.list.id:"value"in e?e.value:""}(t),p="operator"in t?t.operator:"",m="".concat(c).concat(u).concat(d).concat(n);return Object(o.jsx)("div",{"data-test-subj":"".concat(l||"").concat(m,"EntryContent"),key:m},Object(o.jsx)("div",{css:K},s?Object(o.jsx)(r.EuiFlexGroup,{responsive:!0,css:G,direction:"row",alignItems:"center",gutterSize:"m","data-test-subj":"".concat(l||"","NestedEntry")},Object(o.jsx)(r.EuiToken,{"data-test-subj":"nstedEntryIcon",iconType:"tokenNested",size:"s"}),Object(o.jsx)("div",{css:W},Object(o.jsx)(r.EuiExpression,{description:"",value:c,color:"subdued"}),Oe(u,p,d))):Object(o.jsx)(i.a.Fragment,null,Object(o.jsx)(r.EuiExpression,{description:0===n?"":me,value:c,color:0===n?"primary":"subdued","data-test-subj":"".concat(l||"","SingleEntry")}),Oe(u,p,d))))}));Ie.displayName="EntryContent";var Te=Object(a.memo)((function(e){var t=e.os,n=e.dataTestSubj,i=Object(a.useMemo)((function(){return t.map((function(e){var t;return null!==(t=xe[e])&&void 0!==t?t:e})).join(", ")}),[t]);return i?Object(o.jsx)("div",{"data-test-subj":"".concat(n||"","Os")},Object(o.jsx)("strong",null,Object(o.jsx)(r.EuiExpression,{"data-test-subj":"osLabel",description:"",value:ge}),Object(o.jsx)(r.EuiExpression,{"data-test-subj":"osValue",description:ne,value:i}))):null}));Te.displayName="OsCondition";var Ce=Object(a.memo)((function(e){var t=e.os,n=e.entries,a=e.dataTestSubj;return Object(o.jsx)(r.EuiPanel,{color:"subdued",hasBorder:!0,hasShadow:!1,"data-test-subj":a,className:Q},null!=t&&t.length?Object(o.jsx)(Te,{os:t,dataTestSubj:a}):null,n.map((function(e,t){var n="entries"in e?e.entries:[];return Object(o.jsx)("div",{key:"ExceptionItemCardConditionsContainer".concat(t)},Object(o.jsx)(Ie,{key:"entry".concat(t),entry:e,index:t,dataTestSubj:a}),null!=n&&n.length?n.map((function(e,n){return Object(o.jsx)(Ie,{key:"nestedEntry".concat(t).concat(n),entry:e,index:n,isNestedEntry:!0,dataTestSubj:a})})):null)})))}));Ce.displayName="ExceptionItemCardConditions";var Me=n(147),Ne=n.n(Me),De={name:"qeawqx",styles:"max-height:300px;height:100%;overflow-x:hidden;overflow-y:auto"},Fe=function(e){var t=e.text,n=e.dataTestSubj,i=e.actions,s=e.disableActions,l=e.emptyButton,c=e.useCustomActions,u=e.iconType,d=e.iconSide,p=void 0===d?"left":d,m=e.anchorPosition,g=void 0===m?"downCenter":m,f=e.panelPaddingSize,b=void 0===f?"s":f,y=Object(a.useState)(!1),h=Ne()(y,2),v=h[0],E=h[1],x=function(){return E((function(e){return!e}))},k=function(){return E(!1)},S=Object(a.useMemo)((function(){return c||null===i?i:i.map((function(e){return Object(o.jsx)(r.EuiContextMenuItem,{"data-test-subj":"".concat(n||"","ActionItem").concat(e.key),key:e.key,icon:e.icon,disabled:e.disabled,layoutAlign:"center",onClick:function(t){k(),"function"==typeof e.onClick&&e.onClick(t)}},e.label)}))}),[i,n,c]);return Object(o.jsx)(r.EuiFlexGroup,{responsive:!0},Object(o.jsx)(r.EuiPopover,{button:l?Object(o.jsx)(r.EuiButtonEmpty,{isDisabled:s,onClick:x,iconType:u||void 0,iconSide:p,"data-test-subj":"".concat(n||"","EmptyButton"),"aria-label":"Header menu Button Empty"},t):Object(o.jsx)(r.EuiButtonIcon,{isDisabled:s,onClick:x,iconType:u||"boxesHorizontal","data-test-subj":"".concat(n||"","ButtonIcon"),"aria-label":"Header menu Button Icon"},t),onClick:function(e){return e.stopPropagation()},panelPaddingSize:b,isOpen:v,closePopover:k,anchorPosition:g,"data-test-subj":"".concat(n||"","Items")},S?Object(o.jsx)(r.EuiContextMenuPanel,{css:De,className:"eui-scrollBar","data-test-subj":"".concat(n||"","MenuPanel"),size:"s",items:S}):null))};Fe.displayName="HeaderMenuComponent";var Ae=i.a.memo(Fe);Ae.displayName="HeaderMenu";var _e=Object(a.memo)((function(e){var t=e.item,n=e.actions,a=e.disableActions,i=void 0!==a&&a,s=e.dataTestSubj;return Object(o.jsx)(r.EuiFlexGroup,{responsive:!0,"data-test-subj":s,justifyContent:"spaceBetween"},Object(o.jsx)(r.EuiFlexItem,{grow:9},Object(o.jsx)(r.EuiTitle,{size:"xs",textTransform:"uppercase","data-test-subj":"".concat(s,"Title")},Object(o.jsx)("h3",null,t.name))),Object(o.jsx)(r.EuiFlexItem,{grow:!1},Object(o.jsx)(Ae,{iconType:"boxesHorizontal",disableActions:i,actions:n,"aria-label":"Exception item actions menu",dataTestSubj:s,anchorPosition:"downCenter"})))}));_e.displayName="ExceptionItemCardHeader";var Re=Object(o.css)("font-family:",p.euiThemeVars.euiFontFamily,";",""),Pe=Object(a.memo)((function(e){var t=e.label,n=e.lastUpdate,a=e.lastUpdateValue,i=e.dataTestSubj;return Object(o.jsx)(r.EuiFlexGroup,{"data-test-subj":"".concat(i||"","metaInfoDetails"),alignItems:"center",gutterSize:"s",wrap:!0,responsive:!0},Object(o.jsx)(r.EuiFlexItem,{grow:!1},Object(o.jsx)(r.EuiText,{size:"xs",css:Re},t)),Object(o.jsx)(r.EuiFlexItem,{grow:!1,"data-test-subj":"".concat(i||"","lastUpdate")},Object(o.jsx)(r.EuiBadge,{color:"default",css:Re},n)),Object(o.jsx)(r.EuiFlexItem,{grow:!1},Object(o.jsx)(r.EuiText,{size:"xs",css:Re},ee)),Object(o.jsx)(r.EuiFlexItem,{grow:!1,"data-test-subj":"".concat(i||"","lastUpdateValue")},Object(o.jsx)(r.EuiFlexGroup,{responsive:!0,gutterSize:"xs",alignItems:"center"},Object(o.jsx)(r.EuiFlexItem,{grow:!1},Object(o.jsx)(r.EuiBadge,{color:"hollow",css:Re},a)))))}));Pe.displayName="MetaInfoDetails";var Le=Object(o.css)("border-bottom:1px solid ",p.euiThemeVars.euiColorLightShade,";",""),qe=Object(o.css)("color:",p.euiThemeVars.euiColorPrimary,";flex-basis:content;",""),Be=function(e){var t=e.dataTestSubj,n=e.linkedRules,a=e.securityLinkAnchorComponent,i=e.leftIcon,s=void 0===i?"":i;if(!n.length||null===a)return null;var l=a;return n.map((function(e){return Object(o.jsx)(r.EuiContextMenuItem,{css:n.length>1?Le:"","data-test-subj":"".concat(t||"","ActionItem").concat(e.id),key:e.id},Object(o.jsx)(r.EuiFlexGroup,{gutterSize:"s",css:qe},s?Object(o.jsx)(r.EuiFlexItem,{"data-test-subj":"".concat(t||"","LeftIcon"),grow:!1},Object(o.jsx)(r.EuiIcon,{type:s})):null,Object(o.jsx)(r.EuiFlexItem,{css:qe},Object(o.jsx)(l,{external:!0,referenceName:e.name,referenceId:e.id}))))}))},ze=Object(o.css)("border-right:1px solid #d3dae6;padding:",p.euiThemeVars.euiSizeS," ",p.euiThemeVars.euiSizeM," ",p.euiThemeVars.euiSizeS," 0;",""),$e=Object(a.memo)((function(e){var t,n=e.item,s=e.rules,l=e.dataTestSubj,c=e.securityLinkAnchorComponent,u=e.formattedDateComponent,d=Object(a.useMemo)((function(){return Be({dataTestSubj:l,linkedRules:s,securityLinkAnchorComponent:c})}),[l,s,c]);return Object(o.jsx)(r.EuiFlexGroup,{alignItems:"center",responsive:!0,gutterSize:"s","data-test-subj":l},null!==u&&Object(o.jsx)(i.a.Fragment,null,Object(o.jsx)(r.EuiFlexItem,{css:ze,grow:!1},Object(o.jsx)(Pe,{label:X,lastUpdate:Object(o.jsx)(u,{"data-test-subj":"{dataTestSubj||''}formattedDateComponentCreatedBy",fieldName:"created_at",value:n.created_at}),lastUpdateValue:n.created_by,dataTestSubj:"".concat(l||"","CreatedBy")})),Object(o.jsx)(r.EuiFlexItem,{css:ze,grow:!1},Object(o.jsx)(Pe,{label:Z,lastUpdate:Object(o.jsx)(u,{"data-test-subj":"{dataTestSubj||''}formattedDateComponentUpdatedBy",fieldName:"updated_at",value:n.updated_at}),lastUpdateValue:n.updated_by,dataTestSubj:"".concat(l||"","UpdatedBy")}))),Object(o.jsx)(r.EuiFlexItem,null,Object(o.jsx)(Ae,{emptyButton:!0,useCustomActions:!0,iconType:"list",actions:d,disableActions:!1,text:(t=s.length,m.i18n.translate("exceptionList-components.exceptions.card.exceptionItem.affectedRules",{values:{numRules:t},defaultMessage:"Affects {numRules} {numRules, plural, =1 {rule} other {rules}}"})),dataTestSubj:l})))}));$e.displayName="ExceptionItemCardMetaInfo";var Ve=Object(o.css)("color:",p.euiThemeVars.euiColorPrimary,";",""),Ue=Object(a.memo)((function(e){var t=e.comments,n=e.dataTestSubj;return t.length?Object(o.jsx)(r.EuiFlexItem,{"data-test-subj":n},Object(o.jsx)(r.EuiAccordion,{id:"exceptionItemCardComments",buttonContent:Object(o.jsx)(r.EuiText,{size:"s",css:Ve,"data-test-subj":"".concat(n||"","TextButton")},te(t.length)),arrowDisplay:"none","data-test-subj":"exceptionItemCardComments"},Object(o.jsx)(r.EuiPanel,{"data-test-subj":"accordionContentPanel",hasBorder:!0,hasShadow:!0,paddingSize:"m"},Object(o.jsx)(r.EuiCommentList,{"data-test-subj":"accordionCommentList",comments:t})))):null}));Ue.displayName="ExceptionItemCardComments";var He=function(e){var t=e.disableActions,n=void 0!==t&&t,i=e.exceptionItem,s=e.listType,l=e.ruleReferences,c=e.dataTestSubj,u=e.editActionLabel,d=e.deleteActionLabel,p=e.securityLinkAnchorComponent,m=e.formattedDateComponent,g=e.getFormattedComments,f=e.onDeleteException,b=function(e){var t=e.listType,n=e.editActionLabel,i=e.deleteActionLabel,r=e.exceptionItem,o=e.getFormattedComments,s=e.onEditException,l=e.onDeleteException,c=Object(a.useCallback)((function(){l({id:r.id,name:r.name,namespaceType:r.namespace_type})}),[l,r.id,r.name,r.namespace_type]),u=Object(a.useCallback)((function(){s(r)}),[s,r]),d=Object(a.useMemo)((function(){return o(r.comments)}),[r.comments,o]);return{actions:Object(a.useMemo)((function(){return[{key:"edit",icon:"controlsHorizontal",label:n||Y(t),onClick:u},{key:"delete",icon:"trash",label:i||J(t),onClick:c}]}),[n,t,i,c,u]),formattedComments:d}}({listType:s,editActionLabel:u,deleteActionLabel:d,exceptionItem:i,getFormattedComments:g,onEditException:e.onEditException,onDeleteException:f}),y=b.actions,h=b.formattedComments;return Object(o.jsx)(r.EuiPanel,{key:"".concat(i.id,"exceptionItemPanel"),paddingSize:"l","data-test-subj":c||"",hasBorder:!0,hasShadow:!1},Object(o.jsx)(r.EuiFlexGroup,{responsive:!0,gutterSize:"m",direction:"column"},Object(o.jsx)(r.EuiFlexItem,{"data-test-subj":"exceptionItemCardHeaderContainer"},Object(o.jsx)(_e,{item:i,actions:y,disableActions:n,dataTestSubj:"exceptionItemCardHeader"})),Object(o.jsx)(r.EuiFlexItem,{"data-test-subj":"exceptionItemCardMeta"},Object(o.jsx)($e,{item:i,rules:l,dataTestSubj:"exceptionItemCardMetaInfo",securityLinkAnchorComponent:p,formattedDateComponent:m})),Object(o.jsx)(r.EuiFlexItem,{"data-test-subj":"exceptionItemCardCondition"},Object(o.jsx)(Ce,{os:i.os_types,entries:i.entries,dataTestSubj:"exceptionItemCardConditions"})),h.length>0&&Object(o.jsx)(Ue,{dataTestSubj:"exceptionsItemCommentAccordion",comments:h})))};He.displayName="ExceptionItemCardComponent";var Ge=i.a.memo(He);Ge.displayName="ExceptionItemCard";var Qe=n(265),We=Object(H.css)("display:inline;margin-left:",p.euiThemeVars.euiSizeXS,";",""),Ke=function(e){var t=e.value,n=e.tooltipIconType,a=void 0===n?"iInCircle":n,i=function(e){var t=e.value,n=e.tooltipIconText;return{showSpaceWarningIcon:!!(Array.isArray(t)?t.find(Qe.d):Object(Qe.d)(t)),warningText:n||Qe.c.FIELD_SPACE_WARNING}}({value:t,tooltipIconText:e.tooltipIconText}),s=i.showSpaceWarningIcon,l=i.warningText;return s&&t?Object(o.jsx)("div",{className:We},Object(o.jsx)(r.EuiToolTip,{position:"top",content:l},Object(o.jsx)(r.EuiIcon,{"data-test-subj":"valueWithSpaceWarningTooltip",type:a,color:"warning"}))):null},Ye=Object(o.css)("border-right:1px solid #d3dae6;padding:",p.euiThemeVars.euiSizeXS," ",p.euiThemeVars.euiSizeL," ",p.euiThemeVars.euiSizeXS," 0;",""),Je={name:"95qvyx",styles:"width:max-content"},Xe=Object(o.css)("font-size:",p.euiThemeVars.euiFontSize,";color:",p.euiThemeVars.euiTextSubduedColor,";margin-left:",p.euiThemeVars.euiSizeXS,";",""),Ze=Object(o.css)("margin-top:-",p.euiThemeVars.euiSizeL,";margin-bottom:-",p.euiThemeVars.euiSizeL,";",""),et=Object(o.css)("font-size:",p.euiThemeVars.euiFontSizeXS,";",""),tt=function(e){var t=e.dataTestSubj,n=e.linkedRules,i=e.securityLinkAnchorComponent,s=e.isReadonly,l=e.canUserEditList,c=void 0===l||l,u=e.onExportList,d=e.onDeleteList,p=e.onManageRules,m=Object(a.useMemo)((function(){return Be({leftIcon:"check",dataTestSubj:t,linkedRules:n,securityLinkAnchorComponent:i})}),[t,n,i]);return Object(o.jsx)(r.EuiFlexGroup,{direction:"row",alignItems:"baseline",justifyContent:"center",responsive:!0,"data-test-subj":"".concat(t||"","Container"),gutterSize:"l"},Object(o.jsx)(r.EuiFlexItem,{css:Ye},n.length?Object(o.jsx)(Ae,{dataTestSubj:"".concat(t||"","LinkedRulesMenu"),emptyButton:!0,useCustomActions:!0,text:S(n.length),actions:m,disableActions:!1,iconType:"arrowDown",iconSide:"right",panelPaddingSize:"none"}):Object(o.jsx)(r.EuiTextColor,{"data-test-subj":"noLinkedRules",css:Je,color:"subdued"},S(n.length))),c&&Object(o.jsx)(r.EuiFlexItem,null,Object(o.jsx)(r.EuiButton,{"data-test-subj":"".concat(t||"","ManageRulesButton"),fill:!0,onClick:function(){"function"==typeof u&&p()}},k)),Object(o.jsx)(r.EuiFlexItem,null,Object(o.jsx)(Ae,{iconType:"boxesHorizontal",dataTestSubj:"".concat(t||"","MenuActions"),actions:[{key:"1",icon:"exportAction",label:E,onClick:function(){"function"==typeof u&&u()}},{key:"2",icon:"trash",label:x,onClick:function(){"function"==typeof d&&d()},disabled:!c}],disableActions:s,anchorPosition:"downCenter"})))};tt.displayName="MenuItemsComponent";var nt=i.a.memo(tt);nt.displayName="MenuItems";var at=Object(o.css)("display:flex;width:fit-content;align-items:baseline;padding-bottom:",p.euiThemeVars.euiSizeS,";h1{margin-bottom:0;}",""),it=Object(o.css)("button{margin-left:-",p.euiThemeVars.euiSizeM,";}",""),rt=function(e){var t=e.isReadonly,n=e.dataTestSubj,a=e.text,i=e.onEdit,s=e.textCss;return Object(o.jsx)(r.EuiFlexGroup,{css:at},Object(o.jsx)(r.EuiFlexItem,{grow:10},Object(o.jsx)("span",{css:s,"data-test-subj":"".concat(n||"","Text")},a)),Object(o.jsx)(r.EuiFlexItem,{grow:!1,css:it},t?null:Object(o.jsx)(r.EuiButtonIcon,{"data-test-subj":"".concat(n||"","EditIcon"),"aria-label":"Edit Text List Header",iconType:"pencil",onClick:function(){return"function"==typeof i?i():null}})))};rt.displayName="TextWithEditComponent";var ot=i.a.memo(rt);ot.displayName="TextWithEdit";var st=n(216),lt=n.n(st),ct=function(e){var t,n=e.listDetails,i=e.onSave,s=e.onCancel,l=function(e){var t=e.listDetails,n=e.onSave,i=Object(r.useGeneratedHtmlId)({prefix:"modalForm"}),o=Object(a.useState)(t),s=Ne()(o,2),l=s[0],c=s[1],u=Object(a.useState)(!1),d=Ne()(u,2),p=d[0],m=d[1],g=Object(a.useState)(void 0),f=Ne()(g,2),b=f[0],y=f[1],h=Object(a.useCallback)((function(e){var t=e.target,n=t.name,a=t.value.trim();c(lt()(lt()({},l),{},ve()({},n,a))),"name"===n&&y(a?void 0:D)}),[l]);return{error:b,modalFormId:i,newListDetails:l,showProgress:p,onBlur:h,onChange:function(e){var t=e.target,n=t.name,a=t.value;c(lt()(lt()({},l),{},ve()({},n,a)))},onSubmit:function(e){b||(m(!0),n(l),null==e||e.preventDefault())}}}({listDetails:n,onSave:i}),c=l.error,u=l.modalFormId,d=l.newListDetails,p=l.showProgress,g=l.onBlur,f=l.onSubmit,b=l.onChange;return Object(o.jsx)(r.EuiModal,{"data-test-subj":"EditModal",onClose:s,initialFocus:"[name=popswitch]"},p&&Object(o.jsx)(r.EuiProgress,{"data-test-subj":"editModalProgess",size:"xs",position:"absolute"}),Object(o.jsx)(r.EuiModalHeader,null,Object(o.jsx)(r.EuiModalHeaderTitle,{"data-test-subj":"editModalTitle"},Object(o.jsx)("h1",null,(t=n.name,m.i18n.translate("exceptionList-components.exception_list_header_edit_modal_name",{defaultMessage:"Edit {listName}",values:{listName:t}}))))),Object(o.jsx)(r.EuiModalBody,null,Object(o.jsx)(r.EuiForm,{id:u,"data-test-subj":"editModalForm",component:"form",onSubmit:f},Object(o.jsx)(r.EuiFormRow,{error:c,isInvalid:!!c,fullWidth:!0,label:M},Object(o.jsx)(r.EuiFieldText,{fullWidth:!0,isInvalid:!!c,onBlur:g,"data-test-subj":"editModalNameTextField",name:"name",value:d.name,onChange:b})),Object(o.jsx)(r.EuiFormRow,{fullWidth:!0,label:N},Object(o.jsx)(r.EuiTextArea,{fullWidth:!0,"data-test-subj":"editModalDescriptionTextField",name:"description",value:d.description,onChange:b,onBlur:g})))),Object(o.jsx)(r.EuiModalFooter,null,Object(o.jsx)(r.EuiButtonEmpty,{"data-test-subj":"editModalCancelBtn",onClick:s},C),Object(o.jsx)(r.EuiButton,{"data-test-subj":"editModalSaveBtn",type:"submit",form:u,onClick:f,fill:!0},T)))};ct.displayName="EditModalComponent";var ut=i.a.memo(ct);ut.displayName="EditModal";var dt=function(e){var t=e.name,n=e.description,i=e.listId,s=e.linkedRules,l=e.isReadonly,c=e.dataTestSubj,u=e.securityLinkAnchorComponent,d=e.backOptions,p=e.canUserEditList,m=void 0===p||p,g=e.onEditListDetails,f=e.onExportList,b=e.onDeleteList,y=e.onManageRules,h=function(e){var t=e.name,n=e.description,i=e.onEditListDetails,r=Object(a.useState)(!1),o=Ne()(r,2),s=o[0],l=o[1],c=Object(a.useState)({name:t,description:n}),u=Ne()(c,2),d=u[0],p=u[1];return{isModalVisible:s,listDetails:d,onEdit:function(){l(!0)},onSave:function(e){p(e),"function"==typeof i&&i(e),setTimeout((function(){l(!1)}),200)},onCancel:function(){l(!1)}}}({name:t,description:n,onEditListDetails:g}),v=h.isModalVisible,E=h.listDetails,x=h.onEdit,k=h.onSave,S=h.onCancel;return Object(o.jsx)("div",null,Object(o.jsx)(r.EuiPageHeader,{bottomBorder:!0,paddingSize:"none",pageTitle:Object(o.jsx)(ot,{dataTestSubj:"".concat(c||"","Title"),text:E.name||O,isReadonly:l||!m,onEdit:x}),responsive:!0,"data-test-subj":"".concat(c||"","PageHeader"),description:Object(o.jsx)("div",{css:Ze},Object(o.jsx)(ot,{dataTestSubj:"".concat(c||"","Description"),textCss:Xe,isReadonly:l||!m,text:E.description||I,onEdit:x}),Object(o.jsx)("div",{css:at,"data-test-subj":"".concat(c||"","ListID")},Object(o.jsx)(r.EuiText,{css:Xe},j,":"),Object(o.jsx)(r.EuiText,{css:Xe},i))),rightSideItems:[Object(o.jsx)(nt,{dataTestSubj:"".concat(c||"","RightSideMenuItems"),linkedRules:s,isReadonly:l,canUserEditList:m,securityLinkAnchorComponent:u,onExportList:f,onDeleteList:b,onManageRules:y})],breadcrumbs:[{text:Object(o.jsx)("div",{"data-test-subj":"".concat(c||"","Breadcrumb"),css:et},Object(o.jsx)(r.EuiIcon,{size:"s",type:"arrowLeft"}),w),color:"primary","aria-current":!1,href:d.path,onClick:function(e){e.preventDefault(),d.onNavigate(d.path)}}]}),v&&Object(o.jsx)(ut,{listDetails:E,onSave:k,onCancel:S}))};dt.displayName="ExceptionListHeaderComponent";var pt=i.a.memo(dt);pt.displayName="ExceptionListHeader"},function(e,t,n){"use strict";n.d(t,"a",(function(){return ye}));var a=n(32),i=n(34),r=n(4),o=n.n(r),s=n(140),l=n(88),c=n(624),u=n(305),d=n(87),p=n(101),m=n(78),g=n(92),f=n.n(g),b=n(38),y=n(99),h=n(192),v=n(133),E=n(102),x=n(636),k=n(106),S=n(150),w=n(79),j=n(228),O=n(89);const I=({contextId:e,eventId:t,fieldName:n,address:a})=>`formatted-ip-data-provider-${e}-${n}-${a}-${t}`,T=({contextId:e,eventId:t,fieldName:n,address:a})=>({enabled:!0,id:Object(E.h)(I({contextId:e,eventId:t,fieldName:n,address:a})),name:`${n}: ${Object(x.a)(a)}`,queryMatch:{field:n,value:Object(x.a)(a),operator:k.d},excluded:!1,kqlQuery:"",and:[]}),C=({contextId:e,eventId:t,fieldName:n,fieldType:a,isAggregatable:i,isDraggable:s,truncate:l,value:c})=>{const u=Object(r.useMemo)((()=>`non-decorated-ip-draggable-wrapper-${I({contextId:e,eventId:t,fieldName:n,address:c})}`),[e,t,n,c]),p=Object(r.useMemo)((()=>T({contextId:e,eventId:t,fieldName:n,address:c})),[e,t,n,c]),m=Object(r.useMemo)((()=>"object"!=typeof c?Object(d.f)(c):Object(d.f)((e=>{try{return JSON.stringify(e)}catch(t){return`${e}`}})(c))),[c]),g=Object(r.useCallback)(((e,t,n)=>n.isDragging?o.a.createElement(v.a,null,o.a.createElement(S.a,{dataProvider:e})):m),[m]);return s?o.a.createElement(v.b,{dataProvider:p,fieldType:a,isAggregatable:i,isDraggable:s,key:u,render:g,truncate:l}):m},M=o.a.memo(C),N=({address:e,Component:t,contextId:n,eventId:a,fieldName:i,fieldType:s,isAggregatable:c,isButton:u,isDraggable:d,onClick:p,truncate:g,title:f})=>{const E=`address-links-draggable-wrapper-${I({contextId:n,eventId:a,fieldName:i,address:e})}`,x=Object(r.useMemo)((()=>T({contextId:n,eventId:a,fieldName:i,address:e})),[e,n,a,i]),k=Object(m.useDispatch)(),C=Object(r.useContext)(b.StatefulEventContext),M=e&&(null==C?void 0:C.enableIpDetailsFlyout)&&(null==C?void 0:C.timelineID),N=Object(r.useCallback)((t=>{if(t.preventDefault(),p&&p(),C&&M){const{tabType:t,timelineID:n}=C,a={panelView:"networkDetail",params:{ip:e,flowTarget:i.includes(h.b.destination)?h.b.destination:h.b.source}},r=Object(y.getScopedActions)(n);r&&k(r.toggleDetailPanel({...a,id:n,tabType:t})),n===w.j.active&&t===w.m.query&&j.a.toggleExpandedDetail({...a})}}),[p,C,M,e,i,k]),D=Object(r.useMemo)((()=>t?o.a.createElement(O.h,{Component:t,ip:e,isButton:u,onClick:M?N:void 0,title:f}):o.a.createElement(l.a,{field:i,tooltipContent:i},o.a.createElement(O.h,{Component:t,ip:e,isButton:u,onClick:M?N:void 0,title:f}))),[t,e,i,u,M,N,f]),F=Object(r.useCallback)(((e,t,n)=>n.isDragging?o.a.createElement(v.a,null,o.a.createElement(S.a,{dataProvider:x})):D),[x,D]);return d?o.a.createElement(v.b,{dataProvider:x,isDraggable:d,fieldType:s,isAggregatable:c,key:E,render:F,truncate:g}):D},D=o.a.memo(N),F=({addresses:e,Component:t,contextId:n,eventId:a,fieldName:s,fieldType:l,isAggregatable:c,isButton:u,isDraggable:d,onClick:p,truncate:m,title:g})=>{const f=Object(r.useMemo)((()=>Object(i.uniq)(e)),[e]),b=Object(r.useMemo)((()=>f.map((e=>o.a.createElement(D,{key:e,address:e,Component:t,contextId:n,eventId:a,fieldName:s,fieldType:l,isAggregatable:c,isButton:u,isDraggable:d,onClick:p,truncate:m,title:g})))),[t,n,a,s,l,c,u,d,p,g,m,f]);return o.a.createElement(o.a.Fragment,null,b)},A=o.a.memo(F,((e,t)=>e.contextId===t.contextId&&e.eventId===t.eventId&&e.fieldName===t.fieldName&&e.isAggregatable===t.isAggregatable&&e.fieldType===t.fieldType&&e.isDraggable===t.isDraggable&&e.truncate===t.truncate&&f()(e.addresses,t.addresses))),_=({Component:e,contextId:t,eventId:n,fieldName:a,fieldType:r,isAggregatable:s,isDraggable:l,isButton:c,onClick:u,title:d,truncate:p,value:m})=>{if(Object(i.isString)(m)&&!Object(i.isEmpty)(m)){try{const g=JSON.parse(m);if(Object(i.isArray)(g))return o.a.createElement(A,{addresses:g,Component:e,contextId:t,eventId:n,fieldName:a,fieldType:r,isAggregatable:s,isButton:c,isDraggable:l,onClick:u,title:d,truncate:p})}catch(e){}return o.a.createElement(A,{addresses:[m],Component:e,contextId:t,eventId:n,isButton:c,isDraggable:l,onClick:u,fieldName:a,fieldType:r,isAggregatable:s,truncate:p,title:d})}return o.a.createElement(M,{contextId:t,eventId:n,fieldName:a,fieldType:r,isAggregatable:s,isDraggable:l,truncate:p,value:m})},R=o.a.memo(_,((e,t)=>e.contextId===t.contextId&&e.eventId===t.eventId&&e.fieldName===t.fieldName&&e.isAggregatable===t.isAggregatable&&e.fieldType===t.fieldType&&e.isDraggable===t.isDraggable&&e.truncate===t.truncate&&f()(e.value,t.value)));var P=n(470),L=n(258),q=n(203),B=n(176),z=n(33),$=n.n(z),V=n(156),U=n(191),H=n(953),G=n.n(H),Q=n(260),W=n(2),K=n(128),Y=n(77),J=n(1),X=n(744);const Z=$()(a.EuiFlexItem).withConfig({displayName:"EventModuleFlexItem",componentId:"sc-14rc58n-0"})(["width:100%;"]),ee=({children:e,Component:t,contextId:n,eventId:a,fieldName:s,fieldType:c,isAggregatable:u,isDraggable:p,isButton:m,onClick:g,linkValue:f,truncate:b,title:y,value:h})=>{const v=`${h}`,E=f,{search:x}=Object(K.n)(W.a.rules),{navigateToApp:k,getUrlForApp:S}=Object(Y.k)().services.application,w=Object(r.useCallback)((e=>{e.preventDefault(),k(J.B,{deepLinkId:W.a.rules,path:Object(V.d)(null!=E?E:"",x)})}),[k,E,x]),j=Object(r.useMemo)((()=>S(J.B,{deepLinkId:W.a.rules,path:Object(V.d)(null!=E?E:"",x)})),[S,E,x]),I=`event-details-value-default-draggable-${n}-${a}-${s}-${h}-${E}`,T=Object(r.useMemo)((()=>{const n=b?o.a.createElement(q.b,{dataTestSubj:`formatted-field-${s}`},h):h;return m?o.a.createElement(X.b,{Component:t,dataTestSubj:"data-grid-host-details",href:j,iconType:"expand",onClick:null!=g?g:w,title:null!=y?y:v},e):t?o.a.createElement(t,{"aria-label":y,"data-test-subj":`view-${s}`,iconType:"link",onClick:w,title:y},null!=y?y:h):o.a.createElement(O.f,{onClick:w,href:j,"data-test-subj":"ruleName"},n)}),[t,e,s,w,j,m,g,v,y,b,h]);return Object(i.isString)(h)&&v.length>0&&null!=E?p?o.a.createElement(l.b,{field:s,fieldType:c,isAggregatable:u,id:I,isDraggable:p,tooltipContent:h,value:h},T):T:null!=h?p?o.a.createElement(l.b,{field:s,fieldType:c,isAggregatable:u,id:I,isDraggable:p,tooltipContent:h,value:`${h}`},h):o.a.createElement(o.a.Fragment,null,h):Object(d.d)()},te=({children:e,Component:t,dataTestSubj:n,href:i,onClick:r,title:s,iconType:l="link"})=>t?o.a.createElement(t,{"data-test-subj":n,href:i,iconType:l,onClick:r,title:s},null!=s?s:e):o.a.createElement(a.EuiLink,{"data-test-subj":n,target:"_blank",href:i},null!=s?s:e),ne=o.a.memo(te),ae={open:"primary",acknowledged:"warning",closed:"default"},ie=$()(a.EuiBadge).withConfig({displayName:"StyledEuiBadge",componentId:"sc-1mc1lk7-0"})(["text-transform:capitalize;"]),re=({contextId:e,eventId:t,fieldName:n,fieldType:a,isAggregatable:s,isDraggable:c,value:u,onClick:d,onClickAriaLabel:p,iconSide:m,iconType:g})=>{const f=Object(r.useMemo)((()=>Object(i.getOr)("default",`${u}`,ae)),[u]),b=o.a.createElement(ie,{color:f,onClick:d,onClickAriaLabel:p,iconType:g,iconSide:m},u);return c?o.a.createElement(l.b,{field:n,id:`alert-details-value-default-draggable-${e}-${t}-${n}-${u}`,fieldType:a,isAggregatable:s,isDraggable:!1,value:`${u}`,tooltipContent:n},b):b},oe=o.a.memo(re);oe.displayName="RuleStatus";const se=({fieldName:e,fieldType:t,isAggregatable:n,Component:a,contextId:s,eventId:c,isDraggable:u,isButton:p,onClick:g,title:f,value:h})=>{const v=Object(m.useDispatch)(),E=Object(r.useContext)(b.StatefulEventContext),x=`${h}`,k=x&&(null==E?void 0:E.enableHostDetailsFlyout)&&(null==E?void 0:E.timelineID),S=Object(r.useCallback)((e=>{if(e.preventDefault(),g&&g(),E&&k){const{timelineID:e,tabType:t}=E,n={panelView:"hostDetail",params:{hostName:x}},a=Object(y.getScopedActions)(e);a&&v(a.toggleDetailPanel({...n,id:e,tabType:t})),e===w.j.active&&t===w.m.query&&j.a.toggleExpandedDetail({...n})}}),[g,E,k,x,v]),I=Object(r.useMemo)((()=>o.a.createElement(O.d,{Component:a,hostName:x,isButton:p,onClick:k?S:void 0,title:f},o.a.createElement(q.b,{"data-test-subj":"draggable-truncatable-content"},x))),[a,x,p,k,S,f]);return Object(i.isString)(h)&&x.length>0?u?o.a.createElement(l.b,{field:e,fieldType:t,isAggregatable:n,id:`event-details-value-default-draggable-${s}-${c}-${e}-${h}`,isDraggable:u,tooltipContent:e,value:x},I):I:Object(d.d)()},le=o.a.memo(se);le.displayName="HostName";var ce=n(246),ue=n(637),de=n(638);const pe=o.a.memo((({fieldName:e,contextId:t,eventId:n,fieldType:i,isAggregatable:r,isDraggable:s,value:l})=>{const{isIsolated:c,agentStatus:u,pendingIsolation:d,pendingUnisolation:p}=Object(ue.a)({agentId:l});return o.a.createElement(a.EuiFlexGroup,{gutterSize:"none"},void 0!==u?o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(de.a,{hostStatus:u})):o.a.createElement(a.EuiText,null,o.a.createElement("p",null,Q.b)),o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(ce.b,{isIsolated:c,pendingActions:{pendingIsolate:d,pendingUnIsolate:p}})))}));pe.displayName="AgentStatuses";const me=({fieldName:e,Component:t,contextId:n,eventId:a,fieldType:s,isAggregatable:c,isDraggable:u,isButton:p,onClick:g,title:f,value:h})=>{const v=Object(m.useDispatch)(),E=Object(r.useContext)(b.StatefulEventContext),x=`${h}`,k=x&&(null==E?void 0:E.timelineID),S=Object(r.useCallback)((e=>{if(e.preventDefault(),g&&g(),E&&k){const{timelineID:e,tabType:t}=E,n={panelView:"userDetail",params:{userName:x}},a=Object(y.getScopedActions)(e);a&&v(a.toggleDetailPanel({...n,id:e,tabType:t})),e===w.j.active&&t===w.m.query&&j.a.toggleExpandedDetail({...n})}}),[g,E,k,x,v]),I=Object(r.useMemo)((()=>o.a.createElement(O.m,{Component:t,userName:x,isButton:p,onClick:k?S:void 0,title:f},o.a.createElement(q.b,{"data-test-subj":"draggable-truncatable-content"},x))),[x,p,k,S,t,f]);return Object(i.isString)(h)&&x.length>0?u?o.a.createElement(l.b,{field:e,id:`event-details-value-default-draggable-${n}-${a}-${e}-${h}`,fieldType:s,isAggregatable:c,isDraggable:u,tooltipContent:e,value:x},I):I:Object(d.d)()},ge=o.a.memo(me);ge.displayName="UserName";const fe=[B.h],be=({asPlainText:e,Component:t,contextId:n,eventId:r,fieldFormat:m,isAggregatable:g=!1,fieldName:f,fieldType:b="",isButton:y,isObjectArray:h=!1,isDraggable:v=!0,onClick:E,onClickAriaLabel:x,title:k,truncate:S=!0,value:w,linkValue:j})=>{if(h||e)return o.a.createElement("span",{"data-test-subj":`formatted-field-${f}`},w);if(b===B.g)return o.a.createElement(R,{Component:t,eventId:r,contextId:n,fieldName:f,fieldType:b,isAggregatable:g,isButton:y,isDraggable:v,value:Object(i.isNumber)(w)?String(w):w,onClick:E,title:k,truncate:S});if(b===B.e)return o.a.createElement(o.a.Fragment,null,w);if(b===B.b){const e=S?"eui-textTruncate eui-alignMiddle":void 0;return v?o.a.createElement(l.b,{field:f,fieldType:b,isAggregatable:g,id:`event-details-value-default-draggable-${n}-${r}-${f}-${w}`,isDraggable:v,tooltipContent:null,value:`${w}`},o.a.createElement(p.a,{className:e,fieldName:f,value:w})):o.a.createElement(p.a,{className:e,fieldName:f,value:w})}if(L.b.some((e=>f===e)))return o.a.createElement(P.a,{Component:t,contextId:n,eventId:r,fieldName:f,fieldType:b,isAggregatable:g,isDraggable:v,title:k,value:`${w}`});if(f===u.b)return o.a.createElement(u.a,{contextId:n,eventId:r,fieldName:f,fieldType:b,isAggregatable:g,isDraggable:v,value:`${w}`});if(f===B.f)return o.a.createElement(le,{Component:t,contextId:n,eventId:r,fieldType:b,isAggregatable:g,fieldName:f,isDraggable:v,isButton:y,onClick:E,title:k,value:w});if(f===B.n)return o.a.createElement(ge,{Component:t,contextId:n,eventId:r,fieldName:f,fieldType:b,isAggregatable:g,isDraggable:v,isButton:y,onClick:E,title:k,value:w});if(m===c.a)return o.a.createElement(c.b,{contextId:n,eventId:r,fieldName:f,fieldType:b,isAggregatable:g,isDraggable:v,value:`${w}`});if(f===B.l)return o.a.createElement(ee,{Component:t,contextId:n,eventId:r,fieldName:f,fieldType:b,isAggregatable:g,isDraggable:v,isButton:y,onClick:E,linkValue:j,title:k,truncate:S,value:w});if(f===B.c)return(({contextId:e,eventId:t,fieldName:n,fieldType:r,isAggregatable:s,isDraggable:c,linkValue:u,truncate:p,value:m})=>{const g=`${m}`,f=u,b=p?o.a.createElement(q.b,null,m):m;return Object(i.isString)(m)&&g.length>0?o.a.createElement(a.EuiFlexGroup,{gutterSize:"none",alignItems:"center",justifyContent:null==f||Object(i.isEmpty)(f)?"spaceBetween":"flexStart"},o.a.createElement(Z,null,c?o.a.createElement(l.b,{field:n,id:`event-details-value-default-draggable-${e}-${t}-${n}-${m}-${g}`,fieldType:r,isAggregatable:s,isDraggable:c,tooltipContent:m,value:m},b):o.a.createElement(o.a.Fragment,null,b)),null!=f&&((e,t)=>"endgame"===e.trim().toLocaleLowerCase()&&null!=t&&!Object(i.isEmpty)(t)&&!Object(U.c)(t)&&t.includes("/alerts/"))(g,f)&&o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(a.EuiToolTip,{"data-test-subj":"event-module-link-to-elastic-endpoint-security",content:o.a.createElement(o.a.Fragment,null,o.a.createElement("p",null,Q.e),o.a.createElement("p",null,f))},o.a.createElement(a.EuiLink,{href:f,target:"_blank"},o.a.createElement(a.EuiIcon,{type:G.a,size:"m"}))))):Object(d.d)()})({contextId:n,eventId:r,fieldName:f,fieldType:b,isAggregatable:g,isDraggable:v,linkValue:j,truncate:S,value:w});if(f===B.m)return o.a.createElement(oe,{contextId:n,eventId:r,fieldName:f,fieldType:b,isAggregatable:g,isDraggable:v,value:w,onClick:E,onClickAriaLabel:x,iconType:y?"arrowDown":void 0,iconSide:y?"right":void 0});if(f===B.a)return o.a.createElement(pe,{contextId:n,eventId:r,fieldName:f,fieldType:b,isAggregatable:g,isDraggable:v,value:"string"==typeof w?w:""});if([B.k,B.j,B.d,s.j].includes(f))return(({contextId:e,Component:t,eventId:n,fieldName:a,fieldType:r,isAggregatable:s,isDraggable:c,truncate:u,title:p,value:m})=>{const g=`${m}`,f=!Object(U.c)(g),b=u?o.a.createElement(q.b,null,m):m,y=f?o.a.createElement(ne,{Component:t,href:g,dataTestSubj:"ata-grid-url",title:p,iconType:"link"}):o.a.createElement(o.a.Fragment,null,b);return Object(i.isString)(m)&&g.length>0?c?o.a.createElement(l.b,{field:a,fieldType:r,isAggregatable:s,id:`event-details-value-default-draggable-${e}-${n}-${a}-${m}-${g}`,isDraggable:c,tooltipContent:m,value:m},y):y:Object(d.d)()})({contextId:n,Component:t,eventId:r,fieldName:f,fieldType:b,isAggregatable:g,isDraggable:v,truncate:S,title:k,value:w});if(fe.includes(f)||!v)return S&&!Object(i.isEmpty)(w)?o.a.createElement(q.b,{"data-test-subj":"truncatable-message"},o.a.createElement(a.EuiToolTip,{"data-test-subj":"message-tool-tip",content:o.a.createElement(a.EuiFlexGroup,{direction:"column",gutterSize:"none"},o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement("span",null,f)),o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement("span",null,w)))},o.a.createElement("span",{"data-test-subj":`formatted-field-${f}`},w))):o.a.createElement("span",{"data-test-subj":`formatted-field-${f}`},w);{const e=Object(d.f)(w),t=S?o.a.createElement(q.b,null,e):e;return o.a.createElement(l.b,{field:f,id:`event-details-value-default-draggable-${n}-${r}-${f}-${w}`,fieldType:null!=b?b:"",isAggregatable:g,isDraggable:v,value:`${w}`,tooltipContent:b===B.b||b===u.b?null:f},t)}},ye=o.a.memo(be)},function(e,t,n){"use strict";n.d(t,"a",(function(){return k}));var a=n(32),i=n(34),r=n(4),o=n.n(r),s=n(33),l=n.n(s),c=n(1),u=n(119),d=n(187),p=n(324),m=n(0);const g=m.i18n.translate("xpack.securitySolution.paginatedTable.showingSubtitle",{defaultMessage:"Showing"}),f=m.i18n.translate("xpack.securitySolution.paginatedTable.rowsButtonLabel",{defaultMessage:"Rows per page"}),b=m.i18n.translate("xpack.securitySolution.paginatedTable.tooManyResultsToastTitle",{defaultMessage:" - too many results"}),y=m.i18n.translate("xpack.securitySolution.paginatedTable.tooManyResultsToastText",{defaultMessage:"Narrow your query to better filter the results"});var h=n(318),v=n(124),E=n(109);const x=({activePage:e,columns:t,dataTestSubj:n="paginated-table",headerCount:s,headerFilters:l,headerSupplement:m,headerTitle:x,headerTooltip:k,headerUnit:O,headerSubtitle:I,id:T,isInspect:C,itemsPerRow:M,limit:N,loading:D,loadPage:F,onChange:A=i.noop,pageOfItems:_,setQuerySkip:R,showMorePagesIndicator:P,sorting:L=null,split:q,stackHeader:B,totalCount:z,updateActivePage:$,updateLimitPagination:V})=>{const[U,H]=Object(r.useState)(D),[G,Q]=Object(r.useState)(e),[W,K]=Object(r.useState)(-1===s),[Y,J]=Object(r.useState)(!1),X=Math.ceil(z/N),Z=Object(p.g)()[1];Object(r.useEffect)((()=>{Q(e)}),[e]),Object(r.useEffect)((()=>{s>=0&&W&&K(!1)}),[W,s]),Object(r.useEffect)((()=>{H(D)}),[D]);const ee=()=>{J(!1)},te=o.a.createElement(a.EuiButtonEmpty,{size:"xs",color:"text",iconType:"arrowDown",iconSide:"right",onClick:()=>{J(!Y)}},`${f}: ${N}`),ne=M&&M.map((e=>o.a.createElement(a.EuiContextMenuItem,{key:e.text,icon:N===e.numberOfRow?"check":"empty",onClick:()=>{ee(),V(e.numberOfRow),$(0)}},e.text))),ae=P?j:a.EuiFlexItem,ie=Object(r.useMemo)((()=>L?{sort:{field:L.field,direction:L.direction}}:void 0),[L]),{toggleStatus:re,setToggleStatus:oe}=Object(E.a)(T),se=Object(r.useCallback)((e=>{oe(e),R(!e)}),[R,oe]);return o.a.createElement(v.c,{show:!W},o.a.createElement(h.a,{"data-test-subj":`${n}-loading-${D}`,loading:D},o.a.createElement(u.a,{toggleStatus:re,toggleQuery:se,headerFilters:l,id:T,split:q,stackHeader:B,subtitle:!W&&I?`${g}: ${I}`:O&&`${g}: ${s>=0?s.toLocaleString():0} ${O}`,title:x,tooltip:k},!W&&m),re&&(W?o.a.createElement(a.EuiLoadingContent,{"data-test-subj":"initialLoadingPanelPaginatedTable",lines:10}):o.a.createElement(o.a.Fragment,null,o.a.createElement(S,{"data-test-subj":"paginated-basic-table",columns:t,items:_,onChange:A,sorting:ie}),o.a.createElement(w,null,o.a.createElement(a.EuiFlexItem,null,M&&M.length>0&&z>=M[0].numberOfRow&&o.a.createElement(a.EuiPopover,{id:"customizablePagination","data-test-subj":"loadingMoreSizeRowPopover",button:te,isOpen:Y,closePopover:ee,panelPaddingSize:"none",repositionOnScroll:!0},o.a.createElement(a.EuiContextMenuPanel,{items:ne,"data-test-subj":"loadingMorePickSizeRow"}))),o.a.createElement(ae,{grow:!1},z>0&&o.a.createElement(a.EuiPagination,{"data-test-subj":"numberedPagination",pageCount:X,activePage:G,onPageClick:e=>{if((e+1)*N>=c.Y)return Z({type:"addToaster",toast:{id:"PaginationWarningMsg",title:x+b,color:"warning",iconType:"alert",toastLifeTimeMs:1e4,text:y}});Q(e),F(e),$(e)}}))),(C||U)&&o.a.createElement(d.a,{"data-test-subj":"loadingPanelPaginatedTable",overlay:!0,size:"xl"})))))},k=Object(r.memo)(x),S=l()(a.EuiBasicTable).withConfig({displayName:"BasicTable",componentId:"sc-53ob89-0"})(["tbody{th,td{vertical-align:top;}.euiTableCellContent{display:block;}}"]);S.displayName="BasicTable";const w=l()(a.EuiFlexGroup).attrs((()=>({alignItems:"center",responsive:!1}))).withConfig({displayName:"FooterAction",componentId:"sc-53ob89-1"})(["margin-top:",";"],(({theme:e})=>e.eui.euiSizeXS));w.displayName="FooterAction";const j=l()(a.EuiFlexItem).withConfig({displayName:"PaginationEuiFlexItem",componentId:"sc-53ob89-2"})(["@media only screen and (min-width:","){.euiButtonIcon:last-child{margin-left:28px;}.euiPagination{position:relative;}.euiPagination::before{bottom:0;color:",";content:'\\2026';font-size:",";padding:5px ",";position:absolute;right:",";}}"],(({theme:e})=>e.eui.euiBreakpoints.m),(({theme:e})=>e.eui.euiButtonColorDisabled),(({theme:e})=>e.eui.euiFontSizeS),(({theme:e})=>e.eui.euiSizeS),(({theme:e})=>e.eui.euiSizeL));j.displayName="PaginationEuiFlexItem"},function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return p}));var a=n(34),i=n(4),r=n(815),o=n.n(r),s=n(49),l=n(58),c=n.n(l);const u=(e,t)=>{const n=null!=t?t:((e,t)=>{const n=t.diff(e,"days");return n<=1&&!e.isSame(t)?2:n})(c()(e[0]),c()(e[1])),a=Object(s.niceTimeFormatByDay)(n);return Object(s.timeFormatter)(a)},d=(e=100)=>{const[t,n]=Object(i.useState)({width:0,height:0}),r=Object(i.useMemo)((()=>Object(a.throttle)(e,n)),[e]),{ref:s}=o()({onResize:r});return{ref:s,...t}},p=(e,t,n,a)=>{Object(i.useEffect)((()=>{!async function(){const i=await(null==e?void 0:e.getVariation(t,n));i&&a(i)}()}),[e,t,n,a])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var a=n(34),i=n(4),r=n.n(i),o=n(351),s=n(515),l=n(305),c=n(473),u=n(306),d=n(516),p=n(693),m=n(476),g=n(258),f=n(474),b=n(423),y=n(359);const h=r.a.memo((({data:e,timelineId:t,isDraggable:n})=>r.a.createElement(p.a,{contextId:`netflow-renderer-${t}-${e._id}`,destinationBytes:Object(o.a)(Object(a.get)(b.a,e)),destinationGeoContinentName:Object(o.a)(Object(a.get)(f.b,e)),destinationGeoCountryName:Object(o.a)(Object(a.get)(f.d,e)),destinationGeoCountryIsoCode:Object(o.a)(Object(a.get)(f.c,e)),destinationGeoRegionName:Object(o.a)(Object(a.get)(f.e,e)),destinationGeoCityName:Object(o.a)(Object(a.get)(f.a,e)),destinationIp:Object(o.a)(Object(a.get)(u.a,e)),destinationPackets:Object(o.a)(Object(a.get)(b.b,e)),destinationPort:Object(o.a)(Object(a.get)(g.a,e)),eventDuration:Object(o.a)(Object(a.get)(l.b,e)),eventId:Object(a.get)(c.a,e),eventEnd:Object(o.a)(Object(a.get)(m.b,e)),eventStart:Object(o.a)(Object(a.get)(m.c,e)),isDraggable:n,networkBytes:Object(o.a)(Object(a.get)(y.a,e)),networkCommunityId:Object(o.a)(Object(a.get)(y.b,e)),networkDirection:Object(o.a)(Object(a.get)(y.c,e)),networkPackets:Object(o.a)(Object(a.get)(y.d,e)),networkProtocol:Object(o.a)(Object(a.get)(y.e,e)),sourceBytes:Object(o.a)(Object(a.get)(b.c,e)),sourceGeoContinentName:Object(o.a)(Object(a.get)(f.h,e)),sourceGeoCountryName:Object(o.a)(Object(a.get)(f.j,e)),sourceGeoCountryIsoCode:Object(o.a)(Object(a.get)(f.i,e)),sourceGeoRegionName:Object(o.a)(Object(a.get)(f.k,e)),sourceGeoCityName:Object(o.a)(Object(a.get)(f.g,e)),sourceIp:Object(o.a)(Object(a.get)(u.d,e)),sourcePackets:Object(o.a)(Object(a.get)(b.d,e)),sourcePort:Object(o.a)(Object(a.get)(g.c,e)),tlsClientCertificateFingerprintSha1:Object(o.a)(Object(a.get)(s.b,e)),tlsFingerprintsJa3Hash:Object(o.a)(Object(a.get)(d.a,e)),tlsServerCertificateFingerprintSha1:Object(o.a)(Object(a.get)(s.c,e)),transport:Object(o.a)(Object(a.get)(y.f,e)),userName:void 0})));h.displayName="NetflowRenderer"},function(e,t,n){"use strict";var a=n(1008);e.exports=function(e,t,n,i){var r,o=e.length,s=0;if(t=t<0?-t>o?0:o+t:t>o?o:t,n=n>0?n:0,i.length<1e4)(r=Array.from(i)).unshift(t,n),a.apply(e,r);else for(n&&a.apply(e,[t,n]);s<i.length;)(r=i.slice(s,s+1e4)).unshift(t,0),a.apply(e,r),s+=1e4,t+=1e4}},function(e,t,n){"use strict";e.exports=function(e){return e<0||32===e}},function(e,t,n){"use strict";var a=n(367);e.exports=function(e){return function(t){return e.test(a(t))}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d}));var a=n(82),i=n.n(a),r=n(4),o=n.n(r),s=n(33),l=n.n(s),c=n(32);const u=l.a.span.withConfig({displayName:"EllipsisText",componentId:"sc-pfaalj-0"})(["&,& *{display:inline-block;max-width:100%;overflow:hidden;text-overflow:ellipsis;vertical-align:top;white-space:nowrap;}"]);function d({tooltipContent:e,children:t,dataTestSubj:n,...a}){return e?o.a.createElement(c.EuiToolTip,{display:"block",content:e},o.a.createElement(u,i()({"data-test-subj":n},a),t)):o.a.createElement(u,i()({"data-test-subj":n},a),t)}u.displayName="EllipsisText"},,,function(e,t,n){"use strict";n.d(t,"e",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"b",(function(){return p})),n.d(t,"g",(function(){return g})),n.d(t,"c",(function(){return b})),n.d(t,"f",(function(){return h})),n.d(t,"a",(function(){return k}));var a=n(39),i=n(4),r=n(105),o=n(350),s=n(139);const l=Object.freeze({});function c(e,t=l,n=s.c,c,u=[]){const{filter:d="",page:p=r.b+1,perPage:m=r.c,policies:g=[],excludedPolicies:f=[]}=t,b=Object(i.useMemo)((()=>Object(o.a)({kuery:Object(o.b)(d,n),policies:g,excludedPolicies:f})),[d,n,g,f]);return Object(a.useQuery)([...u,"list",e,b,p,m],(async()=>await e.find({filter:b,perPage:m,page:p,sortField:r.d,sortOrder:r.e})),c)}function u(e,t,n,i){return Object(a.useQuery)(["get",e,t,n],(()=>e.get(t,n)),i)}const d=Object.freeze({});function p(e,t=d){return Object(a.useMutation)((t=>e.create(t)),t)}const m=Object.freeze({});function g(e,t=m){return Object(a.useMutation)((t=>e.update(t)),t)}const f=Object.freeze({});function b(e,t=f){return Object(a.useMutation)((({itemId:t,id:n})=>e.delete(t,n)),t)}const y=Object.freeze({});function h(e,t=y,n=s.c,i){const{filter:r="",policies:l=[]}=t;return Object(a.useQuery)(["summary",e,r,l],(()=>e.summary(Object(o.a)({policies:l,kuery:Object(o.b)(r,n)}))),i)}var v=n(427),E=n.n(v);const x=Object.freeze({});function k(e,t=x,n={concurrency:5}){return Object(a.useMutation)((t=>E()(t,(t=>e.update(t)),n)),t)}Object.freeze({})},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return v})),n.d(t,"b",(function(){return E}));var a=n(82),i=n.n(a),r=n(4),o=n.n(r),s=n(78),l=n(32),c=n(90),u=n(158),d=n(86),p=n(148),m=n(79),g=n(81),f=n(145),b=n(177),y=n(95),h=n(283);const v=({timelineId:e,timelineType:t,closeGearMenu:n})=>{const a=Object(s.useDispatch)(),i=Object(r.useMemo)((()=>b.d.defaultDataViewSelector()),[]),{id:o,patternList:l}=Object(g.a)(i),{timelineFullScreen:v,setTimelineFullScreen:E}=Object(p.c)(),x=Object(g.a)(f.d.globalTimeRangeSelector),k=Object(r.useCallback)((({id:e,show:n,timeRange:i})=>{const r=null!=i?i:x;e===m.j.active&&v&&E(!1),a(b.a.setSelectedDataView({id:y.SourcererScopeName.timeline,selectedDataViewId:o,selectedPatterns:l})),a(d.a.createTimeline({columns:u.b,dataViewId:o,id:e,indexNames:l,show:n,timelineType:t})),a(d.a.setTimelineUpdatedAt({id:m.j.active,updated:void 0})),a(f.b.addLinkTo([c.a.global,c.a.timeline])),a(h.a.addNotes({notes:[]})),i&&a(f.b.removeLinkTo([c.a.timeline,c.a.global])),"absolute"===r.kind?a(f.b.setAbsoluteRangeDatePicker({...r,id:c.a.timeline})):"relative"===r.kind&&a(f.b.setRelativeRangeDatePicker({...r,id:c.a.timeline}))}),[a,x,o,l,E,v,t]);return Object(r.useCallback)((a=>{k({id:e,show:!0,timelineType:t,timeRange:null==a?void 0:a.timeRange}),"function"==typeof n&&n()}),[k,e,t,n])},E=({timelineId:e,timelineType:t,closeGearMenu:n})=>{const a=v({timelineId:e,timelineType:t,closeGearMenu:n});return{getButton:Object(r.useCallback)((({outline:e,title:n,iconType:r="plusInCircle",fill:s=!0,isDisabled:c=!1})=>{const u={iconType:r,onClick:()=>a(),fill:s},d=t===m.n.template?"template-timeline-new":"timeline-new",{fill:p,...g}=u;return e?o.a.createElement(l.EuiButton,i()({"data-test-subj":`${d}-with-border`},u),n):o.a.createElement(l.EuiButtonEmpty,i()({"data-test-subj":d,color:"text"},g),n)}),[a,t])}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(4),i=n.n(a),r=n(33),o=n.n(r),s=n(34);const l=o.a.div.withConfig({displayName:"StyledDiv",componentId:"sc-l27u1a-0"})(["width:100%;display:flex;flex-grow:1;> *{max-width:100%;}",""],(({targetClassNames:e})=>Object(r.css)(["","{pointer-events:none;opacity:0;transition:opacity "," ease;}","{pointer-events:auto;opacity:1;}"],e.map((e=>`.${e}`)).join(", "),(e=>Object(s.getOr)(250,"theme.eui.euiAnimSpeedNormal",e)),e.map((e=>`&:hover .${e}`)).join(", ")))),c=i.a.memo((({show:e=!0,targetClassNames:t,children:n})=>e?i.a.createElement(l,{"data-test-subj":"hoverVisibilityContainer",targetClassNames:t},n):i.a.createElement(i.a.Fragment,null,n)));c.displayName="HoverVisibilityContainer"},function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return d}));var a=n(0),i=n(85);const r=a.i18n.translate("xpack.securitySolution.riskScore.overview.hostTitle",{defaultMessage:"Host"}),o=a.i18n.translate("xpack.securitySolution.riskScore.overview.hosts",{defaultMessage:"Hosts"}),s=a.i18n.translate("xpack.securitySolution.riskScore.overview.userTitle",{defaultMessage:"User"}),l=a.i18n.translate("xpack.securitySolution.riskScore.overview.users",{defaultMessage:"Users"}),c=e=>a.i18n.translate("xpack.securitySolution.riskScore.overview.riskScoreTitle",{defaultMessage:"{riskEntity} Risk Score",values:{riskEntity:u(e)}}),u=(e,t=!1,n=!1)=>t?n?(e===i.v.host?o:l).toLowerCase():(e===i.v.host?r:s).toLowerCase():n?e===i.v.host?o:l:e===i.v.host?r:s,d=a.i18n.translate("xpack.securitySolution.riskScore.overview.alerts",{defaultMessage:"Alerts"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return g}));var a=n(4),i=n.n(a),r=n(32),o=n(33),s=n.n(o),l=n(40),c=n(552),u=n(85);const d={[u.x.unknown]:l.euiLightVars.euiColorMediumShade,[u.x.low]:l.euiLightVars.euiColorVis0,[u.x.moderate]:l.euiLightVars.euiColorWarning,[u.x.high]:l.euiLightVars.euiColorVis9_behindText,[u.x.critical]:l.euiLightVars.euiColorDanger},p=s.a.div.withConfig({displayName:"RiskBadge",componentId:"sc-tjf1ld-0"})(["",""],(({theme:e,$severity:t,$hideBackgroundColor:n})=>Object(o.css)(["width:fit-content;padding-right:",";padding-left:",";",";"],e.eui.euiSizeS,e.eui.euiSizeXS,("Critical"===t||"High"===t)&&!n&&Object(o.css)(["background-color:",";border-radius:999px;"],Object(r.transparentize)(e.eui.euiColorDanger,.2))))),m=s.a.div.withConfig({displayName:"TooltipContainer",componentId:"sc-tjf1ld-1"})(["padding:",";"],(({theme:e})=>e.eui.euiSizeS)),g=({severity:e,hideBackgroundColor:t=!1,toolTipContent:n})=>{const a=i.a.createElement(p,{color:l.euiLightVars.euiColorDanger,$severity:e,$hideBackgroundColor:t,"data-test-subj":"risk-score"},i.a.createElement(r.EuiHealth,{className:"eui-alignMiddle",color:d[e]},e));return null!=n?i.a.createElement(c.a,{hoverContent:i.a.createElement(m,null,n),render:()=>a}):a}},function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"g",(function(){return r})),n.d(t,"h",(function(){return o})),n.d(t,"j",(function(){return s})),n.d(t,"k",(function(){return l})),n.d(t,"i",(function(){return c})),n.d(t,"o",(function(){return u})),n.d(t,"n",(function(){return d})),n.d(t,"m",(function(){return p})),n.d(t,"l",(function(){return m})),n.d(t,"u",(function(){return g})),n.d(t,"t",(function(){return f})),n.d(t,"s",(function(){return b})),n.d(t,"r",(function(){return y})),n.d(t,"d",(function(){return h})),n.d(t,"b",(function(){return v})),n.d(t,"a",(function(){return E})),n.d(t,"c",(function(){return x})),n.d(t,"p",(function(){return k})),n.d(t,"q",(function(){return S})),n.d(t,"f",(function(){return w})),n.d(t,"v",(function(){return j})),n.d(t,"w",(function(){return O}));var a=n(0);const i=a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights",{defaultMessage:"Insights"}),r=a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_process_ancestry",{defaultMessage:"Related alerts by process ancestry"}),o=e=>a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_process_ancestry_count",{defaultMessage:"{count} {count, plural, =1 {alert} other {alerts}} by process ancestry",values:{count:e}}),s=a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_process_ancestry_error",{defaultMessage:"Failed to fetch alerts."}),l=a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.processAncestryFilter",{defaultMessage:"Process Ancestry Alert IDs"}),c=a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_process_ancestry_empty",{defaultMessage:"There are no related alerts by process ancestry."}),u=a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_source_event_loading",{defaultMessage:"Loading related alerts by source event"}),d=a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_session_error",{defaultMessage:"Failed to load related alerts by session"}),p=a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_session_empty",{defaultMessage:"There are no related alerts by session"}),m=e=>a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_session_count",{defaultMessage:"{count} {count, plural, =1 {alert} other {alerts}} related by session",values:{count:e}}),g=a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_source_event_loading",{defaultMessage:"Loading related alerts by source event"}),f=a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_source_event_error",{defaultMessage:"Failed to load related alerts by source event"}),b=a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_source_event_empty",{defaultMessage:"There are no related alerts by source event"}),y=e=>a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights_related_alerts_by_source_event_count",{defaultMessage:"{count} {count, plural, =1 {alert} other {alerts}} related by source event",values:{count:e}}),h=a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_cases_loading",{defaultMessage:"Loading related cases"}),v=a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_cases_error",{defaultMessage:"Failed to load related cases"}),E=e=>a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_cases_count",{defaultMessage:"{count} {count, plural, =1 {case} other {cases}} related to this alert",values:{count:e}}),x=e=>a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.relatedCasesFailure",{defaultMessage:'Unable to load related cases: "{error}"',values:{error:e}}),k=a.i18n.translate("xpack.securitySolution.alertDetails.overview.simpleAlertTable.error",{defaultMessage:"Failed to load the alerts."}),S=a.i18n.translate("xpack.securitySolution.alertDetails.overview.limitedAlerts",{defaultMessage:"Showing only the latest 10 alerts. View the rest of alerts in timeline."}),w=a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.alertUpsellTitle",{defaultMessage:"Get more insights with a platinum subscription"}),j=e=>a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.suppressedAlertsCount",{defaultMessage:"{count} suppressed {count, plural, =1 {alert} other {alerts}}",values:{count:e}}),O=a.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.suppressedAlertsCountTechnicalPreview",{defaultMessage:"Technical Preview"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=(e,t,n)=>{const a=e*t;return{activePage:e,cursorStart:a,fakePossibleCount:4<=e&&e>0?t*(e+2):5*t,querySize:n?t:t+a}}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(4),i=n(116);const r=()=>{const[e,t]=Object(a.useState)({isAuthenticated:null,hasEncryptionKey:null,hasIndexManage:null,hasIndexRead:null,hasIndexWrite:null,hasIndexUpdateDelete:null,hasIndexMaintenance:null,hasKibanaCRUD:!1,hasKibanaREAD:!1}),{detectionEnginePrivileges:n,kibanaSecuritySolutionsPrivileges:{crud:r,read:o}}=Object(i.a)();return Object(a.useEffect)((()=>{null!=n.error&&t({isAuthenticated:!1,hasEncryptionKey:!1,hasIndexManage:!1,hasIndexRead:!1,hasIndexWrite:!1,hasIndexUpdateDelete:!1,hasIndexMaintenance:!1,hasKibanaCRUD:r,hasKibanaREAD:o})}),[n.error,r,o]),Object(a.useEffect)((()=>{if(null!=n.result){const e=n.result;if(null!=e.index&&Object.keys(e.index).length>0){const n=Object.keys(e.index)[0];t({isAuthenticated:e.is_authenticated,hasEncryptionKey:e.has_encryption_key,hasIndexManage:e.index[n].manage&&e.cluster.manage,hasIndexMaintenance:e.index[n].maintenance,hasIndexRead:e.index[n].read,hasIndexWrite:e.index[n].create||e.index[n].create_doc||e.index[n].index||e.index[n].write,hasIndexUpdateDelete:e.index[n].write,hasKibanaCRUD:r,hasKibanaREAD:o})}}}),[n.result,r,o]),{loading:n.loading,...e}}},function(e,t,n){e.exports=n(27)(258)},function(e,t,n){e.exports=n(27)(1546)},function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var a=n(32),i=n(4),r=n.n(i),o=n(33),s=n.n(o),l=n(607),c=n(615),u=n(867),d=n(128),p=n(77);s.a.header.attrs({className:"securitySolutionHeaderPage"}).withConfig({displayName:"Header",componentId:"sc-fdx6r8-0"})(["",""],(({border:e,theme:t})=>Object(o.css)(["margin-bottom:",";"],t.eui.euiSizeL))).displayName="Header";const m=s.a.div.attrs({className:"securitySolutionHeaderPage__linkBack"}).withConfig({displayName:"LinkBack",componentId:"sc-fdx6r8-1"})(["",""],(({theme:e})=>Object(o.css)(["font-size:",";line-height:",";margin-bottom:",";"],e.eui.euiFontSizeXS,e.eui.euiLineHeight,e.eui.euiSizeS)));m.displayName="LinkBack";const g=s()(a.EuiPageHeaderSection).withConfig({displayName:"HeaderSection",componentId:"sc-fdx6r8-2"})(["min-width:0;max-width:100%;"]);g.displayName="HeaderSection";const f=r.a.memo((({backOptions:e})=>{var t,n;const{navigateToUrl:a}=Object(p.k)().services.application,{formatUrl:i}=Object(d.n)(e.pageId),o=i(null!==(t=e.path)&&void 0!==t?t:"");return r.a.createElement(m,null,r.a.createElement(l.a,{dataTestSubj:null!==(n=e.dataTestSubj)&&void 0!==n?n:"link-back",onClick:e=>{e.preventDefault(),a(o)},href:o,iconType:"arrowLeft"},e.text))}));f.displayName="HeaderLinkBack";const b=({backOptions:e,backComponent:t,badgeOptions:n,border:i,children:o,draggableArguments:s,isLoading:l,rightSideItems:d,subtitle:p,subtitle2:m,title:b,titleNode:y})=>r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiPageHeader,{alignItems:"center",bottomBorder:i,rightSideItems:d},r.a.createElement(g,null,e&&r.a.createElement(f,{backOptions:e}),!e&&t&&r.a.createElement(r.a.Fragment,null,t),y||r.a.createElement(u.a,{draggableArguments:s,title:b,badgeOptions:n}),p&&r.a.createElement(c.a,{"data-test-subj":"header-page-subtitle",items:p}),m&&r.a.createElement(c.a,{"data-test-subj":"header-page-subtitle-2",items:m}),i&&l&&r.a.createElement(a.EuiProgress,{size:"xs",color:"accent"})),o&&r.a.createElement(a.EuiPageHeaderSection,{"data-test-subj":"header-page-supplements"},o)),r.a.createElement(a.EuiSpacer,{size:"l"})),y=r.a.memo(b)},function(e,t,n){"use strict";n.d(t,"b",(function(){return v})),n.d(t,"g",(function(){return E})),n.d(t,"d",(function(){return x})),n.d(t,"e",(function(){return k})),n.d(t,"f",(function(){return S})),n.d(t,"i",(function(){return w})),n.d(t,"h",(function(){return j})),n.d(t,"a",(function(){return I})),n.d(t,"c",(function(){return T}));var a=n(32),i=n(35),r=n(34),o=n(4),s=n.n(o),l=n(33),c=n.n(l),u=n(102),d=n(88),p=n(87),m=(n(101),n(89)),g=n(160),f=n(430),b=n(104),y=n(133);const h=c()(a.EuiFlexGroup).withConfig({displayName:"DraggableContainerFlexGroup",componentId:"sc-1lhdirr-0"})(["flex-grow:unset;"]),v="ip-overview",E=(e,t,n,i)=>e.length>0&&e.every((e=>Object(r.getOr)(null,e,t)))?s.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},e.map(((e,l)=>{const c=Object(r.getOr)("",e,t);return s.a.createElement(o.Fragment,{key:`${v}-${e}`},l?",Â ":"",s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(d.b,{id:`location-renderer-default-draggable-${v}-${n?`${n}-`:""}${e}`,isDraggable:null!=i&&i,field:e,value:c,isAggregatable:!0,fieldType:"keyword"})))}))):Object(p.d)(),x=(e,t,n,i)=>e&&e.organization&&e.organization.name&&e.number?s.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(d.b,{id:`autonomous-system-renderer-default-draggable-${v}-${n?`${n}-`:""}${t}.as.organization.name`,isDraggable:null!=i&&i,field:`${t}.as.organization.name`,value:e.organization.name})),s.a.createElement(a.EuiFlexItem,{grow:!1},"/"),s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(d.b,{id:`autonomous-system-renderer-default-draggable-${v}-${n?`${n}-`:""}${t}.as.number`,isDraggable:!1,field:`${t}.as.number`,value:`${e.number}`,isAggregatable:!0,fieldType:"number"}))):Object(p.d)(),k=({contextID:e,host:t,isDraggable:n=!1,ipFilter:a,noLink:i})=>t.id&&t.ip&&(null==a||t.ip.includes(a))?s.a.createElement(s.a.Fragment,null,t.name&&null!=t.name[0]?s.a.createElement(d.b,{id:`host-id-renderer-default-draggable-${v}-${e?`${e}-`:""}host-id`,isDraggable:n,field:"host.id",value:t.id[0],isAggregatable:!0,fieldType:"keyword"},i?s.a.createElement(s.a.Fragment,null,t.id):s.a.createElement(m.d,{hostName:t.name[0]},t.id)):s.a.createElement(s.a.Fragment,null,t.id)):Object(p.d)(),S=(e,t,n,a)=>e&&e.name&&e.name[0]&&e.ip&&(null==t||e.ip.includes(t))?s.a.createElement(d.b,{id:`host-name-renderer-default-draggable-${v}-${n?`${n}-`:""}host-name`,isDraggable:null!=a&&a,field:"host.name",value:e.name[0],isAggregatable:!0,fieldType:"keyword"},s.a.createElement(m.d,{hostName:e.name[0]},e.name?e.name:Object(p.d)())):Object(p.d)(),w=e=>s.a.createElement(m.n,{domain:e},f.n),j=e=>s.a.createElement(m.j,{domain:e,direction:"column"}),O=({attrName:e,displayCount:t=1,idPrefix:n,isDraggable:i=!1,moreMaxHeight:r="200px",render:o,rowItems:l})=>{if(null!=l&&l.length>0){const c=l.slice(0,t).map(((t,r)=>{const l=Object(u.h)(`default-field-renderer-default-draggable-${n}-${e}-${t}`);return s.a.createElement(a.EuiFlexItem,{key:l,grow:!1},0!==r&&s.a.createElement(s.a.Fragment,null,",",s.a.createElement(g.i,null)),"string"==typeof t&&s.a.createElement(d.b,{id:l,isDraggable:i,field:e,value:t,isAggregatable:!0,fieldType:"keyword"},o?o(t):t))}));return c.length>0?s.a.createElement(h,{alignItems:"center",gutterSize:"none",component:"span","data-test-subj":"DefaultFieldRendererComponent"},s.a.createElement(a.EuiFlexItem,{grow:!1},c," "),s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(C,{attrName:e,fieldType:"keyword",idPrefix:n,isAggregatable:!0,moreMaxHeight:r,overflowIndexStart:t,render:o,rowItems:l}))):Object(p.d)()}return Object(p.d)()},I=s.a.memo(O);I.displayName="DefaultFieldRenderer";const T=s.a.memo((({attrName:e,dragDisplayValue:t,fieldType:n,idPrefix:i,isAggregatable:r,moreMaxHeight:l,overflowIndexStart:c,render:d,rowItems:m})=>{const g=Object(o.useMemo)((()=>m.slice(c).reduce(((o,l,c)=>{const m=Object(u.h)(`${i}-${e}-${l}-${c}`),g="string"==typeof l&&null!=e?{and:[],enabled:!0,id:m,name:l,excluded:!1,kqlQuery:"",queryMatch:{field:e,value:l,displayValue:null!=t?t:l,operator:b.a}}:void 0;return null!=g&&o.push(s.a.createElement(a.EuiFlexItem,{key:`${i}-${m}`},s.a.createElement(y.b,{dataProvider:g,isDraggable:!1,render:()=>{var e;return null!==(e=d&&d(l))&&void 0!==e?e:Object(p.a)(l)},scopeId:void 0,fieldType:n,isAggregatable:r}))),o}),[])),[e,t,n,i,r,c,d,m]),f=Object(o.useMemo)((()=>m.slice(c).map(((e,t)=>{var n;return s.a.createElement(a.EuiFlexItem,{grow:1,key:`${e}-${t}`},null!==(n=d&&d(e))&&void 0!==n?n:Object(p.a)(e))}))),[c,d,m]);return s.a.createElement("div",{"data-test-subj":"more-container",className:"eui-yScroll",style:{maxHeight:l,paddingRight:"2px"}},s.a.createElement(a.EuiFlexGroup,{gutterSize:"s",direction:"column","data-test-subj":"overflow-items"},null!=e?g:f))}));T.displayName="MoreContainer";const C=s.a.memo((({attrName:e,idPrefix:t,moreMaxHeight:n,overflowIndexStart:r=5,render:l,rowItems:c,fieldType:u,isAggregatable:d})=>{const[p,m]=Object(o.useState)(!1),g=Object(o.useCallback)((()=>m((e=>!e))),[]),f=Object(o.useMemo)((()=>s.a.createElement(s.a.Fragment,null," ,",s.a.createElement(a.EuiButtonEmpty,{size:"xs",onClick:g,"data-test-subj":"DefaultFieldRendererOverflow-button"},`+${c.length-r} `,s.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.fieldRenderers.moreLabel",defaultMessage:"More"})))),[g,r,c.length]);return s.a.createElement(a.EuiFlexItem,{grow:!1},c.length>r&&s.a.createElement(a.EuiPopover,{id:"popover",button:f,isOpen:p,closePopover:g,repositionOnScroll:!0,panelClassName:"withHoverActions__popover"},s.a.createElement(T,{attrName:e,idPrefix:t,render:l,rowItems:c,moreMaxHeight:n,overflowIndexStart:r,fieldType:u,isAggregatable:d})))}));C.displayName="DefaultFieldRendererOverflow"},function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"a",(function(){return c}));var a=n(151),i=n(342);function r(e=new Map,t){const n=Array.from(t);return new Map([...e,...n.map((e=>[e,{events:[],status:"loading"}]))])}function o(e=new Map,t){const n=Array.from(t);return new Map([...e,...n.map((e=>[e,{events:[],status:"error"}]))])}function s(e=new Map,t){const n=new Map([...e]);return n.delete(t),n}function l({storedNodeInfo:e=new Map,receivedEvents:t,requestedNodes:n,numberOfRequestedEvents:r}){const o=new Map([...e]),s=t.length>=r,l=function(e){const t=new Map;for(const n of e){const e=Object(a.b)(n),r=Object(i.a)(n);if(e){const a=t.get(e);a?(a.events.push(n),a.terminated=a.terminated||r):t.set(e,{events:[n],terminated:r})}}return t}(t);for(const e of n.values())l.has(e)||(s?o.delete(e):o.set(e,{events:[],status:"running"}));for(const[e,t]of l.entries())o.set(e,{events:[...t.events],status:t.terminated?"terminated":"running"});return o}function c(e){return!e||"loading"===e.status||"error"===e.status||e.events.length<=0?void 0:e.events[0]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(4),i=n.n(a),r=n(141);const o=i.a.memo((({children:e})=>i.a.createElement(r.w,{className:"siemEventsTable__trSupplement--summary"},e)));o.displayName="RowRendererContainer"},function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}));var a=n(32),i=n(4),r=n.n(i),o=n(88),s=n(97),l=n(260);const c=r.a.memo((({contextId:e,endgamePid:t,endgameProcessName:n,eventId:i,processExecutable:l,processName:c,processPid:u,isDraggable:d})=>Object(s.e)(c)&&Object(s.e)(l)&&Object(s.e)(n)&&Object(s.e)(u)&&Object(s.e)(t)?null:r.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},Object(s.e)(c)?Object(s.e)(l)?Object(s.e)(n)?null:r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(o.c,{contextId:e,eventId:i,field:"endgame.process_name",value:n,iconType:"console",isDraggable:d,fieldType:"keyword",isAggregatable:!0})):r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(o.c,{contextId:e,eventId:i,field:"process.executable",value:l,iconType:"console",isDraggable:d,fieldType:"keyword",isAggregatable:!0})):r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(o.c,{contextId:e,eventId:i,field:"process.name",value:c,iconType:"console",isDraggable:d,fieldType:"keyword",isAggregatable:!0})),Object(s.e)(u)?Object(s.e)(t)?null:r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(o.c,{contextId:e,eventId:i,field:"endgame.pid",queryValue:String(t),value:`(${String(t)})`,isDraggable:d,fieldType:"keyword",isAggregatable:!0})):r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(o.c,{contextId:e,eventId:i,field:"process.pid",queryValue:String(u),value:`(${String(u)})`,isDraggable:d,fieldType:"keyword",isAggregatable:!0})))));c.displayName="ProcessDraggable";const u=r.a.memo((({contextId:e,endgamePid:t,endgameProcessName:n,eventId:a,processExecutable:i,processName:o,processPid:s,isDraggable:u})=>null==t&&null==n&&null==i&&null==o&&null==s?r.a.createElement(r.a.Fragment,null,l.f):r.a.createElement(c,{contextId:e,endgamePid:t,endgameProcessName:n,eventId:a,processExecutable:i,processName:o,processPid:s,isDraggable:u})));u.displayName="ProcessDraggableWithNonExistentProcess"},function(e,t,n){"use strict";n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return g}));var a,i,r=n(44),o=n.n(r),s=n(376),l=n(194),c=n(622);const u=(e,t)=>n=>`${c.g}: ${o()(n).format(e)} ${t?c.b(n):c.f(n)}`,d=[{text:"event.action",value:"event.action"},{text:"event.dataset",value:"event.dataset"},{text:"event.module",value:"event.module"}],p={defaultStackByOption:null!==(a=d.find((e=>"event.action"===e.text)))&&void 0!==a?a:d[0],errorMessage:c.d,histogramType:s.j.events,stackByOptions:d,subtitle:void 0,title:c.e,getLensAttributes:(e="event.action")=>({title:"Host - events",description:"",visualizationType:"lnsXY",state:{visualization:{title:"Empty XY chart",legend:{isVisible:!0,position:"right"},valueLabels:"hide",preferredSeriesType:"bar_stacked",layers:[{layerId:"0039eb0c-9a1a-4687-ae54-0f4e239bec75",accessors:["e09e0380-0740-4105-becc-0a4ca12e3944"],position:"top",seriesType:"bar_stacked",showGridlines:!1,layerType:"data",xAccessor:"aac9d7d0-13a3-480a-892b-08207a787926",splitAccessor:"34919782-4546-43a5-b668-06ac934d3acd"}],yRightExtent:{mode:"full"},yLeftExtent:{mode:"full"},axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!0}},query:{query:"",language:"kuery"},filters:[],datasourceStates:{formBased:{layers:{"0039eb0c-9a1a-4687-ae54-0f4e239bec75":{columns:{"aac9d7d0-13a3-480a-892b-08207a787926":{label:"@timestamp",dataType:"date",operationType:"date_histogram",sourceField:"@timestamp",isBucketed:!0,scale:"interval",params:{interval:"auto"}},"e09e0380-0740-4105-becc-0a4ca12e3944":{label:"Count of records",dataType:"number",operationType:"count",isBucketed:!1,scale:"ratio",sourceField:"___records___"},"34919782-4546-43a5-b668-06ac934d3acd":{label:`Top values of ${e}`,dataType:"string",operationType:"terms",scale:"ordinal",sourceField:`${e}`,isBucketed:!0,params:{size:10,orderBy:{type:"column",columnId:"e09e0380-0740-4105-becc-0a4ca12e3944"},orderDirection:"asc",otherBucket:!0,missingBucket:!1,parentFormat:{id:"terms"}}}},columnOrder:["34919782-4546-43a5-b668-06ac934d3acd","aac9d7d0-13a3-480a-892b-08207a787926","e09e0380-0740-4105-becc-0a4ca12e3944"],incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-0039eb0c-9a1a-4687-ae54-0f4e239bec75"}]})},m=[{text:"event.category",value:"event.category"},{text:"event.module",value:"event.module"}],g={defaultStackByOption:null!==(i=m.find((e=>"event.module"===e.text)))&&void 0!==i?i:m[0],errorMessage:c.c,histogramType:s.j.alerts,stackByOptions:m,subtitle:void 0,title:c.a,getLensAttributes:(e="event.module")=>({title:"External alerts",description:"",visualizationType:"lnsXY",state:{visualization:{title:"Empty XY chart",legend:{isVisible:!0,position:"right"},valueLabels:"hide",preferredSeriesType:"bar_stacked",layers:[{layerId:"a3c54471-615f-4ff9-9fda-69b5b2ea3eef",accessors:["0a923af2-c880-4aa3-aa93-a0b9c2801f6d"],position:"top",seriesType:"bar_stacked",showGridlines:!1,layerType:"data",xAccessor:"37bdf546-3c11-4b08-8c5d-e37debc44f1d",splitAccessor:"42334c6e-98d9-47a2-b4cb-a445abb44c93"}],yRightExtent:{mode:"full"},yLeftExtent:{mode:"full"}},query:{query:"",language:"kuery"},filters:[{meta:{index:"a04472fc-94a3-4b8d-ae05-9d30ea8fbd6a",alias:null,negate:!1,disabled:!1,type:"phrase",key:"event.kind",params:{query:"alert"}},query:{match_phrase:{"event.kind":"alert"}},$state:{store:"appState"}}],datasourceStates:{formBased:{layers:{"a3c54471-615f-4ff9-9fda-69b5b2ea3eef":{columns:{"37bdf546-3c11-4b08-8c5d-e37debc44f1d":{label:"@timestamp",dataType:"date",operationType:"date_histogram",sourceField:"@timestamp",isBucketed:!0,scale:"interval",params:{interval:"auto"}},"0a923af2-c880-4aa3-aa93-a0b9c2801f6d":{label:l.f,dataType:"number",operationType:"count",isBucketed:!1,scale:"ratio",sourceField:"___records___"},"42334c6e-98d9-47a2-b4cb-a445abb44c93":{label:Object(l.n)(`${e}`),dataType:"string",operationType:"terms",scale:"ordinal",sourceField:`${e}`,isBucketed:!0,params:{size:10,orderBy:{type:"column",columnId:"0a923af2-c880-4aa3-aa93-a0b9c2801f6d"},orderDirection:"desc",otherBucket:!0,missingBucket:!1,parentFormat:{id:"terms"}}}},columnOrder:["42334c6e-98d9-47a2-b4cb-a445abb44c93","37bdf546-3c11-4b08-8c5d-e37debc44f1d","0a923af2-c880-4aa3-aa93-a0b9c2801f6d"],incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-a3c54471-615f-4ff9-9fda-69b5b2ea3eef"},{type:"index-pattern",name:"723c4653-681b-4105-956e-abef287bf025",id:"{dataViewId}"},{type:"index-pattern",name:"a04472fc-94a3-4b8d-ae05-9d30ea8fbd6a",id:"{dataViewId}"}]})}},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(4),i=n(83),r=n(84),o=n(193),s=n(404),l=n(217);const c=()=>{const[e,t]=Object(a.useState)(!0),[n,c]=Object(a.useState)({signalIndexExists:null,signalIndexName:null,signalIndexMappingOutdated:null,createDeSignalIndex:null}),{addError:u}=Object(r.a)(),{hasIndexRead:d}=Object(l.a)();return Object(a.useEffect)((()=>{let e=!0;const n=new AbortController,a=async()=>{try{t(!0);const a=await Object(o.h)({signal:n.signal});e&&null!=a&&c({signalIndexExists:!0,signalIndexName:a.name,signalIndexMappingOutdated:a.index_mapping_outdated,createDeSignalIndex:r})}catch(t){e&&(c({signalIndexExists:!1,signalIndexName:null,signalIndexMappingOutdated:null,createDeSignalIndex:r}),Object(i.t)(t)&&404!==t.body.status_code&&u(t,{title:s.c}))}e&&t(!1)},r=async()=>{let l=!1;try{t(!0),await Object(o.d)({signal:n.signal}),e&&(l=!0,a())}catch(t){e&&(Object(i.t)(t)&&409===t.body.status_code?a():(c({signalIndexExists:!1,signalIndexName:null,signalIndexMappingOutdated:null,createDeSignalIndex:r}),u(t,{title:s.d})))}e&&!l&&t(!1)};return d?a():t(!1),()=>{e=!1,n.abort()}}),[u,d]),{loading:e,...n}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(4),i=n(154);const r=()=>{const{startTransaction:e}=Object(i.a)();return{startTracking:Object(a.useCallback)((({name:t,spanName:n="fetch"})=>{const a=e({name:t,type:"http-request",options:{managed:!1}}),i=null==a?void 0:a.startSpan(n,"http-request",{blocking:!0});return{endTracking:e=>{null==a||a.addLabels({result:e}),null==i||i.end()}}}),[e])}}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(4),i=n(78),r=n(98),o=n(283),s=n(84),l=n(81);const c=({id:e,filterQuery:t,kqlError:n,query:c,startDate:u,endDate:d})=>{const{addError:p}=Object(s.a)(),m=Object(i.useDispatch)(),g=Object(a.useMemo)((()=>r.a.errorsSelector()),[]),f=Object(l.a)(g),b=null==n?void 0:n.name,y=null==n?void 0:n.message;Object(a.useEffect)((()=>{if(!t&&y&&b){const t=y.split("").reduce(((e,t)=>(e<<5)-e+t.charCodeAt(0)|0),0).toString();m(o.a.addErrorHash({id:e,hash:t,title:b,message:[y]}))}}),[e,t,p,c,u,d,m,y,b]),Object(a.useEffect)((()=>{const t=f.find((t=>t.id===e));null!=t&&t.displayError&&null!=n&&(delete n.stack,p(n,{title:n.name}))}),[p,f,e,n])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(32),i=n(0),r=n(35),o=n(4),s=n.n(o);const l=({count:e})=>{const[t,n,l]=Object(o.useMemo)((()=>function(e){var t;if(!Number.isFinite(e))return[e,"",""];const n=Math.pow(10,3*Math.min(Math.floor(Math.floor(Math.log10(e))/3),4)),a={compactThousands:i.i18n.translate("xpack.securitySolution.formattedNumber.compactThousands",{defaultMessage:"k"}),compactMillions:i.i18n.translate("xpack.securitySolution.formattedNumber.compactMillions",{defaultMessage:"M"}),compactBillions:i.i18n.translate("xpack.securitySolution.formattedNumber.compactBillions",{defaultMessage:"B"}),compactTrillions:i.i18n.translate("xpack.securitySolution.formattedNumber.compactTrillions",{defaultMessage:"T"})},r=new Map([[1,""],[1e3,a.compactThousands],[1e6,a.compactMillions],[1e9,a.compactBillions],[1e12,a.compactTrillions]]),o=i.i18n.translate("xpack.securitySolution.formattedNumber.compactOverflow",{defaultMessage:"+"}),s=null!==(t=r.get(n))&&void 0!==t?t:"";return[Math.floor(e/n),s,e/n%1>Number.EPSILON?o:""]}(e||0)),[e]);return null==e?null:0===e?s.a.createElement(s.a.Fragment,null,0):s.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.formattedNumber.countsLabel",description:"",defaultMessage:"{mantissa}{scale}{hasRemainder}",values:{mantissa:s.a.createElement(a.EuiI18nNumber,{value:t}),scale:n,hasRemainder:l}})},c=s.a.memo(l)},function(e,t,n){const{MAX_SAFE_COMPONENT_LENGTH:a}=n(308),i=n(307),r=(t=e.exports={}).re=[],o=t.src=[],s=t.t={};let l=0;const c=(e,t,n)=>{const a=l++;i(e,a,t),s[e]=a,o[a]=t,r[a]=new RegExp(t,n?"g":void 0)};c("NUMERICIDENTIFIER","0|[1-9]\\d*"),c("NUMERICIDENTIFIERLOOSE","[0-9]+"),c("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),c("MAINVERSION",`(${o[s.NUMERICIDENTIFIER]})\\.(${o[s.NUMERICIDENTIFIER]})\\.(${o[s.NUMERICIDENTIFIER]})`),c("MAINVERSIONLOOSE",`(${o[s.NUMERICIDENTIFIERLOOSE]})\\.(${o[s.NUMERICIDENTIFIERLOOSE]})\\.(${o[s.NUMERICIDENTIFIERLOOSE]})`),c("PRERELEASEIDENTIFIER",`(?:${o[s.NUMERICIDENTIFIER]}|${o[s.NONNUMERICIDENTIFIER]})`),c("PRERELEASEIDENTIFIERLOOSE",`(?:${o[s.NUMERICIDENTIFIERLOOSE]}|${o[s.NONNUMERICIDENTIFIER]})`),c("PRERELEASE",`(?:-(${o[s.PRERELEASEIDENTIFIER]}(?:\\.${o[s.PRERELEASEIDENTIFIER]})*))`),c("PRERELEASELOOSE",`(?:-?(${o[s.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${o[s.PRERELEASEIDENTIFIERLOOSE]})*))`),c("BUILDIDENTIFIER","[0-9A-Za-z-]+"),c("BUILD",`(?:\\+(${o[s.BUILDIDENTIFIER]}(?:\\.${o[s.BUILDIDENTIFIER]})*))`),c("FULLPLAIN",`v?${o[s.MAINVERSION]}${o[s.PRERELEASE]}?${o[s.BUILD]}?`),c("FULL",`^${o[s.FULLPLAIN]}$`),c("LOOSEPLAIN",`[v=\\s]*${o[s.MAINVERSIONLOOSE]}${o[s.PRERELEASELOOSE]}?${o[s.BUILD]}?`),c("LOOSE",`^${o[s.LOOSEPLAIN]}$`),c("GTLT","((?:<|>)?=?)"),c("XRANGEIDENTIFIERLOOSE",`${o[s.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),c("XRANGEIDENTIFIER",`${o[s.NUMERICIDENTIFIER]}|x|X|\\*`),c("XRANGEPLAIN",`[v=\\s]*(${o[s.XRANGEIDENTIFIER]})(?:\\.(${o[s.XRANGEIDENTIFIER]})(?:\\.(${o[s.XRANGEIDENTIFIER]})(?:${o[s.PRERELEASE]})?${o[s.BUILD]}?)?)?`),c("XRANGEPLAINLOOSE",`[v=\\s]*(${o[s.XRANGEIDENTIFIERLOOSE]})(?:\\.(${o[s.XRANGEIDENTIFIERLOOSE]})(?:\\.(${o[s.XRANGEIDENTIFIERLOOSE]})(?:${o[s.PRERELEASELOOSE]})?${o[s.BUILD]}?)?)?`),c("XRANGE",`^${o[s.GTLT]}\\s*${o[s.XRANGEPLAIN]}$`),c("XRANGELOOSE",`^${o[s.GTLT]}\\s*${o[s.XRANGEPLAINLOOSE]}$`),c("COERCE",`(^|[^\\d])(\\d{1,${a}})(?:\\.(\\d{1,${a}}))?(?:\\.(\\d{1,${a}}))?(?:$|[^\\d])`),c("COERCERTL",o[s.COERCE],!0),c("LONETILDE","(?:~>?)"),c("TILDETRIM",`(\\s*)${o[s.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",c("TILDE",`^${o[s.LONETILDE]}${o[s.XRANGEPLAIN]}$`),c("TILDELOOSE",`^${o[s.LONETILDE]}${o[s.XRANGEPLAINLOOSE]}$`),c("LONECARET","(?:\\^)"),c("CARETTRIM",`(\\s*)${o[s.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",c("CARET",`^${o[s.LONECARET]}${o[s.XRANGEPLAIN]}$`),c("CARETLOOSE",`^${o[s.LONECARET]}${o[s.XRANGEPLAINLOOSE]}$`),c("COMPARATORLOOSE",`^${o[s.GTLT]}\\s*(${o[s.LOOSEPLAIN]})$|^$`),c("COMPARATOR",`^${o[s.GTLT]}\\s*(${o[s.FULLPLAIN]})$|^$`),c("COMPARATORTRIM",`(\\s*)${o[s.GTLT]}\\s*(${o[s.LOOSEPLAIN]}|${o[s.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",c("HYPHENRANGE",`^\\s*(${o[s.XRANGEPLAIN]})\\s+-\\s+(${o[s.XRANGEPLAIN]})\\s*$`),c("HYPHENRANGELOOSE",`^\\s*(${o[s.XRANGEPLAINLOOSE]})\\s+-\\s+(${o[s.XRANGEPLAINLOOSE]})\\s*$`),c("STAR","(<|>)?=?\\s*\\*"),c("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),c("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return E})),n.d(t,"c",(function(){return x}));var a={};n.r(a),n.d(a,"authenticationsSelector",(function(){return c})),n.d(a,"hostsSelector",(function(){return u})),n.d(a,"hostRiskScoreSelector",(function(){return d})),n.d(a,"hostRiskScoreSeverityFilterSelector",(function(){return p})),n.d(a,"uncommonProcessesSelector",(function(){return m})),n.d(a,"hostsAnomaliesJobIdFilterSelector",(function(){return g})),n.d(a,"hostsAnomaliesIntervalSelector",(function(){return f}));var i=n(406),r=n(134),o=n(34),s=n(108);const l=(e,t)=>Object(o.get)(t,e.hosts),c=()=>Object(s.createSelector)(l,(e=>e.queries.authentications)),u=()=>Object(s.createSelector)(l,(e=>e.queries[r.HostsTableType.hosts])),d=()=>Object(s.createSelector)(l,(e=>e.queries[r.HostsTableType.risk])),p=()=>Object(s.createSelector)(l,(e=>e.queries[r.HostsTableType.risk].severitySelection)),m=()=>Object(s.createSelector)(l,(e=>e.queries.uncommonProcesses)),g=()=>Object(s.createSelector)(l,(e=>e.queries[r.HostsTableType.anomalies].jobIdSelection)),f=()=>Object(s.createSelector)(l,(e=>e.queries[r.HostsTableType.anomalies].intervalSelection));var b=n(328),y=n(85),h=n(253),v=n(602);const E={page:{queries:{[r.HostsTableType.authentications]:{activePage:h.a,limit:h.b},[r.HostsTableType.hosts]:{activePage:h.a,limit:h.b,direction:y.b.desc,sortField:y.h.lastSeen},[r.HostsTableType.events]:{activePage:h.a,limit:h.b},[r.HostsTableType.uncommonProcesses]:{activePage:h.a,limit:h.b},[r.HostsTableType.anomalies]:{jobIdSelection:[],intervalSelection:"auto"},[r.HostsTableType.risk]:{activePage:h.a,limit:h.b,sort:{field:y.w.hostRiskScore,direction:y.b.desc},severitySelection:[]},[r.HostsTableType.sessions]:{activePage:h.a,limit:h.b}}},details:{queries:{[r.HostsTableType.authentications]:{activePage:h.a,limit:h.b},[r.HostsTableType.hosts]:{activePage:h.a,direction:y.b.desc,limit:h.b,sortField:y.h.lastSeen},[r.HostsTableType.events]:{activePage:h.a,limit:h.b},[r.HostsTableType.uncommonProcesses]:{activePage:h.a,limit:h.b},[r.HostsTableType.anomalies]:{jobIdSelection:[],intervalSelection:"auto"},[r.HostsTableType.risk]:{activePage:h.a,limit:h.b,sort:{field:y.w.hostRiskScore,direction:y.b.desc},severitySelection:[]},[r.HostsTableType.sessions]:{activePage:h.a,limit:h.b}}}},x=Object(b.reducerWithInitialState)(E).case(i.setHostTablesActivePageToZero,(e=>({...e,page:{...e.page,queries:Object(v.c)(e)},details:{...e.details,queries:Object(v.b)(e)}}))).case(i.setHostDetailsTablesActivePageToZero,(e=>({...e,details:{...e.details,queries:Object(v.b)(e)}}))).case(i.updateTableActivePage,((e,{activePage:t,hostsType:n,tableType:a})=>({...e,[n]:{...e[n],queries:{...e[n].queries,[a]:{...e[n].queries[a],activePage:t}}}}))).case(i.updateTableLimit,((e,{limit:t,hostsType:n,tableType:a})=>({...e,[n]:{...e[n],queries:{...e[n].queries,[a]:{...e[n].queries[a],limit:t}}}}))).case(i.updateHostsSort,((e,{sort:t,hostsType:n})=>({...e,[n]:{...e[n],queries:{...e[n].queries,[r.HostsTableType.hosts]:{...e[n].queries[r.HostsTableType.hosts],direction:t.direction,sortField:t.field,activePage:h.a}}}}))).case(i.updateHostRiskScoreSort,((e,{sort:t,hostsType:n})=>({...e,[n]:{...e[n],queries:{...e[n].queries,[r.HostsTableType.risk]:{...e[n].queries[r.HostsTableType.risk],sort:t}}}}))).case(i.updateHostRiskScoreSeverityFilter,((e,{severitySelection:t,hostsType:n})=>({...e,[n]:{...e[n],queries:{...e[n].queries,[r.HostsTableType.risk]:{...e[n].queries[r.HostsTableType.risk],severitySelection:t,activePage:h.a}}}}))).case(i.updateHostsAnomaliesJobIdFilter,((e,{jobIds:t,hostsType:n})=>({...e,[n]:{...e[n],queries:{...e[n].queries,[r.HostsTableType.anomalies]:{...e[n].queries[r.HostsTableType.anomalies],jobIdSelection:t}}}}))).case(i.updateHostsAnomaliesInterval,((e,{interval:t,hostsType:n})=>({...e,[n]:{...e[n],queries:{...e[n].queries,[r.HostsTableType.anomalies]:{...e[n].queries[r.HostsTableType.anomalies],intervalSelection:t}}}}))).build()},function(e,t,n){"use strict";n.d(t,"a",(function(){return x})),n.d(t,"b",(function(){return k})),n.d(t,"c",(function(){return S}));var a=n(32),i=n(4),r=n.n(i),o=n(34),s=n(83),l=n(123),c=n(141),u=n(82),d=n.n(u);const p=({rowIndex:e,colIndex:t,data:n,header:a,eventId:o,linkValues:s,renderCellValue:l,tabType:c,timelineId:u})=>{const[p,m]=Object(i.useState)({});return r.a.createElement("div",d()({"data-test-subj":"statefulCell"},p),l({columnId:a.id,eventId:o,data:n,header:a,isDraggable:!0,isExpandable:!0,isExpanded:!1,isDetails:!1,isTimeline:!0,linkValues:s,rowIndex:e,colIndex:t,setCellProps:m,scopeId:u,key:null!=c?`${u}-${c}`:u}))};p.displayName="StatefulCellComponent";const m=r.a.memo(p);var g=n(0);const f=({column:e,row:t})=>g.i18n.translate("xpack.securitySolution.timeline.youAreInATableCellScreenReaderOnly",{values:{column:e,row:t},defaultMessage:"You are in a table cell. row: {row}, column: {column}"}),b=e=>g.i18n.translate("xpack.securitySolution.timeline.eventHasEventRendererScreenReaderOnly",{values:{row:e},defaultMessage:"The event in row {row} has an event renderer. Press shift + down arrow to focus it."}),y=({notesCount:e,row:t})=>g.i18n.translate("xpack.securitySolution.timeline.eventHasNotesScreenReaderOnly",{values:{notesCount:e,row:t},defaultMessage:"The event in row {row} has {notesCount, plural, =1 {a note} other {{notesCount} notes}}. Press shift + right arrow to focus notes."}),h=e=>{var t;const{altKey:n,ctrlKey:a,key:i,metaKey:r,shiftKey:o,target:l,type:u}=e,d=l;if((e=>{switch(e){case" ":case"Enter":return!0;default:return!1}})(i)&&null!==(t=d.className)&&void 0!==t&&t.includes(c.b)){const t=d.querySelector(`.${s.a}`),l=new KeyboardEvent(u,{altKey:n,bubbles:!0,cancelable:!0,ctrlKey:a,key:i,metaKey:r,shiftKey:o});" "===i&&e.preventDefault(),null==t||t.dispatchEvent(l)}},v=({action:e,width:t,actionsColumnWidth:n,ariaRowindex:i,columnId:o,columnValues:s,data:u,ecsData:d,eventIdToNoteIds:p,index:m,isEventPinned:g,isEventViewer:v,eventId:E,loadingEventIds:x,notesCount:k,onEventDetailsPanelOpened:S,onRowSelected:w,refetch:j,rowIndex:O,hasRowRenderers:I,onRuleChange:T,selectedEventIds:C,showCheckboxes:M,showNotes:N,tabType:D,timelineId:F,toggleShowNotes:A,setEventsLoading:_,setEventsDeleted:R})=>{const P=t||n;return r.a.createElement(c.m,{width:P,"data-test-subj":"event-actions-container",tabIndex:0},r.a.createElement(c.k,{$ariaColumnIndex:m+l.c,key:null!=D?`${E}_${D}`:`${E}`,onKeyDown:h,role:"button",tabIndex:0,width:t},r.a.createElement(c.l,{"data-test-subj":"cell-container"},r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiScreenReaderOnly,{"data-test-subj":"screenReaderOnly"},r.a.createElement("p",null,f({row:i,column:m+2}))),e&&r.a.createElement(e,{ariaRowindex:i,width:t,checked:Object.keys(C).includes(E),columnId:o,columnValues:s,eventId:E,data:u,ecsData:d,eventIdToNoteIds:p,index:m,isEventPinned:g,isEventViewer:v,loadingEventIds:x,onEventDetailsPanelOpened:S,onRowSelected:w,refetch:j,rowIndex:O,onRuleChange:T,showCheckboxes:M,showNotes:N,timelineId:F,toggleShowNotes:A,setEventsLoading:_,setEventsDeleted:R}))),I?r.a.createElement(a.EuiScreenReaderOnly,{"data-test-subj":"hasRowRendererScreenReaderOnly"},r.a.createElement("p",null,b(i))):null,k?r.a.createElement(a.EuiScreenReaderOnly,{"data-test-subj":"hasNotesScreenReaderOnly"},r.a.createElement("p",null,y({row:i,notesCount:k}))):null))},E=({_id:e,ariaRowindex:t,index:n,header:i,data:s,ecsData:u,hasRowRenderers:d,notesCount:p,renderCellValue:g,tabType:v,timelineId:E})=>{var x;const k=n+l.c;return r.a.createElement(c.k,{$ariaColumnIndex:k,key:null!=v?`${i.id}_${v}`:`${i.id}`,onKeyDown:h,role:"button",tabIndex:0,width:i.initialWidth},r.a.createElement(c.l,{"data-test-subj":"cell-container"},r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiScreenReaderOnly,{"data-test-subj":"screenReaderOnly"},r.a.createElement("p",null,f({row:t,column:k}))),r.a.createElement(m,{rowIndex:t-1,colIndex:k-1,data:s,header:i,eventId:e,linkValues:Object(o.getOr)([],null!==(x=i.linkField)&&void 0!==x?x:"",u),renderCellValue:g,tabType:v,timelineId:E}))),d?r.a.createElement(a.EuiScreenReaderOnly,{"data-test-subj":"hasRowRendererScreenReaderOnly"},r.a.createElement("p",null,b(t))):null,p?r.a.createElement(a.EuiScreenReaderOnly,{"data-test-subj":"hasNotesScreenReaderOnly"},r.a.createElement("p",null,y({row:t,notesCount:p}))):null)},x=r.a.memo((({ariaRowindex:e,actionsColumnWidth:t,columnHeaders:n,columnValues:a,data:o,ecsData:s,eventIdToNoteIds:l,isEventPinned:u,isEventViewer:d,id:p,loadingEventIds:m,notesCount:g,onEventDetailsPanelOpened:f,onRowSelected:b,refetch:y,hasRowRenderers:h,onRuleChange:x,renderCellValue:k,selectedEventIds:S,showCheckboxes:w,showNotes:j,tabType:O,timelineId:I,toggleShowNotes:T,trailingControlColumns:C,leadingControlColumns:M,setEventsLoading:N,setEventsDeleted:D})=>{const F=Object(i.useMemo)((()=>C?C.map((e=>e.rowCellRender)):[]),[C]),A=Object(i.useMemo)((()=>M.length+n.length),[M,n]),_=Object(i.useMemo)((()=>F.map(((n,i)=>n&&r.a.createElement(v,{action:n,width:C[i].width,actionsColumnWidth:t,ariaRowindex:e,checked:Object.keys(S).includes(p),columnId:C[i].id||"",columnValues:a,onRowSelected:b,"data-test-subj":"actions",eventId:p,data:o,key:i,index:A+i,rowIndex:e,ecsData:s,loadingEventIds:m,onEventDetailsPanelOpened:f,showCheckboxes:w,eventIdToNoteIds:l,isEventPinned:u,isEventViewer:d,notesCount:g,refetch:y,hasRowRenderers:h,onRuleChange:x,selectedEventIds:S,showNotes:j,tabType:O,timelineId:I,toggleShowNotes:T,setEventsLoading:N,setEventsDeleted:D})))),[C,p,o,s,b,u,d,t,e,a,l,h,A,m,g,f,x,y,S,w,j,O,I,T,F,N,D]),R=Object(i.useMemo)((()=>n.map(((t,n)=>r.a.createElement(E,{_id:p,index:n,header:t,key:null!=O?`${t.id}_${O}`:`${t.id}`,ariaRowindex:e,data:o,ecsData:s,hasRowRenderers:h,notesCount:g,renderCellValue:k,tabType:O,timelineId:I})))),[p,e,n,o,s,h,g,k,O,I]);return r.a.createElement(c.n,{"data-test-subj":"data-driven-columns"},R,_)}));x.displayName="DataDrivenColumns";const k=({data:e,fieldName:t})=>{if(!e||0===e.length)return;const n=e.find((e=>e.field===t));return null!=n&&null!=n.value?n.value:void 0},S=({data:e,fieldName:t})=>Object(i.useMemo)((()=>k({data:e,fieldName:t})),[e,t])},function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return b})),n.d(t,"c",(function(){return y}));var a=n(4),i=n.n(a),r=n(1),o=n(679),s=n(77),l=n(719),c=n(7);const u=(e,t,n)=>e>t?n:e<t?-n:0,d={filter:"",tags:[],showCustomRules:!1,showElasticRules:!1},p={field:"enabled",order:"desc"},m=Object(a.createContext)(null),g="detection-rules-table-in-memory",f=({children:e})=>{var t;const[n]=Object(s.q)(r.cb),{storage:o}=Object(s.k)().services,[f,b]=Object(a.useState)(null!==(t=o.get(g))&&void 0!==t&&t),[y,h]=Object(a.useState)(d),[v,E]=Object(a.useState)(p),[x,k]=Object(a.useState)(!1),[S,w]=Object(a.useState)(n.on),[j,O]=Object(a.useState)({ids:[],action:null}),[I,T]=Object(a.useState)(!1),[C,M]=Object(a.useState)(1),[N,D]=Object(a.useState)(20),[F,A]=Object(a.useState)([]),_=Object(a.useRef)(null),R=Object(a.useCallback)((e=>{b(e),o.set(g,e),!1===e&&E(p)}),[o]),P=j.ids.length>0,L=Object(a.useMemo)((()=>({page:C,perPage:N})),[C,N]),q=Object(a.useCallback)((e=>{h((t=>({...t,...e}))),M(1),A([]),k(!1)}),[]),B=Object(a.useCallback)((()=>{A([]),k(!1)}),[]);Object(a.useEffect)((()=>{var e;F.length>0?(w(!1),null==_.current&&(_.current=S)):(w(null!==(e=_.current)&&void 0!==e?e:S),_.current=null)}),[F,S]);const{data:{rules:z,total:$}={rules:[],total:0},refetch:V,dataUpdatedAt:U,isFetched:H,isFetching:G,isLoading:Q,isRefetching:W}=Object(l.a)({isInMemorySorting:f,filterOptions:y,sortingOptions:v,pagination:L,refetchInterval:S&&!P&&n.value}),K=f?z.sort(function(e){return(t,n)=>{const{field:a,order:i}=e,r="asc"===i?1:-1;switch(a){case"enabled":{const e=Object(c.get)(t,a),i=Object(c.get)(n,a);return u(Number(e),Number(i),r)}case"version":case"risk_score":case"execution_summary.last_execution.metrics.execution_gap_duration_s":case"execution_summary.last_execution.metrics.total_indexing_duration_ms":case"execution_summary.last_execution.metrics.total_search_duration_ms":{var o,s;const e=null!==(o=Object(c.get)(t,a))&&void 0!==o?o:-1/0,i=null!==(s=Object(c.get)(n,a))&&void 0!==s?s:-1/0;return u(e,i,r)}case"updated_at":case"created_at":case"execution_summary.last_execution.date":{const e=Object(c.get)(t,a),i=Object(c.get)(n,a);return u(null==e?0:new Date(e).getTime(),null==i?0:new Date(i).getTime(),r)}case"execution_summary.last_execution.status":case"severity":case"name":{const e=Object(c.get)(t,a),i=Object(c.get)(n,a);return(e||"").localeCompare(i||"")*r}}}}(v)).slice((C-1)*N,C*N):z,Y=Object(a.useMemo)((()=>({state:{rules:K,pagination:{page:C,perPage:N,total:f?z.length:$},filterOptions:y,isPreflightInProgress:I,isActionInProgress:P,isAllSelected:x,isFetched:H,isFetching:G,isInMemorySorting:f,isLoading:Q,isRefetching:W,isRefreshOn:S,lastUpdated:U,loadingRuleIds:j.ids,loadingRulesAction:j.action,selectedRuleIds:F,sortingOptions:v},actions:{reFetchRules:V,setFilterOptions:q,setIsAllSelected:k,setIsInMemorySorting:R,setIsRefreshOn:w,setLoadingRules:O,setPage:M,setPerPage:D,setSelectedRuleIds:A,setSortingOptions:E,setIsPreflightInProgress:T,clearRulesSelection:B}})),[K,C,N,f,z.length,$,y,I,P,x,H,G,Q,W,S,U,j.ids,j.action,F,v,V,q,R,B]);return i.a.createElement(m.Provider,{value:Y},e)},b=()=>{const e=Object(a.useContext)(m);return Object(o.a)(e,"useRulesTableContext should be used inside RulesTableContextProvider"),e},y=()=>Object(a.useContext)(m)},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a="row-renderer-example"},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"j",(function(){return r})),n.d(t,"l",(function(){return o})),n.d(t,"k",(function(){return s})),n.d(t,"f",(function(){return l})),n.d(t,"i",(function(){return c})),n.d(t,"h",(function(){return u})),n.d(t,"g",(function(){return d})),n.d(t,"a",(function(){return p})),n.d(t,"c",(function(){return m})),n.d(t,"e",(function(){return g})),n.d(t,"d",(function(){return f}));var a=n(0);a.i18n.translate("xpack.securitySolution.timeline.properties.timelineDescription",{defaultMessage:"Timeline Description"});const i=a.i18n.translate("xpack.securitySolution.timeline.properties.addToFavoriteButtonLabel",{defaultMessage:"Add to favorites"}),r=a.i18n.translate("xpack.securitySolution.timeline.properties.removeFromFavoritesButtonLabel",{defaultMessage:"Remove from favorites"}),o=a.i18n.translate("xpack.securitySolution.timeline.properties.untitledTimelinePlaceholder",{defaultMessage:"Untitled timeline"}),s=a.i18n.translate("xpack.securitySolution.timeline.properties.untitledTemplatePlaceholder",{defaultMessage:"Untitled template"}),l=a.i18n.translate("xpack.securitySolution.timeline.properties.descriptionPlaceholder",{defaultMessage:"Add a description"}),c=a.i18n.translate("xpack.securitySolution.timeline.properties.notesButtonLabel",{defaultMessage:"Notes"}),u=a.i18n.translate("xpack.securitySolution.timeline.properties.newTimelineButtonLabel",{defaultMessage:"Create new timeline"}),d=a.i18n.translate("xpack.securitySolution.timeline.properties.newTemplateTimelineButtonLabel",{defaultMessage:"Create new timeline template"}),p=a.i18n.translate("xpack.securitySolution.timeline.properties.addTimelineButtonLabel",{defaultMessage:"Add new timeline or template"}),m=a.i18n.translate("xpack.securitySolution.timeline.properties.attachToCaseButtonLabel",{defaultMessage:"Attach to case"}),g=a.i18n.translate("xpack.securitySolution.timeline.properties.attachToNewCaseButtonLabel",{defaultMessage:"Attach to new case"}),f=a.i18n.translate("xpack.securitySolution.timeline.properties.attachToExistingCaseButtonLabel",{defaultMessage:"Attach to existing case"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(4),i=n(77);const r=(e,t)=>{const{services:n}=Object(i.k)(),{path:r,state:o,onClick:s,deepLinkId:l,openInNewTab:c}=t||{};return Object(a.useCallback)((t=>{try{s&&s(t)}catch(e){throw t.preventDefault(),e}t.defaultPrevented||0===t.button&&(t.currentTarget instanceof HTMLAnchorElement&&""!==t.currentTarget.target&&"_self"!==t.currentTarget.target||t.metaKey||t.altKey||t.ctrlKey||t.shiftKey||(t.preventDefault(),n.application.navigateToApp(e,{deepLinkId:l,path:r,state:o,openInNewTab:c})))}),[e,l,s,r,n.application,o,c])}},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return v})),n.d(t,"d",(function(){return E})),n.d(t,"e",(function(){return x}));var a=n(4),i=n.n(a),r=n(33),o=n.n(r);const s=o.a.aside.attrs({className:"siemUtilityBar"}).withConfig({displayName:"Bar",componentId:"sc-1kna171-0"})(["",""],(({border:e,theme:t})=>Object(r.css)([""," @media only screen and (min-width:","){display:flex;justify-content:space-between;}"],e&&Object(r.css)(["border-bottom:",";padding-bottom:",";"],t.eui.euiBorderThin,t.eui.euiSizeS),t.eui.euiBreakpoints.l)));s.displayName="Bar";const l=o.a.div.attrs({className:"siemUtilityBar__section"}).withConfig({displayName:"BarSection",componentId:"sc-1kna171-1"})(["",""],(({grow:e,theme:t})=>Object(r.css)(["& + &{margin-top:",";}@media only screen and (min-width:","){display:flex;flex-wrap:wrap;}@media only screen and (min-width:","){& + &{margin-top:0;margin-left:",";}}",""],t.eui.euiSizeS,t.eui.euiBreakpoints.m,t.eui.euiBreakpoints.l,t.eui.euiSize,e&&Object(r.css)(["flex:1;"]))));l.displayName="BarSection";const c=o.a.div.attrs({className:"siemUtilityBar__group"}).withConfig({displayName:"BarGroup",componentId:"sc-1kna171-2"})(["",""],(({grow:e,theme:t})=>Object(r.css)(["align-items:flex-start;display:flex;flex-wrap:wrap;& + &{margin-top:",";}@media only screen and (min-width:","){border-right:",";flex-wrap:nowrap;margin-right:",";padding-right:",";& + &{margin-top:0;}&:last-child{border-right:none;margin-right:0;padding-right:0;}}& > *{margin-right:",";&:last-child{margin-right:0;}}",""],t.eui.euiSizeS,t.eui.euiBreakpoints.m,t.eui.euiBorderThin,t.eui.euiSizeM,t.eui.euiSizeM,t.eui.euiSize,e&&Object(r.css)(["flex:1;"]))));c.displayName="BarGroup";const u=o.a.p.attrs({className:"siemUtilityBar__text"}).withConfig({displayName:"BarText",componentId:"sc-1kna171-3"})(["",""],(({shouldWrap:e,theme:t})=>Object(r.css)(["color:",";font-size:",";line-height:",";white-space:",";"],t.eui.euiTextSubduedColor,t.eui.euiFontSizeXS,t.eui.euiLineHeight,e?"normal":"nowrap")));u.displayName="BarText";const d=o.a.div.attrs({className:"siemUtilityBar__action"}).withConfig({displayName:"BarAction",componentId:"sc-1kna171-4"})(["",""],(({theme:e})=>Object(r.css)(["font-size:",";line-height:",";"],e.eui.euiFontSizeXS,e.eui.euiLineHeight)));d.displayName="BarAction";const p=o.a.div.attrs({className:"siemUtilityBar__spacer"}).withConfig({displayName:"BarSpacer",componentId:"sc-1kna171-5"})(["",""],(()=>Object(r.css)(["flex:1;"])));p.displayName="BarSpacer";const m=i.a.memo((({border:e,children:t})=>i.a.createElement(s,{border:e},t)));m.displayName="UtilityBar";var g=n(32),f=n(607);const b=o()(g.EuiButtonEmpty).withConfig({displayName:"LoadingButtonEmpty",componentId:"sc-8y0kr-0"})(["",""],(({theme:e})=>Object(r.css)(["&.euiButtonEmpty.euiButtonEmpty--xSmall{height:",";.euiButtonEmpty__content{padding:0;}}"],e.eui.euiSize))),y=i.a.memo((({children:e,color:t,iconSide:n,iconSize:r,iconType:o,popoverContent:s,disabled:l,ownFocus:c,dataTestSubj:u,popoverPanelPaddingSize:d,onClick:p})=>{const[m,b]=Object(a.useState)(!1),y=Object(a.useCallback)((()=>b(!1)),[b]),h=Object(a.useCallback)((()=>{null==p||p(),b(!m)}),[m,p]);return i.a.createElement(g.EuiPopover,{ownFocus:c,panelPaddingSize:d,button:i.a.createElement(f.a,{dataTestSubj:u,color:t,iconSide:n,iconSize:r,iconType:o,disabled:l,onClick:h},e),closePopover:y,isOpen:m,repositionOnScroll:!0},null==s?void 0:s(y))}));y.displayName="Popover";const h=i.a.memo((({children:e,color:t,dataTestSubj:n,disabled:a,href:r,iconSide:o,iconSize:s,iconType:l,ownFocus:c,onClick:u,popoverContent:p,popoverPanelPaddingSize:m,inProgress:g})=>g?i.a.createElement(d,null,i.a.createElement(b,{"data-test-subj":`${n}-progress`,size:"xs",className:"eui-alignTop",isLoading:!0,iconSide:"right"},e)):i.a.createElement(d,{"data-test-subj":n},p?i.a.createElement(y,{dataTestSubj:`${n}-popover`,disabled:a,color:t,iconSide:o,iconSize:s,iconType:l,ownFocus:c,popoverPanelPaddingSize:m,popoverContent:p,onClick:u},e):i.a.createElement(f.a,{color:t,dataTestSubj:`${n}-linkIcon`,disabled:a,href:r,iconSide:o,iconSize:s,iconType:l,onClick:u},e))));h.displayName="UtilityBarAction";const v=i.a.memo((({grow:e,children:t})=>i.a.createElement(c,{grow:e},t)));v.displayName="UtilityBarGroup";const E=i.a.memo((({grow:e,children:t,dataTestSubj:n})=>i.a.createElement(l,{grow:e,"data-test-subj":n},t)));E.displayName="UtilityBarSection",i.a.memo((({dataTestSubj:e})=>i.a.createElement(p,{"data-test-subj":e}))).displayName="UtilityBarSpacer";const x=i.a.memo((({children:e,dataTestSubj:t,shouldWrap:n=!1})=>i.a.createElement(u,{"data-test-subj":t,shouldWrap:n},e)));x.displayName="UtilityBarText"},function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return b}));var a=n(4),i=n(171),r=n(259),o=n(1);const s=e=>e.groups.some((e=>o.Rb.includes(e)));var l=n(84),c=n(77),u=n(120),d=n(389),p=n(129),m=n(534);const g=Object(p.d)(m.a),f=()=>{const[e,t]=Object(a.useState)([]),{addError:n}=Object(l.a)(),o=Object(u.a)(),m=Object(c.j)(),{error:f,loading:b,result:y,start:h}=Object(p.a)(g),v=Object(i.a)(o),E=Object(r.a)(o);return Object(a.useEffect)((()=>{v&&E&&h({http:m})}),[m,v,E,h]),Object(a.useEffect)((()=>{if(y){const e=y.filter(s);t(e)}}),[y]),Object(a.useEffect)((()=>{f&&n(f,{title:d.a})}),[n,f]),{isLicensed:E,isMlUser:v,jobs:e,loading:b}},b=()=>{const{jobs:e,loading:t}=f();return{jobIds:Object(a.useMemo)((()=>e.map((e=>e.id))),[e]),loading:t}}},,function(e,t,n){"use strict";var a,i=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),r=[];function o(e){for(var t=-1,n=0;n<r.length;n++)if(r[n].identifier===e){t=n;break}return t}function s(e,t){for(var n={},a=[],i=0;i<e.length;i++){var s=e[i],l=t.base?s[0]+t.base:s[0],c=n[l]||0,u="".concat(l," ").concat(c);n[l]=c+1;var d=o(u),p={css:s[1],media:s[2],sourceMap:s[3]};-1!==d?(r[d].references++,r[d].updater(p)):r.push({identifier:u,updater:f(p,t),references:1}),a.push(u)}return a}function l(e){var t=document.createElement("style"),a=e.attributes||{};if(void 0===a.nonce){var r=n.nc;r&&(a.nonce=r)}if(Object.keys(a).forEach((function(e){t.setAttribute(e,a[e])})),"function"==typeof e.insert)e.insert(t);else{var o=i(e.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}return t}var c,u=(c=[],function(e,t){return c[e]=t,c.filter(Boolean).join("\n")});function d(e,t,n,a){var i=n?"":a.media?"@media ".concat(a.media," {").concat(a.css,"}"):a.css;if(e.styleSheet)e.styleSheet.cssText=u(t,i);else{var r=document.createTextNode(i),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(r,o[t]):e.appendChild(r)}}function p(e,t,n){var a=n.css,i=n.media,r=n.sourceMap;if(i?e.setAttribute("media",i):e.removeAttribute("media"),r&&"undefined"!=typeof btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),e.styleSheet)e.styleSheet.cssText=a;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(a))}}var m=null,g=0;function f(e,t){var n,a,i;if(t.singleton){var r=g++;n=m||(m=l(t)),a=d.bind(null,n,r,!1),i=d.bind(null,n,r,!0)}else n=l(t),a=p.bind(null,n,t),i=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return a(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;a(e=t)}else i()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===a&&(a=Boolean(window&&document&&document.all&&!window.atob)),a));var n=s(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var a=0;a<n.length;a++){var i=o(n[a]);r[i].references--}for(var l=s(e,t),c=0;c<n.length;c++){var u=o(n[c]);0===r[u].references&&(r[u].updater(),r.splice(u,1))}n=l}}}},function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n,a,i,r=e[1]||"",o=e[3];if(!o)return r;if(t&&"function"==typeof btoa){var s=(n=o,a=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),i="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),"/*# ".concat(i," */")),l=o.sources.map((function(e){return"/*# sourceURL=".concat(o.sourceRoot||"").concat(e," */")}));return[r].concat(l).concat([s]).join("\n")}return[r].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,a){"string"==typeof e&&(e=[[null,e,""]]);var i={};if(a)for(var r=0;r<this.length;r++){var o=this[r][0];null!=o&&(i[o]=!0)}for(var s=0;s<e.length;s++){var l=[].concat(e[s]);a&&i[l[0]]||(n&&(l[2]?l[2]="".concat(n," and ").concat(l[2]):l[2]=n),t.push(l))}},t}},function(e,t,n){"use strict";var a=function(e){return function(e){return!!e&&"object"==typeof e}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===i}(e)}(e)},i="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function r(e,t){return!1!==t.clone&&t.isMergeableObject(e)?c((n=e,Array.isArray(n)?[]:{}),e,t):e;var n}function o(e,t,n){return e.concat(t).map((function(e){return r(e,n)}))}function s(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(t){return e.propertyIsEnumerable(t)})):[]}(e))}function l(e,t){try{return t in e}catch(e){return!1}}function c(e,t,n){(n=n||{}).arrayMerge=n.arrayMerge||o,n.isMergeableObject=n.isMergeableObject||a,n.cloneUnlessOtherwiseSpecified=r;var i=Array.isArray(t);return i===Array.isArray(e)?i?n.arrayMerge(e,t,n):function(e,t,n){var a={};return n.isMergeableObject(e)&&s(e).forEach((function(t){a[t]=r(e[t],n)})),s(t).forEach((function(i){(function(e,t){return l(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))})(e,i)||(l(e,i)&&n.isMergeableObject(t[i])?a[i]=function(e,t){if(!t.customMerge)return c;var n=t.customMerge(e);return"function"==typeof n?n:c}(i,n)(e[i],t[i],n):a[i]=r(t[i],n))})),a}(e,t,n):r(t,n)}c.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,n){return c(e,n,t)}),{})};var u=c;e.exports=u},function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));const a=10,i=0},function(e,t,n){"use strict";n.d(t,"i",(function(){return i})),n.d(t,"h",(function(){return r})),n.d(t,"j",(function(){return o})),n.d(t,"q",(function(){return s})),n.d(t,"k",(function(){return l})),n.d(t,"l",(function(){return c})),n.d(t,"o",(function(){return u})),n.d(t,"p",(function(){return d})),n.d(t,"f",(function(){return p})),n.d(t,"r",(function(){return m})),n.d(t,"s",(function(){return g})),n.d(t,"a",(function(){return f})),n.d(t,"e",(function(){return b})),n.d(t,"b",(function(){return y})),n.d(t,"n",(function(){return h})),n.d(t,"c",(function(){return v})),n.d(t,"m",(function(){return E})),n.d(t,"d",(function(){return x})),n.d(t,"g",(function(){return k}));var a=n(0);const i=a.i18n.translate("xpack.securitySolution.timeline.body.notes.addNoteTooltip",{defaultMessage:"Add note"}),r=a.i18n.translate("xpack.securitySolution.timeline.body.notes.disableEventTooltip",{defaultMessage:"Notes may not be added here while editing a template timeline"}),o=a.i18n.translate("xpack.securitySolution.timeline.body.openSessionViewLabel",{defaultMessage:"Open Session View"}),s=e=>a.i18n.translate("xpack.securitySolution.timeline.body.pinning.pinTooltip",{values:{isAlert:e},defaultMessage:"Pin {isAlert, select, true{alert} other{event}}"}),l=e=>a.i18n.translate("xpack.securitySolution.timeline.body.pinning.unpinTooltip",{values:{isAlert:e},defaultMessage:"Unpin {isAlert, select, true{alert} other{event}}"}),c=e=>a.i18n.translate("xpack.securitySolution.timeline.body.pinning.pinnnedWithNotesTooltip",{values:{isAlert:e},defaultMessage:"This {isAlert, select, true{alert} other{event}} cannot be unpinned because it has notes"}),u=a.i18n.translate("xpack.securitySolution.timeline.body.sort.sortedAscendingTooltip",{defaultMessage:"Sorted ascending"}),d=a.i18n.translate("xpack.securitySolution.timeline.body.sort.sortedDescendingTooltip",{defaultMessage:"Sorted descending"}),p=e=>a.i18n.translate("xpack.securitySolution.timeline.body.pinning.disablePinnnedTooltip",{values:{isAlert:e},defaultMessage:"This {isAlert, select, true{alert} other{event}} may not be pinned while editing a template timeline"}),m=a.i18n.translate("xpack.securitySolution.timeline.body.actions.viewDetailsAriaLabel",{defaultMessage:"View details"}),g=({ariaRowindex:e,columnValues:t})=>a.i18n.translate("xpack.securitySolution.timeline.body.actions.viewDetailsForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t},defaultMessage:"View details for the alert or event in row {ariaRowindex}, with columns {columnValues}"}),f=a.i18n.translate("xpack.securitySolution.timeline.body.actions.investigateInResolverTooltip",{defaultMessage:"Analyze event"}),b=({ariaRowindex:e,columnValues:t,checked:n})=>a.i18n.translate("xpack.securitySolution.timeline.body.actions.checkboxForRowAriaLabel",{values:{ariaRowindex:e,checked:n,columnValues:t},defaultMessage:"{checked, select, false {unchecked} true {checked}} checkbox for the alert or event in row {ariaRowindex}, with columns {columnValues}"}),y=({ariaRowindex:e,columnValues:t})=>a.i18n.translate("xpack.securitySolution.timeline.body.actions.investigateInResolverForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t},defaultMessage:"Analyze the alert or event in row {ariaRowindex}, with columns {columnValues}"}),h=({ariaRowindex:e,columnValues:t})=>a.i18n.translate("xpack.securitySolution.timeline.body.actions.sendAlertToTimelineForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t},defaultMessage:"Send the alert in row {ariaRowindex} to timeline, with columns {columnValues}"}),v=({ariaRowindex:e,columnValues:t})=>a.i18n.translate("xpack.securitySolution.timeline.body.actions.addNotesForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t},defaultMessage:"Add notes for the event in row {ariaRowindex} to timeline, with columns {columnValues}"}),E=({ariaRowindex:e,columnValues:t,isEventPinned:n})=>a.i18n.translate("xpack.securitySolution.timeline.body.actions.pinEventForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t,isEventPinned:n},defaultMessage:"{isEventPinned, select, false {Pin} true {Unpin}} the event in row {ariaRowindex} to timeline, with columns {columnValues}"}),x=({ariaRowindex:e,columnValues:t})=>a.i18n.translate("xpack.securitySolution.timeline.body.actions.attachAlertToCaseForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t},defaultMessage:"Attach the alert or event in row {ariaRowindex} to a case, with columns {columnValues}"}),k=({ariaRowindex:e,columnValues:t})=>a.i18n.translate("xpack.securitySolution.timeline.body.actions.moreActionsForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t},defaultMessage:"Select more actions for the alert or event in row {ariaRowindex}, with columns {columnValues}"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"c",(function(){return m})),n.d(t,"d",(function(){return b})),n.d(t,"b",(function(){return y}));var a=n(135),i=n(79),r=n(95),o=n(618);const s=[i.g.alertsOnAlertsPage,i.g.alertsOnRuleDetailsPage,i.j.casePage],l=[{value:"all",inputDisplay:o.b,"data-test-subj":"option-all"}],c=[{value:"raw",inputDisplay:o.d,"data-test-subj":"option-raw"}],u=[{value:"alert",inputDisplay:o.a,"data-test-subj":"option-alert"}],d=[...c,...u],p=e=>{switch(e){case"all":return l;case"raw":return c;case"alert":return u;default:return d}},m=e=>!!e&&s.includes(e),g=[a.a,a.b,a.c,a.d,a.e,a.f,a.h,a.i,a.y,a.n,a.B,a.j,a.k,a.P,a.Z,a.ab,a.bb,a.l,a.o,a.p,a.q,a.r,a.u,a.v,a.w,a.x,a.z,a.A,a.C,a.D,a.E,a.F,a.G,a.H,a.I,a.J,a.K,a.L,a.m,a.M,a.N,a.O,a.W,a.Y,"signal.rule.building_block_type","signal.rule.id","signal.rule.name","signal.rule.threat_mapping","signal.status"],f=({tableId:e,view:t})=>"raw"===t&&m(e),b=({filters:e,tableId:t,view:n})=>f({tableId:t,view:n})?e.filter((e=>!g.includes(`${e.meta.key}`))):e,y=({scopeId:e,view:t})=>f({tableId:e,view:t})?r.SourcererScopeName.default:m(e)?r.SourcererScopeName.detections:e===i.j.active?r.SourcererScopeName.timeline:r.SourcererScopeName.default},function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return g}));var a=n(83),i=n(34),r=n(4),o=n(176),s=n(624),l=n(305),c=n(429),u=n(258),d=n(140),p=n(104);const m=(e,t,n,i=p.a)=>({and:[],enabled:!0,id:Object(a.i)(t),name:e,excluded:!1,kqlQuery:"",queryMatch:{field:e,value:n,operator:i,displayValue:Object(c.d)(n)}}),g=({contextId:e,eventId:t,field:n,fieldFormat:a,fieldFromBrowserField:c,fieldType:p,isObjectArray:g,linkValue:f,values:b})=>Object(r.useMemo)((()=>null==b?null:(Array.isArray(b)?b:[b]).reduce(((r,y,h)=>{let v="",E=Object(i.isString)(y)?y:`${b}`;const x=`${e}-${t}-${n}-${h}-${y}`;if(null==c)return r.values.push(E),r;if(g||p===o.e||[o.h].includes(n))return r.values.push(E),r;if(p===o.g){if(v=`formatted-ip-data-provider-${e}-${n}-${y}-${t}`,Object(i.isString)(y)&&!Object(i.isEmpty)(y)){let e=y;try{e=JSON.parse(y)}catch(e){}return Object(i.isArray)(e)&&(E=e.join(","),e.forEach((e=>r.dataProviders.push(m(n,v,e))))),r.dataProviders.push(m(n,v,e)),r.values.push(E),r}}else u.b.some((e=>n===e))?v=`port-default-draggable-${x}`:n===l.b?v=`duration-default-draggable-${x}`:n===o.f?v=`event-details-value-default-draggable-${x}`:a===s.a?v=`bytes-default-draggable-${x}`:n===o.l?v=`event-details-value-default-draggable-${x}-${f}`:n===o.c?v=`event-details-value-default-draggable-${x}-${y}`:n===o.m?v=`alert-details-value-default-draggable-${x}`:n===o.a?(v=`event-details-value-default-draggable-${x}`,E="string"==typeof y?y:""):v=[o.k,o.j,o.d,d.j].includes(n)?`event-details-value-default-draggable-${x}-${y}`:`event-details-value-default-draggable-${x}`;return r.values.push(E),r.dataProviders.push(m(n,v,y)),r}),{values:[],dataProviders:[]})),[e,t,n,a,c,p,g,f,b])},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(4),i=n.n(a),r=n(44),o=n.n(r),s=n(1),l=n(77);const c=({value:e})=>i.a.createElement(i.a.Fragment,null,(()=>{const[e]=Object(l.q)(s.N);return t=>((e,t)=>o()(e).format(t))(t,e)})()(e));c.displayName="PreferenceFormattedBytesComponent";const u=i.a.memo(c);u.displayName="PreferenceFormattedBytes"},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return r}));const a="destination.port",i="source.port",r=["client.port",a,"server.port",i,"url.port"]},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=e=>e.isPlatinumOrTrialLicense},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"g",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"f",(function(){return l})),n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return u}));var a=n(0);a.i18n.translate("xpack.securitySolution.timeline.tcp",{defaultMessage:"TCP"});const i=a.i18n.translate("xpack.securitySolution.timeline.destination",{defaultMessage:"Destination"}),r=a.i18n.translate("xpack.securitySolution.timeline.file.fromOriginalPathDescription",{defaultMessage:"from its original path"}),o=a.i18n.translate("xpack.securitySolution.timeline.source",{defaultMessage:"Source"}),s=a.i18n.translate("xpack.securitySolution.auditd.inDescription",{defaultMessage:"in"}),l=a.i18n.translate("xpack.securitySolution.auditd.nonExistentDescription",{defaultMessage:"an unknown process"}),c=a.i18n.translate("xpack.securitySolution.event.module.linkToElasticEndpointSecurityDescription",{defaultMessage:"Open in Endpoint Security"}),u=a.i18n.translate("xpack.securitySolution.hostIsolation.agentStatuses.empty",{defaultMessage:"-"})},function(e,t,n){"use strict";n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return v})),n.d(t,"d",(function(){return E})),n.d(t,"c",(function(){return x}));var a=n(4),i=n.n(a),r=n(34),o=n(93),s=n(195),l=n(1),c=n(834),u=n(190),d=n(89),p=n(156),m=n(374),g=n(479);const f=e=>t=>""!==e.trim()?Object(u.d)(t,[{comment:e}]):t,b=e=>t=>""!==e.trim()?Object(u.e)(t,e):t,y=(e,t)=>n=>e===o.b.ENDPOINT?Object(u.k)(Object(u.c)(n,t)):n,h=({itemName:e,commentToAdd:t,addToRules:n,addToSharedLists:a,sharedLists:i,selectedOs:s,listType:l,items:c})=>{const d=Object(r.pipe)(f(t),b(e),y(l,s),((e,t)=>n=>t&&e!==o.b.ENDPOINT?Object(u.f)(n):n)(l,n),((e,t,n)=>a=>t&&e!==o.b.ENDPOINT?Object(u.g)(a,n):a)(l,a,i))(c);return d},v=({itemName:e,commentToAdd:t,selectedOs:n,listType:a,items:i})=>Object(r.pipe)(f(t),b(e),y(a,n))(i),E=()=>[{field:"name",name:"Name",sortable:!0,"data-test-subj":"exceptionListNameCell"},{field:"referenced_rules",name:"Number of rules linked to",sortable:!1,"data-test-subj":"exceptionListRulesLinkedToIdCell",render:e=>i.a.createElement(s.e,{emptyButton:!0,useCustomActions:!0,actions:Object(s.j)({dataTestSubj:"addToSharedListsLinkedRulesMenu",linkedRules:e,securityLinkAnchorComponent:c.e}),panelPaddingSize:"none",disableActions:!1,text:e.length.toString(),dataTestSubj:"addToSharedListsLinkedRulesMenuAction"})},{name:"Action","data-test-subj":"exceptionListRulesActionCell",render:e=>i.a.createElement(d.k,{"data-test-subj":"exceptionListActionCell-link",deepLinkId:l.uc.exceptions,path:`/details/${e.list_id}`,external:!0},g.b)}],x=()=>[{field:"name",align:"left",name:"Name",sortable:!0,"data-test-subj":"ruleNameCell",truncateText:!1},{name:"Action","data-test-subj":"ruleAction-view",render:e=>i.a.createElement(d.k,{"data-test-subj":"ruleAction-viewDetails",deepLinkId:l.uc.rules,path:Object(p.c)(e.id,m.b.alerts),external:!0},g.c)}]},function(e,t,n){const{MAX_LENGTH:a}=n(308),{re:i,t:r}=n(235),o=n(125),s=n(322);e.exports=(e,t)=>{if(t=s(t),e instanceof o)return e;if("string"!=typeof e)return null;if(e.length>a)return null;if(!(t.loose?i[r.LOOSE]:i[r.FULL]).test(e))return null;try{return new o(e,t)}catch(e){return null}}},function(e,t,n){"use strict";var a=n(309);e.exports=function(e){return a({},e)}},function(e,t,n){"use strict";n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return m})),n.d(t,"d",(function(){return g})),n.d(t,"a",(function(){return f}));var a=n(4),i=n.n(a),r=n(676),o=n(176),s=n(140),l=n(306),c=n(258),u=n(77);const d=[{columnId:o.f,label:r.e},{columnId:"source.ip",fieldType:l.b,label:r.a},{columnId:"destination.ip",fieldType:l.b,label:r.a},{columnId:o.l,label:r.h,linkField:"kibana.alert.rule.uuid"},{columnId:"signal.rule.name",label:r.h,linkField:"signal.rule.id"},...c.b.map((e=>({columnId:e,label:r.g}))),{columnId:o.k,label:r.i},{columnId:o.j,label:r.i},{columnId:o.d,label:r.d},{columnId:s.j,label:r.f},{columnId:o.n,label:r.j}],p=(e,t,n)=>d.find((a=>a.columnId===e||!(!a.fieldType||t!==a.fieldType||void 0===n&&void 0===a.linkField))),m=()=>{},g=()=>{const{timelines:e,data:{query:{filterManager:t}}}=Object(u.k)().services;return{timelines:e,filterManager:t}},f=()=>i.a.createElement(i.a.Fragment,null)},function(e,t,n){"use strict";n.d(t,"b",(function(){return j})),n.d(t,"a",(function(){return B})),n.d(t,"d",(function(){return P})),n.d(t,"c",(function(){return d}));var a=n(0),i=a.i18n.translate("autocomplete.loadingDescription",{defaultMessage:"Loading..."}),r=a.i18n.translate("autocomplete.selectField",{defaultMessage:"Please select a field first..."}),o=a.i18n.translate("autocomplete.fieldRequiredError",{defaultMessage:"Value cannot be empty"}),s=a.i18n.translate("autocomplete.invalidNumberError",{defaultMessage:"Not a valid number"}),l=a.i18n.translate("autocomplete.invalidDateError",{defaultMessage:"Not a valid date"}),c=a.i18n.translate("autocomplete.invalidBinaryType",{defaultMessage:"Binary fields are currently unsupported"}),u=a.i18n.translate("autocomplete.fieldSpaceWarning",{defaultMessage:"Warning: Spaces at the start or end of this value aren't being displayed."}),d=(a.i18n.translate("autocomplete.listsTooltipWarning",{defaultMessage:"Lists that aren't able to be processed by this rule type will be disabled."}),a.i18n.translate("autocomplete.seeDocumentation",{defaultMessage:"See Documentation"}),{LOADING:i,SELECT_FIELD_FIRST:r,FIELD_REQUIRED_ERR:o,NUMBER_ERR:s,DATE_ERR:l,FIELD_SPACE_WARNING:u,BINARY_TYPE_NOT_SUPPORTED:c}),p=n(4),m=n.n(p),g=n(32),f=n(208),b=n.n(f),y=n(147),h=n.n(y),v=n(216),E=n.n(v),x=function(e){var t=e.getLabel,n=e.options,a=e.selectedOptions,i=e.disabledOptions,r=n.map(t),o=null==i?void 0:i.map(t),s=r.map((function(e){return{label:e,disabled:o&&0!==o.length&&o.includes(e)}})),l=a.map(t).filter((function(e){return-1!==r.indexOf(e)})).map((function(e){return s[r.indexOf(e)]}));return{comboOptions:s,labels:r,selectedComboOptions:l}},k={binary:c},S=n(36),w={asPlainText:!0},j=function(e){var t=e.fieldInputWidth,n=e.fieldTypeFilter,i=void 0===n?[]:n,r=e.indexPattern,o=e.isClearable,s=void 0!==o&&o,l=e.isDisabled,c=void 0!==l&&l,u=e.isLoading,d=void 0!==u&&u,f=e.isRequired,y=void 0!==f&&f,v=e.onChange,j=e.placeholder,O=e.selectedField,I=e.acceptsCustomOptions,T=void 0!==I&&I,C=function(e){var t=e.indexPattern,n=e.fieldTypeFilter,a=e.isRequired,i=e.selectedField,r=e.fieldInputWidth,o=e.onChange,s=Object(p.useState)(!1),l=h()(s,2),c=l[0],u=l[1],d=Object(p.useState)(null),f=h()(d,2),y=f[0],v=f[1],w=Object(p.useMemo)((function(){return function(e,t,n){var a=function(e){return null!=e?e.fields:[]}(e),i=function(e){return e?[e]:[]}(t),r=function(e,t,n){var a=new Map;e.forEach((function(e){return a.set(e.name,e)})),t.forEach((function(e){return a.set(e.name,e)}));var i=Array.from(a.values());return n&&(null==n?void 0:n.length)>0?i.filter((function(e){var t=e.type;return n.includes(t)})):i}(a,i,n);return{availableFields:r,selectedFields:i}}(null!=y&&null!=t?E()(E()({},t),{},{fields:[].concat(b()(null==t?void 0:t.fields),[y])}):t,i,n)}),[t,n,i,y]),j=w.availableFields,O=w.selectedFields,I=Object(p.useMemo)((function(){return function(e){var t=e.availableFields,n=e.selectedFields,a=x({getLabel:function(e){return e.name},options:t,selectedOptions:n}),i=function(e){return e.availableFields.reduce((function(e,t){var n,a=null===(n=t.esTypes)||void 0===n?void 0:n.find((function(e){return k[e]})),i=a&&k[a]||k[t.type];return i&&(e[t.name]=i),e}),{})}(e);return E()(E()({},a),{},{disabledLabelTooltipTexts:i})}({availableFields:j,selectedFields:O})}),[j,O]),T=I.comboOptions,C=I.labels,M=I.selectedComboOptions,N=I.disabledLabelTooltipTexts,D=Object(p.useCallback)((function(e){var t=e.map((function(e){var t=e.label;return j[C.indexOf(t)]}));o(t)}),[j,C,o]),F=Object(p.useCallback)((function(e){e.trim().toLowerCase()&&(v({name:e,type:"text"}),o([{name:e,type:"text"}]))}),[o]),A=Object(p.useCallback)((function(){u(!0)}),[u]),_=Object(p.useMemo)((function(){return r?{width:"".concat(r,"px")}:{}}),[r]);return{isInvalid:Object(p.useMemo)((function(){return!!a&&c&&null==i}),[a,i,c]),comboOptions:T,selectedComboOptions:M,fieldWidth:_,renderFields:function(e,t,n){var a=e.label,i=N[a];return i?(e.disabled=!0,Object(S.jsx)(g.EuiToolTip,{"data-test-subj":"disabledLabelWithTooltip",content:i,position:"bottom"},Object(S.jsx)(m.a.Fragment,null,a))):a},handleTouch:A,handleValuesChange:D,handleCreateCustomOption:F}}({indexPattern:r,fieldTypeFilter:i,isRequired:y,selectedField:O,fieldInputWidth:t,onChange:v}),M=C.isInvalid,N=C.comboOptions,D=C.selectedComboOptions,F=C.fieldWidth,A=C.renderFields,_=C.handleTouch,R=C.handleValuesChange,P=C.handleCreateCustomOption;return T?Object(S.jsx)(g.EuiComboBox,{placeholder:j,options:N,selectedOptions:D,onChange:R,isLoading:d,isDisabled:c,isClearable:s,isInvalid:M,onFocus:_,singleSelection:w,"data-test-subj":"fieldAutocompleteComboBox",style:F,onCreateOption:P,customOptionText:a.i18n.translate("autocomplete.customOptionText",{defaultMessage:"Add {searchValuePlaceholder} as a custom field",values:{searchValuePlaceholder:"{searchValue}"}}),fullWidth:!0}):Object(S.jsx)(g.EuiComboBox,{placeholder:j,options:N,selectedOptions:D,onChange:R,isLoading:d,isDisabled:c,isClearable:s,isInvalid:M,onFocus:_,singleSelection:w,"data-test-subj":"fieldAutocompleteComboBox",style:F,fullWidth:!0,renderOption:A})};j.displayName="Field";n(172),n(56);var O=n(7),I=n(93),T=n(524),C=n.n(T),M=n(525),N=n.n(M),D=n(45),F=function(e){var t=e.selectedField,n=e.operatorType,a=e.fieldValue,i=e.query,r=e.indexPattern,o=e.autocompleteService,s=Object(p.useState)(!1),l=h()(s,2),c=l[0],u=l[1],d=Object(p.useState)(!0),m=h()(d,2),g=m[0],f=m[1],y=Object(p.useState)([]),v=h()(y,2),x=v[0],k=v[1],S=Object(p.useRef)(null);return Object(p.useEffect)((function(){var e=!0,s=new AbortController,l=Object(O.debounce)(function(){var t=C()(N.a.mark((function t(n){var a,i,r,l,c,d;return N.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n.fieldSelected,i=n.patterns,r=n.searchQuery,t.prev=1,!e){t.next=17;break}if(null!=a&&null!=i){t.next=5;break}return t.abrupt("return");case 5:if("boolean"!==a.type){t.next=8;break}return f(!1),t.abrupt("return");case 8:return u(!0),l=Object(D.getDataViewFieldSubtypeNested)(a),c=l?E()(E()({},a),{},{name:"".concat(l.nested.path,".").concat(a.name)}):a,t.next=13,o.getValueSuggestions({field:c,indexPattern:i,query:r,signal:s.signal,useTimeRange:!1});case 13:0===(d=t.sent).length&&f(!1),u(!1),k(b()(d));case 17:t.next=22;break;case 19:t.prev=19,t.t0=t.catch(1),e&&(k([]),u(!1));case 22:case"end":return t.stop()}}),t,null,[[1,19]])})));return function(e){return t.apply(this,arguments)}}(),500);return n!==I.d.EXISTS&&l({fieldSelected:t,patterns:r,searchQuery:i,value:a}),S.current=l,function(){e=!1,s.abort()}}),[t,n,a,r,i,o]),[c,g,x,S.current]},A=n(52),_=n.n(A),R=function(e,t,n,a){if(null!=t){var i=function(e,t,n,a){return n&&a&&(null==e||""===e.trim())?o:null==t||n&&!a||!(n||null!=e&&""!==e)?void 0:null}(e,t,n,a);if(null!==i)return i;switch(t.type){case"date":var r=_.a.parse(null!=e?e:"");return Boolean(r&&r.isValid())?void 0:l;case"number":return null==e||""===e.trim()||isNaN(+e)?s:void 0;default:return}}},P=function(e){return e&&e.trim().length!==e.length},L=[{inputDisplay:"true",value:"true"},{inputDisplay:"false",value:"false"}],q={asPlainText:!0},B=function(e){var t=e.placeholder,n=e.rowLabel,a=e.selectedField,o=e.selectedValue,s=e.indexPattern,l=e.isLoading,c=e.isDisabled,d=void 0!==c&&c,m=e.isClearable,f=void 0!==m&&m,y=e.isRequired,v=void 0!==y&&y,E=e.fieldInputWidth,k=e.autocompleteService,w=e.onChange,j=e.onError,T=Object(p.useState)(""),C=h()(T,2),M=C[0],N=C[1],D=Object(p.useState)(!1),A=h()(D,2),_=A[0],B=A[1],z=Object(p.useState)(void 0),$=h()(z,2),V=$[0],U=$[1],H=Object(p.useState)(!1),G=h()(H,2),Q=G[0],W=G[1],K=F({autocompleteService:k,fieldValue:o,indexPattern:s,operatorType:I.d.MATCH,query:M,selectedField:a}),Y=h()(K,3),J=Y[0],X=Y[1],Z=Y[2],ee=Object(p.useCallback)((function(e){return e}),[]),te=Object(p.useMemo)((function(){var e=String(o);return null!=o&&""!==o.trim()?Object(O.uniq)([e].concat(b()(Z))):Z}),[Z,o]),ne=Object(p.useMemo)((function(){var e=String(o);return o?[e]:[]}),[o]),ae=Object(p.useCallback)((function(e){if(!e)return W(!1);W(!!P(e))}),[W]),ie=Object(p.useCallback)((function(e){U((function(t){var n=null!=e;return null!=t!==n&&null!=j&&j(n),e}))}),[U,j]),re=Object(p.useMemo)((function(){return x({getLabel:ee,options:te,selectedOptions:ne})}),[te,ne,ee]),oe=re.comboOptions,se=re.labels,le=re.selectedComboOptions,ce=Object(p.useCallback)((function(e){var t=e.map((function(e){var t=e.label;return te[se.indexOf(t)]})),n=h()(t,1)[0];ae(n),ie(void 0),w(null!=n?n:"")}),[ie,ae,se,w,te]),ue=Object(p.useCallback)((function(e){if(""!==e&&null!=a){var t=R(e,a,v,_);ie(t),t||ae(e),N(e)}}),[ie,ae,v,a,_]),de=Object(p.useCallback)((function(e){var t=R(e,a,v,_);if(ie(t),null!=t)return W(!1),!1;ae(e),w(e)}),[v,w,a,_,ie,ae]),pe=Object(p.useCallback)((function(e){var t=e.target.value;w(t)}),[w]),me=Object(p.useCallback)((function(e){w(e)}),[w]),ge=Object(p.useCallback)((function(){B(!0);var e=R(o,a,v,!0);ie(e)}),[B,ie,o,a,v]),fe=Object(p.useMemo)((function(){return l||J?i:null==a?r:t}),[l,a,J,t]),be=Object(p.useMemo)((function(){return l||J}),[l,J]);Object(p.useEffect)((function(){U(void 0),null!=j&&j(!1),ae(o)}),[a,o,ae,j]);var ye=Object(p.useMemo)((function(){return Object(S.jsx)(g.EuiFormRow,{label:n,error:V,isInvalid:null!=a&&null!=V,"data-test-subj":"valuesAutocompleteMatchLabel",fullWidth:!0,helpText:Q&&u},Object(S.jsx)(g.EuiComboBox,{placeholder:fe,isDisabled:d||!a,isLoading:be,isClearable:f,options:oe,selectedOptions:le,onChange:ce,singleSelection:q,onSearchChange:ue,onCreateOption:de,isInvalid:null!=a&&null!=V,onBlur:ge,sortMatchesBy:"startsWith","data-test-subj":"valuesAutocompleteMatch",style:E?{width:"".concat(E,"px")}:{},fullWidth:!0,async:!0}))}),[oe,V,E,fe,f,d,be,n,le,a,Q,de,ue,ce,ge]);if(X||null==a)return ye;switch(a.type){case"number":return Object(S.jsx)(g.EuiFormRow,{label:n,error:V,isInvalid:null!=a&&null!=V,"data-test-subj":"valuesAutocompleteMatchLabel",fullWidth:!0},Object(S.jsx)(g.EuiFieldNumber,{placeholder:fe,onBlur:ge,value:"string"==typeof o&&o.trim().length>0?parseFloat(o):null!=o?o:"",onChange:pe,"data-test-subj":"valueAutocompleteFieldMatchNumber",style:E?{width:"".concat(E,"px")}:{},fullWidth:!0}));case"boolean":return Object(S.jsx)(g.EuiFormRow,{label:n,error:V,isInvalid:null!=a&&null!=V,"data-test-subj":"valuesAutocompleteMatchLabel",fullWidth:!0},Object(S.jsx)(g.EuiSuperSelect,{isLoading:be,options:L,valueOfSelected:null!=o?o:"true",onChange:me,"data-test-subj":"valuesAutocompleteMatchBoolean",style:E?{width:"".concat(E,"px")}:{},fullWidth:!0}));default:return ye}};B.displayName="AutocompleteFieldMatch";var z={asPlainText:!0};Object(p.memo)((function(e){var t=e.autocompleteService,n=e.placeholder,a=e.rowLabel,o=e.selectedField,s=e.selectedValue,l=e.indexPattern,c=e.isLoading,d=e.isDisabled,m=void 0!==d&&d,f=e.isClearable,y=void 0!==f&&f,v=e.isRequired,E=void 0!==v&&v,k=e.fieldInputWidth,w=e.onChange,j=e.onError,T=e.onWarning,C=e.warning,M=Object(p.useState)(""),N=h()(M,2),D=N[0],A=N[1],_=Object(p.useState)(!1),L=h()(_,2),q=L[0],B=L[1],$=Object(p.useState)(void 0),V=h()($,2),U=V[0],H=V[1],G=Object(p.useState)(!1),Q=h()(G,2),W=Q[0],K=Q[1],Y=F({autocompleteService:t,fieldValue:s,indexPattern:l,operatorType:I.d.WILDCARD,query:D,selectedField:o}),J=h()(Y,3),X=J[0],Z=J[2],ee=Object(p.useCallback)((function(e){return e}),[]),te=Object(p.useMemo)((function(){var e=String(s);return null!=s&&""!==s.trim()?Object(O.uniq)([e].concat(b()(Z))):Z}),[Z,s]),ne=Object(p.useMemo)((function(){var e=String(s);return s?[e]:[]}),[s]),ae=Object(p.useCallback)((function(e){if(!e)return K(!1);K(!!P(e))}),[K]),ie=Object(p.useCallback)((function(e){H((function(t){var n=null!=e;return null!=t!==n&&null!=j&&j(n),e}))}),[H,j]),re=Object(p.useCallback)((function(e){T(void 0!==e)}),[T]),oe=Object(p.useMemo)((function(){return x({getLabel:ee,options:te,selectedOptions:ne})}),[te,ne,ee]),se=oe.comboOptions,le=oe.labels,ce=oe.selectedComboOptions,ue=Object(p.useCallback)((function(e){var t=e.map((function(e){var t=e.label;return te[le.indexOf(t)]})),n=h()(t,1)[0];ie(void 0),ae(n),K(!1),w(null!=n?n:"")}),[ie,ae,le,w,te]),de=Object(p.useCallback)((function(e){if(""!==e.trim()&&null!=o){var t=R(e,o,E,q);ie(t),re(C),t||ae(e),A(e)}}),[ie,ae,E,o,q,C,re]),pe=Object(p.useCallback)((function(e){var t=R(e,o,E,q);if(ie(t),re(C),null!=t)return K(!1),!1;ae(e),w(e)}),[E,ae,w,o,q,ie,re,C]),me=Object(p.useCallback)((function(){B(!0);var e=R(s,o,E,!0);ie(e),re(C)}),[B,ie,s,o,E,re,C]),ge=Object(p.useMemo)((function(){return c||X?i:null==o?r:n}),[c,o,X,n]),fe=Object(p.useMemo)((function(){return c||X}),[c,X]);return Object(p.useEffect)((function(){H(void 0),null!=j&&j(!1),ae(s),T(!1)}),[o,s,j,T,ae]),Object(p.useMemo)((function(){return Object(S.jsx)(g.EuiFormRow,{label:a,error:U,helpText:C||W&&u,isInvalid:null!=o&&null!=U,"data-test-subj":"valuesAutocompleteWildcardLabel",fullWidth:!0},Object(S.jsx)(g.EuiComboBox,{placeholder:ge,isDisabled:m||!o,isLoading:fe,isClearable:y,options:se,selectedOptions:ce,onChange:ue,singleSelection:z,onSearchChange:de,onCreateOption:pe,isInvalid:null!=o&&null!=U,onBlur:me,sortMatchesBy:"startsWith","data-test-subj":"valuesAutocompleteWildcard",style:k?{width:"".concat(k,"px")}:{},fullWidth:!0,async:!0}))}),[se,U,k,pe,de,ue,ge,y,m,fe,a,ce,o,me,C,W])})).displayName="AutocompleteFieldWildcard";n(245)},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"e",(function(){return a})),n.d(t,"a",(function(){return k})),n.d(t,"d",(function(){return S}));var a={};n.r(a),n.d(a,"allUsersSelector",(function(){return c})),n.d(a,"userRiskScoreSelector",(function(){return u})),n.d(a,"userRiskScoreSeverityFilterSelector",(function(){return d})),n.d(a,"authenticationsSelector",(function(){return p})),n.d(a,"usersAnomaliesJobIdFilterSelector",(function(){return m})),n.d(a,"usersAnomaliesIntervalSelector",(function(){return g}));var i=n(412),r=n(137),o=n(108);const s=e=>e.users.page,l=(e,t)=>e.users[t],c=()=>Object(o.createSelector)(s,(e=>e.queries[r.UsersTableType.allUsers])),u=()=>Object(o.createSelector)(s,(e=>e.queries[r.UsersTableType.risk])),d=()=>Object(o.createSelector)(s,(e=>e.queries[r.UsersTableType.risk].severitySelection)),p=()=>Object(o.createSelector)(s,(e=>e.queries[r.UsersTableType.authentications])),m=()=>Object(o.createSelector)(l,(e=>e.queries[r.UsersTableType.anomalies].jobIdSelection)),g=()=>Object(o.createSelector)(l,(e=>e.queries[r.UsersTableType.anomalies].intervalSelection));var f=n(328),b=n(34),y=n(253);const h=e=>({...e.page.queries,[r.UsersTableType.allUsers]:{...e.page.queries[r.UsersTableType.allUsers],activePage:y.a}});var v=n(851),E=n(85),x=n(931);const k={page:{queries:{[r.UsersTableType.allUsers]:{activePage:y.a,limit:y.b,sort:{field:x.a.lastSeen,direction:v.a.desc}},[r.UsersTableType.authentications]:{activePage:y.a,limit:y.b},[r.UsersTableType.risk]:{activePage:y.a,limit:y.b,sort:{field:E.w.userRiskScore,direction:v.a.desc},severitySelection:[]},[r.UsersTableType.anomalies]:{jobIdSelection:[],intervalSelection:"auto"},[r.UsersTableType.events]:{activePage:y.a,limit:y.b}}},details:{queries:{[r.UsersTableType.anomalies]:{jobIdSelection:[],intervalSelection:"auto"},[r.UsersTableType.events]:{activePage:y.a,limit:y.b}}}},S=Object(f.reducerWithInitialState)(k).case(i.setUsersTablesActivePageToZero,(e=>({...e,page:{...e.page,queries:h(e)}}))).case(i.updateTableActivePage,((e,{activePage:t,tableType:n})=>({...e,page:{...e.page,queries:{...e.page.queries,[n]:{...e.page.queries[n],activePage:t}}}}))).case(i.updateTableLimit,((e,{limit:t,tableType:n})=>({...e,page:{...e.page,queries:{...e.page.queries,[n]:{...e.page.queries[n],limit:t}}}}))).case(i.updateTableSorting,((e,{sort:t,tableType:n})=>({...e,page:{...e.page,queries:{...e.page.queries,[n]:{...e.page.queries[n],sort:t,activePage:y.a}}}}))).case(i.updateUserRiskScoreSeverityFilter,((e,{severitySelection:t})=>({...e,page:{...e.page,queries:{...e.page.queries,[r.UsersTableType.risk]:{...e.page.queries[r.UsersTableType.risk],severitySelection:t,activePage:y.a}}}}))).case(i.updateUsersAnomaliesJobIdFilter,((e,{jobIds:t,usersType:n})=>"page"===n?Object(b.set)("page.queries.anomalies.jobIdSelection",t,e):Object(b.set)("details.queries.anomalies.jobIdSelection",t,e))).case(i.updateUsersAnomaliesInterval,((e,{interval:t,usersType:n})=>"page"===n?Object(b.set)("page.queries.anomalies.intervalSelection",t,e):Object(b.set)("details.queries.anomalies.intervalSelection",t,e))).build()},,,function(e,t,n){var a=n(330),i=n(331);e.exports=function(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=a(e.prototype),r=e.apply(n,t);return i(r)?r:n}}},function(e,t,n){e.exports=n(27)(286)},function(e,t,n){"use strict";t.decode=t.parse=n(550),t.encode=t.stringify=n(551)},function(e,t,n){"use strict";let a;n.d(t,"a",(function(){return a})),function(e){e.flows="flows",e.dns="dns",e.anomalies="anomalies",e.tls="tls",e.http="http",e.events="events"}(a||(a={}))},function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"h",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"j",(function(){return s})),n.d(t,"k",(function(){return l})),n.d(t,"l",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"f",(function(){return p})),n.d(t,"g",(function(){return m})),n.d(t,"d",(function(){return g})),n.d(t,"i",(function(){return f}));var a=n(0);a.i18n.translate("xpack.securitySolution.overview.eventsTitle",{defaultMessage:"Event count"});const i=a.i18n.translate("xpack.securitySolution.overview.newsFeedSidebarTitle",{defaultMessage:"Security news"}),r=a.i18n.translate("xpack.securitySolution.overview.recentTimelinesSidebarTitle",{defaultMessage:"Recent timelines"}),o=a.i18n.translate("xpack.securitySolution.overview.signalCountTitle",{defaultMessage:"Alert trend"}),s=e=>a.i18n.translate("xpack.securitySolution.overview.topNLabel",{values:{fieldName:e},defaultMessage:"Top {fieldName}"}),l=a.i18n.translate("xpack.securitySolution.overview.viewAlertsButtonLabel",{defaultMessage:"View alerts"}),c=a.i18n.translate("xpack.securitySolution.overview.viewEventsButtonLabel",{defaultMessage:"View events"}),u=a.i18n.translate("xpack.securitySolution.detectionResponse.pageTitle",{defaultMessage:"Detection & Response"}),d=a.i18n.translate("xpack.securitySolution.entityAnalytics.pageDesc",{defaultMessage:"Detect threats from users and devices within your network with Entity Analytics"}),p=a.i18n.translate("xpack.securitySolution.detectionResponse.noPagePermissionsMessage",{defaultMessage:"To view this page you must update privileges. For more information, contact your Kibana administrator."}),m=a.i18n.translate("xpack.securitySolution.detectionResponse.noPermissionsTitle",{defaultMessage:"Privileges required"}),g=a.i18n.translate("xpack.securitySolution.detectionResponse.goToDocumentationButton",{defaultMessage:"View documentation"}),f=a.i18n.translate("xpack.securitySolution.entityAnalytics.technicalPreviewLabel",{defaultMessage:"Technical Preview"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"g",(function(){return p})),n.d(t,"h",(function(){return m}));var a=n(135),i=n(180),r=n(461);const o=e=>{const t="acknowledged"===e?{bool:{should:[{term:{[a.ab]:e}},{term:{[a.ab]:"in-progress"}}]}}:{term:{[a.ab]:e}};return[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:a.ab,params:{query:e}},query:t}]},s=e=>[{meta:{alias:null,negate:!1,disabled:!1},query:{bool:{should:e.map((e=>({term:{[a.ab]:e}})))}}}],l=e=>e?[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:a.D,params:{query:e}},query:{match_phrase:{[a.D]:e}}}]:[],c=e=>e?[]:[{meta:{alias:null,negate:!0,disabled:!1,type:"exists",key:a.b,value:"exists"},query:{exists:{field:a.b}}}],u=e=>e?[{meta:{alias:null,disabled:!1,negate:!1,key:"kibana.alert.rule.type",type:"term"},query:{term:{"kibana.alert.rule.type":"threat_match"}}}]:[],d=e=>({...i.a,columns:Object(r.a)(e),showCheckboxes:!0}),p=e=>({...d(e),columns:Object(r.a)(e),defaultColumns:Object(r.b)(e),sort:[{columnId:"kibana.alert.original_time",columnType:"date",esTypes:["date"],sortDirection:"desc"}]}),m=["@timestamp","kibana.alert.workflow_status","kibana.alert.group.id","kibana.alert.original_time","kibana.alert.building_block_type","kibana.alert.rule.from","kibana.alert.rule.name","kibana.alert.rule.to","kibana.alert.rule.uuid","kibana.alert.rule.rule_id","kibana.alert.rule.type","kibana.alert.suppression.docs_count","kibana.alert.original_event.kind","kibana.alert.original_event.module","file.path","file.Ext.code_signature.subject_name","file.Ext.code_signature.trusted","file.hash.sha256","host.os.family","event.code","process.entry_leader.entity_id"]},function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"f",(function(){return r})),n.d(t,"e",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return l}));const a=.5,i=2,r=2,o=50,s=300,l=1e3},function(e,t,n){"use strict";function a(e,t){return Array.isArray(e)?e.includes(t):e===t}function i(e){if(null!==e){if(!Array.isArray(e))return e;for(const t of e)if(null!==t)return t}}function r(e){if(Array.isArray(e)){const t=[];for(const n of e)null!=n&&t.push(n);return t}return null!=e?[e]:[]}n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"Vb",(function(){return i})),n.d(t,"oc",(function(){return r})),n.d(t,"e",(function(){return o})),n.d(t,"eb",(function(){return s})),n.d(t,"Yb",(function(){return l})),n.d(t,"db",(function(){return c})),n.d(t,"m",(function(){return u})),n.d(t,"pc",(function(){return d})),n.d(t,"gb",(function(){return p})),n.d(t,"i",(function(){return m})),n.d(t,"T",(function(){return g})),n.d(t,"kc",(function(){return f})),n.d(t,"Db",(function(){return b})),n.d(t,"y",(function(){return y})),n.d(t,"A",(function(){return h})),n.d(t,"z",(function(){return v})),n.d(t,"ob",(function(){return E})),n.d(t,"gc",(function(){return x})),n.d(t,"V",(function(){return k})),n.d(t,"Bb",(function(){return S})),n.d(t,"Ob",(function(){return w})),n.d(t,"S",(function(){return j})),n.d(t,"Q",(function(){return O})),n.d(t,"dc",(function(){return I})),n.d(t,"ic",(function(){return T})),n.d(t,"Z",(function(){return C})),n.d(t,"N",(function(){return M})),n.d(t,"mb",(function(){return N})),n.d(t,"t",(function(){return D})),n.d(t,"Hb",(function(){return F})),n.d(t,"Ub",(function(){return A})),n.d(t,"lb",(function(){return _})),n.d(t,"D",(function(){return R})),n.d(t,"M",(function(){return P})),n.d(t,"ub",(function(){return L})),n.d(t,"L",(function(){return q})),n.d(t,"h",(function(){return B})),n.d(t,"Rb",(function(){return z})),n.d(t,"g",(function(){return $})),n.d(t,"u",(function(){return V})),n.d(t,"nb",(function(){return U})),n.d(t,"H",(function(){return H})),n.d(t,"rb",(function(){return G})),n.d(t,"hc",(function(){return Q})),n.d(t,"f",(function(){return W})),n.d(t,"U",(function(){return K})),n.d(t,"hb",(function(){return Y})),n.d(t,"jc",(function(){return J})),n.d(t,"ib",(function(){return X})),n.d(t,"o",(function(){return Z})),n.d(t,"Eb",(function(){return ee})),n.d(t,"n",(function(){return te})),n.d(t,"ec",(function(){return ne})),n.d(t,"nc",(function(){return ae})),n.d(t,"lc",(function(){return ie})),n.d(t,"B",(function(){return re})),n.d(t,"P",(function(){return oe})),n.d(t,"v",(function(){return se})),n.d(t,"Jb",(function(){return le})),n.d(t,"Cb",(function(){return ce})),n.d(t,"X",(function(){return ue})),n.d(t,"Y",(function(){return de})),n.d(t,"ac",(function(){return pe})),n.d(t,"d",(function(){return me})),n.d(t,"a",(function(){return ge})),n.d(t,"Lb",(function(){return fe})),n.d(t,"Mb",(function(){return be})),n.d(t,"Wb",(function(){return ye})),n.d(t,"p",(function(){return he})),n.d(t,"Ib",(function(){return ve})),n.d(t,"Pb",(function(){return Ee})),n.d(t,"Qb",(function(){return xe})),n.d(t,"Zb",(function(){return ke})),n.d(t,"ab",(function(){return Se})),n.d(t,"bb",(function(){return we})),n.d(t,"w",(function(){return je})),n.d(t,"Kb",(function(){return Oe})),n.d(t,"q",(function(){return Ie})),n.d(t,"C",(function(){return Te})),n.d(t,"xb",(function(){return Ce})),n.d(t,"jb",(function(){return Me})),n.d(t,"yb",(function(){return Ne})),n.d(t,"Fb",(function(){return De})),n.d(t,"E",(function(){return Fe})),n.d(t,"tb",(function(){return Ae})),n.d(t,"J",(function(){return _e})),n.d(t,"qb",(function(){return Re})),n.d(t,"K",(function(){return Pe})),n.d(t,"j",(function(){return Le})),n.d(t,"zb",(function(){return qe})),n.d(t,"Nb",(function(){return Be})),n.d(t,"mc",(function(){return ze})),n.d(t,"bc",(function(){return $e})),n.d(t,"cc",(function(){return Ve})),n.d(t,"s",(function(){return Ue})),n.d(t,"O",(function(){return He})),n.d(t,"Xb",(function(){return Ge})),n.d(t,"Tb",(function(){return Qe})),n.d(t,"fc",(function(){return We})),n.d(t,"Sb",(function(){return Ke})),n.d(t,"c",(function(){return Ye})),n.d(t,"r",(function(){return Je})),n.d(t,"G",(function(){return Xe})),n.d(t,"Gb",(function(){return Ze})),n.d(t,"fb",(function(){return et})),n.d(t,"sb",(function(){return tt})),n.d(t,"F",(function(){return nt})),n.d(t,"pb",(function(){return at})),n.d(t,"Ab",(function(){return it})),n.d(t,"I",(function(){return rt})),n.d(t,"b",(function(){return ot})),n.d(t,"x",(function(){return st})),n.d(t,"kb",(function(){return lt})),n.d(t,"W",(function(){return ct})),n.d(t,"cb",(function(){return ut})),n.d(t,"R",(function(){return dt})),n.d(t,"k",(function(){return pt})),n.d(t,"vb",(function(){return mt})),n.d(t,"wb",(function(){return gt})),n.d(t,"l",(function(){return ft}));var a=n(0);const i=a.i18n.translate("xpack.securitySolution.auditd.sessionDescription",{defaultMessage:"Session"}),r=a.i18n.translate("xpack.securitySolution.auditd.wasAuthorizedToUseDescription",{defaultMessage:"was authorized to use"}),o=a.i18n.translate("xpack.securitySolution.auditd.acquiredCredentialsDescription",{defaultMessage:"acquired credentials to"}),s=a.i18n.translate("xpack.securitySolution.auditd.endedFromDescription",{defaultMessage:"ended from"}),l=a.i18n.translate("xpack.securitySolution.auditd.startedAtDescription",{defaultMessage:"started"}),c=a.i18n.translate("xpack.securitySolution.auditd.disposedCredentialsDescription",{defaultMessage:"disposed credentials to"}),u=a.i18n.translate("xpack.securitySolution.auditd.attemptedLoginDescription",{defaultMessage:"attempted a login via"}),d=a.i18n.translate("xpack.securitySolution.auditd.withResultDescription",{defaultMessage:"with result"}),p=a.i18n.translate("xpack.securitySolution.auditd.executedDescription",{defaultMessage:"executed"}),m=a.i18n.translate("xpack.securitySolution.auditd.asDescription",{defaultMessage:"as"}),g=a.i18n.translate("xpack.securitySolution.auditd.connectedUsingDescription",{defaultMessage:"connected using"}),f=a.i18n.translate("xpack.securitySolution.auditd.usingDescription",{defaultMessage:"using"}),b=a.i18n.translate("xpack.securitySolution.auditd.OpenedFileDescription",{defaultMessage:"opened file"}),y=a.i18n.translate("xpack.securitySolution.auditd.ChangedFileAttributesOfDescription",{defaultMessage:"changed file attributes of"}),h=a.i18n.translate("xpack.securitySolution.auditd.changedFilePermissionOfDescription",{defaultMessage:"changed file permissions of"}),v=a.i18n.translate("xpack.securitySolution.auditd.changeidleOwernshipOfDescription",{defaultMessage:"changed file ownership of"}),E=a.i18n.translate("xpack.securitySolution.auditd.loaedKernelModuleOfDescription",{defaultMessage:"loaded kernel module of"}),x=a.i18n.translate("xpack.securitySolution.auditd.unloadedKernelModuleOfDescription",{defaultMessage:"unloaded kernel module of"}),k=a.i18n.translate("xpack.securitySolution.auditd.createdDirectoryDescription",{defaultMessage:"created directory"}),S=a.i18n.translate("xpack.securitySolution.auditd.mountedDescription",{defaultMessage:"mounted"}),w=a.i18n.translate("xpack.securitySolution.auditd.renamedDescription",{defaultMessage:"renamed"}),j=a.i18n.translate("xpack.securitySolution.auditd.chedckedMetaDataOfDescription",{defaultMessage:"checked metadata of"}),O=a.i18n.translate("xpack.securitySolution.auditd.checkedFileSystemMetadataOfDescription",{defaultMessage:"checked filesystem metadata of"}),I=a.i18n.translate("xpack.securitySolution.auditd.symLinkedDescription",{defaultMessage:"symbolically linked"}),T=a.i18n.translate("xpack.securitySolution.auditd.unmountedDescription",{defaultMessage:"unmounted"}),C=a.i18n.translate("xpack.securitySolution.auditd.deletedDescription",{defaultMessage:"deleted"}),M=a.i18n.translate("xpack.securitySolution.auditd.changedTimeStampOfDescription",{defaultMessage:"changed time stamp of"}),N=a.i18n.translate("xpack.securitySolution.auditd.ListeningForConnectionsUsingDescription",{defaultMessage:"listening for connections using"}),D=a.i18n.translate("xpack.securitySolution.auditd.boundSocketFromDescription",{defaultMessage:"bound socket from"}),F=a.i18n.translate("xpack.securitySolution.auditd.receivedFromDescription",{defaultMessage:"received from"}),A=a.i18n.translate("xpack.securitySolution.auditd.sentToDescription",{defaultMessage:"sent to"}),_=a.i18n.translate("xpack.securitySolution.auditd.killedProcessIdDescription",{defaultMessage:"killed process id of"}),R=a.i18n.translate("xpack.securitySolution.auditd.changedIdentityUsingDescription",{defaultMessage:"changed identity using"}),P=a.i18n.translate("xpack.securitySolution.auditd.changedSystemTimeWithDescription",{defaultMessage:"changed system time with"}),L=a.i18n.translate("xpack.securitySolution.auditd.madeDeviceWithDescription",{defaultMessage:"made device with"}),q=a.i18n.translate("xpack.securitySolution.auditd.changedSystemNameDescription",{defaultMessage:"changed system name"}),B=a.i18n.translate("xpack.securitySolution.auditd.allocatedMemoryForDescription",{defaultMessage:"allocated memory for"}),z=a.i18n.translate("xpack.securitySolution.auditd.scheduledPolicyOFDescription",{defaultMessage:"scheduled policy of"}),$=a.i18n.translate("xpack.securitySolution.auditd.addedUserAccountDescription",{defaultMessage:"added user account"}),V=a.i18n.translate("xpack.securitySolution.auditd.causedMacPolicyErrorDescription",{defaultMessage:"caused mac policy error"}),U=a.i18n.translate("xpack.securitySolution.auditd.loadedFirewallRuleDescription",{defaultMessage:"loaded firewall rule"}),H=a.i18n.translate("xpack.securitySolution.auditd.promiscuousModeDescription",{defaultMessage:"changed promiscuous mode on the device using"}),G=a.i18n.translate("xpack.securitySolution.auditd.lockedAccountDescription",{defaultMessage:"locked account"}),Q=a.i18n.translate("xpack.securitySolution.auditd.unlockedAccountDescription",{defaultMessage:"unlocked account"}),W=a.i18n.translate("xpack.securitySolution.auditd.adddedGroupAccountUsingDescription",{defaultMessage:"added group account using"}),K=a.i18n.translate("xpack.securitySolution.auditd.crashedProgramDescription",{defaultMessage:"crashed program"}),Y=a.i18n.translate("xpack.securitySolution.auditd.executionOfForbiddenProgramDescription",{defaultMessage:"execution of forbidden program"}),J=a.i18n.translate("xpack.securitySolution.auditd.suspiciousProgramDescription",{defaultMessage:"used suspicious program"}),X=a.i18n.translate("xpack.securitySolution.auditd.failedLoginTooManyTimesDescription",{defaultMessage:"failed login due to logging in too many times"}),Z=a.i18n.translate("xpack.securitySolution.auditd.attemptedLoginFromUnusalPlaceDescription",{defaultMessage:"attempted login from unusual place"}),ee=a.i18n.translate("xpack.securitySolution.auditd.openedTooManySessionsDescription",{defaultMessage:"opened too many sessions"}),te=a.i18n.translate("xpack.securitySolution.auditd.attemptedLoginFromUnusualHourDescription",{defaultMessage:"attempted login from unusual hour"}),ne=a.i18n.translate("xpack.securitySolution.auditd.testedFileSystemIntegrityDescription",{defaultMessage:"tested file system integrity"}),ae=a.i18n.translate("xpack.securitySolution.auditd.violatedSeLinuxPolicyDescription",{defaultMessage:"violated selinux policy"}),ie=a.i18n.translate("xpack.securitySolution.auditd.violatedAppArmorPolicyFromDescription",{defaultMessage:"violated app armor policy from"}),re=a.i18n.translate("xpack.securitySolution.auditd.changedGroupDescription",{defaultMessage:"changed group"}),oe=a.i18n.translate("xpack.securitySolution.auditd.changedUserIdDescription",{defaultMessage:"changed user id"}),se=a.i18n.translate("xpack.securitySolution.auditd.changedAuditConfigurationDescription",{defaultMessage:"changed audit configuration"}),le=a.i18n.translate("xpack.securitySolution.auditd.refreshedCredentialsForDescription",{defaultMessage:"refreshed credentials for"}),ce=a.i18n.translate("xpack.securitySolution.auditd.negotiatedCryptoKeyDescription",{defaultMessage:"negotiated crypto key"}),ue=a.i18n.translate("xpack.securitySolution.auditd.cryptoOfficerLoggedInDescription",{defaultMessage:"crypto officer logged in"}),de=a.i18n.translate("xpack.securitySolution.auditd.cryptoOfficerLoggedOutDescription",{defaultMessage:"crypto officer logged out"}),pe=a.i18n.translate("xpack.securitySolution.auditd.startedCryptoSessionDescription",{defaultMessage:"started crypto session"}),me=a.i18n.translate("xpack.securitySolution.auditd.accessResultDescription",{defaultMessage:"access result"}),ge=a.i18n.translate("xpack.securitySolution.auditd.abortedAuditStartupDescription",{defaultMessage:"aborted audit startup"}),fe=a.i18n.translate("xpack.securitySolution.auditd.remoteAuditConnectedDescription",{defaultMessage:"remote audit connected"}),be=a.i18n.translate("xpack.securitySolution.auditd.remoteAuditDisconnectedDescription",{defaultMessage:"remote audit disconnected"}),ye=a.i18n.translate("xpack.securitySolution.auditd.shutDownAuditDescription",{defaultMessage:"shutdown audit"}),he=a.i18n.translate("xpack.securitySolution.auditd.auditErrorDescription",{defaultMessage:"audit error"}),ve=a.i18n.translate("xpack.securitySolution.auditd.reconfiguredAuditDescription",{defaultMessage:"reconfigured audit"}),Ee=a.i18n.translate("xpack.securitySolution.auditd.resumedAuditLoggingDescription",{defaultMessage:"resumed audit logging"}),xe=a.i18n.translate("xpack.securitySolution.auditd.rotatedAuditLogsDescription",{defaultMessage:"rotated-audit-logs"}),ke=a.i18n.translate("xpack.securitySolution.auditd.startedAuditDescription",{defaultMessage:"started audit"}),Se=a.i18n.translate("xpack.securitySolution.auditd.deletedGroupAccountUsingDescription",{defaultMessage:"deleted group account using"}),we=a.i18n.translate("xpack.securitySolution.auditd.deletedUserAccountUsingDescription",{defaultMessage:"deleted user account using"}),je=a.i18n.translate("xpack.securitySolution.auditd.changedAuditFeatureDescription",{defaultMessage:"changed audit feature"}),Oe=a.i18n.translate("xpack.securitySolution.auditd.relabeledFileSystemDescription",{defaultMessage:"relabeled filesystem"}),Ie=a.i18n.translate("xpack.securitySolution.auditd.authenticatedToGroupDescription",{defaultMessage:"authenticated to group"}),Te=a.i18n.translate("xpack.securitySolution.auditd.changedGroupPasswordDescription",{defaultMessage:"changed group password"}),Ce=a.i18n.translate("xpack.securitySolution.auditd.modifiedGroupAccountDescription",{defaultMessage:"modified group account"}),Me=a.i18n.translate("xpack.securitySolution.auditd.initializedAuditSubsystemDescription",{defaultMessage:"initialized audit subsystem"}),Ne=a.i18n.translate("xpack.securitySolution.auditd.modifiedLevelOfDescription",{defaultMessage:"modified level of"}),De=a.i18n.translate("xpack.securitySolution.auditd.overrodeLabelOfDescription",{defaultMessage:"overrode label of"}),Fe=a.i18n.translate("xpack.securitySolution.auditd.changedLoginIdToDescription",{defaultMessage:"changed login id to"}),Ae=a.i18n.translate("xpack.securitySolution.auditd.macPermissionDescription",{defaultMessage:"mac permission"}),_e=a.i18n.translate("xpack.securitySolution.auditd.changedSeLinuxBooleanDescription",{defaultMessage:"changed selinux boolean"}),Re=a.i18n.translate("xpack.securitySolution.auditd.loadedSeLinuxPolicyDescription",{defaultMessage:"loaded selinux policy"}),Pe=a.i18n.translate("xpack.securitySolution.auditd.changedSelinuxEnforcementDescription",{defaultMessage:"changed selinux enforcement"}),Le=a.i18n.translate("xpack.securitySolution.auditd.assignedUserRoleToDescription",{defaultMessage:"assigned user role to"}),qe=a.i18n.translate("xpack.securitySolution.auditd.modifiedRoleDescription",{defaultMessage:"modified role"}),Be=a.i18n.translate("xpack.securitySolution.auditd.removedUserRoleFromDescription",{defaultMessage:"removed user role from"}),ze=a.i18n.translate("xpack.securitySolution.auditd.violatedSeccompPolicyWithDescription",{defaultMessage:"violated seccomp policy with"}),$e=a.i18n.translate("xpack.securitySolution.auditd.startedServiceDescription",{defaultMessage:"started service"}),Ve=a.i18n.translate("xpack.securitySolution.auditd.stoppedServiceDescription",{defaultMessage:"stopped service"}),Ue=a.i18n.translate("xpack.securitySolution.auditd.bootedSystemDescription",{defaultMessage:"booted system"}),He=a.i18n.translate("xpack.securitySolution.auditd.changedToRunLevelWithDescription",{defaultMessage:"changed to run level with"}),Ge=a.i18n.translate("xpack.securitySolution.auditd.shutdownSystemDescription",{defaultMessage:"shutdown system"}),Qe=a.i18n.translate("xpack.securitySolution.auditd.sentTestDescription",{defaultMessage:"sent test"}),We=a.i18n.translate("xpack.securitySolution.auditd.unknownDescription",{defaultMessage:"unknown"}),Ke=a.i18n.translate("xpack.securitySolution.auditd.sentMessageDescription",{defaultMessage:"sent message"}),Ye=a.i18n.translate("xpack.securitySolution.auditd.accessPermissionDescription",{defaultMessage:"access permission"}),Je=a.i18n.translate("xpack.securitySolution.auditd.authenticatedUsingDescription",{defaultMessage:"authenticated using"}),Xe=a.i18n.translate("xpack.securitySolution.auditd.changedPasswordWithDescription",{defaultMessage:"changed password with"}),Ze=a.i18n.translate("xpack.securitySolution.auditd.ranCommandDescription",{defaultMessage:"ran command"}),et=a.i18n.translate("xpack.securitySolution.auditd.errorFromDescription",{defaultMessage:"error from"}),tt=a.i18n.translate("xpack.securitySolution.auditd.loggedOutDescription",{defaultMessage:"logged out"}),nt=a.i18n.translate("xpack.securitySolution.auditd.changedMacConfigurationDescription",{defaultMessage:"changed mac configuration"}),at=a.i18n.translate("xpack.securitySolution.auditd.loadedMacPolicyDescription",{defaultMessage:"loaded mac policy"}),it=a.i18n.translate("xpack.securitySolution.auditd.modifiedUserAccountDescription",{defaultMessage:"modified user account"}),rt=a.i18n.translate("xpack.securitySolution.auditd.changedRoleUsingDescription",{defaultMessage:"changed role using"}),ot=a.i18n.translate("xpack.securitySolution.auditd.accessErrorDescription",{defaultMessage:"access error"}),st=a.i18n.translate("xpack.securitySolution.auditd.changedConfigurationWIthDescription",{defaultMessage:"changed configuration with"}),lt=a.i18n.translate("xpack.securitySolution.auditd.issuedVmControlDescription",{defaultMessage:"issued vm control"}),ct=a.i18n.translate("xpack.securitySolution.auditd.createdVmImageDescription",{defaultMessage:"created vm image"}),ut=a.i18n.translate("xpack.securitySolution.auditd.deletedVmImageDescription",{defaultMessage:"deleted vm image"}),dt=a.i18n.translate("xpack.securitySolution.auditd.checkedIntegrityOfDescription",{defaultMessage:"checked integrity of"}),pt=a.i18n.translate("xpack.securitySolution.auditd.assignedVmIdDescription",{defaultMessage:"assigned vm id"}),mt=a.i18n.translate("xpack.securitySolution.auditd.migratedVmFromDescription",{defaultMessage:"migrated vm from"}),gt=a.i18n.translate("xpack.securitySolution.auditd.migratedVmToDescription",{defaultMessage:"migrated vm to"}),ft=a.i18n.translate("xpack.securitySolution.auditd.assignedVMResourceDescription",{defaultMessage:"assigned vm resource"})},function(e,t,n){"use strict";n.d(t,"W",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"g",(function(){return s})),n.d(t,"r",(function(){return l})),n.d(t,"A",(function(){return c})),n.d(t,"B",(function(){return u})),n.d(t,"H",(function(){return d})),n.d(t,"e",(function(){return p})),n.d(t,"f",(function(){return m})),n.d(t,"i",(function(){return g})),n.d(t,"n",(function(){return f})),n.d(t,"q",(function(){return b})),n.d(t,"s",(function(){return y})),n.d(t,"t",(function(){return h})),n.d(t,"u",(function(){return v})),n.d(t,"v",(function(){return E})),n.d(t,"E",(function(){return x})),n.d(t,"k",(function(){return k})),n.d(t,"G",(function(){return S})),n.d(t,"F",(function(){return w})),n.d(t,"m",(function(){return j})),n.d(t,"l",(function(){return O})),n.d(t,"j",(function(){return I})),n.d(t,"p",(function(){return T})),n.d(t,"J",(function(){return C})),n.d(t,"o",(function(){return M})),n.d(t,"I",(function(){return N})),n.d(t,"z",(function(){return D})),n.d(t,"h",(function(){return F})),n.d(t,"w",(function(){return A})),n.d(t,"d",(function(){return _})),n.d(t,"a",(function(){return R})),n.d(t,"y",(function(){return P})),n.d(t,"x",(function(){return L})),n.d(t,"K",(function(){return q})),n.d(t,"L",(function(){return B})),n.d(t,"M",(function(){return z})),n.d(t,"D",(function(){return $})),n.d(t,"C",(function(){return V})),n.d(t,"N",(function(){return U})),n.d(t,"R",(function(){return H})),n.d(t,"P",(function(){return G})),n.d(t,"T",(function(){return Q})),n.d(t,"Q",(function(){return W})),n.d(t,"U",(function(){return K})),n.d(t,"O",(function(){return Y})),n.d(t,"S",(function(){return J})),n.d(t,"V",(function(){return X}));var a=n(0);const i=a.i18n.translate("xpack.securitySolution.system.withResultDescription",{defaultMessage:"with result"}),r=a.i18n.translate("xpack.securitySolution.system.acceptedAConnectionViaDescription",{defaultMessage:"accepted a connection via"}),o=a.i18n.translate("xpack.securitySolution.system.attemptedLoginDescription",{defaultMessage:"attempted a login via"}),s=a.i18n.translate("xpack.securitySolution.system.disconnectedViaDescription",{defaultMessage:"disconnected via"}),l=a.i18n.translate("xpack.securitySolution.system.loggedOutDescription",{defaultMessage:"logged out via"}),c=(a.i18n.translate("xpack.securitySolution.system.usingDescription",{defaultMessage:"using"}),a.i18n.translate("xpack.securitySolution.system.processStartedDescription",{defaultMessage:"started process"})),u=a.i18n.translate("xpack.securitySolution.system.processStoppedDescription",{defaultMessage:"stopped process"}),d=a.i18n.translate("xpack.securitySolution.system.terminatedProcessDescription",{defaultMessage:"terminated process"}),p=a.i18n.translate("xpack.securitySolution.system.createdFileDescription",{defaultMessage:"created a file"}),m=a.i18n.translate("xpack.securitySolution.system.deletedFileDescription",{defaultMessage:"deleted a file"}),g=a.i18n.translate("xpack.securitySolution.rowRenderer.executedProcessDescription",{defaultMessage:"executed process"}),f=a.i18n.translate("xpack.securitySolution.rowRenderer.forkedProcessDescription",{defaultMessage:"forked process"}),b=a.i18n.translate("xpack.securitySolution.rowRenderer.loadedLibraryDescription",{defaultMessage:"loaded library"}),y=a.i18n.translate("xpack.securitySolution.rowRenderer.madeAHttpRequestViaDescription",{defaultMessage:"made a http request via"}),h=a.i18n.translate("xpack.securitySolution.rowRenderer.modifiedFileDescription",{defaultMessage:"modified a file"}),v=a.i18n.translate("xpack.securitySolution.rowRenderer.modifiedRegistryKeyDescription",{defaultMessage:"modified registry key"}),E=a.i18n.translate("xpack.securitySolution.rowRenderer.overwroteFileDescription",{defaultMessage:"overwrote a file"}),x=a.i18n.translate("xpack.securitySolution.rowRenderer.renamedFileDescription",{defaultMessage:"renamed a file"}),k=a.i18n.translate("xpack.securitySolution.system.existingProcessDescription",{defaultMessage:"is running process"}),S=a.i18n.translate("xpack.securitySolution.system.socketOpenedDescription",{defaultMessage:"opened a socket with"}),w=a.i18n.translate("xpack.securitySolution.system.socketClosedDescription",{defaultMessage:"closed a socket with"}),j=a.i18n.translate("xpack.securitySolution.system.existingUserDescription",{defaultMessage:"is an existing user"}),O=a.i18n.translate("xpack.securitySolution.system.existingSocketDescription",{defaultMessage:"is using an existing socket from"}),I=a.i18n.translate("xpack.securitySolution.system.existingPackageDescription",{defaultMessage:"is using an existing package"}),T=a.i18n.translate("xpack.securitySolution.system.invalidDescription",{defaultMessage:"attempted invalid usage of"}),C=a.i18n.translate("xpack.securitySolution.system.userChangedDescription",{defaultMessage:"user has changed"}),M=a.i18n.translate("xpack.securitySolution.system.hostDescription",{defaultMessage:"host information"}),N=a.i18n.translate("xpack.securitySolution.system.userAddedDescription",{defaultMessage:"user was added"}),D=a.i18n.translate("xpack.securitySolution.system.processErrorDescription",{defaultMessage:"encountered a process error with"}),F=a.i18n.translate("xpack.securitySolution.system.errorDescription",{defaultMessage:"encountered an error with"}),A=a.i18n.translate("xpack.securitySolution.system.packageInstalledDescription",{defaultMessage:"installed package"}),_=a.i18n.translate("xpack.securitySolution.system.packageSystemStartedDescription",{defaultMessage:"system started"}),R=a.i18n.translate("xpack.securitySolution.system.acceptedDescription",{defaultMessage:"accepted the user via"}),P=a.i18n.translate("xpack.securitySolution.system.packageUpdatedDescription",{defaultMessage:"updated package"}),L=a.i18n.translate("xpack.securitySolution.system.packageRemovedDescription",{defaultMessage:"removed package"}),q=a.i18n.translate("xpack.securitySolution.system.userRemovedDescription",{defaultMessage:"was removed"}),B=a.i18n.translate("xpack.securitySolution.system.viaDescription",{defaultMessage:"via"}),z=a.i18n.translate("xpack.securitySolution.system.viaParentProcessDescription",{defaultMessage:"via parent process"}),$=a.i18n.translate("xpack.securitySolution.rowRenderer.ransomwareWasPreventedFromeEcryptingFilesDescription",{defaultMessage:"ransomware was prevented from encrypting files"}),V=a.i18n.translate("xpack.securitySolution.rowRenderer.ransomwareWasDetectedEcryptingFilesDescription",{defaultMessage:"ransomware was detected encrypting files"}),U=a.i18n.translate("xpack.securitySolution.rowRenderer.wasDetectedCreatingAMaliciousFileDescription",{defaultMessage:"was detected creating a malicious file"}),H=a.i18n.translate("xpack.securitySolution.rowRenderer.wasPreventedFromCreatingAMaliciousFileDescription",{defaultMessage:"was prevented from creating a malicious file"}),G=a.i18n.translate("xpack.securitySolution.rowRenderer.wasDetectedModifyingAMaliciousFileDescription",{defaultMessage:"was detected modifying a malicious file"}),Q=a.i18n.translate("xpack.securitySolution.rowRenderer.wasPreventedFromModifyingAMaliciousFileDescription",{defaultMessage:"was prevented from modifying a malicious file"}),W=a.i18n.translate("xpack.securitySolution.rowRenderer.wasDetectedRenamingAMaliciousFileDescription",{defaultMessage:"was detected renaming a malicious file"}),K=a.i18n.translate("xpack.securitySolution.rowRenderer.wasPreventedFromRenamingAMaliciousFileDescription",{defaultMessage:"was prevented from renaming a malicious file"}),Y=a.i18n.translate("xpack.securitySolution.rowRenderer.wasDetectedExecutingAMaliciousProcessDescription",{defaultMessage:"was detected executing a malicious process"}),J=a.i18n.translate("xpack.securitySolution.rowRenderer.wasPreventedFromExecutingAMaliciousProcessDescription",{defaultMessage:"was prevented from executing a malicious process"}),X=a.i18n.translate("xpack.securitySolution.system.withExitCodeDescription",{defaultMessage:"with exit code"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var a=n(0),i=n(132);a.i18n.translate("xpack.securitySolution.endpointsTab",{defaultMessage:"Endpoints"}),a.i18n.translate("xpack.securitySolution.policiesTab",{defaultMessage:"Policies"}),a.i18n.translate("xpack.securitySolution.trustedAppsTab",{defaultMessage:"Trusted applications"}),a.i18n.translate("xpack.securitySolution.eventFiltersTab",{defaultMessage:"Event filters"});const r={[i.c.WINDOWS]:a.i18n.translate("xpack.securitySolution.administration.os.windows",{defaultMessage:"Windows"}),[i.c.MAC]:a.i18n.translate("xpack.securitySolution.administration.os.macos",{defaultMessage:"Mac"}),[i.c.LINUX]:a.i18n.translate("xpack.securitySolution.administration.os.linux",{defaultMessage:"Linux"})},o=e=>a.i18n.translate("xpack.securitySolution.exceptions.failedLoadPolicies",{defaultMessage:'There was an error loading policies: "{error}"',values:{error:e.message}})},,function(e,t,n){"use strict";n.d(t,"b",(function(){return w})),n.d(t,"a",(function(){return j}));var a=n(169),i=n(78),r=n(4),o=n(90),s=n(77),l=n(98),c=n(145),u=n(34),d=n(107),p=n(526),m=n(286);var g=n(268),f=n.n(g),b=n(267),y=n(183);var h=n(136),v=n(86),E=n(104),x=n(81),k=n(37);const S=({search:e,urlKey:t})=>Object(b.d)(Object(b.e)(e),t),w=()=>{Object(a.c)(),(()=>{const e=Object(i.useDispatch)(),{filterManager:t,savedQueries:n}=Object(s.k)().services.data.query,u=Object(r.useMemo)((()=>l.d.globalFiltersQuerySelector()),[]),d=Object(i.useSelector)(u),p=Object(r.useCallback)((t=>{null!=t&&e(c.b.setFilterQuery({id:o.a.global,query:t.query,language:t.language}))}),[e]),m=Object(r.useCallback)((n=>{null!=n?(t.setFilters(n),e(c.b.setSearchBarFilter({id:o.a.global,filters:n}))):(t.setAppFilters(d),e(c.b.setSearchBarFilter({id:o.a.global,filters:t.getFilters()})))}),[t,e,d]),g=Object(r.useCallback)((a=>{null!=a&&""!==a&&n.getSavedQuery(a).then((n=>{const a=n.attributes.filters||[],i=n.attributes.query;t.setFilters(a),e(c.b.setSearchBarFilter({id:o.a.global,filters:a})),e(c.b.setFilterQuery({id:o.a.global,...i})),e(c.b.setSavedQuery({id:o.a.global,savedQuery:n}))}))}),[e,t,n]);Object(a.b)(j.appQuery,p),Object(a.b)(j.filters,m),Object(a.b)(j.savedQuery,g)})(),(()=>{const e=Object(i.useDispatch)(),t=Object(d.a)("socTrendsEnabled"),n=Object(r.useCallback)((n=>((e,t,n)=>{if(null!=e){const a={linkTo:Object(u.get)("global.linkTo",e)},i=Object(u.get)("global.timerange.kind",e),r={linkTo:Object(u.get)("timeline.linkTo",e)},s=Object(u.get)("timeline.timerange.kind",e),l={linkTo:Object(u.get)("socTrends.linkTo",e)},d=Object(u.get)("socTrends.timerange.kind",e);if(n&&(Object(u.isEmpty)(l.linkTo)?t(c.b.removeLinkTo([o.a.global,o.a.socTrends])):t(c.b.addLinkTo([o.a.global,o.a.socTrends]))),Object(u.isEmpty)(a.linkTo)?(t(c.b.removeLinkTo([o.a.global,o.a.timeline])),n&&t(c.b.removeLinkTo([o.a.global,o.a.socTrends]))):(t(c.b.addLinkTo([o.a.global,o.a.timeline])),n&&t(c.b.addLinkTo([o.a.global,o.a.socTrends]))),Object(u.isEmpty)(r.linkTo)?t(c.b.removeLinkTo([o.a.global,o.a.timeline])):t(c.b.addLinkTo([o.a.global,o.a.timeline])),s){if("absolute"===s){const n=Object(p.a)(Object(u.get)("timeline.timerange",e));t(c.b.setAbsoluteRangeDatePicker({...n,id:o.a.timeline}))}if("relative"===s){const n=Object(p.a)(Object(u.get)("timeline.timerange",e));n.from=Object(m.c)(n.fromStr),n.to=Object(m.c)(n.toStr,{roundUp:!0}),t(c.b.setRelativeRangeDatePicker({...n,id:o.a.timeline}))}}if(i){if("absolute"===i){const n=Object(p.a)(Object(u.get)("global.timerange",e));t(c.b.setAbsoluteRangeDatePicker({...n,id:o.a.global}))}if("relative"===i){const n=Object(p.a)(Object(u.get)("global.timerange",e));n.from=Object(m.c)(n.fromStr),n.to=Object(m.c)(n.toStr,{roundUp:!0}),t(c.b.setRelativeRangeDatePicker({...n,id:o.a.global}))}}if(n&&d){if("absolute"===d){const n=Object(p.a)(Object(u.get)("socTrends.timerange",e));t(c.b.setAbsoluteRangeDatePicker({...n,id:o.a.socTrends}))}if("relative"===d){const n=Object(p.a)(Object(u.get)("socTrends.timerange",e));n.from=Object(m.c)(n.fromStr),n.to=Object(m.c)(n.toStr,{roundUp:!0}),t(c.b.setRelativeRangeDatePicker({...n,id:o.a.socTrends}))}}}})(n,e,t)),[e,t]);Object(a.b)(j.timerange,n)})(),(()=>{const[{pageName:e}]=Object(y.a)(),t=Object(i.useDispatch)(),n=f()(e),a=Object(r.useMemo)((()=>l.d.inputsSelector()),[]),s=Object(i.useSelector)(a),{timerange:u}=s.global,{timerange:d}=s.timeline;Object(r.useEffect)((()=>{((e,t)=>e&&t&&t!==e&&Object(b.f)(e))(e,n)&&("relative"===d.kind&&t(c.b.setRelativeRangeDatePicker({...d,from:Object(m.c)(d.fromStr),to:Object(m.c)(d.toStr,{roundUp:!0}),id:o.a.timeline})),"relative"===u.kind&&t(c.b.setRelativeRangeDatePicker({...u,from:Object(m.c)(u.fromStr),to:Object(m.c)(u.toStr,{roundUp:!0}),id:o.a.global})))}),[e,n,t,d,u])})(),(()=>{const e=Object(i.useDispatch)(),t=Object(r.useCallback)((t=>{null!=t&&""!==t.id&&Object(h.h)({activeTimelineTab:t.activeTab,duplicate:!1,graphEventId:t.graphEventId,timelineId:t.id,openTimeline:t.isOpen,updateIsLoading:t=>e(v.a.updateIsLoading(t)),updateTimeline:Object(h.b)(e)})}),[e]);Object(a.b)(j.timeline,t)})(),(()=>{const e=Object(a.d)(j.timeline),t=Object(r.useMemo)((()=>v.b.getTimelineByIdSelector()),[]),{activeTab:n,graphEventId:i,show:o,savedObjectId:s}=Object(x.b)((e=>{var n;return null!==(n=t(e,E.d.active))&&void 0!==n?n:{}}));Object(r.useEffect)((()=>{e(null!=s?{id:s,isOpen:o,activeTab:n,graphEventId:null!=i?i:""}:null)}),[n,i,s,o,e])})(),(()=>{var e;const t=Object(r.useMemo)((()=>v.b.getTimelineByIdSelector()),[]),n=Object(x.b)((e=>t(e,E.d.active))),{search:a}=Object(k.useLocation)(),o=f()(a),s=null!==(e=null==n?void 0:n.savedObjectId)&&void 0!==e?e:"",l=Object(i.useDispatch)(),[c,u]=Object(r.useMemo)((()=>{const e=S({urlKey:j.timeline,search:null!=o?o:""}),t=S({urlKey:j.timeline,search:a});if(null!=e&&null!=t){let n=null,a=null;try{n=Object(b.a)(t)}catch(e){}try{a=Object(b.a)(e)}catch(e){}return[a,n]}return[null,null]}),[o,a]),d=null==c?void 0:c.id,{id:p,activeTab:m,graphEventId:g}=u||{};Object(r.useEffect)((()=>{p&&p!==d&&p!==s&&Object(h.h)({activeTimelineTab:null!=m?m:E.f.query,duplicate:!1,graphEventId:g,timelineId:p,openTimeline:!0,updateIsLoading:e=>l(v.a.updateIsLoading(e)),updateTimeline:Object(h.b)(l)})}),[s,l,d,p,m,g])})()};let j;!function(e){e.appQuery="query",e.filters="filters",e.savedQuery="savedQuery",e.sourcerer="sourcerer",e.timeline="timeline",e.timerange="timerange"}(j||(j={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return T}));var a=n(528),i=n(34),r=n(4),o=n.n(r),s=n(78),l=n(11),c=n(92),u=n.n(c),d=n(145),p=n(286),m=n(108),g=n(149);const f=e=>e.query,b=e=>e.savedQuery;var y=n(86),h=n(77),v=n(266),E=n(236),x=n(111),k=n(98),S=n(169),w=n(281),j=n(107);const O=Object(r.memo)((({end:e,filterQuery:t,fromStr:n,hideFilterBar:c=!1,hideQueryInput:m=!1,id:g,indexPattern:f,isLoading:b=!1,pollForSignalIndex:y,queries:O,savedQuery:I,setSavedQuery:T,setSearchBarFilter:C,start:M,toStr:N,updateSearch:D,dataTestSubj:F})=>{const{data:{query:{timefilter:{timefilter:A},filterManager:_}},unifiedSearch:{ui:{SearchBar:R}}}=Object(h.k)().services,P=Object(s.useDispatch)(),L=Object(r.useCallback)((()=>{P(v.b.setUsersTablesActivePageToZero()),P(E.a.setHostTablesActivePageToZero()),P(x.b.setNetworkTablesActivePageToZero())}),[P]);(()=>{const e=Object(S.d)(w.a.savedQuery),t=Object(S.d)(w.a.appQuery),n=Object(S.d)(w.a.filters),a=Object(r.useMemo)((()=>k.d.globalQuerySelector()),[]),o=Object(r.useMemo)((()=>k.d.globalFiltersQuerySelector()),[]),l=Object(r.useMemo)((()=>k.d.globalSavedQuerySelector()),[]),c=Object(s.useSelector)(a),u=Object(s.useSelector)(o),d=Object(s.useSelector)(l);Object(r.useEffect)((()=>{var a;null!=d&&""!==d.id?(e(null!==(a=null==d?void 0:d.id)&&void 0!==a?a:null),t(null),n(null)):(e(null),t(Object(i.isEmpty)(c.query)?null:c),n(Object(i.isEmpty)(u)?null:u))}),[d,c,u,e,t,n])})(),(()=>{const e=Object(S.d)(w.a.timerange),t=Object(r.useMemo)((()=>d.d.inputsSelector()),[]),n=Object(s.useSelector)(t),a=Object(j.a)("socTrendsEnabled"),{linkTo:i,timerange:o}=n.global,{linkTo:l,timerange:c}=n.timeline,u=Object(r.useMemo)((()=>{if(a&&n.socTrends){const{linkTo:e,timerange:t}=n.socTrends;return{socTrends:{[w.a.timerange]:t,linkTo:e}}}return{}}),[n.socTrends,a]);Object(r.useEffect)((()=>{e({global:{[w.a.timerange]:o,linkTo:i},timeline:{[w.a.timerange]:c,linkTo:l},...u})}),[e,i,o,l,c,u])})(),Object(r.useEffect)((()=>{null!=n&&null!=N?A.setTime({from:n,to:N}):null!=M&&null!=e&&(L(),A.setTime({from:new Date(M).toISOString(),to:new Date(e).toISOString()}))}),[e,n,M,A,N,L]);const q=Object(r.useCallback)((i=>{null!=y&&y();const r=i.dateRange.from.includes("now")||i.dateRange.to.includes("now");let o={id:g,end:null!=N?N:new Date(e).toISOString(),start:null!=n?n:new Date(M).toISOString(),isInvalid:!1,isQuickSelection:r,updateTime:!1,filterManager:_,setTablesActivePageToZero:L},s=!1;(!r||n===i.dateRange.from&&N===i.dateRange.to)&&(r||M===Object(p.c)(i.dateRange.from)&&e===Object(p.c)(i.dateRange.to))||(s=!0,o.updateTime=!0,o.end=i.dateRange.to,o.start=i.dateRange.from),null==i.query||u()(i.query,t)||(s=!0,o=Object(a.set)("query",i.query,o)),s||(r&&i.dateRange.to!==i.dateRange.from?(o.updateTime=!0,o.end=i.dateRange.to,o.start=i.dateRange.from):O.forEach((e=>e.refetch&&e.refetch()))),window.setTimeout((()=>D(o)),0)}),[g,y,N,e,n,M,_,t,O,D,L]),B=Object(r.useCallback)((e=>{e.dateRange.from.includes("now")||e.dateRange.to.includes("now")?D({id:g,end:e.dateRange.to,start:e.dateRange.from,isInvalid:!1,isQuickSelection:!0,updateTime:!0,filterManager:_,setTablesActivePageToZero:L}):O.forEach((e=>e.refetch&&e.refetch()))}),[D,g,_,O,L]),z=Object(r.useCallback)((e=>{T({id:g,savedQuery:e})}),[g,T]),$=Object(r.useCallback)((t=>{const i=!!t.attributes.timefilter&&(t.attributes.timefilter.from.includes("now")||t.attributes.timefilter.to.includes("now"));let r={id:g,filters:t.attributes.filters||[],end:null!=N?N:new Date(e).toISOString(),start:null!=n?n:new Date(M).toISOString(),isInvalid:!1,isQuickSelection:i,updateTime:!1,filterManager:_,setTablesActivePageToZero:L};t.attributes.timefilter&&(r.end=t.attributes.timefilter?t.attributes.timefilter.to:r.end,r.start=t.attributes.timefilter?t.attributes.timefilter.from:r.start,r.updateTime=!0),r=Object(a.set)("query",t.attributes.query,r),r=Object(a.set)("savedQuery",t,r),D(r)}),[g,N,e,n,M,_,D,L]),V=Object(r.useCallback)((()=>{null!=I&&D({id:g,filters:[],end:null!=N?N:new Date(e).toISOString(),start:null!=n?n:new Date(M).toISOString(),isInvalid:!1,isQuickSelection:!1,updateTime:!1,query:{query:"",language:I.attributes.query.language},resetSavedQuery:!0,savedQuery:void 0,filterManager:_,setTablesActivePageToZero:L})}),[I,D,g,N,e,n,M,_,L]);Object(r.useEffect)((()=>{let e=!0;const t=new l.Subscription;return t.add(_.getUpdates$().subscribe({next:()=>{if(e){const e=_.getFilters();C({id:g,filters:e}),L()}}})),()=>{e=!1,t.unsubscribe()}}),[]);const U=Object(r.useMemo)((()=>[f]),[f]);return o.a.createElement("div",{"data-test-subj":`${g}DatePicker`},o.a.createElement(R,{appName:"siem",isLoading:b,indexPatterns:U,query:t,onClearSavedQuery:V,onQuerySubmit:q,onRefresh:B,onSaved:z,onSavedQueryUpdated:$,savedQuery:I,showFilterBar:!c,showDatePicker:!0,showQueryInput:!m,showSaveQuery:!0,dataTestSubj:F}))}),((e,t)=>e.end===t.end&&e.filterQuery===t.filterQuery&&e.fromStr===t.fromStr&&e.id===t.id&&e.isLoading===t.isLoading&&e.savedQuery===t.savedQuery&&e.setSavedQuery===t.setSavedQuery&&e.setSearchBarFilter===t.setSearchBarFilter&&e.start===t.start&&e.toStr===t.toStr&&e.updateSearch===t.updateSearch&&e.dataTestSubj===t.dataTestSubj&&u()(e.indexPattern,t.indexPattern)&&u()(e.queries,t.queries)));O.displayName="SiemSearchBar";const I=e=>({end:t,filters:n,id:a,isQuickSelection:i,query:r,resetSavedQuery:o,savedQuery:s,start:l,timelineId:c,updateTime:u=!1,filterManager:m,setTablesActivePageToZero:g})=>{if(u){const n=Object(p.c)(l);let r=Object(p.c)(t,{roundUp:!0});i?e(t===l?d.b.setAbsoluteRangeDatePicker({id:a,fromStr:l,toStr:t,from:n,to:r}):d.b.setRelativeRangeDatePicker({id:a,fromStr:l,toStr:t,from:n,to:r})):(r=Object(p.c)(t),e(d.b.setAbsoluteRangeDatePicker({id:a,from:Object(p.c)(l),to:Object(p.c)(t)}))),null!=c&&e(y.a.updateRange({id:c,start:n,end:r}))}null!=r&&e(d.b.setFilterQuery({id:a,...r})),null!=n&&m.setFilters(n),(null!=s||o)&&e(d.b.setSavedQuery({id:a,savedQuery:s})),g()},T=Object(s.connect)((()=>{const e=Object(g.b)(),t=Object(g.c)(),n=Object(g.d)(),a=Object(g.h)(),r=Object(g.i)(),o=Object(g.j)(),s=Object(m.createSelector)(f,(e=>e)),l=Object(m.createSelector)(b,(e=>e));return(c,{id:u})=>{const d=Object(i.getOr)({},`inputs.${u}`,c);return{end:e(d),fromStr:t(d),filterQuery:s(d),isLoading:n(d),queries:a(c,u),savedQuery:l(d),start:r(d),toStr:o(d)}}}),(e=>({updateSearch:I(e),setSavedQuery:({id:t,savedQuery:n})=>e(d.b.setSavedQuery({id:t,savedQuery:n})),setSearchBarFilter:({id:t,filters:n})=>e(d.b.setSearchBarFilter({id:t,filters:n}))})))(O)},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return v}));var a=n(4),i=n(78),r=n(294),o=n.n(r),s=n(34),l=n(50),c=n(42),u=n(77),d=n(84),p=n(177),m=n(431),g=n(95),f=n(317),b=n(231),y=n(1);const h=o()(((e,t)=>t.reduce(((e,t)=>(null==e.browserFields[t.category]&&(e.browserFields[t.category]={}),null==e.browserFields[t.category].fields&&(e.browserFields[t.category].fields={}),e.browserFields[t.category].fields[t.name]=t,e.indexFields.push(Object(s.pick)(["name","searchable","type","aggregatable","esTypes","subType"],t)),e)),{browserFields:{},indexFields:[]})),((e,t)=>e[0]===t[0]&&e[1].length===t[1].length)),v=()=>{const{data:e}=Object(u.k)().services,t=Object(a.useRef)({}),n=Object(a.useRef)({}),r=Object(i.useDispatch)(),{addError:o,addWarning:v}=Object(d.a)(),{startTracking:E}=Object(b.a)(),x=Object(a.useCallback)((({id:e,loading:t})=>{r(p.a.setDataViewLoading({id:e,loading:t}))}),[r]),k=Object(a.useCallback)((({dataViewId:a,scopeId:i=g.SourcererScopeName.default,needToBeInit:u=!1,cleanCache:d=!1,skipScopeUpdate:b=!1})=>{const k=()=>{var e;null===(e=n.current[a])||void 0===e||e.unsubscribe(),n.current=Object(s.omit)(a,n.current),t.current=Object(s.omit)(a,t.current)};return n.current[a]&&n.current[a].unsubscribe(),t.current[a]&&t.current[a].abort(),(async()=>{t.current={...t.current,[a]:new AbortController},x({id:a,loading:!0});const{endTracking:s}=E({name:`${y.B} indexFieldsSearch`});if(u){const e=await Object(f.a)(a,t.current[a].signal);r(p.a.setDataView(e))}return new Promise((g=>{const f=e.search.search({dataViewId:a,onlyCheckIfIndicesExist:!1},{abortSignal:t.current[a].signal,strategy:"indexFields"}).subscribe({next:async e=>{if(Object(c.isCompleteResponse)(e)){s("success");const t=e.indicesExist.sort().join();u&&i&&!b&&r(p.a.setSelectedDataView({id:i,selectedDataViewId:a,selectedPatterns:e.indicesExist})),d&&h.clear();const n=h(t,e.indexFields);r(p.a.setDataView({...n,id:a,loading:!1,runtimeMappings:e.runtimeMappings}))}else Object(c.isErrorResponse)(e)&&(s("invalid"),x({id:a,loading:!1}),v(m.a));k(),g()},error:e=>{if(s("error"),e.message===l.DELETED_SECURITY_SOLUTION_DATA_VIEW)return location.reload();x({id:a,loading:!1}),o(e,{title:m.b}),k(),g()}});n.current={...n.current,[a]:f}}))})()}),[o,v,e.search,r,x,E]);return Object(a.useEffect)((()=>()=>{Object.values(n.current).forEach((e=>e.unsubscribe())),Object.values(t.current).forEach((e=>e.abort()))}),[]),{indexFieldsSearch:k}}},function(e,t,n){"use strict";n.d(t,"c",(function(){return E})),n.d(t,"b",(function(){return x})),n.d(t,"a",(function(){return k}));var a=n(52),i=n.n(a),r=n(32),o=n(34),s=n(4),l=n.n(s),c=n(78),u=n(92),d=n.n(u),p=n(935),m=n(1),g=n(86),f=n(77),b=n(184),y=n(90),h=n(149);const v=l.a.memo((({duration:e,end:t,fromStr:n,id:a,isLoading:i,kqlQuery:c,policy:u,queries:d,setDuration:p,showUpdateButton:g=!0,start:b,startAutoReload:y,stopAutoReload:h,timelineId:v,toStr:x,updateReduxTime:k,disabled:S,width:w="restricted",compressed:j=!1})=>{const[O,I]=Object(s.useState)([]),T=Object(s.useCallback)((({start:e,end:n})=>{const i=e.includes("now")||n.includes("now"),{kqlHaveBeenUpdated:r}=k({end:n,id:a,isInvalid:!1,isQuickSelection:i,kql:c,start:e,timelineId:v}),o=E(e),s=i?E(n,{roundUp:!0}):E(n);!d||r||i&&(b!==o||t!==s)||M(d)}),[t,a,c,d,b,v,k]),C=Object(s.useCallback)((({isPaused:t,refreshInterval:i})=>{const r=null!=n&&n.includes("now")||null!=x&&x.includes("now");e!==i&&p({id:a,duration:i}),t&&"interval"===u?h({id:a}):t||"manual"!==u||y({id:a}),d&&!t&&(!r||r&&"now"!==x)&&M(d)}),[n,x,e,u,p,a,h,y,d]),M=e=>{e.forEach((e=>e.refetch&&e.refetch()))},N=Object(s.useCallback)((({start:e,end:t,isInvalid:n})=>{const i=e.includes("now")||t.includes("now");if(!n){k({end:t,id:a,isInvalid:n,isQuickSelection:i,kql:c,start:e,timelineId:v});const r=[{start:e,end:t},...Object(o.take)(9,O.filter((n=>!(n.start===e&&n.end===t))))];I(r)}}),[k,a,c,v,O]),D=null!=x?x:new Date(t).toISOString(),F=null!=n?n:new Date(b).toISOString(),[A]=Object(f.q)(m.gb),_=Object(o.isEmpty)(A)?[]:A.map((({from:e,to:t,display:n})=>({start:e,end:t,label:n})));return l.a.createElement(r.EuiSuperDatePicker,{commonlyUsedRanges:_,end:D,isLoading:i,isPaused:"manual"===u,onRefresh:T,onRefreshChange:C,onTimeChange:N,recentlyUsedRanges:O,refreshInterval:e,showUpdateButton:g,start:F,isDisabled:S,width:w,compressed:j})}),((e,t)=>e.duration===t.duration&&e.end===t.end&&e.fromStr===t.fromStr&&e.id===t.id&&e.isLoading===t.isLoading&&e.policy===t.policy&&e.setDuration===t.setDuration&&e.start===t.start&&e.startAutoReload===t.startAutoReload&&e.stopAutoReload===t.stopAutoReload&&e.timelineId===t.timelineId&&e.disabled===t.disabled&&e.toStr===t.toStr&&e.updateReduxTime===t.updateReduxTime&&d()(e.kqlQuery,t.kqlQuery)&&d()(e.queries,t.queries))),E=(e,t)=>{const n=i.a.parse(e,t);return null!=n&&n.isValid()?n.toISOString():""},x=e=>({end:t,id:n,isQuickSelection:a,kql:i,start:r,timelineId:o})=>{const s=E(r);let l=E(t,{roundUp:!0});var c;return a?e(t===r?b.b.setAbsoluteRangeDatePicker({id:n,fromStr:r,toStr:t,from:s,to:l}):b.b.setRelativeRangeDatePicker({id:n,fromStr:r,toStr:t,from:s,to:l})):(l=E(t),e(b.b.setAbsoluteRangeDatePicker({id:n,from:E(r),to:E(t)}))),null!=o&&e(g.a.updateRange({id:o,start:s,end:l})),i&&i.refetch?{kqlHaveBeenUpdated:null!==(c=i.refetch(e))&&void 0!==c&&c}:{kqlHaveBeenUpdated:!1}};v.displayName="SuperDatePickerComponent";const k=Object(c.connect)((()=>{const e=Object(h.a)(),t=Object(h.b)(),n=Object(h.c)(),a=Object(h.d)(),i=Object(h.e)(),r=Object(h.f)(),s=Object(h.g)(),l=Object(h.h)(),c=Object(h.i)(),u=Object(h.j)();return(d,{id:m})=>{const g=Object(o.getOr)({},`inputs.${m}`,d);return{duration:e(g),end:t(g),fromStr:n(g),kind:i(g),policy:s(g),start:c(g),toStr:u(g),isLoading:!1,...Object(p.c)(g)&&(m===y.a.timeline||m===y.a.global)&&{isLoading:a(g),kqlQuery:r(g),queries:l(d,m)}}}}),(e=>({startAutoReload:({id:t})=>e(b.b.startAutoReload({id:t})),stopAutoReload:({id:t})=>e(b.b.stopAutoReload({id:t})),setDuration:({id:t,duration:n})=>e(b.b.setDuration({id:t,duration:n})),updateReduxTime:x(e)})))(v)},function(e,t,n){"use strict";n.d(t,"c",(function(){return p})),n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d}));var a,i=n(4),r=n(53),o=(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},a(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s="html",l="svg",c=function(e,t){var n,a,i,r={};if(e===s)i=document.createElement("div");else{if(e!==l)throw new Error('Invalid element type "'+e+'" for createPortalNode: must be "html" or "svg".');i=document.createElementNS("http://www.w3.org/2000/svg","g")}if(t&&"object"==typeof t)for(var o=0,c=Object.entries(t.attributes);o<c.length;o++){var u=c[o],d=u[0],p=u[1];i.setAttribute(d,p)}var m={element:i,elementType:e,setPortalProps:function(e){r=e},getInitialPortalProps:function(){return r},mount:function(t,i){if(i!==a){if(m.unmount(),t!==n&&!function(e,t){if(t===s)return e instanceof HTMLElement;if(t===l)return e instanceof SVGElement;throw new Error('Unrecognized element type "'+t+'" for validateElementType.')}(t,e))throw new Error('Invalid element type for portal: "'+e+'" portalNodes must be used with '+e+" elements, but OutPortal is within <"+t.tagName+">.");t.replaceChild(m.element,i),n=t,a=i}},unmount:function(e){e&&e!==a||n&&a&&(n.replaceChild(a,m.element),n=void 0,a=void 0)}};return m},u=function(e){function t(t){var n=e.call(this,t)||this;return n.addPropsChannel=function(){Object.assign(n.props.node,{setPortalProps:function(e){n.setState({nodeProps:e})}})},n.state={nodeProps:n.props.node.getInitialPortalProps()},n}return o(t,e),t.prototype.componentDidMount=function(){this.addPropsChannel()},t.prototype.componentDidUpdate=function(){this.addPropsChannel()},t.prototype.render=function(){var e=this,t=this.props,n=t.children,a=t.node;return r.createPortal(i.Children.map(n,(function(t){return i.isValidElement(t)?i.cloneElement(t,e.state.nodeProps):t})),a.element)},t}(i.PureComponent),d=function(e){function t(t){var n=e.call(this,t)||this;return n.placeholderNode=i.createRef(),n.passPropsThroughPortal(),n}return o(t,e),t.prototype.passPropsThroughPortal=function(){var e=Object.assign({},this.props,{node:void 0});this.props.node.setPortalProps(e)},t.prototype.componentDidMount=function(){var e=this.props.node;this.currentPortalNode=e;var t=this.placeholderNode.current,n=t.parentNode;e.mount(n,t),this.passPropsThroughPortal()},t.prototype.componentDidUpdate=function(){var e=this.props.node;this.currentPortalNode&&e!==this.currentPortalNode&&(this.currentPortalNode.unmount(this.placeholderNode.current),this.currentPortalNode=e);var t=this.placeholderNode.current,n=t.parentNode;e.mount(n,t),this.passPropsThroughPortal()},t.prototype.componentWillUnmount=function(){this.props.node.unmount(this.placeholderNode.current)},t.prototype.render=function(){return i.createElement("div",{ref:this.placeholderNode})},t}(i.PureComponent),p=c.bind(null,s);c.bind(null,l)},function(e,t,n){"use strict";n.d(t,"o",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"r",(function(){return o})),n.d(t,"q",(function(){return s})),n.d(t,"n",(function(){return l})),n.d(t,"d",(function(){return c})),n.d(t,"s",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"c",(function(){return p})),n.d(t,"b",(function(){return m})),n.d(t,"m",(function(){return g})),n.d(t,"p",(function(){return f})),n.d(t,"l",(function(){return b})),n.d(t,"k",(function(){return y})),n.d(t,"f",(function(){return h})),n.d(t,"g",(function(){return v})),n.d(t,"i",(function(){return E})),n.d(t,"h",(function(){return x})),n.d(t,"j",(function(){return k}));var a=n(0);const i=a.i18n.translate("xpack.securitySolution.anomaliesTable.table.showingDescription",{defaultMessage:"Showing"}),r=a.i18n.translate("xpack.securitySolution.anomaliesTable.table.anomaliesDescription",{defaultMessage:"Anomalies"}),o=e=>a.i18n.translate("xpack.securitySolution.anomaliesTable.table.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {anomaly} other {anomalies}}"}),s=a.i18n.translate("xpack.securitySolution.anomaliesTable.table.anomaliesTooltip",{defaultMessage:"The anomalies table is not filterable via the SIEM global KQL search."}),l=a.i18n.translate("xpack.securitySolution.ml.table.scoreTitle",{defaultMessage:"Anomaly score"}),c=a.i18n.translate("xpack.securitySolution.ml.table.hostNameTitle",{defaultMessage:"Host name"}),u=a.i18n.translate("xpack.securitySolution.ml.table.userNameTitle",{defaultMessage:"User name"}),d=a.i18n.translate("xpack.securitySolution.ml.table.influencedByTitle",{defaultMessage:"Influenced by"}),p=a.i18n.translate("xpack.securitySolution.ml.table.entityTitle",{defaultMessage:"Entity"}),m=a.i18n.translate("xpack.securitySolution.ml.table.detectorTitle",{defaultMessage:"Job"}),g=a.i18n.translate("xpack.securitySolution.ml.table.networkNameTitle",{defaultMessage:"Network IP"}),f=a.i18n.translate("xpack.securitySolution.ml.table.timestampTitle",{defaultMessage:"Timestamp"}),b=a.i18n.translate("xpack.securitySolution.ml.table.jobIdFilter",{defaultMessage:"Job"}),y=a.i18n.translate("xpack.securitySolution.ml.table.intervalTooltip",{defaultMessage:"Show only the highest severity anomaly for each interval (such as hour or day) or show all anomalies in the selected time period."}),h=a.i18n.translate("xpack.securitySolution.ml.table.intervalLabel",{defaultMessage:"Interval"}),v=a.i18n.translate("xpack.securitySolution.ml.table.intervalAutoOption",{defaultMessage:"Auto"}),E=a.i18n.translate("xpack.securitySolution.ml.table.intervalHourOption",{defaultMessage:"1 hour"}),x=a.i18n.translate("xpack.securitySolution.ml.table.intervalDayOption",{defaultMessage:"1 day"}),k=a.i18n.translate("xpack.securitySolution.ml.table.intervalshowAllOption",{defaultMessage:"Show all"})},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));var a=n(34);const i=e=>Object(a.some)({category:"kibana",field:"kibana.alert.rule.uuid"},e),r=({data:e})=>{var t;if(!i(e))return!1;const n=null===(t=Object(a.find)({field:"agent.type"},e))||void 0===t?void 0:t.values;return!!n&&"endpoint"===n[0]},o=({ecsData:e})=>{if(null==e)return!1;const t=Object(a.getOr)([],"kibana.alert.original_event.module",e),n=Object(a.getOr)([],"kibana.alert.original_event.kind",e);return t.includes("endpoint")&&n.includes("alert")}},function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return s}));var a=n(93),i=n(110);n.d(t,"a",(function(){return i.e}));const r=a.b.ENDPOINT_EVENTS,o={name:i.f,namespace_type:"agnostic",description:i.d,list_id:i.e,type:r},s=["name","description","entries.value","entries.entries.value","comments.comment","item_id"]},function(e,t,n){"use strict";n.d(t,"c",(function(){return h})),n.d(t,"d",(function(){return E})),n.d(t,"b",(function(){return x})),n.d(t,"a",(function(){return k}));var a=n(4),i=n(120),r=n(422),o=n(77),s=n(1);const l=async e=>{const{indexName:t,entity:n}=e.query;return o.b.get().http.fetch(s.jc,{method:"GET",query:{indexName:t,entity:n},asSystemRequest:!0,signal:e.signal})};var c=n(126),u=n(85),d=n(0);d.i18n.translate("xpack.securitySolution.riskScore.errorSearchDescription",{defaultMessage:"An error has occurred on risk score search"});const p=d.i18n.translate("xpack.securitySolution.riskScore.failSearchDescription",{defaultMessage:"Failed to run search on risk score"});var m=n(84);const g=e=>{var t,n;return"index_not_found_exception"===(null===(t=e.attributes)||void 0===t||null===(n=t.caused_by)||void 0===n?void 0:n.type)};var f=n(358),b=n(130);const y={totalCount:0,data:void 0},h=({timerange:e,onlyLatest:t=!0,filterQuery:n,sort:o,skip:s=!1,pagination:d,riskEntity:h,includeAlertsCount:v=!1})=>{const E=Object(f.a)(),x=E?h===u.v.host?Object(u.E)(E,t):Object(u.F)(E,t):void 0,k=h===u.v.host?u.u.hostsRiskScore:u.u.usersRiskScore,{querySize:S,cursorStart:w}=d||{},{addError:j}=Object(m.a)(),{isDeprecated:O,isEnabled:I,isLicenseValid:T,isLoading:C,refetch:M}=((e,t)=>{const{isPlatinumOrTrialLicense:n,capabilitiesFetched:o}=Object(i.a)(),{fetch:s,data:c,isLoading:u,error:d}=Object(r.b)(r.a.GET_RISK_SCORE_DEPRECATED,l),p=Object(a.useMemo)((()=>c||{isDeprecated:n,isEnabled:n}),[c]),m=Object(a.useCallback)((t=>{s({query:{indexName:t,entity:e}})}),[e,s]);return Object(a.useEffect)((()=>{n&&null!=t&&m(t)}),[n,t,m]),{error:d,isLoading:u||!o||null==t,refetch:m,isLicenseValid:n,...p}})(h,x),{loading:N,result:D,search:F,refetch:A,inspect:_,error:R}=Object(b.a)({factoryQueryType:k,initialResult:y,abort:s,showErrorToast:!1}),P=Object(a.useCallback)((()=>{x&&(M(x),A())}),[x,A,M]);Object(a.useEffect)((()=>{P()}),[null==e?void 0:e.to,null==e?void 0:e.from]);const L=Object(a.useMemo)((()=>({data:D.data,inspect:_,refetch:P,totalCount:D.totalCount,isLicenseValid:T,isDeprecated:O,isModuleEnabled:I,isInspected:!1})),[_,O,I,T,P,D.data,D.totalCount]),q=Object(a.useMemo)((()=>e?{to:e.to,from:e.from,interval:""}:void 0),[e]),B=Object(a.useMemo)((()=>x?{defaultIndex:[x],factoryQueryType:k,riskScoreEntity:h,includeAlertsCount:v,filterQuery:Object(c.a)(n),pagination:void 0!==w&&void 0!==S?{cursorStart:w,querySize:S}:void 0,sort:o,timerange:t?void 0:q}:null),[w,x,k,n,S,o,q,t,h,v]);return Object(a.useEffect)((()=>{R&&(g(R)||j(R,{title:p}))}),[j,R]),Object(a.useEffect)((()=>{s||C||null==B||!T||!I||O||F(B)}),[I,O,T,C,B,F,s]),{...L,loading:N||C}},v=d.i18n.translate("xpack.securitySolution.riskScore.kpi.failSearchDescription",{defaultMessage:"Failed to run search on risk score"}),E=({filterQuery:e,skip:t,riskEntity:n,timerange:r})=>{const{addError:o}=Object(m.a)(),s=Object(f.a)(),l=Object(i.a)().isPlatinumOrTrialLicense,c=s?n===u.v.host?Object(u.E)(s):Object(u.F)(s):void 0,{loading:d,result:p,search:y,refetch:h,inspect:E,error:x}=Object(b.a)({factoryQueryType:u.u.kpiRiskScore,initialResult:{kpiRiskScore:u.c},abort:t,showErrorToast:!1}),k=!!x&&g(x);Object(a.useEffect)((()=>{!t&&c&&l&&y({filterQuery:e,defaultIndex:[c],entity:n})}),[c,y,e,t,n,l]),Object(a.useEffect)((()=>{h()}),[null==r?void 0:r.to,null==r?void 0:r.from]),Object(a.useEffect)((()=>{x&&(g(x)||o(x,{title:v}))}),[o,x]);const S=Object(a.useMemo)((()=>{var e,t,n,a,i;if(!d&&!x)return{[u.x.unknown]:null!==(e=p.kpiRiskScore[u.x.unknown])&&void 0!==e?e:0,[u.x.low]:null!==(t=p.kpiRiskScore[u.x.low])&&void 0!==t?t:0,[u.x.moderate]:null!==(n=p.kpiRiskScore[u.x.moderate])&&void 0!==n?n:0,[u.x.high]:null!==(a=p.kpiRiskScore[u.x.high])&&void 0!==a?a:0,[u.x.critical]:null!==(i=p.kpiRiskScore[u.x.critical])&&void 0!==i?i:0}}),[p,d,x]);return{error:x,severityCount:S,loading:d,isModuleDisabled:k,refetch:h,inspect:E}};let x,k;!function(e){e.USERS_BY_RISK="UsersByRisk",e.USER_DETAILS_RISK_SCORE="UserDetailsRiskScore"}(x||(x={})),function(e){e.DEFAULT="HostRiskScore",e.HOST_DETAILS_RISK_SCORE="HostDetailsRiskScore",e.OVERVIEW_RISKY_HOSTS="OverviewRiskyHosts",e.HOSTS_BY_RISK="HostsByRisk"}(k||(k={}))},function(e,t,n){"use strict";n.d(t,"b",(function(){return C})),n.d(t,"a",(function(){return M}));var a=n(839),i=n(4),r=n.n(i),o=n(133),s=n(102),l=n(87),c=n(106),u=n(150),d=n(636);const p={isInstance:(e,t)=>((e,t)=>-1===t.findIndex((t=>t.field===e)))(e,t),renderColumn:({columnName:e,eventId:t,field:n,isDraggable:a=!0,scopeId:i,truncate:p})=>a?r.a.createElement(o.b,{dataProvider:{enabled:!0,id:Object(s.h)(`empty-column-renderer-draggable-wrapper-${i}-${e}-${t}-${n.id}`),name:`${e}: ${Object(d.a)(null)}`,queryMatch:{field:n.id,value:Object(d.a)(null),displayValue:Object(l.e)(),operator:c.b},excluded:!0,kqlQuery:"",and:[]},isDraggable:a,key:`empty-column-renderer-draggable-wrapper-${i}-${e}-${t}-${n.id}`,render:(e,t,n)=>n.isDragging?r.a.createElement(o.a,null,r.a.createElement(u.a,{dataProvider:e})):r.a.createElement("span",null,Object(l.e)()),truncate:p,scopeId:i}):r.a.createElement("span",null,Object(l.e)())};var m=n(874),g=n(34),f=n(196);const b={isInstance:(e,t)=>((e,t)=>-1!==t.findIndex((t=>t.field===e)))(e,t),renderColumn:({asPlainText:e,columnName:t,eventId:n,field:a,isDraggable:i=!0,scopeId:o,truncate:s,values:c,linkValues:u})=>{return Array.isArray(c)&&0!==c.length?i?c.map(((l,c)=>{var d,p,m;return r.a.createElement(f.a,{asPlainText:e,contextId:`plain-column-renderer-formatted-field-value-${o}`,eventId:n,fieldFormat:null!==(d=a.format)&&void 0!==d?d:"",fieldName:t,isAggregatable:null!==(p=a.aggregatable)&&void 0!==p&&p,fieldType:null!==(m=a.type)&&void 0!==m?m:"",isDraggable:i,key:`plain-column-renderer-formatted-field-value-${o}-${t}-${n}-${a.id}-${l}-${c}`,linkValue:Object(g.head)(u),truncate:s,value:l})})):r.a.createElement(f.a,{asPlainText:e,contextId:`plain-column-renderer-formatted-field-value-${o}`,eventId:n,fieldFormat:null!==(d=a.format)&&void 0!==d?d:"",fieldName:t,isAggregatable:null!==(p=a.aggregatable)&&void 0!==p&&p,fieldType:null!==(m=a.type)&&void 0!==m?m:"",isDraggable:i,key:`plain-column-renderer-formatted-field-value-${o}-${t}-${n}-${a.id}`,linkValue:Object(g.head)(u),truncate:s,value:y(c)}):Object(l.d)();var d,p,m}};function y(e){return Array.isArray(e)?e.length>0?e.join(", "):e[0]:e}var h=n(908);const v={isInstance:()=>!0,renderColumn:()=>Object(l.d)()};var E=n(909),x=n(344),k=n(905),S=n(32),w=n(104),j=n(176),O=n(375);const I={isInstance:Object(g.isEqual)(j.i),renderColumn:({columnName:e,ecsData:t,eventId:n,field:a,isDetails:i,isDraggable:o=!0,linkValues:s,rowRenderers:l=[],scopeId:c,truncate:u,values:d})=>i&&d&&t&&l?d.map(((i,o)=>r.a.createElement(T,{ecsData:t,key:`reason-column-renderer-value-${c}-${e}-${n}-${a.id}-${i}-${o}`,rowRenderers:l,scopeId:c,value:i}))):b.renderColumn({columnName:e,eventId:n,field:a,isDetails:i,isDraggable:o,linkValues:s,scopeId:c,truncate:u,values:d})},T=({ecsData:e,rowRenderers:t,scopeId:n,value:a})=>{const o=Object(i.useMemo)((()=>Object(O.a)({data:e,rowRenderers:t})),[e,t]),s=Object(i.useMemo)((()=>o&&o.renderRow({data:e,isDraggable:!1,scopeId:n})),[o,e,n]),l=Object(i.useMemo)((()=>n===w.c.rulePreview),[n]);return r.a.createElement(r.a.Fragment,null,o&&s&&!l?r.a.createElement(S.EuiPanel,{color:"subdued",className:"eui-xScroll","data-test-subj":"reason-cell-renderer"},r.a.createElement(S.EuiText,{size:"xs"},r.a.createElement("div",{className:"eui-displayInlineBlock"},s))):a)},C=[k.a,...a.a,...x.k,h.a,E.a,m.a],M=[I,b,p,v]},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(4),i=n.n(a),r=n(33),o=n.n(r),s=n(287),l=n(32),c=n(866);const u=o.a.header.withConfig({displayName:"FiltersGlobalContainer",componentId:"sc-z1qy4y-0"})(["display:",";"],(({show:e})=>e?"block":"none"));u.displayName="FiltersGlobalContainer";const d=i.a.memo((({children:e,show:t=!0})=>{const{globalKQLHeaderPortalNode:n}=Object(c.a)();return i.a.createElement(s.a,{node:n},i.a.createElement(l.EuiPanel,{borderRadius:"none",color:"subdued",paddingSize:"none"},i.a.createElement(u,{"data-test-subj":"filters-global-container",show:t},e)))}));d.displayName="FiltersGlobal"},,,,function(e,t,n){"use strict";n.d(t,"c",(function(){return m})),n.d(t,"i",(function(){return b})),n.d(t,"e",(function(){return y})),n.d(t,"g",(function(){return h})),n.d(t,"h",(function(){return v})),n.d(t,"f",(function(){return E})),n.d(t,"d",(function(){return x})),n.d(t,"b",(function(){return k})),n.d(t,"a",(function(){return S}));var a=n(49),i=n(32),r=n(4),o=n.n(r),s=n(33),l=n.n(s),c=n(1),u=n(77);const d="100%",p=l.a.div.withConfig({displayName:"WrappedByAutoSizerComponent",componentId:"sc-k085ek-0"})([""," position:relative;&:hover{z-index:100;}"],(e=>`\n    height: ${null!=e.height?e.height:d};\n  `));p.displayName="WrappedByAutoSizer";const m=o.a.memo(p);let g;!function(e){e.BAR="bar",e.AREA="area",e.LINE="line"}(g||(g={}));const f={chartMargins:{left:0,right:0,top:4,bottom:0},chartPaddings:{left:0,right:0,top:0,bottom:0},scales:{barsPadding:.05}},b=()=>{const e=Object(u.p)(c.O)?a.DARK_THEME:a.LIGHT_THEME;return Object(r.useMemo)((()=>Object(a.mergeWithDefaultTheme)(f,e)),[])},y={rotation:0,rendering:"canvas",animatedData:!1,showLegend:!1,showLegendExtra:!1,debug:!1,legendPosition:a.Position.Bottom},h=(e,t)=>{const n=e||t;return n?`${n}px`:d},v=(e,t)=>{const n=e||t;return n?`${n}px`:"100%"},E=e=>Array.isArray(e)&&e.every((e=>Array.isArray(e.value)&&e.value.every((({y:e})=>0===e)))),x=l.a.div.withConfig({displayName:"Wrapper",componentId:"sc-k085ek-1"})(["position:relative;"]),k=l()(i.EuiFlexGroup).withConfig({displayName:"ChartWrapper",componentId:"sc-k085ek-2"})(["z-index:0;"]),S=l()(i.EuiFlexGroup).withConfig({displayName:"BarChartWrapper",componentId:"sc-k085ek-3"})(["z-index:0;padding-right:20px;"])},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(34);const i=({category:e,field:t},n)=>{const i=(({category:e,field:t},n)=>{var i,r,o;const s="signal"===e?"kibana":"kibana"===e?"signal":e,l="signal"===e?t.replace("signal","kibana.alert").replace("rule.id","rule.uuid"):"kibana"===e?t.replace("kibana.alert","signal").replace("rule.uuid","rule.id"):t;return null!==(i=null===(r=Object(a.find)({category:e,field:t},n))||void 0===r?void 0:r.values)&&void 0!==i?i:null===(o=Object(a.find)({category:s,field:l},n))||void 0===o?void 0:o.values})({category:e,field:t},n);return i&&i.length>0?i[0]:""}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(56);const i=(e,t)=>{const n=e.split(".");return 1===n.length?{[n[0]]:t}:{[n[0]]:i(n.slice(1).join("."),t)}},r=e=>Array.isArray(e)?e:Object.entries(e).reduce(((e,[t,n])=>Object(a.merge)(e,i(t,n))),{})},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"g",(function(){return c})),n.d(t,"f",(function(){return u}));var a=n(0);const i=a.i18n.translate("xpack.securitySolution.containers.detectionEngine.rulesAndTimelines",{defaultMessage:"Failed to fetch Rules and Timelines"}),r=a.i18n.translate("xpack.securitySolution.containers.detectionEngine.addRuleFailDescription",{defaultMessage:"Failed to add Rule"}),o=a.i18n.translate("xpack.securitySolution.containers.detectionEngine.createPrePackagedRuleAndTimelineFailDescription",{defaultMessage:"Failed to installed pre-packaged rules and timelines from elastic"}),s=a.i18n.translate("xpack.securitySolution.containers.detectionEngine.createPrePackagedRuleAndTimelineSuccesDescription",{defaultMessage:"Installed pre-packaged rules and timeline templates from elastic"}),l=a.i18n.translate("xpack.securitySolution.containers.detectionEngine.createPrePackagedRuleSuccesDescription",{defaultMessage:"Installed pre-packaged rules from elastic"}),c=a.i18n.translate("xpack.securitySolution.containers.detectionEngine.createPrePackagedTimelineSuccesDescription",{defaultMessage:"Installed pre-packaged timeline templates from elastic"}),u=a.i18n.translate("xpack.securitySolution.containers.detectionEngine.tagFetchFailDescription",{defaultMessage:"Failed to fetch Tags"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var a=n(82),i=n.n(a),r=n(4),o=n.n(r),s=n(32),l=n(78),c=n(98),u=n(90),d=n(145),p=n(12),m=n(184),g=n(95),f=n(79),b=n(210),y=n(118),h=n(81);const v=({asEmptyButton:e,children:t,dataProviders:n,filters:a,timeRange:v,keepDataView:E,...x})=>{const k=Object(l.useDispatch)(),S=Object(r.useMemo)((()=>c.e.getSourcererDataViewsSelector()),[]),{defaultDataView:w,signalIndexName:j}=Object(h.a)((e=>S(e))),O=n&&n.find((e=>"template"===e.type)),I=Object(b.a)({timelineId:f.j.active,timelineType:O?f.n.template:f.n.default}),T=Object(r.useCallback)((()=>{(n||a)&&(v?I({timeRange:v}):I(),n&&k(Object(p.updateProviders)({id:f.j.active,providers:n})),a&&k(Object(p.setFilters)({id:f.j.active,filters:a})),E||k(m.c.setSelectedDataView({id:g.SourcererScopeName.timeline,selectedDataViewId:w.id,selectedPatterns:[j||""]})),k(d.b.removeLinkTo([u.a.timeline,u.a.global])))}),[n,I,k,w.id,j,a,v,E]);return e?o.a.createElement(s.EuiButtonEmpty,{"aria-label":y.f,onClick:T,flush:"right",size:"xs"},t):o.a.createElement(s.EuiButton,i()({"aria-label":y.f,onClick:T},x),t)};v.displayName="InvestigateInTimelineButton"},function(e,t,n){"use strict";n.d(t,"j",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"g",(function(){return l})),n.d(t,"c",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"i",(function(){return p})),n.d(t,"h",(function(){return m})),n.d(t,"e",(function(){return g})),n.d(t,"a",(function(){return f}));var a=n(34),i=n(79),r=n(254);const o=(e,t)=>"__typename"!==e&&null!=t?t:void 0,s=e=>!Object(a.isEmpty)(e),l=({isAlert:e,isPinned:t,eventHasNotes:n,timelineType:a})=>a===i.n.template?r.f(e):t&&n?r.l(e):t?r.k(e):r.q(e),c=({eventId:e,pinnedEventIds:t})=>!0===t[e],u=({allowUnpinning:e,eventId:t,onPinEvent:n,onUnPinEvent:a,isEventPinned:i})=>{e&&(i?a(t):n(t))},d=(e,t,n)=>e.reduce(((e,a)=>({...e,...t.includes(a._id)?{[a._id]:a.data.filter((e=>n.includes(e.field)))}:{}})),{}),p=e=>{var t,n;return!Object(a.isEmpty)(null===(t=e.kibana)||void 0===t||null===(n=t.alert)||void 0===n?void 0:n.building_block_type)},m=e=>{var t;if(!Object(a.isEmpty)(null===(t=e.eql)||void 0===t?void 0:t.sequenceNumber))try{var n,i;const t=(null!==(n=null===(i=e.eql)||void 0===i?void 0:i.sequenceNumber)&&void 0!==n?n:"").split("-")[0];return parseInt(t,10)%2==0}catch{return!1}return!1},g=e=>{var t,n,i,r;return Object(a.isEmpty)(null===(t=e.kibana)||void 0===t||null===(n=t.alert)||void 0===n||null===(i=n.rule)||void 0===i?void 0:i.uuid)?Object(a.isEmpty)(null===(r=e.eql)||void 0===r?void 0:r.parentId)?"raw":"eql":"signal"},f="note-content"},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o}));var a=n(0);const i=a.i18n.translate("xpack.securitySolution.chart.dataAllValuesZerosTitle",{defaultMessage:"All values returned zero"}),r=a.i18n.translate("xpack.securitySolution.chart.dataNotAvailableTitle",{defaultMessage:"Chart Data Not Available"}),o=a.i18n.translate("xpack.securitySolution.chart.emptyValueLabel",{defaultMessage:"empty value"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"e",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"f",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return l}));const a=e=>e?[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:"host.name",params:{query:e}},query:{match_phrase:{"host.name":e}}}]:[],i=[{query:{bool:{should:[{exists:{field:"host.name"}}],minimum_should_match:1}},meta:{alias:"",disabled:!1,key:"bool",negate:!1,type:"custom",value:'{"query": {"bool": {"filter": [{"bool": {"should": [{"exists": {"field": "host.name"}}],"minimum_should_match": 1}}]}}}'}}],r=e=>e?[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:"source.ip",params:{query:e}},query:{bool:{should:[{match_phrase:{"source.ip":e}},{match_phrase:{"destination.ip":e}}],minimum_should_match:1}}}]:[],o=[{query:{bool:{should:[{exists:{field:"source.ip"}},{exists:{field:"destination.ip"}}],minimum_should_match:1}},meta:{alias:"",disabled:!1,key:"bool",negate:!1,type:"custom",value:'{"bool":{"filter":[{"bool":{"should":[{"bool":{"should":[{"exists":{"field": "source.ip"}}],"minimum_should_match":1}},{"bool":{"should":[{"exists":{"field": "destination.ip"}}],"minimum_should_match":1}}],"minimum_should_match":1}}]}}'}}],s=e=>e.length>=1?[{meta:{type:"phrases",key:"_index",params:e,alias:null,negate:!1,disabled:!1},query:{bool:{should:e.map((e=>({match_phrase:{_index:e}}))),minimum_should_match:1}}}]:[],l=e=>e.reduce(((e,t)=>{var n,a,i,r,o,s;return{requests:[...e.requests,JSON.stringify({body:null==t?void 0:t.json,index:(null!==(n=null==t||null===(a=t.stats)||void 0===a||null===(i=a.indexFilter)||void 0===i?void 0:i.value)&&void 0!==n?n:"").split(",")},null,2)],responses:[...e.responses,JSON.stringify(null!==(r=null==t||null===(o=t.response)||void 0===o||null===(s=o.json)||void 0===s?void 0:s.rawResponse)&&void 0!==r?r:{},null,2)]}}),{requests:[],responses:[]})},function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return l}));var a=n(4),i=n.n(a),r=n(88),o=n(722);const s="event.duration",l=i.a.memo((({contextId:e,eventId:t,fieldName:n,fieldType:a,isAggregatable:s,isDraggable:l,value:c})=>l?i.a.createElement(r.b,{id:`duration-default-draggable-${e}-${t}-${n}-${c}`,fieldType:a,isAggregatable:s,isDraggable:l,field:n,tooltipContent:null,value:c},i.a.createElement(o.a,{maybeDurationNanoseconds:c,tooltipTitle:n})):i.a.createElement(o.a,{maybeDurationNanoseconds:c,tooltipTitle:n})));l.displayName="Duration"},function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return c}));var a=n(4),i=n.n(a),r=n(196);const o="source.ip",s="destination.ip",l="ip",c=i.a.memo((({contextId:e,eventId:t,fieldName:n,isDraggable:a,value:o})=>i.a.createElement(r.a,{contextId:e,"data-test-subj":"formatted-ip",eventId:t,fieldName:n,isDraggable:a,fieldType:l,value:o,truncate:!0})));c.displayName="Ip"},function(e,t,n){(function(t){const n="object"==typeof t&&Object({IS_KIBANA_DISTRIBUTABLE:"true"})&&Object({IS_KIBANA_DISTRIBUTABLE:"true"}).NODE_DEBUG&&/\bsemver\b/i.test(Object({IS_KIBANA_DISTRIBUTABLE:"true"}).NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=n}).call(this,n(545))},function(e,t){const n=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:n,MAX_SAFE_COMPONENT_LENGTH:16}},function(e,t,n){"use strict";var a=Object.assign;e.exports=a},function(e,t,n){"use strict";n.d(t,"g",(function(){return h})),n.d(t,"b",(function(){return O})),n.d(t,"e",(function(){return C})),n.d(t,"f",(function(){return M})),n.d(t,"h",(function(){return N})),n.d(t,"c",(function(){return L})),n.d(t,"d",(function(){return q})),n.d(t,"a",(function(){return B}));var a=n(52),i=n.n(a),r=n(43),o=n.n(r),s=n(294),l=n.n(s),c=(n(37),n(33)),u=n.n(c),d=n(32),p=n(110),m=n(166),g=n(174),f=n(661),b=n(167),y=n(567);const h=({rule:e,detailsView:t=!1})=>{const n=E(e);return{aboutRuleData:w(e,t),modifiedAboutRuleDetailsData:T(e),defineRuleData:n,scheduleRuleData:k(e),ruleActionsData:v(e)}},v=e=>{const{enabled:t,throttle:n,meta:a,actions:i=[],response_actions:r}=e;return{actions:null==i?void 0:i.map(f.c),responseActions:null==r?void 0:r.map(f.d),throttle:n,kibanaSiemAppUrl:null==a?void 0:a.kibana_siem_app_url,enabled:t}},E=e=>{var t,n,a,i,r,o,s,l,c,u,d,p,g,f,y,h,v,E,k,S,w,j,O;return{ruleType:e.type,anomalyThreshold:null!==(t=e.anomaly_threshold)&&void 0!==t?t:50,machineLearningJobId:null!==(n=e.machine_learning_job_id)&&void 0!==n?n:[],index:null!==(a=e.index)&&void 0!==a?a:[],dataViewId:e.data_view_id,threatIndex:null!==(i=e.threat_index)&&void 0!==i?i:[],threatQueryBar:{query:{query:null!==(r=e.threat_query)&&void 0!==r?r:"",language:null!==(o=e.threat_language)&&void 0!==o?o:""},filters:null!==(s=e.threat_filters)&&void 0!==s?s:[],saved_id:null},threatMapping:null!==(l=e.threat_mapping)&&void 0!==l?l:[],queryBar:{query:{query:null!==(c=e.query)&&void 0!==c?c:"",language:null!==(u=e.language)&&void 0!==u?u:""},filters:null!==(d=e.filters)&&void 0!==d?d:[],saved_id:null!==(p=e.saved_id)&&void 0!==p?p:null},relatedIntegrations:null!==(g=e.related_integrations)&&void 0!==g?g:[],requiredFields:null!==(f=e.required_fields)&&void 0!==f?f:[],timeline:{id:null!==(y=e.timeline_id)&&void 0!==y?y:null,title:null!==(h=e.timeline_title)&&void 0!==h?h:null},threshold:{field:Object(m.h)(null===(v=e.threshold)||void 0===v?void 0:v.field),value:`${(null===(E=e.threshold)||void 0===E?void 0:E.value)||100}`,...null!==(k=e.threshold)&&void 0!==k&&null!==(S=k.cardinality)&&void 0!==S&&S.length?{cardinality:{field:[`${e.threshold.cardinality[0].field}`],value:`${e.threshold.cardinality[0].value}`}}:{}},eqlOptions:{timestampField:e.timestamp_field,eventCategoryField:e.event_category_override,tiebreakerField:e.tiebreaker_field},dataSourceType:e.data_view_id?b.a.DataView:b.a.IndexPatterns,newTermsFields:null!==(w=e.new_terms_fields)&&void 0!==w?w:[],historyWindowSize:e.history_window_start?x(e.history_window_start):"7d",shouldLoadQueryDynamically:Boolean("saved_query"===e.type&&e.saved_id),groupByFields:null!==(j=null===(O=e.alert_suppression)||void 0===O?void 0:O.group_by)&&void 0!==j?j:[]}},x=e=>e.startsWith("now-")?e.substring(4):e,k=e=>{const{interval:t,from:n}=e;return{interval:t,from:S(n,t)}},S=(e,t)=>{var n,a;const r=null!==(n=i.a.parse(e))&&void 0!==n?n:o()(),s=null!==(a=i.a.parse(`now-${t}`))&&void 0!==a?a:o()(),l=o.a.duration(s.diff(r)),c=Math.floor(l.asSeconds());return 0===c?"0s":c%3600==0?c/3600+"h":c%60==0?c/60+"m":`${c}s`},w=(e,t)=>{var n;const{name:a,description:i,note:r}=I(e,t),{author:o,building_block_type:s,exceptions_list:l,license:c,risk_score_mapping:u,rule_name_override:d,severity_mapping:m,timestamp_override:g,timestamp_override_fallback_disabled:f,references:b,severity:y,false_positives:h,risk_score:v,tags:E,threat:x,threat_indicator_path:k}=e;return{author:o,isAssociatedToEndpointList:null!==(n=null==l?void 0:l.some((({id:e})=>e===p.j)))&&void 0!==n&&n,isBuildingBlock:void 0!==s,license:null!=c?c:"",ruleNameOverride:null!=d?d:"",timestampOverride:null!=g?g:"",timestampOverrideFallbackDisabled:f,name:a,description:i,note:r,references:b,severity:{value:y,mapping:O(m),isMappingChecked:m.length>0},tags:E,riskScore:{value:v,mapping:u,isMappingChecked:u.length>0},falsePositives:h,threat:x,threatIndicatorPath:k}},j={low:0,medium:1,high:2,critical:3},O=e=>{const t=y.i.flatMap((t=>null==e.find((e=>e.severity===t.value))?[{field:"",value:"",operator:"equals",severity:t.value}]:[]));return[...e,...t].sort(((e,t)=>j[e.severity]-j[t.severity]))},I=(e,t)=>{const{name:n,description:a,note:i}=e;return t?{name:"",description:"",note:""}:{name:n,description:a,note:null!=i?i:""}},T=e=>{var t,n;return{note:null!==(t=e.note)&&void 0!==t?t:"",description:e.description,setup:null!==(n=e.setup)&&void 0!==n?n:""}},C=(e,t,n)=>null!=t&&0===e&&t>0&&0===n?"ruleNotInstalled":null!=e&&e>0&&0===t&&0===n?"ruleInstalled":null!=e&&null!=t&&e>0&&t>0&&0===n?"someRuleUninstall":null!=e&&null!=t&&null!=n&&e>0&&t>=0&&n>0?"ruleNeedUpdate":"unknown",M=(e,t,n)=>null!=t&&0===e&&t>0&&0===n?"timelinesNotInstalled":null!=e&&e>0&&0===t&&0===n?"timelinesInstalled":null!=e&&null!=t&&e>0&&t>0&&0===n?"someTimelineUninstall":null!=e&&null!=t&&null!=n&&e>0&&t>=0&&n>0?"timelineNeedUpdate":"unknown",N=(e,t,n,a)=>!1===e||!1===t||!1===n||a,D=["id","name","description","false_positives","rule_id","max_signals","risk_score","output_index","references","severity","timeline_id","timeline_title","threat","type","version"],F=["index","filters","language","query","saved_id","response_actions"],A=["anomaly_threshold","machine_learning_job_id"],_=["threshold",...F],R=e=>{switch(e){case"machine_learning":return A;case"threshold":return _;case"new_terms":case"threat_match":case"query":case"saved_query":case"eql":return F}Object(g.a)(e)},P=e=>({state:[{name:"signals_count",description:"state.signals_count"}],params:[],context:[{name:"results_link",description:"context.results_link",useWithTripleBracesInTemplates:!0},{name:"alerts",description:"context.alerts"},...e.map((e=>{const t=`rule.${e}`;return{name:t,description:`context.${t}`}}))]}),L=l()((e=>{if(!e)return{state:[],params:[]};const t=(e=>[...D,...R(e)].sort())(e);return P(t)})),q=()=>P((()=>{const e=[...D,...F,...A,..._].sort();return Array.from(new Set(e))})()),B=u()(d.EuiFlexItem).withConfig({displayName:"MaxWidthEuiFlexItem",componentId:"sc-97v502-0"})(["max-width:1000px;overflow:hidden;"])},function(e,t,n){"use strict";n.d(t,"m",(function(){return i})),n.d(t,"k",(function(){return r})),n.d(t,"l",(function(){return o})),n.d(t,"i",(function(){return s})),n.d(t,"j",(function(){return l})),n.d(t,"h",(function(){return c})),n.d(t,"g",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return p})),n.d(t,"d",(function(){return m})),n.d(t,"c",(function(){return g})),n.d(t,"f",(function(){return f})),n.d(t,"e",(function(){return b}));var a=n(0);const i=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlValidation.requestError",{defaultMessage:"An error occurred while validating your EQL query"}),r=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlValidation.title",{defaultMessage:"EQL Validation Errors"}),o=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlValidation.showErrorsLabel",{defaultMessage:"Show EQL Validation Errors"}),s=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlOverViewLink.text",{defaultMessage:"Event Query Language (EQL) Overview"}),l=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlSettings.title",{defaultMessage:"EQL settings"}),c=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsSize.label",{defaultMessage:"Size"}),u=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsSize.text",{defaultMessage:"For basic queries, the maximum number of matching events to return. For sequence queries, the maximum number of matching sequences to return."}),d=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventCategoryField.label",{defaultMessage:"Event category field"}),p=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventCategoryField.text",{defaultMessage:"Field containing the event classification, such as process, file, or network. This field is typically mapped as a field type in the keyword family"}),m=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTiebreakerField.label",{defaultMessage:"Tiebreaker field"}),g=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTiebreakerField.text",{defaultMessage:"Field used to sort hits with the same timestamp in ascending, lexicographic order"}),f=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTimestampField.label",{defaultMessage:"Timestamp field"}),b=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTimestampField.text",{defaultMessage:"Field containing event timestamp"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(4);const i=(e=!1)=>{const[t,n]=Object(a.useState)(e);return[t,Object(a.useCallback)((()=>{n(!0)}),[]),Object(a.useCallback)((()=>{n(!1)}),[]),Object(a.useCallback)((()=>{n((e=>!e))}),[])]}},function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return c}));var a=n(113),i=n(157),r=n(416);const o=e=>"boolean"==typeof e,s=(e,t)=>{var n;return null==e||!((null===(n=e.actions)||void 0===n?void 0:n.length)>0&&o(t))||t},l=e=>null==e||e,c=(e,t,n,o)=>null==e?void 0:Object(i.d)(e.type)&&!t?r.f:s(e,n)?l(o)?void 0:a.Pb:a.Ob},function(e,t,n){"use strict";n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return u}));var a=n(117),i=n.n(a),r=n(139);const o=r.b.length,s=e=>{var t;return void 0!==(null!==(t=e.tags)&&void 0!==t?t:[]).find((e=>e===r.d))},l=e=>!s(e),c=e=>{var t;const n=[],a=null!==(t=e.tags)&&void 0!==t?t:[];for(const e of a)e!==r.d&&e.startsWith(r.b)&&n.push(e.substring(o));return n},u=e=>({comments:[],description:"",entries:[],item_id:void 0,list_id:e,meta:{temporaryUuid:i.a.v4()},name:"",namespace_type:"agnostic",tags:[r.d],type:"simple",os_types:["windows"]})},function(e,t,n){"use strict";n.d(t,"a",(function(){return ExceptionsListApiClient}));var a=n(6),i=n.n(a),r=n(110),o=n(105);class ExceptionsListApiClient{constructor(e,t,n,a,r){i()(this,"ensureListExists",void 0),this.http=e,this.listId=t,this.listDefinition=n,this.readTransform=a,this.writeTransform=r,this.ensureListExists=this.createExceptionList()}async createExceptionList(){return ExceptionsListApiClient.wasListCreated.has(this.listId)||ExceptionsListApiClient.wasListCreated.set(this.listId,new Promise(((e,t)=>{(async()=>{try{await this.http.post(r.u,{body:JSON.stringify({...this.listDefinition,list_id:this.listId})}),e()}catch(e){ExceptionsListApiClient.wasListCreated.delete(this.listId),t(e)}})()}))),ExceptionsListApiClient.wasListCreated.get(this.listId)}checkIfIsUsingTheRightInstance(e){if(e!==this.listId)throw new Error(`The list id you are using is not valid, expected [${this.listId}] list id but received [${e}] list id`)}isHttp(e){return this.http===e}static getInstance(e,t,n,a,i){var r;ExceptionsListApiClient.instance.has(t)&&null!==(r=ExceptionsListApiClient.instance.get(t))&&void 0!==r&&r.isHttp(e)||ExceptionsListApiClient.instance.set(t,new ExceptionsListApiClient(e,t,n,a,i));return ExceptionsListApiClient.instance.get(t)||new ExceptionsListApiClient(e,t,n,a,i)}static cleanExceptionsBeforeUpdate(e){var t;const n={...e};return["created_at","created_by","list_id","tie_breaker_id","updated_at","updated_by","meta"].forEach((e=>{delete n[e]})),n.comments=null===(t=n.comments)||void 0===t?void 0:t.map((e=>({comment:e.comment,id:e.id}))),n}async find({perPage:e=o.c,page:t=o.b+1,sortField:n,sortOrder:a,filter:i}={}){await this.ensureListExists;const s=await this.http.get(`${r.p}/_find`,{query:{page:t,per_page:e,sort_field:n,sort_order:a,list_id:[this.listId],namespace_type:["agnostic"],filter:i}});return this.readTransform&&(s.data=s.data.map(this.readTransform)),s}async get(e,t){if(!e&&!t)throw TypeError("either `itemId` or `id` argument must be set");await this.ensureListExists;let n=await this.http.get(r.p,{query:{id:t,item_id:e,namespace_type:"agnostic"}});return this.readTransform&&(n=this.readTransform(n)),n}async create(e){await this.ensureListExists,this.checkIfIsUsingTheRightInstance(e.list_id),delete e.meta;let t=e;return this.writeTransform&&(t=this.writeTransform(e)),this.http.post(r.p,{body:JSON.stringify(t)})}async update(e){await this.ensureListExists;let t=e;return this.writeTransform&&(t=this.writeTransform(e)),this.http.put(r.p,{body:JSON.stringify(ExceptionsListApiClient.cleanExceptionsBeforeUpdate(t))})}async delete(e,t){if(!e&&!t)throw TypeError("either `itemId` or `id` argument must be set");return await this.ensureListExists,this.http.delete(r.p,{query:{id:t,item_id:e,namespace_type:"agnostic"}})}async summary(e){return await this.ensureListExists,this.http.get(`${r.s}/summary`,{query:{filter:e,list_id:this.listId,namespace_type:"agnostic"}})}async hasData(){return(await this.find({perPage:1,page:1})).total>0}}i()(ExceptionsListApiClient,"instance",new Map),i()(ExceptionsListApiClient,"wasListCreated",new Map)},,function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));var a=n(77),i=n(1);const r=async({body:e,signal:t})=>a.b.get().http.fetch(i.tc,{method:"POST",body:JSON.stringify(e),signal:t}),o=async(e,t)=>a.b.get().http.fetch(i.tc,{method:"GET",query:{dataViewId:e},asSystemRequest:!0,signal:t})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(82),i=n.n(a),r=n(33),o=n.n(r),s=n(4),l=n.n(s),c=n(32);const u=o()((({loading:e,...t})=>l.a.createElement(c.EuiPanel,i()({},t,{hasBorder:!0})))).withConfig({displayName:"Panel",componentId:"sc-1bcf9ex-0"})(["position:relative;",""],(({loading:e})=>e&&"\n    overflow: hidden;\n  "));u.displayName="Panel"},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(43),i=n.n(a);const r=(e,t)=>"second"===t||"minute"===t||"hour"===t?{from:i()(e.time).subtract(1,"hour").toISOString(),to:i()(e.time).add(1,"hour").toISOString()}:{from:i()(e.time).subtract(1,"day").toISOString(),to:i()(e.time).add(1,"day").toISOString()}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(4),i=n.n(a),r=n(716),o=n(164);const s=Object(a.memo)((()=>i.a.createElement(o.a,null,i.a.createElement(r.a,null))));s.displayName="LandingPageComponent"},function(e,t,n){const a=n(152);e.exports=(e,t,n)=>a(e,t,n)<=0},function(e,t){const n=["includePrerelease","loose","rtl"];e.exports=e=>e?"object"!=typeof e?{loose:!0}:n.filter((t=>e[t])).reduce(((e,t)=>(e[t]=!0,e)),{}):{}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(82),i=n.n(a),r=n(4),o=n.n(r),s=n(32),l=n(243),c=n(1);const u=Object(r.memo)((({appId:e=c.B,deepLinkId:t,appPath:n,appState:a,onClick:r,asButton:u,children:d,...p})=>{const m=Object(l.a)(e,{deepLinkId:t,path:n,state:a,onClick:r});return o.a.createElement(o.a.Fragment,null,u&&!0===u?o.a.createElement(s.EuiButton,i()({},p,{onClick:m}),d):o.a.createElement(s.EuiLink,i()({},p,{onClick:m}),d))}))},,function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(4),i=n(1),r=n(77);const o=async(e,t)=>r.b.get().http.fetch("/api/ml/results/anomalies_table_data",{method:"POST",body:JSON.stringify(e),asSystemRequest:!0,signal:t});var s=n(868),l=n(84),c=n(422),u=n(120),d=n(171);const p=e=>null==e?"":e.reduce(((e,t)=>`${e}${t.fieldName}:${t.fieldValue}`),""),m=(e,t)=>-1!==t?t:null==e?50:e<0?0:e>100?100:Math.floor(e),g=({criteriaFields:e=[],influencers:t=[],startDate:n,endDate:g,threshold:f=-1,skip:b=!1,filterQuery:y,jobIds:h,aggregationInterval:v})=>{const E=Object(u.a)(),x=Object(d.a)(E),{addError:k}=Object(l.a)(),S=Object(r.n)(),[w]=Object(r.q)(i.K),j=Object(a.useMemo)((()=>new Date(n).getTime()),[n]),O=Object(a.useMemo)((()=>new Date(g).getTime()),[g]),{fetch:I,data:T=null,isLoading:C,error:M}=Object(c.b)(c.a.ANOMALIES_TABLE,o,{disabled:b});return Object(a.useEffect)((()=>{M&&k(M,{title:s.a})}),[M,k]),Object(a.useEffect)((()=>{x&&h.length>0&&I({jobIds:h,criteriaFields:e,influencersFilterQuery:y,aggregationInterval:v,threshold:m(w,f),earliestMs:j,latestMs:O,influencers:t,dateFormatTz:S,maxRecords:500,maxExamples:10})}),[p(t),p(e),j,O,x,v,h.sort().join()]),[C,T]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var a=n(4),i=n.n(a),r=n(33),o=n.n(r),s=n(32),l=n(78);const c=n(0).i18n.translate("xpack.securitySolution.components.histogram.stackByOptions.stackByLabel",{defaultMessage:"Stack by"});var u=n(620),d=n(119),p=n(621),m=n(318),g=n(460),f=n(924),b=n(143),y=n(90),h=n(211),v=n(530),E=n(1),x=n(183),k=n(109);const S=o()(m.a).withConfig({displayName:"HistogramPanel",componentId:"sc-b0xfci-0"})(["display:flex;flex-direction:column;",""],(({height:e})=>null!=e?`min-height: ${e}px;`:"")),w=({chartHeight:e,defaultStackByOption:t,endDate:n,errorMessage:r,filterQuery:o,getLensAttributes:m,headerChildren:w,histogramType:j,hideHistogramIfEmpty:O=!1,id:I,indexNames:T,runtimeMappings:C,isPtrIncluded:M,legendPosition:N,lensAttributes:D,mapping:F,onError:A,paddingSize:_="m",panelHeight:R=300,setAbsoluteRangeDatePickerTarget:P=y.a.global,setQuery:L,showInspectButton:q=!1,showLegend:B,showSpacer:z=!0,stackByOptions:$,startDate:V,subtitle:U,scopeId:H,title:G,titleSize:Q,yTickFormatter:W,skip:K})=>{const Y=Object(l.useDispatch)(),J=Object(a.useCallback)((({x:e})=>{if(!e)return;const[t,n]=e;Y(Object(b.setAbsoluteRangeDatePicker)({id:P,from:new Date(t).toISOString(),to:new Date(n).toISOString()}))}),[Y,P]),X=Object(a.useMemo)((()=>Object(g.b)({chartHeight:e,from:V,legendPosition:N,to:n,onBrushEnd:J,yTickFormatter:W,showLegend:B})),[e,V,N,n,J,W,B]),[Z,ee]=Object(a.useState)(!0),[te,ne]=Object(a.useState)(t);Object(a.useEffect)((()=>{ne(t)}),[t]);const ae=Object(a.useCallback)((e=>{var n;ne(null!==(n=$.find((t=>t.value===e.target.value)))&&void 0!==n?n:t)}),[t,$]),{toggleStatus:ie,setToggleStatus:re}=Object(k.a)(I),[oe,se]=Object(a.useState)(K||!ie);Object(a.useEffect)((()=>{se(K||!ie)}),[K,ie]);const le=Object(a.useCallback)((e=>{re(e),se(!e)}),[se,re]),ce={endDate:n,errorMessage:r,filterQuery:o,histogramType:j,indexNames:T,onError:A,startDate:V,stackByField:te.value,runtimeMappings:C,isPtrIncluded:M,skip:oe},[ue,{data:de,inspect:pe,totalCount:me,refetch:ge}]=Object(f.a)(ce),[{pageName:fe}]=Object(x.a)(),be=fe===E.uc.hosts||fe===E.uc.network||fe===E.uc.users,ye=Object(a.useMemo)((()=>null!=G&&"function"==typeof G?G(te):G),[G,te]),he=Object(a.useMemo)((()=>Z?null:"function"==typeof U?me>=0?U(me):null:U),[Z,U,me]),ve=Object(a.useMemo)((()=>!!(me<=0&&O)),[me,O]),Ee=Object(a.useMemo)((()=>Object(g.c)(de,F)),[de,F]);Object(a.useEffect)((()=>{ue||Z||L({id:I,inspect:pe,loading:ue,refetch:ge}),Z&&Ee&&de&&ee(!1)}),[L,I,pe,ue,ge,Z,Ee,de,ee]);const xe=Object(a.useMemo)((()=>({from:V,to:n})),[V,n]);return ve?null:i.a.createElement(i.a.Fragment,null,i.a.createElement(h.a,{show:!Z,targetClassNames:[v.a]},i.a.createElement(S,{"data-test-subj":`${I}Panel`,height:ie?R:void 0,paddingSize:_},ue&&!Z&&i.a.createElement(s.EuiProgress,{"data-test-subj":"initialLoadingPanelMatrixOverTime",size:"xs",position:"absolute",color:"accent"}),i.a.createElement(d.a,{id:I,height:ie?void 0:0,title:ye,titleSize:Q,toggleStatus:ie,toggleQuery:le,subtitle:he,inspectMultiple:!0,showInspectButton:q||!be,isInspectDisabled:void 0===o},i.a.createElement(s.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},be&&(m||D)&&xe&&i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(v.b,{className:"histogram-viz-actions",getLensAttributes:m,isInspectButtonDisabled:void 0===o,lensAttributes:D,queryId:I,stackByField:te.value,timerange:xe,title:G})),i.a.createElement(s.EuiFlexItem,{grow:!1},$.length>1&&i.a.createElement(s.EuiSelect,{onChange:ae,options:$,prepend:c,value:null==te?void 0:te.value})),i.a.createElement(s.EuiFlexItem,{grow:!1},w))),ie?Z?i.a.createElement(p.a,null):i.a.createElement(u.a,{barChart:Ee,configs:X,stackByField:te.value,scopeId:H}):null)),z&&i.a.createElement(s.EuiSpacer,{"data-test-subj":"spacer",size:"l"}))},j=i.a.memo(w)},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(4),i=n.n(a),r=n(32),o=n(0),s=n(35);const l=o.i18n.translate("xpack.securitySolution.detectionResponse.updating",{defaultMessage:"Updating..."}),c=o.i18n.translate("xpack.securitySolution.detectionResponse.updated",{defaultMessage:"Updated"}),u=({isUpdating:e,updatedAt:t})=>i.a.createElement(r.EuiFlexGroup,null,e?i.a.createElement(r.EuiFlexItem,{grow:!1},l):i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(i.a.Fragment,null,c," "),i.a.createElement(s.FormattedRelative,{"data-test-subj":"last-updated-at-date",value:new Date(t)})))},,function(e,t,n){var a=n(433),i=n(750),r=n(751),o=n(437),s=n(770),l=n(441),c=n(771),u=n(443),d=n(444),p=n(447),m=Math.max;e.exports=function(e,t,n,g,f,b,y,h){var v=2&t;if(!v&&"function"!=typeof e)throw new TypeError("Expected a function");var E=g?g.length:0;if(E||(t&=-97,g=f=void 0),y=void 0===y?y:m(p(y),0),h=void 0===h?h:p(h),E-=f?f.length:0,64&t){var x=g,k=f;g=f=void 0}var S=v?void 0:l(e),w=[e,t,n,g,f,x,k,b,y,h];if(S&&c(w,S),e=w[0],t=w[1],n=w[2],g=w[3],f=w[4],!(h=w[9]=void 0===w[9]?v?0:e.length:m(w[9]-E,0))&&24&t&&(t&=-25),t&&1!=t)j=8==t||16==t?r(e,t,h):32!=t&&33!=t||f.length?o.apply(void 0,w):s(e,t,n,g);else var j=i(e,t,n);return d((S?a:u)(j,w),e,t)}},function(e,t,n){e.exports=n(27)(3416)},function(e,t,n){e.exports=n(27)(336)},function(e,t,n){var a=n(330),i=n(333);function r(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}r.prototype=a(i.prototype),r.prototype.constructor=r,e.exports=r},function(e,t){e.exports=function(){}},function(e,t,n){e.exports=n(27)(257)},function(e,t,n){e.exports=n(27)(3406)},function(e,t,n){e.exports=n(27)(1503)},function(e,t){var n="__lodash_placeholder__";e.exports=function(e,t){for(var a=-1,i=e.length,r=0,o=[];++a<i;){var s=e[a];s!==t&&s!==n||(e[a]=n,o[r++]=a)}return o}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d}));var a=n(39),i=n(4),r=n(1),o=n(457),s=n(138),l=n(353);const c=["GET",r.pb],u=(e,t)=>Object(a.useQuery)([...c,e],(async({signal:t})=>{const n=await Object(s.e)({signal:t,id:e});return Object(o.a)(n)}),{...l.a,...t}),d=()=>{const e=Object(a.useQueryClient)();return Object(i.useCallback)((()=>{e.invalidateQueries(c,{refetchType:"active"})}),[e])}},function(e,t,n){"use strict";n.d(t,"D",(function(){return i})),n.d(t,"E",(function(){return r})),n.d(t,"H",(function(){return o})),n.d(t,"G",(function(){return s})),n.d(t,"B",(function(){return l})),n.d(t,"I",(function(){return c})),n.d(t,"C",(function(){return u})),n.d(t,"F",(function(){return d})),n.d(t,"a",(function(){return p})),n.d(t,"c",(function(){return m})),n.d(t,"b",(function(){return g})),n.d(t,"d",(function(){return f})),n.d(t,"e",(function(){return b})),n.d(t,"M",(function(){return y})),n.d(t,"A",(function(){return h})),n.d(t,"m",(function(){return v})),n.d(t,"J",(function(){return E})),n.d(t,"j",(function(){return x})),n.d(t,"p",(function(){return k})),n.d(t,"q",(function(){return S})),n.d(t,"y",(function(){return w})),n.d(t,"x",(function(){return j})),n.d(t,"w",(function(){return O})),n.d(t,"z",(function(){return I})),n.d(t,"u",(function(){return T})),n.d(t,"s",(function(){return C})),n.d(t,"t",(function(){return M})),n.d(t,"v",(function(){return N})),n.d(t,"r",(function(){return D})),n.d(t,"N",(function(){return F})),n.d(t,"l",(function(){return A})),n.d(t,"K",(function(){return _})),n.d(t,"g",(function(){return R})),n.d(t,"i",(function(){return P})),n.d(t,"f",(function(){return L})),n.d(t,"h",(function(){return q})),n.d(t,"k",(function(){return B})),n.d(t,"n",(function(){return z})),n.d(t,"L",(function(){return $})),n.d(t,"o",(function(){return V}));var a=n(0);const i=a.i18n.translate("xpack.securitySolution.detectionResponse.alertsByStatus.donut.criticalLabel",{defaultMessage:"Critical"}),r=a.i18n.translate("xpack.securitySolution.detectionResponse.alertsByStatus.donut.highLabel",{defaultMessage:"High"}),o=a.i18n.translate("xpack.securitySolution.detectionResponse.alertsByStatus.donut.mediumLabel",{defaultMessage:"Medium"}),s=a.i18n.translate("xpack.securitySolution.detectionResponse.alertsByStatus.donut.lowLabel",{defaultMessage:"Low"}),l=a.i18n.translate("xpack.securitySolution.detectionResponse.alertsByStatus.status.acknowledged",{defaultMessage:"Acknowledged"}),c=a.i18n.translate("xpack.securitySolution.detectionResponse.status.open",{defaultMessage:"Open"}),u=a.i18n.translate("xpack.securitySolution.detectionResponse.status.closed",{defaultMessage:"Closed"}),d=a.i18n.translate("xpack.securitySolution.detectionResponse.status.inProgress",{defaultMessage:"In progress"}),p=e=>a.i18n.translate("xpack.securitySolution.detectionResponse.alertsByStatus.totalAlerts",{values:{totalAlerts:e},defaultMessage:"total {totalAlerts, plural, =1 {alert} other {alerts}}"}),m=a.i18n.translate("xpack.securitySolution.detectionResponse.alerts",{defaultMessage:"Alerts"}),g=a.i18n.translate("xpack.securitySolution.detectionResponse.alertsBySeverity",{defaultMessage:"Alerts by Severity"}),f=(a.i18n.translate("xpack.securitySolution.detectionResponse.updating",{defaultMessage:"Updating..."}),a.i18n.translate("xpack.securitySolution.detectionResponse.updated",{defaultMessage:"Updated"}),e=>a.i18n.translate("xpack.securitySolution.detectionResponse.casesByStatus.totalCases",{values:{totalCases:e},defaultMessage:"total {totalCases, plural, =1 {case} other {cases}}"})),b=a.i18n.translate("xpack.securitySolution.detectionResponse.casesByStatusSectionTitle",{defaultMessage:"Cases"}),y=a.i18n.translate("xpack.securitySolution.detectionResponse.viewCases",{defaultMessage:"View cases"}),h=a.i18n.translate("xpack.securitySolution.detectionResponse.ruleAlertsSectionTitle",{defaultMessage:"Open alerts by rule"}),v=a.i18n.translate("xpack.securitySolution.detectionResponse.hostAlertsSectionTitle",{defaultMessage:"Hosts by alert severity"}),E=a.i18n.translate("xpack.securitySolution.detectionResponse.userAlertsSectionTitle",{defaultMessage:"Users by alert severity"}),x=a.i18n.translate("xpack.securitySolution.detectionResponse.caseSectionTitle",{defaultMessage:"Recently created cases"}),k=a.i18n.translate("xpack.securitySolution.detectionResponse.noRuleAlerts",{defaultMessage:"No alerts to display"}),S=a.i18n.translate("xpack.securitySolution.detectionResponse.noRecentCases",{defaultMessage:"No cases to display"}),w=a.i18n.translate("xpack.securitySolution.detectionResponse.ruleAlertsColumnRuleName",{defaultMessage:"Rule name"}),j=a.i18n.translate("xpack.securitySolution.detectionResponse.ruleAlertsColumnLastAlert",{defaultMessage:"Last alert"}),O=a.i18n.translate("xpack.securitySolution.detectionResponse.ruleAlertsColumnAlertCount",{defaultMessage:"Alert count"}),I=a.i18n.translate("xpack.securitySolution.detectionResponse.ruleAlertsColumnSeverity",{defaultMessage:"Severity"}),T=a.i18n.translate("xpack.securitySolution.detectionResponse.openRuleDetailTooltip",{defaultMessage:"Open rule detail"}),C=a.i18n.translate("xpack.securitySolution.detectionResponse.openCaseDetailTooltip",{defaultMessage:"Open case detail"}),M=a.i18n.translate("xpack.securitySolution.detectionResponse.openHostDetailTooltip",{defaultMessage:"Open host detail"}),N=a.i18n.translate("xpack.securitySolution.detectionResponse.openUserDetailTooltip",{defaultMessage:"Open user detail"}),D=a.i18n.translate("xpack.securitySolution.detectionResponse.openAllAlertsButton",{defaultMessage:"View all open alerts"}),F=a.i18n.translate("xpack.securitySolution.detectionResponse.viewRecentCases",{defaultMessage:"View recent cases"}),A=a.i18n.translate("xpack.securitySolution.detectionResponse.hostAlertsHostName",{defaultMessage:"Host name"}),_=a.i18n.translate("xpack.securitySolution.detectionResponse.userAlertsUserName",{defaultMessage:"User name"}),R=a.i18n.translate("xpack.securitySolution.detectionResponse.caseColumnName",{defaultMessage:"Name"}),P=a.i18n.translate("xpack.securitySolution.detectionResponse.caseColumnTime",{defaultMessage:"Time"}),L=a.i18n.translate("xpack.securitySolution.detectionResponse.caseColumnCreatedBy",{defaultMessage:"Created by"}),q=a.i18n.translate("xpack.securitySolution.detectionResponse.caseColumnStatus",{defaultMessage:"Status"}),B=a.i18n.translate("xpack.securitySolution.detectionResponse.errorMessage",{defaultMessage:"Error fetching case data"}),z=a.i18n.translate("xpack.securitySolution.detectionResponse.hostSectionTooltip",{defaultMessage:"Maximum of 100 hosts. Please consult Alerts page for further information."}),$=a.i18n.translate("xpack.securitySolution.detectionResponse.userSectionTooltip",{defaultMessage:"Maximum of 100 users. Please consult Alerts page for further information."}),V=a.i18n.translate("xpack.securitySolution.detectionResponse.investigateInTimeline",{defaultMessage:"Investigate in Timeline"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"g",(function(){return c})),n.d(t,"h",(function(){return u})),n.d(t,"i",(function(){return d})),n.d(t,"j",(function(){return p})),n.d(t,"f",(function(){return m}));var a=n(0);const i=a.i18n.translate("xpack.securitySolution.timeline.categoryTooltip",{defaultMessage:"Category"}),r=a.i18n.translate("xpack.securitySolution.timeline.descriptionTooltip",{defaultMessage:"Description"}),o=a.i18n.translate("xpack.securitySolution.timeline.fieldTooltip",{defaultMessage:"Field"}),s=a.i18n.translate("xpack.securitySolution.timeline.fullScreenButton",{defaultMessage:"Full screen"}),l=a.i18n.translate("xpack.securitySolution.timeline.hideColumnLabel",{defaultMessage:"Hide column"}),c=a.i18n.translate("xpack.securitySolution.timeline.sortAZLabel",{defaultMessage:"Sort A-Z"}),u=a.i18n.translate("xpack.securitySolution.timeline.sortFieldsButton",{defaultMessage:"Sort fields"}),d=a.i18n.translate("xpack.securitySolution.timeline.sortZALabel",{defaultMessage:"Sort Z-A"}),p=a.i18n.translate("xpack.securitySolution.timeline.typeTooltip",{defaultMessage:"Type"}),m=a.i18n.translate("xpack.securitySolution.timeline.flyout.pane.removeColumnButtonLabel",{defaultMessage:"Remove column"})},function(e,t,n){"use strict";function a(e){return`resolver-${e}`}n.d(t,"a",(function(){return a}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return u}));var a=n(276),i=n(151),r=n(144);function o(e){return"processTerminated"===function(e){if(i.i(e)){const{endgame:{event_type_full:t,event_subtype_full:n}}=e;if("process_event"===t)return"creation_event"===n||"fork_event"===n||"exec_event"===n?"processCreated":"already_running"===n?"processRan":"termination_event"===n?"processTerminated":"unknownProcessEvent";if("alert_event"===t)return"processCausedAlert"}else{const t=new Set(i.h(e)),n=new Set(i.d(e)),a=new Set(i.f(e));if(n.has("process"))return t.has("start")||t.has("change")||t.has("creation")?"processCreated":t.has("info")?"processRan":t.has("end")?"processTerminated":"unknownProcessEvent";if(a.has("alert"))return"processCausedAlert"}return"unknownEvent"}(e)}function s(e){const t=r.a(e),n=void 0===t?0:new Date(t).getTime();return isNaN(n)?null:n}function l(e){var t;return Object(a.a)(i.i(e)?e.endgame.pid:null===(t=e.process)||void 0===t?void 0:t.pid)}function c(e){var t;return Object(a.a)(i.i(e)?e.endgame.process_path:null===(t=e.process)||void 0===t?void 0:t.executable)}function u(e,t){const n=s(e),a=s(t);return n===a?String(r.b(e)).localeCompare(String(r.b(t))):null===n||null===a?(null===n?1:0)-(null===a?1:0):n-a}},,function(e,t,n){"use strict";n.d(t,"h",(function(){return Ee})),n.d(t,"b",(function(){return xe})),n.d(t,"f",(function(){return ke})),n.d(t,"c",(function(){return Se})),n.d(t,"d",(function(){return we})),n.d(t,"g",(function(){return je})),n.d(t,"j",(function(){return Oe})),n.d(t,"i",(function(){return Ie})),n.d(t,"a",(function(){return Te})),n.d(t,"e",(function(){return Ce})),n.d(t,"k",(function(){return It}));var a=n(34),i=n(4),r=n.n(i),o=n(79),s=n(32),l=n(97),c=n(199),u=n(88),d=n(224),p=n(644);const m=r.a.memo((({contextId:e,eventId:t,hostName:n,hostNameSeparator:a="@",isDraggable:i,userDomain:o,userDomainField:s="user.domain",userName:c,userNameField:d="user.name",workingDirectory:m})=>null!=c||null!=o||null!=n||null!=m?r.a.createElement(r.a.Fragment,null,r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:t,field:d,isDraggable:i,value:c,iconType:"user",fieldType:"keyword",isAggregatable:!0})),null!=o&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.c,{"data-test-subj":"user-host-working-dir-domain-separator-text",grow:!1,component:"span"},"\\"),r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:t,field:s,isDraggable:i,value:o,fieldType:"keyword",isAggregatable:!0}))),null!=n&&null!=c&&r.a.createElement(l.c,{grow:!1,component:"span"},a),r.a.createElement(p.a,{contextId:e,eventId:t,hostName:n,isDraggable:i,workingDirectory:m})):null));m.displayName="UserHostWorkingDir";var g=n(0);const f=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.dns.askedForDescription",{defaultMessage:"asked for"}),b=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.dns.responseCodeDescription",{defaultMessage:"response code:"}),y=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.dns.viaDescription",{defaultMessage:"via"}),h=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.dns.whichResolvedToDescription",{defaultMessage:", which resolved to"}),v=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.dns.withQuestionTypeDescription",{defaultMessage:"with question type"}),E=r.a.memo((({contextId:e,dnsQuestionName:t,dnsQuestionType:n,dnsResolvedIp:a,dnsResponseCode:i,eventCode:o,hostName:c,id:p,isDraggable:g,processExecutable:E,processName:x,processPid:k,userDomain:S,userName:w,winlogEventId:j})=>r.a.createElement(r.a.Fragment,null,r.a.createElement(s.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none",wrap:!0},r.a.createElement(m,{contextId:e,eventId:p,hostName:c,isDraggable:g,userDomain:S,userName:w,workingDirectory:void 0}),!Object(l.e)(t)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.c,{component:"span","data-test-subj":"asked-for",grow:!1},f),r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(u.c,{contextId:e,eventId:p,field:"dns.question.name",isDraggable:g,value:t,isAggregatable:!0,fieldType:"keyword"}))),!Object(l.e)(n)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.c,{component:"span","data-test-subj":"with-question-type",grow:!1},v),r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(u.c,{contextId:e,eventId:p,field:"dns.question.type",isDraggable:g,value:n,isAggregatable:!0,fieldType:"keyword"}))),!Object(l.e)(a)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.c,{component:"span","data-test-subj":"which-resolved-to",grow:!1},h),r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(u.c,{contextId:e,eventId:p,field:"dns.resolved_ip",isDraggable:g,value:a,isAggregatable:!0,fieldType:"ip"}))),!Object(l.e)(i)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.c,{component:"span",grow:!1},"("),r.a.createElement(l.c,{component:"span","data-test-subj":"response-code",grow:!1},b),r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(u.c,{contextId:e,eventId:p,field:"dns.response_code",isDraggable:g,value:i,isAggregatable:!0,fieldType:"keyword"})),r.a.createElement(l.c,{component:"span",grow:!1},")")),r.a.createElement(l.c,{component:"span",grow:!1},y),r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(d.b,{contextId:e,endgamePid:void 0,endgameProcessName:void 0,eventId:p,isDraggable:g,processPid:k,processName:x,processExecutable:E})),(!Object(l.e)(o)||!Object(l.e)(j))&&r.a.createElement(r.a.Fragment,null,Object(l.e)(o)?r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(u.c,{contextId:e,eventId:p,iconType:"logoWindows",field:"winlog.event_id",isDraggable:g,value:j,isAggregatable:!0,fieldType:"keyword"})):r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(u.c,{contextId:e,eventId:p,field:"event.code",isDraggable:g,value:o,isAggregatable:!0,fieldType:"number"})))))));E.displayName="DnsRequestEventDetailsLine";const x=r.a.memo((({data:e,contextId:t,isDraggable:n,timelineId:i})=>{const o=Object(a.get)("dns.question.name[0]",e),u=Object(a.get)("dns.question.type[0]",e),d=Object(a.get)("dns.resolved_ip[0]",e),p=Object(a.get)("dns.response_code[0]",e),m=Object(a.get)("event.code[0]",e),g=Object(a.get)("host.name[0]",e),f=e._id,b=Object(a.get)("process.executable[0]",e),y=Object(a.get)("process.name[0]",e),h=Object(a.get)("process.pid[0]",e),v=Object(a.get)("user.domain[0]",e),x=Object(a.get)("user.name[0]",e),k=Object(a.get)("winlog.event_id[0]",e);return r.a.createElement(l.b,null,r.a.createElement(E,{contextId:t,dnsQuestionName:o,dnsQuestionType:u,dnsResolvedIp:d,dnsResponseCode:p,eventCode:m,hostName:g,id:f,isDraggable:n,processExecutable:b,processName:y,processPid:h,userDomain:v,userName:x,winlogEventId:k}),r.a.createElement(s.EuiSpacer,{size:"s"}),r.a.createElement(c.a,{data:e,isDraggable:n,timelineId:i}))}));x.displayName="DnsRequestEventDetails";const k=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.aLoginWasAttemptedUsingExplicitCredentialsDescription",{defaultMessage:"A login was attempted using explicit credentials"}),S=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.asRequestedBySubjectDescription",{defaultMessage:"as requested by subject"}),w=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.endpoint.failedToLogInDescription",{defaultMessage:"failed to log in"}),j=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.endpoint.failedToLogOffDescription",{defaultMessage:"failed to log off"}),O=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.loggedOffDescription",{defaultMessage:"logged off"}),I=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeBatchDescription",{defaultMessage:"Batch"}),T=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeCachedInteractiveDescription",{defaultMessage:"Cached Interactive"}),C=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeInteractiveDescription",{defaultMessage:"Interactive"}),M=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeNetworkDescription",{defaultMessage:"Network"}),N=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeNetworkCleartextDescription",{defaultMessage:"Network Cleartext"}),D=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeNewCredentialsDescription",{defaultMessage:"New Credentials"}),F=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeRemoteInteractiveDescription",{defaultMessage:"Remote Interactive"}),A=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeServiceDescription",{defaultMessage:"Service"}),_=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeUnlockDescription",{defaultMessage:"Unlock"}),R=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.subjectLogonIdDescription",{defaultMessage:"subject logon ID"}),P=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.successfullyLoggedInDescription",{defaultMessage:"successfully logged in"}),L=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.targetLogonIdDescription",{defaultMessage:"target logon ID"}),q=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.toDescription",{defaultMessage:"to"}),B=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.usingLogonTypeDescription",{defaultMessage:"using logon type"}),z=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.viaDescription",{defaultMessage:"via"}),$=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.withSpecialPrivilegesDescription",{defaultMessage:"With special privileges,"}),V=e=>{if(Object(l.e)(e))return"";switch(e){case 2:return C;case 3:return M;case 4:return I;case 5:return A;case 7:return _;case 8:return N;case 9:return D;case 10:return F;case 11:return T;default:return`${e}`}},U=e=>"explicit_user_logon"===e||"user_logoff"===e,H=r.a.memo((({contextId:e,endgameLogonType:t,endgameSubjectDomainName:n,endgameSubjectLogonId:a,endgameSubjectUserName:i,endgameTargetDomainName:o,endgameTargetLogonId:c,endgameTargetUserName:p,eventAction:g,eventCode:f,eventOutcome:b,hostName:y,id:h,isDraggable:v,processExecutable:E,processName:x,processPid:I,userDomain:T,userName:C,winlogEventId:M})=>{const N=U(g)?o:T,D=(({eventAction:e,eventOutcome:t})=>{switch(e){case"explicit_user_logon":return"";case"log_off":case"user_logoff":return"failure"===(null==t?void 0:t.toLowerCase())?j:O;default:return"failure"===(null==t?void 0:t.toLowerCase())?w:P}})({eventAction:g,eventOutcome:b}),F=(e=>"explicit_user_logon"===e?q:"@")(g),A=U(g)?p:C,_=(e=>U(e)?"endgame.target_domain_name":"user.domain")(g),H=(e=>U(e)?"endgame.target_user_name":"user.name")(g);return r.a.createElement(r.a.Fragment,null,r.a.createElement(s.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none",wrap:!0},"admin_logon"===g&&r.a.createElement(l.c,{component:"span","data-test-subj":"with-special-privileges",grow:!1},$),"explicit_user_logon"===g&&r.a.createElement(l.c,{component:"span","data-test-subj":"a-login-was-attempted",grow:!1},k),r.a.createElement(m,{contextId:e,eventId:h,hostName:y,hostNameSeparator:F,isDraggable:v,userDomain:N,userDomainField:_,userName:A,userNameField:H,workingDirectory:void 0}),r.a.createElement(l.c,{component:"span","data-test-subj":"event-details",grow:!1},D),!Object(l.e)(t)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.c,{component:"span","data-test-subj":"using-logon-type",grow:!1},B),r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(u.c,{contextId:e,eventId:h,field:"endgame.logon_type",isDraggable:v,queryValue:String(t),value:`${t} - ${V(t)}`,isAggregatable:!0,fieldType:"keyword"}))),!Object(l.e)(c)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.c,{component:"span",grow:!1},"("),r.a.createElement(l.c,{component:"span","data-test-subj":"using-logon-type",grow:!1},L),r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(u.c,{contextId:e,eventId:h,field:"endgame.target_logon_id",isDraggable:v,value:c,isAggregatable:!0,fieldType:"keyword"})),r.a.createElement(l.c,{component:"span",grow:!1},")")),r.a.createElement(l.c,{component:"span",grow:!1},z),r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(d.b,{contextId:e,endgamePid:void 0,endgameProcessName:void 0,eventId:h,isDraggable:v,processPid:I,processName:x,processExecutable:E})),!Object(l.e)(i)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.c,{component:"span","data-test-subj":"as-requested-by-subject",grow:!1},S),r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(u.c,{contextId:e,eventId:h,field:"endgame.subject_user_name",isDraggable:v,iconType:"user",value:i,isAggregatable:!0,fieldType:"keyword"}))),null!=n&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.c,{component:"span","data-test-subj":"subject-domain-name-domain-separator-text",grow:!1},"\\"),r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(u.c,{contextId:e,eventId:h,field:"endgame.subject_domain_name",isDraggable:v,value:n,isAggregatable:!0,fieldType:"keyword"}))),!Object(l.e)(a)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.c,{component:"span",grow:!1},"("),r.a.createElement(l.c,{component:"span","data-test-subj":"subject-login-id",grow:!1},R),r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(u.c,{contextId:e,eventId:h,field:"endgame.subject_logon_id",isDraggable:v,value:a,isAggregatable:!0,fieldType:"keyword"})),r.a.createElement(l.c,{component:"span",grow:!1},")")),(!Object(l.e)(f)||!Object(l.e)(M))&&r.a.createElement(r.a.Fragment,null,Object(l.e)(f)?r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(u.c,{contextId:e,eventId:h,iconType:"logoWindows",field:"winlog.event_id",value:M,isAggregatable:!0,fieldType:"keyword"})):r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(u.c,{contextId:e,eventId:h,field:"event.code",value:f,isAggregatable:!0,fieldType:"keyword"})))))}));H.displayName="EndgameSecurityEventDetailsLine";const G=r.a.memo((({data:e,contextId:t,isDraggable:n,timelineId:i})=>{const o=Object(a.get)("endgame.logon_type[0]",e),u=Object(a.get)("endgame.subject_domain_name[0]",e),d=Object(a.get)("endgame.subject_logon_id[0]",e),p=Object(a.get)("endgame.subject_user_name[0]",e),m=Object(a.get)("endgame.target_logon_id[0]",e),g=Object(a.get)("endgame.target_domain_name[0]",e),f=Object(a.get)("endgame.target_user_name[0]",e),b=Object(a.get)("event.action[0]",e),y=Object(a.get)("event.code[0]",e),h=Object(a.get)("event.outcome[0]",e),v=Object(a.get)("host.name[0]",e),E=e._id,x=Object(a.get)("process.executable[0]",e),k=Object(a.get)("process.name[0]",e),S=Object(a.get)("process.pid[0]",e),w=Object(a.get)("user.domain[0]",e),j=Object(a.get)("user.name[0]",e),O=Object(a.get)("winlog.event_id[0]",e);return r.a.createElement(l.b,null,r.a.createElement(H,{contextId:t,endgameLogonType:o,endgameSubjectDomainName:u,endgameSubjectLogonId:d,endgameSubjectUserName:p,endgameTargetDomainName:g,endgameTargetLogonId:m,endgameTargetUserName:f,eventAction:b,eventCode:y,eventOutcome:h,hostName:v,id:E,isDraggable:n,processExecutable:x,processName:k,processPid:S,userDomain:w,userName:j,winlogEventId:O}),r.a.createElement(s.EuiSpacer,{size:"s"}),r.a.createElement(c.a,{data:e,timelineId:i}))}));G.displayName="EndgameSecurityEventDetails";const Q=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.registry.viaDescription",{defaultMessage:"via"}),W=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.registry.withNewValueDescription",{defaultMessage:"with new value"}),K=({contextId:e,hostName:t,id:n,isDraggable:a,processName:o,processPid:c,registryKey:p,registryPath:g,text:f,userDomain:b,userName:y})=>{const h=Object(i.useMemo)((()=>r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,"registry.key"),r.a.createElement("div",null,p))),[p]),v=Object(i.useMemo)((()=>r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,"registry.path"),r.a.createElement("div",null,g))),[g]);return Object(l.e)(p)?null:r.a.createElement(r.a.Fragment,null,r.a.createElement(s.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none",wrap:!0},r.a.createElement(m,{contextId:e,eventId:n,hostName:t,isDraggable:a,userDomain:b,userName:y,workingDirectory:void 0}),!Object(l.e)(p)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.c,{component:"span","data-test-subj":"text",grow:!1},f),r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(u.c,{contextId:e,eventId:n,field:"registry.key",isDraggable:a,tooltipContent:h,value:p,isAggregatable:!0,fieldType:"keyword"}))),!Object(l.e)(g)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.c,{component:"span","data-test-subj":"with-new-value",grow:!1},W),r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(u.c,{contextId:e,eventId:n,field:"registry.path",isDraggable:a,tooltipContent:v,value:g,isAggregatable:!0,fieldType:"keyword"}))),r.a.createElement(l.c,{component:"span",grow:!1},Q),r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(d.b,{contextId:e,endgamePid:void 0,endgameProcessName:void 0,eventId:n,isDraggable:a,processPid:c,processName:o,processExecutable:void 0}))))},Y=r.a.memo(K),J=({contextId:e,data:t,isDraggable:n,text:i})=>{const o=Object(a.get)("host.name[0]",t),s=t._id,c=Object(a.get)("process.name[0]",t),u=Object(a.get)("process.pid[0]",t),d=Object(a.get)("registry.key[0]",t),p=Object(a.get)("registry.path[0]",t),m=Object(a.get)("user.domain[0]",t),g=Object(a.get)("user.name[0]",t);return Object(l.e)(d)?null:r.a.createElement(l.b,null,r.a.createElement(Y,{contextId:e,hostName:o,id:s,isDraggable:n,processName:c,processPid:u,registryKey:d,registryPath:p,text:i,userDomain:m,userName:g}))};J.displayName="RegistryEventDetailsComponent";const X=r.a.memo(J);var Z=n(223),ee=n(181),te=n(278);const ne=r.a.memo((({contextId:e,eventId:t,isDraggable:n,packageName:a,packageSummary:i,packageVersion:o})=>null!=a||null!=i||null!=o?r.a.createElement(r.a.Fragment,null,r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:t,field:"system.audit.package.name",isDraggable:n,value:a,iconType:"document",isAggregatable:!0,fieldType:"keyword"})),r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:t,field:"system.audit.package.version",isDraggable:n,value:o,iconType:"document",isAggregatable:!0,fieldType:"keyword"})),r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:t,field:"system.audit.package.summary",isDraggable:n,value:i,isAggregatable:!0,fieldType:"keyword"}))):null));ne.displayName="Package";const ae=r.a.memo((({contextId:e,eventId:t,isDraggable:n,sshSignature:a,sshMethod:i})=>r.a.createElement(r.a.Fragment,null,null!=a&&r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:t,field:"system.audit.package.name",isDraggable:n,value:a,iconType:"document",isAggregatable:!0,fieldType:"keyword"})),null!=i&&r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:t,field:"system.audit.package.version",isDraggable:n,value:i,iconType:"document",isAggregatable:!0,fieldType:"keyword"})))));ae.displayName="AuthSsh";var ie=n(160);const re=r.a.memo((({contextId:e,hostName:t,id:n,isDraggable:a,message:i,outcome:o,packageName:c,packageSummary:p,packageVersion:g,processPid:f,processName:b,processExecutable:y,sshSignature:h,sshMethod:v,text:E,userDomain:x,userName:k,workingDirectory:S})=>r.a.createElement(r.a.Fragment,null,r.a.createElement(s.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none",wrap:!0},r.a.createElement(m,{contextId:e,eventId:n,hostName:t,isDraggable:a,userDomain:x,userName:k,workingDirectory:S}),r.a.createElement(l.c,{grow:!1,component:"span"},E),r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(d.a,{contextId:e,endgamePid:void 0,endgameProcessName:void 0,eventId:n,isDraggable:a,processPid:f,processName:b,processExecutable:y})),null!=o&&r.a.createElement(l.c,{grow:!1,component:"span"},te.W),r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:n,field:"event.outcome",isDraggable:a,queryValue:o,value:o,isAggregatable:!0,fieldType:"keyword"})),r.a.createElement(ae,{contextId:e,eventId:n,isDraggable:a,sshSignature:h,sshMethod:v}),r.a.createElement(ne,{contextId:e,eventId:n,isDraggable:a,packageName:c,packageSummary:p,packageVersion:g})),null!=i&&r.a.createElement(r.a.Fragment,null,r.a.createElement(s.EuiSpacer,{size:"xs"}),r.a.createElement(s.EuiFlexGroup,{justifyContent:"center",gutterSize:"none",wrap:!0},r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(ie.b,{iconType:"editorComment",color:"hollow",title:""},r.a.createElement(ee.a,{value:i}))))))));re.displayName="SystemGenericLine";const oe=r.a.memo((({contextId:e,data:t,isDraggable:n,text:i,timelineId:o})=>{const u=t._id,d=null!=t.message?t.message[0]:null,p=Object(a.get)("host.name[0]",t),m=Object(a.get)("user.domain[0]",t),g=Object(a.get)("user.name[0]",t),f=Object(a.get)("event.outcome[0]",t),b=Object(a.get)("system.audit.package.name[0]",t),y=Object(a.get)("system.audit.package.summary[0]",t),h=Object(a.get)("system.audit.package.version[0]",t),v=Object(a.get)("process.pid[0]",t),E=Object(a.get)("process.name[0]",t),x=Object(a.get)("process.executable[0]",t),k=Object(a.get)("system.auth.ssh.signature[0]",t),S=Object(a.get)("system.auth.ssh.method[0]",t),w=Object(a.get)("process.working_directory[0]",t);return r.a.createElement(l.b,null,r.a.createElement(re,{contextId:e,hostName:p,id:u,isDraggable:n,message:d,outcome:f,packageName:b,packageSummary:y,packageVersion:h,processExecutable:x,processPid:v,processName:E,sshMethod:S,sshSignature:k,text:i,userDomain:m,userName:g,workingDirectory:w}),r.a.createElement(s.EuiSpacer,{size:"s"}),r.a.createElement(c.a,{data:t,isDraggable:n,timelineId:o}))}));oe.displayName="SystemGenericDetails";var se=n(477);const le=r.a.memo((({contextId:e,endgameExitCode:t,eventId:n,isDraggable:a,processExitCode:i,text:o})=>Object(l.e)(i)&&Object(l.e)(t)?null:r.a.createElement(r.a.Fragment,null,!Object(l.e)(o)&&r.a.createElement(l.c,{"data-test-subj":"exit-code-draggable-text",grow:!1,component:"span"},o),!Object(l.e)(i)&&r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:n,field:"process.exit_code",isDraggable:a,value:`${i}`,fieldType:"number",isAggregatable:!0})),!Object(l.e)(t)&&r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:n,field:"endgame.exit_code",isDraggable:a,value:t,fieldType:"number",isAggregatable:!0})))));le.displayName="ExitCodeDraggable";var ce=n(260);const ue=r.a.memo((({contextId:e,endgameFileName:t,endgameFilePath:n,eventId:a,fileExtOriginalPath:i,fileName:o,filePath:s,isDraggable:c})=>{if(Object(l.e)(o)&&Object(l.e)(t)&&Object(l.e)(s)&&Object(l.e)(n))return null;const d=!Object(l.e)(s)||!Object(l.e)(n);return r.a.createElement(r.a.Fragment,null,Object(l.e)(o)?Object(l.e)(t)?null:r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:a,field:"endgame.file_name",isDraggable:c,value:t,iconType:"document",isAggregatable:!0,fieldType:"keyword"})):r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:a,field:"file.name",isDraggable:c,value:o,iconType:"document",isAggregatable:!0,fieldType:"keyword"})),d&&r.a.createElement(l.c,{"data-test-subj":"in",grow:!1,component:"span"},ce.d),Object(l.e)(s)?Object(l.e)(n)?null:r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:a,field:"endgame.file_path",isDraggable:c,value:n,iconType:"document",isAggregatable:!0,fieldType:"keyword"})):r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:a,field:"file.path",isDraggable:c,value:s,iconType:"document",isAggregatable:!0,fieldType:"keyword"})),!Object(l.e)(i)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.c,{grow:!1,component:"span"},ce.c),r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:a,field:"file.Ext.original.path",isDraggable:c,value:i,iconType:"document",isAggregatable:!0,fieldType:"keyword"}))))}));ue.displayName="FileDraggable";var de=n(33),pe=n.n(de);const me=pe()(s.EuiFlexGroup).withConfig({displayName:"HashFlexGroup",componentId:"sc-dv64zz-0"})(["margin:",";"],(({theme:e})=>e.eui.euiSizeXS)),ge=r.a.memo((({contextId:e,eventId:t,fileHashSha256:n,isDraggable:a})=>Object(l.e)(n)?null:r.a.createElement(me,{alignItems:"center",direction:"column",gutterSize:"none"},r.a.createElement(l.c,{grow:!1,component:"div"},r.a.createElement(u.c,{contextId:e,eventId:t,field:"file.hash.sha256",isDraggable:a,iconType:"number",value:n,isAggregatable:!0,fieldType:"keyword"})))));ge.displayName="FileHash";const fe=r.a.memo((({contextId:e,endgameParentProcessName:t,eventId:n,isDraggable:a,processParentName:i,processParentPid:o,processPpid:s,text:c})=>Object(l.e)(i)&&Object(l.e)(t)?null:r.a.createElement(r.a.Fragment,null,!Object(l.e)(c)&&r.a.createElement(l.c,{"data-test-subj":"parent-process-draggable-text",grow:!1,component:"span"},c),!Object(l.e)(i)&&r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:n,field:"process.parent.name",isDraggable:a,value:i,fieldType:"keyword",isAggregatable:!0})),!Object(l.e)(t)&&r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:n,field:"endgame.parent_process_name",isDraggable:a,value:t,fieldType:"keyword",isAggregatable:!0})),!Object(l.e)(o)&&r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:n,field:"process.parent.pid",isDraggable:a,queryValue:String(o),value:`(${String(o)})`,fieldType:"keyword",isAggregatable:!0})),!Object(l.e)(s)&&r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:n,field:"process.ppid",isDraggable:a,queryValue:String(s),value:`(${String(s)})`,fieldType:"keyword",isAggregatable:!0})))));fe.displayName="ParentProcessDraggable";const be=pe()(s.EuiFlexGroup).withConfig({displayName:"HashFlexGroup",componentId:"sc-1qc8g7c-0"})(["margin:",";"],(({theme:e})=>e.eui.euiSizeXS)),ye=r.a.memo((({contextId:e,eventId:t,isDraggable:n,processHashSha256:a})=>Object(l.e)(a)?null:r.a.createElement(be,{alignItems:"center",direction:"column",gutterSize:"none"},r.a.createElement(l.c,{grow:!1,component:"div"},r.a.createElement(u.c,{contextId:e,eventId:t,field:"process.hash.sha256",iconType:"number",isDraggable:n,value:a,fieldType:"keyword",isAggregatable:!0})))));ye.displayName="ProcessHash";const he=r.a.memo((({args:e,contextId:t,endgameExitCode:n,endgameFileName:a,endgameFilePath:i,endgameParentProcessName:o,endgamePid:c,endgameProcessName:p,eventAction:g,fileExtOriginalPath:f,fileHashSha256:b,fileName:y,filePath:h,hostName:v,id:E,isDraggable:x,message:k,outcome:S,packageName:w,processParentName:j,processParentPid:O,processExitCode:I,packageSummary:T,packageVersion:C,processExecutable:M,processHashSha256:N,processName:D,processPid:F,processPpid:A,processTitle:_,showMessage:R,skipRedundantFileDetails:P=!1,skipRedundantProcessDetails:L=!1,sshSignature:q,sshMethod:B,text:z,userDomain:$,userName:V,workingDirectory:U})=>r.a.createElement(r.a.Fragment,null,r.a.createElement(s.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none",wrap:!0},r.a.createElement(m,{eventId:E,contextId:t,isDraggable:x,userDomain:$,userName:V,workingDirectory:U,hostName:v}),r.a.createElement(l.c,{grow:!1,component:"span"},z),!P&&r.a.createElement(ue,{contextId:t,endgameFileName:a,endgameFilePath:i,eventId:E,fileExtOriginalPath:f,fileName:y,filePath:h,isDraggable:x}),Object(l.g)(g)&&r.a.createElement(l.c,{"data-test-subj":"via",grow:!1,component:"span"},te.L),r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(d.b,{contextId:t,endgamePid:c,endgameProcessName:p,eventId:E,isDraggable:x,processPid:F,processName:D,processExecutable:M})),r.a.createElement(se.a,{args:e,contextId:t,eventId:E,processTitle:_,isDraggable:x}),r.a.createElement(le,{contextId:t,endgameExitCode:n,eventId:E,isDraggable:x,processExitCode:I,text:te.V}),!Object(l.f)(g)&&r.a.createElement(fe,{contextId:t,endgameParentProcessName:o,eventId:E,isDraggable:x,processParentName:j,processParentPid:O,processPpid:A,text:te.M}),null!=S&&r.a.createElement(l.c,{grow:!1,component:"span"},te.W),r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:t,eventId:E,field:"event.outcome",isDraggable:x,queryValue:S,value:S,isAggregatable:!0,fieldType:"keyword"})),r.a.createElement(ae,{contextId:t,eventId:E,isDraggable:x,sshSignature:q,sshMethod:B}),r.a.createElement(ne,{contextId:t,eventId:E,isDraggable:x,packageName:w,packageSummary:T,packageVersion:C})),!P&&r.a.createElement(ge,{contextId:t,eventId:E,fileHashSha256:b,isDraggable:x}),!L&&r.a.createElement(ye,{contextId:t,eventId:E,isDraggable:x,processHashSha256:N}),null!=k&&R&&r.a.createElement(r.a.Fragment,null,r.a.createElement(s.EuiSpacer,{size:"xs"}),r.a.createElement(s.EuiFlexGroup,{justifyContent:"center",gutterSize:"none",wrap:!0},r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(ie.b,{iconType:"editorComment",color:"hollow",title:""},r.a.createElement(ee.a,{value:k}))))))));he.displayName="SystemGenericFileLine";const ve=r.a.memo((({contextId:e,data:t,isDraggable:n,showMessage:i=!0,skipRedundantFileDetails:o=!1,skipRedundantProcessDetails:u=!1,text:d,timelineId:p})=>{const m=t._id,g=null!=t.message?t.message[0]:null,f=Object(a.get)("host.name[0]",t),b=Object(a.get)("endgame.exit_code[0]",t),y=Object(a.get)("endgame.file_name[0]",t),h=Object(a.get)("endgame.file_path[0]",t),v=Object(a.get)("endgame.parent_process_name[0]",t),E=Object(a.get)("endgame.pid[0]",t),x=Object(a.get)("endgame.process_name[0]",t),k=Object(a.get)("event.action[0]",t),S=Object(a.get)("file.Ext.original.path[0]",t),w=Object(a.get)("file.hash.sha256[0]",t),j=Object(a.get)("file.name[0]",t),O=Object(a.get)("file.path[0]",t),I=Object(a.get)("user.domain[0]",t),T=Object(a.get)("user.name[0]",t),C=Object(a.get)("event.outcome[0]",t),M=Object(a.get)("system.audit.package.name[0]",t),N=Object(a.get)("system.audit.package.summary[0]",t),D=Object(a.get)("system.audit.package.version[0]",t),F=Object(a.get)("process.exit_code[0]",t),A=Object(a.get)("process.parent.name[0]",t),_=Object(a.get)("process.parent.pid[0]",t),R=Object(a.get)("process.hash.sha256[0]",t),P=Object(a.get)("process.pid[0]",t),L=Object(a.get)("process.ppid[0]",t),q=Object(a.get)("process.name[0]",t),B=Object(a.get)("system.auth.ssh.signature[0]",t),z=Object(a.get)("system.auth.ssh.method[0]",t),$=Object(a.get)("process.executable[0]",t),V=Object(a.get)("process.title[0]",t),U=Object(a.get)("process.working_directory[0]",t),H=Object(a.get)("process.args",t);return r.a.createElement(l.b,null,r.a.createElement(he,{id:m,contextId:e,text:d,hostName:f,endgameExitCode:b,endgameFileName:y,endgameFilePath:h,endgameParentProcessName:v,endgamePid:E,endgameProcessName:x,eventAction:k,fileExtOriginalPath:S,fileHashSha256:w,fileName:j,filePath:O,userDomain:I,userName:T,message:g,processExitCode:F,processParentName:A,processParentPid:_,processTitle:V,workingDirectory:U,args:H,packageName:M,packageSummary:N,packageVersion:D,processHashSha256:R,processName:q,processPid:P,processPpid:L,processExecutable:$,showMessage:i,skipRedundantFileDetails:o,skipRedundantProcessDetails:u,sshSignature:B,sshMethod:z,outcome:C,isDraggable:n}),r.a.createElement(s.EuiSpacer,{size:"s"}),r.a.createElement(c.a,{data:t,isDraggable:n,timelineId:p}))}));ve.displayName="SystemGenericFileDetails";const Ee=({actionName:e,text:t})=>({id:o.d.system,isInstance:t=>{const n=Object(a.get)("event.module[0]",t),i=Object(a.get)("event.action[0]",t);return null!=n&&"system"===n.toLowerCase()&&null!=i&&i.toLowerCase()===e},renderRow:({data:n,isDraggable:a,scopeId:i})=>r.a.createElement(Z.a,null,r.a.createElement(oe,{contextId:`${e}-${i}`,data:n,isDraggable:a,text:t,timelineId:i}))}),xe=({actionName:e,text:t})=>({id:o.d.system_file,isInstance:t=>{const n=Object(a.get)("event.action[0]",t),i=Object(a.get)("event.category[0]",t),r=Object(a.get)("event.dataset[0]",t);return("process"===(null==i?void 0:i.toLowerCase())||"endpoint.events.process"===(null==r?void 0:r.toLowerCase()))&&(null==n?void 0:n.toLowerCase())===e},renderRow:({data:n,isDraggable:a,scopeId:i})=>r.a.createElement(Z.a,null,r.a.createElement(ve,{data:n,contextId:`endgame-process-${e}-${i}`,isDraggable:a,showMessage:!1,text:t,timelineId:i}))}),ke=({actionName:e,text:t})=>({id:o.d.system_fim,isInstance:t=>{const n=Object(a.get)("event.action[0]",t),i=Object(a.get)("event.category[0]",t),r=Object(a.get)("event.dataset[0]",t);return Object(l.d)({eventCategory:i,eventDataset:r})&&(null==n?void 0:n.toLowerCase())===e},renderRow:({data:n,isDraggable:a,scopeId:i})=>r.a.createElement(Z.a,null,r.a.createElement(ve,{data:n,contextId:`fim-${e}-${i}`,isDraggable:a,showMessage:!1,text:t,timelineId:i}))}),Se=({eventAction:e,eventCategory:t,eventType:n,skipRedundantFileDetails:i=!1,skipRedundantProcessDetails:s=!1,text:l})=>({id:o.d.alerts,isInstance:i=>{var r,o,s;const l=Object(a.get)("event.action",i),c=Object(a.get)("event.category",i),u=Object(a.get)("event.dataset[0]",i),d=Object(a.get)("event.type",i),p=null!==(r=null==l?void 0:l.includes(e))&&void 0!==r&&r,m=null!==(o=null==c?void 0:c.includes(t))&&void 0!==o&&o,g=null!==(s=null==d?void 0:d.includes(n))&&void 0!==s&&s;return"endpoint.alerts"===(null==u?void 0:u.toLowerCase())&&g&&m&&p},renderRow:({data:a,isDraggable:o,scopeId:c})=>r.a.createElement(Z.a,null,r.a.createElement(ve,{contextId:`endpoint-alerts-row-renderer-${e}-${t}-${n}-${c}`,data:a,isDraggable:o,showMessage:!1,skipRedundantFileDetails:i,skipRedundantProcessDetails:s,text:l,timelineId:c}))}),we=({actionName:e,text:t})=>({id:o.d.library,isInstance:t=>{const n=Object(a.get)("event.action[0]",t),i=Object(a.get)("event.dataset[0]",t);return"endpoint.events.library"===(null==i?void 0:i.toLowerCase())&&(null==n?void 0:n.toLowerCase())===e},renderRow:({data:n,isDraggable:a,scopeId:i})=>r.a.createElement(Z.a,null,r.a.createElement(ve,{contextId:`library-row-renderer-${e}-${i}`,data:n,isDraggable:a,showMessage:!1,text:t,timelineId:i}))}),je=({actionName:e,text:t})=>({id:o.d.system_file,isInstance:t=>{const n=Object(a.get)("event.module[0]",t),i=Object(a.get)("event.action[0]",t);return null!=n&&"system"===n.toLowerCase()&&null!=i&&i.toLowerCase()===e},renderRow:({data:n,isDraggable:a,scopeId:i})=>r.a.createElement(Z.a,null,r.a.createElement(ve,{contextId:`${e}-${i}`,data:n,isDraggable:a,text:t,timelineId:i}))}),Oe=({actionName:e,text:t})=>({id:o.d.system_socket,isInstance:t=>{const n=Object(a.get)("event.action[0]",t);return null!=n&&n.toLowerCase()===e},renderRow:({data:n,isDraggable:a,scopeId:i})=>r.a.createElement(Z.a,null,r.a.createElement(ve,{contextId:`socket-${e}-${i}`,data:n,isDraggable:a,text:t,timelineId:i}))}),Ie=({actionName:e})=>({id:o.d.system_security_event,isInstance:t=>{const n=Object(a.get)("event.category[0]",t),i=Object(a.get)("event.action[0]",t),r=Object(a.get)("event.dataset[0]",t);return("authentication"===(null==n?void 0:n.toLowerCase())||"endpoint.events.security"===(null==r?void 0:r.toLowerCase()))&&(null==i?void 0:i.toLowerCase())===e},renderRow:({data:t,isDraggable:n,scopeId:a})=>r.a.createElement(Z.a,null,r.a.createElement(G,{contextId:`authentication-${e}-${a}`,data:t,isDraggable:n,timelineId:a}))}),Te=()=>({id:o.d.system_dns,isInstance:e=>{const t=Object(a.get)("dns.question.type[0]",e),n=Object(a.get)("dns.question.name[0]",e);return!Object(l.e)(t)&&!Object(l.e)(n)},renderRow:({data:e,isDraggable:t,scopeId:n})=>r.a.createElement(Z.a,null,r.a.createElement(x,{contextId:`dns-request-${n}`,data:e,isDraggable:t,timelineId:n}))}),Ce=({actionName:e,text:t})=>({id:o.d.registry,isInstance:t=>{const n=Object(a.get)("event.action[0]",t),i=Object(a.get)("event.dataset[0]",t);return"endpoint.events.registry"===(null==i?void 0:i.toLowerCase())&&(null==n?void 0:n.toLowerCase())===e},renderRow:({data:e,isDraggable:n,scopeId:a})=>r.a.createElement(Z.a,null,r.a.createElement(X,{contextId:`registry-event-${a}`,data:e,isDraggable:n,text:t}))}),Me=Ee({actionName:"user_login",text:te.c}),Ne=je({actionName:"process_started",text:te.A}),De=xe({actionName:"creation_event",text:te.A}),Fe=xe({actionName:"start",text:te.A}),Ae=Ce({actionName:"modification",text:te.u}),_e=je({actionName:"process_stopped",text:te.B}),Re=xe({actionName:"termination_event",text:te.H}),Pe=xe({actionName:"end",text:te.H}),Le=ke({actionName:"file_create_event",text:te.e}),qe=ke({actionName:"creation",text:te.e}),Be=ke({actionName:"created",text:te.e}),ze=ke({actionName:"file_delete_event",text:te.f}),$e=ke({actionName:"deletion",text:te.f}),Ve=ke({actionName:"modification",text:te.t}),Ue=ke({actionName:"overwrite",text:te.v}),He=ke({actionName:"rename",text:te.E}),Ge=ke({actionName:"deleted",text:te.f}),Qe=je({actionName:"existing_process",text:te.k}),We=[{eventAction:"creation",eventCategory:"file",eventType:"denied",skipRedundantProcessDetails:!0,text:te.R},{eventAction:"creation",eventCategory:"file",eventType:"allowed",skipRedundantProcessDetails:!0,text:te.N},{eventAction:"files-encrypted",eventCategory:"file",eventType:"denied",skipRedundantFileDetails:!0,text:te.D},{eventAction:"files-encrypted",eventCategory:"file",eventType:"allowed",skipRedundantFileDetails:!0,text:te.C},{eventAction:"modification",eventCategory:"file",eventType:"denied",skipRedundantProcessDetails:!0,text:te.T},{eventAction:"modification",eventCategory:"file",eventType:"allowed",skipRedundantProcessDetails:!0,text:te.P},{eventAction:"rename",eventCategory:"file",eventType:"denied",skipRedundantProcessDetails:!0,text:te.U},{eventAction:"rename",eventCategory:"file",eventType:"allowed",skipRedundantProcessDetails:!0,text:te.Q},{eventAction:"execution",eventCategory:"process",eventType:"denied",skipRedundantFileDetails:!0,text:te.S},{eventAction:"execution",eventCategory:"process",eventType:"allowed",skipRedundantFileDetails:!0,text:te.O}].map((e=>Se(e))),Ke=we({actionName:"load",text:te.q}),Ye=Oe({actionName:"socket_opened",text:te.G}),Je=Oe({actionName:"socket_closed",text:te.F}),Xe=Oe({actionName:"ipv4_connection_accept_event",text:te.b}),Ze=Oe({actionName:"connection_accepted",text:te.b}),et=Oe({actionName:"http_request",text:te.s}),tt=xe({actionName:"exec",text:te.i}),nt=xe({actionName:"fork",text:te.n}),at=Oe({actionName:"ipv6_connection_accept_event",text:te.b}),it=Oe({actionName:"ipv4_disconnect_received_event",text:te.g}),rt=Oe({actionName:"disconnect_received",text:te.g}),ot=Oe({actionName:"ipv6_disconnect_received_event",text:te.g}),st=Ie({actionName:"admin_logon"}),lt=Ie({actionName:"explicit_user_logon"}),ct=Ie({actionName:"user_logoff"}),ut=Ie({actionName:"user_logon"}),dt=Ie({actionName:"log_on"}),pt=Te(),mt=Ee({actionName:"existing_user",text:te.m}),gt=je({actionName:"existing_socket",text:te.l}),ft=Ee({actionName:"existing_package",text:te.j}),bt=je({actionName:"invalid",text:te.p}),yt=Ee({actionName:"user_changed",text:te.J}),ht=Ee({actionName:"host",text:te.o}),vt=Ee({actionName:"user_added",text:te.I}),Et=Ee({actionName:"user_logout",text:te.r}),xt=Ie({actionName:"log_off"}),kt=je({actionName:"process_error",text:te.z}),St=Ee({actionName:"error:",text:te.h}),wt=Ee({actionName:"error",text:te.h}),jt=Ee({actionName:"package_installed",text:te.w}),Ot=Ee({actionName:"boot",text:te.d}),It=[pt,st,lt,Le,qe,ze,$e,Ue,He,...We,Ke,Ve,Ae,Xe,Ze,et,tt,nt,at,it,rt,ot,De,Fe,Re,Pe,ct,ut,dt,Be,Ge,Ee({actionName:"accepted",text:te.a}),Ot,wt,St,ft,Qe,gt,mt,ht,bt,Me,Et,xt,jt,Ee({actionName:"package_updated",text:te.y}),Ee({actionName:"package_removed",text:te.x}),kt,Ne,_e,Je,Ye,vt,yt,Ee({actionName:"user_removed",text:te.K})]},function(e,t,n){"use strict";n.d(t,"a",(function(){return oe}));var a=n(4),i=n.n(a),r=n(33),o=n.n(r),s=n(34),l=n(32),c=n(110),u=n(93),d=n(0);const p=d.i18n.translate("xpack.securitySolution.ruleExceptions.addException.cancel",{defaultMessage:"Cancel"}),m=d.i18n.translate("xpack.securitySolution.ruleExceptions.addException.createRuleExceptionLabel",{defaultMessage:"Add rule exception"}),g=d.i18n.translate("xpack.securitySolution.ruleExceptions.addException.addEndpointException",{defaultMessage:"Add Endpoint Exception"}),f=d.i18n.translate("xpack.securitySolution.ruleExceptions.addException.submitError.title",{defaultMessage:"An error occured submitting exception"}),b=d.i18n.translate("xpack.securitySolution.ruleExceptions.addException.submitError.dismissButton",{defaultMessage:"Dismiss"}),y=d.i18n.translate("xpack.securitySolution.ruleExceptions.addException.submitError.message",{defaultMessage:"View toast for error details."}),h=d.i18n.translate("xpack.securitySolution.ruleExceptions.addException.success",{defaultMessage:"Rule exception added to shared exception list"}),v=d.i18n.translate("xpack.securitySolution.ruleExceptions.addExceptionFlyout.addRuleExceptionToastSuccessTitle",{defaultMessage:"Rule exception added"});var E=n(517),x=n(190);const k={initialItems:[],exceptionItems:[],exceptionItemMeta:{name:""},newComment:"",itemConditionValidationErrorExists:!1,closeSingleAlert:!1,bulkCloseAlerts:!1,disableBulkClose:!1,bulkCloseIndex:void 0,selectedOs:void 0,exceptionListsToAddTo:[],addExceptionToRadioSelection:"add_to_rule",selectedRulesToAddTo:[],listType:u.b.RULE_DEFAULT,errorSubmitting:null};var S=n(717),w=n(718),j=n(656),O=n(711);const I=d.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addExceptionToRuleOrList.addToListsLabel",{defaultMessage:"Add to rule or lists"});var T=n(35),C=n(704);const M=({possibleRules:e,isSingleRule:t,isBulkAction:n,selectedRadioOption:r,onRuleSelectionChange:o,onRadioChange:s})=>{const c=Object(a.useMemo)((()=>n&&null!=e?{id:"add_to_rules",label:i.a.createElement(l.EuiText,{"data-test-subj":"addToRulesRadioOption"},i.a.createElement(T.FormattedMessage,{defaultMessage:"Add to [{numRules}] selected rules: {ruleNames}",id:"xpack.securitySolution.exceptions.common.addToRulesOptionLabel",values:{numRules:e.length,ruleNames:i.a.createElement("span",{style:{fontWeight:"bold"}},e.map((({name:e})=>e)).join(","))}})),checked:"add_to_rules"===r,"data-test-subj":"addToRulesOptionsRadio",onChange:()=>{s("add_to_rules"),o(e)}}:t&&null!=e?{id:"add_to_rule",label:i.a.createElement(l.EuiText,{"data-test-subj":"addToRuleRadioOption"},i.a.createElement(T.FormattedMessage,{defaultMessage:"Add to this rule: {ruleName}",id:"xpack.securitySolution.exceptions.common.addToRuleOptionLabel",values:{ruleName:i.a.createElement("span",{style:{fontWeight:"bold"}},e[0].name)}})),checked:"add_to_rule"===r,"data-test-subj":"addToRuleOptionsRadio",onChange:()=>{s("add_to_rule"),o(e)}}:{id:"select_rules_to_add_to",label:i.a.createElement(l.EuiText,{"data-test-subj":"selectRulesToAddToRadioOption"},i.a.createElement(T.FormattedMessage,{defaultMessage:"Add to rules",id:"xpack.securitySolution.exceptions.common.selectRulesOptionLabel"})),checked:"select_rules_to_add_to"===r,"data-test-subj":"selectRulesToAddToOptionRadio",onChange:()=>s("select_rules_to_add_to")}),[n,e,t,r,s,o]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(l.EuiRadio,c),"select_rules_to_add_to"===r&&i.a.createElement(C.a,{onRuleSelectionChange:o,initiallySelectedRules:[]}))},N=i.a.memo(M);N.displayName="ExceptionsAddToRulesOptions";const D=d.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToListsOptions.addToListsOptionLabel",{defaultMessage:"Add to shared exception lists"}),F=d.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToListsOptions.gotToSharedExceptions",{defaultMessage:"Manage shared exception lists"}),A=d.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToListsOptions.addToListsTooltip",{defaultMessage:"Shared exception list is a group of exceptions. Select this option if youâ€™d like to add this exception to shared exception lists."}),_=e=>d.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToListsOptions.addToListsTooltipTitle",{values:{rulesCount:e},defaultMessage:"Shared exception list is a group of exceptions shared across rules. {rulesCount, plural, =1 {This rule currently has no shared} other {These rules currently have no commonly shared}} exception lists attached. To create one, visit the Shared Exception Lists page."});var R=n(510);const P=d.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToListsTableSelection.addToListsDescription",{defaultMessage:"After you create the exception, it is added to the exception lists you select."}),L=(d.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToListsTableSelection.viewListDetailActionLabel",{defaultMessage:"View list detail"}),d.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToListsTableSelection.referencesFetchError",{defaultMessage:"Unable to load shared exception lists"}));var q=n(479);const B=Object(a.memo)((({list:e,linkedList:t,onListLinkChange:n,dataTestSubj:r})=>{const o=Object(a.useMemo)((()=>Boolean(t.find((t=>t.id===e.id)))),[t,e.id]),s=Object(a.useCallback)((({target:{checked:a}})=>{const i=a?[...t,e]:null==t?void 0:t.filter((t=>t.id!==e.id));"function"==typeof n&&n(i)}),[t,n,e]);return i.a.createElement(l.EuiFlexItem,{grow:!1},i.a.createElement(l.EuiSwitch,{"data-test-subj":r,onChange:s,label:"",checked:o}))}));B.displayName="LinkListSwitch";var z=n(261);const $=({showAllSharedLists:e,sharedExceptionLists:t,onListSelectionChange:n})=>{const{error:r,isLoading:o,pagination:s,lists:c,listTableColumnsWithLinkSwitch:d,onTableChange:p,addToSelectedListDescription:m}=(({showAllSharedLists:e,sharedExceptionLists:t,onListSelectionChange:n})=>{const[r,o]=Object(a.useState)([]),[s,l]=Object(a.useState)(!1),c=Object(a.useMemo)((()=>e?[]:t),[e,t]),[d,p]=Object(a.useState)([]),[m,g]=Object(a.useState)({pageIndex:0,initialPageSize:5,showPerPageOptions:!1}),[f,b]=Object(a.useState)(void 0),y=Object(a.useCallback)((async()=>{try{return l(!0),Object(R.c)(c.length?c:[{namespace_type:"single"}])}catch(e){b(L)}}),[c]),h=Object(a.useCallback)((async()=>{const e=await y();if(!e)return l(!1);const t=[];for(const n of Object.values(e))n.type===u.b.DETECTION&&t.push(n);o(t),l(!1)}),[y]);Object(a.useEffect)((()=>{h()}),[c,y,h]),Object(a.useEffect)((()=>{n(d.map((({referenced_rules:e,namespace_type:t,os_types:n,tags:a,...i})=>({...i,namespace_type:null!=t?t:"single",os_types:null!=n?n:[],tags:null!=a?a:[]}))))}),[d,n]);const v=Object(a.useMemo)((()=>[{field:"link",name:q.a,align:"left","data-test-subj":"ruleActionLinkRuleSwitch",render:(e,t)=>i.a.createElement(B,{dataTestSubj:"addToSharedListSwitch",list:t,linkedList:d,onListLinkChange:p})},...Object(z.d)()]),[d]),E=Object(a.useCallback)((({page:{index:e}})=>g({...m,pageIndex:e})),[m]);return{error:f,isLoading:s,pagination:m,lists:r,listTableColumnsWithLinkSwitch:v,addToSelectedListDescription:P,onTableChange:E}})({showAllSharedLists:e,sharedExceptionLists:t,onListSelectionChange:n});return i.a.createElement(l.EuiPanel,{color:"subdued",borderRadius:"none",hasShadow:!1},i.a.createElement(i.a.Fragment,null,i.a.createElement(l.EuiText,{size:"s"},m),i.a.createElement(l.EuiSpacer,{size:"s"}),i.a.createElement(l.EuiSpacer,{size:"s"}),i.a.createElement(l.EuiInMemoryTable,{sorting:!0,tableLayout:"auto",tableCaption:"Table of exception lists","data-test-subj":"addExceptionToSharedListsTable",error:r,items:c,loading:o,message:o?i.a.createElement(l.EuiLoadingContent,{lines:4,"data-test-subj":"exceptionItemViewerEmptyPrompts-loading"}):void 0,columns:d,pagination:s,onTableChange:p})))},V=i.a.memo($);V.displayName="ExceptionsAddToListsTable";var U=n(77);const H=({rulesCount:e,selectedRadioOption:t,sharedLists:n,onListsSelectionChange:r,onRadioChange:o})=>{const{navigateToApp:s}=Object(U.k)().services.application,[c,u]=Object(a.useState)(!1);return i.a.createElement(i.a.Fragment,null,i.a.createElement(l.EuiRadio,{id:"add_to_lists",label:i.a.createElement(l.EuiFlexGroup,{alignItems:"flexStart",gutterSize:"none",responsive:!1,"data-test-subj":"addToListsRadioOptionLabel"},i.a.createElement(l.EuiFlexItem,{grow:!1},i.a.createElement(l.EuiText,null,D)),i.a.createElement(l.EuiFlexItem,{grow:!1,"data-test-subj":"addToListsOption"},i.a.createElement(l.EuiPopover,{button:i.a.createElement(l.EuiButtonIcon,{iconType:"iInCircle",onClick:()=>u(!c)}),isOpen:c,closePopover:()=>u(!1),anchorPosition:"upCenter"},i.a.createElement("div",{style:{width:"300px"}},i.a.createElement(l.EuiText,{size:"s"},0===n.length?_(e):A)),i.a.createElement(l.EuiPopoverFooter,null,i.a.createElement(l.EuiButtonEmpty,{size:"s",iconType:"popout",iconSide:"right",onClick:()=>s("security",{openInNewTab:!0,path:"/exceptions"})},F))))),checked:"add_to_lists"===t,disabled:0===n.length&&e>0,onChange:()=>o("add_to_lists"),"data-test-subj":"addToListsRadioOption"}),"add_to_lists"===t&&(n.length>0||0===e)&&i.a.createElement(V,{showAllSharedLists:0===e,sharedExceptionLists:n,onListSelectionChange:r,"data-test-subj":"exceptionsAddToListTable"}))},G=i.a.memo(H);G.displayName="ExceptionsAddToListsOptions";const Q=o()(l.EuiTitle).withConfig({displayName:"SectionHeader",componentId:"sc-1kilk4s-0"})(["",""],(()=>Object(r.css)(["font-weight:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold)))),W=({rules:e,isBulkAction:t,selectedRadioOption:n,onListSelectionChange:r,onRuleSelectionChange:o,onRadioChange:s})=>{const c=Object(a.useMemo)((()=>null!=e&&1===e.length),[e]),d=Object(a.useMemo)((()=>{var t,n,a;if(null==e)return[];if(1===e.length)return null!==(t=null===(n=e[0].exceptions_list)||void 0===n?void 0:n.filter((e=>e.type===u.b.DETECTION)))&&void 0!==t?t:[];const i=null!==(a=null==e?void 0:e.map((e=>null!=e.exceptions_list?e.exceptions_list:[])))&&void 0!==a?a:[];i.sort(((e,t)=>e.length-t.length));const r=i.shift();return null!=r&&r.length?r.filter((e=>i.every((t=>t.some((({id:t})=>e.id===t)))))).filter((e=>e.type===u.b.DETECTION)):[]}),[e]),p=Object(a.useMemo)((()=>null!=e?e.length:0),[e]);return i.a.createElement(l.EuiPanel,{paddingSize:"none",hasShadow:!1,"data-test-subj":"exceptionItemAddToRuleOrListSection"},i.a.createElement(Q,{size:"xs"},i.a.createElement("h3",null,I)),i.a.createElement(l.EuiSpacer,{size:"s"}),i.a.createElement(N,{possibleRules:e,isSingleRule:c,isBulkAction:t,selectedRadioOption:n,onRuleSelectionChange:o,onRadioChange:s}),i.a.createElement(G,{rulesCount:p,selectedRadioOption:n,sharedLists:d,onListsSelectionChange:r,onRadioChange:s}))},K=i.a.memo(W);K.displayName="ExceptionsAddToRulesOrLists";var Y=n(84),J=n(658),X=n(138);var Z=n(712);const ee=["query","machine_learning","saved_query","threat_match"];var te=n(338);const ne=o()(l.EuiTitle).withConfig({displayName:"SectionHeader",componentId:"sc-sl27gk-0"})(["",""],(()=>Object(r.css)(["font-weight:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold)))),ae=o()(l.EuiFlyoutBody).withConfig({displayName:"FlyoutBodySection",componentId:"sc-sl27gk-1"})(["",""],(()=>Object(r.css)(["&.builder-section{overflow-y:scroll;}"]))),ie=o()(l.EuiFlyoutHeader).withConfig({displayName:"FlyoutHeader",componentId:"sc-sl27gk-2"})(["",""],(({theme:e})=>Object(r.css)(["border-bottom:1px solid ",";"],e.eui.euiColorLightShade))),re=o()(l.EuiFlexGroup).withConfig({displayName:"FlyoutFooterGroup",componentId:"sc-sl27gk-3"})(["",""],(({theme:e})=>Object(r.css)(["padding:",";"],e.eui.euiSizeS))),oe=Object(a.memo)((function({rules:e,isBulkAction:t,isEndpointItem:n,alertData:r,showAlertCloseOptions:o,isAlertDataLoading:I,alertStatus:T,sharedListToAddTo:C,onCancel:M,onConfirm:N,isNonTimeline:D=!1}){const{isLoading:F,indexPatterns:A}=Object(j.a)(e),[_,R]=(()=>{const{addSuccess:e,addError:t,addWarning:n}=Object(Y.a)(),[i,r]=(()=>{const[e,t]=Object(a.useState)(!1),n=Object(a.useRef)(null);return Object(a.useEffect)((()=>{const e=new AbortController;return n.current=async(n,a)=>{t(!0);const i=await Promise.all(a.map((async t=>Object(X.a)({items:n,ruleId:t.id,signal:e.signal}))));return t(!1),i.flatMap((e=>e))},()=>{t(!1),e.abort()}}),[]),[e,n.current]})(),[o,s]=Object(J.a)(),[l,c]=Object(a.useState)(!1),p=Object(a.useRef)(null),m=Object(a.useCallback)((e=>e.every((e=>u.i.is(e)))),[]),g=Object(a.useCallback)((e=>e.every((e=>u.n.is(e)||u.h.is(e)))),[]);return Object(a.useEffect)((()=>{const n=new AbortController;return p.current=async({itemsToAdd:n,listType:a,selectedRulesToAddTo:i,addToRules:o,addToSharedLists:l,sharedLists:p})=>{try{let t=[];if(c(!0),o&&null!=r&&a!==u.b.ENDPOINT&&m(n)){t=await r(n,i);const a=i.map((({name:e})=>e)).join(", ");e({title:v,text:(y=a,d.i18n.translate("xpack.securitySolution.ruleExceptions.addExceptionFlyout.addRuleExceptionToastSuccessText",{values:{ruleName:y},defaultMessage:"Exception has been added to rules - {ruleName}."}))})}else if((a===u.b.ENDPOINT||l)&&null!=s&&g(n)){t=await s(n);const a=p.map((({name:e})=>e));e({title:h,text:(b=a.join(","),d.i18n.translate("xpack.securitySolution.ruleExceptions.addExceptionFlyout.closeAlerts.successDetails",{values:{listNames:b},defaultMessage:"Rule exception has been added to shared lists: {listNames}."}))})}return c(!1),t}catch(e){throw c(!1),t(e,{title:f}),e}var b,y},()=>{n.abort()}}),[e,t,n,r,s,m,g]),[l||o||i,p.current]})(),[P,L]=Object(Z.a)(),q=Object(te.b)(),B=Object(a.useMemo)((()=>null==e||1!==e.length||ee.includes(e[0].type)),[e]),$=Object(a.useMemo)((()=>n?u.b.ENDPOINT:C?u.b.DETECTION:u.b.RULE_DEFAULT),[n,C]),[{exceptionItemMeta:{name:V},listType:U,selectedOs:H,initialItems:G,exceptionItems:Q,disableBulkClose:W,bulkCloseAlerts:oe,closeSingleAlert:se,bulkCloseIndex:le,addExceptionToRadioSelection:ce,selectedRulesToAddTo:ue,exceptionListsToAddTo:de,newComment:pe,itemConditionValidationErrorExists:me,errorSubmitting:ge},fe]=Object(a.useReducer)(((e,t)=>{switch(t.type){case"setExceptionItemMeta":{const{value:n}=t;return{...e,exceptionItemMeta:{...e.exceptionItemMeta,[n[0]]:n[1]}}}case"setInitialExceptionItems":{const{items:n}=t;return{...e,initialItems:n}}case"setExceptionItems":{const{items:n}=t;return{...e,exceptionItems:n}}case"setConditionValidationErrorExists":{const{errorExists:n}=t;return{...e,itemConditionValidationErrorExists:n}}case"setComment":{const{comment:n}=t;return{...e,newComment:n}}case"setCloseSingleAlert":{const{close:n}=t;return{...e,closeSingleAlert:n}}case"setBulkCloseAlerts":{const{bulkClose:n}=t;return{...e,bulkCloseAlerts:n}}case"setBulkCloseIndex":{const{bulkCloseIndex:n}=t;return{...e,bulkCloseIndex:n}}case"setSelectedOsOptions":{const{selectedOs:n}=t;return{...e,selectedOs:n}}case"setAddExceptionToLists":{const{listsToAddTo:n}=t;return{...e,exceptionListsToAddTo:n}}case"setListOrRuleRadioOption":{const{option:n}=t;return{...e,addExceptionToRadioSelection:n,listType:"add_to_lists"===n?u.b.DETECTION:u.b.RULE_DEFAULT,selectedRulesToAddTo:"add_to_lists"===n?[]:e.selectedRulesToAddTo}}case"setSelectedRulesToAddTo":{const{rules:n}=t;return{...e,selectedRulesToAddTo:n}}case"setListType":{const{listType:n}=t;return{...e,listType:n}}case"setDisableBulkCloseAlerts":{const{disableBulkCloseAlerts:n}=t;return{...e,disableBulkClose:n}}case"setErrorSubmitting":{const{err:n}=t;return{...e,errorSubmitting:n}}default:return e}}),{...k,addExceptionToRadioSelection:t?"add_to_rules":null!=e&&1===e.length?"add_to_rule":"select_rules_to_add_to",listType:$,selectedRulesToAddTo:null!=e?e:[]}),be=Object(a.useMemo)((()=>null!=r),[r]),ye=Object(a.useCallback)((e=>{fe({type:"setInitialExceptionItems",items:e})}),[fe]),he=Object(a.useCallback)((e=>{fe({type:"setExceptionItems",items:e})}),[fe]),ve=Object(a.useCallback)((e=>{fe({type:"setListOrRuleRadioOption",option:e})}),[fe]),Ee=Object(a.useCallback)((e=>{fe({type:"setSelectedRulesToAddTo",rules:e})}),[fe]),xe=Object(a.useCallback)((e=>{fe({type:"setAddExceptionToLists",listsToAddTo:e})}),[fe]),ke=Object(a.useCallback)((e=>{fe({type:"setExceptionItemMeta",value:e})}),[fe]),Se=Object(a.useCallback)((e=>{fe({type:"setConditionValidationErrorExists",errorExists:e})}),[fe]),we=Object(a.useCallback)((e=>{fe({type:"setSelectedOsOptions",selectedOs:e})}),[fe]),je=Object(a.useCallback)((e=>{fe({type:"setComment",comment:e})}),[fe]),Oe=Object(a.useCallback)((e=>{fe({type:"setBulkCloseIndex",bulkCloseIndex:e})}),[fe]),Ie=Object(a.useCallback)((e=>{fe({type:"setCloseSingleAlert",close:e})}),[fe]),Te=Object(a.useCallback)((e=>{fe({type:"setBulkCloseAlerts",bulkClose:e})}),[fe]),Ce=Object(a.useCallback)((e=>{fe({type:"setDisableBulkCloseAlerts",disableBulkCloseAlerts:e})}),[fe]),Me=Object(a.useCallback)((e=>{fe({type:"setErrorSubmitting",err:e})}),[fe]);Object(a.useEffect)((()=>{U===u.b.ENDPOINT&&null!=r&&ye(Object(x.b)(c.j,V,r))}),[U,V,r,ye]);const Ne=Object(a.useMemo)((()=>be?Object(x.m)(r):H?[...H]:[]),[be,r,H]),De=Object(a.useCallback)((async()=>{if(null!=R)try{const t=["add_to_rule","add_to_rules","select_rules_to_add_to"].includes(ce),n=!(null==C||!C.length)||"add_to_lists"===ce&&!Object(s.isEmpty)(de),a=null!=C&&C.length?C:de,i=Object(z.b)({itemName:V,commentToAdd:pe,addToRules:t,addToSharedLists:n,sharedLists:a,listType:U,selectedOs:Ne,items:Q}),o=await R({itemsToAdd:i,selectedRulesToAddTo:ue,listType:U,addToRules:t&&!Object(s.isEmpty)(ue),addToSharedLists:n,sharedLists:a}),l=se&&r?r._id:void 0,c=t?ue.map((({rule_id:e})=>e)):(null!=e?e:[]).map((({rule_id:e})=>e));null==L||Object(s.isEmpty)(c)||!oe&&!se||await L(c,o,l,le),q(),N(!0,se,oe)}catch(e){Me(e)}}),[C,R,ce,V,pe,de,U,Ne,Q,ue,se,r,e,L,oe,N,le,Me,q]),Fe=Object(a.useMemo)((()=>_||P||null!=ge||""===V.trim()||Q.every((e=>0===e.entries.length))||me||"add_to_lists"===ce&&Object(s.isEmpty)(de)),[_,P,ge,V,Q,me,ce,de]),Ae=Object(a.useCallback)((()=>{Me(null)}),[Me]),_e=Object(a.useCallback)((()=>{M(!1)}),[M]),Re=Object(a.useMemo)((()=>U===u.b.ENDPOINT?g:m),[U]);return i.a.createElement(l.EuiFlyout,{ownFocus:!0,maskProps:{style:!1===D?"z-index: 5000":"z-index: 1000"},size:"l",onClose:_e,"data-test-subj":"addExceptionFlyout"},i.a.createElement(ie,null,i.a.createElement(l.EuiTitle,null,i.a.createElement("h2",{"data-test-subj":"exceptionFlyoutTitle"},Re)),i.a.createElement(l.EuiSpacer,{size:"m"})),F&&i.a.createElement(l.EuiLoadingContent,{"data-test-subj":"loadingAddExceptionFlyout",lines:4}),!F&&i.a.createElement(ae,{className:"builder-section"},null!=ge&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.EuiCallOut,{title:f,color:"danger",iconType:"alert"},i.a.createElement(l.EuiText,null,y),i.a.createElement(l.EuiSpacer,{size:"s"}),i.a.createElement(l.EuiButton,{color:"danger",onClick:Ae},b)),i.a.createElement(l.EuiSpacer,{size:"s"})),i.a.createElement(S.a,{exceptionItemName:V,onChange:ke}),i.a.createElement(l.EuiHorizontalRule,null),i.a.createElement(w.a,{exceptionItemName:V,allowLargeValueLists:B,exceptionListItems:G,exceptionListType:U,indexPatterns:A,rules:e,selectedOs:H,showOsTypeOptions:U===u.b.ENDPOINT&&!be,isEdit:!1,onOsChange:we,onExceptionItemAdd:he,onSetErrorExists:Se,onFilterIndexPatterns:x.h}),U!==u.b.ENDPOINT&&!(null!=C&&C.length)&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.EuiHorizontalRule,null),i.a.createElement(K,{rules:e,isBulkAction:t,selectedRadioOption:ce,onListSelectionChange:xe,onRuleSelectionChange:Ee,onRadioChange:ve})),i.a.createElement(l.EuiHorizontalRule,null),i.a.createElement(E.a,{accordionTitle:i.a.createElement(ne,{size:"xs"},i.a.createElement("h3",null,(0,d.i18n.translate("xpack.securitySolution.ruleExceptions.addExceptionFlyout.commentsTitle",{values:{comments:0},defaultMessage:"Add comments ({comments})"})))),newCommentValue:pe,newCommentOnChange:je}),o&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.EuiHorizontalRule,null),i.a.createElement(O.a,{exceptionListType:U,shouldCloseSingleAlert:se,shouldBulkCloseAlert:oe,disableBulkClose:W,exceptionListItems:Q,alertData:r,alertStatus:T,isAlertDataLoading:null!=I&&I,onDisableBulkClose:Ce,onUpdateBulkCloseIndex:Oe,onBulkCloseCheckboxChange:Te,onSingleAlertCloseCheckboxChange:Ie}))),i.a.createElement(l.EuiFlyoutFooter,null,i.a.createElement(re,{justifyContent:"spaceBetween"},i.a.createElement(l.EuiButtonEmpty,{"data-test-subj":"cancelExceptionAddButton",onClick:_e},p),i.a.createElement(l.EuiButton,{"data-test-subj":"addExceptionConfirmButton",onClick:De,isDisabled:Fe,fill:!0},Re))))}))},function(e,t,n){"use strict";n.d(t,"d",(function(){return p})),n.d(t,"b",(function(){return g})),n.d(t,"f",(function(){return f})),n.d(t,"a",(function(){return b})),n.d(t,"h",(function(){return y})),n.d(t,"c",(function(){return h})),n.d(t,"e",(function(){return v})),n.d(t,"g",(function(){return E}));var a=n(108),i=n(820),r=n(464),o=n(162);function s([e,t,n,a,i,r,o,s,l],[c,u,d,p,m,g,f,b,y]){return[e*c+t*p+n*f,e*u+t*m+n*b,e*d+t*g+n*y,a*c+i*p+r*f,a*u+i*m+r*b,a*d+i*g+r*y,o*c+s*p+l*f,o*u+s*m+l*b,o*d+s*g+l*y]}function l([e,t,n,a,i,r,o,s,l],[c,u,d,p,m,g,f,b,y]){return[e+c,t+u,n+d,a+p,i+m,r+g,o+f,s+b,l+y]}function c([e,t]){return[e,0,0,0,t,0,0,0,0]}var u=n(275);function d(e,t){return e.startTime+e.duration>=t}const p=Object(a.createSelector)((e=>e.scalingFactor),(e=>e.animation),((e,t)=>{const n=(s=e,Object(r.b)(u.b,u.a,Math.pow(s,u.f)));var s;if(void 0!==t){const e=o.d(t.targetTranslation,t.initialTranslation),s=e*n/t.duration,l=.4,c=.4,p=s<l?s:s**c-(l**c-l),m=Object(r.a)(p*t.duration/e,u.b,u.a);return Object(a.defaultMemoize)((e=>{if(!1===d(t,e))return[n,n];{const a=x(t,e),o=i.easing.inOutCubic(1-Math.abs(2*a-1)),s=Object(r.b)(n,m,o);return[s,s]}}))}return Object(a.defaultMemoize)((()=>[n,n]))})),m=Object(a.createSelector)((e=>e.rasterSize),p,((e,t)=>Object(a.defaultMemoize)((n=>{const[a,i]=t(n),r=e[0],o=e[1],s=r/2/a,l=o/2/i;return{renderWidth:r,renderHeight:o,clippingPlaneRight:s,clippingPlaneTop:l,clippingPlaneLeft:-s,clippingPlaneBottom:-l}})))),g=Object(a.createSelector)((e=>e.animation),(e=>t=>void 0!==e&&d(e,t))),f=Object(a.createSelector)((e=>e.panning),(e=>e.translationNotCountingCurrentPanning),p,(e=>e.animation),((e,t,n,r)=>Object(a.defaultMemoize)((a=>{const[s,l]=n(a);if(void 0!==r&&d(r,a))return o.g(r.initialTranslation,r.targetTranslation,i.easing.inOutCubic(x(r,a)));if(e){const n=o.j(e.currentOffset,e.origin),a=o.e(n,[-s,l]);return o.a(t,a)}return t})))),b=Object(a.createSelector)(m,f,((e,t)=>Object(a.defaultMemoize)((n=>{const{renderWidth:a,renderHeight:i,clippingPlaneRight:r,clippingPlaneTop:o,clippingPlaneLeft:u,clippingPlaneBottom:d}=e(n),p=[0===a?0:2/a,0,-1,0,0===i?0:2/i,-1,0,0,0],m=c([1,-1]),[g,f]=t(n);return l([0,0,g,0,0,f,0,0,0],s(function(e,t,n,a){let i,r,o,s;return t-a==0?(i=0,r=0):(i=(t-a)/2,r=(t+a)/(t-a)),e-n==0?(o=0,s=0):(o=(e-n)/2,s=(e+n)/(e-n)),[i,0,r,0,o,s,0,0,0]}(o,r,d,u),s(m,p)))})))),y=Object(a.createSelector)(m,b,((e,t)=>Object(a.defaultMemoize)((n=>{const{renderWidth:a,renderHeight:i}=e(n),r=t(n),s=[0,i],l=[a,0];return{minimum:o.c(s,r),maximum:o.c(l,r)}})))),h=Object(a.createSelector)(m,f,((e,t)=>Object(a.defaultMemoize)((n=>{const{renderWidth:a,renderHeight:i,clippingPlaneRight:r,clippingPlaneTop:u,clippingPlaneLeft:d,clippingPlaneBottom:p}=e(n),m=function([e,t]){return[1,0,e,0,1,t,0,0,0]}(o.i(t(n),-1)),g=function(e,t,n,a){let i,r,o,s;return t-a==0?(i=0,r=0):(i=2/(t-a),r=-(t+a)/(t-a)),e-n==0?(o=0,s=0):(o=e-n==0?0:2/(e-n),s=e-n==0?0:-(e+n)/(e-n)),[i,0,r,0,o,s,0,0,0]}(u,r,p,d),f=c([1,-1]);return s(c([a/2,i/2]),l([0,0,1,0,0,1,0,0,0],s(f,s(g,m))))})))),v=e=>e.scalingFactor,E=e=>void 0!==e.panning;function x(e,t){return Object(r.a)((t-e.startTime)/e.duration,0,1)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(54);function i(e){return function(t){for(const n of e)if(n(t))return!0;return!1}}function r(e){return function(t){if("object"!=typeof t||null===t)return!1;const n=t;for(const t of Object.keys(e))if(!(0,e[t])(n[t]))return!1;return!0}}function o(e){return function(t){return e===t}}const s=i([r({panelView:o("nodes")}),r({panelView:o("nodeDetail"),panelParameters:r({nodeID:function(e){return"string"==typeof e}})}),r({panelView:o("nodeEvents"),panelParameters:r({nodeID:function(e){return"string"==typeof e}})}),r({panelView:o("nodeEventsInCategory"),panelParameters:r({nodeID:function(e){return"string"==typeof e},eventCategory:function(e){return"string"==typeof e}})}),r({panelView:o("eventDetail"),panelParameters:r({nodeID:function(e){return"string"==typeof e},eventCategory:function(e){return"string"==typeof e},eventID:i([function(e){return"string"==typeof e},o(void 0),function(e){return"number"==typeof e}]),eventTimestamp:function(e){return"string"==typeof e},winlogRecordID:function(e){return"string"==typeof e}})})]);var l=n(341);function c({locationSearch:e,resolverComponentInstanceID:t}){if(void 0===e||void 0===t)return{panelView:"nodes"};const n=new URLSearchParams(e).get(Object(l.a)(t));if(null===n)return{panelView:"nodes"};const i=Object(a.decode)(n);return s(i)?i:{panelView:"nodes"}}},,function(e,t,n){"use strict";e.exports=n(725)},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var a=n(34);const i=(e,t)=>e?`(${t.map((t=>`exception-list-agnostic.attributes.${t}:(*${e.trim().replace(/([\)\(\<\>\}\{\"\:\\])/gm,"\\$&").replace(/\s/gm,"*")}*)`)).join(" OR ")})`:"",r=e=>"global"===e?'exception-list-agnostic.attributes.tags:"policy:all"':"unassigned"===e?"(not exception-list-agnostic.attributes.tags:*)":`exception-list-agnostic.attributes.tags:"policy:${e}"`,o=({policies:e=[],excludedPolicies:t=[],kuery:n})=>{if(0===(null==e?void 0:e.length)&&0===(null==t?void 0:t.length))return n||void 0;const i=((e,t=[])=>{if(Object(a.isEmpty)(e)&&Object(a.isEmpty)(t))return"";const n=e.map(r).join(" OR "),i=t.map((e=>`not ${r(e)}`)).join(" AND "),o=[];return n&&o.push(n),i&&o.push(i),`(${o.join(" AND ")})`})(e,t);return`(${i})${n?` AND (${n})`:""}`}},,function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return l}));var a=n(34),i=n(4),r=n(298),o=n(1);const s=e=>{const t=Object(a.some)({category:"kibana",field:"kibana.alert.rule.uuid"},e),n=Object(i.useMemo)((()=>Object(r.a)({category:"kibana",field:"kibana.alert.rule.name"},e)),[e]),o=Object(i.useMemo)((()=>Object(r.a)({category:"_id",field:"_id"},e)),[e]),s=Object(i.useMemo)((()=>Object(r.a)({category:"agent",field:"agent.id"},e)),[e]),l=Object(i.useMemo)((()=>Object(r.a)({category:"host",field:"host.name"},e)),[e]),c=Object(i.useMemo)((()=>Object(r.a)({category:"user",field:"user.name"},e)),[e]),u=Object(i.useMemo)((()=>Object(r.a)({category:"base",field:"@timestamp"},e)),[e]);return Object(i.useMemo)((()=>({alertId:o,agentId:s,isAlert:t,hostName:l,userName:c,ruleName:n,timestamp:u,data:e})),[s,o,l,t,n,u,c,e])},l=(e,t="default")=>e.startsWith(`.internal${o.J}`)?`${o.J}-${t}`:e.startsWith(`.internal${o.ab}`)?`${o.ab}-${t}`:void 0},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a={refetchIntervalInBackground:!1,staleTime:3e5}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(32),i=n(4),r=n.n(i),o=n(160);const s=({dataTestSubj:e,descriptionList:t})=>r.a.createElement(a.EuiFlexItem,{grow:!0},r.a.createElement(o.d,{"data-test-subj":e,listItems:t}))},function(e,t,n){"use strict";n.r(t),n.d(t,"updateNetworkTable",(function(){return r})),n.d(t,"setNetworkDetailsTablesActivePageToZero",(function(){return o})),n.d(t,"setNetworkTablesActivePageToZero",(function(){return s})),n.d(t,"updateNetworkAnomaliesJobIdFilter",(function(){return l})),n.d(t,"updateNetworkAnomaliesInterval",(function(){return c}));var a=n(16);const i=n.n(a)()("x-pack/security_solution/local/network"),r=i("UPDATE_NETWORK_TABLE"),o=i("SET_IP_DETAILS_TABLES_ACTIVE_PAGE_TO_ZERO"),s=i("SET_NETWORK_TABLES_ACTIVE_PAGE_TO_ZERO"),l=i("UPDATE_NETWORK_ANOMALIES_JOB_ID_FILTER"),c=i("UPDATE_NETWORK_ANOMALIES_INTERVAL")},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(4),i=n.n(a),r=n(585),o=n(594),s=n(256),l=n(462);const c=i.a.memo((({applyWidthAndPadding:e=!0,contextId:t,data:n,eventId:c,fieldFromBrowserField:u,getLinkValue:d,linkValue:p,onFilterAdded:m,setIsPopoverVisible:g,scopeId:f,toggleColumn:b,values:y,hideAddToTimeline:h})=>{var v;const E=Object(s.b)({contextId:t,eventId:c,field:n.field,fieldFormat:n.format,fieldFromBrowserField:u,fieldType:n.type,isObjectArray:n.isObjectArray,linkValue:null!==(v=d&&d(n.field))&&void 0!==v?v:p,values:y}),{closeTopN:x,toggleTopN:k,isShowingTopN:S}=Object(l.b)(g),{aggregatable:w,type:j}=u||{aggregatable:!1,type:""},{timelineId:O}=Object(a.useContext)(r.b);return i.a.createElement(o.a,{applyWidthAndPadding:e,closeTopN:x,dataType:n.type,dataProvider:null==E?void 0:E.dataProviders,enableOverflowButton:!0,field:n.field,isAggregatable:w,fieldType:j,hideAddToTimeline:h,isObjectArray:n.isObjectArray,onFilterAdded:m,ownFocus:!1,showTopN:S,scopeId:null!=f?f:O,toggleColumn:b,toggleTopN:k,values:null==E?void 0:E.values})}));c.displayName="ActionCell"},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(4),i=n.n(a),r=n(85),o=n(601),s=n(639),l=n(872);const c=({riskScoreEntity:e,title:t})=>i.a.createElement(i.a.Fragment,null,null!=t?t:e===r.v.user?s.e:s.b,i.a.createElement(o.a,{text:l.d,className:"eui-alignMiddle"})),u=i.a.memo(c);u.displayName="RiskScoreHeaderTitle"},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(4),i=n(77);const r=()=>{const{spaces:e}=Object(i.k)().services,[t,n]=Object(a.useState)();return Object(a.useEffect)((()=>{e&&e.getActiveSpace().then((e=>n(e.id)))}),[e]),t}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return l}));const a="network.bytes",i="network.community_id",r="network.direction",o="network.packets",s="network.protocol",l="network.transport"},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return s}));var a=n(0);const i=a.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.isolateHost",{defaultMessage:"Isolate host"}),r=a.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.unisolateHost",{defaultMessage:"Release host"}),o=e=>a.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.isolateHost.casesAssociatedWithAlert",{defaultMessage:"{caseCount} {caseCount, plural, one {case} other {cases}} associated with this host",values:{caseCount:e}}),s=a.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.returnToAlertDetails",{defaultMessage:"Return to alert details"})},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"g",(function(){return s})),n.d(t,"f",(function(){return l})),n.d(t,"h",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"c",(function(){return d}));var a=n(0);const i=a.i18n.translate("xpack.securitySolution.exceptions.commentEventLabel",{defaultMessage:"added a comment"}),r=a.i18n.translate("xpack.securitySolution.exceptions.operatingSystemFullLabel",{defaultMessage:"Operating System"}),o=(a.i18n.translate("xpack.securitySolution.exceptions.viewer.addToEndpointListLabel",{defaultMessage:"Add endpoint exception"}),a.i18n.translate("xpack.securitySolution.exceptions.viewer.addToDetectionsListLabel",{defaultMessage:"Add rule exception"}),a.i18n.translate("xpack.securitySolution.exceptions.viewer.addCommentPlaceholder",{defaultMessage:"Add a new comment..."}),a.i18n.translate("xpack.securitySolution.exceptions.viewer.addToClipboard",{defaultMessage:"Comment"})),s=(a.i18n.translate("xpack.securitySolution.exceptions.clearExceptionsLabel",{defaultMessage:"Remove Exception List"}),a.i18n.translate("xpack.securitySolution.exceptions.fetchError",{defaultMessage:"Error fetching exception list"}),a.i18n.translate("xpack.securitySolution.exceptions.errorLabel",{defaultMessage:"Error"}),a.i18n.translate("xpack.securitySolution.exceptions.cancelLabel",{defaultMessage:"Cancel"}),a.i18n.translate("xpack.securitySolution.exceptions.modalErrorAccordionText",{defaultMessage:"Show rule reference information:"}),a.i18n.translate("xpack.securitySolution.exceptions.disassociateExceptionListError",{defaultMessage:"Failed to remove exception list"}),a.i18n.translate("xpack.securitySolution.exceptions.operatingSystemWindows",{defaultMessage:"Windows"})),l=a.i18n.translate("xpack.securitySolution.exceptions.operatingSystemMac",{defaultMessage:"macOS"}),c=a.i18n.translate("xpack.securitySolution.exceptions.operatingSystemWindowsAndMac",{defaultMessage:"Windows and macOS"}),u=a.i18n.translate("xpack.securitySolution.exceptions.operatingSystemLinux",{defaultMessage:"Linux"}),d=a.i18n.translate("xpack.securitySolution.exceptions.fetchingReferencesErrorToastTitle",{defaultMessage:"Error fetching exception references"})},function(e,t,n){const a=n(152);e.exports=(e,t,n)=>a(e,t,n)>0},function(e,t,n){const a=n(152);e.exports=(e,t,n)=>a(e,t,n)>=0},function(e,t,n){const a=Symbol("SemVer ANY");class Comparator{static get ANY(){return a}constructor(e,t){if(t=i(t),e instanceof Comparator){if(e.loose===!!t.loose)return e;e=e.value}l("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===a?this.value="":this.value=this.operator+this.semver.version,l("comp",this)}parse(e){const t=this.options.loose?r[o.COMPARATORLOOSE]:r[o.COMPARATOR],n=e.match(t);if(!n)throw new TypeError(`Invalid comparator: ${e}`);this.operator=void 0!==n[1]?n[1]:"","="===this.operator&&(this.operator=""),n[2]?this.semver=new c(n[2],this.options.loose):this.semver=a}toString(){return this.value}test(e){if(l("Comparator.test",e,this.options.loose),this.semver===a||e===a)return!0;if("string"==typeof e)try{e=new c(e,this.options)}catch(e){return!1}return s(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof Comparator))throw new TypeError("a Comparator is required");if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),""===this.operator)return""===this.value||new u(e.value,t).test(this.value);if(""===e.operator)return""===e.value||new u(this.value,t).test(e.semver);const n=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),a=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),i=this.semver.version===e.semver.version,r=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),o=s(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),l=s(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return n||a||i&&r||o||l}}e.exports=Comparator;const i=n(322),{re:r,t:o}=n(235),s=n(660),l=n(307),c=n(125),u=n(163)},function(e,t,n){const a=n(163);e.exports=(e,t,n)=>{try{t=new a(t,n)}catch(e){return!1}return t.test(e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=e=>i(e)&&r(e)&&o(e)&&s(e),i=({capabilities:e})=>e.canGetDatafeeds&&e.canStartStopDatafeed&&e.canUpdateDatafeed&&e.canPreviewDatafeed,r=({capabilities:e})=>e.canCreateJob&&e.canGetJobs&&e.canUpdateJob&&e.canDeleteJob&&e.canOpenJob&&e.canCloseJob&&e.canForecastJob,o=({capabilities:e})=>e.canGetFilters&&e.canCreateFilter&&e.canDeleteFilter,s=({capabilities:e})=>e.canCreateCalendar&&e.canGetCalendars&&e.canDeleteCalendar},function(e,t,n){"use strict";var a=String.fromCharCode;e.exports=a},function(e,t,n){"use strict";var a=n(115),i=n(122),r={tokenize:function(e,t,n){return i(e,(function(e){return null===e||a(e)?t(e):n(e)}),"linePrefix")},partial:!0};e.exports=r},function(e,t,n){"use strict";var a=n(664);e.exports=function(e,t){var n=e[e.length-1];return n&&n[1].type===t?a(n[2].sliceStream(n[1])):0}},function(e,t,n){"use strict";var a=n(202)(/[\dA-Za-z]/);e.exports=a},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(4),i=n.n(a),r=n(33);const o=n.n(r).a.div.withConfig({displayName:"StyledDiv",componentId:"sc-1adamx3-0"})(["padding-left:",";"],(({addPadding:e})=>e&&"53px"));o.defaultProps={addPadding:!1};const s=i.a.memo(o);s.displayName="StepContentWrapper"},function(e,t,n){"use strict";var a=n(314);n.d(t,"e",(function(){return a.d})),n.d(t,"d",(function(){return a.c})),n.d(t,"c",(function(){return a.b}));var i=n(139);n.d(t,"a",(function(){return i.b})),n.d(t,"b",(function(){return i.d}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"g",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"h",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"f",(function(){return c})),n.d(t,"d",(function(){return u}));const a="/api/fleet/package_policies",i=(e,t,n)=>e.get(`${a}/${t}`,n),r=(e,t,n)=>e.post(`${a}/_bulk_get`,{...n,body:JSON.stringify({ids:t,ignoreMissing:!0})}),o=(e,t,n={})=>e.post("/api/fleet/agent_policies/_bulk_get",{...n,body:JSON.stringify({ids:t,ignoreMissing:!0,full:!0})}),s=(e,t,n,i={})=>e.put(`${a}/${t}`,{...i,body:JSON.stringify(n)}),l=(e,t,n={})=>e.get("/api/fleet/agent_status",{...n,query:{policyId:t}}),c=(e,t={})=>e.get("/api/fleet/agents",{...t,query:{page:1,perPage:1,kuery:'packages : "endpoint"'}}),u=async e=>{const t=(await e.get("/api/fleet/epm/packages",{query:{category:"security"}})).items.find((e=>"endpoint"===e.name));if(!t)throw new Error("Endpoint package was not found.");return t}},function(e,t,n){"use strict";n.d(t,"b",(function(){return Gi})),n.d(t,"a",(function(){return Qi})),n.d(t,"c",(function(){return Yi}));var a=n(32),i=n(0),r=n(41),o=n(35),s=n(34),l=n(4),c=n.n(l),u=n(37),d=n(78),p=n(33),m=n.n(p),g=n(93),f=n(38),b=n(157),y=n(380),h=n(90),v=n(81),E=n(77),x=n(79),k=n(293),S=n(101),w=n(180),j=n(155),O=n(156),I=n(282),T=n(164),C=n(541),M=n(161),N=n(7),D=n(119),F=n(398);const A=i.i18n.translate("xpack.securitySolution.detectionEngine.details.stepAboutRule.detailsLabel",{defaultMessage:"Details"}),_=i.i18n.translate("xpack.securitySolution.detectionEngine.details.stepAboutRule.aboutText",{defaultMessage:"About"}),R=i.i18n.translate("xpack.securitySolution.detectionEngine.details.stepAboutRule.investigationGuideLabel",{defaultMessage:"Investigation guide"}),P=i.i18n.translate("xpack.securitySolution.detectionEngine.details.stepAboutRule.setupGuideLabel",{defaultMessage:"Setup guide"}),L=i.i18n.translate("xpack.securitySolution.detectionEngine.details.stepAboutRule.controlLegend",{defaultMessage:"Viewing"});var q=n(835);const B=m()(a.EuiPanel).withConfig({displayName:"MyPanel",componentId:"sc-wtwaaw-0"})(["position:relative;"]),z=m()(a.EuiFlexGroup).withConfig({displayName:"FlexGroupFullHeight",componentId:"sc-wtwaaw-1"})(["height:100%;"]),$=m.a.div.withConfig({displayName:"VerticalOverflowContainer",componentId:"sc-wtwaaw-2"})((e=>({"max-height":`${e.maxHeight}px`,"overflow-y":"hidden","word-break":"break-word"}))),V=m.a.div.withConfig({displayName:"VerticalOverflowContent",componentId:"sc-wtwaaw-3"})((e=>({"max-height":`${e.maxHeight}px`}))),U=m.a.div.withConfig({displayName:"AboutContent",componentId:"sc-wtwaaw-4"})(["height:100%;"]),H={id:"details",label:A,"data-test-subj":"stepAboutDetailsToggle-details"},G={id:"notes",label:R,"data-test-subj":"stepAboutDetailsToggle-notes"},Q={id:"setup",label:P,"data-test-subj":"stepAboutDetailsToggle-setup"},W=({stepData:e,stepDataDetails:t,loading:n})=>{const[i,r]=Object(l.useState)("details"),[o,s]=Object(l.useState)(0),u=Object(l.useCallback)((e=>{s(e.height)}),[s]),d=Object(l.useMemo)((()=>{const e=!Object(N.isEmpty)(null==t?void 0:t.note)&&""!==(null==t?void 0:t.note.trim()),n=!Object(N.isEmpty)(null==t?void 0:t.setup)&&""!==(null==t?void 0:t.setup.trim());return[...e||n?[H]:[],...e?[G]:[],...n?[Q]:[]]}),[t]);return c.a.createElement(B,{hasBorder:!0},n&&c.a.createElement(c.a.Fragment,null,c.a.createElement(a.EuiProgress,{size:"xs",color:"accent",position:"absolute"}),c.a.createElement(D.a,{title:_})),null!=e&&null!=t&&c.a.createElement(z,{gutterSize:"xs",direction:"column"},c.a.createElement(a.EuiFlexItem,{grow:!1,key:"header"},c.a.createElement(D.a,{title:_},d.length>0&&c.a.createElement(a.EuiButtonGroup,{options:d,idSelected:i,onChange:e=>{r(e)},"data-test-subj":"stepAboutDetailsToggle",legend:L}))),c.a.createElement(a.EuiFlexItem,{key:"details"},"details"===i&&c.a.createElement(a.EuiResizeObserver,{"data-test-subj":"stepAboutDetailsContent",onResize:u},(n=>c.a.createElement(U,{ref:n},c.a.createElement($,{maxHeight:120},c.a.createElement(V,{maxHeight:120,className:"eui-yScrollWithShadows"},c.a.createElement(a.EuiText,{size:"s","data-test-subj":"stepAboutRuleDetailsToggleDescriptionText"},t.description))),c.a.createElement(a.EuiSpacer,{size:"m"}),c.a.createElement(q.a,{descriptionColumns:"singleSplit",isReadOnlyView:!0,isLoading:!1,defaultValues:e})))),"notes"===i&&c.a.createElement($,{"data-test-subj":"stepAboutDetailsNoteContent",maxHeight:o},c.a.createElement(V,{maxHeight:o,className:"eui-yScrollWithShadows"},c.a.createElement(F.b,null,t.note))),"setup"===i&&c.a.createElement($,{"data-test-subj":"stepAboutDetailsSetupContent",maxHeight:o},c.a.createElement(V,{maxHeight:o,className:"eui-yScrollWithShadows"},c.a.createElement(F.b,null,t.setup))))))},K=Object(l.memo)(W);var Y=n(586),J=n(915),X=n(165),Z=n(832),ee=n(842),te=n(274),ne=n(882),ae=n(883),ie=n(310),re=n(114),oe=n(145),se=n(143),le=n(1),ce=n(536),ue=n(131),de=n(312),pe=n(179),me=n(154),ge=n(313),fe=n(844),be=n(519),ye=n(827),he=n(113);const ve=i.i18n.translate("xpack.securitySolution.detectionEngine.rules.components.ruleActionsOverflow.allActionsTitle",{defaultMessage:"All actions"}),Ee=m()(a.EuiButtonIcon).withConfig({displayName:"MyEuiButtonIcon",componentId:"sc-wltxb1-0"})(["&.euiButtonIcon{svg{transform:rotate(90deg);}border:1px solid ",";width:40px;height:40px;}"],(({theme:e})=>e.euiColorPrimary)),xe=({rule:e,userHasPermissions:t,canDuplicateRuleWithActions:n,showBulkDuplicateExceptionsConfirmation:i})=>{const[r,,o,s]=Object(de.a)(),{navigateToApp:u}=Object(E.k)().services.application,{startTransaction:d}=Object(me.a)(),{executeBulkAction:p}=Object(be.b)({suppressSuccessToast:!0}),{bulkExport:m}=Object(fe.a)(),g=Object(ye.a)(),f=Object(l.useCallback)((()=>{u(le.B,{deepLinkId:le.uc.rules,path:Object(O.e)()})}),[u]),b=Object(l.useMemo)((()=>null!=e?[c.a.createElement(a.EuiContextMenuItem,{key:he.zb,icon:"copy",disabled:!n||!t,"data-test-subj":"rules-details-duplicate-rule",onClick:async()=>{d({name:pe.e.DUPLICATE}),o();const t=await i();if(null===t)return;const n=await p({type:ue.b.duplicate,ids:[e.id],duplicatePayload:{include_exceptions:t===ce.a.withExceptions}}),a=null==n?void 0:n.attributes.results.created;null!=a&&a.length&&Object(be.a)(a[0].id,u)}},c.a.createElement(a.EuiToolTip,{position:"left",content:Object(ge.a)(e,n)?void 0:he.Ob},c.a.createElement(c.a.Fragment,null,he.zb))),c.a.createElement(a.EuiContextMenuItem,{key:he.Hb,icon:"exportAction",disabled:!t||e.immutable,"data-test-subj":"rules-details-export-rule",onClick:async()=>{d({name:pe.e.EXPORT}),o();const t=await m({ids:[e.id]});t&&await g(t)}},he.Hb),c.a.createElement(a.EuiContextMenuItem,{key:he.yb,icon:"trash",disabled:!t,"data-test-subj":"rules-details-delete-rule",onClick:async()=>{d({name:pe.e.DELETE}),o(),await p({type:ue.b.delete,ids:[e.id]}),f()}},he.yb)]:[]),[m,n,o,p,u,f,e,i,d,t,g]),y=Object(l.useMemo)((()=>c.a.createElement(a.EuiToolTip,{position:"top",content:ve},c.a.createElement(Ee,{iconType:"boxesHorizontal","aria-label":ve,isDisabled:!t,"data-test-subj":"rules-details-popover-button-icon",onClick:s}))),[s,t]);return c.a.createElement(c.a.Fragment,null,c.a.createElement(a.EuiPopover,{anchorPosition:"leftCenter",button:y,closePopover:o,id:"ruleActionsOverflow",isOpen:r,"data-test-subj":"rules-details-popover",ownFocus:!0,panelPaddingSize:"none",repositionOnScroll:!0},c.a.createElement(a.EuiContextMenuPanel,{"data-test-subj":"rules-details-menu-panel",items:b})))},ke=c.a.memo(xe);ke.displayName="RuleActionsOverflow";var Se=n(120),we=n(366),je=n(259),Oe=n(2),Ie=n(148),Te=n(572),Ce=n(123),Me=n(94),Ne=n(95),De=n(583),Fe=n(52),Ae=n.n(Fe),_e=n(173);const Re=()=>E.b.get().http;var Pe=n(87),Le=n(417);const qe=Object(Pe.d)(),Be=({status:e,showTooltip:t=!1})=>{var n;const i=null!==(n=Object(Le.a)(e))&&void 0!==n?n:qe,r=Object(Le.b)(e);return t?c.a.createElement(De.b,{status:e}):c.a.createElement(a.EuiHealth,{color:r},i)},ze=c.a.memo(Be);ze.displayName="ExecutionStatusIndicator";const $e=e=>{const{dataTestSubj:t,title:n,items:i,selectedItems:r,onSelectionChange:o,renderItem:s,renderLabel:u}=Ue(e),[d,,p,m]=Object(de.a)(),g=Object(l.useCallback)((e=>{const t=r.includes(e)?r.filter((t=>t!==e)):[...r,e];o(t)}),[r,o]),f=Object(l.useMemo)((()=>i.map(((e,n)=>{const i=u(e),o=s(e);return c.a.createElement(a.EuiFilterSelectItem,{"data-test-subj":`${t}-item`,title:i,key:`${n}-${i}`,checked:r.includes(e)?"on":void 0,onClick:()=>g(e)},o)}))),[t,i,r,s,u,g]);return c.a.createElement(a.EuiFilterGroup,{"data-test-subj":t},c.a.createElement(a.EuiPopover,{"data-test-subj":`${t}-popover`,button:c.a.createElement(a.EuiFilterButton,{"data-test-subj":`${t}-popoverButton`,iconType:"arrowDown",grow:!1,numFilters:i.length,numActiveFilters:r.length,hasActiveFilters:r.length>0,isSelected:d,onClick:m},n),isOpen:d,closePopover:p,panelPaddingSize:"none",repositionOnScroll:!0},f))},Ve=(()=>{const e=c.a.memo($e);return e.displayName="MultiselectFilter",e})(),Ue=e=>{var t,n,a,i;const r=null!==(t=e.onSelectionChange)&&void 0!==t?t:N.noop,o=null!==(n=e.renderLabel)&&void 0!==n?n:String,s=null!==(a=e.renderItem)&&void 0!==a?a:o;return{dataTestSubj:null!==(i=e.dataTestSubj)&&void 0!==i?i:"multiselectFilter",title:e.title,items:e.items,selectedItems:e.selectedItems,onSelectionChange:r,renderLabel:o,renderItem:s}},He=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.executionStatusFilter.filterTitle",{defaultMessage:"Status"}),Ge=({items:e,selectedItems:t,onChange:n})=>{const a=Object(l.useCallback)((e=>c.a.createElement(ze,{status:e})),[]);return c.a.createElement(Ve,{dataTestSubj:"ExecutionStatusFilter",title:He,items:e,selectedItems:t,onSelectionChange:n,renderItem:a})},Qe=c.a.memo(Ge);Qe.displayName="ExecutionStatusFilter";var We=n(174);const Ke=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.eventTypeIndicator.messageText",{defaultMessage:"Message"}),Ye=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.eventTypeIndicator.statusChangeText",{defaultMessage:"Status"}),Je=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.eventTypeIndicator.executionMetricsText",{defaultMessage:"Metrics"}),Xe=({type:e})=>{const t=(e=>{switch(e){case _e.e.message:return"console";case _e.e["status-change"]:return"dot";case _e.e["execution-metrics"]:return"gear";default:return Object(We.a)(e,"Unknown rule execution event type")}})(e),n=(e=>{switch(e){case _e.e.message:return Ke;case _e.e["status-change"]:return Ye;case _e.e["execution-metrics"]:return Je;default:return Object(We.a)(e,"Unknown rule execution event type")}})(e);return c.a.createElement(a.EuiBadge,{color:"hollow",iconType:t},n)},Ze=c.a.memo(Xe);Ze.displayName="EventTypeIndicator";const et=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.eventTypeFilter.filterTitle",{defaultMessage:"Event type"}),tt=({selectedItems:e,onChange:t})=>{const n=Object(l.useCallback)((e=>c.a.createElement(Ze,{type:e})),[]);return c.a.createElement(Ve,{dataTestSubj:"eventTypeFilter",title:et,items:_e.d,selectedItems:e,onSelectionChange:t,renderItem:n})},nt=c.a.memo(tt);nt.displayName="EventTypeFilter";const at=({logLevel:e})=>{const t=(e=>{switch(e){case _e.b.trace:case _e.b.debug:return"hollow";case _e.b.info:return"default";case _e.b.warn:return"warning";case _e.b.error:return"danger";default:return Object(We.a)(e,"Unknown log level")}})(e),n=(e=>Object(N.upperCase)(e))(e);return c.a.createElement(a.EuiBadge,{color:t},n)},it=c.a.memo(at);it.displayName="LogLevelIndicator";const rt=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.logLevelFilter.filterTitle",{defaultMessage:"Log level"}),ot=({selectedItems:e,onChange:t})=>{const n=Object(l.useCallback)((e=>c.a.createElement(it,{logLevel:e})),[]);return c.a.createElement(Ve,{dataTestSubj:"logLevelFilter",title:rt,items:_e.a,selectedItems:e,onSelectionChange:t,renderItem:n})},st=c.a.memo(ot);st.displayName="LogLevelFilter";const lt=({text:e})=>c.a.createElement(a.EuiCodeBlock,{className:"eui-fullWidth",isCopyable:!0,overflowHeight:320,transparentBackground:!0},null!=e?e:""),ct=c.a.memo(lt);ct.displayName="TextBlock";const ut=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.executionEventsTable.tableTitle",{defaultMessage:"Execution log"}),dt=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.executionEventsTable.tableSubtitle",{defaultMessage:"A detailed log of rule execution events"}),pt=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.executionEventsTable.timestampColumn",{defaultMessage:"Timestamp"}),mt=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.executionEventsTable.logLevelColumn",{defaultMessage:"Level"}),gt=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.executionEventsTable.eventTypeColumn",{defaultMessage:"Type"}),ft=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.executionEventsTable.messageColumn",{defaultMessage:"Message"}),bt=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.executionEventsTable.fetchErrorDescription",{defaultMessage:"Failed to fetch rule execution events"}),yt=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.executionEventsTable.rowDetails.messageTitle",{defaultMessage:"Message"}),ht=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.executionEventsTable.rowDetails.jsonTitle",{defaultMessage:"Full JSON"}),vt=({item:e})=>c.a.createElement(a.EuiDescriptionList,{className:"eui-fullWidth",listItems:[{title:yt,description:c.a.createElement(ct,{text:e.message})},{title:ht,description:c.a.createElement(ct,{text:JSON.stringify(e,null,2)})}]}),Et=c.a.memo(vt);Et.displayName="ExecutionEventsTableRowDetails";const xt=[10,20,50],kt=({text:e})=>null!=e?c.a.createElement("span",{className:"eui-fullWidth eui-textTruncate"},e):null,St=c.a.memo(kt);St.displayName="TruncatedText";const wt={field:"timestamp",name:pt,render:e=>c.a.createElement(S.a,{value:e,fieldName:"timestamp"}),sortable:!0,truncateText:!1,width:"20%"},jt={field:"level",name:mt,render:e=>c.a.createElement(it,{logLevel:e}),sortable:!1,truncateText:!1,width:"8%"},Ot={field:"type",name:gt,render:e=>c.a.createElement(Ze,{type:e}),sortable:!1,truncateText:!1,width:"8%"},It={field:"message",name:ft,render:e=>c.a.createElement(St,{text:e}),sortable:!1,truncateText:!0,width:"64%"},Tt=({toggleRowExpanded:e,isRowExpanded:t})=>({align:a.RIGHT_ALIGNMENT,width:"40px",isExpander:!0,name:c.a.createElement(a.EuiScreenReaderOnly,null,c.a.createElement("span",null,"Expand rows")),render:n=>c.a.createElement(a.EuiButtonIcon,{onClick:()=>e(n),"aria-label":t(n)?"Collapse":"Expand",iconType:t(n)?"arrowUp":"arrowDown"})});var Ct=n(39),Mt=n(84);const Nt=[10,20,50,100,200],Dt=({ruleId:e})=>{const t=Object(l.useCallback)((e=>`${e.timestamp} ${e.sequence}`),[]),n=(e=>{const{getItemId:t,renderItem:n}=e,[a,i]=Object(l.useState)({}),r=Object(l.useCallback)((e=>{const r={...a},o=t(e);r[o]?delete r[o]:r[o]=n(e),i(r)}),[a,t,n]),o=Object(l.useCallback)((e=>{const n=t(e);return null!=a[n]}),[a,t]);return Object(l.useMemo)((()=>({itemIdToExpandedRowMap:a,getItemId:t,toggleRowExpanded:r,isRowExpanded:o})),[a,t,r,o])})({getItemId:t,renderItem:Object(l.useCallback)((e=>c.a.createElement(Et,{item:e})),[])}),i=(e=>{const{toggleRowExpanded:t,isRowExpanded:n}=e;return Object(l.useMemo)((()=>[wt,jt,Ot,It,Tt({toggleRowExpanded:t,isRowExpanded:n})]),[t,n])})({toggleRowExpanded:n.toggleRowExpanded,isRowExpanded:n.isRowExpanded}),r=(()=>{const[e,t]=Object(l.useState)([]),[n,a]=Object(l.useState)([]),i=Object(l.useMemo)((()=>({logLevels:e,eventTypes:n})),[e,n]);return Object(l.useMemo)((()=>({state:i,setLogLevels:t,setEventTypes:a})),[i,t,a])})(),o=((e,t)=>{const[n,a]=Object(l.useState)("timestamp"),[i,r]=Object(l.useState)("desc"),o=Object(l.useMemo)((()=>({sort:{field:n,direction:i}})),[n,i]),s=Object(l.useCallback)((e=>{e.sort&&(a(e.sort.field),r(e.sort.direction))}),[a,r]);return Object(l.useMemo)((()=>({state:o,update:s})),[o,s])})(),s=(e=>{var t,n,a;const i=null!==(t=e.pageSizeOptions)&&void 0!==t?t:xt,r=null!==(n=e.pageSizeDefault)&&void 0!==n?n:i[0],o=null!==(a=e.pageNumberDefault)&&void 0!==a?a:1,[s,c]=Object(l.useState)(r),[u,d]=Object(l.useState)(o),[p,m]=Object(l.useState)(0),g=Object(l.useMemo)((()=>({pageSizeOptions:i,pageSize:s,pageNumber:u,pageIndex:u-1,totalItemCount:p})),[i,s,u,p]),f=Object(l.useCallback)((e=>{d(e.page.index+1),c(e.page.size)}),[d,c]),b=Object(l.useCallback)((e=>{m(null!=e?e:0)}),[m]);return Object(l.useMemo)((()=>({state:g,update:f,updateTotalItemCount:b})),[g,f,b])})({pageSizeOptions:Nt}),u=(e=>{const{addError:t}=Object(Mt.a)();return Object(Ct.useQuery)(["detectionEngine","ruleMonitoring","executionEvents",e],(({signal:t})=>(e=>{const{ruleId:t,eventTypes:n,logLevels:a,sortOrder:i,page:r,perPage:o,signal:s}=e,l=Object(_e.h)(t);return Re().fetch(l,{method:"GET",query:{event_types:null==n?void 0:n.join(","),log_levels:null==a?void 0:a.join(","),sort_order:i,page:r,per_page:o},signal:s})})({...e,signal:t})),{keepPreviousData:!0,refetchInterval:2e4,onError:e=>{t(e,{title:bt})}})})({ruleId:e,eventTypes:r.state.eventTypes,logLevels:r.state.logLevels,sortOrder:o.state.sort.direction,page:s.state.pageNumber,perPage:s.state.pageSize});Object(l.useEffect)((()=>{var e;s.updateTotalItemCount(null===(e=u.data)||void 0===e?void 0:e.pagination.total)}),[u,s]);const d=Object(l.useMemo)((()=>{var e,t;return null!==(e=null===(t=u.data)||void 0===t?void 0:t.events)&&void 0!==e?e:[]}),[u.data]),p=Object(l.useCallback)((e=>{o.update(e),s.update(e)}),[o,s]);return c.a.createElement(a.EuiPanel,{hasBorder:!0},c.a.createElement(a.EuiFlexGroup,{gutterSize:"s"},c.a.createElement(a.EuiFlexItem,{grow:!0},c.a.createElement(D.a,{title:ut,subtitle:dt})),c.a.createElement(a.EuiFlexItem,{grow:!1},c.a.createElement(st,{selectedItems:r.state.logLevels,onChange:r.setLogLevels})),c.a.createElement(a.EuiFlexItem,{grow:!1},c.a.createElement(nt,{selectedItems:r.state.eventTypes,onChange:r.setEventTypes}))),c.a.createElement(a.EuiBasicTable,{columns:i,items:d,itemId:t,itemIdToExpandedRowMap:n.itemIdToExpandedRowMap,isExpandable:!0,loading:u.isFetching,sorting:o.state,pagination:s.state,onChange:p}))},Ft=c.a.memo(Dt);Ft.displayName="RuleExecutionEventsTable";const At=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.executionResultsTable.fetchErrorDescription",{defaultMessage:"Failed to fetch rule execution results"});var _t=n(107);const Rt=(e,t)=>{try{const[t]=Object(E.q)(e);return t}catch(e){return t}};var Pt=n(43),Lt=n.n(Pt),qt=n(45),Bt=1e3,zt="siem",$t=("".concat(zt,".eqlRule"),"".concat(zt,".indicatorRule"),"".concat(zt,".mlRule"),"".concat(zt,".queryRule"),"".concat(zt,".savedQueryRule"),"".concat(zt,".thresholdRule"),"".concat(zt,".newTermsRule"),n(6),n(216),n(53)),Vt=(n(1058),n(36)),Ut=n(247),Ht=n(98),Gt=n(933),Qt=n(679);const Wt=Object(l.createContext)(null),Kt=({children:e})=>{var t;const{storage:n}=Object(E.k)().services,[a,i]=Object(l.useState)([]),[r,o]=Object(l.useState)(1e3),[s,u]=Object(l.useState)(!0),[d,p]=Object(l.useState)("now-24h"),[m,g]=Object(l.useState)("now"),[f,b]=Object(l.useState)(""),[y,h]=Object(l.useState)([]),[v,x]=Object(l.useState)(null!==(t=n.get(le.nc))&&void 0!==t&&t),[k,S]=Object(l.useState)(1),[w,j]=Object(l.useState)(5),[O,I]=Object(l.useState)("timestamp"),[T,C]=Object(l.useState)("desc"),M=Object(l.useMemo)((()=>({[Gi.executionResults]:{state:{superDatePicker:{recentlyUsedRanges:a,refreshInterval:r,isPaused:s,start:d,end:m},queryText:f,statusFilters:y,showMetricColumns:v,pagination:{pageIndex:k,pageSize:w},sort:{sortField:O,sortDirection:T}},actions:{setEnd:g,setIsPaused:u,setPageIndex:S,setPageSize:j,setQueryText:b,setRecentlyUsedRanges:i,setRefreshInterval:o,setShowMetricColumns:x,setSortDirection:C,setSortField:I,setStart:p,setStatusFilters:h}}})),[m,s,k,w,f,a,r,v,T,O,d,y]);return c.a.createElement(Wt.Provider,{value:M},e)},Yt=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.tableTitle",{defaultMessage:"Execution log"}),Jt=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.tableSubtitle",{defaultMessage:"A log of rule execution results"}),Xt=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.searchPlaceholder",{defaultMessage:"duration > 100 and gapDuration > 10"}),Zt=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.showMetricColumnsSwitchTitle",{defaultMessage:"Show metrics columns"}),en=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.statusColumn",{defaultMessage:"Status"}),tn=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.statusColumnTooltip",{defaultMessage:"Overall status of execution."}),nn=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.timestampColumn",{defaultMessage:"Timestamp"}),an=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.timestampColumnTooltip",{defaultMessage:"Datetime rule execution initiated."}),rn=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.durationColumn",{defaultMessage:"Duration"}),on=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.durationColumnTooltip",{defaultMessage:"The length of time it took for the rule to run (hh:mm:ss:SSS)."}),sn=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.messageColumn",{defaultMessage:"Message"}),ln=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.messageColumnTooltip",{defaultMessage:"Relevant message from execution outcome."}),cn=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.gapDurationColumn",{defaultMessage:"Gap Duration"}),un=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.gapTooltipSeeDocsDescription",{defaultMessage:"see documentation"}),dn=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.indexDurationColumn",{defaultMessage:"Index Duration"}),pn=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.indexDurationColumnTooltip",{defaultMessage:"The length of time it took to index detected alerts (hh:mm:ss:SSS)."}),mn=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.searchDurationColumn",{defaultMessage:"Search Duration"}),gn=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.searchDurationColumnTooltip",{defaultMessage:"The length of time it took to search for alerts (hh:mm:ss:SSS)."}),fn=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.schedulingDelayColumn",{defaultMessage:"Scheduling Delay"}),bn=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.schedulingDelayColumnTooltip",{defaultMessage:"The length of time from rule scheduled till rule executed (hh:mm:ss:SSS)."}),yn=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.actionsColumn",{defaultMessage:"Actions"}),hn=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.actionsColumnTooltip",{defaultMessage:"Filter alerts by rule execution ID."}),vn=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.actionSearchFiltersUpdatedTitle",{defaultMessage:"Global search filters have been updated"}),En=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.actionSearchFiltersUpdatedDescription",{defaultMessage:"Search filters have been updated to show alerts from selected rule execution"}),xn=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.actionSearchFiltersUpdatedRestoreButtonTitle",{defaultMessage:"Restore previous filters"}),kn=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.actionFieldNotFoundErrorTitle",{defaultMessage:"Unable to filter alerts"}),Sn=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.actionFieldNotFoundErrorDescription",{defaultMessage:"Cannot find field 'kibana.alert.rule.execution.uuid' in alerts index."}),wn=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.durationNotAvailableDescription",{defaultMessage:"N/A"}),jn=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.durationGreaterThanYearDescription",{defaultMessage:"> 1 Year"});var On=n(884),In=n(885);const Tn=e=>{const{duration:t,isSeconds:n=!1,allowZero:a=!0}=e,i=Object(l.useMemo)((()=>a&&t>=0?(e=>{if(!e)return"00:00:00:000";const t=Lt.a.duration(e),n=Math.floor(t.asDays()).toString().padStart(3,"0"),a=Math.floor(t.asHours()%24).toString().padStart(2,"0"),i=Math.floor(t.asMinutes()%60).toString().padStart(2,"0"),r=t.seconds().toString().padStart(2,"0"),o=t.milliseconds().toString().padStart(3,"0");return Math.floor(t.asDays())>0?Math.floor(t.asDays())>=365?jn:`${n}:${a}:${i}:${r}:${o}`:`${a}:${i}:${r}:${o}`})(n?1e3*t:t):wn),[a,t,n]);return c.a.createElement("span",{"data-test-subj":"rule-duration-format-value"},i)},Cn=c.a.memo(Tn);Cn.displayName="RuleDurationFormat";const Mn=[{name:c.a.createElement(In.a,{title:en,tooltipContent:tn}),field:"security_status",render:e=>c.a.createElement(ze,{status:e,showTooltip:!0}),sortable:!1,truncateText:!1,width:"10%"},{field:"timestamp",name:c.a.createElement(In.a,{title:nn,tooltipContent:an}),render:e=>c.a.createElement(S.a,{value:e,fieldName:"timestamp"}),sortable:!0,truncateText:!1,width:"15%"},{field:"duration_ms",name:c.a.createElement(In.a,{title:rn,tooltipContent:on}),render:e=>c.a.createElement(c.a.Fragment,null,e?c.a.createElement(Cn,{duration:e}):Object(Pe.e)()),sortable:!0,truncateText:!1,width:"10%"},{field:"security_message",name:c.a.createElement(In.a,{title:sn,tooltipContent:ln}),render:e=>c.a.createElement(c.a.Fragment,null,e),sortable:!1,truncateText:!1,width:"35%"}],Nn=e=>[{field:"gap_duration_s",name:c.a.createElement(In.a,{title:cn,customTooltip:c.a.createElement("div",{style:{maxWidth:"20px"}},c.a.createElement(On.a,{columnName:cn},c.a.createElement(a.EuiText,{size:"s",style:{width:350}},c.a.createElement("p",null,c.a.createElement(o.FormattedMessage,{defaultMessage:"Duration of gap in Rule execution (hh:mm:ss:SSS). Adjust Rule look-back or {seeDocs} for mitigating gaps.",id:"xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.gapDurationColumnTooltip",values:{seeDocs:c.a.createElement(a.EuiLink,{href:`${e.links.siem.troubleshootGaps}`,target:"_blank"},un)}})))))}),render:e=>c.a.createElement(c.a.Fragment,null,e?c.a.createElement(Cn,{duration:e,isSeconds:!0}):Object(Pe.e)()),sortable:!0,truncateText:!1,width:"10%"},{field:"indexing_duration_ms",name:c.a.createElement(In.a,{title:dn,tooltipContent:pn}),render:e=>c.a.createElement(c.a.Fragment,null,e?c.a.createElement(Cn,{duration:e}):Object(Pe.e)()),sortable:!0,truncateText:!1,width:"10%"},{field:"search_duration_ms",name:c.a.createElement(In.a,{title:mn,tooltipContent:gn}),render:e=>c.a.createElement(c.a.Fragment,null,e?c.a.createElement(Cn,{duration:e}):Object(Pe.e)()),sortable:!0,truncateText:!1,width:"10%"},{field:"schedule_delay_ms",name:c.a.createElement(In.a,{title:fn,tooltipContent:bn}),render:e=>c.a.createElement(c.a.Fragment,null,e?c.a.createElement(Cn,{duration:e}):Object(Pe.e)()),sortable:!0,truncateText:!1,width:"10%"}],Dn={status:"kibana.alert.rule.execution.status",timestamp:"@timestamp",duration:"event.duration",message:"message",gapDuration:"kibana.alert.rule.execution.metrics.execution_gap_duration_s",indexDuration:"kibana.alert.rule.execution.metrics.total_indexing_duration_ms",searchDuration:"kibana.alert.rule.execution.metrics.total_search_duration_ms",totalActions:"kibana.alert.rule.execution.metrics.number_of_triggered_actions",schedulingDelay:"kibana.task.schedule_delay"},Fn=[_e.f.succeeded,_e.f.failed,_e.f["partial failure"]],An=c.a.memo((({onlyShowFilters:e,selectedStatuses:t,onStatusFilterChange:n,onSearch:i})=>{const r=Object(l.useCallback)((e=>{i((e=>Object.entries(Dn).reduce(((e,[t,n])=>Object(N.replace)(e,t,n)),e))(e))}),[i]);return c.a.createElement(a.EuiFlexGroup,{gutterSize:"s"},c.a.createElement(a.EuiFlexItem,{grow:!0},!e&&c.a.createElement(a.EuiFieldSearch,{"data-test-subj":"executionLogSearch","aria-label":Xt,placeholder:Xt,onSearch:r,isClearable:!0,fullWidth:!0})),c.a.createElement(a.EuiFlexItem,{grow:!1},c.a.createElement(Qe,{items:Fn,selectedItems:t,onChange:n})))}));An.displayName="ExecutionLogSearchBar";const _n="kibana.alert.rule.execution.uuid",Rn=m()(a.EuiSwitch).withConfig({displayName:"UtilitySwitch",componentId:"sc-1wv8sfl-0"})(["margin-left:17px;"]),Pn=m()(a.EuiFlexItem).withConfig({displayName:"DatePickerEuiFlexItem",componentId:"sc-1wv8sfl-1"})(["max-width:582px;"]),Ln=({ruleId:e,selectAlertsTab:t})=>{var n,r;const{docLinks:s,data:{query:{filterManager:u}},storage:p,timelines:m}=Object(E.k)().services,{[Gi.executionResults]:{state:{superDatePicker:{recentlyUsedRanges:g,refreshInterval:f,isPaused:b,start:y,end:x},queryText:k,statusFilters:S,showMetricColumns:w,pagination:{pageIndex:j,pageSize:O},sort:{sortField:I,sortDirection:T}},actions:{setEnd:C,setIsPaused:M,setPageIndex:N,setPageSize:F,setQueryText:A,setRecentlyUsedRanges:_,setRefreshInterval:R,setShowMetricColumns:P,setSortDirection:L,setSortField:q,setStart:B,setStatusFilters:z}}}=(()=>{const e=Object(l.useContext)(Wt);return Object(Qt.a)(e,"useRuleDetailsContext should be used inside RuleDetailsContextProvider"),e})(),{indexPattern:$}=Object(Me.d)(Ne.SourcererScopeName.detections),{addError:V,addSuccess:U,remove:H}=Object(Mt.a)(),G=Object(d.useDispatch)(),Q=Object(l.useMemo)((()=>Ht.d.globalFiltersQuerySelector()),[]),W=Object(l.useMemo)((()=>Ht.d.globalQuerySelector()),[]),K=Object(v.a)(Ht.d.globalTimeRangeSelector),Y=Object(v.a)(W),J=Object(v.a)(Q),X=Object(l.useRef)({filters:J,query:Y,timerange:K}),Z=Object(l.useRef)(""),ee=Object(l.useCallback)((()=>{Object(Gt.a)(X.current.timerange)?G(Object(se.setAbsoluteRangeDatePicker)({id:h.a.global,from:X.current.timerange.from,to:X.current.timerange.to})):Object(Gt.b)(X.current.timerange)&&G(Object(se.setRelativeRangeDatePicker)({id:h.a.global,from:X.current.timerange.from,fromStr:X.current.timerange.fromStr,to:X.current.timerange.to,toStr:X.current.timerange.toStr})),G(Object(se.setFilterQuery)({id:h.a.global,query:X.current.query.query,language:X.current.query.language})),u.removeAll(),u.addFilters(X.current.filters),H(Z.current)}),[G,u,H]),{data:te,dataUpdatedAt:ne,isFetching:ae,isLoading:ie,refetch:re}=(e=>{const{addError:t}=Object(Mt.a)();return Object(Ct.useQuery)(["detectionEngine","ruleMonitoring","executionResults",e],(({signal:t})=>(e=>{var t;const{ruleId:n,start:a,end:i,queryText:r,statusFilters:o,page:s,perPage:l,sortField:c,sortOrder:u,signal:d}=e,p=Object(_e.i)(n),m=Ae.a.parse(a),g=Ae.a.parse(i,{roundUp:!0});return Re().fetch(p,{method:"GET",query:{start:null==m?void 0:m.utc().toISOString(),end:null==g?void 0:g.utc().toISOString(),query_text:r,status_filters:null==o||null===(t=o.sort())||void 0===t?void 0:t.join(","),sort_field:c,sort_order:u,page:s,per_page:l},signal:d})})({...e,signal:t})),{keepPreviousData:!0,onError:e=>{t(e,{title:At})}})})({ruleId:e,start:y,end:x,queryText:k,statusFilters:S,page:j,perPage:O,sortField:I,sortOrder:T}),oe=null!==(n=null==te?void 0:te.events)&&void 0!==n?n:[],ce=null!==(r=null==te?void 0:te.total)&&void 0!==r?r:0,ue=Object(l.useMemo)((()=>$.fields.find((e=>e.name===_n))),[$]),de=Object(l.useCallback)((({page:e={},sort:t={}})=>{const{index:n,size:a}=e,{field:i,direction:r}=t;N(n+1),F(a),q(i),L(r)}),[N,F,L,q]),pe=Object(l.useCallback)((e=>{const t=g.filter((t=>!(t.start===e.start&&t.end===e.end)));t.unshift({start:e.start,end:e.end}),B(e.start),C(e.end),_(t.length>10?t.slice(0,9):t)}),[g,C,_,B]),me=Object(l.useCallback)((e=>{M(e.isPaused),R(e.refreshInterval>6e4?e.refreshInterval:6e4)}),[M,R]),ge=Object(l.useCallback)((e=>{re()}),[re]),fe=Object(l.useCallback)((e=>{A(e)}),[A]),be=Object(l.useCallback)((e=>{z(e)}),[z]),ye=Object(l.useCallback)(((e,n)=>{if(null!=ue){X.current={filters:J,query:Y,timerange:K};const r=Object(qt.buildFilter)($,ue,qt.FILTERS.PHRASE,!1,!1,e,null);G(Object(se.setAbsoluteRangeDatePicker)({id:h.a.global,from:Lt()(n).subtract(1,"days").toISOString(),to:Lt()(n).add(1,"days").toISOString()})),u.removeAll(),u.addFilters(r),G(Object(se.setFilterQuery)({id:h.a.global,query:"",language:"kuery"})),t(),Z.current=U({title:vn,text:(i=c.a.createElement(c.a.Fragment,null,c.a.createElement("p",null,En),c.a.createElement(a.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},c.a.createElement(a.EuiFlexItem,{grow:!1},c.a.createElement(a.EuiButton,{size:"s",onClick:ee},xn)))),function(e){return Object($t.render)(Object(Vt.jsx)(o.I18nProvider,null,i),e),function(){return Object($t.unmountComponentAtNode)(e)}})},{toastLifeTimeMs:6e5}).id}else V(Sn,{title:kn});var i}),[V,U,G,u,J,$,Y,ee,t,K,ue]),he=Object(l.useCallback)((e=>{p.set(le.nc,e),P(e)}),[P,p]),ve=Object(l.useMemo)((()=>({pageIndex:j-1,pageSize:O,totalItemCount:ce>Bt?Bt:ce,pageSizeOptions:[5,10,25,50]})),[ce,j,O]),Ee=Object(l.useMemo)((()=>({sort:{field:I,direction:T}})),[T,I]),xe=Object(l.useMemo)((()=>[{field:_n,name:yn,width:"5%",actions:[{name:"Edit",isPrimary:!0,field:"",description:hn,icon:"filter",type:"icon",onClick:e=>{null!=e&&e.execution_uuid&&ye(e.execution_uuid,e.timestamp)},"data-test-subj":"action-filter-by-execution-id"}]}]),[ye]),ke=Object(l.useMemo)((()=>w?[...Mn,...Nn(s),...xe]:[...Mn,...xe]),[xe,s,w]);return c.a.createElement(a.EuiPanel,{hasBorder:!0},c.a.createElement(a.EuiFlexGroup,{gutterSize:"s"},c.a.createElement(a.EuiFlexItem,{grow:!0},c.a.createElement(D.a,{title:Yt,subtitle:Jt})),c.a.createElement(a.EuiFlexItem,{grow:!1},c.a.createElement(An,{onlyShowFilters:!0,selectedStatuses:S,onStatusFilterChange:be,onSearch:fe})),c.a.createElement(Pn,null,c.a.createElement(a.EuiSuperDatePicker,{start:y,end:x,onTimeChange:pe,onRefresh:ge,isPaused:b,isLoading:ae,refreshInterval:f,onRefreshChange:me,recentlyUsedRanges:g,width:"full"}))),c.a.createElement(a.EuiSpacer,{size:"s"}),c.a.createElement(Ut.a,null,c.a.createElement(Ut.d,null,c.a.createElement(Ut.c,null,c.a.createElement(Ut.e,{dataTestSubj:"executionsShowing"},(Se=ce>Bt?Bt:ce,i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.totalExecutionsLabel",{values:{totalItems:Se},defaultMessage:"Showing {totalItems} {totalItems, plural, =1 {rule execution} other {rule executions}}"})))),ce>Bt&&c.a.createElement(Ut.c,{grow:!0},c.a.createElement(Ut.e,{dataTestSubj:"exceptionsShowing",shouldWrap:!0},c.a.createElement(a.EuiTextColor,{color:"danger"},((e,t)=>i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.searchLimitExceededLabel",{values:{totalItems:e,maxItems:1e3},defaultMessage:"More than {totalItems} rule executions match filters provided. Showing first {maxItems} by most recent '@timestamp'. Constrain filters further to view additional execution events."}))(ce))))),c.a.createElement(Ut.d,null,c.a.createElement(Ut.c,null,c.a.createElement(Ut.e,{dataTestSubj:"lastUpdated"},m.getLastUpdated({showUpdating:ie||ae,updatedAt:ne})),c.a.createElement(Rn,{label:Zt,checked:w,compressed:!0,onChange:e=>he(e.target.checked)})))),c.a.createElement(a.EuiBasicTable,{columns:ke,items:oe,loading:ae,sorting:Ee,pagination:ve,onChange:de}));var Se},qn=c.a.memo(Ln);qn.displayName="ExecutionLogTable";var Bn=n(416),zn=n(886);i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.pageTitle",{defaultMessage:"Rule details"});const $n=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.backToRulesButton",{defaultMessage:"Rules"}),Vn=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.enableRuleLabel",{defaultMessage:"Enable"}),Un=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.unknownDescription",{defaultMessage:"Unknown"}),Hn=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExceptionsTab",{defaultMessage:"Rule exceptions"}),Gn=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.endpointExceptionsTab",{defaultMessage:"Endpoint exceptions"}),Qn=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionResultsTab",{defaultMessage:"Execution results"}),Wn=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionEventsTab",{defaultMessage:"Execution events"}),Kn=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.deletedRule",{defaultMessage:"Deleted rule"});var Yn=n(843),Jn=n(587),Xn=n(612),Zn=n(888),ea=n(683),ta=n(220),na=n(172),aa=n(207);const ia=i.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.noSearchResultsPromptTitle",{defaultMessage:"No results match your search criteria"}),ra=i.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.noSearchResultsPromptBody",{defaultMessage:"Try modifying your search."}),oa=i.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.addExceptionsEmptyPromptTitle",{defaultMessage:"Add exceptions to this rule"}),sa=i.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.emptyPromptBody",{defaultMessage:"There are no exceptions for this rule. Create your first rule exception."}),la=i.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.endpoint.emptyPromptBody",{defaultMessage:"There are no endpoint exceptions. Create your first endpoint exception."}),ca=i.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.emptyPromptButtonLabel",{defaultMessage:"Add rule exception"}),ua=i.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.endpoint.emptyPromptButtonLabel",{defaultMessage:"Add endpoint exception"}),da=i.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.exceptionItemsFetchError",{defaultMessage:"Unable to load exception items"}),pa=i.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.exceptionItemsFetchErrorDescription",{defaultMessage:"There was an error loading the exception items. Contact your administrator for help."}),ma=i.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.exceptionItemSearchErrorTitle",{defaultMessage:"Error searching"}),ga=i.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.exceptionItemSearchErrorBody",{defaultMessage:"An error occurred searching for exception items. Please try again."}),fa=i.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.exceptionDeleteErrorTitle",{defaultMessage:"Error deleting exception item"}),ba=i.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.paginationAriaLabel",{defaultMessage:"Exception item table pagination"}),ya=i.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.exceptionItemDeleteSuccessTitle",{defaultMessage:"Exception deleted"}),ha=i.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.exceptionEndpointDetailsDescription",{defaultMessage:"Endpoint exceptions are added to both the detection rule and the Elastic Endpoint agent on your hosts."}),va=i.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.exceptionDetectionDetailsDescription",{defaultMessage:"Rule exceptions are added to the detection rule."}),Ea=i.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.searchPlaceholder",{defaultMessage:'Filter exceptions using simple query syntax, for example, name:"my list"'}),xa=i.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.addToEndpointListLabel",{defaultMessage:"Add endpoint exception"}),ka=i.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.addToDetectionsListLabel",{defaultMessage:"Add rule exception"}),Sa={strict:!0,fields:{created_by:{type:"string"},description:{type:"string"},id:{type:"string"},item_id:{type:"string"},list_id:{type:"string"},name:{type:"string"},os_types:{type:"string"},tags:{type:"string"}}},wa=({canAddException:e,isEndpoint:t,isSearching:n,onSearch:i,onAddExceptionClick:r})=>{const o=Object(l.useCallback)((({queryText:e})=>{i({search:e})}),[i]),s=Object(l.useCallback)((()=>{r()}),[r]),u=Object(l.useMemo)((()=>t?xa:ka),[t]);return c.a.createElement(a.EuiFlexGroup,{alignItems:"center"},c.a.createElement(a.EuiFlexItem,{grow:!0},c.a.createElement(a.EuiSearchBar,{box:{placeholder:Ea,incremental:!0,schema:Sa,"data-test-subj":"exceptionsViewerSearchBar"},filters:[],onChange:o})),!e&&c.a.createElement(a.EuiFlexItem,{grow:!1},c.a.createElement(a.EuiButton,{"data-test-subj":"exceptionsHeaderAddExceptionBtn",onClick:s,isDisabled:n,fill:!0},u)))};wa.displayName="ExceptionsViewerSearchBarComponent";const ja=c.a.memo(wa);ja.displayName="ExceptionsViewerSearchBar";const Oa=({pagination:e,onPaginationChange:t})=>{var n;const i=Object(l.useCallback)((n=>{t({pagination:{page:e.pageIndex,perPage:n}})}),[t,e.pageIndex]),r=Object(l.useCallback)((n=>{t({pagination:{page:n,perPage:e.pageSize}})}),[t,e.pageSize]);return c.a.createElement(a.EuiTablePagination,{"aria-label":ba,pageCount:null!==(n=Math.ceil(e.totalItemCount/e.pageSize))&&void 0!==n?n:0,activePage:e.pageIndex,onChangePage:r,itemsPerPage:e.pageSize,onChangeItemsPerPage:i,itemsPerPageOptions:e.pageSizeOptions,"data-test-subj":"allExceptionItemsPagination"})};Oa.displayName="ExceptionsViewerPaginationComponent";const Ia=c.a.memo(Oa);Ia.displayName="ExceptionsViewerPagination";const Ta=m.a.span.withConfig({displayName:"StyledText",componentId:"sc-kgjjyi-0"})(["font-weight:bold;"]),Ca=m()(a.EuiFlexGroup).withConfig({displayName:"MyUtilities",componentId:"sc-kgjjyi-1"})(["height:50px;"]),Ma=m.a.span.withConfig({displayName:"StyledCondition",componentId:"sc-kgjjyi-2"})(["display:inline-block !important;vertical-align:middle !important;"]),Na=({pagination:e,lastUpdated:t})=>c.a.createElement(Ca,{alignItems:"center",justifyContent:"spaceBetween"},c.a.createElement(a.EuiFlexItem,{grow:!1},c.a.createElement(Ut.a,null,c.a.createElement(Ut.d,null,c.a.createElement(Ut.c,null,c.a.createElement(Ut.e,{dataTestSubj:"exceptionsShowing"},c.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.exceptions.viewer.paginationDetails",defaultMessage:"Showing {partOne} of {partTwo}",values:{partOne:c.a.createElement(Ta,null,`1-${Math.min(e.pageSize,e.totalItemCount)}`),partTwo:c.a.createElement(Ta,null,`${e.totalItemCount}`)}})))))),c.a.createElement(a.EuiFlexItem,{grow:!1},c.a.createElement(a.EuiText,{size:"s","data-test-subj":"exceptionsViewerLastUpdated"},c.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.exceptions.viewer.lastUpdated",defaultMessage:"Updated {updated}",values:{updated:c.a.createElement(Ma,null,c.a.createElement(S.b,{value:t,tooltipAnchorClassName:"eui-textTruncate"}))}}))));Na.displayName="ExceptionsViewerUtilityComponent";const Da=c.a.memo(Na);Da.displayName="ExceptionsViewerUtility";var Fa=n(190);const Aa=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.editItemButton",{defaultMessage:"Edit rule exception"}),_a=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.deleteItemButton",{defaultMessage:"Delete rule exception"}),Ra=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.endpoint.editItemButton",{defaultMessage:"Edit endpoint exception"}),Pa=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.endpoint.deleteItemButton",{defaultMessage:"Delete endpoint exception"}),La=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.createdLabel",{defaultMessage:"Created"}),qa=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.updatedLabel",{defaultMessage:"Updated"}),Ba=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.metaDetailsBy",{defaultMessage:"by"}),za=e=>i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.showCommentsLabel",{values:{comments:e},defaultMessage:"Show {comments, plural, =1 {comment} other {comments}} ({comments})"}),$a=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.matchOperator",{defaultMessage:"IS"}),Va=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.matchOperator.not",{defaultMessage:"IS NOT"}),Ua=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.wildcardMatchesOperator",{defaultMessage:"MATCHES"}),Ha=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.wildcardDoesNotMatchOperator",{defaultMessage:"DOES NOT MATCH"}),Ga=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.nestedOperator",{defaultMessage:"has"}),Qa=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.matchAnyOperator",{defaultMessage:"is one of"}),Wa=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.matchAnyOperator.not",{defaultMessage:"is not one of"}),Ka=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.existsOperator",{defaultMessage:"exists"}),Ya=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.existsOperator.not",{defaultMessage:"does not exist"}),Ja=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.listOperator",{defaultMessage:"included in"}),Xa=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.listOperator.not",{defaultMessage:"is not included in"}),Za=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.and",{defaultMessage:"AND"}),ei=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.os",{defaultMessage:"OS"}),ti=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.windows",{defaultMessage:"Windows"}),ni=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.linux",{defaultMessage:"Linux"}),ai=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.macos",{defaultMessage:"Mac"}),ii=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.affectedList",{defaultMessage:"Affects shared list"}),ri=Object(l.memo)((({item:e,actions:t,disableActions:n=!1,dataTestSubj:i})=>{const[r,o]=Object(l.useState)(!1),s=()=>o(!1),u=Object(l.useMemo)((()=>t.map((e=>c.a.createElement(a.EuiContextMenuItem,{"data-test-subj":`${i}-actionItem-${e.key}`,key:e.key,icon:e.icon,onClick:()=>{s(),e.onClick()}},e.label)))),[i,t]);return c.a.createElement(a.EuiFlexGroup,{"data-test-subj":i,justifyContent:"spaceBetween"},c.a.createElement(a.EuiFlexItem,{grow:9},c.a.createElement(a.EuiTitle,{size:"xs",textTransform:"uppercase","data-test-subj":`${i}-title`},c.a.createElement("h3",null,e.name))),c.a.createElement(a.EuiFlexItem,{grow:!1},c.a.createElement(a.EuiPopover,{button:c.a.createElement(a.EuiButtonIcon,{isDisabled:n,"aria-label":"Exception item actions menu",iconType:"boxesHorizontal",onClick:()=>o((e=>!e)),"data-test-subj":`${i}-actionButton`}),panelPaddingSize:"none",isOpen:r,closePopover:s,"data-test-subj":`${i}-items`},c.a.createElement(a.EuiContextMenuPanel,{size:"s",items:u}))))}));ri.displayName="ExceptionItemCardHeader";var oi=n(265);const si=m.a.div.withConfig({displayName:"Container",componentId:"sc-hgc2b-0"})(["display:inline;margin-left:",";"],(({theme:e})=>`${e.eui.euiSizeXS}`)),li=({value:e,tooltipIconType:t="iInCircle",tooltipIconText:n})=>{const{showSpaceWarningIcon:i,warningText:r}=(({value:e,tooltipIconText:t})=>({showSpaceWarningIcon:!!(Array.isArray(e)?e.find(oi.d):Object(oi.d)(e)),warningText:t||oi.c.FIELD_SPACE_WARNING}))({value:e,tooltipIconText:n});return i&&e?c.a.createElement(si,null,c.a.createElement(a.EuiToolTip,{position:"top",content:r},c.a.createElement(a.EuiIcon,{"data-test-subj":"value_with_space_warning_tooltip",type:t,color:"warning"}))):null},ci=Object.freeze({linux:ni,mac:ai,macos:ai,windows:ti}),ui=Object.freeze({[g.d.NESTED]:Ga,[g.d.MATCH_ANY]:Qa,[g.d.MATCH]:$a,[g.d.WILDCARD]:Ua,[g.d.EXISTS]:Ka,[g.d.LIST]:Ja}),di=Object.freeze({[g.d.MATCH_ANY]:Wa,[g.d.MATCH]:Va,[g.d.WILDCARD]:Ha,[g.d.EXISTS]:Ya,[g.d.LIST]:Xa}),pi=m()(a.EuiFlexGroup).withConfig({displayName:"EuiFlexGroupNested",componentId:"sc-ob4wzw-0"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeXL)),mi=m()(a.EuiFlexItem).withConfig({displayName:"EuiFlexItemNested",componentId:"sc-ob4wzw-1"})(["margin-bottom:6px !important;margin-top:6px !important;"]),gi=m()("span").withConfig({displayName:"StyledCondition",componentId:"sc-ob4wzw-2"})(["margin-right:6px;"]),fi=m()(a.EuiPanel).withConfig({displayName:"StyledConditionContent",componentId:"sc-ob4wzw-3"})(["border:1px;border-color:#d3dae6;border-style:solid;"]),bi=Object(l.memo)((({os:e,entries:t,dataTestSubj:n})=>{const i=Object(l.useMemo)((()=>null!=e&&e.length>0?e.map((e=>{var t;return null!==(t=ci[e])&&void 0!==t?t:e})).join(", "):null),[e]),r=(e,t)=>"match_any"===e&&Array.isArray(t)?t.map((e=>c.a.createElement(a.EuiBadge,{color:"hollow"},e))):null!=t?t:"",o=(e,t)=>{var n,a;return"nested"===e?"":"included"===t?null!==(n=ui[e])&&void 0!==n?n:e:null!==(a=di[e])&&void 0!==a?a:e},s=Object(l.useCallback)(((e,t)=>{if("nested"===e&&t.length)return t.map((e=>{const{field:t,type:i,operator:s}=e,l="value"in e?e.value:"";return c.a.createElement(pi,{"data-test-subj":`${n}-nestedCondition`,key:t+i+l,direction:"row",alignItems:"center",gutterSize:"m",responsive:!1},c.a.createElement(mi,{grow:!1},c.a.createElement(a.EuiToken,{iconType:"tokenNested",size:"s"})),c.a.createElement(mi,{grow:!1},c.a.createElement(a.EuiExpression,{description:"",value:t,color:"subdued"})),c.a.createElement(mi,{grow:!1},c.a.createElement(a.EuiExpression,{description:o(i,s),value:r(i,l)})),c.a.createElement(li,{value:l}))}))}),[n]),u=Object(l.useCallback)((e=>"list"===e.type?e.list.id:"value"in e?e.value:""),[]);return c.a.createElement(fi,{color:"subdued",hasBorder:!0,hasShadow:!1,"data-test-subj":n},null!=i&&c.a.createElement("div",{"data-test-subj":`${n}-os`},c.a.createElement("strong",null,c.a.createElement(a.EuiExpression,{description:"",value:ei}),c.a.createElement(a.EuiExpression,{description:$a,value:i}))),t.map(((e,t)=>{const{field:i,type:l}=e,d=u(e),p="entries"in e?e.entries:[],m="operator"in e?e.operator:"";return c.a.createElement("div",{"data-test-subj":`${n}-condition`,key:i+l+d+t},c.a.createElement("div",{className:"eui-xScroll"},c.a.createElement(a.EuiExpression,{description:0===t?"":c.a.createElement(gi,null,Za),value:i,color:0===t?"primary":"subdued"}),c.a.createElement(a.EuiExpression,{description:o(l,m),value:r(l,d)}),c.a.createElement(li,{value:d})),null!=p&&s(l,p))})))}));bi.displayName="ExceptionItemCardConditions";var yi=n(89);const hi=m()(a.EuiFlexItem).withConfig({displayName:"StyledFlexItem",componentId:"sc-16r4vsz-0"})(["border-right:1px solid #d3dae6;padding:4px 12px 4px 0;"]),vi=Object(l.memo)((({item:e,listAndReferences:t,dataTestSubj:n})=>{const[r,o]=Object(l.useState)(!1),[s,u]=Object(l.useState)(!1),d=()=>u((e=>!e)),p=()=>o((e=>!e)),m=()=>u(!1),f=()=>o(!1),b=Object(l.useMemo)((()=>null==t?[]:t.referenced_rules.map((e=>c.a.createElement(a.EuiContextMenuItem,{"data-test-subj":`${n}-rulesAffected-${e.id}`,key:e.id},c.a.createElement(a.EuiToolTip,{content:e.name,anchorClassName:"eui-textTruncate"},c.a.createElement(yi.k,{"data-test-subj":"ruleName",deepLinkId:le.uc.rules,path:Object(O.c)(e.id,Gi.alerts),external:!0},e.name)))))),[t,n]),y=Object(l.useMemo)((()=>{var e,r;return null==t?c.a.createElement(c.a.Fragment,null):c.a.createElement(hi,{grow:!1},c.a.createElement(a.EuiPopover,{button:c.a.createElement(a.EuiButtonEmpty,{onClick:d,iconType:"list","data-test-subj":`${n}-affectedRulesButton`},(r=null!==(e=null==t?void 0:t.referenced_rules.length)&&void 0!==e?e:0,i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.affectedRules",{values:{numRules:r},defaultMessage:"Affects {numRules} {numRules, plural, =1 {rule} other {rules}}"}))),panelPaddingSize:"none",isOpen:s,closePopover:m,"data-test-subj":`${n}-rulesPopover`,id:"rulesPopover"},c.a.createElement(a.EuiContextMenuPanel,{size:"s",items:b})))}),[t,n,s,b]),h=Object(l.useMemo)((()=>null==t?c.a.createElement(c.a.Fragment,null):t.type!==g.b.RULE_DEFAULT?c.a.createElement(a.EuiFlexItem,{grow:!1},c.a.createElement(a.EuiPopover,{button:c.a.createElement(a.EuiButtonEmpty,{onClick:p,iconType:"list","data-test-subj":`${n}-affectedListsButton`},ii),panelPaddingSize:"none",isOpen:r,closePopover:f,"data-test-subj":`${n}-listsPopover`,id:"listsPopover"},c.a.createElement(a.EuiContextMenuPanel,{size:"s",items:[c.a.createElement(a.EuiContextMenuItem,{"data-test-subj":`${n}-listsAffected-${t.id}`,key:t.id},c.a.createElement(a.EuiToolTip,{content:t.name,anchorClassName:"eui-textTruncate"},c.a.createElement(yi.k,{"data-test-subj":"ruleName",deepLinkId:le.uc.exceptions,path:`/details/${null==t?void 0:t.list_id}`,external:!0},t.name)))]}))):c.a.createElement(c.a.Fragment,null)),[t,n,r]);return c.a.createElement(a.EuiFlexGroup,{alignItems:"center",responsive:!1,gutterSize:"s","data-test-subj":n},c.a.createElement(hi,{grow:!1},c.a.createElement(Ei,{fieldName:"created_by",label:La,value1:c.a.createElement(S.a,{fieldName:"created_at",value:e.created_at}),value2:e.created_by,dataTestSubj:`${n}-createdBy`})),c.a.createElement(hi,{grow:!1},c.a.createElement(Ei,{fieldName:"updated_by",label:qa,value1:c.a.createElement(S.a,{fieldName:"updated_at",value:e.updated_at}),value2:e.updated_by,dataTestSubj:`${n}-updatedBy`})),null!=t&&c.a.createElement(c.a.Fragment,null,y,h))}));vi.displayName="ExceptionItemCardMetaInfo";const Ei=Object(l.memo)((({label:e,value1:t,value2:n,dataTestSubj:i})=>c.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"s",wrap:!1,responsive:!1},c.a.createElement(a.EuiFlexItem,{grow:!1},c.a.createElement(a.EuiText,{size:"xs",style:{fontFamily:"Inter"}},e)),c.a.createElement(a.EuiFlexItem,{grow:!1,"data-test-subj":`${i}-value1`},c.a.createElement(a.EuiBadge,{color:"default",style:{fontFamily:"Inter"}},t)),c.a.createElement(a.EuiFlexItem,{grow:!1},c.a.createElement(a.EuiText,{size:"xs",style:{fontFamily:"Inter"}},Ba)),c.a.createElement(a.EuiFlexItem,{grow:!1,"data-test-subj":`${i}-value2`},c.a.createElement(a.EuiFlexGroup,{responsive:!1,gutterSize:"xs",alignItems:"center",wrap:!1},c.a.createElement(a.EuiFlexItem,{grow:!1},c.a.createElement(a.EuiBadge,{color:"hollow",style:{fontFamily:"Inter"}},n)))))));Ei.displayName="MetaInfoDetails";const xi=Object(l.memo)((({comments:e})=>{const{euiTheme:t}=Object(a.useEuiTheme)();return c.a.createElement(a.EuiFlexItem,null,c.a.createElement(a.EuiAccordion,{id:"exceptionItemCardComments",buttonContent:c.a.createElement(a.EuiText,{size:"s",style:{color:t.colors.primary}},za(e.length)),arrowDisplay:"none","data-test-subj":"exceptionsViewerCommentAccordion"},c.a.createElement(a.EuiPanel,{hasBorder:!1,hasShadow:!1,paddingSize:"m"},c.a.createElement(a.EuiCommentList,{comments:e}))))}));xi.displayName="ExceptionItemCardComments";const ki=({disableActions:e,exceptionItem:t,isEndpoint:n,listAndReferences:i,onDeleteException:r,onEditException:o,dataTestSubj:s})=>{const u=Object(l.useCallback)((()=>{r({id:t.id,name:t.name,namespaceType:t.namespace_type})}),[r,t.id,t.name,t.namespace_type]),d=Object(l.useCallback)((()=>{o(t)}),[o,t]),p=Object(l.useMemo)((()=>Object(Fa.j)(t.comments)),[t.comments]);return c.a.createElement(a.EuiPanel,{paddingSize:"l","data-test-subj":s,hasBorder:!0,hasShadow:!1},c.a.createElement(a.EuiFlexGroup,{gutterSize:"m",direction:"column"},c.a.createElement(a.EuiFlexItem,{"data-test-subj":`${s}-header`},c.a.createElement(ri,{item:t,actions:[{key:"edit",icon:"controlsHorizontal",label:n?Ra:Aa,onClick:d},{key:"delete",icon:"trash",label:n?Pa:_a,onClick:u}],disableActions:e,dataTestSubj:"exceptionItemCardHeader"})),c.a.createElement(a.EuiFlexItem,{"data-test-subj":`${s}-meta`},c.a.createElement(vi,{item:t,listAndReferences:i,dataTestSubj:"exceptionItemCardMetaInfo"})),c.a.createElement(a.EuiFlexItem,null,c.a.createElement(bi,{os:t.os_types,entries:t.entries,dataTestSubj:"exceptionItemCardConditions"})),p.length>0&&c.a.createElement(xi,{comments:p})))};ki.displayName="ExceptionItemCardComponent";const Si=c.a.memo(ki);Si.displayName="ExceptionItemCard";var wi=n(1065),ji=n.n(wi);const Oi=({isReadOnly:e,isEndpoint:t,currentState:n,onCreateExceptionListItem:i})=>{const{euiTheme:r}=Object(a.useEuiTheme)(),o=Object(l.useMemo)((()=>{switch(n){case"error":return c.a.createElement(a.EuiEmptyPrompt,{color:"danger",iconType:"alert",title:c.a.createElement("h2",null,da),body:c.a.createElement("p",null,pa),"data-test-subj":"exceptionItemViewerEmptyPrompts-error"});case"empty":return c.a.createElement(a.EuiEmptyPrompt,{color:"subdued",iconType:"plusInCircle",iconColor:r.colors.darkestShade,title:c.a.createElement("h2",{"data-test-subj":"exceptionsEmptyPromptTitle"},oa),body:c.a.createElement("p",{"data-test-subj":"exceptionsEmptyPromptBody"},t?la:sa),actions:[c.a.createElement(a.EuiButton,{"data-test-subj":"exceptionsEmptyPromptButton",onClick:i,iconType:"plusInCircle",color:"primary",isDisabled:e,fill:!0},t?ua:ca)],"data-test-subj":"exceptionItemViewerEmptyPrompts-empty"});case"empty_search":return c.a.createElement(a.EuiEmptyPrompt,{color:"plain",layout:"horizontal",hasBorder:!0,hasShadow:!1,icon:c.a.createElement(a.EuiImage,{size:"fullWidth",alt:"",url:ji.a}),title:c.a.createElement("h3",null,ia),body:c.a.createElement("p",null,ra),"data-test-subj":"exceptionItemViewerEmptyPrompts-emptySearch"});default:return c.a.createElement(a.EuiLoadingContent,{lines:4,"data-test-subj":"exceptionItemViewerEmptyPrompts-loading"})}}),[n,r.colors.darkestShade,e,t,i]);return c.a.createElement(a.EuiPanel,{hasShadow:!1,hasBorder:!1,color:"empty_search"===n?"subdued":"transparent",style:{margin:`${r.size.l} 0`,padding:`${r.size.l} 0`}},o)},Ii=c.a.memo(Oi);Ii.displayName="ExeptionItemsViewerEmptyPrompts";const Ti=m()(a.EuiFlexItem).withConfig({displayName:"MyFlexItem",componentId:"sc-1ti6dq3-0"})(["margin:",";&:first-child{margin:",";}"],(({theme:e})=>`${e.eui.euiSize} 0`),(({theme:e})=>`${e.eui.euiSizeXS} 0 ${e.eui.euiSize}`)),Ci=({isReadOnly:e,exceptions:t,isEndpoint:n,disableActions:i,ruleReferences:r,viewerState:o,onCreateExceptionListItem:s,onDeleteException:l,onEditExceptionItem:u})=>c.a.createElement(c.a.Fragment,null,null!=o&&"deleting"!==o?c.a.createElement(Ii,{isReadOnly:e,isEndpoint:n,currentState:o,onCreateExceptionListItem:s}):c.a.createElement(a.EuiFlexGroup,{direction:"column",className:"eui-yScrollWithShadows"},c.a.createElement(a.EuiFlexItem,{grow:!1,className:"eui-yScrollWithShadows"},c.a.createElement(a.EuiFlexGroup,{"data-test-subj":"exceptionsContainer",gutterSize:"none",direction:"column"},t.map((e=>c.a.createElement(Ti,{"data-test-subj":"exceptionItemContainer",grow:!1,key:e.id},c.a.createElement(Si,{disableActions:i,exceptionItem:e,isEndpoint:n,listAndReferences:null!=r?r[e.list_id]:null,onDeleteException:l,onEditException:u,dataTestSubj:"exceptionItemsViewerItem"}))))))));Ci.displayName="ExceptionItemsViewerComponent";const Mi=c.a.memo(Ci);Mi.displayName="ExceptionsViewerItems";var Ni=n(505),Di=n(345),Fi=n(657);const Ai=m()(a.EuiText).withConfig({displayName:"StyledText",componentId:"sc-e71zkm-0"})(["font-style:italic;"]),_i=["error","empty"],Ri=["loading","empty_search","empty","error","searching"],Pi={pagination:{pageIndex:0,pageSize:25,totalItemCount:0,pageSizeOptions:[5,10,25,50,100,200,300]},exceptions:[],exceptionToEdit:null,currenFlyout:null,viewerState:"loading",isReadOnly:!0,lastUpdated:Date.now()},Li=({rule:e,listTypes:t,isViewReadOnly:n,onRuleChange:r})=>{const{services:o}=Object(E.k)(),s=Object(E.o)(),[{canUserCRUD:u,hasIndexWrite:d}]=Object(X.b)(),p=Object(l.useMemo)((()=>null!=e&&null!=e.exceptions_list?e.exceptions_list.filter((({type:e})=>t.includes(e))):[]),[t,e]),m=Object(l.useMemo)((()=>p.map((({id:e,list_id:t,namespace_type:n})=>({id:e,listId:t,namespaceType:n})))),[p]),f=Object(l.useMemo)((()=>1===t.length&&t[0]===g.b.ENDPOINT),[t]),[{exceptions:b,pagination:y,currenFlyout:h,exceptionToEdit:v,viewerState:x,isReadOnly:k,lastUpdated:S},w]=Object(l.useReducer)(((e,t)=>{switch(t.type){case"setExceptions":{var n;const{exceptions:a,pagination:i}=t;return{...e,pagination:{...e.pagination,pageIndex:i.page-1,pageSize:i.perPage,totalItemCount:null!==(n=i.total)&&void 0!==n?n:0},exceptions:a}}case"updateExceptionToEdit":{const{exception:n}=t;return{...e,exceptionToEdit:n}}case"updateFlyoutOpen":return{...e,currenFlyout:t.flyoutType};case"setViewerState":return{...e,viewerState:t.state};case"setIsReadOnly":return{...e,isReadOnly:t.readOnly};case"setLastUpdateTime":return{...e,lastUpdated:t.lastUpdate};default:return e}}),{...Pi}),j=Object(l.useCallback)((e=>{w({type:"setLastUpdateTime",lastUpdate:e})}),[w]),O=Object(l.useCallback)((({exceptions:e,pagination:t})=>{j(Date.now()),w({type:"setExceptions",exceptions:e,pagination:t})}),[w,j]),I=Object(l.useCallback)((e=>{w({type:"setViewerState",state:e})}),[w]),T=Object(l.useCallback)((e=>{w({type:"updateFlyoutOpen",flyoutType:e})}),[w]),C=Object(l.useCallback)((e=>{w({type:"setIsReadOnly",readOnly:e})}),[w]),[M,N,D,F]=Object(Fi.a)();Object(l.useEffect)((()=>{null!=F&&m.length&&F(m)}),[m,F]),Object(l.useEffect)((()=>{N?I("error"):null==x&&M?I("loading"):"loading"!==x||M||I(null)}),[M,N,I,x]);const A=Object(l.useCallback)((async e=>{var t;const n=new AbortController,a=null!=(null==e?void 0:e.pagination)?{page:(null!==(t=e.pagination.page)&&void 0!==t?t:0)+1,perPage:e.pagination.perPage}:{page:y.pageIndex+1,perPage:y.pageSize};if(0===p.length)return{data:[],pageIndex:y.pageIndex,itemsPerPage:y.pageSize,total:0};const{page:i,per_page:r,total:s,data:l}=await Object(aa.l)({filter:void 0,http:o.http,listIds:p.map((e=>e.list_id)),namespaceTypes:p.map((e=>e.namespace_type)),search:null==e?void 0:e.search,pagination:a,signal:n.signal});return{data:l.map((e=>Object(na.b)(e))),pageIndex:i,itemsPerPage:r,total:s}}),[y.pageIndex,y.pageSize,p,o.http]),_=Object(l.useCallback)((async e=>{try{const{pageIndex:t,itemsPerPage:n,total:a,data:i}=await A(e);I(a>0?null:"empty"),O({exceptions:i,pagination:{page:t,perPage:n,total:a}}),I(a>0?null:"empty")}catch(e){I("error"),s.addError(e,{title:da,toastMessage:pa})}}),[A,O,I,s]),R=Object(l.useCallback)((async e=>{try{I("searching");const{pageIndex:t,itemsPerPage:n,total:a,data:i}=await A(e);I(a>0?null:"empty_search"),O({exceptions:i,pagination:{page:t,perPage:n,total:a}})}catch(e){s.addError(e,{title:ma,toastMessage:ga})}}),[A,O,I,s]),P=Object(l.useCallback)((()=>{T("addException")}),[T]),L=Object(l.useCallback)((e=>{w({type:"updateExceptionToEdit",exception:e}),T("editException")}),[T]),q=Object(l.useCallback)((e=>{T(null),e&&null!=r&&r()}),[r,T]),B=Object(l.useCallback)((e=>{T(null),e&&null!=r&&r(),_()}),[T,_,r]),z=Object(l.useCallback)((async({id:e,name:t,namespaceType:n})=>{const a=new AbortController;try{I("deleting"),await Object(aa.e)({http:o.http,id:e,namespaceType:n,signal:a.signal}),s.addSuccess({title:ya,text:(r=t,i.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.exceptionItemDeleteSuccessText",{values:{itemName:r},defaultMessage:'"{itemName}" deleted successfully.'}))}),await _()}catch(e){I("error"),s.addError(e,{title:fa})}var r}),[_,o.http,I,s]);Object(l.useEffect)((()=>{C(n||!u||!d)}),[C,n,u,d]),Object(l.useEffect)((()=>{p.length>0?_():I("empty")}),[p.length,_,I]);const $=Object(l.useMemo)((()=>null!=D&&null!=v?D[v.list_id]:null),[D,v]);return c.a.createElement(c.a.Fragment,null,"editException"===h&&null!=$&&null!=v&&null!=e&&c.a.createElement(Ni.a,{rule:e,list:$,itemToEdit:v,showAlertCloseOptions:!0,onCancel:q,onConfirm:B,"data-test-subj":"editExceptionItemFlyout"}),"addException"===h&&null!=e&&c.a.createElement(Di.a,{rules:[e],isBulkAction:!1,isEndpointItem:f,onCancel:q,onConfirm:B,"data-test-subj":"addExceptionItemFlyout",showAlertCloseOptions:!0,isNonTimeline:!0}),c.a.createElement(a.EuiPanel,{hasBorder:!1,hasShadow:!1},c.a.createElement(c.a.Fragment,null,c.a.createElement(Ai,{size:"s"},f?ha:va),c.a.createElement(a.EuiSpacer,{size:"l"}),!_i.includes(x)&&c.a.createElement(ja,{canAddException:k,isEndpoint:f,isSearching:"searching"===x,onSearch:R,onAddExceptionClick:P}),!Ri.includes(x)&&c.a.createElement(c.a.Fragment,null,c.a.createElement(a.EuiSpacer,{size:"l"}),c.a.createElement(Da,{pagination:y,lastUpdated:S})),c.a.createElement(Mi,{isReadOnly:k,disableActions:k||"deleting"===x,exceptions:b,isEndpoint:f,ruleReferences:D,viewerState:x,onDeleteException:z,onEditExceptionItem:L,onCreateExceptionListItem:P}),!Ri.includes(x)&&c.a.createElement(Ia,{onPaginationChange:_,pagination:y}))))};Li.displayName="ExceptionsViewerComponent";const qi=c.a.memo(Li);function Bi({ruleId:e,disabled:t=!1,disabledReason:n}){const{application:{navigateToApp:i}}=Object(E.k)().services,r=Object(l.useCallback)((t=>{t.preventDefault(),i(le.B,{deepLinkId:Oe.a.rules,path:Object(O.b)(e)})}),[i,e]);return c.a.createElement(a.EuiToolTip,{position:"top",content:n},c.a.createElement(yi.l,{"data-test-subj":"editRuleSettingsLink",onClick:r,iconType:"controlsHorizontal",isDisabled:t,deepLinkId:Oe.a.rules,path:Object(O.b)(e)},he.Bb))}qi.displayName="ExceptionsViewer";var zi=n(828),$i=n(889),Vi=n(890);const Ui=m.a.div.withConfig({displayName:"StyledFullHeightContainer",componentId:"sc-1m4bij9-0"})(["display:flex;flex-direction:column;flex:1 1 auto;"]),Hi=m.a.div.withConfig({displayName:"StyledMinHeightTabContainer",componentId:"sc-1m4bij9-1"})(["min-height:800px;"]);let Gi;!function(e){e.alerts="alerts",e.exceptions="rule_exceptions",e.endpointExceptions="endpoint_exceptions",e.executionResults="execution_results",e.executionEvents="execution_events"}(Gi||(Gi={}));const Qi={[Gi.alerts]:Bn.a,[Gi.exceptions]:Hn,[Gi.endpointExceptions]:Gn,[Gi.executionResults]:Qn,[Gi.executionEvents]:Wn},Wi=({clearEventsDeleted:e,clearEventsLoading:t,clearSelected:n})=>{var p,m,N,D,F;const{data:A,application:{navigateToApp:_,capabilities:{actions:R}},timelines:P,spaces:L}=Object(E.k)().services,q=Object(d.useDispatch)(),B=Object(l.useRef)(null),z=Object(l.useMemo)((()=>j.b.getTableByIdSelector()),[]),$=Object(v.b)((e=>{var t;return(null!==(t=z(e,x.g.alertsOnRuleDetailsPage))&&void 0!==t?t:w.a).graphEventId})),V=Object(v.b)((e=>{var t;return(null!==(t=z(e,x.g.alertsOnRuleDetailsPage))&&void 0!==t?t:w.a).updated})),U=Object(v.b)((e=>{var t;return(null!==(t=z(e,x.g.alertsOnAlertsPage))&&void 0!==t?t:w.a).isLoading})),H=Object(l.useMemo)((()=>oe.d.globalFiltersQuerySelector()),[]),G=Object(l.useMemo)((()=>oe.d.globalQuerySelector()),[]),Q=Object(v.a)(G),W=Object(v.a)(H),{to:ce,from:ue}=Object(re.a)(),[{loading:de,isSignalIndexExists:pe,isAuthenticated:me,hasEncryptionKey:fe,canUserCRUD:be,hasIndexWrite:ye,hasIndexRead:ve,hasIndexMaintenance:Ee,signalIndexName:xe}]=Object(X.b)(),{loading:Fe,needsConfiguration:Ae}=Object(C.a)(),{indexPattern:Re,runtimeMappings:Pe,loading:Le}=Object(Me.d)(Ne.SourcererScopeName.detections),qe=de||Fe,{detailName:Be}=Object(u.useParams)(),{rule:ze,refresh:$e,loading:Ve,isExistingRule:Ue}=Object(Xn.a)(Be),{pollForSignalIndex:He}=Object(ea.a)(),[Ge,Qe]=Object(l.useState)(null),We=Ve&&null==Ge,{starting:Ke,startMlJobs:Ye}=Object(zi.a)(),Je=Object(l.useCallback)((async()=>{await Ye(null==Ge?void 0:Ge.machine_learning_job_id)}),[Ge,Ye]),Xe=Object(l.useMemo)((()=>({[Gi.alerts]:{id:Gi.alerts,name:Qi[Gi.alerts],disabled:!1,href:`/rules/id/${Be}/${Gi.alerts}`},[Gi.exceptions]:{id:Gi.exceptions,name:Qi[Gi.exceptions],disabled:null==Ge,href:`/rules/id/${Be}/${Gi.exceptions}`},[Gi.endpointExceptions]:{id:Gi.endpointExceptions,name:Qi[Gi.endpointExceptions],disabled:null==Ge,href:`/rules/id/${Be}/${Gi.endpointExceptions}`},[Gi.executionResults]:{id:Gi.executionResults,name:Qi[Gi.executionResults],disabled:!Ue,href:`/rules/id/${Be}/${Gi.executionResults}`},[Gi.executionEvents]:{id:Gi.executionEvents,name:Qi[Gi.executionEvents],disabled:!Ue,href:`/rules/id/${Be}/${Gi.executionEvents}`}})),[Ue,Ge,Be]),[Ze,et]=Object(l.useState)(Xe),{aboutRuleData:tt,modifiedAboutRuleDetailsData:nt,defineRuleData:at,scheduleRuleData:it}=null!=Ge?Object(ie.g)({rule:Ge,detailsView:!0}):{aboutRuleData:null,modifiedAboutRuleDetailsData:null,defineRuleData:null,scheduleRuleData:null},[rt,ot]=Object(l.useState)();Object(l.useEffect)((()=>{(async()=>{if(null!=(null==at?void 0:at.dataViewId)&&""!==(null==at?void 0:at.dataViewId)){const e=await A.dataViews.get(null==at?void 0:at.dataViewId);ot(e.title)}})()}),[A.dataViews,null==at?void 0:at.dataViewId]);const[st,lt]=Object(l.useState)(!1),[ct,ut]=Object(l.useState)(!1),dt=Object(Se.a)(),{globalFullScreen:pt}=Object(Ie.a)(),[mt,gt]=Object(l.useState)(Zn.b),[ft,bt]=Object(l.useState)({}),{isSavedQueryLoading:yt,savedQueryBar:ht}=Object(zn.a)(null==Ge?void 0:Ge.saved_id,{ruleType:null==Ge?void 0:Ge.type}),[vt]=Object(E.q)(le.S),[Et]=Object(E.q)(le.eb);Object(l.useEffect)((()=>{(async()=>{const e=await A.dataViews.getIdsWithTitle();if(e.length>0){const t=e.reduce(((e,t)=>({...e,[t.id]:t})),{});bt(t)}})()}),[A.dataViews]);const xt=Object(je.a)(dt)&&Object(we.a)(dt),kt=Object(l.useMemo)((()=>!(null!=(null==Ge?void 0:Ge.actions)&&(null==Ge?void 0:Ge.actions.length)>0&&Object(ge.d)(R.show))||R.show),[R,null==Ge?void 0:Ge.actions]),St=Object(l.useCallback)((()=>{_(le.B,{deepLinkId:Oe.a.rules,path:Object(O.c)(null!=Be?Be:"","alerts","")})}),[_,Be]);Object(l.useEffect)((()=>{null!=ze&&Qe(ze)}),[ze]),Object(l.useEffect)((()=>{if(Ge){const e=Ge.outcome;if(L&&"aliasMatch"===e){const e=`rules/id/${Ge.id}${window.location.search}${window.location.hash}`;L.ui.redirectLegacyUrl({path:e,aliasPurpose:Ge.alias_purpose,objectNoun:i.i18n.translate("xpack.triggersActionsUI.sections.ruleDetails.redirectObjectNoun",{defaultMessage:"rule"})})}}}),[Ge,L]);const wt=Object(l.useMemo)((()=>{if(null!=(null==Ge?void 0:Ge.alias_target_id)&&L&&"conflict"===Ge.outcome){const e=Ge.alias_target_id,t=`rules/id/${e}${window.location.search}${window.location.hash}`;return c.a.createElement(c.a.Fragment,null,c.a.createElement(a.EuiSpacer,null),L.ui.components.getLegacyUrlConflict({objectNoun:i.i18n.translate("xpack.triggersActionsUI.sections.ruleDetails.redirectObjectNoun",{defaultMessage:"rule"}),currentObjectId:Ge.id,otherObjectId:e,otherObjectPath:t}))}return null}),[Ge,L]),jt=(()=>{const e=Object(_t.a)("extendedRuleExecutionLoggingEnabled"),t=Rt(le.Eb,!1),n=Rt(le.Fb,_e.c.off);return Object(l.useMemo)((()=>({extendedLogging:{isEnabled:e&&t,minLevel:n}})),[e,t,n])})();Object(l.useEffect)((()=>{const e=[];var t;(ve||e.push(Gi.alerts),jt.extendedLogging.isEnabled||e.push(Gi.executionEvents),null!=Ge)&&((null!==(t=Ge.exceptions_list)&&void 0!==t?t:[]).some((e=>e.type===g.b.ENDPOINT))||e.push(Gi.endpointExceptions));const n=Object(s.omit)(e,Xe);et(n)}),[ve,Ge,Xe,jt]);const Ot=Object(l.useMemo)((()=>Le||U||qe),[Le,U,qe]),It=Object(l.useMemo)((()=>c.a.createElement(c.a.Fragment,null,null==Ge?void 0:Ge.name," ",Ve&&c.a.createElement(a.EuiLoadingSpinner,{size:"m"}))),[Ge,Ve]),Tt=Object(l.useMemo)((()=>Ve||Ue?void 0:{text:Kn,color:"default"}),[Ue,Ve]),Ct=Object(l.useMemo)((()=>{var e,t,n,i;return Ge?[c.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.ruleDetails.ruleCreationDescription",defaultMessage:"Created by: {by} on {date}",values:{by:null!==(e=null==Ge?void 0:Ge.created_by)&&void 0!==e?e:Un,date:c.a.createElement(S.a,{value:null!==(t=null==Ge?void 0:Ge.created_at)&&void 0!==t?t:(new Date).toISOString(),fieldName:"createdAt"})}}),null!=(null==Ge?void 0:Ge.updated_by)?c.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.ruleDetails.ruleUpdateDescription",defaultMessage:"Updated by: {by} on {date}",values:{by:null!==(n=null==Ge?void 0:Ge.updated_by)&&void 0!==n?n:Un,date:c.a.createElement(S.a,{value:null!==(i=null==Ge?void 0:Ge.updated_at)&&void 0!==i?i:(new Date).toISOString(),fieldName:"updatedAt"})}}):""]:Ve?c.a.createElement(a.EuiLoadingSpinner,{size:"m"}):null}),[Ge,Ve]),Mt=Object(l.useCallback)((a=>{const i=x.g.alertsOnRuleDetailsPage;t({id:i}),e({id:i}),n({id:i}),gt(a)}),[t,e,n,gt]);Object(l.useEffect)((()=>{lt(null!=(null==Ge?void 0:Ge.building_block_type))}),[Ge]);const Nt=Object(l.useMemo)((()=>{var e;return[...Object(te.c)(null!==(e=null==Ge?void 0:Ge.rule_id)&&void 0!==e?e:""),...Object(te.d)(st),...Object(te.a)(mt),...Object(te.e)(ct)]}),[Ge,st,ct,mt]),Dt=Object(l.useMemo)((()=>{var e;return[...Object(te.c)(null!==(e=null==Ge?void 0:Ge.rule_id)&&void 0!==e?e:""),...Object(te.d)(st),...Object(te.e)(ct)]}),[Ge,st,ct]),At=Object(l.useMemo)((()=>[...Nt,...W]),[Nt,W]),Pt=null==Ge||null===(p=Ge.execution_summary)||void 0===p?void 0:p.last_execution,Lt=null==Pt?void 0:Pt.status,qt=null!==(m=null==Pt?void 0:Pt.date)&&void 0!==m?m:"",Bt=null!==(N=null==Pt?void 0:Pt.message)&&void 0!==N?N:"",zt=Object(l.useMemo)((()=>Ve?c.a.createElement(a.EuiFlexItem,null,c.a.createElement(a.EuiLoadingSpinner,{size:"m","data-test-subj":"rule-status-loader"})):c.a.createElement(De.a,{status:Lt,date:qt},c.a.createElement(a.EuiButtonIcon,{"data-test-subj":"refreshButton",color:"primary",onClick:$e,iconType:"refresh","aria-label":he.Yb,isDisabled:!Ue}))),[Lt,qt,Ve,Ue,$e]),$t=Object(l.useMemo)((()=>Ve?c.a.createElement(a.EuiFlexItem,null,c.a.createElement(a.EuiLoadingSpinner,{size:"m","data-test-subj":"rule-status-loader"})):c.a.createElement(De.c,{status:Lt,date:qt,message:Bt})),[Lt,qt,Bt,Ve]),Vt=Object(l.useCallback)((({x:e})=>{if(!e)return;const[t,n]=e;q(Object(se.setAbsoluteRangeDatePicker)({id:h.a.global,from:new Date(t).toISOString(),to:new Date(n).toISOString()}))}),[q]),Ut=Object(l.useCallback)((e=>{Qe((t=>t?{...t,enabled:e}:t))}),[]),Ht=Object(l.useCallback)((e=>{lt(e)}),[lt]),Gt=Object(l.useCallback)((e=>{ut(e)}),[ut]),Qt=Object(l.useCallback)((()=>{Object(Ce.j)(B.current)}),[B]),Wt=Object(l.useCallback)((()=>{Object(Ce.m)()}),[]),Yt=Object(l.useCallback)((e=>{Object(f.isTab)(e)&&Object(Ce.l)({containerElement:B.current,keyboardEvent:e,onSkipFocusBeforeEventsTable:Qt,onSkipFocusAfterEventsTable:Wt})}),[B,Qt,Wt]),{isBulkDuplicateConfirmationVisible:Jt,showBulkDuplicateConfirmation:Xt,cancelRuleDuplication:Zt,confirmRuleDuplication:en}=Object($i.a)();return Object(ie.h)(pe,me,fe,Ae)?(_(le.B,{deepLinkId:Oe.a.alerts,path:Object(O.a)()}),null):c.a.createElement(c.a.Fragment,null,c.a.createElement(Yn.a,null),c.a.createElement(Jn.a,null),Jt&&c.a.createElement(Vi.a,{onCancel:Zt,onConfirm:en,rulesCount:1}),c.a.createElement(Ui,{onKeyDown:Yt,ref:B},c.a.createElement(a.EuiWindowEvent,{event:"resize",handler:s.noop}),c.a.createElement(k.a,{show:Object(Ce.n)({globalFullScreen:pt,graphEventId:$})},c.a.createElement(I.a,{id:h.a.global,pollForSignalIndex:He,indexPattern:Re})),c.a.createElement(Kt,null,c.a.createElement(T.a,{noPadding:pt},c.a.createElement(Te.a,{show:!pt},c.a.createElement(ta.a,{backOptions:{path:Object(O.e)(),text:$n,pageId:Oe.a.rules,dataTestSubj:"ruleDetailsBackToAllRules"},border:!0,subtitle:Ct,subtitle2:c.a.createElement(c.a.Fragment,null,c.a.createElement(a.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",justifyContent:"flexStart"},c.a.createElement(a.EuiFlexItem,{grow:!1},De.d.STATUS,":"),zt)),title:It,badgeOptions:Tt},c.a.createElement(a.EuiFlexGroup,{alignItems:"center"},c.a.createElement(a.EuiFlexItem,{grow:!1},c.a.createElement(a.EuiToolTip,{position:"top",content:Object(ge.b)(Ge,xt,kt,be)},c.a.createElement(a.EuiFlexGroup,null,c.a.createElement(ne.a,{id:null!==(D=null==Ge?void 0:Ge.id)&&void 0!==D?D:"-1",isDisabled:!Ue||!Object(ge.a)(Ge,kt)||!Object(ge.c)(be)||Object(b.d)(null==Ge?void 0:Ge.type)&&!xt,enabled:Ue&&null!==(F=null==Ge?void 0:Ge.enabled)&&void 0!==F&&F,startMlJobsIfNeeded:Je,onChange:Ut}),c.a.createElement(a.EuiFlexItem,null,Vn)))),c.a.createElement(a.EuiFlexItem,{grow:!1},c.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1},c.a.createElement(a.EuiFlexItem,{grow:!1},c.a.createElement(Bi,{ruleId:Be,disabled:!Ue||!Object(ge.c)(be)||Object(b.d)(null==Ge?void 0:Ge.type)&&!xt,disabledReason:Object(ge.b)(Ge,xt,kt,be)})),c.a.createElement(a.EuiFlexItem,{grow:!1},c.a.createElement(ke,{rule:Ge,userHasPermissions:Ue&&Object(ge.c)(be),canDuplicateRuleWithActions:Object(ge.a)(Ge,kt),showBulkDuplicateExceptionsConfirmation:Xt})))))),$t,wt,c.a.createElement(a.EuiSpacer,null),c.a.createElement(a.EuiFlexGroup,null,c.a.createElement(a.EuiFlexItem,{"data-test-subj":"aboutRule",component:"section",grow:1},c.a.createElement(K,{loading:We,stepData:tt,stepDataDetails:nt})),c.a.createElement(a.EuiFlexItem,{grow:1},c.a.createElement(a.EuiFlexGroup,{direction:"column"},c.a.createElement(a.EuiFlexItem,{component:"section",grow:1,"data-test-subj":"defineRule"},c.a.createElement(ae.a,{loading:We||yt,title:he.sb},null!=at&&!yt&&!Ke&&c.a.createElement(Z.b,{descriptionColumns:"singleSplit",isReadOnlyView:!0,isLoading:!1,defaultValues:{dataViewTitle:rt,...at,queryBar:null!=ht?ht:at.queryBar},kibanaDataViews:ft,indicesConfig:vt,threatIndicesConfig:Et}))),c.a.createElement(a.EuiSpacer,null),c.a.createElement(a.EuiFlexItem,{"data-test-subj":"schedule",component:"section",grow:1},c.a.createElement(ae.a,{loading:We,title:he.Fc},null!=it&&c.a.createElement(ee.a,{descriptionColumns:"singleSplit",isReadOnlyView:!0,isLoading:!1,defaultValues:it})))))),c.a.createElement(a.EuiSpacer,null),c.a.createElement(y.a,{navTabs:Ze}),c.a.createElement(a.EuiSpacer,null)),c.a.createElement(Hi,null,c.a.createElement(u.Switch,null,c.a.createElement(r.Route,{path:`/rules/id/:detailName/:tabName(${Gi.alerts})`},c.a.createElement(c.a.Fragment,null,c.a.createElement(a.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween"},c.a.createElement(a.EuiFlexItem,{grow:!1},c.a.createElement(Zn.a,{status:mt,onFilterGroupChanged:Mt})),c.a.createElement(a.EuiFlexItem,{grow:!1},V&&P.getLastUpdated({updatedAt:V||Date.now(),showUpdating:Ot}))),c.a.createElement(a.EuiSpacer,{size:"l"}),c.a.createElement(Te.a,{show:!pt},c.a.createElement(Y.a,{filters:At,query:Q,signalIndexName:xe,defaultStackByOption:"event.category",updateDateRange:Vt,runtimeMappings:Pe}),c.a.createElement(a.EuiSpacer,null)),null!=Be&&c.a.createElement(J.a,{filterGroup:mt,tableId:x.g.alertsOnRuleDetailsPage,defaultFilters:Dt,hasIndexWrite:null!=ye&&ye,hasIndexMaintenance:null!=Ee&&Ee,from:ue,loading:qe,showBuildingBlockAlerts:st,showOnlyThreatIndicatorAlerts:ct,onShowBuildingBlockAlertsChanged:Ht,onShowOnlyThreatIndicatorAlertsChanged:Gt,onRuleChange:$e,to:ce}))),c.a.createElement(r.Route,{path:`/rules/id/:detailName/:tabName(${Gi.exceptions})`},c.a.createElement(qi,{rule:Ge,listTypes:[g.b.DETECTION,g.b.RULE_DEFAULT],onRuleChange:$e,isViewReadOnly:!Ue,"data-test-subj":"exceptionTab"})),c.a.createElement(r.Route,{path:`/rules/id/:detailName/:tabName(${Gi.endpointExceptions})`},c.a.createElement(qi,{rule:Ge,listTypes:[g.b.ENDPOINT],onRuleChange:$e,isViewReadOnly:!Ue,"data-test-subj":"endpointExceptionsTab"})),c.a.createElement(r.Route,{path:`/rules/id/:detailName/:tabName(${Gi.executionResults})`},c.a.createElement(qn,{ruleId:Be,selectAlertsTab:St})),c.a.createElement(r.Route,{path:`/rules/id/:detailName/:tabName(${Gi.executionEvents})`},c.a.createElement(Ft,{ruleId:Be}))))))),c.a.createElement(M.a,{pageName:Oe.a.rules,state:{ruleName:null==Ge?void 0:Ge.name}}))},Ki=Object(d.connect)(null,(e=>({clearSelected:({id:t})=>e(j.a.clearSelected({id:t})),clearEventsLoading:({id:t})=>e(j.a.clearEventsLoading({id:t})),clearEventsDeleted:({id:t})=>e(j.a.clearEventsDeleted({id:t}))})));Wi.displayName="RuleDetailsPageComponent";const Yi=Ki(c.a.memo(Wi));Yi.displayName="RuleDetailsPage"},function(e,t,n){"use strict";n.d(t,"a",(function(){return H}));var a=n(34),i=n(32),r=n(4),o=n.n(r),s=n(33),l=n.n(s),c=n(88),u=n(104);const d="destination.ip",p="destination.port",m="event.category",g="file.name",f="host.name",b="kibana.alert.rule.name",y="kibana.alert.severity",h="process.parent.name",v="process.name",E="source.ip",x="source.port",k="user.name",S=[d,p,g,v,h,E,x],w=l()(i.EuiFlexGroup).withConfig({displayName:"AlertFieldFlexGroup",componentId:"sc-16po602-0"})(["flex-grow:0;gap:","px;"],(({$scopeId:e})=>e===u.d.active?0:3)),j=({contextId:e,eventId:t,field:n,fieldType:a="keyword",isAggregatable:r=!0,isDraggable:s,showSeparator:l,scopeId:u,value:d})=>o.a.createElement(w,{alignItems:"center","data-test-subj":"alertFieldBadge",$scopeId:u,gutterSize:"none"},o.a.createElement(i.EuiFlexItem,{grow:!1},o.a.createElement(c.c,{contextId:`${e}-alert-field`,eventId:t,field:n,fieldType:a,isAggregatable:r,isDraggable:s,scopeId:u,value:d})),l&&o.a.createElement(i.EuiFlexItem,{grow:!1},o.a.createElement("span",{"data-test-subj":"separator"},", ")));j.displayName="AlertFieldBadgeComponent";const O=o.a.memo(j),I=({contextId:e,"data-test-subj":t="alertField",eventId:n,field:a,fieldType:r="keyword",isAggregatable:s=!0,isDraggable:l,prefix:c,suffix:u,scopeId:d,values:p})=>null!=p?o.a.createElement(w,{alignItems:"center","data-test-subj":t,$scopeId:d,gutterSize:"none"},null!=c&&o.a.createElement(i.EuiFlexItem,{"data-test-subj":"prefix",grow:!1},c),p.map(((t,c)=>o.a.createElement(i.EuiFlexItem,{key:`${t}-${c}`,grow:!1},o.a.createElement(O,{contextId:`${e}-alert-field`,eventId:n,field:a,fieldType:r,isAggregatable:s,isDraggable:l,showSeparator:c<p.length-1,scopeId:d,value:t})))),null!=u&&o.a.createElement(i.EuiFlexItem,{"data-test-subj":"suffix",grow:!1},u)):null;I.displayName="AlertFieldComponent";const T=o.a.memo(I);var C=n(97),M=n(223),N=n(0);const D=N.i18n.translate("xpack.securitySolution.renderers.alertRenderer.alertLabel",{defaultMessage:"alert"}),F=N.i18n.translate("xpack.securitySolution.renderers.alertRenderer.byLabel",{defaultMessage:"by"}),A=N.i18n.translate("xpack.securitySolution.renderers.alertRenderer.createdLabel",{defaultMessage:"created"}),_=N.i18n.translate("xpack.securitySolution.renderers.alertRenderer.destinationLabel",{defaultMessage:"destination"}),R=N.i18n.translate("xpack.securitySolution.renderers.alertRenderer.eventLabel",{defaultMessage:"event"}),P=N.i18n.translate("xpack.securitySolution.renderers.alertRenderer.fileLabel",{defaultMessage:"file"}),L=N.i18n.translate("xpack.securitySolution.renderers.alertRenderer.onLabel",{defaultMessage:"on"}),q=N.i18n.translate("xpack.securitySolution.renderers.alertRenderer.parentProcessLabel",{defaultMessage:"parent process"}),B=N.i18n.translate("xpack.securitySolution.renderers.alertRenderer.processLabel",{defaultMessage:"process"}),z=N.i18n.translate("xpack.securitySolution.renderers.alertRenderer.sourceLabel",{defaultMessage:"source"}),$=N.i18n.translate("xpack.securitySolution.renderers.alertRenderer.withLabel",{defaultMessage:"with"}),V=l()(i.EuiFlexGroup).withConfig({displayName:"AlertRendererFlexGroup",componentId:"sc-jss410-0"})(["gap:",";"],(({theme:e})=>e.eui.euiSizeXS)),U={id:u.b.alert,isInstance:e=>{return null!==(n=null==(t=Object(a.get)("event.kind",e))?void 0:t.some((e=>null!=e.toLocaleLowerCase&&"signal"===e.toLowerCase())))&&void 0!==n&&n;var t,n},renderRow:({contextId:e="alert-renderer",data:t,isDraggable:n,scopeId:r})=>{const s=Object(a.get)("_id",t),l=Object(a.get)(d,t),c=Object(a.get)(p,t),u=Object(a.get)(m,t),w=Object(a.get)(g,t),j=Object(a.get)(f,t),O=Object(a.get)(b,t),I=Object(a.get)(y,t),N=Object(a.get)(v,t),U=Object(a.get)(h,t),H=Object(a.get)(E,t),G=Object(a.get)(x,t),Q=Object(a.get)(k,t);return o.a.createElement(M.a,null,o.a.createElement(C.b,{"data-test-subj":"alertRenderer"},o.a.createElement(V,{alignItems:"center",gutterSize:"none",justifyContent:"center",wrap:!0},o.a.createElement(T,{contextId:e,"data-test-subj":m,eventId:s,field:m,isDraggable:n,scopeId:r,values:u}),o.a.createElement(i.EuiFlexItem,{grow:!1},o.a.createElement("span",{"data-test-subj":"event"},` ${R} `)),(({data:e,fieldNames:t})=>t.some((t=>Object(a.has)(t,e))))({data:t,fieldNames:S})&&o.a.createElement(i.EuiFlexItem,{grow:!1},o.a.createElement("span",{"data-test-subj":"with"},` ${$} `)),o.a.createElement(T,{contextId:e,"data-test-subj":v,eventId:s,field:v,isDraggable:n,prefix:` ${B} `,suffix:", ",scopeId:r,values:N}),o.a.createElement(T,{contextId:e,"data-test-subj":h,eventId:s,field:h,isDraggable:n,prefix:` ${q} `,suffix:", ",scopeId:r,values:U}),o.a.createElement(T,{contextId:e,"data-test-subj":g,eventId:s,field:g,isDraggable:n,prefix:` ${P} `,suffix:", ",scopeId:r,values:w}),o.a.createElement(T,{contextId:e,"data-test-subj":E,eventId:s,field:E,isDraggable:n,prefix:` ${z} `,scopeId:r,values:H}),o.a.createElement(T,{contextId:e,"data-test-subj":x,eventId:s,field:x,isDraggable:n,prefix:":",suffix:", ",scopeId:r,values:G}),o.a.createElement(T,{contextId:e,"data-test-subj":d,eventId:s,field:d,isDraggable:n,prefix:` ${_} `,scopeId:r,values:l}),o.a.createElement(T,{contextId:e,"data-test-subj":p,eventId:s,field:p,isDraggable:n,prefix:":",suffix:", ",scopeId:r,values:c}),o.a.createElement(T,{contextId:e,"data-test-subj":k,eventId:s,field:k,isDraggable:n,prefix:` ${F} `,scopeId:r,values:Q}),o.a.createElement(T,{contextId:e,"data-test-subj":f,eventId:s,field:f,isDraggable:n,prefix:` ${L} `,scopeId:r,values:j}),o.a.createElement(T,{contextId:e,"data-test-subj":y,eventId:s,field:y,isDraggable:n,prefix:` ${A} `,suffix:` ${D} `,scopeId:r,values:I}),o.a.createElement(T,{contextId:e,"data-test-subj":b,eventId:s,field:b,isDraggable:n,suffix:".",scopeId:r,values:O}))))}},H=({data:e,rowRenderers:t})=>{var n;const a=null!==(n=t.find((t=>t.isInstance(e))))&&void 0!==n?n:null;return U.isInstance(e)?null!=a?(({a:e,b:t,id:n})=>({id:n,isInstance:n=>e.isInstance(n)||t.isInstance(n),renderRow:({contextId:n,data:a,isDraggable:i,scopeId:r})=>o.a.createElement(o.a.Fragment,null,e.isInstance(a)&&e.renderRow({contextId:n,data:a,isDraggable:i,scopeId:r}),t.isInstance(a)&&t.renderRow({contextId:n,data:a,isDraggable:i,scopeId:r}))}))({a:U,b:a,id:a.id}):U:a}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return q}));var a,i=n(32),r=n(34),o=n(4),s=n.n(o),l=n(33),c=n.n(l),u=n(45),d=n(48),p=n(911),m=n(296),g=n(77),f=n(695),b=n(62),y=n(157),h=n(518),v=n(825),E=n(378),x=n(469);!function(e){e.info="info",e.warning="warning",e.error="error"}(a||(a={}));const k=({message:e})=>{if(!e)return null;let t="primary",n="alert";return e.level===a.info?n="iInCircle":e.level===a.warning?t="warning":e.level===a.error&&(t="danger"),s.a.createElement(i.EuiToolTip,{content:e.text},s.a.createElement(i.EuiIcon,{type:n,color:t}))},S=s.a.memo(k),w=({job:e})=>{const t=Object(y.c)(e.jobState,e.datafeedState),n=t?"success":"danger",a=t?x.h:x.i;return s.a.createElement(i.EuiBadge,{"data-test-subj":"machineLearningJobStatus",color:n},a)},j=s.a.memo(w),O=c()(i.EuiLink).withConfig({displayName:"JobLink",componentId:"sc-c3w1h4-0"})(["margin-right:",";"],(({theme:e})=>e.eui.euiSizeS)),I=c.a.div.withConfig({displayName:"Wrapper",componentId:"sc-c3w1h4-1"})(["overflow:hidden;"]),T=({job:e,loading:t,refreshJob:n})=>{const{services:{http:a,ml:r}}=Object(g.k)(),{enableDatafeed:l,isLoading:c}=Object(h.a)(),u=e.id,d=Object(b.useMlHref)(r,a.basePath.get(),{page:b.ML_PAGES.ANOMALY_DETECTION_JOBS_MANAGE,pageState:{jobId:[u]}}),p=s.a.createElement("span",{"data-test-subj":"machineLearningJobId"},u),m=Object(y.c)(e.jobState,e.datafeedState),f=Object(o.useCallback)((async(t,a,i)=>{await l(e,a,i),n(e)}),[l,e,n]);return s.a.createElement(I,null,s.a.createElement("div",null,s.a.createElement(O,{href:d,target:"_blank"},p),s.a.createElement(S,{message:e.auditMessage})),s.a.createElement(i.EuiFlexGroup,{justifyContent:"flexStart"},s.a.createElement(i.EuiFlexItem,{grow:!1,style:{marginRight:"0"}},s.a.createElement(j,{job:e})),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(v.a,{job:e,isSecurityJobsLoading:t||c,onJobStateChange:f})),s.a.createElement(i.EuiFlexItem,{grow:!1,style:{marginLeft:"0"}},m?x.k:x.j)))},C=s.a.memo(T),M=({jobIds:e})=>{const{loading:t,jobs:n,refetch:a}=Object(E.a)(),i=n.filter((t=>e.includes(t.id)));return s.a.createElement(s.a.Fragment,null,i.map((e=>s.a.createElement(C,{key:e.id,job:e,loading:t,refreshJob:a}))))},N=({actions:e})=>e.length?s.a.createElement("ul",null,e.map(((e,t)=>s.a.createElement("li",{key:t},D(e.actionTypeId))))):null,D=e=>{if(!e)return"";const t=e.split(".")[1];return t?Object(r.startCase)(t):""};var F=n(566);const A=(e=F.a.value,t)=>{const n=Object(r.find)(["value",e],F.c);return{title:t,description:n?n.text:e}};var _=n(415),R=n(13);const P=c()(i.EuiDescriptionList).withConfig({displayName:"DescriptionListContainer",componentId:"sc-1jqwta0-0"})(["&.euiDescriptionList--column .euiDescriptionList__title{width:30%;}&.euiDescriptionList--column .euiDescriptionList__description{width:70%;overflow-wrap:anywhere;}"]),L=({data:e,columns:t="multi",indexPatterns:n,schema:a})=>{const l=Object(g.k)(),c=Object(R.b)(),[u]=Object(o.useState)(new d.FilterManager(l.services.uiSettings)),p=Object.keys(a).reduce(((t,i)=>{return"machineLearningJobId"===i?[...t,(o=Object(r.get)(i,e),l=Object(r.get)(i,a).label,{title:l,description:s.a.createElement(M,{jobIds:o})})]:"throttle"===i?[...t,A(Object(r.get)(i,e),Object(r.get)([i,"label"],a))]:"actions"===i?[...t,(d=Object(r.get)(i,e),p=Object(r.get)([i,"label"],a),{title:d.length?p:"",description:s.a.createElement(N,{actions:d})})]:[...t,...B(e,Object(r.pick)(i,a),u,c,n)];var o,l,d,p}),[]);return"multi"===t?s.a.createElement(i.EuiFlexGroup,null,Object(r.chunk)(Math.ceil(p.length/2),p).map(((e,t)=>s.a.createElement(i.EuiFlexItem,{"data-test-subj":"listItemColumnStepRuleDescription",key:`description-step-rule-${t}`},s.a.createElement(i.EuiDescriptionList,{listItems:e}))))):s.a.createElement(i.EuiFlexGroup,null,s.a.createElement(i.EuiFlexItem,{"data-test-subj":"listItemColumnStepRuleDescription"},"single"===t?s.a.createElement(i.EuiDescriptionList,{listItems:p}):s.a.createElement(P,{"data-test-subj":"singleSplitStepRuleDescriptionList",type:"column",listItems:p})))},q=Object(o.memo)(L),B=(e,t,n,a,i)=>Object.keys(t).reduce(((o,s)=>[...o,...$(s,Object(r.get)([s,"label"],t),e,n,a,i)]),[]),z=e=>e.map((e=>null==e.$state?{$state:{store:u.FilterStateStore.APP_STATE},...e}:e)),$=(e,t,n,a,i,o)=>{if("queryBar"===e){var s;const t=z(null!==(s=Object(r.get)("queryBar.filters",n))&&void 0!==s?s:[]),i=Object(r.get)("queryBar.query.query",n),l=Object(r.get)("queryBar.saved_id",n),c=Object(r.get)("queryBar.title",n);return Object(f.d)({field:e,filters:t,filterManager:a,query:i,savedId:l,savedQueryName:c,indexPatterns:o})}if("groupByFields"===e){const a=Object(r.get)(e,n);return Object(f.a)(t,a,i)}if("eqlOptions"===e){const t=Object(r.get)(e,n);return Object(f.b)(t)}if("threat"===e){const a=Object(r.get)(e,n);return Object(f.j)({label:t,threat:Object(_.a)(a)})}if("threshold"===e){const a=Object(r.get)(e,n);return Object(f.l)(t,a)}if("references"===e){const a=Object(r.get)(e,n);return Object(f.n)(t,a)}if("falsePositives"===e){const a=Object(r.get)(e,n);return Object(f.m)(t,e,a)}if("riskScore"===e){const t=Object(r.get)(e,n);return Object(f.f)(t)}if("severity"===e){const t=Object(r.get)(e,n);return Object(f.h)(t)}if("requiredFields"===e){const a=Object(r.get)(e,n);return Object(f.e)(t,a)}if("relatedIntegrations"===e){const a=Object(r.get)(e,n);return Object(p.b)(t,a)}var l;if("timeline"===e)return[{title:t,description:null!==(l=Object(r.get)(e,n).title)&&void 0!==l?l:m.b}];if("note"===e){const a=Object(r.get)(e,n);return Object(f.c)(t,a)}if("ruleType"===e){const a=Object(r.get)(e,n);return Object(f.g)(t,a)}if("kibanaSiemAppUrl"===e)return[];if("threatQueryBar"===e){var c;const t=z(null!==(c=Object(r.get)("threatQueryBar.filters",n))&&void 0!==c?c:[]),i=Object(r.get)("threatQueryBar.query.query",n),s=Object(r.get)("threatQueryBar.saved_id",n);return Object(f.d)({field:e,filters:t,filterManager:a,query:i,savedId:s,indexPatterns:o,queryLabel:x.t})}if("threatMapping"===e){const a=Object(r.get)(e,n);return Object(f.k)(t,a)}if("dataViewId"===e)return[];if(Array.isArray(Object(r.get)(e,n))&&"threatMapping"!==e){const a=Object(r.get)(e,n);return Object(f.i)(t,e,a)}if("index"===e&&Object(r.get)("dataViewId",n))return[];const u=Object(r.get)(e,n);return Object(r.isNumber)(u)||!Object(r.isEmpty)(u)?[{title:t,description:u}]:[]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n(4),i=n(34),r=n(1),o=n(366),s=n(259),l=n(84),c=n(77),u=n(507);const d=["siem_cloudtrail","siem_packetbeat","security_auth","security_linux_v3","security_network","security_windows_v3"],p=(e,t,n)=>{const a=t.find((t=>t.id===e));return void 0!==a?{moduleId:a.moduleId,defaultIndexPattern:a.defaultIndexPattern,isCompatible:n.includes(a.moduleId),isElasticJob:!0}:{moduleId:"",defaultIndexPattern:"",isCompatible:!0,isElasticJob:!1}};var m=n(120),g=n(389),f=n(534);const b=()=>{const[e,t]=Object(a.useState)([]),[n,b]=Object(a.useState)(!0),y=Object(m.a)(),[h]=Object(c.q)(r.S),v=Object(c.j)(),{addError:E}=Object(l.a)(),x=Object(a.useRef)(i.noop),k=Object(o.a)(y),S=Object(s.a)(y);return Object(a.useEffect)((()=>{let e=!0;const n=new AbortController;async function a(){if(b(!0),k&&S)try{const[a,i,r]=await Promise.all([Object(f.a)({http:v,signal:n.signal}),Object(u.b)({signal:n.signal}),Object(u.a)({indexPatternName:h,signal:n.signal})]),o=((e,t,n)=>{const a=n.map((e=>e.id)),i=((e,t)=>e.filter((e=>d.includes(e.id))).map((e=>[...e.jobs.map((n=>((e,t,n)=>({datafeedId:"",datafeedIndices:[],datafeedState:"",hasDatafeed:!1,isSingleMetricViewerJob:!1,jobState:"closed",memory_status:"",processed_record_count:0,id:t.id,description:t.config.description,groups:[...t.config.groups].sort(),defaultIndexPattern:e.defaultIndexPattern,moduleId:e.id,isCompatible:n,isInstalled:!1,isElasticJob:!0,awaitingNodeAssignment:!1,jobTags:{},bucketSpanSeconds:900}))(e,n,t.includes(e.id))))])).flat())(t,a),r=((e,t,n)=>e.filter((({groups:e})=>e.includes("siem")||e.includes("security"))).map((e=>({...e,...p(e.id,t,n),isInstalled:!0}))))(e,i,a);return((e,t)=>{const n=e.map((e=>e.id));return[...e,...t.filter((e=>!n.includes(e.id)))].sort(((e,t)=>e.id.localeCompare(t.id)))})(r,i)})(a,i,r);e&&t(o)}catch(t){e&&E(t,{title:g.a})}e&&b(!1)}return a(),x.current=a,()=>{e=!1,n.abort()}}),[k,S,h,E,v]),{isLicensed:S,isMlAdmin:k,jobs:e,loading:n,refetch:x.current}}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return x}));var a=n(4),i=n.n(a),r=n(92),o=n.n(r),s=n(77),l=n(183),c=n(904),u=n(32),d=n(34),p=n(37),m=n(17),g=n(14);const f=({disabled:e,hrefWithSearch:t,id:n,name:r,isSelected:o,isBeta:l,betaOptions:c})=>{var d;const{getAppUrl:p,navigateTo:f}=Object(s.m)(),b=Object(a.useCallback)((e=>{e.preventDefault(),f({path:t}),Object(m.e)(m.a.CLICK,`${m.b.TAB_CLICKED}${n}`)}),[f,t,n]),y=p({path:t});return i.a.createElement(u.EuiTab,{"data-href":y,"data-test-subj":`navigation-${n}`,disabled:e,isSelected:o,href:y,onClick:b,append:l&&i.a.createElement(u.EuiBetaBadge,{label:null!==(d=null==c?void 0:c.text)&&void 0!==d?d:g.a,size:"s"})},r)},b=i.a.memo(f),y=({navTabs:e,tabName:t})=>{const n=Object(a.useCallback)((()=>Object(d.getOr)("","id",Object.values(e).find((e=>t===e.id)))),[t,e]),[r,o]=Object(a.useState)(n());Object(a.useEffect)((()=>{const e=n();e!==r&&o(e)}),[t,e,n,r]);const{search:s}=Object(p.useLocation)(),l=Object(a.useMemo)((()=>Object.values(e).map((e=>{const t=r===e.id;return i.a.createElement(b,{key:`navigation-${e.id}`,id:e.id,hrefWithSearch:e.href+s,name:e.name,disabled:e.disabled,isSelected:t,isBeta:e.isBeta,betaOptions:e.betaOptions})}))),[e,r,s]);return i.a.createElement(u.EuiTabs,null,l)};y.displayName="TabNavigationComponent";const h=i.a.memo(y,((e,t)=>e.display===t.display&&e.tabName===t.tabName&&o()(e.navTabs,t.navTabs)));h.displayName="TabNavigation";const v=i.a.memo((({detailName:e,display:t,flowTarget:n,navTabs:r,pageName:o,pathName:l,search:u,state:d,tabName:p})=>{const{chrome:m,application:{getUrlForApp:g,navigateToUrl:f}}=Object(s.k)().services,b=Object(c.a)();return Object(a.useEffect)((()=>{(l||o)&&b({detailName:e,flowTarget:n,navTabs:r,pageName:o,pathName:l,search:u,state:d,tabName:p},m,f)}),[m,o,l,u,r,d,e,n,p,g,f,b]),i.a.createElement(h,{display:t,navTabs:r,pageName:o,pathName:l,tabName:p})}));v.displayName="TabNavigationComponent";const E=i.a.memo(v,((e,t)=>e.pathName===t.pathName&&e.search===t.search&&o()(e.navTabs,t.navTabs)&&o()(e.state,t.state))),x=i.a.memo((e=>{const[t]=Object(l.a)(),n={...t,...e};return i.a.createElement(E,n)}),((e,t)=>o()(e.navTabs,t.navTabs)));x.displayName="SecuritySolutionTabNavigation"},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return r})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"g",(function(){return c})),n.d(t,"h",(function(){return u})),n.d(t,"c",(function(){return d}));var a=n(0);const i=a.i18n.translate("xpack.securitySolution.notes.addNoteButtonLabel",{defaultMessage:"Add Note"}),r=a.i18n.translate("xpack.securitySolution.notes.noteLabel",{defaultMessage:"Note"}),o=a.i18n.translate("xpack.securitySolution.notes.notesTitle",{defaultMessage:"Notes"}),s=a.i18n.translate("xpack.securitySolution.notes.search.FilterByUserOrNotePlaceholder",{defaultMessage:"Filter by User or Note"}),l=a.i18n.translate("xpack.securitySolution.notes.cancelButtonLabel",{defaultMessage:"Cancel"}),c=a.i18n.translate("xpack.securitySolution.notes.youAreEditingANoteScreenReaderOnly",{defaultMessage:"You are editing a note. Click Add Note when finished, or press escape to cancel."}),u=e=>a.i18n.translate("xpack.securitySolution.notes.youAreViewingNotesScreenReaderOnly",{values:{row:e},defaultMessage:"You are viewing notes for the event in row {row}. Press the up arrow key when finished to return to the event."}),d=a.i18n.translate("xpack.securitySolution.notes.createdByLabel",{defaultMessage:"Created by"})},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"e",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return l}));var a=n(142);const i=()=>({windows:{events:{dll_and_driver_load:!0,dns:!0,file:!0,network:!0,process:!0,registry:!0,security:!0},malware:{mode:a.e.prevent,blocklist:!0},ransomware:{mode:a.e.prevent,supported:!0},memory_protection:{mode:a.e.prevent,supported:!0},behavior_protection:{mode:a.e.prevent,supported:!0},popup:{malware:{message:"",enabled:!0},ransomware:{message:"",enabled:!0},memory_protection:{message:"",enabled:!0},behavior_protection:{message:"",enabled:!0}},logging:{file:"info"},antivirus_registration:{enabled:!1},attack_surface_reduction:{credential_hardening:{enabled:!0}}},mac:{events:{process:!0,file:!0,network:!0},malware:{mode:a.e.prevent,blocklist:!0},behavior_protection:{mode:a.e.prevent,supported:!0},memory_protection:{mode:a.e.prevent,supported:!0},popup:{malware:{message:"",enabled:!0},behavior_protection:{message:"",enabled:!0},memory_protection:{message:"",enabled:!0}},logging:{file:"info"}},linux:{events:{process:!0,file:!0,network:!0,session_data:!1,tty_io:!1},malware:{mode:a.e.prevent,blocklist:!0},behavior_protection:{mode:a.e.prevent,supported:!0},memory_protection:{mode:a.e.prevent,supported:!0},popup:{malware:{message:"",enabled:!0},behavior_protection:{message:"",enabled:!0},memory_protection:{message:"",enabled:!0}},logging:{file:"info"}}}),r=(e=i())=>{const t={rollback:{self_healing:{enabled:!1}}};return{...e,windows:{...e.windows,advanced:void 0===e.windows.advanced?void 0:{...e.windows.advanced,alerts:void 0===e.windows.advanced.alerts?{...t}:{...e.windows.advanced.alerts,...t}},ransomware:{mode:a.e.off,supported:!1},memory_protection:{mode:a.e.off,supported:!1},behavior_protection:{mode:a.e.off,supported:!1},attack_surface_reduction:{credential_hardening:{enabled:!1}},popup:{...e.windows.popup,malware:{message:"",enabled:!0},ransomware:{message:"",enabled:!1},memory_protection:{message:"",enabled:!1},behavior_protection:{message:"",enabled:!1}}},mac:{...e.mac,behavior_protection:{mode:a.e.off,supported:!1},memory_protection:{mode:a.e.off,supported:!1},popup:{...e.mac.popup,malware:{message:"",enabled:!0},memory_protection:{message:"",enabled:!1},behavior_protection:{message:"",enabled:!1}}},linux:{...e.linux,behavior_protection:{mode:a.e.off,supported:!1},memory_protection:{mode:a.e.off,supported:!1},popup:{...e.linux.popup,malware:{message:"",enabled:!0},memory_protection:{message:"",enabled:!1},behavior_protection:{message:"",enabled:!1}}}}},o=(e=i())=>({...e,windows:{...e.windows,ransomware:{...e.windows.ransomware,supported:!0},memory_protection:{...e.windows.memory_protection,supported:!0},behavior_protection:{...e.windows.behavior_protection,supported:!0}},mac:{...e.mac,behavior_protection:{...e.windows.behavior_protection,supported:!0},memory_protection:{...e.mac.memory_protection,supported:!0}},linux:{...e.linux,behavior_protection:{...e.windows.behavior_protection,supported:!0},memory_protection:{...e.linux.memory_protection,supported:!0}}}),s="Elastic Security {action} {filename}",l="Elastic Security {action} {rule}"},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return l})),n.d(t,"f",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return p}));var a=n(37),i=n(108),r=n(105);const o=e=>e.artifacts.location,s=e=>{var t;return null===(t=e.location)||void 0===t?void 0:t.pathname},l=Object(i.createSelector)(s,(e=>null!==Object(a.matchPath)(null!=e?e:"",{path:r.n,exact:!0}))),c=Object(i.createSelector)(s,(e=>null!==Object(a.matchPath)(null!=e?e:"",{path:r.q,exact:!0}))),u=Object(i.createSelector)(s,(e=>null!==Object(a.matchPath)(null!=e?e:"",{path:r.m,exact:!0}))),d=Object(i.createSelector)(s,(e=>null!==Object(a.matchPath)(null!=e?e:"",{path:r.o,exact:!0}))),p=Object(i.createSelector)(s,(e=>null!==Object(a.matchPath)(null!=e?e:"",{path:r.l,exact:!0})))},function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"c",(function(){return y})),n.d(t,"b",(function(){return h})),n.d(t,"d",(function(){return E}));var a=n(32),i=n(4),r=n.n(i),o=n(33),s=n.n(o),l=n(78),c=n(79),u=n(86),d=n(81),p=n(242),m=n(210),g=n(112);s()(a.EuiBadge).withConfig({displayName:"NotesCountBadge",componentId:"sc-mazy8j-0"})(["margin-left:5px;"]).displayName="NotesCountBadge";const f=({timelineId:e})=>{const t=Object(l.useDispatch)(),n=Object(i.useMemo)((()=>u.b.getTimelineByIdSelector()),[]),o=Object(d.b)((t=>{var a;return(null!==(a=n(t,e))&&void 0!==a?a:g.b).isFavorite})),s=Object(d.b)((t=>{var a;return(null!==(a=n(t,e))&&void 0!==a?a:g.b).status}))===c.l.immutable,m=Object(i.useCallback)((()=>t(u.a.updateIsFavorite({id:e,isFavorite:!o}))),[t,e,o]);return r.a.createElement(a.EuiButton,{isSelected:o,fill:o,iconType:o?"starFilled":"starEmpty",onClick:m,"data-test-subj":`timeline-favorite-${o?"filled":"empty"}-star`,disabled:s},o?p.j:p.b)};f.displayName="AddToFavoritesButtonComponent";const b=r.a.memo(f),y=r.a.memo((({closeGearMenu:e,outline:t=!1,timelineId:n,title:a=p.h})=>{const{getButton:i}=Object(m.b)({timelineId:n,timelineType:c.n.default,closeGearMenu:e});return i({outline:t,title:a})}));y.displayName="NewTimeline";const h="notes-button",v=r.a.memo((({ariaLabel:e=p.i,isDisabled:t,toggleShowNotes:n,timelineType:i})=>{const o=i===c.n.template;return r.a.createElement(a.EuiButtonIcon,{"aria-label":e,className:h,"data-test-subj":"timeline-notes-button-small",disabled:t,iconType:"editorComment",onClick:n,size:"s",isDisabled:o})}));v.displayName="SmallNotesButton";const E=r.a.memo((({ariaLabel:e,isDisabled:t,showNotes:n,timelineType:i,toggleShowNotes:o,toolTip:s})=>n?r.a.createElement(v,{ariaLabel:e,isDisabled:t,toggleShowNotes:o,timelineType:i}):r.a.createElement(a.EuiToolTip,{content:s||"","data-test-subj":"timeline-notes-tool-tip"},r.a.createElement(v,{ariaLabel:e,isDisabled:t,toggleShowNotes:o,timelineType:i}))));E.displayName="NotesButton"},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=e=>{const t=Object.entries(e);if(Array.isArray(t[0])){const[[e,n]]=t;return[e,n]}return[null,null]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(0).i18n.translate("xpack.securitySolution.components.mlPopup.hooks.errors.siemJobFetchFailureTitle",{defaultMessage:"Security job fetch failure"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(4),i=n.n(a),r=n(34),o=n(40),s=n(633);const{euiColorVis0:l,euiColorVis5:c,euiColorVis7:u,euiColorVis9:d}=o.euiLightVars,p={low:l,medium:c,high:u,critical:d},m=({value:e})=>{var t;const n=Object(r.upperFirst)(e),a=null!==(t=p[e])&&void 0!==t?t:"subdued";return i.a.createElement(s.a,{healthColor:a,tooltipContent:n,dataTestSubj:"severity"},n)},g=i.a.memo(m)},function(e,t){const n=/^[0-9]+$/,a=(e,t)=>{const a=n.test(e),i=n.test(t);return a&&i&&(e=+e,t=+t),e===t?0:a&&!i?-1:i&&!a?1:e<t?-1:1};e.exports={compareIdentifiers:a,rcompareIdentifiers:(e,t)=>a(t,e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return d}));var a=n(39),i=n(4),r=n(1),o=n(138),s=n(353);const l=["GET",r.qb],c=(e,t)=>Object(a.useQuery)([...l,e],(async({signal:t})=>{const n=await Object(o.f)({signal:t,...e});return{rules:n.data,total:n.total}}),{...s.a,...t}),u=()=>{const e=Object(a.useQueryClient)();return Object(i.useCallback)((()=>{e.invalidateQueries(l,{refetchType:"active"})}),[e])},d=()=>{const e=Object(a.useQueryClient)();return Object(i.useCallback)((t=>{e.setQueriesData(l,(e=>e?{rules:p(e.rules,t),total:e.total}:void 0))}),[e])};function p(e,t){const n=new Map(t.map((e=>[e.id,e])));return e.some((e=>n.has(e.id)))?e.map((e=>{var t;return null!==(t=n.get(e.id))&&void 0!==t?t:e})):e}},function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(82),i=n.n(a),r=n(4),o=n.n(r),s=n(32),l=n(33),c=n.n(l),u=n(243),d=n(91);const p=c()(s.EuiContextMenuItem).withConfig({displayName:"StyledEuiContextMenuItem",componentId:"sc-gn0u4-0"})([".additional-info{display:none;max-width:50%;}&:hover{.additional-info{display:block !important;}}"]),m=c()("div").withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-gn0u4-1"})(["max-width:50%;padding-right:10px;"]),g=Object(r.memo)((({navigateAppId:e,navigateOptions:t,onClick:n,textTruncate:a,hoverInfo:l,children:c,...g})=>{const f=Object(u.a)(null!=e?e:"",{...t,onClick:n}),b=Object(d.a)(g["data-test-subj"]),y=Object(r.useMemo)((()=>{const e="additional-info "+("object"!=typeof l?"eui-textTruncate":"");return l?o.a.createElement(m,{className:e},l):null}),[l]);return o.a.createElement(p,i()({},g,{onClick:e?f:n}),o.a.createElement(s.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},a?o.a.createElement(o.a.Fragment,null,o.a.createElement("div",i()({className:"eui-textTruncate","data-test-subj":b("truncateWrapper")},"string"==typeof c?{title:c}:{}),c),y):o.a.createElement(o.a.Fragment,null,o.a.createElement(s.EuiFlexItem,null,c),y)))}));g.displayName="EuiContextMenuItemNavByRouter"},function(e,t,n){"use strict";n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}));var a=n(39),i=n(77),r=n(105),o=n(373),s=n(687);function l({onError:e,page:t,perPage:n}={page:1,perPage:r.c}){const o=Object(i.j)();return Object(a.useQuery)(["endpointSpecificPolicies",t,n],(()=>Object(s.a)(o,{query:{page:t,perPage:n}})),e?{onError:e}:void 0)}function c({agentPolicyIds:e,customQueryOptions:t}){const n=Object(i.j)();return Object(a.useQuery)(["endpointCountForPolicy",e],(()=>Object(o.b)(n,e)),t)}function u({customQueryOptions:e}){const t=Object(i.j)();return Object(a.useQuery)(["endpointPackageVersion",e],(()=>Object(o.d)(t)),e)}},,function(e,t,n){"use strict";n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return m}));var a=n(4),i=n.n(a),r=n(32),o=n(0);o.i18n.translate("xpack.securitySolution.firstLastSeenHost.errorSearchDescription",{defaultMessage:"An error has occurred on first last seen host search"});const s=o.i18n.translate("xpack.securitySolution.firstLastSeenHost.failSearchDescription",{defaultMessage:"Failed to run search on first last seen host"});var l=n(130),c=n(85),u=n(87),d=n(101);let p;!function(e){e.FIRST_SEEN="first-seen",e.LAST_SEEN="last-seen"}(p||(p={}));const m=i.a.memo((({indexPatterns:e,field:t,type:n,value:o})=>{const[m,{firstSeen:g,lastSeen:f,errorMessage:b}]=(({field:e,value:t,order:n,defaultIndex:i})=>{const{loading:r,result:o,search:u,error:d}=Object(l.a)({factoryQueryType:c.d,initialResult:{firstSeen:null,lastSeen:null},errorMessage:s});return Object(a.useEffect)((()=>{u({defaultIndex:i,factoryQueryType:c.d,field:e,value:t,order:n})}),[i,e,t,n,u]),[r,Object(a.useMemo)((()=>({firstSeen:o.firstSeen,lastSeen:o.lastSeen,errorMessage:d?d.toString():null})),[o,d])]})({field:t,value:o,order:n===p.FIRST_SEEN?c.b.asc:c.b.desc,defaultIndex:e}),y=Object(a.useMemo)((()=>n===p.FIRST_SEEN?g:f),[g,f,n]);return null!=b?i.a.createElement(r.EuiToolTip,{position:"top",content:b,"data-test-subj":"firstLastSeenErrorToolTip","aria-label":`firstLastSeenError-${n}`,id:`firstLastSeenError-${t}-${n}`},i.a.createElement(r.EuiIcon,{"aria-describedby":`firstLastSeenError-${t}-${n}`,type:"alert"})):i.a.createElement(i.a.Fragment,null,m&&i.a.createElement(r.EuiLoadingSpinner,{"data-test-subj":"loading-spinner",size:"m"}),m||null==y||"Invalid Date"!==new Date(y).toString()?!m&&null!==y&&i.a.createElement(r.EuiText,{"data-test-subj":"first-last-seen-value",size:"s"},i.a.createElement(d.b,{value:`${y}`})):y,!m&&null===y&&Object(u.d)())}));m.displayName="FirstLastSeen"},,function(e,t,n){"use strict";n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return g.a}));var a=n(82),i=n.n(a),r=n(4),o=n.n(r),s=n(34),l=n(32),c=n(696);const u=({disableLinks:e,href:t,target:n,children:a,...i})=>o.a.createElement(l.EuiToolTip,{content:t},o.a.createElement(l.EuiLink,{href:e?void 0:t,"data-test-subj":"markdown-link",rel:"nofollow",target:"_blank"},a)),d=Object(r.memo)(u),p=({children:e,disableLinks:t})=>{const n=Object(r.useMemo)((()=>e=>o.a.createElement(d,i()({},e,{disableLinks:t}))),[t]),a=Object(s.cloneDeep)(c.b);return a[1][1].components.a=n,o.a.createElement(l.EuiMarkdownFormat,{parsingPluginList:c.a,processingPluginList:a},e)};p.displayName="MarkdownRendererComponent";const m=Object(r.memo)(p);var g=n(458);n(459)},function(e,t,n){"use strict";n.d(t,"k",(function(){return u})),n.d(t,"l",(function(){return p})),n.d(t,"i",(function(){return m})),n.d(t,"g",(function(){return g})),n.d(t,"h",(function(){return f})),n.d(t,"m",(function(){return b})),n.d(t,"c",(function(){return h})),n.d(t,"j",(function(){return k})),n.d(t,"d",(function(){return S})),n.d(t,"e",(function(){return w})),n.d(t,"f",(function(){return j})),n.d(t,"b",(function(){return O})),n.d(t,"a",(function(){return I})),n.d(t,"n",(function(){return T}));var a=n(37),i=n(108),r=n(19),o=n(385),s=n(105),l=n(591),c=n(386);const u=e=>e.policyItem,d=Object(i.createSelector)(u,(e=>e.license),((e,t)=>{if(e){const n=((e,t)=>Object(r.b)(t,"platinum")?Object(o.d)(e):Object(o.e)(e))(e.inputs[0].config.policy.value,t);return{...e,inputs:[{...e.inputs[0],config:{...e.inputs[0].config,policy:{...e.inputs[0].config.policy,value:n}}}]}}return e})),p=Object(i.createSelector)(d,(e=>{if(e)return Object(l.a)(e)})),m=e=>!e.policyItem&&!e.apiError,g=e=>Object(c.e)(e)||Object(c.f)(e)||Object(c.d)(e)||Object(c.c)(e)||Object(c.b)(e),f=e=>e.license,b=Object(i.createSelector)((e=>e.location),(e=>{var t,n,i,r;return null!==(t=null===(n=Object(a.matchPath)(null!==(r=null==e?void 0:e.pathname)&&void 0!==r?r:"",{path:[s.n,s.q,s.m,s.o,s.l],exact:!0}))||void 0===n||null===(i=n.params)||void 0===i?void 0:i.policyId)&&void 0!==t?t:""})),y=Object(o.c)(),h=Object(i.createSelector)(d,(e=>{var t,n,a,i;return null!==(t=null==e||null===(n=e.inputs[0])||void 0===n||null===(a=n.config)||void 0===a||null===(i=a.policy)||void 0===i?void 0:i.value)&&void 0!==t?t:y})),v=Object(i.createSelector)(h,(e=>null==e?void 0:e.windows)),E=Object(i.createSelector)(h,(e=>null==e?void 0:e.mac)),x=Object(i.createSelector)(h,(e=>null==e?void 0:e.linux)),k=Object(i.createSelector)(v,E,x,((e,t,n)=>({windows:{advanced:e.advanced,events:e.events,malware:e.malware,ransomware:e.ransomware,memory_protection:e.memory_protection,behavior_protection:e.behavior_protection,popup:e.popup,antivirus_registration:e.antivirus_registration,attack_surface_reduction:e.attack_surface_reduction},mac:{advanced:t.advanced,events:t.events,malware:t.malware,behavior_protection:t.behavior_protection,memory_protection:t.memory_protection,popup:t.popup},linux:{advanced:n.advanced,events:n.events,malware:n.malware,behavior_protection:n.behavior_protection,memory_protection:n.memory_protection,popup:n.popup}}))),S=Object(i.createSelector)(k,(e=>e.windows.antivirus_registration.enabled)),w=Object(i.createSelector)(k,(e=>e.windows.attack_surface_reduction.credential_hardening.enabled)),j=e=>e.isLoading,O=e=>e.apiError,I=e=>e.agentStatusSummary,T=e=>e.updateStatus},function(e,t,n){e.exports=n(27)(171)},,,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"updateTableActivePage",(function(){return r})),n.d(t,"setHostTablesActivePageToZero",(function(){return o})),n.d(t,"setHostDetailsTablesActivePageToZero",(function(){return s})),n.d(t,"updateTableLimit",(function(){return l})),n.d(t,"updateHostsSort",(function(){return c})),n.d(t,"updateHostRiskScoreSort",(function(){return u})),n.d(t,"updateHostRiskScoreSeverityFilter",(function(){return d})),n.d(t,"updateHostsAnomaliesJobIdFilter",(function(){return p})),n.d(t,"updateHostsAnomaliesInterval",(function(){return m}));var a=n(16);const i=n.n(a)()("x-pack/security_solution/local/hosts"),r=i("UPDATE_HOST_TABLE_ACTIVE_PAGE"),o=i("SET_HOST_TABLES_ACTIVE_PAGE_TO_ZERO"),s=i("SET_HOST_DETAILS_TABLES_ACTIVE_PAGE_TO_ZERO"),l=i("UPDATE_HOST_TABLE_LIMIT"),c=i("UPDATE_HOSTS_SORT"),u=i("UPDATE_HOST_RISK_SCORE_SORT"),d=i("UPDATE_HOST_RISK_SCORE_SEVERITY"),p=i("UPDATE_HOSTS_ANOMALIES_JOB_ID_FILTER"),m=i("UPDATE_HOSTS_ANOMALIES_INTERVAL")},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r}));var a=n(1);const i=`${a.pb}/prepackaged`,r=`${a.pb}/prepackaged/_status`},function(e,t,n){(function(t){var n;n=function(){"use strict";var e=function(){if("undefined"!=typeof Map)return Map;function e(e,t){var n=-1;return e.some((function(e,a){return e[0]===t&&(n=a,!0)})),n}return function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(t){var n=e(this.__entries__,t),a=this.__entries__[n];return a&&a[1]},t.prototype.set=function(t,n){var a=e(this.__entries__,t);~a?this.__entries__[a][1]=n:this.__entries__.push([t,n])},t.prototype.delete=function(t){var n=this.__entries__,a=e(n,t);~a&&n.splice(a,1)},t.prototype.has=function(t){return!!~e(this.__entries__,t)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(e,t){void 0===t&&(t=null);for(var n=0,a=this.__entries__;n<a.length;n++){var i=a[n];e.call(t,i[1],i[0])}},t}()}(),n="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,a=void 0!==t&&t.Math===Math?t:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),i="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(a):function(e){return setTimeout((function(){return e(Date.now())}),1e3/60)},r=["top","right","bottom","left","width","height","size","weight"],o="undefined"!=typeof MutationObserver,s=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(e,t){var n=!1,a=!1,r=0;function o(){n&&(n=!1,e()),a&&l()}function s(){i(o)}function l(){var e=Date.now();if(n){if(e-r<2)return;a=!0}else n=!0,a=!1,setTimeout(s,20);r=e}return l}(this.refresh.bind(this))}return e.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},e.prototype.removeObserver=function(e){var t=this.observers_,n=t.indexOf(e);~n&&t.splice(n,1),!t.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},e.prototype.updateObservers_=function(){var e=this.observers_.filter((function(e){return e.gatherActive(),e.hasActive()}));return e.forEach((function(e){return e.broadcastActive()})),e.length>0},e.prototype.connect_=function(){n&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),o?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){n&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(e){var t=e.propertyName,n=void 0===t?"":t;r.some((function(e){return!!~n.indexOf(e)}))&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),l=function(e,t){for(var n=0,a=Object.keys(t);n<a.length;n++){var i=a[n];Object.defineProperty(e,i,{value:t[i],enumerable:!1,writable:!1,configurable:!0})}return e},c=function(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView||a},u=f(0,0,0,0);function d(e){return parseFloat(e)||0}function p(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.reduce((function(t,n){return t+d(e["border-"+n+"-width"])}),0)}var m="undefined"!=typeof SVGGraphicsElement?function(e){return e instanceof c(e).SVGGraphicsElement}:function(e){return e instanceof c(e).SVGElement&&"function"==typeof e.getBBox};function g(e){return n?m(e)?function(e){var t=e.getBBox();return f(0,0,t.width,t.height)}(e):function(e){var t=e.clientWidth,n=e.clientHeight;if(!t&&!n)return u;var a=c(e).getComputedStyle(e),i=function(e){for(var t={},n=0,a=["top","right","bottom","left"];n<a.length;n++){var i=a[n],r=e["padding-"+i];t[i]=d(r)}return t}(a),r=i.left+i.right,o=i.top+i.bottom,s=d(a.width),l=d(a.height);if("border-box"===a.boxSizing&&(Math.round(s+r)!==t&&(s-=p(a,"left","right")+r),Math.round(l+o)!==n&&(l-=p(a,"top","bottom")+o)),!function(e){return e===c(e).document.documentElement}(e)){var m=Math.round(s+r)-t,g=Math.round(l+o)-n;1!==Math.abs(m)&&(s-=m),1!==Math.abs(g)&&(l-=g)}return f(i.left,i.top,s,l)}(e):u}function f(e,t,n,a){return{x:e,y:t,width:n,height:a}}var b=function(){function e(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=f(0,0,0,0),this.target=e}return e.prototype.isActive=function(){var e=g(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},e}(),y=function(e,t){var n,a,i,r,o,s,c,u=(a=(n=t).x,i=n.y,r=n.width,o=n.height,s="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,c=Object.create(s.prototype),l(c,{x:a,y:i,width:r,height:o,top:i,right:a+r,bottom:o+i,left:a}),c);l(this,{target:e,contentRect:u})},h=function(){function t(t,n,a){if(this.activeObservations_=[],this.observations_=new e,"function"!=typeof t)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=t,this.controller_=n,this.callbackCtx_=a}return t.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof c(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new b(e)),this.controller_.addObserver(this),this.controller_.refresh())}},t.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof c(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},t.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},t.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach((function(t){t.isActive()&&e.activeObservations_.push(t)}))},t.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map((function(e){return new y(e.target,e.broadcastRect())}));this.callback_.call(e,t,e),this.clearActive()}},t.prototype.clearActive=function(){this.activeObservations_.splice(0)},t.prototype.hasActive=function(){return this.activeObservations_.length>0},t}(),v="undefined"!=typeof WeakMap?new WeakMap:new e,E=function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=s.getInstance(),a=new h(t,n,this);v.set(this,a)};return["observe","unobserve","disconnect"].forEach((function(e){E.prototype[e]=function(){var t;return(t=v.get(this))[e].apply(t,arguments)}})),void 0!==a.ResizeObserver?a.ResizeObserver:E},e.exports=n()}).call(this,n(400))},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"e",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return l}));var a=n(0);const i=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.stackByOptions.stackByLabel",{defaultMessage:"Stack by"}),r=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.stackByOptions.groupByLabel",{defaultMessage:"Group by"}),o=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.stackByOptions.stackByPlaceholder",{defaultMessage:"Select a field to stack by"}),s=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.stackByOptions.stackByAriaLabel",{defaultMessage:"Stack the alerts histogram by a field value"}),l=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.stackByOptions.groupByTopLabel",{defaultMessage:"Group by top"})},function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"f",(function(){return r})),n.d(t,"g",(function(){return o})),n.d(t,"h",(function(){return s})),n.d(t,"i",(function(){return l})),n.d(t,"j",(function(){return c})),n.d(t,"k",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"n",(function(){return m})),n.d(t,"m",(function(){return g})),n.d(t,"o",(function(){return f})),n.d(t,"p",(function(){return b})),n.d(t,"q",(function(){return y})),n.d(t,"t",(function(){return h})),n.d(t,"s",(function(){return v})),n.d(t,"u",(function(){return E})),n.d(t,"w",(function(){return x})),n.d(t,"a",(function(){return k})),n.d(t,"b",(function(){return S})),n.d(t,"v",(function(){return w})),n.d(t,"r",(function(){return j})),n.d(t,"l",(function(){return O}));var a=n(0);a.i18n.translate("xpack.securitySolution.dataProviders.and",{defaultMessage:"AND"});const i=a.i18n.translate("xpack.securitySolution.dataProviders.deleteDataProvider",{defaultMessage:"Delete"}),r=a.i18n.translate("xpack.securitySolution.dataProviders.dropAnything",{defaultMessage:"Drop anything"}),o=(a.i18n.translate("xpack.securitySolution.dataProviders.edit",{defaultMessage:"Edit"}),a.i18n.translate("xpack.securitySolution.dataProviders.editMenuItem",{defaultMessage:"Edit filter"})),s=a.i18n.translate("xpack.securitySolution.dataProviders.editTitle",{defaultMessage:"EDIT FILTER"}),l=a.i18n.translate("xpack.securitySolution.dataProviders.excludeDataProvider",{defaultMessage:"Exclude results"}),c=a.i18n.translate("xpack.securitySolution.dataProviders.existsLabel",{defaultMessage:"exists"}),u=(a.i18n.translate("xpack.securitySolution.dataProviders.fieldLabel",{defaultMessage:"Field"}),a.i18n.translate("xpack.securitySolution.dataProviders.filterForFieldPresentLabel",{defaultMessage:"Filter for field present"})),d=a.i18n.translate("xpack.securitySolution.dataProviders.convertToFieldLabel",{defaultMessage:"Convert to field"}),p=a.i18n.translate("xpack.securitySolution.dataProviders.convertToTemplateFieldLabel",{defaultMessage:"Convert to template field"}),m=a.i18n.translate("xpack.securitySolution.dataProviders.highlighted",{defaultMessage:"highlighted"}),g=a.i18n.translate("xpack.securitySolution.dataProviders.hereToBuildAn",{defaultMessage:"here to build an"}),f=a.i18n.translate("xpack.securitySolution.dataProviders.includeDataProvider",{defaultMessage:"Include results"}),b=a.i18n.translate("xpack.securitySolution.dataProviders.not",{defaultMessage:"NOT"}),y=(a.i18n.translate("xpack.securitySolution.dataProviders.or",{defaultMessage:"or"}),a.i18n.translate("xpack.securitySolution.dataProviders.query",{defaultMessage:"query"})),h=(a.i18n.translate("xpack.securitySolution.dataProviders.toggle",{defaultMessage:"toggle"}),a.i18n.translate("xpack.securitySolution.dataProviders.reEnableDataProvider",{defaultMessage:"Re-enable"})),v=a.i18n.translate("xpack.securitySolution.dataProviders.removeDataProvider",{defaultMessage:"Remove Data Provider"}),E=({field:e,value:t})=>a.i18n.translate("xpack.securitySolution.dataProviders.showOptionsDataProviderAriaLabel",{values:{field:e,value:t},defaultMessage:"{field} {value} Press enter for options, or press space to begin dragging"}),x=a.i18n.translate("xpack.securitySolution.dataProviders.temporaryDisableDataProvider",{defaultMessage:"Temporarily disable"}),k=(a.i18n.translate("xpack.securitySolution.dataProviders.valuePlaceholder",{defaultMessage:"value"}),a.i18n.translate("xpack.securitySolution.dataProviders.addFieldPopoverButtonLabel",{defaultMessage:"Add field"})),S=a.i18n.translate("xpack.securitySolution.dataProviders.addTemplateFieldPopoverButtonLabel",{defaultMessage:"Add template field"}),w=a.i18n.translate("xpack.securitySolution.dataProviders.templateFieldLabel",{defaultMessage:"Template field"}),j=a.i18n.translate("xpack.securitySolution.dataProviders.queryAreaAriaLabel",{defaultMessage:"You are in the timeline query area, which contains groups of data providers that query for events"}),O=e=>a.i18n.translate("xpack.securitySolution.dataProviders.groupAreaAriaLabel",{values:{group:e},defaultMessage:"You are in group {group}"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(4),i=n(78),r=n(117),o=n(81),s=n(95),l=n(177),c=n(256),u=n(79),d=n(210),p=n(12),m=n(98);const g=()=>{const e=Object(i.useDispatch)(),t=Object(a.useMemo)((()=>m.e.getSourcererDataViewsSelector()),[]),{defaultDataView:n,signalIndexName:g}=Object(o.a)((e=>t(e))),f=Object(d.a)({timelineId:u.j.active,timelineType:u.n.default}),b=Object(a.useCallback)(((t,a)=>{f({timeRange:a}),e(Object(p.updateProviders)({id:u.j.active,providers:t})),e(l.a.setSelectedDataView({id:s.SourcererScopeName.timeline,selectedDataViewId:n.id,selectedPatterns:[g||""]}))}),[f,n.id,e,g]);return{openTimelineWithFilters:Object(a.useCallback)(((e,t)=>{const n=[];for(const t of e){const e=t[0];if(e){const a=Object(c.a)(e.field,Object(r.v4)(),e.value,e.operator);for(const e of t.slice(1))a.and.push(Object(c.a)(e.field,Object(r.v4)(),e.value,e.operator));n.push(a)}}b(n,t)}),[b])}}},function(e,t,n){"use strict";n.r(t),n.d(t,"setUsersTablesActivePageToZero",(function(){return r})),n.d(t,"setUsersDetailsTablesActivePageToZero",(function(){return o})),n.d(t,"updateTableLimit",(function(){return s})),n.d(t,"updateTableActivePage",(function(){return l})),n.d(t,"updateTableSorting",(function(){return c})),n.d(t,"updateUserRiskScoreSeverityFilter",(function(){return u})),n.d(t,"updateUsersAnomaliesJobIdFilter",(function(){return d})),n.d(t,"updateUsersAnomaliesInterval",(function(){return p}));var a=n(16);const i=n.n(a)()("x-pack/security_solution/local/users"),r=i("SET_USERS_TABLES_ACTIVE_PAGE_TO_ZERO"),o=i("SET_USERS_DETAILS_TABLES_ACTIVE_PAGE_TO_ZERO"),s=i("UPDATE_USERS_TABLE_LIMIT"),l=i("UPDATE_USERS_ACTIVE_PAGE"),c=i("UPDATE_USERS_SORTING"),u=i("UPDATE_USERS_RISK_SEVERITY_FILTER"),d=i("UPDATE_USERS_ANOMALIES_JOB_ID_FILTER"),p=i("UPDATE_USERS_ANOMALIES_INTERVAL")},function(e,t,n){"use strict";n.d(t,"h",(function(){return i})),n.d(t,"d",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"g",(function(){return s})),n.d(t,"f",(function(){return l})),n.d(t,"e",(function(){return c})),n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return d}));var a=n(0);const i=a.i18n.translate("xpack.securitySolution.network.pageTitle",{defaultMessage:"Network"}),r=a.i18n.translate("xpack.securitySolution.network.navigation.flowsTitle",{defaultMessage:"Flows"}),o=a.i18n.translate("xpack.securitySolution.network.navigation.dnsTitle",{defaultMessage:"DNS"}),s=a.i18n.translate("xpack.securitySolution.network.navigation.usersTitle",{defaultMessage:"Users"}),l=a.i18n.translate("xpack.securitySolution.network.navigation.tlsTitle",{defaultMessage:"TLS"}),c=a.i18n.translate("xpack.securitySolution.network.navigation.httpTitle",{defaultMessage:"HTTP"}),u=a.i18n.translate("xpack.securitySolution.network.navigation.anomaliesTitle",{defaultMessage:"Anomalies"}),d=a.i18n.translate("xpack.securitySolution.network.navigation.eventsTitle",{defaultMessage:"Events"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(108),i=n(937),r=n(934);const o=Object(a.createSelector)(Object(r.globalFiltersQuerySelector)(),Object(r.getTimelineSelector)(),Object(r.globalQuerySelector)(),Object(r.globalQuery)(),Object(r.timelineQueryByIdSelector)(),Object(i.getTableByIdSelector)(),((e,t,n,a,i,r)=>({filters:e,input:t,query:n,globalQueries:a,timelineQuery:i,dataTable:r})))},function(e,t,n){"use strict";n.d(t,"f",(function(){return b})),n.d(t,"k",(function(){return y})),n.d(t,"i",(function(){return h})),n.d(t,"g",(function(){return v})),n.d(t,"j",(function(){return E})),n.d(t,"h",(function(){return x})),n.d(t,"b",(function(){return k})),n.d(t,"a",(function(){return w})),n.d(t,"e",(function(){return j})),n.d(t,"d",(function(){return M})),n.d(t,"c",(function(){return N}));var a=n(34),i=n(43),r=n.n(i),o=n(252),s=n.n(o),l=n(995),c=n.n(l),u=n(110),d=n(1),p=n(174),m=n(661),g=n(167),f=n(833);const b=e=>{const t={unit:"ms",value:0},n=e.match(/\d+/g),i=e.match(/[a-zA-Z]+/g);return Object(a.isEmpty)(n)||null==n||isNaN(Number(n[0]))||(t.value=Number(n[0])),!Object(a.isEmpty)(i)&&null!=i&&["s","m","h"].includes(i[0])&&(t.unit=i[0]),t},y=e=>!(null==e||!e.isValid||!e.data),h=e=>Object(a.has)("data.ruleType",e),v=e=>Object(a.has)("data.name",e),E=e=>Object(a.has)("data.interval",e),x=e=>Object(a.has)("data.actions",e),k=(e,t)=>{switch(t){case"machine_learning":const{index:t,queryBar:n,threshold:a,threatIndex:i,threatQueryBar:r,threatMapping:o,eqlOptions:s,newTermsFields:l,historyWindowSize:c,...u}=e;return u;case"threshold":const{anomalyThreshold:d,machineLearningJobId:p,threatIndex:m,threatQueryBar:g,threatMapping:f,eqlOptions:b,newTermsFields:y,historyWindowSize:h,...v}=e;return v;case"threat_match":const{anomalyThreshold:E,machineLearningJobId:x,threshold:k,eqlOptions:S,newTermsFields:w,historyWindowSize:j,...O}=e;return O;case"query":case"saved_query":const{anomalyThreshold:I,machineLearningJobId:T,threshold:C,threatIndex:M,threatQueryBar:N,threatMapping:D,eqlOptions:F,newTermsFields:A,historyWindowSize:_,...R}=e;return R;case"eql":const{anomalyThreshold:P,machineLearningJobId:L,threshold:q,threatIndex:B,threatQueryBar:z,threatMapping:$,newTermsFields:V,historyWindowSize:U,...H}=e;return H;case"new_terms":const{anomalyThreshold:G,machineLearningJobId:Q,threshold:W,threatIndex:K,threatQueryBar:Y,threatMapping:J,eqlOptions:X,...Z}=e;return Z}Object(p.a)(t)};function S(e){return e.filter((e=>"none"!==e.name))}const w=e=>e.filter((e=>"none"!==e.tactic.name)).map((e=>{var t;return{...e,technique:S(null!==(t=e.technique)&&void 0!==t?t:[]).map((e=>({...e,subtechnique:null!=e.subtechnique?S(e.subtechnique):[]})))}})),j=e=>{const t={...e};return e.dataSourceType===g.a.DataView?c()(t,["index","dataSourceType"]):e.dataSourceType===g.a.IndexPatterns?c()(t,["dataViewId","dataSourceType"]):t},O=e=>{var t,n,i,r,o,s,l,c,u,d,p,m,g,f,b,y,h,v,E,x,S,w,O,I,T,C,M,N,D,F,A,_,R,P,L,q,B,z,$,V,U,H,G,Q,W,K;const Y=j(e),J=k(Y,Y.ruleType),{ruleType:X,timeline:Z}=J;var ee;return{...{type:X,...null!=Z.id&&null!=Z.title&&{timeline_id:Z.id,timeline_title:Z.title}},...(ee=J,Object(a.has)("anomalyThreshold",ee)?{anomaly_threshold:J.anomalyThreshold,machine_learning_job_id:J.machineLearningJobId}:(e=>Object(a.has)("threshold",e))(J)?{index:J.index,filters:null===(t=J.queryBar)||void 0===t?void 0:t.filters,language:null===(n=J.queryBar)||void 0===n||null===(i=n.query)||void 0===i?void 0:i.language,query:null===(r=J.queryBar)||void 0===r||null===(o=r.query)||void 0===o?void 0:o.query,saved_id:null!==(s=null===(l=J.queryBar)||void 0===l?void 0:l.saved_id)&&void 0!==s?s:void 0,..."threshold"===X&&{threshold:{field:null!==(c=null===(u=J.threshold)||void 0===u?void 0:u.field)&&void 0!==c?c:[],value:null!==(d=parseInt(null===(p=J.threshold)||void 0===p?void 0:p.value,10))&&void 0!==d?d:0,cardinality:Object(a.isEmpty)(null===(m=J.threshold.cardinality)||void 0===m?void 0:m.field)||null==(null===(g=J.threshold.cardinality)||void 0===g?void 0:g.value)?[]:[{field:J.threshold.cardinality.field[0],value:parseInt(J.threshold.cardinality.value,10)}]}}}:(e=>Object(a.has)("threatIndex",e))(J)?{index:J.index,filters:null===(f=J.queryBar)||void 0===f?void 0:f.filters,language:null===(b=J.queryBar)||void 0===b||null===(y=b.query)||void 0===y?void 0:y.language,query:null===(h=J.queryBar)||void 0===h||null===(v=h.query)||void 0===v?void 0:v.query,saved_id:null!==(E=null===(x=J.queryBar)||void 0===x?void 0:x.saved_id)&&void 0!==E?E:void 0,threat_index:J.threatIndex,threat_query:null===(S=J.threatQueryBar)||void 0===S||null===(w=S.query)||void 0===w?void 0:w.query,threat_filters:null===(O=J.threatQueryBar)||void 0===O?void 0:O.filters,threat_mapping:J.threatMapping,threat_language:null===(I=J.threatQueryBar)||void 0===I||null===(T=I.query)||void 0===T?void 0:T.language}:(e=>Object(a.has)("eqlOptions",e))(J)?{index:J.index,filters:null===(C=J.queryBar)||void 0===C?void 0:C.filters,language:null===(M=J.queryBar)||void 0===M||null===(N=M.query)||void 0===N?void 0:N.language,query:null===(D=J.queryBar)||void 0===D||null===(F=D.query)||void 0===F?void 0:F.query,saved_id:null!==(A=null===(_=J.queryBar)||void 0===_?void 0:_.saved_id)&&void 0!==A?A:void 0,timestamp_field:null===(R=J.eqlOptions)||void 0===R?void 0:R.timestampField,event_category_override:null===(P=J.eqlOptions)||void 0===P?void 0:P.eventCategoryField,tiebreaker_field:null===(L=J.eqlOptions)||void 0===L?void 0:L.tiebreakerField}:(e=>Object(a.has)("newTermsFields",e))(J)?{index:J.index,filters:null===(q=J.queryBar)||void 0===q?void 0:q.filters,language:null===(B=J.queryBar)||void 0===B||null===(z=B.query)||void 0===z?void 0:z.language,query:null===($=J.queryBar)||void 0===$||null===(V=$.query)||void 0===V?void 0:V.query,new_terms_fields:J.newTermsFields,history_window_start:`now-${J.historyWindowSize}`}:{...J.groupByFields.length>0?{alert_suppression:{group_by:J.groupByFields}}:{},index:J.index,filters:null===(U=J.queryBar)||void 0===U?void 0:U.filters,language:null===(H=J.queryBar)||void 0===H||null===(G=H.query)||void 0===G?void 0:G.language,query:null===(Q=J.queryBar)||void 0===Q||null===(W=Q.query)||void 0===W?void 0:W.query,saved_id:void 0,type:"query",...["query","saved_query"].includes(X)&&(null===(K=J.queryBar)||void 0===K?void 0:K.saved_id)&&J.shouldLoadQueryDynamically&&{type:"saved_query",query:void 0,filters:void 0,saved_id:J.queryBar.saved_id}}),data_view_id:J.dataViewId}},I=e=>{const{...t}=e;if(!Object(a.isEmpty)(t.interval)&&!Object(a.isEmpty)(t.from)){const{unit:e,value:n}=b(t.interval),{unit:a,value:i}=b(t.from),o=r.a.duration(n,e);o.add(i,a),t.from=`now-${o.asSeconds()}s`,t.to="now"}return{...t,meta:{from:e.from}}},T=(e,t)=>{const{author:n,falsePositives:i,references:r,riskScore:o,severity:s,threat:l,isAssociatedToEndpointList:c,isBuildingBlock:d,note:p,ruleNameOverride:m,threatIndicatorPath:g,timestampOverride:f,timestampOverrideFallbackDisabled:b,...y}=e,h=null!=t?t.filter((e=>"endpoint"!==e.type)):[];return{author:n.filter((e=>!Object(a.isEmpty)(e))),...d?{building_block_type:"default"}:{},...c?{exceptions_list:[{id:u.j,list_id:u.j,namespace_type:"agnostic",type:"endpoint"},...h]}:null!=t?{exceptions_list:[...h]}:{},false_positives:i.filter((e=>!Object(a.isEmpty)(e))),references:r.filter((e=>!Object(a.isEmpty)(e))),risk_score:o.value,risk_score_mapping:o.isMappingChecked?o.mapping.filter((e=>null!=e.field&&""!==e.field)):[],rule_name_override:""!==m?m:void 0,severity:s.value,severity_mapping:s.isMappingChecked?s.mapping.filter((e=>null!=e.field&&""!==e.field&&null!=e.value)):[],threat:w(l).map((e=>({...e,framework:"MITRE ATT&CK"}))),threat_indicator_path:g,timestamp_override:""!==f?f:void 0,timestamp_override_fallback_disabled:b,...Object(a.isEmpty)(p)?{}:{note:p},...y}},C=e=>{const{actions:t=[],responseActions:n,enabled:a,kibanaSiemAppUrl:i,throttle:r=d.Wb}=e;return{actions:t.map(m.a),response_actions:null==n?void 0:n.map(m.b),enabled:a,throttle:t.length?r:d.Wb,meta:{kibana_siem_app_url:i}}},M=(e,t,n,a,i)=>s.a.all([O(e),T(t,i),I(n),C(a)]),N=({defineRuleData:e,aboutRuleData:t,scheduleRuleData:n,exceptionsList:a})=>{const i={...t,name:"Preview Rule",description:"Preview Rule"};return{...M(e,i,n,f.b,a)}}},function(e,t,n){"use strict";n.d(t,"m",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"l",(function(){return s})),n.d(t,"j",(function(){return l})),n.d(t,"k",(function(){return c})),n.d(t,"i",(function(){return u})),n.d(t,"h",(function(){return d})),n.d(t,"e",(function(){return p})),n.d(t,"o",(function(){return m})),n.d(t,"n",(function(){return g})),n.d(t,"f",(function(){return f})),n.d(t,"g",(function(){return b})),n.d(t,"d",(function(){return y})),n.d(t,"b",(function(){return h}));var a=n(0);const i=a.i18n.translate("xpack.securitySolution.detectionEngine.detectionsPageTitle",{defaultMessage:"Alerts"}),r=a.i18n.translate("xpack.securitySolution.detectionEngine.alertTitle",{defaultMessage:"Alerts"}),o=a.i18n.translate("xpack.securitySolution.detectionEngine.buttonManageRules",{defaultMessage:"Manage rules"}),s=a.i18n.translate("xpack.securitySolution.detectionEngine.noIndexTitle",{defaultMessage:"Letâ€™s set up your detection engine"}),l=a.i18n.translate("xpack.securitySolution.detectionEngine.needsSignalsAndListsIndexesMessage",{defaultMessage:"You need permissions for the signals and lists indices."}),c=a.i18n.translate("xpack.securitySolution.detectionEngine.needsSignalsIndexMessage",{defaultMessage:"You need permissions for the signals index."}),u=a.i18n.translate("xpack.securitySolution.detectionEngine.needsListsIndexesMessage",{defaultMessage:"You need permissions for the lists indices."}),d=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.needsIndexPermissionsMessage",{values:{additionalContext:e},defaultMessage:"To use the detection engine, a user with the required cluster and index privileges must first access this page. {additionalContext} For more help, contact your Elastic Stack administrator."}),p=a.i18n.translate("xpack.securitySolution.detectionEngine.goToDocumentationButton",{defaultMessage:"View documentation"}),m=a.i18n.translate("xpack.securitySolution.detectionEngine.userUnauthenticatedTitle",{defaultMessage:"Detection engine permissions required"}),g=a.i18n.translate("xpack.securitySolution.detectionEngine.userUnauthenticatedMsgBody",{defaultMessage:"You do not have the required permissions for viewing the detection engine. For more help, contact your administrator."}),f=a.i18n.translate("xpack.securitySolution.detectionEngine.mlRulesDisabledMessageTitle",{defaultMessage:"ML rules require Platinum License and ML Admin Permissions"}),b=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.mlUnavailableTitle",{values:{totalRules:e},defaultMessage:"{totalRules} {totalRules, plural, =1 {rule requires} other {rules require}} Machine Learning to enable."}),y=a.i18n.translate("xpack.securitySolution.detectionEngine.noPermissionsTitle",{defaultMessage:"Privileges required"}),h=a.i18n.translate("xpack.securitySolution.detectionEngine.noPermissionsMessage",{defaultMessage:"To view alerts, you must update privileges. For more information, contact your Kibana administrator."})},function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return l}));var a=n(7),i=n(174),r=n(173);const o=e=>null==e?null:e===r.f["partial failure"]?"warning":e,s=e=>{const t=o(e);return null!=t?Object(a.capitalize)(t):null},l=e=>null==e?"subdued":e===r.f.succeeded?"success":e===r.f.failed?"danger":e===r.f.running||e===r.f["partial failure"]||e===r.f["going to run"]?"warning":Object(i.a)(e,"Unknown rule execution status")},function(e,t,n){"use strict";n.d(t,"a",(function(){return EventFiltersApiClient}));var a=n(110),i=n(172),r=n(315),o=n(290);function s(e){return Object(i.a)(e)}class EventFiltersApiClient extends r.a{constructor(e){super(e,a.e,o.b,void 0,s)}static getInstance(e){return super.getInstance(e,a.e,o.b,void 0,s)}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return W}));var a=n(4),i=n.n(a),r=n(38),o=n(78),s=n(32),l=n(33),c=n.n(l),u=n(316),d=n(255),p=n(403),m=n(205),g=n(99),f=n(107),b=n(302),y=n(705),h=n(141);const v=({width:e=r.DEFAULT_ACTION_BUTTON_WIDTH,dataTestSubj:t,content:n,ariaLabel:a,iconType:o="",isDisabled:l=!1,onClick:c,children:u,buttonType:d="icon"})=>i.a.createElement(i.a.Fragment,null,"icon"===d&&i.a.createElement("div",null,i.a.createElement(h.l,{textAlign:"center",width:e},null!=u?u:i.a.createElement(s.EuiToolTip,{"data-test-subj":`${t}-tool-tip`,content:n},i.a.createElement(s.EuiButtonIcon,{"aria-label":a,"data-test-subj":`${t}-button`,iconType:o,isDisabled:l,onClick:c,size:"s"})))),"text"===d&&i.a.createElement(s.EuiContextMenuItem,{"aria-label":a,"data-test-subj":`${t}-button-menu-item`,disabled:l,onClick:c,color:"text",size:"s"},i.a.createElement(s.EuiText,{"data-test-subj":`${t}-button`,size:"m"},n)));v.displayName="ActionIconItemComponent";const E=i.a.memo(v);var x=n(118),k=n(650);const S=({ariaLabel:e=x.g,ecsRowData:t,buttonType:n,onInvestigateInTimelineAlertClick:a})=>{const{investigateInTimelineAlertClick:r}=Object(k.a)({ecsRowData:t,onInvestigateInTimelineAlertClick:a});return i.a.createElement(E,{ariaLabel:e,content:x.f,dataTestSubj:"send-alert-to-timeline",iconType:"timeline",onClick:r,isDisabled:!1,buttonType:n})},w=i.a.memo(S);var j=n(79),O=n(254),I=n(387),T=n(116);const C=({ariaLabel:e,showNotes:t,timelineType:n,toggleShowNotes:a})=>{const{kibanaSecuritySolutionsPrivileges:r}=Object(T.a)();return i.a.createElement(E,null,i.a.createElement(I.d,{ariaLabel:e,"data-test-subj":"add-note",isDisabled:!1===r.crud,showNotes:t,timelineType:n,toggleShowNotes:a,toolTip:n===j.n.template?O.h:O.i}))};C.displayName="AddEventNoteActionComponent";const M=i.a.memo(C);var N=n(879);const D=({ariaLabel:e,isAlert:t,noteIds:n,onPinClicked:o,eventIsPinned:l,timelineType:c})=>{const{kibanaSecuritySolutionsPrivileges:u}=Object(T.a)(),d=Object(a.useMemo)((()=>Object(b.g)({isPinned:l,isAlert:t,eventHasNotes:Object(b.b)(n),timelineType:c})),[l,t,n,c]);return i.a.createElement("div",{key:"timeline-action-pin-tool-tip"},i.a.createElement(h.l,{textAlign:"center",width:r.DEFAULT_ACTION_BUTTON_WIDTH},i.a.createElement(s.EuiToolTip,{"data-test-subj":"timeline-action-pin-tool-tip",content:d},i.a.createElement(N.a,{ariaLabel:e,allowUnpinning:!Object(b.b)(n),"data-test-subj":"pin-event",isDisabled:!1===u.crud,isAlert:t,onClick:o,pinned:l,timelineType:c}))))};D.displayName="PinEventActionComponent";const F=i.a.memo(D);var A=n(81),_=n(12),R=n(148),P=n(86),L=n(112),q=n(34),B=n(154),z=n(179),$=n(13);const V=e=>"signal"===e,U=c.a.div.withConfig({displayName:"ActionsContainer",componentId:"sc-1sc1j22-0"})(["align-items:center;display:flex;"]),H=({ariaRowindex:e,checked:t,columnValues:n,ecsData:l,eventId:c,eventIdToNoteIds:v,isEventPinned:E=!1,isEventViewer:x=!1,loadingEventIds:k,onEventDetailsPanelOpened:S,onRowSelected:I,onRuleChange:T,showCheckboxes:C,showNotes:N,timelineId:D,toggleShowNotes:H})=>{const G=Object(o.useDispatch)(),Q=Object(f.a)("tGridEnabled"),W=Object(a.useMemo)((()=>P.b.getTimelineByIdSelector()),[]),K=Object(A.b)((e=>(Object(g.isTimelineScope)(D)?W(e,D):L.b).timelineType)),{startTransaction:Y}=Object(B.a)(),J=Object($.b)().isEnterprise(),X=Object(a.useCallback)((e=>G(P.a.pinEvent({id:D,eventId:e}))),[G,D]),Z=Object(a.useCallback)((e=>G(P.a.unPinEvent({id:D,eventId:e}))),[G,D]),ee=Object(a.useCallback)((e=>I({eventIds:[c],isSelected:e.currentTarget.checked})),[c,I]),te=Object(a.useCallback)((()=>Object(b.f)({allowUnpinning:!v||!Object(b.b)(v[c]),eventId:c,onPinEvent:X,onUnPinEvent:Z,isEventPinned:E})),[v,c,E,X,Z]),ne=Object(b.e)(l),ae=Object(a.useMemo)((()=>{var e,t,n,a;return"signal"!==ne&&!(null!==(e=l.event)&&void 0!==e&&null!==(t=e.kind)&&void 0!==t&&t.includes("event")&&null!==(n=l.agent)&&void 0!==n&&null!==(a=n.type)&&void 0!==a&&a.includes("endpoint"))}),[l,ne]),ie=Object(a.useMemo)((()=>!(e=>{var t;return("endpoint"===Object(q.get)(["agent","type",0],e)||"winlogbeat"===Object(q.get)(["agent","type",0],e)&&"sysmon"===Object(q.get)(["event","module",0],e))&&1===(null===(t=Object(q.get)(["process","entity_id"],e))||void 0===t?void 0:t.length)&&""!==Object(q.get)(["process","entity_id",0],e)})(l)),[l]),{setGlobalFullScreen:re}=Object(R.a)(),{setTimelineFullScreen:oe}=Object(R.c)(),se=Object(g.getScopedActions)(D),le=Object(a.useCallback)((()=>{Y({name:z.a.OPEN_ANALYZER});const e=document.querySelector(".euiDataGrid--fullScreen");se&&G(se.updateGraphEventId({id:D,graphEventId:l._id})),D===j.j.active?(e&&oe(!0),G(Object(_.setActiveTabTimeline)({id:D,activeTab:j.m.graph}))):e&&re(!0)}),[Y,se,D,G,l._id,oe,re]),ce=Object(a.useMemo)((()=>{var e,t,n,a,i;const{process:r,_id:o,timestamp:s}=l,c=null==r||null===(e=r.entry_leader)||void 0===e||null===(t=e.entity_id)||void 0===t?void 0:t[0];if(void 0===c)return null;const u=null==r||null===(n=r.entity_id)||void 0===n?void 0:n[0],d="signal"===ne||"eql"===ne?o:void 0;return{sessionEntityId:c,jumpToEntityId:u,jumpToCursor:d&&(null===(a=l.kibana)||void 0===a||null===(i=a.alert.original_time)||void 0===i?void 0:i[0])||s,investigatedAlertId:d}}),[l,ne]),ue=Object(a.useCallback)((()=>{const e=document.querySelector(".euiDataGrid--fullScreen");Y({name:z.a.OPEN_SESSION_VIEW}),D===j.j.active?(e&&oe(!0),null!==ce&&G(Object(_.setActiveTabTimeline)({id:D,activeTab:j.m.session}))):e&&re(!0),null!==ce&&se&&G(se.updateSessionViewConfig({id:D,sessionViewConfig:ce}))}),[Y,D,ce,oe,G,re,se]),{activeStep:de,isTourShown:pe,incrementStep:me}=Object(p.b)(),ge=Object(a.useMemo)((()=>pe(m.b.alertsCases)&&"signal"===ne&&Object(d.c)(D)&&1===e),[pe,e,ne,D]),fe=Object(a.useCallback)((()=>{ge&&de===m.a.expandEvent&&pe(m.b.alertsCases)&&me(m.b.alertsCases),S()}),[de,me,ge,pe,S]);return i.a.createElement(U,null,C&&!Q&&i.a.createElement("div",{key:"select-event-container","data-test-subj":"select-event-container"},i.a.createElement(h.l,{textAlign:"center",width:r.DEFAULT_ACTION_BUTTON_WIDTH},k.includes(c)?i.a.createElement(s.EuiLoadingSpinner,{size:"m","data-test-subj":"event-loader"}):i.a.createElement(s.EuiCheckbox,{"aria-label":O.e({ariaRowindex:e,columnValues:n,checked:t}),"data-test-subj":"select-event",id:c,checked:t,onChange:ee}))),i.a.createElement(u.a,{isTourAnchor:ge,onClick:fe,step:m.a.expandEvent,tourId:m.b.alertsCases},i.a.createElement("div",{key:"expand-event"},i.a.createElement(h.l,{textAlign:"center",width:r.DEFAULT_ACTION_BUTTON_WIDTH},i.a.createElement(s.EuiToolTip,{"data-test-subj":"expand-event-tool-tip",content:O.r},i.a.createElement(s.EuiButtonIcon,{"aria-label":O.s({ariaRowindex:e,columnValues:n}),"data-test-subj":"expand-event",iconType:"expand",onClick:fe,size:"s"}))))),i.a.createElement(i.a.Fragment,null,D!==j.j.active&&i.a.createElement(w,{ariaLabel:O.n({ariaRowindex:e,columnValues:n}),key:"investigate-in-timeline",ecsRowData:l}),!x&&H&&i.a.createElement(i.a.Fragment,null,i.a.createElement(M,{ariaLabel:O.c({ariaRowindex:e,columnValues:n}),key:"add-event-note",showNotes:null!=N&&N,toggleShowNotes:H,timelineType:K}),i.a.createElement(F,{ariaLabel:O.m({ariaRowindex:e,columnValues:n,isEventPinned:E}),isAlert:V(ne),key:"pin-event",onPinClicked:te,noteIds:v&&v[c]||[],eventIsPinned:E,timelineType:K})),i.a.createElement(y.b,{ariaLabel:O.g({ariaRowindex:e,columnValues:n}),ariaRowindex:e,columnValues:n,key:"alert-context-menu",ecsRowData:l,scopeId:D,disabled:ae,onRuleChange:T}),!1===ie?i.a.createElement("div",null,i.a.createElement(h.l,{textAlign:"center",width:r.DEFAULT_ACTION_BUTTON_WIDTH},i.a.createElement(s.EuiToolTip,{"data-test-subj":"view-in-analyzer-tool-tip",content:O.a},i.a.createElement(s.EuiButtonIcon,{"aria-label":O.b({ariaRowindex:e,columnValues:n}),"data-test-subj":"view-in-analyzer",iconType:"analyzeEvent",onClick:le,size:"s"})))):null,null===ce||!J&&D!==j.g.kubernetesPageSessions?null:i.a.createElement("div",null,i.a.createElement(h.l,{textAlign:"center",width:r.DEFAULT_ACTION_BUTTON_WIDTH},i.a.createElement(s.EuiToolTip,{"data-test-subj":"expand-event-tool-tip",content:O.j},i.a.createElement(s.EuiButtonIcon,{"aria-label":O.s({ariaRowindex:e,columnValues:n}),"data-test-subj":"session-view-button",iconType:"sessionViewer",onClick:ue,size:"s"}))))))};H.displayName="ActionsComponent";const G=i.a.memo(H);var Q=n(619);const W=e=>[{headerCellRender:()=>i.a.createElement(i.a.Fragment,null,Q.a),id:"default-timeline-control-column",rowCellRender:G,width:Object(r.getActionsColumnWidth)(e)}]},function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var a=n(82),i=n.n(a),r=n(4),o=n.n(r),s=n(1),l=n(252),c=n.n(l),u=n(126),d=n(248),p=n(77),m=n(326),g=n(0);const f=g.i18n.translate("xpack.securitySolution.containers.anomalies.stackByJobId",{defaultMessage:"job"}),b=g.i18n.translate("xpack.securitySolution.containers.anomalies.title",{defaultMessage:"Anomalies"}),y=g.i18n.translate("xpack.securitySolution.containers.anomalies.errorFetchingAnomaliesData",{defaultMessage:"Failed to query anomalies data"});var h,v=n(1068);const E=[{text:f,value:"job_id"}],x=f,k={defaultStackByOption:null!==(h=E.find((e=>e.text===x)))&&void 0!==h?h:E[0],errorMessage:y,hideHistogramIfEmpty:!0,histogramType:v.b.anomalies,stackByOptions:E,subtitle:void 0,title:b},S="anomaliesHistogramQuery",w=({deleteQuery:e,endDate:t,setQuery:n,skip:a,startDate:l,type:g,filterQuery:f,anomaliesFilterQuery:b,AnomaliesTableComponent:y,flowTarget:h,ip:v,hostName:E,userName:x,indexNames:w})=>{const{jobs:j}=Object(d.a)(),[O]=Object(p.q)(s.K),I=((e,t={},n=[],a,i,r)=>{const o=n.map((e=>e.id)).map((e=>({match_phrase:{job_id:e}}))),s=Object(u.a)(e),l=s?JSON.parse(s):{},d=c.a.all([l,t,{bool:{filter:[{bool:{should:o,minimum_should_match:1}},{match_phrase:{result_type:"record"}},i&&r&&{match_phrase:{[`${i}.ip`]:r}},{range:{record_score:{gte:a}}}]}}]);return JSON.stringify(d)})(f,b,j,O,h,v);return Object(r.useEffect)((()=>()=>{e&&e({id:S})}),[]),o.a.createElement(o.a.Fragment,null,o.a.createElement(m.a,i()({endDate:t,filterQuery:I,id:S,indexNames:w,setQuery:n,startDate:l},k)),o.a.createElement(y,{startDate:l,endDate:t,skip:a,type:g,flowTarget:h,ip:v,hostName:E,userName:x}))};w.displayName="AnomaliesQueryTabBodyComponent";const j=o.a.memo(w);j.displayName="AnomaliesQueryTabBody"},function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var a=n(4),i=n.n(a),r=n(32),o=n(33),s=n.n(o),l=n(0);const c=l.i18n.translate("xpack.securitySolution.andOrBadge.and",{defaultMessage:"AND"}),u=l.i18n.translate("xpack.securitySolution.andOrBadge.or",{defaultMessage:"OR"}),d=s()(r.EuiBadge).withConfig({displayName:"RoundBadge",componentId:"sc-wu3h16-0"})(["align-items:center;border-radius:100%;display:inline-flex;font-size:9px;height:34px;justify-content:center;margin:0 5px 0 5px;padding:7px 6px 4px 6px;user-select:none;width:34px;.euiBadge__content{position:relative;top:-1px;}.euiBadge__text{text-overflow:clip;}"]);d.displayName="RoundBadge";const p=({type:e})=>i.a.createElement(d,{"data-test-subj":"and-or-badge",color:"hollow"},"and"===e?c:u);p.displayName="RoundedBadge";const m=Object(o.css)(["background:",";position:relative;width:2px;&:after{background:",";content:'';height:8px;right:-4px;position:absolute;width:10px;clip-path:circle();}"],(({theme:e})=>e.eui.euiColorLightShade),(({theme:e})=>e.eui.euiColorLightShade)),g=s()(r.EuiFlexItem).withConfig({displayName:"TopAntenna",componentId:"sc-10c57g6-0"})([""," &:after{top:0;}"],m),f=s()(r.EuiFlexItem).withConfig({displayName:"BottomAntenna",componentId:"sc-10c57g6-1"})([""," &:after{bottom:0;}"],m),b=({type:e})=>i.a.createElement(r.EuiFlexGroup,{className:"andBadgeContainer",gutterSize:"none",direction:"column",alignItems:"center"},i.a.createElement(g,{"data-test-subj":"andOrBadgeBarTop",grow:1}),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(p,{type:e})),i.a.createElement(f,{"data-test-subj":"andOrBadgeBarBottom",grow:1}));b.displayName="RoundedBadgeAntenna";const y=i.a.memo((({type:e,includeAntennas:t=!1})=>t?i.a.createElement(b,{type:e}):i.a.createElement(p,{type:e})));y.displayName="AndOrBadge"},function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return l}));var a=n(4),i=n(231);const r=(e,t)=>{switch(t.type){case"FETCH_INIT":return{...e,parameters:t.payload,isLoading:!0};case"FETCH_SUCCESS":return{...e,data:t.payload,isLoading:!1,error:void 0};case"FETCH_FAILURE":return{...e,error:t.payload,isLoading:!1};case"FETCH_REPEAT":return{...e,isLoading:!0};default:return e}},o=(e,t,{disabled:n=!1,initialParameters:o}={})=>{const{startTracking:s}=Object(i.a)(),[{parameters:l,data:c,isLoading:u,error:d},p]=Object(a.useReducer)(r,{data:void 0,isLoading:void 0!==o,error:void 0,parameters:o}),m=Object(a.useCallback)((e=>p({type:"FETCH_INIT",payload:e})),[]),g=Object(a.useCallback)((()=>p({type:"FETCH_REPEAT"})),[]);return Object(a.useEffect)((()=>{if(!1===u||void 0===l||n)return;let a=!1;const i=new AbortController;return(async()=>{const{endTracking:n}=s({name:e});try{const e=await t(l,i.signal);n("success"),a||p({type:"FETCH_SUCCESS",payload:e})}catch(e){n(i.signal.aborted?"aborted":"error"),a||p({type:"FETCH_FAILURE",payload:e})}})(),()=>{a=!0,i.abort()}}),[u,l,n,t,s,e]),{fetch:m,refetch:g,data:c,isLoading:u,error:d}};var s=n(1);const l={SECURITY_DASHBOARDS:`${s.B} fetch security dashboards`,ANOMALIES_TABLE:`${s.B} fetch anomalies table data`,GET_RISK_SCORE_DEPRECATED:`${s.B} fetch is risk score deprecated`,ENABLE_RISK_SCORE:`${s.B} fetch enable risk score`,REFRESH_RISK_SCORE:`${s.B} fetch refresh risk score`,UPGRADE_RISK_SCORE:`${s.B} fetch upgrade risk score`}},function(e,t,n){"use strict";n.d(t,"c",(function(){return h})),n.d(t,"d",(function(){return v})),n.d(t,"a",(function(){return E})),n.d(t,"b",(function(){return x})),n.d(t,"e",(function(){return I}));var a=n(32),i=n(44),r=n.n(i),o=n(4),s=n.n(o),l=n(33),c=n.n(l);const u=c.a.span.withConfig({displayName:"ArrowBody",componentId:"sc-1jr26ur-0"})(["background-color:",";height:",";width:25px;"],(e=>e.theme.eui.euiColorLightShade),(({height:e})=>`${e}px`));u.displayName="ArrowBody";const d=s.a.memo((({direction:e})=>s.a.createElement(a.EuiIcon,{color:"subdued","data-test-subj":"arrow-icon",size:"s",type:e})));d.displayName="ArrowHead";var p=n(954);const m=Object(p.scaleLinear)().domain([0,100]).range([1,4]).clamp(!0),g=e=>Array.isArray(e)&&1===e.length;var f=n(88),b=n(257),y=n(640);const h="source.bytes",v="source.packets",E="destination.bytes",x="destination.packets",k=c.a.span.withConfig({displayName:"Percent",componentId:"sc-mlrd6t-0"})(["margin-right:5px;"]);k.displayName="Percent";const S=c()(a.EuiFlexGroup).withConfig({displayName:"SourceDestinationArrowsContainer",componentId:"sc-mlrd6t-1"})(["margin:0 2px;.euiToolTipAnchor{white-space:nowrap;}"]);S.displayName="SourceDestinationArrowsContainer";const w=c()(a.EuiText).withConfig({displayName:"Data",componentId:"sc-mlrd6t-2"})(["margin:0 5px;"]);w.displayName="Data";const j=s.a.memo((({contextId:e,eventId:t,isDraggable:n,sourceBytes:i,sourceBytesPercent:o,sourcePackets:l})=>{const c=null!=o?m(o):1;return s.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"none",justifyContent:"center"},s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(u,{height:null!=c?c:0})),null==i||isNaN(Number(i))?null:s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(f.b,{field:h,id:`source-arrow-default-draggable-${e}-${t}-${h}-${i}`,isDraggable:n,value:i},s.a.createElement(w,{size:"xs"},null!=o?s.a.createElement(k,null,`(${r()(o).format("0.00")}%)`):null,s.a.createElement("span",null,s.a.createElement(b.a,{value:i}))))),s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(u,{height:null!=c?c:0})),null==l||isNaN(Number(l))?null:s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(f.b,{field:v,id:`source-arrow-default-draggable-${e}-${t}-${v}-${l}`,isDraggable:n,value:l},s.a.createElement(w,{size:"xs"},s.a.createElement("span",null,`${l} ${y.a}`)))),s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(u,{height:null!=c?c:0})),s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(d,{direction:"arrowRight"})))}));j.displayName="SourceArrow";const O=s.a.memo((({contextId:e,destinationBytes:t,destinationBytesPercent:n,destinationPackets:i,eventId:o,isDraggable:l})=>{const c=null!=n?m(n):1;return s.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"none",justifyContent:"center"},s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(d,{direction:"arrowLeft"})),s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(u,{height:null!=c?c:0})),null==t||isNaN(Number(t))?null:s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(f.b,{field:E,id:`destination-arrow-default-draggable-${e}-${o}-${E}-${t}`,isDraggable:l,value:t},s.a.createElement(w,{size:"xs"},null!=n?s.a.createElement(k,null,`(${r()(n).format("0.00")}%)`):null,s.a.createElement("span",null,s.a.createElement(b.a,{value:t}))))),s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(u,{height:null!=c?c:0})),null==i||isNaN(Number(i))?null:s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(f.b,{field:x,id:`destination-arrow-default-draggable-${e}-${o}-${x}-${i}`,isDraggable:l,value:i},s.a.createElement(w,{size:"xs"},s.a.createElement("span",null,`${r()(i).format("0,0")} ${y.a}`)))),s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(u,{height:null!=c?c:0})))}));O.displayName="DestinationArrow";const I=s.a.memo((({contextId:e,destinationBytes:t,destinationPackets:n,eventId:i,isDraggable:r,sourceBytes:o,sourcePackets:l})=>{const c=null!=o&&g(o)?o[0]:void 0,u=null!=l&&g(l)?l[0]:void 0,d=null!=t&&g(t)?t[0]:void 0,p=null!=n&&g(n)?n[0]:void 0,m=null!=c&&null!=d?(({numerator:e,denominator:t})=>{if(!(Math.abs(t)<Number.EPSILON)&&Number.isFinite(e)&&Number.isFinite(t))return e/t*100})({numerator:Number(c),denominator:Number(c)+Number(d)}):void 0,f=null!=m?100-m:void 0;return s.a.createElement(S,{alignItems:"center",justifyContent:"center",direction:"column",gutterSize:"none"},null!=c?s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(j,{contextId:e,eventId:i,isDraggable:r,sourceBytes:c,sourcePackets:u,sourceBytesPercent:m})):null,null!=d?s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(O,{contextId:e,destinationBytes:d,destinationPackets:p,destinationBytesPercent:f,eventId:i,isDraggable:r})):null)}));I.displayName="SourceDestinationArrows"},function(e,t,n){"use strict";n.d(t,"a",(function(){return k}));var a=n(32),i=n(284),r=n(4),o=n.n(r),s=n(33),l=n.n(s),c=n(44),u=n.n(c),d=n(1),p=n(88),m=n(77),g=n(303),f=n(191);const b=l()(a.EuiFlexItem).withConfig({displayName:"CountFlexItem",componentId:"sc-rk4fis-0"})(["",""],(({theme:e})=>`margin-right: ${e.eui.euiSizeS};`)),y=o.a.memo((({value:e})=>Object(f.a)(e)?o.a.createElement(o.a.Fragment,null,e):o.a.createElement("em",{"data-test-subj":"value-wrapper-empty"},g.c)));y.displayName="ValueWrapper";const h=({legendItem:e})=>{const[t]=Object(m.q)(d.Z),{color:n,count:i,dataProviderId:r,field:s,scopeId:l,value:c}=e;return o.a.createElement(a.EuiText,{size:"xs"},o.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"none",responsive:!1},null!=n&&o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(a.EuiHealth,{"data-test-subj":"legend-color",color:n})),o.a.createElement(a.EuiFlexItem,{grow:!0},o.a.createElement(a.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween",gutterSize:"none",responsive:!1},o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(p.b,{"data-test-subj":`legend-item-${r}`,field:s,hideTopN:!0,id:r,isDraggable:!1,scopeId:l,value:c},null==e.render?o.a.createElement(y,{value:c}):e.render({field:s,value:c}))),null!=i&&o.a.createElement(b,{"data-test-subj":"legendItemCount",grow:!1},u()(i).format(t))))))};h.displayName="DraggableLegendItemComponent";const v=o.a.memo(h),E=l.a.div.withConfig({displayName:"DraggableLegendContainer",componentId:"sc-hedj5c-0"})(["height:",";overflow:auto;scrollbar-width:thin;width:100%;@media only screen and (min-width:","){width:165px;}min-width:",";&::-webkit-scrollbar{height:",";width:",";}&::-webkit-scrollbar-thumb{background-clip:content-box;background-color:",";border:"," solid transparent;}&::-webkit-scrollbar-corner,&::-webkit-scrollbar-track{background-color:transparent;}"],(({height:e})=>`${e}px`),(({theme:e})=>e.eui.euiBreakpoints.m),(({$minWidth:e})=>`${e}px`),(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>Object(i.rgba)(e.eui.euiColorDarkShade,.5)),(({theme:e})=>e.eui.euiScrollBarCorner)),x=({className:e,height:t,legendItems:n,minWidth:i=165})=>0===n.length?null:o.a.createElement(E,{className:e,"data-test-subj":"draggable-legend",height:0===t?175:t,$minWidth:i},o.a.createElement(a.EuiText,{size:"xs"},o.a.createElement(a.EuiFlexGroup,{direction:"column",gutterSize:"none"},n.map((e=>o.a.createElement(a.EuiFlexItem,{key:e.dataProviderId,grow:!1},o.a.createElement(v,{legendItem:e}),o.a.createElement(a.EuiSpacer,{"data-test-subj":"draggable-legend-spacer",size:"s"})))))));x.displayName="DraggableLegendComponent";const k=o.a.memo(x)},function(e,t,n){"use strict";e.exports=n(726)},function(e,t,n){"use strict";e.exports=n(733)},function(e,t,n){"use strict";const a=n(736);e.exports=async(e,t,{concurrency:n=1/0,stopOnError:i=!0}={})=>new Promise(((r,o)=>{if("function"!=typeof t)throw new TypeError("Mapper function is required");if(!Number.isSafeInteger(n)&&n!==1/0||!(n>=1))throw new TypeError(`Expected \`concurrency\` to be an integer from 1 and up or \`Infinity\`, got \`${n}\` (${typeof n})`);const s=[],l=[],c=e[Symbol.iterator]();let u=!1,d=!1,p=0,m=0;const g=()=>{if(u)return;const e=c.next(),n=m;if(m++,e.done)return d=!0,void(0===p&&(i||0===l.length?r(s):o(new a(l))));p++,(async()=>{try{const a=await e.value;s[n]=await t(a,n),p--,g()}catch(e){i?(u=!0,o(e)):(l.push(e),p--,g())}})()};for(let e=0;e<n&&(g(),!d);e++);}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return HostIsolationExceptionsApiClient}));var a=n(110),i=n(315),r=n(523);class HostIsolationExceptionsApiClient extends i.a{constructor(e){super(e,a.h,r.a)}static getInstance(e){return super.getInstance(e,a.h,r.a)}}},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var a=n(0);const i=a.i18n.translate("xpack.securitySolution.beatFields.errorSearchDescription",{defaultMessage:"An error has occurred on getting beat fields"}),r=a.i18n.translate("xpack.securitySolution.beatFields.failSearchDescription",{defaultMessage:"Failed to run search on beat fields"})},function(e,t,n){var a=n(746),i=n(747);e.exports=function(e,t,n){return a(i,e,t,n)}},function(e,t,n){var a=n(434),i=n(435),r=i?function(e,t){return i.set(e,t),e}:a;e.exports=r},function(e,t,n){e.exports=n(27)(1542)},function(e,t,n){var a=n(749),i=a&&new a;e.exports=i},function(e,t,n){e.exports=n(27)(3432)},function(e,t,n){var a=n(438),i=n(439),r=n(752),o=n(269),s=n(440),l=n(446),c=n(769),u=n(337),d=n(270);e.exports=function e(t,n,p,m,g,f,b,y,h,v){var E=128&n,x=1&n,k=2&n,S=24&n,w=512&n,j=k?void 0:o(t);return function O(){for(var I=arguments.length,T=Array(I),C=I;C--;)T[C]=arguments[C];if(S)var M=l(O),N=r(T,M);if(m&&(T=a(T,m,g,S)),f&&(T=i(T,f,b,S)),I-=N,S&&I<v){var D=u(T,M);return s(t,n,e,O.placeholder,p,T,D,y,h,v-I)}var F=x?p:this,A=k?F[t]:t;return I=T.length,y?T=c(T,y):w&&I>1&&T.reverse(),E&&h<I&&(T.length=h),this&&this!==d&&this instanceof O&&(A=j||o(A)),A.apply(F,T)}}},function(e,t){var n=Math.max;e.exports=function(e,t,a,i){for(var r=-1,o=e.length,s=a.length,l=-1,c=t.length,u=n(o-s,0),d=Array(c+u),p=!i;++l<c;)d[l]=t[l];for(;++r<s;)(p||r<o)&&(d[a[r]]=e[r]);for(;u--;)d[l++]=e[r++];return d}},function(e,t){var n=Math.max;e.exports=function(e,t,a,i){for(var r=-1,o=e.length,s=-1,l=a.length,c=-1,u=t.length,d=n(o-l,0),p=Array(d+u),m=!i;++r<d;)p[r]=e[r];for(var g=r;++c<u;)p[g+c]=t[c];for(;++s<l;)(m||r<o)&&(p[g+a[s]]=e[r++]);return p}},function(e,t,n){var a=n(753),i=n(443),r=n(444);e.exports=function(e,t,n,o,s,l,c,u,d,p){var m=8&t;t|=m?32:64,4&(t&=~(m?64:32))||(t&=-4);var g=[e,t,s,m?l:void 0,m?c:void 0,m?void 0:l,m?void 0:c,u,d,p],f=n.apply(void 0,g);return a(e)&&i(f,g),f.placeholder=o,r(f,e,t)}},function(e,t,n){var a=n(435),i=n(754),r=a?function(e){return a.get(e)}:i;e.exports=r},function(e,t,n){var a=n(330),i=n(333);function r(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}r.prototype=a(i.prototype),r.prototype.constructor=r,e.exports=r},function(e,t,n){var a=n(433),i=n(759)(a);e.exports=i},function(e,t,n){var a=n(760),i=n(761),r=n(762),o=n(763);e.exports=function(e,t,n){var s=t+"";return r(e,i(s,o(a(s),n)))}},function(e,t,n){e.exports=n(27)(3400)},function(e,t){e.exports=function(e){return e.placeholder}},function(e,t,n){e.exports=n(27)(3384)},function(e,t,n){e.exports=n(27)(3399)},function(e,t,n){e.exports=n(27)(888)},function(e,t,n){e.exports=n(27)(3065)},function(e,t,n){var a=n(331);e.exports=function(e){return e==e&&!a(e)}},function(e,t){e.exports=function(e,t){return function(n){return null!=n&&n[e]===t&&(void 0!==t||e in Object(n))}}},function(e,t,n){e.exports=n(27)(1155)},function(e,t,n){e.exports=n(27)(3394)},function(e,t,n){var a=n(808),i=n(453),r=n(449),o=n(336),s=n(331),l=n(219);e.exports=function(e,t,n,c){if(!s(e))return e;for(var u=-1,d=(t=i(t,e)).length,p=d-1,m=e;null!=m&&++u<d;){var g=l(t[u]),f=n;if("prototype"==g&&r(m))throw new Error("Illegal access of function prototype");if(u!=p){var b=hasOwnProperty.call(m,g)?m[g]:void 0;void 0===(f=c?c(b,g,m):void 0)&&(f=s(b)?b:o(t[u+1])?[]:{})}a(m,g,f),m=m[g]}return e}},function(e,t,n){e.exports=n(27)(3572)},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));var a=n(401),i=n(132);const r=e=>Object(a.flow)(l)(e),o=e=>Object(a.flow)(s)(e),s=e=>{if("threat_match"===e.type&&null!=e.threat_mapping){const t=e.threat_mapping.map((e=>{const t=e.entries.map((e=>Object(i.d)(e)));return Object(i.d)({entries:t})}));return{...e,threat_mapping:t}}return e},l=e=>{if("threat_match"===e.type&&null!=e.threat_mapping){const t=e.threat_mapping.map((e=>{const t=e.entries.map((e=>Object(i.g)(e)));return{...Object(i.g)(e),entries:t}}));return{...e,threat_mapping:t}}return e}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(4),i=n.n(a),r=n(32),o=n(696);const s=Object(a.forwardRef)((({onChange:e,value:t,ariaLabel:n,editorId:s,dataTestSubj:l,height:c,autoFocusDisabled:u},d)=>{const[p,m]=Object(a.useState)([]),g=Object(a.useCallback)(((e,{messages:t})=>{m(e?[e]:t)}),[]),f=Object(a.useRef)(null);return Object(a.useEffect)((()=>{var e,t;u||null===(e=f.current)||void 0===e||null===(t=e.textarea)||void 0===t||t.focus()}),[u]),Object(a.useImperativeHandle)(d,(()=>{var e,t;if(!f.current)return null;const n=null===(e=f.current)||void 0===e||null===(t=e.textarea)||void 0===t?void 0:t.closest(".euiMarkdownEditor");return{...f.current,toolbar:null==n?void 0:n.querySelector(".euiMarkdownEditorToolbar")}})),i.a.createElement(r.EuiMarkdownEditor,{ref:f,"aria-label":n,editorId:s,onChange:e,value:t,uiPlugins:o.c,parsingPluginList:o.a,processingPluginList:o.b,onParse:g,errors:p,"data-test-subj":l,height:c})}));s.displayName="MarkdownEditorComponent";const l=Object(a.memo)(s)},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(4),i=n.n(a),r=n(33),o=n.n(r),s=n(32),l=n(100),c=n(458);const u=o()(s.EuiFlexGroup).withConfig({displayName:"BottomContentWrapper",componentId:"sc-naitv4-0"})(["",""],(({theme:e})=>`\n    padding: ${e.eui.euiSizeM} 0;\n  `)),d=i.a.memo(Object(a.forwardRef)((({id:e,field:t,dataTestSubj:n,idAria:a,bottomRightContent:r},o)=>{const{isInvalid:d,errorMessage:p}=Object(l.i)(t);return i.a.createElement(s.EuiFormRow,{"data-test-subj":n,describedByIds:a?[a]:void 0,error:p,fullWidth:!0,helpText:t.helpText,isInvalid:d,label:t.label,labelAppend:t.labelAppend},i.a.createElement(i.a.Fragment,null,i.a.createElement(c.a,{ref:o,ariaLabel:a,editorId:e,onChange:t.setValue,value:t.value,"data-test-subj":`${n}-markdown-editor`}),r&&i.a.createElement(u,{justifyContent:"flexEnd"},i.a.createElement(s.EuiFlexItem,{grow:!1},r))))})));d.displayName="MarkdownEditorForm"},function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return u}));var a=n(49),i=n(34),r=n(198);const o=e=>e.toLocaleString(),s=({chartHeight:e,from:t,legendPosition:n,to:i,onBrushEnd:s,yTickFormatter:l,showLegend:c})=>({series:{xScaleType:a.ScaleType.Time,yScaleType:a.ScaleType.Linear,stackAccessors:["g"]},axis:{xTickFormatter:Object(r.a)([t,i]),yTickFormatter:null!=l?l:o,tickSize:8},settings:{legendPosition:null!=n?n:a.Position.Right,onBrushEnd:s,showLegend:null==c||c,showLegendExtra:!0,theme:{scales:{barsPadding:.08},chartMargins:{left:0,right:0,top:0,bottom:0},chartPaddings:{left:0,right:0,top:0,bottom:0}}},customHeight:null!=e?e:174}),l=["#1EA593","#2B70F7","#CE0060","#38007E","#FCA5D3","#F37020","#E49E29","#B0916F","#7B000B","#34130C","#GGGGGG"],c=([e,t])=>({key:e,value:t}),u=(e,t)=>{if(!e)return[];const n=Object(i.groupBy)("g",e),a=Object(i.toPairs)(n);return Object(i.map)(c,a).map(((e,n)=>{var a;const r=Object(i.get)(e.key,t);return{...e,color:null!==(a=null==r?void 0:r.color)&&void 0!==a?a:l[n]}}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return l}));var a=n(158),i=n(159),r=n(118);const o=e=>{var t,n;const i=null!==(t=null==e||null===(n=e.isPlatinumPlus)||void 0===n?void 0:n.call(e))&&void 0!==t&&t;return[{columnHeaderType:a.a,displayAsText:r.r,id:"kibana.alert.severity",initialWidth:105},{columnHeaderType:a.a,displayAsText:r.o,id:"kibana.alert.risk_score",initialWidth:100},{columnHeaderType:a.a,displayAsText:r.n,id:"kibana.alert.reason",initialWidth:450},{columnHeaderType:a.a,id:"host.name"},i?{columnHeaderType:a.a,id:"host.risk.calculated_level"}:null,{columnHeaderType:a.a,id:"user.name"},i?{columnHeaderType:a.a,id:"user.risk.calculated_level"}:null,{columnHeaderType:a.a,id:"process.name"},{columnHeaderType:a.a,id:"file.name"},{columnHeaderType:a.a,id:"source.ip"},{columnHeaderType:a.a,id:"destination.ip"}].filter((e=>null!=e))},s=e=>[{columnHeaderType:a.a,id:"@timestamp",initialWidth:i.b+10},{columnHeaderType:a.a,displayAsText:r.p,id:"kibana.alert.rule.name",initialWidth:i.a,linkField:"kibana.alert.rule.uuid"},...o(e)],l=e=>[{columnHeaderType:a.a,id:"kibana.alert.original_time",initialWidth:i.b+10},...o(e)]},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var a=n(4);const i=({field:e,value:t})=>null==t?e:Array.isArray(t)?`${e} ${t.join(" ")}`:`${e} ${t}`,r=e=>{const[t,n]=Object(a.useState)(!1),i=Object(a.useCallback)((()=>{n((t=>{const n=!t;return e&&e(n),n}))}),[e]);return{closeTopN:Object(a.useCallback)((()=>{n(!1)}),[]),toggleTopN:i,isShowingTopN:t}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return o}));const a={critical:"#E7664C",high:"#DA8B45",medium:"#D6BF57",low:"#54B399"},i=4,r=(e=0)=>Math.ceil(Math.min(e||0,100)/i),o={field:"kibana.alert.workflow_status",value:"open"}},function(e,t,n){"use strict";function a(e,t,n){return Math.max(Math.min(e,n),t)}function i(e,t,n){return e*(1-n)+t*n}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}))},function(e,t,n){"use strict";function a(e,t){return"nodeEventsInCategory"===t.panelView&&t.panelParameters.nodeID===e.nodeID&&t.panelParameters.eventCategory===e.eventCategory}function i(e,t){return e.nodeID===t.nodeID&&e.eventCategory===t.eventCategory?{nodeID:e.nodeID,eventCategory:e.eventCategory,events:[...e.events,...t.events],cursor:t.cursor,lastCursorRequested:null}:void 0}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return s}));var a=n(144);function i(e){return void 0!==(null==e?void 0:e.ancestry)?200:20}function r(e){return void 0!==(null==e?void 0:e.ancestry)?0:10}function o(){return 500}function s(e){const t=new Map;for(const n of e.nodes)if(n.stats){const e=a.b(n);t.set(e,n.stats)}return t}},function(e,t,n){"use strict";function a(e,t){return!!t&&(e===t||e.databaseDocumentID===t.databaseDocumentID&&e.filters.from===t.filters.from&&e.filters.to===t.filters.to&&function(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;const n=new Set(e);for(let e=0;e<t.length;e++)if(!n.has(t[e]))return!1;return!0}(e.indices,t.indices))}n.d(t,"a",(function(){return a}))},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"f",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return l})),n.d(t,"e",(function(){return c}));var a=n(0);const i=a.i18n.translate("xpack.securitySolution.threatMatch.fieldDescription",{defaultMessage:"Field"}),r=a.i18n.translate("xpack.securitySolution.threatMatch.threatFieldDescription",{defaultMessage:"Indicator index field"}),o=a.i18n.translate("xpack.securitySolution.threatMatch.fieldPlaceholderDescription",{defaultMessage:"Search"}),s=a.i18n.translate("xpack.securitySolution.threatMatch.matchesLabel",{defaultMessage:"MATCHES"}),l=a.i18n.translate("xpack.securitySolution.threatMatch.andDescription",{defaultMessage:"AND"}),c=a.i18n.translate("xpack.securitySolution.threatMatch.orDescription",{defaultMessage:"OR"})},function(e,t,n){"use strict";n.d(t,"g",(function(){return i})),n.d(t,"n",(function(){return r})),n.d(t,"t",(function(){return o})),n.d(t,"r",(function(){return s})),n.d(t,"p",(function(){return l})),n.d(t,"q",(function(){return c})),n.d(t,"l",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"o",(function(){return p})),n.d(t,"w",(function(){return m})),n.d(t,"s",(function(){return g})),n.d(t,"m",(function(){return f})),n.d(t,"j",(function(){return b})),n.d(t,"k",(function(){return y})),n.d(t,"h",(function(){return h})),n.d(t,"i",(function(){return v})),n.d(t,"v",(function(){return E})),n.d(t,"u",(function(){return x})),n.d(t,"c",(function(){return k})),n.d(t,"d",(function(){return S})),n.d(t,"e",(function(){return w})),n.d(t,"a",(function(){return j})),n.d(t,"b",(function(){return O}));var a=n(0);const i=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.filtersLabel",{defaultMessage:"Filters"}),r=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.QueryLabel",{defaultMessage:"Custom query"}),o=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.threatQueryLabel",{defaultMessage:"Indicator index query"}),s=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.savedIdLabel",{defaultMessage:"Saved query name"}),l=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.savedQueryFiltersLabel",{defaultMessage:"Saved query filters"}),c=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.savedQueryLabel",{defaultMessage:"Saved query"}),u=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.mlRuleTypeDescription",{defaultMessage:"Machine Learning"}),d=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.eqlRuleTypeDescription",{defaultMessage:"Event Correlation"}),p=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.queryRuleTypeDescription",{defaultMessage:"Query"}),m=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.thresholdRuleTypeDescription",{defaultMessage:"Threshold"}),g=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.threatMatchRuleTypeDescription",{defaultMessage:"Indicator Match"}),f=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.newTermsRuleTypeDescription",{defaultMessage:"New Terms"}),b=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.mlRunJobLabel",{defaultMessage:"Run job"}),y=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.mlStopJobLabel",{defaultMessage:"Stop job"}),h=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.mlJobStartedDescription",{defaultMessage:"Started"}),v=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.mlJobStoppedDescription",{defaultMessage:"Stopped"}),E=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.thresholdResultsAllDescription",{defaultMessage:"All results"}),x=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.thresholdResultsAggregatedByDescription",{defaultMessage:"Results aggregated by"}),k=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.eqlEventCategoryFieldLabel",{defaultMessage:"Event category field"}),S=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.eqlTiebreakerFieldLabel",{defaultMessage:"Tiebreaker field"}),w=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.eqlTimestampFieldLabel",{defaultMessage:"Timestamp field"}),j=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.alertSuppressionInsufficientLicense",{defaultMessage:"Alert suppression is configured but will not be applied due to insufficient licensing"}),O=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.alertSuppressionTechnicalPreview",{defaultMessage:"Technical Preview"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(4),i=n.n(a),r=n(88),o=n(87),s=n(89);const l=i.a.memo((({Component:e,contextId:t,eventId:n,fieldName:a,fieldType:l,isAggregatable:c,isDraggable:u,title:d,value:p})=>u?i.a.createElement(r.b,{"data-test-subj":"port",field:a,fieldType:l,isAggregatable:c,id:`port-default-draggable-${t}-${n}-${a}-${p}`,isDraggable:u,tooltipContent:a,value:p},i.a.createElement(s.i,{portOrServiceName:p||Object(o.e)(),Component:e,title:d})):i.a.createElement(s.i,{portOrServiceName:p||Object(o.e)(),Component:e,title:d})));l.displayName="Port"},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"e",(function(){return r})),n.d(t,"h",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return c})),n.d(t,"g",(function(){return u})),n.d(t,"f",(function(){return d}));var a=n(135);a.i,a.i,a.i;const i=`${a.i}.group.id`,r=(a.i,`${a.i}.original_time`),o=`${a.i}.threshold_result`,s=`${a.i}.new_terms`,l=`${a.A}.new_terms_fields`,c=`${a.i}.original_event`,u=(a.y,a.y,a.y,a.y,a.y,a.y,a.y,a.y,a.y,a.y,`${a.y}.timeline_id`),d=(a.y,a.y,`${a.y}.indices`)},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(4),i=n(78),r=n(38),o=n(99),s=n(217);const l=({alertStatus:e,closePopover:t,eventId:n,scopeId:l,indexName:c,refetch:u})=>{const d=Object(i.useDispatch)(),{hasIndexWrite:p}=Object(s.a)(),m=Object(a.useCallback)((()=>{t(),u&&u()}),[t,u]),g=Object(o.getScopedActions)(l),f=Object(a.useCallback)((({eventIds:e,isLoading:t})=>{g&&d(g.setEventsLoading({id:l,eventIds:e,isLoading:t}))}),[d,l,g]),b=Object(a.useCallback)((({eventIds:e,isDeleted:t})=>{g&&d(g.setEventsDeleted({id:l,eventIds:e,isDeleted:t}))}),[d,l,g]),y=Object(r.useBulkActionItems)({eventIds:[n],currentStatus:e,indexName:c,setEventsLoading:f,setEventsDeleted:b,onUpdateSuccess:m,onUpdateFailure:m});return{actionItems:p?y:[]}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a="_id"},function(e,t,n){"use strict";n.d(t,"h",(function(){return d})),n.d(t,"j",(function(){return p})),n.d(t,"i",(function(){return m})),n.d(t,"k",(function(){return g})),n.d(t,"g",(function(){return f})),n.d(t,"b",(function(){return b})),n.d(t,"d",(function(){return y})),n.d(t,"c",(function(){return h})),n.d(t,"e",(function(){return v})),n.d(t,"a",(function(){return E})),n.d(t,"f",(function(){return w}));var a=n(32),i=n(34),r=n(4),o=n.n(r),s=n(33),l=n.n(s),c=n(88),u=n(475);const d="source.geo.continent_name",p="source.geo.country_name",m="source.geo.country_iso_code",g="source.geo.region_name",f="source.geo.city_name",b="destination.geo.continent_name",y="destination.geo.country_name",h="destination.geo.country_iso_code",v="destination.geo.region_name",E="destination.geo.city_name",x=[{prop:"GeoContinentName",fieldName:"geo.continent_name"},{prop:"GeoCountryName",fieldName:"geo.country_name"},{prop:"GeoCountryIsoCode",fieldName:"geo.country_iso_code"},{prop:"GeoRegionName",fieldName:"geo.region_name"},{prop:"GeoCityName",fieldName:"geo.city_name"}],k=l()(a.EuiFlexItem).withConfig({displayName:"GeoFlexItem",componentId:"sc-pwy3t3-0"})(["margin-right:5px;"]);k.displayName="GeoFlexItem";const S=o.a.memo((({contextId:e,eventId:t,fieldName:n,isDraggable:r,values:s})=>null!=s?o.a.createElement(o.a.Fragment,null,Object(i.uniq)(s).map((i=>o.a.createElement(k,{grow:!1,key:`${e}-${t}-${n}-${i}`},o.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},n===m||n===h?o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(u.a,{countryCode:i})):null,o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(c.b,{"data-test-subj":n,field:n,id:`geo-field-values-default-draggable-${e}-${t}-${n}-${i}`,isDraggable:r,tooltipContent:n,value:i}))))))):null));S.displayName="GeoFieldValues";const w=o.a.memo((e=>{const{contextId:t,eventId:n,isDraggable:r,type:s}=e,l=(e=>x.map((({prop:t,fieldName:n})=>({prop:`${e}${t}`,fieldName:`${e}.${n}`}))))(s);return o.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},Object(i.uniq)(l).map((a=>o.a.createElement(S,{contextId:t,eventId:n,fieldName:a.fieldName,isDraggable:r,key:a.fieldName,values:Object(i.get)(a.prop,e)}))))}));w.displayName="GeoFields"},function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return g}));var a=n(4),i=n.n(a),r=n(34),o=n(32),s=n(959),l=n.n(s),c=n(962),u=n(33);const d=n.n(u).a.span.withConfig({displayName:"FlagWrapper",componentId:"sc-1v0q7zl-0"})(["position:relative;top:1px;"]),p=e=>e&&2===e.length?e.toUpperCase().replace(/./g,(e=>String.fromCharCode(55356,56741+e.charCodeAt(0)))):null,m=Object(a.memo)((({countryCode:e,displayCountryNameOnHover:t=!1})=>{Object(a.useEffect)((()=>{t&&Object(r.isEmpty)(l.a.getNames("en"))&&l.a.registerLocale(c)}),[]);const n=p(e);return null!==n?t?i.a.createElement(o.EuiToolTip,{position:"top",content:l.a.getName(e,"en")},i.a.createElement(d,{"data-test-subj":"country-flag"},n)):i.a.createElement(d,{"data-test-subj":"country-flag"},n):null}));m.displayName="CountryFlag";const g=Object(a.memo)((({countryCode:e,displayCountryNameOnHover:t=!1})=>{const[n,s]=Object(a.useState)(!1);Object(a.useEffect)((()=>{Object(r.isEmpty)(l.a.getNames("en"))&&l.a.registerLocale(c),s(!0)}),[]);const u=p(e);return null!==u&&n?t?i.a.createElement(o.EuiToolTip,{position:"top",content:l.a.getName(e,"en")},i.a.createElement(d,{"data-test-subj":"country-flag"},u)):i.a.createElement(i.a.Fragment,null,i.a.createElement(d,{"data-test-subj":"country-flag"},u),` ${l.a.getName(e,"en")}`):null}));g.displayName="CountryFlagAndName"},function(e,t,n){"use strict";n.d(t,"c",(function(){return m})),n.d(t,"b",(function(){return g})),n.d(t,"a",(function(){return b}));var a=n(32),i=n(34),r=n(4),o=n.n(r),s=n(33),l=n.n(s),c=n(88),u=n(305),d=n(101),p=n(722);const m="event.start",g="event.end",f=l()(a.EuiIcon).withConfig({displayName:"TimeIcon",componentId:"sc-1thf9pb-0"})(["margin-right:3px;position:relative;top:-1px;"]);f.displayName="TimeIcon";const b=o.a.memo((({contextId:e,eventDuration:t,eventId:n,eventEnd:r,eventStart:s,isDraggable:l})=>o.a.createElement(a.EuiFlexGroup,{alignItems:"flexStart","data-test-subj":"duration-and-start-group",direction:"column",justifyContent:"center",gutterSize:"none"},null!=t?Object(i.uniq)(t).map((t=>o.a.createElement(a.EuiFlexItem,{grow:!1,key:t},o.a.createElement(c.b,{field:u.b,id:`duration-event-start-end-default-draggable-${e}-${n}-${u.b}-${t}`,isDraggable:l,name:name,tooltipContent:null,value:t},o.a.createElement(a.EuiText,{size:"xs"},o.a.createElement(f,{size:"m",type:"clock"}),o.a.createElement(p.a,{maybeDurationNanoseconds:t,tooltipTitle:u.b})))))):null,null!=s?Object(i.uniq)(s).map((t=>o.a.createElement(a.EuiFlexItem,{grow:!1,key:t},o.a.createElement(c.b,{field:m,id:`duration-event-start-end-default-draggable-${e}-${n}-${m}-${t}`,isDraggable:l,tooltipContent:null,value:t},o.a.createElement(a.EuiText,{size:"xs"},o.a.createElement(f,{size:"m",type:"clock"}),o.a.createElement(d.a,{fieldName:m,value:t})))))):null,null!=r?Object(i.uniq)(r).map((t=>o.a.createElement(a.EuiFlexItem,{grow:!1,key:t},o.a.createElement(c.b,{field:g,id:`duration-event-start-end-default-draggable-${e}-${n}-${g}-${t}`,isDraggable:l,tooltipContent:null,value:t},o.a.createElement(a.EuiText,{size:"xs"},o.a.createElement(f,{size:"m",type:"clock"}),o.a.createElement(d.a,{fieldName:g,value:t})))))):null)));b.displayName="DurationEventStartEnd"},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(4),i=n.n(a),r=n(88),o=n(97);const s=({args:e,contextId:t,eventId:n,processTitle:a,isDraggable:s})=>Object(o.e)(e)&&Object(o.e)(a)?null:i.a.createElement(i.a.Fragment,null,null!=e&&e.map(((e,a)=>i.a.createElement(o.c,{key:`${t}-args-${a}-${e}`,grow:!1,component:"span"},i.a.createElement(r.c,{contextId:`${t}-args-${a}-${e}`,eventId:n,field:"process.args",isDraggable:s,value:e,fieldType:"keyword",isAggregatable:!0})))),!Object(o.e)(a)&&i.a.createElement(o.c,{grow:!1,component:"span"},i.a.createElement(r.c,{contextId:t,eventId:n,field:"process.title",isDraggable:s,value:a,fieldType:"keyword",isAggregatable:!0})));s.displayName="ArgsComponent";const l=i.a.memo(s);l.displayName="Args"},function(e,t,n){"use strict";n.d(t,"a",(function(){return j})),n.d(t,"c",(function(){return R})),n.d(t,"b",(function(){return P}));var a=n(34),i=n(43),r=n.n(i),o=n(52),s=n.n(o),l=n(45),c=n(0),u=n(135),d=n(11),p=n(471),m=n(79),g=(n(193),n(697)),f=n(112),b=n(136),y=n(146),h=n(99),v=n(651),E=n(227),x=n(77),k=n(1),S=n(876),w=n(381);const j=e=>({query:{bool:{filter:{terms:{_id:e}}}}}),O=({ecs:e})=>{var t,n;if(Array.isArray(e)){const t=e.reduce(((e,t)=>{const n=t.timestamp?new Date(t.timestamp):new Date;return e.includes(n.valueOf())?e:[...e,n.valueOf()]}),[]);return{from:new Date(Math.min(...t)).toISOString(),to:new Date(Math.max(...t)).toISOString()}}const a=e,i=Object(h.getField)(a,u.u),o=r.a.duration(r()().diff(s.a.parse(null!=i?i[0]:"now-1d"))),l=r()(null!==(t=a.timestamp)&&void 0!==t?t:new Date).subtract(o).toISOString();return{to:r()(null!==(n=a.timestamp)&&void 0!==n?n:new Date).toISOString(),from:l}},I=e=>{const t=Object(h.getField)(e,u.H);return"threshold"===t||Array.isArray(t)&&t.length>0&&"threshold"===t[0]},T=e=>{const t=Object(h.getField)(e,u.H);return"new_terms"===t||Array.isArray(t)&&t.length>0&&"new_terms"===t[0]},C=e=>null!=Object(h.getField)(e,u.Q),M=(e,t,n="Alert Ids")=>1===t.length?[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:e,params:{query:t[0]}},query:{match_phrase:{_id:t[0]}},$state:{store:l.FilterStateStore.APP_STATE}}]:[{query:{bool:{filter:{ids:{values:t}}}},meta:{alias:n,negate:!1,disabled:!1,type:"phrases",key:e,value:t.join(),params:t},$state:{store:l.FilterStateStore.APP_STATE}}],N=(e,t)=>{const n=1===t.length;return[{and:[],id:`send-alert-to-timeline-action-default-draggable-event-details-value-formatted-field-value-${m.j.active}-alert-id-${t.join(",")}`,name:t.join(","),enabled:!0,excluded:!1,kqlQuery:"",queryMatch:{field:e,value:n?t[0]:t,operator:n?":":"includes"}}]},D=(e,t,n)=>({filters:"KqlFilter"===t?M("_id",e,n):[],dataProviders:"dataProvider"===t?N("_id",e):[]}),F=async(e,t,n,a,i)=>{try{var o,l,d,g,b,y,v,E,j,O,I,T,C,M,N,D,F,A,_,R,P,L;const c=await x.b.get().http.fetch(k.mb,{method:"POST",body:JSON.stringify(Object(S.a)([e._id]))}),w=(null!==(o=null==c?void 0:c.hits.hits.reduce(((e,{_id:t,_index:n,_source:a={}})=>[...e,{...Object(S.b)(a),_id:t,_index:n,timestamp:a["@timestamp"]}]),[]))&&void 0!==o?o:[])[0],q=Object(h.getField)(w,u.A),B=(null!==(l=null!==(d=q.filters)&&void 0!==d?d:null===(g=w.signal)||void 0===g||null===(b=g.rule)||void 0===b?void 0:b.filters)&&void 0!==l?l:[]).map((e=>null!=e.meta?e:{...e,meta:{}})),z=null!==(y=null!==(v=q.language)&&void 0!==v?v:null===(E=w.signal)||void 0===E||null===(j=E.rule)||void 0===j?void 0:j.language)&&void 0!==y?y:"kuery",$=null!==(O=null!==(I=q.query)&&void 0!==I?I:null===(T=w.signal)||void 0===T||null===(C=T.rule)||void 0===C?void 0:C.query)&&void 0!==O?O:"",V=null!==(M=null!==(N=Object(h.getField)(w,p.f))&&void 0!==N?N:null===(D=w.signal)||void 0===D||null===(F=D.rule)||void 0===F?void 0:F.index)&&void 0!==M?M:[],{thresholdFrom:U,thresholdTo:H,dataProviders:G}=(e=>(Array.isArray(e)?e:[e]).reduce(((e,t)=>{var n,a,i,o;const l=null!==(n=Object(h.getField)(t,`${u.A}.threshold`))&&void 0!==n?n:null===(a=t.signal)||void 0===a||null===(i=a.rule)||void 0===i?void 0:i.threshold,c=Object(h.getField)(t,p.h),d=Object(h.getField)(t,p.e),g=Array.isArray(d)?d[0]:d,f=r()(g),b=((e,t)=>{const n=Object(h.getField)(e,u.u),a=Array.isArray(n)?n[0]:n,i=s.a.parse(a),o=r()(),l=r.a.duration(o.diff(i));return t.clone().subtract(l)})(t,f),y=Array.isArray(l.field)?l.field:[l.field];return{thresholdFrom:null!==(o=c.from)&&void 0!==o?o:b.toISOString(),thresholdTo:f.toISOString(),dataProviders:[...e.dataProviders,...y.reduce(((e,t,n)=>{const a=c.terms.filter((e=>e.field===t))[0].value,i=Array.isArray(a)?a[0]:a;if(!i)return e;const r=t.replace(".","-"),o={id:`send-alert-to-timeline-action-default-draggable-event-details-value-formatted-field-value-${m.j.active}-${r}-${i}`,name:t,enabled:!0,excluded:!1,kqlQuery:"",queryMatch:{field:t,value:i,operator:":"}};return 0===n?[...e,{...o,and:[]}]:(e[0].and.push(o),e)}),[])]}}),{dataProviders:[],thresholdFrom:"",thresholdTo:""}))(w),Q=await i(e),W=(null!==(A=a.filters)&&void 0!==A?A:B).concat(Q?[Q]:[]);return t({from:U,notes:null,timeline:{...f.b,columns:null!==(_=a.columns)&&void 0!==_?_:f.b.columns,description:`_id: ${w._id}`,filters:W,dataProviders:null!==(R=a.dataProviders)&&void 0!==R?R:G,id:m.j.active,indexNames:V,dateRange:{start:U,end:H},eventType:"all",kqlQuery:{filterQuery:{kuery:{kind:z,expression:null!==(P=a.query)&&void 0!==P?P:$},serializedQuery:null!==(L=a.query)&&void 0!==L?L:$}}},to:H,ruleNote:n})}catch(n){const{toasts:a}=x.b.get().notifications;a.addError(n,{toastMessage:c.i18n.translate("xpack.securitySolution.detectionEngine.alerts.createThresholdTimelineFailure",{defaultMessage:"Failed to create timeline for document _id: {id}",values:{id:e._id}}),title:c.i18n.translate("xpack.securitySolution.detectionEngine.alerts.createThresholdTimelineFailureTitle",{defaultMessage:"Failed to create threshold alert timeline"})});const i=w.a.toISOString(),r=w.b.toISOString();return t({from:i,notes:null,timeline:{...f.b,id:m.j.active,indexNames:[],dateRange:{start:i,end:r},eventType:"all"},to:r})}},A=async(e,t,n,a,i)=>{try{var o,s,l,d,g,b,y,v,E,j,O,I,T,C,M,N,D,F,A,_,R,P;const c=await x.b.get().http.fetch(k.mb,{method:"POST",body:JSON.stringify(Object(S.a)([e._id]))}),w=(null!==(o=null==c?void 0:c.hits.hits.reduce(((e,{_id:t,_index:n,_source:a={}})=>[...e,{...Object(S.b)(a),_id:t,_index:n,timestamp:a["@timestamp"]}]),[]))&&void 0!==o?o:[])[0],L=Object(h.getField)(w,u.A),q=(null!==(s=null!==(l=L.filters)&&void 0!==l?l:null===(d=w.signal)||void 0===d||null===(g=d.rule)||void 0===g?void 0:g.filters)&&void 0!==s?s:[]).map((e=>null!=e.meta?e:{...e,meta:{}})),B=null!==(b=null!==(y=L.language)&&void 0!==y?y:null===(v=w.signal)||void 0===v||null===(E=v.rule)||void 0===E?void 0:E.language)&&void 0!==b?b:"kuery",z=null!==(j=null!==(O=L.query)&&void 0!==O?O:null===(I=w.signal)||void 0===I||null===(T=I.rule)||void 0===T?void 0:T.query)&&void 0!==j?j:"",$=null!==(C=null!==(M=Object(h.getField)(w,p.f))&&void 0!==M?M:null===(N=w.signal)||void 0===N||null===(D=N.rule)||void 0===D?void 0:D.index)&&void 0!==C?C:[],{from:V,to:U,dataProviders:H}=(e=>{var t;const n=Array.isArray(e)?e[0]:e,a=Object(h.getField)(n,p.e),i=(null!==(t=Object(h.getField)(n,`${u.A}.new_terms_fields`))&&void 0!==t?t:[]).map(((e,t)=>{const a=e.replace(".","-"),i=Object(h.getField)(n,p.b)[t];return{id:`send-alert-to-timeline-action-default-draggable-event-details-value-formatted-field-value-${m.j.active}-${a}-${i}`,name:e,enabled:!0,excluded:!1,kqlQuery:"",queryMatch:{field:e,value:i,operator:":"},and:[]}})),o=i.length?[{...i[0],and:i.slice(1)}]:[];return{from:a,to:r()().toISOString(),dataProviders:o}})(w),G=await i(e),Q=(null!==(F=a.filters)&&void 0!==F?F:q).concat(G?[G]:[]);return t({from:V,notes:null,timeline:{...f.b,columns:null!==(A=a.columns)&&void 0!==A?A:f.b.columns,description:`_id: ${w._id}`,filters:Q,dataProviders:null!==(_=a.dataProviders)&&void 0!==_?_:H,id:m.j.active,indexNames:$,dateRange:{start:V,end:U},eventType:"all",kqlQuery:{filterQuery:{kuery:{kind:B,expression:null!==(R=a.query)&&void 0!==R?R:z},serializedQuery:null!==(P=a.query)&&void 0!==P?P:z}}},to:U,ruleNote:n})}catch(n){const{toasts:a}=x.b.get().notifications;a.addError(n,{toastMessage:c.i18n.translate("xpack.securitySolution.detectionEngine.alerts.createNewTermsTimelineFailure",{defaultMessage:"Failed to create timeline for document _id: {id}",values:{id:e._id}}),title:c.i18n.translate("xpack.securitySolution.detectionEngine.alerts.createNewTermsTimelineFailureTitle",{defaultMessage:"Failed to create new terms alert timeline"})});const i=w.a.toISOString(),r=w.b.toISOString();return t({from:i,notes:null,timeline:{...f.b,id:m.j.active,indexNames:[],dateRange:{start:i,end:r},eventType:"all"},to:r})}},_=async(e,t,n,a,i)=>{try{var r,o,s,l,d,g,b,y,v,E,j,O,I,T,C,M,N,D,F,A,_,R;const c=await x.b.get().http.fetch(k.mb,{method:"POST",body:JSON.stringify(Object(S.a)([e._id]))}),w=(null!==(r=null==c?void 0:c.hits.hits.reduce(((e,{_id:t,_index:n,_source:a={}})=>[...e,{...Object(S.b)(a),_id:t,_index:n,timestamp:a["@timestamp"]}]),[]))&&void 0!==r?r:[])[0],P=Object(h.getField)(w,u.A),L=(null!==(o=null!==(s=P.filters)&&void 0!==s?s:null===(l=w.signal)||void 0===l||null===(d=l.rule)||void 0===d?void 0:d.filters)&&void 0!==o?o:[]).map((e=>null!=e.meta?e:{...e,meta:{}})),q=null!==(g=null!==(b=P.language)&&void 0!==b?b:null===(y=w.signal)||void 0===y||null===(v=y.rule)||void 0===v?void 0:v.language)&&void 0!==g?g:"kuery",B=null!==(E=null!==(j=P.query)&&void 0!==j?j:null===(O=w.signal)||void 0===O||null===(I=O.rule)||void 0===I?void 0:I.query)&&void 0!==E?E:"",z=null!==(T=null!==(C=Object(h.getField)(w,p.f))&&void 0!==C?C:null===(M=w.signal)||void 0===M||null===(N=M.rule)||void 0===N?void 0:N.index)&&void 0!==T?T:[],{from:$,to:V,dataProviders:U}=(e=>{const t=Array.isArray(e)?e[0]:e,n=Object(h.getField)(t,u.T),a=Object(h.getField)(t,u.R),i=Object(h.getField)(t,u.U).map((e=>{const t=e.field.replace(".","-"),n=`send-alert-to-timeline-action-default-draggable-event-details-value-formatted-field-value-${m.j.active}-${t}-${e.value}`;return null==e.value?{id:n,name:t,enabled:!0,excluded:!0,kqlQuery:"",queryMatch:{field:e.field,value:"",operator:":*"}}:{id:n,name:t,enabled:!0,excluded:!1,kqlQuery:"",queryMatch:{field:e.field,value:e.value,operator:":"}}}));return{from:n,to:a,dataProviders:[{...i[0],and:i.slice(1)}]}})(w),H=await i(e),G=(null!==(D=a.filters)&&void 0!==D?D:L).concat(H?[H]:[]);return t({from:$,notes:null,timeline:{...f.b,columns:null!==(F=a.columns)&&void 0!==F?F:f.b.columns,description:`_id: ${w._id}`,filters:G,dataProviders:null!==(A=a.dataProviders)&&void 0!==A?A:U,id:m.j.active,indexNames:z,dateRange:{start:$,end:V},eventType:"all",kqlQuery:{filterQuery:{kuery:{kind:q,expression:null!==(_=a.query)&&void 0!==_?_:B},serializedQuery:null!==(R=a.query)&&void 0!==R?R:B}}},to:V,ruleNote:n})}catch(n){const{toasts:a}=x.b.get().notifications;a.addError(n,{toastMessage:c.i18n.translate("xpack.securitySolution.detectionEngine.alerts.createSuppressedTimelineFailure",{defaultMessage:"Failed to create timeline for document _id: {id}",values:{id:e._id}}),title:c.i18n.translate("xpack.securitySolution.detectionEngine.alerts.createSuppressedTimelineFailureTitle",{defaultMessage:"Failed to create suppressed alert timeline"})});const i=w.a.toISOString(),r=w.b.toISOString();return t({from:i,notes:null,timeline:{...f.b,id:m.j.active,indexNames:[],dateRange:{start:i,end:r},eventType:"all"},to:r})}},R=(e,t,n="dataProvider",a)=>{const i=Array.isArray(t)?t.map((e=>e._id)):[],{to:r,from:o}=O({ecs:t}),{dataProviders:s,filters:l}=D(i,n,a||`${t.length} event IDs`);e({from:o,notes:null,timeline:{...f.b,dataProviders:s,id:m.j.active,indexNames:[],dateRange:{start:o,end:r},eventType:"all",filters:l,kqlQuery:{filterQuery:{kuery:{kind:"kuery",expression:""},serializedQuery:""}}},to:r})},P=async({createTimeline:e,ecsData:t,updateTimelineIsLoading:n,searchStrategyClient:i,getExceptionFilter:r})=>{const o=Array.isArray(t)?t[0]:t,s=Object(h.getField)(o,u.z),l=Array.isArray(s)&&s.length>0?s[0]:"",c=Object(h.getField)(o,p.g),x=Object(a.isEmpty)(c)?"":Array.isArray(c)?c[0]:c,{to:k,from:S}=O({ecs:t});if(Object(a.isEmpty)(x)){if(I(o))return F(o,e,l,{},r);if(T(o))return A(o,e,l,{},r);if(C(o))return _(o,e,l,{},r);{let{dataProviders:n,filters:i}=D([o._id],"dataProvider");if((e=>{const t=Object(h.getField)(e,u.H),n=Object(h.getField)(e,p.a);return("eql"===t||Array.isArray(t)&&"eql"===t[0])&&(null==n?void 0:n.length)>0})(o)){const e=((e,t)=>{if(!Object(a.isEmpty)(e)&&Array.isArray(t)&&t.length>1)return{dataProviders:[],filters:M(p.a,t.reduce(((e,t)=>{const n=Object(h.getField)(t,p.a),a=Array.isArray(n)?n[0]:n;return e.includes(a)?e:[...e,a]}),[]))};if(!Array.isArray(t)||1===t.length){const e=Array.isArray(t)?t[0]:t,n=Object(h.getField)(e,p.a),a=Object(h.getFieldKey)(e,p.a),i=Array.isArray(n)?n[0]:n;return{dataProviders:[{and:[],id:`send-alert-to-timeline-action-default-draggable-event-details-value-formatted-field-value-${m.j.active}-alert-id-${i}`,name:e._id,enabled:!0,excluded:!1,kqlQuery:"",queryMatch:{field:a,value:i,operator:":"}}],filters:[]}}return{filters:[],dataProviders:[]}})([o._id],t);n=e.dataProviders,i=e.filters}return e({from:S,notes:null,timeline:{...f.b,dataProviders:n,id:m.j.active,indexNames:[],dateRange:{start:S,end:k},eventType:"all",filters:i,kqlQuery:{filterQuery:{kuery:{kind:"kuery",expression:""},serializedQuery:""}}},to:k,ruleNote:l})}}try{var w,j;n({id:m.j.active,isLoading:!0});const[t,s]=await Promise.all([Object(E.d)(x),Object(d.lastValueFrom)(i.search({defaultIndex:[],indexName:null!==(w=o._index)&&void 0!==w?w:"",eventId:o._id,factoryQueryType:g.c.details},{strategy:"timelineSearchStrategy"}))]),c=Object(a.getOr)({},"data.getOneTimeline",t),u=null!==(j=s.data)&&void 0!==j?j:[];if(!Object(a.isEmpty)(c)){var N,R,P,L,q,B,z;const t=Object(b.g)(c),{timeline:n,notes:a}=Object(b.c)(t,!0,null!==(N=t.timelineType)&&void 0!==N?N:m.n.default),i=Object(v.d)(null!==(R=null===(P=n.kqlQuery)||void 0===P||null===(L=P.filterQuery)||void 0===L||null===(q=L.kuery)||void 0===q?void 0:q.expression)&&void 0!==R?R:"",u,n.timelineType),s=Object(v.c)(null!==(B=n.filters)&&void 0!==B?B:[],u),d=Object(v.b)(null!==(z=n.dataProviders)&&void 0!==z?z:[],u,n.timelineType);return I(o)?F(o,e,l,{filters:s,query:i,dataProviders:d,columns:n.columns},r):T(o)?A(o,e,l,{filters:s,query:i,dataProviders:d,columns:n.columns},r):C(o)?_(o,e,l,{filters:s,query:i,dataProviders:d,columns:n.columns},r):e({from:S,timeline:{...n,title:"",timelineType:m.n.default,templateTimelineId:null,status:m.l.draft,dataProviders:d,eventType:"all",filters:s,dateRange:{start:S,end:k},kqlQuery:{filterQuery:{kuery:{kind:null!==($=null===(V=n.kqlQuery)||void 0===V||null===(U=V.filterQuery)||void 0===U||null===(H=U.kuery)||void 0===H?void 0:H.kind)&&void 0!==$?$:"kuery",expression:i},serializedQuery:Object(y.b)(i)}},noteIds:null!==(G=null==a?void 0:a.map((e=>e.noteId)))&&void 0!==G?G:[],show:!0},to:k,ruleNote:l,notes:null!=a?a:null});var $,V,U,H,G}}catch{return n({id:m.j.active,isLoading:!1}),e({from:S,notes:null,timeline:{...f.b,id:m.j.active,indexNames:[],dateRange:{start:S,end:k},eventType:"all"},to:k})}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return o}));var a=n(0);const i=a.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.viewListDetailActionLabel",{defaultMessage:"View list detail"}),r=a.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.viewRuleDetailActionLabel",{defaultMessage:"View rule detail"}),o=a.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToRulesTableSelection.link_column",{defaultMessage:"Link"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(129),i=n(1);const r=Object(a.d)((async({name:e,description:t,http:n,signal:a})=>await n.post(i.rc,{body:JSON.stringify({name:e,description:t}),headers:{"Content-Type":"application/json"},method:"POST",signal:a}))),o=()=>Object(a.a)(r)},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o}));var a=n(0);const i=a.i18n.translate("xpack.securitySolution.exceptions.list.exception.item.card.edit.label",{defaultMessage:"Edit rule exception"}),r=a.i18n.translate("xpack.securitySolution.exceptions.list.exception.item.card.delete.label",{defaultMessage:"Delete rule exception"}),o=a.i18n.translate("xpack.securitySolution.exceptions.list.utility.title",{defaultMessage:"rule exceptions"})},function(e,t,n){const a=n(152);e.exports=(e,t,n)=>0===a(e,t,n)},function(e,t,n){const a=n(125);e.exports=(e,t,n)=>{const i=new a(e,n),r=new a(t,n);return i.compare(r)||i.compareBuild(r)}},function(e,t,n){const a=n(152);e.exports=(e,t,n)=>a(e,t,n)<0},function(e,t,n){const a=n(125),i=n(364),{ANY:r}=i,o=n(163),s=n(365),l=n(362),c=n(484),u=n(321),d=n(363);e.exports=(e,t,n,p)=>{let m,g,f,b,y;switch(e=new a(e,p),t=new o(t,p),n){case">":m=l,g=u,f=c,b=">",y=">=";break;case"<":m=c,g=d,f=l,b="<",y="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(s(e,t,p))return!1;for(let n=0;n<t.set.length;++n){const a=t.set[n];let o=null,s=null;if(a.forEach((e=>{e.semver===r&&(e=new i(">=0.0.0")),o=o||e,s=s||e,m(e.semver,o.semver,p)?o=e:f(e.semver,s.semver,p)&&(s=e)})),o.operator===b||o.operator===y)return!1;if((!s.operator||s.operator===b)&&g(e,s.semver))return!1;if(s.operator===y&&f(e,s.semver))return!1}return!0}},function(e,t,n){"use strict";e.exports=function(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}},function(e,t,n){"use strict";e.exports=function(e){return null==e?[]:"length"in e?e:[e]}},function(e,t,n){"use strict";var a=n(200);e.exports=function(e,t){return e.length?(a(e,e.length,0,t),e):t}},function(e,t,n){"use strict";e.exports=function(e,t,n){for(var a,i=[],r=-1;++r<e.length;)(a=e[r].resolveAll)&&i.indexOf(a)<0&&(t=a(t,n),i.push(a));return t}},function(e,t,n){"use strict";var a=n(202)(/[A-Za-z]/);e.exports=a},function(e,t,n){"use strict";var a=n(201),i=n(488),r=n(200),o=n(486),s=n(489),l=n(263),c=n(670),u=n(671),d=n(673),p=n(672),m={name:"labelEnd",tokenize:function(e,t,n){for(var a,i,r=this,s=r.events.length;s--;)if(("labelImage"===r.events[s][1].type||"labelLink"===r.events[s][1].type)&&!r.events[s][1]._balanced){a=r.events[s][1];break}return function(t){return a?a._inactive?c(t):(i=r.parser.defined.indexOf(o(r.sliceSerialize({start:a.end,end:r.now()})))>-1,e.enter("labelEnd"),e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelEnd"),l):n(t)};function l(n){return 40===n?e.attempt(g,t,i?t:c)(n):91===n?e.attempt(f,t,i?e.attempt(b,t,c):c)(n):i?t(n):c(n)}function c(e){return a._balanced=!0,n(e)}},resolveTo:function(e,t){for(var n,a,o,c,u,d,p,m=e.length,g=0;m--;)if(c=e[m][1],u){if("link"===c.type||"labelLink"===c.type&&c._inactive)break;"enter"===e[m][0]&&"labelLink"===c.type&&(c._inactive=!0)}else if(d){if("enter"===e[m][0]&&("labelImage"===c.type||"labelLink"===c.type)&&!c._balanced&&(u=m,"labelLink"!==c.type)){g=2;break}}else"labelEnd"===c.type&&(d=m);return n={type:"labelLink"===e[u][1].type?"link":"image",start:l(e[u][1].start),end:l(e[e.length-1][1].end)},a={type:"label",start:l(e[u][1].start),end:l(e[d][1].end)},o={type:"labelText",start:l(e[u+g+2][1].end),end:l(e[d-2][1].start)},p=i(p=[["enter",n,t],["enter",a,t]],e.slice(u+1,u+g+3)),p=i(p,[["enter",o,t]]),p=i(p,s(t.parser.constructs.insideSpan.null,e.slice(u+g+4,d-3),t)),p=i(p,[["exit",o,t],e[d-2],e[d-1],["exit",a,t]]),p=i(p,e.slice(d+1)),p=i(p,[["exit",n,t]]),r(e,u,e.length,p),e},resolveAll:function(e){for(var t,n=-1;++n<e.length;)(t=e[n][1])._used||"labelImage"!==t.type&&"labelLink"!==t.type&&"labelEnd"!==t.type||(e.splice(n+1,"labelImage"===t.type?4:2),t.type="data",n++);return e}},g={tokenize:function(e,t,n){return function(t){return e.enter("resource"),e.enter("resourceMarker"),e.consume(t),e.exit("resourceMarker"),p(e,i)};function i(t){return 41===t?s(t):c(e,r,n,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",3)(t)}function r(t){return a(t)?p(e,o)(t):s(t)}function o(t){return 34===t||39===t||40===t?d(e,p(e,s),n,"resourceTitle","resourceTitleMarker","resourceTitleString")(t):s(t)}function s(a){return 41===a?(e.enter("resourceMarker"),e.consume(a),e.exit("resourceMarker"),e.exit("resource"),t):n(a)}}},f={tokenize:function(e,t,n){var a=this;return function(t){return u.call(a,e,i,n,"reference","referenceMarker","referenceString")(t)};function i(e){return a.parser.defined.indexOf(o(a.sliceSerialize(a.events[a.events.length-1][1]).slice(1,-1)))<0?n(e):t(e)}}},b={tokenize:function(e,t,n){return function(t){return e.enter("reference"),e.enter("referenceMarker"),e.consume(t),e.exit("referenceMarker"),a};function a(a){return 93===a?(e.enter("referenceMarker"),e.consume(a),e.exit("referenceMarker"),e.exit("reference"),t):n(a)}}};e.exports=m},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"g",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"i",(function(){return c})),n.d(t,"j",(function(){return u})),n.d(t,"h",(function(){return d})),n.d(t,"f",(function(){return p})),n.d(t,"k",(function(){return m})),n.d(t,"c",(function(){return g}));var a=n(0);const i=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.advancedSettingsButton",{defaultMessage:"Advanced settings"}),r=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.addReferenceDescription",{defaultMessage:"Add reference URL"}),o=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.addFalsePositiveDescription",{defaultMessage:"Add false positive example"}),s=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.endpointExceptionListLabel",{defaultMessage:"Elastic Endpoint exceptions"}),l=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.buildingBlockLabel",{defaultMessage:"Building block"}),c=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionLowDescription",{defaultMessage:"Low"}),u=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionMediumDescription",{defaultMessage:"Medium"}),d=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionHighDescription",{defaultMessage:"High"}),p=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionCriticalDescription",{defaultMessage:"Critical"}),m=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.referencesUrlInvalidError",{defaultMessage:"URL is invalid format"}),g=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutrule.noteHelpText",{defaultMessage:"Add rule investigation guide..."})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(4),i=n.n(a),r=n(32),o=n(113);const s=i.a.memo((({onClick:e,isDisabled:t,dataTestSubj:n="nextStep-continue"})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiHorizontalRule,{margin:"m"}),i.a.createElement(r.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd",gutterSize:"xs",responsive:!1},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButton,{fill:!0,onClick:e,isDisabled:t,"data-test-subj":n},o.pb))))));s.displayName="NextStep"},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(4),i=n(48),r=n(77);const o=()=>{const e=Object(r.k)(),{http:t}=e.services,[n,o]=Object(a.useState)(Object(i.createSavedQueryService)(t));return Object(a.useEffect)((()=>{o(Object(i.createSavedQueryService)(t))}),[t]),n}},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"e",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"h",(function(){return l})),n.d(t,"n",(function(){return c})),n.d(t,"m",(function(){return u})),n.d(t,"l",(function(){return d})),n.d(t,"i",(function(){return p})),n.d(t,"j",(function(){return m})),n.d(t,"o",(function(){return g})),n.d(t,"k",(function(){return f})),n.d(t,"g",(function(){return b})),n.d(t,"f",(function(){return y})),n.d(t,"p",(function(){return h})),n.d(t,"q",(function(){return v})),n.d(t,"a",(function(){return E})),n.d(t,"r",(function(){return x})),n.d(t,"s",(function(){return k}));var a=n(0);const i=a.i18n.translate("xpack.securitySolution.stepDefineRule.lastHour",{defaultMessage:"Last hour"}),r=a.i18n.translate("xpack.securitySolution.stepDefineRule.lastDay",{defaultMessage:"Last day"}),o=a.i18n.translate("xpack.securitySolution.stepDefineRule.lastWeek",{defaultMessage:"Last week"}),s=a.i18n.translate("xpack.securitySolution.stepDefineRule.lastMonth",{defaultMessage:"Last month"}),l=(a.i18n.translate("xpack.securitySolution.stepDefineRule.previewQueryButton",{defaultMessage:"Preview results"}),a.i18n.translate("xpack.securitySolution.stepDefineRule.quickPreviewToggleButton",{defaultMessage:"Quick query preview"}),a.i18n.translate("xpack.securitySolution.stepDefineRule.advancedPreviewToggleButton",{defaultMessage:"Advanced query preview"}),a.i18n.translate("xpack.securitySolution.stepDefineRule.previewTimeoutWarning",{defaultMessage:"Preview timed out after 60 seconds"})),c=(a.i18n.translate("xpack.securitySolution.stepDefineRule.previewQueryAriaLabel",{defaultMessage:"Query preview timeframe select"}),a.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewLabel",{defaultMessage:"Select a preview timeframe"})),u=a.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewInvocationCountWarningTitle",{defaultMessage:"Rule preview timeframe might cause timeout"}),d=a.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewInvocationCountWarningMessage",{defaultMessage:"The timeframe and rule interval that you selected for previewing this rule might cause timeout or take long time to execute. Try to decrease the timeframe and/or increase the interval if preview has timed out (this won't affect the actual rule run)."}),p=a.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryGraphCountLabel",{defaultMessage:"Count"}),m=a.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewTitle",{defaultMessage:"Rule Preview"}),g=a.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryGraphPreviewNoiseWarning",{defaultMessage:"Noise warning: This rule may cause a lot of noise. Consider narrowing your query. This is based on a linear progression of 1 alert per hour."}),f=a.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryGraphPreviewError",{defaultMessage:"Error fetching preview"}),b=a.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.histogramDisclaimer",{defaultMessage:"Note: Alerts with multiple event.category values will be counted more than once."}),y=a.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.mlHistogramDisclaimer",{defaultMessage:"Note: Alerts with multiple host.name values will be counted more than once."}),h=a.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewSeeAllErrors",{defaultMessage:"See all errors"}),v=a.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewSeeAllWarnings",{defaultMessage:"See all warnings"}),E=a.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.actions",{defaultMessage:"Actions"}),x=a.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.viewDetailsAriaLabel",{defaultMessage:"View details"}),k=({ariaRowindex:e,columnValues:t})=>a.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.viewDetailsForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t},defaultMessage:"View details for the alert or event in row {ariaRowindex}, with columns {columnValues}"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(4),i=n(84),r=n(680);function o(){const e=Object(i.a)();return Object(a.useCallback)((({actionType:t,error:n})=>{e.addError(function(e){return e.stack=JSON.stringify(e.body,null,2),e}(n),{title:Object(r.d)(t),toastMessage:Object(r.b)(t,n)})}),[e])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n(4),i=n(93),r=n(195),o=n(32),s=n(89),l=n(1),c=n(498),u=n(168),d=n(724);const p=({exceptionsList:e,handleExport:t,handleDelete:n,handleManageRules:p})=>{const[m,g]=Object(a.useState)(r.i.LOADING),[f,b]=Object(a.useState)(),[y,h]=Object(a.useState)(!1),[v,E]=Object(a.useState)(!1),{name:x,list_id:k,rules:S,type:w,created_by:j,created_at:O,description:I}=e,T=Object(a.useCallback)((()=>{g("")}),[g]),C=e=>{b(e),E(!0)},{lastUpdated:M,exceptionViewerStatus:N,exceptions:D,pagination:F,ruleReferences:A,fetchItems:_,onDeleteException:R,onPaginationChange:P}=Object(c.a)({list:e,deleteToastTitle:u.r,deleteToastBody:e=>u.q(e),errorToastBody:u.m,errorToastTitle:u.n,onEditListExceptionItem:C,onFinishFetchingExceptions:T});Object(a.useEffect)((()=>{_(null,r.i.LOADING)}),[_]);const[L,q]=Object(a.useState)(!1),B=Object(o.useGeneratedHtmlId)({prefix:"openAccordion"}),z=Object(d.a)(e),$=Object(a.useMemo)((()=>m===r.i.EMPTY?u.x:""),[m]),V=Object(a.useMemo)((()=>m===r.i.EMPTY?u.u(e.name):""),[e.name,m]),U=Object(a.useMemo)((()=>e.type===i.b.ENDPOINT?u.w:u.v),[e.type]),H=Object(a.useMemo)((()=>[{key:"Export",icon:"exportAction",label:u.C,onClick:n=>{t({id:e.id,listId:e.list_id,namespaceType:e.namespace_type})()}},{key:"Delete",icon:"trash",disabled:z,label:u.j,onClick:t=>{n({id:e.id,listId:e.list_id,namespaceType:e.namespace_type})()}},{key:"ManageRules",icon:"gear",disabled:z,label:"Manage Rules",onClick:e=>{p()}}]),[e.id,e.list_id,e.namespace_type,n,t,z,p]),G=Object(a.useCallback)((()=>{h(!0)}),[h]),Q=Object(a.useCallback)((e=>{h(!1),E(!1),e&&_()}),[_,h,E]),{onClick:W}=Object(s.o)()({deepLinkId:l.uc.exceptions,path:`/details/${e.list_id}`});return{listId:k,listName:x,listDescription:I,createdAt:new Date(O).toDateString(),createdBy:j,listRulesCount:S.length.toString(),exceptionItemsCount:F.totalItemCount.toString(),listType:w,menuActionItems:H,showAddExceptionFlyout:y,toggleAccordion:L,openAccordionId:B,viewerStatus:m,exceptionToEdit:f,showEditExceptionFlyout:v,lastUpdated:M,exceptions:D,ruleReferences:A,pagination:F,exceptionViewerStatus:N,onEditExceptionItem:C,onDeleteException:R,onPaginationChange:P,setToggleAccordion:q,onAddExceptionClick:G,handleConfirmExceptionFlyout:Q,handleCancelExceptionItemFlyout:()=>{h(!1),E(!1)},goToExceptionDetail:W,emptyViewerTitle:$,emptyViewerBody:V,emptyViewerButtonText:U}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(4),i=n(195),r=n(77),o=n(510);const s=({list:e,deleteToastTitle:t,deleteToastBody:n,errorToastTitle:s,errorToastBody:l,onEditListExceptionItem:c,onFinishFetchingExceptions:u})=>{const{services:d}=Object(r.k)(),{http:p}=d,m=Object(r.o)(),[g,f]=Object(a.useState)([]),[b,y]=Object(a.useState)({}),[h,v]=Object(a.useState)({pageIndex:0,pageSize:0,totalItemCount:0}),[E,x]=Object(a.useState)(null),[k,S]=Object(a.useState)(""),w=Object(a.useCallback)(((e,t,n)=>{null==m||m.addError(e,{title:t||s,toastMessage:n||l}),S(i.i.ERROR)}),[l,s,m]),j=Object(a.useCallback)((async()=>{try{const t=await Object(o.c)([e]);y(t)}catch(e){w(e)}}),[w,e,y]),O=Object(a.useCallback)(((e,t,n)=>{v(e),x(Date.now()),setTimeout((()=>{if(n===i.i.EMPTY_SEARCH)return S(t?"":n);S(t?"":i.i.EMPTY)}),200)}),[]),I=Object(a.useCallback)((async(t,n)=>{try{S(i.i.LOADING);const{data:a,pagination:r}=await Object(o.b)({http:p,...Object(o.g)(null,e,t)});f(a),j(),O(r,a.length,n),"function"==typeof u&&u()}catch(e){w(e)}}),[p,e,j,O,u,w]),T=Object(a.useCallback)((async({id:e,name:a,namespaceType:r})=>{try{S(i.i.LOADING),await Object(o.a)({id:e,http:p,namespaceType:r}),null==m||m.addSuccess({title:t,text:"function"==typeof n?n(a):""}),I()}catch(e){w(e)}}),[p,m,t,n,I,w]),C=Object(a.useCallback)((async e=>{I(e)}),[I]);return{exceptions:g,lastUpdated:E,pagination:h,exceptionViewerStatus:k,ruleReferences:b,fetchItems:I,onDeleteException:T,onEditExceptionItem:e=>{"function"==typeof c&&c(e)},onPaginationChange:C}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(110),i=n(129);const r=Object(i.d)((async({file:e,http:t,signal:n,overwrite:i,overwriteExceptions:r,asNewList:o})=>{const s=new FormData;return s.append("file",e),await t.post(`${a.s}/_import`,{body:s,query:{overwrite:i,overwrite_exceptions:r,as_new_list:o},headers:{"Content-Type":void 0},method:"POST",signal:n})})),o=()=>Object(i.a)(r)},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(4),i=n(93),r=n(195),o=n(168),s=n(593);const l=(e,t)=>{const[n,l]=Object(a.useState)(!1),[c,u]=Object(a.useState)(!1),[d,p]=Object(a.useState)(),[m,g]=Object(a.useState)(r.i.LOADING),f=Object(a.useCallback)((()=>{g("")}),[g]),b=e=>{p(e),u(!0)},{exceptionViewerStatus:y,exceptions:h,lastUpdated:v,pagination:E,ruleReferences:x,fetchItems:k,onDeleteException:S,onPaginationChange:w}=Object(s.b)({list:e,deleteToastTitle:o.r,deleteToastBody:e=>o.q(e),errorToastBody:o.m,errorToastTitle:o.n,onEditListExceptionItem:b,onFinishFetchingExceptions:f});Object(a.useEffect)((()=>{k(null,r.i.LOADING)}),[k,t]);const j=Object(a.useMemo)((()=>m===r.i.EMPTY?o.x:""),[m]),O=Object(a.useMemo)((()=>m===r.i.EMPTY?o.u(e.name):""),[e.name,m]),I=Object(a.useMemo)((()=>e.type===i.b.ENDPOINT?o.w:o.v),[e.type]),T=Object(a.useCallback)((async e=>{g(r.i.SEARCHING),k(e,r.i.EMPTY_SEARCH)}),[k,g]),C=Object(a.useCallback)((()=>{l(!0),k()}),[k,l]),M=Object(a.useCallback)((e=>{l(!1),u(!1),e&&k()}),[k,l,u]);return{exceptionViewerStatus:y,listName:e.name,exceptions:h,listType:e.type,lastUpdated:v,pagination:E,viewerStatus:m,emptyViewerTitle:j,emptyViewerBody:O,emptyViewerButtonText:I,ruleReferences:x,showAddExceptionFlyout:n,showEditExceptionFlyout:c,exceptionToEdit:d,onSearch:T,onAddExceptionClick:C,onDeleteException:S,onEditExceptionItem:b,onPaginationChange:w,handleCancelExceptionItemFlyout:()=>{l(!1),u(!1)},handleConfirmExceptionFlyout:M}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return Ca})),n.d(t,"a",(function(){return Ma}));var a=n(34),i=n(32),r=n(4),o=n.n(r),s=n(33),l=n.n(s),c=n(107),u=n(128),d=n(89),p=n(82),m=n.n(p),g=n(7),f=n(871),b=n(316),y=n(255),h=n(205),v=n(35),E=n(634),x=n(299),k=n(397),S=n(77),w=n(188);const j=l.a.div.withConfig({displayName:"TabContentWrapper",componentId:"sc-kmihwc-0"})(["height:100%;position:relative;"]);var O=n(78),I=n(284),T=n(38),C=n(99),M=n(180),N=n(155),D=n(715),F=n(86),A=n(175),_=n(822),R=n(112),P=n(294),L=n.n(P),q=n(635),B=n(703),z=n(182),$=n(0);const V=o.a.memo((({data:e,field:t,fieldMapping:n,scripted:a})=>{const r=function(e){switch(e){case"boolean":return $.i18n.translate("xpack.securitySolution.fieldNameIcons.booleanAriaLabel",{defaultMessage:"Boolean field"});case"conflict":return $.i18n.translate("xpack.securitySolution.fieldNameIcons.conflictFieldAriaLabel",{defaultMessage:"Conflicting field"});case"date":return $.i18n.translate("xpack.securitySolution.fieldNameIcons.dateFieldAriaLabel",{defaultMessage:"Date field"});case"geo_point":return $.i18n.translate("xpack.securitySolution.fieldNameIcons.geoPointFieldAriaLabel",{defaultMessage:"Geo point field"});case"geo_shape":return $.i18n.translate("xpack.securitySolution.fieldNameIcons.geoShapeFieldAriaLabel",{defaultMessage:"Geo shape field"});case"ip":return $.i18n.translate("xpack.securitySolution.fieldNameIcons.ipAddressFieldAriaLabel",{defaultMessage:"IP address field"});case"murmur3":return $.i18n.translate("xpack.securitySolution.fieldNameIcons.murmur3FieldAriaLabel",{defaultMessage:"Murmur3 field"});case"number":return $.i18n.translate("xpack.securitySolution.fieldNameIcons.numberFieldAriaLabel",{defaultMessage:"Number field"});case"source":return $.i18n.translate("xpack.securitySolution.fieldNameIcons.sourceFieldAriaLabel",{defaultMessage:"Source field"});case"string":return $.i18n.translate("xpack.securitySolution.fieldNameIcons.stringFieldAriaLabel",{defaultMessage:"String field"});case"nested":return $.i18n.translate("xpack.securitySolution.fieldNameIcons.nestedFieldAriaLabel",{defaultMessage:"Nested field"});default:return $.i18n.translate("xpack.securitySolution.fieldNameIcons.unknownFieldAriaLabel",{defaultMessage:"Unknown field"})}}(e.type),s=n&&n.displayName?n.displayName:t,l=s!==t?`${t} (${s})`:t,c=null==n?void 0:n.isSubtypeMulti();return o.a.createElement(o.a.Fragment,null,o.a.createElement(i.EuiFlexItem,{grow:!1,className:"eventFieldsTable__fieldIcon"},o.a.createElement(B.a,{"data-test-subj":"field-type-icon",type:e.type,label:r,scripted:a})),o.a.createElement(i.EuiFlexGroup,{wrap:!0,gutterSize:"none",responsive:!1,alignItems:"flexStart","data-test-subj":"field-name-cell"},o.a.createElement(i.EuiFlexItem,{className:"eventFieldsTable__fieldName eui-textBreakAll",grow:!1},o.a.createElement(i.EuiToolTip,{position:"top",content:Object(g.isEmpty)(e.description)?l:`${e.description} ${Object(z.c)(e.example)}`,delay:"long",anchorClassName:"eui-textBreakAll"},o.a.createElement(i.EuiText,{size:"xs","data-test-subj":"field-name"},t))),c&&o.a.createElement(i.EuiToolTip,{position:"top",delay:"long",content:w.m},o.a.createElement(i.EuiBadge,{title:"",className:"eventFieldsTable__multiFieldBadge",color:"default","data-test-subj":`eventFieldsTableRow-${t}-multifieldBadge`},w.l))))}));V.displayName="FieldNameCell";var U=n(356);l()(i.EuiPanel).withConfig({displayName:"HoverActionsContainer",componentId:"sc-bbzzvi-0"})(["align-items:center;display:flex;flex-direction:row;height:25px;justify-content:center;left:5px;position:absolute;top:-10px;width:30px;"]).displayName="HoverActionsContainer";const H=L()(((e,t)=>Object(g.get)(t,e)),((e,t)=>e[0].join()===t[0].join()));var G=n(81);const Q=l.a.div.withConfig({displayName:"TableWrapper",componentId:"sc-1mn70y-0"})(["display:flex;flex:1;overflow:hidden;> div{display:flex;flex-direction:column;flex:1;overflow:hidden;> .euiFlexGroup:first-of-type{flex:0;}}"]),W=l()(i.EuiInMemoryTable).withConfig({displayName:"StyledEuiInMemoryTable",componentId:"sc-1mn70y-1"})(["flex:1;overflow:auto;overflow-x:hidden;&::-webkit-scrollbar{height:",";width:",";}&::-webkit-scrollbar-thumb{background-clip:content-box;background-color:",";border:"," solid transparent;}&::-webkit-scrollbar-corner,&::-webkit-scrollbar-track{background-color:transparent;}.eventFieldsTable__fieldIcon{padding-top:","px;}.eventFieldsTable__fieldName{line-height:",";padding:",";}.eventFieldsTable__tableRow{font-size:",";font-family:",";.hoverActions-active{.timelines__hoverActionButton,.securitySolution__hoverActionButton{opacity:1;}}&:hover{.timelines__hoverActionButton,.securitySolution__hoverActionButton{opacity:1;}}.timelines__hoverActionButton,.securitySolution__hoverActionButton{opacity:0;}}.eventFieldsTable__actionCell,.eventFieldsTable__fieldNameCell{align-items:flex-start;padding:",";}.eventFieldsTable__fieldValue{display:inline-block;word-break:break-all;word-wrap:break-word;white-space:pre-wrap;line-height:",";color:",";vertical-align:top;}"],(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>Object(I.rgba)(e.eui.euiColorDarkShade,.5)),(({theme:e})=>e.eui.euiScrollBarCorner),(({theme:e})=>1.5*parseFloat(e.eui.euiSizeXS)),(({theme:e})=>e.eui.euiLineHeight),(({theme:e})=>e.eui.euiSizeXS),(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.euiCodeFontFamily),(({theme:e})=>e.eui.euiSizeXS),(({theme:e})=>e.eui.euiLineHeight),(({theme:e})=>e.eui.euiColorFullShade)),K=[25,50,100],Y=o.a.memo((({browserFields:e,data:t,eventId:n,isDraggable:s,timelineTabType:l,scopeId:c,isReadOnly:u})=>{const d=Object(r.useRef)(null),p=Object(O.useDispatch)(),m=Object(r.useMemo)((()=>Object(C.isTimelineScope)(c)?F.b.getTimelineByIdSelector():Object(C.isInTableScope)(c)?N.b.getTableByIdSelector():void 0),[c]),g=Object(C.isTimelineScope)(c)?R.b:M.a,f=Object(G.a)((t=>{var n;const{columns:a}=null!==(n=m&&m(t,c))&&void 0!==n?n:g;return Object(_.b)(a,e)})),b=Object(r.useMemo)((()=>Object(A.a)(e)),[e]),y=Object(r.useMemo)((()=>Object(a.sortBy)(["field"],t).map(((e,t)=>({...e,...b[e.field],valuesConcatenated:null!=e.values?e.values.join():"",ariaRowindex:Object(T.arrayIndexToAriaIndex)(t)})))),[t,b]),h=Object(r.useCallback)((e=>{var n;const i=(null!==(n=f.find((t=>t.id===e)))&&void 0!==n?n:{}).linkField;if(!i)return null;const r=(null!=t?t:[]).find((e=>e.field===i)),o=Object(a.getOr)(null,"originalValue",r);return Array.isArray(o)?o[0]:o}),[t,f]),v=Object(C.getScopedActions)(c),E=Object(r.useCallback)((e=>{v&&(f.some((t=>t.id===e.id))?p(v.removeColumn({columnId:e.id,id:c})):p(v.upsertColumn({column:e,id:c,index:1})))}),[f,p,c,v]),x=Object(r.useCallback)((({ariaRowindex:e,field:t})=>({...null!=e?{"data-rowindex":e}:{},className:"eventFieldsTable__tableRow","data-test-subj":`event-fields-table-row-${t}`})),[]),k=Object(r.useCallback)((e=>{v&&p(v.updateColumns({id:c,columns:e}))}),[p,c,v]),S=Object(r.useMemo)((()=>(({browserFields:e,columnHeaders:t,eventId:n,onUpdateColumns:a,contextId:r,scopeId:s,toggleColumn:l,getLinkValue:c,isDraggable:u,isReadOnly:d})=>[...d?[]:[{field:"values",name:o.a.createElement(i.EuiText,{size:"xs"},o.a.createElement("strong",null,w.a)),sortable:!1,truncateText:!1,width:"132px",render:(t,a)=>{const i=a.isObjectArray?w.n(a.field):w.w(a.field),u=H([a.category,"fields",a.field],e);return o.a.createElement(U.a,{"aria-label":i,contextId:r,data:a,eventId:n,fieldFromBrowserField:u,getLinkValue:c,toggleColumn:l,scopeId:s,values:t})}}],{field:"field",className:"eventFieldsTable__fieldNameCell",name:o.a.createElement(i.EuiText,{size:"xs"},o.a.createElement("strong",null,w.d)),sortable:!0,truncateText:!1,render:(t,n)=>{const a=H([n.category,"fields",t],e);return o.a.createElement(V,{data:n,field:t,fieldMapping:void 0,fieldFromBrowserField:a})}},{field:"values",className:"eventFieldsTable__fieldValueCell",name:o.a.createElement(i.EuiText,{size:"xs"},o.a.createElement("strong",null,w.u)),sortable:!0,truncateText:!1,render:(t,a)=>{const i=H([a.category,"fields",a.field],e);return o.a.createElement(q.a,{contextId:r,data:a,eventId:n,fieldFromBrowserField:i,getLinkValue:c,isDraggable:u,values:t})}}])({browserFields:e,columnHeaders:f,eventId:n,onUpdateColumns:k,contextId:`event-fields-browser-for-${c}-${l}`,scopeId:c,toggleColumn:E,getLinkValue:h,isDraggable:s,isReadOnly:u})),[e,f,n,k,c,l,E,h,s,u]),j=Object(r.useCallback)((()=>{var e,t;null===(e=d.current)||void 0===e||null===(t=e.querySelector('input[type="search"]'))||void 0===t||t.focus()}),[]),I=Object(r.useCallback)((()=>{var e;null===(e=document.querySelector(`.${D.a}`))||void 0===e||e.focus()}),[]),P=Object(r.useCallback)((e=>{Object(T.isTab)(e)?Object(z.f)({containerElement:d.current,keyboardEvent:e,onSkipFocusBeforeEventsTable:j,onSkipFocusAfterEventsTable:I}):Object(T.onKeyDownFocusHandler)({colindexAttribute:T.DATA_COLINDEX_ATTRIBUTE,containerElement:null==d?void 0:d.current,event:e,maxAriaColindex:3,maxAriaRowindex:t.length,onColumnFocused:a.noop,rowindexAttribute:T.DATA_ROWINDEX_ATTRIBUTE})}),[t,I,j]);Object(r.useEffect)((()=>{j()}),[j]);const{onTableChange:L,paginationTableProp:B}=(()=>{const[e,t]=Object(r.useState)({pageIndex:0});return{onTableChange:Object(r.useCallback)((({page:{index:e}})=>{t({pageIndex:e})}),[]),paginationTableProp:Object(r.useMemo)((()=>({...e,pageSizeOptions:K})),[e])}})();return o.a.createElement(Q,{onKeyDown:P,ref:d},o.a.createElement(W,{className:z.a,items:y,itemId:"field",columns:S,onTableChange:L,pagination:B,rowProps:x,search:z.g,sorting:!1,"data-test-subj":"event-fields-browser"}))}));Y.displayName="EventFieldsBrowser";var J=n(302);const X=l.a.div.withConfig({displayName:"EuiCodeEditorContainer",componentId:"sc-4gfrjz-0"})([".euiCodeEditorWrapper{position:absolute;}"]),Z=o.a.memo((({rawEventData:e})=>{const t=Object(r.useMemo)((()=>JSON.stringify(e,J.j,2)),[e]);return o.a.createElement(X,null,o.a.createElement(i.EuiCodeBlock,{language:"json",fontSize:"m",paddingSize:"m",isCopyable:!0,"data-test-subj":"jsonView"},t))}));Z.displayName="JsonView";var ee=n(212);const te=$.i18n.translate("xpack.securitySolution.eventDetails.ctiSummary.feedNamePreposition",{defaultMessage:"from"}),ne=$.i18n.translate("xpack.securitySolution.eventDetails.ctiSummary.indicatorEnrichmentTitle",{defaultMessage:"Threat Match Detected"}),ae=$.i18n.translate("xpack.securitySolution.eventDetails.ctiSummary.investigationEnrichmentTitle",{defaultMessage:"Enriched with Threat Intelligence"}),ie=$.i18n.translate("xpack.securitySolution.eventDetails.ctiSummary.indicatorEnrichmentTooltipContent",{defaultMessage:"This field value matched a threat intelligence indicator with a rule you created."}),re=$.i18n.translate("xpack.securitySolution.eventDetails.ctiSummary.informationAriaLabel",{defaultMessage:"Information"}),oe=$.i18n.translate("xpack.securitySolution.eventDetails.ctiSummary.investigationEnrichmentTooltipContent",{defaultMessage:"This field value has additional information available from threat intelligence sources."}),se=$.i18n.translate("xpack.securitySolution.alertDetails.noInvestigationEnrichmentsDescription",{defaultMessage:"We haven't found field value has additional information available from threat intelligence sources we searched in the past 30 days by default."}),le=$.i18n.translate("xpack.securitySolution.alertDetails.noEnrichmentsFoundDescription",{defaultMessage:"We did not find threat intelligence that matches any of the indicator match rules, or any enrichment for this alert."}),ce=$.i18n.translate("xpack.securitySolution.alertDetails.investigationTimeQueryTitle",{defaultMessage:"Enrichment with Threat Intelligence"}),ue=$.i18n.translate("xpack.securitySolution.alertDetails.enrichmentQueryStartDate",{defaultMessage:"Start date"}),de=$.i18n.translate("xpack.securitySolution.alertDetails.enrichmentQueryEndDate",{defaultMessage:"End date"}),pe=$.i18n.translate("xpack.securitySolution.alertDetails.refresh",{defaultMessage:"Refresh"}),me=$.i18n.translate("xpack.securitySolution.alertDetails.overview.enrichedDataTitle",{defaultMessage:"Enriched data"}),ge=e=>$.i18n.translate("xpack.securitySolution.alertDetails.overview.hostRiskClassification",{defaultMessage:"Current {riskEntity} risk classification",values:{riskEntity:Object(ee.c)(e,!0)}}),fe=e=>$.i18n.translate("xpack.securitySolution.alertDetails.overview.originalHostRiskClassification",{defaultMessage:"Original {riskEntity} risk classification",values:{riskEntity:Object(ee.c)(e,!0)}}),be=e=>$.i18n.translate("xpack.securitySolution.alertDetails.overview.hostRiskDataTitle",{defaultMessage:"{riskEntity} Risk Data",values:{riskEntity:Object(ee.c)(e)}});var ye=n(213),he=n(85),ve=n(87),Ee=n(561),xe=n(357);const ke=({risk:e,riskEntity:t,originalRisk:n})=>{var a,r,s,l,c,u,d,p;const m=t===he.v.host?null==e||null===(a=e.result)||void 0===a||null===(r=a[0])||void 0===r||null===(s=r.host)||void 0===s||null===(l=s.risk)||void 0===l?void 0:l.calculated_level:null==e||null===(c=e.result)||void 0===c||null===(u=c[0])||void 0===u||null===(d=u.user)||void 0===d||null===(p=d.risk)||void 0===p?void 0:p.calculated_level;return o.a.createElement(o.a.Fragment,null,o.a.createElement(i.EuiPanel,{hasBorder:!0,paddingSize:"s",grow:!1},o.a.createElement(et,{title:o.a.createElement(xe.a,{title:be(t),riskScoreEntity:t}),toolTipContent:o.a.createElement(v.FormattedMessage,{id:"xpack.securitySolution.alertDetails.overview.riskDataTooltipContent",defaultMessage:"Risk classification is displayed only when available for a {riskEntity}. Ensure {riskScoreDocumentationLink} is enabled within your environment.",values:{riskEntity:t,riskScoreDocumentationLink:o.a.createElement(Ee.a,{riskScoreEntity:t,title:ee.b(t)})}})}),e.loading&&o.a.createElement(i.EuiLoadingSpinner,{"data-test-subj":"loading"}),!e.loading&&o.a.createElement(o.a.Fragment,null,o.a.createElement(Ze,{field:ge(t),value:m?o.a.createElement(ye.b,{severity:m,hideBackgroundColor:!0}):Object(ve.e)()}),n&&m!==n&&o.a.createElement(o.a.Fragment,null,o.a.createElement(Ze,{field:fe(t),value:o.a.createElement(ye.b,{severity:n,hideBackgroundColor:!0})})))))},Se=o.a.memo(ke),we={"@timestamp":{type:"date",array:!1,required:!0},"agent.build.original":{type:"keyword",array:!1,required:!1},"agent.ephemeral_id":{type:"keyword",array:!1,required:!1},"agent.id":{type:"keyword",array:!1,required:!1},"agent.name":{type:"keyword",array:!1,required:!1},"agent.type":{type:"keyword",array:!1,required:!1},"agent.version":{type:"keyword",array:!1,required:!1},"client.address":{type:"keyword",array:!1,required:!1},"client.as.number":{type:"long",array:!1,required:!1},"client.as.organization.name":{type:"keyword",array:!1,required:!1},"client.bytes":{type:"long",array:!1,required:!1},"client.domain":{type:"keyword",array:!1,required:!1},"client.geo.city_name":{type:"keyword",array:!1,required:!1},"client.geo.continent_code":{type:"keyword",array:!1,required:!1},"client.geo.continent_name":{type:"keyword",array:!1,required:!1},"client.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"client.geo.country_name":{type:"keyword",array:!1,required:!1},"client.geo.location":{type:"geo_point",array:!1,required:!1},"client.geo.name":{type:"keyword",array:!1,required:!1},"client.geo.postal_code":{type:"keyword",array:!1,required:!1},"client.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"client.geo.region_name":{type:"keyword",array:!1,required:!1},"client.geo.timezone":{type:"keyword",array:!1,required:!1},"client.ip":{type:"ip",array:!1,required:!1},"client.mac":{type:"keyword",array:!1,required:!1},"client.nat.ip":{type:"ip",array:!1,required:!1},"client.nat.port":{type:"long",array:!1,required:!1},"client.packets":{type:"long",array:!1,required:!1},"client.port":{type:"long",array:!1,required:!1},"client.registered_domain":{type:"keyword",array:!1,required:!1},"client.subdomain":{type:"keyword",array:!1,required:!1},"client.top_level_domain":{type:"keyword",array:!1,required:!1},"client.user.domain":{type:"keyword",array:!1,required:!1},"client.user.email":{type:"keyword",array:!1,required:!1},"client.user.full_name":{type:"keyword",array:!1,required:!1},"client.user.group.domain":{type:"keyword",array:!1,required:!1},"client.user.group.id":{type:"keyword",array:!1,required:!1},"client.user.group.name":{type:"keyword",array:!1,required:!1},"client.user.hash":{type:"keyword",array:!1,required:!1},"client.user.id":{type:"keyword",array:!1,required:!1},"client.user.name":{type:"keyword",array:!1,required:!1},"client.user.roles":{type:"keyword",array:!0,required:!1},"cloud.account.id":{type:"keyword",array:!1,required:!1},"cloud.account.name":{type:"keyword",array:!1,required:!1},"cloud.availability_zone":{type:"keyword",array:!1,required:!1},"cloud.instance.id":{type:"keyword",array:!1,required:!1},"cloud.instance.name":{type:"keyword",array:!1,required:!1},"cloud.machine.type":{type:"keyword",array:!1,required:!1},"cloud.origin.account.id":{type:"keyword",array:!1,required:!1},"cloud.origin.account.name":{type:"keyword",array:!1,required:!1},"cloud.origin.availability_zone":{type:"keyword",array:!1,required:!1},"cloud.origin.instance.id":{type:"keyword",array:!1,required:!1},"cloud.origin.instance.name":{type:"keyword",array:!1,required:!1},"cloud.origin.machine.type":{type:"keyword",array:!1,required:!1},"cloud.origin.project.id":{type:"keyword",array:!1,required:!1},"cloud.origin.project.name":{type:"keyword",array:!1,required:!1},"cloud.origin.provider":{type:"keyword",array:!1,required:!1},"cloud.origin.region":{type:"keyword",array:!1,required:!1},"cloud.origin.service.name":{type:"keyword",array:!1,required:!1},"cloud.project.id":{type:"keyword",array:!1,required:!1},"cloud.project.name":{type:"keyword",array:!1,required:!1},"cloud.provider":{type:"keyword",array:!1,required:!1},"cloud.region":{type:"keyword",array:!1,required:!1},"cloud.service.name":{type:"keyword",array:!1,required:!1},"cloud.target.account.id":{type:"keyword",array:!1,required:!1},"cloud.target.account.name":{type:"keyword",array:!1,required:!1},"cloud.target.availability_zone":{type:"keyword",array:!1,required:!1},"cloud.target.instance.id":{type:"keyword",array:!1,required:!1},"cloud.target.instance.name":{type:"keyword",array:!1,required:!1},"cloud.target.machine.type":{type:"keyword",array:!1,required:!1},"cloud.target.project.id":{type:"keyword",array:!1,required:!1},"cloud.target.project.name":{type:"keyword",array:!1,required:!1},"cloud.target.provider":{type:"keyword",array:!1,required:!1},"cloud.target.region":{type:"keyword",array:!1,required:!1},"cloud.target.service.name":{type:"keyword",array:!1,required:!1},"container.id":{type:"keyword",array:!1,required:!1},"container.image.name":{type:"keyword",array:!1,required:!1},"container.image.tag":{type:"keyword",array:!0,required:!1},"container.labels":{type:"object",array:!1,required:!1},"container.name":{type:"keyword",array:!1,required:!1},"container.runtime":{type:"keyword",array:!1,required:!1},"destination.address":{type:"keyword",array:!1,required:!1},"destination.as.number":{type:"long",array:!1,required:!1},"destination.as.organization.name":{type:"keyword",array:!1,required:!1},"destination.bytes":{type:"long",array:!1,required:!1},"destination.domain":{type:"keyword",array:!1,required:!1},"destination.geo.city_name":{type:"keyword",array:!1,required:!1},"destination.geo.continent_code":{type:"keyword",array:!1,required:!1},"destination.geo.continent_name":{type:"keyword",array:!1,required:!1},"destination.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"destination.geo.country_name":{type:"keyword",array:!1,required:!1},"destination.geo.location":{type:"geo_point",array:!1,required:!1},"destination.geo.name":{type:"keyword",array:!1,required:!1},"destination.geo.postal_code":{type:"keyword",array:!1,required:!1},"destination.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"destination.geo.region_name":{type:"keyword",array:!1,required:!1},"destination.geo.timezone":{type:"keyword",array:!1,required:!1},"destination.ip":{type:"ip",array:!1,required:!1},"destination.mac":{type:"keyword",array:!1,required:!1},"destination.nat.ip":{type:"ip",array:!1,required:!1},"destination.nat.port":{type:"long",array:!1,required:!1},"destination.packets":{type:"long",array:!1,required:!1},"destination.port":{type:"long",array:!1,required:!1},"destination.registered_domain":{type:"keyword",array:!1,required:!1},"destination.subdomain":{type:"keyword",array:!1,required:!1},"destination.top_level_domain":{type:"keyword",array:!1,required:!1},"destination.user.domain":{type:"keyword",array:!1,required:!1},"destination.user.email":{type:"keyword",array:!1,required:!1},"destination.user.full_name":{type:"keyword",array:!1,required:!1},"destination.user.group.domain":{type:"keyword",array:!1,required:!1},"destination.user.group.id":{type:"keyword",array:!1,required:!1},"destination.user.group.name":{type:"keyword",array:!1,required:!1},"destination.user.hash":{type:"keyword",array:!1,required:!1},"destination.user.id":{type:"keyword",array:!1,required:!1},"destination.user.name":{type:"keyword",array:!1,required:!1},"destination.user.roles":{type:"keyword",array:!0,required:!1},"dll.code_signature.digest_algorithm":{type:"keyword",array:!1,required:!1},"dll.code_signature.exists":{type:"boolean",array:!1,required:!1},"dll.code_signature.signing_id":{type:"keyword",array:!1,required:!1},"dll.code_signature.status":{type:"keyword",array:!1,required:!1},"dll.code_signature.subject_name":{type:"keyword",array:!1,required:!1},"dll.code_signature.team_id":{type:"keyword",array:!1,required:!1},"dll.code_signature.timestamp":{type:"date",array:!1,required:!1},"dll.code_signature.trusted":{type:"boolean",array:!1,required:!1},"dll.code_signature.valid":{type:"boolean",array:!1,required:!1},"dll.hash.md5":{type:"keyword",array:!1,required:!1},"dll.hash.sha1":{type:"keyword",array:!1,required:!1},"dll.hash.sha256":{type:"keyword",array:!1,required:!1},"dll.hash.sha512":{type:"keyword",array:!1,required:!1},"dll.hash.ssdeep":{type:"keyword",array:!1,required:!1},"dll.name":{type:"keyword",array:!1,required:!1},"dll.path":{type:"keyword",array:!1,required:!1},"dll.pe.architecture":{type:"keyword",array:!1,required:!1},"dll.pe.company":{type:"keyword",array:!1,required:!1},"dll.pe.description":{type:"keyword",array:!1,required:!1},"dll.pe.file_version":{type:"keyword",array:!1,required:!1},"dll.pe.imphash":{type:"keyword",array:!1,required:!1},"dll.pe.original_file_name":{type:"keyword",array:!1,required:!1},"dll.pe.product":{type:"keyword",array:!1,required:!1},"dns.answers":{type:"object",array:!0,required:!1},"dns.answers.class":{type:"keyword",array:!1,required:!1},"dns.answers.data":{type:"keyword",array:!1,required:!1},"dns.answers.name":{type:"keyword",array:!1,required:!1},"dns.answers.ttl":{type:"long",array:!1,required:!1},"dns.answers.type":{type:"keyword",array:!1,required:!1},"dns.header_flags":{type:"keyword",array:!0,required:!1},"dns.id":{type:"keyword",array:!1,required:!1},"dns.op_code":{type:"keyword",array:!1,required:!1},"dns.question.class":{type:"keyword",array:!1,required:!1},"dns.question.name":{type:"keyword",array:!1,required:!1},"dns.question.registered_domain":{type:"keyword",array:!1,required:!1},"dns.question.subdomain":{type:"keyword",array:!1,required:!1},"dns.question.top_level_domain":{type:"keyword",array:!1,required:!1},"dns.question.type":{type:"keyword",array:!1,required:!1},"dns.resolved_ip":{type:"ip",array:!0,required:!1},"dns.response_code":{type:"keyword",array:!1,required:!1},"dns.type":{type:"keyword",array:!1,required:!1},"ecs.version":{type:"keyword",array:!1,required:!0},"error.code":{type:"keyword",array:!1,required:!1},"error.id":{type:"keyword",array:!1,required:!1},"error.message":{type:"match_only_text",array:!1,required:!1},"error.stack_trace":{type:"wildcard",array:!1,required:!1},"error.type":{type:"keyword",array:!1,required:!1},"event.action":{type:"keyword",array:!1,required:!1},"event.agent_id_status":{type:"keyword",array:!1,required:!1},"event.category":{type:"keyword",array:!0,required:!1},"event.code":{type:"keyword",array:!1,required:!1},"event.created":{type:"date",array:!1,required:!1},"event.dataset":{type:"keyword",array:!1,required:!1},"event.duration":{type:"long",array:!1,required:!1},"event.end":{type:"date",array:!1,required:!1},"event.hash":{type:"keyword",array:!1,required:!1},"event.id":{type:"keyword",array:!1,required:!1},"event.ingested":{type:"date",array:!1,required:!1},"event.kind":{type:"keyword",array:!1,required:!1},"event.module":{type:"keyword",array:!1,required:!1},"event.original":{type:"keyword",array:!1,required:!1},"event.outcome":{type:"keyword",array:!1,required:!1},"event.provider":{type:"keyword",array:!1,required:!1},"event.reason":{type:"keyword",array:!1,required:!1},"event.reference":{type:"keyword",array:!1,required:!1},"event.risk_score":{type:"float",array:!1,required:!1},"event.risk_score_norm":{type:"float",array:!1,required:!1},"event.sequence":{type:"long",array:!1,required:!1},"event.severity":{type:"long",array:!1,required:!1},"event.start":{type:"date",array:!1,required:!1},"event.timezone":{type:"keyword",array:!1,required:!1},"event.type":{type:"keyword",array:!0,required:!1},"event.url":{type:"keyword",array:!1,required:!1},"faas.coldstart":{type:"boolean",array:!1,required:!1},"faas.execution":{type:"keyword",array:!1,required:!1},"faas.trigger":{type:"nested",array:!1,required:!1},"faas.trigger.request_id":{type:"keyword",array:!1,required:!1},"faas.trigger.type":{type:"keyword",array:!1,required:!1},"file.accessed":{type:"date",array:!1,required:!1},"file.attributes":{type:"keyword",array:!0,required:!1},"file.code_signature.digest_algorithm":{type:"keyword",array:!1,required:!1},"file.code_signature.exists":{type:"boolean",array:!1,required:!1},"file.code_signature.signing_id":{type:"keyword",array:!1,required:!1},"file.code_signature.status":{type:"keyword",array:!1,required:!1},"file.code_signature.subject_name":{type:"keyword",array:!1,required:!1},"file.code_signature.team_id":{type:"keyword",array:!1,required:!1},"file.code_signature.timestamp":{type:"date",array:!1,required:!1},"file.code_signature.trusted":{type:"boolean",array:!1,required:!1},"file.code_signature.valid":{type:"boolean",array:!1,required:!1},"file.created":{type:"date",array:!1,required:!1},"file.ctime":{type:"date",array:!1,required:!1},"file.device":{type:"keyword",array:!1,required:!1},"file.directory":{type:"keyword",array:!1,required:!1},"file.drive_letter":{type:"keyword",array:!1,required:!1},"file.elf.architecture":{type:"keyword",array:!1,required:!1},"file.elf.byte_order":{type:"keyword",array:!1,required:!1},"file.elf.cpu_type":{type:"keyword",array:!1,required:!1},"file.elf.creation_date":{type:"date",array:!1,required:!1},"file.elf.exports":{type:"flattened",array:!0,required:!1},"file.elf.header.abi_version":{type:"keyword",array:!1,required:!1},"file.elf.header.class":{type:"keyword",array:!1,required:!1},"file.elf.header.data":{type:"keyword",array:!1,required:!1},"file.elf.header.entrypoint":{type:"long",array:!1,required:!1},"file.elf.header.object_version":{type:"keyword",array:!1,required:!1},"file.elf.header.os_abi":{type:"keyword",array:!1,required:!1},"file.elf.header.type":{type:"keyword",array:!1,required:!1},"file.elf.header.version":{type:"keyword",array:!1,required:!1},"file.elf.imports":{type:"flattened",array:!0,required:!1},"file.elf.sections":{type:"nested",array:!0,required:!1},"file.elf.sections.chi2":{type:"long",array:!1,required:!1},"file.elf.sections.entropy":{type:"long",array:!1,required:!1},"file.elf.sections.flags":{type:"keyword",array:!1,required:!1},"file.elf.sections.name":{type:"keyword",array:!1,required:!1},"file.elf.sections.physical_offset":{type:"keyword",array:!1,required:!1},"file.elf.sections.physical_size":{type:"long",array:!1,required:!1},"file.elf.sections.type":{type:"keyword",array:!1,required:!1},"file.elf.sections.virtual_address":{type:"long",array:!1,required:!1},"file.elf.sections.virtual_size":{type:"long",array:!1,required:!1},"file.elf.segments":{type:"nested",array:!0,required:!1},"file.elf.segments.sections":{type:"keyword",array:!1,required:!1},"file.elf.segments.type":{type:"keyword",array:!1,required:!1},"file.elf.shared_libraries":{type:"keyword",array:!0,required:!1},"file.elf.telfhash":{type:"keyword",array:!1,required:!1},"file.extension":{type:"keyword",array:!1,required:!1},"file.fork_name":{type:"keyword",array:!1,required:!1},"file.gid":{type:"keyword",array:!1,required:!1},"file.group":{type:"keyword",array:!1,required:!1},"file.hash.md5":{type:"keyword",array:!1,required:!1},"file.hash.sha1":{type:"keyword",array:!1,required:!1},"file.hash.sha256":{type:"keyword",array:!1,required:!1},"file.hash.sha512":{type:"keyword",array:!1,required:!1},"file.hash.ssdeep":{type:"keyword",array:!1,required:!1},"file.inode":{type:"keyword",array:!1,required:!1},"file.mime_type":{type:"keyword",array:!1,required:!1},"file.mode":{type:"keyword",array:!1,required:!1},"file.mtime":{type:"date",array:!1,required:!1},"file.name":{type:"keyword",array:!1,required:!1},"file.owner":{type:"keyword",array:!1,required:!1},"file.path":{type:"keyword",array:!1,required:!1},"file.pe.architecture":{type:"keyword",array:!1,required:!1},"file.pe.company":{type:"keyword",array:!1,required:!1},"file.pe.description":{type:"keyword",array:!1,required:!1},"file.pe.file_version":{type:"keyword",array:!1,required:!1},"file.pe.imphash":{type:"keyword",array:!1,required:!1},"file.pe.original_file_name":{type:"keyword",array:!1,required:!1},"file.pe.product":{type:"keyword",array:!1,required:!1},"file.size":{type:"long",array:!1,required:!1},"file.target_path":{type:"keyword",array:!1,required:!1},"file.type":{type:"keyword",array:!1,required:!1},"file.uid":{type:"keyword",array:!1,required:!1},"file.x509.alternative_names":{type:"keyword",array:!0,required:!1},"file.x509.issuer.common_name":{type:"keyword",array:!0,required:!1},"file.x509.issuer.country":{type:"keyword",array:!0,required:!1},"file.x509.issuer.distinguished_name":{type:"keyword",array:!1,required:!1},"file.x509.issuer.locality":{type:"keyword",array:!0,required:!1},"file.x509.issuer.organization":{type:"keyword",array:!0,required:!1},"file.x509.issuer.organizational_unit":{type:"keyword",array:!0,required:!1},"file.x509.issuer.state_or_province":{type:"keyword",array:!0,required:!1},"file.x509.not_after":{type:"date",array:!1,required:!1},"file.x509.not_before":{type:"date",array:!1,required:!1},"file.x509.public_key_algorithm":{type:"keyword",array:!1,required:!1},"file.x509.public_key_curve":{type:"keyword",array:!1,required:!1},"file.x509.public_key_exponent":{type:"long",array:!1,required:!1},"file.x509.public_key_size":{type:"long",array:!1,required:!1},"file.x509.serial_number":{type:"keyword",array:!1,required:!1},"file.x509.signature_algorithm":{type:"keyword",array:!1,required:!1},"file.x509.subject.common_name":{type:"keyword",array:!0,required:!1},"file.x509.subject.country":{type:"keyword",array:!0,required:!1},"file.x509.subject.distinguished_name":{type:"keyword",array:!1,required:!1},"file.x509.subject.locality":{type:"keyword",array:!0,required:!1},"file.x509.subject.organization":{type:"keyword",array:!0,required:!1},"file.x509.subject.organizational_unit":{type:"keyword",array:!0,required:!1},"file.x509.subject.state_or_province":{type:"keyword",array:!0,required:!1},"file.x509.version_number":{type:"keyword",array:!1,required:!1},"group.domain":{type:"keyword",array:!1,required:!1},"group.id":{type:"keyword",array:!1,required:!1},"group.name":{type:"keyword",array:!1,required:!1},"host.architecture":{type:"keyword",array:!1,required:!1},"host.boot.id":{type:"keyword",array:!1,required:!1},"host.cpu.usage":{type:"scaled_float",array:!1,required:!1,scaling_factor:1e3},"host.disk.read.bytes":{type:"long",array:!1,required:!1},"host.disk.write.bytes":{type:"long",array:!1,required:!1},"host.domain":{type:"keyword",array:!1,required:!1},"host.geo.city_name":{type:"keyword",array:!1,required:!1},"host.geo.continent_code":{type:"keyword",array:!1,required:!1},"host.geo.continent_name":{type:"keyword",array:!1,required:!1},"host.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"host.geo.country_name":{type:"keyword",array:!1,required:!1},"host.geo.location":{type:"geo_point",array:!1,required:!1},"host.geo.name":{type:"keyword",array:!1,required:!1},"host.geo.postal_code":{type:"keyword",array:!1,required:!1},"host.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"host.geo.region_name":{type:"keyword",array:!1,required:!1},"host.geo.timezone":{type:"keyword",array:!1,required:!1},"host.hostname":{type:"keyword",array:!1,required:!1},"host.id":{type:"keyword",array:!1,required:!1},"host.ip":{type:"ip",array:!0,required:!1},"host.mac":{type:"keyword",array:!0,required:!1},"host.name":{type:"keyword",array:!1,required:!1},"host.network.egress.bytes":{type:"long",array:!1,required:!1},"host.network.egress.packets":{type:"long",array:!1,required:!1},"host.network.ingress.bytes":{type:"long",array:!1,required:!1},"host.network.ingress.packets":{type:"long",array:!1,required:!1},"host.os.family":{type:"keyword",array:!1,required:!1},"host.os.full":{type:"keyword",array:!1,required:!1},"host.os.kernel":{type:"keyword",array:!1,required:!1},"host.os.name":{type:"keyword",array:!1,required:!1},"host.os.platform":{type:"keyword",array:!1,required:!1},"host.os.type":{type:"keyword",array:!1,required:!1},"host.os.version":{type:"keyword",array:!1,required:!1},"host.pid_ns_ino":{type:"keyword",array:!1,required:!1},"host.risk.calculated_level":{type:"keyword",array:!1,required:!1},"host.risk.calculated_score":{type:"float",array:!1,required:!1},"host.risk.calculated_score_norm":{type:"float",array:!1,required:!1},"host.risk.static_level":{type:"keyword",array:!1,required:!1},"host.risk.static_score":{type:"float",array:!1,required:!1},"host.risk.static_score_norm":{type:"float",array:!1,required:!1},"host.type":{type:"keyword",array:!1,required:!1},"host.uptime":{type:"long",array:!1,required:!1},"http.request.body.bytes":{type:"long",array:!1,required:!1},"http.request.body.content":{type:"wildcard",array:!1,required:!1},"http.request.bytes":{type:"long",array:!1,required:!1},"http.request.id":{type:"keyword",array:!1,required:!1},"http.request.method":{type:"keyword",array:!1,required:!1},"http.request.mime_type":{type:"keyword",array:!1,required:!1},"http.request.referrer":{type:"keyword",array:!1,required:!1},"http.response.body.bytes":{type:"long",array:!1,required:!1},"http.response.body.content":{type:"wildcard",array:!1,required:!1},"http.response.bytes":{type:"long",array:!1,required:!1},"http.response.mime_type":{type:"keyword",array:!1,required:!1},"http.response.status_code":{type:"long",array:!1,required:!1},"http.version":{type:"keyword",array:!1,required:!1},labels:{type:"object",array:!1,required:!1},"log.file.path":{type:"keyword",array:!1,required:!1},"log.level":{type:"keyword",array:!1,required:!1},"log.logger":{type:"keyword",array:!1,required:!1},"log.origin.file.line":{type:"long",array:!1,required:!1},"log.origin.file.name":{type:"keyword",array:!1,required:!1},"log.origin.function":{type:"keyword",array:!1,required:!1},"log.syslog":{type:"object",array:!1,required:!1},"log.syslog.facility.code":{type:"long",array:!1,required:!1},"log.syslog.facility.name":{type:"keyword",array:!1,required:!1},"log.syslog.priority":{type:"long",array:!1,required:!1},"log.syslog.severity.code":{type:"long",array:!1,required:!1},"log.syslog.severity.name":{type:"keyword",array:!1,required:!1},message:{type:"match_only_text",array:!1,required:!1},"network.application":{type:"keyword",array:!1,required:!1},"network.bytes":{type:"long",array:!1,required:!1},"network.community_id":{type:"keyword",array:!1,required:!1},"network.direction":{type:"keyword",array:!1,required:!1},"network.forwarded_ip":{type:"ip",array:!1,required:!1},"network.iana_number":{type:"keyword",array:!1,required:!1},"network.inner":{type:"object",array:!1,required:!1},"network.inner.vlan.id":{type:"keyword",array:!1,required:!1},"network.inner.vlan.name":{type:"keyword",array:!1,required:!1},"network.name":{type:"keyword",array:!1,required:!1},"network.packets":{type:"long",array:!1,required:!1},"network.protocol":{type:"keyword",array:!1,required:!1},"network.transport":{type:"keyword",array:!1,required:!1},"network.type":{type:"keyword",array:!1,required:!1},"network.vlan.id":{type:"keyword",array:!1,required:!1},"network.vlan.name":{type:"keyword",array:!1,required:!1},"observer.egress":{type:"object",array:!1,required:!1},"observer.egress.interface.alias":{type:"keyword",array:!1,required:!1},"observer.egress.interface.id":{type:"keyword",array:!1,required:!1},"observer.egress.interface.name":{type:"keyword",array:!1,required:!1},"observer.egress.vlan.id":{type:"keyword",array:!1,required:!1},"observer.egress.vlan.name":{type:"keyword",array:!1,required:!1},"observer.egress.zone":{type:"keyword",array:!1,required:!1},"observer.geo.city_name":{type:"keyword",array:!1,required:!1},"observer.geo.continent_code":{type:"keyword",array:!1,required:!1},"observer.geo.continent_name":{type:"keyword",array:!1,required:!1},"observer.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"observer.geo.country_name":{type:"keyword",array:!1,required:!1},"observer.geo.location":{type:"geo_point",array:!1,required:!1},"observer.geo.name":{type:"keyword",array:!1,required:!1},"observer.geo.postal_code":{type:"keyword",array:!1,required:!1},"observer.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"observer.geo.region_name":{type:"keyword",array:!1,required:!1},"observer.geo.timezone":{type:"keyword",array:!1,required:!1},"observer.hostname":{type:"keyword",array:!1,required:!1},"observer.ingress":{type:"object",array:!1,required:!1},"observer.ingress.interface.alias":{type:"keyword",array:!1,required:!1},"observer.ingress.interface.id":{type:"keyword",array:!1,required:!1},"observer.ingress.interface.name":{type:"keyword",array:!1,required:!1},"observer.ingress.vlan.id":{type:"keyword",array:!1,required:!1},"observer.ingress.vlan.name":{type:"keyword",array:!1,required:!1},"observer.ingress.zone":{type:"keyword",array:!1,required:!1},"observer.ip":{type:"ip",array:!0,required:!1},"observer.mac":{type:"keyword",array:!0,required:!1},"observer.name":{type:"keyword",array:!1,required:!1},"observer.os.family":{type:"keyword",array:!1,required:!1},"observer.os.full":{type:"keyword",array:!1,required:!1},"observer.os.kernel":{type:"keyword",array:!1,required:!1},"observer.os.name":{type:"keyword",array:!1,required:!1},"observer.os.platform":{type:"keyword",array:!1,required:!1},"observer.os.type":{type:"keyword",array:!1,required:!1},"observer.os.version":{type:"keyword",array:!1,required:!1},"observer.product":{type:"keyword",array:!1,required:!1},"observer.serial_number":{type:"keyword",array:!1,required:!1},"observer.type":{type:"keyword",array:!1,required:!1},"observer.vendor":{type:"keyword",array:!1,required:!1},"observer.version":{type:"keyword",array:!1,required:!1},"orchestrator.api_version":{type:"keyword",array:!1,required:!1},"orchestrator.cluster.id":{type:"keyword",array:!1,required:!1},"orchestrator.cluster.name":{type:"keyword",array:!1,required:!1},"orchestrator.cluster.url":{type:"keyword",array:!1,required:!1},"orchestrator.cluster.version":{type:"keyword",array:!1,required:!1},"orchestrator.namespace":{type:"keyword",array:!1,required:!1},"orchestrator.organization":{type:"keyword",array:!1,required:!1},"orchestrator.resource.id":{type:"keyword",array:!1,required:!1},"orchestrator.resource.ip":{type:"ip",array:!0,required:!1},"orchestrator.resource.name":{type:"keyword",array:!1,required:!1},"orchestrator.resource.parent.type":{type:"keyword",array:!1,required:!1},"orchestrator.resource.type":{type:"keyword",array:!1,required:!1},"orchestrator.type":{type:"keyword",array:!1,required:!1},"organization.id":{type:"keyword",array:!1,required:!1},"organization.name":{type:"keyword",array:!1,required:!1},"package.architecture":{type:"keyword",array:!1,required:!1},"package.build_version":{type:"keyword",array:!1,required:!1},"package.checksum":{type:"keyword",array:!1,required:!1},"package.description":{type:"keyword",array:!1,required:!1},"package.install_scope":{type:"keyword",array:!1,required:!1},"package.installed":{type:"date",array:!1,required:!1},"package.license":{type:"keyword",array:!1,required:!1},"package.name":{type:"keyword",array:!1,required:!1},"package.path":{type:"keyword",array:!1,required:!1},"package.reference":{type:"keyword",array:!1,required:!1},"package.size":{type:"long",array:!1,required:!1},"package.type":{type:"keyword",array:!1,required:!1},"package.version":{type:"keyword",array:!1,required:!1},"process.args":{type:"keyword",array:!0,required:!1},"process.args_count":{type:"long",array:!1,required:!1},"process.code_signature.digest_algorithm":{type:"keyword",array:!1,required:!1},"process.code_signature.exists":{type:"boolean",array:!1,required:!1},"process.code_signature.signing_id":{type:"keyword",array:!1,required:!1},"process.code_signature.status":{type:"keyword",array:!1,required:!1},"process.code_signature.subject_name":{type:"keyword",array:!1,required:!1},"process.code_signature.team_id":{type:"keyword",array:!1,required:!1},"process.code_signature.timestamp":{type:"date",array:!1,required:!1},"process.code_signature.trusted":{type:"boolean",array:!1,required:!1},"process.code_signature.valid":{type:"boolean",array:!1,required:!1},"process.command_line":{type:"wildcard",array:!1,required:!1},"process.elf.architecture":{type:"keyword",array:!1,required:!1},"process.elf.byte_order":{type:"keyword",array:!1,required:!1},"process.elf.cpu_type":{type:"keyword",array:!1,required:!1},"process.elf.creation_date":{type:"date",array:!1,required:!1},"process.elf.exports":{type:"flattened",array:!0,required:!1},"process.elf.header.abi_version":{type:"keyword",array:!1,required:!1},"process.elf.header.class":{type:"keyword",array:!1,required:!1},"process.elf.header.data":{type:"keyword",array:!1,required:!1},"process.elf.header.entrypoint":{type:"long",array:!1,required:!1},"process.elf.header.object_version":{type:"keyword",array:!1,required:!1},"process.elf.header.os_abi":{type:"keyword",array:!1,required:!1},"process.elf.header.type":{type:"keyword",array:!1,required:!1},"process.elf.header.version":{type:"keyword",array:!1,required:!1},"process.elf.imports":{type:"flattened",array:!0,required:!1},"process.elf.sections":{type:"nested",array:!0,required:!1},"process.elf.sections.chi2":{type:"long",array:!1,required:!1},"process.elf.sections.entropy":{type:"long",array:!1,required:!1},"process.elf.sections.flags":{type:"keyword",array:!1,required:!1},"process.elf.sections.name":{type:"keyword",array:!1,required:!1},"process.elf.sections.physical_offset":{type:"keyword",array:!1,required:!1},"process.elf.sections.physical_size":{type:"long",array:!1,required:!1},"process.elf.sections.type":{type:"keyword",array:!1,required:!1},"process.elf.sections.virtual_address":{type:"long",array:!1,required:!1},"process.elf.sections.virtual_size":{type:"long",array:!1,required:!1},"process.elf.segments":{type:"nested",array:!0,required:!1},"process.elf.segments.sections":{type:"keyword",array:!1,required:!1},"process.elf.segments.type":{type:"keyword",array:!1,required:!1},"process.elf.shared_libraries":{type:"keyword",array:!0,required:!1},"process.elf.telfhash":{type:"keyword",array:!1,required:!1},"process.end":{type:"date",array:!1,required:!1},"process.entity_id":{type:"keyword",array:!1,required:!1},"process.entry_leader.entity_id":{type:"keyword",array:!1,required:!1},"process.executable":{type:"keyword",array:!1,required:!1},"process.exit_code":{type:"long",array:!1,required:!1},"process.hash.md5":{type:"keyword",array:!1,required:!1},"process.hash.sha1":{type:"keyword",array:!1,required:!1},"process.hash.sha256":{type:"keyword",array:!1,required:!1},"process.hash.sha512":{type:"keyword",array:!1,required:!1},"process.hash.ssdeep":{type:"keyword",array:!1,required:!1},"process.name":{type:"keyword",array:!1,required:!1},"process.parent.args":{type:"keyword",array:!0,required:!1},"process.parent.args_count":{type:"long",array:!1,required:!1},"process.parent.code_signature.digest_algorithm":{type:"keyword",array:!1,required:!1},"process.parent.code_signature.exists":{type:"boolean",array:!1,required:!1},"process.parent.code_signature.signing_id":{type:"keyword",array:!1,required:!1},"process.parent.code_signature.status":{type:"keyword",array:!1,required:!1},"process.parent.code_signature.subject_name":{type:"keyword",array:!1,required:!1},"process.parent.code_signature.team_id":{type:"keyword",array:!1,required:!1},"process.parent.code_signature.timestamp":{type:"date",array:!1,required:!1},"process.parent.code_signature.trusted":{type:"boolean",array:!1,required:!1},"process.parent.code_signature.valid":{type:"boolean",array:!1,required:!1},"process.parent.command_line":{type:"wildcard",array:!1,required:!1},"process.parent.elf.architecture":{type:"keyword",array:!1,required:!1},"process.parent.elf.byte_order":{type:"keyword",array:!1,required:!1},"process.parent.elf.cpu_type":{type:"keyword",array:!1,required:!1},"process.parent.elf.creation_date":{type:"date",array:!1,required:!1},"process.parent.elf.exports":{type:"flattened",array:!0,required:!1},"process.parent.elf.header.abi_version":{type:"keyword",array:!1,required:!1},"process.parent.elf.header.class":{type:"keyword",array:!1,required:!1},"process.parent.elf.header.data":{type:"keyword",array:!1,required:!1},"process.parent.elf.header.entrypoint":{type:"long",array:!1,required:!1},"process.parent.elf.header.object_version":{type:"keyword",array:!1,required:!1},"process.parent.elf.header.os_abi":{type:"keyword",array:!1,required:!1},"process.parent.elf.header.type":{type:"keyword",array:!1,required:!1},"process.parent.elf.header.version":{type:"keyword",array:!1,required:!1},"process.parent.elf.imports":{type:"flattened",array:!0,required:!1},"process.parent.elf.sections":{type:"nested",array:!0,required:!1},"process.parent.elf.sections.chi2":{type:"long",array:!1,required:!1},"process.parent.elf.sections.entropy":{type:"long",array:!1,required:!1},"process.parent.elf.sections.flags":{type:"keyword",array:!1,required:!1},"process.parent.elf.sections.name":{type:"keyword",array:!1,required:!1},"process.parent.elf.sections.physical_offset":{type:"keyword",array:!1,required:!1},"process.parent.elf.sections.physical_size":{type:"long",array:!1,required:!1},"process.parent.elf.sections.type":{type:"keyword",array:!1,required:!1},"process.parent.elf.sections.virtual_address":{type:"long",array:!1,required:!1},"process.parent.elf.sections.virtual_size":{type:"long",array:!1,required:!1},"process.parent.elf.segments":{type:"nested",array:!0,required:!1},"process.parent.elf.segments.sections":{type:"keyword",array:!1,required:!1},"process.parent.elf.segments.type":{type:"keyword",array:!1,required:!1},"process.parent.elf.shared_libraries":{type:"keyword",array:!0,required:!1},"process.parent.elf.telfhash":{type:"keyword",array:!1,required:!1},"process.parent.end":{type:"date",array:!1,required:!1},"process.parent.entity_id":{type:"keyword",array:!1,required:!1},"process.parent.executable":{type:"keyword",array:!1,required:!1},"process.parent.exit_code":{type:"long",array:!1,required:!1},"process.parent.hash.md5":{type:"keyword",array:!1,required:!1},"process.parent.hash.sha1":{type:"keyword",array:!1,required:!1},"process.parent.hash.sha256":{type:"keyword",array:!1,required:!1},"process.parent.hash.sha512":{type:"keyword",array:!1,required:!1},"process.parent.hash.ssdeep":{type:"keyword",array:!1,required:!1},"process.parent.name":{type:"keyword",array:!1,required:!1},"process.parent.pe.architecture":{type:"keyword",array:!1,required:!1},"process.parent.pe.company":{type:"keyword",array:!1,required:!1},"process.parent.pe.description":{type:"keyword",array:!1,required:!1},"process.parent.pe.file_version":{type:"keyword",array:!1,required:!1},"process.parent.pe.imphash":{type:"keyword",array:!1,required:!1},"process.parent.pe.original_file_name":{type:"keyword",array:!1,required:!1},"process.parent.pe.product":{type:"keyword",array:!1,required:!1},"process.parent.pgid":{type:"long",array:!1,required:!1},"process.parent.pid":{type:"long",array:!1,required:!1},"process.parent.start":{type:"date",array:!1,required:!1},"process.parent.thread.id":{type:"long",array:!1,required:!1},"process.parent.thread.name":{type:"keyword",array:!1,required:!1},"process.parent.title":{type:"keyword",array:!1,required:!1},"process.parent.uptime":{type:"long",array:!1,required:!1},"process.parent.working_directory":{type:"keyword",array:!1,required:!1},"process.pe.architecture":{type:"keyword",array:!1,required:!1},"process.pe.company":{type:"keyword",array:!1,required:!1},"process.pe.description":{type:"keyword",array:!1,required:!1},"process.pe.file_version":{type:"keyword",array:!1,required:!1},"process.pe.imphash":{type:"keyword",array:!1,required:!1},"process.pe.original_file_name":{type:"keyword",array:!1,required:!1},"process.pe.product":{type:"keyword",array:!1,required:!1},"process.pgid":{type:"long",array:!1,required:!1},"process.pid":{type:"long",array:!1,required:!1},"process.session_leader.entity_id":{type:"keyword",array:!1,required:!1},"process.start":{type:"date",array:!1,required:!1},"process.thread.id":{type:"long",array:!1,required:!1},"process.thread.name":{type:"keyword",array:!1,required:!1},"process.title":{type:"keyword",array:!1,required:!1},"process.uptime":{type:"long",array:!1,required:!1},"process.working_directory":{type:"keyword",array:!1,required:!1},"registry.data.bytes":{type:"keyword",array:!1,required:!1},"registry.data.strings":{type:"wildcard",array:!0,required:!1},"registry.data.type":{type:"keyword",array:!1,required:!1},"registry.hive":{type:"keyword",array:!1,required:!1},"registry.key":{type:"keyword",array:!1,required:!1},"registry.path":{type:"keyword",array:!1,required:!1},"registry.value":{type:"keyword",array:!1,required:!1},"related.hash":{type:"keyword",array:!0,required:!1},"related.hosts":{type:"keyword",array:!0,required:!1},"related.ip":{type:"ip",array:!0,required:!1},"related.user":{type:"keyword",array:!0,required:!1},"rule.author":{type:"keyword",array:!0,required:!1},"rule.category":{type:"keyword",array:!1,required:!1},"rule.description":{type:"keyword",array:!1,required:!1},"rule.id":{type:"keyword",array:!1,required:!1},"rule.license":{type:"keyword",array:!1,required:!1},"rule.name":{type:"keyword",array:!1,required:!1},"rule.reference":{type:"keyword",array:!1,required:!1},"rule.ruleset":{type:"keyword",array:!1,required:!1},"rule.uuid":{type:"keyword",array:!1,required:!1},"rule.version":{type:"keyword",array:!1,required:!1},"server.address":{type:"keyword",array:!1,required:!1},"server.as.number":{type:"long",array:!1,required:!1},"server.as.organization.name":{type:"keyword",array:!1,required:!1},"server.bytes":{type:"long",array:!1,required:!1},"server.domain":{type:"keyword",array:!1,required:!1},"server.geo.city_name":{type:"keyword",array:!1,required:!1},"server.geo.continent_code":{type:"keyword",array:!1,required:!1},"server.geo.continent_name":{type:"keyword",array:!1,required:!1},"server.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"server.geo.country_name":{type:"keyword",array:!1,required:!1},"server.geo.location":{type:"geo_point",array:!1,required:!1},"server.geo.name":{type:"keyword",array:!1,required:!1},"server.geo.postal_code":{type:"keyword",array:!1,required:!1},"server.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"server.geo.region_name":{type:"keyword",array:!1,required:!1},"server.geo.timezone":{type:"keyword",array:!1,required:!1},"server.ip":{type:"ip",array:!1,required:!1},"server.mac":{type:"keyword",array:!1,required:!1},"server.nat.ip":{type:"ip",array:!1,required:!1},"server.nat.port":{type:"long",array:!1,required:!1},"server.packets":{type:"long",array:!1,required:!1},"server.port":{type:"long",array:!1,required:!1},"server.registered_domain":{type:"keyword",array:!1,required:!1},"server.subdomain":{type:"keyword",array:!1,required:!1},"server.top_level_domain":{type:"keyword",array:!1,required:!1},"server.user.domain":{type:"keyword",array:!1,required:!1},"server.user.email":{type:"keyword",array:!1,required:!1},"server.user.full_name":{type:"keyword",array:!1,required:!1},"server.user.group.domain":{type:"keyword",array:!1,required:!1},"server.user.group.id":{type:"keyword",array:!1,required:!1},"server.user.group.name":{type:"keyword",array:!1,required:!1},"server.user.hash":{type:"keyword",array:!1,required:!1},"server.user.id":{type:"keyword",array:!1,required:!1},"server.user.name":{type:"keyword",array:!1,required:!1},"server.user.roles":{type:"keyword",array:!0,required:!1},"service.address":{type:"keyword",array:!1,required:!1},"service.environment":{type:"keyword",array:!1,required:!1},"service.ephemeral_id":{type:"keyword",array:!1,required:!1},"service.id":{type:"keyword",array:!1,required:!1},"service.name":{type:"keyword",array:!1,required:!1},"service.node.name":{type:"keyword",array:!1,required:!1},"service.origin.address":{type:"keyword",array:!1,required:!1},"service.origin.environment":{type:"keyword",array:!1,required:!1},"service.origin.ephemeral_id":{type:"keyword",array:!1,required:!1},"service.origin.id":{type:"keyword",array:!1,required:!1},"service.origin.name":{type:"keyword",array:!1,required:!1},"service.origin.node.name":{type:"keyword",array:!1,required:!1},"service.origin.state":{type:"keyword",array:!1,required:!1},"service.origin.type":{type:"keyword",array:!1,required:!1},"service.origin.version":{type:"keyword",array:!1,required:!1},"service.state":{type:"keyword",array:!1,required:!1},"service.target.address":{type:"keyword",array:!1,required:!1},"service.target.environment":{type:"keyword",array:!1,required:!1},"service.target.ephemeral_id":{type:"keyword",array:!1,required:!1},"service.target.id":{type:"keyword",array:!1,required:!1},"service.target.name":{type:"keyword",array:!1,required:!1},"service.target.node.name":{type:"keyword",array:!1,required:!1},"service.target.state":{type:"keyword",array:!1,required:!1},"service.target.type":{type:"keyword",array:!1,required:!1},"service.target.version":{type:"keyword",array:!1,required:!1},"service.type":{type:"keyword",array:!1,required:!1},"service.version":{type:"keyword",array:!1,required:!1},"source.address":{type:"keyword",array:!1,required:!1},"source.as.number":{type:"long",array:!1,required:!1},"source.as.organization.name":{type:"keyword",array:!1,required:!1},"source.bytes":{type:"long",array:!1,required:!1},"source.domain":{type:"keyword",array:!1,required:!1},"source.geo.city_name":{type:"keyword",array:!1,required:!1},"source.geo.continent_code":{type:"keyword",array:!1,required:!1},"source.geo.continent_name":{type:"keyword",array:!1,required:!1},"source.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"source.geo.country_name":{type:"keyword",array:!1,required:!1},"source.geo.location":{type:"geo_point",array:!1,required:!1},"source.geo.name":{type:"keyword",array:!1,required:!1},"source.geo.postal_code":{type:"keyword",array:!1,required:!1},"source.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"source.geo.region_name":{type:"keyword",array:!1,required:!1},"source.geo.timezone":{type:"keyword",array:!1,required:!1},"source.ip":{type:"ip",array:!1,required:!1},"source.mac":{type:"keyword",array:!1,required:!1},"source.nat.ip":{type:"ip",array:!1,required:!1},"source.nat.port":{type:"long",array:!1,required:!1},"source.packets":{type:"long",array:!1,required:!1},"source.port":{type:"long",array:!1,required:!1},"source.registered_domain":{type:"keyword",array:!1,required:!1},"source.subdomain":{type:"keyword",array:!1,required:!1},"source.top_level_domain":{type:"keyword",array:!1,required:!1},"source.user.domain":{type:"keyword",array:!1,required:!1},"source.user.email":{type:"keyword",array:!1,required:!1},"source.user.full_name":{type:"keyword",array:!1,required:!1},"source.user.group.domain":{type:"keyword",array:!1,required:!1},"source.user.group.id":{type:"keyword",array:!1,required:!1},"source.user.group.name":{type:"keyword",array:!1,required:!1},"source.user.hash":{type:"keyword",array:!1,required:!1},"source.user.id":{type:"keyword",array:!1,required:!1},"source.user.name":{type:"keyword",array:!1,required:!1},"source.user.roles":{type:"keyword",array:!0,required:!1},"span.id":{type:"keyword",array:!1,required:!1},tags:{type:"keyword",array:!0,required:!1},"threat.enrichments":{type:"nested",array:!0,required:!1},"threat.enrichments.indicator":{type:"object",array:!1,required:!1},"threat.enrichments.indicator.as.number":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.as.organization.name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.confidence":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.description":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.email.address":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.accessed":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.attributes":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.code_signature.digest_algorithm":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.exists":{type:"boolean",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.signing_id":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.status":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.subject_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.team_id":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.timestamp":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.trusted":{type:"boolean",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.valid":{type:"boolean",array:!1,required:!1},"threat.enrichments.indicator.file.created":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.ctime":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.device":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.directory":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.drive_letter":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.architecture":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.byte_order":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.cpu_type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.creation_date":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.elf.exports":{type:"flattened",array:!0,required:!1},"threat.enrichments.indicator.file.elf.header.abi_version":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.header.class":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.header.data":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.header.entrypoint":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.elf.header.object_version":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.header.os_abi":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.header.type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.header.version":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.imports":{type:"flattened",array:!0,required:!1},"threat.enrichments.indicator.file.elf.sections":{type:"nested",array:!0,required:!1},"threat.enrichments.indicator.file.elf.sections.chi2":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.entropy":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.flags":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.physical_offset":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.physical_size":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.virtual_address":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.virtual_size":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.elf.segments":{type:"nested",array:!0,required:!1},"threat.enrichments.indicator.file.elf.segments.sections":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.segments.type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.shared_libraries":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.elf.telfhash":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.extension":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.fork_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.gid":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.group":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.hash.md5":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.hash.sha1":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.hash.sha256":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.hash.sha512":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.hash.ssdeep":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.inode":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.mime_type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.mode":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.mtime":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.owner":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.path":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.pe.architecture":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.pe.company":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.pe.description":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.pe.file_version":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.pe.imphash":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.pe.original_file_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.pe.product":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.size":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.target_path":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.uid":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.x509.alternative_names":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.issuer.common_name":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.issuer.country":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.issuer.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.x509.issuer.locality":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.issuer.organization":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.issuer.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.issuer.state_or_province":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.not_after":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.x509.not_before":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.x509.public_key_algorithm":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.x509.public_key_curve":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.x509.public_key_exponent":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.x509.public_key_size":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.x509.serial_number":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.x509.signature_algorithm":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.x509.subject.common_name":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.subject.country":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.subject.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.x509.subject.locality":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.subject.organization":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.subject.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.subject.state_or_province":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.version_number":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.first_seen":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.geo.city_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.continent_code":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.continent_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.country_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.location":{type:"geo_point",array:!1,required:!1},"threat.enrichments.indicator.geo.name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.postal_code":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.region_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.timezone":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.ip":{type:"ip",array:!1,required:!1},"threat.enrichments.indicator.last_seen":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.marking.tlp":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.modified_at":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.port":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.provider":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.reference":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.registry.data.bytes":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.registry.data.strings":{type:"wildcard",array:!0,required:!1},"threat.enrichments.indicator.registry.data.type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.registry.hive":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.registry.key":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.registry.path":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.registry.value":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.scanner_stats":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.sightings":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.domain":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.extension":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.fragment":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.full":{type:"wildcard",array:!1,required:!1},"threat.enrichments.indicator.url.original":{type:"wildcard",array:!1,required:!1},"threat.enrichments.indicator.url.password":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.path":{type:"wildcard",array:!1,required:!1},"threat.enrichments.indicator.url.port":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.url.query":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.registered_domain":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.scheme":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.subdomain":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.top_level_domain":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.username":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.x509.alternative_names":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.issuer.common_name":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.issuer.country":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.issuer.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.x509.issuer.locality":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.issuer.organization":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.issuer.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.issuer.state_or_province":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.not_after":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.x509.not_before":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.x509.public_key_algorithm":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.x509.public_key_curve":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.x509.public_key_exponent":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.x509.public_key_size":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.x509.serial_number":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.x509.signature_algorithm":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.x509.subject.common_name":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.subject.country":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.subject.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.x509.subject.locality":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.subject.organization":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.subject.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.subject.state_or_province":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.version_number":{type:"keyword",array:!1,required:!1},"threat.enrichments.matched.atomic":{type:"keyword",array:!1,required:!1},"threat.enrichments.matched.field":{type:"keyword",array:!1,required:!1},"threat.enrichments.matched.id":{type:"keyword",array:!1,required:!1},"threat.enrichments.matched.index":{type:"keyword",array:!1,required:!1},"threat.enrichments.matched.type":{type:"keyword",array:!1,required:!1},"threat.framework":{type:"keyword",array:!1,required:!1},"threat.group.alias":{type:"keyword",array:!0,required:!1},"threat.group.id":{type:"keyword",array:!1,required:!1},"threat.group.name":{type:"keyword",array:!1,required:!1},"threat.group.reference":{type:"keyword",array:!1,required:!1},"threat.indicator.as.number":{type:"long",array:!1,required:!1},"threat.indicator.as.organization.name":{type:"keyword",array:!1,required:!1},"threat.indicator.confidence":{type:"keyword",array:!1,required:!1},"threat.indicator.description":{type:"keyword",array:!1,required:!1},"threat.indicator.email.address":{type:"keyword",array:!1,required:!1},"threat.indicator.file.accessed":{type:"date",array:!1,required:!1},"threat.indicator.file.attributes":{type:"keyword",array:!0,required:!1},"threat.indicator.file.code_signature.digest_algorithm":{type:"keyword",array:!1,required:!1},"threat.indicator.file.code_signature.exists":{type:"boolean",array:!1,required:!1},"threat.indicator.file.code_signature.signing_id":{type:"keyword",array:!1,required:!1},"threat.indicator.file.code_signature.status":{type:"keyword",array:!1,required:!1},"threat.indicator.file.code_signature.subject_name":{type:"keyword",array:!1,required:!1},"threat.indicator.file.code_signature.team_id":{type:"keyword",array:!1,required:!1},"threat.indicator.file.code_signature.timestamp":{type:"date",array:!1,required:!1},"threat.indicator.file.code_signature.trusted":{type:"boolean",array:!1,required:!1},"threat.indicator.file.code_signature.valid":{type:"boolean",array:!1,required:!1},"threat.indicator.file.created":{type:"date",array:!1,required:!1},"threat.indicator.file.ctime":{type:"date",array:!1,required:!1},"threat.indicator.file.device":{type:"keyword",array:!1,required:!1},"threat.indicator.file.directory":{type:"keyword",array:!1,required:!1},"threat.indicator.file.drive_letter":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.architecture":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.byte_order":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.cpu_type":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.creation_date":{type:"date",array:!1,required:!1},"threat.indicator.file.elf.exports":{type:"flattened",array:!0,required:!1},"threat.indicator.file.elf.header.abi_version":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.header.class":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.header.data":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.header.entrypoint":{type:"long",array:!1,required:!1},"threat.indicator.file.elf.header.object_version":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.header.os_abi":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.header.type":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.header.version":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.imports":{type:"flattened",array:!0,required:!1},"threat.indicator.file.elf.sections":{type:"nested",array:!0,required:!1},"threat.indicator.file.elf.sections.chi2":{type:"long",array:!1,required:!1},"threat.indicator.file.elf.sections.entropy":{type:"long",array:!1,required:!1},"threat.indicator.file.elf.sections.flags":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.sections.name":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.sections.physical_offset":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.sections.physical_size":{type:"long",array:!1,required:!1},"threat.indicator.file.elf.sections.type":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.sections.virtual_address":{type:"long",array:!1,required:!1},"threat.indicator.file.elf.sections.virtual_size":{type:"long",array:!1,required:!1},"threat.indicator.file.elf.segments":{type:"nested",array:!0,required:!1},"threat.indicator.file.elf.segments.sections":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.segments.type":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.shared_libraries":{type:"keyword",array:!0,required:!1},"threat.indicator.file.elf.telfhash":{type:"keyword",array:!1,required:!1},"threat.indicator.file.extension":{type:"keyword",array:!1,required:!1},"threat.indicator.file.fork_name":{type:"keyword",array:!1,required:!1},"threat.indicator.file.gid":{type:"keyword",array:!1,required:!1},"threat.indicator.file.group":{type:"keyword",array:!1,required:!1},"threat.indicator.file.hash.md5":{type:"keyword",array:!1,required:!1},"threat.indicator.file.hash.sha1":{type:"keyword",array:!1,required:!1},"threat.indicator.file.hash.sha256":{type:"keyword",array:!1,required:!1},"threat.indicator.file.hash.sha512":{type:"keyword",array:!1,required:!1},"threat.indicator.file.hash.ssdeep":{type:"keyword",array:!1,required:!1},"threat.indicator.file.inode":{type:"keyword",array:!1,required:!1},"threat.indicator.file.mime_type":{type:"keyword",array:!1,required:!1},"threat.indicator.file.mode":{type:"keyword",array:!1,required:!1},"threat.indicator.file.mtime":{type:"date",array:!1,required:!1},"threat.indicator.file.name":{type:"keyword",array:!1,required:!1},"threat.indicator.file.owner":{type:"keyword",array:!1,required:!1},"threat.indicator.file.path":{type:"keyword",array:!1,required:!1},"threat.indicator.file.pe.architecture":{type:"keyword",array:!1,required:!1},"threat.indicator.file.pe.company":{type:"keyword",array:!1,required:!1},"threat.indicator.file.pe.description":{type:"keyword",array:!1,required:!1},"threat.indicator.file.pe.file_version":{type:"keyword",array:!1,required:!1},"threat.indicator.file.pe.imphash":{type:"keyword",array:!1,required:!1},"threat.indicator.file.pe.original_file_name":{type:"keyword",array:!1,required:!1},"threat.indicator.file.pe.product":{type:"keyword",array:!1,required:!1},"threat.indicator.file.size":{type:"long",array:!1,required:!1},"threat.indicator.file.target_path":{type:"keyword",array:!1,required:!1},"threat.indicator.file.type":{type:"keyword",array:!1,required:!1},"threat.indicator.file.uid":{type:"keyword",array:!1,required:!1},"threat.indicator.file.x509.alternative_names":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.issuer.common_name":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.issuer.country":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.issuer.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.indicator.file.x509.issuer.locality":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.issuer.organization":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.issuer.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.issuer.state_or_province":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.not_after":{type:"date",array:!1,required:!1},"threat.indicator.file.x509.not_before":{type:"date",array:!1,required:!1},"threat.indicator.file.x509.public_key_algorithm":{type:"keyword",array:!1,required:!1},"threat.indicator.file.x509.public_key_curve":{type:"keyword",array:!1,required:!1},"threat.indicator.file.x509.public_key_exponent":{type:"long",array:!1,required:!1},"threat.indicator.file.x509.public_key_size":{type:"long",array:!1,required:!1},"threat.indicator.file.x509.serial_number":{type:"keyword",array:!1,required:!1},"threat.indicator.file.x509.signature_algorithm":{type:"keyword",array:!1,required:!1},"threat.indicator.file.x509.subject.common_name":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.subject.country":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.subject.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.indicator.file.x509.subject.locality":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.subject.organization":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.subject.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.subject.state_or_province":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.version_number":{type:"keyword",array:!1,required:!1},"threat.indicator.first_seen":{type:"date",array:!1,required:!1},"threat.indicator.geo.city_name":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.continent_code":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.continent_name":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.country_name":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.location":{type:"geo_point",array:!1,required:!1},"threat.indicator.geo.name":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.postal_code":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.region_name":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.timezone":{type:"keyword",array:!1,required:!1},"threat.indicator.ip":{type:"ip",array:!1,required:!1},"threat.indicator.last_seen":{type:"date",array:!1,required:!1},"threat.indicator.marking.tlp":{type:"keyword",array:!1,required:!1},"threat.indicator.modified_at":{type:"date",array:!1,required:!1},"threat.indicator.port":{type:"long",array:!1,required:!1},"threat.indicator.provider":{type:"keyword",array:!1,required:!1},"threat.indicator.reference":{type:"keyword",array:!1,required:!1},"threat.indicator.registry.data.bytes":{type:"keyword",array:!1,required:!1},"threat.indicator.registry.data.strings":{type:"wildcard",array:!0,required:!1},"threat.indicator.registry.data.type":{type:"keyword",array:!1,required:!1},"threat.indicator.registry.hive":{type:"keyword",array:!1,required:!1},"threat.indicator.registry.key":{type:"keyword",array:!1,required:!1},"threat.indicator.registry.path":{type:"keyword",array:!1,required:!1},"threat.indicator.registry.value":{type:"keyword",array:!1,required:!1},"threat.indicator.scanner_stats":{type:"long",array:!1,required:!1},"threat.indicator.sightings":{type:"long",array:!1,required:!1},"threat.indicator.type":{type:"keyword",array:!1,required:!1},"threat.indicator.url.domain":{type:"keyword",array:!1,required:!1},"threat.indicator.url.extension":{type:"keyword",array:!1,required:!1},"threat.indicator.url.fragment":{type:"keyword",array:!1,required:!1},"threat.indicator.url.full":{type:"wildcard",array:!1,required:!1},"threat.indicator.url.original":{type:"wildcard",array:!1,required:!1},"threat.indicator.url.password":{type:"keyword",array:!1,required:!1},"threat.indicator.url.path":{type:"wildcard",array:!1,required:!1},"threat.indicator.url.port":{type:"long",array:!1,required:!1},"threat.indicator.url.query":{type:"keyword",array:!1,required:!1},"threat.indicator.url.registered_domain":{type:"keyword",array:!1,required:!1},"threat.indicator.url.scheme":{type:"keyword",array:!1,required:!1},"threat.indicator.url.subdomain":{type:"keyword",array:!1,required:!1},"threat.indicator.url.top_level_domain":{type:"keyword",array:!1,required:!1},"threat.indicator.url.username":{type:"keyword",array:!1,required:!1},"threat.indicator.x509.alternative_names":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.issuer.common_name":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.issuer.country":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.issuer.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.indicator.x509.issuer.locality":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.issuer.organization":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.issuer.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.issuer.state_or_province":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.not_after":{type:"date",array:!1,required:!1},"threat.indicator.x509.not_before":{type:"date",array:!1,required:!1},"threat.indicator.x509.public_key_algorithm":{type:"keyword",array:!1,required:!1},"threat.indicator.x509.public_key_curve":{type:"keyword",array:!1,required:!1},"threat.indicator.x509.public_key_exponent":{type:"long",array:!1,required:!1},"threat.indicator.x509.public_key_size":{type:"long",array:!1,required:!1},"threat.indicator.x509.serial_number":{type:"keyword",array:!1,required:!1},"threat.indicator.x509.signature_algorithm":{type:"keyword",array:!1,required:!1},"threat.indicator.x509.subject.common_name":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.subject.country":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.subject.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.indicator.x509.subject.locality":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.subject.organization":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.subject.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.subject.state_or_province":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.version_number":{type:"keyword",array:!1,required:!1},"threat.software.alias":{type:"keyword",array:!0,required:!1},"threat.software.id":{type:"keyword",array:!1,required:!1},"threat.software.name":{type:"keyword",array:!1,required:!1},"threat.software.platforms":{type:"keyword",array:!0,required:!1},"threat.software.reference":{type:"keyword",array:!1,required:!1},"threat.software.type":{type:"keyword",array:!1,required:!1},"threat.tactic.id":{type:"keyword",array:!0,required:!1},"threat.tactic.name":{type:"keyword",array:!0,required:!1},"threat.tactic.reference":{type:"keyword",array:!0,required:!1},"threat.technique.id":{type:"keyword",array:!0,required:!1},"threat.technique.name":{type:"keyword",array:!0,required:!1},"threat.technique.reference":{type:"keyword",array:!0,required:!1},"threat.technique.subtechnique.id":{type:"keyword",array:!0,required:!1},"threat.technique.subtechnique.name":{type:"keyword",array:!0,required:!1},"threat.technique.subtechnique.reference":{type:"keyword",array:!0,required:!1},"tls.cipher":{type:"keyword",array:!1,required:!1},"tls.client.certificate":{type:"keyword",array:!1,required:!1},"tls.client.certificate_chain":{type:"keyword",array:!0,required:!1},"tls.client.hash.md5":{type:"keyword",array:!1,required:!1},"tls.client.hash.sha1":{type:"keyword",array:!1,required:!1},"tls.client.hash.sha256":{type:"keyword",array:!1,required:!1},"tls.client.issuer":{type:"keyword",array:!1,required:!1},"tls.client.ja3":{type:"keyword",array:!1,required:!1},"tls.client.not_after":{type:"date",array:!1,required:!1},"tls.client.not_before":{type:"date",array:!1,required:!1},"tls.client.server_name":{type:"keyword",array:!1,required:!1},"tls.client.subject":{type:"keyword",array:!1,required:!1},"tls.client.supported_ciphers":{type:"keyword",array:!0,required:!1},"tls.client.x509.alternative_names":{type:"keyword",array:!0,required:!1},"tls.client.x509.issuer.common_name":{type:"keyword",array:!0,required:!1},"tls.client.x509.issuer.country":{type:"keyword",array:!0,required:!1},"tls.client.x509.issuer.distinguished_name":{type:"keyword",array:!1,required:!1},"tls.client.x509.issuer.locality":{type:"keyword",array:!0,required:!1},"tls.client.x509.issuer.organization":{type:"keyword",array:!0,required:!1},"tls.client.x509.issuer.organizational_unit":{type:"keyword",array:!0,required:!1},"tls.client.x509.issuer.state_or_province":{type:"keyword",array:!0,required:!1},"tls.client.x509.not_after":{type:"date",array:!1,required:!1},"tls.client.x509.not_before":{type:"date",array:!1,required:!1},"tls.client.x509.public_key_algorithm":{type:"keyword",array:!1,required:!1},"tls.client.x509.public_key_curve":{type:"keyword",array:!1,required:!1},"tls.client.x509.public_key_exponent":{type:"long",array:!1,required:!1},"tls.client.x509.public_key_size":{type:"long",array:!1,required:!1},"tls.client.x509.serial_number":{type:"keyword",array:!1,required:!1},"tls.client.x509.signature_algorithm":{type:"keyword",array:!1,required:!1},"tls.client.x509.subject.common_name":{type:"keyword",array:!0,required:!1},"tls.client.x509.subject.country":{type:"keyword",array:!0,required:!1},"tls.client.x509.subject.distinguished_name":{type:"keyword",array:!1,required:!1},"tls.client.x509.subject.locality":{type:"keyword",array:!0,required:!1},"tls.client.x509.subject.organization":{type:"keyword",array:!0,required:!1},"tls.client.x509.subject.organizational_unit":{type:"keyword",array:!0,required:!1},"tls.client.x509.subject.state_or_province":{type:"keyword",array:!0,required:!1},"tls.client.x509.version_number":{type:"keyword",array:!1,required:!1},"tls.curve":{type:"keyword",array:!1,required:!1},"tls.established":{type:"boolean",array:!1,required:!1},"tls.next_protocol":{type:"keyword",array:!1,required:!1},"tls.resumed":{type:"boolean",array:!1,required:!1},"tls.server.certificate":{type:"keyword",array:!1,required:!1},"tls.server.certificate_chain":{type:"keyword",array:!0,required:!1},"tls.server.hash.md5":{type:"keyword",array:!1,required:!1},"tls.server.hash.sha1":{type:"keyword",array:!1,required:!1},"tls.server.hash.sha256":{type:"keyword",array:!1,required:!1},"tls.server.issuer":{type:"keyword",array:!1,required:!1},"tls.server.ja3s":{type:"keyword",array:!1,required:!1},"tls.server.not_after":{type:"date",array:!1,required:!1},"tls.server.not_before":{type:"date",array:!1,required:!1},"tls.server.subject":{type:"keyword",array:!1,required:!1},"tls.server.x509.alternative_names":{type:"keyword",array:!0,required:!1},"tls.server.x509.issuer.common_name":{type:"keyword",array:!0,required:!1},"tls.server.x509.issuer.country":{type:"keyword",array:!0,required:!1},"tls.server.x509.issuer.distinguished_name":{type:"keyword",array:!1,required:!1},"tls.server.x509.issuer.locality":{type:"keyword",array:!0,required:!1},"tls.server.x509.issuer.organization":{type:"keyword",array:!0,required:!1},"tls.server.x509.issuer.organizational_unit":{type:"keyword",array:!0,required:!1},"tls.server.x509.issuer.state_or_province":{type:"keyword",array:!0,required:!1},"tls.server.x509.not_after":{type:"date",array:!1,required:!1},"tls.server.x509.not_before":{type:"date",array:!1,required:!1},"tls.server.x509.public_key_algorithm":{type:"keyword",array:!1,required:!1},"tls.server.x509.public_key_curve":{type:"keyword",array:!1,required:!1},"tls.server.x509.public_key_exponent":{type:"long",array:!1,required:!1},"tls.server.x509.public_key_size":{type:"long",array:!1,required:!1},"tls.server.x509.serial_number":{type:"keyword",array:!1,required:!1},"tls.server.x509.signature_algorithm":{type:"keyword",array:!1,required:!1},"tls.server.x509.subject.common_name":{type:"keyword",array:!0,required:!1},"tls.server.x509.subject.country":{type:"keyword",array:!0,required:!1},"tls.server.x509.subject.distinguished_name":{type:"keyword",array:!1,required:!1},"tls.server.x509.subject.locality":{type:"keyword",array:!0,required:!1},"tls.server.x509.subject.organization":{type:"keyword",array:!0,required:!1},"tls.server.x509.subject.organizational_unit":{type:"keyword",array:!0,required:!1},"tls.server.x509.subject.state_or_province":{type:"keyword",array:!0,required:!1},"tls.server.x509.version_number":{type:"keyword",array:!1,required:!1},"tls.version":{type:"keyword",array:!1,required:!1},"tls.version_protocol":{type:"keyword",array:!1,required:!1},"trace.id":{type:"keyword",array:!1,required:!1},"transaction.id":{type:"keyword",array:!1,required:!1},"url.domain":{type:"keyword",array:!1,required:!1},"url.extension":{type:"keyword",array:!1,required:!1},"url.fragment":{type:"keyword",array:!1,required:!1},"url.full":{type:"wildcard",array:!1,required:!1},"url.original":{type:"wildcard",array:!1,required:!1},"url.password":{type:"keyword",array:!1,required:!1},"url.path":{type:"wildcard",array:!1,required:!1},"url.port":{type:"long",array:!1,required:!1},"url.query":{type:"keyword",array:!1,required:!1},"url.registered_domain":{type:"keyword",array:!1,required:!1},"url.scheme":{type:"keyword",array:!1,required:!1},"url.subdomain":{type:"keyword",array:!1,required:!1},"url.top_level_domain":{type:"keyword",array:!1,required:!1},"url.username":{type:"keyword",array:!1,required:!1},"user.changes.domain":{type:"keyword",array:!1,required:!1},"user.changes.email":{type:"keyword",array:!1,required:!1},"user.changes.full_name":{type:"keyword",array:!1,required:!1},"user.changes.group.domain":{type:"keyword",array:!1,required:!1},"user.changes.group.id":{type:"keyword",array:!1,required:!1},"user.changes.group.name":{type:"keyword",array:!1,required:!1},"user.changes.hash":{type:"keyword",array:!1,required:!1},"user.changes.id":{type:"keyword",array:!1,required:!1},"user.changes.name":{type:"keyword",array:!1,required:!1},"user.changes.roles":{type:"keyword",array:!0,required:!1},"user.domain":{type:"keyword",array:!1,required:!1},"user.effective.domain":{type:"keyword",array:!1,required:!1},"user.effective.email":{type:"keyword",array:!1,required:!1},"user.effective.full_name":{type:"keyword",array:!1,required:!1},"user.effective.group.domain":{type:"keyword",array:!1,required:!1},"user.effective.group.id":{type:"keyword",array:!1,required:!1},"user.effective.group.name":{type:"keyword",array:!1,required:!1},"user.effective.hash":{type:"keyword",array:!1,required:!1},"user.effective.id":{type:"keyword",array:!1,required:!1},"user.effective.name":{type:"keyword",array:!1,required:!1},"user.effective.roles":{type:"keyword",array:!0,required:!1},"user.email":{type:"keyword",array:!1,required:!1},"user.full_name":{type:"keyword",array:!1,required:!1},"user.group.domain":{type:"keyword",array:!1,required:!1},"user.group.id":{type:"keyword",array:!1,required:!1},"user.group.name":{type:"keyword",array:!1,required:!1},"user.hash":{type:"keyword",array:!1,required:!1},"user.id":{type:"keyword",array:!1,required:!1},"user.name":{type:"keyword",array:!1,required:!1},"user.risk.calculated_level":{type:"keyword",array:!1,required:!1},"user.risk.calculated_score":{type:"float",array:!1,required:!1},"user.risk.calculated_score_norm":{type:"float",array:!1,required:!1},"user.risk.static_level":{type:"keyword",array:!1,required:!1},"user.risk.static_score":{type:"float",array:!1,required:!1},"user.risk.static_score_norm":{type:"float",array:!1,required:!1},"user.roles":{type:"keyword",array:!0,required:!1},"user.target.domain":{type:"keyword",array:!1,required:!1},"user.target.email":{type:"keyword",array:!1,required:!1},"user.target.full_name":{type:"keyword",array:!1,required:!1},"user.target.group.domain":{type:"keyword",array:!1,required:!1},"user.target.group.id":{type:"keyword",array:!1,required:!1},"user.target.group.name":{type:"keyword",array:!1,required:!1},"user.target.hash":{type:"keyword",array:!1,required:!1},"user.target.id":{type:"keyword",array:!1,required:!1},"user.target.name":{type:"keyword",array:!1,required:!1},"user.target.roles":{type:"keyword",array:!0,required:!1},"user_agent.device.name":{type:"keyword",array:!1,required:!1},"user_agent.name":{type:"keyword",array:!1,required:!1},"user_agent.original":{type:"keyword",array:!1,required:!1},"user_agent.os.family":{type:"keyword",array:!1,required:!1},"user_agent.os.full":{type:"keyword",array:!1,required:!1},"user_agent.os.kernel":{type:"keyword",array:!1,required:!1},"user_agent.os.name":{type:"keyword",array:!1,required:!1},"user_agent.os.platform":{type:"keyword",array:!1,required:!1},"user_agent.os.type":{type:"keyword",array:!1,required:!1},"user_agent.os.version":{type:"keyword",array:!1,required:!1},"user_agent.version":{type:"keyword",array:!1,required:!1},"vulnerability.category":{type:"keyword",array:!0,required:!1},"vulnerability.classification":{type:"keyword",array:!1,required:!1},"vulnerability.description":{type:"keyword",array:!1,required:!1},"vulnerability.enumeration":{type:"keyword",array:!1,required:!1},"vulnerability.id":{type:"keyword",array:!1,required:!1},"vulnerability.reference":{type:"keyword",array:!1,required:!1},"vulnerability.report_id":{type:"keyword",array:!1,required:!1},"vulnerability.scanner.vendor":{type:"keyword",array:!1,required:!1},"vulnerability.score.base":{type:"float",array:!1,required:!1},"vulnerability.score.environmental":{type:"float",array:!1,required:!1},"vulnerability.score.temporal":{type:"float",array:!1,required:!1},"vulnerability.score.version":{type:"keyword",array:!1,required:!1},"vulnerability.severity":{type:"keyword",array:!1,required:!1}};var je=n(135);const Oe={[je.e]:{type:"scaled_float",scaling_factor:100},[je.f]:{type:"scaled_float",scaling_factor:100}},Ie={...function(e,...t){const n=Object.keys(e).filter((e=>t.some((t=>{if(t===e)return!0;const n=e.split("."),a=t.split(".");return a.indexOf("*")===a.length-1&&n.every(((e,t)=>{const n=a.length-1<t?"*":a[t];return e===n||"*"===n}))}))));return Object(g.pick)(e,n)}(we,je.ib,je.eb,je.db,je.hb),[je.A]:{type:"flattened",ignore_above:4096},[je.I]:{type:"keyword",required:!0},[je.n]:{type:"keyword",required:!0},[je.B]:{type:"keyword",required:!0},[je.gb]:{type:"keyword",array:!0,required:!0},[je.Y]:{type:"keyword",required:!0},[je.h]:{type:"keyword",required:!0},[je.O]:{type:"date"},[je.X]:{type:"date_range",format:"epoch_millis||strict_date_optional_time"},[je.d]:{type:"date"},[je.c]:{type:"long"},[je.N]:{type:"keyword"},[je.P]:{type:"keyword",required:!0},[je.g]:{type:"boolean"},[je.jb]:{type:"version",array:!1,required:!1},[je.cb]:{type:"keyword",array:!1,required:!1},[je.k]:{type:"float",array:!1,required:!1},[je.ab]:{type:"keyword",array:!1,required:!1},[je.bb]:{type:"keyword",array:!1,required:!1},[je.Z]:{type:"keyword",array:!1,required:!1},[je.W]:{type:"keyword",array:!1,required:!1},[je.a]:{type:"keyword",array:!1,required:!1},[je.j]:{type:"keyword",array:!1,required:!1},[je.l]:{type:"keyword",array:!1,required:!1},[je.m]:{type:"keyword",array:!1,required:!0},[je.L]:{type:"keyword",array:!1,required:!0},[je.o]:{type:"date",array:!1,required:!1},[je.p]:{type:"keyword",array:!1,required:!1},[je.q]:{type:"keyword",array:!1,required:!1},[je.r]:{type:"keyword",array:!1,required:!1},[je.t]:{type:"keyword",array:!1,required:!1},[je.u]:{type:"keyword",array:!1,required:!1},[je.v]:{type:"keyword",array:!1,required:!1},[je.w]:{type:"keyword",array:!1,required:!1},[je.x]:{type:"keyword",array:!1,required:!0},[je.z]:{type:"keyword",array:!1,required:!1},[je.C]:{type:"keyword",array:!0,required:!1},[je.D]:{type:"keyword",array:!1,required:!1},[je.E]:{type:"keyword",array:!1,required:!1},[je.F]:{type:"keyword",array:!0,required:!1},[je.G]:{type:"keyword",array:!1,required:!1},[je.H]:{type:"keyword",array:!1,required:!1},[je.J]:{type:"date",array:!1,required:!1},[je.K]:{type:"keyword",array:!1,required:!1},[je.M]:{type:"keyword",array:!1,required:!1},[je.S]:{type:"keyword",array:!0,required:!1},[je.V]:{type:"keyword",array:!0,required:!1},[je.T]:{type:"date",array:!1,required:!1},[je.R]:{type:"date",array:!1,required:!1},[je.Q]:{type:"long",array:!1,required:!1}};var Te=n(1);const Ce=e=>{if(Array.isArray(e))return e.reduce(((e,t)=>{if(null!=t)switch(typeof t){case"number":case"boolean":return[...e,t.toString()];case"object":try{return[...e,JSON.stringify(t)]}catch{return[...e,"Invalid Object"]}case"string":return[...e,t];default:return[...e,`${t}`]}return e}),[]);if(null==e)return[];if(Array.isArray(e)||"object"!=typeof e)return[`${e}`];try{return[JSON.stringify(e)]}catch{return["Invalid Object"]}},Me=["@timestamp","labels","message","tags"],Ne=e=>{const t=e.length>0?e[0]:null;if(null!=t&&!Object(a.isEmpty)(t.coordinates))try{return Ce({lon:t.coordinates[0],lat:t.coordinates[1]})}catch{return Ce(e)}return Ce(e)},De=(e,t,n)=>Object.keys(e).reduce(((i,r)=>{const o=e[r],s=null!=n?n:(e=>{const t=e.split(".")[0];return!Object(a.isEmpty)(t)&&Me.includes(t)?"base":t})(r);if((e=>e.includes("geo.location")||e.includes("geoip.location"))(r))return[...i,{category:s,field:r,values:Ne(o),originalValue:Ne(o),isObjectArray:!0}];const l=(e=>{if(Array.isArray(e))return e.reduce(((e,t)=>{if(null!=t)switch(typeof t){case"number":case"boolean":return[...e,{str:t.toString()}];case"object":try{return[...e,{str:JSON.stringify(t),isObjectArray:!0}]}catch{return[...e,{str:"Invalid Object"}]}case"string":return[...e,{str:t}];default:return[...e,{str:`${t}`}]}return e}),[]);if(null==e)return[];if(Array.isArray(e)||"object"!=typeof e)return[{str:`${e}`}];try{return[{str:JSON.stringify(e),isObjectArray:!0}]}catch{return[{str:"Invalid Object"}]}})(o),c=l.map((({str:e})=>e)),u=l.some((e=>e.isObjectArray)),d=t?`${t}.${r}`:r;if(!u||void 0===Object.keys({...we,...Ie,...Oe}).find((e=>e===r)))return[...i,{category:s,field:d,values:c,originalValue:c,isObjectArray:u}];const p=((e,t)=>(null==t?void 0:t.includes(Te.yb))||e===Te.yb)(r,t)?[{category:s,field:d,values:c,originalValue:c,isObjectArray:u}]:[],m=Array.isArray(o)?o.reduce(((e,t)=>[...e,De(t,d,s)]),[]).flat():De(o,t,s),g=[...i,...m,...p].reduce(((e,t)=>({...e,...null!=e[t.field]?{[t.field]:{...t,originalValue:e[t.field].originalValue.includes(t.originalValue[0])?e[t.field].originalValue:[...e[t.field].originalValue,...t.originalValue],values:e[t.field].values.includes(t.values[0])?e[t.field].values:[...e[t.field].values,...t.values]}}:{[t.field]:t}})),{});return Object.values(g)}),[]);var Fe=n(140),Ae=n(548);const _e=e=>e?e[0]:void 0,Re=e=>e===Fe.c.InvestigationTime,Pe=(e,t)=>_e(e[t]),Le=(e,t)=>Pe(e,t)||Pe(e,`threatintel.${t}`)||Pe(e,`threat.${t}`),qe=e=>({id:Pe(e,Fe.m),field:Pe(e,Fe.l),value:Pe(e,Fe.k),type:Pe(e,Fe.n),feedName:Le(e,Fe.e)}),Be=e=>{const{id:t,field:n}=qe(e);return`${t}${n}`},ze=e=>{const t=Le(e,Fe.f),n=Date.parse(null!=t?t:"no date");return Number.isInteger(n)?n:new Date(-1).valueOf()};var $e=n(196);const Ve=l.a.span.withConfig({displayName:"EnrichmentFieldFeedName",componentId:"sc-gb4ple-0"})(["white-space:nowrap;font-style:italic;"]),Ue=l()(i.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-gb4ple-1"})([".hoverActions-active{.timelines__hoverActionButton,.securitySolution__hoverActionButton{opacity:1;}}&:hover{.timelines__hoverActionButton,.securitySolution__hoverActionButton{opacity:1;}}"]),He=({browserField:e,data:t,eventId:n,index:a,feedName:r,scopeId:s,value:l,isDraggable:c,isReadOnly:u})=>{if(!t||!l)return null;const d=`alert-details-value-formatted-field-value-${s}-${n}-${t.field}-${l}-${a}-${r}`;return o.a.createElement(Ue,{key:d,direction:"row",gutterSize:"xs",alignItems:"center"},o.a.createElement(i.EuiFlexItem,{grow:!1},o.a.createElement("div",null,o.a.createElement($e.a,{contextId:s,eventId:d,fieldFormat:t.format,fieldName:t.field,fieldType:t.type,isDraggable:c,isObjectArray:t.isObjectArray,value:l,truncate:!1}),r&&o.a.createElement(Ve,null," ",te," ",r))),o.a.createElement(i.EuiFlexItem,null,l&&!u&&o.a.createElement(U.a,{data:t,contextId:s,eventId:d,fieldFromBrowserField:e,scopeId:s,values:[l],applyWidthAndPadding:!1})))},Ge=({browserFields:e,data:t,enrichments:n,scopeId:r,eventId:s,isDraggable:l,isReadOnly:c})=>{const u=n.map(((n,i)=>{var r,o,s,l;const{field:c,type:u,feedName:d,value:p}=qe(n),m=t.find((e=>e.field===c)),g=null!==(r=null==m?void 0:m.category)&&void 0!==r?r:"",f=Object(a.get)([g,"fields",null!=c?c:""],e);return{fieldsData:{field:null!=c?c:"",format:null!==(o=null==f?void 0:f.format)&&void 0!==o?o:"",type:null!==(s=null==f?void 0:f.type)&&void 0!==s?s:"",isObjectArray:null!==(l=null==m?void 0:m.isObjectArray)&&void 0!==l&&l},type:u,feedName:d,index:i,field:c,browserField:f,value:p}})),[d,p]=Object(g.partition)(u,(({type:e})=>Re(e)));return o.a.createElement(o.a.Fragment,null,p.length>0&&o.a.createElement(i.EuiFlexItem,{grow:!1},o.a.createElement(i.EuiPanel,{hasBorder:!0,paddingSize:"s",grow:!1},o.a.createElement(et,{title:ne,toolTipContent:ie}),p.map((({fieldsData:e,index:t,field:n,feedName:a,browserField:i,value:u})=>o.a.createElement(Ze,{key:n,field:n,value:o.a.createElement(He,{eventId:s,index:t,feedName:a,scopeId:r,value:u,data:e,browserField:i,isDraggable:l,isReadOnly:c})}))))),d.length>0&&o.a.createElement(i.EuiFlexItem,{grow:!1},o.a.createElement(i.EuiPanel,{hasBorder:!0,paddingSize:"s",grow:!1},o.a.createElement(et,{title:ae,toolTipContent:oe}),d.map((({fieldsData:e,index:t,field:n,feedName:a,browserField:i,value:u})=>o.a.createElement(Ze,{key:n,field:n,value:o.a.createElement(He,{eventId:s,index:t,feedName:a,scopeId:r,value:u,data:e,browserField:i,isDraggable:l,isReadOnly:c})}))))))},Qe=o.a.memo(Ge),We=l()(i.EuiTitle).withConfig({displayName:"UppercaseEuiTitle",componentId:"sc-1l7nex2-0"})(["text-transform:uppercase;"]),Ke=({children:e})=>o.a.createElement(We,{size:"xxxs"},o.a.createElement("h5",null,e)),Ye=l()(i.EuiTitle).withConfig({displayName:"StyledEnrichmentFieldTitle",componentId:"sc-1l7nex2-1"})(["width:220px;"]),Je=({title:e})=>o.a.createElement(Ye,{size:"xxxs"},o.a.createElement("h6",null,e)),Xe=l()(i.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-1l7nex2-2"})(["font-size:",";margin-top:",";"],(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.euiSizeS)),Ze=({field:e,value:t})=>o.a.createElement(Xe,{direction:"row",gutterSize:"none",responsive:!0,alignItems:"center","data-test-subj":"EnrichedDataRow"},o.a.createElement(i.EuiFlexItem,{style:{flexShrink:0},grow:!1},o.a.createElement(Je,{title:e})),o.a.createElement(i.EuiFlexItem,{className:"eui-textBreakWord"},t)),et=({title:e,toolTipContent:t})=>{const[n,a]=Object(r.useState)(!1),s=Object(r.useCallback)((()=>{a(!n)}),[n,a]),l=Object(r.useCallback)((()=>{a(!1)}),[a]);return o.a.createElement(i.EuiFlexGroup,{direction:"row",gutterSize:"none",alignItems:"center"},o.a.createElement(i.EuiFlexItem,null,o.a.createElement(Ke,null,e)),o.a.createElement(i.EuiFlexItem,{grow:!1},o.a.createElement(i.EuiPopover,{isOpen:n,closePopover:l,anchorPosition:"leftCenter",button:o.a.createElement(i.EuiButtonIcon,{color:"text",size:"xs",iconSize:"m",iconType:"iInCircle","aria-label":re,onClick:s})},o.a.createElement(i.EuiPopoverTitle,null,e),o.a.createElement(i.EuiText,{size:"s",style:{width:"270px"}},t))))},tt=({browserFields:e,data:t,enrichments:n,eventId:a,scopeId:r,hostRisk:s,userRisk:l,isDraggable:c,isReadOnly:u})=>{var d,p,m,g;const f=null==t||null===(d=t.find((e=>"host.risk.calculated_level"===(null==e?void 0:e.field))))||void 0===d||null===(p=d.values)||void 0===p?void 0:p[0],b=null==t||null===(m=t.find((e=>"user.risk.calculated_level"===(null==e?void 0:e.field))))||void 0===m||null===(g=m.values)||void 0===g?void 0:g[0];return o.a.createElement(o.a.Fragment,null,o.a.createElement(i.EuiHorizontalRule,null),o.a.createElement(i.EuiTitle,{size:"xxxs"},o.a.createElement("h5",null,me)),o.a.createElement(i.EuiSpacer,{size:"m"}),o.a.createElement(i.EuiFlexGroup,{direction:"column",gutterSize:"m",style:{flexGrow:0}},o.a.createElement(i.EuiFlexItem,{grow:!1},o.a.createElement(Se,{riskEntity:he.v.host,risk:s,originalRisk:f})),o.a.createElement(i.EuiFlexItem,{grow:!1},o.a.createElement(Se,{riskEntity:he.v.user,risk:l,originalRisk:b})),o.a.createElement(Qe,{browserFields:e,data:t,enrichments:n,scopeId:r,eventId:a,isDraggable:c,isReadOnly:u})))},nt=o.a.memo(tt),at=e=>Re(e)?ae:ne,it=e=>Re(e)?oe:ie,rt=({type:e})=>o.a.createElement(i.EuiToolTip,{title:at(e),content:it(e)},o.a.createElement(i.EuiIcon,{type:"iInCircle",size:"m"})),ot=l.a.div.withConfig({displayName:"OverflowParent",componentId:"sc-1m2w4qg-0"})(["display:inline-grid;"]),st=l.a.div.withConfig({displayName:"OverflowContainer",componentId:"sc-1m2w4qg-1"})(["white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-weight:bold;"]),lt=({field:e="",feedName:t="",value:n=""})=>{const a=`${e} ${n}${t?` ${te} ${t}`:""}`;return o.a.createElement(i.EuiToolTip,{content:n},o.a.createElement(ot,{"data-test-subj":"enrichment-button-content"},o.a.createElement(st,null,a)))},ct=l.a.h5.withConfig({displayName:"StyledH5",componentId:"sc-tbqfly-0"})(["line-height:1.7rem;"]),ut=e=>o.a.createElement(i.EuiTitle,{size:"xxxs"},o.a.createElement(ct,null,e));ut.displayName="ThreatSummaryTitle";var dt=n(124),pt=n(129),mt=n(15),gt=n(42);const ft=Object(pt.d)((e=>(({data:e,defaultIndex:t,eventFields:n,filterQuery:a,timerange:i,signal:r})=>e.search.search({defaultIndex:t,eventFields:n,factoryQueryType:Ae.a.eventEnrichment,filterQuery:a,timerange:i},{strategy:"securitySolutionSearchStrategy",abortSignal:r}))(e).pipe(Object(mt.filter)((e=>Object(gt.isErrorResponse)(e)||Object(gt.isCompleteResponse)(e))))));var bt=n(268),yt=n.n(bt),ht=n(90),vt=n(84),Et=n(184);const xt=$.i18n.translate("xpack.securitySolution.investigationEnrichment.requestError",{defaultMessage:"An error occurred while requesting threat intelligence"}),kt="investigation_time_enrichment",St=()=>{},wt={enrichments:[]},jt=l()(i.EuiInMemoryTable).withConfig({displayName:"ThreatSummaryTable",componentId:"sc-10n0cst-0"})([".euiTableHeaderCell,.euiTableRowCell{border:none;}.euiTableHeaderCell .euiTableCellContent{padding:0;}"]),Ot=l()(i.EuiAccordion).withConfig({displayName:"StyledEuiAccordion",componentId:"sc-2hwa3a-0"})([".euiAccordion__triggerWrapper{background:",";border-radius:",";height:",";margin-bottom:",";padding-left:",";}"],(({theme:e})=>e.eui.euiColorLightestShade),(({theme:e})=>e.eui.euiSizeXS),(({theme:e})=>e.eui.euiSizeXL),(({theme:e})=>e.eui.euiSizeS),(({theme:e})=>e.eui.euiSizeS)),It=[{field:"title",truncateText:!1,render:ut,width:"220px",name:""},{field:"description",truncateText:!1,render:({fieldName:e,value:t})=>{const n=e.match(Fe.p)?o.a.createElement(i.EuiLink,{href:t,target:"_blank"},t):o.a.createElement("span",null,t);return o.a.createElement(i.EuiToolTip,{"data-test-subj":"message-tool-tip",content:o.a.createElement(i.EuiFlexGroup,{direction:"column",gutterSize:"none"},o.a.createElement(i.EuiFlexItem,{grow:!1},o.a.createElement("span",null,e)))},n)},name:""}],Tt=e=>Object.keys(e).sort().map((t=>({title:t.startsWith(Te.T)?t.replace(`${Te.T}`,"indicator"):t,description:{fieldName:t,value:_e(e[t])}}))),Ct=({enrichment:e,index:t})=>{const{id:n="threat-details-item",field:a,feedName:r,type:s,value:l}=qe(e),c=`${n}${a}`;return o.a.createElement(Ot,{id:c,key:c,initialIsOpen:!0,arrowDisplay:"right",buttonContent:o.a.createElement(lt,{field:a,feedName:r,value:l}),extraAction:Re(s)&&o.a.createElement(i.EuiFlexItem,{grow:!1},o.a.createElement(dt.b,{queryId:kt,title:ce}))},o.a.createElement(jt,{columns:It,compressed:!0,"data-test-subj":`threat-details-view-${t}`,items:Tt(e)}))},Mt=({enrichments:e})=>o.a.createElement(o.a.Fragment,null,e.sort(((e,t)=>ze(t)-ze(e))).map(((t,n)=>o.a.createElement(o.a.Fragment,{key:`${t.id}`},o.a.createElement(Ct,{enrichment:t,index:n}),n<e.length-1&&o.a.createElement(i.EuiSpacer,{size:"m"}))))),Nt=l.a.div.withConfig({displayName:"InlineBlock",componentId:"sc-1tu9mdx-0"})(["display:inline-block;line-height:1.7em;"]),Dt=({type:e})=>e?o.a.createElement(Nt,{"data-test-subj":"no-enrichments-found"},e===Fe.c.IndicatorMatchRule?le:se):null,Ft=({type:e})=>e?o.a.createElement(o.a.Fragment,null,o.a.createElement(i.EuiFlexGroup,{direction:"row",gutterSize:"xs",alignItems:"baseline"},o.a.createElement(i.EuiFlexItem,{grow:!1},o.a.createElement(i.EuiTitle,{size:"xxxs"},o.a.createElement("h5",null,e===Fe.c.IndicatorMatchRule?ne:ae))),o.a.createElement(i.EuiFlexItem,{grow:!1},o.a.createElement(rt,{type:e}))),o.a.createElement(i.EuiSpacer,{size:"s"})):null,At=({enrichments:e,type:t,loading:n,dataTestSubj:a,children:r})=>o.a.createElement("div",{"data-test-subj":a},o.a.createElement(Ft,{type:t}),r,Array.isArray(e)?o.a.createElement(Mt,{enrichments:e}):o.a.createElement(o.a.Fragment,null,o.a.createElement(Dt,{type:t}),n&&o.a.createElement(o.a.Fragment,null,o.a.createElement(i.EuiSpacer,{size:"m"}),o.a.createElement(i.EuiLoadingContent,{"data-test-subj":"loading-enrichments",lines:4})))),_t=({enrichments:e,showInvestigationTimeEnrichments:t,loading:n,children:a})=>{const{[Fe.c.IndicatorMatchRule]:r,[Fe.c.InvestigationTime]:s,undefined:l}=Object(g.groupBy)(e,"matched.type");return o.a.createElement(o.a.Fragment,null,o.a.createElement(i.EuiSpacer,{size:"m"}),o.a.createElement(At,{dataTestSubj:"threat-match-detected",enrichments:r,type:Fe.c.IndicatorMatchRule}),t&&o.a.createElement(o.a.Fragment,null,o.a.createElement(i.EuiHorizontalRule,null),o.a.createElement(At,{dataTestSubj:"enriched-with-threat-intel",enrichments:s,type:Fe.c.InvestigationTime,loading:n},a)),l&&o.a.createElement(o.a.Fragment,null,o.a.createElement(i.EuiHorizontalRule,null),r&&o.a.createElement(i.EuiSpacer,{size:"l"}),o.a.createElement(At,{enrichments:l,dataTestSubj:"matches-with-no-type"})))},Rt=o.a.memo(_t),Pt=l()(i.EuiInMemoryTable).withConfig({displayName:"SummaryTable",componentId:"sc-tjbhe3-0"})([".timelines__hoverActionButton{opacity:0;}.flyoutTableHoverActions{.hoverActions-active{.timelines__hoverActionButton,.securitySolution__hoverActionButton{opacity:1;}}&:hover{.timelines__hoverActionButton,.securitySolution__hoverActionButton{opacity:1;}}}"]);var Lt=n(873),qt=n(104),Bt=n(301),zt=n(256),$t=n(114),Vt=n(186),Ut=n(185),Ht=n(98);const Gt="countOfAlertsWithSameFieldAndValue",Qt=({field:e,value:t,isActiveTimelines:n,signalIndexName:a,includeAlertIds:i=!1,ignoreTimerange:o=!1})=>{const s=Object(G.a)((e=>Ht.d.timelineTimeRangeSelector(e))),l=Object($t.a)(!1);let c,u;!1===o&&({to:c,from:u}=n?s:l);const[d]=Object(r.useState)((()=>Wt(e,t,u,c,i))),{loading:p,data:m,setQuery:g}=Object(Vt.a)({query:d,indexName:a,queryName:Ut.a.PREVALENCE});let f;if(Object(r.useEffect)((()=>{g(Wt(e,t,u,c,i))}),[g,e,t,u,c,i]),m){var b,y;const e=null===(b=m.aggregations)||void 0===b||null===(y=b[Gt])||void 0===y?void 0:y.buckets;e&&e.length>0&&(f=null==e?void 0:e.reduce(((e,t)=>{var n;return e+(null!==(n=null==t?void 0:t.doc_count)&&void 0!==n?n:0)}),0))}return{loading:p,count:f,error:!p&&void 0===f,alertIds:null==m?void 0:m.hits.hits.map((({_id:e})=>e))}},Wt=(e,t,n,a,i)=>{const r=i?{size:Te.Y}:{size:0},o=i?{sort:{"@timestamp":"desc"}}:{},s=Array.isArray(t)&&1===t.length?t[0]:t;let l;return l={bool:{must:{match:{[e]:s}}}},void 0!==n&&void 0!==a&&(l={...l,bool:{...l.bool,filter:[{range:{"@timestamp":{gte:n,lte:a}}}]}}),Array.isArray(t)&&t.length>1&&(l={bool:{minimum_should_match:1,should:t.map((t=>({match:{[e]:t}})))}},void 0!==n&&void 0!==a&&(l={...l,bool:{...l.bool,must:[{range:{"@timestamp":{gte:n,lte:a}}}]}})),{...r,...o,_source:!1,aggs:{[Gt]:{terms:{field:e,size:Te.Y}}},query:l,runtime_mappings:{}}},Kt=({data:e,eventId:t,fieldFromBrowserField:n,linkValue:a,scopeId:r,values:s})=>{const{loading:l,count:c}=Qt({field:e.field,isActiveTimelines:r===qt.d.active,value:s,signalIndexName:null}),u=Object(zt.b)({contextId:r,eventId:t,field:e.field,fieldFormat:e.format,fieldFromBrowserField:n,fieldType:e.type,isObjectArray:e.isObjectArray,linkValue:a,values:s});return l?o.a.createElement(i.EuiLoadingSpinner,null):"number"==typeof c&&null!=u&&u.dataProviders&&null!=u&&u.dataProviders.length?o.a.createElement(Bt.a,{asEmptyButton:!0,dataProviders:u.dataProviders},o.a.createElement("span",{"data-test-subj":"alert-prevalence"},c)):Object(ve.d)()};Kt.displayName="PrevalenceCell";const Yt=[{field:"title",truncateText:!1,name:w.h,textOnly:!0},{field:"description",truncateText:!1,render:Lt.a,name:w.i}],Jt=[...Yt,{field:"description",truncateText:!0,render:e=>o.a.createElement(Kt,e),name:o.a.createElement(o.a.Fragment,null,w.f," ",o.a.createElement(i.EuiIconTip,{type:"iInCircle",color:"subdued",title:w.f,content:o.a.createElement("span",null,w.g)})),align:"right",width:"130px"}],Xt={className:"flyoutTableHoverActions"},Zt=({goToTable:e,rows:t,title:n,isReadOnly:a})=>{const r=a?Yt:Jt;return o.a.createElement("div",null,o.a.createElement(i.EuiFlexGroup,null,o.a.createElement(i.EuiFlexItem,null,o.a.createElement(i.EuiTitle,{size:"xxxs"},o.a.createElement("h5",null,n))),o.a.createElement(i.EuiFlexItem,{grow:!1},o.a.createElement(i.EuiLink,{onClick:e},o.a.createElement(i.EuiText,{size:"xs"},w.v)))),o.a.createElement(i.EuiSpacer,{size:"s"}),o.a.createElement(Pt,{"data-test-subj":"summary-view",items:t,columns:r,rowProps:Xt,compressed:!0}))},en=o.a.memo(Zt);var tn=n(118),nn=n(471),an=n(176),rn=n(289);let on,sn;!function(e){e.MALICIOUS_FILE="malicious_file",e.RANSOMWARE="ransomware",e.MEMORY_SIGNATURE="memory_signature",e.SHELLCODE_THREAD="shellcode_thread",e.BEHAVIOR="behavior"}(on||(on={})),function(e){e.PROCESS="process",e.FILE="file",e.NETWORK="network",e.REGISTRY="registry",e.MALWARE="malware"}(sn||(sn={}));const ln=`${nn.h}.terms.field`,cn=`${nn.h}.terms.value`,un=`${nn.h}.cardinality.field`,dn=`${nn.h}.cardinality.value`,pn=`${nn.h}.count`,mn=[{id:"host.name"},{id:"agent.id",overrideField:an.a,label:w.b},{id:"user.name"},{id:"rule.name"},{id:je.H,label:w.r}];function gn({primaryEventCategory:e,allEventCategories:t}){switch(e){case sn.PROCESS:return[{id:"process.name"},{id:"process.parent.name"},{id:"process.args"}];case sn.FILE:return[{id:"file.name"},{id:"file.hash.sha256"},{id:"file.directory"},{id:"process.name"}];case sn.NETWORK:return[{id:"destination.address"},{id:"destination.port"},{id:"source.address"},{id:"source.port"},{id:"dns.question.name"},{id:"process.name"}];case sn.REGISTRY:return[{id:"registry.key"},{id:"registry.value"},{id:"process.name"}];case sn.MALWARE:return gn({primaryEventCategory:sn.FILE,allEventCategories:t});default:let e=[];return null!=t&&t.includes(sn.FILE)&&(e=e.concat(gn({primaryEventCategory:sn.FILE}))),null!=t&&t.includes(sn.PROCESS)&&(e=e.concat(gn({primaryEventCategory:sn.PROCESS}))),e}}function fn(e,t){switch(e){case on.BEHAVIOR:return[{id:"rule.description",label:tn.q},...gn({...t,primaryEventCategory:void 0})];case on.SHELLCODE_THREAD:return[{id:"Target.process.executable"},{id:"Memory_protection.unique_key_v1"}];case on.RANSOMWARE:return[{id:"Ransomware.feature"},{id:"process.hash.sha256"},...gn({...t,primaryEventCategory:void 0})];case on.MEMORY_SIGNATURE:return gn({...t,primaryEventCategory:void 0});default:return[]}}function bn(e){switch(e){case"threshold":return[{id:pn,label:tn.t},{id:ln,overrideField:cn,label:tn.u},{id:un,label:tn.s}];case"machine_learning":return[{id:`${je.A}.machine_learning_job_id`,legacyId:"signal.rule.machine_learning_job_id"},{id:`${je.A}.anomaly_threshold`,legacyId:"signal.rule.anomaly_threshold"}];case"threat_match":return[{id:`${je.A}.threat_index`,legacyId:"signal.rule.threat_index"},{id:`${je.A}.threat_query`,legacyId:"signal.rule.threat_query"}];case"new_terms":return[{id:nn.c,label:tn.m},{id:nn.b,label:tn.l}];default:return[]}}const yn=({browserFields:e,data:t,eventId:n,isDraggable:i,scopeId:s,title:l,goToTable:c,isReadOnly:u})=>{const d=Object(r.useMemo)((()=>(({data:e,browserFields:t,scopeId:n,eventId:i,isDraggable:r=!1,isReadOnly:o=!1})=>{var s,l;const c=function(e){const t=Object(a.find)({category:"event",field:"event.category"},e);let n,i;return Array.isArray(null==t?void 0:t.originalValue)?(n=null==t?void 0:t.originalValue[0],i=null==t?void 0:t.originalValue):(n=null==t?void 0:t.originalValue,n&&(i=[n])),{primaryEventCategory:n,allEventCategories:i}}(e),u=Object(a.find)({category:"event",field:"event.code"},e),d=Array.isArray(null==u?void 0:u.originalValue)?null==u||null===(s=u.originalValue)||void 0===s?void 0:s[0]:null==u?void 0:u.originalValue,p=Object(a.find)({category:"kibana",field:je.H},e),m=function({eventCategories:e,eventCode:t,eventRuleType:n}){const i=[...mn,...gn(e),...fn(t,e),...bn(n)];return Object(a.uniqBy)("id",i)}({eventCategories:c,eventCode:d,eventRuleType:Array.isArray(null==p?void 0:p.originalValue)?null==p||null===(l=p.originalValue)||void 0===l?void 0:l[0]:null==p?void 0:p.originalValue});return null!=e?m.reduce(((s,l)=>{var c;const u=e.find((e=>e.field===l.id||l.legacyId&&e.field===l.legacyId));if(!u||Object(a.isEmpty)(u.values))return s;u.field===l.legacyId&&(l.id=l.legacyId);const d=null!=l.linkField&&e.find((e=>e.field===l.linkField)),p={...Object(z.b)({item:u,linkValueField:d||void 0,contextId:n,scopeId:n,browserFields:t,eventId:i,field:l}),isDraggable:r,isReadOnly:o};if("agent.id"===l.id&&!Object(rn.b)({data:e}))return s;if(l.id===ln){const t=function({values:e},t,n){const a=t.find((e=>e.field===cn)),i=a&&a.values;if(Array.isArray(e)&&e.length>0&&Array.isArray(i)&&e.length===i.length)return e.map(((e,t)=>({title:e,description:{...n,values:[i[t]]}}))).filter((e=>!mn.map((e=>e.id)).includes(e.title)))}(u,e,p);return t?[...s,...t]:s}if(l.id===un){const t=function({values:e},t,n){const a=t.find((e=>e.field===dn)),i=a&&a.values;if(Array.isArray(e)&&1===e.length&&Array.isArray(i)&&e.length===i.length)return{title:tn.s,description:{...n,values:[`count(${e[0]}) >= ${i[0]}`]}}}(u,e,p);return t?[...s,t]:s}return[...s,{title:null!==(c=l.label)&&void 0!==c?c:l.id,description:p}]}),[]):[]})({browserFields:e,data:t,eventId:n,isDraggable:i,scopeId:s,isReadOnly:u})),[e,t,n,i,s,u]);return o.a.createElement(en,{rows:d,title:l,goToTable:c,isReadOnly:u})},hn=o.a.memo(yn);var vn=n(43),En=n.n(vn);const xn=({range:e,setRange:t,loading:n})=>{const[a,s]=Object(r.useState)(e.from===Fe.a?En()().subtract(30,"d"):En()(e.from)),[l,c]=Object(r.useState)(e.to===Fe.b?En()():En()(e.to)),u=Object(r.useCallback)((()=>{a&&l&&a.isBefore(l)&&t({from:a.toISOString(),to:l.toISOString()})}),[l,t,a]),d=Object(r.useMemo)((()=>null==a?void 0:a.isBefore(l)),[a,l]);return o.a.createElement(i.EuiFlexGroup,null,o.a.createElement(i.EuiFlexItem,{grow:!1},o.a.createElement(i.EuiDatePickerRange,{"data-test-subj":"enrichment-query-range-picker",startDateControl:o.a.createElement(i.EuiDatePicker,{className:"start-picker",selected:a,onChange:s,startDate:a,endDate:l,isInvalid:!d,"aria-label":ue,showTimeSelect:!0}),endDateControl:o.a.createElement(i.EuiDatePicker,{className:"end-picker",selected:l,onChange:c,startDate:a,endDate:l,isInvalid:!d,"aria-label":de,showTimeSelect:!0})})),o.a.createElement(i.EuiFlexItem,{grow:!1},o.a.createElement(i.EuiButton,{iconType:"refresh",onClick:u,isLoading:n,"data-test-subj":"enrichment-button",isDisabled:!d},pe)))};var kn=n(509),Sn=n(51);const wn=Sn.euiStyled.div`
  width: 0;
  transform: translate(6px);
  transition: transform 50ms ease-in-out;
  margin-left: ${({theme:e})=>e.eui.euiSizeS};
`,jn=Object(Sn.euiStyled)(i.EuiPanel)`
  &&& {
    background-color: ${({theme:e})=>e.eui.euiColorLightestShade};
    padding: ${({theme:e})=>e.eui.euiSizeS};
    height: 78px;
  }

  & {
    .hoverActions-active {
      .timelines__hoverActionButton,
      .securitySolution__hoverActionButton {
        opacity: 1;
      }
    }

    &:hover {
      .timelines__hoverActionButton,
      .securitySolution__hoverActionButton {
        opacity: 1;
      }

      ${wn} {
        width: auto;
        transform: translate(0);
      }
    }

    ${e=>e.$isPopoverVisible&&`\n      & ${wn} {\n        width: auto;\n        transform: translate(0);\n      }\n    `}
  }
`,On=({title:e,children:t,isPopoverVisible:n=!1})=>o.a.createElement(jn,{borderRadius:"none",hasShadow:!1,hasBorder:!1,paddingSize:"s",$isPopoverVisible:n},o.a.createElement(i.EuiText,{size:"s"},e),o.a.createElement(i.EuiSpacer,{size:"s"}),t);On.displayName="OverviewCard";const In=Sn.euiStyled.div`
  /* Clamp text content to 2 lines */
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
`;In.displayName="ClampedContent";const Tn=({title:e,children:t,contextId:n,dataTestSubj:a,enrichedFieldInfo:s})=>{const[l,c]=Object(r.useState)(!1);return o.a.createElement(On,{title:e,isPopoverVisible:l},o.a.createElement(i.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},o.a.createElement(In,{"data-test-subj":a},t),o.a.createElement(wn,null,o.a.createElement(U.a,m()({},s,{contextId:n,setIsPopoverVisible:c,applyWidthAndPadding:!1})))))};Tn.displayName="OverviewCardWithActions";var Cn=n(472);const Mn=o.a.memo((({eventId:e,contextId:t,enrichedFieldInfo:n,indexName:a,scopeId:s,handleOnEventClosed:l})=>{const[c,u]=Object(r.useState)(!1),d=Object(r.useCallback)((()=>u(!c)),[c]),p=Object(r.useCallback)((()=>u(!1)),[]),m=Object(r.useCallback)((()=>{p(),l()}),[p,l]),{actionItems:g}=Object(Cn.a)({closePopover:m,eventId:e,scopeId:s,indexName:a,alertStatus:n.values[0]}),f=Object(r.useMemo)((()=>g.length>0),[g]),b=Object(r.useMemo)((()=>o.a.createElement($e.a,{contextId:t,eventId:e,value:n.values[0],fieldName:n.data.field,linkValue:n.linkValue,fieldType:n.data.type,fieldFormat:n.data.format,isDraggable:!1,truncate:!1,isButton:f,onClick:f?d:void 0,onClickAriaLabel:tn.w})),[t,e,n,d,f]);return f?o.a.createElement(i.EuiPopover,{button:b,isOpen:c,closePopover:p,panelPaddingSize:"none","data-test-subj":"alertStatus"},o.a.createElement(i.EuiPopoverTitle,{paddingSize:"m"},tn.v),o.a.createElement(i.EuiContextMenuPanel,{items:g})):b}));Mn.displayName="StatusPopoverButton";var Nn=n(390),Dn=n(198),Fn=n(936);const An=Object(Sn.euiStyled)(i.EuiFlexGroup)`
  flex-grow: 0;
`,_n=o.a.memo((({browserFields:e,contextId:t,data:n,eventId:s,handleOnEventClosed:l,indexName:c,scopeId:u,isReadOnly:d})=>{const p=Object(r.useMemo)((()=>{const i=Object(a.find)({field:an.m,category:"kibana"},n);return i&&Object(z.b)({eventId:s,contextId:t,scopeId:u,browserFields:e,item:i})}),[e,t,n,s,u]),m=Object(r.useMemo)((()=>{const i=Object(a.find)({field:"kibana.alert.severity",category:"kibana"},n);return i&&Object(z.b)({eventId:s,contextId:t,scopeId:u,browserFields:e,item:i})}),[e,t,n,s,u]),g=Object(r.useMemo)((()=>{const i=Object(a.find)({field:"kibana.alert.risk_score",category:"kibana"},n);return i&&Object(z.b)({eventId:s,contextId:t,scopeId:u,browserFields:e,item:i})}),[e,t,n,s,u]),f=Object(r.useMemo)((()=>{const i=Object(a.find)({field:an.l,category:"kibana"},n),r=Object(a.find)({field:"kibana.alert.rule.uuid",category:"kibana"},n);return i&&Object(z.b)({eventId:s,contextId:t,scopeId:u,browserFields:e,item:i,linkValueField:r})}),[e,t,n,s,u]),b=Rn(p)&&!d?o.a.createElement(i.EuiFlexItem,{key:"status"},o.a.createElement(Tn,{title:tn.C,enrichedFieldInfo:p,contextId:t},o.a.createElement(Mn,{eventId:s,contextId:t,enrichedFieldInfo:p,indexName:c,scopeId:u,handleOnEventClosed:l}))):null,y=Rn(m)?o.a.createElement(i.EuiFlexItem,{key:"severity"},d?o.a.createElement(On,{title:tn.r},o.a.createElement(Nn.a,{value:m.values[0]})):o.a.createElement(Tn,{title:tn.r,enrichedFieldInfo:m,contextId:t},o.a.createElement(Nn.a,{value:m.values[0]}))):null,h=Rn(g)?o.a.createElement(i.EuiFlexItem,{key:"riskScore"},d?o.a.createElement(On,{title:tn.o},g.values[0]):o.a.createElement(Tn,{title:tn.o,enrichedFieldInfo:g,contextId:t,dataTestSubj:"riskScore"},g.values[0])):null,v=Rn(f)&&!d?o.a.createElement(i.EuiFlexItem,{key:"ruleName"},o.a.createElement(Tn,{title:tn.p,enrichedFieldInfo:f,contextId:t},o.a.createElement($e.a,{contextId:t,eventId:s,value:f.values[0],fieldName:f.data.field,linkValue:f.linkValue,fieldType:f.data.type,fieldFormat:f.data.format,isDraggable:!1,truncate:!1}))):null,{width:E,ref:x}=Object(Dn.b)(),k=0===E||E>=675,S=[b,y,h,v].filter(Fn.h),w=k?o.a.createElement(An,{gutterSize:"s"},S):o.a.createElement(o.a.Fragment,null,Object(a.chunk)(2,S).map(((e,t,{length:n})=>{const a=t<n-1;return o.a.createElement(o.a.Fragment,null,o.a.createElement(An,{gutterSize:"s"},e),a&&o.a.createElement(i.EuiSpacer,{size:"s"}))})));return o.a.createElement("div",{ref:x},w)}));function Rn(e){return!!e&&Array.isArray(e.values)}_n.displayName="Overview";var Pn=n(214);function Ln(e){return Boolean(e&&e.values&&e.values.length)}var qn=n(13),Bn=n(39),zn=n(630);const $n=Object(Sn.euiStyled)(i.EuiAccordion)`
  border: 1px solid ${({theme:e})=>e.eui.euiColorLightShade};
  padding: 10px 8px;
  border-radius: 6px;
`,Vn=o.a.memo((({prefix:e,state:t,text:n,renderContent:r,onToggle:s=a.noop,extraAction:l,forceState:c})=>{const u=Object(i.useGeneratedHtmlId)({prefix:e});switch(t){case"loading":return o.a.createElement($n,{id:u,buttonContent:n,onToggle:s,isLoading:!0});case"error":return o.a.createElement($n,{id:u,buttonContent:o.a.createElement("span",null,o.a.createElement(i.EuiIcon,{type:"alert",color:"danger",style:{marginRight:"6px"}}),n),onToggle:s,extraAction:l});case"success":return o.a.createElement($n,{"tour-step":`${e}-accordion`,"data-test-subj":`${e}-accordion`,id:u,buttonContent:n,onToggle:s,paddingSize:"l",extraAction:l,forceState:c},r());default:return null}}));Vn.displayName="InsightAccordion";var Un=n(101);const Hn=(e,t)=>({fields:t,_source:!1,query:{ids:{values:e}}}),Gn=["@timestamp","kibana.alert.rule.name","kibana.alert.severity"],Qn=[{field:"kibana.alert.rule.name",name:"Rule"},{field:"@timestamp",name:"@timestamp",render:e=>o.a.createElement(Un.c,{value:new Date(e)})},{field:"kibana.alert.severity",name:"Severity",render:e=>o.a.createElement(Nn.a,{value:e})}],Wn=o.a.memo((({alertIds:e})=>{const t=Object(r.useMemo)((()=>e.slice(0,10)),[e]),{loading:n,error:a,data:s}=(({alertIds:e,fields:t=["*"]})=>{const[n]=Object(r.useState)((()=>Hn(e,t))),{loading:a,data:i,setQuery:o}=Object(Vt.a)({query:n,queryName:Ut.a.BY_ID});return Object(r.useEffect)((()=>{o(Hn(e,t))}),[o,e,t]),{loading:a,error:!a&&void 0===i,data:null==i?void 0:i.hits.hits}})({alertIds:t,fields:Gn}),l=Object(r.useMemo)((()=>{if(s)return s.map((e=>e.fields))}),[s]);if(n)return o.a.createElement(i.EuiLoadingContent,{lines:2});if(a)return o.a.createElement(o.a.Fragment,null,Pn.p);if(l){const t=e.length>10;return o.a.createElement(o.a.Fragment,null,t&&o.a.createElement("div",null,o.a.createElement("em",null,Pn.q),o.a.createElement(i.EuiSpacer,null)),o.a.createElement(i.EuiBasicTable,{compressed:!0,items:l,columns:Qn}))}return null}));Wn.displayName="SimpleAlertTable";var Kn=n(14);const Yn=o.a.memo((({data:e,originalDocumentId:t,index:n,eventId:a,scopeId:s})=>{const[l,c]=Object(r.useState)(!1),[u,d]=Object(r.useState)({}),p=Object(r.useCallback)((e=>c(e)),[]),m=Object(r.useCallback)((()=>l?u.alertIds?o.a.createElement(Xn,{eventId:a,scopeId:s,alertIds:u.alertIds}):o.a.createElement(Jn,{data:e,index:n,originalDocumentId:t,eventId:a,isActiveTimelines:Object(C.isActiveTimeline)(null!=s?s:""),onCacheLoad:d}):null),[l,u.alertIds,e,n,t,a,s]),g=Object(r.useMemo)((()=>o.a.createElement(i.EuiBetaBadge,{size:"s",label:Kn.a,color:"subdued"})),[]);return o.a.createElement(Vn,{prefix:"RelatedAlertsByProcessAncestry",state:"success",text:u.alertIds?Object(Pn.h)(u.alertIds.length):Pn.g,renderContent:m,onToggle:p,extraAction:g})}));Yn.displayName="RelatedAlertsByProcessAncestry";const Jn=({data:e,originalDocumentId:t,index:n,isActiveTimelines:a,onCacheLoad:s,eventId:l})=>{const{values:c}=e,{values:u}=n,{values:d}=t,p=Array.isArray(d)?d[0]:"",m=Array.isArray(c)?c[0]:"",{loading:g,error:f,alertIds:b}=function({processEntityId:e,documentId:t,isActiveTimeline:n,indices:a}){const i=Object(S.j)(),{selectedPatterns:r}=Object(zn.a)(n),o=[...new Set(r.concat(a))],{loading:s,id:l,schema:c}=function({documentId:e,indices:t}){const n=Object(S.j)(),a=Object(Bn.useQuery)(["getAlertPrevalenceSchema",e],(()=>n.get("/api/endpoint/resolver/entity",{query:{_id:e,indices:t}})));if(a.isLoading)return{loading:!0,error:!1,id:null,schema:null};if(a.data&&a.data.length>0){const{data:[{schema:e,id:t}]}=a;return{loading:!1,error:!1,id:t,schema:e}}return{loading:!1,error:!0,id:null,schema:null}}({documentId:t,indices:o}),u=Object(Bn.useQuery)(["getAlertPrevalenceFromProcessTree",l],(()=>i.post("/api/endpoint/resolver/tree",{body:JSON.stringify({schema:c,ancestors:200,descendants:500,indexPatterns:o,nodes:[l],includeHits:!0})})),{enabled:null!==c&&null!==l});return u.isLoading||s?{loading:!0,error:!1,alertIds:void 0}:u.data?{loading:!1,error:!1,alertIds:u.data.alertIds}:{loading:!1,error:!0,alertIds:void 0}}({processEntityId:m,isActiveTimeline:a,documentId:p,indices:null!=u?u:[]});return Object(r.useEffect)((()=>{b&&0!==b.length&&s({alertIds:b})}),[b,s]),g?o.a.createElement(i.EuiLoadingSpinner,null):f?o.a.createElement(o.a.Fragment,null,Pn.j):b&&0!==b.length?null:o.a.createElement(o.a.Fragment,null,Pn.i)};Jn.displayName="FetchAndNotifyCachedAlertsByProcessAncestry";const Xn=({alertIds:e,eventId:t,scopeId:n})=>{const a=e&&e.length&&e.length>=5,s=Object(r.useMemo)((()=>e&&e.length?a?null:e.reduce(((e,a,i)=>{const r=`${n}-${t}-event.id-${i}-${a}`;return e.push(Object(zt.a)("_id",r,a)),e}),[]):null),[e,a,n,t]),l=Object(r.useMemo)((()=>a?[{meta:{alias:Pn.k,type:"phrases",key:"_id",params:[...e],negate:!1,disabled:!1,value:e.join()},query:{bool:{should:e.map((e=>({match_phrase:{_id:e}}))),minimum_should_match:1}}}]:null),[e,a]);return s||l?o.a.createElement(o.a.Fragment,null,o.a.createElement(Wn,{alertIds:e}),o.a.createElement(i.EuiSpacer,null),o.a.createElement(Bt.a,{asEmptyButton:!1,dataProviders:s,filters:l,"data-test-subj":"investigate-ancestry-in-timeline"},tn.f)):null};Xn.displayName="ActualRelatedAlertsByProcessAncestry";var Zn=n(403);const ea=o.a.memo((({eventId:e})=>{const{services:{cases:t}}=Object(S.k)(),n=Object(S.o)(),[a,i]=Object(r.useState)(void 0),[s,l]=Object(r.useState)(!1),{activeStep:c,isTourShown:u}=Object(Zn.b)(),p=Object(r.useMemo)((()=>c===h.a.viewCase&&u(h.b.alertsCases)),[c,u]),m=Object(r.useCallback)((()=>function(e=[]){const t=e.length;return o.a.createElement("span",null,o.a.createElement(v.FormattedMessage,{defaultMessage:"This alert was found in {caseCount}",id:"xpack.securitySolution.alertDetails.overview.insights_related_cases_found_content",values:{caseCount:o.a.createElement("strong",null,o.a.createElement(v.FormattedMessage,{id:"xpack.securitySolution.alertDetails.overview.insights_related_cases_found_content_count",defaultMessage:"{caseCount} {caseCount, plural, =0 {cases.} =1 {case:} other {cases:}}",values:{caseCount:t}}))}}),e.map((({id:t,title:n},a)=>t&&n?o.a.createElement("span",{key:t}," ",o.a.createElement(d.a,{detailName:t,title:n,index:a},n),e[a+1]?",":""):o.a.createElement(o.a.Fragment,null))))}(a)),[a]),[g,f]=Object(r.useState)(!1);Object(r.useEffect)((()=>{if(!g)return;let a=!1;return(async()=>{let r=[];try{var o;e&&(r=null!==(o=await t.api.getRelatedCases(e,{owner:Te.p}))&&void 0!==o?o:[])}catch(e){a||l(!0),n.addWarning(Object(Pn.c)(e))}a||(i(r),f(!1))})(),()=>{a=!0}}),[t.api,e,g,n]),Object(r.useEffect)((()=>{f(!0)}),[e]);let b="loading";return s?b="error":a&&(b="success"),o.a.createElement(Vn,{prefix:"RelatedCases",state:b,text:ta(b,null==a?void 0:a.length),renderContent:m,forceState:p?"open":void 0})}));function ta(e,t=0){switch(e){case"loading":return Pn.d;case"error":return Pn.b;case"success":return Object(Pn.a)(t);default:return""}}ea.displayName="RelatedCases";const na=o.a.memo((({browserFields:e,data:t,eventId:n,scopeId:a})=>{const{field:s,values:l}=t,{error:c,count:u,alertIds:d}=Qt({field:s,value:l,isActiveTimelines:Object(C.isActiveTimeline)(a),signalIndexName:null,includeAlertIds:!0}),{fieldFromBrowserField:p}=Object(z.b)({browserFields:e,contextId:a,eventId:n,field:{id:t.field},scopeId:a,item:t}),m=Object(zt.b)({field:s,values:l,contextId:a,eventId:n,fieldFromBrowserField:p,fieldFormat:null==p?void 0:p.format,fieldType:null==p?void 0:p.type}),g=0===u;let f="loading";c?f="error":d&&(f="success");const b=Object(r.useCallback)((()=>d&&null!=m&&m.dataProviders?g&&"loading"!==f?Pn.s:o.a.createElement(o.a.Fragment,null,o.a.createElement(Wn,{alertIds:d}),o.a.createElement(i.EuiSpacer,null),o.a.createElement(Bt.a,{asEmptyButton:!1,dataProviders:null==m?void 0:m.dataProviders},tn.f)):null),[d,null==m?void 0:m.dataProviders,g,f]);return o.a.createElement(Vn,{prefix:"RelatedAlertsBySourceEvent",state:f,text:aa(f,u),renderContent:b})}));function aa(e,t){switch(e){case"loading":return Pn.u;case"error":return Pn.t;case"success":return Object(Pn.r)(t);default:return""}}na.displayName="RelatedAlertsBySourceEvent";const ia=o.a.memo((({browserFields:e,data:t,eventId:n,scopeId:a})=>{const{field:s,values:l}=t,{error:c,count:u,alertIds:d}=Qt({field:s,value:l,isActiveTimelines:Object(C.isActiveTimeline)(a),signalIndexName:null,includeAlertIds:!0,ignoreTimerange:!0}),{fieldFromBrowserField:p}=Object(z.b)({browserFields:e,contextId:a,eventId:n,field:{id:t.field},scopeId:a,item:t}),m=Object(zt.b)({field:s,values:l,contextId:a,eventId:n,fieldFromBrowserField:p,fieldFormat:null==p?void 0:p.format,fieldType:null==p?void 0:p.type}),g=0===u;let f="loading";c?f="error":(d||g)&&(f="success");const b=Object(r.useCallback)((()=>d&&null!=m&&m.dataProviders?g&&"loading"!==f?Pn.m:o.a.createElement(o.a.Fragment,null,o.a.createElement(Wn,{alertIds:d}),o.a.createElement(i.EuiSpacer,null),o.a.createElement(Bt.a,{asEmptyButton:!1,dataProviders:null==m?void 0:m.dataProviders},tn.f)):null),[d,null==m?void 0:m.dataProviders,g,f]);return o.a.createElement(Vn,{prefix:"RelatedAlertsBySession",state:f,text:ra(f,u),renderContent:b})}));function ra(e,t){switch(e){case"loading":return Pn.o;case"error":return Pn.n;case"success":return Object(Pn.l)(t);default:return""}}ia.displayName="RelatedAlertsBySession";const oa=Sn.euiStyled.div`
  border: 1px solid ${({theme:e})=>e.eui.euiColorLightShade};
  padding: 12px;
  border-radius: 6px;
`,sa=Object(Sn.euiStyled)(i.EuiIcon)`
  margin-right: 10px;
`,la=o.a.memo((()=>{const{getAppUrl:e,navigateTo:t}=Object(S.m)(),n=e({appId:"management",path:"stack/license_management"}),a=Object(r.useCallback)((()=>{t({url:n})}),[t,n]);return o.a.createElement(oa,null,o.a.createElement(i.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},o.a.createElement(i.EuiFlexItem,{grow:!1},o.a.createElement(sa,{size:"m",type:"lock"})),o.a.createElement(i.EuiFlexItem,null,o.a.createElement(i.EuiText,{size:"s"},o.a.createElement(i.EuiLink,{color:"subdued",onClick:a,target:"_blank"},Pn.f)))))}));la.displayName="RelatedAlertsUpsell";const ca=Object(Sn.euiStyled)(i.EuiFlexItem)`
  border: 1px solid ${({theme:e})=>e.eui.euiColorLightShade};
  padding: 10px 8px;
  border-radius: 6px;
  display: inline-flex;
`,ua=o.a.memo((({browserFields:e,eventId:t,data:n,isReadOnly:r,scopeId:s})=>{const l=Object(c.a)("insightsRelatedAlertsByProcessAncestry"),u=Object(qn.b)().isPlatinumPlus(),d=Object(a.find)({category:"kibana",field:"kibana.alert.ancestors.id"},n),p=Object(a.find)({category:"kibana",field:"kibana.alert.rule.parameters.index"},n),m=Object(a.find)({category:"agent",field:"agent.type"},n),g=Object(a.find)({category:"event",field:"event.module"},n),f=Object(a.find)({category:"process",field:"process.entity_id"},n),b=Ln(f)&&function(e,t){return Ln(e)&&("endpoint"===e.values[0]||"winlogbeat"===e.values[0]&&Ln(t)&&"sysmon"===t.values[0])}(m,g),y=Object(a.find)({category:"process",field:"process.entry_leader.entity_id"},n),h=l&&Ln(y),v=Object(a.find)({category:"kibana",field:"kibana.alert.original_event.id"},n),E=Ln(v),x=Object(a.find)({category:"kibana",field:je.Q},n),k=Ln(x),w=Object(S.i)().read,j=l&&b&&d&&p;return r||!(w||b||E||h)?null:o.a.createElement("div",null,o.a.createElement(i.EuiFlexGroup,{direction:"column",gutterSize:"m"},o.a.createElement(i.EuiFlexItem,null,o.a.createElement(i.EuiTitle,{size:"xxxs"},o.a.createElement("h5",null,Pn.e))),k&&o.a.createElement(ca,null,o.a.createElement("div",null,o.a.createElement(i.EuiIcon,{type:"layers",style:{marginLeft:"4px",marginRight:"8px"}}),Pn.v(parseInt(x.values[0],10)),o.a.createElement(i.EuiBetaBadge,{label:Pn.w,style:{verticalAlign:"middle",marginLeft:"8px"},size:"s"}))),w&&o.a.createElement(i.EuiFlexItem,null,o.a.createElement(ea,{eventId:t})),v&&v.values&&o.a.createElement(i.EuiFlexItem,null,o.a.createElement(na,{browserFields:e,data:v,eventId:t,scopeId:s})),y&&y.values&&o.a.createElement(i.EuiFlexItem,{"data-test-subj":"related-alerts-by-session"},o.a.createElement(ia,{browserFields:e,data:y,eventId:t,scopeId:s})),j&&(u?o.a.createElement(i.EuiFlexItem,{"data-test-subj":"related-alerts-by-ancestry"},o.a.createElement(Yn,{data:f,originalDocumentId:d,index:p,eventId:t,scopeId:s})):o.a.createElement(i.EuiFlexItem,null,o.a.createElement(la,null)))))}));ua.displayName="Insights";var da=n(352),pa=n(291);const ma={cursorStart:0,querySize:1};var ga=n(375),fa=n(97),ba=n(292);let ya;!function(e){e.tableView="table-view",e.jsonView="json-view",e.summaryView="summary-view",e.threatIntelView="threat-intel-view",e.osqueryView="osquery-results-view"}(ya||(ya={}));const ha=l()(i.EuiTabbedContent).withConfig({displayName:"StyledEuiTabbedContent",componentId:"sc-5ll1tb-0"})(["display:flex;flex:1;flex-direction:column;overflow:hidden;> [role='tabpanel']{display:flex;flex:1;flex-direction:column;overflow:hidden;overflow-y:auto;::-webkit-scrollbar{-webkit-appearance:none;width:7px;}::-webkit-scrollbar-thumb{border-radius:4px;background-color:rgba(0,0,0,0.5);-webkit-box-shadow:0 0 1px rgba(255,255,255,0.5);}}"]),va=l.a.div.withConfig({displayName:"TabContentWrapper",componentId:"sc-5ll1tb-1"})(["height:100%;position:relative;"]),Ea=l.a.div.withConfig({displayName:"RendererContainer",componentId:"sc-5ll1tb-2"})(["overflow-x:auto;padding-right:",";& ."," .euiFlexGroup{justify-content:flex-start;}"],(e=>e.theme.eui.euiSizeXS),fa.a),xa=l()(i.EuiFlexGroup).withConfig({displayName:"ThreatTacticContainer",componentId:"sc-5ll1tb-3"})(["flex-wrap:nowrap;& .euiFlexGroup{flex-wrap:nowrap;}"]),ka=l.a.div.withConfig({displayName:"ThreatTacticDescription",componentId:"sc-5ll1tb-4"})(["padding-left:",";"],(e=>e.theme.eui.euiSizeL)),Sa=({browserFields:e,data:t,detailsEcsData:n,id:a,indexName:s,isAlert:l,isDraggable:u,rawEventData:d,scopeId:p,timelineTabType:I,handleOnEventClosed:T,isReadOnly:C})=>{const[M,N]=Object(r.useState)(ya.summaryView),D=Object(r.useCallback)((e=>N(e.id)),[]),F=Object(r.useCallback)((()=>N(ya.tableView)),[]),A=Object(r.useMemo)((()=>t.reduce(((e,t)=>{if(Object(Ae.b)(t.field)){const n=_e(t.originalValue);if(n)return{...e,[t.field]:n}}return e}),{})),[t]),_=Object(r.useMemo)((()=>l?(e=>{const t=e.find((({field:e,originalValue:t})=>e===Te.yb&&t));if(!t)return[];const{originalValue:n}=t;return(Array.isArray(n)?n:[n]).reduce(((e,t)=>{try{const n=De(JSON.parse(t));e.push(n)}catch(e){}return e}),[])})(t).map((e=>(e=>e.reduce(((e,t)=>(e[t.field]=t.originalValue,e)),{}))(e))):[]),[t,l]),{result:R,loading:P,setRange:L,range:q}=(e=>{const{addError:t}=Object(vt.a)(),{data:n,uiSettings:a}=Object(S.k)().services,i=a.get(Te.eb),o=Object(O.useDispatch)(),[s,l]=Object(r.useState)({from:Fe.a,to:Fe.b}),{error:c,loading:u,result:d,start:p}=Object(pt.c)(ft),m=Object(r.useCallback)((()=>{o(Et.b.deleteOneQuery({inputId:ht.a.global,id:kt}))}),[o]);Object(r.useEffect)((()=>(!u&&d&&o(Et.b.setQuery({inputId:ht.a.global,id:kt,inspect:{dsl:d.inspect.dsl,response:[JSON.stringify(d.rawResponse,null,2)]},loading:u,refetch:St})),m)),[m,o,u,d]),Object(r.useEffect)((()=>{c&&t(c,{title:xt})}),[t,c]);const f=yt()(e),b=yt()(s);return Object(r.useEffect)((()=>{Object(g.isEmpty)(e)||Object(g.isEqual)(e,f)&&Object(g.isEqual)(s,b)||p({data:n,timerange:{...s,interval:""},defaultIndex:i,eventFields:e,filterQuery:""})}),[p,n,e,f,s,b,i]),{result:Object(g.isEmpty)(e)?wt:d,range:s,setRange:l,loading:u}})(A),B=Object(r.useMemo)((()=>Object(f.a)(d)),[d]),z=Object(r.useMemo)((()=>P||null==R||!R.enrichments?_:(e=>{if(e.length<2)return e;const t=Object(g.groupBy)(e,Be);return Object.values(t).map((e=>{var t;return null!==(t=e.find((e=>!Re(Pe(e,Fe.n)))))&&void 0!==t?t:e[0]}))})([..._,...R.enrichments])),[P,R,_]),$=z.length,{hostRisk:V,userRisk:U,isLicenseValid:H}=(e=>{const{hostName:t,userName:n}=Object(da.b)(e),a=Object(r.useMemo)((()=>t?Object(he.C)([t]):void 0),[t]),{data:i,loading:o,isLicenseValid:s,isModuleEnabled:l}=Object(pa.c)({filterQuery:a,pagination:ma,riskEntity:he.v.host,skip:!a}),c=Object(r.useMemo)((()=>({loading:o,isModuleEnabled:l,result:i})),[i,o,l]),u=Object(r.useMemo)((()=>n?Object(he.D)([n]):void 0),[n]),{data:d,loading:p,isLicenseValid:m,isModuleEnabled:g}=Object(pa.c)({filterQuery:u,pagination:ma,riskEntity:he.v.user,skip:!u});return{userRisk:Object(r.useMemo)((()=>({loading:p,isModuleEnabled:g,result:d})),[p,g,d]),hostRisk:c,isLicenseValid:s&&m}})(t),G=Object(r.useMemo)((()=>null!=n?Object(ga.a)({data:n,rowRenderers:ba.b}):null),[n]),Q=Object(r.useMemo)((()=>Object(y.c)(p)),[p]),W=Object(r.useMemo)((()=>$>0||H&&(V||U)),[$,V,H,U]),K=Object(r.useMemo)((()=>l?{id:ya.summaryView,name:w.p,"data-test-subj":"overviewTab",content:o.a.createElement(o.a.Fragment,null,o.a.createElement(i.EuiSpacer,{size:"m"}),o.a.createElement(_n,{browserFields:e,contextId:p,data:t,eventId:a,indexName:s,scopeId:p,handleOnEventClosed:T,isReadOnly:C}),o.a.createElement(i.EuiSpacer,{size:"l"}),o.a.createElement(xa,{direction:"column",wrap:!1,gutterSize:"none"},B&&B[0]&&o.a.createElement(o.a.Fragment,null,o.a.createElement(i.EuiTitle,{size:"xxs"},o.a.createElement("h5",null,B[0].title)),o.a.createElement(ka,null,B[0].description))),o.a.createElement(i.EuiSpacer,{size:"l"}),null!=G&&null!=n&&o.a.createElement("div",null,o.a.createElement(i.EuiTitle,{size:"xs"},o.a.createElement("h5",null,w.c)),o.a.createElement(i.EuiSpacer,{size:"s"}),o.a.createElement(Ea,{"data-test-subj":"renderer"},G.renderRow({contextId:"event-details",data:n,isDraggable:null!=u&&u,scopeId:p}))),o.a.createElement(i.EuiHorizontalRule,null),o.a.createElement(hn,{data:t,eventId:a,browserFields:e,isDraggable:u,scopeId:p,title:w.e,isReadOnly:C,goToTable:F}),o.a.createElement(i.EuiSpacer,{size:"xl"}),o.a.createElement(ua,{browserFields:e,eventId:a,data:t,scopeId:p,isReadOnly:C}),W&&o.a.createElement(nt,{isDraggable:u,hostRisk:V,userRisk:U,browserFields:e,data:t,eventId:a,scopeId:p,enrichments:z,isReadOnly:C}),P&&o.a.createElement(o.a.Fragment,null,o.a.createElement(i.EuiLoadingContent,{lines:2})),o.a.createElement(kn.b,{data:t}))}:void 0),[l,e,p,t,a,s,T,C,G,n,u,F,B,W,V,U,z,P]),J=Object(r.useMemo)((()=>l&&!C?{id:ya.threatIntelView,"data-test-subj":"threatIntelTab",name:o.a.createElement(i.EuiFlexGroup,{direction:"row",alignItems:"center",justifyContent:"spaceAround",gutterSize:"xs"},o.a.createElement(i.EuiFlexItem,null,o.a.createElement("span",null,w.t)),o.a.createElement(i.EuiFlexItem,null,P?o.a.createElement(i.EuiLoadingSpinner,null):o.a.createElement(i.EuiNotificationBadge,{"data-test-subj":"enrichment-count-notification"},$))),content:o.a.createElement(Rt,{loading:P,enrichments:z,showInvestigationTimeEnrichments:!Object(g.isEmpty)(A)},o.a.createElement(o.a.Fragment,null,o.a.createElement(xn,{setRange:L,loading:P,range:q}),o.a.createElement(i.EuiSpacer,{size:"m"})))}:void 0),[z,L,q,$,l,A,P,C]),X=Object(r.useMemo)((()=>({id:ya.tableView,"data-test-subj":"tableTab",name:w.s,content:o.a.createElement(o.a.Fragment,null,o.a.createElement(i.EuiSpacer,{size:"l"}),o.a.createElement(Y,{browserFields:e,data:t,eventId:a,isDraggable:u,scopeId:p,timelineTabType:I,isReadOnly:C}))})),[e,t,a,u,p,I,C]),ee=Object(r.useMemo)((()=>({id:ya.jsonView,"data-test-subj":"jsonViewTab",name:w.k,content:o.a.createElement(o.a.Fragment,null,o.a.createElement(i.EuiSpacer,{size:"m"}),o.a.createElement(va,{"data-test-subj":"jsonViewWrapper"},o.a.createElement(Z,{rawEventData:d})))})),[d]),te=(({rawEventData:e,ecsData:t})=>{var n,a,s,l,u,d,p,m,g,f;const{services:{osquery:b,application:y}}=Object(S.k)(),h=Object(c.a)("responseActionsEnabled"),O=Object(r.useMemo)((()=>o.a.createElement(i.EuiEmptyPrompt,{iconType:"logoOsquery",title:o.a.createElement("h2",null,E.b),titleSize:"xs",body:o.a.createElement(v.FormattedMessage,{id:"xpack.securitySolution.osquery.results.missingPrivileges",defaultMessage:"To access these results, ask your administrator for {osquery} Kibana privileges.",values:{osquery:o.a.createElement(i.EuiCode,null,"osquery")}})})),[]);if(!(b&&e&&h&&t))return;const{OsqueryResults:I}=b,T=Object(x.a)(e.fields),C=null===(n=T.kibana)||void 0===n||null===(a=n.alert)||void 0===a||null===(s=a.rule)||void 0===s?void 0:s.parameters,M=null==C?void 0:C[0].response_actions,N=null==M||null===(l=M.filter((e=>e.action_type_id===k.a.OSQUERY)))||void 0===l?void 0:l.length;if(!N)return;const D=null===(u=T.kibana)||void 0===u||null===(d=u.alert)||void 0===d||null===(p=d.rule)||void 0===p?void 0:p.name,F=null===(m=T.agent)||void 0===m?void 0:m.id,A=e._id;return{id:ya.osqueryView,"data-test-subj":"osqueryViewTab",name:o.a.createElement(i.EuiFlexGroup,{direction:"row",alignItems:"center",justifyContent:"spaceAround",gutterSize:"xs"},o.a.createElement(i.EuiFlexItem,null,o.a.createElement("span",null,w.o)),o.a.createElement(i.EuiFlexItem,null,o.a.createElement(i.EuiNotificationBadge,{"data-test-subj":"osquery-actions-notification"},N))),content:o.a.createElement(o.a.Fragment,null,o.a.createElement(j,{"data-test-subj":"osqueryViewWrapper"},null!=y&&null!==(g=y.capabilities)&&void 0!==g&&null!==(f=g.osquery)&&void 0!==f&&f.read?o.a.createElement(I,{agentIds:F,ruleName:D,alertId:A,ecsData:t}):O))}})({rawEventData:d,...null!==n?{ecsData:n}:{}}),ne=Object(r.useMemo)((()=>[K,J,X,ee,te].filter((e=>!!e))),[K,J,X,ee,te]),ae=Object(r.useMemo)((()=>{var e;return null!==(e=ne.find((e=>e.id===M)))&&void 0!==e?e:ne[0]}),[ne,M]),ie=Object(r.useMemo)((()=>Q?{"tour-step":Object(h.c)(3,h.b.alertsCases)}:{}),[Q]);return o.a.createElement(b.a,{isTourAnchor:Q,step:h.a.reviewAlertDetailsFlyout,tourId:h.b.alertsCases},o.a.createElement(ha,m()({},ie,{"data-test-subj":"eventDetails",tabs:ne,selectedTab:ae,onTabClick:D,key:"event-summary-tabs"})))};Sa.displayName="EventDetailsComponent";const wa=o.a.memo(Sa);var ja=n(645);const Oa=l()(i.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-v6xric-0"})(["flex:0 1 auto;",""],(({theme:e})=>`margin-top: ${e.eui.euiSizeS};`)),Ia=l()(i.EuiFlexGroup).withConfig({displayName:"StyledFlexGroup",componentId:"sc-v6xric-1"})(["height:100%;"]),Ta=l()(i.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-v6xric-2"})(["&.euiFlexItem{flex:1 0 0;overflow:hidden;}"]),Ca=o.a.memo((({eventId:e,isAlert:t,loading:n,handleOnEventClosed:r,ruleName:s,timestamp:l})=>{const p=Object(c.a)("alertDetailsPageEnabled"),{onClick:m}=Object(d.o)()({deepLinkId:Te.uc.alerts,path:e&&t?Object(u.b)(e):""});return o.a.createElement(Oa,{gutterSize:"none",justifyContent:"spaceBetween",wrap:!0},o.a.createElement(i.EuiFlexItem,{grow:!1},!n&&o.a.createElement(o.a.Fragment,null,o.a.createElement(i.EuiTitle,{size:"s"},o.a.createElement("h4",null,t&&!Object(a.isEmpty)(s)?s:ja.c)),l&&o.a.createElement(o.a.Fragment,null,o.a.createElement(i.EuiSpacer,{size:"s"}),o.a.createElement(Un.c,{value:new Date(l)})),t&&e&&p&&o.a.createElement(o.a.Fragment,null,o.a.createElement(i.EuiSpacer,{size:"l"}),o.a.createElement(d.k,{"data-test-subj":"open-alert-details-page",deepLinkId:Te.uc.alerts,onClick:m},ja.e),o.a.createElement(i.EuiSpacer,{size:"m"})))),r&&o.a.createElement(i.EuiFlexItem,{grow:!1},o.a.createElement(i.EuiButtonIcon,{iconType:"cross","aria-label":ja.b,onClick:r})))}));Ca.displayName="ExpandableEventTitle";const Ma=o.a.memo((({browserFields:e,event:t,scopeId:n,timelineTabType:a,isAlert:r,isDraggable:s,loading:l,detailsData:c,detailsEcsData:u,rawEventData:d,handleOnEventClosed:p,isReadOnly:m})=>t.eventId?l?o.a.createElement(i.EuiLoadingContent,{lines:10}):o.a.createElement(Ia,{direction:"column",gutterSize:"none"},o.a.createElement(Ta,{grow:!0},o.a.createElement(wa,{browserFields:e,data:null!=c?c:[],detailsEcsData:u,id:t.eventId,isAlert:r,indexName:t.indexName,isDraggable:s,rawEventData:d,scopeId:n,timelineTabType:a,handleOnEventClosed:p,isReadOnly:m}))):o.a.createElement(i.EuiTextColor,{color:"subdued"},ja.d)));Ma.displayName="ExpandableEvent"},,function(e,t,n){"use strict";n.d(t,"a",(function(){return Ie})),n.d(t,"b",(function(){return Me})),n.d(t,"c",(function(){return Re})),n.d(t,"e",(function(){return Ee})),n.d(t,"d",(function(){return _e})),n.d(t,"f",(function(){return Pe.a}));var a=n(82),i=n.n(a),r=n(4),o=n.n(r),s=n(32),l=n(33),c=n.n(l),u=n(0);const d=u.i18n.translate("xpack.securitySolution.artifactCard.lastUpdated",{defaultMessage:"Last updated"}),p=u.i18n.translate("xpack.securitySolution.artifactCard.created",{defaultMessage:"Created"}),m=u.i18n.translate("xpack.securitySolution.artifactCard.lastUpdatedBy",{defaultMessage:"Updated by"}),g=u.i18n.translate("xpack.securitySolution.artifactCard.createdBy",{defaultMessage:"Created by"}),f=u.i18n.translate("xpack.securitySolution.artifactCard.globalEffectScope",{defaultMessage:"Applied globally"}),b=(e=0)=>u.i18n.translate("xpack.securitySolution.artifactCard.policyEffectScope",{defaultMessage:"Applied to {count} {count, plural, one {policy} other {policies}}",values:{count:e}}),y=(e=0)=>u.i18n.translate("xpack.securitySolution.artifactCard.policyEffectScope.title",{defaultMessage:"Applied to the following {count, plural, one {policy} other {policies}}",values:{count:e}}),h=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.matchOperator",{defaultMessage:"IS"}),v=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.matchOperator.not",{defaultMessage:"IS NOT"}),E=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.wildcardMatchesOperator",{defaultMessage:"MATCHES"}),x=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.nestedOperator",{defaultMessage:"has"}),k=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.matchAnyOperator",{defaultMessage:"is one of"}),S=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.matchAnyOperator.not",{defaultMessage:"is not one of"}),w=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.existsOperator",{defaultMessage:"exists"}),j=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.listOperator",{defaultMessage:"included in"}),O=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.os",{defaultMessage:"OS"}),I=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.and",{defaultMessage:"AND"}),T=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.windows",{defaultMessage:"Windows"}),C=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.linux",{defaultMessage:"Linux"}),M=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.macos",{defaultMessage:"Mac"}),N=u.i18n.translate("xpack.securitySolution.artifactExpandableCard.expand",{defaultMessage:"Expand"}),D=u.i18n.translate("xpack.securitySolution.artifactExpandableCard.collpase",{defaultMessage:"Collapse"}),F=u.i18n.translate("xpack.securitySolution.artifactMinifiedCard.descriptionLabel",{defaultMessage:"Description"});var A=n(101),_=n(47),R=n.n(_),P=n(87);const L=Object(r.memo)((({bold:e,truncate:t,size:n="s",withTooltip:a=!1,"data-test-subj":i,children:l})=>{const c=Object(r.useMemo)((()=>R()({"eui-textTruncate":t,"eui-textBreakWord":!0})),[t]),u=Object(r.useMemo)((()=>e?o.a.createElement("strong",null,l):l),[e,l]);return o.a.createElement(s.EuiText,{className:c,size:n,"data-test-subj":i},a&&"string"==typeof l&&l.length>0&&l!==Object(P.e)()?o.a.createElement(s.EuiToolTip,{anchorClassName:c,content:l,position:"top"},o.a.createElement(o.a.Fragment,null,u)):u)}));L.displayName="TextValueDisplay";var q=n(91);const B=c()(s.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-14lo602-0"})(["padding-top:2px;"]),z=Object(r.memo)((({date:e,type:t,"data-test-subj":n})=>{const a=Object(q.a)(n);return o.a.createElement(s.EuiFlexGroup,{responsive:!1,alignItems:"flexStart",gutterSize:"m","data-test-subj":n},o.a.createElement(B,{grow:!1},o.a.createElement(s.EuiIcon,{type:"calendar"})),o.a.createElement(s.EuiFlexItem,{grow:!0},o.a.createElement(s.EuiFlexGroup,{responsive:!1,direction:"column",alignItems:"flexStart",gutterSize:"xs"},o.a.createElement(s.EuiFlexItem,{className:"eui-textTruncate","data-test-subj":a("label")},o.a.createElement(L,null,"update"===t?d:p)),o.a.createElement(s.EuiFlexItem,{className:"eui-textTruncate","data-test-subj":a("value")},o.a.createElement(L,{bold:!0},o.a.createElement(A.b,{value:e,dateFormat:"M/D/YYYY"}))))))}));z.displayName="DateField";var $=n(117),V=n.n($),U=n(393);const H=Object(r.memo)((({items:e,button:t,panelPaddingSize:n,anchorPosition:a,maxWidth:l="32ch",maxHeight:c="255px",fixedWidth:u=!1,title:d,loading:p=!1,hoverInfo:m,...g})=>{const f=Object(q.a)(g["data-test-subj"]),[b,y]=Object(r.useState)(!1),h=Object(r.useCallback)((()=>y(!1)),[y]),v=Object(r.useCallback)((()=>y(!b)),[b]),E=Object(r.useMemo)((()=>({"data-test-subj":f("popoverPanel")})),[f]),x=Object(r.useMemo)((()=>e.map(((e,t)=>{var n,a;return p?o.a.createElement(s.EuiLoadingContent,{lines:1,key:V.a.v4(),"data-test-subj":null!==(a=e["data-test-subj"])&&void 0!==a?a:f(`item-loading-${t}`)}):o.a.createElement(U.a,i()({},e,{key:V.a.v4(),"data-test-subj":null!==(n=e["data-test-subj"])&&void 0!==n?n:f(`item-${t}`),textTruncate:Boolean(l)||e.textTruncate,hoverInfo:m,onClick:t=>{if(h(),e.onClick)return e.onClick(t)}}))}))),[f,h,e,l,p,m]),k=Object(r.useMemo)((()=>{const e={className:"eui-yScroll",style:{}};return l&&!u&&(e.style.maxWidth=l),c&&(e.style.maxHeight=c),u&&(e.style.width=null!=l?l:"32ch"),e}),[l,u,c]);return o.a.createElement(s.EuiPopover,i()({},g,{anchorPosition:a,panelPaddingSize:n,panelProps:E,button:o.a.createElement("div",{className:"eui-displayInlineBlock","data-test-subj":f("triggerButtonWrapper"),onClick:v},t),isOpen:b,closePopover:h}),d?o.a.createElement(s.EuiPopoverTitle,{paddingSize:"m"},d):null,o.a.createElement(s.EuiContextMenuPanel,i()({},k,{items:x})))}));H.displayName="ContextMenuWithRouterSupport";const G=Object(r.memo)((({items:e,"data-test-subj":t,icon:n="boxesHorizontal"})=>{const a=Object(q.a)(t),[l,c]=Object(r.useState)(!1),d=Object(r.useCallback)((()=>c(!1)),[c]),p=Object(r.useCallback)((()=>c(!l)),[l]),m=Object(r.useMemo)((()=>({"data-test-subj":a("popoverPanel")})),[a]),g=Object(r.useMemo)((()=>e.map((e=>o.a.createElement(U.a,i()({},e,{key:V.a.v4(),onClick:t=>{if(d(),e.onClick)return e.onClick(t)}}))))),[d,e]);return o.a.createElement(s.EuiPopover,{anchorPosition:"downRight",panelPaddingSize:"none",panelProps:m,"data-test-subj":t,button:o.a.createElement(s.EuiButtonIcon,{"data-test-subj":a("button"),iconType:n,onClick:p,"aria-label":u.i18n.translate("xpack.securitySolution.actionsContextMenu.label",{defaultMessage:"Open"})}),isOpen:l,closePopover:d},o.a.createElement(s.EuiContextMenuPanel,{items:g,"data-test-subj":a("contextMenuPanel")}))}));G.displayName="ActionsContextMenu";const Q=Object(r.memo)((({actions:e,"data-test-subj":t})=>e&&e.length>0?o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(G,{items:e,icon:"boxesHorizontal","data-test-subj":t})):null));Q.displayName="CardActionsFlexItem";const W=c()(s.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItemSmallBottomMargin",componentId:"sc-k6t7b4-0"})(["margin-bottom:4px !important;"]),K=Object(r.memo)((({name:e,createdDate:t,updatedDate:n,actions:a,"data-test-subj":i})=>{const r=Object(q.a)(i);return o.a.createElement(s.EuiFlexGroup,{responsive:!1,alignItems:"flexStart","data-test-subj":i},o.a.createElement(W,{grow:!0},o.a.createElement(s.EuiFlexGroup,{alignItems:"flexStart"},o.a.createElement(s.EuiFlexItem,{grow:!0},o.a.createElement(s.EuiTitle,{size:"s"},o.a.createElement("h3",{"data-test-subj":r("title")},e))),o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiFlexGroup,{responsive:!1,gutterSize:"xl"},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(z,{date:n,type:"update","data-test-subj":r("updated")})),o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(z,{date:t,type:"create","data-test-subj":r("created")})))))),o.a.createElement(Q,{actions:a,"data-test-subj":r("actions")}))}));K.displayName="CardHeader";const Y=c()(s.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-ylzny6-0"})(["margin:6px;"]),J=Object(r.memo)((({createdBy:e,updatedBy:t,"data-test-subj":n})=>{const a=Object(q.a)(n);return o.a.createElement(s.EuiFlexGroup,{alignItems:"center",gutterSize:"l",responsive:!1,"data-test-subj":n},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(X,{label:g,value:e,"data-test-subj":a("createdBy")})),o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(X,{label:m,value:t,"data-test-subj":a("updatedBy")})))}));J.displayName="TouchedByUsers";const X=Object(r.memo)((({label:e,value:t,"data-test-subj":n})=>{const a=Object(q.a)(n);return o.a.createElement(s.EuiFlexGroup,{alignItems:"center",gutterSize:"m",wrap:!1,responsive:!1,"data-test-subj":n},o.a.createElement(Y,{grow:!1},o.a.createElement(s.EuiBadge,{"data-test-subj":a("label")},e)),o.a.createElement(Y,{grow:!1},o.a.createElement(s.EuiFlexGroup,{responsive:!1,gutterSize:"s",alignItems:"center",wrap:!1},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiAvatar,{name:t,size:"s","data-test-subj":a("avatar")})),o.a.createElement(s.EuiFlexItem,{grow:!1,className:"eui-textTruncate","data-test-subj":a("value")},o.a.createElement(L,null,t)))))}));X.displayName="UserName";var Z=n(35);const ee=c()("div").withConfig({displayName:"StyledWithContextMenuShiftedWrapper",componentId:"sc-rwna0x-0"})(["margin-left:-10px;"]),te=c()(s.EuiButtonEmpty).withConfig({displayName:"StyledEuiButtonEmpty",componentId:"sc-rwna0x-1"})(["height:10px !important;"]),ne=Object(r.memo)((({policies:e,loadingPoliciesList:t=!1,"data-test-subj":n})=>{const a=Object(q.a)(n),[i,l]=Object(r.useMemo)((()=>e?["partial",b(e.length)]:["globe",f]),[e]),c=o.a.createElement(s.EuiFlexGroup,{responsive:!1,wrap:!1,alignItems:"center",gutterSize:"s","data-test-subj":n},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiIcon,{type:i,size:"s"})),o.a.createElement(s.EuiFlexItem,{grow:!1,"data-test-subj":a("value")},o.a.createElement(L,{size:"xs"},l)));return e&&e.length?o.a.createElement(ee,null,o.a.createElement(ae,{policies:e,loadingPoliciesList:t,"data-test-subj":a("popupMenu")},c)):c}));ne.displayName="EffectScope";const ae=Object(r.memo)((({policies:e,loadingPoliciesList:t=!1,children:n,"data-test-subj":a})=>{const i=Object(q.a)(a),l=Object(r.useMemo)((()=>o.a.createElement(te,{flush:"right",size:"s",iconSide:"right",iconType:"popout"},o.a.createElement(Z.FormattedMessage,{id:"xpack.securitySolution.contextMenuItemByRouter.viewDetails",defaultMessage:"View details"}))),[]);return o.a.createElement(H,{maxHeight:"235px",fixedWidth:!0,panelPaddingSize:"none",items:e,anchorPosition:e.length>1?"rightCenter":"rightUp","data-test-subj":a,loading:t,hoverInfo:l,button:o.a.createElement(s.EuiButtonEmpty,{size:"xs","data-test-subj":i("button")},n),title:y(e.length)})}));ae.displayName="WithContextMenu";const ie=Object(r.memo)((({createdBy:e,updatedBy:t,policies:n,loadingPoliciesList:a=!1,"data-test-subj":i})=>{const r=Object(q.a)(i);return o.a.createElement(s.EuiFlexGroup,{alignItems:"center",responsive:!0,"data-test-subj":i},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(J,{createdBy:e,updatedBy:t,"data-test-subj":r("touchedBy")})),o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(ne,{policies:n,loadingPoliciesList:a,"data-test-subj":r("effectScope")})))}));ie.displayName="CardSubHeader";var re=n(93);const oe=Object.freeze({linux:C,mac:M,macos:M,windows:T}),se=Object.freeze({[re.d.NESTED]:x,[re.d.MATCH_ANY]:k,[re.d.MATCH]:h,[re.d.WILDCARD]:E,[re.d.EXISTS]:w,[re.d.LIST]:j}),le=Object.freeze({[re.d.MATCH_ANY]:S,[re.d.MATCH]:v}),ce=c()(s.EuiFlexGroup).withConfig({displayName:"EuiFlexGroupNested",componentId:"sc-145kt5g-0"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeXL)),ue=c()(s.EuiFlexItem).withConfig({displayName:"EuiFlexItemNested",componentId:"sc-145kt5g-1"})(["margin-bottom:6px !important;margin-top:6px !important;"]),de=c()("span").withConfig({displayName:"StyledCondition",componentId:"sc-145kt5g-2"})(["margin-right:6px;"]),pe=Object(r.memo)((({os:e,entries:t,"data-test-subj":n})=>{const a=Object(q.a)(n),i=Object(r.useMemo)((()=>e.map((e=>{var t;return null!==(t=oe[e])&&void 0!==t?t:e})).join(", ")),[e]),l=(e,t)=>"match_any"===e&&Array.isArray(t)?t.map((e=>o.a.createElement(s.EuiBadge,{color:"hollow"},e))):t,c=(e,t)=>{var n,a;return"nested"===e?"":"included"===t?null!==(n=se[e])&&void 0!==n?n:e:null!==(a=le[e])&&void 0!==a?a:e},u=Object(r.useCallback)(((e,t)=>{if("nested"===e&&t.length)return t.map((({field:e,type:t,value:n,operator:i})=>o.a.createElement(ce,{"data-test-subj":a("nestedCondition"),key:e+t+n,direction:"row",alignItems:"center",gutterSize:"m",responsive:!1},o.a.createElement(ue,{grow:!1},o.a.createElement(s.EuiToken,{iconType:"tokenNested",size:"s"})),o.a.createElement(ue,{grow:!1},o.a.createElement(s.EuiExpression,{description:"",value:e,color:"subdued"})),o.a.createElement(ue,{grow:!1},o.a.createElement(s.EuiExpression,{description:c(t,i),value:l(t,n)})))))}),[a]);return o.a.createElement("div",{"data-test-subj":n},o.a.createElement("div",{"data-test-subj":a("os")},o.a.createElement("strong",null,o.a.createElement(s.EuiExpression,{description:"",value:O}),o.a.createElement(s.EuiExpression,{description:h,value:i}))),t.map((({field:e,type:t,value:n,operator:i,entries:r=[]})=>o.a.createElement("div",{"data-test-subj":a("condition"),key:e+t+n},o.a.createElement("div",{className:"eui-xScroll"},o.a.createElement(s.EuiExpression,{description:o.a.createElement(de,null,I),value:e,color:"subdued"}),o.a.createElement(s.EuiExpression,{description:c(t,i),value:l(t,n)})),u(t,r)))))}));pe.displayName="CriteriaConditions";const me=e=>"effectScope"in e;var ge=n(139);const fe=e=>(e=>{const t=e.filter((e=>e.startsWith(ge.b)));return t.some((e=>e===`${ge.b}all`))?{type:"global"}:{type:"policy",policies:t.map((e=>e.substr(ge.b.length)))}})(e.tags),be=e=>Object(r.useMemo)((()=>(e=>{var t;const n=e,{name:a,created_by:i,created_at:r,updated_at:o,updated_by:s,description:l="",entries:c}=n;return{name:a,created_by:i,created_at:r,updated_at:o,updated_by:s,description:l,comments:me(n)?[]:n.comments,entries:c,os:me(n)?[n.os]:null!==(t=n.os_types)&&void 0!==t?t:[],effectScope:me(n)?n.effectScope:fe(n)}})(e)),[e]),ye=c()(s.EuiPanel).withConfig({displayName:"EuiPanelStyled",componentId:"sc-13mspil-0"})(["&.artifactEntryCard + &.artifactEntryCard{margin-top:",";}"],(({theme:e})=>e.eui.euiSizeL)),he=Object(r.memo)((({className:e,...t})=>o.a.createElement(ye,i()({},t,{hasBorder:!0,paddingSize:"none",className:`artifactEntryCard ${null!=e?e:""}`}))));he.displayName="CardContainerPanel";const ve=c()(s.EuiPanel).withConfig({displayName:"StyledEuiPanel",componentId:"sc-1cjqxs3-0"})(["padding:32px;&.top-section{padding-bottom:24px;}&.bottom-section{padding-top:24px;}&.artifact-entry-collapsible-card{padding:24px !important;}"]),Ee=Object(r.memo)((e=>o.a.createElement(ve,i()({},e,{hasBorder:!1,hasShadow:!1,paddingSize:"l"}))));Ee.displayName="CardSectionPanel";var xe=n(34),ke=n(361);const Se=c()(s.EuiAvatar).withConfig({displayName:"CustomEuiAvatar",componentId:"sc-1xphza0-0"})(["background-color:"," !important;"],(({theme:e})=>e.eui.euiColorLightShade)),we=Object(r.memo)((({comments:e,"data-test-subj":t})=>{const n=Object(q.a)(t),[a,i]=Object(r.useState)(!1),l=Object(r.useCallback)((()=>{i(!a)}),[i,a]),c=Object(r.useMemo)((()=>(e=>e.map((e=>({username:e.created_by,timestamp:o.a.createElement(A.b,{value:e.created_at,dateFormat:"MMM D, YYYY"}),event:ke.b,timelineAvatar:o.a.createElement(Se,{size:"s",name:e.created_by}),children:o.a.createElement(s.EuiText,{size:"s"},e.comment)}))))(e)),[e]),d=Object(r.useMemo)((()=>a?((e=0)=>u.i18n.translate("xpack.securitySolution.artifactCard.comments.label.hide",{defaultMessage:"Hide comments ({count})",values:{count:e}}))(e.length):((e=0)=>u.i18n.translate("xpack.securitySolution.artifactCard.comments.label.show",{defaultMessage:"Show comments ({count})",values:{count:e}}))(e.length)),[e.length,a]);return Object(xe.isEmpty)(e)?null:o.a.createElement("div",{"data-test-subj":t},o.a.createElement(s.EuiSpacer,{size:"s"}),o.a.createElement(s.EuiButtonEmpty,{onClick:l,flush:"left",size:"xs","data-test-subj":n("label")},d),o.a.createElement(s.EuiAccordion,{id:"1",arrowDisplay:"none",forceState:a?"open":"closed"},o.a.createElement(s.EuiSpacer,{size:"m"}),o.a.createElement(s.EuiCommentList,{comments:c,"data-test-subj":n("list")})))}));we.displayName="CardComments";const je=(e,t)=>Object(r.useMemo)((()=>"policy"===e.effectScope.type?null==e?void 0:e.effectScope.policies.map((e=>t&&t[e]?t[e]:{children:e})):void 0),[e.effectScope,t]),Oe=Object(r.memo)((({truncate:e,children:t,"data-test-subj":n,withTooltip:a})=>o.a.createElement(L,{size:"m",truncate:e,"data-test-subj":n,withTooltip:a},t||Object(P.e)())));Oe.displayName="ArtifactDescription";const Ie=Object(r.memo)((({item:e,policies:t,loadingPoliciesList:n=!1,actions:a,hideDescription:r=!1,hideComments:l=!1,"data-test-subj":c,...u})=>{const d=be(e),p=Object(q.a)(c),m=je(d,t);return o.a.createElement(he,i()({},u,{"data-test-subj":c}),o.a.createElement(Ee,{className:"top-section"},o.a.createElement(K,{name:d.name,createdDate:d.created_at,updatedDate:d.updated_at,actions:a,"data-test-subj":p("header")}),o.a.createElement(ie,{createdBy:d.created_by,updatedBy:d.updated_by,policies:m,loadingPoliciesList:n,"data-test-subj":p("subHeader")}),!r&&o.a.createElement(o.a.Fragment,null,o.a.createElement(s.EuiSpacer,{size:"l"}),o.a.createElement(Oe,{"data-test-subj":p("description")},d.description)),l?null:o.a.createElement(o.a.Fragment,null,r&&o.a.createElement(s.EuiSpacer,{size:"l"}),o.a.createElement(we,{comments:d.comments,"data-test-subj":p("comments")}))),o.a.createElement(s.EuiHorizontalRule,{margin:"none"}),o.a.createElement(Ee,{className:"bottom-section"},o.a.createElement(pe,{os:d.os,entries:d.entries,"data-test-subj":p("criteriaConditions")})))}));Ie.displayName="ArtifactEntryCard";const Te=c()(s.EuiSplitPanel.Outer).withConfig({displayName:"CardContainerPanel",componentId:"sc-khxq0i-0"})(["&.artifactEntryCardMinified + &.artifactEntryCardMinified{margin-top:",";}"],(({theme:e})=>e.eui.euiSizeL)),Ce=c()(s.EuiSplitPanel.Inner).withConfig({displayName:"CustomSplitInnerPanel",componentId:"sc-khxq0i-1"})(["background-color:"," !important;"],(({theme:e})=>e.eui.euiColorLightestShade)),Me=Object(r.memo)((({item:e,isSelected:t=!1,onToggleSelectedArtifact:n,"data-test-subj":a,...l})=>{var c;const u=be(e),d=Object(q.a)(a),[p,m]=Object(r.useState)("closed"),g=Object(r.useCallback)((()=>{m((e=>"closed"===e?"open":"closed"))}),[]),f=Object(r.useCallback)((()=>"open"===p?"Hide details":"Show details"),[p]),b=Object(r.useMemo)((()=>o.a.createElement(Ce,null,o.a.createElement(s.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiCheckbox,{id:u.name,"data-test-subj":`${u.name}_checkbox`,checked:t,onChange:()=>n(!t)})),o.a.createElement(s.EuiFlexItem,null,o.a.createElement(s.EuiTitle,{size:"xxs"},o.a.createElement("h5",{"data-test-subj":d("title")},u.name)))))),[u.name,d,t,n]);return o.a.createElement(Te,i()({},l,{"data-test-subj":a,className:`${null!==(c=l.className)&&void 0!==c?c:""}  artifactEntryCardMinified`,id:u.name,hasShadow:!1,hasBorder:!0}),b,o.a.createElement(s.EuiSplitPanel.Inner,{paddingSize:"s"},o.a.createElement(s.EuiPanel,{hasBorder:!1,hasShadow:!1,paddingSize:"s"},o.a.createElement(s.EuiTitle,{size:"xxs"},o.a.createElement("h5",{"data-test-subj":d("descriptionTitle")},F)),o.a.createElement(Oe,{"data-test-subj":d("description")},u.description)),o.a.createElement(s.EuiPanel,{hasBorder:!1,hasShadow:!1,paddingSize:"s"},o.a.createElement(s.EuiButtonEmpty,{"data-test-subj":d("collapse"),color:"primary",size:"s",flush:"left",iconType:"open"===p?"arrowUp":"arrowDown",iconSide:"right",iconSize:"m",onClick:g,style:{fontWeight:400}},f()),o.a.createElement(s.EuiAccordion,{id:"showDetails",arrowDisplay:"none",forceState:p},o.a.createElement(pe,{os:u.os,entries:u.entries,"data-test-subj":d("criteriaConditions")})))))}));Me.displayName="ArtifactEntryCardMinified";const Ne=Object(r.memo)((({expanded:e,onClick:t,"data-test-subj":n})=>o.a.createElement(s.EuiButtonIcon,{iconType:e?"arrowUp":"arrowDown",onClick:t,"data-test-subj":n,"aria-label":e?D:N})));Ne.displayName="CardExpandButton";const De=Object(r.memo)((({artifact:e,onExpandCollapse:t,policies:n,actions:a,expanded:i=!1,"data-test-subj":s})=>{const l=Object(q.a)(s),c=je(e,n),u=Object(r.useCallback)((()=>{t()}),[t]);return o.a.createElement(_e,{"data-test-subj":s,expanded:i,expandToggle:o.a.createElement(Ne,{expanded:i,onClick:u,"data-test-subj":l("expandCollapse")}),name:o.a.createElement(L,{bold:!0,truncate:!i,withTooltip:!i},e.name),description:o.a.createElement(Oe,{truncate:!i,withTooltip:!i},e.description),effectScope:o.a.createElement(ne,{policies:c,"data-test-subj":l("effectScope")}),actionMenu:o.a.createElement(Q,{actions:a,"data-test-subj":l("actions")})})}));De.displayName="CardCompressedHeader";const Fe=c.a.div.withConfig({displayName:"ButtonIconPlaceHolder",componentId:"sc-17lokoz-0"})(["display:inline-block;width:",";height:",";"],(({theme:e})=>e.eui.euiSizeL),(({theme:e})=>e.eui.euiSizeL)),Ae=c()(s.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-17lokoz-1"})(["&.flushTop,.flushTop{padding-top:0;margin-top:0;}"]),_e=Object(r.memo)((({expanded:e,name:t,expandToggle:n,effectScope:a,actionMenu:i,description:l,"data-test-subj":c,flushTop:u})=>{const d=Object(q.a)(c),p=(e=>Object(r.useMemo)((()=>R()({"eui-textTruncate":!e})),[e]))(e),m=u?" flushTop":"";return o.a.createElement(Ae,{responsive:!1,alignItems:"center","data-test-subj":c,className:m},o.a.createElement(s.EuiFlexItem,{grow:!1,className:m,"data-test-subj":d("expandCollapseHolder")},n),o.a.createElement(s.EuiFlexItem,{className:p+m},o.a.createElement(s.EuiFlexGroup,{alignItems:"center",className:m},o.a.createElement(s.EuiFlexItem,{grow:2,className:p+m,"data-test-subj":d("titleHolder")},t),o.a.createElement(s.EuiFlexItem,{grow:3,className:p+m,"data-test-subj":d("descriptionHolder")},l),o.a.createElement(s.EuiFlexItem,{grow:1,"data-test-subj":d("effectScopeHolder"),className:m},a))),!0===i?o.a.createElement(s.EuiFlexItem,{grow:!1,"data-test-subj":d("cardActionsPlaceholder"),className:m},o.a.createElement(Fe,null)):i)}));_e.displayName="CardCompressedHeaderLayout";const Re=Object(r.memo)((({item:e,onExpandCollapse:t,policies:n,actions:a,expanded:r=!1,"data-test-subj":l,...c})=>{const u=be(e),d=Object(q.a)(l);return o.a.createElement(he,i()({},c,{"data-test-subj":l}),o.a.createElement(Ee,{className:"artifact-entry-collapsible-card"},o.a.createElement(De,{artifact:u,actions:a,policies:n,expanded:r,onExpandCollapse:t,"data-test-subj":d("header")})),r&&o.a.createElement(o.a.Fragment,null,o.a.createElement(s.EuiHorizontalRule,{margin:"xs"}),o.a.createElement(Ee,null,o.a.createElement(pe,{os:u.os,entries:u.entries,"data-test-subj":d("criteriaConditions")}))))}));Re.displayName="ArtifactEntryCollapsibleCard";var Pe=n(575)},function(e,t,n){"use strict";n.d(t,"a",(function(){return Me}));var a=n(4),i=n.n(a),r=n(78),o=n(32),s=n(99),l=n(86),c=n(112),u=n(79),d=n(81),p=n(92),m=n.n(p),g=n(501),f=n(590),b=n(646),y=n(900),h=n(352),v=n(358),E=n(246),x=n(700);const k=({browserFields:e,entityType:t="events",expandedEvent:n,handleOnEventClosed:r,isDraggable:s,isFlyoutView:l,runtimeMappings:c,tabType:u,scopeId:d,isReadOnly:p})=>{var m,k;const S=Object(v.a)(),{indexName:w}=n,j=null!==(m=Object(h.a)(w,S))&&void 0!==m?m:w,[O,I,T,C,M]=Object(f.a)({entityType:t,indexName:null!=j?j:"",eventId:null!==(k=n.eventId)&&void 0!==k?k:"",runtimeMappings:c,skip:!n.eventId}),{isolateAction:N,isHostIsolationPanelOpen:D,isIsolateActionSuccessBannerVisible:F,handleIsolationActionSuccess:A,showAlertDetails:_,showHostIsolationPanel:R}=Object(b.a)(),{alertId:P,isAlert:L,hostName:q,ruleName:B,timestamp:z}=Object(h.b)(I),$=Object(a.useMemo)((()=>l||D?i.a.createElement(y.c,{eventId:n.eventId,isHostIsolationPanelOpen:D,isAlert:L,isolateAction:N,loading:O,ruleName:B,showAlertDetails:_,timestamp:z}):i.a.createElement(g.b,{eventId:n.eventId,isAlert:L,loading:O,ruleName:B,handleOnEventClosed:r})),[n.eventId,r,L,l,D,N,O,B,_,z]),V=Object(a.useMemo)((()=>l?i.a.createElement(y.a,{alertId:P,browserFields:e,detailsData:I,detailsEcsData:C,event:n,hostName:q,handleIsolationActionSuccess:A,handleOnEventClosed:r,isAlert:L,isDraggable:s,isolateAction:N,isIsolateActionSuccessBannerVisible:F,isHostIsolationPanelOpen:D,loading:O,rawEventData:T,showAlertDetails:_,scopeId:d,isReadOnly:p}):D?i.a.createElement(i.a.Fragment,null,F&&i.a.createElement(E.d,{hostName:q,alertId:P,isolateAction:N}),i.a.createElement(o.EuiFlyoutBody,null,i.a.createElement(x.a,{details:I,cancelCallback:_,successCallback:A,isolateAction:N}))):i.a.createElement(i.a.Fragment,null,i.a.createElement(o.EuiSpacer,{size:"m"}),i.a.createElement(g.a,{browserFields:e,detailsData:I,detailsEcsData:C,event:n,isAlert:L,isDraggable:s,loading:O,rawEventData:T,scopeId:d,timelineTabType:u,handleOnEventClosed:r}))),[P,e,I,C,n,A,r,q,L,s,l,D,F,p,N,O,T,_,u,d]);return null!=n&&n.eventId?i.a.createElement(i.a.Fragment,null,$,V,i.a.createElement(y.b,{detailsData:I,detailsEcsData:C,expandedEvent:n,refetchFlyoutData:M,handleOnEventClosed:r,isHostIsolationPanelOpen:D,isReadOnly:p,loadingEventDetails:O,onAddIsolationStatusClick:R,scopeId:d})):null},S=i.a.memo(k,((e,t)=>m()(e.browserFields,t.browserFields)&&m()(e.expandedEvent,t.expandedEvent)&&e.scopeId===t.scopeId&&e.isDraggable===t.isDraggable));var w=n(0),j=n(33),O=n.n(j),I=n(90),T=n(89),C=n(114),M=n(94),N=n(910),D=n(143),F=n(538),A=n(892),_=n(319),R=n(920);const P=O.a.h4.withConfig({displayName:"StyledTitle",componentId:"sc-18s5s5o-0"})(["word-break:break-all;word-wrap:break-word;white-space:pre-wrap;"]),L=({hostName:e})=>i.a.createElement(o.EuiTitle,{size:"s"},i.a.createElement(P,null,w.i18n.translate("xpack.securitySolution.timeline.sidePanel.hostDetails.title",{defaultMessage:"Host details"}),`: ${e}`)),q=({hostName:e})=>i.a.createElement(T.d,{hostName:e,isButton:!0},w.i18n.translate("xpack.securitySolution.timeline.sidePanel.hostDetails.hostDetailsPageLink",{defaultMessage:"View details page"})),B=({contextID:e,hostName:t,isDraggable:n=!1})=>{const{to:o,from:s,isInitializing:l}=Object(C.a)(),{selectedPatterns:c}=Object(M.d)(),u=Object(r.useDispatch)(),[d,{hostDetails:p}]=Object(R.b)({endDate:o,hostName:t,indexNames:c,startDate:s}),m=Object(a.useCallback)(((e,t)=>{const n=Object(_.a)(e,t);u(Object(D.setAbsoluteRangeDatePicker)({id:I.a.global,from:n.from,to:n.to}))}),[u]);return i.a.createElement(F.a,{criteriaFields:Object(A.a)(p),startDate:s,endDate:o,skip:l},(({isLoadingAnomaliesData:a,anomaliesData:r})=>i.a.createElement(N.a,{contextID:e,id:R.a,isInDetailsSidePanel:!0,data:p,anomaliesData:r,isDraggable:n,isLoadingAnomaliesData:a,indexNames:c,loading:d,startDate:s,endDate:o,narrowDateRange:m,hostName:t})))},z=O()(o.EuiFlyoutBody).withConfig({displayName:"StyledEuiFlyoutBody",componentId:"sc-hctd1a-0"})([".euiFlyoutBody__overflow{display:flex;flex:1;overflow:hidden;.euiFlyoutBody__overflowContent{flex:1;overflow-x:hidden;overflow-y:scroll;margin-bottom:64px;padding:",";}}"],(({theme:e})=>`${e.eui.euiSizeXS} ${e.eui.euiSizeM} 0px`)),$=O()(o.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-hctd1a-1"})(["flex:1 0 auto;"]),V=O()(o.EuiFlexItem).withConfig({displayName:"StyledEuiFlexButtonWrapper",componentId:"sc-hctd1a-2"})(["align-self:flex-start;flex:1 0 auto;"]),U=O.a.div.withConfig({displayName:"StyledPanelContent",componentId:"sc-hctd1a-3"})(["display:block;height:100%;overflow-y:scroll;overflow-x:hidden;"]),H=i.a.memo((({contextID:e,expandedHost:t,handleOnHostClosed:n,isDraggable:a,isFlyoutView:r})=>{const{hostName:s}=t;return s?r?i.a.createElement(i.a.Fragment,null,i.a.createElement(o.EuiFlyoutHeader,{hasBorder:!0},i.a.createElement(L,{hostName:s})),i.a.createElement(z,null,i.a.createElement(o.EuiSpacer,{size:"m"}),i.a.createElement(q,{hostName:s}),i.a.createElement(o.EuiSpacer,{size:"m"}),i.a.createElement(B,{contextID:e,hostName:s}))):i.a.createElement(i.a.Fragment,null,i.a.createElement($,{justifyContent:"spaceBetween",wrap:!1},i.a.createElement(o.EuiFlexItem,{grow:!1},i.a.createElement(L,{hostName:s})),i.a.createElement(o.EuiFlexItem,{grow:!1},i.a.createElement(o.EuiButtonIcon,{iconType:"cross","aria-label":w.i18n.translate("xpack.securitySolution.timeline.sidePanel.hostDetails.close",{defaultMessage:"close"}),onClick:n}))),i.a.createElement(o.EuiSpacer,{size:"m"}),i.a.createElement(V,{grow:!1},i.a.createElement(q,{hostName:s})),i.a.createElement(o.EuiSpacer,{size:"m"}),i.a.createElement(U,null,i.a.createElement(B,{contextID:e,hostName:s,isDraggable:a}))):null}));var G=n(42),Q=n(233),W=n(626),K=n(625),Y=n(77),J=n(146),X=n(98),Z=n(713),ee=n(111),te=n(325),ne=n(716),ae=n(248);const ie=O.a.h4.withConfig({displayName:"StyledTitle",componentId:"sc-rlvmr5-0"})(["word-break:break-all;word-wrap:break-word;white-space:pre-wrap;"]),re=({ip:e})=>i.a.createElement(o.EuiTitle,{size:"s"},i.a.createElement(ie,null,w.i18n.translate("xpack.securitySolution.timeline.sidePanel.networkDetails.title",{defaultMessage:"Network details"}),`: ${e}`)),oe=({expandedNetwork:{ip:e,flowTarget:t}})=>i.a.createElement(T.h,{ip:e,flowTarget:t,isButton:!0},w.i18n.translate("xpack.securitySolution.timeline.sidePanel.networkDetails.networkDetailsPageLink",{defaultMessage:"View details page"})),se=({contextID:e,expandedNetwork:t,isDraggable:n})=>{const{ip:o,flowTarget:s}=t,l=Object(r.useDispatch)(),{to:c,from:u,isInitializing:p}=Object(C.a)(),m=Object(a.useMemo)((()=>X.d.globalQuerySelector()),[]),g=Object(a.useMemo)((()=>X.d.globalFiltersQuerySelector()),[]),f=Object(d.a)(m),b=Object(d.a)(g),y=ee.c.NetworkType.details,h=Object(a.useCallback)(((e,t)=>{const n=Object(_.a)(e,t);l(Object(D.setAbsoluteRangeDatePicker)({id:I.a.global,from:n.from,to:n.to}))}),[l]),{services:{uiSettings:v}}=Object(Y.k)(),{indicesExist:E,indexPattern:x,selectedPatterns:k}=Object(M.d)(),[S,w]=Object(J.c)({config:Object(G.getEsQueryConfig)(v),indexPattern:x,queries:[f],filters:b}),[j,{id:O,networkDetails:T}]=Object(Z.b)({skip:p||void 0===S,filterQuery:S,indexNames:k,ip:o});Object(Q.a)({id:O,filterQuery:S,kqlError:w,query:f,startDate:u,endDate:c});const{jobIds:N}=Object(ae.b)(),[F,A]=Object(te.a)({criteriaFields:Object(K.a)(o,s),startDate:u,endDate:c,skip:p,jobIds:N,aggregationInterval:"auto"});return E?i.a.createElement(W.a,{contextID:e,id:O,ip:o,data:T,anomaliesData:A,loading:j,isInDetailsSidePanel:!0,isLoadingAnomaliesData:F,isDraggable:n,type:y,flowTarget:s,startDate:u,endDate:c,narrowDateRange:h,indexPatterns:k}):i.a.createElement(ne.a,null)},le=O()(o.EuiFlyoutBody).withConfig({displayName:"StyledEuiFlyoutBody",componentId:"sc-uvw88-0"})([".euiFlyoutBody__overflow{display:flex;flex:1;overflow-x:hidden;overflow-y:scroll;.euiFlyoutBody__overflowContent{flex:1;overflow-x:hidden;overflow-y:scroll;padding:",";}}"],(({theme:e})=>`${e.eui.euiSizeXS} ${e.eui.euiSizeM} 64px`)),ce=O()(o.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-uvw88-1"})(["flex:1 0 auto;"]),ue=O()(o.EuiFlexItem).withConfig({displayName:"StyledEuiFlexButtonWrapper",componentId:"sc-uvw88-2"})(["align-self:flex-start;flex:1 0 auto;"]),de=O.a.div.withConfig({displayName:"StyledPanelContent",componentId:"sc-uvw88-3"})(["display:block;height:100%;overflow-y:scroll;overflow-x:hidden;"]),pe=i.a.memo((({contextID:e,expandedNetwork:t,handleOnNetworkClosed:n,isFlyoutView:a,isDraggable:r})=>{const{ip:s}=t;return a?i.a.createElement(i.a.Fragment,null,i.a.createElement(o.EuiFlyoutHeader,{hasBorder:!0},i.a.createElement(re,{ip:s})),i.a.createElement(le,null,i.a.createElement(o.EuiSpacer,{size:"m"}),i.a.createElement(oe,{expandedNetwork:t}),i.a.createElement(o.EuiSpacer,{size:"m"}),i.a.createElement(se,{contextID:e,expandedNetwork:t}))):i.a.createElement(i.a.Fragment,null,i.a.createElement(ce,{justifyContent:"spaceBetween",wrap:!1},i.a.createElement(o.EuiFlexItem,{grow:!1},i.a.createElement(re,{ip:s})),i.a.createElement(o.EuiFlexItem,{grow:!1},i.a.createElement(o.EuiButtonIcon,{iconType:"cross","aria-label":w.i18n.translate("xpack.securitySolution.timeline.sidePanel.networkDetails.close",{defaultMessage:"close"}),onClick:n}))),i.a.createElement(o.EuiSpacer,{size:"m"}),i.a.createElement(ue,{grow:!1},i.a.createElement(oe,{expandedNetwork:t})),i.a.createElement(o.EuiSpacer,{size:"m"}),i.a.createElement(de,null,i.a.createElement(se,{contextID:e,expandedNetwork:t,isDraggable:r})))}));var me=n(921),ge=n(922),fe=n(829),be=n(137);const ye=O.a.h4.withConfig({displayName:"StyledTitle",componentId:"sc-1tknvzp-0"})(["word-break:break-all;word-wrap:break-word;white-space:pre-wrap;"]),he=({userName:e})=>i.a.createElement(o.EuiTitle,{size:"s"},i.a.createElement(ye,null,w.i18n.translate("xpack.securitySolution.timeline.sidePanel.userDetails.title",{defaultMessage:"User details"}),`: ${e}`)),ve=({userName:e})=>i.a.createElement(T.m,{userName:e,isButton:!0},w.i18n.translate("xpack.securitySolution.timeline.sidePanel.networkDetails.userDetails",{defaultMessage:"View details page"})),Ee=({contextID:e,userName:t,isDraggable:n})=>{const{to:o,from:s,isInitializing:l}=Object(C.a)(),{selectedPatterns:c}=Object(M.d)(),u=Object(r.useDispatch)(),[d,{userDetails:p}]=Object(ge.a)({endDate:o,startDate:s,userName:t,indexNames:c,skip:l}),m=Object(a.useCallback)(((e,t)=>{const n=Object(_.a)(e,t);u(Object(D.setAbsoluteRangeDatePicker)({id:I.a.global,from:n.from,to:n.to}))}),[u]);return i.a.createElement(F.a,{criteriaFields:Object(fe.a)(be.UsersType.details,t),startDate:s,endDate:o,skip:l},(({isLoadingAnomaliesData:a,anomaliesData:r})=>i.a.createElement(me.a,{userName:t,isInDetailsSidePanel:!0,data:p,loading:d,contextID:e,isDraggable:n,id:"usersDetailsQuery",anomaliesData:r,isLoadingAnomaliesData:a,startDate:s,endDate:o,narrowDateRange:m,indexPatterns:c})))},xe=O()(o.EuiFlyoutBody).withConfig({displayName:"StyledEuiFlyoutBody",componentId:"sc-shafkc-0"})([".euiFlyoutBody__overflow{display:flex;flex:1;overflow-x:hidden;overflow-y:scroll;.euiFlyoutBody__overflowContent{flex:1;overflow-x:hidden;overflow-y:scroll;padding:",";}}"],(({theme:e})=>`${e.eui.euiSizeXS} ${e.eui.euiSizeM} 64px`)),ke=({contextID:e,userName:t})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(o.EuiFlyoutHeader,{hasBorder:!0},i.a.createElement(he,{userName:t})),i.a.createElement(xe,null,i.a.createElement(o.EuiSpacer,{size:"m"}),i.a.createElement(ve,{userName:t}),i.a.createElement(o.EuiSpacer,{size:"m"}),i.a.createElement(Ee,{contextID:e,userName:t}))),Se=O()(o.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-1t5j3rb-0"})(["flex:1 0 auto;"]),we=O()(o.EuiFlexItem).withConfig({displayName:"StyledEuiFlexButtonWrapper",componentId:"sc-1t5j3rb-1"})(["align-self:flex-start;flex:1 0 auto;"]),je=O.a.div.withConfig({displayName:"StyledPanelContent",componentId:"sc-1t5j3rb-2"})(["display:block;height:100%;overflow-y:scroll;overflow-x:hidden;"]),Oe=({contextID:e,userName:t,isDraggable:n,handleOnClose:a})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(Se,{justifyContent:"spaceBetween",wrap:!1},i.a.createElement(o.EuiFlexItem,{grow:!1},i.a.createElement(he,{userName:t})),i.a.createElement(o.EuiFlexItem,{grow:!1},i.a.createElement(o.EuiButtonIcon,{iconType:"cross","aria-label":w.i18n.translate("xpack.securitySolution.timeline.sidePanel.networkDetails.close",{defaultMessage:"close"}),onClick:a}))),i.a.createElement(o.EuiSpacer,{size:"m"}),i.a.createElement(we,{grow:!1},i.a.createElement(ve,{userName:t})),i.a.createElement(o.EuiSpacer,{size:"m"}),i.a.createElement(je,null,i.a.createElement(Ee,{contextID:e,userName:t,isDraggable:n}))),Ie=({contextID:e,userName:t,handleOnClose:n,isFlyoutView:a,isDraggable:r})=>a?i.a.createElement(ke,{userName:t,contextID:e}):i.a.createElement(Oe,{userName:t,contextID:e,isDraggable:r,handleOnClose:n}),Te=i.a.memo(Ie);var Ce=n(155);const Me=i.a.memo((({browserFields:e,entityType:t,handleOnPanelClosed:n,isFlyoutView:p,runtimeMappings:m,tabType:g,scopeId:f,isReadOnly:b})=>{var y,h,v,E;const x=Object(r.useDispatch)(),k=Object(a.useMemo)((()=>Object(s.isTimelineScope)(f)?l.b.getTimelineByIdSelector():Object(s.isInTableScope)(f)?Ce.b.getTableByIdSelector():void 0),[f]),w=Object(d.a)((e=>{var t,n;return null===(t=null!==(n=k&&k(e,f))&&void 0!==n?n:c.b)||void 0===t?void 0:t.expandedDetail})),j=Object(a.useCallback)((()=>{const e=Object(s.getScopedActions)(f);e&&x(e.toggleDetailPanel({id:f}))}),[x,f]),O=null!=g?g:u.m.query,I=Object(a.useCallback)((()=>{n?n():j()}),[j,n]);if(!w)return null;const T=w[O];if(null==T||!T.panelView)return null;let C=null,M="s",N=f;const D=`${f}-${O}`,F=f===u.j.active&&O===u.m.query;return"eventDetail"===(null==T?void 0:T.panelView)&&null!=T&&null!==(y=T.params)&&void 0!==y&&y.eventId&&(M="m",N=T.params.eventId,C=i.a.createElement(S,{browserFields:e,entityType:t,expandedEvent:null==T?void 0:T.params,handleOnEventClosed:I,isDraggable:F,isFlyoutView:p,runtimeMappings:m,tabType:O,scopeId:f,isReadOnly:b})),"hostDetail"===(null==T?void 0:T.panelView)&&null!=T&&null!==(h=T.params)&&void 0!==h&&h.hostName&&(N=T.params.hostName,C=i.a.createElement(H,{contextID:D,expandedHost:null==T?void 0:T.params,handleOnHostClosed:I,isDraggable:F,isFlyoutView:p})),"userDetail"===(null==T?void 0:T.panelView)&&null!=T&&null!==(v=T.params)&&void 0!==v&&v.userName&&(N=T.params.userName,C=i.a.createElement(Te,{contextID:D,userName:T.params.userName,handleOnClose:I,isDraggable:F,isFlyoutView:p})),"networkDetail"===(null==T?void 0:T.panelView)&&null!=T&&null!==(E=T.params)&&void 0!==E&&E.ip&&(N=T.params.ip,C=i.a.createElement(pe,{contextID:D,expandedNetwork:null==T?void 0:T.params,handleOnNetworkClosed:I,isDraggable:F,isFlyoutView:p})),p?i.a.createElement(o.EuiFlyout,{"data-test-subj":"timeline:details-panel:flyout",size:M,onClose:I,ownFocus:!1,key:N},C):C}));Me.displayName="DetailsPanel"},function(e,t,n){"use strict";n.d(t,"a",(function(){return $}));var a=n(34),i=n(4),r=n.n(i),o=n(33),s=n.n(o),l=n(32),c=n(93),u=n(166),d=n(717),p=n(0);const m=p.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.linkedToListSection.title",{defaultMessage:"Linked to shared list"}),g=p.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.linkedToListSection.error",{defaultMessage:"Unable to fetch exception list."});var f=n(261);const b=s()(l.EuiTitle).withConfig({displayName:"SectionHeader",componentId:"sc-1bzei7o-0"})(["",""],(()=>Object(o.css)(["font-weight:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold)))),y=({isLoadingReferences:e,errorFetchingReferences:t,listAndReferences:n})=>{const[a,o]=Object(i.useState)(r.a.createElement(l.EuiLoadingContent,{lines:4,"data-test-subj":"exceptionItemListsTableLoading"})),[s,c]=Object(i.useState)(void 0);return Object(i.useEffect)((()=>{t?c(g):e||o(void 0)}),[t,e]),r.a.createElement(l.EuiPanel,{paddingSize:"none",hasShadow:!1,"data-test-subj":"exceptionItemLinkedToListSection"},r.a.createElement(b,{size:"xs"},r.a.createElement("h3",null,m)),r.a.createElement(l.EuiSpacer,{size:"s"}),r.a.createElement(l.EuiInMemoryTable,{tableCaption:"Table of exception lists",itemId:"id",message:a,loading:e,items:n,error:s,columns:Object(f.d)(),isSelectable:!1,sorting:!0,"data-test-subj":"exceptionItemSharedList"}))},h=r.a.memo(y);h.displayName="ExceptionsLinkedToLists";const v=p.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.linkedToRule.title",{defaultMessage:"Linked to rule"}),E=s()(l.EuiTitle).withConfig({displayName:"SectionHeader",componentId:"sc-xt2wcr-0"})(["",""],(()=>Object(o.css)(["font-weight:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold)))),x=({rule:e})=>r.a.createElement(r.a.Fragment,null,r.a.createElement(E,{size:"xs","data-test-subj":"exceptionItemLinkedToRuleSection"},r.a.createElement("h3",null,v)),r.a.createElement(l.EuiSpacer,{size:"s"}),r.a.createElement(l.EuiInMemoryTable,{tableCaption:"Rules table",itemId:"id",items:[e],columns:Object(f.c)(),sorting:!0,"data-test-subj":"addExceptionToRulesTable"})),k=r.a.memo(x);k.displayName="ExceptionsLinkedToRule";var S=n(711),w=n(718),j=n(190),O=n(656),I=n(712),T=n(657),C=n(517);const M=p.i18n.translate("xpack.securitySolution.ruleExceptions.editException.cancel",{defaultMessage:"Cancel"}),N=p.i18n.translate("xpack.securitySolution.ruleExceptions.editException.editExceptionTitle",{defaultMessage:"Edit rule exception"}),D=p.i18n.translate("xpack.securitySolution.ruleExceptions.editException.editEndpointExceptionTitle",{defaultMessage:"Edit endpoint exception"}),F=p.i18n.translate("xpack.securitySolution.ruleExceptions.editException.editRuleExceptionToastSuccessTitle",{defaultMessage:"Rule exception updated"}),A=p.i18n.translate("xpack.securitySolution.ruleExceptions.editException.editRuleExceptionToastErrorTitle",{defaultMessage:"Error updating exception"});var _=n(84),R=n(658);const P=s()(l.EuiFlyoutHeader).withConfig({displayName:"FlyoutHeader",componentId:"sc-18pz2hd-0"})(["",""],(({theme:e})=>Object(o.css)(["border-bottom:1px solid ",";"],e.eui.euiColorLightShade))),L=s()(l.EuiFlyoutBody).withConfig({displayName:"FlyoutBodySection",componentId:"sc-18pz2hd-1"})(["",""],(()=>Object(o.css)(["&.builder-section{overflow-y:scroll;}"]))),q=s()(l.EuiFlexGroup).withConfig({displayName:"FlyoutFooterGroup",componentId:"sc-18pz2hd-2"})(["",""],(({theme:e})=>Object(o.css)(["padding:",";"],e.eui.euiSizeS))),B=s()(l.EuiTitle).withConfig({displayName:"SectionHeader",componentId:"sc-18pz2hd-3"})(["",""],(()=>Object(o.css)(["font-weight:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold)))),z=({list:e,itemToEdit:t,rule:n,showAlertCloseOptions:o,openedFromListDetailPage:s,onCancel:m,onConfirm:g})=>{var b;const y=Object(i.useMemo)((()=>t.os_types),[t]),v=Object(i.useMemo)((()=>null!=n?[n]:null),[n]),E=Object(i.useMemo)((()=>e.type),[e]),{isLoading:x,indexPatterns:z}=Object(O.a)(v),[$,V]=(()=>{const{addSuccess:e,addError:t,addWarning:n}=Object(_.a)(),[a,r]=Object(R.a)(),[o,s]=Object(i.useState)(!1),l=Object(i.useRef)(null);return Object(i.useEffect)((()=>{let n=!0;const a=new AbortController;return l.current=async({itemsToUpdate:a})=>{var i,o;if(null!=r)try{s(!0),await r(a),e({title:F,text:(i=a.map((({name:e})=>e)).join(", "),o=a.length,p.i18n.translate("xpack.securitySolution.ruleExceptions.editException.editRuleExceptionToastSuccessText",{values:{exceptionItemName:i,numItems:o},defaultMessage:"{numItems, plural, =1 {Exception} other {Exceptions}} - {exceptionItemName} - {numItems, plural, =1 {has} other {have}} been updated."}))}),n&&s(!1)}catch(e){if(n)throw s(!1),t(e,{title:A}),new Error(e)}},()=>{n=!1,a.abort()}}),[e,t,n,r]),[o||a,l.current]})(),[U,H]=Object(I.a)(),[{exceptionItems:G,exceptionItemMeta:{name:Q},newComment:W,bulkCloseAlerts:K,disableBulkClose:Y,bulkCloseIndex:J,entryErrorExists:X},Z]=Object(i.useReducer)(((e,t)=>{switch(t.type){case"setExceptionItemMeta":{const{value:n}=t;return{...e,exceptionItemMeta:{...e.exceptionItemMeta,[n[0]]:n[1]}}}case"setComment":{const{comment:n}=t;return{...e,newComment:n}}case"setBulkCloseAlerts":{const{bulkClose:n}=t;return{...e,bulkCloseAlerts:n}}case"setDisableBulkCloseAlerts":{const{disableBulkCloseAlerts:n}=t;return{...e,disableBulkClose:n}}case"setBulkCloseIndex":{const{bulkCloseIndex:n}=t;return{...e,bulkCloseIndex:n}}case"setExceptionItems":{const{items:n}=t;return{...e,exceptionItems:n}}case"setConditionValidationErrorExists":{const{errorExists:n}=t;return{...e,entryErrorExists:n}}default:return e}}),{exceptionItems:[t],exceptionItemMeta:{name:t.name},newComment:"",bulkCloseAlerts:!1,disableBulkClose:!0,bulkCloseIndex:void 0,entryErrorExists:!1}),ee=Object(i.useMemo)((()=>null==n||!Object(u.b)(n.type)&&!Object(u.g)(n.type)&&!Object(u.d)(n.type)),[n]),[te,ne,ae,ie]=Object(T.a)();Object(i.useEffect)((()=>{null!=ie&&ie([{id:e.id,listId:e.list_id,namespaceType:e.namespace_type}])}),[e,ie]);const re=Object(i.useCallback)((e=>{Z({type:"setExceptionItems",items:e})}),[Z]),oe=Object(i.useCallback)((e=>{Z({type:"setExceptionItemMeta",value:e})}),[Z]),se=Object(i.useCallback)((e=>{Z({type:"setComment",comment:e})}),[Z]),le=Object(i.useCallback)((e=>{Z({type:"setBulkCloseAlerts",bulkClose:e})}),[Z]),ce=Object(i.useCallback)((e=>{Z({type:"setDisableBulkCloseAlerts",disableBulkCloseAlerts:e})}),[Z]),ue=Object(i.useCallback)((e=>{Z({type:"setBulkCloseIndex",bulkCloseIndex:e})}),[Z]),de=Object(i.useCallback)((e=>{Z({type:"setConditionValidationErrorExists",errorExists:e})}),[Z]),pe=Object(i.useCallback)((()=>{m(!1)}),[m]),me=Object(i.useCallback)((e=>e.every((e=>c.D.is(e)))),[]),ge=Object(i.useCallback)((async()=>{if(null!=V)try{const i=Object(f.a)({itemName:Q,commentToAdd:W,listType:E,selectedOs:t.os_types,items:G});if(me(i)){await V({itemsToUpdate:i});const t=null!=n?[n.rule_id]:[],r=null!=ae?ae[e.list_id].referenced_rules.map((({rule_id:e})=>e)):[],o=E===c.b.RULE_DEFAULT?t:r;null!=H&&!Object(a.isEmpty)(o)&&K&&await H(o,i,void 0,J),g(!0)}}catch(e){m(!1)}}),[V,Q,W,E,t.os_types,G,me,n,ae,e.list_id,H,K,g,J,m]),fe=Object(i.useMemo)((()=>E===c.b.ENDPOINT?D:N),[E]),be=Object(i.useMemo)((()=>$||U||G.every((e=>0===e.entries.length))||x||X),[x,X,G,$,U]);return r.a.createElement(l.EuiFlyout,{size:"l",onClose:pe,"data-test-subj":"editExceptionFlyout"},r.a.createElement(P,null,r.a.createElement(l.EuiTitle,null,r.a.createElement("h2",{"data-test-subj":"exceptionFlyoutTitle"},fe)),r.a.createElement(l.EuiSpacer,{size:"m"})),x&&r.a.createElement(l.EuiLoadingContent,{"data-test-subj":"loadingEditExceptionFlyout",lines:4}),r.a.createElement(L,{className:"builder-section"},r.a.createElement(d.a,{exceptionItemName:Q,onChange:oe}),r.a.createElement(l.EuiHorizontalRule,null),r.a.createElement(w.a,{exceptionItemName:Q,allowLargeValueLists:ee,exceptionListItems:[t],exceptionListType:E,indexPatterns:z,rules:v,selectedOs:y,showOsTypeOptions:E===c.b.ENDPOINT,isEdit:!0,onExceptionItemAdd:re,onSetErrorExists:de,onFilterIndexPatterns:j.h}),!s&&E===c.b.DETECTION&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.EuiHorizontalRule,null),r.a.createElement(h,{isLoadingReferences:te,errorFetchingReferences:ne,listAndReferences:null!=ae?[ae[e.list_id]]:[]})),!s&&E===c.b.RULE_DEFAULT&&null!=n&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.EuiHorizontalRule,null),r.a.createElement(k,{rule:n})),r.a.createElement(l.EuiHorizontalRule,null),r.a.createElement(C.a,{accordionTitle:r.a.createElement(B,{size:"xs"},r.a.createElement("h3",null,(ye=null!==(b=t.comments.length)&&void 0!==b?b:0,p.i18n.translate("xpack.securitySolution.ruleExceptions.editExceptionFlyout.commentsTitle",{values:{comments:ye},defaultMessage:"Add comments ({comments})"})))),exceptionItemComments:t.comments,newCommentValue:W,newCommentOnChange:se}),o&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.EuiHorizontalRule,null),r.a.createElement(S.a,{exceptionListType:E,shouldBulkCloseAlert:K,disableBulkClose:Y,exceptionListItems:G,onDisableBulkClose:ce,onUpdateBulkCloseIndex:ue,onBulkCloseCheckboxChange:le}))),r.a.createElement(l.EuiFlyoutFooter,null,r.a.createElement(q,{justifyContent:"spaceBetween"},r.a.createElement(l.EuiButtonEmpty,{"data-test-subj":"cancelExceptionEditButton",onClick:pe},M),r.a.createElement(l.EuiButton,{"data-test-subj":"editExceptionConfirmButton",onClick:ge,isDisabled:be,fill:!0},fe))));var ye},$=r.a.memo(z);$.displayName="EditExceptionFlyout"},function(e,t,n){"use strict";n.d(t,"a",(function(){return N}));var a=n(4),i=n.n(a),r=n(32),o=n(87),s=n(34),l=n(33),c=n.n(l),u=n(627),d=n(102),p=n(628),m=n(101),g=n(388);const f=(e=[])=>e.filter((e=>!Object(s.isEmpty)(e))).map((e=>{const t=(e=>{const[t,n]=Object(g.a)(e);return null!=t&&null!=n?`${t}: "${n}"`:""})(e);return i.a.createElement(r.EuiFlexItem,{key:t,grow:!1},t)}));var b=n(0);const y=b.i18n.translate("xpack.securitySolution.ml.score.influencedByTitle",{defaultMessage:"Influenced By"}),h=b.i18n.translate("xpack.securitySolution.ml.score.maxAnomalyScoreTitle",{defaultMessage:"Max Anomaly Score"}),v=b.i18n.translate("xpack.securitySolution.ml.score.anomalyJobTitle",{defaultMessage:"Job"}),E=b.i18n.translate("xpack.securitySolution.ml.score.viewInMachineLearningLink",{defaultMessage:"View in Machine Learning"}),x=b.i18n.translate("xpack.securitySolution.ml.score.detectedTitle",{defaultMessage:"Detected"}),k=b.i18n.translate("xpack.securitySolution.ml.score.narrowToThisDateRangeLink",{defaultMessage:"Narrow to this date range"}),S=b.i18n.translate("xpack.securitySolution.ml.score.anomalousEntityTitle",{defaultMessage:"Anomalous Entity"});var w=n(629);const j=c()(r.EuiText).withConfig({displayName:"LargeScore",componentId:"sc-1ocpxoq-0"})(["font-size:45px;font-weight:lighter;"]);j.displayName="LargeScore";const O=(e,t,n,a,o)=>[{title:h,description:i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement(j,null,Object(p.a)(e.severity)))},{title:i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiSpacer,{size:"m"}),v),description:i.a.createElement(r.EuiFlexGroup,{direction:"column",gutterSize:"none",responsive:!1},i.a.createElement(r.EuiFlexItem,{grow:!1},e.jobId),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(w.a,{score:e,startDate:t,endDate:n,linkName:E})))},{title:x,description:i.a.createElement(r.EuiFlexGroup,{direction:"column",gutterSize:"none",responsive:!1},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(m.c,{value:new Date(e.time)})),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiLink,{"data-test-subj":"anomaly-description-narrow-range-link",onClick:()=>{o(e,a)},target:"_blank"},k)))},{title:S,description:i.a.createElement(r.EuiFlexGroup,{direction:"column",gutterSize:"none",responsive:!1},i.a.createElement(r.EuiFlexItem,{grow:!1},`${e.entityName}: "${e.entityValue}"`))},{title:y,description:i.a.createElement(r.EuiFlexGroup,{direction:"column",gutterSize:"none",responsive:!1},f(e.influencers))}],I=c()(r.EuiIcon).withConfig({displayName:"Icon",componentId:"sc-1pfd59a-0"})(["vertical-align:text-bottom;cursor:pointer;"]);I.displayName="Icon";const T=({jobKey:e,startDate:t,endDate:n,index:o=0,score:s,interval:l,narrowDateRange:c})=>{const[p,m]=Object(a.useState)(!1);return i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(u.a,{id:Object(d.h)(`anomaly-scores-${e}`),index:o,score:s})),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiPopover,{"data-test-subj":"anomaly-score-popover",id:"anomaly-score-popover",isOpen:p,onClick:()=>m(!p),closePopover:()=>m(!p),button:i.a.createElement(I,{type:"iInCircle"}),repositionOnScroll:!0},i.a.createElement(r.EuiDescriptionList,{"data-test-subj":"anomaly-description-list",listItems:O(s,t,n,l,c)}))))};T.displayName="AnomalyScoreComponent";const C=i.a.memo(T);C.displayName="AnomalyScore";const M=({anomalies:e,startDate:t,endDate:n,isLoading:a,narrowDateRange:l,limit:c})=>a?i.a.createElement(r.EuiLoadingSpinner,{"data-test-subj":"anomaly-score-spinner",size:"m"}):null==e||0===e.anomalies.length?Object(o.d)():i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiFlexGroup,{gutterSize:"none",responsive:!1},((e,t)=>{const n=e.reduce(((e,t)=>{const n=t.jobId,a=t.severity;return(null==e[n]||e[n].severity<a)&&(e[n]=t),e}),{}),a=Object(s.toArray)(n).sort(((e,t)=>t.severity-e.severity));return null==t?a:a.slice(0,t)})(e.anomalies,c).map(((a,r)=>{const o=(e=>`${e.jobId}-${e.severity}-${e.entityName}-${e.entityValue}`)(a);return i.a.createElement(C,{key:o,jobKey:o,startDate:t,endDate:n,index:r,score:a,interval:e.interval,narrowDateRange:l})}))));M.displayName="AnomalyScoresComponent";const N=i.a.memo(M);N.displayName="AnomalyScores"},function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return p})),n.d(t,"d",(function(){return m})),n.d(t,"e",(function(){return g}));const a=n(0).i18n.translate("xpack.securitySolution.components.ml.api.errors.statusCodeFailureTitle",{defaultMessage:"Status Code:"});var i=n(324),r=n(34);const o=e=>Object(r.has)("error.msg",e)&&Object(r.has)("error.response",e)&&Object(r.has)("error.statusCode",e),s=e=>Object(r.has)("error.error.reason",e),l=e=>{try{return JSON.stringify(JSON.parse(e),null,2)}catch(t){return e}};var c=n(77);const u=async({indexPatternName:e,signal:t})=>c.b.get().http.fetch(`/api/ml/modules/recognize/${e}`,{method:"GET",asSystemRequest:!0,signal:t}),d=async({moduleId:e="",signal:t})=>c.b.get().http.fetch(`/api/ml/modules/get_module/${e}`,{method:"GET",asSystemRequest:!0,signal:t}),p=async({configTemplate:e,indexPatternName:t="auditbeat-*",jobIdErrorFilter:n=[],groups:r=["security"],prefix:u=""})=>{const d=await c.b.get().http.fetch(`/api/ml/modules/setup/${e}`,{method:"POST",body:JSON.stringify({prefix:u,groups:r,indexPatternName:t,startDatafeed:!1,useDedicatedIndex:!0,applyToAllSpaces:!0}),asSystemRequest:!0});return((e,t=[])=>{const n=[...e.jobs.reduce(((e,n)=>{if(null!=n.error&&t.includes(n.id)){if(o(n))return[...e,n.error.msg,l(n.error.response),`${a} ${n.error.statusCode}`];if(s(n))return[n.error.error.reason]}return e}),[]),...e.datafeeds.reduce(((e,n)=>null!=n.error&&t.includes(n.id.substr("datafeed-".length))?[...e,n.error.msg,l(n.error.response),`${a} ${n.error.statusCode}`]:e),[])];if(n.length>0)throw new i.c(n)})(d,n),d},m=async({datafeedIds:e,start:t=0})=>{const n=await c.b.get().http.fetch("/api/ml/jobs/force_start_datafeeds",{method:"POST",body:JSON.stringify({datafeedIds:e,...0!==t&&{start:t}}),asSystemRequest:!0});return((e,t)=>{const n=t.reduce(((t,n)=>{const i=e[n];return o(i)?[...t,i.error.msg,l(i.error.response),`${a} ${i.error.statusCode}`]:s(i)?[i.error.error.reason]:t}),[]);if(n.length>0)throw new i.c(n)})(n,e),n},g=async({datafeedIds:e})=>{const t=await c.b.get().http.fetch("/api/ml/jobs/stop_datafeeds",{method:"POST",body:JSON.stringify({datafeedIds:e}),asSystemRequest:!0}),n="datafeed-";return[t,await c.b.get().http.fetch("/api/ml/jobs/close_jobs",{method:"POST",body:JSON.stringify({jobIds:e.map((e=>e.startsWith(n)?e.substring(n.length):e))}),asSystemRequest:!0})]}},function(e,t,n){"use strict";n.d(t,"o",(function(){return f})),n.d(t,"d",(function(){return b})),n.d(t,"h",(function(){return y})),n.d(t,"A",(function(){return h})),n.d(t,"B",(function(){return E})),n.d(t,"C",(function(){return x})),n.d(t,"w",(function(){return k})),n.d(t,"r",(function(){return S})),n.d(t,"s",(function(){return w})),n.d(t,"u",(function(){return I})),n.d(t,"z",(function(){return T})),n.d(t,"l",(function(){return C})),n.d(t,"c",(function(){return M})),n.d(t,"k",(function(){return N})),n.d(t,"j",(function(){return D})),n.d(t,"i",(function(){return F})),n.d(t,"G",(function(){return A})),n.d(t,"E",(function(){return _})),n.d(t,"e",(function(){return R})),n.d(t,"q",(function(){return P})),n.d(t,"f",(function(){return L})),n.d(t,"b",(function(){return q})),n.d(t,"a",(function(){return B})),n.d(t,"v",(function(){return $})),n.d(t,"H",(function(){return V})),n.d(t,"D",(function(){return U})),n.d(t,"F",(function(){return H})),n.d(t,"y",(function(){return G})),n.d(t,"x",(function(){return Q})),n.d(t,"t",(function(){return W})),n.d(t,"p",(function(){return K})),n.d(t,"g",(function(){return Y})),n.d(t,"n",(function(){return J})),n.d(t,"m",(function(){return X}));var a=n(821),i=n.n(a),r=n(108),o=n(347),s=n(513),l=n(144),c=n(465),u=n(466),d=n(467),p=n(512);var m=n(162);function g(e,t){return m.f(e.minimum,t.minimum)&&m.f(e.maximum,t.maximum)}function f(e){var t;return void 0!==(null===(t=e.tree)||void 0===t?void 0:t.pendingRequestParameters)}function b(e){return e.detectedBounds}function y(e){var t,n;return!(null===(t=e.tree)||void 0===t||!t.lastResponse||null!==(n=e.tree)&&void 0!==n&&n.lastResponse.successful)}function h(e){return e.resolverComponentInstanceID?e.resolverComponentInstanceID:""}const v=e=>{var t,n,a;return null!==(t=e.tree)&&void 0!==t&&null!==(n=t.lastResponse)&&void 0!==n&&n.successful?null===(a=e.tree)||void 0===a?void 0:a.lastResponse.result:void 0},E=e=>{var t,n,a,i,r;return!(null===(t=e.tree)||void 0===t||null===(n=t.lastResponse)||void 0===n||!n.successful)&&(null===(a=e.tree)||void 0===a||null===(i=a.lastResponse)||void 0===i||null===(r=i.result)||void 0===r?void 0:r.nodes.length)>0};function x(e){var t,n;if(null!==(t=e.tree)&&void 0!==t&&null!==(n=t.lastResponse)&&void 0!==n&&n.successful){var a;const{schema:t,dataSource:n}=null===(a=e.tree)||void 0===a?void 0:a.lastResponse;return{schema:t,dataSource:n}}}const k=Object(r.createSelector)(v,(function(e){return null==e?void 0:e.originID})),S=Object(r.createSelector)((e=>e.nodeData),(e=>t=>null==e?void 0:e.get(t))),w=Object(r.createSelector)(S,(e=>t=>{const n=e(t);return n?n.status:"loading"})),j=Object(r.createSelector)(v,(function(e){const t=new Map;if(null!=e&&e.nodes){for(const n of e.nodes){const e=l.b(n);void 0!==e&&t.set(e,n)}return[...t.values()]}return[]})),O=Object(r.createSelector)(j,k,(function(e,t){return s.b(e,t)})),I=Object(r.createSelector)(v,(e=>{if(e){const t=u.d(e);return e=>t.get(e)}return()=>{}})),T=Object(r.createSelector)(I,(e=>t=>{var n;return null===(n=e(t))||void 0===n?void 0:n.total}));function C(e){return e.currentRelatedEvent.loading}function M(e){return e.currentRelatedEvent.data}const N=Object(r.createSelector)(O,x,((e,t)=>{var n,a;return(null==t||null===(n=t.schema)||void 0===n||!n.ancestry)&&(null!==(a=e.generations)&&void 0!==a?a:0)>=u.c(null==t?void 0:t.schema)})),D=Object(r.createSelector)(O,(e=>{var t;return(null!==(t=e.descendants)&&void 0!==t?t:0)>=u.b()})),F=Object(r.createSelector)(O,x,((e,t)=>{var n;return(null!==(n=e.ancestors)&&void 0!==n?n:0)>=u.a(null==t?void 0:t.schema)}));function A(e){var t,n,a,i,r,o;return void 0===(null===(t=e.tree)||void 0===t?void 0:t.currentParameters)||d.a(null===(n=e.tree)||void 0===n?void 0:n.currentParameters,null===(a=e.tree)||void 0===a||null===(i=a.lastResponse)||void 0===i?void 0:i.parameters)||d.a(null===(r=e.tree)||void 0===r?void 0:r.currentParameters,null===(o=e.tree)||void 0===o?void 0:o.pendingRequestParameters)?null:e.tree.currentParameters}const _=Object(r.createSelector)((e=>{var t;return null===(t=e.tree)||void 0===t?void 0:t.currentParameters}),(function(e){const t=new Date(0),n=new Date(864e13),a={from:t.toISOString(),to:n.toISOString()};return void 0!==e&&(e.filters.from&&(a.from=e.filters.from),e.filters.to&&(a.to=e.filters.to)),a})),R=(Object(r.createSelector)(A,(e=>{var t;return null!==(t=null==e?void 0:e.indices)&&void 0!==t?t:[]})),Object(r.createSelector)((e=>{var t,n,a,i,r;return null!==(t=e.tree)&&void 0!==t&&null!==(n=t.lastResponse)&&void 0!==n&&n.successful?null===(a=e.tree)||void 0===a||null===(i=a.lastResponse)||void 0===i||null===(r=i.parameters)||void 0===r?void 0:r.indices:void 0}),(e=>e.indices),(function(e,t){var n;return null!==(n=null!=e?e:t)&&void 0!==n?n:[]}))),P=Object(r.createSelector)(O,k,(function(e,t){const n=p.a(e);if(!t)return n;if(null===s.f(e,t))return n;const a=p.b(n,t);return void 0===a?n:p.c(n,m.i(a,-1))})),L=Object(r.createSelector)(O,(e=>t=>s.f(e,t))),q=Object(r.createSelector)(P,L,(({ariaLevels:e},t)=>n=>{var a;const i=t(n);return i&&null!==(a=e.get(i))&&void 0!==a?a:null})),B=Object(r.createSelector)(O,L,((e,t)=>{const n=new Map;return function a(i){const r=n.get(i);if(void 0!==r)return r;const o=t(i);if(!o)throw new Error("could not find child event in process tree.");const c=s.a(e,l.d(o));let u=null;for(const e of c){if(null!==u){const t=l.b(u),a=l.b(e);void 0!==t&&void 0!==a&&n.set(t,a)}u=e}if(u){const e=l.b(u);void 0!==e&&n.set(e,null)}return a(i)}})),z=Object(r.createSelector)(P,(function({processNodePositions:e,edgeLineSegments:t}){const n=new i.a,a=[],r=[];for(const[t,n]of e){const[e,i]=n,r={minX:e-360,minY:i-120,maxX:e+360,maxY:i+120,position:n,entity:t,type:"treeNode"};a.push(r)}for(const e of t){const{points:[[t,n],[a,i]]}=e,o={minX:Math.min(t,a)-30,minY:Math.min(n,i)-30,maxX:Math.max(t,a)+30,maxY:Math.max(n,i)+30,entity:e,type:"edgeLine"};r.push(o)}return n.load([...a,...r]),n})),$=Object(r.createSelector)(z,(function(e){return Object(r.defaultMemoize)((t=>{const{minimum:[n,a],maximum:[i,r]}=t,o=e.search({minX:n,minY:a,maxX:i,maxY:r});return{processNodePositions:new Map(o.filter((e=>"treeNode"===e.type)).map((e=>[e.entity,e.position]))),connectingEdgeLineSegments:o.filter((e=>"edgeLine"===e.type)).map((e=>e.entity))}}),g)}));function V(e){var t,n,a;return void 0===(null===(t=e.tree)||void 0===t?void 0:t.pendingRequestParameters)||d.a(null===(n=e.tree)||void 0===n?void 0:n.pendingRequestParameters,null===(a=e.tree)||void 0===a?void 0:a.currentParameters)?null:e.tree.pendingRequestParameters}const U=Object(r.createSelector)(I,(e=>t=>{const n=l.b(t);if(void 0===n)return null;const a=e(n);return a?a.total:null})),H=Object(r.createSelector)(I,(e=>t=>{const n=e(t);return void 0===n?void 0:n.total})),G=Object(r.createSelector)(I,(e=>(t,n)=>{const a=e(t);return a?a.byCategory[n]:void 0})),Q=Object(r.createSelector)((e=>e.locationSearch),h,((e,t)=>Object(o.a)({locationSearch:e,resolverComponentInstanceID:t}))),W=e=>{var t,n;return null!==(t=null===(n=e.nodeEventsInCategory)||void 0===n?void 0:n.events)&&void 0!==t?t:[]},K=Object(r.createSelector)((e=>e.nodeEventsInCategory),Q,(function(e,t){return!(void 0===e||!c.a(e,t))&&null!==e.cursor})),Y=Object(r.createSelector)((e=>e.nodeEventsInCategory),Q,(function(e,t){return!(void 0===e||!c.a(e,t))&&e&&!0===e.error})),J=Object(r.createSelector)((e=>e.nodeEventsInCategory),Q,(function(e,t){const{panelView:n}=t;return"nodeEventsInCategory"===n&&void 0===e})),X=Object(r.createSelector)((e=>e.nodeEventsInCategory),Q,(function(e,t){return!(void 0===e||!c.a(e,t))&&e&&null!==e.lastCursorRequested&&e.cursor===e.lastCursorRequested}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return S})),n.d(t,"b",(function(){return j}));var a=n(32),i=n(135),r=n(4),o=n.n(r),s=n(33),l=n.n(s),c=n(352),u=n(188),d=n(612),p=n(398),m=n(613),g=n(0);const f=g.i18n.translate("xpack.securitySolution.alertDetails.summary.readMore",{defaultMessage:"Read More"}),b=g.i18n.translate("xpack.securitySolution.alertDetails.summary.readLess",{defaultMessage:"Read Less"}),y=l()(a.EuiButtonEmpty).withConfig({displayName:"ReadMore",componentId:"sc-1bgugwj-0"})(["span.euiButtonContent{padding:0;}"]),h=l.a.div.withConfig({displayName:"ExpandedContent",componentId:"sc-1bgugwj-1"})(["max-height:33vh;overflow-wrap:break-word;overflow-x:hidden;overflow-y:auto;"]),v=l.a.div.withConfig({displayName:"StyledLineClamp",componentId:"sc-1bgugwj-2"})(["display:-webkit-box;-webkit-line-clamp:",";-webkit-box-orient:vertical;overflow:hidden;max-height:","em;height:","em;"],3,(({lineClampHeight:e})=>e),(({lineClampHeight:e})=>e)),E=({children:e,lineClampHeight:t=5.5})=>{const[n,a]=Object(r.useState)(null),[i,s]=Object(m.a)(e),l=Object(r.useCallback)((()=>{a((e=>!e))}),[]);return n?o.a.createElement(o.a.Fragment,null,o.a.createElement(h,{"data-test-subj":"expanded-line-clamp"},o.a.createElement("p",null,e)),i&&o.a.createElement(y,{onClick:l,size:"s","data-test-subj":"summary-view-readmore"},b)):o.a.createElement(o.a.Fragment,null,null==i||!0===i?o.a.createElement(v,{"data-test-subj":"styled-line-clamp",ref:s,lineClampHeight:t},e):e,i&&o.a.createElement(y,{onClick:l,size:"s","data-test-subj":"summary-view-readmore"},f))},x=o.a.memo(E),k=l.a.div.withConfig({displayName:"Indent",componentId:"sc-1d4zfzr-0"})(["padding:0 8px;word-break:break-word;"]),S=Object(r.createContext)({}),w=({data:e})=>{const t=Object(r.useMemo)((()=>{var t;const n=e.find((e=>"signal.rule.id"===e.field||e.field===i.L));return Array.isArray(null==n?void 0:n.originalValue)?null==n?void 0:n.originalValue[0]:null!==(t=null==n?void 0:n.originalValue)&&void 0!==t?t:null}),[e]),{rule:n}=Object(d.a)(t),s=Object(c.b)(e);return null!=n&&n.note?o.a.createElement(S.Provider,{value:s},o.a.createElement(a.EuiSpacer,{size:"l"}),o.a.createElement(a.EuiTitle,{size:"xxxs","data-test-subj":"summary-view-guide"},o.a.createElement("h5",null,u.j)),o.a.createElement(a.EuiSpacer,{size:"s"}),o.a.createElement(k,null,o.a.createElement(a.EuiText,{size:"xs"},o.a.createElement(x,{lineClampHeight:4.5},o.a.createElement(p.b,null,n.note))))):null},j=o.a.memo(w)},function(e,t,n){"use strict";n.d(t,"g",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return m})),n.d(t,"e",(function(){return g})),n.d(t,"i",(function(){return f})),n.d(t,"h",(function(){return b})),n.d(t,"f",(function(){return y}));var a=n(207),i=n(172),r=n(138);const o=(e,t,n)=>{const{pagination:a,search:i,filters:r}=n||{};let o=[],s=[];return Array.isArray(e)&&e.length?(o=e.map((e=>e.list_id)),s=e.map((e=>e.namespace_type))):t&&(o=[t.list_id],s=[t.namespace_type]),{listIds:o,namespaceTypes:s,pagination:a,search:i,filters:r}},s=async({namespaceTypes:e,listIds:t,http:n,pagination:r,search:o})=>{try{const s=new AbortController,{pageIndex:l,pageSize:c,totalItemCount:u}=r||{},{page:d,per_page:p,total:m,data:g}=await Object(a.l)({filter:void 0,http:n,listIds:null!=t?t:[],namespaceTypes:null!=e?e:[],search:o,pagination:{perPage:c,page:(l||0)+1,total:u},signal:s.signal});return{data:g.map((e=>Object(i.b)(e))),pagination:{pageIndex:d-1,pageSize:p,totalItemCount:m}}}catch(e){throw new Error(e)}},l=async e=>{try{const t=new AbortController,{references:n}=await Object(r.h)({lists:e.map((e=>({id:e.id,listId:e.list_id,namespaceType:e.namespace_type}))),signal:t.signal});return n.reduce(((e,t)=>({...e,...t})),{})}catch(e){throw new Error(e)}},c=async({id:e,namespaceType:t,http:n})=>{try{const i=new AbortController;await Object(a.e)({http:n,id:e,namespaceType:t,signal:i.signal})}catch(e){throw new Error(e)}};var u=n(245),d=n(56),p=n(139);const m=async({id:e,http:t})=>{try{const n=new AbortController,i=Object(u.f)({filters:{list_id:e},namespaceTypes:["single","agnostic"],hideLists:p.a}),r=["single","agnostic"].join(),{data:o}=await Object(a.k)({filters:i,http:t,signal:n.signal,namespaceTypes:r,pagination:{}});return n.abort(),o&&o.length?o[0]:null}catch(e){throw new Error(e)}},g=async e=>{try{const t=new AbortController,{data:n}=await Object(r.f)({signal:t.signal,pagination:{page:1,perPage:1e4}});return t.abort(),n.reduce(((t,n,a)=>{var i;return(null===(i=n.exceptions_list)||void 0===i?void 0:i.find((t=>t.list_id===e)))&&t.push(n),t}),[])}catch(e){throw new Error(e)}},f=async({list:e,http:t})=>{try{const n=new AbortController;await Object(a.t)({http:t,list:e,signal:n.signal}),n.abort()}catch(e){throw new Error(e)}},b=async({rules:e,listId:t})=>{try{if(!e.length)return;const n=new AbortController;await Object(d.asyncForEach)(e,(async e=>{var a;const i=(null!==(a=e.exceptions_list)&&void 0!==a?a:[]).filter((({list_id:e})=>e!==t));await Object(r.k)({ruleProperties:{rule_id:e.rule_id,exceptions_list:i},signal:n.signal})}))}catch(e){throw new Error(e)}},y=async({rules:e,listId:t,id:n,listType:a,listNamespaceType:i})=>{try{if(!e.length)return;const o=new AbortController;await Object(d.asyncForEach)(e,(async e=>{var s;const l={list_id:t,id:n,type:a,namespace_type:i},c=[...null!==(s=e.exceptions_list)&&void 0!==s?s:[],l];await Object(r.k)({ruleProperties:{rule_id:e.rule_id,exceptions_list:c},signal:o.signal})}))}catch(e){throw new Error(e)}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(4),i=n.n(a),r=n(33),o=n.n(r),s=n(32),l=n(77),c=n(35);const u=({handleClick:e})=>i.a.createElement(s.EuiFlexGroup,{justifyContent:"flexEnd"},i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(s.EuiButtonEmpty,{onClick:e,"data-test-subj":"osquery-empty-button"},i.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.footer.cancel",defaultMessage:"Cancel"})))),d=i.a.memo(u);var p=n(611);const m=o.a.div.withConfig({displayName:"OsqueryActionWrapper",componentId:"sc-18y9iwv-0"})(["padding:8px;"]),g=({agentId:e,defaultValues:t,onClose:n,ecsData:a})=>{const{services:{osquery:r}}=Object(l.k)();return null!=r&&r.OsqueryAction?i.a.createElement(s.EuiFlyout,{ownFocus:!0,maskProps:{style:"z-index: 5000"},size:"m",onClose:n},i.a.createElement(s.EuiFlyoutHeader,{hasBorder:!0,"data-test-subj":"flyout-header-osquery"},i.a.createElement(s.EuiTitle,null,i.a.createElement("h2",null,p.a))),i.a.createElement(s.EuiFlyoutBody,null,i.a.createElement(m,{"data-test-subj":"flyout-body-osquery"},i.a.createElement(r.OsqueryAction,{agentId:e,formType:"steps",defaultValues:t,ecsData:a}))),i.a.createElement(s.EuiFlyoutFooter,null,i.a.createElement(d,{handleClick:n,"data-test-subj":"flyout-footer-osquery"}))):null},f=i.a.memo(g)},function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return m})),n.d(t,"c",(function(){return g}));var a=n(144),i=n(162),r=n(513);const o=e=>{if(!e)return NaN;if("number"==typeof e)return e;let t=Date.parse(e);return Number.isNaN(t)&&(t=parseInt(e,10)),t},s=(e,t)=>{const n=o(e),a=o(t);if(Number.isNaN(n)||Number.isNaN(a))return;const i=a-n,r=36e5,s=24*r,l=7*s,c=30*s,u=365*s;let d,p,m;switch(!0){case i>=u:d=Math.floor(i/u),p="year",m="years";break;case i>=c:d=Math.floor(i/c),p="month",m="months";break;case i>=l:d=Math.floor(i/l),p="week",m="weeks";break;case i>=s:d=Math.floor(i/s),p="day",m="days";break;case i>=r:d=Math.floor(i/r),p="hour",m="hours";break;case i>=6e4:d=Math.floor(i/6e4),p="minute",m="minutes";break;case i>=1e3:d=Math.floor(i/1e3),p="second",m="seconds";break;case 0===i:d="<1",p="millisecond",m="millisecond";break;default:d=i,p="millisecond",m="milliseconds"}return{duration:d,durationType:1===d?p:m}};function l(e){const t=function(e){const t=new Map;if(0===r.e(e))return t;const n=[...r.c(e)].reverse();for(const i of n){const n=r.a(e,a.b(i)),o=n.reduce((function(e,n){var a;return e+(null!==(a=t.get(n))&&void 0!==a?a:0)}),0)+Math.max(0,n.length-1)*p;t.set(i,o)}return t}(e),n=function(e,t){const n=new Map;let a,r=0,o=0;for(const s of u(e,t))if(null===s.parent){const{node:e}=s;n.set(e,[0,0])}else{const{node:e,parent:t,isOnlyChild:l,width:c,parentWidth:u}=s;a!==t&&(r=0,o=0,a=t);const d=n.get(t);if(void 0===d)throw new Error;const m=u/-2+r*p+o+c/2;let g=-p;l||(g*=2);const f=i.a([m,g],d);n.set(e,f),r+=1,o+=c}return n}(e,t),o=function(e,t,n){const i=[];for(const o of u(e,t)){if(null===o.parent)continue;const{node:t,parent:l,parentWidth:c}=o,u=n.get(t),d=n.get(l),p=a.b(l),m=a.b(t);if(void 0===m)throw new Error("tried to graph a Resolver that had a node with without an id");const g=`edge:${null!=p?p:"undefined"}:${m}`;if(void 0===u||void 0===d)throw new Error;const f=a.a(l),b=a.a(t),y={elapsedTime:void 0!==f&&void 0!==b?s(f,b):void 0,reactKey:g},h=d[1]+(u[1]-d[1])/2,v={points:[[u[0],h],u],metadata:y},E=t===r.a(e,a.b(l))[0];if(o.isOnlyChild)i.push({points:[d,u],metadata:y});else if(E){const{firstChildWidth:e,lastChildWidth:t}=o,n={points:[d,[d[0],h]],metadata:{reactKey:`parentToMid${g}`}},a=c/-2+e/2,r=a+(c-e/2-t/2),s={points:[[d[0]+a,h],[d[0]+r,h]],metadata:{reactKey:`midway${g}`}};i.push(n,s,v)}else i.push(v)}return i}(e,t,n),l=[],m=new Map;for(const[e,t]of n)m.set(e,i.c(t,d));for(const e of o){const{points:[t,n]}=e,a={...e,points:[i.c(t,d),i.c(n,d)]};l.push(a)}return{processNodePositions:m,edgeLineSegments:l,ariaLevels:c(e)}}function c(e){const t=new Map;for(const n of r.c(e)){const a=r.d(e,n);if(void 0===a)t.set(n,1);else{const e=t.get(a);if(void 0===e)throw new Error("failed to calculate aria levels");t.set(n,e+1)}}return t}function*u(e,t){for(const n of r.c(e)){const i=r.d(e,n),o=t.get(n);if(void 0===o)throw new Error;if(void 0===i)yield{node:n,width:o,parent:null,parentWidth:null,isOnlyChild:null,firstChildWidth:null,lastChildWidth:null};else{const s=t.get(i);if(void 0===s)throw new Error;const l={node:n,width:o,parent:i,parentWidth:s},c=r.a(e,a.b(i));if(1===c.length)l.isOnlyChild=!0,l.lastChildWidth=o,l.firstChildWidth=o;else{const e=t.get(c[0]),n=t.get(c[c.length-1]);if(void 0===e||void 0===n)throw new Error;l.isOnlyChild=!1,l.firstChildWidth=e,l.lastChildWidth=n}yield l}}}const d=[Math.sqrt(2)/2,-Math.sqrt(2)/2,0,Math.sqrt(6)/6,Math.sqrt(6)/6,-Math.sqrt(6)/3,0,0,1],p=280;function m(e,t){for(const[n,i]of e.processNodePositions.entries())if(a.b(n)===t)return i}function g(e,t){return{processNodePositions:new Map([...e.processNodePositions.entries()].map((([e,n])=>[e,i.a(n,t)]))),edgeLineSegments:e.edgeLineSegments.map((({points:e,metadata:n})=>({points:[i.a(e[0],t),i.a(e[1],t)],metadata:n}))),ariaLevels:e.ariaLevels}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"e",(function(){return p})),n.d(t,"c",(function(){return m}));var a=n(342);function i({node:e,currentLevel:t,totalDescendants:n,children:a}){const r=a(e);if(r.length<=0)return{generations:t,descendants:n};let o=0,s=n;for(const e of r){const{generations:n,descendants:r}=i({node:e,currentLevel:t+1,totalDescendants:s+1,children:a});s=r,o=Math.max(o,n)}return{generations:o,descendants:s}}var r=n(144);function o(e,t){if(e)return i({node:e,currentLevel:0,totalDescendants:0,children:e=>{var n;return null!==(n=t.get(r.b(e)))&&void 0!==n?n:[]}})}function s(e,t){const n=r.d(e);return void 0===n?void 0:t.get(n)}function l(e,t){const n=new Map,i=new Map;for(const t of e){const e=r.b(t);if(void 0!==e){i.set(e,t);const a=r.d(t);let o=n.get(a);o||(o=[],n.set(a,o)),o.push(t)}}for(const e of n.values())e.sort(a.b);let l,c;if(t){const e=o(i.get(t),n);l=null==e?void 0:e.generations,c=null==e?void 0:e.descendants}const u=function(e,t){if(!e)return;let n=1,a=t.get(e);for(;void 0!==a&&void 0!==s(a,t);)n++,a=s(a,t);return n}(t,i);return{idToChildren:n,idToNode:i,originID:t,generations:l,descendants:c,ancestors:u}}function c(e,t){const n=e.idToChildren.get(t);return void 0===n?[]:n}function u(e,t){var n;return null!==(n=e.idToNode.get(t))&&void 0!==n?n:null}function d(e,t){return s(t,e.idToNode)}function p(e){return e.idToNode.size}function*m(e){const t=function(e){if(0===p(e))return null;let t=e.idToNode.values().next().value;for(;void 0!==d(e,t);)t=d(e,t);return t}(e);null!==t&&(yield*function*(e,t){let n=[e];for(;0!==n.length;){let e=[];for(const a of n)yield a,e.push(...t(a)||[]);n=e,e=[]}}(t,(t=>c(e,r.b(t)))))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return F}));var a=n(82),i=n.n(a),r=n(4),o=n.n(r),s=n(78),l=n(32),c=n(155),u=n(79),d=n(559),p=n(923),m=n(326),g=n(148),f=n(622),b=n(1),y=n(225),h=n(419),v=n(292),E=n(542),x=n(95),k=n(107),S=n(159),w=n(694),j=n(13),O=n(77);const I={meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:"event.kind",params:{query:"alert"}},query:{bool:{filter:[{bool:{should:[{match:{"event.kind":"alert"}}],minimum_should_match:1}}]}}};var T=n(568),C=n(267);const M="alertsOrEventsHistogramQuery",N="onlyExternalAlerts",D=({additionalFilters:e,deleteQuery:t,endDate:n,filterQuery:a,indexNames:C,setQuery:N,startDate:D,tableId:F})=>{const R=Object(s.useDispatch)(),{globalFullScreen:P}=Object(g.a)(),L=Object(k.a)("tGridEnabled"),[q]=Object(O.q)(b.Z),B=Object(j.b)().isEnterprise()?5:4,z=Object(r.useMemo)((()=>Object(h.a)(B)),[B]),$=A(),[V,U]=Object(r.useState)(null!=$&&$);_(V);const H=Object(r.useCallback)((()=>U((e=>!e))),[]),G=Object(r.useMemo)((()=>Object(y.d)(q,V)),[q,V]);Object(r.useEffect)((()=>{R(c.a.initializeTGridSettings({id:F,defaultColumns:p.a.columns.map((e=>L||null!=e.initialWidth?e:{...e,initialWidth:S.a})),title:f.e,showCheckboxes:!0,selectAll:!0}))}),[R,V,L,F]),Object(r.useEffect)((()=>()=>{t&&t({id:M})}),[t]);const Q=Object(r.useMemo)((()=>o.a.createElement(l.EuiCheckbox,{id:"showExternalAlertsCheckbox","data-test-subj":"showExternalAlertsCheckbox","aria-label":f.h,checked:V,color:"text",label:f.h,onChange:H})),[V,H]),W=Object(r.useMemo)((()=>({...p.a,excludedRowRendererIds:V?Object.values(u.d):[]})),[V]),K=Object(r.useMemo)((()=>V?[I,...e]:e),[e,V]),Y=Object(T.a)({localFilters:K,tableId:F,from:D,to:n,scopeId:x.SourcererScopeName.default}),J=Object(r.useMemo)((()=>({alertStatusActions:!1,customBulkActions:[Y]})),[Y]);return o.a.createElement(o.a.Fragment,null,!P&&o.a.createElement(m.a,i()({id:M,startDate:D,endDate:n,filterQuery:a,indexNames:C,setQuery:N},V?y.a:y.b,{subtitle:G})),o.a.createElement(d.a,{additionalFilters:Q,defaultCellActions:w.a,start:D,end:n,entityType:"events",leadingControlColumns:z,renderCellValue:E.a,rowRenderers:v.b,scopeId:x.SourcererScopeName.default,tableId:F,unit:V?f.b:f.f,defaultModel:W,pageFilters:K,bulkActions:J}))};D.displayName="EventsQueryTabBodyComponent";const F=o.a.memo(D);F.displayName="EventsQueryTabBody";const A=()=>{const e=Object(C.h)(),t=Object(C.g)(N),{decodedParam:n}=Object(r.useMemo)((()=>t()),[t]);return Object(r.useEffect)((()=>()=>{e([{key:N,value:null}])}),[e]),n},_=e=>{const t=Object(C.h)();Object(r.useEffect)((()=>{t([{key:N,value:e?"true":null}])}),[e,t])}},function(e,t,n){"use strict";n.d(t,"b",(function(){return m})),n.d(t,"c",(function(){return g})),n.d(t,"a",(function(){return b}));var a=n(32),i=n(4),r=n.n(i),o=n(33),s=n.n(o),l=n(88),c=n(89),u=n(0);const d=u.i18n.translate("xpack.securitySolution.certificate.fingerprint.clientCertLabel",{defaultMessage:"client cert"}),p=u.i18n.translate("xpack.securitySolution.certificate.fingerprint.serverCertLabel",{defaultMessage:"server cert"}),m="tls.client_certificate.fingerprint.sha1",g="tls.server_certificate.fingerprint.sha1",f=s.a.span.withConfig({displayName:"FingerprintLabel",componentId:"sc-196xyd5-0"})(["margin-right:5px;"]);f.displayName="FingerprintLabel";const b=r.a.memo((({eventId:e,certificateType:t,contextId:n,fieldName:i,isDraggable:o,value:s})=>r.a.createElement(l.c,{contextId:n,"data-test-subj":`${t}-certificate-fingerprint`,eventId:e,field:i,iconType:"snowflake",isDraggable:o,tooltipContent:r.a.createElement(a.EuiText,{size:"xs"},r.a.createElement("span",null,i)),value:s,isAggregatable:!0,fieldType:"keyword"},r.a.createElement(f,null,"client"===t?d:p),r.a.createElement(c.b,{certificateFingerprint:s||""}))));b.displayName="CertificateFingerprint"},function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return p}));var a=n(4),i=n.n(a),r=n(33),o=n.n(r),s=n(88),l=n(89);const c=n(0).i18n.translate("xpack.securitySolution.ja3.fingerprint.ja3.fingerprintLabel",{defaultMessage:"ja3"}),u="tls.fingerprints.ja3.hash",d=o.a.span.withConfig({displayName:"Ja3FingerprintLabel",componentId:"sc-134zbkz-0"})(["margin-right:5px;"]);d.displayName="Ja3FingerprintLabel";const p=i.a.memo((({contextId:e,eventId:t,fieldName:n,isDraggable:a,value:r})=>i.a.createElement(s.c,{contextId:e,"data-test-subj":"ja3-hash",eventId:t,field:n,iconType:"snowflake",isDraggable:a,value:r,isAggregatable:!0,fieldType:"keyword"},i.a.createElement(d,null,c),i.a.createElement(l.e,{"data-test-subj":"ja3-hash-link",ja3Fingerprint:r||""}))));p.displayName="Ja3Fingerprint"},function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n(4),i=n.n(a),r=n(33),o=n.n(r),s=n(32),l=n(0);const c=l.i18n.translate("xpack.securitySolution.rule_exceptions.itemComments.unknownAvatarName",{defaultMessage:"Uknown"}),u=l.i18n.translate("xpack.securitySolution.rule_exceptions.itemComments.addCommentPlaceholder",{defaultMessage:"Add a new comment..."});var d=n(77),p=n(190);const m="exceptionCommentAccordionButton",g=o()(s.EuiAvatar).withConfig({displayName:"MyAvatar",componentId:"sc-iqe126-0"})(["",""],(({theme:e})=>Object(r.css)(["margin-right:",";"],e.eui.euiSizeS))),f=o()(s.EuiAccordion).withConfig({displayName:"CommentAccordion",componentId:"sc-iqe126-1"})(["",""],(({theme:e})=>Object(r.css)([".","{color:",";padding:"," 0;}"],m,e.eui.euiColorPrimary,e.eui.euiSizeM))),b=Object(a.memo)((function({exceptionItemComments:e,newCommentValue:t,accordionTitle:n,newCommentOnChange:r}){const[o,b]=Object(a.useState)(!1),y=Object(d.g)(),h=null==y?void 0:y.fullName,v=null==y?void 0:y.username,E=null==y?void 0:y.email,x=Object(a.useMemo)((()=>h&&h.length>0?h:E&&E.length>0?E:v&&v.length>0?v:c),[h,E,v]),k=Object(a.useCallback)((e=>{r(e.target.value)}),[r]),S=Object(a.useCallback)((e=>{b(e)}),[]),w=Object(a.useMemo)((()=>{return e&&e.length>0?i.a.createElement(s.EuiText,{size:"s","data-test-subj":"ExceptionItemCommentsAccordionButton"},o?(e=>l.i18n.translate("xpack.securitySolution.rule_exceptions.itemComments.hideCommentsLabel",{values:{comments:e},defaultMessage:"Hide ({comments}) {comments, plural, =1 {Comment} other {Comments}}"}))(e.length):(t=e.length,l.i18n.translate("xpack.securitySolution.rule_exceptions.itemComments.showCommentsLabel",{values:{comments:t},defaultMessage:"Show ({comments}) {comments, plural, =1 {Comment} other {Comments}}"}))):null;var t}),[o,e]),j=Object(a.useMemo)((()=>e&&e.length>0?Object(p.j)(e):[]),[e]);return i.a.createElement("div",null,i.a.createElement(f,{id:"add-exception-comments-accordion",buttonClassName:m,buttonContent:null!=n?n:w,"data-test-subj":"exceptionItemCommentsAccordion",onToggle:e=>S(e)},i.a.createElement(s.EuiCommentList,{comments:j}),i.a.createElement(s.EuiFlexGroup,{gutterSize:"none"},i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(g,{name:x,size:"l","data-test-subj":"exceptionItemCommentAvatar"})),i.a.createElement(s.EuiFlexItem,{grow:1},i.a.createElement(s.EuiTextArea,{placeholder:u,"aria-label":"Comment Input",value:t,onChange:k,fullWidth:!0,"data-test-subj":"newExceptionItemCommentTextArea"})))))}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(4),i=n(84),r=n(17),o=n(507),s=n(0);const l=s.i18n.translate("xpack.securitySolution.components.mlPopup.hooks.errors.startJobFailureTitle",{defaultMessage:"Start job failure"}),c=s.i18n.translate("xpack.securitySolution.components.mlPopup.hooks.errors.stopJobFailureTitle",{defaultMessage:"Stop job failure"}),u=s.i18n.translate("xpack.securitySolution.components.mlPopup.hooks.errors.createJobFailureTitle",{defaultMessage:"Create job failure"}),d=()=>{const{addError:e}=Object(i.a)(),[t,n]=Object(a.useState)(!1);return{enableDatafeed:Object(a.useCallback)((async(t,a,i)=>{if(p(t,i),!t.isInstalled){n(!0);try{await Object(o.c)({configTemplate:t.moduleId,indexPatternName:t.defaultIndexPattern,jobIdErrorFilter:[t.id],groups:t.groups}),n(!1)}catch(t){return e(t,{title:u}),void n(!1)}}const s=new Date,d=s.setDate(s.getDate()-14);if(n(!0),i){const n=Math.max(a,d);try{await Object(o.d)({datafeedIds:[`datafeed-${t.id}`],start:n})}catch(t){Object(r.e)(r.a.COUNT,r.b.JOB_ENABLE_FAILURE),e(t,{title:l})}}else try{await Object(o.e)({datafeedIds:[`datafeed-${t.id}`]})}catch(t){Object(r.e)(r.a.COUNT,r.b.JOB_DISABLE_FAILURE),e(t,{title:c})}n(!1)}),[e]),isLoading:t}},p=(e,t)=>{Object(r.e)(r.a.COUNT,e.isElasticJob?t?r.b.SIEM_JOB_ENABLED:r.b.SIEM_JOB_DISABLED:t?r.b.CUSTOM_JOB_ENABLED:r.b.CUSTOM_JOB_DISABLED)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return E})),n.d(t,"b",(function(){return x}));var a=n(4),i=n(1),r=n(131),o=n(2),s=n(156),l=n(17),c=n(238),u=n(39),d=n(138),p=n(569),m=n(392),g=n(570),f=n(338);const b=["POST",i.nb];var y=n(496),h=n(681),v=n(682);const E=(e,t)=>{t(i.B,{deepLinkId:o.a.rules,path:Object(s.b)(null!=e?e:"")})},x=e=>{const{mutateAsync:t}=(e=>{const t=Object(m.b)(),n=Object(f.b)(),a=Object(g.b)(),i=Object(p.b)(),o=Object(m.c)();return Object(u.useMutation)((e=>Object(d.l)(e)),{...e,mutationKey:b,onSettled:(...e)=>{var s,l,c,u,d,p;const[m,g,{bulkAction:{type:f}}]=e,b=null!==(s=null==m||null===(l=m.attributes)||void 0===l||null===(c=l.results)||void 0===c?void 0:c.updated)&&void 0!==s?s:null==g||null===(u=g.body)||void 0===u||null===(d=u.attributes)||void 0===d||null===(p=d.results)||void 0===p?void 0:p.updated;switch(f){case r.b.enable:case r.b.disable:n(),b?o(b):t();break;case r.b.delete:t(),n(),a(),i();break;case r.b.duplicate:t(),i();break;case r.b.edit:b?o(b):t(),n(),a()}}})})(),n=Object(h.a)(),i=Object(y.a)(),o=Object(v.a)(),s=Object(c.c)(),E=null==s?void 0:s.actions.setLoadingRules;return{executeBulkAction:Object(a.useCallback)((async a=>{try{var s;null==E||E({ids:null!==(s=a.ids)&&void 0!==s?s:o(a.type),action:a.type});const i=await t({bulkAction:a});return function(e,t){e!==r.b.disable&&e!==r.b.enable||(t.attributes.results.updated.some((e=>e.immutable))&&Object(l.e)(l.a.COUNT,e===r.b.enable?l.b.SIEM_RULE_ENABLED:l.b.SIEM_RULE_DISABLED),t.attributes.results.updated.some((e=>!e.immutable))&&Object(l.e)(l.a.COUNT,e===r.b.disable?l.b.CUSTOM_RULE_DISABLED:l.b.CUSTOM_RULE_ENABLED))}(a.type,i),null!=e&&e.suppressSuccessToast||n({actionType:a.type,summary:i.attributes.summary,editPayload:a.type===r.b.edit?a.editPayload:void 0}),i}catch(e){i({actionType:a.type,error:e})}finally{null==E||E({ids:[],action:null})}}),[null==e?void 0:e.suppressSuccessToast,o,E,t,n,i])}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return O})),n.d(t,"a",(function(){return I}));var a=n(92),i=n.n(a),r=n(34),o=n(4),s=n(78),l=n(11),c=n(42),u=n(77),d=n(126),p=n(86),m=n(614),g=n(99),f=n(85);const b=n(0).i18n.translate("xpack.securitySolution.timelineEvents.errorSearchDescription",{defaultMessage:"An error has occurred on timeline events search"});var y=n(79),h=n(183),v=n(228),E=n(84),x=n(231),k=n(1);const S="timelineEventsQuery",w=[{field:"@timestamp",direction:f.b.asc,type:"date",esTypes:["date"]}],j=e=>({...Object(r.isEmpty)(null==e?void 0:e.eventCategoryField)?{}:{eventCategoryField:null==e?void 0:e.eventCategoryField},...Object(r.isEmpty)(null==e?void 0:e.size)?{}:{size:null==e?void 0:e.size},...Object(r.isEmpty)(null==e?void 0:e.tiebreakerField)?{}:{tiebreakerField:null==e?void 0:e.tiebreakerField},...Object(r.isEmpty)(null==e?void 0:e.timestampField)?{}:{timestampField:null==e?void 0:e.timestampField}}),O=({dataViewId:e,endDate:t,eqlOptions:n,id:a=S,indexNames:O,fields:I,filterQuery:T,runtimeMappings:C,startDate:M,language:N="kuery",limit:D,sort:F=w,skip:A=!1,timerangeKind:_})=>{const[{pageName:R}]=Object(h.a)(),P=Object(s.useDispatch)(),{data:L}=Object(u.k)().services,q=Object(o.useRef)(r.noop),B=Object(o.useRef)(new AbortController),z=Object(o.useRef)(new l.Subscription),[$,V]=Object(o.useState)(!1),[U,H]=Object(o.useState)(a===y.j.active?v.a.getActivePage():0),[G,Q]=Object(o.useState)(null),W=Object(o.useRef)(null),{startTracking:K}=Object(x.a)(),Y=Object(o.useCallback)((()=>{null!=a&&m.a.some((e=>e===a))&&(P(p.a.clearEventsLoading({id:a})),P(p.a.clearEventsDeleted({id:a})))}),[P,a]),J=Object(o.useCallback)((e=>{Y(),a===y.j.active&&(v.a.setExpandedDetail({}),v.a.setActivePage(e)),H(e)}),[Y,a]),X=Object(o.useCallback)((()=>{null!=q.current&&q.current(),J(0)}),[J]),Z=Object(o.useCallback)((e=>{P(p.a.setTimelineUpdatedAt({id:a,updated:e}))}),[P,a]),[ee,te]=Object(o.useState)({id:a,inspect:{dsl:[],response:[]},refetch:X,totalCount:-1,pageInfo:{activePage:0,querySize:0},events:[],loadPage:J,updatedAt:0}),{addWarning:ne}=Object(E.a)(),ae=Object(o.useCallback)((async(t,n)=>{if(null==t||""===R||A)return;const i=async()=>{W.current=t,B.current=new AbortController,V(!0);const{endTracking:i}=K({name:`${k.B} timeline events search`});z.current=L.search.search(t,{strategy:"eql"===t.language?"timelineEqlSearchStrategy":"timelineSearchStrategy",abortSignal:B.current.signal,indexPattern:{id:e}}).subscribe({next:e=>{Object(c.isCompleteResponse)(e)?(i("success"),V(!1),te((i=>{const r={...i,events:(o=e.edges,o.map((e=>e.node))),inspect:Object(g.getInspectResponse)(e,i.inspect),pageInfo:e.pageInfo,totalCount:e.totalCount,updatedAt:Date.now()};var o;return Z(r.updatedAt),a===y.j.active&&(v.a.setExpandedDetail({}),v.a.setPageName(R),"eql"===t.language?(v.a.setEqlRequest(t),v.a.setEqlResponse(r)):(v.a.setRequest(t),v.a.setResponse(r))),n&&n(r),r})),z.current.unsubscribe()):Object(c.isErrorResponse)(e)&&(i("invalid"),V(!1),ne(b),z.current.unsubscribe())},error:e=>{i(B.current.signal.aborted?"aborted":"error"),V(!1),L.search.showError(e),z.current.unsubscribe()}})};if(a===y.j.active&&""!==v.a.getPageName()&&R!==v.a.getPageName()){if(v.a.setPageName(R),B.current.abort(),V(!1),"eql"===t.language?(W.current=v.a.getEqlRequest(),q.current=i.bind(null,v.a.getEqlRequest())):(W.current=v.a.getRequest(),q.current=i.bind(null,v.a.getRequest())),te((e=>{const n="eql"===t.language?v.a.getEqlResponse():v.a.getResponse();return null!=n?{...n,refetch:X,loadPage:J}:e})),"eql"!==t.language&&null!=v.a.getResponse())return;if("eql"===t.language&&null!=v.a.getEqlResponse())return}z.current.unsubscribe(),B.current.abort(),await i(),q.current=i}),[R,A,a,K,L.search,e,Z,ne,X,J]);Object(o.useEffect)((()=>{0!==O.length&&Q((e=>{var r,o,s,l,c,u;const p=e,m={defaultIndex:null!==(r=null==e?void 0:e.defaultIndex)&&void 0!==r?r:[],filterQuery:null!==(o=null==e?void 0:e.filterQuery)&&void 0!==o?o:"",querySize:null!==(s=null==e?void 0:e.pagination.querySize)&&void 0!==s?s:0,sort:null!==(l=null==e?void 0:e.sort)&&void 0!==l?l:w,timerange:null!==(c=null==e?void 0:e.timerange)&&void 0!==c?c:{},runtimeMappings:null!==(u=null==e?void 0:e.runtimeMappings)&&void 0!==u?u:{},...j(p)},g=M&&t?{timerange:{interval:"12h",from:M,to:t}}:{},b={defaultIndex:O,filterQuery:Object(d.a)(T),querySize:D,sort:F,runtimeMappings:C,...g,...j(n)},h=i()(m,b)?U:0,E={defaultIndex:O,factoryQueryType:f.z.all,fieldRequested:I,fields:I,filterQuery:Object(d.a)(T),pagination:{activePage:h,querySize:D},language:N,runtimeMappings:C,sort:F,...g,...n||{}};return U!==h&&(H(h),a===y.j.active&&v.a.setActivePage(h)),i()(e,E)?e:E}))}),[P,O,U,t,n,T,a,N,D,M,F,I,C]);const ie=Object(o.useCallback)((async e=>{a===y.j.active&&"absolute"!==_&&i()(W.current,G)||await ae(G,e)}),[a,G,ae,_]);return Object(o.useEffect)((()=>{Object(r.isEmpty)(T)&&te({id:a,inspect:{dsl:[],response:[]},refetch:X,totalCount:-1,pageInfo:{activePage:0,querySize:0},events:[],loadPage:J,updatedAt:0})}),[T,a,X,J]),[$,ee,ie]},I=({dataViewId:e,endDate:t,eqlOptions:n,id:a=S,indexNames:i,fields:r,filterQuery:s,runtimeMappings:l,startDate:c,language:u="kuery",limit:d,sort:p=w,skip:m=!1,timerangeKind:g})=>{const[f,b,y]=O({dataViewId:e,endDate:t,eqlOptions:n,id:a,indexNames:i,fields:r,filterQuery:s,runtimeMappings:l,startDate:c,language:u,limit:d,sort:p,skip:m,timerangeKind:g});return Object(o.useEffect)((()=>{y&&y()}),[y]),[f,b]}},,,function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));var a=n(93),i=n(110);const r=["item_id","name","description","entries.value"],o={name:i.i,namespace_type:"agnostic",description:i.g,list_id:i.h,type:a.b.ENDPOINT_HOST_ISOLATION_EXCEPTIONS}},,,,,function(e,t,n){t.set=t.assoc=t.assocPath=n(745),t.setWith=n(809)},function(e,t,n){"use strict";n.d(t,"d",(function(){return l})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return d}));var a=n(4),i=n.n(a),r=n(287);const o=Object(r.c)(),s=Object(r.c)(),l=()=>{const[e]=Object(a.useState)(o);return{portalNode:e}},c=i.a.memo((()=>{const{portalNode:e}=l();return i.a.createElement(r.b,{node:e})}));c.displayName="TimelineEventsCountBadge";const u=()=>{const[e]=Object(a.useState)(s);return{portalNode:e}},d=i.a.memo((()=>{const{portalNode:e}=u();return i.a.createElement(r.b,{node:e})}));d.displayName="EqlEventsCountBadge"},function(e,t,n){"use strict";n.d(t,"a",(function(){return y})),n.d(t,"b",(function(){return v}));var a=n(32),i=n(4),r=n.n(i),o=n(33),s=n.n(o),l=n(90),c=n(546),u=n(554),d=n(556),p=n(862),m=n(863),g=n(864),f=n(194);const b=s.a.div.withConfig({displayName:"Wrapper",componentId:"sc-1gqlwr5-0"})(["&.viz-actions{position:absolute;top:0;right:0;z-index:1;}&.histogram-viz-actions{padding:",";}"],(({theme:e})=>e.eui.euiSizeS)),y="histogram-actions-trigger",h=({className:e,getLensAttributes:t,inputId:n=l.a.global,inspectIndex:o=0,isInspectButtonDisabled:s,isMultipleQuery:h,lensAttributes:v,onCloseInspect:E,queryId:x,timerange:k,title:S,stackByField:w})=>{const{lens:j}=Object(c.b)().services,{canUseEditor:O,navigateToPrefilledEditor:I}=j,[T,C]=Object(i.useState)(!1),[M,N]=Object(i.useState)(!1),D=Object(i.useCallback)((()=>{C(!T)}),[T]),F=()=>{C(!1)},A=Object(p.a)({lensAttributes:v,getLensAttributes:t,stackByField:w}),_=`stat-${x}`,{disabled:R,onAddToExistingCaseClicked:P}=Object(m.a)({onAddToCaseClicked:F,lensAttributes:A,timeRange:k}),{onAddToNewCaseClicked:L,disabled:q}=Object(g.a)({onClick:F,timeRange:k,lensAttributes:A}),B=Object(i.useCallback)((()=>{F(),k&&A&&I({id:"",timeRange:k,attributes:A},{openInNewTab:!0})}),[A,I,k]),z=Object(i.useCallback)((()=>{F(),N(!0)}),[]),$=Object(i.useCallback)((()=>{N(!1),E&&E()}),[E]),{additionalRequests:V,additionalResponses:U,handleClick:H,handleCloseModal:G,isButtonDisabled:Q,request:W,response:K}=Object(d.a)({inputId:n,inspectIndex:o,isDisabled:s,multiple:h,onCloseInspect:$,onClick:z,queryId:x}),Y=Object(i.useMemo)((()=>!O()||null==A),[A,O]),J=Object(i.useMemo)((()=>[r.a.createElement(a.EuiContextMenuItem,{icon:"inspect",key:"visualizationActionsInspect",onClick:H,disabled:Q,"data-test-subj":"viz-actions-inspect"},f.i),r.a.createElement(a.EuiContextMenuItem,{icon:"visArea",key:"visualizationActionsOpenInLens","data-test-subj":"viz-actions-open-in-lens",disabled:Y,onClick:B},f.k),r.a.createElement(a.EuiContextMenuItem,{disabled:q,icon:"plusInCircle",key:"visualizationActionsAddToNewCase",onClick:L,"data-test-subj":"viz-actions-add-to-new-case"},f.c),r.a.createElement(a.EuiContextMenuItem,{disabled:R,"data-test-subj":"viz-actions-add-to-existing-case",icon:"plusInCircle",key:"visualizationActionsAddToExistingCase",onClick:P},f.b)]),[Q,Y,H,R,q,P,L,B]),X=Object(i.useMemo)((()=>r.a.createElement(a.EuiButtonIcon,{"aria-label":f.j,className:y,"data-test-subj":_,iconType:"boxesHorizontal",onClick:D})),[_,D]);return r.a.createElement(b,{className:e},null!==W&&null!==K&&r.a.createElement(a.EuiPopover,{button:X,isOpen:T,closePopover:F,panelPaddingSize:"none",anchorPosition:"downLeft",panelClassName:"withHoverActions__popover"},r.a.createElement(a.EuiContextMenuPanel,{"data-test-subj":"viz-actions-panel",size:"s",items:J})),M&&null!==W&&null!==K&&r.a.createElement(u.a,{additionalRequests:V,additionalResponses:U,closeModal:G,inputId:n,request:W,response:K,title:S}))};h.displayName="VisualizationActionsComponent";const v=r.a.memo(h)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return r})),n.d(t,"c",(function(){return o}));const a="kibana.alert.rule.name",i="host.name",r=300,o=500},function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c}));var a=n(4),i=n(37),r=n(94),o=n(175);const s=({setQuery:e,response:t,request:n,refetch:i,uniqueQueryId:r,deleteQuery:o,loading:s})=>{Object(a.useEffect)((()=>(null!=i&&null!=e&&e({id:r,inspect:{dsl:[n],response:[t]},loading:s,refetch:i}),()=>{o&&o({id:r})})),[e,s,t,n,i,r,o])};function l(e){const t=[];for(const[n,a]of Object.entries(e))!0===a.aggregatable&&t.push({label:n,value:n});return t}const c=()=>{const{pathname:e}=Object(i.useLocation)(),{browserFields:t}=Object(r.d)(Object(r.a)(e)),n=Object(a.useMemo)((()=>Object(o.a)(t)),[t]),[s,c]=Object(a.useState)((()=>l(n)));return Object(a.useEffect)((()=>{c(l(n))}),[n]),Object(a.useMemo)((()=>s),[s])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=e=>`${e.entityName}-${e.entityValue}-${e.severity}-${e.jobId}`},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=async({http:e,jobIds:t,signal:n})=>e.fetch("/api/ml/jobs/jobs_summary",{method:"POST",body:JSON.stringify({jobIds:null!=t?t:[]}),asSystemRequest:!0,signal:n})},function(e,t,n){"use strict";n.d(t,"d",(function(){return p})),n.d(t,"c",(function(){return m})),n.d(t,"f",(function(){return g})),n.d(t,"e",(function(){return f})),n.d(t,"b",(function(){return b})),n.d(t,"a",(function(){return h}));var a=n(166),i=n(296),r=n(156),o=n(113),s=n(2),l=n(1),c=n(167),u=n(374),d=n(310);const p=[c.b.defineRule,c.b.aboutRule,c.b.scheduleRule,c.b.ruleActions],m=(e,t)=>{var n,a,i;let c=[];var d,p,m;return e.detailName&&null!==(n=e.state)&&void 0!==n&&n.ruleName&&(c=[...c,{text:e.state.ruleName,href:t({deepLinkId:s.a.rules,path:Object(r.d)(e.detailName,"")})}]),e.detailName&&null!==(a=e.state)&&void 0!==a&&a.ruleName&&e.tabName&&(c=[...c,{text:(d=e.tabName,null!==(p=u.a[d])&&void 0!==p?p:u.a[u.b.alerts]),href:t({deepLinkId:s.a.rules,path:Object(r.c)(e.detailName,e.tabName,"")})}]),(m=e.pathName).includes(l.lc)&&m.includes("/create")&&(c=[...c,{text:o.e,href:""}]),(e=>e.includes(l.lc)&&e.includes("/edit"))(e.pathName)&&e.detailName&&null!==(i=e.state)&&void 0!==i&&i.ruleName&&(c=[...c,{text:o.Ab,href:""}]),c},g={anomalyThreshold:50,index:[],indexPattern:{fields:[],title:""},machineLearningJobId:[],ruleType:"query",threatIndex:[],queryBar:{query:{query:"",language:"kuery"},filters:[],saved_id:null},threatQueryBar:{query:{query:l.fb,language:"kuery"},filters:[],saved_id:null},requiredFields:[],relatedIntegrations:[],threatMapping:[],threshold:{field:[],value:"200",cardinality:{field:[],value:""}},timeline:{id:null,title:i.b},eqlOptions:{},dataSourceType:c.a.IndexPatterns,newTermsFields:[],historyWindowSize:"7d",shouldLoadQueryDynamically:!1,groupByFields:[]},f={author:[],name:"",description:"",isAssociatedToEndpointList:!1,isBuildingBlock:!1,severity:{value:"low",mapping:Object(d.b)([]),isMappingChecked:!1},riskScore:{value:21,mapping:[],isMappingChecked:!1},references:[""],falsePositives:[""],license:"",ruleNameOverride:"",tags:[],timestampOverride:"",threat:[{framework:"MITRE ATT&CK",tactic:{id:"none",name:"none",reference:"none"},technique:[]}],note:"",threatIndicatorPath:void 0,timestampOverrideFallbackDisabled:void 0},b=e=>({interval:Object(a.f)(e)?"1h":"5m",from:Object(a.f)(e)?"5m":"1m"}),y={...g.queryBar,query:{...g.queryBar.query,query:"*:*"}},h={forNormalRules:g.queryBar,forThreatMatchRules:y}},function(e,t,n){"use strict";let a;n.d(t,"a",(function(){return a})),function(e){e.withExceptions="withExceptions",e.withoutExceptions="withoutExceptions"}(a||(a={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(82),i=n.n(a),r=n(4),o=n.n(r),s=n(35),l=n(32),c=n(33),u=n.n(c),d=n(243);const p=u()(l.EuiButtonEmpty).withConfig({displayName:"EuiButtonEmptyStyled",componentId:"sc-mu7mbz-0"})(["margin-bottom:",";.euiIcon{width:",";height:",";}.text{font-size:",";margin-inline-start:",";}"],(({theme:e})=>e.eui.euiSizeS),(({theme:e})=>e.eui.euiSizeM),(({theme:e})=>e.eui.euiSizeM),(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.euiSizeXS)),m=Object(r.memo)((({backButtonLabel:e,backButtonUrl:t,onBackButtonNavigateTo:n,...a})=>{const r=Object(d.a)(...n);return o.a.createElement(p,i()({"data-test-subj":"backToOrigin"},a,{flush:"left",size:"xs",iconType:"arrowLeft",href:t,onClick:r,textProps:{className:"text"}}),e||o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.list.backButton",defaultMessage:"Back"}))}));m.displayName="BackToExternalAppButton"},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(4),i=n.n(a),r=n(248),o=n(325);const s=i.a.memo((({influencers:e,startDate:t,endDate:n,children:a,criteriaFields:s,skip:l})=>{const{jobIds:c}=Object(r.b)(),[u,d]=Object(o.a)({criteriaFields:s,influencers:e,startDate:t,endDate:n,skip:l,jobIds:c,aggregationInterval:"auto"});return i.a.createElement(i.a.Fragment,null,a({isLoadingAnomaliesData:u,anomaliesData:d}))}));s.displayName="AnomalyTableProvider"},function(e,t,n){"use strict";n.d(t,"b",(function(){return ce})),n.d(t,"a",(function(){return de}));var a=n(82),i=n.n(a),r=n(4),o=n.n(r),s=n(57),l=n(78),c=n(12),u=n(133),d=n(284),p=n(33),m=n.n(p);const g=m.a.div.attrs((({width:e})=>{if(e)return{style:{width:`${e}px`}}})).withConfig({displayName:"Field",componentId:"sc-11dh2wt-0"})(["background-color:",";border:",";box-shadow:0 2px 2px -1px ",",0 1px 5px -2px ",";font-size:",";font-weight:",";line-height:",";padding:",";"],(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiBorderThin),(({theme:e})=>Object(d.rgba)(e.eui.euiColorMediumShade,.3)),(({theme:e})=>Object(d.rgba)(e.eui.euiColorMediumShade,.3)),(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.euiFontWeightSemiBold),(({theme:e})=>e.eui.euiLineHeight),(({theme:e})=>e.eui.euiSizeXS));g.displayName="Field";const f=o.a.memo((({fieldId:e,fieldWidth:t})=>o.a.createElement(g,{"data-test-subj":"field",width:t},e)));f.displayName="DraggableFieldBadge";var b=n(102),y=n(141),h=n(32),v=n(943),E=n(83),x=n(159),k=n(79),S=n(85),w=n(123),j=n(34),O=n(45),I=n(81),T=n(86),C=n(340);const M=o.a.memo((({columnId:e,onColumnRemoved:t})=>{const n=Object(r.useCallback)((n=>{n.preventDefault(),n.stopPropagation(),t(e)}),[e,t]);return o.a.createElement(h.EuiButtonIcon,{"aria-label":C.f,color:"text","data-test-subj":"remove-column",iconType:"cross",onClick:n})}));M.displayName="CloseButton";const N=o.a.memo((({header:e,onColumnRemoved:t,sort:n,isLoading:a})=>o.a.createElement(o.a.Fragment,null,n.some((t=>t.columnId===e.id))&&a?o.a.createElement(y.d,{className:"siemEventsHeading__extra--loading"},o.a.createElement(y.h,{"data-test-subj":"timeline-loading-spinner"})):o.a.createElement(y.d,{className:"siemEventsHeading__extra--close"},o.a.createElement(M,{columnId:e.id,onColumnRemoved:t})))));N.displayName="Actions";const D=m()(h.EuiFieldText).withConfig({displayName:"FieldText",componentId:"sc-xd12j6-0"})(["min-width:",";"],(e=>e.minwidth));D.displayName="FieldText";const F=o.a.memo((({columnId:e,minWidth:t,filter:n="",onFilterChange:a=j.noop,placeholder:i="Filter"})=>o.a.createElement(D,{"data-test-subj":"textFilter",minwidth:`${t}px`,placeholder:i,value:n,onChange:t=>{a({columnId:e,filter:t.target.value})}})));F.displayName="TextFilter";const A=o.a.memo((({header:e,onFilterChange:t=j.noop})=>{var n;return"text-filter"===e.columnHeaderType?o.a.createElement(F,{columnId:e.id,minWidth:null!==(n=e.initialWidth)&&void 0!==n?n:x.a,onFilterChange:t,placeholder:e.placeholder}):null}));A.displayName="Filter";const _=({header:e,sort:t})=>t.reduce(((t,n)=>e.id===n.columnId?n.sortDirection:t),"none"),R=({header:e,sort:t})=>t.findIndex((t=>t.columnId===e.id));var P=n(203),L=n(254);const q=o.a.memo((({sortNumber:e})=>e>=0?o.a.createElement(h.EuiNotificationBadge,{color:"subdued","data-test-subj":"sortNumber"},e+1):o.a.createElement(h.EuiIcon,{"data-test-subj":"sortEmptyNumber",type:"empty"})));var B;q.displayName="SortNumber",function(e){e.SORT_UP="sortUp",e.SORT_DOWN="sortDown"}(B||(B={}));const z=o.a.memo((({sortDirection:e,sortNumber:t})=>{const n=(e=>{switch(e){case S.b.asc:return B.SORT_UP;case S.b.desc:return B.SORT_DOWN;case"none":return;default:throw new Error("Unhandled sort direction")}})(e);return null!=n?o.a.createElement(h.EuiToolTip,{content:n===B.SORT_UP?L.o:L.p,"data-test-subj":"sort-indicator-tooltip"},o.a.createElement(o.a.Fragment,null,o.a.createElement(h.EuiIcon,{"data-test-subj":"sortIndicator",type:n}),o.a.createElement(q,{sortNumber:t}))):o.a.createElement(h.EuiIcon,{"data-test-subj":"sortIndicator",type:"empty"})}));z.displayName="SortIndicator";var $=n(182);const V=m()(h.EuiIcon).withConfig({displayName:"IconType",componentId:"sc-1xrxlc-0"})(["margin-right:3px;position:relative;top:-2px;"]);V.displayName="IconType";const U=m.a.span.withConfig({displayName:"P",componentId:"sc-1xrxlc-1"})(["margin-bottom:5px;"]);U.displayName="P";const H=m.a.span.withConfig({displayName:"ToolTipTableMetadata",componentId:"sc-1xrxlc-2"})(["margin-right:5px;display:block;font-weight:bold;"]);H.displayName="ToolTipTableMetadata";const G=m.a.span.withConfig({displayName:"ToolTipTableValue",componentId:"sc-1xrxlc-3"})(["word-wrap:break-word;"]);G.displayName="ToolTipTableValue";const Q=o.a.memo((({header:e})=>{var t;return o.a.createElement(o.a.Fragment,null,!Object(j.isEmpty)(e.category)&&o.a.createElement(U,null,o.a.createElement(H,{"data-test-subj":"category"},C.a,":"),o.a.createElement(G,{"data-test-subj":"category-value"},e.category)),o.a.createElement(U,null,o.a.createElement(H,{"data-test-subj":"field"},C.c,":"),o.a.createElement(G,{"data-test-subj":"field-value"},e.id)),o.a.createElement(U,null,o.a.createElement(H,{"data-test-subj":"type"},C.j,":"),o.a.createElement(G,null,o.a.createElement(V,{"data-test-subj":"type-icon",type:Object($.d)(e.type)}),null===(t=e.esTypes)||void 0===t?void 0:t.map((e=>o.a.createElement(h.EuiBadge,{"data-test-subj":`type-value-${e}`,key:e},e))))),!Object(j.isEmpty)(e.description)&&o.a.createElement(U,null,o.a.createElement(H,{"data-test-subj":"description"},C.b,":"),o.a.createElement(G,{"data-test-subj":"description-value"},e.description)))}));Q.displayName="HeaderToolTipContent";const W=({children:e,header:t,isLoading:n,isResizing:a,onClick:i,showSortingCapability:r,sort:s})=>{var l,c;return o.a.createElement(y.c,{"data-test-subj":`header-${t.id}`,isLoading:n},t.aggregatable&&r?o.a.createElement(y.f,{"data-test-subj":"header-sort-button",onClick:a||n?j.noop:i},o.a.createElement(P.b,{"data-test-subj":`header-text-${t.id}`},o.a.createElement(h.EuiToolTip,{"data-test-subj":"header-tooltip",content:o.a.createElement(Q,{header:t})},o.a.createElement(o.a.Fragment,null,o.a.isValidElement(t.display)?t.display:null!==(l=t.displayAsText)&&void 0!==l?l:t.id))),o.a.createElement(z,{"data-test-subj":"header-sort-indicator",sortDirection:_({header:t,sort:s}),sortNumber:R({header:t,sort:s})})):o.a.createElement(y.g,null,o.a.createElement(P.b,{"data-test-subj":`header-text-${t.id}`},o.a.createElement(h.EuiToolTip,{"data-test-subj":"header-tooltip",content:o.a.createElement(Q,{header:t})},o.a.createElement(o.a.Fragment,null,o.a.isValidElement(t.display)?t.display:null!==(c=t.displayAsText)&&void 0!==c?c:t.id)))),e)},K=o.a.memo(W);var Y=n(108),J=n(527);const X=({header:e,onFilterChange:t=j.noop,sort:n,timelineId:a})=>{const i=Object(l.useDispatch)(),s=Object(r.useMemo)((()=>Object(Y.createSelector)(J.selectTimeline,(e=>(null==e?void 0:e.activeTab)===k.m.eql))),[]),c=Object(I.b)((e=>s(e,a))),u=Object(r.useCallback)((()=>{var t,r;const o=e.id,s=null!==(t=e.type)&&void 0!==t?t:"",l=null!==(r=e.esTypes)&&void 0!==r?r:[],c=(({clickedHeader:e,currentSort:t})=>t.reduce(((t,n)=>e.id===n.columnId?(e=>{switch(e.sortDirection){case S.b.desc:return S.b.asc;case S.b.asc:default:return S.b.desc}})(n):t),S.b.desc))({clickedHeader:e,currentSort:n}),u=n.findIndex((e=>e.columnId===o));let d=[];d=-1===u?[...n,{columnId:o,columnType:s,esTypes:l,sortDirection:c}]:[...n.slice(0,u),{columnId:o,columnType:s,esTypes:l,sortDirection:c},...n.slice(u+1)],i(T.a.updateSort({id:a,sort:d}))}),[i,e,n,a]),d=Object(r.useCallback)((e=>i(T.a.removeColumn({id:a,columnId:e}))),[i,a]),p=Object(r.useMemo)((()=>T.b.getTimelineByIdSelector()),[]),{isLoading:m}=Object(I.a)((e=>p(e,a)||{isLoading:!1})),g=!c&&!Object(O.isDataViewFieldSubtypeNested)(e);return o.a.createElement(o.a.Fragment,null,o.a.createElement(K,{header:e,isLoading:m,isResizing:!1,onClick:u,showSortingCapability:g,sort:n},o.a.createElement(N,{header:e,isLoading:m,onColumnRemoved:d,sort:n})),o.a.createElement(A,{header:e,onFilterChange:t}))},Z=o.a.memo(X);var ee=n(77);const te=m()(h.EuiContextMenu).withConfig({displayName:"ContextMenu",componentId:"sc-1yjxccs-0"})(["width:115px;& .euiContextMenuItem{font-size:12px;padding:4px 8px;width:115px;}"]),ne=m.a.div.withConfig({displayName:"PopoverContainer",componentId:"sc-1yjxccs-1"})(["& .euiPopover__anchor{padding-right:8px;width:","px;}"],(({$width:e})=>e)),ae={right:!0},ie=({draggableIndex:e,header:t,timelineId:n,isDragging:a,onFilterChange:c,sort:u,tabType:d})=>{const p=Object(r.useRef)(null),[m,g]=Object(r.useState)(!1),f=Object(r.useCallback)((()=>{var e;return null===(e=p.current)||void 0===e?void 0:e.focus()}),[]),j=Object(l.useDispatch)(),{timelines:O}=Object(ee.k)().services,I=Object(r.useMemo)((()=>{var e;return{width:null!==(e=t.initialWidth)&&void 0!==e?e:x.a,height:"auto"}}),[t.initialWidth]),M=Object(r.useMemo)((()=>({position:a?"absolute":"relative"})),[a]),N=Object(r.useMemo)((()=>({right:o.a.createElement(y.e,null)})),[]),D=Object(r.useCallback)(((e,a,i,r)=>{j(T.a.applyDeltaToColumnWidth({columnId:t.id,delta:r.width,id:n}))}),[j,t.id,n]),F=Object(r.useMemo)((()=>Object(b.j)({contextId:`timeline-column-headers-${d}-${n}`,fieldId:t.id})),[d,n,t.id]),A=Object(r.useCallback)((e=>{var a,i;const r=t.id,o=null!==(a=t.type)&&void 0!==a?a:"",s=null!==(i=t.esTypes)&&void 0!==i?i:[],l=u.findIndex((e=>e.columnId===r)),c=-1===l?[...u,{columnId:r,columnType:o,esTypes:s,sortDirection:e}]:[...u.slice(0,l),{columnId:r,columnType:o,esTypes:s,sortDirection:e},...u.slice(l+1)];j(T.a.updateSort({id:n,sort:c}))}),[j,t,u,n]),_=Object(r.useCallback)((()=>{g(!1),f()}),[f]),R=Object(r.useMemo)((()=>[{id:0,items:[{icon:o.a.createElement(h.EuiIcon,{type:"eyeClosed",size:"s"}),name:C.e,onClick:()=>{j(T.a.removeColumn({id:n,columnId:t.id})),_()}},...d!==k.m.eql?[{disabled:!t.aggregatable,icon:o.a.createElement(h.EuiIcon,{type:"sortUp",size:"s"}),name:C.g,onClick:()=>{A(S.b.asc),_()}},{disabled:!t.aggregatable,icon:o.a.createElement(h.EuiIcon,{type:"sortDown",size:"s"}),name:C.i,onClick:()=>{A(S.b.desc),_()}}]:[]]}]),[j,_,t.aggregatable,t.id,A,d,n]),P=Object(r.useMemo)((()=>o.a.createElement(Z,{timelineId:n,header:t,onFilterChange:c,sort:u})),[t,c,u,n]),L=Object(r.useCallback)((e=>{var n;return o.a.createElement(y.o,i()({"data-test-subj":"draggable-header"},e.draggableProps,e.dragHandleProps,{ref:e.innerRef}),o.a.createElement(y.p,null,o.a.createElement(ne,{$width:null!==(n=t.initialWidth)&&void 0!==n?n:x.a},o.a.createElement(h.EuiPopover,{anchorPosition:"downLeft",button:P,closePopover:_,isOpen:m,ownFocus:!0,panelPaddingSize:"none"},o.a.createElement(te,{initialPanelId:0,panels:R})))))}),[_,P,t.initialWidth,m,R]),q=Object(r.useCallback)((()=>{var e;null===(e=p.current)||void 0===e||e.focus()}),[]),B=Object(r.useCallback)((()=>{g(!0)}),[]),{onBlur:z,onKeyDown:$}=O.getUseDraggableKeyboardWrapper()({closePopover:_,draggableId:F,fieldName:t.id,keyboardHandlerRef:p,openPopover:B}),V=Object(r.useCallback)((e=>{m||$(e)}),[m,$]);return o.a.createElement(v.Resizable,{enable:ae,size:I,style:M,handleComponent:N,onResizeStop:D},o.a.createElement("div",{"aria-colindex":null!=e?e+w.c:void 0,className:E.a,"data-test-subj":"draggableWrapperKeyboardHandler",onClick:q,onBlur:z,onKeyDown:V,ref:p,role:"columnheader",tabIndex:0},o.a.createElement(s.Draggable,{"data-test-subj":"draggable",disableInteractiveElementBlocking:!0,draggableId:F,index:e,key:t.id},L)))},re=o.a.memo(ie);var oe=n(95),se=n(702);const le=o.a.memo((({children:e,onMount:t,onUnmount:n})=>(Object(r.useEffect)((()=>(t(),()=>n())),[t,n]),o.a.createElement(o.a.Fragment,null,e))));le.displayName="DraggableContainer";const ce=({globalFullScreen:e,isActiveTimelines:t,timelineFullScreen:n})=>t&&n||!1===t&&e,ue=({actionsColumnWidth:e,browserFields:t,columnHeaders:n,isEventViewer:a=!1,isSelectAllChecked:d,onSelectAll:p,show:m,showEventsSelect:g,showSelectAllCheckbox:h,sort:v,tabType:E,timelineId:x,leadingControlColumns:k,trailingControlColumns:S})=>{const w=Object(l.useDispatch)(),[j,O]=Object(r.useState)(null),I=Object(r.useRef)(null);Object(r.useEffect)((()=>()=>{I.current&&I.current.closeEditor()}),[]),Object(r.useEffect)((()=>{!m&&I.current&&I.current.closeEditor()}),[m]);const T=Object(r.useCallback)(((e,t,a)=>{const r=a.source.index,s=n[r];return o.a.createElement(y.o,i()({"data-test-subj":"draggable-header"},e.draggableProps,e.dragHandleProps,{ref:e.innerRef}),o.a.createElement(le,{onMount:()=>O(r),onUnmount:()=>O(null)},o.a.createElement(u.a,null,o.a.createElement(f,{fieldId:s.id,fieldWidth:s.initialWidth}))))}),[n,O]),C=Object(r.useMemo)((()=>n.map(((e,t)=>o.a.createElement(re,{key:e.id,draggableIndex:t,timelineId:x,header:e,isDragging:j===t,sort:v,tabType:E})))),[n,x,j,v,E]),M=Object(r.useCallback)(((e,t)=>o.a.createElement(o.a.Fragment,null,o.a.createElement(y.r,i()({"data-test-subj":"headers-group",ref:e.innerRef,isDragging:t.isDraggingOver},e.droppableProps),C))),[C]),N=Object(r.useMemo)((()=>k?k.map((e=>e.headerCellRender)):[]),[k]),D=Object(r.useMemo)((()=>S?S.map((e=>e.headerCellRender)):[]),[S]),F=Object(se.a)({sourcererScope:oe.SourcererScopeName.timeline,editorActionsRef:I,upsertColumn:(e,t)=>w(Object(c.upsertColumn)({column:e,id:x,index:t})),removeColumn:e=>w(Object(c.removeColumn)({columnId:e,id:x}))}),A=Object(r.useMemo)((()=>N.map(((i,r)=>{const s=k[r]&&k[r].width||e;return o.a.createElement(y.q,{actionsColumnWidth:s,"data-test-subj":"actions-container",isEventViewer:a,key:r},i&&o.a.createElement(i,{width:s,browserFields:t,columnHeaders:n,isEventViewer:a,isSelectAllChecked:d,onSelectAll:p,showEventsSelect:g,showSelectAllCheckbox:h,sort:v,tabType:E,timelineId:x,fieldBrowserOptions:F}))}))),[N,k,e,t,n,F,a,d,p,g,h,v,E,x]),_=Object(r.useMemo)((()=>D.map(((i,r)=>{const s=S[r]&&S[r].width||e;return o.a.createElement(y.q,{actionsColumnWidth:s,"data-test-subj":"actions-container",isEventViewer:a,key:r},i&&o.a.createElement(i,{width:s,browserFields:t,columnHeaders:n,isEventViewer:a,isSelectAllChecked:d,onSelectAll:p,showEventsSelect:g,showSelectAllCheckbox:h,sort:v,tabType:E,timelineId:x,fieldBrowserOptions:F}))}))),[D,S,e,t,n,F,a,d,p,g,h,v,E,x]);return o.a.createElement(y.s,{"data-test-subj":"column-headers"},o.a.createElement(y.v,null,A,o.a.createElement(s.Droppable,{direction:"horizontal",droppableId:`${b.f}-${E}.${x}`,isDropDisabled:!1,type:b.a,renderClone:T},M),_))},de=o.a.memo(ue)},function(e,t,n){"use strict";n.d(t,"c",(function(){return v})),n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return x}));var a=n(4),i=n.n(a),r=n(32),o=n(174),s=n(34);const l=n(0).i18n.translate("xpack.securitySolution.callouts.dismissButton",{defaultMessage:"Dismiss"}),c=({message:e,text:t,onClick:n=s.noop})=>{const{type:o}=e,c=o,u=null!=t?t:l,d=Object(a.useCallback)((()=>n(e)),[n,e]);return i.a.createElement(r.EuiButton,{color:c,"data-test-subj":"callout-dismiss-btn",onClick:d},u)},u=({message:e,iconType:t,dismissButtonText:n,onDismiss:a,showDismissButton:o=!0})=>{const{type:s,id:l,title:u,description:p}=e,m=null!=t?t:d(s);return i.a.createElement(r.EuiCallOut,{color:s,title:u,iconType:m,"data-test-subj":`callout-${l}`,"data-test-messages":`[${l}]`},p,o&&i.a.createElement(c,{message:e,text:n,onClick:a}))},d=e=>{switch(e){case"primary":return"iInCircle";case"success":return"cheer";case"warning":return"help";case"danger":return"alert";default:return Object(o.a)(e)}},p=Object(a.memo)(u);var m=n(1063),g=n.n(m),f=n(887);const b=(e,t)=>y(e,s.identity,(()=>t)),y=(e,t,n)=>{const a=e.map((e=>[t(e),n(e)]));return Object(s.fromPairs)(a)},h=({namespace:e,condition:t,message:n})=>{const{isVisible:o,dismiss:l}=((e,t="common")=>{const{getMessages:n,addMessage:i}=Object(f.a)(),[r,o]=g()({}),l=(e=>`kibana.securitySolution.${e}.callouts.dismissed`)(t),c=Object(a.useCallback)((()=>Object.entries(r).filter((([e,t])=>t)).map((([e,t])=>e))),[r]),u=Object(a.useCallback)((e=>{var t;return null!==(t=r[e.id])&&void 0!==t&&t}),[r]),d=Object(a.useCallback)((e=>{const{id:t,type:n}=e;o.set(t,!1),"primary"!==n&&"success"!==n||i(l,t)}),[o,i,l]),p=Object(a.useCallback)((e=>{const t=n(l),a=Object(s.difference)(e,t),i=Object(s.intersection)(e,t);o.setAll({...b(a,!0),...b(i,!1)})}),[n,l,o]);return Object(a.useEffect)((()=>{const t=e.map((e=>e.id)),n=Object.keys(r);Object(s.isEqual)(t,n)||p(t)}),[e,r,p]),{getVisibleMessageIds:c,isVisible:u,dismiss:d}})([n],e);return t&&o(n)?i.a.createElement(i.a.Fragment,null,i.a.createElement(p,{message:n,onDismiss:l}),i.a.createElement(r.EuiSpacer,{size:"l"})):null},v=Object(a.memo)(h),E=({condition:e,message:t})=>e?i.a.createElement(p,{message:t,showDismissButton:!1}):null,x=Object(a.memo)(E)},function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n(4),i=n(77),r=n(83),o=n(172),s=n(0);const l=s.i18n.translate("xpack.securitySolution.containers.detectionEngine.alerts.fetchListsIndex.errorDescription",{defaultMessage:"Failed to retrieve the lists index"}),c=s.i18n.translate("xpack.securitySolution.containers.detectionEngine.alerts.createListsIndex.errorDescription",{defaultMessage:"Failed to create the lists index"});var u=n(84),d=n(116);const p=e=>{const[t]=Object.keys(e),n=e[t];return null!=n&&n.manage},m=e=>{const[t]=Object.keys(e),n=e[t];return null!=n&&n.read},g=e=>{const[t]=Object.keys(e),n=e[t];return null!=n&&(n.create||n.create_doc||n.index||n.write)},f=()=>{const[e,t]=Object(a.useState)({isAuthenticated:null,canManageIndex:null,canReadIndex:null,canWriteIndex:null}),{listPrivileges:n}=Object(d.a)();return Object(a.useEffect)((()=>{if(null!=n.result){const{is_authenticated:e,lists:{index:a},listItems:{index:i}}=n.result;t({isAuthenticated:e,canReadIndex:m(a)&&m(i),canManageIndex:p(a)&&p(i),canWriteIndex:g(a)&&g(i)})}}),[n.result]),Object(a.useEffect)((()=>{null!=n.error&&t({isAuthenticated:!1,canManageIndex:!1,canReadIndex:!1,canWriteIndex:!1})}),[n.error]),{loading:n.loading,...e}},b=()=>{const{createIndex:e,indexExists:t,loading:n,error:s}=(()=>{const[e,t]=Object(a.useState)(null),[n,s]=Object(a.useState)(null),{lists:d}=Object(i.k)().services,p=Object(i.j)(),{addError:m}=Object(u.a)(),{canReadIndex:g,canManageIndex:b,canWriteIndex:y}=f(),{loading:h,start:v,...E}=Object(o.k)(),{loading:x,start:k,...S}=Object(o.d)(),w=h||x,j=Object(a.useCallback)((()=>{d&&g&&b&&v({http:p})}),[p,d,v,g,b]),O=Object(a.useCallback)((()=>{d&&b&&y&&k({http:p})}),[k,p,d,b,y]);return Object(a.useEffect)((()=>{h||n||null!==e||j()}),[n,e,j,h]),Object(a.useEffect)((()=>{null!=E.result&&t(E.result.list_index&&E.result.list_item_index)}),[E.result]),Object(a.useEffect)((()=>{null!=S.result&&j()}),[S.result,j]),Object(a.useEffect)((()=>{const e=E.error;null!=e&&(Object(r.t)(e)&&404===e.body.status_code?t(!1):(s(e),m(e,{title:l})))}),[m,E.error]),Object(a.useEffect)((()=>{const e=S.error;null!=e&&(s(e),m(e,{title:c}))}),[m,S.error]),{createIndex:O,error:n,indexExists:e,loading:w}})(),{canManageIndex:d,canWriteIndex:p,loading:m}=f(),{lists:g}=Object(i.k)().services,b=null!=g,y=n||m,h=!1===t,v=!b||h&&(!1===d||!0===d&&null!=s);return Object(a.useEffect)((()=>{h&&d&&e()}),[d,e,h]),{canManageIndex:d,canWriteIndex:p,enabled:b,loading:y,needsConfiguration:v}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return x}));var a=n(4),i=n.n(a),r=n(237),o=n(292);var s=n(264),l=n(560),c=n(32),u=n(34),d=n(33),p=n.n(d),m=n(102),g=n(708),f=n(77),b=n(676);const y=p()(c.EuiFlexGroup).withConfig({displayName:"StyledFlexGroup",componentId:"sc-1v7juqg-0"})(["border-top:1px solid #d3dae6;border-bottom:1px solid #d3dae6;margin-top:2px;"]),h=p.a.div.withConfig({displayName:"StyledContent",componentId:"sc-1v7juqg-1"})(["padding:",";"],(({$isDetails:e})=>e?"0 8px":void 0)),v=({field:e,globalFilters:t,onFilterAdded:n,scopeId:r,value:o,closeCellPopover:s})=>{const{timelines:l,data:{query:{filterManager:d}}}=Object(f.k)().services,p=Object(a.useMemo)((()=>{var t,n;return Object(m.d)({fieldName:e.id,fieldType:null!==(t=e.type)&&void 0!==t?t:"",isAggregatable:null!==(n=e.aggregatable)&&void 0!==n&&n,hideTopN:!1})}),[e]),[v,E]=Object(a.useState)(!1),x=Object(a.useCallback)((()=>E(!v)),[v]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(h,{$isDetails:!0,"data-test-subj":"data-grid-expanded-cell-value-actions"},p?i.a.createElement(g.a,{className:"eui-displayBlock expandable-top-value-button",Component:c.EuiButtonEmpty,"data-test-subj":"data-grid-expanded-show-top-n",field:e.id,flush:"both",globalFilters:t,iconSide:"right",iconType:v?"arrowUp":"arrowDown",isExpandable:!0,onClick:x,onFilterAdded:null!=n?n:u.noop,ownFocus:!1,paddingSize:"none",showLegend:!0,showTopN:v,showTooltip:!1,scopeId:r,title:v?b.b:b.c,value:o}):null),i.a.createElement(y,{gutterSize:"s"},i.a.createElement(c.EuiFlexItem,null,l.getHoverActions().getFilterForValueButton({Component:c.EuiButtonEmpty,field:e.id,filterManager:d,onFilterAdded:n,ownFocus:!1,size:"s",showTooltip:!1,value:o,onClick:s})),i.a.createElement(c.EuiFlexItem,null,l.getHoverActions().getFilterOutValueButton({Component:c.EuiButtonEmpty,field:e.id,filterManager:d,onFilterAdded:n,ownFocus:!1,size:"s",showTooltip:!1,value:o,onClick:s}))))};v.displayName="ExpandedCellValueActionsComponent";const E=i.a.memo(v),x=({data:e,ecsData:t,eventId:n,globalFilters:c,header:u,isDetails:d,isDraggable:p,isTimeline:m,linkValues:g,rowRenderers:f,setCellProps:b,scopeId:y,truncate:v,closeCellPopover:x,enableActions:k=!0})=>{const S=Object(a.useMemo)((()=>void 0!==Object(s.b)(u.id,u.type,void 0)&&!m),[u.id,u.type,m]),w=Object(r.c)({data:e,fieldName:u.id}),j=d?"eui-textBreakWord":"eui-displayInlineBlock eui-textTruncate";return i.a.createElement(i.a.Fragment,null,i.a.createElement(h,{className:j,$isDetails:d},((e,t,n)=>{const a=t.find((t=>t.isInstance(e,n)));return null!=a?a:(()=>{throw new Error("Unhandled Column Renderer")})()})(u.id,o.a,e).renderColumn({asPlainText:S,columnName:u.id,ecsData:t,eventId:n,field:u,isDetails:d,isDraggable:p,linkValues:g,rowRenderers:f,scopeId:y,truncate:v,values:w})),k&&d&&(O=u.id)&&!l.a.includes(O)&&i.a.createElement(E,{field:u,globalFilters:c,scopeId:y,value:w,closeCellPopover:x}));var O}},function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));var a=n(32),i=n(35),r=n(4),o=n.n(r),s=n(92),l=n.n(s),c=n(34),u=n(11),d=n(42),p=n(77),m=n(697),g=n(0);const f=g.i18n.translate("xpack.securitySolution.lastEventTime.errorSearchDescription",{defaultMessage:"An error has occurred on last event time search"}),b=g.i18n.translate("xpack.securitySolution.lastEventTime.failSearchDescription",{defaultMessage:"Failed to run search on last event time"});var y=n(84),h=n(87),v=n(101);const E=Object(r.memo)((({hostName:e,userName:t,indexKey:n,ip:s,indexNames:g})=>{const[E,{lastSeen:x,errorMessage:k}]=(({indexKey:e,indexNames:t,details:n})=>{const{data:a}=Object(p.k)().services,i=Object(r.useRef)(c.noop),o=Object(r.useRef)(new AbortController),s=Object(r.useRef)(new u.Subscription),[g,h]=Object(r.useState)(!1),[v,E]=Object(r.useState)({defaultIndex:t,factoryQueryType:m.c.lastEventTime,indexKey:e,details:n}),[x,k]=Object(r.useState)({lastSeen:null,refetch:i.current,errorMessage:void 0}),{addError:S,addWarning:w}=Object(y.a)(),j=Object(r.useCallback)((e=>{const t=async()=>{o.current=new AbortController,h(!0),s.current=a.search.search(e,{strategy:"timelineSearchStrategy",abortSignal:o.current.signal}).subscribe({next:e=>{Object(d.isCompleteResponse)(e)?(h(!1),k((t=>({...t,errorMessage:void 0,lastSeen:e.lastSeen,refetch:i.current})))):Object(d.isErrorResponse)(e)&&(h(!1),w(f))},error:e=>{h(!1),S(e,{title:b}),k((t=>({...t,errorMessage:e.message})))}})};s.current.unsubscribe(),o.current.abort(),t(),i.current=t}),[a.search,S,w]);return Object(r.useEffect)((()=>{E((a=>{const i={...a,defaultIndex:t,indexKey:e,details:n};return l()(a,i)?a:i}))}),[t,n,e]),Object(r.useEffect)((()=>(j(v),()=>{s.current.unsubscribe(),o.current.abort()})),[v,j]),[g,x]})({indexKey:n,indexNames:g,details:{hostName:e,ip:s,userName:t}});return null!=k?o.a.createElement(a.EuiToolTip,{position:"top",content:k,"data-test-subj":"last_event_time_error","aria-label":"last_event_time_error",id:`last_event_time_error-${n}`},o.a.createElement(a.EuiIcon,{"aria-describedby":`last_event_time_error-${n}`,type:"alert"})):o.a.createElement(o.a.Fragment,null,E&&o.a.createElement(a.EuiLoadingSpinner,{size:"m"}),E||null==x||"Invalid Date"!==new Date(x).toString()?!E&&null!=x&&o.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.headerPage.pageSubtitle",defaultMessage:"Last event: {beat}",values:{beat:o.a.createElement(v.b,{value:x})}}):x,!E&&null==x&&Object(h.d)())}));E.displayName="LastEventTime"},function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return c}));var a=n(4),i=n.n(a),r=n(720),o=n(678);const s=()=>i.a.createElement(r.a,{docPath:o.f,linkText:o.g}),l=()=>i.a.createElement(r.a,{docPath:o.b,linkText:o.c}),c=()=>i.a.createElement(r.a,{docPath:o.d,linkText:o.e})},function(e,t,n){e.exports=n(27)(477)},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return b}));var a=n(32),i=n(43),r=n.n(i),o=n(4),s=n.n(o),l=n(33),c=n.n(l),u=n(117),d=n.n(u),p=n(384),m=n(160);p.f;const g=c.a.h3.withConfig({displayName:"TitleText",componentId:"sc-wz9mhv-0"})(["margin:0 5px;cursor:default;user-select:none;"]);g.displayName="TitleText",s.a.memo((({noteIds:e})=>s.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(a.EuiIcon,{color:"text",size:"l",type:"editorComment"})),s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(a.EuiTitle,{size:"s"},s.a.createElement(g,null,p.e))),s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(m.c,{color:"hollow"},e.length))))).displayName="NotesCount";const f=({newNote:e})=>({created:r.a.utc().toDate(),id:d.a.v4(),lastEdit:null,note:e,saveObjectId:null,user:"elastic",version:null}),b=({associateNote:e,newNote:t,updateNewNote:n,updateNote:a})=>{const i=f({newNote:t});a(i),e(i.id),n("")}},function(e,t,n){"use strict";function a(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,r){t=t||"&",n=n||"=";var o={};if("string"!=typeof e||0===e.length)return o;var s=/\+/g;e=e.split(t);var l=1e3;r&&"number"==typeof r.maxKeys&&(l=r.maxKeys);var c=e.length;l>0&&c>l&&(c=l);for(var u=0;u<c;++u){var d,p,m,g,f=e[u].replace(s,"%20"),b=f.indexOf(n);b>=0?(d=f.substr(0,b),p=f.substr(b+1)):(d=f,p=""),m=decodeURIComponent(d),g=decodeURIComponent(p),a(o,m)?i(o[m])?o[m].push(g):o[m]=[o[m],g]:o[m]=g}return o};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,n){"use strict";var a=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,s){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?r(o(e),(function(o){var s=encodeURIComponent(a(o))+n;return i(e[o])?r(e[o],(function(e){return s+encodeURIComponent(a(e))})).join(t):s+encodeURIComponent(a(e[o]))})).join(t):s?encodeURIComponent(a(s))+n+encodeURIComponent(a(e)):""};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function r(e,t){if(e.map)return e.map(t);for(var n=[],a=0;a<e.length;a++)n.push(t(e[a],a));return n}var o=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(32),i=n(83),r=n(4),o=n.n(r),s=n(33);const l=n.n(s)()(a.EuiPopover).withConfig({displayName:"WithHoverActionsPopover",componentId:"sc-16d4hj4-0"})([".euiPopover__anchor{width:100%;}"]),c=o.a.memo((({alwaysShow:e=!1,closePopOverTrigger:t,hoverContent:n,onCloseRequested:a,render:s})=>{const[c,u]=Object(r.useState)(null!=n&&e),[d,p]=Object(r.useState)(!1),[,m]=Object(r.useState)(void 0),g=Object(r.useRef)(null),f=Object(r.useCallback)((()=>{m((e=>{clearTimeout(e)})),p(!1),null!=a&&a()}),[a]),b=Object(r.useCallback)((()=>{m(Number(setTimeout((()=>{document.body.classList.contains(i.d)||p(!0)}),100)))}),[m,p]),y=Object(r.useCallback)((()=>{e||f()}),[e,f]),h=Object(r.useCallback)((e=>{c&&"Escape"===e.key&&y()}),[c,y]),v=Object(r.useMemo)((()=>o.a.createElement("div",{"data-test-subj":"withHoverActionsButton",onMouseEnter:b},s(d))),[b,s,d]);return Object(r.useEffect)((()=>{u(null!=n&&(d||e))}),[n,d,e]),Object(r.useEffect)((()=>{p(!1)}),[t]),Object(r.useEffect)((()=>{var e;c&&(null==g||null===(e=g.current)||void 0===e||e.positionPopoverFluid())}),[n,c]),o.a.createElement("div",{className:e?i.c:"",onMouseLeave:y},o.a.createElement(l,{ref:g,anchorPosition:"downCenter",button:v,closePopover:f,hasArrow:!1,isOpen:c,ownFocus:!1,panelPaddingSize:"none",panelClassName:"withHoverActions__popover",repositionOnScroll:!0},c?o.a.createElement("div",{onKeyDown:h},n):null))}));c.displayName="WithHoverActions"},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"k",(function(){return l})),n.d(t,"l",(function(){return c})),n.d(t,"j",(function(){return u})),n.d(t,"g",(function(){return d})),n.d(t,"h",(function(){return p})),n.d(t,"d",(function(){return m})),n.d(t,"e",(function(){return g})),n.d(t,"c",(function(){return f})),n.d(t,"p",(function(){return b})),n.d(t,"o",(function(){return y})),n.d(t,"n",(function(){return h})),n.d(t,"m",(function(){return v})),n.d(t,"i",(function(){return E}));var a=n(0),i=n(79);const r=a.i18n.translate("xpack.securitySolution.timeline.callOut.unauthorized.message.description",{defaultMessage:"You can use Timeline to investigate events, but you do not have the required permissions to save timelines for future use. If you need to save timelines, contact your Kibana administrator."}),o=a.i18n.translate("xpack.securitySolution.timeline.callOut.immutable.message.description",{defaultMessage:"This prebuilt timeline template cannot be modified. To make changes, please duplicate this template and make modifications to the duplicate template."}),s=a.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.button",{defaultMessage:"Edit timeline name and description"}),l=a.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.header",{defaultMessage:"Save Timeline"}),c=a.i18n.translate("xpack.securitySolution.timeline.saveTimelineTemplate.modal.header",{defaultMessage:"Save Timeline Template"}),u=a.i18n.translate("xpack.securitySolution.timeline.nameTimeline.save.title",{defaultMessage:"Save"}),d=a.i18n.translate("xpack.securitySolution.timeline.nameTimeline.modal.header",{defaultMessage:"Name Timeline"}),p=a.i18n.translate("xpack.securitySolution.timeline.nameTimelineTemplate.modal.header",{defaultMessage:"Name Timeline Template"}),m=a.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.discard.title",{defaultMessage:"Discard Timeline"}),g=a.i18n.translate("xpack.securitySolution.timeline.saveTimelineTemplate.modal.discard.title",{defaultMessage:"Discard Timeline Template"}),f=a.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.close.title",{defaultMessage:"Close"}),b=e=>a.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.warning.title",{values:{timeline:e===i.n.template?"timeline template":"timeline"},defaultMessage:"You have an unsaved {timeline}. Do you wish to save it?"}),y=a.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.titleTitle",{defaultMessage:"Title"}),h=a.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.titleAriaLabel",{defaultMessage:"Title"}),v=a.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.descriptionLabel",{defaultMessage:"Description"}),E=a.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.optionalLabel",{defaultMessage:"Optional"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var a=n(32),i=n(44),r=n.n(i),o=n(4),s=n.n(o),l=n(33),c=n.n(l),u=n(37),d=n(1),p=n(555),m=n(94),g=n(95);const f=c()(a.EuiDescriptionList).withConfig({displayName:"DescriptionListStyled",componentId:"sc-c8ba4g-0"})(["@media only screen and (min-width:","){.euiDescriptionList__title{width:30% !important;}.euiDescriptionList__description{width:70% !important;}}"],(e=>e.theme.eui.euiBreakpoints.s));f.displayName="DescriptionListStyled";const b=c()(a.EuiModal).withConfig({displayName:"MyEuiModal",componentId:"sc-c8ba4g-1"})(["width:min(768px,calc(100vw - 16px));min-height:41vh;.euiModal__flex{width:60vw;}.euiCodeBlock{height:auto !important;max-width:718px;}"]);b.displayName="MyEuiModal";const y=function(e){try{return e.map((e=>JSON.parse(e)))}catch{return[]}},h=(e=[])=>1===e.length&&e[0]===d.Yb?s.a.createElement("i",null,p.f):e.length>0?e.filter((e=>e!==d.Yb)).join(", "):p.k,v=({additionalRequests:e,additionalResponses:t,closeModal:n,inputId:i,request:l,response:c,title:d})=>{var v,E,x,k;const{pathname:S}=Object(u.useLocation)(),{selectedPatterns:w}=Object(m.d)("timeline"===i?g.SourcererScopeName.timeline:Object(m.a)(S)),j=[l,...null!=e?e:[]],O=[c,...null!=t?t:[]],I=y(j),T=y(O),C=Object(o.useMemo)((()=>{var e,t;return(null!==(e=null===(t=I[0])||void 0===t?void 0:t.index)&&void 0!==e?e:[]).every((e=>w.includes(e.trim())))}),[I,w]),M=[{title:s.a.createElement("span",{"data-test-subj":"index-pattern-title"},p.b," ",s.a.createElement(a.EuiIconTip,{color:"subdued",content:p.c,type:"iInCircle"})),description:s.a.createElement("span",{"data-test-subj":"index-pattern-description"},s.a.createElement("p",null,h(null!==(v=null===(E=I[0])||void 0===E?void 0:E.index)&&void 0!==v?v:[])),!C&&s.a.createElement("p",null,s.a.createElement("small",null,s.a.createElement("i",{"data-test-subj":"not-sourcerer-msg"},p.e))))},{title:s.a.createElement("span",{"data-test-subj":"query-time-title"},p.g," ",s.a.createElement(a.EuiIconTip,{color:"subdued",content:p.h,type:"iInCircle"})),description:s.a.createElement("span",{"data-test-subj":"query-time-description"},0===(null===(x=T[0])||void 0===x?void 0:x.took)?"0ms":null!==(k=T[0])&&void 0!==k&&k.took?`${r()(T[0].took).format("0,0")}ms`:p.k)},{title:s.a.createElement("span",{"data-test-subj":"request-timestamp-title"},p.i," ",s.a.createElement(a.EuiIconTip,{color:"subdued",content:p.j,type:"iInCircle"})),description:s.a.createElement("span",{"data-test-subj":"request-timestamp-description"},(new Date).toISOString())}],N=[{id:"statistics",name:"Statistics",content:s.a.createElement(s.a.Fragment,null,s.a.createElement(a.EuiSpacer,null),s.a.createElement(f,{listItems:M,type:"column"}))},{id:"request",name:"Request",content:I.length>0?I.map(((e,t)=>s.a.createElement(o.Fragment,{key:t},s.a.createElement(a.EuiSpacer,null),s.a.createElement(a.EuiCodeBlock,{language:"js",fontSize:"m",paddingSize:"m",color:"dark",overflowHeight:300,isCopyable:!0},(e=>{try{return JSON.stringify(e,null,2)}catch{return p.k}})(e.body))))):s.a.createElement(a.EuiCodeBlock,null,p.k)},{id:"response",name:"Response",content:T.length>0?O.map(((e,t)=>s.a.createElement(o.Fragment,{key:t},s.a.createElement(a.EuiSpacer,null),s.a.createElement(a.EuiCodeBlock,{language:"js",fontSize:"m",paddingSize:"m",color:"dark",overflowHeight:300,isCopyable:!0},e)))):s.a.createElement(a.EuiCodeBlock,null,p.k)}];return s.a.createElement(b,{onClose:n,"data-test-subj":"modal-inspect-euiModal"},s.a.createElement(a.EuiModalHeader,null,s.a.createElement(a.EuiModalHeaderTitle,null,p.d," ",d)),s.a.createElement(a.EuiModalBody,null,s.a.createElement(a.EuiTabbedContent,{tabs:N,initialSelectedTab:N[0],autoFocus:"selected"})),s.a.createElement(a.EuiModalFooter,null,s.a.createElement(a.EuiButton,{onClick:n,fill:!0,"data-test-subj":"modal-inspect-close"},p.a)))}},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"k",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"e",(function(){return c})),n.d(t,"g",(function(){return u})),n.d(t,"h",(function(){return d})),n.d(t,"i",(function(){return p})),n.d(t,"j",(function(){return m})),n.d(t,"f",(function(){return g}));var a=n(0);const i=a.i18n.translate("xpack.securitySolution.inspectDescription",{defaultMessage:"Inspect"}),r=a.i18n.translate("xpack.securitySolution.inspect.modal.closeTitle",{defaultMessage:"Close"}),o=a.i18n.translate("xpack.securitySolution.inspect.modal.somethingWentWrongDescription",{defaultMessage:"Sorry about that, something went wrong."}),s=a.i18n.translate("xpack.securitySolution.inspect.modal.indexPatternLabel",{defaultMessage:"Index pattern"}),l=a.i18n.translate("xpack.securitySolution.inspect.modal.indexPatternDescription",{defaultMessage:"The index pattern that connected to the Elasticsearch indices. These indices can be configured in Kibana > Advanced Settings."}),c=a.i18n.translate("xpack.securitySolution.inspectPatternDifferent",{defaultMessage:"This element has a unique index pattern separate from the data view setting."}),u=a.i18n.translate("xpack.securitySolution.inspect.modal.queryTimeLabel",{defaultMessage:"Query time"}),d=a.i18n.translate("xpack.securitySolution.inspect.modal.queryTimeDescription",{defaultMessage:"The time it took to process the query. Does not include the time to send the request or parse it in the browser."}),p=a.i18n.translate("xpack.securitySolution.inspect.modal.reqTimestampLabel",{defaultMessage:"Request timestamp"}),m=a.i18n.translate("xpack.securitySolution.inspect.modal.reqTimestampDescription",{defaultMessage:"Time when the start of the request has been logged"}),g=a.i18n.translate("xpack.securitySolution.inspect.modal.noAlertIndexFound",{defaultMessage:"No alert index found"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(4),i=n(78),r=n(90),o=n(81),s=n(98),l=n(184);const c=({inputId:e=r.a.global,inspectIndex:t=0,isDisabled:n,multiple:c=!1,onClick:u,onCloseInspect:d,queryId:p})=>{const m=Object(i.useDispatch)(),g=s.d.globalQueryByIdSelector(),f=s.d.timelineQueryByIdSelector(),{loading:b,inspect:y,selectedInspectIndex:h,isInspected:v}=Object(o.a)((t=>e===r.a.global?g(t,p):f(t,p))),E=Object(a.useCallback)((()=>{u&&u(),m(l.b.setInspectionParameter({id:p,inputId:e,isInspected:!0,selectedInspectIndex:t}))}),[u,m,p,e,t]),x=Object(a.useCallback)((()=>{null!=d&&d(),m(l.b.setInspectionParameter({id:p,inputId:e,isInspected:!1,selectedInspectIndex:t}))}),[d,m,p,e,t]);let k=null,S=null;null!=y&&y.dsl.length>0&&(c?[k,...S]=y.dsl:k=y.dsl[t]);let w=null,j=null;null!=y&&y.response.length>0&&(c?[w,...j]=y.response:w=y.response[t]);const O=Object(a.useMemo)((()=>!b&&h===t&&v),[t,v,b,h]);return{additionalRequests:S,additionalResponses:j,handleClick:E,handleCloseModal:x,isButtonDisabled:Object(a.useMemo)((()=>b||n||null==k||null==w||null==p),[n,b,p,k,w]),isShowingModal:O,loading:b,request:k,response:w}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(0).i18n.translate("xpack.securitySolution.exitFullScreenButton",{defaultMessage:"Exit full screen"})},function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return d}));var a=n(4),i=n.n(a),r=n(33),o=n.n(r);const s="#FAFBFD",l=o.a.div.withConfig({displayName:"BigRing",componentId:"sc-1yoqpxe-0"})(["border-radius:50%;",""],(({size:e})=>`height: ${e}px;\n    width: ${e}px;\n    background-color: ${s};\n    text-align: center;\n    line-height: ${e}px;`)),c=o.a.div.withConfig({displayName:"SmallRing",componentId:"sc-1yoqpxe-1"})(["border-radius:50%;",""],(({size:e})=>`\n    height: ${e}px;\n    width: ${e}px;\n    background-color: white;\n    display: inline-block;\n    vertical-align: middle;`)),u=({size:e=90,donutWidth:t=20})=>e-t>0?i.a.createElement(l,{size:e,"data-test-subj":"empty-donut"},i.a.createElement(c,{size:e-t,"data-test-subj":"empty-donut-small"})):null,d=i.a.memo(u)},function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var a=n(4),i=n.n(a),r=n(78),o=n(33),s=n.n(o),l=n(155),c=n(90),u=n(184),d=n(1),p=n(124),m=n(148),g=n(107),f=n(414),b=n(94),y=n(560),h=n(77),v=n(917),E=n(702),x=n(375),k=n(845);const S=[],w=s.a.div.withConfig({displayName:"FullScreenContainer",componentId:"sc-z1fvak-0"})(["height:",";flex:1 1 auto;display:flex;width:100%;"],(({$isFullScreen:e})=>e?"100%":void 0)),j=({defaultCellActions:e,defaultModel:t,end:n,entityType:o,tableId:s,leadingControlColumns:j,pageFilters:O,currentFilter:I,onRuleChange:T,renderCellValue:C,rowRenderers:M,start:N,scopeId:D,additionalFilters:F,unit:A,bulkActions:_})=>{const R=Object(r.useDispatch)(),{filters:P,input:L,query:q,dataTable:{columns:B,defaultColumns:z,deletedEventIds:$,graphEventId:V,itemsPerPage:U,itemsPerPageOptions:H,sessionViewConfig:G,showCheckboxes:Q,sort:W}=t}=Object(r.useSelector)((e=>Object(f.a)(e,s))),{timelines:K}=Object(h.k)().services,{browserFields:Y,dataViewId:J,indexPattern:X,runtimeMappings:Z,selectedPatterns:ee,dataViewId:te,loading:ne}=Object(b.d)(D),{globalFullScreen:ae}=Object(m.a)(),ie=Object(g.a)("tGridEventRenderedViewEnabled"),re=Object(a.useRef)(null);Object(a.useEffect)((()=>(R(l.a.createTGrid({columns:B,dataViewId:te,defaultColumns:z,id:s,indexNames:ee,itemsPerPage:U,showCheckboxes:Q,sort:W})),()=>{R(u.b.deleteOneQuery({id:s,inputId:c.a.global})),re.current&&re.current.closeEditor()})),[]);const oe=Object(a.useMemo)((()=>[...P,...null!=O?O:[]]),[P,O]),se=S,{Navigation:le}=Object(k.b)({scopeId:s}),{DetailsPanel:ce,SessionView:ue}=Object(k.a)({entityType:o,scopeId:s}),de=Object(a.useMemo)((()=>null!=V&&V.length>0||null!=G?i.a.createElement(v.a,{scopeId:s,SessionView:ue,Navigation:le}):null),[V,s,G,ue,le]),pe=Object(a.useCallback)(((e,t,n)=>{R(u.b.setQuery({id:s,inputId:c.a.global,inspect:e,loading:t,refetch:n}))}),[R,s]),me=Object(E.a)({sourcererScope:D,editorActionsRef:re,upsertColumn:(e,t)=>R(l.a.upsertColumn({column:e,id:s,index:t})),removeColumn:e=>R(l.a.removeColumn({columnId:e,id:s}))}),ge="interval"===L.policy.kind;return i.a.createElement(i.a.Fragment,null,i.a.createElement(w,{$isFullScreen:ae},i.a.createElement(p.c,null,K.getTGrid({additionalFilters:F,appId:d.B,browserFields:Y,bulkActions:_,columns:B,dataViewId:J,defaultCellActions:e,deletedEventIds:$,disabledCellActions:y.a,end:n,entityType:o,fieldBrowserOptions:me,filters:oe,filterStatus:I,getRowRenderer:x.a,globalFullScreen:ae,graphEventId:V,graphOverlay:de,id:s,indexNames:ee,indexPattern:X,isLive:ge,isLoadingIndexPattern:ne,itemsPerPage:U,itemsPerPageOptions:H,leadingControlColumns:j,onRuleChange:T,query:q,renderCellValue:C,rowRenderers:M,runtimeMappings:Z,setQuery:pe,sort:W,start:N,tGridEventRenderedViewEnabled:ie,trailingControlColumns:se,type:"embedded",unit:A}))),ce)},O=i.a.memo(j)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=["signal.rule.risk_score","signal.reason",n(135).k,"kibana.alert.reason"]},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(32),i=n(4),r=n.n(i),o=n(85),s=n(1),l=n(823);const c=({riskScoreEntity:e,title:t})=>{const n=e===o.v.user?s.fc:s.dc;return r.a.createElement(a.EuiLink,{target:"_blank",rel:"noopener nofollow noreferrer",href:n},t||l.e)},u=r.a.memo(c);u.displayName="RiskScoreDocLink"},,,function(e,t,n){"use strict";n.d(t,"G",(function(){return i})),n.d(t,"m",(function(){return r})),n.d(t,"o",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"r",(function(){return l})),n.d(t,"q",(function(){return c})),n.d(t,"p",(function(){return u})),n.d(t,"O",(function(){return d})),n.d(t,"D",(function(){return p})),n.d(t,"N",(function(){return m})),n.d(t,"B",(function(){return g})),n.d(t,"C",(function(){return f})),n.d(t,"Q",(function(){return b})),n.d(t,"s",(function(){return y})),n.d(t,"E",(function(){return h})),n.d(t,"K",(function(){return v})),n.d(t,"R",(function(){return E})),n.d(t,"M",(function(){return x})),n.d(t,"L",(function(){return k})),n.d(t,"v",(function(){return S})),n.d(t,"w",(function(){return w})),n.d(t,"u",(function(){return j})),n.d(t,"y",(function(){return O})),n.d(t,"x",(function(){return I})),n.d(t,"t",(function(){return T})),n.d(t,"A",(function(){return C})),n.d(t,"b",(function(){return M})),n.d(t,"z",(function(){return N})),n.d(t,"F",(function(){return D})),n.d(t,"c",(function(){return F})),n.d(t,"l",(function(){return A})),n.d(t,"n",(function(){return _})),n.d(t,"f",(function(){return R})),n.d(t,"e",(function(){return P})),n.d(t,"k",(function(){return L})),n.d(t,"i",(function(){return q})),n.d(t,"j",(function(){return B})),n.d(t,"g",(function(){return z})),n.d(t,"h",(function(){return $})),n.d(t,"d",(function(){return V})),n.d(t,"P",(function(){return U})),n.d(t,"J",(function(){return H})),n.d(t,"H",(function(){return G})),n.d(t,"I",(function(){return Q}));var a=n(0);a.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.idTitle",{defaultMessage:"List ID"}),a.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.listName",{defaultMessage:"Name"}),a.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.actionsTitle",{defaultMessage:"Actions"});const i=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.showingExceptionLists",{values:{totalLists:e},defaultMessage:"Showing {totalLists} {totalLists, plural, =1 {list} other {lists}}"}),r=(a.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.rulesAssignedTitle",{defaultMessage:"Rules assigned to"}),a.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.dateCreatedTitle",{defaultMessage:"Date created"}),a.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.dateUpdatedTitle",{defaultMessage:"Last edited"}),a.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.errorFetching",{defaultMessage:"Error fetching exception lists"})),o=(a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allExceptionLists.filters.noExceptionsTitle",{defaultMessage:"No exception lists found"}),a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allExceptionLists.search.placeholder",{defaultMessage:"Search exception lists"})),s=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allExceptions.tableTitle",{defaultMessage:"Shared Exception Lists"}),l=(a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allExceptions.filters.noListsBody",{defaultMessage:"We weren't able to find any exception lists."}),a.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.exportSuccess",{defaultMessage:"Exception list export success"})),c=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.exportError",{defaultMessage:"Exception list export error"}),u=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.deleteError",{defaultMessage:"Error occurred deleting exception list"}),d=e=>a.i18n.translate("xpack.securitySolution.exceptions.referenceModalSuccessDescription",{defaultMessage:"Exception list - {listId} - deleted successfully.",values:{listId:e}}),p=a.i18n.translate("xpack.securitySolution.exceptions.referenceModalTitle",{defaultMessage:"Remove exception list"}),m=e=>a.i18n.translate("xpack.securitySolution.exceptions.referenceModalDefaultDescription",{defaultMessage:"Are you sure you wish to DELETE exception list with the name {listName}?",values:{listName:e}}),g=a.i18n.translate("xpack.securitySolution.exceptions.referenceModalCancelButton",{defaultMessage:"Cancel"}),f=a.i18n.translate("xpack.securitySolution.exceptions.referenceModalDeleteButton",{defaultMessage:"Remove exception list"}),b=e=>a.i18n.translate("xpack.securitySolution.exceptions.referenceModalDescription",{defaultMessage:"This exception list is associated with ({referenceCount}) {referenceCount, plural, =1 {rule} other {rules}}. Removing this exception list will also remove its reference from the associated rules.",values:{referenceCount:e}}),y=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.searchPlaceholder",{defaultMessage:"Search by name or list_id:id"}),h=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.refresh",{defaultMessage:"Refresh"}),v=a.i18n.translate("xpack.securitySolution.exceptions.exceptionListsImportButton",{defaultMessage:"Import list"}),E=e=>a.i18n.translate("xpack.securitySolution.lists.exceptionListImportSuccess",{defaultMessage:"Exception list {fileName} was imported",values:{fileName:e}}),x=a.i18n.translate("xpack.securitySolution.lists.exceptionListImportSuccessTitle",{defaultMessage:"Exception list imported"}),k=a.i18n.translate("xpack.securitySolution.lists.exceptionListUploadError",{defaultMessage:"There was an error uploading the exception list."}),S=a.i18n.translate("xpack.securitySolution.exceptions.manageExceptions.importExceptionList",{defaultMessage:"Import exception list"}),w=a.i18n.translate("xpack.securitySolution.exceptionsTable.importExceptionListFlyoutHeader",{defaultMessage:"Import shared exception list"}),j=a.i18n.translate("xpack.securitySolution.exceptionsTable.importExceptionListFlyoutBody",{defaultMessage:"Select shared exception lists to import"}),O=a.i18n.translate("xpack.securitySolution.exceptionsTable.importExceptionListWarning",{defaultMessage:"We found a pre-existing list with that id"}),I=a.i18n.translate("xpack.securitySolution.exceptionsTable.importExceptionListOverwrite",{defaultMessage:"Overwrite the existing list"}),T=a.i18n.translate("xpack.securitySolution.exceptionsTable.importExceptionListAsNewList",{defaultMessage:"Create new list"}),C=a.i18n.translate("xpack.securitySolution.exceptions.badge.readOnly.tooltip",{defaultMessage:"Unable to create, edit or delete exceptions"}),M=a.i18n.translate("xpack.securitySolution.exceptions.exceptionListsCloseImportFlyout",{defaultMessage:"Close"}),N=a.i18n.translate("xpack.securitySolution.exceptions.exceptionListsFilePickerPrompt",{defaultMessage:"Select or drag and drop multiple files"}),D=a.i18n.translate("xpack.securitySolution.exceptionsTable.rulesCountLabel",{defaultMessage:"Rules"}),F=a.i18n.translate("xpack.securitySolution.exceptionsTable.createdBy",{defaultMessage:"Created By"}),A=a.i18n.translate("xpack.securitySolution.exceptionsTable.createdAt",{defaultMessage:"Date created"}),_=a.i18n.translate("xpack.securitySolution.exceptionsTable.exceptionsCountLabel",{defaultMessage:"Exceptions"}),R=a.i18n.translate("xpack.securitySolution.exceptions.manageExceptions.createSharedListButton",{defaultMessage:"Create shared list"}),P=a.i18n.translate("xpack.securitySolution.exceptions.manageExceptions.createItemButton",{defaultMessage:"Create exception item"}),L=a.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListTitle",{defaultMessage:"Create shared exception list"}),q=a.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListFlyoutNameField",{defaultMessage:"Shared exception list name"}),B=a.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListFlyoutNameFieldPlaceholder",{defaultMessage:"New exception list"}),z=a.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListFlyoutDescription",{defaultMessage:"Description (optional)"}),$=a.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListFlyoutDescriptionPlaceholder",{defaultMessage:"New exception list description"}),V=a.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListFlyoutCreateButton",{defaultMessage:"Create shared exception list"}),U=e=>a.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListSuccessDescription",{defaultMessage:"List with name {listName} was created!",values:{listName:e}}),H=a.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListSuccessTitle",{defaultMessage:"Created list"}),G=a.i18n.translate("xpack.securitySolution.exceptions.sortBy",{defaultMessage:"Sort by:"}),Q=a.i18n.translate("xpack.securitySolution.exceptions.sortByCreateAt",{defaultMessage:"Created At"})},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return r})),n.d(t,"i",(function(){return o})),n.d(t,"j",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return u})),n.d(t,"h",(function(){return d})),n.d(t,"g",(function(){return p})),n.d(t,"f",(function(){return m}));var a=n(0);const i=a.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.installedTitle",{defaultMessage:"Installed"}),r=a.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.installedTooltip",{defaultMessage:"Integration is installed. Configure an integration policy and ensure Elastic Agents are assigned this policy to ingest compatible events."}),o=a.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.uninstalledTitle",{defaultMessage:"Not installed"}),s=a.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.uninstalledTooltip",{defaultMessage:"Integration is not installed. Follow the integration link to install and configure the integration."}),l=a.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.enabledTitle",{defaultMessage:"Installed: enabled"}),c=a.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.enabledTooltip",{defaultMessage:"Integration is installed and an integration policy with the required configuration exists. Ensure Elastic Agents are assigned this policy to ingest compatible events."}),u=a.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.badgeTitle",{defaultMessage:"integrations"}),d=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.popoverTitle",{values:{integrationsCount:e},defaultMessage:"[{integrationsCount}] Related {integrationsCount, plural, =1 {integration} other {integrations}} available"}),p=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.popoverDescription",{values:{integrationsCount:e},defaultMessage:"Install and configure {integrationsCount, plural, =1 {the below integration} other {one or more of the below integrations}} to ingest the necessary data for this detection rule:"}),m=(e,t)=>a.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.popoverDescriptionInstalledVersionTooltip",{values:{installedVersion:e,requiredVersion:t},defaultMessage:"Version mismatch -- please resolve! Installed version `{installedVersion}` when required version `{requiredVersion}`"})},function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"d",(function(){return p}));var a=n(82),i=n.n(a),r=n(4),o=n.n(r),s=n(1),l=n(100);const c=[{value:s.Xb,text:"On each rule execution"},{value:"1h",text:"Hourly"},{value:"1d",text:"Daily"},{value:"7d",text:"Weekly"}],u=[{value:s.Wb,text:"Perform no actions"},...c],d=u[0],p=e=>{const{setValue:t}=e.field,n=Object(r.useCallback)((e=>{const n=e.target.value;t(n)}),[t]),a={...e.euiFieldProps,onChange:n};return o.a.createElement(l.d,i()({},e,{euiFieldProps:a}))}},function(e,t,n){"use strict";n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return g})),n.d(t,"g",(function(){return f})),n.d(t,"f",(function(){return b})),n.d(t,"e",(function(){return y})),n.d(t,"i",(function(){return h})),n.d(t,"h",(function(){return v}));var a=n(4),i=n.n(a),r=n(33),o=n.n(r),s=n(32),l=n(40),c=n(492);const u=o()(s.EuiHealth).withConfig({displayName:"StyledEuiHealth",componentId:"sc-1mv5h4i-0"})(["line-height:inherit;"]),d=l.euiLightVars.euiColorVis0,p=l.euiLightVars.euiColorVis5,m=l.euiLightVars.euiColorVis7,g=l.euiLightVars.euiColorVis9,f=47,b=73,y=99,h=[{value:"low",inputDisplay:i.a.createElement(u,{color:d},c.i)},{value:"medium",inputDisplay:i.a.createElement(u,{color:p},c.j)},{value:"high",inputDisplay:i.a.createElement(u,{color:m},c.h)},{value:"critical",inputDisplay:i.a.createElement(u,{color:g},c.f)}],v={low:21,medium:f,high:b,critical:y}},function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));var a=n(4),i=n(78),r=n(38),o=n(48),s=n(77),l=n(1),c=n(94),u=n(520),d=n(414),p=n(136),m=n(86),g=n(210),f=n(118),b=n(79),y=n(478),h=n(180),v=n(852);const E=({localFilters:e,tableId:t,from:n,to:E,scopeId:x})=>{const[k,S]=Object(a.useState)(!1),{browserFields:w,dataViewId:j,runtimeMappings:O,indexPattern:I,selectedPatterns:T}=Object(c.d)(x),C=Object(i.useDispatch)(),{uiSettings:M}=Object(s.k)().services,{filters:N,dataTable:{selectAll:D,totalCount:F,sort:A,selectedEventIds:_}=h.a}=Object(i.useSelector)((e=>Object(d.a)(e,t))),R=Object(a.useMemo)((()=>Object(o.getEsQueryConfig)(M)),[M]),P=A.map((({columnId:e,columnType:t,esTypes:n,sortDirection:a})=>({field:e,direction:a,esTypes:null!=n?n:[],type:t}))),L=Object(a.useMemo)((()=>[...e,...N]),[e,N]),q=Object(r.combineQueries)({config:R,dataProviders:[],indexPattern:I,filters:L,kqlQuery:{query:"",language:"kuery"},browserFields:w,kqlMode:"filter"}),B=Object(a.useMemo)((()=>q?q.filterQuery:""),[q]),[,,z]=Object(u.b)({dataViewId:j,endDate:E,startDate:n,id:t,fields:["_id","timestamp"],sort:P,indexNames:T,filterQuery:B,runtimeMappings:O,limit:Math.min(l.E,F),timerangeKind:"absolute"});Object(a.useEffect)((()=>{D&&F>l.E?S(!0):S(!1)}),[D,F]);const $=Object(g.a)({timelineId:b.j.active,timelineType:b.n.default}),V=Object(a.useCallback)((e=>C(m.a.updateIsLoading(e))),[C]),U=Object(a.useCallback)((({timeline:e,ruleNote:t,timeline:{filters:a}})=>{var i;$(),V({id:b.j.active,isLoading:!1}),Object(p.b)(C)({duplicate:!0,from:n,id:b.j.active,notes:[],timeline:{...e,indexNames:null!==(i=e.indexNames)&&void 0!==i?i:[],show:!0,filters:a},to:E,ruleNote:t})()}),[C,V,$,n,E]),H=Object(a.useCallback)((e=>{Object(y.c)(U,e.map((e=>e.ecs)),"KqlFilter"),C(Object(v.setSelected)({id:t,isSelectAllChecked:!1,isSelected:!1,eventIds:_}))}),[C,U,_,t]),G=Object(a.useCallback)((e=>{H(e.events),C(Object(v.setEventsLoading)({id:t,isLoading:!1,eventIds:Object.keys(_)}))}),[C,H,t,_]),Q=Object(a.useCallback)((e=>{if(e)return D?(C(Object(v.setEventsLoading)({id:t,isLoading:!0,eventIds:Object.keys(_)})),void z(G)):void H(e)}),[C,_,t,z,D,G,H]);return{label:Object(a.useMemo)((()=>k?`${f.y} ( max ${l.E} )`:f.y),[k]),key:"add-bulk-to-timeline","data-test-subj":"investigate-bulk-in-timeline",disableOnQuery:k,onClick:Q}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return c}));var a=n(4),i=n(39),r=n(138),o=n(353);const s=["GET",n(407).a],l=e=>Object(i.useQuery)(s,(async({signal:e})=>await Object(r.i)({signal:e})),{...o.a,...e}),c=()=>{const e=Object(i.useQueryClient)();return Object(a.useCallback)((()=>{e.invalidateQueries(s,{refetchType:"active"})}),[e])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}));var a=n(39),i=n(4),r=n(1),o=n(138),s=n(353);const l=["GET",r.sb],c=e=>Object(a.useQuery)(l,(async({signal:e})=>Object(o.g)({signal:e})),{...s.a,...e}),u=()=>{const e=Object(a.useQueryClient)();return Object(i.useCallback)((()=>{e.invalidateQueries(l,{refetchType:"active"})}),[e])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return o}));const a=e=>e.sort(((e,t)=>e.toLowerCase().localeCompare(t.toLowerCase()))),i=({query:e,searchValue:t,filterOptions:n,defaultSearchTerm:a})=>{const i=null==e?void 0:e.ast.getFieldClauses();return null!=i&&i.length>0?i.reduce(((e,{field:t,value:n})=>(e[t]=`${n}`,e)),n):{[a]:t}},r=async e=>{const t=(await e.text()).split("\n").filter(Boolean).slice(-1)[0];return JSON.parse(t)},o=async e=>{const t=await r(e);return{succeeded:t.exported_rules_count,failed:t.missing_rules_count,total:t.exported_rules_count+t.missing_rules_count}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(33);const i=n.n(a).a.div.withConfig({displayName:"Display",componentId:"sc-1njjyjq-0"})(["",";"],(({show:e})=>e?"":"display: none;"));i.displayName="Display"},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(4),i=n(138);const r=({exceptionLists:e})=>{const[t,n]=Object(a.useState)(!0),[r,o]=Object(a.useState)([]),[s,l]=Object(a.useState)({}),c=Object(a.useCallback)((t=>{const n=e.reduce(((e,{id:t,...n})=>(e[t]={...n,id:t,rules:[]},e)),{});return t.reduce(((e,t)=>{const n=t.exceptions_list;return null!=n&&n.length>0&&n.forEach((n=>{const a=e[n.id];null!=a&&(e[n.id]={...a,rules:[...a.rules,t]})})),e}),n)}),[e]);return Object(a.useEffect)((()=>{let t=!0;const a=new AbortController;return(async()=>{if(0===e.length&&t)return n(!1),o([]),void l({});try{n(!0);const{data:e}=await Object(i.f)({pagination:{page:1,perPage:1e4},signal:a.signal}),r=c(e),s=Object.keys(r).map((e=>r[e]));o(s),l(r),t&&n(!1)}catch(e){t&&n(!1)}})(),()=>{t=!1,a.abort()}}),[e.length,c]),[t,r,s]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(4),i=n.n(a),r=n(32),o=n(91);const s=Object(a.memo)((({title:e,subtitle:t,actions:n,children:s,restrictWidth:l=!1,hasBottomBorder:c=!0,hideHeader:u=!1,headerBackComponent:d,...p})=>{const m=Object(a.useMemo)((()=>i.a.createElement(r.EuiFlexGroup,{direction:"column",gutterSize:"none",alignItems:"flexStart"},i.a.createElement(r.EuiFlexItem,{grow:!1},d&&i.a.createElement(i.a.Fragment,null,d)),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiTitle,{size:"l"},i.a.createElement("span",{"data-test-subj":"header-page-title"},e))))),[d,e]),g=Object(a.useMemo)((()=>t?i.a.createElement("span",{"data-test-subj":"header-panel-subtitle"},t):void 0),[t]),f=Object(o.a)(p["data-test-subj"]);return i.a.createElement("div",p,!u&&i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiPageHeader,{pageTitle:m,description:g,bottomBorder:c,rightSideItems:n?[n]:void 0,restrictWidth:l,"data-test-subj":f("header")}),i.a.createElement(r.EuiSpacer,{size:"l"})),i.a.createElement(r.EuiPageContent_Deprecated,{hasBorder:!1,hasShadow:!1,paddingSize:"none",color:"transparent",borderRadius:"none"},i.a.createElement(r.EuiPageContentBody_Deprecated,{restrictWidth:l},s)))}));s.displayName="AdministrationListPage"},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(4),i=n(77),r=n(153);const o=(e=[])=>{const{getAppUrl:t}=Object(i.d)();return Object(a.useMemo)((()=>e.reduce(((e,n)=>{var a;const i=n.id,o=Object(r.j)(i);return e[i]={href:t({path:o}),children:null!==(a=n.name)&&void 0!==a?a:i,target:"_blank"},e}),{})),[t,e])}},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return s}));var a=n(139);function i(e){return(null==e?void 0:e.filter((e=>!e.startsWith("policy:"))))||[]}function r(e,t=[]){return e.isGlobal?[a.d,...t]:e.selected.map((e=>`policy:${e.id}`)).concat(t)}function o(e,t){return e.find((e=>e===a.d))?{isGlobal:!0,selected:[]}:{isGlobal:!1,selected:e.reduce(((e,n)=>{const a=n.split(":")[1],i=t.find((e=>e.id===a));return void 0!==i&&e.push(i),e}),[])}}function s(e){return void 0!==e&&void 0!==e.find((e=>e===a.d))}},function(e,t,n){"use strict";n.d(t,"e",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return g})),n.d(t,"c",(function(){return f}));var a=n(1),i=n(85),r=n(383),o=n(272);const s=[o.a.flows,o.a.dns,o.a.http,o.a.tls,o.a.events],l=s.join("|"),c=[...s,o.a.anomalies].join("|"),u=`${a.Sb}/:tabName(${c})`,d=`${a.Sb}/:tabName(${l})`,p=[r.a.flows,r.a.http,r.a.tls,r.a.anomalies,r.a.events,r.a.users].join("|"),m=[i.g.source,i.g.destination].join("|"),g=`${a.Sb}/ip/:detailName`,f=`${g}/:flowTarget(${m})/:tabName(${p})`},function(e,t,n){"use strict";var a=n(514);n.d(t,"a",(function(){return a.a})),n(225)},function(e,t,n){"use strict";n.d(t,"f",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"d",(function(){return c}));var a=n(0);const i=a.i18n.translate("xpack.securitySolution.users.pageTitle",{defaultMessage:"Users"}),r=a.i18n.translate("xpack.securitySolution.users.navigation.allUsersTitle",{defaultMessage:"All users"}),o=a.i18n.translate("xpack.securitySolution.users.navigation.authenticationsTitle",{defaultMessage:"Authentications"}),s=a.i18n.translate("xpack.securitySolution.users.navigation.anomaliesTitle",{defaultMessage:"Anomalies"}),l=a.i18n.translate("xpack.securitySolution.users.navigation.riskTitle",{defaultMessage:"User risk"}),c=a.i18n.translate("xpack.securitySolution.users.navigation.eventsTitle",{defaultMessage:"Events"});a.i18n.translate("xpack.securitySolution.users.navigation.userScoreOverTimeTitle",{defaultMessage:"User risk score over time"}),a.i18n.translate("xpack.securitySolution.hosts.navigaton.hostRisk.viewDashboardButtonLabel",{defaultMessage:"View source dashboard"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"e",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return l}));var a=n(0);const i=a.i18n.translate("xpack.securitySolution.alerts.alertDetails.header.technicalPreview",{defaultMessage:"Technical Preview"}),r=a.i18n.translate("xpack.securitySolution.alerts.alertDetails.navigation.summary",{defaultMessage:"Summary"}),o=(a.i18n.translate("xpack.securitySolution.alerts.alertDetails.header.backToAlerts",{defaultMessage:"Back to alerts"}),a.i18n.translate("xpack.securitySolution.alerts.alertDetails.loadingPage.message",{defaultMessage:"Loading details page..."})),s=a.i18n.translate("xpack.securitySolution.alerts.alertDetails.errorPage.title",{defaultMessage:"Unable to load the details page"}),l=a.i18n.translate("xpack.securitySolution.alerts.alertDetails.errorPage.message",{defaultMessage:"There was an error loading the details page. Please confirm the following id points to a valid document"})},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return k})),n.d(t,"c",(function(){return w})),n.d(t,"d",(function(){return a}));var a={};n.r(a),n.d(a,"STATUS",(function(){return d})),n.d(a,"STATUS_AT",(function(){return p})),n.d(a,"STATUS_DATE",(function(){return m})),n.d(a,"REFRESH",(function(){return g})),n.d(a,"ERROR_CALLOUT_TITLE",(function(){return f})),n.d(a,"PARTIAL_FAILURE_CALLOUT_TITLE",(function(){return b}));var i=n(4),r=n.n(i),o=n(32),s=n(101),l=n(87),c=n(417),u=n(0);const d=u.i18n.translate("xpack.securitySolution.detectionEngine.ruleStatus.statusDescription",{defaultMessage:"Last response"}),p=u.i18n.translate("xpack.securitySolution.detectionEngine.ruleStatus.statusAtDescription",{defaultMessage:"at"}),m=u.i18n.translate("xpack.securitySolution.detectionEngine.ruleStatus.statusDateDescription",{defaultMessage:"Status date"}),g=u.i18n.translate("xpack.securitySolution.detectionEngine.ruleStatus.refreshButton",{defaultMessage:"Refresh"}),f=u.i18n.translate("xpack.securitySolution.detectionEngine.ruleStatus.errorCalloutTitle",{defaultMessage:"Rule failure at"}),b=u.i18n.translate("xpack.securitySolution.detectionEngine.ruleStatus.partialErrorCalloutTitle",{defaultMessage:"Warning at"}),y=({status:e,date:t,children:n})=>{const a=Object(c.c)(e),i=Object(c.b)(e);return r.a.createElement(r.a.Fragment,null,r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(o.EuiHealth,{color:i},r.a.createElement(o.EuiText,{"data-test-subj":"ruleStatus",size:"xs"},null!=a?a:Object(l.d)()))),null!=t&&null!=e&&r.a.createElement(r.a.Fragment,null,r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(r.a.Fragment,null,p)),r.a.createElement(o.EuiFlexItem,{grow:!0},r.a.createElement(s.a,{value:t,fieldName:m}))),r.a.createElement(o.EuiFlexItem,{grow:!1},n))},h=r.a.memo(y);h.displayName="RuleStatus";var v=n(633),E=n(173);const x=({status:e,message:t})=>{const n=e===E.f.failed||e===E.f["partial failure"],a=Object(c.a)(e),i=n&&t?t:a,o=Object(c.b)(e);return r.a.createElement(v.a,{tooltipContent:i,healthColor:o,dataTestSubj:"ruleExecutionStatus"},null!=a?a:Object(l.d)())},k=r.a.memo(x);k.displayName="RuleStatusBadge";const S=({date:e,message:t,status:n})=>{const{shouldBeDisplayed:a,color:i,title:l}=j(n);return a?r.a.createElement(o.EuiCallOut,{title:r.a.createElement(r.a.Fragment,null,l," ",r.a.createElement(s.a,{value:e,fieldName:"execution_summary.last_execution.date"})),color:i,iconType:"alert","data-test-subj":"ruleStatusFailedCallOut"},r.a.createElement("p",null,t)):null},w=r.a.memo(S);w.displayName="RuleStatusFailedCallOut";const j=e=>{switch(e){case E.f.failed:return{shouldBeDisplayed:!0,color:"danger",title:f};case E.f["partial failure"]:return{shouldBeDisplayed:!0,color:"warning",title:b};default:return{shouldBeDisplayed:!1,color:"warning",title:""}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return b}));var a=n(7),i=n(166),r=n(77),o=n(167),s=n(11),l=n(42);const c=e=>"parsing_exception"===e||"verification_exception"===e||"mapping_exception"===e,u=e=>Object(a.has)(e,"error.type"),d=e=>e.error.root_cause.filter((e=>c(e.type))).map((e=>e.reason));var p=n(311);let m;!function(e){e.FAILED_REQUEST="ERR_FAILED_REQUEST",e.INVALID_EQL="ERR_INVALID_EQL"}(m||(m={}));const g=(e,t)=>{let n,a=[];return(...i)=>(n&&clearTimeout(n),n=setTimeout((()=>{const t=e(...i);a.forEach((e=>e(t))),a=[]}),t),new Promise((e=>a.push(e))))},f=async(...e)=>{const[{value:t,formData:n}]=e,{query:g}=t,f=g.query,{dataViewId:b,index:y,ruleType:h}=n;if(void 0===h&&!Object(a.isEmpty)(f)||Object(i.b)(h)&&!Object(a.isEmpty)(f))try{const{data:e}=r.b.get();let t=null==y?void 0:y.join(),i={};if(null!=b&&""!==b&&n.dataSourceType===o.a.DataView){const n=await e.dataViews.get(b);t=n.title,i=n.getRuntimeMappings()}const p=(new AbortController).signal,g=await(async({data:e,dataViewTitle:t,query:n,signal:i,runtimeMappings:r})=>{const{rawResponse:o}=await Object(s.firstValueFrom)(e.search.search({params:{index:t,body:{query:n,runtime_mappings:r,size:0}},options:{ignore:[400]}},{strategy:l.EQL_SEARCH_STRATEGY,abortSignal:i}));if((e=>u(e)&&c(Object(a.get)(e,"error.type")))(o.body))return{valid:!1,errors:d(o.body)};if(u(o.body))throw new Error(JSON.stringify(o.body));return{valid:!0,errors:[]}})({data:e,query:f,signal:p,dataViewTitle:t,runtimeMappings:i});if(!1===(null==g?void 0:g.valid))return{code:m.INVALID_EQL,message:"",messages:g.errors}}catch(e){return{code:m.FAILED_REQUEST,message:p.m,error:e}}},b=e=>{const t=e.errors.length>0,n=!e.isChangingValue&&!t;if(t){const[t]=e.errors,a=t.message;return t.code===m.INVALID_EQL?{isValid:n,message:a,messages:t.messages}:{isValid:n,message:a,error:t.error}}return{isValid:n,message:""}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return ie})),n.d(t,"a",(function(){return le}));var a=n(34),i=n(32),r=n(4),o=n.n(r),s=n(78),l=n(33),c=n.n(l),u=n(38),d=n(86),p=n(112),m=n(158),g=n(95),f=n(901),b=n(79),y=n(81),h=n(228),v=n(123),E=n(296),x=n(529),k=n(859),S=n(0);const w=S.i18n.translate("xpack.securitySolution.timeline.tabs.queyTabTimelineTitle",{defaultMessage:"Query"}),j=S.i18n.translate("xpack.securitySolution.timeline.tabs.eqlTabTimelineTitle",{defaultMessage:"Correlation"}),O=S.i18n.translate("xpack.securitySolution.timeline.tabs.analyserTabTimelineTitle",{defaultMessage:"Analyzer"}),I=S.i18n.translate("xpack.securitySolution.timeline.tabs.notesTabTimelineTitle",{defaultMessage:"Notes"}),T=S.i18n.translate("xpack.securitySolution.timeline.tabs.pinnedTabTimelineTitle",{defaultMessage:"Pinned"}),C=S.i18n.translate("xpack.securitySolution.timeline.tabs.sessionTabTimelineTitle",{defaultMessage:"Session View"});var M=n(13);const N=c.a.div.attrs((({$isVisible:e=!1,isOverflowYScroll:t=!1})=>({style:{display:e?"flex":"none",overflow:t?"hidden scroll":"hidden"}}))).withConfig({displayName:"HideShowContainer",componentId:"sc-14igzi1-0"})(["flex:1;"]),D=Object(r.lazy)((()=>Promise.all([n.e(10),n.e(11),n.e(27)]).then(n.bind(null,1290)))),F=Object(r.lazy)((()=>Promise.all([n.e(10),n.e(11),n.e(26)]).then(n.bind(null,1293)))),A=Object(r.lazy)((()=>n.e(33).then(n.bind(null,1281)))),_=Object(r.lazy)((()=>n.e(30).then(n.bind(null,1297)))),R=Object(r.lazy)((()=>Promise.all([n.e(10),n.e(34)]).then(n.bind(null,1282)))),P=Object(r.lazy)((()=>n.e(35).then(n.bind(null,1283)))),L=Object(r.memo)((({renderCellValue:e,rowRenderers:t,timelineId:n})=>o.a.createElement(r.Suspense,{fallback:o.a.createElement(i.EuiLoadingContent,{lines:10})},o.a.createElement(D,{renderCellValue:e,rowRenderers:t,timelineId:n}))));L.displayName="QueryTab";const q=Object(r.memo)((({renderCellValue:e,rowRenderers:t,timelineId:n})=>o.a.createElement(r.Suspense,{fallback:o.a.createElement(i.EuiLoadingContent,{lines:10})},o.a.createElement(F,{renderCellValue:e,rowRenderers:t,timelineId:n}))));q.displayName="EqlTab";const B=Object(r.memo)((({timelineId:e})=>o.a.createElement(r.Suspense,{fallback:o.a.createElement(i.EuiLoadingContent,{lines:10})},o.a.createElement(A,{timelineId:e}))));B.displayName="GraphTab";const z=Object(r.memo)((({timelineId:e})=>o.a.createElement(r.Suspense,{fallback:o.a.createElement(i.EuiLoadingContent,{lines:10})},o.a.createElement(_,{timelineId:e}))));z.displayName="NotesTab";const $=Object(r.memo)((({timelineId:e})=>o.a.createElement(r.Suspense,{fallback:o.a.createElement(i.EuiLoadingContent,{lines:10})},o.a.createElement(P,{timelineId:e}))));$.displayName="SessionTab";const V=Object(r.memo)((({renderCellValue:e,rowRenderers:t,timelineId:n})=>o.a.createElement(r.Suspense,{fallback:o.a.createElement(i.EuiLoadingContent,{lines:10})},o.a.createElement(R,{renderCellValue:e,rowRenderers:t,timelineId:n}))));V.displayName="PinnedTab";const U=Object(r.memo)((({activeTimelineTab:e,renderCellValue:t,rowRenderers:n,timelineId:a,timelineType:i})=>{const s=Object(r.useCallback)((e=>{switch(e){case b.m.graph:return o.a.createElement(B,{timelineId:a});case b.m.notes:return o.a.createElement(z,{timelineId:a});case b.m.session:return o.a.createElement($,{timelineId:a});default:return null}}),[a]),l=Object(r.useMemo)((()=>[b.m.graph,b.m.notes,b.m.session].includes(e)),[e]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(N,{$isVisible:b.m.query===e,"data-test-subj":`timeline-tab-content-${b.m.query}`},o.a.createElement(L,{renderCellValue:t,rowRenderers:n,timelineId:a})),o.a.createElement(N,{$isVisible:b.m.pinned===e,"data-test-subj":`timeline-tab-content-${b.m.pinned}`},o.a.createElement(V,{renderCellValue:t,rowRenderers:n,timelineId:a})),i===b.n.default&&o.a.createElement(N,{$isVisible:b.m.eql===e,"data-test-subj":`timeline-tab-content-${b.m.eql}`},o.a.createElement(q,{renderCellValue:t,rowRenderers:n,timelineId:a})),o.a.createElement(N,{$isVisible:l,isOverflowYScroll:e===b.m.session,"data-test-subj":`timeline-tab-content-${b.m.graph}-${b.m.notes}`},l&&s(e)))}));U.displayName="ActiveTimelineTab";const H=c()(i.EuiBadge).withConfig({displayName:"CountBadge",componentId:"sc-14igzi1-1"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeS)),G=c()(i.EuiTab).withConfig({displayName:"StyledEuiTab",componentId:"sc-14igzi1-2"})([".euiTab__content{display:flex;flex-direction:row;white-space:pre;}:focus{text-decoration:none;> span > span{text-decoration:underline;}}"]),Q=({renderCellValue:e,rowRenderers:t,timelineId:n,timelineFullScreen:l,timelineType:c,graphEventId:u,sessionViewConfig:p,timelineDescription:m})=>{const g=Object(s.useDispatch)(),f=Object(r.useMemo)((()=>Object(k.a)()),[]),h=Object(r.useMemo)((()=>Object(k.g)()),[]),v=Object(r.useMemo)((()=>Object(k.e)()),[]),E=Object(r.useMemo)((()=>Object(k.d)()),[]),S=Object(r.useMemo)((()=>Object(k.c)()),[]),N=Object(r.useMemo)((()=>Object(k.b)()),[]),D=Object(y.b)((e=>f(e,n))),F=Object(y.b)((e=>h(e,n))),A=Object(y.b)((e=>v(e,n))),_=Object(y.a)((e=>S(e,n))),R=Object(y.a)((e=>N(e,n))),P=Object(y.a)((e=>E(e))),L=Object(M.b)().isEnterprise(),q=Object(r.useMemo)((()=>{const e=Object.values(R).reduce(((e,t)=>[...e,...t]),[]);return[..._,...e]}),[_,R]),B=Object(r.useMemo)((()=>P.filter((e=>q.includes(e.id))).length+(Object(a.isEmpty)(m)?0:1)),[P,q,m]),z=Object(r.useCallback)((e=>{g(d.a.setActiveTabTimeline({id:n,activeTab:e}))}),[g,n]),$=Object(r.useCallback)((()=>{z(b.m.query)}),[z]),V=Object(r.useCallback)((()=>{z(b.m.eql)}),[z]),Q=Object(r.useCallback)((()=>{z(b.m.graph)}),[z]),W=Object(r.useCallback)((()=>{z(b.m.notes)}),[z]),K=Object(r.useCallback)((()=>{z(b.m.pinned)}),[z]),Y=Object(r.useCallback)((()=>{z(b.m.session)}),[z]);return Object(r.useEffect)((()=>{u||D!==b.m.graph||$()}),[D,u,$]),o.a.createElement(o.a.Fragment,null,!l&&o.a.createElement(i.EuiTabs,null,o.a.createElement(G,{"data-test-subj":`timelineTabs-${b.m.query}`,onClick:$,isSelected:D===b.m.query,disabled:!1,key:b.m.query},o.a.createElement("span",null,w),F&&o.a.createElement(x.b,null)),c===b.n.default&&o.a.createElement(G,{"data-test-subj":`timelineTabs-${b.m.eql}`,onClick:V,isSelected:D===b.m.eql,disabled:!1,key:b.m.eql},o.a.createElement("span",null,j),F&&o.a.createElement(x.a,null)),o.a.createElement(i.EuiTab,{"data-test-subj":`timelineTabs-${b.m.graph}`,onClick:Q,isSelected:D===b.m.graph,disabled:!u,key:b.m.graph},O),L&&o.a.createElement(i.EuiTab,{"data-test-subj":`timelineTabs-${b.m.session}`,onClick:Y,isSelected:D===b.m.session,disabled:null===p,key:b.m.session},C),o.a.createElement(G,{"data-test-subj":`timelineTabs-${b.m.notes}`,onClick:W,isSelected:D===b.m.notes,disabled:c===b.n.template,key:b.m.notes},o.a.createElement("span",null,I),F&&B>0&&c===b.n.default&&o.a.createElement("div",null,o.a.createElement(H,null,B))),o.a.createElement(G,{"data-test-subj":`timelineTabs-${b.m.pinned}`,onClick:K,disabled:c===b.n.template,isSelected:D===b.m.pinned,key:b.m.pinned},o.a.createElement("span",null,T),F&&A>0&&c===b.n.default&&o.a.createElement("div",null,o.a.createElement(H,null,A)))),o.a.createElement(U,{activeTimelineTab:D,renderCellValue:e,rowRenderers:t,timelineId:n,timelineType:c,timelineDescription:m}))},W=Object(r.memo)(Q);var K=n(141),Y=n(148),J=n(616),X=n(37),Z=n(267),ee=n(77),te=n(281),ne=n(98);const ae=c.a.div.withConfig({displayName:"TimelineTemplateBadge",componentId:"sc-h40gwq-0"})(["background:",";color:#fff;padding:10px 15px;font-size:0.8em;"],(({theme:e})=>e.eui.euiColorVis3_behindText)),ie=Object(r.createContext)({timelineId:null}),re=({timelineId:e})=>{const t=Object(r.useMemo)((()=>d.b.getTimelineByIdSelector()),[]);return Object(y.b)((n=>{var a;return(null!==(a=t(n,e))&&void 0!==a?a:p.b).isSaving}))?o.a.createElement(i.EuiProgress,{size:"s",color:"primary",position:"absolute"}):null},oe=o.a.memo(re),se=({renderCellValue:e,rowRenderers:t,timelineId:n})=>{const l=Object(s.useDispatch)(),c=Object(r.useRef)(null),x=Object(r.useMemo)((()=>d.b.getTimelineByIdSelector()),[]),k=Object(r.useMemo)((()=>ne.e.scopeIdSelector()),[]),{selectedPatterns:S,selectedDataViewId:w}=Object(y.a)((e=>k(e,g.SourcererScopeName.timeline))),{dataViewId:j,indexNames:O,graphEventId:I,savedObjectId:T,timelineType:C,description:M,sessionViewConfig:N}=Object(y.a)((e=>{var t;return Object(a.pick)(["indexNames","dataViewId","graphEventId","savedObjectId","timelineType","description","sessionViewConfig"],null!==(t=x(e,n))&&void 0!==t?t:p.b)})),{timelineFullScreen:D}=Object(Y.c)();Object(r.useEffect)((()=>{T||l(d.a.createTimeline({id:n,columns:m.b,dataViewId:w,indexNames:S,expandedDetail:h.a.getExpandedDetail(),show:!1}))}),[]);const F=Object(r.useCallback)((()=>{!T||null==w||null===j&&0===O.length||j===w&&O.sort().join()===S.sort().join()||l(d.a.updateDataView({dataViewId:w,id:n,indexNames:S}))}),[l,T,w,j,S,O,n]);Object(r.useEffect)((()=>{F()}),[w,S]);const A=Object(r.useCallback)((()=>{var e;const t=null===(e=c.current)||void 0===e?void 0:e.querySelector(J.a);var n,a;null!=t?t.focus():null===(n=c.current)||void 0===n||null===(a=n.querySelector(".globalFilterBar__addButton"))||void 0===a||a.focus()}),[c]),_=Object(r.useCallback)((()=>{var e,t;null===(e=c.current)||void 0===e||null===(t=e.querySelector(`.${v.d}`))||void 0===t||t.focus()}),[c]),R=Object(r.useCallback)((e=>{Object(u.isTab)(e)&&Object(v.l)({containerElement:c.current,keyboardEvent:e,onSkipFocusBeforeEventsTable:A,onSkipFocusAfterEventsTable:_})}),[c,A,_]),P=Object(r.useMemo)((()=>({timelineId:n})),[n]),L=(()=>{const{search:e,pathname:t}=Object(X.useLocation)(),{spaces:n}=Object(ee.k)().services,a=Object(r.useMemo)((()=>d.b.getTimelineByIdSelector()),[]),{resolveTimelineConfig:s,savedObjectId:l,show:c,graphEventId:u,activeTab:m}=Object(y.a)((e=>{var t;return null!==(t=a(e,b.j.active))&&void 0!==t?t:p.b})),g=Object(r.useCallback)((()=>{var a,r,d;if(!n||"conflict"!==(null==s?void 0:s.outcome)||null==(null==s?void 0:s.alias_target_id))return null;const p=new URLSearchParams(e),g=null!==(a=p.get(te.a.timeline))&&void 0!==a?a:void 0,f={id:null!=l?l:"",isOpen:!!c,activeTab:m,graphEventId:u};let b=f;try{var y;b=null!==(y=Object(Z.a)(g))&&void 0!==y?y:f}catch(e){}const h=null===(r=b)||void 0===r?void 0:r.id,v=null!==(d=null==s?void 0:s.alias_target_id)&&void 0!==d?d:"",E={...b,id:v},x=Object(Z.c)(E);p.set(te.a.timeline,x);const k=`${t}?${p.toString()}${window.location.hash}`;return o.a.createElement(o.a.Fragment,null,n.ui.components.getLegacyUrlConflict({objectNoun:te.a.timeline,currentObjectId:h,otherObjectId:v,otherObjectPath:k}),o.a.createElement(i.EuiSpacer,null))}),[m,u,t,null==s?void 0:s.alias_target_id,null==s?void 0:s.outcome,l,e,c,n]);return Object(r.useMemo)((()=>g()),[g])})();return o.a.createElement(ie.Provider,{value:P},o.a.createElement(K.D,{"data-test-subj":"timeline","data-timeline-id":n,onKeyDown:R,ref:c},o.a.createElement(oe,{timelineId:n}),C===b.n.template&&o.a.createElement(ae,null,E.f),L,o.a.createElement(K.y,{$isVisible:!D,"data-test-subj":"timeline-hide-show-container"},o.a.createElement(f.b,{timelineId:n}),o.a.createElement(f.a,{timelineId:n})),o.a.createElement(W,{graphEventId:I,sessionViewConfig:N,renderCellValue:e,rowRenderers:t,timelineId:n,timelineType:C,timelineDescription:M,timelineFullScreen:D})))};se.displayName="StatefulTimelineComponent";const le=o.a.memo(se)},function(e,t,n){"use strict";n.d(t,"a",(function(){return ee}));var a=n(32),i=n(44),r=n.n(i),o=n(4),s=n.n(o),l=n(33),c=n.n(l),u=n(34),d=n(117),p=n.n(d),m=n(45),g=n(42),f=n(114),b=n(1),y=n(102),h=n(119),v=n(186),E=n(185),x=n(128),k=n(460),S=n(124),w=n(621),j=n(77),O=n(43),I=n.n(O);const T=[],C=(e,t,n,a,i)=>({aggs:{alertsByGrouping:{terms:{field:e,order:{_count:"desc"},size:10},aggs:{alerts:{date_histogram:{field:"@timestamp",fixed_interval:`${Math.floor(I()(n).diff(I()(t))/32)}ms`,min_doc_count:0,extended_bounds:{min:t,max:n}}}}}},query:{bool:{filter:[...a,{range:{"@timestamp":{gte:t,lte:n}}}]}},runtime_mappings:i}),M=e=>{try{return null==e||Object(u.isEmpty)(e)?{}:JSON.parse(e)}catch{return{}}},N=e=>{try{return Object(u.isEmpty)(e)?[]:[M(e)]}catch{return[]}};var D=n(49),F=n(297),A=n(198),_=n(191),R=n(424),P=n(303);const L=s.a.memo((({chartHeight:e=174,data:t,from:n,legendItems:i,legendPosition:r=D.Position.Right,legendMinWidth:l,loading:c,showLegend:u,to:d,updateDateRange:p})=>{const m=Object(F.i)(),g=Object(o.useMemo)((()=>["100%",e]),[e]),f=Object(o.useMemo)((()=>["y"]),[]),b=Object(o.useMemo)((()=>[e=>Object(_.a)(e.g)?e.g:P.c]),[]),y=Object(o.useMemo)((()=>Object(A.a)([n,d])),[n,d]);return s.a.createElement(s.a.Fragment,null,c&&s.a.createElement(a.EuiProgress,{"data-test-subj":"loadingPanelAlertsHistogram",size:"xs",position:"absolute",color:"accent"}),s.a.createElement(a.EuiFlexGroup,{gutterSize:"none"},s.a.createElement(a.EuiFlexItem,{grow:!0},s.a.createElement(D.Chart,{size:g},s.a.createElement(D.Settings,{legendPosition:r,onBrushEnd:p,showLegend:u&&0===i.length,showLegendExtra:u,theme:m}),s.a.createElement(D.Axis,{id:"alertsHistogramAxisX",position:D.Position.Bottom,tickFormat:y}),s.a.createElement(D.Axis,{id:"alertsHistogramAxisY",position:D.Position.Left}),s.a.createElement(D.HistogramBarSeries,{id:"alertsHistogram",xScaleType:D.ScaleType.Time,yScaleType:D.ScaleType.Linear,xAccessor:"x",yAccessors:f,splitSeriesAccessors:b,data:t}))),s.a.createElement(a.EuiFlexItem,{grow:!1},i.length>0&&s.a.createElement(R.a,{legendItems:i,height:e,minWidth:l}))))}));L.displayName="AlertsHistogram";var q=n(0);const B=q.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.headerTitle",{defaultMessage:"Trend"}),z=q.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.notAvailableTooltip",{defaultMessage:"Not available for trend view"}),$=q.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.viewAlertsButtonLabel",{defaultMessage:"View alerts"});var V=n(89),U=n(2),H=n(531),G=n(623),Q=n(532),W=n(109),K=n(409);const Y={value:0,relation:"eq"},J=c()(a.EuiFlexItem).withConfig({displayName:"ViewAlertsFlexItem",componentId:"sc-wtx915-0"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeL)),X=c()(a.EuiFlexItem).withConfig({displayName:"OptionsFlexItem",componentId:"sc-wtx915-1"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeS)),Z=[],ee=Object(o.memo)((({alignHeader:e,chartHeight:t,chartOptionsContextMenu:n,combinedQueries:i,comboboxRef:l,defaultStackByOption:c=H.a,filters:d,headerChildren:O,inspectTitle:I,onFieldSelected:D,onlyField:F,paddingSize:A="m",panelHeight:_=H.d,query:R,legendPosition:P="right",setComboboxInputRef:ee,signalIndexName:te,showCountsInLegend:ne=!1,showGroupByPlaceholder:ae=!1,showLegend:ie=!0,showLinkToAlerts:re=!1,showTotalAlertsCount:oe=!1,showStackBy:se=!0,stackByLabel:le,stackByWidth:ce,timelineId:ue,title:de=B,updateDateRange:pe,titleSize:me="m",runtimeMappings:ge})=>{var fe;const{to:be,from:ye,deleteQuery:he,setQuery:ve}=Object(f.a)(!1),Ee=Object(o.useMemo)((()=>`detections-histogram-${p.a.v4()}`),[]),[xe,ke]=Object(o.useState)(!0),[Se,we]=Object(o.useState)(!1),[je]=Object(j.q)(b.Z),[Oe,Ie]=Object(o.useState)(Y),[Te,Ce]=Object(o.useState)(null==F?c:F),Me=Object(o.useCallback)((e=>{Ce(e),null!=D&&D(e)}),[D]);Object(o.useEffect)((()=>{Ce(null==F?c:F)}),[c,F]);const{toggleStatus:Ne,setToggleStatus:De}=Object(W.a)("detections-histogram"),[Fe,Ae]=Object(o.useState)(!Ne);Object(o.useEffect)((()=>{Ae(!Ne)}),[Ne]);const _e=Object(o.useCallback)((e=>{De(e),Ae(!e)}),[Ae,De]),{loading:Re,data:Pe,setQuery:Le,response:qe,request:Be,refetch:ze}=Object(v.a)({query:C(Te,ye,be,N(i),ge),indexName:te,skip:Fe,queryName:E.a.HISTOGRAM}),$e=Object(j.k)(),{navigateToApp:Ve}=$e.services.application,{formatUrl:Ue,search:He}=Object(x.n)(U.a.alerts),Ge=Object(o.useMemo)((()=>((e,t,n)=>q.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.showingAlertsTitle",{values:{totalAlertsFormatted:e,totalAlerts:t,modifier:n},defaultMessage:"Showing: {modifier}{totalAlertsFormatted} {totalAlerts, plural, =1 {alert} other {alerts}}"}))(r()(Oe.value).format(je),Oe.value,"gte"===Oe.relation?">":"lte"===Oe.relation?"<":"")),[Oe]),Qe=Object(o.useCallback)((e=>{e.preventDefault(),Ve(b.B,{deepLinkId:U.a.alerts,path:Object(x.e)(He)})}),[Ve,He]),We=Object(o.useMemo)((()=>(e=>{var t,n,a;return(null!==(t=null==e||null===(n=e.aggregations)||void 0===n||null===(a=n.alertsByGrouping)||void 0===a?void 0:a.buckets)&&void 0!==t?t:[]).reduce(((e,{key_as_string:t,key:n,alerts:a})=>{var i;return[...e,...(null!==(i=a.buckets)&&void 0!==i?i:[]).map((({key:e,doc_count:a})=>({x:e,y:a,g:null!=t?t:n.toString()})))]}),T)})(Pe)),[Pe]),Ke=Object(o.useMemo)((()=>{var e,t;return ie&&null!=(null==Pe||null===(e=Pe.aggregations)||void 0===e||null===(t=e.alertsByGrouping)||void 0===t?void 0:t.buckets)?Pe.aggregations.alertsByGrouping.buckets.map(((e,t)=>{var n;return{color:t<k.a.length?k.a[t]:void 0,count:ne?e.doc_count:void 0,dataProviderId:Object(y.h)(`draggable-legend-item-${p.a.v4()}-${Te}-${e.key}`),field:Te,timelineId:ue,value:null!==(n=null==e?void 0:e.key_as_string)&&void 0!==n?n:e.key}})):Z}),[null==Pe||null===(fe=Pe.aggregations)||void 0===fe?void 0:fe.alertsByGrouping.buckets,Te,ne,ie,ue]);Object(o.useEffect)((()=>{let e=!1;return e||(({isInitialLoading:e,isLoadingAlerts:t})=>e&&t)({isInitialLoading:xe,isLoadingAlerts:Re})||ke(!1),()=>{e=!0}}),[xe,Re,ke]),Object(Q.a)({setQuery:ve,response:qe,request:Be,refetch:ze,uniqueQueryId:Ee,deleteQuery:he,loading:Re}),Object(o.useEffect)((()=>{var e;Ie(null!==(e=null==Pe?void 0:Pe.hits.total)&&void 0!==e?e:{value:0,relation:"eq"})}),[Pe]),Object(o.useEffect)((()=>{try{let t=null;var e;t=null!=i?M(i):Object(m.buildEsQuery)(void 0,null!=R?[R]:[],null!==(e=null==d?void 0:d.filter((e=>!1===e.meta.disabled)))&&void 0!==e?e:[],{...Object(g.getEsQueryConfig)($e.services.uiSettings),dateFormatTZ:void 0}),we(!1),Le(C(Te,ye,be,Object(u.isEmpty)(t)?[]:[t],ge))}catch(e){we(!0),Le(C(Te,ye,be,[],ge))}}),[Te,ye,be,R,d,i,ge]);const Ye=Object(o.useMemo)((()=>{if(re)return s.a.createElement(J,{grow:!1},s.a.createElement(V.g,{"data-test-subj":"alerts-histogram-panel-go-to-alerts-page",onClick:Qe,href:Ue(Object(x.e)())},$))}),[re,Qe,Ue]),Je=Object(o.useMemo)((()=>{return null==F?de:(e=F,q.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.topNLabel",{values:{fieldName:e},defaultMessage:"Top {fieldName}"}));var e}),[F,de]);return s.a.createElement(S.c,{show:!xe&&Ne},s.a.createElement(G.a,{height:_,hasBorder:!0,paddingSize:A,"data-test-subj":"alerts-histogram-panel",$toggleStatus:Ne},s.a.createElement(h.a,{alignHeader:e,id:Ee,inspectTitle:I,outerDirection:"row",title:Je,titleSize:me,toggleStatus:Ne,toggleQuery:_e,showInspectButton:null==n,subtitle:!xe&&oe&&Ge,isInspectDisabled:Se,hideSubtitle:!0},s.a.createElement(a.EuiFlexGroup,{alignItems:"flexStart","data-test-subj":"panelFlexGroup",gutterSize:"none"},s.a.createElement(a.EuiFlexItem,{grow:!1},se&&s.a.createElement(s.a.Fragment,null,s.a.createElement(G.b,{ref:l,"data-test-subj":"stackByComboBox",selected:Te,onSelect:Me,prepend:le,inputRef:ee,width:ce}),ae&&s.a.createElement(s.a.Fragment,null,s.a.createElement(a.EuiSpacer,{"data-test-subj":"placeholderSpacer",size:"s"}),s.a.createElement(a.EuiToolTip,{"data-test-subj":"placeholderTooltip",content:z},s.a.createElement(G.b,{isDisabled:!0,"data-test-subj":"stackByPlaceholder",onSelect:u.noop,prepend:K.b,selected:"",width:ce})))),null!=O&&O),null!=n&&s.a.createElement(X,{grow:!1},n(Ee)),Ye)),Ne?xe?s.a.createElement(w.a,null):s.a.createElement(L,{chartHeight:t,data:We,from:ye,legendItems:Ke,legendPosition:P,legendMinWidth:ne?300:void 0,loading:Re,to:be,showLegend:ie,updateDateRange:pe}):null))}));ee.displayName="AlertsHistogramPanel"},function(e,t,n){"use strict";n.d(t,"a",(function(){return T}));var a=n(4),i=n.n(a),r=n(1064),o=n.n(r),s=n(540),l=n(32),c=n(0),u=n(35),d=n(1);const p=({values:e})=>i.a.createElement(i.a.Fragment,null,e.map(((t,n)=>i.a.createElement(i.a.Fragment,{key:n},i.a.createElement(l.EuiCode,null,t),n<e.length-1?", ":""))));var m=n(544);const g=c.i18n.translate("xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.messageTitle",{defaultMessage:"Insufficient privileges"}),f=c.i18n.translate("xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.cannotEditRules",{defaultMessage:"Without that privilege you cannot create or edit detection engine rules."}),b=c.i18n.translate("xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.cannotEditLists",{defaultMessage:"Without these privileges, you cannot create or edit value lists."}),y=c.i18n.translate("xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.cannotEditAlerts",{defaultMessage:"Without these privileges, you cannot view or change status of alerts."}),h=({indexPrivileges:e,featurePrivileges:t=[]})=>i.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.messageBody.messageDetail",defaultMessage:"{essence} {indexPrivileges} {featurePrivileges} Related documentation: {docs}",values:{essence:i.a.createElement("p",null,i.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.messageBody.essenceDescription",defaultMessage:"You need the following privileges to fully access this functionality. Contact your administrator for further assistance."})),indexPrivileges:e.length>0?i.a.createElement(i.a.Fragment,null,i.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.messageBody.indexPrivilegesTitle",defaultMessage:"Missing Elasticsearch index privileges:"}),i.a.createElement("ul",null,e.map((([e,t])=>i.a.createElement("li",{key:e},x(e,t)))))):null,featurePrivileges:t.length>0?i.a.createElement(i.a.Fragment,null,i.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.messageBody.featurePrivilegesTitle",defaultMessage:"Missing Kibana feature privileges:"}),i.a.createElement("ul",null,t.map((([e,t])=>i.a.createElement("li",{key:e},k(e,t)))))):null,docs:i.a.createElement("ul",null,i.a.createElement("li",null,i.a.createElement(m.a,null)),i.a.createElement("li",null,i.a.createElement(m.c,null)))}}),v={[d.pc]:{all:f},[d.db]:{write:y},[d.X]:{write:b},[d.W]:{write:b}},E=(e,t)=>{var n;const a=null===(n=Object.entries(v).find((([e])=>t.startsWith(e))))||void 0===n?void 0:n[1];return e.map((e=>null==a?void 0:a[e])).filter(Boolean).join(" ")},x=(e,t)=>i.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.messageBody.missingIndexPrivileges",defaultMessage:"Missing {privileges} privileges for the {index} index. {explanation}",values:{privileges:i.a.createElement(p,{values:t}),index:i.a.createElement(l.EuiCode,null,e),explanation:E(t,e)}}),k=(e,t)=>i.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.messageBody.missingFeaturePrivileges",defaultMessage:"Missing {privileges} privileges for the {index} feature. {explanation}",values:{privileges:i.a.createElement(p,{values:t}),index:i.a.createElement(l.EuiCode,null,e),explanation:E(t,e)}});var S=n(165),w=n(116);const j=["read","write","view_index_metadata","maintenance"],O=e=>{const t=(e=>{const[t]=Object.keys(e);return t})(e),n=e[t],a=j.filter((e=>!n[e]));if(a.length)return[t,a]},I=()=>{const e=(()=>{const{detectionEnginePrivileges:e,listPrivileges:t}=Object(w.a)(),[{canUserCRUD:n}]=Object(S.b)();return Object(a.useMemo)((()=>{const a=[],i=[];if(null==n||null==t.result||null==e.result)return{featurePrivileges:a,indexPrivileges:i};!1===n&&a.push([d.pc,["all"]]);const r=O(t.result.listItems.index);r&&i.push(r);const o=O(t.result.lists.index);o&&i.push(o);const s=O(e.result.index);return s&&i.push(s),{featurePrivileges:a,indexPrivileges:i}}),[n,t,e])})(),t=Object(a.useMemo)((()=>e.indexPrivileges.length>0||e.featurePrivileges.length>0?{type:"primary",id:`missing-user-privileges-${o()(e)}`,title:g,description:h(e)}:null),[e]);return t&&i.a.createElement(s.c,{namespace:"detections",condition:!0,message:t})},T=Object(a.memo)(I)},,function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return b}));var a=n(32),i=n(4),r=n.n(i),o=n(316),s=n(255),l=n(205),c=n(176),u=n(104),d=n(94),p=n(95),m=n(542),g=n(0);const f=e=>{var t,n,u;const{columnId:d,rowIndex:p,scopeId:f}=e,b=Object(i.useMemo)((()=>d===c.l&&Object(s.c)(f)&&0===p&&!e.isDetails),[d,e.isDetails,p,f]),y=null===(t=e.ecsData)||void 0===t||null===(n=t.kibana)||void 0===n||null===(u=n.alert.suppression)||void 0===u?void 0:u.docs_count,h=r.a.createElement(o.a,{isTourAnchor:b,step:l.a.pointToAlertName,tourId:l.b.alertsCases},r.a.createElement(m.a,e));return d===c.l&&y&&parseInt(y[0],10)>0?r.a.createElement(a.EuiFlexGroup,{gutterSize:"xs"},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiToolTip,{position:"top",content:(v=parseInt(y[0],10),g.i18n.translate("xpack.securitySolution.configurations.suppressedAlerts",{defaultMessage:"Alert has {numAlertsSuppressed} suppressed alerts",values:{numAlertsSuppressed:v}}))},r.a.createElement(a.EuiIcon,{type:"layers"}))),r.a.createElement(a.EuiFlexItem,{grow:!1},h)):h;var v},b=({setFlyoutAlert:e})=>{const{browserFields:t}=Object(d.d)(p.SourcererScopeName.detections);return({columnId:e,colIndex:n,data:a,ecsData:i,eventId:o,globalFilters:s,header:l,isDetails:c=!1,isDraggable:d=!1,isExpandable:p,isExpanded:g,linkValues:f,rowIndex:b,rowRenderers:y,setCellProps:h,truncate:v=!0})=>{const E=e.split(".");let x=null!=l?l:{id:e};if(E.length>1&&t[E[0]]){var k,S;const n=null!==(k=(null!==(S=t[E[0]].fields)&&void 0!==S?S:{})[e])&&void 0!==k?k:{};x={...x,...n}}else if(1===E.length){var w,j;const n=null!==(w=(null!==(j=t.base.fields)&&void 0!==j?j:{})[e])&&void 0!==w?w:{};x={...x,...n}}return r.a.createElement(m.a,{browserFields:t,columnId:e,data:a,ecsData:i,eventId:o,globalFilters:s,header:x,isDetails:c,isDraggable:d,isExpandable:p,isExpanded:g,linkValues:f,rowIndex:b,colIndex:n,rowRenderers:y,setCellProps:h,scopeId:u.d.casePage,truncate:v})}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var a=n(34),i=n(4),r=n(53),o=n.n(r),s=n(92),l=n.n(s),c=n(11),u=n(42),d=n(50),p=n(77),m=n(85),g=n(84),f=n(0);const b=f.i18n.translate("xpack.securitySolution.timeline.failDescription",{defaultMessage:"An error has occurred"}),y=f.i18n.translate("xpack.securitySolution.timeline.failSearchDescription",{defaultMessage:"Failed to run search"}),h=({entityType:e=d.EntityType.EVENTS,indexName:t,eventId:n,runtimeMappings:r,skip:s})=>{const{data:f}=Object(p.k)().services,h=Object(i.useRef)((()=>Promise.resolve())),v=Object(i.useRef)(new AbortController),E=Object(i.useRef)(new c.Subscription),[x,k]=Object(i.useState)(!0),[S,w]=Object(i.useState)(null),{addError:j,addWarning:O}=Object(g.a)(),[I,T]=Object(i.useState)(null),[C,M]=Object(i.useState)(null),[N,D]=Object(i.useState)(void 0),F=Object(i.useCallback)((e=>{if(null==e||s||Object(a.isEmpty)(e.eventId))return;const t=async()=>{v.current=new AbortController,k(!0),E.current=f.search.search(e,{strategy:"timelineSearchStrategy",abortSignal:v.current.signal}).subscribe({next:e=>{Object(u.isCompleteResponse)(e)?Promise.resolve().then((()=>{o.a.unstable_batchedUpdates((()=>{k(!1),T(e.data||[]),D(e.rawResponse.hits.hits[0]),M(e.ecs||null),E.current.unsubscribe()}))})):Object(u.isErrorResponse)(e)&&(k(!1),O(b),E.current.unsubscribe())},error:e=>{k(!1),j(e,{title:y}),E.current.unsubscribe()}})};E.current.unsubscribe(),v.current.abort(),t(),h.current=t}),[f.search,j,O,s]);return Object(i.useEffect)((()=>{w((a=>{const i={...null!=a?a:{},entityType:e,indexName:t,eventId:n,factoryQueryType:m.z.details,runtimeMappings:r};return l()(a,i)?a:i}))}),[e,n,t,r]),Object(i.useEffect)((()=>(F(S),()=>{E.current.unsubscribe(),v.current.abort()})),[S,F]),[x,I,N,C,h.current]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(7);const i=e=>{const{id:t,revision:n,created_by:i,created_at:r,updated_by:o,updated_at:s,...l}=e,c=Object(a.cloneDeep)(l),u=c.inputs[0].config.policy.value;return[u.windows.popup.malware,u.mac.popup.malware].forEach((e=>e.message.trim())),c}},function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var a=n(82),i=n.n(a),r=n(32),o=n(34),s=n(4),l=n.n(s),c=n(33),u=n.n(c),d=n(100),p=n(0);const m=[{value:"s",text:p.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRuleForm.secondsOptionDescription",{defaultMessage:"Seconds"})},{value:"m",text:p.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRuleForm.minutesOptionDescription",{defaultMessage:"Minutes"})},{value:"h",text:p.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRuleForm.hoursOptionDescription",{defaultMessage:"Hours"})},{value:"d",text:p.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRuleForm.daysOptionDescription",{defaultMessage:"Days"})}],g=u()(r.EuiFlexItem).withConfig({displayName:"StyledLabelAppend",componentId:"sc-d3i8n6-0"})(["&.euiFlexItem.euiFlexItem--flexGrowZero{margin-left:31px;}"]),f=u()(r.EuiFormRow).withConfig({displayName:"StyledEuiFormRow",componentId:"sc-d3i8n6-1"})(["max-width:none;.euiFormControlLayout{max-width:auto;width:auto;}.euiFormControlLayout__childrenWrapper > *:first-child{box-shadow:none;height:38px;width:100%;}.euiFormControlLayout__childrenWrapper > select{background-color:",";color:",";}.euiFormControlLayout--group .euiFormControlLayout{min-width:100px;}.euiFormControlLayoutIcons{color:",";}.euiFormControlLayout:not(:first-child){border-left:1px solid ",";}"],(({theme:e})=>Object(r.transparentize)(e.eui.euiColorPrimary,.1)),(({theme:e})=>e.eui.euiColorPrimary),(({theme:e})=>e.eui.euiColorPrimary),(({theme:e})=>e.eui.euiColorLightShade)),b=u()(r.EuiSelect).withConfig({displayName:"MyEuiSelect",componentId:"sc-d3i8n6-2"})(["width:auto;"]),y=({dataTestSubj:e,field:t,idAria:n,isDisabled:a,minimumValue:c=0,timeTypes:u=["s","m","h"],fullWidth:p=!1})=>{const[y,h]=Object(s.useState)(u[0]),[v,E]=Object(s.useState)(0),{isInvalid:x,errorMessage:k}=Object(d.i)(t),{value:S,setValue:w}=t,j=Object(s.useCallback)((e=>{h(e.target.value),w(`${v}${e.target.value}`)}),[w,v]),O=Object(s.useCallback)((e=>{const t=((e,t=0)=>{const n=parseInt(e,10);return Number.isNaN(n)?t:Math.max(t,Math.min(n,Number.MAX_SAFE_INTEGER))})(e.target.value,c);E(t),w(`${t}${y}`)}),[c,w,y]);Object(s.useEffect)((()=>{if(S!==`${v}${y}`){const e=S.match(/\d+/g),t=S.match(/[a-zA-Z]+/g);Object(o.isEmpty)(e)||null==e||isNaN(Number(e[0]))||Number(e[0])===Number(v)||E(Number(e[0])),!Object(o.isEmpty)(t)&&null!=t&&u.includes(t[0])&&t[0]!==y&&h(t[0])}}),[y,u,v,S]);const I={disabled:a},T=Object(s.useMemo)((()=>l.a.createElement(r.EuiFlexGroup,{gutterSize:"s",justifyContent:"flexStart",alignItems:"center"},l.a.createElement(r.EuiFlexItem,{grow:!1,component:"span"},t.label),l.a.createElement(g,{grow:!1,component:"span"},t.labelAppend))),[t.label,t.labelAppend]);return l.a.createElement(f,{label:T,helpText:t.helpText,error:k,isInvalid:x,fullWidth:p,"data-test-subj":e,describedByIds:n?[n]:void 0},l.a.createElement(r.EuiFormControlLayout,{append:l.a.createElement(b,i()({fullWidth:!1,options:m.filter((e=>u.includes(e.value))),onChange:j,value:y,"data-test-subj":"timeType"},I))},l.a.createElement(r.EuiFieldNumber,i()({fullWidth:!0,min:c,max:Number.MAX_SAFE_INTEGER,onChange:O,value:v,"data-test-subj":"interval"},I))))}},function(e,t,n){"use strict";n.d(t,"b",(function(){return a.a})),n.d(t,"a",(function(){return y})),n(573),n(480),n(497),n(499);var a=n(498),i=(n(500),n(4)),r=n(195),o=n(172),s=n(7),l=n(139),c=n(165),u=n(1),d=n(77),p=n(510),m=n(724),g=n(168),f=n(338);const b={contentText:"",rulesReferences:[],isLoading:!1,listId:"",listNamespaceType:"single"},y=e=>{const t=Object(d.o)(),{services:n}=Object(d.k)(),{http:a,notifications:y}=n,{navigateToApp:h}=n.application,{exportExceptionList:v,deleteExceptionList:E}=Object(o.c)(a),[{loading:x,canUserCRUD:k,canUserREAD:S}]=Object(c.b)(),[w,j]=Object(i.useState)(),[O,I]=Object(i.useState)(!1),[T,C]=Object(i.useState)(),[M,N]=Object(i.useState)(!1),[D,F]=Object(i.useState)([]),[A,_]=Object(i.useState)([]),[R,P]=Object(i.useState)(!0),[L,q]=Object(i.useState)(""),[B,z]=Object(i.useState)(),[$,V]=Object(i.useState)(!1),[U,H]=Object(i.useState)(b),[G,Q]=Object(i.useState)(!0),[W,K]=Object(i.useState)(!1),Y=Object(f.b)(),J=Object(i.useMemo)((()=>({pageId:u.uc.exceptions,path:"",onNavigate:()=>{h(u.B,{deepLinkId:u.uc.exceptions,path:""})}})),[h]),X=Object(i.useCallback)(((e,n,a,i)=>{null==t||t.addError(e,{title:null!=a?a:"",toastMessage:null!=i?i:""}),q(null!=n?n:"")}),[t]),Z=Object(i.useCallback)((async e=>{const t=await Object(p.e)(e.list_id);F(t)}),[]),ee=Object(i.useCallback)((async()=>{try{if(l.a.includes(e))return N(!0);j(!0);const t=await Object(p.d)({id:e,http:a});if(!t||!Object(m.b)(t))return j(!1),N(!0);if(C(t),await Z(t),j(!1),N(!1),Object(m.a)(t))return P(!1)}catch(e){X(e,r.i.ERROR,g.n,g.m)}}),[e,a,Z,X]);Object(i.useEffect)((()=>{ee()}),[ee]);const[te,ne]=Object(i.useState)(!1),ae=Object(i.useCallback)((async t=>{try{T&&await Object(p.i)({http:a,list:{id:T.id,list_id:e,type:T.type,name:t.name,description:t.description||T.description,namespace_type:T.namespace_type}})}catch(e){X(e)}}),[e,X,a,T]),ie=Object(i.useCallback)((async()=>{try{if(!T)return;await v({id:T.id,listId:T.list_id,namespaceType:T.namespace_type,onError:e=>X(e),onSuccess:e=>{z(e),null==t||t.addSuccess(g.y(T.list_id))}})}catch(e){X(e,void 0,g.o,g.p)}}),[T,v,X,t]),re=Object(i.useCallback)((e=>()=>{y.toasts.addSuccess({title:g.ab(null!=e?e:U.listId)})}),[y.toasts,U.listId]),oe=Object(i.useCallback)((e=>{X(e)}),[X]),se=Object(i.useCallback)((async()=>{try{if(!T)return;await E({id:T.id,namespaceType:T.namespace_type,onError:oe,onSuccess:re})}catch(e){X(e)}finally{H(b),V(!1),h(u.B,{deepLinkId:u.uc.exceptions,path:""})}}),[T,E,oe,re,X,h]),le=Object(i.useCallback)((()=>{try{if(!T)return;H({contentText:D.length?g.cb(D.length):g.Z(T.name),rulesReferences:D.map((({name:e})=>e)),isLoading:!0,listId:T.list_id,listNamespaceType:T.namespace_type}),V(!0)}catch(e){X(e)}}),[X,D,T]),ce=Object(i.useCallback)((()=>{V(!1),H({contentText:"",rulesReferences:[],isLoading:!1,listId:"",listNamespaceType:"single"})}),[]),ue=Object(i.useCallback)((async()=>{try{await Object(p.h)({rules:D,listId:e}),se()}catch(e){X(e)}}),[e,D,X,se]),de=Object(i.useCallback)((()=>{F(A),_(A),ne(!1),I(!1),Q(!0)}),[A]),pe=Object(i.useCallback)((()=>{ne(!0)}),[]),me=Object(i.useCallback)((()=>A.filter((e=>!D.includes(e)))),[D,A]),ge=Object(i.useCallback)((()=>D.filter((e=>!A.includes(e)))),[D,A]),fe=Object(i.useCallback)((e=>{_(e),Q(!1)}),[]),be=Object(i.useCallback)((async()=>{try{if(!T)return ne(!1);I(!0);const t=me(),n=ge();if(!t.length&&!n.length||Object(s.isEqual)(t,n))return de();Promise.all([Object(p.h)({rules:n,listId:e}),Object(p.f)({rules:t,listId:e,id:T.id,listType:T.type,listNamespaceType:T.namespace_type})]).then((()=>{K(!0),de()})).then((()=>K(!1))).then((()=>Y())).catch((e=>{X(e,void 0,g.A,g.B),I(!1)}))}catch(e){X(e)}}),[T,me,ge,e,de,X,Y]),ye=Object(i.useCallback)((()=>{ne(!1)}),[]);return{isLoading:w||x,invalidListId:M,isReadOnly:!(k||!S),list:T,listName:null==T?void 0:T.name,listDescription:null==T?void 0:T.description,listId:e,canUserEditList:R,linkedRules:D,exportedList:B,viewerStatus:L,showManageRulesFlyout:te,headerBackOptions:J,referenceModalState:U,showReferenceErrorModal:$,showManageButtonLoader:O,refreshExceptions:W,disableManageButton:G,handleDelete:le,onEditListDetails:ae,onExportList:ie,onDeleteList:se,onManageRules:pe,onSaveManageRules:be,onCancelManageRules:ye,onRuleSelectionChange:fe,handleCloseReferenceErrorModal:ce,handleReferenceDelete:ue}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return I}));var a=n(32),i=n(4),r=n.n(i),o=n(33),s=n.n(o),l=n(0),c=n(38),u=n(79),d=n(617),p=n(7),m=n(48),g=n(78),f=n(99),b=n(86),y=n(77),h=n(102),v=n(708),E=n(12),x=n(81),k=n(2);const S=s.a.div.withConfig({displayName:"AdditionalContent",componentId:"sc-19ewdav-0"})(["padding:2px;"]);S.displayName="AdditionalContent";const w=s.a.div.withConfig({displayName:"StyledHoverActionsContainer",componentId:"sc-19ewdav-1"})(["display:flex;"," ",""],(e=>e.$isActive?"\n    .hoverActions-active {\n      .timelines__hoverActionButton,\n      .securitySolution__hoverActionButton {\n        opacity: 1;\n      }\n    }\n  ":""),(e=>e.$showOwnFocus?`\n    &:focus-within {\n      .timelines__hoverActionButton,\n      .securitySolution__hoverActionButton {\n        opacity: 1;\n      }\n    }\n\n    &:hover {\n      .timelines__hoverActionButton,\n      .securitySolution__hoverActionButton {\n        opacity: 1;\n      }\n    }\n\n  .timelines__hoverActionButton,\n  .securitySolution__hoverActionButton {\n    opacity: ${e.$showTopN?1:0};\n\n      &:focus {\n        opacity: 1;\n      }\n    }\n  `:"")),j=s()(w).withConfig({displayName:"StyledHoverActionsContainerWithPaddingsAndMinWidth",componentId:"sc-19ewdav-2"})(["min-width:",";padding:",";position:relative;"],(({$hiddenActionsCount:e})=>138-26*e+"px"),(e=>`0 ${e.theme.eui.euiSizeS}`)),O=({ownFocus:e,showTopN:t})=>!t&&!e,I=r.a.memo((({additionalContent:e=null,closePopOver:t,closeTopN:n,dataProvider:o,dataType:s,draggableId:I,enableOverflowButton:T=!1,applyWidthAndPadding:C=!0,field:M,fieldType:N,isAggregatable:D,goGetTimelineId:F,isObjectArray:A,hideAddToTimeline:_=!1,hideTopN:R=!1,onFilterAdded:P,ownFocus:L,showOwnFocus:q=!0,showTopN:B,scopeId:z,toggleColumn:$,toggleTopN:V,values:U})=>{const[H,G]=Object(i.useState)(),[Q,W]=Object(i.useState)(!1),[K,Y]=Object(i.useState)(!1),J=Object(i.useCallback)((()=>{W((e=>!e)),Y(!K)}),[K,Y]),X=Object(i.useCallback)((()=>{n&&n(),W(!1),Y(!1),t&&t()}),[t,n]),Z=Object(i.useRef)(!0),ee=Object(i.useRef)(null);Object(i.useEffect)((()=>{Z.current&&null!=F&&null==z&&(Z.current=!1,F(!0))}),[F,z]),Object(i.useEffect)((()=>{L&&setTimeout((()=>{var e;null===(e=ee.current)||void 0===e||e.focus()}),0)}),[L]);const te=Object(i.useCallback)((e=>{if(L)switch(e.key){case d.a:Object(c.stopPropagationAndPreventDefault)(e),V();break;case"Enter":break;case"Escape":Object(c.stopPropagationAndPreventDefault)(e);break;default:G(e)}}),[L,V]),ne=z===u.j.casePage,ae=z===u.j.active,ie=z===u.j.detectionsAlertDetailsPage,re=z===k.a.entityAnalytics,oe=Object(i.useMemo)((()=>(ie||re)&&!ae),[ae,ie,re]),se=Object(i.useMemo)((()=>(R?1:0)+(oe?2:0)),[oe,R]),{overflowActionItems:le,allActionItems:ce}=(({dataProvider:e,dataType:t,defaultFocusedButtonRef:n,draggableId:o,enableOverflowButton:s,field:l,fieldType:c,isAggregatable:d,handleHoverActionClicked:k,hideFilters:S,hideTopN:w,hideAddToTimeline:j,isCaseView:O,isObjectArray:I,isOverflowPopoverOpen:T,itemsToShow:C=2,onFilterAdded:M,onOverflowButtonClick:N,ownFocus:D,showTopN:F,stKeyboardEvent:A,scopeId:_,toggleColumn:R,toggleTopN:P,values:L})=>{const q=Object(y.k)(),B=Object(g.useDispatch)(),{timelines:z,uiSettings:$}=q.services,{getAddToTimelineButton:V,getColumnToggleButton:U,getCopyButton:H,getFilterForValueButton:G,getFilterOutValueButton:Q,getOverflowButton:W}=z.getHoverActions(),K=Object(i.useMemo)((()=>q.services.data.query.filterManager),[q.services.data.query.filterManager]),Y=Object(i.useMemo)((()=>b.b.getTimelineByIdSelector()),[]),J=Object(x.a)((e=>{var t;return Object(f.isActiveTimeline)(null!=_?_:"")?null===(t=Y(e,null!=_?_:""))||void 0===t?void 0:t.filterManager:void 0})),X=Object(i.useMemo)((()=>Object(f.isActiveTimeline)(null!=_?_:"")?null!=J?J:new m.FilterManager($):K),[_,J,$,K]),Z=Object(i.useCallback)((()=>{e&&!Object(p.isEmpty)(e)&&B(Object(E.addProvider)({id:u.j.active,providers:e instanceof Array?e:[e]}))}),[e,B]),ee=Object(i.useCallback)((()=>{k&&k(),Z()}),[k,Z]),te=Object(i.useMemo)((()=>!S&&null!=L&&(s||!F&&!s)&&!O),[s,S,O,F,L]),ne=I&&"geo_point"!==l||O,ae=Object(i.useMemo)((()=>r.a.createElement(v.a,{Component:s?a.EuiContextMenuItem:void 0,"data-test-subj":"hover-actions-show-top-n",enablePopOver:!s&&O,field:l,key:"hover-actions-show-top-n",onClick:P,onFilterAdded:M,ownFocus:D,showTopN:F,showTooltip:!s,scopeId:_,value:L})),[s,O,l,P,M,D,F,_,L]),ie=Object(i.useMemo)((()=>[te?r.a.createElement("div",{"data-test-subj":"hover-actions-filter-for",key:"hover-actions-filter-for"},G({defaultFocusedButtonRef:n,field:l,filterManager:X,keyboardEvent:A,onClick:k,onFilterAdded:M,ownFocus:D,showTooltip:!s,value:L})):null,te?r.a.createElement("div",{"data-test-subj":"hover-actions-filter-out",key:"hover-actions-filter-out"},Q({field:l,filterManager:X,keyboardEvent:A,onFilterAdded:M,ownFocus:D,onClick:k,showTooltip:!s,value:L})):null,R&&!ne?r.a.createElement("div",{"data-test-subj":"hover-actions-toggle-column",key:"hover-actions-toggle-column"},U({Component:s?a.EuiContextMenuItem:void 0,field:l,isDisabled:I&&"geo_point"!==t,isObjectArray:I,keyboardEvent:A,ownFocus:D,onClick:k,showTooltip:!s,toggleColumn:R,value:L})):null,null==L||null==o&&Object(p.isEmpty)(e)||j?null:r.a.createElement("div",{"data-test-subj":"hover-actions-add-timeline",key:"hover-actions-add-timeline"},V({Component:s?a.EuiContextMenuItem:void 0,dataProvider:e,draggableId:o,field:l,keyboardEvent:A,ownFocus:D,onClick:ee,showTooltip:!s,value:L})),Object(h.d)({fieldType:c,isAggregatable:d,fieldName:l,hideTopN:w})?ae:null,null!=l?r.a.createElement("div",{"data-test-subj":"hover-actions-copy-button",key:"hover-actions-copy-button"},H({Component:s?a.EuiContextMenuItem:void 0,field:l,isHoverAction:!0,keyboardEvent:A,ownFocus:D,onClick:k,showTooltip:!s,value:L})):null].filter((e=>null!=e))),[e,t,n,o,s,l,c,d,X,V,U,H,G,Q,k,ee,j,w,I,M,D,ne,te,ae,A,R,L]);return{overflowActionItems:Object(i.useMemo)((()=>[...ie.slice(0,C),...s&&C>0&&C<ie.length?[W({closePopOver:k,field:l,keyboardEvent:A,ownFocus:D,onClick:N,showTooltip:!s,value:L,items:F?[ae]:ie.slice(C),isOverflowPopoverOpen:!!T})]:[]].filter((e=>null!=e))),[ie,s,l,W,k,T,C,N,ae,D,F,A,L]),allActionItems:Object(i.useMemo)((()=>!F||s||O?ie:[ae]),[F,s,O,ae,ie])}})({dataProvider:o,dataType:s,defaultFocusedButtonRef:ee,draggableId:I,enableOverflowButton:T&&!ne,field:M,fieldType:N,hideFilters:oe,isAggregatable:D,handleHoverActionClicked:X,hideAddToTimeline:_,hideTopN:R,isCaseView:ne,isObjectArray:A,isOverflowPopoverOpen:K,onFilterAdded:P,onOverflowButtonClick:J,ownFocus:L,showTopN:B,stKeyboardEvent:H,toggleColumn:$,toggleTopN:V,values:U,scopeId:z}),ue=C?j:w;return r.a.createElement(a.EuiFocusTrap,{disabled:O({ownFocus:L,showTopN:B})},r.a.createElement(ue,{onKeyDown:te,$showTopN:B,$showOwnFocus:q,$hiddenActionsCount:se,$isActive:Q,className:Q?"hoverActions-active":""},r.a.createElement(a.EuiScreenReaderOnly,null,r.a.createElement("p",null,(de=M,l.i18n.translate("xpack.securitySolution.dragAndDrop.youAreInADialogContainingOptionsScreenReaderOnly",{values:{fieldName:de},defaultMessage:"You are in a dialog, containing options for field {fieldName}. Press tab to navigate options. Press escape to exit."})))),null!=e&&r.a.createElement(S,null,e),T&&!ne?le:ce));var de}));I.displayName="HoverActions"},function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return S})),n.d(t,"c",(function(){return w}));var a=n(43),i=n.n(a),r=n(87),o=n(0);const s=o.i18n.translate("xpack.securitySolution.formatted.duration.noDurationTooltip",{defaultMessage:"no duration"}),l=o.i18n.translate("xpack.securitySolution.formatted.duration.invalidDurationTooltip",{defaultMessage:"invalid duration"}),c=o.i18n.translate("xpack.securitySolution.formatted.duration.aNanosecondTooltip",{defaultMessage:"a nanosecond"}),u=o.i18n.translate("xpack.securitySolution.formatted.duration.aFewNanosecondsTooltip",{defaultMessage:"a few nanoseconds"}),d=o.i18n.translate("xpack.securitySolution.formatted.duration.aMillisecondTooltip",{defaultMessage:"a millisecond"}),p=o.i18n.translate("xpack.securitySolution.formatted.duration.aFewMillisecondsTooltip",{defaultMessage:"a few milliseconds"}),m=o.i18n.translate("xpack.securitySolution.formatted.duration.aSecondTooltip",{defaultMessage:"a second"}),g=o.i18n.translate("xpack.securitySolution.formatted.duration.zeroNanosecondsTooltip",{defaultMessage:"zero nanoseconds"}),f=1e6,b=1e3,y=e=>Number.isInteger(e.milliseconds())?`${e.milliseconds()}ms`:`${e.milliseconds().toFixed(6)}ms`,h=e=>`${e.seconds().toFixed()}s${e.milliseconds()>0?` ${y(e)}`:""}`,v=e=>`${e.minutes()}m ${h(e)}`,E=e=>`${e.hours()}h ${v(e)}`,x=e=>`${e.days()}d ${E(e)}`,k=e=>`${e.years()>0||e.months()>0?`${e.months()}m `:""}${x(e)}`,S=e=>{const t=Number(e);if(null==e)return Object(r.e)();if(Number.isNaN(t)||t<0)return`${e}`;if(t<f)return`${t}ns`;const n=i.a.duration(t/f),a=n.asMilliseconds();return a<b?y(n):a<6e4?h(n):a<36e5?v(n):a<864e5?E(n):a<2592e6?x(n):a<31536e6?k(n):(e=>`${e.years()>0?`${e.years()}y `:""}${k(e)}`)(n)},w=e=>{if(null==e)return s;const t=Number(e);if(Number.isNaN(t)||t<0)return l;if(0===t)return g;if(1===t)return c;if(t<f)return u;if(t===f)return d;const n=t/f;return n<b?p:n===b?m:i.a.duration(n).humanize()}},,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(33),i=n.n(a),r=n(4),o=n.n(r),s=(n(36),n(32)),l=n(14);const c=({text:e,className:t})=>{const{euiTheme:n}=Object(s.useEuiTheme)();return o.a.createElement(u,{label:null!=e?e:l.a,size:"s",className:t,$_css:n.size.s,$_css2:n.colors.text})};var u=i()(s.EuiBetaBadge).withConfig({displayName:"_StyledEuiBetaBadge",componentId:"sc-oot5f7-0"})(["margin-left:",";color:",";"],(e=>e.$_css),(e=>e.$_css2))},function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return l}));var a=n(85),i=n(253),r=n(134);const o=e=>({...e.page.queries,[r.HostsTableType.authentications]:{...e.page.queries[r.HostsTableType.authentications],activePage:i.a},[r.HostsTableType.hosts]:{...e.page.queries[r.HostsTableType.hosts],activePage:i.a},[r.HostsTableType.events]:{...e.page.queries[r.HostsTableType.events],activePage:i.a},[r.HostsTableType.uncommonProcesses]:{...e.page.queries[r.HostsTableType.uncommonProcesses],activePage:i.a}}),s=e=>({...e.details.queries,[r.HostsTableType.authentications]:{...e.details.queries[r.HostsTableType.authentications],activePage:i.a},[r.HostsTableType.hosts]:{...e.details.queries[r.HostsTableType.hosts],activePage:i.a},[r.HostsTableType.events]:{...e.details.queries[r.HostsTableType.events],activePage:i.a},[r.HostsTableType.uncommonProcesses]:{...e.details.queries[r.HostsTableType.uncommonProcesses],activePage:i.a}}),l=(e,t)=>e.length>0?[{query:{bool:{should:e.map((e=>({match_phrase:{[t===a.v.user?a.w.userRisk:a.w.hostRisk]:{query:e}}})))}},meta:{alias:null,disabled:!1,negate:!1}}]:[]},function(e,t,n){"use strict";n.d(t,"h",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"g",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return d}));var a=n(0);const i=a.i18n.translate("xpack.securitySolution.hosts.pageTitle",{defaultMessage:"Hosts"}),r=a.i18n.translate("xpack.securitySolution.hosts.navigation.allHostsTitle",{defaultMessage:"All hosts"}),o=a.i18n.translate("xpack.securitySolution.hosts.navigation.authenticationsTitle",{defaultMessage:"Authentications"}),s=a.i18n.translate("xpack.securitySolution.hosts.navigation.uncommonProcessesTitle",{defaultMessage:"Uncommon processes"}),l=a.i18n.translate("xpack.securitySolution.hosts.navigation.anomaliesTitle",{defaultMessage:"Anomalies"}),c=a.i18n.translate("xpack.securitySolution.hosts.navigation.eventsTitle",{defaultMessage:"Events"}),u=a.i18n.translate("xpack.securitySolution.hosts.navigation.hostRiskTitle",{defaultMessage:"Host risk"}),d=a.i18n.translate("xpack.securitySolution.hosts.navigation.sessionsTitle",{defaultMessage:"Sessions"});a.i18n.translate("xpack.securitySolution.hosts.navigaton.matrixHistogram.errorFetchingEventsData",{defaultMessage:"Failed to query events data"}),a.i18n.translate("xpack.securitySolution.hosts.navigaton.hostRisk.viewDashboardButtonLabel",{defaultMessage:"View source dashboard"}),a.i18n.translate("xpack.securitySolution.hosts.navigaton.hostScoreOverTimeTitle",{defaultMessage:"Host risk score over time"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(4),i=n.n(a),r=n(33),o=n.n(r),s=n(123);const l=o.a.div.withConfig({displayName:"ProviderContainerComponent",componentId:"sc-ifkluc-0"})([""," ",""],(({isDragging:e})=>!e&&Object(r.css)(["&{border-radius:2px;padding:0 4px 0 8px;position:relative;z-index:"," !important;&::before{background-image:linear-gradient( 135deg,"," 25%,transparent 25% ),linear-gradient( -135deg,"," 25%,transparent 25% ),linear-gradient( 135deg,transparent 75%,"," 75% ),linear-gradient( -135deg,transparent 75%,"," 75% );background-position:0 0,1px 0,1px -1px,0px 1px;background-size:2px 2px;bottom:2px;content:'';display:block;left:2px;position:absolute;top:2px;width:4px;}}&:hover{&,& .euiBadge,& .euiBadge__text{cursor:move;cursor:grab;}}.",":hover &,tr:hover &{&::before{background-image:linear-gradient( 135deg,"," 25%,transparent 25% ),linear-gradient( -135deg,"," 25%,transparent 25% ),linear-gradient( 135deg,transparent 75%,"," 75% ),linear-gradient( -135deg,transparent 75%,"," 75% );}}&:hover,&:focus,.",":hover &:hover,.",":focus &:focus,tr:hover &:hover,tr:hover &:focus{background-color:",";&,& a,& a:hover{color:",";}&::before{background-image:linear-gradient( 135deg,"," 25%,transparent 25% ),linear-gradient( -135deg,"," 25%,transparent 25% ),linear-gradient( 135deg,transparent 75%,"," 75% ),linear-gradient( -135deg,transparent 75%,"," 75% );}}"],(({theme:e})=>e.eui.euiZLevel0),(({theme:e})=>e.eui.euiColorMediumShade),(({theme:e})=>e.eui.euiColorMediumShade),(({theme:e})=>e.eui.euiColorMediumShade),(({theme:e})=>e.eui.euiColorMediumShade),s.f,(({theme:e})=>e.eui.euiColorDarkShade),(({theme:e})=>e.eui.euiColorDarkShade),(({theme:e})=>e.eui.euiColorDarkShade),(({theme:e})=>e.eui.euiColorDarkShade),s.f,s.f,(({theme:e})=>e.eui.euiColorPrimary),(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiColorEmptyShade))),(({isDragging:e})=>e&&Object(r.css)(["&{z-index:9999 !important;}"])));l.displayName="ProviderContainerComponent";const c=i.a.memo(l);c.displayName="ProviderContainer"},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var a=n(0);const i=a.i18n.translate("xpack.securitySolution.dragAndDrop.copyToClipboardTooltip",{defaultMessage:"Copy to Clipboard"}),r=a.i18n.translate("xpack.securitySolution.dragAndDrop.draggableKeyboardInstructionsNotDraggingScreenReaderOnly",{defaultMessage:"Press enter for options, or press space to begin dragging."});a.i18n.translate("xpack.securitySolution.dragAndDrop.fieldLabel",{defaultMessage:"Field"}),a.i18n.translate("xpack.securitySolution.dragAndDrop.closeButtonLabel",{defaultMessage:"Close"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(32),i=n(4),r=n.n(i),o=n(121),s=n(897);const l=r.a.memo((({hideActions:e=[],modalTitle:t,onClose:n,onOpen:i})=>r.a.createElement(a.EuiModal,{"data-test-subj":"open-timeline-modal",maxWidth:1100,onClose:n},r.a.createElement(s.a,{closeModalTimeline:n,hideActions:e,isModal:!0,defaultPageSize:10,onOpenTimeline:i,title:null!=t?t:o.F}))));l.displayName="OpenTimelineModal"},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(32),i=n(4),r=n.n(i),o=n(33);const s=n.n(o)()((({iconSide:e,children:t,...n})=>r.a.createElement(a.EuiLink,n,t))).withConfig({displayName:"Link",componentId:"sc-142a1cw-0"})(["",""],(({iconSide:e,theme:t})=>Object(o.css)(["align-items:center;display:inline-flex;vertical-align:top;white-space:nowrap;"," ",""],"left"===e&&Object(o.css)([".euiIcon{margin-right:",";}"],t.eui.euiSizeXS),"right"===e&&Object(o.css)(["flex-direction:row-reverse;.euiIcon{margin-left:",";}"],t.eui.euiSizeXS))));s.displayName="Link";const l=r.a.memo((({ariaLabel:e,children:t,color:n,dataTestSubj:o,disabled:l,href:c,iconSide:u="left",iconSize:d="s",iconType:p,onClick:m})=>{const g=Object(i.useCallback)((e=>"object"==typeof e&&null!=e&&"props"in e&&e.props&&e.props.children?g(e.props.children):null!=e&&Object.keys(e).length>0?e:""),[]),f=Object(i.useMemo)((()=>e||g(t)),[e,t,g]);return r.a.createElement(s,{className:"siemLinkIcon",color:n,"data-test-subj":o,disabled:l,href:c,iconSide:u,onClick:m,"aria-label":f},r.a.createElement(a.EuiIcon,{size:d,type:p}),r.a.createElement("span",{className:"siemLinkIcon__label"},t))}));l.displayName="LinkIcon"},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=(e,t)=>{const n=window.URL.createObjectURL(e),a=document.createElement("a");a.href=n,a.download=t,a.click(),window.URL.revokeObjectURL(n),a.remove()}},function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var a=n(32),i=n(34),r=n(4),o=n.n(r),s=n(33),l=n.n(s),c=n(79),u=n(599),d=n(136),p=n(121),m=n(87),g=n(296),f=n(85);const b=l()(a.EuiFlexItem).withConfig({displayName:"TimelineContentItem",componentId:"sc-37b7dw-0"})(["max-width:calc(100% - 56px);"]),y=l()(a.EuiFilterButton).withConfig({displayName:"StyledEuiFilterButton",componentId:"sc-37b7dw-1"})(["border-top:0;border-bottom:0;"]),h=({hideUntitled:e=!1,getSelectableOptions:t,onClosePopover:n,onTimelineChange:s,timelineType:l,placeholder:h})=>{const[v,E]=Object(r.useState)(50),[x,k]=Object(r.useState)(0),[S,w]=Object(r.useState)(""),[j,O]=Object(r.useState)(!1),{fetchAllTimeline:I,timelines:T,loading:C,totalCount:M}=Object(u.b)(),N=Object(r.useRef)(null),D=Object(r.useRef)(null),F=Object(r.useMemo)((()=>Object(i.debounce)(500,w)),[]),A=Object(r.useCallback)((e=>{F(e)}),[F]),_=Object(r.useCallback)((()=>{O(!j)}),[j]),R=Object(r.useCallback)(((e,t,n)=>{if(e<t&&N.current&&D.current){const e=N.current.clientHeight,t=D.current.clientHeight,a=1.2*e;n>10&&t-n<a&&t>x&&(k(t),E(v+50))}}),[x,v]),P=Object(r.useCallback)(((e,t)=>{const n=Object(d.f)({...e,title:e.timelineTitle})?p.Y:e.timelineTitle,r=null!=e.description&&e.description.trim().length>0?e.description:null;return o.a.createElement(a.EuiFlexGroup,{gutterSize:"s",justifyContent:"spaceBetween",alignItems:"center",responsive:!1},o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(a.EuiIcon,{type:"on"===e.checked?"check":"empty",color:"primary"})),o.a.createElement(b,{grow:!0},o.a.createElement(a.EuiFlexGroup,{gutterSize:"none",direction:"column",responsive:!1},o.a.createElement(a.EuiFlexItem,{"data-test-subj":"timeline"},o.a.createElement(a.EuiToolTip,{content:n,anchorClassName:"eui-textTruncate eui-alignMiddle"},o.a.createElement(a.EuiHighlight,{search:t},n))),o.a.createElement(a.EuiFlexItem,null,o.a.createElement(a.EuiToolTip,{content:r,anchorClassName:"eui-textTruncate eui-alignMiddle"},o.a.createElement(a.EuiTextColor,{color:"subdued",component:"span"},o.a.createElement("small",null,null!=r?r:Object(m.d)())))))),o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(a.EuiIcon,{type:null!=e.favorite&&Object(i.isEmpty)(e.favorite)?"starEmpty":"starFilled"})))}),[]),L=Object(r.useCallback)((e=>{const t=e.filter((e=>"on"===e.checked));var a;null!=t&&t.length>0&&s(Object(i.isEmpty)(t[0].timelineTitle)?p.Y:t[0].timelineTitle,"-1"===t[0].id?null:t[0].id,null!==(a=t[0].graphEventId)&&void 0!==a?a:""),n()}),[n,s]),q=Object(r.useCallback)(((e,t)=>o.a.createElement(o.a.Fragment,null,t,e)),[]),B=Object(r.useMemo)((()=>({"data-test-subj":"timeline-super-select-search-box",placeholder:null!=h?h:g.e(l),onSearch:A,incremental:!1,append:o.a.createElement(y,{"data-test-subj":"only-favorites-toggle",hasActiveFilters:j,onClick:_},p.B)})),[_,A,j,l,h]),z=Object(r.useMemo)((()=>({rowHeight:50,showIcons:!1,windowProps:{onScroll:({scrollOffset:t})=>R((null!=T?T:[]).filter((t=>!e||""!==t.title)).length,M,t),outerRef:N,innerRef:D}})),[R,e,M,T]);return Object(r.useEffect)((()=>{I({pageInfo:{pageIndex:1,pageSize:v},search:S,sort:{sortField:c.f.updated,sortOrder:f.b.desc},onlyUserFavorite:j,status:null,timelineType:l})}),[I,j,v,S,l]),o.a.createElement(a.EuiSelectable,{"data-test-subj":"selectable-input",height:260,isLoading:C&&null==T,listProps:z,renderOption:P,onChange:L,searchable:!0,searchProps:B,singleSelection:!0,options:($=t({timelines:null!=T?T:[],onlyFavorites:j,searchTimelineValue:S,timelineType:l}),$.map((({title:e,...t})=>({...t,title:void 0,timelineTitle:e}))))},q);var $},v=Object(r.memo)(h)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,i=(a=n(4))&&"object"==typeof a&&"default"in a?a:{default:a},r=e=>"checkbox"===e.type,o=e=>e instanceof Date,s=e=>null==e;const l=e=>"object"==typeof e;var c=e=>!s(e)&&!Array.isArray(e)&&l(e)&&!o(e),u=e=>c(e)&&e.target?r(e.target)?e.target.checked:e.target.value:e,d=(e,t)=>e.has((e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e)(t)),p=e=>Array.isArray(e)?e.filter(Boolean):[],m=e=>void 0===e,g=(e,t,n)=>{if(!t||!c(e))return n;const a=p(t.split(/[,[\].]+?/)).reduce(((e,t)=>s(e)?e:e[t]),e);return m(a)||a===e?m(e[t])?n:e[t]:a};const f="blur",b="onChange",y="onSubmit",h="all",v="pattern",E="required",x=i.default.createContext(null),k=()=>i.default.useContext(x);var S=(e,t,n,a=!0)=>{const i={defaultValues:t._defaultValues};for(const r in e)Object.defineProperty(i,r,{get:()=>{const i=r;return t._proxyFormState[i]!==h&&(t._proxyFormState[i]=!a||h),n&&(n[i]=!0),e[i]}});return i},w=e=>c(e)&&!Object.keys(e).length,j=(e,t,n)=>{const{name:a,...i}=e;return w(i)||Object.keys(i).length>=Object.keys(t).length||Object.keys(i).find((e=>t[e]===(!n||h)))},O=e=>Array.isArray(e)?e:[e],I=(e,t,n)=>n&&t?e===t:!e||!t||e===t||O(e).some((e=>e&&(e.startsWith(t)||t.startsWith(e))));function T(e){const t=i.default.useRef(e);t.current=e,i.default.useEffect((()=>{const n=!e.disabled&&t.current.subject.subscribe({next:t.current.callback});return()=>{n&&n.unsubscribe()}}),[e.disabled])}function C(e){const t=k(),{control:n=t.control,disabled:a,name:r,exact:o}=e||{},[s,l]=i.default.useState(n._formState),c=i.default.useRef(!0),u=i.default.useRef({isDirty:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1}),d=i.default.useRef(r);return d.current=r,T({disabled:a,callback:i.default.useCallback((e=>c.current&&I(d.current,e.name,o)&&j(e,u.current)&&l({...n._formState,...e})),[n,o]),subject:n._subjects.state}),i.default.useEffect((()=>(c.current=!0,()=>{c.current=!1})),[]),S(s,n,u.current,!1)}var M=e=>"string"==typeof e,N=(e,t,n,a)=>{const i=Array.isArray(e);return M(e)?(a&&t.watch.add(e),g(n,e)):i?e.map((e=>(a&&t.watch.add(e),g(n,e)))):(a&&(t.watchAll=!0),n)},D=e=>"function"==typeof e,F=e=>{for(const t in e)if(D(e[t]))return!0;return!1};function A(e){const t=k(),{control:n=t.control,name:a,defaultValue:r,disabled:o,exact:s}=e||{},l=i.default.useRef(a);l.current=a,T({disabled:o,subject:n._subjects.watch,callback:i.default.useCallback((e=>{if(I(l.current,e.name,s)){const t=N(l.current,n._names,e.values||n._formValues);d(m(l.current)||c(t)&&!F(t)?{...t}:Array.isArray(t)?[...t]:m(t)?r:t)}}),[n,s,r])});const[u,d]=i.default.useState(m(r)?n._getWatch(a):r);return i.default.useEffect((()=>n._removeUnmounted())),u}function _(e){const t=k(),{name:n,control:a=t.control,shouldUnregister:r}=e,o=d(a._names.array,n),s=A({control:a,name:n,defaultValue:g(a._formValues,n,g(a._defaultValues,n,e.defaultValue)),exact:!0}),l=C({control:a,name:n}),c=i.default.useRef(a.register(n,{...e.rules,value:s}));return i.default.useEffect((()=>{const e=(e,t)=>{const n=g(a._fields,e);n&&(n._f.mount=t)};return e(n,!0),()=>{const t=a._options.shouldUnregister||r;(o?t&&!a._stateFlags.action:t)?a.unregister(n):e(n,!1)}}),[n,a,o,r]),{field:{name:n,value:s,onChange:i.default.useCallback((e=>c.current.onChange({target:{value:u(e),name:n},type:"change"})),[n]),onBlur:i.default.useCallback((()=>c.current.onBlur({target:{value:g(a._formValues,n),name:n},type:f})),[n,a]),ref:e=>{const t=g(a._fields,n);t&&e&&(t._f.ref={focus:()=>e.focus(),select:()=>e.select(),setCustomValidity:t=>e.setCustomValidity(t),reportValidity:()=>e.reportValidity()})}},formState:l,fieldState:Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!g(l.errors,n)},isDirty:{enumerable:!0,get:()=>!!g(l.dirtyFields,n)},isTouched:{enumerable:!0,get:()=>!!g(l.touchedFields,n)},error:{enumerable:!0,get:()=>g(l.errors,n)}})}}var R=(e,t,n,a,i)=>t?{...n[e],types:{...n[e]&&n[e].types?n[e].types:{},[a]:i||!0}}:{},P=e=>/^\w*$/.test(e),L=e=>p(e.replace(/["|']|\]/g,"").split(/\.|\[/));function q(e,t,n){let a=-1;const i=P(t)?[t]:L(t),r=i.length,o=r-1;for(;++a<r;){const t=i[a];let r=n;if(a!==o){const n=e[t];r=c(n)||Array.isArray(n)?n:isNaN(+i[a+1])?{}:[]}e[t]=r,e=e[t]}return e}const B=(e,t,n)=>{for(const a of n||Object.keys(e)){const n=g(e,a);if(n){const{_f:e,...a}=n;if(e&&t(e.name)){if(e.ref.focus){e.ref.focus();break}if(e.refs&&e.refs[0].focus){e.refs[0].focus();break}}else c(a)&&B(a,t)}}};var z=()=>{const e="undefined"==typeof performance?Date.now():1e3*performance.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const n=(16*Math.random()+e)%16|0;return("x"==t?n:3&n|8).toString(16)}))},$=(e,t,n={})=>n.shouldFocus||m(n.shouldFocus)?n.focusName||`${e}.${m(n.focusIndex)?t:n.focusIndex}.`:"",V=(e,t,n)=>!n&&(t.watchAll||t.watch.has(e)||[...t.watch].some((t=>e.startsWith(t)&&/^\.\w+/.test(e.slice(t.length))))),U=(e,t,n)=>{const a=p(g(e,n));return q(a,"root",t[n]),q(e,n,a),e},H=e=>"boolean"==typeof e,G=e=>"file"===e.type,Q=e=>M(e)||i.default.isValidElement(e),W=e=>"radio"===e.type,K=e=>e instanceof RegExp;const Y={value:!1,isValid:!1},J={value:!0,isValid:!0};var X=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter((e=>e&&e.checked&&!e.disabled)).map((e=>e.value));return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!m(e[0].attributes.value)?m(e[0].value)||""===e[0].value?J:{value:e[0].value,isValid:!0}:J:Y}return Y};const Z={isValid:!1,value:null};var ee=e=>Array.isArray(e)?e.reduce(((e,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:e),Z):Z;function te(e,t,n="validate"){if(Q(e)||Array.isArray(e)&&e.every(Q)||H(e)&&!e)return{type:n,message:Q(e)?e:"",ref:t}}var ne=e=>c(e)&&!K(e)?e:{value:e,message:""},ae=async(e,t,n,a,i)=>{const{ref:o,refs:l,required:u,maxLength:d,minLength:p,min:m,max:g,pattern:f,validate:b,name:y,valueAsNumber:h,mount:x,disabled:k}=e._f;if(!x||k)return{};const S=l?l[0]:o,j=e=>{a&&M(e)&&(S.setCustomValidity(e),S.reportValidity())},O={},I=W(o),T=r(o),C=I||T,N=(h||G(o))&&!o.value||""===t||Array.isArray(t)&&!t.length,F=R.bind(null,y,n,O),A=(e,t,n,a="maxLength",i="minLength")=>{const r=e?t:n;O[y]={type:e?a:i,message:r,ref:o,...F(e?a:i,r)}};if(i?!Array.isArray(t)||!t.length:u&&(!C&&(N||s(t))||H(t)&&!t||T&&!X(l).isValid||I&&!ee(l).isValid)){const{value:e,message:t}=Q(u)?{value:!!u,message:u}:ne(u);if(e&&(O[y]={type:E,message:t,ref:S,...F(E,t)},!n))return j(t),O}if(!(N||s(m)&&s(g))){let e,a;const i=ne(g),r=ne(m);if(s(t)||isNaN(t)){const n=o.valueAsDate||new Date(t),s=e=>new Date((new Date).toDateString()+" "+e),l="time"==o.type,c="week"==o.type;M(i.value)&&t&&(e=l?s(t)>s(i.value):c?t>i.value:n>new Date(i.value)),M(r.value)&&t&&(a=l?s(t)<s(r.value):c?t<r.value:n<new Date(r.value))}else{const n=o.valueAsNumber||(t?+t:t);s(i.value)||(e=n>i.value),s(r.value)||(a=n<r.value)}if((e||a)&&(A(!!e,i.message,r.message,"max","min"),!n))return j(O[y].message),O}if((d||p)&&!N&&(M(t)||i&&Array.isArray(t))){const e=ne(d),a=ne(p),i=!s(e.value)&&t.length>e.value,r=!s(a.value)&&t.length<a.value;if((i||r)&&(A(i,e.message,a.message),!n))return j(O[y].message),O}if(f&&!N&&M(t)){const{value:e,message:a}=ne(f);if(K(e)&&!t.match(e)&&(O[y]={type:v,message:a,ref:o,...F(v,a)},!n))return j(a),O}if(b)if(D(b)){const e=te(await b(t),S);if(e&&(O[y]={...e,...F("validate",e.message)},!n))return j(e.message),O}else if(c(b)){let e={};for(const a in b){if(!w(e)&&!n)break;const i=te(await b[a](t),S,a);i&&(e={...i,...F(a,i.message)},j(i.message),n&&(O[y]=e))}if(!w(e)&&(O[y]={ref:S,...e},!n))return O}return j(!0),O};function ie(e,t){return[...e,...O(t)]}var re="undefined"!=typeof window&&void 0!==window.HTMLElement&&"undefined"!=typeof document;function oe(e){let t;const n=Array.isArray(e);if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set(e);else{if(re&&(e instanceof Blob||e instanceof FileList)||!n&&!c(e))return e;if(t=n?[]:{},Array.isArray(e)||(e=>{const t=e.constructor&&e.constructor.prototype;return c(t)&&t.hasOwnProperty("isPrototypeOf")})(e))for(const n in e)t[n]=oe(e[n]);else t=e}return t}var se=e=>Array.isArray(e)?e.map((()=>{})):void 0,le=e=>({isOnSubmit:!e||e===y,isOnBlur:"onBlur"===e,isOnChange:e===b,isOnAll:e===h,isOnTouch:"onTouched"===e});function ce(e,t,n){return[...e.slice(0,t),...O(n),...e.slice(t)]}var ue=(e,t,n)=>Array.isArray(e)?(m(e[n])&&(e[n]=void 0),e.splice(n,0,e.splice(t,1)[0]),e):[];function de(e,t){return[...O(t),...O(e)]}var pe=(e,t)=>m(t)?[]:function(e,t){let n=0;const a=[...e];for(const e of t)a.splice(e-n,1),n++;return p(a).length?a:[]}(e,O(t).sort(((e,t)=>e-t))),me=(e,t,n)=>{e[t]=[e[n],e[n]=e[t]][0]};function ge(e){for(const t in e)if(!m(e[t]))return!1;return!0}function fe(e,t){const n=P(t)?[t]:L(t),a=1==n.length?e:function(e,t){const n=t.slice(0,-1).length;let a=0;for(;a<n;)e=m(e)?a++:e[t[a++]];return e}(e,n),i=n[n.length-1];let r;a&&delete a[i];for(let t=0;t<n.slice(0,-1).length;t++){let a,i=-1;const o=n.slice(0,-(t+1)),s=o.length-1;for(t>0&&(r=e);++i<o.length;){const t=o[i];a=a?a[t]:e[t],s===i&&(c(a)&&w(a)||Array.isArray(a)&&ge(a))&&(r?delete r[t]:delete e[t]),r=a}}return e}var be=(e,t,n)=>(e[t]=n,e);function ye(){let e=[];return{get observers(){return e},next:t=>{for(const n of e)n.next(t)},subscribe:t=>(e.push(t),{unsubscribe:()=>{e=e.filter((e=>e!==t))}}),unsubscribe:()=>{e=[]}}}var he=e=>s(e)||!l(e);function ve(e,t){if(he(e)||he(t))return e===t;if(o(e)&&o(t))return e.getTime()===t.getTime();const n=Object.keys(e),a=Object.keys(t);if(n.length!==a.length)return!1;for(const i of n){const n=e[i];if(!a.includes(i))return!1;if("ref"!==i){const e=t[i];if(o(n)&&o(e)||c(n)&&c(e)||Array.isArray(n)&&Array.isArray(e)?!ve(n,e):n!==e)return!1}}return!0}var Ee=e=>{const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},xe=e=>"select-multiple"===e.type,ke=e=>Ee(e)&&e.isConnected;function Se(e,t={}){const n=Array.isArray(e);if(c(e)||n)for(const n in e)Array.isArray(e[n])||c(e[n])&&!F(e[n])?(t[n]=Array.isArray(e[n])?[]:{},Se(e[n],t[n])):s(e[n])||(t[n]=!0);return t}var we=(e,t)=>function e(t,n,a){const i=Array.isArray(t);if(c(t)||i)for(const i in t)Array.isArray(t[i])||c(t[i])&&!F(t[i])?m(n)||he(a[i])?a[i]=Array.isArray(t[i])?Se(t[i],[]):{...Se(t[i])}:e(t[i],s(n)?{}:n[i],a[i]):ve(t[i],n[i])?delete a[i]:a[i]=!0;return a}(e,t,Se(t)),je=(e,{valueAsNumber:t,valueAsDate:n,setValueAs:a})=>m(e)?e:t?""===e?NaN:e?+e:e:n&&M(e)?new Date(e):a?a(e):e;function Oe(e){const t=e.ref;if(!(e.refs?e.refs.every((e=>e.disabled)):t.disabled))return G(t)?t.files:W(t)?ee(e.refs).value:xe(t)?[...t.selectedOptions].map((({value:e})=>e)):r(t)?X(e.refs).value:je(m(t.value)?e.ref.value:t.value,e)}var Ie=e=>m(e)?void 0:K(e)?e.source:c(e)?K(e.value)?e.value.source:e.value:e;function Te(e,t,n){const a=g(e,n);if(a||P(n))return{error:a,name:n};const i=n.split(".");for(;i.length;){const a=i.join("."),r=g(t,a),o=g(e,a);if(r&&!Array.isArray(r)&&n!==a)return{name:n};if(o&&o.type)return{name:a,error:o};i.pop()}return{name:n}}const Ce={mode:y,reValidateMode:b,shouldFocusError:!0};function Me(e={}){let t,n={...Ce,...e},a={submitCount:0,isDirty:!1,isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},errors:{}},i={},l=oe(n.defaultValues)||{},c=n.shouldUnregister?{}:oe(l),b={action:!1,mount:!1,watch:!1},y={mount:new Set,unMount:new Set,array:new Set,watch:new Set},v=0,E={};const x={isDirty:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},k={watch:ye(),array:ye(),state:ye()},S=le(n.mode),j=le(n.reValidateMode),I=n.criteriaMode===h,T=async()=>{let e=!1;return x.isValid&&(e=n.resolver?w((await _()).errors):await R(i,!0),e!==a.isValid&&(a.isValid=e,k.state.next({isValid:e}))),e},C=(e,t,n,a)=>{const r=g(i,e);if(r){const i=g(c,e,m(n)?g(l,e):n);m(i)||a&&a.defaultChecked||t?q(c,e,t?i:Oe(r._f)):z(e,i),b.mount&&T()}},F=(e,t,n,i,r)=>{let o=!1;const s={name:e},c=g(a.touchedFields,e);if(x.isDirty){const e=a.isDirty;a.isDirty=s.isDirty=P(),o=e!==s.isDirty}if(x.dirtyFields&&(!n||i)){const n=g(a.dirtyFields,e);ve(g(l,e),t)?fe(a.dirtyFields,e):q(a.dirtyFields,e,!0),s.dirtyFields=a.dirtyFields,o=o||n!==g(a.dirtyFields,e)}return n&&!c&&(q(a.touchedFields,e,n),s.touchedFields=a.touchedFields,o=o||x.touchedFields&&c!==n),o&&r&&k.state.next(s),o?s:{}},A=(n,i,r,o)=>{const s=g(a.errors,n),l=x.isValid&&H(i)&&a.isValid!==i;var c;if(e.delayError&&r?(c=()=>((e,t)=>{q(a.errors,e,t),k.state.next({errors:a.errors})})(n,r),t=e=>{clearTimeout(v),v=window.setTimeout(c,e)},t(e.delayError)):(clearTimeout(v),t=null,r?q(a.errors,n,r):fe(a.errors,n)),(r?!ve(s,r):s)||!w(o)||l){const e={...o,...l&&H(i)?{isValid:i}:{},errors:a.errors,name:n};a={...a,...e},k.state.next(e)}E[n]--,x.isValidating&&!Object.values(E).some((e=>e))&&(k.state.next({isValidating:!1}),E={})},_=async e=>n.resolver?await n.resolver({...c},n.context,((e,t,n,a)=>{const i={};for(const n of e){const e=g(t,n);e&&q(i,n,e._f)}return{criteriaMode:n,names:[...e],fields:i,shouldUseNativeValidation:a}})(e||y.mount,i,n.criteriaMode,n.shouldUseNativeValidation)):{},R=async(e,t,i={valid:!0})=>{for(const r in e){const o=e[r];if(o){const{_f:e,...r}=o;if(e){const r=y.array.has(e.name),s=await ae(o,g(c,e.name),I,n.shouldUseNativeValidation,r);if(s[e.name]&&(i.valid=!1,t))break;!t&&(g(s,e.name)?r?U(a.errors,s,e.name):q(a.errors,e.name,s[e.name]):fe(a.errors,e.name))}r&&await R(r,t,i)}}return i.valid},P=(e,t)=>(e&&t&&q(c,e,t),!ve(J(),l)),L=(e,t,n)=>{const a={...b.mount?c:m(t)?l:M(e)?{[e]:t}:t};return N(e,y,a,n)},z=(e,t,n={})=>{const a=g(i,e);let o=t;if(a){const n=a._f;n&&(!n.disabled&&q(c,e,je(t,n)),o=re&&Ee(n.ref)&&s(t)?"":t,xe(n.ref)?[...n.ref.options].forEach((e=>e.selected=o.includes(e.value))):n.refs?r(n.ref)?n.refs.length>1?n.refs.forEach((e=>(!e.defaultChecked||!e.disabled)&&(e.checked=Array.isArray(o)?!!o.find((t=>t===e.value)):o===e.value))):n.refs[0]&&(n.refs[0].checked=!!o):n.refs.forEach((e=>e.checked=e.value===o)):G(n.ref)?n.ref.value="":(n.ref.value=o,n.ref.type||k.watch.next({name:e})))}(n.shouldDirty||n.shouldTouch)&&F(e,o,n.shouldTouch,n.shouldDirty,!0),n.shouldValidate&&Y(e)},$=(e,t,n)=>{for(const a in t){const r=t[a],s=`${e}.${a}`,l=g(i,s);!y.array.has(e)&&he(r)&&(!l||l._f)||o(r)?z(s,r,n):$(s,r,n)}},Q=(e,t,n={})=>{const r=g(i,e),o=y.array.has(e),u=oe(t);q(c,e,u),o?(k.array.next({name:e,values:c}),(x.isDirty||x.dirtyFields)&&n.shouldDirty&&(a.dirtyFields=we(l,c),k.state.next({name:e,dirtyFields:a.dirtyFields,isDirty:P(e,u)}))):!r||r._f||s(u)?z(e,u,n):$(e,u,n),V(e,y)&&k.state.next({}),k.watch.next({name:e})},K=async e=>{const r=e.target;let o=r.name;const s=g(i,o);if(s){let d,p;const m=r.type?Oe(s._f):u(e),b=e.type===f||"focusout"===e.type,h=!((l=s._f).mount&&(l.required||l.min||l.max||l.maxLength||l.minLength||l.pattern||l.validate)||n.resolver||g(a.errors,o)||s._f.deps)||((e,t,n,a,i)=>!i.isOnAll&&(!n&&i.isOnTouch?!(t||e):(n?a.isOnBlur:i.isOnBlur)?!e:!(n?a.isOnChange:i.isOnChange)||e))(b,g(a.touchedFields,o),a.isSubmitted,j,S),v=V(o,y,b);q(c,o,m),b?(s._f.onBlur&&s._f.onBlur(e),t&&t(0)):s._f.onChange&&s._f.onChange(e);const O=F(o,m,b,!1),C=!w(O)||v;if(!b&&k.watch.next({name:o,type:e.type}),h)return x.isValid&&T(),C&&k.state.next({name:o,...v?{}:O});if(!b&&v&&k.state.next({}),E[o]=E[o]?E[o]+1:1,k.state.next({isValidating:!0}),n.resolver){const{errors:e}=await _([o]),t=Te(a.errors,i,o),n=Te(e,i,t.name||o);d=n.error,o=n.name,p=w(e)}else d=(await ae(s,g(c,o),I,n.shouldUseNativeValidation))[o],T();s._f.deps&&Y(s._f.deps),A(o,p,d,O)}var l},Y=async(e,t={})=>{let r,o;const s=O(e);if(k.state.next({isValidating:!0}),n.resolver){const t=await(async e=>{const{errors:t}=await _();if(e)for(const n of e){const e=g(t,n);e?q(a.errors,n,e):fe(a.errors,n)}else a.errors=t;return t})(m(e)?e:s);r=w(t),o=e?!s.some((e=>g(t,e))):r}else e?(o=(await Promise.all(s.map((async e=>{const t=g(i,e);return await R(t&&t._f?{[e]:t}:t)})))).every(Boolean),(o||a.isValid)&&T()):o=r=await R(i);return k.state.next({...!M(e)||x.isValid&&r!==a.isValid?{}:{name:e},...n.resolver||!e?{isValid:r}:{},errors:a.errors,isValidating:!1}),t.shouldFocus&&!o&&B(i,(e=>e&&g(a.errors,e)),e?s:y.mount),o},J=e=>{const t={...l,...b.mount?c:{}};return m(e)?t:M(e)?g(t,e):e.map((e=>g(t,e)))},X=(e,t)=>({invalid:!!g((t||a).errors,e),isDirty:!!g((t||a).dirtyFields,e),isTouched:!!g((t||a).touchedFields,e),error:g((t||a).errors,e)}),Z=(e,t={})=>{for(const r of e?O(e):y.mount)y.mount.delete(r),y.array.delete(r),g(i,r)&&(t.keepValue||(fe(i,r),fe(c,r)),!t.keepError&&fe(a.errors,r),!t.keepDirty&&fe(a.dirtyFields,r),!t.keepTouched&&fe(a.touchedFields,r),!n.shouldUnregister&&!t.keepDefaultValue&&fe(l,r));k.watch.next({}),k.state.next({...a,...t.keepDirty?{isDirty:P()}:{}}),!t.keepIsValid&&T()},ee=(e,t={})=>{let a=g(i,e);const o=H(t.disabled);return q(i,e,{...a||{},_f:{...a&&a._f?a._f:{ref:{name:e}},name:e,mount:!0,...t}}),y.mount.add(e),a?o&&q(c,e,t.disabled?void 0:g(c,e,Oe(a._f))):C(e,!0,t.value),{...o?{disabled:t.disabled}:{},...n.shouldUseNativeValidation?{required:!!t.required,min:Ie(t.min),max:Ie(t.max),minLength:Ie(t.minLength),maxLength:Ie(t.maxLength),pattern:Ie(t.pattern)}:{},name:e,onChange:K,onBlur:K,ref:o=>{if(o){ee(e,t),a=g(i,e);const n=m(o.value)&&o.querySelectorAll&&o.querySelectorAll("input,select,textarea")[0]||o,s=(e=>W(e)||r(e))(n),c=a._f.refs||[];if(s?c.find((e=>e===n)):n===a._f.ref)return;q(i,e,{_f:{...a._f,...s?{refs:[...c.filter(ke),n,...Array.isArray(g(l,e))?[{}]:[]],ref:{type:n.type,name:e}}:{ref:n}}}),C(e,!1,void 0,n)}else a=g(i,e,{}),a._f&&(a._f.mount=!1),(n.shouldUnregister||t.shouldUnregister)&&(!d(y.array,e)||!b.action)&&y.unMount.add(e)}}},te=()=>n.shouldFocusError&&B(i,(e=>e&&g(a.errors,e)),y.mount);return{control:{register:ee,unregister:Z,getFieldState:X,_executeSchema:_,_focusError:te,_getWatch:L,_getDirty:P,_updateValid:T,_removeUnmounted:()=>{for(const e of y.unMount){const t=g(i,e);t&&(t._f.refs?t._f.refs.every((e=>!ke(e))):!ke(t._f.ref))&&Z(e)}y.unMount=new Set},_updateFieldArray:(e,t=[],n,r,o=!0,s=!0)=>{if(r&&n){if(b.action=!0,s&&Array.isArray(g(i,e))){const t=n(g(i,e),r.argA,r.argB);o&&q(i,e,t)}if(x.errors&&s&&Array.isArray(g(a.errors,e))){const t=n(g(a.errors,e),r.argA,r.argB);o&&q(a.errors,e,t),((e,t)=>{!p(g(e,t)).length&&fe(e,t)})(a.errors,e)}if(x.touchedFields&&s&&Array.isArray(g(a.touchedFields,e))){const t=n(g(a.touchedFields,e),r.argA,r.argB);o&&q(a.touchedFields,e,t)}x.dirtyFields&&(a.dirtyFields=we(l,c)),k.state.next({isDirty:P(e,t),dirtyFields:a.dirtyFields,errors:a.errors,isValid:a.isValid})}else q(c,e,t)},_getFieldArray:t=>p(g(b.mount?c:l,t,e.shouldUnregister?g(l,t,[]):[])),_subjects:k,_proxyFormState:x,get _fields(){return i},get _formValues(){return c},get _stateFlags(){return b},set _stateFlags(e){b=e},get _defaultValues(){return l},get _names(){return y},set _names(e){y=e},get _formState(){return a},set _formState(e){a=e},get _options(){return n},set _options(e){n={...n,...e}}},trigger:Y,register:ee,handleSubmit:(e,t)=>async r=>{r&&(r.preventDefault&&r.preventDefault(),r.persist&&r.persist());let o=!0,s=oe(c);k.state.next({isSubmitting:!0});try{if(n.resolver){const{errors:e,values:t}=await _();a.errors=e,s=t}else await R(i);w(a.errors)?(k.state.next({errors:{},isSubmitting:!0}),await e(s,r)):(t&&await t({...a.errors},r),te())}catch(e){throw o=!1,e}finally{a.isSubmitted=!0,k.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:w(a.errors)&&o,submitCount:a.submitCount+1,errors:a.errors})}},watch:(e,t)=>D(e)?k.watch.subscribe({next:n=>e(L(void 0,t),n)}):L(e,t,!0),setValue:Q,getValues:J,reset:(t,n)=>((t,n={})=>{const r=t||l,o=oe(r),s=t&&!w(t)?o:l;if(n.keepDefaultValues||(l=r),!n.keepValues){if(n.keepDirtyValues)for(const e of y.mount)g(a.dirtyFields,e)?q(s,e,g(c,e)):Q(e,g(s,e));else{if(re&&m(t))for(const e of y.mount){const t=g(i,e);if(t&&t._f){const e=Array.isArray(t._f.refs)?t._f.refs[0]:t._f.ref;if(Ee(e)){const t=e.closest("form");if(t){t.reset();break}}}}i={}}c=e.shouldUnregister?n.keepDefaultValues?oe(l):{}:o,k.array.next({values:s}),k.watch.next({values:s})}y={mount:new Set,unMount:new Set,array:new Set,watch:new Set,watchAll:!1,focus:""},b.mount=!x.isValid||!!n.keepIsValid,b.watch=!!e.shouldUnregister,k.state.next({submitCount:n.keepSubmitCount?a.submitCount:0,isDirty:n.keepDirty||n.keepDirtyValues?a.isDirty:!(!n.keepDefaultValues||ve(t,l)),isSubmitted:!!n.keepIsSubmitted&&a.isSubmitted,dirtyFields:n.keepDirty||n.keepDirtyValues?a.dirtyFields:n.keepDefaultValues&&t?we(l,t):{},touchedFields:n.keepTouched?a.touchedFields:{},errors:n.keepErrors?a.errors:{},isSubmitting:!1,isSubmitSuccessful:!1})})(D(t)?t(c):t,n),resetField:(e,t={})=>{g(i,e)&&(m(t.defaultValue)?Q(e,g(l,e)):(Q(e,t.defaultValue),q(l,e,t.defaultValue)),t.keepTouched||fe(a.touchedFields,e),t.keepDirty||(fe(a.dirtyFields,e),a.isDirty=t.defaultValue?P(e,g(l,e)):P()),t.keepError||(fe(a.errors,e),x.isValid&&T()),k.state.next({...a}))},clearErrors:e=>{e?O(e).forEach((e=>fe(a.errors,e))):a.errors={},k.state.next({errors:a.errors})},unregister:Z,setError:(e,t,n)=>{const r=(g(i,e,{_f:{}})._f||{}).ref;q(a.errors,e,{...t,ref:r}),k.state.next({name:e,errors:a.errors,isValid:!1}),n&&n.shouldFocus&&r&&r.focus&&r.focus()},setFocus:(e,t={})=>{const n=g(i,e),a=n&&n._f;if(a){const e=a.refs?a.refs[0]:a.ref;e.focus&&(e.focus(),t.shouldSelect&&e.select())}},getFieldState:X}}t.Controller=e=>e.render(_(e)),t.FormProvider=e=>{const{children:t,...n}=e;return i.default.createElement(x.Provider,{value:n},t)},t.appendErrors=R,t.get=g,t.set=q,t.useController=_,t.useFieldArray=function(e){const t=k(),{control:n=t.control,name:a,keyName:r="id",shouldUnregister:o}=e,[s,l]=i.default.useState(n._getFieldArray(a)),c=i.default.useRef(n._getFieldArray(a).map(z)),u=i.default.useRef(s),d=i.default.useRef(a),p=i.default.useRef(!1);d.current=a,u.current=s,n._names.array.add(a),e.rules&&n.register(a,e.rules),T({callback:i.default.useCallback((({values:e,name:t})=>{if(t===d.current||!t){const t=g(e,d.current);Array.isArray(t)&&(l(t),c.current=t.map(z))}}),[]),subject:n._subjects.array});const m=i.default.useCallback((e=>{p.current=!0,n._updateFieldArray(a,e)}),[n,a]);return i.default.useEffect((()=>{if(n._stateFlags.action=!1,V(a,n._names)&&n._subjects.state.next({}),p.current&&(!le(n._options.mode).isOnSubmit||n._formState.isSubmitted))if(n._options.resolver)n._executeSchema([a]).then((e=>{const t=g(e.errors,a),i=g(n._formState.errors,a);(i?!t&&i.type:t&&t.type)&&(t?q(n._formState.errors,a,t):fe(n._formState.errors,a),n._subjects.state.next({errors:n._formState.errors}))}));else{const e=g(n._fields,a);e&&e._f&&ae(e,g(n._formValues,a),n._options.criteriaMode===h,n._options.shouldUseNativeValidation,!0).then((e=>!w(e)&&n._subjects.state.next({errors:U(n._formState.errors,e,a)})))}n._subjects.watch.next({name:a,values:n._formValues}),n._names.focus&&B(n._fields,(e=>!!e&&e.startsWith(n._names.focus))),n._names.focus="",n._proxyFormState.isValid&&n._updateValid()}),[s,a,n]),i.default.useEffect((()=>(!g(n._formValues,a)&&n._updateFieldArray(a),()=>{(n._options.shouldUnregister||o)&&n.unregister(a)})),[a,n,r,o]),{swap:i.default.useCallback(((e,t)=>{const i=n._getFieldArray(a);me(i,e,t),me(c.current,e,t),m(i),l(i),n._updateFieldArray(a,i,me,{argA:e,argB:t},!1)}),[m,a,n]),move:i.default.useCallback(((e,t)=>{const i=n._getFieldArray(a);ue(i,e,t),ue(c.current,e,t),m(i),l(i),n._updateFieldArray(a,i,ue,{argA:e,argB:t},!1)}),[m,a,n]),prepend:i.default.useCallback(((e,t)=>{const i=O(oe(e)),r=de(n._getFieldArray(a),i);n._names.focus=$(a,0,t),c.current=de(c.current,i.map(z)),m(r),l(r),n._updateFieldArray(a,r,de,{argA:se(e)})}),[m,a,n]),append:i.default.useCallback(((e,t)=>{const i=O(oe(e)),r=ie(n._getFieldArray(a),i);n._names.focus=$(a,r.length-1,t),c.current=ie(c.current,i.map(z)),m(r),l(r),n._updateFieldArray(a,r,ie,{argA:se(e)})}),[m,a,n]),remove:i.default.useCallback((e=>{const t=pe(n._getFieldArray(a),e);c.current=pe(c.current,e),m(t),l(t),n._updateFieldArray(a,t,pe,{argA:e})}),[m,a,n]),insert:i.default.useCallback(((e,t,i)=>{const r=O(oe(t)),o=ce(n._getFieldArray(a),e,r);n._names.focus=$(a,e,i),c.current=ce(c.current,e,r.map(z)),m(o),l(o),n._updateFieldArray(a,o,ce,{argA:e,argB:se(t)})}),[m,a,n]),update:i.default.useCallback(((e,t)=>{const i=oe(t),r=be(n._getFieldArray(a),e,i);c.current=[...r].map(((t,n)=>t&&n!==e?c.current[n]:z())),m(r),l([...r]),n._updateFieldArray(a,r,be,{argA:e,argB:i},!0,!1)}),[m,a,n]),replace:i.default.useCallback((e=>{const t=O(oe(e));c.current=t.map(z),m([...t]),l([...t]),n._updateFieldArray(a,[...t],(e=>e),{},!0,!1)}),[m,a,n]),fields:i.default.useMemo((()=>s.map(((e,t)=>({...e,[r]:c.current[t]||z()})))),[s,r])}},t.useForm=function(e={}){const t=i.default.useRef(),[n,a]=i.default.useState({isDirty:!1,isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},errors:{},defaultValues:e.defaultValues});t.current||(t.current={...Me(e),formState:n});const r=t.current.control;return r._options=e,T({subject:r._subjects.state,callback:i.default.useCallback((e=>{j(e,r._proxyFormState,!0)&&(r._formState={...r._formState,...e},a({...r._formState}))}),[r])}),i.default.useEffect((()=>{r._stateFlags.mount||(r._proxyFormState.isValid&&r._updateValid(),r._stateFlags.mount=!0),r._stateFlags.watch&&(r._stateFlags.watch=!1,r._subjects.state.next({})),r._removeUnmounted()})),i.default.useEffect((()=>{n.submitCount&&r._focusError()}),[r,n.submitCount]),t.current.formState=S(n,r),t.current},t.useFormContext=k,t.useFormState=C,t.useWatch=A},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(0).i18n.translate("xpack.securitySolution.alertsView.osqueryAlertTitle",{defaultMessage:"Run Osquery"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(135),i=n(83),r=n(4),o=n(299),s=n(84),l=n(185),c=n(186),u=n(457),d=n(300),p=n(813);const m=e=>({query:{bool:{filter:[{bool:{should:[{match:{"signal.rule.id":e}},{match:{[a.L]:e}}],minimum_should_match:1}}]}},size:1}),g=e=>{const{isFetching:t,data:n,error:a,refetch:o}=Object(p.a)(e,!1),{addError:g}=Object(s.a)(),b=!Object(i.s)(a),{loading:y,data:h}=Object(c.a)({query:m(e),skip:b,queryName:l.a.BY_RULE_ID});Object(r.useEffect)((()=>{null==a||Object(i.s)(a)||g(a,{title:d.b})}),[g,a]);const v=Object(r.useMemo)((()=>{const e=b?n:null==h?void 0:f(h);if(e)return Object(u.a)(e)}),[b,h,n]);return{error:a,loading:t||y,refresh:o,rule:null!=v?v:null,isExistingRule:b}},f=e=>{var t,n,a,i;if(0===e.hits.hits.length)return;const r=e.hits.hits[0],s=null!==(t=null===(n=r._source.signal)||void 0===n?void 0:n.rule)&&void 0!==t?t:null===(a=r._source.kibana)||void 0===a||null===(i=a.alert)||void 0===i?void 0:i.rule;if(null==s){var l,c,u,d,p,m;const e=Object(o.a)(null!==(l=r._source)&&void 0!==l?l:{}),t={...null==e||null===(c=e.kibana)||void 0===c||null===(u=c.alert)||void 0===u?void 0:u.rule,...null==e||null===(d=e.kibana)||void 0===d||null===(p=d.alert)||void 0===p||null===(m=p.rule)||void 0===m?void 0:m.parameters};return delete t.parameters,t}return s}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(4);const i=e=>{const[t,n]=Object(a.useState)(null),i=Object(a.useRef)(null);return Object(a.useEffect)((()=>{var e,t,a,r,o,s,l,c,u;null!=(null===(e=i.current)||void 0===e?void 0:e.clientHeight)&&((null!==(t=null==i||null===(a=i.current)||void 0===a?void 0:a.scrollHeight)&&void 0!==t?t:0)>(null!==(r=null==i||null===(o=i.current)||void 0===o?void 0:o.clientHeight)&&void 0!==r?r:0)&&n(!0),(null!==(s=null===(l=i.current)||void 0===l?void 0:l.scrollHeight)&&void 0!==s?s:0)<=(null!==(c=null==i||null===(u=i.current)||void 0===u?void 0:u.clientHeight)&&void 0!==c?c:0)&&n(!1))}),[i,e]),[t,i]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n(1);var a=n(79);const i=[a.g.alertsOnAlertsPage,a.g.alertsOnRuleDetailsPage]},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(4),i=n.n(a),r=n(33);const o=n.n(r).a.div.withConfig({displayName:"Wrapper",componentId:"sc-1f8m9hq-0"})(["",""],(({theme:e})=>Object(r.css)(["margin-top:",";.siemSubtitle__item{color:",";font-size:",";line-height:",";@media only screen and (min-width:","){display:inline-block;margin-right:",";&:last-child{margin-right:0;}}}"],e.eui.euiSizeS,e.eui.euiTextSubduedColor,e.eui.euiFontSizeXS,e.eui.euiLineHeight,e.eui.euiBreakpoints.s,e.eui.euiSize)));o.displayName="Wrapper";const s=i.a.memo((({children:e,dataTestSubj:t="header-panel-subtitle"})=>"string"==typeof e?i.a.createElement("p",{className:"siemSubtitle__item siemSubtitle__item--text","data-test-subj":t},e):i.a.createElement("div",{className:"siemSubtitle__item siemSubtitle__item--node","data-test-subj":t},e)));s.displayName="SubtitleItem";const l=i.a.memo((({items:e})=>i.a.createElement(o,{className:"siemSubtitle"},Array.isArray(e)?e.map(((e,t)=>i.a.createElement(s,{key:t},e))):i.a.createElement(s,null,e))));l.displayName="Subtitle"},function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return p}));var a=n(32),i=n(4),r=n.n(i),o=n(33),s=n.n(o),l=n(557);const c="exit-full-screen",u=s()(a.EuiButton).withConfig({displayName:"StyledEuiButton",componentId:"sc-4dkrmi-0"})(["margin:",";"],(({theme:e})=>e.eui.euiSizeS)),d=({fullScreen:e,setFullScreen:t})=>{const n=Object(i.useCallback)((()=>{t(!1)}),[t]),o=Object(i.useCallback)((e=>{"Escape"===e.key&&(e.preventDefault(),n())}),[n]);return e?r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiWindowEvent,{event:"keydown",handler:o}),r.a.createElement(u,{className:c,"data-test-subj":"exit-full-screen",fullWidth:!1,iconType:"fullScreen",isDisabled:!e,onClick:n},l.a)):null};d.displayName="ExitFullScreenComponent";const p=r.a.memo(d)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a="t"},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return s}));var a=n(0);const i=a.i18n.translate("xpack.securitySolution.topN.closeButtonLabel",{defaultMessage:"Close"}),r=a.i18n.translate("xpack.securitySolution.topN.allEventsSelectLabel",{defaultMessage:"Alerts and events"}),o=a.i18n.translate("xpack.securitySolution.topN.rawEventsSelectLabel",{defaultMessage:"Raw events"}),s=a.i18n.translate("xpack.securitySolution.topN.alertEventsSelectLabel",{defaultMessage:"Detection alerts"})},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return o}));var a=n(0);const i=a.i18n.translate("xpack.securitySolution.eventsViewer.showingLabel",{defaultMessage:"Showing"}),r=(a.i18n.translate("xpack.securitySolution.eventsViewer.eventsLabel",{defaultMessage:"Events"}),e=>a.i18n.translate("xpack.securitySolution.eventsViewer.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {event} other {events}}"})),o=a.i18n.translate("xpack.securitySolution.eventsViewer.actionsColumnLabel",{defaultMessage:"Actions"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return P}));var a=n(82),i=n.n(a),r=n(32),o=n(4),s=n.n(o),l=n(49),c=n(34),u=n(252),d=n.n(u),p=n(117),m=n.n(p),g=n(33),f=n.n(g),b=n(92),y=n.n(b),h=n(102),v=n(77),E=n(460),x=n(198),k=n(191),S=n(303),w=n(861),j=n(297),O=n(424),I=n(530),T=n(211);const C=f()(r.EuiFlexItem).withConfig({displayName:"LegendFlexItem",componentId:"sc-9bd0gp-0"})(["overview:hidden;"]),M=e=>null!=e&&!!Object(c.get)("value.length",e)&&(e.value||[]).every((({x:e,y:t})=>Object(c.isNumber)(t)&&t>=0)),N=["y"],D=[e=>Object(k.a)(e.g)?e.g:S.c],F=({data:e,forceHiddenLegend:t=!1,yAxisTitle:n,...a})=>{const r=Object(j.i)(),u=Object(v.n)(),p=Object(c.get)("configs.axis.xTickFormatter",a),m=Object(c.get)("configs.axis.yTickFormatter",a),g=Object(c.getOr)(0,"configs.axis.tickSize",a),f=`stat-items-barchart-${e[0].key}-x`,b=`stat-items-barchart-${e[0].key}-y`,y={...j.e,...d()(Object(c.get)("configs.settings",a),{theme:r})},h=Object(o.useMemo)((()=>d()({tickLine:{size:g}},Object(c.getOr)({},"configs.axis.bottom.style",a))),[a,g]),E=Object(o.useMemo)((()=>d()({tickLine:{size:g}},Object(c.getOr)({},"configs.axis.left.style",a))),[a,g]),x=Object(c.get)("configs.axis.bottom.labelFormat",a);return a.width&&a.height?s.a.createElement(l.Chart,null,s.a.createElement(l.Settings,i()({},y,{showLegend:y.showLegend&&!t})),e.map((e=>{var t;const n=e.key;return M(e)?s.a.createElement(l.BarSeries,{id:n,key:n,name:e.key,xScaleType:Object(c.getOr)(l.ScaleType.Linear,"configs.series.xScaleType",a),yScaleType:Object(c.getOr)(l.ScaleType.Linear,"configs.series.yScaleType",a),xAccessor:"x",yAccessors:N,timeZone:u,splitSeriesAccessors:D,data:null!==(t=e.value)&&void 0!==t?t:[],stackAccessors:Object(c.get)("configs.series.stackAccessors",a),color:e.color?e.color:void 0,barSeriesStyle:Object(c.get)("configs.series.barSeriesStyle",a)}):null})),s.a.createElement(l.Axis,{id:f,position:l.Position.Bottom,showOverlappingTicks:!1,style:h,tickFormat:p,labelFormat:x}),s.a.createElement(l.Axis,{id:b,position:l.Position.Left,style:E,tickFormat:m,title:n})):null};F.displayName="BarChartBaseComponent";const A=s.a.memo(F);A.displayName="BarChartBase";const _=[],R=({barChart:e,configs:t,stackByField:n,scopeId:a,visualizationActionsOptions:l})=>{const{ref:u,width:d,height:p}=Object(x.b)(),g=Object(o.useMemo)((()=>null!=e&&null!=n?e.map(((e,t)=>{var i;return{color:null!==(i=e.color)&&void 0!==i?i:t<E.a.length?E.a[t]:void 0,dataProviderId:Object(h.h)(`draggable-legend-item-${m.a.v4()}-${n}-${e.key}`),scopeId:a,field:n,value:e.key}})):_),[e,n,a]),f=Object(c.get)("yAxisTitle",t),b=Object(c.get)("customHeight",t),y=Object(c.get)("customWidth",t),v=Object(j.g)(b,p),k=Object(j.h)(y,d),S=Object(o.useMemo)((()=>{return t=e,Array.isArray(t)&&!Object(j.f)(t)&&t.some(M);var t}),[e]);return s.a.createElement(j.d,null,s.a.createElement(T.a,{targetClassNames:[I.a]},S&&e&&s.a.createElement(j.a,{gutterSize:"none"},s.a.createElement(r.EuiFlexItem,{grow:!0},s.a.createElement(j.c,{ref:u,height:v},s.a.createElement(A,{configs:t,data:e,yAxisTitle:f,forceHiddenLegend:null!=n,height:v,width:v}))),s.a.createElement(C,{grow:!1},s.a.createElement(O.a,{legendItems:g,height:p}))),!S&&s.a.createElement(w.a,{height:v,width:k,data:e}),null!=l&&s.a.createElement(I.b,i()({},l,{className:"viz-actions"}))))},P=s.a.memo(R,((e,t)=>e.stackByField===t.stackByField&&e.scopeId===t.scopeId&&y()(e.configs,t.configs)&&y()(e.barChart,t.barChart)))},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(4),i=n.n(a),r=n(32),o=n(33);const s=n.n(o)()(r.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-1h00mnn-0"})(["flex:1;"]),l=()=>i.a.createElement(s,{alignItems:"center",justifyContent:"center",gutterSize:"none"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiLoadingSpinner,{size:"xl"}))),c=i.a.memo(l)},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"f",(function(){return r})),n.d(t,"g",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return c})),n.d(t,"h",(function(){return u})),n.d(t,"e",(function(){return d}));var a=n(0);const i=e=>a.i18n.translate("xpack.securitySolution.eventsTab.unit",{values:{totalCount:e},defaultMessage:"external {totalCount, plural, =1 {alert} other {alerts}}"}),r=e=>a.i18n.translate("xpack.securitySolution.hosts.navigaton.eventsUnit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {event} other {events}}"}),o=a.i18n.translate("xpack.securitySolution.eventsTab.showing",{defaultMessage:"Showing"}),s=a.i18n.translate("xpack.securitySolution.eventsTab.alertsGraphTitle",{defaultMessage:"External alert trend"}),l=a.i18n.translate("xpack.securitySolution.eventsTab.errorFetchingAlertsData",{defaultMessage:"Failed to query alerts data"}),c=a.i18n.translate("xpack.securitySolution.eventsTab.errorFetchingEventsData",{defaultMessage:"Failed to query events data"}),u=a.i18n.translate("xpack.securitySolution.eventsTab.showExternalAlerts",{defaultMessage:"Show only external alerts"}),d=a.i18n.translate("xpack.securitySolution.eventsGraphTitle",{defaultMessage:"Events"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return m}));var a=n(32),i=n(33),r=n.n(i),o=n(4),s=n.n(o),l=n(531),c=n(532),u=n(409);const d=r()(a.EuiPanel).withConfig({displayName:"KpiPanel",componentId:"sc-1kirhxq-0"})(["display:flex;flex-direction:column;position:relative;overflow-x:hidden;overflow-y:",";@media only screen and (min-width:","){","}",""],(({$overflowY:e})=>null!=e?e:"hidden"),(e=>e.theme.eui.euiBreakpoints.m),(({height:e,$toggleStatus:t})=>t&&`\n      height: ${null!=e?e:l.d}px;\n  `),(({$toggleStatus:e})=>e&&`\n    height: ${l.c}px;\n  `)),p=r.a.div.withConfig({displayName:"StackByComboBoxWrapper",componentId:"sc-1kirhxq-1"})(["max-width:400px;width:","px;"],(({width:e})=>e)),m=s.a.forwardRef((({"aria-label":e=u.c,"data-test-subj":t,isDisabled:n=!1,onSelect:i,prepend:r=u.d,selected:l,inputRef:d,width:m=400},g)=>{const f=Object(o.useCallback)((e=>{e&&e.length>0?i(e[0].value):i("")}),[i]),b=Object(o.useMemo)((()=>[{label:l,value:l}]),[l]),y=Object(c.b)(),h=Object(o.useMemo)((()=>({asPlainText:!0})),[]);return s.a.createElement(p,{width:m},s.a.createElement(a.EuiComboBox,{"data-test-subj":t,"aria-label":e,inputRef:d,isDisabled:n,placeholder:u.e,prepend:r,ref:g,singleSelection:h,isClearable:!1,sortMatchesBy:"startsWith",options:y,selectedOptions:b,compressed:!0,onChange:f}))}));m.displayName="StackByComboBox"},function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return l}));var a=n(4),i=n.n(a),r=n(88),o=n(257);const s="bytes",l=i.a.memo((({contextId:e,eventId:t,fieldName:n,fieldType:a,isAggregatable:s,isDraggable:l,value:c,scopeId:u})=>l?i.a.createElement(r.b,{id:`bytes-default-draggable-${e}-${t}-${n}-${c}`,fieldType:a,isAggregatable:s,isDraggable:l,name:name,field:n,tooltipContent:null,value:c,scopeId:u},i.a.createElement(o.a,{value:`${c}`})):i.a.createElement(o.a,{value:`${c}`})));l.displayName="Bytes"},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(85);const i=(e,t)=>t===a.g.source?[{fieldName:"source.ip",fieldValue:e}]:t===a.g.destination?[{fieldName:"destination.ip",fieldValue:e}]:[]},function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var a=n(40),i=n(4),r=n.n(i),o=n(1),s=n(77),l=n(87),c=n(221),u=n(396),d=n(430),p=n(160),m=n(187),g=n(506),f=n(120),b=n(171),y=n(124),h=n(354);const v=r.a.memo((({contextID:e,id:t,ip:n,data:i,isDraggable:v=!1,isInDetailsSidePanel:E=!1,loading:x,flowTarget:k,startDate:S,endDate:w,isLoadingAnomaliesData:j,anomaliesData:O,narrowDateRange:I,indexPatterns:T})=>{const C=Object(f.a)(),M=Object(b.a)(C),[N]=Object(s.q)(o.O),D=i[k],F=[{title:d.i,description:Object(c.g)([`${k}.geo.city_name`,`${k}.geo.region_name`],i,e,v)},{title:d.c,description:D?Object(c.d)(D.autonomousSystem,k,e,v):Object(l.d)()}],A=[M?[...F,{title:d.j,description:r.a.createElement(g.a,{anomalies:O,startDate:S,endDate:w,isLoading:j,narrowDateRange:I})}]:F,[{title:d.d,description:r.a.createElement(u.a,{indexPatterns:T,field:`${k}.ip`,value:n,type:u.b.FIRST_SEEN})},{title:d.h,description:r.a.createElement(u.a,{indexPatterns:T,field:`${k}.ip`,value:n,type:u.b.LAST_SEEN})}],[{title:d.e,description:D&&i.host?Object(c.e)({host:i.host,isDraggable:v,ipFilter:n,contextID:e}):Object(l.d)()},{title:d.f,description:D&&i.host?Object(c.f)(i.host,n,e,v):Object(l.d)()}],[{title:d.o,description:Object(c.i)(n)},{title:d.k,description:Object(c.h)(n)}]];return r.a.createElement(y.c,null,r.a.createElement(p.g,{direction:E?"column":"row"},!E&&r.a.createElement(y.b,{queryId:t,title:d.g,inspectIndex:0}),A.map(((e,t)=>r.a.createElement(h.a,{descriptionList:e,key:t}))),x&&r.a.createElement(m.a,{overlay:!0,overlayBackground:N?a.euiDarkVars.euiPageBackgroundColor:a.euiLightVars.euiPageBackgroundColor,size:"xl"})))}));v.displayName="IpOverview"},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(4),i=n.n(a),r=n(133),o=n(106),s=n(150),l=n(160),c=n(628);const u=({id:e,index:t=0,score:n})=>{const u=Object(c.a)(n.severity),d=Object(a.useMemo)((()=>({and:[],enabled:!0,id:e,name:n.entityName,excluded:!1,kqlQuery:"",queryMatch:{field:n.entityName,value:n.entityValue,operator:o.d}})),[e,n.entityName,n.entityValue]),p=Object(a.useCallback)(((e,n,a)=>a.isDragging?i.a.createElement(r.a,null,i.a.createElement(s.a,{dataProvider:e})):i.a.createElement(i.a.Fragment,null,0!==t&&i.a.createElement(i.a.Fragment,null,",",i.a.createElement(l.i,null)),u)),[t,u]);return i.a.createElement(r.b,{key:`draggable-score-draggable-wrapper-${e}`,dataProvider:d,render:p,isAggregatable:!0,fieldType:"keyword"})};u.displayName="DraggableScoreComponent";const d=i.a.memo(u);d.displayName="DraggableScore"},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(4),i=n.n(a),r=n(32);const o=e=>String(Math.ceil(e));i.a.memo((({score:e})=>{const t=o(e),n=s(e);return i.a.createElement(r.EuiHealth,{color:n},t)})).displayName="ScoreHealth";const s=e=>e>=75?"#fe5050":e>=50?"#fba740":e>=25?"#fdec25":e>=3?"#8bc8fb":e>=0?"#d2e9f7":"#ffffff"},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(4),i=n.n(a),r=n(32),o=n(62),s=n(77);const l=({score:e,startDate:t,endDate:n,linkName:a})=>{const{services:{ml:l,http:c}}=Object(s.k)(),u=Object(o.useMlHref)(l,c.basePath.get(),{page:"explorer",pageState:{jobIds:[e.jobId],timeRange:{from:new Date(t).toISOString(),to:new Date(n).toISOString(),mode:"absolute"},refreshInterval:{pause:!0,value:0,display:"Off"}}});return u?i.a.createElement(r.EuiLink,{href:u,target:"_blank"},a):null}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(4),i=n(37),r=n(81),o=n(149),s=n(95),l=n(94),c=n(98);function u(e){const t=Object(a.useMemo)((()=>Object(o.i)()),[]),n=Object(a.useMemo)((()=>Object(o.b)()),[]),u=Object(a.useMemo)((()=>Object(o.d)()),[]),d=Object(r.a)((t=>u(e?t.inputs.timeline:t.inputs.global))),p=Object(r.a)((n=>t(e?n.inputs.timeline:n.inputs.global))),m=Object(r.a)((t=>n(e?t.inputs.timeline:t.inputs.global))),g=Object(a.useMemo)((()=>c.e.defaultDataViewSelector()),[]),f=Object(r.a)(g),{pathname:b}=Object(i.useLocation)(),{selectedPatterns:y}=Object(l.d)(Object(l.a)(b)),{selectedPatterns:h}=Object(l.d)(s.SourcererScopeName.timeline);return{selectedPatterns:Object(a.useMemo)((()=>e?[...new Set([...h,...f.patternList])]:[...new Set([...y,...f.patternList])]),[e,h,y,f.patternList]),from:p,to:m,shouldUpdate:d}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"g",(function(){return o})),n.d(t,"h",(function(){return s})),n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return d}));var a=n(0);const i=a.i18n.translate("xpack.securitySolution.alerts.severityMapping.severityTitle",{defaultMessage:"Default severity"}),r=a.i18n.translate("xpack.securitySolution.alerts.severityMapping.defaultSeverityTitle",{defaultMessage:"Severity"}),o=a.i18n.translate("xpack.securitySolution.alerts.severityMapping.sourceFieldTitle",{defaultMessage:"Source field"}),s=a.i18n.translate("xpack.securitySolution.alerts.severityMapping.sourceValueTitle",{defaultMessage:"Source value"}),l=a.i18n.translate("xpack.securitySolution.alerts.severityMapping.severityMappingTitle",{defaultMessage:"Severity override"}),c=a.i18n.translate("xpack.securitySolution.alerts.severityMapping.defaultDescriptionLabel",{defaultMessage:"Select a severity level for all alerts generated by this rule."}),u=a.i18n.translate("xpack.securitySolution.alerts.severityMapping.mappingDescriptionLabel",{defaultMessage:"Use source event values to override the default severity."}),d=a.i18n.translate("xpack.securitySolution.alerts.severityMapping.mappingDetailsLabel",{defaultMessage:"For multiple matches the highest severity match will apply. If no match is found, the default severity will be used."})},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"h",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"c",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"g",(function(){return d}));var a=n(0);const i=a.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.riskScoreTitle",{defaultMessage:"Risk score"}),r=a.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.defaultRiskScoreTitle",{defaultMessage:"Default risk score"}),o=a.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.riskScoreFieldTitle",{defaultMessage:"kibana.alert.risk_score"}),s=a.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.sourceFieldTitle",{defaultMessage:"Source field"}),l=a.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.riskScoreMappingTitle",{defaultMessage:"Risk score override"}),c=a.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.defaultDescriptionLabel",{defaultMessage:"Select a risk score for all alerts generated by this rule."}),u=a.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.mappingDescriptionLabel",{defaultMessage:"Use a source event value to override the default risk score."}),d=a.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.mappingDetailsLabel",{defaultMessage:"If value is out of bounds, or field is not present, the default risk score will be used."})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(4),i=n.n(a),r=n(33),o=n.n(r),s=n(32);const l=o.a.div.withConfig({displayName:"StatusTextWrapper",componentId:"sc-185wwqd-0"})(["width:100%;display:inline-grid;"]),c=({tooltipContent:e,children:t,healthColor:n,dataTestSubj:a})=>i.a.createElement(s.EuiToolTip,{content:e},i.a.createElement(s.EuiHealth,{color:n,"data-test-subj":a},i.a.createElement(l,null,i.a.createElement("span",{className:"eui-textTruncate"},t))));c.displayName="HealthTruncateText"},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));var a=n(0);const i=a.i18n.translate("xpack.securitySolution.osquery.action.shortEmptyTitle",{defaultMessage:"Osquery is not available"}),r=a.i18n.translate("xpack.securitySolution.osquery.action.permissionDenied",{defaultMessage:"Permission denied"}),o=a.i18n.translate("xpack.securitySolution.osquery.action.unavailable",{defaultMessage:"The Osquery Manager integration is not added to the agent policy. To run queries on the host, add the Osquery Manager integration to the agent policy in Fleet."})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(4),i=n.n(a),r=n(32),o=n(181),s=n(196),l=n(176);const c=i.a.memo((({contextId:e,data:t,eventId:n,fieldFromBrowserField:a,getLinkValue:c,isDraggable:u=!1,linkValue:d,style:p,values:m})=>i.a.createElement(r.EuiFlexGroup,{alignItems:"flexStart","data-test-subj":`event-field-${t.field}`,direction:"column",gutterSize:"none",style:p},null!=m&&m.map(((p,m)=>{var g;return null==a?i.a.createElement(r.EuiFlexItem,{grow:!1,key:`${m}-${p}`},i.a.createElement(r.EuiText,{size:"xs",key:`${m}-${p}`},p)):i.a.createElement(r.EuiFlexItem,{className:"eventFieldsTable__fieldValue",grow:!1,key:`${m}-${p}`},t.field===l.h?i.a.createElement(o.a,{value:p}):i.a.createElement(s.a,{contextId:`${e}-${n}-${t.field}-${m}-${p}`,eventId:n,fieldFormat:t.format,fieldName:t.field,fieldType:t.type,isAggregatable:a.aggregatable,isDraggable:u,isObjectArray:t.isObjectArray,value:p,linkValue:null!==(g=c&&c(t.field))&&void 0!==g?g:d,truncate:!1}))})))));c.displayName="FieldValueCell"},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(34);const i=e=>null==e?"":Object(a.isObject)(e)?JSON.stringify(e):Object(a.isNumber)(e)?e:e.toString()},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(7),i=n(4),r=n(193),o=n(918),s=n(191),l=n(142);const c=({agentId:e})=>{const[t,n]=Object(i.useState)(!1),[c,u]=Object(i.useState)([]),[d,p]=Object(i.useState)(),[m,g]=Object(i.useState)(0),[f,b]=Object(i.useState)(0),[y,h]=Object(i.useState)(!1);return Object(i.useEffect)((()=>{const t=new AbortController;let i,c=!0;return h(!0),Object(a.isEmpty)(e)||(async()=>{try{const a=await Object(r.g)({agentId:e,signal:t.signal});c&&(n(Object(s.b)(a.metadata)),a.metadata.Endpoint.capabilities&&u([...a.metadata.Endpoint.capabilities]),p(a.host_status),i=a.metadata.elastic.agent.id)}catch(e){if("AbortError"===e.name)return;c&&400===e.body.statusCode&&p(l.b.UNENROLLED)}try{const{data:e}=await Object(o.a)(i);var a,d,m,f;c&&(g(null!==(a=null===(d=e[0].pending_actions)||void 0===d?void 0:d.isolate)&&void 0!==a?a:0),b(null!==(m=null===(f=e[0].pending_actions)||void 0===f?void 0:f.unisolate)&&void 0!==m?m:0))}catch(e){return}c&&h(!1)})(),()=>{c=!1,t.abort()}}),[e]),{loading:y,capabilities:c,isIsolated:t,agentStatus:d,pendingIsolation:m,pendingUnisolation:f}}},,function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"e",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"d",(function(){return l}));var a=n(0);const i=a.i18n.translate("xpack.securitySolution.entityAnalytics.totalLabel",{defaultMessage:"Total"}),r=a.i18n.translate("xpack.securitySolution.entityAnalytics.hostsRiskDashboard.title",{defaultMessage:"Host Risk Scores"}),o=a.i18n.translate("xpack.securitySolution.entityAnalytics.usersRiskDashboard.title",{defaultMessage:"User Risk Scores"}),s=a.i18n.translate("xpack.securitySolution.entityAnalytics.hostsRiskDashboard.hostsTableTooltip",{defaultMessage:"The host risk table is not affected by the time range. This table shows the latest recorded risk score for each host."}),l=a.i18n.translate("xpack.securitySolution.entityAnalytics.usersRiskDashboard.usersTableTooltip",{defaultMessage:"The user risk table is not affected by the time range. This table shows the latest recorded risk score for each user."})},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(0).i18n.translate("xpack.securitySolution.source.destination.packetsLabel",{defaultMessage:"pkts"})},function(e,t,n){!function(e){"use strict";function t(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function n(e){let n=e,a=e;function i(e,t,n,i){for(null==n&&(n=0),null==i&&(i=e.length);n<i;){const r=n+i>>>1;a(e[r],t)<0?n=r+1:i=r}return n}return 1===e.length&&(n=(t,n)=>e(t)-n,a=function(e){return(n,a)=>t(e(n),a)}(e)),{left:i,center:function(e,t,a,r){null==a&&(a=0),null==r&&(r=e.length);const o=i(e,t,a,r-1);return o>a&&n(e[o-1],t)>-n(e[o],t)?o-1:o},right:function(e,t,n,i){for(null==n&&(n=0),null==i&&(i=e.length);n<i;){const r=n+i>>>1;a(e[r],t)>0?i=r:n=r+1}return n}}}function a(e){return null===e?NaN:+e}const i=n(t),r=i.right,o=i.left,s=n(a).center;function l(e,t){let n=0;if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&++n;else{let a=-1;for(let i of e)null!=(i=t(i,++a,e))&&(i=+i)>=i&&++n}return n}function c(e){return 0|e.length}function u(e){return!(e>0)}function d(e){return"object"!=typeof e||"length"in e?e:Array.from(e)}function p(e,t){let n,a=0,i=0,r=0;if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&(n=t-i,i+=n/++a,r+=n*(t-i));else{let o=-1;for(let s of e)null!=(s=t(s,++o,e))&&(s=+s)>=s&&(n=s-i,i+=n/++a,r+=n*(s-i))}if(a>1)return r/(a-1)}function m(e,t){const n=p(e,t);return n?Math.sqrt(n):n}function g(e,t){let n,a;if(void 0===t)for(const t of e)null!=t&&(void 0===n?t>=t&&(n=a=t):(n>t&&(n=t),a<t&&(a=t)));else{let i=-1;for(let r of e)null!=(r=t(r,++i,e))&&(void 0===n?r>=r&&(n=a=r):(n>r&&(n=r),a<r&&(a=r)))}return[n,a]}class Adder{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const t=this._partials;let n=0;for(let a=0;a<this._n&&a<32;a++){const i=t[a],r=e+i,o=Math.abs(e)<Math.abs(i)?e-(r-i):i-(r-e);o&&(t[n++]=o),e=r}return t[n]=e,this._n=n+1,this}valueOf(){const e=this._partials;let t,n,a,i=this._n,r=0;if(i>0){for(r=e[--i];i>0&&(t=r,n=e[--i],r=t+n,a=n-(r-t),!a););i>0&&(a<0&&e[i-1]<0||a>0&&e[i-1]>0)&&(n=2*a,t=r+n,n==t-r&&(r=t))}return r}}class InternMap extends Map{constructor(e,t=h){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const[t,n]of e)this.set(t,n)}get(e){return super.get(f(this,e))}has(e){return super.has(f(this,e))}set(e,t){return super.set(b(this,e),t)}delete(e){return super.delete(y(this,e))}}class InternSet extends Set{constructor(e,t=h){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const t of e)this.add(t)}has(e){return super.has(f(this,e))}add(e){return super.add(b(this,e))}delete(e){return super.delete(y(this,e))}}function f({_intern:e,_key:t},n){const a=t(n);return e.has(a)?e.get(a):n}function b({_intern:e,_key:t},n){const a=t(n);return e.has(a)?e.get(a):(e.set(a,n),n)}function y({_intern:e,_key:t},n){const a=t(n);return e.has(a)&&(n=e.get(n),e.delete(a)),n}function h(e){return null!==e&&"object"==typeof e?e.valueOf():e}function v(e){return e}function E(e,...t){return S(e,v,v,t)}function x(e,t,...n){return S(e,v,t,n)}function k(e){if(1!==e.length)throw new Error("duplicate key");return e[0]}function S(e,t,n,a){return function e(i,r){if(r>=a.length)return n(i);const o=new InternMap,s=a[r++];let l=-1;for(const e of i){const t=s(e,++l,i),n=o.get(t);n?n.push(e):o.set(t,[e])}for(const[t,n]of o)o.set(t,e(n,r));return t(o)}(e,0)}function w(e,t){return Array.from(t,(t=>e[t]))}function j(e,...n){if("function"!=typeof e[Symbol.iterator])throw new TypeError("values is not iterable");e=Array.from(e);let[a=t]=n;if(1===a.length||n.length>1){const i=Uint32Array.from(e,((e,t)=>t));return n.length>1?(n=n.map((t=>e.map(t))),i.sort(((e,a)=>{for(const i of n){const n=t(i[e],i[a]);if(n)return n}}))):(a=e.map(a),i.sort(((e,n)=>t(a[e],a[n])))),w(e,i)}return e.sort(a)}var O=Array.prototype.slice;function I(e){return function(){return e}}var T=Math.sqrt(50),C=Math.sqrt(10),M=Math.sqrt(2);function N(e,t,n){var a,i,r,o,s=-1;if(n=+n,(e=+e)==(t=+t)&&n>0)return[e];if((a=t<e)&&(i=e,e=t,t=i),0===(o=D(e,t,n))||!isFinite(o))return[];if(o>0){let n=Math.round(e/o),a=Math.round(t/o);for(n*o<e&&++n,a*o>t&&--a,r=new Array(i=a-n+1);++s<i;)r[s]=(n+s)*o}else{o=-o;let n=Math.round(e*o),a=Math.round(t*o);for(n/o<e&&++n,a/o>t&&--a,r=new Array(i=a-n+1);++s<i;)r[s]=(n+s)/o}return a&&r.reverse(),r}function D(e,t,n){var a=(t-e)/Math.max(0,n),i=Math.floor(Math.log(a)/Math.LN10),r=a/Math.pow(10,i);return i>=0?(r>=T?10:r>=C?5:r>=M?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(r>=T?10:r>=C?5:r>=M?2:1)}function F(e,t,n){let a;for(;;){const i=D(e,t,n);if(i===a||0===i||!isFinite(i))return[e,t];i>0?(e=Math.floor(e/i)*i,t=Math.ceil(t/i)*i):i<0&&(e=Math.ceil(e*i)/i,t=Math.floor(t*i)/i),a=i}}function A(e){return Math.ceil(Math.log(l(e))/Math.LN2)+1}function _(){var e=v,t=g,n=A;function a(a){Array.isArray(a)||(a=Array.from(a));var i,o,s=a.length,l=new Array(s);for(i=0;i<s;++i)l[i]=e(a[i],i,a);var c=t(l),u=c[0],d=c[1],p=n(l,u,d);if(!Array.isArray(p)){const e=d,n=+p;if(t===g&&([u,d]=F(u,d,n)),(p=N(u,d,n))[p.length-1]>=d)if(e>=d&&t===g){const e=D(u,d,n);isFinite(e)&&(e>0?d=(Math.floor(d/e)+1)*e:e<0&&(d=(Math.ceil(d*-e)+1)/-e))}else p.pop()}for(var m=p.length;p[0]<=u;)p.shift(),--m;for(;p[m-1]>d;)p.pop(),--m;var f,b=new Array(m+1);for(i=0;i<=m;++i)(f=b[i]=[]).x0=i>0?p[i-1]:u,f.x1=i<m?p[i]:d;for(i=0;i<s;++i)u<=(o=l[i])&&o<=d&&b[r(p,o,0,m)].push(a[i]);return b}return a.value=function(t){return arguments.length?(e="function"==typeof t?t:I(t),a):e},a.domain=function(e){return arguments.length?(t="function"==typeof e?e:I([e[0],e[1]]),a):t},a.thresholds=function(e){return arguments.length?(n="function"==typeof e?e:Array.isArray(e)?I(O.call(e)):I(e),a):n},a}function R(e,t){let n;if(void 0===t)for(const t of e)null!=t&&(n<t||void 0===n&&t>=t)&&(n=t);else{let a=-1;for(let i of e)null!=(i=t(i,++a,e))&&(n<i||void 0===n&&i>=i)&&(n=i)}return n}function P(e,t){let n;if(void 0===t)for(const t of e)null!=t&&(n>t||void 0===n&&t>=t)&&(n=t);else{let a=-1;for(let i of e)null!=(i=t(i,++a,e))&&(n>i||void 0===n&&i>=i)&&(n=i)}return n}function L(e,n,a=0,i=e.length-1,r=t){for(;i>a;){if(i-a>600){const t=i-a+1,o=n-a+1,s=Math.log(t),l=.5*Math.exp(2*s/3),c=.5*Math.sqrt(s*l*(t-l)/t)*(o-t/2<0?-1:1);L(e,n,Math.max(a,Math.floor(n-o*l/t+c)),Math.min(i,Math.floor(n+(t-o)*l/t+c)),r)}const t=e[n];let o=a,s=i;for(q(e,a,n),r(e[i],t)>0&&q(e,a,i);o<s;){for(q(e,o,s),++o,--s;r(e[o],t)<0;)++o;for(;r(e[s],t)>0;)--s}0===r(e[a],t)?q(e,a,s):(++s,q(e,s,i)),s<=n&&(a=s+1),n<=s&&(i=s-1)}return e}function q(e,t,n){const a=e[t];e[t]=e[n],e[n]=a}function B(e,t,n){if(a=(e=Float64Array.from(function*(e,t){if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&(yield t);else{let n=-1;for(let a of e)null!=(a=t(a,++n,e))&&(a=+a)>=a&&(yield a)}}(e,n))).length){if((t=+t)<=0||a<2)return P(e);if(t>=1)return R(e);var a,i=(a-1)*t,r=Math.floor(i),o=R(L(e,r).subarray(0,r+1));return o+(P(e.subarray(r+1))-o)*(i-r)}}function z(e,t){let n,a=-1,i=-1;if(void 0===t)for(const t of e)++i,null!=t&&(n<t||void 0===n&&t>=t)&&(n=t,a=i);else for(let r of e)null!=(r=t(r,++i,e))&&(n<r||void 0===n&&r>=r)&&(n=r,a=i);return a}function $(e,t){let n,a=-1,i=-1;if(void 0===t)for(const t of e)++i,null!=t&&(n>t||void 0===n&&t>=t)&&(n=t,a=i);else for(let r of e)null!=(r=t(r,++i,e))&&(n>r||void 0===n&&r>=r)&&(n=r,a=i);return a}function V(e,t){return[e,t]}function U(e,n=t){if(1===n.length)return $(e,n);let a,i=-1,r=-1;for(const t of e)++r,(i<0?0===n(t,t):n(t,a)<0)&&(a=t,i=r);return i}var H=G(Math.random);function G(e){return function(t,n=0,a=t.length){let i=a-(n=+n);for(;i;){const a=e()*i--|0,r=t[i+n];t[i+n]=t[a+n],t[a+n]=r}return t}}function Q(e){if(!(i=e.length))return[];for(var t=-1,n=P(e,W),a=new Array(n);++t<n;)for(var i,r=-1,o=a[t]=new Array(i);++r<i;)o[r]=e[r][t];return a}function W(e){return e.length}function K(e){return e instanceof Set?e:new Set(e)}function Y(e,t){const n=e[Symbol.iterator](),a=new Set;for(const e of t){if(a.has(e))continue;let t,i;for(;({value:t,done:i}=n.next());){if(i)return!1;if(a.add(t),Object.is(e,t))break}}return!0}e.Adder=Adder,e.InternMap=InternMap,e.InternSet=InternSet,e.ascending=t,e.bin=_,e.bisect=r,e.bisectCenter=s,e.bisectLeft=o,e.bisectRight=r,e.bisector=n,e.count=l,e.cross=function(...e){const t="function"==typeof e[e.length-1]&&function(e){return t=>e(...t)}(e.pop()),n=(e=e.map(d)).map(c),a=e.length-1,i=new Array(a+1).fill(0),r=[];if(a<0||n.some(u))return r;for(;;){r.push(i.map(((t,n)=>e[n][t])));let o=a;for(;++i[o]===n[o];){if(0===o)return t?r.map(t):r;i[o--]=0}}},e.cumsum=function(e,t){var n=0,a=0;return Float64Array.from(e,void 0===t?e=>n+=+e||0:i=>n+=+t(i,a++,e)||0)},e.descending=function(e,t){return t<e?-1:t>e?1:t>=e?0:NaN},e.deviation=m,e.difference=function(e,...t){e=new Set(e);for(const n of t)for(const t of n)e.delete(t);return e},e.disjoint=function(e,t){const n=t[Symbol.iterator](),a=new Set;for(const t of e){if(a.has(t))return!1;let e,i;for(;({value:e,done:i}=n.next())&&!i;){if(Object.is(t,e))return!1;a.add(e)}}return!0},e.every=function(e,t){if("function"!=typeof t)throw new TypeError("test is not a function");let n=-1;for(const a of e)if(!t(a,++n,e))return!1;return!0},e.extent=g,e.fcumsum=function(e,t){const n=new Adder;let a=-1;return Float64Array.from(e,void 0===t?e=>n.add(+e||0):i=>n.add(+t(i,++a,e)||0))},e.filter=function(e,t){if("function"!=typeof t)throw new TypeError("test is not a function");const n=[];let a=-1;for(const i of e)t(i,++a,e)&&n.push(i);return n},e.fsum=function(e,t){const n=new Adder;if(void 0===t)for(let t of e)(t=+t)&&n.add(t);else{let a=-1;for(let i of e)(i=+t(i,++a,e))&&n.add(i)}return+n},e.greatest=function(e,n=t){let a,i=!1;if(1===n.length){let r;for(const o of e){const e=n(o);(i?t(e,r)>0:0===t(e,e))&&(a=o,r=e,i=!0)}}else for(const t of e)(i?n(t,a)>0:0===n(t,t))&&(a=t,i=!0);return a},e.greatestIndex=function(e,n=t){if(1===n.length)return z(e,n);let a,i=-1,r=-1;for(const t of e)++r,(i<0?0===n(t,t):n(t,a)>0)&&(a=t,i=r);return i},e.group=E,e.groupSort=function(e,n,a){return(1===n.length?j(x(e,n,a),(([e,n],[a,i])=>t(n,i)||t(e,a))):j(E(e,a),(([e,a],[i,r])=>n(a,r)||t(e,i)))).map((([e])=>e))},e.groups=function(e,...t){return S(e,Array.from,v,t)},e.histogram=_,e.index=function(e,...t){return S(e,v,k,t)},e.indexes=function(e,...t){return S(e,Array.from,k,t)},e.intersection=function(e,...t){e=new Set(e),t=t.map(K);e:for(const n of e)for(const a of t)if(!a.has(n)){e.delete(n);continue e}return e},e.least=function(e,n=t){let a,i=!1;if(1===n.length){let r;for(const o of e){const e=n(o);(i?t(e,r)<0:0===t(e,e))&&(a=o,r=e,i=!0)}}else for(const t of e)(i?n(t,a)<0:0===n(t,t))&&(a=t,i=!0);return a},e.leastIndex=U,e.map=function(e,t){if("function"!=typeof e[Symbol.iterator])throw new TypeError("values is not iterable");if("function"!=typeof t)throw new TypeError("mapper is not a function");return Array.from(e,((n,a)=>t(n,a,e)))},e.max=R,e.maxIndex=z,e.mean=function(e,t){let n=0,a=0;if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&(++n,a+=t);else{let i=-1;for(let r of e)null!=(r=t(r,++i,e))&&(r=+r)>=r&&(++n,a+=r)}if(n)return a/n},e.median=function(e,t){return B(e,.5,t)},e.merge=function(e){return Array.from(function*(e){for(const t of e)yield*t}(e))},e.min=P,e.minIndex=$,e.nice=F,e.pairs=function(e,t=V){const n=[];let a,i=!1;for(const r of e)i&&n.push(t(a,r)),a=r,i=!0;return n},e.permute=w,e.quantile=B,e.quantileSorted=function(e,t,n=a){if(i=e.length){if((t=+t)<=0||i<2)return+n(e[0],0,e);if(t>=1)return+n(e[i-1],i-1,e);var i,r=(i-1)*t,o=Math.floor(r),s=+n(e[o],o,e);return s+(+n(e[o+1],o+1,e)-s)*(r-o)}},e.quickselect=L,e.range=function(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var a=-1,i=0|Math.max(0,Math.ceil((t-e)/n)),r=new Array(i);++a<i;)r[a]=e+a*n;return r},e.reduce=function(e,t,n){if("function"!=typeof t)throw new TypeError("reducer is not a function");const a=e[Symbol.iterator]();let i,r,o=-1;if(arguments.length<3){if(({done:i,value:n}=a.next()),i)return;++o}for(;({done:i,value:r}=a.next()),!i;)n=t(n,r,++o,e);return n},e.reverse=function(e){if("function"!=typeof e[Symbol.iterator])throw new TypeError("values is not iterable");return Array.from(e).reverse()},e.rollup=x,e.rollups=function(e,t,...n){return S(e,Array.from,t,n)},e.scan=function(e,t){const n=U(e,t);return n<0?void 0:n},e.shuffle=H,e.shuffler=G,e.some=function(e,t){if("function"!=typeof t)throw new TypeError("test is not a function");let n=-1;for(const a of e)if(t(a,++n,e))return!0;return!1},e.sort=j,e.subset=function(e,t){return Y(t,e)},e.sum=function(e,t){let n=0;if(void 0===t)for(let t of e)(t=+t)&&(n+=t);else{let a=-1;for(let i of e)(i=+t(i,++a,e))&&(n+=i)}return n},e.superset=Y,e.thresholdFreedmanDiaconis=function(e,t,n){return Math.ceil((n-t)/(2*(B(e,.75)-B(e,.25))*Math.pow(l(e),-1/3)))},e.thresholdScott=function(e,t,n){return Math.ceil((n-t)/(3.5*m(e)*Math.pow(l(e),-1/3)))},e.thresholdSturges=A,e.tickIncrement=D,e.tickStep=function(e,t,n){var a=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(a)/Math.LN10)),r=a/i;return r>=T?i*=10:r>=C?i*=5:r>=M&&(i*=2),t<e?-i:i},e.ticks=N,e.transpose=Q,e.union=function(...e){const t=new Set;for(const n of e)for(const e of n)t.add(e);return t},e.variance=p,e.zip=function(){return Q(arguments)},Object.defineProperty(e,"__esModule",{value:!0})}(t)},function(e,t,n){!function(e,t){"use strict";var n=new Date,a=new Date;function i(e,t,r,o){function s(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return s.floor=function(t){return e(t=new Date(+t)),t},s.ceil=function(n){return e(n=new Date(n-1)),t(n,1),e(n),n},s.round=function(e){var t=s(e),n=s.ceil(e);return e-t<n-e?t:n},s.offset=function(e,n){return t(e=new Date(+e),null==n?1:Math.floor(n)),e},s.range=function(n,a,i){var r,o=[];if(n=s.ceil(n),i=null==i?1:Math.floor(i),!(n<a&&i>0))return o;do{o.push(r=new Date(+n)),t(n,i),e(n)}while(r<n&&n<a);return o},s.filter=function(n){return i((function(t){if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)}),(function(e,a){if(e>=e)if(a<0)for(;++a<=0;)for(;t(e,-1),!n(e););else for(;--a>=0;)for(;t(e,1),!n(e););}))},r&&(s.count=function(t,i){return n.setTime(+t),a.setTime(+i),e(n),e(a),Math.floor(r(n,a))},s.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?s.filter(o?function(t){return o(t)%e==0}:function(t){return s.count(0,t)%e==0}):s:null}),s}var r=i((function(){}),(function(e,t){e.setTime(+e+t)}),(function(e,t){return t-e}));r.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?i((function(t){t.setTime(Math.floor(t/e)*e)}),(function(t,n){t.setTime(+t+n*e)}),(function(t,n){return(n-t)/e})):r:null};var o=r.range;const s=1e3,l=6e4,c=36e5,u=864e5,d=6048e5,p=2592e6,m=31536e6;var g=i((function(e){e.setTime(e-e.getMilliseconds())}),(function(e,t){e.setTime(+e+t*s)}),(function(e,t){return(t-e)/s}),(function(e){return e.getUTCSeconds()})),f=g.range,b=i((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*s)}),(function(e,t){e.setTime(+e+t*l)}),(function(e,t){return(t-e)/l}),(function(e){return e.getMinutes()})),y=b.range,h=i((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*s-e.getMinutes()*l)}),(function(e,t){e.setTime(+e+t*c)}),(function(e,t){return(t-e)/c}),(function(e){return e.getHours()})),v=h.range,E=i((e=>e.setHours(0,0,0,0)),((e,t)=>e.setDate(e.getDate()+t)),((e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*l)/u),(e=>e.getDate()-1)),x=E.range;function k(e){return i((function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)}),(function(e,t){e.setDate(e.getDate()+7*t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*l)/d}))}var S=k(0),w=k(1),j=k(2),O=k(3),I=k(4),T=k(5),C=k(6),M=S.range,N=w.range,D=j.range,F=O.range,A=I.range,_=T.range,R=C.range,P=i((function(e){e.setDate(1),e.setHours(0,0,0,0)}),(function(e,t){e.setMonth(e.getMonth()+t)}),(function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())}),(function(e){return e.getMonth()})),L=P.range,q=i((function(e){e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,t){e.setFullYear(e.getFullYear()+t)}),(function(e,t){return t.getFullYear()-e.getFullYear()}),(function(e){return e.getFullYear()}));q.every=function(e){return isFinite(e=Math.floor(e))&&e>0?i((function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,n){t.setFullYear(t.getFullYear()+n*e)})):null};var B=q.range,z=i((function(e){e.setUTCSeconds(0,0)}),(function(e,t){e.setTime(+e+t*l)}),(function(e,t){return(t-e)/l}),(function(e){return e.getUTCMinutes()})),$=z.range,V=i((function(e){e.setUTCMinutes(0,0,0)}),(function(e,t){e.setTime(+e+t*c)}),(function(e,t){return(t-e)/c}),(function(e){return e.getUTCHours()})),U=V.range,H=i((function(e){e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+t)}),(function(e,t){return(t-e)/u}),(function(e){return e.getUTCDate()-1})),G=H.range;function Q(e){return i((function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+7*t)}),(function(e,t){return(t-e)/d}))}var W=Q(0),K=Q(1),Y=Q(2),J=Q(3),X=Q(4),Z=Q(5),ee=Q(6),te=W.range,ne=K.range,ae=Y.range,ie=J.range,re=X.range,oe=Z.range,se=ee.range,le=i((function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCMonth(e.getUTCMonth()+t)}),(function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())}),(function(e){return e.getUTCMonth()})),ce=le.range,ue=i((function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)}),(function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()}),(function(e){return e.getUTCFullYear()}));ue.every=function(e){return isFinite(e=Math.floor(e))&&e>0?i((function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})):null};var de=ue.range;function pe(e,n,a,i,o,f){const b=[[g,1,s],[g,5,5e3],[g,15,15e3],[g,30,3e4],[f,1,l],[f,5,3e5],[f,15,9e5],[f,30,18e5],[o,1,c],[o,3,108e5],[o,6,216e5],[o,12,432e5],[i,1,u],[i,2,1728e5],[a,1,d],[n,1,p],[n,3,7776e6],[e,1,m]];function y(n,a,i){const o=Math.abs(a-n)/i,s=t.bisector((([,,e])=>e)).right(b,o);if(s===b.length)return e.every(t.tickStep(n/m,a/m,i));if(0===s)return r.every(Math.max(t.tickStep(n,a,i),1));const[l,c]=b[o/b[s-1][2]<b[s][2]/o?s-1:s];return l.every(c)}return[function(e,t,n){const a=t<e;a&&([e,t]=[t,e]);const i=n&&"function"==typeof n.range?n:y(e,t,n),r=i?i.range(e,+t+1):[];return a?r.reverse():r},y]}const[me,ge]=pe(ue,le,W,H,V,z),[fe,be]=pe(q,P,S,E,h,b);e.timeDay=E,e.timeDays=x,e.timeFriday=T,e.timeFridays=_,e.timeHour=h,e.timeHours=v,e.timeInterval=i,e.timeMillisecond=r,e.timeMilliseconds=o,e.timeMinute=b,e.timeMinutes=y,e.timeMonday=w,e.timeMondays=N,e.timeMonth=P,e.timeMonths=L,e.timeSaturday=C,e.timeSaturdays=R,e.timeSecond=g,e.timeSeconds=f,e.timeSunday=S,e.timeSundays=M,e.timeThursday=I,e.timeThursdays=A,e.timeTickInterval=be,e.timeTicks=fe,e.timeTuesday=j,e.timeTuesdays=D,e.timeWednesday=O,e.timeWednesdays=F,e.timeWeek=S,e.timeWeeks=M,e.timeYear=q,e.timeYears=B,e.utcDay=H,e.utcDays=G,e.utcFriday=Z,e.utcFridays=oe,e.utcHour=V,e.utcHours=U,e.utcMillisecond=r,e.utcMilliseconds=o,e.utcMinute=z,e.utcMinutes=$,e.utcMonday=K,e.utcMondays=ne,e.utcMonth=le,e.utcMonths=ce,e.utcSaturday=ee,e.utcSaturdays=se,e.utcSecond=g,e.utcSeconds=f,e.utcSunday=W,e.utcSundays=te,e.utcThursday=X,e.utcThursdays=re,e.utcTickInterval=ge,e.utcTicks=me,e.utcTuesday=Y,e.utcTuesdays=ae,e.utcWednesday=J,e.utcWednesdays=ie,e.utcWeek=W,e.utcWeeks=te,e.utcYear=ue,e.utcYears=de,Object.defineProperty(e,"__esModule",{value:!0})}(t,n(641))},function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u}));var a=n(32),i=n(34),r=n(4),o=n.n(r),s=n(88);const l="process.name",c="user.name",u=o.a.memo((({contextId:e,eventId:t,isDraggable:n,processName:r,userName:u})=>o.a.createElement(a.EuiFlexGroup,{alignItems:"flexStart","data-test-subj":"user-process",direction:"column",justifyContent:"center",gutterSize:"none"},null!=u?Object(i.uniq)(u).map((i=>o.a.createElement(a.EuiFlexItem,{grow:!1,key:i},o.a.createElement(s.c,{contextId:e,"data-test-subj":"user-name",eventId:t,field:c,isDraggable:n,value:i,iconType:"user",isAggregatable:!0,fieldType:"keyword"})))):null,null!=r?Object(i.uniq)(r).map((i=>o.a.createElement(a.EuiFlexItem,{grow:!1,key:i},o.a.createElement(s.c,{contextId:e,eventId:t,field:l,isDraggable:n,value:i,iconType:"console",isAggregatable:!0,fieldType:"keyword"})))):null)));u.displayName="UserProcess"},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(4),i=n.n(a),r=n(88),o=n(260),s=n(97);const l=i.a.memo((({contextId:e,eventId:t,hostName:n,workingDirectory:a,isDraggable:l})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(s.c,{grow:!1,component:"span"},i.a.createElement(r.c,{contextId:e,eventId:t,field:"host.name",value:n,isDraggable:l,fieldType:"keyword",isAggregatable:!0})),null!=a&&i.a.createElement(s.c,{grow:!1,component:"span"},o.d),i.a.createElement(s.c,{grow:!1,component:"span"},i.a.createElement(r.c,{contextId:e,eventId:t,field:"process.working_directory",value:a,iconType:"folderOpen",isDraggable:l,fieldType:"keyword",isAggregatable:!0})))));l.displayName="HostWorkingDir"},function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return l}));var a=n(0);a.i18n.translate("xpack.securitySolution.timeline.expandableEvent.messageTitle",{defaultMessage:"Message"});const i=a.i18n.translate("xpack.securitySolution.timeline.expandableEvent.openAlertDetails",{defaultMessage:"Open alert details page"}),r=a.i18n.translate("xpack.securitySolution.timeline.expandableEvent.closeEventDetailsLabel",{defaultMessage:"close"}),o=a.i18n.translate("xpack.securitySolution.timeline.expandableEvent.placeholder",{defaultMessage:"Select an event to show event details"}),s=a.i18n.translate("xpack.securitySolution.timeline.expandableEvent.eventTitleLabel",{defaultMessage:"Event details"}),l=a.i18n.translate("xpack.securitySolution.timeline.expandableEvent.alertTitleLabel",{defaultMessage:"Alert details"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(4),i=n(875);const r={isolateAction:"isolateHost",isHostIsolationPanelOpen:!1,isIsolateActionSuccessBannerVisible:!1};function o(e,t){switch(t.type){case"setIsolateAction":return{...e,isolateAction:t.isolateAction};case"setIsHostIsolationPanel":return{...e,isHostIsolationPanelOpen:t.isHostIsolationPanelOpen};case"setIsIsolateActionSuccessBannerVisible":return{...e,isIsolateActionSuccessBannerVisible:t.isIsolateActionSuccessBannerVisible};default:throw new Error}}const s=()=>{const[{isolateAction:e,isHostIsolationPanelOpen:t,isIsolateActionSuccessBannerVisible:n},s]=Object(a.useReducer)(o,r),l=Object(a.useCallback)((()=>{s({type:"setIsHostIsolationPanel",isHostIsolationPanelOpen:!1}),s({type:"setIsIsolateActionSuccessBannerVisible",isIsolateActionSuccessBannerVisible:!1})}),[]),c=Object(a.useCallback)((e=>{"isolateHost"!==e&&"unisolateHost"!==e||(s({type:"setIsHostIsolationPanel",isHostIsolationPanelOpen:!0}),s({type:"setIsolateAction",isolateAction:e}))}),[]),u=Object(i.b)(),d=Object(a.useCallback)((()=>{s({type:"setIsIsolateActionSuccessBannerVisible",isIsolateActionSuccessBannerVisible:!0}),u&&u.refreshCase()}),[u]);return Object(a.useMemo)((()=>({isolateAction:e,isHostIsolationPanelOpen:t,isIsolateActionSuccessBannerVisible:n,handleIsolationActionSuccess:d,showAlertDetails:l,showHostIsolationPanel:c})),[t,n,e,d,l,c])}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return s}));var a=n(0);const i=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.additionalFiltersTitle",{defaultMessage:"Additional filters"}),r=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.additionalFiltersActions.showBuildingBlockTitle",{defaultMessage:"Include building block alerts"}),o=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.additionalFiltersActions.showOnlyThreatIndicatorAlerts",{defaultMessage:"Show only threat indicator alerts"}),s=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.takeActionTitle",{defaultMessage:"Take action"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(4),i=n.n(a),r=n(32),o=n(93),s=n(165),l=n(118);const c=({isEndpointAlert:e,onAddExceptionTypeClick:t})=>{const[{canUserCRUD:n,hasIndexWrite:c}]=Object(s.b)(),u=Object(a.useCallback)((()=>{t()}),[t]),d=Object(a.useCallback)((()=>{t(o.b.ENDPOINT)}),[t]),p=!n||!c||!e,m=!n||!c;return{exceptionActionItems:Object(a.useMemo)((()=>m?[]:[i.a.createElement(r.EuiContextMenuItem,{key:"add-endpoint-exception-menu-item","data-test-subj":"add-endpoint-exception-menu-item",disabled:p,onClick:d},l.b),i.a.createElement(r.EuiContextMenuItem,{key:"add-exception-menu-item","data-test-subj":"add-exception-menu-item",disabled:m,onClick:u},l.e)]),[p,m,u,d])}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var a=n(4),i=n.n(a),r=n(78),o=n(32),s=n(0),l=n(135),c=n(172),u=n(112),d=n(77),p=n(79),m=n(86),g=n(478),f=n(136),b=n(210),y=n(118),h=n(81),v=n(99),E=n(84),x=n(154),k=n(179);const S=({ecsRowData:e,onInvestigateInTimelineAlertClick:t})=>{const{addError:n}=Object(E.a)(),{data:{search:S,query:w}}=Object(d.k)().services,j=Object(r.useDispatch)(),{startTransaction:O}=Object(x.a)(),{services:I}=Object(d.k)(),{getExceptionFilterFromIds:T}=Object(c.c)(I.http),C=Object(a.useCallback)((async e=>{var t;let a=null!==(t=Object(v.getField)(e,l.s))&&void 0!==t?t:[];if(0===a.length)try{var i;const t=null!==(i=Object(v.getField)(e,l.A))&&void 0!==i?i:{};if(t.length>0){var r;const e=JSON.parse(t[0]);a=null!==(r=null==e?void 0:e.exceptions_list)&&void 0!==r?r:[]}}catch(e){}const o=a.reduce(((e,t)=>{const n="string"==typeof t?JSON.parse(t):t;if("detection"===n.type){const t={exception_list_id:n.list_id,namespace_type:n.namespace_type};e.push(t)}return e}),[]);let c;return o.length>0&&await T({exceptionListIds:o,excludeExceptions:!0,chunkSize:20,alias:"Exceptions",onSuccess:e=>{c=e},onError:e=>{n(e,{title:s.i18n.translate("xpack.securitySolution.detectionEngine.alerts.fetchExceptionFilterFailure",{defaultMessage:"Error fetching exception filter."})})}}),c}),[n,T]),M=Object(a.useMemo)((()=>w.filterManager),[w.filterManager]),N=Object(a.useMemo)((()=>m.b.getTimelineByIdSelector()),[]),{filterManager:D}=Object(h.a)((e=>{var t,n;return null!==(t=N(e,null!==(n=p.j.active)&&void 0!==n?n:""))&&void 0!==t?t:u.b})),F=Object(a.useMemo)((()=>null!=D?D:M),[D,M]),A=Object(a.useCallback)((e=>j(m.a.updateIsLoading(e))),[j]),_=Object(b.a)({timelineId:p.j.active,timelineType:p.n.default}),R=Object(a.useCallback)((({from:e,timeline:t,to:n,ruleNote:a})=>{var i;_(),A({id:p.j.active,isLoading:!1}),Object(f.b)(j)({duplicate:!0,from:e,id:p.j.active,notes:[],timeline:{...t,filterManager:F,indexNames:null!==(i=t.indexNames)&&void 0!==i?i:[],show:!0},to:n,ruleNote:a})()}),[j,F,A,_]),P=Object(a.useCallback)((async()=>{O({name:k.a.INVESTIGATE_IN_TIMELINE}),t&&t(),null!=e&&await Object(g.b)({createTimeline:R,ecsData:e,searchStrategyClient:S,updateTimelineIsLoading:A,getExceptionFilter:C})}),[O,R,e,t,S,A,C]);return{investigateInTimelineActionItems:Object(a.useMemo)((()=>[i.a.createElement(o.EuiContextMenuItem,{key:"investigate-in-timeline-action-item","data-test-subj":"investigate-in-timeline-action-item",disabled:null==e,onClick:P},y.f)]),[e,P]),investigateInTimelineAlertClick:P}}},function(e,t,n){"use strict";n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return g}));var a=n(34),i=n(45),r=n(79),o=n(106);const s=["host.name","host.hostname","host.domain","host.id","host.ip","client.ip","destination.ip","server.ip","source.ip","network.community_id","user.name","process.name"],l=(e,t,n=console)=>{var a,i;const r=null!==(a=null===(i=t.find((t=>t.field===e)))||void 0===i?void 0:i.values)&&void 0!==a?a:null;return null==r?[]:"string"==typeof r?[r]:Array.isArray(r)&&r.every((e=>"string"==typeof e))?r:(n.trace("Data type that is not a string or string array detected:",r,"when trying to access field:",e,"from data object of:",t),[])},c=(e,t=[])=>{let n=t;return"is"===e.function&&s.includes(e.arguments[0].value)&&(n=[...n,{field:e.arguments[0].value,valueToChange:e.arguments[1].value}]),e.arguments.reduce(((e,t)=>"is"===t.function&&s.includes(t.arguments[0].value)?[...e,{field:t.arguments[0].value,valueToChange:t.arguments[1].value}]:t.arguments?c(t,e):e),n)},u=(e,t,n=r.n.default)=>n===r.n.default?""!==e.trim()?c(Object(i.fromKueryExpression)(e)).reduce(((e,n)=>{const a=l(n.field,t);return a.length?e.replace(n.valueToChange,a[0]):e}),e):"":e.trim(),d=(e,t)=>e.map((e=>{if("phrase"===e.meta.type&&null!=e.meta.key&&s.includes(e.meta.key)){const n=l(e.meta.key,t);n.length&&(e.meta.params={query:n[0]},e.query={match_phrase:{[e.meta.key]:n[0]}})}return e})),p=(e,t,n=r.n.default)=>{if(n!==r.n.template){if(s.includes(e.queryMatch.field)){const n=l(e.queryMatch.field,t);n.length&&(e.id=e.id.replace(e.name,n[0]),e.name=n[0],e.queryMatch.value=n[0],e.queryMatch.displayField=void 0,e.queryMatch.displayValue=void 0)}return e.type=o.a.default,e}if(n===r.n.template){var a;if(e.type===o.a.template&&":"===e.queryMatch.operator){const n=l(e.queryMatch.field,t);return n.length||(e.enabled=!1),e.id=e.id.replace(e.name,n[0]),e.name=n[0],e.queryMatch.value=n[0],e.queryMatch.displayField=void 0,e.queryMatch.displayValue=void 0,e.type=o.a.default,e}return e.type=null!==(a=e.type)&&void 0!==a?a:o.a.default,e}return e},m=(e,t,n=r.n.default)=>e.map((e=>{const i=p(e,t,n);return null==i.and||Object(a.isEmpty)(i.and)||(i.and=i.and.map((e=>p(e,t,n)))),i})),g=(e,t)=>[{range:{"@timestamp":{gte:e,lt:t,format:"strict_date_optional_time"}},meta:{type:"range",disabled:!1,negate:!1,alias:null,key:"@timestamp",params:{gte:e,lt:t,format:"strict_date_optional_time"}},$state:{store:i.FilterStateStore.APP_STATE}}]},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(4),i=n.n(a),r=n(32),o=n(118);const s=({onAddEventFilterClick:e,disabled:t=!1,tooltipMessage:n})=>({eventFilterActionItems:Object(a.useMemo)((()=>[i.a.createElement(r.EuiContextMenuItem,{key:"add-event-filter-menu-item","data-test-subj":"add-event-filter-menu-item",onClick:e,disabled:t,toolTipContent:n},o.c)]),[e,t,n])})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(321),i=n.n(a);const r={macos:!0,windows:!0};function o(e){return e.includes("-")?e.substring(0,e.indexOf("-")):e}const s=({osName:e,version:t,capabilities:n})=>!(!t||!(({currentVersion:e,minVersionRequired:t="7.14.0"})=>{try{const n=o(e);return i()(t,n)}catch(n){return window&&window.console&&window.console.warn(`SecuritySolution: isVersionSupported(): Unable to determine if current version [${e}] meets minimum version [${t}]. Error: ${n.message}`),!1}})({currentVersion:t}))&&(function(e){const t=o(e);return i()("7.15.0",t)}(t)?function(e=[]){return e.includes("isolation")}(n):function(e){return(({currentOs:e,supportedOss:t=r})=>!!t[e])({currentOs:e.toLowerCase()})}(e))},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(4),i=n.n(a),r=n(32),o=n(611);const s=({handleClick:e})=>i.a.createElement(r.EuiContextMenuItem,{key:"osquery-action-item","data-test-subj":"osquery-action-item",onClick:e},o.a)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(4);const i=({refetch:e,onRuleChange:t,isActiveTimelines:n})=>{const[i,r]=Object(a.useState)(!1),[o,s]=Object(a.useState)(null);return{exceptionFlyoutType:o,openAddExceptionFlyout:i,onAddExceptionTypeClick:Object(a.useCallback)((e=>{s(null!=e?e:null),r(!0)}),[]),onAddExceptionCancel:Object(a.useCallback)((()=>{s(null),r(!1)}),[]),onAddExceptionConfirm:Object(a.useCallback)(((a,i,o)=>{e&&(!1===n||o)&&e(),null!=t&&a&&t(),r(!1)}),[t,e,n])}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(4),i=n(723),r=n(77),o=n(175);const s=e=>{const{data:t,spaces:n}=Object(r.k)().services,[s,l]=Object(a.useState)(!1),[c,u]=Object(a.useState)(""),d=Object(a.useMemo)((()=>null!=e&&1===e.length),[e]),p=Object(a.useMemo)((()=>null!=e&&d&&"machine_learning"===e[0].type),[d,e]);Object(a.useEffect)((()=>{(async()=>{if(n){const e=await n.getActiveSpace();u(e.id)}})()}),[n]);const m=Object(a.useMemo)((()=>null!=e&&d?e[0].data_view_id||null:`security-solution-${c}`),[d,e,c]),g=Object(a.useMemo)((()=>!m&&null!=e&&d&&null!=e[0].index?e[0].index:[]),[m,d,e]),f=Object(a.useMemo)((()=>{var t;return p&&d&&null!=e&&null!==(t=e[0].machine_learning_job_id)&&void 0!==t?t:[]}),[p,d,e]),{loading:b,jobs:y}=Object(i.a)(f),h=Object(a.useMemo)((()=>p&&y.length>0?y[0].results_index_name?[`.ml-anomalies-${y[0].results_index_name}`]:[]:null!=m?[]:g),[y,p,m,g]),[v,{indexPatterns:E}]=Object(o.b)(h),[x,k]=Object(a.useState)(null);return Object(a.useEffect)((()=>{(async()=>{if(""!==c&&m){l(!0);const e=await t.dataViews.get(m);l(!1),k(e)}})()}),[m,t.dataViews,k,c]),{isLoading:v||b||s,indexPatterns:Object(a.useMemo)((()=>m&&null!=x?x:E),[m,x,E])}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(4),i=n(138),r=n(77),o=n(361);const s=()=>{const e=Object(r.o)(),[t,n]=Object(a.useState)(!0),[s,l]=Object(a.useState)(!1),[c,u]=Object(a.useState)(null),d=Object(a.useRef)(null);return Object(a.useEffect)((()=>{let t=!0;const a=new AbortController;return d.current=async r=>{try{n(!0);const{references:e}=await Object(i.h)({lists:r,signal:a.signal}),o=e.reduce(((e,t)=>{const[[n,a]]=Object.entries(t);return e[n]=a,e}),{});t&&(n(!1),l(!1),u(o))}catch(a){t&&(l(!0),n(!1),e.addError(a,{title:o.c}))}},()=>{t=!1,a.abort()}}),[e]),[t,s,c,d.current]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(4),i=n(172),r=n(190),o=n(77);const s=()=>{const{services:{http:e}}=Object(o.k)(),[t,n]=Object(a.useState)(!1),s=Object(a.useRef)(null),{addExceptionListItem:l,updateExceptionListItem:c}=Object(i.c)(e);return Object(a.useEffect)((()=>{const e=new AbortController;return s.current=async e=>{n(!0);const t=await Promise.all(e.map((e=>{if("id"in e&&null!=e.id){const t=Object(r.i)(e);return c({listItem:t})}return l({listItem:e})})));return n(!1),t},()=>{n(!1),e.abort()}}),[c,e,l]),[t,s.current]}},function(e,t,n){const a=n(152);e.exports=(e,t,n)=>0!==a(e,t,n)},function(e,t,n){const a=n(482),i=n(659),r=n(362),o=n(363),s=n(484),l=n(321);e.exports=(e,t,n,c)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e===n;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e!==n;case"":case"=":case"==":return a(e,n,c);case"!=":return i(e,n,c);case">":return r(e,n,c);case">=":return o(e,n,c);case"<":return s(e,n,c);case"<=":return l(e,n,c);default:throw new TypeError(`Invalid operator: ${t}`)}}},function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return r})),n.d(t,"b",(function(){return o}));const a=({group:e,id:t,action_type_id:n,params:a})=>({group:e,id:t,params:a,actionTypeId:n}),i=({group:e,id:t,actionTypeId:n,params:a})=>({group:e,id:t,params:a,action_type_id:n}),r=({action_type_id:e,params:t})=>{const{saved_query_id:n,ecs_mapping:a,pack_id:i,...r}=t;return{params:{...r,savedQueryId:n,ecsMapping:a,packId:i},actionTypeId:e}},o=({actionTypeId:e,params:t})=>{const{savedQueryId:n,ecsMapping:a,packId:i,...r}=t;return{params:{...r,saved_query_id:n,ecs_mapping:a,pack_id:i},action_type_id:e}}},function(e,t,n){"use strict";const a=n(4),i=n(996),r=n(997),o=n(998),s=n(1045),l=n(1077),c=n(1046),u=n(1047),d=n(1049),p=n(1050).hastChildrenToReact;e.exports=f;const m={}.hasOwnProperty,g={renderers:{to:"components",id:"change-renderers-to-components"},astPlugins:{id:"remove-buggy-html-in-markdown-parser"},allowDangerousHtml:{id:"remove-buggy-html-in-markdown-parser"},escapeHtml:{id:"remove-buggy-html-in-markdown-parser"},source:{to:"children",id:"change-source-to-children"},allowNode:{to:"allowElement",id:"replace-allownode-allowedtypes-and-disallowedtypes"},allowedTypes:{to:"allowedElements",id:"replace-allownode-allowedtypes-and-disallowedtypes"},disallowedTypes:{to:"disallowedElements",id:"replace-allownode-allowedtypes-and-disallowedtypes"},includeNodeIndex:{to:"includeElementIndex",id:"change-includenodeindex-to-includeelementindex"}};function f(e){for(const t in g)if(m.call(g,t)&&m.call(e,t)){const e=g[t];console.warn(`[react-markdown] Warning: please ${e.to?`use \`${e.to}\` instead of`:"remove"} \`${t}\` (see <https://github.com/remarkjs/react-markdown/blob/main/changelog.md#${e.id}> for more info)`),delete g[t]}const t=r().use(o).use(e.remarkPlugins||e.plugins||[]).use(s,{allowDangerousHtml:!0}).use(e.rehypePlugins||[]).use(u,e);let n;"string"==typeof e.children?n=i(e.children):(void 0!==e.children&&null!==e.children&&console.warn(`[react-markdown] Warning: please pass a string as \`children\` (not: \`${e.children}\`)`),n=i());const l=t.runSync(t.parse(n),n);if("root"!==l.type)throw new TypeError("Expected a `root` node");let d=a.createElement(a.Fragment,{},p({options:e,schema:c,listDepth:0},l));return e.className&&(d=a.createElement("div",{className:e.className},d)),d}f.defaultProps={transformLinkUri:d},f.propTypes={children:l.string,className:l.string,allowElement:l.func,allowedElements:l.arrayOf(l.string),disallowedElements:l.arrayOf(l.string),unwrapDisallowed:l.bool,remarkPlugins:l.arrayOf(l.oneOfType([l.object,l.func,l.arrayOf(l.oneOfType([l.object,l.func]))])),rehypePlugins:l.arrayOf(l.oneOfType([l.object,l.func,l.arrayOf(l.oneOfType([l.object,l.func]))])),sourcePos:l.bool,rawSourcePos:l.bool,skipHtml:l.bool,includeElementIndex:l.bool,transformLinkUri:l.oneOfType([l.func,l.bool]),linkTarget:l.oneOfType([l.func,l.string]),transformImageUri:l.func,components:l.object},f.uriTransformer=d},function(e,t,n){"use strict";var a={}.hasOwnProperty;e.exports=a},function(e,t,n){"use strict";e.exports=function(e){for(var t=-1,n=0;++t<e.length;)n+="string"==typeof e[t]?e[t].length:1;return n}},function(e,t,n){"use strict";var a=n(309),i=n(200),r=n(263);function o(e,t){for(var n,a,r,o,s,l,c=e[t][1],u=e[t][2],d=t-1,p=[],m=c._tokenizer||u.parser[c.contentType](c.start),g=m.events,f=[],b={};c;){for(;e[++d][1]!==c;);p.push(d),c._tokenizer||(n=u.sliceStream(c),c.next||n.push(null),a&&m.defineSkip(c.start),c.isInFirstContentOfListItem&&(m._gfmTasklistFirstContentOfListItem=!0),m.write(n),c.isInFirstContentOfListItem&&(m._gfmTasklistFirstContentOfListItem=void 0)),a=c,c=c.next}for(c=a,r=g.length;r--;)"enter"===g[r][0]?o=!0:o&&g[r][1].type===g[r-1][1].type&&g[r][1].start.line!==g[r][1].end.line&&(y(g.slice(r+1,s)),c._tokenizer=c.next=void 0,c=c.previous,s=r+1);for(m.events=c._tokenizer=c.next=void 0,y(g.slice(0,s)),r=-1,l=0;++r<f.length;)b[l+f[r][0]]=l+f[r][1],l+=f[r][1]-f[r][0]-1;return b;function y(t){var n=p.pop();f.unshift([n,n+t.length-1]),i(e,n,2,t)}}e.exports=function(e){for(var t,n,s,l,c,u,d,p={},m=-1;++m<e.length;){for(;m in p;)m=p[m];if(t=e[m],m&&"chunkFlow"===t[1].type&&"listItemPrefix"===e[m-1][1].type&&((s=0)<(u=t[1]._tokenizer.events).length&&"lineEndingBlank"===u[s][1].type&&(s+=2),s<u.length&&"content"===u[s][1].type))for(;++s<u.length&&"content"!==u[s][1].type;)"chunkText"===u[s][1].type&&(u[s][1].isInFirstContentOfListItem=!0,s++);if("enter"===t[0])t[1].contentType&&(a(p,o(e,m)),m=p[m],d=!0);else if(t[1]._container||t[1]._movePreviousLineEndings){for(s=m,n=void 0;s--&&("lineEnding"===(l=e[s])[1].type||"lineEndingBlank"===l[1].type);)"enter"===l[0]&&(n&&(e[n][1].type="lineEndingBlank"),l[1].type="lineEnding",n=s);n&&(t[1].end=r(e[n][1].start),(c=e.slice(n,m)).unshift(t),i(e,n,m-n+1,c))}}return!d}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(309),i=n(263),r=l("text"),o=l("string"),s={resolveAll:c()};function l(e){return{tokenize:function(t){var n=this,a=this.parser.constructs[e],i=t.attempt(a,r,o);return r;function r(e){return l(e)?i(e):o(e)}function o(e){if(null!==e)return t.enter("data"),t.consume(e),s;t.consume(e)}function s(e){return l(e)?(t.exit("data"),i(e)):(t.consume(e),s)}function l(e){var t=a[e],i=-1;if(null===e)return!0;if(t)for(;++i<t.length;)if(!t[i].previous||t[i].previous.call(n,n.previous))return!0}},resolveAll:c("text"===e?u:void 0)}}function c(e){return function(t,n){for(var a,i=-1;++i<=t.length;)void 0===a?t[i]&&"data"===t[i][1].type&&(a=i,i++):t[i]&&"data"===t[i][1].type||(i!==a+2&&(t[a][1].end=t[i-1][1].end,t.splice(a+2,i-a-2),i=a+2),a=void 0);return e?e(t,n):t}}function u(e,t){for(var n,r,o,s,l,c,u,d,p=-1;++p<=e.length;)if((p===e.length||"lineEnding"===e[p][1].type)&&"data"===e[p-1][1].type){for(r=e[p-1][1],s=(n=t.sliceStream(r)).length,l=-1,c=0,u=void 0;s--;)if("string"==typeof(o=n[s])){for(l=o.length;32===o.charCodeAt(l-1);)c++,l--;if(l)break;l=-1}else if(-2===o)u=!0,c++;else if(-1!==o){s++;break}c&&(d={type:p===e.length||u||c<2?"lineSuffix":"hardBreakTrailing",start:{line:r.end.line,column:r.end.column-c,offset:r.end.offset-c,_index:r.start._index+s,_bufferIndex:s?l:r.start._bufferIndex+l},end:i(r.end)},r.end=i(d.start),r.start.offset===r.end.offset?a(r,d):(e.splice(p,0,["enter",d,t],["exit",d,t]),p+=2)),p++}return e}t.resolver=s,t.string=o,t.text=r},function(e,t,n){"use strict";e.exports=function(e){return e<32||127===e}},function(e,t,n){e.exports=n(27)(3126)},function(e,t,n){"use strict";var a=n(202)(/\d/);e.exports=a},function(e,t,n){"use strict";var a=n(667),i=n(201),r=n(115);e.exports=function(e,t,n,o,s,l,c,u,d){var p=d||1/0,m=0;return function(t){return 60===t?(e.enter(o),e.enter(s),e.enter(l),e.consume(t),e.exit(l),g):a(t)||41===t?n(t):(e.enter(o),e.enter(c),e.enter(u),e.enter("chunkString",{contentType:"string"}),y(t))};function g(n){return 62===n?(e.enter(l),e.consume(n),e.exit(l),e.exit(s),e.exit(o),t):(e.enter(u),e.enter("chunkString",{contentType:"string"}),f(n))}function f(t){return 62===t?(e.exit("chunkString"),e.exit(u),g(t)):null===t||60===t||r(t)?n(t):(e.consume(t),92===t?b:f)}function b(t){return 60===t||62===t||92===t?(e.consume(t),f):f(t)}function y(r){return 40===r?++m>p?n(r):(e.consume(r),y):41===r?m--?(e.consume(r),y):(e.exit("chunkString"),e.exit(u),e.exit(c),e.exit(o),t(r)):null===r||i(r)?m?n(r):(e.exit("chunkString"),e.exit(u),e.exit(c),e.exit(o),t(r)):a(r)?n(r):(e.consume(r),92===r?h:y)}function h(t){return 40===t||41===t||92===t?(e.consume(t),y):y(t)}}},function(e,t,n){"use strict";var a=n(115),i=n(189);e.exports=function(e,t,n,r,o,s){var l,c=this,u=0;return function(t){return e.enter(r),e.enter(o),e.consume(t),e.exit(o),e.enter(s),d};function d(i){return null===i||91===i||93===i&&!l||94===i&&!u&&"_hiddenFootnoteSupport"in c.parser.constructs||u>999?n(i):93===i?(e.exit(s),e.enter(o),e.consume(i),e.exit(o),e.exit(r),t):a(i)?(e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),d):(e.enter("chunkString",{contentType:"string"}),p(i))}function p(t){return null===t||91===t||93===t||a(t)||u++>999?(e.exit("chunkString"),d(t)):(e.consume(t),l=l||!i(t),92===t?m:p)}function m(t){return 91===t||92===t||93===t?(e.consume(t),u++,p):p(t)}}},function(e,t,n){"use strict";var a=n(115),i=n(189),r=n(122);e.exports=function(e,t){var n;return function o(s){return a(s)?(e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),n=!0,o):i(s)?r(e,o,n?"linePrefix":"lineSuffix")(s):t(s)}}},function(e,t,n){"use strict";var a=n(115),i=n(122);e.exports=function(e,t,n,r,o,s){var l;return function(t){return e.enter(r),e.enter(o),e.consume(t),e.exit(o),l=40===t?41:t,c};function c(n){return n===l?(e.enter(o),e.consume(n),e.exit(o),e.exit(r),t):(e.enter(s),u(n))}function u(t){return t===l?(e.exit(s),c(l)):null===t?n(t):a(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),i(e,u,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),d(t))}function d(t){return t===l||null===t||a(t)?(e.exit("chunkString"),u(t)):(e.consume(t),92===t?p:d)}function p(t){return t===l||92===t?(e.consume(t),d):d(t)}}},function(e,t,n){"use strict";var a=n(115),i=n(189),r=n(122),o={name:"thematicBreak",tokenize:function(e,t,n){var o,s=0;return function(t){return e.enter("thematicBreak"),o=t,l(t)};function l(u){return u===o?(e.enter("thematicBreakSequence"),c(u)):i(u)?r(e,l,"whitespace")(u):s<3||null!==u&&!a(u)?n(u):(e.exit("thematicBreak"),t(u))}function c(t){return t===o?(e.consume(t),s++,c):(e.exit("thematicBreakSequence"),l(t))}}};e.exports=o},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(0).i18n.translate("xpack.securitySolution.detectionEngine.createRule.ruleActionsField.ruleActionsFormErrorsTitle",{defaultMessage:"Please fix issues listed below"})},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"e",(function(){return o})),n.d(t,"j",(function(){return s})),n.d(t,"a",(function(){return l})),n.d(t,"h",(function(){return c})),n.d(t,"g",(function(){return u})),n.d(t,"i",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"f",(function(){return m}));var a=n(0);const i=a.i18n.translate("xpack.securitySolution.expandedValue.showTopN.showTopValues",{defaultMessage:"Show top values"}),r=a.i18n.translate("xpack.securitySolution.expandedValue.hideTopValues.HideTopValues",{defaultMessage:"Hide top values"}),o=a.i18n.translate("xpack.securitySolution.expandedValue.links.viewHostSummary",{defaultMessage:"View host summary"}),s=a.i18n.translate("xpack.securitySolution.expandedValue.links.viewUserSummary",{defaultMessage:"View user summary"}),l=a.i18n.translate("xpack.securitySolution.expandedValue.links.expandIpDetails",{defaultMessage:"Expand ip details"}),c=a.i18n.translate("xpack.securitySolution.expandedValue.links.viewRuleDetails",{defaultMessage:"View rule details"}),u=a.i18n.translate("xpack.securitySolution.expandedValue.links.viewPortDetails",{defaultMessage:"View port details"}),d=a.i18n.translate("xpack.securitySolution.expandedValue.links.viewRuleReference",{defaultMessage:"View rule reference"}),p=a.i18n.translate("xpack.securitySolution.expandedValue.links.viewEventReference",{defaultMessage:"View event reference"}),m=a.i18n.translate("xpack.securitySolution.expandedValue.links.viewIndicatorReference",{defaultMessage:"View indicator reference"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(4),i=n.n(a),r=n(92),o=n.n(r),s=n(48),l=n(60),c=n(18);const u=Object(a.memo)((({dateRangeFrom:e,dateRangeTo:t,hideSavedQuery:n=!1,indexPattern:r,isLoading:u=!1,isRefreshPaused:d,filterQuery:p,filterManager:m,filters:g,onChangedQuery:f,onSubmitQuery:b,refreshInterval:y,savedQuery:h,onSavedQuery:v,dataTestSubj:E,displayStyle:x,isDisabled:k})=>{const S=Object(a.useCallback)((e=>{null==e.query||o()(e.query,p)||b(e.query)}),[p,b]),w=Object(a.useCallback)((e=>{f&&null!=e.query&&!o()(e.query,p)&&f(e.query)}),[p,f]),j=Object(a.useCallback)((e=>{const{query:t,filters:n,timefilter:a}=e.attributes;b(t,a),m.setFilters(n||[]),v(e)}),[m,b,v]),O=Object(a.useCallback)((()=>{null!=h&&(b({query:"",language:h.attributes.query.language}),m.setFilters([]),v(void 0))}),[m,b,v,h]),I=Object(a.useCallback)((e=>{m.setFilters(e)}),[m]),T=Object(a.useMemo)((()=>[r]),[r]),C=Object(a.useMemo)((()=>new s.TimeHistory(new c.Storage(localStorage))),[]);return i.a.createElement(l.SearchBar,{showSubmitButton:!1,dateRangeFrom:e,dateRangeTo:t,filters:g,indexPatterns:T,isLoading:u,isRefreshPaused:d,query:p,onClearSavedQuery:O,onFiltersUpdated:I,onQueryChange:w,onQuerySubmit:S,onSaved:v,onSavedQueryUpdated:j,refreshInterval:y,showAutoRefreshOnly:!1,showFilterBar:!n,showDatePicker:!1,showQueryInput:!0,showSaveQuery:!0,timeHistory:C,dataTestSubj:E,savedQuery:h,displayStyle:x,isDisabled:k})}));u.displayName="QueryBar"},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"f",(function(){return r})),n.d(t,"g",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return u}));var a=n(0);const i=a.i18n.translate("xpack.securitySolution.documentationLinks.ariaLabelEnding",{defaultMessage:"click to open documentation in a new tab"}),r="sec-requirements.html",o=a.i18n.translate("xpack.securitySolution.documentationLinks.solutionRequirements.text",{defaultMessage:"Elastic Security system requirements"}),s="detections-permissions-section.html",l=a.i18n.translate("xpack.securitySolution.documentationLinks.detectionsRequirements.text",{defaultMessage:"Detections prerequisites and requirements"}),c="alerts-ui-monitor.html#ml-job-compatibility",u=a.i18n.translate("xpack.securitySolution.documentationLinks.mlJobCompatibility.text",{defaultMessage:"ML job compatibility"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(6),i=n.n(a);class InvariantError extends Error{constructor(...e){super(...e),i()(this,"name","InvariantError")}}function r(e,t){if(!e)throw new InvariantError(t)}},function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"d",(function(){return l})),n.d(t,"b",(function(){return c}));var a=n(131),i=n(113);function r(e){switch(e){case a.b.export:return i.zc;case a.b.duplicate:return i.lc;case a.b.delete:return i.dc;case a.b.enable:return i.uc;case a.b.disable:return i.hc;case a.b.edit:return i.pc}}function o(e,t){switch(e){case a.b.export:return u(t.succeeded,t.total);case a.b.duplicate:return i.mc(t.succeeded);case a.b.delete:return i.ec(t.succeeded);case a.b.enable:return i.vc(t.succeeded);case a.b.disable:return i.ic(t.succeeded)}}function s(e,t){return e.some((e=>e.type===a.a.add_index_patterns||e.type===a.a.set_index_patterns||e.type===a.a.delete_index_patterns))?`${i.qc(t.succeeded)}. ${i.rc}`:i.qc(t.succeeded)}function l(e){switch(e){case a.b.export:return i.wc;case a.b.duplicate:return i.jc;case a.b.delete:return i.bc;case a.b.enable:return i.sc;case a.b.disable:return i.fc;case a.b.edit:return i.nc}}function c(e,t){var n,r;const o=null===(n=t.body)||void 0===n||null===(r=n.attributes)||void 0===r?void 0:r.summary;if(!o)return"";switch(e){case a.b.export:return i.xc(o.failed);case a.b.duplicate:return i.kc(o.failed);case a.b.delete:return i.cc(o.failed);case a.b.enable:return i.tc(o.failed);case a.b.disable:return i.gc(o.failed);case a.b.edit:return i.oc(o.failed)}}const u=(e,t)=>{const n=[i.Ac(e,t)];return t>e&&n.push(i.yc),n.join(" ")}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(4),i=n(84),r=n(131),o=n(680);function s(){const e=Object(i.a)();return Object(a.useCallback)((({actionType:t,summary:n,editPayload:a})=>{const i=t===r.b.edit?Object(o.a)(null!=a?a:[],n):Object(o.c)(t,n);e.addSuccess({title:Object(o.e)(t),text:i})}),[e])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(4),i=n(131),r=n(238);function o(){const e=Object(r.c)();return Object(a.useCallback)((t=>{const n=null!=e&&e.state.isAllSelected?e.state.rules:[];return(t===i.b.enable?n.filter((e=>!e.enabled)):t===i.b.disable?n.filter((e=>e.enabled)):n).map((e=>e.id))}),[e])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(4),i=n(0),r=n(78),o=n(98),s=n(81),l=n(94),c=n(95),u=n(317),d=n(177),p=n(285),m=n(84);const g=()=>{const{indicesExist:e}=Object(l.d)(c.SourcererScopeName.detections),{indexFieldsSearch:t}=Object(p.b)(),n=Object(r.useDispatch)(),{addError:g}=Object(m.a)(),f=Object(a.useRef)(new AbortController),b=Object(a.useMemo)((()=>o.e.defaultDataViewSelector()),[]),y=Object(a.useMemo)((()=>o.e.signalIndexNameSelector()),[]),h=Object(s.a)(y),v=Object(s.a)(b),E=Object(a.useMemo)((()=>!v.title.includes(`${h}`)),[v.title,h]),x=Object(a.useMemo)((()=>!e&&!E),[e,E]),k=Object(a.useCallback)((()=>{null!==h&&(f.current.abort(),(async()=>{f.current=new AbortController;try{const e=await Object(u.b)({body:{patternList:v.title.split(",")},signal:f.current.signal});null!==h&&e.defaultDataView.patternList.includes(h)&&(t({dataViewId:e.defaultDataView.id}),n(d.a.setSourcererDataViews(e)))}catch(e){g(e,{title:i.i18n.translate("xpack.securitySolution.sourcerer.error.title",{defaultMessage:"Error updating Security Data View"}),toastMessage:i.i18n.translate("xpack.securitySolution.sourcerer.error.toastMessage",{defaultMessage:"Refresh the page"})})}})())}),[g,v.title,n,t,h]);return{...x?{pollForSignalIndex:k}:{},signalIndexNeedsInit:E}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return l})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return u}));var a=n(4),i=n.n(a),r=n(0),o=n(35);const s={FORM_TITLE:r.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.applyTimelineTemplate.formTitle",{defaultMessage:"Apply Timeline template"}),TEMPLATE_SELECTOR_LABEL:r.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.applyTimelineTemplate.templateSelectorLabel",{defaultMessage:"Apply Timeline template to selected rules"}),TEMPLATE_SELECTOR_HELP_TEXT:r.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.applyTimelineTemplate.templateSelectorHelpText",{defaultMessage:"Select which Timeline to apply to selected rules when investigating generated alerts."}),TEMPLATE_SELECTOR_PLACEHOLDER:r.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.applyTimelineTemplate.templateSelectorPlaceholder",{defaultMessage:"Search Timeline template"}),TEMPLATE_SELECTOR_DEFAULT_VALUE:r.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.applyTimelineTemplate.templateSelectorDefaultValue",{defaultMessage:"None"}),warningCalloutMessage:e=>i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.applyTimelineTemplate.warningCalloutMessage",defaultMessage:"You're about to apply changes to {rulesCount, plural, one {# selected rule} other {# selected rules}}. If you previously applied Timeline templates to these rules, they will be overwritten or (if you select 'None') reset to none.",values:{rulesCount:e}})},l={FORM_TITLE:r.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.addRuleActions.formTitle",{defaultMessage:"Add rule actions"}),OVERWRITE_LABEL:r.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.addRuleActions.overwriteCheckboxLabel",{defaultMessage:"Overwrite all selected rules actions"}),THROTTLE_LABEL:r.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.addRuleActions.throttleLabel",{defaultMessage:"Actions frequency"}),THROTTLE_HELP_TEXT:r.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.addRuleActions.throttleHelpText",{defaultMessage:"Select when automated actions should be performed if a rule evaluates as true."}),RULE_VARIABLES_DETAIL:r.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.addRuleActions.ruleVariablesDetail",{defaultMessage:"Rule variables may affect only some of the rules you select, based on the rule types (for example, \\u007b\\u007bcontext.rule.threshold\\u007d\\u007d will only display values for threshold rules)."})},c={FORM_TITLE:r.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.setSchedule.formTitle",{defaultMessage:"Update rule schedules"}),INTERVAL_LABEL:r.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.setSchedule.intervalLabel",{defaultMessage:"Runs every"}),INTERVAL_HELP_TEXT:r.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.setSchedule.intervalHelpText",{defaultMessage:"Rules run periodically and detect alerts within the specified time frame."}),LOOKBACK_LABEL:r.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.setSchedule.lookbackLabel",{defaultMessage:"Additional look-back time"}),LOOKBACK_HELP_TEXT:r.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.setSchedule.lookbackHelpText",{defaultMessage:"Adds time to the look-back period to prevent missed alerts."}),warningCalloutMessage:e=>i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.setSchedule.warningCalloutMessage",defaultMessage:"You're about to apply changes to {rulesCount, plural, one {# selected rule} other {# selected rules}}. The changes you make will overwrite the existing rule schedules and additional look-back time (if any).",values:{rulesCount:e}})},u={MODAL_TITLE:e=>i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.exceptionsConfirmation.modalTitle",defaultMessage:"Duplicate {rulesCount, plural, one {the rule} other {rules}} with exceptions?",values:{rulesCount:e}}),MODAL_TEXT:e=>i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.exceptionsConfirmation.modalBody",defaultMessage:"You are duplicating {rulesCount, plural, one {# selected rule} other {# selected rules}}, please select how you would like to duplicate the existing exceptions",values:{rulesCount:e}}),DUPLICATE_EXCEPTIONS_TEXT:e=>i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.exceptionsConfirmation.with",defaultMessage:"Duplicate {rulesCount, plural, one {rule} other {rules}} and their exceptions",values:{rulesCount:e}}),DUPLICATE_WITHOUT_EXCEPTIONS_TEXT:e=>i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.exceptionsConfirmation.without",defaultMessage:"Only duplicate {rulesCount, plural, one {the rule} other {rules}}",values:{rulesCount:e}}),CONTINUE_BUTTON:r.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.exceptionsConfirmation.continueButton",{defaultMessage:"Duplicate"}),CANCEL_BUTTON:r.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.exceptionsConfirmation.cancelButton",{defaultMessage:"Cancel"}),DUPLICATE_TOOLTIP:r.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.exceptionsConfirmation.tooltip",{defaultMessage:" If you duplicate exceptions, then the shared exceptions list will be duplicated by reference and the default rule exception will be copied and created as a new one"})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(206);const i=(e,t)=>{const n=Object(a.g)(e),i=Object(a.b)(e);return"create"===t?i:n}},function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var a=n(4),i=n.n(a),r=n(7),o=n(32),s=n(35),l=n(245),c=n(132),u=n(66),d=n(91),p=n(175),m=n(187),g=n(13),f=n(77),b=n(372),y=n(891),h=n(279),v=n(290),E=n(721),x=n(576),k=n(517),S=n(190);const w=[c.c.MAC,c.c.WINDOWS,c.c.LINUX].map((e=>({value:e,inputDisplay:h.a[e]}))),j=e=>e.entries.map((e=>(delete e.id,e))),O=Object(a.memo)((({allowSelectOs:e=!0,item:t,policies:n,policiesIsLoading:h,onChange:O,mode:I})=>{const T=Object(d.a)("eventFilters-form"),{http:C,unifiedSearch:M}=Object(f.k)().services,[N,D]=Object(a.useState)(!1),[F,A]=Object(a.useState)(!t.name),[_,R]=Object(a.useState)(""),[P,L]=Object(a.useState)(!1),[q,B]=Object(a.useState)([]),z=Object(g.b)().isPlatinumPlus(),$=Object(a.useMemo)((()=>Object(b.e)(t)),[t]),[V,U]=Object(a.useState)(!Object(x.d)(null==t?void 0:t.tags)),[H,G]=Object(a.useState)(!1),Q=Object(a.useMemo)((()=>["logs-endpoint.events.*"]),[]),[W,{indexPatterns:K}]=Object(p.b)(Q),[Y,J]=Object(a.useState)(!!t.entries.length||!1),X=Object(a.useMemo)((()=>null==t?void 0:t.comments),[]),Z=Object(a.useMemo)((()=>z||"edit"===I&&(!$||V&&$&&N)),[I,$,N,z,V]),ee=Object(a.useMemo)((()=>!F&&!!t.entries.length&&t.entries.some((e=>""!==e.value||e.value.length))),[F,t.entries]),te=Object(a.useCallback)((e=>{const n=e?{...t,...e}:t;j(n),O({item:n,isValid:ee&&Y})}),[Y,t,ee,O]);Object(a.useEffect)((()=>{!N&&t.tags&&U(!Object(x.d)(t.tags))}),[t.tags,N]),Object(a.useEffect)((()=>{if(N)return;const e=t.tags?Object(b.c)({tags:t.tags}):[];if(!e.length)return;const a=n.filter((t=>e.includes(t.id)));B(a)}),[N,t,n]);const ne=Object(a.useMemo)((()=>{const e=t;return e.entries=t.entries.length?t.entries:[{field:"",operator:"included",type:"match",value:""}],j(e),J(!!t.entries.length),e}),[t]),ae=Object(a.useCallback)((e=>{if(!t)return;const n=e.target.value.trim();A(!n),te({name:n}),N||D(!0)}),[t,N,te]),ie=Object(a.useMemo)((()=>{var e;return i.a.createElement(o.EuiFormRow,{label:y.e,fullWidth:!0,isInvalid:F&&P,error:y.d},i.a.createElement(o.EuiFieldText,{"aria-label":y.e,id:"eventFiltersFormInputName",defaultValue:null!==(e=null==t?void 0:t.name)&&void 0!==e?e:"","data-test-subj":T("name-input"),fullWidth:!0,maxLength:256,required:P,onChange:ae,onBlur:()=>!P&&L(!0)}))}),[T,F,ae,P,null==t?void 0:t.name]),re=Object(a.useCallback)((e=>{t&&(N||D(!0),te({description:e.target.value.toString().trim()}))}),[t,N,te]),oe=Object(a.useMemo)((()=>{var e;return i.a.createElement(o.EuiFormRow,{label:y.b,fullWidth:!0},i.a.createElement(o.EuiTextArea,{id:"eventFiltersFormInputDescription",defaultValue:null!==(e=null==t?void 0:t.description)&&void 0!==e?e:"",onChange:re,fullWidth:!0,"data-test-subj":T("description-input"),"aria-label":y.b,maxLength:256}))}),[null==t?void 0:t.description,T,re]),se=Object(a.useMemo)((()=>{var e;return null!=t&&null!==(e=t.os_types)&&void 0!==e&&e.length?t.os_types[0]:c.c.WINDOWS}),[null==t?void 0:t.os_types]),le=Object(a.useCallback)((e=>{t&&(te({os_types:[e],entries:t.entries}),N||D(!0))}),[t,N,te]),ce=Object(a.useMemo)((()=>i.a.createElement(o.EuiFormRow,{label:y.f,fullWidth:!0},i.a.createElement(o.EuiSuperSelect,{name:"os",options:w,fullWidth:!0,valueOfSelected:se,onChange:le}))),[le,se]),ue=Object(a.useCallback)((e=>{t&&(R(e),te({comments:[{comment:e}]}),N||D(!0))}),[t,N,te]),de=Object(a.useMemo)((()=>i.a.createElement(k.a,{exceptionItemComments:X,newCommentValue:_,newCommentOnChange:ue})),[X,ue,_]),pe=Object(a.useMemo)((()=>i.a.createElement(i.a.Fragment,null,i.a.createElement(o.EuiText,{size:"xs"},i.a.createElement("h3",null,i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventFilters.commentsSectionTitle",defaultMessage:"Comments"}))),i.a.createElement(o.EuiSpacer,{size:"xs"}),i.a.createElement(o.EuiText,{size:"s"},i.a.createElement("p",null,i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventFilters.commentsSectionDescription",defaultMessage:"Add a comment to your event filter."}))),i.a.createElement(o.EuiSpacer,{size:"m"}),de)),[de]),me=Object(a.useMemo)((()=>i.a.createElement(i.a.Fragment,null,i.a.createElement(o.EuiText,{size:"xs"},i.a.createElement("h3",null,i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventFilters.detailsSectionTitle",defaultMessage:"Details"}))),i.a.createElement(o.EuiSpacer,{size:"xs"}),i.a.createElement(o.EuiText,{size:"s"},i.a.createElement("p",null,y.a)),i.a.createElement(o.EuiSpacer,{size:"m"}),ie,oe)),[ie,oe]),ge=Object(a.useCallback)((e=>{var n,a,i,o,s,l,u,d,p;if(!N&&void 0===e.exceptionItems[0]||Object(r.isEqual)(null===(n=e.exceptionItems[0])||void 0===n?void 0:n.entries,null==t?void 0:t.entries)){var m;const t=(null===(m=e.exceptionItems[0])||void 0===m?void 0:m.entries.map((e=>e.field)))||[""];return G((p=t.reduce(((e,t)=>(t in e?e[t]++:e[t]=1,e)),{}),Object.values(p).some((e=>e>1)))),void(N||D(!0))}const g=void 0!==e.exceptionItems[0]?{...e.exceptionItems[0],name:null!==(a=null==t?void 0:t.name)&&void 0!==a?a:"",description:null!==(i=null==t?void 0:t.description)&&void 0!==i?i:"",comments:null!==(o=null==t?void 0:t.comments)&&void 0!==o?o:[],os_types:null!==(s=null==t?void 0:t.os_types)&&void 0!==s?s:[c.c.WINDOWS],tags:null!==(l=null==t?void 0:t.tags)&&void 0!==l?l:[]}:t,f=void 0!==e.exceptionItems[0]&&!(e.errorExists&&(null===(u=e.exceptionItems[0])||void 0===u||null===(d=u.entries)||void 0===d||!d.length));J(f),te(g),N||D(!0)}),[t,N,te]),fe=Object(a.useMemo)((()=>Object(u.getExceptionBuilderComponentLazy)({allowLargeValueLists:!1,httpService:C,autocompleteService:M.autocomplete,exceptionListItems:[ne],listType:v.c,listId:v.a,listNamespaceType:"agnostic",ruleName:y.g,indexPatterns:K,isOrDisabled:!0,isOrHidden:!0,isAndDisabled:!1,isNestedDisabled:!1,dataTestSubj:"alert-exception-builder",idAria:"alert-exception-builder",onChange:ge,listTypeSpecificIndexPatternFilter:S.h,operatorsList:l.b,osTypes:t.os_types})),[M,ge,C,K,t,ne]),be=Object(a.useMemo)((()=>i.a.createElement(i.a.Fragment,null,i.a.createElement(o.EuiText,{size:"xs"},i.a.createElement("h3",null,i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventFilters.criteriaSectionTitle",defaultMessage:"Conditions"}))),i.a.createElement(o.EuiSpacer,{size:"xs"}),i.a.createElement(o.EuiText,{size:"s"},i.a.createElement("p",null,e?i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventFilters.criteriaSectionDescription.withOs",defaultMessage:"Select an operating system and add conditions."}):i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventFilters.criteriaSectionDescription.withoutOs",defaultMessage:"Add conditions."}))),i.a.createElement(o.EuiSpacer,{size:"m"}),e?i.a.createElement(i.a.Fragment,null,ce,i.a.createElement(o.EuiSpacer,null)):null,fe)),[e,fe,ce]),ye=Object(a.useCallback)((e=>{const t=e.isGlobal?[b.b]:e.selected.map((e=>`${b.a}${e.id}`));e.isGlobal||B(e.selected),te({tags:t}),N||D(!0)}),[te,N,B]),he=Object(a.useMemo)((()=>i.a.createElement(E.a,{selected:q,options:n,isGlobal:$,isLoading:h,isPlatinumPlus:z,onChange:ye,"data-test-subj":"effectedPolicies-select"})),[n,q,$,z,ye,h]);return Object(a.useEffect)((()=>{te()}),[te]),W||!t?i.a.createElement(m.a,{size:"xl"}):i.a.createElement(o.EuiForm,{component:"div"},me,i.a.createElement(o.EuiHorizontalRule,null),be,H&&i.a.createElement(i.a.Fragment,null,i.a.createElement(o.EuiSpacer,{size:"xs"}),i.a.createElement(o.EuiText,{color:"subdued",size:"xs","data-test-subj":"duplicate-fields-warning-message"},i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventFilters.warningMessage.duplicateFields",defaultMessage:"Using multiples of the same filed values can degrade Endpoint performance and/or create ineffective rules"}))),Z&&i.a.createElement(i.a.Fragment,null,i.a.createElement(o.EuiHorizontalRule,null),he),i.a.createElement(o.EuiHorizontalRule,null),pe)}));O.displayName="EventFiltersForm"},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(59),i=n(373);const r=(e,t={})=>{var n;return e.get(i.a,{...t,query:{...t.query,kuery:`${null!=t&&null!==(n=t.query)&&void 0!==n&&n.kuery?`${t.query.kuery} and `:""}${a.PACKAGE_POLICY_SAVED_OBJECT_TYPE}.package.name: endpoint`}})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(4);const i=()=>{const[e,t]=Object(a.useState)(!1),n=Object(a.useCallback)((()=>{t(!0)}),[]);return{closeAddEventFilterModal:Object(a.useCallback)((()=>{t(!1)}),[]),isAddEventFilterModalOpen:e,onAddEventFilterClick:n}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(32),i=n(33);const r=n.n(i)()(a.EuiFlexGroup).withConfig({displayName:"ConditionalFlexGroup",componentId:"sc-jyindk-0"})(["@media only screen and (min-width:1441px){flex-direction:row !important;}"]);r.displayName="ConditionalFlexGroup"},function(e,t,n){"use strict";let a;n.d(t,"a",(function(){return a})),function(e){e.summary="summary"}(a||(a={}))},,function(e,t,n){"use strict";n.d(t,"a",(function(){return X}));var a=n(4),i=n.n(a),r=n(32),o=n(37),s=n(129),l=n(574),c=n(927),u=n(503),d=n(0),p=n(232);const m=["create","edit"],g=(e=!0,t=!0)=>{var n;const i=null!==(n=Object(p.a)().urlParams.show)&&void 0!==n?n:"";return Object(a.useMemo)((()=>!!m.includes(i)&&("create"===i&&t||"edit"===i&&e)),[t,e,i])};var f=n(91),b=n(7);const y=()=>{const e=Object(o.useLocation)(),t=Object(o.useHistory)(),{toUrlParams:n,urlParams:i}=Object(p.a)();return Object(a.useCallback)(((a,r=!1)=>{t.push({...e,search:n(r?a:Object(b.pickBy)({...i,...a},(e=>void 0!==e)))})}),[i,t,e,n])};var h=n(563),v=n(77),E=n(314),x=n(685),k=n(116),S=n(372),w=n(206);const j=Object.freeze({flyoutEditTitle:d.i18n.translate("xpack.securitySolution.artifactListPage.flyoutEditTitle",{defaultMessage:"Add artifact"}),flyoutCreateTitle:d.i18n.translate("xpack.securitySolution.artifactListPage.flyoutCreateTitle",{defaultMessage:"Create artifact"}),flyoutCancelButtonLabel:d.i18n.translate("xpack.securitySolution.artifactListPage.flyoutCancelButtonLabel",{defaultMessage:"Cancel"}),flyoutCreateSubmitButtonLabel:d.i18n.translate("xpack.securitySolution.artifactListPage.flyoutCreateSubmitButtonLabel",{defaultMessage:"Add"}),flyoutEditSubmitButtonLabel:d.i18n.translate("xpack.securitySolution.artifactListPage.flyoutEditSubmitButtonLabel",{defaultMessage:"Save"}),flyoutDowngradedLicenseTitle:d.i18n.translate("xpack.securitySolution.artifactListPage.expiredLicenseTitle",{defaultMessage:"Expired License"}),flyoutDowngradedLicenseInfo:d.i18n.translate("xpack.securitySolution.artifactListPage.flyoutDowngradedLicenseInfo",{defaultMessage:"Your Kibana license has been downgraded. Future policy configurations will now be globally assigned to all policies."}),flyoutDowngradedLicenseDocsInfo:e=>d.i18n.translate("xpack.securitySolution.artifactListPage.flyoutDowngradedLicenseDocsInfo",{defaultMessage:"For more information, see our documentation."}),flyoutEditItemLoadFailure:e=>d.i18n.translate("xpack.securitySolution.artifactListPage.flyoutEditItemLoadFailure",{defaultMessage:"Failed to retrieve item for edit. Reason: {errorMessage}",values:{errorMessage:e}}),flyoutCreateSubmitSuccess:({name:e})=>d.i18n.translate("xpack.securitySolution.some_page.flyoutCreateSubmitSuccess",{defaultMessage:'"{name}" has been added.',values:{name:e}}),flyoutEditSubmitSuccess:({name:e})=>d.i18n.translate("xpack.securitySolution.artifactListPage.flyoutEditSubmitSuccess",{defaultMessage:'"{name}" has been updated.',values:{name:e}})}),O=(e,t)=>({isValid:!1,item:null!=t?t:Object(E.a)(e)}),I=Object(a.memo)((({apiClient:e,item:t,policies:n,policiesIsLoading:o,FormComponent:l,onSuccess:c,onClose:u,submitHandler:d,labels:m={},"data-test-subj":b,size:E="m"})=>{var I,T;const{docLinks:{links:{securitySolution:C}}}=Object(v.k)().services,M=Object(f.a)(b),N=Object(v.o)(),D=g(),F=y(),{urlParams:A}=Object(p.a)(),_=Object(s.b)(),R=Object(a.useMemo)((()=>({...j,...m})),[m]),[P,L]=Object(a.useState)(!1),[q,B]=Object(a.useState)(void 0),z="edit"===A.show,$=z?"edit":"create",{isLoading:V,mutateAsync:U,error:H}=Object(x.a)(e,$),G=Object(a.useMemo)((()=>d?P:V),[P,V,d]),Q=Object(a.useMemo)((()=>d?q:H),[q,H,d]),{isRefetching:W,error:K,refetch:Y}=Object(w.d)(e,null!==(I=A.itemId)&&void 0!==I?I:"",void 0,{enabled:!1}),[J,X]=Object(a.useState)(O.bind(null,e.listId,t)),Z=((e,t)=>{const n=Object(k.a)().endpointPrivileges;return Object(a.useMemo)((()=>"edit"===t&&!n.canCreateArtifactsByPolicy&&Object(S.d)(e)),[n.canCreateArtifactsByPolicy,e,t])})({tags:null!==(T=J.item.tags)&&void 0!==T?T:[]},$),ee=Object(a.useMemo)((()=>!!t||!!J.item.item_id),[J.item.item_id,t]),te=Object(a.useMemo)((()=>z&&!ee),[ee,z]),ne=Object(a.useCallback)((()=>{G||(F({...A,itemId:void 0,show:void 0},!0),u())}),[G,u,F,A]),ae=Object(a.useCallback)((({item:e,isValid:t})=>{_()&&X({item:e,isValid:t})}),[_]),ie=Object(a.useCallback)((e=>{N.addSuccess(z?R.flyoutEditSubmitSuccess(e):R.flyoutCreateSubmitSuccess(e)),_()&&(F({...A,itemId:void 0,show:void 0},!0),c())}),[z,_,R,c,F,N,A]),re=Object(a.useCallback)((()=>{d?(L(!0),d(J.item,$).then(ie).catch((e=>{_()&&B(e)})).finally((()=>{_()&&L(!1)}))):U(J.item).then(ie)}),[$,J.item,ie,_,U,d]);return Object(a.useEffect)((()=>{!z||ee||K||!te||W||Y().then((({data:t})=>{t&&_()&&X(O(e.listId,t))}))}),[e.listId,K,Y,z,te,W,ee,_]),Object(a.useEffect)((()=>{var e;z&&K&&(N.addWarning(R.flyoutEditItemLoadFailure((null==K||null===(e=K.body)||void 0===e?void 0:e.message)||K.message)),F({itemId:void 0,show:void 0}))}),[K,z,R,F,N,A.itemId]),!D||K?null:i.a.createElement(r.EuiFlyout,{size:E,onClose:ne,"data-test-subj":b},i.a.createElement(r.EuiFlyoutHeader,{hasBorder:!0},i.a.createElement(r.EuiTitle,{size:"m"},i.a.createElement("h2",null,z?R.flyoutEditTitle:R.flyoutCreateTitle))),!te&&Z&&i.a.createElement(r.EuiCallOut,{title:R.flyoutDowngradedLicenseTitle,color:"warning",iconType:"help","data-test-subj":M("expiredLicenseCallout")},R.flyoutDowngradedLicenseInfo," ",R.flyoutDowngradedLicenseDocsInfo(C)),i.a.createElement(r.EuiFlyoutBody,null,te&&i.a.createElement(h.a,{"data-test-subj":M("loader")}),!te&&i.a.createElement(l,{onChange:ae,disabled:G,item:J.item,error:null!=Q?Q:void 0,mode:$,policies:n,policiesIsLoading:o})),!te&&i.a.createElement(r.EuiFlyoutFooter,null,i.a.createElement(r.EuiFlexGroup,{justifyContent:"spaceBetween"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButtonEmpty,{"data-test-subj":M("cancelButton"),onClick:ne,disabled:G},R.flyoutCancelButtonLabel)),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButton,{"data-test-subj":M("submitButton"),fill:!0,disabled:!J.isValid||G,onClick:re,isLoading:G},z?R.flyoutEditSubmitButtonLabel:R.flyoutCreateSubmitButtonLabel)))))}));I.displayName="ArtifactFlyout";var T=n(82),C=n.n(T);const M=Object(a.memo)((e=>{const t=Object(a.useRef)(null),n=i.a.createElement(r.EuiButton,C()({buttonRef:t},e));return Object(a.useEffect)((()=>{t.current&&t.current.focus()}),[]),n}));M.displayName="AutoFocusButton";const N=Object.freeze({deleteActionFailure:(e,t)=>d.i18n.translate("xpack.securitySolution.artifactListPage.deleteActionFailure",{defaultMessage:'Unable to remove "{itemName}". Reason: {errorMessage}',values:{itemName:e,errorMessage:t}}),deleteActionSuccess:e=>d.i18n.translate("xpack.securitySolution.artifactListPage.deleteActionSuccess",{defaultMessage:'"{itemName}" has been removed',values:{itemName:e}})}),D=Object.freeze({deleteModalTitle:e=>d.i18n.translate("xpack.securitySolution.artifactListPage.deleteModalTitle",{defaultMessage:"Delete {itemName}",values:{itemName:e}}),deleteModalImpactTitle:d.i18n.translate("xpack.securitySolution.artifactListPage.deleteModalImpactTitle",{defaultMessage:"Warning"}),deleteModalImpactInfo:e=>d.i18n.translate("xpack.securitySolution.artifactListPage.deleteModalImpactInfo",{defaultMessage:"Deleting this entry will remove it from {count} associated {count, plural, one {policy} other {policies}}.",values:{count:Object(S.e)(e)?d.i18n.translate("xpack.securitySolution.artifactListPage.deleteModalImpactInfoAll",{defaultMessage:"all"}):Object(S.c)(e).length}}),deleteModalConfirmInfo:d.i18n.translate("xpack.securitySolution.artifactListPage.deleteModalConfirmInfo",{defaultMessage:"This action cannot be undone. Are you sure you wish to continue?"}),deleteModalSubmitButtonTitle:d.i18n.translate("xpack.securitySolution.artifactListPage.deleteModalSubmitButtonTitle",{defaultMessage:"Delete"}),deleteModalCancelButtonTitle:d.i18n.translate("xpack.securitySolution.artifactListPage.deleteModalCancelButtonTitle",{defaultMessage:"Cancel"})}),F=Object(a.memo)((({apiClient:e,item:t,onCancel:n,onSuccess:o,"data-test-subj":s,labels:l})=>{const c=Object(f.a)(s),{deleteArtifactItem:u,isLoading:d}=((e,t,n)=>{const i=Object(v.o)(),r=Object(w.c)(e,{onError:e=>{var a;i.addDanger(n.deleteActionFailure(t.name,(null===(a=e.body)||void 0===a?void 0:a.message)||e.message))},onSuccess:e=>{i.addSuccess(n.deleteActionSuccess(e.name))}});return Object(a.useMemo)((()=>({...r,deleteArtifactItem:r.mutateAsync})),[r])})(e,t,l),p=Object(a.useCallback)((()=>{u(t).then((()=>o()))}),[u,t,o]),m=Object(a.useCallback)((()=>{d||n()}),[d,n]);return i.a.createElement(r.EuiModal,{onClose:m,"data-test-subj":s},i.a.createElement(r.EuiModalHeader,{"data-test-subj":c("header")},i.a.createElement(r.EuiModalHeaderTitle,null,l.deleteModalTitle(t.name))),i.a.createElement(r.EuiModalBody,{"data-test-subj":c("body")},i.a.createElement(r.EuiText,null,i.a.createElement(r.EuiCallOut,{"data-test-subj":c("impactCallout"),title:l.deleteModalImpactTitle,color:"danger",iconType:"alert"},i.a.createElement("p",{"data-test-subj":c("impactCalloutInfo")},l.deleteModalImpactInfo(t))),i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement("p",null,l.deleteModalConfirmInfo))),i.a.createElement(r.EuiModalFooter,null,i.a.createElement(r.EuiButtonEmpty,{onClick:m,isDisabled:d,"data-test-subj":c("cancelButton")},l.deleteModalCancelButtonTitle),i.a.createElement(M,{fill:!0,color:"danger",onClick:p,isLoading:d,isDisabled:d,"data-test-subj":c("submitButton")},l.deleteModalSubmitButtonTitle)))}));F.displayName="ArtifactDeleteModal";const A=Object.freeze({pageTitle:d.i18n.translate("xpack.securitySolution.artifactListPage.pageTitle",{defaultMessage:"Artifact"}),pageAboutInfo:d.i18n.translate("xpack.securitySolution.artifactListPage.aboutInfo",{defaultMessage:"A list of artifacts for endpoint"}),pageAddButtonTitle:d.i18n.translate("xpack.securitySolution.artifactListPage.addButtonTitle",{defaultMessage:"Add artifact"}),emptyStateTitle:d.i18n.translate("xpack.securitySolution.artifactListPage.emptyStateTitle",{defaultMessage:"Add your first artifact"}),emptyStateInfo:d.i18n.translate("xpack.securitySolution.artifactListPage.emptyStateInfo",{defaultMessage:"Add an artifact"}),emptyStatePrimaryButtonLabel:d.i18n.translate("xpack.securitySolution.artifactListPage.emptyStatePrimaryButtonLabel",{defaultMessage:"Add"}),searchPlaceholderInfo:d.i18n.translate("xpack.securitySolution.artifactListPage.searchPlaceholderInfo",{defaultMessage:"Search on the fields below: name, description, comments, value"}),getShowingCountLabel:e=>d.i18n.translate("xpack.securitySolution.artifactListPage.showingTotal",{defaultMessage:"Showing {total, plural, one {# artifact} other {# artifacts}}",values:{total:e}}),cardActionEditLabel:d.i18n.translate("xpack.securitySolution.artifactListPage.cardActionEditLabel",{defaultMessage:"Edit artifact"}),cardActionDeleteLabel:d.i18n.translate("xpack.securitySolution.artifactListPage.cardActionDeleteLabel",{defaultMessage:"Delete event filter"}),...j,...D,...N});var _=n(840),R=n(394),P=n(279),L=n(33),q=n.n(L),B=n(647);const z=q()(r.EuiEmptyPrompt).withConfig({displayName:"EmptyPrompt",componentId:"sc-1kgkcft-0"})(["",""],(()=>Object(L.css)(["max-width:100%;"]))),$=Object(a.memo)((({onAdd:e,isAddDisabled:t=!1,backComponent:n,"data-test-subj":a,titleLabel:o,aboutInfo:s,primaryButtonLabel:l,secondaryAboutInfo:c})=>{const u=Object(f.a)(a);return i.a.createElement(B.a,null,i.a.createElement(z,{"data-test-subj":a,iconType:"plusInCircle",title:i.a.createElement("h2",{"data-test-subj":u("title")},o),body:i.a.createElement("div",{"data-test-subj":u("aboutInfo")},s,c?i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiSpacer,{size:"m"}),c):void 0),actions:[i.a.createElement(r.EuiButton,{fill:!0,isDisabled:t,onClick:e,"data-test-subj":u("addButton")},l),...n?[n]:[]]}))}));$.displayName="NoDataEmptyState";var V=n(39),U=n(105),H=n(350),G=n(405);var Q=n(139),W=n(35),K=n(243);const Y=Object(a.memo)((({backButtonLabel:e,backButtonUrl:t,onBackButtonNavigateTo:n,...a})=>{const o=Object(K.a)(...n);return i.a.createElement(r.EuiButtonEmpty,C()({},a,{"data-test-subj":"backToOrigin",size:"s",href:t,onClick:o,textProps:{className:"text"}}),e||i.a.createElement(W.FormattedMessage,{id:"xpack.securitySolution.list.backButton",defaultMessage:"Back"}))}));Y.displayName="BackToExternalAppSecondaryButton";var J=n(537);const X=Object(a.memo)((({apiClient:e,ArtifactFormComponent:t,searchableFields:n=Q.c,labels:d={},secondaryPageInfo:m,onFormSubmit:b,flyoutSize:E,"data-test-subj":x,allowCardEditAction:k=!0,allowCardCreateAction:S=!0,allowCardDeleteAction:j=!0})=>{var O,T;const{state:C}=Object(o.useLocation)(),M=Object(f.a)(x),N=Object(v.o)(),D=Object(s.b)(),L=g(k,S),q=y(),{urlParams:{filter:B,includedPolicies:z}}=Object(p.a)(),{isPageInitializing:W,isFetching:K,data:X,uiPagination:Z,doesDataExist:ee,error:te,refetch:ne}=((e,t)=>{const n=Object(s.b)(),{urlParams:{filter:i,includedPolicies:r}}=Object(p.a)(),{pagination:{page:o,pageSize:l}}=Object(G.b)(),c=((e,t,n)=>Object(a.useMemo)((()=>Object(H.a)({kuery:Object(H.b)(e,t),policies:n?n.split(","):[]})),[t,e,n]))(i,t,r),{data:u,isFetching:d,refetch:m}=Object(V.useQuery)(["does-data-exists",e],(async()=>e.hasData()),{enabled:!0,keepPreviousData:!0,refetchOnWindowFocus:!1}),[g,f]=Object(a.useState)({totalItemCount:0,pageSize:l,pageSizeOptions:[...U.f],pageIndex:o-1}),[b,y]=Object(a.useState)(!0),h=Object(w.e)(e,{page:o,perPage:l,filter:i,policies:r?r.split(","):[]},t),{data:v,isFetching:E,error:x,isSuccess:k}=h;return Object(a.useEffect)((()=>{n()&&b&&!d&&y(!1)}),[d,n,b]),Object(a.useEffect)((()=>{n()&&v&&!E&&k&&f((e=>({...e,pageIndex:v.page-1,pageSize:v.per_page,totalItemCount:v.total})))}),[E,n,k,v]),Object(a.useEffect)((()=>{!n()||E||d||x||"1"!==String(o)||c||!(v&&0===v.total&&u||v&&v.total>0&&!u)||m()}),[m,u,i,r,d,E,n,c,v,x,o]),Object(a.useMemo)((()=>({isPageInitializing:b,doesDataExist:null!=u&&u,uiPagination:g,...h})),[u,b,h,g])})(e,n);Object(a.useEffect)((()=>{var e;!K&&te&&N.addDanger((null==te||null===(e=te.body)||void 0===e?void 0:e.message)||te.message)}),[te,N,K]);const ae=Object(a.useMemo)((()=>{var e;return null!==(e=null==X?void 0:X.data)&&void 0!==e?e:[]}),[null==X?void 0:X.data]),[ie,re]=Object(a.useState)(void 0),[oe,se]=Object(a.useState)(void 0),le=Object(a.useMemo)((()=>({...A,...d})),[d]),ce=(({items:e,onAction:t,cardActionDeleteLabel:n,cardActionEditLabel:i,dataTestSubj:r,allowCardDeleteAction:o=!0,allowCardEditAction:s=!0})=>{const l=Object(f.a)(r),c=Object(v.o)(),{data:d}=Object(R.c)({onError:e=>{c.addDanger(Object(P.b)(e))}}),p=Object(u.f)(null==d?void 0:d.items),m=Object(a.useMemo)((()=>{const a={};for(const c of e){const e=[];s&&e.push({icon:"controlsHorizontal",onClick:()=>{t({type:"edit",item:c})},"data-test-subj":l("cardEditAction"),children:i}),o&&e.push({icon:"trash",onClick:()=>{t({type:"delete",item:c})},"data-test-subj":l("cardDeleteAction"),children:n}),a[c.id]={item:c,policies:p,"data-test-subj":r,actions:e.length>0?e:void 0,hideDescription:!c.description,hideComments:!c.comments.length}}return a}),[e,s,o,p,r,l,i,t,n]);return Object(a.useCallback)((e=>m[e.id]),[m])})({items:ae,onAction:Object(a.useCallback)((({type:e,item:t})=>{switch(e){case"edit":se(t),q({show:"edit",itemId:t.item_id});break;case"delete":re(t)}}),[q]),cardActionDeleteLabel:le.cardActionDeleteLabel,cardActionEditLabel:le.cardActionEditLabel,dataTestSubj:M("card"),allowCardDeleteAction:j,allowCardEditAction:k}),ue=Object(R.c)({onError:e=>{N.addWarning(Object(P.b)(e))}}),de=function(e){const[t,n]=Object(a.useState)();return Object(a.useEffect)((()=>{e&&e.onBackButtonNavigateTo&&n(e)}),[e]),t}(C),pe=Object(a.useMemo)((()=>{if(de&&de.onBackButtonNavigateTo)return i.a.createElement(Y,de)}),[de]),me=Object(a.useMemo)((()=>{if(de&&de.onBackButtonNavigateTo)return i.a.createElement(J.a,de)}),[de]),ge=Object(a.useCallback)((()=>{q({show:"create"})}),[q]),fe=Object(a.useCallback)((({pageIndex:e,pageSize:t})=>{q({page:e+1,pageSize:t}),window.scrollTo({top:0,left:0,behavior:"smooth"})}),[q]),be=Object(a.useCallback)(((e,t,n)=>{const a=e!==(null!=B?B:"")||t!==(null!=z?z:"");q({filter:""===e.trim()?void 0:e,includedPolicies:""===t.trim()?void 0:t}),n&&!a&&ne()}),[B,z,ne,q]),ye=Object(a.useCallback)((()=>{D()&&(re(void 0),ne())}),[D,ne]),he=Object(a.useCallback)((()=>{re(void 0)}),[]),ve=Object(a.useCallback)((()=>{se(void 0),ne()}),[ne]),Ee=Object(a.useCallback)((()=>{se(void 0)}),[]),xe=Object(a.useMemo)((()=>{const e=le.pageAboutInfo?i.a.createElement("span",{"data-test-subj":"header-panel-subtitle"},le.pageAboutInfo):void 0,t=m?i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiSpacer,{size:"m"}),m):void 0;return i.a.createElement(i.a.Fragment,null,e,t)}),[le.pageAboutInfo,m]);return W?i.a.createElement(h.a,{"data-test-subj":M("pageLoader")}):i.a.createElement(l.a,{headerBackComponent:me,hideHeader:!ee,title:le.pageTitle,subtitle:xe,actions:S&&i.a.createElement(r.EuiButton,{fill:!0,iconType:"plusInCircle",isDisabled:L,onClick:ge,"data-test-subj":M("pageAddButton")},le.pageAddButtonTitle),"data-test-subj":M("container")},L&&i.a.createElement(I,{apiClient:e,item:oe,onSuccess:ve,onClose:Ee,FormComponent:t,labels:le,size:E,submitHandler:b,policies:(null===(O=ue.data)||void 0===O?void 0:O.items)||[],policiesIsLoading:ue.isLoading,"data-test-subj":M("flyout")}),ie&&i.a.createElement(F,{apiClient:e,item:ie,labels:le,"data-test-subj":M("deleteModal"),onSuccess:ye,onCancel:he}),ee?i.a.createElement(i.a.Fragment,null,i.a.createElement(_.a,{defaultValue:B,onSearch:be,placeholder:le.searchPlaceholderInfo,hasPolicyFilter:!0,policyList:null===(T=ue.data)||void 0===T?void 0:T.items,defaultIncludedPolicies:z}),i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement(r.EuiText,{color:"subdued",size:"xs","data-test-subj":M("showCount")},le.getShowingCountLabel(Z.totalItemCount)),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(c.a,{items:ae,ItemComponent:u.a,itemComponentProps:ce,onChange:fe,error:te,loading:K,pagination:Z,contentClassName:"card-container","data-test-subj":M("list")})):i.a.createElement($,{onAdd:ge,titleLabel:le.emptyStateTitle,aboutInfo:le.emptyStateInfo,primaryButtonLabel:le.emptyStatePrimaryButtonLabel,backComponent:pe,"data-test-subj":M("emptyState"),secondaryAboutInfo:m}))}));X.displayName="ArtifactListPage"},function(e,t,n){"use strict";n.d(t,"a",(function(){return G}));var a=n(32),i=n(4),r=n.n(i),o=n(34),s=n(515),l=n(516);const c=r.a.memo((({contextId:e,eventId:t,isDraggable:n,tlsClientCertificateFingerprintSha1:i,tlsFingerprintsJa3Hash:c,tlsServerCertificateFingerprintSha1:u})=>r.a.createElement(a.EuiFlexGroup,{alignItems:"center","data-test-subj":"fingerprints-group",direction:"column",justifyContent:"center",gutterSize:"none"},null!=c?Object(o.uniq)(c).map((i=>r.a.createElement(a.EuiFlexItem,{grow:!1,key:i},r.a.createElement(l.b,{eventId:t,fieldName:l.a,contextId:e,isDraggable:n,value:i})))):null,null!=i?Object(o.uniq)(i).map((i=>r.a.createElement(a.EuiFlexItem,{grow:!1,key:i},r.a.createElement(s.a,{eventId:t,certificateType:"client",contextId:e,fieldName:s.b,isDraggable:n,value:i})))):null,null!=u?Object(o.uniq)(u).map((i=>r.a.createElement(a.EuiFlexItem,{grow:!1,key:i},r.a.createElement(s.a,{eventId:t,certificateType:"server",contextId:e,fieldName:s.c,isDraggable:n,value:i})))):null)));c.displayName="Fingerprints";var u=n(33),d=n.n(u),p=n(85),m=n(88),g=n(359);const f="questionInCircle",b=e=>{if(null==e)return f;switch(`${e}`.toLowerCase()){case p.m.outbound:case p.m.outgoing:return"arrowUp";case p.m.inbound:case p.m.incoming:case p.m.listening:return"arrowDown";case p.m.external:return"globe";case p.m.internal:return"bullseye";case p.m.unknown:default:return f}},y=r.a.memo((({contextId:e,eventId:t,direction:n,isDraggable:a})=>r.a.createElement(m.c,{contextId:e,eventId:t,field:g.c,iconType:b(n),isDraggable:a,value:n,isAggregatable:!0,fieldType:"keyword"})));y.displayName="DirectionBadge";var h=n(640),v=n(257);const E=d()(a.EuiFlexItem).withConfig({displayName:"EuiFlexItemMarginRight",componentId:"sc-cu0yeq-0"})(["margin-right:3px;"]);E.displayName="EuiFlexItemMarginRight";const x=d()(a.EuiText).withConfig({displayName:"Stats",componentId:"sc-cu0yeq-1"})(["margin:0 5px;"]);x.displayName="Stats";const k=r.a.memo((({bytes:e,communityId:t,contextId:n,direction:i,eventId:s,isDraggable:l,packets:c,protocol:u,transport:d})=>r.a.createElement(a.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none"},null!=i?Object(o.uniq)(i).map((e=>r.a.createElement(E,{grow:!1,key:e},r.a.createElement(y,{contextId:n,direction:e,eventId:s,isDraggable:l})))):null,null!=u?Object(o.uniq)(u).map((e=>r.a.createElement(E,{grow:!1,key:e},r.a.createElement(m.c,{contextId:n,eventId:s,field:g.e,isDraggable:l,value:e,isAggregatable:!0,fieldType:"keyword"})))):null,null!=e?Object(o.uniq)(e).map((e=>isNaN(Number(e))?null:r.a.createElement(E,{grow:!1,key:e},r.a.createElement(m.b,{field:g.a,id:`network-default-draggable-${n}-${s}-${g.a}-${e}`,isDraggable:l,value:e},r.a.createElement(x,{size:"xs"},r.a.createElement("span",null,r.a.createElement(v.a,{value:e}))))))):null,null!=c?Object(o.uniq)(c).map((e=>r.a.createElement(E,{grow:!1,key:e},r.a.createElement(m.b,{field:g.d,id:`network-default-draggable-${n}-${s}-${g.d}-${e}`,isDraggable:l,value:e},r.a.createElement(x,{size:"xs"},r.a.createElement("span",null,`${e} ${h.a}`)))))):null,null!=d?Object(o.uniq)(d).map((e=>r.a.createElement(E,{grow:!1,key:e},r.a.createElement(m.c,{contextId:n,"data-test-subj":"network-transport",eventId:s,field:g.f,isDraggable:l,value:e,isAggregatable:!0,fieldType:"keyword"})))):null,null!=t?Object(o.uniq)(t).map((e=>r.a.createElement(a.EuiFlexItem,{grow:!1,key:e},r.a.createElement(m.c,{contextId:n,eventId:s,field:g.b,isDraggable:l,value:e,isAggregatable:!0,fieldType:"keyword"})))):null)));k.displayName="Network";var S=n(423),w=n(92),j=n.n(w),O=n(306),I=n(470),T=n(258),C=n(260),M=n(474);const N=d.a.span.withConfig({displayName:"IpPortSeparator",componentId:"sc-1a6zx74-0"})(["margin:0 3px;"]);N.displayName="IpPortSeparator";const D=r.a.memo((({contextId:e,eventId:t,isDraggable:n,port:i,portFieldName:o})=>null!=i?r.a.createElement(a.EuiFlexGroup,{gutterSize:"none"},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(N,{"data-test-subj":"ip-port-separator"},":")),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(I.a,{contextId:e,"data-test-subj":"port",eventId:t,fieldName:o,isDraggable:n,value:i}))):null));D.displayName="PortWithSeparator";const F=r.a.memo((({contextId:e,eventId:t,ip:n,ipFieldName:i,isDraggable:o,port:s,portFieldName:l})=>r.a.createElement(a.EuiFlexGroup,{gutterSize:"none"},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(O.c,{contextId:e,"data-test-subj":"ip",eventId:t,fieldName:i,isDraggable:o,value:n})),r.a.createElement(a.EuiFlexItem,null,r.a.createElement(D,{contextId:e,eventId:t,isDraggable:o,port:s,portFieldName:l})))));F.displayName="IpWithPort";const A=d.a.div.withConfig({displayName:"Label",componentId:"sc-1jislg4-0"})(["font-weight:bold;margin-top:2px;"]),_=({destinationIp:e,sourceIp:t,type:n})=>"source"===n&&null!=t&&t.some((e=>!Object(o.isEmpty)(e)))||"destination"===n&&null!=e&&e.some((e=>!Object(o.isEmpty)(e))),R=({destinationPort:e,sourcePort:t,type:n})=>("source"===n&&null!=t?t:"destination"===n&&null!=e?e:[]).filter((e=>null!=e)).map((e=>`${e}`)).filter((e=>!Object(o.isEmpty)(e))),P=r.a.memo((({contextId:e,destinationIp:t,destinationPort:n,eventId:i,isDraggable:s,sourceIp:l,sourcePort:c,type:u})=>{const d="source"===u?l:t,p="source"===u?O.d:O.a,m="source"===u?c:n,g="source"===u?T.c:T.a;if(null==d)return null;const f=null!=m&&d.length===m.length?d.map(((e,t)=>({ip:e,port:null!=m[t]?`${m[t]}`:null}))):d.map((e=>({ip:e,port:null})));return r.a.createElement(a.EuiFlexGroup,{gutterSize:"none"},Object(o.uniqWith)(j.a,f).map((t=>null!=t.ip&&r.a.createElement(a.EuiFlexItem,{grow:!1,key:t.ip},r.a.createElement(F,{contextId:e,"data-test-subj":`${u}-ip-and-port`,eventId:i,ip:t.ip,ipFieldName:p,isDraggable:s,port:t.port,portFieldName:g})))))}));P.displayName="IpAdressesWithPorts";const L=r.a.memo((({contextId:e,destinationGeoContinentName:t,destinationGeoCountryName:n,destinationGeoCountryIsoCode:i,destinationGeoRegionName:o,destinationGeoCityName:s,destinationIp:l,destinationPort:c,eventId:u,isDraggable:d,sourceGeoContinentName:p,sourceGeoCountryName:m,sourceGeoCountryIsoCode:g,sourceGeoRegionName:f,sourceGeoCityName:b,sourceIp:y,sourcePort:h,type:v})=>{const E="source"===v?C.g:C.a;return _({destinationIp:l,sourceIp:y,type:v})||(({destinationPort:e,sourcePort:t,type:n})=>R({destinationPort:e,sourcePort:t,type:n}).length>0)({destinationPort:c,sourcePort:h,type:v})?r.a.createElement(a.EuiBadge,{"data-test-subj":`${v}-ip-badge`,color:"hollow",title:""},r.a.createElement(a.EuiFlexGroup,{alignItems:"center","data-test-subj":`${v}-ip-group`,direction:"column",gutterSize:"xs"},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(A,null,E)),r.a.createElement(a.EuiFlexItem,{grow:!1},_({destinationIp:l,sourceIp:y,type:v})?r.a.createElement(P,{contextId:e,destinationIp:l,destinationPort:c,eventId:u,isDraggable:d,sourceIp:y,sourcePort:h,type:v}):r.a.createElement(a.EuiFlexGroup,{gutterSize:"none"},R({destinationPort:c,sourcePort:h,type:v}).map(((t,n)=>r.a.createElement(a.EuiFlexItem,{key:`port-${t}-${n}`,grow:!1},r.a.createElement(I.a,{contextId:e,"data-test-subj":"port",eventId:u,fieldName:`${v}.port`,isDraggable:d,value:t})))))),r.a.createElement(a.EuiFlexItem,null,r.a.createElement(M.f,{contextId:e,destinationGeoContinentName:t,destinationGeoCountryName:n,destinationGeoCountryIsoCode:i,destinationGeoRegionName:o,destinationGeoCityName:s,eventId:u,isDraggable:d,sourceGeoContinentName:p,sourceGeoCountryName:m,sourceGeoCountryIsoCode:g,sourceGeoRegionName:f,sourceGeoCityName:b,type:v})))):null}));L.displayName="SourceDestinationIp";const q=r.a.memo((({contextId:e,destinationBytes:t,destinationGeoContinentName:n,destinationGeoCountryName:i,destinationGeoCountryIsoCode:o,destinationGeoRegionName:s,destinationGeoCityName:l,destinationIp:c,destinationPackets:u,destinationPort:d,eventId:p,isDraggable:m,sourceBytes:g,sourceGeoContinentName:f,sourceGeoCountryName:b,sourceGeoCountryIsoCode:y,sourceGeoRegionName:h,sourceGeoCityName:v,sourcePackets:E,sourceIp:x,sourcePort:k})=>r.a.createElement(a.EuiFlexGroup,{justifyContent:"center",gutterSize:"none"},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(L,{contextId:e,destinationGeoContinentName:n,destinationGeoCountryName:i,destinationGeoCountryIsoCode:o,destinationGeoRegionName:s,destinationGeoCityName:l,destinationIp:c,destinationPort:d,eventId:p,isDraggable:m,sourceGeoContinentName:f,sourceGeoCountryName:b,sourceGeoCountryIsoCode:y,sourceGeoRegionName:h,sourceGeoCityName:v,sourceIp:x,sourcePort:k,type:"source"})),r.a.createElement(S.e,{contextId:e,destinationBytes:t,destinationPackets:u,eventId:p,isDraggable:m,sourceBytes:g,sourcePackets:E}),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(L,{contextId:e,destinationGeoContinentName:n,destinationGeoCountryName:i,destinationGeoCountryIsoCode:o,destinationGeoRegionName:s,destinationGeoCityName:l,destinationIp:c,destinationPort:d,eventId:p,isDraggable:m,sourceGeoContinentName:f,sourceGeoCountryName:b,sourceGeoCountryIsoCode:y,sourceGeoRegionName:h,sourceGeoCityName:v,sourceIp:x,sourcePort:k,type:"destination"})))));q.displayName="SourceDestinationWithArrows";const B=d()(a.EuiFlexItem).withConfig({displayName:"EuiFlexItemMarginTop",componentId:"sc-loapjb-0"})(["margin-top:3px;"]);B.displayName="EuiFlexItemMarginTop";const z=r.a.memo((({contextId:e,destinationBytes:t,destinationGeoContinentName:n,destinationGeoCountryName:i,destinationGeoCountryIsoCode:o,destinationGeoRegionName:s,destinationGeoCityName:l,destinationIp:c,destinationPackets:u,destinationPort:d,eventId:p,isDraggable:m,networkBytes:g,networkCommunityId:f,networkDirection:b,networkPackets:y,networkProtocol:h,sourceBytes:v,sourceGeoContinentName:E,sourceGeoCountryName:x,sourceGeoCountryIsoCode:S,sourceGeoRegionName:w,sourceGeoCityName:j,sourceIp:O,sourcePackets:I,sourcePort:T,transport:C})=>r.a.createElement(a.EuiFlexGroup,{alignItems:"center",direction:"column",justifyContent:"center",gutterSize:"none"},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(k,{bytes:g,packets:y,communityId:f,contextId:e,direction:b,eventId:p,isDraggable:m,protocol:h,transport:C})),r.a.createElement(B,{grow:!1},r.a.createElement(q,{contextId:e,destinationBytes:t,destinationGeoContinentName:n,destinationGeoCountryName:i,destinationGeoCountryIsoCode:o,destinationGeoRegionName:s,destinationGeoCityName:l,destinationIp:c,destinationPackets:u,destinationPort:d,eventId:p,isDraggable:m,sourceBytes:v,sourceGeoContinentName:E,sourceGeoCountryName:x,sourceGeoCountryIsoCode:S,sourceGeoRegionName:w,sourceGeoCityName:j,sourceIp:O,sourcePackets:I,sourcePort:T})))));z.displayName="SourceDestination";var $=n(476),V=n(643);const U=d()(a.EuiFlexItem).withConfig({displayName:"EuiFlexItemMarginRight",componentId:"sc-19k371j-0"})(["margin-right:10px;"]);U.displayName="EuiFlexItemMarginRight";const H=r.a.memo((({contextId:e,destinationBytes:t,destinationGeoContinentName:n,destinationGeoCountryName:i,destinationGeoCountryIsoCode:o,destinationGeoRegionName:s,destinationGeoCityName:l,destinationIp:c,destinationPackets:u,destinationPort:d,eventDuration:p,eventId:m,eventEnd:g,eventStart:f,isDraggable:b,networkBytes:y,networkCommunityId:h,networkDirection:v,networkPackets:E,networkProtocol:x,processName:k,sourceBytes:S,sourceGeoContinentName:w,sourceGeoCountryName:j,sourceGeoCountryIsoCode:O,sourceGeoRegionName:I,sourceGeoCityName:T,sourceIp:C,sourcePackets:M,sourcePort:N,transport:D,userName:F})=>r.a.createElement(a.EuiFlexGroup,{"data-test-subj":"netflow-columns",gutterSize:"none",justifyContent:"center",wrap:!0},r.a.createElement(U,{grow:!1},r.a.createElement(V.c,{contextId:e,eventId:m,isDraggable:b,processName:k,userName:F})),r.a.createElement(U,{grow:!1},r.a.createElement($.a,{contextId:e,eventDuration:p,eventId:m,eventEnd:g,eventStart:f,isDraggable:b})),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(z,{contextId:e,destinationBytes:t,destinationGeoContinentName:n,destinationGeoCountryName:i,destinationGeoCountryIsoCode:o,destinationGeoRegionName:s,destinationGeoCityName:l,destinationIp:c,destinationPackets:u,destinationPort:d,eventId:m,isDraggable:b,networkBytes:y,networkCommunityId:h,networkDirection:v,networkPackets:E,networkProtocol:x,sourceBytes:S,sourceGeoContinentName:w,sourceGeoCountryName:j,sourceGeoCountryIsoCode:O,sourceGeoRegionName:I,sourceGeoCityName:T,sourceIp:C,sourcePackets:M,sourcePort:N,transport:D})))));H.displayName="NetflowColumns";const G=r.a.memo((({contextId:e,destinationBytes:t,destinationGeoContinentName:n,destinationGeoCountryName:i,destinationGeoCountryIsoCode:o,destinationGeoRegionName:s,destinationGeoCityName:l,destinationIp:u,destinationPackets:d,destinationPort:p,eventDuration:m,eventId:g,eventEnd:f,eventStart:b,isDraggable:y,networkBytes:h,networkCommunityId:v,networkDirection:E,networkPackets:x,networkProtocol:k,processName:S,sourceBytes:w,sourceGeoContinentName:j,sourceGeoCountryName:O,sourceGeoCountryIsoCode:I,sourceGeoRegionName:T,sourceGeoCityName:C,sourcePackets:M,sourceIp:N,sourcePort:D,tlsClientCertificateFingerprintSha1:F,tlsFingerprintsJa3Hash:A,tlsServerCertificateFingerprintSha1:_,transport:R,userName:P})=>r.a.createElement(a.EuiFlexGroup,{alignItems:"center","data-test-subj":"netflow-rows",direction:"column",justifyContent:"center",wrap:!0,gutterSize:"none"},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(H,{contextId:e,destinationBytes:t,destinationGeoContinentName:n,destinationGeoCountryName:i,destinationGeoCountryIsoCode:o,destinationGeoRegionName:s,destinationGeoCityName:l,destinationIp:u,destinationPackets:d,destinationPort:p,eventDuration:m,eventId:g,eventEnd:f,eventStart:b,isDraggable:y,networkBytes:h,networkCommunityId:v,networkDirection:E,networkPackets:x,networkProtocol:k,processName:S,sourceBytes:w,sourceGeoContinentName:j,sourceGeoCountryName:O,sourceGeoCountryIsoCode:I,sourceGeoRegionName:T,sourceGeoCityName:C,sourceIp:N,sourcePackets:M,sourcePort:D,transport:R,userName:P})),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(c,{contextId:e,eventId:g,isDraggable:y,tlsClientCertificateFingerprintSha1:F,tlsFingerprintsJa3Hash:A,tlsServerCertificateFingerprintSha1:_})))));G.displayName="Netflow"},function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var a=n(4),i=n.n(a),r=n(38),o=n(237),s=n(264),l=n(78),c=n(104),u=n(106),d=n(102),p=n(12),m=n(34),g=n(196);const f=e=>Object(m.isObject)(e)?JSON.stringify(e):e;var b=n(99);const y=[({data:e,pageSize:t,closeCellPopover:n})=>e&&e.length>0?function({rowIndex:l,columnId:c,Component:u}){const{timelines:d,filterManager:p}=Object(s.d)(),m=Object(r.getPageRowIndex)(l,t),g=Object(a.useMemo)((()=>({data:e[m],fieldName:c})),[m,c]),f=Object(o.c)(g),b=Object(a.useMemo)((()=>d.getHoverActions().getFilterForValueButton),[d]),y=Object(a.useMemo)((()=>({Component:u,field:c,filterManager:p,onFilterAdded:s.c,ownFocus:!1,showTooltip:!1,value:f,onClick:n})),[u,c,p,f]);return m>=e.length?i.a.createElement(i.a.Fragment,null,s.a):i.a.createElement(i.a.Fragment,null,b(y))}:s.a,({data:e,pageSize:t,closeCellPopover:n})=>e&&e.length>0?function({rowIndex:l,columnId:c,Component:u}){const{timelines:d,filterManager:p}=Object(s.d)(),m=Object(r.getPageRowIndex)(l,t),g=Object(a.useMemo)((()=>({data:e[m],fieldName:c})),[m,c]),f=Object(o.c)(g),b=Object(a.useMemo)((()=>d.getHoverActions().getFilterOutValueButton),[d]),y=Object(a.useMemo)((()=>({Component:u,field:c,filterManager:p,onFilterAdded:s.c,ownFocus:!1,showTooltip:!1,value:f,onClick:n})),[u,c,p,f]);return m>=e.length?i.a.createElement(i.a.Fragment,null,s.a):i.a.createElement(i.a.Fragment,null,b(y))}:s.a,({data:e,pageSize:t,closeCellPopover:n})=>e&&e.length>0?function({rowIndex:m,columnId:g,Component:f}){const b=Object(l.useDispatch)(),{timelines:y}=Object(s.d)(),h=Object(r.getPageRowIndex)(m,t),v=Object(a.useMemo)((()=>({data:e[h],fieldName:g})),[h,g]),E=Object(o.c)(v),x=Object(a.useMemo)((()=>y.getHoverActions().getAddToTimelineButton),[y]),k=Object(a.useMemo)((()=>{const e=`${Object(d.h)(g)}-row-${m}-col-${g}`;return E?E.map((t=>({and:[],enabled:!0,excluded:!1,kqlQuery:"",id:`${e}-val-${t}`,name:t,queryMatch:{field:g,value:t,operator:u.d}}))):[{and:[],enabled:!0,kqlQuery:"",id:`${e}`,name:"",excluded:!0,queryMatch:{field:g,value:"",operator:u.b}}]}),[g,m,E]),S=Object(a.useCallback)((()=>{b(Object(p.addProvider)({id:c.d.active,providers:k})),n&&n()}),[k,b]),w=Object(a.useMemo)((()=>({Component:f,dataProvider:k,field:g,ownFocus:!1,showTooltip:!1,onClick:S,timelineType:"default"})),[f,g,k,S]);return h>=e.length?i.a.createElement(i.a.Fragment,null,s.a):i.a.createElement(i.a.Fragment,null,x(w))}:s.a,({data:e,pageSize:t,closeCellPopover:n})=>e&&e.length>0?function({rowIndex:l,columnId:c,Component:u}){const{timelines:d}=Object(s.d)(),p=Object(r.getPageRowIndex)(l,t),m=Object(a.useMemo)((()=>d.getHoverActions().getCopyButton),[d]),g=Object(a.useMemo)((()=>({data:e[p],fieldName:c})),[p,c]),f=Object(o.c)(g),b=Object(a.useMemo)((()=>({Component:u,field:c,isHoverAction:!1,ownFocus:!1,showTooltip:!1,value:f,onClick:n})),[u,c,f]);return p>=e.length?i.a.createElement(i.a.Fragment,null,s.a):i.a.createElement(i.a.Fragment,null,m(b))}:s.a,({data:e,ecsData:t,header:n,scopeId:l,pageSize:c,closeCellPopover:u})=>void 0!==n?function({rowIndex:d,columnId:p,Component:y}){var h;const{pageRowIndex:v,link:E,eventId:x,value:k,values:S,title:w,fieldName:j,fieldFormat:O,fieldType:I,linkValue:T}=(({rowIndex:e,pageSize:t,ecsData:n,columnId:i,header:l,data:c})=>{const u=Object(r.getPageRowIndex)(e,t),d=n[u],p=Object(s.b)(i,null==l?void 0:l.type,null==l?void 0:l.linkField),g=null!=l&&l.linkField?null==l?void 0:l.linkField:null==p?void 0:p.linkField,y=l&&Object(m.getOr)([],null!=g?g:"",d),h=l&&Object(m.get)("_id",d)||"",v=Object(a.useMemo)((()=>({data:c[u],fieldName:i})),[u,i,c]),E=Object(o.c)(v),x=f(Object(m.head)(E)),k=E&&E.length>1?`${null==p?void 0:p.label}: ${x}`:null==p?void 0:p.label;if(void 0!==g&&0===y.length&&void 0!==E){const e=Object(b.getField)(d,g),t=Object(b.getFieldKey)(d,g),n=Object(b.getFieldKey)(d,i),a=Object(s.b)(n,null==l?void 0:l.type,t);return{pageRowIndex:u,link:a,eventId:h,fieldFormat:(null==l?void 0:l.format)||"",fieldName:n,fieldType:(null==l?void 0:l.type)||"",value:f(Object(m.head)(n)),values:E,title:k,linkValue:Object(m.head)(e)}}return{pageRowIndex:u,link:p,eventId:h,fieldFormat:(null==l?void 0:l.format)||"",fieldName:i,fieldType:(null==l?void 0:l.type)||"",value:x,values:E,title:k,linkValue:Object(m.head)(y)}})({rowIndex:d,pageSize:c,ecsData:t,columnId:p,header:n,data:e});return!1===Object(a.useMemo)((()=>{const t=void 0!==E&&S&&!Object(m.isEmpty)(k);return v>=e.length||!0!==t}),[E,v,k,S])?i.a.createElement(g.a,{Component:y,contextId:`expanded-value-${p}-row-${v}-${l}`,eventId:x,fieldFormat:O,isAggregatable:null!==(h=n.aggregatable)&&void 0!==h&&h,fieldName:j,fieldType:I,isButton:!0,isDraggable:!1,value:k,truncate:!1,title:w,linkValue:T,onClick:u}):s.a}:s.a]},function(e,t,n){"use strict";n.d(t,"d",(function(){return $})),n.d(t,"b",(function(){return V})),n.d(t,"j",(function(){return U})),n.d(t,"m",(function(){return H})),n.d(t,"i",(function(){return G})),n.d(t,"h",(function(){return W})),n.d(t,"f",(function(){return K})),n.d(t,"n",(function(){return J})),n.d(t,"c",(function(){return X})),n.d(t,"g",(function(){return Z})),n.d(t,"l",(function(){return ee})),n.d(t,"k",(function(){return te})),n.d(t,"e",(function(){return ae})),n.d(t,"a",(function(){return ie}));var a,i,r=n(32),o=n(135),s=n(945),l=n.n(s),c=n(946),u=n.n(c),d=n(6),p=n.n(d);!function(e){e._ID="_id",e._INDEX="_index",e._SOURCE="_source",e._TYPE="_type",e.STRING="string",e.TEXT="text",e.MATCH_ONLY_TEXT="match_only_text",e.KEYWORD="keyword",e.VERSION="version",e.BOOLEAN="boolean",e.OBJECT="object",e.DATE="date",e.DATE_NANOS="date_nanos",e.DATE_RANGE="date_range",e.GEO_POINT="geo_point",e.GEO_SHAPE="geo_shape",e.FLOAT="float",e.HALF_FLOAT="half_float",e.SCALED_FLOAT="scaled_float",e.DOUBLE="double",e.INTEGER="integer",e.LONG="long",e.SHORT="short",e.UNSIGNED_LONG="unsigned_long",e.AGGREGATE_METRIC_DOUBLE="aggregate_metric_double",e.FLOAT_RANGE="float_range",e.DOUBLE_RANGE="double_range",e.INTEGER_RANGE="integer_range",e.LONG_RANGE="long_range",e.NESTED="nested",e.BYTE="byte",e.IP="ip",e.IP_RANGE="ip_range",e.ATTACHMENT="attachment",e.TOKEN_COUNT="token_count",e.MURMUR3="murmur3",e.HISTOGRAM="histogram"}(a||(a={})),function(e){e._SOURCE="_source",e.ATTACHMENT="attachment",e.BOOLEAN="boolean",e.DATE="date",e.DATE_RANGE="date_range",e.GEO_POINT="geo_point",e.GEO_SHAPE="geo_shape",e.IP="ip",e.IP_RANGE="ip_range",e.MURMUR3="murmur3",e.NUMBER="number",e.NUMBER_RANGE="number_range",e.STRING="string",e.UNKNOWN="unknown",e.CONFLICT="conflict",e.OBJECT="object",e.NESTED="nested",e.HISTOGRAM="histogram",e.MISSING="missing"}(i||(i={}));var m=l()((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};u()(this,e),p()(this,"name",void 0),p()(this,"sortable",void 0),p()(this,"filterable",void 0),p()(this,"esTypes",void 0),this.name=t.name||i.UNKNOWN,this.sortable=t.sortable||!1,this.filterable=t.filterable||!1,this.esTypes=Object.freeze((t.esTypes||[]).slice())})),g=new m({name:i.UNKNOWN}),f=[new m({name:i.STRING,sortable:!0,filterable:!0,esTypes:[a.STRING,a.TEXT,a.MATCH_ONLY_TEXT,a.KEYWORD,a.VERSION,a._TYPE,a._ID]}),new m({name:i.NUMBER,sortable:!0,filterable:!0,esTypes:[a.FLOAT,a.HALF_FLOAT,a.SCALED_FLOAT,a.DOUBLE,a.INTEGER,a.LONG,a.UNSIGNED_LONG,a.SHORT,a.BYTE,a.TOKEN_COUNT,a.AGGREGATE_METRIC_DOUBLE]}),new m({name:i.NUMBER_RANGE,sortable:!0,filterable:!0,esTypes:[a.FLOAT_RANGE,a.DOUBLE_RANGE,a.INTEGER_RANGE,a.LONG_RANGE]}),new m({name:i.DATE,sortable:!0,filterable:!0,esTypes:[a.DATE,a.DATE_NANOS]}),new m({name:i.DATE_RANGE,sortable:!0,filterable:!0,esTypes:[a.DATE_RANGE]}),new m({name:i.IP,sortable:!0,filterable:!0,esTypes:[a.IP]}),new m({name:i.IP_RANGE,sortable:!0,filterable:!0,esTypes:[a.IP_RANGE]}),new m({name:i.BOOLEAN,sortable:!0,filterable:!0,esTypes:[a.BOOLEAN]}),new m({name:i.OBJECT,esTypes:[a.OBJECT]}),new m({name:i.NESTED,esTypes:[a.NESTED]}),new m({name:i.GEO_POINT,esTypes:[a.GEO_POINT]}),new m({name:i.GEO_SHAPE,esTypes:[a.GEO_SHAPE]}),new m({name:i.ATTACHMENT,esTypes:[a.ATTACHMENT]}),new m({name:i.MURMUR3,esTypes:[a.MURMUR3]}),new m({name:i._SOURCE,esTypes:[a._SOURCE]}),new m({name:i.HISTOGRAM,filterable:!0,esTypes:[a.HISTOGRAM]}),new m({name:i.CONFLICT}),g],b=n(34),y=n(4),h=n.n(y),v=n(33),E=n.n(v),x=n(703),k=n(48),S=n(60),w=n(468),j=n(174),O=n(631),I=n(632),T=n(244),C=n(469),M=n(390),N=n(87),D=n(952),F=n.n(D);const A=E()(r.EuiFlexGroup).withConfig({displayName:"ThreatEuiFlexGroupStyles",componentId:"sc-1kubah9-0"})([".euiFlexItem{margin-bottom:0px;}"]),_=E()(r.EuiFlexItem).withConfig({displayName:"SubtechniqueFlexItem",componentId:"sc-1kubah9-1"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeM)),R=E()(r.EuiButtonEmpty).withConfig({displayName:"TechniqueLinkItem",componentId:"sc-1kubah9-2"})([".euiIcon{width:8px;height:8px;}align-self:flex-start;"]),P=({label:e,threat:t})=>{const[a,i]=Object(y.useState)([]),[o,s]=Object(y.useState)([]),[l,c]=Object(y.useState)([]);return Object(y.useEffect)((()=>{!async function(){const e=await n.e(14).then(n.bind(null,1284));c(e.subtechniquesOptions),i(e.techniquesOptions),s(e.tacticsOptions)}()}),[]),h.a.createElement(A,{direction:"column"},t.map(((e,t)=>{const n=o.find((t=>t.id===e.tactic.id));return h.a.createElement(r.EuiFlexItem,{key:`${e.tactic.name}-${t}`},h.a.createElement(r.EuiLink,{"data-test-subj":"threatTacticLink",href:e.tactic.reference,target:"_blank"},null!=n?n.text:`${e.tactic.name} (${e.tactic.id})`),h.a.createElement(r.EuiFlexGroup,{gutterSize:"none",alignItems:"flexStart",direction:"column"},e.technique&&e.technique.map(((e,t)=>{var n;const i=a.find((t=>t.id===e.id));return h.a.createElement(r.EuiFlexItem,{key:null!==(n=null==i?void 0:i.id)&&void 0!==n?n:t},h.a.createElement(R,{"data-test-subj":"threatTechniqueLink",href:e.reference,target:"_blank",iconType:F.a,size:"xs"},null!=i?i.label:`${e.name} (${e.id})`),h.a.createElement(r.EuiFlexGroup,{gutterSize:"none",alignItems:"flexStart",direction:"column"},null!=e.subtechnique&&e.subtechnique.map(((e,t)=>{var n;const a=l.find((t=>t.id===e.id));return h.a.createElement(_,{key:null!==(n=null==a?void 0:a.id)&&void 0!==n?n:t},h.a.createElement(R,{"data-test-subj":"threatSubtechniqueLink",href:e.reference,target:"_blank",iconType:F.a,size:"xs"},null!=a?a.label:`${e.name} (${e.id})`))}))))}))))})),h.a.createElement(r.EuiSpacer,null))},L=E()(r.EuiFlexItem).withConfig({displayName:"NoteDescriptionContainer",componentId:"sc-123zi2b-0"})(["height:105px;overflow-y:hidden;"]),q=e=>!Object(b.isEmpty)(e.join("")),B=E()(r.EuiBadge).withConfig({displayName:"EuiBadgeWrap",componentId:"sc-123zi2b-1"})([".euiBadge__text{white-space:pre-wrap !important;}"]),z=E.a.div.withConfig({displayName:"Query",componentId:"sc-123zi2b-2"})(["white-space:pre-wrap;"]),$=({field:e,filters:t,filterManager:n,query:a,savedId:i,savedQueryName:o,indexPatterns:s,queryLabel:l})=>{let c=[];const u=!Object(b.isEmpty)(i)&&!Object(b.isEmpty)(o);return u&&(c=[...c,{title:h.a.createElement(h.a.Fragment,null,C.r," "),description:h.a.createElement(h.a.Fragment,null,o," ")}]),Object(b.isEmpty)(t)||(n.setFilters(t),c=[...c,{title:h.a.createElement(h.a.Fragment,null,u?C.p:C.g," "),description:h.a.createElement(r.EuiFlexGroup,{wrap:!0,responsive:!1,gutterSize:"xs"},n.getFilters().map(((t,n)=>h.a.createElement(r.EuiFlexItem,{grow:!1,key:`${e}-filter-${n}`},h.a.createElement(B,{color:"hollow"},null!=s?h.a.createElement(S.FilterLabel,{filter:t,valueLabel:Object(k.getDisplayValueFromFilter)(t,[s])}):h.a.createElement(r.EuiLoadingSpinner,{size:"m"}))))))}]),Object(b.isEmpty)(a)||(c=[...c,{title:h.a.createElement(h.a.Fragment,null,u?C.q:null!=l?l:C.n),description:h.a.createElement(z,null,a)}]),c},V=e=>{let t=[];return Object(b.isEmpty)(e.eventCategoryField)||(t=[...t,{title:h.a.createElement(h.a.Fragment,null,C.c),description:h.a.createElement(h.a.Fragment,null,e.eventCategoryField)}]),Object(b.isEmpty)(e.tiebreakerField)||(t=[...t,{title:h.a.createElement(h.a.Fragment,null,C.d),description:h.a.createElement(h.a.Fragment,null,e.tiebreakerField)}]),Object(b.isEmpty)(e.timestampField)||(t=[...t,{title:h.a.createElement(h.a.Fragment,null,C.e),description:h.a.createElement(h.a.Fragment,null,e.timestampField)}]),t},U=({label:e,threat:t})=>t.length>0?[{title:e,description:h.a.createElement(P,{label:e,threat:t})}]:[],H=(e,t,n)=>q(n)?[{title:e,description:h.a.createElement(r.EuiText,{size:"s"},h.a.createElement("ul",null,n.map((e=>Object(b.isEmpty)(e)?null:h.a.createElement("li",{"data-test-subj":"unorderedListArrayDescriptionItem",key:`${t}-${e}`},e)))))}]:[],G=(e,t,n)=>q(n)?[{title:e,description:h.a.createElement(r.EuiFlexGroup,{responsive:!1,gutterSize:"xs",wrap:!0},n.map((e=>Object(b.isEmpty)(e)?null:h.a.createElement(r.EuiFlexItem,{grow:!1,key:`${t}-${e}`},h.a.createElement(B,{"data-test-subj":"stringArrayDescriptionBadgeItem",color:"hollow"},e)))))}]:[],Q=E()(r.EuiFlexItem).withConfig({displayName:"OverrideColumn",componentId:"sc-123zi2b-3"})(["width:125px;max-width:125px;overflow:hidden;text-overflow:ellipsis;"]),W=e=>[{title:O.a,description:h.a.createElement(M.a,{value:e.value})},...e.isMappingChecked?e.mapping.filter((e=>""!==e.field)).map(((e,t)=>({title:0===t?O.d:"",description:h.a.createElement(r.EuiFlexGroup,{alignItems:"center"},h.a.createElement(Q,null,h.a.createElement(r.EuiToolTip,{content:e.field,"data-test-subj":`severityOverrideField${t}`},h.a.createElement(h.a.Fragment,null,`${e.field}:`))),h.a.createElement(Q,null,h.a.createElement(r.EuiToolTip,{content:e.value,"data-test-subj":`severityOverrideValue${t}`},Object(N.a)(e.value))),h.a.createElement(r.EuiFlexItem,{grow:!1},h.a.createElement(r.EuiIcon,{type:"sortRight"})),h.a.createElement(r.EuiFlexItem,null,h.a.createElement(M.a,{"data-test-subj":`severityOverrideSeverity${t}`,value:e.severity})))}))):[]],K=e=>[{title:I.b,description:e.value},...e.isMappingChecked?e.mapping.filter((e=>""!==e.field)).map(((e,t)=>({title:0===t?I.e:"",description:h.a.createElement(r.EuiFlexGroup,{alignItems:"center"},h.a.createElement(Q,null,h.a.createElement(r.EuiToolTip,{content:e.field,"data-test-subj":`riskScoreOverrideField${t}`},h.a.createElement(h.a.Fragment,null,e.field))),h.a.createElement(r.EuiFlexItem,{grow:!1},h.a.createElement(r.EuiIcon,{type:"sortRight"})),h.a.createElement(r.EuiFlexItem,null,o.k))}))):[]],Y=E()(r.EuiLink).withConfig({displayName:"MyRefUrlLink",componentId:"sc-123zi2b-4"})(["word-break:break-word;"]),J=(e,t)=>q(t)?[{title:e,description:h.a.createElement(r.EuiText,{size:"s"},h.a.createElement("ul",null,t.filter((e=>!Object(b.isEmpty)(e))).map(((e,t)=>h.a.createElement("li",{"data-test-subj":"urlsDescriptionReferenceLinkItem",key:`${t}-${e}`},h.a.createElement(Y,{href:e,external:!0,target:"_blank"},e))))))}]:[],X=(e,t)=>""!==t.trim()?[{title:e,description:h.a.createElement(L,null,h.a.createElement("div",{"data-test-subj":"noteDescriptionItem",className:"eui-yScrollWithShadows"},t))}]:[],Z=(e,t)=>{switch(t){case"machine_learning":return[{title:e,description:C.l}];case"query":case"saved_query":return[{title:e,description:C.o}];case"threshold":return[{title:e,description:C.w}];case"eql":return[{title:e,description:C.f}];case"threat_match":return[{title:e,description:C.s}];case"new_terms":return[{title:e,description:C.m}];default:return Object(j.a)(t)}},ee=(e,t)=>[{title:e,description:h.a.createElement(h.a.Fragment,null,Object(b.isEmpty)(t.field[0])?`${C.v} >= ${t.value}`:`${C.u} ${Array.isArray(t.field)?t.field.join(","):t.field} >= ${t.value}`)}],te=(e,t)=>[{title:e,description:t.reduce(((e,t,n,{length:a})=>{const i=t.entries.reduce(((e,t,n,{length:a})=>1===a?`${t.field} ${w.d} ${t.value}`:0===n?`(${t.field} ${w.d} ${t.value})`:`${e} ${w.a} (${t.field} ${w.d} ${t.value})`),"");return 1===a?`${i}`:0===n?`(${i})`:`${e} ${w.e} (${i})`}),"")}],ne=E()(r.EuiText).withConfig({displayName:"FieldTypeText",componentId:"sc-123zi2b-5"})(["font-size:",";font-family:",";display:inline;"],(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.euiCodeFontFamily)),ae=(e,t)=>Object(b.isEmpty)(t)?[]:[{title:e,description:h.a.createElement(r.EuiFlexGrid,{gutterSize:"s"},t.map(((e,n)=>{return h.a.createElement(r.EuiFlexItem,{grow:!1},h.a.createElement(r.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},h.a.createElement(r.EuiFlexItem,{grow:!1},h.a.createElement(x.a,{"data-test-subj":"field-type-icon",type:(a=e.type,o=f.find((function(e){return e.esTypes.includes(a)})),o&&o.name?o.name:i.UNKNOWN),label:e.type})),h.a.createElement(r.EuiFlexItem,{grow:!1},h.a.createElement(ne,{grow:!1,size:"s"},` ${e.name}${n+1!==t.length?", ":""}`))));var a,o})))}],ie=(e,t,n)=>{if(Object(b.isEmpty)(t))return[];const a=h.a.createElement(r.EuiFlexGroup,{responsive:!1,gutterSize:"xs",wrap:!0},t.map((t=>Object(b.isEmpty)(t)?null:h.a.createElement(r.EuiFlexItem,{grow:!1,key:`${e}-${t}`},h.a.createElement(B,{"data-test-subj":"stringArrayDescriptionBadgeItem",color:"hollow"},t)))));return[{title:h.a.createElement(h.a.Fragment,null,e,h.a.createElement(r.EuiBetaBadge,{label:C.b,style:{verticalAlign:"middle",marginLeft:"8px"},size:"s"}),!n.isAtLeast(T.O)&&h.a.createElement(r.EuiToolTip,{position:"top",content:C.a},h.a.createElement(r.EuiIcon,{type:"alert",size:"l",color:"#BD271E",style:{marginLeft:"8px"}}))),description:a}]}},function(e,t,n){"use strict";n.d(t,"c",(function(){return q})),n.d(t,"a",(function(){return B})),n.d(t,"b",(function(){return z}));var a=n(32),i=n(903),r=n(7),o=n(4),s=n.n(o),l=n(610),c=n(33),u=n.n(c),d=n(0),p=n(35),m=n(77),g=n(82),f=n.n(g);const b=({euiFieldProps:e})=>{const{field:{onChange:t,value:n,name:i},fieldState:{error:r}}=Object(l.useController)({name:"label",defaultValue:""}),c=Object(o.useMemo)((()=>!(null==r||!r.message)),[null==r?void 0:r.message]);return s.a.createElement(a.EuiFormRow,{label:d.i18n.translate("xpack.securitySolution.markdown.osquery.labelFieldText",{defaultMessage:"Label"}),error:null==r?void 0:r.message,isInvalid:c,fullWidth:!0},s.a.createElement(a.EuiFieldText,f()({isInvalid:c,onChange:t,value:n,name:i,fullWidth:!0,"data-test-subj":"input"},e)))},y=s.a.memo(b);var h=n(939),v=n.n(h),E=n(511),x=n(509);const k=d.i18n.translate("xpack.securitySolution.markdown.osquery.permissionDenied",{defaultMessage:"Permission denied"}),S=()=>s.a.createElement(a.EuiEmptyPrompt,{iconType:"logoOsquery",title:s.a.createElement("h2",null,k),titleSize:"xs",body:s.a.createElement("p",null,s.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.missingPrivileges",defaultMessage:"To access this page, ask your administrator for {osquery} Kibana privileges.",values:{osquery:s.a.createElement(a.EuiCode,null,"osquery")}}))}),w=u()(a.EuiButton).withConfig({displayName:"StyledEuiButton",componentId:"sc-105ly5j-0"})(["> span > img{margin-block-end:0;}"]),j=({node:e,onSave:t,onCancel:n})=>{var i,c,u;const g=null!=e,{osquery:f,application:{capabilities:{osquery:b}}}=Object(m.k)().services,h=Object(l.useForm)({defaultValues:{label:null==e||null===(i=e.configuration)||void 0===i?void 0:i.label,query:null==e||null===(c=e.configuration)||void 0===c?void 0:c.query,ecs_mapping:null==e||null===(u=e.configuration)||void 0===u?void 0:u.ecs_mapping}}),v=Object(o.useCallback)((e=>{t(`!{osquery${JSON.stringify(Object(r.pickBy)({query:e.query,label:e.label,ecs_mapping:e.ecs_mapping},(e=>!Object(r.isEmpty)(e))))}}`,{block:!0})}),[t]),E=Object(o.useMemo)((()=>!(b.runSavedQueries&&b.readSavedQueries||b.writeLiveQueries)),[b.readSavedQueries,b.runSavedQueries,b.writeLiveQueries]),x=Object(o.useMemo)((()=>{if(null!=f&&f.LiveQueryField){const{LiveQueryField:e}=f;return s.a.createElement(l.FormProvider,h,s.a.createElement(y,null),s.a.createElement(a.EuiSpacer,{size:"m"}),s.a.createElement(e,{formMethods:h}))}return null}),[h,f]);return E?s.a.createElement(S,null):s.a.createElement(s.a.Fragment,null,s.a.createElement(a.EuiModalHeader,null,s.a.createElement(a.EuiModalHeaderTitle,null,g?s.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.editModalTitle",defaultMessage:"Edit query"}):s.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.addModalTitle",defaultMessage:"Add query"}))),s.a.createElement(a.EuiModalBody,null,s.a.createElement(s.a.Fragment,null,x)),s.a.createElement(a.EuiModalFooter,null,s.a.createElement(a.EuiButtonEmpty,{onClick:n},d.i18n.translate("xpack.securitySolution.markdown.osquery.modalCancelButtonLabel",{defaultMessage:"Cancel"})),s.a.createElement(a.EuiButton,{onClick:h.handleSubmit(v),fill:!0},g?s.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.addModalConfirmButtonLabel",defaultMessage:"Add query"}):s.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.editModalConfirmButtonLabel",defaultMessage:"Save changes"}))))},O=s.a.memo(j),I={name:"osquery",button:{label:"Osquery",iconType:"logoOsquery"},helpText:s.a.createElement("div",null,s.a.createElement(a.EuiCodeBlock,{language:"md",fontSize:"l",paddingSize:"s",isCopyable:!0},"!{osquery{options}}"),s.a.createElement(a.EuiSpacer,{size:"s"})),editor:O};var T=n(84),C=n(42),M=n(79),N=n(146),D=n(520),F=n(94),A=n(95),_=n(50),R=n(106),P=n(301),L=n(381);const{uiPlugins:q,parsingPlugins:B,processingPlugins:z}={uiPlugins:Object(a.getDefaultEuiMarkdownUiPlugins)(),parsingPlugins:Object(a.getDefaultEuiMarkdownParsingPlugins)(),processingPlugins:Object(a.getDefaultEuiMarkdownProcessingPlugins)()};q.push(i.b),q.push(I),B.push((function(){const e=this.Parser,t=e.prototype.inlineTokenizers,n=e.prototype.inlineMethods,a="!{insight",i=function(e,t,n){if(!1===t.startsWith(a))return!1;const i=t[a.length];if("{"!==i&&"}"!==i)return!1;if(n)return!0;let r={};if("{"===i){let n="",i=0;for(let e=a.length;e<t.length;e++){const a=t[e];if("{"===a)i++,n+=a;else if("}"===a){if(i--,-1===i)break;n+=a}else n+=a}try{return r=JSON.parse(n),e(t)({type:"insight",...r,providers:JSON.stringify(r.providers)})}catch(t){const n=e.now();this.file.fail(d.i18n.translate("xpack.securitySolution.markdownEditor.plugins.insightConfigError",{values:{err:t},defaultMessage:"Unable to parse insight JSON configuration: {err}"}),{line:n.line,column:n.column+a.length})}}return!1};i.locator=(e,t)=>e.indexOf(a,t),t.insight=i,n.splice(n.indexOf("text"),0,"insight")})),B.push(i.a),B.push((function(){const e=this.Parser,t=e.prototype.blockTokenizers,n=e.prototype.blockMethods;t.osquery=function(e,t,n){if(!1===t.startsWith("!{osquery"))return!1;const a=t[9];if("{"!==a&&"}"!==a)return!1;if(n)return!0;let i="!{osquery",r={};if("{"===a){let n="",a=0;for(let e=9;e<t.length;e++){const i=t[e];if("{"===i)a++,n+=i;else if("}"===i){if(a--,-1===a)break;n+=i}else n+=i}i+=n;try{r=JSON.parse(n)}catch(t){const n=e.now();this.file.fail(`Unable to parse osquery JSON configuration: ${t}`,{line:n.line,column:n.column+9})}}return i+="}",e(i)({type:"osquery",configuration:r})},n.splice(n.indexOf("text"),0,"osquery")})),z[1][1].components.insight=({label:e,description:t,providers:n})=>{const{addError:i}=Object(T.a)();let r=[];try{void 0!==n&&(r=JSON.parse(n))}catch(e){i(e,{title:d.i18n.translate("xpack.securitySolution.markdownEditor.plugins.insightProviderError",{defaultMessage:"Unable to parse insight provider configuration"})})}const{data:l}=Object(o.useContext)(x.a),c=(({providers:e,alertData:t})=>{function n(e,t){const n=e.find((e=>e.field===t));return null!=n&&n.values?n.values[0]:"*"}return Object(o.useMemo)((()=>t?e.map((e=>e.reduce(((e,a,i)=>{const{field:r,value:o,type:s}=a;if(0===i)return{and:[],enabled:!0,id:JSON.stringify(r+o+s),name:r,excluded:!1,kqlQuery:"",type:_.DataProviderType.default,queryMatch:{field:r,value:"parameter"===s?n(t,o):o,operator:R.d}};{const a={and:[],enabled:!0,id:JSON.stringify(r+o+s),name:r,excluded:!1,kqlQuery:"",type:_.DataProviderType.default,queryMatch:{field:r,value:"parameter"===s?n(t,o):o,operator:R.d}};e.and.push(a)}return e}),{}))):e.map((e=>e.reduce(((e,t,n)=>{const{field:a,value:i,type:r}=t;if(0===n)return{and:[],enabled:!0,id:JSON.stringify(a+i+r),name:a,excluded:!1,kqlQuery:"",type:"parameter"===r?_.DataProviderType.template:_.DataProviderType.default,queryMatch:{field:a,value:"parameter"===r?`{${i}}`:i,operator:R.d}};{const t={and:[],enabled:!0,id:JSON.stringify(a+i+r),name:a,excluded:!1,kqlQuery:"",type:"parameter"===r?_.DataProviderType.template:_.DataProviderType.default,queryMatch:{field:a,value:"parameter"===r?`{${i}}`:i,operator:R.d}};e.and.push(t)}return e}),{})))),[t,e])})({providers:r,alertData:l}),{totalCount:u,isQueryLoading:p,oldestTimestamp:g,hasError:f}=(({dataProviders:e})=>{const{uiSettings:t}=Object(m.k)().services,n=Object(o.useMemo)((()=>Object(C.getEsQueryConfig)(t)),[t]),{browserFields:a,selectedPatterns:i,indexPattern:r,dataViewId:s}=Object(F.d)(A.SourcererScopeName.timeline),[l,c]=Object(o.useState)(!1),u=Object(o.useMemo)((()=>{try{if(!1===l)return Object(N.a)({config:n,dataProviders:e,indexPattern:r,browserFields:a,filters:[],kqlQuery:{query:"",language:"kuery"},kqlMode:"filter"})}catch(e){return c(!0),null}}),[a,e,n,l,r]),[d,{events:p,totalCount:g}]=Object(D.a)({dataViewId:s,fields:["*"],filterQuery:null==u?void 0:u.filterQuery,id:M.j.active,indexNames:i,language:"kuery",limit:1,runtimeMappings:{}}),[f]=p,b=f&&f.data&&f.data.find((e=>"@timestamp"===e.field));return{isQueryLoading:d,totalCount:g,oldestTimestamp:b&&b.value&&b.value[0],hasError:l}})({dataProviders:c}),b=Object(o.useMemo)((()=>{if(null!=g)return{kind:"absolute",from:g,to:(new Date).toISOString()};{const{to:e,from:t,fromStr:n,toStr:a}=Object(L.d)();return{kind:"relative",to:e,from:t,fromStr:n,toStr:a}}}),[g]);return p?s.a.createElement(a.EuiLoadingSpinner,{size:"l"}):s.a.createElement(P.a,{asEmptyButton:!1,isDisabled:f,dataProviders:c,timeRange:b,keepDataView:!0,"data-test-subj":"insight-investigate-in-timeline-button"},s.a.createElement(a.EuiIcon,{type:"timeline"}),` ${e} (${u}) - ${t}`)},z[1][1].components.timeline=i.c,z[1][1].components.osquery=({configuration:e})=>{var t;const[n,a]=Object(o.useState)(!1),{agentId:i,alertId:r}=Object(o.useContext)(x.a),l=Object(o.useCallback)((()=>a(!0)),[a]),c=Object(o.useCallback)((()=>a(!1)),[a]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(w,{iconType:v.a,onClick:l},null!==(t=e.label)&&void 0!==t?t:d.i18n.translate("xpack.securitySolution.markdown.osquery.runOsqueryButtonLabel",{defaultMessage:"Run Osquery"})),n&&s.a.createElement(E.a,{defaultValues:{...r?{alertIds:[r]}:{},query:e.query,ecs_mapping:e.ecs_mapping,queryField:!1},agentId:i,onClose:c}))}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return A}));var a=n(4),i=n.n(a),r=n(78),o=n(32),s=n(325),l=n(119),c=n(171),u=n(288);const d=["source.ip","destination.ip"],p=e=>null!=e&&d.includes(e);var m=n(388);const g=(e,t)=>!!p(e.entityName)&&(null==t||e.entityValue===t);var f=n(187),b=n(181),y=n(533),h=n(89),v=n(229),E=n(847);var x=n(120),k=n(816),S=n(85);const w=(e,t,n)=>e===v.NetworkType.details&&null!=t?n===S.f.source?[{fieldName:"source.ip",fieldValue:t}]:n===S.f.destination?[{fieldName:"destination.ip",fieldValue:t}]:[]:[];var j=n(318),O=n(109),I=n(248),T=n(81),C=n(817),M=n(111),N=n(818);const D={sort:{field:"anomaly.severity",direction:"desc"}},F=({startDate:e,endDate:t,skip:n,ip:d,type:S,flowTarget:F})=>{const A=Object(x.a)(),_=Object(r.useDispatch)(),{toggleStatus:R,setToggleStatus:P}=Object(O.a)(`AnomaliesNetwork-${F}`),[L,q]=Object(a.useState)(n||!R);Object(a.useEffect)((()=>{q(n||!R)}),[n,R]);const B=Object(a.useCallback)((e=>{P(e),q(!e)}),[q,P]),{jobIds:z,loading:$}=Object(I.b)(),V=Object(a.useMemo)((()=>M.e.networkAnomaliesJobIdFilterSelector()),[]),U=Object(T.a)((e=>V(e,S))),H=Object(a.useCallback)((e=>{_(M.b.updateNetworkAnomaliesJobIdFilter({jobIds:e,networkType:S}))}),[_,S]),G=Object(a.useMemo)((()=>M.e.networkAnomaliesIntervalSelector()),[]),Q=Object(T.a)((e=>G(e,S))),W=Object(a.useCallback)((e=>{_(M.b.updateNetworkAnomaliesInterval({interval:e,networkType:S}))}),[_,S]),[K,Y]=Object(s.a)({startDate:e,endDate:t,skip:L,criteriaFields:w(S,d,F),jobIds:U.length>0?U:z,aggregationInterval:Q}),J=((e,t)=>null==e?[]:e.anomalies.reduce(((e,n)=>{if(p(n.entityName)&&g(n,t))return[...e,{ip:n.entityValue,type:n.entityName,anomaly:n}];{const a=((e=[],t)=>{const n=e.find((e=>{const[n,a]=Object(m.a)(e);return!!p(n)&&(null==t||a===t)}));if(null!=n){const[e]=Object(m.a)(n);return p(e)?{ip:Object.values(n)[0],type:e}:{ip:Object.values(n)[0],type:"destination.ip"}}return null})(n.influencers,t);return null!=a?[...e,{ip:a.ip,type:a.type,anomaly:n}]:e}}),[]))(Y,d),X=((e,t,n,a)=>{const r=((e,t,n)=>[{name:u.m,field:"ip",sortable:!0,render:(e,t)=>Object(b.b)({rowItem:e,attrName:t.type,idPrefix:`anomalies-network-table-ip-${Object(y.a)(t.anomaly)}`,render:e=>i.a.createElement(h.h,{ip:e,flowTarget:n}),isAggregatable:!0,fieldType:"ip"})},...Object(E.a)(e,t)])(t,n,a);return e===v.NetworkType.details?r.filter((e=>e.name!==u.m)):r})(S,e,t,F),Z={initialPageIndex:0,initialPageSize:10,totalItemCount:J.length,pageSizeOptions:[5,10,20,50],showPerPageOptions:!0};return Object(c.a)(A)?i.a.createElement(j.a,{loading:K||$},i.a.createElement(l.a,{subtitle:`${u.o}: ${Z.totalItemCount.toLocaleString()} ${u.r(Z.totalItemCount)}`,title:u.a,tooltip:u.q,toggleQuery:B,toggleStatus:R,isInspectDisabled:n,headerFilters:i.a.createElement(o.EuiFlexGroup,null,i.a.createElement(o.EuiFlexItem,null,i.a.createElement(N.a,{interval:Q,onChange:W})),i.a.createElement(o.EuiFlexItem,{grow:!1},i.a.createElement(C.a,{title:u.l,onSelect:H,selectedJobIds:U,jobIds:z})))}),R&&i.a.createElement(k.a,{"data-test-subj":"network-anomalies-table",columns:X,items:J,pagination:Z,sorting:D}),(K||$)&&i.a.createElement(f.a,{"data-test-subj":"anomalies-network-table-loading-panel",overlay:!0,size:"xl"})):null},A=i.a.memo(F)},function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return g}));var a=n(4),i=n.n(a),r=n(68);const o={capabilities:Object(r.getDefaultMlCapabilities)(),isPlatinumOrTrialLicense:!1,mlFeatureEnabledInSpace:!1,upgradeInProgress:!1};var s=n(84),l=n(77),c=n(129);const u=Object(c.d)((async({http:e,signal:t})=>e.fetch("/api/ml/ml_capabilities",{method:"GET",asSystemRequest:!0,signal:t}))),d=n(0).i18n.translate("xpack.securitySolution.components.ml.permissions.errors.machineLearningPermissionsFailureTitle",{defaultMessage:"Machine learning permissions failure"}),p={...o,capabilitiesFetched:!1},m=i.a.createContext(p);m.displayName="MlCapabilitiesContext";const g=i.a.memo((({children:e})=>{const[t,n]=Object(a.useState)(p),r=Object(l.j)(),{addError:o}=Object(s.a)(),{start:g,result:f,error:b}=Object(c.a)(u);return Object(a.useEffect)((()=>{g({http:r})}),[r,g]),Object(a.useEffect)((()=>{f&&n({...f,capabilitiesFetched:!0})}),[f]),Object(a.useEffect)((()=>{b&&o(b,{title:d})}),[o,b]),i.a.createElement(m.Provider,{value:t},e)}));g.displayName="MlCapabilitiesProvider"},function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n(4),i=n.n(a),r=n(34),o=n(1082),s=n(32),l=n(35),c=n(84),u=n(404),d=n(193),p=n(360),m=n(246);const g=i.a.memo((({endpointId:e,hostName:t,casesInfo:n,cancelCallback:r,successCallback:o})=>{const[g,f]=Object(a.useState)(""),[b,y]=Object(a.useState)(!1),h=n.map((e=>e.id)),{loading:v,isolateHost:E}=(({endpointId:e,comment:t,caseIds:n})=>{const[i,r]=Object(a.useState)(!1),{addError:o}=Object(c.a)();return{loading:i,isolateHost:Object(a.useCallback)((async()=>{try{r(!0);const a=await Object(d.b)({endpointId:e,comment:t,caseIds:n});return r(!1),!!a.action}catch(e){return r(!1),o(e.message,{title:u.b}),!1}}),[e,t,n,o])}})({endpointId:e,comment:g,caseIds:h}),x=Object(a.useCallback)((async()=>{const e=await E();y(e),e&&o&&o()}),[E,o]),k=Object(a.useCallback)((()=>r()),[r]),S=Object(a.useCallback)((({comment:e})=>f(e)),[]),w=Object(a.useMemo)((()=>n.length),[n]),j=Object(a.useMemo)((()=>i.a.createElement(m.a,{onClick:k,buttonText:p.c})),[k]),O=Object(a.useMemo)((()=>i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(m.c,{hostName:t,onCancel:k,onConfirm:x,onChange:S,comment:g,isLoading:v,messageAppend:i.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.detections.hostIsolation.impactedCases",defaultMessage:"This action will be added to {cases}.",values:{cases:i.a.createElement("b",null,Object(p.a)(w))}})}))),[t,k,x,S,g,v,w]);return b?j:O}));g.displayName="IsolateHost";const f=i.a.memo((({endpointId:e,hostName:t,casesInfo:n,cancelCallback:r,successCallback:o})=>{const[g,f]=Object(a.useState)(""),[b,y]=Object(a.useState)(!1),h=n.map((e=>e.id)),{loading:v,unIsolateHost:E}=(({endpointId:e,comment:t,caseIds:n})=>{const[i,r]=Object(a.useState)(!1),{addError:o}=Object(c.a)();return{loading:i,unIsolateHost:Object(a.useCallback)((async()=>{try{r(!0);const a=await Object(d.c)({endpointId:e,comment:t,caseIds:n});return r(!1),!!a.action}catch(e){return r(!1),o(e.message,{title:u.b}),!1}}),[e,t,n,o])}})({endpointId:e,comment:g,caseIds:h}),x=Object(a.useCallback)((async()=>{const e=await E();y(e),e&&o&&o()}),[o,E]),k=Object(a.useCallback)((()=>r()),[r]),S=Object(a.useCallback)((({comment:e})=>f(e)),[]),w=Object(a.useMemo)((()=>n.length),[n]),j=Object(a.useMemo)((()=>i.a.createElement(m.a,{onClick:k,buttonText:p.c})),[k]),O=Object(a.useMemo)((()=>i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(m.e,{hostName:t,onCancel:k,onConfirm:x,onChange:S,comment:g,isLoading:v,messageAppend:i.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.detections.hostIsolation.impactedCases",defaultMessage:"This action will be added to {cases}.",values:{cases:i.a.createElement("b",null,Object(p.a)(w))}})}))),[t,k,x,S,g,v,w]);return b?j:O}));f.displayName="UnisolateHost";const b=i.a.memo((({details:e,cancelCallback:t,successCallback:n,isolateAction:s})=>{const l=Object(a.useMemo)((()=>{var t;const n=null===(t=Object(r.find)({category:"agent",field:"agent.id"},e))||void 0===t?void 0:t.values;return n?n[0]:""}),[e]),c=Object(a.useMemo)((()=>{var t;const n=null===(t=Object(r.find)({category:"host",field:"host.name"},e))||void 0===t?void 0:t.values;return n?n[0]:""}),[e]),u=Object(a.useMemo)((()=>{var t;const n=null===(t=Object(r.find)({category:"_id",field:"_id"},e))||void 0===t?void 0:t.values;return n?n[0]:""}),[e]),{casesInfo:d}=Object(o.a)({alertId:u});return"isolateHost"===s?i.a.createElement(g,{endpointId:l,hostName:c,casesInfo:d,cancelCallback:t,successCallback:n}):i.a.createElement(f,{endpointId:l,hostName:c,casesInfo:d,cancelCallback:t,successCallback:n})}));b.displayName="HostIsolationContent"},function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));var a=n(32),i=n(4),r=n.n(i),o=n(78),s=n(116),l=n(79),c=n(81),u=n(86),d=n(108),p=n(34),m=n(268),g=n.n(m),f=n(100),b=n(210),y=n(242),h=n(553);const v={title:{type:f.a.TEXT,validations:[{validator:f.h.emptyField("")}]},description:{type:f.a.TEXTAREA,validations:[]}};var E=n(154),x=n(179);const k=Object(f.j)({component:f.b}),S=r.a.memo((({closeSaveTimeline:e,initialFocus:t,timelineId:n,showWarning:s})=>{const{startTransaction:d}=Object(E.a)(),m=Object(i.useMemo)((()=>u.b.getTimelineByIdSelector()),[]),{isSaving:S,description:w="",status:j,title:O="",timelineType:I}=Object(c.a)((e=>Object(p.pick)(["isSaving","description","status","title","timelineType"],m(e,n)))),T=g()(S),C=Object(o.useDispatch)(),M=Object(b.a)({timelineId:l.j.active,timelineType:l.n.default}),N=Object(i.useCallback)(((e,t)=>(t&&C(u.a.updateTitleAndDescription({id:n,...e})),Promise.resolve())),[C,n]),D=Object(i.useMemo)((()=>({title:O,description:w})),[O,w]),{form:F}=Object(f.k)({id:"timelineTitleAndDescriptionForm",schema:v,onSubmit:N,options:{stripEmptyFields:!1},defaultValue:D}),{isSubmitted:A,isSubmitting:_,submit:R}=F,P=Object(i.useCallback)((()=>{d({name:x.f.SAVE}),R()}),[R,d]),L=Object(i.useCallback)((()=>{s&&M(),e()}),[e,M,s]),q=Object(i.useMemo)((()=>j===l.l.draft&&s?I===l.n.template?h.e:h.d:h.c),[s,j,I]),B=Object(i.useMemo)((()=>j===l.l.draft?I===l.n.template?h.l:h.k:I===l.n.template?h.h:h.g),[j,I]),z=Object(i.useMemo)((()=>j===l.l.draft&&s?I===l.n.template?h.l:h.k:h.j),[s,j,I]),$=Object(i.useMemo)((()=>h.p(I)),[I]),V=Object(i.useMemo)((()=>`${h.m} (${h.i})`),[]),U=Object(i.useMemo)((()=>({"aria-label":h.n,autoFocus:"title"===t,"data-test-subj":"save-timeline-title",disabled:S,spellCheck:!0,placeholder:I===l.n.template?y.k:y.l})),[t,S,I]),H=Object(i.useMemo)((()=>({"aria-label":h.m,autoFocus:"description"===t,"data-test-subj":"save-timeline-description",disabled:S,placeholder:y.f})),[t,S]);return Object(i.useEffect)((()=>{A&&!S&&T&&e()}),[A,S,T,e]),r.a.createElement(a.EuiModal,{"data-test-subj":"save-timeline-modal",maxWidth:1024,onClose:e},S&&r.a.createElement(a.EuiProgress,{size:"s",color:"primary",position:"absolute","data-test-subj":"progress-bar"}),r.a.createElement(a.EuiModalHeader,{"data-test-subj":"modal-header"},B),r.a.createElement(a.EuiModalBody,null,s&&r.a.createElement(a.EuiFlexItem,{grow:!0},r.a.createElement(a.EuiCallOut,{title:$,color:"danger",iconType:"alert","data-test-subj":"save-timeline-callout"}),r.a.createElement(a.EuiSpacer,{size:"m"})),r.a.createElement(f.c,{form:F},r.a.createElement(a.EuiFlexItem,{grow:!0},r.a.createElement(k,{path:"title",fullWidth:!0,label:h.o,euiFieldProps:U}),r.a.createElement(a.EuiSpacer,null)),r.a.createElement(a.EuiFlexItem,{grow:!0},r.a.createElement(k,{label:V,path:"description",fullWidth:!0,euiFieldProps:H}),r.a.createElement(a.EuiSpacer,null)),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},r.a.createElement(a.EuiFlexItem,{grow:!1,component:"span"},r.a.createElement(a.EuiButton,{size:"s",fill:!1,onClick:L,isDisabled:S,"data-test-subj":"close-button"},q)),r.a.createElement(a.EuiFlexItem,{grow:!1,component:"span"},r.a.createElement(a.EuiButton,{size:"s",isDisabled:S||_,fill:!0,onClick:P,"data-test-subj":"save-button"},z)))))))}));S.displayName="TimelineTitleAndDescription";const w=r.a.memo((({initialFocus:e,timelineId:t,toolTip:n})=>{const p=Object(o.useDispatch)(),m=Object(i.useMemo)((()=>Object(d.createSelector)(u.b.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.showSaveModal)&&void 0!==t&&t}))),[]),g=Object(c.a)((e=>m(e,t))),[f,b]=Object(i.useState)(!1),y=Object(i.useCallback)((()=>{b(!1),g&&p(u.a.toggleModalSaveTimeline({id:l.j.active,showModalSaveTimeline:!1}))}),[p,b,g]),v=Object(i.useCallback)((()=>{b(!0)}),[b]),{kibanaSecuritySolutionsPrivileges:{crud:E}}=Object(s.a)(),x=Object(i.useMemo)((()=>E?n:h.b),[n,E]),k=Object(i.useMemo)((()=>r.a.createElement(a.EuiButtonIcon,{"aria-label":h.f,isDisabled:!E,onClick:v,iconType:"pencil","data-test-subj":"save-timeline-button-icon"})),[v,E]);return"title"===e&&g||f?r.a.createElement(r.a.Fragment,null,k,r.a.createElement(S,{closeSaveTimeline:y,initialFocus:e,timelineId:t,showWarning:"title"===e&&g})):r.a.createElement(a.EuiToolTip,{content:null!=x?x:"","data-test-subj":"save-timeline-btn-tooltip"},k)}));w.displayName="SaveTimelineButton"},function(e,t,n){"use strict";n.d(t,"a",(function(){return R}));var a=n(4),i=n.n(a),r=n(285),o=n(81),s=n(77),l=n(98),c=n(158),u=n(159),d=n(32),p=n(33),m=n.n(p),g=n(0);const f=g.i18n.translate("xpack.securitySolution.fieldBrowser.createFieldButton",{defaultMessage:"Create field"}),b=m()(d.EuiButton).withConfig({displayName:"StyledButton",componentId:"sc-pj2czg-0"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeM)),y=g.i18n.translate("xpack.securitySolution.fieldBrowser.fieldName",{defaultMessage:"Name"}),h=g.i18n.translate("xpack.securitySolution.fieldBrowser.descriptionLabel",{defaultMessage:"Description"}),v=g.i18n.translate("xpack.securitySolution.fieldBrowser.categoryLabel",{defaultMessage:"Category"}),E=g.i18n.translate("xpack.securitySolution.fieldBrowser.runtimeLabel",{defaultMessage:"Runtime"}),x=g.i18n.translate("xpack.securitySolution.fieldBrowser.runtimeTitle",{defaultMessage:"Runtime Field"}),k=g.i18n.translate("xpack.securitySolution.fieldBrowser.actionsLabel",{defaultMessage:"Actions"}),S=g.i18n.translate("xpack.securitySolution.fieldBrowser.editButton",{defaultMessage:"Edit"}),w=g.i18n.translate("xpack.securitySolution.fieldBrowser.removeButton",{defaultMessage:"Remove"}),j=g.i18n.translate("xpack.securitySolution.fieldBrowser.editButtonDescription",{defaultMessage:"Edit runtime field"}),O=g.i18n.translate("xpack.securitySolution.fieldBrowser.removeButtonDescription",{defaultMessage:"Delete runtime field"});var I=n(182),T=n(87),C=n(203);const M=m()(d.EuiIcon).withConfig({displayName:"TypeIcon",componentId:"sc-bemp51-0"})(["margin:0 4px;position:relative;top:-1px;"]);M.displayName="TypeIcon";const N=m.a.span.withConfig({displayName:"Description",componentId:"sc-bemp51-1"})(["user-select:text;width:",";"],(({width:e})=>e));N.displayName="Description";const D=i.a.memo((({fieldId:e,highlight:t=""})=>i.a.createElement(d.EuiText,{size:"xs"},i.a.createElement(d.EuiHighlight,{"data-test-subj":`field-${e}-name`,search:t},e))));D.displayName="FieldName";const F=({hasFieldEditPermission:e,openFieldEditor:t,openDeleteFieldModal:n})=>Object(a.useCallback)((({highlight:a,onHide:r})=>{const o=e?[{name:S,description:j,type:"icon",icon:"pencil",isPrimary:!0,onClick:({name:e})=>{t(e),r()},available:({isRuntime:e})=>e,"data-test-subj":"actionEditRuntimeField"},{name:w,description:O,type:"icon",icon:"trash",color:"danger",isPrimary:!0,onClick:({name:e})=>{n(e),r()},available:({isRuntime:e})=>e,"data-test-subj":"actionDeleteRuntimeField"}]:[];return[{field:"name",name:y,render:(e,{type:t})=>i.a.createElement(d.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiToolTip,{content:t},i.a.createElement(M,{"data-test-subj":`field-${e}-icon`,type:Object(I.d)(null!=t?t:null)}))),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(D,{fieldId:e,highlight:a}))),sortable:!0,width:"225px"},{field:"description",name:h,render:(e,{name:t,example:n})=>{return i.a.createElement(d.EuiToolTip,{content:e},i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiScreenReaderOnly,{"data-test-subj":"descriptionForScreenReaderOnly"},i.a.createElement("p",null,(a=t,g.i18n.translate("xpack.securitySolution.fieldBrowser.descriptionForScreenReaderOnly",{values:{field:a},defaultMessage:"Description for field {field}:"})))),i.a.createElement(C.a,null,i.a.createElement(N,{width:o.length>0?"335px":"400px","data-test-subj":`field-${t}-description`},`${null!=e?e:Object(T.e)()} ${Object(I.c)(n)}`))));var a},sortable:!0,width:o.length>0?"335px":"400px"},{field:"isRuntime",name:E,render:e=>e?i.a.createElement(d.EuiHealth,{color:"success",title:x}):null,sortable:!0,width:"80px"},{field:"category",name:v,render:(e,{name:t})=>i.a.createElement(d.EuiBadge,{"data-test-subj":`field-${t}-category`},e),sortable:!0,width:"115px"},...o.length>0?[{name:k,actions:o,width:"80px"}]:[]]}),[e,t,n]);var A=n(154),_=n(179);const R=({sourcererScope:e,editorActionsRef:t,removeColumn:n,upsertColumn:d})=>{const[p,m]=Object(a.useState)(null),{startTransaction:g}=Object(A.a)(),{indexFieldsSearch:y}=Object(r.b)(),{dataViewFieldEditor:h,data:{dataViews:v}}=Object(s.k)().services,E=Object(a.useMemo)((()=>l.e.scopeIdSelector()),[]),{missingPatterns:x,selectedDataViewId:k}=Object(o.a)((t=>E(t,e)));Object(a.useEffect)((()=>{null==k||x.length||v.get(k).then((e=>{m(e)}))}),[k,x,v]);const S=Object(a.useCallback)((e=>{if(p&&k){const a=h.openEditor({ctx:{dataView:p},fieldName:e,onSave:async a=>{g({name:_.c.FIELD_SAVED}),await y({dataViewId:k,cleanCache:!0});for(const t of a)e&&e!==t.name&&n(e),d({columnHeaderType:c.a,id:t.name,initialWidth:u.a},0);t&&(t.current=null)}});t&&(t.current={closeEditor:()=>{t.current=null,a()}})}}),[p,k,h,t,y,n,d,g]),w=Object(a.useCallback)((e=>{p&&k&&h.openDeleteModal({ctx:{dataView:p},fieldName:e,onDelete:async()=>{g({name:_.c.FIELD_DELETED}),await y({dataViewId:k}),n(e)}})}),[p,k,h,y,n,g]),j=Object(a.useMemo)((()=>null==h?void 0:h.userPermissions.editIndexPattern()),[null==h?void 0:h.userPermissions]),O=(({isAllowed:e,loading:t,openFieldEditor:n})=>{const r=Object(a.useCallback)((({onHide:e})=>i.a.createElement(b,{iconType:t?"none":"plusInCircle","aria-label":f,"data-test-subj":"create-field",onClick:()=>{n(),e()},isLoading:t},f)),[t,n]);return e?r:void 0})({isAllowed:j&&!!k,loading:!p,openFieldEditor:S});return{createFieldButton:O,getFieldTableColumns:F({hasFieldEditPermission:j,openFieldEditor:S,openDeleteFieldModal:w})}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(82),i=n.n(a),r=n(249),o=n.n(r),s=(n(4),n(47)),l=n.n(s),c=n(32),u=n(36),d=["type","label","size","scripted","className"],p={iconType:"questionInCircle",color:"gray"},m={boolean:{iconType:"tokenBoolean"},conflict:{iconType:"alert",color:"euiColorVis9",shape:"square"},date:{iconType:"tokenDate"},date_range:{iconType:"tokenDate"},geo_point:{iconType:"tokenGeo"},geo_shape:{iconType:"tokenGeo"},ip:{iconType:"tokenIP"},ip_range:{iconType:"tokenIP"},match_only_text:{iconType:"tokenString"},murmur3:{iconType:"tokenSearchType"},number:{iconType:"tokenNumber"},number_range:{iconType:"tokenNumber"},histogram:{iconType:"tokenHistogram"},_source:{iconType:"editorCodeBlock",color:"gray"},string:{iconType:"tokenString"},text:{iconType:"tokenString"},keyword:{iconType:"tokenKeyword"},gauge:{iconType:"tokenMetricGauge"},counter:{iconType:"tokenMetricCounter"},nested:{iconType:"tokenNested"},version:{iconType:"tokenTag"}};function g(e){var t=e.type,n=e.label,a=e.size,r=void 0===a?"s":a,s=e.scripted,g=e.className,f=o()(e,d),b=m[t]||p;return Object(u.jsx)(c.EuiToken,i()({},b,{className:l()("kbnFieldIcon",g),"aria-label":n||t,title:n||t,size:r,fill:s?"dark":void 0},f))}n(947);Object.keys({s:"kbnFieldButton--small",m:null})},function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(4),i=n.n(a),r=n(32),o=n(7),s=n(0);const l=s.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToRulesTableSelection.addToSelectedRulesDescription",{defaultMessage:"After you create the exception, it is added to the rules you link. "});var c=n(479),u=n(719),d=n(261);const p=Object(a.memo)((({rule:e,linkedRules:t,onRuleLinkChange:n})=>{const o=Object(a.useMemo)((()=>Boolean(t.find((t=>t.id===e.id)))),[t,e.id]),s=Object(a.useCallback)((({target:{checked:a}})=>{const i=a?[...t,e]:null==t?void 0:t.filter((t=>t.id!==e.id));"function"==typeof n&&n(i)}),[t,n,e]);return i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiSwitch,{onChange:s,label:"",checked:o}))}));p.displayName="LinkRuleSwitch";const m=({initiallySelectedRules:e,onRuleSelectionChange:t})=>{const{isLoading:n,searchOptions:m,pagination:g,sortedRulesByLinkedRulesOnTop:f,rulesTableColumnsWithLinkSwitch:b,onTableChange:y,addToSelectedRulesDescription:h}=(({initiallySelectedRules:e,onRuleSelectionChange:t})=>{const{data:{rules:n}={rules:[],total:0},isFetched:r}=Object(u.a)({isInMemorySorting:!0,filterOptions:{filter:"",showCustomRules:!1,showElasticRules:!1,tags:[]},sortingOptions:void 0,pagination:void 0,refetchInterval:!1}),[m,g]=Object(a.useState)({pageIndex:0,initialPageSize:5,showPerPageOptions:!1}),[f,b]=Object(a.useState)(e||[]);Object(a.useEffect)((()=>{t(f)}),[f,t]);const y=Object(a.useMemo)((()=>Object(o.sortBy)(n,[t=>null==e?void 0:e.find((e=>e.id===t.id))])),[e,n]),h=Object(a.useMemo)((()=>[...y.reduce(((e,t)=>{const{tags:n}=t;return n.forEach((t=>e.add(t))),e}),new Set)].map((e=>({value:e,name:e})))),[y]),v=Object(a.useMemo)((()=>({box:{incremental:!0},filters:[{type:"field_value_selection",field:"tags",name:s.i18n.translate("xpack.securitySolution.exceptions.addToRulesTable.tagsFilterLabel",{defaultMessage:"Tags"}),multiSelect:"or",options:h}]})),[h]),E=Object(a.useMemo)((()=>[{field:"link",name:c.a,align:"left","data-test-subj":"ruleActionLinkRuleSwitch",render:(e,t)=>i.a.createElement(p,{rule:t,linkedRules:f,onRuleLinkChange:b})},...Object(d.c)()]),[f]),x=Object(a.useCallback)((({page:{index:e}})=>g({...m,pageIndex:e})),[m]);return{isLoading:!r,pagination:m,searchOptions:v,sortedRulesByLinkedRulesOnTop:y,rulesTableColumnsWithLinkSwitch:E,addToSelectedRulesDescription:l,onTableChange:x}})({initiallySelectedRules:e,onRuleSelectionChange:t});return i.a.createElement(r.EuiPanel,{color:"subdued",borderRadius:"none",hasShadow:!1},i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiText,{size:"s"},h),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(r.EuiInMemoryTable,{tableLayout:"auto",search:m,"data-test-subj":"addExceptionToRulesTable",tableCaption:"Rules table",items:f,loading:n,columns:b,message:n?i.a.createElement(r.EuiLoadingContent,{lines:4,"data-test-subj":"exceptionItemViewerEmptyPrompts-loading"}):void 0,pagination:g,onTableChange:y})))},g=i.a.memo(m);g.displayName="ExceptionsAddToRulesTable"},function(e,t,n){"use strict";n.d(t,"b",(function(){return $})),n.d(t,"a",(function(){return V}));var a=n(4),i=n.n(a),r=n(32),o=n(7),s=n(78),l=n(93),c=n(34),u=n(38),d=n(99),p=n(654),m=n(77),g=n(511),f=n(183),b=n(190),y=n(116),h=n(141),v=n(345),E=n(118),x=n(98),k=n(104),S=n(186),w=n(185),j=n(230),O=n(706),I=n(472),T=n(655),C=n(649),M=n(688),N=n(254),D=n(652),F=n(714),A=n(289),_=n(0),R=n(89),P=n(107),L=n(128),q=n(1);const B=_.i18n.translate("xpack.securitySolution.detectionEngine.alerts.actions.openAlertDetails",{defaultMessage:"Open alert details page"}),z=({ariaLabel:e=E.A,ariaRowindex:t,columnValues:n,disabled:s,ecsRowData:l,onRuleChange:b,scopeId:v,globalQuery:x,timelineQuery:S})=>{var w,j,_,z,$,U,H,G,Q,W,K,Y,J,X,Z,ee,te,ne,ae,ie;const[re,oe]=Object(a.useState)(!1),[se,le]=Object(a.useState)(!1),[ce]=Object(f.a)(),ue=Object(a.useCallback)((()=>{oe(!1)}),[]),de=null!=l&&null!==(pe=l.kibana)&&void 0!==pe&&pe.alert?null==l?void 0:l._id:null;var pe;const me=Object(c.get)(0,null==l||null===(w=l.kibana)||void 0===w||null===(j=w.alert)||void 0===j||null===(_=j.rule)||void 0===_?void 0:_.uuid),ge=Object(c.get)(0,null==l||null===(z=l.kibana)||void 0===z||null===($=z.alert)||void 0===$||null===(U=$.rule)||void 0===U?void 0:U.rule_id),fe=Object(c.get)(0,null==l||null===(H=l.kibana)||void 0===H||null===(G=H.alert)||void 0===G||null===(Q=G.rule)||void 0===Q?void 0:Q.name),be=[k.c.alertsOnAlertsPage,k.c.alertsOnRuleDetailsPage].includes(v),{addToCaseActionItems:ye}=Object(F.a)({ecsData:l,onMenuItemClick:ue,isActiveTimelines:Object(d.isActiveTimeline)(null!=v?v:""),ariaLabel:Object(N.d)({ariaRowindex:t,columnValues:n}),isInDetections:be}),{loading:he,canAccessEndpointManagement:ve}=Object(y.a)().endpointPrivileges,Ee=Object(a.useMemo)((()=>!he&&ve),[ve,he]),xe=Object(c.get)(0,null==l||null===(W=l.kibana)||void 0===W||null===(K=W.alert)||void 0===K?void 0:K.workflow_status),ke=Object(a.useMemo)((()=>{var e;return-1!==Object(o.indexOf)(null===(e=l.event)||void 0===e?void 0:e.kind,"event")}),[l]),Se=Object(a.useMemo)((()=>{var e,t;return null===(e=l.agent)||void 0===e||null===(t=e.type)||void 0===t?void 0:t.includes("endpoint")}),[l]),we=Object(a.useMemo)((()=>ke&&Se),[ke,Se]),je=Object(a.useMemo)((()=>v===k.c.hostsPageEvents||v===k.c.usersPageEvents),[v]),Oe=Object(a.useCallback)((()=>{oe(!re)}),[re]),Ie=Object(a.useCallback)((()=>{oe(!1)}),[]),Te=Object(a.useMemo)((()=>i.a.createElement(r.EuiToolTip,{position:"top",content:E.A},i.a.createElement(r.EuiButtonIcon,{"aria-label":e,"data-test-subj":"timeline-context-menu-button",size:"s",iconType:"boxesHorizontal",onClick:Oe,isDisabled:s}))),[s,Oe,e]),Ce=e=>{e.forEach((e=>e.refetch&&e.refetch()))},Me=Object(a.useCallback)((()=>{Object(d.isActiveTimeline)(null!=v?v:"")?(Ce([S]),"alerts"===ce.pageName&&Ce(x)):Ce(x)}),[v,x,S,ce]),Ne=null!==(Y=null===(J=l["kibana.alert.rule.parameters"])||void 0===J?void 0:J.index)&&void 0!==Y?Y:null==l||null===(X=l.signal)||void 0===X||null===(Z=X.rule)||void 0===Z?void 0:Z.index,De=null!==(ee=null===(te=l["kibana.alert.rule.parameters"])||void 0===te?void 0:te.data_view_id)&&void 0!==ee?ee:null==l||null===(ne=l.signal)||void 0===ne||null===(ae=ne.rule)||void 0===ae?void 0:ae.data_view_id,{exceptionFlyoutType:Fe,openAddExceptionFlyout:Ae,onAddExceptionCancel:_e,onAddExceptionConfirm:Re,onAddExceptionTypeClick:Pe}=Object(T.a)({refetch:Me,onRuleChange:b,isActiveTimelines:Object(d.isActiveTimeline)(null!=v?v:"")}),{closeAddEventFilterModal:Le,isAddEventFilterModalOpen:qe,onAddEventFilterClick:Be}=Object(M.a)(),{actionItems:ze}=Object(I.a)({alertStatus:xe,eventId:null==l?void 0:l._id,indexName:null!==(ie=null==l?void 0:l._index)&&void 0!==ie?ie:"",scopeId:v,refetch:Me,closePopover:Ie}),$e=Object(a.useCallback)((e=>{Pe(e),Ie()}),[Ie,Pe]),Ve=Object(a.useCallback)((()=>{Be(),Ie()}),[Ie,Be]),{exceptionActionItems:Ue}=Object(C.a)({isEndpointAlert:Object(A.a)({ecsData:l}),onAddExceptionTypeClick:$e}),{eventFilterActionItems:He}=Object(D.a)({onAddEventFilterClick:Ve,disabled:!we||!Ee||!je,tooltipMessage:je?void 0:E.d}),Ge=Object(a.useMemo)((()=>{var e;return Object(c.get)(0,null==l||null===(e=l.agent)||void 0===e?void 0:e.id)}),[l]),Qe=Object(a.useCallback)((()=>{le((e=>!e)),oe(!1)}),[]),{osqueryActionItems:We}=(({handleClick:e})=>{const t=Object(a.useMemo)((()=>i.a.createElement(p.a,{handleClick:e})),[e]),n=Object(m.k)().services.application.capabilities.osquery;return{osqueryActionItems:null!=n&&n.writeLiveQueries||null!=n&&n.runSavedQueries?[t]:[]}})({handleClick:Qe}),{alertDetailsActionItems:Ke}=(({ruleId:e,closePopover:t,alertId:n})=>{const a=Object(P.a)("alertDetailsPageEnabled"),o=[],{onClick:s}=Object(R.o)()({deepLinkId:q.uc.alerts,path:n?Object(L.b)(n):""});return e&&n&&a&&o.push(i.a.createElement(r.EuiContextMenuItem,{key:"open-alert-details-item","data-test-subj":"open-alert-details-page-menu-item",onClick:s},B)),{alertDetailsActionItems:o}})({alertId:de,closePopover:Ie,ruleId:me}),Ye=Object(a.useMemo)((()=>!ke&&me?[...ye,...ze,...Ue,...Ge?We:[],...Ke]:[...ye,...He,...Ge?We:[]]),[ke,me,ye,ze,Ue,Ge,We,Ke,He]);return i.a.createElement(i.a.Fragment,null,Ye.length>0&&i.a.createElement("div",{key:"actions-context-menu"},i.a.createElement(h.l,{textAlign:"center",width:u.DEFAULT_ACTION_BUTTON_WIDTH},i.a.createElement(r.EuiPopover,{id:"singlePanel",button:Te,isOpen:re,closePopover:Ie,panelPaddingSize:"none",anchorPosition:"downLeft",repositionOnScroll:!0},i.a.createElement(r.EuiContextMenuPanel,{size:"s",items:Ye})))),Ae&&me&&ge&&null!=fe&&null!=(null==l?void 0:l._id)&&i.a.createElement(V,{ruleId:me,ruleRuleId:ge,ruleIndices:Ne,ruleDataViewId:De,ruleName:fe,exceptionListType:Fe,eventId:null==l?void 0:l._id,onCancel:_e,onConfirm:Re,alertStatus:xe}),qe&&null!=l&&i.a.createElement(O.a,{data:l,onCancel:Le}),se&&Ge&&null!=l&&i.a.createElement(g.a,{agentId:Ge,defaultValues:de?{alertIds:[de]}:void 0,onClose:Qe,ecsData:l}))},$=Object(s.connect)((()=>{const e=x.d.globalQuery(),t=x.d.timelineQueryByIdSelector();return(n,{scopeId:a})=>({globalQuery:e(n),timelineQuery:t(n,a)})}))(i.a.memo(z)),V=({ruleId:e,ruleRuleId:t,ruleIndices:n,ruleDataViewId:r,ruleName:o,exceptionListType:s,eventId:c,onCancel:u,onConfirm:d,alertStatus:p})=>{const{loading:m,signalIndexName:g}=Object(j.a)(),{loading:f,data:y}=Object(S.a)({query:Object(b.a)(c),indexName:g,queryName:w.a.ADD_EXCEPTION_FLYOUT}),h=Object(a.useMemo)((()=>{if(!1===f){const e=null==y?void 0:y.hits.hits[0];if(!e)return;const{_id:t,_index:n,_source:a}=e;return{...a,_id:t,_index:n}}}),[null==y?void 0:y.hits.hits,f]),E=Object(a.useMemo)((()=>{var e,t,a;return null!=h&&null!=(null===(e=h["kibana.alert.rule.parameters"])||void 0===e?void 0:e.index)?Array.isArray(h["kibana.alert.rule.parameters"].index)?h["kibana.alert.rule.parameters"].index:[h["kibana.alert.rule.parameters"].index]:null!=h&&null!=(null==h||null===(t=h.signal)||void 0===t||null===(a=t.rule)||void 0===a?void 0:a.index)?Array.isArray(h.signal.rule.index)?h.signal.rule.index:[h.signal.rule.index]:n}),[h,n]),x=Object(a.useMemo)((()=>{var e;return null!=h&&null!=(null===(e=h["kibana.alert.rule.parameters"])||void 0===e?void 0:e.data_view_id)?h["kibana.alert.rule.parameters"].data_view_id:r}),[h,r]),k=Object(a.useMemo)((()=>null!=h&&null!=h["kibana.alert.rule.parameters"]?[{...h["kibana.alert.rule.parameters"],id:e,rule_id:t,name:o,index:E,data_view_id:x}]:[{id:e,rule_id:t,name:o,index:E,data_view_id:x}]),[h,x,E,e,o,t]),O=f&&m||null==h||null==E&&null==x;return i.a.createElement(v.a,{rules:k,isEndpointItem:s===l.b.ENDPOINT,alertData:h,isAlertDataLoading:O,alertStatus:p,isBulkAction:!1,showAlertCloseOptions:!0,onCancel:u,onConfirm:d})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return k}));var a=n(82),i=n.n(a),r=n(4),o=n.n(r),s=n(35),l=n(32),c=n(11),u=n(685),d=n(686),p=n(117),m=n.n(p),g=n(290);const f=e=>{var t,n,a,i,r,o,s;return null!=e&&null!==(t=e.agent)&&void 0!==t&&null!==(n=t.type)&&void 0!==n&&n.includes("endpoint")?((null==e||null===(a=e.host)||void 0===a||null===(i=a.os)||void 0===i?void 0:i.name)||["windows"]).map((e=>e.toLowerCase())):null!==(r=null==e||null===(o=e.host)||void 0===o||null===(s=o.os)||void 0===s?void 0:s.family)&&void 0!==r?r:["windows"]},b=e=>{var t,n;return{comments:[],description:"",entries:e&&e.event&&e.process?[{field:"event.category",operator:"included",type:"match",value:(null!==(t=e.event.category)&&void 0!==t?t:[])[0]},{field:"process.executable",operator:"included",type:"match",value:(null!==(n=e.process.executable)&&void 0!==n?n:[])[0]}]:[{field:"",operator:"included",type:"match",value:""}],item_id:void 0,list_id:g.a,meta:{temporaryUuid:m.a.v4()},name:"",namespace_type:"agnostic",tags:["policy:all"],type:"simple",os_types:f(e)}};var y=n(77),h=n(394),v=n(279),E=n(418),x=n(0);const k=Object(r.memo)((({onCancel:e,data:t,...n})=>{var a,p;const m=Object(y.o)(),g=Object(y.j)(),{isLoading:f,mutateAsync:k}=Object(u.a)(E.a.getInstance(g),"create"),[S,w]=Object(r.useState)(),[j,O]=Object(r.useState)(!1),{data:{search:I}}=Object(y.k)().services,T=Object(h.c)({perPage:1e3,onError:e=>{m.addWarning(Object(v.b)(e))}}),[C,M]=Object(r.useState)(b(t)),N=Object(r.useMemo)((()=>T.isLoading||T.isRefetching),[T]);Object(r.useEffect)((()=>(t&&(async()=>{var e;if(!t||!t._index)return;const n=await Object(c.lastValueFrom)(I.search({params:{index:t._index,body:{query:{match:{_id:t._id}}}}}));w({...t,host:{...t.host,os:{...(null==t||null===(e=t.host)||void 0===e?void 0:e.os)||{},name:[n.rawResponse.hits.hits[0]._source.host.os.name]}}})})(),()=>{M(b())})),[]);const D=Object(r.useCallback)((()=>{N||f||e()}),[f,N,e]),F=Object(r.useCallback)((()=>k(C,{onSuccess:t=>{var n;m.addSuccess((n=t,x.i18n.translate("xpack.securitySolution.eventFilter.flyoutForm.creationSuccessToastTitle",{defaultMessage:'"{name}" has been added to the event filters list.',values:{name:null==n?void 0:n.name}}))),e()},onError:e=>{m.addError(e,{title:'There was an error creating the new event filter: "{error}"',message:{error:e.message}})}})),[C,e,k,m]),A=Object(r.useMemo)((()=>o.a.createElement(l.EuiButton,{"data-test-subj":"add-exception-confirm-button",fill:!0,disabled:!j||f||!!t&&!S||N,onClick:F,isLoading:N},t?o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventFilters.eventFiltersFlyout.actions.confirm.update.withData",defaultMessage:"Add endpoint event filter"}):o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventFilters.eventFiltersFlyout.actions.confirm.create",defaultMessage:"Add event filter"}))),[t,S,F,j,f,N]),_=Object(r.useCallback)((e=>{e&&(O(e.isValid),M(e.item))}),[]);return o.a.createElement(l.EuiFlyout,i()({size:"l",onClose:D,"data-test-subj":"eventFiltersCreateFlyout"},n),o.a.createElement(l.EuiFlyoutHeader,{hasBorder:!0},o.a.createElement(l.EuiTitle,{size:"m"},o.a.createElement("h2",null,t?o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventFilters.eventFiltersFlyout.title.create.withData",defaultMessage:"Add endpoint event filter"}):o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventFilters.eventFiltersFlyout.subtitle.create",defaultMessage:"Add event filter"}))),t?o.a.createElement(l.EuiTextColor,{color:"subdued"},o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventFilters.eventFiltersFlyout.subtitle.create.withData",defaultMessage:"Endpoint security"})):null),o.a.createElement(l.EuiFlyoutBody,null,o.a.createElement(d.a,{allowSelectOs:!t,error:void 0,disabled:!1,item:C,mode:"create",onChange:_,policies:null!==(a=null==T||null===(p=T.data)||void 0===p?void 0:p.items)&&void 0!==a?a:[],policiesIsLoading:N})),o.a.createElement(l.EuiFlyoutFooter,null,o.a.createElement(l.EuiFlexGroup,{justifyContent:"spaceBetween"},o.a.createElement(l.EuiFlexItem,{grow:!1},o.a.createElement(l.EuiButtonEmpty,{isDisabled:f,"data-test-subj":"cancelExceptionAddButton",onClick:D},o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventFilters.eventFiltersFlyout.actions.cancel",defaultMessage:"Cancel"}))),o.a.createElement(l.EuiFlexItem,{grow:!1},A))))}));k.displayName="EventFiltersFlyout"},function(e,t,n){"use strict";n.d(t,"a",(function(){return _}));var a=n(32),i=n(4),r=n.n(i),o=n(33),s=n.n(o),l=n(855),c=n(1),u=n(119),d=n(211),p=n(124),m=n(114),g=n(186),f=n(185),b=n(127),y=n(339);const h={critical:y.D,high:y.E,medium:y.H,low:y.G},v=({additionalFilters:e=[],from:t,to:n,entityFilter:a})=>({size:0,query:{bool:{filter:[...e,{range:{"@timestamp":{gte:t,lte:n}}},...a?[{term:{[a.field]:a.value}}]:[]]}},aggs:{alertsByStatus:{terms:{field:"kibana.alert.workflow_status"},aggs:{statusBySeverity:{terms:{field:"kibana.alert.severity"}}}}}});var E=n(109),x=n(273),k=n(463),S=n(234),w=n(865),j=n(925),O=n(558),I=n(327),T=n(89),C=n(411);const M=s()(a.EuiFlexItem).withConfig({displayName:"StyledFlexItem",componentId:"sc-3zhuyw-0"})(["padding:0 4px;"]),N=s()(a.EuiFlexItem).withConfig({displayName:"StyledLegendFlexItem",componentId:"sc-3zhuyw-1"})(["padding-left:32px;padding-top:45px;"]),D=[{key:"critical",label:y.D,color:k.b.critical},{key:"high",label:y.E,color:k.b.high},{key:"medium",label:y.H,color:k.b.medium},{key:"low",label:y.G,color:k.b.low}],F="detection-response-alerts-by-status",A={field:"event.kind",value:"signal"},_=({additionalFilters:e,signalIndexName:t,entityFilter:n})=>{var o,s,k,_,R,P,L,q,B;const{toggleStatus:z,setToggleStatus:$}=Object(E.a)(F),{openTimelineWithFilters:V}=Object(C.a)(),{onClick:U,href:H}=Object(T.o)()({deepLinkId:c.uc.alerts}),G=Object(a.useIsWithinMinBreakpoint)("xl"),Q=Object(a.useIsWithinMaxBreakpoint)("s")||G?120:90,W=Object(i.useMemo)((()=>({name:n?y.o:x.k,href:n?void 0:H,onClick:n?()=>V([[n,A]]):U})),[n,H,U,V]),{items:K,isLoading:Y,updatedAt:J}=(({additionalFilters:e,entityFilter:t,queryId:n,signalIndexName:a,skip:r=!1})=>{const{to:o,from:s,deleteQuery:l,setQuery:c}=Object(m.a)(),[u,d]=Object(i.useState)(Date.now()),[p,y]=Object(i.useState)(null),{data:E,loading:x,refetch:k,request:S,response:w,setQuery:j}=Object(g.a)({query:v({from:s,to:o,entityFilter:t,additionalFilters:e}),indexName:a,skip:r,queryName:f.a.BY_STATUS});Object(i.useEffect)((()=>{j(v({from:s,to:o,entityFilter:t,additionalFilters:e}))}),[j,s,o,t,e]),Object(i.useEffect)((()=>{y(null==E?null:(e=>{var t,n,a;const i=null!==(t=null==e||null===(n=e.aggregations)||void 0===n||null===(a=n.alertsByStatus)||void 0===a?void 0:a.buckets)&&void 0!==t?t:[];return 0===i.length?null:i.reduce(((e,t)=>{var n,a;const i=null!==(n=null===(a=t.statusBySeverity)||void 0===a?void 0:a.buckets)&&void 0!==n?n:[];return{...e,[t.key]:{total:t.doc_count,severities:i.map((e=>({key:e.key,value:e.doc_count,label:h[e.key]})))}}}),{})})(E)),d(Date.now())}),[E]);const O=Object(i.useCallback)((()=>{!r&&k&&k()}),[r,k]);return Object(b.b)({deleteQuery:l,inspect:{dsl:[S],response:[w]},refetch:O,setQuery:c,queryId:n,loading:x}),{items:p,isLoading:x,updatedAt:u}})({additionalFilters:e,entityFilter:n,signalIndexName:t,skip:!z,queryId:F}),X=Object(i.useMemo)((()=>D.map((e=>({color:e.color,field:"kibana.alert.severity",value:e.label})))),[]),Z=null!==(o=null==K||null===(s=K.open)||void 0===s?void 0:s.total)&&void 0!==o?o:0,ee=null!==(k=null==K||null===(_=K.acknowledged)||void 0===_?void 0:_.total)&&void 0!==k?k:0,te=null!==(R=null==K||null===(P=K.closed)||void 0===P?void 0:P.total)&&void 0!==R?R:0,ne=Y||null==K?0:Z+ee+te,ae=Object(i.useCallback)((e=>{var t,n;return null!==(t=null===(n=D.find((t=>t.label===e.dataName)))||void 0===n?void 0:n.color)&&void 0!==t?t:O.b}),[]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(d.a,{show:!0,targetClassNames:[p.a]},r.a.createElement(a.EuiPanel,{hasBorder:!0,"data-test-subj":"detection-response-alerts-by-status-panel"},Y&&r.a.createElement(a.EuiProgress,{"data-test-subj":"initialLoadingPanelMatrixOverTime",size:"xs",position:"absolute",color:"accent"}),r.a.createElement(u.a,{id:F,title:n?y.b:y.c,titleSize:"m",subtitle:r.a.createElement(I.a,{isUpdating:Y,updatedAt:J}),inspectMultiple:!0,toggleStatus:z,toggleQuery:$},r.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(T.g,{"data-test-subj":"view-details-button",onClick:W.onClick,href:W.href},W.name)))),z&&r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiFlexGroup,{justifyContent:"center",gutterSize:"none"},r.a.createElement(a.EuiFlexItem,{grow:!1},0!==ne&&r.a.createElement(a.EuiText,{className:"eui-textCenter",size:"s"},r.a.createElement(r.a.Fragment,null,r.a.createElement("b",null,r.a.createElement(S.a,{count:ne})),r.a.createElement(r.a.Fragment,null," "),r.a.createElement("small",null,Object(y.a)(ne)))),r.a.createElement(a.EuiSpacer,{size:"l"}),r.a.createElement(a.EuiFlexGroup,{justifyContent:"center"},r.a.createElement(M,{key:"alerts-status-open",grow:!1},r.a.createElement(l.a,{data:null==K||null===(L=K.open)||void 0===L?void 0:L.severities,fillColor:ae,height:Q,label:y.I,title:r.a.createElement(w.a,{count:Z}),totalCount:Z})),r.a.createElement(M,{key:"alerts-status-acknowledged",grow:!1},r.a.createElement(l.a,{data:null==K||null===(q=K.acknowledged)||void 0===q?void 0:q.severities,fillColor:ae,height:Q,label:y.B,title:r.a.createElement(w.a,{count:ee}),totalCount:ee})),r.a.createElement(M,{key:"alerts-status-closed",grow:!1},r.a.createElement(l.a,{data:null==K||null===(B=K.closed)||void 0===B?void 0:B.severities,fillColor:ae,height:Q,label:y.C,title:r.a.createElement(w.a,{count:te}),totalCount:te})))),r.a.createElement(N,{grow:!1},X.length>0&&r.a.createElement(j.a,{legendItems:X}))),r.a.createElement(a.EuiSpacer,{size:"m"})))))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return B}));var a=n(4),i=n.n(a),r=n(32),o=n(0),s=n(99),l=n(78),c=n(42),u=n(90),d=n(114),p=n(77),m=n(146),g=n(98),f=n(112),b=n(86),y=n(255),h=n(33),v=n.n(h),E=n(860),x=n(914),k=n(94),S=n(618);const w=v.a.div.withConfig({displayName:"TopNContainer",componentId:"sc-kt1n4x-0"})(["min-width:600px;"]),j=v()(r.EuiButtonIcon).withConfig({displayName:"CloseButton",componentId:"sc-kt1n4x-1"})(["z-index:999999;position:absolute;right:4px;top:4px;"]),O=v()(r.EuiSuperSelect).withConfig({displayName:"ViewSelect",componentId:"sc-kt1n4x-2"})(["z-index:999999;width:170px;"]),I=v.a.div.withConfig({displayName:"TopNContent",componentId:"sc-kt1n4x-3"})(["margin-top:4px;margin-right:",";.euiPanel{border:none;}"],(({theme:e})=>e.eui.euiSizeXS)),T=({combinedQueries:e,defaultView:t,deleteQuery:n,filters:r,field:o,from:s,indexPattern:l,options:c,paddingSize:u,query:d,showLegend:p,setAbsoluteRangeDatePickerTarget:m,setQuery:g,scopeId:f,to:b,toggleTopN:h})=>{const[v,T]=Object(a.useState)(t),C=Object(a.useCallback)((e=>T(e)),[T]),{selectedPatterns:M,runtimeMappings:N}=Object(k.d)(Object(y.b)({scopeId:f,view:v}));Object(a.useEffect)((()=>{T(t)}),[t]);const D=Object(a.useMemo)((()=>i.a.createElement(O,{"data-test-subj":"view-select",disabled:1===c.length,onChange:C,options:c,valueOfSelected:v})),[C,c,v]),F=Object(a.useMemo)((()=>Object(y.d)({filters:r,tableId:f,view:v})),[r,f,v]);return i.a.createElement(w,{"data-test-subj":"topN-container"},i.a.createElement(j,{"aria-label":S.c,"data-test-subj":"close",iconType:"cross",onClick:h}),i.a.createElement(I,null,"raw"===v||"all"===v?i.a.createElement(E.a,{combinedQueries:e,deleteQuery:n,filters:F,from:s,headerChildren:D,indexPattern:l,indexNames:M,runtimeMappings:N,onlyField:o,paddingSize:u,query:d,queryType:"topN",showLegend:p,setAbsoluteRangeDatePickerTarget:m,setQuery:g,showSpacer:!1,toggleTopN:h,scopeId:f,to:b}):i.a.createElement(x.a,{combinedQueries:e,filters:F,headerChildren:D,onlyField:o,paddingSize:u,query:d,showLegend:p,setAbsoluteRangeDatePickerTarget:m,runtimeMappings:N})))};T.displayName="TopNComponent";const C=i.a.memo(T);var M=n(79);const N=[],D={query:"",language:"kuery"},F=Object(l.connect)((()=>{const e=g.d.globalQuerySelector(),t=g.d.globalFiltersQuerySelector(),n=b.b.getTimelineByIdSelector(),a=g.d.getTimelineSelector(),i=b.b.getKqlFilterQuerySelector();return(r,o)=>{var s,l;const c=null!==(s=n(r,M.j.active))&&void 0!==s?s:f.b,u=null!==(l=c.filters)&&void 0!==l?l:N,d=a(r),{globalFilters:p}=o;return{activeTimelineEventType:c.eventType,activeTimelineFilters:c.activeTab===M.m.query?u:N,activeTimelineFrom:d.timerange.from,activeTimelineKqlQueryExpression:c.activeTab===M.m.query?i(r,M.j.active):null,activeTimelineTo:d.timerange.to,dataProviders:c.activeTab===M.m.query?c.dataProviders:[],globalQuery:e(r),globalFilters:null!=p?p:t(r),kqlMode:c.kqlMode}}})),A=({activeTimelineEventType:e,activeTimelineFilters:t,activeTimelineFrom:n,activeTimelineKqlQueryExpression:r,activeTimelineTo:o,browserFields:l,dataProviders:g,field:f,indexPattern:b,globalFilters:h=N,globalQuery:v=D,kqlMode:E,onFilterAdded:x,paddingSize:k,showLegend:S,scopeId:w,toggleTopN:j,value:O})=>{const{uiSettings:I}=Object(p.k)().services,{from:T,deleteQuery:M,setQuery:F,to:A}=Object(d.a)(!1),_=Object(y.a)(Object(s.isActiveTimeline)(null!=w?w:"")?e:void 0),R=Object(a.useMemo)((()=>{var e;return Object(s.isActiveTimeline)(null!=w?w:"")?null===(e=Object(m.a)({browserFields:l,config:Object(c.getEsQueryConfig)(I),dataProviders:g,filters:t,indexPattern:b,kqlMode:E,kqlQuery:{language:"kuery",query:null!=r?r:""}}))||void 0===e?void 0:e.filterQuery:void 0}),[w,l,I,g,t,b,E,r]),P=Object(a.useMemo)((()=>Object(y.c)(w)?"alert":_[0].value),[_,w]);return i.a.createElement(C,{combinedQueries:R,"data-test-subj":"top-n",defaultView:P,deleteQuery:Object(s.isActiveTimeline)(null!=w?w:"")?void 0:M,field:f,filters:Object(s.isActiveTimeline)(null!=w?w:"")?N:h,from:Object(s.isActiveTimeline)(null!=w?w:"")?n:T,indexPattern:b,options:_,paddingSize:k,query:Object(s.isActiveTimeline)(null!=w?w:"")?D:v,showLegend:S,setAbsoluteRangeDatePickerTarget:Object(s.isActiveTimeline)(null!=w?w:"")?u.a.timeline:u.a.global,setQuery:F,scopeId:w,to:Object(s.isActiveTimeline)(null!=w?w:"")?o:A,toggleTopN:j,onFilterAdded:x,value:O})};A.displayName="StatefulTopNComponent";const _=F(i.a.memo(A));var R=n(95),P=n(709),L=n(462),q=n(617);const B=i.a.memo((({className:e,Component:t,enablePopOver:n,field:l,flush:c,iconSide:u,iconType:d,isExpandable:p,onClick:m,onFilterAdded:g,ownFocus:f,paddingSize:b,showLegend:h,showTooltip:v=!0,showTopN:E,scopeId:x,title:S,value:w,globalFilters:j})=>{const O=Object(s.isActiveTimeline)(null!=x?x:"")?R.SourcererScopeName.timeline:null!=x&&Object(y.c)(x)?R.SourcererScopeName.detections:R.SourcererScopeName.default,{browserFields:I,indexPattern:T}=Object(k.d)(O),C=null!=d?d:"visBarVertical",M=null!=u?u:"left",N=null!=S?S:(D=l,o.i18n.translate("xpack.securitySolution.hoverActions.showTopTooltip",{values:{fieldName:D},defaultMessage:"Show top {fieldName}"}));var D;const F=Object(a.useMemo)((()=>t?i.a.createElement(t,{"aria-label":N,className:e,"data-test-subj":"show-top-field",icon:C,iconType:C,iconSide:M,flush:c,onClick:m,title:N},N):i.a.createElement(r.EuiButtonIcon,{"aria-label":N,className:"securitySolution__hoverActionButton","data-test-subj":"show-top-field",iconSize:"s",iconType:C,onClick:m})),[t,N,e,c,C,m,M]),A=Object(a.useMemo)((()=>v&&!E?i.a.createElement(r.EuiToolTip,{content:i.a.createElement(P.a,{additionalScreenReaderOnlyContext:Object(L.a)({field:l,value:w}),content:N,shortcut:q.a,showShortcut:f})},F):F),[F,N,l,f,v,E,w]),B=Object(a.useMemo)((()=>i.a.createElement(_,{browserFields:I,field:l,indexPattern:T,onFilterAdded:g,paddingSize:b,showLegend:h,scopeId:null!=x?x:void 0,toggleTopN:m,value:w,globalFilters:j})),[I,l,T,g,b,h,x,m,w,j]);return p?i.a.createElement(i.a.Fragment,null,F,E&&B):E?n?i.a.createElement(r.EuiPopover,{button:F,isOpen:E,closePopover:m,panelClassName:"withHoverActions__popover","data-test-subj":"showTopNContainer"},B):B:A}));B.displayName="ShowTopNButton"},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(32),i=n(4),r=n.n(i);const o=n(0).i18n.translate("xpack.securitySolution.accessibility.tooltipWithKeyboardShortcut.pressTooltipLabel",{defaultMessage:"Press"}),s=({additionalScreenReaderOnlyContext:e="",content:t,shortcut:n,showShortcut:i})=>r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{"data-test-subj":"content"},t),""!==e&&r.a.createElement(a.EuiScreenReaderOnly,{"data-test-subj":"additionalScreenReaderOnlyContext"},r.a.createElement("p",null,e)),i&&r.a.createElement(a.EuiText,{color:"subdued","data-test-subj":"shortcut",size:"s",textAlign:"center"},r.a.createElement("span",null,o),"Â ",r.a.createElement(a.EuiBadge,{color:"hollow"},n))),l=r.a.memo(s);l.displayName="TooltipWithKeyboardShortcut"},function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var a=n(32),i=n(4),r=n.n(i),o=n(709),s=n(605),l=n(47),c=n.n(l),u=n(963),d=n.n(u),p=n(0);p.i18n.translate("xpack.securitySolution.clipboard.copy",{defaultMessage:"Copy"});const m=p.i18n.translate("xpack.securitySolution.clipboard.copied",{defaultMessage:"Copied"}),g=p.i18n.translate("xpack.securitySolution.clipboard.to.the.clipboard",{defaultMessage:"to the clipboard"}),f=p.i18n.translate("xpack.securitySolution.clipboard.copy.to.the.clipboard",{defaultMessage:"Copy to the clipboard"});var b=n(84);const y=({children:e,content:t,isHoverAction:n,onCopy:i,titleSummary:o,toastLifeTimeMs:s})=>{const{addSuccess:l}=Object(b.a)(),u=c()("copy-to-clipboard",{securitySolution__hoverActionButton:n});return r.a.createElement(a.EuiButtonIcon,{"aria-label":f,className:u,"data-test-subj":"clipboard",iconType:"copyClipboard",onClick:e=>{e.preventDefault(),e.stopPropagation();const n=d()(`${t}`,{debug:!0});null!=i&&i({content:t,isSuccess:n}),n&&l(`${m} ${o} ${g}`,{toastLifeTimeMs:s})}},e)},h=r.a.memo((({isHoverAction:e,keyboardShortcut:t="",text:n,titleSummary:i})=>r.a.createElement(a.EuiToolTip,{content:r.a.createElement(o.a,{additionalScreenReaderOnlyContext:n,content:s.a,shortcut:t,showShortcut:""!==t})},r.a.createElement(y,{content:n,isHoverAction:e,titleSummary:i,toastLifeTimeMs:800}))));h.displayName="WithCopyToClipboard"},function(e,t,n){"use strict";n.d(t,"a",(function(){return x}));var a=n(4),i=n.n(a),r=n(33),o=n.n(r),s=n(32),l=n(230),c=n(175),u=n(93),d=n(245),p=n(0);const m=p.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.alertsActions.sectionTitle",{defaultMessage:"Alerts actions"}),g=p.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.alertsActions.singleAlertCloseLabel",{defaultMessage:"Close this alert"}),f=p.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.alertsActions.bulkCloseLabel.disabled",{defaultMessage:"Close all alerts that match this exception and were generated by this rule (Lists and non-ECS fields are not supported)"}),b=p.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.alertsActions.bulkCloseLabel",{defaultMessage:"Close all alerts that match this exception and were generated by selected rule/s"}),y=p.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.alertsActions.endpointQuarantineText",{defaultMessage:"On all Endpoint hosts, quarantined files that match the exception are automatically restored to their original locations. This exception applies to all rules using Endpoint exceptions."}),h=o.a.section.withConfig({displayName:"FlyoutCheckboxesSection",componentId:"sc-1qdq0iq-0"})(["overflow-y:inherit;height:auto;.euiFlyoutBody__overflowContent{padding-top:0;}"]),v=o()(s.EuiTitle).withConfig({displayName:"SectionHeader",componentId:"sc-1qdq0iq-1"})(["",""],(()=>Object(r.css)(["font-weight:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold)))),E=({isAlertDataLoading:e,exceptionListItems:t,exceptionListType:n,shouldCloseSingleAlert:r,shouldBulkCloseAlert:o,disableBulkClose:p,alertData:E,alertStatus:x,onDisableBulkClose:k,onUpdateBulkCloseIndex:S,onBulkCloseCheckboxChange:w,onSingleAlertCloseCheckboxChange:j})=>{const{loading:O,signalIndexName:I}=Object(l.a)(),T=Object(a.useMemo)((()=>null!==I?[I]:[]),[I]),[C,{indexPatterns:M}]=Object(c.b)(T),N=Object(a.useCallback)((e=>{w(e.currentTarget.checked)}),[w]),D=Object(a.useCallback)((e=>{null!=j&&j(e.currentTarget.checked)}),[j]);return Object(a.useEffect)((()=>{S(o&&null!=T?T:void 0)}),[T,S,o]),Object(a.useEffect)((()=>{!0===p&&w(!1)}),[p,w]),Object(a.useEffect)((()=>{!1===C&&!1===O&&k((e=>{for(const{entries:t}of e)for(const e of null!=t?t:[])if(Object(d.i)(e)===u.d.LIST)return!0;return!1})(t)||((e,t)=>{const n=e=>t.fields.some((({name:t})=>t===e.field));if(0===e.length)return!1;for(const{entries:t}of e)for(const e of null!=t?t:[])if("nested"===e.type){for(const t of e.entries)if(!1===n(t))return!0}else if(!1===n(e))return!0;return!1})(t,M)||t.every((e=>0===e.entries.length)))}),[k,t,C,O,M]),i.a.createElement(h,null,i.a.createElement(v,{size:"xs"},i.a.createElement("h3",null,m)),i.a.createElement(s.EuiSpacer,{size:"s"}),null!=E&&"closed"!==x&&i.a.createElement(s.EuiFormRow,{fullWidth:!0},i.a.createElement(s.EuiCheckbox,{"data-test-subj":"closeAlertOnAddExceptionCheckbox",id:"close-alert-on-add-add-exception-checkbox",label:g,checked:r,onChange:D,disabled:O||C||e})),i.a.createElement(s.EuiFormRow,{fullWidth:!0},i.a.createElement(s.EuiCheckbox,{"data-test-subj":"bulkCloseAlertOnAddExceptionCheckbox",id:"bulk-close-alert-on-add-add-exception-checkbox",label:p?f:b,checked:o,onChange:N,disabled:p||O||C||e})),"endpoint"===n&&i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiSpacer,{size:"s"}),i.a.createElement(s.EuiText,{"data-test-subj":"addExceptionEndpointText",color:"subdued",size:"s"},y)))},x=i.a.memo(E);x.displayName="ExceptionItemsFlyoutAlertsActions"},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(4),i=n(193),r=n(478),o=n(274),s=n(207),l=n(45),c=n(77);var u=n(190),d=n(14),p=n(0);const m=p.i18n.translate("xpack.securitySolution.ruleExceptions.logic.closeAlerts.error",{defaultMessage:"Failed to close alerts"});var g=n(84);const f=()=>{const{addSuccess:e,addError:t,addWarning:n}=Object(g.a)(),[f,b]=Object(a.useState)(!1),y=Object(a.useRef)(null);return Object(a.useEffect)((()=>{let a=!0;const g=new AbortController;return y.current=async(f,y,h,v)=>{try{var E,x,k,S,w,j,O,I;let t,m;if(b(!0),null!=h&&(t=await Object(i.j)({query:Object(r.a)([h]),status:"closed",signal:g.signal})),null!=v){const e=Object(o.b)(["open","acknowledged","in-progress"]),t=await(async(e,t,n,a,i,r=!0)=>{const o={fields:[],title:a.join()},{filter:u}=await Object(s.p)({http:c.b.get().http,exceptions:i,excludeExceptions:r,chunkSize:10}),d={query:e,language:t},p=((e,t)=>null!=t?[...e,t]:[...e])(n,u);return Object(l.buildEsQuery)(o,d,p,{allowLeadingWildcards:!0,queryStringOptions:{analyze_wildcard:!0},ignoreFilterIfFieldNotInIndex:!1,dateFormatTZ:"Zulu"})})("","kuery",[...f.flatMap((e=>Object(o.c)(e))),...e],v,Object(u.l)(y),!1);m=await Object(i.j)({query:{query:t},status:"closed",signal:g.signal})}const C=(null!==(E=null===(x=t)||void 0===x?void 0:x.updated)&&void 0!==E?E:0)+(null!==(k=null===(S=m)||void 0===S?void 0:S.updated)&&void 0!==k?k:0),M=null!==(w=null===(j=t)||void 0===j?void 0:j.version_conflicts)&&void 0!==w?w:0+(null!==(O=null===(I=m)||void 0===I?void 0:I.version_conflicts)&&void 0!==O?O:0);a&&(b(!1),e((T=C,p.i18n.translate("xpack.securitySolution.ruleExceptions.logic.closeAlerts.success",{values:{numAlerts:T},defaultMessage:"Successfully updated {numAlerts} {numAlerts, plural, =1 {alert} other {alerts}}"}))),M>0&&n({title:d.f(M),text:d.g(C,M)}))}catch(e){a&&(b(!1),t(e,{title:m}))}var T},()=>{a=!1,g.abort()}}),[e,t,n]),[f,y.current]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}));var a=n(4),i=n(126),r=n(85),o=n(0);const s=o.i18n.translate("xpack.securitySolution.networkDetails.errorSearchDescription",{defaultMessage:"An error has occurred on network details search"});o.i18n.translate("xpack.securitySolution.networkDetails.failSearchDescription",{defaultMessage:"Failed to run search on network details"});var l=n(130);const c="networkDetailsQuery",u=({filterQuery:e,id:t=c,indexNames:n,ip:o,skip:u})=>{const{loading:d,result:p,search:m,refetch:g,inspect:f}=Object(l.a)({factoryQueryType:r.q.details,initialResult:{networkDetails:{}},errorMessage:s,abort:u}),b=Object(a.useMemo)((()=>({networkDetails:p.networkDetails,id:t,inspect:f,isInspected:!1,refetch:g})),[t,f,g,p.networkDetails]),y=Object(a.useMemo)((()=>({defaultIndex:n,factoryQueryType:r.q.details,filterQuery:Object(i.a)(e),ip:o})),[e,n,o]);return Object(a.useEffect)((()=>{!u&&y&&m(y)}),[y,m,u]),[d,b]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(4),i=n.n(a),r=n(32),o=n(8),s=n(205),l=n(316);const c=()=>document.querySelector('[tour-step="create-case-submit"]'),u=()=>{const[e,t]=Object(a.useState)(s.a.createCase),n=Object(a.useCallback)((()=>{var e;null===(e=c())||void 0===e||e.scrollIntoView()}),[]),r=Object(a.useCallback)((()=>{t(s.a.submitCase),n(),setTimeout((()=>{var e;null===(e=c())||void 0===e||e.focus()}),500)}),[n]);return i.a.createElement(i.a.Fragment,null,e===s.a.createCase&&i.a.createElement(l.a,{onClick:r,step:s.a.createCase,tourId:s.b.alertsCases}),e===s.a.submitCase&&i.a.createElement(l.a,{step:s.a.submitCase,tourId:s.b.alertsCases}))};var d=n(403),p=n(77),m=n(118);const g=({onMenuItemClick:e,ariaLabel:t,ecsData:n,nonEcsData:l,onSuccess:c,isActiveTimelines:g,isInDetections:f})=>{const{cases:b}=Object(p.k)().services,y=Object(p.i)(),h=Object(a.useMemo)((()=>{var e,t;return null==n||null===(e=n.event)||void 0===e||null===(t=e.kind)||void 0===t?void 0:t.includes("signal")}),[n]),v=Object(a.useMemo)((()=>{var e,t;return null!=n&&n._id?[{alertId:null!==(e=null==n?void 0:n._id)&&void 0!==e?e:"",index:null!==(t=null==n?void 0:n._index)&&void 0!==t?t:"",type:o.CommentType.alert,rule:b.helpers.getRuleIdFromEvent({ecs:n,data:null!=l?l:[]})}]:[]}),[b.helpers,n,l]),{activeStep:E,incrementStep:x,setStep:k,isTourShown:S}=Object(d.b)(),w=Object(a.useCallback)((async()=>{S(s.b.alertsCases)&&k(s.b.alertsCases,s.a.viewCase)}),[k,S]),j=Object(a.useMemo)((()=>!S(s.b.alertsCases)||E!==s.a.addAlertToCase&&E!==s.a.createCase&&E!==s.a.submitCase?{}:{initialValue:s.d}),[E,S]),O=b.hooks.getUseCasesAddToNewCaseFlyout({onClose:e,onSuccess:c,afterCaseCreated:w,...j}),I=b.hooks.getUseCasesAddToExistingCaseModal({onClose:e,onRowClick:c}),T=Object(a.useCallback)((()=>{e(),O.open({attachments:v,...S(s.b.alertsCases)?{headerContent:i.a.createElement(u,null)}:{}}),S(s.b.alertsCases)&&E===s.a.addAlertToCase&&x(s.b.alertsCases)}),[e,O,v,S,E,x]),C=Object(a.useCallback)((()=>{e(),I.open({attachments:v})}),[v,e,I]);return{addToCaseActionItems:Object(a.useMemo)((()=>(g||f)&&y.create&&y.read&&h?[i.a.createElement(r.EuiContextMenuItem,{"aria-label":t,"data-test-subj":"add-to-existing-case-action",key:"add-to-existing-case-action",onClick:C,size:"s"},m.i),i.a.createElement(r.EuiContextMenuItem,{"aria-label":t,"data-test-subj":"add-to-new-case-action",key:"add-to-new-case-action",onClick:T,size:"s"},m.j)]:[]),[t,C,T,y.create,y.read,f,g,h]),handleAddToNewCaseClick:T}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return f}));var a=n(32),i=n(4),r=n.n(i),o=n(121);const s=r.a.memo((({onClick:e})=>r.a.createElement(a.EuiButtonEmpty,{color:"text","data-test-subj":"open-timeline-button",iconSide:"left",iconType:"folderOpen",onClick:e},o.E)));s.displayName="OpenTimelineModalButton";var l=n(606),c=n(242),u=n(387),d=n(858);const p="add-timeline-button",m=["createFrom"],g=({timelineId:e})=>{const[t,n]=Object(i.useState)(!1),[o,g]=Object(i.useState)(!1),f=Object(i.useCallback)((()=>n(!t)),[t]),b=Object(i.useCallback)((()=>n(!1)),[]),y=Object(i.useCallback)((()=>g(!1)),[]),h=Object(i.useCallback)((()=>{b(),g(!0)}),[b]),v=Object(i.useMemo)((()=>r.a.createElement(a.EuiButtonIcon,{className:p,"data-test-subj":"settings-plus-in-circle",iconType:"plusInCircle",color:"primary",size:"m",onClick:f,"aria-label":c.a})),[f]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiPopover,{anchorPosition:"downRight",button:v,id:"timelineSettingsPopover",panelProps:{"data-test-subj":"timeline-addPopupPanel"},isOpen:t,closePopover:b,ownFocus:!0,repositionOnScroll:!0},r.a.createElement(a.EuiFlexGroup,{alignItems:"flexStart",direction:"column",gutterSize:"none"},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(u.c,{timelineId:e,title:c.h,closeGearMenu:b})),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(d.a,{closeGearMenu:b,timelineId:e,title:c.g})),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(s,{onClick:h}))))),o?r.a.createElement(l.a,{onClose:y,hideActions:m}):null)},f=r.a.memo(g)},function(e,t,n){"use strict";n.d(t,"a",(function(){return R}));var a=n(4),i=n.n(a),r=n(32),o=n(33),s=n.n(o),l=n(198),c=n(0);const u=c.i18n.translate("xpack.securitySolution.overview.landingCards.box.siem.header",{defaultMessage:"Elastic Security"}),d=c.i18n.translate("xpack.securitySolution.overview.landingCards.box.siem.title",{defaultMessage:"Security at the speed of Elastic"}),p=c.i18n.translate("xpack.securitySolution.overview.landingCards.box.siem.desc",{defaultMessage:"Elastic Security equips teams to prevent, detect, and respond to threats at cloud speed and scale â€” securing business operations with a unified, open platform."}),m=c.i18n.translate("xpack.securitySolution.overview.landingCards.box.siem.cta",{defaultMessage:"Add security integrations"}),g=c.i18n.translate("xpack.securitySolution.overview.landingCards.box.endpoint.title",{defaultMessage:"Endpoint security at scale"}),f=c.i18n.translate("xpack.securitySolution.overview.landingCards.box.endpoint.desc",{defaultMessage:"Prevent, collect, detect and respond â€” all with Elastic Agent."}),b=c.i18n.translate("xpack.securitySolution.overview.landingCards.box.siemCard.title",{defaultMessage:"SIEM for the modern SOC"}),y=c.i18n.translate("xpack.securitySolution.overview.landingCards.box.siemCard.desc",{defaultMessage:"Detect, investigate, and respond to evolving threats in your environment."}),h=c.i18n.translate("xpack.securitySolution.overview.landingCards.box.cloudCard.title",{defaultMessage:"Cloud protection end-to-end"}),v=c.i18n.translate("xpack.securitySolution.overview.landingCards.box.cloudCard.desc",{defaultMessage:"Assess your Cloud Posture and protect your workloads from attacks."}),E=c.i18n.translate("xpack.securitySolution.overview.landingCards.box.unify.title",{defaultMessage:"Unify SIEM, endpoint security, and cloud security"}),x=c.i18n.translate("xpack.securitySolution.overview.landingCards.box.unify.desc",{defaultMessage:"Elastic Security modernizes security operations â€” enabling analytics across years of data, automating key processes, and protecting every host."});var k=n(940),S=n.n(k),w=n(941),j=n.n(w),O=n(942),I=n.n(O),T=n(1),C=n(77);const M={cloud:j.a,siem:I.a,endpoint:S.a},N=s()(r.EuiCard).withConfig({displayName:"StyledEuiCard",componentId:"sc-1d1l7kb-0"})(["span.euiTitle{font-size:36px;line-height:100%;}"]),D=s()(r.EuiCard).withConfig({displayName:"StyledEuiCardTop",componentId:"sc-1d1l7kb-1"})(["span.euiTitle{font-size:36px;line-height:100%;}max-width:600px;display:block;margin:20px auto 0;"]),F=s()(r.EuiPageHeader).withConfig({displayName:"StyledEuiPageHeader",componentId:"sc-1d1l7kb-2"})(["h1{font-size:18px;}"]),A=s()(r.EuiCard).withConfig({displayName:"StyledImgEuiCard",componentId:"sc-1d1l7kb-3"})(["img{margin-top:20px;max-width:400px;}"]),_=s()(r.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-1d1l7kb-4"})(["background:",";padding:20px;margin:-12px !important;"],(({theme:e})=>e.eui.euiColorLightestShade)),R=Object(a.memo)((()=>{const{http:{basePath:{prepend:e}},cloudExperiments:t}=Object(C.k)().services,[n,o]=Object(a.useState)(T.a);Object(l.c)(t,"security-solutions.add-integrations-url",T.a,o);const s=Object(a.useMemo)((()=>e(n)),[e,n]);return i.a.createElement(r.EuiFlexGroup,{"data-test-subj":"siem-landing-page",direction:"column",gutterSize:"l"},i.a.createElement(r.EuiFlexItem,null,i.a.createElement(r.EuiFlexGroup,{gutterSize:"l"},i.a.createElement(r.EuiFlexItem,null,i.a.createElement(F,{pageTitle:u,iconType:"logoSecurity"}),i.a.createElement(N,{display:"plain",description:p,textAlign:"left",title:d,footer:i.a.createElement(r.EuiButton,{"data-test-subj":"add-integrations-header",href:s},m)})),i.a.createElement(r.EuiFlexItem,null,i.a.createElement("iframe",{allowFullScreen:!0,allowTransparency:!0,className:"vidyard_iframe",frameBorder:"0",height:"100%",referrerPolicy:"no-referrer",sandbox:"allow-scripts allow-same-origin",scrolling:"no",src:"//play.vidyard.com/K6kKDBbP9SpXife9s2tHNP.html?",title:u,width:"100%"})))),i.a.createElement(_,null,i.a.createElement(r.EuiFlexGroup,{gutterSize:"m"},i.a.createElement(r.EuiFlexItem,null,i.a.createElement(A,{hasBorder:!0,description:y,image:M.siem,textAlign:"center",title:b})),i.a.createElement(r.EuiFlexItem,null,i.a.createElement(A,{hasBorder:!0,description:f,image:M.endpoint,textAlign:"center",title:g})),i.a.createElement(r.EuiFlexItem,null,i.a.createElement(A,{hasBorder:!0,description:v,image:M.cloud,textAlign:"center",title:h})))),i.a.createElement(r.EuiFlexItem,null,i.a.createElement(D,{display:"plain",description:x,paddingSize:"l",textAlign:"center",title:E,footer:i.a.createElement(r.EuiButton,{"data-test-subj":"add-integrations-footer",href:s},m)})))}));R.displayName="LandingCards"},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(4),i=n.n(a),r=n(32),o=n(0);const s=o.i18n.translate("xpack.securitySolution.rule_exceptions.itemMeta.nameLabel",{defaultMessage:"Exception name"}),l=o.i18n.translate("xpack.securitySolution.rule_exceptions.itemMeta.namePlaceholder",{defaultMessage:"Name your exception"}),c=({exceptionItemName:e,onChange:t})=>{const n=Object(a.useCallback)((e=>{t(["name",e.target.value])}),[t]);return i.a.createElement(r.EuiFormRow,{label:s,"data-test-subj":"exceptionFlyoutName"},i.a.createElement(r.EuiFieldText,{placeholder:l,value:e,onChange:n,"data-test-subj":"exceptionFlyoutNameInput"}))},u=i.a.memo(c);u.displayName="ExceptionsFlyoutMeta"},function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));var a=n(4),i=n.n(a),r=n(32),o=n(66),s=n(93),l=n(33),c=n.n(l),u=n(110),d=n(166),p=n(77),m=n(0);const g=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.itemConditions.conditionsTitle",{defaultMessage:"Conditions"}),f=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.itemConditions.infoLabel",{defaultMessage:"Alerts are generated when the rule's conditions are met, except when:"}),b=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.itemConditions.sequenceWarningAdd",{defaultMessage:"This rule's query contains an EQL sequence statement. The exception created will apply to all events in the sequence."}),y=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.itemConditions.sequenceWarningEdit",{defaultMessage:"This rule's query contains an EQL sequence statement. The exception modified will apply to all events in the sequence."}),h=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.itemConditions.operatingSystemPlaceHolder",{defaultMessage:"Select an operating system"});var v=n(361);const E=[{label:v.g,value:["windows"]},{label:v.f,value:["macos"]},{label:v.e,value:["linux"]},{label:v.h,value:["windows","macos"]}],x=c()(r.EuiTitle).withConfig({displayName:"SectionHeader",componentId:"sc-t4gsg-0"})(["",""],(()=>Object(l.css)(["font-weight:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold)))),k=Object(l.createGlobalStyle)(['[data-test-subj="comboBoxOptionsList osSelectionDropdown-optionsList"]{z-index:6000 !important;}']),S=({exceptionItemName:e,allowLargeValueLists:t,exceptionListItems:n,indexPatterns:l,rules:c,exceptionListType:m,showOsTypeOptions:S,selectedOs:w,isEdit:j,onOsChange:O,onExceptionItemAdd:I,onSetErrorExists:T,onFilterIndexPatterns:C})=>{const{http:M,unifiedSearch:N}=Object(p.k)().services,D=Object(a.useMemo)((()=>m===s.b.ENDPOINT),[m]),F=Object(a.useMemo)((()=>null!=c&&c.some((e=>Object(d.b)(e.type)&&Object(d.a)(e.query)))),[c]),A=Object(a.useMemo)((()=>{if(D)return"endpoint_list";const e=D?u.j:void 0;return j?n[0].list_id:e}),[D,j,n]),_=Object(a.useMemo)((()=>{const e=D?"agnostic":void 0;return j?n[0].namespace_type:e}),[n,j,D]),R=Object(a.useCallback)((({exceptionItems:e,errorExists:t})=>{I(e),T(t)}),[T,I]),P=Object(a.useCallback)((e=>{const t=e[0].value;null!=O&&O(t||void 0)}),[O]),L=Object(a.useMemo)((()=>({asPlainText:!0})),[]),q=Object(a.useMemo)((()=>E.filter((e=>w===e.value))),[w]),B=Object(a.useMemo)((()=>S&&void 0===w),[S,w]),z=Object(a.useMemo)((()=>j?y:b),[j]),$=Object(a.useMemo)((()=>{var e;return null!==(e=j?n[0].os_types:w)&&void 0!==e?e:[]}),[n,j,w]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(x,{size:"xs"},i.a.createElement("h3",null,g)),F&&i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiCallOut,{"data-test-subj":"eqlSequenceCallout",title:z}),i.a.createElement(r.EuiSpacer,null)),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(r.EuiText,{size:"s"},f),i.a.createElement(r.EuiSpacer,{size:"s"}),S&&!j&&i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiFormRow,{label:v.d},i.a.createElement(r.EuiComboBox,{placeholder:h,singleSelection:L,options:E,selectedOptions:q,onChange:P,isClearable:!1,"data-test-subj":"osSelectionDropdown"})),i.a.createElement(k,null),i.a.createElement(r.EuiSpacer,{size:"l"})),S&&j&&i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiText,{size:"xs","data-test-subj":"exceptionItemSelectedOs"},i.a.createElement("dl",null,i.a.createElement("dt",null,v.d),i.a.createElement("dd",null,(e=>e.reduce(((e,t)=>`${(e=>"linux"===e?v.e:"macos"===e?v.f:v.g)(t)}, ${e}`),"").slice(0,-2))($)))),i.a.createElement(r.EuiSpacer,null)),Object(o.getExceptionBuilderComponentLazy)({allowLargeValueLists:t,httpService:M,autocompleteService:N.autocomplete,exceptionListItems:n,listType:m,osTypes:$,listId:A,listNamespaceType:_,listTypeSpecificIndexPatternFilter:C,exceptionItemName:e,indexPatterns:l,isOrDisabled:B,isAndDisabled:B,isNestedDisabled:B,dataTestSubj:"alertExceptionBuilder",idAria:"alertExceptionBuilder",onChange:R,isDisabled:B,allowCustomFieldOptions:!D}))},w=i.a.memo(S);w.displayName="ExceptionsConditions"},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(84),i=n(392),r=n(300);const o=(e,t)=>{const{addError:n}=Object(a.a)();return Object(i.a)(e,{onError:e=>n(e,{title:r.b}),...t})},s=e=>{const{pagination:t,filterOptions:n,sortingOptions:a,isInMemorySorting:i,refetchInterval:r}=e,s=o({pagination:{page:1,perPage:1e4},filterOptions:n},{refetchInterval:r,enabled:i,keepPreviousData:!0}),l=o({pagination:t,filterOptions:n,sortingOptions:a},{refetchInterval:r,enabled:!i,keepPreviousData:!0});return i?s:l}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(4),i=n.n(a),r=n(77),o=n(32);const s=({url:e,children:t,ariaLabel:n})=>t?i.a.createElement(o.EuiToolTip,{content:e,position:"top","data-test-subj":"externalLinkTooltip"},i.a.createElement(o.EuiLink,{href:e,"aria-label":n,external:!0,target:"_blank",rel:"noopener","data-test-subj":"externalLink"},t)):null;var l=n(678);const c=({guidePath:e="security",docPath:t,linkText:n})=>{const{services:a}=Object(r.k)(),{ELASTIC_WEBSITE_URL:o,DOC_LINK_VERSION:c}=a.docLinks,u=`${o}guide/en/${e}/${c}/${t}`,d=`${n} - ${l.a}`;return i.a.createElement(s,{url:u,ariaLabel:d},n)},u=Object(a.memo)(c)},function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));var a=n(82),i=n.n(a),r=n(4),o=n.n(r),s=n(32),l=n(0),c=n(35),u=n(33),d=n.n(u),p=n(323),m=n(153),g=n(91),f=n(240),b=n(187);const y=()=>{},h={bordered:!0,showIcons:!1},v={className:"effected-policies-search"},E=d.a.div.withConfig({displayName:"StyledEuiSelectable",componentId:"sc-zldyw-0"})([".effected-policies-search{border-bottom-left-radius:0;border-bottom-right-radius:0;}.euiSelectableList{border-top-left-radius:0;border-top-right-radius:0;border-top-width:0;}"]),x=d()(s.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItemButtonGroup",componentId:"sc-zldyw-1"})(["@media only screen and (max-width:","){align-items:center;}"],(e=>e.theme.eui.euiBreakpoints.m)),k=d()(s.EuiButtonGroup).withConfig({displayName:"StyledButtonGroup",componentId:"sc-zldyw-2"})(["display:flex;justify-content:right;.euiButtonGroupButton{padding-right:",";}"],(e=>e.theme.eui.euiSizeL)),S=d.a.div.withConfig({displayName:"EffectivePolicyFormContainer",componentId:"sc-zldyw-3"})([".policy-name .euiSelectableListItem__text{text-decoration:none !important;color:"," !important;}"],(e=>e.theme.eui.euiTextColor)),w=Object(r.memo)((({isGlobal:e,isPlatinumPlus:t,description:n,isLoading:a=!1,onChange:u,listProps:d,options:w,selected:j=[],disabled:O=!1,"data-test-subj":I,...T})=>{const{getAppUrl:C}=Object(f.b)(),M=Object(g.a)(I),N=Object(r.useMemo)((()=>[{id:"globalPolicy",label:l.i18n.translate("xpack.securitySolution.endpoint.effectedPolicySelect.global",{defaultMessage:"Global"}),iconType:e?"checkInCircleFilled":"empty","data-test-subj":M("global")},{id:"perPolicy",label:l.i18n.translate("xpack.securitySolution.endpoint.effectedPolicySelect.perPolicy",{defaultMessage:"Per Policy"}),iconType:e?"empty":"checkInCircleFilled","data-test-subj":M("perPolicy")}]),[M,e]),D=Object(r.useMemo)((()=>{const n=new Set(j.map((e=>e.id)));return w.map((a=>({label:a.name,className:"policy-name",prepend:o.a.createElement(s.EuiCheckbox,{id:Object(s.htmlIdGenerator)()(),onChange:y,checked:n.has(a.id),disabled:e||!t||O,"data-test-subj":`policy-${a.id}-checkbox`}),append:o.a.createElement(p.a,{href:C({path:Object(m.j)(a.id)}),appPath:Object(m.j)(a.id),target:"_blank"},o.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.effectedPolicySelect.viewPolicyLinkLabel",defaultMessage:"View policy"})),policy:a,checked:n.has(a.id)?"on":void 0,disabled:e||!t||O,"data-test-subj":`policy-${a.id}`}))).sort((({label:e},{label:t})=>e.localeCompare(t)))}),[O,C,e,t,w,j]),F=Object(r.useCallback)((t=>{u({isGlobal:e,selected:t.filter((e=>e.checked)).map((e=>e.policy))})}),[e,u]),A=Object(r.useCallback)((e=>{u({isGlobal:"globalPolicy"===e,selected:j})}),[u,j]),_=Object(r.useCallback)(((e,t)=>o.a.createElement(o.a.Fragment,null,t,e)),[]);return o.a.createElement(S,null,o.a.createElement(s.EuiText,{size:"xs"},o.a.createElement("h3",null,o.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.effectedPolicySelect.assignmentSectionTitle",defaultMessage:"Assignment"}))),o.a.createElement(s.EuiSpacer,{size:"xs"}),o.a.createElement(s.EuiFlexGroup,null,o.a.createElement(s.EuiFlexItem,{grow:2},o.a.createElement(s.EuiText,{size:"s"},o.a.createElement("p",null,n||l.i18n.translate("xpack.securitySolution.effectedPolicySelect.assignmentSectionDescription",{defaultMessage:"Assign globally across all policies, or assign it to specific policies."})))),o.a.createElement(x,{grow:1},o.a.createElement(s.EuiFormRow,{fullWidth:!0,isDisabled:O},o.a.createElement(k,{legend:"Global Policy Toggle",options:N,idSelected:e?"globalPolicy":"perPolicy",onChange:A,color:"primary","data-test-subj":M("byPolicyGlobalButtonGroup"),isDisabled:O})))),o.a.createElement(s.EuiSpacer,null),!e&&(a?o.a.createElement(b.a,{size:"l","data-test-subj":M("policiesLoader")}):o.a.createElement(s.EuiFormRow,{fullWidth:!0},o.a.createElement(E,null,o.a.createElement(s.EuiSelectable,i()({},T,{options:D,listProps:d||h,onChange:F,searchProps:v,searchable:!0,"data-test-subj":M("policiesSelectable")}),_)))))}));w.displayName="EffectedPolicySelect"},function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n(4),i=n.n(a),r=n(595),o=n(32),s=n(35),l=n(33);const c=n.n(l).a.p.withConfig({displayName:"P",componentId:"sc-1p4er2f-0"})(["margin-bottom:5px;"]);c.displayName="P";const u=i.a.memo((({maybeDurationNanoseconds:e,tooltipTitle:t})=>i.a.createElement(i.a.Fragment,null,null!=t?i.a.createElement(c,{"data-test-subj":"title"},t):null,i.a.createElement(c,{"data-test-subj":"humanized"},Object(r.c)(e)),i.a.createElement(c,{"data-test-subj":"raw-value"},i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.formattedDuration.tooltipLabel",defaultMessage:"raw"}),": ",e))));u.displayName="FormattedDurationTooltipContent";const d=i.a.memo((({children:e,maybeDurationNanoseconds:t,tooltipTitle:n})=>i.a.createElement(o.EuiToolTip,{"data-test-subj":"formatted-duration-tooltip",content:i.a.createElement(u,{maybeDurationNanoseconds:t,tooltipTitle:n})},i.a.createElement(i.a.Fragment,null,e))));d.displayName="FormattedDurationTooltip";const p=i.a.memo((({maybeDurationNanoseconds:e,tooltipTitle:t})=>i.a.createElement(d,{maybeDurationNanoseconds:e,tooltipTitle:t},i.a.createElement("div",{"data-test-subj":"formatted-duration"},Object(r.b)(e)))));p.displayName="FormattedDuration"},function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n(4),i=n(129),r=n(171),o=n(259),s=n(84),l=n(77),c=n(120),u=n(389);const d=Object(i.d)((async({http:e,jobIds:t,signal:n})=>e.fetch("/api/ml/jobs/jobs",{method:"POST",body:JSON.stringify({jobIds:t}),asSystemRequest:!0,signal:n}))),p=e=>{const[t,n]=Object(a.useState)([]),{addError:p}=Object(s.a)(),m=Object(c.a)(),g=Object(l.j)(),{error:f,loading:b,result:y,start:h}=Object(i.a)(d),v=Object(r.a)(m),E=Object(o.a)(m);return Object(a.useEffect)((()=>{v&&E&&e.length>0&&h({http:g,jobIds:e})}),[g,v,E,h,e]),Object(a.useEffect)((()=>{y&&n(y)}),[y]),Object(a.useEffect)((()=>{f&&p(f,{title:u.a})}),[p,f]),{isLicensed:E,isMlUser:v,jobs:t,loading:b}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var a=n(93);const i=["endpoint_list"],r=e=>!!i.find((t=>t===e.list_id)),o=e=>a.o.is(e)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(63),n(425),n(426);var a=n(734).default({key:"css"}),i=a.flush,r=a.hydrate,o=a.cx,s=a.merge,l=a.getRegisteredStyles,c=a.injectGlobal,u=a.keyframes,d=a.css,p=a.sheet,m=a.cache;t.cache=m,t.css=d,t.cx=o,t.flush=i,t.getRegisteredStyles=l,t.hydrate=r,t.injectGlobal=c,t.keyframes=u,t.merge=s,t.sheet=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(727),i=n(729),r=n(731);function o(e){return e&&e.__esModule?e:{default:e}}var s=o(a),l=o(i),c=/[A-Z]|^ms/g,u=/_EMO_([^_]+?)_([^]*?)_EMO_/g,d=function(e){return 45===e.charCodeAt(1)},p=function(e){return null!=e&&"boolean"!=typeof e},m=o(r).default((function(e){return d(e)?e:e.replace(c,"-$&").toLowerCase()})),g=function(e,t){switch(e){case"animation":case"animationName":if("string"==typeof t)return t.replace(u,(function(e,t,n){return b={name:t,styles:n,next:b},t}))}return 1===l.default[e]||d(e)||"number"!=typeof t||0===t?t:t+"px"};function f(e,t,n){if(null==n)return"";if(void 0!==n.__emotion_styles)return n;switch(typeof n){case"boolean":return"";case"object":if(1===n.anim)return b={name:n.name,styles:n.styles,next:b},n.name;if(void 0!==n.styles){var a=n.next;if(void 0!==a)for(;void 0!==a;)b={name:a.name,styles:a.styles,next:b},a=a.next;return n.styles+";"}return function(e,t,n){var a="";if(Array.isArray(n))for(var i=0;i<n.length;i++)a+=f(e,t,n[i])+";";else for(var r in n){var o=n[r];if("object"!=typeof o)null!=t&&void 0!==t[o]?a+=r+"{"+t[o]+"}":p(o)&&(a+=m(r)+":"+g(r,o)+";");else if(!Array.isArray(o)||"string"!=typeof o[0]||null!=t&&void 0!==t[o[0]]){var s=f(e,t,o);switch(r){case"animation":case"animationName":a+=m(r)+":"+s+";";break;default:a+=r+"{"+s+"}"}}else for(var l=0;l<o.length;l++)p(o[l])&&(a+=m(r)+":"+g(r,o[l])+";")}return a}(e,t,n);case"function":if(void 0!==e){var i=b,r=n(e);return b=i,f(e,t,r)}}if(null==t)return n;var o=t[n];return void 0!==o?o:n}var b,y=/label:\s*([^\s;\n{]+)\s*(;|$)/g;t.serializeStyles=function(e,t,n){if(1===e.length&&"object"==typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var a=!0,i="";b=void 0;var r=e[0];null==r||void 0===r.raw?(a=!1,i+=f(n,t,r)):i+=r[0];for(var o=1;o<e.length;o++)i+=f(n,t,e[o]),a&&(i+=r[o]);y.lastIndex=0;for(var l,c="";null!==(l=y.exec(i));)c+="-"+l[1];return{name:s.default(i)+c,styles:i,next:b}}},function(e,t,n){"use strict";e.exports=n(728)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t,n=0,a=0,i=e.length;i>=4;++a,i-=4)t=1540483477*(65535&(t=255&e.charCodeAt(a)|(255&e.charCodeAt(++a))<<8|(255&e.charCodeAt(++a))<<16|(255&e.charCodeAt(++a))<<24))+(59797*(t>>>16)<<16),n=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(i){case 3:n^=(255&e.charCodeAt(a+2))<<16;case 2:n^=(255&e.charCodeAt(a+1))<<8;case 1:n=1540483477*(65535&(n^=255&e.charCodeAt(a)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)}},function(e,t,n){"use strict";e.exports=n(730)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1}},function(e,t,n){"use strict";e.exports=n(732)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=Object.create(null);return function(n){return void 0===t[n]&&(t[n]=e(n)),t[n]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a="undefined"!=typeof document,i=function(e,t,n){var i=e.key+"-"+t.name;(!1===n||!1===a&&void 0!==e.compat)&&void 0===e.registered[i]&&(e.registered[i]=t.styles)};t.getRegisteredStyles=function(e,t,n){var a="";return n.split(" ").forEach((function(n){void 0!==e[n]?t.push(e[n]+";"):a+=n+" "})),a},t.insertStyles=function(e,t,n){i(e,t,n);var r=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var o="",s=t;do{var l=e.insert(t===s?"."+r:"",s,e.sheet,!0);a||void 0===l||(o+=l),s=s.next}while(void 0!==s);if(!a&&0!==o.length)return o}},t.registerStyles=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(63),i=n(425),r=n(426);function o(e){return e&&e.__esModule?e:{default:e}}var s=o(a);function l(e,t){if(void 0===e.inserted[t.name])return e.insert("",t,e.sheet,!0)}function c(e,t,n){var a=[],i=r.getRegisteredStyles(e,a,n);return a.length<2?n:i+t(a)}var u=function e(t){for(var n="",a=0;a<t.length;a++){var i=t[a];if(null!=i){var r=void 0;switch(typeof i){case"boolean":break;case"object":if(Array.isArray(i))r=e(i);else for(var o in r="",i)i[o]&&o&&(r&&(r+=" "),r+=o);break;default:r=i}r&&(n&&(n+=" "),n+=r)}}return n};t.default=function(e){var t=s.default(e);t.sheet.speedy=function(e){this.isSpeedy=e},t.compat=!0;var n=function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];var o=i.serializeStyles(n,t.registered,void 0);return r.insertStyles(t,o,!1),t.key+"-"+o.name};return{css:n,cx:function(){for(var e=arguments.length,a=new Array(e),i=0;i<e;i++)a[i]=arguments[i];return c(t.registered,n,u(a))},injectGlobal:function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];var r=i.serializeStyles(n,t.registered);l(t,r)},keyframes:function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];var r=i.serializeStyles(n,t.registered),o="animation-"+r.name;return l(t,{name:r.name,styles:"@keyframes "+o+"{"+r.styles+"}"}),o},hydrate:function(e){e.forEach((function(e){t.inserted[e]=!0}))},flush:function(){t.registered={},t.inserted={},t.sheet.flush()},sheet:t.sheet,cache:t,getRegisteredStyles:r.getRegisteredStyles.bind(null,t.registered),merge:c.bind(null,t.registered,n)}}},,function(e,t,n){"use strict";const a=n(737),i=n(738);class AggregateError extends Error{constructor(e){if(!Array.isArray(e))throw new TypeError("Expected input to be an Array, got "+typeof e);let t=(e=[...e].map((e=>e instanceof Error?e:null!==e&&"object"==typeof e?Object.assign(new Error(e.message),e):new Error(e)))).map((e=>"string"==typeof e.stack?i(e.stack).replace(/\s+at .*aggregate-error\/index.js:\d+:\d+\)?/g,""):String(e))).join("\n");t="\n"+a(t,4),super(t),this.name="AggregateError",Object.defineProperty(this,"_errors",{value:e})}*[Symbol.iterator](){for(const e of this._errors)yield e}}e.exports=AggregateError},function(e,t,n){"use strict";e.exports=(e,t=1,n)=>{if(n={indent:" ",includeEmptyLines:!1,...n},"string"!=typeof e)throw new TypeError(`Expected \`input\` to be a \`string\`, got \`${typeof e}\``);if("number"!=typeof t)throw new TypeError(`Expected \`count\` to be a \`number\`, got \`${typeof t}\``);if("string"!=typeof n.indent)throw new TypeError(`Expected \`options.indent\` to be a \`string\`, got \`${typeof n.indent}\``);if(0===t)return e;const a=n.includeEmptyLines?/^/gm:/^(?!\s*$)/gm;return e.replace(a,n.indent.repeat(t))}},function(e,t,n){"use strict";const a=n(739),i=/\s+at.*(?:\(|\s)(.*)\)?/,r=/^(?:(?:(?:node|(?:internal\/[\w/]*|.*node_modules\/(?:babel-polyfill|pirates)\/.*)?\w+)\.js:\d+:\d+)|native)/,o=void 0===a.homedir?"":a.homedir();e.exports=(e,t)=>(t=Object.assign({pretty:!1},t),e.replace(/\\/g,"/").split("\n").filter((e=>{const t=e.match(i);if(null===t||!t[1])return!0;const n=t[1];return!n.includes(".app/Contents/Resources/electron.asar")&&!n.includes(".app/Contents/Resources/default_app.asar")&&!r.test(n)})).filter((e=>""!==e.trim())).map((e=>t.pretty?e.replace(i,((e,t)=>e.replace(t,t.replace(o,"~")))):e)).join("\n"))},function(e,t){},,,,,,function(e,t,n){var a=n(432)("set",n(806));a.placeholder=n(456),e.exports=a},function(e,t,n){e.exports=n(27)(3570)},function(e,t,n){e.exports={ary:n(748),assign:n(772),clone:n(773),curry:n(774),forEach:n(445),isArray:n(218),isError:n(775),isFunction:n(449),isWeakMap:n(778),iteratee:n(780),keys:n(798),rearg:n(799),toInteger:n(447),toPath:n(801)}},function(e,t,n){var a=n(329);e.exports=function(e,t,n){return t=n?void 0:t,t=e&&null==t?e.length:t,a(e,128,void 0,void 0,void 0,void 0,t)}},function(e,t,n){e.exports=n(27)(3111)},function(e,t,n){var a=n(269),i=n(270);e.exports=function(e,t,n){var r=1&t,o=a(e);return function t(){var a=this&&this!==i&&this instanceof t?o:e;return a.apply(r?n:this,arguments)}}},function(e,t,n){var a=n(436),i=n(269),r=n(437),o=n(440),s=n(446),l=n(337),c=n(270);e.exports=function(e,t,n){var u=i(e);return function i(){for(var d=arguments.length,p=Array(d),m=d,g=s(i);m--;)p[m]=arguments[m];var f=d<3&&p[0]!==g&&p[d-1]!==g?[]:l(p,g);if((d-=f.length)<n)return o(e,t,r,i.placeholder,void 0,p,f,void 0,void 0,n-d);var b=this&&this!==c&&this instanceof i?u:e;return a(b,this,p)}}},function(e,t){e.exports=function(e,t){for(var n=e.length,a=0;n--;)e[n]===t&&++a;return a}},function(e,t,n){var a=n(332),i=n(441),r=n(755),o=n(757);e.exports=function(e){var t=r(e),n=o[t];if("function"!=typeof n||!(t in a.prototype))return!1;if(e===n)return!0;var s=i(n);return!!s&&e===s[0]}},function(e,t){e.exports=function(){}},function(e,t,n){var a=n(756),i=Object.prototype.hasOwnProperty;e.exports=function(e){for(var t=e.name+"",n=a[t],r=i.call(a,t)?n.length:0;r--;){var o=n[r],s=o.func;if(null==s||s==e)return o.name}return t}},function(e,t){e.exports={}},function(e,t,n){var a=n(332),i=n(442),r=n(333),o=n(218),s=n(334),l=n(758),c=Object.prototype.hasOwnProperty;function u(e){if(s(e)&&!o(e)&&!(e instanceof a)){if(e instanceof i)return e;if(c.call(e,"__wrapped__"))return l(e)}return new i(e)}u.prototype=r.prototype,u.prototype.constructor=u,e.exports=u},function(e,t,n){var a=n(332),i=n(442),r=n(335);e.exports=function(e){if(e instanceof a)return e.clone();var t=new i(e.__wrapped__,e.__chain__);return t.__actions__=r(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}},function(e,t,n){e.exports=n(27)(3436)},function(e,t){var n=/\{\n\/\* \[wrapped with (.+)\] \*/,a=/,? & /;e.exports=function(e){var t=e.match(n);return t?t[1].split(a):[]}},function(e,t){var n=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;e.exports=function(e,t){var a=t.length;if(!a)return e;var i=a-1;return t[i]=(a>1?"& ":"")+t[i],t=t.join(a>2?", ":" "),e.replace(n,"{\n/* [wrapped with "+t+"] */\n")}},function(e,t,n){e.exports=n(27)(3433)},function(e,t,n){var a=n(445),i=n(764),r=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]];e.exports=function(e,t){return a(r,(function(n){var a="_."+n[0];t&n[1]&&!i(e,a)&&e.push(a)})),e.sort()}},function(e,t,n){var a=n(765);e.exports=function(e,t){return!(null==e||!e.length)&&a(e,t,0)>-1}},function(e,t,n){var a=n(766),i=n(767),r=n(768);e.exports=function(e,t,n){return t==t?r(e,t,n):a(e,i,n)}},function(e,t){e.exports=function(e,t,n,a){for(var i=e.length,r=n+(a?1:-1);a?r--:++r<i;)if(t(e[r],r,e))return r;return-1}},function(e,t){e.exports=function(e){return e!=e}},function(e,t){e.exports=function(e,t,n){for(var a=n-1,i=e.length;++a<i;)if(e[a]===t)return a;return-1}},function(e,t,n){var a=n(335),i=n(336),r=Math.min;e.exports=function(e,t){for(var n=e.length,o=r(t.length,n),s=a(e);o--;){var l=t[o];e[o]=i(l,n)?s[l]:void 0}return e}},function(e,t,n){var a=n(436),i=n(269),r=n(270);e.exports=function(e,t,n,o){var s=1&t,l=i(e);return function t(){for(var i=-1,c=arguments.length,u=-1,d=o.length,p=Array(d+c),m=this&&this!==r&&this instanceof t?l:e;++u<d;)p[u]=o[u];for(;c--;)p[u++]=arguments[++i];return a(m,s?n:this,p)}}},function(e,t,n){var a=n(438),i=n(439),r=n(337),o="__lodash_placeholder__",s=Math.min;e.exports=function(e,t){var n=e[1],l=t[1],c=n|l,u=c<131,d=128==l&&8==n||128==l&&256==n&&e[7].length<=t[8]||384==l&&t[7].length<=t[8]&&8==n;if(!u&&!d)return e;1&l&&(e[2]=t[2],c|=1&n?0:4);var p=t[3];if(p){var m=e[3];e[3]=m?a(m,p,t[4]):p,e[4]=m?r(e[3],o):t[4]}return(p=t[5])&&(m=e[5],e[5]=m?i(m,p,t[6]):p,e[6]=m?r(e[5],o):t[6]),(p=t[7])&&(e[7]=p),128&l&&(e[8]=null==e[8]?t[8]:s(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=c,e}},function(e,t,n){e.exports=n(27)(3401)},function(e,t,n){var a=n(448);e.exports=function(e){return a(e,4)}},function(e,t,n){var a=n(329);function i(e,t,n){var r=a(e,8,void 0,void 0,void 0,void 0,void 0,t=n?void 0:t);return r.placeholder=i.placeholder,r}i.placeholder={},e.exports=i},function(e,t,n){var a=n(776),i=n(334),r=n(777);e.exports=function(e){if(!i(e))return!1;var t=a(e);return"[object Error]"==t||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!r(e)}},function(e,t,n){e.exports=n(27)(332)},function(e,t,n){e.exports=n(27)(3426)},function(e,t,n){var a=n(779),i=n(334);e.exports=function(e){return i(e)&&"[object WeakMap]"==a(e)}},function(e,t,n){e.exports=n(27)(760)},function(e,t,n){var a=n(448),i=n(781);e.exports=function(e){return i("function"==typeof e?e:a(e,1))}},function(e,t,n){var a=n(782),i=n(787),r=n(434),o=n(218),s=n(794);e.exports=function(e){return"function"==typeof e?e:null==e?r:"object"==typeof e?o(e)?i(e[0],e[1]):a(e):s(e)}},function(e,t,n){var a=n(783),i=n(785),r=n(452);e.exports=function(e){var t=i(e);return 1==t.length&&t[0][2]?r(t[0][0],t[0][1]):function(n){return n===e||a(n,e,t)}}},function(e,t,n){var a=n(784),i=n(450);e.exports=function(e,t,n,r){var o=n.length,s=o,l=!r;if(null==e)return!s;for(e=Object(e);o--;){var c=n[o];if(l&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++o<s;){var u=(c=n[o])[0],d=e[u],p=c[1];if(l&&c[2]){if(void 0===d&&!(u in e))return!1}else{var m=new a;if(r)var g=r(d,p,u,e,t,m);if(!(void 0===g?i(p,d,3,r,m):g))return!1}}return!0}},function(e,t,n){e.exports=n(27)(1493)},function(e,t,n){var a=n(451),i=n(786);e.exports=function(e){for(var t=i(e),n=t.length;n--;){var r=t[n],o=e[r];t[n]=[r,o,a(o)]}return t}},function(e,t,n){e.exports=n(27)(1136)},function(e,t,n){var a=n(450),i=n(788),r=n(789),o=n(454),s=n(451),l=n(452),c=n(219);e.exports=function(e,t){return o(e)&&s(t)?l(c(e),t):function(n){var o=i(n,e);return void 0===o&&o===t?r(n,e):a(t,o,3)}}},function(e,t,n){e.exports=n(27)(1812)},function(e,t,n){var a=n(790),i=n(791);e.exports=function(e,t){return null!=e&&i(e,t,a)}},function(e,t){e.exports=function(e,t){return null!=e&&t in Object(e)}},function(e,t,n){var a=n(453),i=n(792),r=n(218),o=n(336),s=n(793),l=n(219);e.exports=function(e,t,n){for(var c=-1,u=(t=a(t,e)).length,d=!1;++c<u;){var p=l(t[c]);if(!(d=null!=e&&n(e,p)))break;e=e[p]}return d||++c!=u?d:!!(u=null==e?0:e.length)&&s(u)&&o(p,u)&&(r(e)||i(e))}},function(e,t,n){e.exports=n(27)(1502)},function(e,t,n){e.exports=n(27)(1505)},function(e,t,n){var a=n(795),i=n(796),r=n(454),o=n(219);e.exports=function(e){return r(e)?a(o(e)):i(e)}},function(e,t){e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},function(e,t,n){var a=n(797);e.exports=function(e){return function(t){return a(t,e)}}},function(e,t,n){e.exports=n(27)(1544)},function(e,t,n){e.exports=n(27)(3106)},function(e,t,n){var a=n(329),i=n(800)((function(e,t){return a(e,256,void 0,void 0,void 0,t)}));e.exports=i},function(e,t,n){e.exports=n(27)(3427)},function(e,t,n){var a=n(802),i=n(335),r=n(218),o=n(803),s=n(804),l=n(219),c=n(805);e.exports=function(e){return r(e)?a(e,l):o(e)?[e]:i(s(c(e)))}},function(e,t,n){e.exports=n(27)(1545)},function(e,t,n){e.exports=n(27)(770)},function(e,t,n){e.exports=n(27)(3395)},function(e,t,n){e.exports=n(27)(3397)},function(e,t,n){e.exports=n(807)},function(e,t,n){var a=n(455);e.exports=function(e,t,n){return null==e?e:a(e,t,n)}},function(e,t,n){e.exports=n(27)(1547)},function(e,t,n){var a=n(432)("setWith",n(810));a.placeholder=n(456),e.exports=a},function(e,t,n){e.exports=n(811)},function(e,t,n){var a=n(455);e.exports=function(e,t,n,i){return i="function"==typeof i?i:void 0,null==e?e:a(e,t,n,i)}},function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return d}));var a=n(34),i=n(236),r=n(134),o=n(382),s=n(603),l=n(2);const c=i.b.HostsType.details,u={[r.HostsTableType.hosts]:s.a,[r.HostsTableType.authentications]:s.c,[r.HostsTableType.uncommonProcesses]:s.g,[r.HostsTableType.anomalies]:s.b,[r.HostsTableType.events]:s.d,[r.HostsTableType.risk]:s.e,[r.HostsTableType.sessions]:s.f},d=(e,t)=>{let n=[];if(null!=e.detailName&&(n=[...n,{text:e.detailName,href:t({path:Object(o.a)(e.detailName,""),deepLinkId:l.a.hosts})}]),null!=e.tabName){const t=Object(a.get)("tabName",e);if(!t)return n;n=[...n,{text:u[t],href:""}]}return n}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(84),i=n(338),r=n(300);const o=(e,t=!0)=>{const{addError:n}=Object(a.a)();return Object(i.a)(e,t?{onError:e=>{n(e,{title:r.b})}}:void 0)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(146);const i=["alert.attributes.name","alert.attributes.params.index","alert.attributes.params.threat.tactic.id","alert.attributes.params.threat.tactic.name","alert.attributes.params.threat.technique.id","alert.attributes.params.threat.technique.name","alert.attributes.params.threat.technique.subtechnique.id","alert.attributes.params.threat.technique.subtechnique.name"],r=({showCustomRules:e,showElasticRules:t,filter:n,tags:r,excludeRuleTypes:o=[]})=>{const s=[];if(e&&t||(t?s.push("alert.attributes.params.immutable: true"):e&&s.push("alert.attributes.params.immutable: false")),r.length>0&&s.push(`alert.attributes.tags:(${r.map((e=>`"${Object(a.d)(e)}"`)).join(" AND ")})`),n.length){const e=i.map((e=>`${e}: "${Object(a.d)(n)}"`)).join(" OR ");s.push(`(${e})`)}return o.length&&s.push(`NOT alert.attributes.params.type: (${o.map((e=>`"${Object(a.d)(e)}"`)).join(" OR ")})`),s.join(" AND ")}},function(e,t,n){"use strict";var a,i=(a=n(408))&&"object"==typeof a&&"default"in a?a.default:a,r=n(4);function o(){return o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},o.apply(this,arguments)}e.exports=function(e){var t=void 0===e?{}:e,n=t.ref,a=t.onResize,s=r.useRef(null);n=n||s;var l=r.useState({width:void 0,height:void 0}),c=l[0],u=l[1],d=r.useRef({width:void 0,height:void 0});return r.useEffect((function(){if("object"==typeof n&&null!==n&&n.current instanceof Element){var e=n.current,t=new i((function(e){if(Array.isArray(e)&&e.length){var t=e[0],n=Math.round(t.contentRect.width),i=Math.round(t.contentRect.height);if(d.current.width!==n||d.current.height!==i){var r={width:n,height:i};a?a(r):(d.current.width=n,d.current.height=i,u(r))}}}));return t.observe(e),function(){return t.unobserve(e)}}}),[n,a]),r.useMemo((function(){return o({ref:n},c)}),[n,c?c.width:null,c?c.height:null])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(33),i=n.n(a),r=n(32);const o=i()(r.EuiInMemoryTable).withConfig({displayName:"BasicTable",componentId:"sc-1c8nyx9-0"})(["tbody{th,td{vertical-align:top;}.euiTableCellContent{display:block;}}"]);o.displayName="BasicTable"},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(4),i=n.n(a),r=n(32);const o=({selectedJobIds:e,onSelect:t,title:n,jobIds:o})=>{const[s,l]=Object(a.useState)(!1),c=Object(a.useCallback)((()=>{l(!s)}),[s]),u=Object(a.useCallback)((()=>{l(!1)}),[]),d=Object(a.useCallback)((n=>{const a=null!=e?e:[],i=a.includes(n)?a.filter((e=>e!==n)):[...a,n];t(i)}),[e,t]),p=Object(a.useMemo)((()=>i.a.createElement(r.EuiFilterButton,{disabled:0===o.length,"data-test-subj":"job-id-filter-button",hasActiveFilters:e.length>0,iconType:"arrowDown",isSelected:s,numActiveFilters:e.length,onClick:c,contentProps:{style:{minWidth:112}}},n)),[s,c,n,e.length,o]);return i.a.createElement(r.EuiFilterGroup,null,i.a.createElement(r.EuiPopover,{button:p,isOpen:s,closePopover:u,panelPaddingSize:"none"},i.a.createElement("div",{className:"euiFilterSelect__items"},o.map((t=>i.a.createElement(r.EuiFilterSelectItem,{"data-test-subj":`job-id-filter-item-${t}`,checked:e.includes(t)?"on":void 0,key:t,onClick:()=>d(t)},t))))))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(4),i=n.n(a),r=n(32),o=n(288);const s=[{value:"auto",text:o.g},{value:"hour",text:o.i},{value:"day",text:o.h},{value:"second",text:o.j}],l=({interval:e,onChange:t})=>{const n=Object(a.useCallback)((e=>{t(e.target.value)}),[t]);return i.a.createElement(r.EuiSelect,{"data-test-subj":"selectInterval",prepend:o.f,append:i.a.createElement(r.EuiToolTip,{content:o.k},i.a.createElement(r.EuiIcon,{type:"questionInCircle",color:"subdued"})),options:s,value:e,onChange:n})}},function(e,t,n){"use strict";var a=n(295).compose;t.__esModule=!0,t.composeWithDevTools=function(){if(0!==arguments.length)return"object"==typeof arguments[0]?a:a.apply(null,arguments)},t.devToolsEnhancer=function(){return function(e){return e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.easing={linear:function(e){return e},quadratic:function(e){return e*(-e*e*e+4*e*e-6*e+4)},cubic:function(e){return e*(4*e*e-9*e+6)},elastic:function(e){return e*(33*e*e*e*e-106*e*e*e+126*e*e-67*e+15)},inQuad:function(e){return e*e},outQuad:function(e){return e*(2-e)},inOutQuad:function(e){return e<.5?2*e*e:(4-2*e)*e-1},inCubic:function(e){return e*e*e},outCubic:function(e){return--e*e*e+1},inOutCubic:function(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},inQuart:function(e){return e*e*e*e},outQuart:function(e){return 1- --e*e*e*e},inOutQuart:function(e){return e<.5?8*e*e*e*e:1-8*--e*e*e*e},inQuint:function(e){return e*e*e*e*e},outQuint:function(e){return 1+--e*e*e*e*e},inOutQuint:function(e){return e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e},inSine:function(e){return 1-Math.cos(e*(Math.PI/2))},outSine:function(e){return Math.sin(e*(Math.PI/2))},inOutSine:function(e){return-(Math.cos(Math.PI*e)-1)/2},inExpo:function(e){return Math.pow(2,10*(e-1))},outExpo:function(e){return 1-Math.pow(2,-10*e)},inOutExpo:function(e){return(e/=.5)<1?Math.pow(2,10*(e-1))/2:(e--,(2-Math.pow(2,-10*e))/2)},inCirc:function(e){return 1-Math.sqrt(1-e*e)},outCirc:function(e){return Math.sqrt(1-(e-=1)*e)},inOutCirc:function(e){return(e/=.5)<1?-(Math.sqrt(1-e*e)-1)/2:(e-=2,(Math.sqrt(1-e*e)+1)/2)}}},function(e,t,n){e.exports=function(){"use strict";function e(e,a,i,r,o){!function e(n,a,i,r,o){for(;r>i;){if(r-i>600){var s=r-i+1,l=a-i+1,c=Math.log(s),u=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*u*(s-u)/s)*(l-s/2<0?-1:1);e(n,a,Math.max(i,Math.floor(a-l*u/s+d)),Math.min(r,Math.floor(a+(s-l)*u/s+d)),o)}var p=n[a],m=i,g=r;for(t(n,i,a),o(n[r],p)>0&&t(n,i,r);m<g;){for(t(n,m,g),m++,g--;o(n[m],p)<0;)m++;for(;o(n[g],p)>0;)g--}0===o(n[i],p)?t(n,i,g):t(n,++g,r),g<=a&&(i=g+1),a<=g&&(r=g-1)}}(e,a,i||0,r||e.length-1,o||n)}function t(e,t,n){var a=e[t];e[t]=e[n],e[n]=a}function n(e,t){return e<t?-1:e>t?1:0}var a=function(e){void 0===e&&(e=9),this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function i(e,t,n){if(!n)return t.indexOf(e);for(var a=0;a<t.length;a++)if(n(e,t[a]))return a;return-1}function r(e,t){o(e,0,e.children.length,t,e)}function o(e,t,n,a,i){i||(i=g(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var r=t;r<n;r++){var o=e.children[r];s(i,e.leaf?a(o):o)}return i}function s(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function l(e,t){return e.minX-t.minX}function c(e,t){return e.minY-t.minY}function u(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function d(e){return e.maxX-e.minX+(e.maxY-e.minY)}function p(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function m(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function g(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function f(t,n,a,i,r){for(var o=[n,a];o.length;)if(!((a=o.pop())-(n=o.pop())<=i)){var s=n+Math.ceil((a-n)/i/2)*i;e(t,s,n,a,r),o.push(n,s,s,a)}}return a.prototype.all=function(){return this._all(this.data,[])},a.prototype.search=function(e){var t=this.data,n=[];if(!m(e,t))return n;for(var a=this.toBBox,i=[];t;){for(var r=0;r<t.children.length;r++){var o=t.children[r],s=t.leaf?a(o):o;m(e,s)&&(t.leaf?n.push(o):p(e,s)?this._all(o,n):i.push(o))}t=i.pop()}return n},a.prototype.collides=function(e){var t=this.data;if(!m(e,t))return!1;for(var n=[];t;){for(var a=0;a<t.children.length;a++){var i=t.children[a],r=t.leaf?this.toBBox(i):i;if(m(e,r)){if(t.leaf||p(e,r))return!0;n.push(i)}}t=n.pop()}return!1},a.prototype.load=function(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(var t=0;t<e.length;t++)this.insert(e[t]);return this}var n=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var a=this.data;this.data=n,n=a}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},a.prototype.insert=function(e){return e&&this._insert(e,this.data.height-1),this},a.prototype.clear=function(){return this.data=g([]),this},a.prototype.remove=function(e,t){if(!e)return this;for(var n,a,r,o=this.data,s=this.toBBox(e),l=[],c=[];o||l.length;){if(o||(o=l.pop(),a=l[l.length-1],n=c.pop(),r=!0),o.leaf){var u=i(e,o.children,t);if(-1!==u)return o.children.splice(u,1),l.push(o),this._condense(l),this}r||o.leaf||!p(o,s)?a?(n++,o=a.children[n],r=!1):o=null:(l.push(o),c.push(n),n=0,a=o,o=o.children[0])}return this},a.prototype.toBBox=function(e){return e},a.prototype.compareMinX=function(e,t){return e.minX-t.minX},a.prototype.compareMinY=function(e,t){return e.minY-t.minY},a.prototype.toJSON=function(){return this.data},a.prototype.fromJSON=function(e){return this.data=e,this},a.prototype._all=function(e,t){for(var n=[];e;)e.leaf?t.push.apply(t,e.children):n.push.apply(n,e.children),e=n.pop();return t},a.prototype._build=function(e,t,n,a){var i,o=n-t+1,s=this._maxEntries;if(o<=s)return r(i=g(e.slice(t,n+1)),this.toBBox),i;a||(a=Math.ceil(Math.log(o)/Math.log(s)),s=Math.ceil(o/Math.pow(s,a-1))),(i=g([])).leaf=!1,i.height=a;var l=Math.ceil(o/s),c=l*Math.ceil(Math.sqrt(s));f(e,t,n,c,this.compareMinX);for(var u=t;u<=n;u+=c){var d=Math.min(u+c-1,n);f(e,u,d,l,this.compareMinY);for(var p=u;p<=d;p+=l){var m=Math.min(p+l-1,d);i.children.push(this._build(e,p,m,a-1))}}return r(i,this.toBBox),i},a.prototype._chooseSubtree=function(e,t,n,a){for(;a.push(t),!t.leaf&&a.length-1!==n;){for(var i=1/0,r=1/0,o=void 0,s=0;s<t.children.length;s++){var l=t.children[s],c=u(l),d=(p=e,m=l,(Math.max(m.maxX,p.maxX)-Math.min(m.minX,p.minX))*(Math.max(m.maxY,p.maxY)-Math.min(m.minY,p.minY))-c);d<r?(r=d,i=c<i?c:i,o=l):d===r&&c<i&&(i=c,o=l)}t=o||t.children[0]}var p,m;return t},a.prototype._insert=function(e,t,n){var a=n?e:this.toBBox(e),i=[],r=this._chooseSubtree(a,this.data,t,i);for(r.children.push(e),s(r,a);t>=0&&i[t].children.length>this._maxEntries;)this._split(i,t),t--;this._adjustParentBBoxes(a,i,t)},a.prototype._split=function(e,t){var n=e[t],a=n.children.length,i=this._minEntries;this._chooseSplitAxis(n,i,a);var o=this._chooseSplitIndex(n,i,a),s=g(n.children.splice(o,n.children.length-o));s.height=n.height,s.leaf=n.leaf,r(n,this.toBBox),r(s,this.toBBox),t?e[t-1].children.push(s):this._splitRoot(n,s)},a.prototype._splitRoot=function(e,t){this.data=g([e,t]),this.data.height=e.height+1,this.data.leaf=!1,r(this.data,this.toBBox)},a.prototype._chooseSplitIndex=function(e,t,n){for(var a,i,r,s,l,c,d,p=1/0,m=1/0,g=t;g<=n-t;g++){var f=o(e,0,g,this.toBBox),b=o(e,g,n,this.toBBox),y=(i=f,r=b,void 0,void 0,void 0,void 0,s=Math.max(i.minX,r.minX),l=Math.max(i.minY,r.minY),c=Math.min(i.maxX,r.maxX),d=Math.min(i.maxY,r.maxY),Math.max(0,c-s)*Math.max(0,d-l)),h=u(f)+u(b);y<p?(p=y,a=g,m=h<m?h:m):y===p&&h<m&&(m=h,a=g)}return a||n-t},a.prototype._chooseSplitAxis=function(e,t,n){var a=e.leaf?this.compareMinX:l,i=e.leaf?this.compareMinY:c;this._allDistMargin(e,t,n,a)<this._allDistMargin(e,t,n,i)&&e.children.sort(a)},a.prototype._allDistMargin=function(e,t,n,a){e.children.sort(a);for(var i=this.toBBox,r=o(e,0,t,i),l=o(e,n-t,n,i),c=d(r)+d(l),u=t;u<n-t;u++){var p=e.children[u];s(r,e.leaf?i(p):p),c+=d(r)}for(var m=n-t-1;m>=t;m--){var g=e.children[m];s(l,e.leaf?i(g):g),c+=d(l)}return c},a.prototype._adjustParentBBoxes=function(e,t,n){for(var a=n;a>=0;a--)s(t[a],e)},a.prototype._condense=function(e){for(var t=e.length-1,n=void 0;t>=0;t--)0===e[t].children.length?t>0?(n=e[t-1].children).splice(n.indexOf(e[t]),1):this.clear():r(e[t],this.toBBox)},a}()},function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s}));var a=n(34),i=n(159),r=n(158);const o=(e,t)=>e?e.map((e=>{const n=e.id.split("."),i=n.length>1?n[0]:(({browserFields:e,field:t})=>Object(a.has)(`base.fields.${t}`,e)?"base":t)({field:e.id,browserFields:t});return{...e,...Object(a.get)([i,"fields",e.id],t)}})):[],s=(e,t)=>{var n;return{columnHeaderType:r.a,id:e,initialWidth:i.a,...null!==(n=t.find((t=>t.id===e)))&&void 0!==n?n:{}}}},function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"g",(function(){return l})),n.d(t,"e",(function(){return c}));var a=n(0),i=n(212);n.d(t,"a",(function(){return i.a})),n.d(t,"f",(function(){return i.b}));const r=e=>a.i18n.translate("xpack.securitySolution.entityAnalytics.riskDashboard.riskToolTip",{defaultMessage:"{riskEntity} risk classification is determined by {riskEntityLowercase} risk score. {riskEntity}s classified as Critical or High are indicated as risky.",values:{riskEntity:Object(i.c)(e),riskEntityLowercase:Object(i.c)(e,!0)}}),o=e=>a.i18n.translate("xpack.securitySolution.entityAnalytics.riskDashboard.riskClassificationTitle",{defaultMessage:"{riskEntity} risk classification",values:{riskEntity:Object(i.c)(e)}}),s=e=>a.i18n.translate("xpack.securitySolution.entityAnalytics.riskDashboard.nameTitle",{defaultMessage:"{riskEntity} Name",values:{riskEntity:Object(i.c)(e)}}),l=a.i18n.translate("xpack.securitySolution.entityAnalytics.riskDashboard.viewAllLabel",{defaultMessage:"View all"}),c=a.i18n.translate("xpack.securitySolution.entityAnalytics.riskDashboard.learnMore",{defaultMessage:"Learn more"})},,function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(33),i=n.n(a),r=n(4),o=n.n(r),s=n(32),l=n(157);const c=i()(s.EuiSwitch).withConfig({displayName:"StaticSwitch",componentId:"sc-1xsgv9-0"})([".euiSwitch__thumb,.euiSwitch__icon{transition:none;}"]);c.displayName="StaticSwitch";const u=({job:e,isSecurityJobsLoading:t,onJobStateChange:n})=>{const[a,i]=Object(r.useState)(!1),u=Object(r.useCallback)((async t=>{i(!0),await n(e,e.latestTimestampMs||0,t.target.checked),i(!1)}),[e,i,n]);return o.a.createElement(s.EuiFlexGroup,{justifyContent:"spaceAround"},o.a.createElement(s.EuiFlexItem,{grow:!1},t||a||Object(l.b)(e.jobState,e.datafeedState)?o.a.createElement(s.EuiLoadingSpinner,{size:"m","data-test-subj":"job-switch-loader"}):o.a.createElement(c,{"data-test-subj":"job-switch",disabled:Object(l.a)(e.jobState,e.datafeedState),checked:Object(l.c)(e.jobState,e.datafeedState),onChange:u,showLabel:!1,label:""})))};u.displayName="JobSwitchComponent";const d=o.a.memo(u);d.displayName="JobSwitch"},function(e,t,n){"use strict";var a=n(461);n.d(t,"b",(function(){return a.a}));var i=n(589);n.d(t,"a",(function(){return i.a}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(4),i=n(131),r=n(608),o=n(113),s=n(571),l=n(496),c=n(681);const u=`${o.Gb}.ndjson`;function d(){const e=Object(c.a)(),t=Object(l.a)();return Object(a.useCallback)((async n=>{try{Object(r.a)(n,u),e({actionType:i.b.export,summary:await Object(s.b)(n)})}catch(e){t({actionType:i.b.export,error:e})}}),[e,t])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(4),i=n(157),r=n(378),o=n(518);const s=()=>{const{enableDatafeed:e,isLoading:t}=Object(o.a)(),{loading:n,jobs:s,refetch:l}=Object(r.a)(),[c,u]=Object(a.useState)(!1),d=Object(a.useCallback)((async a=>{if(n||t)return;if(!a||!a.length)return;u(!0);const r=s.filter((e=>a.includes(e.id)));await Promise.all(r.map((async t=>{var n;if(Object(i.c)(t.jobState,t.datafeedState))return!0;const a=null!==(n=t.latestTimestampMs)&&void 0!==n?n:0;await e(t,a,!0)}))),l(),u(!1)}),[e,t,n,s,l]);return{loading:n,jobs:s,starting:c,startMlJobs:d}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(137);const i=(e,t)=>e===a.UsersType.details&&null!=t?[{fieldName:"user.name",fieldValue:t}]:[]},function(e,t,n){"use strict";n.d(t,"e",(function(){return v})),n.d(t,"f",(function(){return k})),n.d(t,"j",(function(){return O})),n.d(t,"i",(function(){return T})),n.d(t,"a",(function(){return ge})),n.d(t,"b",(function(){return Ve})),n.d(t,"c",(function(){return lt})),n.d(t,"d",(function(){return Tt})),n.d(t,"g",(function(){return Wt})),n.d(t,"h",(function(){return bn}));var a=n(82),i=n.n(a),r=n(4),o=n.n(r),s=n(37),l=n(41),c=n(32),u=n(192),d=n(578),p=n(698),m=n(304),g=n(420),f=n(104),b=n(689),y=n(272),h=n(1);const v=o.a.memo((({type:e,to:t,filterQuery:n,isInitializing:a,from:r,indexPattern:v,indexNames:E,setQuery:x})=>{const k={startDate:r,endDate:t,indexNames:E,skip:a,type:e,setQuery:x,filterQuery:n},S={...k,indexPattern:v},w={...k,anomaliesFilterQuery:{bool:{should:[{exists:{field:"source.ip"}},{exists:{field:"destination.ip"}}],minimum_should_match:1}},AnomaliesTableComponent:p.a};return o.a.createElement(s.Switch,null,o.a.createElement(l.Route,{path:`${h.Sb}/:tabName(${y.a.dns})`},o.a.createElement(Ve,S)),o.a.createElement(l.Route,{path:`${h.Sb}/:tabName(${y.a.flows})`},o.a.createElement(o.a.Fragment,null,o.a.createElement(b.a,{direction:"column"},o.a.createElement(c.EuiFlexItem,null,o.a.createElement(Tt,i()({},S,{flowTarget:u.b.source}))),o.a.createElement(c.EuiFlexItem,null,o.a.createElement(Tt,i()({},S,{flowTarget:u.b.destination})))),o.a.createElement(c.EuiSpacer,null),o.a.createElement(b.a,{direction:"column"},o.a.createElement(c.EuiFlexItem,null,o.a.createElement(ge,i()({},S,{flowTarget:u.b.source}))),o.a.createElement(c.EuiFlexItem,null,o.a.createElement(ge,i()({},S,{flowTarget:u.b.destination})))))),o.a.createElement(l.Route,{path:`${h.Sb}/:tabName(${y.a.http})`},o.a.createElement(lt,S)),o.a.createElement(l.Route,{path:`${h.Sb}/:tabName(${y.a.tls})`},o.a.createElement(Wt,i()({},S,{flowTarget:u.b.source}))),o.a.createElement(l.Route,{path:`${h.Sb}/:tabName(${y.a.anomalies})`},o.a.createElement(g.a,i()({},w,{AnomaliesTableComponent:p.a}))),o.a.createElement(l.Route,{path:`${h.Sb}/:tabName(${y.a.events})`},o.a.createElement(d.a,i()({additionalFilters:m.f,tableId:f.c.networkPageEvents},S))))}));v.displayName="NetworkRoutes";var E=n(33);const x=n.n(E)()(c.EuiFlexGroup).withConfig({displayName:"FlexGroup",componentId:"sc-1sbaj97-0"})(["min-height:200px;"]);x.displayName="FlexGroup";const k=()=>o.a.createElement(x,{justifyContent:"center",alignItems:"center"},o.a.createElement(c.EuiFlexItem,{grow:!1},o.a.createElement(c.EuiLoadingSpinner,{size:"xl"})));k.displayName="NetworkRoutesLoading";var S=n(34),w=n(413);const j=e=>`${h.Sb}/${e}`,O=e=>{const t={[y.a.flows]:{id:y.a.flows,name:w.d,href:j(y.a.flows),disabled:!1},[y.a.dns]:{id:y.a.dns,name:w.b,href:j(y.a.dns),disabled:!1},[y.a.http]:{id:y.a.http,name:w.e,href:j(y.a.http),disabled:!1},[y.a.tls]:{id:y.a.tls,name:w.f,href:j(y.a.tls),disabled:!1},[y.a.anomalies]:{id:y.a.anomalies,name:w.a,href:j(y.a.anomalies),disabled:!1},[y.a.events]:{id:y.a.events,name:w.c,href:j(y.a.events),disabled:!1}};return e?t:Object(S.omit)([y.a.anomalies],t)};var I=n(577);const T=(e,t)=>e&&!t?I.d:I.e;var C=n(78),M=n(92),N=n.n(M),D=n(111),F=n(85),A=n(81),_=n(197),R=n(44),P=n.n(R),L=n(475),q=n(133),B=n(102),z=n(87),$=n(106),V=n(150),U=n(0);const H=e=>U.i18n.translate("xpack.securitySolution.networkTopCountriesTable.heading.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {Country} other {Countries}}"}),G=U.i18n.translate("xpack.securitySolution.networkTopCountriesTable.column.countryTitle",{defaultMessage:"Country"}),Q=U.i18n.translate("xpack.securitySolution.networkTopCountriesTable.column.bytesInTitle",{defaultMessage:"Bytes in"}),W=U.i18n.translate("xpack.securitySolution.networkTopCountriesTable.column.bytesOutTitle",{defaultMessage:"Bytes out"}),K=U.i18n.translate("xpack.securitySolution.networkTopCountriesTable.column.flows",{defaultMessage:"Flows"}),Y=U.i18n.translate("xpack.securitySolution.networkTopCountriesTable.heading.destinationCountries",{defaultMessage:"Destination countries"}),J=U.i18n.translate("xpack.securitySolution.networkTopCountriesTable.heading.sourceCountries",{defaultMessage:"Source countries"}),X=U.i18n.translate("xpack.securitySolution.networkTopCountriesTable.column.destinationIps",{defaultMessage:"Destination IPs"}),Z=U.i18n.translate("xpack.securitySolution.networkTopCountriesTable.column.sourceIps",{defaultMessage:"Source IPs"}),ee=U.i18n.translate("xpack.securitySolution.networkTopCountriesTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),te=U.i18n.translate("xpack.securitySolution.networkTopCountriesTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"});var ne=n(257);const ae=e=>e===u.b.source?u.b.destination:u.b.source,ie=[{text:ee,numberOfRow:5},{text:te,numberOfRow:10}],re=({data:e,fakeTotalCount:t,flowTargeted:n,id:a,indexPattern:i,isInspect:s,loading:l,loadPage:c,setQuerySkip:d,showMorePagesIndicator:p,totalCount:m,type:g})=>{const f=Object(C.useDispatch)(),b=Object(r.useMemo)((()=>D.e.topCountriesSelector()),[]),{activePage:y,limit:h,sort:v}=Object(A.a)((e=>b(e,g,n))),E=Object(r.useMemo)((()=>n===F.g.source?J:Y),[n]),x=Object(r.useMemo)((()=>g===D.c.NetworkType.page?n===F.g.source?D.c.NetworkTableType.topCountriesSource:D.c.NetworkTableType.topCountriesDestination:n===F.g.source?D.c.NetworkDetailsTableType.topCountriesSource:D.c.NetworkDetailsTableType.topCountriesDestination),[n,g]),k=v.field===F.s.bytes_out||v.field===F.s.bytes_in?`node.network.${v.field}`:`node.${n}.${v.field}`,w=Object(r.useCallback)((e=>f(D.b.updateNetworkTable({networkType:g,tableType:x,updates:{limit:e}}))),[f,g,x]),j=Object(r.useCallback)((e=>f(D.b.updateNetworkTable({networkType:g,tableType:x,updates:{activePage:e}}))),[f,g,x]),O=Object(r.useCallback)((e=>{if(null!=e.sort){const t=e.sort.field.split("."),n=Object(S.last)(t),a={field:n,direction:n!==v.field?F.b.desc:e.sort.direction};N()(a,v)||f(D.b.updateNetworkTable({networkType:g,tableType:x,updates:{sort:a}}))}}),[v,f,g,x]),I=Object(r.useMemo)((()=>((e,t,n,a)=>{const i=((e,t,n,a)=>[{name:G,render:({node:e})=>{const n=Object(S.get)(`${t}.country`,e),i=`${t}.geo.country_iso_code`,r=Object(B.h)(`${a}-table-${t}-country-${n}`);return null!=n?o.a.createElement(q.b,{key:r,dataProvider:{and:[],enabled:!0,id:r,name:n,excluded:!1,kqlQuery:"",queryMatch:{field:i,value:n,operator:$.d}},isAggregatable:!0,fieldType:"keyword",render:(e,t,a)=>a.isDragging?o.a.createElement(q.a,null,o.a.createElement(V.a,{dataProvider:e})):o.a.createElement(o.a.Fragment,null,o.a.createElement(L.b,{countryCode:n}))}):Object(z.d)()},width:"20%"},{align:"right",field:"node.network.bytes_in",name:Q,sortable:!0,render:e=>null!=e?o.a.createElement(ne.a,{value:e}):Object(z.d)()},{align:"right",field:"node.network.bytes_out",name:W,sortable:!0,render:e=>null!=e?o.a.createElement(ne.a,{value:e}):Object(z.d)()},{align:"right",field:`node.${t}.flows`,name:K,sortable:!0,render:e=>null!=e?P()(e).format("0,000"):Object(z.d)()},{align:"right",field:`node.${t}.${t}_ips`,name:t===u.b.source?Z:X,sortable:!0,render:e=>null!=e?P()(e).format("0,000"):Object(z.d)()},{align:"right",field:`node.${t}.${ae(t)}_ips`,name:ae(t)===u.b.source?Z:X,sortable:!0,render:e=>null!=e?P()(e).format("0,000"):Object(z.d)()}])(0,t,0,a);return n===D.c.NetworkType.details?(i.pop(),i):i})(0,n,g,"networkTopCountries-top-talkers")),[i,n,g]);return o.a.createElement(_.a,{activePage:y,columns:I,dataTestSubj:`table-${x}`,headerCount:m,headerTitle:E,headerUnit:H(m),id:a,isInspect:s,itemsPerRow:ie,limit:h,loading:l,loadPage:c,onChange:O,pageOfItems:e,setQuerySkip:d,showMorePagesIndicator:p,sorting:{field:k,direction:v.direction},totalCount:t,updateActivePage:j,updateLimitPagination:w})};re.displayName="NetworkTopCountriesTableComponent";const oe=o.a.memo(re);var se=n(126),le=n(215);const ce=U.i18n.translate("xpack.securitySolution.networkTopCountries.failSearchDescription",{defaultMessage:"Failed to run search on network top countries"});var ue=n(130),de=n(127),pe=n(109);const me=Object(de.a)(oe),ge=({endDate:e,filterQuery:t,flowTarget:n,indexNames:a,indexPattern:i,ip:s,setQuery:l,skip:c,startDate:u,type:d})=>{const p=`networkTopCountriesQuery-${n}-${d}`,{toggleStatus:m}=Object(pe.a)(p),[g,f]=Object(r.useState)(c||!m);Object(r.useEffect)((()=>{f(c||!m)}),[c,m]);const[b,{id:y,inspect:h,isInspected:v,loadPage:E,networkTopCountries:x,pageInfo:k,refetch:w,totalCount:j}]=(({endDate:e,filterQuery:t,flowTarget:n,id:a,indexNames:i,ip:o,skip:s,startDate:l,type:c})=>{const u=Object(r.useMemo)((()=>D.e.topCountriesSelector()),[]),{activePage:d,limit:p,sort:m}=Object(A.a)((e=>u(e,c,n))),[g,f]=Object(r.useState)(null),b=Object(r.useCallback)((e=>{f((t=>t?{...t,pagination:Object(le.a)(e,p)}:t))}),[p]),{loading:y,result:h,search:v,refetch:E,inspect:x}=Object(ue.a)({factoryQueryType:F.q.topCountries,initialResult:{edges:[],totalCount:-1,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1}},errorMessage:ce,abort:s}),k=Object(r.useMemo)((()=>({endDate:e,networkTopCountries:h.edges,id:a,inspect:x,isInspected:!1,loadPage:b,pageInfo:h.pageInfo,refetch:E,startDate:l,totalCount:h.totalCount})),[e,a,x,E,h.edges,h.pageInfo,h.totalCount,l,b]);return Object(r.useEffect)((()=>{f((a=>{const r={...null!=a?a:{},defaultIndex:i,factoryQueryType:F.q.topCountries,filterQuery:Object(se.a)(t),flowTarget:n,ip:o,pagination:Object(le.a)(d,p),sort:m,timerange:{interval:"12h",from:l,to:e}};return N()(a,r)?a:r}))}),[d,i,e,t,o,p,l,m,n]),Object(r.useEffect)((()=>{!s&&g&&v(g)}),[g,v,s]),[y,k]})({endDate:e,flowTarget:n,filterQuery:t,id:p,indexNames:a,ip:s,skip:g,startDate:u,type:d});return o.a.createElement(me,{data:x,fakeTotalCount:Object(S.getOr)(50,"fakeTotalCount",k),flowTargeted:n,id:y,indexPattern:i,inspect:h,isInspect:v,loading:b,loadPage:E,refetch:w,setQuery:l,setQuerySkip:f,showMorePagesIndicator:Object(S.getOr)(!1,"showMorePagesIndicator",k),totalCount:j,type:d})};ge.displayName="CountriesQueryTabBody";const fe=U.i18n.translate("xpack.securitySolution.networkDnsTable.title",{defaultMessage:"Top DNS domains"}),be=e=>U.i18n.translate("xpack.securitySolution.networkDnsTable.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {domain} other {domains}}"}),ye=U.i18n.translate("xpack.securitySolution.networkDnsTable.helperTooltip",{defaultMessage:"This shows DNS protocol traffic only and can be useful for hunting domains used in DNS data exfiltration."}),he=U.i18n.translate("xpack.securitySolution.networkDnsTable.column.registeredDomain",{defaultMessage:"Registered domain"}),ve=U.i18n.translate("xpack.securitySolution.networkDnsTable.column.TotalQueriesTitle",{defaultMessage:"Total queries"}),Ee=U.i18n.translate("xpack.securitySolution.networkDnsTable.column.uniqueDomainsTitle",{defaultMessage:"Unique domains"}),xe=U.i18n.translate("xpack.securitySolution.networkDnsTable.column.bytesInTitle",{defaultMessage:"DNS bytes in"}),ke=U.i18n.translate("xpack.securitySolution.networkDnsTable.column.bytesOutTitle",{defaultMessage:"DNS bytes out"}),Se=U.i18n.translate("xpack.securitySolution.networkDnsTable.select.includePtrRecords",{defaultMessage:"Include PTR records"}),we=U.i18n.translate("xpack.securitySolution.networkDnsTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),je=U.i18n.translate("xpack.securitySolution.networkDnsTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),Oe=o.a.memo((({isPtrIncluded:e,onChange:t})=>o.a.createElement(c.EuiSwitch,{name:"switch-ptr-included",label:Se,checked:e,onChange:t})));Oe.displayName="IsPtrIncluded";const Ie=D.c.NetworkTableType.dns,Te=[{text:we,numberOfRow:5},{text:je,numberOfRow:10}],Ce=({data:e,fakeTotalCount:t,id:n,isInspect:a,loading:i,loadPage:s,showMorePagesIndicator:l,setQuerySkip:c,totalCount:u,type:d})=>{const p=Object(C.useDispatch)(),m=Object(r.useMemo)((()=>D.e.dnsSelector()),[]),{activePage:g,isPtrIncluded:f,limit:b,sort:y}=Object(A.a)(m),h=Object(r.useCallback)((e=>p(D.b.updateNetworkTable({networkType:d,tableType:Ie,updates:{limit:e}}))),[d,p]),v=Object(r.useCallback)((e=>p(D.b.updateNetworkTable({networkType:d,tableType:Ie,updates:{activePage:e}}))),[p,d]),E=Object(r.useCallback)((e=>{if(null!=e.sort){const t={field:e.sort.field.split(".")[1],direction:e.sort.direction};N()(t,y)||p(D.b.updateNetworkTable({networkType:d,tableType:Ie,updates:{sort:t}}))}}),[y,d,p]),x=Object(r.useCallback)((()=>p(D.b.updateNetworkTable({networkType:d,tableType:Ie,updates:{isPtrIncluded:!f}}))),[p,d,f]),k=Object(r.useMemo)((()=>[{field:`node.${F.n.dnsName}`,name:he,truncateText:!1,mobileOptions:{show:!0},sortable:!0,render:e=>{if(null!=e){const t=Object(B.h)(`networkDns-table--name-${e}`);return o.a.createElement(q.b,{key:t,dataProvider:{and:[],enabled:!0,id:t,name:e,excluded:!1,kqlQuery:"",queryMatch:{field:"dns.question.registered_domain",value:e,operator:$.d}},isAggregatable:!0,fieldType:"keyword",render:(t,n,a)=>a.isDragging?o.a.createElement(q.a,null,o.a.createElement(V.a,{dataProvider:t})):Object(z.a)(e)})}return Object(z.d)()}},{align:"right",field:`node.${F.n.queryCount}`,name:ve,sortable:!0,truncateText:!1,mobileOptions:{show:!0},render:e=>null!=e?P()(e).format("0"):Object(z.d)()},{align:"right",field:`node.${F.n.uniqueDomains}`,name:Ee,sortable:!0,truncateText:!1,mobileOptions:{show:!0},render:e=>null!=e?P()(e).format("0"):Object(z.d)()},{align:"right",field:`node.${F.n.dnsBytesIn}`,name:xe,sortable:!0,truncateText:!1,mobileOptions:{show:!0},render:e=>null!=e?o.a.createElement(ne.a,{value:e}):Object(z.d)()},{align:"right",field:`node.${F.n.dnsBytesOut}`,name:ke,sortable:!0,truncateText:!1,mobileOptions:{show:!0},render:e=>null!=e?o.a.createElement(ne.a,{value:e}):Object(z.d)()}]),[]),S=Object(r.useMemo)((()=>({field:`node.${y.field}`,direction:y.direction})),[y.direction,y.field]),w=Object(r.useMemo)((()=>o.a.createElement(Oe,{isPtrIncluded:f,onChange:x})),[f,x]);return o.a.createElement(_.a,{activePage:g,columns:k,dataTestSubj:`table-${Ie}`,headerCount:u,headerSupplement:w,headerTitle:fe,headerTooltip:ye,headerUnit:be(u),id:n,itemsPerRow:Te,isInspect:a,limit:b,loading:i,loadPage:s,onChange:E,pageOfItems:e,setQuerySkip:c,showMorePagesIndicator:l,sorting:S,totalCount:t,updateActivePage:v,updateLimitPagination:h})};Ce.displayName="NetworkDnsTableComponent";const Me=o.a.memo(Ce),Ne=U.i18n.translate("xpack.securitySolution.networkDns.errorSearchDescription",{defaultMessage:"An error has occurred on network dns search"}),De=U.i18n.translate("xpack.securitySolution.hosts.navigation.dns.histogram.errorFetchingDnsData",{defaultMessage:"Failed to query DNS data"});var Fe=n(326),Ae=n(376),_e=n(194);const Re={title:"Top domains by dns.question.registered_domain",description:"Security Solution Network DNS",visualizationType:"lnsXY",state:{visualization:{legend:{isVisible:!0,position:"right"},valueLabels:"hide",fittingFunction:"None",yLeftExtent:{mode:"full"},yRightExtent:{mode:"full"},axisTitlesVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},tickLabelsVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},labelsOrientation:{x:0,yLeft:0,yRight:0},gridlinesVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},preferredSeriesType:"bar",layers:[{layerId:"b1c3efc6-c886-4fba-978f-3b6bb5e7948a",accessors:["2a4d5e20-f570-48e4-b9ab-ff3068919377"],position:"top",seriesType:"bar",showGridlines:!1,layerType:"data",xAccessor:"d1452b87-0e9e-4fc0-a725-3727a18e0b37",splitAccessor:"e8842815-2a45-4c74-86de-c19a391e2424"}]},query:{query:"",language:"kuery"},filters:[{meta:{alias:null,negate:!0,disabled:!1,type:"phrase",key:"dns.question.type",params:{query:"PTR"},indexRefName:"filter-index-pattern-0"},query:{match_phrase:{"dns.question.type":"PTR"}},$state:{store:"appState"}}],datasourceStates:{formBased:{layers:{"b1c3efc6-c886-4fba-978f-3b6bb5e7948a":{columns:{"d1452b87-0e9e-4fc0-a725-3727a18e0b37":{label:"@timestamp",dataType:"date",operationType:"date_histogram",sourceField:"@timestamp",isBucketed:!0,scale:"interval",params:{interval:"auto"}},"2a4d5e20-f570-48e4-b9ab-ff3068919377":{label:Object(_e.o)("dns.question.registered_domain"),dataType:"number",operationType:"unique_count",scale:"ratio",sourceField:"dns.question.registered_domain",isBucketed:!1},"e8842815-2a45-4c74-86de-c19a391e2424":{label:Object(_e.n)("dns.question.name"),dataType:"string",operationType:"terms",scale:"ordinal",sourceField:"dns.question.name",isBucketed:!0,params:{size:6,orderBy:{type:"column",columnId:"2a4d5e20-f570-48e4-b9ab-ff3068919377"},orderDirection:"desc",otherBucket:!0,missingBucket:!1}}},columnOrder:["e8842815-2a45-4c74-86de-c19a391e2424","d1452b87-0e9e-4fc0-a725-3727a18e0b37","2a4d5e20-f570-48e4-b9ab-ff3068919377"],incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-b1c3efc6-c886-4fba-978f-3b6bb5e7948a"},{name:"filter-index-pattern-0",type:"index-pattern",id:"{dataViewId}"}]};var Pe;const Le="networkDnsHistogramQuery",qe=Object(de.a)(Me),Be=[{text:"dns.question.registered_domain",value:"dns.question.registered_domain"}],ze={defaultStackByOption:null!==(Pe=Be.find((e=>"dns.question.registered_domain"===e.text)))&&void 0!==Pe?Pe:Be[0],errorMessage:De,histogramType:Ae.j.dns,stackByOptions:Be,subtitle:void 0,lensAttributes:Re},$e=({deleteQuery:e,endDate:t,filterQuery:n,indexNames:a,skip:s,startDate:l,setQuery:c,type:u})=>{const d=D.e.dnsSelector(),p=Object(A.b)((e=>d(e).isPtrIncluded));Object(r.useEffect)((()=>()=>{e&&e({id:Le})}),[e]);const m=`networkDnsQuery-${u}`,{toggleStatus:g}=Object(pe.a)(m),[f,b]=Object(r.useState)(s||!g);Object(r.useEffect)((()=>{b(s||!g)}),[s,g]);const[y,{totalCount:h,networkDns:v,pageInfo:E,loadPage:x,id:k,inspect:w,isInspected:j,refetch:O}]=(({endDate:e,filterQuery:t,id:n,indexNames:a,skip:i,startDate:o})=>{const s=Object(r.useMemo)((()=>D.e.dnsSelector()),[]),{activePage:l,sort:c,isPtrIncluded:u,limit:d}=Object(A.a)(s),[p,m]=Object(r.useState)(null),g=Object(r.useCallback)((e=>{m((t=>t?{...t,pagination:Object(le.a)(e,d)}:t))}),[d]),{loading:f,result:b,search:y,refetch:h,inspect:v}=Object(ue.a)({factoryQueryType:F.q.dns,initialResult:{edges:[],totalCount:-1,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1}},errorMessage:Ne,abort:i}),E=Object(r.useMemo)((()=>({id:n,inspect:v,isInspected:!1,loadPage:g,networkDns:b.edges,pageInfo:b.pageInfo,refetch:h,totalCount:b.totalCount})),[n,v,h,b.edges,b.pageInfo,b.totalCount,g]);return Object(r.useEffect)((()=>{m((n=>{const i={...null!=n?n:{},defaultIndex:a,isPtrIncluded:u,factoryQueryType:F.q.dns,filterQuery:Object(se.a)(t),pagination:Object(le.a)(l,d,!0),sort:c,timerange:{interval:"12h",from:o,to:e}};return N()(n,i)?n:i}))}),[l,a,e,t,d,o,c,u]),Object(r.useEffect)((()=>{!i&&p&&y(p)}),[p,y,i]),[f,E]})({endDate:t,filterQuery:n,id:m,indexNames:a,skip:f,startDate:l}),I=Object(r.useCallback)((e=>{return t=e.text,U.i18n.translate("xpack.securitySolution.network.dns.stackByUniqueSubdomain",{values:{groupByField:t},defaultMessage:"Top domains by {groupByField}"});var t}),[]),T=Object(r.useMemo)((()=>({...ze,title:I})),[I]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(Fe.a,i()({id:Le,isPtrIncluded:p,endDate:t,filterQuery:n,indexNames:a,setQuery:c,showLegend:!0,startDate:l},T)),o.a.createElement(qe,{data:v,fakeTotalCount:Object(S.getOr)(50,"fakeTotalCount",E),id:k,inspect:w,isInspect:j,loading:y,loadPage:x,refetch:O,setQuery:c,setQuerySkip:b,showMorePagesIndicator:Object(S.getOr)(!1,"showMorePagesIndicator",E),totalCount:h,type:u}))};$e.displayName="DnsQueryTabBodyComponent";const Ve=o.a.memo($e);var Ue=n(89);const He=U.i18n.translate("xpack.securitySolution.networkHttpTable.title",{defaultMessage:"HTTP Requests"}),Ge=e=>U.i18n.translate("xpack.securitySolution.networkHttpTable.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {request} other {requests}}"}),Qe=U.i18n.translate("xpack.securitySolution.networkHttpTable.column.methodTitle",{defaultMessage:"Method"}),We=U.i18n.translate("xpack.securitySolution.networkHttpTable.column.domainTitle",{defaultMessage:"Domain"}),Ke=U.i18n.translate("xpack.securitySolution.networkHttpTable.column.pathTitle",{defaultMessage:"Path"}),Ye=U.i18n.translate("xpack.securitySolution.networkHttpTable.column.statusTitle",{defaultMessage:"Status"}),Je=U.i18n.translate("xpack.securitySolution.networkHttpTable.column.lastHostTitle",{defaultMessage:"Last host"}),Xe=U.i18n.translate("xpack.securitySolution.networkHttpTable.column.lastSourceIpTitle",{defaultMessage:"Last source Ip"}),Ze=U.i18n.translate("xpack.securitySolution.networkHttpTable.column.requestsTitle",{defaultMessage:"Requests"}),et=U.i18n.translate("xpack.securitySolution.networkHttpTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),tt=U.i18n.translate("xpack.securitySolution.networkHttpTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"});var nt=n(181);const at=[{text:et,numberOfRow:5},{text:tt,numberOfRow:10}],it=({data:e,fakeTotalCount:t,id:n,isInspect:a,loading:i,loadPage:s,setQuerySkip:l,showMorePagesIndicator:c,totalCount:d,type:p})=>{const m=Object(C.useDispatch)(),g=Object(r.useMemo)((()=>D.e.httpSelector()),[]),{activePage:f,limit:b,sort:y}=Object(A.a)((e=>g(e,p))),h=p===D.c.NetworkType.page?D.c.NetworkTableType.http:D.c.NetworkDetailsTableType.http,v=Object(r.useCallback)((e=>m(D.b.updateNetworkTable({networkType:p,tableType:h,updates:{limit:e}}))),[m,p,h]),E=Object(r.useCallback)((e=>m(D.b.updateNetworkTable({networkType:p,tableType:h,updates:{activePage:e}}))),[m,p,h]),x=Object(r.useCallback)((e=>{null!=e.sort&&e.sort.direction!==y.direction&&m(D.b.updateNetworkTable({networkType:p,tableType:h,updates:{sort:{direction:e.sort.direction}}}))}),[y.direction,m,p,h]),k={field:`node.${F.o.requestCount}`,direction:y.direction},S=Object(r.useMemo)((()=>{return e=h,[{name:Qe,render:({node:{methods:t,path:n}})=>Array.isArray(t)&&t.length>0?Object(nt.c)({attrName:"http.request.method",displayCount:3,idPrefix:Object(B.h)(`${e}-table-methods-${n}`),rowItems:t,isAggregatable:!0,fieldType:"keyword"}):Object(z.d)()},{name:We,render:({node:{domains:t,path:n}})=>Array.isArray(t)&&t.length>0?Object(nt.c)({attrName:"url.domain",displayCount:3,idPrefix:Object(B.h)(`${e}-table-domains-${n}`),rowItems:t,isAggregatable:!0,fieldType:"keyword"}):Object(z.d)()},{field:`node.${u.e.path}`,name:Ke,render:t=>null!=t?Object(nt.b)({attrName:"url.path",idPrefix:Object(B.h)(`${e}-table-path-${t}`),rowItem:t,isAggregatable:!0,fieldType:"keyword"}):Object(z.d)()},{name:Ye,render:({node:{statuses:t,path:n}})=>Array.isArray(t)&&t.length>0?Object(nt.c)({attrName:"http.response.status_code",displayCount:3,idPrefix:Object(B.h)(`${e}-table-statuses-${n}`),rowItems:t,isAggregatable:!0,fieldType:"keyword"}):Object(z.d)()},{name:Je,render:({node:{lastHost:t,path:n}})=>null!=t?Object(nt.b)({attrName:"host.name",idPrefix:Object(B.h)(`${e}-table-lastHost-${n}`),rowItem:t,isAggregatable:!0,fieldType:"keyword"}):Object(z.d)()},{name:Xe,render:({node:{lastSourceIp:t,path:n}})=>null!=t?Object(nt.b)({attrName:"source.ip",idPrefix:Object(B.h)(`${e}-table-lastSourceIp-${n}`),rowItem:t,render:()=>o.a.createElement(Ue.h,{ip:t}),isAggregatable:!0,fieldType:"keyword"}):Object(z.d)()},{align:"right",field:`node.${u.e.requestCount}`,name:Ze,sortable:!0,render:e=>null!=e?P()(e).format("0,000"):Object(z.d)()}];var e}),[h]);return o.a.createElement(_.a,{activePage:f,columns:S,dataTestSubj:`table-${h}`,headerCount:d,headerTitle:He,headerUnit:Ge(d),id:n,itemsPerRow:at,isInspect:a,limit:b,loading:i,loadPage:s,onChange:x,pageOfItems:e,setQuerySkip:l,showMorePagesIndicator:c,sorting:k,totalCount:t,updateActivePage:E,updateLimitPagination:v})};it.displayName="NetworkHttpTableComponent";const rt=o.a.memo(it),ot=U.i18n.translate("xpack.securitySolution.networkHttp.failSearchDescription",{defaultMessage:"Failed to run search on network http"}),st=Object(de.a)(rt),lt=({endDate:e,filterQuery:t,indexNames:n,skip:a,startDate:i,setQuery:s,type:l})=>{const c=`networkHttpQuery-${l}`,{toggleStatus:u}=Object(pe.a)(c),[d,p]=Object(r.useState)(a||!u);Object(r.useEffect)((()=>{p(a||!u)}),[a,u]);const[m,{id:g,inspect:f,isInspected:b,loadPage:y,networkHttp:h,pageInfo:v,refetch:E,totalCount:x}]=(({endDate:e,filterQuery:t,id:n,indexNames:a,ip:i,skip:o,startDate:s,type:l})=>{const c=Object(r.useMemo)((()=>D.e.httpSelector()),[]),{activePage:u,limit:d,sort:p}=Object(A.a)((e=>c(e,l))),[m,g]=Object(r.useState)(null),f=Object(r.useCallback)((e=>{g((t=>t?{...t,pagination:Object(le.a)(e,d)}:t))}),[d]),{loading:b,result:y,search:h,refetch:v,inspect:E}=Object(ue.a)({factoryQueryType:F.q.http,initialResult:{edges:[],totalCount:-1,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1}},errorMessage:ot,abort:o}),x=Object(r.useMemo)((()=>({endDate:e,networkHttp:y.edges,id:n,inspect:E,isInspected:!1,loadPage:f,pageInfo:y.pageInfo,refetch:v,startDate:s,totalCount:y.totalCount})),[e,n,E,v,y.edges,y.pageInfo,y.totalCount,s,f]);return Object(r.useEffect)((()=>{g((n=>{const r={...null!=n?n:{},defaultIndex:a,factoryQueryType:F.q.http,filterQuery:Object(se.a)(t),ip:i,pagination:Object(le.a)(u,d),sort:p,timerange:{interval:"12h",from:s,to:e}};return N()(n,r)?n:r}))}),[u,a,e,t,i,d,s,p]),Object(r.useEffect)((()=>{!o&&m&&h(m)}),[m,h,o]),[b,x]})({endDate:e,filterQuery:t,id:c,indexNames:n,skip:d,startDate:i,type:l});return o.a.createElement(st,{data:h,fakeTotalCount:Object(S.getOr)(50,"fakeTotalCount",v),id:g,inspect:f,isInspect:b,loading:m,loadPage:y,refetch:E,setQuery:s,setQuerySkip:p,showMorePagesIndicator:Object(S.getOr)(!1,"showMorePagesIndicator",v),totalCount:x,type:l})};lt.displayName="HttpQueryTabBody";const ct=e=>U.i18n.translate("xpack.securitySolution.networkTopNFlowTable.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {IP} other {IPs}}"}),ut=U.i18n.translate("xpack.securitySolution.networkTopNFlowTable.column.sourceIpTitle",{defaultMessage:"Source IPs"}),dt=U.i18n.translate("xpack.securitySolution.networkTopNFlowTable.column.destinationIpTitle",{defaultMessage:"Destination IPs"}),pt=U.i18n.translate("xpack.securitySolution.networkTopNFlowTable.column.IpTitle",{defaultMessage:"IP"}),mt=U.i18n.translate("xpack.securitySolution.networkTopNFlowTable.column.domainTitle",{defaultMessage:"Domain"}),gt=U.i18n.translate("xpack.securitySolution.networkTopNFlowTable.column.bytesInTitle",{defaultMessage:"Bytes in"}),ft=U.i18n.translate("xpack.securitySolution.networkTopNFlowTable.column.bytesOutTitle",{defaultMessage:"Bytes out"}),bt=U.i18n.translate("xpack.securitySolution.networkTopNFlowTable.column.asTitle",{defaultMessage:"Autonomous system"}),yt=U.i18n.translate("xpack.securitySolution.networkTopNFlowTable.flows",{defaultMessage:"Flows"}),ht=U.i18n.translate("xpack.securitySolution.networkTopNFlowTable.destinationIps",{defaultMessage:"Destination IPs"}),vt=U.i18n.translate("xpack.securitySolution.networkTopNFlowTable.sourceIps",{defaultMessage:"Source IPs"}),Et=U.i18n.translate("xpack.securitySolution.networkTopNFlowTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),xt=U.i18n.translate("xpack.securitySolution.networkTopNFlowTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),kt=e=>e===F.g.source?F.g.destination:F.g.source,St=[{text:Et,numberOfRow:5},{text:xt,numberOfRow:10}],wt=({data:e,fakeTotalCount:t,flowTargeted:n,id:a,isInspect:i,loading:s,loadPage:l,setQuerySkip:c,showMorePagesIndicator:u,totalCount:d,type:p})=>{const m=Object(C.useDispatch)(),g=Object(r.useMemo)((()=>D.e.topNFlowSelector()),[]),{activePage:f,limit:b,sort:y}=Object(A.a)((e=>g(e,p,n))),h=Object(r.useMemo)((()=>((e,t,n)=>{const a=((e,t)=>[{name:pt,render:({node:n})=>{const a=`${e}.ip`,i=Object(S.get)(a,n),r=`${e}.location.geo.country_iso_code[0]`,s=`${e}.geo.country_iso_code`,l=Object(S.get)(r,n),c=Object(B.h)(`${t}-table-${e}-ip-${i}`);return null!=i?o.a.createElement(o.a.Fragment,null,o.a.createElement(q.b,{key:c,dataProvider:{and:[],enabled:!0,id:c,name:i,excluded:!1,kqlQuery:"",queryMatch:{field:a,value:i,operator:$.d}},isAggregatable:!0,fieldType:"ip",render:(t,n,a)=>a.isDragging?o.a.createElement(q.a,null,o.a.createElement(V.a,{dataProvider:t})):o.a.createElement(Ue.h,{ip:i,flowTarget:e})}),l&&o.a.createElement(q.b,{key:`${c}-${l}`,dataProvider:{and:[],enabled:!0,id:`${c}-${l}`,name:l,excluded:!1,kqlQuery:"",queryMatch:{field:s,value:l,operator:$.d}},isAggregatable:!0,fieldType:"geo_point",render:(e,t,n)=>n.isDragging?o.a.createElement(q.a,null,o.a.createElement(V.a,{dataProvider:e})):o.a.createElement(o.a.Fragment,null," ",o.a.createElement(L.a,{countryCode:l})," ",l)})):Object(z.d)()},width:"20%"},{name:mt,render:({node:n})=>{const a=`${e}.domain`,i=`${e}.ip`,r=Object(S.get)(a,n),o=Object(S.get)(i,n);if(Array.isArray(r)&&r.length>0){const e=Object(B.h)(`${t}-table-${o}`);return Object(nt.c)({rowItems:r,attrName:a,idPrefix:e,displayCount:1,isAggregatable:!0,fieldType:"keyword"})}return Object(z.d)()},width:"20%"},{name:bt,render:({node:n,cursor:{value:a}})=>{const i=`${e}.autonomous_system`,r=Object(S.get)(i,n);if(null!=r){const n=Object(B.h)(`${t}-table-${e}-ip-${a}`);return o.a.createElement(o.a.Fragment,null,r.name&&Object(nt.b)({rowItem:r.name,attrName:`${e}.as.organization.name`,idPrefix:`${n}-name`,isAggregatable:!0,fieldType:"keyword"}),r.number&&o.a.createElement(o.a.Fragment,null," ",Object(nt.b)({rowItem:`${r.number}`,attrName:`${e}.as.number`,idPrefix:`${n}-number`,isAggregatable:!0,fieldType:"keyword"})))}return Object(z.d)()},width:"20%"},{align:"right",field:"node.network.bytes_in",name:gt,sortable:!0,render:e=>null!=e?o.a.createElement(ne.a,{value:e}):Object(z.d)()},{align:"right",field:"node.network.bytes_out",name:ft,sortable:!0,render:e=>null!=e?o.a.createElement(ne.a,{value:e}):Object(z.d)()},{align:"right",field:`node.${e}.flows`,name:yt,sortable:!0,render:e=>null!=e?P()(e).format("0,000"):Object(z.d)()},{align:"right",field:`node.${e}.${kt(e)}_ips`,name:e===F.g.source?ht:vt,sortable:!0,render:e=>null!=e?P()(e).format("0,000"):Object(z.d)()}])(e,n);return t===D.c.NetworkType.details?(a.pop(),a):a})(n,p,"networkTopSourceFlow-top-talkers")),[n,p]);let v;const E=n===F.g.source?ut:dt;v=p===D.c.NetworkType.page?n===F.g.source?D.c.NetworkTableType.topNFlowSource:D.c.NetworkTableType.topNFlowDestination:n===F.g.source?D.c.NetworkDetailsTableType.topNFlowSource:D.c.NetworkDetailsTableType.topNFlowDestination;const x=Object(r.useCallback)((e=>{if(null!=e.sort){const t=e.sort.field.split("."),n=Object(S.last)(t),a={field:n,direction:n!==y.field?F.b.desc:e.sort.direction};N()(a,y)||m(D.b.updateNetworkTable({networkType:p,tableType:v,updates:{sort:a}}))}}),[y,m,p,v]),k=Object(r.useMemo)((()=>({field:y.field===F.s.bytes_out||y.field===F.s.bytes_in?`node.network.${y.field}`:`node.${n}.${y.field}`,direction:y.direction})),[n,y]),w=Object(r.useCallback)((e=>m(D.b.updateNetworkTable({networkType:p,tableType:v,updates:{activePage:e}}))),[m,p,v]),j=Object(r.useCallback)((e=>m(D.b.updateNetworkTable({networkType:p,tableType:v,updates:{limit:e}}))),[m,p,v]);return o.a.createElement(_.a,{activePage:f,columns:h,dataTestSubj:`table-${v}`,headerCount:d,headerTitle:E,headerUnit:ct(d),id:a,isInspect:i,itemsPerRow:St,limit:b,loading:s,loadPage:l,onChange:x,pageOfItems:e,setQuerySkip:c,showMorePagesIndicator:u,sorting:k,totalCount:t,updateActivePage:w,updateLimitPagination:j})},jt=o.a.memo(wt),Ot=U.i18n.translate("xpack.securitySolution.networkTopNFlow.failSearchDescription",{defaultMessage:"Failed to run search on network top n flow"}),It=Object(de.a)(jt),Tt=({endDate:e,filterQuery:t,flowTarget:n,indexNames:a,ip:i,setQuery:s,skip:l,startDate:c,type:u})=>{const d=`networkTopNFlowQuery-${n}-${u}`,{toggleStatus:p}=Object(pe.a)(d),[m,g]=Object(r.useState)(l||!p);Object(r.useEffect)((()=>{g(l||!p)}),[l,p]);const[f,{id:b,inspect:y,isInspected:h,loadPage:v,networkTopNFlow:E,pageInfo:x,refetch:k,totalCount:w}]=(({endDate:e,filterQuery:t,flowTarget:n,id:a,indexNames:i,ip:o,skip:s,startDate:l,type:c})=>{const u=Object(r.useMemo)((()=>D.e.topNFlowSelector()),[]),{activePage:d,limit:p,sort:m}=Object(A.a)((e=>u(e,c,n))),[g,f]=Object(r.useState)(null),b=Object(r.useCallback)((e=>{f((t=>t?{...t,pagination:Object(le.a)(e,p)}:t))}),[p]),{loading:y,result:h,search:v,refetch:E,inspect:x}=Object(ue.a)({factoryQueryType:F.q.topNFlow,initialResult:{edges:[],totalCount:-1,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1}},errorMessage:Ot,abort:s}),k=Object(r.useMemo)((()=>({endDate:e,networkTopNFlow:h.edges,id:a,inspect:x,isInspected:!1,loadPage:b,pageInfo:h.pageInfo,refetch:E,startDate:l,totalCount:h.totalCount})),[e,a,x,E,h.edges,h.pageInfo,h.totalCount,l,b]);return Object(r.useEffect)((()=>{f((a=>{const r={...null!=a?a:{},defaultIndex:i,factoryQueryType:F.q.topNFlow,filterQuery:Object(se.a)(t),flowTarget:n,ip:o,pagination:Object(le.a)(d,p),timerange:{interval:"12h",from:l,to:e},sort:m};return N()(a,r)?a:r}))}),[d,e,t,i,o,p,l,m,n]),Object(r.useEffect)((()=>{!s&&g&&v(g)}),[g,v,s]),[y,k]})({endDate:e,flowTarget:n,filterQuery:t,id:d,indexNames:a,ip:i,skip:m,startDate:c,type:u});return o.a.createElement(It,{data:E,fakeTotalCount:Object(S.getOr)(50,"fakeTotalCount",x),flowTargeted:n,id:b,inspect:y,isInspect:h,loading:f,loadPage:v,refetch:k,setQuery:s,setQuerySkip:g,showMorePagesIndicator:Object(S.getOr)(!1,"showMorePagesIndicator",x),totalCount:w,type:u})};Tt.displayName="IPsQueryTabBody",U.i18n.translate("xpack.securitySolution.networkTls.errorSearchDescription",{defaultMessage:"An error has occurred on network tls search"});const Ct=U.i18n.translate("xpack.securitySolution.networkTls.failSearchDescription",{defaultMessage:"Failed to run search on network tls"});var Mt=n(43),Nt=n.n(Mt),Dt=n(1081),Ft=n(101);const At=U.i18n.translate("xpack.securitySolution.network.ipDetails.tlsTable.transportLayerSecurityTitle",{defaultMessage:"Transport Layer Security"}),_t=e=>U.i18n.translate("xpack.securitySolution.network.ipDetails.tlsTable.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {server certificate} other {server certificates}}"}),Rt=U.i18n.translate("xpack.securitySolution.network.ipDetails.tlsTable.columns.issuerTitle",{defaultMessage:"Issuer"}),Pt=U.i18n.translate("xpack.securitySolution.network.ipDetails.tlsTable.columns.subjectTitle",{defaultMessage:"Subject"}),Lt=U.i18n.translate("xpack.securitySolution.network.ipDetails.tlsTable.columns.sha1FingerPrintTitle",{defaultMessage:"SHA1 fingerprint"}),qt=U.i18n.translate("xpack.securitySolution.network.ipDetails.tlsTable.columns.ja3FingerPrintTitle",{defaultMessage:"JA3 fingerprint"}),Bt=U.i18n.translate("xpack.securitySolution.network.ipDetails.tlsTable.columns.validUntilTitle",{defaultMessage:"Valid until"}),zt=[{text:U.i18n.translate("xpack.securitySolution.network.ipDetails.tlsTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),numberOfRow:5},{text:U.i18n.translate("xpack.securitySolution.network.ipDetails.tlsTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),numberOfRow:10}],$t=({data:e,fakeTotalCount:t,id:n,isInspect:a,loading:i,loadPage:s,setQuerySkip:l,showMorePagesIndicator:c,totalCount:u,type:d})=>{const p=Object(C.useDispatch)(),m=Object(r.useMemo)((()=>D.e.tlsSelector()),[]),{activePage:g,limit:f,sort:b}=Object(A.a)((e=>m(e,d))),y=d===D.c.NetworkType.page?D.c.NetworkTableType.tls:D.c.NetworkDetailsTableType.tls,h=Object(r.useCallback)((e=>p(D.b.updateNetworkTable({networkType:d,tableType:y,updates:{limit:e}}))),[p,d,y]),v=Object(r.useCallback)((e=>p(D.b.updateNetworkTable({networkType:d,tableType:y,updates:{activePage:e}}))),[p,d,y]),E=Object(r.useCallback)((e=>{if(null!=e.sort){const t=e.sort.field.split("."),n={field:Ht(t[t.length-1]),direction:e.sort.direction};N()(n,b)||p(D.b.updateNetworkTable({networkType:d,tableType:y,updates:{sort:n}}))}}),[b,p,d,y]),x=Object(r.useMemo)((()=>("tls-table",[{field:"node",name:Rt,truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:({_id:e,issuers:t})=>Object(nt.c)({rowItems:t,attrName:"tls.server.issuer",idPrefix:`tls-table-${e}-table-issuers`,isAggregatable:!0,fieldType:"keyword"})},{field:"node",name:Pt,truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:({_id:e,subjects:t})=>Object(nt.c)({rowItems:t,attrName:"tls.server.subject",idPrefix:`tls-table-${e}-table-subjects`,isAggregatable:!0,fieldType:"keyword"})},{field:"node._id",name:Lt,truncateText:!1,mobileOptions:{show:!0},sortable:!0,render:e=>Object(nt.b)({rowItem:e,attrName:"tls.server.hash.sha1",idPrefix:`tls-table-${e}-table-sha1`,isAggregatable:!0,fieldType:"keyword"})},{field:"node",name:qt,truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:({_id:e,ja3:t})=>Object(nt.c)({rowItems:t,attrName:"tls.server.ja3s",idPrefix:`tls-table-${e}-table-ja3`,isAggregatable:!0,fieldType:"keyword"})},{field:"node",name:Bt,truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:({_id:e,notAfter:t})=>Object(nt.c)({rowItems:t,attrName:"tls.server.not_after",idPrefix:`tls-table-${e}-table-notAfter`,render:e=>o.a.createElement(Dt.a,{date:Nt()(new Date(e)).toDate()},o.a.createElement(Ft.c,{value:new Date(e)}))})}])),[]);return o.a.createElement(_.a,{activePage:g,columns:x,dataTestSubj:`table-${y}`,showMorePagesIndicator:c,headerCount:u,headerTitle:At,headerUnit:_t(u),id:n,isInspect:a,itemsPerRow:zt,limit:f,loading:i,loadPage:s,onChange:E,pageOfItems:e,setQuerySkip:l,sorting:Ut(b),totalCount:t,updateActivePage:v,updateLimitPagination:h})};$t.displayName="TlsTableComponent";const Vt=o.a.memo($t),Ut=e=>({field:`node.${e.field}`,direction:e.direction}),Ht=e=>F.r._id,Gt=Object(de.a)(Vt),Qt=({endDate:e,filterQuery:t,flowTarget:n,indexNames:a,ip:i="",setQuery:s,skip:l,startDate:c,type:d})=>{const p=`networkTlsQuery-${d}`,{toggleStatus:m}=Object(pe.a)(p),[g,f]=Object(r.useState)(l||!m);Object(r.useEffect)((()=>{f(l||!m)}),[l,m]);const[b,{id:y,inspect:h,isInspected:v,tls:E,totalCount:x,pageInfo:k,loadPage:w,refetch:j}]=(({endDate:e,filterQuery:t,flowTarget:n,id:a,indexNames:i,ip:o,skip:s,startDate:l,type:c})=>{const d=Object(r.useMemo)((()=>D.e.tlsSelector()),[]),{activePage:p,limit:m,sort:g}=Object(A.a)((e=>d(e,c))),[f,b]=Object(r.useState)(null),y=Object(r.useCallback)((e=>{b((t=>t?{...t,pagination:Object(le.a)(e,m)}:t))}),[m]),{loading:h,result:v,search:E,refetch:x,inspect:k}=Object(ue.a)({factoryQueryType:u.g.tls,initialResult:{edges:[],totalCount:-1,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1}},errorMessage:Ct,abort:s}),S=Object(r.useMemo)((()=>({endDate:e,tls:v.edges,id:a,inspect:k,isInspected:!1,loadPage:y,pageInfo:v.pageInfo,refetch:x,startDate:l,totalCount:v.totalCount})),[e,a,k,x,v.edges,v.pageInfo,v.totalCount,l,y]);return Object(r.useEffect)((()=>{b((a=>{const r={...null!=a?a:{},defaultIndex:i,factoryQueryType:u.g.tls,filterQuery:Object(se.a)(t),flowTarget:n,ip:o,pagination:Object(le.a)(p,m),timerange:{interval:"12h",from:l,to:e},sort:g};return N()(a,r)?a:r}))}),[p,i,e,t,m,l,g,n,o,a]),Object(r.useEffect)((()=>{!s&&f&&E(f)}),[f,E,s]),[h,S]})({endDate:e,filterQuery:t,flowTarget:n,id:p,indexNames:a,ip:i,skip:g,startDate:c,type:d});return o.a.createElement(Gt,{data:E,id:y,inspect:h,isInspect:v,fakeTotalCount:Object(S.getOr)(50,"fakeTotalCount",k),loading:b,loadPage:w,showMorePagesIndicator:Object(S.getOr)(!1,"showMorePagesIndicator",k),refetch:j,setQuery:s,setQuerySkip:f,totalCount:x,type:d})};Qt.displayName="TlsQueryTabBodyComponent";const Wt=o.a.memo(Qt);var Kt=n(77);U.i18n.translate("xpack.securitySolution.networkUsers.errorSearchDescription",{defaultMessage:"An error has occurred on network users search"});const Yt=U.i18n.translate("xpack.securitySolution.networkUsers.failSearchDescription",{defaultMessage:"Failed to run search on network users"});var Jt=n(174);const Xt=U.i18n.translate("xpack.securitySolution.network.ipDetails.usersTable.usersTitle",{defaultMessage:"Users"}),Zt=e=>U.i18n.translate("xpack.securitySolution.network.ipDetails.usersTable.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {user} other {users}}"}),en=U.i18n.translate("xpack.securitySolution.network.ipDetails.usersTable.columns.userNameTitle",{defaultMessage:"User"}),tn=U.i18n.translate("xpack.securitySolution.network.ipDetails.usersTable.columns.userIdTitle",{defaultMessage:"ID"}),nn=U.i18n.translate("xpack.securitySolution.network.ipDetails.usersTable.columns.groupNameTitle",{defaultMessage:"Group name"}),an=U.i18n.translate("xpack.securitySolution.network.ipDetails.usersTable.columns.groupIdTitle",{defaultMessage:"Group ID"}),rn=U.i18n.translate("xpack.securitySolution.network.ipDetails.usersTable.columns.documentCountTitle",{defaultMessage:"Document count"}),on=U.i18n.translate("xpack.securitySolution.network.ipDetails.usersTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),sn=U.i18n.translate("xpack.securitySolution.network.ipDetails.usersTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),ln=D.c.NetworkDetailsTableType.users,cn=[{text:on,numberOfRow:5},{text:sn,numberOfRow:10}],un="users-table",dn=({data:e,fakeTotalCount:t,flowTarget:n,id:a,isInspect:i,loading:s,loadPage:l,setQuerySkip:c,showMorePagesIndicator:u,totalCount:d,type:p})=>{const m=Object(C.useDispatch)(),g=Object(r.useMemo)((()=>D.e.usersSelector()),[]),{activePage:f,sort:b,limit:y}=Object(A.a)(g),h=Object(r.useCallback)((e=>m(D.b.updateNetworkTable({networkType:p,tableType:ln,updates:{limit:e}}))),[m,p]),v=Object(r.useCallback)((e=>m(D.b.updateNetworkTable({networkType:p,tableType:ln,updates:{activePage:e}}))),[m,p]),E=Object(r.useCallback)((e=>{if(null!=e.sort){const t=e.sort.field.split("."),n={field:gn(t[t.length-1]),direction:e.sort.direction};N()(n,b)||m(D.b.updateNetworkTable({networkType:p,tableType:ln,updates:{sort:n}}))}}),[m,b,p]),x=Object(r.useMemo)((()=>((e,t)=>[{field:"node.user.name",name:en,truncateText:!1,mobileOptions:{show:!0},sortable:!0,render:n=>Object(nt.b)({rowItem:n,attrName:"user.name",idPrefix:`${t}-table-${e}-user`,isAggregatable:!0,fieldType:"keyword"})},{field:"node.user.id",name:tn,truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:n=>Object(nt.c)({rowItems:n,attrName:"user.id",idPrefix:`${t}-table-${e}`,isAggregatable:!0,fieldType:"keyword"})},{field:"node.user.groupName",name:nn,truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:n=>Object(nt.c)({rowItems:n,attrName:"user.group.name",idPrefix:`${t}-table-${e}`,isAggregatable:!0,fieldType:"keyword"})},{field:"node.user.groupId",name:an,truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:n=>Object(nt.c)({rowItems:n,attrName:"user.group.id",idPrefix:`${t}-table-${e}`,isAggregatable:!0,fieldType:"keyword"})},{align:"right",field:"node.user.count",name:rn,truncateText:!1,mobileOptions:{show:!0},sortable:!0,render:e=>Object(z.a)(e)}])(n,un)),[n,un]);return o.a.createElement(_.a,{activePage:f,columns:x,dataTestSubj:`table-${ln}`,showMorePagesIndicator:u,headerCount:d,headerTitle:Xt,headerUnit:Zt(d),id:a,isInspect:i,itemsPerRow:cn,limit:y,loading:s,loadPage:l,onChange:E,pageOfItems:e,setQuerySkip:c,sorting:mn(b),totalCount:t,updateActivePage:v,updateLimitPagination:h})};dn.displayName="UsersTableComponent";const pn=o.a.memo(dn),mn=e=>{switch(e.field){case F.t.name:case F.t.count:return{field:`node.user.${e.field}`,direction:e.direction}}return Object(Jt.a)(e.field)},gn=e=>{switch(e){case F.t.name.valueOf():return F.t.name;case F.t.count.valueOf():return F.t.count;default:return F.t.name}},fn=Object(de.a)(pn),bn=({endDate:e,filterQuery:t,flowTarget:n,ip:a,setQuery:i,skip:s,startDate:l,type:c})=>{const d=`networkUsersQuery-${c}`,{toggleStatus:p}=Object(pe.a)(d),[m,g]=Object(r.useState)(s||!p);Object(r.useEffect)((()=>{g(s||!p)}),[s,p]);const[f,{id:b,inspect:y,isInspected:v,networkUsers:E,totalCount:x,pageInfo:k,loadPage:w,refetch:j}]=(({endDate:e,filterQuery:t,flowTarget:n,id:a,ip:i,skip:o,startDate:s})=>{const l=Object(r.useMemo)((()=>D.e.usersSelector()),[]),{activePage:c,sort:d,limit:p}=Object(A.a)(l),{uiSettings:m}=Object(Kt.k)().services,g=m.get(h.S),[f,b]=Object(r.useState)(null),y=Object(r.useCallback)((e=>{b((t=>t?{...t,pagination:Object(le.a)(e,p)}:t))}),[p]),{loading:v,result:E,search:x,refetch:k,inspect:S}=Object(ue.a)({factoryQueryType:u.g.users,initialResult:{edges:[],totalCount:-1,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1}},errorMessage:Yt,abort:o}),w=Object(r.useMemo)((()=>({endDate:e,networkUsers:E.edges,id:a,inspect:S,isInspected:!1,loadPage:y,pageInfo:E.pageInfo,refetch:k,startDate:s,totalCount:E.totalCount})),[e,a,S,k,E.edges,E.pageInfo,E.totalCount,s,y]);return Object(r.useEffect)((()=>{b((a=>{const r={...null!=a?a:{},ip:i,defaultIndex:g,factoryQueryType:u.g.users,filterQuery:Object(se.a)(t),flowTarget:n,pagination:Object(le.a)(c,p),sort:d,timerange:{interval:"12h",from:s,to:e}};return N()(a,r)?a:r}))}),[c,g,e,t,p,s,d,i,n]),Object(r.useEffect)((()=>{!o&&f&&x(f)}),[f,x,o]),[v,w]})({endDate:e,filterQuery:t,flowTarget:n,id:d,ip:a,skip:m,startDate:l});return o.a.createElement(fn,{data:E,id:b,inspect:y,isInspect:v,flowTarget:n,fakeTotalCount:Object(S.getOr)(50,"fakeTotalCount",k),loading:f,loadPage:w,showMorePagesIndicator:Object(S.getOr)(!1,"showMorePagesIndicator",k),refetch:j,setQuery:i,setQuerySkip:g,totalCount:x,type:c})};bn.displayName="UsersQueryTable"},function(e,t,n){"use strict";n.d(t,"a",(function(){return kt}));var a=n(4),i=n.n(a),r=n(78),o=n(32),s=n(35),l=n(37),c=n(96),u=n(341),d=n(33),p=n.n(d),m=n(162);function g(e,t,n){return t+(e>1?n*(e-1):0)}var f=n(40);function b(){return Object(a.useMemo)((()=>({copyableFieldBackground:f.euiThemeVars.euiColorLightShade,descriptionText:f.euiThemeVars.euiTextColor,full:f.euiThemeVars.euiColorFullShade,graphControls:f.euiThemeVars.euiColorDarkestShade,graphControlsBackground:f.euiThemeVars.euiColorEmptyShade,graphControlsBorderColor:f.euiThemeVars.euiColorLightShade,processBackingFill:`${f.euiThemeVars.euiColorPrimary}${f.darkMode?"1F":"0F"}`,resolverBackground:f.euiThemeVars.euiColorEmptyShade,resolverEdge:f.darkMode?f.euiThemeVars.euiColorLightShade:f.euiThemeVars.euiColorLightestShade,resolverBreadcrumbBackground:f.euiThemeVars.euiColorLightestShade,resolverEdgeText:f.darkMode?f.euiThemeVars.euiColorFullShade:f.euiThemeVars.euiColorDarkShade,triggerBackingFill:`${f.euiThemeVars.euiColorDanger}${f.darkMode?"1F":"0F"}`,pillStroke:f.euiThemeVars.euiColorLightShade,linkColor:f.euiThemeVars.euiLinkColor})),[])}const y=p.a.div.withConfig({displayName:"StyledEdgeLine",componentId:"sc-6iesrv-0"})(["position:absolute;height:",";background-color:",";z-index:10;"],(e=>`${g(e.magFactorX,12,8.5)}px`),(e=>e.resolverEdgeColor)),h=p.a.div.withConfig({displayName:"StyledElapsedTime",componentId:"sc-6iesrv-1"})(["background-color:",";color:",";font-size:",";font-weight:bold;max-width:75%;overflow:hidden;position:absolute;text-overflow:ellipsis;top:50%;white-space:nowrap;left:",";padding:6px 8px;border-radius:999px;transform:translate(-50%,-50%);user-select:none;"],(e=>e.backgroundColor),(e=>e.textColor),(e=>`${e.scaledTypeSize}px`),(e=>`${e.leftPct}%`)),v=i.a.memo((({className:e,edgeLineMetadata:t,startPosition:n,endPosition:a,projectionMatrix:r})=>{const o=Object(m.c)(n,r),l=Object(m.c)(a,r),[c]=r,u=b(),d=null==t?void 0:t.elapsedTime,p=Object(m.d)(o,l),f=g(c,10,7.5),v={left:`${o[0]}px`,top:`${o[1]}px`,width:`${p}px`,transformOrigin:"top left",transform:`translateY(-50%) rotateZ(${Object(m.b)(o,l)}rad)`};let E=50;return c<1&&(E+=1/c*(10*(1-c))),i.a.createElement(y,{className:e,style:v,resolverEdgeColor:u.resolverEdge,magFactorX:c,"data-test-subj":"resolver:graph:edgeline"},d&&i.a.createElement(h,{backgroundColor:u.resolverEdge,leftPct:E,scaledTypeSize:f,textColor:u.resolverEdgeText},i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.elapsedTime",defaultMessage:"{duration} {durationType}",values:{duration:d.duration,durationType:d.durationType}})))}));var E=n(0),x=n(408);const k={timestamp:()=>Date.now(),requestAnimationFrame:(...e)=>window.requestAnimationFrame(...e),cancelAnimationFrame:(...e)=>window.cancelAnimationFrame(...e),ResizeObserver:n.n(x).a,writeTextToClipboard:e=>navigator.clipboard.writeText(e),getBoundingClientRect:e=>e.getBoundingClientRect()},S=Object(a.createContext)(k),w=p()(o.EuiDescriptionList).withConfig({displayName:"StyledDescriptionList",componentId:"sc-254p1f-0"})(["&.euiDescriptionList.euiDescriptionList--column dt.euiDescriptionList__title.desc-title{max-width:10em;}"]),j=p()("h4").withConfig({displayName:"StyledTitle",componentId:"sc-254p1f-1"})(["overflow-wrap:break-word;"]),O=p()(o.EuiBreadcrumbs).withConfig({displayName:"ThemedBreadcrumbs",componentId:"sc-254p1f-2"})(["&.euiBreadcrumbs{background-color:",";color:",";padding:1em;border-radius:5px;}& .euiBreadcrumbSeparator{background:",";}"],(e=>e.background),(e=>e.text),(e=>e.text)),I=p.a.div.withConfig({displayName:"StyledButtonTextContainer",componentId:"sc-254p1f-3"})(["align-items:center;display:flex;flex-direction:row;"]),T=p.a.div.withConfig({displayName:"StyledAnalyzedEvent",componentId:"sc-254p1f-4"})(["color:",";font-size:10.5px;font-weight:700;"],(e=>e.color)),C=p.a.div.withConfig({displayName:"StyledLabelTitle",componentId:"sc-254p1f-5"})([""]),M=p.a.div.withConfig({displayName:"StyledLabelContainer",componentId:"sc-254p1f-6"})(["display:inline-block;flex:3;min-width:0;",",","{overflow:hidden;text-align:left;text-overflow:ellipsis;white-space:nowrap;}"],T,C),N=p()(o.EuiCode).withConfig({displayName:"BoldCode",componentId:"sc-254p1f-7"})(["&.euiCodeBlock code.euiCodeBlock__code{font-weight:900;}"]),D=p()("time").withConfig({displayName:"StyledTime",componentId:"sc-254p1f-8"})(["display:inline-block;text-align:start;"]);function F(){const e=Object(r.useSelector)(c.E);return Object(a.useMemo)((()=>{const t=`${e}-symbols`;return{processNodeLabel:`${t}-nodeSymbol`,runningProcessCube:`${t}-runningCube`,runningTriggerCube:`${t}-runningTriggerCube`,terminatedProcessCube:`${t}-terminatedCube`,terminatedTriggerCube:`${t}-terminatedTriggerCube`,processCubeActiveBacking:`${t}-activeBacking`,loadingCube:`${t}-loadingCube`,errorCube:`${t}-errorCube`}}),[e])}function A(e,t){const n=F(),i=b(),r=Object(a.useMemo)((()=>({runningProcessCube:{backingFill:i.processBackingFill,cubeSymbol:`#${n.runningProcessCube}`,descriptionFill:i.descriptionText,descriptionText:E.i18n.translate("xpack.securitySolution.endpoint.resolver.runningProcess",{defaultMessage:"Running Process"}),isLabelFilled:!0,labelButtonFill:"primary",strokeColor:f.euiThemeVars.euiColorPrimary},loadingCube:{backingFill:i.processBackingFill,cubeSymbol:`#${n.loadingCube}`,descriptionFill:i.descriptionText,descriptionText:E.i18n.translate("xpack.securitySolution.endpoint.resolver.loadingProcess",{defaultMessage:"Loading Process"}),isLabelFilled:!1,labelButtonFill:"primary",strokeColor:f.euiThemeVars.euiColorPrimary},errorCube:{backingFill:i.processBackingFill,cubeSymbol:`#${n.errorCube}`,descriptionFill:i.descriptionText,descriptionText:E.i18n.translate("xpack.securitySolution.endpoint.resolver.errorProcess",{defaultMessage:"Error Process"}),isLabelFilled:!1,labelButtonFill:"primary",strokeColor:f.euiThemeVars.euiColorPrimary},runningTriggerCube:{backingFill:i.triggerBackingFill,cubeSymbol:`#${n.runningTriggerCube}`,descriptionFill:i.descriptionText,descriptionText:E.i18n.translate("xpack.securitySolution.endpoint.resolver.runningTrigger",{defaultMessage:"Running Trigger"}),isLabelFilled:!0,labelButtonFill:"danger",strokeColor:f.euiThemeVars.euiColorDanger},terminatedProcessCube:{backingFill:i.processBackingFill,cubeSymbol:`#${n.terminatedProcessCube}`,descriptionFill:i.descriptionText,descriptionText:E.i18n.translate("xpack.securitySolution.endpoint.resolver.terminatedProcess",{defaultMessage:"Terminated Process"}),isLabelFilled:!1,labelButtonFill:"primary",strokeColor:f.euiThemeVars.euiColorPrimary},terminatedTriggerCube:{backingFill:i.triggerBackingFill,cubeSymbol:`#${n.terminatedTriggerCube}`,descriptionFill:i.descriptionText,descriptionText:E.i18n.translate("xpack.securitySolution.endpoint.resolver.terminatedTrigger",{defaultMessage:"Terminated Trigger"}),isLabelFilled:!1,labelButtonFill:"danger",strokeColor:f.euiThemeVars.euiColorDanger}})),[n,i]);return"terminated"===e?t?r.terminatedTriggerCube:r[_.processTerminated]:"running"===e?t?r[_.processCausedAlert]:r[_.processRan]:"error"===e?r[_.processError]:r[_.processLoading]}const _={processCreated:"runningProcessCube",processRan:"runningProcessCube",processTerminated:"terminatedProcessCube",unknownProcessEvent:"runningProcessCube",processCausedAlert:"runningTriggerCube",processLoading:"loadingCube",processError:"errorCube",unknownEvent:"runningProcessCube"},R=Object(a.memo)((function({className:e,size:t="2.15em",state:n,isOrigin:a,"data-test-subj":r}){const{cubeSymbol:o,strokeColor:s}=A(n,!1),{processCubeActiveBacking:l}=F();return i.a.createElement(P,{className:e,width:t,height:t,viewBox:"0 0 34 34","data-test-subj":r,isOrigin:a,style:{verticalAlign:"middle"}},i.a.createElement("desc",null,E.i18n.translate("xpack.securitySolution.resolver.node_icon",{defaultMessage:"{state, select, running {Running Process} terminated {Terminated Process} loading {Loading Process} error {Error Process}}",values:{state:n}})),a&&i.a.createElement("use",{xlinkHref:`#${l}`,fill:"transparent",x:0,y:-1,stroke:s,strokeDashoffset:0,width:"100%",height:"100%"}),i.a.createElement("use",{role:"presentation",xlinkHref:o,x:5.25,y:4.25,width:"70%",height:"70%",opacity:"1",className:"cube"}))})),P=p.a.svg.withConfig({displayName:"StyledSVG",componentId:"sc-14ztjy8-0"})(["margin-right:",";"],(e=>e.isOrigin?"0.15em":0)),L=i.a.memo((function({children:e}){return i.a.createElement(i.a.Fragment,null,i.a.Children.map(e,(e=>{if("string"==typeof e){const t=e.split(/\b/);return t.length<2?t[0]:[t[0],...t.splice(1).reduce((function(e,t){return[...e,t,i.a.createElement("wbr",null)]}),[])]}return e})))})),q=p()(o.EuiRange).withConfig({displayName:"StyledEuiRange",componentId:"sc-1wdm067-0"})(["& .euiRangeTrack:after{left:-65px;transform:rotate(90deg);}"]),B=p.a.div.withConfig({displayName:"StyledGraphControlsColumn",componentId:"sc-1wdm067-1"})(["display:flex;flex-direction:column;&:not(last-of-type){margin-right:5px;}"]),z=p()(o.EuiDescriptionListTitle).withConfig({displayName:"StyledEuiDescriptionListTitle",componentId:"sc-1wdm067-2"})(["text-transform:uppercase;max-width:25%;"]),$=p()(o.EuiDescriptionListDescription).withConfig({displayName:"StyledEuiDescriptionListDescription",componentId:"sc-1wdm067-3"})(["min-width:75%;width:75%;"]),V=p()(o.EuiButtonIcon).withConfig({displayName:"StyledEuiButtonIcon",componentId:"sc-1wdm067-4"})(["background-color:",";color:",";border-color:",";border-width:1px;border-style:solid;border-radius:4px;width:40px;height:40px;&:not(last-of-type){margin-bottom:7px;}"],(e=>e.$backgroundColor),(e=>e.$iconColor),(e=>e.$borderColor)),U=p.a.div.withConfig({displayName:"StyledGraphControls",componentId:"sc-1wdm067-5"})(["display:flex;flex-direction:row;position:absolute;top:5px;right:5px;background-color:transparent;color:",";.zoom-controls{display:flex;flex-direction:column;align-items:center;padding:5px 0px;.zoom-slider{width:20px;height:150px;margin:5px 0px 2px 0px;input[type='range']{width:150px;height:20px;transform-origin:75px 75px;transform:rotate(-90deg);}}}.panning-controls{text-align:center;}"],(e=>e.$iconColor)),H=i.a.memo((({className:e})=>{const t=Object(r.useDispatch)(),n=Object(r.useSelector)(c.H),{timestamp:s}=Object(a.useContext)(S),[l,u]=Object(a.useState)(null),d=b(),p=Object(a.useCallback)((e=>{u(e===l?null:e)}),[u,l]),m=Object(a.useCallback)((()=>u(null)),[]),g=Object(a.useCallback)((e=>{const n=parseFloat(e.target.value);!1===isNaN(n)&&t({type:"userSetZoomLevel",payload:n})}),[t]),f=Object(a.useCallback)((()=>{t({type:"userSetPositionOfCamera",payload:[0,0]})}),[t]),y=Object(a.useCallback)((()=>{t({type:"userClickedZoomOut"})}),[t]),h=Object(a.useCallback)((()=>{t({type:"userClickedZoomIn"})}),[t]),[v,x,k,w]=Object(a.useMemo)((()=>[[0,1],[1,0],[0,-1],[-1,0]].map((e=>()=>{const n={type:"userNudgedCamera",payload:{direction:e,time:s()}};t(n)}))),[t,s]);return i.a.createElement(U,{className:e,$iconColor:d.graphControls,"data-test-subj":"resolver:graph-controls"},i.a.createElement(B,null,i.a.createElement(G,{closePopover:m,isOpen:"schemaInfo"===l,setActivePopover:p}),i.a.createElement(Q,{closePopover:m,isOpen:"nodeLegend"===l,setActivePopover:p})),i.a.createElement(B,null,i.a.createElement(o.EuiPanel,{className:"panning-controls",paddingSize:"none",hasBorder:!0},i.a.createElement("div",{className:"panning-controls-top"},i.a.createElement("button",{className:"north-button","data-test-subj":"resolver:graph-controls:north-button",title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.north",{defaultMessage:"North"}),onClick:v},i.a.createElement(o.EuiIcon,{type:"arrowUp"}))),i.a.createElement("div",{className:"panning-controls-middle"},i.a.createElement("button",{className:"west-button","data-test-subj":"resolver:graph-controls:west-button",title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.west",{defaultMessage:"West"}),onClick:w},i.a.createElement(o.EuiIcon,{type:"arrowLeft"})),i.a.createElement("button",{className:"center-button","data-test-subj":"resolver:graph-controls:center-button",title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.center",{defaultMessage:"Center"}),onClick:f},i.a.createElement(o.EuiIcon,{type:"bullseye"})),i.a.createElement("button",{className:"east-button","data-test-subj":"resolver:graph-controls:east-button",title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.east",{defaultMessage:"East"}),onClick:x},i.a.createElement(o.EuiIcon,{type:"arrowRight"}))),i.a.createElement("div",{className:"panning-controls-bottom"},i.a.createElement("button",{className:"south-button","data-test-subj":"resolver:graph-controls:south-button",title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.south",{defaultMessage:"South"}),onClick:k},i.a.createElement(o.EuiIcon,{type:"arrowDown"})))),i.a.createElement(o.EuiPanel,{className:"zoom-controls",paddingSize:"none",hasBorder:!0},i.a.createElement("button",{title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.zoomIn",{defaultMessage:"Zoom In"}),"data-test-subj":"resolver:graph-controls:zoom-in",onClick:h},i.a.createElement(o.EuiIcon,{type:"plusInCircle"})),i.a.createElement(q,{className:"zoom-slider","data-test-subj":"resolver:graph-controls:zoom-slider",min:0,max:1,step:.01,value:n,onChange:g}),i.a.createElement("button",{title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.zoomOut",{defaultMessage:"Zoom Out"}),"data-test-subj":"resolver:graph-controls:zoom-out",onClick:y},i.a.createElement(o.EuiIcon,{type:"minusInCircle"})))))})),G=({closePopover:e,setActivePopover:t,isOpen:n})=>{var s,l,u;const d=b(),p=Object(r.useSelector)(c.G),m=Object(a.useCallback)((()=>t("schemaInfo")),[t]),g=E.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaInfoButtonTitle",{defaultMessage:"Schema Information"}),f=E.i18n.translate("xpack.securitySolution.resolver.graphControls.unknownSchemaValue",{defaultMessage:"Unknown"});return i.a.createElement(o.EuiPopover,{button:i.a.createElement(V,{"data-test-subj":"resolver:graph-controls:schema-info-button",size:"m",title:g,"aria-label":g,onClick:m,iconType:"iInCircle",$backgroundColor:d.graphControlsBackground,$iconColor:d.graphControls,$borderColor:d.graphControlsBorderColor}),isOpen:n,closePopover:e,anchorPosition:"leftCenter"},i.a.createElement(o.EuiPopoverTitle,{style:{textTransform:"uppercase"}},E.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaInfoTitle",{defaultMessage:"process tree"}),i.a.createElement(o.EuiIconTip,{content:E.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaInfoTooltip",{defaultMessage:"These are the fields used to create the process tree"}),position:"right"})),i.a.createElement("div",{style:{maxWidth:"268px"}},i.a.createElement(w,{"data-test-subj":"resolver:graph-controls:schema-info",type:"column",align:"left",compressed:!0},i.a.createElement(i.a.Fragment,null,i.a.createElement(z,{"data-test-subj":"resolver:graph-controls:schema-info:title",style:{width:"30%"}},E.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaSource",{defaultMessage:"source"})),i.a.createElement($,{"data-test-subj":"resolver:graph-controls:schema-info:description",style:{width:"70%"}},i.a.createElement(L,null,null!==(s=null==p?void 0:p.dataSource)&&void 0!==s?s:f)),i.a.createElement(z,{"data-test-subj":"resolver:graph-controls:schema-info:title",style:{width:"30%"}},E.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaID",{defaultMessage:"id"})),i.a.createElement($,{"data-test-subj":"resolver:graph-controls:schema-info:description",style:{width:"70%"}},i.a.createElement(L,null,null!==(l=null==p?void 0:p.schema.id)&&void 0!==l?l:f)),i.a.createElement(z,{"data-test-subj":"resolver:graph-controls:schema-info:title",style:{width:"30%"}},E.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaEdge",{defaultMessage:"edge"})),i.a.createElement($,{"data-test-subj":"resolver:graph-controls:schema-info:description",style:{width:"70%"}},i.a.createElement(L,null,null!==(u=null==p?void 0:p.schema.parent)&&void 0!==u?u:f))))))},Q=({closePopover:e,setActivePopover:t,isOpen:n})=>{const r=Object(a.useCallback)((()=>t("nodeLegend")),[t]),s=b(),l=E.i18n.translate("xpack.securitySolution.resolver.graphControls.nodeLegendButtonTitle",{defaultMessage:"Node Legend"});return i.a.createElement(o.EuiPopover,{button:i.a.createElement(V,{"data-test-subj":"resolver:graph-controls:node-legend-button",size:"m",title:l,"aria-label":l,onClick:r,iconType:"node",$backgroundColor:s.graphControlsBackground,$iconColor:s.graphControls,$borderColor:s.graphControlsBorderColor}),isOpen:n,closePopover:e,anchorPosition:"leftCenter"},i.a.createElement(o.EuiPopoverTitle,{style:{textTransform:"uppercase"}},E.i18n.translate("xpack.securitySolution.resolver.graphControls.nodeLegend",{defaultMessage:"legend"})),i.a.createElement("div",{style:{maxWidth:"212px"}},i.a.createElement(w,{"data-test-subj":"resolver:graph-controls:node-legend",type:"column",align:"left",compressed:!0},i.a.createElement(i.a.Fragment,null,i.a.createElement(z,{"data-test-subj":"resolver:graph-controls:node-legend:title",style:{width:"20% "}},i.a.createElement(R,{size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"running"})),i.a.createElement($,{"data-test-subj":"resolver:graph-controls:node-legend:description",style:{width:"80%",lineHeight:"2.2em"}},i.a.createElement(L,null,E.i18n.translate("xpack.securitySolution.resolver.graphControls.runningProcessCube",{defaultMessage:"Running Process"}))),i.a.createElement(z,{"data-test-subj":"resolver:graph-controls:node-legend:title",style:{width:"20% "}},i.a.createElement(R,{size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"terminated"})),i.a.createElement($,{"data-test-subj":"resolver:graph-controls:node-legend:description",style:{width:"80%",lineHeight:"2.2em"}},i.a.createElement(L,null,E.i18n.translate("xpack.securitySolution.resolver.graphControls.terminatedProcessCube",{defaultMessage:"Terminated Process"}))),i.a.createElement(z,{"data-test-subj":"resolver:graph-controls:node-legend:title",style:{width:"20% "}},i.a.createElement(R,{size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"loading"})),i.a.createElement($,{"data-test-subj":"resolver:graph-controls:node-legend:description",style:{width:"80%",lineHeight:"2.2em"}},i.a.createElement(L,null,E.i18n.translate("xpack.securitySolution.resolver.graphControls.currentlyLoadingCube",{defaultMessage:"Loading Process"}))),i.a.createElement(z,{"data-test-subj":"resolver:graph-controls:node-legend:title",style:{width:"20% "}},i.a.createElement(R,{size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"error"})),i.a.createElement($,{"data-test-subj":"resolver:graph-controls:node-legend:description",style:{width:"80%",lineHeight:"2.2em"}},i.a.createElement(L,null,E.i18n.translate("xpack.securitySolution.resolver.graphControls.errorCube",{defaultMessage:"Error Process"})))))))};function W(e){return function(e,t){const n=Object(l.useHistory)(),i=Object(a.useCallback)((t=>{t.defaultPrevented||0===t.button&&(t.currentTarget instanceof HTMLAnchorElement&&""!==t.currentTarget.target&&"_self"!==t.currentTarget.target||t.metaKey||t.altKey||t.ctrlKey||t.shiftKey||(t.preventDefault(),n.push(e)))}),[n,t,e]);return{href:n.createHref(e),onClick:i}}({search:Object(r.useSelector)((t=>c.D(t)(e)))})}var K=n(234);const Y=i.a.memo((({className:e,nodeID:t,nodeStats:n})=>{const r=Object(a.useMemo)((()=>void 0===n?[]:Object.entries(n.byCategory).map((([e,t])=>({prefix:i.a.createElement(K.a,{count:t||0}),category:e})))),[n]);return void 0===r?null:i.a.createElement("ul",{className:`${e} options`,"aria-describedby":t},r.sort(((e,t)=>e.category.localeCompare(t.category))).map((e=>i.a.createElement(J,{pill:e,nodeID:t,key:e.category}))))})),J=({pill:e,nodeID:t})=>{const n=W({panelView:"nodeEventsInCategory",panelParameters:{nodeID:t,eventCategory:e.category}}),{pillStroke:o,resolverBackground:s}=b(),l=Object(a.useMemo)((()=>({border:`1.5px solid ${o}`,backgroundColor:s})),[o,s]),c=Object(r.useDispatch)(),{timestamp:u}=Object(a.useContext)(S),d=Object(a.useCallback)((e=>{n.onClick(e),c({type:"userSelectedResolverNode",payload:{nodeID:t,time:u()}})}),[u,n,c,t]);return i.a.createElement("li",{className:"item","data-test-subj":"resolver:map:node-submenu-item",style:l,key:e.category},i.a.createElement("button",{type:"button",className:"kbn-resetFocusState",onClick:d},e.prefix," ",e.category))},X=p()(Y).withConfig({displayName:"NodeSubMenu",componentId:"sc-1p5k68h-0"})(["margin:2px 0 0 0;padding:0;border:none;display:flex;flex-flow:column;z-index:auto;&.options{font-size:0.8rem;display:flex;flex-flow:row wrap;background:transparent;position:absolute;top:4.5em;overflow-x:visible;width:24ch;z-index:auto;}&.options::after{position:absolute;content:'';width:100%;height:100%;left:0;top:0;z-index:20;backdrop-filter:blur(2px);pointer-events:none;}&.options .item{margin:0.25ch 0.35ch 0.35ch 0;padding:0.35em 0.5em;height:fit-content;width:fit-content;border-radius:2px;line-height:0.8;z-index:40;}&.options .item button{appearance:none;height:fit-content;width:fit-content;line-height:0.8;outline-style:none;border-color:transparent;box-shadow:none;}&.options .item button:focus{outline-style:none;border-color:transparent;box-shadow:none;text-decoration:underline;}&.options .item button:active{transform:scale(0.95);}"]),Z=p.a.div.withConfig({displayName:"StyledMapContainer",componentId:"sc-1p5k68h-1"})(["&,.resolver-graph{display:flex;flex-grow:1;}.loading-container{display:flex;align-items:center;justify-content:center;flex-grow:1;}min-height:652px;position:relative;overflow:hidden;contain:strict;background-color:",";"],(e=>e.backgroundColor)),ee=p()(o.EuiPanel).withConfig({displayName:"StyledPanel",componentId:"sc-1p5k68h-2"})(["position:absolute;left:0;top:0;bottom:0;overflow:auto;width:25em;max-width:50%;border-radius:0;border-top:none;"]),te=p.a.div.withConfig({displayName:"GraphContainer",componentId:"sc-1p5k68h-3"})(["display:flex;flex-grow:1;contain:layout;position:relative;z-index:0;"]),ne=p()(o.EuiCallOut).withConfig({displayName:"LimitWarningsEuiCallOut",componentId:"sc-1p5k68h-4"})(["flex-flow:row wrap;display:block;align-items:baseline;margin-top:1em;& .euiCallOutHeader{display:inline;margin-right:0.25em;}& .euiText{display:inline;}& .euiText p{display:inline;}"]),ae=r.useDispatch;var ie=n(144),re=n(151),oe=n(222);const se=p.a.div.withConfig({displayName:"StyledActionsContainer",componentId:"sc-14u1iy3-0"})(["background-color:transparent;color:",";display:flex;flex-flow:column;font-size:",";left:20.9%;line-height:140%;padding:0.25rem 0 0 0.1rem;position:absolute;top:",";width:auto;pointer-events:all;"],(e=>e.color),(e=>`${e.fontSize}px`),(e=>`${e.topPct}%`)),le=p.a.div.withConfig({displayName:"StyledDescriptionText",componentId:"sc-14u1iy3-1"})(["background-color:",";color:",";display:",";font-size:0.8rem;font-weight:bold;letter-spacing:-0.01px;line-height:1;margin:0;padding:4px 0 0 2px;text-align:left;text-transform:uppercase;width:fit-content;z-index:45;"],(e=>e.backgroundColor),(e=>e.color),(e=>e.isDisplaying?"block":"none")),ce=p.a.span.withConfig({displayName:"StyledEuiButtonContent",componentId:"sc-14u1iy3-2"})(["padding:",";"],(e=>e.isShowingIcon?"0px":"0 12px")),ue=p.a.g.withConfig({displayName:"StyledOuterGroup",componentId:"sc-14u1iy3-3"})(["fill:none;pointer-events:visiblePainted;",""],(e=>e.isNodeLoading&&"\n    & .cube {\n    animation-name: pulse;\n    /**\n     * his is a multiple of .6 so it can match up with the EUI button's loading spinner\n     * which is (0.6s). Using .6 here makes it a bit too fast.\n     */\n    animation-duration: 1.8s;\n    animation-delay: 0;\n    animation-direction: normal;\n    animation-iteration-count: infinite;\n    animation-timing-function: linear;\n  }\n\n  /**\n   * Animation loading state of the cube.\n   */\n  @keyframes pulse {\n    0% {\n      opacity: 1;\n    }\n    50% {\n      opacity: 0.35;\n    }\n    100% {\n      opacity: 1;\n    }\n  }\n  ")),de=i.a.memo((({className:e,position:t,node:n,nodeID:l,projectionMatrix:u,timeAtRender:d})=>{const p=`resolver:${Object(r.useSelector)(c.E)}`,f=F(),{timestamp:y}=Object(a.useContext)(S),[h,v]=Object(m.c)(t,u),[x]=u,k=Object(r.useSelector)(c.a),w=Object(r.useSelector)(c.I),j=Object(r.useSelector)(c.y),O=Object(r.useSelector)((e=>c.x(e)(l))),I=Object(a.useCallback)((e=>Object(o.htmlIdGenerator)(p)(`${e}:node`)),[p]),T=Object(r.useSelector)((e=>c.c(e)(l))),C=Object(r.useSelector)((e=>c.b(e)(d)(l))),M=x>.8,N=x>=.55,D=(M?3.5:N?1:21)*x+5,_=360*(M?-.147413:-.147413-.08*(x-.5))*x,R=120*(M?-.53684:.2*-x*(1-x)/x-.53684)*x,P=Object(a.useMemo)((()=>({left:`${h+_}px`,top:`${v+R}px`,width:360*x+"px",height:120*x+"px"})),[h,x,_,R,v]),L=g(x,18.75,12.5),q=i.a.createRef(),B=b(),z=Object(r.useSelector)((e=>c.v(e)(l))),$="loading"===z,{backingFill:V,cubeSymbol:U,descriptionText:H,isLabelFilled:G,labelButtonFill:Q,strokeColor:K}=A(z,!1),Y=Object(o.htmlIdGenerator)("resolver")(`${l}:label`),J=l===k,Z=l===w,ee=l===j,te=ae(),ne=W({panelView:"nodeDetail",panelParameters:{nodeID:l}}),de=Object(a.useCallback)((()=>{te({type:"userFocusedOnResolverNode",payload:{nodeID:l,time:y()}})}),[te,l,y]),pe=Object(a.useCallback)((e=>{var t;null!==(t=q.current)&&void 0!==t&&t.beginElement&&q.current.beginElement(),"error"===z?te({type:"userReloadedResolverNode",payload:l}):(te({type:"userSelectedResolverNode",payload:{nodeID:l,time:y()}}),ne.onClick(e))}),[q,te,l,ne,z,y]),me=Object(r.useSelector)((e=>c.J(e)(n))),ge=ie.c(n),fe=Object(r.useSelector)((e=>oe.a(c.u(e)(String(n.id))))),be=Object(a.useMemo)((()=>void 0!==fe?re.l(fe):ge),[fe,ge]);return i.a.createElement("div",{"data-test-subj":"resolver:node","data-test-resolver-node-id":l,className:`${e} kbn-resetFocusState`,role:"treeitem","aria-level":null===T?void 0:T,"aria-flowto":null===C?void 0:I(C),"aria-labelledby":Y,"aria-haspopup":"true","aria-current":J?"true":void 0,"aria-selected":Z?"true":void 0,style:P,id:I(l),tabIndex:-1},i.a.createElement("svg",{viewBox:"-15 -15 90 30",preserveAspectRatio:"xMidYMid meet",onClick:e=>{de(),pe(e)},role:"img","aria-labelledby":Y,fill:"none",style:{display:"block",width:"100%",height:"100%",position:"absolute",top:"0",left:"0",outline:"transparent",border:"none",pointerEvents:"none",zIndex:30}},i.a.createElement(ue,{isNodeLoading:$},i.a.createElement("use",{xlinkHref:`#${f.processCubeActiveBacking}`,fill:V,x:-15.35,y:-15.35,stroke:K,width:22.5,height:22.5,className:"backing"}),ee&&i.a.createElement("use",{xlinkHref:`#${f.processCubeActiveBacking}`,fill:"transparent",x:-15.35,y:-15.35,stroke:K,strokeOpacity:.35,strokeDashoffset:0,width:22.5,height:22.5,className:"origin"}),i.a.createElement("use",{role:"presentation",xlinkHref:U,x:-11.5,y:-11.5,width:15,height:15,opacity:"1",className:"cube"},i.a.createElement("animateTransform",{attributeType:"XML",attributeName:"transform",type:"scale",values:"1 1; 1 .83; 1 .8; 1 .83; 1 1",dur:"0.2s",repeatCount:"1",className:"squish",ref:q})))),i.a.createElement(se,{color:B.full,fontSize:L,topPct:D},i.a.createElement(le,{backgroundColor:B.resolverBackground,color:B.descriptionText,isDisplaying:N,"data-test-subj":"resolver:node:description"},i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.processDescription",defaultMessage:"{isEventBeingAnalyzed, select, true {Analyzed Event Â· {descriptionText}} false {{descriptionText}}}",values:{isEventBeingAnalyzed:ee,descriptionText:H}})),i.a.createElement("div",{className:"euiButton euiButton--small",id:Y,onClick:pe,onFocus:de,tabIndex:-1,style:{backgroundColor:B.resolverBackground,alignSelf:"flex-start",padding:0,zIndex:45}},i.a.createElement(o.EuiButton,{iconSide:$?"right":"left",isLoading:$,color:Q,fill:G,iconType:"error"===z?"refresh":"",size:"s",style:{maxHeight:`${Math.min(26+3*x,32)}px`,maxWidth:(M?400:210*x)+"px"},tabIndex:-1,title:be,"data-test-subj":"resolver:node:primary-button","data-test-resolver-node-id":l},i.a.createElement(ce,{isShowingIcon:"loading"===z||"error"===z,className:"eui-textTruncate","data-test-subj":"euiButton__text"},E.i18n.translate("xpack.securitySolution.resolver.node_button_name",{defaultMessage:"{nodeState, select, error {Reload {nodeName}} other {{nodeName}}}",values:{nodeState:z,nodeName:be}})))),i.a.createElement(o.EuiFlexGroup,{justifyContent:"flexStart",gutterSize:"xs",style:{alignSelf:"flex-start",background:B.resolverBackground,display:M?"flex":"none",margin:"2px 0 0 0",padding:0}},i.a.createElement(o.EuiFlexItem,{grow:!1,className:"related-dropdown"},null!==me&&me>0&&i.a.createElement(X,{buttonFill:B.resolverBackground,nodeStats:O,nodeID:l})))))})),pe=p()(de).withConfig({displayName:"ProcessEventDot",componentId:"sc-14u1iy3-4"})(["position:absolute;text-align:left;font-size:10px;user-select:none;box-sizing:border-box;border-radius:10%;white-space:nowrap;will-change:left,top,width,height;min-width:280px;min-height:90px;overflow-y:visible;pointer-events:none;z-index:auto;& .backing{stroke-dasharray:500;stroke-dashoffset:500;fill-opacity:0;}&:hover:not([aria-current]) .backing{transition-property:fill-opacity;transition-duration:0.25s;fill-opacity:1;}&[aria-current] .backing{transition-property:stroke-dashoffset;transition-duration:1s;stroke-dashoffset:0;}& .euiButton{width:fit-content;}& .euiSelectableList-bordered{border-top-right-radius:0px;border-top-left-radius:0px;}& .euiSelectableListItem{background-color:black;}& .euiSelectableListItem path{fill:white;}& .euiSelectableListItem__text{color:white;}"]);var me=n(41);function ge(){const e=Object(r.useSelector)(c.E);return Object(a.useMemo)((()=>{const t=`${e}-symbols`;return{runningProcessCube:`${t}-psRunningProcessCube`,runningTriggerCube:`${t}-psRunningTriggerCube`,terminatedProcessCube:`${t}-psTerminatedProcessCube`,terminatedTriggerCube:`${t}-psTerminatedTriggerCube`,loadingCube:`${t}-psLoadingCube`,errorCube:`${t}-psErrorCube`}}),[e])}const fe=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.loadingProcess",{defaultMessage:"Loading Process"}),be=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.errorProcess",{defaultMessage:"Error Process"}),ye=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.runningProcess",{defaultMessage:"Running Process"}),he=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.triggerProcess",{defaultMessage:"Trigger Process"}),ve=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.terminatedProcess",{defaultMessage:"Terminated Process"}),Ee=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.terminatedTriggerProcess",{defaultMessage:"Terminated Trigger Process"}),xe=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.hoveredProcessBackground",{defaultMessage:"Hovered Process Background"}),ke=Object(a.memo)((({isDarkMode:e})=>{const t=ge();return i.a.createElement(i.a.Fragment,null,i.a.createElement("linearGradient",{id:t.errorCube,x1:"10.2372",y1:"9.49068",x2:"46.5307",y2:"45.7844",gradientUnits:"userSpaceOnUse"},i.a.createElement("stop",{stopColor:"#6D6D6D"}),i.a.createElement("stop",{offset:"1",stopColor:"#B9B9B9"})),i.a.createElement("linearGradient",{id:t.runningProcessCube,x1:"-381.23556",y1:"264.73802",x2:"-380.48514",y2:"263.8816",gradientTransform:"matrix(70.05179, 0, 0, -79.94774, 26724.01618, 21181.09848)",gradientUnits:"userSpaceOnUse"},i.a.createElement("stop",{offset:"0.00087",stopColor:"#006bb4"}),i.a.createElement("stop",{offset:"1",stopColor:"#54b399"})),i.a.createElement("linearGradient",{id:t.runningTriggerCube,x1:"-381.18643",y1:"264.68195",x2:"-380.48514",y2:"263.8816",gradientTransform:"matrix(70.05179, 0, 0, -79.94774, 26724.01618, 21181.09848)",gradientUnits:"userSpaceOnUse"},i.a.createElement("stop",{offset:"0",stopColor:"#dd0a73"}),i.a.createElement("stop",{offset:"1",stopColor:"#f66"})),e?i.a.createElement(i.a.Fragment,null,i.a.createElement("linearGradient",{id:t.terminatedProcessCube,x1:"-381.23752",y1:"264.24026",x2:"-380.48514",y2:"263.3816",gradientTransform:"matrix(70.05178, 0, 0, -79.94771, 26724.01313, 21140.72096)",gradientUnits:"userSpaceOnUse"},i.a.createElement("stop",{offset:"0",stopColor:"#4c82c3"}),i.a.createElement("stop",{offset:"1",stopColor:"#8bd1c7"})),i.a.createElement("linearGradient",{id:t.terminatedTriggerCube,x1:"-381.18658",y1:"264.68187",x2:"-380.48546",y2:"263.8817",gradientTransform:"matrix(70.05179, 0, 0, -79.94774, 26724.01618, 21181.09848)",gradientUnits:"userSpaceOnUse"},i.a.createElement("stop",{offset:"0",stopColor:"#dd0a73"}),i.a.createElement("stop",{offset:"1",stopColor:"#f66"}))):i.a.createElement(i.a.Fragment,null,i.a.createElement("linearGradient",{id:t.terminatedProcessCube,x1:"10.5206",y1:"9.49068",x2:"46.8141",y2:"45.7844",gradientUnits:"userSpaceOnUse"},i.a.createElement("stop",{offset:"0",stopColor:"#2F6EB6"}),i.a.createElement("stop",{offset:"1",stopColor:"#00B4AC"})),i.a.createElement("linearGradient",{id:t.terminatedTriggerCube,x1:"15.4848",y1:"12.0468",x2:"43.1049",y2:"47.2331",gradientUnits:"userSpaceOnUse"},i.a.createElement("stop",{stopColor:"#DD0A73"}),i.a.createElement("stop",{offset:"1",stopColor:"#FF6666"}))))})),Se=Object(a.memo)((({isDarkMode:e})=>{const t=F(),n=ge();return i.a.createElement(i.a.Fragment,null,i.a.createElement("symbol",{id:t.processNodeLabel,viewBox:"0 0 144 25",preserveAspectRatio:"xMidYMid meet"},i.a.createElement("rect",{x:"1",y:"1",width:"142",height:"23",fill:"inherit",strokeWidth:"0",paintOrder:"normal"})),i.a.createElement("symbol",{id:t.loadingCube,viewBox:"0 0 88 100"},i.a.createElement("title",null,fe),i.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",fill:e?"#1d1e24":"white",stroke:"#98A2B3",strokeWidth:"2"})),i.a.createElement("symbol",{id:t.errorCube,viewBox:"0 0 88 100"},i.a.createElement("title",null,be),i.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",transform:"translate(0.00001 0)",fill:`url(#${n.errorCube})`}),i.a.createElement("g",{opacity:"0.6"},i.a.createElement("path",{opacity:.6,d:"M87.52113,24.73352a3.7956,3.7956,0,0,0-1.43182-1.47166L45.91012.17918a3.8365,3.8365,0,0,0-3.82049,0L1.91029,23.26186A3.86312,3.86312,0,0,0-.00009,26.55445V72.7199a3.79834,3.79834,0,0,0,1.91041,3.29249L42.08963,99.09514a3.83689,3.83689,0,0,0,3.82049,0L86.08931,76.01239a3.79852,3.79852,0,0,0,1.91056-3.29249V26.55445A3.77643,3.77643,0,0,0,87.52113,24.73352Z",transform:"translate(0.00013 0.39551)",fill:`url(#${n.errorCube})`}),i.a.createElement("path",{opacity:.4,d:"M.57134,24.52282a3.79906,3.79906,0,0,1,1.34824-1.32625L42.09878.11387a3.83708,3.83708,0,0,1,3.8208,0L86.09877,23.19655a3.79771,3.79771,0,0,1,1.43182,1.47165L44.00909,49.57182Z",transform:"translate(0.00013 0.39551)",fill:"#fff",style:{isolation:"isolate"}}),i.a.createElement("path",{opacity:.4,d:"M43.99972,49.63713V99.60449a3.83406,3.83406,0,0,1-1.91025-.50932L1.91029,76.01239A3.79835,3.79835,0,0,1-.00013,72.7199V26.55445A3.77431,3.77431,0,0,1,.562,24.5882Z",transform:"translate(0.00013 0.39551)",fill:"#353944",style:{isolation:"isolate"}}))),i.a.createElement("symbol",{id:t.runningProcessCube,viewBox:"0 0 88 100"},i.a.createElement("title",null,ye),i.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",transform:"translate(0.00001 0)",fill:`url(#${n.runningProcessCube})`}),i.a.createElement("g",{opacity:"0.5"},i.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff"}),i.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),i.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),i.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),i.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),i.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}})),i.a.createElement("path",{d:"M.57144,24.91834a3.79909,3.79909,0,0,1,1.34825-1.32625L42.0989.50939a3.837,3.837,0,0,1,3.82081,0L86.09892,23.59206a3.79782,3.79782,0,0,1,1.4318,1.47169L44.00915,49.96733Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.3",style:{isolation:"isolate"}}),i.a.createElement("path",{d:"M43.99984,50.03265V100a3.83392,3.83392,0,0,1-1.91024-.50933L1.91039,76.40791A3.79835,3.79835,0,0,1,0,73.11541V26.95a3.77423,3.77423,0,0,1,.56216-1.96625Z",transform:"translate(0.00001 0)",fill:"#353944",opacity:"0.2",style:{isolation:"isolate"}})),i.a.createElement("symbol",{id:t.runningTriggerCube,viewBox:"0 0 88 100"},i.a.createElement("title",null,he),i.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",transform:"translate(0.00001 0)",fill:`url(#${n.runningTriggerCube})`}),i.a.createElement("g",{opacity:"0.5"},i.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff"}),i.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),i.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),i.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),i.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),i.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}})),i.a.createElement("path",{d:"M.57144,24.91834a3.79909,3.79909,0,0,1,1.34825-1.32625L42.0989.50939a3.837,3.837,0,0,1,3.82081,0L86.09892,23.59206a3.79782,3.79782,0,0,1,1.4318,1.47169L44.00915,49.96733Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.3",style:{isolation:"isolate"}}),i.a.createElement("path",{d:"M43.99984,50.03265V100a3.83392,3.83392,0,0,1-1.91024-.50933L1.91039,76.40791A3.79835,3.79835,0,0,1,0,73.11541V26.95a3.77423,3.77423,0,0,1,.56216-1.96625Z",transform:"translate(0.00001 0)",fill:"#353944",opacity:"0.2",style:{isolation:"isolate"}})),i.a.createElement("symbol",{viewBox:"0 0 88 100",id:t.terminatedProcessCube},i.a.createElement("title",null,ve),i.a.createElement("path",{d:"M87.52113,24.73352a3.7956,3.7956,0,0,0-1.43182-1.47166L45.91012.17918a3.8365,3.8365,0,0,0-3.82049,0L1.91029,23.26186A3.86312,3.86312,0,0,0-.00009,26.55445V72.7199a3.79834,3.79834,0,0,0,1.91041,3.29249L42.08963,99.09514a3.83689,3.83689,0,0,0,3.82049,0L86.08931,76.01239a3.79852,3.79852,0,0,0,1.91056-3.29249V26.55445A3.77643,3.77643,0,0,0,87.52113,24.73352Z",transform:"translate(0.00013 0.39551)",fill:e?"#010101":"#fff"}),i.a.createElement("g",{opacity:"0.7"},i.a.createElement("path",{opacity:e?1:.6,d:"M87.52113,24.73352a3.7956,3.7956,0,0,0-1.43182-1.47166L45.91012.17918a3.8365,3.8365,0,0,0-3.82049,0L1.91029,23.26186A3.86312,3.86312,0,0,0-.00009,26.55445V72.7199a3.79834,3.79834,0,0,0,1.91041,3.29249L42.08963,99.09514a3.83689,3.83689,0,0,0,3.82049,0L86.08931,76.01239a3.79852,3.79852,0,0,0,1.91056-3.29249V26.55445A3.77643,3.77643,0,0,0,87.52113,24.73352Z",transform:"translate(0.00013 0.39551)",fill:`url(#${n.terminatedProcessCube})`}),i.a.createElement("path",{opacity:e?.3:.4,d:"M.57134,24.52282a3.79906,3.79906,0,0,1,1.34824-1.32625L42.09878.11387a3.83708,3.83708,0,0,1,3.8208,0L86.09877,23.19655a3.79771,3.79771,0,0,1,1.43182,1.47165L44.00909,49.57182Z",transform:"translate(0.00013 0.39551)",fill:"#fff",style:{isolation:"isolate"}}),i.a.createElement("path",{opacity:e?.2:.4,d:"M43.99972,49.63713V99.60449a3.83406,3.83406,0,0,1-1.91025-.50932L1.91029,76.01239A3.79835,3.79835,0,0,1-.00013,72.7199V26.55445A3.77431,3.77431,0,0,1,.562,24.5882Z",transform:"translate(0.00013 0.39551)",fill:"#353944",style:{isolation:"isolate"}}))),i.a.createElement("symbol",{id:t.terminatedTriggerCube,viewBox:"0 0 88 100"},i.a.createElement("title",null,Ee),e&&i.a.createElement("path",{opacity:"1",d:"M87.52143,25.06372a3.795,3.795,0,0,0-1.43129-1.47166L45.92578.50939a3.83384,3.83384,0,0,0-3.81907,0L1.94219,23.59206A3.8634,3.8634,0,0,0,.03252,26.88465V73.05008a3.7986,3.7986,0,0,0,1.90971,3.2925L42.10671,99.42532a3.83423,3.83423,0,0,0,3.81907,0L86.09014,76.34258A3.79881,3.79881,0,0,0,88,73.05008V26.88465A3.77748,3.77748,0,0,0,87.52143,25.06372Z",transform:"translate(0)",fill:"#010101"}),i.a.createElement("g",{opacity:"0.6"},!e&&i.a.createElement("path",{opacity:"0.6",d:"M87.52143,25.06372a3.795,3.795,0,0,0-1.43129-1.47166L45.92578.50939a3.83384,3.83384,0,0,0-3.81907,0L1.94219,23.59206A3.8634,3.8634,0,0,0,.03252,26.88465V73.05008a3.7986,3.7986,0,0,0,1.90971,3.2925L42.10671,99.42532a3.83423,3.83423,0,0,0,3.81907,0L86.09014,76.34258A3.79881,3.79881,0,0,0,88,73.05008V26.88465A3.77748,3.77748,0,0,0,87.52143,25.06372Z",transform:"translate(0)",fill:"#010101"}),i.a.createElement("path",{opacity:e?1:.604,d:"M87.48893,25.129a3.79468,3.79468,0,0,0-1.4313-1.47165L45.89329.57472a3.83381,3.83381,0,0,0-3.81908,0L1.90969,23.65739A3.86331,3.86331,0,0,0,0,26.95V73.11541a3.79859,3.79859,0,0,0,1.90969,3.2925L42.07421,99.49067a3.83425,3.83425,0,0,0,3.81908,0L86.05763,76.40791a3.79876,3.79876,0,0,0,1.90985-3.2925V26.95A3.77746,3.77746,0,0,0,87.48893,25.129Z",transform:"translate(0)",fill:`url(#${n.terminatedTriggerCube})`}),i.a.createElement("path",{d:"M.57124,24.91834A3.79833,3.79833,0,0,1,1.919,23.59209L42.08335.50939a3.83441,3.83441,0,0,1,3.8194,0L86.06711,23.59206a3.7972,3.7972,0,0,1,1.43128,1.47169L43.99289,49.96733Z",transform:"translate(0)",fill:"#fff",opacity:"0.3",style:{isolation:"isolate"}}),i.a.createElement("path",{d:"M43.98359,50.03265V100a3.83139,3.83139,0,0,1-1.90953-.50933L1.90969,76.40791A3.79859,3.79859,0,0,1,0,73.11541V26.95a3.77523,3.77523,0,0,1,.56195-1.96625Z",transform:"translate(0)",fill:"#353944",opacity:"0.2",style:{isolation:"isolate"}}))),i.a.createElement("symbol",{viewBox:"0 -3 88 106",id:t.processCubeActiveBacking},i.a.createElement("title",null,xe),i.a.createElement("path",{d:"m87.521 25.064a3.795 3.795 0 0 0-1.4313-1.4717l-40.164-23.083a3.8338 3.8338 0 0 0-3.8191 0l-40.165 23.083a3.8634 3.8634 0 0 0-1.9097 3.2926v46.165a3.7986 3.7986 0 0 0 1.9097 3.2925l40.164 23.083a3.8342 3.8342 0 0 0 3.8191 0l40.164-23.083a3.7988 3.7988 0 0 0 1.9099-3.2925v-46.165a3.7775 3.7775 0 0 0-0.47857-1.8209z",strokeWidth:"2"})))})),we=Object(a.memo)((()=>{const e=Object(me.useUiSetting)("theme:darkMode");return i.a.createElement(je,null,i.a.createElement("defs",null,i.a.createElement(ke,{isDarkMode:e}),i.a.createElement(Se,{isDarkMode:e})))})),je=p()("svg").withConfig({displayName:"HiddenSVG",componentId:"sc-1sziupc-0"})(["position:absolute;left:100%;top:100%;width:0;height:0;"]);var Oe=n(82),Ie=n.n(Oe);const Te=Object(a.memo)((function({breadcrumbs:e}){const t=Object(a.useMemo)((()=>{const t=e.slice(-1).map((e=>(e["data-test-subj"]="resolver:breadcrumbs:last",e.truncate=!0,e)));return[...e.slice(0,-1),...t]}),[e]),{resolverBreadcrumbBackground:n,resolverEdgeText:r}=b();return i.a.createElement(i.a.Fragment,null,i.a.createElement(O,{background:n,text:r,breadcrumbs:t,truncate:!1}))})),Ce=p.a.span.withConfig({displayName:"StyledSpinnerFlexItem",componentId:"sc-1wo8ziw-0"})(["margin-right:5px;"]);function Me(){const e=E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.relatedDetail.wait",{defaultMessage:"Loading Events..."}),t=E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.events",{defaultMessage:"Events"}),n=W({panelView:"nodes"}),r=Object(a.useMemo)((()=>[{text:t,...n}]),[n,t]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(Te,{breadcrumbs:r}),i.a.createElement(o.EuiSpacer,{size:"l"}),i.a.createElement(o.EuiFlexGroup,{alignItems:"center",direction:"row",gutterSize:"none"},i.a.createElement(Ce,null,i.a.createElement(o.EuiLoadingSpinner,{size:"m"})),i.a.createElement(o.EuiFlexItem,{grow:!1},i.a.createElement(o.EuiText,{"data-test-subj":"resolver:panel:loading"},e))))}function Ne({event:e}){var t,n,a,r,o,l,c,u,d,p,m,g,f,b,y,h,v,E,x;return Object(re.i)(e)?i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.legacyEventLabel",defaultMessage:"{ processName }",values:{processName:Object(re.l)(e)}}):null!==(t=e.network)&&void 0!==t&&t.forwarded_ip?i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.networkEventLabel",defaultMessage:"{ networkDirection } { forwardedIP }",values:{forwardedIP:String(null===(p=e.network)||void 0===p?void 0:p.forwarded_ip),networkDirection:String(null===(m=e.network)||void 0===m?void 0:m.direction)}}):null!==(n=e.kibana)&&void 0!==n&&null!==(a=n.alert)&&void 0!==a&&null!==(r=a.rule)&&void 0!==r&&r.name?i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.alertEventNameLabel",defaultMessage:"{ ruleName }",values:{ruleName:String(null===(g=e.kibana)||void 0===g||null===(f=g.alert)||void 0===f||null===(b=f.rule)||void 0===b?void 0:b.name)}}):null!==(o=e.file)&&void 0!==o&&o.path?i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.fileEventLabel",defaultMessage:"{ filePath }",values:{filePath:String(null===(y=e.file)||void 0===y?void 0:y.path)}}):null!==(l=e.registry)&&void 0!==l&&l.path?i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.registryPathLabel",defaultMessage:"{ registryPath }",values:{registryPath:String(null===(h=e.registry)||void 0===h?void 0:h.path)}}):null!==(c=e.registry)&&void 0!==c&&c.key?i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.registryKeyLabel",defaultMessage:"{ registryKey }",values:{registryKey:String(null===(v=e.registry)||void 0===v?void 0:v.key)}}):null!==(u=e.dns)&&void 0!==u&&null!==(d=u.question)&&void 0!==d&&d.name?i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.dnsQuestionNameLabel",defaultMessage:"{ dnsQuestionName }",values:{dnsQuestionName:String(null===(E=e.dns)||void 0===E||null===(x=E.question)||void 0===x?void 0:x.name)}}):i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.entityIDLabel",defaultMessage:"{ entityID }",values:{entityID:Object(re.b)(e)}})}var De=n(58),Fe=n.n(De);const Ae=E.i18n.translate("xpack.securitySolution.enpdoint.resolver.panelutils.invaliddate",{defaultMessage:"Invalid Date"}),_e=new Intl.DateTimeFormat(E.i18n.getLocale(),{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"});function Re(e){const t=Object(me.useUiSetting)("dateFormat"),n=Object(me.useUiSetting)("dateFormat:tz"),a="Browser"===n?Fe.a.tz.guess():n;if(!e)return;const i=new Date(e);return i&&Number.isFinite(i.getTime())?t?Fe.a.tz(i,a).format(t):_e.format(i):Ae}var Pe=n(299);const Le=Object(a.memo)((function({nodeID:e,eventCategory:t}){const n=Object(r.useSelector)((t=>c.g(t)(e))),a=Object(r.useSelector)(c.p),l=Object(r.useSelector)(c.h);return i.a.createElement(i.a.Fragment,null,a?i.a.createElement(ee,{hasBorder:!0},i.a.createElement(Me,null)):i.a.createElement(ee,{hasBorder:!0,"data-test-subj":"resolver:panel:events-in-category"},l||!n?i.a.createElement(o.EuiCallOut,{title:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.nodeEventsByType.errorPrimary",{defaultMessage:"Unable to load events."}),color:"danger",iconType:"alert","data-test-subj":"resolver:nodeEventsInCategory:error"},i.a.createElement("p",null,i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.nodeEventsByType.errorSecondary",defaultMessage:"An error occurred when fetching the events."}))):i.a.createElement(i.a.Fragment,null,i.a.createElement(ze,{nodeName:n.name,eventCategory:t,nodeID:e}),i.a.createElement(o.EuiSpacer,{size:"l"}),i.a.createElement(Be,{eventCategory:t,nodeID:e}))))})),qe=Object(a.memo)((function({event:e,nodeID:t,eventCategory:n}){const a=Object(Pe.a)(e),r=re.g(a),l=re.e(a),c=re.p(a),u=Re(r)||E.i18n.translate("xpack.securitySolution.enpdoint.resolver.panelutils.noTimestampRetrieved",{defaultMessage:"No timestamp retrieved"}),d=W({panelView:"eventDetail",panelParameters:{nodeID:t,eventCategory:n,eventID:l,eventTimestamp:String(r),winlogRecordID:String(c)}});return i.a.createElement(i.a.Fragment,null,i.a.createElement(o.EuiText,null,i.a.createElement(N,null,i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.categoryAndType",values:{category:re.d(a).join(", "),eventType:re.h(a).join(", ")},defaultMessage:"{category} {eventType}"})),i.a.createElement(D,{dateTime:u},i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.atTime",values:{date:u},defaultMessage:"@ {date}"}))),i.a.createElement(o.EuiSpacer,{size:"xs"}),i.a.createElement(o.EuiButtonEmpty,Ie()({"data-test-subj":"resolver:panel:node-events-in-category:event-link"},d),i.a.createElement(Ne,{event:a})))})),Be=Object(a.memo)((function({eventCategory:e,nodeID:t}){const n=Object(r.useSelector)(c.w),l=ae(),u=Object(a.useCallback)((()=>{l({type:"userRequestedAdditionalRelatedEvents"})}),[l]),d=Object(r.useSelector)(c.o),p=Object(r.useSelector)(c.r);return i.a.createElement(i.a.Fragment,null,n.map(((r,s)=>i.a.createElement(a.Fragment,{key:s},i.a.createElement(qe,{nodeID:t,eventCategory:e,event:r}),s===n.length-1?null:i.a.createElement(o.EuiHorizontalRule,{margin:"m"})))),p&&i.a.createElement(o.EuiFlexItem,{grow:!1},i.a.createElement(o.EuiButton,{color:"primary",size:"s",fill:!0,onClick:u,isLoading:d,"data-test-subj":"resolver:nodeEventsInCategory:loadMore"},i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.nodeEventsByType.loadMore",defaultMessage:"Load More Data"}))))})),ze=Object(a.memo)((function({nodeName:e,eventCategory:t,nodeID:n}){const a=Object(r.useSelector)((e=>c.L(e)(n))),o=Object(r.useSelector)((e=>c.B(e)(n,t))),l=W({panelView:"nodes"}),u=W({panelView:"nodeDetail",panelParameters:{nodeID:n}}),d=W({panelView:"nodeEvents",panelParameters:{nodeID:n}});return i.a.createElement(Te,{breadcrumbs:[{text:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.processEventListByType.events",{defaultMessage:"Events"}),"data-test-subj":"resolver:node-events-in-category:breadcrumbs:node-list-link",...l},{text:e,...u},{text:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventList.numberOfEvents",values:{totalCount:a},defaultMessage:"{totalCount} Events"}),...d},{text:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventList.countByCategory",values:{count:o,category:t},defaultMessage:"{count} {category}"})}]})}));function $e({nodeID:e}){const t=Object(r.useSelector)((t=>oe.a(c.u(t)(e)))),n=Object(r.useSelector)((t=>c.x(t)(e)));return void 0===t||void 0===n?i.a.createElement(ee,{hasBorder:!0},i.a.createElement(Me,null)):i.a.createElement(ee,{hasBorder:!0},i.a.createElement(Ue,{nodeName:re.l(t),nodeID:e,totalEventCount:n.total}),i.a.createElement(o.EuiSpacer,{size:"l"}),i.a.createElement(Ve,{nodeID:e,relatedStats:n}))}const Ve=Object(a.memo)((function({nodeID:e,relatedStats:t}){const n=Object(a.useMemo)((()=>Object.entries(t.byCategory).map((([e,t])=>({eventType:e,count:t})))),[t.byCategory]),r=Object(a.useMemo)((()=>[{field:"count",name:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.count",{defaultMessage:"Count"}),"data-test-subj":"resolver:panel:node-events:event-type-count",width:"20%",sortable:!0},{field:"eventType",name:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.eventType",{defaultMessage:"Event Type"}),width:"80%",sortable:!0,render:t=>i.a.createElement(He,{nodeID:e,eventType:t},t)}]),[e]);return i.a.createElement(o.EuiInMemoryTable,{items:n,columns:r,sorting:!0})})),Ue=Object(a.memo)((function({nodeID:e,nodeName:t,totalEventCount:n}){return i.a.createElement(Te,{breadcrumbs:[{text:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.processEventCounts.events",{defaultMessage:"Events"}),...W({panelView:"nodes"})},{text:t,...W({panelView:"nodeDetail",panelParameters:{nodeID:e}})},{text:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedCounts.numberOfEventsInCrumb",values:{totalCount:n},defaultMessage:"{totalCount} Events"}),...W({panelView:"nodeEvents",panelParameters:{nodeID:e}})}]})})),He=Object(a.memo)((({nodeID:e,eventType:t,children:n})=>{const a=W({panelView:"nodeEventsInCategory",panelParameters:{nodeID:e,eventCategory:t}});return i.a.createElement(o.EuiButtonEmpty,Ie()({"data-test-subj":"resolver:panel:node-events:event-type-link"},a),n)})),Ge=p.a.div.withConfig({displayName:"StyledCopyableField",componentId:"sc-3rurpv-0"})(["border-radius:3px;padding:4px;transition:background 0.2s ease;",":hover &{background-color:",";&:hover{background-color:",";color:#fff;}}"],ee,(e=>e.backgroundColor),(e=>e.activeBackgroundColor)),Qe=Object(a.memo)((({textToCopy:e,content:t})=>{var n;const{linkColor:r,copyableFieldBackground:s}=b(),[l,c]=Object(a.useState)(!1),u=null===(n=Object(me.useKibana)().services.notifications)||void 0===n?void 0:n.toasts,d=()=>c(!0),p=()=>c(!1),m=Object(a.useMemo)((()=>i.a.createElement(Ge,{backgroundColor:s,"data-test-subj":"resolver:panel:copyable-field-hover-area",activeBackgroundColor:r,onMouseEnter:d},t)),[t,s,r]),{writeTextToClipboard:g}=Object(a.useContext)(S),f=Object(a.useCallback)((async()=>{try{await g(e)}catch(e){u&&u.addError(e,{title:E.i18n.translate("xpack.securitySolution.resolver.panel.copyFailureTitle",{defaultMessage:"Copy Failure"})})}}),[e,u,g]);return i.a.createElement("div",{onMouseLeave:p},i.a.createElement(o.EuiPopover,{anchorPosition:"downCenter",button:m,closePopover:p,hasArrow:!1,isOpen:l,panelPaddingSize:"s"},i.a.createElement(o.EuiToolTip,{content:E.i18n.translate("xpack.securitySolution.resolver.panel.copyToClipboard",{defaultMessage:"Copy to Clipboard"})},i.a.createElement(o.EuiButtonIcon,{"aria-label":E.i18n.translate("xpack.securitySolution.resolver.panel.copyToClipboard",{defaultMessage:"Copy to Clipboard"}),color:"text","data-test-subj":"resolver:panel:clipboard",iconType:"copyClipboard",onClick:f}))))}));var We=n(342);const Ke=Object(a.memo)((function({translatedErrorMessage:e}){const t=W({panelView:"nodes"}),n=Object(a.useMemo)((()=>[{text:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.error.events",{defaultMessage:"Events"}),...t},{text:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.error.error",{defaultMessage:"Error"})}]),[t]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(Te,{breadcrumbs:n}),i.a.createElement(o.EuiSpacer,{size:"l"}),i.a.createElement(o.EuiText,{textAlign:"center","data-test-subj":"resolver:panel:error"},e),i.a.createElement(o.EuiSpacer,{size:"l"}),i.a.createElement(o.EuiButtonEmpty,t,E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.error.goBack",{defaultMessage:"View all processes"})))})),Ye=p()(R).withConfig({displayName:"StyledCubeForProcess",componentId:"sc-821tkc-0"})(["position:relative;"]),Je=E.i18n.translate("xpack.securitySolution.resolver.panel.nodeDetail.Error",{defaultMessage:"Node details were unable to be retrieved"}),Xe=Object(a.memo)((function({nodeID:e}){const t=Object(r.useSelector)((t=>oe.a(c.u(t)(e))));return"loading"===Object(r.useSelector)((t=>c.v(t)(e)))?i.a.createElement(ee,{hasBorder:!0},i.a.createElement(Me,null)):t?i.a.createElement(ee,{hasBorder:!0,"data-test-subj":"resolver:panel:node-detail"},i.a.createElement(Ze,{nodeID:e,processEvent:t})):i.a.createElement(ee,{hasBorder:!0},i.a.createElement(Ke,{translatedErrorMessage:Je}))})),Ze=Object(a.memo)((function({processEvent:e,nodeID:t}){const n=re.l(e),l=Object(r.useSelector)((e=>c.v(e)(t))),u=Object(r.useSelector)((e=>c.C(e)(t))),d=Re(re.g(e)),p=Object(a.useMemo)((()=>{const t={title:"@timestamp",description:d},n={title:"process.executable",description:Object(We.d)(e)},a={title:"process.pid",description:Object(We.c)(e)},r={title:"user.name",description:re.o(e)};return[t,n,a,{title:"process.entity_id",description:re.c(e)},r,{title:"user.domain",description:re.n(e)},{title:"process.parent.pid",description:re.k(e)},{title:"process.hash.md5",description:re.j(e)},{title:"process.args",description:re.a(e)}].reduce(((e,t)=>Array.isArray(t.description)?[...e,...t.description.map((e=>({title:t.title,description:e})))]:[...e,t]),[]).filter((e=>void 0!==e.description)).map((e=>({...e,description:i.a.createElement(Qe,{textToCopy:String(e.description),content:i.a.createElement(L,null,String(e.description))})})))}),[d,e]),m=W({panelView:"nodes"}),g=Object(a.useMemo)((()=>[{text:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.processDescList.events",{defaultMessage:"Events"}),"data-test-subj":"resolver:node-detail:breadcrumbs:node-list-link",...m},{text:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.detailsForProcessName",values:{processName:n},defaultMessage:"Details for: {processName}"})}]),[n,m]),{descriptionText:f}=A(l,!1),b=W({panelView:"nodeEvents",panelParameters:{nodeID:t}}),y=Object(a.useMemo)((()=>Object(o.htmlIdGenerator)("resolverTable")()),[]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(Te,{breadcrumbs:g}),i.a.createElement(o.EuiSpacer,{size:"l"}),i.a.createElement(o.EuiTitle,{size:"xs"},i.a.createElement(j,{"aria-describedby":y},i.a.createElement(Ye,{"data-test-subj":"resolver:node-detail:title-icon",state:l}),i.a.createElement("span",{"data-test-subj":"resolver:node-detail:title"},i.a.createElement(L,null,n)))),i.a.createElement(o.EuiText,null,i.a.createElement(o.EuiTextColor,{color:"subdued"},i.a.createElement("span",{id:y},f))),i.a.createElement(o.EuiSpacer,{size:"s"}),i.a.createElement(o.EuiLink,Ie()({},b,{"data-test-subj":"resolver:node-detail:node-events-link"}),i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.processDescList.numberOfEvents",values:{relatedEventTotal:u},defaultMessage:"{relatedEventTotal} Events"})),i.a.createElement(o.EuiSpacer,{size:"l"}),i.a.createElement(w,{"data-test-subj":"resolver:node-detail",type:"column",align:"left",titleProps:{"data-test-subj":"resolver:node-detail:entry-title",className:"desc-title"},descriptionProps:{"data-test-subj":"resolver:node-detail:entry-description"},compressed:!0,listItems:p}))})),et=i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.eitherLineageLimitExceeded",defaultMessage:"Some process events in the visualization and event list below could not be displayed because the data limit has been reached."}),tt=i.a.memo((function({numberOfEntries:e}){return i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.relatedEventLimitTitle",defaultMessage:"This list includes {numberOfEntries} process events.",values:{numberOfEntries:e}})})),nt=i.a.memo((function({numberDisplayed:e}){return i.a.createElement(ne,{size:"s",title:i.a.createElement(tt,{numberOfEntries:e})},i.a.createElement("p",null,et))})),at=Object(a.memo)((()=>{const e=Object(a.useMemo)((()=>[{field:"name",name:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.processNameTitle",{defaultMessage:"Process Name"}),sortable:!0,truncateText:!0,render:(e,t)=>i.a.createElement(it,{name:e,nodeID:t.nodeID})},{field:"timestamp",name:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.timestampTitle",{defaultMessage:"Timestamp"}),dataType:"date",sortable:!0,render:e=>i.a.createElement(rt,{eventDate:e})}]),[]),t=Object(r.useSelector)(Object(a.useCallback)((e=>{const{processNodePositions:t}=c.s(e),n=[];for(const e of t.keys()){const t=ie.c(e),a=ie.b(e);void 0!==a&&n.push({name:t,timestamp:ie.e(e),nodeID:a})}return n}),[])),n=t.length,s=Object(a.useMemo)((()=>[{text:E.i18n.translate("xpack.securitySolution.resolver.panel.nodeList.title",{defaultMessage:"All Process Events"})}]),[]),l=Object(r.useSelector)(c.k),u=Object(r.useSelector)(c.j),d=Object(r.useSelector)(c.l),p=!0===l||!0===u||!0===d,m=Object(a.useMemo)((()=>({"data-test-subj":"resolver:node-list:item"})),[]);return i.a.createElement(ee,{hasBorder:!0},i.a.createElement(Te,{breadcrumbs:s}),p&&i.a.createElement(nt,{numberDisplayed:n}),i.a.createElement(o.EuiSpacer,{size:"l"}),i.a.createElement(o.EuiInMemoryTable,{rowProps:m,"data-test-subj":"resolver:node-list",items:t,columns:e,sorting:!0}))}));function it({name:e,nodeID:t}){const n=Object(r.useSelector)((e=>c.y(e)===t)),s=Object(r.useSelector)((e=>c.v(e)(t))),{descriptionText:l}=b(),u=W({panelView:"nodeDetail",panelParameters:{nodeID:t}}),d=Object(r.useDispatch)(),{timestamp:p}=Object(a.useContext)(S),m=Object(a.useCallback)((e=>{u.onClick(e),d({type:"userSelectedResolverNode",payload:{nodeID:t,time:p()}})}),[p,u,d,t]);return i.a.createElement(o.EuiButtonEmpty,{onClick:m,href:u.href,"data-test-subj":"resolver:node-list:node-link","data-test-node-id":t},void 0===e?i.a.createElement(o.EuiBadge,{color:"warning"},E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.valueMissingDescription",{defaultMessage:"Value is missing"})):i.a.createElement(I,null,i.a.createElement(R,{state:s,isOrigin:n,"data-test-subj":"resolver:node-list:node-link:icon"}),i.a.createElement(M,null,n&&i.a.createElement(T,{color:l,"data-test-subj":"resolver:node-list:node-link:analyzed-event"},E.i18n.translate("xpack.securitySolution.resolver.panel.table.row.analyzedEvent",{defaultMessage:"ANALYZED EVENT"})),i.a.createElement(C,{"data-test-subj":"resolver:node-list:node-link:title"},e))))}const rt=Object(a.memo)((({eventDate:e})=>{const t=Re(e);return t?i.a.createElement(Qe,{textToCopy:t,content:t}):i.a.createElement("span",null,"â€”")}));function ot(e){const t=[{path:[],value:e}],n=[];for(;t.length;){const e=t.shift();if(void 0===e)throw new Error;const{path:a,value:i}=e;Array.isArray(i)?t.push(...i.map((e=>({path:[...a],value:e})))):"object"==typeof i&&null!==i?t.push(...Object.keys(i).map((e=>({path:[...a,e],value:i[e]})))):null!=i&&n.push([a,i])}return n}const st=E.i18n.translate("xpack.securitySolution.resolver.panel.eventDetail.requestError",{defaultMessage:"Event details were unable to be retrieved"}),lt=Object(a.memo)((function({nodeID:e,eventCategory:t}){const n=Object(r.useSelector)(c.n),a=Object(r.useSelector)(c.q),o=Object(r.useSelector)((t=>oe.a(c.u(t)(e)))),s=Object(r.useSelector)((t=>c.v(t)(e))),l=n||a||"loading"===s,u=Object(r.useSelector)(c.d);return l?i.a.createElement(ee,{hasBorder:!0},i.a.createElement(Me,null)):u?i.a.createElement(ct,{nodeID:e,event:u,processEvent:o,eventType:t}):i.a.createElement(ee,{hasBorder:!0},i.a.createElement(Ke,{translatedErrorMessage:st}))})),ct=Object(a.memo)((function({nodeID:e,event:t,eventType:n,processEvent:a}){const r=Re(re.m(t))||E.i18n.translate("xpack.securitySolution.enpdoint.resolver.panelutils.noTimestampRetrieved",{defaultMessage:"No timestamp retrieved"}),l=a?re.l(a):null;return i.a.createElement(ee,{hasBorder:!0,"data-test-subj":"resolver:panel:event-detail"},i.a.createElement(dt,{nodeID:e,nodeName:l,event:t,breadcrumbEventCategory:n}),i.a.createElement(o.EuiSpacer,{size:"l"}),i.a.createElement(o.EuiText,{size:"s"},i.a.createElement(N,null,i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.categoryAndType",values:{category:n,eventType:String(re.h(t))},defaultMessage:"{category} {eventType}"})),i.a.createElement(D,{dateTime:r},i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.atTime",values:{date:r},defaultMessage:"@ {date}"}))),i.a.createElement(o.EuiSpacer,{size:"m"}),i.a.createElement(mt,null,i.a.createElement(L,null,i.a.createElement(Ne,{event:t}))),i.a.createElement(o.EuiSpacer,{size:"l"}),i.a.createElement(ut,{event:t}))}));function ut({event:e}){const t=Object(a.useMemo)((()=>{const t=[],n=Object(Pe.a)(e);for(const[e,a]of Object.entries(n)){if("agent"===e||"ecs"===e||"@timestamp"===e||!a)continue;const n={namespace:i.a.createElement(L,null,e),descriptions:ot(a).map((([t,n])=>{const a=[e,...t].join(".");return{title:i.a.createElement(L,null,a),description:i.a.createElement(Qe,{textToCopy:String(n),content:i.a.createElement(L,null,String(n))})}}))};t.push(n)}return t}),[e]);return i.a.createElement(i.a.Fragment,null,t.map((({namespace:e,descriptions:n},r)=>i.a.createElement(a.Fragment,{key:r},0===r?null:i.a.createElement(o.EuiSpacer,{size:"m"}),i.a.createElement(o.EuiTitle,{size:"xxxs"},i.a.createElement(o.EuiTextColor,{color:"subdued"},i.a.createElement(gt,null,e,i.a.createElement(ft,null)))),i.a.createElement(o.EuiSpacer,{size:"m"}),i.a.createElement(pt,{type:"column",align:"left",titleProps:{className:"desc-title","data-test-subj":"resolver:panel:event-detail:event-field-title"},compressed:!0,listItems:n}),r===t.length-1?null:i.a.createElement(o.EuiSpacer,{size:"m"})))))}function dt({nodeID:e,nodeName:t,event:n,breadcrumbEventCategory:o}){const l=Object(r.useSelector)((t=>c.B(t)(e,o))),u=Object(r.useSelector)((t=>c.C(t)(e))),d=W({panelView:"nodes"}),p=W({panelView:"nodeDetail",panelParameters:{nodeID:e}}),m=W({panelView:"nodeEvents",panelParameters:{nodeID:e}}),g=W({panelView:"nodeEventsInCategory",panelParameters:{nodeID:e,eventCategory:o}}),f=Object(a.useMemo)((()=>{const e=[{text:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.events",{defaultMessage:"Events"}),"data-test-subj":"resolver:event-detail:breadcrumbs:node-list-link",...d},{text:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.numberOfEvents",values:{totalCount:u},defaultMessage:"{totalCount} Events"}),...m},{text:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.countByCategory",values:{count:l,category:o},defaultMessage:"{count} {category}"}),...g},{text:i.a.createElement(Ne,{event:n})}];return t&&e.splice(1,0,{text:t,...p}),e}),[o,l,n,p,m,t,u,d,g]);return i.a.createElement(Te,{breadcrumbs:f})}const pt=Object(a.memo)(p()(o.EuiDescriptionList).withConfig({displayName:"StyledDescriptionList",componentId:"sc-wbnmrd-0"})(["&.euiDescriptionList.euiDescriptionList--column dt.euiDescriptionList__title.desc-title{max-width:8em;overflow-wrap:break-word;}&.euiDescriptionList.euiDescriptionList--column dd.euiDescriptionList__description{max-width:calc(100% - 8.5em);overflow-wrap:break-word;}"])),mt=Object(a.memo)(p()(o.EuiText).withConfig({displayName:"StyledDescriptiveName",componentId:"sc-wbnmrd-1"})(["padding-right:1em;overflow-wrap:break-word;"])),gt=Object(a.memo)(p()("h3").withConfig({displayName:"StyledFlexTitle",componentId:"sc-wbnmrd-2"})(["align-items:center;display:flex;flex-flow:row;font-size:1.2em;"])),ft=Object(a.memo)((()=>i.a.createElement(o.EuiHorizontalRule,{margin:"none",size:"half"}))),bt=Object(a.memo)((function(){const e=Object(r.useSelector)(c.z);return"nodeDetail"===e.panelView?i.a.createElement(Xe,{nodeID:e.panelParameters.nodeID}):"nodeEvents"===e.panelView?i.a.createElement($e,{nodeID:e.panelParameters.nodeID}):"nodeEventsInCategory"===e.panelView?i.a.createElement(Le,{nodeID:e.panelParameters.nodeID,eventCategory:e.panelParameters.eventCategory}):"eventDetail"===e.panelView?i.a.createElement(lt,{nodeID:e.panelParameters.nodeID,eventCategory:e.panelParameters.eventCategory}):i.a.createElement(at,null)}));var yt=n(347);const ht=p()(o.EuiCodeBlock).withConfig({displayName:"StyledEuiCodeBlock",componentId:"sc-r4p8yj-0"})(["align-self:flex-start;display:inline-block;"]),vt=p()(o.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-r4p8yj-1"})(["max-width:600px;margin:60px auto 0;"]),Et=()=>i.a.createElement(vt,{"data-test-subj":"resolver:no-process-events",direction:"column"},i.a.createElement(o.EuiTitle,null,i.a.createElement("h4",null,E.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.title",{defaultMessage:"No Process Events Found"}))),i.a.createElement(o.EuiSpacer,{size:"m"}),i.a.createElement(o.EuiText,{size:"s"},E.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.timeRange",{defaultMessage:"\n            The Analyze Event tool creates graphs based on process events.\n            If the analyzed event does not have an associated process in the current time range,\n            or stored in Elasticsearch within any time range, a graph will not be created.\n            You can check for associated processes by expanding your time range.\n          "})),i.a.createElement(o.EuiSpacer,{size:"m"}),i.a.createElement(o.EuiText,{size:"s"},E.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.dataView",{defaultMessage:'In case you selected a different data view,\n          make sure your data view contains all of the indices that are stored in the source event at "{field}".',values:{field:"kibana.alert.rule.parameters.index"}})),i.a.createElement(o.EuiSpacer,{size:"m"}),i.a.createElement(o.EuiText,{size:"s"},E.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.eventCategory",{defaultMessage:"You may also add the below to your timeline query to check for process events.\n            If none are listed, a graph cannot be created from events found in that query."})),i.a.createElement(o.EuiSpacer,{size:"m"}),i.a.createElement(ht,{language:"html",paddingSize:"s",isCopyable:!0},'event.category: "process"'));var xt=n(84);const kt=i.a.memo(i.a.forwardRef((function({className:e,databaseDocumentID:t,resolverComponentInstanceID:n,indices:d,shouldUpdate:p,filters:m},g){!function(){const e=Object(a.useRef)();e.current=Object(l.useLocation)().search;const t=Object(l.useHistory)(),n=Object(r.useSelector)(c.E),i=Object(u.a)(n);Object(a.useEffect)((()=>{const n=i;return()=>{const a=new URLSearchParams(e.current);a.delete(n);const i={search:a.toString()};t.replace(i)}}),[i,t])}(),function({databaseDocumentID:e,resolverComponentInstanceID:t,indices:n,filters:i,shouldUpdate:r}){const o=ae(),s=Object(l.useLocation)().search;Object(a.useLayoutEffect)((()=>{o({type:"appReceivedNewExternalProperties",payload:{databaseDocumentID:e,resolverComponentInstanceID:t,locationSearch:s,indices:n,shouldUpdate:r,filters:i}})}),[o,e,t,s,n,r,i])}({databaseDocumentID:t,resolverComponentInstanceID:n,indices:d,shouldUpdate:p,filters:m}),function(){const{addSuccess:e}=Object(xt.a)(),{from:t,to:n}=Object(r.useSelector)((e=>{const t=c.e(e);return{from:null!=t&&t.from?t.from:void 0,to:null!=t&&t.to?t.to:void 0}})),i=Re(t),o=Re(n),s=Object(a.useMemo)((()=>E.i18n.translate("xpack.securitySolution.resolver.unboundedRequest.toast",{defaultMessage:"No results found in the selected time, expanded to {from} - {to}.",values:{from:i,to:o}})),[i,o]);Object(a.useEffect)((()=>{(t||n)&&e(s)}),[e,s,t,n])}(),function(){const e=Object(r.useDispatch)(),t=Object(r.useSelector)(c.E),n=Object(l.useLocation)().search,i=Object(a.useContext)(S),o=Object(r.useSelector)(c.I),s=Object(r.useSelector)(c.g),u=Object(yt.a)({locationSearch:n,resolverComponentInstanceID:t});let d;"nodes"!==u.panelView&&(d=u.panelParameters.nodeID),Object(a.useEffect)((()=>{d&&s(d)&&d!==o&&e({type:"userSelectedResolverNode",payload:{nodeID:d,time:i.timestamp()}})}),[u.panelView,d,e,s,o,i])}();const{timestamp:f}=Object(a.useContext)(S),y=f(),{processNodePositions:h,connectingEdgeLineSegments:x}=Object(r.useSelector)((e=>c.P(e)(y))),{projectionMatrix:k,ref:w,onMouseDown:j}=function(){const e=ae(),t=Object(a.useContext)(S),[n,i]=Object(a.useState)(null),o=Object(r.useSelector)(c.A),s=Object(a.useRef)(),[l,u]=Object(a.useState)(o(t.timestamp())),d=Object(r.useSelector)(c.O),p=Object(r.useSelector)(c.m),[m,g]=function(){const{getBoundingClientRect:e}=Object(a.useContext)(S),[t,n]=Object(a.useState)(null),{ResizeObserver:i,requestAnimationFrame:r}=Object(a.useContext)(S),[o,s]=Object(a.useState)(null),l=Object(a.useCallback)((e=>{s(e)}),[]);return Object(a.useEffect)((()=>{null!==o&&n(e(o))}),[o,e]),Object(a.useEffect)((()=>{let t=window.scrollX,a=window.scrollY;const i=()=>{r((()=>{const i=window.scrollX,r=window.scrollY;null===o||t===i&&a===r||n(e(o)),t=i,a=r}))};return window.addEventListener("scroll",i,{passive:!0}),()=>{window.removeEventListener("scroll",i)}}),[o,r,e]),Object(a.useEffect)((()=>{if(null!==o){const t=new i((t=>{null!==o&&o===t[0].target&&n(e(o))}));return t.observe(o),()=>{t.disconnect()}}}),[i,o,e]),[t,l]}(),f=Object(a.useCallback)((e=>null===m?null:[e.clientX-m.x,e.clientY-m.y]),[m]),b=Object(a.useCallback)((n=>{const a=f(n);null!==a&&e({type:"userStartedPanning",payload:{screenCoordinates:a,time:t.timestamp()}})}),[e,f,t]),y=Object(a.useCallback)((n=>{const a=f(n);a&&e({type:"userMovedPointer",payload:{screenCoordinates:a,time:t.timestamp()}})}),[e,f,t]),h=Object(a.useCallback)((()=>{d&&e({type:"userStoppedPanning",payload:{time:t.timestamp()}})}),[e,t,d]),v=Object(a.useCallback)((n=>{null!==m&&n.ctrlKey&&0!==n.deltaY&&0===n.deltaMode&&(n.preventDefault(),e({type:"userZoomed",payload:{zoomChange:n.deltaY/-m.height,time:t.timestamp()}}))}),[m,e,t]),E=Object(a.useCallback)((e=>{i(e),g(e)}),[g]);return Object(a.useEffect)((()=>(window.addEventListener("mouseup",h,{passive:!0}),()=>{window.removeEventListener("mouseup",h)})),[h]),Object(a.useEffect)((()=>(window.addEventListener("mousemove",y,{passive:!0}),()=>{window.removeEventListener("mousemove",y)})),[y]),Object(a.useEffect)((()=>{if(null!==n)return n.addEventListener("wheel",v),()=>{n.removeEventListener("wheel",v)}}),[n,v]),Object(a.useLayoutEffect)((()=>{s.current=o}),[o]),Object(a.useLayoutEffect)((()=>{u(o(t.timestamp()))}),[o,t]),Object(a.useLayoutEffect)((()=>{const e=t.timestamp();if(p(e)){let e=null;const n=()=>{const a=t.timestamp();void 0!==s.current&&u(s.current(a)),e=p(a)?t.requestAnimationFrame(n):null};return e=t.requestAnimationFrame(n),()=>{null!==e&&t.cancelAnimationFrame(e)}}}),[p,t]),Object(a.useEffect)((()=>{null!==m&&e({type:"userSetRasterSize",payload:[m.width,m.height]})}),[e,m]),{ref:E,onMouseDown:b,projectionMatrix:l}}(),O=Object(a.useCallback)((e=>{w(e),"function"==typeof g?g(e):null!==g&&(g.current=e)}),[w,g]),I=Object(r.useSelector)(c.q),T=Object(r.useSelector)(c.i),C=Object(r.useSelector)(c.a),M=Object(r.useSelector)(c.F),N=b();return i.a.createElement(Z,{className:e,backgroundColor:N.resolverBackground},I?i.a.createElement("div",{"data-test-subj":"resolver:graph:loading",className:"loading-container"},i.a.createElement(o.EuiLoadingSpinner,{size:"xl"})):T?i.a.createElement("div",{"data-test-subj":"resolver:graph:error",className:"loading-container"},i.a.createElement("div",null," ",i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.loadingError",defaultMessage:"Error loading data."}))):M?i.a.createElement(i.a.Fragment,null,i.a.createElement(te,{"data-test-subj":"resolver:graph",className:"resolver-graph kbn-resetFocusState",onMouseDown:j,ref:O,role:"tree",tabIndex:0,"aria-activedescendant":C||void 0},x.map((({points:[e,t],metadata:n})=>i.a.createElement(v,{edgeLineMetadata:n,key:n.reactKey,startPosition:e,endPosition:t,projectionMatrix:k}))),[...h].map((([e,t])=>{const n=ie.b(e);if(void 0===n)throw new Error("Tried to render a node without an ID");return i.a.createElement(pe,{key:n,nodeID:n,position:t,projectionMatrix:k,node:e,timeAtRender:y})}))),i.a.createElement(bt,null)):i.a.createElement(Et,null),i.a.createElement(H,null),i.a.createElement(we,null))})))},function(e,t,n){"use strict";n.d(t,"a",(function(){return Lt})),n.d(t,"b",(function(){return zt}));var a=n(32),i=n(4),r=n.n(i),o=n(33),s=n.n(o),l=n(0),c=n(7),u=n(268),d=n.n(u),p=n(35),m=n(157),g=n(366),f=n(259),b=n(120),y=n(77),h=n(415),v=n(167),E=n(377),x=n(11),k=n(92),S=n.n(k),w=n(48),j=n(606),O=n(677),I=n(123),T=n(880),C=n(146),M=n(494),N=n(100);const D=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.importTimelineModalTitle",{defaultMessage:"Import query from saved timeline"}),F=["duplicate","createFrom"],A=e=>{var t;return{filters:null!==(t=e.attributes.filters)&&void 0!==t?t:[],query:e.attributes.query,saved_id:e.id,title:e.attributes.title}},_=({defaultSavedQuery:e,browserFields:t,dataTestSubj:n,field:o,idAria:s,indexPattern:l,isLoading:c=!1,onCloseTimelineSearch:u,openTimelineSearch:d=!1,resizeParentContainer:p,onValidityChange:m,isDisabled:g,resetToSavedQuery:f,onSavedQueryError:b})=>{const{value:h,setValue:v}=o,[E,k]=Object(i.useState)(-1),[_,R]=Object(i.useState)(!1),[P,L]=Object(i.useState)(e),[q,B]=Object(i.useState)(!1),{isInvalid:z,errorMessage:$}=Object(N.i)(o),{uiSettings:V}=Object(y.k)().services,[U]=Object(i.useState)(new w.FilterManager(V)),H=Object(M.a)();Object(i.useEffect)((()=>{null!=m&&m(!z)}),[z,m]),Object(i.useEffect)((()=>{let e=!0;const t=new x.Subscription;return U.setFilters([]),t.add(U.getUpdates$().subscribe({next:()=>{if(e){const e=U.getFilters(),{filters:t}=h;S()(t,e)||v({...h,filters:e})}}})),()=>{e=!1,t.unsubscribe()}}),[h,U,v]),Object(i.useEffect)((()=>{let e=!0;return async function(){const{filters:t,saved_id:n}=h;if(S()(t,U.getFilters())||U.setFilters(t),null!=n&&null!=P&&n!==P.id||null!=n&&null==P)try{const t=await H.getSavedQuery(n);e&&null!=t&&L(t),B(!1)}catch{L(void 0),B(!0)}else null==n&&null!=P&&L(void 0)}(),()=>{e=!1}}),[h,U,P,H,B,v]),Object(i.useEffect)((()=>{q&&(null==b||b())}),[b,q]),Object(i.useEffect)((()=>{if(f&&P){const e=A(P);v(e)}}),[f,P,v]);const G=Object(i.useCallback)((e=>{const{query:t}=h;S()(t,e)||v({...h,query:e})}),[h,v]),Q=Object(i.useCallback)((e=>{const{query:t}=h;if(!S()(t,e)){const t=q?null:h.saved_id;v({...h,query:e,saved_id:t})}}),[h,v,q]),W=Object(i.useCallback)((e=>{if(null!=e){const{saved_id:t}=h;if(B(!1),L(e),e.id!==t){const t=A(e);v(t)}else v({filters:[],query:{query:"",language:"kuery"},saved_id:null})}}),[h,v,B]),K=Object(i.useCallback)((()=>{R(!0),u()}),[u]),Y=Object(i.useCallback)((e=>{var n,a,i,r,o,s,c;R(!1);const u={query:null!==(n=null===(a=e.kqlQuery.filterQuery)||void 0===a||null===(i=a.kuery)||void 0===i?void 0:i.expression)&&void 0!==n?n:"",language:null!==(r=null===(o=e.kqlQuery.filterQuery)||void 0===o||null===(s=o.kuery)||void 0===s?void 0:s.kind)&&void 0!==r?r:"kuery"},d=null!=e.dataProviders&&e.dataProviders.length>0?Object(C.b)(Object(I.g)(e.dataProviders,t),l):"",p=null!==(c=e.filters)&&void 0!==c?c:[];v({filters:""!==d?[...p,Object(T.b)(d)]:p,query:u,saved_id:null})}),[t,l,v]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiFormRow,{label:o.label,labelAppend:o.labelAppend,helpText:o.helpText,error:$,isInvalid:z,fullWidth:!0,"data-test-subj":n,describedByIds:s?[s]:void 0},r.a.createElement(a.EuiMutationObserver,{observerOptions:{subtree:!0,attributes:!0,childList:!0},onMutation:()=>{if(null!=p){const e=document.getElementById("kbnTypeahead__items");if(null!=e){const t=e.getBoundingClientRect(),n=document.getElementById("define-rule");if(null!=n){const e=n.getBoundingClientRect();(-1===E||e.height<E+t.height)&&p(E+t.height-100),-1===E&&k(e.height)}}else p(-1)}}},(e=>r.a.createElement("div",{ref:e},r.a.createElement(O.a,{indexPattern:l,isLoading:c||_,isRefreshPaused:!1,filterQuery:h.query,filterManager:U,filters:U.getFilters()||[],onChangedQuery:Q,onSubmitQuery:G,savedQuery:P,onSavedQuery:W,hideSavedQuery:!1,displayStyle:"inPage",isDisabled:g}))))),d?r.a.createElement(j.a,{hideActions:F,modalTitle:D,onClose:K,onOpen:Y}):null)};var R=n(349),P=n(166);const L=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.eqlTypeTitle",{defaultMessage:"Event Correlation"}),q=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.eqlTypeDescription",{defaultMessage:"Use Event Query Language (EQL) to match events, generate sequences, and stack data"}),B=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.queryTypeTitle",{defaultMessage:"Custom query"}),z=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.queryTypeDescription",{defaultMessage:"Use KQL or Lucene to detect issues across indices."}),$=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.mlTypeTitle",{defaultMessage:"Machine Learning"}),V=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.mlTypeDescription",{defaultMessage:"Select ML job to detect anomalous activity."}),U=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.thresholdTypeTitle",{defaultMessage:"Threshold"}),H=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.thresholdTypeDescription",{defaultMessage:"Aggregate query results to detect when number of matches exceeds threshold."}),G=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.threatMatchTitle",{defaultMessage:"Indicator Match"}),Q=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.threatMatchDescription",{defaultMessage:"Use indicators from intelligence sources to detect matching events and alerts."}),W=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.newTermsTitle",{defaultMessage:"New Terms"}),K=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.newTermsDescription",{defaultMessage:"Find documents with values appearing for the first time."}),Y=s.a.span.withConfig({displayName:"SmallText",componentId:"sc-lss4m0-0"})(["font-size:",";"],(({theme:e})=>e.eui.euiFontSizeS)),J=({hasValidLicense:e=!1})=>r.a.createElement(Y,null,e?V:r.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.mlTypeDisabledDescription",defaultMessage:"Access to ML requires a {subscriptionsLink}.",values:{subscriptionsLink:r.a.createElement(a.EuiLink,{href:"https://www.elastic.co/subscriptions",target:"_blank"},r.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.components.stepDefineRule.ruleTypeField.subscriptionsLink",defaultMessage:"Platinum subscription"}))}}));J.displayName="MlCardDescriptionComponent";const X=r.a.memo(J);X.displayName="MlCardDescription";const Z=({describedByIds:e=[],field:t,isUpdateView:n,hasValidLicense:o,isMlAdmin:s})=>{const l=t.value,c=Object(i.useCallback)((e=>{t.setValue(e)}),[t]),u=Object(i.useCallback)((()=>c("eql")),[c]),d=Object(i.useCallback)((()=>c("machine_learning")),[c]),p=Object(i.useCallback)((()=>c("query")),[c]),g=Object(i.useCallback)((()=>c("threshold")),[c]),f=Object(i.useCallback)((()=>c("threat_match")),[c]),b=Object(i.useCallback)((()=>c("new_terms")),[c]),y=Object(i.useMemo)((()=>({onClick:u,isSelected:Object(P.b)(l)})),[l,u]),h=Object(i.useMemo)((()=>({onClick:p,isSelected:Object(P.e)(l)})),[l,p]),v=Object(i.useMemo)((()=>({isDisabled:!o||!s,onClick:d,isSelected:Object(m.d)(l)})),[l,d,o,s]),E=Object(i.useMemo)((()=>({onClick:g,isSelected:Object(P.g)(l)})),[l,g]),x=Object(i.useMemo)((()=>({onClick:f,isSelected:Object(P.f)(l)})),[l,f]),k=Object(i.useMemo)((()=>({onClick:b,isSelected:Object(P.d)(l)})),[l,b]),S=R.css`
    padding-bottom: 60px;
    position: relative;

    & > button {
      position: absolute;
      left: 0;
      right: 0;
      bottom: 0;
      border-radius: 0;
    }
  `;return r.a.createElement(a.EuiFormRow,{fullWidth:!0,"data-test-subj":"selectRuleType",describedByIds:e,label:t.label},r.a.createElement(a.EuiFlexGrid,{columns:3},(!n||h.isSelected)&&r.a.createElement(a.EuiFlexItem,null,r.a.createElement(a.EuiCard,{"data-test-subj":"customRuleType",title:B,titleSize:"xs",description:z,icon:r.a.createElement(a.EuiIcon,{size:"xl",type:"search"}),selectable:h,layout:"horizontal",className:S})),(!n||v.isSelected)&&r.a.createElement(a.EuiFlexItem,null,r.a.createElement(a.EuiCard,{"data-test-subj":"machineLearningRuleType",title:$,titleSize:"xs",description:r.a.createElement(X,{hasValidLicense:o}),icon:r.a.createElement(a.EuiIcon,{size:"l",type:"machineLearningApp"}),isDisabled:v.isDisabled&&!v.isSelected,selectable:v,layout:"horizontal",className:S})),(!n||E.isSelected)&&r.a.createElement(a.EuiFlexItem,null,r.a.createElement(a.EuiCard,{"data-test-subj":"thresholdRuleType",title:U,titleSize:"xs",description:H,icon:r.a.createElement(a.EuiIcon,{size:"l",type:"indexFlush"}),selectable:E,layout:"horizontal",className:S})),(!n||y.isSelected)&&r.a.createElement(a.EuiFlexItem,null,r.a.createElement(a.EuiCard,{"data-test-subj":"eqlRuleType",title:L,titleSize:"xs",description:q,icon:r.a.createElement(a.EuiIcon,{size:"l",type:"eql"}),selectable:y,layout:"horizontal",className:S})),(!n||x.isSelected)&&r.a.createElement(a.EuiFlexItem,null,r.a.createElement(a.EuiCard,{"data-test-subj":"threatMatchRuleType",title:G,titleSize:"xs",description:Q,icon:r.a.createElement(a.EuiIcon,{size:"l",type:"list"}),selectable:x,layout:"horizontal",className:S})),(!n||k.isSelected)&&r.a.createElement(a.EuiFlexItem,null,r.a.createElement(a.EuiCard,{"data-test-subj":"newTermsRuleType",title:W,titleSize:"xs",description:K,icon:r.a.createElement(a.EuiIcon,{size:"l",type:"magnifyWithPlus"}),selectable:k,layout:"horizontal",className:S}))))},ee=({describedByIds:e=[],field:t})=>{const n=t.value,o=Object(i.useCallback)((e=>{const n=Number(e.target.value);t.setValue(n)}),[t]);return r.a.createElement(a.EuiFormRow,{label:t.label,"data-test-subj":"anomalyThresholdSlider",describedByIds:e},r.a.createElement(a.EuiFlexGroup,null,r.a.createElement(a.EuiFlexItem,null,r.a.createElement(a.EuiRange,{value:n,onChange:o,fullWidth:!0,showInput:!0,showRange:!0,showTicks:!0,tickInterval:25}))))};var te=n(378);const ne=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customQueryFieldRequiredError",{defaultMessage:"A custom query is required."}),ae=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.savedQueryFieldRequiredError",{defaultMessage:"Failed to load the saved query. Select a new one or add a custom query."}),ie=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.eqlQueryFieldRequiredError",{defaultMessage:"An EQL query is required."}),re=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customQueryFieldInvalidError",{defaultMessage:"The KQL is invalid"}),oe=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.indicesHelperDescription",{defaultMessage:"Enter the pattern of Elasticsearch indices where you would like this rule to run. By default, these will include index patterns defined in Security Solution advanced settings."}),se=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.resetDefaultIndicesButton",{defaultMessage:"Reset to default index patterns"}),le=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.importTimelineQueryButton",{defaultMessage:"Import query from saved timeline"}),ce=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.mlJobSelectPlaceholderText",{defaultMessage:"Select a job"}),ue=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldQuerBarLabel",{defaultMessage:"Custom query"}),de=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.EqlQueryBarLabel",{defaultMessage:"EQL query"}),pe=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.SavedQueryFormRowLabel",{defaultMessage:"Saved query"}),me=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.threatMatchingIcesHelperDescription",{defaultMessage:"Select threat indices"}),ge=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customThreatQueryFieldRequiredError",{defaultMessage:"At least one indicator match is required."}),fe=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customThreatQueryFieldRequiredEmptyError",{defaultMessage:"All matches require both a field and threat index field."}),be=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.source",{defaultMessage:"Source"}),ye=(l.i18n.translate("xpack.securitySolution.detections.dataSource.popover.title",{defaultMessage:"Select a data source"}),l.i18n.translate("xpack.securitySolution.detections.dataSource.popover.subTitle",{defaultMessage:"Data sources"}),l.i18n.translate("xpack.securitySolution.detections.dataSource.popover.content",{defaultMessage:"Rules can now query index patterns or data views."}),l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.rulePreviewTitle",{defaultMessage:"Rule Preview"}),s.a.div.withConfig({displayName:"HelpTextWarningContainer",componentId:"sc-v7btd6-0"})(["margin-top:10px;"])),he=({href:e,notRunningJobIds:t})=>r.a.createElement(r.a.Fragment,null,r.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.createRule.stepDefineRule.machineLearningJobIdHelpText",defaultMessage:"We've provided a few common jobs to get you started. To add your own custom jobs, assign a group of 'security' to those jobs in the {machineLearning} application to make them appear here.",values:{machineLearning:r.a.createElement(a.EuiLink,{href:e,target:"_blank"},r.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.components.mlJobSelect.machineLearningLink",defaultMessage:"Machine Learning"}))}}),t.length>0&&r.a.createElement(ye,{"data-test-subj":"ml-warning-not-running-jobs"},r.a.createElement(a.EuiText,{size:"xs"},r.a.createElement("span",null,1===t.length?r.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.createRule.stepDefineRule.mlEnableJobSingle",defaultMessage:"The selected ML job, {jobName}, is not currently running. We will start {jobName} when you enable this rule.",values:{jobName:t[0]}}):r.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.createRule.stepDefineRule.mlEnableJobMulti",defaultMessage:"The selected ML jobs, {jobNames}, are not currently running. We will start all of these jobs when you enable this rule.",values:{jobNames:t.reduce(((e,t,n,a)=>e+(n<a.length-1?", ":", and ")+t))}}))))),ve=r.a.memo(he),Ee=l.i18n.translate("xpack.securitySolution.detectionEngine.mlSelectJob.createCustomJobButtonTitle",{defaultMessage:"Create custom job"}),xe=s.a.div.withConfig({displayName:"JobDisplayContainer",componentId:"sc-1kiq2lp-0"})(["width:100%;height:100%;display:flex;flex-direction:column;"]),ke=s()(a.EuiFlexGroup).withConfig({displayName:"MlJobSelectEuiFlexGroup",componentId:"sc-1kiq2lp-1"})(["margin-bottom:5px;"]),Se=s()(a.EuiButton).withConfig({displayName:"MlJobEuiButton",componentId:"sc-1kiq2lp-2"})(["margin-top:20px;"]),we=({id:e,description:t})=>r.a.createElement(xe,null,r.a.createElement("strong",null,e),r.a.createElement(a.EuiToolTip,{content:t},r.a.createElement(a.EuiText,{size:"xs",color:"subdued"},r.a.createElement("p",null,t)))),je=e=>r.a.createElement(we,{id:e.value.id,description:e.value.description}),Oe=({describedByIds:e=[],field:t})=>{const n=t.value,{isInvalid:o,errorMessage:s}=Object(N.i)(t),{loading:l,jobs:c}=Object(te.a)(),{getUrlForApp:u,navigateToApp:d}=Object(y.k)().services.application,p=u("ml"),g=Object(i.useCallback)((e=>{const n=e.map((e=>e.value.id));t.setValue(n)}),[t]),f=c.map((e=>({value:{id:e.id,description:e.description},label:e.id}))),b=f.filter((e=>n.includes(e.value.id))),h=Object(i.useMemo)((()=>c.filter((({id:e})=>n.includes(e))).reduce(((e,t)=>(Object(m.c)(t.jobState,t.datafeedState)||e.push(t.id),e)),[])),[c,n]);return r.a.createElement(ke,{justifyContent:"flexStart"},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiFormRow,{label:t.label,helpText:r.a.createElement(ve,{href:p,notRunningJobIds:h}),isInvalid:o,error:s,"data-test-subj":"mlJobSelect",describedByIds:e},r.a.createElement(a.EuiFlexGroup,null,r.a.createElement(a.EuiFlexItem,null,r.a.createElement(a.EuiComboBox,{isLoading:l,onChange:g,options:f,placeholder:ce,renderOption:je,rowHeight:50,selectedOptions:b}))))),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(Se,{iconType:"popout",iconSide:"right",onClick:()=>d("ml",{openInNewTab:!0})},Ee)))};var Ie=n(919),Te=n(371),Ce=n(493);const Me=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.thresholdField.thresholdFieldPlaceholderText",{defaultMessage:"All results"}),Ne=s()(a.EuiFlexItem).withConfig({displayName:"OperatorWrapper",componentId:"sc-10hzoxx-0"})(["align-self:center;"]),De=["detectionEngineStepDefineRuleThresholdField"],Fe=["detectionEngineStepDefineRuleThresholdValue"],Ae=["detectionEngineStepDefineRuleThresholdCardinalityField"],_e=["detectionEngineStepDefineRuleThresholdCardinalityValue"],Re=({thresholdField:e,thresholdValue:t,browserFields:n,thresholdCardinalityField:o,thresholdCardinalityValue:s})=>{const l=Object(i.useMemo)((()=>({fullWidth:!0,noSuggestions:!1,options:n.map((e=>({label:e.name}))),placeholder:Me,onCreateOption:void 0,style:{width:"410px"}})),[n]),c=Object(i.useMemo)((()=>({fullWidth:!0,noSuggestions:!1,options:n.map((e=>({label:e.name}))),placeholder:Me,onCreateOption:void 0,style:{width:"410px"},singleSelection:{asPlainText:!0}})),[n]);return r.a.createElement(a.EuiFlexGroup,{direction:"column",style:{marginLeft:0}},r.a.createElement(a.EuiFlexGroup,null,r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(N.b,{field:e,idAria:De[0],"data-test-subj":De[0],describedByIds:De,type:e.type,euiFieldProps:l})),r.a.createElement(Ne,{grow:!1},">="),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(N.b,{field:t,idAria:Fe[0],"data-test-subj":Fe[0],describedByIds:Fe,type:t.type}))),r.a.createElement(a.EuiFlexGroup,null,r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(N.b,{field:o,idAria:Ae[0],"data-test-subj":Ae[0],describedByIds:Ae,type:o.type,euiFieldProps:c})),r.a.createElement(Ne,{grow:!1},">="),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(N.b,{field:s,idAria:_e[0],"data-test-subj":_e[0],describedByIds:_e,type:s.type}))))},Pe=r.a.memo(Re);var Le=n(45),qe=n(117),Be=n.n(qe),ze=n(132),$e=n(502);const Ve=()=>Object(ze.d)({field:"",type:"mapping",value:""});var Ue=n(1),He=n(584);const Ge={index:{defaultValue:[],fieldsToValidateOnChange:["index","queryBar"],type:N.a.COMBO_BOX,label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fiedIndexPatternsLabel",{defaultMessage:"Index patterns"}),helpText:r.a.createElement(a.EuiText,{size:"xs"},oe),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(!Object(m.d)(t.ruleType)&&t.dataSourceType===v.a.IndexPatterns)return N.h.emptyField(l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.outputIndiceNameFieldRequiredError",{defaultMessage:"A minimum of one index pattern is required."}))(...e)}}]},dataViewTitle:{label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.dataViewSelector",{defaultMessage:"Data View"}),validations:[]},dataViewId:{fieldsToValidateOnChange:["dataViewId"],validations:[{validator:(...e)=>{const[{path:t,formData:n}]=e,a=null!=n.dataViewId&&""!==n.dataViewId;if(!Object(m.d)(n.ruleType)&&!a&&n.dataSourceType===v.a.DataView)return{path:t,message:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.dataViewSelectorFieldRequired",{defaultMessage:"Please select an available Data View or Index Pattern."})}}}]},eqlOptions:{},queryBar:{validations:[{validator:(...e)=>{const[{value:t,path:n,formData:a}]=e,{query:i,filters:r,saved_id:o}=t;if(!Object(m.d)(a.ruleType)&&Object(c.isEmpty)(i.query)&&Object(c.isEmpty)(r))return o?{code:"ERR_FIELD_MISSING",path:n,message:ae}:{code:"ERR_FIELD_MISSING",path:n,message:Object(P.b)(a.ruleType)?ie:ne}}},{validator:(...e)=>{const[{value:t,path:n,formData:a}]=e,{query:i}=t;if(!Object(m.d)(a.ruleType)&&!Object(c.isEmpty)(i.query)&&"kuery"===i.language)try{Object(Le.fromKueryExpression)(i.query)}catch(e){return{code:"ERR_FIELD_FORMAT",path:n,message:re}}}},{validator:Object(He.a)(He.b,300)}]},ruleType:{label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldRuleTypeLabel",{defaultMessage:"Rule type"}),validations:[]},anomalyThreshold:{label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldAnomalyThresholdLabel",{defaultMessage:"Anomaly score threshold"}),validations:[]},machineLearningJobId:{label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldMachineLearningJobIdLabel",{defaultMessage:"Machine Learning job"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(m.d)(t.ruleType))return N.h.emptyField(l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.machineLearningJobIdRequired",{defaultMessage:"A Machine Learning job is required."}))(...e)}}]},relatedIntegrations:{label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRelatedIntegrationsLabel",{defaultMessage:"Related integrations"}),helpText:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRelatedIntegrationsHelpText",{defaultMessage:"Integration related to this Rule."})},requiredFields:{label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRequiredFieldsLabel",{defaultMessage:"Required fields"}),helpText:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRequiredFieldsHelpText",{defaultMessage:"Fields required for this Rule to function."})},timeline:{label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimelineTemplateLabel",{defaultMessage:"Timeline template"}),helpText:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimelineTemplateHelpText",{defaultMessage:"Select which timeline to use when investigating generated alerts."})},threshold:{label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThresholdLabel",{defaultMessage:"Threshold"}),field:{type:N.a.COMBO_BOX,label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThresholdFieldLabel",{defaultMessage:"Group by"}),helpText:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThresholdFieldHelpText",{defaultMessage:"Select fields to group by. Fields are joined together with 'AND'"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(P.g)(t.ruleType))return N.h.maxLengthField({length:3,message:l.i18n.translate("xpack.securitySolution.detectionEngine.validations.thresholdFieldFieldData.arrayLengthGreaterThanMaxErrorMessage",{defaultMessage:"Number of fields must be 3 or less."})})(...e)}}]},value:{type:N.a.NUMBER,label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThresholdValueLabel",{defaultMessage:"Threshold"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(P.g)(t.ruleType))return N.h.numberGreaterThanField({than:1,message:l.i18n.translate("xpack.securitySolution.detectionEngine.validations.thresholdValueFieldData.numberGreaterThanOrEqualOneErrorMessage",{defaultMessage:"Value must be greater than or equal to one."}),allowEquality:!0})(...e)}}]},cardinality:{field:{defaultValue:[],fieldsToValidateOnChange:["threshold.cardinality.field","threshold.cardinality.value"],type:N.a.COMBO_BOX,label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThresholdCardinalityFieldLabel",{defaultMessage:"Count"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(P.g)(t.ruleType))return Object(c.isEmpty)(t["threshold.cardinality.field"])&&!Object(c.isEmpty)(t["threshold.cardinality.value"])?N.h.emptyField(l.i18n.translate("xpack.securitySolution.detectionEngine.validations.thresholdCardinalityFieldFieldData.thresholdCardinalityFieldNotSuppliedMessage",{defaultMessage:"A Cardinality Field is required."}))(...e):void 0}}],helpText:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThresholdFieldCardinalityFieldHelpText",{defaultMessage:"Select a field to check cardinality"})},value:{fieldsToValidateOnChange:["threshold.cardinality.field","threshold.cardinality.value"],type:N.a.NUMBER,label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThresholdCardinalityValueFieldLabel",{defaultMessage:"Unique values"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(P.g)(t.ruleType))return Object(c.isEmpty)(t["threshold.cardinality.field"])?void 0:N.h.numberGreaterThanField({than:1,message:l.i18n.translate("xpack.securitySolution.detectionEngine.validations.thresholdCardinalityValueFieldData.numberGreaterThanOrEqualOneErrorMessage",{defaultMessage:"Value must be greater than or equal to one."}),allowEquality:!0})(...e)}}]}}},threatIndex:{type:N.a.COMBO_BOX,label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThreatIndexPatternsLabel",{defaultMessage:"Indicator index patterns"}),helpText:r.a.createElement(a.EuiText,{size:"xs"},me),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(P.f)(t.ruleType))return N.h.emptyField(l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.threatMatchoutputIndiceNameFieldRequiredError",{defaultMessage:"A minimum of one index pattern is required."}))(...e)}},{validator:(...e)=>{const[{formData:t,value:n}]=e;if(Object(P.f)(t.ruleType))return((e,t)=>{let n;if(n="string"==typeof e?e===t:!!Array.isArray(e)&&!!e.find((e=>e===t)),n)return{code:"ERR_FIELD_FORMAT",message:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.threatMatchIndexForbiddenError",{defaultMessage:"The index pattern cannot be { forbiddenString }. Please choose a more specific index pattern.",values:{forbiddenString:t}})}})(n,"*")}}]},threatMapping:{label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThreatMappingLabel",{defaultMessage:"Indicator mapping"}),validations:[{validator:(...e)=>{const[{path:t,formData:n}]=e;var a;if(Object(P.f)(n.ruleType))return 1===(a=n.threatMapping).length&&1===a[0].entries.length&&""===a[0].entries[0].field&&""===a[0].entries[0].value?{code:"ERR_FIELD_MISSING",path:t,message:ge}:(e=>e.some((e=>e.entries.some((e=>""===e.field||""===e.value)))))(n.threatMapping)?{code:"ERR_FIELD_MISSING",path:t,message:fe}:void 0}}]},threatQueryBar:{label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThreatQueryBarLabel",{defaultMessage:"Indicator index query"}),validations:[{validator:(...e)=>{const[{value:t,path:n,formData:a}]=e;if(!Object(P.f)(a.ruleType))return;const{query:i,filters:r}=t;return Object(c.isEmpty)(i.query)&&Object(c.isEmpty)(r)?{code:"ERR_FIELD_MISSING",path:n,message:ne}:void 0}},{validator:(...e)=>{const[{value:t,path:n,formData:a}]=e;if(!Object(P.f)(a.ruleType))return;const{query:i}=t;if(!Object(c.isEmpty)(i.query)&&"kuery"===i.language)try{Object(Le.fromKueryExpression)(i.query)}catch(e){return{code:"ERR_FIELD_FORMAT",path:n,message:re}}}}]},groupByFields:{type:N.a.COMBO_BOX,label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.groupByFieldsLabel",{defaultMessage:"Suppress alerts by"}),labelAppend:r.a.createElement(a.EuiText,{color:"subdued",size:"xs"},l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.groupByFieldsLabelAppend",{defaultMessage:"Optional (Technical Preview)"})),helpText:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldGroupByFieldHelpText",{defaultMessage:"Select field(s) to use for suppressing extra alerts"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(P.e)(t.ruleType))return N.h.maxLengthField({length:3,message:l.i18n.translate("xpack.securitySolution.detectionEngine.validations.stepDefineRule.groupByFieldsMax",{defaultMessage:"Number of grouping fields must be at most 3"})})(...e)}}]},newTermsFields:{type:N.a.COMBO_BOX,label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.newTermsFieldsLabel",{defaultMessage:"Fields"}),helpText:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldNewTermsFieldHelpText",{defaultMessage:"Select a field to check for new terms."}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(P.d)(t.ruleType))return N.h.emptyField(l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.newTermsFieldsMin",{defaultMessage:"A minimum of one field is required."}))(...e)}},{validator:(...e)=>{const[{formData:t}]=e;if(Object(P.d)(t.ruleType))return N.h.maxLengthField({length:Ue.Qb,message:l.i18n.translate("xpack.securitySolution.detectionEngine.validations.stepDefineRule.newTermsFieldsMax",{defaultMessage:"Number of fields must be 3 or less."})})(...e)}}]},historyWindowSize:{label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.historyWindowSizeLabel",{defaultMessage:"History Window Size"}),helpText:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.historyWindowSizeHelpText",{defaultMessage:"New terms rules only alert if terms don't appear in historical data."})},shouldLoadQueryDynamically:{type:N.a.CHECKBOX,defaultValue:!1}};var Qe=n(906);const We=l.i18n.translate("xpack.securitySolution.detectionEngine.stepDefineRule.pickDataView",{defaultMessage:"Select a Data View"}),Ke=l.i18n.translate("xpack.securitySolution.detectionEngine.stepDefineRule.dataViewNotFoundLabel",{defaultMessage:"Selected data view not found"}),Ye=l.i18n.translate("xpack.securitySolution.detectionEngine.stepDefineRule.dataViewIncludesAlertsIndexLabel",{defaultMessage:"Default Security data view"}),Je=l.i18n.translate("xpack.securitySolution.detectionEngine.stepDefineRule.dataViewIncludesAlertsIndexDescription",{defaultMessage:"The default Security data view includes the alerts index. This could result in redundant alerts being generated from existing alerts."}),Xe=({kibanaDataViews:e,field:t})=>{let n,o,s;if(null!=t){const e=Object(N.i)(t);n=e.isInvalid,o=e.errorMessage,s=t.value}const c=Object(i.useMemo)((()=>null!=e&&Object.keys(e).length>0),[e]),u=Object(i.useMemo)((()=>null!=s&&""!==s&&c&&!Object.hasOwn(e,s)),[c,s,e]),[d,p]=Object(i.useState)(u||null==s||""===s?[]:[{id:e[s].id,label:e[s].title}]),[m,g]=Object(i.useState)(!1);Object(i.useEffect)((()=>{if(!u&&s){const t=e[s].title,n=e[s].id;g("security-solution-default"===n),p([{id:n,label:t}])}else p([])}),[s,t,e,u,g]);const f=Object(i.useMemo)((()=>c?Object.values(e).map((e=>({label:e.title,id:e.id}))):[]),[c,e]);return r.a.createElement(r.a.Fragment,null,u&&null!=s&&r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiCallOut,{title:Ke,color:"warning",iconType:"help"},r.a.createElement("p",null,(b=s,l.i18n.translate("xpack.securitySolution.detectionEngine.stepDefineRule.dataViewNotFoundDescription",{values:{dataView:b},defaultMessage:'Your data view of "id": "{dataView}" was not found. It could be that it has since been deleted.'})))),r.a.createElement(a.EuiSpacer,{size:"s"})),m&&r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiCallOut,{title:Ye,color:"warning",iconType:"help","data-test-subj":"defaultSecurityDataViewWarning"},r.a.createElement("p",null,Je)),r.a.createElement(a.EuiSpacer,{size:"s"})),r.a.createElement(a.EuiFormRow,{label:null==t?void 0:t.label,helpText:null==t?void 0:t.helpText,error:o,isInvalid:n,"data-test-subj":"pick-rule-data-source"},r.a.createElement(a.EuiComboBox,{isClearable:!0,singleSelection:{asPlainText:!0},onChange:e=>{const n=e;if(p(null!=n?n:[]),null!=n&&n.length>0&&null!=n[0].id){const e=n[0].id;null==t||t.setValue(e)}else null==t||t.setValue(void 0)},options:f,selectedOptions:d,"aria-label":We,placeholder:We,"data-test-subj":"detectionsDataViewSelectorDropdown"})));var b};var Ze=n(265),et=n(468);const tt=s()(a.EuiFlexItem).withConfig({displayName:"FlexItemWithLabel",componentId:"sc-1i1appc-0"})(["padding-top:20px;text-align:center;"]),nt=s()(a.EuiFlexItem).withConfig({displayName:"FlexItemWithoutLabel",componentId:"sc-1i1appc-1"})(["text-align:center;"]),at=({entry:e,indexPattern:t,threatIndexPatterns:n,showLabel:o,onChange:s})=>{const l=Object(i.useCallback)((([t])=>{const{updatedEntry:n,index:a}=((e,t)=>{const{entryIndex:n}=e;return{updatedEntry:{id:e.id,field:null!=t?t.name:"",type:"mapping",value:null!=e.value?e.value.name:""},index:n}})(e,t);s(n,a)}),[s,e]),c=Object(i.useCallback)((([t])=>{const{updatedEntry:n,index:a}=((e,t)=>{const{entryIndex:n}=e;return{updatedEntry:{id:e.id,field:null!=e.field?e.field.name:"",type:"mapping",value:null!=t?t.name:""},index:n}})(e,t);s(n,a)}),[s,e]),u=Object(i.useMemo)((()=>{const n=r.a.createElement(Ze.b,{placeholder:et.c,indexPattern:t,selectedField:e.field,isClearable:!1,isLoading:!1,isDisabled:null==t,onChange:l,"data-test-subj":"entryField",fieldInputWidth:360});return o?r.a.createElement(a.EuiFormRow,{label:et.b,"data-test-subj":"entryItemFieldInputFormRow"},n):r.a.createElement(a.EuiFormRow,{label:"","data-test-subj":"entryItemFieldInputFormRow"},n)}),[l,t,e,o]),d=Object(i.useMemo)((()=>{const t=r.a.createElement(Ze.b,{placeholder:et.c,indexPattern:n,selectedField:e.value,isClearable:!1,isLoading:!1,isDisabled:null==n,onChange:c,"data-test-subj":"threatEntryField",fieldInputWidth:360});return o?r.a.createElement(a.EuiFormRow,{label:et.f,"data-test-subj":"threatFieldInputFormRow"},t):r.a.createElement(a.EuiFormRow,{label:"","data-test-subj":"threatFieldInputFormRow"},t)}),[c,n,e,o]);return r.a.createElement(a.EuiFlexGroup,{direction:"row",gutterSize:"s",alignItems:"center",justifyContent:"spaceAround","data-test-subj":"itemEntryContainer"},r.a.createElement(a.EuiFlexItem,{grow:!1},u),r.a.createElement(a.EuiFlexItem,{grow:!0},r.a.createElement(a.EuiFlexGroup,{justifyContent:"spaceAround",alignItems:"center"},o?r.a.createElement(tt,{grow:!0},et.d):r.a.createElement(nt,{grow:!0},et.d))),r.a.createElement(a.EuiFlexItem,{grow:!1},d))};at.displayName="EntryItem";const it=s()(a.EuiFlexItem).withConfig({displayName:"MyFirstRowContainer",componentId:"sc-136w498-0"})(["padding-top:20px;"]),rt=r.a.memo((({entries:e,isOnlyItem:t,entryIndex:n,itemIndex:o,onDelete:s})=>{const l=t&&1===e.length&&0===o&&(null==e[0].field||""===e[0].field),c=Object(i.useCallback)((()=>{s(n)}),[s,n]),u=r.a.createElement(a.EuiButtonIcon,{color:"danger",iconType:"trash",onClick:c,isDisabled:l,"aria-label":"entryDeleteButton",className:"itemEntryDeleteButton","data-test-subj":"itemEntryDeleteButton"});return 0===n&&0===o?r.a.createElement(it,{grow:!1,"data-test-subj":"firstRowDeleteButton"},u):r.a.createElement(a.EuiFlexItem,{grow:!1,"data-test-subj":"deleteButton"},u)}));rt.displayName="EntryDeleteButton";var ot=n(421);const st=s()(a.EuiFlexItem).withConfig({displayName:"MyInvisibleAndBadge",componentId:"sc-d6yaa8-0"})(["visibility:hidden;"]),lt=s()(a.EuiFlexItem).withConfig({displayName:"MyFirstRowContainer",componentId:"sc-d6yaa8-1"})(["padding-top:20px;"]),ct=r.a.memo((({entriesLength:e,entryItemIndex:t})=>{const n=r.a.createElement(ot.a,{includeAntennas:!0,type:"and"});return e>1&&0===t?r.a.createElement(lt,{grow:!1,"data-test-subj":"entryItemEntryFirstRowAndBadge"},n):e<=1?r.a.createElement(st,{grow:!1,"data-test-subj":"entryItemEntryInvisibleAndBadge"},n):r.a.createElement(a.EuiFlexItem,{grow:!1,"data-test-subj":"entryItemEntryAndBadge"},n)}));ct.displayName="AndBadge";const ut=s()(a.EuiFlexItem).withConfig({displayName:"MyOverflowContainer",componentId:"sc-o1uavm-0"})(["overflow:hidden;width:100%;"]),dt=r.a.memo((({listItem:e,listItemIndex:t,indexPattern:n,threatIndexPatterns:o,isOnlyItem:s,andLogicIncluded:l,onDeleteEntryItem:c,onChangeEntryItem:u})=>{const d=Object(i.useCallback)(((n,a)=>{const i=[...e.entries.slice(0,a),{...n},...e.entries.slice(a+1)],r={...e,entries:i};u(r,t)}),[u,e,t]),p=Object(i.useCallback)((n=>{const a=((e,t)=>({...e,entries:[...e.entries.slice(0,t),...e.entries.slice(t+1)]}))(e,n);c(a,t)}),[e,c,t]),m=Object(i.useMemo)((()=>null!=n&&e.entries.length>0?((e,t,n)=>n.reduce(((n,a,i)=>{const r=((e,t,n,a,i=Be.a.v4)=>{var r;const{fields:o}=e,{fields:s}=t,l=n.field,c=n.value,[u]=o.filter((({name:e})=>null!=l&&l===e)),[d]=s.filter((({name:e})=>null!=c&&c===e));return{id:null!==(r=n.id)&&void 0!==r?r:i(),field:u,type:"mapping",value:d,entryIndex:a}})(e,t,a,i);return[...n,r]}),[]))(n,o,e.entries):[]),[e.entries,n,o]);return r.a.createElement(a.EuiFlexItem,null,r.a.createElement(a.EuiFlexGroup,{gutterSize:"s","data-test-subj":"entriesContainer"},l&&r.a.createElement(ct,{entriesLength:e.entries.length,entryItemIndex:t}),r.a.createElement(ut,{grow:6},r.a.createElement(a.EuiFlexGroup,{gutterSize:"s",direction:"column"},m.map(((i,l)=>r.a.createElement(a.EuiFlexItem,{key:i.id,grow:1},r.a.createElement(a.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",direction:"row"},r.a.createElement(ut,{grow:1},r.a.createElement(at,{entry:i,threatIndexPatterns:o,indexPattern:n,showLabel:0===t&&0===l,onChange:d})),r.a.createElement(rt,{entries:e.entries,isOnlyItem:s,entryIndex:i.entryIndex,itemIndex:t,onDelete:p})))))))))}));dt.displayName="ListItem";const pt=s()(a.EuiButton).withConfig({displayName:"MyEuiButton",componentId:"sc-1dsnlky-0"})(["min-width:95px;"]),mt=({isOrDisabled:e=!1,isAndDisabled:t=!1,onAndClicked:n,onOrClicked:i})=>r.a.createElement(a.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(pt,{fill:!0,size:"s",iconType:"plusInCircle",onClick:n,"data-test-subj":"andButton",isDisabled:t},et.a)),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(pt,{fill:!0,size:"s",iconType:"plusInCircle",onClick:i,isDisabled:e,"data-test-subj":"orButton"},et.e))),gt=s()(a.EuiFlexItem).withConfig({displayName:"MyInvisibleAndBadge",componentId:"sc-ph2s87-0"})(["visibility:hidden;"]),ft=s()(ot.a).withConfig({displayName:"MyAndBadge",componentId:"sc-ph2s87-1"})(["& > .euiFlexItem{margin:0;}"]),bt=s()(a.EuiFlexItem).withConfig({displayName:"MyButtonsContainer",componentId:"sc-ph2s87-2"})(["margin:16px 0;"]),yt={andLogicIncluded:!1,entries:[],entriesToDelete:[]},ht=({listItems:e,indexPatterns:t,threatIndexPatterns:n,onChange:o})=>{const[{entries:s,entriesToDelete:l,andLogicIncluded:c},u]=Object(i.useReducer)(((e,t)=>{switch(t.type){case"setEntries":{const n=t.entries.filter((({entries:e})=>e.length>1)).length>0;return{...e,andLogicIncluded:n,entries:t.entries}}case"setDefault":return{...e,...t.initialState,entries:[{...t.lastEntry,entries:[Ve()]}]};default:return e}}),{...yt}),d=Object(i.useCallback)((e=>{u({type:"setEntries",entries:e})}),[u]),p=Object(i.useCallback)((e=>{u({type:"setDefault",initialState:yt,lastEntry:e})}),[u]),m=Object(i.useCallback)(((e,t)=>{const n=[...s.slice(0,t),{...e},...s.slice(t+1)];d(n)}),[d,s]),g=Object(i.useCallback)(((e,t)=>{0===e.entries.length?0===[...s.slice(0,t),...s.slice(t+1)].length?p(e):d([...s.slice(0,t),...s.slice(t+1)]):m(e,t)}),[m,d,s,p]),f=Object(i.useCallback)((()=>{const e=s[s.length-1],{entries:t}=e,n={...e,entries:[...t,Ve()]};d([...s.slice(0,s.length-1),{...n}])}),[d,s]),b=Object(i.useCallback)((()=>{const e=Object(ze.d)({entries:[Object(ze.d)({field:"",type:"mapping",value:""})]});d([...s,{...e}])}),[d,s]),y=Object(i.useCallback)((()=>{f()}),[f]);return Object(i.useEffect)((()=>{var e;o({entryItems:(e=s,e.reduce(((e,t)=>{const n={...t,entries:t.entries};return $e.t.is(n)?[...e,n]:e}),[])),entriesToDelete:l})}),[o,l,s]),Object(i.useEffect)((()=>{(0===s.length||1===s.length&&null!=s[0].entries&&0===s[0].entries.length)&&b()}),[s,b]),Object(i.useEffect)((()=>{e.length>0&&d(e)}),[]),r.a.createElement(a.EuiFlexGroup,{gutterSize:"s",direction:"column"},s.map(((e,i)=>{var o;const l=null!==(o=e.id)&&void 0!==o?o:`${i}`;return r.a.createElement(a.EuiFlexItem,{grow:1,key:l},r.a.createElement(a.EuiFlexGroup,{gutterSize:"s",direction:"column"},0!==i&&(c?r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiFlexGroup,{gutterSize:"none",direction:"row"},r.a.createElement(gt,{grow:!1},r.a.createElement(ft,{includeAntennas:!0,type:"and"})),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(ft,{type:"or"})))):r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(ft,{type:"or"}))),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(dt,{key:l,listItem:e,indexPattern:t,threatIndexPatterns:n,listItemIndex:i,andLogicIncluded:c,isOnlyItem:1===s.length,onDeleteEntryItem:g,onChangeEntryItem:m}))))})),r.a.createElement(bt,{"data-test-subj":"andOrOperatorButtons"},r.a.createElement(a.EuiFlexGroup,{gutterSize:"s"},c&&r.a.createElement(gt,{grow:!1},r.a.createElement(ot.a,{includeAntennas:!0,type:"and"})),r.a.createElement(a.EuiFlexItem,{grow:1},r.a.createElement(mt,{isOrDisabled:!1,isAndDisabled:!1,onOrClicked:b,onAndClicked:y})))))};ht.displayName="ThreatMatch";const vt=Object(N.j)({component:N.b}),Et=({threatIndexModified:e,handleResetThreatIndices:t,threatMapping:n,indexPatterns:o,threatIndexPatterns:s,threatIndexPatternsLoading:l,threatBrowserFields:c,onValidityChange:u})=>{const{setValue:d,value:p}=n,{isInvalid:m,errorMessage:g}=Object(N.i)(n),[f,b]=Object(i.useState)(!1);Object(i.useEffect)((()=>{u&&u(!m&&f)}),[f,m,u]);const y=Object(i.useCallback)((({entryItems:e})=>{d(e)}),[d]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiSpacer,{size:"m"}),r.a.createElement(a.EuiFlexGroup,{direction:"column"},r.a.createElement(a.EuiFlexItem,{grow:!0},r.a.createElement(vt,{path:"threatIndex",config:{...Ge.threatIndex,labelAppend:e?r.a.createElement(Lt,{onClick:t,iconType:"refresh"},se):null},componentProps:{idAria:"detectionEngineStepDefineRuleThreatMatchIndices","data-test-subj":"detectionEngineStepDefineRuleThreatMatchIndices",euiFieldProps:{fullWidth:!0,isDisabled:!1,placeholder:""}}})),r.a.createElement(a.EuiFlexItem,{grow:!0},r.a.createElement(N.e,{path:"threatQueryBar",config:{...Ge.threatQueryBar,labelAppend:null},component:_,componentProps:{browserFields:c,idAria:"detectionEngineStepDefineThreatRuleQueryBar",indexPattern:s,isDisabled:!1,isLoading:l,dataTestSubj:"detectionEngineStepDefineThreatRuleQueryBar",openTimelineSearch:!1,onValidityChange:b}}))),r.a.createElement(a.EuiSpacer,{size:"m"}),r.a.createElement(a.EuiFormRow,{label:n.label,labelAppend:n.labelAppend,helpText:n.helpText,error:g,isInvalid:m,fullWidth:!0},r.a.createElement(ht,{listItems:p,indexPatterns:o,threatIndexPatterns:s,"data-test-subj":"threatmatch-builder","id-aria":"threatmatch-builder",onChange:y})),r.a.createElement(a.EuiSpacer,{size:"m"}))},xt=r.a.memo(Et);var kt=n(175);const St=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.newTermsField.placeholderText",{defaultMessage:"Select a field"}),wt=({browserFields:e,field:t})=>{const n=Object(i.useMemo)((()=>({fullWidth:!0,noSuggestions:!1,options:e.map((e=>({label:e.name}))),placeholder:St,onCreateOption:void 0,style:{width:"410px"}})),[e]);return r.a.createElement(N.b,{field:t,idAria:"detectionEngineStepDefineRuleNewTermsField",euiFieldProps:n})},jt=r.a.memo(wt);var Ot=n(592),It=n(720),Tt=n(535),Ct=n(881);const Mt=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.groupBy.placeholderText",{defaultMessage:"Select a field"}),Nt=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.groupBy.licenseWarning",{defaultMessage:"Alert suppression is enabled with Platinum license or above"}),Dt=({browserFields:e,isDisabled:t,field:n})=>{const o=Object(i.useMemo)((()=>({fullWidth:!0,noSuggestions:!1,options:e.map((e=>({label:e.name}))),placeholder:Mt,onCreateOption:void 0,style:{width:"410px"},isDisabled:t})),[e,t]),s=r.a.createElement(N.b,{field:n,idAria:"detectionEngineStepDefineRuleGroupByField",euiFieldProps:o});return t?r.a.createElement(a.EuiToolTip,{position:"right",content:Nt},s):s},Ft=r.a.memo(Dt);var At=n(13),_t=n(244);const Rt=Object(N.j)({component:N.b}),Pt=s.a.div.withConfig({displayName:"StyledVisibleContainer",componentId:"sc-f0vskm-0"})(["display:",";"],(e=>e.isVisible?"block":"none")),Lt=s()(a.EuiButtonEmpty).withConfig({displayName:"MyLabelButton",componentId:"sc-f0vskm-1"})(["height:18px;font-size:12px;.euiIcon{width:14px;height:14px;}"]);Lt.defaultProps={flush:"right"};const qt=s()(a.EuiFormRow).attrs((({$isVisible:e})=>({style:{display:e?"flex":"none"}}))).withConfig({displayName:"RuleTypeEuiFormRow",componentId:"sc-f0vskm-2"})([""]),Bt=({addPadding:e=!1,defaultValues:t,descriptionColumns:n="singleSplit",isReadOnlyView:o,isLoading:u,isUpdateView:x=!1,onSubmit:k,setForm:S,kibanaDataViews:w,indicesConfig:j,threatIndicesConfig:O,onRuleDataChange:I,onPreviewDisabledStateChange:T,defaultSavedQuery:C})=>{const M=Object(b.a)(),[D,F]=Object(i.useState)(!1),[A,R]=Object(i.useState)(!1),[L,q]=Object(i.useState)(!1),[B,z]=Object(i.useState)(),$=Object(At.b)(),{form:V}=Object(N.k)({defaultValue:t,options:{stripEmptyFields:!1},schema:Ge}),{getFields:U,getFormData:H,reset:G,validate:Q}=V,[W]=Object(N.m)({form:V,watch:["index","ruleType","queryBar","threshold","dataViewId","threshold.field","threshold.value","threshold.cardinality.field","threshold.cardinality.value","threatIndex","threatMapping","machineLearningJobId","anomalyThreshold","dataSourceType","newTermsFields","historyWindowSize","shouldLoadQueryDynamically","groupByFields"],onChange:e=>{I&&I({...e,eqlOptions:Me})}}),{index:K,ruleType:Y,queryBar:J,dataViewId:X,threatIndex:te,threatMapping:ne,machineLearningJobId:ae,dataSourceType:ie,newTermsFields:re,shouldLoadQueryDynamically:oe}=W,[ce,me]=Object(i.useState)(!1),[ge,fe]=Object(i.useState)(!1),ye=K||t.index,he=X||t.dataViewId,ve=te||t.threatIndex,Ee=Y||t.ruleType,xe=ie||t.dataSourceType,ke=null!=ae?ae:t.machineLearningJobId,[Se,we]=Object(i.useState)(!1);Object(i.useEffect)((()=>{T&&T(!Se)}),[Se,T]),Object(i.useEffect)((()=>{const e=Object(Ct.b)({ruleType:Ee,isQueryBarValid:ce,isThreatQueryBarValid:ge,index:ye,dataViewId:X,dataSourceType:xe,threatIndex:ve,threatMapping:ne,machineLearningJobId:ke,queryBar:null!=J?J:t.queryBar,newTermsFields:re});we(!e)}),[xe,X,re,J,ne,ye,t.queryBar,ce,ge,ke,Ee,ve]);const je=d()(Ee),[Me,Ne]=Object(i.useState)(t.eqlOptions||{}),[De,{browserFields:Fe,indexPatterns:Ae}]=Object(kt.b)(ye,!1),[_e,Re]=Object(i.useState)(Ae),{data:Le}=Object(y.k)().services;Object(i.useEffect)((()=>{xe===v.a.IndexPatterns&&(De||Re(Ae)),xe===v.a.DataView&&(async()=>{if(null!=he){const e=await Le.dataViews.get(he);z(e.title),Re(e)}})()}),[xe,De,Le,he,Ae]);const qe=Object(i.useCallback)((e=>{V.setFieldValue("dataSourceType",e),V.getFields().index.reset({resetValue:!1}),V.getFields().dataViewId.reset({resetValue:!1})}),[V]),[Be,ze]=Object(i.useState)([]);Object(i.useEffect)((()=>{const{fields:e}=_e;ze(function(e){return e.filter((e=>!0===e.aggregatable))}(e))}),[_e]);const $e=Object(i.useMemo)((()=>(e=>{const t=new Set(["string","number","ip","boolean"]);return e.filter((e=>!0===e.aggregatable&&t.has(e.type)))})(Be)),[Be]),[Ve,{browserFields:Ue,indexPatterns:He}]=Object(kt.b)(ve);Object(i.useEffect)((()=>{G({resetValues:!1})}),[G,Ee]),Object(i.useEffect)((()=>{R(!Object(c.isEqual)(ye,j))}),[ye,j]),Object(i.useEffect)((()=>{q(!Object(c.isEqual)(ve,O))}),[ve,O]),Object(i.useEffect)((()=>{const{queryBar:e}=U();null!=e&&(Object(P.f)(Ee)&&!Object(P.f)(je)&&Object(c.isEqual)(e.value,Tt.a.forNormalRules)?e.reset({defaultValue:Tt.a.forThreatMatchRules}):!Object(P.f)(Ee)&&Object(P.f)(je)&&Object(c.isEqual)(e.value,Tt.a.forThreatMatchRules)&&e.reset({defaultValue:Tt.a.forNormalRules}))}),[Ee,je,U]);const We=Object(i.useCallback)((()=>{ce||V.setFieldValue("shouldLoadQueryDynamically",!1)}),[ce,V]),Ke=Object(i.useCallback)((()=>{k&&k()}),[k]),Ye=Object(i.useCallback)((async()=>({isValid:await new Promise((e=>{setTimeout((async()=>{const t=await Q();e(t)}),0)})),data:{...H(),eqlOptions:Me}})),[H,Me,Q]);Object(i.useEffect)((()=>{let e=!1;return S&&!e&&S(v.b.defineRule,Ye),()=>{e=!0}}),[Ye,S]);const Je=Object(i.useCallback)((()=>{U().index.setValue(j)}),[U,j]),Ze=Object(i.useCallback)((()=>{U().threatIndex.setValue(O)}),[U,O]),et=Object(i.useCallback)((()=>{F(!0)}),[]),tt=Object(i.useCallback)((()=>{F(!1)}),[]),nt=Object(i.useCallback)((({thresholdField:e,thresholdValue:t,thresholdCardinalityField:n,thresholdCardinalityValue:a})=>r.a.createElement(Pe,{browserFields:Be,thresholdField:e,thresholdValue:t,thresholdCardinalityField:n,thresholdCardinalityValue:a})),[Be]);s()(a.EuiFlexItem).withConfig({displayName:"SourcererFlex",componentId:"sc-f0vskm-3"})(["align-items:flex-end;"]).displayName="SourcererFlex";const at=Object(i.useCallback)((({threatMapping:e})=>r.a.createElement(xt,{handleResetThreatIndices:Ze,indexPatterns:_e,threatBrowserFields:Ue,threatIndexModified:L,threatIndexPatterns:He,threatIndexPatternsLoading:Ve,threatMapping:e,onValidityChange:fe})),[Ze,_e,Ue,L,He,Ve]),it=Object(i.useMemo)((()=>[{id:v.a.IndexPatterns,label:l.i18n.translate("xpack.securitySolution.ruleDefine.indexTypeSelect.indexPattern",{defaultMessage:"Index Patterns"}),iconType:xe===v.a.IndexPatterns?"checkInCircleFilled":"empty","data-test-subj":`rule-index-toggle-${v.a.IndexPatterns}`},{id:v.a.DataView,label:l.i18n.translate("xpack.securitySolution.ruleDefine.indexTypeSelect.dataView",{defaultMessage:"Data View"}),iconType:xe===v.a.DataView?"checkInCircleFilled":"empty","data-test-subj":`rule-index-toggle-${v.a.DataView}`}]),[xe]),rt=Object(i.useMemo)((()=>null==w||0===Object.keys(w).length?r.a.createElement(a.EuiLoadingSpinner,{size:"l"}):r.a.createElement(N.e,{key:"DataViewSelector",path:"dataViewId",component:Xe,componentProps:{kibanaDataViews:w}})),[w]),ot=Object(i.useMemo)((()=>r.a.createElement(qt,{label:be,$isVisible:!0,fullWidth:!0},r.a.createElement(a.EuiFlexGroup,{direction:"column",gutterSize:"s","data-test-subj":"dataViewIndexPatternButtonGroupFlexGroup"},r.a.createElement(a.EuiFlexItem,null,r.a.createElement(a.EuiText,{size:"xs"},r.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.dataViewSelectorText1",defaultMessage:"Use Kibana "}),r.a.createElement(It.a,{guidePath:"kibana",docPath:"data-views.html",linkText:"Data Views"}),r.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.dataViewSelectorText2",defaultMessage:" or specify individual "}),r.a.createElement(It.a,{guidePath:"kibana",docPath:"index-patterns-api-create.html",linkText:"index patterns"}),r.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.dataViewSelectorText3",defaultMessage:" as your rule's data source to be searched."}))),r.a.createElement(a.EuiFlexItem,null,r.a.createElement(qt,{$isVisible:!0},r.a.createElement(a.EuiButtonGroup,{isFullWidth:!0,legend:"Rule index pattern or data view selector","data-test-subj":"dataViewIndexPatternButtonGroup",idSelected:xe,onChange:qe,options:it,color:"primary"}))),r.a.createElement(a.EuiFlexItem,null,r.a.createElement(Pt,{isVisible:xe===v.a.DataView},rt),r.a.createElement(Pt,{isVisible:xe===v.a.IndexPatterns},r.a.createElement(Rt,{path:"index",config:{...Object(c.omit)(Ge.index,"label"),labelAppend:A?r.a.createElement(Lt,{onClick:Je,iconType:"refresh"},se):null},componentProps:{idAria:"detectionEngineStepDefineRuleIndices","data-test-subj":"detectionEngineStepDefineRuleIndices",euiFieldProps:{fullWidth:!0,placeholder:""}}})))))),[xe,qe,it,rt,A,Je]),st=Object(i.useMemo)((()=>r.a.createElement(N.e,{key:"QueryBarDefineRule",path:"queryBar",config:{...Ge.queryBar,label:ue,labelAppend:r.a.createElement(Lt,{"data-test-subj":"importQueryFromSavedTimeline",onClick:et,disabled:oe},le)},component:_,componentProps:{browserFields:Fe,idAria:"detectionEngineStepDefineRuleQueryBar",indexPattern:_e,isDisabled:u||oe,resetToSavedQuery:oe,isLoading:De,dataTestSubj:"detectionEngineStepDefineRuleQueryBar",openTimelineSearch:D,onValidityChange:me,onCloseTimelineSearch:tt,onSavedQueryError:We,defaultSavedQuery:C}})),[Fe,tt,et,_e,De,u,D,oe,We,C]),lt=Object(i.useCallback)(((e,t)=>{Ne((n=>({...n,[e]:t})))}),[]),ct=Object(i.useMemo)((()=>Object(c.isEmpty)(_e.fields)?{keywordFields:[],dateFields:[],nonDateFields:[]}:{keywordFields:_e.fields.filter((e=>{var t;return null===(t=e.esTypes)||void 0===t?void 0:t.includes("keyword")})).map((e=>({label:e.name}))),dateFields:_e.fields.filter((e=>"date"===e.type)).map((e=>({label:e.name}))),nonDateFields:_e.fields.filter((e=>"date"!==e.type)).map((e=>({label:e.name})))}),[_e]),ut=Object(h.e)(t);return xe===v.a.DataView&&(ut.dataViewTitle=B),o?r.a.createElement(Te.a,{"data-test-subj":"definitionRule",addPadding:e},r.a.createElement(E.a,{columns:n,indexPatterns:_e,schema:Object(h.b)(Ge,Ee),data:Object(h.b)(ut,Ee)})):r.a.createElement(r.a.Fragment,null,r.a.createElement(Te.a,{addPadding:!x},r.a.createElement(N.c,{form:V,"data-test-subj":"stepDefineRule"},r.a.createElement(Pt,{isVisible:!1},r.a.createElement(N.e,{path:"dataSourceType",componentProps:{euiFieldProps:{fullWidth:!0,placeholder:""}}})),r.a.createElement(N.e,{path:"ruleType",component:Z,componentProps:{describedByIds:["detectionEngineStepDefineRuleType"],isUpdateView:x,hasValidLicense:Object(f.a)(M),isMlAdmin:Object(g.a)(M)}}),r.a.createElement(qt,{$isVisible:!Object(m.d)(Ee),fullWidth:!0},r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiSpacer,{size:"s"}),ot,r.a.createElement(a.EuiSpacer,{size:"s"}),Object(P.b)(Ee)?r.a.createElement(N.e,{key:"EqlQueryBar",path:"queryBar",component:Qe.a,componentProps:{optionsData:ct,optionsSelected:Me,isSizeOptionDisabled:!0,onOptionsChange:lt,onValidityChange:me,idAria:"detectionEngineStepDefineRuleEqlQueryBar",isDisabled:u,isLoading:De,indexPattern:_e,showFilterBar:!0,dataTestSubj:"detectionEngineStepDefineRuleEqlQueryBar"},config:{...Ge.queryBar,label:de}}):st)),Object(P.e)(Ee)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiSpacer,{size:"s"}),r.a.createElement(qt,{label:pe,$isVisible:Boolean((null==J?void 0:J.saved_id)&&(null==J?void 0:J.title)),fullWidth:!0},r.a.createElement(Rt,{path:"shouldLoadQueryDynamically",componentProps:{idAria:"detectionEngineStepDefineRuleShouldLoadQueryDynamically","data-test-subj":"detectionEngineStepDefineRuleShouldLoadQueryDynamically",euiFieldProps:{disabled:u,label:null!=J&&J.title?(dt=J.title,l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldShouldLoadQueryDynamicallyLabel",{defaultMessage:'Load saved query "{savedQueryName}" dynamically on each rule execution',values:{savedQueryName:dt}})):void 0}}}))),r.a.createElement(qt,{$isVisible:Object(P.e)(Ee)},r.a.createElement(N.e,{path:"groupByFields",component:Ft,componentProps:{browserFields:$e,isDisabled:!$.isAtLeast(_t.O)&&0===t.groupByFields.length}})),r.a.createElement(qt,{$isVisible:Object(m.d)(Ee),fullWidth:!0},r.a.createElement(r.a.Fragment,null,r.a.createElement(N.e,{path:"machineLearningJobId",component:Oe,componentProps:{describedByIds:["detectionEngineStepDefineRulemachineLearningJobId"]}}),r.a.createElement(N.e,{path:"anomalyThreshold",component:ee,componentProps:{describedByIds:["detectionEngineStepDefineRuleAnomalyThreshold"]}}))),r.a.createElement(qt,{$isVisible:Object(P.g)(Ee),"data-test-subj":"thresholdInput",fullWidth:!0},r.a.createElement(r.a.Fragment,null,r.a.createElement(N.f,{fields:{thresholdField:{path:"threshold.field"},thresholdValue:{path:"threshold.value"},thresholdCardinalityField:{path:"threshold.cardinality.field"},thresholdCardinalityValue:{path:"threshold.cardinality.value"}}},nt))),r.a.createElement(qt,{$isVisible:Object(P.f)(Ee),"data-test-subj":"threatMatchInput",fullWidth:!0},r.a.createElement(r.a.Fragment,null,r.a.createElement(N.f,{fields:{threatMapping:{path:"threatMapping"}}},at))),r.a.createElement(qt,{$isVisible:Object(P.d)(Ee),"data-test-subj":"newTermsInput",fullWidth:!0},r.a.createElement(r.a.Fragment,null,r.a.createElement(N.e,{path:"newTermsFields",component:jt,componentProps:{browserFields:$e}}),r.a.createElement(N.e,{path:"historyWindowSize",component:Ot.a,componentProps:{idAria:"detectionEngineStepDefineRuleHistoryWindowSize",dataTestSubj:"detectionEngineStepDefineRuleHistoryWindowSize",timeTypes:["m","h","d"]}}))),r.a.createElement(N.e,{path:"timeline",component:Ie.a,componentProps:{idAria:"detectionEngineStepDefineRuleTimeline",isDisabled:u,dataTestSubj:"detectionEngineStepDefineRuleTimeline"}}))),!x&&r.a.createElement(Ce.a,{dataTestSubj:"define-continue",onClick:Ke,isDisabled:u}));var dt},zt=Object(i.memo)(Bt)},function(e,t,n){"use strict";n.d(t,"b",(function(){return Z})),n.d(t,"a",(function(){return ae}));var a=n(32),i=n(34),r=n(4),o=n.n(r),s=n(35),l=n(46),c=n(166),u=n(107),d=n(33),p=n.n(d),m=n(7),g=n(662),f=n.n(g),b=n(36),y=n(675),h=n(0);const v=()=>o.a.createElement(o.a.Fragment,null,o.a.createElement(a.EuiFlexGroup,{gutterSize:"s",alignItems:"center",responsive:!1,"data-test-subj":"response-actions-header"},o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(a.EuiTitle,{size:"s"},o.a.createElement("h4",null,o.a.createElement(s.FormattedMessage,{defaultMessage:"Response Actions",id:"xpack.securitySolution.actionForm.responseActionSectionsDescription"})))),o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(a.EuiBetaBadge,{tooltipContent:h.i18n.translate("xpack.securitySolution.actionForm.experimentalTooltip",{defaultMessage:"This functionality is in technical preview and may be changed or removed completely in a future release. Elastic will take a best effort approach to fix any issues, but features in technical preview are not subject to the support SLA of official GA features."}),label:h.i18n.translate("xpack.securitySolution.rules.actionForm.experimentalTitle",{defaultMessage:"Technical preview"})}))),o.a.createElement(a.EuiSpacer,{size:"m"}),o.a.createElement(a.EuiFlexItem,null,o.a.createElement(s.FormattedMessage,{defaultMessage:"Response actions are run on each rule execution",id:"xpack.securitySolution.actionForm.responseActionSectionsTitle"})),o.a.createElement(a.EuiSpacer,{size:"m"}));var E=n(13),x=n(100);const k=({supportedResponseActionTypes:e,addActionType:t,updateActionTypeId:n})=>{const[i]=Object(x.m)(),[l,c]=Object(r.useState)(i.responseActions&&i.responseActions.length>0),u=Object(E.b)().isGoldPlus(),d=Object(r.useCallback)((e=>{c(!1),t(),n(e.id)}),[t,n]),p=Object(r.useMemo)((()=>o.a.createElement(a.EuiFlexGroup,null,o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(a.EuiSpacer,{size:"m"}),o.a.createElement(a.EuiButton,{size:"s","data-test-subj":"addAlertActionButton",onClick:()=>c(!1)},o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.sections.actionForm.addResponseActionButtonLabel",defaultMessage:"Add response action"}))))),[]),m=Object(r.useMemo)((()=>(null==e?void 0:e.length)&&e.map((function(e,t){const n=o.a.createElement(a.EuiKeyPadMenuItem,{key:t,isDisabled:!u,"data-test-subj":`${e.name}-response-action-type-selection-option`,label:e.name,onClick:()=>d(e)},o.a.createElement(a.EuiIcon,{size:"xl",type:e.iconClass}));return o.a.createElement(a.EuiFlexItem,{grow:!1,key:`keypad-${e.id}`},n)}))),[d,u,e]);return null!=e&&e.length?o.a.createElement(o.a.Fragment,null,l?p:m):o.a.createElement(o.a.Fragment,null)};var S=n(397),w=n(129),j=n(77);const O=o.a.memo((({field:e})=>{const{setErrors:t,clearErrors:n,value:a,setValue:i}=e,{osquery:s}=Object(j.k)().services,l=Object(r.useMemo)((()=>null==s?void 0:s.OsqueryResponseActionTypeForm),[null==s?void 0:s.OsqueryResponseActionTypeForm]),c=Object(r.useCallback)((e=>{Object(m.isEmpty)(e)?n():t(Object(m.map)(e,(e=>({message:e.message}))))}),[t,n]);return o.a.createElement(l,{defaultValues:a,onError:c,onChange:i})}));O.displayName="ResponseActionFormField";var I=n(634);const T=()=>o.a.createElement(o.a.Fragment,null),C=o.a.memo((e=>{const{osquery:t,application:n}=Object(j.k)().services,i=Object(r.useMemo)((()=>null==t?void 0:t.OsqueryResponseActionTypeForm),[null==t?void 0:t.OsqueryResponseActionTypeForm]),l=Object(w.b)();if(t){var c,u,d,p,m,g,f,b;const{disabled:r,permissionDenied:y}=t.fetchInstallationStatus(),h=!(null!=n&&null!==(c=n.capabilities)&&void 0!==c&&null!==(u=c.osquery)&&void 0!==u&&u.writeLiveQueries||null!=n&&null!==(d=n.capabilities)&&void 0!==d&&null!==(p=d.osquery)&&void 0!==p&&p.runSavedQueries&&(null!=n&&null!==(m=n.capabilities)&&void 0!==m&&null!==(g=m.osquery)&&void 0!==g&&g.readSavedQueries||null!=n&&null!==(f=n.capabilities)&&void 0!==f&&null!==(b=f.osquery)&&void 0!==b&&b.readPacks));if(y||h)return o.a.createElement(o.a.Fragment,null,o.a.createElement(x.e,{path:`${e.item.path}.params`,component:T}),o.a.createElement(a.EuiEmptyPrompt,{title:o.a.createElement("h2",null,I.b),titleSize:"xs",iconType:"logoOsquery",body:o.a.createElement("p",null,o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.osquery.action.missingPrivileges",defaultMessage:"To access this page, ask your administrator for {osquery} Kibana privileges.",values:{osquery:o.a.createElement(a.EuiCode,null,"osquery")}}))}));if(r)return o.a.createElement(o.a.Fragment,null,o.a.createElement(x.e,{path:`${e.item.path}.params`,component:T}),o.a.createElement(a.EuiEmptyPrompt,{iconType:"logoOsquery",title:o.a.createElement("h2",null,I.c),titleSize:"xs",body:o.a.createElement("p",null,I.a)}));if(l()&&i)return o.a.createElement(x.e,{path:`${e.item.path}.params`,component:O,readDefaultValueOnForm:!e.item.isNew})}return null}));C.displayName="OsqueryResponseAction";const M=p()(a.EuiAccordion).withConfig({displayName:"StyledEuiAccordion",componentId:"sc-1xv9108-0"})(["background:",";.euiAccordion__buttonContent{padding:",";}"],(({theme:e})=>e.eui.euiColorLightestShade),(({theme:e})=>e.eui.euiSizeM)),N=({item:e,onDeleteAction:t})=>{const[n,i]=Object(r.useState)(!0),[s]=Object(x.m)(),l=Object(m.get)(s,e.path),c=Object(r.useCallback)((()=>(null==l?void 0:l.actionTypeId)===S.a.OSQUERY?o.a.createElement(C,{item:e}):null),[null==l?void 0:l.actionTypeId,e]),u=Object(r.useCallback)((()=>{t(e.id)}),[e,t]),d=Object(r.useMemo)((()=>{const{logo:e,name:t}=(null==l||l.actionTypeId,S.a.OSQUERY,{logo:"logoOsquery",name:"Osquery"});return o.a.createElement(a.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(a.EuiIcon,{type:e,size:"m"})),o.a.createElement(a.EuiFlexItem,null,o.a.createElement(a.EuiText,null,t)))}),[null==l?void 0:l.actionTypeId]),p=Object(r.useMemo)((()=>o.a.createElement(a.EuiButtonIcon,{"data-test-subj":"remove-response-action",iconType:"minusInCircle",color:"danger",className:"actAccordionActionForm__extraAction","aria-label":h.i18n.translate("xpack.securitySolution.actionTypeForm.accordion.deleteIconAriaLabel",{defaultMessage:"Delete"}),onClick:u})),[u]);return o.a.createElement(M,{initialIsOpen:!0,key:e.id,id:e.id.toString(),onToggle:i,paddingSize:"l","data-test-subj":"alertActionAccordion",buttonContent:d,extraAction:p},c())};N.displayName="ResponseActionTypeForm";const D=o.a.memo(N),F=()=>o.a.createElement(o.a.Fragment,null),A=o.a.memo((({items:e,removeItem:t,supportedResponseActionTypes:n,addItem:i})=>{const s=Object(r.useRef)(null),l=Object(r.useCallback)((e=>{s.current=e}),[]),c=Object(x.l)(),u=Object(r.useMemo)((()=>o.a.createElement(k,{supportedResponseActionTypes:n,addActionType:i,updateActionTypeId:l})),[i,l,n]);return Object(r.useEffect)((()=>{if(s.current){const t=`responseActions[${e.length-1}].actionTypeId`;c.setFieldValue(t,s.current),s.current=null}}),[c,e.length]),o.a.createElement("div",{"data-test-subj":"response-actions-list"},e.map(((e,n)=>o.a.createElement("div",{key:e.id,"data-test-subj":`response-actions-list-item-${n}`},o.a.createElement(a.EuiSpacer,{size:"m"}),o.a.createElement(D,{item:e,onDeleteAction:t}),o.a.createElement(x.e,{path:`${e.path}.actionTypeId`,component:F})))),o.a.createElement(a.EuiSpacer,{size:"m"}),u)}));A.displayName="ResponseActionsList";const _=[{id:S.a.OSQUERY,name:"osquery",iconClass:"logoOsquery"}],R=b.css`
  margin-bottom: 0;
`,P=({items:e,addItem:t,removeItem:n,form:i})=>{const s=(()=>{const[e,t]=Object(r.useState)(),n=(()=>{const{osquery:e}=Object(j.k)().services,t=null==e?void 0:e.fetchInstallationStatus();return!(null!=t&&t.loading||null!=t&&t.disabled||null!=t&&t.permissionDenied)})();return Object(r.useEffect)((()=>{const e=_.filter((e=>S.c.includes(e.id)));t(e)}),[n]),e})(),[l,c]=Object(r.useState)(null),u=i.getFields(),d=i.getErrors(),p=Object(r.useMemo)((()=>null!=s&&s.length?o.a.createElement(A,{items:e,removeItem:n,supportedResponseActionTypes:s,addItem:t}):null),[t,e,n,s]);return Object(r.useEffect)((()=>{c((()=>{const t=Object(m.reduce)(Object(m.map)(e,"path"),((e,t)=>{var n,a;return null!==(n=u[`${t}.params`])&&void 0!==n&&null!==(a=n.errors)&&void 0!==a&&a.length?(e.push({type:Object(m.upperFirst)(u[`${t}.actionTypeId`].value.substring(1)),errors:Object(m.map)(u[`${t}.params`].errors,"message")}),e):e}),[]);return Object(m.reduce)(t,((e,t)=>(e.push(`**${t.type}:**\n`),t.errors.forEach((t=>{e.push(`- ${t}\n`)})),e)),[]).join("\n")}))}),[u,d,e]),o.a.createElement(o.a.Fragment,null,o.a.createElement(a.EuiSpacer,{size:"xxl","data-test-subj":"response-actions-form"}),o.a.createElement(v,null),null!=l&&l.length&&i.isSubmitted?o.a.createElement(o.a.Fragment,null,o.a.createElement(L,null,o.a.createElement(a.EuiCallOut,{"data-test-subj":"response-actions-error",title:y.a,color:"danger",iconType:"alert"},o.a.createElement(f.a,null,l))),o.a.createElement(a.EuiSpacer,null)):null,p)};var L=p()("p").withConfig({displayName:"_StyledP",componentId:"sc-1drd97h-0"})(["",""],R),q=n(167),B=n(377),z=n(371),$=n(566),V=n(878),U=n(912);const H=h.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.completeWithoutEnablingTitle",{defaultMessage:"Create rule without enabling it"}),G=h.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.completeWithEnablingTitle",{defaultMessage:"Create & enable rule"}),Q=h.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.noReadActionsPrivileges",{defaultMessage:'Cannot create rule actions. You do not have "Read" permissions for the "Actions" plugin.'}),W=h.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.fieldThrottleHelpText",{defaultMessage:"Select when automated actions should be performed if a rule evaluates as true."}),K=h.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.fieldThrottleHelpTextWhenQuery",{defaultMessage:"Select when automated actions should be performed if a rule evaluates as true. This frequency does not apply to Response Actions."});var Y=n(1),J=n(8);const X="Cases",Z={enabled:!0,actions:[],responseActions:[],kibanaSiemAppUrl:"",throttle:$.a.value},ee=()=>o.a.createElement(o.a.Fragment,null),te=()=>o.a.createElement(o.a.Fragment,null,o.a.createElement(a.EuiTitle,{size:"s"},o.a.createElement("h4",null,o.a.createElement(s.FormattedMessage,{defaultMessage:"Actions",id:"xpack.securitySolution.detectionEngine.rule.editRule.actionSectionsTitle"}))),o.a.createElement(a.EuiSpacer,{size:"l"})),ne=({addPadding:e=!1,defaultValues:t,isReadOnlyView:n,isLoading:s,isUpdateView:d=!1,onSubmit:p,setForm:m,actionMessageParams:g,ruleType:f})=>{const[b]=(()=>{const e=Object(r.useRef)(!0),[t,n]=Object(r.useState)(!0),[a,i]=Object(r.useState)(!1);return Object(r.useEffect)((()=>{const t=new AbortController;return e.current&&(e.current=!1,(async()=>{try{Object(j.c)(await j.b.get().http.fetch(Object(J.getAllConnectorsUrl)(),{method:"GET",signal:t.signal})).some((e=>".case"===e.connectorTypeId&&e.name===X))||await j.b.get().http.post(Object(J.getCreateConnectorUrl)(),{method:"POST",body:JSON.stringify({connector_type_id:".case",config:{},name:X,secrets:{}}),signal:t.signal}),n(!1)}catch{n(!1),i(!0)}})()),()=>{t.abort()}}),[]),[t,a]})(),{services:{application:y,triggersActionsUi:{actionTypeRegistry:v}}}=Object(j.k)(),E=Object(u.a)("responseActionsEnabled"),k=Object(r.useMemo)((()=>y.getUrlForApp(`${Y.B}`,{absolute:!0})),[y]),S={...null!=t?t:Z,kibanaSiemAppUrl:k},w=Object(r.useMemo)((()=>(({actionTypeRegistry:e})=>({actions:{validations:[{validator:Object(U.a)(e)}]},enabled:{},kibanaSiemAppUrl:{},throttle:{label:h.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.fieldThrottleLabel",{defaultMessage:"Actions frequency"})}}))({actionTypeRegistry:v})),[v]),{form:O}=Object(x.k)({defaultValue:S,options:{stripEmptyFields:!1},schema:w}),{getFields:I,getFormData:T,submit:C}=O,[{throttle:M}]=Object(x.m)({form:O,watch:["throttle"]}),N=M||S.throttle,D=Object(r.useCallback)((e=>{I().enabled.setValue(e),p&&p()}),[I,p]),F=Object(r.useCallback)((async()=>{const e=await C();return null!=e&&e.isValid?e:{isValid:!1,data:T()}}),[T,C]);Object(r.useEffect)((()=>{let e=!1;return m&&!e&&m(q.b.ruleActions,F),()=>{e=!0}}),[F,m]);const A=Object(r.useMemo)((()=>(e=>e&&Object(i.findIndex)(["value",e],$.c)<0?[...$.c,{value:e,text:e}]:$.c)(N)),[N]),_=Object(r.useMemo)((()=>({idAria:"detectionEngineStepRuleActionsThrottle",isDisabled:s,isLoading:b,dataTestSubj:"detectionEngineStepRuleActionsThrottle",hasNoInitialSelection:!1,helpText:Object(c.e)(f)?K:W,euiFieldProps:{options:A}})),[s,b,f,A]),R=Object(r.useMemo)((()=>N!==Z.throttle?o.a.createElement(o.a.Fragment,null,o.a.createElement(a.EuiSpacer,null),o.a.createElement(x.e,{path:"actions",component:V.a,componentProps:{messageVariables:g}})):o.a.createElement(x.e,{path:"actions",component:ee})),[N,g]),L=Object(r.useMemo)((()=>Object(c.e)(f)?o.a.createElement(l.UseArray,{path:"responseActions",initialNumberOfItems:0},P):null),[f]),ne=Object(r.useMemo)((()=>y.capabilities.actions.show?o.a.createElement(o.a.Fragment,null,o.a.createElement(te,null),o.a.createElement(x.e,{path:"throttle",component:$.d,componentProps:_}),R,E&&L,o.a.createElement(x.e,{path:"kibanaSiemAppUrl",component:ee}),o.a.createElement(x.e,{path:"enabled",component:ee})):o.a.createElement(o.a.Fragment,null,o.a.createElement(a.EuiText,null,Q),o.a.createElement(x.e,{path:"throttle",componentProps:_,component:ee}),o.a.createElement(x.e,{path:"actions",component:ee}),o.a.createElement(x.e,{path:"kibanaSiemAppUrl",component:ee}),o.a.createElement(x.e,{path:"enabled",component:ee}))),[y.capabilities.actions.show,R,L,E,_]);return n?o.a.createElement(z.a,{addPadding:e},o.a.createElement(B.a,{schema:w,data:S,columns:"single"})):o.a.createElement(o.a.Fragment,null,o.a.createElement(z.a,{addPadding:!d},o.a.createElement(x.c,{form:O,"data-test-subj":"stepRuleActions"},o.a.createElement(a.EuiForm,null,ne))),!d&&o.a.createElement(o.a.Fragment,null,o.a.createElement(a.EuiHorizontalRule,{margin:"m"}),o.a.createElement(a.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd",gutterSize:"xs",responsive:!1},o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(a.EuiButton,{fill:!1,isDisabled:s,isLoading:s,onClick:()=>D(!1),"data-test-subj":"create-enabled-false"},H)),o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(a.EuiButton,{fill:!0,isDisabled:s,isLoading:s,onClick:()=>D(!0),"data-test-subj":"create-enable"},G)))))},ae=Object(r.memo)(ne)},function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return J})),n.d(t,"d",(function(){return Z})),n.d(t,"e",(function(){return F})),n.d(t,"f",(function(){return V})),n.d(t,"g",(function(){return ne})),n.d(t,"i",(function(){return Q})),n.d(t,"c",(function(){return ae})),n.d(t,"h",(function(){return se}));var a=n(4),i=n.n(a),r=n(32),o=n(0),s=n(480),l=n(168);const c=Object(a.memo)((({handleRefresh:e,http:t,handleCloseFlyout:n,addSuccess:c,addError:u})=>{const{start:d,...p}=Object(s.a)(),m=Object(a.useRef)(new AbortController);let g;!function(e){e.name="name",e.description="description"}(g||(g={}));const[f,b]=Object(a.useState)({name:"",description:""}),y=({target:e},t)=>{const{value:n}=e;b({...f,[t]:n})},h=Object(a.useCallback)((()=>{var e;p.loading||""===f.name||(m.current=new AbortController,d({http:t,signal:m.current.signal,name:f.name,description:null!==(e=f.description)&&void 0!==e?e:""}))}),[d,p.loading,f,t]),v=Object(a.useCallback)((t=>{c({text:Object(l.bb)(f.name),title:l.V}),e(),n()}),[c,n,e,f]),E=Object(a.useCallback)((e=>{var t;e.message.includes("AbortError")||null!=e&&null!==(t=e.body)&&void 0!==t&&t.message.includes("AbortError")||u(e,{title:o.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListErrorTitle",{defaultMessage:"creation error"})})}),[u]);return Object(a.useEffect)((()=>{p.loading||(null!=p&&p.result?v(p.result):null!=p&&p.error&&E(null==p?void 0:p.error))}),[null==p?void 0:p.error,p.loading,p.result,E,v]),i.a.createElement(r.EuiFlyout,{ownFocus:!0,size:"s",onClose:n,"data-test-subj":"createSharedExceptionListFlyout"},i.a.createElement(r.EuiFlyoutHeader,{hasBorder:!0},i.a.createElement(r.EuiTitle,{size:"m"},i.a.createElement("h2",{"data-test-subj":"createSharedExceptionListTitle"},l.h))),i.a.createElement(r.EuiFlyoutBody,null,i.a.createElement(r.EuiText,null,l.f),i.a.createElement(r.EuiFieldText,{placeholder:l.g,value:f.name,onChange:e=>y(e,g.name),"aria-label":"Use aria labels when no actual label is in use"}),i.a.createElement(r.EuiSpacer,null),i.a.createElement(r.EuiText,null,l.d),i.a.createElement(r.EuiTextArea,{placeholder:l.e,value:f.description,onChange:e=>y(e,g.description),"aria-label":"Stop the hackers"})),i.a.createElement(r.EuiFlyoutFooter,null,i.a.createElement(r.EuiFlexGroup,{justifyContent:"spaceBetween"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButtonEmpty,{iconType:"cross",onClick:n,flush:"left"},l.a)),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButton,{"data-test-subj":"exception-lists-form-create-shared",onClick:h,disabled:""===f.name},l.c)))))}));c.displayName="CreateSharedListFlyout";var u=n(36),d=n(93),p=n(195),m=n(33),g=n.n(m),f=n(40),b=n(505),y=n(345);const h=g()(r.EuiFlexItem).withConfig({displayName:"StyledFlexItem",componentId:"sc-cbckbl-0"})(["border-right:1px solid #d3dae6;padding:"," "," "," 0;"],f.euiThemeVars.euiSizeXS,f.euiThemeVars.euiSizeS,f.euiThemeVars.euiSizeXS),v=g()(r.EuiText).withConfig({displayName:"TextContainer",componentId:"sc-cbckbl-1"})(["width:max-content;"]),E=Object(a.memo)((({title:e,badgeString:t})=>i.a.createElement(r.EuiFlexGroup,{alignItems:"center"},i.a.createElement(r.EuiFlexItem,null,i.a.createElement(v,{grow:!0,size:"xs"},`${e}:`)),i.a.createElement(h,null,i.a.createElement(r.EuiBadge,null,t)))));E.displayName="TitleBadge";var x=n(101),k=n(43),S=n.n(k);const w=o.i18n.translate("xpack.securitySolution.exceptions.commentEventLabel",{defaultMessage:"added a comment"}),j=(o.i18n.translate("xpack.securitySolution.exceptions.operatingSystemFullLabel",{defaultMessage:"Operating System"}),o.i18n.translate("xpack.securitySolution.exceptions.viewer.addToEndpointListLabel",{defaultMessage:"Add endpoint exception"}),o.i18n.translate("xpack.securitySolution.exceptions.viewer.addToDetectionsListLabel",{defaultMessage:"Add rule exception"}),o.i18n.translate("xpack.securitySolution.exceptions.viewer.addCommentPlaceholder",{defaultMessage:"Add a new comment..."}),o.i18n.translate("xpack.securitySolution.exceptions.viewer.addToClipboard",{defaultMessage:"Comment"}));o.i18n.translate("xpack.securitySolution.exceptions.clearExceptionsLabel",{defaultMessage:"Remove Exception List"}),o.i18n.translate("xpack.securitySolution.exceptions.fetchError",{defaultMessage:"Error fetching exception list"}),o.i18n.translate("xpack.securitySolution.exceptions.errorLabel",{defaultMessage:"Error"}),o.i18n.translate("xpack.securitySolution.exceptions.cancelLabel",{defaultMessage:"Cancel"}),o.i18n.translate("xpack.securitySolution.exceptions.modalErrorAccordionText",{defaultMessage:"Show rule reference information:"}),o.i18n.translate("xpack.securitySolution.exceptions.disassociateExceptionListError",{defaultMessage:"Failed to remove exception list"}),o.i18n.translate("xpack.securitySolution.exceptions.operatingSystemWindows",{defaultMessage:"Windows"}),o.i18n.translate("xpack.securitySolution.exceptions.operatingSystemMac",{defaultMessage:"macOS"}),o.i18n.translate("xpack.securitySolution.exceptions.operatingSystemWindowsAndMac",{defaultMessage:"Windows and macOS"}),o.i18n.translate("xpack.securitySolution.exceptions.operatingSystemLinux",{defaultMessage:"Linux"}),o.i18n.translate("xpack.securitySolution.exceptions.fetchingReferencesErrorToastTitle",{defaultMessage:"Error fetching exception references"});var O=n(710);const I=e=>e.map((e=>({username:e.created_by,timestamp:S()(e.created_at).format("on MMM Do YYYY @ HH:mm:ss"),event:w,timelineAvatar:i.a.createElement(r.EuiAvatar,{size:"l",name:e.created_by.toUpperCase()}),children:i.a.createElement(r.EuiText,{size:"s"},e.comment),actions:i.a.createElement(O.a,{"data-test-subj":"copy-to-clipboard",text:e.comment,titleSummary:j})})));var T=n(1),C=n(156),M=n(374),N=n(89);const D=({referenceName:e,referenceId:t,external:n})=>i.a.createElement(N.k,{"data-test-subj":"SecuritySolutionLinkAnchor",deepLinkId:T.uc.rules,path:Object(C.c)(t,M.b.alerts),external:n},e);D.displayName="LinkAnchor";const F=i.a.memo(D);F.displayName="ListDetailsLinkAnchor";var A=n(35),_=n(247);const R=g.a.span.withConfig({displayName:"StyledText",componentId:"sc-1sobm2a-0"})(["font-weight:bold;color:",";"],(({theme:e})=>e.eui.euiColorDarkestShade)),P=g()(r.EuiFlexGroup).withConfig({displayName:"MyUtilities",componentId:"sc-1sobm2a-1"})(["height:50px;"]),L=g.a.span.withConfig({displayName:"StyledCondition",componentId:"sc-1sobm2a-2"})(["display:inline-block !important;vertical-align:middle !important;line-height:1;"]),q=({dataTestSubj:e,pagination:t,lastUpdated:n,exceptionsTitle:a})=>{const{pageSize:o,totalItemCount:s}=t;return i.a.createElement(P,{alignItems:"center",justifyContent:"spaceBetween"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(_.a,null,i.a.createElement(_.d,null,i.a.createElement(_.c,null,i.a.createElement(_.e,{dataTestSubj:`${e}ShowingText`},i.a.createElement(A.FormattedMessage,{id:"xpack.securitySolution.exceptions.viewer.paginationDetails",defaultMessage:"Showing {partOne} of {partTwo}",values:{partOne:i.a.createElement(R,null,`1-${Math.min(o,s)}`),partTwo:i.a.createElement(R,null,`${s}`)}})),a&&i.a.createElement(R,{"data-test-subj":`${e}exceptionsTitle`},a))))),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiText,{size:"s","data-test-subj":`${e}LastUpdated`},i.a.createElement(A.FormattedMessage,{id:"xpack.securitySolution.exceptions.viewer.lastUpdated",defaultMessage:"Updated {updated}",values:{updated:i.a.createElement(L,null,i.a.createElement(x.b,{value:n,tooltipAnchorClassName:"eui-textTruncate"}))}}))))};q.displayName="ExceptionsUtilityComponent";const B=i.a.memo(q);B.displayName="ExceptionsUtility";var z=n(481);const $=({isReadOnly:e,exceptions:t,listType:n,lastUpdated:a,pagination:r,emptyViewerTitle:o,emptyViewerBody:s,emptyViewerButtonText:l,viewerStatus:c,ruleReferences:u,hideUtility:d=!1,onDeleteException:m,onEditExceptionItem:g,onPaginationChange:f,onCreateExceptionListItem:b})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(p.c,{viewerStatus:c,listType:n,ruleReferences:u,isReadOnly:e,exceptions:t,emptyViewerTitle:o,emptyViewerBody:s,emptyViewerButtonText:l,pagination:r,lastUpdated:a,editActionLabel:z.b,deleteActionLabel:z.a,onPaginationChange:f,onEditExceptionItem:g,onDeleteException:m,getFormattedComments:I,securityLinkAnchorComponent:F,formattedDateComponent:x.a,onCreateExceptionListItem:b,exceptionsUtilityComponent:()=>d?null:i.a.createElement(B,{exceptionsTitle:z.c,pagination:r,lastUpdated:a})}));$.displayName="ListExceptionItemsComponent";const V=i.a.memo($);V.displayName="ListExceptionItems";var U=n(593),H=n(497),G=n(704);const Q=Object(a.memo)((({linkedRules:e,showButtonLoader:t,saveIsDisabled:n=!0,onSave:a,onCancel:o,onRuleSelectionChange:s})=>{const c=Object(r.useGeneratedHtmlId)({prefix:"complicatedFlyoutTitle"});return i.a.createElement(r.EuiFlyout,{hideCloseButton:!0,ownFocus:!0,onClose:o,"aria-labelledby":c},i.a.createElement(r.EuiFlyoutHeader,{hasBorder:!0},i.a.createElement(r.EuiTitle,{size:"m"},i.a.createElement("h2",{id:c},l.L)),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(r.EuiText,{size:"s",color:"subdued"},l.K)),i.a.createElement(r.EuiFlyoutBody,null,i.a.createElement(G.a,{initiallySelectedRules:e,onRuleSelectionChange:s})),i.a.createElement(r.EuiFlyoutFooter,null,i.a.createElement(r.EuiFlexGroup,{justifyContent:"spaceBetween"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButtonEmpty,{onClick:o,flush:"left"},l.J)),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButton,{isLoading:t,disabled:n,onClick:a,fill:!0},l.M)))))}));Q.displayName="ManageRules";const W=u.css`
  // Ask KIBANA Team why Emotion is not working fully under xpack
  width: 100%;
  z-index: 100;
  span {
    cursor: pointer;
    display: block;
  }
`,K=g()(r.EuiPanel).withConfig({displayName:"ExceptionPanel",componentId:"sc-1xn0pid-0"})(["margin:-"," "," 0 ",";"],f.euiThemeVars.euiSizeS,f.euiThemeVars.euiSizeM,f.euiThemeVars.euiSizeM),Y=g()(r.EuiFlexGroup).withConfig({displayName:"ListHeaderContainer",componentId:"sc-1xn0pid-1"})(["padding:",";text-align:initial;"],f.euiThemeVars.euiSizeS),J=Object(a.memo)((({exceptionsList:e,handleDelete:t,handleExport:n,readOnly:a})=>{const{linkedRules:o,showManageRulesFlyout:s,showManageButtonLoader:c,disableManageButton:u,onManageRules:m,onSaveManageRules:g,onCancelManageRules:f,onRuleSelectionChange:h}=Object(U.a)(e.list_id),{listId:v,listName:x,listType:k,createdAt:S,createdBy:w,exceptions:j,pagination:O,ruleReferences:I,toggleAccordion:T,openAccordionId:C,menuActionItems:M,listRulesCount:N,listDescription:D,exceptionItemsCount:F,onEditExceptionItem:A,onDeleteException:_,onPaginationChange:R,setToggleAccordion:P,exceptionViewerStatus:L,showAddExceptionFlyout:q,showEditExceptionFlyout:B,exceptionToEdit:z,onAddExceptionClick:$,handleConfirmExceptionFlyout:G,handleCancelExceptionItemFlyout:J,goToExceptionDetail:X,emptyViewerTitle:Z,emptyViewerBody:ee,emptyViewerButtonText:te}=Object(H.a)({exceptionsList:e,handleExport:n,handleDelete:t,handleManageRules:m});return i.a.createElement(r.EuiFlexGroup,{gutterSize:"none"},i.a.createElement(r.EuiFlexItem,null,i.a.createElement(r.EuiPanel,{hasShadow:!1},i.a.createElement(r.EuiAccordion,{buttonProps:{css:W},id:C,arrowDisplay:"none",onToggle:()=>P(!T),buttonContent:i.a.createElement(r.EuiPanel,null,i.a.createElement(Y,{gutterSize:"m",alignItems:"flexStart"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButtonIcon,{iconType:T?"arrowDown":"arrowRight","aria-label":"Next"})),i.a.createElement(r.EuiFlexItem,null,i.a.createElement(r.EuiFlexGroup,{direction:"column",key:v,alignItems:"flexStart",gutterSize:"none"},i.a.createElement(r.EuiFlexItem,{grow:!0},i.a.createElement(r.EuiText,{size:"m"},i.a.createElement(r.EuiLink,{"data-test-subj":"exception-list-name",onClick:X},x))),i.a.createElement(r.EuiFlexItem,{grow:!0},i.a.createElement(r.EuiText,{size:"xs"},i.a.createElement(r.EuiTextColor,{color:"subdued"},D))))),i.a.createElement(r.EuiFlexItem,null,i.a.createElement(r.EuiFlexGroup,{alignItems:"center"},i.a.createElement(r.EuiFlexItem,null,i.a.createElement(E,{title:l.i,badgeString:S})),i.a.createElement(r.EuiFlexItem,null,i.a.createElement(E,{title:l.b,badgeString:w})),i.a.createElement(r.EuiFlexItem,null,i.a.createElement(E,{title:l.k,badgeString:F})),i.a.createElement(r.EuiFlexItem,null,i.a.createElement(E,{title:l.S,badgeString:N})),i.a.createElement(r.EuiFlexItem,null,i.a.createElement(p.e,{disableActions:a,dataTestSubj:"sharedListOverflowCard",actions:M}))))))},i.a.createElement(K,{hasBorder:!0},i.a.createElement(V,{isReadOnly:a,exceptions:j,listType:e.type,pagination:O,hideUtility:!0,viewerStatus:L,ruleReferences:I,onDeleteException:_,onEditExceptionItem:A,onPaginationChange:R,onCreateExceptionListItem:$,lastUpdated:null,emptyViewerTitle:Z,emptyViewerBody:ee,emptyViewerButtonText:te}))))),q?i.a.createElement(y.a,{rules:null,isBulkAction:!1,isEndpointItem:k===d.b.ENDPOINT,sharedListToAddTo:[e],onCancel:J,onConfirm:G,"data-test-subj":"addExceptionItemFlyoutInSharedLists",showAlertCloseOptions:!1,isNonTimeline:!0}):null,B&&z?i.a.createElement(b.a,{list:e,itemToEdit:z,showAlertCloseOptions:!0,openedFromListDetailPage:!0,onCancel:J,onConfirm:G,"data-test-subj":"editExceptionItemFlyoutInSharedLists"}):null,s?i.a.createElement(Q,{linkedRules:o,showButtonLoader:c,saveIsDisabled:u,onSave:g,onCancel:f,onRuleSelectionChange:h}):null)}));J.displayName="ExceptionsListCard";var X=n(499);const Z=i.a.memo((({handleRefresh:e,http:t,addSuccess:n,addError:o,setDisplayImportListFlyout:s})=>{var c;const u=Object(a.useRef)(null),d=Object(r.useGeneratedHtmlId)({prefix:"filePicker"}),[p,m]=Object(a.useState)(null),[g,f]=Object(a.useState)(!1),[b,y]=Object(a.useState)(!1),[h,v]=Object(a.useState)(!1),E=Object(a.useCallback)((()=>{var e;null!==(e=u.current)&&void 0!==e&&e.fileInput&&(u.current.fileInput.value="",u.current.handleChange()),m(null),v(!1),y(!1),f(!1)}),[]),{start:x,...k}=Object(X.a)(),S=Object(a.useRef)(new AbortController),w=Object(a.useCallback)((()=>{!k.loading&&p&&(S.current=new AbortController,x({file:p,http:t,signal:S.current.signal,overwrite:g,overwriteExceptions:g,asNewList:b}))}),[b,p,t,x,k.loading,g]),j=Object(a.useCallback)((t=>{var a;E(),n({text:l.db(null!==(a=null==p?void 0:p.name)&&void 0!==a?a:""),title:l.Y}),e()}),[E,n,e]),O=Object(a.useCallback)((e=>{e.forEach((e=>{e.error.message.includes("AbortError")||o(e.error.message,{title:l.X})}))}),[o]);Object(a.useEffect)((()=>{var e;if(!k.loading)if(null!=k&&null!==(e=k.result)&&void 0!==e&&e.success)j(null==k?void 0:k.result);else{var t,n;const e=[];var a,i;null!=k&&null!==(t=k.error)&&void 0!==t&&t.body&&e.push({error:{...null==k||null===(a=k.error)||void 0===a?void 0:a.body}}),null!=k&&null!==(n=k.result)&&void 0!==n&&n.errors&&(null==k||null===(i=k.result)||void 0===i||i.errors.forEach((t=>{t.error.message.includes("already exists")&&v(!0),e.push(t)}))),O(e)}}),[O,j,null==k?void 0:k.error,k.loading,null==k?void 0:k.result,null==k||null===(c=k.result)||void 0===c?void 0:c.errors]);const I=Object(a.useCallback)((e=>{var t;m(null!==(t=null==e?void 0:e.item(0))&&void 0!==t?t:null)}),[]);return i.a.createElement(r.EuiFlyout,{ownFocus:!0,size:"s",onClose:()=>s(!1)},i.a.createElement(r.EuiFlyoutHeader,{hasBorder:!0},i.a.createElement(r.EuiTitle,{size:"m"},i.a.createElement("h2",null,l.F))),i.a.createElement(r.EuiFlyoutBody,null,i.a.createElement(r.EuiText,null,l.E),i.a.createElement(r.EuiFilePicker,{id:d,multiple:!0,ref:u,initialPromptText:l.I,onChange:I,display:"large","aria-label":"Use aria labels when no actual label is in use"}),h&&i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiSpacer,null),i.a.createElement(r.EuiTextColor,{color:"danger"},l.H),i.a.createElement(r.EuiSpacer,null),i.a.createElement(r.EuiCheckbox,{id:"basicCheckboxId",label:l.G,checked:g,onChange:e=>{f(!g),y(!1)}}),i.a.createElement(r.EuiCheckbox,{id:"createNewListCheckbox",label:l.D,checked:b,onChange:e=>{y(!b),f(!1)}}))),i.a.createElement(r.EuiFlyoutFooter,null,i.a.createElement(r.EuiFlexGroup,{justifyContent:"spaceBetween"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButtonEmpty,{iconType:"cross",onClick:()=>s(!1),flush:"left"},l.a)),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButton,{"data-test-subj":"exception-lists-form-import-action",onClick:w,disabled:null==p||k.loading},l.W)))))}));var ee=n(500);const te=({list:e,isReadOnly:t,refreshExceptions:n})=>{const{listName:a,exceptions:o,listType:s,lastUpdated:c,pagination:u,emptyViewerTitle:m,emptyViewerBody:g,emptyViewerButtonText:f,viewerStatus:h,ruleReferences:v,showAddExceptionFlyout:E,showEditExceptionFlyout:x,exceptionToEdit:k,exceptionViewerStatus:S,onSearch:w,onAddExceptionClick:j,onDeleteException:O,onEditExceptionItem:I,onPaginationChange:T,handleCancelExceptionItemFlyout:C,handleConfirmExceptionFlyout:M}=Object(ee.a)(e,n);return i.a.createElement(i.a.Fragment,null,E?i.a.createElement(y.a,{rules:null,isBulkAction:!1,isEndpointItem:s===d.b.ENDPOINT,sharedListToAddTo:[e],onCancel:C,onConfirm:M,"data-test-subj":"addExceptionItemFlyoutInList",showAlertCloseOptions:!1,isNonTimeline:!0}):h===p.i.EMPTY||h===p.i.LOADING?i.a.createElement(p.a,{isReadOnly:t,viewerStatus:h,onCreateExceptionListItem:j,title:l.x,body:l.u(a),buttonText:l.v}):i.a.createElement(r.EuiPanel,{hasBorder:!1,hasShadow:!1},i.a.createElement(i.a.Fragment,null,x&&k&&i.a.createElement(b.a,{list:e,itemToEdit:k,showAlertCloseOptions:!0,openedFromListDetailPage:!0,onCancel:C,onConfirm:M,"data-test-subj":"editExceptionItemFlyoutInList"}),i.a.createElement(p.g,{addExceptionButtonText:s===d.b.ENDPOINT?l.t:l.s,listType:s,onSearch:w,onAddExceptionClick:j,isSearching:h===p.i.SEARCHING,isButtonFilled:!1,buttonIconType:"plusInCircle"}),i.a.createElement(V,{viewerStatus:S,listType:s,ruleReferences:v,isReadOnly:t,exceptions:o,emptyViewerTitle:m,emptyViewerBody:g,emptyViewerButtonText:f,pagination:u,lastUpdated:c,onPaginationChange:T,onEditExceptionItem:I,onDeleteException:O,onCreateExceptionListItem:j}))))};te.displayName="ListWithSearchComponent";const ne=i.a.memo(te);ne.displayName="ListWithSearch";const ae=({onRefresh:e,totalExceptionLists:t,setSort:n,sort:a,sortFields:o})=>{var s;const c=null==o?void 0:o.find((e=>e.field===(null==a?void 0:a.field)));return i.a.createElement(_.a,{border:!0},i.a.createElement(_.d,null,i.a.createElement(_.c,null,i.a.createElement(_.e,{dataTestSubj:"showingExceptionLists"},l.T(t))),i.a.createElement(_.c,null,i.a.createElement(_.b,{dataTestSubj:"refreshRulesAction",iconSide:"left",iconType:"refresh",onClick:e},l.R))),i.a.createElement(_.d,null,i.a.createElement(i.a.Fragment,null,i.a.createElement(_.c,null,a&&i.a.createElement(_.b,{dataTestSubj:"sortExceptions",iconSide:"right",iconType:"asc"===a.order?"sortUp":"sortDown",popoverPanelPaddingSize:"s",popoverContent:()=>i.a.createElement(r.EuiContextMenuPanel,{size:"s",items:null==o?void 0:o.map((e=>{const t=(null==c?void 0:c.field)===e.field;let o=e.defaultOrder;return t&&(o="asc"===a.order?"desc":"asc"),i.a.createElement(r.EuiContextMenuItem,{key:e.field,onClick:()=>null==n?void 0:n({field:e.field,order:o})},i.a.createElement(ie,null,e.label," ",(null==c?void 0:c.field)===e.field&&i.a.createElement(re,{type:"asc"===a.order?"sortUp":"sortDown"})))}))})},i.a.createElement(ie,null,l.U," ",null==o||null===(s=o.find((e=>e.field===a.field)))||void 0===s?void 0:s.label))))))},ie=g()("div").withConfig({displayName:"SortMenuItem",componentId:"sc-1xmymh5-0"})(["display:flex;align-items:center;"]),re=g()(r.EuiIcon).withConfig({displayName:"SortIcon",componentId:"sc-1xmymh5-1"})(["margin-left:8px;"]);ae.displayName="ExceptionsTableUtilityBar";const oe={strict:!0,fields:{created_by:{type:"string"},name:{type:"string"},type:{type:"string"},list_id:{type:"string"},tags:{type:"string"}}},se=i.a.memo((({onSearch:e})=>i.a.createElement(r.EuiSearchBar,{"data-test-subj":"exceptionsHeaderSearch","aria-label":l.l,onChange:e,box:{"data-test-subj":"exceptionsHeaderSearchInput",placeholder:l.z,incremental:!1,schema:oe}})));se.displayName="ListsSearchBar"},function(e,t,n){"use strict";n.d(t,"a",(function(){return Ee}));var a=n(32),i=n(4),r=n.n(i),o=n(33),s=n.n(o),l=n(166),c=n(167),u=n(82),d=n.n(u),p=n(34),m=n(113),g=n(100);const f=s()(a.EuiFormRow).withConfig({displayName:"MyEuiFormRow",componentId:"sc-1urlknr-0"})([".euiFormRow__labelWrapper{.euiText{padding-right:32px;}}"]),b=s()(a.EuiButtonEmpty).withConfig({displayName:"MyAddItemButton",componentId:"sc-1urlknr-1"})(["margin:4px 0px;&.euiButtonEmpty--small{font-size:12px;}.euiIcon{width:12px;height:12px;}"]);b.defaultProps={flush:"left",iconType:"plusInCircle",size:"s"};const y=({addText:e,dataTestSubj:t,field:n,idAria:o,isDisabled:s,validate:l})=>{const[c,u]=Object(i.useState)(!1),{isInvalid:y,errorMessage:h}=Object(g.i)(n),[v,E]=Object(i.useState)(-1),x=Object(i.useRef)([]),k=Object(i.useCallback)((e=>{const t=n.value,a=[...t.slice(0,e),...t.slice(e+1)];n.setValue(0===a.length?[""]:a),x.current=[...x.current.slice(0,e),...x.current.slice(e+1)],x.current=x.current.map(((t,n)=>(n>=e&&null!=x.current[e]&&(t.value="re-render"),t)))}),[n]),S=Object(i.useCallback)((()=>{const e=n.value;n.setValue([...e,""])}),[n]),w=Object(i.useCallback)(((e,t)=>{const a=n.value,i=e.target.value;n.setValue([...a.slice(0,t),i,...a.slice(t+1)])}),[n]),j=Object(i.useCallback)(((e,t)=>{null!=t&&(x.current=[...x.current.slice(0,e),t,...x.current.slice(e+1)])}),[x]);Object(i.useEffect)((()=>{-1===v||Object(p.isEmpty)(x.current)||null==x.current[v]||(x.current[v].focus(),E(-1))}),[v,x.current]);const O=n.value;return r.a.createElement(f,{label:n.label,labelAppend:n.labelAppend,error:c?h:null,isInvalid:c&&y,fullWidth:!0,"data-test-subj":t,describedByIds:o?[o]:void 0},r.a.createElement(r.a.Fragment,null,O.map(((e,t)=>{const n={disabled:s,...t===O.length-1?{inputRef:j.bind(null,t)}:{},value:e,isInvalid:null!=l&&c&&l(e)};return r.a.createElement("div",{key:t},r.a.createElement(a.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},r.a.createElement(a.EuiFlexItem,{grow:!0},r.a.createElement(a.EuiFieldText,d()({onBlur:()=>u(!0),onChange:e=>w(e,t),fullWidth:!0},n))),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiButtonIcon,{color:"danger",iconType:"trash",isDisabled:s||Object(p.isEmpty)(e)&&1===O.length,onClick:()=>k(t),"aria-label":m.tb}))),O.length-1!==t&&r.a.createElement(a.EuiSpacer,{size:"s"}))})),r.a.createElement(b,{onClick:S,isDisabled:s},e)))};var h=n(377),v=n(7),E=n(310);const x=[{framework:"MITRE ATT&CK",tactic:{id:"none",name:"none",reference:"none"},technique:[]}];Object(E.b)([]);var k=n(0);const S=k.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.threatsDescription",{defaultMessage:"threats"}),w=k.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.tacticsDescription",{defaultMessage:"tactic"}),j=k.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.techniquesDescription",{defaultMessage:"technique"}),O=k.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.subtechniquesDescription",{defaultMessage:"subtechnique"}),I=k.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.addTacticTitle",{defaultMessage:"Add tactic"}),T=k.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.addTechniqueTitle",{defaultMessage:"Add technique"}),C=k.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.addSubtechniqueTitle",{defaultMessage:"Add subtechnique"}),M=k.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.tacticPlaceHolderDescription",{defaultMessage:"Select a tactic ..."}),N=k.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.techniquePlaceHolderDescription",{defaultMessage:"Select a technique ..."}),D=k.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.subtechniquePlaceHolderDescription",{defaultMessage:"Select a subtechnique ..."}),F=s.a.div.withConfig({displayName:"SubtechniqueContainer",componentId:"sc-1cb5h5o-0"})(["margin-left:48px;"]),A=({field:e,idAria:t,isDisabled:o,threatIndex:s,techniqueIndex:l,onFieldChange:c})=>{const u=e.value,[d,g]=Object(i.useState)([]);Object(i.useEffect)((()=>{!async function(){const e=await n.e(14).then(n.bind(null,1284));g(e.subtechniquesOptions)}()}),[]);const f=Object(i.useMemo)((()=>{var e;return[...null!==(e=u[s].technique)&&void 0!==e?e:[]]}),[u,s]),y=Object(i.useCallback)((t=>{var n;const a=[...e.value],i=null!==(n=f[l].subtechnique)&&void 0!==n?n:[];null!=i&&(i.splice(t,1),f[l]={...f[l],subtechnique:i},a[s].technique=f,c(a))}),[e,c,l,f,s]),h=Object(i.useCallback)((()=>{const t=[...e.value],n=f[l].subtechnique;f[l]=null!=n?{...f[l],subtechnique:[...n,{id:"none",name:"none",reference:"none"}]}:{...f[l],subtechnique:[{id:"none",name:"none",reference:"none"}]},t[s].technique=f,c(t)}),[e,c,l,f,s]),v=Object(i.useCallback)(((t,n)=>{const a=[...e.value],{id:i,reference:r,name:o}=d.find((e=>e.value===n))||{id:"",name:"",reference:""},u=f[l].subtechnique;null!=u&&c([...a.slice(0,s),{...a[s],technique:[...f.slice(0,l),{...f[l],subtechnique:[...u.slice(0,t),{id:i,reference:r,name:o},...u.slice(t+1)]},...f.slice(l+1)]},...a.slice(s+1)])}),[e.value,d,f,l,c,s]),E=Object(i.useCallback)(((t,n,i)=>{const o=d.filter((e=>e.techniqueId===f[l].id));return r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiSuperSelect,{id:"mitreAttackSubtechnique",options:[..."none"===i.name?[{inputDisplay:r.a.createElement(r.a.Fragment,null,D),value:"none",disabled:n}]:[],...o.map((e=>({inputDisplay:r.a.createElement(r.a.Fragment,null,e.label),value:e.value,disabled:n})))],prepend:`${e.label} ${O}`,"aria-label":"",onChange:v.bind(null,t),fullWidth:!0,valueOfSelected:Object(p.camelCase)(i.name),"data-test-subj":"mitreAttackSubtechnique",disabled:n,placeholder:D}))}),[d,e.label,v,f,l]),x=Object(i.useMemo)((()=>f[l].subtechnique),[f,l]);return r.a.createElement(F,null,null!=x&&x.map(((e,n)=>r.a.createElement("div",{key:n},r.a.createElement(a.EuiSpacer,{size:"s"}),r.a.createElement(a.EuiFormRow,{fullWidth:!0,describedByIds:t?[`${t} ${O}`]:void 0},r.a.createElement(a.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},r.a.createElement(a.EuiFlexItem,{grow:!0},E(n,o,e)),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiButtonIcon,{color:"danger",iconType:"trash",isDisabled:o,onClick:()=>y(n),"aria-label":m.tb}))))))),r.a.createElement(b,{"data-test-subj":"addMitreAttackSubtechnique",onClick:h,isDisabled:o},C))},_=(e,t)=>e.some((e=>e.techniqueId===t.id)),R=s.a.div.withConfig({displayName:"TechniqueContainer",componentId:"sc-1fugnao-0"})(["",""],(({theme:e})=>Object(o.css)(["margin-left:24px;padding-left:24px;border-left:2px solid ",";"],e.eui.euiColorLightestShade))),P=({field:e,idAria:t,isDisabled:o,threatIndex:s,onFieldChange:l})=>{var c;const u=e.value,[d,g]=Object(i.useState)([]),[f,y]=Object(i.useState)([]);Object(i.useEffect)((()=>{!async function(){const e=await n.e(14).then(n.bind(null,1284));g(e.techniquesOptions),y(e.subtechniquesOptions)}()}),[]);const h=Object(i.useCallback)((t=>{var n;const a=[...e.value],i=null!==(n=a[s].technique)&&void 0!==n?n:[];i.splice(t,1),a[s]={...a[s],technique:i},l(a)}),[e,s,l]),v=Object(i.useCallback)((()=>{var t;const n=[...e.value];n[s]={...n[s],technique:[...null!==(t=n[s].technique)&&void 0!==t?t:[],{id:"none",name:"none",reference:"none",subtechnique:[]}]},l(n)}),[e,s,l]),E=Object(i.useCallback)(((t,n)=>{var a;const i=[...e.value],{id:r,reference:o,name:c}=d.find((e=>e.value===n))||{id:"",name:"",reference:""},u=null!==(a=i[s].technique)&&void 0!==a?a:[];l([...i.slice(0,s),{...i[s],technique:[...u.slice(0,t),{id:r,reference:o,name:c,subtechnique:[]},...u.slice(t+1)]},...i.slice(s+1)])}),[e.value,d,s,l]),x=Object(i.useCallback)(((t,n,i,o)=>{const s=d.filter((e=>e.tactics.includes(Object(p.kebabCase)(t))));return r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiSuperSelect,{id:"mitreAttackTechnique",options:[..."none"===o.name?[{inputDisplay:r.a.createElement(r.a.Fragment,null,N),value:"none",disabled:i}]:[],...s.map((e=>({inputDisplay:r.a.createElement(r.a.Fragment,null,e.label),value:e.value,disabled:i})))],prepend:`${e.label} ${j}`,"aria-label":"",onChange:E.bind(null,n),fullWidth:!0,valueOfSelected:Object(p.camelCase)(o.name),"data-test-subj":"mitreAttackTechnique",disabled:i,placeholder:N}))}),[e.label,d,E]),k=null!==(c=u[s].technique)&&void 0!==c?c:[];return r.a.createElement(R,null,k.map(((n,i)=>r.a.createElement("div",{key:i},r.a.createElement(a.EuiSpacer,{size:"s"}),r.a.createElement(a.EuiFormRow,{fullWidth:!0,describedByIds:t?[`${t} ${j}`]:void 0},r.a.createElement(a.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},r.a.createElement(a.EuiFlexItem,{grow:!0},x(u[s].tactic.name,i,o,n)),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiButtonIcon,{color:"danger",iconType:"trash",isDisabled:o,onClick:()=>h(i),"aria-label":m.tb})))),r.a.createElement(A,{field:e,idAria:t,isDisabled:o||"none"===n.name||!1===_(f,n),threatIndex:s,techniqueIndex:i,onFieldChange:l})))),r.a.createElement(b,{"data-test-subj":"addMitreAttackTechnique",onClick:v,isDisabled:o},T))},L=s.a.div.withConfig({displayName:"MitreAttackContainer",componentId:"sc-bsl0gv-0"})(["margin-top:16px;"]),q=s()(a.EuiFormRow).withConfig({displayName:"InitialMitreAttackFormRow",componentId:"sc-bsl0gv-1"})([".euiFormRow__labelWrapper{.euiText{padding-right:32px;}}"]),B=Object(i.memo)((({field:e,idAria:t,isDisabled:o})=>{const s=Object(i.useCallback)((t=>{const n=[...e.value];n.splice(t,1),Object(p.isEmpty)(n)?e.setValue(x):e.setValue(n)}),[e]),l=Object(i.useCallback)((()=>{const t=[...e.value];Object(p.isEmpty)(t[t.length-1])?e.setValue([{tactic:{id:"none",name:"none",reference:"none"},technique:[]}]):e.setValue([...t,{tactic:{id:"none",name:"none",reference:"none"},technique:[]}])}),[e]),[c,u]=Object(i.useState)([]);Object(i.useEffect)((()=>{!async function(){const e=await n.e(14).then(n.bind(null,1284));u(e.tacticsOptions)}()}),[]);const d=Object(i.useCallback)(((t,n)=>{const a=[...e.value],{id:i,reference:r,name:o}=c.find((e=>e.value===n))||{id:"",name:"",reference:""};a.splice(t,1,{...a[t],tactic:{id:i,reference:r,name:o},technique:[]}),e.setValue([...a])}),[e,c]),g=Object(i.useMemo)((()=>[...e.value]),[e]),f=Object(i.useCallback)(((t,n,i)=>{const l=t.tactic.name;return r.a.createElement(a.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},r.a.createElement(a.EuiFlexItem,{grow:!0},r.a.createElement(a.EuiSuperSelect,{id:"mitreAttackTactic",options:[..."none"===l?[{inputDisplay:r.a.createElement(r.a.Fragment,null,M),value:"none",disabled:i}]:[],...c.map((e=>({inputDisplay:r.a.createElement(r.a.Fragment,null,e.text),value:e.value,disabled:i})))],prepend:`${e.label} ${w}`,"aria-label":"",onChange:d.bind(null,n),fullWidth:!0,valueOfSelected:Object(p.camelCase)(l),"data-test-subj":"mitreAttackTactic",placeholder:M})),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiButtonIcon,{color:"danger",iconType:"trash",isDisabled:o||Object(v.isEqual)(g,x),onClick:()=>s(n),"aria-label":m.tb})))}),[e.label,o,s,c,d,g]),y=Object(i.useCallback)((t=>{e.setValue(t)}),[e]);return r.a.createElement(L,null,g.map(((n,i)=>r.a.createElement("div",{key:i},0===i?r.a.createElement(q,{fullWidth:!0,label:`${e.label} ${S}`,labelAppend:e.labelAppend,describedByIds:t?[`${t} ${w}`]:void 0},r.a.createElement(r.a.Fragment,null,f(n,i,o))):r.a.createElement(a.EuiFormRow,{fullWidth:!0,describedByIds:t?[`${t} ${w}`]:void 0},f(n,i,o)),r.a.createElement(P,{field:e,threatIndex:i,isDisabled:o||"none"===n.tactic.name,idAria:t,onFieldChange:y})))),r.a.createElement(b,{"data-test-subj":"addMitreAttackTactic",onClick:l,isDisabled:o},I))}));var z=n(567),$=n(191);const V=r.a.createElement(a.EuiText,{color:"subdued",size:"xs"},m.Ub);var U=n(492);const{emptyField:H}=g.h,G={author:{type:g.a.COMBO_BOX,label:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldAuthorLabel",{defaultMessage:"Author"}),helpText:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldAuthorHelpText",{defaultMessage:"Type one or more authors for this rule. Press enter after each author to add a new one."}),labelAppend:V,validations:[{validator:H(k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.authorFieldEmptyError",{defaultMessage:"An author must not be empty"})),type:g.g.ARRAY_ITEM,isBlocking:!1}]},name:{type:g.a.TEXT,label:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldNameLabel",{defaultMessage:"Name"}),validations:[{validator:H(k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.nameFieldRequiredError",{defaultMessage:"A name is required."}))}]},description:{type:g.a.TEXTAREA,label:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldDescriptionLabel",{defaultMessage:"Description"}),validations:[{validator:H(k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.descriptionFieldRequiredError",{defaultMessage:"A description is required."}))}]},isBuildingBlock:{type:g.a.CHECKBOX,label:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldBuildingBlockLabel",{defaultMessage:'Mark all generated alerts as "building block" alerts'}),labelAppend:V},isAssociatedToEndpointList:{type:g.a.CHECKBOX,label:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldAssociatedToEndpointListLabel",{defaultMessage:"Add existing Endpoint exceptions to the rule"}),labelAppend:V},severity:{value:{},mapping:{},isMappingChecked:{}},riskScore:{value:{},mapping:{},isMappingChecked:{}},references:{label:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldReferenceUrlsLabel",{defaultMessage:"Reference URLs"}),labelAppend:V,validations:[{validator:(...e)=>{const[{value:t,path:n}]=e;let a=!1;return t.forEach((e=>{Object($.c)(e)&&(a=!0)})),a?{code:"ERR_FIELD_FORMAT",path:n,message:U.k}:void 0}}]},falsePositives:{label:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldFalsePositiveLabel",{defaultMessage:"False positive examples"}),labelAppend:V},license:{type:g.a.TEXT,label:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldLicenseLabel",{defaultMessage:"License"}),helpText:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldLicenseHelpText",{defaultMessage:"Add a license name"}),labelAppend:V},ruleNameOverride:{type:g.a.TEXT,label:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRuleNameOverrideLabel",{defaultMessage:"Rule name override"}),helpText:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRuleNameOverrideHelpText",{defaultMessage:"Choose a field from the source event to populate the rule name in the alert list."}),labelAppend:V},threat:{label:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldMitreThreatLabel",{defaultMessage:"MITRE ATT&CK\\u2122"}),labelAppend:V},threatIndicatorPath:{type:g.a.TEXT,label:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThreatIndicatorPathLabel",{defaultMessage:"Indicator prefix override"}),helpText:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThreatIndicatorPathHelpText",{defaultMessage:"Specify the document prefix containing your indicator fields. Used for enrichment of indicator match alerts."}),labelAppend:V},timestampOverride:{type:g.a.TEXT,label:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimestampOverrideLabel",{defaultMessage:"Timestamp override"}),helpText:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimestampOverrideHelpText",{defaultMessage:"Choose timestamp field used when executing rule. Pick field with timestamp closest to ingest time (e.g. event.ingested)."}),labelAppend:V},timestampOverrideFallbackDisabled:{type:g.a.CHECKBOX,defaultValue:!1,label:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimestampOverrideFallbackDisabledLabel",{defaultMessage:"Do not use @timestamp as a fallback timestamp field"}),labelAppend:V},tags:{type:g.a.COMBO_BOX,label:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTagsLabel",{defaultMessage:"Tags"}),helpText:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTagsHelpText",{defaultMessage:"Type one or more custom identifying tags for this rule. Press enter after each tag to begin a new one."}),labelAppend:V,validations:[{validator:H(k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.tagFieldEmptyError",{defaultMessage:"A tag must not be empty"})),type:g.g.ARRAY_ITEM,isBlocking:!1}]},note:{type:g.a.TEXTAREA,label:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.guideLabel",{defaultMessage:"Investigation guide"}),helpText:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.guideHelpText",{defaultMessage:"Provide helpful information for analysts that are investigating detection alerts. This guide will appear on the rule details page and in timelines (as notes) created from detection alerts generated by this rule."}),labelAppend:V}},Q={type:g.a.TEXT,label:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThreatIndicatorPathLabel",{defaultMessage:"Indicator prefix override"}),helpText:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThreatIndicatorPathHelpText",{defaultMessage:"Specify the document prefix containing your indicator fields. Used for enrichment of indicator match alerts."}),validations:[{validator:H(k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.threatIndicatorPathFieldEmptyError",{defaultMessage:"Indicator prefix override must not be empty"})),type:g.g.FIELD}]};var W=n(371),K=n(493),Y=n(459),J=n(265),X=n(77),Z=n(631);const ee=s.a.div.withConfig({displayName:"NestedContent",componentId:"sc-1o9f6e3-0"})(["margin-left:24px;"]),te=s()(a.EuiFlexItem).withConfig({displayName:"EuiFlexItemComboBoxColumn",componentId:"sc-1o9f6e3-1"})(["max-width:376px;"]),ne=s()(a.EuiFlexItem).withConfig({displayName:"EuiFlexItemIconColumn",componentId:"sc-1o9f6e3-2"})(["width:20px;"]),ae=s()(a.EuiFlexItem).withConfig({displayName:"EuiFlexItemSeverityColumn",componentId:"sc-1o9f6e3-3"})(["width:80px;"]),ie=({dataTestSubj:e,field:t,idAria:n,indices:o,isDisabled:s,options:l})=>{const{services:c}=Object(X.k)(),{value:u,isMappingChecked:d,mapping:m}=t.value,{setValue:g}=t,f=Object(i.useCallback)(((e,t)=>{g({value:u,isMappingChecked:d,mapping:[...m.slice(0,t),...e,...m.slice(t+1)]})}),[u,d,m,g]),b=Object(i.useCallback)(((e,t,[n])=>{var a;const i=[{...m[e],field:null!==(a=null==n?void 0:n.name)&&void 0!==a?a:"",value:null!=n?m[e].value:"",operator:"equals",severity:t}];f(i,e)}),[m,f]),y=Object(i.useCallback)((e=>{g({value:e,isMappingChecked:d,mapping:m})}),[d,m,g]),h=Object(i.useCallback)(((e,t,n)=>{const a=[{...m[e],field:m[e].field,value:null!=m[e].field&&""!==m[e].field?n:"",operator:"equals",severity:t}];f(a,e)}),[m,f]),v=Object(i.useCallback)((()=>{g({value:u,mapping:[...m],isMappingChecked:!d})}),[d,m,u,g]),E=Object(i.useMemo)((()=>r.a.createElement("div",null,r.a.createElement(a.EuiFlexGroup,{gutterSize:"s"},r.a.createElement(a.EuiFlexItem,null,Z.b)),r.a.createElement(a.EuiSpacer,{size:"xs"}),r.a.createElement(a.EuiText,{size:"xs"},Z.c))),[]),x=Object(i.useMemo)((()=>r.a.createElement("div",null,r.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"s",onClick:s?p.noop:v},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiCheckbox,{id:"severity-mapping-override",checked:d,disabled:s,onChange:v})),r.a.createElement(a.EuiFlexItem,null,Z.d)),r.a.createElement(a.EuiSpacer,{size:"xs"}),r.a.createElement(ee,null,r.a.createElement(a.EuiText,{size:"xs"},Z.e)))),[v,s,d]);return r.a.createElement(a.EuiFlexGroup,{direction:"column"},r.a.createElement(a.EuiFlexItem,null,r.a.createElement(a.EuiFormRow,{label:E,labelAppend:t.labelAppend,helpText:t.helpText,error:"errorMessage",isInvalid:!1,fullWidth:!0,"data-test-subj":"detectionEngineStepAboutRuleSeverity",describedByIds:["detectionEngineStepAboutRuleSeverity"]},r.a.createElement(a.EuiSuperSelect,{fullWidth:!1,disabled:!1,valueOfSelected:u,onChange:y,options:l,"data-test-subj":"select"}))),r.a.createElement(a.EuiFlexItem,null,r.a.createElement(a.EuiFormRow,{label:x,labelAppend:t.labelAppend,helpText:d?r.a.createElement(ee,null,Z.f):"",error:"errorMessage",isInvalid:!1,fullWidth:!0,"data-test-subj":`${e}-severityOverride`,describedByIds:n?[n]:void 0},r.a.createElement(ee,null,r.a.createElement(a.EuiSpacer,{size:"s"}),d&&r.a.createElement(a.EuiFlexGroup,{direction:"column",gutterSize:"s"},r.a.createElement(a.EuiFlexItem,null,r.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},r.a.createElement(te,null,r.a.createElement(a.EuiFormLabel,null,Z.g)),r.a.createElement(te,null,r.a.createElement(a.EuiFormLabel,null,Z.h)),r.a.createElement(ne,{grow:!1}),r.a.createElement(ae,{grow:!1},r.a.createElement(a.EuiFormLabel,null,Z.a)))),m.map(((e,t)=>{var n;return r.a.createElement(a.EuiFlexItem,{key:`${e.severity}-${t}`},r.a.createElement(a.EuiFlexGroup,{"data-test-subj":"severityOverrideRow",alignItems:"center",gutterSize:"s"},r.a.createElement(te,null,r.a.createElement(J.b,{placeholder:"",selectedField:re(e,o),isLoading:!1,isDisabled:s,isClearable:!1,indexPattern:o,onChange:b.bind(null,t,e.severity),"data-test-subj":`detectionEngineStepAboutRuleSeverityMappingField-${e.severity}-${t}`,"aria-label":`detectionEngineStepAboutRuleSeverityMappingField-${e.severity}-${t}`})),r.a.createElement(te,null,r.a.createElement(J.a,{autocompleteService:c.unifiedSearch.autocomplete,placeholder:"",selectedField:re(e,o),selectedValue:e.value,isClearable:!1,isDisabled:s,isLoading:!1,indexPattern:o,onChange:h.bind(null,t,e.severity),"data-test-subj":`detectionEngineStepAboutRuleSeverityMappingValue-${e.severity}-${t}`,"aria-label":`detectionEngineStepAboutRuleSeverityMappingValue-${e.severity}-${t}`})),r.a.createElement(ne,{grow:!1},r.a.createElement(a.EuiIcon,{type:"sortRight"})),r.a.createElement(ae,{grow:!1},null===(n=l.find((t=>t.value===e.severity)))||void 0===n?void 0:n.inputDisplay)))})))))))},re=(e,t)=>{const{field:n}=e,[a]=t.fields.filter((({name:e})=>n===e));return null!=a?a:{name:n,type:"string"}};var oe=n(632);const se=s.a.div.withConfig({displayName:"NestedContent",componentId:"sc-1k1nimg-0"})(["margin-left:24px;"]),le=s()(a.EuiFlexItem).withConfig({displayName:"EuiFlexItemComboBoxColumn",componentId:"sc-1k1nimg-1"})(["max-width:376px;"]),ce=s()(a.EuiFlexItem).withConfig({displayName:"EuiFlexItemIconColumn",componentId:"sc-1k1nimg-2"})(["width:20px;"]),ue=s()(a.EuiFlexItem).withConfig({displayName:"EuiFlexItemRiskScoreColumn",componentId:"sc-1k1nimg-3"})(["width:160px;"]),de=({dataTestSubj:e,field:t,idAria:n,indices:o,isDisabled:s,placeholder:l})=>{const{value:c,isMappingChecked:u,mapping:d}=t.value,{setValue:m}=t,g=Object(i.useMemo)((()=>["number"]),[]),f=Object(i.useMemo)((()=>pe(d,o)),[d,o]),b=Object(i.useCallback)((e=>{const t=e.target.value;m({value:Number(t.trim()),isMappingChecked:u,mapping:d})}),[m,u,d]),y=Object(i.useCallback)((([e])=>{var t;m({value:c,isMappingChecked:u,mapping:[{field:null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"",operator:"equals",value:"",risk_score:void 0}]})}),[m,c,u]),h=Object(i.useCallback)((()=>{m({value:c,isMappingChecked:!u,mapping:[...d]})}),[m,c,u,d]),v=Object(i.useMemo)((()=>r.a.createElement("div",null,r.a.createElement(a.EuiFlexGroup,{gutterSize:"s"},r.a.createElement(a.EuiFlexItem,null,oe.a)),r.a.createElement(a.EuiSpacer,{size:"xs"}),r.a.createElement(a.EuiText,{size:"xs"},oe.c))),[]),E=Object(i.useMemo)((()=>r.a.createElement("div",null,r.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"s",onClick:s?p.noop:h},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiCheckbox,{id:"risk_score-mapping-override",checked:u,disabled:s,onChange:h})),r.a.createElement(a.EuiFlexItem,null,oe.e)),r.a.createElement(a.EuiSpacer,{size:"xs"}),r.a.createElement(se,null,r.a.createElement(a.EuiText,{size:"xs"},oe.f)))),[u,h,s]);return r.a.createElement(a.EuiFlexGroup,{direction:"column"},r.a.createElement(a.EuiFlexItem,null,r.a.createElement(a.EuiFormRow,{label:v,labelAppend:t.labelAppend,helpText:t.helpText,error:"errorMessage",isInvalid:!1,fullWidth:!0,"data-test-subj":`${e}-defaultRisk`,describedByIds:n?[n]:void 0},r.a.createElement(a.EuiRange,{value:c,onChange:b,max:100,min:0,showRange:!0,showInput:!0,fullWidth:!1,showTicks:!0,tickInterval:25,"data-test-subj":`${e}-defaultRiskRange`}))),r.a.createElement(a.EuiFlexItem,null,r.a.createElement(a.EuiFormRow,{label:E,labelAppend:t.labelAppend,helpText:u?r.a.createElement(se,null,oe.g):"",error:"errorMessage",isInvalid:!1,fullWidth:!0,"data-test-subj":`${e}-riskOverride`,describedByIds:n?[n]:void 0},r.a.createElement(se,null,r.a.createElement(a.EuiSpacer,{size:"s"}),u&&r.a.createElement(a.EuiFlexGroup,{direction:"column",gutterSize:"s"},r.a.createElement(a.EuiFlexItem,null,r.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},r.a.createElement(le,null,r.a.createElement(a.EuiFormLabel,null,oe.h)),r.a.createElement(ce,{grow:!1}),r.a.createElement(ue,{grow:!1},r.a.createElement(a.EuiFormLabel,null,oe.a)))),r.a.createElement(a.EuiFlexItem,null,r.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},r.a.createElement(le,null,r.a.createElement(J.b,{placeholder:null!=l?l:"",indexPattern:o,selectedField:f,fieldTypeFilter:g,isLoading:!1,isClearable:!1,isDisabled:s,onChange:y,"data-test-subj":e,"aria-label":n})),r.a.createElement(ce,{grow:!1},r.a.createElement(a.EuiIcon,{type:"sortRight"})),r.a.createElement(ue,{grow:!1},r.a.createElement(a.EuiText,{size:"s"},oe.d)))))))))},pe=(e,t)=>{var n,a;const i=null!==(n=null==e||null===(a=e[0])||void 0===a?void 0:a.field)&&void 0!==n?n:"",[r]=t.fields.filter((({name:e})=>null!=i&&i===e));return null!=r?r:{name:i,type:"number"}},me=({dataTestSubj:e,field:t,idAria:n,indices:o,isDisabled:s,fieldType:l,placeholder:c})=>{const u=Object(i.useCallback)((([e])=>{var n;t.setValue(null!==(n=null==e?void 0:e.name)&&void 0!==n?n:"")}),[t]),d=Object(i.useMemo)((()=>{var e;const n=null!==(e=t.value)&&void 0!==e?e:"",[a]=o.fields.filter((({name:e})=>null!=n&&n===e));return a}),[t.value,o]),p=Object(i.useMemo)((()=>[l]),[l]);return r.a.createElement(a.EuiFormRow,{"data-test-subj":e,describedByIds:n?[n]:void 0,fullWidth:!0,helpText:t.helpText,label:t.label,labelAppend:t.labelAppend},r.a.createElement(J.b,{placeholder:null!=c?c:"",indexPattern:o,selectedField:d,fieldTypeFilter:p,isLoading:!1,isDisabled:s,isClearable:!1,onChange:u,"data-test-subj":e,"aria-label":n,fieldInputWidth:500}))};var ge=n(175),fe=n(1),be=n(723);const ye=Object(g.j)({component:g.b});s.a.div.withConfig({displayName:"ThreeQuartersContainer",componentId:"sc-1nsr0kk-0"})(["max-width:740px;"]).displayName="ThreeQuartersContainer";const he=s.a.div.withConfig({displayName:"TagContainer",componentId:"sc-1nsr0kk-1"})(["margin-top:16px;"]);he.displayName="TagContainer";const ve=({addPadding:e=!1,defaultValues:t,defineRuleData:n,descriptionColumns:o="singleSplit",isReadOnlyView:s,isUpdateView:u=!1,isLoading:d,onSubmit:p,setForm:m,onRuleDataChange:f})=>{const{data:b}=Object(X.k)().services,v=Object(i.useMemo)((()=>Object(l.f)(null==n?void 0:n.ruleType)),[n]),E=Object(i.useMemo)((()=>v?{...G,threatIndicatorPath:Q}:G),[v]),[x,k]=Object(i.useState)(t.severity.value),{ruleIndices:S}=((e,t)=>{const n=Object(i.useMemo)((()=>null!=e?e:[]),[e]),{loading:a,jobs:r}=Object(be.a)(n);return{mlJobLoading:a,ruleIndices:Object(i.useMemo)((()=>r.length>0?r[0].results_index_name?[`.ml-anomalies-${r[0].results_index_name}`]:[]:null!=t?t:[]),[r,t])}})(null==n?void 0:n.machineLearningJobId,null==n?void 0:n.index),[w,{indexPatterns:j}]=Object(ge.b)(S),[O,I]=Object(i.useState)(j);Object(i.useEffect)((()=>{null==(null==n?void 0:n.index)||""!==(null==n?void 0:n.dataViewId)&&null!=(null==n?void 0:n.dataViewId)||I(j)}),[null==n?void 0:n.dataViewId,null==n?void 0:n.index,j]),Object(i.useEffect)((()=>{(async()=>{if(null!=(null==n?void 0:n.dataViewId)&&""!==(null==n?void 0:n.dataViewId)){const e=await b.dataViews.get(null==n?void 0:n.dataViewId);I(e)}})()}),[b.dataViews,n,j,I]);const{form:T}=Object(g.k)({defaultValue:t,options:{stripEmptyFields:!1},schema:E}),{getFields:C,getFormData:M,submit:N}=T,[{severity:D,timestampOverride:F}]=Object(g.m)({form:T,watch:["isAssociatedToEndpointList","isBuildingBlock","riskScore","ruleNameOverride","severity","timestampOverride","threat","timestampOverrideFallbackDisabled"],onChange:e=>{f&&f({threatIndicatorPath:void 0,timestampOverrideFallbackDisabled:void 0,...e})}});Object(i.useEffect)((()=>{const e=null==D?void 0:D.value;if(null!=e&&e!==x){k(e);const t=z.h[e];if(null!=t){const e=C().riskScore;e.setValue({...e.value,value:t})}}}),[null==D?void 0:D.value,C,x]);const A=Object(i.useCallback)((async()=>{const e=await N();return null!=e&&e.isValid?{isValid:!0,data:{threatIndicatorPath:void 0,timestampOverrideFallbackDisabled:void 0,...e.data}}:{isValid:!1,data:M()}}),[M,N]),_=Object(i.useCallback)((()=>{p&&p()}),[p]);return Object(i.useEffect)((()=>{let e=!1;return m&&!e&&m(c.b.aboutRule,A),()=>{e=!0}}),[A,m]),s?r.a.createElement(W.a,{"data-test-subj":"aboutStep",addPadding:e},r.a.createElement(h.a,{columns:o,schema:E,data:t})):r.a.createElement(r.a.Fragment,null,r.a.createElement(W.a,{addPadding:!u},r.a.createElement(g.c,{form:T},r.a.createElement(ye,{path:"name",componentProps:{idAria:"detectionEngineStepAboutRuleName","data-test-subj":"detectionEngineStepAboutRuleName",euiFieldProps:{fullWidth:!0,disabled:d}}}),r.a.createElement(a.EuiSpacer,{size:"l"}),r.a.createElement(ye,{path:"description",componentProps:{idAria:"detectionEngineStepAboutRuleDescription","data-test-subj":"detectionEngineStepAboutRuleDescription",euiFieldProps:{disabled:d,compressed:!0,fullWidth:!0}}}),r.a.createElement(a.EuiSpacer,{size:"l"}),r.a.createElement(a.EuiFlexItem,null,r.a.createElement(g.e,{path:"severity",component:ie,componentProps:{dataTestSubj:"detectionEngineStepAboutRuleSeverityField",idAria:"detectionEngineStepAboutRuleSeverityField",isDisabled:d||w,options:z.i,indices:O}})),r.a.createElement(a.EuiSpacer,{size:"l"}),r.a.createElement(a.EuiFlexItem,null,r.a.createElement(ye,{path:"riskScore",component:de,componentProps:{dataTestSubj:"detectionEngineStepAboutRuleRiskScore",idAria:"detectionEngineStepAboutRuleRiskScore",isDisabled:d||w,indices:O}})),r.a.createElement(he,null,r.a.createElement(ye,{path:"tags",componentProps:{idAria:"detectionEngineStepAboutRuleTags","data-test-subj":"detectionEngineStepAboutRuleTags",euiFieldProps:{fullWidth:!0,isDisabled:d||w,placeholder:""}}})),r.a.createElement(a.EuiSpacer,{size:"l"}),r.a.createElement(a.EuiAccordion,{"data-test-subj":"advancedSettings",id:"advancedSettingsAccordion",buttonContent:U.d},r.a.createElement(a.EuiSpacer,{size:"l"}),r.a.createElement(g.e,{path:"references",component:y,componentProps:{addText:U.b,idAria:"detectionEngineStepAboutRuleReferenceUrls",isDisabled:d,dataTestSubj:"detectionEngineStepAboutRuleReferenceUrls",validate:$.c}}),r.a.createElement(g.e,{path:"falsePositives",component:y,componentProps:{addText:U.a,idAria:"detectionEngineStepAboutRuleFalsePositives",isDisabled:d,dataTestSubj:"detectionEngineStepAboutRuleFalsePositives"}}),r.a.createElement(g.e,{path:"threat",component:B,componentProps:{idAria:"detectionEngineStepAboutRuleMitreThreat",isDisabled:d,dataTestSubj:"detectionEngineStepAboutRuleMitreThreat"}}),r.a.createElement(a.EuiSpacer,{size:"l"}),r.a.createElement(g.e,{path:"note",component:Y.a,componentProps:{idAria:"detectionEngineStepAboutRuleNote",isDisabled:d,dataTestSubj:"detectionEngineStepAboutRuleNote",placeholder:U.c}}),r.a.createElement(a.EuiSpacer,{size:"l"}),r.a.createElement(ye,{path:"author",componentProps:{idAria:"detectionEngineStepAboutRuleAuthor","data-test-subj":"detectionEngineStepAboutRuleAuthor",euiFieldProps:{fullWidth:!0,isDisabled:d,placeholder:""}}}),r.a.createElement(a.EuiSpacer,{size:"l"}),r.a.createElement(ye,{path:"license",componentProps:{idAria:"detectionEngineStepAboutRuleLicense","data-test-subj":"detectionEngineStepAboutRuleLicense",euiFieldProps:{fullWidth:!0,disabled:d,placeholder:""}}}),r.a.createElement(a.EuiSpacer,{size:"l"}),r.a.createElement(a.EuiFormRow,{label:U.g,fullWidth:!0},r.a.createElement(ye,{path:"isAssociatedToEndpointList",componentProps:{idAria:"detectionEngineStepAboutRuleAssociatedToEndpointList","data-test-subj":"detectionEngineStepAboutRuleAssociatedToEndpointList",euiFieldProps:{disabled:d}}})),r.a.createElement(a.EuiFormRow,{label:U.e,fullWidth:!0},r.a.createElement(ye,{path:"isBuildingBlock",componentProps:{idAria:"detectionEngineStepAboutRuleBuildingBlock","data-test-subj":"detectionEngineStepAboutRuleBuildingBlock",euiFieldProps:{disabled:d}}})),r.a.createElement(a.EuiSpacer,{size:"l"}),v&&r.a.createElement(r.a.Fragment,null,r.a.createElement(ye,{path:"threatIndicatorPath",componentProps:{idAria:"detectionEngineStepAboutThreatIndicatorPath","data-test-subj":"detectionEngineStepAboutThreatIndicatorPath",euiFieldProps:{fullWidth:!0,disabled:d,placeholder:fe.T}}})),r.a.createElement(a.EuiSpacer,{size:"l"}),r.a.createElement(g.e,{path:"ruleNameOverride",component:me,componentProps:{dataTestSubj:"detectionEngineStepAboutRuleRuleNameOverride",fieldType:"string",idAria:"detectionEngineStepAboutRuleRuleNameOverride",indices:O,isDisabled:d||w,placeholder:""}}),r.a.createElement(a.EuiSpacer,{size:"l"}),r.a.createElement(g.e,{path:"timestampOverride",component:me,componentProps:{dataTestSubj:"detectionEngineStepAboutRuleTimestampOverride",fieldType:"date",idAria:"detectionEngineStepAboutRuleTimestampOverride",indices:O,isDisabled:d||w,placeholder:""}}),!!F&&"@timestamp"!==F&&r.a.createElement(r.a.Fragment,null,r.a.createElement(ye,{path:"timestampOverrideFallbackDisabled",componentProps:{idAria:"detectionTimestampOverrideFallbackDisabled","data-test-subj":"detectionTimestampOverrideFallbackDisabled",euiFieldProps:{disabled:d}}}))))),!u&&r.a.createElement(K.a,{dataTestSubj:"about-continue",onClick:_,isDisabled:d}))},Ee=Object(i.memo)(ve)},function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var a=n(295),i=n(819),r=n(346),o=n(162);function s(e,t,n,a){const i=Object(r.f)(e)(t);return 0===Object(o.d)(n,i)?{...e,animation:void 0,panning:void 0}:{...e,panning:void 0,translationNotCountingCurrentPanning:n,animation:{startTime:t,targetTranslation:n,initialTranslation:i,duration:a}}}var l=n(96),c=n(275),u=n(464);const d=e=>{const t=c.a-c.b;return Math.pow((e-c.b)/t,1/c.f)};var p=n(467),m=n(508),g=n(465),f=n(222);const b={currentRelatedEvent:{loading:!1,data:null},resolverComponentInstanceID:void 0,indices:[],detectedBounds:void 0};var y=n(512);const h=Object(a.combineReducers)({camera:(e=function(){return{scalingFactor:d(1),rasterSize:[0,0],translationNotCountingCurrentPanning:[0,0],latestFocusedWorldCoordinates:null,animation:void 0,panning:void 0}}(),t)=>{if("userSetZoomLevel"===t.type)return{...e,scalingFactor:Object(u.a)(t.payload,0,1)};if("userClickedZoomIn"===t.type)return{...e,scalingFactor:Object(u.a)(e.scalingFactor+.1,0,1)};if("userClickedZoomOut"===t.type)return{...e,scalingFactor:Object(u.a)(e.scalingFactor-.1,0,1)};if("userZoomed"===t.type){const n={...e,scalingFactor:Object(u.a)(e.scalingFactor+t.payload.zoomChange,0,1)};if(null===e.latestFocusedWorldCoordinates||r.b(e)(t.payload.time))return n;{const a=o.c(e.latestFocusedWorldCoordinates,r.c(e)(t.payload.time)),i=o.c(a,r.a(n)(t.payload.time)),s=o.j(i,e.latestFocusedWorldCoordinates),l=o.j(n.translationNotCountingCurrentPanning,s);return{...n,translationNotCountingCurrentPanning:l}}}if("userSetPositionOfCamera"===t.type)return{...e,animation:void 0,translationNotCountingCurrentPanning:t.payload};if("userStartedPanning"===t.type)return r.b(e)(t.payload.time)?e:{...e,animation:void 0,panning:{origin:t.payload.screenCoordinates,currentOffset:t.payload.screenCoordinates}};if("userStoppedPanning"===t.type)return{...e,translationNotCountingCurrentPanning:r.f(e)(t.payload.time),panning:void 0};if("userNudgedCamera"===t.type){const{direction:n,time:a}=t.payload,i=o.h(o.e([c.e,c.e],r.d(e)(a)),n);return s(e,a,o.a(e.translationNotCountingCurrentPanning,i),c.c)}if("userSetRasterSize"===t.type)return{...e,rasterSize:t.payload};if("userMovedPointer"===t.type){let n=e;return e.panning&&(n={...e,panning:{origin:e.panning.origin,currentOffset:t.payload.screenCoordinates}}),{...n,latestFocusedWorldCoordinates:o.c(t.payload.screenCoordinates,r.a(n)(t.payload.time))}}return e},data:(e=b,t)=>{if("appReceivedNewExternalProperties"===t.type){const n={...e,tree:{...e.tree,currentParameters:{databaseDocumentID:t.payload.databaseDocumentID,indices:t.payload.indices,filters:t.payload.filters}},resolverComponentInstanceID:t.payload.resolverComponentInstanceID,locationSearch:t.payload.locationSearch,indices:t.payload.indices},a=m.x(n);return{...n,nodeEventsInCategory:n.nodeEventsInCategory&&g.a(n.nodeEventsInCategory,a)?n.nodeEventsInCategory:void 0}}if("appRequestedResolverData"===t.type)return{...e,tree:{...e.tree,pendingRequestParameters:{databaseDocumentID:t.payload.databaseDocumentID,indices:t.payload.indices,filters:t.payload.filters}}};var n,a,i;if("appAbortedResolverDataRequest"===t.type)return p.a(t.payload,null===(n=e.tree)||void 0===n?void 0:n.pendingRequestParameters)?{...e,tree:{...e.tree,pendingRequestParameters:void 0}}:e;if("serverReturnedResolverData"===t.type)return{...e,tree:{...e.tree,lastResponse:{result:t.payload.result,dataSource:t.payload.dataSource,schema:t.payload.schema,parameters:t.payload.parameters,successful:!0},pendingRequestParameters:void 0},detectedBounds:t.payload.detectedBounds};if("serverFailedToReturnResolverData"===t.type)return void 0!==(null===(a=e.tree)||void 0===a?void 0:a.pendingRequestParameters)?{...e,tree:{...e.tree,pendingRequestParameters:void 0,lastResponse:{parameters:e.tree.pendingRequestParameters,successful:!1}}}:e;if("serverReturnedNodeEventsInCategory"===t.type){if(g.a(t.payload,m.x(e))){if(e.nodeEventsInCategory){const n=g.b(e.nodeEventsInCategory,t.payload);if(n)return{...e,nodeEventsInCategory:{...n}};throw new Error("Could not handle related event data because of an internal error.")}return{...e,nodeEventsInCategory:t.payload}}return e}if("userRequestedAdditionalRelatedEvents"===t.type)return e.nodeEventsInCategory?{...e,nodeEventsInCategory:{...e.nodeEventsInCategory,lastCursorRequested:null===(i=e.nodeEventsInCategory)||void 0===i?void 0:i.cursor}}:e;if("serverFailedToReturnNodeEventsInCategory"===t.type)return e.nodeEventsInCategory?{...e,nodeEventsInCategory:{...e.nodeEventsInCategory,error:!0}}:e;if("serverReturnedNodeData"===t.type){const n=f.e({storedNodeInfo:e.nodeData,receivedEvents:t.payload.nodeData,requestedNodes:t.payload.requestedIDs,numberOfRequestedEvents:t.payload.numberOfRequestedEvents});return{...e,nodeData:n}}if("userReloadedResolverNode"===t.type){const n=f.c(e.nodeData,t.payload);return{...e,nodeData:n}}if("appRequestingNodeData"===t.type){const n=f.d(e.nodeData,t.payload.requestedIDs);return{...e,nodeData:n}}if("serverFailedToReturnNodeData"===t.type){const n=f.b(e.nodeData,t.payload.requestedIDs);return{...e,nodeData:n}}return"appRequestedCurrentRelatedEventData"===t.type?{...e,currentRelatedEvent:{loading:!0,data:null}}:"serverReturnedCurrentRelatedEventData"===t.type?{...e,currentRelatedEvent:{loading:!1,data:{...t.payload}}}:"serverFailedToReturnCurrentRelatedEventData"===t.type?{...e,currentRelatedEvent:{loading:!1,data:null}}:e},ui:(e={ariaActiveDescendant:null,selectedNode:null},t)=>"serverReturnedResolverData"===t.type?{...e,ariaActiveDescendant:t.payload.result.originID,selectedNode:t.payload.result.originID}:"userFocusedOnResolverNode"===t.type?{...e,ariaActiveDescendant:t.payload.nodeID}:"userSelectedResolverNode"===t.type?{...e,selectedNode:t.payload.nodeID,ariaActiveDescendant:t.payload.nodeID}:"appReceivedNewExternalProperties"===t.type?{...e,locationSearch:t.payload.locationSearch,resolverComponentInstanceID:t.payload.resolverComponentInstanceID}:e}),v=(e,t)=>{const n=h(e,t);if("userSelectedResolverNode"===t.type||"userFocusedOnResolverNode"===t.type){const e=Object(y.b)(Object(l.s)(n),t.payload.nodeID);return e?{...n,camera:s(n.camera,t.payload.time,e,c.d)}:n}return n};var E=n(276),x=n(466),k=n(7);const S=e=>{const t=Object(i.composeWithDevTools)({name:"Resolver",actionsBlacklist:["userMovedPointer"]}),n=Object(a.applyMiddleware)((e=>t=>n=>{const a=function(e,t){let n;return async()=>{const a=t.getState(),i=l.M(a);if(l.N(a)&&n)n.abort();else if(null!==i){let r,o,s,c;n=new AbortController;const u=l.K(a);t.dispatch({type:"appRequestedResolverData",payload:i});try{const a=await e.entities({_id:i.databaseDocumentID,indices:i.indices,signal:n.signal});if(a.length<1)return void t.dispatch({type:"serverFailedToReturnResolverData",payload:i});({id:r,schema:s,name:o}=a[0]),c=await e.resolverTree({dataId:r,schema:s,timeRange:u,indices:i.indices,ancestors:Object(x.a)(s),descendants:Object(x.b)()});const l={originID:r,nodes:c};if(0===l.nodes.length){const n=await e.resolverTree({dataId:r,schema:s,indices:i.indices,ancestors:Object(x.a)(s),descendants:Object(x.b)()});if(n.length>0){const e=n.map((e=>Object(E.a)(e.data["@timestamp"]))).sort(),a=e[0],r=e.slice(-1);t.dispatch({type:"serverReturnedResolverData",payload:{result:{...l,nodes:n},dataSource:o,schema:s,parameters:i,detectedBounds:{from:String(a),to:String(r)}}})}else t.dispatch({type:"serverReturnedResolverData",payload:{result:l,dataSource:o,schema:s,parameters:i}})}else t.dispatch({type:"serverReturnedResolverData",payload:{result:l,dataSource:o,schema:s,parameters:i}})}catch(e){e instanceof DOMException&&"AbortError"===e.name?t.dispatch({type:"appAbortedResolverDataRequest",payload:i}):t.dispatch({type:"serverFailedToReturnResolverData",payload:i})}}}}(e,t),i=function(e,t){let n;return async()=>{const a=t.getState(),i=l.z(a),r=l.o(a),o=l.f(a),s=n,c=void 0!==l.e(a)?void 0:l.K(a);async function u({nodeID:n,eventCategory:a,cursor:i}){let r=null;try{r=i?await e.eventsWithEntityIDAndCategory({entityID:n,category:a,after:i,indexPatterns:o,timeRange:c}):await e.eventsWithEntityIDAndCategory({entityID:n,category:a,indexPatterns:o,timeRange:c})}catch(e){t.dispatch({type:"serverFailedToReturnNodeEventsInCategory",payload:{nodeID:n,eventCategory:a,cursor:i}})}r&&t.dispatch({type:"serverReturnedNodeEventsInCategory",payload:{events:r.events,eventCategory:a,cursor:r.nextEvent,nodeID:n}})}if(n=i,Object(k.isEqual)(i,s)){if(r){const e=a.data.nodeEventsInCategory;void 0!==e&&await u(e)}}else if("nodeEventsInCategory"===i.panelView){const e=i.panelParameters.nodeID;t.dispatch({type:"appRequestedNodeEventsInCategory",payload:{parameters:i}}),await u({nodeID:e,eventCategory:i.panelParameters.eventCategory,cursor:null})}}}(e,t),r=function(e,t){let n;return async()=>{const a=t.getState(),i=l.z(a),r=l.f(a),o=n;if(n=i,!Object(k.isEqual)(i,o)&&"eventDetail"===i.panelView){const n=i.panelParameters.eventID,o=i.panelParameters.nodeID,s=i.panelParameters.eventCategory,c=i.panelParameters.eventTimestamp,u=i.panelParameters.winlogRecordID;t.dispatch({type:"appRequestedCurrentRelatedEventData"});const d=void 0!==l.e(a)?void 0:l.K(a);let p=null;try{p=await e.event({nodeID:o,eventCategory:[s],eventTimestamp:c,eventID:n,winlogRecordID:u,indexPatterns:r,timeRange:d})}catch(e){t.dispatch({type:"serverFailedToReturnCurrentRelatedEventData"})}p?t.dispatch({type:"serverReturnedCurrentRelatedEventData",payload:p}):t.dispatch({type:"serverFailedToReturnCurrentRelatedEventData"})}}}(e,t),o=function(e,t){return async()=>{const n=t.getState(),a=l.t(n)(Number.POSITIVE_INFINITY),i=l.f(n);if(a.size<=0)return;let r;t.dispatch({type:"appRequestingNodeData",payload:{requestedIDs:a}});try{const t=void 0!==l.e(n)?void 0:l.K(n);r=await e.nodeData({ids:Array.from(a),timeRange:t,indexPatterns:i,limit:5e3})}catch(e){t.dispatch({type:"serverFailedToReturnNodeData",payload:{requestedIDs:a}})}r&&t.dispatch({type:"serverReturnedNodeData",payload:{nodeData:r,requestedIDs:a,numberOfRequestedEvents:5e3}})}}(e,t);return async e=>{n(e),a(),i(),o(),r()}})(e));return Object(a.createStore)(v,t(n))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return _}));var a=n(4),i=n.n(a),r=n(32),o=n(51),s=n(1),l=n(411),c=n(176),u=n(109),d=n(234),p=n(119),m=n(211),g=n(124),f=n(327),b=n(89),y=n(869);const h=i.a.memo((({allItems:e,selectedItems:t,title:n,onSelectedItemsChange:o})=>{const[s,l]=Object(a.useState)(!1),c=Object(a.useCallback)((e=>o(v(e,t))),[t,o]),u=Object(a.useMemo)((()=>e.map(((e,n)=>i.a.createElement(r.EuiFilterSelectItem,{checked:t.includes(e)?"on":void 0,key:`${n}-${e}`,onClick:()=>c(e),title:e},e)))),[e,t,c]),d=Object(a.useCallback)((e=>{l((t=>e||!t))}),[l]);return i.a.createElement(r.EuiPopover,{ownFocus:!0,button:i.a.createElement(r.EuiFilterGroup,null,i.a.createElement(r.EuiFilterButton,{grow:!1,"data-test-subj":"multiselect-popover-button",iconType:"arrowDown",onClick:()=>d(),numFilters:e.length,isSelected:s,hasActiveFilters:t.length>0,numActiveFilters:t.length},n)),isOpen:s,closePopover:()=>d(!1),panelPaddingSize:"none"},u)}));h.displayName="MultiSelectPopover";const v=(e,t)=>{const n=t.indexOf(e),a=[...t];return n>=0?a.splice(n,1):a.push(e),a};var E=n(0);const x=E.i18n.translate("xpack.securitySolution.alertCountByRuleByStatus.status",{defaultMessage:"Status"}),k=E.i18n.translate("xpack.securitySolution.alertCountByRuleByStatus.alertsByRule",{defaultMessage:"Alerts by Rule"}),S=E.i18n.translate("xpack.securitySolution.alertCountByRuleByStatus.ruleName",{defaultMessage:"kibana.alert.rule.name"}),w=E.i18n.translate("xpack.securitySolution.alertCountByRuleByStatus.count",{defaultMessage:"count"}),j=E.i18n.translate("xpack.securitySolution.alertCountByRuleByStatus.tooltipTitle",{defaultMessage:"Rule name"}),O=E.i18n.translate("xpack.securitySolution.alertCountByRuleByStatus.noRuleAlerts",{defaultMessage:"No alerts to display"});var I=n(185),T=n(186),C=n(114),M=n(127);const N="alertsByRuleAggregation",D=({additionalFilters:e=[],from:t,to:n,field:a,value:i,statuses:r})=>({size:0,query:{bool:{filter:[...e,{range:{"@timestamp":{gte:t,lte:n}}},{terms:{"kibana.alert.workflow_status":r}},{term:{[a]:i}}]}},aggs:{[N]:{terms:{field:"kibana.alert.rule.name",size:100},aggs:{ruleUuid:{top_hits:{_source:["kibana.alert.rule.uuid"],size:1}}}}}}),F=["open","acknowledged","closed"],A=Object(o.euiStyled)(r.EuiPanel)`
  display: flex;
  flex-direction: column;
  position: relative;
  overflow: hidden;
  max-height: 308px;
`,_=i.a.memo((({entityFilter:e,signalIndexName:t,additionalFilters:n})=>{const{field:o,value:s}=e,d=`alerts-by-status-by-rule-by-${o}`,{toggleStatus:b,setToggleStatus:v}=Object(u.a)(d),{openTimelineWithFilters:E}=Object(l.a)(),[S,w]=Object(y.a)({defaultValue:{[o]:["open"]},key:"alertCountByFieldNameWidgetSettings",isInvalidDefault:e=>!e}),j=Object(a.useMemo)((()=>R((t=>{const n=[];for(const a of S[o])n.push([e,{field:c.l,value:t},{field:c.m,value:a}]);E(n)}))),[e,o,E,S]),_=Object(a.useCallback)((e=>{w({...S,[o]:e})}),[o,S,w]),{items:P,isLoading:L,updatedAt:q}=(({additionalFilters:e,field:t,value:n,queryId:i,statuses:r,skip:o=!1,signalIndexName:s})=>{const[l,c]=Object(a.useState)(Date.now()),[u,d]=Object(a.useState)([]),{to:p,from:m,deleteQuery:g,setQuery:f}=Object(C.a)(),{loading:b,data:y,setQuery:h,response:v,request:E,refetch:x}=Object(T.a)({query:D({additionalFilters:e,from:m,to:p,field:t,value:n,statuses:r}),skip:o,queryName:I.a.ALERTS_COUNT_BY_STATUS,indexName:s});Object(a.useEffect)((()=>{h(D({additionalFilters:e,from:m,to:p,field:t,value:n,statuses:r}))}),[h,m,p,t,n,r,e]),Object(a.useEffect)((()=>{var e,t;d(y?(e=y.aggregations,(null!==(t=null==e?void 0:e[N].buckets)&&void 0!==t?t:[]).map((e=>{var t,n;const a=(null===(t=e.ruleUuid.hits)||void 0===t||null===(n=t.hits[0])||void 0===n?void 0:n._source["kibana.alert.rule.uuid"])||"";return{ruleName:e.key,count:e.doc_count,uuid:a}}))):[]),c(Date.now())}),[y]);const k=Object(a.useCallback)((()=>{!o&&x&&x()}),[o,x]);return Object(M.b)({deleteQuery:g,inspect:{dsl:[E],response:[v]},refetch:k,setQuery:f,queryId:i,loading:b}),{items:u,isLoading:b,updatedAt:l}})({additionalFilters:n,field:o,value:s,queryId:d,statuses:S[o],skip:!b,signalIndexName:t});return i.a.createElement(m.a,{show:!0,targetClassNames:[g.a]},i.a.createElement(A,{hasBorder:!0,"data-test-subj":"alertCountByRulePanel"},i.a.createElement(i.a.Fragment,null,i.a.createElement(p.a,{id:d,title:k,titleSize:"m",toggleStatus:b,toggleQuery:v,subtitle:i.a.createElement(f.a,{updatedAt:q,isUpdating:L})},i.a.createElement(h,{title:x,allItems:F,selectedItems:S[o]||["open"],onSelectedItemsChange:e=>_(e)})),b&&i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiBasicTable,{className:"eui-yScroll","data-test-subj":"alertCountByRuleTable",columns:j,items:P,loading:L,noItemsMessage:i.a.createElement(r.EuiEmptyPrompt,{title:i.a.createElement("h3",null,O),titleSize:"xs"})})))))}));_.displayName="AlertCountByStatus";const R=e=>[{field:"ruleName",name:S,"data-test-subj":S,align:"left",width:"67%",sortable:!1,render:(e,{uuid:t})=>i.a.createElement(r.EuiToolTip,{"data-test-subj":`${e}-tooltip`,title:j,content:e,anchorClassName:"eui-textTruncate"},i.a.createElement(b.k,{"data-test-subj":"severityRuleAlertsTable-name",deepLinkId:s.uc.rules,path:`id/${t}`},e))},{field:"count",name:w,width:"33%","data-test-subj":w,sortable:!0,align:"right",render:(t,{ruleName:n})=>i.a.createElement(r.EuiLink,{disabled:0===t,onClick:()=>e(n)},i.a.createElement(d.a,{count:t}))}]},,function(e,t,n){"use strict";n.d(t,"b",(function(){return w})),n.d(t,"c",(function(){return j})),n.d(t,"a",(function(){return Ne}));var a=n(34),i=n(4),r=n.n(i),o=n(79),s=n(223),l=n(32),c=n(88),u=n(277),d=n(199),p=n(97),m=n(224),g=n(477),f=n(644);const b=e=>null==e||"unset"===e.toLowerCase(),y=r.a.memo((({contextId:e,eventId:t,primary:n,secondary:a,isDraggable:i})=>b(n)&&b(a)?null:!b(n)&&b(a)?r.a.createElement(c.c,{contextId:e,eventId:t,field:"auditd.summary.actor.primary",isDraggable:i,value:n,iconType:"user",isAggregatable:!0,fieldType:"keyword"}):b(n)&&!b(a)||n===a?r.a.createElement(c.c,{contextId:e,eventId:t,field:"auditd.summary.actor.secondary",isDraggable:i,value:a,iconType:"user",isAggregatable:!0,fieldType:"keyword"}):r.a.createElement(l.EuiFlexGroup,{gutterSize:"none"},r.a.createElement(p.c,{grow:!1,component:"span"},r.a.createElement(c.c,{contextId:e,eventId:t,field:"auditd.summary.actor.primary",isDraggable:i,value:n,iconType:"user",isAggregatable:!0,fieldType:"keyword"})),r.a.createElement(p.c,{grow:!1,component:"span"},u.i),r.a.createElement(p.c,{grow:!1,component:"span"},r.a.createElement(c.c,{contextId:e,eventId:t,field:"auditd.summary.actor.secondary",isDraggable:i,value:a,iconType:"user",isAggregatable:!0,fieldType:"keyword"})))));y.displayName="PrimarySecondary";const h=r.a.memo((({contextId:e,eventId:t,userName:n,primary:a,secondary:i,isDraggable:o})=>b(n)&&b(a)&&b(i)?null:b(n)||b(a)||b(i)||n!==a||n!==i?!b(n)&&b(a)&&b(i)?r.a.createElement(c.c,{contextId:e,eventId:t,field:"user.name",isDraggable:o,value:n,iconType:"user",isAggregatable:!0,fieldType:"keyword"}):r.a.createElement(y,{contextId:e,eventId:t,isDraggable:o,primary:a,secondary:i}):r.a.createElement(c.c,{contextId:e,eventId:t,field:"user.name",isDraggable:o,value:n,iconType:"user",isAggregatable:!0,fieldType:"keyword"})));h.displayName="PrimarySecondaryUserInfo";const v=r.a.memo((({eventId:e,contextId:t,hostName:n,userName:a,primary:i,secondary:o,workingDirectory:s,session:l,isDraggable:d})=>r.a.createElement(r.a.Fragment,null,r.a.createElement(p.c,{grow:!1,component:"span"},u.Vb),r.a.createElement(p.c,{grow:!1,component:"span"},r.a.createElement(c.c,{contextId:t,eventId:e,field:"auditd.session",value:l,iconType:"number",isDraggable:d,isAggregatable:!0,fieldType:"keyword"})),r.a.createElement(p.c,{grow:!1,component:"span"},r.a.createElement(h,{contextId:t,eventId:e,userName:a,primary:i,secondary:o,isDraggable:d})),null!=n&&r.a.createElement(p.c,{grow:!1,component:"span"},"@"),r.a.createElement(f.a,{contextId:t,eventId:e,workingDirectory:s,hostName:n,isDraggable:d}))));v.displayName="SessionUserHostWorkingDir";const E=r.a.memo((({id:e,contextId:t,hostName:n,userName:a,primary:i,processName:o,processPid:s,processExecutable:d,processTitle:f,secondary:b,workingDirectory:y,args:h,result:E,session:x,text:k,isDraggable:S})=>r.a.createElement(l.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none",wrap:!0},r.a.createElement(v,{eventId:e,contextId:t,hostName:n,userName:a,primary:i,secondary:b,workingDirectory:y,session:x,isDraggable:S}),null!=d&&r.a.createElement(p.c,{grow:!1,component:"span"},k),r.a.createElement(p.c,{grow:!1,component:"span"},r.a.createElement(m.a,{contextId:t,endgamePid:void 0,endgameProcessName:void 0,eventId:e,processPid:s,processName:o,processExecutable:d,isDraggable:S})),r.a.createElement(g.a,{eventId:e,args:h,contextId:t,isDraggable:S,processTitle:f}),null!=E&&r.a.createElement(p.c,{grow:!1,component:"span"},u.pc),r.a.createElement(p.c,{grow:!1,component:"span"},r.a.createElement(c.c,{contextId:t,eventId:e,field:"auditd.result",isDraggable:S,queryValue:E,value:E,isAggregatable:!0,fieldType:"keyword"})))));E.displayName="AuditdGenericLine";const x=r.a.memo((({data:e,contextId:t,isDraggable:n,text:i,timelineId:o})=>{const s=e._id,c=Object(a.get)("auditd.session[0]",e),u=Object(a.get)("host.name[0]",e),m=Object(a.get)("user.name[0]",e),g=Object(a.get)("auditd.result[0]",e),f=Object(a.get)("process.pid[0]",e),b=Object(a.get)("process.name[0]",e),y=Object(a.get)("process.executable[0]",e),h=Object(a.get)("process.title[0]",e),v=Object(a.get)("process.working_directory[0]",e),x=Object(a.get)("auditd.summary.actor.primary[0]",e),k=Object(a.get)("auditd.summary.actor.secondary[0]",e),S=Object(a.get)("process.args",e);return null!=e.process?r.a.createElement(p.b,null,r.a.createElement(E,{id:s,contextId:t,text:i,hostName:u,userName:m,processName:b,processPid:f,processExecutable:y,processTitle:h,workingDirectory:v,args:S,session:c,primary:x,result:g,secondary:k,isDraggable:n}),r.a.createElement(l.EuiSpacer,{size:"s"}),r.a.createElement(d.a,{data:e,isDraggable:n,timelineId:o})):null}));x.displayName="AuditdGenericDetails";const k=r.a.memo((({id:e,contextId:t,hostName:n,userName:a,result:i,primary:o,secondary:s,filePath:d,processName:f,processPid:b,processExecutable:y,processTitle:h,workingDirectory:E,args:x,session:k,text:S,fileIcon:w,isDraggable:j})=>r.a.createElement(l.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none",wrap:!0},r.a.createElement(v,{eventId:e,contextId:t,hostName:n,userName:a,primary:o,secondary:s,workingDirectory:E,session:k,isDraggable:j}),(null!=d||null!=y)&&r.a.createElement(p.c,{grow:!1,component:"span"},S),r.a.createElement(p.c,{grow:!1,component:"span"},r.a.createElement(c.c,{contextId:t,eventId:e,field:"file.path",isDraggable:j,value:d,iconType:w})),null!=y&&r.a.createElement(p.c,{grow:!1,component:"span"},u.kc),r.a.createElement(p.c,{grow:!1,component:"span"},r.a.createElement(m.a,{contextId:t,endgamePid:void 0,endgameProcessName:void 0,eventId:e,isDraggable:j,processPid:b,processName:f,processExecutable:y})),r.a.createElement(g.a,{eventId:e,args:x,contextId:t,isDraggable:j,processTitle:h}),null!=i&&r.a.createElement(p.c,{grow:!1,component:"span"},u.pc),r.a.createElement(p.c,{grow:!1,component:"span"},r.a.createElement(c.c,{contextId:t,eventId:e,field:"auditd.result",isDraggable:j,queryValue:i,value:i})))));k.displayName="AuditdGenericFileLine";const S=r.a.memo((({data:e,contextId:t,text:n,fileIcon:i="document",timelineId:o,isDraggable:s})=>{const c=e._id,u=Object(a.get)("auditd.session[0]",e),m=Object(a.get)("host.name[0]",e),g=Object(a.get)("user.name[0]",e),f=Object(a.get)("auditd.result[0]",e),b=Object(a.get)("process.pid[0]",e),y=Object(a.get)("process.name[0]",e),h=Object(a.get)("process.executable[0]",e),v=Object(a.get)("process.title[0]",e),E=Object(a.get)("process.working_directory[0]",e),x=Object(a.get)("file.path[0]",e),S=Object(a.get)("auditd.summary.actor.primary[0]",e),w=Object(a.get)("auditd.summary.actor.secondary[0]",e),j=Object(a.get)("process.args",e);return null!=e.process?r.a.createElement(p.b,null,r.a.createElement(k,{id:c,contextId:t,text:n,hostName:m,userName:g,filePath:x,processName:y,processPid:b,processExecutable:h,processTitle:v,workingDirectory:E,args:j,session:u,primary:S,secondary:w,fileIcon:i,result:f,isDraggable:s}),r.a.createElement(l.EuiSpacer,{size:"s"}),r.a.createElement(d.a,{data:e,isDraggable:s,timelineId:o})):null}));S.displayName="AuditdGenericFileDetails";const w=({actionName:e,text:t})=>({id:o.d.auditd,isInstance:t=>{const n=Object(a.get)("event.module[0]",t),i=Object(a.get)("event.action[0]",t);return null!=n&&"auditd"===n.toLowerCase()&&null!=i&&i.toLowerCase()===e},renderRow:({data:n,isDraggable:a,scopeId:i})=>r.a.createElement(s.a,null,r.a.createElement(x,{data:n,isDraggable:a,contextId:`${e}-${i}`,text:t,timelineId:i}))}),j=({actionName:e,text:t,fileIcon:n="document"})=>({id:o.d.auditd_file,isInstance:t=>{const n=Object(a.get)("event.module[0]",t),i=Object(a.get)("event.action[0]",t);return null!=n&&"auditd"===n.toLowerCase()&&null!=i&&i.toLowerCase()===e},renderRow:({data:a,isDraggable:i,scopeId:o})=>r.a.createElement(s.a,null,r.a.createElement(S,{contextId:`${e}-${o}`,data:a,fileIcon:n,isDraggable:i,text:t,timelineId:o}))}),O=w({actionName:"was-authorized",text:u.oc}),I=w({actionName:"started-session",text:u.Yb}),T=w({actionName:"logged-in",text:u.m}),C=w({actionName:"login",text:u.m}),M=w({actionName:"executed",text:u.gb}),N=w({actionName:"ended-session",text:u.eb}),D=w({actionName:"acquired-credentials",text:u.e}),F=w({actionName:"disposed-credentials",text:u.db}),A=w({actionName:"connected-to",text:u.T}),_=j({actionName:"opened-file",text:u.Db}),R=w({actionName:"changed-file-attributes-of",text:u.y}),P=j({actionName:"changed-file-permissions-of",text:u.A}),L=j({actionName:"changed-file-ownership-of",text:u.z}),q=w({actionName:"loaded-kernel-module",text:u.ob}),B=w({actionName:"unloaded-kernel-module",text:u.gc}),z=j({actionName:"created-directory",text:u.V,fileIcon:"folderOpen"}),$=j({actionName:"mounted",text:u.Bb}),V=j({actionName:"renamed",text:u.Ob}),U=j({actionName:"checked-metadata-of",text:u.S}),H=j({actionName:"checked-filesystem-metadata-of",text:u.Q}),G=j({actionName:"symlinked",text:u.dc}),Q=j({actionName:"unmounted",text:u.ic}),W=j({actionName:"deleted",text:u.Z}),K=j({actionName:"changed-timestamp-of",text:u.N}),Y=w({actionName:"listen-for-connections",text:u.mb}),J=w({actionName:"bound-socket",text:u.t}),X=w({actionName:"received-from",text:u.Hb}),Z=w({actionName:"sent-to",text:u.Ub}),ee=w({actionName:"killed-pid",text:u.lb}),te=w({actionName:"changed-identity-of",text:u.D}),ne=w({actionName:"changed-system-time",text:u.M}),ae=w({actionName:"make-device",text:u.ub}),ie=w({actionName:"changed-system-name",text:u.L}),re=w({actionName:"allocated-memory",text:u.h}),oe=w({actionName:"adjusted-scheduling-policy-of",text:u.Rb}),se=w({actionName:"added-user-account",text:u.g}),le=w({actionName:"caused-mac-policy-error",text:u.u}),ce=w({actionName:"loaded-firewall-rule-to",text:u.nb}),ue=w({actionName:"changed-promiscuous-mode-on-device",text:u.H}),de=w({actionName:"locked-account",text:u.rb}),pe=w({actionName:"unlocked-account",text:u.hc}),me=w({actionName:"added-group-account-to",text:u.f}),ge=w({actionName:"crashed-program",text:u.U}),fe=w({actionName:"attempted-execution-of-forbidden-program",text:u.hb}),be=w({actionName:"used-suspcious-link",text:u.jc}),ye=w({actionName:"used-suspicious-link",text:u.jc}),he=w({actionName:"failed-log-in-too-many-times-to",text:u.ib}),ve=w({actionName:"failed-login-too-many-times-to",text:u.ib}),Ee=w({actionName:"attempted-log-in-from-unusual-place-to",text:u.o}),xe=w({actionName:"attempted-login-from-unusual-place-to",text:u.o}),ke=w({actionName:"opened-too-many-sessions-to",text:u.Eb}),Se=w({actionName:"attempted-log-in-during-unusual-hour-to",text:u.n}),we=w({actionName:"attempted-login-during-unusual-hour-to",text:u.n}),je=w({actionName:"tested-file-system-integrity-of",text:u.ec}),Oe=w({actionName:"violated-selinux-policy",text:u.nc}),Ie=w({actionName:"violated-apparmor-policy",text:u.lc}),Te=w({actionName:"changed-group",text:u.B}),Ce=w({actionName:"changed-user-id",text:u.P}),Me=w({actionName:"changed-auditd-configuration",text:u.v}),Ne=[M,T,C,O,D,N,F,I,A,_,R,P,L,q,B,z,$,V,U,H,G,Q,W,K,Y,J,X,Z,ee,te,ne,ae,ie,re,oe,se,me,fe,le,ue,ge,ce,de,be,ye,pe,he,ve,xe,ke,Ee,Se,we,je,Oe,Ie,Te,Ce,w({actionName:"changed-audit-configuration",text:u.v}),w({actionName:"refreshed-credentials",text:u.Jb}),w({actionName:"negotiated-crypto-key",text:u.Cb}),w({actionName:"crypto-officer-logged-in",text:u.X}),w({actionName:"crypto-officer-login",text:u.X}),w({actionName:"crypto-officer-logged-out",text:u.Y}),w({actionName:"crypto-officer-logout",text:u.Y}),w({actionName:"started-crypto-session",text:u.ac}),w({actionName:"access-result",text:u.d}),w({actionName:"aborted-auditd-startup",text:u.a}),w({actionName:"aborted-audit-startup",text:u.a}),w({actionName:"remote-audit-connected",text:u.Lb}),w({actionName:"remote-audit-disconnected",text:u.Mb}),w({actionName:"shutdown-audit",text:u.Wb}),w({actionName:"audit-error",text:u.p}),w({actionName:"reconfigured-auditd",text:u.Ib}),w({actionName:"reconfigured-audit",text:u.Ib}),w({actionName:"resumed-audit-logging",text:u.Pb}),w({actionName:"rotated-audit-logs",text:u.Qb}),w({actionName:"started-audit",text:u.Zb}),w({actionName:"deleted-group-account-from",text:u.ab}),w({actionName:"deleted-user-account",text:u.bb}),w({actionName:"changed-audit-feature",text:u.w}),w({actionName:"relabeled-filesystem",text:u.Kb}),w({actionName:"authenticated-to-group",text:u.q}),w({actionName:"changed-group-password",text:u.C}),w({actionName:"modified-group-account",text:u.xb}),w({actionName:"initialized-audit-subsystem",text:u.jb}),w({actionName:"modified-level-of",text:u.yb}),w({actionName:"overrode-label-of",text:u.Fb}),w({actionName:"changed-login-id-to",text:u.E}),w({actionName:"mac-permission",text:u.tb}),w({actionName:"changed-selinux-boolean",text:u.J}),w({actionName:"loaded-selinux-policy",text:u.qb}),w({actionName:"changed-selinux-enforcement",text:u.K}),w({actionName:"assigned-user-role-to",text:u.j}),w({actionName:"modified-role",text:u.zb}),w({actionName:"removed-use-role-from",text:u.Nb}),w({actionName:"removed-user-role-from",text:u.Nb}),Me,w({actionName:"violated-seccomp-policy",text:u.mc}),w({actionName:"started-service",text:u.bc}),w({actionName:"stopped-service",text:u.cc}),w({actionName:"booted-system",text:u.s}),w({actionName:"changed-to-runlevel",text:u.O}),w({actionName:"shutdown-system",text:u.Xb}),w({actionName:"sent-test",text:u.Tb}),w({actionName:"unknown",text:u.fc}),w({actionName:"sent-message",text:u.Sb}),w({actionName:"access-permission",text:u.c}),w({actionName:"authenticated",text:u.r}),w({actionName:"changed-password",text:u.G}),w({actionName:"ran-command",text:u.Gb}),w({actionName:"error",text:u.fb}),w({actionName:"logged-out",text:u.sb}),w({actionName:"logout",text:u.sb}),w({actionName:"changed-mac-configuration",text:u.F}),w({actionName:"loaded-mac-policy",text:u.pb}),w({actionName:"modified-user-account",text:u.Ab}),w({actionName:"changed-role-to",text:u.I}),w({actionName:"access-error",text:u.b}),w({actionName:"changed-configuration",text:u.x}),w({actionName:"issued-vm-control",text:u.kb}),w({actionName:"created-vm-image",text:u.W}),w({actionName:"deleted-vm-image",text:u.cb}),w({actionName:"checked-integrity-of",text:u.R}),w({actionName:"assigned-vm-id",text:u.k}),w({actionName:"migrated-vm-from",text:u.vb}),w({actionName:"migrated-vm-to",text:u.wb}),w({actionName:"assigned-vm-resource",text:u.l})]},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(4),i=n.n(a),r=n(32),o=n(0),s=n(35),l=n(107);const c=o.i18n.translate("xpack.securitySolution.management.policiesSelector.globalEntries",{defaultMessage:"Global entries"}),u=o.i18n.translate("xpack.securitySolution.management.policiesSelector.unassignedEntries",{defaultMessage:"Unassigned entries"}),d=Object(a.memo)((({policies:e,onChangeSelection:t,defaultExcludedPolicies:n,defaultIncludedPolicies:o})=>{const[d,p]=Object(a.useState)(!1),[m,g]=Object(a.useState)(""),[f,b]=Object(a.useState)([]),y=Object(l.a)("excludePoliciesInFilterEnabled");Object(a.useEffect)((()=>{const t=o?o.split(",").reduce(((e,t)=>({...e,[t]:!0})),{}):{},a=n?n.split(",").reduce(((e,t)=>({...e,[t]:!0})),{}):{},i=e=>t[e]?"on":a[e]?"off":void 0;b([...e.map((e=>({name:e.name,id:e.id,checked:i(e.id)}))),{name:c,id:"global",checked:i("global")},{name:u,id:"unassigned",checked:i("unassigned")}])}),[e]);const h=Object(a.useCallback)((()=>{p((e=>!e))}),[]),v=Object(a.useCallback)((()=>{p(!1)}),[]),E=Object(a.useCallback)((e=>{const t=e.target.value||"";g(t)}),[]),x=Object(a.useCallback)((e=>{if(!f[e])return;const n=[...f];switch(n[e].checked){case"on":n[e].checked=y?"off":void 0;break;case"off":n[e].checked=void 0;break;default:n[e].checked="on"}b(n),t(n)}),[f,t,y]),k=Object(a.useMemo)((()=>f.map(((e,t)=>e.name.toLowerCase().includes(m.toLowerCase())?i.a.createElement(r.EuiFilterSelectItem,{checked:e.checked,key:t,onClick:()=>x(t),"data-test-subj":`policiesSelector-popover-items-${e.id}`},e.name):null))),[f,m,x]),S=Object(a.useMemo)((()=>i.a.createElement(r.EuiFilterButton,{iconType:"arrowDown","data-test-subj":"policiesSelectorButton",onClick:h,isSelected:d,numFilters:f.length,hasActiveFilters:!!f.find((e=>"on"===e.checked)),numActiveFilters:f.filter((e=>"on"===e.checked)).length},i.a.createElement(r.EuiText,null,i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.management.policiesSelector.label",defaultMessage:"Policies"})))),[d,f,h]);return i.a.createElement(r.EuiFlexGroup,{"data-test-subj":"policiesSelector",direction:"row",alignItems:"center",gutterSize:"l"},i.a.createElement(r.EuiFlexItem,null,i.a.createElement(r.EuiFilterGroup,null,i.a.createElement(r.EuiPopover,{button:S,isOpen:d,closePopover:v,panelPaddingSize:"none"},i.a.createElement(r.EuiPopoverTitle,{paddingSize:"s"},i.a.createElement(r.EuiFieldSearch,{"data-test-subj":"policiesSelectorSearch",compressed:!0,onChange:E,value:m})),i.a.createElement("div",{"data-test-subj":"policiesSelector-popover",className:"euiFilterSelect__items"},k)))))}));d.displayName="PoliciesSelector";var p=n(116);const m=Object(a.memo)((({defaultValue:e="",onSearch:t,placeholder:n,hasPolicyFilter:s,policyList:l,defaultIncludedPolicies:c,hideRefreshButton:u=!1})=>{const{canCreateArtifactsByPolicy:m}=Object(p.a)().endpointPrivileges,[g,f]=Object(a.useState)(e),[b,y]=Object(a.useState)(c||""),h=Object(a.useCallback)((e=>{const n=e.filter((e=>"on"===e.checked)).map((e=>e.id)).join(",");y(n),t(g,n,!1)}),[t,g]),v=Object(a.useCallback)((e=>f(e.target.value)),[f]),E=Object(a.useCallback)((()=>t(g,b,!0)),[t,g,b]),x=Object(a.useCallback)((e=>{t(e,b,!1)}),[t,b]);return i.a.createElement(r.EuiFlexGroup,{"data-test-subj":"searchExceptions",direction:"row",alignItems:"center",gutterSize:"m"},i.a.createElement(r.EuiFlexItem,null,i.a.createElement(r.EuiFieldSearch,{defaultValue:e,placeholder:n,onChange:v,onSearch:x,isClearable:!0,fullWidth:!0,"data-test-subj":"searchField"})),m&&s&&l?i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(d,{policies:l,defaultIncludedPolicies:c,onChangeSelection:h})):null,u?null:i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButton,{iconType:"refresh",onClick:E,"data-test-subj":"searchButton"},o.i18n.translate("xpack.securitySolution.management.search.button",{defaultMessage:"Refresh"}))))}));m.displayName="SearchExceptions"},,function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var a=n(33),i=n.n(a),r=n(4),o=n.n(r),s=n(167),l=n(377),c=n(592),u=n(100),d=n(371),p=n(493),m=n(0);const g={interval:{label:m.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldIntervalLabel",{defaultMessage:"Runs every"}),helpText:m.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldIntervalHelpText",{defaultMessage:"Rules run periodically and detect alerts within the specified time frame."})},from:{label:m.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldAdditionalLookBackLabel",{defaultMessage:"Additional look-back time"}),helpText:m.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldAdditionalLookBackHelpText",{defaultMessage:"Adds time to the look-back period to prevent missed alerts."})}},f=i()(u.c).withConfig({displayName:"StyledForm",componentId:"sc-9ljx3m-0"})(["max-width:235px !important;"]),b=({addPadding:e=!1,defaultValues:t,descriptionColumns:n="singleSplit",isReadOnlyView:a,isLoading:i,isUpdateView:m=!1,onSubmit:b,setForm:y,onRuleDataChange:h})=>{const{form:v}=Object(u.k)({defaultValue:t,options:{stripEmptyFields:!1},schema:g}),{getFormData:E,submit:x}=v;Object(u.m)({form:v,watch:["from","interval"],onChange:e=>{h&&h(e)}});const k=Object(r.useCallback)((()=>{b&&b()}),[b]),S=Object(r.useCallback)((async()=>{const e=await x();return null!=e&&e.isValid?e:{isValid:!1,data:E()}}),[E,x]);return Object(r.useEffect)((()=>{let e=!1;return y&&!e&&y(s.b.scheduleRule,S),()=>{e=!0}}),[S,y]),a?o.a.createElement(d.a,{addPadding:e},o.a.createElement(l.a,{columns:n,schema:g,data:t})):o.a.createElement(o.a.Fragment,null,o.a.createElement(d.a,{addPadding:!m},o.a.createElement(f,{form:v,"data-test-subj":"stepScheduleRule"},o.a.createElement(u.e,{path:"interval",component:c.a,componentProps:{idAria:"detectionEngineStepScheduleRuleInterval",isDisabled:i,dataTestSubj:"detectionEngineStepScheduleRuleInterval",minimumValue:1}}),o.a.createElement(u.e,{path:"from",component:c.a,componentProps:{idAria:"detectionEngineStepScheduleRuleFrom",isDisabled:i,dataTestSubj:"detectionEngineStepScheduleRuleFrom",minimumValue:1}}))),!m&&o.a.createElement(p.a,{dataTestSubj:"schedule-continue",onClick:k,isDisabled:i}))},y=Object(r.memo)(b)},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(4),i=n.n(a),r=n(32),o=n(540),s=n(165),l=n(0),c=n(35),u=n(544);const d={type:"primary",id:"need-admin-for-update-rules",title:l.i18n.translate("xpack.securitySolution.detectionEngine.needAdminForUpdateCallOutBody.messageTitle",{defaultMessage:"Administration permissions required for alert migration"}),description:i.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.needAdminForUpdateCallOutBody.messageBody.messageDetail",defaultMessage:"{essence} Related documentation: {docs}",values:{essence:i.a.createElement("p",null,i.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.needAdminForUpdateCallOutBody.messageBody.essenceDescription",defaultMessage:"You are currently missing the required permissions to auto migrate your alert data. Please have your administrator visit this page one time to auto migrate your alert data."})),docs:i.a.createElement("ul",null,i.a.createElement("li",null,i.a.createElement(u.a,null)),i.a.createElement("li",null,i.a.createElement(u.c,null)))}})},p=()=>{const[{signalIndexMappingOutdated:e,hasIndexManage:t}]=Object(s.b)();return null!=e&&e&&null!=t&&!t?i.a.createElement(i.a.Fragment,null,i.a.createElement(o.b,{condition:!0,message:d}),i.a.createElement(r.EuiSpacer,{size:"l"})):null},m=Object(a.memo)(p)},function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n(4),i=n(131),r=n(238),o=n(39),s=n(1),l=n(138);const c=["POST",s.nb];var u=n(496),d=n(682);function p(){const{mutateAsync:e}=Object(o.useMutation)((e=>Object(l.b)(e)),{mutationKey:c});const t=Object(u.a)(),n=Object(d.a)(),s=Object(r.c)(),p=null==s?void 0:s.actions.setLoadingRules;return{bulkExport:Object(a.useCallback)((async a=>{try{var r;return null==p||p({ids:null!==(r=a.ids)&&void 0!==r?r:n(i.b.export),action:i.b.export}),await e(a)}catch(e){t({actionType:i.b.export,error:e})}finally{null==p||p({ids:[],action:null})}}),[n,p,e,t])}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return D})),n.d(t,"a",(function(){return F}));var a=n(4),i=n.n(a),r=n(32),o=n(33),s=n.n(o),l=n(78),c=n(99),u=n(77),d=n(0);const p=d.i18n.translate("xpack.securitySolution.timeline.graphOverlay.closeAnalyzerButton",{defaultMessage:"Close analyzer"}),m=d.i18n.translate("xpack.securitySolution.timeline.graphOverlay.closeSessionButton",{defaultMessage:"Close session viewer"});var g=n(79),f=n(870),b=n(95),y=n(539),h=n(1),v=n(340),E=n(557),x=n(148),k=n(614),S=n(116),w=n(86),j=n(112),O=n(81),I=n(155),T=n(180);const C=s()(r.EuiButtonIcon).withConfig({displayName:"FullScreenButtonIcon",componentId:"sc-2qihun-0"})(["margin:4px 0 4px 0;"]),M=({fullScreen:e,globalFullScreen:t,onCloseOverlay:n,isActiveTimelines:a,timelineFullScreen:o,toggleFullScreen:s,graphEventId:l,activeTab:c})=>i.a.createElement(r.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButtonEmpty,{iconType:"cross",onClick:n,size:"xs"},a?c===g.m.graph?p:m:l?p:m)),!1===a&&i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiToolTip,{content:e?E.a:v.d},i.a.createElement(C,{"aria-label":Object(y.b)({globalFullScreen:t,isActiveTimelines:a,timelineFullScreen:o})?E.a:v.d,className:e?h.Gb:"",color:e?"ghost":"primary","data-test-subj":"full-screen",iconType:"fullScreen",onClick:s}))));M.displayName="NavigationComponent";const N=i.a.memo(M),D=({scopeId:e})=>{const t=Object(l.useDispatch)(),n=Object(a.useMemo)((()=>Object(c.isTimelineScope)(e)?w.b.getTimelineByIdSelector():Object(c.isInTableScope)(e)?I.b.getTableByIdSelector():void 0),[e]),{globalFullScreen:r,setGlobalFullScreen:o}=Object(x.a)(),{timelineFullScreen:s,setTimelineFullScreen:u}=Object(x.c)(),d=Object(c.isTimelineScope)(e)?j.b:T.a,{graphEventId:p,sessionViewConfig:m,activeTab:f,prevActiveTab:b}=Object(O.a)((t=>{var a;return{activeTab:j.b.activeTab,prevActiveTab:j.b.prevActiveTab,...null!==(a=n&&n(t,e))&&void 0!==a?a:d}})),v=Object(c.getScopedActions)(e),E=Object(a.useCallback)((()=>{null!==document.querySelector(".euiDataGrid--fullScreen")?Object(c.isActiveTimeline)(e)?document.body.classList.add("euiDataGrid__restrictBody"):document.body.classList.add(h.oc,"euiDataGrid__restrictBody"):Object(c.isActiveTimeline)(e)?u(!1):o(!1),!1===Object(c.isActiveTimeline)(e)?v&&(t(v.updateGraphEventId({id:e,graphEventId:""})),t(v.updateSessionViewConfig({id:e,sessionViewConfig:null}))):f===g.m.graph?(v&&t(v.updateGraphEventId({id:e,graphEventId:""})),b!==g.m.session||m||t(w.a.setActiveTabTimeline({id:e,activeTab:g.m.query}))):f===g.m.session&&(Object(c.isTimelineScope)(e)&&(b!==g.m.graph||p?t(w.a.setActiveTabTimeline({id:e,activeTab:b})):t(w.a.setActiveTabTimeline({id:e,activeTab:g.m.query}))),v&&t(v.updateSessionViewConfig({id:e,sessionViewConfig:null})))}),[u,o,v,t,e,f,b,m,p]),k=Object(a.useMemo)((()=>Object(y.b)({globalFullScreen:r,isActiveTimelines:Object(c.isActiveTimeline)(e),timelineFullScreen:s})),[r,e,s]),S=Object(a.useCallback)((()=>{Object(c.isActiveTimeline)(e)?u(!s):o(!r)}),[e,u,s,o,r]),C=Object(a.useMemo)((()=>i.a.createElement(N,{fullScreen:k,globalFullScreen:r,activeTab:f,onCloseOverlay:E,isActiveTimelines:Object(c.isActiveTimeline)(e),timelineFullScreen:s,toggleFullScreen:S,graphEventId:p})),[k,r,f,E,e,s,S,p]);return{onCloseOverlay:E,Navigation:C}},F=({scopeId:e,entityType:t,height:n})=>{const{sessionView:i}=Object(u.k)().services,r=Object(a.useMemo)((()=>Object(c.isTimelineScope)(e)?w.b.getTimelineByIdSelector():Object(c.isInTableScope)(e)?I.b.getTableByIdSelector():void 0),[e]),{globalFullScreen:o}=Object(x.a)(),{timelineFullScreen:s}=Object(x.c)(),{canAccessEndpointManagement:l}=Object(S.a)().endpointPrivileges,d=Object(c.isTimelineScope)(e)?j.b:T.a,{sessionViewConfig:p,activeTab:m}=Object(O.a)((t=>{var n;return{activeTab:j.b.activeTab,prevActiveTab:j.b.prevActiveTab,...null!==(n=r&&r(t,e))&&void 0!==n?n:d}})),h=Object(a.useMemo)((()=>Object(y.b)({globalFullScreen:o,isActiveTimelines:Object(c.isActiveTimeline)(e),timelineFullScreen:s})),[o,e,s]),v=Object(a.useMemo)((()=>Object(c.isActiveTimeline)(e)?b.SourcererScopeName.timeline:k.a.includes(e)?b.SourcererScopeName.detections:b.SourcererScopeName.default),[e]),{openEventDetailsPanel:E,shouldShowDetailsPanel:C,DetailsPanel:M}=Object(f.a)({isFlyoutView:!Object(c.isActiveTimeline)(e),entityType:t,sourcererScope:v,scopeId:e,tabType:Object(c.isActiveTimeline)(e)?m:g.m.query}),N=Object(a.useMemo)((()=>{const e=n?n-118:void 0;return null!==p?i.getSessionView({...p,loadAlertDetails:E,isFullScreen:h,height:e,canAccessEndpointManagement:l}):null}),[n,p,i,E,h,l]);return{openEventDetailsPanel:E,shouldShowDetailsPanel:C,SessionView:N,DetailsPanel:M}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return j})),n.d(t,"a",(function(){return T}));var a=n(34),i=n(32),r=n(35),o=n(4),s=n.n(o),l=n(33),c=n.n(l),u=n(78),d=n(87),p=n(398),m=n(86),g=n(302),f=n(0);const b=f.i18n.translate("xpack.securitySolution.timeline.toggleEventDetailsTitle",{defaultMessage:"Expand event details"}),y=f.i18n.translate("xpack.securitySolution.timeline.addedANoteLabel",{defaultMessage:"added a note"}),h=f.i18n.translate("xpack.securitySolution.timeline.addedADescriptionLabel",{defaultMessage:"added description"}),v=f.i18n.translate("xpack.securitySolution.timeline.anUnknownUserLabel",{defaultMessage:"an unknown user"});var E=n(79),x=n(81),k=n(701),S=n(95),w=n(94);const j=c.a.section.withConfig({displayName:"NotePreviewsContainer",componentId:"sc-1g73res-0"})(["padding-top:",";"],(({theme:e})=>`${e.eui.euiSizeS}`));j.displayName="NotePreviewsContainer";const O=({eventId:e,timelineId:t})=>{const n=Object(u.useDispatch)(),{selectedPatterns:a}=Object(w.d)(S.SourcererScopeName.timeline),r=Object(o.useCallback)((()=>{n(m.a.toggleDetailPanel({panelView:"eventDetail",tabType:E.m.notes,id:t,params:{eventId:e,indexName:a.join(",")}}))}),[n,e,a,t]);return s.a.createElement(i.EuiButtonIcon,{title:b,"aria-label":b,color:"text",iconType:"arrowRight",onClick:r})},I=s.a.memo(O),T=s.a.memo((({eventIdToNoteIds:e,notes:t,timelineId:n,showTimelineDescription:l})=>{const c=Object(o.useMemo)((()=>m.b.getTimelineByIdSelector()),[]),u=Object(x.a)((e=>n?c(e,n):null)),f=Object(o.useMemo)((()=>l&&n&&null!=u&&u.description?[{username:Object(d.a)(u.updatedBy),event:h,"data-test-subj":"note-preview-description",id:"note-preview-description",timestamp:u.updated?s.a.createElement(r.FormattedRelative,{"data-test-subj":"updated",value:new Date(u.updated)}):Object(d.e)(),children:s.a.createElement(i.EuiText,{size:"s"},u.description),timelineAvatar:s.a.createElement(i.EuiAvatar,{"data-test-subj":"avatar",name:null!=u.updatedBy?u.updatedBy:"?",size:"l"}),actions:s.a.createElement(k.a,{timelineId:n,initialFocus:"description"})}]:[]),[u,n,l]),b=Object(o.useMemo)((()=>Object(a.uniqBy)("savedObjectId",t).map((t=>{var a,o,l;const c=null!=e?Object.entries(e).reduce(((e,[n,a])=>{var i;return a.includes(null!==(i=t.noteId)&&void 0!==i?i:"")?n:e}),null):null!==(a=t.eventId)&&void 0!==a?a:null;return{"data-test-subj":`note-preview-${t.savedObjectId}`,username:Object(d.a)(t.updatedBy),event:y,timestamp:t.updated?s.a.createElement(r.FormattedRelative,{"data-test-subj":"updated",value:new Date(t.updated)}):Object(d.e)(),children:s.a.createElement("div",{className:g.a,tabIndex:0},s.a.createElement(i.EuiScreenReaderOnly,{"data-test-subj":"screenReaderOnlyUserAddedANote"},s.a.createElement("p",null,`${null!==(o=t.updatedBy)&&void 0!==o?o:v} ${y}`)),s.a.createElement(p.b,null,null!==(l=t.note)&&void 0!==l?l:"")),actions:c&&n?s.a.createElement(I,{eventId:c,timelineId:n}):null,timelineAvatar:s.a.createElement(i.EuiAvatar,{"data-test-subj":"avatar",name:null!=t.updatedBy?t.updatedBy:"?",size:"l"})}}))),[e,t,n]);return s.a.createElement(i.EuiCommentList,{"data-test-subj":"note-comment-list",comments:[...f,...b]})}));T.displayName="NotePreviews"},function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var a=n(4),i=n.n(a),r=n(32),o=n(133),s=n(106),l=n(150),c=n(102);const u=({idPrefix:e,entityName:t,entityValue:n})=>{const r=Object(c.h)(`entity-draggable-${e}-${t}-${n}`),u=Object(a.useMemo)((()=>({and:[],enabled:!0,id:r,name:n,excluded:!1,kqlQuery:"",queryMatch:{field:t,value:n,operator:s.d}})),[t,n,r]),d=Object(a.useCallback)(((e,a,r)=>r.isDragging?i.a.createElement(o.a,null,i.a.createElement(l.a,{dataProvider:e})):i.a.createElement(i.a.Fragment,null,`${t}: "${n}"`)),[t,n]);return i.a.createElement(o.b,{key:r,dataProvider:u,render:d,isAggregatable:!0,fieldType:"keyword"})};u.displayName="EntityDraggableComponent";const d=i.a.memo(u);d.displayName="EntityDraggable";var p=n(533),m=n(288),g=n(388),f=n(627),b=n(629),y=n(101);const h=(e,t)=>[{name:m.b,field:"anomaly.jobId",sortable:!0,render:(n,a)=>i.a.createElement(b.a,{score:a.anomaly,startDate:e,endDate:t,linkName:n})},{name:m.n,field:"anomaly.severity",sortable:!0,render:(e,t)=>i.a.createElement(f.a,{id:Object(c.h)(`anomalies-table-severity-${Object(p.a)(t.anomaly)}`),score:t.anomaly})},{name:m.c,field:"anomaly.entityValue",sortable:!0,render:(e,t)=>i.a.createElement(d,{idPrefix:`anomalies-table-entityValue${Object(p.a)(t.anomaly)}-entity`,entityName:t.anomaly.entityName,entityValue:e})},{name:m.e,field:"anomaly.influencers",render:(e,t)=>i.a.createElement(r.EuiFlexGroup,{direction:"column",gutterSize:"none",responsive:!1},e&&e.map((e=>{const[n,a]=Object(g.a)(e),o=null!=n?n:"",s=null!=a?a:"";return i.a.createElement(r.EuiFlexItem,{key:`${o}-${s}-${Object(p.a)(t.anomaly)}`,grow:!1},i.a.createElement(r.EuiFlexGroup,{gutterSize:"none",responsive:!1},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(d,{idPrefix:`anomalies-table-influencers-${o}-${s}-${Object(p.a)(t.anomaly)}`,entityName:o,entityValue:s}))))})))},{name:m.p,field:"anomaly.time",sortable:!0,render:e=>i.a.createElement(y.b,{value:e})}]},,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(32),i=n(4),r=n.n(i),o=n(49),s=n(33),l=n.n(s),c=n(297),u=n(424),d=n(558);const p={chartMargins:{top:0,bottom:0,left:0,right:0},partition:{idealFontSizeJump:1.1,outerSizeRatio:1,emptySizeRatio:.8,circlePadding:4}},m=l()(a.EuiFlexGroup).withConfig({displayName:"DonutTextWrapper",componentId:"sc-1oomqeq-0"})(["top:34%;width:100%;max-width:77px;position:absolute;z-index:1;"]),g=l()(a.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-1oomqeq-1"})(["position:relative;align-items:center;"]),f=({data:e,fillColor:t,height:n=90,label:s,legendItems:l,title:f,totalCount:b})=>{const y=Object(c.i)(),{euiTheme:h}=Object(a.useEuiTheme)(),v=Object(i.useMemo)((()=>({color:h.colors.disabled})),[h.colors.disabled]);return r.a.createElement(a.EuiFlexGroup,{alignItems:"center",justifyContent:"center",responsive:!1,gutterSize:"l","data-test-subj":"donut-chart"},r.a.createElement(g,{grow:!1},r.a.createElement(m,{direction:"column",gutterSize:"none",alignItems:"center",justifyContent:"center"},r.a.createElement(a.EuiFlexItem,null,f),r.a.createElement(a.EuiFlexItem,{className:"eui-textTruncate"},r.a.createElement(a.EuiToolTip,{content:s},r.a.createElement(a.EuiText,{className:"eui-textTruncate",size:"s",style:e?void 0:v},s)))),null==e||null==b||0===b?r.a.createElement(d.a,{size:n}):r.a.createElement(o.Chart,{size:n},r.a.createElement(o.Settings,{theme:p,baseTheme:y}),r.a.createElement(o.Partition,{id:"donut-chart",data:e,layout:o.PartitionLayout.sunburst,valueAccessor:e=>e.value,valueFormatter:e=>`${Object(o.defaultPartitionValueFormatter)(e)}`,layers:[{groupByRollup:e=>{var t;return null!==(t=e.label)&&void 0!==t?t:e.key},nodeLabel:e=>e,shape:{fillColor:t}}]}))),l&&(null==l?void 0:l.length)>0&&r.a.createElement(a.EuiFlexItem,null,r.a.createElement(u.a,{legendItems:l,height:n})))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(0);const i=e=>e?a.i18n.translate("xpack.securitySolution.toggleQuery.on",{defaultMessage:"Open"}):a.i18n.translate("xpack.securitySolution.toggleQuery.off",{defaultMessage:"Closed"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(4),i=n.n(a),r=n(32),o=n(79),s=n(121),l=n(227);const c=({timelineType:e,elasticTemplateTimelineCount:t,customTemplateTimelineCount:n})=>{const[c,u]=Object(a.useState)(null),d=Object(a.useMemo)((()=>e===o.n.template),[e]),p=Object(a.useMemo)((()=>d?c:null),[c,d]),m=Object(a.useMemo)((()=>null==p?null:p===o.h.elastic?o.l.immutable:o.l.active),[p]),g=Object(a.useMemo)((()=>[{id:o.h.elastic,name:s.q,disabled:!d,withNext:!0,count:null!=t?t:void 0},{id:o.h.custom,name:s.p,disabled:!d,withNext:!1,count:null!=n?n:void 0}]),[n,t,d]),f=Object(a.useCallback)((e=>{u(c===e?null:e)}),[u,c]),b=Object(a.useMemo)((()=>d?g.map((e=>i.a.createElement(r.EuiFilterButton,{hasActiveFilters:e.id===p,key:`template-timeline-filter-${e.id}`,numFilters:e.count,onClick:f.bind(null,e.id),withNext:e.withNext,isDisabled:e.disabled,"data-test-subj":e.name},e.name))):null),[p,g,d,f]),y=Object(a.useCallback)((async()=>{p!==o.h.custom&&await Object(l.f)()}),[p]);return{timelineStatus:m,templateTimelineType:p,templateTimelineFilter:b,installPrepackagedTimelines:y}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(4),i=n.n(a),r=n(79),o=n(210);const s=({closeGearMenu:e,outline:t,title:n,timelineId:a=r.j.active})=>{const{getButton:i}=Object(o.b)({timelineId:a,timelineType:r.n.template,closeGearMenu:e});return i({outline:t,title:n})},l=i.a.memo(s);l.displayName="NewTemplateTimeline"},function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"g",(function(){return l})),n.d(t,"e",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"f",(function(){return m}));var a=n(108),i=n(79),r=n(932),o=n(527);const s=()=>Object(a.createSelector)(o.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.activeTab)&&void 0!==t?t:i.m.query})),l=()=>Object(a.createSelector)(o.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.show)&&void 0!==t&&t})),c=()=>Object(a.createSelector)(o.selectTimeline,(e=>{var t;return Object.keys(null!==(t=null==e?void 0:e.pinnedEventIds)&&void 0!==t?t:{}).length})),u=()=>Object(a.createSelector)(o.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.noteIds)&&void 0!==t?t:[]})),d=()=>Object(a.createSelector)(o.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.eventIdToNoteIds)&&void 0!==t?t:{}})),p=()=>Object(a.createSelector)(r.selectNotesById,(e=>Object.values(e))),m=()=>Object(a.createSelector)(o.selectTimeline,(e=>null==e?void 0:e.scrollToTop))},function(e,t,n){"use strict";n.d(t,"a",(function(){return C}));var a=n(82),i=n.n(a),r=n(49),o=n(44),s=n.n(o),l=n(4),c=n.n(l),u=n(33),d=n.n(u),p=n(32),m=n(42),g=n(1),f=n(619),b=n(382),y=n(326),h=n(146),v=n(77),E=n(225),x=n(134),k=n(273),S=n(2),w=n(128),j=n(233);const O=e=>({text:e,value:e}),I=d()(p.EuiButton).withConfig({displayName:"StyledLinkButton",componentId:"sc-18xuh7o-0"})(["margin-left:0;@media only screen and (min-width:","){margin-left:",";}"],(e=>e.theme.eui.euiBreakpoints.m),(({theme:e})=>e.eui.euiSizeL)),T=({combinedQueries:e,deleteQuery:t,filters:n,from:a,headerChildren:o,indexPattern:u,indexNames:d,runtimeMappings:p,onlyField:T,paddingSize:C,query:M,queryType:N,setAbsoluteRangeDatePickerTarget:D,setQuery:F,showLegend:A,showSpacer:_=!0,scopeId:R,to:P,toggleTopN:L})=>{const q=Object(l.useMemo)((()=>`eventsByDatasetOverview-${N}`),[N]);Object(l.useEffect)((()=>()=>{t&&t({id:q})}),[t,q]);const B=Object(v.k)(),{formatUrl:z,search:$}=Object(w.n)(S.a.hosts),{navigateToApp:V}=B.services.application,[U]=Object(v.q)(g.Z),H=Object(l.useCallback)((e=>{e.preventDefault(),V(g.B,{deepLinkId:S.a.hosts,path:Object(b.c)(x.HostsTableType.events,$)})}),[V,$]),G=Object(l.useMemo)((()=>c.a.createElement(I,{onClick:H,href:z(Object(b.c)(x.HostsTableType.events))},k.l)),[H,z]),[Q,W]=Object(l.useMemo)((()=>null==e?Object(h.c)({config:Object(m.getEsQueryConfig)(B.services.uiSettings),indexPattern:u,queries:[M],filters:n}):[e]),[e,B,u,M,n]);Object(j.a)({id:q,filterQuery:Q,kqlError:W,query:M,startDate:a,endDate:P});const K=Object(l.useMemo)((()=>{var e;return{...E.b,stackByOptions:null!=T?[O(T)]:E.b.stackByOptions,defaultStackByOption:null!=T?O(T):null!==(e=E.c.find((e=>"event.dataset"===e.text)))&&void 0!==e?e:E.c[0],legendPosition:r.Position.Right,subtitle:e=>`${f.b}: ${s()(e).format(U)} ${Object(f.c)(e)}`,titleSize:null==T?"m":"s"}}),[T,U]),Y=Object(l.useMemo)((()=>null==T||null!=o?c.a.createElement(c.a.Fragment,null,o,null==T&&G):null),[T,o,G]);return c.a.createElement(y.a,i()({endDate:P,filterQuery:Q,headerChildren:Y,id:q,indexNames:d,runtimeMappings:p,onError:L,paddingSize:C,setAbsoluteRangeDatePickerTarget:D,setQuery:F,showSpacer:_,showLegend:A,skip:void 0===Q,startDate:a,scopeId:R},K,{title:null!=T?k.j(T):K.title}))};T.displayName="EventsByDatasetComponent";const C=c.a.memo(T)},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(4),i=n.n(a),r=n(32),o=n(33),s=n.n(o),l=n(297),c=n(303);const u=s()(r.EuiFlexGroup).withConfig({displayName:"FlexGroup",componentId:"sc-k2lbwg-0"})(["height:",";width:",";position:relative;margin:0;"],(({height:e})=>e||"100%"),(({width:e})=>e||"100%"));u.displayName="FlexGroup";const d=({height:e="100%",width:t="100%",data:n})=>i.a.createElement(u,{justifyContent:"center",alignItems:"center",height:e,width:t},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiText,{size:"s",textAlign:"center",color:"subdued","data-test-subj":"chartHolderText"},Object(l.f)(n)?c.a:c.b)))},function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n(4),i=n(1),r=n(134),o=n(272),s=n(94),l=n(81),c=n(98),u=n(183),d=n(304);const p=({lensAttributes:e,getLensAttributes:t,stackByField:n,title:p})=>{const{selectedPatterns:m,dataViewId:g}=Object(s.d)(),f=Object(a.useMemo)((()=>c.d.globalQuerySelector()),[]),b=Object(a.useMemo)((()=>c.d.globalFiltersQuerySelector()),[]),y=Object(l.a)(f),h=Object(l.a)(b),[{detailName:v,pageName:E,tabName:x}]=Object(u.a)(),k=Object(a.useMemo)((()=>E===i.uc.hosts&&x===r.HostsTableType.events?d.e:E===i.uc.network&&x===o.a.events?d.f:[]),[E,x]),S=Object(a.useMemo)((()=>E===i.uc.hosts&&null!=v?Object(d.a)(v):[]),[v,E]),w=Object(a.useMemo)((()=>Object(d.b)(m)),[m]);return Object(a.useMemo)((()=>{if(null==e&&(null==t||null==n))return null;const a=null!=e?e:t&&n&&t(n);return{...a,...null!=p?{title:p}:{},state:{...a.state,query:y,filters:[...a.state.filters,...h,...S,...k,...w]},references:a.references.map((e=>({...e,id:g})))}}),[e,t,n,p,y,h,S,k,w,g])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(4),i=n(8),r=n(77),o=n(194);const s=({onAddToCaseClicked:e,lensAttributes:t,timeRange:n})=>{const s=Object(r.i)(),{cases:l}=Object(r.k)().services,c=Object(a.useMemo)((()=>[{comment:`!{lens${JSON.stringify({timeRange:n,attributes:t})}}`,type:i.CommentType.user}]),[t,n]),u=l.hooks.getUseCasesAddToExistingCaseModal({onClose:e,toastContent:o.a});return{onAddToExistingCaseClicked:Object(a.useCallback)((()=>{e&&e(),u.open({attachments:c})}),[c,e,u]),disabled:null==t||null==n||!s.create||!s.read}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(4),i=n(8),r=n(77),o=n(194);const s=({onClick:e,timeRange:t,lensAttributes:n})=>{const s=Object(r.i)(),{cases:l}=Object(r.k)().services,c=Object(a.useMemo)((()=>[{comment:`!{lens${JSON.stringify({timeRange:t,attributes:n})}}`,type:i.CommentType.user}]),[n,t]),u=l.hooks.getUseCasesAddToNewCaseFlyout({toastContent:o.a});return{onAddToNewCaseClicked:Object(a.useCallback)((()=>{e&&e(),u.open({attachments:c})}),[c,u,e]),disabled:null==n||null==t||!s.create||!s.read}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(4),i=n.n(a),r=n(33),o=n.n(r),s=n(234);const l=o.a.div.withConfig({displayName:"PlaceHolder",componentId:"sc-u1bwbv-0"})(["padding:",";"],(e=>e.theme.eui.euiSizeS)),c=({count:e})=>null!=e?i.a.createElement("b",null,i.a.createElement(s.a,{count:e})):i.a.createElement(l,null);c.displayName="ChartLabelComponent";const u=i.a.memo(c)},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(4),i=n(287);const r=Object(i.c)(),o=()=>{const[e]=Object(a.useState)(r);return{globalKQLHeaderPortalNode:e}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(4),i=n.n(a),r=n(32),o=n(33),s=n.n(o),l=n(88),c=n(203);const u=s.a.h1.withConfig({displayName:"Header",componentId:"sc-1tun0gt-0"})(["display:grid;grid-gap:12px;grid-template-columns:auto auto;align-items:center;justify-items:start;justify-content:start;"]);u.displayName="Header";const d=s.a.span.withConfig({displayName:"TitleWrapper",componentId:"sc-1tun0gt-1"})(["min-width:0;max-width:100%;"]);d.displayName="TitleWrapper";const p=({draggableArguments:e,title:t,badgeOptions:n})=>i.a.createElement(r.EuiTitle,{size:"l"},i.a.createElement(u,{"data-test-subj":"header-page-title"},e?i.a.createElement(l.b,{"data-test-subj":"header-page-draggable",id:`header-page-draggable-${e.field}-${e.value}`,field:e.field,value:`${e.value}`}):i.a.createElement(d,null,i.a.createElement(c.b,{tooltipContent:t},t)),n&&i.a.createElement(i.a.Fragment,null,n.beta?i.a.createElement(r.EuiBetaBadge,{label:n.text,tooltipContent:n.tooltip,tooltipPosition:"bottom",size:n.size}):i.a.createElement(r.EuiBadge,{color:n.color||"hollow",title:""},n.text)))),m=i.a.memo(p)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(0).i18n.translate("xpack.securitySolution.components.ml.anomaly.errors.anomaliesTableFetchFailureTitle",{defaultMessage:"Anomalies table fetch failure"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(4),i=n(1),r=n(77);const o=({defaultValue:e,key:t,plugin:n=i.p,isInvalidDefault:o})=>{const{storage:s}=Object(r.k)().services,[l,c]=Object(a.useState)(!1),[u,d]=Object(a.useState)(e),p=Object(a.useCallback)((()=>{const a=s.get(`${n}.${t}`),i=typeof a!=typeof e,r=null!=o&&o(a);d(i||r?e:a)}),[e,o,t,n,s]),m=Object(a.useCallback)((e=>{s.set(`${n}.${t}`,e),d(e)}),[t,n,s]);return Object(a.useEffect)((()=>{l||(p(),c(!0))}),[l,p]),[u,m]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(4),i=n.n(a),r=n(78),o=n(99),s=n(86),l=n(94),c=n(228),u=n(79),d=n(112),p=n(81),m=n(504),g=n(155);const f=({entityType:e,isFlyoutView:t,sourcererScope:n,scopeId:f,tabType:b=u.m.query})=>{const{browserFields:y,selectedPatterns:h,runtimeMappings:v}=Object(l.d)(n),E=Object(r.useDispatch)(),x=Object(a.useMemo)((()=>Object(o.isTimelineScope)(f)?s.b.getTimelineByIdSelector():Object(o.isInTableScope)(f)?g.b.getTableByIdSelector():void 0),[f]),k=Object(a.useMemo)((()=>h.join(",")),[h]),S=Object(p.a)((e=>{var t,n;return null===(t=null!==(n=x&&x(e,f))&&void 0!==n?n:d.b)||void 0===t?void 0:t.expandedDetail})),w=Object(a.useRef)((()=>{})),j=()=>{},O=Object(a.useMemo)((()=>{var e;return!!(b&&S&&S[b]&&null!==(e=S[b])&&void 0!==e&&e.panelView)}),[S,b]),I=Object(o.getScopedActions)(f),T=Object(a.useCallback)((e=>{e&&I&&E(I.toggleDetailPanel({...e,tabType:b,id:f}))}),[I,f,E,b]),C=Object(a.useCallback)(((e,t)=>{e&&T({panelView:"eventDetail",params:{eventId:e,indexName:k}}),w.current=null!=t?t:j}),[T,k]),M=Object(a.useCallback)(((e,t)=>{T({panelView:"hostDetail",params:{hostName:e}}),w.current=null!=t?t:j}),[T]),N=Object(a.useCallback)(((e,t,n)=>{T({panelView:"networkDetail",params:{ip:e,flowTarget:t}}),w.current=null!=n?n:j}),[T]),D=Object(a.useCallback)(((e,t)=>{T({panelView:"userDetail",params:{userName:e}}),w.current=null!=t?t:j}),[T]),F=Object(a.useCallback)((()=>{var e;w.current&&w.current(),I&&E(I.toggleDetailPanel({tabType:b,id:f})),b&&null!==(e=S[b])&&void 0!==e&&e.panelView&&f===u.j.active&&O&&c.a.toggleExpandedDetail({})}),[I,b,S,f,O,E]),A=Object(a.useMemo)((()=>O?i.a.createElement(m.a,{browserFields:y,entityType:e,handleOnPanelClosed:F,isFlyoutView:t,runtimeMappings:v,tabType:b,scopeId:f}):null),[y,e,F,t,v,O,b,f]);return{openEventDetailsPanel:C,openHostDetailsPanel:M,openNetworkDetailsPanel:N,openUserDetailsPanel:D,handleOnDetailsPanelClosed:F,shouldShowDetailsPanel:O,DetailsPanel:A}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(695);const i=e=>{var t;const n=null!=e&&e.fields?null==e?void 0:e.fields["kibana.alert.rule.parameters"]:null,i=n?null===(t=n[0])||void 0===t?void 0:t.threat:null;return i&&i.length>0?Object(a.j)({label:i[0].framework,threat:i}):null}},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"f",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"c",(function(){return c}));var a=n(0);const i=a.i18n.translate("xpack.securitySolution.riskScore.technicalPreviewLabel",{defaultMessage:"Technical Preview"}),r=a.i18n.translate("xpack.securitySolution.riskScore.hostsDashboardWarningPanelTitle",{defaultMessage:"No host risk score data available to display"}),o=a.i18n.translate("xpack.securitySolution.riskScore.usersDashboardWarningPanelTitle",{defaultMessage:"No user risk score data available to display"}),s=a.i18n.translate("xpack.securitySolution.riskScore.hostsDashboardWarningPanelBody",{defaultMessage:"We haven't detected any host risk score data from the hosts in your environment. The data might need an hour to be generated after enabling the module."}),l=a.i18n.translate("xpack.securitySolution.riskScore.usersDashboardWarningPanelBody",{defaultMessage:"We haven't detected any user risk score data from the users in your environment. The data might need an hour to be generated after enabling the module."}),c=a.i18n.translate("xpack.securitySolution.riskScore.usersDashboardRestartTooltip",{defaultMessage:"The risk score calculation might take a while to run. However, by pressing restart, you can force it to run immediately."})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(4),i=n.n(a),r=n(356),o=n(635),s=n(182),l=n(104);const c={flexGrow:0},u=({data:e,eventId:t,fieldFromBrowserField:n,isDraggable:a,linkValue:u,scopeId:d,values:p,isReadOnly:m})=>{const g=Object(s.e)(e.field);return i.a.createElement(i.a.Fragment,null,i.a.createElement(o.a,{contextId:d,data:e,eventId:t,fieldFromBrowserField:n,linkValue:u,isDraggable:a,style:c,values:p}),d!==l.d.active&&!m&&g&&i.a.createElement(r.a,{contextId:d,data:e,eventId:t,fieldFromBrowserField:n,linkValue:u,scopeId:d,values:p,applyWidthAndPadding:!1,hideAddToTimeline:!1}))};u.displayName="SummaryValueCell"},function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));var a=n(34),i=n(4),r=n.n(i),o=n(33),s=n.n(o),l=n(79),c=n(351),u=n(515),d=n(305),p=n(473),m=n(306),g=n(516),f=n(693),b=n(476),y=n(643),h=n(258),v=n(359),E=n(474),x=n(423),k=n(223);const S=s.a.div.withConfig({displayName:"Details",componentId:"sc-1v02rai-0"})(["margin:5px 0;"]);S.displayName="Details";const w={id:l.d.netflow,isInstance:e=>"network_traffic"===`${Object(a.get)("event.category",e)}`.toLowerCase()||(e=>{const t=`${e}`.toLowerCase();return"network_flow"===t||"netflow_flow"===t})(Object(a.get)("event.action",e)),renderRow:({data:e,isDraggable:t,scopeId:n})=>r.a.createElement(k.a,null,r.a.createElement(S,null,r.a.createElement(f.a,{contextId:`netflow-row-renderer-render-row-${n}-${e._id}`,destinationBytes:Object(c.a)(Object(a.get)(x.a,e)),destinationGeoContinentName:Object(c.a)(Object(a.get)(E.b,e)),destinationGeoCountryName:Object(c.a)(Object(a.get)(E.d,e)),destinationGeoCountryIsoCode:Object(c.a)(Object(a.get)(E.c,e)),destinationGeoRegionName:Object(c.a)(Object(a.get)(E.e,e)),destinationGeoCityName:Object(c.a)(Object(a.get)(E.a,e)),destinationIp:Object(c.a)(Object(a.get)(m.a,e)),destinationPackets:Object(c.a)(Object(a.get)(x.b,e)),destinationPort:Object(c.a)(Object(a.get)(h.a,e)),eventDuration:Object(c.a)(Object(a.get)(d.b,e)),eventId:Object(a.get)(p.a,e),eventEnd:Object(c.a)(Object(a.get)(b.b,e)),eventStart:Object(c.a)(Object(a.get)(b.c,e)),isDraggable:t,networkBytes:Object(c.a)(Object(a.get)(v.a,e)),networkCommunityId:Object(c.a)(Object(a.get)(v.b,e)),networkDirection:Object(c.a)(Object(a.get)(v.c,e)),networkPackets:Object(c.a)(Object(a.get)(v.d,e)),networkProtocol:Object(c.a)(Object(a.get)(v.e,e)),processName:Object(c.a)(Object(a.get)(y.a,e)),sourceBytes:Object(c.a)(Object(a.get)(x.c,e)),sourceGeoContinentName:Object(c.a)(Object(a.get)(E.h,e)),sourceGeoCountryName:Object(c.a)(Object(a.get)(E.j,e)),sourceGeoCountryIsoCode:Object(c.a)(Object(a.get)(E.i,e)),sourceGeoRegionName:Object(c.a)(Object(a.get)(E.k,e)),sourceGeoCityName:Object(c.a)(Object(a.get)(E.g,e)),sourceIp:Object(c.a)(Object(a.get)(m.d,e)),sourcePackets:Object(c.a)(Object(a.get)(x.d,e)),sourcePort:Object(c.a)(Object(a.get)(h.c,e)),tlsClientCertificateFingerprintSha1:Object(c.a)(Object(a.get)(u.b,e)),tlsFingerprintsJa3Hash:Object(c.a)(Object(a.get)(g.a,e)),tlsServerCertificateFingerprintSha1:Object(c.a)(Object(a.get)(u.c,e)),transport:Object(c.a)(Object(a.get)(v.f,e)),userName:Object(c.a)(Object(a.get)(y.b,e))})))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var a=n(4);const i=n.n(a).a.createContext(null),r=()=>{var e;return null===(e=Object(a.useContext)(i))||void 0===e?void 0:e.current}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var a=n(56);n(7);const i=e=>0===e.length?{}:{query:{bool:{filter:{ids:{values:e}}}},size:1e4},r=(e,t)=>{const n=e.split(".");return 1===n.length?{[n[0]]:t}:{[n[0]]:r(n.slice(1).join("."),t)}},o=e=>{return t=e,Array.isArray(t)?t:Object.entries(t).reduce(((e,[t,n])=>Object(a.merge)(e,r(t,n))),{});var t}},function(e,t,n){const a=n(125),i=n(262),{re:r,t:o}=n(235);e.exports=(e,t)=>{if(e instanceof a)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;let n=null;if((t=t||{}).rtl){let t;for(;(t=r[o.COERCERTL].exec(e))&&(!n||n.index+n[0].length!==e.length);)n&&t.index+t[0].length===n.index+n[0].length||(n=t),r[o.COERCERTL].lastIndex=t.index+t[1].length+t[2].length;r[o.COERCERTL].lastIndex=-1}else n=e.match(r[o.COERCE]);return null===n?null:i(`${n[2]}.${n[3]||"0"}.${n[4]||"0"}`,t)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var a=n(34),i=n(32),r=n(4),o=n.n(r),s=n(252),l=n.n(s),c=n(662),u=n.n(c),d=n(33),p=n.n(d),m=n(70),g=n(100),f=n(77),b=n(675);const y=p.a.div.withConfig({displayName:"FieldErrorsContainer",componentId:"sc-1brsijn-0"})(["p{margin-bottom:0;}"]),h=p.a.div.attrs((({className:e="",$caseIndexes:t=[]})=>({className:e}))).withConfig({displayName:"ContainerActions",componentId:"sc-1brsijn-1"})(["",""],(({$caseIndexes:e})=>e.map((e=>`\n        div[id="${e}"].euiAccordion__childWrapper .euiAccordion__padding--l {\n          padding: 0px;\n          .euiFlexGroup {\n            display: none;\n          }\n          .euiSpacer.euiSpacer--xl {\n            height: 0px;\n          }\n        }\n      `)))),v=({field:e,messageVariables:t})=>{const[n,s]=Object(r.useState)(null),c=Object(g.l)(),{isSubmitted:d,isSubmitting:p,isValid:v}=c,{triggersActionsUi:{getActionForm:E}}=Object(f.k)().services,x=Object(r.useMemo)((()=>Object(a.isEmpty)(e.value)?[]:e.value),[e.value]),k=Object(r.useMemo)((()=>x.reduce(((e,t,n)=>".case"===t.actionTypeId?[...e,`${n}`]:e),[])),[x]),S=Object(r.useCallback)(((t,n)=>{const a=[...x];a[n]=l()(a[n],{id:t}),e.setValue(a)}),[e,x]),w=Object(r.useCallback)((t=>e.setValue(t)),[e]),j=Object(r.useCallback)(((t,n,a)=>{setTimeout((()=>e.setValue((e=>{const i=[...e];return i[a]={...i[a],params:{...i[a].params,[t]:n}},i}))),0)}),[e]),O=Object(r.useMemo)((()=>E({actions:x,messageVariables:t,defaultActionGroupId:"default",setActionIdByIndex:S,setActions:w,setActionParamsProperty:j,featureId:m.SecurityConnectorFeatureId,defaultActionMessage:"Rule {{context.rule.name}} generated {{state.signals_count}} alerts",hideActionHeader:!0})),[x,E,t,S,j,w]);return Object(r.useEffect)((()=>{if(p||!e.errors.length)return s(null);if(d&&!p&&!1===v&&e.errors.length){const t=e.errors.map((({message:e})=>e)).join("\n");return s(t)}}),[d,p,e.isChangingValue,v,e.errors,s]),o.a.createElement(h,{$caseIndexes:k},n?o.a.createElement(o.a.Fragment,null,o.a.createElement(y,null,o.a.createElement(i.EuiCallOut,{title:b.a,color:"danger",iconType:"alert"},o.a.createElement(u.a,null,n))),o.a.createElement(i.EuiSpacer,null)):null,O)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(32),i=n(34),r=n(4),o=n.n(r),s=n(79),l=n(254);const c=e=>e?"pinFilled":"pin",u=o.a.memo((({ariaLabel:e,allowUnpinning:t,isAlert:n,isDisabled:r,onClick:u=i.noop,pinned:d,timelineType:p})=>{const m=p===s.n.template,g=(({isAlert:e,isTemplate:t,isPinned:n})=>t?l.f(e):n?l.k(e):l.q(e))({isAlert:n,isTemplate:m,isPinned:d}),f=null!=e?e:g;return o.a.createElement(a.EuiButtonIcon,{"aria-label":f,"data-test-subj":"pin",iconType:c(d),onClick:u,isDisabled:r||m||!t,size:"s"})}));u.displayName="Pin"},function(e,t,n){"use strict";n.d(t,"a",(function(){return x})),n.d(t,"b",(function(){return k}));var a=n(34),i=n(4),r=n.n(i),o=n(78),s=n(11),l=n(92),c=n.n(l),u=n(45),d=n(90),p=n(94),m=n(95),g=n(146),f=n(494),b=n(677),y=n(123),h=n(86);const v="timeline-filter-drop-area",E=(e=[])=>e.filter((e=>e.meta.controlledBy!==v)),x=Object(i.memo)((({dataProviders:e,filters:t,filterManager:n,filterQuery:a,from:l,fromStr:u,kqlMode:x,isRefreshPaused:S,savedQueryId:w,setFilters:j,setSavedQueryId:O,refreshInterval:I,timelineId:T,to:C,toStr:M,updateReduxTime:N})=>{const D=Object(o.useDispatch)(),[F,A]=Object(i.useState)(null!=u?u:new Date(l).toISOString()),[_,R]=Object(i.useState)(null!=M?M:new Date(C).toISOString()),{browserFields:P,indexPattern:L}=Object(p.d)(m.SourcererScopeName.timeline),[q,B]=Object(i.useState)(void 0),[z,$]=Object(i.useState)({query:null!=a?a.expression:"",language:null!=a?a.kind:"kuery"}),[V,U]=Object(i.useState)(E(t)),[H,G]=Object(i.useState)(Object(g.b)(Object(y.g)(e,P),L)),Q=Object(f.a)(),W=Object(i.useCallback)(((e,t)=>D(h.a.applyKqlFilterQuery({id:T,filterQuery:{kuery:{kind:t,expression:e},serializedQuery:Object(g.b)(e,L)}}))),[D,L,T]);Object(i.useEffect)((()=>{let e=!0;const a=new s.Subscription;return n.setFilters(t),a.add(n.getUpdates$().subscribe({next:()=>{if(e){const e=E(n.getFilters());j(e),U(e)}}})),()=>{e=!1,a.unsubscribe()}}),[]),Object(i.useEffect)((()=>{const e=E(n.getFilters());c()(t,e)||n.setFilters(t)}),[t]),Object(i.useEffect)((()=>{$({query:null!=a?a.expression:"",language:null!=a?a.kind:"kuery"})}),[a]),Object(i.useEffect)((()=>{G(Object(g.b)(Object(y.g)(e,P),L))}),[e,P,L]),Object(i.useEffect)((()=>{null!=u&&null!=M?(A(u),R(M)):null!=l&&null!=C&&(A(new Date(l).toISOString()),R(new Date(C).toISOString()))}),[l,u,C,M]),Object(i.useEffect)((()=>{let e=!0;return async function(){if(null!=w&&null!=Q)try{const n=await Q.getSavedQuery(w);e&&null!=n&&B({...n,attributes:{...n.attributes,filters:E(t)}})}catch(e){B(void 0)}else e&&B(void 0)}(),()=>{e=!1}}),[w]);const K=Object(i.useCallback)(((e,t)=>{if((null==a||null!=a&&a.expression!==e.query||a.kind!==e.language)&&W(e.query,e.language),null!=t){const e=t.from.includes("now")||t.to.includes("now");N({id:d.a.timeline,end:t.to,start:t.from,isInvalid:!1,isQuickSelection:e,timelineId:T})}}),[a,T]),Y=Object(i.useCallback)((e=>{if(null!=e){if(e.id!==w&&O(e.id),null!=Q&&""!==H){const t=null!=e.attributes.filters?e.attributes.filters.findIndex((e=>e.meta.controlledBy===v)):-1;Q.updateQuery(e.id,{...e.attributes,filters:null!=e.attributes.filters?t>-1?[...e.attributes.filters.slice(0,t),k(H),...e.attributes.filters.slice(t+1)]:[...e.attributes.filters,k(H)]:[]})}}else O(null)}),[H,w,Q]);return r.a.createElement(b.a,{dateRangeFrom:F,dateRangeTo:_,hideSavedQuery:"search"===x,indexPattern:L,isRefreshPaused:S,filterQuery:z,filterManager:n,filters:V,onSubmitQuery:K,refreshInterval:I,savedQuery:q,onSavedQuery:Y,dataTestSubj:"timelineQueryInput",displayStyle:"inPage"})})),k=e=>{const t=JSON.parse(e),n=Object.keys(t);return{...t,meta:{alias:v,controlledBy:v,negate:!1,disabled:!1,type:"custom",key:Object(a.isEmpty)(n)?"bool":n[0],value:e},$state:{store:u.FilterStateStore.APP_STATE}}}},function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d}));var a=n(7),i=n(49),r=n(495),o=n(198),s=n(167),l=n(1);const c=(e,t)=>e/Math.max((t.timeframeEnd.valueOf()-t.timeframeStart.valueOf())/36e5,1)>1,u=(e,t,n=!1)=>({series:{xScaleType:i.ScaleType.Time,yScaleType:i.ScaleType.Linear,stackAccessors:["g"]},axis:{xTickFormatter:Object(o.a)([e,t]),yTickFormatter:e=>e.toLocaleString(),tickSize:8},yAxisTitle:r.i,settings:{legendPosition:i.Position.Right,showLegend:n,showLegendExtra:n,theme:{scales:{barsPadding:.08},chartMargins:{left:0,right:0,top:0,bottom:0},chartPaddings:{left:0,right:0,top:0,bottom:0}}},customHeight:200}),d=({ruleType:e,isQueryBarValid:t,isThreatQueryBarValid:n,index:i,dataViewId:r,dataSourceType:o,threatIndex:c,threatMapping:u,machineLearningJobId:d,queryBar:p,newTermsFields:m})=>{if(!t||o===s.a.DataView&&!r||o===s.a.IndexPatterns&&0===i.length)return!0;if("threat_match"===e){var g;if(!n||!c.length||!u)return!0;if(!(u.length&&null!==(g=u[0].entries)&&void 0!==g&&g.length&&u[0].entries[0].field&&u[0].entries[0].value))return!0}return"machine_learning"===e?0===d.length:"eql"===e||"query"===e||"threshold"===e?Object(a.isEmpty)(p.query.query)&&Object(a.isEmpty)(p.filters):"new_terms"===e&&(e=>0===e.length||e.length>l.Qb)(m)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(32),i=n(4),r=n.n(i),o=n(33),s=n.n(o),l=n(131),c=n(179),u=n(154),d=n(519),p=n(238);const m=s()(a.EuiSwitch).withConfig({displayName:"StaticSwitch",componentId:"sc-12pilng-0"})([".euiSwitch__thumb,.euiSwitch__icon{transition:none;}"]);m.displayName="StaticSwitch";const g=({id:e,isDisabled:t,isLoading:n,enabled:o,startMlJobsIfNeeded:s,onChange:g})=>{const[f,b]=Object(i.useState)(!1),y=Object(p.c)(),{startTransaction:h}=Object(u.a)(),{executeBulkAction:v}=Object(d.b)({suppressSuccessToast:!y}),E=Object(i.useCallback)((async t=>{b(!0),h({name:o?c.e.DISABLE:c.e.ENABLE});const n=t.target.checked;n&&await(null==s?void 0:s());const a=await v({type:n?l.b.enable:l.b.disable,ids:[e]});null!=a&&a.attributes.results.updated.length&&(null==g||g(a.attributes.results.updated[0].enabled)),b(!1)}),[o,v,e,g,s,h]),x=Object(i.useMemo)((()=>f!==n&&n||f),[f,n]);return r.a.createElement(a.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceAround",id:`rule-switch-${e}`},r.a.createElement(a.EuiFlexItem,{grow:!1},x?r.a.createElement(a.EuiLoadingSpinner,{size:"m","data-test-subj":"ruleSwitchLoader"}):r.a.createElement(m,{"data-test-subj":"ruleSwitch",label:void 0,disabled:t,checked:o,onChange:E})))},f=r.a.memo(g);f.displayName="RuleSwitch"},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(32),i=n(4),r=n.n(i),o=n(33),s=n.n(o),l=n(119);const c=s()(a.EuiPanel).withConfig({displayName:"MyPanel",componentId:"sc-177nzsv-0"})(["position:relative;"]);c.displayName="MyPanel";const u=({children:e,loading:t,title:n})=>r.a.createElement(c,{hasBorder:!0},t&&r.a.createElement(a.EuiProgress,{size:"xs",color:"accent",position:"absolute","data-test-subj":"stepPanelProgress"}),n&&r.a.createElement(l.a,{title:n}),e),d=Object(i.memo)(u)},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(4),i=n.n(a),r=n(32),o=n(113);const s=({columnName:e,children:t})=>{const[n,s]=Object(a.useState)(!1);return i.a.createElement(r.EuiPopover,{anchorPosition:"upCenter",isOpen:n,closePopover:()=>s(!1),button:i.a.createElement(r.EuiButtonIcon,{"aria-label":o.Xb(e),onClick:e=>{s(!n),e.stopPropagation()},size:"xs",color:"primary",iconType:"questionInCircle",style:{height:"auto"}})},t)},l=i.a.memo(s);l.displayName="PopoverTooltip"},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(4),i=n.n(a),r=n(32);const o=({title:e,tooltipContent:t,customTooltip:n})=>i.a.createElement(r.EuiFlexGrid,{gutterSize:"none"},i.a.createElement(r.EuiFlexItem,{style:{width:"calc(100% - 20px)"}},i.a.createElement("span",{className:"eui-textTruncate"},e)),null!=n?n:i.a.createElement(r.EuiToolTip,{content:t},i.a.createElement(r.EuiIcon,{"data-test-subj":"tableHeaderIcon",size:"m",color:"subdued",type:"questionInCircle",style:{marginLeft:4}}))),s=i.a.memo(o);s.displayName="TableHeaderTooltipCell"},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(4),i=n(39),r=n(494),o=n(84),s=n(113);const l=(e,{ruleType:t,onError:n})=>{var l;const c=Object(r.a)(),{addError:u}=Object(o.a)(),d=Object(i.useQuery)(["detectionEngine","rule","savedQuery",e],(async()=>e&&"saved_query"===t?c.getSavedQuery(e):null),{onError:null!=n?n:e=>{u(e,{title:s.Ec})},retry:!1}),p=Object(a.useMemo)((()=>{var e;return d.data?{saved_id:d.data.id,filters:null!==(e=d.data.attributes.filters)&&void 0!==e?e:[],query:d.data.attributes.query,title:d.data.attributes.title}:null}),[d.data]);return{isSavedQueryLoading:!!e&&d.isLoading,savedQueryBar:p,savedQuery:null!==(l=d.data)&&void 0!==l?l:void 0}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(4),i=n(77);const r=()=>{const{storage:e}=Object(i.k)().services,t=Object(a.useCallback)((t=>{var n;return null!==(n=e.get(`${t}-messages`))&&void 0!==n?n:[]}),[e]),n=Object(a.useCallback)(((t,n)=>{var a;const i=null!==(a=e.get(`${t}-messages`))&&void 0!==a?a:[];e.set(`${t}-messages`,[...i,n])}),[e]),r=Object(a.useCallback)(((t,n)=>{var a;return(null!==(a=e.get(`${t}-messages`))&&void 0!==a?a:[]).filter((e=>e===n)).length>0}),[e]),o=Object(a.useCallback)(((t,n)=>{var a;const i=null!==(a=e.get(`${t}-messages`))&&void 0!==a?a:[];e.set(`${t}-messages`,[...i.filter((e=>e!==n))])}),[e]);return{getMessages:t,addMessage:n,clearAllMessages:Object(a.useCallback)((t=>e.remove(`${t}-messages`)),[e]),removeMessage:o,hasMessage:r}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c}));var a=n(32),i=n(4),r=n.n(i),o=n(118);const s="open",l=({status:e=s,onFilterGroupChanged:t})=>{const n=[{id:"open",label:o.B,"data-test-subj":"openAlerts"},{id:"acknowledged",label:o.a,"data-test-subj":"acknowledgedAlerts"},{id:"closed",label:o.x,"data-test-subj":"closedAlerts"}],l=Object(i.useCallback)((e=>{t(e)}),[t]);return r.a.createElement(a.EuiButtonGroup,{legend:"filter status",color:"primary",options:n,idSelected:e,"data-test-subj":"alerts-table-filter-group",onChange:l})},c=r.a.memo(l)},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(4),i=n(312);const r=()=>{const[e,t,n]=Object(i.a)(),r=Object(a.useRef)(),o=Object(a.useCallback)((e=>{var t;null===(t=r.current)||void 0===t||t.call(r,e)}),[]),s=Object(a.useCallback)((()=>{var e;null===(e=r.current)||void 0===e||e.call(r,null)}),[]),l=Object(a.useCallback)((()=>(t(),new Promise((e=>{r.current=e})).finally((()=>{n()})))),[t,n]);return{isBulkDuplicateConfirmationVisible:e,showBulkDuplicateConfirmation:Object(a.useCallback)((async()=>{const e=await l();return e?o(e):s(),e}),[l,o,s]),cancelRuleDuplication:s,confirmRuleDuplication:o}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(4),i=n.n(a),r=n(32),o=n(536),s=n(684);const l=({onCancel:e,onConfirm:t,rulesCount:n})=>{const[l,c]=Object(a.useState)(o.a.withExceptions),u=Object(a.useCallback)((e=>{c(e)}),[c]),d=Object(a.useCallback)((()=>{t(l)}),[t,l]);return i.a.createElement(r.EuiConfirmModal,{title:s.c.MODAL_TITLE(n),onConfirm:d,cancelButtonText:s.c.CANCEL_BUTTON,confirmButtonText:s.c.CONTINUE_BUTTON,defaultFocusedButton:"confirm",onCancel:e},i.a.createElement(r.EuiText,null,s.c.MODAL_TEXT(n)," ",i.a.createElement(r.EuiIconTip,{content:s.c.DUPLICATE_TOOLTIP,position:"bottom"})),i.a.createElement(r.EuiSpacer,null),i.a.createElement(r.EuiRadioGroup,{options:[{id:o.a.withExceptions,label:s.c.DUPLICATE_EXCEPTIONS_TEXT(n)},{id:o.a.withoutExceptions,label:s.c.DUPLICATE_WITHOUT_EXCEPTIONS_TEXT(n)}],idSelected:l,onChange:u}))},c=i.a.memo(l);c.displayName="BulkActionDuplicateExceptionsConfirmation"},function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"e",(function(){return g})),n.d(t,"b",(function(){return f})),n.d(t,"d",(function(){return b})),n.d(t,"f",(function(){return y})),n.d(t,"g",(function(){return h})),n.d(t,"c",(function(){return E}));var a=n(4),i=n.n(a),r=n(0),o=n(35),s=n(32),l=n(77),c=n(692),u=n(418),d=n(686),p=n(290);const m=r.i18n.translate("xpack.securitySolution.eventFilters.aboutInfo",{defaultMessage:"Event filters exclude high volume or unwanted events from being written to Elasticsearch."}),g=r.i18n.translate("xpack.securitySolution.eventFilter.form.name.label",{defaultMessage:"Name"}),f=r.i18n.translate("xpack.securitySolution.eventFilter.form.description.placeholder",{defaultMessage:"Description"}),b=r.i18n.translate("xpack.securitySolution.eventFilter.form.name.error",{defaultMessage:"The name can't be empty"}),y=r.i18n.translate("xpack.securitySolution.eventFilter.form.os.label",{defaultMessage:"Select operating system"}),h=r.i18n.translate("xpack.securitySolution.eventFilter.form.rule.name",{defaultMessage:"Endpoint Event Filtering"}),v={pageTitle:r.i18n.translate("xpack.securitySolution.eventFilters.pageTitle",{defaultMessage:"Event Filters"}),pageAboutInfo:r.i18n.translate("xpack.securitySolution.eventFilters.pageAboutInfo",{defaultMessage:"Event filters exclude high volume or unwanted events from being written to Elasticsearch."}),pageAddButtonTitle:r.i18n.translate("xpack.securitySolution.eventFilters.pageAddButtonTitle",{defaultMessage:"Add event filter"}),getShowingCountLabel:e=>r.i18n.translate("xpack.securitySolution.eventFilters.showingTotal",{defaultMessage:"Showing {total} {total, plural, one {event filter} other {event filters}}",values:{total:e}}),cardActionEditLabel:r.i18n.translate("xpack.securitySolution.eventFilters.cardActionEditLabel",{defaultMessage:"Edit event filter"}),cardActionDeleteLabel:r.i18n.translate("xpack.securitySolution.eventFilters.cardActionDeleteLabel",{defaultMessage:"Delete event filter"}),flyoutCreateTitle:r.i18n.translate("xpack.securitySolution.eventFilters.flyoutCreateTitle",{defaultMessage:"Add event filter"}),flyoutEditTitle:r.i18n.translate("xpack.securitySolution.eventFilters.flyoutEditTitle",{defaultMessage:"Edit event filter"}),flyoutCreateSubmitButtonLabel:r.i18n.translate("xpack.securitySolution.eventFilters.flyoutCreateSubmitButtonLabel",{defaultMessage:"Add event filter"}),flyoutCreateSubmitSuccess:({name:e})=>r.i18n.translate("xpack.securitySolution.eventFilters.flyoutCreateSubmitSuccess",{defaultMessage:'"{name}" has been added to the event filters list.',values:{name:e}}),flyoutEditSubmitSuccess:({name:e})=>r.i18n.translate("xpack.securitySolution.eventFilters.flyoutEditSubmitSuccess",{defaultMessage:'"{name}" has been updated.',values:{name:e}}),flyoutDowngradedLicenseDocsInfo:e=>i.a.createElement(i.a.Fragment,null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.eventFilters.flyoutDowngradedLicenseDocsInfo",defaultMessage:"For more information, see our "}),i.a.createElement(s.EuiLink,{target:"_blank",href:`${e.eventFilters}`},i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.eventFilters.flyoutDowngradedLicenseDocsLink",defaultMessage:"Event filters documentation"}))),deleteActionSuccess:e=>r.i18n.translate("xpack.securitySolution.eventFilters.deleteSuccess",{defaultMessage:'"{itemName}" has been removed from event filters list.',values:{itemName:e}}),emptyStateTitle:r.i18n.translate("xpack.securitySolution.eventFilters.emptyStateTitle",{defaultMessage:"Add your first event filter"}),emptyStateInfo:r.i18n.translate("xpack.securitySolution.eventFilters.emptyStateInfo",{defaultMessage:"Add an event filter to exclude high volume or unwanted events from being written to Elasticsearch."}),emptyStatePrimaryButtonLabel:r.i18n.translate("xpack.securitySolution.eventFilters.emptyStatePrimaryButtonLabel",{defaultMessage:"Add event filter"}),searchPlaceholderInfo:r.i18n.translate("xpack.securitySolution.eventFilters.searchPlaceholderInfo",{defaultMessage:"Search on the fields below: name, description, comments, value"})},E=Object(a.memo)((()=>{const e=Object(l.j)(),t=u.a.getInstance(e);return i.a.createElement(c.a,{apiClient:t,ArtifactFormComponent:d.a,labels:v,"data-test-subj":"EventFiltersListPage",searchableFields:p.d,flyoutSize:"l"})}));E.displayName="EventFiltersList"},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=e=>null==e?[]:null!=e.host&&null!=e.host.name?[{fieldName:"host.name",fieldValue:e.host.name[0]}]:[]},function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return d}));var a=n(34),i=n(266),r=n(137),o=n(600),s=n(579),l=n(2);const c=i.c.UsersType.details,u={[r.UsersTableType.allUsers]:s.a,[r.UsersTableType.authentications]:s.c,[r.UsersTableType.anomalies]:s.b,[r.UsersTableType.risk]:s.e,[r.UsersTableType.events]:s.d,[r.UsersTableType.risk]:s.e},d=(e,t)=>{let n=[];if(null!=e.detailName&&(n=[{text:e.detailName,href:t({path:Object(o.c)(e.detailName,""),deepLinkId:l.a.users})}]),null!=e.tabName){const t=Object(a.get)("tabName",e);if(!t)return n;n=[...n,{text:u[t],href:""}]}return n}},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return pe}));var a=n(4),i=n.n(a),r=n(78),o=n(81),s=n(79),l=n(86),c=n(12),u=n(599),d=n(158),p=n(35),m=n(33),g=n.n(m),f=n(913),b=n(247),y=n(227),h=n(32),v=n(121),E=n(37),x=n(84),k=n(608);const S=({onComplete:e,isEnableDownloader:t,exportedIds:n})=>{const{tabName:i}=Object(E.useParams)(),{addSuccess:r}=Object(x.a)(),o=Object(a.useCallback)((t=>{null!=e&&e(),r({title:i===s.n.template?v.S(t):v.R(t),"data-test-subj":"addObjectToContainerSuccess"})}),[r,e,i]),l=Object(a.useCallback)((()=>{null!=e&&e()}),[e]);return Object(a.useEffect)((()=>{(async()=>{if(null!=n&&n.length&&t){const e=await Object(y.b)({ids:n});e instanceof Blob?(Object(k.a)(e,`${v.l}.ndjson`),o(n.length)):l()}})()}),[n,t]),null};S.displayName="ExportTimeline";const w=i.a.memo(S);var j=n(34);const O=i.a.memo((({title:e,closeModal:t,onDelete:n})=>{const{tabName:r}=Object(E.useParams)(),o=r===s.n.template?v.h:v.i,l=Object(a.useCallback)((()=>{const t=null!=e?e.trim():"",n=Object(j.isEmpty)(t)?v.Y:t;return i.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.open.timeline.deleteTimelineModalTitle",defaultMessage:'Delete "{title}"?',"data-test-subj":"title",values:{title:n}})}),[e]);return i.a.createElement(h.EuiConfirmModal,{buttonColor:"danger",cancelButtonText:v.b,confirmButtonText:v.f,defaultFocusedButton:h.EUI_MODAL_CONFIRM_BUTTON,onCancel:t,onConfirm:n,title:l()},i.a.createElement("div",{"data-test-subj":"warning"},o))}));O.displayName="DeleteTimelineModal";const I=Object(m.createGlobalStyle)(["div[data-popover-open]{display:none;}"]),T=i.a.memo((({deleteTimelines:e,isModalOpen:t,savedObjectIds:n,title:r,onComplete:o})=>{const{addSuccess:l}=Object(x.a)(),{tabName:c}=Object(E.useParams)(),u=Object(a.useCallback)((()=>{null!=o&&o()}),[o]),d=Object(a.useCallback)((()=>{n.length>0&&(e(n),l({title:c===s.n.template?v.Q(n.length):v.P(n.length)})),null!=o&&o()}),[e,n,o,l,c]);return i.a.createElement(i.a.Fragment,null,t&&i.a.createElement(I,{"data-test-subj":"remove-popover"}),t?i.a.createElement(h.EuiModal,{maxWidth:600,onClose:u},i.a.createElement(O,{"data-test-subj":"delete-timeline-modal",onDelete:d,title:r,closeModal:u})):null)}));T.displayName="DeleteTimelineModalOverlay";const C=({deleteTimelines:e,ids:t,isEnableDownloader:n,isDeleteTimelineModalOpen:a,onComplete:r,title:o})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(w,{"data-test-subj":"TimelineDownloader",exportedIds:t,isEnableDownloader:n,onComplete:r}),null!=e&&i.a.createElement(T,{"data-test-subj":"DeleteTimelineModalOverlay",deleteTimelines:e,isModalOpen:a,onComplete:r,savedObjectIds:t,title:o})),M=i.a.memo(C),N=()=>{const[e,t]=Object(a.useState)(null),[n,i]=Object(a.useState)(!1),[r,o]=Object(a.useState)(!1),s=Object(a.useCallback)((()=>{i(!1),t(null)}),[e]),l=Object(a.useCallback)((e=>{i(!0),null!=e&&t(e)}),[]),c=Object(a.useCallback)((e=>{o(!0),null!=e&&t(e)}),[]),u=Object(a.useCallback)((()=>{o(!1),t(null)}),[]);return{actionItem:e,onCompleteEditTimelineAction:Object(a.useCallback)((()=>{i(!1),o(!1),t(null)}),[]),isDeleteTimelineModalOpen:n,onCloseDeleteTimelineModal:s,onOpenDeleteTimelineModal:l,isEnableDownloader:r,enableExportTimelineDownloader:c,disableExportTimelineDownloader:u}},D=g.a.div.withConfig({displayName:"SearchRowContainer",componentId:"sc-12vyhis-0"})(["&:not(:last-child){margin-bottom:",";}"],(e=>e.theme.eui.euiSizeL));D.displayName="SearchRowContainer";const F=g()(h.EuiFlexGroup).withConfig({displayName:"SearchRowFlexGroup",componentId:"sc-12vyhis-1"})(["margin-bottom:",";"],(e=>e.theme.eui.euiSizeXS));F.displayName="SearchRowFlexGroup";const A=i.a.memo((({favoriteCount:e,onlyFavorites:t,onQueryChange:n,onToggleOnlyFavorites:r,children:o,timelineType:l})=>{const c=Object(a.useMemo)((()=>({placeholder:l===s.n.default?v.J:v.K,incremental:!1,"data-test-subj":"search-bar"})),[l]);return i.a.createElement(D,null,i.a.createElement(F,{gutterSize:"s"},i.a.createElement(h.EuiFlexItem,null,i.a.createElement(h.EuiSearchBar,{box:c,onChange:n})),i.a.createElement(h.EuiFlexItem,{grow:!1},i.a.createElement(h.EuiFilterGroup,{fullWidth:!0},i.a.createElement(i.a.Fragment,null,i.a.createElement(h.EuiFilterButton,{"data-test-subj":"only-favorites-toggle",hasActiveFilters:t,onClick:r,numFilters:null!=e?e:void 0},v.B),!!o&&o)))))}));A.displayName="SearchRow";var _=n(82),R=n.n(_);const P=({actionTimelineToShow:e,deleteTimelines:t,enableExportTimelineDownloader:n,onOpenDeleteTimelineModal:a,onOpenTimeline:i})=>[{width:"80px",actions:[{name:v.e,icon:"timeline",onClick:({savedObjectId:e})=>{i({duplicate:!0,timelineType:s.n.default,timelineId:e})},type:"icon",enabled:({savedObjectId:e})=>null!=e,description:v.e,"data-test-subj":"create-from-template",available:t=>t.timelineType===s.n.template&&e.includes("createFrom")},{name:v.d,icon:"visText",onClick:({savedObjectId:e})=>{i({duplicate:!0,timelineType:s.n.template,timelineId:e})},type:"icon",enabled:({savedObjectId:e})=>null!=e,description:v.d,"data-test-subj":"create-template-from-timeline",available:t=>t.timelineType!==s.n.template&&e.includes("createFrom")},{name:v.C,icon:"copy",onClick:({savedObjectId:e})=>{i({duplicate:!0,timelineId:null!=e?e:""})},type:"icon",enabled:({savedObjectId:e})=>null!=e,description:v.C,"data-test-subj":"open-duplicate",available:t=>t.timelineType!==s.n.template&&e.includes("duplicate")},{name:v.D,icon:"copy",onClick:({savedObjectId:e})=>{i({duplicate:!0,timelineId:null!=e?e:""})},type:"icon",enabled:({savedObjectId:e})=>null!=e,description:v.D,"data-test-subj":"open-duplicate-template",available:t=>t.timelineType===s.n.template&&e.includes("duplicate")},{name:v.m,icon:"exportAction",onClick:e=>{null!=n&&n(e)},enabled:e=>null!=e.savedObjectId&&e.status!==s.l.immutable,description:v.m,"data-test-subj":"export-timeline",available:()=>e.includes("export")},{name:v.g,icon:"trash",onClick:e=>{null!=a&&a(e)},enabled:({savedObjectId:e,status:t})=>null!=e&&t!==s.l.immutable,description:v.g,"data-test-subj":"delete-timeline",available:()=>e.includes("delete")&&null!=t}]}],L="45px";var q=n(136),B=n(846),z=n(87),$=n(101);const V=g.a.span.withConfig({displayName:"LineClampTextContainer",componentId:"sc-oh8wsp-0"})(["text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:5;-webkit-box-orient:vertical;overflow:hidden;"]),U=({itemIdToExpandedNotesRowMap:e,onOpenTimeline:t,onToggleShowNotes:n,timelineType:a})=>[{isExpander:!0,render:({notes:t,savedObjectId:a})=>null!=t&&t.length>0&&null!=a?i.a.createElement(h.EuiButtonIcon,{"data-test-subj":"expand-notes",onClick:()=>null!=e[a]?n(Object(j.omit)(a,e)):n({...e,[a]:i.a.createElement(B.a,{notes:t})}),"aria-label":e[a]?v.c:v.k,iconType:e[a]?"arrowDown":"arrowRight"}):null,width:L},{dataType:"string",field:"title",name:a===s.n.default?v.W:v.X,render:(e,n)=>null!=n.savedObjectId?i.a.createElement(h.EuiLink,{"data-test-subj":`title-${n.savedObjectId}`,onClick:()=>t({duplicate:!1,timelineId:`${n.savedObjectId}`})},Object(q.f)(n)?v.Y:i.a.createElement(V,null,e)):i.a.createElement("div",{"data-test-subj":`title-no-saved-object-id-${e||"no-title"}`},Object(q.f)(n)?v.Y:e),sortable:!1},{dataType:"string",field:"description",name:v.j,render:e=>i.a.createElement(V,{"data-test-subj":"description"},null!=e&&e.trim().length>0?e:Object(z.d)()),sortable:!1},{dataType:"date",field:"updated",name:v.w,render:(e,t)=>i.a.createElement("div",{"data-test-subj":"updated"},null!=t.updated?i.a.createElement($.b,{value:e}):Object(z.d)()),sortable:!0}],H=e=>e?[{dataType:"string",field:"updatedBy",name:v.z,render:e=>i.a.createElement("div",{"data-test-subj":"username"},Object(z.a)(e)),sortable:!1}]:[],G=({timelineType:e})=>{const t={note:{align:"center",field:"eventIdToNoteIds",name:i.a.createElement(h.EuiToolTip,{content:v.A},i.a.createElement(h.EuiIcon,{"data-test-subj":"notes-count-header-icon",size:"m",type:"editorComment"})),render:(e,t)=>i.a.createElement("span",{"data-test-subj":"notes-count"},Object(q.d)(t)),sortable:!1,width:L},pinnedEvent:{align:"center",field:"pinnedEventIds",name:i.a.createElement(h.EuiToolTip,{content:v.H},i.a.createElement(h.EuiIcon,{"data-test-subj":"pinned-event-header-icon",size:"m",type:"pin"})),render:(e,t)=>i.a.createElement("span",{"data-test-subj":"pinned-event-count"},`${Object(q.e)(t)}`),sortable:!1,width:L},favorite:{align:"center",field:"favorite",name:i.a.createElement(h.EuiToolTip,{content:v.n},i.a.createElement(h.EuiIcon,{"data-test-subj":"favorites-header-icon",size:"m",type:"starEmpty"})),render:e=>{const t=null!=e&&e.length>0?"starFilled":"starEmpty";return i.a.createElement(h.EuiIcon,{"data-test-subj":`favorite-${t}-star`,type:t,size:"m"})},sortable:!1,width:L}},n=[t.note,t.favorite],a=[t.pinnedEvent,t.note,t.favorite];return e===s.n.template?n:a},Q=h.EuiBasicTable,W=g()(Q).withConfig({displayName:"BasicTable",componentId:"sc-1ng8ufe-0"})([".euiTableCellContent{animation:none;}.euiTableRow-isExpandedRow .euiTableCellContent__text{width:100%;}"]);W.displayName="BasicTable";const K=i.a.memo((({actionTimelineToShow:e,deleteTimelines:t,defaultPageSize:n,loading:r,itemIdToExpandedNotesRowMap:o,enableExportTimelineDownloader:l,onOpenDeleteTimelineModal:c,onOpenTimeline:u,onSelectionChange:d,onTableChange:p,onToggleShowNotes:m,pageIndex:g,pageSize:f,searchResults:b,showExtendedColumns:y,sortField:h,sortDirection:E,tableRef:x,timelineType:k,totalSearchResultsCount:S})=>{const w={showPerPageOptions:y,pageIndex:g,pageSize:f,pageSizeOptions:[Math.floor(Math.max(n,1)/2),n,2*n],totalItemCount:S},j={sort:{field:h,direction:E}},O={selectable:e=>null!=e.savedObjectId&&e.status!==s.l.immutable,selectableMessage:e=>e?void 0:v.y,onSelectionChange:d},I=null!=x?{ref:x}:{},T=Object(a.useMemo)((()=>(({actionTimelineToShow:e,deleteTimelines:t,enableExportTimelineDownloader:n,itemIdToExpandedNotesRowMap:a,onOpenDeleteTimelineModal:i,onOpenTimeline:r,onToggleShowNotes:o,showExtendedColumns:s,timelineType:l})=>[...U({itemIdToExpandedNotesRowMap:a,onOpenTimeline:r,onToggleShowNotes:o,timelineType:l}),...H(s),...G({timelineType:l}),...e.length?P({actionTimelineToShow:e,deleteTimelines:t,enableExportTimelineDownloader:n,onOpenDeleteTimelineModal:i,onOpenTimeline:r}):[]])({actionTimelineToShow:e,deleteTimelines:t,itemIdToExpandedNotesRowMap:o,enableExportTimelineDownloader:l,onOpenDeleteTimelineModal:c,onOpenTimeline:u,onSelectionChange:d,onToggleShowNotes:m,showExtendedColumns:y,timelineType:k})),[e,t,o,l,c,u,d,m,y,k]),C=r||null==b?v.x:k===s.n.template?v.bb:v.ab;return i.a.createElement(W,R()({columns:T,"data-test-subj":"timelines-table",isExpandable:!0,isSelectable:e.includes("selectable"),itemId:"savedObjectId",itemIdToExpandedRowMap:o,items:null!=b?b:[],loading:r,noItemsMessage:C,onChange:p,pagination:w,selection:e.includes("selectable")?O:void 0,sorting:j},I))}));K.displayName="TimelinesTable";const Y=g.a.span.withConfig({displayName:"QueryText",componentId:"sc-hd5h98-0"})(["white-space:normal;word-break:break-word;"]),J=i.a.memo((({deleteTimelines:e,defaultPageSize:t,favoriteCount:n,isLoading:r,itemIdToExpandedNotesRowMap:o,importDataModalToggle:l,onDeleteSelected:c,onlyFavorites:u,onOpenTimeline:d,onQueryChange:m,onSelectionChange:g,onTableChange:E,onToggleOnlyFavorites:x,onToggleShowNotes:k,pageIndex:S,pageSize:w,query:j,refetch:O,searchResults:I,selectedItems:T,sortDirection:C,setImportDataModalToggle:D,sortField:F,timelineType:_=s.n.default,timelineStatus:R,timelineFilter:P,templateTimelineFilter:L,totalSearchResultsCount:B})=>{var z;const $=Object(a.useRef)(),{actionItem:V,enableExportTimelineDownloader:U,isEnableDownloader:H,isDeleteTimelineModalOpen:G,onOpenDeleteTimelineModal:Q,onCompleteEditTimelineAction:W}=N(),{getBatchItemsPopoverContent:J}=(({deleteTimelines:e,selectedItems:t,tableRef:n,timelineType:r=s.n.default})=>{const{enableExportTimelineDownloader:o,disableExportTimelineDownloader:l,isEnableDownloader:c,isDeleteTimelineModalOpen:u,onOpenDeleteTimelineModal:d,onCloseDeleteTimelineModal:p}=N(),m=Object(a.useCallback)((e=>{null!=e&&e(),null!=n&&null!=n.current&&n.current.changeSelection([]),l(),p()}),[l,p,n]),g=Object(a.useMemo)((()=>{return e=null!=t?t:[],(Array.isArray(e)?e:[e]).reduce(((e,t)=>null!=t.savedObjectId?[...e,t.savedObjectId]:[...e]),[]);var e}),[t]),f=Object(a.useCallback)((()=>o()),[o]),b=Object(a.useCallback)((()=>d()),[d]),y=Object(a.useCallback)((n=>{var a,o,l,d;const p=null==t||0===t.length;return i.a.createElement(i.a.Fragment,null,i.a.createElement(M,{deleteTimelines:e,ids:g,isEnableDownloader:c,isDeleteTimelineModalOpen:u,onComplete:m.bind(null,n),title:1!==(null==t?void 0:t.length)?r===s.n.template?v.L(null!==(a=null==t?void 0:t.length)&&void 0!==a?a:0):v.M(null!==(o=null==t?void 0:t.length)&&void 0!==o?o:0):null!==(l=null===(d=t[0])||void 0===d?void 0:d.title)&&void 0!==l?l:""}),i.a.createElement(h.EuiContextMenuPanel,{items:[i.a.createElement(h.EuiContextMenuItem,{"data-test-subj":"export-timeline-action",disabled:p,icon:"exportAction",key:"ExportItemKey",onClick:f},v.m),i.a.createElement(h.EuiContextMenuItem,{"data-test-subj":"delete-timeline-action",disabled:p,icon:"trash",key:"DeleteItemKey",onClick:b},v.g)]}))}),[t,e,g,c,u,m,r,f,b]);return{onCompleteBatchActions:m,getBatchItemsPopoverContent:y}})({deleteTimelines:e,selectedItems:T,tableRef:$,timelineType:_}),X=Object(a.useMemo)((()=>i.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.open.timeline.showingNTemplatesLabel",defaultMessage:"{totalSearchResultsCount} {totalSearchResultsCount, plural, one {template} other {templates}} {with}",values:{totalSearchResultsCount:B,with:i.a.createElement(Y,{"data-test-subj":"selectable-query-text"},j.trim().length?`${v.Z} "${j.trim()}"`:"")}})),[B,j]),Z=Object(a.useMemo)((()=>i.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.open.timeline.showingNTimelinesLabel",defaultMessage:"{totalSearchResultsCount} {totalSearchResultsCount, plural, one {timeline} other {timelines}} {with}",values:{totalSearchResultsCount:B,with:i.a.createElement(Y,{"data-test-subj":"selectable-query-text"},j.trim().length?`${v.Z} "${j.trim()}"`:"")}})),[B,j]),ee=Object(a.useMemo)((()=>null!=V&&null!=V.savedObjectId?[V.savedObjectId]:[]),[V]),te=Object(a.useCallback)((()=>{null!=O&&O()}),[O]),ne=Object(a.useCallback)((()=>{null!=D&&D(!1)}),[D]),ae=Object(a.useCallback)((()=>{null!=D&&D(!1),null!=O&&O()}),[D,O]),ie=Object(a.useMemo)((()=>{const t=["createFrom","duplicate"];return R!==s.l.immutable&&(t.push("export"),t.push("selectable")),null!=c&&null!=e&&R!==s.l.immutable&&t.push("delete"),t}),[c,e,R]),re=Object(a.useMemo)((()=>i.a.createElement(i.a.Fragment,null,L)),[L]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(M,{deleteTimelines:e,ids:ee,isDeleteTimelineModalOpen:G,isEnableDownloader:H,onComplete:W,title:null!==(z=null==V?void 0:V.title)&&void 0!==z?z:v.Y}),i.a.createElement(f.a,{checkBoxLabel:v.G,closeModal:ne,description:v.N,errorMessage:v.r,failedDetailed:v.s,importComplete:ae,importData:y.e,successMessage:v.T,showCheckBox:!1,showModal:null!=l&&l,submitBtnText:v.u,subtitle:v.v,title:v.t}),i.a.createElement("div",{className:q.a},!!P&&P,i.a.createElement(A,{"data-test-subj":"search-row",favoriteCount:n,onlyFavorites:u,onQueryChange:m,onToggleOnlyFavorites:x,query:j,timelineType:_},re),i.a.createElement(b.a,{border:!0},i.a.createElement(b.d,null,i.a.createElement(b.c,null,i.a.createElement(b.e,{"data-test-subj":"query-message"},i.a.createElement(i.a.Fragment,null,v.O," ",_===s.n.template?X:Z))),i.a.createElement(b.c,null,R!==s.l.immutable&&i.a.createElement(i.a.Fragment,null,i.a.createElement(b.e,{"data-test-subj":"selected-count"},_===s.n.template?v.L(T.length):v.M(T.length)),i.a.createElement(b.b,{dataTestSubj:"batchActions",iconSide:"right",iconType:"arrowDown",popoverContent:J,"data-test-subj":"utility-bar-action"},i.a.createElement("span",{"data-test-subj":"utility-bar-action-button"},v.a))),i.a.createElement(b.b,{dataTestSubj:"refreshButton",iconSide:"right",iconType:"refresh",onClick:te},v.I)))),i.a.createElement(K,{actionTimelineToShow:ie,"data-test-subj":"timelines-table",deleteTimelines:e,defaultPageSize:t,loading:r,itemIdToExpandedNotesRowMap:o,enableExportTimelineDownloader:U,onOpenDeleteTimelineModal:Q,onOpenTimeline:d,onSelectionChange:g,onTableChange:E,onToggleShowNotes:k,pageIndex:S,pageSize:w,searchResults:I,showExtendedColumns:!0,sortDirection:C,sortField:F,timelineType:_,tableRef:$,totalSearchResultsCount:B})))}));J.displayName="OpenTimeline";var X=n(119);const Z=i.a.memo((({children:e,onAddTimelinesToFavorites:t,selectedTimelinesCount:n,title:a})=>i.a.createElement(X.a,{title:a,split:!0,height:40},i.a.createElement(h.EuiFlexGroup,{gutterSize:"s",responsive:!1},t&&i.a.createElement(h.EuiFlexItem,{grow:!1},i.a.createElement(h.EuiButton,{"data-test-subj":"favorite-selected",iconSide:"left",iconType:"starEmptySpace",isDisabled:0===n,onClick:t},v.o)),e&&i.a.createElement(h.EuiFlexItem,null,e)))));Z.displayName="TitleRow";const ee=g.a.div.withConfig({displayName:"HeaderContainer",componentId:"sc-1nojoni-0"})(["width:100%;"]);ee.displayName="HeaderContainer";const te=Object(a.memo)((({deleteTimelines:e,defaultPageSize:t,favoriteCount:n,hideActions:r=[],isLoading:o,itemIdToExpandedNotesRowMap:s,onAddTimelinesToFavorites:l,onDeleteSelected:c,onlyFavorites:u,onOpenTimeline:d,onQueryChange:p,onSelectionChange:m,onTableChange:g,onToggleOnlyFavorites:f,onToggleShowNotes:b,pageIndex:y,pageSize:v,searchResults:E,selectedItems:x,sortDirection:k,sortField:S,timelineFilter:w,timelineType:j,templateTimelineFilter:O,title:I,totalSearchResultsCount:T})=>{const C=Object(a.useMemo)((()=>{const t=["createFrom","duplicate"];return null!=c&&null!=e&&t.push("delete"),t.filter((e=>!r.includes(e)))}),[c,e,r]),M=Object(a.useMemo)((()=>i.a.createElement(a.Fragment,{key:"search-row-content"},!!O&&O)),[O]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(h.EuiModalHeader,null,i.a.createElement(ee,null,i.a.createElement(Z,{"data-test-subj":"title-row",onAddTimelinesToFavorites:l,selectedTimelinesCount:x.length,title:I}))),i.a.createElement(h.EuiModalBody,null,i.a.createElement(i.a.Fragment,null,!!w&&i.a.createElement(i.a.Fragment,null,w,i.a.createElement(h.EuiSpacer,{size:"m"})),i.a.createElement(A,{"data-test-subj":"search-row",onlyFavorites:u,onQueryChange:p,onToggleOnlyFavorites:f,query:"",timelineType:j},M),i.a.createElement(K,{actionTimelineToShow:C,"data-test-subj":"timelines-table",deleteTimelines:e,defaultPageSize:t,loading:o,itemIdToExpandedNotesRowMap:s,onOpenTimeline:d,onSelectionChange:m,onTableChange:g,onToggleShowNotes:b,pageIndex:y,pageSize:v,searchResults:E,showExtendedColumns:!1,sortDirection:k,sortField:S,timelineType:j,totalSearchResultsCount:T}))))}));te.displayName="OpenTimelineModalBody";var ne=n(2),ae=n(128);let ie;!function(e){e.tab="tab",e.filter="filter"}(ie||(ie={}));var re=n(77),oe=n(857),se=n(95),le=n(94),ce=n(154),ue=n(179);const de=i.a.memo((({closeModalTimeline:e,defaultPageSize:t,hideActions:n=[],isModal:p=!1,importDataModalToggle:m,onOpenTimeline:g,setImportDataModalToggle:f,title:b})=>{const x=Object(r.useDispatch)(),{startTransaction:k}=Object(ce.a)(),[S,w]=Object(a.useState)({}),[O,I]=Object(a.useState)(!1),[T,C]=Object(a.useState)(0),[M,N]=Object(a.useState)(t),[D,F]=Object(a.useState)(""),[A,_]=Object(a.useState)([]),[R,P]=Object(a.useState)("desc"),[L,B]=Object(a.useState)("updated"),z=Object(a.useMemo)((()=>l.b.getTimelineByIdSelector()),[]),$=Object(o.b)((e=>{var t,n;return null!==(t=null===(n=z(e,s.j.active))||void 0===n?void 0:n.savedObjectId)&&void 0!==t?t:""})),{dataViewId:V,selectedPatterns:U}=Object(le.d)(se.SourcererScopeName.timeline),H=Object(a.useMemo)((()=>Object(q.b)(x)),[x]),G=Object(a.useCallback)((e=>x(Object(c.updateIsLoading)(e))),[x]),{customTemplateTimelineCount:Q,defaultTimelineCount:W,elasticTemplateTimelineCount:K,favoriteCount:Y,fetchAllTimeline:X,timelines:Z,loading:ee,totalCount:de,templateTimelineCount:pe}=Object(u.b)(),{timelineType:me,timelineTabs:ge,timelineFilters:fe}=(({defaultTimelineCount:e,templateTimelineCount:t})=>{const{formatUrl:n,search:r}=Object(ae.n)(ne.a.timelines),{navigateToUrl:o}=Object(re.k)().services.application,{tabName:l}=Object(E.useParams)(),[c,u]=Object(a.useState)(l===s.n.default||l===s.n.template?l:s.n.default),d=n(Object(ae.l)(s.n.default,r)),p=n(Object(ae.l)(s.n.template,r)),m=Object(a.useCallback)((e=>{e.preventDefault(),o(d)}),[o,d]),g=Object(a.useCallback)((e=>{e.preventDefault(),o(p)}),[o,p]),f=Object(a.useCallback)((e=>[{id:s.n.default,name:v.V,href:d,disabled:!1,onClick:e===ie.tab?m:j.noop},{id:s.n.template,name:v.U,href:p,disabled:!1,onClick:e===ie.tab?g:j.noop}]),[d,p,m,g]),b=Object(a.useCallback)(((e,t)=>{u((t=>(t!==e&&u(e),t)))}),[u]),y=Object(a.useMemo)((()=>i.a.createElement(i.a.Fragment,null,i.a.createElement(h.EuiTabs,{"data-test-subj":"open-timeline-subtabs"},f(ie.tab).map((e=>i.a.createElement(h.EuiTab,{"data-test-subj":`timeline-${ie.tab}-${e.id}`,isSelected:e.id===l,disabled:e.disabled,key:`timeline-${ie.tab}-${e.id}`,href:e.href,onClick:t=>{e.onClick(t),b(e.id,ie.tab)}},e.name)))),i.a.createElement(h.EuiSpacer,{size:"m"}))),[l]),x=Object(a.useMemo)((()=>i.a.createElement(h.EuiTabs,null,f(ie.filter).map((e=>i.a.createElement(h.EuiTab,{"data-test-subj":`open-timeline-modal-body-${ie.filter}-${e.id}`,isSelected:e.id===c,key:`timeline-${ie.filter}-${e.id}`,onClick:t=>{e.onClick(t),b(e.id,ie.filter)}},e.name))))),[c,f,b]);return{timelineType:c,timelineTabs:y,timelineFilters:x}})({defaultTimelineCount:W,templateTimelineCount:pe}),{timelineStatus:be,templateTimelineFilter:ye,installPrepackagedTimelines:he}=Object(oe.a)({timelineType:me,customTemplateTimelineCount:Q,elasticTemplateTimelineCount:K}),ve=Object(a.useCallback)((()=>{X({pageInfo:{pageIndex:T+1,pageSize:M},search:D,sort:{sortField:L,sortOrder:R},onlyUserFavorite:O,timelineType:me,status:be})}),[X,T,M,D,L,R,me,be,O]),Ee=Object(a.useCallback)((e=>{F(e.queryText.trim())}),[]),xe=Object(a.useCallback)((async e=>{k({name:e.length>1?ue.f.BULK_DELETE:ue.f.DELETE}),e.includes($)&&x(Object(c.createTimeline)({id:s.j.active,columns:d.b,dataViewId:V,indexNames:U,show:!1})),await Object(y.a)(e),ve()}),[k,$,ve,x,V,U]),ke=Object(a.useCallback)((async e=>{await xe(e)}),[xe]),Se=Object(a.useCallback)((async()=>{await xe((e=>e.reduce(((e,t)=>null!=t.savedObjectId?[...e,t.savedObjectId]:e),[]))(A)),Te()}),[A,xe]),we=Object(a.useCallback)((e=>{_(e)}),[]),je=Object(a.useCallback)((({page:e,sort:t})=>{const{index:n,size:a}=e,{field:i,direction:r}=t;C(n),N(a),P(r),B(i)}),[]),Oe=Object(a.useCallback)((()=>{I(!O)}),[O]),Ie=Object(a.useCallback)((e=>{w(e)}),[]),Te=Object(a.useCallback)((()=>{_([])}),[]),Ce=Object(a.useCallback)((({duplicate:t,timelineId:n,timelineType:a})=>{t&&k({name:ue.f.DUPLICATE}),p&&null!=e&&e(),Object(q.h)({duplicate:t,onOpenTimeline:g,timelineId:n,timelineType:a,updateIsLoading:G,updateTimeline:H})}),[G,H]);return Object(a.useEffect)((()=>{(()=>{const e=document.querySelector(`.${q.a} input`);null!=e&&e.focus()})()}),[]),Object(a.useEffect)((()=>{(async()=>{await he(),ve()})()}),[ve,he]),p?i.a.createElement(te,{"data-test-subj":"open-timeline-modal",deleteTimelines:ke,defaultPageSize:t,favoriteCount:Y,hideActions:n,isLoading:ee,itemIdToExpandedNotesRowMap:S,onAddTimelinesToFavorites:void 0,onlyFavorites:O,onOpenTimeline:Ce,onQueryChange:Ee,onSelectionChange:we,onTableChange:je,onToggleOnlyFavorites:Oe,onToggleShowNotes:Ie,pageIndex:T,pageSize:M,query:D,searchResults:Z,selectedItems:A,sortDirection:R,sortField:L,templateTimelineFilter:ye,timelineType:me,timelineStatus:be,timelineFilter:fe,title:b,totalSearchResultsCount:de}):i.a.createElement(J,{"data-test-subj":"open-timeline",deleteTimelines:ke,defaultPageSize:t,favoriteCount:Y,isLoading:ee,itemIdToExpandedNotesRowMap:S,importDataModalToggle:m,onAddTimelinesToFavorites:void 0,onDeleteSelected:Se,onlyFavorites:O,onOpenTimeline:Ce,onQueryChange:Ee,onSelectionChange:we,onTableChange:je,onToggleOnlyFavorites:Oe,onToggleShowNotes:Ie,pageIndex:T,pageSize:M,query:D,refetch:ve,searchResults:Z,setImportDataModalToggle:f,selectedItems:A,sortDirection:R,sortField:L,templateTimelineFilter:ye,timelineType:me,timelineStatus:be,timelineFilter:ge,title:b,totalSearchResultsCount:de})})),pe=i.a.memo(de)},,function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(4),i=n(7),r=n(969),o=n.n(r);const s=(e,t)=>null==t?`${Object(i.capitalize)(e)}`:`${Object(i.capitalize)(e)} ${Object(i.capitalize)(t)}`,l=e=>{var t;return null!==(t=o.a.valid(o.a.coerce(e)))&&void 0!==t?t:""},c=(e,t,n)=>`app/integrations/detail/${n?`${e}-${n}`:e}/overview${t?`?integration=${t}`:""}`;var u=n(39);const d=`${n(1).Jb}/fleet/integrations/installed`;var p=n(77);const m=()=>p.b.get().http,g=e=>{const{data:t}=(({packages:e})=>Object(u.useQuery)(["installedIntegrations",{packages:e}],(async({signal:t})=>{var n;return null!==(n=(await(e=>{var t;const{packages:n,signal:a}=e;return m().fetch(d,{method:"GET",query:{packages:null==n||null===(t=n.sort())||void 0===t?void 0:t.join(",")},signal:a})})({packages:e,signal:t})).installed_integrations)&&void 0!==n?n:[]}),{keepPreviousData:!0,staleTime:3e5,onError:e=>{}}))({packages:[]});return Object(a.useMemo)((()=>{const n=((e,t)=>((e,t)=>e.map((e=>{if(null==t)return{related:e,installed:null,isLoaded:!1};{const n=t.find((t=>t.package_name===e.package&&(null==t?void 0:t.integration_name)===(null==e?void 0:e.integration)));return{related:e,installed:null!=n?n:null,isLoaded:!0}}})))(e,t).map((e=>(e=>{var t;const{related:n,installed:a,isLoaded:i}=e,r=n.package,u=null!==(t=n.integration)&&void 0!==t?t:null,d=n.version;if(!i){const e=s(r,u),t=l(d);return{packageName:r,integrationName:u,integrationTitle:e,requiredVersion:d,targetVersion:t,targetUrl:c(r,u,t),installationStatus:{isKnown:!1}}}if(null==a){const e=s(r,u),t=l(d);return{packageName:r,integrationName:u,integrationTitle:e,requiredVersion:d,targetVersion:t,targetUrl:c(r,u,t),installationStatus:{isKnown:!0,isInstalled:!1,isEnabled:!1,isVersionMismatch:!1,installedVersion:""}}}{var p;const e=null!==(p=a.integration_title)&&void 0!==p?p:a.package_title,t=a.package_version,n=o.a.satisfies(t,d),i=n?t:l(d);return{packageName:r,integrationName:u,integrationTitle:e,requiredVersion:d,targetVersion:i,targetUrl:c(r,u,i),installationStatus:{isKnown:!0,isInstalled:!0,isEnabled:a.is_enabled,isVersionMismatch:!n,installedVersion:t}}}})(e))).sort(((e,t)=>e.integrationTitle.localeCompare(t.integrationTitle))))(e,t);return{integrations:n,isLoaded:null!=t}}),[e,t])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return j})),n.d(t,"c",(function(){return h})),n.d(t,"b",(function(){return ie})),n.d(t,"d",(function(){return ce}));var a=n(50),i=n(34),r=n(4),o=n.n(r),s=n(104),l=n(646),c=n(32),u=n(501),d=n(360),p=n(645);const m=({showAlertDetails:e,isolateAction:t})=>o.a.createElement(o.a.Fragment,null,o.a.createElement(c.EuiButtonEmpty,{iconType:"arrowLeft",iconSide:"left",flush:"left",onClick:e},o.a.createElement(c.EuiText,{size:"xs"},o.a.createElement("p",null,p.a))),o.a.createElement(c.EuiTitle,null,o.a.createElement("h2",null,"isolateHost"===t?d.b:d.d))),g=o.a.memo(m),f=({eventId:e,isAlert:t,isHostIsolationPanelOpen:n,isolateAction:a,loading:i,ruleName:r,showAlertDetails:s,timestamp:l})=>o.a.createElement(o.a.Fragment,null,n?o.a.createElement(g,{isolateAction:a,showAlertDetails:s}):o.a.createElement(u.b,{eventId:e,isAlert:t,loading:i,ruleName:r,timestamp:l})),b=o.a.memo(f),y=({eventId:e,isAlert:t,isHostIsolationPanelOpen:n,isolateAction:a,loading:i,ruleName:r,showAlertDetails:s,timestamp:l})=>o.a.createElement(c.EuiFlyoutHeader,{hasBorder:n},o.a.createElement(f,{eventId:e,isAlert:t,isHostIsolationPanelOpen:n,isolateAction:a,loading:i,ruleName:r,showAlertDetails:s,timestamp:l})),h=o.a.memo(y);var v=n(33),E=n.n(v),x=n(246),k=n(700);const S=E()(c.EuiFlyoutBody).withConfig({displayName:"StyledEuiFlyoutBody",componentId:"sc-1yky9hy-0"})([".euiFlyoutBody__overflow{display:flex;flex:1;overflow:hidden;.euiFlyoutBody__overflowContent{flex:1;overflow:hidden;padding:",";}}"],(({theme:e})=>`0 ${e.eui.euiSizeM} ${e.eui.euiSizeM}`)),w=({alertId:e,browserFields:t,detailsData:n,detailsEcsData:a,event:i,handleIsolationActionSuccess:r,handleOnEventClosed:s,hostName:l,isAlert:c,isDraggable:d,isReadOnly:p,isolateAction:m,isHostIsolationPanelOpen:g,isIsolateActionSuccessBannerVisible:f,loading:b,rawEventData:y,showAlertDetails:h,scopeId:v})=>o.a.createElement(S,null,f&&o.a.createElement(x.d,{hostName:l,alertId:e,isolateAction:m}),g?o.a.createElement(k.a,{details:n,cancelCallback:h,successCallback:r,isolateAction:m}):o.a.createElement(u.a,{browserFields:t,detailsData:n,detailsEcsData:a,event:i,isAlert:c,isDraggable:d,loading:b,rawEventData:y,scopeId:v,timelineTabType:"flyout",handleOnEventClosed:s,isReadOnly:p})),j=o.a.memo(w);var O=n(82),I=n.n(O),T=n(78),C=n(99),M=n(316),N=n(205),D=n(116),F=n(289),A=n(35),_=n(926);const R=Object(r.memo)((({endpointId:e,onClick:t})=>{const{handleResponseActionsClick:n,isDisabled:a,tooltip:i}=Object(_.a)({endpointId:e,onClick:t});return o.a.createElement(c.EuiContextMenuItem,{key:"endpointResponseActions-action-item","data-test-subj":"endpointResponseActions-action-item",disabled:a,toolTipContent:i,size:"s",onClick:n},o.a.createElement(A.FormattedMessage,{id:"xpack.securitySolution.endpoint.detections.takeAction.responseActionConsole.buttonLabel",defaultMessage:"Respond"}))}));R.displayName="ResponderContextMenuItem";var P=n(107),L=n(298),q=n(648),B=n(649),z=n(472),$=n(650),V=n(652),U=n(653),H=n(142),G=n(637),Q=n(714),W=n(77),K=n(654);const Y=o.a.memo((({detailsData:e,ecsData:t,handleOnEventClosed:n,indexName:a,isHostIsolationPanelOpen:i,loadingEventDetails:l,onAddEventFilterClick:u,onAddExceptionTypeClick:p,onAddIsolationStatusClick:m,refetch:g,refetchFlyoutData:f,onOsqueryClick:b,scopeId:y})=>{var h;const v=Object(P.a)("tGridEnabled"),{loading:E,canAccessEndpointManagement:x}=Object(D.a)().endpointPrivileges,k=Object(r.useMemo)((()=>!E&&x),[x,E]),{osquery:S}=Object(W.k)().services,[w,j]=Object(r.useState)(!1),O=Object(r.useMemo)((()=>[{category:"kibana",field:"kibana.alert.rule.uuid",name:"ruleId"},{category:"kibana",field:"kibana.alert.rule.name",name:"ruleName"},{category:"kibana",field:"kibana.alert.workflow_status",name:"alertStatus"},{category:"event",field:"event.kind",name:"eventKind"},{category:"_id",field:"_id",name:"eventId"}].reduce(((t,n)=>({...t,[n.name]:Object(L.a)({category:n.category,field:n.field},e)})),{})),[e]),I="event"===O.eventKind,T=Object(r.useMemo)((()=>{var e,n;return null==t||null===(e=t.agent)||void 0===e||null===(n=e.type)||void 0===n?void 0:n.includes("endpoint")}),[t]),A=Object(r.useMemo)((()=>I&&T),[I,T]),_=Object(r.useMemo)((()=>Object(L.a)({category:"agent",field:"agent.id"},e)),[e]),Y=Object(r.useCallback)((()=>{j(!w)}),[w]),J=Object(r.useCallback)((()=>{j(!1)}),[]),X=Object(r.useCallback)((()=>{n(),j(!1)}),[n]),Z=Object(r.useCallback)((e=>{m(e),j(!1)}),[m]),ee=(({closePopover:e,detailsData:t,isHostIsolationPanelOpen:n,onAddIsolationStatusClick:a})=>{const i=Object(r.useMemo)((()=>Object(F.b)({data:t||[]})),[t]),s=Object(r.useMemo)((()=>Object(L.a)({category:"agent",field:"agent.id"},t)),[t]),l=Object(r.useMemo)((()=>Object(L.a)({category:"host",field:"host.os.name"},t)),[t]),u=Object(r.useMemo)((()=>Object(L.a)({category:"agent",field:"agent.version"},t)),[t]),{loading:p,isIsolated:m,agentStatus:g,capabilities:f}=Object(G.a)({agentId:s}),b=Object(r.useMemo)((()=>!!i&&Object(U.a)({osName:l,version:u,capabilities:f})),[u,f,l,i]),y=Object(D.a)().endpointPrivileges.canIsolateHost,h=Object(r.useCallback)((()=>{e(),a(!1===m?"isolateHost":"unisolateHost")}),[e,m,a]),v=!1===m?d.b:d.d;return Object(r.useMemo)((()=>y&&i&&b&&!1===n&&!1===p?[o.a.createElement(c.EuiContextMenuItem,{key:"isolate-host-action-item","data-test-subj":"isolate-host-action-item",disabled:g===H.b.UNENROLLED,onClick:h},v)]:[]),[g,i,n,y,h,v,b,p])})({closePopover:J,detailsData:e,onAddIsolationStatusClick:Z,isHostIsolationPanelOpen:i}),te=((e,t)=>{const n=Object(P.a)("responseActionsConsoleEnabled"),{loading:a,canAccessResponseConsole:i}=Object(D.a)().endpointPrivileges,s=Object(r.useMemo)((()=>Object(F.c)(e||[])),[e]),l=Object(r.useMemo)((()=>Object(F.b)({data:e||[]})),[e]),c=Object(r.useMemo)((()=>Object(L.a)({category:"agent",field:"agent.id"},e)),[e]);return Object(r.useMemo)((()=>{const e=[];return n&&!a&&i&&s&&e.push(o.a.createElement(R,{key:"endpointResponseActions-action-item",endpointId:l?c:"",onClick:t})),e}),[i,c,s,a,l,n,t])})(e,J),ne=Object(r.useCallback)((e=>{p(e),j(!1)}),[p]),{exceptionActionItems:ae}=Object(B.a)({isEndpointAlert:Object(F.a)({ecsData:t}),onAddExceptionTypeClick:ne}),ie=Object(r.useCallback)((()=>{u(),j(!1)}),[u]),{eventFilterActionItems:re}=Object(V.a)({onAddEventFilterClick:ie,disabled:!A||!k}),oe=Object(r.useCallback)((()=>{J()}),[J]),{actionItems:se}=Object(z.a)({alertStatus:O.alertStatus,closePopover:X,eventId:O.eventId,indexName:a,refetch:g,scopeId:y}),{investigateInTimelineActionItems:le}=Object($.a)({ecsRowData:t,onInvestigateInTimelineAlertClick:J}),ce=null==S?void 0:S.isOsqueryAvailable({agentId:_}),ue=Object(r.useCallback)((()=>{b(_),j(!1)}),[b,j,_]),de=Object(r.useMemo)((()=>Object(K.a)({handleClick:ue})),[ue]),pe=Object(r.useMemo)((()=>!I&&O.ruleId?[...se,...ae]:A?re:[]),[re,A,ae,se,I,O.ruleId]),me=[s.c.alertsOnAlertsPage,s.c.alertsOnRuleDetailsPage].includes(y),{addToCaseActionItems:ge,handleAddToNewCaseClick:fe}=Object(Q.a)({ecsData:t,nonEcsData:null!==(h=null==e?void 0:e.map((e=>({field:e.field,value:e.values}))))&&void 0!==h?h:[],onMenuItemClick:oe,onSuccess:f,isActiveTimelines:Object(C.isActiveTimeline)(y),isInDetections:me}),be=Object(r.useMemo)((()=>[...v?ge:[],...pe,...ee,...te,...ce?[de]:[],...le]),[v,ge,pe,ee,te,ce,de,le]),ye=Object(r.useMemo)((()=>o.a.createElement(M.a,{onClick:fe,step:N.a.addAlertToCase,tourId:N.b.alertsCases},o.a.createElement(c.EuiButton,{"data-test-subj":"take-action-dropdown-btn",fill:!0,iconSide:"right",iconType:"arrowDown",onClick:Y},q.d))),[fe,Y]);return be.length&&!l&&t?o.a.createElement(c.EuiPopover,{id:"AlertTakeActionPanel",button:ye,isOpen:w,closePopover:J,panelPaddingSize:"none",anchorPosition:"downLeft",repositionOnScroll:!0},o.a.createElement(c.EuiContextMenuPanel,{"data-test-subj":"takeActionPanelMenu",size:"s",items:be})):null}));var J=n(655),X=n(705),Z=n(706),ee=n(688),te=n(98),ne=n(511);const ae=o.a.memo((({detailsData:e,detailsEcsData:t,expandedEvent:n,handleOnEventClosed:a,isHostIsolationPanelOpen:s,isReadOnly:l,loadingEventDetails:u,onAddIsolationStatusClick:d,scopeId:p,globalQuery:m,timelineQuery:g,refetchFlyoutData:f})=>{var b;const y=null!=t&&null!==(b=t.kibana)&&void 0!==b&&b.alert?null==t?void 0:t._id:null,h=Object(r.useMemo)((()=>{var t,n,a;return null!==(t=null===(n=Object(i.find)({category:"signal",field:"signal.rule.index"},e))||void 0===n?void 0:n.values)&&void 0!==t?t:null===(a=Object(i.find)({category:"kibana",field:"kibana.alert.rule.parameters.index"},e))||void 0===a?void 0:a.values}),[e]),v=Object(r.useMemo)((()=>Array.isArray(h)?h:void 0),[h]),E=Object(r.useMemo)((()=>{var t,n,a;return null!==(t=null===(n=Object(i.find)({category:"signal",field:"signal.rule.data_view_id"},e))||void 0===n?void 0:n.values)&&void 0!==t?t:null===(a=Object(i.find)({category:"kibana",field:"kibana.alert.rule.parameters.data_view_id"},e))||void 0===a?void 0:a.values}),[e]),x=Object(r.useMemo)((()=>Array.isArray(E)?E[0]:void 0),[E]),k=Object(r.useMemo)((()=>[{category:"signal",field:"signal.rule.id",name:"ruleId"},{category:"signal",field:"signal.rule.rule_id",name:"ruleRuleId"},{category:"signal",field:"signal.rule.name",name:"ruleName"},{category:"signal",field:"kibana.alert.workflow_status",name:"alertStatus"},{category:"_id",field:"_id",name:"eventId"}].reduce(((t,n)=>({...t,[n.name]:Object(L.a)({category:n.category,field:n.field},e)})),{})),[e]),S=e=>{e.forEach((e=>e.refetch&&e.refetch()))},w=Object(r.useCallback)((()=>{Object(C.isActiveTimeline)(p)?S([g]):S(m)}),[p,g,m]),{exceptionFlyoutType:j,openAddExceptionFlyout:O,onAddExceptionTypeClick:T,onAddExceptionCancel:M,onAddExceptionConfirm:N}=Object(J.a)({refetch:w,isActiveTimelines:Object(C.isActiveTimeline)(p)}),{closeAddEventFilterModal:D,isAddEventFilterModalOpen:F,onAddEventFilterClick:A}=Object(ee.a)(),[_,R]=Object(r.useState)(null),P=Object(r.useCallback)((()=>{R(null)}),[R]);return l?null:o.a.createElement(o.a.Fragment,null,o.a.createElement(c.EuiFlyoutFooter,{"data-test-subj":"side-panel-flyout-footer"},o.a.createElement(c.EuiFlexGroup,{justifyContent:"flexEnd"},o.a.createElement(c.EuiFlexItem,{grow:!1},t&&o.a.createElement(Y,{detailsData:e,ecsData:t,handleOnEventClosed:a,isHostIsolationPanelOpen:s,loadingEventDetails:u,onAddEventFilterClick:A,onAddExceptionTypeClick:T,onAddIsolationStatusClick:d,refetchFlyoutData:f,refetch:w,indexName:n.indexName,scopeId:p,onOsqueryClick:R})))),O&&null!=k.ruleId&&null!=k.ruleRuleId&&null!=k.eventId&&o.a.createElement(X.a,I()({},k,{ruleIndices:v,ruleDataViewId:x,exceptionListType:j,onCancel:M,onConfirm:N})),F&&null!=t&&o.a.createElement(Z.a,{data:t,onCancel:D,maskProps:{style:"z-index: 5000"}}),_&&null!=t&&o.a.createElement(ne.a,{agentId:_,defaultValues:y?{alertIds:[y]}:void 0,onClose:P,ecsData:t}))})),ie=Object(T.connect)((()=>{const e=te.d.globalQuery(),t=te.d.timelineQueryByIdSelector();return(n,{scopeId:a})=>({globalQuery:e(n),timelineQuery:t(n,a)})}))(o.a.memo(ae));var re=n(590),oe=n(94),se=n(95),le=n(352);const ce=()=>{var e,t;const{browserFields:n,runtimeMappings:c}=Object(oe.d)(se.SourcererScopeName.detections),[u,d]=Object(r.useState)({id:void 0,indexName:void 0}),[p,m,g,f,y]=Object(re.a)({entityType:a.EntityType.EVENTS,indexName:null!==(e=u.indexName)&&void 0!==e?e:"",eventId:null!==(t=u.id)&&void 0!==t?t:"",runtimeMappings:c,skip:!u.id}),{alertId:h,isAlert:v,hostName:E,ruleName:x,timestamp:k}=Object(le.b)(m),{isolateAction:S,isHostIsolationPanelOpen:w,isIsolateActionSuccessBannerVisible:O,handleIsolationActionSuccess:I,showAlertDetails:T,showHostIsolationPanel:C}=Object(l.a)(),M=Object(r.useCallback)((({isLoading:e,alert:t})=>(d((e=>e.id!==t._id?{id:t._id,indexName:t._index}:e)),o.a.createElement(j,{alertId:h,browserFields:n,detailsData:m,detailsEcsData:f,event:{eventId:t._id,indexName:t._index},hostName:null!=E?E:"",handleIsolationActionSuccess:I,handleOnEventClosed:i.noop,isAlert:v,isDraggable:!1,isolateAction:S,isIsolateActionSuccessBannerVisible:O,isHostIsolationPanelOpen:w,loading:e||p,rawEventData:g,showAlertDetails:T,scopeId:s.d.casePage,isReadOnly:!1}))),[h,n,m,f,I,E,v,w,O,S,p,g,T]),N=Object(r.useCallback)((({isLoading:e})=>o.a.createElement(b,{isHostIsolationPanelOpen:w,isAlert:v,eventId:h,isolateAction:S,loading:e||p,ruleName:x,showAlertDetails:T,timestamp:k})),[v,h,w,S,p,x,T,k]),D=Object(r.useCallback)((({isLoading:e,alert:t})=>o.a.createElement(ie,{detailsData:m,detailsEcsData:f,expandedEvent:{eventId:t._id,indexName:t._index},refetchFlyoutData:y,handleOnEventClosed:i.noop,isHostIsolationPanelOpen:w,isReadOnly:!1,loadingEventDetails:e||p,onAddIsolationStatusClick:C,scopeId:s.d.casePage})),[m,f,w,p,y,C]);return Object(r.useMemo)((()=>({body:M,header:N,footer:D})),[M,N,D])}},function(e,t,n){"use strict";n.d(t,"b",(function(){return fe})),n.d(t,"a",(function(){return Me}));var a=n(32),i=n(4),r=n.n(i),o=n(34),s=n(78),l=n(33),c=n.n(l),u=n(35),d=n(42),p=n(90),m=n(81),g=n(79),f=n(86),b=n(112),y=n(387),h=n(1),v=n(12),E=n(77),x=n(128),k=n(2),S=n(242);const w=({timelineId:e})=>{const t=Object(i.useMemo)((()=>f.b.getTimelineByIdSelector()),[]),{cases:n,application:{navigateToApp:l}}=Object(E.k)().services,c=Object(s.useDispatch)(),{graphEventId:u,savedObjectId:d,status:p,title:y,timelineType:w}=Object(m.a)((n=>{var a;return Object(o.pick)(["graphEventId","savedObjectId","status","title","timelineType"],null!==(a=t(n,e))&&void 0!==a?a:b.b)})),[j,O]=Object(i.useState)(!1),[I,T]=Object(i.useState)(!1),C=Object(i.useCallback)((async t=>{T(!1),await l(h.B,{deepLinkId:k.a.case,path:null!=t?Object(x.c)({id:t.id}):Object(x.d)()}),c(Object(v.setInsertTimeline)({graphEventId:u,timelineId:e,timelineSavedObjectId:d,timelineTitle:y}))}),[c,u,l,d,e,y]),M=Object(E.i)(),N=Object(i.useCallback)((()=>{O((e=>!e))}),[]),D=Object(i.useCallback)((()=>O(!1)),[]),F=Object(i.useCallback)((()=>{D(),l(h.B,{deepLinkId:k.a.case,path:Object(x.d)()}).then((()=>{c(Object(v.setInsertTimeline)({graphEventId:u,timelineId:e,timelineSavedObjectId:d,timelineTitle:y.length>0?y:S.l})),c(Object(v.showTimeline)({id:g.j.active,show:!1}))}))}),[c,u,l,D,d,e,y]),A=Object(i.useCallback)((()=>{D(),T(!0)}),[T,D]),_=Object(i.useCallback)((()=>{T(!1)}),[T]),R=Object(i.useCallback)((()=>{O(!1)}),[]),P=Object(i.useMemo)((()=>r.a.createElement(a.EuiButton,{fill:!0,size:"m","data-test-subj":"attach-timeline-case-button",iconType:"arrowDown",iconSide:"right",onClick:N,disabled:p===g.l.draft||w!==g.n.default},S.c)),[N,p,w]),L=Object(i.useMemo)((()=>[r.a.createElement(a.EuiContextMenuItem,{key:"new-case","data-test-subj":"attach-timeline-new-case",onClick:F},S.e),r.a.createElement(a.EuiContextMenuItem,{key:"existing-case","data-test-subj":"attach-timeline-existing-case",onClick:A},S.d)]),[A,F]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiPopover,{id:"singlePanel",button:P,isOpen:j,closePopover:R,panelPaddingSize:"none",anchorPosition:"downLeft"},r.a.createElement(a.EuiContextMenuPanel,{items:L})),I&&n.ui.getAllCasesSelectorModal({onRowClick:C,onClose:_,owner:[h.p],permissions:M}))};w.displayName="AddToCaseButtonComponent";const j=r.a.memo(w);var O=n(715),I=n(701),T=n(124),C=n(92),M=n.n(C),N=n(11),D=n(48),F=n(85),A=n(84),_=n(0);const R=_.i18n.translate("xpack.securitySolution.timeline.kpiFailDescription",{defaultMessage:"An error has occurred"}),P=_.i18n.translate("xpack.securitySolution.timeline.kpiFailSearchDescription",{defaultMessage:"Failed to load KPIs"});var L=n(94),q=n(149),B=n(123),z=n(146),$=n(95),V=n(529);const U=e=>_.i18n.translate("xpack.securitySolution.timeline.flyout.header.closeTimelineButtonLabel",{defaultMessage:"Close {isTimeline, select, true {timeline} false {template}}",values:{isTimeline:e}}),H=_.i18n.translate("xpack.securitySolution.timeline.properties.unsavedLabel",{defaultMessage:"Unsaved"}),G=_.i18n.translate("xpack.securitySolution.timeline.properties.autosavedLabel",{defaultMessage:"Autosaved"}),Q=_.i18n.translate("xpack.securitySolution.timeline.properties.inspectTimelineTitle",{defaultMessage:"Timeline"}),W=_.i18n.translate("xpack.securitySolution.timeline.kpis.processKpiTitle",{defaultMessage:"Processes"}),K=_.i18n.translate("xpack.securitySolution.timeline.kpis.hostKpiTitle",{defaultMessage:"Hosts"}),Y=_.i18n.translate("xpack.securitySolution.timeline.kpis.sourceIpKpiTitle",{defaultMessage:"Source IPs"}),J=_.i18n.translate("xpack.securitySolution.timeline.kpis.destinationKpiTitle",{defaultMessage:"Destination IPs"}),X=_.i18n.translate("xpack.securitySolution.timeline.kpis.userKpiTitle",{defaultMessage:"Users"}),Z=_.i18n.translate("xpack.securitySolution.timeline.properties.readMore",{defaultMessage:"Read More"}),ee=({isOpen:e,title:t})=>_.i18n.translate("xpack.securitySolution.timeline.properties.timelineToggleButtonAriaLabel",{values:{isOpen:e,title:t},defaultMessage:"{isOpen, select, false {Open} true {Close} other {Toggle}} timeline {title}"}),te=c()(a.EuiHealth).withConfig({displayName:"EuiHealthStyled",componentId:"sc-4g9vxo-0"})(["display:block;"]),ne=c()(a.EuiButtonEmpty).withConfig({displayName:"StyledEuiButtonEmpty",componentId:"sc-4g9vxo-1"})(["> span{padding:0;}"]),ae=c()(a.EuiFlexItem).withConfig({displayName:"TitleConatiner",componentId:"sc-4g9vxo-2"})(["overflow:hidden;display:inline-block;text-overflow:ellipsis;"]),ie=({timelineId:e,timelineStatus:t,timelineType:n,timelineTitle:l,updated:c,isOpen:d})=>{const p=Object(s.useDispatch)(),m=Object(i.useCallback)((()=>{p(f.a.showTimeline({id:e,show:!d})),Object(B.i)()}),[p,d,e]),b=Object(o.isEmpty)(l)?n===g.n.template?S.k:S.l:l,y=Object(i.useMemo)((()=>t===g.l.draft?r.a.createElement(r.a.Fragment,null,H):r.a.createElement(r.a.Fragment,null,G," ",r.a.createElement(u.FormattedRelative,{"data-test-subj":"timeline-status",key:"timeline-status-autosaved",value:new Date(c)}))),[t,c]);return r.a.createElement(ne,{"aria-label":ee({isOpen:d,title:b}),className:B.b,flush:"both","data-test-subj":"flyoutOverlay",size:"s",isSelected:d,onClick:m},r.a.createElement(a.EuiFlexGroup,{gutterSize:"none",alignItems:"center",justifyContent:"flexStart",responsive:!1},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiToolTip,{position:"top",content:y},r.a.createElement(te,{color:t===g.l.draft?"warning":"success"}))),r.a.createElement(ae,{grow:!1},b),!d&&r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(V.b,null))))},re=r.a.memo(ie);var oe=n(108),se=n(44),le=n.n(se),ce=n(87);const ue=c()(a.EuiStat).withConfig({displayName:"NoWrapEuiStat",componentId:"sc-9jxvke-0"})(["& .euiStat__description{white-space:nowrap;}"]),de=r.a.memo((({kpis:e,isLoading:t})=>{const n="0,0.[000]a",[o]=Object(E.q)(h.Z),s=Object(i.useMemo)((()=>({process:null===e?Object(ce.e)():le()(e.processCount).format(n),user:null===e?Object(ce.e)():le()(e.userCount).format(n),host:null===e?Object(ce.e)():le()(e.hostCount).format(n),sourceIp:null===e?Object(ce.e)():le()(e.sourceIpCount).format(n),destinationIp:null===e?Object(ce.e)():le()(e.destinationIpCount).format(n)})),[e]),l=Object(i.useMemo)((()=>({process:le()(null==e?void 0:e.processCount).format(o),user:le()(null==e?void 0:e.userCount).format(o),host:le()(null==e?void 0:e.hostCount).format(o),sourceIp:le()(null==e?void 0:e.sourceIpCount).format(o),destinationIp:le()(null==e?void 0:e.destinationIpCount).format(o)})),[e,o]);return r.a.createElement(a.EuiFlexGroup,{wrap:!0,"data-test-subj":"siem-timeline-kpis"},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiToolTip,{position:"left",content:l.process},r.a.createElement(ue,{"data-test-subj":"siem-timeline-process-kpi",title:s.process,description:W,titleSize:"s",isLoading:t}))),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiToolTip,{position:"left",content:l.user},r.a.createElement(ue,{"data-test-subj":"siem-timeline-user-kpi",title:s.user,description:X,titleSize:"s",isLoading:t}))),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiToolTip,{position:"left",content:l.host},r.a.createElement(ue,{"data-test-subj":"siem-timeline-host-kpi",title:s.host,description:K,titleSize:"s",isLoading:t}))),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiToolTip,{position:"left",content:l.sourceIp},r.a.createElement(ue,{"data-test-subj":"siem-timeline-source-ip-kpi",title:s.sourceIp,description:Y,titleSize:"s",isLoading:t}))),r.a.createElement(a.EuiFlexItem,{grow:!1,style:{minWidth:100}},r.a.createElement(a.EuiToolTip,{position:"left",content:l.destinationIp},r.a.createElement(ue,{"data-test-subj":"siem-timeline-destination-ip-kpi",title:s.destinationIp,description:J,titleSize:"s",isLoading:t}))))}));de.displayName="TimelineKPIs";var pe=n(613);const me=c()(a.EuiFlexItem).withConfig({displayName:"ActiveTimelinesContainer",componentId:"sc-12xgwp3-0"})(["overflow:hidden;"]),ge=({timelineId:e})=>{const t=Object(s.useDispatch)(),{browserFields:n,indexPattern:l}=Object(L.d)($.SourcererScopeName.timeline),{uiSettings:c}=Object(E.k)().services,u=Object(i.useMemo)((()=>Object(d.getEsQueryConfig)(c)),[c]),y=Object(i.useMemo)((()=>f.b.getTimelineByIdSelector()),[]),{activeTab:h,dataProviders:v,kqlQuery:x,title:k,timelineType:S,status:w,updated:j,show:I,filters:C,kqlMode:M}=Object(m.a)((t=>{var n;return Object(o.pick)(["activeTab","dataProviders","kqlQuery","status","title","timelineType","updated","show","filters","kqlMode"],null!==(n=y(t,e))&&void 0!==n?n:b.b)})),N=Object(i.useMemo)((()=>!Object(o.isEmpty)(v)||!Object(o.isEmpty)(Object(o.get)("filterQuery.kuery.expression",x))),[v,x]),D=Object(i.useMemo)((()=>f.b.getKqlFilterQuerySelector()),[]),F=Object(s.useSelector)((t=>D(t,e))),A=Object(o.isEmpty)(v)&&Object(o.isEmpty)(F)&&"template"===S?" ":F,_=Object(i.useMemo)((()=>({query:A,language:"kuery"})),[A]),R=Object(i.useMemo)((()=>Object(z.a)({config:u,dataProviders:v,indexPattern:l,browserFields:n,filters:C||[],kqlQuery:_,kqlMode:M})),[n,v,u,C,l,M,_]),P=Object(i.useCallback)((()=>{t(f.a.showTimeline({id:e,show:!1})),Object(B.i)()}),[t,e]),{euiTheme:q}=Object(a.useEuiTheme)();return r.a.createElement(a.EuiPanel,{borderRadius:"none",grow:!1,paddingSize:"s",hasShadow:!1,"data-test-subj":"timeline-flyout-header-panel",style:{backgroundColor:q.colors.emptyShade,color:q.colors.text}},r.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1},r.a.createElement(O.b,{timelineId:e}),r.a.createElement(me,{grow:!1},r.a.createElement(re,{timelineId:e,timelineType:S,timelineTitle:k,timelineStatus:w,isOpen:I,updated:j})),I&&r.a.createElement(a.EuiFlexItem,null,r.a.createElement(a.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s",responsive:!1},(h===g.m.query||h===g.m.eql)&&r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(T.b,{compact:!0,queryId:`${e}-${h}`,inputId:p.a.timeline,inspectIndex:0,isDisabled:!N||void 0===(null==R?void 0:R.filterQuery),title:Q})),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiToolTip,{content:U("default"===S)},r.a.createElement(a.EuiButtonIcon,{"aria-label":U("default"===S),"data-test-subj":"close-timeline",iconType:"cross",onClick:P})))))))},fe=r.a.memo(ge),be=c.a.div.withConfig({displayName:"StyledDiv",componentId:"sc-12xgwp3-1"})(["display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;overflow:hidden;word-break:break-word;"]),ye=({description:e,onclick:t})=>{const[n,i]=Object(pe.a)(e);return r.a.createElement(r.a.Fragment,null,r.a.createElement(be,{ref:i},e),n&&r.a.createElement(a.EuiButtonEmpty,{flush:"left",onClick:t},Z))},he=c()(a.EuiFlexGroup).withConfig({displayName:"StyledTimelineHeader",componentId:"sc-12xgwp3-2"})([""," flex:0;"],(({theme:e})=>`margin: ${e.eui.euiSizeXS} ${e.eui.euiSizeS} 0 ${e.eui.euiSizeS};`)),ve=c.a.span.withConfig({displayName:"TimelineStatusInfoContainer",componentId:"sc-12xgwp3-3"})([""," white-space:nowrap;"],(({theme:e})=>`margin-left: ${e.eui.euiSizeS};`)),Ee=c.a.div.withConfig({displayName:"KpisContainer",componentId:"sc-12xgwp3-4"})(["",""],(({theme:e})=>`margin-right: ${e.eui.euiSizeM};`)),xe=c()(a.EuiFlexItem).withConfig({displayName:"RowFlexItem",componentId:"sc-12xgwp3-5"})(["flex-direction:row;align-items:center;"]),ke=c.a.h3.withConfig({displayName:"TimelineTitleContainer",componentId:"sc-12xgwp3-6"})(["display:-webkit-box;overflow:hidden;-webkit-line-clamp:1;-webkit-box-orient:vertical;word-break:break-word;"]),Se=({timelineId:e})=>{const t=Object(i.useMemo)((()=>f.b.getTimelineByIdSelector()),[]),{title:n,timelineType:s}=Object(m.a)((n=>{var a;return Object(o.pick)(["title","timelineType"],null!==(a=t(n,e))&&void 0!==a?a:b.b)})),l=Object(i.useMemo)((()=>s===g.n.template?S.k:S.l),[s]),c=Object(i.useMemo)((()=>n||l),[n,l]);return r.a.createElement(a.EuiToolTip,{content:c,position:"bottom"},r.a.createElement(a.EuiText,null,r.a.createElement(ke,{"data-test-subj":"timeline-title"},c)))},we=r.a.memo(Se),je=({timelineId:e})=>{const t=Object(i.useMemo)((()=>f.b.getTimelineByIdSelector()),[]),n=Object(m.a)((n=>{var a;return(null!==(a=t(n,e))&&void 0!==a?a:b.b).description})),o=Object(s.useDispatch)(),l=Object(i.useCallback)((t=>{o(Object(v.setActiveTabTimeline)({id:e,activeTab:g.m.notes,scrollToTop:!0}))}),[o,e]);return r.a.createElement(a.EuiText,{size:"s","data-test-subj":"timeline-description"},r.a.createElement(ye,{description:n||S.f,onclick:l}))},Oe=r.a.memo(je),Ie=({timelineId:e})=>{const t=Object(i.useMemo)((()=>Object(oe.createSelector)(f.b.selectTimeline,(e=>{var t,n;return{status:null!==(t=null==e?void 0:e.status)&&void 0!==t?t:g.l.draft,updated:null!==(n=null==e?void 0:e.updated)&&void 0!==n?n:void 0}}))),[]),{status:n,updated:o}=Object(m.a)((n=>t(n,e)));return Object(i.useMemo)((()=>n===g.l.draft),[n])?r.a.createElement(a.EuiText,{size:"xs"},r.a.createElement(a.EuiTextColor,{color:"warning","data-test-subj":"timeline-status"},H)):r.a.createElement(a.EuiText,{size:"xs"},r.a.createElement(a.EuiTextColor,{color:"default"},G," ",r.a.createElement(u.FormattedRelative,{"data-test-subj":"timeline-status",key:"timeline-status-autosaved",value:new Date(o)})))},Te=r.a.memo(Ie),Ce=({timelineId:e})=>{var t;const{selectedPatterns:n,indexPattern:l,browserFields:c}=Object(L.d)($.SourcererScopeName.timeline),u=Object(i.useMemo)((()=>Object(q.i)()),[]),p=Object(i.useMemo)((()=>Object(q.b)()),[]),h=Object(i.useMemo)((()=>e===g.j.active),[e]),v=Object(m.a)((e=>h?{from:u(e.inputs.timeline),to:p(e.inputs.timeline),interval:""}:{from:u(e.inputs.global),to:p(e.inputs.global),interval:""})),{uiSettings:x}=Object(E.k)().services,k=Object(i.useMemo)((()=>Object(d.getEsQueryConfig)(x)),[x]),S=Object(i.useMemo)((()=>f.b.getTimelineByIdSelector()),[]),w=Object(s.useSelector)((t=>{var n;return null!==(n=S(t,e))&&void 0!==n?n:b.b})),{dataProviders:O,filters:T,timelineType:C,kqlMode:_,activeTab:B}=w,V=Object(i.useMemo)((()=>f.b.getKqlFilterQuerySelector()),[]),U=Object(s.useSelector)((t=>V(t,e))),H=Object(o.isEmpty)(O)&&Object(o.isEmpty)(U)&&"template"===C?" ":U,G=Object(i.useMemo)((()=>({query:H,language:"kuery"})),[H]),Q=Object(i.useMemo)((()=>Object(z.a)({config:k,dataProviders:O,indexPattern:l,browserFields:c,filters:T||[],kqlQuery:G,kqlMode:_})),[c,O,k,T,l,_,G]),W=Object(i.useMemo)((()=>Object(o.isEmpty)(O)&&Object(o.isEmpty)(T)&&Object(o.isEmpty)(G.query)||void 0===(null==Q?void 0:Q.filterQuery)),[O,T,G,Q]),[K,Y]=(({timerange:e,filterQuery:t,defaultIndex:n,isBlankTimeline:a})=>{const{data:r}=Object(E.k)().services,s=Object(i.useRef)(o.noop),l=Object(i.useRef)(new AbortController),c=Object(i.useRef)(new N.Subscription),[u,d]=Object(i.useState)(!1),[p,m]=Object(i.useState)(null),[g,f]=Object(i.useState)(null),{addError:b,addWarning:y}=Object(A.a)(),h=Object(i.useCallback)((e=>{if(null==e)return;const t=async()=>{l.current=new AbortController,d(!0),c.current=r.search.search(e,{strategy:"timelineSearchStrategy",abortSignal:l.current.signal}).subscribe({next:e=>{Object(D.isCompleteResponse)(e)?(d(!1),f(e),c.current.unsubscribe()):Object(D.isErrorResponse)(e)&&(d(!1),y(R),c.current.unsubscribe())},error:e=>{d(!1),b(e,{title:P}),c.current.unsubscribe()}})};c.current.unsubscribe(),l.current.abort(),t(),s.current=t}),[r.search,b,y]);return Object(i.useEffect)((()=>{m((a=>{const i={...null!=a?a:{},defaultIndex:n,timerange:e,filterQuery:t,factoryQueryType:F.z.kpi};return M()(a,i)?a:i}))}),[n,e,t]),Object(i.useEffect)((()=>(a?(d(!1),f(null)):h(p),()=>{c.current.unsubscribe(),l.current.abort()})),[a,p,h]),[u,g]})({defaultIndex:n,timerange:v,isBlankTimeline:W,filterQuery:null!==(t=null==Q?void 0:Q.filterQuery)&&void 0!==t?t:""}),J=Object(E.i)();return r.a.createElement(he,{alignItems:"center",gutterSize:"s"},r.a.createElement(a.EuiFlexItem,null,r.a.createElement(a.EuiFlexGroup,{"data-test-subj":"properties-left",direction:"column",gutterSize:"none"},r.a.createElement(xe,null,r.a.createElement(we,{timelineId:e}),r.a.createElement(I.a,{timelineId:e,initialFocus:"title"}),r.a.createElement(ve,null,r.a.createElement(Te,{timelineId:e}))),r.a.createElement(xe,null,r.a.createElement(Oe,{timelineId:e}),r.a.createElement(I.a,{timelineId:e,initialFocus:"description"})))),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(Ee,null,B===g.m.query?r.a.createElement(de,{kpis:Y,isLoading:K}):null)),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiFlexGroup,{gutterSize:"s"},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(y.a,{timelineId:e})),J.create&&J.read&&r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(j,{timelineId:e})))))};Ce.displayName="FlyoutHeaderComponent";const Me=r.a.memo(Ce)},function(e,t,n){"use strict";n.d(t,"b",(function(){return Ie})),n.d(t,"a",(function(){return Me}));var a=n(4),i=n.n(a),r=n(78),o=n(37),s=n(32),l=n(42),c=n(45),u=n(707),d=n(230),p=n(90),m=n(81),g=n(85),f=n(114),b=n(293),y=n(220),h=n(543),v=n(325),E=n(625),x=n(319),k=n(127),S=n(33),w=n.n(S),j=n(430),O=n(0);const I=O.i18n.translate("xpack.securitySolution.components.flowControls.selectFlowTarget.sourceDropDownOptionLabel",{defaultMessage:"Source"}),T=O.i18n.translate("xpack.securitySolution.components.flowControls.selectFlowTarget.destinationDropDownOptionLabel",{defaultMessage:"Destination"}),C=O.i18n.translate("xpack.securitySolution.components.flowControls.selectFlowTarget.clientDropDownOptionLabel",{defaultMessage:"CLIENT"}),M=O.i18n.translate("xpack.securitySolution.components.flowControls.selectFlowTarget.serverDropDownOptionLabel",{defaultMessage:"SERVER"}),N=(O.i18n.translate("xpack.securitySolution.components.flowControls.selectFlowDirection.unidirectionalButtonLabel",{defaultMessage:"Unidirectional"}),O.i18n.translate("xpack.securitySolution.components.flowControls.selectFlowDirection.bidirectionalButtonLabel",{defaultMessage:"Bidirectional"}),(e,t)=>[{id:`${e}-select-flow-target-${g.f.source}`,value:g.f.source,inputDisplay:t[0]||I,directions:[g.e.uniDirectional,g.e.biDirectional]},{id:`${e}-select-flow-target-${g.f.destination}`,value:g.f.destination,inputDisplay:t[1]||T,directions:[g.e.uniDirectional,g.e.biDirectional]},{id:`${e}-select-flow-target-${g.f.client}`,value:g.f.client,inputDisplay:t[2]||C,directions:[g.e.biDirectional]},{id:`${e}-select-flow-target-${g.f.server}`,value:g.f.server,inputDisplay:t[3]||M,directions:[g.e.biDirectional]}]),D=({id:e,isLoading:t=!1,selectedDirection:n,selectedTarget:a,displayTextOverride:r=[],updateFlowTargetAction:o})=>i.a.createElement(s.EuiSuperSelect,{options:n?N(e,r).filter((e=>e.directions.includes(n))):N(e,r),valueOfSelected:a,onChange:o,isLoading:t}),F=i.a.memo(D);var A=n(221);const _=w()(s.EuiFlexItem).withConfig({displayName:"SelectTypeItem",componentId:"sc-12qgll-0"})(["min-width:180px;"]);_.displayName="SelectTypeItem";const R=({flowTarget:e})=>{const t=Object(o.useHistory)(),n=Object(o.useLocation)(),r=Object(a.useCallback)((a=>{const i=((e,t,n)=>`${e.pathname.replace(t,n)}${e.search}`)(n,e,a);t.push(i)}),[t,n,e]);return i.a.createElement(_,{grow:!1,"data-test-subj":`${A.b}-select-flow-target`},i.a.createElement(F,{id:A.b,isLoading:!e,selectedDirection:g.e.uniDirectional,selectedTarget:e,displayTextOverride:[j.b,j.a],updateFlowTargetAction:r}))},P=i.a.memo(R);var L=n(626),q=n(282),B=n(164),z=n(713),$=n(77),V=n(351),U=n(98),H=n(143),G=n(355),Q=n(161),W=n(111),K=n(2),Y=n(94),J=n(233),X=n(320),Z=n(380),ee=n(304),te=n(171),ne=n(837),ae=n(120),ie=n(217),re=n(1),oe=n(413),se=n(383);const le=(e,t,n)=>`${re.Sb}/ip/${e}/${n}/${t}`,ce=(e,t,n)=>{const a={[se.a.flows]:{id:se.a.flows,name:oe.d,href:le(e,se.a.flows,n),disabled:!1},[se.a.users]:{id:se.a.users,name:oe.g,href:le(e,se.a.users,n),disabled:!1},[se.a.http]:{id:se.a.http,name:oe.e,href:le(e,se.a.http,n),disabled:!1},[se.a.tls]:{id:se.a.tls,name:oe.f,href:le(e,se.a.tls,n),disabled:!1},[se.a.anomalies]:{id:se.a.anomalies,name:oe.a,href:le(e,se.a.anomalies,n),disabled:!1},[se.a.events]:{id:se.a.events,name:oe.c,href:le(e,se.a.events,n),disabled:!1}};return t||delete a.anomalies,a};var ue=n(82),de=n.n(ue),pe=n(41),me=n(104),ge=n(698),fe=n(192),be=n(514),ye=n(420),he=n(577),ve=n(830),Ee=n(689);const xe=i.a.memo((({flowTarget:e,indexPattern:t,networkDetailsFilter:n,...a})=>{const r={...a,type:W.c.NetworkType.details},l={...r,indexPattern:t},c={...r,flowTarget:e};return i.a.createElement(o.Switch,null,i.a.createElement(pe.Route,{path:`${he.b}/:flowTarget/:tabName(${se.a.flows})`},i.a.createElement(i.a.Fragment,null,i.a.createElement(Ee.a,{direction:"column"},i.a.createElement(s.EuiFlexItem,null,i.a.createElement(ve.d,de()({},l,{flowTarget:fe.b.source}))),i.a.createElement(s.EuiFlexItem,null,i.a.createElement(ve.d,de()({},l,{flowTarget:fe.b.destination})))),i.a.createElement(s.EuiSpacer,null),i.a.createElement(Ee.a,{direction:"column"},i.a.createElement(s.EuiFlexItem,null,i.a.createElement(ve.a,de()({},l,{flowTarget:fe.b.source}))),i.a.createElement(s.EuiFlexItem,null,i.a.createElement(ve.a,de()({},l,{flowTarget:fe.b.destination})))))),i.a.createElement(pe.Route,{path:`${he.b}/:flowTarget/:tabName(${se.a.users})`},i.a.createElement(ve.h,c)),i.a.createElement(pe.Route,{path:`${he.b}/:flowTarget/:tabName(${se.a.http})`},i.a.createElement(ve.c,r)),i.a.createElement(pe.Route,{path:`${he.b}/:flowTarget/:tabName(${se.a.tls})`},i.a.createElement(ve.g,c)),i.a.createElement(pe.Route,{path:`${he.b}/:flowTarget/:tabName(${se.a.anomalies})`},i.a.createElement(ye.a,de()({},c,{hideHistogramIfEmpty:!0,AnomaliesTableComponent:ge.a}))),i.a.createElement(pe.Route,{path:`${he.b}/:flowTarget/:tabName(${se.a.events})`},i.a.createElement(be.a,de()({additionalFilters:n},r,{tableId:me.c.networkPageEvents}))))}));xe.displayName="UsersDetailsTabs";var ke=n(248),Se=n(34),we=n(854),je=n(272);W.c.NetworkType.details;const Oe={[se.a.events]:oe.c,[se.a.anomalies]:oe.a,[se.a.flows]:oe.d,[se.a.users]:oe.g,[se.a.http]:oe.e,[se.a.tls]:oe.f,[je.a.dns]:oe.b},Ie=(e,t)=>{let n=[];null!=e.detailName&&(n=[{text:Object(V.c)(e.detailName),href:t({deepLinkId:K.a.network,path:Object(we.a)(e.detailName,e.flowTarget,"")})}]);const a=Object(Se.get)("tabName",e);return a?(n=[...n,{text:Oe[a],href:""}],n):n},Te=Object(k.a)(L.a),Ce=()=>{const e=Object(r.useDispatch)(),t=Object(ae.a)(),{to:n,from:k,setQuery:S,isInitializing:w}=Object(f.a)(),{detailName:j,flowTarget:O}=Object(o.useParams)(),I=Object(a.useMemo)((()=>U.d.globalQuerySelector()),[]),T=Object(a.useMemo)((()=>U.d.globalFiltersQuerySelector()),[]),{signalIndexName:C}=Object(d.a)(),{hasKibanaREAD:M,hasIndexRead:N}=Object(ie.a)(),D=M&&N,F=Object(m.a)(I),A=Object(m.a)(T),_=W.c.NetworkType.details,R=Object(a.useCallback)(((t,n)=>{const a=Object(x.a)(t,n);e(Object(H.setAbsoluteRangeDatePicker)({id:p.a.global,from:a.from,to:a.to}))}),[e]),{services:{uiSettings:L}}=Object($.k)();Object(a.useEffect)((()=>{e(Object(G.setNetworkDetailsTablesActivePageToZero)())}),[j,e]);const{indicesExist:re,indexPattern:oe,selectedPatterns:se}=Object(Y.d)(),le=Object(V.c)(j),ue=Object(a.useMemo)((()=>Object(ee.c)(le)),[le]),[de,pe]=Object(a.useMemo)((()=>{try{return[Object(c.buildEsQuery)(oe,[F],[...ue,...A],Object(l.getEsQueryConfig)(L))]}catch(e){return[void 0,e]}}),[A,oe,ue,F,L]),me=JSON.stringify(de);Object(J.a)({id:z.a,filterQuery:me,kqlError:pe,query:F,startDate:k,endDate:n});const[ge,{id:fe,inspect:be,networkDetails:ye,refetch:he}]=Object(z.b)({skip:w,filterQuery:me,indexNames:se,ip:le}),{jobIds:ve}=Object(ke.b)(),[Ee,Se]=Object(v.a)({criteriaFields:Object(E.a)(j,O),startDate:k,endDate:n,skip:w,jobIds:ve,aggregationInterval:"auto"}),we=Object(a.useMemo)((()=>({field:`${O}.ip`,value:le})),[O,le]),je=Object(a.useMemo)((()=>({field:`${O}.ip`,value:j})),[j,O]);return i.a.createElement("div",{"data-test-subj":"network-details-page"},re?i.a.createElement(i.a.Fragment,null,i.a.createElement(b.a,null,i.a.createElement(q.a,{indexPattern:oe,id:p.a.global})),i.a.createElement(B.a,null,i.a.createElement(y.a,{border:!0,"data-test-subj":"network-details-headline",draggableArguments:we,subtitle:i.a.createElement(h.a,{indexKey:g.k.ipDetails,indexNames:se,ip:le}),title:le},i.a.createElement(P,{flowTarget:O})),i.a.createElement(Te,{id:fe,inspect:be,ip:le,isInDetailsSidePanel:!1,data:ye,anomaliesData:Se,loading:ge,isLoadingAnomaliesData:Ee,type:_,flowTarget:O,refetch:he,setQuery:S,startDate:k,endDate:n,narrowDateRange:R,indexPatterns:se}),i.a.createElement(s.EuiHorizontalRule,null),i.a.createElement(s.EuiSpacer,null),D&&i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiFlexGroup,null,i.a.createElement(s.EuiFlexItem,null,i.a.createElement(u.a,{signalIndexName:C,entityFilter:je,additionalFilters:de?[de]:[]})),i.a.createElement(s.EuiFlexItem,null,i.a.createElement(ne.a,{entityFilter:je,signalIndexName:C,additionalFilters:de?[de]:[]}))),i.a.createElement(s.EuiSpacer,null)),i.a.createElement(Z.a,{navTabs:ce(le,Object(te.a)(t),O)}),i.a.createElement(s.EuiSpacer,null),i.a.createElement(xe,{ip:le,endDate:n,startDate:k,filterQuery:me,indexNames:se,skip:w||!!pe,setQuery:S,indexPattern:oe,flowTarget:O,networkDetailsFilter:ue}))):i.a.createElement(X.a,null),i.a.createElement(Q.a,{pageName:K.a.network}))};Ce.displayName="NetworkDetailsComponent";const Me=i.a.memo(Ce)},function(e,t,n){"use strict";n.d(t,"b",(function(){return E})),n.d(t,"a",(function(){return S})),n.d(t,"c",(function(){return C}));var a=n(4),i=n.n(a),r=n(32),o=n(79),s=n(609),l=n(128);const c="timeline";var u=n(0);const d=u.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.insertTimelineButtonLabel",{defaultMessage:"Insert timeline link"}),p=u.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.noTimelineNameFoundErrorMsg",{defaultMessage:"No timeline name found"}),m=u.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.noTimelineIdFoundErrorMsg",{defaultMessage:"No timeline id found"}),g=u.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.noParenthesesErrorMsg",{defaultMessage:"Expected left parentheses"}),f=e=>u.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.failedRetrieveTimelineErrorMsg",{defaultMessage:"Failed to retrieve timeline id: { timelineId }",values:{timelineId:e}}),b=u.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.timelineErrorTitle",{defaultMessage:"Timeline Error"});var y=n(2);const h=({onClosePopover:e,onInsert:t})=>{const{formatUrl:n}=Object(l.n)(y.a.timelines),c=Object(a.useCallback)((({timelines:e})=>[...e.map(((e,t)=>({description:e.description,favorite:e.favorite,label:e.title,id:e.savedObjectId,key:`${e.title}-${t}`,title:e.title,checked:void 0})))]),[]),u=Object(a.useCallback)(((e,a,i)=>{const r=n(Object(l.m)(null!=a?a:"",i),{absolute:!0,skipSearch:!0});t(`[${e}](${r})`,{block:!1})}),[n,t]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiModalHeader,null),i.a.createElement(r.EuiModalBody,null,i.a.createElement(s.a,{hideUntitled:!0,getSelectableOptions:c,onTimelineChange:u,onClosePopover:e,timelineType:o.n.default})))},v=Object(a.memo)(h),E={name:c,button:{label:d,iconType:"timeline"},helpText:i.a.createElement(r.EuiCodeBlock,{language:"md",paddingSize:"s",fontSize:"l"},"[title](url)"),editor:function({node:e,onSave:t,onCancel:n}){return i.a.createElement(v,{onClosePopover:n,onInsert:t})}};var x=n(598),k=n(267);const S=function(){const e=this.Parser,t=e.prototype.inlineTokenizers,n=e.prototype.inlineMethods,a=function(e,t,n){let a=0;if("["!==t[a])return!1;if(n)return!0;function i(e,n){if(t[a]!==e)throw new Error(g);a++;let i="",r=0;for(;a<t.length;a++){const o=t[a];if(o===n&&0===r)return a++,i;o===n?r--:o===e&&r++,i+=o}return""}const r=i("[","]"),o=i("(",")"),s=e.now();if(!r)return this.file.info(p,{line:s.line,column:s.column}),!1;try{var l,d;const t=o.split("?"),n=Object(x.parse)(t[1]),{id:a="",graphEventId:i=""}=null!==(l=Object(k.a)(null!==(d=n.timeline)&&void 0!==d?d:""))&&void 0!==l?l:{id:null,graphEventId:""};return a?e(`[${r}](${o})`)({type:c,id:a,title:r,graphEventId:i}):(this.file.info(m,{line:s.line,column:s.column+o.indexOf("id")}),!1)}catch{this.file.info((e=>u.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.toolTip.timelineUrlIsNotValidErrorMsg",{defaultMessage:"Timeline URL is not valid => {timelineUrl}",values:{timelineUrl:e}}))(o),{line:s.line,column:s.column})}return!1},i=function(e,t,n){return!(!1===t.startsWith("[")||!0===t.startsWith("[")&&!t.includes("timelines?timeline=(id"))&&a.call(this,e,t,n)};i.locator=(e,t)=>e.indexOf("[",t),t.timeline=i,n.splice(n.indexOf("url"),0,c)};var w=n(78),j=n(136),O=n(12),I=n(84);const T=({id:e,title:t,graphEventId:n})=>{const{addError:o}=Object(I.a)(),s=(()=>{const e=Object(w.useDispatch)();return Object(a.useCallback)(((t,n,a)=>{Object(j.h)({graphEventId:a,timelineId:t,onError:n,updateIsLoading:({id:t,isLoading:n})=>e(Object(O.updateIsLoading)({id:t,isLoading:n})),updateTimeline:Object(j.b)(e)})}),[e])})(),l=Object(a.useCallback)(((e,t)=>{o(e,{title:b,toastMessage:f(t)})}),[o]),c=Object(a.useCallback)((()=>s(null!=e?e:"",l,n)),[e,n,s,l]);return i.a.createElement(r.EuiToolTip,{content:(d=null!=e?e:"",u.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.toolTip.timelineId",{defaultMessage:"Timeline id: { timelineId }",values:{timelineId:d}}))},i.a.createElement(r.EuiLink,{onClick:c,"data-test-subj":`markdown-timeline-link-${e}`},t));var d},C=Object(a.memo)(T)},function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));var a=n(34),i=n(78),r=n(812),o=n(902),s=n(535),l=n(1);var c=n(893),u=n(2),d=n(128),p=n(690),m=n(580);const g={[p.a.summary]:m.e};var f=n(86),b=n(79),y=n(209),h=n(9),v=n(521);const E=()=>{const e=Object(i.useDispatch)(),t=Object(d.o)(),n=Object(v.b)();return(a,i,r)=>{const o=x(a,t,n);o&&i.setBreadcrumbs(o.map((t=>({...t,...t.href&&!t.onClick?{onClick:n=>{n.preventDefault(),e(f.a.showTimeline({id:b.j.active,show:!1})),r(t.href)}}:{}}))))}},x=(e,t,n)=>{const i=Object(a.omit)("navTabs",e);if(!i||!e.navTabs||!i.pageName||O(i)||N(i))return null;const r=((e,t,n,a)=>{const i=t({deepLinkId:u.a.landing});var r;return[{text:l.s,href:(r=i,`${r}${Object(y.a)(undefined)}`)},...Object(h.a)(e).map((({title:e,id:i})=>{const r=e,o=n[i]?n[i].name:e;return{text:a?r:o,href:t({deepLinkId:i})}}))]})(i.pageName,t,e.navTabs,n),o=r[r.length-1],s=r[0];return D([...n?r:[s,o],...k(i,t)])},k=(e,t)=>w(e)?Object(r.a)(e,t):S(e)?Object(o.b)(e,t):j(e)?Object(c.a)(e,t):C(e)?Object(s.c)(e,t):M(e)?((e,t)=>{var n;let a=[];var i;return(i=e.pathName).includes(l.Bb)&&i.includes("/details")&&null!==(n=e.state)&&void 0!==n&&n.listName&&(a=[...a,{text:e.state.listName}]),a})(e):I(e)?((e,t)=>{let n=[];return null!=e.detailName&&(n=[{text:e.detailName,href:t({path:Object(d.g)(e.detailName,""),deepLinkId:u.a.kubernetes})}]),n})(e,t):T(e)?((e,t)=>{let n=[];var a,i;return null!=e.detailName&&(n=[...n,{text:null!==(a=null===(i=e.state)||void 0===i?void 0:i.ruleName)&&void 0!==a?a:e.detailName,href:t({path:Object(d.b)(e.detailName,""),deepLinkId:l.uc.alerts})}]),null!=e.tabName&&(n=[...n,{text:g[e.tabName],href:""}]),n})(e,t):[],S=e=>e.pageName===u.a.network,w=e=>e.pageName===u.a.hosts,j=e=>e.pageName===u.a.users,O=e=>e.pageName===u.a.case,I=e=>e.pageName===u.a.kubernetes,T=e=>e.pageName===u.a.alerts,C=e=>e.pageName===u.a.rules||e.pageName===u.a.rulesCreate,M=e=>e.pageName===u.a.exceptions,N=e=>e.pageName===u.a.cloudSecurityPostureRules,D=e=>{const t=e.slice(0,-1),n=Object(a.last)(e);return n?[...t,{...n,href:""}]:e}},function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var a=n(79),i=n(7),r=n(33),o=n.n(r),s=n(1),l=n(140);const c=o.a.div.withConfig({displayName:"HorizontalSpacer",componentId:"sc-j61h0h-0"})(["margin:0 ",";"],(({theme:e})=>e.eui.euiSizeXS));var u=n(32),d=n(4),p=n.n(d),m=n(473),g=n(223),f=n(35),b=n(88);const y=({contextId:e,eventId:t,isDraggable:n,sourceField:a,sourceValue:i})=>p.a.createElement(u.EuiFlexGroup,{alignItems:"center","data-test-subj":"threat-match-details",direction:"row",justifyContent:"center",gutterSize:"none",wrap:!0},p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(b.c,{contextId:e,"data-test-subj":"threat-match-details-source-field",eventId:t,field:l.g,isDraggable:n,value:a,isAggregatable:!0,fieldType:"keyword"})),p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(c,null,p.a.createElement(f.FormattedMessage,{defaultMessage:"matched",id:"xpack.securitySolution.alerts.rowRenderers.cti.threatMatch.matchedVerb"}))),p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(b.c,{contextId:e,"data-test-subj":"threat-match-details-source-value",eventId:t,field:a,isDraggable:n,value:i,isAggregatable:!0,fieldType:"keyword"})));var h=n(196);const v=({contextId:e,eventId:t,feedName:n,indicatorReference:a,indicatorType:i,isDraggable:r})=>p.a.createElement(u.EuiFlexGroup,{alignItems:"flexStart","data-test-subj":"threat-match-indicator-details",direction:"row",justifyContent:"center",gutterSize:"none",wrap:!0},i&&p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(b.c,{contextId:e,"data-test-subj":"threat-match-indicator-details-indicator-type",eventId:t,field:l.h,isDraggable:r,value:i,isAggregatable:!0,fieldType:"keyword"})),n&&p.a.createElement(p.a.Fragment,null,p.a.createElement(u.EuiFlexItem,{grow:!1,component:"span"},p.a.createElement(c,null,p.a.createElement(f.FormattedMessage,{defaultMessage:"provided by",id:"xpack.securitySolution.alerts.rowRenderers.cti.threatMatch.providerPreposition"}))),p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(b.c,{contextId:e,"data-test-subj":"threat-match-indicator-details-indicator-feedName",eventId:t,field:l.e,isDraggable:r,value:n,isAggregatable:!0,fieldType:"keyword"}))),a&&p.a.createElement(p.a.Fragment,null,p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(c,null,":")),p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(h.a,{contextId:e,"data-test-subj":"threat-match-indicator-details-indicator-reference",eventId:t,fieldName:l.j,isDraggable:r,value:a,isAggregatable:!0,fieldType:"keyword"})))),E=({contextId:e,data:t,eventId:n,isDraggable:a})=>{const r={contextId:e,eventId:n,indicatorReference:Object(i.get)(t,l.p)[0],feedName:Object(i.get)(t,l.e)[0],indicatorType:Object(i.get)(t,l.n)[0],isDraggable:a,sourceField:Object(i.get)(t,l.l)[0],sourceValue:Object(i.get)(t,l.k)[0]};return p.a.createElement(x,r)},x=({contextId:e,eventId:t,feedName:n,indicatorReference:a,indicatorType:i,isDraggable:r,sourceField:o,sourceValue:s})=>p.a.createElement(u.EuiFlexGroup,{alignItems:"center","data-test-subj":"threat-match-row",gutterSize:"s",justifyContent:"center"},p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(y,{contextId:e,eventId:t,isDraggable:r,sourceField:o,sourceValue:s})),p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(v,{contextId:e,eventId:t,feedName:n,indicatorReference:a,indicatorType:i,isDraggable:r}))),k=o.a.div.withConfig({displayName:"SpacedContainer",componentId:"sc-1n3i04b-0"})(["margin:"," 0;"],(({theme:e})=>e.eui.euiSizeS)),S={id:a.d.threat_match,isInstance:e=>(e=>{const t=Object(i.get)(e,s.yb);return null==t?[]:Array.isArray(t)?t:[t]})(e).some((e=>l.i.some((t=>!Object(i.isEmpty)(Object(i.get)(e,t)))))),renderRow:({data:e,isDraggable:t,scopeId:n})=>{const a=Object(i.get)(e,s.yb),r=Object(i.get)(e,m.a);return p.a.createElement(g.a,{"data-test-subj":"threat-match-row-renderer"},p.a.createElement(k,null,a.map(((e,i)=>{const o=`threat-match-row-${n}-${r}-${i}`;return p.a.createElement(d.Fragment,{key:o},p.a.createElement(E,{contextId:o,data:e,eventId:r,isDraggable:t}),i<a.length-1&&p.a.createElement(u.EuiHorizontalRule,{margin:"s"}))}))))}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return M}));var a=n(4),i=n.n(a),r=n(11),o=n(33),s=n.n(o),l=n(92),c=n.n(l),u=n(32),d=n(48),p=n(60);const m=Object(a.memo)((({indexPattern:e,isLoading:t=!1,isRefreshPaused:n,filterQuery:r,filterManager:o,filters:s,refreshInterval:l,dataTestSubj:c,displayStyle:u})=>{const d=Object(a.useCallback)((e=>{o.setFilters(e)}),[o]),m=Object(a.useMemo)((()=>[e]),[e]);return i.a.createElement(p.SearchBar,{showSubmitButton:!1,filters:s,indexPatterns:m,isLoading:t,isRefreshPaused:n,query:r,onFiltersUpdated:d,refreshInterval:l,showAutoRefreshOnly:!1,showFilterBar:!0,showDatePicker:!1,showQueryInput:!1,showSaveQuery:!1,dataTestSubj:c,displayStyle:u})}));m.displayName="FilterBar";var g=n(84),f=n(311),b=n(7);const y=({ariaLabel:e,errors:t})=>{const[n,r]=Object(a.useState)(!1),o=Object(a.useCallback)((()=>{r(!n)}),[n]),s=Object(a.useCallback)((()=>{r(!1)}),[]);return i.a.createElement(u.EuiPopover,{"data-test-subj":"eql-validation-errors-popover",button:i.a.createElement(u.EuiButtonEmpty,{"data-test-subj":"eql-validation-errors-popover-button",iconType:"crossInACircleFilled",size:"s",color:"danger","aria-label":e,onClick:o},t.length),isOpen:n,closePopover:s,anchorPosition:"downCenter"},i.a.createElement("div",{"data-test-subj":"eql-validation-errors-popover-content"},i.a.createElement(u.EuiPopoverTitle,null,f.k),t.map(((e,t)=>i.a.createElement(u.EuiText,{key:t},e)))))};var h=n(77);const v=s()(u.EuiText).withConfig({displayName:"InlineText",componentId:"sc-i91hzt-0"})(["display:inline-block;"]),E=()=>{const e=Object(h.k)().services.docLinks.links.query.eql;return i.a.createElement(u.EuiLink,{external:!0,href:e,target:"_blank"},i.a.createElement(v,{size:"xs"},f.i))},x=s()(u.EuiPanel).withConfig({displayName:"Container",componentId:"sc-10yczbx-0"})(["border-radius:0;background:",";padding:"," ",";"],(({theme:e})=>e.eui.euiPageBackgroundColor),(({theme:e})=>e.eui.euiSizeXS),(({theme:e})=>e.eui.euiSizeS)),k=s()(u.EuiFlexGroup).withConfig({displayName:"FlexGroup",componentId:"sc-10yczbx-1"})(["min-height:",";"],(({theme:e})=>e.eui.euiSizeXL)),S=s()(u.EuiFlexItem).withConfig({displayName:"FlexItemLeftBorder",componentId:"sc-10yczbx-2"})(["border-left:1px solid ",";"],(({theme:e})=>e.eui.euiColorLightShade)),w=s()(u.EuiFlexItem).withConfig({displayName:"FlexItemWithMarginRight",componentId:"sc-10yczbx-3"})(["margin-right:",";"],(({theme:e})=>e.eui.euiSizeS)),j=s()(u.EuiLoadingSpinner).withConfig({displayName:"Spinner",componentId:"sc-10yczbx-4"})(["margin:0 ",";"],(({theme:e})=>e.eui.euiSizeS)),O={asPlainText:!0},I=({errors:e,isLoading:t,isSizeOptionDisabled:n,optionsData:r,optionsSelected:o,onOptionsChange:s})=>{var l;const[c,d]=Object(a.useState)(!1),[p,m]=Object(a.useState)(null!==(l=null==o?void 0:o.size)&&void 0!==l?l:100),g=Object(a.useRef)(),h=Object(a.useCallback)((()=>{d(!0)}),[]),v=Object(a.useCallback)((()=>{d(!1)}),[]),I=Object(a.useCallback)((e=>{s&&(e.length>0?s("eventCategoryField",e[0].label):s("eventCategoryField",void 0))}),[s]),T=Object(a.useCallback)((e=>{s&&(e.length>0?s("tiebreakerField",e[0].label):s("tiebreakerField",void 0))}),[s]),C=Object(a.useCallback)((e=>{s&&(e.length>0?s("timestampField",e[0].label):s("timestampField",void 0))}),[s]),M=Object(a.useCallback)((e=>{var t,n,a,i;s&&(m(null==e||null===(t=e.target)||void 0===t?void 0:t.value),null!==(n=g.current)&&void 0!==n&&n.cancel&&(null===(i=g.current)||void 0===i||i.cancel()),g.current=Object(b.debounce)((e=>s("size",e)),800),g.current(null==e||null===(a=e.target)||void 0===a?void 0:a.value))}),[s]),N=Object(a.useMemo)((()=>null!=(null==o?void 0:o.eventCategoryField)?[{label:null==o?void 0:o.eventCategoryField}]:void 0),[null==o?void 0:o.eventCategoryField]),D=Object(a.useMemo)((()=>null!=(null==o?void 0:o.tiebreakerField)?[{label:null==o?void 0:o.tiebreakerField}]:void 0),[null==o?void 0:o.tiebreakerField]),F=Object(a.useMemo)((()=>null!=(null==o?void 0:o.timestampField)?[{label:null==o?void 0:o.timestampField}]:void 0),[null==o?void 0:o.timestampField]);return i.a.createElement(x,null,i.a.createElement(k,{alignItems:"center",justifyContent:"spaceBetween",gutterSize:"none"},i.a.createElement(u.EuiFlexItem,null,e.length>0&&i.a.createElement(y,{ariaLabel:f.l,errors:e}),t&&i.a.createElement(j,{"data-test-subj":"eql-validation-loading",size:"m"})),!s&&i.a.createElement(u.EuiFlexItem,{grow:!1},i.a.createElement(E,null)),s&&i.a.createElement(i.a.Fragment,null,i.a.createElement(w,{grow:!1},i.a.createElement(E,null)),i.a.createElement(S,{grow:!1},i.a.createElement(u.EuiPopover,{button:i.a.createElement(u.EuiButtonIcon,{onClick:h,iconType:"controlsVertical",isDisabled:c,"aria-label":"eql settings","data-test-subj":"eql-settings-trigger"}),isOpen:c,closePopover:v,anchorPosition:"downCenter",ownFocus:!1},i.a.createElement(u.EuiPopoverTitle,null,f.j),i.a.createElement("div",{style:{width:"300px"}},!n&&i.a.createElement(u.EuiFormRow,{label:f.h,helpText:f.g},i.a.createElement(u.EuiFieldNumber,{value:p,onChange:M,min:1,max:1e4})),i.a.createElement(u.EuiFormRow,{label:f.b,helpText:f.a},i.a.createElement(u.EuiComboBox,{options:null==r?void 0:r.keywordFields,selectedOptions:N,singleSelection:O,onChange:I})),i.a.createElement(u.EuiFormRow,{label:f.d,helpText:f.c},i.a.createElement(u.EuiComboBox,{options:null==r?void 0:r.nonDateFields,selectedOptions:D,singleSelection:O,onChange:T})),i.a.createElement(u.EuiFormRow,{label:f.f,helpText:f.e},i.a.createElement(u.EuiComboBox,{options:null==r?void 0:r.dateFields,selectedOptions:F,singleSelection:O,onChange:C}))))))))};var T=n(584);const C=s()(u.EuiTextArea).withConfig({displayName:"TextArea",componentId:"sc-4u43ce-0"})(["display:block;border:",";border-bottom:0;box-shadow:none;min-height:",";"],(({theme:e})=>e.eui.euiBorderThin),(({theme:e})=>e.eui.euiFormControlHeight)),M=({dataTestSubj:e,field:t,isLoading:n=!1,indexPattern:o,showFilterBar:s,idAria:l,optionsData:p,optionsSelected:b,isSizeOptionDisabled:y,onOptionsChange:v,onValidityChange:E,onValiditingChange:x})=>{const{addError:k}=Object(g.a)(),[S,w]=Object(a.useState)([]),{isValidating:j,value:O,setValue:M}=t,{isValid:N,message:D,messages:F,error:A}=Object(T.c)(t),{uiSettings:_}=Object(h.k)().services,R=Object(a.useRef)(new d.FilterManager(_));Object(a.useEffect)((()=>{null!=E&&E(N)}),[N,E]),Object(a.useEffect)((()=>{w(null!=F?F:[])}),[F]),Object(a.useEffect)((()=>{A&&k(A,{title:f.m})}),[A,k]),Object(a.useEffect)((()=>{x&&x(j)}),[j,x]),Object(a.useEffect)((()=>{let e=!0;const t=new r.Subscription;return R.current.setFilters([]),t.add(R.current.getUpdates$().subscribe({next:()=>{if(e){const e=R.current.getFilters(),{filters:t}=O;c()(t,e)||M({...O,filters:e})}}})),()=>{e=!1,t.unsubscribe()}}),[O,R,M]),Object(a.useEffect)((()=>{const{filters:e}=O;c()(e,R.current.getFilters())||R.current.setFilters(e)}),[O,R]);const P=Object(a.useCallback)((e=>{const t=e.target.value;x&&x(!0),w([]),M({filters:O.filters,query:{query:t,language:"eql"},saved_id:null})}),[O,M,x]);return i.a.createElement(u.EuiFormRow,{label:t.label,labelAppend:t.labelAppend,helpText:t.helpText,error:D,isInvalid:!N&&!j,fullWidth:!0,"data-test-subj":e,describedByIds:l?[l]:void 0},i.a.createElement(i.a.Fragment,null,i.a.createElement(C,{"data-test-subj":"eqlQueryBarTextInput",fullWidth:!0,isInvalid:!N&&!j,value:O.query.query,onChange:P}),i.a.createElement(I,{errors:S,isLoading:j,isSizeOptionDisabled:y,optionsData:p,optionsSelected:b,onOptionsChange:v}),s&&i.a.createElement(i.a.Fragment,null,i.a.createElement(u.EuiSpacer,{size:"s"}),i.a.createElement(m,{"data-test-subj":"eqlFilterBar",indexPattern:o,isLoading:n,isRefreshPaused:!1,filterQuery:O.query,filterManager:R.current,filters:R.current.getFilters()||[],displayStyle:"inPage"}))))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return $}));var a=n(34),i=n(32),r=n(4),o=n.n(r),s=n(33),l=n.n(s),c=n(106),u=n(50),d=n(175),p=n(0);const m=p.i18n.translate("xpack.securitySolution.editDataProvider.doesNotExistLabel",{defaultMessage:"does not exist"}),g=p.i18n.translate("xpack.securitySolution.editDataProvider.existsLabel",{defaultMessage:"exists"}),f=p.i18n.translate("xpack.securitySolution.editDataProvider.fieldLabel",{defaultMessage:"Field"}),b=p.i18n.translate("xpack.securitySolution.editDataProvider.placeholder",{defaultMessage:"Select a field"}),y=p.i18n.translate("xpack.securitySolution.editDataProvider.isLabel",{defaultMessage:"is"}),h=p.i18n.translate("xpack.securitySolution.editDataProvider.isOneOfLabel",{defaultMessage:"is one of"}),v=p.i18n.translate("xpack.securitySolution.editDataProvider.isNotLabel",{defaultMessage:"is not"}),E=p.i18n.translate("xpack.securitySolution.editDataProvider.isNotOneOfLabel",{defaultMessage:"is not one of"}),x=p.i18n.translate("xpack.securitySolution.editDataProvider.includesPlaceholder",{defaultMessage:"enter one or more values"}),k=p.i18n.translate("xpack.securitySolution.editDataProvider.operatorLabel",{defaultMessage:"Operator"}),S=p.i18n.translate("xpack.securitySolution.editDataProvider.saveButton",{defaultMessage:"Save"}),w=p.i18n.translate("xpack.securitySolution.editDataProvider.valuePlaceholder",{defaultMessage:"value"}),j=p.i18n.translate("xpack.securitySolution.editDataProvider.valueLabel",{defaultMessage:"Value"}),O=p.i18n.translate("xpack.securitySolution.editDataProvider.selectAnOperatorPlaceholder",{defaultMessage:"Select an operator"}),I=e=>p.i18n.translate("xpack.securitySolution.editDataProvider.unavailableOperator",{values:{operator:e},defaultMessage:"{operator} operator is unavailable with templates"}),T=[{label:y},{label:v},{label:h},{label:E},{label:g},{label:m}],C=[],M=e=>e?Object.keys(e).sort().map((t=>{return{label:t,options:(n=e[t],null!=n.fields&&Object.keys(n.fields).length>0?Object.keys(n.fields):C).map((e=>({label:e})))};var n})):C,N=({browserFields:e,selectedField:t,selectedOperator:n,type:i})=>{const r=t.length>0?t[0].label:"",o=n.length>0?n[0].label:"",s=e&&null!=Object(d.a)(e)[r],l=-1!==Object(a.findIndex)((e=>e.label===o),T),c=i===u.DataProviderType.template&&(o===h||o===E);return s&&l&&!c},D=e=>{switch(e.length>0?e[0].label:""){case y:case v:return c.d;case h:case E:return c.c;case g:case m:return c.b;default:return c.d}},F=e=>{switch(e.length>0?e[0].label:""){case v:case E:case m:return!0;default:return!1}},A=e=>Array.isArray(e)?e.length?`${e[0]}`:"":`${e}`;var _=n(123);const R=({value:e,onChangeCallback:t})=>{const[n,a]=Object(r.useState)(P(e));Object(r.useEffect)((()=>{t(L(n))}),[n,t]);const s=Object(r.useCallback)(((e,t=n)=>{const i=e.trim().toLowerCase();i&&-1===t.findIndex((e=>e.label.trim().toLowerCase()===i))&&a([...n,{label:e}])}),[n]),l=Object(r.useCallback)((e=>{a(e)}),[]);return o.a.createElement(i.EuiComboBox,{noSuggestions:!0,isClearable:!0,"data-test-subj":"is-one-of-combobox-input",selectedOptions:n,placeholder:x,onCreateOption:s,onChange:l})},P=e=>Object(_.k)(e)?e.map((e=>({label:String(e)}))):[],L=e=>e.map((e=>e.label)),q=({value:e,onChangeCallback:t})=>{const[n,a]=Object(r.useState)(B(e));Object(r.useEffect)((()=>{t(A(n))}),[n,t]);const s=Object(r.useCallback)((e=>{a(e.target.value)}),[]);return o.a.createElement(i.EuiFieldText,{className:"edit-data-provider-value",onChange:s,placeholder:w,value:A(n)})},B=e=>{var t;return Object(_.k)(e)?null!==(t=e[0])&&void 0!==t?t:"":e},z="edit-data-provider-save";l.a.div.withConfig({displayName:"HeaderContainer",componentId:"sc-osu70s-0"})(["width:",";"],400).displayName="HeaderContainer";const $=o.a.memo((({andProviderId:e,browserFields:t,field:n,isExcluded:s,onDataProviderEdited:l,operator:u,providerId:d,timelineId:p,value:x,type:w=c.a.default})=>{const[C,A]=Object(r.useState)([{label:n}]),[_,P]=Object(r.useState)(((e,t)=>":"===t?e?[{label:v}]:[{label:y}]:"includes"===t?e?[{label:E}]:[{label:h}]:e?[{label:m}]:[{label:g}])(s,u)),[L,B]=Object(r.useState)(x),$=Object(r.useMemo)((()=>_.length>0&&(_[0].label===h||_[0].label===E)),[_]),V=Object(r.useMemo)((()=>w!==c.a.template&&_.length>0&&_[0].label!==g&&_[0].label!==m&&!$),[$,w,_]),U=Object(r.useMemo)((()=>$&&Array.isArray(L)&&!L.length),[$,L]),H=()=>{const e=document.getElementsByClassName("edit-data-provider-value");if(e.length>0)e[0].focus();else{const e=document.getElementsByClassName(z);e.length>0&&e[0].focus()}},G=Object(r.useCallback)((e=>{A(e),w===c.a.template&&B(`{${e[0].label}}`),H()}),[w]),Q=Object(r.useCallback)((e=>{P(e),H()}),[]),W=Object(r.useCallback)((e=>{B(e)}),[]),K=Object(r.useCallback)((()=>{l({andProviderId:e,excluded:F(_),field:C.length>0?C[0].label:"",id:p,operator:D(_),providerId:d,value:L,type:w})}),[l,e,_,C,p,d,L,w]);return Object(r.useEffect)((()=>((()=>{const e=void 0!==window.pageXOffset?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,t=void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;window.onscroll=()=>window.scrollTo(e,t)})(),()=>{window.onscroll=()=>a.noop})),[]),o.a.createElement(i.EuiPanel,{paddingSize:"s"},o.a.createElement(i.EuiFlexGroup,{direction:"column",gutterSize:"none"},o.a.createElement(i.EuiFlexItem,{grow:!0},o.a.createElement(i.EuiFormRow,{label:f},o.a.createElement(i.EuiComboBox,{autoFocus:!0,"data-test-subj":"field",isClearable:!1,onChange:G,options:M(t),placeholder:b,selectedOptions:C,singleSelection:{asPlainText:!0},fullWidth:!0}))),o.a.createElement(i.EuiFlexItem,{grow:!1},o.a.createElement(i.EuiSpacer,{size:"m"})),o.a.createElement(i.EuiFlexItem,{grow:!0},o.a.createElement(i.EuiFlexGroup,{gutterSize:"s",direction:"row",justifyContent:"spaceBetween"},o.a.createElement(i.EuiFlexItem,{grow:!0},o.a.createElement(i.EuiFormRow,{label:k},o.a.createElement(i.EuiComboBox,{"data-test-subj":"operator",isClearable:!1,onChange:Q,options:T,placeholder:O,selectedOptions:_,singleSelection:{asPlainText:!0},style:{minWidth:152}}))))),o.a.createElement(i.EuiFlexItem,{grow:!1},o.a.createElement(i.EuiSpacer,{size:"m"})),o.a.createElement(i.EuiFlexItem,{grow:!1},V&&o.a.createElement(i.EuiFormRow,{label:j},o.a.createElement(q,{onChangeCallback:W,value:x})),$&&w!==c.a.template&&o.a.createElement(i.EuiFormRow,{label:j},o.a.createElement(R,{onChangeCallback:W,value:x}))),o.a.createElement(i.EuiFlexItem,{grow:!1},o.a.createElement(i.EuiSpacer,{size:"m"})),o.a.createElement(i.EuiFlexItem,{grow:!1},w===c.a.template&&$&&o.a.createElement(o.a.Fragment,null,o.a.createElement(i.EuiCallOut,{color:"warning",iconType:"alert",size:"s",title:I(_[0].label)}),o.a.createElement(i.EuiSpacer,{size:"m"})),o.a.createElement(i.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"none"},o.a.createElement(i.EuiFlexItem,{grow:!1},o.a.createElement(i.EuiButton,{className:z,color:"primary","data-test-subj":"save",fill:!0,isDisabled:!N({type:w,browserFields:t,selectedField:C,selectedOperator:_})||U,onClick:K,size:"m"},S))))))}));$.displayName="StatefulEditDataProvider"},function(e,t,n){"use strict";n.d(t,"a",(function(){return N}));var a=n(34),i=n(4),r=n.n(i),o=n(79),s=n(223),l=n(32),c=n(33),u=n.n(c),d=n(199),p=n(133),m=n(102),g=n(89),f=n(150),b=n(97);const y=["IPv4","IPv6"];var h=n(88),v=n(106);const E="suricata.eve.alert.signature_id",x=u()(l.EuiFlexItem).withConfig({displayName:"SignatureFlexItem",componentId:"sc-1vydse8-0"})(["min-width:77px;"]);x.displayName="SignatureFlexItem";const k=u()(l.EuiBadge).withConfig({displayName:"Badge",componentId:"sc-1vydse8-1"})(["vertical-align:top;"]);k.displayName="Badge";const S=u()(l.EuiFlexItem).withConfig({displayName:"LinkFlexItem",componentId:"sc-1vydse8-2"})(["margin-left:6px;"]);S.displayName="LinkFlexItem";const w=r.a.memo((({tokens:e})=>r.a.createElement(r.a.Fragment,null,e.map((e=>r.a.createElement(b.c,{key:e,grow:!1},r.a.createElement(l.EuiBadge,{iconType:"tag",color:"hollow",title:""},e)))))));w.displayName="Tokens";const j=r.a.memo((({id:e,isDraggable:t,signatureId:n})=>{const a=Object(i.useMemo)((()=>({and:[],enabled:!0,id:Object(m.h)(`suricata-draggable-signature-id-${e}-sig-${n}`),name:String(n),excluded:!1,kqlQuery:"",queryMatch:{field:E,value:n,operator:v.d}})),[e,n]),o=Object(i.useCallback)(((e,t,a)=>a.isDragging?r.a.createElement(p.a,null,r.a.createElement(f.a,{dataProvider:e})):r.a.createElement(l.EuiToolTip,{"data-test-subj":"signature-id-tooltip",content:E},r.a.createElement(k,{iconType:"number",color:"hollow",title:""},n))),[n]);return r.a.createElement(x,{grow:!1},r.a.createElement(p.b,{dataProvider:a,isDraggable:t,render:o,isAggregatable:!0,fieldType:"keyword"}))}));j.displayName="DraggableSignatureId";const O=r.a.memo((({contextId:e,id:t,isDraggable:n,signature:a,signatureId:i})=>{const o=(e=>e.trim().split(" ").reduce(((e,t,n)=>e.length===n&&t===t.toUpperCase()&&""!==t||y.includes(t)?[...e,t]:e),[]))(a);return r.a.createElement(l.EuiFlexGroup,{justifyContent:"center",gutterSize:"none",wrap:!0},r.a.createElement(j,{id:`draggable-signature-id-${e}-${t}`,isDraggable:n,signatureId:i}),r.a.createElement(w,{tokens:o}),r.a.createElement(S,{grow:!1},r.a.createElement(h.b,{"data-test-subj":"draggable-signature-link",field:"suricata.eve.alert.signature",id:`suricata-signature-default-draggable-${e}-${t}-suricata.eve.alert.signature`,isDraggable:n,value:a,tooltipPosition:"bottom"},r.a.createElement("div",null,r.a.createElement(g.c,{link:a},a.split(" ").splice(o.length).join(" "))))))}));O.displayName="SuricataSignature";const I=u()(l.EuiFlexItem).withConfig({displayName:"LinkEuiFlexItem",componentId:"sc-7j8o7u-0"})(["display:inline;"]);I.displayName="LinkEuiFlexItem";const T=r.a.memo((({signatureId:e})=>{const[t,o]=Object(i.useState)(void 0);return Object(i.useEffect)((()=>{let t=!0;return async function(){if(null!=e)try{const i=await(async e=>{const t=(await n.e(15).then(n.t.bind(null,1285,7))).db,i=(r=t,o=e,Object.prototype.hasOwnProperty.call(r,o)?t[e]:null);var r,o;return null!=i?Object(a.uniq)(i):[]})(e);t&&null!=i&&o(i)}catch(e){o(void 0)}else t&&o(void 0)}(),()=>{t=!1}}),[e]),r.a.createElement(l.EuiFlexGroup,{"data-test-subj":"suricataRefs",gutterSize:"none",justifyContent:"center",wrap:!0},t&&t.map((e=>r.a.createElement(I,{key:e,grow:!1},r.a.createElement(l.EuiLink,{href:e,color:"subdued",target:"_blank"},e)))))}));T.displayName="SuricataRefs";const C=u.a.div.withConfig({displayName:"Details",componentId:"sc-1a0lqov-0"})(["margin:5px 0;"]);C.displayName="Details";const M=r.a.memo((({data:e,isDraggable:t,timelineId:n})=>{const i=Object(a.get)("suricata.eve.alert.signature[0]",e),o=Object(a.get)("suricata.eve.alert.signature_id[0]",e);return null!=o&&null!=i?r.a.createElement(C,null,r.a.createElement(O,{contextId:`suricata-signature-${n}-${e._id}`,id:e._id,isDraggable:t,signature:i,signatureId:o}),r.a.createElement(T,{signatureId:o}),r.a.createElement(l.EuiSpacer,{size:"s"}),r.a.createElement(d.a,{data:e,isDraggable:t,timelineId:n})):null}));M.displayName="SuricataDetails";const N={id:o.d.suricata,isInstance:e=>{const t=Object(a.get)("event.module[0]",e);return null!=t&&"suricata"===t.toLowerCase()},renderRow:({data:e,isDraggable:t,scopeId:n})=>r.a.createElement(s.a,null,r.a.createElement(M,{data:e,isDraggable:t,timelineId:n}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return G}));var a=n(34),i=n(4),r=n.n(i),o=n(79),s=n(223),l=n(32),c=n(33),u=n.n(c),d=n(199),p=n(133),m=n(102),g=n(89),f=n(150),b=n(106),y=n(0);const h=y.i18n.translate("xpack.securitySolution.zeek.s0Description",{defaultMessage:"Connection attempt seen, no reply"}),v=y.i18n.translate("xpack.securitySolution.zeek.s1Description",{defaultMessage:"Connection established, not terminated"}),E=y.i18n.translate("xpack.securitySolution.zeek.s2Description",{defaultMessage:"Connection established and close attempt by originator seen (but no reply from responder)"}),x=y.i18n.translate("xpack.securitySolution.zeek.s3Description",{defaultMessage:"Connection established and close attempt by responder seen (but no reply from originator)"}),k=y.i18n.translate("xpack.securitySolution.zeek.sfDescription",{defaultMessage:"Normal SYN/FIN completion"}),S=y.i18n.translate("xpack.securitySolution.zeek.rejDescription",{defaultMessage:"Connection attempt rejected"}),w=y.i18n.translate("xpack.securitySolution.zeek.rstoODescription",{defaultMessage:"Connection established, originator aborted (sent a RST)"}),j=y.i18n.translate("xpack.securitySolution.zeek.rstrDescription",{defaultMessage:"Established, responder aborted"}),O=y.i18n.translate("xpack.securitySolution.zeek.rstosoDescription",{defaultMessage:"Originator sent a SYN followed by a RST, no SYN-ACK from the responder"}),I=y.i18n.translate("xpack.securitySolution.zeek.rstrhDescription",{defaultMessage:"Responder sent a SYN ACK followed by a RST, no SYN from the (purported) originator"}),T=y.i18n.translate("xpack.securitySolution.zeek.shDescription",{defaultMessage:"Originator sent a SYN followed by a FIN, no SYN ACK from the responder"}),C=y.i18n.translate("xpack.securitySolution.zeek.shrDescription",{defaultMessage:"Responder sent a SYN ACK followed by a FIN, no SYN from the originator"}),M=y.i18n.translate("xpack.securitySolution.zeek.othDescription",{defaultMessage:"No SYN seen, just midstream traffic"}),N=u()(l.EuiBadge).withConfig({displayName:"Badge",componentId:"sc-33j7s9-0"})(["vertical-align:top;"]);N.displayName="Badge";const D=u()(l.EuiFlexItem).withConfig({displayName:"TokensFlexItem",componentId:"sc-33j7s9-1"})(["margin-left:3px;"]);D.displayName="TokensFlexItem";const F=u()(l.EuiFlexItem).withConfig({displayName:"LinkFlexItem",componentId:"sc-33j7s9-2"})(["margin-left:6px;"]);F.displayName="LinkFlexItem";const A=e=>e,_=e=>{const t=e.split(".");return t.length>=2&&null!=t[1]?""!==t[1]?t[1]:t[0]:e},R=e=>`Dropped:${e}`,P=e=>`md5: ${e.substr(0,7)}...`,L=e=>`sha1: ${e.substr(0,7)}...`,q=r.a.memo((({id:e,field:t,isDraggable:n,value:a,stringRenderer:o=A})=>{const s=Object(i.useMemo)((()=>({and:[],enabled:!0,id:Object(m.h)(`draggable-zeek-element-draggable-wrapper-${e}-${t}-${a}`),name:String(a),excluded:!1,kqlQuery:"",queryMatch:{field:t,value:String(a),operator:b.d}})),[t,e,a]),c=Object(i.useCallback)(((e,n,i)=>i.isDragging?r.a.createElement(p.a,null,r.a.createElement(f.a,{dataProvider:e})):r.a.createElement(l.EuiToolTip,{"data-test-subj":"badge-tooltip",content:t},r.a.createElement(N,{iconType:"tag",color:"hollow",title:""},o(String(a))))),[t,o,a]);return null!=a?r.a.createElement(D,{grow:!1},r.a.createElement(p.b,{dataProvider:s,isDraggable:n,render:c,isAggregatable:!0,fieldType:"keyword"})):null}));q.displayName="DraggableZeekElement";const B=r.a.memo((({value:e,link:t})=>null!=e?null!=t?r.a.createElement(F,{grow:!1},r.a.createElement("div",null,r.a.createElement(g.c,{link:t},e))):r.a.createElement(F,{grow:!1},r.a.createElement("div",null,r.a.createElement(g.c,{link:e}))):null));B.displayName="Link";const z=r.a.memo((({value:e})=>null!=e?r.a.createElement(F,{grow:!1},r.a.createElement("div",null,r.a.createElement(g.j,{domain:e,overflowIndexStart:1,showDomain:!0,"data-test-subj":"reputationLinkSha"}))):null));z.displayName="TotalVirusLinkSha";const $={S0:h,S1:v,S2:E,S3:x,SF:k,REJ:S,RSTO:w,RSTR:j,RSTOS0:O,RSTRH:I,SH:T,SHR:C,OTH:M},V=r.a.memo((({data:e,isDraggable:t,timelineId:n})=>{const i=`zeek-signature-draggable-zeek-element-${n}-${e._id}`,o=Object(a.get)("zeek.session_id[0]",e),s=Object(a.get)("event.dataset[0]",e),c=Object(a.get)("zeek.ssl.version[0]",e),u=Object(a.get)("zeek.ssl.cipher[0]",e),d=Object(a.get)("zeek.connection.state[0]",e),p=Object(a.get)("zeek.connection.history[0]",e),m=Object(a.get)("zeek.notice.note[0]",e),g=Object(a.get)("zeek.notice.msg[0]",e),f=(e=>null!=e?String(e):null)(Object(a.get)("zeek.notice.dropped[0]",e)),b=Object(a.get)("zeek.dns.query[0]",e),y=Object(a.get)("zeek.dns.qclass_name[0]",e),h=Object(a.get)("http.request.method[0]",e),v=Object(a.get)("http.response.status_code[0]",e),E=Object(a.get)("url.original[0]",e),x=Object(a.get)("zeek.files.sha1[0]",e),k=Object(a.get)("zeek.files.md5[0]",e),S=(e=>{if(null!=e){const t=$[e];return null!=t?`${e} ${t}`:e}return null})(d),w=(e=>null!=e&&null!=$[e]?$[e]:null)(d);return r.a.createElement(r.a.Fragment,null,r.a.createElement(l.EuiFlexGroup,{justifyContent:"center",gutterSize:"none",wrap:!0},r.a.createElement(q,{id:i,field:"zeek.session_id",isDraggable:t,value:o}),r.a.createElement(q,{id:i,field:"event.dataset",isDraggable:t,value:s,stringRenderer:_}),r.a.createElement(q,{id:i,field:"zeek.files.sha1",isDraggable:t,value:x,stringRenderer:L}),r.a.createElement(q,{id:i,field:"zeek.files.md5",isDraggable:t,value:k,stringRenderer:P}),r.a.createElement(q,{id:i,field:"zeek.notice.dropped",isDraggable:t,value:f,stringRenderer:R}),r.a.createElement(q,{id:i,field:"zeek.ssl.version",isDraggable:t,value:c}),r.a.createElement(q,{id:i,field:"zeek.ssl.cipher",isDraggable:t,value:u}),r.a.createElement(q,{id:i,field:"zeek.connection.state",isDraggable:t,value:d}),r.a.createElement(q,{id:i,field:"http.request.method",isDraggable:t,value:h}),r.a.createElement(q,{id:i,field:"zeek.connection.history",isDraggable:t,value:p}),r.a.createElement(q,{id:i,field:"zeek.notice.note",isDraggable:t,value:m}),r.a.createElement(q,{id:i,field:"zeek.dns.query",isDraggable:t,value:b}),r.a.createElement(q,{id:i,field:"zeek.dns.qclass_name",isDraggable:t,value:y}),r.a.createElement(q,{id:i,field:"http.response.status_code",isDraggable:t,value:v})),r.a.createElement(l.EuiFlexGroup,{justifyContent:"center",gutterSize:"none"},r.a.createElement(B,{link:S,value:w}),r.a.createElement(B,{value:u}),r.a.createElement(B,{value:b}),r.a.createElement(B,{value:g}),r.a.createElement(B,{value:E}),r.a.createElement(z,{value:x})))}));V.displayName="ZeekSignature";const U=u.a.div.withConfig({displayName:"Details",componentId:"sc-1p2wwsn-0"})(["margin:5px 0;"]);U.displayName="Details";const H=r.a.memo((({data:e,isDraggable:t,timelineId:n})=>null!=e.zeek?r.a.createElement(U,null,r.a.createElement(V,{data:e,isDraggable:t,timelineId:n}),r.a.createElement(l.EuiSpacer,{size:"s"}),r.a.createElement(d.a,{data:e,isDraggable:t,timelineId:n})):null));H.displayName="ZeekDetails";const G={id:o.d.zeek,isInstance:e=>{const t=Object(a.get)("event.module[0]",e);return null!=t&&"zeek"===t.toLowerCase()},renderRow:({data:e,isDraggable:t,scopeId:n})=>r.a.createElement(s.a,null,r.a.createElement(H,{data:e,isDraggable:t,timelineId:n}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return ne}));var a=n(32),i=n(40),r=n(34),o=n(4),s=n.n(o),l=n(33),c=n.n(l),u=n(114),d=n(85),p=n(1),m=n(77),g=n(87),f=n(221),b=n(396),y=n(124),h=n(187),v=n(89),E=n(171),x=n(120),k=n(506),S=n(160),w=n(0);const j=w.i18n.translate("xpack.securitySolution.host.details.overview.hostIdTitle",{defaultMessage:"Host ID"}),O=w.i18n.translate("xpack.securitySolution.host.details.firstSeenTitle",{defaultMessage:"First seen"}),I=w.i18n.translate("xpack.securitySolution.host.details.lastSeenTitle",{defaultMessage:"Last seen"}),T=w.i18n.translate("xpack.securitySolution.host.details.overview.maxAnomalyScoreByJobTitle",{defaultMessage:"Max anomaly score by job"}),C=w.i18n.translate("xpack.securitySolution.host.details.overview.hostRiskScoreTitle",{defaultMessage:"Host risk score"}),M=w.i18n.translate("xpack.securitySolution.host.details.overview.hostRiskClassification",{defaultMessage:"Host risk classification"}),N=w.i18n.translate("xpack.securitySolution.host.details.overview.ipAddressesTitle",{defaultMessage:"IP addresses"}),D=w.i18n.translate("xpack.securitySolution.host.details.overview.macAddressesTitle",{defaultMessage:"MAC addresses"}),F=w.i18n.translate("xpack.securitySolution.host.details.overview.platformTitle",{defaultMessage:"Platform"}),A=w.i18n.translate("xpack.securitySolution.host.details.overview.osTitle",{defaultMessage:"Operating system"}),_=w.i18n.translate("xpack.securitySolution.host.details.overview.familyTitle",{defaultMessage:"Family"}),R=w.i18n.translate("xpack.securitySolution.host.details.versionLabel",{defaultMessage:"Version"}),P=w.i18n.translate("xpack.securitySolution.host.details.architectureLabel",{defaultMessage:"Architecture"}),L=w.i18n.translate("xpack.securitySolution.host.details.overview.cloudProviderTitle",{defaultMessage:"Cloud provider"}),q=w.i18n.translate("xpack.securitySolution.host.details.overview.regionTitle",{defaultMessage:"Region"}),B=w.i18n.translate("xpack.securitySolution.host.details.overview.instanceIdTitle",{defaultMessage:"Instance ID"}),z=w.i18n.translate("xpack.securitySolution.host.details.overview.machineTypeTitle",{defaultMessage:"Machine type"}),$=w.i18n.translate("xpack.securitySolution.host.details.overview.inspectTitle",{defaultMessage:"Host overview"});var V=n(354);const U=w.i18n.translate("xpack.securitySolution.host.details.endpoint.endpointPolicy",{defaultMessage:"Endpoint integration policy"}),H=w.i18n.translate("xpack.securitySolution.host.details.endpoint.policyStatus",{defaultMessage:"Policy Status"}),G=w.i18n.translate("xpack.securitySolution.host.details.endpoint.sensorversion",{defaultMessage:"Endpoint version"}),Q=w.i18n.translate("xpack.securitySolution.host.details.endpoint.fleetAgentStatus",{defaultMessage:"Agent status"});var W=n(582),K=n(638),Y=n(246);const J=s.a.memo((({contextID:e,data:t})=>{const n=Object(o.useCallback)(((t,n,a)=>s.a.createElement(f.a,{rowItems:[Object(r.getOr)("",t,n)],attrName:a,idPrefix:e?`endpoint-overview-${e}`:"endpoint-overview"})),[e]),i=Object(o.useMemo)((()=>{var e,i,r,o,l,c,u,d,p,m;return[[{title:U,description:null!=t&&null!=t.endpointPolicy?t.endpointPolicy:Object(g.d)()}],[{title:H,description:null!=t&&null!=t.policyStatus?s.a.createElement(a.EuiHealth,{"aria-label":t.policyStatus,color:t.policyStatus===W.a.failure?"danger":t.policyStatus},t.policyStatus):Object(g.d)()}],[{title:G,description:null!=t&&null!=t.sensorVersion?n("sensorVersion",t,"agent.version"):Object(g.d)()}],[{title:Q,description:null!=t&&t.elasticAgentStatus?s.a.createElement(s.a.Fragment,null,s.a.createElement(K.a,{hostStatus:t.elasticAgentStatus}),s.a.createElement(Y.b,{isIsolated:Boolean(t.isolation),pendingActions:{pendingIsolate:null!==(e=null===(i=t.pendingActions)||void 0===i?void 0:i.isolate)&&void 0!==e?e:0,pendingUnIsolate:null!==(r=null===(o=t.pendingActions)||void 0===o?void 0:o.unisolate)&&void 0!==r?r:0,pendingKillProcess:null!==(l=null===(c=t.pendingActions)||void 0===c?void 0:c["kill-process"])&&void 0!==l?l:0,pendingSuspendProcess:null!==(u=null===(d=t.pendingActions)||void 0===d?void 0:d["suspend-process"])&&void 0!==u?u:0,pendingRunningProcesses:null!==(p=null===(m=t.pendingActions)||void 0===m?void 0:m["running-processes"])&&void 0!==p?p:0}})):Object(g.d)()}]]}),[t,n]);return s.a.createElement(s.a.Fragment,null,i.map(((e,t)=>s.a.createElement(V.a,{dataTestSubj:"endpoint-overview",descriptionList:e,key:t}))))}));J.displayName="EndpointOverview";var X=n(291),Z=n(213),ee=n(357);const te=c()(a.EuiFlexGroup).withConfig({displayName:"HostRiskOverviewWrapper",componentId:"sc-16e3omv-0"})(["padding-top:",";width:",";"],(({theme:e})=>e.eui.euiSizeM),(({$width:e})=>e)),ne=s.a.memo((({anomaliesData:e,contextID:t,data:n,endDate:l,id:c,isDraggable:w=!1,isInDetailsSidePanel:U=!1,isLoadingAnomaliesData:H,indexNames:G,loading:Q,narrowDateRange:W,startDate:K,hostName:Y})=>{const ne=Object(x.a)(),ae=Object(E.a)(ne),[ie]=Object(m.q)(p.O),re=Object(o.useMemo)((()=>Y?Object(d.C)([Y]):void 0),[Y]),{from:oe,to:se}=Object(u.a)(),le=Object(o.useMemo)((()=>({from:oe,to:se})),[oe,se]),{data:ce,isLicenseValid:ue}=Object(X.c)({filterQuery:re,riskEntity:d.v.host,skip:null==Y,timerange:le}),de=Object(o.useCallback)(((e,n)=>s.a.createElement(f.a,{rowItems:Object(r.getOr)([],e,n),attrName:e,idPrefix:t?`host-overview-${t}`:"host-overview",isDraggable:w})),[t,w]),[pe,me]=Object(o.useMemo)((()=>{const e=ce&&ce.length>0?ce[0]:void 0;return[{title:s.a.createElement(ee.a,{title:C,riskScoreEntity:d.v.host}),description:s.a.createElement(s.a.Fragment,null,e?Math.round(e.host.risk.calculated_score_norm):Object(g.d)())},{title:s.a.createElement(ee.a,{title:M,riskScoreEntity:d.v.host}),description:s.a.createElement(s.a.Fragment,null,e?s.a.createElement(Z.b,{severity:e.host.risk.calculated_level,hideBackgroundColor:!0}):Object(g.d)())}]}),[ce]),ge=Object(o.useMemo)((()=>[{title:j,description:n&&n.host?Object(f.e)({host:n.host,isDraggable:w,noLink:!0}):Object(g.d)()},{title:O,description:s.a.createElement(b.a,{indexPatterns:G,field:"host.name",value:Y,type:b.b.FIRST_SEEN})},{title:I,description:s.a.createElement(b.a,{indexPatterns:G,field:"host.name",value:Y,type:b.b.LAST_SEEN})}]),[n,G,Y,w]),fe=Object(o.useMemo)((()=>ae?[...ge,{title:T,description:s.a.createElement(k.a,{anomalies:e,startDate:K,endDate:l,isLoading:H,narrowDateRange:W})}]:ge),[e,ge,l,H,W,K,ae]),be=Object(o.useMemo)((()=>[fe,[{title:N,description:s.a.createElement(f.a,{rowItems:Object(r.getOr)([],"host.ip",n),attrName:"host.ip",idPrefix:t?`host-overview-${t}`:"host-overview",isDraggable:w,render:e=>null!=e?s.a.createElement(v.h,{ip:e}):Object(g.d)()})},{title:D,description:de("host.mac",n)},{title:F,description:de("host.os.platform",n)}],[{title:A,description:de("host.os.name",n)},{title:_,description:de("host.os.family",n)},{title:R,description:de("host.os.version",n)},{title:P,description:de("host.architecture",n)}],[{title:L,description:de("cloud.provider",n)},{title:q,description:de("cloud.region",n)},{title:B,description:de("cloud.instance.id",n)},{title:z,description:de("cloud.machine.type",n)}]]),[t,n,fe,de,w]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(y.c,null,s.a.createElement(S.g,{direction:U?"column":"row","data-test-subj":"host-overview"},!U&&s.a.createElement(y.b,{queryId:c,title:$,inspectIndex:0}),be.map(((e,t)=>s.a.createElement(V.a,{descriptionList:e,key:t}))),Q&&s.a.createElement(h.a,{overlay:!0,overlayBackground:ie?i.euiDarkVars.euiPageBackgroundColor:i.euiLightVars.euiPageBackgroundColor,size:"xl"}))),ue&&s.a.createElement(te,{gutterSize:U?"m":"none",direction:U?"column":"row","data-test-subj":"host-risk-overview",$width:U?"100%":"50%"},s.a.createElement(a.EuiFlexItem,null,s.a.createElement(S.d,{listItems:[pe]})),s.a.createElement(a.EuiFlexItem,null,s.a.createElement(S.d,{listItems:[me]}))),n&&null!=n.endpoint?s.a.createElement(s.a.Fragment,null,s.a.createElement(a.EuiHorizontalRule,null),s.a.createElement(S.g,{direction:U?"column":"row"},s.a.createElement(J,{contextID:t,data:n.endpoint}),Q&&s.a.createElement(h.a,{overlay:!0,overlayBackground:ie?i.euiDarkVars.euiPageBackgroundColor:i.euiLightVars.euiPageBackgroundColor,size:"xl"}))):null)}));ne.displayName="HostOverview"},function(e,t,n){"use strict";n.d(t,"a",(function(){return x})),n.d(t,"b",(function(){return S}));var a=n(4),i=n.n(a),r=n(33),o=n.n(r),s=n(899),l=n(32),c=n(77);const u=({integration:e})=>{const t=Object(c.e)(),n=e.integrationTitle,a=`${t}/${e.targetUrl}`;return i.a.createElement(l.EuiLink,{href:a,target:"_blank","data-test-subj":"integrationLink"},n)},d=i.a.memo(u);d.displayName="IntegrationLink";var p=n(565);const m=o()(l.EuiBadge).withConfig({displayName:"PaddedBadge",componentId:"sc-q84pbl-0"})(["margin-left:5px;"]),g=({integration:e})=>{const{installationStatus:t}=e;if(!t.isKnown)return null;const{isInstalled:n,isEnabled:a}=t,r=n?"success":"#E0E5EE",o=n?a?p.c:p.e:p.j,s=n?a?p.b:p.d:p.i;return i.a.createElement(l.EuiToolTip,{content:o},i.a.createElement(m,{color:r,"data-test-subj":"statusBadge"},s))},f=i.a.memo(g);f.displayName="IntegrationStatusBadge";const b=o.a.span.withConfig({displayName:"VersionWarningIconContainer",componentId:"sc-1qsec7-0"})(["margin-left:5px;"]),y=({integration:e})=>{const{installationStatus:t}=e;return t.isKnown&&t.isInstalled&&t.isVersionMismatch?i.a.createElement(b,null,i.a.createElement(l.EuiIconTip,{type:"alert",color:"warning",content:p.f(t.installedVersion,e.requiredVersion)})):null},h=i.a.memo(y);h.displayName="IntegrationVersionMismatchIcon";const v=o.a.div.withConfig({displayName:"Wrapper",componentId:"sc-ea1y1-0"})(["overflow:hidden;"]),E=({integration:e})=>i.a.createElement(v,null,i.a.createElement(d,{integration:e})," ",i.a.createElement(f,{integration:e}),i.a.createElement(h,{integration:e})),x=i.a.memo(E),k=({relatedIntegrations:e})=>{const{integrations:t}=Object(s.a)(e);return i.a.createElement(i.a.Fragment,null,t.map(((e,t)=>i.a.createElement(x,{key:`${e.packageName}-${t}`,integration:e}))))},S=(e,t)=>null==t||0===t.length?[]:[{title:e,description:i.a.createElement(k,{relatedIntegrations:t})}]},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(1057),i=n.n(a),r=n(34),o=n(0);const s=e=>{if(!e)return"";const t=e.split(".")[1];return t?Object(r.startCase)(t):""},l=e=>{const t=[];return Object.entries(e).forEach((([e,n])=>{if(Object(r.isString)(n))try{i.a.render(n,{})}catch(n){t.push((e=>o.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.invalidMustacheTemplateErrorMessage",{defaultMessage:"{key} is not valid mustache template",values:{key:Object(r.startCase)(e)}}))(e))}})),t},c=async(e,t)=>{const n=await(async(e,t)=>{var n;const a=await(null===(n=t.get(e.actionTypeId))||void 0===n?void 0:n.validateParams(e.params));if(a){const e=Object.values(a.errors);if(e.length){const t=e.filter((e=>Object(r.isString)(e)||Object(r.isArray)(e))),n=Object(r.uniq)(Object(r.flattenDeep)(t));if(n.length)return n}}return[]})(e,t);return[...n,...l(e.params)]},u=e=>async(...t)=>{const[{value:n,path:a}]=t,i=[];for(const t of n){const n=await c(t,e);if(n.length){const e=s(t.actionTypeId),a=n.map((e=>`*   ${e}\n`));i.push(`\n**${e}:**\n${a.join("")}`)}}if(i.length)return{code:"ERR_FIELD_FORMAT",path:a,message:`${i.join("\n")}`}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(32),i=n(4),r=n.n(i),o=n(84),s=n(0);const l=s.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.cancelTitle",{defaultMessage:"Cancel"}),c=s.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.overwriteExceptionLabel",{defaultMessage:'Overwrite existing exception lists with conflicting "list_id"'}),u=e=>s.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importExceptionsFailedLabel",{values:{totalExceptions:e},defaultMessage:"Failed to import {totalExceptions} {totalExceptions, plural, =1 {exception} other {exceptions}}"}),d=(e,t,n)=>{const a=n.map((t=>e(t.error.message))),i=new Error(a.join(". "));return i.stack=void 0,i.name="Network errors",i.raw_network_error=t,i},p=({checkBoxLabel:e,closeModal:t,description:n,errorMessage:p,failedDetailed:m,importComplete:g,importData:f,showCheckBox:b=!0,showExceptionsCheckBox:y=!1,showModal:h,submitBtnText:v,subtitle:E,successMessage:x,title:k})=>{const[S,w]=Object(i.useState)(null),[j,O]=Object(i.useState)(!1),[I,T]=Object(i.useState)(!1),[C,M]=Object(i.useState)(!1),{addError:N,addSuccess:D}=Object(o.a)(),F=Object(i.useCallback)((()=>{O(!1),w(null),t(),T(!1),M(!1)}),[O,w,t,T,M]),A=Object(i.useCallback)((async()=>{if(null!=S){O(!0);const e=new AbortController;try{(({importResponse:e,exceptionsIncluded:t,successMessage:n,errorMessage:a,errorMessageDetailed:i,addError:r,addSuccess:o})=>{var l;t?(e.success&&e.success_count>0&&o(n(e.success_count)),e.errors.length>0&&e.rules_count&&r(d(i,e,e.errors),{title:a(e.rules_count-e.success_count)}),e.exceptions_success&&null!=e.exceptions_success_count&&e.exceptions_success_count>0&&o((l=e.exceptions_success_count,s.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.exceptionsSuccessLabel",{values:{totalExceptions:l},defaultMessage:"Successfully imported {totalExceptions} {totalExceptions, plural, =1 {exception} other {exceptions}}."}))),null!=e.exceptions_errors&&e.exceptions_errors.length>0&&r(d(i,e,e.exceptions_errors),{title:u(e.exceptions_errors.length)})):(e.success&&o(n(e.success_count)),e.errors.length>0&&r(d(i,e,e.errors),{title:a(e.errors.length)}))})({importResponse:await f({fileToImport:S[0],overwrite:I,overwriteExceptions:C,signal:e.signal}),exceptionsIncluded:y,successMessage:x,errorMessage:p,errorMessageDetailed:m,addError:N,addSuccess:D}),g(),F()}catch(e){F(),N(e,{title:p(1)})}}}),[S,f,I,C,y,x,p,m,N,D,g,F]),_=Object(i.useCallback)((()=>{F()}),[F]),R=Object(i.useCallback)((()=>{T((e=>!e))}),[]),P=Object(i.useCallback)((()=>{M((e=>!e))}),[]);return r.a.createElement(r.a.Fragment,null,h&&r.a.createElement(a.EuiModal,{onClose:_,maxWidth:"750px"},r.a.createElement(a.EuiModalHeader,null,r.a.createElement(a.EuiModalHeaderTitle,null,k)),r.a.createElement(a.EuiModalBody,null,r.a.createElement(a.EuiText,{size:"s"},r.a.createElement("h4",null,n)),r.a.createElement(a.EuiSpacer,{size:"s"}),r.a.createElement(a.EuiFilePicker,{"data-test-subj":"rule-file-picker",accept:".ndjson",id:"rule-file-picker",initialPromptText:E,onChange:e=>{w(e&&e.length>0?e:null)},display:"large",fullWidth:!0,isLoading:j}),r.a.createElement(a.EuiSpacer,{size:"s"}),b&&r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiCheckbox,{"data-test-subj":"import-data-modal-checkbox-label",id:"import-data-modal-checkbox-label",label:e,checked:I,onChange:R}),y&&r.a.createElement(a.EuiCheckbox,{"data-test-subj":"import-data-modal-exceptions-checkbox-label",id:"import-data-modal-exceptions-checkbox-label",label:c,checked:C,onChange:P}))),r.a.createElement(a.EuiModalFooter,null,r.a.createElement(a.EuiButtonEmpty,{onClick:_},l),r.a.createElement(a.EuiButton,{"data-test-subj":"import-data-modal-button",onClick:A,disabled:null==S||j,fill:!0},v))))};p.displayName="ImportDataModalComponent";const m=r.a.memo(p);m.displayName="ImportDataModal"},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(4),i=n.n(a),r=n(78),o=n(586),s=n(230),l=n(143),c=n(90),u=n(273),d=n(274);const p=({combinedQueries:e,filters:t,headerChildren:n,onlyField:p,paddingSize:m,query:g,showLegend:f,setAbsoluteRangeDatePickerTarget:b=c.a.global,runtimeMappings:y})=>{const h=Object(r.useDispatch)(),{signalIndexName:v}=Object(s.a)(),E=(x=t,Object(a.useMemo)((()=>[...x,...Object(d.d)(!1)]),[x]));var x;const k=Object(a.useCallback)((({x:e})=>{if(!e)return;const[t,n]=e;h(Object(l.setAbsoluteRangeDatePicker)({id:b,from:new Date(t).toISOString(),to:new Date(n).toISOString()}))}),[h,b]);return i.a.createElement(o.a,{combinedQueries:e,filters:E,headerChildren:n,legendPosition:"right",onlyField:p,paddingSize:m,query:g,showLegend:f,showLinkToAlerts:null==p,showStackBy:null==p,showTotalAlertsCount:!0,signalIndexName:v,runtimeMappings:y,title:u.a,titleSize:null==p?"m":"s",updateDateRange:k})};p.displayName="SignalsByCategoryComponent";const m=i.a.memo(p)},function(e,t,n){"use strict";n.d(t,"a",(function(){return q}));var a=n(34),i=n(4),r=n.n(i),o=n(78),s=n(42),l=n(180),c=n(155),u=n(414),d=n(559),p=n(94),m=n(107),g=n(233),f=n(694),b=n(77),y=n(98),h=n(95),v=n(159),E=n(419),x=n(292),k=n(146),S=n(826),w=n(32),j=n(33),O=n.n(j),I=n(247),T=n(648);const C=O()(w.EuiFlexGroup).withConfig({displayName:"UtilityBarFlexGroup",componentId:"sc-srl83m-0"})(["min-width:175px;"]),M=O()(w.EuiFlexItem).withConfig({displayName:"AdditionalFiltersItem",componentId:"sc-srl83m-1"})(["padding:",";"],(({theme:e})=>e.eui.euiSizeS)),N=O()(M).withConfig({displayName:"BuildingBlockContainer",componentId:"sc-srl83m-2"})(["background:",";"],(({theme:e})=>e.eui.euiColorHighlight)),D=({areEventsLoading:e,onShowBuildingBlockAlertsChanged:t,showBuildingBlockAlerts:n,onShowOnlyThreatIndicatorAlertsChanged:a,showOnlyThreatIndicatorAlerts:o})=>{const s=Object(i.useCallback)((e=>r.a.createElement(C,{direction:"column",gutterSize:"none"},r.a.createElement(N,null,r.a.createElement(w.EuiCheckbox,{id:"showBuildingBlockAlertsCheckbox","aria-label":"showBuildingBlockAlerts",onChange:n=>{e(),t(n.target.checked)},checked:n,color:"text","data-test-subj":"showBuildingBlockAlertsCheckbox",label:T.b})),r.a.createElement(M,null,r.a.createElement(w.EuiCheckbox,{id:"showOnlyThreatIndicatorAlertsCheckbox","aria-label":"showOnlyThreatIndicatorAlerts",onChange:t=>{e(),a(t.target.checked)},checked:o,color:"text","data-test-subj":"showOnlyThreatIndicatorAlertsCheckbox",label:T.c})))),[t,a,n,o]);return r.a.createElement(I.b,{dataTestSubj:"additionalFilters",disabled:e,iconType:"arrowDown",iconSide:"right",ownFocus:!0,popoverContent:s},T.a)};var F=n(274),A=n(651),_=n(118),R=n(13),P=n(568);const L=({defaultFilters:e,from:t,globalFilters:n,globalQuery:l,hasIndexMaintenance:y,hasIndexWrite:w,isSelectAllChecked:j,loading:O,loadingEventIds:I,onRuleChange:T,onShowBuildingBlockAlertsChanged:C,onShowOnlyThreatIndicatorAlertsChanged:M,showBuildingBlockAlerts:N,showOnlyThreatIndicatorAlerts:L,tableId:q,to:B,filterGroup:z="open"})=>{var $,V;const U=Object(o.useDispatch)(),{globalQueries:H}=Object(o.useSelector)((e=>Object(u.a)(e,q))),{browserFields:G,indexPattern:Q,selectedPatterns:W}=Object(p.d)(h.SourcererScopeName.detections),K=Object(b.k)(),Y=Object(R.b)(),J=Object(R.b)().isEnterprise()?5:4,X=Object(i.useCallback)((a=>null!=G&&null!=Q?Object(k.a)({config:Object(s.getEsQueryConfig)(K.services.uiSettings),dataProviders:[],indexPattern:Q,browserFields:G,filters:[...null!=e?e:[],...n,...a,...Object(A.a)(t,B)],kqlQuery:l,kqlMode:l.language}):null),[G,e,n,l,Q,K,B,t]);Object(g.a)({id:q,filterQuery:null===($=X([]))||void 0===$?void 0:$.filterQuery,kqlError:null===(V=X([]))||void 0===V?void 0:V.kqlError,query:l,startDate:t,endDate:B}),Object(i.useEffect)((()=>{j&&U(c.a.setTGridSelectAll({id:q,selectAll:!1}))}),[U,j,q]);const Z=Object(i.useMemo)((()=>r.a.createElement(D,{areEventsLoading:I.length>0,onShowBuildingBlockAlertsChanged:C,showBuildingBlockAlerts:N,onShowOnlyThreatIndicatorAlertsChanged:M,showOnlyThreatIndicatorAlerts:L})),[I.length,C,M,N,L]),ee=Object(i.useMemo)((()=>{const t=Object(F.a)(z);return Object(a.isEmpty)(e)?t:null==e||Object(a.isEmpty)(e)?void 0:[...e,...t]}),[e,z]),{filterManager:te}=K.services.data.query,ne=Object(m.a)("tGridEnabled");Object(i.useEffect)((()=>{U(c.a.initializeTGridSettings({defaultColumns:Object(S.b)(Y).map((e=>ne||null!=e.initialWidth?e:{...e,initialWidth:v.a})),id:q,loadingText:_.z,queryFields:F.h,title:_.k,showCheckboxes:!0}))}),[U,te,ne,q,Y]);const ae=Object(i.useMemo)((()=>Object(E.a)(J)),[J]),ie=Object(i.useCallback)((e=>{e.forEach((e=>e.refetch&&e.refetch()))}),[]),re=(({onClose:e,onSuccess:t}={})=>{const{cases:n}=Object(b.k)().services,a=Object(b.i)(),r=n.hooks.getUseCasesAddToNewCaseFlyout({onClose:e,onSuccess:t}),o=n.hooks.getUseCasesAddToExistingCaseModal({onClose:e,onRowClick:t});return Object(i.useMemo)((()=>a.create&&a.read?[{label:_.j,key:"attach-new-case","data-test-subj":"attach-new-case",disableOnQuery:!0,disabledLabel:_.h,onClick:e=>{const t=e?n.helpers.groupAlertsByRule(e):[];r.open({attachments:t})}},{label:_.i,key:"attach-existing-case",disableOnQuery:!0,disabledLabel:_.h,"data-test-subj":"attach-existing-case",onClick:e=>{const t=e?n.helpers.groupAlertsByRule(e):[];o.open({attachments:t})}}]:[]),[n.helpers,r,a.create,a.read,o])})(),oe=Object(P.a)({localFilters:null!=ee?ee:[],tableId:q,from:t,to:B,scopeId:h.SourcererScopeName.detections}),se=Object(i.useMemo)((()=>({onAlertStatusActionSuccess:()=>{ie(H)},customBulkActions:[...re,oe]})),[H,ie,re,oe]);return O||Object(a.isEmpty)(W)?null:r.a.createElement(d.a,{additionalFilters:Z,currentFilter:z,defaultCellActions:f.a,defaultModel:Object(F.f)(Y),end:B,bulkActions:se,entityType:"events",hasAlertsCrud:w&&y,tableId:q,leadingControlColumns:ae,onRuleChange:T,pageFilters:ee,renderCellValue:S.a,rowRenderers:x.b,scopeId:h.SourcererScopeName.detections,start:t})},q=Object(o.connect)((()=>{const e=c.b.getTableByIdSelector(),t=y.d.globalSelector();return(n,a)=>{var i;const{tableId:r}=a,o=null!==(i=e(n,r))&&void 0!==i?i:l.a,{isSelectAllChecked:s,loadingEventIds:c}=o,u=t(n),{query:d,filters:p}=u;return{globalQuery:d,globalFilters:p,isSelectAllChecked:s,loadingEventIds:c}}}))(r.a.memo(L))},function(e,t,n){"use strict";n.d(t,"a",(function(){return L}));var a=n(34),i=n(4),r=n.n(i),o=n(78),s=n(79),l=n(81),c=n(86),u=n(32),d=n(47),p=n.n(d),m=n(33),g=n.n(m),f=n(87),b=n(604),y=n(106),h=n(410);const v=g()(u.EuiBadge).withConfig({displayName:"ProviderBadgeStyled",componentId:"sc-1kjk6zz-0"})([".euiToolTipAnchor{&::after{font-style:normal;content:'|';padding:0px 3px;}}&.globalFilterItem{white-space:nowrap;min-width:",";display:flex;&.globalFilterItem-isDisabled{text-decoration:line-through;font-weight:400;font-style:italic;}&.globalFilterItem-isError{box-shadow:0 1px 1px -1px rgba(152,162,179,0.2),0 3px 2px -2px rgba(152,162,179,0.2),inset 0 0 0 1px #bd271e;}}"],(({$timelineType:e})=>e===s.n.template?"140px":"none"));v.displayName="ProviderBadgeStyled";const E=g.a.div.withConfig({displayName:"ProviderFieldBadge",componentId:"sc-1kjk6zz-1"})(["display:block;color:#fff;padding:6px 8px;font-size:0.6em;"]),x=g()(E).withConfig({displayName:"StyledTemplateFieldBadge",componentId:"sc-1kjk6zz-2"})(["background:",";text-transform:uppercase;"],(({theme:e})=>e.eui.euiColorVis3_behindText)),k=g()(E).withConfig({displayName:"ConvertFieldBadge",componentId:"sc-1kjk6zz-3"})(["background:",";cursor:pointer;&:hover{text-decoration:underline;}"],(({theme:e})=>e.eui.euiColorDarkShade)),S=({type:e,toggleType:t})=>e!==y.a.template?r.a.createElement(k,{onClick:t},h.d):r.a.createElement(x,null,h.v),w=r.a.memo(S),j={tabIndex:-1},O=r.a.memo((({deleteProvider:e,field:t,isEnabled:n,isExcluded:o,operator:l,providerId:c,togglePopover:u,toggleType:d,displayValue:m,val:g,type:E,timelineType:x})=>{const k=Object(i.useCallback)((t=>{t.stopPropagation&&t.stopPropagation(),e()}),[e]),S=Object(i.useMemo)((()=>p()("globalFilterItem",{"globalFilterItem-isDisabled":!n,"globalFilterItem-isExcluded":o})),[n,o]),O=Object(i.useMemo)((()=>Object(a.isString)(g)&&""===g?Object(f.b)():g),[g]),I=Object(i.useMemo)((()=>o?r.a.createElement("span",null,h.p," "):null),[o]),T=Object(i.useMemo)((()=>r.a.createElement(r.a.Fragment,null,I,l!==y.b?r.a.createElement("span",{className:"field-value"},`${t}: "${"includes"===l?m:O}"`):r.a.createElement("span",{className:"field-value"},t," ",h.j))),[m,t,O,l,I]),C=Object(i.useMemo)((()=>h.u({field:t,value:`${O}`})),[t,O]);return r.a.createElement(b.a,{id:`${c}-${t}-${g}`},r.a.createElement(r.a.Fragment,null,r.a.createElement(v,{className:S,color:"hollow",title:"",iconOnClick:k,iconOnClickAriaLabel:h.s,iconType:"cross",iconSide:"right",onClick:u,onClickAriaLabel:C,closeButtonProps:j,"data-test-subj":"providerBadge",$timelineType:x},T),x===s.n.template&&l!==y.c&&r.a.createElement(w,{toggleType:d,type:E})))}));O.displayName="ProviderBadge";var I=n(6),T=n.n(I),C=n(907);const M="edit-data-provider",N="exclude-data-provider",D="enable-data-provider",F="filter-for-field-present-data-provider",A="delete-data-provider",_=g()(u.EuiPopover).withConfig({displayName:"MyEuiPopover",componentId:"sc-cqo117-0"})(["height:100%;user-select:none;"]);_.displayName="MyEuiPopover";class provider_item_actions_ProviderItemActions extends r.a.PureComponent{constructor(...e){super(...e),T()(this,"onDataProviderEdited",(({andProviderId:e,excluded:t,field:n,id:a,operator:i,providerId:r,value:o,type:s})=>{null!=this.props.onDataProviderEdited&&this.props.onDataProviderEdited({andProviderId:e,excluded:t,field:n,id:a,operator:i,providerId:r,value:o,type:s}),this.props.closePopover()})),T()(this,"onFilterForFieldPresent",(()=>{const{andProviderId:e,field:t,timelineId:n,providerId:a,value:i,type:r}=this.props;null!=this.props.onDataProviderEdited&&this.props.onDataProviderEdited({andProviderId:e,excluded:!1,field:t,id:`${n}`,operator:y.b,providerId:a,value:i,type:r}),this.props.closePopover()}))}render(){const{andProviderId:e,browserFields:t,button:n,closePopover:a,deleteProvider:i,field:o,isEnabled:l,isExcluded:c,isLoading:d,isOpen:p,operator:m,providerId:g,timelineId:f,timelineType:b,toggleEnabledProvider:v,toggleExcludedProvider:E,toggleTypeProvider:x,value:k,type:S}=this.props,w=(({andProviderId:e,browserFields:t,deleteItem:n,field:a,isEnabled:i,isExcluded:o,isLoading:l,operator:c,onDataProviderEdited:u,onFilterForFieldPresent:d,providerId:p,timelineId:m,timelineType:g,toggleEnabled:f,toggleExcluded:b,toggleType:v,type:E,value:x})=>[{id:0,items:[{className:M,disabled:l,icon:"pencil",name:h.g,panel:1},{className:N,disabled:l,icon:o?"plusInCircle":"minusInCircle",name:o?h.o:h.i,onClick:b},{className:D,disabled:l,icon:i?"eyeClosed":"eye",name:i?h.w:h.t,onClick:f},{className:F,disabled:l,icon:"logstashFilter",name:h.k,onClick:d},g===s.n.template?{className:"convert-to-field-data-provider",disabled:l||c===y.c,icon:"visText",name:E===y.a.template?h.c:h.d,onClick:v}:{name:null},{className:A,disabled:l,icon:"trash",name:h.e,onClick:n}].filter((e=>null!=e.name))},{content:null!=t&&null!=m&&null!=u?r.a.createElement(C.a,{andProviderId:e,browserFields:t,field:a,isExcluded:o,onDataProviderEdited:u,operator:c,providerId:p,timelineId:m,value:x,type:E}):null,id:1,title:h.h,width:400}])({andProviderId:e,browserFields:t,deleteItem:i,field:o,isEnabled:l,isExcluded:c,isLoading:d,onDataProviderEdited:this.onDataProviderEdited,onFilterForFieldPresent:this.onFilterForFieldPresent,operator:m,providerId:g,timelineId:f,timelineType:b,toggleEnabled:v,toggleExcluded:E,toggleType:x,value:k,type:S});return r.a.createElement(_,{id:`popoverFor_${g}-${o}-${k}`,isOpen:p,closePopover:a,button:n,anchorPosition:"downCenter",panelPaddingSize:"none",ownFocus:!0},r.a.createElement("div",{style:{userSelect:"none"}},r.a.createElement(u.EuiContextMenu,{initialPanelId:0,panels:w,"data-test-subj":"providerActions"})))}}var R=n(395),P=n(112);const L=r.a.memo((({andProviderId:e,browserFields:t,deleteProvider:n,field:u,kqlQuery:d,isEnabled:p,isExcluded:m,isPopoverOpen:g,onDataProviderEdited:f,operator:b,providerId:h,register:v,setIsPopoverOpen:E,timelineId:x,toggleEnabledProvider:k,toggleExcludedProvider:S,toggleTypeProvider:w,displayValue:j,val:I,type:T=y.a.default,wrapperRef:C})=>{const M=Object(i.useMemo)((()=>c.b.getTimelineByIdSelector()),[]),N=Object(l.b)((e=>{var t,n;return x&&null!==(t=null===(n=M(e,x))||void 0===n?void 0:n.timelineType)&&void 0!==t?t:s.n.default})),{isLoading:D}=Object(l.a)((e=>{var t;return null!==(t=M(e,null!=x?x:""))&&void 0!==t?t:P.b})),F=Object(i.useCallback)((()=>{E(!g)}),[g,E]),A=Object(i.useCallback)((()=>{var e;E(!1),null==C||null===(e=C.current)||void 0===e||e.focus()}),[C,E]),_=Object(i.useCallback)((()=>{k(),A()}),[A,k]),L=Object(i.useCallback)((()=>{S(),A()}),[S,A]),q=Object(i.useCallback)((()=>{w(),A()}),[w,A]),[B,z]=Object(i.useState)(!1),$=Object(o.useDispatch)();Object(i.useEffect)((()=>{null!=v&&($(R.a.registerProvider({provider:{...v,and:[]}})),z(!0))}),[B,$,v,z]);const V=Object(i.useCallback)((()=>{B&&null!=v&&$(R.a.unRegisterProvider({id:v.id}))}),[B,$,v]);Object(i.useEffect)((()=>()=>{V()}),[V]);const U=Object(i.useMemo)((()=>r.a.createElement(O,{deleteProvider:D?a.noop:n,field:u,kqlQuery:d,isEnabled:p,isExcluded:m,providerId:h,togglePopover:F,toggleType:q,displayValue:null!=j?j:String(I),val:I,operator:b,type:T,timelineType:N})),[n,j,u,p,m,D,d,q,b,h,N,F,T,I]);return r.a.createElement(provider_item_actions_ProviderItemActions,{andProviderId:e,browserFields:t,button:U,closePopover:A,deleteProvider:n,field:u,kqlQuery:d,isEnabled:p,isExcluded:m,isLoading:D,isOpen:g,onDataProviderEdited:f,operator:b,providerId:h,timelineId:x,timelineType:N,toggleEnabledProvider:_,toggleExcludedProvider:L,toggleTypeProvider:q,value:I,type:T})}));L.displayName="ProviderItemBadge"},function(e,t,n){"use strict";n.d(t,"a",(function(){return A}));var a=n(4),i=n.n(a),r=n(32),o=n(40),s=n(78),l=n(33),c=n.n(l),u=n(99),d=n(81),p=n(90),m=n(148),g=n(539),f=n(184),b=n(41),y=n(836);function h(e){return e?{timeRange:{from:e.from,to:e.to}}:[]}var v=n(831);const E=i.a.memo((e=>{const t=Object(b.useKibana)(),n=Object(a.useMemo)((()=>function(e){return{relatedEvents:async({entityID:t,timeRange:n,indexPatterns:a})=>({...await e.services.http.post("/api/endpoint/resolver/events",{query:{},body:JSON.stringify({indexPatterns:a,...h(n),filter:JSON.stringify({bool:{filter:[{term:{"process.entity_id":t}},{bool:{must_not:{term:{"event.category":"process"}}}}]}})})}),entityID:t}),eventsWithEntityIDAndCategory({entityID:t,category:n,after:a,timeRange:i,indexPatterns:r}){const o={query:{afterEvent:a,limit:25},body:{...h(i),indexPatterns:r}};return"alert"===n?e.services.http.post("/api/endpoint/resolver/events",{query:o.query,body:JSON.stringify({...o.body,entityType:"alerts",eventID:t})}):e.services.http.post("/api/endpoint/resolver/events",{query:o.query,body:JSON.stringify({...o.body,filter:JSON.stringify({bool:{filter:[{term:{"process.entity_id":t}},{term:{"event.category":n}}]}})})})},async nodeData({ids:t,timeRange:n,indexPatterns:a,limit:i}){const r={query:{limit:i},body:JSON.stringify({indexPatterns:a,...h(n),filter:JSON.stringify({bool:{filter:[{terms:{"process.entity_id":t}},{term:{"event.category":"process"}}]}})})};return(await e.services.http.post("/api/endpoint/resolver/events",r)).events},async event({nodeID:t,eventID:n,eventCategory:a,eventTimestamp:i,winlogRecordID:r,timeRange:o,indexPatterns:s}){const l=void 0===n?{bool:{filter:[{terms:{"event.category":a}},{term:{"process.entity_id":t}},{term:{"@timestamp":i}},{term:{"winlog.record_id":r}}]}}:{bool:{filter:[{term:{"event.id":n}}]}};if(!1===a.includes("alert")){const t=await e.services.http.post("/api/endpoint/resolver/events",{query:{limit:1},body:JSON.stringify({indexPatterns:s,...h(o),filter:JSON.stringify(l)})}),[n]=t.events;return null!=n?n:null}{const t=await e.services.http.post("/api/endpoint/resolver/events",{query:{limit:1},body:JSON.stringify({indexPatterns:s,...h(o),entityType:"alertDetail",eventID:n})}),[a]=t.events;return null!=a?a:null}},resolverTree:async({dataId:t,schema:n,timeRange:a,indices:i,ancestors:r,descendants:o})=>e.services.http.post("/api/endpoint/resolver/tree",{body:JSON.stringify({ancestors:r,descendants:o,timeRange:a,schema:n,nodes:[t],indexPatterns:i})}),entities:async({_id:t,indices:n,signal:a})=>e.services.http.get("/api/endpoint/resolver/entity",{signal:a,query:{_id:t,indices:n}})}}(t)),[t]),r=Object(a.useMemo)((()=>Object(y.a)(n)),[n]),[o,l]=Object(a.useState)(r);return Object(a.useEffect)((()=>{e.shouldUpdate&&l(Object(y.a)(n))}),[n,e.shouldUpdate]),i.a.createElement(s.Provider,{store:o},i.a.createElement(v.a,e))}));var x=n(630),k=n(86),S=n(112),w=n(155),j=n(180);const O="sessionViewFullScreen",I=Object(l.css)(["display:flex;flex-direction:column;flex:1;width:100%;"]),T=c.a.div.withConfig({displayName:"OverlayContainer",componentId:"sc-g96n2a-0"})(["",""],I),C=Object(l.css)(["position:fixed;top:0;bottom:2em;left:0;right:0;z-index:",";"],o.euiThemeVars.euiZLevel3),M=c.a.div.withConfig({displayName:"FullScreenOverlayContainer",componentId:"sc-g96n2a-1"})(["",""],C),N=c()(E).withConfig({displayName:"StyledResolver",componentId:"sc-g96n2a-2"})(["height:100%;"]),D=c()(r.EuiFlexItem).withConfig({displayName:"ScrollableFlexItem",componentId:"sc-g96n2a-3"})([""," overflow:hidden;width:100%;&.","{","}"],(({theme:e})=>`background-color: ${e.eui.euiColorEmptyShade};`),O,(({theme:e})=>`padding: 0 ${e.eui.euiSizeM}`)),F=({SessionView:e,Navigation:t,scopeId:n})=>{const o=Object(s.useDispatch)(),{globalFullScreen:l}=Object(m.a)(),{timelineFullScreen:c}=Object(m.c)(),b=Object(a.useMemo)((()=>Object(u.isInTableScope)(n)?w.b.getTableByIdSelector():Object(u.isTimelineScope)(n)?k.b.getTimelineByIdSelector():void 0),[n]),y=Object(u.isInTableScope)(n)?j.a:S.b,{graphEventId:h,sessionViewConfig:v}=Object(d.a)((e=>{var t;return null!==(t=b&&b(e,n))&&void 0!==t?t:y})),E=Object(a.useMemo)((()=>Object(g.b)({globalFullScreen:l,isActiveTimelines:Object(u.isActiveTimeline)(n),timelineFullScreen:c})),[l,n,c]);Object(a.useEffect)((()=>()=>{const e=Object(u.getScopedActions)(n);e&&o(e.updateGraphEventId({id:n,graphEventId:""})),Object(u.isActiveTimeline)(n)?o(f.b.setFullScreen({id:p.a.timeline,fullScreen:!1})):o(f.b.setFullScreen({id:p.a.global,fullScreen:!1}))}),[o,n]);const{from:F,to:A,shouldUpdate:_,selectedPatterns:R}=Object(x.a)(Object(u.isActiveTimeline)(n)),P=Object(a.useRef)(null);return Object(a.useLayoutEffect)((()=>{E&&P.current?P.current.setAttribute("style",C.join("")):P.current&&P.current.setAttribute("style",I.join(""))}),[E]),Object(u.isActiveTimeline)(n)||null===v?E&&!Object(u.isActiveTimeline)(n)?i.a.createElement(M,{"data-test-subj":"overlayContainer"},i.a.createElement(r.EuiHorizontalRule,{margin:"none"}),i.a.createElement(r.EuiFlexGroup,{gutterSize:"none",justifyContent:"spaceBetween"},i.a.createElement(r.EuiFlexItem,{grow:!1},t)),i.a.createElement(r.EuiHorizontalRule,{margin:"none"}),void 0!==h?i.a.createElement(N,{databaseDocumentID:h,resolverComponentInstanceID:n,indices:R,shouldUpdate:_,filters:{from:F,to:A}}):i.a.createElement(r.EuiFlexGroup,{alignItems:"center",justifyContent:"center",style:{height:"100%"}},i.a.createElement(r.EuiLoadingSpinner,{size:"xl"}))):i.a.createElement(T,{"data-test-subj":"overlayContainer"},i.a.createElement(r.EuiHorizontalRule,{margin:"none"}),i.a.createElement(r.EuiFlexGroup,{gutterSize:"none",justifyContent:"spaceBetween"},i.a.createElement(r.EuiFlexItem,{grow:!1},t)),i.a.createElement(r.EuiHorizontalRule,{margin:"none"}),void 0!==h?i.a.createElement(N,{databaseDocumentID:h,resolverComponentInstanceID:n,indices:R,shouldUpdate:_,filters:{from:F,to:A}}):i.a.createElement(r.EuiFlexGroup,{alignItems:"center",justifyContent:"center",style:{height:"100%"}},i.a.createElement(r.EuiLoadingSpinner,{size:"xl"}))):i.a.createElement(T,{"data-test-subj":"overlayContainer",ref:P},i.a.createElement(r.EuiFlexGroup,{alignItems:"flexStart",gutterSize:"none",direction:"column"},i.a.createElement(r.EuiHorizontalRule,{margin:"none"}),i.a.createElement(r.EuiFlexItem,{grow:!1},t),i.a.createElement(r.EuiHorizontalRule,{margin:"none"}),i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement(D,{grow:2,className:E?O:""},e)))},A=i.a.memo(F)},,function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n(32),i=n(4),r=n.n(i),o=n(33),s=n.n(o),l=n(609),c=n(296),u=n(79);const d=s()(a.EuiFieldText).withConfig({displayName:"StyledEuiFieldText",componentId:"sc-oqcycb-0"})(["padding-left:12px;padding-right:40px;&[readonly]{cursor:pointer;background-size:0 100%;background-repeat:no-repeat;&:focus{background-color:",";background-image:linear-gradient( to top,",","," 2px,transparent 2px,transparent 100% );background-size:100% 100%;}}& + .euiFormControlLayoutIcons{left:unset;right:12px;}"],(({theme:e})=>e.eui.euiFormBackgroundColor),(({theme:e})=>e.eui.euiFocusRingColor),(({theme:e})=>e.eui.euiFocusRingColor)),p=e=>[{description:c.a,favorite:[],label:c.b,id:void 0,title:c.b,checked:"-1"===e?"on":void 0}],m=({isDisabled:e,hideUntitled:t=!1,timelineId:n,timelineTitle:o,timelineType:s=u.n.template,onTimelineChange:m,placeholder:g})=>{const[f,b]=Object(i.useState)(!1),y=Object(i.useCallback)((()=>{b(!1)}),[]),h=Object(i.useCallback)((()=>{b(!0)}),[]),v=Object(i.useMemo)((()=>r.a.createElement(d,{readOnly:!0,disabled:e,onFocus:h,onClick:h,value:null!=o?o:c.b,icon:"arrowDown"})),[h,e,o]),E=Object(i.useCallback)((({timelines:e,onlyFavorites:a,searchTimelineValue:i})=>[...a||""!==i?[]:p(null==n?"-1":n),...e.filter((e=>!t||""!==e.title)).map(((e,t)=>({description:e.description,favorite:e.favorite,label:e.title,id:s===u.n.template?e.templateTimelineId:e.savedObjectId,key:`${e.title}-${t}`,title:e.title,checked:[e.savedObjectId,e.templateTimelineId].includes(n)?"on":void 0})))]),[t,n,s]);return r.a.createElement(a.EuiInputPopover,{id:"searchTimelinePopover",input:v,isOpen:f,closePopover:y},r.a.createElement(l.a,{hideUntitled:t,getSelectableOptions:E,onClosePopover:y,onTimelineChange:m,timelineType:s,placeholder:g}))},g=Object(i.memo)(m);var f=n(100);const b=({dataTestSubj:e,field:t,idAria:n,isDisabled:o=!1,placeholder:s})=>{const[l,c]=Object(i.useState)(null),[u,d]=Object(i.useState)(null),{isInvalid:p,errorMessage:m}=Object(f.i)(t);Object(i.useEffect)((()=>{const{id:e,title:n}=t.value;l!==e&&(c(e),d(n))}),[t.value,l]);const b=Object(i.useCallback)(((e,n)=>{null===n?t.setValue({id:n,title:null}):l!==n&&t.setValue({id:n,title:e})}),[t,l]);return r.a.createElement(a.EuiFormRow,{label:t.label,labelAppend:t.labelAppend,helpText:t.helpText,error:m,isInvalid:p,"data-test-subj":e,describedByIds:n?[n]:void 0},r.a.createElement(g,{isDisabled:o,hideUntitled:!0,timelineId:l,timelineTitle:u,onTimelineChange:b,placeholder:s}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return c}));var a=n(4),i=n(582),r=n(0);r.i18n.translate("xpack.securitySolution.overviewHost.errorSearchDescription",{defaultMessage:"An error has occurred on host overview search"});const o=r.i18n.translate("xpack.securitySolution.overviewHost.failSearchDescription",{defaultMessage:"Failed to run search on host overview"});var s=n(130);const l="hostsDetailsQuery",c=({endDate:e,hostName:t,indexNames:n,id:r=l,skip:c=!1,startDate:u})=>{const{loading:d,result:p,search:m,refetch:g,inspect:f}=Object(s.a)({factoryQueryType:i.d.details,initialResult:{hostDetails:{}},errorMessage:o,abort:c}),b=Object(a.useMemo)((()=>({endDate:e,hostDetails:p.hostDetails,id:r,inspect:f,isInspected:!1,refetch:g,startDate:u})),[e,p.hostDetails,r,f,g,u]),y=Object(a.useMemo)((()=>({defaultIndex:n,factoryQueryType:i.d.details,hostName:t,timerange:{interval:"12h",from:u,to:e}})),[e,t,n,u]);return Object(a.useEffect)((()=>{c||m(y)}),[y,m,c]),[d,b]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return z}));var a=n(32),i=n(40),r=n(34),o=n(4),s=n.n(o),l=n(33),c=n.n(l),u=n(114),d=n(85),p=n(1),m=n(77),g=n(87),f=n(221),b=n(396),y=n(124),h=n(187),v=n(89),E=n(171),x=n(120),k=n(506),S=n(160),w=n(0);const j=w.i18n.translate("xpack.securitySolution.user.details.overview.userIdTitle",{defaultMessage:"User ID"}),O=w.i18n.translate("xpack.securitySolution.user.details.overview.userDomainTitle",{defaultMessage:"Domain"}),I=w.i18n.translate("xpack.securitySolution.user.details.overview.familyTitle",{defaultMessage:"Family"}),T=w.i18n.translate("xpack.securitySolution.user.details.overview.ipAddressesTitle",{defaultMessage:"IP addresses"}),C=w.i18n.translate("xpack.securitySolution.user.details.overview.osTitle",{defaultMessage:"Operating system"}),M=w.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.firstSeenTitle",{defaultMessage:"First seen"}),N=w.i18n.translate("xpack.securitySolution.user.ipDetails.ipOverview.lastSeenTitle",{defaultMessage:"Last seen"}),D=w.i18n.translate("xpack.securitySolution.user.details.overview.inspectTitle",{defaultMessage:"User overview"}),F=w.i18n.translate("xpack.securitySolution.user.details.overview.maxAnomalyScoreByJobTitle",{defaultMessage:"Max anomaly score by job"}),A=w.i18n.translate("xpack.securitySolution.user.details.overview.userRiskScoreTitle",{defaultMessage:"User risk score"}),_=w.i18n.translate("xpack.securitySolution.user.details.overview.userRiskClassification",{defaultMessage:"User risk classification"});var R=n(354),P=n(291),L=n(213),q=n(357);const B=c()(a.EuiFlexGroup).withConfig({displayName:"UserRiskOverviewWrapper",componentId:"sc-enfgw9-0"})(["padding-top:",";width:",";"],(({theme:e})=>e.eui.euiSizeM),(({$width:e})=>e)),z=s.a.memo((({anomaliesData:e,contextID:t,data:n,id:l,isDraggable:c=!1,isInDetailsSidePanel:w=!1,isLoadingAnomaliesData:z,loading:$,narrowDateRange:V,startDate:U,endDate:H,userName:G,indexPatterns:Q})=>{const W=Object(x.a)(),K=Object(E.a)(W),[Y]=Object(m.q)(p.O),J=Object(o.useMemo)((()=>G?Object(d.D)([G]):void 0),[G]),{from:X,to:Z}=Object(u.a)(),ee=Object(o.useMemo)((()=>({from:X,to:Z})),[X,Z]),{data:te,isLicenseValid:ne}=Object(P.c)({filterQuery:J,skip:null==G,timerange:ee,riskEntity:d.v.user}),ae=Object(o.useCallback)(((e,n)=>s.a.createElement(f.a,{rowItems:Object(r.getOr)([],e,n),attrName:e,idPrefix:t?`user-overview-${t}`:"user-overview",isDraggable:c})),[t,c]),[ie,re]=Object(o.useMemo)((()=>{const e=te&&te.length>0?te[0]:void 0;return[{title:s.a.createElement(q.a,{title:A,riskScoreEntity:d.v.user}),description:s.a.createElement(s.a.Fragment,null,e?Math.round(e.user.risk.calculated_score_norm):Object(g.d)())},{title:s.a.createElement(q.a,{title:_,riskScoreEntity:d.v.host}),description:s.a.createElement(s.a.Fragment,null,e?s.a.createElement(L.b,{severity:e.user.risk.calculated_level,hideBackgroundColor:!0}):Object(g.d)())}]}),[te]),oe=Object(o.useMemo)((()=>[{title:j,description:n&&n.user?ae("user.id",n):Object(g.d)()},{title:O,description:n&&n.user?ae("user.domain",n):Object(g.d)()}]),[n,ae]),se=Object(o.useMemo)((()=>K?[...oe,{title:F,description:s.a.createElement(k.a,{anomalies:e,startDate:U,endDate:H,isLoading:z,narrowDateRange:V})}]:oe),[e,oe,H,z,V,U,K]),le=Object(o.useMemo)((()=>[se,[{title:M,description:s.a.createElement(b.a,{indexPatterns:Q,field:"user.name",value:G,type:b.b.FIRST_SEEN})},{title:N,description:s.a.createElement(b.a,{indexPatterns:Q,field:"user.name",value:G,type:b.b.LAST_SEEN})}],[{title:C,description:ae("host.os.name",n)},{title:I,description:ae("host.os.family",n)},{title:T,description:s.a.createElement(f.a,{rowItems:Object(r.getOr)([],"host.ip",n),attrName:"host.ip",idPrefix:t?`user-overview-${t}`:"user-overview",isDraggable:c,render:e=>null!=e?s.a.createElement(v.h,{ip:e}):Object(g.d)()})}]]),[n,Q,ae,t,c,G,se]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(y.c,null,s.a.createElement(S.g,{direction:w?"column":"row","data-test-subj":"user-overview"},!w&&s.a.createElement(y.b,{queryId:l,title:D,inspectIndex:0}),le.map(((e,t)=>s.a.createElement(R.a,{descriptionList:e,key:t}))),$&&s.a.createElement(h.a,{overlay:!0,overlayBackground:Y?i.euiDarkVars.euiPageBackgroundColor:i.euiLightVars.euiPageBackgroundColor,size:"xl"}))),ne&&s.a.createElement(B,{gutterSize:w?"m":"none",direction:w?"column":"row","data-test-subj":"user-risk-overview",$width:w?"100%":"66.6%"},s.a.createElement(a.EuiFlexItem,null,s.a.createElement(S.d,{listItems:[ie]})),s.a.createElement(a.EuiFlexItem,null,s.a.createElement(S.d,{listItems:[re]}))))}));z.displayName="UserOverview"},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(4);const i=n(0).i18n.translate("xpack.securitySolution.userDetails.failSearchDescription",{defaultMessage:"Failed to run search on user details"});var r=n(838),o=n(130);const s=({endDate:e,userName:t,indexNames:n,id:s="usersDetailsQuery",skip:l=!1,startDate:c})=>{const{loading:u,result:d,search:p,refetch:m,inspect:g}=Object(o.a)({factoryQueryType:r.b.details,initialResult:{userDetails:{}},errorMessage:i,abort:l}),f=Object(a.useMemo)((()=>({endDate:e,userDetails:d.userDetails,id:s,inspect:g,isInspected:!1,refetch:m,startDate:c})),[e,s,g,m,d.userDetails,c]),b=Object(a.useMemo)((()=>({defaultIndex:n,factoryQueryType:r.b.details,userName:t,timerange:{interval:"12h",from:c,to:e}})),[e,n,c,t]);return Object(a.useEffect)((()=>{l||p(b)}),[b,p,l]),[u,f]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(180),i=n(158),r=n(159);const o=[{columnHeaderType:i.a,id:"@timestamp",initialWidth:r.b,esTypes:["date"],type:"date"},{columnHeaderType:i.a,id:"message"},{columnHeaderType:i.a,id:"host.name"},{columnHeaderType:i.a,id:"event.module"},{columnHeaderType:i.a,id:"agent.type"},{columnHeaderType:i.a,id:"event.dataset"},{columnHeaderType:i.a,id:"event.action"},{columnHeaderType:i.a,id:"user.name"},{columnHeaderType:i.a,id:"source.ip"},{columnHeaderType:i.a,id:"destination.ip"}],s={...a.a,columns:o}},function(e,t,n){"use strict";n.d(t,"a",(function(){return x}));var a=n(92),i=n.n(a),r=n(34),o=n(4),s=n(11),l=n(42),c=n(126),u=n(77),d=n(376),p=n(99),m=n(0);const g=m.i18n.translate("xpack.securitySolution.matrixHistogram.errorSearchDescription",{defaultMessage:"An error has occurred on matrix histogram search"}),f=m.i18n.translate("xpack.securitySolution.matrixHistogram.failSearchDescription",{defaultMessage:"Failed to run search on matrix histogram"});var b=n(84),y=n(231),h=n(1);const v=[],E=({endDate:e,errorMessage:t,filterQuery:n,histogramType:a,indexNames:m,isPtrIncluded:E,onError:x,stackByField:k,runtimeMappings:S,startDate:w,threshold:j,skip:O=!1,includeMissingData:I=!0})=>{const{data:T}=Object(u.k)().services,C=Object(o.useRef)(r.noop),M=Object(o.useRef)(new AbortController),N=Object(o.useRef)(new s.Subscription),[D,F]=Object(o.useState)(!1),{startTracking:A}=Object(y.a)(),[_,R]=Object(o.useState)({defaultIndex:m,factoryQueryType:d.i,filterQuery:Object(c.a)(n),histogramType:a,timerange:{interval:"12h",from:w,to:e},stackByField:k,runtimeMappings:S,threshold:j,...null!=E?{isPtrIncluded:E}:{},...null!=I?{includeMissingData:I}:{}}),{addError:P,addWarning:L}=Object(b.a)(),[q,B]=Object(o.useState)({data:[],inspect:{dsl:[],response:[]},refetch:C.current,totalCount:-1,buckets:[]}),z=Object(o.useCallback)((e=>{const n=async()=>{M.current=new AbortController,F(!0);const{endTracking:n}=A({name:`${h.B} matrixHistogram ${a}`});N.current=T.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:M.current.signal}).subscribe({next:e=>{if(Object(l.isCompleteResponse)(e)){const t=Object(r.getOr)(v,d.k[a],e.rawResponse);F(!1),B((n=>({...n,data:e.matrixHistogramData,inspect:Object(p.getInspectResponse)(e,n.inspect),refetch:C.current,totalCount:t.reduce(((e,t)=>t.doc_count+e),0),buckets:t}))),n("success"),N.current.unsubscribe()}else Object(l.isErrorResponse)(e)&&(F(!1),L(g),n("invalid"),N.current.unsubscribe())},error:e=>{F(!1),P(e,{title:null!=t?t:f}),n("error"),N.current.unsubscribe()}})};N.current.unsubscribe(),M.current.abort(),n(),C.current=n}),[T.search,a,L,P,t,A]);return Object(o.useEffect)((()=>{R((t=>{const r={...t,defaultIndex:m,filterQuery:Object(c.a)(n),histogramType:a,timerange:{interval:"12h",from:w,to:e},stackByField:k,threshold:j,...null!=E?{isPtrIncluded:E}:{}};return i()(t,r)?t:r}))}),[m,e,n,w,k,a,j,E]),Object(o.useEffect)((()=>(O||z(_),()=>{N.current.unsubscribe(),M.current.abort()})),[_,z,O]),Object(o.useEffect)((()=>{O&&(F(!1),N.current.unsubscribe(),M.current.abort())}),[O]),[D,q,Object(o.useCallback)(((e,t)=>{z({..._,timerange:{interval:"12h",from:t,to:e}})}),[_,z])]},x=e=>{const[t,n]=E({...e,includeMissingData:!0}),a=Object(o.useMemo)((()=>!e.stackByField.endsWith(".ip")),[e.stackByField]),[i,r]=E({...e,includeMissingData:!1,skip:a||void 0===e.filterQuery}),s=Object(o.useMemo)((()=>t||i),[t,i]),l=Object(o.useMemo)((()=>{if(a)return n;const{data:e,inspect:t,totalCount:i,refetch:o,buckets:l}=n,{data:c,inspect:u,totalCount:d,refetch:p}=r,m=()=>{o(),p()};return s?{data:[],inspect:{dsl:[],response:[]},refetch:m,totalCount:-1,buckets:[]}:{data:[...e,...c],inspect:{dsl:[...t.dsl,...u.dsl],response:[...t.response,...u.response]},totalCount:i+d,refetch:m,buckets:l}}),[s,n,r,a]);return[s,l]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(32),i=n(4),r=n.n(i),o=n(33),s=n.n(o),l=n(303),c=n(191);const u=s.a.span.withConfig({displayName:"LegendText",componentId:"sc-11u62u-0"})(["font-size:10.5px;"]),d=r.a.memo((({value:e})=>Object(c.a)(e)?r.a.createElement(u,null,e):r.a.createElement(u,{"data-test-subj":"value-wrapper-empty"},l.c)));d.displayName="ValueWrapper";const p=({legendItem:e})=>{const{color:t,value:n}=e;return r.a.createElement(a.EuiText,{size:"xs"},r.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"none",responsive:!1},null!=t&&r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiHealth,{"data-test-subj":"legend-color",color:t})),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(d,{value:n}))))};p.displayName="LegendItemComponent";const m=r.a.memo(p),g=({legendItems:e})=>0===e.length?null:r.a.createElement(a.EuiText,{size:"xs","data-test-subj":"legend"},r.a.createElement(a.EuiFlexGroup,{direction:"column",gutterSize:"none"},e.map(((e,t)=>r.a.createElement(a.EuiFlexItem,{key:`legend-item-${t}`,grow:!1},r.a.createElement(m,{legendItem:e}),r.a.createElement(a.EuiSpacer,{"data-test-subj":"legend-spacer",size:"s"}))))));g.displayName="LegendComponent";const f=r.a.memo(g)},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(4),i=n(691),r=n(142),o=n(0);const s=o.i18n.translate("xpack.securitySolution.endpoint.detections.takeAction.responseActionConsole.notSupportedTooltip",{defaultMessage:"Add the Elastic Defend integration via Elastic Agent to enable this feature"}),l=o.i18n.translate("xpack.securitySolution.endpoint.detections.takeAction.responseActionConsole.unenrolledTooltip",{defaultMessage:"Host is no longer enrolled with the Elastic Defend integration"}),c=o.i18n.translate("xpack.securitySolution.endpoint.detections.takeAction.responseActionConsole.loadingTooltip",{defaultMessage:"Loading"}),u=o.i18n.translate("xpack.securitySolution.endpoint.detections.takeAction.responseActionConsole.generalMetadataErrorTooltip",{defaultMessage:"Failed to retrieve Endpoint metadata"}),d=({endpointId:e,onClick:t})=>{const n=Object(i.c)(),{data:o,isFetching:d,error:p}=Object(i.b)(e,{enabled:Boolean(e)}),[m,g]=Object(a.useMemo)((()=>{var t,n;return e?d?[!0,c]:p&&400===(null===(t=p.body)||void 0===t?void 0:t.statusCode)&&null!==(n=p.body)&&void 0!==n&&n.message.includes("unenrolled")||(null==o?void 0:o.host_status)===r.b.UNENROLLED?[!0,l]:p?[!0,u]:[!1,void 0]:[!0,s]}),[o,e,p,d]);return{handleResponseActionsClick:Object(a.useCallback)((()=>{o&&n(o.metadata),t&&t()}),[o,t,n]),isDisabled:m,tooltip:g}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var a=n(82),i=n.n(a),r=n(4),o=n.n(r),s=n(32),l=n(33),c=n.n(l),u=n(35),d=n(117),p=n(91),m=n(105);const g=c.a.div.withConfig({displayName:"RootContainer",componentId:"sc-nycnfh-0"})(["position:relative;padding-top:",";.body{min-height:",";&-content{position:relative;}}"],(({theme:e})=>e.eui.euiSizeXS),(({theme:e})=>e.eui.gutterTypes.gutterExtraLarge)),f=Object(r.memo)((({"data-test-subj":e})=>o.a.createElement(s.EuiEmptyPrompt,{"data-test-subj":e,title:o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.endpoint.paginatedContent.noItemsFoundTitle",defaultMessage:"No items found"})})));f.displayName="DefaultNoItemsFound";const b=Object(r.memo)((({message:e,"data-test-subj":t})=>o.a.createElement(s.EuiText,{textAlign:"center","data-test-subj":t},o.a.createElement(s.EuiSpacer,{size:"m"}),o.a.createElement(s.EuiIcon,{type:"minusInCircle",color:"danger"})," ",e,o.a.createElement(s.EuiSpacer,{size:"m"}))));b.displayName="ErrorMessage";const y=Object(r.memo)((({items:e,ItemComponent:t,itemComponentProps:n,itemId:a,onChange:l,pagination:c,loading:u,noItemsMessage:y,error:h,contentClassName:v,"data-test-subj":E,"aria-label":x,className:k,children:S})=>{const[w]=Object(r.useState)(new WeakMap),j=Object(p.a)(E),O=Object(r.useMemo)((()=>Math.ceil(((null==c?void 0:c.totalItemCount)||1)/((null==c?void 0:c.pageSize)||1))),[null==c?void 0:c.pageSize,null==c?void 0:c.totalItemCount]);Object(r.useEffect)((()=>{!u&&O>0&&O<((null==c?void 0:c.pageIndex)||0)+1&&l({pageIndex:O-1,pageSize:(null==c?void 0:c.pageSize)||0})}),[O,l,c,u]);const I=Object(r.useCallback)((e=>{if(null!=c&&c.pageIndex){var t,n;const a=Math.floor((null!==(t=null==c?void 0:c.pageIndex)&&void 0!==t?t:m.b)*(null!==(n=null==c?void 0:c.pageSize)&&void 0!==n?n:m.c)/e);l({pageSize:e,pageIndex:isNaN(a)?m.b:a})}else l({pageSize:e,pageIndex:m.b})}),[l,c]),T=Object(r.useCallback)((e=>{l({pageIndex:e,pageSize:(null==c?void 0:c.pageSize)||m.c})}),[l,null==c?void 0:c.pageSize]),C=Object(r.useMemo)((()=>{if(h)return h instanceof Error?o.a.createElement(b,{message:h.message,"data-test-subj":j("error")}):"string"==typeof h?o.a.createElement(b,{message:h,"data-test-subj":j("error")}):h;const r=t;return e.length?e.map((e=>{let t;return a?t=e[a]:w.has(e)?t=w.get(e):(t=Object(d.v4)(),w.set(e,t)),o.a.createElement(r,i()({},n(e),{key:t}))})):u?void 0:y||o.a.createElement(f,{"data-test-subj":j("noResults")})}),[t,h,j,n,a,w,e,y,u]);return o.a.createElement(g,{"data-test-subj":E,"aria-label":x,className:k},u&&o.a.createElement(s.EuiProgress,{size:"xs",color:"primary",position:"absolute","data-test-subj":j("loader")}),o.a.createElement("div",{className:"body","data-test-subj":j("body")},o.a.createElement("div",{className:`body-content ${v}`},S||C)),c&&(S||e.length>0)&&o.a.createElement("div",{"data-test-subj":j("footer")},o.a.createElement(s.EuiSpacer,{size:"l"}),o.a.createElement(s.EuiTablePagination,{activePage:c.pageIndex,itemsPerPage:c.pageSize,itemsPerPageOptions:c.pageSizeOptions,pageCount:O,showPerPageOptions:c.showPerPageOptions,onChangeItemsPerPage:I,onChangePage:T})))}));y.displayName="PaginatedContent"},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(4),i=n(841),r=n(240),o=n(206),s=n(428);function l(){const e=Object(r.h)(),t=Object(i.b)(),n=Object(o.f)(s.a.getInstance(e),void 0,void 0,{enabled:!1}),{data:l,isFetching:c,refetch:u,isFetched:d}=n,p=Object(a.useMemo)((()=>t.canAccessEndpointManagement&&(t.canIsolateHost||Boolean(null==l?void 0:l.total))),[t.canIsolateHost,t.canAccessEndpointManagement,null==l?void 0:l.total]);return Object(a.useEffect)((()=>{t.canIsolateHost||t.loading||d||c||u()}),[u,d,c,t.canIsolateHost,t.loading]),p}},,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var a=n(4),i=n(9);const r=()=>{const e=Object(i.h)();return Object(a.useMemo)((()=>s(e)),[e])},o=e=>r().find((({id:t})=>t===e)),s=e=>e.map((e=>({id:e.id,title:e.title,...null!=e.categories?{categories:e.categories}:{},...null!=e.description?{description:e.description}:{},...!0===e.sideNavDisabled?{disabled:!0}:{},...null!=e.landingIcon?{icon:e.landingIcon}:{},...null!=e.landingImage?{image:e.landingImage}:{},...null!=e.skipUrlState?{skipUrlState:e.skipUrlState}:{},...null!=e.isBeta?{isBeta:e.isBeta}:{},...null!=e.betaOptions?{betaOptions:e.betaOptions}:{},...e.links&&e.links.length?{links:s(e.links)}:{}})))},function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+Cjxzdmcgd2lkdGg9IjI1NnB4IiBoZWlnaHQ9IjI1NXB4IiB2aWV3Qm94PSIwIDAgMjU2IDI1NSIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJ4TWlkWU1pZCI+Cgk8Zz4KCQk8cGF0aCBkPSJNMjU1LjIxNDYxNywwLjI1NzU4MDI0NyBMMjU1LjIxNDYxNyw2My45OTM2NzkgTDE5MS42MDk2NzksMTI3LjU5ODYxNyBMMTkxLjYwOTY3OSw2My43Mjk3Nzc4IEwyNTUuMjE0NjE3LDAuMjU3NTgwMjQ3IiBmaWxsPSIjQTU5NkZGIj48L3BhdGg+CgkJPHBhdGggZD0iTTEyOC4wMDYzMjEsMC4yNTc1ODAyNDcgTDEyOC4wMDYzMjEsNjMuOTkzNjc5IEwxOTEuNjExMjU5LDEyNy41OTg2MTcgTDE5MS42MTEyNTksNjMuNzI5Nzc3OCBMMTI4LjAwNjMyMSwwLjI1NzU4MDI0NyIgZmlsbD0iIzAwMDAwMCI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0yNTUuMzQ1Nzc4LDI1NC44MDM3NTMgTDE5MS42MDk2NzksMjU0LjgwMzc1MyBMMTI4LjAwNDc0MSwxOTEuMTk4ODE1IEwxOTEuODcyLDE5MS4xOTg4MTUgTDI1NS4zNDU3NzgsMjU0LjgwMzc1MyIgZmlsbD0iI0E1OTZGRiI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0yNTUuMzQ1Nzc4LDEyNy41OTU0NTcgTDE5MS42MDk2NzksMTI3LjU5NTQ1NyBMMTI4LjAwNDc0MSwxOTEuMjAwMzk1IEwxOTEuODcyLDE5MS4yMDAzOTUgTDI1NS4zNDU3NzgsMTI3LjU5NTQ1NyIgZmlsbD0iIzAwMDAwMCI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0wLjgwMTE4NTE4NSwyNTQuOTM2NDk0IEwwLjgwMTE4NTE4NSwxOTEuMTk4ODE1IEw2NC40MDYxMjM1LDEyNy41OTM4NzcgTDY0LjQwNjEyMzUsMTkxLjQ2MjcxNiBMMC44MDExODUxODUsMjU0LjkzNjQ5NCIgZmlsbD0iI0E1OTZGRiI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0xMjguMDA5NDgxLDI1NC45MzY0OTQgTDEyOC4wMDk0ODEsMTkxLjE5ODgxNSBMNjQuNDA0NTQzMiwxMjcuNTkzODc3IEw2NC40MDQ1NDMyLDE5MS40NjI3MTYgTDEyOC4wMDk0ODEsMjU0LjkzNjQ5NCIgZmlsbD0iIzAwMDAwMCI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0wLjY3MTYwNDkzOCwwLjM4NTU4MDI0NyBMNjQuNDA3NzAzNywwLjM4NTU4MDI0NyBMMTI4LjAxMjY0Miw2My45OTA1MTg1IEw2NC4xNDUzODI3LDYzLjk5MDUxODUgTDAuNjcxNjA0OTM4LDAuMzg1NTgwMjQ3IiBmaWxsPSIjQTU5NkZGIj48L3BhdGg+CgkJPHBhdGggZD0iTTAuNjcxNjA0OTM4LDEyNy41OTM4NzcgTDY0LjQwNzcwMzcsMTI3LjU5Mzg3NyBMMTI4LjAxMjY0Miw2My45ODg5MzgzIEw2NC4xNDUzODI3LDYzLjk4ODkzODMgTDAuNjcxNjA0OTM4LDEyNy41OTM4NzciIGZpbGw9IiMwMDAwMDAiPjwvcGF0aD4KCTwvZz4KPC9zdmc+Cg=="},function(e,t,n){e.exports=n.p+"ed6ae68d913c232ecd384fa643fb5d97.svg"},function(e,t,n){e.exports=n.p+"9084b765fae17c788e62c5caa2fd0c56.svg"},function(e,t,n){e.exports=n.p+"b3f78a837df74b5c68f457351e9f23e3.svg"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,i=n(4),r=(a=n(944))&&"object"==typeof a&&"default"in a?a.default:a,o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},o(e,t)},s=function(){return s=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},s.apply(this,arguments)},l={top:{width:"100%",height:"10px",top:"-5px",left:"0px",cursor:"row-resize"},right:{width:"10px",height:"100%",top:"0px",right:"-5px",cursor:"col-resize"},bottom:{width:"100%",height:"10px",bottom:"-5px",left:"0px",cursor:"row-resize"},left:{width:"10px",height:"100%",top:"0px",left:"-5px",cursor:"col-resize"},topRight:{width:"20px",height:"20px",position:"absolute",right:"-10px",top:"-10px",cursor:"ne-resize"},bottomRight:{width:"20px",height:"20px",position:"absolute",right:"-10px",bottom:"-10px",cursor:"se-resize"},bottomLeft:{width:"20px",height:"20px",position:"absolute",left:"-10px",bottom:"-10px",cursor:"sw-resize"},topLeft:{width:"20px",height:"20px",position:"absolute",left:"-10px",top:"-10px",cursor:"nw-resize"}};function c(e){return i.createElement("div",{className:e.className||"",style:s({position:"absolute",userSelect:"none"},l[e.direction],e.replaceStyles||{}),onMouseDown:function(t){e.onResizeStart(t,e.direction)},onTouchStart:function(t){e.onResizeStart(t,e.direction)}},e.children)}var u={width:"auto",height:"auto"},d=r((function(e,t,n){return Math.max(Math.min(e,n),t)})),p=r((function(e,t){return Math.round(e/t)*t})),m=r((function(e,t){return new RegExp(e,"i").test(t)})),g=r((function(e,t,n){void 0===n&&(n=0);var a=t.reduce((function(n,a,i){return Math.abs(a-e)<Math.abs(t[n]-e)?i:n}),0),i=Math.abs(t[a]-e);return 0===n||i<n?t[a]:e})),f=r((function(e,t){return e.substr(e.length-t.length,t.length)===t})),b=r((function(e){return"auto"===(e=e.toString())||f(e,"px")||f(e,"%")||f(e,"vh")||f(e,"vw")||f(e,"vmax")||f(e,"vmin")?e:e+"px"})),y=function(e,t){if(e&&"string"==typeof e){if(f(e,"%"))return t*(Number(e.replace("%",""))/100);if(f(e,"vw")){var n=Number(e.replace("vw",""))/100;return window.innerWidth*n}if(f(e,"vh"))return n=Number(e.replace("vh",""))/100,window.innerHeight*n}return e},h=r((function(e,t,n,a,i){return t=y(t,e.width),n=y(n,e.height),a=y(a,e.width),i=y(i,e.height),{maxWidth:void 0===t?void 0:Number(t),maxHeight:void 0===n?void 0:Number(n),minWidth:void 0===a?void 0:Number(a),minHeight:void 0===i?void 0:Number(i)}})),v=["style","className","grid","snap","bounds","size","defaultSize","minWidth","minHeight","maxWidth","maxHeight","lockAspectRatio","lockAspectRatioExtraWidth","lockAspectRatioExtraHeight","enable","handleStyles","handleClasses","handleWrapperStyle","handleWrapperClass","children","onResizeStart","onResize","onResizeStop","handleComponent","scale","resizeRatio","snapGap"],E="__resizable_base__",x=function(e){function t(t){var n=e.call(this,t)||this;return n.ratio=1,n.resizable=null,n.parentLeft=0,n.parentTop=0,n.resizableLeft=0,n.resizableTop=0,n.targetLeft=0,n.targetTop=0,n.state={isResizing:!1,resizeCursor:"auto",width:void 0===(n.propsSize&&n.propsSize.width)?"auto":n.propsSize&&n.propsSize.width,height:void 0===(n.propsSize&&n.propsSize.height)?"auto":n.propsSize&&n.propsSize.height,direction:"right",original:{x:0,y:0,width:0,height:0}},n.onResizeStart=n.onResizeStart.bind(n),n.onMouseMove=n.onMouseMove.bind(n),n.onMouseUp=n.onMouseUp.bind(n),n}return function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),Object.defineProperty(t.prototype,"parentNode",{get:function(){return this.resizable?this.resizable.parentNode:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"propsSize",{get:function(){return this.props.size||this.props.defaultSize||u},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"base",{get:function(){var e=this.parentNode;if(e)for(var t=0,n=[].slice.call(e.children);t<n.length;t++){var a=n[t];if(a instanceof HTMLElement&&a.classList.contains(E))return a}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){var e=0,t=0;if("undefined"!=typeof window&&this.resizable){var n=this.resizable.offsetWidth,a=this.resizable.offsetHeight,i=this.resizable.style.position;"relative"!==i&&(this.resizable.style.position="relative"),e="auto"!==this.resizable.style.width?this.resizable.offsetWidth:n,t="auto"!==this.resizable.style.height?this.resizable.offsetHeight:a,this.resizable.style.position=i}return{width:e,height:t}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sizeStyle",{get:function(){var e=this,t=this.props.size,n=function(t){if(void 0===e.state[t]||"auto"===e.state[t])return"auto";if(e.propsSize&&e.propsSize[t]&&f(e.propsSize[t].toString(),"%")){if(f(e.state[t].toString(),"%"))return e.state[t].toString();var n=e.getParentSize();return Number(e.state[t].toString().replace("px",""))/n[t]*100+"%"}return b(e.state[t])};return{width:t&&void 0!==t.width&&!this.state.isResizing?b(t.width):n("width"),height:t&&void 0!==t.height&&!this.state.isResizing?b(t.height):n("height")}},enumerable:!0,configurable:!0}),t.prototype.getParentSize=function(){if(!this.base||!this.parentNode)return{width:window.innerWidth,height:window.innerHeight};var e=!1,t=this.parentNode.style.flexWrap,n=this.base.style.minWidth;"wrap"!==t&&(e=!0,this.parentNode.style.flexWrap="wrap"),this.base.style.position="relative",this.base.style.minWidth="100%";var a={width:this.base.offsetWidth,height:this.base.offsetHeight};return this.base.style.position="absolute",e&&(this.parentNode.style.flexWrap=t),this.base.style.minWidth=n,a},t.prototype.bindEvents=function(){"undefined"!=typeof window&&(window.addEventListener("mouseup",this.onMouseUp),window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("mouseleave",this.onMouseUp),window.addEventListener("touchmove",this.onMouseMove),window.addEventListener("touchend",this.onMouseUp))},t.prototype.unbindEvents=function(){"undefined"!=typeof window&&(window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseleave",this.onMouseUp),window.removeEventListener("touchmove",this.onMouseMove),window.removeEventListener("touchend",this.onMouseUp))},t.prototype.componentDidMount=function(){this.setState({width:this.state.width||this.size.width,height:this.state.height||this.size.height});var e=this.parentNode;if(e instanceof HTMLElement&&!this.base){var t=document.createElement("div");t.style.width="100%",t.style.height="100%",t.style.position="absolute",t.style.transform="scale(0, 0)",t.style.left="0",t.style.flex="0",t.classList?t.classList.add(E):t.className+=E,e.appendChild(t)}},t.prototype.componentWillUnmount=function(){if("undefined"!=typeof window){this.unbindEvents();var e=this.parentNode;if(!this.base||!e)return;if(!(e instanceof HTMLElement&&this.base instanceof Node))return;e.removeChild(this.base)}},t.prototype.createSizeForCssProperty=function(e,t){var n=this.propsSize&&this.propsSize[t];return"auto"!==this.state[t]||this.state.original[t]!==e||void 0!==n&&"auto"!==n?e:"auto"},t.prototype.calculateNewMaxFromBoundary=function(e,t){if("parent"===this.props.bounds){var n=this.parentNode;if(n instanceof HTMLElement){var a=n.offsetWidth+(this.parentLeft-this.resizableLeft),i=n.offsetHeight+(this.parentTop-this.resizableTop);e=e&&e<a?e:a,t=t&&t<i?t:i}}else"window"===this.props.bounds?"undefined"!=typeof window&&(a=window.innerWidth-this.resizableLeft,i=window.innerHeight-this.resizableTop,e=e&&e<a?e:a,t=t&&t<i?t:i):this.props.bounds instanceof HTMLElement&&(a=this.props.bounds.offsetWidth+(this.targetLeft-this.resizableLeft),i=this.props.bounds.offsetHeight+(this.targetTop-this.resizableTop),e=e&&e<a?e:a,t=t&&t<i?t:i);return{maxWidth:e,maxHeight:t}},t.prototype.calculateNewSizeFromDirection=function(e,t){var n=this.props.scale||1,a=this.props.resizeRatio||1,i=this.state,r=i.direction,o=i.original,s=this.props,l=s.lockAspectRatio,c=s.lockAspectRatioExtraHeight,u=s.lockAspectRatioExtraWidth,d=o.width,p=o.height,g=c||0,f=u||0;return m("right",r)&&(d=o.width+(e-o.x)*a/n,l&&(p=(d-f)/this.ratio+g)),m("left",r)&&(d=o.width-(e-o.x)*a/n,l&&(p=(d-f)/this.ratio+g)),m("bottom",r)&&(p=o.height+(t-o.y)*a/n,l&&(d=(p-g)*this.ratio+f)),m("top",r)&&(p=o.height-(t-o.y)*a/n,l&&(d=(p-g)*this.ratio+f)),{newWidth:d,newHeight:p}},t.prototype.calculateNewSizeFromAspectRatio=function(e,t,n,a){var i=this.props,r=i.lockAspectRatio,o=i.lockAspectRatioExtraHeight,s=i.lockAspectRatioExtraWidth,l=void 0===a.width?10:a.width,c=void 0===n.width||n.width<0?e:n.width,u=void 0===a.height?10:a.height,p=void 0===n.height||n.height<0?t:n.height,m=o||0,g=s||0;if(r){var f=(u-m)*this.ratio+g,b=(p-m)*this.ratio+g,y=(l-g)/this.ratio+m,h=(c-g)/this.ratio+m,v=Math.max(l,f),E=Math.min(c,b),x=Math.max(u,y),k=Math.min(p,h);e=d(e,v,E),t=d(t,x,k)}else e=d(e,l,c),t=d(t,u,p);return{newWidth:e,newHeight:t}},t.prototype.setBoundingClientRect=function(){if("parent"===this.props.bounds){var e=this.parentNode;if(e instanceof HTMLElement){var t=e.getBoundingClientRect();this.parentLeft=t.left,this.parentTop=t.top}}if(this.props.bounds instanceof HTMLElement){var n=this.props.bounds.getBoundingClientRect();this.targetLeft=n.left,this.targetTop=n.top}if(this.resizable){var a=this.resizable.getBoundingClientRect(),i=a.left,r=a.top;this.resizableLeft=i,this.resizableTop=r}},t.prototype.onResizeStart=function(e,t){var n=0,a=0;if(e.nativeEvent instanceof MouseEvent){if(n=e.nativeEvent.clientX,a=e.nativeEvent.clientY,3===e.nativeEvent.which)return}else e.nativeEvent instanceof TouchEvent&&(n=e.nativeEvent.touches[0].clientX,a=e.nativeEvent.touches[0].clientY);this.props.onResizeStart&&this.resizable&&!1===this.props.onResizeStart(e,t,this.resizable)||(this.props.size&&(void 0!==this.props.size.height&&this.props.size.height!==this.state.height&&this.setState({height:this.props.size.height}),void 0!==this.props.size.width&&this.props.size.width!==this.state.width&&this.setState({width:this.props.size.width})),this.ratio="number"==typeof this.props.lockAspectRatio?this.props.lockAspectRatio:this.size.width/this.size.height,this.setBoundingClientRect(),this.bindEvents(),this.setState({original:{x:n,y:a,width:this.size.width,height:this.size.height},isResizing:!0,resizeCursor:window.getComputedStyle(e.target).cursor||"auto",direction:t}))},t.prototype.onMouseMove=function(e){if(this.state.isResizing&&this.resizable){var t=this.props,n=t.maxWidth,a=t.maxHeight,i=t.minWidth,r=t.minHeight,o=e instanceof MouseEvent?e.clientX:e.touches[0].clientX,s=e instanceof MouseEvent?e.clientY:e.touches[0].clientY,l=this.state,c=l.direction,u=l.original,d=l.width,m=l.height,b=this.getParentSize(),y=h(b,n,a,i,r);n=y.maxWidth,a=y.maxHeight,i=y.minWidth,r=y.minHeight;var v=this.calculateNewSizeFromDirection(o,s),E=v.newHeight,x=v.newWidth,k=this.calculateNewMaxFromBoundary(n,a),S=this.calculateNewSizeFromAspectRatio(x,E,{width:k.maxWidth,height:k.maxHeight},{width:i,height:r});if(x=S.newWidth,E=S.newHeight,this.props.grid){var w=p(x,this.props.grid[0]),j=p(E,this.props.grid[1]),O=this.props.snapGap||0;x=0===O||Math.abs(w-x)<=O?w:x,E=0===O||Math.abs(j-E)<=O?j:E}this.props.snap&&this.props.snap.x&&(x=g(x,this.props.snap.x,this.props.snapGap)),this.props.snap&&this.props.snap.y&&(E=g(E,this.props.snap.y,this.props.snapGap));var I={width:x-u.width,height:E-u.height};d&&"string"==typeof d&&(f(d,"%")?x=x/b.width*100+"%":f(d,"vw")?x=x/window.innerWidth*100+"vw":f(d,"vh")&&(x=x/window.innerHeight*100+"vh")),m&&"string"==typeof m&&(f(m,"%")?E=E/b.height*100+"%":f(m,"vw")?E=E/window.innerWidth*100+"vw":f(m,"vh")&&(E=E/window.innerHeight*100+"vh")),this.setState({width:this.createSizeForCssProperty(x,"width"),height:this.createSizeForCssProperty(E,"height")}),this.props.onResize&&this.props.onResize(e,c,this.resizable,I)}},t.prototype.onMouseUp=function(e){var t=this.state,n=t.isResizing,a=t.direction,i=t.original;if(n&&this.resizable){var r={width:this.size.width-i.width,height:this.size.height-i.height};this.props.onResizeStop&&this.props.onResizeStop(e,a,this.resizable,r),this.props.size&&this.setState(this.props.size),this.unbindEvents(),this.setState({isResizing:!1,resizeCursor:"auto"})}},t.prototype.updateSize=function(e){this.setState({width:e.width,height:e.height})},t.prototype.renderResizer=function(){var e=this,t=this.props,n=t.enable,a=t.handleStyles,r=t.handleClasses,o=t.handleWrapperStyle,s=t.handleWrapperClass,l=t.handleComponent;if(!n)return null;var u=Object.keys(n).map((function(t){return!1!==n[t]?i.createElement(c,{key:t,direction:t,onResizeStart:e.onResizeStart,replaceStyles:a&&a[t],className:r&&r[t]},l&&l[t]?l[t]:null):null}));return i.createElement("span",{className:s,style:o},u)},t.prototype.render=function(){var e=this,t=Object.keys(this.props).reduce((function(t,n){return-1!==v.indexOf(n)||(t[n]=e.props[n]),t}),{});return i.createElement("div",s({ref:function(t){t&&(e.resizable=t)},style:s({position:"relative",userSelect:this.state.isResizing?"none":"auto"},this.props.style,this.sizeStyle,{maxWidth:this.props.maxWidth,maxHeight:this.props.maxHeight,minWidth:this.props.minWidth,minHeight:this.props.minHeight,boxSizing:"border-box",flexShrink:0}),className:this.props.className},t),this.state.isResizing&&i.createElement("div",{style:{height:"100%",width:"100%",backgroundColor:"rgba(0,0,0,0)",cursor:""+(this.state.resizeCursor||"auto"),opacity:0,position:"fixed",zIndex:9999,top:"0",left:"0",bottom:"0",right:"0"}}),this.props.children,this.renderResizer())},t.defaultProps={onResizeStart:function(){},onResize:function(){},onResizeStop:function(){},enable:{top:!0,right:!0,bottom:!0,left:!0,topRight:!0,bottomRight:!0,bottomLeft:!0,topLeft:!0},style:{},grid:[1,1],lockAspectRatio:!1,lockAspectRatioExtraWidth:0,lockAspectRatioExtraHeight:0,scale:1,resizeRatio:1,snapGap:0},t}(i.PureComponent);t.Resizable=x},function(e,t){function n(e,t,n,a){var i,r=null==(i=a)||"number"==typeof i||"boolean"==typeof i?a:n(a),o=t.get(r);return void 0===o&&(o=e.call(this,a),t.set(r,o)),o}function a(e,t,n){var a=Array.prototype.slice.call(arguments,3),i=n(a),r=t.get(i);return void 0===r&&(r=e.apply(this,a),t.set(i,r)),r}function i(e,t,n,a,i){return n.bind(t,e,a,i)}function r(e,t){return i(e,this,1===e.length?n:a,t.cache.create(),t.serializer)}function o(){return JSON.stringify(arguments)}function s(){this.cache=Object.create(null)}s.prototype.has=function(e){return e in this.cache},s.prototype.get=function(e){return this.cache[e]},s.prototype.set=function(e,t){this.cache[e]=t};var l={create:function(){return new s}};e.exports=function(e,t){var n=t&&t.cache?t.cache:l,a=t&&t.serializer?t.serializer:o;return(t&&t.strategy?t.strategy:r)(e,{cache:n,serializer:a})},e.exports.strategies={variadic:function(e,t){return i(e,this,a,t.cache.create(),t.serializer)},monadic:function(e,t){return i(e,this,n,t.cache.create(),t.serializer)}}},function(e,t,n){e.exports=n(27)(17)},function(e,t,n){e.exports=n(27)(16)},function(e,t,n){switch(window.__kbnThemeTag__){case"v8dark":return n(948);case"v8light":return n(950)}},function(e,t,n){var a=n(250),i=n(949);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,n){(t=n(251)(!1)).push([e.i,".kbnFieldButton{align-items:center;border-radius:6px;display:flex;font-size:14px;font-size:1rem;line-height:1.71429rem;margin-bottom:4px;transition:box-shadow .15s cubic-bezier(.694,.0482,.335,1),background-color .15s cubic-bezier(.694,.0482,.335,1)}.kbnFieldButton-isActive,.kbnFieldButton:focus-within{outline:2px solid currentColor}.kbnFieldButton-isActive:focus-visible,.kbnFieldButton:focus-within:focus-visible{outline-style:auto}.kbnFieldButton-isActive:not(:focus-visible),.kbnFieldButton:focus-within:not(:focus-visible){outline:none}.kbnFieldButton--isDraggable{background:#25262e}.kbnFieldButton--isDraggable:focus,.kbnFieldButton--isDraggable:focus-within,.kbnFieldButton--isDraggable:hover{border-radius:6px;box-shadow:0 .9px 4px -1px #0003,0 2.6px 8px -1px #00000026,0 5.7px 12px -1px rgba(0,0,0,.125),0 15px 15px -1px #0000001a;z-index:2}.kbnFieldButton--isDraggable .kbnFieldButton__button:focus,.kbnFieldButton--isDraggable .kbnFieldButton__button:hover{cursor:grab}.kbnFieldButton__button{align-items:flex-start;display:flex;flex-grow:1;line-height:normal;padding:8px;text-align:left}.kbnFieldButton__fieldIcon{flex-shrink:0;line-height:0;margin-right:8px}.kbnFieldButton__name{flex-grow:1;word-break:break-word}.kbnFieldButton__infoIcon{flex-shrink:0;margin-left:4px}.kbnFieldButton__fieldAction{margin-right:8px}.kbnFieldButton--small{font-size:12px}.kbnFieldButton--small .kbnFieldButton__button{padding:4px}.kbnFieldButton--small .kbnFieldButton__fieldAction,.kbnFieldButton--small .kbnFieldButton__fieldIcon{margin-right:4px}",""]),e.exports=t},function(e,t,n){var a=n(250),i=n(951);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,n){(t=n(251)(!1)).push([e.i,".kbnFieldButton{align-items:center;border-radius:6px;display:flex;font-size:14px;font-size:1rem;line-height:1.71429rem;margin-bottom:4px;transition:box-shadow .15s cubic-bezier(.694,.0482,.335,1),background-color .15s cubic-bezier(.694,.0482,.335,1)}.kbnFieldButton-isActive,.kbnFieldButton:focus-within{outline:2px solid currentColor}.kbnFieldButton-isActive:focus-visible,.kbnFieldButton:focus-within:focus-visible{outline-style:auto}.kbnFieldButton-isActive:not(:focus-visible),.kbnFieldButton:focus-within:not(:focus-visible){outline:none}.kbnFieldButton--isDraggable{background:#fff}.kbnFieldButton--isDraggable:focus,.kbnFieldButton--isDraggable:focus-within,.kbnFieldButton--isDraggable:hover{border-radius:6px;box-shadow:0 .9px 4px -1px #00000014,0 2.6px 8px -1px #0000000f,0 5.7px 12px -1px #0000000d,0 15px 15px -1px #0000000a;z-index:2}.kbnFieldButton--isDraggable .kbnFieldButton__button:focus,.kbnFieldButton--isDraggable .kbnFieldButton__button:hover{cursor:grab}.kbnFieldButton__button{align-items:flex-start;display:flex;flex-grow:1;line-height:normal;padding:8px;text-align:left}.kbnFieldButton__fieldIcon{flex-shrink:0;line-height:0;margin-right:8px}.kbnFieldButton__name{flex-grow:1;word-break:break-word}.kbnFieldButton__infoIcon{flex-shrink:0;margin-left:4px}.kbnFieldButton__fieldAction{margin-right:8px}.kbnFieldButton--small{font-size:12px}.kbnFieldButton--small .kbnFieldButton__button{padding:4px}.kbnFieldButton--small .kbnFieldButton__fieldAction,.kbnFieldButton--small .kbnFieldButton__fieldIcon{margin-right:4px}",""]),e.exports=t},function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI4IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMSAwSDB2OGg4VjdIMVYweiIgZmlsbD0iI0QzREFFNiIvPjwvc3ZnPg=="},function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2NCIgaGVpZ2h0PSI2NCIgdmlld0JveD0iMCAwIDY0IDY0Ij4KICA8ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgPHBhdGggZmlsbD0iI0YwNEU5OCIgZD0iTTI5LDMyLjAwMDEgTDE1LjkzNSw5LjQzMjEgQzEzLjQ4LDUuMTk0MSA3LDYuOTM1MSA3LDExLjgzMjEgTDcsNTIuMTY4MSBDNyw1Ny4wNjUxIDEzLjQ4LDU4LjgwNjEgMTUuOTM1LDU0LjU2NzEgTDI5LDMyLjAwMDEgWiIvPgogICAgPHBhdGggZmlsbD0iI0ZBNzQ0RSIgZD0iTTM0Ljc3NzMsMzIuMDAwMSBMMzMuMzI3MywzNC41MDUxIEwyMC4yNjEzLDU3LjA3MzEgQzE5Ljg0NzMsNTcuNzg3MSAxOS4zNTMzLDU4LjQyNzEgMTguODAyMyw1OS4wMDAxIEwzNC45MjczLDU5LjAwMDEgQzM4LjcwNzMsNTkuMDAwMSA0Mi4yMjEzLDU3LjA2MDEgNDQuMjM2Myw1My44NjExIEw1OC4wMDAzLDMyLjAwMDEgTDM0Ljc3NzMsMzIuMDAwMSBaIi8+CiAgICA8cGF0aCBmaWxsPSIjMzQzNzQxIiBkPSJNNDQuMjM2MywxMC4xMzkyIEM0Mi4yMjEzLDYuOTQwMiAzOC43MDczLDUuMDAwMiAzNC45MjczLDUuMDAwMiBMMTguODAyMyw1LjAwMDIgQzE5LjM1MzMsNS41NzMyIDE5Ljg0NzMsNi4yMTIyIDIwLjI2MTMsNi45MjcyIEwzMy4zMjczLDI5LjQ5NDIgTDM0Ljc3NzMsMzIuMDAwMiBMNTguMDAwMywzMi4wMDAyIEw0NC4yMzYzLDEwLjEzOTIgWiIvPgogIDwvZz4KPC9zdmc+Cg=="},function(e,t,n){!function(e,t,n,a,i,r){"use strict";function o(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function s(e,t){switch(arguments.length){case 0:break;case 1:"function"==typeof e?this.interpolator(e):this.range(e);break;default:this.domain(e),"function"==typeof t?this.interpolator(t):this.range(t)}return this}const l=Symbol("implicit");function c(){var e=new Map,t=[],n=[],a=l;function i(i){var r=i+"",o=e.get(r);if(!o){if(a!==l)return a;e.set(r,o=t.push(i))}return n[(o-1)%n.length]}return i.domain=function(n){if(!arguments.length)return t.slice();t=[],e=new Map;for(const a of n){const n=a+"";e.has(n)||e.set(n,t.push(a))}return i},i.range=function(e){return arguments.length?(n=Array.from(e),i):n.slice()},i.unknown=function(e){return arguments.length?(a=e,i):a},i.copy=function(){return c(t,n).unknown(a)},o.apply(i,arguments),i}function u(){var e,n,a=c().unknown(void 0),i=a.domain,r=a.range,s=0,l=1,d=!1,p=0,m=0,g=.5;function f(){var a=i().length,o=l<s,c=o?l:s,u=o?s:l;e=(u-c)/Math.max(1,a-p+2*m),d&&(e=Math.floor(e)),c+=(u-c-e*(a-p))*g,n=e*(1-p),d&&(c=Math.round(c),n=Math.round(n));var f=t.range(a).map((function(t){return c+e*t}));return r(o?f.reverse():f)}return delete a.unknown,a.domain=function(e){return arguments.length?(i(e),f()):i()},a.range=function(e){return arguments.length?([s,l]=e,s=+s,l=+l,f()):[s,l]},a.rangeRound=function(e){return[s,l]=e,s=+s,l=+l,d=!0,f()},a.bandwidth=function(){return n},a.step=function(){return e},a.round=function(e){return arguments.length?(d=!!e,f()):d},a.padding=function(e){return arguments.length?(p=Math.min(1,m=+e),f()):p},a.paddingInner=function(e){return arguments.length?(p=Math.min(1,e),f()):p},a.paddingOuter=function(e){return arguments.length?(m=+e,f()):m},a.align=function(e){return arguments.length?(g=Math.max(0,Math.min(1,e)),f()):g},a.copy=function(){return u(i(),[s,l]).round(d).paddingInner(p).paddingOuter(m).align(g)},o.apply(f(),arguments)}function d(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return d(t())},e}function p(e){return+e}var m=[0,1];function g(e){return e}function f(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:(n=isNaN(t)?NaN:.5,function(){return n});var n}function b(e,t,n){var a=e[0],i=e[1],r=t[0],o=t[1];return i<a?(a=f(i,a),r=n(o,r)):(a=f(a,i),r=n(r,o)),function(e){return r(a(e))}}function y(e,n,a){var i=Math.min(e.length,n.length)-1,r=new Array(i),o=new Array(i),s=-1;for(e[i]<e[0]&&(e=e.slice().reverse(),n=n.slice().reverse());++s<i;)r[s]=f(e[s],e[s+1]),o[s]=a(n[s],n[s+1]);return function(n){var a=t.bisect(e,n,1,i)-1;return o[a](r[a](n))}}function h(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function v(){var e,t,a,i,r,o,s=m,l=m,c=n.interpolate,u=g;function d(){var e,t,n,a=Math.min(s.length,l.length);return u!==g&&(e=s[0],t=s[a-1],e>t&&(n=e,e=t,t=n),u=function(n){return Math.max(e,Math.min(t,n))}),i=a>2?y:b,r=o=null,f}function f(t){return null==t||isNaN(t=+t)?a:(r||(r=i(s.map(e),l,c)))(e(u(t)))}return f.invert=function(a){return u(t((o||(o=i(l,s.map(e),n.interpolateNumber)))(a)))},f.domain=function(e){return arguments.length?(s=Array.from(e,p),d()):s.slice()},f.range=function(e){return arguments.length?(l=Array.from(e),d()):l.slice()},f.rangeRound=function(e){return l=Array.from(e),c=n.interpolateRound,d()},f.clamp=function(e){return arguments.length?(u=!!e||g,d()):u!==g},f.interpolate=function(e){return arguments.length?(c=e,d()):c},f.unknown=function(e){return arguments.length?(a=e,f):a},function(n,a){return e=n,t=a,d()}}function E(){return v()(g,g)}function x(e,n,i,r){var o,s=t.tickStep(e,n,i);switch((r=a.formatSpecifier(null==r?",f":r)).type){case"s":var l=Math.max(Math.abs(e),Math.abs(n));return null!=r.precision||isNaN(o=a.precisionPrefix(s,l))||(r.precision=o),a.formatPrefix(r,l);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(o=a.precisionRound(s,Math.max(Math.abs(e),Math.abs(n))))||(r.precision=o-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(o=a.precisionFixed(s))||(r.precision=o-2*("%"===r.type))}return a.format(r)}function k(e){var n=e.domain;return e.ticks=function(e){var a=n();return t.ticks(a[0],a[a.length-1],null==e?10:e)},e.tickFormat=function(e,t){var a=n();return x(a[0],a[a.length-1],null==e?10:e,t)},e.nice=function(a){null==a&&(a=10);var i,r,o=n(),s=0,l=o.length-1,c=o[s],u=o[l],d=10;for(u<c&&(r=c,c=u,u=r,r=s,s=l,l=r);d-- >0;){if((r=t.tickIncrement(c,u,a))===i)return o[s]=c,o[l]=u,n(o);if(r>0)c=Math.floor(c/r)*r,u=Math.ceil(u/r)*r;else{if(!(r<0))break;c=Math.ceil(c*r)/r,u=Math.floor(u*r)/r}i=r}return e},e}function S(e,t){var n,a=0,i=(e=e.slice()).length-1,r=e[a],o=e[i];return o<r&&(n=a,a=i,i=n,n=r,r=o,o=n),e[a]=t.floor(r),e[i]=t.ceil(o),e}function w(e){return Math.log(e)}function j(e){return Math.exp(e)}function O(e){return-Math.log(-e)}function I(e){return-Math.exp(-e)}function T(e){return isFinite(e)?+("1e"+e):e<0?0:e}function C(e){return function(t){return-e(-t)}}function M(e){var n,i,r=e(w,j),o=r.domain,s=10;function l(){return n=function(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}(s),i=function(e){return 10===e?T:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}(s),o()[0]<0?(n=C(n),i=C(i),e(O,I)):e(w,j),r}return r.base=function(e){return arguments.length?(s=+e,l()):s},r.domain=function(e){return arguments.length?(o(e),l()):o()},r.ticks=function(e){var a,r=o(),l=r[0],c=r[r.length-1];(a=c<l)&&(m=l,l=c,c=m);var u,d,p,m=n(l),g=n(c),f=null==e?10:+e,b=[];if(!(s%1)&&g-m<f){if(m=Math.floor(m),g=Math.ceil(g),l>0){for(;m<=g;++m)for(d=1,u=i(m);d<s;++d)if(!((p=u*d)<l)){if(p>c)break;b.push(p)}}else for(;m<=g;++m)for(d=s-1,u=i(m);d>=1;--d)if(!((p=u*d)<l)){if(p>c)break;b.push(p)}2*b.length<f&&(b=t.ticks(l,c,f))}else b=t.ticks(m,g,Math.min(g-m,f)).map(i);return a?b.reverse():b},r.tickFormat=function(e,t){if(null==t&&(t=10===s?".0e":","),"function"!=typeof t&&(t=a.format(t)),e===1/0)return t;null==e&&(e=10);var o=Math.max(1,s*e/r.ticks().length);return function(e){var a=e/i(Math.round(n(e)));return a*s<s-.5&&(a*=s),a<=o?t(e):""}},r.nice=function(){return o(S(o(),{floor:function(e){return i(Math.floor(n(e)))},ceil:function(e){return i(Math.ceil(n(e)))}}))},r}function N(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function D(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function F(e){var t=1,n=e(N(t),D(t));return n.constant=function(n){return arguments.length?e(N(t=+n),D(t)):t},k(n)}function A(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function _(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function R(e){return e<0?-e*e:e*e}function P(e){var t=e(g,g),n=1;function a(){return 1===n?e(g,g):.5===n?e(_,R):e(A(n),A(1/n))}return t.exponent=function(e){return arguments.length?(n=+e,a()):n},k(t)}function L(){var e=P(v());return e.copy=function(){return h(e,L()).exponent(e.exponent())},o.apply(e,arguments),e}function q(e){return Math.sign(e)*e*e}function B(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function z(e){return new Date(e)}function $(e){return e instanceof Date?+e:+new Date(+e)}function V(e,t,n,a,i,r,o,s,l,c){var u=E(),d=u.invert,p=u.domain,m=c(".%L"),g=c(":%S"),f=c("%I:%M"),b=c("%I %p"),y=c("%a %d"),v=c("%b %d"),x=c("%B"),k=c("%Y");function w(e){return(l(e)<e?m:s(e)<e?g:o(e)<e?f:r(e)<e?b:a(e)<e?i(e)<e?y:v:n(e)<e?x:k)(e)}return u.invert=function(e){return new Date(d(e))},u.domain=function(e){return arguments.length?p(Array.from(e,$)):p().map(z)},u.ticks=function(t){var n=p();return e(n[0],n[n.length-1],null==t?10:t)},u.tickFormat=function(e,t){return null==t?w:c(t)},u.nice=function(e){var n=p();return e&&"function"==typeof e.range||(e=t(n[0],n[n.length-1],null==e?10:e)),e?p(S(n,e)):u},u.copy=function(){return h(u,V(e,t,n,a,i,r,o,s,l,c))},u}function U(){var e,t,a,i,r,o=0,s=1,l=g,c=!1;function u(t){return null==t||isNaN(t=+t)?r:l(0===a?.5:(t=(i(t)-e)*a,c?Math.max(0,Math.min(1,t)):t))}function d(e){return function(t){var n,a;return arguments.length?([n,a]=t,l=e(n,a),u):[l(0),l(1)]}}return u.domain=function(n){return arguments.length?([o,s]=n,e=i(o=+o),t=i(s=+s),a=e===t?0:1/(t-e),u):[o,s]},u.clamp=function(e){return arguments.length?(c=!!e,u):c},u.interpolator=function(e){return arguments.length?(l=e,u):l},u.range=d(n.interpolate),u.rangeRound=d(n.interpolateRound),u.unknown=function(e){return arguments.length?(r=e,u):r},function(n){return i=n,e=n(o),t=n(s),a=e===t?0:1/(t-e),u}}function H(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function G(){var e=P(U());return e.copy=function(){return H(e,G()).exponent(e.exponent())},s.apply(e,arguments)}function Q(){var e,t,a,i,r,o,s,l=0,c=.5,u=1,d=1,p=g,m=!1;function f(e){return isNaN(e=+e)?s:(e=.5+((e=+o(e))-t)*(d*e<d*t?i:r),p(m?Math.max(0,Math.min(1,e)):e))}function b(e){return function(t){var a,i,r;return arguments.length?([a,i,r]=t,p=n.piecewise(e,[a,i,r]),f):[p(0),p(.5),p(1)]}}return f.domain=function(n){return arguments.length?([l,c,u]=n,e=o(l=+l),t=o(c=+c),a=o(u=+u),i=e===t?0:.5/(t-e),r=t===a?0:.5/(a-t),d=t<e?-1:1,f):[l,c,u]},f.clamp=function(e){return arguments.length?(m=!!e,f):m},f.interpolator=function(e){return arguments.length?(p=e,f):p},f.range=b(n.interpolate),f.rangeRound=b(n.interpolateRound),f.unknown=function(e){return arguments.length?(s=e,f):s},function(n){return o=n,e=n(l),t=n(c),a=n(u),i=e===t?0:.5/(t-e),r=t===a?0:.5/(a-t),d=t<e?-1:1,f}}function W(){var e=P(Q());return e.copy=function(){return H(e,W()).exponent(e.exponent())},s.apply(e,arguments)}e.scaleBand=u,e.scaleDiverging=function e(){var t=k(Q()(g));return t.copy=function(){return H(t,e())},s.apply(t,arguments)},e.scaleDivergingLog=function e(){var t=M(Q()).domain([.1,1,10]);return t.copy=function(){return H(t,e()).base(t.base())},s.apply(t,arguments)},e.scaleDivergingPow=W,e.scaleDivergingSqrt=function(){return W.apply(null,arguments).exponent(.5)},e.scaleDivergingSymlog=function e(){var t=F(Q());return t.copy=function(){return H(t,e()).constant(t.constant())},s.apply(t,arguments)},e.scaleIdentity=function e(t){var n;function a(e){return null==e||isNaN(e=+e)?n:e}return a.invert=a,a.domain=a.range=function(e){return arguments.length?(t=Array.from(e,p),a):t.slice()},a.unknown=function(e){return arguments.length?(n=e,a):n},a.copy=function(){return e(t).unknown(n)},t=arguments.length?Array.from(t,p):[0,1],k(a)},e.scaleImplicit=l,e.scaleLinear=function e(){var t=E();return t.copy=function(){return h(t,e())},o.apply(t,arguments),k(t)},e.scaleLog=function e(){var t=M(v()).domain([1,10]);return t.copy=function(){return h(t,e()).base(t.base())},o.apply(t,arguments),t},e.scaleOrdinal=c,e.scalePoint=function(){return d(u.apply(null,arguments).paddingInner(1))},e.scalePow=L,e.scaleQuantile=function e(){var n,a=[],i=[],r=[];function s(){var e=0,n=Math.max(1,i.length);for(r=new Array(n-1);++e<n;)r[e-1]=t.quantileSorted(a,e/n);return l}function l(e){return null==e||isNaN(e=+e)?n:i[t.bisect(r,e)]}return l.invertExtent=function(e){var t=i.indexOf(e);return t<0?[NaN,NaN]:[t>0?r[t-1]:a[0],t<r.length?r[t]:a[a.length-1]]},l.domain=function(e){if(!arguments.length)return a.slice();a=[];for(let t of e)null==t||isNaN(t=+t)||a.push(t);return a.sort(t.ascending),s()},l.range=function(e){return arguments.length?(i=Array.from(e),s()):i.slice()},l.unknown=function(e){return arguments.length?(n=e,l):n},l.quantiles=function(){return r.slice()},l.copy=function(){return e().domain(a).range(i).unknown(n)},o.apply(l,arguments)},e.scaleQuantize=function e(){var n,a=0,i=1,r=1,s=[.5],l=[0,1];function c(e){return null!=e&&e<=e?l[t.bisect(s,e,0,r)]:n}function u(){var e=-1;for(s=new Array(r);++e<r;)s[e]=((e+1)*i-(e-r)*a)/(r+1);return c}return c.domain=function(e){return arguments.length?([a,i]=e,a=+a,i=+i,u()):[a,i]},c.range=function(e){return arguments.length?(r=(l=Array.from(e)).length-1,u()):l.slice()},c.invertExtent=function(e){var t=l.indexOf(e);return t<0?[NaN,NaN]:t<1?[a,s[0]]:t>=r?[s[r-1],i]:[s[t-1],s[t]]},c.unknown=function(e){return arguments.length?(n=e,c):c},c.thresholds=function(){return s.slice()},c.copy=function(){return e().domain([a,i]).range(l).unknown(n)},o.apply(k(c),arguments)},e.scaleRadial=function e(){var t,n=E(),a=[0,1],i=!1;function r(e){var a=B(n(e));return isNaN(a)?t:i?Math.round(a):a}return r.invert=function(e){return n.invert(q(e))},r.domain=function(e){return arguments.length?(n.domain(e),r):n.domain()},r.range=function(e){return arguments.length?(n.range((a=Array.from(e,p)).map(q)),r):a.slice()},r.rangeRound=function(e){return r.range(e).round(!0)},r.round=function(e){return arguments.length?(i=!!e,r):i},r.clamp=function(e){return arguments.length?(n.clamp(e),r):n.clamp()},r.unknown=function(e){return arguments.length?(t=e,r):t},r.copy=function(){return e(n.domain(),a).round(i).clamp(n.clamp()).unknown(t)},o.apply(r,arguments),k(r)},e.scaleSequential=function e(){var t=k(U()(g));return t.copy=function(){return H(t,e())},s.apply(t,arguments)},e.scaleSequentialLog=function e(){var t=M(U()).domain([1,10]);return t.copy=function(){return H(t,e()).base(t.base())},s.apply(t,arguments)},e.scaleSequentialPow=G,e.scaleSequentialQuantile=function e(){var n=[],a=g;function i(e){if(null!=e&&!isNaN(e=+e))return a((t.bisect(n,e,1)-1)/(n.length-1))}return i.domain=function(e){if(!arguments.length)return n.slice();n=[];for(let t of e)null==t||isNaN(t=+t)||n.push(t);return n.sort(t.ascending),i},i.interpolator=function(e){return arguments.length?(a=e,i):a},i.range=function(){return n.map(((e,t)=>a(t/(n.length-1))))},i.quantiles=function(e){return Array.from({length:e+1},((a,i)=>t.quantile(n,i/e)))},i.copy=function(){return e(a).domain(n)},s.apply(i,arguments)},e.scaleSequentialSqrt=function(){return G.apply(null,arguments).exponent(.5)},e.scaleSequentialSymlog=function e(){var t=F(U());return t.copy=function(){return H(t,e()).constant(t.constant())},s.apply(t,arguments)},e.scaleSqrt=function(){return L.apply(null,arguments).exponent(.5)},e.scaleSymlog=function e(){var t=F(v());return t.copy=function(){return h(t,e()).constant(t.constant())},o.apply(t,arguments)},e.scaleThreshold=function e(){var n,a=[.5],i=[0,1],r=1;function s(e){return null!=e&&e<=e?i[t.bisect(a,e,0,r)]:n}return s.domain=function(e){return arguments.length?(a=Array.from(e),r=Math.min(a.length,i.length-1),s):a.slice()},s.range=function(e){return arguments.length?(i=Array.from(e),r=Math.min(a.length,i.length-1),s):i.slice()},s.invertExtent=function(e){var t=i.indexOf(e);return[a[t-1],a[t]]},s.unknown=function(e){return arguments.length?(n=e,s):n},s.copy=function(){return e().domain(a).range(i).unknown(n)},o.apply(s,arguments)},e.scaleTime=function(){return o.apply(V(i.timeTicks,i.timeTickInterval,i.timeYear,i.timeMonth,i.timeWeek,i.timeDay,i.timeHour,i.timeMinute,i.timeSecond,r.timeFormat).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},e.scaleUtc=function(){return o.apply(V(i.utcTicks,i.utcTickInterval,i.utcYear,i.utcMonth,i.utcWeek,i.utcDay,i.utcHour,i.utcMinute,i.utcSecond,r.utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)},e.tickFormat=x,Object.defineProperty(e,"__esModule",{value:!0})}(t,n(641),n(955),n(957),n(642),n(958))},function(e,t,n){!function(e,t){"use strict";function n(e,t,n,a,i){var r=e*e,o=r*e;return((1-3*e+3*r-o)*t+(4-6*r+3*o)*n+(1+3*e+3*r-3*o)*a+o*i)/6}function a(e){var t=e.length-1;return function(a){var i=a<=0?a=0:a>=1?(a=1,t-1):Math.floor(a*t),r=e[i],o=e[i+1],s=i>0?e[i-1]:2*r-o,l=i<t-1?e[i+2]:2*o-r;return n((a-i/t)*t,s,r,o,l)}}function i(e){var t=e.length;return function(a){var i=Math.floor(((a%=1)<0?++a:a)*t),r=e[(i+t-1)%t],o=e[i%t],s=e[(i+1)%t],l=e[(i+2)%t];return n((a-i/t)*t,r,o,s,l)}}var r=e=>()=>e;function o(e,t){return function(n){return e+n*t}}function s(e,t){var n=t-e;return n?o(e,n>180||n<-180?n-360*Math.round(n/360):n):r(isNaN(e)?t:e)}function l(e){return 1==(e=+e)?c:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(a){return Math.pow(e+a*t,n)}}(t,n,e):r(isNaN(t)?n:t)}}function c(e,t){var n=t-e;return n?o(e,n):r(isNaN(e)?t:e)}var u=function e(n){var a=l(n);function i(e,n){var i=a((e=t.rgb(e)).r,(n=t.rgb(n)).r),r=a(e.g,n.g),o=a(e.b,n.b),s=c(e.opacity,n.opacity);return function(t){return e.r=i(t),e.g=r(t),e.b=o(t),e.opacity=s(t),e+""}}return i.gamma=e,i}(1);function d(e){return function(n){var a,i,r=n.length,o=new Array(r),s=new Array(r),l=new Array(r);for(a=0;a<r;++a)i=t.rgb(n[a]),o[a]=i.r||0,s[a]=i.g||0,l[a]=i.b||0;return o=e(o),s=e(s),l=e(l),i.opacity=1,function(e){return i.r=o(e),i.g=s(e),i.b=l(e),i+""}}}var p=d(a),m=d(i);function g(e,t){t||(t=[]);var n,a=e?Math.min(t.length,e.length):0,i=t.slice();return function(r){for(n=0;n<a;++n)i[n]=e[n]*(1-r)+t[n]*r;return i}}function f(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function b(e,t){var n,a=t?t.length:0,i=e?Math.min(a,e.length):0,r=new Array(i),o=new Array(a);for(n=0;n<i;++n)r[n]=S(e[n],t[n]);for(;n<a;++n)o[n]=t[n];return function(e){for(n=0;n<i;++n)o[n]=r[n](e);return o}}function y(e,t){var n=new Date;return e=+e,t=+t,function(a){return n.setTime(e*(1-a)+t*a),n}}function h(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function v(e,t){var n,a={},i={};for(n in null!==e&&"object"==typeof e||(e={}),null!==t&&"object"==typeof t||(t={}),t)n in e?a[n]=S(e[n],t[n]):i[n]=t[n];return function(e){for(n in a)i[n]=a[n](e);return i}}var E=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,x=new RegExp(E.source,"g");function k(e,t){var n,a,i,r=E.lastIndex=x.lastIndex=0,o=-1,s=[],l=[];for(e+="",t+="";(n=E.exec(e))&&(a=x.exec(t));)(i=a.index)>r&&(i=t.slice(r,i),s[o]?s[o]+=i:s[++o]=i),(n=n[0])===(a=a[0])?s[o]?s[o]+=a:s[++o]=a:(s[++o]=null,l.push({i:o,x:h(n,a)})),r=x.lastIndex;return r<t.length&&(i=t.slice(r),s[o]?s[o]+=i:s[++o]=i),s.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var n,a=0;a<t;++a)s[(n=l[a]).i]=n.x(e);return s.join("")})}function S(e,n){var a,i=typeof n;return null==n||"boolean"===i?r(n):("number"===i?h:"string"===i?(a=t.color(n))?(n=a,u):k:n instanceof t.color?u:n instanceof Date?y:f(n)?g:Array.isArray(n)?b:"function"!=typeof n.valueOf&&"function"!=typeof n.toString||isNaN(n)?v:h)(e,n)}var w,j=180/Math.PI,O={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function I(e,t,n,a,i,r){var o,s,l;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(l=e*n+t*a)&&(n-=e*l,a-=t*l),(s=Math.sqrt(n*n+a*a))&&(n/=s,a/=s,l/=s),e*a<t*n&&(e=-e,t=-t,l=-l,o=-o),{translateX:i,translateY:r,rotate:Math.atan2(t,e)*j,skewX:Math.atan(l)*j,scaleX:o,scaleY:s}}function T(e,t,n,a){function i(e){return e.length?e.pop()+" ":""}return function(r,o){var s=[],l=[];return r=e(r),o=e(o),function(e,a,i,r,o,s){if(e!==i||a!==r){var l=o.push("translate(",null,t,null,n);s.push({i:l-4,x:h(e,i)},{i:l-2,x:h(a,r)})}else(i||r)&&o.push("translate("+i+t+r+n)}(r.translateX,r.translateY,o.translateX,o.translateY,s,l),function(e,t,n,r){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),r.push({i:n.push(i(n)+"rotate(",null,a)-2,x:h(e,t)})):t&&n.push(i(n)+"rotate("+t+a)}(r.rotate,o.rotate,s,l),function(e,t,n,r){e!==t?r.push({i:n.push(i(n)+"skewX(",null,a)-2,x:h(e,t)}):t&&n.push(i(n)+"skewX("+t+a)}(r.skewX,o.skewX,s,l),function(e,t,n,a,r,o){if(e!==n||t!==a){var s=r.push(i(r)+"scale(",null,",",null,")");o.push({i:s-4,x:h(e,n)},{i:s-2,x:h(t,a)})}else 1===n&&1===a||r.push(i(r)+"scale("+n+","+a+")")}(r.scaleX,r.scaleY,o.scaleX,o.scaleY,s,l),r=o=null,function(e){for(var t,n=-1,a=l.length;++n<a;)s[(t=l[n]).i]=t.x(e);return s.join("")}}}var C=T((function(e){const t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?O:I(t.a,t.b,t.c,t.d,t.e,t.f)}),"px, ","px)","deg)"),M=T((function(e){return null==e?O:(w||(w=document.createElementNS("http://www.w3.org/2000/svg","g")),w.setAttribute("transform",e),(e=w.transform.baseVal.consolidate())?I((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):O)}),", ",")",")");function N(e){return((e=Math.exp(e))+1/e)/2}var D=function e(t,n,a){function i(e,i){var r,o,s=e[0],l=e[1],c=e[2],u=i[0],d=i[1],p=i[2],m=u-s,g=d-l,f=m*m+g*g;if(f<1e-12)o=Math.log(p/c)/t,r=function(e){return[s+e*m,l+e*g,c*Math.exp(t*e*o)]};else{var b=Math.sqrt(f),y=(p*p-c*c+a*f)/(2*c*n*b),h=(p*p-c*c-a*f)/(2*p*n*b),v=Math.log(Math.sqrt(y*y+1)-y),E=Math.log(Math.sqrt(h*h+1)-h);o=(E-v)/t,r=function(e){var a,i=e*o,r=N(v),u=c/(n*b)*(r*(a=t*i+v,((a=Math.exp(2*a))-1)/(a+1))-function(e){return((e=Math.exp(e))-1/e)/2}(v));return[s+u*m,l+u*g,c*r/N(t*i+v)]}}return r.duration=1e3*o*t/Math.SQRT2,r}return i.rho=function(t){var n=Math.max(.001,+t),a=n*n;return e(n,a,a*a)},i}(Math.SQRT2,2,4);function F(e){return function(n,a){var i=e((n=t.hsl(n)).h,(a=t.hsl(a)).h),r=c(n.s,a.s),o=c(n.l,a.l),s=c(n.opacity,a.opacity);return function(e){return n.h=i(e),n.s=r(e),n.l=o(e),n.opacity=s(e),n+""}}}var A=F(s),_=F(c);function R(e){return function(n,a){var i=e((n=t.hcl(n)).h,(a=t.hcl(a)).h),r=c(n.c,a.c),o=c(n.l,a.l),s=c(n.opacity,a.opacity);return function(e){return n.h=i(e),n.c=r(e),n.l=o(e),n.opacity=s(e),n+""}}}var P=R(s),L=R(c);function q(e){return function n(a){function i(n,i){var r=e((n=t.cubehelix(n)).h,(i=t.cubehelix(i)).h),o=c(n.s,i.s),s=c(n.l,i.l),l=c(n.opacity,i.opacity);return function(e){return n.h=r(e),n.s=o(e),n.l=s(Math.pow(e,a)),n.opacity=l(e),n+""}}return a=+a,i.gamma=n,i}(1)}var B=q(s),z=q(c);e.interpolate=S,e.interpolateArray=function(e,t){return(f(t)?g:b)(e,t)},e.interpolateBasis=a,e.interpolateBasisClosed=i,e.interpolateCubehelix=B,e.interpolateCubehelixLong=z,e.interpolateDate=y,e.interpolateDiscrete=function(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}},e.interpolateHcl=P,e.interpolateHclLong=L,e.interpolateHsl=A,e.interpolateHslLong=_,e.interpolateHue=function(e,t){var n=s(+e,+t);return function(e){var t=n(e);return t-360*Math.floor(t/360)}},e.interpolateLab=function(e,n){var a=c((e=t.lab(e)).l,(n=t.lab(n)).l),i=c(e.a,n.a),r=c(e.b,n.b),o=c(e.opacity,n.opacity);return function(t){return e.l=a(t),e.a=i(t),e.b=r(t),e.opacity=o(t),e+""}},e.interpolateNumber=h,e.interpolateNumberArray=g,e.interpolateObject=v,e.interpolateRgb=u,e.interpolateRgbBasis=p,e.interpolateRgbBasisClosed=m,e.interpolateRound=function(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}},e.interpolateString=k,e.interpolateTransformCss=C,e.interpolateTransformSvg=M,e.interpolateZoom=D,e.piecewise=function(e,t){void 0===t&&(t=e,e=S);for(var n=0,a=t.length-1,i=t[0],r=new Array(a<0?0:a);n<a;)r[n]=e(i,i=t[++n]);return function(e){var t=Math.max(0,Math.min(a-1,Math.floor(e*=a)));return r[t](e-t)}},e.quantize=function(e,t){for(var n=new Array(t),a=0;a<t;++a)n[a]=e(a/(t-1));return n},Object.defineProperty(e,"__esModule",{value:!0})}(t,n(956))},function(e,t,n){!function(e){"use strict";function t(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function n(e,t){var n=Object.create(e.prototype);for(var a in t)n[a]=t[a];return n}function a(){}var i=.7,r=1/i,o="\\s*([+-]?\\d+)\\s*",s="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",l="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",c=/^#([0-9a-f]{3,8})$/,u=new RegExp("^rgb\\("+[o,o,o]+"\\)$"),d=new RegExp("^rgb\\("+[l,l,l]+"\\)$"),p=new RegExp("^rgba\\("+[o,o,o,s]+"\\)$"),m=new RegExp("^rgba\\("+[l,l,l,s]+"\\)$"),g=new RegExp("^hsl\\("+[s,l,l]+"\\)$"),f=new RegExp("^hsla\\("+[s,l,l,s]+"\\)$"),b={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function y(){return this.rgb().formatHex()}function h(){return this.rgb().formatRgb()}function v(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=c.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?E(t):3===n?new w(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?x(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?x(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=u.exec(e))?new w(t[1],t[2],t[3],1):(t=d.exec(e))?new w(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=p.exec(e))?x(t[1],t[2],t[3],t[4]):(t=m.exec(e))?x(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=g.exec(e))?T(t[1],t[2]/100,t[3]/100,1):(t=f.exec(e))?T(t[1],t[2]/100,t[3]/100,t[4]):b.hasOwnProperty(e)?E(b[e]):"transparent"===e?new w(NaN,NaN,NaN,0):null}function E(e){return new w(e>>16&255,e>>8&255,255&e,1)}function x(e,t,n,a){return a<=0&&(e=t=n=NaN),new w(e,t,n,a)}function k(e){return e instanceof a||(e=v(e)),e?new w((e=e.rgb()).r,e.g,e.b,e.opacity):new w}function S(e,t,n,a){return 1===arguments.length?k(e):new w(e,t,n,null==a?1:a)}function w(e,t,n,a){this.r=+e,this.g=+t,this.b=+n,this.opacity=+a}function j(){return"#"+I(this.r)+I(this.g)+I(this.b)}function O(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}function I(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function T(e,t,n,a){return a<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new N(e,t,n,a)}function C(e){if(e instanceof N)return new N(e.h,e.s,e.l,e.opacity);if(e instanceof a||(e=v(e)),!e)return new N;if(e instanceof N)return e;var t=(e=e.rgb()).r/255,n=e.g/255,i=e.b/255,r=Math.min(t,n,i),o=Math.max(t,n,i),s=NaN,l=o-r,c=(o+r)/2;return l?(s=t===o?(n-i)/l+6*(n<i):n===o?(i-t)/l+2:(t-n)/l+4,l/=c<.5?o+r:2-o-r,s*=60):l=c>0&&c<1?0:s,new N(s,l,c,e.opacity)}function M(e,t,n,a){return 1===arguments.length?C(e):new N(e,t,n,null==a?1:a)}function N(e,t,n,a){this.h=+e,this.s=+t,this.l=+n,this.opacity=+a}function D(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}t(a,v,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:y,formatHex:y,formatHsl:function(){return C(this).formatHsl()},formatRgb:h,toString:h}),t(w,S,n(a,{brighter:function(e){return e=null==e?r:Math.pow(r,e),new w(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?i:Math.pow(i,e),new w(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:j,formatHex:j,formatRgb:O,toString:O})),t(N,M,n(a,{brighter:function(e){return e=null==e?r:Math.pow(r,e),new N(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?i:Math.pow(i,e),new N(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,a=n+(n<.5?n:1-n)*t,i=2*n-a;return new w(D(e>=240?e-240:e+120,i,a),D(e,i,a),D(e<120?e+240:e-120,i,a),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}}));const F=Math.PI/180,A=180/Math.PI,_=.96422,R=.82521,P=4/29,L=6/29,q=3*L*L;function B(e){if(e instanceof $)return new $(e.l,e.a,e.b,e.opacity);if(e instanceof K)return Y(e);e instanceof w||(e=k(e));var t,n,a=G(e.r),i=G(e.g),r=G(e.b),o=V((.2225045*a+.7168786*i+.0606169*r)/1);return a===i&&i===r?t=n=o:(t=V((.4360747*a+.3850649*i+.1430804*r)/_),n=V((.0139322*a+.0971045*i+.7141733*r)/R)),new $(116*o-16,500*(t-o),200*(o-n),e.opacity)}function z(e,t,n,a){return 1===arguments.length?B(e):new $(e,t,n,null==a?1:a)}function $(e,t,n,a){this.l=+e,this.a=+t,this.b=+n,this.opacity=+a}function V(e){return e>.008856451679035631?Math.pow(e,1/3):e/q+P}function U(e){return e>L?e*e*e:q*(e-P)}function H(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function G(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Q(e){if(e instanceof K)return new K(e.h,e.c,e.l,e.opacity);if(e instanceof $||(e=B(e)),0===e.a&&0===e.b)return new K(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*A;return new K(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function W(e,t,n,a){return 1===arguments.length?Q(e):new K(e,t,n,null==a?1:a)}function K(e,t,n,a){this.h=+e,this.c=+t,this.l=+n,this.opacity=+a}function Y(e){if(isNaN(e.h))return new $(e.l,0,0,e.opacity);var t=e.h*F;return new $(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}t($,z,n(a,{brighter:function(e){return new $(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker:function(e){return new $(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return new w(H(3.1338561*(t=_*U(t))-1.6168667*(e=1*U(e))-.4906146*(n=R*U(n))),H(-.9787684*t+1.9161415*e+.033454*n),H(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}})),t(K,W,n(a,{brighter:function(e){return new K(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker:function(e){return new K(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb:function(){return Y(this).rgb()}}));var J=-.14861,X=1.78277,Z=-.29227,ee=-.90649,te=1.97294,ne=te*ee,ae=te*X,ie=X*Z-ee*J;function re(e){if(e instanceof se)return new se(e.h,e.s,e.l,e.opacity);e instanceof w||(e=k(e));var t=e.r/255,n=e.g/255,a=e.b/255,i=(ie*a+ne*t-ae*n)/(ie+ne-ae),r=a-i,o=(te*(n-i)-Z*r)/ee,s=Math.sqrt(o*o+r*r)/(te*i*(1-i)),l=s?Math.atan2(o,r)*A-120:NaN;return new se(l<0?l+360:l,s,i,e.opacity)}function oe(e,t,n,a){return 1===arguments.length?re(e):new se(e,t,n,null==a?1:a)}function se(e,t,n,a){this.h=+e,this.s=+t,this.l=+n,this.opacity=+a}t(se,oe,n(a,{brighter:function(e){return e=null==e?r:Math.pow(r,e),new se(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?i:Math.pow(i,e),new se(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*F,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),a=Math.cos(e),i=Math.sin(e);return new w(255*(t+n*(J*a+X*i)),255*(t+n*(Z*a+ee*i)),255*(t+n*(te*a)),this.opacity)}})),e.color=v,e.cubehelix=oe,e.gray=function(e,t){return new $(e,0,0,null==t?1:t)},e.hcl=W,e.hsl=M,e.lab=z,e.lch=function(e,t,n,a){return 1===arguments.length?Q(e):new K(n,t,e,null==a?1:a)},e.rgb=S,Object.defineProperty(e,"__esModule",{value:!0})}(t)},function(e,t,n){!function(e){"use strict";function t(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,a=e.slice(0,n);return[a.length>1?a[0]+a.slice(2):a,+e.slice(n+1)]}function n(e){return(e=t(Math.abs(e)))?e[1]:NaN}var a,i=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function r(e){if(!(t=i.exec(e)))throw new Error("invalid format: "+e);var t;return new o({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function o(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function s(e,n){var a=t(e,n);if(!a)return e+"";var i=a[0],r=a[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}r.prototype=o.prototype,o.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var l={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>s(100*e,t),r:s,s:function(e,n){var i=t(e,n);if(!i)return e+"";var r=i[0],o=i[1],s=o-(a=3*Math.max(-8,Math.min(8,Math.floor(o/3))))+1,l=r.length;return s===l?r:s>l?r+new Array(s-l+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+t(e,Math.max(0,n+s-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function c(e){return e}var u,d=Array.prototype.map,p=["y","z","a","f","p","n","Âµ","m","","k","M","G","T","P","E","Z","Y"];function m(e){var t,i,o=void 0===e.grouping||void 0===e.thousands?c:(t=d.call(e.grouping,Number),i=e.thousands+"",function(e,n){for(var a=e.length,r=[],o=0,s=t[0],l=0;a>0&&s>0&&(l+s+1>n&&(s=Math.max(1,n-l)),r.push(e.substring(a-=s,a+s)),!((l+=s+1)>n));)s=t[o=(o+1)%t.length];return r.reverse().join(i)}),s=void 0===e.currency?"":e.currency[0]+"",u=void 0===e.currency?"":e.currency[1]+"",m=void 0===e.decimal?".":e.decimal+"",g=void 0===e.numerals?c:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(d.call(e.numerals,String)),f=void 0===e.percent?"%":e.percent+"",b=void 0===e.minus?"âˆ’":e.minus+"",y=void 0===e.nan?"NaN":e.nan+"";function h(e){var t=(e=r(e)).fill,n=e.align,i=e.sign,c=e.symbol,d=e.zero,h=e.width,v=e.comma,E=e.precision,x=e.trim,k=e.type;"n"===k?(v=!0,k="g"):l[k]||(void 0===E&&(E=12),x=!0,k="g"),(d||"0"===t&&"="===n)&&(d=!0,t="0",n="=");var S="$"===c?s:"#"===c&&/[boxX]/.test(k)?"0"+k.toLowerCase():"",w="$"===c?u:/[%p]/.test(k)?f:"",j=l[k],O=/[defgprs%]/.test(k);function I(e){var r,s,l,c=S,u=w;if("c"===k)u=j(e)+u,e="";else{var f=(e=+e)<0||1/e<0;if(e=isNaN(e)?y:j(Math.abs(e),E),x&&(e=function(e){e:for(var t,n=e.length,a=1,i=-1;a<n;++a)switch(e[a]){case".":i=t=a;break;case"0":0===i&&(i=a),t=a;break;default:if(!+e[a])break e;i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(t+1):e}(e)),f&&0==+e&&"+"!==i&&(f=!1),c=(f?"("===i?i:b:"-"===i||"("===i?"":i)+c,u=("s"===k?p[8+a/3]:"")+u+(f&&"("===i?")":""),O)for(r=-1,s=e.length;++r<s;)if(48>(l=e.charCodeAt(r))||l>57){u=(46===l?m+e.slice(r+1):e.slice(r))+u,e=e.slice(0,r);break}}v&&!d&&(e=o(e,1/0));var I=c.length+e.length+u.length,T=I<h?new Array(h-I+1).join(t):"";switch(v&&d&&(e=o(T+e,T.length?h-u.length:1/0),T=""),n){case"<":e=c+e+u+T;break;case"=":e=c+T+e+u;break;case"^":e=T.slice(0,I=T.length>>1)+c+e+u+T.slice(I);break;default:e=T+c+e+u}return g(e)}return E=void 0===E?6:/[gprs]/.test(k)?Math.max(1,Math.min(21,E)):Math.max(0,Math.min(20,E)),I.toString=function(){return e+""},I}return{format:h,formatPrefix:function(e,t){var a=h(((e=r(e)).type="f",e)),i=3*Math.max(-8,Math.min(8,Math.floor(n(t)/3))),o=Math.pow(10,-i),s=p[8+i/3];return function(e){return a(o*e)+s}}}}function g(t){return u=m(t),e.format=u.format,e.formatPrefix=u.formatPrefix,u}g({thousands:",",grouping:[3],currency:["$",""]}),e.FormatSpecifier=o,e.formatDefaultLocale=g,e.formatLocale=m,e.formatSpecifier=r,e.precisionFixed=function(e){return Math.max(0,-n(Math.abs(e)))},e.precisionPrefix=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(n(t)/3)))-n(Math.abs(e)))},e.precisionRound=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,n(t)-n(e))+1},Object.defineProperty(e,"__esModule",{value:!0})}(t)},function(e,t,n){!function(e,t){"use strict";function n(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function a(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function i(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function r(e){var r=e.dateTime,o=e.date,l=e.time,c=e.periods,u=e.days,d=e.shortDays,p=e.months,G=e.shortMonths,pe=m(c),we=g(c),je=m(u),Oe=g(u),Ie=m(d),Te=g(d),Ce=m(p),Me=g(p),Ne=m(G),De=g(G),Fe={a:function(e){return d[e.getDay()]},A:function(e){return u[e.getDay()]},b:function(e){return G[e.getMonth()]},B:function(e){return p[e.getMonth()]},c:null,d:_,e:_,f:B,g:J,G:Z,H:R,I:P,j:L,L:q,m:z,M:$,p:function(e){return c[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:ke,s:Se,S:V,u:U,U:H,V:Q,w:W,W:K,x:null,X:null,y:Y,Y:X,Z:ee,"%":xe},Ae={a:function(e){return d[e.getUTCDay()]},A:function(e){return u[e.getUTCDay()]},b:function(e){return G[e.getUTCMonth()]},B:function(e){return p[e.getUTCMonth()]},c:null,d:te,e:te,f:oe,g:ye,G:ve,H:ne,I:ae,j:ie,L:re,m:se,M:le,p:function(e){return c[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:ke,s:Se,S:ce,u:ue,U:de,V:me,w:ge,W:fe,x:null,X:null,y:be,Y:he,Z:Ee,"%":xe},_e={a:function(e,t,n){var a=Ie.exec(t.slice(n));return a?(e.w=Te.get(a[0].toLowerCase()),n+a[0].length):-1},A:function(e,t,n){var a=je.exec(t.slice(n));return a?(e.w=Oe.get(a[0].toLowerCase()),n+a[0].length):-1},b:function(e,t,n){var a=Ne.exec(t.slice(n));return a?(e.m=De.get(a[0].toLowerCase()),n+a[0].length):-1},B:function(e,t,n){var a=Ce.exec(t.slice(n));return a?(e.m=Me.get(a[0].toLowerCase()),n+a[0].length):-1},c:function(e,t,n){return Le(e,r,t,n)},d:j,e:j,f:N,g:x,G:E,H:I,I:I,j:O,L:M,m:w,M:T,p:function(e,t,n){var a=pe.exec(t.slice(n));return a?(e.p=we.get(a[0].toLowerCase()),n+a[0].length):-1},q:S,Q:F,s:A,S:C,u:b,U:y,V:h,w:f,W:v,x:function(e,t,n){return Le(e,o,t,n)},X:function(e,t,n){return Le(e,l,t,n)},y:x,Y:E,Z:k,"%":D};function Re(e,t){return function(n){var a,i,r,o=[],l=-1,c=0,u=e.length;for(n instanceof Date||(n=new Date(+n));++l<u;)37===e.charCodeAt(l)&&(o.push(e.slice(c,l)),null!=(i=s[a=e.charAt(++l)])?a=e.charAt(++l):i="e"===a?" ":"0",(r=t[a])&&(a=r(n,i)),o.push(a),c=l+1);return o.push(e.slice(c,l)),o.join("")}}function Pe(e,r){return function(o){var s,l,c=i(1900,void 0,1);if(Le(c,e,o+="",0)!=o.length)return null;if("Q"in c)return new Date(c.Q);if("s"in c)return new Date(1e3*c.s+("L"in c?c.L:0));if(r&&!("Z"in c)&&(c.Z=0),"p"in c&&(c.H=c.H%12+12*c.p),void 0===c.m&&(c.m="q"in c?c.q:0),"V"in c){if(c.V<1||c.V>53)return null;"w"in c||(c.w=1),"Z"in c?(l=(s=a(i(c.y,0,1))).getUTCDay(),s=l>4||0===l?t.utcMonday.ceil(s):t.utcMonday(s),s=t.utcDay.offset(s,7*(c.V-1)),c.y=s.getUTCFullYear(),c.m=s.getUTCMonth(),c.d=s.getUTCDate()+(c.w+6)%7):(l=(s=n(i(c.y,0,1))).getDay(),s=l>4||0===l?t.timeMonday.ceil(s):t.timeMonday(s),s=t.timeDay.offset(s,7*(c.V-1)),c.y=s.getFullYear(),c.m=s.getMonth(),c.d=s.getDate()+(c.w+6)%7)}else("W"in c||"U"in c)&&("w"in c||(c.w="u"in c?c.u%7:"W"in c?1:0),l="Z"in c?a(i(c.y,0,1)).getUTCDay():n(i(c.y,0,1)).getDay(),c.m=0,c.d="W"in c?(c.w+6)%7+7*c.W-(l+5)%7:c.w+7*c.U-(l+6)%7);return"Z"in c?(c.H+=c.Z/100|0,c.M+=c.Z%100,a(c)):n(c)}}function Le(e,t,n,a){for(var i,r,o=0,l=t.length,c=n.length;o<l;){if(a>=c)return-1;if(37===(i=t.charCodeAt(o++))){if(i=t.charAt(o++),!(r=_e[i in s?t.charAt(o++):i])||(a=r(e,n,a))<0)return-1}else if(i!=n.charCodeAt(a++))return-1}return a}return Fe.x=Re(o,Fe),Fe.X=Re(l,Fe),Fe.c=Re(r,Fe),Ae.x=Re(o,Ae),Ae.X=Re(l,Ae),Ae.c=Re(r,Ae),{format:function(e){var t=Re(e+="",Fe);return t.toString=function(){return e},t},parse:function(e){var t=Pe(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=Re(e+="",Ae);return t.toString=function(){return e},t},utcParse:function(e){var t=Pe(e+="",!0);return t.toString=function(){return e},t}}}var o,s={"-":"",_:" ",0:"0"},l=/^\s*\d+/,c=/^%/,u=/[\\^$*+?|[\]().{}]/g;function d(e,t,n){var a=e<0?"-":"",i=(a?-e:e)+"",r=i.length;return a+(r<n?new Array(n-r+1).join(t)+i:i)}function p(e){return e.replace(u,"\\$&")}function m(e){return new RegExp("^(?:"+e.map(p).join("|")+")","i")}function g(e){return new Map(e.map(((e,t)=>[e.toLowerCase(),t])))}function f(e,t,n){var a=l.exec(t.slice(n,n+1));return a?(e.w=+a[0],n+a[0].length):-1}function b(e,t,n){var a=l.exec(t.slice(n,n+1));return a?(e.u=+a[0],n+a[0].length):-1}function y(e,t,n){var a=l.exec(t.slice(n,n+2));return a?(e.U=+a[0],n+a[0].length):-1}function h(e,t,n){var a=l.exec(t.slice(n,n+2));return a?(e.V=+a[0],n+a[0].length):-1}function v(e,t,n){var a=l.exec(t.slice(n,n+2));return a?(e.W=+a[0],n+a[0].length):-1}function E(e,t,n){var a=l.exec(t.slice(n,n+4));return a?(e.y=+a[0],n+a[0].length):-1}function x(e,t,n){var a=l.exec(t.slice(n,n+2));return a?(e.y=+a[0]+(+a[0]>68?1900:2e3),n+a[0].length):-1}function k(e,t,n){var a=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return a?(e.Z=a[1]?0:-(a[2]+(a[3]||"00")),n+a[0].length):-1}function S(e,t,n){var a=l.exec(t.slice(n,n+1));return a?(e.q=3*a[0]-3,n+a[0].length):-1}function w(e,t,n){var a=l.exec(t.slice(n,n+2));return a?(e.m=a[0]-1,n+a[0].length):-1}function j(e,t,n){var a=l.exec(t.slice(n,n+2));return a?(e.d=+a[0],n+a[0].length):-1}function O(e,t,n){var a=l.exec(t.slice(n,n+3));return a?(e.m=0,e.d=+a[0],n+a[0].length):-1}function I(e,t,n){var a=l.exec(t.slice(n,n+2));return a?(e.H=+a[0],n+a[0].length):-1}function T(e,t,n){var a=l.exec(t.slice(n,n+2));return a?(e.M=+a[0],n+a[0].length):-1}function C(e,t,n){var a=l.exec(t.slice(n,n+2));return a?(e.S=+a[0],n+a[0].length):-1}function M(e,t,n){var a=l.exec(t.slice(n,n+3));return a?(e.L=+a[0],n+a[0].length):-1}function N(e,t,n){var a=l.exec(t.slice(n,n+6));return a?(e.L=Math.floor(a[0]/1e3),n+a[0].length):-1}function D(e,t,n){var a=c.exec(t.slice(n,n+1));return a?n+a[0].length:-1}function F(e,t,n){var a=l.exec(t.slice(n));return a?(e.Q=+a[0],n+a[0].length):-1}function A(e,t,n){var a=l.exec(t.slice(n));return a?(e.s=+a[0],n+a[0].length):-1}function _(e,t){return d(e.getDate(),t,2)}function R(e,t){return d(e.getHours(),t,2)}function P(e,t){return d(e.getHours()%12||12,t,2)}function L(e,n){return d(1+t.timeDay.count(t.timeYear(e),e),n,3)}function q(e,t){return d(e.getMilliseconds(),t,3)}function B(e,t){return q(e,t)+"000"}function z(e,t){return d(e.getMonth()+1,t,2)}function $(e,t){return d(e.getMinutes(),t,2)}function V(e,t){return d(e.getSeconds(),t,2)}function U(e){var t=e.getDay();return 0===t?7:t}function H(e,n){return d(t.timeSunday.count(t.timeYear(e)-1,e),n,2)}function G(e){var n=e.getDay();return n>=4||0===n?t.timeThursday(e):t.timeThursday.ceil(e)}function Q(e,n){return e=G(e),d(t.timeThursday.count(t.timeYear(e),e)+(4===t.timeYear(e).getDay()),n,2)}function W(e){return e.getDay()}function K(e,n){return d(t.timeMonday.count(t.timeYear(e)-1,e),n,2)}function Y(e,t){return d(e.getFullYear()%100,t,2)}function J(e,t){return d((e=G(e)).getFullYear()%100,t,2)}function X(e,t){return d(e.getFullYear()%1e4,t,4)}function Z(e,n){var a=e.getDay();return d((e=a>=4||0===a?t.timeThursday(e):t.timeThursday.ceil(e)).getFullYear()%1e4,n,4)}function ee(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+d(t/60|0,"0",2)+d(t%60,"0",2)}function te(e,t){return d(e.getUTCDate(),t,2)}function ne(e,t){return d(e.getUTCHours(),t,2)}function ae(e,t){return d(e.getUTCHours()%12||12,t,2)}function ie(e,n){return d(1+t.utcDay.count(t.utcYear(e),e),n,3)}function re(e,t){return d(e.getUTCMilliseconds(),t,3)}function oe(e,t){return re(e,t)+"000"}function se(e,t){return d(e.getUTCMonth()+1,t,2)}function le(e,t){return d(e.getUTCMinutes(),t,2)}function ce(e,t){return d(e.getUTCSeconds(),t,2)}function ue(e){var t=e.getUTCDay();return 0===t?7:t}function de(e,n){return d(t.utcSunday.count(t.utcYear(e)-1,e),n,2)}function pe(e){var n=e.getUTCDay();return n>=4||0===n?t.utcThursday(e):t.utcThursday.ceil(e)}function me(e,n){return e=pe(e),d(t.utcThursday.count(t.utcYear(e),e)+(4===t.utcYear(e).getUTCDay()),n,2)}function ge(e){return e.getUTCDay()}function fe(e,n){return d(t.utcMonday.count(t.utcYear(e)-1,e),n,2)}function be(e,t){return d(e.getUTCFullYear()%100,t,2)}function ye(e,t){return d((e=pe(e)).getUTCFullYear()%100,t,2)}function he(e,t){return d(e.getUTCFullYear()%1e4,t,4)}function ve(e,n){var a=e.getUTCDay();return d((e=a>=4||0===a?t.utcThursday(e):t.utcThursday.ceil(e)).getUTCFullYear()%1e4,n,4)}function Ee(){return"+0000"}function xe(){return"%"}function ke(e){return+e}function Se(e){return Math.floor(+e/1e3)}function we(t){return o=r(t),e.timeFormat=o.format,e.timeParse=o.parse,e.utcFormat=o.utcFormat,e.utcParse=o.utcParse,o}we({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var je="%Y-%m-%dT%H:%M:%S.%LZ";var Oe=Date.prototype.toISOString?function(e){return e.toISOString()}:e.utcFormat(je);var Ie=+new Date("2000-01-01T00:00:00.000Z")?function(e){var t=new Date(e);return isNaN(t)?null:t}:e.utcParse(je);e.isoFormat=Oe,e.isoParse=Ie,e.timeFormatDefaultLocale=we,e.timeFormatLocale=r,Object.defineProperty(e,"__esModule",{value:!0})}(t,n(642))},function(e,t,n){"use strict";var a=n(960),i=n(961).remove,r={},o={},s={},l={},c={};function u(e){return String("000"+(e||"")).slice(-3)}function d(e){return s[e]}function p(e){return o[e]}function m(e){var t=u(e);return p(l[t])}function g(e){var t=u(e);return l[t]}function f(e){if("string"==typeof e){if(/^[0-9]*$/.test(e))return g(e);if(2===e.length)return e.toUpperCase();if(3===e.length)return d(e.toUpperCase())}if("number"==typeof e)return g(e)}a.forEach((function(e){var t=e;o[t[0]]=t[1],s[t[1]]=t[0],l[t[2]]=t[0],c[t[0]]=t[2]})),t.registerLocale=function(e){if(!e.locale)throw new TypeError("Missing localeData.locale");if(!e.countries)throw new TypeError("Missing localeData.countries");r[e.locale]=e.countries},t.alpha3ToAlpha2=d,t.alpha2ToAlpha3=p,t.alpha3ToNumeric=function(e){return c[d(e)]},t.alpha2ToNumeric=function(e){return c[e]},t.numericToAlpha3=m,t.numericToAlpha2=g,t.toAlpha3=function(e){if("string"==typeof e){if(/^[0-9]*$/.test(e))return m(e);if(2===e.length)return p(e.toUpperCase());if(3===e.length)return e.toUpperCase()}if("number"==typeof e)return m(e)},t.toAlpha2=f,t.getName=function(e,t){try{return r[t.toLowerCase()][f(e)]}catch(e){return}},t.getNames=function(e){var t=r[e.toLowerCase()];return void 0===t?{}:t},t.getAlpha2Code=function(e,t){try{var n,a=r[t.toLowerCase()];for(n in a)if(a.hasOwnProperty(n)&&a[n].toLowerCase()===e.toLowerCase())return n;return}catch(e){return}},t.getSimpleAlpha2Code=function(e,t){try{var n,a=r[t.toLowerCase()];for(n in a)if(a.hasOwnProperty(n)&&i(a[n].toLowerCase())===i(e.toLowerCase()))return n;return}catch(e){return}},t.getAlpha2Codes=function(){return o},t.getAlpha3Code=function(e,t){var n=this.getAlpha2Code(e,t);return n?this.toAlpha3(n):void 0},t.getSimpleAlpha3Code=function(e,t){var n=this.getSimpleAlpha2Code(e,t);return n?this.toAlpha3(n):void 0},t.getAlpha3Codes=function(){return s},t.getNumericCodes=function(){return l},t.langs=function(){return Object.keys(r)},t.isValid=function(e){if(!e)return!1;var t=e.toString().toUpperCase();return s.hasOwnProperty(t)||o.hasOwnProperty(t)||l.hasOwnProperty(t)}},function(e){e.exports=JSON.parse('[["AF","AFG","004","ISO 3166-2:AF"],["AX","ALA","248","ISO 3166-2:AX"],["AL","ALB","008","ISO 3166-2:AL"],["DZ","DZA","012","ISO 3166-2:DZ"],["AS","ASM","016","ISO 3166-2:AS"],["AD","AND","020","ISO 3166-2:AD"],["AO","AGO","024","ISO 3166-2:AO"],["AI","AIA","660","ISO 3166-2:AI"],["AQ","ATA","010","ISO 3166-2:AQ"],["AG","ATG","028","ISO 3166-2:AG"],["AR","ARG","032","ISO 3166-2:AR"],["AM","ARM","051","ISO 3166-2:AM"],["AW","ABW","533","ISO 3166-2:AW"],["AU","AUS","036","ISO 3166-2:AU"],["AT","AUT","040","ISO 3166-2:AT"],["AZ","AZE","031","ISO 3166-2:AZ"],["BS","BHS","044","ISO 3166-2:BS"],["BH","BHR","048","ISO 3166-2:BH"],["BD","BGD","050","ISO 3166-2:BD"],["BB","BRB","052","ISO 3166-2:BB"],["BY","BLR","112","ISO 3166-2:BY"],["BE","BEL","056","ISO 3166-2:BE"],["BZ","BLZ","084","ISO 3166-2:BZ"],["BJ","BEN","204","ISO 3166-2:BJ"],["BM","BMU","060","ISO 3166-2:BM"],["BT","BTN","064","ISO 3166-2:BT"],["BO","BOL","068","ISO 3166-2:BO"],["BQ","BES","535","ISO 3166-2:BQ"],["BA","BIH","070","ISO 3166-2:BA"],["BW","BWA","072","ISO 3166-2:BW"],["BV","BVT","074","ISO 3166-2:BV"],["BR","BRA","076","ISO 3166-2:BR"],["IO","IOT","086","ISO 3166-2:IO"],["BN","BRN","096","ISO 3166-2:BN"],["BG","BGR","100","ISO 3166-2:BG"],["BF","BFA","854","ISO 3166-2:BF"],["BI","BDI","108","ISO 3166-2:BI"],["KH","KHM","116","ISO 3166-2:KH"],["CM","CMR","120","ISO 3166-2:CM"],["CA","CAN","124","ISO 3166-2:CA"],["CV","CPV","132","ISO 3166-2:CV"],["KY","CYM","136","ISO 3166-2:KY"],["CF","CAF","140","ISO 3166-2:CF"],["TD","TCD","148","ISO 3166-2:TD"],["CL","CHL","152","ISO 3166-2:CL"],["CN","CHN","156","ISO 3166-2:CN"],["CX","CXR","162","ISO 3166-2:CX"],["CC","CCK","166","ISO 3166-2:CC"],["CO","COL","170","ISO 3166-2:CO"],["KM","COM","174","ISO 3166-2:KM"],["CG","COG","178","ISO 3166-2:CG"],["CD","COD","180","ISO 3166-2:CD"],["CK","COK","184","ISO 3166-2:CK"],["CR","CRI","188","ISO 3166-2:CR"],["CI","CIV","384","ISO 3166-2:CI"],["HR","HRV","191","ISO 3166-2:HR"],["CU","CUB","192","ISO 3166-2:CU"],["CW","CUW","531","ISO 3166-2:CW"],["CY","CYP","196","ISO 3166-2:CY"],["CZ","CZE","203","ISO 3166-2:CZ"],["DK","DNK","208","ISO 3166-2:DK"],["DJ","DJI","262","ISO 3166-2:DJ"],["DM","DMA","212","ISO 3166-2:DM"],["DO","DOM","214","ISO 3166-2:DO"],["EC","ECU","218","ISO 3166-2:EC"],["EG","EGY","818","ISO 3166-2:EG"],["SV","SLV","222","ISO 3166-2:SV"],["GQ","GNQ","226","ISO 3166-2:GQ"],["ER","ERI","232","ISO 3166-2:ER"],["EE","EST","233","ISO 3166-2:EE"],["ET","ETH","231","ISO 3166-2:ET"],["FK","FLK","238","ISO 3166-2:FK"],["FO","FRO","234","ISO 3166-2:FO"],["FJ","FJI","242","ISO 3166-2:FJ"],["FI","FIN","246","ISO 3166-2:FI"],["FR","FRA","250","ISO 3166-2:FR"],["GF","GUF","254","ISO 3166-2:GF"],["PF","PYF","258","ISO 3166-2:PF"],["TF","ATF","260","ISO 3166-2:TF"],["GA","GAB","266","ISO 3166-2:GA"],["GM","GMB","270","ISO 3166-2:GM"],["GE","GEO","268","ISO 3166-2:GE"],["DE","DEU","276","ISO 3166-2:DE"],["GH","GHA","288","ISO 3166-2:GH"],["GI","GIB","292","ISO 3166-2:GI"],["GR","GRC","300","ISO 3166-2:GR"],["GL","GRL","304","ISO 3166-2:GL"],["GD","GRD","308","ISO 3166-2:GD"],["GP","GLP","312","ISO 3166-2:GP"],["GU","GUM","316","ISO 3166-2:GU"],["GT","GTM","320","ISO 3166-2:GT"],["GG","GGY","831","ISO 3166-2:GG"],["GN","GIN","324","ISO 3166-2:GN"],["GW","GNB","624","ISO 3166-2:GW"],["GY","GUY","328","ISO 3166-2:GY"],["HT","HTI","332","ISO 3166-2:HT"],["HM","HMD","334","ISO 3166-2:HM"],["VA","VAT","336","ISO 3166-2:VA"],["HN","HND","340","ISO 3166-2:HN"],["HK","HKG","344","ISO 3166-2:HK"],["HU","HUN","348","ISO 3166-2:HU"],["IS","ISL","352","ISO 3166-2:IS"],["IN","IND","356","ISO 3166-2:IN"],["ID","IDN","360","ISO 3166-2:ID"],["IR","IRN","364","ISO 3166-2:IR"],["IQ","IRQ","368","ISO 3166-2:IQ"],["IE","IRL","372","ISO 3166-2:IE"],["IM","IMN","833","ISO 3166-2:IM"],["IL","ISR","376","ISO 3166-2:IL"],["IT","ITA","380","ISO 3166-2:IT"],["JM","JAM","388","ISO 3166-2:JM"],["JP","JPN","392","ISO 3166-2:JP"],["JE","JEY","832","ISO 3166-2:JE"],["JO","JOR","400","ISO 3166-2:JO"],["KZ","KAZ","398","ISO 3166-2:KZ"],["KE","KEN","404","ISO 3166-2:KE"],["KI","KIR","296","ISO 3166-2:KI"],["KP","PRK","408","ISO 3166-2:KP"],["KR","KOR","410","ISO 3166-2:KR"],["KW","KWT","414","ISO 3166-2:KW"],["KG","KGZ","417","ISO 3166-2:KG"],["LA","LAO","418","ISO 3166-2:LA"],["LV","LVA","428","ISO 3166-2:LV"],["LB","LBN","422","ISO 3166-2:LB"],["LS","LSO","426","ISO 3166-2:LS"],["LR","LBR","430","ISO 3166-2:LR"],["LY","LBY","434","ISO 3166-2:LY"],["LI","LIE","438","ISO 3166-2:LI"],["LT","LTU","440","ISO 3166-2:LT"],["LU","LUX","442","ISO 3166-2:LU"],["MO","MAC","446","ISO 3166-2:MO"],["MK","MKD","807","ISO 3166-2:MK"],["MG","MDG","450","ISO 3166-2:MG"],["MW","MWI","454","ISO 3166-2:MW"],["MY","MYS","458","ISO 3166-2:MY"],["MV","MDV","462","ISO 3166-2:MV"],["ML","MLI","466","ISO 3166-2:ML"],["MT","MLT","470","ISO 3166-2:MT"],["MH","MHL","584","ISO 3166-2:MH"],["MQ","MTQ","474","ISO 3166-2:MQ"],["MR","MRT","478","ISO 3166-2:MR"],["MU","MUS","480","ISO 3166-2:MU"],["YT","MYT","175","ISO 3166-2:YT"],["MX","MEX","484","ISO 3166-2:MX"],["FM","FSM","583","ISO 3166-2:FM"],["MD","MDA","498","ISO 3166-2:MD"],["MC","MCO","492","ISO 3166-2:MC"],["MN","MNG","496","ISO 3166-2:MN"],["ME","MNE","499","ISO 3166-2:ME"],["MS","MSR","500","ISO 3166-2:MS"],["MA","MAR","504","ISO 3166-2:MA"],["MZ","MOZ","508","ISO 3166-2:MZ"],["MM","MMR","104","ISO 3166-2:MM"],["NA","NAM","516","ISO 3166-2:NA"],["NR","NRU","520","ISO 3166-2:NR"],["NP","NPL","524","ISO 3166-2:NP"],["NL","NLD","528","ISO 3166-2:NL"],["NC","NCL","540","ISO 3166-2:NC"],["NZ","NZL","554","ISO 3166-2:NZ"],["NI","NIC","558","ISO 3166-2:NI"],["NE","NER","562","ISO 3166-2:NE"],["NG","NGA","566","ISO 3166-2:NG"],["NU","NIU","570","ISO 3166-2:NU"],["NF","NFK","574","ISO 3166-2:NF"],["MP","MNP","580","ISO 3166-2:MP"],["NO","NOR","578","ISO 3166-2:NO"],["OM","OMN","512","ISO 3166-2:OM"],["PK","PAK","586","ISO 3166-2:PK"],["PW","PLW","585","ISO 3166-2:PW"],["PS","PSE","275","ISO 3166-2:PS"],["PA","PAN","591","ISO 3166-2:PA"],["PG","PNG","598","ISO 3166-2:PG"],["PY","PRY","600","ISO 3166-2:PY"],["PE","PER","604","ISO 3166-2:PE"],["PH","PHL","608","ISO 3166-2:PH"],["PN","PCN","612","ISO 3166-2:PN"],["PL","POL","616","ISO 3166-2:PL"],["PT","PRT","620","ISO 3166-2:PT"],["PR","PRI","630","ISO 3166-2:PR"],["QA","QAT","634","ISO 3166-2:QA"],["RE","REU","638","ISO 3166-2:RE"],["RO","ROU","642","ISO 3166-2:RO"],["RU","RUS","643","ISO 3166-2:RU"],["RW","RWA","646","ISO 3166-2:RW"],["BL","BLM","652","ISO 3166-2:BL"],["SH","SHN","654","ISO 3166-2:SH"],["KN","KNA","659","ISO 3166-2:KN"],["LC","LCA","662","ISO 3166-2:LC"],["MF","MAF","663","ISO 3166-2:MF"],["PM","SPM","666","ISO 3166-2:PM"],["VC","VCT","670","ISO 3166-2:VC"],["WS","WSM","882","ISO 3166-2:WS"],["SM","SMR","674","ISO 3166-2:SM"],["ST","STP","678","ISO 3166-2:ST"],["SA","SAU","682","ISO 3166-2:SA"],["SN","SEN","686","ISO 3166-2:SN"],["RS","SRB","688","ISO 3166-2:RS"],["SC","SYC","690","ISO 3166-2:SC"],["SL","SLE","694","ISO 3166-2:SL"],["SG","SGP","702","ISO 3166-2:SG"],["SX","SXM","534","ISO 3166-2:SX"],["SK","SVK","703","ISO 3166-2:SK"],["SI","SVN","705","ISO 3166-2:SI"],["SB","SLB","090","ISO 3166-2:SB"],["SO","SOM","706","ISO 3166-2:SO"],["ZA","ZAF","710","ISO 3166-2:ZA"],["GS","SGS","239","ISO 3166-2:GS"],["SS","SSD","728","ISO 3166-2:SS"],["ES","ESP","724","ISO 3166-2:ES"],["LK","LKA","144","ISO 3166-2:LK"],["SD","SDN","729","ISO 3166-2:SD"],["SR","SUR","740","ISO 3166-2:SR"],["SJ","SJM","744","ISO 3166-2:SJ"],["SZ","SWZ","748","ISO 3166-2:SZ"],["SE","SWE","752","ISO 3166-2:SE"],["CH","CHE","756","ISO 3166-2:CH"],["SY","SYR","760","ISO 3166-2:SY"],["TW","TWN","158","ISO 3166-2:TW"],["TJ","TJK","762","ISO 3166-2:TJ"],["TZ","TZA","834","ISO 3166-2:TZ"],["TH","THA","764","ISO 3166-2:TH"],["TL","TLS","626","ISO 3166-2:TL"],["TG","TGO","768","ISO 3166-2:TG"],["TK","TKL","772","ISO 3166-2:TK"],["TO","TON","776","ISO 3166-2:TO"],["TT","TTO","780","ISO 3166-2:TT"],["TN","TUN","788","ISO 3166-2:TN"],["TR","TUR","792","ISO 3166-2:TR"],["TM","TKM","795","ISO 3166-2:TM"],["TC","TCA","796","ISO 3166-2:TC"],["TV","TUV","798","ISO 3166-2:TV"],["UG","UGA","800","ISO 3166-2:UG"],["UA","UKR","804","ISO 3166-2:UA"],["AE","ARE","784","ISO 3166-2:AE"],["GB","GBR","826","ISO 3166-2:GB"],["US","USA","840","ISO 3166-2:US"],["UM","UMI","581","ISO 3166-2:UM"],["UY","URY","858","ISO 3166-2:UY"],["UZ","UZB","860","ISO 3166-2:UZ"],["VU","VUT","548","ISO 3166-2:VU"],["VE","VEN","862","ISO 3166-2:VE"],["VN","VNM","704","ISO 3166-2:VN"],["VG","VGB","092","ISO 3166-2:VG"],["VI","VIR","850","ISO 3166-2:VI"],["WF","WLF","876","ISO 3166-2:WF"],["EH","ESH","732","ISO 3166-2:EH"],["YE","YEM","887","ISO 3166-2:YE"],["ZM","ZMB","894","ISO 3166-2:ZM"],["ZW","ZWE","716","ISO 3166-2:ZW"],["XK","XKX","","ISO 3166-2:XK"]]')},function(e,t){t.remove=function(e){return e.replace(/[^\u0000-\u007e]/g,(function(e){return a[e]||e}))};for(var n=[{base:" ",chars:"Â "},{base:"0",chars:"ß€"},{base:"A",chars:"â’¶ï¼¡Ã€ÃÃ‚áº¦áº¤áºªáº¨ÃƒÄ€Ä‚áº°áº®áº´áº²È¦Ç Ã„Çžáº¢Ã…ÇºÇÈ€È‚áº áº¬áº¶á¸€Ä„Èºâ±¯"},{base:"AA",chars:"êœ²"},{base:"AE",chars:"Ã†Ç¼Ç¢"},{base:"AO",chars:"êœ´"},{base:"AU",chars:"êœ¶"},{base:"AV",chars:"êœ¸êœº"},{base:"AY",chars:"êœ¼"},{base:"B",chars:"â’·ï¼¢á¸‚á¸„á¸†ÉƒÆ"},{base:"C",chars:"â’¸ï¼£êœ¾á¸ˆÄ†CÄˆÄŠÄŒÃ‡Æ‡È»"},{base:"D",chars:"â’¹ï¼¤á¸ŠÄŽá¸Œá¸á¸’á¸ŽÄÆŠÆ‰á´…ê¹"},{base:"Dh",chars:"Ã"},{base:"DZ",chars:"Ç±Ç„"},{base:"Dz",chars:"Ç²Ç…"},{base:"E",chars:"É›â’ºï¼¥ÃˆÃ‰ÃŠá»€áº¾á»„á»‚áº¼Ä’á¸”á¸–Ä”Ä–Ã‹áººÄšÈ„È†áº¸á»†È¨á¸œÄ˜á¸˜á¸šÆÆŽá´‡"},{base:"F",chars:"ê¼â’»ï¼¦á¸žÆ‘ê»"},{base:"G",chars:"â’¼ï¼§Ç´Äœá¸ ÄžÄ Ç¦Ä¢Ç¤Æ“êž ê½ê¾É¢"},{base:"H",chars:"â’½ï¼¨Ä¤á¸¢á¸¦Èžá¸¤á¸¨á¸ªÄ¦â±§â±µêž"},{base:"I",chars:"â’¾ï¼©ÃŒÃÃŽÄ¨ÄªÄ¬Ä°Ãá¸®á»ˆÇÈˆÈŠá»ŠÄ®á¸¬Æ—"},{base:"J",chars:"â’¿ï¼ªÄ´ÉˆÈ·"},{base:"K",chars:"â“€ï¼«á¸°Ç¨á¸²Ä¶á¸´Æ˜â±©ê€ê‚ê„êž¢"},{base:"L",chars:"â“ï¼¬Ä¿Ä¹Ä½á¸¶á¸¸Ä»á¸¼á¸ºÅÈ½â±¢â± êˆê†êž€"},{base:"LJ",chars:"Ç‡"},{base:"Lj",chars:"Çˆ"},{base:"M",chars:"â“‚ï¼­á¸¾á¹€á¹‚â±®ÆœÏ»"},{base:"N",chars:"êž¤È â“ƒï¼®Ç¸ÅƒÃ‘á¹„Å‡á¹†Å…á¹Šá¹ˆÆêžá´Ž"},{base:"NJ",chars:"ÇŠ"},{base:"Nj",chars:"Ç‹"},{base:"O",chars:"â“„ï¼¯Ã’Ã“Ã”á»’á»á»–á»”Ã•á¹ŒÈ¬á¹ŽÅŒá¹á¹’ÅŽÈ®È°Ã–Èªá»ŽÅÇ‘ÈŒÈŽÆ á»œá»šá» á»žá»¢á»Œá»˜ÇªÇ¬Ã˜Ç¾Æ†ÆŸêŠêŒ"},{base:"OE",chars:"Å’"},{base:"OI",chars:"Æ¢"},{base:"OO",chars:"êŽ"},{base:"OU",chars:"È¢"},{base:"P",chars:"â“…ï¼°á¹”á¹–Æ¤â±£êê’ê”"},{base:"Q",chars:"â“†ï¼±ê–ê˜ÉŠ"},{base:"R",chars:"â“‡ï¼²Å”á¹˜Å˜ÈÈ’á¹šá¹œÅ–á¹žÉŒâ±¤êšêž¦êž‚"},{base:"S",chars:"â“ˆï¼³áºžÅšá¹¤Åœá¹ Å á¹¦á¹¢á¹¨È˜Åžâ±¾êž¨êž„"},{base:"T",chars:"â“‰ï¼´á¹ªÅ¤á¹¬ÈšÅ¢á¹°á¹®Å¦Æ¬Æ®È¾êž†"},{base:"Th",chars:"Ãž"},{base:"TZ",chars:"êœ¨"},{base:"U",chars:"â“Šï¼µÃ™ÃšÃ›Å¨á¹¸Åªá¹ºÅ¬ÃœÇ›Ç—Ç•Ç™á»¦Å®Å°Ç“È”È–Æ¯á»ªá»¨á»®á»¬á»°á»¤á¹²Å²á¹¶á¹´É„"},{base:"V",chars:"â“‹ï¼¶á¹¼á¹¾Æ²êžÉ…"},{base:"VY",chars:"ê "},{base:"W",chars:"â“Œï¼·áº€áº‚Å´áº†áº„áºˆâ±²"},{base:"X",chars:"â“ï¼¸áºŠáºŒ"},{base:"Y",chars:"â“Žï¼¹á»²ÃÅ¶á»¸È²áºŽÅ¸á»¶á»´Æ³ÉŽá»¾"},{base:"Z",chars:"â“ï¼ºÅ¹áºÅ»Å½áº’áº”ÆµÈ¤â±¿â±«ê¢"},{base:"a",chars:"â“ï½áºšÃ Ã¡Ã¢áº§áº¥áº«áº©Ã£ÄÄƒáº±áº¯áºµáº³È§Ç¡Ã¤ÇŸáº£Ã¥Ç»ÇŽÈÈƒáº¡áº­áº·á¸Ä…â±¥ÉÉ‘"},{base:"aa",chars:"êœ³"},{base:"ae",chars:"Ã¦Ç½Ç£"},{base:"ao",chars:"êœµ"},{base:"au",chars:"êœ·"},{base:"av",chars:"êœ¹êœ»"},{base:"ay",chars:"êœ½"},{base:"b",chars:"â“‘ï½‚á¸ƒá¸…á¸‡Æ€ÆƒÉ“Æ‚"},{base:"c",chars:"ï½ƒâ“’Ä‡Ä‰Ä‹ÄÃ§á¸‰ÆˆÈ¼êœ¿â†„"},{base:"d",chars:"â““ï½„á¸‹Äá¸á¸‘á¸“á¸Ä‘ÆŒÉ–É—Æ‹á§Ôêžª"},{base:"dh",chars:"Ã°"},{base:"dz",chars:"Ç³Ç†"},{base:"e",chars:"â“”ï½…Ã¨Ã©Ãªá»áº¿á»…á»ƒáº½Ä“á¸•á¸—Ä•Ä—Ã«áº»Ä›È…È‡áº¹á»‡È©á¸Ä™á¸™á¸›É‡Ç"},{base:"f",chars:"â“•ï½†á¸ŸÆ’"},{base:"ff",chars:"ï¬€"},{base:"fi",chars:"ï¬"},{base:"fl",chars:"ï¬‚"},{base:"ffi",chars:"ï¬ƒ"},{base:"ffl",chars:"ï¬„"},{base:"g",chars:"â“–ï½‡ÇµÄá¸¡ÄŸÄ¡Ç§Ä£Ç¥É êž¡ê¿áµ¹"},{base:"h",chars:"â“—ï½ˆÄ¥á¸£á¸§ÈŸá¸¥á¸©á¸«áº–Ä§â±¨â±¶É¥"},{base:"hv",chars:"Æ•"},{base:"i",chars:"â“˜ï½‰Ã¬Ã­Ã®Ä©Ä«Ä­Ã¯á¸¯á»‰ÇÈ‰È‹á»‹Ä¯á¸­É¨Ä±"},{base:"j",chars:"â“™ï½ŠÄµÇ°É‰"},{base:"k",chars:"â“šï½‹á¸±Ç©á¸³Ä·á¸µÆ™â±ªêêƒê…êž£"},{base:"l",chars:"â“›ï½ŒÅ€ÄºÄ¾á¸·á¸¹Ä¼á¸½á¸»Å¿Å‚ÆšÉ«â±¡ê‰êžê‡É­"},{base:"lj",chars:"Ç‰"},{base:"m",chars:"â“œï½á¸¿á¹á¹ƒÉ±É¯"},{base:"n",chars:"â“ï½ŽÇ¹Å„Ã±á¹…Åˆá¹‡Å†á¹‹á¹‰ÆžÉ²Å‰êž‘êž¥Ð»Ô‰"},{base:"nj",chars:"ÇŒ"},{base:"o",chars:"â“žï½Ã²Ã³Ã´á»“á»‘á»—á»•Ãµá¹È­á¹Åá¹‘á¹“ÅÈ¯È±Ã¶È«á»Å‘Ç’ÈÈÆ¡á»á»›á»¡á»Ÿá»£á»á»™Ç«Ç­Ã¸Ç¿ê‹êÉµÉ”á´‘"},{base:"oe",chars:"Å“"},{base:"oi",chars:"Æ£"},{base:"oo",chars:"ê"},{base:"ou",chars:"È£"},{base:"p",chars:"â“Ÿï½á¹•á¹—Æ¥áµ½ê‘ê“ê•Ï"},{base:"q",chars:"â“ ï½‘É‹ê—ê™"},{base:"r",chars:"â“¡ï½’Å•á¹™Å™È‘È“á¹›á¹Å—á¹ŸÉÉ½ê›êž§êžƒ"},{base:"s",chars:"â“¢ï½“Å›á¹¥Åá¹¡Å¡á¹§á¹£á¹©È™ÅŸÈ¿êž©êž…áº›Ê‚"},{base:"ss",chars:"ÃŸ"},{base:"t",chars:"â“£ï½”á¹«áº—Å¥á¹­È›Å£á¹±á¹¯Å§Æ­Êˆâ±¦êž‡"},{base:"th",chars:"Ã¾"},{base:"tz",chars:"êœ©"},{base:"u",chars:"â“¤ï½•Ã¹ÃºÃ»Å©á¹¹Å«á¹»Å­Ã¼ÇœÇ˜Ç–Çšá»§Å¯Å±Ç”È•È—Æ°á»«á»©á»¯á»­á»±á»¥á¹³Å³á¹·á¹µÊ‰"},{base:"v",chars:"â“¥ï½–á¹½á¹¿Ê‹êŸÊŒ"},{base:"vy",chars:"ê¡"},{base:"w",chars:"â“¦ï½—áºáºƒÅµáº‡áº…áº˜áº‰â±³"},{base:"x",chars:"â“§ï½˜áº‹áº"},{base:"y",chars:"â“¨ï½™á»³Ã½Å·á»¹È³áºÃ¿á»·áº™á»µÆ´Éá»¿"},{base:"z",chars:"â“©ï½šÅºáº‘Å¼Å¾áº“áº•Æ¶È¥É€â±¬ê£"}],a={},i=0;i<n.length;i+=1)for(var r=n[i].chars,o=0;o<r.length;o+=1)a[r[o]]=n[i].base;t.replacementList=n,t.diacriticsMap=a},function(e){e.exports=JSON.parse('{"locale":"en","countries":{"AF":"Afghanistan","AL":"Albania","DZ":"Algeria","AS":"American Samoa","AD":"Andorra","AO":"Angola","AI":"Anguilla","AQ":"Antarctica","AG":"Antigua and Barbuda","AR":"Argentina","AM":"Armenia","AW":"Aruba","AU":"Australia","AT":"Austria","AZ":"Azerbaijan","BS":"Bahamas","BH":"Bahrain","BD":"Bangladesh","BB":"Barbados","BY":"Belarus","BE":"Belgium","BZ":"Belize","BJ":"Benin","BM":"Bermuda","BT":"Bhutan","BO":"Bolivia","BA":"Bosnia and Herzegovina","BW":"Botswana","BV":"Bouvet Island","BR":"Brazil","IO":"British Indian Ocean Territory","BN":"Brunei Darussalam","BG":"Bulgaria","BF":"Burkina Faso","BI":"Burundi","KH":"Cambodia","CM":"Cameroon","CA":"Canada","CV":"Cape Verde","KY":"Cayman Islands","CF":"Central African Republic","TD":"Chad","CL":"Chile","CN":"China","CX":"Christmas Island","CC":"Cocos (Keeling) Islands","CO":"Colombia","KM":"Comoros","CG":"Congo","CD":"Congo, the Democratic Republic of the","CK":"Cook Islands","CR":"Costa Rica","CI":"Cote D\'Ivoire","HR":"Croatia","CU":"Cuba","CY":"Cyprus","CZ":"Czech Republic","DK":"Denmark","DJ":"Djibouti","DM":"Dominica","DO":"Dominican Republic","EC":"Ecuador","EG":"Egypt","SV":"El Salvador","GQ":"Equatorial Guinea","ER":"Eritrea","EE":"Estonia","ET":"Ethiopia","FK":"Falkland Islands (Malvinas)","FO":"Faroe Islands","FJ":"Fiji","FI":"Finland","FR":"France","GF":"French Guiana","PF":"French Polynesia","TF":"French Southern Territories","GA":"Gabon","GM":"Gambia","GE":"Georgia","DE":"Germany","GH":"Ghana","GI":"Gibraltar","GR":"Greece","GL":"Greenland","GD":"Grenada","GP":"Guadeloupe","GU":"Guam","GT":"Guatemala","GN":"Guinea","GW":"Guinea-Bissau","GY":"Guyana","HT":"Haiti","HM":"Heard Island and Mcdonald Islands","VA":"Holy See (Vatican City State)","HN":"Honduras","HK":"Hong Kong","HU":"Hungary","IS":"Iceland","IN":"India","ID":"Indonesia","IR":"Iran, Islamic Republic of","IQ":"Iraq","IE":"Ireland","IL":"Israel","IT":"Italy","JM":"Jamaica","JP":"Japan","JO":"Jordan","KZ":"Kazakhstan","KE":"Kenya","KI":"Kiribati","KP":"North Korea","KR":"South Korea","KW":"Kuwait","KG":"Kyrgyzstan","LA":"Lao People\'s Democratic Republic","LV":"Latvia","LB":"Lebanon","LS":"Lesotho","LR":"Liberia","LY":"Libya","LI":"Liechtenstein","LT":"Lithuania","LU":"Luxembourg","MO":"Macao","MG":"Madagascar","MW":"Malawi","MY":"Malaysia","MV":"Maldives","ML":"Mali","MT":"Malta","MH":"Marshall Islands","MQ":"Martinique","MR":"Mauritania","MU":"Mauritius","YT":"Mayotte","MX":"Mexico","FM":"Micronesia, Federated States of","MD":"Moldova, Republic of","MC":"Monaco","MN":"Mongolia","MS":"Montserrat","MA":"Morocco","MZ":"Mozambique","MM":"Myanmar","NA":"Namibia","NR":"Nauru","NP":"Nepal","NL":"Netherlands","NC":"New Caledonia","NZ":"New Zealand","NI":"Nicaragua","NE":"Niger","NG":"Nigeria","NU":"Niue","NF":"Norfolk Island","MK":"North Macedonia, Republic of","MP":"Northern Mariana Islands","NO":"Norway","OM":"Oman","PK":"Pakistan","PW":"Palau","PS":"Palestinian Territory, Occupied","PA":"Panama","PG":"Papua New Guinea","PY":"Paraguay","PE":"Peru","PH":"Philippines","PN":"Pitcairn","PL":"Poland","PT":"Portugal","PR":"Puerto Rico","QA":"Qatar","RE":"Reunion","RO":"Romania","RU":"Russian Federation","RW":"Rwanda","SH":"Saint Helena","KN":"Saint Kitts and Nevis","LC":"Saint Lucia","PM":"Saint Pierre and Miquelon","VC":"Saint Vincent and the Grenadines","WS":"Samoa","SM":"San Marino","ST":"Sao Tome and Principe","SA":"Saudi Arabia","SN":"Senegal","SC":"Seychelles","SL":"Sierra Leone","SG":"Singapore","SK":"Slovakia","SI":"Slovenia","SB":"Solomon Islands","SO":"Somalia","ZA":"South Africa","GS":"South Georgia and the South Sandwich Islands","ES":"Spain","LK":"Sri Lanka","SD":"Sudan","SR":"Suriname","SJ":"Svalbard and Jan Mayen","SZ":"Swaziland","SE":"Sweden","CH":"Switzerland","SY":"Syrian Arab Republic","TW":"Taiwan","TJ":"Tajikistan","TZ":"Tanzania, United Republic of","TH":"Thailand","TL":"Timor-Leste","TG":"Togo","TK":"Tokelau","TO":"Tonga","TT":"Trinidad and Tobago","TN":"Tunisia","TR":"Turkey","TM":"Turkmenistan","TC":"Turks and Caicos Islands","TV":"Tuvalu","UG":"Uganda","UA":"Ukraine","AE":"United Arab Emirates","GB":"United Kingdom","US":"United States of America","UM":"United States Minor Outlying Islands","UY":"Uruguay","UZ":"Uzbekistan","VU":"Vanuatu","VE":"Venezuela","VN":"Viet Nam","VG":"Virgin Islands, British","VI":"Virgin Islands, U.S.","WF":"Wallis and Futuna","EH":"Western Sahara","YE":"Yemen","ZM":"Zambia","ZW":"Zimbabwe","AX":"Ã…land Islands","BQ":"Bonaire, Sint Eustatius and Saba","CW":"CuraÃ§ao","GG":"Guernsey","IM":"Isle of Man","JE":"Jersey","ME":"Montenegro","BL":"Saint BarthÃ©lemy","MF":"Saint Martin (French part)","RS":"Serbia","SX":"Sint Maarten (Dutch part)","SS":"South Sudan","XK":"Kosovo"}}')},function(e,t,n){"use strict";var a=n(964),i={"text/plain":"Text","text/html":"Url",default:"Text"};e.exports=function(e,t){var n,r,o,s,l,c,u=!1;t||(t={}),n=t.debug||!1;try{if(o=a(),s=document.createRange(),l=document.getSelection(),(c=document.createElement("span")).textContent=e,c.style.all="unset",c.style.position="fixed",c.style.top=0,c.style.clip="rect(0, 0, 0, 0)",c.style.whiteSpace="pre",c.style.webkitUserSelect="text",c.style.MozUserSelect="text",c.style.msUserSelect="text",c.style.userSelect="text",c.addEventListener("copy",(function(a){if(a.stopPropagation(),t.format)if(a.preventDefault(),void 0===a.clipboardData){n&&console.warn("unable to use e.clipboardData"),n&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var r=i[t.format]||i.default;window.clipboardData.setData(r,e)}else a.clipboardData.clearData(),a.clipboardData.setData(t.format,e);t.onCopy&&(a.preventDefault(),t.onCopy(a.clipboardData))})),document.body.appendChild(c),s.selectNodeContents(c),l.addRange(s),!document.execCommand("copy"))throw new Error("copy command was unsuccessful");u=!0}catch(a){n&&console.error("unable to copy using execCommand: ",a),n&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(t.format||"text",e),t.onCopy&&t.onCopy(window.clipboardData),u=!0}catch(a){n&&console.error("unable to copy using clipboardData: ",a),n&&console.error("falling back to prompt"),r=function(e){var t=(/mac os x/i.test(navigator.userAgent)?"âŒ˜":"Ctrl")+"+C";return e.replace(/#{\s*key\s*}/g,t)}("message"in t?t.message:"Copy to clipboard: #{key}, Enter"),window.prompt(r,e)}}finally{l&&("function"==typeof l.removeRange?l.removeRange(s):l.removeAllRanges()),c&&document.body.removeChild(c),o()}return u}},function(e,t){e.exports=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var t=document.activeElement,n=[],a=0;a<e.rangeCount;a++)n.push(e.getRangeAt(a));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||n.forEach((function(t){e.addRange(t)})),t&&t.focus()}}},function(e){e.exports=JSON.parse('["file.path","file.target_path","Target.process.command_line","Target.process.executable","Target.process.name","Target.process.parent.command_line","Target.process.parent.executable","Target.process.parent.name","Target.process.parent.working_directory","Target.process.working_directory","host.os.full","host.os.name","process.command_line","process.executable","process.name","process.parent.command_line","process.parent.executable","process.parent.name","process.parent.working_directory","process.working_directory"]')},function(e){e.exports=JSON.parse('["file.path.caseless","file.target_path.caseless","Target.process.command_line.caseless","Target.process.executable.caseless","Target.process.name.caseless","Target.process.parent.command_line.caseless","Target.process.parent.executable.caseless","Target.process.parent.name.caseless","Target.process.parent.working_directory.caseless","Target.process.working_directory.caseless","host.os.full.caseless","host.os.name.caseless","process.command_line.caseless","process.executable.caseless","process.name.caseless","process.parent.command_line.caseless","process.parent.executable.caseless","process.parent.name.caseless","process.parent.working_directory.caseless","process.working_directory.caseless","Target.process.Ext.code_signature.status","Target.process.Ext.code_signature.subject_name","Target.process.Ext.code_signature.trusted","Target.process.Ext.code_signature.valid","Target.process.parent.Ext.code_signature.status","Target.process.parent.Ext.code_signature.subject_name","Target.process.parent.Ext.code_signature.trusted","Target.process.parent.Ext.code_signature.valid","file.Ext.code_signature.status","file.Ext.code_signature.subject_name","file.Ext.code_signature.trusted","file.Ext.code_signature.valid","process.parent.Ext.code_signature.status","process.parent.Ext.code_signature.subject_name","process.parent.Ext.code_signature.trusted","process.parent.Ext.code_signature.valid"]')},function(e){e.exports=JSON.parse('["Endpoint.policy.applied.id","Target.process.Ext.services","Target.process.Ext.user","Target.process.executable","Target.process.hash.md5","Target.process.hash.sha1","Target.process.hash.sha256","Target.process.hash.sha512","Target.process.name","Target.process.parent.hash.md5","Target.process.parent.hash.sha1","Target.process.parent.hash.sha256","Target.process.parent.hash.sha512","Target.process.parent.pgid","Target.process.pe.company","Target.process.pe.description","Target.process.pe.file_version","Target.process.pe.original_file_name","Target.process.pe.product","Target.process.pgid","Target.process.Ext.memory_region.allocation_type","Target.process.thread.Ext.start_address_bytes_disasm_hash","Target.process.thread.Ext.start_address_allocation_offset","Target.process.Ext.memory_region.allocation_size","Target.process.Ext.memory_region.region_size","Target.process.Ext.memory_region.region_protection","Target.process.Ext.memory_region.memory_pe.imphash","Target.process.thread.Ext.start_address_bytes","agent.id","agent.type","agent.version","elastic.agent.id","event.action","event.category","event.code","event.hash","event.kind","event.module","event.outcome","event.provider","event.type","file.attributes","file.device","file.directory","file.drive_letter","file.extension","file.gid","file.group","file.hash.md5","file.hash.sha1","file.hash.sha256","file.hash.sha512","file.inode","file.mime_type","file.mode","file.name","file.owner","file.path","file.pe.company","file.pe.description","file.pe.file_version","file.pe.original_file_name","file.pe.product","file.size","file.type","file.uid","group.Ext.real.id","group.domain","group.id","host.architecture","host.domain","host.id","host.os.Ext.variant","host.os.family","host.os.kernel","host.os.platform","host.os.version","host.type","process.command_line","process.code_signature.subject_name","process.Ext.services","process.Ext.user","process.Ext.code_signature","process.Ext.token.integrity_level_name","process.Ext.memory_region.malware_signature.all_names","process.executable","process.hash.md5","process.hash.sha1","process.hash.sha256","process.hash.sha512","process.name","process.parent.executable","process.parent.hash.md5","process.parent.hash.sha1","process.parent.hash.sha256","process.parent.hash.sha512","process.parent.pgid","process.pe.company","process.pe.description","process.pe.file_version","process.pe.original_file_name","process.pe.product","process.pgid","rule.uuid","rule.id","source.ip","source.port","destination.ip","destination.port","registry.path","registry.value","registry.data.strings","user.domain","user.email","user.hash","user.id","Ransomware.feature","Ransomware.files.data","Ransomware.files.entropy","Ransomware.files.extension","Ransomware.files.operation","Ransomware.files.path","Ransomware.child_processes.files.data","Ransomware.child_processes.files.entropy","Ransomware.child_processes.files.extension","Ransomware.child_processes.files.operation","Ransomware.child_processes.files.path","Memory_protection.feature","Memory_protection.self_injection","dll.path","dll.code_signature.subject_name","dll.pe.original_file_name","dns.question.name","dns.question.type"]')},function(e,t,n){e.exports=n.p+"94cccf20036d014924e63d4d595e88e1.svg"},function(e,t,n){const a=n(235);e.exports={re:a.re,src:a.src,tokens:a.t,SEMVER_SPEC_VERSION:n(308).SEMVER_SPEC_VERSION,SemVer:n(125),compareIdentifiers:n(391).compareIdentifiers,rcompareIdentifiers:n(391).rcompareIdentifiers,parse:n(262),valid:n(970),clean:n(971),inc:n(972),diff:n(973),major:n(974),minor:n(975),patch:n(976),prerelease:n(977),compare:n(152),rcompare:n(978),compareLoose:n(979),compareBuild:n(483),sort:n(980),rsort:n(981),gt:n(362),lt:n(484),eq:n(482),neq:n(659),gte:n(363),lte:n(321),cmp:n(660),coerce:n(877),Comparator:n(364),Range:n(163),satisfies:n(365),toComparators:n(985),maxSatisfying:n(986),minSatisfying:n(987),minVersion:n(988),validRange:n(989),outside:n(485),gtr:n(990),ltr:n(991),intersects:n(992),simplifyRange:n(993),subset:n(994)}},function(e,t,n){const a=n(262);e.exports=(e,t)=>{const n=a(e,t);return n?n.version:null}},function(e,t,n){const a=n(262);e.exports=(e,t)=>{const n=a(e.trim().replace(/^[=v]+/,""),t);return n?n.version:null}},function(e,t,n){const a=n(125);e.exports=(e,t,n,i)=>{"string"==typeof n&&(i=n,n=void 0);try{return new a(e instanceof a?e.version:e,n).inc(t,i).version}catch(e){return null}}},function(e,t,n){const a=n(262),i=n(482);e.exports=(e,t)=>{if(i(e,t))return null;{const n=a(e),i=a(t),r=n.prerelease.length||i.prerelease.length,o=r?"pre":"",s=r?"prerelease":"";for(const e in n)if(("major"===e||"minor"===e||"patch"===e)&&n[e]!==i[e])return o+e;return s}}},function(e,t,n){const a=n(125);e.exports=(e,t)=>new a(e,t).major},function(e,t,n){const a=n(125);e.exports=(e,t)=>new a(e,t).minor},function(e,t,n){const a=n(125);e.exports=(e,t)=>new a(e,t).patch},function(e,t,n){const a=n(262);e.exports=(e,t)=>{const n=a(e,t);return n&&n.prerelease.length?n.prerelease:null}},function(e,t,n){const a=n(152);e.exports=(e,t,n)=>a(t,e,n)},function(e,t,n){const a=n(152);e.exports=(e,t)=>a(e,t,!0)},function(e,t,n){const a=n(483);e.exports=(e,t)=>e.sort(((e,n)=>a(e,n,t)))},function(e,t,n){const a=n(483);e.exports=(e,t)=>e.sort(((e,n)=>a(n,e,t)))},function(e,t,n){"use strict";const a=n(983),i=Symbol("max"),r=Symbol("length"),o=Symbol("lengthCalculator"),s=Symbol("allowStale"),l=Symbol("maxAge"),c=Symbol("dispose"),u=Symbol("noDisposeOnSet"),d=Symbol("lruList"),p=Symbol("cache"),m=Symbol("updateAgeOnGet"),g=()=>1,f=(e,t,n)=>{const a=e[p].get(t);if(a){const t=a.value;if(b(e,t)){if(h(e,a),!e[s])return}else n&&(e[m]&&(a.value.now=Date.now()),e[d].unshiftNode(a));return t.value}},b=(e,t)=>{if(!t||!t.maxAge&&!e[l])return!1;const n=Date.now()-t.now;return t.maxAge?n>t.maxAge:e[l]&&n>e[l]},y=e=>{if(e[r]>e[i])for(let t=e[d].tail;e[r]>e[i]&&null!==t;){const n=t.prev;h(e,t),t=n}},h=(e,t)=>{if(t){const n=t.value;e[c]&&e[c](n.key,n.value),e[r]-=n.length,e[p].delete(n.key),e[d].removeNode(t)}};class Entry{constructor(e,t,n,a,i){this.key=e,this.value=t,this.length=n,this.now=a,this.maxAge=i||0}}const v=(e,t,n,a)=>{let i=n.value;b(e,i)&&(h(e,n),e[s]||(i=void 0)),i&&t.call(a,i.value,i.key,e)};e.exports=class LRUCache{constructor(e){if("number"==typeof e&&(e={max:e}),e||(e={}),e.max&&("number"!=typeof e.max||e.max<0))throw new TypeError("max must be a non-negative number");this[i]=e.max||1/0;const t=e.length||g;if(this[o]="function"!=typeof t?g:t,this[s]=e.stale||!1,e.maxAge&&"number"!=typeof e.maxAge)throw new TypeError("maxAge must be a number");this[l]=e.maxAge||0,this[c]=e.dispose,this[u]=e.noDisposeOnSet||!1,this[m]=e.updateAgeOnGet||!1,this.reset()}set max(e){if("number"!=typeof e||e<0)throw new TypeError("max must be a non-negative number");this[i]=e||1/0,y(this)}get max(){return this[i]}set allowStale(e){this[s]=!!e}get allowStale(){return this[s]}set maxAge(e){if("number"!=typeof e)throw new TypeError("maxAge must be a non-negative number");this[l]=e,y(this)}get maxAge(){return this[l]}set lengthCalculator(e){"function"!=typeof e&&(e=g),e!==this[o]&&(this[o]=e,this[r]=0,this[d].forEach((e=>{e.length=this[o](e.value,e.key),this[r]+=e.length}))),y(this)}get lengthCalculator(){return this[o]}get length(){return this[r]}get itemCount(){return this[d].length}rforEach(e,t){t=t||this;for(let n=this[d].tail;null!==n;){const a=n.prev;v(this,e,n,t),n=a}}forEach(e,t){t=t||this;for(let n=this[d].head;null!==n;){const a=n.next;v(this,e,n,t),n=a}}keys(){return this[d].toArray().map((e=>e.key))}values(){return this[d].toArray().map((e=>e.value))}reset(){this[c]&&this[d]&&this[d].length&&this[d].forEach((e=>this[c](e.key,e.value))),this[p]=new Map,this[d]=new a,this[r]=0}dump(){return this[d].map((e=>!b(this,e)&&{k:e.key,v:e.value,e:e.now+(e.maxAge||0)})).toArray().filter((e=>e))}dumpLru(){return this[d]}set(e,t,n){if((n=n||this[l])&&"number"!=typeof n)throw new TypeError("maxAge must be a number");const a=n?Date.now():0,s=this[o](t,e);if(this[p].has(e)){if(s>this[i])return h(this,this[p].get(e)),!1;const o=this[p].get(e).value;return this[c]&&(this[u]||this[c](e,o.value)),o.now=a,o.maxAge=n,o.value=t,this[r]+=s-o.length,o.length=s,this.get(e),y(this),!0}const m=new Entry(e,t,s,a,n);return m.length>this[i]?(this[c]&&this[c](e,t),!1):(this[r]+=m.length,this[d].unshift(m),this[p].set(e,this[d].head),y(this),!0)}has(e){if(!this[p].has(e))return!1;const t=this[p].get(e).value;return!b(this,t)}get(e){return f(this,e,!0)}peek(e){return f(this,e,!1)}pop(){const e=this[d].tail;return e?(h(this,e),e.value):null}del(e){h(this,this[p].get(e))}load(e){this.reset();const t=Date.now();for(let n=e.length-1;n>=0;n--){const a=e[n],i=a.e||0;if(0===i)this.set(a.k,a.v);else{const e=i-t;e>0&&this.set(a.k,a.v,e)}}}prune(){this[p].forEach(((e,t)=>f(this,t,!1)))}}},function(e,t,n){"use strict";function a(e){var t=this;if(t instanceof a||(t=new a),t.tail=null,t.head=null,t.length=0,e&&"function"==typeof e.forEach)e.forEach((function(e){t.push(e)}));else if(arguments.length>0)for(var n=0,i=arguments.length;n<i;n++)t.push(arguments[n]);return t}function i(e,t,n){var a=t===e.head?new s(n,null,t,e):new s(n,t,t.next,e);return null===a.next&&(e.tail=a),null===a.prev&&(e.head=a),e.length++,a}function r(e,t){e.tail=new s(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function o(e,t){e.head=new s(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function s(e,t,n,a){if(!(this instanceof s))return new s(e,t,n,a);this.list=a,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}e.exports=a,a.Node=s,a.create=a,a.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,n=e.prev;return t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null,t},a.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},a.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},a.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)r(this,arguments[e]);return this.length},a.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)o(this,arguments[e]);return this.length},a.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},a.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},a.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,a=0;null!==n;a++)e.call(t,n.value,a,this),n=n.next},a.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,a=this.length-1;null!==n;a--)e.call(t,n.value,a,this),n=n.prev},a.prototype.get=function(e){for(var t=0,n=this.head;null!==n&&t<e;t++)n=n.next;if(t===e&&null!==n)return n.value},a.prototype.getReverse=function(e){for(var t=0,n=this.tail;null!==n&&t<e;t++)n=n.prev;if(t===e&&null!==n)return n.value},a.prototype.map=function(e,t){t=t||this;for(var n=new a,i=this.head;null!==i;)n.push(e.call(t,i.value,this)),i=i.next;return n},a.prototype.mapReverse=function(e,t){t=t||this;for(var n=new a,i=this.tail;null!==i;)n.push(e.call(t,i.value,this)),i=i.prev;return n},a.prototype.reduce=function(e,t){var n,a=this.head;if(arguments.length>1)n=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");a=this.head.next,n=this.head.value}for(var i=0;null!==a;i++)n=e(n,a.value,i),a=a.next;return n},a.prototype.reduceReverse=function(e,t){var n,a=this.tail;if(arguments.length>1)n=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");a=this.tail.prev,n=this.tail.value}for(var i=this.length-1;null!==a;i--)n=e(n,a.value,i),a=a.prev;return n},a.prototype.toArray=function(){for(var e=new Array(this.length),t=0,n=this.head;null!==n;t++)e[t]=n.value,n=n.next;return e},a.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,n=this.tail;null!==n;t++)e[t]=n.value,n=n.prev;return e},a.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var n=new a;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=0,r=this.head;null!==r&&i<e;i++)r=r.next;for(;null!==r&&i<t;i++,r=r.next)n.push(r.value);return n},a.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var n=new a;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=this.length,r=this.tail;null!==r&&i>t;i--)r=r.prev;for(;null!==r&&i>e;i--,r=r.prev)n.push(r.value);return n},a.prototype.splice=function(e,t,...n){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var a=0,r=this.head;null!==r&&a<e;a++)r=r.next;var o=[];for(a=0;r&&a<t;a++)o.push(r.value),r=this.removeNode(r);for(null===r&&(r=this.tail),r!==this.head&&r!==this.tail&&(r=r.prev),a=0;a<n.length;a++)r=i(this,r,n[a]);return o},a.prototype.reverse=function(){for(var e=this.head,t=this.tail,n=e;null!==n;n=n.prev){var a=n.prev;n.prev=n.next,n.next=a}return this.head=t,this.tail=e,this};try{n(984)(a)}catch(e){}},function(e,t,n){"use strict";e.exports=function(e){e.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}},function(e,t,n){const a=n(163);e.exports=(e,t)=>new a(e,t).set.map((e=>e.map((e=>e.value)).join(" ").trim().split(" ")))},function(e,t,n){const a=n(125),i=n(163);e.exports=(e,t,n)=>{let r=null,o=null,s=null;try{s=new i(t,n)}catch(e){return null}return e.forEach((e=>{s.test(e)&&(r&&-1!==o.compare(e)||(r=e,o=new a(r,n)))})),r}},function(e,t,n){const a=n(125),i=n(163);e.exports=(e,t,n)=>{let r=null,o=null,s=null;try{s=new i(t,n)}catch(e){return null}return e.forEach((e=>{s.test(e)&&(r&&1!==o.compare(e)||(r=e,o=new a(r,n)))})),r}},function(e,t,n){const a=n(125),i=n(163),r=n(362);e.exports=(e,t)=>{e=new i(e,t);let n=new a("0.0.0");if(e.test(n))return n;if(n=new a("0.0.0-0"),e.test(n))return n;n=null;for(let t=0;t<e.set.length;++t){const i=e.set[t];let o=null;i.forEach((e=>{const t=new a(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":o&&!r(t,o)||(o=t);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${e.operator}`)}})),!o||n&&!r(n,o)||(n=o)}return n&&e.test(n)?n:null}},function(e,t,n){const a=n(163);e.exports=(e,t)=>{try{return new a(e,t).range||"*"}catch(e){return null}}},function(e,t,n){const a=n(485);e.exports=(e,t,n)=>a(e,t,">",n)},function(e,t,n){const a=n(485);e.exports=(e,t,n)=>a(e,t,"<",n)},function(e,t,n){const a=n(163);e.exports=(e,t,n)=>(e=new a(e,n),t=new a(t,n),e.intersects(t))},function(e,t,n){const a=n(365),i=n(152);e.exports=(e,t,n)=>{const r=[];let o=null,s=null;const l=e.sort(((e,t)=>i(e,t,n)));for(const e of l)a(e,t,n)?(s=e,o||(o=e)):(s&&r.push([o,s]),s=null,o=null);o&&r.push([o,null]);const c=[];for(const[e,t]of r)e===t?c.push(e):t||e!==l[0]?t?e===l[0]?c.push(`<=${t}`):c.push(`${e} - ${t}`):c.push(`>=${e}`):c.push("*");const u=c.join(" || "),d="string"==typeof t.raw?t.raw:String(t);return u.length<d.length?u:t}},function(e,t,n){const a=n(163),i=n(364),{ANY:r}=i,o=n(365),s=n(152),l=(e,t,n)=>{if(e===t)return!0;if(1===e.length&&e[0].semver===r){if(1===t.length&&t[0].semver===r)return!0;e=n.includePrerelease?[new i(">=0.0.0-0")]:[new i(">=0.0.0")]}if(1===t.length&&t[0].semver===r){if(n.includePrerelease)return!0;t=[new i(">=0.0.0")]}const a=new Set;let l,d,p,m,g,f,b;for(const t of e)">"===t.operator||">="===t.operator?l=c(l,t,n):"<"===t.operator||"<="===t.operator?d=u(d,t,n):a.add(t.semver);if(a.size>1)return null;if(l&&d){if(p=s(l.semver,d.semver,n),p>0)return null;if(0===p&&(">="!==l.operator||"<="!==d.operator))return null}for(const e of a){if(l&&!o(e,String(l),n))return null;if(d&&!o(e,String(d),n))return null;for(const a of t)if(!o(e,String(a),n))return!1;return!0}let y=!(!d||n.includePrerelease||!d.semver.prerelease.length)&&d.semver,h=!(!l||n.includePrerelease||!l.semver.prerelease.length)&&l.semver;y&&1===y.prerelease.length&&"<"===d.operator&&0===y.prerelease[0]&&(y=!1);for(const e of t){if(b=b||">"===e.operator||">="===e.operator,f=f||"<"===e.operator||"<="===e.operator,l)if(h&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===h.major&&e.semver.minor===h.minor&&e.semver.patch===h.patch&&(h=!1),">"===e.operator||">="===e.operator){if(m=c(l,e,n),m===e&&m!==l)return!1}else if(">="===l.operator&&!o(l.semver,String(e),n))return!1;if(d)if(y&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===y.major&&e.semver.minor===y.minor&&e.semver.patch===y.patch&&(y=!1),"<"===e.operator||"<="===e.operator){if(g=u(d,e,n),g===e&&g!==d)return!1}else if("<="===d.operator&&!o(d.semver,String(e),n))return!1;if(!e.operator&&(d||l)&&0!==p)return!1}return!(l&&f&&!d&&0!==p||d&&b&&!l&&0!==p||h||y)},c=(e,t,n)=>{if(!e)return t;const a=s(e.semver,t.semver,n);return a>0?e:a<0||">"===t.operator&&">="===e.operator?t:e},u=(e,t,n)=>{if(!e)return t;const a=s(e.semver,t.semver,n);return a<0?e:a>0||"<"===t.operator&&"<="===e.operator?t:e};e.exports=(e,t,n={})=>{if(e===t)return!0;e=new a(e,n),t=new a(t,n);let i=!1;e:for(const a of e.set){for(const e of t.set){const t=l(a,e,n);if(i=i||null!==t,t)continue e}if(i)return!1}return!0}},function(e,t,n){e.exports=n(27)(1813)},function(e,t,n){e.exports=n(27)(3453)},function(e,t,n){e.exports=n(27)(997)},function(e,t,n){"use strict";e.exports=function(e){var t=this;this.Parser=function(n){return a(n,Object.assign({},t.data("settings"),e,{extensions:t.data("micromarkExtensions")||[],mdastExtensions:t.data("fromMarkdownExtensions")||[]}))}};var a=n(999)},function(e,t,n){"use strict";e.exports=n(1e3)},function(e,t,n){"use strict";e.exports=function(e,t,n){return"string"!=typeof t&&(n=t,t=void 0),function(e){var t=e||{},n=function(e,t){for(var n=-1;++n<t.length;)m(e,t[n]);return e}({canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:b(M),autolinkProtocol:k,autolinkEmail:k,atxHeading:b(I),blockQuote:b((function(){return{type:"blockquote",children:[]}})),characterEscape:k,characterReference:k,codeFenced:b(O),codeFencedFenceInfo:y,codeFencedFenceMeta:y,codeIndented:b(O,y),codeText:b((function(){return{type:"inlineCode",value:""}}),y),codeTextData:k,data:k,codeFlowValue:k,definition:b((function(){return{type:"definition",identifier:"",label:null,title:null,url:""}})),definitionDestinationString:y,definitionLabelString:y,definitionTitleString:y,emphasis:b((function(){return{type:"emphasis",children:[]}})),hardBreakEscape:b(T),hardBreakTrailing:b(T),htmlFlow:b(C,y),htmlFlowData:k,htmlText:b(C,y),htmlTextData:k,image:b((function(){return{type:"image",title:null,url:"",alt:null}})),label:y,link:b(M),listItem:b((function(e){return{type:"listItem",spread:e._spread,checked:null,children:[]}})),listItemValue:function(e){g("expectingFirstListItemValue")&&(this.stack[this.stack.length-2].start=parseInt(this.sliceSerialize(e),10),u("expectingFirstListItemValue"))},listOrdered:b(N,(function(){u("expectingFirstListItemValue",!0)})),listUnordered:b(N),paragraph:b((function(){return{type:"paragraph",children:[]}})),reference:function(){u("referenceType","collapsed")},referenceString:y,resourceDestinationString:y,resourceTitleString:y,setextHeading:b(I),strong:b((function(){return{type:"strong",children:[]}})),thematicBreak:b((function(){return{type:"thematicBreak"}}))},exit:{atxHeading:v(),atxHeadingSequence:function(e){this.stack[this.stack.length-1].depth||(this.stack[this.stack.length-1].depth=this.sliceSerialize(e).length)},autolink:v(),autolinkEmail:function(e){S.call(this,e),this.stack[this.stack.length-1].url="mailto:"+this.sliceSerialize(e)},autolinkProtocol:function(e){S.call(this,e),this.stack[this.stack.length-1].url=this.sliceSerialize(e)},blockQuote:v(),characterEscapeValue:S,characterReferenceMarkerHexadecimal:j,characterReferenceMarkerNumeric:j,characterReferenceValue:function(e){var t,n,a=this.sliceSerialize(e),i=g("characterReferenceType");i?(t=s(a,"characterReferenceMarkerNumeric"===i?10:16),u("characterReferenceType")):t=d(a),(n=this.stack.pop()).value+=t,n.position.end=f(e.end)},codeFenced:v((function(){var e=this.resume();this.stack[this.stack.length-1].value=e.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),u("flowCodeInside")})),codeFencedFence:function(){g("flowCodeInside")||(this.buffer(),u("flowCodeInside",!0))},codeFencedFenceInfo:function(){var e=this.resume();this.stack[this.stack.length-1].lang=e},codeFencedFenceMeta:function(){var e=this.resume();this.stack[this.stack.length-1].meta=e},codeFlowValue:S,codeIndented:v((function(){var e=this.resume();this.stack[this.stack.length-1].value=e})),codeText:v((function(){var e=this.resume();this.stack[this.stack.length-1].value=e})),codeTextData:S,data:S,definition:v(),definitionDestinationString:function(){var e=this.resume();this.stack[this.stack.length-1].url=e},definitionLabelString:function(e){var t=this.resume();this.stack[this.stack.length-1].label=t,this.stack[this.stack.length-1].identifier=o(this.sliceSerialize(e)).toLowerCase()},definitionTitleString:function(){var e=this.resume();this.stack[this.stack.length-1].title=e},emphasis:v(),hardBreakEscape:v(w),hardBreakTrailing:v(w),htmlFlow:v((function(){var e=this.resume();this.stack[this.stack.length-1].value=e})),htmlFlowData:S,htmlText:v((function(){var e=this.resume();this.stack[this.stack.length-1].value=e})),htmlTextData:S,image:v((function(){var e=this.stack[this.stack.length-1];g("inReference")?(e.type+="Reference",e.referenceType=g("referenceType")||"shortcut",delete e.url,delete e.title):(delete e.identifier,delete e.label,delete e.referenceType),u("referenceType")})),label:function(){var e=this.stack[this.stack.length-1],t=this.resume();this.stack[this.stack.length-1].label=t,u("inReference",!0),"link"===this.stack[this.stack.length-1].type?this.stack[this.stack.length-1].children=e.children:this.stack[this.stack.length-1].alt=t},labelText:function(e){this.stack[this.stack.length-2].identifier=o(this.sliceSerialize(e)).toLowerCase()},lineEnding:function(e){var t=this.stack[this.stack.length-1];if(g("atHardBreak"))return t.children[t.children.length-1].position.end=f(e.end),void u("atHardBreak");!g("setextHeadingSlurpLineEnding")&&n.canContainEols.indexOf(t.type)>-1&&(k.call(this,e),S.call(this,e))},link:v((function(){var e=this.stack[this.stack.length-1];g("inReference")?(e.type+="Reference",e.referenceType=g("referenceType")||"shortcut",delete e.url,delete e.title):(delete e.identifier,delete e.label,delete e.referenceType),u("referenceType")})),listItem:v(),listOrdered:v(),listUnordered:v(),paragraph:v(),referenceString:function(e){var t=this.resume();this.stack[this.stack.length-1].label=t,this.stack[this.stack.length-1].identifier=o(this.sliceSerialize(e)).toLowerCase(),u("referenceType","full")},resourceDestinationString:function(){var e=this.resume();this.stack[this.stack.length-1].url=e},resourceTitleString:function(){var e=this.resume();this.stack[this.stack.length-1].title=e},resource:function(){u("inReference")},setextHeading:v((function(){u("setextHeadingSlurpLineEnding")})),setextHeadingLineSequence:function(e){this.stack[this.stack.length-1].depth=61===this.sliceSerialize(e).charCodeAt(0)?1:2},setextHeadingText:function(){u("setextHeadingSlurpLineEnding",!0)},strong:v(),thematicBreak:v()}},t.mdastExtensions||[]),l={};return function(e){for(var t,a=[{type:"root",children:[]}],o=[],s=[],l=-1,d={stack:a,tokenStack:o,config:n,enter:h,exit:E,buffer:y,resume:x,setData:u,getData:g};++l<e.length;)"listOrdered"!==e[l][1].type&&"listUnordered"!==e[l][1].type||("enter"===e[l][0]?s.push(l):l=c(e,s.pop(l),l));for(l=-1;++l<e.length;)t=n[e[l][0]],r.call(t,e[l][1].type)&&t[e[l][1].type].call(i({sliceSerialize:e[l][2].sliceSerialize},d),e[l][1]);if(o.length)throw new Error("Cannot close document, a token (`"+o[o.length-1].type+"`, "+p({start:o[o.length-1].start,end:o[o.length-1].end})+") is still open");return a[0].position={start:f(e.length?e[0][1].start:{line:1,column:1,offset:0}),end:f(e.length?e[e.length-2][1].end:{line:1,column:1,offset:0})},a[0]};function c(e,t,n){for(var a,i,r,o,s,l,c,u=t-1,d=-1,p=!1;++u<=n;)if("listUnordered"===(s=e[u])[1].type||"listOrdered"===s[1].type||"blockQuote"===s[1].type?("enter"===s[0]?d++:d--,c=void 0):"lineEndingBlank"===s[1].type?"enter"===s[0]&&(!a||c||d||l||(l=u),c=void 0):"linePrefix"===s[1].type||"listItemValue"===s[1].type||"listItemMarker"===s[1].type||"listItemPrefix"===s[1].type||"listItemPrefixWhitespace"===s[1].type||(c=void 0),!d&&"enter"===s[0]&&"listItemPrefix"===s[1].type||-1===d&&"exit"===s[0]&&("listUnordered"===s[1].type||"listOrdered"===s[1].type)){if(a){for(i=u,r=void 0;i--;)if("lineEnding"===(o=e[i])[1].type||"lineEndingBlank"===o[1].type){if("exit"===o[0])continue;r&&(e[r][1].type="lineEndingBlank",p=!0),o[1].type="lineEnding",r=i}else if("linePrefix"!==o[1].type&&"blockQuotePrefix"!==o[1].type&&"blockQuotePrefixWhitespace"!==o[1].type&&"blockQuoteMarker"!==o[1].type&&"listItemIndent"!==o[1].type)break;l&&(!r||l<r)&&(a._spread=!0),a.end=f(r?e[r][1].start:s[1].end),e.splice(r||u,0,["exit",a,s[2]]),u++,n++}"listItemPrefix"===s[1].type&&(a={type:"listItem",_spread:!1,start:f(s[1].start)},e.splice(u,0,["enter",a,s[2]]),u++,n++,l=void 0,c=!0)}return e[t][1]._spread=p,n}function u(e,t){l[e]=t}function g(e){return l[e]}function f(e){return{line:e.line,column:e.column,offset:e.offset}}function b(e,t){return function(n){h.call(this,e(n),n),t&&t.call(this,n)}}function y(){this.stack.push({type:"fragment",children:[]})}function h(e,t){return this.stack[this.stack.length-1].children.push(e),this.stack.push(e),this.tokenStack.push(t),e.position={start:f(t.start)},e}function v(e){return function(t){e&&e.call(this,t),E.call(this,t)}}function E(e){var t=this.stack.pop(),n=this.tokenStack.pop();if(!n)throw new Error("Cannot close `"+e.type+"` ("+p({start:e.start,end:e.end})+"): itâ€™s not open");if(n.type!==e.type)throw new Error("Cannot close `"+e.type+"` ("+p({start:e.start,end:e.end})+"): a different token (`"+n.type+"`, "+p({start:n.start,end:n.end})+") is open");return t.position.end=f(e.end),t}function x(){return a(this.stack.pop())}function k(e){var t=this.stack[this.stack.length-1].children,n=t[t.length-1];n&&"text"===n.type||((n={type:"text",value:""}).position={start:f(e.start)},this.stack[this.stack.length-1].children.push(n)),this.stack.push(n)}function S(e){var t=this.stack.pop();t.value+=this.sliceSerialize(e),t.position.end=f(e.end)}function w(){u("atHardBreak",!0)}function j(e){u("characterReferenceType",e.type)}function O(){return{type:"code",lang:null,meta:null,value:""}}function I(){return{type:"heading",depth:void 0,children:[]}}function T(){return{type:"break"}}function C(){return{type:"html",value:""}}function M(){return{type:"link",title:null,url:"",children:[]}}function N(e){return{type:"list",ordered:"listOrdered"===e.type,start:null,spread:e._spread,children:[]}}}(n)(u(l(n).document().write(c()(e,t,!0))))};var a=n(1001),i=n(309),r=n(663),o=n(486),s=n(1002),l=n(1003),c=n(1042),u=n(1043),d=n(668),p=n(1044);function m(e,t){var n,a;for(n in t)a=r.call(e,n)?e[n]:e[n]={},"canContainEols"===n?e[n]=[].concat(a,t[n]):Object.assign(a,t[n])}},function(e,t,n){"use strict";function a(e){return e&&(e.value||e.alt||e.title||"children"in e&&i(e.children)||"length"in e&&i(e))||""}function i(e){for(var t=[],n=-1;++n<e.length;)t[n]=a(e[n]);return t.join("")}e.exports=a},function(e,t,n){"use strict";var a=n(367);e.exports=function(e,t){var n=parseInt(e,t);return n<9||11===n||n>13&&n<32||n>126&&n<160||n>55295&&n<57344||n>64975&&n<65008||65535==(65535&n)||65534==(65535&n)||n>1114111?"ï¿½":a(n)}},function(e,t,n){"use strict";var a=n(1004),i=n(1005),r=n(1006),o=n(666),s=n(1009),l=n(1010),c=n(487),u=n(1013);e.exports=function(e){var t={defined:[],constructs:s([u].concat(c((e||{}).extensions))),content:n(a),document:n(i),flow:n(r),string:n(o.string),text:n(o.text)};return t;function n(e){return function(n){return l(t,e,n)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(115),i=n(122);t.tokenize=function(e){var t,n=e.attempt(this.parser.constructs.contentInitial,(function(t){if(null!==t)return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),i(e,n,"linePrefix");e.consume(t)}),(function(t){return e.enter("paragraph"),r(t)}));return n;function r(n){var a=e.enter("chunkText",{contentType:"text",previous:t});return t&&(t.next=a),t=a,o(n)}function o(t){return null===t?(e.exit("chunkText"),e.exit("paragraph"),void e.consume(t)):a(t)?(e.consume(t),e.exit("chunkText"),r):(e.consume(t),o)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(115),i=n(122),r=n(368),o={tokenize:function(e,t,n){return i(e,e.attempt(this.parser.constructs.document,t,n),"linePrefix",this.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)}},s={tokenize:function(e,t,n){return i(e,e.lazy(this.parser.constructs.flow,t,n),"linePrefix",this.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)}};t.tokenize=function(e){var t,n,i,l=this,c=[],u=0,d={tokenize:function(e,a){var i=0;return t={},u;function u(a){return i<c.length?(l.containerState=c[i][1],e.attempt(c[i][0].continuation,d,p)(a)):n.currentConstruct&&n.currentConstruct.concrete?(t.flowContinue=!0,f(a)):(l.interrupt=n.currentConstruct&&n.currentConstruct.interruptible,l.containerState={},e.attempt(o,g,f)(a))}function d(e){return i++,l.containerState._closeFlow?g(e):u(e)}function p(t){return n.currentConstruct&&n.currentConstruct.lazy?(l.containerState={},e.attempt(o,g,e.attempt(s,g,e.check(r,g,m)))(t)):g(t)}function m(e){return i=c.length,t.lazy=!0,t.flowContinue=!0,f(e)}function g(e){return t.flowEnd=!0,f(e)}function f(e){return t.continued=i,l.interrupt=l.containerState=void 0,a(e)}},partial:!0};return p;function p(t){return u<c.length?(l.containerState=c[u][1],e.attempt(c[u][0].continuation,m,g)(t)):g(t)}function m(e){return u++,p(e)}function g(a){return t&&t.flowContinue?b(a):(l.interrupt=n&&n.currentConstruct&&n.currentConstruct.interruptible,l.containerState={},e.attempt(o,f,b)(a))}function f(e){return c.push([l.currentConstruct,l.containerState]),l.containerState=void 0,g(e)}function b(t){return null===t?(E(0,!0),void e.consume(t)):(n=n||l.parser.flow(l.now()),e.enter("chunkFlow",{contentType:"flow",previous:i,_tokenizer:n}),y(t))}function y(t){return null===t?(v(e.exit("chunkFlow")),b(t)):a(t)?(e.consume(t),v(e.exit("chunkFlow")),e.check(d,h)):(e.consume(t),y)}function h(e){return E(t.continued,t&&t.flowEnd),u=0,p(e)}function v(e){i&&(i.next=e),i=e,n.lazy=t&&t.lazy,n.defineSkip(e.start),n.write(l.sliceStream(e))}function E(t,a){var r=c.length;for(n&&a&&(n.write([null]),i=n=void 0);r-- >t;)l.containerState=c[r][1],c[r][0].exit.call(l,e);c.length=t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1007),i=n(122),r=n(368);t.tokenize=function(e){var t=this,n=e.attempt(r,(function(a){if(null!==a)return e.enter("lineEndingBlank"),e.consume(a),e.exit("lineEndingBlank"),t.currentConstruct=void 0,n;e.consume(a)}),e.attempt(this.parser.constructs.flowInitial,o,i(e,e.attempt(this.parser.constructs.flow,o,e.attempt(a,o)),"linePrefix")));return n;function o(a){if(null!==a)return e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),t.currentConstruct=void 0,n;e.consume(a)}}},function(e,t,n){"use strict";var a=n(115),i=n(369),r=n(665),o=n(122),s={tokenize:function(e,t){var n;return function(t){return e.enter("content"),n=e.enter("chunkContent",{contentType:"content"}),i(t)};function i(t){return null===t?r(t):a(t)?e.check(l,o,r)(t):(e.consume(t),i)}function r(n){return e.exit("chunkContent"),e.exit("content"),t(n)}function o(t){return e.consume(t),e.exit("chunkContent"),n=n.next=e.enter("chunkContent",{contentType:"content",previous:n}),i}},resolve:function(e){return r(e),e},interruptible:!0,lazy:!0},l={tokenize:function(e,t,n){var r=this;return function(t){return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),o(e,s,"linePrefix")};function s(o){return null===o||a(o)?n(o):r.parser.constructs.disable.null.indexOf("codeIndented")>-1||i(r.events,"linePrefix")<4?e.interrupt(r.parser.constructs.flow,n,t)(o):t(o)}},partial:!0};e.exports=s},function(e,t,n){"use strict";var a=[].splice;e.exports=a},function(e,t,n){"use strict";var a=n(663),i=n(200),r=n(487);function o(e,t){var n,i,o,l;for(n in t)for(l in i=a.call(e,n)?e[n]:e[n]={},o=t[n])i[l]=s(r(o[l]),a.call(i,l)?i[l]:[])}function s(e,t){for(var n=-1,a=[];++n<e.length;)("after"===e[n].add?t:a).push(e[n]);return i(t,0,0,a),t}e.exports=function(e){for(var t={},n=-1;++n<e.length;)o(t,e[n]);return t}},function(e,t,n){"use strict";var a=n(309),i=n(115),r=n(488),o=n(200),s=n(487),l=n(489),c=n(1011),u=n(263),d=n(1012);e.exports=function(e,t,n){var p=n?u(n):{line:1,column:1,offset:0},m={},g=[],f=[],b=[],y={consume:function(e){i(e)?(p.line++,p.column=1,p.offset+=-3===e?2:1,O()):-1!==e&&(p.column++,p.offset++),p._bufferIndex<0?p._index++:(p._bufferIndex++,p._bufferIndex===f[p._index].length&&(p._bufferIndex=-1,p._index++)),h.previous=e},enter:function(e,t){var n=t||{};return n.type=e,n.start=x(),h.events.push(["enter",n,h]),b.push(n),n},exit:function(e){var t=b.pop();return t.end=x(),h.events.push(["exit",t,h]),t},attempt:w((function(e,t){j(e,t.from)})),check:w(S),interrupt:w(S,{interrupt:!0}),lazy:w(S,{lazy:!0})},h={previous:null,events:[],parser:e,sliceStream:E,sliceSerialize:function(e){return c(E(e))},now:x,defineSkip:function(e){m[e.line]=e.column,O()},write:function(e){return f=r(f,e),function(){for(var e,t;p._index<f.length;)if("string"==typeof(t=f[p._index]))for(e=p._index,p._bufferIndex<0&&(p._bufferIndex=0);p._index===e&&p._bufferIndex<t.length;)k(t.charCodeAt(p._bufferIndex));else k(t)}(),null!==f[f.length-1]?[]:(j(t,0),h.events=l(g,h.events,h),h.events)}},v=t.tokenize.call(h,y);return t.resolveAll&&g.push(t),p._index=0,p._bufferIndex=-1,h;function E(e){return d(f,e)}function x(){return u(p)}function k(e){v=v(e)}function S(e,t){t.restore()}function w(e,t){return function(n,i,r){var o,l,c,u;return n.tokenize||"length"in n?d(s(n)):function(e){return e in n||null in n?d(n.null?s(n[e]).concat(s(n.null)):n[e])(e):r(e)};function d(e){return o=e,m(e[l=0])}function m(e){return function(n){var i,r,o,s,l;return i=x(),r=h.previous,o=h.currentConstruct,s=h.events.length,l=Array.from(b),u={restore:function(){p=i,h.previous=r,h.currentConstruct=o,h.events.length=s,b=l,O()},from:s},c=e,e.partial||(h.currentConstruct=e),e.name&&h.parser.constructs.disable.null.indexOf(e.name)>-1?f():e.tokenize.call(t?a({},h,t):h,y,g,f)(n)}}function g(t){return e(c,u),i}function f(e){return u.restore(),++l<o.length?m(o[l]):r}}}function j(e,t){e.resolveAll&&g.indexOf(e)<0&&g.push(e),e.resolve&&o(h.events,t,h.events.length-t,e.resolve(h.events.slice(t),h)),e.resolveTo&&(h.events=e.resolveTo(h.events,h))}function O(){p.line in m&&p.column<2&&(p.column=m[p.line],p.offset+=m[p.line]-1)}}},function(e,t,n){"use strict";var a=n(367);e.exports=function(e){for(var t,n,i,r=-1,o=[];++r<e.length;){if("string"==typeof(t=e[r]))n=t;else if(-5===t)n="\r";else if(-4===t)n="\n";else if(-3===t)n="\r\n";else if(-2===t)n="\t";else if(-1===t){if(i)continue;n=" "}else n=a(t);i=-2===t,o.push(n)}return o.join("")}},function(e,t,n){"use strict";e.exports=function(e,t){var n,a=t.start._index,i=t.start._bufferIndex,r=t.end._index,o=t.end._bufferIndex;return a===r?n=[e[a].slice(i,o)]:(n=e.slice(a,r),i>-1&&(n[0]=n[0].slice(i)),o>0&&n.push(e[r].slice(0,o))),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(666),i=n(1014),r=n(1020),o=n(1022),s=n(1023),l=n(1025),c=n(1027),u=n(1028),d=n(1029),p=n(1030),m=n(1031),g=n(1032),f=n(1033),b=n(1036),y=n(491),h=n(1037),v=n(1038),E=n(1039),x=n(1040),k=n(1041),S=n(674),w={42:x,43:x,45:x,48:x,49:x,50:x,51:x,52:x,53:x,54:x,55:x,56:x,57:x,62:o},j={91:p},O={"-2":u,"-1":u,32:u},I={35:g,42:S,45:[k,S],60:f,61:k,95:S,96:c,126:c},T={38:l,92:s},C={"-5":E,"-4":E,"-3":E,33:h,38:l,42:i,60:[r,b],91:v,92:[m,s],93:y,95:i,96:d},M={null:[i,a.resolver]};t.contentInitial=j,t.disable={null:[]},t.document=w,t.flow=I,t.flowInitial=O,t.insideSpan=M,t.string=T,t.text=C},function(e,t,n){"use strict";var a=n(488),i=n(200),r=n(1015),o=n(1019),s=n(489),l=n(263),c={name:"attention",tokenize:function(e,t){var n,a=r(this.previous);return function(t){return e.enter("attentionSequence"),n=t,i(t)};function i(o){var s,l,c,u;return o===n?(e.consume(o),i):(s=e.exit("attentionSequence"),c=!(l=r(o))||2===l&&a,u=!a||2===a&&l,s._open=42===n?c:c&&(a||!u),s._close=42===n?u:u&&(l||!c),t(o))}},resolveAll:function(e,t){for(var n,r,c,u,d,p,m,g,f=-1;++f<e.length;)if("enter"===e[f][0]&&"attentionSequence"===e[f][1].type&&e[f][1]._close)for(n=f;n--;)if("exit"===e[n][0]&&"attentionSequence"===e[n][1].type&&e[n][1]._open&&t.sliceSerialize(e[n][1]).charCodeAt(0)===t.sliceSerialize(e[f][1]).charCodeAt(0)){if((e[n][1]._close||e[f][1]._open)&&(e[f][1].end.offset-e[f][1].start.offset)%3&&!((e[n][1].end.offset-e[n][1].start.offset+e[f][1].end.offset-e[f][1].start.offset)%3))continue;u={type:(p=e[n][1].end.offset-e[n][1].start.offset>1&&e[f][1].end.offset-e[f][1].start.offset>1?2:1)>1?"strongSequence":"emphasisSequence",start:o(l(e[n][1].end),-p),end:l(e[n][1].end)},d={type:p>1?"strongSequence":"emphasisSequence",start:l(e[f][1].start),end:o(l(e[f][1].start),p)},c={type:p>1?"strongText":"emphasisText",start:l(e[n][1].end),end:l(e[f][1].start)},r={type:p>1?"strong":"emphasis",start:l(u.start),end:l(d.end)},e[n][1].end=l(u.start),e[f][1].start=l(d.end),m=[],e[n][1].end.offset-e[n][1].start.offset&&(m=a(m,[["enter",e[n][1],t],["exit",e[n][1],t]])),m=a(m,[["enter",r,t],["enter",u,t],["exit",u,t],["enter",c,t]]),m=a(m,s(t.parser.constructs.insideSpan.null,e.slice(n+1,f),t)),m=a(m,[["exit",c,t],["enter",d,t],["exit",d,t],["exit",r,t]]),e[f][1].end.offset-e[f][1].start.offset?(g=2,m=a(m,[["enter",e[f][1],t],["exit",e[f][1],t]])):g=0,i(e,n-1,f-n+3,m),f=n+m.length-g-2;break}for(f=-1;++f<e.length;)"attentionSequence"===e[f][1].type&&(e[f][1].type="data");return e}};e.exports=c},function(e,t,n){"use strict";var a=n(201),i=n(1016),r=n(1018);e.exports=function(e){return null===e||a(e)||r(e)?1:i(e)?2:void 0}},function(e,t,n){"use strict";var a=n(1017),i=n(202)(a);e.exports=i},function(e,t,n){"use strict";e.exports=/[!-\/:-@\[-`\{-~\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]/},function(e,t,n){"use strict";var a=n(202)(/\s/);e.exports=a},function(e,t,n){"use strict";e.exports=function(e,t){return e.column+=t,e.offset+=t,e._bufferIndex+=t,e}},function(e,t,n){"use strict";var a=n(490),i=n(370),r=n(1021),o=n(667),s={name:"autolink",tokenize:function(e,t,n){var s=1;return function(t){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(t),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),l};function l(t){return a(t)?(e.consume(t),c):r(t)?p(t):n(t)}function c(e){return 43===e||45===e||46===e||i(e)?u(e):p(e)}function u(t){return 58===t?(e.consume(t),d):(43===t||45===t||46===t||i(t))&&s++<32?(e.consume(t),u):p(t)}function d(t){return 62===t?(e.exit("autolinkProtocol"),b(t)):32===t||60===t||o(t)?n(t):(e.consume(t),d)}function p(t){return 64===t?(e.consume(t),s=0,m):r(t)?(e.consume(t),p):n(t)}function m(e){return i(e)?g(e):n(e)}function g(t){return 46===t?(e.consume(t),s=0,m):62===t?(e.exit("autolinkProtocol").type="autolinkEmail",b(t)):f(t)}function f(t){return(45===t||i(t))&&s++<63?(e.consume(t),45===t?f:g):n(t)}function b(n){return e.enter("autolinkMarker"),e.consume(n),e.exit("autolinkMarker"),e.exit("autolink"),t}}};e.exports=s},function(e,t,n){"use strict";var a=n(202)(/[#-'*+\--9=?A-Z^-~]/);e.exports=a},function(e,t,n){"use strict";var a=n(189),i=n(122),r={name:"blockQuote",tokenize:function(e,t,n){var i=this;return function(t){return 62===t?(i.containerState.open||(e.enter("blockQuote",{_container:!0}),i.containerState.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(t),e.exit("blockQuoteMarker"),r):n(t)};function r(n){return a(n)?(e.enter("blockQuotePrefixWhitespace"),e.consume(n),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),t):(e.exit("blockQuotePrefix"),t(n))}},continuation:{tokenize:function(e,t,n){return i(e,e.attempt(r,t,n),"linePrefix",this.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)}},exit:function(e){e.exit("blockQuote")}};e.exports=r},function(e,t,n){"use strict";var a=n(1024),i={name:"characterEscape",tokenize:function(e,t,n){return function(t){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(t),e.exit("escapeMarker"),i};function i(i){return a(i)?(e.enter("characterEscapeValue"),e.consume(i),e.exit("characterEscapeValue"),e.exit("characterEscape"),t):n(i)}}};e.exports=i},function(e,t,n){"use strict";var a=n(202)(/[!-/:-@[-`{-~]/);e.exports=a},function(e,t,n){"use strict";var a=n(668),i=n(370),r=n(669),o=n(1026);function s(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var l=s(a),c={name:"characterReference",tokenize:function(e,t,n){var a,s,c=this,u=0;return function(t){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(t),e.exit("characterReferenceMarker"),d};function d(t){return 35===t?(e.enter("characterReferenceMarkerNumeric"),e.consume(t),e.exit("characterReferenceMarkerNumeric"),p):(e.enter("characterReferenceValue"),a=31,s=i,m(t))}function p(t){return 88===t||120===t?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(t),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),a=6,s=o,m):(e.enter("characterReferenceValue"),a=7,s=r,m(t))}function m(r){var o;return 59===r&&u?(o=e.exit("characterReferenceValue"),s!==i||l.default(c.sliceSerialize(o))?(e.enter("characterReferenceMarker"),e.consume(r),e.exit("characterReferenceMarker"),e.exit("characterReference"),t):n(r)):s(r)&&u++<a?(e.consume(r),m):n(r)}}};e.exports=c},function(e,t,n){"use strict";var a=n(202)(/[\dA-Fa-f]/);e.exports=a},function(e,t,n){"use strict";var a=n(115),i=n(201),r=n(369),o=n(122),s={name:"codeFenced",tokenize:function(e,t,n){var s,l=this,c={tokenize:function(e,t,n){var i=0;return o(e,(function(t){return e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),r(t)}),"linePrefix",this.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4);function r(t){return t===s?(e.consume(t),i++,r):i<d?n(t):(e.exit("codeFencedFenceSequence"),o(e,l,"whitespace")(t))}function l(i){return null===i||a(i)?(e.exit("codeFencedFence"),t(i)):n(i)}},partial:!0},u=r(this.events,"linePrefix"),d=0;return function(t){return e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),s=t,p(t)};function p(t){return t===s?(e.consume(t),d++,p):(e.exit("codeFencedFenceSequence"),d<3?n(t):o(e,m,"whitespace")(t))}function m(t){return null===t||a(t)?y(t):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),g(t))}function g(t){return null===t||i(t)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),o(e,f,"whitespace")(t)):96===t&&t===s?n(t):(e.consume(t),g)}function f(t){return null===t||a(t)?y(t):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),b(t))}function b(t){return null===t||a(t)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),y(t)):96===t&&t===s?n(t):(e.consume(t),b)}function y(n){return e.exit("codeFencedFence"),l.interrupt?t(n):h(n)}function h(t){return null===t?E(t):a(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),e.attempt(c,E,u?o(e,h,"linePrefix",u+1):h)):(e.enter("codeFlowValue"),v(t))}function v(t){return null===t||a(t)?(e.exit("codeFlowValue"),h(t)):(e.consume(t),v)}function E(n){return e.exit("codeFenced"),t(n)}},concrete:!0};e.exports=s},function(e,t,n){"use strict";var a=n(115),i=n(200),r=n(369),o=n(122),s={name:"codeIndented",tokenize:function(e,t,n){return e.attempt(l,i,n);function i(n){return null===n?t(n):a(n)?e.attempt(l,i,t)(n):(e.enter("codeFlowValue"),r(n))}function r(t){return null===t||a(t)?(e.exit("codeFlowValue"),i(t)):(e.consume(t),r)}},resolve:function(e,t){var n={type:"codeIndented",start:e[0][1].start,end:e[e.length-1][1].end};return i(e,0,0,[["enter",n,t]]),i(e,e.length,0,[["exit",n,t]]),e}},l={tokenize:function(e,t,n){var i=this;return o(e,(function s(l){return a(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),o(e,s,"linePrefix",5)):r(i.events,"linePrefix")<4?n(l):t(l)}),"linePrefix",5)},partial:!0};e.exports=s},function(e,t,n){"use strict";var a=n(115),i={name:"codeText",tokenize:function(e,t,n){var i,r,o=0;return function(t){return e.enter("codeText"),e.enter("codeTextSequence"),s(t)};function s(t){return 96===t?(e.consume(t),o++,s):(e.exit("codeTextSequence"),l(t))}function l(t){return null===t?n(t):96===t?(r=e.enter("codeTextSequence"),i=0,u(t)):32===t?(e.enter("space"),e.consume(t),e.exit("space"),l):a(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),l):(e.enter("codeTextData"),c(t))}function c(t){return null===t||32===t||96===t||a(t)?(e.exit("codeTextData"),l(t)):(e.consume(t),c)}function u(n){return 96===n?(e.consume(n),i++,u):i===o?(e.exit("codeTextSequence"),e.exit("codeText"),t(n)):(r.type="codeTextData",c(n))}},resolve:function(e){var t,n,a=e.length-4,i=3;if(!("lineEnding"!==e[i][1].type&&"space"!==e[i][1].type||"lineEnding"!==e[a][1].type&&"space"!==e[a][1].type))for(t=i;++t<a;)if("codeTextData"===e[t][1].type){e[a][1].type=e[i][1].type="codeTextPadding",i+=2,a-=2;break}for(t=i-1,a++;++t<=a;)void 0===n?t!==a&&"lineEnding"!==e[t][1].type&&(n=t):t!==a&&"lineEnding"!==e[t][1].type||(e[n][1].type="codeTextData",t!==n+2&&(e[n][1].end=e[t-1][1].end,e.splice(n+2,t-n-2),a-=t-n-2,t=n+2),n=void 0);return e},previous:function(e){return 96!==e||"characterEscape"===this.events[this.events.length-1][1].type}};e.exports=i},function(e,t,n){"use strict";var a=n(115),i=n(201),r=n(486),o=n(670),s=n(671),l=n(122),c=n(672),u=n(673),d={name:"definition",tokenize:function(e,t,n){var i,u=this;return function(t){return e.enter("definition"),s.call(u,e,d,n,"definitionLabel","definitionLabelMarker","definitionLabelString")(t)};function d(t){return i=r(u.sliceSerialize(u.events[u.events.length-1][1]).slice(1,-1)),58===t?(e.enter("definitionMarker"),e.consume(t),e.exit("definitionMarker"),c(e,o(e,e.attempt(p,l(e,m,"whitespace"),l(e,m,"whitespace")),n,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString"))):n(t)}function m(r){return null===r||a(r)?(e.exit("definition"),u.parser.defined.indexOf(i)<0&&u.parser.defined.push(i),t(r)):n(r)}}},p={tokenize:function(e,t,n){return function(t){return i(t)?c(e,r)(t):n(t)};function r(t){return 34===t||39===t||40===t?u(e,l(e,o,"whitespace"),n,"definitionTitle","definitionTitleMarker","definitionTitleString")(t):n(t)}function o(e){return null===e||a(e)?t(e):n(e)}},partial:!0};e.exports=d},function(e,t,n){"use strict";var a=n(115),i={name:"hardBreakEscape",tokenize:function(e,t,n){return function(t){return e.enter("hardBreakEscape"),e.enter("escapeMarker"),e.consume(t),i};function i(i){return a(i)?(e.exit("escapeMarker"),e.exit("hardBreakEscape"),t(i)):n(i)}}};e.exports=i},function(e,t,n){"use strict";var a=n(115),i=n(201),r=n(189),o=n(200),s=n(122),l={name:"headingAtx",tokenize:function(e,t,n){var o=this,l=0;return function(t){return e.enter("atxHeading"),e.enter("atxHeadingSequence"),c(t)};function c(a){return 35===a&&l++<6?(e.consume(a),c):null===a||i(a)?(e.exit("atxHeadingSequence"),o.interrupt?t(a):u(a)):n(a)}function u(n){return 35===n?(e.enter("atxHeadingSequence"),d(n)):null===n||a(n)?(e.exit("atxHeading"),t(n)):r(n)?s(e,u,"whitespace")(n):(e.enter("atxHeadingText"),p(n))}function d(t){return 35===t?(e.consume(t),d):(e.exit("atxHeadingSequence"),u(t))}function p(t){return null===t||35===t||i(t)?(e.exit("atxHeadingText"),u(t)):(e.consume(t),p)}},resolve:function(e,t){var n,a,i=e.length-2,r=3;return"whitespace"===e[r][1].type&&(r+=2),i-2>r&&"whitespace"===e[i][1].type&&(i-=2),"atxHeadingSequence"===e[i][1].type&&(r===i-1||i-4>r&&"whitespace"===e[i-2][1].type)&&(i-=r+1===i?2:4),i>r&&(n={type:"atxHeadingText",start:e[r][1].start,end:e[i][1].end},a={type:"chunkText",start:e[r][1].start,end:e[i][1].end,contentType:"text"},o(e,r,i-r+1,[["enter",n,t],["enter",a,t],["exit",a,t],["exit",n,t]])),e}};e.exports=l},function(e,t,n){"use strict";var a=n(490),i=n(370),r=n(115),o=n(201),s=n(189),l=n(367),c=n(1034),u=n(1035),d=n(368),p={name:"htmlFlow",tokenize:function(e,t,n){var d,p,g,f,b,y=this;return function(t){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(t),h};function h(i){return 33===i?(e.consume(i),v):47===i?(e.consume(i),k):63===i?(e.consume(i),d=3,y.interrupt?t:$):a(i)?(e.consume(i),g=l(i),p=!0,S):n(i)}function v(i){return 45===i?(e.consume(i),d=2,E):91===i?(e.consume(i),d=5,g="CDATA[",f=0,x):a(i)?(e.consume(i),d=4,y.interrupt?t:$):n(i)}function E(a){return 45===a?(e.consume(a),y.interrupt?t:$):n(a)}function x(a){return a===g.charCodeAt(f++)?(e.consume(a),f===g.length?y.interrupt?t:_:x):n(a)}function k(t){return a(t)?(e.consume(t),g=l(t),S):n(t)}function S(a){return null===a||47===a||62===a||o(a)?47!==a&&p&&u.indexOf(g.toLowerCase())>-1?(d=1,y.interrupt?t(a):_(a)):c.indexOf(g.toLowerCase())>-1?(d=6,47===a?(e.consume(a),w):y.interrupt?t(a):_(a)):(d=7,y.interrupt?n(a):p?O(a):j(a)):45===a||i(a)?(e.consume(a),g+=l(a),S):n(a)}function w(a){return 62===a?(e.consume(a),y.interrupt?t:_):n(a)}function j(t){return s(t)?(e.consume(t),j):F(t)}function O(t){return 47===t?(e.consume(t),F):58===t||95===t||a(t)?(e.consume(t),I):s(t)?(e.consume(t),O):F(t)}function I(t){return 45===t||46===t||58===t||95===t||i(t)?(e.consume(t),I):T(t)}function T(t){return 61===t?(e.consume(t),C):s(t)?(e.consume(t),T):O(t)}function C(t){return null===t||60===t||61===t||62===t||96===t?n(t):34===t||39===t?(e.consume(t),b=t,M):s(t)?(e.consume(t),C):(b=void 0,N(t))}function M(t){return t===b?(e.consume(t),D):null===t||r(t)?n(t):(e.consume(t),M)}function N(t){return null===t||34===t||39===t||60===t||61===t||62===t||96===t||o(t)?T(t):(e.consume(t),N)}function D(e){return 47===e||62===e||s(e)?O(e):n(e)}function F(t){return 62===t?(e.consume(t),A):n(t)}function A(t){return s(t)?(e.consume(t),A):null===t||r(t)?_(t):n(t)}function _(t){return 45===t&&2===d?(e.consume(t),L):60===t&&1===d?(e.consume(t),q):62===t&&4===d?(e.consume(t),V):63===t&&3===d?(e.consume(t),$):93===t&&5===d?(e.consume(t),z):!r(t)||6!==d&&7!==d?null===t||r(t)?R(t):(e.consume(t),_):e.check(m,V,R)(t)}function R(t){return e.exit("htmlFlowData"),P(t)}function P(t){return null===t?U(t):r(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),P):(e.enter("htmlFlowData"),_(t))}function L(t){return 45===t?(e.consume(t),$):_(t)}function q(t){return 47===t?(e.consume(t),g="",B):_(t)}function B(t){return 62===t&&u.indexOf(g.toLowerCase())>-1?(e.consume(t),V):a(t)&&g.length<8?(e.consume(t),g+=l(t),B):_(t)}function z(t){return 93===t?(e.consume(t),$):_(t)}function $(t){return 62===t?(e.consume(t),V):_(t)}function V(t){return null===t||r(t)?(e.exit("htmlFlowData"),U(t)):(e.consume(t),V)}function U(n){return e.exit("htmlFlow"),t(n)}},resolveTo:function(e){for(var t=e.length;t--&&("enter"!==e[t][0]||"htmlFlow"!==e[t][1].type););return t>1&&"linePrefix"===e[t-2][1].type&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2)),e},concrete:!0},m={tokenize:function(e,t,n){return function(a){return e.exit("htmlFlowData"),e.enter("lineEndingBlank"),e.consume(a),e.exit("lineEndingBlank"),e.attempt(d,t,n)}},partial:!0};e.exports=p},function(e,t,n){"use strict";e.exports=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","section","source","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"]},function(e,t,n){"use strict";e.exports=["pre","script","style","textarea"]},function(e,t,n){"use strict";var a=n(490),i=n(370),r=n(115),o=n(201),s=n(189),l=n(122),c={name:"htmlText",tokenize:function(e,t,n){var c,u,d,p,m=this;return function(t){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(t),g};function g(t){return 33===t?(e.consume(t),f):47===t?(e.consume(t),T):63===t?(e.consume(t),O):a(t)?(e.consume(t),N):n(t)}function f(t){return 45===t?(e.consume(t),b):91===t?(e.consume(t),u="CDATA[",d=0,x):a(t)?(e.consume(t),j):n(t)}function b(t){return 45===t?(e.consume(t),y):n(t)}function y(t){return null===t||62===t?n(t):45===t?(e.consume(t),h):v(t)}function h(e){return null===e||62===e?n(e):v(e)}function v(t){return null===t?n(t):45===t?(e.consume(t),E):r(t)?(p=v,q(t)):(e.consume(t),v)}function E(t){return 45===t?(e.consume(t),z):v(t)}function x(t){return t===u.charCodeAt(d++)?(e.consume(t),d===u.length?k:x):n(t)}function k(t){return null===t?n(t):93===t?(e.consume(t),S):r(t)?(p=k,q(t)):(e.consume(t),k)}function S(t){return 93===t?(e.consume(t),w):k(t)}function w(t){return 62===t?z(t):93===t?(e.consume(t),w):k(t)}function j(t){return null===t||62===t?z(t):r(t)?(p=j,q(t)):(e.consume(t),j)}function O(t){return null===t?n(t):63===t?(e.consume(t),I):r(t)?(p=O,q(t)):(e.consume(t),O)}function I(e){return 62===e?z(e):O(e)}function T(t){return a(t)?(e.consume(t),C):n(t)}function C(t){return 45===t||i(t)?(e.consume(t),C):M(t)}function M(t){return r(t)?(p=M,q(t)):s(t)?(e.consume(t),M):z(t)}function N(t){return 45===t||i(t)?(e.consume(t),N):47===t||62===t||o(t)?D(t):n(t)}function D(t){return 47===t?(e.consume(t),z):58===t||95===t||a(t)?(e.consume(t),F):r(t)?(p=D,q(t)):s(t)?(e.consume(t),D):z(t)}function F(t){return 45===t||46===t||58===t||95===t||i(t)?(e.consume(t),F):A(t)}function A(t){return 61===t?(e.consume(t),_):r(t)?(p=A,q(t)):s(t)?(e.consume(t),A):D(t)}function _(t){return null===t||60===t||61===t||62===t||96===t?n(t):34===t||39===t?(e.consume(t),c=t,R):r(t)?(p=_,q(t)):s(t)?(e.consume(t),_):(e.consume(t),c=void 0,L)}function R(t){return t===c?(e.consume(t),P):null===t?n(t):r(t)?(p=R,q(t)):(e.consume(t),R)}function P(e){return 62===e||47===e||o(e)?D(e):n(e)}function L(t){return null===t||34===t||39===t||60===t||61===t||96===t?n(t):62===t||o(t)?D(t):(e.consume(t),L)}function q(t){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),l(e,B,"linePrefix",m.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)}function B(t){return e.enter("htmlTextData"),p(t)}function z(a){return 62===a?(e.consume(a),e.exit("htmlTextData"),e.exit("htmlText"),t):n(a)}}};e.exports=c},function(e,t,n){"use strict";var a={name:"labelStartImage",tokenize:function(e,t,n){var a=this;return function(t){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(t),e.exit("labelImageMarker"),i};function i(t){return 91===t?(e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelImage"),r):n(t)}function r(e){return 94===e&&"_hiddenFootnoteSupport"in a.parser.constructs?n(e):t(e)}},resolveAll:n(491).resolveAll};e.exports=a},function(e,t,n){"use strict";var a={name:"labelStartLink",tokenize:function(e,t,n){var a=this;return function(t){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelLink"),i};function i(e){return 94===e&&"_hiddenFootnoteSupport"in a.parser.constructs?n(e):t(e)}},resolveAll:n(491).resolveAll};e.exports=a},function(e,t,n){"use strict";var a=n(122),i={name:"lineEnding",tokenize:function(e,t){return function(n){return e.enter("lineEnding"),e.consume(n),e.exit("lineEnding"),a(e,t,"linePrefix")}}};e.exports=i},function(e,t,n){"use strict";var a=n(669),i=n(189),r=n(369),o=n(664),s=n(122),l=n(368),c=n(674),u={name:"list",tokenize:function(e,t,n){var s=this,u=r(s.events,"linePrefix"),p=0;return function(t){var i=s.containerState.type||(42===t||43===t||45===t?"listUnordered":"listOrdered");if("listUnordered"===i?!s.containerState.marker||t===s.containerState.marker:a(t)){if(s.containerState.type||(s.containerState.type=i,e.enter(i,{_container:!0})),"listUnordered"===i)return e.enter("listItemPrefix"),42===t||45===t?e.check(c,n,g)(t):g(t);if(!s.interrupt||49===t)return e.enter("listItemPrefix"),e.enter("listItemValue"),m(t)}return n(t)};function m(t){return a(t)&&++p<10?(e.consume(t),m):(!s.interrupt||p<2)&&(s.containerState.marker?t===s.containerState.marker:41===t||46===t)?(e.exit("listItemValue"),g(t)):n(t)}function g(t){return e.enter("listItemMarker"),e.consume(t),e.exit("listItemMarker"),s.containerState.marker=s.containerState.marker||t,e.check(l,s.interrupt?n:f,e.attempt(d,y,b))}function f(e){return s.containerState.initialBlankLine=!0,u++,y(e)}function b(t){return i(t)?(e.enter("listItemPrefixWhitespace"),e.consume(t),e.exit("listItemPrefixWhitespace"),y):n(t)}function y(n){return s.containerState.size=u+o(s.sliceStream(e.exit("listItemPrefix"))),t(n)}},continuation:{tokenize:function(e,t,n){var a=this;return a.containerState._closeFlow=void 0,e.check(l,(function(n){return a.containerState.furtherBlankLines=a.containerState.furtherBlankLines||a.containerState.initialBlankLine,s(e,t,"listItemIndent",a.containerState.size+1)(n)}),(function(n){return a.containerState.furtherBlankLines||!i(n)?(a.containerState.furtherBlankLines=a.containerState.initialBlankLine=void 0,r(n)):(a.containerState.furtherBlankLines=a.containerState.initialBlankLine=void 0,e.attempt(p,t,r)(n))}));function r(i){return a.containerState._closeFlow=!0,a.interrupt=void 0,s(e,e.attempt(u,t,n),"linePrefix",a.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)(i)}}},exit:function(e){e.exit(this.containerState.type)}},d={tokenize:function(e,t,n){var a=this;return s(e,(function(e){return i(e)||!r(a.events,"listItemPrefixWhitespace")?n(e):t(e)}),"listItemPrefixWhitespace",a.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:5)},partial:!0},p={tokenize:function(e,t,n){var a=this;return s(e,(function(e){return r(a.events,"listItemIndent")===a.containerState.size?t(e):n(e)}),"listItemIndent",a.containerState.size+1)},partial:!0};e.exports=u},function(e,t,n){"use strict";var a=n(115),i=n(263),r=n(122),o={name:"setextUnderline",tokenize:function(e,t,n){for(var i,o,s=this,l=s.events.length;l--;)if("lineEnding"!==s.events[l][1].type&&"linePrefix"!==s.events[l][1].type&&"content"!==s.events[l][1].type){o="paragraph"===s.events[l][1].type;break}return function(t){return s.lazy||!s.interrupt&&!o?n(t):(e.enter("setextHeadingLine"),e.enter("setextHeadingLineSequence"),i=t,c(t))};function c(t){return t===i?(e.consume(t),c):(e.exit("setextHeadingLineSequence"),r(e,u,"lineSuffix")(t))}function u(i){return null===i||a(i)?(e.exit("setextHeadingLine"),t(i)):n(i)}},resolveTo:function(e,t){for(var n,a,r,o,s=e.length;s--;)if("enter"===e[s][0]){if("content"===e[s][1].type){n=s;break}"paragraph"===e[s][1].type&&(a=s)}else"content"===e[s][1].type&&e.splice(s,1),r||"definition"!==e[s][1].type||(r=s);return o={type:"setextHeading",start:i(e[a][1].start),end:i(e[e.length-1][1].end)},e[a][1].type="setextHeadingText",r?(e.splice(a,0,["enter",o,t]),e.splice(r+1,0,["exit",e[n][1],t]),e[n][1].end=i(e[r][1].end)):e[n][1]=o,e.push(["exit",o,t]),e}};e.exports=o},function(e,t,n){"use strict";var a=/[\0\t\n\r]/g;e.exports=function(){var e,t=!0,n=1,i="";return function(r,o,s){var l,c,u,d,p,m=[];for(r=i+r.toString(o),u=0,i="",t&&(65279===r.charCodeAt(0)&&u++,t=void 0);u<r.length;){if(a.lastIndex=u,d=(l=a.exec(r))?l.index:r.length,p=r.charCodeAt(d),!l){i=r.slice(u);break}if(10===p&&u===d&&e)m.push(-3),e=void 0;else if(e&&(m.push(-5),e=void 0),u<d&&(m.push(r.slice(u,d)),n+=d-u),0===p)m.push(65533),n++;else if(9===p)for(c=4*Math.ceil(n/4),m.push(-2);n++<c;)m.push(-1);else 10===p?(m.push(-4),n=1):(e=!0,n=1);u=d+1}return s&&(e&&m.push(-5),i&&m.push(i),m.push(null)),m}}},function(e,t,n){"use strict";var a=n(665);e.exports=function(e){for(;!a(e););return e}},function(e,t,n){e.exports=n(27)(3455)},function(e,t,n){e.exports=n(27)(1887)},function(e,t,n){e.exports=n(27)(1516)},function(e,t,n){const a=n(1048);e.exports=function(e){if(e.allowedElements&&e.disallowedElements)throw new TypeError("Only one of `allowedElements` and `disallowedElements` should be defined");if(e.allowedElements||e.disallowedElements||e.allowElement)return e=>{a(e,"element",t)};function t(t,n,a){const i=t,r=a;let o;if(e.allowedElements?o=!e.allowedElements.includes(i.tagName):e.disallowedElements&&(o=e.disallowedElements.includes(i.tagName)),!o&&e.allowElement&&"number"==typeof n&&(o=!e.allowElement(i,n,r)),o&&"number"==typeof n)return e.unwrapDisallowed&&i.children?r.children.splice(n,1,...i.children):r.children.splice(n,1),n}}},function(e,t,n){e.exports=n(27)(338)},function(e,t){const n=["http","https","mailto","tel"];e.exports=function(e){const t=(e||"").trim(),a=t.charAt(0);if("#"===a||"/"===a)return t;const i=t.indexOf(":");if(-1===i)return t;let r=-1;for(;++r<n.length;){const e=n[r];if(i===e.length&&t.slice(0,e.length).toLowerCase()===e)return t}return r=t.indexOf("?"),-1!==r&&i>r?t:(r=t.indexOf("#"),-1!==r&&i>r?t:"javascript:void(0)")}},function(e,t,n){"use strict";const a=n(4),i=n(1078),r=n(1051),o=n(1052),s=n(1053),l=n(1054),c=n(1055),u=n(1056);t.hastToReact=g,t.hastChildrenToReact=m;const d={}.hasOwnProperty,p=new Set(["table","thead","tbody","tfoot","tr"]);function m(e,t){const n=[];let a,i=-1;for(;++i<t.children.length;)a=t.children[i],"element"===a.type?n.push(g(e,a,i,t)):"text"===a.type?"element"===t.type&&p.has(t.tagName)&&"\n"===a.value||n.push(a.value):"raw"!==a.type||e.options.skipHtml||n.push(a.value);return n}function g(e,t,n,o){const s=e.options,l=e.schema,c=t.tagName,u={};let p,g=l;if("html"===l.space&&"svg"===c&&(g=r,e.schema=g),t.properties)for(p in t.properties)d.call(t.properties,p)&&b(u,p,t.properties[p],e);"ol"!==c&&"ul"!==c||e.listDepth++;const y=m(e,t);"ol"!==c&&"ul"!==c||e.listDepth--,e.schema=l;const h=t.position||{start:{line:null,column:null,offset:null},end:{line:null,column:null,offset:null}},v=s.components&&d.call(s.components,c)?s.components[c]:c,E="string"==typeof v||v===a.Fragment;if(!i.isValidElementType(v))throw new TypeError(`Component for name \`${c}\` not defined or is not renderable`);if(u.key=[c,h.start.line,h.start.column,n].join("-"),"a"===c&&s.linkTarget&&(u.target="function"==typeof s.linkTarget?s.linkTarget(u.href,t.children,u.title):s.linkTarget),"a"===c&&s.transformLinkUri&&(u.href=s.transformLinkUri(u.href,t.children,u.title)),E||"code"!==c||"element"!==o.type||"pre"===o.tagName||(u.inline=!0),E||"h1"!==c&&"h2"!==c&&"h3"!==c&&"h4"!==c&&"h5"!==c&&"h6"!==c||(u.level=parseInt(c.charAt(1),10)),"img"===c&&s.transformImageUri&&(u.src=s.transformImageUri(u.src,u.alt,u.title)),!E&&"li"===c&&"element"===o.type){const e=function(e){let t=-1;for(;++t<e.children.length;){const n=e.children[t];if("element"===n.type&&"input"===n.tagName)return n}return null}(t);u.checked=e&&e.properties?Boolean(e.properties.checked):null,u.index=f(o,t),u.ordered="ol"===o.tagName}var x;return E||"ol"!==c&&"ul"!==c||(u.ordered="ol"===c,u.depth=e.listDepth),"td"!==c&&"th"!==c||(u.align&&(u.style||(u.style={}),u.style.textAlign=u.align,delete u.align),E||(u.isHeader="th"===c)),E||"tr"!==c||"element"!==o.type||(u.isHeader=Boolean("thead"===o.tagName)),s.sourcePos&&(u["data-sourcepos"]=[(x=h).start.line,":",x.start.column,"-",x.end.line,":",x.end.column].map((e=>String(e))).join("")),!E&&s.rawSourcePos&&(u.sourcePosition=t.position),!E&&s.includeElementIndex&&(u.index=f(o,t),u.siblingCount=f(o)),E||(u.node=t),y.length>0?a.createElement(v,u,y):a.createElement(v,u)}function f(e,t){let n=-1,a=0;for(;++n<e.children.length&&e.children[n]!==t;)"element"===e.children[n].type&&a++;return a}function b(e,t,n,a){const i=o(a.schema,t);let r=n;null!=r&&r==r&&(r&&"object"==typeof r&&"length"in r&&(r=(i.commaSeparated?c:l).stringify(r)),"style"===i.property&&"string"==typeof r&&(r=function(e){const t={};try{u(e,(function(e,n){const a="-ms-"===e.slice(0,4)?`ms-${e.slice(4)}`:e;t[a.replace(/-([a-z])/g,y)]=n}))}catch(e){}return t}(r)),i.space&&i.property?e[d.call(s,i.property)?s[i.property]:i.property]=r:i.attribute&&(e[i.attribute]=r))}function y(e,t){return t.toUpperCase()}},function(e,t,n){e.exports=n(27)(3517)},function(e,t,n){e.exports=n(27)(1527)},function(e,t,n){e.exports=n(27)(3519)},function(e,t,n){e.exports=n(27)(1528)},function(e,t,n){e.exports=n(27)(1529)},function(e,t,n){e.exports=n(27)(3520)},function(e,t,n){var a,i,r,o;
/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */o=function(e){var t=Object.prototype.toString,n=Array.isArray||function(e){return"[object Array]"===t.call(e)};function a(e){return"function"==typeof e}function i(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function r(e,t){return null!=e&&"object"==typeof e&&t in e}var o=RegExp.prototype.test,s=/\S/;var l={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},c=/\s*/,u=/\s+/,d=/\s*=/,p=/\s*\}/,m=/#|\^|\/|>|\{|&|=|!/;function g(e){this.string=e,this.tail=e,this.pos=0}function f(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function b(){this.cache={}}g.prototype.eos=function(){return""===this.tail},g.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return"";var n=t[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n},g.prototype.scanUntil=function(e){var t,n=this.tail.search(e);switch(n){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,n),this.tail=this.tail.substring(n)}return this.pos+=t.length,t},f.prototype.push=function(e){return new f(e,this)},f.prototype.lookup=function(e){var t,n=this.cache;if(n.hasOwnProperty(e))t=n[e];else{for(var i,o,s=this,l=!1;s;){if(e.indexOf(".")>0)for(t=s.view,i=e.split("."),o=0;null!=t&&o<i.length;)o===i.length-1&&(l=r(t,i[o])),t=t[i[o++]];else t=s.view[e],l=r(s.view,e);if(l)break;s=s.parent}n[e]=t}return a(t)&&(t=t.call(this.view)),t},b.prototype.clearCache=function(){this.cache={}},b.prototype.parse=function(t,a){var r=this.cache,l=r[t];return null==l&&(l=r[t]=function(t,a){if(!t)return[];var r,l,f,b,y=[],h=[],v=[],E=!1,x=!1;function k(){if(E&&!x)for(;v.length;)delete h[v.pop()];else v=[];E=!1,x=!1}function S(e){if("string"==typeof e&&(e=e.split(u,2)),!n(e)||2!==e.length)throw new Error("Invalid tags: "+e);r=new RegExp(i(e[0])+"\\s*"),l=new RegExp("\\s*"+i(e[1])),f=new RegExp("\\s*"+i("}"+e[1]))}S(a||e.tags);for(var w,j,O,I,T,C,M=new g(t);!M.eos();){if(w=M.pos,O=M.scanUntil(r))for(var N=0,D=O.length;N<D;++N)b=I=O.charAt(N),function(e,t){return o.call(e,t)}(s,b)?x=!0:v.push(h.length),h.push(["text",I,w,w+1]),w+=1,"\n"===I&&k();if(!M.scan(r))break;if(E=!0,j=M.scan(m)||"name",M.scan(c),"="===j?(O=M.scanUntil(d),M.scan(d),M.scanUntil(l)):"{"===j?(O=M.scanUntil(f),M.scan(p),M.scanUntil(l),j="&"):O=M.scanUntil(l),!M.scan(l))throw new Error("Unclosed tag at "+M.pos);if(T=[j,O,w,M.pos],h.push(T),"#"===j||"^"===j)y.push(T);else if("/"===j){if(!(C=y.pop()))throw new Error('Unopened section "'+O+'" at '+w);if(C[1]!==O)throw new Error('Unclosed section "'+C[1]+'" at '+w)}else"name"===j||"{"===j||"&"===j?x=!0:"="===j&&S(O)}if(C=y.pop())throw new Error('Unclosed section "'+C[1]+'" at '+M.pos);return function(e){for(var t,n=[],a=n,i=[],r=0,o=e.length;r<o;++r)switch((t=e[r])[0]){case"#":case"^":a.push(t),i.push(t),a=t[4]=[];break;case"/":i.pop()[5]=t[2],a=i.length>0?i[i.length-1][4]:n;break;default:a.push(t)}return n}(function(e){for(var t,n,a=[],i=0,r=e.length;i<r;++i)(t=e[i])&&("text"===t[0]&&n&&"text"===n[0]?(n[1]+=t[1],n[3]=t[3]):(a.push(t),n=t));return a}(h))}(t,a)),l},b.prototype.render=function(e,t,n){var a=this.parse(e),i=t instanceof f?t:new f(t);return this.renderTokens(a,i,n,e)},b.prototype.renderTokens=function(e,t,n,a){for(var i,r,o,s="",l=0,c=e.length;l<c;++l)o=void 0,"#"===(r=(i=e[l])[0])?o=this.renderSection(i,t,n,a):"^"===r?o=this.renderInverted(i,t,n,a):">"===r?o=this.renderPartial(i,t,n,a):"&"===r?o=this.unescapedValue(i,t):"name"===r?o=this.escapedValue(i,t):"text"===r&&(o=this.rawValue(i)),void 0!==o&&(s+=o);return s},b.prototype.renderSection=function(e,t,i,r){var o=this,s="",l=t.lookup(e[1]);if(l){if(n(l))for(var c=0,u=l.length;c<u;++c)s+=this.renderTokens(e[4],t.push(l[c]),i,r);else if("object"==typeof l||"string"==typeof l||"number"==typeof l)s+=this.renderTokens(e[4],t.push(l),i,r);else if(a(l)){if("string"!=typeof r)throw new Error("Cannot use higher-order sections without the original template");null!=(l=l.call(t.view,r.slice(e[3],e[5]),(function(e){return o.render(e,t,i)})))&&(s+=l)}else s+=this.renderTokens(e[4],t,i,r);return s}},b.prototype.renderInverted=function(e,t,a,i){var r=t.lookup(e[1]);if(!r||n(r)&&0===r.length)return this.renderTokens(e[4],t,a,i)},b.prototype.renderPartial=function(e,t,n){if(n){var i=a(n)?n(e[1]):n[e[1]];return null!=i?this.renderTokens(this.parse(i),t,n,i):void 0}},b.prototype.unescapedValue=function(e,t){var n=t.lookup(e[1]);if(null!=n)return n},b.prototype.escapedValue=function(t,n){var a=n.lookup(t[1]);if(null!=a)return e.escape(a)},b.prototype.rawValue=function(e){return e[1]},e.name="mustache.js",e.version="2.3.2",e.tags=["{{","}}"];var y=new b;return e.clearCache=function(){return y.clearCache()},e.parse=function(e,t){return y.parse(e,t)},e.render=function(e,t,a){if("string"!=typeof e)throw new TypeError('Invalid template! Template should be a "string" but "'+(n(i=e)?"array":typeof i)+'" was given as the first argument for mustache#render(template, view, partials)');var i;return y.render(e,t,a)},e.to_html=function(t,n,i,r){var o=e.render(t,n,i);if(!a(r))return o;r(o)},e.escape=function(e){return String(e).replace(/[&<>"'`=\/]/g,(function(e){return l[e]}))},e.Scanner=g,e.Context=f,e.Writer=b,e},t&&"string"!=typeof t.nodeName?o(t):(i=[t],void 0===(r="function"==typeof(a=o)?a.apply(t,i):a)||(e.exports=r))},function(e,t,n){switch(window.__kbnThemeTag__){case"v8dark":return n(1059);case"v8light":return n(1061)}},function(e,t,n){var a=n(250),i=n(1060);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,n){(t=n(251)(!1)).push([e.i,".kbnOverlayMountWrapper{display:flex;flex-direction:column;height:100%;overflow:hidden}",""]),e.exports=t},function(e,t,n){var a=n(250),i=n(1062);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,n){(t=n(251)(!1)).push([e.i,".kbnOverlayMountWrapper{display:flex;flex-direction:column;height:100%;overflow:hidden}",""]),e.exports=t},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(67),i=n(4);t.default=function(e){void 0===e&&(e={});var t=i.useState(e),n=t[0],r=t[1],o=i.useMemo((function(){return{set:function(e,t){r((function(n){var i;return a.__assign(a.__assign({},n),((i={})[e]=t,i))}))},setAll:function(e){r(e)},remove:function(e){r((function(t){var n=t,i=e;return n[i],a.__rest(n,["symbol"==typeof i?i:i+""])}))},reset:function(){return r(e)}}}),[r]),s=a.__assign({get:i.useCallback((function(e){return n[e]}),[n])},o);return[n,s]}},function(e,t,n){e.exports=function e(t,n,a){function i(o,s){if(!n[o]){if(!t[o]){if(r)return r(o,!0);throw new Error("Cannot find module '"+o+"'")}var l=n[o]={exports:{}};t[o][0].call(l.exports,(function(e){return i(t[o][1][e]||e)}),l,l.exports,e,t,n,a)}return n[o].exports}for(var r=!1,o=0;o<a.length;o++)i(a[o]);return i}({1:[function(e,t,n){(function(a,i,r,o,s,l,c,u,d){"use strict";function p(e,t){return function(e,t){var n;if(void 0===(n="passthrough"!==t.algorithm?y.createHash(t.algorithm):new b).write&&(n.write=n.update,n.end=n.update),f(t,n).dispatch(e),n.update||n.end(""),n.digest)return n.digest("buffer"===t.encoding?void 0:t.encoding);var a=n.read();return"buffer"===t.encoding?a:a.toString(t.encoding)}(e,t=m(e,t))}function m(e,t){if((t=t||{}).algorithm=t.algorithm||"sha1",t.encoding=t.encoding||"hex",t.excludeValues=!!t.excludeValues,t.algorithm=t.algorithm.toLowerCase(),t.encoding=t.encoding.toLowerCase(),t.ignoreUnknown=!0===t.ignoreUnknown,t.respectType=!1!==t.respectType,t.respectFunctionNames=!1!==t.respectFunctionNames,t.respectFunctionProperties=!1!==t.respectFunctionProperties,t.unorderedArrays=!0===t.unorderedArrays,t.unorderedSets=!1!==t.unorderedSets,t.unorderedObjects=!1!==t.unorderedObjects,t.replacer=t.replacer||void 0,t.excludeKeys=t.excludeKeys||void 0,void 0===e)throw new Error("Object argument required.");for(var n=0;n<h.length;++n)h[n].toLowerCase()===t.algorithm.toLowerCase()&&(t.algorithm=h[n]);if(-1===h.indexOf(t.algorithm))throw new Error('Algorithm "'+t.algorithm+'"  not supported. supported values: '+h.join(", "));if(-1===v.indexOf(t.encoding)&&"passthrough"!==t.algorithm)throw new Error('Encoding "'+t.encoding+'"  not supported. supported values: '+v.join(", "));return t}function g(e){return"function"==typeof e&&null!=/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(e))}function f(e,t,n){n=n||[];var a=function(e){return t.update?t.update(e,"utf8"):t.write(e,"utf8")};return{dispatch:function(t){e.replacer&&(t=e.replacer(t));var n=typeof t;return null===t&&(n="null"),this["_"+n](t)},_object:function(t){var i=Object.prototype.toString.call(t),o=/\[object (.*)\]/i.exec(i);o=(o=o?o[1]:"unknown:["+i+"]").toLowerCase();var s;if((s=n.indexOf(t))>=0)return this.dispatch("[CIRCULAR:"+s+"]");if(n.push(t),void 0!==r&&r.isBuffer&&r.isBuffer(t))return a("buffer:"),a(t);if("object"===o||"function"===o){var l=Object.keys(t);e.unorderedObjects&&(l=l.sort()),!1===e.respectType||g(t)||l.splice(0,0,"prototype","__proto__","constructor"),e.excludeKeys&&(l=l.filter((function(t){return!e.excludeKeys(t)}))),a("object:"+l.length+":");var c=this;return l.forEach((function(n){c.dispatch(n),a(":"),e.excludeValues||c.dispatch(t[n]),a(",")}))}if(!this["_"+o]){if(e.ignoreUnknown)return a("["+o+"]");throw new Error('Unknown object type "'+o+'"')}this["_"+o](t)},_array:function(t,i){i=void 0!==i?i:!1!==e.unorderedArrays;var r=this;if(a("array:"+t.length+":"),!i||t.length<=1)return t.forEach((function(e){return r.dispatch(e)}));var o=[],s=t.map((function(t){var a=new b,i=n.slice();return f(e,a,i).dispatch(t),o=o.concat(i.slice(n.length)),a.read().toString()}));return n=n.concat(o),s.sort(),this._array(s,!1)},_date:function(e){return a("date:"+e.toJSON())},_symbol:function(e){return a("symbol:"+e.toString())},_error:function(e){return a("error:"+e.toString())},_boolean:function(e){return a("bool:"+e.toString())},_string:function(e){a("string:"+e.length+":"),a(e.toString())},_function:function(t){a("fn:"),g(t)?this.dispatch("[native]"):this.dispatch(t.toString()),!1!==e.respectFunctionNames&&this.dispatch("function-name:"+String(t.name)),e.respectFunctionProperties&&this._object(t)},_number:function(e){return a("number:"+e.toString())},_xml:function(e){return a("xml:"+e.toString())},_null:function(){return a("Null")},_undefined:function(){return a("Undefined")},_regexp:function(e){return a("regex:"+e.toString())},_uint8array:function(e){return a("uint8array:"),this.dispatch(Array.prototype.slice.call(e))},_uint8clampedarray:function(e){return a("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(e))},_int8array:function(e){return a("uint8array:"),this.dispatch(Array.prototype.slice.call(e))},_uint16array:function(e){return a("uint16array:"),this.dispatch(Array.prototype.slice.call(e))},_int16array:function(e){return a("uint16array:"),this.dispatch(Array.prototype.slice.call(e))},_uint32array:function(e){return a("uint32array:"),this.dispatch(Array.prototype.slice.call(e))},_int32array:function(e){return a("uint32array:"),this.dispatch(Array.prototype.slice.call(e))},_float32array:function(e){return a("float32array:"),this.dispatch(Array.prototype.slice.call(e))},_float64array:function(e){return a("float64array:"),this.dispatch(Array.prototype.slice.call(e))},_arraybuffer:function(e){return a("arraybuffer:"),this.dispatch(new Uint8Array(e))},_url:function(e){return a("url:"+e.toString())},_map:function(t){a("map:");var n=Array.from(t);return this._array(n,!1!==e.unorderedSets)},_set:function(t){a("set:");var n=Array.from(t);return this._array(n,!1!==e.unorderedSets)},_blob:function(){if(e.ignoreUnknown)return a("[blob]");throw Error('Hashing Blob objects is currently not supported\n(see https://github.com/puleos/object-hash/issues/26)\nUse "options.replacer" or "options.ignoreUnknown"\n')},_domwindow:function(){return a("domwindow")},_process:function(){return a("process")},_timer:function(){return a("timer")},_pipe:function(){return a("pipe")},_tcp:function(){return a("tcp")},_udp:function(){return a("udp")},_tty:function(){return a("tty")},_statwatcher:function(){return a("statwatcher")},_securecontext:function(){return a("securecontext")},_connection:function(){return a("connection")},_zlib:function(){return a("zlib")},_context:function(){return a("context")},_nodescript:function(){return a("nodescript")},_httpparser:function(){return a("httpparser")},_dataview:function(){return a("dataview")},_signal:function(){return a("signal")},_fsevent:function(){return a("fsevent")},_tlswrap:function(){return a("tlswrap")}}}function b(){return{buf:"",write:function(e){this.buf+=e},end:function(e){this.buf+=e},read:function(){return this.buf}}}var y=e("crypto");(n=t.exports=p).sha1=function(e){return p(e)},n.keys=function(e){return p(e,{excludeValues:!0,algorithm:"sha1",encoding:"hex"})},n.MD5=function(e){return p(e,{algorithm:"md5",encoding:"hex"})},n.keysMD5=function(e){return p(e,{algorithm:"md5",encoding:"hex",excludeValues:!0})};var h=y.getHashes?y.getHashes().slice():["sha1","md5"];h.push("passthrough");var v=["buffer","hex","binary","base64"];n.writeToStream=function(e,t,n){return void 0===n&&(n=t,t={}),f(t=m(e,t),n).dispatch(e)}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/fake_e8180ef5.js","/")},{buffer:3,crypto:5,lYpoI2:10}],2:[function(e,t,n){(function(e,t,a,i,r,o,s,l,c){!function(e){"use strict";function t(e){var t=e.charCodeAt(0);return t===a||t===l?62:t===i||t===c?63:t<r?-1:t<r+10?t-r+26+26:t<s+26?t-s:t<o+26?t-o+26:void 0}var n="undefined"!=typeof Uint8Array?Uint8Array:Array,a="+".charCodeAt(0),i="/".charCodeAt(0),r="0".charCodeAt(0),o="a".charCodeAt(0),s="A".charCodeAt(0),l="-".charCodeAt(0),c="_".charCodeAt(0);e.toByteArray=function(e){function a(e){c[d++]=e}var i,r,o,s,l,c;if(e.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var u=e.length;l="="===e.charAt(u-2)?2:"="===e.charAt(u-1)?1:0,c=new n(3*e.length/4-l),o=l>0?e.length-4:e.length;var d=0;for(i=0,r=0;i<o;i+=4,r+=3)a((16711680&(s=t(e.charAt(i))<<18|t(e.charAt(i+1))<<12|t(e.charAt(i+2))<<6|t(e.charAt(i+3))))>>16),a((65280&s)>>8),a(255&s);return 2===l?a(255&(s=t(e.charAt(i))<<2|t(e.charAt(i+1))>>4)):1===l&&(a((s=t(e.charAt(i))<<10|t(e.charAt(i+1))<<4|t(e.charAt(i+2))>>2)>>8&255),a(255&s)),c},e.fromByteArray=function(e){function t(e){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e)}function n(e){return t(e>>18&63)+t(e>>12&63)+t(e>>6&63)+t(63&e)}var a,i,r,o=e.length%3,s="";for(a=0,r=e.length-o;a<r;a+=3)s+=n(i=(e[a]<<16)+(e[a+1]<<8)+e[a+2]);switch(o){case 1:s+=t((i=e[e.length-1])>>2),s+=t(i<<4&63),s+="==";break;case 2:s+=t((i=(e[e.length-2]<<8)+e[e.length-1])>>10),s+=t(i>>4&63),s+=t(i<<2&63),s+="="}return s}}(void 0===n?this.base64js={}:n)}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/base64-js/lib/b64.js","/node_modules/gulp-browserify/node_modules/base64-js/lib")},{buffer:3,lYpoI2:10}],3:[function(e,t,n){(function(t,a,i,r,o,s,l,c,u){function i(e,t,n){if(!(this instanceof i))return new i(e,t,n);var a,r,o,s=typeof e;if("base64"===t&&"string"===s)for(e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e);e.length%4!=0;)e+="=";if("number"===s)a=M(e);else if("string"===s)a=i.byteLength(e,t);else{if("object"!==s)throw new Error("First argument needs to be a number, array or string.");a=M(e.length)}if(i._useTypedArrays?r=i._augment(new Uint8Array(a)):((r=this).length=a,r._isBuffer=!0),i._useTypedArrays&&"number"==typeof e.byteLength)r._set(e);else if(function(e){return N(e)||i.isBuffer(e)||e&&"object"==typeof e&&"number"==typeof e.length}(e))for(o=0;o<a;o++)i.isBuffer(e)?r[o]=e.readUInt8(o):r[o]=e[o];else if("string"===s)r.write(e,0,t);else if("number"===s&&!i._useTypedArrays&&!n)for(o=0;o<a;o++)r[o]=0;return r}function d(e,t,n,a){n=Number(n)||0;var r=e.length-n;a?(a=Number(a))>r&&(a=r):a=r;var o=t.length;B(o%2==0,"Invalid hex string"),a>o/2&&(a=o/2);for(var s=0;s<a;s++){var l=parseInt(t.substr(2*s,2),16);B(!isNaN(l),"Invalid hex string"),e[n+s]=l}return i._charsWritten=2*s,s}function p(e,t,n,a){return i._charsWritten=_(F(t),e,n,a)}function m(e,t,n,a){return i._charsWritten=_(function(e){for(var t=[],n=0;n<e.length;n++)t.push(255&e.charCodeAt(n));return t}(t),e,n,a)}function g(e,t,n,a){return i._charsWritten=_(A(t),e,n,a)}function f(e,t,n,a){return i._charsWritten=_(function(e){for(var t,n,a,i=[],r=0;r<e.length;r++)n=(t=e.charCodeAt(r))>>8,a=t%256,i.push(a),i.push(n);return i}(t),e,n,a)}function b(e,t,n){var a="";n=Math.min(e.length,n);for(var i=t;i<n;i++)a+=String.fromCharCode(e[i]);return a}function y(e,t,n,a){a||(B("boolean"==typeof n,"missing or invalid endian"),B(null!=t,"missing offset"),B(t+1<e.length,"Trying to read beyond buffer length"));var i,r=e.length;if(!(t>=r))return n?(i=e[t],t+1<r&&(i|=e[t+1]<<8)):(i=e[t]<<8,t+1<r&&(i|=e[t+1])),i}function h(e,t,n,a){a||(B("boolean"==typeof n,"missing or invalid endian"),B(null!=t,"missing offset"),B(t+3<e.length,"Trying to read beyond buffer length"));var i,r=e.length;if(!(t>=r))return n?(t+2<r&&(i=e[t+2]<<16),t+1<r&&(i|=e[t+1]<<8),i|=e[t],t+3<r&&(i+=e[t+3]<<24>>>0)):(t+1<r&&(i=e[t+1]<<16),t+2<r&&(i|=e[t+2]<<8),t+3<r&&(i|=e[t+3]),i+=e[t]<<24>>>0),i}function v(e,t,n,a){if(a||(B("boolean"==typeof n,"missing or invalid endian"),B(null!=t,"missing offset"),B(t+1<e.length,"Trying to read beyond buffer length")),!(t>=e.length)){var i=y(e,t,n,!0);return 32768&i?-1*(65535-i+1):i}}function E(e,t,n,a){if(a||(B("boolean"==typeof n,"missing or invalid endian"),B(null!=t,"missing offset"),B(t+3<e.length,"Trying to read beyond buffer length")),!(t>=e.length)){var i=h(e,t,n,!0);return 2147483648&i?-1*(4294967295-i+1):i}}function x(e,t,n,a){return a||(B("boolean"==typeof n,"missing or invalid endian"),B(t+3<e.length,"Trying to read beyond buffer length")),$.read(e,t,n,23,4)}function k(e,t,n,a){return a||(B("boolean"==typeof n,"missing or invalid endian"),B(t+7<e.length,"Trying to read beyond buffer length")),$.read(e,t,n,52,8)}function S(e,t,n,a,i){i||(B(null!=t,"missing value"),B("boolean"==typeof a,"missing or invalid endian"),B(null!=n,"missing offset"),B(n+1<e.length,"trying to write beyond buffer length"),P(t,65535));var r=e.length;if(!(n>=r))for(var o=0,s=Math.min(r-n,2);o<s;o++)e[n+o]=(t&255<<8*(a?o:1-o))>>>8*(a?o:1-o)}function w(e,t,n,a,i){i||(B(null!=t,"missing value"),B("boolean"==typeof a,"missing or invalid endian"),B(null!=n,"missing offset"),B(n+3<e.length,"trying to write beyond buffer length"),P(t,4294967295));var r=e.length;if(!(n>=r))for(var o=0,s=Math.min(r-n,4);o<s;o++)e[n+o]=t>>>8*(a?o:3-o)&255}function j(e,t,n,a,i){i||(B(null!=t,"missing value"),B("boolean"==typeof a,"missing or invalid endian"),B(null!=n,"missing offset"),B(n+1<e.length,"Trying to write beyond buffer length"),L(t,32767,-32768)),n>=e.length||S(e,t>=0?t:65535+t+1,n,a,i)}function O(e,t,n,a,i){i||(B(null!=t,"missing value"),B("boolean"==typeof a,"missing or invalid endian"),B(null!=n,"missing offset"),B(n+3<e.length,"Trying to write beyond buffer length"),L(t,2147483647,-2147483648)),n>=e.length||w(e,t>=0?t:4294967295+t+1,n,a,i)}function I(e,t,n,a,i){i||(B(null!=t,"missing value"),B("boolean"==typeof a,"missing or invalid endian"),B(null!=n,"missing offset"),B(n+3<e.length,"Trying to write beyond buffer length"),q(t,34028234663852886e22,-34028234663852886e22)),n>=e.length||$.write(e,t,n,a,23,4)}function T(e,t,n,a,i){i||(B(null!=t,"missing value"),B("boolean"==typeof a,"missing or invalid endian"),B(null!=n,"missing offset"),B(n+7<e.length,"Trying to write beyond buffer length"),q(t,17976931348623157e292,-17976931348623157e292)),n>=e.length||$.write(e,t,n,a,52,8)}function C(e,t,n){return"number"!=typeof e?n:(e=~~e)>=t?t:e>=0||(e+=t)>=0?e:0}function M(e){return(e=~~Math.ceil(+e))<0?0:e}function N(e){return(Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)})(e)}function D(e){return e<16?"0"+e.toString(16):e.toString(16)}function F(e){for(var t=[],n=0;n<e.length;n++){var a=e.charCodeAt(n);if(a<=127)t.push(e.charCodeAt(n));else{var i=n;a>=55296&&a<=57343&&n++;for(var r=encodeURIComponent(e.slice(i,n+1)).substr(1).split("%"),o=0;o<r.length;o++)t.push(parseInt(r[o],16))}}return t}function A(e){return z.toByteArray(e)}function _(e,t,n,a){for(var i=0;i<a&&!(i+n>=t.length||i>=e.length);i++)t[i+n]=e[i];return i}function R(e){try{return decodeURIComponent(e)}catch(e){return String.fromCharCode(65533)}}function P(e,t){B("number"==typeof e,"cannot write a non-number as a number"),B(e>=0,"specified a negative value for writing an unsigned value"),B(e<=t,"value is larger than maximum value for type"),B(Math.floor(e)===e,"value has a fractional component")}function L(e,t,n){B("number"==typeof e,"cannot write a non-number as a number"),B(e<=t,"value larger than maximum allowed value"),B(e>=n,"value smaller than minimum allowed value"),B(Math.floor(e)===e,"value has a fractional component")}function q(e,t,n){B("number"==typeof e,"cannot write a non-number as a number"),B(e<=t,"value larger than maximum allowed value"),B(e>=n,"value smaller than minimum allowed value")}function B(e,t){if(!e)throw new Error(t||"Failed assertion")}var z=e("base64-js"),$=e("ieee754");n.Buffer=i,n.SlowBuffer=i,n.INSPECT_MAX_BYTES=50,i.poolSize=8192,i._useTypedArrays=function(){try{var e=new ArrayBuffer(0),t=new Uint8Array(e);return t.foo=function(){return 42},42===t.foo()&&"function"==typeof t.subarray}catch(e){return!1}}(),i.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},i.isBuffer=function(e){return!(null==e||!e._isBuffer)},i.byteLength=function(e,t){var n;switch(e+="",t||"utf8"){case"hex":n=e.length/2;break;case"utf8":case"utf-8":n=F(e).length;break;case"ascii":case"binary":case"raw":n=e.length;break;case"base64":n=A(e).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":n=2*e.length;break;default:throw new Error("Unknown encoding")}return n},i.concat=function(e,t){if(B(N(e),"Usage: Buffer.concat(list, [totalLength])\nlist should be an Array."),0===e.length)return new i(0);if(1===e.length)return e[0];var n;if("number"!=typeof t)for(t=0,n=0;n<e.length;n++)t+=e[n].length;var a=new i(t),r=0;for(n=0;n<e.length;n++){var o=e[n];o.copy(a,r),r+=o.length}return a},i.prototype.write=function(e,t,n,a){if(isFinite(t))isFinite(n)||(a=n,n=void 0);else{var i=a;a=t,t=n,n=i}t=Number(t)||0;var r,o=this.length-t;switch(n?(n=Number(n))>o&&(n=o):n=o,a=String(a||"utf8").toLowerCase()){case"hex":r=d(this,e,t,n);break;case"utf8":case"utf-8":r=p(this,e,t,n);break;case"ascii":r=m(this,e,t,n);break;case"binary":r=function(e,t,n,a){return m(e,t,n,a)}(this,e,t,n);break;case"base64":r=g(this,e,t,n);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":r=f(this,e,t,n);break;default:throw new Error("Unknown encoding")}return r},i.prototype.toString=function(e,t,n){var a,i=this;if(e=String(e||"utf8").toLowerCase(),t=Number(t)||0,(n=void 0!==n?Number(n):n=i.length)===t)return"";switch(e){case"hex":a=function(e,t,n){var a=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>a)&&(n=a);for(var i="",r=t;r<n;r++)i+=D(e[r]);return i}(i,t,n);break;case"utf8":case"utf-8":a=function(e,t,n){var a="",i="";n=Math.min(e.length,n);for(var r=t;r<n;r++)e[r]<=127?(a+=R(i)+String.fromCharCode(e[r]),i=""):i+="%"+e[r].toString(16);return a+R(i)}(i,t,n);break;case"ascii":a=b(i,t,n);break;case"binary":a=function(e,t,n){return b(e,t,n)}(i,t,n);break;case"base64":a=function(e,t,n){return 0===t&&n===e.length?z.fromByteArray(e):z.fromByteArray(e.slice(t,n))}(i,t,n);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":a=function(e,t,n){for(var a=e.slice(t,n),i="",r=0;r<a.length;r+=2)i+=String.fromCharCode(a[r]+256*a[r+1]);return i}(i,t,n);break;default:throw new Error("Unknown encoding")}return a},i.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},i.prototype.copy=function(e,t,n,a){var r=this;if(n||(n=0),a||0===a||(a=this.length),t||(t=0),a!==n&&0!==e.length&&0!==r.length){B(a>=n,"sourceEnd < sourceStart"),B(t>=0&&t<e.length,"targetStart out of bounds"),B(n>=0&&n<r.length,"sourceStart out of bounds"),B(a>=0&&a<=r.length,"sourceEnd out of bounds"),a>this.length&&(a=this.length),e.length-t<a-n&&(a=e.length-t+n);var o=a-n;if(o<100||!i._useTypedArrays)for(var s=0;s<o;s++)e[s+t]=this[s+n];else e._set(this.subarray(n,n+o),t)}},i.prototype.slice=function(e,t){var n=this.length;if(e=C(e,n,0),t=C(t,n,n),i._useTypedArrays)return i._augment(this.subarray(e,t));for(var a=t-e,r=new i(a,void 0,!0),o=0;o<a;o++)r[o]=this[o+e];return r},i.prototype.get=function(e){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(e)},i.prototype.set=function(e,t){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(e,t)},i.prototype.readUInt8=function(e,t){if(t||(B(null!=e,"missing offset"),B(e<this.length,"Trying to read beyond buffer length")),!(e>=this.length))return this[e]},i.prototype.readUInt16LE=function(e,t){return y(this,e,!0,t)},i.prototype.readUInt16BE=function(e,t){return y(this,e,!1,t)},i.prototype.readUInt32LE=function(e,t){return h(this,e,!0,t)},i.prototype.readUInt32BE=function(e,t){return h(this,e,!1,t)},i.prototype.readInt8=function(e,t){if(t||(B(null!=e,"missing offset"),B(e<this.length,"Trying to read beyond buffer length")),!(e>=this.length))return 128&this[e]?-1*(255-this[e]+1):this[e]},i.prototype.readInt16LE=function(e,t){return v(this,e,!0,t)},i.prototype.readInt16BE=function(e,t){return v(this,e,!1,t)},i.prototype.readInt32LE=function(e,t){return E(this,e,!0,t)},i.prototype.readInt32BE=function(e,t){return E(this,e,!1,t)},i.prototype.readFloatLE=function(e,t){return x(this,e,!0,t)},i.prototype.readFloatBE=function(e,t){return x(this,e,!1,t)},i.prototype.readDoubleLE=function(e,t){return k(this,e,!0,t)},i.prototype.readDoubleBE=function(e,t){return k(this,e,!1,t)},i.prototype.writeUInt8=function(e,t,n){n||(B(null!=e,"missing value"),B(null!=t,"missing offset"),B(t<this.length,"trying to write beyond buffer length"),P(e,255)),t>=this.length||(this[t]=e)},i.prototype.writeUInt16LE=function(e,t,n){S(this,e,t,!0,n)},i.prototype.writeUInt16BE=function(e,t,n){S(this,e,t,!1,n)},i.prototype.writeUInt32LE=function(e,t,n){w(this,e,t,!0,n)},i.prototype.writeUInt32BE=function(e,t,n){w(this,e,t,!1,n)},i.prototype.writeInt8=function(e,t,n){n||(B(null!=e,"missing value"),B(null!=t,"missing offset"),B(t<this.length,"Trying to write beyond buffer length"),L(e,127,-128)),t>=this.length||(e>=0?this.writeUInt8(e,t,n):this.writeUInt8(255+e+1,t,n))},i.prototype.writeInt16LE=function(e,t,n){j(this,e,t,!0,n)},i.prototype.writeInt16BE=function(e,t,n){j(this,e,t,!1,n)},i.prototype.writeInt32LE=function(e,t,n){O(this,e,t,!0,n)},i.prototype.writeInt32BE=function(e,t,n){O(this,e,t,!1,n)},i.prototype.writeFloatLE=function(e,t,n){I(this,e,t,!0,n)},i.prototype.writeFloatBE=function(e,t,n){I(this,e,t,!1,n)},i.prototype.writeDoubleLE=function(e,t,n){T(this,e,t,!0,n)},i.prototype.writeDoubleBE=function(e,t,n){T(this,e,t,!1,n)},i.prototype.fill=function(e,t,n){if(e||(e=0),t||(t=0),n||(n=this.length),"string"==typeof e&&(e=e.charCodeAt(0)),B("number"==typeof e&&!isNaN(e),"value is not a number"),B(n>=t,"end < start"),n!==t&&0!==this.length){B(t>=0&&t<this.length,"start out of bounds"),B(n>=0&&n<=this.length,"end out of bounds");for(var a=t;a<n;a++)this[a]=e}},i.prototype.inspect=function(){for(var e=[],t=this.length,a=0;a<t;a++)if(e[a]=D(this[a]),a===n.INSPECT_MAX_BYTES){e[a+1]="...";break}return"<Buffer "+e.join(" ")+">"},i.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(i._useTypedArrays)return new i(this).buffer;for(var e=new Uint8Array(this.length),t=0,n=e.length;t<n;t+=1)e[t]=this[t];return e.buffer}throw new Error("Buffer.toArrayBuffer not supported in this browser")};var V=i.prototype;i._augment=function(e){return e._isBuffer=!0,e._get=e.get,e._set=e.set,e.get=V.get,e.set=V.set,e.write=V.write,e.toString=V.toString,e.toLocaleString=V.toString,e.toJSON=V.toJSON,e.copy=V.copy,e.slice=V.slice,e.readUInt8=V.readUInt8,e.readUInt16LE=V.readUInt16LE,e.readUInt16BE=V.readUInt16BE,e.readUInt32LE=V.readUInt32LE,e.readUInt32BE=V.readUInt32BE,e.readInt8=V.readInt8,e.readInt16LE=V.readInt16LE,e.readInt16BE=V.readInt16BE,e.readInt32LE=V.readInt32LE,e.readInt32BE=V.readInt32BE,e.readFloatLE=V.readFloatLE,e.readFloatBE=V.readFloatBE,e.readDoubleLE=V.readDoubleLE,e.readDoubleBE=V.readDoubleBE,e.writeUInt8=V.writeUInt8,e.writeUInt16LE=V.writeUInt16LE,e.writeUInt16BE=V.writeUInt16BE,e.writeUInt32LE=V.writeUInt32LE,e.writeUInt32BE=V.writeUInt32BE,e.writeInt8=V.writeInt8,e.writeInt16LE=V.writeInt16LE,e.writeInt16BE=V.writeInt16BE,e.writeInt32LE=V.writeInt32LE,e.writeInt32BE=V.writeInt32BE,e.writeFloatLE=V.writeFloatLE,e.writeFloatBE=V.writeFloatBE,e.writeDoubleLE=V.writeDoubleLE,e.writeDoubleBE=V.writeDoubleBE,e.fill=V.fill,e.inspect=V.inspect,e.toArrayBuffer=V.toArrayBuffer,e}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/buffer/index.js","/node_modules/gulp-browserify/node_modules/buffer")},{"base64-js":2,buffer:3,ieee754:11,lYpoI2:10}],4:[function(e,t,n){(function(n,a,i,r,o,s,l,c,u){i=e("buffer").Buffer;var d=4,p=new i(d);p.fill(0);var m=8;t.exports={hash:function(e,t,n,a){return i.isBuffer(e)||(e=new i(e)),function(e,t,n){for(var a=new i(t),r=n?a.writeInt32BE:a.writeInt32LE,o=0;o<e.length;o++)r.call(a,e[o],4*o,!0);return a}(t(function(e,t){if(e.length%d!=0){var n=e.length+(d-e.length%d);e=i.concat([e,p],n)}for(var a=[],r=t?e.readInt32BE:e.readInt32LE,o=0;o<e.length;o+=d)a.push(r.call(e,o));return a}(e,a),e.length*m),n,a)}}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/helpers.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:10}],5:[function(e,t,n){(function(t,a,i,r,o,s,l,c,u){function d(e,t){var n=b[e=e||"sha1"],a=[];return n||p("algorithm:",e,"is not yet supported"),{update:function(e){return i.isBuffer(e)||(e=new i(e)),a.push(e),e.length,this},digest:function(e){var r=i.concat(a),o=t?function(e,t,n){i.isBuffer(t)||(t=new i(t)),i.isBuffer(n)||(n=new i(n)),t.length>y?t=e(t):t.length<y&&(t=i.concat([t,h],y));for(var a=new i(y),r=new i(y),o=0;o<y;o++)a[o]=54^t[o],r[o]=92^t[o];var s=e(i.concat([a,n]));return e(i.concat([r,s]))}(n,t,r):n(r);return a=null,e?o.toString(e):o}}}function p(){var e=[].slice.call(arguments).join(" ");throw new Error([e,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join("\n"))}i=e("buffer").Buffer;var m=e("./sha"),g=e("./sha256"),f=e("./rng"),b={sha1:m,sha256:g,md5:e("./md5")},y=64,h=new i(y);h.fill(0),n.createHash=function(e){return d(e)},n.createHmac=function(e,t){return d(e,t)},n.randomBytes=function(e,t){if(!t||!t.call)return new i(f(e));try{t.call(this,void 0,new i(f(e)))}catch(e){t(e)}},function(e,t){for(var n in e)t(e[n],n)}(["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"],(function(e){n[e]=function(){p("sorry,",e,"is not implemented yet")}}))}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/index.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./md5":6,"./rng":7,"./sha":8,"./sha256":9,buffer:3,lYpoI2:10}],6:[function(e,t,n){(function(n,a,i,r,o,s,l,c,u){function d(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var n=1732584193,a=-271733879,i=-1732584194,r=271733878,o=0;o<e.length;o+=16){var s=n,l=a,c=i,u=r;n=m(n,a,i,r,e[o+0],7,-680876936),r=m(r,n,a,i,e[o+1],12,-389564586),i=m(i,r,n,a,e[o+2],17,606105819),a=m(a,i,r,n,e[o+3],22,-1044525330),n=m(n,a,i,r,e[o+4],7,-176418897),r=m(r,n,a,i,e[o+5],12,1200080426),i=m(i,r,n,a,e[o+6],17,-1473231341),a=m(a,i,r,n,e[o+7],22,-45705983),n=m(n,a,i,r,e[o+8],7,1770035416),r=m(r,n,a,i,e[o+9],12,-1958414417),i=m(i,r,n,a,e[o+10],17,-42063),a=m(a,i,r,n,e[o+11],22,-1990404162),n=m(n,a,i,r,e[o+12],7,1804603682),r=m(r,n,a,i,e[o+13],12,-40341101),i=m(i,r,n,a,e[o+14],17,-1502002290),n=g(n,a=m(a,i,r,n,e[o+15],22,1236535329),i,r,e[o+1],5,-165796510),r=g(r,n,a,i,e[o+6],9,-1069501632),i=g(i,r,n,a,e[o+11],14,643717713),a=g(a,i,r,n,e[o+0],20,-373897302),n=g(n,a,i,r,e[o+5],5,-701558691),r=g(r,n,a,i,e[o+10],9,38016083),i=g(i,r,n,a,e[o+15],14,-660478335),a=g(a,i,r,n,e[o+4],20,-405537848),n=g(n,a,i,r,e[o+9],5,568446438),r=g(r,n,a,i,e[o+14],9,-1019803690),i=g(i,r,n,a,e[o+3],14,-187363961),a=g(a,i,r,n,e[o+8],20,1163531501),n=g(n,a,i,r,e[o+13],5,-1444681467),r=g(r,n,a,i,e[o+2],9,-51403784),i=g(i,r,n,a,e[o+7],14,1735328473),n=f(n,a=g(a,i,r,n,e[o+12],20,-1926607734),i,r,e[o+5],4,-378558),r=f(r,n,a,i,e[o+8],11,-2022574463),i=f(i,r,n,a,e[o+11],16,1839030562),a=f(a,i,r,n,e[o+14],23,-35309556),n=f(n,a,i,r,e[o+1],4,-1530992060),r=f(r,n,a,i,e[o+4],11,1272893353),i=f(i,r,n,a,e[o+7],16,-155497632),a=f(a,i,r,n,e[o+10],23,-1094730640),n=f(n,a,i,r,e[o+13],4,681279174),r=f(r,n,a,i,e[o+0],11,-358537222),i=f(i,r,n,a,e[o+3],16,-722521979),a=f(a,i,r,n,e[o+6],23,76029189),n=f(n,a,i,r,e[o+9],4,-640364487),r=f(r,n,a,i,e[o+12],11,-421815835),i=f(i,r,n,a,e[o+15],16,530742520),n=b(n,a=f(a,i,r,n,e[o+2],23,-995338651),i,r,e[o+0],6,-198630844),r=b(r,n,a,i,e[o+7],10,1126891415),i=b(i,r,n,a,e[o+14],15,-1416354905),a=b(a,i,r,n,e[o+5],21,-57434055),n=b(n,a,i,r,e[o+12],6,1700485571),r=b(r,n,a,i,e[o+3],10,-1894986606),i=b(i,r,n,a,e[o+10],15,-1051523),a=b(a,i,r,n,e[o+1],21,-2054922799),n=b(n,a,i,r,e[o+8],6,1873313359),r=b(r,n,a,i,e[o+15],10,-30611744),i=b(i,r,n,a,e[o+6],15,-1560198380),a=b(a,i,r,n,e[o+13],21,1309151649),n=b(n,a,i,r,e[o+4],6,-145523070),r=b(r,n,a,i,e[o+11],10,-1120210379),i=b(i,r,n,a,e[o+2],15,718787259),a=b(a,i,r,n,e[o+9],21,-343485551),n=y(n,s),a=y(a,l),i=y(i,c),r=y(r,u)}return Array(n,a,i,r)}function p(e,t,n,a,i,r){return y(function(e,t){return e<<t|e>>>32-t}(y(y(t,e),y(a,r)),i),n)}function m(e,t,n,a,i,r,o){return p(t&n|~t&a,e,t,i,r,o)}function g(e,t,n,a,i,r,o){return p(t&a|n&~a,e,t,i,r,o)}function f(e,t,n,a,i,r,o){return p(t^n^a,e,t,i,r,o)}function b(e,t,n,a,i,r,o){return p(n^(t|~a),e,t,i,r,o)}function y(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}var h=e("./helpers");t.exports=function(e){return h.hash(e,d,16)}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/md5.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:10}],7:[function(e,t,n){(function(e,n,a,i,r,o,s,l,c){!function(){var e,n;e=function(e){for(var t,n=new Array(e),a=0;a<e;a++)0==(3&a)&&(t=4294967296*Math.random()),n[a]=t>>>((3&a)<<3)&255;return n},this.crypto&&crypto.getRandomValues&&(n=function(e){var t=new Uint8Array(e);return crypto.getRandomValues(t),t}),t.exports=n||e}()}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/rng.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:10}],8:[function(e,t,n){(function(n,a,i,r,o,s,l,c,u){function d(e,t){e[t>>5]|=128<<24-t%32,e[15+(t+64>>9<<4)]=t;for(var n=Array(80),a=1732584193,i=-271733879,r=-1732584194,o=271733878,s=-1009589776,l=0;l<e.length;l+=16){for(var c=a,u=i,d=r,b=o,y=s,h=0;h<80;h++){n[h]=h<16?e[l+h]:f(n[h-3]^n[h-8]^n[h-14]^n[h-16],1);var v=g(g(f(a,5),p(h,i,r,o)),g(g(s,n[h]),m(h)));s=o,o=r,r=f(i,30),i=a,a=v}a=g(a,c),i=g(i,u),r=g(r,d),o=g(o,b),s=g(s,y)}return Array(a,i,r,o,s)}function p(e,t,n,a){return e<20?t&n|~t&a:e<40?t^n^a:e<60?t&n|t&a|n&a:t^n^a}function m(e){return e<20?1518500249:e<40?1859775393:e<60?-1894007588:-899497514}function g(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function f(e,t){return e<<t|e>>>32-t}var b=e("./helpers");t.exports=function(e){return b.hash(e,d,20,!0)}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:10}],9:[function(e,t,n){(function(n,a,i,r,o,s,l,c,u){var d=e("./helpers"),p=function(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n},m=function(e,t){return e>>>t|e<<32-t},g=function(e,t){return e>>>t},f=function(e,t,n){return e&t^~e&n},b=function(e,t,n){return e&t^e&n^t&n},y=function(e){return m(e,2)^m(e,13)^m(e,22)},h=function(e){return m(e,6)^m(e,11)^m(e,25)},v=function(e){return m(e,7)^m(e,18)^g(e,3)},E=function(e){return m(e,17)^m(e,19)^g(e,10)},x=function(e,t){var n,a,i,r,o,s,l,c,u,d,m=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),g=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),x=new Array(64);e[t>>5]|=128<<24-t%32,e[15+(t+64>>9<<4)]=t;for(var k=0;k<e.length;k+=16){n=g[0],a=g[1],i=g[2],r=g[3],o=g[4],s=g[5],l=g[6],c=g[7];for(var S=0;S<64;S++)x[S]=S<16?e[S+k]:p(p(p(E(x[S-2]),x[S-7]),v(x[S-15])),x[S-16]),u=p(p(p(p(c,h(o)),f(o,s,l)),m[S]),x[S]),d=p(y(n),b(n,a,i)),c=l,l=s,s=o,o=p(r,u),r=i,i=a,a=n,n=p(u,d);g[0]=p(n,g[0]),g[1]=p(a,g[1]),g[2]=p(i,g[2]),g[3]=p(r,g[3]),g[4]=p(o,g[4]),g[5]=p(s,g[5]),g[6]=p(l,g[6]),g[7]=p(c,g[7])}return g};t.exports=function(e){return d.hash(e,x,32,!0)}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha256.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:10}],10:[function(e,t,n){(function(e,n,a,i,r,o,s,l,c){function u(){}(e=t.exports={}).nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};if(t){var n=[];return window.addEventListener("message",(function(e){var t=e.source;(t===window||null===t)&&"process-tick"===e.data&&(e.stopPropagation(),n.length>0)&&n.shift()()}),!0),function(e){n.push(e),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),e.title="browser",e.browser=!0,e.env={},e.argv=[],e.on=u,e.addListener=u,e.once=u,e.off=u,e.removeListener=u,e.removeAllListeners=u,e.emit=u,e.binding=function(e){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(e){throw new Error("process.chdir is not supported")}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/process/browser.js","/node_modules/gulp-browserify/node_modules/process")},{buffer:3,lYpoI2:10}],11:[function(e,t,n){(function(e,t,a,i,r,o,s,l,c){n.read=function(e,t,n,a,i){var r,o,s=8*i-a-1,l=(1<<s)-1,c=l>>1,u=-7,d=n?i-1:0,p=n?-1:1,m=e[t+d];for(d+=p,r=m&(1<<-u)-1,m>>=-u,u+=s;u>0;r=256*r+e[t+d],d+=p,u-=8);for(o=r&(1<<-u)-1,r>>=-u,u+=a;u>0;o=256*o+e[t+d],d+=p,u-=8);if(0===r)r=1-c;else{if(r===l)return o?NaN:1/0*(m?-1:1);o+=Math.pow(2,a),r-=c}return(m?-1:1)*o*Math.pow(2,r-a)},n.write=function(e,t,n,a,i,r){var o,s,l,c=8*r-i-1,u=(1<<c)-1,d=u>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,m=a?0:r-1,g=a?1:-1,f=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=u):(o=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-o))<1&&(o--,l*=2),(t+=o+d>=1?p/l:p*Math.pow(2,1-d))*l>=2&&(o++,l/=2),o+d>=u?(s=0,o=u):o+d>=1?(s=(t*l-1)*Math.pow(2,i),o+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,i),o=0));i>=8;e[n+m]=255&s,m+=g,s/=256,i-=8);for(o=o<<i|s,c+=i;c>0;e[n+m]=255&o,m+=g,o/=256,c-=8);e[n+m-g]|=128*f}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/ieee754/index.js","/node_modules/ieee754")},{buffer:3,lYpoI2:10}]},{},[1])(1)},function(e,t,n){e.exports=n.p+"94cccf20036d014924e63d4d595e88e1.svg"},,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return c}));var a=n(10),i=n(20),r=n(3),o=n(1076),s=n(1);const l={[s.uc.landing]:{id:s.uc.landing,name:r.n,href:s.r,disabled:!1,urlKey:"get_started"},[s.uc.overview]:{id:s.uc.overview,name:r.x,href:s.u,disabled:!1,urlKey:"overview"},[s.uc.detectionAndResponse]:{id:s.uc.detectionAndResponse,name:r.g,href:s.h,disabled:!1,urlKey:"detection_response"},[s.uc.alerts]:{id:s.uc.alerts,name:r.a,href:s.e,disabled:!1,urlKey:"alerts"},[s.uc.rules]:{id:s.uc.rules,name:r.A,href:s.y,disabled:!1,urlKey:"rules"},[s.uc.exceptions]:{id:s.uc.exceptions,name:r.k,href:s.l,disabled:!1,urlKey:"exceptions"},[s.uc.hosts]:{id:s.uc.hosts,name:r.p,href:s.m,disabled:!1,urlKey:"host"},[s.uc.users]:{id:s.uc.users,name:r.E,href:s.C,disabled:!1,urlKey:"users"},[s.uc.network]:{id:s.uc.network,name:r.u,href:s.t,disabled:!1,urlKey:"network"},[s.uc.kubernetes]:{id:s.uc.kubernetes,name:r.s,href:s.q,disabled:!1,urlKey:"kubernetes"},[s.uc.timelines]:{id:s.uc.timelines,name:r.C,href:s.z,disabled:!1,urlKey:"timeline"},[s.uc.case]:{id:s.uc.case,name:r.c,href:s.g,disabled:!1,urlKey:"cases"},[s.uc.endpoints]:{id:s.uc.endpoints,name:r.h,href:s.i,disabled:!1,urlKey:"administration"},[s.uc.policies]:{id:s.uc.policies,name:r.y,href:s.w,disabled:!1,urlKey:"administration"},[s.uc.trustedApps]:{id:s.uc.trustedApps,name:r.D,href:s.A,disabled:!1,urlKey:"administration"},[s.uc.eventFilters]:{id:s.uc.eventFilters,name:r.j,href:s.k,disabled:!1,urlKey:"administration"},[s.uc.hostIsolationExceptions]:{id:s.uc.hostIsolationExceptions,name:r.q,href:s.n,disabled:!1,urlKey:"administration"},[s.uc.blocklist]:{id:s.uc.blocklist,name:r.b,href:s.f,disabled:!1,urlKey:"administration"},[s.uc.responseActionsHistory]:{id:s.uc.responseActionsHistory,name:r.z,href:s.x,disabled:!1,urlKey:"administration"},[s.uc.threatIntelligenceIndicators]:{...Object(i.getSecuritySolutionNavTab)("indicators",s.v),urlKey:"indicators"},[s.uc.cloudSecurityPostureFindings]:{...Object(a.getSecuritySolutionNavTab)("findings",s.v),urlKey:"findings"},[s.uc.cloudSecurityPostureDashboard]:{...Object(a.getSecuritySolutionNavTab)("dashboard",s.v),urlKey:"cloud_posture"},[s.uc.cloudSecurityPostureBenchmarks]:{...Object(a.getSecuritySolutionNavTab)("benchmarks",s.v),urlKey:"administration"},[s.uc.cloudSecurityPostureRules]:{...Object(a.getSecuritySolutionNavTab)("rules",s.v),urlKey:"administration"},[s.uc.entityAnalytics]:{id:s.uc.entityAnalytics,name:r.i,href:s.j,disabled:!1,urlKey:"entity_analytics"}},c={[o.a.dashboards]:{id:o.a.dashboards,name:r.e},[o.a.detect]:{id:o.a.detect,name:r.f},[o.a.findings]:{id:o.a.findings,name:r.m},[o.a.explore]:{id:o.a.explore,name:r.l},[o.a.intelligence]:{id:o.a.intelligence,name:r.B},[o.a.investigate]:{id:o.a.investigate,name:r.r},[o.a.manage]:{id:o.a.manage,name:r.t}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(2);let i;!function(e){e.dashboards="dashboards",e.detect="detect",e.findings="findings",e.explore="explore",e.intelligence="intelligence",e.investigate="investigate",e.manage="manage"}(i||(i={})),a.a.alerts,a.a.blocklist,a.a.detectionAndResponse,a.a.case,a.a.endpoints,a.a.landing,a.a.policies,a.a.eventFilters,a.a.exceptions,a.a.hostIsolationExceptions,a.a.hosts,a.a.network,a.a.overview,a.a.responseActionsHistory,a.a.rules,a.a.timelines,a.a.trustedApps,a.a.users,a.a.kubernetes,a.a.threatIntelligenceIndicators,a.a.cloudSecurityPostureDashboard,a.a.cloudSecurityPostureFindings,a.a.cloudSecurityPostureBenchmarks,a.a.cloudSecurityPostureRules,a.a.entityAnalytics},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";e.exports=function(e,t){return t||(t={}),"string"!=typeof(e=e&&e.__esModule?e.default:e)?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e)}},function(e,t,n){e.exports=n.p+"1cbd62546f764080f7071e03889e9de3.svg"},,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"NoDataConfigPage",(function(){return J})),n.d(t,"NoDataConfigPageWithSolutionNavBar",(function(){return X})),n.d(t,"NoDataConfigPageKibanaProvider",(function(){return ne})),n.d(t,"NoDataConfigPageProvider",(function(){return te}));var a=n(82),i=n.n(a),r=n(249),o=n.n(r),s=(n(6),n(4)),l=n.n(s),c=n(47),u=n.n(c),d=n(32),p=n(1163),m=n(0),g=n(35),f=n(1166),b=n(216),y=n.n(b),h=n(1074),v=n.n(h),E=n(36),x=["children"],k=l.a.createContext(null),S=function(e){var t=e.children,n=o()(e,x),a=n.navigateToUrl,i=n.currentAppId;return Object(E.jsx)(k.Provider,{value:{navigateToUrl:a,currentAppId:i}},t)},w=function(e){var t=e.children,n=e.coreStart.application,a=n.navigateToUrl,i=n.currentAppId$,r=v()(i,void 0);return Object(E.jsx)(k.Provider,{value:{navigateToUrl:a,currentAppId:r}},t)},j={name:"36bnqj",styles:"display:flex;flex:1"},O=function(e){var t=e.children,n=e.navigateToUrl,a=e.currentAppId,i=Object(s.useRef)(null),r=Object(s.useCallback)((function(e){return function(e){var t=e.event,n=e.container,a=e.navigateToUrl,i=e.currentAppId;if(n&&i){var r=function(e,t){var n=e;do{var a,i;if("a"===(null===(a=n)||void 0===a?void 0:a.tagName.toLowerCase()))return n;var r=null===(i=n)||void 0===i?void 0:i.parentElement;if(!r||r===document.body||r===t)break;n=r}while(parent||parent!==document.body||parent!==t)}(t.target,n);if(r){var o=r.href,s=""===r.target||"_self"===r.target,l=0===t.button;o&&s&&l&&!t.defaultPrevented&&!function(e){return e.metaKey||e.altKey||e.ctrlKey||e.shiftKey}(t)&&(t.preventDefault(),a(r.href))}}}({event:e,currentAppId:a,navigateToUrl:n,container:i.current})}),[a,n]);return Object(E.jsx)("div",{onClick:r,ref:i,css:j},t)},I=function(e){var t=e.children;return Object(E.jsx)(O,function(){var e=Object(s.useContext)(k);if(!e)throw new Error("RedirectAppLinksContext is missing.  Ensure your component or React root is wrapped with RedirectAppLinksProvider.");return e}(),t)},T=n(1221),C=n.n(T),M=["title","description","canAccessFleet","button"],N=m.i18n.translate("sharedUXPackages.card.noData.noPermission.title",{defaultMessage:"Contact your administrator"}),D=m.i18n.translate("sharedUXPackages.card.noData.noPermission.description",{defaultMessage:"This integration is not yet enabled. Your administrator has the required permissions to turn it on."}),F=m.i18n.translate("sharedUXPackages.card.noData.title",{defaultMessage:"Add Elastic Agent"}),A=m.i18n.translate("sharedUXPackages.card.noData.description",{defaultMessage:"Use Elastic Agent for a simple, unified way to collect data from your machines."}),_=function(){return Object(E.jsx)(d.EuiImage,{size:"fullWidth",style:{width:"max(100%, 360px)",height:240,objectFit:"cover",background:"aliceblue"},url:C.a,alt:""})},R=function(e){var t=e.title,n=e.description,a=e.canAccessFleet,r=e.button,s=o()(e,M);return Object(E.jsx)(d.EuiCard,i()({css:{maxWidth:400,marginInline:"auto"},paddingSize:"l",title:a?Object(E.jsx)(d.EuiScreenReaderOnly,null,Object(E.jsx)("span",null,t||F)):Object(E.jsx)(d.EuiTextColor,{color:"default"},N),description:a?n||A:Object(E.jsx)(d.EuiTextColor,{color:"default"},D),footer:function(){if(a)return r&&"string"!=typeof r?r:Object(E.jsx)(d.EuiButton,{fill:!0},r||t||F)}(),isDisabled:!a,image:Object(E.jsx)(_,null)},s))},P=["children"],L=["children"],q=l.a.createContext(null),B=function(e){var t=e.children,n=o()(e,P),a=n.addBasePath,i=n.canAccessFleet;return Object(E.jsx)(q.Provider,{value:{addBasePath:a,canAccessFleet:i}},Object(E.jsx)(S,n,t))},z=function(e){var t=e.children,n=o()(e,L),a={addBasePath:n.coreStart.http.basePath.prepend,canAccessFleet:n.coreStart.application.capabilities.navLinks.integrations};return Object(E.jsx)(q.Provider,{value:a},Object(E.jsx)(w,n,t))},$=["href","category","description"],V=function(e){var t=e.href,n=e.category,a=e.description,i=o()(e,$),r=function(){var e=Object(s.useContext)(q);if(!e)throw new Error("NoDataCard Context is missing.  Ensure your component or React root is wrapped with NoDataCardContext.");return e}(),l=r.canAccessFleet,c=r.addBasePath,u=Object(s.useMemo)((function(){if(t)return t;var e="/app/integrations/browse";return c(n?"".concat(e,"/").concat(n):e)}),[c,t,n]);return Object(E.jsx)(I,null,Object(E.jsx)(R,y()(y()({},i),{},{href:u,canAccessFleet:l,description:a})))},U=function(e){var t=e.action,n=Object.keys(t);if(1!==n.length)return null;var a=n[0],r="elasticAgent"===a?"empty-page-agent-action":"empty-page-".concat(a,"-action");return Object(E.jsx)(V,i()({key:r},t[a]))},H=function(e){var t=e.solution,n=e.logo,a=e.action,i=e.docsLink,r=e.pageTitle,o=e.className,s=r||m.i18n.translate("sharedUXPackages.noDataPage.welcomeTitle",{defaultMessage:"Welcome to Elastic {solution}!",values:{solution:t}}),l=Object(E.jsx)(d.EuiLink,{href:i,target:"_blank"},Object(E.jsx)(g.FormattedMessage,{id:"sharedUXPackages.noDataPage.intro.link",defaultMessage:"learn more"})),c=Object(E.jsx)(g.FormattedMessage,{id:"sharedUXPackages.noDataPage.intro",defaultMessage:"Add your data to get started, or {link} about {solution}.",values:{solution:t,link:l}});return Object(E.jsx)(d.EuiPageTemplate.Section,{alignment:"center",grow:!0,className:u()("kbnNoDataPageContents",o),"data-test-subj":"kbnNoDataPage"},Object(E.jsx)(d.EuiText,{textAlign:"center"},Object(E.jsx)(f.a,{name:t,iconType:n||"logo".concat(t),size:"xxl"}),Object(E.jsx)(d.EuiSpacer,{size:"l"}),Object(E.jsx)("h1",null,s),Object(E.jsx)(d.EuiTextColor,{color:"subdued"},Object(E.jsx)("p",null,c))),Object(E.jsx)(d.EuiSpacer,{size:"xxl"}),Object(E.jsx)(U,{action:a}))},G=["children"],Q=["children"],W=function(e){var t=e.children,n=o()(e,G);return Object(E.jsx)(B,n,t)},K=function(e){var t=e.children,n=o()(e,Q);return Object(E.jsx)(z,n,t)},Y=["className","noDataConfig","pageSideBar","pageSideBarProps"],J=function(e){var t,n=e.className,a=e.noDataConfig,r=e.pageSideBar,s=e.pageSideBarProps,l=o()(e,Y);if(!a)return null;r&&(t=Object(E.jsx)(d.EuiPageTemplate.Sidebar,s,r));var c=function(e,t){return u()("kbnPageTemplate","",t||"")}(0,n);return Object(E.jsx)(d.EuiPageTemplate,i()({className:c,restrictWidth:950,panelled:!1,offset:0,minHeight:0},l),t,Object(E.jsx)(H,a))},X=Object(p.withSolutionNav)(J),Z=["children"],ee=["children"],te=function(e){var t=e.children,n=o()(e,Z);return Object(E.jsx)(W,n,t)},ne=function(e){var t=e.children,n=o()(e,ee);return Object(E.jsx)(K,n,t)}},function(e,t,n){"use strict";n.r(t),n.d(t,"SolutionNav",(function(){return j})),n.d(t,"withSolutionNav",(function(){return N}));var a=n(82),i=n.n(a),r=n(147),o=n.n(r),s=n(249),l=n.n(s),c=(n(1205),n(4)),u=n.n(c),d=n(47),p=n.n(d),m=n(32),g=n(35),f=n(0),b=n(1166),y=(n(1215),n(36)),h=["className","isCollapsed"],v=f.i18n.translate("sharedUXPackages.solutionNav.collapsibleLabel",{defaultMessage:"Collapse side navigation"}),E=f.i18n.translate("sharedUXPackages.solutionNav.openLabel",{defaultMessage:"Open side navigation"}),x=function(e){var t=e.className,n=e.isCollapsed,a=l()(e,h),r=p()("kbnSolutionNavCollapseButton",{"kbnSolutionNavCollapseButton-isCollapsed":n},t);return Object(y.jsx)(m.EuiButtonIcon,i()({className:r,size:"s",color:"text",iconType:n?"menuRight":"menuLeft","aria-label":n?E:v,title:n?E:v},a))},k=["children","headingProps","icon","isOpenOnDesktop","items","mobileBreakpoints","closeFlyoutButtonPosition","name","onCollapse","canBeCollapsed"],S=function e(t,n){return t.map((function(t){return t.tabIndex=n?-1:void 0,t.items=t.items&&e(t.items,n),t}))},w=Object(m.htmlIdGenerator)("SolutionNav"),j=function(e){var t=e.children,n=e.headingProps,a=e.icon,r=e.isOpenOnDesktop,s=void 0!==r&&r,d=e.items,h=e.mobileBreakpoints,v=void 0===h?["xs","s"]:h,E=e.closeFlyoutButtonPosition,j=void 0===E?"outside":E,O=e.name,I=e.onCollapse,T=e.canBeCollapsed,C=void 0===T||T,M=l()(e,k),N=Object(m.useIsWithinBreakpoints)(v),D=Object(m.useIsWithinBreakpoints)(["m"]),F=Object(m.useIsWithinMinBreakpoint)("l"),A=Object(c.useState)(!1),_=o()(A,2),R=_[0],P=_[1],L=F&&!s&&C,q=!!t,B=p()("kbnSolutionNav",{"kbnSolutionNav--hidden":L}),z=(null==n?void 0:n.id)||w("heading"),$=(null==n?void 0:n.element)||"h2",V=Object(y.jsx)(m.EuiTitle,{size:"xs",id:z},Object(y.jsx)($,null,a&&Object(y.jsx)(b.a,{className:"kbnSolutionNav__avatar",iconType:a,name:O}),Object(y.jsx)("strong",null,Object(y.jsx)(g.FormattedMessage,{id:"sharedUXPackages.solutionNav.mobileTitleText",defaultMessage:"{solutionName} {menuText}",values:{solutionName:O||"Navigation",menuText:N?f.i18n.translate("sharedUXPackages.solutionNav.menuText",{defaultMessage:"menu"}):""}})))),U=Object(c.useMemo)((function(){return q?t:d?Object(y.jsx)(m.EuiSideNav,i()({"aria-labelledby":z,"aria-hidden":L,items:S(d,L),mobileBreakpoints:[]},M)):null}),[t,z,q,L,d,M]);return Object(y.jsx)(u.a.Fragment,null,N&&Object(y.jsx)(m.EuiCollapsibleNavGroup,{className:B,paddingSize:"none",background:"none",title:V,titleElement:"span",isCollapsible:C,initialIsOpen:!1},Object(y.jsx)(m.EuiPanel,{color:"transparent",paddingSize:"s"},U)),D&&Object(y.jsx)(u.a.Fragment,null,(R||!C)&&Object(y.jsx)(m.EuiFlyout,{ownFocus:!1,outsideClickCloses:!0,onClose:function(){return P(!1)},side:"left",size:248,closeButtonPosition:j,className:"kbnSolutionNav__flyout",hideCloseButton:!C},Object(y.jsx)("div",{className:B},V,Object(y.jsx)(m.EuiSpacer,{size:"l"}),U)),C&&Object(y.jsx)(x,{isCollapsed:!0,onClick:function(){P(!R)}})),F&&Object(y.jsx)(u.a.Fragment,null,Object(y.jsx)("div",{className:B},V,Object(y.jsx)(m.EuiSpacer,{size:"l"}),U),C&&Object(y.jsx)(x,{isCollapsed:!s,onClick:I})))},O=n(216),I=n.n(O),T=n(349),C=["solutionNav","children"],M="solutionNavIsCollapsed",N=function(e){var t,n=function(t){var n,a=Object(m.useIsWithinBreakpoints)(["m"]),r=Object(m.useIsWithinMinBreakpoint)("l"),s=Object(c.useState)(!JSON.parse(String(localStorage.getItem(M)))),u=o()(s,2),d=u[0],g=u[1],f=t.solutionNav,b=t.children,h=l()(t,C),v=Object(m.useEuiTheme)().euiTheme,E=f.canBeCollapsed,x=a||(void 0===E||E)&&r&&!d,k=function(e){return Object(T.css)("flex:0 1 0;overflow:hidden;",m.euiCanAnimate,"{transition:min-width ",e.animation.fast," ",e.animation.resistance,";}","")}(v),S=p()({"kbnSolutionNav__sidebar--shrink":x},null===(n=t.pageSideBarProps)||void 0===n?void 0:n.className,k),w=Object(y.jsx)(j,i()({isOpenOnDesktop:d,onCollapse:function(){g(!d),localStorage.setItem(M,JSON.stringify(d))}},f)),O=I()(I()({paddingSize:"none"},t.pageSideBarProps),{},{minWidth:x?v.size.xxl:void 0,className:S});return Object(y.jsx)(e,I()(I()({},h),{},{pageSideBar:w,pageSideBarProps:O}),b)};return n.displayName="WithSolutionNavBar(".concat((t=e).displayName||t.name||"UnnamedComponent",")"),n}},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(82),i=n.n(a),r=n(6),o=n.n(r),s=n(249),l=n.n(s),c=(n(1210),n(4),n(47)),u=n.n(c),d=n(32),p=n(36),m=["className","size"],g=function(e){var t=e.className,n=e.size,a=l()(e,m),r={};return function(e){return void 0===e.iconType}(e)&&(r.iconType="logo".concat(e.name.replace(/\s+/g,""))),Object(p.jsx)(d.EuiAvatar,i()({className:u()("kbnSolutionAvatar",o()({},"kbnSolutionAvatar--".concat(n),n),t),size:"xxl"===n?"xl":n,iconSize:n,color:"plain"},a,r))}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"KibanaPageTemplate",{enumerable:!0,get:function(){return a.KibanaPageTemplate}}),Object.defineProperty(t,"KibanaPageTemplateKibanaProvider",{enumerable:!0,get:function(){return i.KibanaPageTemplateKibanaProvider}}),Object.defineProperty(t,"KibanaPageTemplateProvider",{enumerable:!0,get:function(){return i.KibanaPageTemplateProvider}});var a=n(1204),i=n(1223)},function(e,t,n){"use strict";var a=n(348);Object.defineProperty(t,"__esModule",{value:!0}),t._KibanaPageTemplate=t.KibanaPageTemplate=void 0;var i=a(n(82)),r=a(n(4)),o=n(32),s=n(1162),l=n(1222);const c=({className:e,children:t,solutionNav:n,noDataConfig:a,...o})=>a&&n?r.default.createElement(s.NoDataConfigPageWithSolutionNavBar,{"data-test-subj":o["data-test-subj"],className:e,noDataConfig:a,solutionNav:n}):a?r.default.createElement(s.NoDataConfigPage,{"data-test-subj":o["data-test-subj"],className:e,noDataConfig:a}):n?r.default.createElement(l.KibanaPageTemplateWithSolutionNav,(0,i.default)({className:e,solutionNav:n,children:t},o)):r.default.createElement(l.KibanaPageTemplateInner,(0,i.default)({className:e,children:t},o));t._KibanaPageTemplate=c;const u=Object.assign(c,{Sidebar:o.EuiPageTemplate.Sidebar,Header:o.EuiPageTemplate.Header,Section:o.EuiPageTemplate.Section,BottomBar:o.EuiPageTemplate.BottomBar,EmptyPrompt:o.EuiPageTemplate.EmptyPrompt});t.KibanaPageTemplate=u},function(e,t,n){switch(window.__kbnThemeTag__){case"v8dark":return n(1206);case"v8light":return n(1208)}},function(e,t,n){var a=n(250),i=n(1207);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,n){(t=n(251)(!1)).push([e.i,'.kbnSolutionNav__flyout{background-color:#141519}.kbnSolutionNav{background:linear-gradient(160deg,#3437414d,#3437414d 32px,#f000 0),linear-gradient(175deg,#3437414d,#3437414d 16px,#f000 0);display:flex;flex-direction:column;height:100%;overflow-x:hidden;overflow-y:auto;scrollbar-color:#98a2b380 #0000;scrollbar-width:thin}.kbnSolutionNav::-webkit-scrollbar{height:16px;width:16px}.kbnSolutionNav::-webkit-scrollbar-thumb{background-clip:content-box;background-color:#98a2b380;border:6px solid #0000;border-radius:16px}.kbnSolutionNav::-webkit-scrollbar-corner,.kbnSolutionNav::-webkit-scrollbar-track{background-color:#0000}.kbnSolutionNav:focus{outline:none}.kbnSolutionNav[tabindex="0"]:focus:focus-visible{outline-style:auto}@media only screen and (min-width:768px) and (max-width:991px){.kbnSolutionNav{padding:24px;width:248px}}@media only screen and (min-width:992px) and (max-width:1199px){.kbnSolutionNav{padding:24px;width:248px}}@media only screen and (min-width:1200px){.kbnSolutionNav{padding:24px;width:248px}}.kbnSolutionNav .kbnSolutionNav__avatar{margin-right:16px}.kbnSolutionNav--hidden{opacity:0;pointer-events:none}@media screen and (prefers-reduced-motion:no-preference){.kbnSolutionNav--hidden{transition:opacity .15s cubic-bezier(.694,.0482,.335,1)}}',""]),e.exports=t},function(e,t,n){var a=n(250),i=n(1209);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,n){(t=n(251)(!1)).push([e.i,'.kbnSolutionNav__flyout{background-color:#fafbfd}.kbnSolutionNav{background:linear-gradient(160deg,#d3dae64d,#d3dae64d 32px,#f000 0),linear-gradient(175deg,#d3dae64d,#d3dae64d 16px,#f000 0);display:flex;flex-direction:column;height:100%;overflow-x:hidden;overflow-y:auto;scrollbar-color:#69707d80 #0000;scrollbar-width:thin}.kbnSolutionNav::-webkit-scrollbar{height:16px;width:16px}.kbnSolutionNav::-webkit-scrollbar-thumb{background-clip:content-box;background-color:#69707d80;border:6px solid #0000;border-radius:16px}.kbnSolutionNav::-webkit-scrollbar-corner,.kbnSolutionNav::-webkit-scrollbar-track{background-color:#0000}.kbnSolutionNav:focus{outline:none}.kbnSolutionNav[tabindex="0"]:focus:focus-visible{outline-style:auto}@media only screen and (min-width:768px) and (max-width:991px){.kbnSolutionNav{padding:24px;width:248px}}@media only screen and (min-width:992px) and (max-width:1199px){.kbnSolutionNav{padding:24px;width:248px}}@media only screen and (min-width:1200px){.kbnSolutionNav{padding:24px;width:248px}}.kbnSolutionNav .kbnSolutionNav__avatar{margin-right:16px}.kbnSolutionNav--hidden{opacity:0;pointer-events:none}@media screen and (prefers-reduced-motion:no-preference){.kbnSolutionNav--hidden{transition:opacity .15s cubic-bezier(.694,.0482,.335,1)}}',""]),e.exports=t},function(e,t,n){switch(window.__kbnThemeTag__){case"v8dark":return n(1211);case"v8light":return n(1213)}},function(e,t,n){var a=n(250),i=n(1212);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,n){var a=n(251),i=n(1139),r=n(1140);t=a(!1);var o=i(r);t.push([e.i,".kbnSolutionAvatar{box-shadow:0 .7px 1.4px rgba(0,0,0,.175),0 1.9px 4px rgba(0,0,0,.125),0 4.5px 10px rgba(0,0,0,.125)}.kbnSolutionAvatar--xxl{background:#1d1e24 url("+o+") no-repeat;background-size:cover,125%;border-radius:100px;box-shadow:0 .9px 4px -1px #0003,0 2.6px 8px -1px #00000026,0 5.7px 12px -1px rgba(0,0,0,.125),0 15px 15px -1px #0000001a;display:inline-block;height:100px;line-height:100px;text-align:center;width:100px}",""]),e.exports=t},function(e,t,n){var a=n(250),i=n(1214);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,n){var a=n(251),i=n(1139),r=n(1140);t=a(!1);var o=i(r);t.push([e.i,".kbnSolutionAvatar{box-shadow:0 .7px 1.4px #00000012,0 1.9px 4px #0000000d,0 4.5px 10px #0000000d}.kbnSolutionAvatar--xxl{background:#fff url("+o+") no-repeat;background-size:cover,125%;border-radius:100px;box-shadow:0 .9px 4px -1px #00000014,0 2.6px 8px -1px #0000000f,0 5.7px 12px -1px #0000000d,0 15px 15px -1px #0000000a;display:inline-block;height:100px;line-height:100px;text-align:center;width:100px}",""]),e.exports=t},function(e,t,n){switch(window.__kbnThemeTag__){case"v8dark":return n(1216);case"v8light":return n(1218)}},function(e,t,n){var a=n(250),i=n(1217);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,n){(t=n(251)(!1)).push([e.i,".kbnSolutionNavCollapseButton{left:232px;opacity:0;position:absolute;top:24px;z-index:2}@media screen and (prefers-reduced-motion:no-preference){.kbnSolutionNavCollapseButton{transition:opacity .15s,left .15s,background .15s}}.kbnSolutionNavCollapseButton:focus,.kbnSolutionNavCollapseButton:hover{transition-delay:0s!important}.kbnSolutionNavCollapseButton:focus,.kbnSolutionNavCollapseButton:hover,.kbnSolutionNav__sidebar:hover .kbnSolutionNavCollapseButton{left:224px;opacity:1}.kbnSolutionNav__sidebar:hover .kbnSolutionNavCollapseButton{transition-delay:.7s}.kbnSolutionNavCollapseButton:not(.kbnSolutionNavCollapseButton-isCollapsed){background-color:#1d1e24!important}.kbnSolutionNavCollapseButton-isCollapsed{align-items:flex-start;border-radius:0;bottom:0;height:100%;left:0!important;opacity:1!important;padding-top:32px;right:auto;top:0;transition-delay:0s!important;width:40px}",""]),e.exports=t},function(e,t,n){var a=n(250),i=n(1219);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,n){(t=n(251)(!1)).push([e.i,".kbnSolutionNavCollapseButton{left:232px;opacity:0;position:absolute;top:24px;z-index:2}@media screen and (prefers-reduced-motion:no-preference){.kbnSolutionNavCollapseButton{transition:opacity .15s,left .15s,background .15s}}.kbnSolutionNavCollapseButton:focus,.kbnSolutionNavCollapseButton:hover{transition-delay:0s!important}.kbnSolutionNavCollapseButton:focus,.kbnSolutionNavCollapseButton:hover,.kbnSolutionNav__sidebar:hover .kbnSolutionNavCollapseButton{left:224px;opacity:1}.kbnSolutionNav__sidebar:hover .kbnSolutionNavCollapseButton{transition-delay:.7s}.kbnSolutionNavCollapseButton:not(.kbnSolutionNavCollapseButton-isCollapsed){background-color:#fff!important}.kbnSolutionNavCollapseButton-isCollapsed{align-items:flex-start;border-radius:0;bottom:0;height:100%;left:0!important;opacity:1!important;padding-top:32px;right:auto;top:0;transition-delay:0s!important;width:40px}",""]),e.exports=t},,function(e,t,n){e.exports=n.p+"baad30acfe492601d08a0e839c9bb3f5.svg"},function(e,t,n){"use strict";var a=n(348);Object.defineProperty(t,"__esModule",{value:!0}),t.KibanaPageTemplateWithSolutionNav=t.KibanaPageTemplateInner=void 0;var i=a(n(82)),r=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=c(t);if(n&&n.has(e))return n.get(e);var a={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if("default"!==r&&Object.prototype.hasOwnProperty.call(e,r)){var o=i?Object.getOwnPropertyDescriptor(e,r):null;o&&(o.get||o.set)?Object.defineProperty(a,r,o):a[r]=e[r]}return a.default=e,n&&n.set(e,a),a}(n(4)),o=a(n(47)),s=n(32),l=n(1163);function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(c=function(e){return e?n:t})(e)}const u=({className:e,pageHeader:t,children:n,isEmptyState:a,pageSideBar:l,pageSideBarProps:c,...u})=>{let d;const[p,m]=(0,r.useState)();if((0,r.useEffect)((()=>{const e=document.querySelector('[data-test-subj="kibanaChrome"]');if(e){const t=e.querySelector('[data-test-subj="headerGlobalNav"]');m((null==t?void 0:t.offsetTop)+(null==t?void 0:t.offsetHeight))}}),[]),a&&t&&!n){const{iconType:e,pageTitle:a,description:i,rightSideItems:o}=t,l=a?r.default.createElement("h1",null,a):void 0,c=i?r.default.createElement("p",null,i):void 0;n=r.default.createElement(s.EuiPageTemplate.EmptyPrompt,{iconType:e,iconColor:"",title:l,body:c,actions:o})}else t&&(d=r.default.createElement(s.EuiPageTemplate.Header,t));let g;if(l){const e={...c};p&&(e.sticky={offset:p}),g=r.default.createElement(s.EuiPageTemplate.Sidebar,e,l)}const f=((e,t)=>(0,o.default)("kbnPageTemplate","",t||""))(0,e);return r.default.createElement(s.EuiPageTemplate,(0,i.default)({className:f,offset:0,minHeight:0},u),g,d,n)};t.KibanaPageTemplateInner=u;const d=(0,l.withSolutionNav)(u);t.KibanaPageTemplateWithSolutionNav=d},function(e,t,n){"use strict";var a=n(348);Object.defineProperty(t,"__esModule",{value:!0}),t.KibanaPageTemplateProvider=t.KibanaPageTemplateKibanaProvider=void 0;var i=a(n(4)),r=n(1162);t.KibanaPageTemplateProvider=({children:e,...t})=>i.default.createElement(r.NoDataConfigPageProvider,t,e),t.KibanaPageTemplateKibanaProvider=({children:e,...t})=>i.default.createElement(r.NoDataConfigPageKibanaProvider,t,e)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"SecuritySolutionTemplateWrapper",(function(){return Ke}));var a=n(82),i=n.n(a),r=n(4),o=n.n(r),s=n(33),l=n.n(s),c=n(32),u=n(83),d=n(1203),p=n(34),m=n(0),g=n(1075),f=n(521),b=n(546),y=n(77),h=n(240),v=n(1076),E=n(1),x=n(930),k=n(107),S=n(169),w=n(116);var j=n(2),O=n(9),I=n(183),T=n(89),C=n(938),M=n(47),N=n.n(M);const D=l()(c.EuiPanel).withConfig({displayName:"EuiPanelStyled",componentId:"sc-4kry1m-0"})(["position:fixed;top:95px;left:247px;bottom:0;width:340px;height:inherit;",""],(({$bottomOffset:e,theme:t})=>null!=e&&`\n      height: inherit;\n      bottom: ${e};\n      box-shadow:\n        // left\n        -${t.eui.euiSizeS} 0 ${t.eui.euiSizeS} -${t.eui.euiSizeS} rgb(0 0 0 / 15%),\n        // right\n        ${t.eui.euiSizeS} 0 ${t.eui.euiSizeS} -${t.eui.euiSizeS} rgb(0 0 0 / 15%),\n        // bottom inset to match timeline bar top shadow\n        inset 0 -${t.eui.euiSizeXS} ${t.eui.euiSizeXS} -${t.eui.euiSizeXS} rgb(0 0 0 / 6%);\n      `)),F=l.a.a.withConfig({displayName:"FlexLink",componentId:"sc-4kry1m-1"})(["display:flex;align-items:center;"]);var A=n(601);const _=({onClose:e,onOutsideClick:t,title:n,categories:a,items:i,bottomOffset:s})=>{const l=Object(c.useIsWithinMinBreakpoint)("l"),u=N()("eui-yScroll"),d=l?s:void 0,p=Object(r.useCallback)((t=>{t.key===c.keys.ESCAPE&&e()}),[e]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(c.EuiWindowEvent,{event:"keydown",handler:p}),o.a.createElement(c.EuiPortal,null,o.a.createElement(c.EuiFocusTrap,{autoFocus:!0},o.a.createElement(c.EuiOutsideClickDetector,{onOutsideClick:t},o.a.createElement(D,{className:u,hasShadow:!d,$bottomOffset:d,borderRadius:"none",paddingSize:"l","data-test-subj":"groupedNavPanel"},o.a.createElement(c.EuiFlexGroup,{direction:"column",gutterSize:"l",alignItems:"flexStart"},o.a.createElement(c.EuiFlexItem,null,o.a.createElement(c.EuiTitle,{size:"xs"},o.a.createElement("strong",null,n))),o.a.createElement(c.EuiFlexItem,null,o.a.createElement(c.EuiDescriptionList,null,a?o.a.createElement(P,{categories:a,items:i,onClose:e}):o.a.createElement(L,{items:i,onClose:e})))))))))},R=o.a.memo(_),P=({categories:e,items:t,onClose:n})=>{const a=new Map(t.map((e=>[e.id,e])));return o.a.createElement(o.a.Fragment,null,e.map((({label:e,linkIds:t})=>{const i=t.reduce(((e,t)=>{const n=a.get(t);return n&&e.push(n),e}),[]);return i.length?o.a.createElement(r.Fragment,{key:e},o.a.createElement(c.EuiTitle,{size:"xxxs"},o.a.createElement("h2",null,e)),o.a.createElement(c.EuiHorizontalRule,{margin:"s"}),o.a.createElement(L,{items:i,onClose:n}),o.a.createElement(c.EuiSpacer,{size:"l"})):null})))},L=({items:e,onClose:t})=>o.a.createElement(o.a.Fragment,null,e.map((({id:e,href:n,onClick:a,label:i,description:s,isBeta:l,betaOptions:u})=>o.a.createElement(r.Fragment,{key:e},o.a.createElement(c.EuiDescriptionListTitle,null,o.a.createElement(F,{"data-test-subj":`groupedNavPanelLink-${e}`,href:n,onClick:e=>{t(),a&&a(e)}},i,l&&o.a.createElement(A.a,{text:null==u?void 0:u.text}))),o.a.createElement(c.EuiDescriptionListDescription,null,s))))),q=l()(c.EuiListGroupItem).withConfig({displayName:"EuiListGroupItemStyled",componentId:"sc-1lker6g-0"})(["font-weight:",";&.solutionGroupedNavItem--isPrimary{font-weight:",";}&:focus,&:focus-within,&:hover,&.solutionGroupedNavItem--isActive{background-color:",";}.solutionGroupedNavItemButton:focus,.solutionGroupedNavItemButton:focus-within,.solutionGroupedNavItemButton:hover{background-color:",";}"],(({theme:e})=>e.eui.euiFontWeightRegular),(({theme:e})=>e.eui.euiFontWeightBold),(({theme:e})=>Object(c.transparentize)(e.eui.euiColorPrimary,.1)),(({theme:e})=>Object(c.transparentize)(e.eui.euiColorPrimary,.1))),B=e=>"render"in e,z=({...e})=>o.a.createElement("svg",i()({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),o.a.createElement("path",{fillRule:"evenodd",d:"M3 3.5h3v3H3v-3zm-1 0a1 1 0 011-1h3a1 1 0 011 1v3a1 1 0 01-1 1H3a1 1 0 01-1-1v-3zm1 7h3v3H3v-3zm-1 0a1 1 0 011-1h3a1 1 0 011 1v3a1 1 0 01-1 1H3a1 1 0 01-1-1v-3zm11-7h-3v3h3v-3zm-3-1a1 1 0 00-1 1v3a1 1 0 001 1h3a1 1 0 001-1v-3a1 1 0 00-1-1h-3zm0 8h3v3h-3v-3zm-1 0a1 1 0 011-1h3a1 1 0 011 1v3a1 1 0 01-1 1h-3a1 1 0 01-1-1v-3z",clipRule:"evenodd"})),$=({items:e,selectedId:t,footerItems:n=[],bottomOffset:a})=>{const i=Object(c.useIsWithinBreakpoints)(["xs","s"]),[s,l]=Object(r.useState)(null),u=Object(r.useRef)(null),d=e=>{u.current=e,l(e)},p=Object(r.useCallback)((()=>{u.current=null,l(null)}),[]),m=Object(r.useCallback)((()=>{const e=u.current;setTimeout((()=>{u.current===e&&p()}))}),[p]),g=Object(r.useMemo)((()=>[...e,...n].reduce(((e,t)=>((e=>!B(e))(t)&&t.items&&t.items.length>0&&(e[t.id]={title:t.label,panelItems:t.items,categories:t.categories}),e)),{})),[e,n]),f=Object(r.useMemo)((()=>{if(null==s||!g[s])return null;const{panelItems:e,title:t,categories:n}=g[s];return o.a.createElement(R,{onClose:p,onOutsideClick:m,items:e,title:t,categories:n,bottomOffset:a})}),[s,a,g,p,m]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(c.EuiFlexGroup,{gutterSize:"none",direction:"column"},o.a.createElement(c.EuiFlexItem,null,o.a.createElement(c.EuiFlexGroup,{gutterSize:"none",direction:"column"},o.a.createElement(c.EuiFlexItem,null,o.a.createElement(c.EuiListGroup,{gutterSize:"none"},o.a.createElement(U,{items:e,selectedId:t,activePanelNavId:s,isMobileSize:i,navItemsById:g,onOpenPanelNav:d}))),o.a.createElement(c.EuiFlexItem,{grow:!1},o.a.createElement(c.EuiListGroup,{gutterSize:"none"},o.a.createElement(U,{items:n,selectedId:t,activePanelNavId:s,isMobileSize:i,navItemsById:g,onOpenPanelNav:d})))))),f)},V=o.a.memo($),U=({items:e,selectedId:t,activePanelNavId:n,isMobileSize:a,navItemsById:i,onOpenPanelNav:r})=>o.a.createElement(o.a.Fragment,null,e.map((e=>o.a.createElement(G,{key:e.id,item:e,isSelected:t===e.id,isActive:n===e.id,hasPanelNav:!a&&e.id in i,onOpenPanelNav:r})))),H=({item:e,isSelected:t,isActive:n,hasPanelNav:a,onOpenPanelNav:s})=>{if(B(e))return o.a.createElement(r.Fragment,{key:e.id},e.render(t));const{id:l,href:u,label:d,onClick:p}=e,m=N()("solutionGroupedNavItem",{"solutionGroupedNavItem--isActive":n,"solutionGroupedNavItem--isPrimary":t}),g=N()("solutionGroupedNavItemButton");return o.a.createElement(c.EuiLink,{key:l,href:u,onClick:p,color:t?"primary":"text","data-test-subj":`groupedNavItemLink-${l}`},o.a.createElement(q,i()({className:m,color:t?"primary":"text",label:d,size:"s"},a?{extraAction:{className:g,color:n?"primary":"text",onClick:e=>{e.preventDefault(),e.stopPropagation(),s(l)},iconType:z,iconSize:"m","aria-label":"Toggle group nav","data-test-subj":`groupedNavItemButton-${l}`,alwaysShow:!0}}:{})))},G=o.a.memo(H),Q=({...e})=>o.a.createElement("svg",i()({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),o.a.createElement("path",{d:"M14.5 1.5L15 1.5L15 0.999999L14.5 0.999999L14.5 1.5ZM2.50018 7L2.15128 6.64186C1.98519 6.80366 1.95214 7.05842 2.07144 7.25725L2.50018 7ZM8.99958 13.5L8.74229 13.9287C8.93901 14.0468 9.19083 14.0158 9.35308 13.8536L8.99958 13.5ZM4.00018 9.5L3.57144 9.75725C3.59247 9.7923 3.61772 9.82465 3.64663 9.85355L4.00018 9.5ZM6.50018 12L6.14663 12.3536C6.17552 12.3824 6.20785 12.4077 6.24289 12.4287L6.50018 12ZM10.7526 8.71583L11.1263 9.04802L10.7526 8.71583ZM10.5 9.3802L10 9.3802L10.5 9.3802ZM7.28418 5.24741L7.61636 5.62111L7.28418 5.24741ZM6.61982 5.5L6.61982 6L6.61982 5.5ZM10.5 11.5857L11 11.5857L10.5 11.5857ZM10.207 12.2929L10.5605 12.6465L10.207 12.2929ZM14.5 2.599L15 2.599L14.5 2.599ZM13.401 1.5L13.401 0.999999L13.401 1.5ZM13.401 2L14.5 2L14.5 0.999999L13.401 0.999999L13.401 2ZM14 1.5L14 2.599L15 2.599L15 1.5L14 1.5ZM7.61636 5.62111L10.4114 3.13666L9.74701 2.38925L6.952 4.8737L7.61636 5.62111ZM4.44648 6L6.61982 6L6.61981 5L4.44648 5L4.44648 6ZM2.84909 7.35814L4.09758 6.14186L3.39977 5.42557L2.15128 6.64186L2.84909 7.35814ZM12.8634 5.58864L10.3789 8.38365L11.1263 9.04802L13.6108 6.253L12.8634 5.58864ZM10 9.3802L10 11.5857L11 11.5857L11 9.3802L10 9.3802ZM9.85352 11.9393L8.64608 13.1464L9.35308 13.8536L10.5605 12.6465L9.85352 11.9393ZM6.85374 11.6464L4.35374 9.14645L3.64663 9.85355L6.14663 12.3536L6.85374 11.6464ZM4.42893 9.24275L2.92893 6.74275L2.07144 7.25725L3.57144 9.75725L4.42893 9.24275ZM9.25687 13.0713L6.75748 11.5713L6.24289 12.4287L8.74229 13.9287L9.25687 13.0713ZM10.3789 8.38365C10.1348 8.65823 10 9.01283 10 9.3802L11 9.3802C11 9.25774 11.045 9.13954 11.1263 9.04802L10.3789 8.38365ZM4.44648 5C4.05544 5 3.67986 5.1527 3.39977 5.42557L4.09758 6.14186C4.19094 6.0509 4.31614 6 4.44648 6L4.44648 5ZM6.952 4.8737C6.86047 4.95506 6.74227 5 6.61981 5L6.61982 6C6.98719 6 7.34178 5.86518 7.61636 5.62111L6.952 4.8737ZM10 11.5857C10 11.7183 9.94731 11.8455 9.85352 11.9393L10.5605 12.6465C10.8419 12.3652 11 11.9836 11 11.5857L10 11.5857ZM14 2.599C14 3.70112 13.5956 4.76491 12.8634 5.58864L13.6108 6.253C14.5057 5.24622 15 3.94603 15 2.599L14 2.599ZM13.401 0.999999C12.054 0.999999 10.7538 1.49433 9.74701 2.38925L10.4114 3.13666C11.2351 2.40445 12.2989 2 13.401 2L13.401 0.999999Z"}),o.a.createElement("path",{d:"M2.5 10.5L1.5 12.5V14.5H3.5L5.5 13.5",strokeLinecap:"round",strokeLinejoin:"round"}),o.a.createElement("path",{d:"M1 14.1667L2.5 10.5L5.5 13.5L1.83333 15H1V14.1667Z"}),o.a.createElement("circle",{cx:"10",cy:"6",r:"1"}),o.a.createElement("path",{d:"M5.5 10.5L8 8",strokeLinecap:"round",strokeLinejoin:"round"}));var W=n(37),K=n(95),Y=n(94);const J=["/cases/configure","/administration","/rules/create","/get_started","/explore","/dashboards","/manage","/cloud_security_posture*"],X=()=>{const e=Object(f.b)(),{indicesExist:t,dataViewId:n}=Object(Y.d)(K.SourcererScopeName.timeline),a=Object(y.k)().services.application.capabilities.siem.show,i=Object(r.useMemo)((()=>a&&(t||null===n)),[t,n,a]);return Object(r.useCallback)((t=>!!i&&((e,t)=>{const n=Object(O.c)().map((e=>e.path));return!(t?n:J).find((t=>Object(W.matchPath)(e,t)))})(t,e)),[i,e])},Z=()=>{const{pathname:e}=Object(W.useLocation)(),t=X();return[Object(r.useMemo)((()=>t(e)),[e,t])]};var ee=n(170),te=n(351);const ne=({isSelected:e,title:t})=>o.a.createElement(T.k,{deepLinkId:j.a.landing,color:e?"primary":"text"},o.a.createElement(c.EuiListGroupItem,{label:t.toUpperCase(),size:"xs",color:e?"primary":"text",iconType:Q,iconProps:{color:e?"primary":"text"}}),o.a.createElement(c.EuiHorizontalRule,{margin:"xs"})),ae=o.a.memo(ne),ie=()=>{const e=Object(C.a)(),t=(()=>{const e=Object(T.o)();return Object(r.useCallback)((t=>{return t.id===j.a.landing?{id:(n=t).id,render:e=>o.a.createElement(ae,{isSelected:e,title:n.title})}:(t=>({id:t.id,label:t.title,...e({deepLinkId:t.id}),...t.categories&&t.categories.length>0?{categories:t.categories}:{},...t.links&&t.links.length>0?{items:t.links.reduce(((t,n)=>(n.disabled||t.push({id:n.id,label:n.title,description:n.description,isBeta:n.isBeta,betaOptions:n.betaOptions,...e({deepLinkId:n.id})}),t)),[])}:{}}))(t);var n}),[e])})();return Object(r.useMemo)((()=>{const n=[],a=[];return e.forEach((e=>{var i;e.disabled||((i=e.id)===j.a.landing||i===j.a.administration?a.push(t(e)):n.push(t(e)))})),[n,a]}),[e,t])},re=()=>{const[e,t]=ie(),n=(()=>{const[{pageName:e}]=Object(I.a)();return Object(r.useMemo)((()=>{var t;const[n]=Object(O.a)(e);return null!==(t=null==n?void 0:n.id)&&void 0!==t?t:""}),[e])})(),a=Object(ee.a)(),[i]=Z(),s=i||a?te.b:void 0;return 0===e.length&&0===t.length?o.a.createElement(c.EuiLoadingSpinner,{size:"m","data-test-subj":"sideNavLoader"}):o.a.createElement(V,{items:e,footerItems:t,selectedId:n,bottomOffset:s})},oe=m.i18n.translate("xpack.securitySolution.navigation.mainLabel",{defaultMessage:"Security"});var se=n(904);const le=()=>{const[e]=Object(I.a)(),{chrome:t,application:{getUrlForApp:n,navigateToUrl:a}}=Object(y.k)().services,{detailName:i,flowTarget:s,pageName:l,pathName:c,search:u,state:d,tabName:m}=e,j=[...Object(k.a)("kubernetesEnabled")?[]:["kubernetes"]],O=Object(p.omit)(j,g.a),T=Object(se.a)();return Object(r.useEffect)((()=>{(c||l)&&T({detailName:i,flowTarget:s,navTabs:O,pageName:l,pathName:c,search:u,state:d,tabName:m},t,a)}),[t,l,c,u,d,i,s,m,n,a,O,T]),(({navTabs:e,pageName:t})=>{const n=Object(f.b)(),a=Object(r.useCallback)((()=>{var n,a;return null!==(n=null===(a=e[t])||void 0===a?void 0:a.id)&&void 0!==n?n:""}),[t,e]),[i,s]=Object(r.useState)(a());Object(r.useEffect)((()=>{const e=a();e!==i&&s(e)}),[t,e,a,i]);const l=(({navTabs:e,selectedTabId:t})=>{const{navigateTo:n,getAppUrl:a}=Object(h.j)(),i=Object(S.a)(),o=Object(r.useCallback)((e=>{const{id:r,name:o,disabled:s}=e,l=t===r,c=Object(f.a)(e.id,i),u=a({deepLinkId:r,path:c});return{"data-href":u,"data-test-subj":`navigation-${r}`,disabled:s,href:u,id:r,isSelected:l,name:o,onClick:e=>{e.preventDefault(),n({deepLinkId:r,path:c})}}}),[a,n,t,i]),s=function(e){const t=Object(y.i)().read,n=Object(x.a)(),a=Object(w.a)().endpointPrivileges.canReadActionsLogManagement,i=Object(k.a)("policyListEnabled"),o=Object(b.b)().services.application.capabilities;return Object(r.useMemo)((()=>o.siem.show?[{id:"main",name:"",items:[e[E.uc.landing]]},{...g.b[v.a.dashboards],items:[e[E.uc.overview],e[E.uc.detectionAndResponse],e[E.uc.cloudSecurityPostureDashboard],e[E.uc.entityAnalytics],...null!=e[E.uc.kubernetes]?[e[E.uc.kubernetes]]:[]]},{...g.b[v.a.detect],items:[e[E.uc.alerts],e[E.uc.rules],e[E.uc.exceptions]]},{...g.b[v.a.findings],items:[e[E.uc.cloudSecurityPostureFindings]]},{...g.b[v.a.explore],items:[e[E.uc.hosts],e[E.uc.network],...null!=e[E.uc.users]?[e[E.uc.users]]:[]]},{...g.b[v.a.intelligence],items:[e[E.uc.threatIntelligenceIndicators]]},{...g.b[v.a.investigate],items:t?[e[E.uc.timelines],e[E.uc.case]]:[e[E.uc.timelines]]},{...g.b[v.a.manage],items:[e[E.uc.endpoints],...i?[e[E.uc.policies]]:[],e[E.uc.trustedApps],e[E.uc.eventFilters],...n?[e[E.uc.hostIsolationExceptions]]:[],e[E.uc.blocklist],...a?[e[E.uc.responseActionsHistory]]:[],e[E.uc.cloudSecurityPostureBenchmarks]]}]:t?[{...g.b[v.a.investigate],items:[e[E.uc.case]]}]:[]),[o.siem.show,e,t,n,a,i])}(e);return Object(r.useMemo)((()=>s.map((e=>({...e,items:e.items.map((e=>o(e)))})))),[o,s])})({navTabs:e,selectedTabId:i});return{canBeCollapsed:!0,name:oe,icon:"logoSecurity",...n?{children:o.a.createElement(re,null),closeFlyoutButtonPosition:"inside"}:{items:l}}})({navTabs:O,pageName:l})};var ce=n(79),ue=n(108),de=n(86);const pe=()=>Object(ue.createSelector)(de.b.selectTimeline,(e=>{var t,n,a,i;return{activeTab:null!==(t=null==e?void 0:e.activeTab)&&void 0!==t?t:ce.m.query,status:null!==(n=null==e?void 0:e.status)&&void 0!==n?n:ce.l.draft,show:null!==(a=null==e?void 0:e.show)&&void 0!==a&&a,updated:null!==(i=null==e?void 0:e.updated)&&void 0!==i?i:void 0}}));var me=n(81),ge=n(287),fe=n(866);const be=l.a.div.withConfig({displayName:"StyledStickyWrapper",componentId:"sc-jbkt6d-0"})(["position:sticky;z-index:",";"],(e=>e.theme.eui.euiZHeaderBelowDataGrid)),ye=o.a.memo((()=>{const{globalKQLHeaderPortalNode:e}=Object(fe.a)();return o.a.createElement(be,{id:"securitySolutionStickyKQL"},o.a.createElement(ge.b,{node:e}))}));ye.displayName="GlobalKQLHeader";var he=n(78),ve=n(143),Ee=n(324);const xe=m.i18n.translate("xpack.securitySolution.timeline.autosave.warning.title",{defaultMessage:"Auto-save disabled until refresh"}),ke=m.i18n.translate("xpack.securitySolution.timeline.autosave.warning.description",{defaultMessage:"Another user has made changes to this timeline. Any changes you make will not be auto-saved until you have refreshed this timeline to absorb those changes."}),Se=m.i18n.translate("xpack.securitySolution.timeline.autosave.warning.refresh.title",{defaultMessage:"Refresh timeline"}),we=()=>{const e=Object(he.useDispatch)(),t=Object(Ee.g)()[1],{timelineId:n,newTimelineModel:a}=Object(me.a)(de.b.autoSaveMsgSelector),i=Object(r.useCallback)((()=>{null!=n&&null!=a&&(e(de.a.updateTimeline({id:n,timeline:a})),e(de.a.updateAutoSaveMsg({timelineId:null,newTimelineModel:null})),e(Object(ve.setTimelineRangeDatePicker)({from:Object(p.getOr)(0,"dateRange.start",a),to:Object(p.getOr)(0,"dateRange.end",a)})))}),[e,a,n]),s=Object(r.useMemo)((()=>o.a.createElement(o.a.Fragment,null,o.a.createElement("p",null,ke),o.a.createElement(c.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},o.a.createElement(c.EuiFlexItem,{grow:!1},o.a.createElement(c.EuiButton,{size:"s",onClick:i},Se))))),[i]);return null!=n&&null!=a&&t({type:"addToaster",toast:{id:"AutoSaveWarningMsg",title:xe,color:"warning",iconType:"alert",toastLifeTimeMs:1e4,text:s}}),null};we.displayName="AutoSaveWarningMsgComponent";const je=o.a.memo(we);var Oe=n(123),Ie=n(901);const Te=o.a.memo((({showTimelineHeaderPanel:e,timelineId:t})=>o.a.createElement("div",{className:Oe.e,"data-test-subj":"flyoutBottomBar"},e&&o.a.createElement(Ie.b,{timelineId:t}))));Te.displayName="FlyoutBottomBar";var Ce=n(141),Me=n(585);const Ne=m.i18n.translate("xpack.securitySolution.timeline.flyout.pane.timelinePropertiesAriaLabel",{defaultMessage:"Timeline Properties"});var De=n(292),Fe=n(542);const Ae=l()(c.EuiFlyout).withConfig({displayName:"StyledEuiFlyout",componentId:"sc-jz8ju6-0"})(["animation:none;min-width:150px;z-index:",";"],(({theme:e})=>e.eui[Ce.A])),_e=Object(s.createGlobalStyle)([".indexPatternFieldEditorMaskOverlay{","}"],(({theme:e})=>`\n    z-index: ${e.eui.euiZLevel5};\n  `)),Re=({timelineId:e,visible:t=!0})=>{const n=Object(he.useDispatch)(),a=Object(r.useCallback)((()=>{n(de.a.showTimeline({id:e,show:!1})),Object(Oe.i)()}),[n,e]);return Object(r.useEffect)((()=>{t?document.body.classList.add(Ce.z):document.body.classList.remove(Ce.z)}),[t]),o.a.createElement("div",{"data-test-subj":"flyout-pane",style:{display:t?"block":"none"}},o.a.createElement(Ae,{"aria-label":Ne,className:"timeline-flyout","data-test-subj":"eui-flyout",hideCloseButton:!0,onClose:a,size:"100%",ownFocus:!1,style:{display:t?"block":"none"}},o.a.createElement(_e,null),o.a.createElement(Me.a,{renderCellValue:Fe.a,rowRenderers:De.b,timelineId:e})))},Pe=o.a.memo(Re);Pe.displayName="Pane";var Le=n(104),qe=n(14);const Be=({timelineId:e,onAppLeave:t})=>{const n=Object(r.useMemo)((()=>pe()),[]),{show:a}=Object(me.a)((t=>n(t,e))),[i,s]=Object(r.useState)(!0),[l,u]=Object(r.useState)(!0),d=Object(r.useRef)(null),p=Object(r.useRef)(null),m=Object(r.useCallback)((()=>{a&&!1===i&&s(!0)}),[a,i]),g=Object(r.useCallback)((e=>{s(!1),e.target.classList.contains("kbnSearchBar")&&(p.current=e.target,u((e=>!e)),window.setTimeout((()=>{null!==p.current&&p.current.focus()}),0))}),[]);return((e,t)=>{const n=Object(he.useDispatch)(),{overlays:a,application:i}=Object(y.k)().services,o=X(),s=Object(W.useHistory)(),l=Object(r.useMemo)((()=>pe()),[]),{status:c,updated:u}=Object(me.a)((t=>l(t,e))),d=Object(r.useCallback)((()=>{n(de.a.showTimeline({id:e,show:!0})),n(de.a.setActiveTabTimeline({id:e,activeTab:Le.f.query})),n(de.a.toggleModalSaveTimeline({id:e,showModalSaveTimeline:!0}))}),[n,e]);Object(r.useEffect)((()=>{const e=s.block((t=>{const n=t.pathname.replace(E.v,"");if(!o(n)&&c===Le.e.draft&&null!=u)return async function(){await(null==a?void 0:a.openConfirm(qe.d,{title:qe.e,"data-test-subj":"appLeaveConfirmModal"}))?(e(),i.navigateToUrl(t.pathname+t.hash+t.search,{state:t.state})):d()}(),!1}));return()=>{e()}}),[s,i,a,d,o,c,u]),Object(r.useEffect)((()=>(t(((e,t)=>(null!=t?t:"").includes(E.p)||c!==Le.e.draft||null==u?e.default():e.confirm(qe.d,qe.e,d))),()=>{t((e=>e.default()))})))})(e,t),Object(r.useEffect)((()=>(null!=p.current&&(null!==d.current&&p.current.removeEventListener("blur",d.current),p.current.addEventListener("blur",m),d.current=m),()=>{null!=p.current&&null!==d.current&&p.current.removeEventListener("blur",d.current)})),[m,l]),o.a.createElement(c.EuiOutsideClickDetector,{onOutsideClick:g},o.a.createElement(o.a.Fragment,null,o.a.createElement(c.EuiFocusTrap,{disabled:!i},o.a.createElement(Pe,{timelineId:e,visible:a})),o.a.createElement(Te,{showTimelineHeaderPanel:!a,timelineId:e})))};Be.displayName="FlyoutComponent";const ze=o.a.memo(Be);ze.displayName="Flyout";var $e=n(112),Ve=n(267),Ue=n(281);const He="timeline-bottom-bar",Ge=o.a.memo((()=>{(()=>{const{search:e,pathname:t}=Object(W.useLocation)(),[n,a]=Object(r.useState)(!1),{spaces:i}=Object(y.k)().services,o=Object(r.useMemo)((()=>de.b.getTimelineByIdSelector()),[]),{resolveTimelineConfig:s,savedObjectId:l,show:c,activeTab:u,graphEventId:d}=Object(me.a)((e=>{var t;return null!==(t=o(e,ce.j.active))&&void 0!==t?t:$e.b})),p=Object(r.useCallback)((()=>{var r,o;const p=new URLSearchParams(e),m=null!==(r=p.get(Ue.a.timeline))&&void 0!==r?r:void 0,g={id:null!=l?l:"",isOpen:!!c,activeTab:u,graphEventId:d};let f=g;try{var b;f=null!==(b=Object(Ve.a)(m))&&void 0!==b?b:g}catch(e){}if(n||!i||"aliasMatch"!==(null==s?void 0:s.outcome)||null==(null==s?void 0:s.alias_target_id))return null;const y=null!==(o=s.alias_target_id)&&void 0!==o?o:"",h={...f,id:y},v=Object(Ve.c)(h);p.set(Ue.a.timeline,v);const E=`${t}?${p.toString()}`;i.ui.redirectLegacyUrl({path:E,aliasPurpose:s.alias_purpose,objectNoun:Ue.a.timeline}),a(!0)}),[u,d,n,t,s,l,e,c,i]);Object(r.useEffect)((()=>{p()}),[p])})();const{onAppLeave:e}=Object(b.b)().services;return o.a.createElement(o.a.Fragment,null,o.a.createElement(je,null),o.a.createElement(ze,{timelineId:ce.j.active,onAppLeave:e}))})),Qe={className:He,"data-test-subj":"timeline-bottom-bar-container"},We=l()(d.KibanaPageTemplate).withConfig({displayName:"StyledKibanaPageTemplate",componentId:"sc-1xdm1q0-0"})([".","{animation:'none !important';background:",";color:inherit;transform:",";."," &{transform:none;}}"],He,(({theme:e})=>e.eui.euiColorEmptyShade),(({$isShowingTimelineOverlay:e})=>e?"none":"translateY(calc(100% - 50px))"),u.d),Ke=o.a.memo((({children:e,...t})=>{const n=le(),a=Object(ee.a)(),[s]=Z(),l=Object(r.useMemo)((()=>pe()),[]),{show:u}=Object(me.a)((e=>l(e,ce.j.active))),p=Object(f.b)(),m=s||a||p,{colorMode:g}=Object(c.useEuiTheme)(),b=(()=>{const[{pageName:e}]=Object(I.a)(),{indicesExist:t}=Object(Y.d)(),n=(a=e,[j.a.hosts,j.a.network,j.a.timelines,j.a.overview,j.a.users,j.a.kubernetes].includes(a)&&!t);var a;const[i,o]=Object(r.useState)(n);return Object(r.useEffect)((()=>{o(!!n)}),[n]),i})()||t.isEmptyState;return o.a.createElement(We,i()({$addBottomPadding:m,$isShowingTimelineOverlay:u,paddingSize:"none",solutionNav:n,restrictWidth:!!b&&950},t),o.a.createElement(ye,null),o.a.createElement(d.KibanaPageTemplate.Section,{className:"securityPageWrapper","data-test-subj":"pageContainer",paddingSize:"l",alignment:b?"center":"top",component:"div"},e),s&&o.a.createElement(d.KibanaPageTemplate.BottomBar,Qe,o.a.createElement(c.EuiThemeProvider,{colorMode:g},o.a.createElement(Ge,null))))}));Ke.displayName="SecuritySolutionTemplateWrapper"}])]);