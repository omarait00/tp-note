/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[32],{1295:function(e,t,a){"use strict";a.r(t),a.d(t,"EndpointPolicyCreateExtension",(function(){return M}));var n=a(4),i=a.n(n),o=a(32),l=a(35),c=a(33),r=a.n(c),s=a(13),u=a(0);const d=u.i18n.translate("xpack.securitySolution.createPackagePolicy.stepConfigure.endpointDropdownOptionNGAV",{defaultMessage:"Next-Generation Antivirus (NGAV)"}),p=u.i18n.translate("xpack.securitySolution.createPackagePolicy.stepConfigure.endpointDropdownOptionNGAVNote",{defaultMessage:"Note: advanced protections require a platinum license level."}),m=u.i18n.translate("xpack.securitySolution.createPackagePolicy.stepConfigure.endpointDropdownOptionEDREssential",{defaultMessage:"Essential EDR (Endpoint Detection & Response)"}),E=u.i18n.translate("xpack.securitySolution.createPackagePolicy.stepConfigure.endpointDropdownOptionEDRComplete",{defaultMessage:"Complete EDR (Endpoint Detection & Response)"}),g=u.i18n.translate("xpack.securitySolution.createPackagePolicy.stepConfigure.endpointDropdownOptionEDRNote",{defaultMessage:"Note: advanced protections require a platinum license, and full response capabilities require an enterprise license."}),y=u.i18n.translate("xpack.securitySolution.createPackagePolicy.stepConfigure.endpointDropdownOption",{defaultMessage:"Traditional Endpoints (desktops, laptops, virtual machines)"}),f=u.i18n.translate("xpack.securitySolution.createPackagePolicy.stepConfigure.cloudDropdownOption",{defaultMessage:"Cloud Workloads (Linux servers or Kubernetes environments)"}),k=u.i18n.translate("xpack.securitySolution.createPackagePolicy.stepConfigure.cloudEventFiltersInteractiveOnly",{defaultMessage:"Interactive only"}),P=u.i18n.translate("xpack.securitySolution.createPackagePolicy.stepConfigure.cloudEventFiltersAllEvents",{defaultMessage:"All events"}),v="endpoint_policy_create_extension",C={NGAV:{label:d,note:p},EDREssential:{label:m,note:g},EDRComplete:{label:E,note:g}},S={INTERACTIVE_ONLY:k,ALL_EVENTS:P},h=[{value:"endpoint",text:y},{value:"cloud",text:f}],x=r.a.div.withConfig({displayName:"HelpTextWithPadding",componentId:"sc-1vzeqgh-0"})(["padding-left:",";"],(e=>e.theme.eui.euiSizeL)),M=Object(n.memo)((({newPolicy:e,onChange:t})=>{const a=Object(s.b)().isPlatinumPlus(),c=Object(s.b)().isEnterprise(),[r,u]=Object(n.useState)("NGAV"),[d,p]=Object(n.useState)("INTERACTIVE_ONLY"),[m,E]=Object(n.useState)("endpoint"),g=Object(n.useRef)(!0),y="NGAV"===r&&!a||"NGAV"!==r&&!c;Object(n.useEffect)((()=>{g.current&&t({isValid:!1,updatedPolicy:{...e,name:"",inputs:[{enabled:!0,streams:[],type:"ENDPOINT_INTEGRATION_CONFIG",config:{_config:{value:{type:"endpoint",endpointConfig:{preset:"NGAV"}}}}}]}})}),[t,e]),Object(n.useEffect)((()=>{g.current?g.current=!1:t({isValid:!0,updatedPolicy:{...e,inputs:[{...e.inputs[0],config:{_config:{value:{type:m,..."cloud"===m?{eventFilters:{nonInteractiveSession:"INTERACTIVE_ONLY"===d}}:{endpointConfig:{preset:r}}}}}}]}})}),[m,d,r,t,e]);const f=Object(n.useCallback)((e=>{var t;E(null==e||null===(t=e.target)||void 0===t?void 0:t.value)}),[]),k=Object(n.useCallback)((e=>{p(e.target.value)}),[]),P=Object(n.useCallback)((e=>{u(e.target.value)}),[]),M=Object(n.useCallback)((e=>({id:`${v}_endpoint_preset_${e}`,label:C[e].label,value:e,checked:r===e,onChange:P})),[r,P]),b=Object(n.useCallback)((e=>({id:`${v}_cloud_event_${e}`,label:S[e],value:e,checked:d===e,onChange:k})),[d,k]);return i.a.createElement(o.EuiForm,{component:"form"},i.a.createElement(o.EuiTitle,{size:"s"},i.a.createElement("h3",null,i.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.createPackagePolicy.stepConfigure.enablePrevention",defaultMessage:"Select configuration settings"}))),i.a.createElement(o.EuiSpacer,{size:"m"}),i.a.createElement(o.EuiText,{size:"s"},i.a.createElement("p",null,i.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.createPackagePolicy.stepConfigure.quickSettingsTranslation",defaultMessage:"Use quick settings to configure the integration to {environments}. You can make configuration changes after you create the integration.",values:{environments:i.a.createElement("strong",null,i.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.endpoint.ingestManager.createPackagePolicy.environments",defaultMessage:"protect your traditional endpoints or dynamic cloud environments"}))}}))),i.a.createElement(o.EuiSpacer,{size:"m"}),i.a.createElement(o.EuiFormRow,{fullWidth:!0,label:i.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.createPackagePolicy.stepConfigure.selectEnvironmentTextTranslation",defaultMessage:"Select the type of environment you want to protect:"})},i.a.createElement(o.EuiSelect,{id:"selectIntegrationTypeId","data-test-subj":"selectIntegrationTypeId",options:h,value:m,onChange:f,fullWidth:!0})),"endpoint"===m?i.a.createElement(i.a.Fragment,null,i.a.createElement(o.EuiSpacer,{size:"m"}),i.a.createElement(o.EuiFormRow,{fullWidth:!0,helpText:i.a.createElement(x,null,i.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.createPackagePolicy.stepConfigure.packagePolicyTypeEndpointNGAV",defaultMessage:"Machine learning malware, ransomware, memory threat, malicious behavior, and credential theft preventions, plus process telemetry"}))},i.a.createElement(o.EuiRadio,M("NGAV"))),i.a.createElement(o.EuiSpacer,{size:"s"}),i.a.createElement(o.EuiFormRow,{fullWidth:!0,helpText:i.a.createElement(x,null,i.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.createPackagePolicy.stepConfigure.packagePolicyTypeEndpointEDREssential",defaultMessage:"Everything in NGAV, plus file and network telemetry"}))},i.a.createElement(o.EuiRadio,M("EDREssential"))),i.a.createElement(o.EuiSpacer,{size:"s"}),i.a.createElement(o.EuiFormRow,{fullWidth:!0,helpText:i.a.createElement(x,null,i.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.createPackagePolicy.stepConfigure.packagePolicyTypeEndpointEDRComplete",defaultMessage:"Everything in Essential EDR, plus full telemetry"}))},i.a.createElement(o.EuiRadio,M("EDRComplete"))),y&&i.a.createElement(i.a.Fragment,null,i.a.createElement(o.EuiSpacer,{size:"m"}),i.a.createElement(o.EuiCallOut,{iconType:"iInCircle"},i.a.createElement(o.EuiText,{size:"s"},i.a.createElement("p",null,C[r].note," ",i.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.createPackagePolicy.stepConfigure.seeDocumentation",defaultMessage:"See {documentation} for more information.",values:{documentation:i.a.createElement(o.EuiLink,{href:"https://www.elastic.co/guide/en/security/current/configure-endpoint-integration-policy.html",target:"_blank"},i.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.endpoint.ingestManager.createPackagePolicy.seeDocumentationLink",defaultMessage:"documentation"}))}})))))):i.a.createElement(i.a.Fragment,null,i.a.createElement(o.EuiSpacer,{size:"m"}),i.a.createElement(o.EuiText,{color:"subdued",size:"s"},i.a.createElement("p",null,i.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.createPackagePolicy.stepConfigure.interactiveSessionSuggestionTranslation",defaultMessage:"To reduce data ingestion volume, select Interactive only"}))),i.a.createElement(o.EuiSpacer,{size:"s"}),i.a.createElement(o.EuiFormRow,{fullWidth:!0,helpText:i.a.createElement(x,null,i.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.createPackagePolicy.stepConfigure.packagePolicyTypeAllEventsInfo",defaultMessage:"Monitors and collects data from all system executions, including those launched by daemon processes, such as {nginx}, {postgres} and {cron}. {recommendation}",values:{nginx:i.a.createElement(o.EuiCode,null,"nginx"),postgres:i.a.createElement(o.EuiCode,null,"postgres"),cron:i.a.createElement(o.EuiCode,null,"cron"),recommendation:i.a.createElement("em",null,i.a.createElement("strong",null,i.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.createPackagePolicy.stepConfigure.packagePolicyTypeAllEventsInfoRecommendation",defaultMessage:"Recommended for Cloud Workload Protection, auditing and forensics use cases."})))}}))},i.a.createElement(o.EuiRadio,b("ALL_EVENTS"))),i.a.createElement(o.EuiSpacer,{size:"s"}),i.a.createElement(o.EuiFormRow,{fullWidth:!0,helpText:i.a.createElement(x,null,i.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.createPackagePolicy.stepConfigure.packagePolicyTypeInteractiveOnlyInfo",defaultMessage:"Captures live system interactions initiated by users through programs like {ssh} or {telnet}. {recommendation}",values:{ssh:i.a.createElement(o.EuiCode,null,"ssh"),telnet:i.a.createElement(o.EuiCode,null,"telnet"),recommendation:i.a.createElement("em",null,i.a.createElement("strong",null,i.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.createPackagePolicy.stepConfigure.packagePolicyTypeInteractiveOnlyInfoRecommendation",defaultMessage:"Recommended for auditing and forensic use cases."})))}}))},i.a.createElement(o.EuiRadio,b("INTERACTIVE_ONLY")))),i.a.createElement(o.EuiSpacer,{size:"xl"}))}),((e,t)=>e.newPolicy.name===t.newPolicy.name));M.displayName="EndpointPolicyCreateExtension"}}]);