/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[8],{101:function(e,t,n){"use strict";n.d(t,"c",(function(){return m})),n.d(t,"d",(function(){return p})),n.d(t,"e",(function(){return f})),n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return h}));var a=n(58),s=n.n(a),o=n(4),i=n.n(o),r=n(35),l=n(77),c=n(87),u=n(1081),d=n(1155);const m=i.a.memo((({value:e,dateFormat:t=Object(l.h)()})=>i.a.createElement(i.a.Fragment,null,s.a.tz(e,Object(l.n)()).format(t))));m.displayName="PreferenceFormattedDate";const p=({value:e})=>{if(null==e)return Object(c.f)(e);const t=Object(d.a)(e);if(!t.isValid())return Object(c.f)(e);const n=t.toDate();return i.a.createElement(m,{value:n})};p.displayName="PreferenceFormattedDateFromPrimitive";const g=e=>Array.isArray(e)&&"P1DT"===e[0]&&2===e.length,f=i.a.memo((({value:e})=>{const[t]=Object(l.q)("dateFormat:scaled"),n=Array.isArray(t)?t.find(g):null,a=Array.isArray(n)&&2===n.length?n[1]:"YYYY-MM-DD";return i.a.createElement(m,{dateFormat:a,value:e})}));f.displayName="PreferenceFormattedP1DTDate";const b=i.a.memo((({value:e,fieldName:t,className:n="",dateFormat:a})=>{if(null==e)return Object(c.f)(e);const s=Object(d.a)(e);return s.isValid()?i.a.createElement(u.a,{date:s.toDate(),fieldName:t,className:n},i.a.createElement(m,{value:s.toDate(),dateFormat:a})):Object(c.f)(e)}));b.displayName="FormattedDate";const h=i.a.memo((({value:e,dateFormat:t,tooltipFieldName:n,tooltipAnchorClassName:a,relativeThresholdInHrs:o=1})=>{if(null==e)return Object(c.f)(e);const l=Object(d.a)(e);if(!l.isValid())return Object(c.f)(e);const p=l.toDate(),g=s()(p).add(o,"hours").isBefore(new Date);return i.a.createElement(u.a,{date:p,fieldName:n,className:a},g?i.a.createElement(m,{"data-test-subj":"preference-time",value:p,dateFormat:t}):i.a.createElement(r.FormattedRelative,{"data-test-subj":"relative-time",value:p}))}));h.displayName="FormattedRelativePreferenceDate"},105:function(e,t,n){"use strict";n.d(t,"h",(function(){return o})),n.d(t,"k",(function(){return i})),n.d(t,"n",(function(){return r})),n.d(t,"q",(function(){return l})),n.d(t,"m",(function(){return c})),n.d(t,"o",(function(){return u})),n.d(t,"l",(function(){return d})),n.d(t,"p",(function(){return m})),n.d(t,"s",(function(){return p})),n.d(t,"i",(function(){return g})),n.d(t,"j",(function(){return f})),n.d(t,"g",(function(){return b})),n.d(t,"r",(function(){return h})),n.d(t,"u",(function(){return E})),n.d(t,"v",(function(){return v})),n.d(t,"t",(function(){return y})),n.d(t,"f",(function(){return j})),n.d(t,"b",(function(){return S})),n.d(t,"c",(function(){return O})),n.d(t,"e",(function(){return k})),n.d(t,"d",(function(){return x})),n.d(t,"a",(function(){return C}));var a=n(1),s=n(522);const o=`${a.Ob}/:tabName(${s.a.endpoints})`,i=`${a.Ob}/:tabName(${s.a.policies})`,r=`${a.Ob}/:tabName(${s.a.policies})/:policyId/settings`,l=`${a.Ob}/:tabName(${s.a.policies})/:policyId/trustedApps`,c=`${a.Ob}/:tabName(${s.a.policies})/:policyId/eventFilters`,u=`${a.Ob}/:tabName(${s.a.policies})/:policyId/hostIsolationExceptions`,d=`${a.Ob}/:tabName(${s.a.policies})/:policyId/blocklists`,m=`${a.Ob}/:tabName(${s.a.policies})/:policyId`,p=`${a.Ob}/:tabName(${s.a.trustedApps})`,g=`${a.Ob}/:tabName(${s.a.eventFilters})`,f=`${a.Ob}/:tabName(${s.a.hostIsolationExceptions})`,b=`${a.Ob}/:tabName(${s.a.blocklist})`,h=`${a.Ob}/:tabName(${s.a.responseActionsHistory})`,E="management",v="policyDetails",y="endpoints",j=[10,20,50],S=0,O=10,k="desc",x="created_at",C=1e4},1081:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(32),s=n(35),o=n(43),i=n.n(o),r=n(4),l=n.n(r);const c=l.a.memo((({children:e,date:t,fieldName:n,className:o=""})=>l.a.createElement(a.EuiToolTip,{"data-test-subj":"localized-date-tool-tip",anchorClassName:o,content:l.a.createElement(a.EuiFlexGroup,{"data-test-subj":"dates-container",direction:"column",gutterSize:"none"},null!=n?l.a.createElement(a.EuiFlexItem,{grow:!1},l.a.createElement("span",{"data-test-subj":"field-name"},n)):null,l.a.createElement(a.EuiFlexItem,{grow:!1},l.a.createElement(s.FormattedRelative,{"data-test-subj":"humanized-relative-date",value:i.a.utc(t).toDate()})),l.a.createElement(a.EuiFlexItem,{"data-test-subj":"with-day-of-week",grow:!1},i.a.utc(t).local().format("llll")),l.a.createElement(a.EuiFlexItem,{"data-test-subj":"with-time-zone-offset-in-hours",grow:!1},i()(t).format()))},l.a.createElement(l.a.Fragment,null,e))));c.displayName="LocalizedDateTooltip"},1082:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(7),s=n(4),o=n(1),i=n(84),r=n(193),l=n(404);const c=({alertId:e})=>{const[t,n]=Object(s.useState)(!1),[c,u]=Object(s.useState)([]),{addError:d}=Object(i.a)();return Object(s.useEffect)((()=>{let t=!0;return n(!0),Object(a.isEmpty)(e)||(async()=>{try{const n=await Object(r.f)({alertId:e,owner:[o.p]});t&&u(n)}catch(e){d(e.message,{title:l.a})}t&&n(!1)})(),()=>{t=!1}}),[e,d]),{loading:t,casesInfo:c}}},1083:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return l}));var a=n(0),s=n(142);const o=Object.freeze({[s.b.HEALTHY]:"success",[s.b.UNHEALTHY]:"warning",[s.b.UPDATING]:"primary",[s.b.OFFLINE]:"default",[s.b.INACTIVE]:"default",[s.b.UNENROLLED]:"default"}),i=Object.freeze({success:"success",warning:"warning",failure:"danger",unsupported:"default"}),r=Object.freeze({success:"success",warning:"warning",failure:"danger",unsupported:"default"}),l=Object.freeze({success:a.i18n.translate("xpack.securitySolution.policyStatusText.success",{defaultMessage:"Success"}),warning:a.i18n.translate("xpack.securitySolution.policyStatusText.warning",{defaultMessage:"Warning"}),failure:a.i18n.translate("xpack.securitySolution.policyStatusText.failure",{defaultMessage:"Failure"}),unsupported:a.i18n.translate("xpack.securitySolution.policyStatusText.unsupported",{defaultMessage:"Unsupported"})})},1089:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(4),s=n.n(a),o=n(32);const i=Object(a.memo)((({data:e})=>s.a.createElement(o.EuiText,{size:"s"},Object.entries(e).map((([e,t])=>s.a.createElement("div",{key:e,className:"eui-textBreakAll"},s.a.createElement("strong",null,e),": ",t))))));i.displayName="ObjectContent";const r=Object(a.memo)((({error:e,"data-test-subj":t})=>Object(a.useMemo)((()=>{let n=s.a.createElement(s.a.Fragment,null,e.message);var a,r;return function(e){return e instanceof Error&&("request"in e||"req"in e)&&"name"in e}(e)&&(n=s.a.createElement(s.a.Fragment,null,s.a.createElement("div",null,`${null===(a=e.response)||void 0===a?void 0:a.status}: ${null===(r=e.response)||void 0===r?void 0:r.statusText}`),e.body&&s.a.createElement(i,{data:e.body}))),s.a.createElement(o.EuiText,{"data-test-subj":t},n)}),[t,e])));r.displayName="FormattedError"},1118:function(e,t,n){"use strict";n.d(t,"a",(function(){return se}));var a=n(32),s=n(4),o=n.n(s),i=n(35),r=n(647),l=n(691),c=n(562),u=n(91),d=n(51),m=n(41),p=n(42),g=n(37);const f=["failed","pending","successful"],b=["isolate","unisolate","kill-process","suspend-process","running-processes","get-file"];var h=n(232);const E=e=>{const t={commands:[],hosts:[],statuses:[],startDate:"now-24h/h",endDate:"now",users:[]},n=e.commands?String(e.commands).split(",").reduce(((e,t)=>((b.includes(t)||"release"===t||"processes"===t)&&e.push(t),e.sort())),[]):[],a=e.hosts?String(e.hosts).split(",").sort():[],s=e.statuses?String(e.statuses).split(",").reduce(((e,t)=>(f.includes(t)&&e.push(t),e.sort())),[]):[],o=e.users?String(e.users).split(",").sort():[];return t.commands=n.length?n:void 0,t.hosts=a.length?a:void 0,t.statuses=s.length?s:void 0,t.startDate=e.startDate?String(e.startDate):void 0,t.endDate=e.endDate?String(e.endDate):void 0,t.users=o.length?o:void 0,t},v=()=>{const e=Object(g.useLocation)(),t=Object(g.useHistory)(),{urlParams:n,toUrlParams:a}=Object(h.a)(),o=Object(s.useMemo)((()=>E(n)),[n]),[i,r]=Object(s.useState)(o),l=Object(s.useCallback)((s=>{t.push({...e,search:a({...n,commands:s.length?s:void 0})})}),[t,e,a,n]),c=Object(s.useCallback)((s=>{t.push({...e,search:a({...n,hosts:s.length?s:void 0})})}),[t,e,a,n]),u=Object(s.useCallback)((s=>{t.push({...e,search:a({...n,statuses:s.length?s:void 0})})}),[t,e,a,n]),d=Object(s.useCallback)((s=>{t.push({...e,search:a({...n,users:s.length?s:void 0})})}),[t,e,a,n]),m=Object(s.useCallback)((({startDate:s,endDate:o})=>{t.push({...e,search:a({...n,startDate:s.length?s:void 0,endDate:o.length?o:void 0})})}),[t,e,a,n]);return Object(s.useEffect)((()=>{r((e=>({...e,...E(n)})))}),[r,n]),{...i,setUrlActionsFilters:l,setUrlDateRangeFilters:m,setUrlHostsFilters:c,setUrlStatusesFilters:u,setUrlUsersFilters:d}},y=d.euiStyled.div`
  padding-bottom: ${e=>`${e.theme.eui.euiCodeBlockPaddingModifiers.paddingLarge}`};
`,j=Object(s.memo)((({dateRangePickerState:e,isDataLoading:t,isFlyout:n,onRefresh:i,onRefreshChange:r,onTimeChange:l})=>{const{startDate:c,endDate:d}=v(),g=Object(u.a)("response-actions-list"),f=Object(m.useKibana)(),{uiSettings:b}=f.services,[h]=Object(s.useState)((()=>{var e,t;return null!==(e=null==b||null===(t=b.get(p.UI_SETTINGS.TIMEPICKER_QUICK_RANGES))||void 0===t?void 0:t.map((({from:e,to:t,display:n})=>({start:e,end:t,label:n}))))&&void 0!==e?e:[]}));return o.a.createElement(y,{"data-test-subj":g("super-date-picker")},o.a.createElement(a.EuiFlexGroup,{alignItems:"center",direction:"row",responsive:!1,gutterSize:"s"},o.a.createElement(a.EuiFlexItem,null,o.a.createElement(a.EuiSuperDatePicker,{isLoading:t,dateFormat:b.get("dateFormat"),commonlyUsedRanges:h,end:n?e.endDate:null!=d?d:e.endDate,isPaused:!e.autoRefreshOptions.enabled,onTimeChange:l,onRefreshChange:r,refreshInterval:e.autoRefreshOptions.duration,onRefresh:i,recentlyUsedRanges:e.recentlyUsedDateRanges,start:n?e.startDate:null!=c?c:e.startDate,showUpdateButton:!1,updateButtonProps:{iconOnly:!0,fill:!1},width:"auto"}))))}));j.displayName="ActionLogDateRangePicker";var S=n(34);const O=Object(s.memo)((({children:e,closePopover:t,filterName:n,hasActiveFilters:i,isPopoverOpen:r,numActiveFilters:l,numFilters:d,onButtonClick:m})=>{const p=Object(u.a)("response-actions-list"),g=Object(a.useGeneratedHtmlId)({prefix:"filterGroupPopover"}),f=Object(s.useMemo)((()=>o.a.createElement(a.EuiFilterButton,{"data-test-subj":p(`${n}-filter-popoverButton`),iconType:"arrowDown",onClick:m,isSelected:r,numFilters:d,hasActiveFilters:i,numActiveFilters:l},c.a[n])),[n,p,i,r,l,d,m]);return o.a.createElement(a.EuiPopover,{button:f,closePopover:t,id:g,isOpen:r,panelPaddingSize:"none"},e)}));O.displayName="ActionsLogFilterPopover";var k=n(21);const x=Object(s.memo)((({color:e,status:t})=>{const n=Object(u.a)("response-actions-list");return o.a.createElement(a.EuiBadge,{"data-test-subj":n("column-status"),color:e},t)}));x.displayName="StatusBadge";var C=n(39),I=n(77),F=n(226);const w=Object.freeze({default:50,all:1e4}),M=Object.freeze({autoRefreshOptions:{enabled:!1,duration:1e4},startDate:"now-24h/h",endDate:"now",recentlyUsedDateRanges:[]}),A=e=>"failed"===e?c.d.badge.failed:"successful"===e?c.d.badge.successful:"pending"===e?c.d.badge.pending:"",T=e=>"unisolate"===e?"release":"running-processes"===e?"processes":e,N=e=>"release"===e?"unisolate":"processes"===e?"running-processes":e,R=Object(d.euiStyled)(a.EuiButtonEmpty).attrs({iconType:"crossInACircleFilled",color:"danger"})`
  border-top: ${e=>`${e.theme.eui.euiBorderThin}`};
  border-radius : 0;
`,D=Object(s.memo)((({"data-test-subj":e,isDisabled:t,onClick:n})=>o.a.createElement(R,{"data-test-subj":e,isDisabled:t,onClick:n},c.d.filterClearAll)));D.displayName="ClearAllButton";const L=Object(s.memo)((({filterName:e,isFlyout:t,onChangeFilterOptions:n})=>{const i=Object(u.a)("response-actions-list"),[r,l]=Object(s.useState)(!1),d=Object(s.useCallback)((()=>{l(!r)}),[l,r]),m=Object(s.useCallback)((()=>{l(!1)}),[l]),[p,g]=Object(s.useState)(""),{areHostsSelectedOnMount:h,isLoading:E,items:y,setItems:j,hasActiveFilters:M,numActiveFilters:R,numFilters:L,setAreHostsSelectedOnMount:P,setUrlActionsFilters:$,setUrlHostsFilters:_,setUrlStatusesFilters:z}=(({filterName:e,isFlyout:t,isPopoverOpen:n,searchString:a})=>{const{commands:i,statuses:r,hosts:l,setUrlActionsFilters:c,setUrlHostsFilters:u,setUrlStatusesFilters:d}=v(),m="statuses"===e,p="hosts"===e,{data:g,isFetching:h}=(({searchString:e,selectedAgentIds:t,options:n={}})=>{const a=Object(I.j)(),s=`united.endpoint.host.hostname:${e.length?`*${e}`:""}*`;let o=[];return t&&(o=t.map((e=>`united.endpoint.agent.id:"${e}"`))),Object(C.useQuery)({queryKey:["get-endpoints-list",s],...n,queryFn:async()=>{const e=(await a.get(F.k,{query:{page:0,pageSize:t&&t.length>0?w.all:w.default,kuery:[...o,s].join(" or ")}})).data.reduce(((e,n)=>{const a={id:n.metadata.agent.id,name:n.metadata.host.hostname};return null!=t&&t.includes(n.metadata.agent.id)?e.selected.push({...a,selected:!0}):e.rest.push({...a,selected:!1}),e}),{selected:[],rest:[]});let n=0;return t&&(n=t.length),[...e.selected,...e.rest].slice(0,n>=w.default?n+10:w.default)}})})({searchString:a,selectedAgentIds:l}),[E,y]=Object(s.useState)(!1);Object(s.useEffect)((()=>{l&&l.length>0&&y(!0)}),[]);const[j,S]=Object(s.useState)(m?f.map((n=>({key:n,label:o.a.createElement(x,{color:"successful"===n?"success":"failed"===n?"danger":"warning",status:A(n)}),checked:!t&&null!=r&&r.includes(n)?"on":void 0,"data-test-subj":`${e}-filter-option`}))):p?[]:b.filter((e=>!("get-file"===e&&!k.a.get().responseActionGetFileEnabled))).map((n=>({key:n,label:T(n),checked:!t&&null!=i&&i.map((e=>N(e))).includes(n)?"on":void 0,"data-test-subj":`${e}-filter-option`}))));Object(s.useEffect)((()=>{p&&g&&S(null==g?void 0:g.map((n=>({key:n.id,label:n.name,checked:!t&&n.selected?"on":void 0,"data-test-subj":`${e}-filter-option`}))))}),[g,e,t,p,S]);const O=Object(s.useMemo)((()=>!!j.find((e=>"on"===e.checked))),[j]),M=Object(s.useMemo)((()=>j.filter((e=>"on"===e.checked)).length),[j]),R=Object(s.useMemo)((()=>j.filter((e=>"on"!==e.checked)).length),[j]);return{areHostsSelectedOnMount:E,isLoading:p&&h,items:j,setItems:S,hasActiveFilters:O,numActiveFilters:M,numFilters:R,setAreHostsSelectedOnMount:y,setUrlActionsFilters:c,setUrlHostsFilters:u,setUrlStatusesFilters:d}})({filterName:e,isFlyout:t,isPopoverOpen:r,searchString:p}),U=Object(s.useRef)(r);Object(s.useEffect)((()=>()=>{U.current=r}),[r,U]);const B=Object(s.useCallback)(((t=!0)=>t&&U.current&&r&&"hosts"===e),[e,r]),H=Object(s.useMemo)((()=>B()||h?Object(S.orderBy)("checked","asc",y):y),[h,B,y]),q=Object(s.useMemo)((()=>"statuses"!==e),[e]),G=Object(s.useCallback)((a=>{j(a.map((e=>e)));const s=a.reduce(((e,t)=>("on"===t.checked&&e.push(t.key),e)),[]);t||("actions"===e?$(s.map((e=>T(e))).join()):"hosts"===e?_(s.join()):"statuses"===e&&z(s.join()),B(!1),P(!1)),n(s)}),[B,e,t,j,n,P,$,_,z]),W=Object(s.useCallback)((()=>{j(y.map((e=>(e.checked=void 0,e)))),t||("actions"===e?$(""):"hosts"===e?_(""):"statuses"===e&&z("")),n([])}),[e,t,y,j,n,$,_,z]);return o.a.createElement(O,{closePopover:m,filterName:e,hasActiveFilters:M,isPopoverOpen:r,numActiveFilters:R,numFilters:L,onButtonClick:d},o.a.createElement(a.EuiSelectable,{"aria-label":`${e}`,emptyMessage:c.d.filterEmptyMessage(e),isLoading:E,onChange:G,options:H,searchable:!!q||void 0,searchProps:{placeholder:c.d.filterSearchPlaceholder(e),compressed:!0,onChange:e=>g(e.trim())}},((t,n)=>o.a.createElement("div",{style:{width:300},"data-test-subj":i(`${e}-filter-popoverList`)},q&&o.a.createElement(a.EuiPopoverTitle,{"data-test-subj":i(`${e}-filter-search`),paddingSize:"s"},n),t,o.a.createElement(a.EuiFlexGroup,null,o.a.createElement(a.EuiFlexItem,null,o.a.createElement(D,{"data-test-subj":i(`${e}-filter-clearAllButton`),isDisabled:!M,onClick:W})))))))}));L.displayName="ActionsLogFilter";const P=Object(s.memo)((({isFlyout:e,onChangeUsersFilter:t})=>{const n=Object(u.a)("response-actions-list"),{users:i,setUrlUsersFilters:r}=v(),[l,d]=Object(s.useState)(""),m=Object(s.useCallback)((e=>{d(e.target.value)}),[d]),p=Object(s.useCallback)((()=>{const n=l.split(",").reduce(((e,t)=>(""!==t.trim()&&e.push(t.trim()),e)),[]);t(n),e||r(n.join(","))}),[e,t,l,r]),g=Object(s.useCallback)((()=>{d(""),t([]),e||r("")}),[e,t,r,d]);return Object(s.useEffect)((()=>{i&&i.length>0&&d(i.join(","))}),[]),o.a.createElement(a.EuiFormControlLayout,{clear:{onClick:g},fullWidth:!0},o.a.createElement(a.EuiFieldSearch,{"data-test-subj":n("users-filter-search"),isClearable:!0,fullWidth:!0,placeholder:c.a.users,onChange:m,onSearch:p,value:l}))}));P.displayName="ActionsLogUsersFilter";const $=Object(s.memo)((({dateRangePickerState:e,isDataLoading:t,isFlyout:n,onClick:i,onChangeHostsFilter:r,onChangeCommandsFilter:l,onChangeStatusesFilter:c,onChangeUsersFilter:d,onRefresh:m,onRefreshChange:p,onTimeChange:g,showHostsFilter:f})=>{const b=Object(u.a)("response-actions-list"),h=Object(s.useMemo)((()=>o.a.createElement(o.a.Fragment,null,f&&o.a.createElement(L,{filterName:"hosts",isFlyout:n,onChangeFilterOptions:r}),o.a.createElement(L,{filterName:"actions",isFlyout:n,onChangeFilterOptions:l}),o.a.createElement(L,{filterName:"statuses",isFlyout:n,onChangeFilterOptions:c}))),[n,l,r,c,f]),E=Object(s.useCallback)((()=>i()),[i]);return o.a.createElement(a.EuiFlexGroup,{responsive:!0,gutterSize:"s"},o.a.createElement(a.EuiFlexItem,{grow:n?1:2},o.a.createElement(P,{isFlyout:n,onChangeUsersFilter:d})),o.a.createElement(a.EuiFlexItem,{grow:1},o.a.createElement(a.EuiFilterGroup,null,h)),o.a.createElement(a.EuiFlexItem,{grow:n?1:2},o.a.createElement(j,{dateRangePickerState:e,isDataLoading:t,isFlyout:n,onRefresh:m,onRefreshChange:p,onTimeChange:g})),o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(a.EuiSuperUpdateButton,{iconOnly:!0,"data-test-subj":b("super-refresh-button"),fill:!1,isLoading:t,onClick:E})))}));$.displayName="ActionsLogFilters";var _=n(405),z=n(563),U=n(33),B=n.n(U),H=n(0);const q=B()(a.EuiEmptyPrompt).withConfig({displayName:"EmptyPrompt",componentId:"sc-mvmy5q-0"})(["max-width:100%;"]),G=Object(s.memo)((({"data-test-subj":e})=>{const{docLinks:t}=Object(m.useKibana)().services;return o.a.createElement(r.a,{"data-test-subj":e},o.a.createElement(q,{iconType:"editorUnorderedList",title:o.a.createElement("h2",null,H.i18n.translate("xpack.securitySolution.responseActionsHistory.empty.title",{defaultMessage:"Response actions history is empty"})),body:o.a.createElement("div",null,H.i18n.translate("xpack.securitySolution.responseActionsHistory.empty.content",{defaultMessage:"No response actions performed"})),actions:[o.a.createElement(a.EuiLink,{external:!0,href:null==t?void 0:t.links.securitySolution.responseActions,target:"_blank"},H.i18n.translate("xpack.securitySolution.responseActionsHistory.empty.link",{defaultMessage:"Read more about response actions"}))]}))}));G.displayName="ActionsLogEmptyState";var W=n(101),K=n(87),Y=n(105),V=n(1165);const Q=Object(K.e)(),J=Object(d.euiStyled)(a.EuiFacetButton)`
  .euiText {
    margin-top: 0.38rem;
    overflow-y: visible !important;
  }
`,X=d.css`
  &.euiDescriptionList {
    > .euiDescriptionList__title {
      color: ${e=>e.theme.eui.euiColorDarkShade};
      font-size: ${e=>e.theme.eui.euiFontSizeXS};
      margin-top: ${e=>e.theme.eui.euiSizeS};
    }

    > .euiDescriptionList__description {
      font-weight: ${e=>e.theme.eui.euiFontWeightSemiBold};
      margin-top: ${e=>e.theme.eui.euiSizeS};
    }
  }
`,Z=Object(d.euiStyled)(a.EuiDescriptionList).attrs({compressed:!0,type:"column"})`
  ${X}
`,ee=d.css`
  ${e=>`${e.theme.eui.euiCodeBlockPaddingModifiers.paddingMedium} 0`}
`,te=d.css`
  ${e=>`1px dashed ${e.theme.eui.euiColorDisabled}`};
`,ne=Object(d.euiStyled)(a.EuiDescriptionList).attrs({compressed:!0})`
  ${X}
  dd {
    margin: ${ee};
    padding: ${ee};
    border-top: ${te};
    border-bottom: ${te};
  }
`,ae=Object(d.euiStyled)(a.EuiCodeBlock).attrs({transparentBackground:!0,paddingSize:"none"})`
  code {
    color: ${e=>e.theme.eui.euiColorDarkShade} !important;
  }
`,se=Object(s.memo)((({agentIds:e,showHostNames:t=!1,isFlyout:n=!0,setIsDataInResponse:d})=>{var m,p;const{pagination:g,setPagination:f}=Object(_.b)(),{commands:b,hosts:h,statuses:E,startDate:y,endDate:j,users:S}=v(),O=Object(u.a)("response-actions-list"),[k,C]=Object(s.useState)(!0),[I,F]=Object(s.useState)({page:n?1:g.page,pageSize:n?10:g.pageSize,agentIds:n?e:null!=h&&h.length?h:e,commands:[],statuses:[],userIds:[]});Object(s.useEffect)((()=>{n||F((e=>({...e,commands:null!=b&&b.length?b.map((e=>N(e))):e.commands,hosts:null!=h&&h.length?h:e.agentIds,statuses:null!=E&&E.length?E:e.statuses,userIds:null!=S&&S.length?S:e.userIds})))}),[b,h,n,E,F,S]);const{dateRangePickerState:w,onRefreshChange:R,onTimeChange:D}=(e=>{const{setUrlDateRangeFilters:t}=v(),[n,a]=Object(s.useState)(M),o=Object(s.useCallback)((({start:e,end:t})=>{a((n=>({...n,startDate:e,endDate:t})))}),[a]),i=Object(s.useCallback)((e=>{a((t=>({...t,recentlyUsedDateRanges:e})))}),[a]),r=Object(s.useCallback)((e=>{a((t=>({...t,autoRefreshOptions:{enabled:!e.isPaused,duration:e.refreshInterval}})))}),[a]),l=Object(s.useCallback)((({start:a,end:s})=>{o({start:a,end:s});const r=[{start:a,end:s},...n.recentlyUsedDateRanges.filter((e=>!(e.start===a&&e.end===s))).slice(0,9)];i(r),e||t({startDate:a,endDate:s})}),[n.recentlyUsedDateRanges,e,t,o,i]);return{dateRangePickerState:n,onRefreshChange:r,onTimeChange:l}})(n),{error:L,data:P,isFetching:U,isFetched:B,refetch:H}=Object(l.a)({...I,startDate:n?w.startDate:y,endDate:n?w.endDate:j},{retry:!1}),q=Object(s.useMemo)((()=>{var e;return null!==(e=null==P?void 0:P.total)&&void 0!==e?e:0}),[P]),{itemIdToExpandedRowMap:K,recordRangeLabel:X,responseActionListColumns:ee,tablePagination:te}=(({pageIndex:e,pageSize:t,queryParams:n,showHostNames:r,totalItemCount:l})=>{const d=Object(u.a)("response-actions-list"),[m,p]=Object(s.useState)({}),g=Object(s.useCallback)((e=>{const t={...m};if(t[e.id])delete t[e.id];else{const{startedAt:n,completedAt:s,isCompleted:i,wasSuccessful:r,isExpired:l,command:u,comment:m,parameters:p}=e,g=p?Object.entries(p).map((([e,t])=>`${e}:${t}`)):void 0,f=T(u),b="get-file"===f,h=[{title:c.b.expandSection.placedAt,description:`${n}`},{title:c.b.expandSection.startedAt,description:`${n}`},{title:c.b.expandSection.completedAt,description:`${null!=s?s:Q}`},{title:c.b.expandSection.input,description:`${f}`},{title:c.b.expandSection.parameters,description:g||Q},{title:c.b.expandSection.comment,description:m||Q}].map((({title:e,description:t})=>({title:o.a.createElement(ae,null,e),description:o.a.createElement(ae,null,t)}))),E=()=>l?c.b.hasExpired(f):i?r?b?o.a.createElement(o.a.Fragment,null,c.b.wasSuccessful(f),o.a.createElement(V.a,{action:e,textSize:"xs","data-test-subj":d("getFileDownloadLink")})):c.b.wasSuccessful(f):c.b.hasFailed(f):c.b.isPending(f),v=[{title:o.a.createElement(ae,null,`${c.b.expandSection.output}:`),description:o.a.createElement(ae,{"data-test-subj":d("details-tray-output")},E())}];t[e.id]=o.a.createElement(o.a.Fragment,null,o.a.createElement(a.EuiFlexGroup,{"data-test-subj":d("details-tray"),direction:"column",style:{maxHeight:270,overflowY:"auto"},className:"eui-yScrollWithShadows",gutterSize:"s"},o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(Z,{listItems:h})),o.a.createElement(a.EuiFlexItem,null,o.a.createElement(ne,{listItems:v}))))}p(t)}),[d,m]),f=Object(s.useCallback)((e=>()=>g(e)),[g]),b=Object(s.useMemo)((()=>{const e=[{field:"startedAt",name:c.c.time,width:r?"15%":"21%",truncateText:!0,render:e=>o.a.createElement(W.a,{fieldName:c.c.time,value:e,className:"eui-textTruncate"})},{field:"command",name:c.c.command,width:r?"10%":"21%",truncateText:!0,render:e=>{const t=T(e);return o.a.createElement(a.EuiToolTip,{content:t,anchorClassName:"eui-textTruncate"},o.a.createElement(a.EuiText,{size:"s",className:"eui-textTruncate eui-fullWidth","data-test-subj":d("column-command")},t))}},{field:"createdBy",name:c.c.user,width:r?"14%":"21%",truncateText:!0,render:e=>o.a.createElement(J,{icon:o.a.createElement(a.EuiAvatar,{name:e,"data-test-subj":d("column-user-avatar"),size:"s"})},o.a.createElement(a.EuiToolTip,{content:e,anchorClassName:"eui-textTruncate"},o.a.createElement(a.EuiText,{size:"s",className:"eui-textTruncate eui-fullWidth","data-test-subj":d("column-user-name")},e)))},{field:"hosts",name:c.c.hosts,width:"20%",truncateText:!0,render:e=>{const t=e&&Object.values(e),n=t.reduce(((e,t)=>(t.name.trim()&&e.push(t.name),e)),[]).join(", ");let s=n;return n||(t.length>1?s=c.d.unenrolled.hosts:1===t.length&&(s=c.d.unenrolled.host)),o.a.createElement(a.EuiToolTip,{content:s,anchorClassName:"eui-textTruncate"},o.a.createElement(a.EuiText,{size:"s",className:"eui-textTruncate eui-fullWidth","data-test-subj":d("column-hostname")},s))}},{field:"comment",name:c.c.comments,width:r?"30%":"21%",truncateText:!0,render:e=>o.a.createElement(a.EuiToolTip,{content:e,anchorClassName:"eui-textTruncate"},o.a.createElement(a.EuiText,{size:"s",className:"eui-textTruncate eui-fullWidth","data-test-subj":d("column-comments")},null!=e?e:Q))},{field:"status",name:c.c.status,width:r?"10%":"15%",render:e=>{const t=A(e);return o.a.createElement(a.EuiToolTip,{content:t,anchorClassName:"eui-textTruncate"},o.a.createElement(x,{color:"failed"===e?"danger":"successful"===e?"success":"warning",status:t}))}},{field:"",align:a.RIGHT_ALIGNMENT,width:"40px",isExpander:!0,name:o.a.createElement(a.EuiScreenReaderOnly,null,o.a.createElement("span",null,c.d.screenReaderExpand)),render:e=>o.a.createElement(a.EuiButtonIcon,{"data-test-subj":d("expand-button"),onClick:f(e),"aria-label":m[e.id]?"Collapse":"Expand",iconType:m[e.id]?"arrowUp":"arrowDown"})}];return r?e:e.filter((e=>"hosts"!==e.field))}),[r,d,m,f]),h=Object(s.useMemo)((()=>({pageIndex:e,pageSize:t,totalItemCount:l,pageSizeOptions:Y.f})),[e,t,l]),E=Object(s.useMemo)((()=>{var e,t;const a=null!==(e=n.page)&&void 0!==e?e:1,s=null!==(t=null==n?void 0:n.pageSize)&&void 0!==t?t:10,o=Math.ceil(l/s),i=s*a-s+1;return{fromCount:i,toCount:a===o||1===o?l:i+s-1}}),[n.page,n.pageSize,l]),v=Object(s.useMemo)((()=>o.a.createElement(a.EuiText,{color:"default",size:"xs","data-test-subj":d("endpointListTableTotal")},o.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.responseActionsList.list.recordRange",defaultMessage:"Showing {range} of {total} {recordsLabel}",values:{range:o.a.createElement("strong",null,o.a.createElement(a.EuiI18nNumber,{value:E.fromCount}),"-",o.a.createElement(a.EuiI18nNumber,{value:E.toCount})),total:o.a.createElement(a.EuiI18nNumber,{value:l}),recordsLabel:o.a.createElement("strong",null,c.d.recordsLabel(l))}}))),[d,E.fromCount,E.toCount,l]);return{itemIdToExpandedRowMap:m,responseActionListColumns:b,recordRangeLabel:v,tablePagination:h}})({showHostNames:t,pageIndex:n?(I.page||1)-1:g.page-1,pageSize:n?I.pageSize||10:g.pageSize,queryParams:I,totalItemCount:q});Object(s.useEffect)((()=>{var e,t;U||404!==(null==L||null===(e=L.body)||void 0===e?void 0:e.statusCode)||"index_not_found_exception"!==(null==L||null===(t=L.body)||void 0===t?void 0:t.message)?!U&&P&&(C(!1),d&&d(!0)):d&&d(!1)}),[P,L,U,d]);const se=Object(s.useCallback)((()=>{w.autoRefreshOptions.enabled&&H()}),[w.autoRefreshOptions.enabled,H]),oe=Object(s.useCallback)((e=>{F((t=>({...t,commands:e})))}),[F]),ie=Object(s.useCallback)((e=>{F((t=>({...t,statuses:e})))}),[F]),re=Object(s.useCallback)((e=>{F((t=>({...t,agentIds:e})))}),[F]),le=Object(s.useCallback)((e=>{F((t=>({...t,userIds:e})))}),[F]),ce=Object(s.useCallback)((({page:e})=>{const{index:t,size:a}=e,s={page:t+1,pageSize:a};F((e=>({...e,...s}))),n||f({...s}),H()}),[n,H,F,f]);return 404===(null==L||null===(m=L.body)||void 0===m?void 0:m.statusCode)&&"index_not_found_exception"===(null==L||null===(p=L.body)||void 0===p?void 0:p.message)?o.a.createElement(G,{"data-test-subj":O("empty-state")}):U&&k?o.a.createElement(z.a,{"data-test-subj":O("global-loader")}):o.a.createElement(o.a.Fragment,null,o.a.createElement($,{isFlyout:n,dateRangePickerState:w,isDataLoading:U,onClick:H,onChangeHostsFilter:re,onChangeCommandsFilter:oe,onChangeStatusesFilter:ie,onChangeUsersFilter:le,onRefresh:se,onRefreshChange:R,onTimeChange:D,showHostsFilter:t}),B&&!q?o.a.createElement(r.a,null,o.a.createElement(a.EuiFlexItem,{"data-test-subj":O("empty-prompt")},o.a.createElement(a.EuiEmptyPrompt,{iconType:"editorUnorderedList",titleSize:"s",title:o.a.createElement("h2",null,o.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.responseActionsList.empty.title",defaultMessage:"No results match your search criteria"})),body:o.a.createElement("p",null,o.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.responseActionsList.empty.body",defaultMessage:"Try modifying your search or filter set"})),"data-test-subj":"responseActions-empty"}))):o.a.createElement(o.a.Fragment,null,X,o.a.createElement(a.EuiHorizontalRule,{margin:"xs"}),o.a.createElement(a.EuiBasicTable,{"data-test-subj":O("table-view"),items:(null==P?void 0:P.data)||[],columns:ee,itemId:"id",itemIdToExpandedRowMap:K,isExpandable:!0,pagination:te,onChange:ce,loading:U,error:null!==L?c.d.fetchError:void 0})))}));se.displayName="ResponseActionsLog"},1158:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(0);const s=e=>a.i18n.translate("xpack.securitySolution.endpoint.list.hostStatusValue",{defaultMessage:"{hostStatus, select, healthy {Healthy} unhealthy {Unhealthy} updating {Updating} offline {Offline} inactive {Inactive} unenrolled {Unenrolled} other {Unhealthy}}",values:{hostStatus:e}})},1165:function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var a=n(4),s=n.n(a),o=n(32),i=n(35),r=n(0),l=n(33),c=n.n(l),u=n(547),d=n(1089),m=n(39),p=n(240),g=n(226),f=n(116),b=n(91);const h=Object.freeze({fontFamily:"inherit"}),E=r.i18n.translate("xpack.securitySolution.responseActionFileDownloadLink.downloadButtonLabel",{defaultMessage:"Click here to download"}),v=r.i18n.translate("xpack.securitySolution.responseActionFileDownloadLink.fileNoLongerAvailable",{defaultMessage:"File has expired and is no longer available for download."}),y=c.a.div.withConfig({displayName:"FileDownloadLinkContainer",componentId:"sc-1ne1vf0-0"})(["& > *{vertical-align:middle;}"]),j=Object(a.memo)((({action:e,agentId:t,buttonTitle:n=E,"data-test-subj":r,textSize:l="s"})=>{var c;const j=Object(b.a)(r),{canWriteFileOperations:S}=Object(f.a)().endpointPrivileges,O=Object(a.useMemo)((()=>e.isCompleted&&e.wasSuccessful),[e.isCompleted,e.wasSuccessful]),k=Object(a.useMemo)((()=>Object(u.a)(g.a,{action_id:e.id,agent_id:null!=t?t:e.agents[0]})),[e.agents,e.id,t]),{isFetching:x,data:C,error:I}=((e,t,n={})=>{const a=Object(p.h)();return Object(m.useQuery)({queryKey:["get-action-file-info",e.id,null!=t?t:e.agents[0]],...n,queryFn:()=>{const n=Object(u.a)(g.b,{action_id:e.id,agent_id:null!=t?t:e.agents[0]});return a.get(n)}})})(e,void 0,{enabled:S&&O});return S&&e.isCompleted&&e.wasSuccessful?x?s.a.createElement(o.EuiLoadingContent,{lines:1,"data-test-subj":j("loading")}):I&&404===(null==I||null===(c=I.response)||void 0===c?void 0:c.status)||"DELETED"===(null==C?void 0:C.data.status)?s.a.createElement(o.EuiText,{size:l,"data-test-subj":j("fileNoLongerAvailable")},v):I?s.a.createElement(d.a,{error:I,"data-test-subj":j("apiError")}):s.a.createElement(y,{"data-test-subj":r},s.a.createElement(o.EuiButtonEmpty,{href:k,iconType:"download","data-test-subj":j("downloadButton"),flush:"left",style:h,iconSize:"s",download:!0},s.a.createElement(o.EuiText,{size:l},n)),s.a.createElement(o.EuiText,{size:l,"data-test-subj":j("passcodeMessage"),className:"eui-displayInline"},s.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.responseActionFileDownloadLink.passcodeInfo",defaultMessage:"(ZIP file passcode: {passcode}).",values:{passcode:"elastic"}})),s.a.createElement(o.EuiText,{size:l,"data-test-subj":j("fileDeleteMessage")},s.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.responseActionFileDownloadLink.deleteNotice",defaultMessage:"Files are periodically deleted to clear storage space. Download and save file locally if needed."}))):null}));j.displayName="ResponseActionFileDownloadLink"},128:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return m})),n.d(t,"e",(function(){return p.a})),n.d(t,"j",(function(){return p.d})),n.d(t,"f",(function(){return g.a})),n.d(t,"k",(function(){return g.b})),n.d(t,"g",(function(){return f})),n.d(t,"i",(function(){return b.b})),n.d(t,"h",(function(){return b.a})),n.d(t,"l",(function(){return h})),n.d(t,"m",(function(){return E})),n.d(t,"c",(function(){return v})),n.d(t,"d",(function(){return y})),n.d(t,"n",(function(){return j})),n.d(t,"o",(function(){return S}));var a=n(34),s=n(4),o=n(169),i=n(521),r=n(240),l=n(9),c=n(1),u=n(209);const d=(e,t)=>`/${e}/summary${Object(u.a)(t)}`,m=(e,t,n)=>`${c.d}/${e}/${t}${Object(u.a)(n)}`;var p=n(156),g=n(382);const f=(e,t)=>`/${e}${Object(u.a)(t)}`;var b=n(854);const h=(e,t)=>`/${e}${Object(u.a)(t)}`,E=(e,t)=>`?timeline=(id:'${e}',isOpen:!t${Object(a.isEmpty)(t)?")":`,graphEventId:'${t}')`}`,v=({id:e,search:t})=>`/${encodeURIComponent(e)}${Object(u.a)(null!=t?t:void 0)}`,y=e=>`/create${Object(u.a)(null!=e?e:void 0)}`,j=e=>{const{getAppUrl:t}=Object(r.b)(),n=(e=>{const t=Object(o.a)();return Object(s.useMemo)((()=>Object(i.a)(e,t)),[t,e])})(e);return{formatUrl:Object(s.useCallback)(((a,{absolute:s=!1,skipSearch:o=!1}={})=>{const i=O(a,n,o);return t({deepLinkId:e,path:i,absolute:s})}),[t,e,n]),search:n}},S=()=>{const{getAppUrl:e}=Object(r.b)(),t=(()=>{const e=Object(o.a)();return Object(s.useCallback)((()=>e.length>0?`?${e}`:""),[e])})();return Object(s.useCallback)((({deepLinkId:n,path:a="",absolute:s=!1,skipSearch:o=!1})=>{const i=O(a,Object(l.e)(n)?t():"",o);return e({deepLinkId:n,path:i,absolute:s})}),[e,t])};function O(e,t,n){const[s,o]=e.split("?");return`${s}${n?Object(a.isEmpty)(o)?"":`?${o}`:Object(a.isEmpty)(o)?t:`?${o}${Object(a.isEmpty)(t)?"":`&${t}`}`}`}},142:function(e,t,n){"use strict";let a,s,o,i,r,l;n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return i})),n.d(t,"e",(function(){return r})),n.d(t,"a",(function(){return l})),function(e){e.windows="windows",e.mac="mac",e.linux="linux"}(a||(a={})),function(e){e.is="is",e.matches="matches"}(s||(s={})),function(e){e.enrolled="enrolled",e.unenrolled="unenrolled"}(o||(o={})),function(e){e.UNHEALTHY="unhealthy",e.HEALTHY="healthy",e.OFFLINE="offline",e.UPDATING="updating",e.INACTIVE="inactive",e.UNENROLLED="unenrolled"}(i||(i={})),function(e){e.detect="detect",e.prevent="prevent",e.off="off"}(r||(r={})),function(e){e.success="success",e.failure="failure",e.warning="warning",e.unsupported="unsupported"}(l||(l={}))},156:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"e",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return l}));var a=n(209);const s=e=>`${Object(a.a)(e)}`,o=e=>`${Object(a.a)(e)}`,i=(e,t)=>`/id/${e}${Object(a.a)(t)}`,r=(e,t,n)=>`/id/${e}/${t}${Object(a.a)(n)}`,l=(e,t)=>`/id/${e}/edit${Object(a.a)(t)}`},191:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return r}));var a=n(34);const s=e=>{var t;return Boolean(null===(t=e.Endpoint.state)||void 0===t?void 0:t.isolation)},o=["http:","https:"],i=e=>{try{if(null!=e){if(""===e)return!1;{const t=new URL(e);if(o.includes(t.protocol)&&e.startsWith(`${t.protocol}//`))return!1}}}catch(e){}return!0};function r(e){return Object(a.isNumber)(e)||!Object(a.isEmpty)(e)}},209:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(34);const s=e=>Object(a.isEmpty)(e)?"":`${null!=e&&e.startsWith("?")?e:`?${e}`}`},229:function(e,t,n){"use strict";let a,s,o;n.r(t),n.d(t,"NetworkType",(function(){return a})),n.d(t,"NetworkTableType",(function(){return s})),n.d(t,"NetworkDetailsTableType",(function(){return o})),function(e){e.page="page",e.details="details"}(a||(a={})),function(e){e.alerts="alerts",e.dns="dns",e.http="http",e.topCountriesDestination="topCountriesDestination",e.topCountriesSource="topCountriesSource",e.topNFlowDestination="topNFlowDestination",e.topNFlowSource="topNFlowSource",e.tls="tls",e.anomalies="anomalies"}(s||(s={})),function(e){e.http="http",e.tls="tls",e.topCountriesDestination="topCountriesDestination",e.topCountriesSource="topCountriesSource",e.topNFlowDestination="topNFlowDestination",e.topNFlowSource="topNFlowSource",e.users="users",e.anomalies="anomalies"}(o||(o={}))},232:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(4),s=n(598),o=n(37);function i(){const{search:e}=Object(o.useLocation)();return Object(a.useMemo)((()=>{const t=Object(s.parse)(e);return{urlParams:t,toUrlParams:(e=t)=>Object(s.stringify)(e)}}),[e])}},246:function(e,t,n){"use strict";n.d(t,"d",(function(){return E})),n.d(t,"c",(function(){return v})),n.d(t,"e",(function(){return y})),n.d(t,"b",(function(){return k})),n.d(t,"a",(function(){return x}));var a=n(4),s=n.n(a),o=n(32),i=n(35),r=n(0);const l=r.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.cancel",{defaultMessage:"Cancel"}),c=r.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.confirm",{defaultMessage:"Confirm"}),u=r.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.comment",{defaultMessage:"Comment"}),d=r.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.comment.placeholder",{defaultMessage:"You may leave an optional note here."}),m=e=>r.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.isolation.successfulMessage",{defaultMessage:"Isolation on host {hostName} successfully submitted",values:{hostName:e}}),p=e=>r.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.unisolate.successfulMessage",{defaultMessage:"Release on host {hostName} successfully submitted",values:{hostName:e}}),g=r.i18n.translate("xpack.securitySolution.endpoint.hostisolation.unisolate",{defaultMessage:"release"}),f=r.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.isolated",{defaultMessage:"isolated"});var b=n(1082),h=n(89);const E=Object(a.memo)((({hostName:e,alertId:t,isolateAction:n="isolateHost",additionalInfo:r})=>s.a.createElement(o.EuiCallOut,{iconType:"check",color:"success",title:"isolateHost"===n?m(e):p(e),"data-test-subj":"isolateHost"===n?"hostIsolateSuccessMessage":"hostUnisolateSuccessMessage"},void 0!==t?(({alertIdForCase:e})=>{const{casesInfo:t}=Object(b.a)({alertId:e}),n=Object(a.useMemo)((()=>t.length),[t]),r=Object(a.useMemo)((()=>t.map(((e,t)=>s.a.createElement("li",{key:e.id},s.a.createElement(h.a,{detailName:e.id},s.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolation.placeholderCase",defaultMessage:"{caseName}",values:{caseName:e.title}})))))),[t]);return s.a.createElement(s.a.Fragment,null,n>0&&s.a.createElement(s.a.Fragment,null,s.a.createElement(o.EuiText,{size:"s"},s.a.createElement("p",null,s.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolation.successfulIsolation.cases",defaultMessage:"This action has been attached to the following {caseCount, plural, one {case} other {cases}}:",values:{caseCount:n}}))),s.a.createElement(o.EuiText,{size:"s"},s.a.createElement("ul",null,r))))})({alertIdForCase:t}):r)));E.displayName="EndpointIsolateSuccess";const v=Object(a.memo)((({hostName:e,onCancel:t,onConfirm:n,onChange:r,comment:m="",messageAppend:p,isLoading:g=!1})=>{const f=Object(a.useCallback)((e=>{r({comment:e.target.value})}),[r]);return s.a.createElement(o.EuiForm,{"data-test-subj":"endpointHostIsolationForm"},s.a.createElement(o.EuiFormRow,{fullWidth:!0},s.a.createElement(o.EuiText,{size:"s"},s.a.createElement("p",null,s.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolation.isolateThisHost",defaultMessage:"Isolate host {hostName} from network.",values:{hostName:s.a.createElement("b",null,e)}}),s.a.createElement("br",null)),s.a.createElement("p",null,s.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolation.isolateThisHostAbout",defaultMessage:"Isolating a host will disconnect it from the network. The host will only be able to communicate with the Kibana platform."})," ",p))),s.a.createElement(o.EuiFormRow,{label:u,fullWidth:!0},s.a.createElement(o.EuiTextArea,{"data-test-subj":"host_isolation_comment",fullWidth:!0,placeholder:d,value:m,onChange:f})),s.a.createElement(o.EuiFormRow,{fullWidth:!0},s.a.createElement(o.EuiFlexGroup,{justifyContent:"flexEnd"},s.a.createElement(o.EuiFlexItem,{grow:!1},s.a.createElement(o.EuiButtonEmpty,{onClick:t,disabled:g,"data-test-subj":"hostIsolateCancelButton"},l)),s.a.createElement(o.EuiFlexItem,{grow:!1},s.a.createElement(o.EuiButton,{fill:!0,onClick:n,disabled:g,isLoading:g,"data-test-subj":"hostIsolateConfirmButton"},c)))))}));v.displayName="EndpointIsolateForm";const y=Object(a.memo)((({hostName:e,onCancel:t,onConfirm:n,onChange:r,comment:m="",messageAppend:p,isLoading:b=!1})=>{const h=Object(a.useCallback)((e=>{r({comment:e.target.value})}),[r]);return s.a.createElement(o.EuiForm,{"data-test-subj":"endpointHostIsolationForm"},s.a.createElement(o.EuiFormRow,{fullWidth:!0},s.a.createElement(o.EuiText,{size:"s"},s.a.createElement("p",null,s.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolation.unIsolateThisHost",defaultMessage:"{hostName} is currently {isolated}. Are you sure you want to {unisolate} this host?",values:{hostName:s.a.createElement("b",null,e),isolated:s.a.createElement("b",null,f),unisolate:s.a.createElement("b",null,g)}})," ",p))),s.a.createElement(o.EuiFormRow,{label:u,fullWidth:!0},s.a.createElement(o.EuiTextArea,{"data-test-subj":"host_isolation_comment",fullWidth:!0,placeholder:d,value:m,onChange:h})),s.a.createElement(o.EuiFormRow,{fullWidth:!0},s.a.createElement(o.EuiFlexGroup,{justifyContent:"flexEnd"},s.a.createElement(o.EuiFlexItem,{grow:!1},s.a.createElement(o.EuiButtonEmpty,{onClick:t,disabled:b,"data-test-subj":"hostIsolateCancelButton"},l)),s.a.createElement(o.EuiFlexItem,{grow:!1},s.a.createElement(o.EuiButton,{fill:!0,onClick:n,disabled:b,isLoading:b},c)))))}));y.displayName="EndpointUnisolateForm";var j=n(91),S=n(107);const O=Object(a.memo)((({"data-test-subj":e,pendingActions:t})=>s.a.createElement(o.EuiBadge,{color:"hollow","data-test-subj":e},s.a.createElement(o.EuiToolTip,{display:"block",anchorClassName:"eui-textTruncate",content:s.a.createElement("div",{style:{width:150},"data-test-subj":`${e}-tooltipContent`},s.a.createElement("div",null,s.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolationStatus.tooltipPendingActions",defaultMessage:"Pending actions:"})),!!t.pendingIsolate&&s.a.createElement(o.EuiFlexGroup,{gutterSize:"none",justifyContent:"spaceBetween"},s.a.createElement(o.EuiFlexItem,null,s.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolationStatus.tooltipPendingIsolate",defaultMessage:"Isolate"})),s.a.createElement(o.EuiFlexItem,{grow:!1},t.pendingIsolate)),!!t.pendingUnIsolate&&s.a.createElement(o.EuiFlexGroup,{gutterSize:"none"},s.a.createElement(o.EuiFlexItem,null,s.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolationStatus.tooltipPendingUnIsolate",defaultMessage:"Release"})),s.a.createElement(o.EuiFlexItem,{grow:!1},t.pendingUnIsolate)),!!t.pendingKillProcess&&s.a.createElement(o.EuiFlexGroup,{gutterSize:"none"},s.a.createElement(o.EuiFlexItem,null,s.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolationStatus.tooltipPendingKillProcess",defaultMessage:"Kill process"})),s.a.createElement(o.EuiFlexItem,{grow:!1},t.pendingKillProcess)),!!t.pendingSuspendProcess&&s.a.createElement(o.EuiFlexGroup,{gutterSize:"none"},s.a.createElement(o.EuiFlexItem,null,s.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolationStatus.tooltipPendingSuspendProcess",defaultMessage:"Suspend process"})),s.a.createElement(o.EuiFlexItem,{grow:!1},t.pendingSuspendProcess)),!!t.pendingRunningProcesses&&s.a.createElement(o.EuiFlexGroup,{gutterSize:"none"},s.a.createElement(o.EuiFlexItem,null,s.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolationStatus.tooltipPendingRunningProcesses",defaultMessage:"Processes"})),s.a.createElement(o.EuiFlexItem,{grow:!1},t.pendingRunningProcesses)))},s.a.createElement(o.EuiTextColor,{color:"subdued","data-test-subj":`${e}-pending`},s.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolationStatus.multiplePendingActions",defaultMessage:"{count} {count, plural, one {action} other {actions}} pending",values:{count:Object.values(t).reduce(((e,t)=>e+t),0)}}))))));O.displayName="AgentPendingActionStatusBadge";const k=Object(a.memo)((({isIsolated:e,pendingActions:t,"data-test-subj":n})=>{const r=Object(j.a)(n),l=Object(S.a)("disableIsolationUIPendingStatuses"),{pendingIsolate:c=0,pendingUnIsolate:u=0,pendingKillProcess:d=0,pendingSuspendProcess:m=0,pendingRunningProcesses:p=0}=t,g=Object(a.useRef)(!1),f=Object(a.useRef)(!1),b=Object(a.useMemo)((()=>c+u+d+m+p),[c,d,p,m,u]),h=Object(a.useMemo)((()=>Object.values(t).reduce(((e,t)=>t>0?e+1:e),0)>1),[t]);return Object(a.useEffect)((()=>{g.current=0===c&&u>0,f.current=c>0&&0===u}),[c,u]),Object(a.useMemo)((()=>{if(l)return e?s.a.createElement(o.EuiBadge,{color:"hollow","data-test-subj":n},s.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolationStatus.isolated",defaultMessage:"Isolated"})):null;if(0===b){if(!f.current&&g.current||!e)return null;if(!e&&f.current&&!g.current||e)return s.a.createElement(o.EuiBadge,{color:"hollow","data-test-subj":n},s.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolationStatus.isolated",defaultMessage:"Isolated"}))}return h||!c&&!u?s.a.createElement(O,{"data-test-subj":n,pendingActions:t}):s.a.createElement(o.EuiBadge,{color:"hollow","data-test-subj":n},s.a.createElement(o.EuiTextColor,{color:"subdued","data-test-subj":r("pending")},c?s.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolationStatus.isIsolating",defaultMessage:"Isolating"}):s.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolationStatus.isUnIsolating",defaultMessage:"Releasing"})))}),[l,b,h,c,u,n,r,e,t])}));k.displayName="EndpointHostIsolationStatus";const x=s.a.memo((({onClick:e,buttonText:t})=>{const n=Object(a.useCallback)((()=>e()),[e]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(o.EuiSpacer,{size:"m"}),s.a.createElement(o.EuiFlexGroup,{gutterSize:"none",justifyContent:"flexEnd"},s.a.createElement(o.EuiFlexItem,{grow:!1},s.a.createElement(o.EuiButtonEmpty,{flush:"right",onClick:n,"data-test-subj":"hostIsolateSuccessCompleteButton"},s.a.createElement(o.EuiText,{size:"s"},s.a.createElement("p",null,t))))))}));x.displayName="ActionCompletionReturnButton"},316:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var a=n(82),s=n.n(a),o=n(4),i=n.n(o),r=n(32),l=n(35),c=n(33),u=n.n(c),d=n(81),m=n(104),p=n(112),g=n(86),f=n(1080),b=n(205);const h=(e,t)=>(t===b.a.createCase||t===b.a.submitCase)&&e===b.b.alertsCases,E=u()(r.EuiTourStep).withConfig({displayName:"StyledTourStep",componentId:"sc-13d1ztn-0"})(["&.euiPopover__panel[data-popover-open]{z-index:",";}"],(({step:e,tourId:t})=>h(t,e)?"9000 !important":"1000 !important")),v=({children:e,onClick:t,step:n,tourId:a})=>{const{activeStep:c,incrementStep:u,isTourShown:v}=Object(f.b)(),y=Object(o.useMemo)((()=>b.e[a].find((e=>e.step===n))),[n,a]),j=Object(o.useMemo)((()=>g.b.getTimelineByIdSelector()),[]),S=Object(d.b)((e=>{var t;return(null!==(t=j(e,m.d.active))&&void 0!==t?t:p.b).show})),O=Object(o.useCallback)((()=>t?t():u(a)),[u,t,a]),k=Object(o.useCallback)((e=>{"Enter"===e.key&&e.stopPropagation()}),[]),x=h(a,n);if(null==y||(n!==c||!v(a))&&!x||S)return e||null;const{anchor:C,content:I,imageConfig:F,dataTestSubj:w,hideNextButton:M=!1,...A}=y,T=M?i.a.createElement(i.a.Fragment,null):i.a.createElement(r.EuiButton,{size:"s",onClick:O,onKeyDown:k,color:"success","data-test-subj":"onboarding--securityTourNextStepButton","tour-step":"nextButton"},i.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.guided_onboarding.nextStep.buttonLabel",defaultMessage:"Next"})),N={...A,content:i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiText,{size:"s"},i.a.createElement("p",null,I)),F&&i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement(r.EuiImage,{alt:F.altText,src:F.src,size:"fullWidth"}))),footerAction:T,isStepOpen:!0,onFinish:()=>null,stepsTotal:b.e[a].length,panelProps:{"data-test-subj":w}};return null!=C?i.a.createElement(i.a.Fragment,null,i.a.createElement(E,s()({tourId:a},N,{anchor:C})),i.a.createElement(i.a.Fragment,null,e)):null!=e?i.a.createElement(E,s()({tourId:a},N),e):null},y=({children:e,isTourAnchor:t=!0,...n})=>t?i.a.createElement(v,n,e):i.a.createElement(i.a.Fragment,null,e)},351:function(e,t,n){"use strict";n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var a=n(34);const s=e=>e.replace(/:/g,"-"),o=e=>e.replace(/-/g,":"),i=e=>Object(a.isUndefined)(e)?void 0:Object(a.castArray)(e),r="51px"},382:function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i})),n(1);var a=n(209);const s=(e,t)=>`/${e}${Object(a.a)(t)}`,o=(e,t)=>`/name/${e}${Object(a.a)(t)}`,i=(e,t,n)=>`/name/${e}/${t}${Object(a.a)(n)}`},383:function(e,t,n){"use strict";let a;n.d(t,"a",(function(){return a})),n(229).NetworkType.details,function(e){e.anomalies="anomalies",e.flows="flows",e.tls="tls",e.http="http",e.events="events",e.users="users"}(a||(a={}))},405:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return l}));var a=n(4),s=n(37),o=n(105),i=n(232);const r=e=>{var t,n,a;const s={pageSize:o.c,page:1};return s.page=Number(null!==(t=Array.isArray(e.page)?e.page[e.page.length-1]:e.page)&&void 0!==t?t:s.page),s.pageSize=null!==(n=Number(null!==(a=Array.isArray(e.pageSize)?e.pageSize[e.pageSize.length-1]:e.pageSize)&&void 0!==a?a:s.pageSize))&&void 0!==n?n:s.pageSize,(!Number.isFinite(s.page)||s.page<1)&&(s.page=1),o.f.includes(s.pageSize)||(s.pageSize=o.c),s},l=()=>{const e=Object(s.useLocation)(),t=Object(s.useHistory)(),{urlParams:n,toUrlParams:l}=Object(i.a)(),c=Object(a.useMemo)((()=>r(n)),[n]),[u,d]=Object(a.useState)(c),m=Object(a.useCallback)((({pageSize:a,page:s})=>{t.push({...e,search:l({...n,page:s,pageSize:a})})}),[t,e,l,n]);return Object(a.useEffect)((()=>{d((e=>({...e,...r(n)})))}),[d,n]),{pagination:u,setPagination:m,pageSizeOptions:[...o.f]}}},430:function(e,t,n){"use strict";n.d(t,"i",(function(){return s})),n.d(t,"c",(function(){return o})),n.d(t,"j",(function(){return i})),n.d(t,"d",(function(){return r})),n.d(t,"h",(function(){return l})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"o",(function(){return d})),n.d(t,"n",(function(){return m})),n.d(t,"k",(function(){return p})),n.d(t,"m",(function(){return g})),n.d(t,"l",(function(){return f})),n.d(t,"b",(function(){return b})),n.d(t,"a",(function(){return h})),n.d(t,"g",(function(){return E}));var a=n(0);const s=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.locationTitle",{defaultMessage:"Location"}),o=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.autonomousSystemTitle",{defaultMessage:"Autonomous system"}),i=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.maxAnomalyScoreByJobTitle",{defaultMessage:"Max anomaly score by job"}),r=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.firstSeenTitle",{defaultMessage:"First seen"}),l=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.lastSeenTitle",{defaultMessage:"Last seen"}),c=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.hostIdTitle",{defaultMessage:"Host ID"}),u=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.hostNameTitle",{defaultMessage:"Host name"}),d=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.whoIsTitle",{defaultMessage:"WhoIs"}),m=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.viewWhoisTitle",{defaultMessage:"iana.org"}),p=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.ipReputationTitle",{defaultMessage:"Reputation"}),g=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.viewVirusTotalTitle.",{defaultMessage:"virustotal.com"}),f=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.viewTalosIntelligenceTitle",{defaultMessage:"talosIntelligence.com"}),b=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.asSourceDropDownOptionLabel",{defaultMessage:"As Source"}),h=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.asDestinationDropDownOptionLabel",{defaultMessage:"As Destination"}),E=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.inspectTitle",{defaultMessage:"IP overview"})},522:function(e,t,n){"use strict";let a;n.d(t,"a",(function(){return a})),function(e){e.endpoints="endpoints",e.policies="policy",e.trustedApps="trusted_apps",e.eventFilters="event_filters",e.hostIsolationExceptions="host_isolation_exceptions",e.blocklist="blocklist",e.responseActionsHistory="response_actions_history"}(a||(a={}))},562:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return r}));var a=n(0);const s=Object.freeze({hasExpired:e=>a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.hasExpired",{defaultMessage:"{command} failed: action expired",values:{command:e}}),wasSuccessful:e=>a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.wasSuccessful",{defaultMessage:"{command} completed successfully",values:{command:e}}),isPending:e=>a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.isPending",{defaultMessage:"{command} is pending",values:{command:e}}),hasFailed:e=>a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.hasFailed",{defaultMessage:"{command} failed",values:{command:e}}),expandSection:{placedAt:a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.expandSection.placedAt",{defaultMessage:"Command placed"}),input:a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.expandSection.input",{defaultMessage:"Input"}),output:a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.expandSection.output",{defaultMessage:"Output"}),startedAt:a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.expandSection.startedAt",{defaultMessage:"Execution started on"}),parameters:a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.expandSection.parameters",{defaultMessage:"Parameters"}),completedAt:a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.expandSection.completedAt",{defaultMessage:"Execution completed"}),comment:a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.expandSection.comment",{defaultMessage:"Comment"})}}),o=Object.freeze({time:a.i18n.translate("xpack.securitySolution.responseActionsList.list.time",{defaultMessage:"Time"}),command:a.i18n.translate("xpack.securitySolution.responseActionsList.list.command",{defaultMessage:"Command"}),user:a.i18n.translate("xpack.securitySolution.responseActionsList.list.user",{defaultMessage:"User"}),hosts:a.i18n.translate("xpack.securitySolution.responseActionsList.list.hosts",{defaultMessage:"Hosts"}),comments:a.i18n.translate("xpack.securitySolution.responseActionsList.list.comments",{defaultMessage:"Comments"}),status:a.i18n.translate("xpack.securitySolution.responseActionsList.list.status",{defaultMessage:"Status"})}),i=Object.freeze({flyoutTitle:e=>a.i18n.translate("xpack.securitySolution.responseActionsList.flyout.title",{defaultMessage:"Response actions history : {hostname}",values:{hostname:e}}),pageSubTitle:a.i18n.translate("xpack.securitySolution.responseActionsList.list.pageSubTitle",{defaultMessage:"View the history of response actions performed on hosts."}),fetchError:a.i18n.translate("xpack.securitySolution.responseActionsList.list.errorMessage",{defaultMessage:"Error while retrieving response actions"}),filterClearAll:a.i18n.translate("xpack.securitySolution.responseActionsList.list.filter.clearAll",{defaultMessage:"Clear all"}),filterSearchPlaceholder:e=>a.i18n.translate("xpack.securitySolution.responseActionsList.list.filter.searchPlaceholder",{defaultMessage:"Search {filterName}",values:{filterName:e}}),filterEmptyMessage:e=>a.i18n.translate("xpack.securitySolution.responseActionsList.list.filter.emptyMessage",{defaultMessage:"No {filterName} available",values:{filterName:e}}),badge:{successful:a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.badge.successful",{defaultMessage:"Successful"}),failed:a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.badge.failed",{defaultMessage:"Failed"}),pending:a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.badge.pending",{defaultMessage:"Pending"})},unenrolled:{hosts:a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.hosts.unenrolled.hosts",{defaultMessage:"Hosts unenrolled"}),host:a.i18n.translate("xpack.securitySolution.responseActionsList.list.item.hosts.unenrolled.host",{defaultMessage:"Host unenrolled"})},screenReaderExpand:a.i18n.translate("xpack.securitySolution.responseActionsList.list.screenReader.expand",{defaultMessage:"Expand rows"}),recordsLabel:e=>a.i18n.translate("xpack.securitySolution.responseActionsList.list.recordRangeLabel",{defaultMessage:"{records, plural, one {response action} other {response actions}}",values:{records:e}})}),r=Object.freeze({actions:a.i18n.translate("xpack.securitySolution.responseActionsList.list.filter.actions",{defaultMessage:"Actions"}),hosts:a.i18n.translate("xpack.securitySolution.responseActionsList.list.filter.Hosts",{defaultMessage:"Hosts"}),statuses:a.i18n.translate("xpack.securitySolution.responseActionsList.list.filter.statuses",{defaultMessage:"Statuses"}),users:a.i18n.translate("xpack.securitySolution.responseActionsList.list.filter.users",{defaultMessage:"Filter by username"})})},563:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(4),s=n.n(a),o=n(32),i=n(647);const r=Object(a.memo)((({"data-test-subj":e})=>s.a.createElement(i.a,null,s.a.createElement(o.EuiLoadingSpinner,{"data-test-subj":e,size:"l"}))));r.displayName="ManagementPageLoader"},600:function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var a=n(209);const s=(e,t)=>`/name/${e}${Object(a.a)(t)}`,o=(e,t,n)=>`/name/${e}/${t}${Object(a.a)(n)}`,i=(e,t)=>`/${e}${Object(a.a)(t)}`},638:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(4),s=n.n(a),o=n(32),i=n(1083),r=n(1158);const l=s.a.memo((({hostStatus:e})=>s.a.createElement(o.EuiBadge,{color:null!=e?i.a[e]:"warning","data-test-subj":"rowHostStatus",className:"eui-textTruncate"},Object(r.a)(e))));l.displayName="AgentStatus"},647:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(4),s=n.n(a),o=n(32),i=n(33);const r=n.n(i)()(o.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-1wriy1f-0"})(["min-height:calc(100vh - 140px);"]),l=Object(a.memo)((({children:e,"data-test-subj":t})=>s.a.createElement(r,{direction:"column",alignItems:"center","data-test-subj":t},s.a.createElement(o.EuiPageTemplate_Deprecated,{template:"centeredContent"},e))));l.displayName="ManagementEmptyStateWrapper"},691:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return he})),n.d(t,"a",(function(){return Ee}));var a=n(39),s=n(547),o=n(77),i=n(226);const r=(e,t={})=>{const n=Object(o.j)();return Object(a.useQuery)({queryKey:["get-endpoint-host-info",e],...t,queryFn:()=>n.get(Object(s.a)(i.j,{id:e.trim()||"undefined"}))})};var l=n(4),c=n.n(l),u=n(0),d=n(116),m=n(21),p=n(35),g=n(129),f=n(91),b=n(82),h=n.n(b);const E=Object.freeze({"ra_get-file_error_not-found":u.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.getFile.notFound",{defaultMessage:"The file specified was not found"}),"ra_get-file_error_is-directory":u.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.getFile.isDirectory",{defaultMessage:"The path defined is not a file"}),"ra_get-file_error_invalid-input":u.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.getFile.invalidPath",{defaultMessage:"The path defined is not valid"}),"ra_get-file_error_not-permitted":u.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.getFile.notPermitted",{defaultMessage:"Endpoint unable to read file requested (not permitted)"}),"ra_get-file_error_too-big":u.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.getFile.tooBig",{defaultMessage:"The file requested is too large and can not be retrieved"}),"ra_get-file_error_disk-quota":u.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.getFile.diskQuota",{defaultMessage:"Endpoint ran out of disk quota while attempting to retrieve file"}),"ra_get-file_error_processing":u.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.getFile.errorProcessing",{defaultMessage:"File retrieval was interrupted"}),"ra_get-file_error_upload-api-unreachable":u.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.getFile.uploadApiUnreachable",{defaultMessage:"File upload api (fleet-server) is unreachable"}),"ra_get-file_error_upload-timeout":u.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.getFile.uploadTimeout",{defaultMessage:"File upload timed out"}),"ra_get-file_error_queue-timeout":u.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.getFile.queueTimeout",{defaultMessage:"Endpoint timed out while attempting to connect to upload API"}),"ra_suspend-process_error_not-found":u.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.suspendProcess.notFoundError",{defaultMessage:"The provided process was not found"}),"ra_suspend-process_error_not-permitted":u.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.suspendProcess.notPermittedSuccess",{defaultMessage:"The provided process cannot be suspended"}),"ra_kill-process_error_not-found":u.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.killProcess.notFoundError",{defaultMessage:"The provided process was not found"}),"ra_kill-process_success_no-action":u.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.killProcess.noActionSuccess",{defaultMessage:"Action completed. The provided process was not found or already killed"}),"ra_kill-process_error_not-permitted":u.i18n.translate("xpack.securitySolution.endpointActionResponseCodes.killProcess.notPermittedSuccess",{defaultMessage:"The provided process cannot be killed"})}),v=Object(l.memo)((({action:e,ResultComponent:t,title:n,...a})=>{const s=Object(l.useMemo)((()=>{var t,a,s;if(n)return n;const o=e.agents[0],i=null===(t=e.outputs)||void 0===t||null===(a=t[o])||void 0===a||null===(s=a.content)||void 0===s?void 0:s.code;return i?E[i]:void 0}),[n,e.agents,e.outputs]);return c.a.createElement(t,h()({},a,{title:s}))}));v.displayName="ActionSuccess";var y=n(32);const j=Object(l.memo)((({action:e})=>Object(l.useMemo)((()=>{if(!e.isCompleted||e.wasSuccessful)return null;const t=[];if(e.outputs)for(const n of e.agents){const a=e.outputs[n];a&&"json"===a.type&&a.content.code&&E[a.content.code]&&t.push(E[a.content.code])}return t.length||(e.errors?t.push(...e.errors):t.push(u.i18n.translate("xpack.securitySolution.endpointActionFailureMessage.unknownFailure",{defaultMessage:"Action failed"}))),c.a.createElement(c.a.Fragment,null,c.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.endpointResponseActions.actionError.errorMessage",defaultMessage:"The following { errorCount, plural, =1 {error was} other {errors were}} encountered:",values:{errorCount:t.length}}),c.a.createElement(y.EuiSpacer,{size:"s"}),c.a.createElement("div",null,t.join(" | ")))}),[e])));j.displayName="EndpointActionFailureMessage";const S=Object(l.memo)((({title:e,dataTestSubj:t,action:n,ResultComponent:a})=>c.a.createElement(a,{showAs:"failure",title:e,"data-test-subj":t},c.a.createElement(j,{action:n}))));S.displayName="ActionError";var O=n(1089);const k=({actionCreator:e,actionRequestBody:t,setStatus:n,status:r,setStore:u,store:d,ResultComponent:m,dataTestSubj:b,pendingMessage:h,successMessage:E})=>{const y=Object(g.b)(),j=Object(f.a)(b),k="pending"===r,x=Object(l.useMemo)((()=>{var e;return null!==(e=d.actionApiState)&&void 0!==e?e:{request:{sent:!1,error:void 0,actionId:void 0},actionDetails:void 0,actionDetailsError:void 0}}),[d.actionApiState]),{actionDetails:C,actionDetailsError:I}=x,{actionId:F,sent:w,error:M}=x.request,{data:A,error:T}=((e,t={})=>{const n=Object(o.j)();return Object(a.useQuery)({queryKey:["get-action-details",e],...t,queryFn:()=>n.get(Object(s.a)(i.c,{action_id:e.trim()||"undefined"}))})})(null!=F?F:"-",{enabled:Boolean(F)&&k,refetchInterval:!!k&&3e3});return Object(l.useEffect)((()=>{if(!w&&t&&y()){const n={...x.request,sent:!0};e.mutateAsync(t).then((e=>{n.actionId=e.data.id})).catch((e=>{n.error=e})).finally((()=>{y()&&u((e=>{var t;return{...e,actionApiState:{...null!==(t=e.actionApiState)&&void 0!==t?t:x,request:{...n}}}}))})),u((e=>{var t;return{...e,actionApiState:{...null!==(t=e.actionApiState)&&void 0!==t?t:x,request:n}}}))}}),[e,t,w,x,y,u]),Object(l.useEffect)((()=>{M&&k&&n("error")}),[M,k,n]),Object(l.useEffect)((()=>{T&&k&&(n("error"),u((e=>{var t;return{...e,actionApiState:{...null!==(t=e.actionApiState)&&void 0!==t?t:x,actionDetails:void 0,actionDetailsError:T}}})))}),[T,x,k,n,u]),Object(l.useEffect)((()=>{null!=A&&A.data.isCompleted&&k&&(n(null!=A&&A.data.wasSuccessful?"success":"error"),u((e=>{var t;return{...e,actionApiState:{...null!==(t=e.actionApiState)&&void 0!==t?t:x,actionDetails:A.data}}})))}),[A,x,k,n,u]),{result:Object(l.useMemo)((()=>{if(k)return c.a.createElement(m,{showAs:"pending","data-test-subj":j("pending")},h);const e=M||I;return e?c.a.createElement(m,{showAs:"failure","data-test-subj":j("apiFailure")},c.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.endpointResponseActions.actionSubmitter.apiErrorDetails",defaultMessage:"The following error was encountered:"}),c.a.createElement(O.a,{error:e,"data-test-subj":j("apiErrorDetails")})):C?C.errors?c.a.createElement(S,{ResultComponent:m,action:C,dataTestSubj:j("actionFailure")}):c.a.createElement(v,{ResultComponent:m,action:C,"data-test-subj":j("success"),title:E}):c.a.createElement(c.a.Fragment,null)}),[k,M,I,C,m,j,h,E]),actionDetails:x.actionDetails}};var x=n(1165);const C=Object(l.memo)((({command:e,setStore:t,store:n,status:s,setStatus:r,ResultComponent:d})=>{var m,p;const g=Object(a.useMutation)((e=>o.b.get().http.post(i.h,{body:JSON.stringify(e)})),undefined);const f=Object(l.useMemo)((()=>{var t,n;const a=null===(t=e.commandDefinition)||void 0===t||null===(n=t.meta)||void 0===n?void 0:n.endpointId,{path:s,comment:o}=e.args.args;return a?{endpoint_ids:[a],comment:null==o?void 0:o[0],parameters:{path:s[0]}}:void 0}),[e.args.args,null===(m=e.commandDefinition)||void 0===m||null===(p=m.meta)||void 0===p?void 0:p.endpointId]),{result:b,actionDetails:h}=k({ResultComponent:d,setStore:t,store:n,status:s,setStatus:r,actionCreator:g,actionRequestBody:f,dataTestSubj:"getFile",pendingMessage:u.i18n.translate("xpack.securitySolution.getFileAction.pendingMessage",{defaultMessage:"Retrieving the file from host."})});return null!=h&&h.isCompleted&&h.wasSuccessful?c.a.createElement(d,{showAs:"success","data-test-subj":"getFileSuccess",title:u.i18n.translate("xpack.securitySolution.endpointResponseActions.getFileAction.successTitle",{defaultMessage:"File retrieved from the host."})},c.a.createElement(x.a,{action:h})):b}));C.displayName="GetFileActionResult";var I=n(740);const F=Object(l.memo)((({command:e,setStore:t,store:n,status:s,setStatus:o,ResultComponent:i})=>{var r,c,u;const d=Object(a.useMutation)((e=>Object(I.a)(e)),undefined);const m=Object(l.useMemo)((()=>{var t,n,a,s;const o=null===(t=e.commandDefinition)||void 0===t||null===(n=t.meta)||void 0===n?void 0:n.endpointId,i=null===(a=e.args.args)||void 0===a||null===(s=a.comment)||void 0===s?void 0:s[0];return o?{endpoint_ids:[o],comment:i}:void 0}),[null===(r=e.args.args)||void 0===r?void 0:r.comment,null===(c=e.commandDefinition)||void 0===c||null===(u=c.meta)||void 0===u?void 0:u.endpointId]);return k({ResultComponent:i,setStore:t,store:n,status:s,setStatus:o,actionCreator:d,actionRequestBody:m,dataTestSubj:"isolate"}).result}));F.displayName="IsolateActionResult";const w=Object(l.memo)((({command:e,setStore:t,store:n,status:s,setStatus:o,ResultComponent:i})=>{var r,c,u;const d=Object(a.useMutation)((e=>Object(I.b)(e)),undefined);const m=Object(l.useMemo)((()=>{var t,n,a,s;const o=null===(t=e.commandDefinition)||void 0===t||null===(n=t.meta)||void 0===n?void 0:n.endpointId,i=null===(a=e.args.args)||void 0===a||null===(s=a.comment)||void 0===s?void 0:s[0];return o?{endpoint_ids:[o],comment:i}:void 0}),[null===(r=e.args.args)||void 0===r?void 0:r.comment,null===(c=e.commandDefinition)||void 0===c||null===(u=c.meta)||void 0===u?void 0:u.endpointId]);return k({ResultComponent:i,setStore:t,store:n,status:s,setStatus:o,actionCreator:d,actionRequestBody:m,dataTestSubj:"release"}).result}));w.displayName="ReleaseActionResult";const M=e=>{var t,n;return e.pid?{pid:Number(e.pid[0])}:{entity_id:null!==(t=null==e||null===(n=e.entityId)||void 0===n?void 0:n[0])&&void 0!==t?t:""}},A=Object(l.memo)((({command:e,setStore:t,store:n,status:s,setStatus:r,ResultComponent:c})=>{var u,d;const m=Object(a.useMutation)((e=>{return t=e,o.b.get().http.post(i.m,{body:JSON.stringify(t)});var t}),g),p=Object(l.useMemo)((()=>{var t,n,a,s;const o=null===(t=e.commandDefinition)||void 0===t||null===(n=t.meta)||void 0===n?void 0:n.endpointId,i=M(e.args.args);return o?{endpoint_ids:[o],comment:null===(a=e.args.args)||void 0===a||null===(s=a.comment)||void 0===s?void 0:s[0],parameters:i}:void 0}),[e.args.args,null===(u=e.commandDefinition)||void 0===u||null===(d=u.meta)||void 0===d?void 0:d.endpointId]);var g;return k({ResultComponent:c,setStore:t,store:n,status:s,setStatus:r,actionCreator:m,actionRequestBody:p,dataTestSubj:"killProcess"}).result}));A.displayName="KillProcessActionResult";const T=Object(l.memo)((({command:e,setStore:t,store:n,status:s,setStatus:r,ResultComponent:c})=>{var u,d;const m=Object(a.useMutation)((e=>{return t=e,o.b.get().http.post(i.p,{body:JSON.stringify(t)});var t}),g),p=Object(l.useMemo)((()=>{var t,n,a,s;const o=null===(t=e.commandDefinition)||void 0===t||null===(n=t.meta)||void 0===n?void 0:n.endpointId,i=M(e.args.args);return o?{endpoint_ids:[o],comment:null===(a=e.args.args)||void 0===a||null===(s=a.comment)||void 0===s?void 0:s[0],parameters:i}:void 0}),[e.args.args,null===(u=e.commandDefinition)||void 0===u||null===(d=u.meta)||void 0===d?void 0:d.endpointId]);var g;return k({ResultComponent:c,setStore:t,store:n,status:s,setStatus:r,actionCreator:m,actionRequestBody:p,dataTestSubj:"suspendProcess"}).result}));T.displayName="SuspendProcessActionResult";var N=n(117),R=n(918);const D=(e,t={})=>Object(a.useQuery)({queryKey:["fetch-endpoint-pending-actions-summary",...e],...t,queryFn:()=>Object(R.a)(e)});var L=n(101),P=n(824),$=n(1083),_=n(1158);const z=Object(l.memo)((({command:e,status:t,setStatus:n,store:a,setStore:s,ResultComponent:o})=>{var i,d;const m=null===(i=e.commandDefinition)||void 0===i||null===(d=i.meta)||void 0===d?void 0:d.endpointId,{endpointPendingActions:p,endpointDetails:g,detailsFetchError:f,apiCalled:b}=a,h="pending"===t,E=Object(l.useMemo)((()=>Object(N.v4)()),[]),{data:v,error:j,isFetching:S,isFetched:k}=r(m,{enabled:h,queryKey:[E]}),{data:x}=D([m],{enabled:h,queryKey:[E,m]}),C=Object(l.useMemo)((()=>{if(null!=p&&p.data.length){var e,t;const n=p.data[0].pending_actions;return{pendingIsolate:null!==(e=n.isolate)&&void 0!==e?e:0,pendingUnIsolate:null!==(t=n.unisolate)&&void 0!==t?t:0}}return{pendingIsolate:0,pendingUnIsolate:0}}),[null==p?void 0:p.data]);Object(l.useEffect)((()=>{b||s((e=>({...e,apiCalled:!0})))}),[b,s]),Object(l.useEffect)((()=>{k&&h&&(n(f?"error":"success"),s((e=>({...e,endpointDetails:v,detailsFetchError:null!=j?j:void 0}))))}),[f,k,n,h,s,v,j]),Object(l.useEffect)((()=>{x&&!p&&s((e=>({...e,endpointPendingActions:x})))}),[x,s,p]);const I=Object(l.useCallback)((()=>{if(!g)return;const e=[{title:c.a.createElement(P.a,null,u.i18n.translate("xpack.securitySolution.endpointResponseActions.status.agentStatus",{defaultMessage:"Agent status"})),description:c.a.createElement(P.a,null,(()=>{var e;let t="";return C.pendingIsolate>0?t=u.i18n.translate("xpack.securitySolution.endpointResponseActions.status.isolating",{defaultMessage:"Isolating"}):C.pendingUnIsolate>0?t=u.i18n.translate("xpack.securitySolution.endpointResponseActions.status.releasing",{defaultMessage:"Releasing"}):null!=g&&null!==(e=g.metadata.Endpoint.state)&&void 0!==e&&e.isolation&&(t=u.i18n.translate("xpack.securitySolution.endpointResponseActions.status.isolated",{defaultMessage:"Isolated"})),`${Object(_.a)(g.host_status)}${t.length>0?` - ${t}`:""}`})())},{title:c.a.createElement(P.a,null,u.i18n.translate("xpack.securitySolution.endpointResponseActions.status.version",{defaultMessage:"Version"})),description:g.metadata.agent.version},{title:c.a.createElement(P.a,null,u.i18n.translate("xpack.securitySolution.endpointResponseActions.status.policyStatus",{defaultMessage:"Policy status"})),description:c.a.createElement(P.a,null,$.d[g.metadata.Endpoint.policy.applied.status])},{title:c.a.createElement(P.a,null,u.i18n.translate("xpack.securitySolution.endpointResponseActions.status.lastActive",{defaultMessage:"Last active"})),description:c.a.createElement(P.a,null,c.a.createElement(L.a,{fieldName:u.i18n.translate("xpack.securitySolution.endpointResponseActions.status.lastActive",{defaultMessage:"Last active"}),value:g.metadata["@timestamp"],className:"eui-textTruncate"}))}];return c.a.createElement(y.EuiDescriptionList,{compressed:!0,type:"column",className:"descriptionList-20_80",listItems:e,"data-test-subj":"agent-status-console-output"})}),[C.pendingIsolate,C.pendingUnIsolate,g]);return f?c.a.createElement(o,{showAs:"failure"},c.a.createElement(O.a,{error:f})):S||!g?c.a.createElement(o,{showAs:"pending"}):c.a.createElement(o,{showTitle:!1},I())}));z.displayName="EndpointStatusActionResult";var U=n(33),B=n.n(U);const H=B()(y.EuiBasicTable).withConfig({displayName:"StyledEuiBasicTable",componentId:"sc-1dx79hn-0"})(["table{background-color:",";}.euiTableHeaderCell{border-bottom:",";.euiTableCellContent__text{font-weight:",";}}.euiTableRow{&:hover{background-color:white !important;}.euiTableRowCell{border-top:none !important;border-bottom:none !important;}}"],(({theme:{eui:e}})=>e.euiPageBackgroundColor),(e=>e.theme.eui.euiBorderThin),(e=>e.theme.eui.euiFontWeightRegular)),q=Object(l.memo)((({command:e,setStore:t,store:n,status:s,setStatus:r,ResultComponent:d})=>{var m,p,g;const f=null===(m=e.commandDefinition)||void 0===m||null===(p=m.meta)||void 0===p?void 0:p.endpointId,b=Object(a.useMutation)((e=>o.b.get().http.post(i.i,{body:JSON.stringify(e)})),undefined);const h=Object(l.useMemo)((()=>{var t,n;return f?{endpoint_ids:[f],comment:null===(t=e.args.args)||void 0===t||null===(n=t.comment)||void 0===n?void 0:n[0]}:void 0}),[null===(g=e.args.args)||void 0===g?void 0:g.comment,f]),{result:E,actionDetails:v}=k({ResultComponent:d,setStore:t,store:n,status:s,setStatus:r,actionCreator:b,actionRequestBody:h,dataTestSubj:"getProcesses"}),y=Object(l.useMemo)((()=>[{field:"user",name:u.i18n.translate("xpack.securitySolution.endpointResponseActions.getProcesses.table.header.user",{defaultMessage:"USER"}),width:"10%"},{field:"pid",name:u.i18n.translate("xpack.securitySolution.endpointResponseActions.getProcesses.table.header.pid",{defaultMessage:"PID"}),width:"5%"},{field:"entity_id",name:u.i18n.translate("xpack.securitySolution.endpointResponseActions.getProcesses.table.header.enityId",{defaultMessage:"ENTITY ID"}),width:"30%"},{field:"command",name:u.i18n.translate("xpack.securitySolution.endpointResponseActions.getProcesses.table.header.command",{defaultMessage:"COMMAND"}),width:"55%"}]),[]),j=Object(l.useMemo)((()=>{var e,t,n;return f&&null!==(e=null==v||null===(t=v.outputs)||void 0===t||null===(n=t[f])||void 0===n?void 0:n.content.entries)&&void 0!==e?e:[]}),[null==v?void 0:v.outputs,f]);return v&&v.wasSuccessful?c.a.createElement(d,{"data-test-subj":"getProcessesSuccessCallout",showTitle:!1},c.a.createElement(H,{items:[...j],columns:y})):E}));q.displayName="GetProcessesActionResult";var G=n(14);const W=u.i18n.translate("xpack.securitySolution.endpointConsoleCommands.suspendProcess.unsupportedCommandInfo",{defaultMessage:"This version of the Endpoint does not support this command. Upgrade your Agent in Fleet to use the latest response actions."}),K=c.a.memo((()=>c.a.createElement(y.EuiIconTip,{content:W,type:"alert",color:"danger"})));K.displayName="DisabledTooltip";const Y=({aboutInfo:e,isSupported:t})=>t?e:c.a.createElement(c.a.Fragment,null,e," ",c.a.createElement(K,null)),V=e=>{var t;return(null==e?void 0:e.length)>0&&"string"==typeof e[0]&&(null===(t=e[0])||void 0===t?void 0:t.trim().length)>0||u.i18n.translate("xpack.securitySolution.endpointConsoleCommands.emptyArgumentMessage",{defaultMessage:"Argument cannot be empty"})},Q=e=>{const t=V(e);return!0!==t?t:!!(Number.isSafeInteger(Number(e))&&Number(e)>0)||u.i18n.translate("xpack.securitySolution.endpointConsoleCommands.invalidPidMessage",{defaultMessage:"Argument must be a positive number representing the PID of a process"})},J=new Map([["isolate","isolation"],["release","isolation"],["kill-process","kill_process"],["suspend-process","suspend_process"],["processes","running_processes"],["get-file","get_file"]]),X=({commandName:e,privileges:t})=>{var n;return null!==(n=new Map([["isolate",t.canIsolateHost],["release",t.canUnIsolateHost],["kill-process",t.canKillProcess],["suspend-process",t.canSuspendProcess],["processes",t.canGetRunningProcesses],["get-file",t.canWriteFileOperations]]).get(e))&&void 0!==n&&n},Z=e=>{const t=e.commandDefinition.meta.privileges,n=e.commandDefinition.meta.capabilities,a=e.commandDefinition.name,s=J.get(a);let o="";return s||(o=o.concat(G.h)),s&&(n.includes(s)||(o=o.concat(G.h))),!0!==X({commandName:a,privileges:t})&&(o=o.concat(G.b)),!o.length||o},ee=Object.freeze({responseActions:{position:0,label:u.i18n.translate("xpack.securitySolution.endpointConsoleCommands.groups.responseActions",{defaultMessage:"Response actions"})}}),te=u.i18n.translate("xpack.securitySolution.endpointResponseActionsConsoleCommands.enterPidOrEntityId",{defaultMessage:"Enter a pid or an entity id to execute"}),ne=u.i18n.translate("xpack.securitySolution.endpointResponseActionsConsoleCommands.enterOrAddOptionalComment",{defaultMessage:"Hit enter to execute or add an optional comment"}),ae=u.i18n.translate("xpack.securitySolution.endpointConsoleCommands.suspendProcess.commandArgAbout",{defaultMessage:"A comment to go along with the action"}),se=({endpointAgentId:e,endpointCapabilities:t,endpointPrivileges:n})=>{const a=m.a.get().responseActionGetFileEnabled,s=e=>{const n=J.get(e);return!!n&&t.includes(n)},o=[{name:"isolate",about:Y({aboutInfo:u.i18n.translate("xpack.securitySolution.endpointConsoleCommands.isolate.about",{defaultMessage:"Isolate the host"}),isSupported:s("isolate")}),RenderComponent:F,meta:{endpointId:e,capabilities:t,privileges:n},exampleUsage:'isolate --comment "isolate this host"',exampleInstruction:ne,validate:Z,args:{comment:{required:!1,allowMultiples:!1,about:ae}},helpGroupLabel:ee.responseActions.label,helpGroupPosition:ee.responseActions.position,helpCommandPosition:0,helpDisabled:!1===s("isolate"),helpHidden:!X({commandName:"isolate",privileges:n})},{name:"release",about:Y({aboutInfo:u.i18n.translate("xpack.securitySolution.endpointConsoleCommands.release.about",{defaultMessage:"Release the host"}),isSupported:s("release")}),RenderComponent:w,meta:{endpointId:e,capabilities:t,privileges:n},exampleUsage:'release --comment "release this host"',exampleInstruction:ne,validate:Z,args:{comment:{required:!1,allowMultiples:!1,about:ae}},helpGroupLabel:ee.responseActions.label,helpGroupPosition:ee.responseActions.position,helpCommandPosition:1,helpDisabled:!1===s("release"),helpHidden:!X({commandName:"release",privileges:n})},{name:"kill-process",about:Y({aboutInfo:u.i18n.translate("xpack.securitySolution.endpointConsoleCommands.killProcess.about",{defaultMessage:"Kill/terminate a process"}),isSupported:s("kill-process")}),RenderComponent:A,meta:{endpointId:e,capabilities:t,privileges:n},exampleUsage:'kill-process --pid 123 --comment "kill this process"',exampleInstruction:te,validate:Z,mustHaveArgs:!0,args:{comment:{required:!1,allowMultiples:!1,about:ae},pid:{required:!1,allowMultiples:!1,exclusiveOr:!0,about:u.i18n.translate("xpack.securitySolution.endpointConsoleCommands.pid.arg.comment",{defaultMessage:"A PID representing the process to kill"}),validate:Q},entityId:{required:!1,allowMultiples:!1,exclusiveOr:!0,about:u.i18n.translate("xpack.securitySolution.endpointConsoleCommands.entityId.arg.comment",{defaultMessage:"An entity id representing the process to kill"}),validate:V}},helpGroupLabel:ee.responseActions.label,helpGroupPosition:ee.responseActions.position,helpCommandPosition:4,helpDisabled:!1===s("kill-process"),helpHidden:!X({commandName:"kill-process",privileges:n})},{name:"suspend-process",about:Y({aboutInfo:u.i18n.translate("xpack.securitySolution.endpointConsoleCommands.suspendProcess.about",{defaultMessage:"Temporarily suspend a process"}),isSupported:s("suspend-process")}),RenderComponent:T,meta:{endpointId:e,capabilities:t,privileges:n},exampleUsage:'suspend-process --pid 123 --comment "suspend this process"',exampleInstruction:te,validate:Z,mustHaveArgs:!0,args:{comment:{required:!1,allowMultiples:!1,about:ae},pid:{required:!1,allowMultiples:!1,exclusiveOr:!0,about:u.i18n.translate("xpack.securitySolution.endpointConsoleCommands.suspendProcess.pid.arg.comment",{defaultMessage:"A PID representing the process to suspend"}),validate:Q},entityId:{required:!1,allowMultiples:!1,exclusiveOr:!0,about:u.i18n.translate("xpack.securitySolution.endpointConsoleCommands.suspendProcess.entityId.arg.comment",{defaultMessage:"An entity id representing the process to suspend"}),validate:V}},helpGroupLabel:ee.responseActions.label,helpGroupPosition:ee.responseActions.position,helpCommandPosition:5,helpDisabled:!1===s("suspend-process"),helpHidden:!X({commandName:"suspend-process",privileges:n})},{name:"status",about:u.i18n.translate("xpack.securitySolution.endpointConsoleCommands.status.about",{defaultMessage:"Show host status information"}),RenderComponent:z,meta:{endpointId:e},helpGroupLabel:ee.responseActions.label,helpGroupPosition:ee.responseActions.position,helpCommandPosition:2},{name:"processes",about:Y({aboutInfo:u.i18n.translate("xpack.securitySolution.endpointConsoleCommands.processes.about",{defaultMessage:"Show all running processes"}),isSupported:s("processes")}),RenderComponent:q,meta:{endpointId:e,capabilities:t,privileges:n},exampleUsage:'processes --comment "get the processes"',exampleInstruction:ne,validate:Z,args:{comment:{required:!1,allowMultiples:!1,about:ae}},helpGroupLabel:ee.responseActions.label,helpGroupPosition:ee.responseActions.position,helpCommandPosition:3,helpDisabled:!1===s("processes"),helpHidden:!X({commandName:"processes",privileges:n})}];return a&&o.push({name:"get-file",about:Y({aboutInfo:u.i18n.translate("xpack.securitySolution.endpointConsoleCommands.getFile.about",{defaultMessage:"Retrieve a file from the host"}),isSupported:s("processes")}),RenderComponent:C,meta:{endpointId:e,capabilities:t,privileges:n},exampleUsage:'get-file --path "/full/path/to/file.txt" --comment "Possible malware"',exampleInstruction:ne,validate:Z,mustHaveArgs:!0,args:{path:{required:!0,allowMultiples:!1,about:u.i18n.translate("xpack.securitySolution.endpointConsoleCommands.getFile.pathArgAbout",{defaultMessage:"The full file path to be retrieved"}),validate:e=>V(e)},comment:{required:!1,allowMultiples:!1,about:ae}},helpGroupLabel:ee.responseActions.label,helpGroupPosition:ee.responseActions.position,helpCommandPosition:6,helpDisabled:!s("get-file"),helpHidden:!X({commandName:"get-file",privileges:n})}),o};var oe=n(1118),ie=n(562);const re=Object(l.memo)((e=>{const[t,n]=Object(l.useState)(!1),a=Object(l.useCallback)((()=>{n((e=>!e))}),[]);return c.a.createElement(c.a.Fragment,null,c.a.createElement(y.EuiButton,{onClick:a,disabled:t,iconType:"list","data-test-subj":"responderShowActionLogButton"},c.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.responseActionsHistoryButton.label",defaultMessage:"Response actions history"})),t&&c.a.createElement(y.EuiFlyout,{onClose:a,size:"m",paddingSize:"l","data-test-subj":"responderActionLogFlyout"},c.a.createElement(y.EuiFlyoutHeader,{hasBorder:!0},c.a.createElement(y.EuiTitle,{size:"m"},c.a.createElement("h1",null,ie.d.flyoutTitle(e.meta.endpoint.host.hostname)))),c.a.createElement(y.EuiFlyoutBody,null,c.a.createElement(oe.a,{agentIds:e.meta.endpoint.agent.id}))))}));re.displayName="ActionLogButton";var le=n(638),ce=n(246);const ue=B()(y.EuiFlexGroup).withConfig({displayName:"EuiFlexGroupStyled",componentId:"sc-1uxyi62-0"})([".isolation-status{margin-left:",";}"],(({theme:e})=>e.eui.euiSizeS)),de=Object(l.memo)((({status:e,isIsolated:t,pendingActions:n,"data-test-subj":a})=>{const s=Object(f.a)(a);return c.a.createElement(ue,{gutterSize:"none",responsive:!1,className:"eui-textTruncate","data-test-subj":a},c.a.createElement(y.EuiFlexItem,{grow:!1},c.a.createElement(le.a,{hostStatus:e})),void 0!==t&&c.a.createElement(y.EuiFlexItem,{grow:!1,className:"eui-textTruncate isolation-status"},c.a.createElement(ce.b,{"data-test-subj":s("isolationStatus"),isIsolated:t,pendingActions:n})))}));de.displayName="EndpointAgentAndIsolationStatus";const me=Object(l.memo)((({endpointId:e})=>{var t;const{data:n,isFetching:a}=r(e,{refetchInterval:1e4}),{data:s}=D([e],{refetchInterval:1e4}),o=Object(l.useMemo)((()=>{var e,t,n,a,o,i;const r=null==s||null===(e=s.data)||void 0===e?void 0:e[0].pending_actions;return{pendingActions:{pendingIsolate:null!==(t=null==r?void 0:r.isolate)&&void 0!==t?t:0,pendingUnIsolate:null!==(n=null==r?void 0:r.unisolate)&&void 0!==n?n:0,pendingKillProcess:null!==(a=null==r?void 0:r["kill-process"])&&void 0!==a?a:0,pendingSuspendProcess:null!==(o=null==r?void 0:r["suspend-process"])&&void 0!==o?o:0,pendingRunningProcesses:null!==(i=null==r?void 0:r["running-processes"])&&void 0!==i?i:0}}}),[null==s?void 0:s.data]);return a&&void 0===s?c.a.createElement(y.EuiLoadingContent,{lines:2}):n?c.a.createElement(y.EuiFlexGroup,{direction:"column",gutterSize:"none"},c.a.createElement(y.EuiFlexItem,{grow:!1},c.a.createElement(y.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},c.a.createElement(y.EuiFlexItem,{grow:!1,className:"eui-textTruncate"},c.a.createElement(y.EuiToolTip,{content:n.metadata.host.name,anchorClassName:"eui-textTruncate"},c.a.createElement(y.EuiText,{size:"s","data-test-subj":"responderHeaderEndpointName"},c.a.createElement("h6",{className:"eui-textTruncate"},n.metadata.host.name)))),c.a.createElement(y.EuiFlexItem,{grow:!1},c.a.createElement(de,h()({status:n.host_status,isIsolated:null===(t=n.metadata.Endpoint.state)||void 0===t?void 0:t.isolation},o,{"data-test-subj":"responderHeaderEndpointAgentIsolationStatus"}))))),c.a.createElement(y.EuiFlexItem,{grow:!1},c.a.createElement(y.EuiSpacer,{size:"xs"}),c.a.createElement(y.EuiText,{color:"subdued",size:"s","data-test-subj":"responderHeaderLastSeen"},c.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.responder.header.lastSeen",defaultMessage:"Last seen {date}",values:{date:c.a.createElement(p.FormattedRelative,{value:n.metadata["@timestamp"]})}})))):null}));me.displayName="HeaderEndpointInfo";var pe=n(142);const ge=Object(l.memo)((({endpointId:e})=>{const{data:t}=r(e,{refetchInterval:1e4});return t&&t.host_status===pe.b.OFFLINE?c.a.createElement(c.a.Fragment,null,c.a.createElement(y.EuiCallOut,{iconType:"offline",color:"warning","data-test-subj":"offlineCallout",title:u.i18n.translate("xpack.securitySolution.responder.hostOffline.callout.title",{defaultMessage:"Host Offline"})},c.a.createElement("p",null,c.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.responder.hostOffline.callout.body",defaultMessage:"The host {name} is offline, so its responses may be delayed. Pending commands will execute when the host reconnects.",values:{name:c.a.createElement("strong",null,t.metadata.host.name)}}))),c.a.createElement(y.EuiSpacer,{size:"m"})):null}));ge.displayName="OfflineCallout",n(1115);var fe=n(1084);const be=u.i18n.translate("xpack.securitySolution.responder_overlay.pageTitle",{defaultMessage:"Response console"}),he=()=>{const e=Object(fe.b)(),t=Object(d.a)().endpointPrivileges;return Object(l.useCallback)((n=>{if(!t.canAccessResponseConsole)return void window.console.error(new Error("Access denied to endpoint response actions console"));const a=n.agent.id,s=e.getOne(a);var o;s?s.show():e.register({id:a,meta:{endpoint:n},consoleProps:{commands:se({endpointAgentId:a,endpointCapabilities:null!==(o=n.Endpoint.capabilities)&&void 0!==o?o:[],endpointPrivileges:t}),"data-test-subj":"endpointResponseActionsConsole",TitleComponent:()=>c.a.createElement(me,{endpointId:a})},PageTitleComponent:()=>c.a.createElement(c.a.Fragment,null,be),PageBodyComponent:()=>c.a.createElement(ge,{endpointId:a}),ActionComponents:t.canReadActionsLogManagement?[re]:void 0}).show()}),[t,e])},Ee=(e,t={})=>{const n=Object(o.j)();let s=e.userIds;return"string"==typeof e.userIds?s=`*${e.userIds}*`:Array.isArray(e.userIds)&&(s=e.userIds.map((e=>`*${e}*`))),Object(a.useQuery)({queryKey:["get-action-list",e],...t,queryFn:async()=>n.get(i.f,{query:{agentIds:e.agentIds,commands:e.commands,endDate:e.endDate,page:e.page,pageSize:e.pageSize,startDate:e.startDate,statuses:e.statuses,userIds:s}})})}},744:function(e,t,n){"use strict";n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return g})),n.d(t,"e",(function(){return f})),n.d(t,"f",(function(){return b}));var a=n(4),s=n.n(a),o=n(32),i=n(33),r=n.n(i),l=n(35),c=n(87);const u=({children:e,...t})=>s.a.createElement(o.EuiButton,t,e),d=({children:e,...t})=>s.a.createElement(o.EuiLink,t,e),m=r()("span").withConfig({displayName:"Comma",componentId:"sc-y9dkfp-0"})(["margin-right:5px;margin-left:5px;&::after{content:' ,';}"]);m.displayName="Comma";const p=({children:e,Component:t,dataTestSubj:n,href:a,onClick:o,title:i,iconType:r="expand"})=>t?s.a.createElement(t,{"data-test-subj":n,href:a,iconType:r,onClick:o,title:i},null!=i?i:e):s.a.createElement(u,{"data-test-subj":n,href:a,onClick:o},null!=i?i:e),g=s.a.memo(p),f=r.a.div.withConfig({displayName:"PortContainer",componentId:"sc-y9dkfp-1"})(["& svg{position:relative;top:-1px;}"]),b=s.a.memo((({moreMaxHeight:e,overflowIndexStart:t=5,render:n,rowItems:i})=>{const[r,c]=Object(a.useState)(!1),u=Object(a.useCallback)((()=>c((e=>!e))),[]),d=Object(a.useMemo)((()=>s.a.createElement(s.a.Fragment,null," ,",s.a.createElement(o.EuiButtonEmpty,{size:"xs",onClick:u},`+${i.length-t} `,s.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.reputationLinks.moreLabel",defaultMessage:"More"})))),[u,t,i.length]);return s.a.createElement(o.EuiFlexItem,{grow:!1},i.length>t&&s.a.createElement(o.EuiPopover,{id:"popover",button:d,isOpen:r,closePopover:u,repositionOnScroll:!0,panelClassName:"withHoverActions__popover"},s.a.createElement(h,{render:n,rowItems:i,moreMaxHeight:e,overflowIndexStart:t})))}));b.displayName="ReputationLinksOverflow";const h=s.a.memo((({moreMaxHeight:e,overflowIndexStart:t,render:n,rowItems:i})=>{const r=Object(a.useMemo)((()=>i.slice(t).map(((e,t)=>{var a;return s.a.createElement(o.EuiFlexItem,{grow:1,key:`${e}-${t}`},null!==(a=n&&n(e))&&void 0!==a?a:Object(c.a)(e))}))),[t,n,i]);return s.a.createElement("div",{"data-test-subj":"more-container",className:"eui-yScroll",style:{maxHeight:e,paddingRight:"2px"}},s.a.createElement(o.EuiFlexGroup,{gutterSize:"s",direction:"column","data-test-subj":"overflow-items"},r))}));h.displayName="MoreReputationLinksContainer"},854:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r}));var a=n(192),s=n(383),o=n(209);const i=e=>`${Object(o.a)(e)}`,r=(e,t,n,i=s.a.flows)=>`/ip/${e}/${t||a.a.source}/${i}${Object(o.a)(n)}`},87:function(e,t,n){"use strict";n.d(t,"e",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"d",(function(){return m})),n.d(t,"c",(function(){return p})),n.d(t,"a",(function(){return g})),n.d(t,"f",(function(){return f}));var a=n(34),s=n(4),o=n.n(s),i=n(33),r=n.n(i);const l=n(0).i18n.translate("xpack.securitySolution.emptyString.emptyStringDescription",{defaultMessage:"Empty string"}),c=r.a.span.withConfig({displayName:"EmptyWrapper",componentId:"sc-1v50emf-0"})(["color:",";"],(e=>e.theme.eui.euiColorMediumShade));c.displayName="EmptyWrapper";const u=()=>"",d=()=>`(${l})`,m=()=>o.a.createElement(c,null,u()),p=()=>o.a.createElement(c,null,d()),g=e=>null==e?m():Object(a.isString)(e)&&""===e?p():o.a.createElement(o.a.Fragment,null,e),f=e=>null==e?m():""===e?p():o.a.createElement(o.a.Fragment,null,e)},89:function(e,t,n){"use strict";n.d(t,"g",(function(){return O.d})),n.d(t,"f",(function(){return O.c})),n.d(t,"m",(function(){return x})),n.d(t,"d",(function(){return I})),n.d(t,"h",(function(){return A})),n.d(t,"a",(function(){return N})),n.d(t,"c",(function(){return R})),n.d(t,"i",(function(){return D})),n.d(t,"e",(function(){return L})),n.d(t,"b",(function(){return P})),n.d(t,"j",(function(){return B})),n.d(t,"n",(function(){return H})),n.d(t,"o",(function(){return q})),n.d(t,"p",(function(){return G})),n.d(t,"l",(function(){return W})),n.d(t,"k",(function(){return K}));var a=n(82),s=n.n(a),o=n(32),i=n(4),r=n.n(i),l=n(34),c=n(316),u=n(205),d=n(403),m=n(1),p=n(351),g=n(128),f=n(192),b=n(77),h=n(191),E=n(0),v=n(430);const y=e=>E.i18n.translate("xpack.securitySolution.cases.caseTable.caseDetailsLinkAria",{values:{detailName:e},defaultMessage:"click to visit case with title {detailName}"});var j=n(2),S=n(600),O=n(744);const k=({children:e,Component:t,userName:n,isButton:a,onClick:s,title:o,userTab:l})=>{const c=encodeURIComponent(n),{formatUrl:u,search:d}=Object(g.n)(j.a.users),{navigateToApp:p}=Object(b.k)().services.application,f=Object(i.useCallback)((e=>{e.preventDefault(),p(m.B,{deepLinkId:j.a.users,path:l?Object(S.a)(c,l,d):Object(S.c)(c,d)})}),[c,p,d,l]),h=Object(i.useMemo)((()=>u(l?Object(S.a)(c,l):Object(S.c)(c))),[u,c,l]);return a?r.a.createElement(O.b,{Component:t,dataTestSubj:"data-grid-user-details",href:h,onClick:null!=s?s:f,title:null!=o?o:n},e||n):r.a.createElement(O.c,{"data-test-subj":"users-link-anchor",onClick:null!=s?s:f,href:h},e||n)},x=r.a.memo(k),C=({children:e,Component:t,hostName:n,isButton:a,onClick:s,title:o,hostTab:l})=>{const{formatUrl:c,search:u}=Object(g.n)(j.a.hosts),{navigateToApp:d}=Object(b.k)().services.application,p=encodeURIComponent(n),f=Object(i.useCallback)((e=>{e.preventDefault(),d(m.B,{deepLinkId:j.a.hosts,path:l?Object(g.k)(p,l,u):Object(g.f)(p,u)})}),[p,d,u,l]),h=Object(i.useMemo)((()=>c(l?Object(g.k)(p,l):Object(g.f)(p))),[c,p,l]);return a?r.a.createElement(O.b,{Component:t,dataTestSubj:"data-grid-host-details",href:h,iconType:"expand",onClick:null!=s?s:f,title:null!=o?o:n},e):r.a.createElement(O.c,{onClick:null!=s?s:f,href:h,"data-test-subj":"host-details-button"},e||n)},I=r.a.memo(C),F=["http://","https://"],w=r.a.memo((({url:e,children:t,idx:n,overflowIndexStart:a=5,allItemsLimit:s=5})=>{const i=a-1,c=s-1,u=Math.max(0,Math.min(i,c)),d=F.some((t=>0===e.indexOf(t)));return e&&d&&!Object(h.c)(e)&&t?r.a.createElement(o.EuiToolTip,{content:e,position:"top","data-test-subj":"externalLinkTooltip"},r.a.createElement(r.a.Fragment,null,r.a.createElement(o.EuiLink,{href:e,target:"_blank",rel:"noopener","data-test-subj":"externalLink"},t),!Object(l.isNil)(n)&&n<u&&r.a.createElement(O.a,{"data-test-subj":"externalLinkComma"}))):null}));w.displayName="ExternalLink";const M=({Component:e,children:t,ip:n,flowTarget:a=f.a.source,isButton:s,onClick:o,title:c})=>{const u=q(),d=Object(i.useCallback)(((n,i)=>{const{onClick:l,href:d}=u({deepLinkId:j.a.network,path:Object(g.h)(encodeURIComponent(Object(p.d)(n)),a)}),m=null!=o?o:e=>l(e);return s?r.a.createElement(O.b,{Component:e,key:`${n}-${i}`,dataTestSubj:"data-grid-network-details",onClick:m,href:d,title:null!=c?c:n},t):r.a.createElement(O.c,{key:`${n}-${i}`,onClick:m,href:d,"data-test-subj":"network-details"},t||n)}),[t,e,a,u,o,s,c]);return Object(l.isArray)(n)?r.a.createElement(r.a.Fragment,null,n.map(d)):d(n,0)},A=r.a.memo(M),T=({index:e,children:t,detailName:n,title:a})=>{const{formatUrl:s,search:o}=Object(g.n)(j.a.case),{navigateToApp:l}=Object(b.k)().services.application,{activeStep:p,isTourShown:f}=Object(d.b)(),h=Object(i.useMemo)((()=>p===u.a.viewCase&&f(u.b.alertsCases)&&0===e),[p,e,f]),E=Object(i.useCallback)((async e=>(e&&e.preventDefault(),l(m.B,{deepLinkId:j.a.case,path:Object(g.c)({id:n,search:o})}))),[n,l,o]);return Object(i.useEffect)((()=>{var e;h&&(null===(e=document.querySelector('[tour-step="RelatedCases-accordion"]'))||void 0===e||e.scrollIntoView())}),[h]),r.a.createElement(c.a,{onClick:E,isTourAnchor:h,step:u.a.viewCase,tourId:u.b.alertsCases},r.a.createElement(O.c,{onClick:E,href:s(Object(g.c)({id:n})),"data-test-subj":"case-details-link","aria-label":y(null!=a?a:n)},t||n))},N=r.a.memo(T);N.displayName="CaseDetailsLink",r.a.memo((({children:e})=>{const{formatUrl:t,search:n}=Object(g.n)(j.a.case),{navigateToApp:a}=Object(b.k)().services.application,s=Object(i.useCallback)((async e=>(e.preventDefault(),a(m.B,{deepLinkId:j.a.case,path:Object(g.d)(n)}))),[a,n]);return r.a.createElement(O.c,{onClick:s,href:t(Object(g.d)())},e)})).displayName="CreateCaseLink";const R=r.a.memo((({children:e,link:t})=>{const n=Object(i.useMemo)((()=>`https://www.google.com/search?q=${encodeURIComponent(t)}`),[t]);return r.a.createElement(w,{url:n},e||t)}));R.displayName="GoogleLink";const D=r.a.memo((({Component:e,title:t,children:n,portOrServiceName:a})=>{var s;const l=Object(i.useMemo)((()=>`https://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xhtml?search=${encodeURIComponent(String(a))}`),[a]);return e?r.a.createElement(e,{href:l,"data-test-subj":"data-grid-port-or-service-name-link",title:t,iconType:"link"},null!==(s=null!=t?t:n)&&void 0!==s?s:a):r.a.createElement(O.e,null,r.a.createElement(o.EuiLink,{"data-test-subj":"port-or-service-name-link",href:l,target:"_blank"},n||a))}));D.displayName="PortOrServiceNameLink";const L=r.a.memo((({children:e,ja3Fingerprint:t})=>{const n=Object(i.useMemo)((()=>`https://sslbl.abuse.ch/ja3-fingerprints/${encodeURIComponent(t)}`),[t]);return r.a.createElement(o.EuiLink,{"data-test-subj":"ja3-fingerprint-link",href:n,target:"_blank"},e||t)}));L.displayName="Ja3FingerprintLink";const P=r.a.memo((({children:e,certificateFingerprint:t})=>{const n=Object(i.useMemo)((()=>`https://sslbl.abuse.ch/ssl-certificates/sha1/${encodeURIComponent(t)}`),[t]);return r.a.createElement(o.EuiLink,{"data-test-subj":"certificate-fingerprint-link",href:n,target:"_blank"},e||t)}));var $;function _(e){return e===$["virustotal.com"]||e===$["talosIntelligence.com"]}P.displayName="CertificateFingerprintLink",function(e){e["virustotal.com"]="virustotal.com",e["talosIntelligence.com"]="talosIntelligence.com"}($||($={}));const z={[$["virustotal.com"]]:v.m,[$["talosIntelligence.com"]]:v.l},U=({overflowIndexStart:e=5,allItemsLimit:t=5,showDomain:n=!1,domain:a,direction:s="row"})=>{const[c]=Object(b.q)(m.Lb),u=Object(i.useMemo)((()=>null==c?void 0:c.slice(0,t).filter((({url_template:e,name:t})=>!Object(l.isNil)(e)&&!Object(l.isNil)(t)&&!Object(h.c)(e))).map((({name:e,url_template:t})=>({name:_(e)?z[e]:e,url_template:t.replace("{{ip}}",encodeURIComponent(a))})))),[c,a,z,t]),d=Object(i.useCallback)((n=>{var s;return(e=>void 0!==e.url_template&&void 0!==e.name)(n)&&r.a.createElement(w,{url:n.url_template,overflowIndexStart:e,allItemsLimit:t},r.a.createElement(r.a.Fragment,null,null!==(s=n.name)&&void 0!==s?s:a))}),[t,a,e]);return(null==u?void 0:u.length)>0?r.a.createElement("section",null,r.a.createElement(o.EuiFlexGroup,{gutterSize:"none",justifyContent:"center",direction:s,alignItems:"center","data-test-subj":"reputationLinkGroup"},r.a.createElement(o.EuiFlexItem,{grow:!0},null==u?void 0:u.slice(0,e).map((({name:t,url_template:s},o)=>r.a.createElement(w,{allItemsLimit:u.length,idx:o,overflowIndexStart:e,url:s,"data-test-subj":"externalLinkComponent",key:`reputationLink-${o}`},r.a.createElement(r.a.Fragment,null,n?a:null!=t?t:a))))),r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(O.f,{rowItems:u,render:d,moreMaxHeight:"200px",overflowIndexStart:e})))):null};U.displayName="ReputationLinkComponent";const B=r.a.memo(U),H=r.a.memo((({children:e,domain:t})=>{const n=Object(i.useMemo)((()=>`https://www.iana.org/whois?q=${encodeURIComponent(t)}`),[t]);return r.a.createElement(w,{url:n},e||t)}));H.displayName="WhoIsLink";const q=()=>{const e=Object(g.o)(),{navigateTo:t}=Object(b.l)();return Object(i.useCallback)((({deepLinkId:n,path:a,onClick:s})=>{const o=e({deepLinkId:n,path:a});return{href:o,onClick:e=>{var n;(n=e).metaKey||n.altKey||n.ctrlKey||n.shiftKey||(e.preventDefault(),t({url:o}),s&&s(e))}}}),[e,t])},G=e=>({deepLinkId:t,path:n,onClick:a,...o})=>{const i=q(),{onClick:l,href:c}=i({deepLinkId:t,path:n,onClick:a});return r.a.createElement(e,s()({onClick:l,href:c},o))},W=G(O.d),K=G(O.c)},918:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(77),s=n(226);const o=e=>a.b.get().http.get(s.d,{query:{agent_ids:e}})}}]);