/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[26],{1114:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var a=i(4),n=i.n(a),l=i(78),r=i(184);const o=({id:e,inputId:t,inspect:i,loading:n,refetch:o,skip:s})=>{const d=Object(l.useDispatch)();return Object(a.useEffect)((()=>{s||d(r.b.setQuery({id:e,inputId:t,inspect:i,loading:n,refetch:o}))}),[d,e,t,n,o,i,s]),null},s=n.a.memo(o)},1127:function(e,t,i){"use strict";i.d(t,"a",(function(){return b}));var a=i(32),n=i(4),l=i.n(n),r=i(78),o=i(90),s=i(145),d=i(81),c=i(0);const u=c.i18n.translate("xpack.securitySolution.timeline.properties.lockDatePickerTooltip",{defaultMessage:"Disable syncing of date/time range between the currently viewed page and your timeline"}),m=c.i18n.translate("xpack.securitySolution.timeline.properties.unlockDatePickerTooltip",{defaultMessage:"Enable syncing of date/time range between the currently viewed page and your timeline"}),p=c.i18n.translate("xpack.securitySolution.timeline.properties.lockDatePickerDescription",{defaultMessage:"Lock global date picker to timeline date picker"}),g=c.i18n.translate("xpack.securitySolution.timeline.properties.unlockDatePickerDescription",{defaultMessage:"Unlock global date picker from timeline date picker"}),y=()=>{const e=Object(r.useDispatch)(),t=Object(n.useMemo)((()=>s.d.globalSelector()),[]),i=Object(d.b)((e=>t(e).linkTo.includes(o.a.timeline))),c=Object(n.useCallback)((()=>e(s.b.toggleTimelineLinkTo())),[e]);return l.a.createElement(a.EuiToolTip,{"data-test-subj":"timeline-date-picker-lock-tooltip",position:"top",content:i?u:m},l.a.createElement(a.EuiButtonIcon,{"data-test-subj":`timeline-date-picker-${i?"lock":"unlock"}-button`,color:"primary",onClick:c,iconType:i?"lock":"lockOpen","aria-label":i?g:p}))};y.displayName="TimelineDatePickerLockComponent";const b=l.a.memo(y)},1293:function(e,t,i){"use strict";i.r(t),i.d(t,"EqlTabContentComponent",(function(){return de})),i.d(t,"default",(function(){return ce}));var a=i(32),n=i(34),l=i(4),r=i.n(l),o=i(33),s=i.n(o),d=i(78),c=i(92),u=i.n(c),m=i(287),p=i(90),g=i(86),y=i(520),b=i(158),f=i(1120),E=i(1126),h=i(123),v=i(1114),O=i(79),q=i(274),j=i(616),w=i(286),k=i(1067),P=i(98),C=i(95),F=i(112),S=i(94),x=i(529),I=i(1127),D=i(148),T=i(228),B=i(504),N=i(7),Q=i(81),L=i(906),V=i(584),M=i(100);const $=i(0).i18n.translate("xpack.securitySolution.timeline.EqlQueryBarLabel",{defaultMessage:"EQL query"});var _=i(108),z=i(527);const H={index:[],eqlQueryBar:{query:{query:"",language:"eql"},filters:[],saved_id:null}},R={index:{fieldsToValidateOnChange:["index","eqlQueryBar"],validations:[]},eqlQueryBar:{validations:[{validator:Object(V.a)(V.b,300)}]}},K=s()(M.e).withConfig({displayName:"HiddenUseField",componentId:"sc-fj97qw-0"})(["display:none;"]),A=Object(l.memo)((({timelineId:e})=>{var t;const i=Object(d.useDispatch)(),a=Object(l.useRef)(!0),[n,o]=Object(l.useState)(!1),[s,c]=Object(l.useState)(!1),u=Object(l.useMemo)((()=>Object(_.createSelector)(z.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.eqlOptions)&&void 0!==t?t:{eventCategoryField:[{label:"event.category"}],tiebreakerField:[{label:""}],timestampField:[{label:"@timestamp"}],size:100,query:""}}))),[]),m=Object(Q.a)((t=>u(t,e))),{loading:p,indexPattern:y,selectedPatterns:b}=Object(S.d)(C.SourcererScopeName.timeline),f={...H,index:b.sort(),eqlQueryBar:{...H.eqlQueryBar,query:{query:null!==(t=m.query)&&void 0!==t?t:"",language:"eql"}}},{form:E}=Object(M.k)({defaultValue:f,options:{stripEmptyFields:!1},schema:R}),{getFields:h}=E,v=Object(l.useCallback)(((t,a)=>i(g.a.updateEqlOptions({id:e,field:t,value:a}))),[i,e]),[{eqlQueryBar:O}]=Object(M.m)({form:E,watch:["eqlQueryBar"]}),q=Object(l.useMemo)((()=>Object(N.isEmpty)(y.fields)?{keywordFields:[],dateFields:[],nonDateFields:[]}:{keywordFields:y.fields.filter((e=>{var t;return null===(t=e.esTypes)||void 0===t?void 0:t.includes("keyword")})).map((e=>({label:e.name}))),dateFields:y.fields.filter((e=>"date"===e.type)).map((e=>({label:e.name}))),nonDateFields:y.fields.filter((e=>"date"!==e.type)).map((e=>({label:e.name})))}),[y]);return Object(l.useEffect)((()=>{const{index:e}=h(),t=b.sort(),i=e.value.sort();Object(N.isEqual)(i,t)||e.setValue(t)}),[h,b]),Object(l.useEffect)((()=>{const{eqlQueryBar:e}=h();var t;return a.current&&(a.current=!1,c(!0),e.setValue({...H.eqlQueryBar,query:{query:null!==(t=m.query)&&void 0!==t?t:"",language:"eql"}})),()=>{a.current=!0}}),[h,m.query]),Object(l.useEffect)((()=>{null==O||Object(N.isEmpty)(O.query.query)||!n||s||(i(g.a.updateEqlOptions({id:e,field:"query",value:`${O.query.query}`})),o(!1),c(!1))}),[i,O,n,s,e]),r.a.createElement(M.c,{form:E,"data-test-subj":"EqlQueryBarTimeline"},r.a.createElement(K,{key:"Index",path:"index"}),r.a.createElement(M.e,{key:"EqlQueryBar",path:"eqlQueryBar",component:L.a,componentProps:{optionsData:q,optionsSelected:m,onOptionsChange:v,onValidityChange:o,onValiditingChange:c,idAria:"timelineEqlQueryBar",isDisabled:p,isLoading:p,indexPattern:y,dataTestSubj:"timelineEqlQueryBar"},config:{...R.eqlQueryBar,label:$}}))}));var G=i(1116),U=i(419),W=i(1119),J=i(13);const X=s.a.div.withConfig({displayName:"TimelineHeaderContainer",componentId:"sc-1f3fsnr-0"})(["margin-top:6px;width:100%;"]);X.displayName="TimelineHeaderContainer";const Y=s()(a.EuiFlyoutHeader).withConfig({displayName:"StyledEuiFlyoutHeader",componentId:"sc-1f3fsnr-1"})(["align-items:stretch;box-shadow:none;display:flex;flex-direction:column;padding:0;&.euiFlyoutHeader{","}"],(({theme:e})=>`padding: 0 ${e.eui.euiSizeS} ${e.eui.euiSizeS} ${e.eui.euiSizeS};`)),Z=s()(a.EuiFlyoutBody).withConfig({displayName:"StyledEuiFlyoutBody",componentId:"sc-1f3fsnr-2"})(["overflow-y:hidden;flex:1;.euiFlyoutBody__overflow{overflow:hidden;mask-image:none;}.euiFlyoutBody__overflowContent{padding:0;height:100%;display:flex;}"]),ee=s()(a.EuiFlyoutFooter).withConfig({displayName:"StyledEuiFlyoutFooter",componentId:"sc-1f3fsnr-3"})(["background:none;padding:0;&.euiFlyoutFooter{","}"],(({theme:e})=>`padding: ${e.eui.euiSizeS} 0 0 0;`)),te=s()(a.EuiFlexGroup).withConfig({displayName:"FullWidthFlexGroup",componentId:"sc-1f3fsnr-4"})(["margin:0;width:100%;overflow:hidden;"]),ie=s()(a.EuiFlexItem).withConfig({displayName:"ScrollableFlexItem",componentId:"sc-1f3fsnr-5"})(["overflow:hidden;"]),ae=s()(a.EuiFlexItem).withConfig({displayName:"DatePicker",componentId:"sc-1f3fsnr-6"})([".euiSuperDatePicker__flexWrapper{max-width:none;width:auto;}"]);ae.displayName="DatePicker";const ne=s.a.div.withConfig({displayName:"VerticalRule",componentId:"sc-1f3fsnr-7"})(["width:2px;height:100%;background:",";"],(({theme:e})=>e.eui.euiColorLightShade));ne.displayName="VerticalRule";const le=s()(a.EuiBadge).withConfig({displayName:"EventsCountBadge",componentId:"sc-1f3fsnr-8"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeS)),re=[],oe=[],se=[],de=({activeTab:e,columns:t,end:i,eqlOptions:o,expandedDetail:s,timelineId:c,isLive:u,itemsPerPage:P,itemsPerPageOptions:F,onEventClosed:N,renderCellValue:Q,rowRenderers:L,showExpandedDetails:V,start:M,timerangeKind:$})=>{var _;const z=Object(d.useDispatch)(),{query:H="",...R}=o,{portalNode:K}=Object(x.c)(),{setTimelineFullScreen:de,timelineFullScreen:ce}=Object(D.c)(),{browserFields:ue,dataViewId:me,loading:pe,runtimeMappings:ge,selectedPatterns:ye}=Object(S.d)(C.SourcererScopeName.timeline),be=Object(J.b)().isEnterprise()?6:5,fe=Object(n.isEmpty)(H),[Ee,{events:he,inspect:ve,totalCount:Oe,pageInfo:qe,loadPage:je,updatedAt:we,refetch:ke}]=Object(y.a)({dataViewId:me,endDate:i,eqlOptions:R,fields:[...(Object(n.isEmpty)(t)?b.b:t).map((e=>e.id)),...q.h],filterQuery:null!=H?H:"",id:c,indexNames:ye,language:"eql",limit:P,runtimeMappings:ge,skip:!!(null==pe||pe||Object(n.isEmpty)(M)||Object(n.isEmpty)(i)||fe),startDate:M,timerangeKind:$}),Pe=Object(l.useCallback)((()=>{var e;N({tabType:O.m.eql,id:c}),null!==(e=s[O.m.eql])&&void 0!==e&&e.panelView&&c===O.j.active&&V&&T.a.toggleExpandedDetail({})}),[N,c,s,V]);Object(l.useEffect)((()=>{z(g.a.updateIsLoading({id:c,isLoading:Ee||pe}))}),[pe,c,Ee,z]);const Ce=Object(l.useMemo)((()=>Object(U.a)(be).map((e=>({...e,headerCellRender:G.a})))),[be]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(m.a,{node:K},Oe>=0?r.a.createElement(le,null,Oe):null),r.a.createElement(v.a,{id:`${c}-${O.m.eql}`,inputId:p.a.timeline,inspect:ve,loading:Ee,refetch:ke}),r.a.createElement(te,null,r.a.createElement(ie,{grow:2},r.a.createElement(Y,{"data-test-subj":`${e}-tab-flyout-header`,hasBorder:!1},r.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"s","data-test-subj":"timeline-date-picker-container"},ce&&null!=de&&r.a.createElement(j.b,{fullScreen:ce,setFullScreen:de}),r.a.createElement(ae,{grow:10},r.a.createElement(w.a,{id:p.a.timeline,timelineId:c})),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(I.a,null)),r.a.createElement(a.EuiFlexItem,{grow:1},e===O.m.eql&&r.a.createElement(W.a,{scope:C.SourcererScopeName.timeline}))),r.a.createElement(X,{"data-test-subj":"timelineHeader"},r.a.createElement(A,{timelineId:c}))),r.a.createElement(k.a,null,r.a.createElement(Z,{"data-test-subj":`${O.m.eql}-tab-flyout-body`,className:"timeline-flyout-body"},r.a.createElement(f.a,{activePage:qe.activePage,browserFields:ue,data:fe?re:he,id:c,refetch:ke,renderCellValue:Q,rowRenderers:L,sort:oe,tabType:O.m.eql,totalPages:Object(h.h)({itemsCount:Oe,itemsPerPage:P}),leadingControlColumns:Ce,trailingControlColumns:se})),r.a.createElement(ee,{"data-test-subj":`${O.m.eql}-tab-flyout-footer`,className:"timeline-flyout-footer"},!fe&&r.a.createElement(E.a,{activePage:null!==(_=null==qe?void 0:qe.activePage)&&void 0!==_?_:0,"data-test-subj":"timeline-footer",updatedAt:we,height:E.b,id:c,isLive:u,isLoading:Ee||pe,itemsCount:fe?0:he.length,itemsPerPage:P,itemsPerPageOptions:F,onChangePage:je,totalCount:fe?0:Oe})))),V&&r.a.createElement(r.a.Fragment,null,r.a.createElement(ne,null),r.a.createElement(ie,{grow:1},r.a.createElement(B.a,{browserFields:ue,runtimeMappings:ge,tabType:O.m.eql,scopeId:c,handleOnPanelClosed:Pe})))))},ce=Object(d.connect)((()=>{const e=g.b.getTimelineByIdSelector(),t=P.d.getTimelineSelector();return(i,{timelineId:a})=>{var n,l;const r=null!==(n=e(i,a))&&void 0!==n?n:F.b,o=t(i),{activeTab:s,columns:d,eqlOptions:c,expandedDetail:u,itemsPerPage:m,itemsPerPageOptions:p}=r;return{activeTab:s,columns:d,eqlOptions:c,end:o.timerange.to,expandedDetail:u,timelineId:a,isLive:"interval"===o.policy.kind,itemsPerPage:m,itemsPerPageOptions:p,showExpandedDetails:!!u[O.m.eql]&&!(null===(l=u[O.m.eql])||void 0===l||!l.panelView),start:o.timerange.from,timerangeKind:o.timerange.kind}}}),(e=>({onEventClosed:t=>{e(g.a.toggleDetailPanel(t))}})))(r.a.memo(de,((e,t)=>e.activeTab===t.activeTab&&((e,t)=>e.end===t.end&&e.start===t.start&&e.timerangeKind===t.timerangeKind)(e,t)&&u()(e.eqlOptions,t.eqlOptions)&&e.isLive===t.isLive&&e.itemsPerPage===t.itemsPerPage&&e.onEventClosed===t.onEventClosed&&e.showExpandedDetails===t.showExpandedDetails&&e.timelineId===t.timelineId&&u()(e.columns,t.columns)&&u()(e.itemsPerPageOptions,t.itemsPerPageOptions))))}}]);