/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[19],Array(88).concat([function(e,t,a){"use strict";a.d(t,"a",(function(){return g})),a.d(t,"b",(function(){return b})),a.d(t,"c",(function(){return h}));var n=a(32),i=a(4),r=a.n(i),s=a(33),o=a.n(s),l=a(133),c=a(102),u=a(87),d=a(106),p=a(150);const m=({field:e,tooltipContent:t})=>null!=t?t:e,g=r.a.memo((({children:e,field:t,tooltipContent:a,tooltipPosition:i,value:s})=>(e=>null===e)(a)?r.a.createElement(r.a.Fragment,null,e||s):r.a.createElement(n.EuiToolTip,{"data-test-subj":`${t}-tooltip`,position:i,content:m({tooltipContent:a,field:t})},r.a.createElement(r.a.Fragment,null,e||s))));g.displayName="Content";const b=r.a.memo((({hideTopN:e=!1,id:t,isDraggable:a=!0,field:n,fieldType:s="",isAggregatable:o=!1,value:u,name:m,children:b,scopeId:f,tooltipContent:y,tooltipPosition:h,queryValue:E})=>{const v=Object(i.useMemo)((()=>{var e;return{and:[],enabled:!0,id:Object(c.h)(t),name:m||(null!==(e=null==u?void 0:u.toString())&&void 0!==e?e:""),excluded:!1,kqlQuery:"",queryMatch:{field:n,value:E||(null!=u?u:""),operator:d.d}}}),[n,t,m,E,u]),x=Object(i.useCallback)(((e,t,a)=>a.isDragging?r.a.createElement(l.a,null,r.a.createElement(p.a,{dataProvider:e})):r.a.createElement(g,{field:n,tooltipContent:y,tooltipPosition:h,value:u},b)),[b,n,y,h,u]);return null==u?null:r.a.createElement(l.b,{dataProvider:v,fieldType:s,isAggregatable:o,hideTopN:e,isDraggable:a,render:x,scopeId:f})}));b.displayName="DefaultDraggable";const f=o()(n.EuiBadge).withConfig({displayName:"Badge",componentId:"sc-ymm8sh-0"})(["vertical-align:top;"]);f.displayName="Badge";const y=({contextId:e,eventId:t,field:a,value:n,iconType:i,isDraggable:s,isAggregatable:o,fieldType:l,name:c,color:d="hollow",children:p,scopeId:m,tooltipContent:g,queryValue:y})=>null!=n?r.a.createElement(b,{id:`draggable-badge-default-draggable-${e}-${t}-${a}-${n}`,isDraggable:s,isAggregatable:o,fieldType:l,field:a,name:c,value:n,scopeId:m,tooltipContent:g,queryValue:y},r.a.createElement(f,{iconType:i,color:d,title:""},p||(""!==n?n:Object(u.c)()))):null;y.displayName="DraggableBadgeComponent";const h=r.a.memo(y);h.displayName="DraggableBadge"},,,,,,function(e,t,a){"use strict";a.d(t,"c",(function(){return k})),a.d(t,"d",(function(){return S})),a.d(t,"a",(function(){return O})),a.d(t,"b",(function(){return T}));var n=a(4),i=a(78),r=a(0),s=a(37),o=a(177),l=a(95),c=a(165),u=a(86),d=a(1),p=a(104),m=a(81),g=a(741),b=a(84),f=a(317),y=a(285),h=a(175),E=a(169),v=a(281),x=a(742);const k=(e=l.SourcererScopeName.default)=>{const t=Object(i.useDispatch)(),a=Object(n.useRef)(new AbortController),s=Object(n.useRef)(!0),d=Object(n.useRef)(!0),{loading:h,isSignalIndexExists:x,signalIndexName:k}=Object(c.c)(),S=Object(E.d)(v.a.sourcerer),j=Object(n.useMemo)((()=>o.d.getSourcererDataViewsSelector()),[]),{defaultDataView:O,signalIndexName:w}=Object(m.a)((e=>j(e))),{addError:T,addWarning:I}=Object(b.a)();Object(n.useEffect)((()=>{null!=O.error&&I({title:r.i18n.translate("xpack.securitySolution.sourcerer.permissions.title",{defaultMessage:"Write role required to generate data"}),text:r.i18n.translate("xpack.securitySolution.sourcerer.permissions.toastMessage",{defaultMessage:"Users with write permission need to access the Elastic Security app to initialize the app source data."})})}),[I,O.error]);const C=Object(n.useMemo)((()=>u.b.getTimelineByIdSelector()),[]),M=Object(m.a)((e=>C(e,p.d.active))),F=Object(n.useMemo)((()=>o.d.getSourcererScopeSelector()),[]),{sourcererScope:{selectedDataViewId:D,selectedPatterns:A,missingPatterns:_}}=Object(m.a)((t=>F(t,e))),{selectedDataView:N,sourcererScope:{selectedDataViewId:R,selectedPatterns:P,missingPatterns:L}}=Object(m.a)((e=>F(e,l.SourcererScopeName.timeline))),{indexFieldsSearch:B}=Object(y.b)(),q=Object(n.useCallback)((a=>{null!=a?Object.keys(a).forEach((n=>{var i,r,s,c;n===l.SourcererScopeName.default&&e===l.SourcererScopeName.detections||t(o.a.setSelectedDataView({id:n,selectedDataViewId:null!==(i=null===(r=a[n])||void 0===r?void 0:r.id)&&void 0!==i?i:null,selectedPatterns:null!==(s=null===(c=a[n])||void 0===c?void 0:c.selectedPatterns)&&void 0!==s?s:[]}))})):D&&S({[l.SourcererScopeName.default]:{id:D,selectedPatterns:A}})}),[t,D,e,A,S]);Object(E.b)(v.a.sourcerer,q);const z=Object(n.useRef)([]);Object(n.useEffect)((()=>{[...new Set([D,R])].forEach(((e,t)=>{if(null!=e&&e.length>0&&!z.current.includes(e)){z.current=[...z.current,e];const a=0===t?l.SourcererScopeName.default:l.SourcererScopeName.timeline,n=e===D?0===A.length&&0===_.length:R===e&&0===L.length&&0===(null==N?void 0:N.patternList.length);B({dataViewId:e,scopeId:a,needToBeInit:n,...n&&a===l.SourcererScopeName.timeline?{skipScopeUpdate:P.length>0}:{}})}}))}),[B,_.length,D,A.length,R,L.length,N,P.length]),Object(n.useEffect)((()=>{!h&&null!=k&&null==w&&(null==M||null==M.savedObjectId)&&s.current&&O.id.length>0?(s.current=!1,t(o.a.setSelectedDataView({id:l.SourcererScopeName.timeline,selectedDataViewId:O.id,selectedPatterns:Object(g.b)(O,l.SourcererScopeName.timeline,k,!0)}))):null!=w&&(null==M||null==M.savedObjectId)&&s.current&&O.id.length>0&&(s.current=!1,t(o.a.setSelectedDataView({id:l.SourcererScopeName.timeline,selectedDataViewId:O.id,selectedPatterns:Object(g.b)(O,l.SourcererScopeName.timeline,w,!0)})))}),[M,O,t,h,k,w]);const $=Object(n.useCallback)((e=>{-1===O.title.indexOf(e)&&(a.current.abort(),(async n=>{a.current=new AbortController,t(o.a.setSourcererScopeLoading({loading:!0}));try{const i=await Object(f.b)({body:{patternList:n},signal:a.current.signal});i.defaultDataView.patternList.includes(e)&&B({dataViewId:i.defaultDataView.id}),t(o.a.setSourcererDataViews(i)),t(o.a.setSourcererScopeLoading({loading:!1}))}catch(e){T(e,{title:r.i18n.translate("xpack.securitySolution.sourcerer.error.title",{defaultMessage:"Error updating Security Data View"}),toastMessage:r.i18n.translate("xpack.securitySolution.sourcerer.error.toastMessage",{defaultMessage:"Refresh the page"})}),t(o.a.setSourcererScopeLoading({loading:!1}))}})([...O.title.split(","),e]))}),[O.title,t,B,T]),V=Object(n.useCallback)((()=>{!h&&null!=k&&null==w&&O.id.length>0&&($(k),t(o.a.setSignalIndexName({signalIndexName:k})))}),[O.id.length,t,h,k,w,$]);Object(n.useEffect)((()=>{V()}),[k]),Object(n.useEffect)((()=>{e===l.SourcererScopeName.detections&&x&&null!=k&&d.current&&O.id.length>0?(d.current=!1,t(o.a.setSelectedDataView({id:l.SourcererScopeName.detections,selectedDataViewId:O.id,selectedPatterns:Object(g.b)(O,l.SourcererScopeName.detections,k,!0)}))):e===l.SourcererScopeName.detections&&null!=w&&s.current&&O.id.length>0&&(d.current=!1,o.a.setSelectedDataView({id:l.SourcererScopeName.detections,selectedDataViewId:O.id,selectedPatterns:Object(g.b)(O,l.SourcererScopeName.detections,w,!0)}))}),[O,t,x,e,k,w])},S=(e=l.SourcererScopeName.default)=>{const{getDataViewsSelector:t,getSourcererDataViewSelector:a,getScopeSelector:i}=Object(n.useMemo)((()=>({getDataViewsSelector:o.d.getSourcererDataViewsSelector(),getSourcererDataViewSelector:o.d.sourcererDataViewSelector(),getScopeSelector:o.d.scopeIdSelector()})),[]),{signalIndexName:r,selectedDataView:s,sourcererScope:{missingPatterns:c,selectedPatterns:u,loading:d}}=Object(m.a)((n=>{const r=i(n,e);return{...t(n),selectedDataView:a(n,r.selectedDataViewId),sourcererScope:r}})),p=Object(n.useMemo)((()=>Object(x.b)(u)),[u]),[b,f]=Object(n.useState)([]),[y,E]=Object(h.b)(b),v=Object(n.useMemo)((()=>{var e;return{...E,runtimeMappings:{},title:"",id:null!==(e=null==s?void 0:s.id)&&void 0!==e?e:null,loading:y,patternList:E.indexes,indexFields:E.indexPatterns.fields}}),[E,y,s]);Object(n.useEffect)((()=>{null==s||c.length>0?f(p):f([])}),[c,s,p]);const k=Object(n.useMemo)((()=>null==s||c.length>0?v:s),[v,c.length,s]),S=Object(n.useMemo)((()=>!(!d&&!k.loading)||Object(g.a)({scopeId:e,signalIndexName:r,patternList:k.patternList})),[d,e,r,k.loading,k.patternList]);return Object(n.useMemo)((()=>({browserFields:k.browserFields,dataViewId:k.id,indexPattern:{fields:k.indexFields,title:p.join(",")},indicesExist:S,loading:d||k.loading,runtimeMappings:k.runtimeMappings,patternList:k.title.split(","),selectedPatterns:p,...b.length>0?{activePatterns:k.patternList}:{}})),[k,p,S,d,b.length])},j=[d.d,`${d.lc}/id/:id`,`${d.H}/:detailName`],O=e=>null==Object(s.matchPath)(e,{path:j,strict:!1})?l.SourcererScopeName.default:l.SourcererScopeName.detections,w=[d.d,`${d.lc}/id/:id`,d.Hb,d.Gc,d.Sb,d.Zb],T=e=>null!=Object(s.matchPath)(e,{path:w,strict:!1})},,function(e,t,a){"use strict";a.d(t,"A",(function(){return g})),a.d(t,"e",(function(){return b})),a.d(t,"H",(function(){return f})),a.d(t,"O",(function(){return y})),a.d(t,"m",(function(){return h})),a.d(t,"F",(function(){return E})),a.d(t,"s",(function(){return v})),a.d(t,"M",(function(){return x})),a.d(t,"N",(function(){return k})),a.d(t,"f",(function(){return S})),a.d(t,"E",(function(){return j})),a.d(t,"x",(function(){return O})),a.d(t,"C",(function(){return w})),a.d(t,"n",(function(){return T})),a.d(t,"d",(function(){return I})),a.d(t,"K",(function(){return C})),a.d(t,"a",(function(){return M})),a.d(t,"I",(function(){return F})),a.d(t,"q",(function(){return N})),a.d(t,"i",(function(){return R})),a.d(t,"k",(function(){return P})),a.d(t,"j",(function(){return L})),a.d(t,"l",(function(){return B})),a.d(t,"J",(function(){return $})),a.d(t,"P",(function(){return V})),a.d(t,"c",(function(){return U})),a.d(t,"y",(function(){return H})),a.d(t,"b",(function(){return G})),a.d(t,"z",(function(){return Q})),a.d(t,"D",(function(){return W})),a.d(t,"L",(function(){return K})),a.d(t,"B",(function(){return Y})),a.d(t,"w",(function(){return J})),a.d(t,"r",(function(){return X})),a.d(t,"h",(function(){return Z})),a.d(t,"p",(function(){return ee})),a.d(t,"o",(function(){return te})),a.d(t,"v",(function(){return ae})),a.d(t,"u",(function(){return ne})),a.d(t,"g",(function(){return ie})),a.d(t,"t",(function(){return re})),a.d(t,"G",(function(){return se}));var n=a(108),i=a(346),r=a(508),s=a(54),o=a(347),l=a(341);const c=Object(n.createSelector)((e=>e),(({ariaActiveDescendant:e})=>e)),u=Object(n.createSelector)((e=>e),(({selectedNode:e})=>e)),d=Object(n.createSelector)((e=>e.locationSearch),(e=>e.resolverComponentInstanceID),((e,t)=>Object(o.a)({locationSearch:e,resolverComponentInstanceID:t}))),p=Object(n.createSelector)((e=>e.locationSearch),(e=>e.resolverComponentInstanceID),((e,t)=>a=>{if(void 0===e||void 0===t)return;const n=new URLSearchParams(e),i=Object(s.encode)(a);return n.set(Object(l.a)(t),i),`?${n.toString()}`}));var m=a(144);const g=oe(D,i.c),b=(oe(D,i.f),oe(A,r.d)),f=(oe(D,i.a),oe(D,i.d),oe(D,i.e)),y=oe(D,i.g),h=oe(D,i.b),E=oe(A,r.B),v=oe(A,r.q),x=oe(A,r.G),k=oe(A,r.H),S=oe(A,r.e),j=oe(A,r.A),O=oe(A,r.u),w=oe(A,r.z),T=oe(A,r.l),I=oe(A,r.c),C=oe(A,r.E),M=oe(_,c),F=oe(_,u);function D(e){return e.camera}function A(e){return e.data}function _(e){return e.ui}const N=oe(A,r.o),R=oe(A,r.h),P=oe(A,r.j),L=oe(A,r.i),B=oe(A,r.k),q=oe(D,i.h),z=oe(A,r.v),$=oe(A,r.D),V=Object(n.createSelector)(z,q,(function(e,t){return a=>e(t(a))})),U=oe(A,r.b),H=oe(A,r.w),G=Object(n.createSelector)(V,oe(A,r.a),(function(e,t){return Object(n.defaultMemoize)((a=>{const{processNodePositions:n}=e(a),i=new Set;for(const e of n.keys()){const t=m.b(e);void 0!==t&&i.add(t)}return e=>{const a=t(e);return null===a||!1===i.has(a)?null:a}}))})),Q=oe(_,d),W=oe(_,p),K=oe(A,r.F),Y=oe(A,r.y),J=oe(A,r.t),X=oe(A,r.p),Z=oe(A,r.g),ee=oe(A,r.n),te=oe(A,r.m),ae=oe(A,r.s),ne=oe(A,r.r),ie=oe(A,r.f),re=Object(n.createSelector)(oe(A,(e=>e.nodeData)),V,(function(e,t){return Object(n.defaultMemoize)((a=>{const{processNodePositions:n}=t(a),i=new Set;for(const t of n.keys()){const a=m.b(t);void 0===a||e&&e.has(a)||i.add(a)}return i}))})),se=oe(A,r.C);function oe(e,t){return a=>t(e(a))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return l})),a.d(t,"c",(function(){return c})),a.d(t,"e",(function(){return u})),a.d(t,"d",(function(){return d})),a.d(t,"f",(function(){return p})),a.d(t,"g",(function(){return m}));var n=a(32),i=a(34),r=a(33),s=a.n(r);const o="details",l=s.a.div.attrs((()=>({className:o}))).withConfig({displayName:"Details",componentId:"sc-1qa889y-0"})(["margin:5px 0 5px 10px;& .euiBadge{margin:2px 0 2px 0;}& .euiFlexGroup{justify-content:center;}"]);l.displayName="Details";const c=s()(n.EuiFlexItem).withConfig({displayName:"TokensFlexItem",componentId:"sc-1qa889y-1"})(["margin-left:3px;"]);function u(e){return Object(i.isNumber)(e)?!isFinite(e):Object(i.isEmpty)(e)}c.displayName="TokensFlexItem";const d=({eventCategory:e,eventDataset:t})=>"file"===(null==e?void 0:e.toLowerCase())||"file"===(null==t?void 0:t.toLowerCase())||"endpoint.events.file"===(null==t?void 0:t.toLowerCase()),p=e=>["process_stopped","termination_event"].includes(`${e}`.toLowerCase()),m=e=>["created","creation","deleted","deletion","file_create_event","file_delete_event","files-encrypted","load","modification","overwrite","rename"].includes(`${e}`.toLowerCase())},,,function(e,t,a){"use strict";var n=a(46);a.d(t,"j",(function(){return n.getUseField})),a.d(t,"i",(function(){return n.getFieldValidityAndErrorMessage})),a.d(t,"a",(function(){return n.FIELD_TYPES})),a.d(t,"c",(function(){return n.Form})),a.d(t,"e",(function(){return n.UseField})),a.d(t,"f",(function(){return n.UseMultiFields})),a.d(t,"k",(function(){return n.useForm})),a.d(t,"l",(function(){return n.useFormContext})),a.d(t,"m",(function(){return n.useFormData})),a.d(t,"g",(function(){return n.VALIDATION_TYPES}));var i=a(61);a.d(t,"b",(function(){return i.Field})),a.d(t,"d",(function(){return i.SelectField}));var r=a(65);a.d(t,"h",(function(){return r.fieldValidators}))},,function(e,t,a){"use strict";a.d(t,"c",(function(){return s})),a.d(t,"d",(function(){return o}));var n=a(83),i=a(184),r=a(429);a.d(t,"e",(function(){return n.f})),a.d(t,"g",(function(){return n.h})),a.d(t,"f",(function(){return n.g})),a.d(t,"k",(function(){return n.l})),a.d(t,"j",(function(){return n.k})),a.d(t,"n",(function(){return n.p})),a.d(t,"m",(function(){return n.o})),a.d(t,"l",(function(){return n.m})),a.d(t,"h",(function(){return n.i})),a.d(t,"o",(function(){return n.u})),a.d(t,"p",(function(){return n.v})),a.d(t,"i",(function(){return n.j})),a.d(t,"a",(function(){return n.b})),a.d(t,"b",(function(){return n.e}));const s=({activeTimelineDataProviders:e,dataProviders:t,dispatch:a,result:s,timelineId:o,noProviderFound:l=i.a.noProviderFound,onAddedToTimeline:c})=>{const u=Object(n.n)(s),d=t[u];d?Object(r.b)({dataProviders:e,destination:s.destination,dispatch:a,onAddedToTimeline:c,providerToAdd:d,timelineId:o}):a(l({id:u}))},o=({isAggregatable:e,fieldType:t,fieldName:a,hideTopN:n})=>{const i=["boolean","geo-point","geo-shape","ip","keyword","number","numeric","string"].includes(t),r=["kibana.alert.ancestors.depth","kibana.alert.ancestors.id","kibana.alert.ancestors.rule","kibana.alert.ancestors.type","kibana.alert.original_event.action","kibana.alert.original_event.category","kibana.alert.original_event.code","kibana.alert.original_event.created","kibana.alert.original_event.dataset","kibana.alert.original_event.duration","kibana.alert.original_event.end","kibana.alert.original_event.hash","kibana.alert.original_event.id","kibana.alert.original_event.kind","kibana.alert.original_event.module","kibana.alert.original_event.original","kibana.alert.original_event.outcome","kibana.alert.original_event.provider","kibana.alert.original_event.risk_score","kibana.alert.original_event.risk_score_norm","kibana.alert.original_event.sequence","kibana.alert.original_event.severity","kibana.alert.original_event.start","kibana.alert.original_event.timezone","kibana.alert.original_event.type","kibana.alert.original_time","kibana.alert.rule.created_by","kibana.alert.rule.description","kibana.alert.rule.enabled","kibana.alert.rule.false_positives","kibana.alert.rule.from","kibana.alert.rule.uuid","kibana.alert.rule.immutable","kibana.alert.rule.interval","kibana.alert.rule.max_signals","kibana.alert.rule.name","kibana.alert.rule.note","kibana.alert.rule.references","kibana.alert.risk_score","kibana.alert.rule.rule_id","kibana.alert.severity","kibana.alert.rule.size","kibana.alert.rule.tags","kibana.alert.rule.threat","kibana.alert.rule.threat.tactic.id","kibana.alert.rule.threat.tactic.name","kibana.alert.rule.threat.tactic.reference","kibana.alert.rule.threat.technique.id","kibana.alert.rule.threat.technique.name","kibana.alert.rule.threat.technique.reference","kibana.alert.rule.timeline_id","kibana.alert.rule.timeline_title","kibana.alert.rule.to","kibana.alert.rule.type","kibana.alert.rule.updated_by","kibana.alert.rule.version","kibana.alert.workflow_status"].includes(a);return!n&&(r||e&&i)}},,,,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(4),i=a(77),r=a(183);const s=e=>{var t;const[{pageName:a}]=Object(r.a)(),{services:{storage:s}}=Object(i.k)(),o=((e,t)=>t&&e.length>0?`kibana.siem:${t}.query.toggle:${e}`:null)(a,e),[l,c]=Object(n.useState)(null==o||null===(t=s.get(o))||void 0===t||t);Object(n.useEffect)((()=>{var e;null!=o&&c(null===(e=s.get(o))||void 0===e||e)}),[s,o]);const u=Object(n.useCallback)((e=>{null!=o&&(s.set(o,e),c(e))}),[s,o]);return e?{toggleStatus:l,setToggleStatus:u}:{toggleStatus:!0,setToggleStatus:()=>{}}}},,function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return r})),a.d(t,"e",(function(){return n})),a.d(t,"a",(function(){return g})),a.d(t,"d",(function(){return b}));var n={};a.r(n),a.d(n,"dnsSelector",(function(){return E})),a.d(n,"topNFlowSelector",(function(){return x})),a.d(n,"tlsSelector",(function(){return S})),a.d(n,"topCountriesSelector",(function(){return O})),a.d(n,"httpSelector",(function(){return T})),a.d(n,"usersSelector",(function(){return I})),a.d(n,"networkAnomaliesJobIdFilterSelector",(function(){return C})),a.d(n,"networkAnomaliesIntervalSelector",(function(){return M}));var i=a(355),r=a(229),s=a(108),o=a(34),l=a(192),c=a(328),u=a(85),d=a(253);const p=e=>({...e.page.queries,[r.NetworkTableType.topCountriesSource]:{...e.page.queries[r.NetworkTableType.topCountriesSource],activePage:d.a},[r.NetworkTableType.topCountriesDestination]:{...e.page.queries[r.NetworkTableType.topCountriesDestination],activePage:d.a},[r.NetworkTableType.topNFlowSource]:{...e.page.queries[r.NetworkTableType.topNFlowSource],activePage:d.a},[r.NetworkTableType.topNFlowDestination]:{...e.page.queries[r.NetworkTableType.topNFlowDestination],activePage:d.a},[r.NetworkTableType.dns]:{...e.page.queries[r.NetworkTableType.dns],activePage:d.a},[r.NetworkTableType.tls]:{...e.page.queries[r.NetworkTableType.tls],activePage:d.a},[r.NetworkTableType.http]:{...e.page.queries[r.NetworkTableType.http],activePage:d.a}}),m=e=>({...e.details.queries,[r.NetworkDetailsTableType.topCountriesSource]:{...e.details.queries[r.NetworkDetailsTableType.topCountriesSource],activePage:d.a},[r.NetworkDetailsTableType.topCountriesDestination]:{...e.details.queries[r.NetworkDetailsTableType.topCountriesDestination],activePage:d.a},[r.NetworkDetailsTableType.topNFlowSource]:{...e.details.queries[r.NetworkDetailsTableType.topNFlowSource],activePage:d.a},[r.NetworkDetailsTableType.topNFlowDestination]:{...e.details.queries[r.NetworkDetailsTableType.topNFlowDestination],activePage:d.a},[r.NetworkDetailsTableType.tls]:{...e.details.queries[r.NetworkDetailsTableType.tls],activePage:d.a},[r.NetworkDetailsTableType.users]:{...e.details.queries[r.NetworkDetailsTableType.users],activePage:d.a},[r.NetworkDetailsTableType.http]:{...e.details.queries[r.NetworkDetailsTableType.http],activePage:d.a}}),g={page:{queries:{[r.NetworkTableType.topNFlowSource]:{activePage:d.a,limit:d.b,sort:{field:u.s.bytes_out,direction:u.b.desc}},[r.NetworkTableType.topNFlowDestination]:{activePage:d.a,limit:d.b,sort:{field:u.s.bytes_in,direction:u.b.desc}},[r.NetworkTableType.dns]:{activePage:d.a,limit:d.b,sort:{field:u.n.uniqueDomains,direction:u.b.desc},isPtrIncluded:!1},[r.NetworkTableType.http]:{activePage:d.a,limit:d.b,sort:{direction:u.b.desc}},[r.NetworkTableType.tls]:{activePage:d.a,limit:d.b,sort:{field:u.r._id,direction:u.b.desc}},[r.NetworkTableType.topCountriesSource]:{activePage:d.a,limit:d.b,sort:{field:u.s.bytes_out,direction:u.b.desc}},[r.NetworkTableType.topCountriesDestination]:{activePage:d.a,limit:d.b,sort:{field:u.s.bytes_in,direction:u.b.desc}},[r.NetworkTableType.alerts]:{activePage:d.a,limit:d.b},[r.NetworkTableType.anomalies]:{jobIdSelection:[],intervalSelection:"auto"}}},details:{queries:{[r.NetworkDetailsTableType.http]:{activePage:d.a,limit:d.b,sort:{direction:u.b.desc}},[r.NetworkDetailsTableType.topCountriesSource]:{activePage:d.a,limit:d.b,sort:{field:u.s.bytes_out,direction:u.b.desc}},[r.NetworkDetailsTableType.topCountriesDestination]:{activePage:d.a,limit:d.b,sort:{field:u.s.bytes_in,direction:u.b.desc}},[r.NetworkDetailsTableType.topNFlowSource]:{activePage:d.a,limit:d.b,sort:{field:u.s.bytes_out,direction:u.b.desc}},[r.NetworkDetailsTableType.topNFlowDestination]:{activePage:d.a,limit:d.b,sort:{field:u.s.bytes_in,direction:u.b.desc}},[r.NetworkDetailsTableType.tls]:{activePage:d.a,limit:d.b,sort:{field:u.r._id,direction:u.b.desc}},[r.NetworkDetailsTableType.users]:{activePage:d.a,limit:d.b,sort:{field:u.t.name,direction:u.b.asc}},[r.NetworkDetailsTableType.anomalies]:{jobIdSelection:[],intervalSelection:"auto"}},flowTarget:u.f.source}},b=Object(c.reducerWithInitialState)(g).case(i.updateNetworkTable,((e,{networkType:t,tableType:a,updates:n})=>({...e,[t]:{...e[t],queries:{...e[t].queries,[a]:{...Object(o.get)([t,"queries",a],e),...n}}}}))).case(i.setNetworkTablesActivePageToZero,(e=>({...e,page:{...e.page,queries:p(e)},details:{...e.details,queries:m(e)}}))).case(i.setNetworkDetailsTablesActivePageToZero,(e=>({...e,details:{...e.details,queries:m(e)}}))).case(i.updateNetworkAnomaliesJobIdFilter,((e,{jobIds:t,networkType:a})=>a===r.NetworkType.page?Object(o.set)("page.queries.anomalies.jobIdSelection",t,e):Object(o.set)("details.queries.anomalies.jobIdSelection",t,e))).case(i.updateNetworkAnomaliesInterval,((e,{interval:t,networkType:a})=>a===r.NetworkType.page?Object(o.set)("page.queries.anomalies.intervalSelection",t,e):Object(o.set)("details.queries.anomalies.intervalSelection",t,e))).build(),f=(e,t)=>Object(o.get)(t,e.network),y=e=>e.network.page,h=e=>e.network.details,E=()=>Object(s.createSelector)(y,(e=>e.queries.dns)),v=(e,t,a)=>{const n=a===l.b.source?"topNFlowSource":"topNFlowDestination",i=t===r.NetworkType.page?r.NetworkTableType[n]:r.NetworkDetailsTableType[n];return Object(o.get)([t,"queries",i],e.network)||Object(o.get)([t,"queries",i],g)},x=()=>Object(s.createSelector)(v,(e=>e)),k=(e,t)=>{const a=t===r.NetworkType.page?r.NetworkTableType.tls:r.NetworkDetailsTableType.tls;return Object(o.get)([t,"queries",a],e.network)||Object(o.get)([t,"queries",a],g)},S=()=>Object(s.createSelector)(k,(e=>e)),j=(e,t,a)=>{const n=a===l.b.source?"topCountriesSource":"topCountriesDestination",i=t===r.NetworkType.page?r.NetworkTableType[n]:r.NetworkDetailsTableType[n];return Object(o.get)([t,"queries",i],e.network)||Object(o.get)([t,"queries",i],g)},O=()=>Object(s.createSelector)(j,(e=>e)),w=(e,t)=>{const a=t===r.NetworkType.page?r.NetworkTableType.http:r.NetworkDetailsTableType.http;return Object(o.get)([t,"queries",a],e.network)||Object(o.get)([t,"queries",a],g)},T=()=>Object(s.createSelector)(w,(e=>e)),I=()=>Object(s.createSelector)(h,(e=>e.queries.users)),C=()=>Object(s.createSelector)(f,(e=>e.queries[r.NetworkTableType.anomalies].jobIdSelection)),M=()=>Object(s.createSelector)(f,(e=>e.queries[r.NetworkTableType.anomalies].intervalSelection))},,function(e,t,a){"use strict";a.d(t,"Xb",(function(){return i})),a.d(t,"Kb",(function(){return r})),a.d(t,"Mb",(function(){return s})),a.d(t,"Pc",(function(){return o})),a.d(t,"d",(function(){return l})),a.d(t,"Wb",(function(){return c})),a.d(t,"Fb",(function(){return u})),a.d(t,"Eb",(function(){return d})),a.d(t,"Db",(function(){return p})),a.d(t,"e",(function(){return m})),a.d(t,"Ab",(function(){return g})),a.d(t,"Yb",(function(){return b})),a.d(t,"f",(function(){return f})),a.d(t,"s",(function(){return y})),a.d(t,"q",(function(){return h})),a.d(t,"t",(function(){return E})),a.d(t,"r",(function(){return v})),a.d(t,"n",(function(){return x})),a.d(t,"u",(function(){return k})),a.d(t,"x",(function(){return S})),a.d(t,"h",(function(){return j})),a.d(t,"o",(function(){return O})),a.d(t,"j",(function(){return w})),a.d(t,"p",(function(){return T})),a.d(t,"k",(function(){return I})),a.d(t,"i",(function(){return C})),a.d(t,"w",(function(){return M})),a.d(t,"v",(function(){return F})),a.d(t,"W",(function(){return D})),a.d(t,"U",(function(){return A})),a.d(t,"V",(function(){return _})),a.d(t,"Y",(function(){return N})),a.d(t,"A",(function(){return R})),a.d(t,"m",(function(){return P})),a.d(t,"y",(function(){return L})),a.d(t,"l",(function(){return B})),a.d(t,"z",(function(){return q})),a.d(t,"X",(function(){return z})),a.d(t,"S",(function(){return $})),a.d(t,"K",(function(){return V})),a.d(t,"B",(function(){return U})),a.d(t,"M",(function(){return H})),a.d(t,"C",(function(){return G})),a.d(t,"E",(function(){return Q})),a.d(t,"F",(function(){return W})),a.d(t,"D",(function(){return K})),a.d(t,"L",(function(){return Y})),a.d(t,"N",(function(){return J})),a.d(t,"O",(function(){return X})),a.d(t,"G",(function(){return Z})),a.d(t,"P",(function(){return ee})),a.d(t,"H",(function(){return te})),a.d(t,"T",(function(){return ae})),a.d(t,"J",(function(){return ne})),a.d(t,"I",(function(){return ie})),a.d(t,"Q",(function(){return re})),a.d(t,"R",(function(){return se})),a.d(t,"g",(function(){return oe})),a.d(t,"Gb",(function(){return le})),a.d(t,"Ic",(function(){return ce})),a.d(t,"Hc",(function(){return ue})),a.d(t,"Mc",(function(){return de})),a.d(t,"Kc",(function(){return pe})),a.d(t,"Z",(function(){return me})),a.d(t,"Jc",(function(){return ge})),a.d(t,"Bb",(function(){return be})),a.d(t,"Ob",(function(){return fe})),a.d(t,"Pb",(function(){return ye})),a.d(t,"zb",(function(){return he})),a.d(t,"Hb",(function(){return Ee})),a.d(t,"yb",(function(){return ve})),a.d(t,"lb",(function(){return xe})),a.d(t,"kb",(function(){return ke})),a.d(t,"mb",(function(){return Se})),a.d(t,"fb",(function(){return je})),a.d(t,"hb",(function(){return Oe})),a.d(t,"gb",(function(){return we})),a.d(t,"ob",(function(){return Te})),a.d(t,"nb",(function(){return Ie})),a.d(t,"ab",(function(){return Ce})),a.d(t,"db",(function(){return Me})),a.d(t,"eb",(function(){return Fe})),a.d(t,"ib",(function(){return De})),a.d(t,"jb",(function(){return Ae})),a.d(t,"bb",(function(){return _e})),a.d(t,"cb",(function(){return Ne})),a.d(t,"Bc",(function(){return Re})),a.d(t,"Qb",(function(){return Pe})),a.d(t,"qb",(function(){return Le})),a.d(t,"Cb",(function(){return Be})),a.d(t,"Oc",(function(){return qe})),a.d(t,"Tb",(function(){return ze})),a.d(t,"Rb",(function(){return $e})),a.d(t,"Sb",(function(){return Ve})),a.d(t,"rb",(function(){return Ue})),a.d(t,"b",(function(){return He})),a.d(t,"Gc",(function(){return Ge})),a.d(t,"Cc",(function(){return Qe})),a.d(t,"sb",(function(){return We})),a.d(t,"a",(function(){return Ke})),a.d(t,"Fc",(function(){return Ye})),a.d(t,"c",(function(){return Je})),a.d(t,"Ub",(function(){return Xe})),a.d(t,"pb",(function(){return Ze})),a.d(t,"tb",(function(){return et})),a.d(t,"Lb",(function(){return tt})),a.d(t,"Lc",(function(){return at})),a.d(t,"Nb",(function(){return nt})),a.d(t,"Vb",(function(){return it})),a.d(t,"Nc",(function(){return rt})),a.d(t,"Ib",(function(){return st})),a.d(t,"Jb",(function(){return ot})),a.d(t,"xb",(function(){return lt})),a.d(t,"wb",(function(){return ct})),a.d(t,"vb",(function(){return ut})),a.d(t,"ub",(function(){return dt})),a.d(t,"Zb",(function(){return pt})),a.d(t,"ac",(function(){return mt})),a.d(t,"zc",(function(){return gt})),a.d(t,"Ac",(function(){return bt})),a.d(t,"yc",(function(){return ft})),a.d(t,"wc",(function(){return yt})),a.d(t,"xc",(function(){return ht})),a.d(t,"lc",(function(){return Et})),a.d(t,"mc",(function(){return vt})),a.d(t,"jc",(function(){return xt})),a.d(t,"kc",(function(){return kt})),a.d(t,"dc",(function(){return St})),a.d(t,"ec",(function(){return jt})),a.d(t,"bc",(function(){return Ot})),a.d(t,"cc",(function(){return wt})),a.d(t,"uc",(function(){return Tt})),a.d(t,"vc",(function(){return It})),a.d(t,"sc",(function(){return Ct})),a.d(t,"tc",(function(){return Mt})),a.d(t,"hc",(function(){return Ft})),a.d(t,"ic",(function(){return Dt})),a.d(t,"fc",(function(){return At})),a.d(t,"gc",(function(){return _t})),a.d(t,"pc",(function(){return Nt})),a.d(t,"qc",(function(){return Rt})),a.d(t,"rc",(function(){return Pt})),a.d(t,"nc",(function(){return Lt})),a.d(t,"oc",(function(){return Bt})),a.d(t,"Dc",(function(){return qt})),a.d(t,"Ec",(function(){return zt}));var n=a(0);const i=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.rules.popoverTooltip.ariaLabel",{defaultMessage:"Tooltip for column: {columnName}",values:{columnName:e}}),r=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.importRuleTitle",{defaultMessage:"Import rules"}),s=n.i18n.translate("xpack.securitySolution.lists.detectionEngine.rules.importValueListsButton",{defaultMessage:"Import value lists"}),o=n.i18n.translate("xpack.securitySolution.lists.detectionEngine.rules.uploadValueListsButtonTooltip",{defaultMessage:"Use value lists to create an exception when a field value matches a value found in a list"}),l=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.addNewRuleTitle",{defaultMessage:"Create new rule"}),c=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.pageTitle",{defaultMessage:"Rules"}),u=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.experimentalOn",{defaultMessage:"Advanced sorting"}),d=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.experimentalOff",{defaultMessage:"Advanced sorting"}),p=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.experimentalDescription",{defaultMessage:"Turn this on to enable sorting for all table columns. You can turn it off if you encounter table performance issues."}),m=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.addPageTitle",{defaultMessage:"Create"}),g=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.editPageTitle",{defaultMessage:"Edit"}),b=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.refreshTitle",{defaultMessage:"Refresh"}),f=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.batchActionsTitle",{defaultMessage:"Bulk actions"}),y=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.enableTitle",{defaultMessage:"Enable"}),h=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disableTitle",{defaultMessage:"Disable"}),E=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.exportTitle",{defaultMessage:"Export"}),v=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicateTitle",{defaultMessage:"Duplicate"}),x=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.deleteTitle",{defaultMessage:"Delete"}),k=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.indexPatternsTitle",{defaultMessage:"Index patterns"}),S=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.tagsTitle",{defaultMessage:"Tags"}),j=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.addIndexPatternsTitle",{defaultMessage:"Add index patterns"}),O=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.deleteIndexPatternsTitle",{defaultMessage:"Delete index patterns"}),w=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.addTagsTitle",{defaultMessage:"Add tags"}),T=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.deleteTagsTitle",{defaultMessage:"Delete tags"}),I=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.applyTimelineTemplateTitle",{defaultMessage:"Apply Timeline template"}),C=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.addRuleActionsTitle",{defaultMessage:"Add rule actions"}),M=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.setScheduleTitle",{defaultMessage:"Update rule schedules"}),F=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.contextMenuTitle",{defaultMessage:"Options"}),D=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkEditWarningToastTitle",{defaultMessage:"Rules updates are in progress"}),A=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkEditWarningToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} updating."}),_=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkEditWarningToastNotifyButtonLabel",{defaultMessage:"Notify me when done"}),N=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkExportConfirmationDeniedTitle",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule} other {# rules}} cannot be exported"}),R=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkEditConfirmationDeniedTitle",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule} other {# rules}} cannot be edited"}),P=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkActionConfirmationPartlyTitle",{values:{customRulesCount:e},defaultMessage:"This action can only be applied to {customRulesCount, plural, =1 {# custom rule} other {# custom rules}}"}),L=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditConfirmationCancelButtonLabel",{defaultMessage:"Cancel"}),B=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkActionConfirmationCloseButtonLabel",{defaultMessage:"Close"}),q=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditConfirmation.confirmButtonLabel",{values:{customRulesCount:e},defaultMessage:"Edit {customRulesCount, plural, =1 {# custom rule} other {# custom rules}}"}),z=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkExportConfirmation.confirmButtonLabel",{values:{customRulesCount:e},defaultMessage:"Export {customRulesCount, plural, =1 {# custom rule} other {# custom rules}}"}),$=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.saveButtonLabel",{defaultMessage:"Save"}),V=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.cancelButtonLabel",{defaultMessage:"Cancel"}),U=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addIndexPatternsComboboxHelpText",{defaultMessage:"Enter the pattern of Elasticsearch indices that you would like to add. By default, the dropdown includes index patterns defined in Security Solution advanced settings."}),H=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteIndexPatternsComboboxHelpText",{defaultMessage:"Enter the pattern of Elasticsearch indices that you would like to delete. By default, the dropdown includes index patterns defined in Security Solution advanced settings."}),G=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addIndexPatternsComboboxLabel",{defaultMessage:"Add index patterns for selected rules"}),Q=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.indexPatternsRequiredErrorMessage",{defaultMessage:"A minimum of one index pattern is required."}),W=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addIndexPatternsTitle",{defaultMessage:"Add index patterns"}),K=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addIndexPatternsOverwriteCheckboxLabel",{defaultMessage:"Overwrite all selected rules' index patterns"}),Y=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.dataViewsOverwriteCheckboxLabel",{defaultMessage:"Apply changes to rules configured with data views"}),J=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteIndexPatternsComboboxLabel",{defaultMessage:"Delete index patterns for selected rules"}),X=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteIndexPatternsTitle",{defaultMessage:"Delete index patterns"}),Z=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addTagsComboboxHelpText",{defaultMessage:"Add one or more tags for selected rules from the dropdown. You can also enter custom identifying tags and press Enter to begin a new one."}),ee=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteTagsComboboxHelpText",{defaultMessage:"Delete one or more tags for selected rules from the dropdown. You can also enter custom identifying tags and press Enter to begin a new one."}),te=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addTagsComboboxLabel",{defaultMessage:"Add tags for selected rules"}),ae=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.tagsComoboxRequiredErrorMessage",{defaultMessage:"A minimum of one tag is required."}),ne=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addTagsTitle",{defaultMessage:"Add tags"}),ie=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addTagsOverwriteCheckboxLabel",{defaultMessage:"Overwrite all selected rules' tags"}),re=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteTagsComboboxLabel",{defaultMessage:"Delete tags for selected rules"}),se=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteTagsTitle",{defaultMessage:"Delete tags"}),oe=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.batchActions.deleteSelectedImmutableTitle",{defaultMessage:"Selection contains immutable rules which cannot be deleted"}),le=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.exportFilenameTitle",{defaultMessage:"rules_export"}),ce=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.searchAriaLabel",{defaultMessage:"Search rules"}),ue=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.searchPlaceholder",{defaultMessage:'Rule name, index pattern (e.g., "filebeat-*"), or MITRE ATT&CK™ tactic or technique (e.g., "Defense Evasion" or "TA0005")'}),de=(e,t,a)=>n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.showingRulesTitle",{values:{firstInPage:e,lastOfPage:t,totalRules:a},defaultMessage:"Showing {firstInPage}-{lastOfPage} of {totalRules} {totalRules, plural, =1 {rule} other {rules}}"}),pe=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.selectAllRulesTitle",{values:{totalRules:e},defaultMessage:"Select all {totalRules} {totalRules, plural, =1 {rule} other {rules}}"}),me=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.clearSelectionTitle",{defaultMessage:"Clear selection"}),ge=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.selectedRulesTitle",{values:{selectedRules:e},defaultMessage:"Selected {selectedRules} {selectedRules, plural, =1 {rule} other {rules}}"}),be=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.editRuleSettingsDescription",{defaultMessage:"Edit rule settings"}),fe=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.lackOfKibanaActionsFeaturePrivileges",{defaultMessage:"You do not have Kibana Actions privileges"}),ye=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.lackOfKibanaSecurityPrivileges",{defaultMessage:"You do not have Kibana Security privileges"}),he=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.duplicateRuleDescription",{defaultMessage:"Duplicate rule"}),Ee=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.exportRuleDescription",{defaultMessage:"Export rule"}),ve=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.deleteRuleDescription",{defaultMessage:"Delete rule"}),xe=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.ruleTitle",{defaultMessage:"Rule"}),ke=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.riskScoreTitle",{defaultMessage:"Risk score"}),Se=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.severityTitle",{defaultMessage:"Severity"}),je=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.lastRunTitle",{defaultMessage:"Last run"}),Oe=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.lastUpdateTitle",{defaultMessage:"Last updated"}),we=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.lastResponseTitle",{defaultMessage:"Last response"}),Te=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.versionTitle",{defaultMessage:"Version"}),Ie=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.tagsTitle",{defaultMessage:"Tags"}),Ce=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.enabledTitle",{defaultMessage:"Enabled"}),Me=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.indexingTimes",{defaultMessage:"Indexing Time (ms)"}),Fe=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.indexingTimesTooltip",{defaultMessage:"Total time spent indexing alerts during last Rule execution"}),De=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.queryTimes",{defaultMessage:"Query Time (ms)"}),Ae=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.queryTimesTooltip",{defaultMessage:"Total time spent querying source indices during last Rule execution"}),_e=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.gap",{defaultMessage:"Last Gap (if any)"}),Ne=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.gapTooltipSeeDocsDescription",{defaultMessage:"see documentation"}),Re=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.tabs.rules",{defaultMessage:"Rules"}),Pe=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.tabs.monitoring",{defaultMessage:"Rule Monitoring"}),Le=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.customRulesTitle",{defaultMessage:"Custom rules"}),Be=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.elasticRulesTitle",{defaultMessage:"Elastic rules"}),qe=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.tagsLabel",{defaultMessage:"Tags"}),ze=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.noTagsAvailableDescription",{defaultMessage:"No tags available"}),$e=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.noRulesTitle",{defaultMessage:"No rules found"}),Ve=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.noRulesBodyTitle",{defaultMessage:"We weren't able to find any rules with the above filters."}),Ue=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.defineRuleTitle",{defaultMessage:"Define rule"}),He=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.aboutRuleTitle",{defaultMessage:"About rule"}),Ge=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.scheduleRuleTitle",{defaultMessage:"Schedule rule"}),Qe=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.ruleActionsTitle",{defaultMessage:"Rule actions"}),We=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.stepDefinitionTitle",{defaultMessage:"Definition"}),Ke=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.stepAboutTitle",{defaultMessage:"About"}),Ye=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.stepScheduleTitle",{defaultMessage:"Schedule"}),Je=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.stepActionsTitle",{defaultMessage:"Actions"}),Xe=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.optionalFieldDescription",{defaultMessage:"Optional"}),Ze=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.continueButtonTitle",{defaultMessage:"Continue"}),et=(n.i18n.translate("xpack.securitySolution.detectionEngine.rules.updateButtonTitle",{defaultMessage:"Update"}),n.i18n.translate("xpack.securitySolution.detectionEngine.rules.deleteDescription",{defaultMessage:"Delete"})),tt=n.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importRuleTitle",{defaultMessage:"Import"}),at=n.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.selectRuleDescription",{defaultMessage:"Select rules to import. Associated rule actions and exceptions can be included."}),nt=n.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.initialPromptTextDescription",{defaultMessage:"Select or drag and drop a valid rules_export.ndjson file"}),it=n.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.overwriteDescription",{defaultMessage:'Overwrite existing detection rules with conflicting "rule_id"'}),rt=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.successfullyImportedRulesTitle",{values:{totalRules:e},defaultMessage:"Successfully imported {totalRules} {totalRules, plural, =1 {rule} other {rules}}"}),st=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importFailedTitle",{values:{totalRules:e},defaultMessage:"Failed to import {totalRules} {totalRules, plural, =1 {rule} other {rules}}"}),ot=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importFailedDetailedTitle",{values:{message:e},defaultMessage:"{message}"}),lt=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.deleteConfirmationTitle",{defaultMessage:"Confirm bulk deletion"}),ct=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.deleteConfirmationConfirm",{defaultMessage:"Confirm"}),ut=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.deleteConfirmationCancel",{defaultMessage:"Cancel"}),dt=n.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.deleteConfirmationBody",{defaultMessage:'This action will delete all rules that match current filter query. Click "Confirm" to continue.'}),pt=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.refreshRulePopoverDescription",{defaultMessage:"Automatically refresh table"}),mt=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.refreshRulePopoverLabel",{defaultMessage:"Refresh settings"}),gt=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.successToastTitle",{defaultMessage:"Rules exported"}),bt=(e,t)=>n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.successToastDescription",{values:{totalRules:t,exportedRules:e},defaultMessage:"Successfully exported {exportedRules} of {totalRules} {totalRules, plural, =1 {rule} other {rules}}."}),ft=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.prebuiltRulesExcludedToastDescription",{defaultMessage:"Prebuilt rules were excluded from the resulting file."}),yt=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.errorToastTitle",{defaultMessage:"Error exporting rules"}),ht=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to export."}),Et=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.successToastTitle",{defaultMessage:"Rules duplicated"}),vt=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.successToastDescription",{values:{totalRules:e},defaultMessage:"Successfully duplicated {totalRules, plural, =1 {{totalRules} rule} other {{totalRules} rules}}"}),xt=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.errorToastTitle",{defaultMessage:"Error duplicating rule"}),kt=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to duplicate."}),St=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.delete.successToastTitle",{defaultMessage:"Rules deleted"}),jt=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.delete.successToastDescription",{values:{totalRules:e},defaultMessage:"Successfully deleted {totalRules, plural, =1 {{totalRules} rule} other {{totalRules} rules}}"}),Ot=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.delete.errorToastTitle",{defaultMessage:"Error deleting rules"}),wt=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.delete.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to delete."}),Tt=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.enable.successToastTitle",{defaultMessage:"Rules enabled"}),It=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkAction.enable.successToastDescription",{values:{totalRules:e},defaultMessage:"Successfully enabled {totalRules, plural, =1 {{totalRules} rule} other {{totalRules} rules}}"}),Ct=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.enable.errorToastTitle",{defaultMessage:"Error enabling rules"}),Mt=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.enable.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to enable."}),Ft=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disable.successToastTitle",{defaultMessage:"Rules disabled"}),Dt=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disable.successToastDescription",{values:{totalRules:e},defaultMessage:"Successfully disabled {totalRules, plural, =1 {{totalRules} rule} other {{totalRules} rules}}"}),At=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disable.errorToastTitle",{defaultMessage:"Error disabling rules"}),_t=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disable.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to disable."}),Nt=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.successToastTitle",{defaultMessage:"Rules updated"}),Rt=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.successToastDescription",{values:{rulesCount:e},defaultMessage:"You've successfully updated {rulesCount, plural, =1 {# rule} other {# rules}}"}),Pt=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.successIndexEditToastDescription",{defaultMessage:"If you did not select to apply changes to rules using Kibana data views, those rules were not updated and will continue using data views."}),Lt=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.errorToastTitle",{defaultMessage:"Error updating rules"}),Bt=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule} other {# rules}} failed to update."}),qt=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.rulePreviewTitle",{defaultMessage:"Rule preview"}),zt=(n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.rulePreviewDescription",{defaultMessage:"Rule preview reflects the current configuration of your rule settings and exceptions, click refresh icon to see the updated preview."}),n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.cancelButtonLabel",{defaultMessage:"Cancel"}),n.i18n.translate("xpack.securitySolution.hooks.useGetSavedQuery.errorToastMessage",{defaultMessage:"Failed to load the saved query"}))},function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(34),i=a(4),r=a(78),s=a(90),o=a(81),l=a(98),c=a(184);const u=(e=!0)=>{const t=Object(r.useDispatch)(),{from:a,to:u}=Object(o.a)((e=>Object(n.pick)(["from","to"],l.d.globalTimeRangeSelector(e)))),[d,p]=Object(i.useState)(!0),m=Object(i.useCallback)((({id:e,inspect:a,loading:n,refetch:i,searchSessionId:r})=>t(c.b.setQuery({inputId:s.a.global,id:e,inspect:a,loading:n,refetch:i,searchSessionId:r}))),[t]),g=Object(i.useCallback)((({id:e})=>t(c.b.deleteOneQuery({inputId:s.a.global,id:e}))),[t]);return Object(i.useEffect)((()=>{p(!1)}),[]),Object(i.useEffect)((()=>()=>{e&&t(c.b.deleteAllQuery({id:s.a.global}))}),[t,e]),Object(i.useMemo)((()=>({isInitializing:d,from:a,to:u,setQuery:m,deleteQuery:g})),[g,a,d,m,u])}},function(e,t,a){"use strict";e.exports=function(e){return e<-2}},,,function(e,t,a){"use strict";a.d(t,"k",(function(){return i})),a.d(t,"B",(function(){return r})),a.d(t,"x",(function(){return s})),a.d(t,"a",(function(){return o})),a.d(t,"z",(function(){return l})),a.d(t,"p",(function(){return c})),a.d(t,"q",(function(){return u})),a.d(t,"r",(function(){return d})),a.d(t,"n",(function(){return p})),a.d(t,"o",(function(){return m})),a.d(t,"t",(function(){return g})),a.d(t,"u",(function(){return b})),a.d(t,"s",(function(){return f})),a.d(t,"l",(function(){return y})),a.d(t,"m",(function(){return h})),a.d(t,"f",(function(){return E})),a.d(t,"g",(function(){return v})),a.d(t,"e",(function(){return x})),a.d(t,"c",(function(){return k})),a.d(t,"d",(function(){return S})),a.d(t,"b",(function(){return j})),a.d(t,"A",(function(){return O})),a.d(t,"v",(function(){return w})),a.d(t,"w",(function(){return T})),a.d(t,"C",(function(){return I})),a.d(t,"i",(function(){return C})),a.d(t,"j",(function(){return M})),a.d(t,"h",(function(){return F})),a.d(t,"y",(function(){return D}));var n=a(0);n.i18n.translate("xpack.securitySolution.detectionEngine.pageTitle",{defaultMessage:"Detection engine"});const i=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.documentTypeTitle",{defaultMessage:"Alerts"}),r=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.openAlertsTitle",{defaultMessage:"Open"}),s=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.closedAlertsTitle",{defaultMessage:"Closed"}),o=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.acknowledgedAlertsTitle",{defaultMessage:"Acknowledged"}),l=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.loadingAlertsTitle",{defaultMessage:"Loading Alerts"}),c=(n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.totalCountOfAlertsTitle",{defaultMessage:"alerts"}),n.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.ruleTitle",{defaultMessage:"Rule"})),u=(n.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.ruleNameTitle",{defaultMessage:"Rule name"}),n.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.ruleDescriptionTitle",{defaultMessage:"Rule description"})),d=n.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.severityTitle",{defaultMessage:"Severity"}),p=n.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.reasonTitle",{defaultMessage:"Reason"}),m=n.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.riskScoreTitle",{defaultMessage:"Risk Score"}),g=n.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.thresholdCount",{defaultMessage:"Event Count"}),b=n.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.thresholdTerms",{defaultMessage:"Threshold Terms"}),f=n.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.thresholdCardinality",{defaultMessage:"Event Cardinality"}),y=n.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.newTerms",{defaultMessage:"New Terms"}),h=n.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.newTermsFields",{defaultMessage:"New Terms fields"}),E=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.actions.investigateInTimelineTitle",{defaultMessage:"Investigate in timeline"}),v=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.actions.investigateInTimelineAriaLabel",{defaultMessage:"Send alert to timeline"}),x=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.actions.addException",{defaultMessage:"Add rule exception"}),k=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.actions.addEventFilter",{defaultMessage:"Add Endpoint event filter"}),S=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.actions.addEventFilter.disabled.tooltip",{defaultMessage:"Endpoint event filters can be created from the Events section of the Hosts page."}),j=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.actions.addEndpointException",{defaultMessage:"Add Endpoint exception"}),O=(n.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.alertDurationTitle",{defaultMessage:"Alert duration"}),n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.closedAlertFailedToastMessage",{defaultMessage:"Failed to close alert(s)."}),n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.openedAlertFailedToastMessage",{defaultMessage:"Failed to open alert(s)"}),n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.acknowledgedAlertFailedToastMessage",{defaultMessage:"Failed to mark alert(s) as acknowledged"}),n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.moreActionsAriaLabel",{defaultMessage:"More actions"})),w=(n.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.statusTitle",{defaultMessage:"Status"}),n.i18n.translate("xpack.securitySolution.eventsViewer.alerts.overview.changeAlertStatus",{defaultMessage:"Change alert status"})),T=n.i18n.translate("xpack.securitySolution.eventsViewer.alerts.overview.clickToChangeAlertStatus",{defaultMessage:"Click to change alert status"}),I=n.i18n.translate("xpack.securitySolution.eventsViewer.alerts.overviewTable.signalStatusTitle",{defaultMessage:"Status"}),C=(n.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.triggeredTitle",{defaultMessage:"Triggered"}),n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.actions.addToCase",{defaultMessage:"Add to existing case"})),M=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.actions.addToNewCase",{defaultMessage:"Add to new case"}),F=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.actions.addToCaseDisabled",{defaultMessage:"Add to case is not supported for this selection"}),D=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.actions.addBulkToTimeline",{defaultMessage:"Investigate in timeline"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var n=a(32),i=a(4),r=a.n(i),s=a(33),o=a.n(s),l=a(47),c=a.n(l),u=a(124),d=a(615),p=a(856);const m=o.a.header.withConfig({displayName:"Header",componentId:"sc-g1ve9j-0"})(["&.toggle-expand{margin-bottom:",";}.no-margin{margin-top:0 !important;margin-bottom:0 !important;}"," margin-bottom:0;user-select:text;",""],(({theme:e})=>e.eui.euiSizeL),(({height:e})=>e&&Object(s.css)(["height:","px;"],e)),(({border:e})=>e&&Object(s.css)(["border-bottom:",";padding-bottom:",";"],(({theme:e})=>e.eui.euiBorderThin),(({theme:e})=>e.eui.euiSizeL))));m.displayName="Header";const g=({alignHeader:e,stackHeader:t})=>null!=e?e:t?void 0:"center",b=({alignHeader:e,border:t,children:a,outerDirection:s="column",growLeftSplit:o=!0,headerFilters:l,height:b,hideSubtitle:f=!1,id:y,inspectMultiple:h=!1,inspectTitle:E,isInspectDisabled:v,showInspectButton:x=!0,split:k,stackHeader:S,subtitle:j,title:O,titleSize:w="m",toggleQuery:T,toggleStatus:I=!0,tooltip:C})=>{const M=Object(i.useCallback)((()=>{T&&T(!I)}),[T,I]),F=c()({"toggle-expand":I,siemHeaderSection:!0});return r.a.createElement(m,{"data-test-subj":"header-section",border:t,height:b,className:F,$hideSubtitle:f},r.a.createElement(n.EuiFlexGroup,{"data-test-subj":"headerSectionOuterFlexGroup",direction:s,gutterSize:"xs",responsive:!1},r.a.createElement(n.EuiFlexItem,{grow:o},r.a.createElement(n.EuiFlexGroup,{alignItems:g({alignHeader:e,stackHeader:S}),"data-test-subj":"headerSectionInnerFlexGroup",direction:S?"column":"row",gutterSize:"s"},r.a.createElement(n.EuiFlexItem,{grow:o,className:I?"":"no-margin"},r.a.createElement(n.EuiFlexGroup,{alignItems:"center",responsive:!1,gutterSize:"s"},r.a.createElement(n.EuiFlexItem,null,r.a.createElement(n.EuiFlexGroup,{responsive:!1,gutterSize:"none",className:"header-section-titles"},T&&r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiButtonIcon,{"data-test-subj":"query-toggle-header","aria-label":p.a(I),color:"text",display:"empty",iconType:I?"arrowDown":"arrowRight",onClick:M,size:"s",title:p.a(I)})),r.a.createElement(n.EuiFlexItem,null,r.a.createElement(n.EuiTitle,{size:w},r.a.createElement("h4",{"data-test-subj":"header-section-title"},r.a.createElement("span",{className:"eui-textBreakNormal"},O),C&&r.a.createElement(r.a.Fragment,null," ",r.a.createElement(n.EuiIconTip,{color:"subdued",content:C,size:"l",type:"iInCircle"}))))))),y&&I&&r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(u.b,{isDisabled:v,queryId:y,multiple:h,showInspectButton:x,title:null!=E?E:O})),l&&I&&r.a.createElement(n.EuiFlexItem,{"data-test-subj":"header-section-filters",grow:!1},l))),a&&I&&r.a.createElement(n.EuiFlexItem,{"data-test-subj":"header-section-supplements",grow:!!k},a))),!f&&I&&r.a.createElement(n.EuiFlexItem,null,r.a.createElement(d.a,{"data-test-subj":"header-section-subtitle",items:j}))))},f=r.a.memo(b)},function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(4),i=a(699);const r=()=>Object(n.useContext)(i.a)},function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return s})),a.d(t,"f",(function(){return o})),a.d(t,"g",(function(){return l})),a.d(t,"i",(function(){return c})),a.d(t,"h",(function(){return u})),a.d(t,"j",(function(){return d})),a.d(t,"k",(function(){return p})),a.d(t,"l",(function(){return m})),a.d(t,"m",(function(){return g})),a.d(t,"o",(function(){return b})),a.d(t,"n",(function(){return f})),a.d(t,"w",(function(){return y})),a.d(t,"y",(function(){return h})),a.d(t,"z",(function(){return E})),a.d(t,"A",(function(){return v})),a.d(t,"B",(function(){return x})),a.d(t,"d",(function(){return k})),a.d(t,"e",(function(){return S})),a.d(t,"C",(function(){return j})),a.d(t,"D",(function(){return O})),a.d(t,"E",(function(){return w})),a.d(t,"F",(function(){return T})),a.d(t,"H",(function(){return I})),a.d(t,"I",(function(){return C})),a.d(t,"J",(function(){return M})),a.d(t,"K",(function(){return F})),a.d(t,"W",(function(){return D})),a.d(t,"X",(function(){return A})),a.d(t,"Y",(function(){return _})),a.d(t,"Z",(function(){return N})),a.d(t,"x",(function(){return R})),a.d(t,"ab",(function(){return P})),a.d(t,"bb",(function(){return L})),a.d(t,"L",(function(){return B})),a.d(t,"M",(function(){return q})),a.d(t,"O",(function(){return z})),a.d(t,"R",(function(){return $})),a.d(t,"S",(function(){return V})),a.d(t,"P",(function(){return U})),a.d(t,"Q",(function(){return H})),a.d(t,"V",(function(){return G})),a.d(t,"U",(function(){return Q})),a.d(t,"q",(function(){return W})),a.d(t,"p",(function(){return K})),a.d(t,"u",(function(){return Y})),a.d(t,"N",(function(){return J})),a.d(t,"v",(function(){return X})),a.d(t,"G",(function(){return Z})),a.d(t,"T",(function(){return ee})),a.d(t,"r",(function(){return te})),a.d(t,"t",(function(){return ae})),a.d(t,"s",(function(){return ne}));var n=a(0);const i=n.i18n.translate("xpack.securitySolution.open.timeline.batchActionsTitle",{defaultMessage:"Bulk actions"}),r=n.i18n.translate("xpack.securitySolution.open.timeline.cancelButton",{defaultMessage:"Cancel"}),s=n.i18n.translate("xpack.securitySolution.open.timeline.collapseButton",{defaultMessage:"Collapse"}),o=n.i18n.translate("xpack.securitySolution.open.timeline.deleteButton",{defaultMessage:"Delete"}),l=n.i18n.translate("xpack.securitySolution.open.timeline.deleteSelectedButton",{defaultMessage:"Delete selected"}),c=n.i18n.translate("xpack.securitySolution.open.timeline.deleteWarningLabel",{defaultMessage:"You will not be able to recover this timeline or its notes once deleted."}),u=n.i18n.translate("xpack.securitySolution.open.timeline.deleteTemplateWarningLabel",{defaultMessage:"You will not be able to recover this timeline template or its notes once deleted."}),d=n.i18n.translate("xpack.securitySolution.open.timeline.descriptionTableHeader",{defaultMessage:"Description"}),p=n.i18n.translate("xpack.securitySolution.open.timeline.expandButton",{defaultMessage:"Expand"}),m=n.i18n.translate("xpack.securitySolution.open.timeline.exportFileNameTitle",{defaultMessage:"timelines_export"}),g=n.i18n.translate("xpack.securitySolution.open.timeline.exportSelectedButton",{defaultMessage:"Export selected"}),b=n.i18n.translate("xpack.securitySolution.open.timeline.favoriteSelectedButton",{defaultMessage:"Favorite selected"}),f=n.i18n.translate("xpack.securitySolution.open.timeline.favoritesTooltip",{defaultMessage:"Favorites"}),y=n.i18n.translate("xpack.securitySolution.open.timeline.lastModifiedTableHeader",{defaultMessage:"Last modified"}),h=n.i18n.translate("xpack.securitySolution.open.timeline.missingSavedObjectIdTooltip",{defaultMessage:"Missing savedObjectId"}),E=n.i18n.translate("xpack.securitySolution.open.timeline.modifiedByTableHeader",{defaultMessage:"Modified by"}),v=n.i18n.translate("xpack.securitySolution.open.timeline.notesTooltip",{defaultMessage:"Notes"}),x=n.i18n.translate("xpack.securitySolution.open.timeline.onlyFavoritesButtonLabel",{defaultMessage:"Only favorites"}),k=n.i18n.translate("xpack.securitySolution.open.timeline.createTemplateFromTimelineTooltip",{defaultMessage:"Create template from timeline"}),S=n.i18n.translate("xpack.securitySolution.open.timeline.createTimelineFromTemplateTooltip",{defaultMessage:"Create timeline from template"}),j=n.i18n.translate("xpack.securitySolution.open.timeline.openAsDuplicateTooltip",{defaultMessage:"Duplicate timeline"}),O=n.i18n.translate("xpack.securitySolution.open.timeline.openAsDuplicateTemplateTooltip",{defaultMessage:"Duplicate template"}),w=n.i18n.translate("xpack.securitySolution.open.timeline.openTimelineButton",{defaultMessage:"Open Timeline…"}),T=n.i18n.translate("xpack.securitySolution.open.timeline.openTimelineTitle",{defaultMessage:"Open"}),I=n.i18n.translate("xpack.securitySolution.open.timeline.pinnedEventsTooltip",{defaultMessage:"Pinned events"}),C=n.i18n.translate("xpack.securitySolution.open.timeline.refreshTitle",{defaultMessage:"Refresh"}),M=n.i18n.translate("xpack.securitySolution.open.timeline.searchPlaceholder",{defaultMessage:"e.g. timeline name, or description"}),F=n.i18n.translate("xpack.securitySolution.open.timeline.searchTemplatePlaceholder",{defaultMessage:"e.g. template name, or description"}),D=n.i18n.translate("xpack.securitySolution.open.timeline.timelineNameTableHeader",{defaultMessage:"Timeline name"}),A=n.i18n.translate("xpack.securitySolution.open.timeline.timelineTemplateNameTableHeader",{defaultMessage:"Template name"}),_=n.i18n.translate("xpack.securitySolution.open.timeline.untitledTimelineLabel",{defaultMessage:"Untitled timeline"}),N=n.i18n.translate("xpack.securitySolution.open.timeline.withLabel",{defaultMessage:"with"}),R=n.i18n.translate("xpack.securitySolution.open.timeline.loadingLabel",{defaultMessage:"Loading..."}),P=n.i18n.translate("xpack.securitySolution.open.timeline.zeroTimelinesMatchLabel",{defaultMessage:"0 timelines match the search criteria"}),L=n.i18n.translate("xpack.securitySolution.open.timeline.zeroTimelineTemplatesMatchLabel",{defaultMessage:"0 timeline templates match the search criteria"}),B=e=>n.i18n.translate("xpack.securitySolution.open.timeline.selectedTemplatesTitle",{values:{selectedTemplates:e},defaultMessage:"Selected {selectedTemplates} {selectedTemplates, plural, =1 {template} other {templates}}"}),q=e=>n.i18n.translate("xpack.securitySolution.open.timeline.selectedTimelinesTitle",{values:{selectedTimelines:e},defaultMessage:"Selected {selectedTimelines} {selectedTimelines, plural, =1 {timeline} other {timelines}}"}),z=n.i18n.translate("xpack.securitySolution.open.timeline.showingLabel",{defaultMessage:"Showing:"}),$=e=>n.i18n.translate("xpack.securitySolution.open.timeline.successfullyExportedTimelinesTitle",{values:{totalTimelines:e},defaultMessage:"Successfully exported {totalTimelines, plural, =0 {all timelines} =1 {{totalTimelines} timeline} other {{totalTimelines} timelines}}"}),V=e=>n.i18n.translate("xpack.securitySolution.open.timeline.successfullyExportedTimelineTemplatesTitle",{values:{totalTimelineTemplates:e},defaultMessage:"Successfully exported {totalTimelineTemplates, plural, =0 {all timelines} =1 {{totalTimelineTemplates} timeline template} other {{totalTimelineTemplates} timeline templates}}"}),U=e=>n.i18n.translate("xpack.securitySolution.open.timeline.successfullyDeletedTimelinesTitle",{values:{totalTimelines:e},defaultMessage:"Successfully deleted {totalTimelines, plural, =0 {all timelines} =1 {{totalTimelines} timeline} other {{totalTimelines} timelines}}"}),H=e=>n.i18n.translate("xpack.securitySolution.open.timeline.successfullyDeletedTimelineTemplatesTitle",{values:{totalTimelineTemplates:e},defaultMessage:"Successfully deleted {totalTimelineTemplates, plural, =0 {all timelines} =1 {{totalTimelineTemplates} timeline template} other {{totalTimelineTemplates} timeline templates}}"}),G=n.i18n.translate("xpack.securitySolution.timelines.components.tabs.timelinesTitle",{defaultMessage:"Timelines"}),Q=n.i18n.translate("xpack.securitySolution.timelines.components.tabs.templatesTitle",{defaultMessage:"Templates"}),W=n.i18n.translate("xpack.securitySolution.timelines.components.templateFilter.elasticTitle",{defaultMessage:"Elastic templates"}),K=n.i18n.translate("xpack.securitySolution.timelines.components.templateFilter.customizedTitle",{defaultMessage:"Custom templates"}),Y=n.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.importTimelineTitle",{defaultMessage:"Import"}),J=n.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.selectTimelineDescription",{defaultMessage:"Select a timeline or timeline template file to import"}),X=n.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.initialPromptTextDescription",{defaultMessage:"Select or drag and drop a valid timelines_export.ndjson file"}),Z=n.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.overwriteDescription",{defaultMessage:"Automatically overwrite saved objects with the same timeline ID"}),ee=e=>n.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.successfullyImportedTimelinesTitle",{values:{totalCount:e},defaultMessage:"Successfully imported {totalCount} {totalCount, plural, =1 {item} other {items}}"}),te=e=>n.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.importFailedTitle",{values:{totalTimelines:e},defaultMessage:"Failed to import {totalTimelines} {totalTimelines, plural, =1 {timeline} other {timelines}}"}),ae=n.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.importTitle",{defaultMessage:"Import…"}),ne=e=>n.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.importFailedDetailedTitle",{values:{message:e},defaultMessage:"{message}"})},function(e,t,a){"use strict";var n=a(189);e.exports=function(e,t,a,i){var r=i?i-1:1/0,s=0;return function(i){return n(i)?(e.enter(a),o(i)):t(i)};function o(i){return n(i)&&s++<r?(e.consume(i),o):(e.exit(a),t(i))}}},,function(e,t,a){"use strict";a.d(t,"a",(function(){return d})),a.d(t,"c",(function(){return p})),a.d(t,"b",(function(){return g}));var n=a(32),i=a(4),r=a.n(i),s=a(90),o=a(211),l=a(554),c=a(556),u=a(555);const d="inspectButtonComponent",p=({children:e,show:t=!0})=>r.a.createElement(o.a,{show:t,targetClassNames:[d]},e),m=({compact:e=!1,inputId:t=s.a.global,inspectIndex:a=0,isDisabled:i,multiple:o=!1,onCloseInspect:p,queryId:m="",showInspectButton:g=!0,title:b=""})=>{const{additionalRequests:f,additionalResponses:y,handleClick:h,handleCloseModal:E,isButtonDisabled:v,isShowingModal:x,loading:k,request:S,response:j}=Object(c.a)({inputId:t,inspectIndex:a,isDisabled:i,multiple:o,onCloseInspect:p,queryId:m});return r.a.createElement(r.a.Fragment,null,t===s.a.timeline&&!e&&g&&r.a.createElement(n.EuiButtonEmpty,{className:d,"aria-label":u.d,"data-test-subj":"inspect-empty-button",color:"text",iconSide:"left",iconType:"inspect",isDisabled:v,isLoading:k,onClick:h},u.d),(t===s.a.global||e)&&g&&r.a.createElement(n.EuiButtonIcon,{className:d,"aria-label":u.d,"data-test-subj":"inspect-icon-button",iconSize:"m",iconType:"inspect",isDisabled:v,title:u.d,onClick:h}),x&&null!==S&&null!==j&&r.a.createElement(l.a,{additionalRequests:f,additionalResponses:y,closeModal:E,"data-test-subj":"inspect-modal",inputId:t,request:S,response:j,title:b}))};m.displayName="InspectButtonComponent";const g=r.a.memo(m)},function(e,t,a){const n=a(307),{MAX_LENGTH:i,MAX_SAFE_INTEGER:r}=a(308),{re:s,t:o}=a(235),l=a(322),{compareIdentifiers:c}=a(391);class SemVer{constructor(e,t){if(t=l(t),e instanceof SemVer){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError(`Invalid Version: ${e}`);if(e.length>i)throw new TypeError(`version is longer than ${i} characters`);n("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const a=e.trim().match(t.loose?s[o.LOOSE]:s[o.FULL]);if(!a)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+a[1],this.minor=+a[2],this.patch=+a[3],this.major>r||this.major<0)throw new TypeError("Invalid major version");if(this.minor>r||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>r||this.patch<0)throw new TypeError("Invalid patch version");a[4]?this.prerelease=a[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<r)return t}return e})):this.prerelease=[],this.build=a[5]?a[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(n("SemVer.compare",this.version,this.options,e),!(e instanceof SemVer)){if("string"==typeof e&&e===this.version)return 0;e=new SemVer(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof SemVer||(e=new SemVer(e,this.options)),c(this.major,e.major)||c(this.minor,e.minor)||c(this.patch,e.patch)}comparePre(e){if(e instanceof SemVer||(e=new SemVer(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const a=this.prerelease[t],i=e.prerelease[t];if(n("prerelease compare",t,a,i),void 0===a&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===a)return-1;if(a!==i)return c(a,i)}while(++t)}compareBuild(e){e instanceof SemVer||(e=new SemVer(e,this.options));let t=0;do{const a=this.build[t],i=e.build[t];if(n("prerelease compare",t,a,i),void 0===a&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===a)return-1;if(a!==i)return c(a,i)}while(++t)}inc(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{let e=this.prerelease.length;for(;--e>=0;)"number"==typeof this.prerelease[e]&&(this.prerelease[e]++,e=-2);-1===e&&this.prerelease.push(0)}t&&(0===c(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error(`invalid increment argument: ${e}`)}return this.format(),this.raw=this.version,this}}e.exports=SemVer},function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(34);const i=e=>Object(n.isString)(e)?e:JSON.stringify(e)},function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return o}));var n=a(34),i=a(4),r=a.n(i);function s(e){var t;const a=t=>{const{deleteQuery:a,id:i,inspect:s=null,loading:l,refetch:c,setQuery:u,searchSessionId:d}=t;o({deleteQuery:a,inspect:s,loading:l,queryId:i,refetch:c,searchSessionId:d,setQuery:u});const p=Object(n.omit)(["refetch","setQuery"],t);return r.a.createElement(e,p)};return a.displayName=`ManageQuery (${null!==(t=null==e?void 0:e.displayName)&&void 0!==t?t:"Unknown"})`,a}const o=({setQuery:e,deleteQuery:t,refetch:a,inspect:n,loading:r,queryId:s,searchSessionId:o})=>{Object(i.useEffect)((()=>{e({id:s,inspect:null!=n?n:null,loading:r,refetch:a,searchSessionId:o})}),[t,e,s,a,n,r,o]),Object(i.useEffect)((()=>()=>{t&&t({id:s})}),[t,s])}},,,function(e,t,a){"use strict";a.d(t,"a",(function(){return y}));var n=a(15),i=a(34),r=a(4),s=a(129),o=a(48),l=a(69),c=a(0);const u=e=>c.i18n.translate("xpack.securitySolution.searchStrategy.error",{values:{factoryQueryType:e},defaultMessage:"Failed to run search: {factoryQueryType}"});var d=a(99),p=a(77),m=a(84),g=a(231),b=a(1);const f={dsl:[],response:[]},y=({factoryQueryType:e,initialResult:t,errorMessage:a,abort:y=!1,showErrorToast:h=!0})=>{const E=Object(r.useRef)(new AbortController),v=Object(r.useRef)(i.noop),{addError:x}=Object(m.a)(),k=(e=>{const{data:t}=Object(p.k)().services,{addWarning:a}=Object(m.a)(),{startTracking:i}=Object(g.a)();return Object(r.useCallback)((({abortSignal:r,request:s})=>{const{endTracking:l}=i({name:`${b.B} searchStrategy ${e}`,spanName:"batched search"}),u=t.search.search({...s,factoryQueryType:e},{strategy:"securitySolutionSearchStrategy",abortSignal:r}).pipe(Object(n.filter)((e=>Object(o.isErrorResponse)(e)||Object(o.isCompleteResponse)(e))));return u.subscribe({next:t=>{Object(o.isErrorResponse)(t)?(a((e=>c.i18n.translate("xpack.securitySolution.searchStrategy.warning",{values:{factoryQueryType:e},defaultMessage:"An error has occurred running search: {factoryQueryType}"}))(e)),l("invalid")):l("success")},error:()=>{l(r.aborted?"aborted":"error")}}),u}),[a,t.search,e,i])})(e),{start:S,error:j,result:O,loading:w}=Object(s.c)(k);Object(r.useEffect)((()=>{!h||null==j||j instanceof l.AbortError||x(j,{title:null!=a?a:u(e)})}),[x,j,a,e,h]);const T=Object(r.useCallback)((e=>{const t=()=>{E.current=new AbortController,S({request:e,abortSignal:E.current.signal})};E.current.abort(),t(),v.current=t}),[S]);Object(r.useEffect)((()=>()=>{E.current.abort()}),[]),Object(r.useEffect)((()=>{y&&E.current.abort()}),[y]);const[I,C]=Object(r.useMemo)((()=>Object(o.isErrorResponse)(O)?[t,f]:[Object(i.omit)("rawResponse",O),Object(d.getInspectResponse)(O,f)]),[O,t]);return{loading:w,result:I,error:j,search:T,refetch:v.current,inspect:C}}},function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return l}));var n=a(80),i=a(103),r=a(502),s=a(244);let o,l;!function(e){e.enable="enable",e.disable="disable",e.export="export",e.delete="delete",e.duplicate="duplicate",e.edit="edit"}(o||(o={})),function(e){e.add_tags="add_tags",e.delete_tags="delete_tags",e.set_tags="set_tags",e.add_index_patterns="add_index_patterns",e.delete_index_patterns="delete_index_patterns",e.set_index_patterns="set_index_patterns",e.set_timeline="set_timeline",e.add_rule_actions="add_rule_actions",e.set_rule_actions="set_rule_actions",e.set_schedule="set_schedule"}(l||(l={}));const c=n.union([n.literal("rule"),Object(i.q)({allowedDurations:[[1,"h"],[1,"d"],[7,"d"]]})]),u=n.type({type:n.union([n.literal(l.add_tags),n.literal(l.delete_tags),n.literal(l.set_tags)]),value:s.z}),d=n.intersection([n.type({type:n.union([n.literal(l.add_index_patterns),n.literal(l.delete_index_patterns),n.literal(l.set_index_patterns)]),value:s.h}),n.exact(n.partial({overwrite_data_views:n.boolean}))]),p=n.type({type:n.literal(l.set_timeline),value:n.type({timeline_id:s.I,timeline_title:s.J})}),m=n.exact(n.type({group:r.f,id:r.g,params:r.h})),g=n.type({type:n.union([n.literal(l.add_rule_actions),n.literal(l.set_rule_actions)]),value:n.type({throttle:c,actions:n.array(m)})}),b=n.type({type:n.literal(l.set_schedule),value:n.type({interval:Object(i.q)({allowedUnits:["s","m","h"]}),lookback:Object(i.q)({allowedUnits:["s","m","h"]})})}),f=n.union([u,d,p,g,b]),y=n.exact(n.type({include_exceptions:n.boolean}));n.intersection([n.exact(n.type({query:n.union([s.w,n[void 0]])})),n.exact(n.partial({ids:Object(i.j)(n.string)})),n.union([n.exact(n.type({action:n.union([n.literal(o.delete),n.literal(o.disable),n.literal(o.enable),n.literal(o.export)])})),n.intersection([n.exact(n.type({action:n.literal(o.duplicate)})),n.exact(n.partial({[o.duplicate]:y}))]),n.exact(n.type({action:n.literal(o.edit),[o.edit]:Object(i.j)(f)}))])]),n.exact(n.partial({dry_run:n.union([n.literal("true"),n.literal("false")])}))},,function(e,t,a){"use strict";a.d(t,"a",(function(){return T})),a.d(t,"c",(function(){return C})),a.d(t,"b",(function(){return A}));var n=a(82),i=a.n(n),r=a(32),s=a(83),o=a(4),l=a.n(o),c=a(57),u=a(78),d=a(33),p=a.n(d),m=a(104),g=a(395),b=a(241),f=a(203),y=a(552),h=a(102),E=a(604),v=a(605),x=a(77),k=a(38),S=a(585),j=a(594),O=a(462);const w=({dataProvider:e,isAggregatable:t,fieldType:a,hideTopN:n,isDraggable:i,onFilterAdded:r,render:s,scopeId:c})=>{const{timelineId:u}=Object(o.useContext)(S.b),{tableId:d}=Object(o.useContext)(k.TableContext),p=Object(o.useRef)(null),m=Object(o.useRef)(null),[g,b]=Object(o.useState)(!1),[f,y]=Object(o.useState)(!1),E=Object(o.useMemo)((()=>c||(null!=u?u:d)),[c,d,u]),v=Object(o.useCallback)((()=>{b((e=>!e)),y((e=>(e&&setTimeout((()=>{var e;null===(e=m.current)||void 0===e||e.focus()}),0),!1))),setTimeout((()=>{y(!1)}),0)}),[m]),{closeTopN:x,toggleTopN:w,isShowingTopN:T}=Object(O.b)(v),I=Object(o.useMemo)((()=>{const t=e.queryMatch.value;return"number"==typeof t?t.toString():Array.isArray(t)?t.map((e=>String(e))):t}),[e.queryMatch.value]),M=Object(o.useMemo)((()=>{const o=f&&!T&&(null!==(u=null==(c=p.current)?void 0:c.querySelectorAll(".euiLink"))&&void 0!==u?u:[]).length>0?l.a.createElement(C,{"data-test-subj":`draggable-link-content-${e.queryMatch.field}`},s(e,null,{isDragging:!1,isDropAnimating:!1})):null;var c,u;return l.a.createElement(j.a,{additionalContent:o,closeTopN:x,closePopOver:v,dataProvider:e,draggableId:i?Object(h.k)(e.id):void 0,field:e.queryMatch.field,isAggregatable:t,fieldType:a,hideTopN:n,isObjectArray:!1,onFilterAdded:r,ownFocus:f,showOwnFocus:!1,showTopN:T,scopeId:E,toggleTopN:w,values:I})}),[f,T,e,s,x,v,i,t,a,n,r,E,w,I]),F=Object(o.useCallback)((e=>{p.current=e}),[]),D=Object(o.useCallback)((()=>{var e;f||null===(e=m.current)||void 0===e||e.focus()}),[f,m]),A=Object(o.useCallback)((()=>{x(),f&&(y(!1),setTimeout((()=>{D()}),0))}),[D,f,x]),_=Object(o.useCallback)((()=>{y(!0)}),[]);return Object(o.useMemo)((()=>({closePopOverTrigger:g,handleClosePopOverTrigger:v,hoverActionsOwnFocus:f,hoverContent:M,keyboardHandlerRef:m,onCloseRequested:A,onFocus:D,openPopover:_,setContainerRef:F,isShowingTopN:T})),[g,v,f,M,A,D,_,F,T])},T=p.a.div.withConfig({displayName:"DragEffects",componentId:"sc-m7vcsn-0"})([""]);T.displayName="DragEffects";class draggable_wrapper_DragDropErrorBoundary extends l.a.PureComponent{componentDidCatch(){this.forceUpdate()}render(){return this.props.children}}const I=p.a.div.withConfig({displayName:"Wrapper",componentId:"sc-m7vcsn-1"})(["display:inline-block;max-width:100%;[data-rbd-placeholder-context-id]{display:none !important;}",""],(({disabled:e})=>e&&"\n    [data-rbd-draggable-id]:hover,\n    .euiBadge:hover,\n    .euiBadge__text:hover {\n      cursor: default;\n    }\n  "));I.displayName="Wrapper";const C=p.a.span.withConfig({displayName:"ProviderContentWrapper",componentId:"sc-m7vcsn-2"})(["> span.euiToolTipAnchor{display:block;}> span.euiToolTipAnchor.eui-textTruncate{display:inline-block;}"]),M=(e,t)=>t.isDropAnimating?{...e,transitionDuration:"0.00000001s"}:e,F=({dataProvider:e,hideTopN:t=!1,onFilterAdded:a,render:n,fieldType:d="",isAggregatable:p=!1,scopeId:m,truncate:k})=>{const[S,j]=Object(o.useState)(!1),O=e.id.includes(`-${b.a}-`),T=Object(u.useDispatch)(),{timelines:F}=Object(x.k)().services,{closePopOverTrigger:D,handleClosePopOverTrigger:A,hoverActionsOwnFocus:N,hoverContent:R,keyboardHandlerRef:P,onCloseRequested:L,openPopover:B,onFocus:q,setContainerRef:z,isShowingTopN:$}=w({dataProvider:e,hideTopN:t,onFilterAdded:a,render:n,fieldType:d,isAggregatable:p,scopeId:m,truncate:k}),V=Object(o.useCallback)((()=>{O||(T(g.a.registerProvider({provider:e})),j(!0))}),[O,T,e]),U=Object(o.useCallback)((()=>S&&T(g.a.unRegisterProvider({id:e.id}))),[S,T,e.id]);Object(o.useEffect)((()=>()=>{U()}),[U]);const H=Object(o.useCallback)(((t,a)=>l.a.createElement(_,{registerProvider:V},l.a.createElement("div",i()({},t.draggableProps,t.dragHandleProps,{style:M(t.draggableProps.style,a),ref:t.innerRef,"data-test-subj":"providerContainer",tabIndex:-1}),l.a.createElement(C,{"data-test-subj":`draggable-content-${e.queryMatch.field}`},n(e,t,a))))),[e,V,n]),G=Object(o.useCallback)(((t,a)=>l.a.createElement(E.a,i()({},t.draggableProps,t.dragHandleProps,{ref:e=>{t.innerRef(e),z(e)},"data-test-subj":"providerContainer",isDragging:a.isDragging,registerProvider:V,tabIndex:-1}),l.a.createElement(r.EuiScreenReaderOnly,{"data-test-subj":"screenReaderOnlyField"},l.a.createElement("p",null,e.queryMatch.field)),k&&!a.isDragging?l.a.createElement(f.b,{"data-test-subj":"draggable-truncatable-content"},n(e,t,a)):l.a.createElement(C,{"data-test-subj":`draggable-content-${e.queryMatch.field}`},n(e,t,a)),!a.isDragging&&l.a.createElement(r.EuiScreenReaderOnly,{"data-test-subj":"draggableKeyboardInstructionsNotDragging"},l.a.createElement("p",null,v.b)))),[e,V,n,z,k]),{onBlur:Q,onKeyDown:W}=F.getUseDraggableKeyboardWrapper()({closePopover:A,draggableId:Object(h.k)(e.id),fieldName:e.queryMatch.field,keyboardHandlerRef:P,openPopover:B}),K=Object(o.useCallback)((t=>l.a.createElement("div",i()({ref:t.innerRef},t.droppableProps),l.a.createElement("div",{className:s.a,"data-test-subj":"draggableWrapperKeyboardHandler",onClick:q,onBlur:Q,onKeyDown:W,ref:P,role:"button",tabIndex:0},l.a.createElement(c.Draggable,{draggableId:Object(h.k)(e.id),index:0,key:Object(h.k)(e.id),isDragDisabled:O},G)),t.placeholder)),[G,e.id,O,P,Q,q,W]),Y=Object(o.useMemo)((()=>l.a.createElement(I,{"data-test-subj":"draggableWrapperDiv",disabled:O},l.a.createElement(draggable_wrapper_DragDropErrorBoundary,null,l.a.createElement(c.Droppable,{isDropDisabled:!0,droppableId:Object(h.l)(e.id),renderClone:H},K)))),[K,H,e.id,O]),J=Object(o.useCallback)((()=>Y),[Y]);return O?l.a.createElement(l.a.Fragment,null,Y):l.a.createElement(y.a,{alwaysShow:$||N,closePopOverTrigger:D,hoverContent:R,onCloseRequested:L,render:J})},D=({dataProvider:e,hideTopN:t=!1,isDraggable:a=!1,onFilterAdded:n,render:i,isAggregatable:r=!1,fieldType:s="",scopeId:c,truncate:u})=>{const{closePopOverTrigger:d,hoverActionsOwnFocus:p,hoverContent:g,onCloseRequested:E,setContainerRef:v,isShowingTopN:x}=w({dataProvider:e,hideTopN:t,isDraggable:a,isAggregatable:r,fieldType:s,onFilterAdded:n,render:i,scopeId:c,truncate:u}),k=Object(o.useCallback)((()=>l.a.createElement("div",{ref:e=>{v(e)},tabIndex:-1,"data-provider-id":Object(h.k)(e.id)},u?l.a.createElement(f.b,{"data-test-subj":"render-truncatable-content"},i(e,null,{isDragging:!1,isDropAnimating:!1})):l.a.createElement(C,{"data-test-subj":`render-content-${e.queryMatch.field}`},i(e,null,{isDragging:!1,isDropAnimating:!1})))),[e,i,v,u]);return a?l.a.createElement(F,{dataProvider:e,hideTopN:t,onFilterAdded:n,fieldType:s,isAggregatable:r,render:i,scopeId:c,truncate:u}):l.a.createElement(y.a,{alwaysShow:x||p,closePopOverTrigger:d,hoverContent:(S=c,[m.c.rulePreview,b.a].includes(null!=S?S:"")?void 0:g),onCloseRequested:E,render:k});var S},A=l.a.memo(D);A.displayName="DraggableWrapper";const _=l.a.memo((({children:e,registerProvider:t})=>(Object(o.useEffect)((()=>{t()}),[t]),l.a.createElement(l.a.Fragment,null,e))));_.displayName="ConditionalPortal"},function(e,t,a){"use strict";let n,i;a.r(t),a.d(t,"HostsType",(function(){return n})),a.d(t,"HostsTableType",(function(){return i})),function(e){e.page="page",e.details="details"}(n||(n={})),function(e){e.authentications="authentications",e.hosts="allHosts",e.events="events",e.uncommonProcesses="uncommonProcesses",e.anomalies="anomalies",e.risk="hostRisk",e.sessions="sessions"}(i||(i={}))},,function(e,t,a){"use strict";a.d(t,"a",(function(){return j})),a.d(t,"e",(function(){return O})),a.d(t,"d",(function(){return w})),a.d(t,"f",(function(){return T})),a.d(t,"g",(function(){return C})),a.d(t,"c",(function(){return $})),a.d(t,"h",(function(){return V})),a.d(t,"b",(function(){return U}));var n=a(528),i=a(34),r=a(117),s=a.n(r),o=a(252),l=a.n(o),c=a(90),u=a(79),d=a(402),p=a(143),m=a(12),g=a(112),b=a(158),f=a(159),y=a(549),h=a(106),E=a(526),v=a(177),x=a(95),k=a(381),S=a(227);const j="open-timeline",O=({pinnedEventIds:e})=>null!=e?Object.keys(e).length:0,w=({eventIdToNoteIds:e,noteIds:t})=>(null!=e?Object.keys(e).reduce(((t,a)=>t+e[a].length),0):0)+(null!=t?t.length:0),T=({title:e})=>null==e||0===e.trim().length,I=(e,t)=>"__typename"===e?void 0:t,C=e=>JSON.parse(JSON.stringify(e),I),M=e=>{try{return JSON.parse(e)}catch{return e}},F=e=>Object.entries(e).reduce(((e,[t,a])=>"id"!==t&&null!=a?{...e,[t]:a}:e),{columnHeaderType:b.a,id:null!=e.id?e.id:"unknown",initialWidth:"@timestamp"===e.id?f.b:f.a}),D=e=>({$state:{store:"appState"},meta:{...e.meta,...e.meta&&null!=e.meta.field?{params:M(e.meta.field)}:{},...e.meta&&null!=e.meta.params?{params:M(e.meta.params)}:{},...e.meta&&null!=e.meta.value?{value:M(e.meta.value)}:{}},...null!=e.exists?{exists:M(e.exists)}:{},...null!=e.match_all?{exists:M(e.match_all)}:{},...null!=e.missing?{exists:M(e.missing)}:{},...null!=e.query?{query:M(e.query)}:{},...null!=e.range?{range:M(e.range)}:{},...null!=e.script?{exists:M(e.script)}:{}}),A=(e,t)=>e?{}:null!=t?t.reduce(((e,t)=>{if(null!=t.eventId){const a=Object(i.getOr)([],t.eventId,e);return{...e,[t.eventId]:[...a,t.noteId]}}return e}),{}):{},_=(e,t)=>e?{}:null!=t?t.reduce(((e,t)=>({...e,...null!=t.eventId?{[t.eventId]:t}:{}})),{}):{},N=(e,t)=>e?{}:null!=t?t.reduce(((e,t)=>({...e,[t]:!0})),{}):{},R=(e,t,a)=>a===u.n.default&&e.timelineType===u.n.template?e.templateTimelineId:t&&e.timelineType===u.n.template?s.a.v4():e.templateTimelineId,P=({and:e,...t})=>t.type===u.a.template?l()(t,{type:u.a.default,enabled:t.queryMatch.operator!==h.d,queryMatch:{value:t.queryMatch.operator===h.d?"":t.queryMatch.value}}):t,L=(e,t,a)=>e&&t&&a===u.n.default?t.map((e=>{var t,a;return{...P(e),and:null!==(t=null===(a=e.and)||void 0===a?void 0:a.map(P))&&void 0!==t?t:[]}})):t,B=(e,t,a)=>a&&e.timelineType!==a?"":t?`${e.title} - Duplicate`:e.title||"",q=(e,t,a)=>a&&e.timelineType!==a?u.l.draft:t?u.l.active:e.status,z=(e,t,a)=>{const i=e.timelineType===u.n.template,r={...e,columns:null!=e.columns?e.columns.map(F):b.b,defaultColumns:b.b,dateRange:e.status===u.l.immutable&&e.timelineType===u.n.template?{start:k.a.toISOString(),end:k.b.toISOString()}:e.dateRange,dataProviders:L(t,e.dataProviders,a),eventIdToNoteIds:A(t,e.eventIdToNoteIds),filters:null!=e.filters?e.filters.map(D):[],isFavorite:!t&&null!=e.favorite&&e.favorite.length>0,noteIds:t?[]:null!=e.noteIds?e.noteIds:[],pinnedEventIds:N(t,e.pinnedEventIds),pinnedEventsSaveObject:_(t,e.pinnedEventsSaveObject),id:t?"":e.savedObjectId,status:q(e,t,a),savedObjectId:t?null:e.savedObjectId,version:t?null:e.version,timelineType:null!=a?a:e.timelineType,title:B(e,t,a),templateTimelineId:R(e,t,a),templateTimelineVersion:t&&i?1:e.templateTimelineVersion};return Object.entries(r).reduce(((e,[t,a])=>null!=a?Object(n.set)(t,a,e):e),{...g.b,id:""})},$=(e,t=!1,a)=>{const{notes:n,...i}=e;return{notes:n,timeline:z(i,t,a)}},V=({activeTimelineTab:e=u.m.query,duplicate:t=!1,graphEventId:a="",timelineId:n,timelineType:r,onError:s,onOpenTimeline:o,openTimeline:l=!0,updateIsLoading:c,updateTimeline:d})=>{c({id:u.j.active,isLoading:!0}),Promise.resolve(Object(S.i)(n)).then((n=>{const s=Object(i.getOr)(null,"data",n);if(!s)return;const c=C(s.timeline),{timeline:p,notes:m}=$(c,t,r);if(null!=o)o(p);else if(d){const{from:n,to:r}=Object(E.a)({from:Object(i.getOr)(null,"dateRange.start",p),to:Object(i.getOr)(null,"dateRange.end",p)});d({duplicate:t,from:n,id:u.j.active,notes:m,resolveTimelineConfig:{outcome:s.outcome,alias_target_id:s.alias_target_id,alias_purpose:s.alias_purpose},timeline:{...p,activeTab:e,graphEventId:a,show:l,dateRange:{start:n,end:r}},to:r})()}})).catch((e=>{null!=s&&s(e,n)})).finally((()=>{c({id:u.j.active,isLoading:!1})}))},U=e=>({duplicate:t,id:a,forceNotes:n=!1,from:r,notes:s,resolveTimelineConfig:o,timeline:l,to:g,ruleNote:b})=>()=>{var f;if(Object(i.isEmpty)(l.indexNames)||e(v.a.setSelectedDataView({id:x.SourcererScopeName.timeline,selectedDataViewId:l.dataViewId,selectedPatterns:l.indexNames})),l.status===u.l.immutable&&l.timelineType===u.n.template?e(Object(p.setRelativeRangeDatePicker)({id:c.a.timeline,fromStr:"now-24h",toStr:"now",from:k.a.toISOString(),to:k.b.toISOString()})):e(Object(p.setTimelineRangeDatePicker)({from:r,to:g})),e(Object(m.addTimeline)({id:a,timeline:l,resolveTimelineConfig:o,savedTimeline:t})),null!=l.kqlQuery&&null!=l.kqlQuery.filterQuery&&null!=l.kqlQuery.filterQuery.kuery&&""!==l.kqlQuery.filterQuery.kuery.expression&&e(Object(m.applyKqlFilterQuery)({id:a,filterQuery:{kuery:{kind:null!==(f=l.kqlQuery.filterQuery.kuery.kind)&&void 0!==f?f:"kuery",expression:l.kqlQuery.filterQuery.kuery.expression||""},serializedQuery:l.kqlQuery.filterQuery.serializedQuery||""}})),t&&null!=b&&!Object(i.isEmpty)(b)){const t=Object(y.a)({newNote:b});e(Object(d.updateNote)({note:t})),e(Object(m.addNote)({noteId:t.id,id:a}))}t&&!n||e(Object(d.addNotes)({notes:null!=s?s.map((e=>{var t,a;return{created:null!=e.created?new Date(e.created):new Date,id:e.noteId,lastEdit:null!=e.updated?new Date(e.updated):new Date,note:e.note||"",user:e.updatedBy||"unknown",saveObjectId:e.noteId,version:e.version,eventId:null!==(t=e.eventId)&&void 0!==t?t:null,timelineId:null!==(a=e.timelineId)&&void 0!==a?a:null}})):[]}))}},function(e,t,a){"use strict";let n,i,r;a.r(t),a.d(t,"UsersType",(function(){return n})),a.d(t,"UsersTableType",(function(){return i})),a.d(t,"UsersDetailsTableType",(function(){return r})),function(e){e.page="page",e.details="details"}(n||(n={})),function(e){e.allUsers="allUsers",e.authentications="authentications",e.anomalies="anomalies",e.risk="userRisk",e.events="events"}(i||(i={})),function(e){e.authentications="authentications",e.anomalies="anomalies",e.risk="userRisk",e.events="events"}(r||(r={}))},function(e,t,a){"use strict";a.d(t,"d",(function(){return h})),a.d(t,"n",(function(){return E})),a.d(t,"k",(function(){return v})),a.d(t,"m",(function(){return x})),a.d(t,"f",(function(){return k})),a.d(t,"e",(function(){return S})),a.d(t,"l",(function(){return j})),a.d(t,"b",(function(){return O})),a.d(t,"c",(function(){return w})),a.d(t,"j",(function(){return T})),a.d(t,"g",(function(){return I})),a.d(t,"i",(function(){return C})),a.d(t,"h",(function(){return M})),a.d(t,"a",(function(){return F}));var n=a(7),i=a(1),r=a(80),s=a(103);r.exact(r.type({rules_custom_installed:s.n,rules_installed:s.n,rules_not_installed:s.n,rules_not_updated:s.n,timelines_installed:s.n,timelines_not_installed:s.n,timelines_not_updated:s.n})),r.exact(r.type({rules_installed:s.n,rules_updated:s.n,timelines_installed:s.n,timelines_updated:s.n}));var o=a(407),l=a(244);r.intersection([l.c,l.N,r.exact(r.type({rule_id:l.y,version:l.A})),r.exact(r.partial({related_integrations:l.m,required_fields:l.n,setup:l.E}))]);var c=a(93);r.exact(r.type({id:l.v})),r.exact(r.type({items:r.array(c.i)})),r.intersection([r.exact(r.type({namespace_types:c.a})),r.exact(r.partial({ids:s.l,list_ids:s.l}))]);const u=r.exact(r.type({name:l.t,id:l.v,rule_id:l.y,exception_lists:c.x})),d=r.intersection([c.o,r.exact(r.type({referenced_rules:r.array(u)}))]),p=r.record(c.A,d),m=(r.exact(r.type({references:r.array(p)})),`${i.Jb}/rules`),g=(i.pb,`${m}/exceptions/_find_references`);var b=a(131),f=a(77),y=(a(113),a(814));const h=async({rule:e,signal:t})=>f.b.get().http.fetch(i.pb,{method:"POST",body:JSON.stringify(e),signal:t}),E=async({rule:e,signal:t})=>f.b.get().http.fetch(i.pb,{method:"PUT",body:JSON.stringify(e),signal:t}),v=async({ruleProperties:e,signal:t})=>f.b.get().http.fetch(i.pb,{method:"PATCH",body:JSON.stringify(e),signal:t}),x=async({rule:e,signal:t})=>f.b.get().http.fetch(i.ob,{method:"POST",body:JSON.stringify(e),signal:t}),k=async({filterOptions:e={filter:"",showCustomRules:!1,showElasticRules:!1,tags:[]},sortingOptions:t={field:"enabled",order:"desc"},pagination:a={page:1,perPage:20},signal:r})=>{const s=Object(y.a)(e),o={page:a.page,per_page:a.perPage,sort_field:(l=t.field,"name"===l?`${l}.keyword`:Object(n.camelCase)(l)),sort_order:t.order,...""!==s?{filter:s}:{}};var l;return f.b.get().http.fetch(i.qb,{method:"GET",query:o,signal:r})},S=async({id:e,signal:t})=>f.b.get().http.fetch(i.pb,{method:"GET",query:{id:e},signal:t});async function j({bulkAction:e,dryRun:t=!1}){const a={action:e.type,query:e.query,ids:e.ids,edit:e.type===b.b.edit?e.editPayload:void 0,duplicate:e.type===b.b.duplicate?e.duplicatePayload:void 0};return f.b.get().http.fetch(i.nb,{method:"POST",body:JSON.stringify(a),query:{dry_run:t}})}async function O(e){const t={action:b.b.export,query:e.query,ids:e.ids};return f.b.get().http.fetch(i.nb,{method:"POST",body:JSON.stringify(t)})}const w=async()=>await f.b.get().http.fetch(o.b,{method:"PUT"}),T=async({fileToImport:e,overwrite:t=!1,overwriteExceptions:a=!1,signal:n})=>{const r=new FormData;return r.append("file",e),f.b.get().http.fetch(`${i.pb}/_import`,{method:"POST",headers:{"Content-Type":void 0},query:{overwrite:t,overwrite_exceptions:a},body:r,signal:n})},I=async({signal:e})=>f.b.get().http.fetch(i.sb,{method:"GET",signal:e}),C=async({signal:e})=>f.b.get().http.fetch(o.a,{method:"GET",signal:e}),M=async({lists:e,signal:t})=>{const a=e.some((({id:e})=>void 0===e))?{namespace_types:e.map((({namespaceType:e})=>e)).join(",")}:{ids:e.map((({id:e})=>e)).join(","),list_ids:e.map((({listId:e})=>e)).join(","),namespace_types:e.map((({namespaceType:e})=>e)).join(",")};return f.b.get().http.fetch(g,{method:"GET",query:a,signal:t})},F=async({ruleId:e,items:t,signal:a})=>f.b.get().http.fetch(`${i.pb}/${e}/exceptions`,{method:"POST",body:JSON.stringify({items:t}),signal:a})},function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"d",(function(){return r})),a.d(t,"a",(function(){return s})),a.d(t,"c",(function(){return o}));var n=a(110);const i="policy:",r=`${i}all`,s=[n.m,n.e,n.h,n.b],o=["name","description","entries.value","entries.entries.value","item_id"]},,,,,function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"d",(function(){return r})),a.d(t,"e",(function(){return s})),a.d(t,"a",(function(){return o})),a.d(t,"c",(function(){return l}));var n=a(276);function i(e){return null!=e&&e.id?String(Object(n.a)(e.id)):void 0}function r(e){return null!=e&&e.parent?String(Object(n.a)(null==e?void 0:e.parent)):void 0}function s(e){const t=o(e);if(void 0===t)return;const a=new Date(t);return isFinite(a.getTime())?a:void 0}function o(e){return Object(n.a)(null==e?void 0:e.data["@timestamp"])}function l(e){return null!=e&&e.name?String(Object(n.a)(e.name)):void 0}},,,,,function(e,t,a){"use strict";a.d(t,"g",(function(){return u})),a.d(t,"a",(function(){return d})),a.d(t,"e",(function(){return p})),a.d(t,"i",(function(){return m})),a.d(t,"b",(function(){return g})),a.d(t,"c",(function(){return b})),a.d(t,"j",(function(){return f})),a.d(t,"d",(function(){return y})),a.d(t,"h",(function(){return h})),a.d(t,"f",(function(){return E}));var n=a(7),i=a(108),r=a(90);const s=e=>e.policy,o=e=>e.timerange,l=e=>e.queries,c=(e,t)=>{const a=e.inputs[t];return Object(n.isEmpty)(a.linkTo)?a.queries:a.linkTo.reduce(((t,a)=>{if(a===r.a.socTrends)return t;const n=e.inputs[a];return[...t,...n.queries]}),a.queries)},u=()=>Object(i.createSelector)(s,(e=>e.kind)),d=()=>Object(i.createSelector)(s,(e=>e.duration)),p=()=>Object(i.createSelector)(o,(e=>e.kind)),m=()=>Object(i.createSelector)(o,(e=>e.from)),g=()=>Object(i.createSelector)(o,(e=>e.to)),b=()=>Object(i.createSelector)(o,(e=>e.fromStr)),f=()=>Object(i.createSelector)(o,(e=>e.toStr)),y=()=>Object(i.createSelector)(l,(e=>e.some((e=>!0===e.loading)))),h=()=>Object(i.createSelector)(c,(e=>e.filter((e=>"kql"!==e.id)))),E=()=>Object(i.createSelector)(l,(e=>e.find((e=>"kql"===e.id))))},function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(34),i=a(4),r=a.n(i),s=a(106),o=a(916);const l=r.a.memo((({dataProvider:e})=>{var t;const[a,l]=Object(i.useState)(!1);return r.a.createElement(o.a,{deleteProvider:n.noop,field:e.queryMatch.displayField||e.queryMatch.field,kqlQuery:e.kqlQuery,isEnabled:e.enabled,isExcluded:e.excluded,providerId:e.id,isPopoverOpen:a,setIsPopoverOpen:l,toggleExcludedProvider:n.noop,toggleEnabledProvider:n.noop,toggleTypeProvider:n.noop,displayValue:String(null!==(t=e.queryMatch.displayValue)&&void 0!==t?t:e.queryMatch.value),val:e.queryMatch.value,operator:e.queryMatch.operator||s.d,type:e.type||s.a.default})}));l.displayName="Provider"},function(e,t,a){"use strict";a.d(t,"i",(function(){return i})),a.d(t,"m",(function(){return r})),a.d(t,"g",(function(){return s})),a.d(t,"o",(function(){return o})),a.d(t,"k",(function(){return l})),a.d(t,"j",(function(){return c})),a.d(t,"a",(function(){return u})),a.d(t,"n",(function(){return d})),a.d(t,"l",(function(){return p})),a.d(t,"e",(function(){return m})),a.d(t,"p",(function(){return g})),a.d(t,"c",(function(){return b})),a.d(t,"b",(function(){return f})),a.d(t,"d",(function(){return y})),a.d(t,"h",(function(){return h})),a.d(t,"f",(function(){return E}));var n=a(276);function i(e){return"endgame"in e&&void 0!==e.endgame}function r(e){return Object(n.a)(null==e?void 0:e["@timestamp"])}function s(e){return Object(n.a)(e["@timestamp"])}function o(e){var t;if(!i(e))return Object(n.a)(null===(t=e.user)||void 0===t?void 0:t.name)}function l(e){var t,a;return Object(n.a)(i(e)?e.endgame.ppid:null===(t=e.process)||void 0===t||null===(a=t.parent)||void 0===a?void 0:a.pid)}function c(e){var t,a;return Object(n.a)(i(e)||null===(t=e.process)||void 0===t||null===(a=t.hash)||void 0===a?void 0:a.md5)}function u(e){var t;if(!i(e))return Object(n.c)(null===(t=e.process)||void 0===t?void 0:t.args)}function d(e){var t;if(!i(e))return Object(n.a)(null===(t=e.user)||void 0===t?void 0:t.domain)}function p(e){return i(e)?Object(n.a)(e.endgame.process_name):Object(n.a)(null===(t=e.process)||void 0===t?void 0:t.name);var t}function m(e){var t,a;return i(e)?Object(n.a)(null===(t=e.endgame)||void 0===t?void 0:t.serial_event_id):Object(n.a)(null===(a=e.event)||void 0===a?void 0:a.id)}function g(e){var t;return Object(n.a)(null===(t=e.winlog)||void 0===t?void 0:t.record_id)}function b(e){var t;return i(e)?e.endgame.unique_pid?String(e.endgame.unique_pid):"":Object(n.a)(null===(t=e.process)||void 0===t?void 0:t.entity_id)}function f(e){var t,a;return i(e)?void 0===(null===(t=e.endgame)||void 0===t?void 0:t.unique_pid)?void 0:String(Object(n.a)(e.endgame.unique_pid)):Object(n.a)(null===(a=e.process)||void 0===a?void 0:a.entity_id)}function y(e){var t;return Object(n.c)(i(e)?e.endgame.event_type_full:null===(t=e.event)||void 0===t?void 0:t.category)}function h(e){var t;return Object(n.c)(i(e)?e.endgame.event_subtype_full:null===(t=e.event)||void 0===t?void 0:t.type)}function E(e){return i(e)?[]:Object(n.c)(null===(t=e.event)||void 0===t?void 0:t.kind);var t}},function(e,t,a){const n=a(125);e.exports=(e,t,a)=>new n(e,a).compare(new n(t,a))},function(e,t,a){"use strict";a.d(t,"e",(function(){return g})),a.d(t,"d",(function(){return b})),a.d(t,"h",(function(){return f})),a.d(t,"j",(function(){return y})),a.d(t,"n",(function(){return h})),a.d(t,"l",(function(){return E})),a.d(t,"a",(function(){return O})),a.d(t,"o",(function(){return w})),a.d(t,"b",(function(){return T})),a.d(t,"k",(function(){return I})),a.d(t,"f",(function(){return C})),a.d(t,"g",(function(){return M})),a.d(t,"m",(function(){return F})),a.d(t,"c",(function(){return D})),a.d(t,"i",(function(){return A}));var n=a(34),i=a(271),r=a.n(i),s=a(37),o=a(209),l=a(405),c=a(522),u=a(105);const d=(e,t)=>void 0===e||e===t||0===e,p=(e,t={})=>`${e}${Object(o.a)(r.a.stringify(((e={})=>({...d(e.page,1)?{}:{page:e.page},...d(e.pageSize,u.c)?{}:{pageSize:e.pageSize},...d(e.show,void 0)?{}:{show:e.show},...d(e.itemId,void 0)?{}:{itemId:e.itemId},...d(e.filter,"")?"":{filter:e.filter},...d(e.includedPolicies,"")?"":{includedPolicies:e.includedPolicies}}))(t)))}`,m=e=>r.a.stringify(e),g=(e,t)=>{const{name:a,...i}=e,r=m(i),l=`${r&&!Object(n.isEmpty)(t)?"&":""}${null!=t?t:""}`;return"endpointList"===a?`${Object(s.generatePath)(u.h,{tabName:c.a.endpoints})}${Object(o.a)(`${r?`${r}${l}`:l}`)}`:`${Object(o.a)(`${r?`${r}${l}`:l}`)}`},b=(e,t)=>{const{name:a,show:i,...r}=e,l={...r};switch(e.name){case"endpointDetails":l.show="details";break;case"endpointIsolate":l.show="isolate";break;case"endpointUnIsolate":l.show="unisolate";break;case"endpointPolicyResponse":l.show="policy_response";break;case"endpointActivityLog":l.show="activity_log"}const d=m(l),p=`${d&&!Object(n.isEmpty)(t)?"&":""}${null!=t?t:""}`;return`${Object(s.generatePath)(u.h,{tabName:c.a.endpoints})}${Object(o.a)(`${d?`${d}${p}`:p}`)}`},f=e=>`${Object(s.generatePath)(u.k,{tabName:c.a.policies})}${Object(o.a)(e)}`,y=(e,t)=>`${Object(s.generatePath)(u.n,{tabName:c.a.policies,policyId:e})}${Object(o.a)(t)}`,h=(e,t)=>`${Object(s.generatePath)(u.q,{tabName:c.a.policies,policyId:e})}${Object(o.a)(t)}`,E=(e,t)=>`${Object(s.generatePath)(u.m,{tabName:c.a.policies,policyId:e})}${Object(o.a)(r.a.stringify(v(t)))}`,v=e=>e?{...d(e.page,u.b+1)?{}:{page:e.page},...d(e.pageSize,u.c)?{}:{pageSize:e.pageSize},...d(e.show,void 0)?{}:{show:e.show},...d(e.filter,"")?"":{filter:e.filter}}:{},x=(e,t)=>{const a=e[t];return Array.isArray(a)?a[a.length-1]:a},k=e=>{const t=Number(x(e,"page_index"));return!Number.isFinite(t)||t<0?u.b:t},S=e=>{const t=Number(x(e,"page_size"));return u.f.includes(t)?t:u.c},j=e=>x(e,"filter")||"",O=e=>({page_index:k(e),page_size:S(e),filter:j(e)}),w=e=>{const t=Object(s.generatePath)(u.s,{tabName:c.a.trustedApps});return p(t,e)},T=e=>{const t=x(e,"show"),a=Object(l.a)(e);return{page:a.page,pageSize:a.pageSize,filter:e.filter,show:t&&"list"===t?t:void 0}},I=(e,t)=>`${Object(s.generatePath)(u.q,{tabName:c.a.policies,policyId:e})}${Object(o.a)(r.a.stringify(v(t)))}`,C=e=>`${Object(s.generatePath)(u.i,{tabName:c.a.eventFilters})}${Object(o.a)(r.a.stringify((e=>e?{...d(e.page_index,u.b)?{}:{page_index:e.page_index},...d(e.page_size,u.c)?{}:{page_size:e.page_size},...d(e.show,void 0)?{}:{show:e.show},...d(e.id,void 0)?{}:{id:e.id},...d(e.filter,"")?"":{filter:e.filter},...d(e.included_policies,"")?"":{included_policies:e.included_policies}}:{})(e)))}`,M=e=>{const t=Object(s.generatePath)(u.j,{tabName:c.a.hostIsolationExceptions});return p(t,e)},F=(e,t)=>`${Object(s.generatePath)(u.o,{tabName:c.a.policies,policyId:e})}${Object(o.a)(r.a.stringify(v(t)))}`,D=e=>{const t=Object(s.generatePath)(u.g,{tabName:c.a.blocklist});return p(t,e)},A=(e,t)=>`${Object(s.generatePath)(u.l,{tabName:c.a.policies,policyId:e})}${Object(o.a)(r.a.stringify(v(t)))}`},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(4),i=a(77);const r={managed:!0},s=()=>{const{services:{apm:e}}=Object(i.k)();return{startTransaction:Object(n.useCallback)((({name:t,type:a="user-interaction",options:n})=>e.startTransaction(t,a,null!=n?n:r)),[e])}}},,,function(e,t,a){"use strict";a.d(t,"c",(function(){return s})),a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return l})),a.d(t,"d",(function(){return c}));const n=["started","opened"],i=["starting","stopping","opening","closing"],r=["deleted","failed"],s=(e,t)=>n.includes(e)&&n.includes(t),o=(e,t)=>i.includes(e)||i.includes(t),l=(e,t)=>r.includes(e)||r.includes(t),c=e=>"machine_learning"===e},,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(4),i=a(37),r=a(92),s=a.n(r),o=a(183);const l=Object(n.memo)((({location:{pathname:e,search:t},history:a,match:{params:{detailName:i,tabName:r,flowTarget:l}},pageName:c,state:u})=>{const[d,p]=Object(n.useState)(!0),[m,g]=Object(o.a)();return Object(n.useEffect)((()=>{d&&""!==t?(g({type:"updateSearch",search:t}),p(!1)):""!==t&&t!==m.search&&g({type:"updateSearch",search:t})}),[t]),Object(n.useEffect)((()=>{c&&!s()(m.pathName,e)?d&&null==i?(g({type:"updateRouteWithOutSearch",route:{detailName:i,flowTarget:l,history:a,pageName:c,pathName:e,state:u,tabName:r}}),p(!1)):g({type:"updateRoute",route:{detailName:i,flowTarget:l,history:a,pageName:c,pathName:e,search:t,state:u,tabName:r}}):c&&!s()(u,m.state)&&g({type:"updateRoute",route:{detailName:i,flowTarget:l,history:a,pageName:c,pathName:e,search:t,state:u,tabName:r}})}),[e,t,c,i,r,l,u]),null}));l.displayName="SpyRouteComponent";const c=Object(i.withRouter)(l)},function(e,t,a){"use strict";function n(e,t){return[e[0]+t[0],e[1]+t[1]]}function i(e,t){return[e[0]-t[0],e[1]-t[1]]}function r(e,t){return[e[0]/t[0],e[1]/t[1]]}function s(e,t){return[e[0]*t[0],e[1]*t[1]]}function o([e,t],[a,n,i,r,s,o]){return[e*a+t*n+i,e*r+t*s+o]}function l([e,t],[a,n]){return e===a&&t===n}function c(e,t){const[a,n]=e,[i,r]=t;return Math.sqrt(Math.pow(i-a,2)+Math.pow(r-n,2))}function u(e,t){const a=t[0]-e[0],n=t[1]-e[1];return Math.atan2(n,a)}function d(e,t){return[e[0]*t,e[1]*t]}function p(e,t,a){return n(d(e,1-a),d(t,a))}a.d(t,"a",(function(){return n})),a.d(t,"j",(function(){return i})),a.d(t,"e",(function(){return r})),a.d(t,"h",(function(){return s})),a.d(t,"c",(function(){return o})),a.d(t,"f",(function(){return l})),a.d(t,"d",(function(){return c})),a.d(t,"b",(function(){return u})),a.d(t,"i",(function(){return d})),a.d(t,"g",(function(){return p}))},function(e,t,a){class Range{constructor(e,t){if(t=i(t),e instanceof Range)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new Range(e.raw,t);if(e instanceof r)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split("||").map((e=>this.parseRange(e.trim()))).filter((e=>e.length)),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${e}`);if(this.set.length>1){const e=this.set[0];if(this.set=this.set.filter((e=>!m(e[0]))),0===this.set.length)this.set=[e];else if(this.set.length>1)for(const e of this.set)if(1===e.length&&g(e[0])){this.set=[e];break}}this.format()}format(){return this.range=this.set.map((e=>e.join(" ").trim())).join("||").trim(),this.range}toString(){return this.range}parseRange(e){e=e.trim();const t=`parseRange:${Object.keys(this.options).join(",")}:${e}`,a=n.get(t);if(a)return a;const i=this.options.loose,o=i?l[c.HYPHENRANGELOOSE]:l[c.HYPHENRANGE];e=e.replace(o,w(this.options.includePrerelease)),s("hyphen replace",e),e=e.replace(l[c.COMPARATORTRIM],u),s("comparator trim",e);let g=(e=(e=(e=e.replace(l[c.TILDETRIM],d)).replace(l[c.CARETTRIM],p)).split(/\s+/).join(" ")).split(" ").map((e=>f(e,this.options))).join(" ").split(/\s+/).map((e=>O(e,this.options)));i&&(g=g.filter((e=>(s("loose invalid filter",e,this.options),!!e.match(l[c.COMPARATORLOOSE]))))),s("range list",g);const b=new Map,y=g.map((e=>new r(e,this.options)));for(const e of y){if(m(e))return[e];b.set(e.value,e)}b.size>1&&b.has("")&&b.delete("");const h=[...b.values()];return n.set(t,h),h}intersects(e,t){if(!(e instanceof Range))throw new TypeError("a Range is required");return this.set.some((a=>b(a,t)&&e.set.some((e=>b(e,t)&&a.every((a=>e.every((e=>a.intersects(e,t)))))))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new o(e,this.options)}catch(e){return!1}for(let t=0;t<this.set.length;t++)if(T(this.set[t],e,this.options))return!0;return!1}}e.exports=Range;const n=new(a(982))({max:1e3}),i=a(322),r=a(364),s=a(307),o=a(125),{re:l,t:c,comparatorTrimReplace:u,tildeTrimReplace:d,caretTrimReplace:p}=a(235),m=e=>"<0.0.0-0"===e.value,g=e=>""===e.value,b=(e,t)=>{let a=!0;const n=e.slice();let i=n.pop();for(;a&&n.length;)a=n.every((e=>i.intersects(e,t))),i=n.pop();return a},f=(e,t)=>(s("comp",e,t),e=v(e,t),s("caret",e),e=h(e,t),s("tildes",e),e=k(e,t),s("xrange",e),e=j(e,t),s("stars",e),e),y=e=>!e||"x"===e.toLowerCase()||"*"===e,h=(e,t)=>e.trim().split(/\s+/).map((e=>E(e,t))).join(" "),E=(e,t)=>{const a=t.loose?l[c.TILDELOOSE]:l[c.TILDE];return e.replace(a,((t,a,n,i,r)=>{let o;return s("tilde",e,t,a,n,i,r),y(a)?o="":y(n)?o=`>=${a}.0.0 <${+a+1}.0.0-0`:y(i)?o=`>=${a}.${n}.0 <${a}.${+n+1}.0-0`:r?(s("replaceTilde pr",r),o=`>=${a}.${n}.${i}-${r} <${a}.${+n+1}.0-0`):o=`>=${a}.${n}.${i} <${a}.${+n+1}.0-0`,s("tilde return",o),o}))},v=(e,t)=>e.trim().split(/\s+/).map((e=>x(e,t))).join(" "),x=(e,t)=>{s("caret",e,t);const a=t.loose?l[c.CARETLOOSE]:l[c.CARET],n=t.includePrerelease?"-0":"";return e.replace(a,((t,a,i,r,o)=>{let l;return s("caret",e,t,a,i,r,o),y(a)?l="":y(i)?l=`>=${a}.0.0${n} <${+a+1}.0.0-0`:y(r)?l="0"===a?`>=${a}.${i}.0${n} <${a}.${+i+1}.0-0`:`>=${a}.${i}.0${n} <${+a+1}.0.0-0`:o?(s("replaceCaret pr",o),l="0"===a?"0"===i?`>=${a}.${i}.${r}-${o} <${a}.${i}.${+r+1}-0`:`>=${a}.${i}.${r}-${o} <${a}.${+i+1}.0-0`:`>=${a}.${i}.${r}-${o} <${+a+1}.0.0-0`):(s("no pr"),l="0"===a?"0"===i?`>=${a}.${i}.${r}${n} <${a}.${i}.${+r+1}-0`:`>=${a}.${i}.${r}${n} <${a}.${+i+1}.0-0`:`>=${a}.${i}.${r} <${+a+1}.0.0-0`),s("caret return",l),l}))},k=(e,t)=>(s("replaceXRanges",e,t),e.split(/\s+/).map((e=>S(e,t))).join(" ")),S=(e,t)=>{e=e.trim();const a=t.loose?l[c.XRANGELOOSE]:l[c.XRANGE];return e.replace(a,((a,n,i,r,o,l)=>{s("xRange",e,a,n,i,r,o,l);const c=y(i),u=c||y(r),d=u||y(o),p=d;return"="===n&&p&&(n=""),l=t.includePrerelease?"-0":"",c?a=">"===n||"<"===n?"<0.0.0-0":"*":n&&p?(u&&(r=0),o=0,">"===n?(n=">=",u?(i=+i+1,r=0,o=0):(r=+r+1,o=0)):"<="===n&&(n="<",u?i=+i+1:r=+r+1),"<"===n&&(l="-0"),a=`${n+i}.${r}.${o}${l}`):u?a=`>=${i}.0.0${l} <${+i+1}.0.0-0`:d&&(a=`>=${i}.${r}.0${l} <${i}.${+r+1}.0-0`),s("xRange return",a),a}))},j=(e,t)=>(s("replaceStars",e,t),e.trim().replace(l[c.STAR],"")),O=(e,t)=>(s("replaceGTE0",e,t),e.trim().replace(l[t.includePrerelease?c.GTE0PRE:c.GTE0],"")),w=e=>(t,a,n,i,r,s,o,l,c,u,d,p,m)=>`${a=y(n)?"":y(i)?`>=${n}.0.0${e?"-0":""}`:y(r)?`>=${n}.${i}.0${e?"-0":""}`:s?`>=${a}`:`>=${a}${e?"-0":""}`} ${l=y(c)?"":y(u)?`<${+c+1}.0.0-0`:y(d)?`<${c}.${+u+1}.0-0`:p?`<=${c}.${u}.${d}-${p}`:e?`<${c}.${u}.${+d+1}-0`:`<=${l}`}`.trim(),T=(e,t,a)=>{for(let a=0;a<e.length;a++)if(!e[a].test(t))return!1;if(t.prerelease.length&&!a.includePrerelease){for(let a=0;a<e.length;a++)if(s(e[a].semver),e[a].semver!==r.ANY&&e[a].semver.prerelease.length>0){const n=e[a].semver;if(n.major===t.major&&n.minor===t.minor&&n.patch===t.patch)return!0}return!1}return!0}},,function(e,t,a){"use strict";a.d(t,"b",(function(){return d})),a.d(t,"a",(function(){return p})),a.d(t,"c",(function(){return m}));var n=a(34),i=a(4),r=a.n(i),s=a(217),o=a(230);const l={canUserCRUD:null,canUserREAD:null,hasIndexManage:null,hasIndexMaintenance:null,hasIndexWrite:null,hasIndexRead:null,hasIndexUpdateDelete:null,isSignalIndexExists:null,isAuthenticated:null,hasEncryptionKey:null,loading:!0,signalIndexName:null,signalIndexMappingOutdated:null},c=(e,t)=>{switch(t.type){case"updateLoading":return{...e,loading:t.loading};case"updateHasIndexManage":return{...e,hasIndexManage:t.hasIndexManage};case"updateHasIndexMaintenance":return{...e,hasIndexMaintenance:t.hasIndexMaintenance};case"updateHasIndexWrite":return{...e,hasIndexWrite:t.hasIndexWrite};case"updateHasIndexRead":return{...e,hasIndexRead:t.hasIndexRead};case"updateHasIndexUpdateDelete":return{...e,hasIndexUpdateDelete:t.hasIndexUpdateDelete};case"updateIsSignalIndexExists":return{...e,isSignalIndexExists:t.isSignalIndexExists};case"updateIsAuthenticated":return{...e,isAuthenticated:t.isAuthenticated};case"updateHasEncryptionKey":return{...e,hasEncryptionKey:t.hasEncryptionKey};case"updateSignalIndexName":return{...e,signalIndexName:t.signalIndexName};case"updateSignalIndexMappingOutdated":return{...e,signalIndexMappingOutdated:t.signalIndexMappingOutdated};case"updateCanUserCRUD":return{...e,canUserCRUD:t.canUserCRUD};case"updateCanUserREAD":return{...e,canUserREAD:t.canUserREAD};default:return e}},u=Object(i.createContext)([l,()=>n.noop]),d=()=>Object(i.useContext)(u),p=({children:e})=>r.a.createElement(u.Provider,{value:Object(i.useReducer)(c,l)},e),m=()=>{const[{canUserCRUD:e,canUserREAD:t,hasIndexManage:a,hasIndexMaintenance:n,hasIndexWrite:r,hasIndexRead:l,hasIndexUpdateDelete:c,isSignalIndexExists:u,isAuthenticated:p,hasEncryptionKey:m,loading:g,signalIndexName:b,signalIndexMappingOutdated:f},y]=d(),{loading:h,isAuthenticated:E,hasEncryptionKey:v,hasIndexManage:x,hasIndexMaintenance:k,hasIndexUpdateDelete:S,hasIndexWrite:j,hasIndexRead:O,hasKibanaCRUD:w,hasKibanaREAD:T}=Object(s.a)(),{loading:I,signalIndexExists:C,signalIndexName:M,signalIndexMappingOutdated:F,createDeSignalIndex:D}=Object(o.a)();return Object(i.useEffect)((()=>{g||e===w||y({type:"updateCanUserCRUD",canUserCRUD:w})}),[y,g,e,w]),Object(i.useEffect)((()=>{g||t===T||y({type:"updateCanUserREAD",canUserREAD:T})}),[y,g,t,T]),Object(i.useEffect)((()=>{g!==(h||I)&&y({type:"updateLoading",loading:h||I})}),[y,g,h,I]),Object(i.useEffect)((()=>{g||a===x||null==x||y({type:"updateHasIndexManage",hasIndexManage:x})}),[y,g,a,x]),Object(i.useEffect)((()=>{g||r===j||null==j||y({type:"updateHasIndexWrite",hasIndexWrite:j})}),[y,g,r,j]),Object(i.useEffect)((()=>{g||l===O||null==O||y({type:"updateHasIndexRead",hasIndexRead:O})}),[y,g,l,O]),Object(i.useEffect)((()=>{g||c===S||null==S||y({type:"updateHasIndexUpdateDelete",hasIndexUpdateDelete:S})}),[y,g,c,S]),Object(i.useEffect)((()=>{g||n===k||null==k||y({type:"updateHasIndexMaintenance",hasIndexMaintenance:k})}),[y,g,n,k]),Object(i.useEffect)((()=>{g||u===C||null==C||y({type:"updateIsSignalIndexExists",isSignalIndexExists:C})}),[y,g,u,C]),Object(i.useEffect)((()=>{g||p===E||null==E||y({type:"updateIsAuthenticated",isAuthenticated:E})}),[y,g,p,E]),Object(i.useEffect)((()=>{g||m===v||null==v||y({type:"updateHasEncryptionKey",hasEncryptionKey:v})}),[y,g,m,v]),Object(i.useEffect)((()=>{g||b===M||null==M||y({type:"updateSignalIndexName",signalIndexName:M})}),[y,g,b,M]),Object(i.useEffect)((()=>{g||f===F||null==F||y({type:"updateSignalIndexMappingOutdated",signalIndexMappingOutdated:F})}),[y,g,f,F]),Object(i.useEffect)((()=>{p&&m&&a&&(null!=u&&!u||null!=f&&f)&&null!=D&&D()}),[D,p,m,u,a,f]),{loading:g,isSignalIndexExists:u,isAuthenticated:p,hasEncryptionKey:m,canUserCRUD:e,canUserREAD:t,hasIndexManage:a,hasIndexMaintenance:n,hasIndexWrite:r,hasIndexRead:l,hasIndexUpdateDelete:c,signalIndexName:b,signalIndexMappingOutdated:f}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return r})),a.d(t,"g",(function(){return s})),a.d(t,"e",(function(){return o})),a.d(t,"f",(function(){return l})),a.d(t,"c",(function(){return c})),a.d(t,"d",(function(){return u})),a.d(t,"h",(function(){return d}));var n=a(7);a(245);const i=e=>{if(null!=e){const t=e.trim().split(/[ \t\r\n]+/);return"sequence"===t[0]&&"where"!==t[1]}return!1},r=e=>"eql"===e,s=e=>"threshold"===e,o=e=>"query"===e||"saved_query"===e,l=e=>"threat_match"===e,c=e=>"machine_learning"===e,u=e=>"new_terms"===e,d=e=>Array.isArray(e)?e:Object(n.isEmpty)(e)?[]:[e]},function(e,t,a){"use strict";let n,i;a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return i})),function(e){e.defineRule="define-rule",e.aboutRule="about-rule",e.scheduleRule="schedule-rule",e.ruleActions="rule-actions"}(n||(n={})),function(e){e.IndexPatterns="indexPatterns",e.DataView="dataView"}(i||(i={}))},function(e,t,a){"use strict";a.d(t,"x",(function(){return i})),a.d(t,"u",(function(){return r})),a.d(t,"w",(function(){return s})),a.d(t,"v",(function(){return o})),a.d(t,"t",(function(){return l})),a.d(t,"s",(function(){return c})),a.d(t,"n",(function(){return u})),a.d(t,"m",(function(){return d})),a.d(t,"r",(function(){return p})),a.d(t,"q",(function(){return m})),a.d(t,"y",(function(){return g})),a.d(t,"J",(function(){return b})),a.d(t,"M",(function(){return f})),a.d(t,"L",(function(){return y})),a.d(t,"K",(function(){return h})),a.d(t,"j",(function(){return E})),a.d(t,"C",(function(){return v})),a.d(t,"A",(function(){return x})),a.d(t,"B",(function(){return k})),a.d(t,"p",(function(){return S})),a.d(t,"T",(function(){return j.G})),a.d(t,"l",(function(){return j.o})),a.d(t,"o",(function(){return j.q})),a.d(t,"ab",(function(){return j.O})),a.d(t,"Q",(function(){return j.D})),a.d(t,"Z",(function(){return j.N})),a.d(t,"O",(function(){return j.B})),a.d(t,"P",(function(){return j.C})),a.d(t,"cb",(function(){return j.Q})),a.d(t,"z",(function(){return j.s})),a.d(t,"R",(function(){return j.E})),a.d(t,"W",(function(){return j.K})),a.d(t,"db",(function(){return j.R})),a.d(t,"Y",(function(){return j.M})),a.d(t,"X",(function(){return j.L})),a.d(t,"F",(function(){return j.w})),a.d(t,"E",(function(){return j.u})),a.d(t,"H",(function(){return j.y})),a.d(t,"G",(function(){return j.x})),a.d(t,"D",(function(){return j.t})),a.d(t,"N",(function(){return j.A})),a.d(t,"a",(function(){return j.b})),a.d(t,"I",(function(){return j.z})),a.d(t,"S",(function(){return j.F})),a.d(t,"b",(function(){return j.c})),a.d(t,"i",(function(){return j.l})),a.d(t,"k",(function(){return j.n})),a.d(t,"h",(function(){return j.k})),a.d(t,"f",(function(){return j.i})),a.d(t,"g",(function(){return j.j})),a.d(t,"d",(function(){return j.g})),a.d(t,"e",(function(){return j.h})),a.d(t,"c",(function(){return j.d})),a.d(t,"bb",(function(){return j.P})),a.d(t,"V",(function(){return j.J})),a.d(t,"U",(function(){return j.H}));var n=a(0);const i=n.i18n.translate("xpack.securitySolution.exception.list.empty.viewer_title",{defaultMessage:"Create exceptions to this list"}),r=e=>n.i18n.translate("xpack.securitySolution.exception.list.empty.viewer_body",{values:{listName:e},defaultMessage:"There is no exception in your [{listName}]. Create rule exceptions to this list."}),s=n.i18n.translate("xpack.securitySolution.exception.list.empty.viewer_button_endpoint",{defaultMessage:"Create endpoint exception"}),o=n.i18n.translate("xpack.securitySolution.exception.list.empty.viewer_button",{defaultMessage:"Create rule exception"}),l=n.i18n.translate("xpack.securitySolution.exception.list.search_bar_button_enpoint",{defaultMessage:"Add endpoint exception to list"}),c=n.i18n.translate("xpack.securitySolution.exception.list.search_bar_button",{defaultMessage:"Add rule exception to list"}),u=(n.i18n.translate("xpack.securitySolution.exceptions.list.exceptionItemSearchErrorTitle",{defaultMessage:"Error searching"}),n.i18n.translate("xpack.securitySolution.exceptions.list.exceptionItemSearchErrorBody",{defaultMessage:"An error occurred searching for exception items. Please try again."}),n.i18n.translate("xpack.securitySolution.exceptions.list.exceptionItemsFetchError",{defaultMessage:"Unable to load exception items"})),d=n.i18n.translate("xpack.securitySolution.exceptions.list.exceptionItemsFetchErrorDescription",{defaultMessage:"There was an error loading the exception items. Contact your administrator for help."}),p=n.i18n.translate("xpack.securitySolution.exceptions.list.exception.item.card.exceptionItemDeleteSuccessTitle",{defaultMessage:"Exception deleted"}),m=e=>n.i18n.translate("xpack.securitySolution.exceptions.list.exception.item.card.exceptionItemDeleteSuccessText",{values:{itemName:e},defaultMessage:'"{itemName}" deleted successfully.'}),g=e=>n.i18n.translate("xpack.securitySolution.exceptions.list.exported_successfully",{values:{listName:e},defaultMessage:"{listName} exported successfully"}),b=n.i18n.translate("xpack.securitySolution.exceptions.list.manage_rules_cancel",{defaultMessage:"Cancel"}),f=n.i18n.translate("xpack.securitySolution.exceptions.list.manage_rules_save",{defaultMessage:"Save"}),y=n.i18n.translate("xpack.securitySolution.exceptions.list.manage_rules_header",{defaultMessage:"Manage rules"}),h=n.i18n.translate("xpack.securitySolution.exceptions.list.manage_rules_description",{defaultMessage:"Link or unlink rules to this exception list."}),E=n.i18n.translate("xpack.securitySolution.exceptionsTable.deleteExceptionList",{defaultMessage:"Delete exception list"}),v=n.i18n.translate("xpack.securitySolution.exceptionsTable.exportExceptionList",{defaultMessage:"Export exception list"}),x=n.i18n.translate("xpack.securitySolution.exceptionsTable.manageRulesError",{defaultMessage:"Manage rules error"}),k=n.i18n.translate("xpack.securitySolution.exceptionsTable.manageRulesErrorDescription",{defaultMessage:"An error occurred linking or unlinking rules"}),S=n.i18n.translate("xpack.securitySolution.exceptionsTable.exportListDescription",{defaultMessage:"An error occurred exporting a list"});a(481);var j=a(564)},,function(e,t,a){"use strict";a.d(t,"c",(function(){return d})),a.d(t,"b",(function(){return p})),a.d(t,"a",(function(){return m}));var n=a(4),i=a(37),r=a(78),s=a(110),o=a(105),l=a(153),c=a(178),u=a(1);function d(e){return Object(r.useSelector)((t=>e(t[o.u][o.v])))}function p(e){const t=d(c.c),a=Object(i.useHistory)(),r=d(c.o),o=Object(n.useCallback)((a=>e===s.m?Object(l.k)(r,{...t,...a}):e===s.e?Object(l.l)(r,{...t,...a}):e===s.b?Object(l.i)(r,{...t,...a}):Object(l.m)(r,{...t,...a})),[e,t,r]);return Object(n.useCallback)((e=>a.push(o(e))),[o,a])}const m=()=>window.location.pathname.includes(u.bc)&&window.location.pathname.includes("/settings")},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=e=>e.capabilities.canGetJobs&&e.capabilities.canGetDatafeeds&&e.capabilities.canGetCalendars},,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return b})),a.d(t,"b",(function(){return E}));var n=a(34),i=a(294),r=a.n(i),s=a(4),o=a(53),l=a.n(o),c=a(11),u=a(42),d=a(77),p=a(431),m=a(84),g=a(285);const b=e=>Object(n.keyBy)("name",function(e){const t=[];for(const a of Object.values(e))a.fields&&t.push(...Object.values(a.fields));return t}(e)),f=r()(((e,t)=>t&&t.length>0?{fields:t.map((e=>Object(n.pick)(["name","searchable","type","aggregatable","esTypes","subType"],e))),title:e}:{fields:[],title:e}),((e,t)=>e[0]===t[0]&&e[1].length===t[1].length)),y=(r()(((e,t)=>t.reduce(((e,t)=>(null==e[t.category]&&(e[t.category]={}),null==e[t.category].fields&&(e[t.category].fields={}),e[t.category].fields[t.name]=t,e)),{})),((e,t)=>e[0]===t[0]&&e[1].length===t[1].length)),{}),h={fields:[],title:""},E=(e,t=!1)=>{const{data:a}=Object(d.k)().services,i=Object(s.useRef)(new AbortController),r=Object(s.useRef)(new c.Subscription),o=Object(s.useRef)([]),[b,E]=Object(s.useState)(!1),[v,x]=Object(s.useState)({browserFields:y,indexes:e,indexExists:!0,indexPatterns:h}),{addError:k,addWarning:S}=Object(m.a)(),j=Object(s.useCallback)((e=>{r.current.unsubscribe(),i.current.abort(),(async()=>{i.current=new AbortController,E(!0),r.current=a.search.search({indices:e,onlyCheckIfIndicesExist:t},{abortSignal:i.current.signal,strategy:"indexFields"}).subscribe({next:e=>{Object(u.isCompleteResponse)(e)?Promise.resolve().then((()=>{l.a.unstable_batchedUpdates((()=>{const t=e.indicesExist.sort().join();o.current=e.indicesExist;const{browserFields:a}=Object(g.a)(t,e.indexFields);E(!1),x({browserFields:a,indexes:e.indicesExist,indexExists:e.indicesExist.length>0,indexPatterns:f(t,e.indexFields)}),r.current.unsubscribe()}))})):Object(u.isErrorResponse)(e)&&(E(!1),S(p.a),r.current.unsubscribe())},error:e=>{E(!1),k(e,{title:p.b}),r.current.unsubscribe()}})})()}),[a.search,k,S,t,E,x]);return Object(s.useEffect)((()=>(Object(n.isEmpty)(e)||Object(n.isEqual)(o.current,e)||j(e),()=>{r.current.unsubscribe(),i.current.abort()})),[e,j,o]),[b,v]}},function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"f",(function(){return i})),a.d(t,"n",(function(){return r})),a.d(t,"g",(function(){return s})),a.d(t,"e",(function(){return o})),a.d(t,"h",(function(){return l})),a.d(t,"c",(function(){return c})),a.d(t,"k",(function(){return u})),a.d(t,"j",(function(){return d})),a.d(t,"d",(function(){return p})),a.d(t,"l",(function(){return m})),a.d(t,"m",(function(){return g})),a.d(t,"a",(function(){return b})),a.d(t,"i",(function(){return f}));const n="date",i="host.name",r="user.name",s="ip",o="geo_point",l="message",c="event.module",u="rule.reference",d="reference.url",p="event.url",m="kibana.alert.rule.name",g="kibana.alert.workflow_status",b="agent.status",f="kibana.alert.reason"},,function(e,t,a){"use strict";var n=a(399);a.d(t,"a",(function(){return n.a})),a.d(t,"b",(function(){return n.b})),a.d(t,"d",(function(){return n.d})),a.d(t,"e",(function(){return n.e})),a.d(t,"f",(function(){return n.f})),a.d(t,"l",(function(){return n.j})),a.d(t,"m",(function(){return n.k})),a.d(t,"n",(function(){return n.l})),a.d(t,"o",(function(){return n.m})),a.d(t,"p",(function(){return n.n}));var i=a(386);a.d(t,"c",(function(){return i.a})),a.d(t,"g",(function(){return i.b})),a.d(t,"h",(function(){return i.c})),a.d(t,"i",(function(){return i.d})),a.d(t,"j",(function(){return i.e})),a.d(t,"k",(function(){return i.f}))},function(e,t,a){"use strict";a.d(t,"e",(function(){return i})),a.d(t,"b",(function(){return r})),a.d(t,"d",(function(){return s})),a.d(t,"f",(function(){return o})),a.d(t,"a",(function(){return l})),a.d(t,"c",(function(){return c}));var n=a(1);const i={ENABLE:`${n.B} singleRuleActions enable`,DISABLE:`${n.B} singleRuleActions disable`,DUPLICATE:`${n.B} singleRuleActions duplicate`,EXPORT:`${n.B} singleRuleActions export`,DELETE:`${n.B} singleRuleActions delete`,PREVIEW:`${n.B} singleRuleActions preview`,SAVE:`${n.B} singleRuleActions save`},r={ENABLE:`${n.B} bulkRuleActions enable`,DISABLE:`${n.B} bulkRuleActions disable`,DUPLICATE:`${n.B} bulkRuleActions duplicate`,EXPORT:`${n.B} bulkRuleActions export`,DELETE:`${n.B} bulkRuleActions delete`,EDIT:`${n.B} bulkRuleActions edit`},s={REFRESH:`${n.B} rulesTable refresh`,FILTER:`${n.B} rulesTable filter`,LOAD_PREBUILT:`${n.B} rulesTable loadPrebuilt`,PREVIEW_ON:`${n.B} rulesTable technicalPreview on`,PREVIEW_OFF:`${n.B} rulesTable technicalPreview off`},o={SAVE:`${n.B} timeline save`,DUPLICATE:`${n.B} timeline duplicate`,DELETE:`${n.B} timeline delete`,BULK_DELETE:`${n.B} timeline bulkDelete`},l={OPEN_ANALYZER:`${n.B} alerts openAnalyzer`,OPEN_SESSION_VIEW:`${n.B} alerts openSessionView`,INVESTIGATE_IN_TIMELINE:`${n.B} alerts investigateInTimeline`},c={FIELD_SAVED:`${n.B} fieldBrowser fieldSaved`,FIELD_DELETED:`${n.B} fieldBrowser fieldDeleted`}},function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(158);const i={defaultColumns:n.b,dataViewId:null,deletedEventIds:[],expandedDetail:{},filters:[],indexNames:[],isSelectAllChecked:!1,isLoading:!1,itemsPerPage:25,itemsPerPageOptions:[10,25,50,100],loadingEventIds:[],selectedEventIds:{},showCheckboxes:!1,sort:[{columnId:"@timestamp",columnType:"date",esTypes:["date"],sortDirection:"desc"}],selectAll:!1,graphEventId:"",sessionViewConfig:null,columns:n.b,queryFields:[],totalCount:0}},function(e,t,a){"use strict";a.d(t,"b",(function(){return y})),a.d(t,"c",(function(){return h})),a.d(t,"a",(function(){return j}));var n=a(4),i=a.n(n),r=a(35),s=a(32),o=a(33),l=a.n(o),c=a(133),u=a(102),d=a(87),p=a(160),m=a(106),g=a(150),b=a(221);const f=l.a.div.withConfig({displayName:"Subtext",componentId:"sc-1au6na0-0"})(["font-size:",";"],(e=>e.theme.eui.euiFontSizeXS)),y=({rowItem:e,attrName:t,idPrefix:a,fieldType:n,isAggregatable:r,render:s,dragDisplayValue:o})=>{if(null!=e){const l=Object(u.h)(`${a}-${t}-${e}`);return i.a.createElement(c.b,{key:l,dataProvider:{and:[],enabled:!0,id:l,name:e,excluded:!1,kqlQuery:"",queryMatch:{field:t,value:e,displayValue:o||e,operator:m.d}},fieldType:n,isAggregatable:r,render:(t,a,n)=>n.isDragging?i.a.createElement(c.a,null,i.a.createElement(g.a,{dataProvider:t})):i.a.createElement(i.a.Fragment,null,s?s(e):Object(d.a)(e))})}return Object(d.d)()},h=({rowItems:e,attrName:t,idPrefix:a,render:n,dragDisplayValue:r,fieldType:s="keyword",isAggregatable:o=!1,displayCount:l=5,maxOverflow:p=5})=>{if(null!=e&&e.length>0){const b=e.slice(0,l).map(((e,l)=>{const p=Object(u.h)(`${a}-${t}-${e}-${l}`);return i.a.createElement(i.a.Fragment,{key:p},i.a.createElement(c.b,{key:p,dataProvider:{and:[],enabled:!0,id:p,name:e,excluded:!1,kqlQuery:"",queryMatch:{field:t,value:e,displayValue:r||e,operator:m.d}},fieldType:s,isAggregatable:o,render:(t,a,r)=>r.isDragging?i.a.createElement(c.a,null,i.a.createElement(g.a,{dataProvider:t})):i.a.createElement(i.a.Fragment,null,n?n(e):Object(d.a)(e))}))}));return b.length>0?i.a.createElement(i.a.Fragment,null,b," ",i.a.createElement(v,{attrName:t,dragDisplayValue:r,idPrefix:a,maxOverflowItems:p,overflowIndexStart:l,rowItems:e,fieldType:s,isAggregatable:o})):Object(d.d)()}return Object(d.d)()},E=({attrName:e,dragDisplayValue:t,idPrefix:a,maxOverflowItems:n=5,overflowIndexStart:o=5,rowItems:l,fieldType:c,isAggregatable:u})=>i.a.createElement(i.a.Fragment,null,l.length>o&&i.a.createElement(k,{count:l.length-o,idPrefix:a},i.a.createElement(s.EuiText,{size:"xs"},i.a.createElement(b.c,{attrName:e,dragDisplayValue:t,idPrefix:a,overflowIndexStart:o,rowItems:l,moreMaxHeight:"none",fieldType:c,isAggregatable:u}),l.length>o+n&&i.a.createElement("p",{"data-test-subj":"popover-additional-overflow"},i.a.createElement(s.EuiTextColor,{color:"subdued"},l.length-o-n," ",i.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.tables.rowItemHelper.moreDescription",defaultMessage:"more not shown"}))))));E.displayName="RowItemOverflowComponent";const v=i.a.memo(E),x=({children:e,count:t,idPrefix:a})=>{const[o,l]=Object(n.useState)(!1),c=Object(n.useCallback)((()=>{l(!o)}),[o]);return i.a.createElement(f,null,i.a.createElement(s.EuiPopover,{button:i.a.createElement(s.EuiLink,{onClick:c,"data-test-subj":"overflow-button"},i.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.tables.rowItemHelper.overflowButtonDescription",defaultMessage:"+{count} More",values:{count:t}})),closePopover:()=>l(!o),id:`${a}-popover`,isOpen:o,panelClassName:"withHoverActions__popover",repositionOnScroll:!0},e))};x.displayName="PopoverComponent";const k=i.a.memo(x);k.displayName="Popover";const S=({value:e,showToolTip:t=!0,overflowLength:a=50})=>i.a.createElement("span",null,t?i.a.createElement(s.EuiToolTip,{"data-test-subj":"message-tooltip",content:"message"},i.a.createElement(i.a.Fragment,null,e.substring(0,a))):i.a.createElement(i.a.Fragment,null,e.substring(0,a)),e.length>a&&i.a.createElement(s.EuiToolTip,{content:e},i.a.createElement(p.f,{type:"boxesHorizontal"})));S.displayName="OverflowFieldComponent";const j=i.a.memo(S);j.displayName="OverflowField"},function(e,t,a){"use strict";a.d(t,"g",(function(){return o})),a.d(t,"c",(function(){return l})),a.d(t,"d",(function(){return c})),a.d(t,"a",(function(){return u})),a.d(t,"f",(function(){return p})),a.d(t,"b",(function(){return m})),a.d(t,"e",(function(){return b}));var n=a(34),i=a(38),r=a(188),s=a(176);const o={box:{incremental:!0,placeholder:r.q,schema:!0}},l=e=>Object(n.isEmpty)(e)?"":`Example: ${e}`,c=e=>{switch(e){case"string":case"keyword":return"string";case"number":case"long":case"float":return"number";case"date":return"clock";case"ip":case"geo_point":return"globe";default:return"questionInCircle"}},u="event-fields-table",d=e=>Object(i.elementOrChildrenHasFocus)(null==e?void 0:e.querySelector(`.${u}`)),p=({containerElement:e,keyboardEvent:t,onSkipFocusBeforeEventsTable:a,onSkipFocusAfterEventsTable:n})=>{const{shiftKey:r}=t,s=Object(i.getTableSkipFocus)({containerElement:e,getFocusedCell:i.getFocusedDataColindexCell,shiftKey:r,tableHasFocus:d,tableClassName:u});"SKIP_FOCUS_NOOP"!==s&&(Object(i.stopPropagationAndPreventDefault)(t),Object(i.handleSkipFocus)({onSkipFocusBackwards:a,onSkipFocusForward:n,skipFocus:s}))};function m({browserFields:e,contextId:t,eventId:a,field:i,item:r,linkValueField:s,scopeId:o}){var l,c,u,d;const p={contextId:t,eventId:a,fieldType:"string",linkValue:void 0,scopeId:o},m=Object(n.getOr)(null,"originalValue.0",s),g=null!==(l=r.category)&&void 0!==l?l:"",b=null!==(c=r.field)&&void 0!==c?c:"",f=Object(n.get)([g,"fields",b],e),y=null==i?void 0:i.overrideField;return{...p,data:{field:null!=y?y:b,format:null!==(u=null==f?void 0:f.format)&&void 0!==u?u:"",type:null!==(d=null==f?void 0:f.type)&&void 0!==d?d:"",isObjectArray:r.isObjectArray},values:r.values,linkValue:null!=m?m:void 0,fieldFromBrowserField:f}}const g={[s.a]:!0};function b(e){return!g[e]}},,,function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(1);const i={ADD_EXCEPTION_FLYOUT:`${n.B} fetchAlerts addExceptionFlyout`,ALERTS_COUNT_BY_STATUS:`${n.B} fetchAlerts byRulebyCount`,BY_ID:`${n.B} fetchAlerts byId`,BY_RULE_BY_STATUS:`${n.B} fetchAlerts byRulebyStatus`,BY_RULE_ID:`${n.B} fetchAlerts byRuleId`,BY_SEVERITY:`${n.B} fetchAlerts bySeverity`,BY_STATUS:`${n.B} fetchAlerts byStatus`,CASES:`${n.B} fetchAlerts cases`,COUNT:`${n.B} fetchAlerts count`,HISTOGRAM:`${n.B} fetchAlerts histogram`,PREVALENCE:`${n.B} fetchAlerts prevalence`,SOC_TRENDS:`${n.B} fetchAlerts socTrends`,TREE_MAP:`${n.B} fetchAlerts treeMap`,VULNERABLE_HOSTS:`${n.B} fetchAlerts vulnerableHosts`,VULNERABLE_USERS:`${n.B} fetchAlerts vulnerableUsers`}},function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(7),i=a(4),r=a(193),s=a(231);const o=({fetchMethod:e=r.e,query:t,indexName:a,skip:o,queryName:l})=>{const[c,u]=Object(i.useState)(t),[d,p]=Object(i.useState)({data:null,response:"",request:"",setQuery:u,refetch:null}),[m,g]=Object(i.useState)(!1),b=((e,t)=>{const{startTracking:a}=Object(s.a)();return Object(i.useMemo)((()=>async n=>{const{endTracking:i}=a({name:t});let r;try{r=await e(n),i("success")}catch(e){throw i(n.signal.aborted?"aborted":"error"),e}return r}),[e,t,a])})(e,l);return Object(i.useEffect)((()=>{let e=!0;const t=new AbortController,i=async()=>{try{g(!0);const r=await b({query:c,signal:t.signal});var n;e&&p({data:r,response:JSON.stringify(r,null,2),request:JSON.stringify({index:null!==(n=[a])&&void 0!==n?n:[""],body:c},null,2),setQuery:u,refetch:i})}catch(t){e&&p({data:null,response:"",request:"",setQuery:u,refetch:i})}e&&g(!1)};return Object(n.isEmpty)(c)||o||i(),o&&(g(!1),e=!1,t.abort()),()=>{e=!1,t.abort()}}),[c,a,o,b]),{loading:m,...d}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(32),i=a(284),r=a(4),s=a.n(r),o=a(33),l=a.n(o);const c=l.a.aside.withConfig({displayName:"Aside",componentId:"sc-10s9ue6-0"})(["padding:",";",""],(({theme:e})=>e.eui.euiSizeM),(({overlay:e,overlayBackground:t,theme:a})=>e&&Object(o.css)(["background:",";bottom:0;left:0;position:absolute;right:0;top:0;z-index:",";"],t?Object(i.rgba)(t,.9):Object(i.rgba)(a.eui.euiColorEmptyShade,.9),a.eui.euiZLevel1)));c.displayName="Aside";const u=l()(n.EuiFlexGroup).attrs((()=>({alignItems:"center",direction:"column",gutterSize:"s",justifyContent:"center"}))).withConfig({displayName:"FlexGroup",componentId:"sc-10s9ue6-1"})(["",""],(({overlay:e})=>e&&Object(o.css)(["height:100%;"])));u.displayName="FlexGroup";const d=s.a.memo((({children:e,overlay:t,overlayBackground:a,size:i})=>s.a.createElement(c,{overlay:t,overlayBackground:a},s.a.createElement(u,{overlay:{overlay:t}},s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(n.EuiLoadingSpinner,{"data-test-subj":"loading-spinner",size:i})),e&&s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(n.EuiText,{color:"subdued",size:"s"},s.a.createElement("p",null,e)))))));d.displayName="Loader"},function(e,t,a){"use strict";a.d(t,"t",(function(){return i})),a.d(t,"j",(function(){return r})),a.d(t,"p",(function(){return s})),a.d(t,"e",(function(){return o})),a.d(t,"h",(function(){return l})),a.d(t,"i",(function(){return c})),a.d(t,"f",(function(){return u})),a.d(t,"g",(function(){return d})),a.d(t,"s",(function(){return p})),a.d(t,"k",(function(){return m})),a.d(t,"o",(function(){return g})),a.d(t,"d",(function(){return b})),a.d(t,"u",(function(){return f})),a.d(t,"q",(function(){return y})),a.d(t,"w",(function(){return h})),a.d(t,"n",(function(){return E})),a.d(t,"b",(function(){return v})),a.d(t,"r",(function(){return x})),a.d(t,"m",(function(){return k})),a.d(t,"l",(function(){return S})),a.d(t,"a",(function(){return j})),a.d(t,"c",(function(){return O})),a.d(t,"v",(function(){return w}));var n=a(0);const i=n.i18n.translate("xpack.securitySolution.alertDetails.threatIntel",{defaultMessage:"Threat Intel"}),r=n.i18n.translate("xpack.securitySolution.alertDetails.overview.investigationGuide",{defaultMessage:"Investigation guide"}),s=n.i18n.translate("xpack.securitySolution.alertDetails.overview",{defaultMessage:"Overview"}),o=n.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields",{defaultMessage:"Highlighted fields"}),l=n.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields.field",{defaultMessage:"Field"}),c=n.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields.value",{defaultMessage:"Value"}),u=n.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields.alertPrevalence",{defaultMessage:"Alert prevalence"}),d=n.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields.alertPrevalenceTooltip",{defaultMessage:"The total count of alerts with the same value within the currently selected timerange. This value is not affected by additional filters."}),p=n.i18n.translate("xpack.securitySolution.eventDetails.table",{defaultMessage:"Table"}),m=n.i18n.translate("xpack.securitySolution.eventDetails.jsonView",{defaultMessage:"JSON"}),g=n.i18n.translate("xpack.securitySolution.eventDetails.osqueryView",{defaultMessage:"Osquery Results"}),b=n.i18n.translate("xpack.securitySolution.eventDetails.field",{defaultMessage:"Field"}),f=n.i18n.translate("xpack.securitySolution.eventDetails.value",{defaultMessage:"Value"}),y=(n.i18n.translate("xpack.securitySolution.eventDetails.description",{defaultMessage:"Description"}),n.i18n.translate("xpack.securitySolution.eventDetails.filter.placeholder",{defaultMessage:"Filter by Field, Value, or Description..."})),h=e=>n.i18n.translate("xpack.securitySolution.eventDetails.viewColumnCheckboxAriaLabel",{values:{field:e},defaultMessage:"View {field} column"}),E=e=>n.i18n.translate("xpack.securitySolution.eventDetails.nestedColumnCheckboxAriaLabel",{values:{field:e},defaultMessage:"The {field} field is an object, and is broken down into nested fields which can be added as column"}),v=n.i18n.translate("xpack.securitySolution.detections.alerts.agentStatus",{defaultMessage:"Agent status"}),x=n.i18n.translate("xpack.securitySolution.detections.alerts.ruleType",{defaultMessage:"Rule type"}),k=n.i18n.translate("xpack.securitySolution.eventDetails.multiFieldTooltipContent",{defaultMessage:"Multi-fields can have multiple values per field"}),S=n.i18n.translate("xpack.securitySolution.eventDetails.multiFieldBadge",{defaultMessage:"multi-field"}),j=n.i18n.translate("xpack.securitySolution.eventDetails.table.actions",{defaultMessage:"Actions"}),O=n.i18n.translate("xpack.securitySolution.eventDetails.alertReason",{defaultMessage:"Alert reason"}),w=n.i18n.translate("xpack.securitySolution.eventDetails.viewAllFields",{defaultMessage:"View all fields in table"})},function(e,t,a){"use strict";e.exports=function(e){return-2===e||-1===e||32===e}},function(e,t,a){"use strict";a.d(t,"h",(function(){return E})),a.d(t,"j",(function(){return v})),a.d(t,"i",(function(){return x})),a.d(t,"l",(function(){return k})),a.d(t,"d",(function(){return S})),a.d(t,"a",(function(){return j})),a.d(t,"c",(function(){return O})),a.d(t,"m",(function(){return w})),a.d(t,"k",(function(){return T})),a.d(t,"b",(function(){return A})),a.d(t,"e",(function(){return _})),a.d(t,"f",(function(){return N})),a.d(t,"g",(function(){return R}));var n=a(4),i=a.n(n),r=a(32),s=a(7),o=a(43),l=a.n(o),c=a(93),u=a(245),d=a(172),p=a(361),m=a(710),g=a(965),b=a(966),f=a(967);const y=["@timestamp","agent.id","agent.name","agent.type","agent.version","data_stream.dataset","data_stream.namespace","data_stream.type","destination.address","destination.bytes","destination.domain","destination.geo.city_name","destination.geo.continent_name","destination.geo.country_iso_code","destination.geo.country_name","destination.geo.location","destination.geo.name","destination.geo.region_iso_code","destination.geo.region_name","destination.ip","destination.packets","destination.port","destination.registered_domain","destination.top_level_domain","dll.code_signature.exists","dll.code_signature.status","dll.code_signature.subject_name","dll.code_signature.trusted","dll.code_signature.valid","dll.Ext","dll.Ext.code_signature","dll.Ext.code_signature.exists","dll.Ext.code_signature.status","dll.Ext.code_signature.subject_name","dll.Ext.code_signature.trusted","dll.Ext.code_signature.valid","dll.Ext.load_index","dll.hash.md5","dll.hash.sha1","dll.hash.sha256","dll.hash.sha512","dll.name","dll.path","dll.pe.company","dll.pe.description","dll.pe.file_version","dll.pe.imphash","dll.pe.original_file_name","dll.pe.product","dns.Ext","dns.Ext.options","dns.Ext.status","dns.question.name","dns.question.registered_domain","dns.question.subdomain","dns.question.top_level_domain","dns.question.type","dns.resolved_ip","ecs.version","elastic.agent","elastic.agent.id","Endpoint.policy","Endpoint.policy.applied","Endpoint.policy.applied.id","Endpoint.policy.applied.name","Endpoint.policy.applied.status","Endpoint.status","event.action","event.category","event.code","event.created","event.dataset","event.Ext","event.Ext.correlation","event.Ext.correlation.id","event.hash","event.id","event.ingested","event.module","event.outcome","event.provider","event.sequence","event.severity","event.type","file.accessed","file.attributes","file.created","file.ctime","file.device","file.directory","file.drive_letter","file.Ext","file.Ext.code_signature","file.Ext.code_signature.exists","file.Ext.code_signature.status","file.Ext.code_signature.subject_name","file.Ext.code_signature.trusted","file.Ext.code_signature.valid","file.Ext.entropy","file.Ext.header_data","file.Ext.monotonic_id","file.Ext.original","file.Ext.original.gid","file.Ext.original.group","file.Ext.original.mode","file.Ext.original.name","file.Ext.original.owner","file.Ext.original.path","file.Ext.original.uid","file.Ext.windows","file.Ext.windows.zone_identifier","file.extension","file.gid","file.group","file.hash.md5","file.hash.sha1","file.hash.sha256","file.hash.sha512","file.inode","file.mime_type","file.mode","file.mtime","file.name","file.owner","file.path","file.path.caseless","file.path.text","file.pe.company","file.pe.description","file.pe.file_version","file.pe.imphash","file.pe.original_file_name","file.pe.product","file.size","file.target_path","file.target_path.caseless","file.target_path.text","file.type","file.uid","group.domain","group.Ext","group.Ext.real","group.Ext.real.id","group.Ext.real.name","group.id","group.name","host.architecture","host.domain","host.hostname","host.id","host.ip","host.mac","host.name","host.os.Ext","host.os.Ext.variant","host.os.family","host.os.full","host.os.full.caseless","host.os.full.text","host.os.kernel","host.os.name","host.os.name.caseless","host.os.name.text","host.os.platform","host.os.version","host.type","host.uptime","http.request.body.bytes","http.request.body.content","http.request.body.content.text","http.request.bytes","http.response.body.bytes","http.response.body.content","http.response.body.content.text","http.response.bytes","http.response.Ext","http.response.Ext.version","http.response.status_code","message","network.bytes","network.community_id","network.direction","network.iana_number","network.packets","network.protocol","network.transport","network.type","package.name","process.args","process.args_count","process.code_signature.exists","process.code_signature.status","process.code_signature.subject_name","process.code_signature.trusted","process.code_signature.valid","process.command_line","process.command_line.caseless","process.command_line.text","process.entity_id","process.entry_leader.interactive","process.executable","process.executable.caseless","process.executable.text","process.exit_code","process.Ext","process.Ext.ancestry","process.Ext.authentication_id","process.Ext.code_signature","process.Ext.code_signature.exists","process.Ext.code_signature.status","process.Ext.code_signature.subject_name","process.Ext.code_signature.trusted","process.Ext.code_signature.valid","process.Ext.defense_evasions","process.Ext.session","process.Ext.token.elevation","process.Ext.token.elevation_type","process.Ext.token.integrity_level_name","process.hash.md5","process.hash.sha1","process.hash.sha256","process.hash.sha512","process.name","process.name.caseless","process.name.text","process.parent.args","process.parent.args_count","process.parent.code_signature.exists","process.parent.code_signature.status","process.parent.code_signature.subject_name","process.parent.code_signature.trusted","process.parent.code_signature.valid","process.parent.command_line","process.parent.command_line.caseless","process.parent.command_line.text","process.parent.entity_id","process.parent.executable","process.parent.executable.caseless","process.parent.executable.text","process.parent.exit_code","process.parent.Ext","process.parent.Ext.code_signature","process.parent.Ext.code_signature.exists","process.parent.Ext.code_signature.status","process.parent.Ext.code_signature.subject_name","process.parent.Ext.code_signature.trusted","process.parent.Ext.code_signature.valid","process.parent.Ext.real","process.parent.Ext.real.pid","process.parent.hash.md5","process.parent.hash.sha1","process.parent.hash.sha256","process.parent.hash.sha512","process.parent.name","process.parent.name.caseless","process.parent.name.text","process.parent.pe.company","process.parent.pe.description","process.parent.pe.file_version","process.parent.pe.imphash","process.parent.pe.original_file_name","process.parent.pe.product","process.parent.pgid","process.parent.pid","process.parent.ppid","process.parent.thread.id","process.parent.thread.name","process.parent.title","process.parent.title.text","process.parent.uptime","process.parent.working_directory","process.parent.working_directory.caseless","process.parent.working_directory.text","process.pe.company","process.pe.description","process.pe.file_version","process.pe.imphash","process.pe.original_file_name","process.pe.product","process.pgid","process.pid","process.ppid","process.thread.id","process.thread.name","process.title","process.title.text","process.uptime","process.working_directory","process.working_directory.caseless","process.working_directory.text","registry.data.bytes","registry.data.strings","registry.hive","registry.key","registry.path","registry.value","source.address","source.bytes","source.domain","source.geo.city_name","source.geo.continent_name","source.geo.country_iso_code","source.geo.country_name","source.geo.location","source.geo.name","source.geo.region_iso_code","source.geo.region_name","source.ip","source.packets","source.port","source.registered_domain","source.top_level_domain","user.domain","user.email","user.Ext","user.Ext.real","user.Ext.real.id","user.Ext.real.name","user.full_name","user.full_name.text","user.group.domain","user.group.Ext","user.group.Ext.real","user.group.Ext.real.id","user.group.Ext.real.name","user.group.id","user.group.name","user.hash","user.id","user.name","user.name.text"];var h=a(471);const E=(e,t,a)=>{switch(t){case"endpoint":const t=null!=a&&a.includes("linux")?e=>g.includes(e)||f.includes(e):e=>b.includes(e)||f.includes(e);return{...e,fields:e.fields.filter((({name:e})=>t(e)))};case"endpoint_events":return{...e,fields:e.fields.filter((({name:e})=>y.includes(e)))};default:return e}},v=e=>e.map((e=>({username:e.created_by,timestamp:l()(e.created_at).format("on MMM Do YYYY @ HH:mm:ss"),event:p.b,timelineAvatar:i.a.createElement(r.EuiAvatar,{size:"l",name:e.created_by.toUpperCase()}),children:i.a.createElement(r.EuiText,{size:"s"},e.comment),actions:i.a.createElement(m.a,{"data-test-subj":"copy-to-clipboard",text:e.comment,titleSummary:p.a})}))),x=e=>{const{created_at:t,created_by:a,list_id:n,tie_breaker_id:i,updated_at:r,updated_by:s,...o}=e;return{...o}},k=e=>e.map((e=>{if(void 0!==e.entries){const t=e.entries.map((e=>{const t=Object(s.omit)(e,"id");return{...t,field:t.field.startsWith("event.")?t.field.replace(/^event./,`${h.d}.`):t.field}}));return{...e,entries:t}}return e})),S=(e,t)=>e.map((e=>({...e,comments:t}))),j=e=>({query:{match:{_id:{query:e||""}}}}),O=(e,t)=>e.map((e=>({...e,os_types:t}))),w=e=>{const t=["windows","macos"];if(null!=e){var a,n,i,r,s,o;const l="endpoint"===(null==e||null===(a=e.agent)||void 0===a?void 0:a.type)?null===(n=e.host)||void 0===n||null===(i=n.os)||void 0===i||null===(r=i.name)||void 0===r?void 0:r.toLowerCase():null===(s=e.host)||void 0===s||null===(o=s.os)||void 0===o?void 0:o.family;if(null!=l)return c.C.is(l)?[l]:t}return t},T=e=>e.map((e=>{const t=e.entries.map((e=>{if(e.field.includes(".hash")){if("match"===e.type)return{...e,value:e.value.toLowerCase()};if("match_any"===e.type)return{...e,value:e.value.map((e=>e.toLowerCase()))}}return e}));return{...e,entries:t}})),I=e=>{if(Array.isArray(e)&&e.length>0)return e.map((e=>{var t,a,n;return{subjectName:null!==(t=null==e?void 0:e.subject_name)&&void 0!==t?t:"",trusted:null!==(a=null==e||null===(n=e.trusted)||void 0===n?void 0:n.toString())&&void 0!==a?a:""}}));{var t,a;const n=Array.isArray(e)?void 0:e;return[{subjectName:null!==(t=null==n?void 0:n.subject_name)&&void 0!==t?t:"",trusted:null!==(a=null==n?void 0:n.trusted)&&void 0!==a?a:""}]}};function C(e){const t=[];for(const a of e)void 0!==a.entries?(a.entries=a.entries.filter((e=>void 0!==e.value&&e.value.length>0)),t.push(a)):void 0!==a.value&&a.value.length>0&&t.push(a);return t}const M=({listId:e,name:t,eventCode:a,listNamespace:n="agnostic",alertEcsData:i})=>{var r,s,o,l,c,d;const{process:p}=i,m=C([{field:"Memory_protection.feature",operator:"included",type:"match",value:null!==(r=null===(s=i.Memory_protection)||void 0===s?void 0:s.feature)&&void 0!==r?r:""},{field:"process.executable.caseless",operator:"included",type:"match",value:null!==(o=null==p?void 0:p.executable)&&void 0!==o?o:""},{field:"process.name.caseless",operator:"included",type:"match",value:null!==(l=null==p?void 0:p.name)&&void 0!==l?l:""},{field:"process.hash.sha256",operator:"included",type:"match",value:null!==(c=null==p||null===(d=p.hash)||void 0===d?void 0:d.sha256)&&void 0!==c?c:""}]);return{...Object(u.h)({listId:e,namespaceType:n,name:t}),entries:Object(u.c)(m)}},F=({listId:e,name:t,eventCode:a,listNamespace:n="agnostic",alertEcsData:i})=>{var r,s,o,l,c,d,p,m,g;const{process:b}=i,f=C([{field:"Memory_protection.feature",operator:"included",type:"match",value:null!==(r=null===(s=i.Memory_protection)||void 0===s?void 0:s.feature)&&void 0!==r?r:""},{field:"Memory_protection.self_injection",operator:"included",type:"match",value:null!==(o=String(null===(l=i.Memory_protection)||void 0===l?void 0:l.self_injection))&&void 0!==o?o:""},{field:"process.executable.caseless",operator:"included",type:"match",value:null!==(c=null==b?void 0:b.executable)&&void 0!==c?c:""},{field:"process.name.caseless",operator:"included",type:"match",value:null!==(d=null==b?void 0:b.name)&&void 0!==d?d:""},{field:"process.Ext.token.integrity_level_name",operator:"included",type:"match",value:null!==(p=null==b||null===(m=b.Ext)||void 0===m||null===(g=m.token)||void 0===g?void 0:g.integrity_level_name)&&void 0!==p?p:""}]);return{...Object(u.h)({listId:e,namespaceType:n,name:t}),entries:Object(u.c)(f)}},D=({listId:e,name:t,eventCode:a,listNamespace:n="agnostic",alertEcsData:i})=>{var r,s,o,l,c,d,p,m,g,b,f,y,h,E,v,x,k,S,j,O,w,T,I,M,F,D,A,_,N,R,P,L,B,q,z,$,V,U,H;const{process:G}=i,Q=C([{field:"rule.id",operator:"included",type:"match",value:null!==(r=null===(s=i.rule)||void 0===s?void 0:s.id)&&void 0!==r?r:""},{field:"process.executable.caseless",operator:"included",type:"match",value:null!==(o=null==G?void 0:G.executable)&&void 0!==o?o:""},{field:"process.command_line",operator:"included",type:"match",value:null!==(l=null==G?void 0:G.command_line)&&void 0!==l?l:""},{field:"process.parent.executable",operator:"included",type:"match",value:null!==(c=null==G||null===(d=G.parent)||void 0===d?void 0:d.executable)&&void 0!==c?c:""},{field:"process.code_signature.subject_name",operator:"included",type:"match",value:null!==(p=null==G||null===(m=G.code_signature)||void 0===m?void 0:m.subject_name)&&void 0!==p?p:""},{field:"file.path",operator:"included",type:"match",value:null!==(g=null===(b=i.file)||void 0===b?void 0:b.path)&&void 0!==g?g:""},{field:"file.name",operator:"included",type:"match",value:null!==(f=null===(y=i.file)||void 0===y?void 0:y.name)&&void 0!==f?f:""},{field:"source.ip",operator:"included",type:"match",value:null!==(h=null===(E=i.source)||void 0===E?void 0:E.ip)&&void 0!==h?h:""},{field:"destination.ip",operator:"included",type:"match",value:null!==(v=null===(x=i.destination)||void 0===x?void 0:x.ip)&&void 0!==v?v:""},{field:"registry.path",operator:"included",type:"match",value:null!==(k=null===(S=i.registry)||void 0===S?void 0:S.path)&&void 0!==k?k:""},{field:"registry.value",operator:"included",type:"match",value:null!==(j=null===(O=i.registry)||void 0===O?void 0:O.value)&&void 0!==j?j:""},{field:"registry.data.strings",operator:"included",type:"match",value:null!==(w=null===(T=i.registry)||void 0===T||null===(I=T.data)||void 0===I?void 0:I.strings)&&void 0!==w?w:""},{field:"dll.path",operator:"included",type:"match",value:null!==(M=null===(F=i.dll)||void 0===F?void 0:F.path)&&void 0!==M?M:""},{field:"dll.code_signature.subject_name",operator:"included",type:"match",value:null!==(D=null===(A=i.dll)||void 0===A||null===(_=A.code_signature)||void 0===_?void 0:_.subject_name)&&void 0!==D?D:""},{field:"dll.pe.original_file_name",operator:"included",type:"match",value:null!==(N=null===(R=i.dll)||void 0===R||null===(P=R.pe)||void 0===P?void 0:P.original_file_name)&&void 0!==N?N:""},{field:"dns.question.name",operator:"included",type:"match",value:null!==(L=null===(B=i.dns)||void 0===B||null===(q=B.question)||void 0===q?void 0:q.name)&&void 0!==L?L:""},{field:"dns.question.type",operator:"included",type:"match",value:null!==(z=null===($=i.dns)||void 0===$||null===(V=$.question)||void 0===V?void 0:V.type)&&void 0!==z?z:""},{field:"user.id",operator:"included",type:"match",value:null!==(U=null===(H=i.user)||void 0===H?void 0:H.id)&&void 0!==U?U:""}]);return{...Object(u.h)({listId:e,namespaceType:n,name:t}),entries:Object(u.c)(Q)}},A=(e,t,a)=>{var n,i;const r=null!==(n=a["event.code"])&&void 0!==n?n:null===(i=a.event)||void 0===i?void 0:i.code;switch(r){case"behavior":return[D({listId:e,name:t,eventCode:r,alertEcsData:a})];case"memory_signature":return[M({listId:e,name:t,eventCode:r,alertEcsData:a})];case"shellcode_thread":return[F({listId:e,name:t,eventCode:r,alertEcsData:a})];case"ransomware":return(e=>{const{process:t}=e,a=t&&t.Ext&&t.Ext.code_signature;return I(a)})(a).map((n=>(({listId:e,name:t,codeSignature:a,eventCode:n,listNamespace:i="agnostic",alertEcsData:r})=>{var s,o,l,c;const{process:d,Ransomware:p}=r,m=null!==(s=null==d||null===(o=d.hash)||void 0===o?void 0:o.sha256)&&void 0!==s?s:"",g=null!==(l=null==d?void 0:d.executable)&&void 0!==l?l:"",b=null!==(c=null==p?void 0:p.feature)&&void 0!==c?c:"";return{...Object(u.h)({listId:e,namespaceType:i,name:t}),entries:Object(u.c)([{field:"process.Ext.code_signature",type:"nested",entries:[{field:"subject_name",operator:"included",type:"match",value:null!=a?a.subjectName:""},{field:"trusted",operator:"included",type:"match",value:null!=a?a.trusted:""}]},{field:"process.executable",operator:"included",type:"match",value:null!=g?g:""},{field:"process.hash.sha256",operator:"included",type:"match",value:null!=m?m:""},{field:"Ransomware.feature",operator:"included",type:"match",value:null!=b?b:""},{field:"event.code",operator:"included",type:"match",value:null!=n?n:""}])}})({listId:e,name:t,eventCode:r,codeSignature:n,alertEcsData:a})));default:return(e=>{const{file:t}=e,a=t&&t.Ext&&t.Ext.code_signature;return I(a)})(a).map((n=>(({listId:e,name:t,codeSignature:a,eventCode:n,listNamespace:i="agnostic",alertEcsData:r})=>{var s,o,l,c;const{file:d,host:p}=r,m=null!==(s=null==d?void 0:d.path)&&void 0!==s?s:"",g=null!==(o=null==d||null===(l=d.hash)||void 0===l?void 0:l.sha256)&&void 0!==o?o:"",b="Linux"===(null==p||null===(c=p.os)||void 0===c?void 0:c.name),f=[{field:b?"file.path":"file.path.caseless",operator:"included",type:"match",value:null!=m?m:""},{field:"file.hash.sha256",operator:"included",type:"match",value:null!=g?g:""},{field:"event.code",operator:"included",type:"match",value:null!=n?n:""}];return{...Object(u.h)({listId:e,namespaceType:i,name:t}),entries:b?Object(u.c)(f):Object(u.c)([{field:"file.Ext.code_signature",type:"nested",entries:[{field:"subject_name",operator:"included",type:"match",value:null!=a?a.subjectName:""},{field:"trusted",operator:"included",type:"match",value:null!=a?a.trusted:""}]},...f])}})({listId:e,name:t,eventCode:null!=r?r:"",codeSignature:n,alertEcsData:a})))}},_=(e,t)=>e.map((e=>({...e,name:t}))),N=e=>e.map((e=>({...Object(d.a)(e),list_id:void 0,namespace_type:"single"}))),R=(e,t)=>t.flatMap((t=>e.map((e=>({...Object(d.a)(e),list_id:t.list_id,namespace_type:t.namespace_type})))))},,,,function(e,t,a){"use strict";a.d(t,"j",(function(){return i})),a.d(t,"i",(function(){return r})),a.d(t,"k",(function(){return s})),a.d(t,"c",(function(){return o})),a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return c})),a.d(t,"l",(function(){return u})),a.d(t,"g",(function(){return d})),a.d(t,"m",(function(){return p})),a.d(t,"e",(function(){return m})),a.d(t,"h",(function(){return g})),a.d(t,"d",(function(){return b})),a.d(t,"o",(function(){return f})),a.d(t,"n",(function(){return y})),a.d(t,"f",(function(){return h}));var n=a(0);const i=n.i18n.translate("xpack.securitySolution.visualizationActions.moreActions",{defaultMessage:"More actions"}),r=n.i18n.translate("xpack.securitySolution.visualizationActions.inspect",{defaultMessage:"Inspect"}),s=n.i18n.translate("xpack.securitySolution.visualizationActions.openInLens",{defaultMessage:"Open in Lens"}),o=n.i18n.translate("xpack.securitySolution.visualizationActions.addToNewCase",{defaultMessage:"Add to new case"}),l=n.i18n.translate("xpack.securitySolution.visualizationActions.addToExistingCase",{defaultMessage:"Add to existing case"}),c=n.i18n.translate("xpack.securitySolution.visualizationActions.addToCaseSuccessContent",{defaultMessage:"Successfully added visualization to the case"}),u=n.i18n.translate("xpack.securitySolution.visualizationActions.uniqueIps.sourceChartLabel",{defaultMessage:"Src."}),d=n.i18n.translate("xpack.securitySolution.visualizationActions.uniqueIps.destinationChartLabel",{defaultMessage:"Dest."}),p=n.i18n.translate("xpack.securitySolution.visualizationActions.userAuthentications.successChartLabel",{defaultMessage:"Succ."}),m=n.i18n.translate("xpack.securitySolution.visualizationActions.userAuthentications.authentication.successChartLabel",{defaultMessage:"Success"}),g=n.i18n.translate("xpack.securitySolution.visualizationActions.userAuthentications.failChartLabel",{defaultMessage:"Fail"}),b=n.i18n.translate("xpack.securitySolution.visualizationActions.userAuthentications.authentication.failureChartLabel",{defaultMessage:"Failure"}),f=e=>n.i18n.translate("xpack.securitySolution.visualizationActions.uniqueCountLabel",{values:{field:e},defaultMessage:"Unique count of {field}"}),y=e=>n.i18n.translate("xpack.securitySolution.visualizationActions.topValueLabel",{values:{field:e},defaultMessage:"Top values of {field}"}),h=n.i18n.translate("xpack.securitySolution.visualizationActions.countLabel",{defaultMessage:"Count of records"})},function(e,t,a){"use strict";a.d(t,"g",(function(){return c})),a.d(t,"a",(function(){return P})),a.d(t,"f",(function(){return B})),a.d(t,"c",(function(){return $})),a.d(t,"b",(function(){return Ge})),a.d(t,"h",(function(){return Ke})),a.d(t,"i",(function(){return u})),a.d(t,"d",(function(){return pt})),a.d(t,"e",(function(){return _e})),a.d(t,"j",(function(){return qe}));var n=a(4),i=a.n(n),r=a(32),s=a(36),o={strict:!0,fields:{created_by:{type:"string"},description:{type:"string"},id:{type:"string"},item_id:{type:"string"},list_id:{type:"string"},name:{type:"string"},os_types:{type:"string"},tags:{type:"string"}}},l=function(e){var t=e.addExceptionButtonText,a=e.placeholdertext,i=e.canAddException,l=e.listType,c=e.isSearching,u=e.dataTestSubj,d=e.filters,p=void 0===d?[]:d,m=e.isButtonFilled,g=void 0===m||m,b=e.buttonIconType,f=e.onSearch,y=e.onAddExceptionClick,h=Object(n.useCallback)((function(e){var t=e.queryText;f({search:t})}),[f]),E=Object(n.useCallback)((function(){y(l)}),[y,l]);return Object(s.jsx)(r.EuiFlexGroup,{alignItems:"center"},Object(s.jsx)(r.EuiFlexItem,{grow:!0},Object(s.jsx)(r.EuiSearchBar,{box:{placeholder:a,incremental:!1,schema:o,"data-test-subj":"".concat(u||"","searchBar")},filters:p,onChange:h})),!i&&Object(s.jsx)(r.EuiFlexItem,{grow:!1},Object(s.jsx)(r.EuiButton,{"data-test-subj":"".concat(u||"","Button"),onClick:E,isDisabled:c,fill:g,iconType:b},t)))};l.displayName="SearchBarComponent";var c=i.a.memo(l);c.displayName="SearchBar";var u,d,p=a(40);!function(e){e.ERROR="error",e.EMPTY="empty",e.EMPTY_SEARCH="empty_search",e.LOADING="loading",e.SEARCHING="searching",e.DELETING="deleting"}(u||(u={})),function(e){e.ENDPOINT="endpoint",e.DETECTION="empty",e.RULE_DEFAULT="empty_search"}(d||(d={}));var m=a(0),g=m.i18n.translate("exceptionList-components.empty.viewer.state.empty.title",{defaultMessage:"Add exceptions to this list"}),b=m.i18n.translate("exceptionList-components.empty.viewer.state.empty.body",{defaultMessage:"There is no exception in your list. Create your first exception."}),f=m.i18n.translate("exceptionList-components.empty.viewer.state.empty_search.search.title",{defaultMessage:"No results match your search criteria"}),y=m.i18n.translate("exceptionList-components.empty.viewer.state.empty_search.body",{defaultMessage:"Try modifying your search"}),h=m.i18n.translate("exceptionList-components.empty.viewer.state.error_title",{defaultMessage:"Unable to load exception items"}),E=m.i18n.translate("exceptionList-components.empty.viewer.state.error_body",{defaultMessage:"There was an error loading the exception items. Contact your administrator for help."}),v=m.i18n.translate("exceptionList-components.exception_list_header_export_action",{defaultMessage:"Export exception list"}),x=m.i18n.translate("exceptionList-components.exception_list_header_delete_action",{defaultMessage:"Delete exception list"}),k=m.i18n.translate("exceptionList-components.exception_list_header_manage_rules_button",{defaultMessage:"Manage rules"}),S=function(e){return m.i18n.translate("exceptionList-components.exception_list_header_linked_rules",{values:{noOfRules:e},defaultMessage:"Linked to {noOfRules} rules"})},j=m.i18n.translate("exceptionList-components.exception_list_header_breadcrumb",{defaultMessage:"Rule exceptions"}),O=m.i18n.translate("exceptionList-components.exception_list_header_list_id",{defaultMessage:"List ID"}),w=m.i18n.translate("exceptionList-components.exception_list_header_name",{defaultMessage:"Add a name"}),T=m.i18n.translate("exceptionList-components.exception_list_header_description",{defaultMessage:"Add a description"}),I=m.i18n.translate("exceptionList-components.exception_list_header_edit_modal_save_button",{defaultMessage:"Save"}),C=m.i18n.translate("exceptionList-components.exception_list_header_edit_modal_cancel_button",{defaultMessage:"Cancel"}),M=m.i18n.translate("exceptionList-components.exception_list_header_Name_textbox",{defaultMessage:"Name"}),F=m.i18n.translate("exceptionList-components.exception_list_header_description_textbox",{defaultMessage:"Description (optional)"}),D=m.i18n.translate("exceptionList-components.exception_list_header_description_textboxexceptionList-components.exception_list_header_name_required_eror",{defaultMessage:"List name cannot be empty"}),A=a(968),_=a.n(A),N=Object(s.css)("margin:",p.euiThemeVars.euiSizeL," 0;padding:",p.euiThemeVars.euiSizeL," 0;",""),R=function(e){var t=e.title,a=e.body,i=e.buttonText,o=e.listType,l=e.isReadOnly,c=e.viewerStatus,d=e.onCreateExceptionListItem,p=Object(r.useEuiTheme)().euiTheme,v=Object(n.useMemo)((function(){switch(c){case u.ERROR:return{color:"danger",iconType:"alert",title:Object(s.jsx)("h2",{"data-test-subj":"errorTitle"},t||h),body:Object(s.jsx)("p",{"data-test-subj":"errorBody"},a||E),"data-test-subj":"errorViewerState"};case u.EMPTY:return{color:"subdued",iconType:"plusInCircle",iconColor:p.colors.darkestShade,title:Object(s.jsx)("h2",{"data-test-subj":"emptyTitle"},t||g),body:Object(s.jsx)("p",{"data-test-subj":"emptyBody"},a||b),"data-test-subj":"emptyViewerState",actions:[Object(s.jsx)(r.EuiButton,{"data-test-subj":"emptyStateButton",onClick:d,iconType:"plusInCircle",color:"primary",isDisabled:l,fill:!0},i||(e=o||"rule",m.i18n.translate("exceptionList-components.empty.viewer.state.empty.viewer_button",{values:{exceptionType:e},defaultMessage:"Create {exceptionType} exception"})))]};case u.EMPTY_SEARCH:return{color:"plain",layout:"horizontal",hasBorder:!0,hasShadow:!1,icon:Object(s.jsx)(r.EuiImage,{size:"fullWidth",alt:"",src:_.a}),title:Object(s.jsx)("h3",{"data-test-subj":"emptySearchTitle"},t||f),body:Object(s.jsx)("p",{"data-test-subj":"emptySearchBody"},a||y),"data-test-subj":"emptySearchViewerState"}}var e}),[c,p.colors.darkestShade,t,a,d,l,i,o]);return c===u.LOADING||c===u.SEARCHING?Object(s.jsx)(r.EuiLoadingContent,{lines:4,"data-test-subj":"loadingViewerState"}):Object(s.jsx)(r.EuiPanel,{css:N,color:"empty_search"===c?"subdued":"transparent"},Object(s.jsx)(r.EuiEmptyPrompt,v))},P=i.a.memo(R);P.displayName="EmptyViewerState";var L=function(e){var t=e.dataTestSubj,a=e.ariaLabel,i=function(e){var t=e.pagination,a=e.onPaginationChange,i=t.pageIndex,r=t.totalItemCount,s=t.pageSize,o=t.pageSizeOptions,l=Object(n.useMemo)((function(){return isFinite(r/s)?Math.ceil(r/s):0}),[s,r]),c=Object(n.useCallback)((function(e){a({pagination:{pageIndex:i,pageSize:e,totalItemCount:r}})}),[i,r,a]),u=Object(n.useCallback)((function(e){a({pagination:{pageIndex:e,pageSize:s,totalItemCount:r}})}),[s,r,a]);return{pageCount:l,pageIndex:i,pageSize:s,pageSizeOptions:o,handleItemsPerPageChange:c,handlePageIndexChange:u}}({pagination:e.pagination,onPaginationChange:e.onPaginationChange}),o=i.pageIndex,l=i.pageCount,c=i.pageSize,u=i.pageSizeOptions,d=i.handleItemsPerPageChange,p=i.handlePageIndexChange;return Object(s.jsx)(r.EuiTablePagination,{"data-test-subj":t,"aria-label":a,pageCount:l,activePage:o,itemsPerPage:c,onChangePage:p,onChangeItemsPerPage:d,itemsPerPageOptions:u})};L.displayName="PaginationComponent";var B=i.a.memo(L);B.displayName="Pagination";var q=Object(s.css)("margin:",p.euiThemeVars.euiSize," 0;&div:first-child{margin:",p.euiThemeVars.euiSizeXS," 0 ",p.euiThemeVars.euiSize,";}",""),z=function(e){var t=e.lastUpdated,a=e.viewerStatus,n=e.isReadOnly,o=e.exceptions,l=e.listType,c=e.ruleReferences,u=e.emptyViewerTitle,d=e.emptyViewerBody,p=e.emptyViewerButtonText,m=e.pagination,g=e.dataTestSubj,b=e.editActionLabel,f=e.deleteActionLabel,y=e.securityLinkAnchorComponent,h=e.exceptionsUtilityComponent,E=e.formattedDateComponent,v=e.getFormattedComments,x=e.onPaginationChange,k=e.onDeleteException,S=e.onEditExceptionItem,j=e.onCreateExceptionListItem,O=h;return!o.length||a?Object(s.jsx)(P,{isReadOnly:n,title:u,viewerStatus:a,buttonText:p,body:d,onCreateExceptionListItem:j}):Object(s.jsx)(i.a.Fragment,null,Object(s.jsx)(O,{pagination:m,lastUpdated:t}),Object(s.jsx)(r.EuiFlexGroup,{direction:"column",gutterSize:"none",className:"eui-yScrollWithShadows"},Object(s.jsx)(r.EuiFlexItem,{grow:!1},Object(s.jsx)(r.EuiFlexGroup,{css:q,"data-test-subj":"".concat(g||"","exceptionsContainer"),direction:"column",gutterSize:"s"},o.map((function(e){return Object(s.jsx)(r.EuiFlexItem,{"data-test-subj":"".concat(g||"","exceptionItemContainer"),grow:!1,key:e.id},Object(s.jsx)(Ge,{key:"".concat(e.id,"exceptionItemCardKey"),dataTestSubj:"".concat(g||"","exceptionItemCard"),disableActions:n,exceptionItem:e,listType:l,ruleReferences:Object.keys(c).length&&c[e.list_id]?c[e.list_id].referenced_rules:[],editActionLabel:b,deleteActionLabel:f,onDeleteException:k,onEditException:S,securityLinkAnchorComponent:y,formattedDateComponent:E,getFormattedComments:v}))}))))),Object(s.jsx)(B,{dataTestSubj:"".concat(g||"","pagination"),pagination:m,onPaginationChange:x}))};z.displayName="ExceptionItemsComponent";var $=i.a.memo(z);$.displayName="ExceptionsItems";var V,U,H=a(349),G=Object(s.css)("margin-left:",p.euiThemeVars.euiSizeXL,";margin-bottom:",p.euiThemeVars.euiSizeXS,";padding-top:",p.euiThemeVars.euiSizeXS,";",""),Q=Object(H.cx)("eui-xScroll","\n  border: 1px;\n  border-color: #d3dae6;\n  border-style: solid;\n"),W=Object(s.css)("display:flex;align-items:center;margin-left:",p.euiThemeVars.euiSizeS,";",""),K={name:"s5xdrg",styles:"display:flex;align-items:center"},Y=function(e){return m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.editItemButton",{values:{listType:e},defaultMessage:"Edit {listType} exception"})},J=function(e){return m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.deleteItemButton",{values:{listType:e},defaultMessage:"Delete {listType} exception"})},X=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.createdLabel",{defaultMessage:"Created"}),Z=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.updatedLabel",{defaultMessage:"Updated"}),ee=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.metaDetailsBy",{defaultMessage:"by"}),te=function(e){return m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.showCommentsLabel",{values:{comments:e},defaultMessage:"Show {comments, plural, =1 {comment} other {comments}} ({comments})"})},ae=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.matchOperator",{defaultMessage:"IS"}),ne=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.matchOperator.not",{defaultMessage:"IS NOT"}),ie=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.wildcardMatchesOperator",{defaultMessage:"MATCHES"}),re=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.wildcardDoesNotMatchOperator",{defaultMessage:"DOES NOT MATCH"}),se=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.nestedOperator",{defaultMessage:"has"}),oe=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.matchAnyOperator",{defaultMessage:"is one of"}),le=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.matchAnyOperator.not",{defaultMessage:"is not one of"}),ce=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.existsOperator",{defaultMessage:"exists"}),ue=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.existsOperator.not",{defaultMessage:"does not exist"}),de=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.listOperator",{defaultMessage:"included in"}),pe=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.listOperator.not",{defaultMessage:"is not included in"}),me=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.and",{defaultMessage:"AND"}),ge=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.os",{defaultMessage:"OS"}),be=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.windows",{defaultMessage:"Windows"}),fe=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.linux",{defaultMessage:"Linux"}),ye=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.macos",{defaultMessage:"Mac"}),he=a(6),Ee=a.n(he),ve=a(93),xe=Object.freeze({linux:fe,mac:ye,macos:ye,windows:be}),ke=Object.freeze((V={},Ee()(V,ve.d.NESTED,se),Ee()(V,ve.d.MATCH_ANY,oe),Ee()(V,ve.d.MATCH,ae),Ee()(V,ve.d.WILDCARD,ie),Ee()(V,ve.d.EXISTS,ce),Ee()(V,ve.d.LIST,de),V)),Se=Object.freeze((U={},Ee()(U,ve.d.MATCH_ANY,le),Ee()(U,ve.d.MATCH,ne),Ee()(U,ve.d.WILDCARD,re),Ee()(U,ve.d.EXISTS,ue),Ee()(U,ve.d.LIST,pe),U)),je=function(e,t){return"match_any"===e&&Array.isArray(t)?t.map((function(e,t){return Object(s.jsx)(r.EuiBadge,{key:t,"data-test-subj":"matchAnyBadge".concat(t),color:"hollow"},e)})):null!=t?t:""},Oe=function(e,t){var a,n;return"nested"===e?"":"included"===t?null!==(a=ke[e])&&void 0!==a?a:e:null!==(n=Se[e])&&void 0!==n?n:e},we=function(e,t,a){return Object(s.jsx)(i.a.Fragment,null,Object(s.jsx)(r.EuiExpression,{description:Oe(e,t),value:je(e,a),"data-test-subj":"entryValueExpression"}),Object(s.jsx)(Ke,{value:a}))},Te=Object(n.memo)((function(e){var t=e.entry,a=e.index,n=e.isNestedEntry,o=void 0!==n&&n,l=e.dataTestSubj,c=t.field,u=t.type,d=function(e){return"list"===e.type?e.list.id:"value"in e?e.value:""}(t),p="operator"in t?t.operator:"",m="".concat(c).concat(u).concat(d).concat(a);return Object(s.jsx)("div",{"data-test-subj":"".concat(l||"").concat(m,"EntryContent"),key:m},Object(s.jsx)("div",{css:K},o?Object(s.jsx)(r.EuiFlexGroup,{responsive:!0,css:G,direction:"row",alignItems:"center",gutterSize:"m","data-test-subj":"".concat(l||"","NestedEntry")},Object(s.jsx)(r.EuiToken,{"data-test-subj":"nstedEntryIcon",iconType:"tokenNested",size:"s"}),Object(s.jsx)("div",{css:W},Object(s.jsx)(r.EuiExpression,{description:"",value:c,color:"subdued"}),we(u,p,d))):Object(s.jsx)(i.a.Fragment,null,Object(s.jsx)(r.EuiExpression,{description:0===a?"":me,value:c,color:0===a?"primary":"subdued","data-test-subj":"".concat(l||"","SingleEntry")}),we(u,p,d))))}));Te.displayName="EntryContent";var Ie=Object(n.memo)((function(e){var t=e.os,a=e.dataTestSubj,i=Object(n.useMemo)((function(){return t.map((function(e){var t;return null!==(t=xe[e])&&void 0!==t?t:e})).join(", ")}),[t]);return i?Object(s.jsx)("div",{"data-test-subj":"".concat(a||"","Os")},Object(s.jsx)("strong",null,Object(s.jsx)(r.EuiExpression,{"data-test-subj":"osLabel",description:"",value:ge}),Object(s.jsx)(r.EuiExpression,{"data-test-subj":"osValue",description:ae,value:i}))):null}));Ie.displayName="OsCondition";var Ce=Object(n.memo)((function(e){var t=e.os,a=e.entries,n=e.dataTestSubj;return Object(s.jsx)(r.EuiPanel,{color:"subdued",hasBorder:!0,hasShadow:!1,"data-test-subj":n,className:Q},null!=t&&t.length?Object(s.jsx)(Ie,{os:t,dataTestSubj:n}):null,a.map((function(e,t){var a="entries"in e?e.entries:[];return Object(s.jsx)("div",{key:"ExceptionItemCardConditionsContainer".concat(t)},Object(s.jsx)(Te,{key:"entry".concat(t),entry:e,index:t,dataTestSubj:n}),null!=a&&a.length?a.map((function(e,a){return Object(s.jsx)(Te,{key:"nestedEntry".concat(t).concat(a),entry:e,index:a,isNestedEntry:!0,dataTestSubj:n})})):null)})))}));Ce.displayName="ExceptionItemCardConditions";var Me=a(147),Fe=a.n(Me),De={name:"qeawqx",styles:"max-height:300px;height:100%;overflow-x:hidden;overflow-y:auto"},Ae=function(e){var t=e.text,a=e.dataTestSubj,i=e.actions,o=e.disableActions,l=e.emptyButton,c=e.useCustomActions,u=e.iconType,d=e.iconSide,p=void 0===d?"left":d,m=e.anchorPosition,g=void 0===m?"downCenter":m,b=e.panelPaddingSize,f=void 0===b?"s":b,y=Object(n.useState)(!1),h=Fe()(y,2),E=h[0],v=h[1],x=function(){return v((function(e){return!e}))},k=function(){return v(!1)},S=Object(n.useMemo)((function(){return c||null===i?i:i.map((function(e){return Object(s.jsx)(r.EuiContextMenuItem,{"data-test-subj":"".concat(a||"","ActionItem").concat(e.key),key:e.key,icon:e.icon,disabled:e.disabled,layoutAlign:"center",onClick:function(t){k(),"function"==typeof e.onClick&&e.onClick(t)}},e.label)}))}),[i,a,c]);return Object(s.jsx)(r.EuiFlexGroup,{responsive:!0},Object(s.jsx)(r.EuiPopover,{button:l?Object(s.jsx)(r.EuiButtonEmpty,{isDisabled:o,onClick:x,iconType:u||void 0,iconSide:p,"data-test-subj":"".concat(a||"","EmptyButton"),"aria-label":"Header menu Button Empty"},t):Object(s.jsx)(r.EuiButtonIcon,{isDisabled:o,onClick:x,iconType:u||"boxesHorizontal","data-test-subj":"".concat(a||"","ButtonIcon"),"aria-label":"Header menu Button Icon"},t),onClick:function(e){return e.stopPropagation()},panelPaddingSize:f,isOpen:E,closePopover:k,anchorPosition:g,"data-test-subj":"".concat(a||"","Items")},S?Object(s.jsx)(r.EuiContextMenuPanel,{css:De,className:"eui-scrollBar","data-test-subj":"".concat(a||"","MenuPanel"),size:"s",items:S}):null))};Ae.displayName="HeaderMenuComponent";var _e=i.a.memo(Ae);_e.displayName="HeaderMenu";var Ne=Object(n.memo)((function(e){var t=e.item,a=e.actions,n=e.disableActions,i=void 0!==n&&n,o=e.dataTestSubj;return Object(s.jsx)(r.EuiFlexGroup,{responsive:!0,"data-test-subj":o,justifyContent:"spaceBetween"},Object(s.jsx)(r.EuiFlexItem,{grow:9},Object(s.jsx)(r.EuiTitle,{size:"xs",textTransform:"uppercase","data-test-subj":"".concat(o,"Title")},Object(s.jsx)("h3",null,t.name))),Object(s.jsx)(r.EuiFlexItem,{grow:!1},Object(s.jsx)(_e,{iconType:"boxesHorizontal",disableActions:i,actions:a,"aria-label":"Exception item actions menu",dataTestSubj:o,anchorPosition:"downCenter"})))}));Ne.displayName="ExceptionItemCardHeader";var Re=Object(s.css)("font-family:",p.euiThemeVars.euiFontFamily,";",""),Pe=Object(n.memo)((function(e){var t=e.label,a=e.lastUpdate,n=e.lastUpdateValue,i=e.dataTestSubj;return Object(s.jsx)(r.EuiFlexGroup,{"data-test-subj":"".concat(i||"","metaInfoDetails"),alignItems:"center",gutterSize:"s",wrap:!0,responsive:!0},Object(s.jsx)(r.EuiFlexItem,{grow:!1},Object(s.jsx)(r.EuiText,{size:"xs",css:Re},t)),Object(s.jsx)(r.EuiFlexItem,{grow:!1,"data-test-subj":"".concat(i||"","lastUpdate")},Object(s.jsx)(r.EuiBadge,{color:"default",css:Re},a)),Object(s.jsx)(r.EuiFlexItem,{grow:!1},Object(s.jsx)(r.EuiText,{size:"xs",css:Re},ee)),Object(s.jsx)(r.EuiFlexItem,{grow:!1,"data-test-subj":"".concat(i||"","lastUpdateValue")},Object(s.jsx)(r.EuiFlexGroup,{responsive:!0,gutterSize:"xs",alignItems:"center"},Object(s.jsx)(r.EuiFlexItem,{grow:!1},Object(s.jsx)(r.EuiBadge,{color:"hollow",css:Re},n)))))}));Pe.displayName="MetaInfoDetails";var Le=Object(s.css)("border-bottom:1px solid ",p.euiThemeVars.euiColorLightShade,";",""),Be=Object(s.css)("color:",p.euiThemeVars.euiColorPrimary,";flex-basis:content;",""),qe=function(e){var t=e.dataTestSubj,a=e.linkedRules,n=e.securityLinkAnchorComponent,i=e.leftIcon,o=void 0===i?"":i;if(!a.length||null===n)return null;var l=n;return a.map((function(e){return Object(s.jsx)(r.EuiContextMenuItem,{css:a.length>1?Le:"","data-test-subj":"".concat(t||"","ActionItem").concat(e.id),key:e.id},Object(s.jsx)(r.EuiFlexGroup,{gutterSize:"s",css:Be},o?Object(s.jsx)(r.EuiFlexItem,{"data-test-subj":"".concat(t||"","LeftIcon"),grow:!1},Object(s.jsx)(r.EuiIcon,{type:o})):null,Object(s.jsx)(r.EuiFlexItem,{css:Be},Object(s.jsx)(l,{external:!0,referenceName:e.name,referenceId:e.id}))))}))},ze=Object(s.css)("border-right:1px solid #d3dae6;padding:",p.euiThemeVars.euiSizeS," ",p.euiThemeVars.euiSizeM," ",p.euiThemeVars.euiSizeS," 0;",""),$e=Object(n.memo)((function(e){var t,a=e.item,o=e.rules,l=e.dataTestSubj,c=e.securityLinkAnchorComponent,u=e.formattedDateComponent,d=Object(n.useMemo)((function(){return qe({dataTestSubj:l,linkedRules:o,securityLinkAnchorComponent:c})}),[l,o,c]);return Object(s.jsx)(r.EuiFlexGroup,{alignItems:"center",responsive:!0,gutterSize:"s","data-test-subj":l},null!==u&&Object(s.jsx)(i.a.Fragment,null,Object(s.jsx)(r.EuiFlexItem,{css:ze,grow:!1},Object(s.jsx)(Pe,{label:X,lastUpdate:Object(s.jsx)(u,{"data-test-subj":"{dataTestSubj||''}formattedDateComponentCreatedBy",fieldName:"created_at",value:a.created_at}),lastUpdateValue:a.created_by,dataTestSubj:"".concat(l||"","CreatedBy")})),Object(s.jsx)(r.EuiFlexItem,{css:ze,grow:!1},Object(s.jsx)(Pe,{label:Z,lastUpdate:Object(s.jsx)(u,{"data-test-subj":"{dataTestSubj||''}formattedDateComponentUpdatedBy",fieldName:"updated_at",value:a.updated_at}),lastUpdateValue:a.updated_by,dataTestSubj:"".concat(l||"","UpdatedBy")}))),Object(s.jsx)(r.EuiFlexItem,null,Object(s.jsx)(_e,{emptyButton:!0,useCustomActions:!0,iconType:"list",actions:d,disableActions:!1,text:(t=o.length,m.i18n.translate("exceptionList-components.exceptions.card.exceptionItem.affectedRules",{values:{numRules:t},defaultMessage:"Affects {numRules} {numRules, plural, =1 {rule} other {rules}}"})),dataTestSubj:l})))}));$e.displayName="ExceptionItemCardMetaInfo";var Ve=Object(s.css)("color:",p.euiThemeVars.euiColorPrimary,";",""),Ue=Object(n.memo)((function(e){var t=e.comments,a=e.dataTestSubj;return t.length?Object(s.jsx)(r.EuiFlexItem,{"data-test-subj":a},Object(s.jsx)(r.EuiAccordion,{id:"exceptionItemCardComments",buttonContent:Object(s.jsx)(r.EuiText,{size:"s",css:Ve,"data-test-subj":"".concat(a||"","TextButton")},te(t.length)),arrowDisplay:"none","data-test-subj":"exceptionItemCardComments"},Object(s.jsx)(r.EuiPanel,{"data-test-subj":"accordionContentPanel",hasBorder:!0,hasShadow:!0,paddingSize:"m"},Object(s.jsx)(r.EuiCommentList,{"data-test-subj":"accordionCommentList",comments:t})))):null}));Ue.displayName="ExceptionItemCardComments";var He=function(e){var t=e.disableActions,a=void 0!==t&&t,i=e.exceptionItem,o=e.listType,l=e.ruleReferences,c=e.dataTestSubj,u=e.editActionLabel,d=e.deleteActionLabel,p=e.securityLinkAnchorComponent,m=e.formattedDateComponent,g=e.getFormattedComments,b=e.onDeleteException,f=function(e){var t=e.listType,a=e.editActionLabel,i=e.deleteActionLabel,r=e.exceptionItem,s=e.getFormattedComments,o=e.onEditException,l=e.onDeleteException,c=Object(n.useCallback)((function(){l({id:r.id,name:r.name,namespaceType:r.namespace_type})}),[l,r.id,r.name,r.namespace_type]),u=Object(n.useCallback)((function(){o(r)}),[o,r]),d=Object(n.useMemo)((function(){return s(r.comments)}),[r.comments,s]);return{actions:Object(n.useMemo)((function(){return[{key:"edit",icon:"controlsHorizontal",label:a||Y(t),onClick:u},{key:"delete",icon:"trash",label:i||J(t),onClick:c}]}),[a,t,i,c,u]),formattedComments:d}}({listType:o,editActionLabel:u,deleteActionLabel:d,exceptionItem:i,getFormattedComments:g,onEditException:e.onEditException,onDeleteException:b}),y=f.actions,h=f.formattedComments;return Object(s.jsx)(r.EuiPanel,{key:"".concat(i.id,"exceptionItemPanel"),paddingSize:"l","data-test-subj":c||"",hasBorder:!0,hasShadow:!1},Object(s.jsx)(r.EuiFlexGroup,{responsive:!0,gutterSize:"m",direction:"column"},Object(s.jsx)(r.EuiFlexItem,{"data-test-subj":"exceptionItemCardHeaderContainer"},Object(s.jsx)(Ne,{item:i,actions:y,disableActions:a,dataTestSubj:"exceptionItemCardHeader"})),Object(s.jsx)(r.EuiFlexItem,{"data-test-subj":"exceptionItemCardMeta"},Object(s.jsx)($e,{item:i,rules:l,dataTestSubj:"exceptionItemCardMetaInfo",securityLinkAnchorComponent:p,formattedDateComponent:m})),Object(s.jsx)(r.EuiFlexItem,{"data-test-subj":"exceptionItemCardCondition"},Object(s.jsx)(Ce,{os:i.os_types,entries:i.entries,dataTestSubj:"exceptionItemCardConditions"})),h.length>0&&Object(s.jsx)(Ue,{dataTestSubj:"exceptionsItemCommentAccordion",comments:h})))};He.displayName="ExceptionItemCardComponent";var Ge=i.a.memo(He);Ge.displayName="ExceptionItemCard";var Qe=a(265),We=Object(H.css)("display:inline;margin-left:",p.euiThemeVars.euiSizeXS,";",""),Ke=function(e){var t=e.value,a=e.tooltipIconType,n=void 0===a?"iInCircle":a,i=function(e){var t=e.value,a=e.tooltipIconText;return{showSpaceWarningIcon:!!(Array.isArray(t)?t.find(Qe.d):Object(Qe.d)(t)),warningText:a||Qe.c.FIELD_SPACE_WARNING}}({value:t,tooltipIconText:e.tooltipIconText}),o=i.showSpaceWarningIcon,l=i.warningText;return o&&t?Object(s.jsx)("div",{className:We},Object(s.jsx)(r.EuiToolTip,{position:"top",content:l},Object(s.jsx)(r.EuiIcon,{"data-test-subj":"valueWithSpaceWarningTooltip",type:n,color:"warning"}))):null},Ye=Object(s.css)("border-right:1px solid #d3dae6;padding:",p.euiThemeVars.euiSizeXS," ",p.euiThemeVars.euiSizeL," ",p.euiThemeVars.euiSizeXS," 0;",""),Je={name:"95qvyx",styles:"width:max-content"},Xe=Object(s.css)("font-size:",p.euiThemeVars.euiFontSize,";color:",p.euiThemeVars.euiTextSubduedColor,";margin-left:",p.euiThemeVars.euiSizeXS,";",""),Ze=Object(s.css)("margin-top:-",p.euiThemeVars.euiSizeL,";margin-bottom:-",p.euiThemeVars.euiSizeL,";",""),et=Object(s.css)("font-size:",p.euiThemeVars.euiFontSizeXS,";",""),tt=function(e){var t=e.dataTestSubj,a=e.linkedRules,i=e.securityLinkAnchorComponent,o=e.isReadonly,l=e.canUserEditList,c=void 0===l||l,u=e.onExportList,d=e.onDeleteList,p=e.onManageRules,m=Object(n.useMemo)((function(){return qe({leftIcon:"check",dataTestSubj:t,linkedRules:a,securityLinkAnchorComponent:i})}),[t,a,i]);return Object(s.jsx)(r.EuiFlexGroup,{direction:"row",alignItems:"baseline",justifyContent:"center",responsive:!0,"data-test-subj":"".concat(t||"","Container"),gutterSize:"l"},Object(s.jsx)(r.EuiFlexItem,{css:Ye},a.length?Object(s.jsx)(_e,{dataTestSubj:"".concat(t||"","LinkedRulesMenu"),emptyButton:!0,useCustomActions:!0,text:S(a.length),actions:m,disableActions:!1,iconType:"arrowDown",iconSide:"right",panelPaddingSize:"none"}):Object(s.jsx)(r.EuiTextColor,{"data-test-subj":"noLinkedRules",css:Je,color:"subdued"},S(a.length))),c&&Object(s.jsx)(r.EuiFlexItem,null,Object(s.jsx)(r.EuiButton,{"data-test-subj":"".concat(t||"","ManageRulesButton"),fill:!0,onClick:function(){"function"==typeof u&&p()}},k)),Object(s.jsx)(r.EuiFlexItem,null,Object(s.jsx)(_e,{iconType:"boxesHorizontal",dataTestSubj:"".concat(t||"","MenuActions"),actions:[{key:"1",icon:"exportAction",label:v,onClick:function(){"function"==typeof u&&u()}},{key:"2",icon:"trash",label:x,onClick:function(){"function"==typeof d&&d()},disabled:!c}],disableActions:o,anchorPosition:"downCenter"})))};tt.displayName="MenuItemsComponent";var at=i.a.memo(tt);at.displayName="MenuItems";var nt=Object(s.css)("display:flex;width:fit-content;align-items:baseline;padding-bottom:",p.euiThemeVars.euiSizeS,";h1{margin-bottom:0;}",""),it=Object(s.css)("button{margin-left:-",p.euiThemeVars.euiSizeM,";}",""),rt=function(e){var t=e.isReadonly,a=e.dataTestSubj,n=e.text,i=e.onEdit,o=e.textCss;return Object(s.jsx)(r.EuiFlexGroup,{css:nt},Object(s.jsx)(r.EuiFlexItem,{grow:10},Object(s.jsx)("span",{css:o,"data-test-subj":"".concat(a||"","Text")},n)),Object(s.jsx)(r.EuiFlexItem,{grow:!1,css:it},t?null:Object(s.jsx)(r.EuiButtonIcon,{"data-test-subj":"".concat(a||"","EditIcon"),"aria-label":"Edit Text List Header",iconType:"pencil",onClick:function(){return"function"==typeof i?i():null}})))};rt.displayName="TextWithEditComponent";var st=i.a.memo(rt);st.displayName="TextWithEdit";var ot=a(216),lt=a.n(ot),ct=function(e){var t,a=e.listDetails,i=e.onSave,o=e.onCancel,l=function(e){var t=e.listDetails,a=e.onSave,i=Object(r.useGeneratedHtmlId)({prefix:"modalForm"}),s=Object(n.useState)(t),o=Fe()(s,2),l=o[0],c=o[1],u=Object(n.useState)(!1),d=Fe()(u,2),p=d[0],m=d[1],g=Object(n.useState)(void 0),b=Fe()(g,2),f=b[0],y=b[1],h=Object(n.useCallback)((function(e){var t=e.target,a=t.name,n=t.value.trim();c(lt()(lt()({},l),{},Ee()({},a,n))),"name"===a&&y(n?void 0:D)}),[l]);return{error:f,modalFormId:i,newListDetails:l,showProgress:p,onBlur:h,onChange:function(e){var t=e.target,a=t.name,n=t.value;c(lt()(lt()({},l),{},Ee()({},a,n)))},onSubmit:function(e){f||(m(!0),a(l),null==e||e.preventDefault())}}}({listDetails:a,onSave:i}),c=l.error,u=l.modalFormId,d=l.newListDetails,p=l.showProgress,g=l.onBlur,b=l.onSubmit,f=l.onChange;return Object(s.jsx)(r.EuiModal,{"data-test-subj":"EditModal",onClose:o,initialFocus:"[name=popswitch]"},p&&Object(s.jsx)(r.EuiProgress,{"data-test-subj":"editModalProgess",size:"xs",position:"absolute"}),Object(s.jsx)(r.EuiModalHeader,null,Object(s.jsx)(r.EuiModalHeaderTitle,{"data-test-subj":"editModalTitle"},Object(s.jsx)("h1",null,(t=a.name,m.i18n.translate("exceptionList-components.exception_list_header_edit_modal_name",{defaultMessage:"Edit {listName}",values:{listName:t}}))))),Object(s.jsx)(r.EuiModalBody,null,Object(s.jsx)(r.EuiForm,{id:u,"data-test-subj":"editModalForm",component:"form",onSubmit:b},Object(s.jsx)(r.EuiFormRow,{error:c,isInvalid:!!c,fullWidth:!0,label:M},Object(s.jsx)(r.EuiFieldText,{fullWidth:!0,isInvalid:!!c,onBlur:g,"data-test-subj":"editModalNameTextField",name:"name",value:d.name,onChange:f})),Object(s.jsx)(r.EuiFormRow,{fullWidth:!0,label:F},Object(s.jsx)(r.EuiTextArea,{fullWidth:!0,"data-test-subj":"editModalDescriptionTextField",name:"description",value:d.description,onChange:f,onBlur:g})))),Object(s.jsx)(r.EuiModalFooter,null,Object(s.jsx)(r.EuiButtonEmpty,{"data-test-subj":"editModalCancelBtn",onClick:o},C),Object(s.jsx)(r.EuiButton,{"data-test-subj":"editModalSaveBtn",type:"submit",form:u,onClick:b,fill:!0},I)))};ct.displayName="EditModalComponent";var ut=i.a.memo(ct);ut.displayName="EditModal";var dt=function(e){var t=e.name,a=e.description,i=e.listId,o=e.linkedRules,l=e.isReadonly,c=e.dataTestSubj,u=e.securityLinkAnchorComponent,d=e.backOptions,p=e.canUserEditList,m=void 0===p||p,g=e.onEditListDetails,b=e.onExportList,f=e.onDeleteList,y=e.onManageRules,h=function(e){var t=e.name,a=e.description,i=e.onEditListDetails,r=Object(n.useState)(!1),s=Fe()(r,2),o=s[0],l=s[1],c=Object(n.useState)({name:t,description:a}),u=Fe()(c,2),d=u[0],p=u[1];return{isModalVisible:o,listDetails:d,onEdit:function(){l(!0)},onSave:function(e){p(e),"function"==typeof i&&i(e),setTimeout((function(){l(!1)}),200)},onCancel:function(){l(!1)}}}({name:t,description:a,onEditListDetails:g}),E=h.isModalVisible,v=h.listDetails,x=h.onEdit,k=h.onSave,S=h.onCancel;return Object(s.jsx)("div",null,Object(s.jsx)(r.EuiPageHeader,{bottomBorder:!0,paddingSize:"none",pageTitle:Object(s.jsx)(st,{dataTestSubj:"".concat(c||"","Title"),text:v.name||w,isReadonly:l||!m,onEdit:x}),responsive:!0,"data-test-subj":"".concat(c||"","PageHeader"),description:Object(s.jsx)("div",{css:Ze},Object(s.jsx)(st,{dataTestSubj:"".concat(c||"","Description"),textCss:Xe,isReadonly:l||!m,text:v.description||T,onEdit:x}),Object(s.jsx)("div",{css:nt,"data-test-subj":"".concat(c||"","ListID")},Object(s.jsx)(r.EuiText,{css:Xe},O,":"),Object(s.jsx)(r.EuiText,{css:Xe},i))),rightSideItems:[Object(s.jsx)(at,{dataTestSubj:"".concat(c||"","RightSideMenuItems"),linkedRules:o,isReadonly:l,canUserEditList:m,securityLinkAnchorComponent:u,onExportList:b,onDeleteList:f,onManageRules:y})],breadcrumbs:[{text:Object(s.jsx)("div",{"data-test-subj":"".concat(c||"","Breadcrumb"),css:et},Object(s.jsx)(r.EuiIcon,{size:"s",type:"arrowLeft"}),j),color:"primary","aria-current":!1,href:d.path,onClick:function(e){e.preventDefault(),d.onNavigate(d.path)}}]}),E&&Object(s.jsx)(ut,{listDetails:v,onSave:k,onCancel:S}))};dt.displayName="ExceptionListHeaderComponent";var pt=i.a.memo(dt);pt.displayName="ExceptionListHeader"},function(e,t,a){"use strict";a.d(t,"a",(function(){return ye}));var n=a(32),i=a(34),r=a(4),s=a.n(r),o=a(140),l=a(88),c=a(624),u=a(305),d=a(87),p=a(101),m=a(78),g=a(92),b=a.n(g),f=a(38),y=a(99),h=a(192),E=a(133),v=a(102),x=a(636),k=a(106),S=a(150),j=a(79),O=a(228),w=a(89);const T=({contextId:e,eventId:t,fieldName:a,address:n})=>`formatted-ip-data-provider-${e}-${a}-${n}-${t}`,I=({contextId:e,eventId:t,fieldName:a,address:n})=>({enabled:!0,id:Object(v.h)(T({contextId:e,eventId:t,fieldName:a,address:n})),name:`${a}: ${Object(x.a)(n)}`,queryMatch:{field:a,value:Object(x.a)(n),operator:k.d},excluded:!1,kqlQuery:"",and:[]}),C=({contextId:e,eventId:t,fieldName:a,fieldType:n,isAggregatable:i,isDraggable:o,truncate:l,value:c})=>{const u=Object(r.useMemo)((()=>`non-decorated-ip-draggable-wrapper-${T({contextId:e,eventId:t,fieldName:a,address:c})}`),[e,t,a,c]),p=Object(r.useMemo)((()=>I({contextId:e,eventId:t,fieldName:a,address:c})),[e,t,a,c]),m=Object(r.useMemo)((()=>"object"!=typeof c?Object(d.f)(c):Object(d.f)((e=>{try{return JSON.stringify(e)}catch(t){return`${e}`}})(c))),[c]),g=Object(r.useCallback)(((e,t,a)=>a.isDragging?s.a.createElement(E.a,null,s.a.createElement(S.a,{dataProvider:e})):m),[m]);return o?s.a.createElement(E.b,{dataProvider:p,fieldType:n,isAggregatable:i,isDraggable:o,key:u,render:g,truncate:l}):m},M=s.a.memo(C),F=({address:e,Component:t,contextId:a,eventId:n,fieldName:i,fieldType:o,isAggregatable:c,isButton:u,isDraggable:d,onClick:p,truncate:g,title:b})=>{const v=`address-links-draggable-wrapper-${T({contextId:a,eventId:n,fieldName:i,address:e})}`,x=Object(r.useMemo)((()=>I({contextId:a,eventId:n,fieldName:i,address:e})),[e,a,n,i]),k=Object(m.useDispatch)(),C=Object(r.useContext)(f.StatefulEventContext),M=e&&(null==C?void 0:C.enableIpDetailsFlyout)&&(null==C?void 0:C.timelineID),F=Object(r.useCallback)((t=>{if(t.preventDefault(),p&&p(),C&&M){const{tabType:t,timelineID:a}=C,n={panelView:"networkDetail",params:{ip:e,flowTarget:i.includes(h.b.destination)?h.b.destination:h.b.source}},r=Object(y.getScopedActions)(a);r&&k(r.toggleDetailPanel({...n,id:a,tabType:t})),a===j.j.active&&t===j.m.query&&O.a.toggleExpandedDetail({...n})}}),[p,C,M,e,i,k]),D=Object(r.useMemo)((()=>t?s.a.createElement(w.h,{Component:t,ip:e,isButton:u,onClick:M?F:void 0,title:b}):s.a.createElement(l.a,{field:i,tooltipContent:i},s.a.createElement(w.h,{Component:t,ip:e,isButton:u,onClick:M?F:void 0,title:b}))),[t,e,i,u,M,F,b]),A=Object(r.useCallback)(((e,t,a)=>a.isDragging?s.a.createElement(E.a,null,s.a.createElement(S.a,{dataProvider:x})):D),[x,D]);return d?s.a.createElement(E.b,{dataProvider:x,isDraggable:d,fieldType:o,isAggregatable:c,key:v,render:A,truncate:g}):D},D=s.a.memo(F),A=({addresses:e,Component:t,contextId:a,eventId:n,fieldName:o,fieldType:l,isAggregatable:c,isButton:u,isDraggable:d,onClick:p,truncate:m,title:g})=>{const b=Object(r.useMemo)((()=>Object(i.uniq)(e)),[e]),f=Object(r.useMemo)((()=>b.map((e=>s.a.createElement(D,{key:e,address:e,Component:t,contextId:a,eventId:n,fieldName:o,fieldType:l,isAggregatable:c,isButton:u,isDraggable:d,onClick:p,truncate:m,title:g})))),[t,a,n,o,l,c,u,d,p,g,m,b]);return s.a.createElement(s.a.Fragment,null,f)},_=s.a.memo(A,((e,t)=>e.contextId===t.contextId&&e.eventId===t.eventId&&e.fieldName===t.fieldName&&e.isAggregatable===t.isAggregatable&&e.fieldType===t.fieldType&&e.isDraggable===t.isDraggable&&e.truncate===t.truncate&&b()(e.addresses,t.addresses))),N=({Component:e,contextId:t,eventId:a,fieldName:n,fieldType:r,isAggregatable:o,isDraggable:l,isButton:c,onClick:u,title:d,truncate:p,value:m})=>{if(Object(i.isString)(m)&&!Object(i.isEmpty)(m)){try{const g=JSON.parse(m);if(Object(i.isArray)(g))return s.a.createElement(_,{addresses:g,Component:e,contextId:t,eventId:a,fieldName:n,fieldType:r,isAggregatable:o,isButton:c,isDraggable:l,onClick:u,title:d,truncate:p})}catch(e){}return s.a.createElement(_,{addresses:[m],Component:e,contextId:t,eventId:a,isButton:c,isDraggable:l,onClick:u,fieldName:n,fieldType:r,isAggregatable:o,truncate:p,title:d})}return s.a.createElement(M,{contextId:t,eventId:a,fieldName:n,fieldType:r,isAggregatable:o,isDraggable:l,truncate:p,value:m})},R=s.a.memo(N,((e,t)=>e.contextId===t.contextId&&e.eventId===t.eventId&&e.fieldName===t.fieldName&&e.isAggregatable===t.isAggregatable&&e.fieldType===t.fieldType&&e.isDraggable===t.isDraggable&&e.truncate===t.truncate&&b()(e.value,t.value)));var P=a(470),L=a(258),B=a(203),q=a(176),z=a(33),$=a.n(z),V=a(156),U=a(191),H=a(953),G=a.n(H),Q=a(260),W=a(2),K=a(128),Y=a(77),J=a(1),X=a(744);const Z=$()(n.EuiFlexItem).withConfig({displayName:"EventModuleFlexItem",componentId:"sc-14rc58n-0"})(["width:100%;"]),ee=({children:e,Component:t,contextId:a,eventId:n,fieldName:o,fieldType:c,isAggregatable:u,isDraggable:p,isButton:m,onClick:g,linkValue:b,truncate:f,title:y,value:h})=>{const E=`${h}`,v=b,{search:x}=Object(K.n)(W.a.rules),{navigateToApp:k,getUrlForApp:S}=Object(Y.k)().services.application,j=Object(r.useCallback)((e=>{e.preventDefault(),k(J.B,{deepLinkId:W.a.rules,path:Object(V.d)(null!=v?v:"",x)})}),[k,v,x]),O=Object(r.useMemo)((()=>S(J.B,{deepLinkId:W.a.rules,path:Object(V.d)(null!=v?v:"",x)})),[S,v,x]),T=`event-details-value-default-draggable-${a}-${n}-${o}-${h}-${v}`,I=Object(r.useMemo)((()=>{const a=f?s.a.createElement(B.b,{dataTestSubj:`formatted-field-${o}`},h):h;return m?s.a.createElement(X.b,{Component:t,dataTestSubj:"data-grid-host-details",href:O,iconType:"expand",onClick:null!=g?g:j,title:null!=y?y:E},e):t?s.a.createElement(t,{"aria-label":y,"data-test-subj":`view-${o}`,iconType:"link",onClick:j,title:y},null!=y?y:h):s.a.createElement(w.f,{onClick:j,href:O,"data-test-subj":"ruleName"},a)}),[t,e,o,j,O,m,g,E,y,f,h]);return Object(i.isString)(h)&&E.length>0&&null!=v?p?s.a.createElement(l.b,{field:o,fieldType:c,isAggregatable:u,id:T,isDraggable:p,tooltipContent:h,value:h},I):I:null!=h?p?s.a.createElement(l.b,{field:o,fieldType:c,isAggregatable:u,id:T,isDraggable:p,tooltipContent:h,value:`${h}`},h):s.a.createElement(s.a.Fragment,null,h):Object(d.d)()},te=({children:e,Component:t,dataTestSubj:a,href:i,onClick:r,title:o,iconType:l="link"})=>t?s.a.createElement(t,{"data-test-subj":a,href:i,iconType:l,onClick:r,title:o},null!=o?o:e):s.a.createElement(n.EuiLink,{"data-test-subj":a,target:"_blank",href:i},null!=o?o:e),ae=s.a.memo(te),ne={open:"primary",acknowledged:"warning",closed:"default"},ie=$()(n.EuiBadge).withConfig({displayName:"StyledEuiBadge",componentId:"sc-1mc1lk7-0"})(["text-transform:capitalize;"]),re=({contextId:e,eventId:t,fieldName:a,fieldType:n,isAggregatable:o,isDraggable:c,value:u,onClick:d,onClickAriaLabel:p,iconSide:m,iconType:g})=>{const b=Object(r.useMemo)((()=>Object(i.getOr)("default",`${u}`,ne)),[u]),f=s.a.createElement(ie,{color:b,onClick:d,onClickAriaLabel:p,iconType:g,iconSide:m},u);return c?s.a.createElement(l.b,{field:a,id:`alert-details-value-default-draggable-${e}-${t}-${a}-${u}`,fieldType:n,isAggregatable:o,isDraggable:!1,value:`${u}`,tooltipContent:a},f):f},se=s.a.memo(re);se.displayName="RuleStatus";const oe=({fieldName:e,fieldType:t,isAggregatable:a,Component:n,contextId:o,eventId:c,isDraggable:u,isButton:p,onClick:g,title:b,value:h})=>{const E=Object(m.useDispatch)(),v=Object(r.useContext)(f.StatefulEventContext),x=`${h}`,k=x&&(null==v?void 0:v.enableHostDetailsFlyout)&&(null==v?void 0:v.timelineID),S=Object(r.useCallback)((e=>{if(e.preventDefault(),g&&g(),v&&k){const{timelineID:e,tabType:t}=v,a={panelView:"hostDetail",params:{hostName:x}},n=Object(y.getScopedActions)(e);n&&E(n.toggleDetailPanel({...a,id:e,tabType:t})),e===j.j.active&&t===j.m.query&&O.a.toggleExpandedDetail({...a})}}),[g,v,k,x,E]),T=Object(r.useMemo)((()=>s.a.createElement(w.d,{Component:n,hostName:x,isButton:p,onClick:k?S:void 0,title:b},s.a.createElement(B.b,{"data-test-subj":"draggable-truncatable-content"},x))),[n,x,p,k,S,b]);return Object(i.isString)(h)&&x.length>0?u?s.a.createElement(l.b,{field:e,fieldType:t,isAggregatable:a,id:`event-details-value-default-draggable-${o}-${c}-${e}-${h}`,isDraggable:u,tooltipContent:e,value:x},T):T:Object(d.d)()},le=s.a.memo(oe);le.displayName="HostName";var ce=a(246),ue=a(637),de=a(638);const pe=s.a.memo((({fieldName:e,contextId:t,eventId:a,fieldType:i,isAggregatable:r,isDraggable:o,value:l})=>{const{isIsolated:c,agentStatus:u,pendingIsolation:d,pendingUnisolation:p}=Object(ue.a)({agentId:l});return s.a.createElement(n.EuiFlexGroup,{gutterSize:"none"},void 0!==u?s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(de.a,{hostStatus:u})):s.a.createElement(n.EuiText,null,s.a.createElement("p",null,Q.b)),s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(ce.b,{isIsolated:c,pendingActions:{pendingIsolate:d,pendingUnIsolate:p}})))}));pe.displayName="AgentStatuses";const me=({fieldName:e,Component:t,contextId:a,eventId:n,fieldType:o,isAggregatable:c,isDraggable:u,isButton:p,onClick:g,title:b,value:h})=>{const E=Object(m.useDispatch)(),v=Object(r.useContext)(f.StatefulEventContext),x=`${h}`,k=x&&(null==v?void 0:v.timelineID),S=Object(r.useCallback)((e=>{if(e.preventDefault(),g&&g(),v&&k){const{timelineID:e,tabType:t}=v,a={panelView:"userDetail",params:{userName:x}},n=Object(y.getScopedActions)(e);n&&E(n.toggleDetailPanel({...a,id:e,tabType:t})),e===j.j.active&&t===j.m.query&&O.a.toggleExpandedDetail({...a})}}),[g,v,k,x,E]),T=Object(r.useMemo)((()=>s.a.createElement(w.m,{Component:t,userName:x,isButton:p,onClick:k?S:void 0,title:b},s.a.createElement(B.b,{"data-test-subj":"draggable-truncatable-content"},x))),[x,p,k,S,t,b]);return Object(i.isString)(h)&&x.length>0?u?s.a.createElement(l.b,{field:e,id:`event-details-value-default-draggable-${a}-${n}-${e}-${h}`,fieldType:o,isAggregatable:c,isDraggable:u,tooltipContent:e,value:x},T):T:Object(d.d)()},ge=s.a.memo(me);ge.displayName="UserName";const be=[q.h],fe=({asPlainText:e,Component:t,contextId:a,eventId:r,fieldFormat:m,isAggregatable:g=!1,fieldName:b,fieldType:f="",isButton:y,isObjectArray:h=!1,isDraggable:E=!0,onClick:v,onClickAriaLabel:x,title:k,truncate:S=!0,value:j,linkValue:O})=>{if(h||e)return s.a.createElement("span",{"data-test-subj":`formatted-field-${b}`},j);if(f===q.g)return s.a.createElement(R,{Component:t,eventId:r,contextId:a,fieldName:b,fieldType:f,isAggregatable:g,isButton:y,isDraggable:E,value:Object(i.isNumber)(j)?String(j):j,onClick:v,title:k,truncate:S});if(f===q.e)return s.a.createElement(s.a.Fragment,null,j);if(f===q.b){const e=S?"eui-textTruncate eui-alignMiddle":void 0;return E?s.a.createElement(l.b,{field:b,fieldType:f,isAggregatable:g,id:`event-details-value-default-draggable-${a}-${r}-${b}-${j}`,isDraggable:E,tooltipContent:null,value:`${j}`},s.a.createElement(p.a,{className:e,fieldName:b,value:j})):s.a.createElement(p.a,{className:e,fieldName:b,value:j})}if(L.b.some((e=>b===e)))return s.a.createElement(P.a,{Component:t,contextId:a,eventId:r,fieldName:b,fieldType:f,isAggregatable:g,isDraggable:E,title:k,value:`${j}`});if(b===u.b)return s.a.createElement(u.a,{contextId:a,eventId:r,fieldName:b,fieldType:f,isAggregatable:g,isDraggable:E,value:`${j}`});if(b===q.f)return s.a.createElement(le,{Component:t,contextId:a,eventId:r,fieldType:f,isAggregatable:g,fieldName:b,isDraggable:E,isButton:y,onClick:v,title:k,value:j});if(b===q.n)return s.a.createElement(ge,{Component:t,contextId:a,eventId:r,fieldName:b,fieldType:f,isAggregatable:g,isDraggable:E,isButton:y,onClick:v,title:k,value:j});if(m===c.a)return s.a.createElement(c.b,{contextId:a,eventId:r,fieldName:b,fieldType:f,isAggregatable:g,isDraggable:E,value:`${j}`});if(b===q.l)return s.a.createElement(ee,{Component:t,contextId:a,eventId:r,fieldName:b,fieldType:f,isAggregatable:g,isDraggable:E,isButton:y,onClick:v,linkValue:O,title:k,truncate:S,value:j});if(b===q.c)return(({contextId:e,eventId:t,fieldName:a,fieldType:r,isAggregatable:o,isDraggable:c,linkValue:u,truncate:p,value:m})=>{const g=`${m}`,b=u,f=p?s.a.createElement(B.b,null,m):m;return Object(i.isString)(m)&&g.length>0?s.a.createElement(n.EuiFlexGroup,{gutterSize:"none",alignItems:"center",justifyContent:null==b||Object(i.isEmpty)(b)?"spaceBetween":"flexStart"},s.a.createElement(Z,null,c?s.a.createElement(l.b,{field:a,id:`event-details-value-default-draggable-${e}-${t}-${a}-${m}-${g}`,fieldType:r,isAggregatable:o,isDraggable:c,tooltipContent:m,value:m},f):s.a.createElement(s.a.Fragment,null,f)),null!=b&&((e,t)=>"endgame"===e.trim().toLocaleLowerCase()&&null!=t&&!Object(i.isEmpty)(t)&&!Object(U.c)(t)&&t.includes("/alerts/"))(g,b)&&s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(n.EuiToolTip,{"data-test-subj":"event-module-link-to-elastic-endpoint-security",content:s.a.createElement(s.a.Fragment,null,s.a.createElement("p",null,Q.e),s.a.createElement("p",null,b))},s.a.createElement(n.EuiLink,{href:b,target:"_blank"},s.a.createElement(n.EuiIcon,{type:G.a,size:"m"}))))):Object(d.d)()})({contextId:a,eventId:r,fieldName:b,fieldType:f,isAggregatable:g,isDraggable:E,linkValue:O,truncate:S,value:j});if(b===q.m)return s.a.createElement(se,{contextId:a,eventId:r,fieldName:b,fieldType:f,isAggregatable:g,isDraggable:E,value:j,onClick:v,onClickAriaLabel:x,iconType:y?"arrowDown":void 0,iconSide:y?"right":void 0});if(b===q.a)return s.a.createElement(pe,{contextId:a,eventId:r,fieldName:b,fieldType:f,isAggregatable:g,isDraggable:E,value:"string"==typeof j?j:""});if([q.k,q.j,q.d,o.j].includes(b))return(({contextId:e,Component:t,eventId:a,fieldName:n,fieldType:r,isAggregatable:o,isDraggable:c,truncate:u,title:p,value:m})=>{const g=`${m}`,b=!Object(U.c)(g),f=u?s.a.createElement(B.b,null,m):m,y=b?s.a.createElement(ae,{Component:t,href:g,dataTestSubj:"ata-grid-url",title:p,iconType:"link"}):s.a.createElement(s.a.Fragment,null,f);return Object(i.isString)(m)&&g.length>0?c?s.a.createElement(l.b,{field:n,fieldType:r,isAggregatable:o,id:`event-details-value-default-draggable-${e}-${a}-${n}-${m}-${g}`,isDraggable:c,tooltipContent:m,value:m},y):y:Object(d.d)()})({contextId:a,Component:t,eventId:r,fieldName:b,fieldType:f,isAggregatable:g,isDraggable:E,truncate:S,title:k,value:j});if(be.includes(b)||!E)return S&&!Object(i.isEmpty)(j)?s.a.createElement(B.b,{"data-test-subj":"truncatable-message"},s.a.createElement(n.EuiToolTip,{"data-test-subj":"message-tool-tip",content:s.a.createElement(n.EuiFlexGroup,{direction:"column",gutterSize:"none"},s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement("span",null,b)),s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement("span",null,j)))},s.a.createElement("span",{"data-test-subj":`formatted-field-${b}`},j))):s.a.createElement("span",{"data-test-subj":`formatted-field-${b}`},j);{const e=Object(d.f)(j),t=S?s.a.createElement(B.b,null,e):e;return s.a.createElement(l.b,{field:b,id:`event-details-value-default-draggable-${a}-${r}-${b}-${j}`,fieldType:null!=f?f:"",isAggregatable:g,isDraggable:E,value:`${j}`,tooltipContent:f===q.b||f===u.b?null:b},t)}},ye=s.a.memo(fe)},function(e,t,a){"use strict";a.d(t,"a",(function(){return k}));var n=a(32),i=a(34),r=a(4),s=a.n(r),o=a(33),l=a.n(o),c=a(1),u=a(119),d=a(187),p=a(324),m=a(0);const g=m.i18n.translate("xpack.securitySolution.paginatedTable.showingSubtitle",{defaultMessage:"Showing"}),b=m.i18n.translate("xpack.securitySolution.paginatedTable.rowsButtonLabel",{defaultMessage:"Rows per page"}),f=m.i18n.translate("xpack.securitySolution.paginatedTable.tooManyResultsToastTitle",{defaultMessage:" - too many results"}),y=m.i18n.translate("xpack.securitySolution.paginatedTable.tooManyResultsToastText",{defaultMessage:"Narrow your query to better filter the results"});var h=a(318),E=a(124),v=a(109);const x=({activePage:e,columns:t,dataTestSubj:a="paginated-table",headerCount:o,headerFilters:l,headerSupplement:m,headerTitle:x,headerTooltip:k,headerUnit:w,headerSubtitle:T,id:I,isInspect:C,itemsPerRow:M,limit:F,loading:D,loadPage:A,onChange:_=i.noop,pageOfItems:N,setQuerySkip:R,showMorePagesIndicator:P,sorting:L=null,split:B,stackHeader:q,totalCount:z,updateActivePage:$,updateLimitPagination:V})=>{const[U,H]=Object(r.useState)(D),[G,Q]=Object(r.useState)(e),[W,K]=Object(r.useState)(-1===o),[Y,J]=Object(r.useState)(!1),X=Math.ceil(z/F),Z=Object(p.g)()[1];Object(r.useEffect)((()=>{Q(e)}),[e]),Object(r.useEffect)((()=>{o>=0&&W&&K(!1)}),[W,o]),Object(r.useEffect)((()=>{H(D)}),[D]);const ee=()=>{J(!1)},te=s.a.createElement(n.EuiButtonEmpty,{size:"xs",color:"text",iconType:"arrowDown",iconSide:"right",onClick:()=>{J(!Y)}},`${b}: ${F}`),ae=M&&M.map((e=>s.a.createElement(n.EuiContextMenuItem,{key:e.text,icon:F===e.numberOfRow?"check":"empty",onClick:()=>{ee(),V(e.numberOfRow),$(0)}},e.text))),ne=P?O:n.EuiFlexItem,ie=Object(r.useMemo)((()=>L?{sort:{field:L.field,direction:L.direction}}:void 0),[L]),{toggleStatus:re,setToggleStatus:se}=Object(v.a)(I),oe=Object(r.useCallback)((e=>{se(e),R(!e)}),[R,se]);return s.a.createElement(E.c,{show:!W},s.a.createElement(h.a,{"data-test-subj":`${a}-loading-${D}`,loading:D},s.a.createElement(u.a,{toggleStatus:re,toggleQuery:oe,headerFilters:l,id:I,split:B,stackHeader:q,subtitle:!W&&T?`${g}: ${T}`:w&&`${g}: ${o>=0?o.toLocaleString():0} ${w}`,title:x,tooltip:k},!W&&m),re&&(W?s.a.createElement(n.EuiLoadingContent,{"data-test-subj":"initialLoadingPanelPaginatedTable",lines:10}):s.a.createElement(s.a.Fragment,null,s.a.createElement(S,{"data-test-subj":"paginated-basic-table",columns:t,items:N,onChange:_,sorting:ie}),s.a.createElement(j,null,s.a.createElement(n.EuiFlexItem,null,M&&M.length>0&&z>=M[0].numberOfRow&&s.a.createElement(n.EuiPopover,{id:"customizablePagination","data-test-subj":"loadingMoreSizeRowPopover",button:te,isOpen:Y,closePopover:ee,panelPaddingSize:"none",repositionOnScroll:!0},s.a.createElement(n.EuiContextMenuPanel,{items:ae,"data-test-subj":"loadingMorePickSizeRow"}))),s.a.createElement(ne,{grow:!1},z>0&&s.a.createElement(n.EuiPagination,{"data-test-subj":"numberedPagination",pageCount:X,activePage:G,onPageClick:e=>{if((e+1)*F>=c.Y)return Z({type:"addToaster",toast:{id:"PaginationWarningMsg",title:x+f,color:"warning",iconType:"alert",toastLifeTimeMs:1e4,text:y}});Q(e),A(e),$(e)}}))),(C||U)&&s.a.createElement(d.a,{"data-test-subj":"loadingPanelPaginatedTable",overlay:!0,size:"xl"})))))},k=Object(r.memo)(x),S=l()(n.EuiBasicTable).withConfig({displayName:"BasicTable",componentId:"sc-53ob89-0"})(["tbody{th,td{vertical-align:top;}.euiTableCellContent{display:block;}}"]);S.displayName="BasicTable";const j=l()(n.EuiFlexGroup).attrs((()=>({alignItems:"center",responsive:!1}))).withConfig({displayName:"FooterAction",componentId:"sc-53ob89-1"})(["margin-top:",";"],(({theme:e})=>e.eui.euiSizeXS));j.displayName="FooterAction";const O=l()(n.EuiFlexItem).withConfig({displayName:"PaginationEuiFlexItem",componentId:"sc-53ob89-2"})(["@media only screen and (min-width:","){.euiButtonIcon:last-child{margin-left:28px;}.euiPagination{position:relative;}.euiPagination::before{bottom:0;color:",";content:'\\2026';font-size:",";padding:5px ",";position:absolute;right:",";}}"],(({theme:e})=>e.eui.euiBreakpoints.m),(({theme:e})=>e.eui.euiButtonColorDisabled),(({theme:e})=>e.eui.euiFontSizeS),(({theme:e})=>e.eui.euiSizeS),(({theme:e})=>e.eui.euiSizeL));O.displayName="PaginationEuiFlexItem"},function(e,t,a){"use strict";a.d(t,"a",(function(){return u})),a.d(t,"b",(function(){return d})),a.d(t,"c",(function(){return p}));var n=a(34),i=a(4),r=a(815),s=a.n(r),o=a(49),l=a(58),c=a.n(l);const u=(e,t)=>{const a=null!=t?t:((e,t)=>{const a=t.diff(e,"days");return a<=1&&!e.isSame(t)?2:a})(c()(e[0]),c()(e[1])),n=Object(o.niceTimeFormatByDay)(a);return Object(o.timeFormatter)(n)},d=(e=100)=>{const[t,a]=Object(i.useState)({width:0,height:0}),r=Object(i.useMemo)((()=>Object(n.throttle)(e,a)),[e]),{ref:o}=s()({onResize:r});return{ref:o,...t}},p=(e,t,a,n)=>{Object(i.useEffect)((()=>{!async function(){const i=await(null==e?void 0:e.getVariation(t,a));i&&n(i)}()}),[e,t,a,n])}},function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));var n=a(34),i=a(4),r=a.n(i),s=a(351),o=a(515),l=a(305),c=a(473),u=a(306),d=a(516),p=a(693),m=a(476),g=a(258),b=a(474),f=a(423),y=a(359);const h=r.a.memo((({data:e,timelineId:t,isDraggable:a})=>r.a.createElement(p.a,{contextId:`netflow-renderer-${t}-${e._id}`,destinationBytes:Object(s.a)(Object(n.get)(f.a,e)),destinationGeoContinentName:Object(s.a)(Object(n.get)(b.b,e)),destinationGeoCountryName:Object(s.a)(Object(n.get)(b.d,e)),destinationGeoCountryIsoCode:Object(s.a)(Object(n.get)(b.c,e)),destinationGeoRegionName:Object(s.a)(Object(n.get)(b.e,e)),destinationGeoCityName:Object(s.a)(Object(n.get)(b.a,e)),destinationIp:Object(s.a)(Object(n.get)(u.a,e)),destinationPackets:Object(s.a)(Object(n.get)(f.b,e)),destinationPort:Object(s.a)(Object(n.get)(g.a,e)),eventDuration:Object(s.a)(Object(n.get)(l.b,e)),eventId:Object(n.get)(c.a,e),eventEnd:Object(s.a)(Object(n.get)(m.b,e)),eventStart:Object(s.a)(Object(n.get)(m.c,e)),isDraggable:a,networkBytes:Object(s.a)(Object(n.get)(y.a,e)),networkCommunityId:Object(s.a)(Object(n.get)(y.b,e)),networkDirection:Object(s.a)(Object(n.get)(y.c,e)),networkPackets:Object(s.a)(Object(n.get)(y.d,e)),networkProtocol:Object(s.a)(Object(n.get)(y.e,e)),sourceBytes:Object(s.a)(Object(n.get)(f.c,e)),sourceGeoContinentName:Object(s.a)(Object(n.get)(b.h,e)),sourceGeoCountryName:Object(s.a)(Object(n.get)(b.j,e)),sourceGeoCountryIsoCode:Object(s.a)(Object(n.get)(b.i,e)),sourceGeoRegionName:Object(s.a)(Object(n.get)(b.k,e)),sourceGeoCityName:Object(s.a)(Object(n.get)(b.g,e)),sourceIp:Object(s.a)(Object(n.get)(u.d,e)),sourcePackets:Object(s.a)(Object(n.get)(f.d,e)),sourcePort:Object(s.a)(Object(n.get)(g.c,e)),tlsClientCertificateFingerprintSha1:Object(s.a)(Object(n.get)(o.b,e)),tlsFingerprintsJa3Hash:Object(s.a)(Object(n.get)(d.a,e)),tlsServerCertificateFingerprintSha1:Object(s.a)(Object(n.get)(o.c,e)),transport:Object(s.a)(Object(n.get)(y.f,e)),userName:void 0})));h.displayName="NetflowRenderer"},function(e,t,a){"use strict";var n=a(1008);e.exports=function(e,t,a,i){var r,s=e.length,o=0;if(t=t<0?-t>s?0:s+t:t>s?s:t,a=a>0?a:0,i.length<1e4)(r=Array.from(i)).unshift(t,a),n.apply(e,r);else for(a&&n.apply(e,[t,a]);o<i.length;)(r=i.slice(o,o+1e4)).unshift(t,0),n.apply(e,r),o+=1e4,t+=1e4}},function(e,t,a){"use strict";e.exports=function(e){return e<0||32===e}},function(e,t,a){"use strict";var n=a(367);e.exports=function(e){return function(t){return e.test(n(t))}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return u})),a.d(t,"b",(function(){return d}));var n=a(82),i=a.n(n),r=a(4),s=a.n(r),o=a(33),l=a.n(o),c=a(32);const u=l.a.span.withConfig({displayName:"EllipsisText",componentId:"sc-pfaalj-0"})(["&,& *{display:inline-block;max-width:100%;overflow:hidden;text-overflow:ellipsis;vertical-align:top;white-space:nowrap;}"]);function d({tooltipContent:e,children:t,dataTestSubj:a,...n}){return e?s.a.createElement(c.EuiToolTip,{display:"block",content:e},s.a.createElement(u,i()({"data-test-subj":a},n),t)):s.a.createElement(u,i()({"data-test-subj":a},n),t)}u.displayName="EllipsisText"},,,function(e,t,a){"use strict";a.d(t,"e",(function(){return c})),a.d(t,"d",(function(){return u})),a.d(t,"b",(function(){return p})),a.d(t,"g",(function(){return g})),a.d(t,"c",(function(){return f})),a.d(t,"f",(function(){return h})),a.d(t,"a",(function(){return k}));var n=a(39),i=a(4),r=a(105),s=a(350),o=a(139);const l=Object.freeze({});function c(e,t=l,a=o.c,c,u=[]){const{filter:d="",page:p=r.b+1,perPage:m=r.c,policies:g=[],excludedPolicies:b=[]}=t,f=Object(i.useMemo)((()=>Object(s.a)({kuery:Object(s.b)(d,a),policies:g,excludedPolicies:b})),[d,a,g,b]);return Object(n.useQuery)([...u,"list",e,f,p,m],(async()=>await e.find({filter:f,perPage:m,page:p,sortField:r.d,sortOrder:r.e})),c)}function u(e,t,a,i){return Object(n.useQuery)(["get",e,t,a],(()=>e.get(t,a)),i)}const d=Object.freeze({});function p(e,t=d){return Object(n.useMutation)((t=>e.create(t)),t)}const m=Object.freeze({});function g(e,t=m){return Object(n.useMutation)((t=>e.update(t)),t)}const b=Object.freeze({});function f(e,t=b){return Object(n.useMutation)((({itemId:t,id:a})=>e.delete(t,a)),t)}const y=Object.freeze({});function h(e,t=y,a=o.c,i){const{filter:r="",policies:l=[]}=t;return Object(n.useQuery)(["summary",e,r,l],(()=>e.summary(Object(s.a)({policies:l,kuery:Object(s.b)(r,a)}))),i)}var E=a(427),v=a.n(E);const x=Object.freeze({});function k(e,t=x,a={concurrency:5}){return Object(n.useMutation)((t=>v()(t,(t=>e.update(t)),a)),t)}Object.freeze({})},,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return E})),a.d(t,"b",(function(){return v}));var n=a(82),i=a.n(n),r=a(4),s=a.n(r),o=a(78),l=a(32),c=a(90),u=a(158),d=a(86),p=a(148),m=a(79),g=a(81),b=a(145),f=a(177),y=a(95),h=a(283);const E=({timelineId:e,timelineType:t,closeGearMenu:a})=>{const n=Object(o.useDispatch)(),i=Object(r.useMemo)((()=>f.d.defaultDataViewSelector()),[]),{id:s,patternList:l}=Object(g.a)(i),{timelineFullScreen:E,setTimelineFullScreen:v}=Object(p.c)(),x=Object(g.a)(b.d.globalTimeRangeSelector),k=Object(r.useCallback)((({id:e,show:a,timeRange:i})=>{const r=null!=i?i:x;e===m.j.active&&E&&v(!1),n(f.a.setSelectedDataView({id:y.SourcererScopeName.timeline,selectedDataViewId:s,selectedPatterns:l})),n(d.a.createTimeline({columns:u.b,dataViewId:s,id:e,indexNames:l,show:a,timelineType:t})),n(d.a.setTimelineUpdatedAt({id:m.j.active,updated:void 0})),n(b.b.addLinkTo([c.a.global,c.a.timeline])),n(h.a.addNotes({notes:[]})),i&&n(b.b.removeLinkTo([c.a.timeline,c.a.global])),"absolute"===r.kind?n(b.b.setAbsoluteRangeDatePicker({...r,id:c.a.timeline})):"relative"===r.kind&&n(b.b.setRelativeRangeDatePicker({...r,id:c.a.timeline}))}),[n,x,s,l,v,E,t]);return Object(r.useCallback)((n=>{k({id:e,show:!0,timelineType:t,timeRange:null==n?void 0:n.timeRange}),"function"==typeof a&&a()}),[k,e,t,a])},v=({timelineId:e,timelineType:t,closeGearMenu:a})=>{const n=E({timelineId:e,timelineType:t,closeGearMenu:a});return{getButton:Object(r.useCallback)((({outline:e,title:a,iconType:r="plusInCircle",fill:o=!0,isDisabled:c=!1})=>{const u={iconType:r,onClick:()=>n(),fill:o},d=t===m.n.template?"template-timeline-new":"timeline-new",{fill:p,...g}=u;return e?s.a.createElement(l.EuiButton,i()({"data-test-subj":`${d}-with-border`},u),a):s.a.createElement(l.EuiButtonEmpty,i()({"data-test-subj":d,color:"text"},g),a)}),[n,t])}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(4),i=a.n(n),r=a(33),s=a.n(r),o=a(34);const l=s.a.div.withConfig({displayName:"StyledDiv",componentId:"sc-l27u1a-0"})(["width:100%;display:flex;flex-grow:1;> *{max-width:100%;}",""],(({targetClassNames:e})=>Object(r.css)(["","{pointer-events:none;opacity:0;transition:opacity "," ease;}","{pointer-events:auto;opacity:1;}"],e.map((e=>`.${e}`)).join(", "),(e=>Object(o.getOr)(250,"theme.eui.euiAnimSpeedNormal",e)),e.map((e=>`&:hover .${e}`)).join(", ")))),c=i.a.memo((({show:e=!0,targetClassNames:t,children:a})=>e?i.a.createElement(l,{"data-test-subj":"hoverVisibilityContainer",targetClassNames:t},a):i.a.createElement(i.a.Fragment,null,a)));c.displayName="HoverVisibilityContainer"},function(e,t,a){"use strict";a.d(t,"b",(function(){return c})),a.d(t,"c",(function(){return u})),a.d(t,"a",(function(){return d}));var n=a(0),i=a(85);const r=n.i18n.translate("xpack.securitySolution.riskScore.overview.hostTitle",{defaultMessage:"Host"}),s=n.i18n.translate("xpack.securitySolution.riskScore.overview.hosts",{defaultMessage:"Hosts"}),o=n.i18n.translate("xpack.securitySolution.riskScore.overview.userTitle",{defaultMessage:"User"}),l=n.i18n.translate("xpack.securitySolution.riskScore.overview.users",{defaultMessage:"Users"}),c=e=>n.i18n.translate("xpack.securitySolution.riskScore.overview.riskScoreTitle",{defaultMessage:"{riskEntity} Risk Score",values:{riskEntity:u(e)}}),u=(e,t=!1,a=!1)=>t?a?(e===i.v.host?s:l).toLowerCase():(e===i.v.host?r:o).toLowerCase():a?e===i.v.host?s:l:e===i.v.host?r:o,d=n.i18n.translate("xpack.securitySolution.riskScore.overview.alerts",{defaultMessage:"Alerts"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return d})),a.d(t,"b",(function(){return g}));var n=a(4),i=a.n(n),r=a(32),s=a(33),o=a.n(s),l=a(40),c=a(552),u=a(85);const d={[u.x.unknown]:l.euiLightVars.euiColorMediumShade,[u.x.low]:l.euiLightVars.euiColorVis0,[u.x.moderate]:l.euiLightVars.euiColorWarning,[u.x.high]:l.euiLightVars.euiColorVis9_behindText,[u.x.critical]:l.euiLightVars.euiColorDanger},p=o.a.div.withConfig({displayName:"RiskBadge",componentId:"sc-tjf1ld-0"})(["",""],(({theme:e,$severity:t,$hideBackgroundColor:a})=>Object(s.css)(["width:fit-content;padding-right:",";padding-left:",";",";"],e.eui.euiSizeS,e.eui.euiSizeXS,("Critical"===t||"High"===t)&&!a&&Object(s.css)(["background-color:",";border-radius:999px;"],Object(r.transparentize)(e.eui.euiColorDanger,.2))))),m=o.a.div.withConfig({displayName:"TooltipContainer",componentId:"sc-tjf1ld-1"})(["padding:",";"],(({theme:e})=>e.eui.euiSizeS)),g=({severity:e,hideBackgroundColor:t=!1,toolTipContent:a})=>{const n=i.a.createElement(p,{color:l.euiLightVars.euiColorDanger,$severity:e,$hideBackgroundColor:t,"data-test-subj":"risk-score"},i.a.createElement(r.EuiHealth,{className:"eui-alignMiddle",color:d[e]},e));return null!=a?i.a.createElement(c.a,{hoverContent:i.a.createElement(m,null,a),render:()=>n}):n}},function(e,t,a){"use strict";a.d(t,"e",(function(){return i})),a.d(t,"g",(function(){return r})),a.d(t,"h",(function(){return s})),a.d(t,"j",(function(){return o})),a.d(t,"k",(function(){return l})),a.d(t,"i",(function(){return c})),a.d(t,"o",(function(){return u})),a.d(t,"n",(function(){return d})),a.d(t,"m",(function(){return p})),a.d(t,"l",(function(){return m})),a.d(t,"u",(function(){return g})),a.d(t,"t",(function(){return b})),a.d(t,"s",(function(){return f})),a.d(t,"r",(function(){return y})),a.d(t,"d",(function(){return h})),a.d(t,"b",(function(){return E})),a.d(t,"a",(function(){return v})),a.d(t,"c",(function(){return x})),a.d(t,"p",(function(){return k})),a.d(t,"q",(function(){return S})),a.d(t,"f",(function(){return j})),a.d(t,"v",(function(){return O})),a.d(t,"w",(function(){return w}));var n=a(0);const i=n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights",{defaultMessage:"Insights"}),r=n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_process_ancestry",{defaultMessage:"Related alerts by process ancestry"}),s=e=>n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_process_ancestry_count",{defaultMessage:"{count} {count, plural, =1 {alert} other {alerts}} by process ancestry",values:{count:e}}),o=n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_process_ancestry_error",{defaultMessage:"Failed to fetch alerts."}),l=n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.processAncestryFilter",{defaultMessage:"Process Ancestry Alert IDs"}),c=n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_process_ancestry_empty",{defaultMessage:"There are no related alerts by process ancestry."}),u=n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_source_event_loading",{defaultMessage:"Loading related alerts by source event"}),d=n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_session_error",{defaultMessage:"Failed to load related alerts by session"}),p=n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_session_empty",{defaultMessage:"There are no related alerts by session"}),m=e=>n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_session_count",{defaultMessage:"{count} {count, plural, =1 {alert} other {alerts}} related by session",values:{count:e}}),g=n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_source_event_loading",{defaultMessage:"Loading related alerts by source event"}),b=n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_source_event_error",{defaultMessage:"Failed to load related alerts by source event"}),f=n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_source_event_empty",{defaultMessage:"There are no related alerts by source event"}),y=e=>n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights_related_alerts_by_source_event_count",{defaultMessage:"{count} {count, plural, =1 {alert} other {alerts}} related by source event",values:{count:e}}),h=n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_cases_loading",{defaultMessage:"Loading related cases"}),E=n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_cases_error",{defaultMessage:"Failed to load related cases"}),v=e=>n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_cases_count",{defaultMessage:"{count} {count, plural, =1 {case} other {cases}} related to this alert",values:{count:e}}),x=e=>n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.relatedCasesFailure",{defaultMessage:'Unable to load related cases: "{error}"',values:{error:e}}),k=n.i18n.translate("xpack.securitySolution.alertDetails.overview.simpleAlertTable.error",{defaultMessage:"Failed to load the alerts."}),S=n.i18n.translate("xpack.securitySolution.alertDetails.overview.limitedAlerts",{defaultMessage:"Showing only the latest 10 alerts. View the rest of alerts in timeline."}),j=n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.alertUpsellTitle",{defaultMessage:"Get more insights with a platinum subscription"}),O=e=>n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.suppressedAlertsCount",{defaultMessage:"{count} suppressed {count, plural, =1 {alert} other {alerts}}",values:{count:e}}),w=n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.suppressedAlertsCountTechnicalPreview",{defaultMessage:"Technical Preview"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=(e,t,a)=>{const n=e*t;return{activePage:e,cursorStart:n,fakePossibleCount:4<=e&&e>0?t*(e+2):5*t,querySize:a?t:t+n}}},,function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(4),i=a(116);const r=()=>{const[e,t]=Object(n.useState)({isAuthenticated:null,hasEncryptionKey:null,hasIndexManage:null,hasIndexRead:null,hasIndexWrite:null,hasIndexUpdateDelete:null,hasIndexMaintenance:null,hasKibanaCRUD:!1,hasKibanaREAD:!1}),{detectionEnginePrivileges:a,kibanaSecuritySolutionsPrivileges:{crud:r,read:s}}=Object(i.a)();return Object(n.useEffect)((()=>{null!=a.error&&t({isAuthenticated:!1,hasEncryptionKey:!1,hasIndexManage:!1,hasIndexRead:!1,hasIndexWrite:!1,hasIndexUpdateDelete:!1,hasIndexMaintenance:!1,hasKibanaCRUD:r,hasKibanaREAD:s})}),[a.error,r,s]),Object(n.useEffect)((()=>{if(null!=a.result){const e=a.result;if(null!=e.index&&Object.keys(e.index).length>0){const a=Object.keys(e.index)[0];t({isAuthenticated:e.is_authenticated,hasEncryptionKey:e.has_encryption_key,hasIndexManage:e.index[a].manage&&e.cluster.manage,hasIndexMaintenance:e.index[a].maintenance,hasIndexRead:e.index[a].read,hasIndexWrite:e.index[a].create||e.index[a].create_doc||e.index[a].index||e.index[a].write,hasIndexUpdateDelete:e.index[a].write,hasKibanaCRUD:r,hasKibanaREAD:s})}}}),[a.result,r,s]),{loading:a.loading,...e}}},function(e,t,a){e.exports=a(27)(258)},function(e,t,a){e.exports=a(27)(1546)},function(e,t,a){"use strict";a.d(t,"a",(function(){return y}));var n=a(32),i=a(4),r=a.n(i),s=a(33),o=a.n(s),l=a(607),c=a(615),u=a(867),d=a(128),p=a(77);o.a.header.attrs({className:"securitySolutionHeaderPage"}).withConfig({displayName:"Header",componentId:"sc-fdx6r8-0"})(["",""],(({border:e,theme:t})=>Object(s.css)(["margin-bottom:",";"],t.eui.euiSizeL))).displayName="Header";const m=o.a.div.attrs({className:"securitySolutionHeaderPage__linkBack"}).withConfig({displayName:"LinkBack",componentId:"sc-fdx6r8-1"})(["",""],(({theme:e})=>Object(s.css)(["font-size:",";line-height:",";margin-bottom:",";"],e.eui.euiFontSizeXS,e.eui.euiLineHeight,e.eui.euiSizeS)));m.displayName="LinkBack";const g=o()(n.EuiPageHeaderSection).withConfig({displayName:"HeaderSection",componentId:"sc-fdx6r8-2"})(["min-width:0;max-width:100%;"]);g.displayName="HeaderSection";const b=r.a.memo((({backOptions:e})=>{var t,a;const{navigateToUrl:n}=Object(p.k)().services.application,{formatUrl:i}=Object(d.n)(e.pageId),s=i(null!==(t=e.path)&&void 0!==t?t:"");return r.a.createElement(m,null,r.a.createElement(l.a,{dataTestSubj:null!==(a=e.dataTestSubj)&&void 0!==a?a:"link-back",onClick:e=>{e.preventDefault(),n(s)},href:s,iconType:"arrowLeft"},e.text))}));b.displayName="HeaderLinkBack";const f=({backOptions:e,backComponent:t,badgeOptions:a,border:i,children:s,draggableArguments:o,isLoading:l,rightSideItems:d,subtitle:p,subtitle2:m,title:f,titleNode:y})=>r.a.createElement(r.a.Fragment,null,r.a.createElement(n.EuiPageHeader,{alignItems:"center",bottomBorder:i,rightSideItems:d},r.a.createElement(g,null,e&&r.a.createElement(b,{backOptions:e}),!e&&t&&r.a.createElement(r.a.Fragment,null,t),y||r.a.createElement(u.a,{draggableArguments:o,title:f,badgeOptions:a}),p&&r.a.createElement(c.a,{"data-test-subj":"header-page-subtitle",items:p}),m&&r.a.createElement(c.a,{"data-test-subj":"header-page-subtitle-2",items:m}),i&&l&&r.a.createElement(n.EuiProgress,{size:"xs",color:"accent"})),s&&r.a.createElement(n.EuiPageHeaderSection,{"data-test-subj":"header-page-supplements"},s)),r.a.createElement(n.EuiSpacer,{size:"l"})),y=r.a.memo(f)},function(e,t,a){"use strict";a.d(t,"b",(function(){return E})),a.d(t,"g",(function(){return v})),a.d(t,"d",(function(){return x})),a.d(t,"e",(function(){return k})),a.d(t,"f",(function(){return S})),a.d(t,"i",(function(){return j})),a.d(t,"h",(function(){return O})),a.d(t,"a",(function(){return T})),a.d(t,"c",(function(){return I}));var n=a(32),i=a(35),r=a(34),s=a(4),o=a.n(s),l=a(33),c=a.n(l),u=a(102),d=a(88),p=a(87),m=(a(101),a(89)),g=a(160),b=a(430),f=a(104),y=a(133);const h=c()(n.EuiFlexGroup).withConfig({displayName:"DraggableContainerFlexGroup",componentId:"sc-1lhdirr-0"})(["flex-grow:unset;"]),E="ip-overview",v=(e,t,a,i)=>e.length>0&&e.every((e=>Object(r.getOr)(null,e,t)))?o.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},e.map(((e,l)=>{const c=Object(r.getOr)("",e,t);return o.a.createElement(s.Fragment,{key:`${E}-${e}`},l?", ":"",o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(d.b,{id:`location-renderer-default-draggable-${E}-${a?`${a}-`:""}${e}`,isDraggable:null!=i&&i,field:e,value:c,isAggregatable:!0,fieldType:"keyword"})))}))):Object(p.d)(),x=(e,t,a,i)=>e&&e.organization&&e.organization.name&&e.number?o.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(d.b,{id:`autonomous-system-renderer-default-draggable-${E}-${a?`${a}-`:""}${t}.as.organization.name`,isDraggable:null!=i&&i,field:`${t}.as.organization.name`,value:e.organization.name})),o.a.createElement(n.EuiFlexItem,{grow:!1},"/"),o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(d.b,{id:`autonomous-system-renderer-default-draggable-${E}-${a?`${a}-`:""}${t}.as.number`,isDraggable:!1,field:`${t}.as.number`,value:`${e.number}`,isAggregatable:!0,fieldType:"number"}))):Object(p.d)(),k=({contextID:e,host:t,isDraggable:a=!1,ipFilter:n,noLink:i})=>t.id&&t.ip&&(null==n||t.ip.includes(n))?o.a.createElement(o.a.Fragment,null,t.name&&null!=t.name[0]?o.a.createElement(d.b,{id:`host-id-renderer-default-draggable-${E}-${e?`${e}-`:""}host-id`,isDraggable:a,field:"host.id",value:t.id[0],isAggregatable:!0,fieldType:"keyword"},i?o.a.createElement(o.a.Fragment,null,t.id):o.a.createElement(m.d,{hostName:t.name[0]},t.id)):o.a.createElement(o.a.Fragment,null,t.id)):Object(p.d)(),S=(e,t,a,n)=>e&&e.name&&e.name[0]&&e.ip&&(null==t||e.ip.includes(t))?o.a.createElement(d.b,{id:`host-name-renderer-default-draggable-${E}-${a?`${a}-`:""}host-name`,isDraggable:null!=n&&n,field:"host.name",value:e.name[0],isAggregatable:!0,fieldType:"keyword"},o.a.createElement(m.d,{hostName:e.name[0]},e.name?e.name:Object(p.d)())):Object(p.d)(),j=e=>o.a.createElement(m.n,{domain:e},b.n),O=e=>o.a.createElement(m.j,{domain:e,direction:"column"}),w=({attrName:e,displayCount:t=1,idPrefix:a,isDraggable:i=!1,moreMaxHeight:r="200px",render:s,rowItems:l})=>{if(null!=l&&l.length>0){const c=l.slice(0,t).map(((t,r)=>{const l=Object(u.h)(`default-field-renderer-default-draggable-${a}-${e}-${t}`);return o.a.createElement(n.EuiFlexItem,{key:l,grow:!1},0!==r&&o.a.createElement(o.a.Fragment,null,",",o.a.createElement(g.i,null)),"string"==typeof t&&o.a.createElement(d.b,{id:l,isDraggable:i,field:e,value:t,isAggregatable:!0,fieldType:"keyword"},s?s(t):t))}));return c.length>0?o.a.createElement(h,{alignItems:"center",gutterSize:"none",component:"span","data-test-subj":"DefaultFieldRendererComponent"},o.a.createElement(n.EuiFlexItem,{grow:!1},c," "),o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(C,{attrName:e,fieldType:"keyword",idPrefix:a,isAggregatable:!0,moreMaxHeight:r,overflowIndexStart:t,render:s,rowItems:l}))):Object(p.d)()}return Object(p.d)()},T=o.a.memo(w);T.displayName="DefaultFieldRenderer";const I=o.a.memo((({attrName:e,dragDisplayValue:t,fieldType:a,idPrefix:i,isAggregatable:r,moreMaxHeight:l,overflowIndexStart:c,render:d,rowItems:m})=>{const g=Object(s.useMemo)((()=>m.slice(c).reduce(((s,l,c)=>{const m=Object(u.h)(`${i}-${e}-${l}-${c}`),g="string"==typeof l&&null!=e?{and:[],enabled:!0,id:m,name:l,excluded:!1,kqlQuery:"",queryMatch:{field:e,value:l,displayValue:null!=t?t:l,operator:f.a}}:void 0;return null!=g&&s.push(o.a.createElement(n.EuiFlexItem,{key:`${i}-${m}`},o.a.createElement(y.b,{dataProvider:g,isDraggable:!1,render:()=>{var e;return null!==(e=d&&d(l))&&void 0!==e?e:Object(p.a)(l)},scopeId:void 0,fieldType:a,isAggregatable:r}))),s}),[])),[e,t,a,i,r,c,d,m]),b=Object(s.useMemo)((()=>m.slice(c).map(((e,t)=>{var a;return o.a.createElement(n.EuiFlexItem,{grow:1,key:`${e}-${t}`},null!==(a=d&&d(e))&&void 0!==a?a:Object(p.a)(e))}))),[c,d,m]);return o.a.createElement("div",{"data-test-subj":"more-container",className:"eui-yScroll",style:{maxHeight:l,paddingRight:"2px"}},o.a.createElement(n.EuiFlexGroup,{gutterSize:"s",direction:"column","data-test-subj":"overflow-items"},null!=e?g:b))}));I.displayName="MoreContainer";const C=o.a.memo((({attrName:e,idPrefix:t,moreMaxHeight:a,overflowIndexStart:r=5,render:l,rowItems:c,fieldType:u,isAggregatable:d})=>{const[p,m]=Object(s.useState)(!1),g=Object(s.useCallback)((()=>m((e=>!e))),[]),b=Object(s.useMemo)((()=>o.a.createElement(o.a.Fragment,null," ,",o.a.createElement(n.EuiButtonEmpty,{size:"xs",onClick:g,"data-test-subj":"DefaultFieldRendererOverflow-button"},`+${c.length-r} `,o.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.fieldRenderers.moreLabel",defaultMessage:"More"})))),[g,r,c.length]);return o.a.createElement(n.EuiFlexItem,{grow:!1},c.length>r&&o.a.createElement(n.EuiPopover,{id:"popover",button:b,isOpen:p,closePopover:g,repositionOnScroll:!0,panelClassName:"withHoverActions__popover"},o.a.createElement(I,{attrName:e,idPrefix:t,render:l,rowItems:c,moreMaxHeight:a,overflowIndexStart:r,fieldType:u,isAggregatable:d})))}));C.displayName="DefaultFieldRendererOverflow"},function(e,t,a){"use strict";a.d(t,"d",(function(){return r})),a.d(t,"b",(function(){return s})),a.d(t,"c",(function(){return o})),a.d(t,"e",(function(){return l})),a.d(t,"a",(function(){return c}));var n=a(151),i=a(342);function r(e=new Map,t){const a=Array.from(t);return new Map([...e,...a.map((e=>[e,{events:[],status:"loading"}]))])}function s(e=new Map,t){const a=Array.from(t);return new Map([...e,...a.map((e=>[e,{events:[],status:"error"}]))])}function o(e=new Map,t){const a=new Map([...e]);return a.delete(t),a}function l({storedNodeInfo:e=new Map,receivedEvents:t,requestedNodes:a,numberOfRequestedEvents:r}){const s=new Map([...e]),o=t.length>=r,l=function(e){const t=new Map;for(const a of e){const e=Object(n.b)(a),r=Object(i.a)(a);if(e){const n=t.get(e);n?(n.events.push(a),n.terminated=n.terminated||r):t.set(e,{events:[a],terminated:r})}}return t}(t);for(const e of a.values())l.has(e)||(o?s.delete(e):s.set(e,{events:[],status:"running"}));for(const[e,t]of l.entries())s.set(e,{events:[...t.events],status:t.terminated?"terminated":"running"});return s}function c(e){return!e||"loading"===e.status||"error"===e.status||e.events.length<=0?void 0:e.events[0]}},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(4),i=a.n(n),r=a(141);const s=i.a.memo((({children:e})=>i.a.createElement(r.w,{className:"siemEventsTable__trSupplement--summary"},e)));s.displayName="RowRendererContainer"},function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return u}));var n=a(32),i=a(4),r=a.n(i),s=a(88),o=a(97),l=a(260);const c=r.a.memo((({contextId:e,endgamePid:t,endgameProcessName:a,eventId:i,processExecutable:l,processName:c,processPid:u,isDraggable:d})=>Object(o.e)(c)&&Object(o.e)(l)&&Object(o.e)(a)&&Object(o.e)(u)&&Object(o.e)(t)?null:r.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},Object(o.e)(c)?Object(o.e)(l)?Object(o.e)(a)?null:r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(s.c,{contextId:e,eventId:i,field:"endgame.process_name",value:a,iconType:"console",isDraggable:d,fieldType:"keyword",isAggregatable:!0})):r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(s.c,{contextId:e,eventId:i,field:"process.executable",value:l,iconType:"console",isDraggable:d,fieldType:"keyword",isAggregatable:!0})):r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(s.c,{contextId:e,eventId:i,field:"process.name",value:c,iconType:"console",isDraggable:d,fieldType:"keyword",isAggregatable:!0})),Object(o.e)(u)?Object(o.e)(t)?null:r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(s.c,{contextId:e,eventId:i,field:"endgame.pid",queryValue:String(t),value:`(${String(t)})`,isDraggable:d,fieldType:"keyword",isAggregatable:!0})):r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(s.c,{contextId:e,eventId:i,field:"process.pid",queryValue:String(u),value:`(${String(u)})`,isDraggable:d,fieldType:"keyword",isAggregatable:!0})))));c.displayName="ProcessDraggable";const u=r.a.memo((({contextId:e,endgamePid:t,endgameProcessName:a,eventId:n,processExecutable:i,processName:s,processPid:o,isDraggable:u})=>null==t&&null==a&&null==i&&null==s&&null==o?r.a.createElement(r.a.Fragment,null,l.f):r.a.createElement(c,{contextId:e,endgamePid:t,endgameProcessName:a,eventId:n,processExecutable:i,processName:s,processPid:o,isDraggable:u})));u.displayName="ProcessDraggableWithNonExistentProcess"},function(e,t,a){"use strict";a.d(t,"d",(function(){return u})),a.d(t,"c",(function(){return d})),a.d(t,"b",(function(){return p})),a.d(t,"a",(function(){return g}));var n,i,r=a(44),s=a.n(r),o=a(376),l=a(194),c=a(622);const u=(e,t)=>a=>`${c.g}: ${s()(a).format(e)} ${t?c.b(a):c.f(a)}`,d=[{text:"event.action",value:"event.action"},{text:"event.dataset",value:"event.dataset"},{text:"event.module",value:"event.module"}],p={defaultStackByOption:null!==(n=d.find((e=>"event.action"===e.text)))&&void 0!==n?n:d[0],errorMessage:c.d,histogramType:o.j.events,stackByOptions:d,subtitle:void 0,title:c.e,getLensAttributes:(e="event.action")=>({title:"Host - events",description:"",visualizationType:"lnsXY",state:{visualization:{title:"Empty XY chart",legend:{isVisible:!0,position:"right"},valueLabels:"hide",preferredSeriesType:"bar_stacked",layers:[{layerId:"0039eb0c-9a1a-4687-ae54-0f4e239bec75",accessors:["e09e0380-0740-4105-becc-0a4ca12e3944"],position:"top",seriesType:"bar_stacked",showGridlines:!1,layerType:"data",xAccessor:"aac9d7d0-13a3-480a-892b-08207a787926",splitAccessor:"34919782-4546-43a5-b668-06ac934d3acd"}],yRightExtent:{mode:"full"},yLeftExtent:{mode:"full"},axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!0}},query:{query:"",language:"kuery"},filters:[],datasourceStates:{formBased:{layers:{"0039eb0c-9a1a-4687-ae54-0f4e239bec75":{columns:{"aac9d7d0-13a3-480a-892b-08207a787926":{label:"@timestamp",dataType:"date",operationType:"date_histogram",sourceField:"@timestamp",isBucketed:!0,scale:"interval",params:{interval:"auto"}},"e09e0380-0740-4105-becc-0a4ca12e3944":{label:"Count of records",dataType:"number",operationType:"count",isBucketed:!1,scale:"ratio",sourceField:"___records___"},"34919782-4546-43a5-b668-06ac934d3acd":{label:`Top values of ${e}`,dataType:"string",operationType:"terms",scale:"ordinal",sourceField:`${e}`,isBucketed:!0,params:{size:10,orderBy:{type:"column",columnId:"e09e0380-0740-4105-becc-0a4ca12e3944"},orderDirection:"asc",otherBucket:!0,missingBucket:!1,parentFormat:{id:"terms"}}}},columnOrder:["34919782-4546-43a5-b668-06ac934d3acd","aac9d7d0-13a3-480a-892b-08207a787926","e09e0380-0740-4105-becc-0a4ca12e3944"],incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-0039eb0c-9a1a-4687-ae54-0f4e239bec75"}]})},m=[{text:"event.category",value:"event.category"},{text:"event.module",value:"event.module"}],g={defaultStackByOption:null!==(i=m.find((e=>"event.module"===e.text)))&&void 0!==i?i:m[0],errorMessage:c.c,histogramType:o.j.alerts,stackByOptions:m,subtitle:void 0,title:c.a,getLensAttributes:(e="event.module")=>({title:"External alerts",description:"",visualizationType:"lnsXY",state:{visualization:{title:"Empty XY chart",legend:{isVisible:!0,position:"right"},valueLabels:"hide",preferredSeriesType:"bar_stacked",layers:[{layerId:"a3c54471-615f-4ff9-9fda-69b5b2ea3eef",accessors:["0a923af2-c880-4aa3-aa93-a0b9c2801f6d"],position:"top",seriesType:"bar_stacked",showGridlines:!1,layerType:"data",xAccessor:"37bdf546-3c11-4b08-8c5d-e37debc44f1d",splitAccessor:"42334c6e-98d9-47a2-b4cb-a445abb44c93"}],yRightExtent:{mode:"full"},yLeftExtent:{mode:"full"}},query:{query:"",language:"kuery"},filters:[{meta:{index:"a04472fc-94a3-4b8d-ae05-9d30ea8fbd6a",alias:null,negate:!1,disabled:!1,type:"phrase",key:"event.kind",params:{query:"alert"}},query:{match_phrase:{"event.kind":"alert"}},$state:{store:"appState"}}],datasourceStates:{formBased:{layers:{"a3c54471-615f-4ff9-9fda-69b5b2ea3eef":{columns:{"37bdf546-3c11-4b08-8c5d-e37debc44f1d":{label:"@timestamp",dataType:"date",operationType:"date_histogram",sourceField:"@timestamp",isBucketed:!0,scale:"interval",params:{interval:"auto"}},"0a923af2-c880-4aa3-aa93-a0b9c2801f6d":{label:l.f,dataType:"number",operationType:"count",isBucketed:!1,scale:"ratio",sourceField:"___records___"},"42334c6e-98d9-47a2-b4cb-a445abb44c93":{label:Object(l.n)(`${e}`),dataType:"string",operationType:"terms",scale:"ordinal",sourceField:`${e}`,isBucketed:!0,params:{size:10,orderBy:{type:"column",columnId:"0a923af2-c880-4aa3-aa93-a0b9c2801f6d"},orderDirection:"desc",otherBucket:!0,missingBucket:!1,parentFormat:{id:"terms"}}}},columnOrder:["42334c6e-98d9-47a2-b4cb-a445abb44c93","37bdf546-3c11-4b08-8c5d-e37debc44f1d","0a923af2-c880-4aa3-aa93-a0b9c2801f6d"],incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-a3c54471-615f-4ff9-9fda-69b5b2ea3eef"},{type:"index-pattern",name:"723c4653-681b-4105-956e-abef287bf025",id:"{dataViewId}"},{type:"index-pattern",name:"a04472fc-94a3-4b8d-ae05-9d30ea8fbd6a",id:"{dataViewId}"}]})}},,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(4),i=a(83),r=a(84),s=a(193),o=a(404),l=a(217);const c=()=>{const[e,t]=Object(n.useState)(!0),[a,c]=Object(n.useState)({signalIndexExists:null,signalIndexName:null,signalIndexMappingOutdated:null,createDeSignalIndex:null}),{addError:u}=Object(r.a)(),{hasIndexRead:d}=Object(l.a)();return Object(n.useEffect)((()=>{let e=!0;const a=new AbortController,n=async()=>{try{t(!0);const n=await Object(s.h)({signal:a.signal});e&&null!=n&&c({signalIndexExists:!0,signalIndexName:n.name,signalIndexMappingOutdated:n.index_mapping_outdated,createDeSignalIndex:r})}catch(t){e&&(c({signalIndexExists:!1,signalIndexName:null,signalIndexMappingOutdated:null,createDeSignalIndex:r}),Object(i.t)(t)&&404!==t.body.status_code&&u(t,{title:o.c}))}e&&t(!1)},r=async()=>{let l=!1;try{t(!0),await Object(s.d)({signal:a.signal}),e&&(l=!0,n())}catch(t){e&&(Object(i.t)(t)&&409===t.body.status_code?n():(c({signalIndexExists:!1,signalIndexName:null,signalIndexMappingOutdated:null,createDeSignalIndex:r}),u(t,{title:o.d})))}e&&!l&&t(!1)};return d?n():t(!1),()=>{e=!1,a.abort()}}),[u,d]),{loading:e,...a}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(4),i=a(154);const r=()=>{const{startTransaction:e}=Object(i.a)();return{startTracking:Object(n.useCallback)((({name:t,spanName:a="fetch"})=>{const n=e({name:t,type:"http-request",options:{managed:!1}}),i=null==n?void 0:n.startSpan(a,"http-request",{blocking:!0});return{endTracking:e=>{null==n||n.addLabels({result:e}),null==i||i.end()}}}),[e])}}},,function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(4),i=a(78),r=a(98),s=a(283),o=a(84),l=a(81);const c=({id:e,filterQuery:t,kqlError:a,query:c,startDate:u,endDate:d})=>{const{addError:p}=Object(o.a)(),m=Object(i.useDispatch)(),g=Object(n.useMemo)((()=>r.a.errorsSelector()),[]),b=Object(l.a)(g),f=null==a?void 0:a.name,y=null==a?void 0:a.message;Object(n.useEffect)((()=>{if(!t&&y&&f){const t=y.split("").reduce(((e,t)=>(e<<5)-e+t.charCodeAt(0)|0),0).toString();m(s.a.addErrorHash({id:e,hash:t,title:f,message:[y]}))}}),[e,t,p,c,u,d,m,y,f]),Object(n.useEffect)((()=>{const t=b.find((t=>t.id===e));null!=t&&t.displayError&&null!=a&&(delete a.stack,p(a,{title:a.name}))}),[p,b,e,a])}},function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(32),i=a(0),r=a(35),s=a(4),o=a.n(s);const l=({count:e})=>{const[t,a,l]=Object(s.useMemo)((()=>function(e){var t;if(!Number.isFinite(e))return[e,"",""];const a=Math.pow(10,3*Math.min(Math.floor(Math.floor(Math.log10(e))/3),4)),n={compactThousands:i.i18n.translate("xpack.securitySolution.formattedNumber.compactThousands",{defaultMessage:"k"}),compactMillions:i.i18n.translate("xpack.securitySolution.formattedNumber.compactMillions",{defaultMessage:"M"}),compactBillions:i.i18n.translate("xpack.securitySolution.formattedNumber.compactBillions",{defaultMessage:"B"}),compactTrillions:i.i18n.translate("xpack.securitySolution.formattedNumber.compactTrillions",{defaultMessage:"T"})},r=new Map([[1,""],[1e3,n.compactThousands],[1e6,n.compactMillions],[1e9,n.compactBillions],[1e12,n.compactTrillions]]),s=i.i18n.translate("xpack.securitySolution.formattedNumber.compactOverflow",{defaultMessage:"+"}),o=null!==(t=r.get(a))&&void 0!==t?t:"";return[Math.floor(e/a),o,e/a%1>Number.EPSILON?s:""]}(e||0)),[e]);return null==e?null:0===e?o.a.createElement(o.a.Fragment,null,0):o.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.formattedNumber.countsLabel",description:"",defaultMessage:"{mantissa}{scale}{hasRemainder}",values:{mantissa:o.a.createElement(n.EuiI18nNumber,{value:t}),scale:a,hasRemainder:l}})},c=o.a.memo(l)},function(e,t,a){const{MAX_SAFE_COMPONENT_LENGTH:n}=a(308),i=a(307),r=(t=e.exports={}).re=[],s=t.src=[],o=t.t={};let l=0;const c=(e,t,a)=>{const n=l++;i(e,n,t),o[e]=n,s[n]=t,r[n]=new RegExp(t,a?"g":void 0)};c("NUMERICIDENTIFIER","0|[1-9]\\d*"),c("NUMERICIDENTIFIERLOOSE","[0-9]+"),c("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),c("MAINVERSION",`(${s[o.NUMERICIDENTIFIER]})\\.(${s[o.NUMERICIDENTIFIER]})\\.(${s[o.NUMERICIDENTIFIER]})`),c("MAINVERSIONLOOSE",`(${s[o.NUMERICIDENTIFIERLOOSE]})\\.(${s[o.NUMERICIDENTIFIERLOOSE]})\\.(${s[o.NUMERICIDENTIFIERLOOSE]})`),c("PRERELEASEIDENTIFIER",`(?:${s[o.NUMERICIDENTIFIER]}|${s[o.NONNUMERICIDENTIFIER]})`),c("PRERELEASEIDENTIFIERLOOSE",`(?:${s[o.NUMERICIDENTIFIERLOOSE]}|${s[o.NONNUMERICIDENTIFIER]})`),c("PRERELEASE",`(?:-(${s[o.PRERELEASEIDENTIFIER]}(?:\\.${s[o.PRERELEASEIDENTIFIER]})*))`),c("PRERELEASELOOSE",`(?:-?(${s[o.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${s[o.PRERELEASEIDENTIFIERLOOSE]})*))`),c("BUILDIDENTIFIER","[0-9A-Za-z-]+"),c("BUILD",`(?:\\+(${s[o.BUILDIDENTIFIER]}(?:\\.${s[o.BUILDIDENTIFIER]})*))`),c("FULLPLAIN",`v?${s[o.MAINVERSION]}${s[o.PRERELEASE]}?${s[o.BUILD]}?`),c("FULL",`^${s[o.FULLPLAIN]}$`),c("LOOSEPLAIN",`[v=\\s]*${s[o.MAINVERSIONLOOSE]}${s[o.PRERELEASELOOSE]}?${s[o.BUILD]}?`),c("LOOSE",`^${s[o.LOOSEPLAIN]}$`),c("GTLT","((?:<|>)?=?)"),c("XRANGEIDENTIFIERLOOSE",`${s[o.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),c("XRANGEIDENTIFIER",`${s[o.NUMERICIDENTIFIER]}|x|X|\\*`),c("XRANGEPLAIN",`[v=\\s]*(${s[o.XRANGEIDENTIFIER]})(?:\\.(${s[o.XRANGEIDENTIFIER]})(?:\\.(${s[o.XRANGEIDENTIFIER]})(?:${s[o.PRERELEASE]})?${s[o.BUILD]}?)?)?`),c("XRANGEPLAINLOOSE",`[v=\\s]*(${s[o.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[o.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[o.XRANGEIDENTIFIERLOOSE]})(?:${s[o.PRERELEASELOOSE]})?${s[o.BUILD]}?)?)?`),c("XRANGE",`^${s[o.GTLT]}\\s*${s[o.XRANGEPLAIN]}$`),c("XRANGELOOSE",`^${s[o.GTLT]}\\s*${s[o.XRANGEPLAINLOOSE]}$`),c("COERCE",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?(?:$|[^\\d])`),c("COERCERTL",s[o.COERCE],!0),c("LONETILDE","(?:~>?)"),c("TILDETRIM",`(\\s*)${s[o.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",c("TILDE",`^${s[o.LONETILDE]}${s[o.XRANGEPLAIN]}$`),c("TILDELOOSE",`^${s[o.LONETILDE]}${s[o.XRANGEPLAINLOOSE]}$`),c("LONECARET","(?:\\^)"),c("CARETTRIM",`(\\s*)${s[o.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",c("CARET",`^${s[o.LONECARET]}${s[o.XRANGEPLAIN]}$`),c("CARETLOOSE",`^${s[o.LONECARET]}${s[o.XRANGEPLAINLOOSE]}$`),c("COMPARATORLOOSE",`^${s[o.GTLT]}\\s*(${s[o.LOOSEPLAIN]})$|^$`),c("COMPARATOR",`^${s[o.GTLT]}\\s*(${s[o.FULLPLAIN]})$|^$`),c("COMPARATORTRIM",`(\\s*)${s[o.GTLT]}\\s*(${s[o.LOOSEPLAIN]}|${s[o.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",c("HYPHENRANGE",`^\\s*(${s[o.XRANGEPLAIN]})\\s+-\\s+(${s[o.XRANGEPLAIN]})\\s*$`),c("HYPHENRANGELOOSE",`^\\s*(${s[o.XRANGEPLAINLOOSE]})\\s+-\\s+(${s[o.XRANGEPLAINLOOSE]})\\s*$`),c("STAR","(<|>)?=?\\s*\\*"),c("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),c("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return r})),a.d(t,"d",(function(){return n})),a.d(t,"e",(function(){return v})),a.d(t,"c",(function(){return x}));var n={};a.r(n),a.d(n,"authenticationsSelector",(function(){return c})),a.d(n,"hostsSelector",(function(){return u})),a.d(n,"hostRiskScoreSelector",(function(){return d})),a.d(n,"hostRiskScoreSeverityFilterSelector",(function(){return p})),a.d(n,"uncommonProcessesSelector",(function(){return m})),a.d(n,"hostsAnomaliesJobIdFilterSelector",(function(){return g})),a.d(n,"hostsAnomaliesIntervalSelector",(function(){return b}));var i=a(406),r=a(134),s=a(34),o=a(108);const l=(e,t)=>Object(s.get)(t,e.hosts),c=()=>Object(o.createSelector)(l,(e=>e.queries.authentications)),u=()=>Object(o.createSelector)(l,(e=>e.queries[r.HostsTableType.hosts])),d=()=>Object(o.createSelector)(l,(e=>e.queries[r.HostsTableType.risk])),p=()=>Object(o.createSelector)(l,(e=>e.queries[r.HostsTableType.risk].severitySelection)),m=()=>Object(o.createSelector)(l,(e=>e.queries.uncommonProcesses)),g=()=>Object(o.createSelector)(l,(e=>e.queries[r.HostsTableType.anomalies].jobIdSelection)),b=()=>Object(o.createSelector)(l,(e=>e.queries[r.HostsTableType.anomalies].intervalSelection));var f=a(328),y=a(85),h=a(253),E=a(602);const v={page:{queries:{[r.HostsTableType.authentications]:{activePage:h.a,limit:h.b},[r.HostsTableType.hosts]:{activePage:h.a,limit:h.b,direction:y.b.desc,sortField:y.h.lastSeen},[r.HostsTableType.events]:{activePage:h.a,limit:h.b},[r.HostsTableType.uncommonProcesses]:{activePage:h.a,limit:h.b},[r.HostsTableType.anomalies]:{jobIdSelection:[],intervalSelection:"auto"},[r.HostsTableType.risk]:{activePage:h.a,limit:h.b,sort:{field:y.w.hostRiskScore,direction:y.b.desc},severitySelection:[]},[r.HostsTableType.sessions]:{activePage:h.a,limit:h.b}}},details:{queries:{[r.HostsTableType.authentications]:{activePage:h.a,limit:h.b},[r.HostsTableType.hosts]:{activePage:h.a,direction:y.b.desc,limit:h.b,sortField:y.h.lastSeen},[r.HostsTableType.events]:{activePage:h.a,limit:h.b},[r.HostsTableType.uncommonProcesses]:{activePage:h.a,limit:h.b},[r.HostsTableType.anomalies]:{jobIdSelection:[],intervalSelection:"auto"},[r.HostsTableType.risk]:{activePage:h.a,limit:h.b,sort:{field:y.w.hostRiskScore,direction:y.b.desc},severitySelection:[]},[r.HostsTableType.sessions]:{activePage:h.a,limit:h.b}}}},x=Object(f.reducerWithInitialState)(v).case(i.setHostTablesActivePageToZero,(e=>({...e,page:{...e.page,queries:Object(E.c)(e)},details:{...e.details,queries:Object(E.b)(e)}}))).case(i.setHostDetailsTablesActivePageToZero,(e=>({...e,details:{...e.details,queries:Object(E.b)(e)}}))).case(i.updateTableActivePage,((e,{activePage:t,hostsType:a,tableType:n})=>({...e,[a]:{...e[a],queries:{...e[a].queries,[n]:{...e[a].queries[n],activePage:t}}}}))).case(i.updateTableLimit,((e,{limit:t,hostsType:a,tableType:n})=>({...e,[a]:{...e[a],queries:{...e[a].queries,[n]:{...e[a].queries[n],limit:t}}}}))).case(i.updateHostsSort,((e,{sort:t,hostsType:a})=>({...e,[a]:{...e[a],queries:{...e[a].queries,[r.HostsTableType.hosts]:{...e[a].queries[r.HostsTableType.hosts],direction:t.direction,sortField:t.field,activePage:h.a}}}}))).case(i.updateHostRiskScoreSort,((e,{sort:t,hostsType:a})=>({...e,[a]:{...e[a],queries:{...e[a].queries,[r.HostsTableType.risk]:{...e[a].queries[r.HostsTableType.risk],sort:t}}}}))).case(i.updateHostRiskScoreSeverityFilter,((e,{severitySelection:t,hostsType:a})=>({...e,[a]:{...e[a],queries:{...e[a].queries,[r.HostsTableType.risk]:{...e[a].queries[r.HostsTableType.risk],severitySelection:t,activePage:h.a}}}}))).case(i.updateHostsAnomaliesJobIdFilter,((e,{jobIds:t,hostsType:a})=>({...e,[a]:{...e[a],queries:{...e[a].queries,[r.HostsTableType.anomalies]:{...e[a].queries[r.HostsTableType.anomalies],jobIdSelection:t}}}}))).case(i.updateHostsAnomaliesInterval,((e,{interval:t,hostsType:a})=>({...e,[a]:{...e[a],queries:{...e[a].queries,[r.HostsTableType.anomalies]:{...e[a].queries[r.HostsTableType.anomalies],intervalSelection:t}}}}))).build()},function(e,t,a){"use strict";a.d(t,"a",(function(){return x})),a.d(t,"b",(function(){return k})),a.d(t,"c",(function(){return S}));var n=a(32),i=a(4),r=a.n(i),s=a(34),o=a(83),l=a(123),c=a(141),u=a(82),d=a.n(u);const p=({rowIndex:e,colIndex:t,data:a,header:n,eventId:s,linkValues:o,renderCellValue:l,tabType:c,timelineId:u})=>{const[p,m]=Object(i.useState)({});return r.a.createElement("div",d()({"data-test-subj":"statefulCell"},p),l({columnId:n.id,eventId:s,data:a,header:n,isDraggable:!0,isExpandable:!0,isExpanded:!1,isDetails:!1,isTimeline:!0,linkValues:o,rowIndex:e,colIndex:t,setCellProps:m,scopeId:u,key:null!=c?`${u}-${c}`:u}))};p.displayName="StatefulCellComponent";const m=r.a.memo(p);var g=a(0);const b=({column:e,row:t})=>g.i18n.translate("xpack.securitySolution.timeline.youAreInATableCellScreenReaderOnly",{values:{column:e,row:t},defaultMessage:"You are in a table cell. row: {row}, column: {column}"}),f=e=>g.i18n.translate("xpack.securitySolution.timeline.eventHasEventRendererScreenReaderOnly",{values:{row:e},defaultMessage:"The event in row {row} has an event renderer. Press shift + down arrow to focus it."}),y=({notesCount:e,row:t})=>g.i18n.translate("xpack.securitySolution.timeline.eventHasNotesScreenReaderOnly",{values:{notesCount:e,row:t},defaultMessage:"The event in row {row} has {notesCount, plural, =1 {a note} other {{notesCount} notes}}. Press shift + right arrow to focus notes."}),h=e=>{var t;const{altKey:a,ctrlKey:n,key:i,metaKey:r,shiftKey:s,target:l,type:u}=e,d=l;if((e=>{switch(e){case" ":case"Enter":return!0;default:return!1}})(i)&&null!==(t=d.className)&&void 0!==t&&t.includes(c.b)){const t=d.querySelector(`.${o.a}`),l=new KeyboardEvent(u,{altKey:a,bubbles:!0,cancelable:!0,ctrlKey:n,key:i,metaKey:r,shiftKey:s});" "===i&&e.preventDefault(),null==t||t.dispatchEvent(l)}},E=({action:e,width:t,actionsColumnWidth:a,ariaRowindex:i,columnId:s,columnValues:o,data:u,ecsData:d,eventIdToNoteIds:p,index:m,isEventPinned:g,isEventViewer:E,eventId:v,loadingEventIds:x,notesCount:k,onEventDetailsPanelOpened:S,onRowSelected:j,refetch:O,rowIndex:w,hasRowRenderers:T,onRuleChange:I,selectedEventIds:C,showCheckboxes:M,showNotes:F,tabType:D,timelineId:A,toggleShowNotes:_,setEventsLoading:N,setEventsDeleted:R})=>{const P=t||a;return r.a.createElement(c.m,{width:P,"data-test-subj":"event-actions-container",tabIndex:0},r.a.createElement(c.k,{$ariaColumnIndex:m+l.c,key:null!=D?`${v}_${D}`:`${v}`,onKeyDown:h,role:"button",tabIndex:0,width:t},r.a.createElement(c.l,{"data-test-subj":"cell-container"},r.a.createElement(r.a.Fragment,null,r.a.createElement(n.EuiScreenReaderOnly,{"data-test-subj":"screenReaderOnly"},r.a.createElement("p",null,b({row:i,column:m+2}))),e&&r.a.createElement(e,{ariaRowindex:i,width:t,checked:Object.keys(C).includes(v),columnId:s,columnValues:o,eventId:v,data:u,ecsData:d,eventIdToNoteIds:p,index:m,isEventPinned:g,isEventViewer:E,loadingEventIds:x,onEventDetailsPanelOpened:S,onRowSelected:j,refetch:O,rowIndex:w,onRuleChange:I,showCheckboxes:M,showNotes:F,timelineId:A,toggleShowNotes:_,setEventsLoading:N,setEventsDeleted:R}))),T?r.a.createElement(n.EuiScreenReaderOnly,{"data-test-subj":"hasRowRendererScreenReaderOnly"},r.a.createElement("p",null,f(i))):null,k?r.a.createElement(n.EuiScreenReaderOnly,{"data-test-subj":"hasNotesScreenReaderOnly"},r.a.createElement("p",null,y({row:i,notesCount:k}))):null))},v=({_id:e,ariaRowindex:t,index:a,header:i,data:o,ecsData:u,hasRowRenderers:d,notesCount:p,renderCellValue:g,tabType:E,timelineId:v})=>{var x;const k=a+l.c;return r.a.createElement(c.k,{$ariaColumnIndex:k,key:null!=E?`${i.id}_${E}`:`${i.id}`,onKeyDown:h,role:"button",tabIndex:0,width:i.initialWidth},r.a.createElement(c.l,{"data-test-subj":"cell-container"},r.a.createElement(r.a.Fragment,null,r.a.createElement(n.EuiScreenReaderOnly,{"data-test-subj":"screenReaderOnly"},r.a.createElement("p",null,b({row:t,column:k}))),r.a.createElement(m,{rowIndex:t-1,colIndex:k-1,data:o,header:i,eventId:e,linkValues:Object(s.getOr)([],null!==(x=i.linkField)&&void 0!==x?x:"",u),renderCellValue:g,tabType:E,timelineId:v}))),d?r.a.createElement(n.EuiScreenReaderOnly,{"data-test-subj":"hasRowRendererScreenReaderOnly"},r.a.createElement("p",null,f(t))):null,p?r.a.createElement(n.EuiScreenReaderOnly,{"data-test-subj":"hasNotesScreenReaderOnly"},r.a.createElement("p",null,y({row:t,notesCount:p}))):null)},x=r.a.memo((({ariaRowindex:e,actionsColumnWidth:t,columnHeaders:a,columnValues:n,data:s,ecsData:o,eventIdToNoteIds:l,isEventPinned:u,isEventViewer:d,id:p,loadingEventIds:m,notesCount:g,onEventDetailsPanelOpened:b,onRowSelected:f,refetch:y,hasRowRenderers:h,onRuleChange:x,renderCellValue:k,selectedEventIds:S,showCheckboxes:j,showNotes:O,tabType:w,timelineId:T,toggleShowNotes:I,trailingControlColumns:C,leadingControlColumns:M,setEventsLoading:F,setEventsDeleted:D})=>{const A=Object(i.useMemo)((()=>C?C.map((e=>e.rowCellRender)):[]),[C]),_=Object(i.useMemo)((()=>M.length+a.length),[M,a]),N=Object(i.useMemo)((()=>A.map(((a,i)=>a&&r.a.createElement(E,{action:a,width:C[i].width,actionsColumnWidth:t,ariaRowindex:e,checked:Object.keys(S).includes(p),columnId:C[i].id||"",columnValues:n,onRowSelected:f,"data-test-subj":"actions",eventId:p,data:s,key:i,index:_+i,rowIndex:e,ecsData:o,loadingEventIds:m,onEventDetailsPanelOpened:b,showCheckboxes:j,eventIdToNoteIds:l,isEventPinned:u,isEventViewer:d,notesCount:g,refetch:y,hasRowRenderers:h,onRuleChange:x,selectedEventIds:S,showNotes:O,tabType:w,timelineId:T,toggleShowNotes:I,setEventsLoading:F,setEventsDeleted:D})))),[C,p,s,o,f,u,d,t,e,n,l,h,_,m,g,b,x,y,S,j,O,w,T,I,A,F,D]),R=Object(i.useMemo)((()=>a.map(((t,a)=>r.a.createElement(v,{_id:p,index:a,header:t,key:null!=w?`${t.id}_${w}`:`${t.id}`,ariaRowindex:e,data:s,ecsData:o,hasRowRenderers:h,notesCount:g,renderCellValue:k,tabType:w,timelineId:T})))),[p,e,a,s,o,h,g,k,w,T]);return r.a.createElement(c.n,{"data-test-subj":"data-driven-columns"},R,N)}));x.displayName="DataDrivenColumns";const k=({data:e,fieldName:t})=>{if(!e||0===e.length)return;const a=e.find((e=>e.field===t));return null!=a&&null!=a.value?a.value:void 0},S=({data:e,fieldName:t})=>Object(i.useMemo)((()=>k({data:e,fieldName:t})),[e,t])},function(e,t,a){"use strict";a.d(t,"a",(function(){return b})),a.d(t,"b",(function(){return f})),a.d(t,"c",(function(){return y}));var n=a(4),i=a.n(n),r=a(1),s=a(679),o=a(77),l=a(719),c=a(7);const u=(e,t,a)=>e>t?a:e<t?-a:0,d={filter:"",tags:[],showCustomRules:!1,showElasticRules:!1},p={field:"enabled",order:"desc"},m=Object(n.createContext)(null),g="detection-rules-table-in-memory",b=({children:e})=>{var t;const[a]=Object(o.q)(r.cb),{storage:s}=Object(o.k)().services,[b,f]=Object(n.useState)(null!==(t=s.get(g))&&void 0!==t&&t),[y,h]=Object(n.useState)(d),[E,v]=Object(n.useState)(p),[x,k]=Object(n.useState)(!1),[S,j]=Object(n.useState)(a.on),[O,w]=Object(n.useState)({ids:[],action:null}),[T,I]=Object(n.useState)(!1),[C,M]=Object(n.useState)(1),[F,D]=Object(n.useState)(20),[A,_]=Object(n.useState)([]),N=Object(n.useRef)(null),R=Object(n.useCallback)((e=>{f(e),s.set(g,e),!1===e&&v(p)}),[s]),P=O.ids.length>0,L=Object(n.useMemo)((()=>({page:C,perPage:F})),[C,F]),B=Object(n.useCallback)((e=>{h((t=>({...t,...e}))),M(1),_([]),k(!1)}),[]),q=Object(n.useCallback)((()=>{_([]),k(!1)}),[]);Object(n.useEffect)((()=>{var e;A.length>0?(j(!1),null==N.current&&(N.current=S)):(j(null!==(e=N.current)&&void 0!==e?e:S),N.current=null)}),[A,S]);const{data:{rules:z,total:$}={rules:[],total:0},refetch:V,dataUpdatedAt:U,isFetched:H,isFetching:G,isLoading:Q,isRefetching:W}=Object(l.a)({isInMemorySorting:b,filterOptions:y,sortingOptions:E,pagination:L,refetchInterval:S&&!P&&a.value}),K=b?z.sort(function(e){return(t,a)=>{const{field:n,order:i}=e,r="asc"===i?1:-1;switch(n){case"enabled":{const e=Object(c.get)(t,n),i=Object(c.get)(a,n);return u(Number(e),Number(i),r)}case"version":case"risk_score":case"execution_summary.last_execution.metrics.execution_gap_duration_s":case"execution_summary.last_execution.metrics.total_indexing_duration_ms":case"execution_summary.last_execution.metrics.total_search_duration_ms":{var s,o;const e=null!==(s=Object(c.get)(t,n))&&void 0!==s?s:-1/0,i=null!==(o=Object(c.get)(a,n))&&void 0!==o?o:-1/0;return u(e,i,r)}case"updated_at":case"created_at":case"execution_summary.last_execution.date":{const e=Object(c.get)(t,n),i=Object(c.get)(a,n);return u(null==e?0:new Date(e).getTime(),null==i?0:new Date(i).getTime(),r)}case"execution_summary.last_execution.status":case"severity":case"name":{const e=Object(c.get)(t,n),i=Object(c.get)(a,n);return(e||"").localeCompare(i||"")*r}}}}(E)).slice((C-1)*F,C*F):z,Y=Object(n.useMemo)((()=>({state:{rules:K,pagination:{page:C,perPage:F,total:b?z.length:$},filterOptions:y,isPreflightInProgress:T,isActionInProgress:P,isAllSelected:x,isFetched:H,isFetching:G,isInMemorySorting:b,isLoading:Q,isRefetching:W,isRefreshOn:S,lastUpdated:U,loadingRuleIds:O.ids,loadingRulesAction:O.action,selectedRuleIds:A,sortingOptions:E},actions:{reFetchRules:V,setFilterOptions:B,setIsAllSelected:k,setIsInMemorySorting:R,setIsRefreshOn:j,setLoadingRules:w,setPage:M,setPerPage:D,setSelectedRuleIds:_,setSortingOptions:v,setIsPreflightInProgress:I,clearRulesSelection:q}})),[K,C,F,b,z.length,$,y,T,P,x,H,G,Q,W,S,U,O.ids,O.action,A,E,V,B,R,q]);return i.a.createElement(m.Provider,{value:Y},e)},f=()=>{const e=Object(n.useContext)(m);return Object(s.a)(e,"useRulesTableContext should be used inside RulesTableContextProvider"),e},y=()=>Object(n.useContext)(m)},,,function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n="row-renderer-example"},function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"j",(function(){return r})),a.d(t,"l",(function(){return s})),a.d(t,"k",(function(){return o})),a.d(t,"f",(function(){return l})),a.d(t,"i",(function(){return c})),a.d(t,"h",(function(){return u})),a.d(t,"g",(function(){return d})),a.d(t,"a",(function(){return p})),a.d(t,"c",(function(){return m})),a.d(t,"e",(function(){return g})),a.d(t,"d",(function(){return b}));var n=a(0);n.i18n.translate("xpack.securitySolution.timeline.properties.timelineDescription",{defaultMessage:"Timeline Description"});const i=n.i18n.translate("xpack.securitySolution.timeline.properties.addToFavoriteButtonLabel",{defaultMessage:"Add to favorites"}),r=n.i18n.translate("xpack.securitySolution.timeline.properties.removeFromFavoritesButtonLabel",{defaultMessage:"Remove from favorites"}),s=n.i18n.translate("xpack.securitySolution.timeline.properties.untitledTimelinePlaceholder",{defaultMessage:"Untitled timeline"}),o=n.i18n.translate("xpack.securitySolution.timeline.properties.untitledTemplatePlaceholder",{defaultMessage:"Untitled template"}),l=n.i18n.translate("xpack.securitySolution.timeline.properties.descriptionPlaceholder",{defaultMessage:"Add a description"}),c=n.i18n.translate("xpack.securitySolution.timeline.properties.notesButtonLabel",{defaultMessage:"Notes"}),u=n.i18n.translate("xpack.securitySolution.timeline.properties.newTimelineButtonLabel",{defaultMessage:"Create new timeline"}),d=n.i18n.translate("xpack.securitySolution.timeline.properties.newTemplateTimelineButtonLabel",{defaultMessage:"Create new timeline template"}),p=n.i18n.translate("xpack.securitySolution.timeline.properties.addTimelineButtonLabel",{defaultMessage:"Add new timeline or template"}),m=n.i18n.translate("xpack.securitySolution.timeline.properties.attachToCaseButtonLabel",{defaultMessage:"Attach to case"}),g=n.i18n.translate("xpack.securitySolution.timeline.properties.attachToNewCaseButtonLabel",{defaultMessage:"Attach to new case"}),b=n.i18n.translate("xpack.securitySolution.timeline.properties.attachToExistingCaseButtonLabel",{defaultMessage:"Attach to existing case"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(4),i=a(77);const r=(e,t)=>{const{services:a}=Object(i.k)(),{path:r,state:s,onClick:o,deepLinkId:l,openInNewTab:c}=t||{};return Object(n.useCallback)((t=>{try{o&&o(t)}catch(e){throw t.preventDefault(),e}t.defaultPrevented||0===t.button&&(t.currentTarget instanceof HTMLAnchorElement&&""!==t.currentTarget.target&&"_self"!==t.currentTarget.target||t.metaKey||t.altKey||t.ctrlKey||t.shiftKey||(t.preventDefault(),a.application.navigateToApp(e,{deepLinkId:l,path:r,state:s,openInNewTab:c})))}),[e,l,o,r,a.application,s,c])}},,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return m})),a.d(t,"b",(function(){return h})),a.d(t,"c",(function(){return E})),a.d(t,"d",(function(){return v})),a.d(t,"e",(function(){return x}));var n=a(4),i=a.n(n),r=a(33),s=a.n(r);const o=s.a.aside.attrs({className:"siemUtilityBar"}).withConfig({displayName:"Bar",componentId:"sc-1kna171-0"})(["",""],(({border:e,theme:t})=>Object(r.css)([""," @media only screen and (min-width:","){display:flex;justify-content:space-between;}"],e&&Object(r.css)(["border-bottom:",";padding-bottom:",";"],t.eui.euiBorderThin,t.eui.euiSizeS),t.eui.euiBreakpoints.l)));o.displayName="Bar";const l=s.a.div.attrs({className:"siemUtilityBar__section"}).withConfig({displayName:"BarSection",componentId:"sc-1kna171-1"})(["",""],(({grow:e,theme:t})=>Object(r.css)(["& + &{margin-top:",";}@media only screen and (min-width:","){display:flex;flex-wrap:wrap;}@media only screen and (min-width:","){& + &{margin-top:0;margin-left:",";}}",""],t.eui.euiSizeS,t.eui.euiBreakpoints.m,t.eui.euiBreakpoints.l,t.eui.euiSize,e&&Object(r.css)(["flex:1;"]))));l.displayName="BarSection";const c=s.a.div.attrs({className:"siemUtilityBar__group"}).withConfig({displayName:"BarGroup",componentId:"sc-1kna171-2"})(["",""],(({grow:e,theme:t})=>Object(r.css)(["align-items:flex-start;display:flex;flex-wrap:wrap;& + &{margin-top:",";}@media only screen and (min-width:","){border-right:",";flex-wrap:nowrap;margin-right:",";padding-right:",";& + &{margin-top:0;}&:last-child{border-right:none;margin-right:0;padding-right:0;}}& > *{margin-right:",";&:last-child{margin-right:0;}}",""],t.eui.euiSizeS,t.eui.euiBreakpoints.m,t.eui.euiBorderThin,t.eui.euiSizeM,t.eui.euiSizeM,t.eui.euiSize,e&&Object(r.css)(["flex:1;"]))));c.displayName="BarGroup";const u=s.a.p.attrs({className:"siemUtilityBar__text"}).withConfig({displayName:"BarText",componentId:"sc-1kna171-3"})(["",""],(({shouldWrap:e,theme:t})=>Object(r.css)(["color:",";font-size:",";line-height:",";white-space:",";"],t.eui.euiTextSubduedColor,t.eui.euiFontSizeXS,t.eui.euiLineHeight,e?"normal":"nowrap")));u.displayName="BarText";const d=s.a.div.attrs({className:"siemUtilityBar__action"}).withConfig({displayName:"BarAction",componentId:"sc-1kna171-4"})(["",""],(({theme:e})=>Object(r.css)(["font-size:",";line-height:",";"],e.eui.euiFontSizeXS,e.eui.euiLineHeight)));d.displayName="BarAction";const p=s.a.div.attrs({className:"siemUtilityBar__spacer"}).withConfig({displayName:"BarSpacer",componentId:"sc-1kna171-5"})(["",""],(()=>Object(r.css)(["flex:1;"])));p.displayName="BarSpacer";const m=i.a.memo((({border:e,children:t})=>i.a.createElement(o,{border:e},t)));m.displayName="UtilityBar";var g=a(32),b=a(607);const f=s()(g.EuiButtonEmpty).withConfig({displayName:"LoadingButtonEmpty",componentId:"sc-8y0kr-0"})(["",""],(({theme:e})=>Object(r.css)(["&.euiButtonEmpty.euiButtonEmpty--xSmall{height:",";.euiButtonEmpty__content{padding:0;}}"],e.eui.euiSize))),y=i.a.memo((({children:e,color:t,iconSide:a,iconSize:r,iconType:s,popoverContent:o,disabled:l,ownFocus:c,dataTestSubj:u,popoverPanelPaddingSize:d,onClick:p})=>{const[m,f]=Object(n.useState)(!1),y=Object(n.useCallback)((()=>f(!1)),[f]),h=Object(n.useCallback)((()=>{null==p||p(),f(!m)}),[m,p]);return i.a.createElement(g.EuiPopover,{ownFocus:c,panelPaddingSize:d,button:i.a.createElement(b.a,{dataTestSubj:u,color:t,iconSide:a,iconSize:r,iconType:s,disabled:l,onClick:h},e),closePopover:y,isOpen:m,repositionOnScroll:!0},null==o?void 0:o(y))}));y.displayName="Popover";const h=i.a.memo((({children:e,color:t,dataTestSubj:a,disabled:n,href:r,iconSide:s,iconSize:o,iconType:l,ownFocus:c,onClick:u,popoverContent:p,popoverPanelPaddingSize:m,inProgress:g})=>g?i.a.createElement(d,null,i.a.createElement(f,{"data-test-subj":`${a}-progress`,size:"xs",className:"eui-alignTop",isLoading:!0,iconSide:"right"},e)):i.a.createElement(d,{"data-test-subj":a},p?i.a.createElement(y,{dataTestSubj:`${a}-popover`,disabled:n,color:t,iconSide:s,iconSize:o,iconType:l,ownFocus:c,popoverPanelPaddingSize:m,popoverContent:p,onClick:u},e):i.a.createElement(b.a,{color:t,dataTestSubj:`${a}-linkIcon`,disabled:n,href:r,iconSide:s,iconSize:o,iconType:l,onClick:u},e))));h.displayName="UtilityBarAction";const E=i.a.memo((({grow:e,children:t})=>i.a.createElement(c,{grow:e},t)));E.displayName="UtilityBarGroup";const v=i.a.memo((({grow:e,children:t,dataTestSubj:a})=>i.a.createElement(l,{grow:e,"data-test-subj":a},t)));v.displayName="UtilityBarSection",i.a.memo((({dataTestSubj:e})=>i.a.createElement(p,{"data-test-subj":e}))).displayName="UtilityBarSpacer";const x=i.a.memo((({children:e,dataTestSubj:t,shouldWrap:a=!1})=>i.a.createElement(u,{"data-test-subj":t,shouldWrap:a},e)));x.displayName="UtilityBarText"},function(e,t,a){"use strict";a.d(t,"a",(function(){return b})),a.d(t,"b",(function(){return f}));var n=a(4),i=a(171),r=a(259),s=a(1);const o=e=>e.groups.some((e=>s.Rb.includes(e)));var l=a(84),c=a(77),u=a(120),d=a(389),p=a(129),m=a(534);const g=Object(p.d)(m.a),b=()=>{const[e,t]=Object(n.useState)([]),{addError:a}=Object(l.a)(),s=Object(u.a)(),m=Object(c.j)(),{error:b,loading:f,result:y,start:h}=Object(p.a)(g),E=Object(i.a)(s),v=Object(r.a)(s);return Object(n.useEffect)((()=>{E&&v&&h({http:m})}),[m,E,v,h]),Object(n.useEffect)((()=>{if(y){const e=y.filter(o);t(e)}}),[y]),Object(n.useEffect)((()=>{b&&a(b,{title:d.a})}),[a,b]),{isLicensed:v,isMlUser:E,jobs:e,loading:f}},f=()=>{const{jobs:e,loading:t}=b();return{jobIds:Object(n.useMemo)((()=>e.map((e=>e.id))),[e]),loading:t}}},,function(e,t,a){"use strict";var n,i=function(){var e={};return function(t){if(void 0===e[t]){var a=document.querySelector(t);if(window.HTMLIFrameElement&&a instanceof window.HTMLIFrameElement)try{a=a.contentDocument.head}catch(e){a=null}e[t]=a}return e[t]}}(),r=[];function s(e){for(var t=-1,a=0;a<r.length;a++)if(r[a].identifier===e){t=a;break}return t}function o(e,t){for(var a={},n=[],i=0;i<e.length;i++){var o=e[i],l=t.base?o[0]+t.base:o[0],c=a[l]||0,u="".concat(l," ").concat(c);a[l]=c+1;var d=s(u),p={css:o[1],media:o[2],sourceMap:o[3]};-1!==d?(r[d].references++,r[d].updater(p)):r.push({identifier:u,updater:b(p,t),references:1}),n.push(u)}return n}function l(e){var t=document.createElement("style"),n=e.attributes||{};if(void 0===n.nonce){var r=a.nc;r&&(n.nonce=r)}if(Object.keys(n).forEach((function(e){t.setAttribute(e,n[e])})),"function"==typeof e.insert)e.insert(t);else{var s=i(e.insert||"head");if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(t)}return t}var c,u=(c=[],function(e,t){return c[e]=t,c.filter(Boolean).join("\n")});function d(e,t,a,n){var i=a?"":n.media?"@media ".concat(n.media," {").concat(n.css,"}"):n.css;if(e.styleSheet)e.styleSheet.cssText=u(t,i);else{var r=document.createTextNode(i),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(r,s[t]):e.appendChild(r)}}function p(e,t,a){var n=a.css,i=a.media,r=a.sourceMap;if(i?e.setAttribute("media",i):e.removeAttribute("media"),r&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}var m=null,g=0;function b(e,t){var a,n,i;if(t.singleton){var r=g++;a=m||(m=l(t)),n=d.bind(null,a,r,!1),i=d.bind(null,a,r,!0)}else a=l(t),n=p.bind(null,a,t),i=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(a)};return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else i()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===n&&(n=Boolean(window&&document&&document.all&&!window.atob)),n));var a=o(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var n=0;n<a.length;n++){var i=s(a[n]);r[i].references--}for(var l=o(e,t),c=0;c<a.length;c++){var u=s(a[c]);0===r[u].references&&(r[u].updater(),r.splice(u,1))}a=l}}}},function(e,t,a){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var a=function(e,t){var a,n,i,r=e[1]||"",s=e[3];if(!s)return r;if(t&&"function"==typeof btoa){var o=(a=s,n=btoa(unescape(encodeURIComponent(JSON.stringify(a)))),i="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(n),"/*# ".concat(i," */")),l=s.sources.map((function(e){return"/*# sourceURL=".concat(s.sourceRoot||"").concat(e," */")}));return[r].concat(l).concat([o]).join("\n")}return[r].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(a,"}"):a})).join("")},t.i=function(e,a,n){"string"==typeof e&&(e=[[null,e,""]]);var i={};if(n)for(var r=0;r<this.length;r++){var s=this[r][0];null!=s&&(i[s]=!0)}for(var o=0;o<e.length;o++){var l=[].concat(e[o]);n&&i[l[0]]||(a&&(l[2]?l[2]="".concat(a," and ").concat(l[2]):l[2]=a),t.push(l))}},t}},function(e,t,a){"use strict";var n=function(e){return function(e){return!!e&&"object"==typeof e}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===i}(e)}(e)},i="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function r(e,t){return!1!==t.clone&&t.isMergeableObject(e)?c((a=e,Array.isArray(a)?[]:{}),e,t):e;var a}function s(e,t,a){return e.concat(t).map((function(e){return r(e,a)}))}function o(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(t){return e.propertyIsEnumerable(t)})):[]}(e))}function l(e,t){try{return t in e}catch(e){return!1}}function c(e,t,a){(a=a||{}).arrayMerge=a.arrayMerge||s,a.isMergeableObject=a.isMergeableObject||n,a.cloneUnlessOtherwiseSpecified=r;var i=Array.isArray(t);return i===Array.isArray(e)?i?a.arrayMerge(e,t,a):function(e,t,a){var n={};return a.isMergeableObject(e)&&o(e).forEach((function(t){n[t]=r(e[t],a)})),o(t).forEach((function(i){(function(e,t){return l(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))})(e,i)||(l(e,i)&&a.isMergeableObject(t[i])?n[i]=function(e,t){if(!t.customMerge)return c;var a=t.customMerge(e);return"function"==typeof a?a:c}(i,a)(e[i],t[i],a):n[i]=r(t[i],a))})),n}(e,t,a):r(t,a)}c.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,a){return c(e,a,t)}),{})};var u=c;e.exports=u},function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return i}));const n=10,i=0},function(e,t,a){"use strict";a.d(t,"i",(function(){return i})),a.d(t,"h",(function(){return r})),a.d(t,"j",(function(){return s})),a.d(t,"q",(function(){return o})),a.d(t,"k",(function(){return l})),a.d(t,"l",(function(){return c})),a.d(t,"o",(function(){return u})),a.d(t,"p",(function(){return d})),a.d(t,"f",(function(){return p})),a.d(t,"r",(function(){return m})),a.d(t,"s",(function(){return g})),a.d(t,"a",(function(){return b})),a.d(t,"e",(function(){return f})),a.d(t,"b",(function(){return y})),a.d(t,"n",(function(){return h})),a.d(t,"c",(function(){return E})),a.d(t,"m",(function(){return v})),a.d(t,"d",(function(){return x})),a.d(t,"g",(function(){return k}));var n=a(0);const i=n.i18n.translate("xpack.securitySolution.timeline.body.notes.addNoteTooltip",{defaultMessage:"Add note"}),r=n.i18n.translate("xpack.securitySolution.timeline.body.notes.disableEventTooltip",{defaultMessage:"Notes may not be added here while editing a template timeline"}),s=n.i18n.translate("xpack.securitySolution.timeline.body.openSessionViewLabel",{defaultMessage:"Open Session View"}),o=e=>n.i18n.translate("xpack.securitySolution.timeline.body.pinning.pinTooltip",{values:{isAlert:e},defaultMessage:"Pin {isAlert, select, true{alert} other{event}}"}),l=e=>n.i18n.translate("xpack.securitySolution.timeline.body.pinning.unpinTooltip",{values:{isAlert:e},defaultMessage:"Unpin {isAlert, select, true{alert} other{event}}"}),c=e=>n.i18n.translate("xpack.securitySolution.timeline.body.pinning.pinnnedWithNotesTooltip",{values:{isAlert:e},defaultMessage:"This {isAlert, select, true{alert} other{event}} cannot be unpinned because it has notes"}),u=n.i18n.translate("xpack.securitySolution.timeline.body.sort.sortedAscendingTooltip",{defaultMessage:"Sorted ascending"}),d=n.i18n.translate("xpack.securitySolution.timeline.body.sort.sortedDescendingTooltip",{defaultMessage:"Sorted descending"}),p=e=>n.i18n.translate("xpack.securitySolution.timeline.body.pinning.disablePinnnedTooltip",{values:{isAlert:e},defaultMessage:"This {isAlert, select, true{alert} other{event}} may not be pinned while editing a template timeline"}),m=n.i18n.translate("xpack.securitySolution.timeline.body.actions.viewDetailsAriaLabel",{defaultMessage:"View details"}),g=({ariaRowindex:e,columnValues:t})=>n.i18n.translate("xpack.securitySolution.timeline.body.actions.viewDetailsForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t},defaultMessage:"View details for the alert or event in row {ariaRowindex}, with columns {columnValues}"}),b=n.i18n.translate("xpack.securitySolution.timeline.body.actions.investigateInResolverTooltip",{defaultMessage:"Analyze event"}),f=({ariaRowindex:e,columnValues:t,checked:a})=>n.i18n.translate("xpack.securitySolution.timeline.body.actions.checkboxForRowAriaLabel",{values:{ariaRowindex:e,checked:a,columnValues:t},defaultMessage:"{checked, select, false {unchecked} true {checked}} checkbox for the alert or event in row {ariaRowindex}, with columns {columnValues}"}),y=({ariaRowindex:e,columnValues:t})=>n.i18n.translate("xpack.securitySolution.timeline.body.actions.investigateInResolverForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t},defaultMessage:"Analyze the alert or event in row {ariaRowindex}, with columns {columnValues}"}),h=({ariaRowindex:e,columnValues:t})=>n.i18n.translate("xpack.securitySolution.timeline.body.actions.sendAlertToTimelineForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t},defaultMessage:"Send the alert in row {ariaRowindex} to timeline, with columns {columnValues}"}),E=({ariaRowindex:e,columnValues:t})=>n.i18n.translate("xpack.securitySolution.timeline.body.actions.addNotesForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t},defaultMessage:"Add notes for the event in row {ariaRowindex} to timeline, with columns {columnValues}"}),v=({ariaRowindex:e,columnValues:t,isEventPinned:a})=>n.i18n.translate("xpack.securitySolution.timeline.body.actions.pinEventForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t,isEventPinned:a},defaultMessage:"{isEventPinned, select, false {Pin} true {Unpin}} the event in row {ariaRowindex} to timeline, with columns {columnValues}"}),x=({ariaRowindex:e,columnValues:t})=>n.i18n.translate("xpack.securitySolution.timeline.body.actions.attachAlertToCaseForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t},defaultMessage:"Attach the alert or event in row {ariaRowindex} to a case, with columns {columnValues}"}),k=({ariaRowindex:e,columnValues:t})=>n.i18n.translate("xpack.securitySolution.timeline.body.actions.moreActionsForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t},defaultMessage:"Select more actions for the alert or event in row {ariaRowindex}, with columns {columnValues}"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return p})),a.d(t,"c",(function(){return m})),a.d(t,"d",(function(){return f})),a.d(t,"b",(function(){return y}));var n=a(135),i=a(79),r=a(95),s=a(618);const o=[i.g.alertsOnAlertsPage,i.g.alertsOnRuleDetailsPage,i.j.casePage],l=[{value:"all",inputDisplay:s.b,"data-test-subj":"option-all"}],c=[{value:"raw",inputDisplay:s.d,"data-test-subj":"option-raw"}],u=[{value:"alert",inputDisplay:s.a,"data-test-subj":"option-alert"}],d=[...c,...u],p=e=>{switch(e){case"all":return l;case"raw":return c;case"alert":return u;default:return d}},m=e=>!!e&&o.includes(e),g=[n.a,n.b,n.c,n.d,n.e,n.f,n.h,n.i,n.y,n.n,n.B,n.j,n.k,n.P,n.Z,n.ab,n.bb,n.l,n.o,n.p,n.q,n.r,n.u,n.v,n.w,n.x,n.z,n.A,n.C,n.D,n.E,n.F,n.G,n.H,n.I,n.J,n.K,n.L,n.m,n.M,n.N,n.O,n.W,n.Y,"signal.rule.building_block_type","signal.rule.id","signal.rule.name","signal.rule.threat_mapping","signal.status"],b=({tableId:e,view:t})=>"raw"===t&&m(e),f=({filters:e,tableId:t,view:a})=>b({tableId:t,view:a})?e.filter((e=>!g.includes(`${e.meta.key}`))):e,y=({scopeId:e,view:t})=>b({tableId:e,view:t})?r.SourcererScopeName.default:m(e)?r.SourcererScopeName.detections:e===i.j.active?r.SourcererScopeName.timeline:r.SourcererScopeName.default},function(e,t,a){"use strict";a.d(t,"a",(function(){return m})),a.d(t,"b",(function(){return g}));var n=a(83),i=a(34),r=a(4),s=a(176),o=a(624),l=a(305),c=a(429),u=a(258),d=a(140),p=a(104);const m=(e,t,a,i=p.a)=>({and:[],enabled:!0,id:Object(n.i)(t),name:e,excluded:!1,kqlQuery:"",queryMatch:{field:e,value:a,operator:i,displayValue:Object(c.d)(a)}}),g=({contextId:e,eventId:t,field:a,fieldFormat:n,fieldFromBrowserField:c,fieldType:p,isObjectArray:g,linkValue:b,values:f})=>Object(r.useMemo)((()=>null==f?null:(Array.isArray(f)?f:[f]).reduce(((r,y,h)=>{let E="",v=Object(i.isString)(y)?y:`${f}`;const x=`${e}-${t}-${a}-${h}-${y}`;if(null==c)return r.values.push(v),r;if(g||p===s.e||[s.h].includes(a))return r.values.push(v),r;if(p===s.g){if(E=`formatted-ip-data-provider-${e}-${a}-${y}-${t}`,Object(i.isString)(y)&&!Object(i.isEmpty)(y)){let e=y;try{e=JSON.parse(y)}catch(e){}return Object(i.isArray)(e)&&(v=e.join(","),e.forEach((e=>r.dataProviders.push(m(a,E,e))))),r.dataProviders.push(m(a,E,e)),r.values.push(v),r}}else u.b.some((e=>a===e))?E=`port-default-draggable-${x}`:a===l.b?E=`duration-default-draggable-${x}`:a===s.f?E=`event-details-value-default-draggable-${x}`:n===o.a?E=`bytes-default-draggable-${x}`:a===s.l?E=`event-details-value-default-draggable-${x}-${b}`:a===s.c?E=`event-details-value-default-draggable-${x}-${y}`:a===s.m?E=`alert-details-value-default-draggable-${x}`:a===s.a?(E=`event-details-value-default-draggable-${x}`,v="string"==typeof y?y:""):E=[s.k,s.j,s.d,d.j].includes(a)?`event-details-value-default-draggable-${x}-${y}`:`event-details-value-default-draggable-${x}`;return r.values.push(v),r.dataProviders.push(m(a,E,y)),r}),{values:[],dataProviders:[]})),[e,t,a,n,c,p,g,b,f])},function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(4),i=a.n(n),r=a(44),s=a.n(r),o=a(1),l=a(77);const c=({value:e})=>i.a.createElement(i.a.Fragment,null,(()=>{const[e]=Object(l.q)(o.N);return t=>((e,t)=>s()(e).format(t))(t,e)})()(e));c.displayName="PreferenceFormattedBytesComponent";const u=i.a.memo(c);u.displayName="PreferenceFormattedBytes"},function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"c",(function(){return i})),a.d(t,"b",(function(){return r}));const n="destination.port",i="source.port",r=["client.port",n,"server.port",i,"url.port"]},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=e=>e.isPlatinumOrTrialLicense},function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"c",(function(){return r})),a.d(t,"g",(function(){return s})),a.d(t,"d",(function(){return o})),a.d(t,"f",(function(){return l})),a.d(t,"e",(function(){return c})),a.d(t,"b",(function(){return u}));var n=a(0);n.i18n.translate("xpack.securitySolution.timeline.tcp",{defaultMessage:"TCP"});const i=n.i18n.translate("xpack.securitySolution.timeline.destination",{defaultMessage:"Destination"}),r=n.i18n.translate("xpack.securitySolution.timeline.file.fromOriginalPathDescription",{defaultMessage:"from its original path"}),s=n.i18n.translate("xpack.securitySolution.timeline.source",{defaultMessage:"Source"}),o=n.i18n.translate("xpack.securitySolution.auditd.inDescription",{defaultMessage:"in"}),l=n.i18n.translate("xpack.securitySolution.auditd.nonExistentDescription",{defaultMessage:"an unknown process"}),c=n.i18n.translate("xpack.securitySolution.event.module.linkToElasticEndpointSecurityDescription",{defaultMessage:"Open in Endpoint Security"}),u=n.i18n.translate("xpack.securitySolution.hostIsolation.agentStatuses.empty",{defaultMessage:"-"})},function(e,t,a){"use strict";a.d(t,"b",(function(){return h})),a.d(t,"a",(function(){return E})),a.d(t,"d",(function(){return v})),a.d(t,"c",(function(){return x}));var n=a(4),i=a.n(n),r=a(34),s=a(93),o=a(195),l=a(1),c=a(834),u=a(190),d=a(89),p=a(156),m=a(374),g=a(479);const b=e=>t=>""!==e.trim()?Object(u.d)(t,[{comment:e}]):t,f=e=>t=>""!==e.trim()?Object(u.e)(t,e):t,y=(e,t)=>a=>e===s.b.ENDPOINT?Object(u.k)(Object(u.c)(a,t)):a,h=({itemName:e,commentToAdd:t,addToRules:a,addToSharedLists:n,sharedLists:i,selectedOs:o,listType:l,items:c})=>{const d=Object(r.pipe)(b(t),f(e),y(l,o),((e,t)=>a=>t&&e!==s.b.ENDPOINT?Object(u.f)(a):a)(l,a),((e,t,a)=>n=>t&&e!==s.b.ENDPOINT?Object(u.g)(n,a):n)(l,n,i))(c);return d},E=({itemName:e,commentToAdd:t,selectedOs:a,listType:n,items:i})=>Object(r.pipe)(b(t),f(e),y(n,a))(i),v=()=>[{field:"name",name:"Name",sortable:!0,"data-test-subj":"exceptionListNameCell"},{field:"referenced_rules",name:"Number of rules linked to",sortable:!1,"data-test-subj":"exceptionListRulesLinkedToIdCell",render:e=>i.a.createElement(o.e,{emptyButton:!0,useCustomActions:!0,actions:Object(o.j)({dataTestSubj:"addToSharedListsLinkedRulesMenu",linkedRules:e,securityLinkAnchorComponent:c.e}),panelPaddingSize:"none",disableActions:!1,text:e.length.toString(),dataTestSubj:"addToSharedListsLinkedRulesMenuAction"})},{name:"Action","data-test-subj":"exceptionListRulesActionCell",render:e=>i.a.createElement(d.k,{"data-test-subj":"exceptionListActionCell-link",deepLinkId:l.uc.exceptions,path:`/details/${e.list_id}`,external:!0},g.b)}],x=()=>[{field:"name",align:"left",name:"Name",sortable:!0,"data-test-subj":"ruleNameCell",truncateText:!1},{name:"Action","data-test-subj":"ruleAction-view",render:e=>i.a.createElement(d.k,{"data-test-subj":"ruleAction-viewDetails",deepLinkId:l.uc.rules,path:Object(p.c)(e.id,m.b.alerts),external:!0},g.c)}]},function(e,t,a){const{MAX_LENGTH:n}=a(308),{re:i,t:r}=a(235),s=a(125),o=a(322);e.exports=(e,t)=>{if(t=o(t),e instanceof s)return e;if("string"!=typeof e)return null;if(e.length>n)return null;if(!(t.loose?i[r.LOOSE]:i[r.FULL]).test(e))return null;try{return new s(e,t)}catch(e){return null}}},function(e,t,a){"use strict";var n=a(309);e.exports=function(e){return n({},e)}},function(e,t,a){"use strict";a.d(t,"b",(function(){return p})),a.d(t,"c",(function(){return m})),a.d(t,"d",(function(){return g})),a.d(t,"a",(function(){return b}));var n=a(4),i=a.n(n),r=a(676),s=a(176),o=a(140),l=a(306),c=a(258),u=a(77);const d=[{columnId:s.f,label:r.e},{columnId:"source.ip",fieldType:l.b,label:r.a},{columnId:"destination.ip",fieldType:l.b,label:r.a},{columnId:s.l,label:r.h,linkField:"kibana.alert.rule.uuid"},{columnId:"signal.rule.name",label:r.h,linkField:"signal.rule.id"},...c.b.map((e=>({columnId:e,label:r.g}))),{columnId:s.k,label:r.i},{columnId:s.j,label:r.i},{columnId:s.d,label:r.d},{columnId:o.j,label:r.f},{columnId:s.n,label:r.j}],p=(e,t,a)=>d.find((n=>n.columnId===e||!(!n.fieldType||t!==n.fieldType||void 0===a&&void 0===n.linkField))),m=()=>{},g=()=>{const{timelines:e,data:{query:{filterManager:t}}}=Object(u.k)().services;return{timelines:e,filterManager:t}},b=()=>i.a.createElement(i.a.Fragment,null)},function(e,t,a){"use strict";a.d(t,"b",(function(){return O})),a.d(t,"a",(function(){return q})),a.d(t,"d",(function(){return P})),a.d(t,"c",(function(){return d}));var n=a(0),i=n.i18n.translate("autocomplete.loadingDescription",{defaultMessage:"Loading..."}),r=n.i18n.translate("autocomplete.selectField",{defaultMessage:"Please select a field first..."}),s=n.i18n.translate("autocomplete.fieldRequiredError",{defaultMessage:"Value cannot be empty"}),o=n.i18n.translate("autocomplete.invalidNumberError",{defaultMessage:"Not a valid number"}),l=n.i18n.translate("autocomplete.invalidDateError",{defaultMessage:"Not a valid date"}),c=n.i18n.translate("autocomplete.invalidBinaryType",{defaultMessage:"Binary fields are currently unsupported"}),u=n.i18n.translate("autocomplete.fieldSpaceWarning",{defaultMessage:"Warning: Spaces at the start or end of this value aren't being displayed."}),d=(n.i18n.translate("autocomplete.listsTooltipWarning",{defaultMessage:"Lists that aren't able to be processed by this rule type will be disabled."}),n.i18n.translate("autocomplete.seeDocumentation",{defaultMessage:"See Documentation"}),{LOADING:i,SELECT_FIELD_FIRST:r,FIELD_REQUIRED_ERR:s,NUMBER_ERR:o,DATE_ERR:l,FIELD_SPACE_WARNING:u,BINARY_TYPE_NOT_SUPPORTED:c}),p=a(4),m=a.n(p),g=a(32),b=a(208),f=a.n(b),y=a(147),h=a.n(y),E=a(216),v=a.n(E),x=function(e){var t=e.getLabel,a=e.options,n=e.selectedOptions,i=e.disabledOptions,r=a.map(t),s=null==i?void 0:i.map(t),o=r.map((function(e){return{label:e,disabled:s&&0!==s.length&&s.includes(e)}})),l=n.map(t).filter((function(e){return-1!==r.indexOf(e)})).map((function(e){return o[r.indexOf(e)]}));return{comboOptions:o,labels:r,selectedComboOptions:l}},k={binary:c},S=a(36),j={asPlainText:!0},O=function(e){var t=e.fieldInputWidth,a=e.fieldTypeFilter,i=void 0===a?[]:a,r=e.indexPattern,s=e.isClearable,o=void 0!==s&&s,l=e.isDisabled,c=void 0!==l&&l,u=e.isLoading,d=void 0!==u&&u,b=e.isRequired,y=void 0!==b&&b,E=e.onChange,O=e.placeholder,w=e.selectedField,T=e.acceptsCustomOptions,I=void 0!==T&&T,C=function(e){var t=e.indexPattern,a=e.fieldTypeFilter,n=e.isRequired,i=e.selectedField,r=e.fieldInputWidth,s=e.onChange,o=Object(p.useState)(!1),l=h()(o,2),c=l[0],u=l[1],d=Object(p.useState)(null),b=h()(d,2),y=b[0],E=b[1],j=Object(p.useMemo)((function(){return function(e,t,a){var n=function(e){return null!=e?e.fields:[]}(e),i=function(e){return e?[e]:[]}(t),r=function(e,t,a){var n=new Map;e.forEach((function(e){return n.set(e.name,e)})),t.forEach((function(e){return n.set(e.name,e)}));var i=Array.from(n.values());return a&&(null==a?void 0:a.length)>0?i.filter((function(e){var t=e.type;return a.includes(t)})):i}(n,i,a);return{availableFields:r,selectedFields:i}}(null!=y&&null!=t?v()(v()({},t),{},{fields:[].concat(f()(null==t?void 0:t.fields),[y])}):t,i,a)}),[t,a,i,y]),O=j.availableFields,w=j.selectedFields,T=Object(p.useMemo)((function(){return function(e){var t=e.availableFields,a=e.selectedFields,n=x({getLabel:function(e){return e.name},options:t,selectedOptions:a}),i=function(e){return e.availableFields.reduce((function(e,t){var a,n=null===(a=t.esTypes)||void 0===a?void 0:a.find((function(e){return k[e]})),i=n&&k[n]||k[t.type];return i&&(e[t.name]=i),e}),{})}(e);return v()(v()({},n),{},{disabledLabelTooltipTexts:i})}({availableFields:O,selectedFields:w})}),[O,w]),I=T.comboOptions,C=T.labels,M=T.selectedComboOptions,F=T.disabledLabelTooltipTexts,D=Object(p.useCallback)((function(e){var t=e.map((function(e){var t=e.label;return O[C.indexOf(t)]}));s(t)}),[O,C,s]),A=Object(p.useCallback)((function(e){e.trim().toLowerCase()&&(E({name:e,type:"text"}),s([{name:e,type:"text"}]))}),[s]),_=Object(p.useCallback)((function(){u(!0)}),[u]),N=Object(p.useMemo)((function(){return r?{width:"".concat(r,"px")}:{}}),[r]);return{isInvalid:Object(p.useMemo)((function(){return!!n&&c&&null==i}),[n,i,c]),comboOptions:I,selectedComboOptions:M,fieldWidth:N,renderFields:function(e,t,a){var n=e.label,i=F[n];return i?(e.disabled=!0,Object(S.jsx)(g.EuiToolTip,{"data-test-subj":"disabledLabelWithTooltip",content:i,position:"bottom"},Object(S.jsx)(m.a.Fragment,null,n))):n},handleTouch:_,handleValuesChange:D,handleCreateCustomOption:A}}({indexPattern:r,fieldTypeFilter:i,isRequired:y,selectedField:w,fieldInputWidth:t,onChange:E}),M=C.isInvalid,F=C.comboOptions,D=C.selectedComboOptions,A=C.fieldWidth,_=C.renderFields,N=C.handleTouch,R=C.handleValuesChange,P=C.handleCreateCustomOption;return I?Object(S.jsx)(g.EuiComboBox,{placeholder:O,options:F,selectedOptions:D,onChange:R,isLoading:d,isDisabled:c,isClearable:o,isInvalid:M,onFocus:N,singleSelection:j,"data-test-subj":"fieldAutocompleteComboBox",style:A,onCreateOption:P,customOptionText:n.i18n.translate("autocomplete.customOptionText",{defaultMessage:"Add {searchValuePlaceholder} as a custom field",values:{searchValuePlaceholder:"{searchValue}"}}),fullWidth:!0}):Object(S.jsx)(g.EuiComboBox,{placeholder:O,options:F,selectedOptions:D,onChange:R,isLoading:d,isDisabled:c,isClearable:o,isInvalid:M,onFocus:N,singleSelection:j,"data-test-subj":"fieldAutocompleteComboBox",style:A,fullWidth:!0,renderOption:_})};O.displayName="Field";a(172),a(56);var w=a(7),T=a(93),I=a(524),C=a.n(I),M=a(525),F=a.n(M),D=a(45),A=function(e){var t=e.selectedField,a=e.operatorType,n=e.fieldValue,i=e.query,r=e.indexPattern,s=e.autocompleteService,o=Object(p.useState)(!1),l=h()(o,2),c=l[0],u=l[1],d=Object(p.useState)(!0),m=h()(d,2),g=m[0],b=m[1],y=Object(p.useState)([]),E=h()(y,2),x=E[0],k=E[1],S=Object(p.useRef)(null);return Object(p.useEffect)((function(){var e=!0,o=new AbortController,l=Object(w.debounce)(function(){var t=C()(F.a.mark((function t(a){var n,i,r,l,c,d;return F.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=a.fieldSelected,i=a.patterns,r=a.searchQuery,t.prev=1,!e){t.next=17;break}if(null!=n&&null!=i){t.next=5;break}return t.abrupt("return");case 5:if("boolean"!==n.type){t.next=8;break}return b(!1),t.abrupt("return");case 8:return u(!0),l=Object(D.getDataViewFieldSubtypeNested)(n),c=l?v()(v()({},n),{},{name:"".concat(l.nested.path,".").concat(n.name)}):n,t.next=13,s.getValueSuggestions({field:c,indexPattern:i,query:r,signal:o.signal,useTimeRange:!1});case 13:0===(d=t.sent).length&&b(!1),u(!1),k(f()(d));case 17:t.next=22;break;case 19:t.prev=19,t.t0=t.catch(1),e&&(k([]),u(!1));case 22:case"end":return t.stop()}}),t,null,[[1,19]])})));return function(e){return t.apply(this,arguments)}}(),500);return a!==T.d.EXISTS&&l({fieldSelected:t,patterns:r,searchQuery:i,value:n}),S.current=l,function(){e=!1,o.abort()}}),[t,a,n,r,i,s]),[c,g,x,S.current]},_=a(52),N=a.n(_),R=function(e,t,a,n){if(null!=t){var i=function(e,t,a,n){return a&&n&&(null==e||""===e.trim())?s:null==t||a&&!n||!(a||null!=e&&""!==e)?void 0:null}(e,t,a,n);if(null!==i)return i;switch(t.type){case"date":var r=N.a.parse(null!=e?e:"");return Boolean(r&&r.isValid())?void 0:l;case"number":return null==e||""===e.trim()||isNaN(+e)?o:void 0;default:return}}},P=function(e){return e&&e.trim().length!==e.length},L=[{inputDisplay:"true",value:"true"},{inputDisplay:"false",value:"false"}],B={asPlainText:!0},q=function(e){var t=e.placeholder,a=e.rowLabel,n=e.selectedField,s=e.selectedValue,o=e.indexPattern,l=e.isLoading,c=e.isDisabled,d=void 0!==c&&c,m=e.isClearable,b=void 0!==m&&m,y=e.isRequired,E=void 0!==y&&y,v=e.fieldInputWidth,k=e.autocompleteService,j=e.onChange,O=e.onError,I=Object(p.useState)(""),C=h()(I,2),M=C[0],F=C[1],D=Object(p.useState)(!1),_=h()(D,2),N=_[0],q=_[1],z=Object(p.useState)(void 0),$=h()(z,2),V=$[0],U=$[1],H=Object(p.useState)(!1),G=h()(H,2),Q=G[0],W=G[1],K=A({autocompleteService:k,fieldValue:s,indexPattern:o,operatorType:T.d.MATCH,query:M,selectedField:n}),Y=h()(K,3),J=Y[0],X=Y[1],Z=Y[2],ee=Object(p.useCallback)((function(e){return e}),[]),te=Object(p.useMemo)((function(){var e=String(s);return null!=s&&""!==s.trim()?Object(w.uniq)([e].concat(f()(Z))):Z}),[Z,s]),ae=Object(p.useMemo)((function(){var e=String(s);return s?[e]:[]}),[s]),ne=Object(p.useCallback)((function(e){if(!e)return W(!1);W(!!P(e))}),[W]),ie=Object(p.useCallback)((function(e){U((function(t){var a=null!=e;return null!=t!==a&&null!=O&&O(a),e}))}),[U,O]),re=Object(p.useMemo)((function(){return x({getLabel:ee,options:te,selectedOptions:ae})}),[te,ae,ee]),se=re.comboOptions,oe=re.labels,le=re.selectedComboOptions,ce=Object(p.useCallback)((function(e){var t=e.map((function(e){var t=e.label;return te[oe.indexOf(t)]})),a=h()(t,1)[0];ne(a),ie(void 0),j(null!=a?a:"")}),[ie,ne,oe,j,te]),ue=Object(p.useCallback)((function(e){if(""!==e&&null!=n){var t=R(e,n,E,N);ie(t),t||ne(e),F(e)}}),[ie,ne,E,n,N]),de=Object(p.useCallback)((function(e){var t=R(e,n,E,N);if(ie(t),null!=t)return W(!1),!1;ne(e),j(e)}),[E,j,n,N,ie,ne]),pe=Object(p.useCallback)((function(e){var t=e.target.value;j(t)}),[j]),me=Object(p.useCallback)((function(e){j(e)}),[j]),ge=Object(p.useCallback)((function(){q(!0);var e=R(s,n,E,!0);ie(e)}),[q,ie,s,n,E]),be=Object(p.useMemo)((function(){return l||J?i:null==n?r:t}),[l,n,J,t]),fe=Object(p.useMemo)((function(){return l||J}),[l,J]);Object(p.useEffect)((function(){U(void 0),null!=O&&O(!1),ne(s)}),[n,s,ne,O]);var ye=Object(p.useMemo)((function(){return Object(S.jsx)(g.EuiFormRow,{label:a,error:V,isInvalid:null!=n&&null!=V,"data-test-subj":"valuesAutocompleteMatchLabel",fullWidth:!0,helpText:Q&&u},Object(S.jsx)(g.EuiComboBox,{placeholder:be,isDisabled:d||!n,isLoading:fe,isClearable:b,options:se,selectedOptions:le,onChange:ce,singleSelection:B,onSearchChange:ue,onCreateOption:de,isInvalid:null!=n&&null!=V,onBlur:ge,sortMatchesBy:"startsWith","data-test-subj":"valuesAutocompleteMatch",style:v?{width:"".concat(v,"px")}:{},fullWidth:!0,async:!0}))}),[se,V,v,be,b,d,fe,a,le,n,Q,de,ue,ce,ge]);if(X||null==n)return ye;switch(n.type){case"number":return Object(S.jsx)(g.EuiFormRow,{label:a,error:V,isInvalid:null!=n&&null!=V,"data-test-subj":"valuesAutocompleteMatchLabel",fullWidth:!0},Object(S.jsx)(g.EuiFieldNumber,{placeholder:be,onBlur:ge,value:"string"==typeof s&&s.trim().length>0?parseFloat(s):null!=s?s:"",onChange:pe,"data-test-subj":"valueAutocompleteFieldMatchNumber",style:v?{width:"".concat(v,"px")}:{},fullWidth:!0}));case"boolean":return Object(S.jsx)(g.EuiFormRow,{label:a,error:V,isInvalid:null!=n&&null!=V,"data-test-subj":"valuesAutocompleteMatchLabel",fullWidth:!0},Object(S.jsx)(g.EuiSuperSelect,{isLoading:fe,options:L,valueOfSelected:null!=s?s:"true",onChange:me,"data-test-subj":"valuesAutocompleteMatchBoolean",style:v?{width:"".concat(v,"px")}:{},fullWidth:!0}));default:return ye}};q.displayName="AutocompleteFieldMatch";var z={asPlainText:!0};Object(p.memo)((function(e){var t=e.autocompleteService,a=e.placeholder,n=e.rowLabel,s=e.selectedField,o=e.selectedValue,l=e.indexPattern,c=e.isLoading,d=e.isDisabled,m=void 0!==d&&d,b=e.isClearable,y=void 0!==b&&b,E=e.isRequired,v=void 0!==E&&E,k=e.fieldInputWidth,j=e.onChange,O=e.onError,I=e.onWarning,C=e.warning,M=Object(p.useState)(""),F=h()(M,2),D=F[0],_=F[1],N=Object(p.useState)(!1),L=h()(N,2),B=L[0],q=L[1],$=Object(p.useState)(void 0),V=h()($,2),U=V[0],H=V[1],G=Object(p.useState)(!1),Q=h()(G,2),W=Q[0],K=Q[1],Y=A({autocompleteService:t,fieldValue:o,indexPattern:l,operatorType:T.d.WILDCARD,query:D,selectedField:s}),J=h()(Y,3),X=J[0],Z=J[2],ee=Object(p.useCallback)((function(e){return e}),[]),te=Object(p.useMemo)((function(){var e=String(o);return null!=o&&""!==o.trim()?Object(w.uniq)([e].concat(f()(Z))):Z}),[Z,o]),ae=Object(p.useMemo)((function(){var e=String(o);return o?[e]:[]}),[o]),ne=Object(p.useCallback)((function(e){if(!e)return K(!1);K(!!P(e))}),[K]),ie=Object(p.useCallback)((function(e){H((function(t){var a=null!=e;return null!=t!==a&&null!=O&&O(a),e}))}),[H,O]),re=Object(p.useCallback)((function(e){I(void 0!==e)}),[I]),se=Object(p.useMemo)((function(){return x({getLabel:ee,options:te,selectedOptions:ae})}),[te,ae,ee]),oe=se.comboOptions,le=se.labels,ce=se.selectedComboOptions,ue=Object(p.useCallback)((function(e){var t=e.map((function(e){var t=e.label;return te[le.indexOf(t)]})),a=h()(t,1)[0];ie(void 0),ne(a),K(!1),j(null!=a?a:"")}),[ie,ne,le,j,te]),de=Object(p.useCallback)((function(e){if(""!==e.trim()&&null!=s){var t=R(e,s,v,B);ie(t),re(C),t||ne(e),_(e)}}),[ie,ne,v,s,B,C,re]),pe=Object(p.useCallback)((function(e){var t=R(e,s,v,B);if(ie(t),re(C),null!=t)return K(!1),!1;ne(e),j(e)}),[v,ne,j,s,B,ie,re,C]),me=Object(p.useCallback)((function(){q(!0);var e=R(o,s,v,!0);ie(e),re(C)}),[q,ie,o,s,v,re,C]),ge=Object(p.useMemo)((function(){return c||X?i:null==s?r:a}),[c,s,X,a]),be=Object(p.useMemo)((function(){return c||X}),[c,X]);return Object(p.useEffect)((function(){H(void 0),null!=O&&O(!1),ne(o),I(!1)}),[s,o,O,I,ne]),Object(p.useMemo)((function(){return Object(S.jsx)(g.EuiFormRow,{label:n,error:U,helpText:C||W&&u,isInvalid:null!=s&&null!=U,"data-test-subj":"valuesAutocompleteWildcardLabel",fullWidth:!0},Object(S.jsx)(g.EuiComboBox,{placeholder:ge,isDisabled:m||!s,isLoading:be,isClearable:y,options:oe,selectedOptions:ce,onChange:ue,singleSelection:z,onSearchChange:de,onCreateOption:pe,isInvalid:null!=s&&null!=U,onBlur:me,sortMatchesBy:"startsWith","data-test-subj":"valuesAutocompleteWildcard",style:k?{width:"".concat(k,"px")}:{},fullWidth:!0,async:!0}))}),[oe,U,k,pe,de,ue,ge,y,m,be,n,ce,s,me,C,W])})).displayName="AutocompleteFieldWildcard";a(245)},function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return r})),a.d(t,"e",(function(){return n})),a.d(t,"a",(function(){return k})),a.d(t,"d",(function(){return S}));var n={};a.r(n),a.d(n,"allUsersSelector",(function(){return c})),a.d(n,"userRiskScoreSelector",(function(){return u})),a.d(n,"userRiskScoreSeverityFilterSelector",(function(){return d})),a.d(n,"authenticationsSelector",(function(){return p})),a.d(n,"usersAnomaliesJobIdFilterSelector",(function(){return m})),a.d(n,"usersAnomaliesIntervalSelector",(function(){return g}));var i=a(412),r=a(137),s=a(108);const o=e=>e.users.page,l=(e,t)=>e.users[t],c=()=>Object(s.createSelector)(o,(e=>e.queries[r.UsersTableType.allUsers])),u=()=>Object(s.createSelector)(o,(e=>e.queries[r.UsersTableType.risk])),d=()=>Object(s.createSelector)(o,(e=>e.queries[r.UsersTableType.risk].severitySelection)),p=()=>Object(s.createSelector)(o,(e=>e.queries[r.UsersTableType.authentications])),m=()=>Object(s.createSelector)(l,(e=>e.queries[r.UsersTableType.anomalies].jobIdSelection)),g=()=>Object(s.createSelector)(l,(e=>e.queries[r.UsersTableType.anomalies].intervalSelection));var b=a(328),f=a(34),y=a(253);const h=e=>({...e.page.queries,[r.UsersTableType.allUsers]:{...e.page.queries[r.UsersTableType.allUsers],activePage:y.a}});var E=a(851),v=a(85),x=a(931);const k={page:{queries:{[r.UsersTableType.allUsers]:{activePage:y.a,limit:y.b,sort:{field:x.a.lastSeen,direction:E.a.desc}},[r.UsersTableType.authentications]:{activePage:y.a,limit:y.b},[r.UsersTableType.risk]:{activePage:y.a,limit:y.b,sort:{field:v.w.userRiskScore,direction:E.a.desc},severitySelection:[]},[r.UsersTableType.anomalies]:{jobIdSelection:[],intervalSelection:"auto"},[r.UsersTableType.events]:{activePage:y.a,limit:y.b}}},details:{queries:{[r.UsersTableType.anomalies]:{jobIdSelection:[],intervalSelection:"auto"},[r.UsersTableType.events]:{activePage:y.a,limit:y.b}}}},S=Object(b.reducerWithInitialState)(k).case(i.setUsersTablesActivePageToZero,(e=>({...e,page:{...e.page,queries:h(e)}}))).case(i.updateTableActivePage,((e,{activePage:t,tableType:a})=>({...e,page:{...e.page,queries:{...e.page.queries,[a]:{...e.page.queries[a],activePage:t}}}}))).case(i.updateTableLimit,((e,{limit:t,tableType:a})=>({...e,page:{...e.page,queries:{...e.page.queries,[a]:{...e.page.queries[a],limit:t}}}}))).case(i.updateTableSorting,((e,{sort:t,tableType:a})=>({...e,page:{...e.page,queries:{...e.page.queries,[a]:{...e.page.queries[a],sort:t,activePage:y.a}}}}))).case(i.updateUserRiskScoreSeverityFilter,((e,{severitySelection:t})=>({...e,page:{...e.page,queries:{...e.page.queries,[r.UsersTableType.risk]:{...e.page.queries[r.UsersTableType.risk],severitySelection:t,activePage:y.a}}}}))).case(i.updateUsersAnomaliesJobIdFilter,((e,{jobIds:t,usersType:a})=>"page"===a?Object(f.set)("page.queries.anomalies.jobIdSelection",t,e):Object(f.set)("details.queries.anomalies.jobIdSelection",t,e))).case(i.updateUsersAnomaliesInterval,((e,{interval:t,usersType:a})=>"page"===a?Object(f.set)("page.queries.anomalies.intervalSelection",t,e):Object(f.set)("details.queries.anomalies.intervalSelection",t,e))).build()},,,function(e,t,a){var n=a(330),i=a(331);e.exports=function(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var a=n(e.prototype),r=e.apply(a,t);return i(r)?r:a}}},function(e,t,a){e.exports=a(27)(286)},function(e,t,a){"use strict";t.decode=t.parse=a(550),t.encode=t.stringify=a(551)},function(e,t,a){"use strict";let n;a.d(t,"a",(function(){return n})),function(e){e.flows="flows",e.dns="dns",e.anomalies="anomalies",e.tls="tls",e.http="http",e.events="events"}(n||(n={}))},function(e,t,a){"use strict";a.d(t,"e",(function(){return i})),a.d(t,"h",(function(){return r})),a.d(t,"a",(function(){return s})),a.d(t,"j",(function(){return o})),a.d(t,"k",(function(){return l})),a.d(t,"l",(function(){return c})),a.d(t,"b",(function(){return u})),a.d(t,"c",(function(){return d})),a.d(t,"f",(function(){return p})),a.d(t,"g",(function(){return m})),a.d(t,"d",(function(){return g})),a.d(t,"i",(function(){return b}));var n=a(0);n.i18n.translate("xpack.securitySolution.overview.eventsTitle",{defaultMessage:"Event count"});const i=n.i18n.translate("xpack.securitySolution.overview.newsFeedSidebarTitle",{defaultMessage:"Security news"}),r=n.i18n.translate("xpack.securitySolution.overview.recentTimelinesSidebarTitle",{defaultMessage:"Recent timelines"}),s=n.i18n.translate("xpack.securitySolution.overview.signalCountTitle",{defaultMessage:"Alert trend"}),o=e=>n.i18n.translate("xpack.securitySolution.overview.topNLabel",{values:{fieldName:e},defaultMessage:"Top {fieldName}"}),l=n.i18n.translate("xpack.securitySolution.overview.viewAlertsButtonLabel",{defaultMessage:"View alerts"}),c=n.i18n.translate("xpack.securitySolution.overview.viewEventsButtonLabel",{defaultMessage:"View events"}),u=n.i18n.translate("xpack.securitySolution.detectionResponse.pageTitle",{defaultMessage:"Detection & Response"}),d=n.i18n.translate("xpack.securitySolution.entityAnalytics.pageDesc",{defaultMessage:"Detect threats from users and devices within your network with Entity Analytics"}),p=n.i18n.translate("xpack.securitySolution.detectionResponse.noPagePermissionsMessage",{defaultMessage:"To view this page you must update privileges. For more information, contact your Kibana administrator."}),m=n.i18n.translate("xpack.securitySolution.detectionResponse.noPermissionsTitle",{defaultMessage:"Privileges required"}),g=n.i18n.translate("xpack.securitySolution.detectionResponse.goToDocumentationButton",{defaultMessage:"View documentation"}),b=n.i18n.translate("xpack.securitySolution.entityAnalytics.technicalPreviewLabel",{defaultMessage:"Technical Preview"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return l})),a.d(t,"d",(function(){return c})),a.d(t,"e",(function(){return u})),a.d(t,"f",(function(){return d})),a.d(t,"g",(function(){return p})),a.d(t,"h",(function(){return m}));var n=a(135),i=a(180),r=a(461);const s=e=>{const t="acknowledged"===e?{bool:{should:[{term:{[n.ab]:e}},{term:{[n.ab]:"in-progress"}}]}}:{term:{[n.ab]:e}};return[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:n.ab,params:{query:e}},query:t}]},o=e=>[{meta:{alias:null,negate:!1,disabled:!1},query:{bool:{should:e.map((e=>({term:{[n.ab]:e}})))}}}],l=e=>e?[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:n.D,params:{query:e}},query:{match_phrase:{[n.D]:e}}}]:[],c=e=>e?[]:[{meta:{alias:null,negate:!0,disabled:!1,type:"exists",key:n.b,value:"exists"},query:{exists:{field:n.b}}}],u=e=>e?[{meta:{alias:null,disabled:!1,negate:!1,key:"kibana.alert.rule.type",type:"term"},query:{term:{"kibana.alert.rule.type":"threat_match"}}}]:[],d=e=>({...i.a,columns:Object(r.a)(e),showCheckboxes:!0}),p=e=>({...d(e),columns:Object(r.a)(e),defaultColumns:Object(r.b)(e),sort:[{columnId:"kibana.alert.original_time",columnType:"date",esTypes:["date"],sortDirection:"desc"}]}),m=["@timestamp","kibana.alert.workflow_status","kibana.alert.group.id","kibana.alert.original_time","kibana.alert.building_block_type","kibana.alert.rule.from","kibana.alert.rule.name","kibana.alert.rule.to","kibana.alert.rule.uuid","kibana.alert.rule.rule_id","kibana.alert.rule.type","kibana.alert.suppression.docs_count","kibana.alert.original_event.kind","kibana.alert.original_event.module","file.path","file.Ext.code_signature.subject_name","file.Ext.code_signature.trusted","file.hash.sha256","host.os.family","event.code","process.entry_leader.entity_id"]},function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return i})),a.d(t,"f",(function(){return r})),a.d(t,"e",(function(){return s})),a.d(t,"c",(function(){return o})),a.d(t,"d",(function(){return l}));const n=.5,i=2,r=2,s=50,o=300,l=1e3},function(e,t,a){"use strict";function n(e,t){return Array.isArray(e)?e.includes(t):e===t}function i(e){if(null!==e){if(!Array.isArray(e))return e;for(const t of e)if(null!==t)return t}}function r(e){if(Array.isArray(e)){const t=[];for(const a of e)null!=a&&t.push(a);return t}return null!=e?[e]:[]}a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return i})),a.d(t,"c",(function(){return r}))},function(e,t,a){"use strict";a.d(t,"Vb",(function(){return i})),a.d(t,"oc",(function(){return r})),a.d(t,"e",(function(){return s})),a.d(t,"eb",(function(){return o})),a.d(t,"Yb",(function(){return l})),a.d(t,"db",(function(){return c})),a.d(t,"m",(function(){return u})),a.d(t,"pc",(function(){return d})),a.d(t,"gb",(function(){return p})),a.d(t,"i",(function(){return m})),a.d(t,"T",(function(){return g})),a.d(t,"kc",(function(){return b})),a.d(t,"Db",(function(){return f})),a.d(t,"y",(function(){return y})),a.d(t,"A",(function(){return h})),a.d(t,"z",(function(){return E})),a.d(t,"ob",(function(){return v})),a.d(t,"gc",(function(){return x})),a.d(t,"V",(function(){return k})),a.d(t,"Bb",(function(){return S})),a.d(t,"Ob",(function(){return j})),a.d(t,"S",(function(){return O})),a.d(t,"Q",(function(){return w})),a.d(t,"dc",(function(){return T})),a.d(t,"ic",(function(){return I})),a.d(t,"Z",(function(){return C})),a.d(t,"N",(function(){return M})),a.d(t,"mb",(function(){return F})),a.d(t,"t",(function(){return D})),a.d(t,"Hb",(function(){return A})),a.d(t,"Ub",(function(){return _})),a.d(t,"lb",(function(){return N})),a.d(t,"D",(function(){return R})),a.d(t,"M",(function(){return P})),a.d(t,"ub",(function(){return L})),a.d(t,"L",(function(){return B})),a.d(t,"h",(function(){return q})),a.d(t,"Rb",(function(){return z})),a.d(t,"g",(function(){return $})),a.d(t,"u",(function(){return V})),a.d(t,"nb",(function(){return U})),a.d(t,"H",(function(){return H})),a.d(t,"rb",(function(){return G})),a.d(t,"hc",(function(){return Q})),a.d(t,"f",(function(){return W})),a.d(t,"U",(function(){return K})),a.d(t,"hb",(function(){return Y})),a.d(t,"jc",(function(){return J})),a.d(t,"ib",(function(){return X})),a.d(t,"o",(function(){return Z})),a.d(t,"Eb",(function(){return ee})),a.d(t,"n",(function(){return te})),a.d(t,"ec",(function(){return ae})),a.d(t,"nc",(function(){return ne})),a.d(t,"lc",(function(){return ie})),a.d(t,"B",(function(){return re})),a.d(t,"P",(function(){return se})),a.d(t,"v",(function(){return oe})),a.d(t,"Jb",(function(){return le})),a.d(t,"Cb",(function(){return ce})),a.d(t,"X",(function(){return ue})),a.d(t,"Y",(function(){return de})),a.d(t,"ac",(function(){return pe})),a.d(t,"d",(function(){return me})),a.d(t,"a",(function(){return ge})),a.d(t,"Lb",(function(){return be})),a.d(t,"Mb",(function(){return fe})),a.d(t,"Wb",(function(){return ye})),a.d(t,"p",(function(){return he})),a.d(t,"Ib",(function(){return Ee})),a.d(t,"Pb",(function(){return ve})),a.d(t,"Qb",(function(){return xe})),a.d(t,"Zb",(function(){return ke})),a.d(t,"ab",(function(){return Se})),a.d(t,"bb",(function(){return je})),a.d(t,"w",(function(){return Oe})),a.d(t,"Kb",(function(){return we})),a.d(t,"q",(function(){return Te})),a.d(t,"C",(function(){return Ie})),a.d(t,"xb",(function(){return Ce})),a.d(t,"jb",(function(){return Me})),a.d(t,"yb",(function(){return Fe})),a.d(t,"Fb",(function(){return De})),a.d(t,"E",(function(){return Ae})),a.d(t,"tb",(function(){return _e})),a.d(t,"J",(function(){return Ne})),a.d(t,"qb",(function(){return Re})),a.d(t,"K",(function(){return Pe})),a.d(t,"j",(function(){return Le})),a.d(t,"zb",(function(){return Be})),a.d(t,"Nb",(function(){return qe})),a.d(t,"mc",(function(){return ze})),a.d(t,"bc",(function(){return $e})),a.d(t,"cc",(function(){return Ve})),a.d(t,"s",(function(){return Ue})),a.d(t,"O",(function(){return He})),a.d(t,"Xb",(function(){return Ge})),a.d(t,"Tb",(function(){return Qe})),a.d(t,"fc",(function(){return We})),a.d(t,"Sb",(function(){return Ke})),a.d(t,"c",(function(){return Ye})),a.d(t,"r",(function(){return Je})),a.d(t,"G",(function(){return Xe})),a.d(t,"Gb",(function(){return Ze})),a.d(t,"fb",(function(){return et})),a.d(t,"sb",(function(){return tt})),a.d(t,"F",(function(){return at})),a.d(t,"pb",(function(){return nt})),a.d(t,"Ab",(function(){return it})),a.d(t,"I",(function(){return rt})),a.d(t,"b",(function(){return st})),a.d(t,"x",(function(){return ot})),a.d(t,"kb",(function(){return lt})),a.d(t,"W",(function(){return ct})),a.d(t,"cb",(function(){return ut})),a.d(t,"R",(function(){return dt})),a.d(t,"k",(function(){return pt})),a.d(t,"vb",(function(){return mt})),a.d(t,"wb",(function(){return gt})),a.d(t,"l",(function(){return bt}));var n=a(0);const i=n.i18n.translate("xpack.securitySolution.auditd.sessionDescription",{defaultMessage:"Session"}),r=n.i18n.translate("xpack.securitySolution.auditd.wasAuthorizedToUseDescription",{defaultMessage:"was authorized to use"}),s=n.i18n.translate("xpack.securitySolution.auditd.acquiredCredentialsDescription",{defaultMessage:"acquired credentials to"}),o=n.i18n.translate("xpack.securitySolution.auditd.endedFromDescription",{defaultMessage:"ended from"}),l=n.i18n.translate("xpack.securitySolution.auditd.startedAtDescription",{defaultMessage:"started"}),c=n.i18n.translate("xpack.securitySolution.auditd.disposedCredentialsDescription",{defaultMessage:"disposed credentials to"}),u=n.i18n.translate("xpack.securitySolution.auditd.attemptedLoginDescription",{defaultMessage:"attempted a login via"}),d=n.i18n.translate("xpack.securitySolution.auditd.withResultDescription",{defaultMessage:"with result"}),p=n.i18n.translate("xpack.securitySolution.auditd.executedDescription",{defaultMessage:"executed"}),m=n.i18n.translate("xpack.securitySolution.auditd.asDescription",{defaultMessage:"as"}),g=n.i18n.translate("xpack.securitySolution.auditd.connectedUsingDescription",{defaultMessage:"connected using"}),b=n.i18n.translate("xpack.securitySolution.auditd.usingDescription",{defaultMessage:"using"}),f=n.i18n.translate("xpack.securitySolution.auditd.OpenedFileDescription",{defaultMessage:"opened file"}),y=n.i18n.translate("xpack.securitySolution.auditd.ChangedFileAttributesOfDescription",{defaultMessage:"changed file attributes of"}),h=n.i18n.translate("xpack.securitySolution.auditd.changedFilePermissionOfDescription",{defaultMessage:"changed file permissions of"}),E=n.i18n.translate("xpack.securitySolution.auditd.changeidleOwernshipOfDescription",{defaultMessage:"changed file ownership of"}),v=n.i18n.translate("xpack.securitySolution.auditd.loaedKernelModuleOfDescription",{defaultMessage:"loaded kernel module of"}),x=n.i18n.translate("xpack.securitySolution.auditd.unloadedKernelModuleOfDescription",{defaultMessage:"unloaded kernel module of"}),k=n.i18n.translate("xpack.securitySolution.auditd.createdDirectoryDescription",{defaultMessage:"created directory"}),S=n.i18n.translate("xpack.securitySolution.auditd.mountedDescription",{defaultMessage:"mounted"}),j=n.i18n.translate("xpack.securitySolution.auditd.renamedDescription",{defaultMessage:"renamed"}),O=n.i18n.translate("xpack.securitySolution.auditd.chedckedMetaDataOfDescription",{defaultMessage:"checked metadata of"}),w=n.i18n.translate("xpack.securitySolution.auditd.checkedFileSystemMetadataOfDescription",{defaultMessage:"checked filesystem metadata of"}),T=n.i18n.translate("xpack.securitySolution.auditd.symLinkedDescription",{defaultMessage:"symbolically linked"}),I=n.i18n.translate("xpack.securitySolution.auditd.unmountedDescription",{defaultMessage:"unmounted"}),C=n.i18n.translate("xpack.securitySolution.auditd.deletedDescription",{defaultMessage:"deleted"}),M=n.i18n.translate("xpack.securitySolution.auditd.changedTimeStampOfDescription",{defaultMessage:"changed time stamp of"}),F=n.i18n.translate("xpack.securitySolution.auditd.ListeningForConnectionsUsingDescription",{defaultMessage:"listening for connections using"}),D=n.i18n.translate("xpack.securitySolution.auditd.boundSocketFromDescription",{defaultMessage:"bound socket from"}),A=n.i18n.translate("xpack.securitySolution.auditd.receivedFromDescription",{defaultMessage:"received from"}),_=n.i18n.translate("xpack.securitySolution.auditd.sentToDescription",{defaultMessage:"sent to"}),N=n.i18n.translate("xpack.securitySolution.auditd.killedProcessIdDescription",{defaultMessage:"killed process id of"}),R=n.i18n.translate("xpack.securitySolution.auditd.changedIdentityUsingDescription",{defaultMessage:"changed identity using"}),P=n.i18n.translate("xpack.securitySolution.auditd.changedSystemTimeWithDescription",{defaultMessage:"changed system time with"}),L=n.i18n.translate("xpack.securitySolution.auditd.madeDeviceWithDescription",{defaultMessage:"made device with"}),B=n.i18n.translate("xpack.securitySolution.auditd.changedSystemNameDescription",{defaultMessage:"changed system name"}),q=n.i18n.translate("xpack.securitySolution.auditd.allocatedMemoryForDescription",{defaultMessage:"allocated memory for"}),z=n.i18n.translate("xpack.securitySolution.auditd.scheduledPolicyOFDescription",{defaultMessage:"scheduled policy of"}),$=n.i18n.translate("xpack.securitySolution.auditd.addedUserAccountDescription",{defaultMessage:"added user account"}),V=n.i18n.translate("xpack.securitySolution.auditd.causedMacPolicyErrorDescription",{defaultMessage:"caused mac policy error"}),U=n.i18n.translate("xpack.securitySolution.auditd.loadedFirewallRuleDescription",{defaultMessage:"loaded firewall rule"}),H=n.i18n.translate("xpack.securitySolution.auditd.promiscuousModeDescription",{defaultMessage:"changed promiscuous mode on the device using"}),G=n.i18n.translate("xpack.securitySolution.auditd.lockedAccountDescription",{defaultMessage:"locked account"}),Q=n.i18n.translate("xpack.securitySolution.auditd.unlockedAccountDescription",{defaultMessage:"unlocked account"}),W=n.i18n.translate("xpack.securitySolution.auditd.adddedGroupAccountUsingDescription",{defaultMessage:"added group account using"}),K=n.i18n.translate("xpack.securitySolution.auditd.crashedProgramDescription",{defaultMessage:"crashed program"}),Y=n.i18n.translate("xpack.securitySolution.auditd.executionOfForbiddenProgramDescription",{defaultMessage:"execution of forbidden program"}),J=n.i18n.translate("xpack.securitySolution.auditd.suspiciousProgramDescription",{defaultMessage:"used suspicious program"}),X=n.i18n.translate("xpack.securitySolution.auditd.failedLoginTooManyTimesDescription",{defaultMessage:"failed login due to logging in too many times"}),Z=n.i18n.translate("xpack.securitySolution.auditd.attemptedLoginFromUnusalPlaceDescription",{defaultMessage:"attempted login from unusual place"}),ee=n.i18n.translate("xpack.securitySolution.auditd.openedTooManySessionsDescription",{defaultMessage:"opened too many sessions"}),te=n.i18n.translate("xpack.securitySolution.auditd.attemptedLoginFromUnusualHourDescription",{defaultMessage:"attempted login from unusual hour"}),ae=n.i18n.translate("xpack.securitySolution.auditd.testedFileSystemIntegrityDescription",{defaultMessage:"tested file system integrity"}),ne=n.i18n.translate("xpack.securitySolution.auditd.violatedSeLinuxPolicyDescription",{defaultMessage:"violated selinux policy"}),ie=n.i18n.translate("xpack.securitySolution.auditd.violatedAppArmorPolicyFromDescription",{defaultMessage:"violated app armor policy from"}),re=n.i18n.translate("xpack.securitySolution.auditd.changedGroupDescription",{defaultMessage:"changed group"}),se=n.i18n.translate("xpack.securitySolution.auditd.changedUserIdDescription",{defaultMessage:"changed user id"}),oe=n.i18n.translate("xpack.securitySolution.auditd.changedAuditConfigurationDescription",{defaultMessage:"changed audit configuration"}),le=n.i18n.translate("xpack.securitySolution.auditd.refreshedCredentialsForDescription",{defaultMessage:"refreshed credentials for"}),ce=n.i18n.translate("xpack.securitySolution.auditd.negotiatedCryptoKeyDescription",{defaultMessage:"negotiated crypto key"}),ue=n.i18n.translate("xpack.securitySolution.auditd.cryptoOfficerLoggedInDescription",{defaultMessage:"crypto officer logged in"}),de=n.i18n.translate("xpack.securitySolution.auditd.cryptoOfficerLoggedOutDescription",{defaultMessage:"crypto officer logged out"}),pe=n.i18n.translate("xpack.securitySolution.auditd.startedCryptoSessionDescription",{defaultMessage:"started crypto session"}),me=n.i18n.translate("xpack.securitySolution.auditd.accessResultDescription",{defaultMessage:"access result"}),ge=n.i18n.translate("xpack.securitySolution.auditd.abortedAuditStartupDescription",{defaultMessage:"aborted audit startup"}),be=n.i18n.translate("xpack.securitySolution.auditd.remoteAuditConnectedDescription",{defaultMessage:"remote audit connected"}),fe=n.i18n.translate("xpack.securitySolution.auditd.remoteAuditDisconnectedDescription",{defaultMessage:"remote audit disconnected"}),ye=n.i18n.translate("xpack.securitySolution.auditd.shutDownAuditDescription",{defaultMessage:"shutdown audit"}),he=n.i18n.translate("xpack.securitySolution.auditd.auditErrorDescription",{defaultMessage:"audit error"}),Ee=n.i18n.translate("xpack.securitySolution.auditd.reconfiguredAuditDescription",{defaultMessage:"reconfigured audit"}),ve=n.i18n.translate("xpack.securitySolution.auditd.resumedAuditLoggingDescription",{defaultMessage:"resumed audit logging"}),xe=n.i18n.translate("xpack.securitySolution.auditd.rotatedAuditLogsDescription",{defaultMessage:"rotated-audit-logs"}),ke=n.i18n.translate("xpack.securitySolution.auditd.startedAuditDescription",{defaultMessage:"started audit"}),Se=n.i18n.translate("xpack.securitySolution.auditd.deletedGroupAccountUsingDescription",{defaultMessage:"deleted group account using"}),je=n.i18n.translate("xpack.securitySolution.auditd.deletedUserAccountUsingDescription",{defaultMessage:"deleted user account using"}),Oe=n.i18n.translate("xpack.securitySolution.auditd.changedAuditFeatureDescription",{defaultMessage:"changed audit feature"}),we=n.i18n.translate("xpack.securitySolution.auditd.relabeledFileSystemDescription",{defaultMessage:"relabeled filesystem"}),Te=n.i18n.translate("xpack.securitySolution.auditd.authenticatedToGroupDescription",{defaultMessage:"authenticated to group"}),Ie=n.i18n.translate("xpack.securitySolution.auditd.changedGroupPasswordDescription",{defaultMessage:"changed group password"}),Ce=n.i18n.translate("xpack.securitySolution.auditd.modifiedGroupAccountDescription",{defaultMessage:"modified group account"}),Me=n.i18n.translate("xpack.securitySolution.auditd.initializedAuditSubsystemDescription",{defaultMessage:"initialized audit subsystem"}),Fe=n.i18n.translate("xpack.securitySolution.auditd.modifiedLevelOfDescription",{defaultMessage:"modified level of"}),De=n.i18n.translate("xpack.securitySolution.auditd.overrodeLabelOfDescription",{defaultMessage:"overrode label of"}),Ae=n.i18n.translate("xpack.securitySolution.auditd.changedLoginIdToDescription",{defaultMessage:"changed login id to"}),_e=n.i18n.translate("xpack.securitySolution.auditd.macPermissionDescription",{defaultMessage:"mac permission"}),Ne=n.i18n.translate("xpack.securitySolution.auditd.changedSeLinuxBooleanDescription",{defaultMessage:"changed selinux boolean"}),Re=n.i18n.translate("xpack.securitySolution.auditd.loadedSeLinuxPolicyDescription",{defaultMessage:"loaded selinux policy"}),Pe=n.i18n.translate("xpack.securitySolution.auditd.changedSelinuxEnforcementDescription",{defaultMessage:"changed selinux enforcement"}),Le=n.i18n.translate("xpack.securitySolution.auditd.assignedUserRoleToDescription",{defaultMessage:"assigned user role to"}),Be=n.i18n.translate("xpack.securitySolution.auditd.modifiedRoleDescription",{defaultMessage:"modified role"}),qe=n.i18n.translate("xpack.securitySolution.auditd.removedUserRoleFromDescription",{defaultMessage:"removed user role from"}),ze=n.i18n.translate("xpack.securitySolution.auditd.violatedSeccompPolicyWithDescription",{defaultMessage:"violated seccomp policy with"}),$e=n.i18n.translate("xpack.securitySolution.auditd.startedServiceDescription",{defaultMessage:"started service"}),Ve=n.i18n.translate("xpack.securitySolution.auditd.stoppedServiceDescription",{defaultMessage:"stopped service"}),Ue=n.i18n.translate("xpack.securitySolution.auditd.bootedSystemDescription",{defaultMessage:"booted system"}),He=n.i18n.translate("xpack.securitySolution.auditd.changedToRunLevelWithDescription",{defaultMessage:"changed to run level with"}),Ge=n.i18n.translate("xpack.securitySolution.auditd.shutdownSystemDescription",{defaultMessage:"shutdown system"}),Qe=n.i18n.translate("xpack.securitySolution.auditd.sentTestDescription",{defaultMessage:"sent test"}),We=n.i18n.translate("xpack.securitySolution.auditd.unknownDescription",{defaultMessage:"unknown"}),Ke=n.i18n.translate("xpack.securitySolution.auditd.sentMessageDescription",{defaultMessage:"sent message"}),Ye=n.i18n.translate("xpack.securitySolution.auditd.accessPermissionDescription",{defaultMessage:"access permission"}),Je=n.i18n.translate("xpack.securitySolution.auditd.authenticatedUsingDescription",{defaultMessage:"authenticated using"}),Xe=n.i18n.translate("xpack.securitySolution.auditd.changedPasswordWithDescription",{defaultMessage:"changed password with"}),Ze=n.i18n.translate("xpack.securitySolution.auditd.ranCommandDescription",{defaultMessage:"ran command"}),et=n.i18n.translate("xpack.securitySolution.auditd.errorFromDescription",{defaultMessage:"error from"}),tt=n.i18n.translate("xpack.securitySolution.auditd.loggedOutDescription",{defaultMessage:"logged out"}),at=n.i18n.translate("xpack.securitySolution.auditd.changedMacConfigurationDescription",{defaultMessage:"changed mac configuration"}),nt=n.i18n.translate("xpack.securitySolution.auditd.loadedMacPolicyDescription",{defaultMessage:"loaded mac policy"}),it=n.i18n.translate("xpack.securitySolution.auditd.modifiedUserAccountDescription",{defaultMessage:"modified user account"}),rt=n.i18n.translate("xpack.securitySolution.auditd.changedRoleUsingDescription",{defaultMessage:"changed role using"}),st=n.i18n.translate("xpack.securitySolution.auditd.accessErrorDescription",{defaultMessage:"access error"}),ot=n.i18n.translate("xpack.securitySolution.auditd.changedConfigurationWIthDescription",{defaultMessage:"changed configuration with"}),lt=n.i18n.translate("xpack.securitySolution.auditd.issuedVmControlDescription",{defaultMessage:"issued vm control"}),ct=n.i18n.translate("xpack.securitySolution.auditd.createdVmImageDescription",{defaultMessage:"created vm image"}),ut=n.i18n.translate("xpack.securitySolution.auditd.deletedVmImageDescription",{defaultMessage:"deleted vm image"}),dt=n.i18n.translate("xpack.securitySolution.auditd.checkedIntegrityOfDescription",{defaultMessage:"checked integrity of"}),pt=n.i18n.translate("xpack.securitySolution.auditd.assignedVmIdDescription",{defaultMessage:"assigned vm id"}),mt=n.i18n.translate("xpack.securitySolution.auditd.migratedVmFromDescription",{defaultMessage:"migrated vm from"}),gt=n.i18n.translate("xpack.securitySolution.auditd.migratedVmToDescription",{defaultMessage:"migrated vm to"}),bt=n.i18n.translate("xpack.securitySolution.auditd.assignedVMResourceDescription",{defaultMessage:"assigned vm resource"})},function(e,t,a){"use strict";a.d(t,"W",(function(){return i})),a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return s})),a.d(t,"g",(function(){return o})),a.d(t,"r",(function(){return l})),a.d(t,"A",(function(){return c})),a.d(t,"B",(function(){return u})),a.d(t,"H",(function(){return d})),a.d(t,"e",(function(){return p})),a.d(t,"f",(function(){return m})),a.d(t,"i",(function(){return g})),a.d(t,"n",(function(){return b})),a.d(t,"q",(function(){return f})),a.d(t,"s",(function(){return y})),a.d(t,"t",(function(){return h})),a.d(t,"u",(function(){return E})),a.d(t,"v",(function(){return v})),a.d(t,"E",(function(){return x})),a.d(t,"k",(function(){return k})),a.d(t,"G",(function(){return S})),a.d(t,"F",(function(){return j})),a.d(t,"m",(function(){return O})),a.d(t,"l",(function(){return w})),a.d(t,"j",(function(){return T})),a.d(t,"p",(function(){return I})),a.d(t,"J",(function(){return C})),a.d(t,"o",(function(){return M})),a.d(t,"I",(function(){return F})),a.d(t,"z",(function(){return D})),a.d(t,"h",(function(){return A})),a.d(t,"w",(function(){return _})),a.d(t,"d",(function(){return N})),a.d(t,"a",(function(){return R})),a.d(t,"y",(function(){return P})),a.d(t,"x",(function(){return L})),a.d(t,"K",(function(){return B})),a.d(t,"L",(function(){return q})),a.d(t,"M",(function(){return z})),a.d(t,"D",(function(){return $})),a.d(t,"C",(function(){return V})),a.d(t,"N",(function(){return U})),a.d(t,"R",(function(){return H})),a.d(t,"P",(function(){return G})),a.d(t,"T",(function(){return Q})),a.d(t,"Q",(function(){return W})),a.d(t,"U",(function(){return K})),a.d(t,"O",(function(){return Y})),a.d(t,"S",(function(){return J})),a.d(t,"V",(function(){return X}));var n=a(0);const i=n.i18n.translate("xpack.securitySolution.system.withResultDescription",{defaultMessage:"with result"}),r=n.i18n.translate("xpack.securitySolution.system.acceptedAConnectionViaDescription",{defaultMessage:"accepted a connection via"}),s=n.i18n.translate("xpack.securitySolution.system.attemptedLoginDescription",{defaultMessage:"attempted a login via"}),o=n.i18n.translate("xpack.securitySolution.system.disconnectedViaDescription",{defaultMessage:"disconnected via"}),l=n.i18n.translate("xpack.securitySolution.system.loggedOutDescription",{defaultMessage:"logged out via"}),c=(n.i18n.translate("xpack.securitySolution.system.usingDescription",{defaultMessage:"using"}),n.i18n.translate("xpack.securitySolution.system.processStartedDescription",{defaultMessage:"started process"})),u=n.i18n.translate("xpack.securitySolution.system.processStoppedDescription",{defaultMessage:"stopped process"}),d=n.i18n.translate("xpack.securitySolution.system.terminatedProcessDescription",{defaultMessage:"terminated process"}),p=n.i18n.translate("xpack.securitySolution.system.createdFileDescription",{defaultMessage:"created a file"}),m=n.i18n.translate("xpack.securitySolution.system.deletedFileDescription",{defaultMessage:"deleted a file"}),g=n.i18n.translate("xpack.securitySolution.rowRenderer.executedProcessDescription",{defaultMessage:"executed process"}),b=n.i18n.translate("xpack.securitySolution.rowRenderer.forkedProcessDescription",{defaultMessage:"forked process"}),f=n.i18n.translate("xpack.securitySolution.rowRenderer.loadedLibraryDescription",{defaultMessage:"loaded library"}),y=n.i18n.translate("xpack.securitySolution.rowRenderer.madeAHttpRequestViaDescription",{defaultMessage:"made a http request via"}),h=n.i18n.translate("xpack.securitySolution.rowRenderer.modifiedFileDescription",{defaultMessage:"modified a file"}),E=n.i18n.translate("xpack.securitySolution.rowRenderer.modifiedRegistryKeyDescription",{defaultMessage:"modified registry key"}),v=n.i18n.translate("xpack.securitySolution.rowRenderer.overwroteFileDescription",{defaultMessage:"overwrote a file"}),x=n.i18n.translate("xpack.securitySolution.rowRenderer.renamedFileDescription",{defaultMessage:"renamed a file"}),k=n.i18n.translate("xpack.securitySolution.system.existingProcessDescription",{defaultMessage:"is running process"}),S=n.i18n.translate("xpack.securitySolution.system.socketOpenedDescription",{defaultMessage:"opened a socket with"}),j=n.i18n.translate("xpack.securitySolution.system.socketClosedDescription",{defaultMessage:"closed a socket with"}),O=n.i18n.translate("xpack.securitySolution.system.existingUserDescription",{defaultMessage:"is an existing user"}),w=n.i18n.translate("xpack.securitySolution.system.existingSocketDescription",{defaultMessage:"is using an existing socket from"}),T=n.i18n.translate("xpack.securitySolution.system.existingPackageDescription",{defaultMessage:"is using an existing package"}),I=n.i18n.translate("xpack.securitySolution.system.invalidDescription",{defaultMessage:"attempted invalid usage of"}),C=n.i18n.translate("xpack.securitySolution.system.userChangedDescription",{defaultMessage:"user has changed"}),M=n.i18n.translate("xpack.securitySolution.system.hostDescription",{defaultMessage:"host information"}),F=n.i18n.translate("xpack.securitySolution.system.userAddedDescription",{defaultMessage:"user was added"}),D=n.i18n.translate("xpack.securitySolution.system.processErrorDescription",{defaultMessage:"encountered a process error with"}),A=n.i18n.translate("xpack.securitySolution.system.errorDescription",{defaultMessage:"encountered an error with"}),_=n.i18n.translate("xpack.securitySolution.system.packageInstalledDescription",{defaultMessage:"installed package"}),N=n.i18n.translate("xpack.securitySolution.system.packageSystemStartedDescription",{defaultMessage:"system started"}),R=n.i18n.translate("xpack.securitySolution.system.acceptedDescription",{defaultMessage:"accepted the user via"}),P=n.i18n.translate("xpack.securitySolution.system.packageUpdatedDescription",{defaultMessage:"updated package"}),L=n.i18n.translate("xpack.securitySolution.system.packageRemovedDescription",{defaultMessage:"removed package"}),B=n.i18n.translate("xpack.securitySolution.system.userRemovedDescription",{defaultMessage:"was removed"}),q=n.i18n.translate("xpack.securitySolution.system.viaDescription",{defaultMessage:"via"}),z=n.i18n.translate("xpack.securitySolution.system.viaParentProcessDescription",{defaultMessage:"via parent process"}),$=n.i18n.translate("xpack.securitySolution.rowRenderer.ransomwareWasPreventedFromeEcryptingFilesDescription",{defaultMessage:"ransomware was prevented from encrypting files"}),V=n.i18n.translate("xpack.securitySolution.rowRenderer.ransomwareWasDetectedEcryptingFilesDescription",{defaultMessage:"ransomware was detected encrypting files"}),U=n.i18n.translate("xpack.securitySolution.rowRenderer.wasDetectedCreatingAMaliciousFileDescription",{defaultMessage:"was detected creating a malicious file"}),H=n.i18n.translate("xpack.securitySolution.rowRenderer.wasPreventedFromCreatingAMaliciousFileDescription",{defaultMessage:"was prevented from creating a malicious file"}),G=n.i18n.translate("xpack.securitySolution.rowRenderer.wasDetectedModifyingAMaliciousFileDescription",{defaultMessage:"was detected modifying a malicious file"}),Q=n.i18n.translate("xpack.securitySolution.rowRenderer.wasPreventedFromModifyingAMaliciousFileDescription",{defaultMessage:"was prevented from modifying a malicious file"}),W=n.i18n.translate("xpack.securitySolution.rowRenderer.wasDetectedRenamingAMaliciousFileDescription",{defaultMessage:"was detected renaming a malicious file"}),K=n.i18n.translate("xpack.securitySolution.rowRenderer.wasPreventedFromRenamingAMaliciousFileDescription",{defaultMessage:"was prevented from renaming a malicious file"}),Y=n.i18n.translate("xpack.securitySolution.rowRenderer.wasDetectedExecutingAMaliciousProcessDescription",{defaultMessage:"was detected executing a malicious process"}),J=n.i18n.translate("xpack.securitySolution.rowRenderer.wasPreventedFromExecutingAMaliciousProcessDescription",{defaultMessage:"was prevented from executing a malicious process"}),X=n.i18n.translate("xpack.securitySolution.system.withExitCodeDescription",{defaultMessage:"with exit code"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return s}));var n=a(0),i=a(132);n.i18n.translate("xpack.securitySolution.endpointsTab",{defaultMessage:"Endpoints"}),n.i18n.translate("xpack.securitySolution.policiesTab",{defaultMessage:"Policies"}),n.i18n.translate("xpack.securitySolution.trustedAppsTab",{defaultMessage:"Trusted applications"}),n.i18n.translate("xpack.securitySolution.eventFiltersTab",{defaultMessage:"Event filters"});const r={[i.c.WINDOWS]:n.i18n.translate("xpack.securitySolution.administration.os.windows",{defaultMessage:"Windows"}),[i.c.MAC]:n.i18n.translate("xpack.securitySolution.administration.os.macos",{defaultMessage:"Mac"}),[i.c.LINUX]:n.i18n.translate("xpack.securitySolution.administration.os.linux",{defaultMessage:"Linux"})},s=e=>n.i18n.translate("xpack.securitySolution.exceptions.failedLoadPolicies",{defaultMessage:'There was an error loading policies: "{error}"',values:{error:e.message}})},function(e,t,a){"use strict";a.r(t),a.d(t,"listData",(function(){return g})),a.d(t,"pageIndex",(function(){return b})),a.d(t,"pageSize",(function(){return f})),a.d(t,"totalHits",(function(){return y})),a.d(t,"listLoading",(function(){return h})),a.d(t,"listError",(function(){return E})),a.d(t,"detailsData",(function(){return v})),a.d(t,"detailsLoading",(function(){return x})),a.d(t,"detailsError",(function(){return k})),a.d(t,"policyItems",(function(){return S})),a.d(t,"policyItemsLoading",(function(){return j})),a.d(t,"selectedPolicyId",(function(){return O})),a.d(t,"endpointPackageInfo",(function(){return w})),a.d(t,"getIsEndpointPackageInfoUninitialized",(function(){return T})),a.d(t,"isAutoRefreshEnabled",(function(){return I})),a.d(t,"autoRefreshInterval",(function(){return C})),a.d(t,"policyVersionInfo",(function(){return M})),a.d(t,"areEndpointsEnrolling",(function(){return F})),a.d(t,"agentsWithEndpointsTotalError",(function(){return D})),a.d(t,"endpointsTotalError",(function(){return A})),a.d(t,"endpointPackageVersion",(function(){return _})),a.d(t,"patterns",(function(){return N})),a.d(t,"patternsError",(function(){return R})),a.d(t,"isOnEndpointPage",(function(){return P})),a.d(t,"uiQueryParams",(function(){return L})),a.d(t,"hasSelectedEndpoint",(function(){return B})),a.d(t,"showView",(function(){return q})),a.d(t,"hostStatusInfo",(function(){return z})),a.d(t,"policyResponseStatus",(function(){return $})),a.d(t,"nonExistingPolicies",(function(){return V})),a.d(t,"agentPolicies",(function(){return U})),a.d(t,"endpointsExist",(function(){return H})),a.d(t,"searchBarQuery",(function(){return G})),a.d(t,"getCurrentIsolationRequestState",(function(){return Q})),a.d(t,"getIsIsolationRequestPending",(function(){return W})),a.d(t,"getWasIsolationRequestSuccessful",(function(){return K})),a.d(t,"getIsolationRequestError",(function(){return Y})),a.d(t,"getIsOnEndpointDetailsActivityLog",(function(){return J})),a.d(t,"getIsEndpointHostIsolated",(function(){return X})),a.d(t,"getEndpointPendingActionsState",(function(){return Z})),a.d(t,"getEndpointHostIsolationStatusPropsCallback",(function(){return ee})),a.d(t,"getMetadataTransformStats",(function(){return te})),a.d(t,"metadataTransformStats",(function(){return ae})),a.d(t,"isMetadataTransformStatsLoading",(function(){return ne}));var n=a(271),i=a.n(n),r=a(108),s=a(37),o=a(54),l=a(142),c=a(153),u=a(105),d=a(588),p=a(191),m=a(1085);const g=e=>e.hosts,b=e=>e.pageIndex,f=e=>e.pageSize,y=e=>e.total,h=e=>e.loading,E=e=>e.error,v=e=>e.endpointDetails.hostDetails.details,x=e=>e.endpointDetails.hostDetails.detailsLoading,k=e=>e.endpointDetails.hostDetails.detailsError,S=e=>e.policyItems,j=e=>e.policyItemsLoading,O=e=>e.selectedPolicyId,w=e=>e.endpointPackageInfo,T=Object(r.createSelector)(w,(e=>Object(d.i)(e))),I=e=>e.isAutoRefreshEnabled,C=e=>e.autoRefreshInterval,M=e=>e.policyVersionInfo,F=e=>e.agentsWithEndpointsTotal>e.endpointsTotal,D=e=>e.agentsWithEndpointsTotalError,A=e=>e.endpointsTotalError,_=Object(r.createSelector)(w,(e=>Object(d.g)(e)?e.data.version:void 0)),N=e=>e.patterns,R=e=>e.patternsError,P=e=>{var t,a;return null!==Object(s.matchPath)(null!==(t=null===(a=e.location)||void 0===a?void 0:a.pathname)&&void 0!==t?t:"",{path:u.h,exact:!0})},L=Object(r.createSelector)((e=>e.location),(e=>{const t={page_index:String(u.b),page_size:String(u.c)};if(e){const a=i.a.parse(e.search.slice(1)),n=Object(c.a)(a),r=["selected_endpoint","show","admin_query"],s=["policy_response","details","isolate","unisolate","activity_log"];for(const e of r){const n="string"==typeof a[e]?a[e]:Array.isArray(a[e])?a[e][a[e].length-1]:void 0;void 0!==n&&("show"===e?s.includes(n)&&(t[e]=n):t[e]=n)}t.page_size=String(n.page_size),t.page_index=String(n.page_index)}return t})),B=Object(r.createSelector)(L,(({selected_endpoint:e})=>void 0!==e)),q=Object(r.createSelector)(L,(e=>{var t;return null!==(t=e.show)&&void 0!==t?t:"details"})),z=Object(r.createSelector)((e=>e.hostStatus),(e=>e||l.b.UNHEALTHY)),$=Object(r.createSelector)((e=>e.policyResponse),(e=>{var t,a,n;return e&&(null==e||null===(t=e.Endpoint)||void 0===t||null===(a=t.policy)||void 0===a||null===(n=a.applied)||void 0===n?void 0:n.status)||""})),V=e=>e.nonExistingPolicies,U=e=>e.agentPolicies,H=e=>e.endpointsExist,G=Object(r.createSelector)(L,(({admin_query:e})=>{const t={query:"",language:"kuery"};if(e){const a=Object(o.decode)(e);a&&"string"==typeof a.query&&(t.query=a.query),!a||"string"!=typeof a.language||"kuery"!==a.language&&"lucene"!==a.language||(t.language=a.language)}return t})),Q=e=>e.isolationRequestState,W=Object(r.createSelector)(Q,(e=>Object(d.h)(e))),K=Object(r.createSelector)(Q,(e=>Object(d.g)(e))),Y=Object(r.createSelector)(Q,(e=>{if(Object(d.f)(e))return e.error})),J=Object(r.createSelector)(L,(e=>e.show===m.b.activityLog)),X=Object(r.createSelector)(v,(e=>e&&Object(p.b)(e)||!1)),Z=e=>e.endpointPendingActions,ee=Object(r.createSelector)(Z,(e=>t=>{let a=0,n=0,i=0,r=0,s=0;if(Object(d.g)(e)){const d=e.data.get(t.elastic.agent.id);var o,l,c,u,m;d&&(a=null!==(o=null==d?void 0:d.isolate)&&void 0!==o?o:0,n=null!==(l=null==d?void 0:d.unisolate)&&void 0!==l?l:0,i=null!==(c=null==d?void 0:d["kill-process"])&&void 0!==c?c:0,r=null!==(u=null==d?void 0:d["suspend-process"])&&void 0!==u?u:0,s=null!==(m=null==d?void 0:d["running-processes"])&&void 0!==m?m:0)}return{isIsolated:Object(p.b)(t),pendingActions:{pendingIsolate:a,pendingUnIsolate:n,pendingKillProcess:i,pendingSuspendProcess:r,pendingRunningProcesses:s}}})),te=e=>e.metadataTransformStats,ae=e=>Object(d.g)(e.metadataTransformStats)?e.metadataTransformStats.data:[],ne=e=>Object(d.h)(e.metadataTransformStats)},function(e,t,a){"use strict";a.d(t,"b",(function(){return j})),a.d(t,"a",(function(){return O}));var n=a(169),i=a(78),r=a(4),s=a(90),o=a(77),l=a(98),c=a(145),u=a(34),d=a(107),p=a(526),m=a(286);var g=a(268),b=a.n(g),f=a(267),y=a(183);var h=a(136),E=a(86),v=a(104),x=a(81),k=a(37);const S=({search:e,urlKey:t})=>Object(f.d)(Object(f.e)(e),t),j=()=>{Object(n.c)(),(()=>{const e=Object(i.useDispatch)(),{filterManager:t,savedQueries:a}=Object(o.k)().services.data.query,u=Object(r.useMemo)((()=>l.d.globalFiltersQuerySelector()),[]),d=Object(i.useSelector)(u),p=Object(r.useCallback)((t=>{null!=t&&e(c.b.setFilterQuery({id:s.a.global,query:t.query,language:t.language}))}),[e]),m=Object(r.useCallback)((a=>{null!=a?(t.setFilters(a),e(c.b.setSearchBarFilter({id:s.a.global,filters:a}))):(t.setAppFilters(d),e(c.b.setSearchBarFilter({id:s.a.global,filters:t.getFilters()})))}),[t,e,d]),g=Object(r.useCallback)((n=>{null!=n&&""!==n&&a.getSavedQuery(n).then((a=>{const n=a.attributes.filters||[],i=a.attributes.query;t.setFilters(n),e(c.b.setSearchBarFilter({id:s.a.global,filters:n})),e(c.b.setFilterQuery({id:s.a.global,...i})),e(c.b.setSavedQuery({id:s.a.global,savedQuery:a}))}))}),[e,t,a]);Object(n.b)(O.appQuery,p),Object(n.b)(O.filters,m),Object(n.b)(O.savedQuery,g)})(),(()=>{const e=Object(i.useDispatch)(),t=Object(d.a)("socTrendsEnabled"),a=Object(r.useCallback)((a=>((e,t,a)=>{if(null!=e){const n={linkTo:Object(u.get)("global.linkTo",e)},i=Object(u.get)("global.timerange.kind",e),r={linkTo:Object(u.get)("timeline.linkTo",e)},o=Object(u.get)("timeline.timerange.kind",e),l={linkTo:Object(u.get)("socTrends.linkTo",e)},d=Object(u.get)("socTrends.timerange.kind",e);if(a&&(Object(u.isEmpty)(l.linkTo)?t(c.b.removeLinkTo([s.a.global,s.a.socTrends])):t(c.b.addLinkTo([s.a.global,s.a.socTrends]))),Object(u.isEmpty)(n.linkTo)?(t(c.b.removeLinkTo([s.a.global,s.a.timeline])),a&&t(c.b.removeLinkTo([s.a.global,s.a.socTrends]))):(t(c.b.addLinkTo([s.a.global,s.a.timeline])),a&&t(c.b.addLinkTo([s.a.global,s.a.socTrends]))),Object(u.isEmpty)(r.linkTo)?t(c.b.removeLinkTo([s.a.global,s.a.timeline])):t(c.b.addLinkTo([s.a.global,s.a.timeline])),o){if("absolute"===o){const a=Object(p.a)(Object(u.get)("timeline.timerange",e));t(c.b.setAbsoluteRangeDatePicker({...a,id:s.a.timeline}))}if("relative"===o){const a=Object(p.a)(Object(u.get)("timeline.timerange",e));a.from=Object(m.c)(a.fromStr),a.to=Object(m.c)(a.toStr,{roundUp:!0}),t(c.b.setRelativeRangeDatePicker({...a,id:s.a.timeline}))}}if(i){if("absolute"===i){const a=Object(p.a)(Object(u.get)("global.timerange",e));t(c.b.setAbsoluteRangeDatePicker({...a,id:s.a.global}))}if("relative"===i){const a=Object(p.a)(Object(u.get)("global.timerange",e));a.from=Object(m.c)(a.fromStr),a.to=Object(m.c)(a.toStr,{roundUp:!0}),t(c.b.setRelativeRangeDatePicker({...a,id:s.a.global}))}}if(a&&d){if("absolute"===d){const a=Object(p.a)(Object(u.get)("socTrends.timerange",e));t(c.b.setAbsoluteRangeDatePicker({...a,id:s.a.socTrends}))}if("relative"===d){const a=Object(p.a)(Object(u.get)("socTrends.timerange",e));a.from=Object(m.c)(a.fromStr),a.to=Object(m.c)(a.toStr,{roundUp:!0}),t(c.b.setRelativeRangeDatePicker({...a,id:s.a.socTrends}))}}}})(a,e,t)),[e,t]);Object(n.b)(O.timerange,a)})(),(()=>{const[{pageName:e}]=Object(y.a)(),t=Object(i.useDispatch)(),a=b()(e),n=Object(r.useMemo)((()=>l.d.inputsSelector()),[]),o=Object(i.useSelector)(n),{timerange:u}=o.global,{timerange:d}=o.timeline;Object(r.useEffect)((()=>{((e,t)=>e&&t&&t!==e&&Object(f.f)(e))(e,a)&&("relative"===d.kind&&t(c.b.setRelativeRangeDatePicker({...d,from:Object(m.c)(d.fromStr),to:Object(m.c)(d.toStr,{roundUp:!0}),id:s.a.timeline})),"relative"===u.kind&&t(c.b.setRelativeRangeDatePicker({...u,from:Object(m.c)(u.fromStr),to:Object(m.c)(u.toStr,{roundUp:!0}),id:s.a.global})))}),[e,a,t,d,u])})(),(()=>{const e=Object(i.useDispatch)(),t=Object(r.useCallback)((t=>{null!=t&&""!==t.id&&Object(h.h)({activeTimelineTab:t.activeTab,duplicate:!1,graphEventId:t.graphEventId,timelineId:t.id,openTimeline:t.isOpen,updateIsLoading:t=>e(E.a.updateIsLoading(t)),updateTimeline:Object(h.b)(e)})}),[e]);Object(n.b)(O.timeline,t)})(),(()=>{const e=Object(n.d)(O.timeline),t=Object(r.useMemo)((()=>E.b.getTimelineByIdSelector()),[]),{activeTab:a,graphEventId:i,show:s,savedObjectId:o}=Object(x.b)((e=>{var a;return null!==(a=t(e,v.d.active))&&void 0!==a?a:{}}));Object(r.useEffect)((()=>{e(null!=o?{id:o,isOpen:s,activeTab:a,graphEventId:null!=i?i:""}:null)}),[a,i,o,s,e])})(),(()=>{var e;const t=Object(r.useMemo)((()=>E.b.getTimelineByIdSelector()),[]),a=Object(x.b)((e=>t(e,v.d.active))),{search:n}=Object(k.useLocation)(),s=b()(n),o=null!==(e=null==a?void 0:a.savedObjectId)&&void 0!==e?e:"",l=Object(i.useDispatch)(),[c,u]=Object(r.useMemo)((()=>{const e=S({urlKey:O.timeline,search:null!=s?s:""}),t=S({urlKey:O.timeline,search:n});if(null!=e&&null!=t){let a=null,n=null;try{a=Object(f.a)(t)}catch(e){}try{n=Object(f.a)(e)}catch(e){}return[n,a]}return[null,null]}),[s,n]),d=null==c?void 0:c.id,{id:p,activeTab:m,graphEventId:g}=u||{};Object(r.useEffect)((()=>{p&&p!==d&&p!==o&&Object(h.h)({activeTimelineTab:null!=m?m:v.f.query,duplicate:!1,graphEventId:g,timelineId:p,openTimeline:!0,updateIsLoading:e=>l(E.a.updateIsLoading(e)),updateTimeline:Object(h.b)(l)})}),[o,l,d,p,m,g])})()};let O;!function(e){e.appQuery="query",e.filters="filters",e.savedQuery="savedQuery",e.sourcerer="sourcerer",e.timeline="timeline",e.timerange="timerange"}(O||(O={}))},function(e,t,a){"use strict";a.d(t,"a",(function(){return I}));var n=a(528),i=a(34),r=a(4),s=a.n(r),o=a(78),l=a(11),c=a(92),u=a.n(c),d=a(145),p=a(286),m=a(108),g=a(149);const b=e=>e.query,f=e=>e.savedQuery;var y=a(86),h=a(77),E=a(266),v=a(236),x=a(111),k=a(98),S=a(169),j=a(281),O=a(107);const w=Object(r.memo)((({end:e,filterQuery:t,fromStr:a,hideFilterBar:c=!1,hideQueryInput:m=!1,id:g,indexPattern:b,isLoading:f=!1,pollForSignalIndex:y,queries:w,savedQuery:T,setSavedQuery:I,setSearchBarFilter:C,start:M,toStr:F,updateSearch:D,dataTestSubj:A})=>{const{data:{query:{timefilter:{timefilter:_},filterManager:N}},unifiedSearch:{ui:{SearchBar:R}}}=Object(h.k)().services,P=Object(o.useDispatch)(),L=Object(r.useCallback)((()=>{P(E.b.setUsersTablesActivePageToZero()),P(v.a.setHostTablesActivePageToZero()),P(x.b.setNetworkTablesActivePageToZero())}),[P]);(()=>{const e=Object(S.d)(j.a.savedQuery),t=Object(S.d)(j.a.appQuery),a=Object(S.d)(j.a.filters),n=Object(r.useMemo)((()=>k.d.globalQuerySelector()),[]),s=Object(r.useMemo)((()=>k.d.globalFiltersQuerySelector()),[]),l=Object(r.useMemo)((()=>k.d.globalSavedQuerySelector()),[]),c=Object(o.useSelector)(n),u=Object(o.useSelector)(s),d=Object(o.useSelector)(l);Object(r.useEffect)((()=>{var n;null!=d&&""!==d.id?(e(null!==(n=null==d?void 0:d.id)&&void 0!==n?n:null),t(null),a(null)):(e(null),t(Object(i.isEmpty)(c.query)?null:c),a(Object(i.isEmpty)(u)?null:u))}),[d,c,u,e,t,a])})(),(()=>{const e=Object(S.d)(j.a.timerange),t=Object(r.useMemo)((()=>d.d.inputsSelector()),[]),a=Object(o.useSelector)(t),n=Object(O.a)("socTrendsEnabled"),{linkTo:i,timerange:s}=a.global,{linkTo:l,timerange:c}=a.timeline,u=Object(r.useMemo)((()=>{if(n&&a.socTrends){const{linkTo:e,timerange:t}=a.socTrends;return{socTrends:{[j.a.timerange]:t,linkTo:e}}}return{}}),[a.socTrends,n]);Object(r.useEffect)((()=>{e({global:{[j.a.timerange]:s,linkTo:i},timeline:{[j.a.timerange]:c,linkTo:l},...u})}),[e,i,s,l,c,u])})(),Object(r.useEffect)((()=>{null!=a&&null!=F?_.setTime({from:a,to:F}):null!=M&&null!=e&&(L(),_.setTime({from:new Date(M).toISOString(),to:new Date(e).toISOString()}))}),[e,a,M,_,F,L]);const B=Object(r.useCallback)((i=>{null!=y&&y();const r=i.dateRange.from.includes("now")||i.dateRange.to.includes("now");let s={id:g,end:null!=F?F:new Date(e).toISOString(),start:null!=a?a:new Date(M).toISOString(),isInvalid:!1,isQuickSelection:r,updateTime:!1,filterManager:N,setTablesActivePageToZero:L},o=!1;(!r||a===i.dateRange.from&&F===i.dateRange.to)&&(r||M===Object(p.c)(i.dateRange.from)&&e===Object(p.c)(i.dateRange.to))||(o=!0,s.updateTime=!0,s.end=i.dateRange.to,s.start=i.dateRange.from),null==i.query||u()(i.query,t)||(o=!0,s=Object(n.set)("query",i.query,s)),o||(r&&i.dateRange.to!==i.dateRange.from?(s.updateTime=!0,s.end=i.dateRange.to,s.start=i.dateRange.from):w.forEach((e=>e.refetch&&e.refetch()))),window.setTimeout((()=>D(s)),0)}),[g,y,F,e,a,M,N,t,w,D,L]),q=Object(r.useCallback)((e=>{e.dateRange.from.includes("now")||e.dateRange.to.includes("now")?D({id:g,end:e.dateRange.to,start:e.dateRange.from,isInvalid:!1,isQuickSelection:!0,updateTime:!0,filterManager:N,setTablesActivePageToZero:L}):w.forEach((e=>e.refetch&&e.refetch()))}),[D,g,N,w,L]),z=Object(r.useCallback)((e=>{I({id:g,savedQuery:e})}),[g,I]),$=Object(r.useCallback)((t=>{const i=!!t.attributes.timefilter&&(t.attributes.timefilter.from.includes("now")||t.attributes.timefilter.to.includes("now"));let r={id:g,filters:t.attributes.filters||[],end:null!=F?F:new Date(e).toISOString(),start:null!=a?a:new Date(M).toISOString(),isInvalid:!1,isQuickSelection:i,updateTime:!1,filterManager:N,setTablesActivePageToZero:L};t.attributes.timefilter&&(r.end=t.attributes.timefilter?t.attributes.timefilter.to:r.end,r.start=t.attributes.timefilter?t.attributes.timefilter.from:r.start,r.updateTime=!0),r=Object(n.set)("query",t.attributes.query,r),r=Object(n.set)("savedQuery",t,r),D(r)}),[g,F,e,a,M,N,D,L]),V=Object(r.useCallback)((()=>{null!=T&&D({id:g,filters:[],end:null!=F?F:new Date(e).toISOString(),start:null!=a?a:new Date(M).toISOString(),isInvalid:!1,isQuickSelection:!1,updateTime:!1,query:{query:"",language:T.attributes.query.language},resetSavedQuery:!0,savedQuery:void 0,filterManager:N,setTablesActivePageToZero:L})}),[T,D,g,F,e,a,M,N,L]);Object(r.useEffect)((()=>{let e=!0;const t=new l.Subscription;return t.add(N.getUpdates$().subscribe({next:()=>{if(e){const e=N.getFilters();C({id:g,filters:e}),L()}}})),()=>{e=!1,t.unsubscribe()}}),[]);const U=Object(r.useMemo)((()=>[b]),[b]);return s.a.createElement("div",{"data-test-subj":`${g}DatePicker`},s.a.createElement(R,{appName:"siem",isLoading:f,indexPatterns:U,query:t,onClearSavedQuery:V,onQuerySubmit:B,onRefresh:q,onSaved:z,onSavedQueryUpdated:$,savedQuery:T,showFilterBar:!c,showDatePicker:!0,showQueryInput:!m,showSaveQuery:!0,dataTestSubj:A}))}),((e,t)=>e.end===t.end&&e.filterQuery===t.filterQuery&&e.fromStr===t.fromStr&&e.id===t.id&&e.isLoading===t.isLoading&&e.savedQuery===t.savedQuery&&e.setSavedQuery===t.setSavedQuery&&e.setSearchBarFilter===t.setSearchBarFilter&&e.start===t.start&&e.toStr===t.toStr&&e.updateSearch===t.updateSearch&&e.dataTestSubj===t.dataTestSubj&&u()(e.indexPattern,t.indexPattern)&&u()(e.queries,t.queries)));w.displayName="SiemSearchBar";const T=e=>({end:t,filters:a,id:n,isQuickSelection:i,query:r,resetSavedQuery:s,savedQuery:o,start:l,timelineId:c,updateTime:u=!1,filterManager:m,setTablesActivePageToZero:g})=>{if(u){const a=Object(p.c)(l);let r=Object(p.c)(t,{roundUp:!0});i?e(t===l?d.b.setAbsoluteRangeDatePicker({id:n,fromStr:l,toStr:t,from:a,to:r}):d.b.setRelativeRangeDatePicker({id:n,fromStr:l,toStr:t,from:a,to:r})):(r=Object(p.c)(t),e(d.b.setAbsoluteRangeDatePicker({id:n,from:Object(p.c)(l),to:Object(p.c)(t)}))),null!=c&&e(y.a.updateRange({id:c,start:a,end:r}))}null!=r&&e(d.b.setFilterQuery({id:n,...r})),null!=a&&m.setFilters(a),(null!=o||s)&&e(d.b.setSavedQuery({id:n,savedQuery:o})),g()},I=Object(o.connect)((()=>{const e=Object(g.b)(),t=Object(g.c)(),a=Object(g.d)(),n=Object(g.h)(),r=Object(g.i)(),s=Object(g.j)(),o=Object(m.createSelector)(b,(e=>e)),l=Object(m.createSelector)(f,(e=>e));return(c,{id:u})=>{const d=Object(i.getOr)({},`inputs.${u}`,c);return{end:e(d),fromStr:t(d),filterQuery:o(d),isLoading:a(d),queries:n(c,u),savedQuery:l(d),start:r(d),toStr:s(d)}}}),(e=>({updateSearch:T(e),setSavedQuery:({id:t,savedQuery:a})=>e(d.b.setSavedQuery({id:t,savedQuery:a})),setSearchBarFilter:({id:t,filters:a})=>e(d.b.setSearchBarFilter({id:t,filters:a}))})))(w)},,,function(e,t,a){"use strict";a.d(t,"a",(function(){return h})),a.d(t,"b",(function(){return E}));var n=a(4),i=a(78),r=a(294),s=a.n(r),o=a(34),l=a(50),c=a(42),u=a(77),d=a(84),p=a(177),m=a(431),g=a(95),b=a(317),f=a(231),y=a(1);const h=s()(((e,t)=>t.reduce(((e,t)=>(null==e.browserFields[t.category]&&(e.browserFields[t.category]={}),null==e.browserFields[t.category].fields&&(e.browserFields[t.category].fields={}),e.browserFields[t.category].fields[t.name]=t,e.indexFields.push(Object(o.pick)(["name","searchable","type","aggregatable","esTypes","subType"],t)),e)),{browserFields:{},indexFields:[]})),((e,t)=>e[0]===t[0]&&e[1].length===t[1].length)),E=()=>{const{data:e}=Object(u.k)().services,t=Object(n.useRef)({}),a=Object(n.useRef)({}),r=Object(i.useDispatch)(),{addError:s,addWarning:E}=Object(d.a)(),{startTracking:v}=Object(f.a)(),x=Object(n.useCallback)((({id:e,loading:t})=>{r(p.a.setDataViewLoading({id:e,loading:t}))}),[r]),k=Object(n.useCallback)((({dataViewId:n,scopeId:i=g.SourcererScopeName.default,needToBeInit:u=!1,cleanCache:d=!1,skipScopeUpdate:f=!1})=>{const k=()=>{var e;null===(e=a.current[n])||void 0===e||e.unsubscribe(),a.current=Object(o.omit)(n,a.current),t.current=Object(o.omit)(n,t.current)};return a.current[n]&&a.current[n].unsubscribe(),t.current[n]&&t.current[n].abort(),(async()=>{t.current={...t.current,[n]:new AbortController},x({id:n,loading:!0});const{endTracking:o}=v({name:`${y.B} indexFieldsSearch`});if(u){const e=await Object(b.a)(n,t.current[n].signal);r(p.a.setDataView(e))}return new Promise((g=>{const b=e.search.search({dataViewId:n,onlyCheckIfIndicesExist:!1},{abortSignal:t.current[n].signal,strategy:"indexFields"}).subscribe({next:async e=>{if(Object(c.isCompleteResponse)(e)){o("success");const t=e.indicesExist.sort().join();u&&i&&!f&&r(p.a.setSelectedDataView({id:i,selectedDataViewId:n,selectedPatterns:e.indicesExist})),d&&h.clear();const a=h(t,e.indexFields);r(p.a.setDataView({...a,id:n,loading:!1,runtimeMappings:e.runtimeMappings}))}else Object(c.isErrorResponse)(e)&&(o("invalid"),x({id:n,loading:!1}),E(m.a));k(),g()},error:e=>{if(o("error"),e.message===l.DELETED_SECURITY_SOLUTION_DATA_VIEW)return location.reload();x({id:n,loading:!1}),s(e,{title:m.b}),k(),g()}});a.current={...a.current,[n]:b}}))})()}),[s,E,e.search,r,x,v]);return Object(n.useEffect)((()=>()=>{Object.values(a.current).forEach((e=>e.unsubscribe())),Object.values(t.current).forEach((e=>e.abort()))}),[]),{indexFieldsSearch:k}}},function(e,t,a){"use strict";a.d(t,"c",(function(){return v})),a.d(t,"b",(function(){return x})),a.d(t,"a",(function(){return k}));var n=a(52),i=a.n(n),r=a(32),s=a(34),o=a(4),l=a.n(o),c=a(78),u=a(92),d=a.n(u),p=a(935),m=a(1),g=a(86),b=a(77),f=a(184),y=a(90),h=a(149);const E=l.a.memo((({duration:e,end:t,fromStr:a,id:n,isLoading:i,kqlQuery:c,policy:u,queries:d,setDuration:p,showUpdateButton:g=!0,start:f,startAutoReload:y,stopAutoReload:h,timelineId:E,toStr:x,updateReduxTime:k,disabled:S,width:j="restricted",compressed:O=!1})=>{const[w,T]=Object(o.useState)([]),I=Object(o.useCallback)((({start:e,end:a})=>{const i=e.includes("now")||a.includes("now"),{kqlHaveBeenUpdated:r}=k({end:a,id:n,isInvalid:!1,isQuickSelection:i,kql:c,start:e,timelineId:E}),s=v(e),o=i?v(a,{roundUp:!0}):v(a);!d||r||i&&(f!==s||t!==o)||M(d)}),[t,n,c,d,f,E,k]),C=Object(o.useCallback)((({isPaused:t,refreshInterval:i})=>{const r=null!=a&&a.includes("now")||null!=x&&x.includes("now");e!==i&&p({id:n,duration:i}),t&&"interval"===u?h({id:n}):t||"manual"!==u||y({id:n}),d&&!t&&(!r||r&&"now"!==x)&&M(d)}),[a,x,e,u,p,n,h,y,d]),M=e=>{e.forEach((e=>e.refetch&&e.refetch()))},F=Object(o.useCallback)((({start:e,end:t,isInvalid:a})=>{const i=e.includes("now")||t.includes("now");if(!a){k({end:t,id:n,isInvalid:a,isQuickSelection:i,kql:c,start:e,timelineId:E});const r=[{start:e,end:t},...Object(s.take)(9,w.filter((a=>!(a.start===e&&a.end===t))))];T(r)}}),[k,n,c,E,w]),D=null!=x?x:new Date(t).toISOString(),A=null!=a?a:new Date(f).toISOString(),[_]=Object(b.q)(m.gb),N=Object(s.isEmpty)(_)?[]:_.map((({from:e,to:t,display:a})=>({start:e,end:t,label:a})));return l.a.createElement(r.EuiSuperDatePicker,{commonlyUsedRanges:N,end:D,isLoading:i,isPaused:"manual"===u,onRefresh:I,onRefreshChange:C,onTimeChange:F,recentlyUsedRanges:w,refreshInterval:e,showUpdateButton:g,start:A,isDisabled:S,width:j,compressed:O})}),((e,t)=>e.duration===t.duration&&e.end===t.end&&e.fromStr===t.fromStr&&e.id===t.id&&e.isLoading===t.isLoading&&e.policy===t.policy&&e.setDuration===t.setDuration&&e.start===t.start&&e.startAutoReload===t.startAutoReload&&e.stopAutoReload===t.stopAutoReload&&e.timelineId===t.timelineId&&e.disabled===t.disabled&&e.toStr===t.toStr&&e.updateReduxTime===t.updateReduxTime&&d()(e.kqlQuery,t.kqlQuery)&&d()(e.queries,t.queries))),v=(e,t)=>{const a=i.a.parse(e,t);return null!=a&&a.isValid()?a.toISOString():""},x=e=>({end:t,id:a,isQuickSelection:n,kql:i,start:r,timelineId:s})=>{const o=v(r);let l=v(t,{roundUp:!0});var c;return n?e(t===r?f.b.setAbsoluteRangeDatePicker({id:a,fromStr:r,toStr:t,from:o,to:l}):f.b.setRelativeRangeDatePicker({id:a,fromStr:r,toStr:t,from:o,to:l})):(l=v(t),e(f.b.setAbsoluteRangeDatePicker({id:a,from:v(r),to:v(t)}))),null!=s&&e(g.a.updateRange({id:s,start:o,end:l})),i&&i.refetch?{kqlHaveBeenUpdated:null!==(c=i.refetch(e))&&void 0!==c&&c}:{kqlHaveBeenUpdated:!1}};E.displayName="SuperDatePickerComponent";const k=Object(c.connect)((()=>{const e=Object(h.a)(),t=Object(h.b)(),a=Object(h.c)(),n=Object(h.d)(),i=Object(h.e)(),r=Object(h.f)(),o=Object(h.g)(),l=Object(h.h)(),c=Object(h.i)(),u=Object(h.j)();return(d,{id:m})=>{const g=Object(s.getOr)({},`inputs.${m}`,d);return{duration:e(g),end:t(g),fromStr:a(g),kind:i(g),policy:o(g),start:c(g),toStr:u(g),isLoading:!1,...Object(p.c)(g)&&(m===y.a.timeline||m===y.a.global)&&{isLoading:n(g),kqlQuery:r(g),queries:l(d,m)}}}}),(e=>({startAutoReload:({id:t})=>e(f.b.startAutoReload({id:t})),stopAutoReload:({id:t})=>e(f.b.stopAutoReload({id:t})),setDuration:({id:t,duration:a})=>e(f.b.setDuration({id:t,duration:a})),updateReduxTime:x(e)})))(E)},function(e,t,a){"use strict";a.d(t,"c",(function(){return p})),a.d(t,"a",(function(){return u})),a.d(t,"b",(function(){return d}));var n,i=a(4),r=a(53),s=(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])},n(e,t)},function(e,t){function a(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}),o="html",l="svg",c=function(e,t){var a,n,i,r={};if(e===o)i=document.createElement("div");else{if(e!==l)throw new Error('Invalid element type "'+e+'" for createPortalNode: must be "html" or "svg".');i=document.createElementNS("http://www.w3.org/2000/svg","g")}if(t&&"object"==typeof t)for(var s=0,c=Object.entries(t.attributes);s<c.length;s++){var u=c[s],d=u[0],p=u[1];i.setAttribute(d,p)}var m={element:i,elementType:e,setPortalProps:function(e){r=e},getInitialPortalProps:function(){return r},mount:function(t,i){if(i!==n){if(m.unmount(),t!==a&&!function(e,t){if(t===o)return e instanceof HTMLElement;if(t===l)return e instanceof SVGElement;throw new Error('Unrecognized element type "'+t+'" for validateElementType.')}(t,e))throw new Error('Invalid element type for portal: "'+e+'" portalNodes must be used with '+e+" elements, but OutPortal is within <"+t.tagName+">.");t.replaceChild(m.element,i),a=t,n=i}},unmount:function(e){e&&e!==n||a&&n&&(a.replaceChild(n,m.element),a=void 0,n=void 0)}};return m},u=function(e){function t(t){var a=e.call(this,t)||this;return a.addPropsChannel=function(){Object.assign(a.props.node,{setPortalProps:function(e){a.setState({nodeProps:e})}})},a.state={nodeProps:a.props.node.getInitialPortalProps()},a}return s(t,e),t.prototype.componentDidMount=function(){this.addPropsChannel()},t.prototype.componentDidUpdate=function(){this.addPropsChannel()},t.prototype.render=function(){var e=this,t=this.props,a=t.children,n=t.node;return r.createPortal(i.Children.map(a,(function(t){return i.isValidElement(t)?i.cloneElement(t,e.state.nodeProps):t})),n.element)},t}(i.PureComponent),d=function(e){function t(t){var a=e.call(this,t)||this;return a.placeholderNode=i.createRef(),a.passPropsThroughPortal(),a}return s(t,e),t.prototype.passPropsThroughPortal=function(){var e=Object.assign({},this.props,{node:void 0});this.props.node.setPortalProps(e)},t.prototype.componentDidMount=function(){var e=this.props.node;this.currentPortalNode=e;var t=this.placeholderNode.current,a=t.parentNode;e.mount(a,t),this.passPropsThroughPortal()},t.prototype.componentDidUpdate=function(){var e=this.props.node;this.currentPortalNode&&e!==this.currentPortalNode&&(this.currentPortalNode.unmount(this.placeholderNode.current),this.currentPortalNode=e);var t=this.placeholderNode.current,a=t.parentNode;e.mount(a,t),this.passPropsThroughPortal()},t.prototype.componentWillUnmount=function(){this.props.node.unmount(this.placeholderNode.current)},t.prototype.render=function(){return i.createElement("div",{ref:this.placeholderNode})},t}(i.PureComponent),p=c.bind(null,o);c.bind(null,l)},function(e,t,a){"use strict";a.d(t,"o",(function(){return i})),a.d(t,"a",(function(){return r})),a.d(t,"r",(function(){return s})),a.d(t,"q",(function(){return o})),a.d(t,"n",(function(){return l})),a.d(t,"d",(function(){return c})),a.d(t,"s",(function(){return u})),a.d(t,"e",(function(){return d})),a.d(t,"c",(function(){return p})),a.d(t,"b",(function(){return m})),a.d(t,"m",(function(){return g})),a.d(t,"p",(function(){return b})),a.d(t,"l",(function(){return f})),a.d(t,"k",(function(){return y})),a.d(t,"f",(function(){return h})),a.d(t,"g",(function(){return E})),a.d(t,"i",(function(){return v})),a.d(t,"h",(function(){return x})),a.d(t,"j",(function(){return k}));var n=a(0);const i=n.i18n.translate("xpack.securitySolution.anomaliesTable.table.showingDescription",{defaultMessage:"Showing"}),r=n.i18n.translate("xpack.securitySolution.anomaliesTable.table.anomaliesDescription",{defaultMessage:"Anomalies"}),s=e=>n.i18n.translate("xpack.securitySolution.anomaliesTable.table.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {anomaly} other {anomalies}}"}),o=n.i18n.translate("xpack.securitySolution.anomaliesTable.table.anomaliesTooltip",{defaultMessage:"The anomalies table is not filterable via the SIEM global KQL search."}),l=n.i18n.translate("xpack.securitySolution.ml.table.scoreTitle",{defaultMessage:"Anomaly score"}),c=n.i18n.translate("xpack.securitySolution.ml.table.hostNameTitle",{defaultMessage:"Host name"}),u=n.i18n.translate("xpack.securitySolution.ml.table.userNameTitle",{defaultMessage:"User name"}),d=n.i18n.translate("xpack.securitySolution.ml.table.influencedByTitle",{defaultMessage:"Influenced by"}),p=n.i18n.translate("xpack.securitySolution.ml.table.entityTitle",{defaultMessage:"Entity"}),m=n.i18n.translate("xpack.securitySolution.ml.table.detectorTitle",{defaultMessage:"Job"}),g=n.i18n.translate("xpack.securitySolution.ml.table.networkNameTitle",{defaultMessage:"Network IP"}),b=n.i18n.translate("xpack.securitySolution.ml.table.timestampTitle",{defaultMessage:"Timestamp"}),f=n.i18n.translate("xpack.securitySolution.ml.table.jobIdFilter",{defaultMessage:"Job"}),y=n.i18n.translate("xpack.securitySolution.ml.table.intervalTooltip",{defaultMessage:"Show only the highest severity anomaly for each interval (such as hour or day) or show all anomalies in the selected time period."}),h=n.i18n.translate("xpack.securitySolution.ml.table.intervalLabel",{defaultMessage:"Interval"}),E=n.i18n.translate("xpack.securitySolution.ml.table.intervalAutoOption",{defaultMessage:"Auto"}),v=n.i18n.translate("xpack.securitySolution.ml.table.intervalHourOption",{defaultMessage:"1 hour"}),x=n.i18n.translate("xpack.securitySolution.ml.table.intervalDayOption",{defaultMessage:"1 day"}),k=n.i18n.translate("xpack.securitySolution.ml.table.intervalshowAllOption",{defaultMessage:"Show all"})},function(e,t,a){"use strict";a.d(t,"c",(function(){return i})),a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return s}));var n=a(34);const i=e=>Object(n.some)({category:"kibana",field:"kibana.alert.rule.uuid"},e),r=({data:e})=>{var t;if(!i(e))return!1;const a=null===(t=Object(n.find)({field:"agent.type"},e))||void 0===t?void 0:t.values;return!!a&&"endpoint"===a[0]},s=({ecsData:e})=>{if(null==e)return!1;const t=Object(n.getOr)([],"kibana.alert.original_event.module",e),a=Object(n.getOr)([],"kibana.alert.original_event.kind",e);return t.includes("endpoint")&&a.includes("alert")}},function(e,t,a){"use strict";a.d(t,"c",(function(){return r})),a.d(t,"b",(function(){return s})),a.d(t,"d",(function(){return o}));var n=a(93),i=a(110);a.d(t,"a",(function(){return i.e}));const r=n.b.ENDPOINT_EVENTS,s={name:i.f,namespace_type:"agnostic",description:i.d,list_id:i.e,type:r},o=["name","description","entries.value","entries.entries.value","comments.comment","item_id"]},function(e,t,a){"use strict";a.d(t,"c",(function(){return h})),a.d(t,"d",(function(){return v})),a.d(t,"b",(function(){return x})),a.d(t,"a",(function(){return k}));var n=a(4),i=a(120),r=a(422),s=a(77),o=a(1);const l=async e=>{const{indexName:t,entity:a}=e.query;return s.b.get().http.fetch(o.jc,{method:"GET",query:{indexName:t,entity:a},asSystemRequest:!0,signal:e.signal})};var c=a(126),u=a(85),d=a(0);d.i18n.translate("xpack.securitySolution.riskScore.errorSearchDescription",{defaultMessage:"An error has occurred on risk score search"});const p=d.i18n.translate("xpack.securitySolution.riskScore.failSearchDescription",{defaultMessage:"Failed to run search on risk score"});var m=a(84);const g=e=>{var t,a;return"index_not_found_exception"===(null===(t=e.attributes)||void 0===t||null===(a=t.caused_by)||void 0===a?void 0:a.type)};var b=a(358),f=a(130);const y={totalCount:0,data:void 0},h=({timerange:e,onlyLatest:t=!0,filterQuery:a,sort:s,skip:o=!1,pagination:d,riskEntity:h,includeAlertsCount:E=!1})=>{const v=Object(b.a)(),x=v?h===u.v.host?Object(u.E)(v,t):Object(u.F)(v,t):void 0,k=h===u.v.host?u.u.hostsRiskScore:u.u.usersRiskScore,{querySize:S,cursorStart:j}=d||{},{addError:O}=Object(m.a)(),{isDeprecated:w,isEnabled:T,isLicenseValid:I,isLoading:C,refetch:M}=((e,t)=>{const{isPlatinumOrTrialLicense:a,capabilitiesFetched:s}=Object(i.a)(),{fetch:o,data:c,isLoading:u,error:d}=Object(r.b)(r.a.GET_RISK_SCORE_DEPRECATED,l),p=Object(n.useMemo)((()=>c||{isDeprecated:a,isEnabled:a}),[c]),m=Object(n.useCallback)((t=>{o({query:{indexName:t,entity:e}})}),[e,o]);return Object(n.useEffect)((()=>{a&&null!=t&&m(t)}),[a,t,m]),{error:d,isLoading:u||!s||null==t,refetch:m,isLicenseValid:a,...p}})(h,x),{loading:F,result:D,search:A,refetch:_,inspect:N,error:R}=Object(f.a)({factoryQueryType:k,initialResult:y,abort:o,showErrorToast:!1}),P=Object(n.useCallback)((()=>{x&&(M(x),_())}),[x,_,M]);Object(n.useEffect)((()=>{P()}),[null==e?void 0:e.to,null==e?void 0:e.from]);const L=Object(n.useMemo)((()=>({data:D.data,inspect:N,refetch:P,totalCount:D.totalCount,isLicenseValid:I,isDeprecated:w,isModuleEnabled:T,isInspected:!1})),[N,w,T,I,P,D.data,D.totalCount]),B=Object(n.useMemo)((()=>e?{to:e.to,from:e.from,interval:""}:void 0),[e]),q=Object(n.useMemo)((()=>x?{defaultIndex:[x],factoryQueryType:k,riskScoreEntity:h,includeAlertsCount:E,filterQuery:Object(c.a)(a),pagination:void 0!==j&&void 0!==S?{cursorStart:j,querySize:S}:void 0,sort:s,timerange:t?void 0:B}:null),[j,x,k,a,S,s,B,t,h,E]);return Object(n.useEffect)((()=>{R&&(g(R)||O(R,{title:p}))}),[O,R]),Object(n.useEffect)((()=>{o||C||null==q||!I||!T||w||A(q)}),[T,w,I,C,q,A,o]),{...L,loading:F||C}},E=d.i18n.translate("xpack.securitySolution.riskScore.kpi.failSearchDescription",{defaultMessage:"Failed to run search on risk score"}),v=({filterQuery:e,skip:t,riskEntity:a,timerange:r})=>{const{addError:s}=Object(m.a)(),o=Object(b.a)(),l=Object(i.a)().isPlatinumOrTrialLicense,c=o?a===u.v.host?Object(u.E)(o):Object(u.F)(o):void 0,{loading:d,result:p,search:y,refetch:h,inspect:v,error:x}=Object(f.a)({factoryQueryType:u.u.kpiRiskScore,initialResult:{kpiRiskScore:u.c},abort:t,showErrorToast:!1}),k=!!x&&g(x);Object(n.useEffect)((()=>{!t&&c&&l&&y({filterQuery:e,defaultIndex:[c],entity:a})}),[c,y,e,t,a,l]),Object(n.useEffect)((()=>{h()}),[null==r?void 0:r.to,null==r?void 0:r.from]),Object(n.useEffect)((()=>{x&&(g(x)||s(x,{title:E}))}),[s,x]);const S=Object(n.useMemo)((()=>{var e,t,a,n,i;if(!d&&!x)return{[u.x.unknown]:null!==(e=p.kpiRiskScore[u.x.unknown])&&void 0!==e?e:0,[u.x.low]:null!==(t=p.kpiRiskScore[u.x.low])&&void 0!==t?t:0,[u.x.moderate]:null!==(a=p.kpiRiskScore[u.x.moderate])&&void 0!==a?a:0,[u.x.high]:null!==(n=p.kpiRiskScore[u.x.high])&&void 0!==n?n:0,[u.x.critical]:null!==(i=p.kpiRiskScore[u.x.critical])&&void 0!==i?i:0}}),[p,d,x]);return{error:x,severityCount:S,loading:d,isModuleDisabled:k,refetch:h,inspect:v}};let x,k;!function(e){e.USERS_BY_RISK="UsersByRisk",e.USER_DETAILS_RISK_SCORE="UserDetailsRiskScore"}(x||(x={})),function(e){e.DEFAULT="HostRiskScore",e.HOST_DETAILS_RISK_SCORE="HostDetailsRiskScore",e.OVERVIEW_RISKY_HOSTS="OverviewRiskyHosts",e.HOSTS_BY_RISK="HostsByRisk"}(k||(k={}))},function(e,t,a){"use strict";a.d(t,"b",(function(){return C})),a.d(t,"a",(function(){return M}));var n=a(839),i=a(4),r=a.n(i),s=a(133),o=a(102),l=a(87),c=a(106),u=a(150),d=a(636);const p={isInstance:(e,t)=>((e,t)=>-1===t.findIndex((t=>t.field===e)))(e,t),renderColumn:({columnName:e,eventId:t,field:a,isDraggable:n=!0,scopeId:i,truncate:p})=>n?r.a.createElement(s.b,{dataProvider:{enabled:!0,id:Object(o.h)(`empty-column-renderer-draggable-wrapper-${i}-${e}-${t}-${a.id}`),name:`${e}: ${Object(d.a)(null)}`,queryMatch:{field:a.id,value:Object(d.a)(null),displayValue:Object(l.e)(),operator:c.b},excluded:!0,kqlQuery:"",and:[]},isDraggable:n,key:`empty-column-renderer-draggable-wrapper-${i}-${e}-${t}-${a.id}`,render:(e,t,a)=>a.isDragging?r.a.createElement(s.a,null,r.a.createElement(u.a,{dataProvider:e})):r.a.createElement("span",null,Object(l.e)()),truncate:p,scopeId:i}):r.a.createElement("span",null,Object(l.e)())};var m=a(874),g=a(34),b=a(196);const f={isInstance:(e,t)=>((e,t)=>-1!==t.findIndex((t=>t.field===e)))(e,t),renderColumn:({asPlainText:e,columnName:t,eventId:a,field:n,isDraggable:i=!0,scopeId:s,truncate:o,values:c,linkValues:u})=>{return Array.isArray(c)&&0!==c.length?i?c.map(((l,c)=>{var d,p,m;return r.a.createElement(b.a,{asPlainText:e,contextId:`plain-column-renderer-formatted-field-value-${s}`,eventId:a,fieldFormat:null!==(d=n.format)&&void 0!==d?d:"",fieldName:t,isAggregatable:null!==(p=n.aggregatable)&&void 0!==p&&p,fieldType:null!==(m=n.type)&&void 0!==m?m:"",isDraggable:i,key:`plain-column-renderer-formatted-field-value-${s}-${t}-${a}-${n.id}-${l}-${c}`,linkValue:Object(g.head)(u),truncate:o,value:l})})):r.a.createElement(b.a,{asPlainText:e,contextId:`plain-column-renderer-formatted-field-value-${s}`,eventId:a,fieldFormat:null!==(d=n.format)&&void 0!==d?d:"",fieldName:t,isAggregatable:null!==(p=n.aggregatable)&&void 0!==p&&p,fieldType:null!==(m=n.type)&&void 0!==m?m:"",isDraggable:i,key:`plain-column-renderer-formatted-field-value-${s}-${t}-${a}-${n.id}`,linkValue:Object(g.head)(u),truncate:o,value:y(c)}):Object(l.d)();var d,p,m}};function y(e){return Array.isArray(e)?e.length>0?e.join(", "):e[0]:e}var h=a(908);const E={isInstance:()=>!0,renderColumn:()=>Object(l.d)()};var v=a(909),x=a(344),k=a(905),S=a(32),j=a(104),O=a(176),w=a(375);const T={isInstance:Object(g.isEqual)(O.i),renderColumn:({columnName:e,ecsData:t,eventId:a,field:n,isDetails:i,isDraggable:s=!0,linkValues:o,rowRenderers:l=[],scopeId:c,truncate:u,values:d})=>i&&d&&t&&l?d.map(((i,s)=>r.a.createElement(I,{ecsData:t,key:`reason-column-renderer-value-${c}-${e}-${a}-${n.id}-${i}-${s}`,rowRenderers:l,scopeId:c,value:i}))):f.renderColumn({columnName:e,eventId:a,field:n,isDetails:i,isDraggable:s,linkValues:o,scopeId:c,truncate:u,values:d})},I=({ecsData:e,rowRenderers:t,scopeId:a,value:n})=>{const s=Object(i.useMemo)((()=>Object(w.a)({data:e,rowRenderers:t})),[e,t]),o=Object(i.useMemo)((()=>s&&s.renderRow({data:e,isDraggable:!1,scopeId:a})),[s,e,a]),l=Object(i.useMemo)((()=>a===j.c.rulePreview),[a]);return r.a.createElement(r.a.Fragment,null,s&&o&&!l?r.a.createElement(S.EuiPanel,{color:"subdued",className:"eui-xScroll","data-test-subj":"reason-cell-renderer"},r.a.createElement(S.EuiText,{size:"xs"},r.a.createElement("div",{className:"eui-displayInlineBlock"},o))):n)},C=[k.a,...n.a,...x.k,h.a,v.a,m.a],M=[T,f,p,E]},function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(4),i=a.n(n),r=a(33),s=a.n(r),o=a(287),l=a(32),c=a(866);const u=s.a.header.withConfig({displayName:"FiltersGlobalContainer",componentId:"sc-z1qy4y-0"})(["display:",";"],(({show:e})=>e?"block":"none"));u.displayName="FiltersGlobalContainer";const d=i.a.memo((({children:e,show:t=!0})=>{const{globalKQLHeaderPortalNode:a}=Object(c.a)();return i.a.createElement(o.a,{node:a},i.a.createElement(l.EuiPanel,{borderRadius:"none",color:"subdued",paddingSize:"none"},i.a.createElement(u,{"data-test-subj":"filters-global-container",show:t},e)))}));d.displayName="FiltersGlobal"},,,,function(e,t,a){"use strict";a.d(t,"c",(function(){return m})),a.d(t,"i",(function(){return f})),a.d(t,"e",(function(){return y})),a.d(t,"g",(function(){return h})),a.d(t,"h",(function(){return E})),a.d(t,"f",(function(){return v})),a.d(t,"d",(function(){return x})),a.d(t,"b",(function(){return k})),a.d(t,"a",(function(){return S}));var n=a(49),i=a(32),r=a(4),s=a.n(r),o=a(33),l=a.n(o),c=a(1),u=a(77);const d="100%",p=l.a.div.withConfig({displayName:"WrappedByAutoSizerComponent",componentId:"sc-k085ek-0"})([""," position:relative;&:hover{z-index:100;}"],(e=>`\n    height: ${null!=e.height?e.height:d};\n  `));p.displayName="WrappedByAutoSizer";const m=s.a.memo(p);let g;!function(e){e.BAR="bar",e.AREA="area",e.LINE="line"}(g||(g={}));const b={chartMargins:{left:0,right:0,top:4,bottom:0},chartPaddings:{left:0,right:0,top:0,bottom:0},scales:{barsPadding:.05}},f=()=>{const e=Object(u.p)(c.O)?n.DARK_THEME:n.LIGHT_THEME;return Object(r.useMemo)((()=>Object(n.mergeWithDefaultTheme)(b,e)),[])},y={rotation:0,rendering:"canvas",animatedData:!1,showLegend:!1,showLegendExtra:!1,debug:!1,legendPosition:n.Position.Bottom},h=(e,t)=>{const a=e||t;return a?`${a}px`:d},E=(e,t)=>{const a=e||t;return a?`${a}px`:"100%"},v=e=>Array.isArray(e)&&e.every((e=>Array.isArray(e.value)&&e.value.every((({y:e})=>0===e)))),x=l.a.div.withConfig({displayName:"Wrapper",componentId:"sc-k085ek-1"})(["position:relative;"]),k=l()(i.EuiFlexGroup).withConfig({displayName:"ChartWrapper",componentId:"sc-k085ek-2"})(["z-index:0;"]),S=l()(i.EuiFlexGroup).withConfig({displayName:"BarChartWrapper",componentId:"sc-k085ek-3"})(["z-index:0;padding-right:20px;"])},function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(34);const i=({category:e,field:t},a)=>{const i=(({category:e,field:t},a)=>{var i,r,s;const o="signal"===e?"kibana":"kibana"===e?"signal":e,l="signal"===e?t.replace("signal","kibana.alert").replace("rule.id","rule.uuid"):"kibana"===e?t.replace("kibana.alert","signal").replace("rule.uuid","rule.id"):t;return null!==(i=null===(r=Object(n.find)({category:e,field:t},a))||void 0===r?void 0:r.values)&&void 0!==i?i:null===(s=Object(n.find)({category:o,field:l},a))||void 0===s?void 0:s.values})({category:e,field:t},a);return i&&i.length>0?i[0]:""}},function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(56);const i=(e,t)=>{const a=e.split(".");return 1===a.length?{[a[0]]:t}:{[a[0]]:i(a.slice(1).join("."),t)}},r=e=>Array.isArray(e)?e:Object.entries(e).reduce(((e,[t,a])=>Object(n.merge)(e,i(t,a))),{})},function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return r})),a.d(t,"c",(function(){return s})),a.d(t,"d",(function(){return o})),a.d(t,"e",(function(){return l})),a.d(t,"g",(function(){return c})),a.d(t,"f",(function(){return u}));var n=a(0);const i=n.i18n.translate("xpack.securitySolution.containers.detectionEngine.rulesAndTimelines",{defaultMessage:"Failed to fetch Rules and Timelines"}),r=n.i18n.translate("xpack.securitySolution.containers.detectionEngine.addRuleFailDescription",{defaultMessage:"Failed to add Rule"}),s=n.i18n.translate("xpack.securitySolution.containers.detectionEngine.createPrePackagedRuleAndTimelineFailDescription",{defaultMessage:"Failed to installed pre-packaged rules and timelines from elastic"}),o=n.i18n.translate("xpack.securitySolution.containers.detectionEngine.createPrePackagedRuleAndTimelineSuccesDescription",{defaultMessage:"Installed pre-packaged rules and timeline templates from elastic"}),l=n.i18n.translate("xpack.securitySolution.containers.detectionEngine.createPrePackagedRuleSuccesDescription",{defaultMessage:"Installed pre-packaged rules from elastic"}),c=n.i18n.translate("xpack.securitySolution.containers.detectionEngine.createPrePackagedTimelineSuccesDescription",{defaultMessage:"Installed pre-packaged timeline templates from elastic"}),u=n.i18n.translate("xpack.securitySolution.containers.detectionEngine.tagFetchFailDescription",{defaultMessage:"Failed to fetch Tags"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return E}));var n=a(82),i=a.n(n),r=a(4),s=a.n(r),o=a(32),l=a(78),c=a(98),u=a(90),d=a(145),p=a(12),m=a(184),g=a(95),b=a(79),f=a(210),y=a(118),h=a(81);const E=({asEmptyButton:e,children:t,dataProviders:a,filters:n,timeRange:E,keepDataView:v,...x})=>{const k=Object(l.useDispatch)(),S=Object(r.useMemo)((()=>c.e.getSourcererDataViewsSelector()),[]),{defaultDataView:j,signalIndexName:O}=Object(h.a)((e=>S(e))),w=a&&a.find((e=>"template"===e.type)),T=Object(f.a)({timelineId:b.j.active,timelineType:w?b.n.template:b.n.default}),I=Object(r.useCallback)((()=>{(a||n)&&(E?T({timeRange:E}):T(),a&&k(Object(p.updateProviders)({id:b.j.active,providers:a})),n&&k(Object(p.setFilters)({id:b.j.active,filters:n})),v||k(m.c.setSelectedDataView({id:g.SourcererScopeName.timeline,selectedDataViewId:j.id,selectedPatterns:[O||""]})),k(d.b.removeLinkTo([u.a.timeline,u.a.global])))}),[a,T,k,j.id,O,n,E,v]);return e?s.a.createElement(o.EuiButtonEmpty,{"aria-label":y.f,onClick:I,flush:"right",size:"xs"},t):s.a.createElement(o.EuiButton,i()({"aria-label":y.f,onClick:I},x),t)};E.displayName="InvestigateInTimelineButton"},function(e,t,a){"use strict";a.d(t,"j",(function(){return s})),a.d(t,"b",(function(){return o})),a.d(t,"g",(function(){return l})),a.d(t,"c",(function(){return c})),a.d(t,"f",(function(){return u})),a.d(t,"d",(function(){return d})),a.d(t,"i",(function(){return p})),a.d(t,"h",(function(){return m})),a.d(t,"e",(function(){return g})),a.d(t,"a",(function(){return b}));var n=a(34),i=a(79),r=a(254);const s=(e,t)=>"__typename"!==e&&null!=t?t:void 0,o=e=>!Object(n.isEmpty)(e),l=({isAlert:e,isPinned:t,eventHasNotes:a,timelineType:n})=>n===i.n.template?r.f(e):t&&a?r.l(e):t?r.k(e):r.q(e),c=({eventId:e,pinnedEventIds:t})=>!0===t[e],u=({allowUnpinning:e,eventId:t,onPinEvent:a,onUnPinEvent:n,isEventPinned:i})=>{e&&(i?n(t):a(t))},d=(e,t,a)=>e.reduce(((e,n)=>({...e,...t.includes(n._id)?{[n._id]:n.data.filter((e=>a.includes(e.field)))}:{}})),{}),p=e=>{var t,a;return!Object(n.isEmpty)(null===(t=e.kibana)||void 0===t||null===(a=t.alert)||void 0===a?void 0:a.building_block_type)},m=e=>{var t;if(!Object(n.isEmpty)(null===(t=e.eql)||void 0===t?void 0:t.sequenceNumber))try{var a,i;const t=(null!==(a=null===(i=e.eql)||void 0===i?void 0:i.sequenceNumber)&&void 0!==a?a:"").split("-")[0];return parseInt(t,10)%2==0}catch{return!1}return!1},g=e=>{var t,a,i,r;return Object(n.isEmpty)(null===(t=e.kibana)||void 0===t||null===(a=t.alert)||void 0===a||null===(i=a.rule)||void 0===i?void 0:i.uuid)?Object(n.isEmpty)(null===(r=e.eql)||void 0===r?void 0:r.parentId)?"raw":"eql":"signal"},b="note-content"},function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return s}));var n=a(0);const i=n.i18n.translate("xpack.securitySolution.chart.dataAllValuesZerosTitle",{defaultMessage:"All values returned zero"}),r=n.i18n.translate("xpack.securitySolution.chart.dataNotAvailableTitle",{defaultMessage:"Chart Data Not Available"}),s=n.i18n.translate("xpack.securitySolution.chart.emptyValueLabel",{defaultMessage:"empty value"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"e",(function(){return i})),a.d(t,"c",(function(){return r})),a.d(t,"f",(function(){return s})),a.d(t,"b",(function(){return o})),a.d(t,"d",(function(){return l}));const n=e=>e?[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:"host.name",params:{query:e}},query:{match_phrase:{"host.name":e}}}]:[],i=[{query:{bool:{should:[{exists:{field:"host.name"}}],minimum_should_match:1}},meta:{alias:"",disabled:!1,key:"bool",negate:!1,type:"custom",value:'{"query": {"bool": {"filter": [{"bool": {"should": [{"exists": {"field": "host.name"}}],"minimum_should_match": 1}}]}}}'}}],r=e=>e?[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:"source.ip",params:{query:e}},query:{bool:{should:[{match_phrase:{"source.ip":e}},{match_phrase:{"destination.ip":e}}],minimum_should_match:1}}}]:[],s=[{query:{bool:{should:[{exists:{field:"source.ip"}},{exists:{field:"destination.ip"}}],minimum_should_match:1}},meta:{alias:"",disabled:!1,key:"bool",negate:!1,type:"custom",value:'{"bool":{"filter":[{"bool":{"should":[{"bool":{"should":[{"exists":{"field": "source.ip"}}],"minimum_should_match":1}},{"bool":{"should":[{"exists":{"field": "destination.ip"}}],"minimum_should_match":1}}],"minimum_should_match":1}}]}}'}}],o=e=>e.length>=1?[{meta:{type:"phrases",key:"_index",params:e,alias:null,negate:!1,disabled:!1},query:{bool:{should:e.map((e=>({match_phrase:{_index:e}}))),minimum_should_match:1}}}]:[],l=e=>e.reduce(((e,t)=>{var a,n,i,r,s,o;return{requests:[...e.requests,JSON.stringify({body:null==t?void 0:t.json,index:(null!==(a=null==t||null===(n=t.stats)||void 0===n||null===(i=n.indexFilter)||void 0===i?void 0:i.value)&&void 0!==a?a:"").split(",")},null,2)],responses:[...e.responses,JSON.stringify(null!==(r=null==t||null===(s=t.response)||void 0===s||null===(o=s.json)||void 0===o?void 0:o.rawResponse)&&void 0!==r?r:{},null,2)]}}),{requests:[],responses:[]})},function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return l}));var n=a(4),i=a.n(n),r=a(88),s=a(722);const o="event.duration",l=i.a.memo((({contextId:e,eventId:t,fieldName:a,fieldType:n,isAggregatable:o,isDraggable:l,value:c})=>l?i.a.createElement(r.b,{id:`duration-default-draggable-${e}-${t}-${a}-${c}`,fieldType:n,isAggregatable:o,isDraggable:l,field:a,tooltipContent:null,value:c},i.a.createElement(s.a,{maybeDurationNanoseconds:c,tooltipTitle:a})):i.a.createElement(s.a,{maybeDurationNanoseconds:c,tooltipTitle:a})));l.displayName="Duration"},function(e,t,a){"use strict";a.d(t,"d",(function(){return s})),a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return l})),a.d(t,"c",(function(){return c}));var n=a(4),i=a.n(n),r=a(196);const s="source.ip",o="destination.ip",l="ip",c=i.a.memo((({contextId:e,eventId:t,fieldName:a,isDraggable:n,value:s})=>i.a.createElement(r.a,{contextId:e,"data-test-subj":"formatted-ip",eventId:t,fieldName:a,isDraggable:n,fieldType:l,value:s,truncate:!0})));c.displayName="Ip"},function(e,t,a){(function(t){const a="object"==typeof t&&Object({IS_KIBANA_DISTRIBUTABLE:"true"})&&Object({IS_KIBANA_DISTRIBUTABLE:"true"}).NODE_DEBUG&&/\bsemver\b/i.test(Object({IS_KIBANA_DISTRIBUTABLE:"true"}).NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=a}).call(this,a(545))},function(e,t){const a=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:a,MAX_SAFE_COMPONENT_LENGTH:16}},function(e,t,a){"use strict";var n=Object.assign;e.exports=n},function(e,t,a){"use strict";a.d(t,"g",(function(){return h})),a.d(t,"b",(function(){return w})),a.d(t,"e",(function(){return C})),a.d(t,"f",(function(){return M})),a.d(t,"h",(function(){return F})),a.d(t,"c",(function(){return L})),a.d(t,"d",(function(){return B})),a.d(t,"a",(function(){return q}));var n=a(52),i=a.n(n),r=a(43),s=a.n(r),o=a(294),l=a.n(o),c=(a(37),a(33)),u=a.n(c),d=a(32),p=a(110),m=a(166),g=a(174),b=a(661),f=a(167),y=a(567);const h=({rule:e,detailsView:t=!1})=>{const a=v(e);return{aboutRuleData:j(e,t),modifiedAboutRuleDetailsData:I(e),defineRuleData:a,scheduleRuleData:k(e),ruleActionsData:E(e)}},E=e=>{const{enabled:t,throttle:a,meta:n,actions:i=[],response_actions:r}=e;return{actions:null==i?void 0:i.map(b.c),responseActions:null==r?void 0:r.map(b.d),throttle:a,kibanaSiemAppUrl:null==n?void 0:n.kibana_siem_app_url,enabled:t}},v=e=>{var t,a,n,i,r,s,o,l,c,u,d,p,g,b,y,h,E,v,k,S,j,O,w;return{ruleType:e.type,anomalyThreshold:null!==(t=e.anomaly_threshold)&&void 0!==t?t:50,machineLearningJobId:null!==(a=e.machine_learning_job_id)&&void 0!==a?a:[],index:null!==(n=e.index)&&void 0!==n?n:[],dataViewId:e.data_view_id,threatIndex:null!==(i=e.threat_index)&&void 0!==i?i:[],threatQueryBar:{query:{query:null!==(r=e.threat_query)&&void 0!==r?r:"",language:null!==(s=e.threat_language)&&void 0!==s?s:""},filters:null!==(o=e.threat_filters)&&void 0!==o?o:[],saved_id:null},threatMapping:null!==(l=e.threat_mapping)&&void 0!==l?l:[],queryBar:{query:{query:null!==(c=e.query)&&void 0!==c?c:"",language:null!==(u=e.language)&&void 0!==u?u:""},filters:null!==(d=e.filters)&&void 0!==d?d:[],saved_id:null!==(p=e.saved_id)&&void 0!==p?p:null},relatedIntegrations:null!==(g=e.related_integrations)&&void 0!==g?g:[],requiredFields:null!==(b=e.required_fields)&&void 0!==b?b:[],timeline:{id:null!==(y=e.timeline_id)&&void 0!==y?y:null,title:null!==(h=e.timeline_title)&&void 0!==h?h:null},threshold:{field:Object(m.h)(null===(E=e.threshold)||void 0===E?void 0:E.field),value:`${(null===(v=e.threshold)||void 0===v?void 0:v.value)||100}`,...null!==(k=e.threshold)&&void 0!==k&&null!==(S=k.cardinality)&&void 0!==S&&S.length?{cardinality:{field:[`${e.threshold.cardinality[0].field}`],value:`${e.threshold.cardinality[0].value}`}}:{}},eqlOptions:{timestampField:e.timestamp_field,eventCategoryField:e.event_category_override,tiebreakerField:e.tiebreaker_field},dataSourceType:e.data_view_id?f.a.DataView:f.a.IndexPatterns,newTermsFields:null!==(j=e.new_terms_fields)&&void 0!==j?j:[],historyWindowSize:e.history_window_start?x(e.history_window_start):"7d",shouldLoadQueryDynamically:Boolean("saved_query"===e.type&&e.saved_id),groupByFields:null!==(O=null===(w=e.alert_suppression)||void 0===w?void 0:w.group_by)&&void 0!==O?O:[]}},x=e=>e.startsWith("now-")?e.substring(4):e,k=e=>{const{interval:t,from:a}=e;return{interval:t,from:S(a,t)}},S=(e,t)=>{var a,n;const r=null!==(a=i.a.parse(e))&&void 0!==a?a:s()(),o=null!==(n=i.a.parse(`now-${t}`))&&void 0!==n?n:s()(),l=s.a.duration(o.diff(r)),c=Math.floor(l.asSeconds());return 0===c?"0s":c%3600==0?c/3600+"h":c%60==0?c/60+"m":`${c}s`},j=(e,t)=>{var a;const{name:n,description:i,note:r}=T(e,t),{author:s,building_block_type:o,exceptions_list:l,license:c,risk_score_mapping:u,rule_name_override:d,severity_mapping:m,timestamp_override:g,timestamp_override_fallback_disabled:b,references:f,severity:y,false_positives:h,risk_score:E,tags:v,threat:x,threat_indicator_path:k}=e;return{author:s,isAssociatedToEndpointList:null!==(a=null==l?void 0:l.some((({id:e})=>e===p.j)))&&void 0!==a&&a,isBuildingBlock:void 0!==o,license:null!=c?c:"",ruleNameOverride:null!=d?d:"",timestampOverride:null!=g?g:"",timestampOverrideFallbackDisabled:b,name:n,description:i,note:r,references:f,severity:{value:y,mapping:w(m),isMappingChecked:m.length>0},tags:v,riskScore:{value:E,mapping:u,isMappingChecked:u.length>0},falsePositives:h,threat:x,threatIndicatorPath:k}},O={low:0,medium:1,high:2,critical:3},w=e=>{const t=y.i.flatMap((t=>null==e.find((e=>e.severity===t.value))?[{field:"",value:"",operator:"equals",severity:t.value}]:[]));return[...e,...t].sort(((e,t)=>O[e.severity]-O[t.severity]))},T=(e,t)=>{const{name:a,description:n,note:i}=e;return t?{name:"",description:"",note:""}:{name:a,description:n,note:null!=i?i:""}},I=e=>{var t,a;return{note:null!==(t=e.note)&&void 0!==t?t:"",description:e.description,setup:null!==(a=e.setup)&&void 0!==a?a:""}},C=(e,t,a)=>null!=t&&0===e&&t>0&&0===a?"ruleNotInstalled":null!=e&&e>0&&0===t&&0===a?"ruleInstalled":null!=e&&null!=t&&e>0&&t>0&&0===a?"someRuleUninstall":null!=e&&null!=t&&null!=a&&e>0&&t>=0&&a>0?"ruleNeedUpdate":"unknown",M=(e,t,a)=>null!=t&&0===e&&t>0&&0===a?"timelinesNotInstalled":null!=e&&e>0&&0===t&&0===a?"timelinesInstalled":null!=e&&null!=t&&e>0&&t>0&&0===a?"someTimelineUninstall":null!=e&&null!=t&&null!=a&&e>0&&t>=0&&a>0?"timelineNeedUpdate":"unknown",F=(e,t,a,n)=>!1===e||!1===t||!1===a||n,D=["id","name","description","false_positives","rule_id","max_signals","risk_score","output_index","references","severity","timeline_id","timeline_title","threat","type","version"],A=["index","filters","language","query","saved_id","response_actions"],_=["anomaly_threshold","machine_learning_job_id"],N=["threshold",...A],R=e=>{switch(e){case"machine_learning":return _;case"threshold":return N;case"new_terms":case"threat_match":case"query":case"saved_query":case"eql":return A}Object(g.a)(e)},P=e=>({state:[{name:"signals_count",description:"state.signals_count"}],params:[],context:[{name:"results_link",description:"context.results_link",useWithTripleBracesInTemplates:!0},{name:"alerts",description:"context.alerts"},...e.map((e=>{const t=`rule.${e}`;return{name:t,description:`context.${t}`}}))]}),L=l()((e=>{if(!e)return{state:[],params:[]};const t=(e=>[...D,...R(e)].sort())(e);return P(t)})),B=()=>P((()=>{const e=[...D,...A,..._,...N].sort();return Array.from(new Set(e))})()),q=u()(d.EuiFlexItem).withConfig({displayName:"MaxWidthEuiFlexItem",componentId:"sc-97v502-0"})(["max-width:1000px;overflow:hidden;"])},function(e,t,a){"use strict";a.d(t,"m",(function(){return i})),a.d(t,"k",(function(){return r})),a.d(t,"l",(function(){return s})),a.d(t,"i",(function(){return o})),a.d(t,"j",(function(){return l})),a.d(t,"h",(function(){return c})),a.d(t,"g",(function(){return u})),a.d(t,"b",(function(){return d})),a.d(t,"a",(function(){return p})),a.d(t,"d",(function(){return m})),a.d(t,"c",(function(){return g})),a.d(t,"f",(function(){return b})),a.d(t,"e",(function(){return f}));var n=a(0);const i=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlValidation.requestError",{defaultMessage:"An error occurred while validating your EQL query"}),r=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlValidation.title",{defaultMessage:"EQL Validation Errors"}),s=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlValidation.showErrorsLabel",{defaultMessage:"Show EQL Validation Errors"}),o=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOverViewLink.text",{defaultMessage:"Event Query Language (EQL) Overview"}),l=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlSettings.title",{defaultMessage:"EQL settings"}),c=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsSize.label",{defaultMessage:"Size"}),u=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsSize.text",{defaultMessage:"For basic queries, the maximum number of matching events to return. For sequence queries, the maximum number of matching sequences to return."}),d=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventCategoryField.label",{defaultMessage:"Event category field"}),p=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventCategoryField.text",{defaultMessage:"Field containing the event classification, such as process, file, or network. This field is typically mapped as a field type in the keyword family"}),m=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTiebreakerField.label",{defaultMessage:"Tiebreaker field"}),g=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTiebreakerField.text",{defaultMessage:"Field used to sort hits with the same timestamp in ascending, lexicographic order"}),b=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTimestampField.label",{defaultMessage:"Timestamp field"}),f=n.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTimestampField.text",{defaultMessage:"Field containing event timestamp"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(4);const i=(e=!1)=>{const[t,a]=Object(n.useState)(e);return[t,Object(n.useCallback)((()=>{a(!0)}),[]),Object(n.useCallback)((()=>{a(!1)}),[]),Object(n.useCallback)((()=>{a((e=>!e))}),[])]}},function(e,t,a){"use strict";a.d(t,"d",(function(){return s})),a.d(t,"a",(function(){return o})),a.d(t,"c",(function(){return l})),a.d(t,"b",(function(){return c}));var n=a(113),i=a(157),r=a(416);const s=e=>"boolean"==typeof e,o=(e,t)=>{var a;return null==e||!((null===(a=e.actions)||void 0===a?void 0:a.length)>0&&s(t))||t},l=e=>null==e||e,c=(e,t,a,s)=>null==e?void 0:Object(i.d)(e.type)&&!t?r.f:o(e,a)?l(s)?void 0:n.Pb:n.Ob},function(e,t,a){"use strict";a.d(t,"d",(function(){return o})),a.d(t,"c",(function(){return l})),a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return u}));var n=a(117),i=a.n(n),r=a(139);const s=r.b.length,o=e=>{var t;return void 0!==(null!==(t=e.tags)&&void 0!==t?t:[]).find((e=>e===r.d))},l=e=>!o(e),c=e=>{var t;const a=[],n=null!==(t=e.tags)&&void 0!==t?t:[];for(const e of n)e!==r.d&&e.startsWith(r.b)&&a.push(e.substring(s));return a},u=e=>({comments:[],description:"",entries:[],item_id:void 0,list_id:e,meta:{temporaryUuid:i.a.v4()},name:"",namespace_type:"agnostic",tags:[r.d],type:"simple",os_types:["windows"]})},function(e,t,a){"use strict";a.d(t,"a",(function(){return ExceptionsListApiClient}));var n=a(6),i=a.n(n),r=a(110),s=a(105);class ExceptionsListApiClient{constructor(e,t,a,n,r){i()(this,"ensureListExists",void 0),this.http=e,this.listId=t,this.listDefinition=a,this.readTransform=n,this.writeTransform=r,this.ensureListExists=this.createExceptionList()}async createExceptionList(){return ExceptionsListApiClient.wasListCreated.has(this.listId)||ExceptionsListApiClient.wasListCreated.set(this.listId,new Promise(((e,t)=>{(async()=>{try{await this.http.post(r.u,{body:JSON.stringify({...this.listDefinition,list_id:this.listId})}),e()}catch(e){ExceptionsListApiClient.wasListCreated.delete(this.listId),t(e)}})()}))),ExceptionsListApiClient.wasListCreated.get(this.listId)}checkIfIsUsingTheRightInstance(e){if(e!==this.listId)throw new Error(`The list id you are using is not valid, expected [${this.listId}] list id but received [${e}] list id`)}isHttp(e){return this.http===e}static getInstance(e,t,a,n,i){var r;ExceptionsListApiClient.instance.has(t)&&null!==(r=ExceptionsListApiClient.instance.get(t))&&void 0!==r&&r.isHttp(e)||ExceptionsListApiClient.instance.set(t,new ExceptionsListApiClient(e,t,a,n,i));return ExceptionsListApiClient.instance.get(t)||new ExceptionsListApiClient(e,t,a,n,i)}static cleanExceptionsBeforeUpdate(e){var t;const a={...e};return["created_at","created_by","list_id","tie_breaker_id","updated_at","updated_by","meta"].forEach((e=>{delete a[e]})),a.comments=null===(t=a.comments)||void 0===t?void 0:t.map((e=>({comment:e.comment,id:e.id}))),a}async find({perPage:e=s.c,page:t=s.b+1,sortField:a,sortOrder:n,filter:i}={}){await this.ensureListExists;const o=await this.http.get(`${r.p}/_find`,{query:{page:t,per_page:e,sort_field:a,sort_order:n,list_id:[this.listId],namespace_type:["agnostic"],filter:i}});return this.readTransform&&(o.data=o.data.map(this.readTransform)),o}async get(e,t){if(!e&&!t)throw TypeError("either `itemId` or `id` argument must be set");await this.ensureListExists;let a=await this.http.get(r.p,{query:{id:t,item_id:e,namespace_type:"agnostic"}});return this.readTransform&&(a=this.readTransform(a)),a}async create(e){await this.ensureListExists,this.checkIfIsUsingTheRightInstance(e.list_id),delete e.meta;let t=e;return this.writeTransform&&(t=this.writeTransform(e)),this.http.post(r.p,{body:JSON.stringify(t)})}async update(e){await this.ensureListExists;let t=e;return this.writeTransform&&(t=this.writeTransform(e)),this.http.put(r.p,{body:JSON.stringify(ExceptionsListApiClient.cleanExceptionsBeforeUpdate(t))})}async delete(e,t){if(!e&&!t)throw TypeError("either `itemId` or `id` argument must be set");return await this.ensureListExists,this.http.delete(r.p,{query:{id:t,item_id:e,namespace_type:"agnostic"}})}async summary(e){return await this.ensureListExists,this.http.get(`${r.s}/summary`,{query:{filter:e,list_id:this.listId,namespace_type:"agnostic"}})}async hasData(){return(await this.find({perPage:1,page:1})).total>0}}i()(ExceptionsListApiClient,"instance",new Map),i()(ExceptionsListApiClient,"wasListCreated",new Map)},,function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return s}));var n=a(77),i=a(1);const r=async({body:e,signal:t})=>n.b.get().http.fetch(i.tc,{method:"POST",body:JSON.stringify(e),signal:t}),s=async(e,t)=>n.b.get().http.fetch(i.tc,{method:"GET",query:{dataViewId:e},asSystemRequest:!0,signal:t})},function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(82),i=a.n(n),r=a(33),s=a.n(r),o=a(4),l=a.n(o),c=a(32);const u=s()((({loading:e,...t})=>l.a.createElement(c.EuiPanel,i()({},t,{hasBorder:!0})))).withConfig({displayName:"Panel",componentId:"sc-1bcf9ex-0"})(["position:relative;",""],(({loading:e})=>e&&"\n    overflow: hidden;\n  "));u.displayName="Panel"},function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(43),i=a.n(n);const r=(e,t)=>"second"===t||"minute"===t||"hour"===t?{from:i()(e.time).subtract(1,"hour").toISOString(),to:i()(e.time).add(1,"hour").toISOString()}:{from:i()(e.time).subtract(1,"day").toISOString(),to:i()(e.time).add(1,"day").toISOString()}},function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(4),i=a.n(n),r=a(716),s=a(164);const o=Object(n.memo)((()=>i.a.createElement(s.a,null,i.a.createElement(r.a,null))));o.displayName="LandingPageComponent"},function(e,t,a){const n=a(152);e.exports=(e,t,a)=>n(e,t,a)<=0},function(e,t){const a=["includePrerelease","loose","rtl"];e.exports=e=>e?"object"!=typeof e?{loose:!0}:a.filter((t=>e[t])).reduce(((e,t)=>(e[t]=!0,e)),{}):{}},function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(82),i=a.n(n),r=a(4),s=a.n(r),o=a(32),l=a(243),c=a(1);const u=Object(r.memo)((({appId:e=c.B,deepLinkId:t,appPath:a,appState:n,onClick:r,asButton:u,children:d,...p})=>{const m=Object(l.a)(e,{deepLinkId:t,path:a,state:n,onClick:r});return s.a.createElement(s.a.Fragment,null,u&&!0===u?s.a.createElement(o.EuiButton,i()({},p,{onClick:m}),d):s.a.createElement(o.EuiLink,i()({},p,{onClick:m}),d))}))},,function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));var n=a(4),i=a(1),r=a(77);const s=async(e,t)=>r.b.get().http.fetch("/api/ml/results/anomalies_table_data",{method:"POST",body:JSON.stringify(e),asSystemRequest:!0,signal:t});var o=a(868),l=a(84),c=a(422),u=a(120),d=a(171);const p=e=>null==e?"":e.reduce(((e,t)=>`${e}${t.fieldName}:${t.fieldValue}`),""),m=(e,t)=>-1!==t?t:null==e?50:e<0?0:e>100?100:Math.floor(e),g=({criteriaFields:e=[],influencers:t=[],startDate:a,endDate:g,threshold:b=-1,skip:f=!1,filterQuery:y,jobIds:h,aggregationInterval:E})=>{const v=Object(u.a)(),x=Object(d.a)(v),{addError:k}=Object(l.a)(),S=Object(r.n)(),[j]=Object(r.q)(i.K),O=Object(n.useMemo)((()=>new Date(a).getTime()),[a]),w=Object(n.useMemo)((()=>new Date(g).getTime()),[g]),{fetch:T,data:I=null,isLoading:C,error:M}=Object(c.b)(c.a.ANOMALIES_TABLE,s,{disabled:f});return Object(n.useEffect)((()=>{M&&k(M,{title:o.a})}),[M,k]),Object(n.useEffect)((()=>{x&&h.length>0&&T({jobIds:h,criteriaFields:e,influencersFilterQuery:y,aggregationInterval:E,threshold:m(j,b),earliestMs:O,latestMs:w,influencers:t,dateFormatTz:S,maxRecords:500,maxExamples:10})}),[p(t),p(e),O,w,x,E,h.sort().join()]),[C,I]}},function(e,t,a){"use strict";a.d(t,"a",(function(){return O}));var n=a(4),i=a.n(n),r=a(33),s=a.n(r),o=a(32),l=a(78);const c=a(0).i18n.translate("xpack.securitySolution.components.histogram.stackByOptions.stackByLabel",{defaultMessage:"Stack by"});var u=a(620),d=a(119),p=a(621),m=a(318),g=a(460),b=a(924),f=a(143),y=a(90),h=a(211),E=a(530),v=a(1),x=a(183),k=a(109);const S=s()(m.a).withConfig({displayName:"HistogramPanel",componentId:"sc-b0xfci-0"})(["display:flex;flex-direction:column;",""],(({height:e})=>null!=e?`min-height: ${e}px;`:"")),j=({chartHeight:e,defaultStackByOption:t,endDate:a,errorMessage:r,filterQuery:s,getLensAttributes:m,headerChildren:j,histogramType:O,hideHistogramIfEmpty:w=!1,id:T,indexNames:I,runtimeMappings:C,isPtrIncluded:M,legendPosition:F,lensAttributes:D,mapping:A,onError:_,paddingSize:N="m",panelHeight:R=300,setAbsoluteRangeDatePickerTarget:P=y.a.global,setQuery:L,showInspectButton:B=!1,showLegend:q,showSpacer:z=!0,stackByOptions:$,startDate:V,subtitle:U,scopeId:H,title:G,titleSize:Q,yTickFormatter:W,skip:K})=>{const Y=Object(l.useDispatch)(),J=Object(n.useCallback)((({x:e})=>{if(!e)return;const[t,a]=e;Y(Object(f.setAbsoluteRangeDatePicker)({id:P,from:new Date(t).toISOString(),to:new Date(a).toISOString()}))}),[Y,P]),X=Object(n.useMemo)((()=>Object(g.b)({chartHeight:e,from:V,legendPosition:F,to:a,onBrushEnd:J,yTickFormatter:W,showLegend:q})),[e,V,F,a,J,W,q]),[Z,ee]=Object(n.useState)(!0),[te,ae]=Object(n.useState)(t);Object(n.useEffect)((()=>{ae(t)}),[t]);const ne=Object(n.useCallback)((e=>{var a;ae(null!==(a=$.find((t=>t.value===e.target.value)))&&void 0!==a?a:t)}),[t,$]),{toggleStatus:ie,setToggleStatus:re}=Object(k.a)(T),[se,oe]=Object(n.useState)(K||!ie);Object(n.useEffect)((()=>{oe(K||!ie)}),[K,ie]);const le=Object(n.useCallback)((e=>{re(e),oe(!e)}),[oe,re]),ce={endDate:a,errorMessage:r,filterQuery:s,histogramType:O,indexNames:I,onError:_,startDate:V,stackByField:te.value,runtimeMappings:C,isPtrIncluded:M,skip:se},[ue,{data:de,inspect:pe,totalCount:me,refetch:ge}]=Object(b.a)(ce),[{pageName:be}]=Object(x.a)(),fe=be===v.uc.hosts||be===v.uc.network||be===v.uc.users,ye=Object(n.useMemo)((()=>null!=G&&"function"==typeof G?G(te):G),[G,te]),he=Object(n.useMemo)((()=>Z?null:"function"==typeof U?me>=0?U(me):null:U),[Z,U,me]),Ee=Object(n.useMemo)((()=>!!(me<=0&&w)),[me,w]),ve=Object(n.useMemo)((()=>Object(g.c)(de,A)),[de,A]);Object(n.useEffect)((()=>{ue||Z||L({id:T,inspect:pe,loading:ue,refetch:ge}),Z&&ve&&de&&ee(!1)}),[L,T,pe,ue,ge,Z,ve,de,ee]);const xe=Object(n.useMemo)((()=>({from:V,to:a})),[V,a]);return Ee?null:i.a.createElement(i.a.Fragment,null,i.a.createElement(h.a,{show:!Z,targetClassNames:[E.a]},i.a.createElement(S,{"data-test-subj":`${T}Panel`,height:ie?R:void 0,paddingSize:N},ue&&!Z&&i.a.createElement(o.EuiProgress,{"data-test-subj":"initialLoadingPanelMatrixOverTime",size:"xs",position:"absolute",color:"accent"}),i.a.createElement(d.a,{id:T,height:ie?void 0:0,title:ye,titleSize:Q,toggleStatus:ie,toggleQuery:le,subtitle:he,inspectMultiple:!0,showInspectButton:B||!fe,isInspectDisabled:void 0===s},i.a.createElement(o.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},fe&&(m||D)&&xe&&i.a.createElement(o.EuiFlexItem,{grow:!1},i.a.createElement(E.b,{className:"histogram-viz-actions",getLensAttributes:m,isInspectButtonDisabled:void 0===s,lensAttributes:D,queryId:T,stackByField:te.value,timerange:xe,title:G})),i.a.createElement(o.EuiFlexItem,{grow:!1},$.length>1&&i.a.createElement(o.EuiSelect,{onChange:ne,options:$,prepend:c,value:null==te?void 0:te.value})),i.a.createElement(o.EuiFlexItem,{grow:!1},j))),ie?Z?i.a.createElement(p.a,null):i.a.createElement(u.a,{barChart:ve,configs:X,stackByField:te.value,scopeId:H}):null)),z&&i.a.createElement(o.EuiSpacer,{"data-test-subj":"spacer",size:"l"}))},O=i.a.memo(j)},function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(4),i=a.n(n),r=a(32),s=a(0),o=a(35);const l=s.i18n.translate("xpack.securitySolution.detectionResponse.updating",{defaultMessage:"Updating..."}),c=s.i18n.translate("xpack.securitySolution.detectionResponse.updated",{defaultMessage:"Updated"}),u=({isUpdating:e,updatedAt:t})=>i.a.createElement(r.EuiFlexGroup,null,e?i.a.createElement(r.EuiFlexItem,{grow:!1},l):i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(i.a.Fragment,null,c," "),i.a.createElement(o.FormattedRelative,{"data-test-subj":"last-updated-at-date",value:new Date(t)})))},,function(e,t,a){var n=a(433),i=a(750),r=a(751),s=a(437),o=a(770),l=a(441),c=a(771),u=a(443),d=a(444),p=a(447),m=Math.max;e.exports=function(e,t,a,g,b,f,y,h){var E=2&t;if(!E&&"function"!=typeof e)throw new TypeError("Expected a function");var v=g?g.length:0;if(v||(t&=-97,g=b=void 0),y=void 0===y?y:m(p(y),0),h=void 0===h?h:p(h),v-=b?b.length:0,64&t){var x=g,k=b;g=b=void 0}var S=E?void 0:l(e),j=[e,t,a,g,b,x,k,f,y,h];if(S&&c(j,S),e=j[0],t=j[1],a=j[2],g=j[3],b=j[4],!(h=j[9]=void 0===j[9]?E?0:e.length:m(j[9]-v,0))&&24&t&&(t&=-25),t&&1!=t)O=8==t||16==t?r(e,t,h):32!=t&&33!=t||b.length?s.apply(void 0,j):o(e,t,a,g);else var O=i(e,t,a);return d((S?n:u)(O,j),e,t)}},function(e,t,a){e.exports=a(27)(3416)},function(e,t,a){e.exports=a(27)(336)},function(e,t,a){var n=a(330),i=a(333);function r(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}r.prototype=n(i.prototype),r.prototype.constructor=r,e.exports=r},function(e,t){e.exports=function(){}},function(e,t,a){e.exports=a(27)(257)},function(e,t,a){e.exports=a(27)(3406)},function(e,t,a){e.exports=a(27)(1503)},function(e,t){var a="__lodash_placeholder__";e.exports=function(e,t){for(var n=-1,i=e.length,r=0,s=[];++n<i;){var o=e[n];o!==t&&o!==a||(e[n]=a,s[r++]=n)}return s}},function(e,t,a){"use strict";a.d(t,"a",(function(){return u})),a.d(t,"b",(function(){return d}));var n=a(39),i=a(4),r=a(1),s=a(457),o=a(138),l=a(353);const c=["GET",r.pb],u=(e,t)=>Object(n.useQuery)([...c,e],(async({signal:t})=>{const a=await Object(o.e)({signal:t,id:e});return Object(s.a)(a)}),{...l.a,...t}),d=()=>{const e=Object(n.useQueryClient)();return Object(i.useCallback)((()=>{e.invalidateQueries(c,{refetchType:"active"})}),[e])}},function(e,t,a){"use strict";a.d(t,"D",(function(){return i})),a.d(t,"E",(function(){return r})),a.d(t,"H",(function(){return s})),a.d(t,"G",(function(){return o})),a.d(t,"B",(function(){return l})),a.d(t,"I",(function(){return c})),a.d(t,"C",(function(){return u})),a.d(t,"F",(function(){return d})),a.d(t,"a",(function(){return p})),a.d(t,"c",(function(){return m})),a.d(t,"b",(function(){return g})),a.d(t,"d",(function(){return b})),a.d(t,"e",(function(){return f})),a.d(t,"M",(function(){return y})),a.d(t,"A",(function(){return h})),a.d(t,"m",(function(){return E})),a.d(t,"J",(function(){return v})),a.d(t,"j",(function(){return x})),a.d(t,"p",(function(){return k})),a.d(t,"q",(function(){return S})),a.d(t,"y",(function(){return j})),a.d(t,"x",(function(){return O})),a.d(t,"w",(function(){return w})),a.d(t,"z",(function(){return T})),a.d(t,"u",(function(){return I})),a.d(t,"s",(function(){return C})),a.d(t,"t",(function(){return M})),a.d(t,"v",(function(){return F})),a.d(t,"r",(function(){return D})),a.d(t,"N",(function(){return A})),a.d(t,"l",(function(){return _})),a.d(t,"K",(function(){return N})),a.d(t,"g",(function(){return R})),a.d(t,"i",(function(){return P})),a.d(t,"f",(function(){return L})),a.d(t,"h",(function(){return B})),a.d(t,"k",(function(){return q})),a.d(t,"n",(function(){return z})),a.d(t,"L",(function(){return $})),a.d(t,"o",(function(){return V}));var n=a(0);const i=n.i18n.translate("xpack.securitySolution.detectionResponse.alertsByStatus.donut.criticalLabel",{defaultMessage:"Critical"}),r=n.i18n.translate("xpack.securitySolution.detectionResponse.alertsByStatus.donut.highLabel",{defaultMessage:"High"}),s=n.i18n.translate("xpack.securitySolution.detectionResponse.alertsByStatus.donut.mediumLabel",{defaultMessage:"Medium"}),o=n.i18n.translate("xpack.securitySolution.detectionResponse.alertsByStatus.donut.lowLabel",{defaultMessage:"Low"}),l=n.i18n.translate("xpack.securitySolution.detectionResponse.alertsByStatus.status.acknowledged",{defaultMessage:"Acknowledged"}),c=n.i18n.translate("xpack.securitySolution.detectionResponse.status.open",{defaultMessage:"Open"}),u=n.i18n.translate("xpack.securitySolution.detectionResponse.status.closed",{defaultMessage:"Closed"}),d=n.i18n.translate("xpack.securitySolution.detectionResponse.status.inProgress",{defaultMessage:"In progress"}),p=e=>n.i18n.translate("xpack.securitySolution.detectionResponse.alertsByStatus.totalAlerts",{values:{totalAlerts:e},defaultMessage:"total {totalAlerts, plural, =1 {alert} other {alerts}}"}),m=n.i18n.translate("xpack.securitySolution.detectionResponse.alerts",{defaultMessage:"Alerts"}),g=n.i18n.translate("xpack.securitySolution.detectionResponse.alertsBySeverity",{defaultMessage:"Alerts by Severity"}),b=(n.i18n.translate("xpack.securitySolution.detectionResponse.updating",{defaultMessage:"Updating..."}),n.i18n.translate("xpack.securitySolution.detectionResponse.updated",{defaultMessage:"Updated"}),e=>n.i18n.translate("xpack.securitySolution.detectionResponse.casesByStatus.totalCases",{values:{totalCases:e},defaultMessage:"total {totalCases, plural, =1 {case} other {cases}}"})),f=n.i18n.translate("xpack.securitySolution.detectionResponse.casesByStatusSectionTitle",{defaultMessage:"Cases"}),y=n.i18n.translate("xpack.securitySolution.detectionResponse.viewCases",{defaultMessage:"View cases"}),h=n.i18n.translate("xpack.securitySolution.detectionResponse.ruleAlertsSectionTitle",{defaultMessage:"Open alerts by rule"}),E=n.i18n.translate("xpack.securitySolution.detectionResponse.hostAlertsSectionTitle",{defaultMessage:"Hosts by alert severity"}),v=n.i18n.translate("xpack.securitySolution.detectionResponse.userAlertsSectionTitle",{defaultMessage:"Users by alert severity"}),x=n.i18n.translate("xpack.securitySolution.detectionResponse.caseSectionTitle",{defaultMessage:"Recently created cases"}),k=n.i18n.translate("xpack.securitySolution.detectionResponse.noRuleAlerts",{defaultMessage:"No alerts to display"}),S=n.i18n.translate("xpack.securitySolution.detectionResponse.noRecentCases",{defaultMessage:"No cases to display"}),j=n.i18n.translate("xpack.securitySolution.detectionResponse.ruleAlertsColumnRuleName",{defaultMessage:"Rule name"}),O=n.i18n.translate("xpack.securitySolution.detectionResponse.ruleAlertsColumnLastAlert",{defaultMessage:"Last alert"}),w=n.i18n.translate("xpack.securitySolution.detectionResponse.ruleAlertsColumnAlertCount",{defaultMessage:"Alert count"}),T=n.i18n.translate("xpack.securitySolution.detectionResponse.ruleAlertsColumnSeverity",{defaultMessage:"Severity"}),I=n.i18n.translate("xpack.securitySolution.detectionResponse.openRuleDetailTooltip",{defaultMessage:"Open rule detail"}),C=n.i18n.translate("xpack.securitySolution.detectionResponse.openCaseDetailTooltip",{defaultMessage:"Open case detail"}),M=n.i18n.translate("xpack.securitySolution.detectionResponse.openHostDetailTooltip",{defaultMessage:"Open host detail"}),F=n.i18n.translate("xpack.securitySolution.detectionResponse.openUserDetailTooltip",{defaultMessage:"Open user detail"}),D=n.i18n.translate("xpack.securitySolution.detectionResponse.openAllAlertsButton",{defaultMessage:"View all open alerts"}),A=n.i18n.translate("xpack.securitySolution.detectionResponse.viewRecentCases",{defaultMessage:"View recent cases"}),_=n.i18n.translate("xpack.securitySolution.detectionResponse.hostAlertsHostName",{defaultMessage:"Host name"}),N=n.i18n.translate("xpack.securitySolution.detectionResponse.userAlertsUserName",{defaultMessage:"User name"}),R=n.i18n.translate("xpack.securitySolution.detectionResponse.caseColumnName",{defaultMessage:"Name"}),P=n.i18n.translate("xpack.securitySolution.detectionResponse.caseColumnTime",{defaultMessage:"Time"}),L=n.i18n.translate("xpack.securitySolution.detectionResponse.caseColumnCreatedBy",{defaultMessage:"Created by"}),B=n.i18n.translate("xpack.securitySolution.detectionResponse.caseColumnStatus",{defaultMessage:"Status"}),q=n.i18n.translate("xpack.securitySolution.detectionResponse.errorMessage",{defaultMessage:"Error fetching case data"}),z=n.i18n.translate("xpack.securitySolution.detectionResponse.hostSectionTooltip",{defaultMessage:"Maximum of 100 hosts. Please consult Alerts page for further information."}),$=n.i18n.translate("xpack.securitySolution.detectionResponse.userSectionTooltip",{defaultMessage:"Maximum of 100 users. Please consult Alerts page for further information."}),V=n.i18n.translate("xpack.securitySolution.detectionResponse.investigateInTimeline",{defaultMessage:"Investigate in Timeline"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return s})),a.d(t,"d",(function(){return o})),a.d(t,"e",(function(){return l})),a.d(t,"g",(function(){return c})),a.d(t,"h",(function(){return u})),a.d(t,"i",(function(){return d})),a.d(t,"j",(function(){return p})),a.d(t,"f",(function(){return m}));var n=a(0);const i=n.i18n.translate("xpack.securitySolution.timeline.categoryTooltip",{defaultMessage:"Category"}),r=n.i18n.translate("xpack.securitySolution.timeline.descriptionTooltip",{defaultMessage:"Description"}),s=n.i18n.translate("xpack.securitySolution.timeline.fieldTooltip",{defaultMessage:"Field"}),o=n.i18n.translate("xpack.securitySolution.timeline.fullScreenButton",{defaultMessage:"Full screen"}),l=n.i18n.translate("xpack.securitySolution.timeline.hideColumnLabel",{defaultMessage:"Hide column"}),c=n.i18n.translate("xpack.securitySolution.timeline.sortAZLabel",{defaultMessage:"Sort A-Z"}),u=n.i18n.translate("xpack.securitySolution.timeline.sortFieldsButton",{defaultMessage:"Sort fields"}),d=n.i18n.translate("xpack.securitySolution.timeline.sortZALabel",{defaultMessage:"Sort Z-A"}),p=n.i18n.translate("xpack.securitySolution.timeline.typeTooltip",{defaultMessage:"Type"}),m=n.i18n.translate("xpack.securitySolution.timeline.flyout.pane.removeColumnButtonLabel",{defaultMessage:"Remove column"})},function(e,t,a){"use strict";function n(e){return`resolver-${e}`}a.d(t,"a",(function(){return n}))},function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"c",(function(){return l})),a.d(t,"d",(function(){return c})),a.d(t,"b",(function(){return u}));var n=a(276),i=a(151),r=a(144);function s(e){return"processTerminated"===function(e){if(i.i(e)){const{endgame:{event_type_full:t,event_subtype_full:a}}=e;if("process_event"===t)return"creation_event"===a||"fork_event"===a||"exec_event"===a?"processCreated":"already_running"===a?"processRan":"termination_event"===a?"processTerminated":"unknownProcessEvent";if("alert_event"===t)return"processCausedAlert"}else{const t=new Set(i.h(e)),a=new Set(i.d(e)),n=new Set(i.f(e));if(a.has("process"))return t.has("start")||t.has("change")||t.has("creation")?"processCreated":t.has("info")?"processRan":t.has("end")?"processTerminated":"unknownProcessEvent";if(n.has("alert"))return"processCausedAlert"}return"unknownEvent"}(e)}function o(e){const t=r.a(e),a=void 0===t?0:new Date(t).getTime();return isNaN(a)?null:a}function l(e){var t;return Object(n.a)(i.i(e)?e.endgame.pid:null===(t=e.process)||void 0===t?void 0:t.pid)}function c(e){var t;return Object(n.a)(i.i(e)?e.endgame.process_path:null===(t=e.process)||void 0===t?void 0:t.executable)}function u(e,t){const a=o(e),n=o(t);return a===n?String(r.b(e)).localeCompare(String(r.b(t))):null===a||null===n?(null===a?1:0)-(null===n?1:0):a-n}},function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(4),i=a.n(n),r=a(35),s=a(32),o=a(164);const l=i.a.memo((()=>i.a.createElement(o.a,null,i.a.createElement(s.EuiPageTemplate_Deprecated,{template:"centeredContent"},i.a.createElement(s.EuiEmptyPrompt,{"data-test-subj":"notFoundPage",iconColor:"default",iconType:"logoElastic",title:i.a.createElement("p",null,i.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.pages.fourohfour.pageNotFoundDescription",defaultMessage:"Page not found"}))})))));l.displayName="NotFoundPage"},function(e,t,a){"use strict";a.d(t,"h",(function(){return ve})),a.d(t,"b",(function(){return xe})),a.d(t,"f",(function(){return ke})),a.d(t,"c",(function(){return Se})),a.d(t,"d",(function(){return je})),a.d(t,"g",(function(){return Oe})),a.d(t,"j",(function(){return we})),a.d(t,"i",(function(){return Te})),a.d(t,"a",(function(){return Ie})),a.d(t,"e",(function(){return Ce})),a.d(t,"k",(function(){return Tt}));var n=a(34),i=a(4),r=a.n(i),s=a(79),o=a(32),l=a(97),c=a(199),u=a(88),d=a(224),p=a(644);const m=r.a.memo((({contextId:e,eventId:t,hostName:a,hostNameSeparator:n="@",isDraggable:i,userDomain:s,userDomainField:o="user.domain",userName:c,userNameField:d="user.name",workingDirectory:m})=>null!=c||null!=s||null!=a||null!=m?r.a.createElement(r.a.Fragment,null,r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:t,field:d,isDraggable:i,value:c,iconType:"user",fieldType:"keyword",isAggregatable:!0})),null!=s&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.c,{"data-test-subj":"user-host-working-dir-domain-separator-text",grow:!1,component:"span"},"\\"),r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:t,field:o,isDraggable:i,value:s,fieldType:"keyword",isAggregatable:!0}))),null!=a&&null!=c&&r.a.createElement(l.c,{grow:!1,component:"span"},n),r.a.createElement(p.a,{contextId:e,eventId:t,hostName:a,isDraggable:i,workingDirectory:m})):null));m.displayName="UserHostWorkingDir";var g=a(0);const b=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.dns.askedForDescription",{defaultMessage:"asked for"}),f=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.dns.responseCodeDescription",{defaultMessage:"response code:"}),y=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.dns.viaDescription",{defaultMessage:"via"}),h=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.dns.whichResolvedToDescription",{defaultMessage:", which resolved to"}),E=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.dns.withQuestionTypeDescription",{defaultMessage:"with question type"}),v=r.a.memo((({contextId:e,dnsQuestionName:t,dnsQuestionType:a,dnsResolvedIp:n,dnsResponseCode:i,eventCode:s,hostName:c,id:p,isDraggable:g,processExecutable:v,processName:x,processPid:k,userDomain:S,userName:j,winlogEventId:O})=>r.a.createElement(r.a.Fragment,null,r.a.createElement(o.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none",wrap:!0},r.a.createElement(m,{contextId:e,eventId:p,hostName:c,isDraggable:g,userDomain:S,userName:j,workingDirectory:void 0}),!Object(l.e)(t)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.c,{component:"span","data-test-subj":"asked-for",grow:!1},b),r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(u.c,{contextId:e,eventId:p,field:"dns.question.name",isDraggable:g,value:t,isAggregatable:!0,fieldType:"keyword"}))),!Object(l.e)(a)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.c,{component:"span","data-test-subj":"with-question-type",grow:!1},E),r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(u.c,{contextId:e,eventId:p,field:"dns.question.type",isDraggable:g,value:a,isAggregatable:!0,fieldType:"keyword"}))),!Object(l.e)(n)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.c,{component:"span","data-test-subj":"which-resolved-to",grow:!1},h),r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(u.c,{contextId:e,eventId:p,field:"dns.resolved_ip",isDraggable:g,value:n,isAggregatable:!0,fieldType:"ip"}))),!Object(l.e)(i)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.c,{component:"span",grow:!1},"("),r.a.createElement(l.c,{component:"span","data-test-subj":"response-code",grow:!1},f),r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(u.c,{contextId:e,eventId:p,field:"dns.response_code",isDraggable:g,value:i,isAggregatable:!0,fieldType:"keyword"})),r.a.createElement(l.c,{component:"span",grow:!1},")")),r.a.createElement(l.c,{component:"span",grow:!1},y),r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(d.b,{contextId:e,endgamePid:void 0,endgameProcessName:void 0,eventId:p,isDraggable:g,processPid:k,processName:x,processExecutable:v})),(!Object(l.e)(s)||!Object(l.e)(O))&&r.a.createElement(r.a.Fragment,null,Object(l.e)(s)?r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(u.c,{contextId:e,eventId:p,iconType:"logoWindows",field:"winlog.event_id",isDraggable:g,value:O,isAggregatable:!0,fieldType:"keyword"})):r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(u.c,{contextId:e,eventId:p,field:"event.code",isDraggable:g,value:s,isAggregatable:!0,fieldType:"number"})))))));v.displayName="DnsRequestEventDetailsLine";const x=r.a.memo((({data:e,contextId:t,isDraggable:a,timelineId:i})=>{const s=Object(n.get)("dns.question.name[0]",e),u=Object(n.get)("dns.question.type[0]",e),d=Object(n.get)("dns.resolved_ip[0]",e),p=Object(n.get)("dns.response_code[0]",e),m=Object(n.get)("event.code[0]",e),g=Object(n.get)("host.name[0]",e),b=e._id,f=Object(n.get)("process.executable[0]",e),y=Object(n.get)("process.name[0]",e),h=Object(n.get)("process.pid[0]",e),E=Object(n.get)("user.domain[0]",e),x=Object(n.get)("user.name[0]",e),k=Object(n.get)("winlog.event_id[0]",e);return r.a.createElement(l.b,null,r.a.createElement(v,{contextId:t,dnsQuestionName:s,dnsQuestionType:u,dnsResolvedIp:d,dnsResponseCode:p,eventCode:m,hostName:g,id:b,isDraggable:a,processExecutable:f,processName:y,processPid:h,userDomain:E,userName:x,winlogEventId:k}),r.a.createElement(o.EuiSpacer,{size:"s"}),r.a.createElement(c.a,{data:e,isDraggable:a,timelineId:i}))}));x.displayName="DnsRequestEventDetails";const k=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.aLoginWasAttemptedUsingExplicitCredentialsDescription",{defaultMessage:"A login was attempted using explicit credentials"}),S=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.asRequestedBySubjectDescription",{defaultMessage:"as requested by subject"}),j=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.endpoint.failedToLogInDescription",{defaultMessage:"failed to log in"}),O=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.endpoint.failedToLogOffDescription",{defaultMessage:"failed to log off"}),w=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.loggedOffDescription",{defaultMessage:"logged off"}),T=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeBatchDescription",{defaultMessage:"Batch"}),I=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeCachedInteractiveDescription",{defaultMessage:"Cached Interactive"}),C=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeInteractiveDescription",{defaultMessage:"Interactive"}),M=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeNetworkDescription",{defaultMessage:"Network"}),F=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeNetworkCleartextDescription",{defaultMessage:"Network Cleartext"}),D=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeNewCredentialsDescription",{defaultMessage:"New Credentials"}),A=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeRemoteInteractiveDescription",{defaultMessage:"Remote Interactive"}),_=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeServiceDescription",{defaultMessage:"Service"}),N=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeUnlockDescription",{defaultMessage:"Unlock"}),R=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.subjectLogonIdDescription",{defaultMessage:"subject logon ID"}),P=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.successfullyLoggedInDescription",{defaultMessage:"successfully logged in"}),L=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.targetLogonIdDescription",{defaultMessage:"target logon ID"}),B=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.toDescription",{defaultMessage:"to"}),q=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.usingLogonTypeDescription",{defaultMessage:"using logon type"}),z=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.viaDescription",{defaultMessage:"via"}),$=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.withSpecialPrivilegesDescription",{defaultMessage:"With special privileges,"}),V=e=>{if(Object(l.e)(e))return"";switch(e){case 2:return C;case 3:return M;case 4:return T;case 5:return _;case 7:return N;case 8:return F;case 9:return D;case 10:return A;case 11:return I;default:return`${e}`}},U=e=>"explicit_user_logon"===e||"user_logoff"===e,H=r.a.memo((({contextId:e,endgameLogonType:t,endgameSubjectDomainName:a,endgameSubjectLogonId:n,endgameSubjectUserName:i,endgameTargetDomainName:s,endgameTargetLogonId:c,endgameTargetUserName:p,eventAction:g,eventCode:b,eventOutcome:f,hostName:y,id:h,isDraggable:E,processExecutable:v,processName:x,processPid:T,userDomain:I,userName:C,winlogEventId:M})=>{const F=U(g)?s:I,D=(({eventAction:e,eventOutcome:t})=>{switch(e){case"explicit_user_logon":return"";case"log_off":case"user_logoff":return"failure"===(null==t?void 0:t.toLowerCase())?O:w;default:return"failure"===(null==t?void 0:t.toLowerCase())?j:P}})({eventAction:g,eventOutcome:f}),A=(e=>"explicit_user_logon"===e?B:"@")(g),_=U(g)?p:C,N=(e=>U(e)?"endgame.target_domain_name":"user.domain")(g),H=(e=>U(e)?"endgame.target_user_name":"user.name")(g);return r.a.createElement(r.a.Fragment,null,r.a.createElement(o.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none",wrap:!0},"admin_logon"===g&&r.a.createElement(l.c,{component:"span","data-test-subj":"with-special-privileges",grow:!1},$),"explicit_user_logon"===g&&r.a.createElement(l.c,{component:"span","data-test-subj":"a-login-was-attempted",grow:!1},k),r.a.createElement(m,{contextId:e,eventId:h,hostName:y,hostNameSeparator:A,isDraggable:E,userDomain:F,userDomainField:N,userName:_,userNameField:H,workingDirectory:void 0}),r.a.createElement(l.c,{component:"span","data-test-subj":"event-details",grow:!1},D),!Object(l.e)(t)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.c,{component:"span","data-test-subj":"using-logon-type",grow:!1},q),r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(u.c,{contextId:e,eventId:h,field:"endgame.logon_type",isDraggable:E,queryValue:String(t),value:`${t} - ${V(t)}`,isAggregatable:!0,fieldType:"keyword"}))),!Object(l.e)(c)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.c,{component:"span",grow:!1},"("),r.a.createElement(l.c,{component:"span","data-test-subj":"using-logon-type",grow:!1},L),r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(u.c,{contextId:e,eventId:h,field:"endgame.target_logon_id",isDraggable:E,value:c,isAggregatable:!0,fieldType:"keyword"})),r.a.createElement(l.c,{component:"span",grow:!1},")")),r.a.createElement(l.c,{component:"span",grow:!1},z),r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(d.b,{contextId:e,endgamePid:void 0,endgameProcessName:void 0,eventId:h,isDraggable:E,processPid:T,processName:x,processExecutable:v})),!Object(l.e)(i)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.c,{component:"span","data-test-subj":"as-requested-by-subject",grow:!1},S),r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(u.c,{contextId:e,eventId:h,field:"endgame.subject_user_name",isDraggable:E,iconType:"user",value:i,isAggregatable:!0,fieldType:"keyword"}))),null!=a&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.c,{component:"span","data-test-subj":"subject-domain-name-domain-separator-text",grow:!1},"\\"),r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(u.c,{contextId:e,eventId:h,field:"endgame.subject_domain_name",isDraggable:E,value:a,isAggregatable:!0,fieldType:"keyword"}))),!Object(l.e)(n)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.c,{component:"span",grow:!1},"("),r.a.createElement(l.c,{component:"span","data-test-subj":"subject-login-id",grow:!1},R),r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(u.c,{contextId:e,eventId:h,field:"endgame.subject_logon_id",isDraggable:E,value:n,isAggregatable:!0,fieldType:"keyword"})),r.a.createElement(l.c,{component:"span",grow:!1},")")),(!Object(l.e)(b)||!Object(l.e)(M))&&r.a.createElement(r.a.Fragment,null,Object(l.e)(b)?r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(u.c,{contextId:e,eventId:h,iconType:"logoWindows",field:"winlog.event_id",value:M,isAggregatable:!0,fieldType:"keyword"})):r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(u.c,{contextId:e,eventId:h,field:"event.code",value:b,isAggregatable:!0,fieldType:"keyword"})))))}));H.displayName="EndgameSecurityEventDetailsLine";const G=r.a.memo((({data:e,contextId:t,isDraggable:a,timelineId:i})=>{const s=Object(n.get)("endgame.logon_type[0]",e),u=Object(n.get)("endgame.subject_domain_name[0]",e),d=Object(n.get)("endgame.subject_logon_id[0]",e),p=Object(n.get)("endgame.subject_user_name[0]",e),m=Object(n.get)("endgame.target_logon_id[0]",e),g=Object(n.get)("endgame.target_domain_name[0]",e),b=Object(n.get)("endgame.target_user_name[0]",e),f=Object(n.get)("event.action[0]",e),y=Object(n.get)("event.code[0]",e),h=Object(n.get)("event.outcome[0]",e),E=Object(n.get)("host.name[0]",e),v=e._id,x=Object(n.get)("process.executable[0]",e),k=Object(n.get)("process.name[0]",e),S=Object(n.get)("process.pid[0]",e),j=Object(n.get)("user.domain[0]",e),O=Object(n.get)("user.name[0]",e),w=Object(n.get)("winlog.event_id[0]",e);return r.a.createElement(l.b,null,r.a.createElement(H,{contextId:t,endgameLogonType:s,endgameSubjectDomainName:u,endgameSubjectLogonId:d,endgameSubjectUserName:p,endgameTargetDomainName:g,endgameTargetLogonId:m,endgameTargetUserName:b,eventAction:f,eventCode:y,eventOutcome:h,hostName:E,id:v,isDraggable:a,processExecutable:x,processName:k,processPid:S,userDomain:j,userName:O,winlogEventId:w}),r.a.createElement(o.EuiSpacer,{size:"s"}),r.a.createElement(c.a,{data:e,timelineId:i}))}));G.displayName="EndgameSecurityEventDetails";const Q=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.registry.viaDescription",{defaultMessage:"via"}),W=g.i18n.translate("xpack.securitySolution.timeline.body.renderers.registry.withNewValueDescription",{defaultMessage:"with new value"}),K=({contextId:e,hostName:t,id:a,isDraggable:n,processName:s,processPid:c,registryKey:p,registryPath:g,text:b,userDomain:f,userName:y})=>{const h=Object(i.useMemo)((()=>r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,"registry.key"),r.a.createElement("div",null,p))),[p]),E=Object(i.useMemo)((()=>r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,"registry.path"),r.a.createElement("div",null,g))),[g]);return Object(l.e)(p)?null:r.a.createElement(r.a.Fragment,null,r.a.createElement(o.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none",wrap:!0},r.a.createElement(m,{contextId:e,eventId:a,hostName:t,isDraggable:n,userDomain:f,userName:y,workingDirectory:void 0}),!Object(l.e)(p)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.c,{component:"span","data-test-subj":"text",grow:!1},b),r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(u.c,{contextId:e,eventId:a,field:"registry.key",isDraggable:n,tooltipContent:h,value:p,isAggregatable:!0,fieldType:"keyword"}))),!Object(l.e)(g)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.c,{component:"span","data-test-subj":"with-new-value",grow:!1},W),r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(u.c,{contextId:e,eventId:a,field:"registry.path",isDraggable:n,tooltipContent:E,value:g,isAggregatable:!0,fieldType:"keyword"}))),r.a.createElement(l.c,{component:"span",grow:!1},Q),r.a.createElement(l.c,{component:"span",grow:!1},r.a.createElement(d.b,{contextId:e,endgamePid:void 0,endgameProcessName:void 0,eventId:a,isDraggable:n,processPid:c,processName:s,processExecutable:void 0}))))},Y=r.a.memo(K),J=({contextId:e,data:t,isDraggable:a,text:i})=>{const s=Object(n.get)("host.name[0]",t),o=t._id,c=Object(n.get)("process.name[0]",t),u=Object(n.get)("process.pid[0]",t),d=Object(n.get)("registry.key[0]",t),p=Object(n.get)("registry.path[0]",t),m=Object(n.get)("user.domain[0]",t),g=Object(n.get)("user.name[0]",t);return Object(l.e)(d)?null:r.a.createElement(l.b,null,r.a.createElement(Y,{contextId:e,hostName:s,id:o,isDraggable:a,processName:c,processPid:u,registryKey:d,registryPath:p,text:i,userDomain:m,userName:g}))};J.displayName="RegistryEventDetailsComponent";const X=r.a.memo(J);var Z=a(223),ee=a(181),te=a(278);const ae=r.a.memo((({contextId:e,eventId:t,isDraggable:a,packageName:n,packageSummary:i,packageVersion:s})=>null!=n||null!=i||null!=s?r.a.createElement(r.a.Fragment,null,r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:t,field:"system.audit.package.name",isDraggable:a,value:n,iconType:"document",isAggregatable:!0,fieldType:"keyword"})),r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:t,field:"system.audit.package.version",isDraggable:a,value:s,iconType:"document",isAggregatable:!0,fieldType:"keyword"})),r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:t,field:"system.audit.package.summary",isDraggable:a,value:i,isAggregatable:!0,fieldType:"keyword"}))):null));ae.displayName="Package";const ne=r.a.memo((({contextId:e,eventId:t,isDraggable:a,sshSignature:n,sshMethod:i})=>r.a.createElement(r.a.Fragment,null,null!=n&&r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:t,field:"system.audit.package.name",isDraggable:a,value:n,iconType:"document",isAggregatable:!0,fieldType:"keyword"})),null!=i&&r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:t,field:"system.audit.package.version",isDraggable:a,value:i,iconType:"document",isAggregatable:!0,fieldType:"keyword"})))));ne.displayName="AuthSsh";var ie=a(160);const re=r.a.memo((({contextId:e,hostName:t,id:a,isDraggable:n,message:i,outcome:s,packageName:c,packageSummary:p,packageVersion:g,processPid:b,processName:f,processExecutable:y,sshSignature:h,sshMethod:E,text:v,userDomain:x,userName:k,workingDirectory:S})=>r.a.createElement(r.a.Fragment,null,r.a.createElement(o.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none",wrap:!0},r.a.createElement(m,{contextId:e,eventId:a,hostName:t,isDraggable:n,userDomain:x,userName:k,workingDirectory:S}),r.a.createElement(l.c,{grow:!1,component:"span"},v),r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(d.a,{contextId:e,endgamePid:void 0,endgameProcessName:void 0,eventId:a,isDraggable:n,processPid:b,processName:f,processExecutable:y})),null!=s&&r.a.createElement(l.c,{grow:!1,component:"span"},te.W),r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:a,field:"event.outcome",isDraggable:n,queryValue:s,value:s,isAggregatable:!0,fieldType:"keyword"})),r.a.createElement(ne,{contextId:e,eventId:a,isDraggable:n,sshSignature:h,sshMethod:E}),r.a.createElement(ae,{contextId:e,eventId:a,isDraggable:n,packageName:c,packageSummary:p,packageVersion:g})),null!=i&&r.a.createElement(r.a.Fragment,null,r.a.createElement(o.EuiSpacer,{size:"xs"}),r.a.createElement(o.EuiFlexGroup,{justifyContent:"center",gutterSize:"none",wrap:!0},r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(ie.b,{iconType:"editorComment",color:"hollow",title:""},r.a.createElement(ee.a,{value:i}))))))));re.displayName="SystemGenericLine";const se=r.a.memo((({contextId:e,data:t,isDraggable:a,text:i,timelineId:s})=>{const u=t._id,d=null!=t.message?t.message[0]:null,p=Object(n.get)("host.name[0]",t),m=Object(n.get)("user.domain[0]",t),g=Object(n.get)("user.name[0]",t),b=Object(n.get)("event.outcome[0]",t),f=Object(n.get)("system.audit.package.name[0]",t),y=Object(n.get)("system.audit.package.summary[0]",t),h=Object(n.get)("system.audit.package.version[0]",t),E=Object(n.get)("process.pid[0]",t),v=Object(n.get)("process.name[0]",t),x=Object(n.get)("process.executable[0]",t),k=Object(n.get)("system.auth.ssh.signature[0]",t),S=Object(n.get)("system.auth.ssh.method[0]",t),j=Object(n.get)("process.working_directory[0]",t);return r.a.createElement(l.b,null,r.a.createElement(re,{contextId:e,hostName:p,id:u,isDraggable:a,message:d,outcome:b,packageName:f,packageSummary:y,packageVersion:h,processExecutable:x,processPid:E,processName:v,sshMethod:S,sshSignature:k,text:i,userDomain:m,userName:g,workingDirectory:j}),r.a.createElement(o.EuiSpacer,{size:"s"}),r.a.createElement(c.a,{data:t,isDraggable:a,timelineId:s}))}));se.displayName="SystemGenericDetails";var oe=a(477);const le=r.a.memo((({contextId:e,endgameExitCode:t,eventId:a,isDraggable:n,processExitCode:i,text:s})=>Object(l.e)(i)&&Object(l.e)(t)?null:r.a.createElement(r.a.Fragment,null,!Object(l.e)(s)&&r.a.createElement(l.c,{"data-test-subj":"exit-code-draggable-text",grow:!1,component:"span"},s),!Object(l.e)(i)&&r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:a,field:"process.exit_code",isDraggable:n,value:`${i}`,fieldType:"number",isAggregatable:!0})),!Object(l.e)(t)&&r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:a,field:"endgame.exit_code",isDraggable:n,value:t,fieldType:"number",isAggregatable:!0})))));le.displayName="ExitCodeDraggable";var ce=a(260);const ue=r.a.memo((({contextId:e,endgameFileName:t,endgameFilePath:a,eventId:n,fileExtOriginalPath:i,fileName:s,filePath:o,isDraggable:c})=>{if(Object(l.e)(s)&&Object(l.e)(t)&&Object(l.e)(o)&&Object(l.e)(a))return null;const d=!Object(l.e)(o)||!Object(l.e)(a);return r.a.createElement(r.a.Fragment,null,Object(l.e)(s)?Object(l.e)(t)?null:r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:n,field:"endgame.file_name",isDraggable:c,value:t,iconType:"document",isAggregatable:!0,fieldType:"keyword"})):r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:n,field:"file.name",isDraggable:c,value:s,iconType:"document",isAggregatable:!0,fieldType:"keyword"})),d&&r.a.createElement(l.c,{"data-test-subj":"in",grow:!1,component:"span"},ce.d),Object(l.e)(o)?Object(l.e)(a)?null:r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:n,field:"endgame.file_path",isDraggable:c,value:a,iconType:"document",isAggregatable:!0,fieldType:"keyword"})):r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:n,field:"file.path",isDraggable:c,value:o,iconType:"document",isAggregatable:!0,fieldType:"keyword"})),!Object(l.e)(i)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.c,{grow:!1,component:"span"},ce.c),r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:n,field:"file.Ext.original.path",isDraggable:c,value:i,iconType:"document",isAggregatable:!0,fieldType:"keyword"}))))}));ue.displayName="FileDraggable";var de=a(33),pe=a.n(de);const me=pe()(o.EuiFlexGroup).withConfig({displayName:"HashFlexGroup",componentId:"sc-dv64zz-0"})(["margin:",";"],(({theme:e})=>e.eui.euiSizeXS)),ge=r.a.memo((({contextId:e,eventId:t,fileHashSha256:a,isDraggable:n})=>Object(l.e)(a)?null:r.a.createElement(me,{alignItems:"center",direction:"column",gutterSize:"none"},r.a.createElement(l.c,{grow:!1,component:"div"},r.a.createElement(u.c,{contextId:e,eventId:t,field:"file.hash.sha256",isDraggable:n,iconType:"number",value:a,isAggregatable:!0,fieldType:"keyword"})))));ge.displayName="FileHash";const be=r.a.memo((({contextId:e,endgameParentProcessName:t,eventId:a,isDraggable:n,processParentName:i,processParentPid:s,processPpid:o,text:c})=>Object(l.e)(i)&&Object(l.e)(t)?null:r.a.createElement(r.a.Fragment,null,!Object(l.e)(c)&&r.a.createElement(l.c,{"data-test-subj":"parent-process-draggable-text",grow:!1,component:"span"},c),!Object(l.e)(i)&&r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:a,field:"process.parent.name",isDraggable:n,value:i,fieldType:"keyword",isAggregatable:!0})),!Object(l.e)(t)&&r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:a,field:"endgame.parent_process_name",isDraggable:n,value:t,fieldType:"keyword",isAggregatable:!0})),!Object(l.e)(s)&&r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:a,field:"process.parent.pid",isDraggable:n,queryValue:String(s),value:`(${String(s)})`,fieldType:"keyword",isAggregatable:!0})),!Object(l.e)(o)&&r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:e,eventId:a,field:"process.ppid",isDraggable:n,queryValue:String(o),value:`(${String(o)})`,fieldType:"keyword",isAggregatable:!0})))));be.displayName="ParentProcessDraggable";const fe=pe()(o.EuiFlexGroup).withConfig({displayName:"HashFlexGroup",componentId:"sc-1qc8g7c-0"})(["margin:",";"],(({theme:e})=>e.eui.euiSizeXS)),ye=r.a.memo((({contextId:e,eventId:t,isDraggable:a,processHashSha256:n})=>Object(l.e)(n)?null:r.a.createElement(fe,{alignItems:"center",direction:"column",gutterSize:"none"},r.a.createElement(l.c,{grow:!1,component:"div"},r.a.createElement(u.c,{contextId:e,eventId:t,field:"process.hash.sha256",iconType:"number",isDraggable:a,value:n,fieldType:"keyword",isAggregatable:!0})))));ye.displayName="ProcessHash";const he=r.a.memo((({args:e,contextId:t,endgameExitCode:a,endgameFileName:n,endgameFilePath:i,endgameParentProcessName:s,endgamePid:c,endgameProcessName:p,eventAction:g,fileExtOriginalPath:b,fileHashSha256:f,fileName:y,filePath:h,hostName:E,id:v,isDraggable:x,message:k,outcome:S,packageName:j,processParentName:O,processParentPid:w,processExitCode:T,packageSummary:I,packageVersion:C,processExecutable:M,processHashSha256:F,processName:D,processPid:A,processPpid:_,processTitle:N,showMessage:R,skipRedundantFileDetails:P=!1,skipRedundantProcessDetails:L=!1,sshSignature:B,sshMethod:q,text:z,userDomain:$,userName:V,workingDirectory:U})=>r.a.createElement(r.a.Fragment,null,r.a.createElement(o.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none",wrap:!0},r.a.createElement(m,{eventId:v,contextId:t,isDraggable:x,userDomain:$,userName:V,workingDirectory:U,hostName:E}),r.a.createElement(l.c,{grow:!1,component:"span"},z),!P&&r.a.createElement(ue,{contextId:t,endgameFileName:n,endgameFilePath:i,eventId:v,fileExtOriginalPath:b,fileName:y,filePath:h,isDraggable:x}),Object(l.g)(g)&&r.a.createElement(l.c,{"data-test-subj":"via",grow:!1,component:"span"},te.L),r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(d.b,{contextId:t,endgamePid:c,endgameProcessName:p,eventId:v,isDraggable:x,processPid:A,processName:D,processExecutable:M})),r.a.createElement(oe.a,{args:e,contextId:t,eventId:v,processTitle:N,isDraggable:x}),r.a.createElement(le,{contextId:t,endgameExitCode:a,eventId:v,isDraggable:x,processExitCode:T,text:te.V}),!Object(l.f)(g)&&r.a.createElement(be,{contextId:t,endgameParentProcessName:s,eventId:v,isDraggable:x,processParentName:O,processParentPid:w,processPpid:_,text:te.M}),null!=S&&r.a.createElement(l.c,{grow:!1,component:"span"},te.W),r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(u.c,{contextId:t,eventId:v,field:"event.outcome",isDraggable:x,queryValue:S,value:S,isAggregatable:!0,fieldType:"keyword"})),r.a.createElement(ne,{contextId:t,eventId:v,isDraggable:x,sshSignature:B,sshMethod:q}),r.a.createElement(ae,{contextId:t,eventId:v,isDraggable:x,packageName:j,packageSummary:I,packageVersion:C})),!P&&r.a.createElement(ge,{contextId:t,eventId:v,fileHashSha256:f,isDraggable:x}),!L&&r.a.createElement(ye,{contextId:t,eventId:v,isDraggable:x,processHashSha256:F}),null!=k&&R&&r.a.createElement(r.a.Fragment,null,r.a.createElement(o.EuiSpacer,{size:"xs"}),r.a.createElement(o.EuiFlexGroup,{justifyContent:"center",gutterSize:"none",wrap:!0},r.a.createElement(l.c,{grow:!1,component:"span"},r.a.createElement(ie.b,{iconType:"editorComment",color:"hollow",title:""},r.a.createElement(ee.a,{value:k}))))))));he.displayName="SystemGenericFileLine";const Ee=r.a.memo((({contextId:e,data:t,isDraggable:a,showMessage:i=!0,skipRedundantFileDetails:s=!1,skipRedundantProcessDetails:u=!1,text:d,timelineId:p})=>{const m=t._id,g=null!=t.message?t.message[0]:null,b=Object(n.get)("host.name[0]",t),f=Object(n.get)("endgame.exit_code[0]",t),y=Object(n.get)("endgame.file_name[0]",t),h=Object(n.get)("endgame.file_path[0]",t),E=Object(n.get)("endgame.parent_process_name[0]",t),v=Object(n.get)("endgame.pid[0]",t),x=Object(n.get)("endgame.process_name[0]",t),k=Object(n.get)("event.action[0]",t),S=Object(n.get)("file.Ext.original.path[0]",t),j=Object(n.get)("file.hash.sha256[0]",t),O=Object(n.get)("file.name[0]",t),w=Object(n.get)("file.path[0]",t),T=Object(n.get)("user.domain[0]",t),I=Object(n.get)("user.name[0]",t),C=Object(n.get)("event.outcome[0]",t),M=Object(n.get)("system.audit.package.name[0]",t),F=Object(n.get)("system.audit.package.summary[0]",t),D=Object(n.get)("system.audit.package.version[0]",t),A=Object(n.get)("process.exit_code[0]",t),_=Object(n.get)("process.parent.name[0]",t),N=Object(n.get)("process.parent.pid[0]",t),R=Object(n.get)("process.hash.sha256[0]",t),P=Object(n.get)("process.pid[0]",t),L=Object(n.get)("process.ppid[0]",t),B=Object(n.get)("process.name[0]",t),q=Object(n.get)("system.auth.ssh.signature[0]",t),z=Object(n.get)("system.auth.ssh.method[0]",t),$=Object(n.get)("process.executable[0]",t),V=Object(n.get)("process.title[0]",t),U=Object(n.get)("process.working_directory[0]",t),H=Object(n.get)("process.args",t);return r.a.createElement(l.b,null,r.a.createElement(he,{id:m,contextId:e,text:d,hostName:b,endgameExitCode:f,endgameFileName:y,endgameFilePath:h,endgameParentProcessName:E,endgamePid:v,endgameProcessName:x,eventAction:k,fileExtOriginalPath:S,fileHashSha256:j,fileName:O,filePath:w,userDomain:T,userName:I,message:g,processExitCode:A,processParentName:_,processParentPid:N,processTitle:V,workingDirectory:U,args:H,packageName:M,packageSummary:F,packageVersion:D,processHashSha256:R,processName:B,processPid:P,processPpid:L,processExecutable:$,showMessage:i,skipRedundantFileDetails:s,skipRedundantProcessDetails:u,sshSignature:q,sshMethod:z,outcome:C,isDraggable:a}),r.a.createElement(o.EuiSpacer,{size:"s"}),r.a.createElement(c.a,{data:t,isDraggable:a,timelineId:p}))}));Ee.displayName="SystemGenericFileDetails";const ve=({actionName:e,text:t})=>({id:s.d.system,isInstance:t=>{const a=Object(n.get)("event.module[0]",t),i=Object(n.get)("event.action[0]",t);return null!=a&&"system"===a.toLowerCase()&&null!=i&&i.toLowerCase()===e},renderRow:({data:a,isDraggable:n,scopeId:i})=>r.a.createElement(Z.a,null,r.a.createElement(se,{contextId:`${e}-${i}`,data:a,isDraggable:n,text:t,timelineId:i}))}),xe=({actionName:e,text:t})=>({id:s.d.system_file,isInstance:t=>{const a=Object(n.get)("event.action[0]",t),i=Object(n.get)("event.category[0]",t),r=Object(n.get)("event.dataset[0]",t);return("process"===(null==i?void 0:i.toLowerCase())||"endpoint.events.process"===(null==r?void 0:r.toLowerCase()))&&(null==a?void 0:a.toLowerCase())===e},renderRow:({data:a,isDraggable:n,scopeId:i})=>r.a.createElement(Z.a,null,r.a.createElement(Ee,{data:a,contextId:`endgame-process-${e}-${i}`,isDraggable:n,showMessage:!1,text:t,timelineId:i}))}),ke=({actionName:e,text:t})=>({id:s.d.system_fim,isInstance:t=>{const a=Object(n.get)("event.action[0]",t),i=Object(n.get)("event.category[0]",t),r=Object(n.get)("event.dataset[0]",t);return Object(l.d)({eventCategory:i,eventDataset:r})&&(null==a?void 0:a.toLowerCase())===e},renderRow:({data:a,isDraggable:n,scopeId:i})=>r.a.createElement(Z.a,null,r.a.createElement(Ee,{data:a,contextId:`fim-${e}-${i}`,isDraggable:n,showMessage:!1,text:t,timelineId:i}))}),Se=({eventAction:e,eventCategory:t,eventType:a,skipRedundantFileDetails:i=!1,skipRedundantProcessDetails:o=!1,text:l})=>({id:s.d.alerts,isInstance:i=>{var r,s,o;const l=Object(n.get)("event.action",i),c=Object(n.get)("event.category",i),u=Object(n.get)("event.dataset[0]",i),d=Object(n.get)("event.type",i),p=null!==(r=null==l?void 0:l.includes(e))&&void 0!==r&&r,m=null!==(s=null==c?void 0:c.includes(t))&&void 0!==s&&s,g=null!==(o=null==d?void 0:d.includes(a))&&void 0!==o&&o;return"endpoint.alerts"===(null==u?void 0:u.toLowerCase())&&g&&m&&p},renderRow:({data:n,isDraggable:s,scopeId:c})=>r.a.createElement(Z.a,null,r.a.createElement(Ee,{contextId:`endpoint-alerts-row-renderer-${e}-${t}-${a}-${c}`,data:n,isDraggable:s,showMessage:!1,skipRedundantFileDetails:i,skipRedundantProcessDetails:o,text:l,timelineId:c}))}),je=({actionName:e,text:t})=>({id:s.d.library,isInstance:t=>{const a=Object(n.get)("event.action[0]",t),i=Object(n.get)("event.dataset[0]",t);return"endpoint.events.library"===(null==i?void 0:i.toLowerCase())&&(null==a?void 0:a.toLowerCase())===e},renderRow:({data:a,isDraggable:n,scopeId:i})=>r.a.createElement(Z.a,null,r.a.createElement(Ee,{contextId:`library-row-renderer-${e}-${i}`,data:a,isDraggable:n,showMessage:!1,text:t,timelineId:i}))}),Oe=({actionName:e,text:t})=>({id:s.d.system_file,isInstance:t=>{const a=Object(n.get)("event.module[0]",t),i=Object(n.get)("event.action[0]",t);return null!=a&&"system"===a.toLowerCase()&&null!=i&&i.toLowerCase()===e},renderRow:({data:a,isDraggable:n,scopeId:i})=>r.a.createElement(Z.a,null,r.a.createElement(Ee,{contextId:`${e}-${i}`,data:a,isDraggable:n,text:t,timelineId:i}))}),we=({actionName:e,text:t})=>({id:s.d.system_socket,isInstance:t=>{const a=Object(n.get)("event.action[0]",t);return null!=a&&a.toLowerCase()===e},renderRow:({data:a,isDraggable:n,scopeId:i})=>r.a.createElement(Z.a,null,r.a.createElement(Ee,{contextId:`socket-${e}-${i}`,data:a,isDraggable:n,text:t,timelineId:i}))}),Te=({actionName:e})=>({id:s.d.system_security_event,isInstance:t=>{const a=Object(n.get)("event.category[0]",t),i=Object(n.get)("event.action[0]",t),r=Object(n.get)("event.dataset[0]",t);return("authentication"===(null==a?void 0:a.toLowerCase())||"endpoint.events.security"===(null==r?void 0:r.toLowerCase()))&&(null==i?void 0:i.toLowerCase())===e},renderRow:({data:t,isDraggable:a,scopeId:n})=>r.a.createElement(Z.a,null,r.a.createElement(G,{contextId:`authentication-${e}-${n}`,data:t,isDraggable:a,timelineId:n}))}),Ie=()=>({id:s.d.system_dns,isInstance:e=>{const t=Object(n.get)("dns.question.type[0]",e),a=Object(n.get)("dns.question.name[0]",e);return!Object(l.e)(t)&&!Object(l.e)(a)},renderRow:({data:e,isDraggable:t,scopeId:a})=>r.a.createElement(Z.a,null,r.a.createElement(x,{contextId:`dns-request-${a}`,data:e,isDraggable:t,timelineId:a}))}),Ce=({actionName:e,text:t})=>({id:s.d.registry,isInstance:t=>{const a=Object(n.get)("event.action[0]",t),i=Object(n.get)("event.dataset[0]",t);return"endpoint.events.registry"===(null==i?void 0:i.toLowerCase())&&(null==a?void 0:a.toLowerCase())===e},renderRow:({data:e,isDraggable:a,scopeId:n})=>r.a.createElement(Z.a,null,r.a.createElement(X,{contextId:`registry-event-${n}`,data:e,isDraggable:a,text:t}))}),Me=ve({actionName:"user_login",text:te.c}),Fe=Oe({actionName:"process_started",text:te.A}),De=xe({actionName:"creation_event",text:te.A}),Ae=xe({actionName:"start",text:te.A}),_e=Ce({actionName:"modification",text:te.u}),Ne=Oe({actionName:"process_stopped",text:te.B}),Re=xe({actionName:"termination_event",text:te.H}),Pe=xe({actionName:"end",text:te.H}),Le=ke({actionName:"file_create_event",text:te.e}),Be=ke({actionName:"creation",text:te.e}),qe=ke({actionName:"created",text:te.e}),ze=ke({actionName:"file_delete_event",text:te.f}),$e=ke({actionName:"deletion",text:te.f}),Ve=ke({actionName:"modification",text:te.t}),Ue=ke({actionName:"overwrite",text:te.v}),He=ke({actionName:"rename",text:te.E}),Ge=ke({actionName:"deleted",text:te.f}),Qe=Oe({actionName:"existing_process",text:te.k}),We=[{eventAction:"creation",eventCategory:"file",eventType:"denied",skipRedundantProcessDetails:!0,text:te.R},{eventAction:"creation",eventCategory:"file",eventType:"allowed",skipRedundantProcessDetails:!0,text:te.N},{eventAction:"files-encrypted",eventCategory:"file",eventType:"denied",skipRedundantFileDetails:!0,text:te.D},{eventAction:"files-encrypted",eventCategory:"file",eventType:"allowed",skipRedundantFileDetails:!0,text:te.C},{eventAction:"modification",eventCategory:"file",eventType:"denied",skipRedundantProcessDetails:!0,text:te.T},{eventAction:"modification",eventCategory:"file",eventType:"allowed",skipRedundantProcessDetails:!0,text:te.P},{eventAction:"rename",eventCategory:"file",eventType:"denied",skipRedundantProcessDetails:!0,text:te.U},{eventAction:"rename",eventCategory:"file",eventType:"allowed",skipRedundantProcessDetails:!0,text:te.Q},{eventAction:"execution",eventCategory:"process",eventType:"denied",skipRedundantFileDetails:!0,text:te.S},{eventAction:"execution",eventCategory:"process",eventType:"allowed",skipRedundantFileDetails:!0,text:te.O}].map((e=>Se(e))),Ke=je({actionName:"load",text:te.q}),Ye=we({actionName:"socket_opened",text:te.G}),Je=we({actionName:"socket_closed",text:te.F}),Xe=we({actionName:"ipv4_connection_accept_event",text:te.b}),Ze=we({actionName:"connection_accepted",text:te.b}),et=we({actionName:"http_request",text:te.s}),tt=xe({actionName:"exec",text:te.i}),at=xe({actionName:"fork",text:te.n}),nt=we({actionName:"ipv6_connection_accept_event",text:te.b}),it=we({actionName:"ipv4_disconnect_received_event",text:te.g}),rt=we({actionName:"disconnect_received",text:te.g}),st=we({actionName:"ipv6_disconnect_received_event",text:te.g}),ot=Te({actionName:"admin_logon"}),lt=Te({actionName:"explicit_user_logon"}),ct=Te({actionName:"user_logoff"}),ut=Te({actionName:"user_logon"}),dt=Te({actionName:"log_on"}),pt=Ie(),mt=ve({actionName:"existing_user",text:te.m}),gt=Oe({actionName:"existing_socket",text:te.l}),bt=ve({actionName:"existing_package",text:te.j}),ft=Oe({actionName:"invalid",text:te.p}),yt=ve({actionName:"user_changed",text:te.J}),ht=ve({actionName:"host",text:te.o}),Et=ve({actionName:"user_added",text:te.I}),vt=ve({actionName:"user_logout",text:te.r}),xt=Te({actionName:"log_off"}),kt=Oe({actionName:"process_error",text:te.z}),St=ve({actionName:"error:",text:te.h}),jt=ve({actionName:"error",text:te.h}),Ot=ve({actionName:"package_installed",text:te.w}),wt=ve({actionName:"boot",text:te.d}),Tt=[pt,ot,lt,Le,Be,ze,$e,Ue,He,...We,Ke,Ve,_e,Xe,Ze,et,tt,at,nt,it,rt,st,De,Ae,Re,Pe,ct,ut,dt,qe,Ge,ve({actionName:"accepted",text:te.a}),wt,jt,St,bt,Qe,gt,mt,ht,ft,Me,vt,xt,Ot,ve({actionName:"package_updated",text:te.y}),ve({actionName:"package_removed",text:te.x}),kt,Fe,Ne,Je,Ye,Et,yt,ve({actionName:"user_removed",text:te.K})]},function(e,t,a){"use strict";a.d(t,"a",(function(){return se}));var n=a(4),i=a.n(n),r=a(33),s=a.n(r),o=a(34),l=a(32),c=a(110),u=a(93),d=a(0);const p=d.i18n.translate("xpack.securitySolution.ruleExceptions.addException.cancel",{defaultMessage:"Cancel"}),m=d.i18n.translate("xpack.securitySolution.ruleExceptions.addException.createRuleExceptionLabel",{defaultMessage:"Add rule exception"}),g=d.i18n.translate("xpack.securitySolution.ruleExceptions.addException.addEndpointException",{defaultMessage:"Add Endpoint Exception"}),b=d.i18n.translate("xpack.securitySolution.ruleExceptions.addException.submitError.title",{defaultMessage:"An error occured submitting exception"}),f=d.i18n.translate("xpack.securitySolution.ruleExceptions.addException.submitError.dismissButton",{defaultMessage:"Dismiss"}),y=d.i18n.translate("xpack.securitySolution.ruleExceptions.addException.submitError.message",{defaultMessage:"View toast for error details."}),h=d.i18n.translate("xpack.securitySolution.ruleExceptions.addException.success",{defaultMessage:"Rule exception added to shared exception list"}),E=d.i18n.translate("xpack.securitySolution.ruleExceptions.addExceptionFlyout.addRuleExceptionToastSuccessTitle",{defaultMessage:"Rule exception added"});var v=a(517),x=a(190);const k={initialItems:[],exceptionItems:[],exceptionItemMeta:{name:""},newComment:"",itemConditionValidationErrorExists:!1,closeSingleAlert:!1,bulkCloseAlerts:!1,disableBulkClose:!1,bulkCloseIndex:void 0,selectedOs:void 0,exceptionListsToAddTo:[],addExceptionToRadioSelection:"add_to_rule",selectedRulesToAddTo:[],listType:u.b.RULE_DEFAULT,errorSubmitting:null};var S=a(717),j=a(718),O=a(656),w=a(711);const T=d.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addExceptionToRuleOrList.addToListsLabel",{defaultMessage:"Add to rule or lists"});var I=a(35),C=a(704);const M=({possibleRules:e,isSingleRule:t,isBulkAction:a,selectedRadioOption:r,onRuleSelectionChange:s,onRadioChange:o})=>{const c=Object(n.useMemo)((()=>a&&null!=e?{id:"add_to_rules",label:i.a.createElement(l.EuiText,{"data-test-subj":"addToRulesRadioOption"},i.a.createElement(I.FormattedMessage,{defaultMessage:"Add to [{numRules}] selected rules: {ruleNames}",id:"xpack.securitySolution.exceptions.common.addToRulesOptionLabel",values:{numRules:e.length,ruleNames:i.a.createElement("span",{style:{fontWeight:"bold"}},e.map((({name:e})=>e)).join(","))}})),checked:"add_to_rules"===r,"data-test-subj":"addToRulesOptionsRadio",onChange:()=>{o("add_to_rules"),s(e)}}:t&&null!=e?{id:"add_to_rule",label:i.a.createElement(l.EuiText,{"data-test-subj":"addToRuleRadioOption"},i.a.createElement(I.FormattedMessage,{defaultMessage:"Add to this rule: {ruleName}",id:"xpack.securitySolution.exceptions.common.addToRuleOptionLabel",values:{ruleName:i.a.createElement("span",{style:{fontWeight:"bold"}},e[0].name)}})),checked:"add_to_rule"===r,"data-test-subj":"addToRuleOptionsRadio",onChange:()=>{o("add_to_rule"),s(e)}}:{id:"select_rules_to_add_to",label:i.a.createElement(l.EuiText,{"data-test-subj":"selectRulesToAddToRadioOption"},i.a.createElement(I.FormattedMessage,{defaultMessage:"Add to rules",id:"xpack.securitySolution.exceptions.common.selectRulesOptionLabel"})),checked:"select_rules_to_add_to"===r,"data-test-subj":"selectRulesToAddToOptionRadio",onChange:()=>o("select_rules_to_add_to")}),[a,e,t,r,o,s]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(l.EuiRadio,c),"select_rules_to_add_to"===r&&i.a.createElement(C.a,{onRuleSelectionChange:s,initiallySelectedRules:[]}))},F=i.a.memo(M);F.displayName="ExceptionsAddToRulesOptions";const D=d.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToListsOptions.addToListsOptionLabel",{defaultMessage:"Add to shared exception lists"}),A=d.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToListsOptions.gotToSharedExceptions",{defaultMessage:"Manage shared exception lists"}),_=d.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToListsOptions.addToListsTooltip",{defaultMessage:"Shared exception list is a group of exceptions. Select this option if you’d like to add this exception to shared exception lists."}),N=e=>d.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToListsOptions.addToListsTooltipTitle",{values:{rulesCount:e},defaultMessage:"Shared exception list is a group of exceptions shared across rules. {rulesCount, plural, =1 {This rule currently has no shared} other {These rules currently have no commonly shared}} exception lists attached. To create one, visit the Shared Exception Lists page."});var R=a(510);const P=d.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToListsTableSelection.addToListsDescription",{defaultMessage:"After you create the exception, it is added to the exception lists you select."}),L=(d.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToListsTableSelection.viewListDetailActionLabel",{defaultMessage:"View list detail"}),d.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToListsTableSelection.referencesFetchError",{defaultMessage:"Unable to load shared exception lists"}));var B=a(479);const q=Object(n.memo)((({list:e,linkedList:t,onListLinkChange:a,dataTestSubj:r})=>{const s=Object(n.useMemo)((()=>Boolean(t.find((t=>t.id===e.id)))),[t,e.id]),o=Object(n.useCallback)((({target:{checked:n}})=>{const i=n?[...t,e]:null==t?void 0:t.filter((t=>t.id!==e.id));"function"==typeof a&&a(i)}),[t,a,e]);return i.a.createElement(l.EuiFlexItem,{grow:!1},i.a.createElement(l.EuiSwitch,{"data-test-subj":r,onChange:o,label:"",checked:s}))}));q.displayName="LinkListSwitch";var z=a(261);const $=({showAllSharedLists:e,sharedExceptionLists:t,onListSelectionChange:a})=>{const{error:r,isLoading:s,pagination:o,lists:c,listTableColumnsWithLinkSwitch:d,onTableChange:p,addToSelectedListDescription:m}=(({showAllSharedLists:e,sharedExceptionLists:t,onListSelectionChange:a})=>{const[r,s]=Object(n.useState)([]),[o,l]=Object(n.useState)(!1),c=Object(n.useMemo)((()=>e?[]:t),[e,t]),[d,p]=Object(n.useState)([]),[m,g]=Object(n.useState)({pageIndex:0,initialPageSize:5,showPerPageOptions:!1}),[b,f]=Object(n.useState)(void 0),y=Object(n.useCallback)((async()=>{try{return l(!0),Object(R.c)(c.length?c:[{namespace_type:"single"}])}catch(e){f(L)}}),[c]),h=Object(n.useCallback)((async()=>{const e=await y();if(!e)return l(!1);const t=[];for(const a of Object.values(e))a.type===u.b.DETECTION&&t.push(a);s(t),l(!1)}),[y]);Object(n.useEffect)((()=>{h()}),[c,y,h]),Object(n.useEffect)((()=>{a(d.map((({referenced_rules:e,namespace_type:t,os_types:a,tags:n,...i})=>({...i,namespace_type:null!=t?t:"single",os_types:null!=a?a:[],tags:null!=n?n:[]}))))}),[d,a]);const E=Object(n.useMemo)((()=>[{field:"link",name:B.a,align:"left","data-test-subj":"ruleActionLinkRuleSwitch",render:(e,t)=>i.a.createElement(q,{dataTestSubj:"addToSharedListSwitch",list:t,linkedList:d,onListLinkChange:p})},...Object(z.d)()]),[d]),v=Object(n.useCallback)((({page:{index:e}})=>g({...m,pageIndex:e})),[m]);return{error:b,isLoading:o,pagination:m,lists:r,listTableColumnsWithLinkSwitch:E,addToSelectedListDescription:P,onTableChange:v}})({showAllSharedLists:e,sharedExceptionLists:t,onListSelectionChange:a});return i.a.createElement(l.EuiPanel,{color:"subdued",borderRadius:"none",hasShadow:!1},i.a.createElement(i.a.Fragment,null,i.a.createElement(l.EuiText,{size:"s"},m),i.a.createElement(l.EuiSpacer,{size:"s"}),i.a.createElement(l.EuiSpacer,{size:"s"}),i.a.createElement(l.EuiInMemoryTable,{sorting:!0,tableLayout:"auto",tableCaption:"Table of exception lists","data-test-subj":"addExceptionToSharedListsTable",error:r,items:c,loading:s,message:s?i.a.createElement(l.EuiLoadingContent,{lines:4,"data-test-subj":"exceptionItemViewerEmptyPrompts-loading"}):void 0,columns:d,pagination:o,onTableChange:p})))},V=i.a.memo($);V.displayName="ExceptionsAddToListsTable";var U=a(77);const H=({rulesCount:e,selectedRadioOption:t,sharedLists:a,onListsSelectionChange:r,onRadioChange:s})=>{const{navigateToApp:o}=Object(U.k)().services.application,[c,u]=Object(n.useState)(!1);return i.a.createElement(i.a.Fragment,null,i.a.createElement(l.EuiRadio,{id:"add_to_lists",label:i.a.createElement(l.EuiFlexGroup,{alignItems:"flexStart",gutterSize:"none",responsive:!1,"data-test-subj":"addToListsRadioOptionLabel"},i.a.createElement(l.EuiFlexItem,{grow:!1},i.a.createElement(l.EuiText,null,D)),i.a.createElement(l.EuiFlexItem,{grow:!1,"data-test-subj":"addToListsOption"},i.a.createElement(l.EuiPopover,{button:i.a.createElement(l.EuiButtonIcon,{iconType:"iInCircle",onClick:()=>u(!c)}),isOpen:c,closePopover:()=>u(!1),anchorPosition:"upCenter"},i.a.createElement("div",{style:{width:"300px"}},i.a.createElement(l.EuiText,{size:"s"},0===a.length?N(e):_)),i.a.createElement(l.EuiPopoverFooter,null,i.a.createElement(l.EuiButtonEmpty,{size:"s",iconType:"popout",iconSide:"right",onClick:()=>o("security",{openInNewTab:!0,path:"/exceptions"})},A))))),checked:"add_to_lists"===t,disabled:0===a.length&&e>0,onChange:()=>s("add_to_lists"),"data-test-subj":"addToListsRadioOption"}),"add_to_lists"===t&&(a.length>0||0===e)&&i.a.createElement(V,{showAllSharedLists:0===e,sharedExceptionLists:a,onListSelectionChange:r,"data-test-subj":"exceptionsAddToListTable"}))},G=i.a.memo(H);G.displayName="ExceptionsAddToListsOptions";const Q=s()(l.EuiTitle).withConfig({displayName:"SectionHeader",componentId:"sc-1kilk4s-0"})(["",""],(()=>Object(r.css)(["font-weight:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold)))),W=({rules:e,isBulkAction:t,selectedRadioOption:a,onListSelectionChange:r,onRuleSelectionChange:s,onRadioChange:o})=>{const c=Object(n.useMemo)((()=>null!=e&&1===e.length),[e]),d=Object(n.useMemo)((()=>{var t,a,n;if(null==e)return[];if(1===e.length)return null!==(t=null===(a=e[0].exceptions_list)||void 0===a?void 0:a.filter((e=>e.type===u.b.DETECTION)))&&void 0!==t?t:[];const i=null!==(n=null==e?void 0:e.map((e=>null!=e.exceptions_list?e.exceptions_list:[])))&&void 0!==n?n:[];i.sort(((e,t)=>e.length-t.length));const r=i.shift();return null!=r&&r.length?r.filter((e=>i.every((t=>t.some((({id:t})=>e.id===t)))))).filter((e=>e.type===u.b.DETECTION)):[]}),[e]),p=Object(n.useMemo)((()=>null!=e?e.length:0),[e]);return i.a.createElement(l.EuiPanel,{paddingSize:"none",hasShadow:!1,"data-test-subj":"exceptionItemAddToRuleOrListSection"},i.a.createElement(Q,{size:"xs"},i.a.createElement("h3",null,T)),i.a.createElement(l.EuiSpacer,{size:"s"}),i.a.createElement(F,{possibleRules:e,isSingleRule:c,isBulkAction:t,selectedRadioOption:a,onRuleSelectionChange:s,onRadioChange:o}),i.a.createElement(G,{rulesCount:p,selectedRadioOption:a,sharedLists:d,onListsSelectionChange:r,onRadioChange:o}))},K=i.a.memo(W);K.displayName="ExceptionsAddToRulesOrLists";var Y=a(84),J=a(658),X=a(138);var Z=a(712);const ee=["query","machine_learning","saved_query","threat_match"];var te=a(338);const ae=s()(l.EuiTitle).withConfig({displayName:"SectionHeader",componentId:"sc-sl27gk-0"})(["",""],(()=>Object(r.css)(["font-weight:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold)))),ne=s()(l.EuiFlyoutBody).withConfig({displayName:"FlyoutBodySection",componentId:"sc-sl27gk-1"})(["",""],(()=>Object(r.css)(["&.builder-section{overflow-y:scroll;}"]))),ie=s()(l.EuiFlyoutHeader).withConfig({displayName:"FlyoutHeader",componentId:"sc-sl27gk-2"})(["",""],(({theme:e})=>Object(r.css)(["border-bottom:1px solid ",";"],e.eui.euiColorLightShade))),re=s()(l.EuiFlexGroup).withConfig({displayName:"FlyoutFooterGroup",componentId:"sc-sl27gk-3"})(["",""],(({theme:e})=>Object(r.css)(["padding:",";"],e.eui.euiSizeS))),se=Object(n.memo)((function({rules:e,isBulkAction:t,isEndpointItem:a,alertData:r,showAlertCloseOptions:s,isAlertDataLoading:T,alertStatus:I,sharedListToAddTo:C,onCancel:M,onConfirm:F,isNonTimeline:D=!1}){const{isLoading:A,indexPatterns:_}=Object(O.a)(e),[N,R]=(()=>{const{addSuccess:e,addError:t,addWarning:a}=Object(Y.a)(),[i,r]=(()=>{const[e,t]=Object(n.useState)(!1),a=Object(n.useRef)(null);return Object(n.useEffect)((()=>{const e=new AbortController;return a.current=async(a,n)=>{t(!0);const i=await Promise.all(n.map((async t=>Object(X.a)({items:a,ruleId:t.id,signal:e.signal}))));return t(!1),i.flatMap((e=>e))},()=>{t(!1),e.abort()}}),[]),[e,a.current]})(),[s,o]=Object(J.a)(),[l,c]=Object(n.useState)(!1),p=Object(n.useRef)(null),m=Object(n.useCallback)((e=>e.every((e=>u.i.is(e)))),[]),g=Object(n.useCallback)((e=>e.every((e=>u.n.is(e)||u.h.is(e)))),[]);return Object(n.useEffect)((()=>{const a=new AbortController;return p.current=async({itemsToAdd:a,listType:n,selectedRulesToAddTo:i,addToRules:s,addToSharedLists:l,sharedLists:p})=>{try{let t=[];if(c(!0),s&&null!=r&&n!==u.b.ENDPOINT&&m(a)){t=await r(a,i);const n=i.map((({name:e})=>e)).join(", ");e({title:E,text:(y=n,d.i18n.translate("xpack.securitySolution.ruleExceptions.addExceptionFlyout.addRuleExceptionToastSuccessText",{values:{ruleName:y},defaultMessage:"Exception has been added to rules - {ruleName}."}))})}else if((n===u.b.ENDPOINT||l)&&null!=o&&g(a)){t=await o(a);const n=p.map((({name:e})=>e));e({title:h,text:(f=n.join(","),d.i18n.translate("xpack.securitySolution.ruleExceptions.addExceptionFlyout.closeAlerts.successDetails",{values:{listNames:f},defaultMessage:"Rule exception has been added to shared lists: {listNames}."}))})}return c(!1),t}catch(e){throw c(!1),t(e,{title:b}),e}var f,y},()=>{a.abort()}}),[e,t,a,r,o,m,g]),[l||s||i,p.current]})(),[P,L]=Object(Z.a)(),B=Object(te.b)(),q=Object(n.useMemo)((()=>null==e||1!==e.length||ee.includes(e[0].type)),[e]),$=Object(n.useMemo)((()=>a?u.b.ENDPOINT:C?u.b.DETECTION:u.b.RULE_DEFAULT),[a,C]),[{exceptionItemMeta:{name:V},listType:U,selectedOs:H,initialItems:G,exceptionItems:Q,disableBulkClose:W,bulkCloseAlerts:se,closeSingleAlert:oe,bulkCloseIndex:le,addExceptionToRadioSelection:ce,selectedRulesToAddTo:ue,exceptionListsToAddTo:de,newComment:pe,itemConditionValidationErrorExists:me,errorSubmitting:ge},be]=Object(n.useReducer)(((e,t)=>{switch(t.type){case"setExceptionItemMeta":{const{value:a}=t;return{...e,exceptionItemMeta:{...e.exceptionItemMeta,[a[0]]:a[1]}}}case"setInitialExceptionItems":{const{items:a}=t;return{...e,initialItems:a}}case"setExceptionItems":{const{items:a}=t;return{...e,exceptionItems:a}}case"setConditionValidationErrorExists":{const{errorExists:a}=t;return{...e,itemConditionValidationErrorExists:a}}case"setComment":{const{comment:a}=t;return{...e,newComment:a}}case"setCloseSingleAlert":{const{close:a}=t;return{...e,closeSingleAlert:a}}case"setBulkCloseAlerts":{const{bulkClose:a}=t;return{...e,bulkCloseAlerts:a}}case"setBulkCloseIndex":{const{bulkCloseIndex:a}=t;return{...e,bulkCloseIndex:a}}case"setSelectedOsOptions":{const{selectedOs:a}=t;return{...e,selectedOs:a}}case"setAddExceptionToLists":{const{listsToAddTo:a}=t;return{...e,exceptionListsToAddTo:a}}case"setListOrRuleRadioOption":{const{option:a}=t;return{...e,addExceptionToRadioSelection:a,listType:"add_to_lists"===a?u.b.DETECTION:u.b.RULE_DEFAULT,selectedRulesToAddTo:"add_to_lists"===a?[]:e.selectedRulesToAddTo}}case"setSelectedRulesToAddTo":{const{rules:a}=t;return{...e,selectedRulesToAddTo:a}}case"setListType":{const{listType:a}=t;return{...e,listType:a}}case"setDisableBulkCloseAlerts":{const{disableBulkCloseAlerts:a}=t;return{...e,disableBulkClose:a}}case"setErrorSubmitting":{const{err:a}=t;return{...e,errorSubmitting:a}}default:return e}}),{...k,addExceptionToRadioSelection:t?"add_to_rules":null!=e&&1===e.length?"add_to_rule":"select_rules_to_add_to",listType:$,selectedRulesToAddTo:null!=e?e:[]}),fe=Object(n.useMemo)((()=>null!=r),[r]),ye=Object(n.useCallback)((e=>{be({type:"setInitialExceptionItems",items:e})}),[be]),he=Object(n.useCallback)((e=>{be({type:"setExceptionItems",items:e})}),[be]),Ee=Object(n.useCallback)((e=>{be({type:"setListOrRuleRadioOption",option:e})}),[be]),ve=Object(n.useCallback)((e=>{be({type:"setSelectedRulesToAddTo",rules:e})}),[be]),xe=Object(n.useCallback)((e=>{be({type:"setAddExceptionToLists",listsToAddTo:e})}),[be]),ke=Object(n.useCallback)((e=>{be({type:"setExceptionItemMeta",value:e})}),[be]),Se=Object(n.useCallback)((e=>{be({type:"setConditionValidationErrorExists",errorExists:e})}),[be]),je=Object(n.useCallback)((e=>{be({type:"setSelectedOsOptions",selectedOs:e})}),[be]),Oe=Object(n.useCallback)((e=>{be({type:"setComment",comment:e})}),[be]),we=Object(n.useCallback)((e=>{be({type:"setBulkCloseIndex",bulkCloseIndex:e})}),[be]),Te=Object(n.useCallback)((e=>{be({type:"setCloseSingleAlert",close:e})}),[be]),Ie=Object(n.useCallback)((e=>{be({type:"setBulkCloseAlerts",bulkClose:e})}),[be]),Ce=Object(n.useCallback)((e=>{be({type:"setDisableBulkCloseAlerts",disableBulkCloseAlerts:e})}),[be]),Me=Object(n.useCallback)((e=>{be({type:"setErrorSubmitting",err:e})}),[be]);Object(n.useEffect)((()=>{U===u.b.ENDPOINT&&null!=r&&ye(Object(x.b)(c.j,V,r))}),[U,V,r,ye]);const Fe=Object(n.useMemo)((()=>fe?Object(x.m)(r):H?[...H]:[]),[fe,r,H]),De=Object(n.useCallback)((async()=>{if(null!=R)try{const t=["add_to_rule","add_to_rules","select_rules_to_add_to"].includes(ce),a=!(null==C||!C.length)||"add_to_lists"===ce&&!Object(o.isEmpty)(de),n=null!=C&&C.length?C:de,i=Object(z.b)({itemName:V,commentToAdd:pe,addToRules:t,addToSharedLists:a,sharedLists:n,listType:U,selectedOs:Fe,items:Q}),s=await R({itemsToAdd:i,selectedRulesToAddTo:ue,listType:U,addToRules:t&&!Object(o.isEmpty)(ue),addToSharedLists:a,sharedLists:n}),l=oe&&r?r._id:void 0,c=t?ue.map((({rule_id:e})=>e)):(null!=e?e:[]).map((({rule_id:e})=>e));null==L||Object(o.isEmpty)(c)||!se&&!oe||await L(c,s,l,le),B(),F(!0,oe,se)}catch(e){Me(e)}}),[C,R,ce,V,pe,de,U,Fe,Q,ue,oe,r,e,L,se,F,le,Me,B]),Ae=Object(n.useMemo)((()=>N||P||null!=ge||""===V.trim()||Q.every((e=>0===e.entries.length))||me||"add_to_lists"===ce&&Object(o.isEmpty)(de)),[N,P,ge,V,Q,me,ce,de]),_e=Object(n.useCallback)((()=>{Me(null)}),[Me]),Ne=Object(n.useCallback)((()=>{M(!1)}),[M]),Re=Object(n.useMemo)((()=>U===u.b.ENDPOINT?g:m),[U]);return i.a.createElement(l.EuiFlyout,{ownFocus:!0,maskProps:{style:!1===D?"z-index: 5000":"z-index: 1000"},size:"l",onClose:Ne,"data-test-subj":"addExceptionFlyout"},i.a.createElement(ie,null,i.a.createElement(l.EuiTitle,null,i.a.createElement("h2",{"data-test-subj":"exceptionFlyoutTitle"},Re)),i.a.createElement(l.EuiSpacer,{size:"m"})),A&&i.a.createElement(l.EuiLoadingContent,{"data-test-subj":"loadingAddExceptionFlyout",lines:4}),!A&&i.a.createElement(ne,{className:"builder-section"},null!=ge&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.EuiCallOut,{title:b,color:"danger",iconType:"alert"},i.a.createElement(l.EuiText,null,y),i.a.createElement(l.EuiSpacer,{size:"s"}),i.a.createElement(l.EuiButton,{color:"danger",onClick:_e},f)),i.a.createElement(l.EuiSpacer,{size:"s"})),i.a.createElement(S.a,{exceptionItemName:V,onChange:ke}),i.a.createElement(l.EuiHorizontalRule,null),i.a.createElement(j.a,{exceptionItemName:V,allowLargeValueLists:q,exceptionListItems:G,exceptionListType:U,indexPatterns:_,rules:e,selectedOs:H,showOsTypeOptions:U===u.b.ENDPOINT&&!fe,isEdit:!1,onOsChange:je,onExceptionItemAdd:he,onSetErrorExists:Se,onFilterIndexPatterns:x.h}),U!==u.b.ENDPOINT&&!(null!=C&&C.length)&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.EuiHorizontalRule,null),i.a.createElement(K,{rules:e,isBulkAction:t,selectedRadioOption:ce,onListSelectionChange:xe,onRuleSelectionChange:ve,onRadioChange:Ee})),i.a.createElement(l.EuiHorizontalRule,null),i.a.createElement(v.a,{accordionTitle:i.a.createElement(ae,{size:"xs"},i.a.createElement("h3",null,(0,d.i18n.translate("xpack.securitySolution.ruleExceptions.addExceptionFlyout.commentsTitle",{values:{comments:0},defaultMessage:"Add comments ({comments})"})))),newCommentValue:pe,newCommentOnChange:Oe}),s&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.EuiHorizontalRule,null),i.a.createElement(w.a,{exceptionListType:U,shouldCloseSingleAlert:oe,shouldBulkCloseAlert:se,disableBulkClose:W,exceptionListItems:Q,alertData:r,alertStatus:I,isAlertDataLoading:null!=T&&T,onDisableBulkClose:Ce,onUpdateBulkCloseIndex:we,onBulkCloseCheckboxChange:Ie,onSingleAlertCloseCheckboxChange:Te}))),i.a.createElement(l.EuiFlyoutFooter,null,i.a.createElement(re,{justifyContent:"spaceBetween"},i.a.createElement(l.EuiButtonEmpty,{"data-test-subj":"cancelExceptionAddButton",onClick:Ne},p),i.a.createElement(l.EuiButton,{"data-test-subj":"addExceptionConfirmButton",onClick:De,isDisabled:Ae,fill:!0},Re))))}))},function(e,t,a){"use strict";a.d(t,"d",(function(){return p})),a.d(t,"b",(function(){return g})),a.d(t,"f",(function(){return b})),a.d(t,"a",(function(){return f})),a.d(t,"h",(function(){return y})),a.d(t,"c",(function(){return h})),a.d(t,"e",(function(){return E})),a.d(t,"g",(function(){return v}));var n=a(108),i=a(820),r=a(464),s=a(162);function o([e,t,a,n,i,r,s,o,l],[c,u,d,p,m,g,b,f,y]){return[e*c+t*p+a*b,e*u+t*m+a*f,e*d+t*g+a*y,n*c+i*p+r*b,n*u+i*m+r*f,n*d+i*g+r*y,s*c+o*p+l*b,s*u+o*m+l*f,s*d+o*g+l*y]}function l([e,t,a,n,i,r,s,o,l],[c,u,d,p,m,g,b,f,y]){return[e+c,t+u,a+d,n+p,i+m,r+g,s+b,o+f,l+y]}function c([e,t]){return[e,0,0,0,t,0,0,0,0]}var u=a(275);function d(e,t){return e.startTime+e.duration>=t}const p=Object(n.createSelector)((e=>e.scalingFactor),(e=>e.animation),((e,t)=>{const a=(o=e,Object(r.b)(u.b,u.a,Math.pow(o,u.f)));var o;if(void 0!==t){const e=s.d(t.targetTranslation,t.initialTranslation),o=e*a/t.duration,l=.4,c=.4,p=o<l?o:o**c-(l**c-l),m=Object(r.a)(p*t.duration/e,u.b,u.a);return Object(n.defaultMemoize)((e=>{if(!1===d(t,e))return[a,a];{const n=x(t,e),s=i.easing.inOutCubic(1-Math.abs(2*n-1)),o=Object(r.b)(a,m,s);return[o,o]}}))}return Object(n.defaultMemoize)((()=>[a,a]))})),m=Object(n.createSelector)((e=>e.rasterSize),p,((e,t)=>Object(n.defaultMemoize)((a=>{const[n,i]=t(a),r=e[0],s=e[1],o=r/2/n,l=s/2/i;return{renderWidth:r,renderHeight:s,clippingPlaneRight:o,clippingPlaneTop:l,clippingPlaneLeft:-o,clippingPlaneBottom:-l}})))),g=Object(n.createSelector)((e=>e.animation),(e=>t=>void 0!==e&&d(e,t))),b=Object(n.createSelector)((e=>e.panning),(e=>e.translationNotCountingCurrentPanning),p,(e=>e.animation),((e,t,a,r)=>Object(n.defaultMemoize)((n=>{const[o,l]=a(n);if(void 0!==r&&d(r,n))return s.g(r.initialTranslation,r.targetTranslation,i.easing.inOutCubic(x(r,n)));if(e){const a=s.j(e.currentOffset,e.origin),n=s.e(a,[-o,l]);return s.a(t,n)}return t})))),f=Object(n.createSelector)(m,b,((e,t)=>Object(n.defaultMemoize)((a=>{const{renderWidth:n,renderHeight:i,clippingPlaneRight:r,clippingPlaneTop:s,clippingPlaneLeft:u,clippingPlaneBottom:d}=e(a),p=[0===n?0:2/n,0,-1,0,0===i?0:2/i,-1,0,0,0],m=c([1,-1]),[g,b]=t(a);return l([0,0,g,0,0,b,0,0,0],o(function(e,t,a,n){let i,r,s,o;return t-n==0?(i=0,r=0):(i=(t-n)/2,r=(t+n)/(t-n)),e-a==0?(s=0,o=0):(s=(e-a)/2,o=(e+a)/(e-a)),[i,0,r,0,s,o,0,0,0]}(s,r,d,u),o(m,p)))})))),y=Object(n.createSelector)(m,f,((e,t)=>Object(n.defaultMemoize)((a=>{const{renderWidth:n,renderHeight:i}=e(a),r=t(a),o=[0,i],l=[n,0];return{minimum:s.c(o,r),maximum:s.c(l,r)}})))),h=Object(n.createSelector)(m,b,((e,t)=>Object(n.defaultMemoize)((a=>{const{renderWidth:n,renderHeight:i,clippingPlaneRight:r,clippingPlaneTop:u,clippingPlaneLeft:d,clippingPlaneBottom:p}=e(a),m=function([e,t]){return[1,0,e,0,1,t,0,0,0]}(s.i(t(a),-1)),g=function(e,t,a,n){let i,r,s,o;return t-n==0?(i=0,r=0):(i=2/(t-n),r=-(t+n)/(t-n)),e-a==0?(s=0,o=0):(s=e-a==0?0:2/(e-a),o=e-a==0?0:-(e+a)/(e-a)),[i,0,r,0,s,o,0,0,0]}(u,r,p,d),b=c([1,-1]);return o(c([n/2,i/2]),l([0,0,1,0,0,1,0,0,0],o(b,o(g,m))))})))),E=e=>e.scalingFactor,v=e=>void 0!==e.panning;function x(e,t){return Object(r.a)((t-e.startTime)/e.duration,0,1)}},function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(54);function i(e){return function(t){for(const a of e)if(a(t))return!0;return!1}}function r(e){return function(t){if("object"!=typeof t||null===t)return!1;const a=t;for(const t of Object.keys(e))if(!(0,e[t])(a[t]))return!1;return!0}}function s(e){return function(t){return e===t}}const o=i([r({panelView:s("nodes")}),r({panelView:s("nodeDetail"),panelParameters:r({nodeID:function(e){return"string"==typeof e}})}),r({panelView:s("nodeEvents"),panelParameters:r({nodeID:function(e){return"string"==typeof e}})}),r({panelView:s("nodeEventsInCategory"),panelParameters:r({nodeID:function(e){return"string"==typeof e},eventCategory:function(e){return"string"==typeof e}})}),r({panelView:s("eventDetail"),panelParameters:r({nodeID:function(e){return"string"==typeof e},eventCategory:function(e){return"string"==typeof e},eventID:i([function(e){return"string"==typeof e},s(void 0),function(e){return"number"==typeof e}]),eventTimestamp:function(e){return"string"==typeof e},winlogRecordID:function(e){return"string"==typeof e}})})]);var l=a(341);function c({locationSearch:e,resolverComponentInstanceID:t}){if(void 0===e||void 0===t)return{panelView:"nodes"};const a=new URLSearchParams(e).get(Object(l.a)(t));if(null===a)return{panelView:"nodes"};const i=Object(n.decode)(a);return o(i)?i:{panelView:"nodes"}}},,function(e,t,a){"use strict";e.exports=a(725)},function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return s}));var n=a(34);const i=(e,t)=>e?`(${t.map((t=>`exception-list-agnostic.attributes.${t}:(*${e.trim().replace(/([\)\(\<\>\}\{\"\:\\])/gm,"\\$&").replace(/\s/gm,"*")}*)`)).join(" OR ")})`:"",r=e=>"global"===e?'exception-list-agnostic.attributes.tags:"policy:all"':"unassigned"===e?"(not exception-list-agnostic.attributes.tags:*)":`exception-list-agnostic.attributes.tags:"policy:${e}"`,s=({policies:e=[],excludedPolicies:t=[],kuery:a})=>{if(0===(null==e?void 0:e.length)&&0===(null==t?void 0:t.length))return a||void 0;const i=((e,t=[])=>{if(Object(n.isEmpty)(e)&&Object(n.isEmpty)(t))return"";const a=e.map(r).join(" OR "),i=t.map((e=>`not ${r(e)}`)).join(" AND "),s=[];return a&&s.push(a),i&&s.push(i),`(${s.join(" AND ")})`})(e,t);return`(${i})${a?` AND (${a})`:""}`}},,function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return l}));var n=a(34),i=a(4),r=a(298),s=a(1);const o=e=>{const t=Object(n.some)({category:"kibana",field:"kibana.alert.rule.uuid"},e),a=Object(i.useMemo)((()=>Object(r.a)({category:"kibana",field:"kibana.alert.rule.name"},e)),[e]),s=Object(i.useMemo)((()=>Object(r.a)({category:"_id",field:"_id"},e)),[e]),o=Object(i.useMemo)((()=>Object(r.a)({category:"agent",field:"agent.id"},e)),[e]),l=Object(i.useMemo)((()=>Object(r.a)({category:"host",field:"host.name"},e)),[e]),c=Object(i.useMemo)((()=>Object(r.a)({category:"user",field:"user.name"},e)),[e]),u=Object(i.useMemo)((()=>Object(r.a)({category:"base",field:"@timestamp"},e)),[e]);return Object(i.useMemo)((()=>({alertId:s,agentId:o,isAlert:t,hostName:l,userName:c,ruleName:a,timestamp:u,data:e})),[o,s,l,t,a,u,c,e])},l=(e,t="default")=>e.startsWith(`.internal${s.J}`)?`${s.J}-${t}`:e.startsWith(`.internal${s.ab}`)?`${s.ab}-${t}`:void 0},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n={refetchIntervalInBackground:!1,staleTime:3e5}},function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(32),i=a(4),r=a.n(i),s=a(160);const o=({dataTestSubj:e,descriptionList:t})=>r.a.createElement(n.EuiFlexItem,{grow:!0},r.a.createElement(s.d,{"data-test-subj":e,listItems:t}))},function(e,t,a){"use strict";a.r(t),a.d(t,"updateNetworkTable",(function(){return r})),a.d(t,"setNetworkDetailsTablesActivePageToZero",(function(){return s})),a.d(t,"setNetworkTablesActivePageToZero",(function(){return o})),a.d(t,"updateNetworkAnomaliesJobIdFilter",(function(){return l})),a.d(t,"updateNetworkAnomaliesInterval",(function(){return c}));var n=a(16);const i=a.n(n)()("x-pack/security_solution/local/network"),r=i("UPDATE_NETWORK_TABLE"),s=i("SET_IP_DETAILS_TABLES_ACTIVE_PAGE_TO_ZERO"),o=i("SET_NETWORK_TABLES_ACTIVE_PAGE_TO_ZERO"),l=i("UPDATE_NETWORK_ANOMALIES_JOB_ID_FILTER"),c=i("UPDATE_NETWORK_ANOMALIES_INTERVAL")},function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(4),i=a.n(n),r=a(585),s=a(594),o=a(256),l=a(462);const c=i.a.memo((({applyWidthAndPadding:e=!0,contextId:t,data:a,eventId:c,fieldFromBrowserField:u,getLinkValue:d,linkValue:p,onFilterAdded:m,setIsPopoverVisible:g,scopeId:b,toggleColumn:f,values:y,hideAddToTimeline:h})=>{var E;const v=Object(o.b)({contextId:t,eventId:c,field:a.field,fieldFormat:a.format,fieldFromBrowserField:u,fieldType:a.type,isObjectArray:a.isObjectArray,linkValue:null!==(E=d&&d(a.field))&&void 0!==E?E:p,values:y}),{closeTopN:x,toggleTopN:k,isShowingTopN:S}=Object(l.b)(g),{aggregatable:j,type:O}=u||{aggregatable:!1,type:""},{timelineId:w}=Object(n.useContext)(r.b);return i.a.createElement(s.a,{applyWidthAndPadding:e,closeTopN:x,dataType:a.type,dataProvider:null==v?void 0:v.dataProviders,enableOverflowButton:!0,field:a.field,isAggregatable:j,fieldType:O,hideAddToTimeline:h,isObjectArray:a.isObjectArray,onFilterAdded:m,ownFocus:!1,showTopN:S,scopeId:null!=b?b:w,toggleColumn:f,toggleTopN:k,values:null==v?void 0:v.values})}));c.displayName="ActionCell"},function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(4),i=a.n(n),r=a(85),s=a(601),o=a(639),l=a(872);const c=({riskScoreEntity:e,title:t})=>i.a.createElement(i.a.Fragment,null,null!=t?t:e===r.v.user?o.e:o.b,i.a.createElement(s.a,{text:l.d,className:"eui-alignMiddle"})),u=i.a.memo(c);u.displayName="RiskScoreHeaderTitle"},function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(4),i=a(77);const r=()=>{const{spaces:e}=Object(i.k)().services,[t,a]=Object(n.useState)();return Object(n.useEffect)((()=>{e&&e.getActiveSpace().then((e=>a(e.id)))}),[e]),t}},function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return r})),a.d(t,"d",(function(){return s})),a.d(t,"e",(function(){return o})),a.d(t,"f",(function(){return l}));const n="network.bytes",i="network.community_id",r="network.direction",s="network.packets",o="network.protocol",l="network.transport"},function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"d",(function(){return r})),a.d(t,"a",(function(){return s})),a.d(t,"c",(function(){return o}));var n=a(0);const i=n.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.isolateHost",{defaultMessage:"Isolate host"}),r=n.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.unisolateHost",{defaultMessage:"Release host"}),s=e=>n.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.isolateHost.casesAssociatedWithAlert",{defaultMessage:"{caseCount} {caseCount, plural, one {case} other {cases}} associated with this host",values:{caseCount:e}}),o=n.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.returnToAlertDetails",{defaultMessage:"Return to alert details"})},function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"d",(function(){return r})),a.d(t,"a",(function(){return s})),a.d(t,"g",(function(){return o})),a.d(t,"f",(function(){return l})),a.d(t,"h",(function(){return c})),a.d(t,"e",(function(){return u})),a.d(t,"c",(function(){return d}));var n=a(0);const i=n.i18n.translate("xpack.securitySolution.exceptions.commentEventLabel",{defaultMessage:"added a comment"}),r=n.i18n.translate("xpack.securitySolution.exceptions.operatingSystemFullLabel",{defaultMessage:"Operating System"}),s=(n.i18n.translate("xpack.securitySolution.exceptions.viewer.addToEndpointListLabel",{defaultMessage:"Add endpoint exception"}),n.i18n.translate("xpack.securitySolution.exceptions.viewer.addToDetectionsListLabel",{defaultMessage:"Add rule exception"}),n.i18n.translate("xpack.securitySolution.exceptions.viewer.addCommentPlaceholder",{defaultMessage:"Add a new comment..."}),n.i18n.translate("xpack.securitySolution.exceptions.viewer.addToClipboard",{defaultMessage:"Comment"})),o=(n.i18n.translate("xpack.securitySolution.exceptions.clearExceptionsLabel",{defaultMessage:"Remove Exception List"}),n.i18n.translate("xpack.securitySolution.exceptions.fetchError",{defaultMessage:"Error fetching exception list"}),n.i18n.translate("xpack.securitySolution.exceptions.errorLabel",{defaultMessage:"Error"}),n.i18n.translate("xpack.securitySolution.exceptions.cancelLabel",{defaultMessage:"Cancel"}),n.i18n.translate("xpack.securitySolution.exceptions.modalErrorAccordionText",{defaultMessage:"Show rule reference information:"}),n.i18n.translate("xpack.securitySolution.exceptions.disassociateExceptionListError",{defaultMessage:"Failed to remove exception list"}),n.i18n.translate("xpack.securitySolution.exceptions.operatingSystemWindows",{defaultMessage:"Windows"})),l=n.i18n.translate("xpack.securitySolution.exceptions.operatingSystemMac",{defaultMessage:"macOS"}),c=n.i18n.translate("xpack.securitySolution.exceptions.operatingSystemWindowsAndMac",{defaultMessage:"Windows and macOS"}),u=n.i18n.translate("xpack.securitySolution.exceptions.operatingSystemLinux",{defaultMessage:"Linux"}),d=n.i18n.translate("xpack.securitySolution.exceptions.fetchingReferencesErrorToastTitle",{defaultMessage:"Error fetching exception references"})},function(e,t,a){const n=a(152);e.exports=(e,t,a)=>n(e,t,a)>0},function(e,t,a){const n=a(152);e.exports=(e,t,a)=>n(e,t,a)>=0},function(e,t,a){const n=Symbol("SemVer ANY");class Comparator{static get ANY(){return n}constructor(e,t){if(t=i(t),e instanceof Comparator){if(e.loose===!!t.loose)return e;e=e.value}l("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===n?this.value="":this.value=this.operator+this.semver.version,l("comp",this)}parse(e){const t=this.options.loose?r[s.COMPARATORLOOSE]:r[s.COMPARATOR],a=e.match(t);if(!a)throw new TypeError(`Invalid comparator: ${e}`);this.operator=void 0!==a[1]?a[1]:"","="===this.operator&&(this.operator=""),a[2]?this.semver=new c(a[2],this.options.loose):this.semver=n}toString(){return this.value}test(e){if(l("Comparator.test",e,this.options.loose),this.semver===n||e===n)return!0;if("string"==typeof e)try{e=new c(e,this.options)}catch(e){return!1}return o(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof Comparator))throw new TypeError("a Comparator is required");if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),""===this.operator)return""===this.value||new u(e.value,t).test(this.value);if(""===e.operator)return""===e.value||new u(this.value,t).test(e.semver);const a=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),n=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),i=this.semver.version===e.semver.version,r=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),s=o(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),l=o(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return a||n||i&&r||s||l}}e.exports=Comparator;const i=a(322),{re:r,t:s}=a(235),o=a(660),l=a(307),c=a(125),u=a(163)},function(e,t,a){const n=a(163);e.exports=(e,t,a)=>{try{t=new n(t,a)}catch(e){return!1}return t.test(e)}},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=e=>i(e)&&r(e)&&s(e)&&o(e),i=({capabilities:e})=>e.canGetDatafeeds&&e.canStartStopDatafeed&&e.canUpdateDatafeed&&e.canPreviewDatafeed,r=({capabilities:e})=>e.canCreateJob&&e.canGetJobs&&e.canUpdateJob&&e.canDeleteJob&&e.canOpenJob&&e.canCloseJob&&e.canForecastJob,s=({capabilities:e})=>e.canGetFilters&&e.canCreateFilter&&e.canDeleteFilter,o=({capabilities:e})=>e.canCreateCalendar&&e.canGetCalendars&&e.canDeleteCalendar},function(e,t,a){"use strict";var n=String.fromCharCode;e.exports=n},function(e,t,a){"use strict";var n=a(115),i=a(122),r={tokenize:function(e,t,a){return i(e,(function(e){return null===e||n(e)?t(e):a(e)}),"linePrefix")},partial:!0};e.exports=r},function(e,t,a){"use strict";var n=a(664);e.exports=function(e,t){var a=e[e.length-1];return a&&a[1].type===t?n(a[2].sliceStream(a[1])):0}},function(e,t,a){"use strict";var n=a(202)(/[\dA-Za-z]/);e.exports=n},function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(4),i=a.n(n),r=a(33);const s=a.n(r).a.div.withConfig({displayName:"StyledDiv",componentId:"sc-1adamx3-0"})(["padding-left:",";"],(({addPadding:e})=>e&&"53px"));s.defaultProps={addPadding:!1};const o=i.a.memo(s);o.displayName="StepContentWrapper"},function(e,t,a){"use strict";var n=a(314);a.d(t,"e",(function(){return n.d})),a.d(t,"d",(function(){return n.c})),a.d(t,"c",(function(){return n.b}));var i=a(139);a.d(t,"a",(function(){return i.b})),a.d(t,"b",(function(){return i.d}))},function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"g",(function(){return i})),a.d(t,"c",(function(){return r})),a.d(t,"b",(function(){return s})),a.d(t,"h",(function(){return o})),a.d(t,"e",(function(){return l})),a.d(t,"f",(function(){return c})),a.d(t,"d",(function(){return u}));const n="/api/fleet/package_policies",i=(e,t,a)=>e.get(`${n}/${t}`,a),r=(e,t,a)=>e.post(`${n}/_bulk_get`,{...a,body:JSON.stringify({ids:t,ignoreMissing:!0})}),s=(e,t,a={})=>e.post("/api/fleet/agent_policies/_bulk_get",{...a,body:JSON.stringify({ids:t,ignoreMissing:!0,full:!0})}),o=(e,t,a,i={})=>e.put(`${n}/${t}`,{...i,body:JSON.stringify(a)}),l=(e,t,a={})=>e.get("/api/fleet/agent_status",{...a,query:{policyId:t}}),c=(e,t={})=>e.get("/api/fleet/agents",{...t,query:{page:1,perPage:1,kuery:'packages : "endpoint"'}}),u=async e=>{const t=(await e.get("/api/fleet/epm/packages",{query:{category:"security"}})).items.find((e=>"endpoint"===e.name));if(!t)throw new Error("Endpoint package was not found.");return t}},function(e,t,a){"use strict";a.d(t,"b",(function(){return Gi})),a.d(t,"a",(function(){return Qi})),a.d(t,"c",(function(){return Yi}));var n=a(32),i=a(0),r=a(41),s=a(35),o=a(34),l=a(4),c=a.n(l),u=a(37),d=a(78),p=a(33),m=a.n(p),g=a(93),b=a(38),f=a(157),y=a(380),h=a(90),E=a(81),v=a(77),x=a(79),k=a(293),S=a(101),j=a(180),O=a(155),w=a(156),T=a(282),I=a(164),C=a(541),M=a(161),F=a(7),D=a(119),A=a(398);const _=i.i18n.translate("xpack.securitySolution.detectionEngine.details.stepAboutRule.detailsLabel",{defaultMessage:"Details"}),N=i.i18n.translate("xpack.securitySolution.detectionEngine.details.stepAboutRule.aboutText",{defaultMessage:"About"}),R=i.i18n.translate("xpack.securitySolution.detectionEngine.details.stepAboutRule.investigationGuideLabel",{defaultMessage:"Investigation guide"}),P=i.i18n.translate("xpack.securitySolution.detectionEngine.details.stepAboutRule.setupGuideLabel",{defaultMessage:"Setup guide"}),L=i.i18n.translate("xpack.securitySolution.detectionEngine.details.stepAboutRule.controlLegend",{defaultMessage:"Viewing"});var B=a(835);const q=m()(n.EuiPanel).withConfig({displayName:"MyPanel",componentId:"sc-wtwaaw-0"})(["position:relative;"]),z=m()(n.EuiFlexGroup).withConfig({displayName:"FlexGroupFullHeight",componentId:"sc-wtwaaw-1"})(["height:100%;"]),$=m.a.div.withConfig({displayName:"VerticalOverflowContainer",componentId:"sc-wtwaaw-2"})((e=>({"max-height":`${e.maxHeight}px`,"overflow-y":"hidden","word-break":"break-word"}))),V=m.a.div.withConfig({displayName:"VerticalOverflowContent",componentId:"sc-wtwaaw-3"})((e=>({"max-height":`${e.maxHeight}px`}))),U=m.a.div.withConfig({displayName:"AboutContent",componentId:"sc-wtwaaw-4"})(["height:100%;"]),H={id:"details",label:_,"data-test-subj":"stepAboutDetailsToggle-details"},G={id:"notes",label:R,"data-test-subj":"stepAboutDetailsToggle-notes"},Q={id:"setup",label:P,"data-test-subj":"stepAboutDetailsToggle-setup"},W=({stepData:e,stepDataDetails:t,loading:a})=>{const[i,r]=Object(l.useState)("details"),[s,o]=Object(l.useState)(0),u=Object(l.useCallback)((e=>{o(e.height)}),[o]),d=Object(l.useMemo)((()=>{const e=!Object(F.isEmpty)(null==t?void 0:t.note)&&""!==(null==t?void 0:t.note.trim()),a=!Object(F.isEmpty)(null==t?void 0:t.setup)&&""!==(null==t?void 0:t.setup.trim());return[...e||a?[H]:[],...e?[G]:[],...a?[Q]:[]]}),[t]);return c.a.createElement(q,{hasBorder:!0},a&&c.a.createElement(c.a.Fragment,null,c.a.createElement(n.EuiProgress,{size:"xs",color:"accent",position:"absolute"}),c.a.createElement(D.a,{title:N})),null!=e&&null!=t&&c.a.createElement(z,{gutterSize:"xs",direction:"column"},c.a.createElement(n.EuiFlexItem,{grow:!1,key:"header"},c.a.createElement(D.a,{title:N},d.length>0&&c.a.createElement(n.EuiButtonGroup,{options:d,idSelected:i,onChange:e=>{r(e)},"data-test-subj":"stepAboutDetailsToggle",legend:L}))),c.a.createElement(n.EuiFlexItem,{key:"details"},"details"===i&&c.a.createElement(n.EuiResizeObserver,{"data-test-subj":"stepAboutDetailsContent",onResize:u},(a=>c.a.createElement(U,{ref:a},c.a.createElement($,{maxHeight:120},c.a.createElement(V,{maxHeight:120,className:"eui-yScrollWithShadows"},c.a.createElement(n.EuiText,{size:"s","data-test-subj":"stepAboutRuleDetailsToggleDescriptionText"},t.description))),c.a.createElement(n.EuiSpacer,{size:"m"}),c.a.createElement(B.a,{descriptionColumns:"singleSplit",isReadOnlyView:!0,isLoading:!1,defaultValues:e})))),"notes"===i&&c.a.createElement($,{"data-test-subj":"stepAboutDetailsNoteContent",maxHeight:s},c.a.createElement(V,{maxHeight:s,className:"eui-yScrollWithShadows"},c.a.createElement(A.b,null,t.note))),"setup"===i&&c.a.createElement($,{"data-test-subj":"stepAboutDetailsSetupContent",maxHeight:s},c.a.createElement(V,{maxHeight:s,className:"eui-yScrollWithShadows"},c.a.createElement(A.b,null,t.setup))))))},K=Object(l.memo)(W);var Y=a(586),J=a(915),X=a(165),Z=a(832),ee=a(842),te=a(274),ae=a(882),ne=a(883),ie=a(310),re=a(114),se=a(145),oe=a(143),le=a(1),ce=a(536),ue=a(131),de=a(312),pe=a(179),me=a(154),ge=a(313),be=a(844),fe=a(519),ye=a(827),he=a(113);const Ee=i.i18n.translate("xpack.securitySolution.detectionEngine.rules.components.ruleActionsOverflow.allActionsTitle",{defaultMessage:"All actions"}),ve=m()(n.EuiButtonIcon).withConfig({displayName:"MyEuiButtonIcon",componentId:"sc-wltxb1-0"})(["&.euiButtonIcon{svg{transform:rotate(90deg);}border:1px solid ",";width:40px;height:40px;}"],(({theme:e})=>e.euiColorPrimary)),xe=({rule:e,userHasPermissions:t,canDuplicateRuleWithActions:a,showBulkDuplicateExceptionsConfirmation:i})=>{const[r,,s,o]=Object(de.a)(),{navigateToApp:u}=Object(v.k)().services.application,{startTransaction:d}=Object(me.a)(),{executeBulkAction:p}=Object(fe.b)({suppressSuccessToast:!0}),{bulkExport:m}=Object(be.a)(),g=Object(ye.a)(),b=Object(l.useCallback)((()=>{u(le.B,{deepLinkId:le.uc.rules,path:Object(w.e)()})}),[u]),f=Object(l.useMemo)((()=>null!=e?[c.a.createElement(n.EuiContextMenuItem,{key:he.zb,icon:"copy",disabled:!a||!t,"data-test-subj":"rules-details-duplicate-rule",onClick:async()=>{d({name:pe.e.DUPLICATE}),s();const t=await i();if(null===t)return;const a=await p({type:ue.b.duplicate,ids:[e.id],duplicatePayload:{include_exceptions:t===ce.a.withExceptions}}),n=null==a?void 0:a.attributes.results.created;null!=n&&n.length&&Object(fe.a)(n[0].id,u)}},c.a.createElement(n.EuiToolTip,{position:"left",content:Object(ge.a)(e,a)?void 0:he.Ob},c.a.createElement(c.a.Fragment,null,he.zb))),c.a.createElement(n.EuiContextMenuItem,{key:he.Hb,icon:"exportAction",disabled:!t||e.immutable,"data-test-subj":"rules-details-export-rule",onClick:async()=>{d({name:pe.e.EXPORT}),s();const t=await m({ids:[e.id]});t&&await g(t)}},he.Hb),c.a.createElement(n.EuiContextMenuItem,{key:he.yb,icon:"trash",disabled:!t,"data-test-subj":"rules-details-delete-rule",onClick:async()=>{d({name:pe.e.DELETE}),s(),await p({type:ue.b.delete,ids:[e.id]}),b()}},he.yb)]:[]),[m,a,s,p,u,b,e,i,d,t,g]),y=Object(l.useMemo)((()=>c.a.createElement(n.EuiToolTip,{position:"top",content:Ee},c.a.createElement(ve,{iconType:"boxesHorizontal","aria-label":Ee,isDisabled:!t,"data-test-subj":"rules-details-popover-button-icon",onClick:o}))),[o,t]);return c.a.createElement(c.a.Fragment,null,c.a.createElement(n.EuiPopover,{anchorPosition:"leftCenter",button:y,closePopover:s,id:"ruleActionsOverflow",isOpen:r,"data-test-subj":"rules-details-popover",ownFocus:!0,panelPaddingSize:"none",repositionOnScroll:!0},c.a.createElement(n.EuiContextMenuPanel,{"data-test-subj":"rules-details-menu-panel",items:f})))},ke=c.a.memo(xe);ke.displayName="RuleActionsOverflow";var Se=a(120),je=a(366),Oe=a(259),we=a(2),Te=a(148),Ie=a(572),Ce=a(123),Me=a(94),Fe=a(95),De=a(583),Ae=a(52),_e=a.n(Ae),Ne=a(173);const Re=()=>v.b.get().http;var Pe=a(87),Le=a(417);const Be=Object(Pe.d)(),qe=({status:e,showTooltip:t=!1})=>{var a;const i=null!==(a=Object(Le.a)(e))&&void 0!==a?a:Be,r=Object(Le.b)(e);return t?c.a.createElement(De.b,{status:e}):c.a.createElement(n.EuiHealth,{color:r},i)},ze=c.a.memo(qe);ze.displayName="ExecutionStatusIndicator";const $e=e=>{const{dataTestSubj:t,title:a,items:i,selectedItems:r,onSelectionChange:s,renderItem:o,renderLabel:u}=Ue(e),[d,,p,m]=Object(de.a)(),g=Object(l.useCallback)((e=>{const t=r.includes(e)?r.filter((t=>t!==e)):[...r,e];s(t)}),[r,s]),b=Object(l.useMemo)((()=>i.map(((e,a)=>{const i=u(e),s=o(e);return c.a.createElement(n.EuiFilterSelectItem,{"data-test-subj":`${t}-item`,title:i,key:`${a}-${i}`,checked:r.includes(e)?"on":void 0,onClick:()=>g(e)},s)}))),[t,i,r,o,u,g]);return c.a.createElement(n.EuiFilterGroup,{"data-test-subj":t},c.a.createElement(n.EuiPopover,{"data-test-subj":`${t}-popover`,button:c.a.createElement(n.EuiFilterButton,{"data-test-subj":`${t}-popoverButton`,iconType:"arrowDown",grow:!1,numFilters:i.length,numActiveFilters:r.length,hasActiveFilters:r.length>0,isSelected:d,onClick:m},a),isOpen:d,closePopover:p,panelPaddingSize:"none",repositionOnScroll:!0},b))},Ve=(()=>{const e=c.a.memo($e);return e.displayName="MultiselectFilter",e})(),Ue=e=>{var t,a,n,i;const r=null!==(t=e.onSelectionChange)&&void 0!==t?t:F.noop,s=null!==(a=e.renderLabel)&&void 0!==a?a:String,o=null!==(n=e.renderItem)&&void 0!==n?n:s;return{dataTestSubj:null!==(i=e.dataTestSubj)&&void 0!==i?i:"multiselectFilter",title:e.title,items:e.items,selectedItems:e.selectedItems,onSelectionChange:r,renderLabel:s,renderItem:o}},He=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.executionStatusFilter.filterTitle",{defaultMessage:"Status"}),Ge=({items:e,selectedItems:t,onChange:a})=>{const n=Object(l.useCallback)((e=>c.a.createElement(ze,{status:e})),[]);return c.a.createElement(Ve,{dataTestSubj:"ExecutionStatusFilter",title:He,items:e,selectedItems:t,onSelectionChange:a,renderItem:n})},Qe=c.a.memo(Ge);Qe.displayName="ExecutionStatusFilter";var We=a(174);const Ke=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.eventTypeIndicator.messageText",{defaultMessage:"Message"}),Ye=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.eventTypeIndicator.statusChangeText",{defaultMessage:"Status"}),Je=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.eventTypeIndicator.executionMetricsText",{defaultMessage:"Metrics"}),Xe=({type:e})=>{const t=(e=>{switch(e){case Ne.e.message:return"console";case Ne.e["status-change"]:return"dot";case Ne.e["execution-metrics"]:return"gear";default:return Object(We.a)(e,"Unknown rule execution event type")}})(e),a=(e=>{switch(e){case Ne.e.message:return Ke;case Ne.e["status-change"]:return Ye;case Ne.e["execution-metrics"]:return Je;default:return Object(We.a)(e,"Unknown rule execution event type")}})(e);return c.a.createElement(n.EuiBadge,{color:"hollow",iconType:t},a)},Ze=c.a.memo(Xe);Ze.displayName="EventTypeIndicator";const et=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.eventTypeFilter.filterTitle",{defaultMessage:"Event type"}),tt=({selectedItems:e,onChange:t})=>{const a=Object(l.useCallback)((e=>c.a.createElement(Ze,{type:e})),[]);return c.a.createElement(Ve,{dataTestSubj:"eventTypeFilter",title:et,items:Ne.d,selectedItems:e,onSelectionChange:t,renderItem:a})},at=c.a.memo(tt);at.displayName="EventTypeFilter";const nt=({logLevel:e})=>{const t=(e=>{switch(e){case Ne.b.trace:case Ne.b.debug:return"hollow";case Ne.b.info:return"default";case Ne.b.warn:return"warning";case Ne.b.error:return"danger";default:return Object(We.a)(e,"Unknown log level")}})(e),a=(e=>Object(F.upperCase)(e))(e);return c.a.createElement(n.EuiBadge,{color:t},a)},it=c.a.memo(nt);it.displayName="LogLevelIndicator";const rt=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.logLevelFilter.filterTitle",{defaultMessage:"Log level"}),st=({selectedItems:e,onChange:t})=>{const a=Object(l.useCallback)((e=>c.a.createElement(it,{logLevel:e})),[]);return c.a.createElement(Ve,{dataTestSubj:"logLevelFilter",title:rt,items:Ne.a,selectedItems:e,onSelectionChange:t,renderItem:a})},ot=c.a.memo(st);ot.displayName="LogLevelFilter";const lt=({text:e})=>c.a.createElement(n.EuiCodeBlock,{className:"eui-fullWidth",isCopyable:!0,overflowHeight:320,transparentBackground:!0},null!=e?e:""),ct=c.a.memo(lt);ct.displayName="TextBlock";const ut=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.executionEventsTable.tableTitle",{defaultMessage:"Execution log"}),dt=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.executionEventsTable.tableSubtitle",{defaultMessage:"A detailed log of rule execution events"}),pt=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.executionEventsTable.timestampColumn",{defaultMessage:"Timestamp"}),mt=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.executionEventsTable.logLevelColumn",{defaultMessage:"Level"}),gt=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.executionEventsTable.eventTypeColumn",{defaultMessage:"Type"}),bt=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.executionEventsTable.messageColumn",{defaultMessage:"Message"}),ft=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.executionEventsTable.fetchErrorDescription",{defaultMessage:"Failed to fetch rule execution events"}),yt=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.executionEventsTable.rowDetails.messageTitle",{defaultMessage:"Message"}),ht=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.executionEventsTable.rowDetails.jsonTitle",{defaultMessage:"Full JSON"}),Et=({item:e})=>c.a.createElement(n.EuiDescriptionList,{className:"eui-fullWidth",listItems:[{title:yt,description:c.a.createElement(ct,{text:e.message})},{title:ht,description:c.a.createElement(ct,{text:JSON.stringify(e,null,2)})}]}),vt=c.a.memo(Et);vt.displayName="ExecutionEventsTableRowDetails";const xt=[10,20,50],kt=({text:e})=>null!=e?c.a.createElement("span",{className:"eui-fullWidth eui-textTruncate"},e):null,St=c.a.memo(kt);St.displayName="TruncatedText";const jt={field:"timestamp",name:pt,render:e=>c.a.createElement(S.a,{value:e,fieldName:"timestamp"}),sortable:!0,truncateText:!1,width:"20%"},Ot={field:"level",name:mt,render:e=>c.a.createElement(it,{logLevel:e}),sortable:!1,truncateText:!1,width:"8%"},wt={field:"type",name:gt,render:e=>c.a.createElement(Ze,{type:e}),sortable:!1,truncateText:!1,width:"8%"},Tt={field:"message",name:bt,render:e=>c.a.createElement(St,{text:e}),sortable:!1,truncateText:!0,width:"64%"},It=({toggleRowExpanded:e,isRowExpanded:t})=>({align:n.RIGHT_ALIGNMENT,width:"40px",isExpander:!0,name:c.a.createElement(n.EuiScreenReaderOnly,null,c.a.createElement("span",null,"Expand rows")),render:a=>c.a.createElement(n.EuiButtonIcon,{onClick:()=>e(a),"aria-label":t(a)?"Collapse":"Expand",iconType:t(a)?"arrowUp":"arrowDown"})});var Ct=a(39),Mt=a(84);const Ft=[10,20,50,100,200],Dt=({ruleId:e})=>{const t=Object(l.useCallback)((e=>`${e.timestamp} ${e.sequence}`),[]),a=(e=>{const{getItemId:t,renderItem:a}=e,[n,i]=Object(l.useState)({}),r=Object(l.useCallback)((e=>{const r={...n},s=t(e);r[s]?delete r[s]:r[s]=a(e),i(r)}),[n,t,a]),s=Object(l.useCallback)((e=>{const a=t(e);return null!=n[a]}),[n,t]);return Object(l.useMemo)((()=>({itemIdToExpandedRowMap:n,getItemId:t,toggleRowExpanded:r,isRowExpanded:s})),[n,t,r,s])})({getItemId:t,renderItem:Object(l.useCallback)((e=>c.a.createElement(vt,{item:e})),[])}),i=(e=>{const{toggleRowExpanded:t,isRowExpanded:a}=e;return Object(l.useMemo)((()=>[jt,Ot,wt,Tt,It({toggleRowExpanded:t,isRowExpanded:a})]),[t,a])})({toggleRowExpanded:a.toggleRowExpanded,isRowExpanded:a.isRowExpanded}),r=(()=>{const[e,t]=Object(l.useState)([]),[a,n]=Object(l.useState)([]),i=Object(l.useMemo)((()=>({logLevels:e,eventTypes:a})),[e,a]);return Object(l.useMemo)((()=>({state:i,setLogLevels:t,setEventTypes:n})),[i,t,n])})(),s=((e,t)=>{const[a,n]=Object(l.useState)("timestamp"),[i,r]=Object(l.useState)("desc"),s=Object(l.useMemo)((()=>({sort:{field:a,direction:i}})),[a,i]),o=Object(l.useCallback)((e=>{e.sort&&(n(e.sort.field),r(e.sort.direction))}),[n,r]);return Object(l.useMemo)((()=>({state:s,update:o})),[s,o])})(),o=(e=>{var t,a,n;const i=null!==(t=e.pageSizeOptions)&&void 0!==t?t:xt,r=null!==(a=e.pageSizeDefault)&&void 0!==a?a:i[0],s=null!==(n=e.pageNumberDefault)&&void 0!==n?n:1,[o,c]=Object(l.useState)(r),[u,d]=Object(l.useState)(s),[p,m]=Object(l.useState)(0),g=Object(l.useMemo)((()=>({pageSizeOptions:i,pageSize:o,pageNumber:u,pageIndex:u-1,totalItemCount:p})),[i,o,u,p]),b=Object(l.useCallback)((e=>{d(e.page.index+1),c(e.page.size)}),[d,c]),f=Object(l.useCallback)((e=>{m(null!=e?e:0)}),[m]);return Object(l.useMemo)((()=>({state:g,update:b,updateTotalItemCount:f})),[g,b,f])})({pageSizeOptions:Ft}),u=(e=>{const{addError:t}=Object(Mt.a)();return Object(Ct.useQuery)(["detectionEngine","ruleMonitoring","executionEvents",e],(({signal:t})=>(e=>{const{ruleId:t,eventTypes:a,logLevels:n,sortOrder:i,page:r,perPage:s,signal:o}=e,l=Object(Ne.h)(t);return Re().fetch(l,{method:"GET",query:{event_types:null==a?void 0:a.join(","),log_levels:null==n?void 0:n.join(","),sort_order:i,page:r,per_page:s},signal:o})})({...e,signal:t})),{keepPreviousData:!0,refetchInterval:2e4,onError:e=>{t(e,{title:ft})}})})({ruleId:e,eventTypes:r.state.eventTypes,logLevels:r.state.logLevels,sortOrder:s.state.sort.direction,page:o.state.pageNumber,perPage:o.state.pageSize});Object(l.useEffect)((()=>{var e;o.updateTotalItemCount(null===(e=u.data)||void 0===e?void 0:e.pagination.total)}),[u,o]);const d=Object(l.useMemo)((()=>{var e,t;return null!==(e=null===(t=u.data)||void 0===t?void 0:t.events)&&void 0!==e?e:[]}),[u.data]),p=Object(l.useCallback)((e=>{s.update(e),o.update(e)}),[s,o]);return c.a.createElement(n.EuiPanel,{hasBorder:!0},c.a.createElement(n.EuiFlexGroup,{gutterSize:"s"},c.a.createElement(n.EuiFlexItem,{grow:!0},c.a.createElement(D.a,{title:ut,subtitle:dt})),c.a.createElement(n.EuiFlexItem,{grow:!1},c.a.createElement(ot,{selectedItems:r.state.logLevels,onChange:r.setLogLevels})),c.a.createElement(n.EuiFlexItem,{grow:!1},c.a.createElement(at,{selectedItems:r.state.eventTypes,onChange:r.setEventTypes}))),c.a.createElement(n.EuiBasicTable,{columns:i,items:d,itemId:t,itemIdToExpandedRowMap:a.itemIdToExpandedRowMap,isExpandable:!0,loading:u.isFetching,sorting:s.state,pagination:o.state,onChange:p}))},At=c.a.memo(Dt);At.displayName="RuleExecutionEventsTable";const _t=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleMonitoring.executionResultsTable.fetchErrorDescription",{defaultMessage:"Failed to fetch rule execution results"});var Nt=a(107);const Rt=(e,t)=>{try{const[t]=Object(v.q)(e);return t}catch(e){return t}};var Pt=a(43),Lt=a.n(Pt),Bt=a(45),qt=1e3,zt="siem",$t=("".concat(zt,".eqlRule"),"".concat(zt,".indicatorRule"),"".concat(zt,".mlRule"),"".concat(zt,".queryRule"),"".concat(zt,".savedQueryRule"),"".concat(zt,".thresholdRule"),"".concat(zt,".newTermsRule"),a(6),a(216),a(53)),Vt=(a(1058),a(36)),Ut=a(247),Ht=a(98),Gt=a(933),Qt=a(679);const Wt=Object(l.createContext)(null),Kt=({children:e})=>{var t;const{storage:a}=Object(v.k)().services,[n,i]=Object(l.useState)([]),[r,s]=Object(l.useState)(1e3),[o,u]=Object(l.useState)(!0),[d,p]=Object(l.useState)("now-24h"),[m,g]=Object(l.useState)("now"),[b,f]=Object(l.useState)(""),[y,h]=Object(l.useState)([]),[E,x]=Object(l.useState)(null!==(t=a.get(le.nc))&&void 0!==t&&t),[k,S]=Object(l.useState)(1),[j,O]=Object(l.useState)(5),[w,T]=Object(l.useState)("timestamp"),[I,C]=Object(l.useState)("desc"),M=Object(l.useMemo)((()=>({[Gi.executionResults]:{state:{superDatePicker:{recentlyUsedRanges:n,refreshInterval:r,isPaused:o,start:d,end:m},queryText:b,statusFilters:y,showMetricColumns:E,pagination:{pageIndex:k,pageSize:j},sort:{sortField:w,sortDirection:I}},actions:{setEnd:g,setIsPaused:u,setPageIndex:S,setPageSize:O,setQueryText:f,setRecentlyUsedRanges:i,setRefreshInterval:s,setShowMetricColumns:x,setSortDirection:C,setSortField:T,setStart:p,setStatusFilters:h}}})),[m,o,k,j,b,n,r,E,I,w,d,y]);return c.a.createElement(Wt.Provider,{value:M},e)},Yt=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.tableTitle",{defaultMessage:"Execution log"}),Jt=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.tableSubtitle",{defaultMessage:"A log of rule execution results"}),Xt=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.searchPlaceholder",{defaultMessage:"duration > 100 and gapDuration > 10"}),Zt=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.showMetricColumnsSwitchTitle",{defaultMessage:"Show metrics columns"}),ea=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.statusColumn",{defaultMessage:"Status"}),ta=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.statusColumnTooltip",{defaultMessage:"Overall status of execution."}),aa=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.timestampColumn",{defaultMessage:"Timestamp"}),na=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.timestampColumnTooltip",{defaultMessage:"Datetime rule execution initiated."}),ia=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.durationColumn",{defaultMessage:"Duration"}),ra=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.durationColumnTooltip",{defaultMessage:"The length of time it took for the rule to run (hh:mm:ss:SSS)."}),sa=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.messageColumn",{defaultMessage:"Message"}),oa=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.messageColumnTooltip",{defaultMessage:"Relevant message from execution outcome."}),la=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.gapDurationColumn",{defaultMessage:"Gap Duration"}),ca=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.gapTooltipSeeDocsDescription",{defaultMessage:"see documentation"}),ua=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.indexDurationColumn",{defaultMessage:"Index Duration"}),da=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.indexDurationColumnTooltip",{defaultMessage:"The length of time it took to index detected alerts (hh:mm:ss:SSS)."}),pa=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.searchDurationColumn",{defaultMessage:"Search Duration"}),ma=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.searchDurationColumnTooltip",{defaultMessage:"The length of time it took to search for alerts (hh:mm:ss:SSS)."}),ga=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.schedulingDelayColumn",{defaultMessage:"Scheduling Delay"}),ba=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.schedulingDelayColumnTooltip",{defaultMessage:"The length of time from rule scheduled till rule executed (hh:mm:ss:SSS)."}),fa=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.actionsColumn",{defaultMessage:"Actions"}),ya=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.actionsColumnTooltip",{defaultMessage:"Filter alerts by rule execution ID."}),ha=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.actionSearchFiltersUpdatedTitle",{defaultMessage:"Global search filters have been updated"}),Ea=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.actionSearchFiltersUpdatedDescription",{defaultMessage:"Search filters have been updated to show alerts from selected rule execution"}),va=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.actionSearchFiltersUpdatedRestoreButtonTitle",{defaultMessage:"Restore previous filters"}),xa=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.actionFieldNotFoundErrorTitle",{defaultMessage:"Unable to filter alerts"}),ka=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.actionFieldNotFoundErrorDescription",{defaultMessage:"Cannot find field 'kibana.alert.rule.execution.uuid' in alerts index."}),Sa=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.durationNotAvailableDescription",{defaultMessage:"N/A"}),ja=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.durationGreaterThanYearDescription",{defaultMessage:"> 1 Year"});var Oa=a(884),wa=a(885);const Ta=e=>{const{duration:t,isSeconds:a=!1,allowZero:n=!0}=e,i=Object(l.useMemo)((()=>n&&t>=0?(e=>{if(!e)return"00:00:00:000";const t=Lt.a.duration(e),a=Math.floor(t.asDays()).toString().padStart(3,"0"),n=Math.floor(t.asHours()%24).toString().padStart(2,"0"),i=Math.floor(t.asMinutes()%60).toString().padStart(2,"0"),r=t.seconds().toString().padStart(2,"0"),s=t.milliseconds().toString().padStart(3,"0");return Math.floor(t.asDays())>0?Math.floor(t.asDays())>=365?ja:`${a}:${n}:${i}:${r}:${s}`:`${n}:${i}:${r}:${s}`})(a?1e3*t:t):Sa),[n,t,a]);return c.a.createElement("span",{"data-test-subj":"rule-duration-format-value"},i)},Ia=c.a.memo(Ta);Ia.displayName="RuleDurationFormat";const Ca=[{name:c.a.createElement(wa.a,{title:ea,tooltipContent:ta}),field:"security_status",render:e=>c.a.createElement(ze,{status:e,showTooltip:!0}),sortable:!1,truncateText:!1,width:"10%"},{field:"timestamp",name:c.a.createElement(wa.a,{title:aa,tooltipContent:na}),render:e=>c.a.createElement(S.a,{value:e,fieldName:"timestamp"}),sortable:!0,truncateText:!1,width:"15%"},{field:"duration_ms",name:c.a.createElement(wa.a,{title:ia,tooltipContent:ra}),render:e=>c.a.createElement(c.a.Fragment,null,e?c.a.createElement(Ia,{duration:e}):Object(Pe.e)()),sortable:!0,truncateText:!1,width:"10%"},{field:"security_message",name:c.a.createElement(wa.a,{title:sa,tooltipContent:oa}),render:e=>c.a.createElement(c.a.Fragment,null,e),sortable:!1,truncateText:!1,width:"35%"}],Ma=e=>[{field:"gap_duration_s",name:c.a.createElement(wa.a,{title:la,customTooltip:c.a.createElement("div",{style:{maxWidth:"20px"}},c.a.createElement(Oa.a,{columnName:la},c.a.createElement(n.EuiText,{size:"s",style:{width:350}},c.a.createElement("p",null,c.a.createElement(s.FormattedMessage,{defaultMessage:"Duration of gap in Rule execution (hh:mm:ss:SSS). Adjust Rule look-back or {seeDocs} for mitigating gaps.",id:"xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.gapDurationColumnTooltip",values:{seeDocs:c.a.createElement(n.EuiLink,{href:`${e.links.siem.troubleshootGaps}`,target:"_blank"},ca)}})))))}),render:e=>c.a.createElement(c.a.Fragment,null,e?c.a.createElement(Ia,{duration:e,isSeconds:!0}):Object(Pe.e)()),sortable:!0,truncateText:!1,width:"10%"},{field:"indexing_duration_ms",name:c.a.createElement(wa.a,{title:ua,tooltipContent:da}),render:e=>c.a.createElement(c.a.Fragment,null,e?c.a.createElement(Ia,{duration:e}):Object(Pe.e)()),sortable:!0,truncateText:!1,width:"10%"},{field:"search_duration_ms",name:c.a.createElement(wa.a,{title:pa,tooltipContent:ma}),render:e=>c.a.createElement(c.a.Fragment,null,e?c.a.createElement(Ia,{duration:e}):Object(Pe.e)()),sortable:!0,truncateText:!1,width:"10%"},{field:"schedule_delay_ms",name:c.a.createElement(wa.a,{title:ga,tooltipContent:ba}),render:e=>c.a.createElement(c.a.Fragment,null,e?c.a.createElement(Ia,{duration:e}):Object(Pe.e)()),sortable:!0,truncateText:!1,width:"10%"}],Fa={status:"kibana.alert.rule.execution.status",timestamp:"@timestamp",duration:"event.duration",message:"message",gapDuration:"kibana.alert.rule.execution.metrics.execution_gap_duration_s",indexDuration:"kibana.alert.rule.execution.metrics.total_indexing_duration_ms",searchDuration:"kibana.alert.rule.execution.metrics.total_search_duration_ms",totalActions:"kibana.alert.rule.execution.metrics.number_of_triggered_actions",schedulingDelay:"kibana.task.schedule_delay"},Da=[Ne.f.succeeded,Ne.f.failed,Ne.f["partial failure"]],Aa=c.a.memo((({onlyShowFilters:e,selectedStatuses:t,onStatusFilterChange:a,onSearch:i})=>{const r=Object(l.useCallback)((e=>{i((e=>Object.entries(Fa).reduce(((e,[t,a])=>Object(F.replace)(e,t,a)),e))(e))}),[i]);return c.a.createElement(n.EuiFlexGroup,{gutterSize:"s"},c.a.createElement(n.EuiFlexItem,{grow:!0},!e&&c.a.createElement(n.EuiFieldSearch,{"data-test-subj":"executionLogSearch","aria-label":Xt,placeholder:Xt,onSearch:r,isClearable:!0,fullWidth:!0})),c.a.createElement(n.EuiFlexItem,{grow:!1},c.a.createElement(Qe,{items:Da,selectedItems:t,onChange:a})))}));Aa.displayName="ExecutionLogSearchBar";const _a="kibana.alert.rule.execution.uuid",Na=m()(n.EuiSwitch).withConfig({displayName:"UtilitySwitch",componentId:"sc-1wv8sfl-0"})(["margin-left:17px;"]),Ra=m()(n.EuiFlexItem).withConfig({displayName:"DatePickerEuiFlexItem",componentId:"sc-1wv8sfl-1"})(["max-width:582px;"]),Pa=({ruleId:e,selectAlertsTab:t})=>{var a,r;const{docLinks:o,data:{query:{filterManager:u}},storage:p,timelines:m}=Object(v.k)().services,{[Gi.executionResults]:{state:{superDatePicker:{recentlyUsedRanges:g,refreshInterval:b,isPaused:f,start:y,end:x},queryText:k,statusFilters:S,showMetricColumns:j,pagination:{pageIndex:O,pageSize:w},sort:{sortField:T,sortDirection:I}},actions:{setEnd:C,setIsPaused:M,setPageIndex:F,setPageSize:A,setQueryText:_,setRecentlyUsedRanges:N,setRefreshInterval:R,setShowMetricColumns:P,setSortDirection:L,setSortField:B,setStart:q,setStatusFilters:z}}}=(()=>{const e=Object(l.useContext)(Wt);return Object(Qt.a)(e,"useRuleDetailsContext should be used inside RuleDetailsContextProvider"),e})(),{indexPattern:$}=Object(Me.d)(Fe.SourcererScopeName.detections),{addError:V,addSuccess:U,remove:H}=Object(Mt.a)(),G=Object(d.useDispatch)(),Q=Object(l.useMemo)((()=>Ht.d.globalFiltersQuerySelector()),[]),W=Object(l.useMemo)((()=>Ht.d.globalQuerySelector()),[]),K=Object(E.a)(Ht.d.globalTimeRangeSelector),Y=Object(E.a)(W),J=Object(E.a)(Q),X=Object(l.useRef)({filters:J,query:Y,timerange:K}),Z=Object(l.useRef)(""),ee=Object(l.useCallback)((()=>{Object(Gt.a)(X.current.timerange)?G(Object(oe.setAbsoluteRangeDatePicker)({id:h.a.global,from:X.current.timerange.from,to:X.current.timerange.to})):Object(Gt.b)(X.current.timerange)&&G(Object(oe.setRelativeRangeDatePicker)({id:h.a.global,from:X.current.timerange.from,fromStr:X.current.timerange.fromStr,to:X.current.timerange.to,toStr:X.current.timerange.toStr})),G(Object(oe.setFilterQuery)({id:h.a.global,query:X.current.query.query,language:X.current.query.language})),u.removeAll(),u.addFilters(X.current.filters),H(Z.current)}),[G,u,H]),{data:te,dataUpdatedAt:ae,isFetching:ne,isLoading:ie,refetch:re}=(e=>{const{addError:t}=Object(Mt.a)();return Object(Ct.useQuery)(["detectionEngine","ruleMonitoring","executionResults",e],(({signal:t})=>(e=>{var t;const{ruleId:a,start:n,end:i,queryText:r,statusFilters:s,page:o,perPage:l,sortField:c,sortOrder:u,signal:d}=e,p=Object(Ne.i)(a),m=_e.a.parse(n),g=_e.a.parse(i,{roundUp:!0});return Re().fetch(p,{method:"GET",query:{start:null==m?void 0:m.utc().toISOString(),end:null==g?void 0:g.utc().toISOString(),query_text:r,status_filters:null==s||null===(t=s.sort())||void 0===t?void 0:t.join(","),sort_field:c,sort_order:u,page:o,per_page:l},signal:d})})({...e,signal:t})),{keepPreviousData:!0,onError:e=>{t(e,{title:_t})}})})({ruleId:e,start:y,end:x,queryText:k,statusFilters:S,page:O,perPage:w,sortField:T,sortOrder:I}),se=null!==(a=null==te?void 0:te.events)&&void 0!==a?a:[],ce=null!==(r=null==te?void 0:te.total)&&void 0!==r?r:0,ue=Object(l.useMemo)((()=>$.fields.find((e=>e.name===_a))),[$]),de=Object(l.useCallback)((({page:e={},sort:t={}})=>{const{index:a,size:n}=e,{field:i,direction:r}=t;F(a+1),A(n),B(i),L(r)}),[F,A,L,B]),pe=Object(l.useCallback)((e=>{const t=g.filter((t=>!(t.start===e.start&&t.end===e.end)));t.unshift({start:e.start,end:e.end}),q(e.start),C(e.end),N(t.length>10?t.slice(0,9):t)}),[g,C,N,q]),me=Object(l.useCallback)((e=>{M(e.isPaused),R(e.refreshInterval>6e4?e.refreshInterval:6e4)}),[M,R]),ge=Object(l.useCallback)((e=>{re()}),[re]),be=Object(l.useCallback)((e=>{_(e)}),[_]),fe=Object(l.useCallback)((e=>{z(e)}),[z]),ye=Object(l.useCallback)(((e,a)=>{if(null!=ue){X.current={filters:J,query:Y,timerange:K};const r=Object(Bt.buildFilter)($,ue,Bt.FILTERS.PHRASE,!1,!1,e,null);G(Object(oe.setAbsoluteRangeDatePicker)({id:h.a.global,from:Lt()(a).subtract(1,"days").toISOString(),to:Lt()(a).add(1,"days").toISOString()})),u.removeAll(),u.addFilters(r),G(Object(oe.setFilterQuery)({id:h.a.global,query:"",language:"kuery"})),t(),Z.current=U({title:ha,text:(i=c.a.createElement(c.a.Fragment,null,c.a.createElement("p",null,Ea),c.a.createElement(n.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},c.a.createElement(n.EuiFlexItem,{grow:!1},c.a.createElement(n.EuiButton,{size:"s",onClick:ee},va)))),function(e){return Object($t.render)(Object(Vt.jsx)(s.I18nProvider,null,i),e),function(){return Object($t.unmountComponentAtNode)(e)}})},{toastLifeTimeMs:6e5}).id}else V(ka,{title:xa});var i}),[V,U,G,u,J,$,Y,ee,t,K,ue]),he=Object(l.useCallback)((e=>{p.set(le.nc,e),P(e)}),[P,p]),Ee=Object(l.useMemo)((()=>({pageIndex:O-1,pageSize:w,totalItemCount:ce>qt?qt:ce,pageSizeOptions:[5,10,25,50]})),[ce,O,w]),ve=Object(l.useMemo)((()=>({sort:{field:T,direction:I}})),[I,T]),xe=Object(l.useMemo)((()=>[{field:_a,name:fa,width:"5%",actions:[{name:"Edit",isPrimary:!0,field:"",description:ya,icon:"filter",type:"icon",onClick:e=>{null!=e&&e.execution_uuid&&ye(e.execution_uuid,e.timestamp)},"data-test-subj":"action-filter-by-execution-id"}]}]),[ye]),ke=Object(l.useMemo)((()=>j?[...Ca,...Ma(o),...xe]:[...Ca,...xe]),[xe,o,j]);return c.a.createElement(n.EuiPanel,{hasBorder:!0},c.a.createElement(n.EuiFlexGroup,{gutterSize:"s"},c.a.createElement(n.EuiFlexItem,{grow:!0},c.a.createElement(D.a,{title:Yt,subtitle:Jt})),c.a.createElement(n.EuiFlexItem,{grow:!1},c.a.createElement(Aa,{onlyShowFilters:!0,selectedStatuses:S,onStatusFilterChange:fe,onSearch:be})),c.a.createElement(Ra,null,c.a.createElement(n.EuiSuperDatePicker,{start:y,end:x,onTimeChange:pe,onRefresh:ge,isPaused:f,isLoading:ne,refreshInterval:b,onRefreshChange:me,recentlyUsedRanges:g,width:"full"}))),c.a.createElement(n.EuiSpacer,{size:"s"}),c.a.createElement(Ut.a,null,c.a.createElement(Ut.d,null,c.a.createElement(Ut.c,null,c.a.createElement(Ut.e,{dataTestSubj:"executionsShowing"},(Se=ce>qt?qt:ce,i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.totalExecutionsLabel",{values:{totalItems:Se},defaultMessage:"Showing {totalItems} {totalItems, plural, =1 {rule execution} other {rule executions}}"})))),ce>qt&&c.a.createElement(Ut.c,{grow:!0},c.a.createElement(Ut.e,{dataTestSubj:"exceptionsShowing",shouldWrap:!0},c.a.createElement(n.EuiTextColor,{color:"danger"},((e,t)=>i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionLog.searchLimitExceededLabel",{values:{totalItems:e,maxItems:1e3},defaultMessage:"More than {totalItems} rule executions match filters provided. Showing first {maxItems} by most recent '@timestamp'. Constrain filters further to view additional execution events."}))(ce))))),c.a.createElement(Ut.d,null,c.a.createElement(Ut.c,null,c.a.createElement(Ut.e,{dataTestSubj:"lastUpdated"},m.getLastUpdated({showUpdating:ie||ne,updatedAt:ae})),c.a.createElement(Na,{label:Zt,checked:j,compressed:!0,onChange:e=>he(e.target.checked)})))),c.a.createElement(n.EuiBasicTable,{columns:ke,items:se,loading:ne,sorting:ve,pagination:Ee,onChange:de}));var Se},La=c.a.memo(Pa);La.displayName="ExecutionLogTable";var Ba=a(416),qa=a(886);i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.pageTitle",{defaultMessage:"Rule details"});const za=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.backToRulesButton",{defaultMessage:"Rules"}),$a=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.enableRuleLabel",{defaultMessage:"Enable"}),Va=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.unknownDescription",{defaultMessage:"Unknown"}),Ua=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExceptionsTab",{defaultMessage:"Rule exceptions"}),Ha=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.endpointExceptionsTab",{defaultMessage:"Endpoint exceptions"}),Ga=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionResultsTab",{defaultMessage:"Execution results"}),Qa=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionEventsTab",{defaultMessage:"Execution events"}),Wa=i.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.deletedRule",{defaultMessage:"Deleted rule"});var Ka=a(843),Ya=a(587),Ja=a(612),Xa=a(888),Za=a(683),en=a(220),tn=a(172),an=a(207);const nn=i.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.noSearchResultsPromptTitle",{defaultMessage:"No results match your search criteria"}),rn=i.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.noSearchResultsPromptBody",{defaultMessage:"Try modifying your search."}),sn=i.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.addExceptionsEmptyPromptTitle",{defaultMessage:"Add exceptions to this rule"}),on=i.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.emptyPromptBody",{defaultMessage:"There are no exceptions for this rule. Create your first rule exception."}),ln=i.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.endpoint.emptyPromptBody",{defaultMessage:"There are no endpoint exceptions. Create your first endpoint exception."}),cn=i.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.emptyPromptButtonLabel",{defaultMessage:"Add rule exception"}),un=i.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.endpoint.emptyPromptButtonLabel",{defaultMessage:"Add endpoint exception"}),dn=i.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.exceptionItemsFetchError",{defaultMessage:"Unable to load exception items"}),pn=i.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.exceptionItemsFetchErrorDescription",{defaultMessage:"There was an error loading the exception items. Contact your administrator for help."}),mn=i.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.exceptionItemSearchErrorTitle",{defaultMessage:"Error searching"}),gn=i.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.exceptionItemSearchErrorBody",{defaultMessage:"An error occurred searching for exception items. Please try again."}),bn=i.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.exceptionDeleteErrorTitle",{defaultMessage:"Error deleting exception item"}),fn=i.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.paginationAriaLabel",{defaultMessage:"Exception item table pagination"}),yn=i.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.exceptionItemDeleteSuccessTitle",{defaultMessage:"Exception deleted"}),hn=i.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.exceptionEndpointDetailsDescription",{defaultMessage:"Endpoint exceptions are added to both the detection rule and the Elastic Endpoint agent on your hosts."}),En=i.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.exceptionDetectionDetailsDescription",{defaultMessage:"Rule exceptions are added to the detection rule."}),vn=i.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.searchPlaceholder",{defaultMessage:'Filter exceptions using simple query syntax, for example, name:"my list"'}),xn=i.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.addToEndpointListLabel",{defaultMessage:"Add endpoint exception"}),kn=i.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.addToDetectionsListLabel",{defaultMessage:"Add rule exception"}),Sn={strict:!0,fields:{created_by:{type:"string"},description:{type:"string"},id:{type:"string"},item_id:{type:"string"},list_id:{type:"string"},name:{type:"string"},os_types:{type:"string"},tags:{type:"string"}}},jn=({canAddException:e,isEndpoint:t,isSearching:a,onSearch:i,onAddExceptionClick:r})=>{const s=Object(l.useCallback)((({queryText:e})=>{i({search:e})}),[i]),o=Object(l.useCallback)((()=>{r()}),[r]),u=Object(l.useMemo)((()=>t?xn:kn),[t]);return c.a.createElement(n.EuiFlexGroup,{alignItems:"center"},c.a.createElement(n.EuiFlexItem,{grow:!0},c.a.createElement(n.EuiSearchBar,{box:{placeholder:vn,incremental:!0,schema:Sn,"data-test-subj":"exceptionsViewerSearchBar"},filters:[],onChange:s})),!e&&c.a.createElement(n.EuiFlexItem,{grow:!1},c.a.createElement(n.EuiButton,{"data-test-subj":"exceptionsHeaderAddExceptionBtn",onClick:o,isDisabled:a,fill:!0},u)))};jn.displayName="ExceptionsViewerSearchBarComponent";const On=c.a.memo(jn);On.displayName="ExceptionsViewerSearchBar";const wn=({pagination:e,onPaginationChange:t})=>{var a;const i=Object(l.useCallback)((a=>{t({pagination:{page:e.pageIndex,perPage:a}})}),[t,e.pageIndex]),r=Object(l.useCallback)((a=>{t({pagination:{page:a,perPage:e.pageSize}})}),[t,e.pageSize]);return c.a.createElement(n.EuiTablePagination,{"aria-label":fn,pageCount:null!==(a=Math.ceil(e.totalItemCount/e.pageSize))&&void 0!==a?a:0,activePage:e.pageIndex,onChangePage:r,itemsPerPage:e.pageSize,onChangeItemsPerPage:i,itemsPerPageOptions:e.pageSizeOptions,"data-test-subj":"allExceptionItemsPagination"})};wn.displayName="ExceptionsViewerPaginationComponent";const Tn=c.a.memo(wn);Tn.displayName="ExceptionsViewerPagination";const In=m.a.span.withConfig({displayName:"StyledText",componentId:"sc-kgjjyi-0"})(["font-weight:bold;"]),Cn=m()(n.EuiFlexGroup).withConfig({displayName:"MyUtilities",componentId:"sc-kgjjyi-1"})(["height:50px;"]),Mn=m.a.span.withConfig({displayName:"StyledCondition",componentId:"sc-kgjjyi-2"})(["display:inline-block !important;vertical-align:middle !important;"]),Fn=({pagination:e,lastUpdated:t})=>c.a.createElement(Cn,{alignItems:"center",justifyContent:"spaceBetween"},c.a.createElement(n.EuiFlexItem,{grow:!1},c.a.createElement(Ut.a,null,c.a.createElement(Ut.d,null,c.a.createElement(Ut.c,null,c.a.createElement(Ut.e,{dataTestSubj:"exceptionsShowing"},c.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.exceptions.viewer.paginationDetails",defaultMessage:"Showing {partOne} of {partTwo}",values:{partOne:c.a.createElement(In,null,`1-${Math.min(e.pageSize,e.totalItemCount)}`),partTwo:c.a.createElement(In,null,`${e.totalItemCount}`)}})))))),c.a.createElement(n.EuiFlexItem,{grow:!1},c.a.createElement(n.EuiText,{size:"s","data-test-subj":"exceptionsViewerLastUpdated"},c.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.exceptions.viewer.lastUpdated",defaultMessage:"Updated {updated}",values:{updated:c.a.createElement(Mn,null,c.a.createElement(S.b,{value:t,tooltipAnchorClassName:"eui-textTruncate"}))}}))));Fn.displayName="ExceptionsViewerUtilityComponent";const Dn=c.a.memo(Fn);Dn.displayName="ExceptionsViewerUtility";var An=a(190);const _n=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.editItemButton",{defaultMessage:"Edit rule exception"}),Nn=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.deleteItemButton",{defaultMessage:"Delete rule exception"}),Rn=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.endpoint.editItemButton",{defaultMessage:"Edit endpoint exception"}),Pn=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.endpoint.deleteItemButton",{defaultMessage:"Delete endpoint exception"}),Ln=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.createdLabel",{defaultMessage:"Created"}),Bn=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.updatedLabel",{defaultMessage:"Updated"}),qn=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.metaDetailsBy",{defaultMessage:"by"}),zn=e=>i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.showCommentsLabel",{values:{comments:e},defaultMessage:"Show {comments, plural, =1 {comment} other {comments}} ({comments})"}),$n=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.matchOperator",{defaultMessage:"IS"}),Vn=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.matchOperator.not",{defaultMessage:"IS NOT"}),Un=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.wildcardMatchesOperator",{defaultMessage:"MATCHES"}),Hn=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.wildcardDoesNotMatchOperator",{defaultMessage:"DOES NOT MATCH"}),Gn=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.nestedOperator",{defaultMessage:"has"}),Qn=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.matchAnyOperator",{defaultMessage:"is one of"}),Wn=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.matchAnyOperator.not",{defaultMessage:"is not one of"}),Kn=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.existsOperator",{defaultMessage:"exists"}),Yn=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.existsOperator.not",{defaultMessage:"does not exist"}),Jn=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.listOperator",{defaultMessage:"included in"}),Xn=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.listOperator.not",{defaultMessage:"is not included in"}),Zn=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.and",{defaultMessage:"AND"}),ei=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.os",{defaultMessage:"OS"}),ti=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.windows",{defaultMessage:"Windows"}),ai=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.linux",{defaultMessage:"Linux"}),ni=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.conditions.macos",{defaultMessage:"Mac"}),ii=i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.affectedList",{defaultMessage:"Affects shared list"}),ri=Object(l.memo)((({item:e,actions:t,disableActions:a=!1,dataTestSubj:i})=>{const[r,s]=Object(l.useState)(!1),o=()=>s(!1),u=Object(l.useMemo)((()=>t.map((e=>c.a.createElement(n.EuiContextMenuItem,{"data-test-subj":`${i}-actionItem-${e.key}`,key:e.key,icon:e.icon,onClick:()=>{o(),e.onClick()}},e.label)))),[i,t]);return c.a.createElement(n.EuiFlexGroup,{"data-test-subj":i,justifyContent:"spaceBetween"},c.a.createElement(n.EuiFlexItem,{grow:9},c.a.createElement(n.EuiTitle,{size:"xs",textTransform:"uppercase","data-test-subj":`${i}-title`},c.a.createElement("h3",null,e.name))),c.a.createElement(n.EuiFlexItem,{grow:!1},c.a.createElement(n.EuiPopover,{button:c.a.createElement(n.EuiButtonIcon,{isDisabled:a,"aria-label":"Exception item actions menu",iconType:"boxesHorizontal",onClick:()=>s((e=>!e)),"data-test-subj":`${i}-actionButton`}),panelPaddingSize:"none",isOpen:r,closePopover:o,"data-test-subj":`${i}-items`},c.a.createElement(n.EuiContextMenuPanel,{size:"s",items:u}))))}));ri.displayName="ExceptionItemCardHeader";var si=a(265);const oi=m.a.div.withConfig({displayName:"Container",componentId:"sc-hgc2b-0"})(["display:inline;margin-left:",";"],(({theme:e})=>`${e.eui.euiSizeXS}`)),li=({value:e,tooltipIconType:t="iInCircle",tooltipIconText:a})=>{const{showSpaceWarningIcon:i,warningText:r}=(({value:e,tooltipIconText:t})=>({showSpaceWarningIcon:!!(Array.isArray(e)?e.find(si.d):Object(si.d)(e)),warningText:t||si.c.FIELD_SPACE_WARNING}))({value:e,tooltipIconText:a});return i&&e?c.a.createElement(oi,null,c.a.createElement(n.EuiToolTip,{position:"top",content:r},c.a.createElement(n.EuiIcon,{"data-test-subj":"value_with_space_warning_tooltip",type:t,color:"warning"}))):null},ci=Object.freeze({linux:ai,mac:ni,macos:ni,windows:ti}),ui=Object.freeze({[g.d.NESTED]:Gn,[g.d.MATCH_ANY]:Qn,[g.d.MATCH]:$n,[g.d.WILDCARD]:Un,[g.d.EXISTS]:Kn,[g.d.LIST]:Jn}),di=Object.freeze({[g.d.MATCH_ANY]:Wn,[g.d.MATCH]:Vn,[g.d.WILDCARD]:Hn,[g.d.EXISTS]:Yn,[g.d.LIST]:Xn}),pi=m()(n.EuiFlexGroup).withConfig({displayName:"EuiFlexGroupNested",componentId:"sc-ob4wzw-0"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeXL)),mi=m()(n.EuiFlexItem).withConfig({displayName:"EuiFlexItemNested",componentId:"sc-ob4wzw-1"})(["margin-bottom:6px !important;margin-top:6px !important;"]),gi=m()("span").withConfig({displayName:"StyledCondition",componentId:"sc-ob4wzw-2"})(["margin-right:6px;"]),bi=m()(n.EuiPanel).withConfig({displayName:"StyledConditionContent",componentId:"sc-ob4wzw-3"})(["border:1px;border-color:#d3dae6;border-style:solid;"]),fi=Object(l.memo)((({os:e,entries:t,dataTestSubj:a})=>{const i=Object(l.useMemo)((()=>null!=e&&e.length>0?e.map((e=>{var t;return null!==(t=ci[e])&&void 0!==t?t:e})).join(", "):null),[e]),r=(e,t)=>"match_any"===e&&Array.isArray(t)?t.map((e=>c.a.createElement(n.EuiBadge,{color:"hollow"},e))):null!=t?t:"",s=(e,t)=>{var a,n;return"nested"===e?"":"included"===t?null!==(a=ui[e])&&void 0!==a?a:e:null!==(n=di[e])&&void 0!==n?n:e},o=Object(l.useCallback)(((e,t)=>{if("nested"===e&&t.length)return t.map((e=>{const{field:t,type:i,operator:o}=e,l="value"in e?e.value:"";return c.a.createElement(pi,{"data-test-subj":`${a}-nestedCondition`,key:t+i+l,direction:"row",alignItems:"center",gutterSize:"m",responsive:!1},c.a.createElement(mi,{grow:!1},c.a.createElement(n.EuiToken,{iconType:"tokenNested",size:"s"})),c.a.createElement(mi,{grow:!1},c.a.createElement(n.EuiExpression,{description:"",value:t,color:"subdued"})),c.a.createElement(mi,{grow:!1},c.a.createElement(n.EuiExpression,{description:s(i,o),value:r(i,l)})),c.a.createElement(li,{value:l}))}))}),[a]),u=Object(l.useCallback)((e=>"list"===e.type?e.list.id:"value"in e?e.value:""),[]);return c.a.createElement(bi,{color:"subdued",hasBorder:!0,hasShadow:!1,"data-test-subj":a},null!=i&&c.a.createElement("div",{"data-test-subj":`${a}-os`},c.a.createElement("strong",null,c.a.createElement(n.EuiExpression,{description:"",value:ei}),c.a.createElement(n.EuiExpression,{description:$n,value:i}))),t.map(((e,t)=>{const{field:i,type:l}=e,d=u(e),p="entries"in e?e.entries:[],m="operator"in e?e.operator:"";return c.a.createElement("div",{"data-test-subj":`${a}-condition`,key:i+l+d+t},c.a.createElement("div",{className:"eui-xScroll"},c.a.createElement(n.EuiExpression,{description:0===t?"":c.a.createElement(gi,null,Zn),value:i,color:0===t?"primary":"subdued"}),c.a.createElement(n.EuiExpression,{description:s(l,m),value:r(l,d)}),c.a.createElement(li,{value:d})),null!=p&&o(l,p))})))}));fi.displayName="ExceptionItemCardConditions";var yi=a(89);const hi=m()(n.EuiFlexItem).withConfig({displayName:"StyledFlexItem",componentId:"sc-16r4vsz-0"})(["border-right:1px solid #d3dae6;padding:4px 12px 4px 0;"]),Ei=Object(l.memo)((({item:e,listAndReferences:t,dataTestSubj:a})=>{const[r,s]=Object(l.useState)(!1),[o,u]=Object(l.useState)(!1),d=()=>u((e=>!e)),p=()=>s((e=>!e)),m=()=>u(!1),b=()=>s(!1),f=Object(l.useMemo)((()=>null==t?[]:t.referenced_rules.map((e=>c.a.createElement(n.EuiContextMenuItem,{"data-test-subj":`${a}-rulesAffected-${e.id}`,key:e.id},c.a.createElement(n.EuiToolTip,{content:e.name,anchorClassName:"eui-textTruncate"},c.a.createElement(yi.k,{"data-test-subj":"ruleName",deepLinkId:le.uc.rules,path:Object(w.c)(e.id,Gi.alerts),external:!0},e.name)))))),[t,a]),y=Object(l.useMemo)((()=>{var e,r;return null==t?c.a.createElement(c.a.Fragment,null):c.a.createElement(hi,{grow:!1},c.a.createElement(n.EuiPopover,{button:c.a.createElement(n.EuiButtonEmpty,{onClick:d,iconType:"list","data-test-subj":`${a}-affectedRulesButton`},(r=null!==(e=null==t?void 0:t.referenced_rules.length)&&void 0!==e?e:0,i.i18n.translate("xpack.securitySolution.ruleExceptions.exceptionItem.affectedRules",{values:{numRules:r},defaultMessage:"Affects {numRules} {numRules, plural, =1 {rule} other {rules}}"}))),panelPaddingSize:"none",isOpen:o,closePopover:m,"data-test-subj":`${a}-rulesPopover`,id:"rulesPopover"},c.a.createElement(n.EuiContextMenuPanel,{size:"s",items:f})))}),[t,a,o,f]),h=Object(l.useMemo)((()=>null==t?c.a.createElement(c.a.Fragment,null):t.type!==g.b.RULE_DEFAULT?c.a.createElement(n.EuiFlexItem,{grow:!1},c.a.createElement(n.EuiPopover,{button:c.a.createElement(n.EuiButtonEmpty,{onClick:p,iconType:"list","data-test-subj":`${a}-affectedListsButton`},ii),panelPaddingSize:"none",isOpen:r,closePopover:b,"data-test-subj":`${a}-listsPopover`,id:"listsPopover"},c.a.createElement(n.EuiContextMenuPanel,{size:"s",items:[c.a.createElement(n.EuiContextMenuItem,{"data-test-subj":`${a}-listsAffected-${t.id}`,key:t.id},c.a.createElement(n.EuiToolTip,{content:t.name,anchorClassName:"eui-textTruncate"},c.a.createElement(yi.k,{"data-test-subj":"ruleName",deepLinkId:le.uc.exceptions,path:`/details/${null==t?void 0:t.list_id}`,external:!0},t.name)))]}))):c.a.createElement(c.a.Fragment,null)),[t,a,r]);return c.a.createElement(n.EuiFlexGroup,{alignItems:"center",responsive:!1,gutterSize:"s","data-test-subj":a},c.a.createElement(hi,{grow:!1},c.a.createElement(vi,{fieldName:"created_by",label:Ln,value1:c.a.createElement(S.a,{fieldName:"created_at",value:e.created_at}),value2:e.created_by,dataTestSubj:`${a}-createdBy`})),c.a.createElement(hi,{grow:!1},c.a.createElement(vi,{fieldName:"updated_by",label:Bn,value1:c.a.createElement(S.a,{fieldName:"updated_at",value:e.updated_at}),value2:e.updated_by,dataTestSubj:`${a}-updatedBy`})),null!=t&&c.a.createElement(c.a.Fragment,null,y,h))}));Ei.displayName="ExceptionItemCardMetaInfo";const vi=Object(l.memo)((({label:e,value1:t,value2:a,dataTestSubj:i})=>c.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"s",wrap:!1,responsive:!1},c.a.createElement(n.EuiFlexItem,{grow:!1},c.a.createElement(n.EuiText,{size:"xs",style:{fontFamily:"Inter"}},e)),c.a.createElement(n.EuiFlexItem,{grow:!1,"data-test-subj":`${i}-value1`},c.a.createElement(n.EuiBadge,{color:"default",style:{fontFamily:"Inter"}},t)),c.a.createElement(n.EuiFlexItem,{grow:!1},c.a.createElement(n.EuiText,{size:"xs",style:{fontFamily:"Inter"}},qn)),c.a.createElement(n.EuiFlexItem,{grow:!1,"data-test-subj":`${i}-value2`},c.a.createElement(n.EuiFlexGroup,{responsive:!1,gutterSize:"xs",alignItems:"center",wrap:!1},c.a.createElement(n.EuiFlexItem,{grow:!1},c.a.createElement(n.EuiBadge,{color:"hollow",style:{fontFamily:"Inter"}},a)))))));vi.displayName="MetaInfoDetails";const xi=Object(l.memo)((({comments:e})=>{const{euiTheme:t}=Object(n.useEuiTheme)();return c.a.createElement(n.EuiFlexItem,null,c.a.createElement(n.EuiAccordion,{id:"exceptionItemCardComments",buttonContent:c.a.createElement(n.EuiText,{size:"s",style:{color:t.colors.primary}},zn(e.length)),arrowDisplay:"none","data-test-subj":"exceptionsViewerCommentAccordion"},c.a.createElement(n.EuiPanel,{hasBorder:!1,hasShadow:!1,paddingSize:"m"},c.a.createElement(n.EuiCommentList,{comments:e}))))}));xi.displayName="ExceptionItemCardComments";const ki=({disableActions:e,exceptionItem:t,isEndpoint:a,listAndReferences:i,onDeleteException:r,onEditException:s,dataTestSubj:o})=>{const u=Object(l.useCallback)((()=>{r({id:t.id,name:t.name,namespaceType:t.namespace_type})}),[r,t.id,t.name,t.namespace_type]),d=Object(l.useCallback)((()=>{s(t)}),[s,t]),p=Object(l.useMemo)((()=>Object(An.j)(t.comments)),[t.comments]);return c.a.createElement(n.EuiPanel,{paddingSize:"l","data-test-subj":o,hasBorder:!0,hasShadow:!1},c.a.createElement(n.EuiFlexGroup,{gutterSize:"m",direction:"column"},c.a.createElement(n.EuiFlexItem,{"data-test-subj":`${o}-header`},c.a.createElement(ri,{item:t,actions:[{key:"edit",icon:"controlsHorizontal",label:a?Rn:_n,onClick:d},{key:"delete",icon:"trash",label:a?Pn:Nn,onClick:u}],disableActions:e,dataTestSubj:"exceptionItemCardHeader"})),c.a.createElement(n.EuiFlexItem,{"data-test-subj":`${o}-meta`},c.a.createElement(Ei,{item:t,listAndReferences:i,dataTestSubj:"exceptionItemCardMetaInfo"})),c.a.createElement(n.EuiFlexItem,null,c.a.createElement(fi,{os:t.os_types,entries:t.entries,dataTestSubj:"exceptionItemCardConditions"})),p.length>0&&c.a.createElement(xi,{comments:p})))};ki.displayName="ExceptionItemCardComponent";const Si=c.a.memo(ki);Si.displayName="ExceptionItemCard";var ji=a(1065),Oi=a.n(ji);const wi=({isReadOnly:e,isEndpoint:t,currentState:a,onCreateExceptionListItem:i})=>{const{euiTheme:r}=Object(n.useEuiTheme)(),s=Object(l.useMemo)((()=>{switch(a){case"error":return c.a.createElement(n.EuiEmptyPrompt,{color:"danger",iconType:"alert",title:c.a.createElement("h2",null,dn),body:c.a.createElement("p",null,pn),"data-test-subj":"exceptionItemViewerEmptyPrompts-error"});case"empty":return c.a.createElement(n.EuiEmptyPrompt,{color:"subdued",iconType:"plusInCircle",iconColor:r.colors.darkestShade,title:c.a.createElement("h2",{"data-test-subj":"exceptionsEmptyPromptTitle"},sn),body:c.a.createElement("p",{"data-test-subj":"exceptionsEmptyPromptBody"},t?ln:on),actions:[c.a.createElement(n.EuiButton,{"data-test-subj":"exceptionsEmptyPromptButton",onClick:i,iconType:"plusInCircle",color:"primary",isDisabled:e,fill:!0},t?un:cn)],"data-test-subj":"exceptionItemViewerEmptyPrompts-empty"});case"empty_search":return c.a.createElement(n.EuiEmptyPrompt,{color:"plain",layout:"horizontal",hasBorder:!0,hasShadow:!1,icon:c.a.createElement(n.EuiImage,{size:"fullWidth",alt:"",url:Oi.a}),title:c.a.createElement("h3",null,nn),body:c.a.createElement("p",null,rn),"data-test-subj":"exceptionItemViewerEmptyPrompts-emptySearch"});default:return c.a.createElement(n.EuiLoadingContent,{lines:4,"data-test-subj":"exceptionItemViewerEmptyPrompts-loading"})}}),[a,r.colors.darkestShade,e,t,i]);return c.a.createElement(n.EuiPanel,{hasShadow:!1,hasBorder:!1,color:"empty_search"===a?"subdued":"transparent",style:{margin:`${r.size.l} 0`,padding:`${r.size.l} 0`}},s)},Ti=c.a.memo(wi);Ti.displayName="ExeptionItemsViewerEmptyPrompts";const Ii=m()(n.EuiFlexItem).withConfig({displayName:"MyFlexItem",componentId:"sc-1ti6dq3-0"})(["margin:",";&:first-child{margin:",";}"],(({theme:e})=>`${e.eui.euiSize} 0`),(({theme:e})=>`${e.eui.euiSizeXS} 0 ${e.eui.euiSize}`)),Ci=({isReadOnly:e,exceptions:t,isEndpoint:a,disableActions:i,ruleReferences:r,viewerState:s,onCreateExceptionListItem:o,onDeleteException:l,onEditExceptionItem:u})=>c.a.createElement(c.a.Fragment,null,null!=s&&"deleting"!==s?c.a.createElement(Ti,{isReadOnly:e,isEndpoint:a,currentState:s,onCreateExceptionListItem:o}):c.a.createElement(n.EuiFlexGroup,{direction:"column",className:"eui-yScrollWithShadows"},c.a.createElement(n.EuiFlexItem,{grow:!1,className:"eui-yScrollWithShadows"},c.a.createElement(n.EuiFlexGroup,{"data-test-subj":"exceptionsContainer",gutterSize:"none",direction:"column"},t.map((e=>c.a.createElement(Ii,{"data-test-subj":"exceptionItemContainer",grow:!1,key:e.id},c.a.createElement(Si,{disableActions:i,exceptionItem:e,isEndpoint:a,listAndReferences:null!=r?r[e.list_id]:null,onDeleteException:l,onEditException:u,dataTestSubj:"exceptionItemsViewerItem"}))))))));Ci.displayName="ExceptionItemsViewerComponent";const Mi=c.a.memo(Ci);Mi.displayName="ExceptionsViewerItems";var Fi=a(505),Di=a(345),Ai=a(657);const _i=m()(n.EuiText).withConfig({displayName:"StyledText",componentId:"sc-e71zkm-0"})(["font-style:italic;"]),Ni=["error","empty"],Ri=["loading","empty_search","empty","error","searching"],Pi={pagination:{pageIndex:0,pageSize:25,totalItemCount:0,pageSizeOptions:[5,10,25,50,100,200,300]},exceptions:[],exceptionToEdit:null,currenFlyout:null,viewerState:"loading",isReadOnly:!0,lastUpdated:Date.now()},Li=({rule:e,listTypes:t,isViewReadOnly:a,onRuleChange:r})=>{const{services:s}=Object(v.k)(),o=Object(v.o)(),[{canUserCRUD:u,hasIndexWrite:d}]=Object(X.b)(),p=Object(l.useMemo)((()=>null!=e&&null!=e.exceptions_list?e.exceptions_list.filter((({type:e})=>t.includes(e))):[]),[t,e]),m=Object(l.useMemo)((()=>p.map((({id:e,list_id:t,namespace_type:a})=>({id:e,listId:t,namespaceType:a})))),[p]),b=Object(l.useMemo)((()=>1===t.length&&t[0]===g.b.ENDPOINT),[t]),[{exceptions:f,pagination:y,currenFlyout:h,exceptionToEdit:E,viewerState:x,isReadOnly:k,lastUpdated:S},j]=Object(l.useReducer)(((e,t)=>{switch(t.type){case"setExceptions":{var a;const{exceptions:n,pagination:i}=t;return{...e,pagination:{...e.pagination,pageIndex:i.page-1,pageSize:i.perPage,totalItemCount:null!==(a=i.total)&&void 0!==a?a:0},exceptions:n}}case"updateExceptionToEdit":{const{exception:a}=t;return{...e,exceptionToEdit:a}}case"updateFlyoutOpen":return{...e,currenFlyout:t.flyoutType};case"setViewerState":return{...e,viewerState:t.state};case"setIsReadOnly":return{...e,isReadOnly:t.readOnly};case"setLastUpdateTime":return{...e,lastUpdated:t.lastUpdate};default:return e}}),{...Pi}),O=Object(l.useCallback)((e=>{j({type:"setLastUpdateTime",lastUpdate:e})}),[j]),w=Object(l.useCallback)((({exceptions:e,pagination:t})=>{O(Date.now()),j({type:"setExceptions",exceptions:e,pagination:t})}),[j,O]),T=Object(l.useCallback)((e=>{j({type:"setViewerState",state:e})}),[j]),I=Object(l.useCallback)((e=>{j({type:"updateFlyoutOpen",flyoutType:e})}),[j]),C=Object(l.useCallback)((e=>{j({type:"setIsReadOnly",readOnly:e})}),[j]),[M,F,D,A]=Object(Ai.a)();Object(l.useEffect)((()=>{null!=A&&m.length&&A(m)}),[m,A]),Object(l.useEffect)((()=>{F?T("error"):null==x&&M?T("loading"):"loading"!==x||M||T(null)}),[M,F,T,x]);const _=Object(l.useCallback)((async e=>{var t;const a=new AbortController,n=null!=(null==e?void 0:e.pagination)?{page:(null!==(t=e.pagination.page)&&void 0!==t?t:0)+1,perPage:e.pagination.perPage}:{page:y.pageIndex+1,perPage:y.pageSize};if(0===p.length)return{data:[],pageIndex:y.pageIndex,itemsPerPage:y.pageSize,total:0};const{page:i,per_page:r,total:o,data:l}=await Object(an.l)({filter:void 0,http:s.http,listIds:p.map((e=>e.list_id)),namespaceTypes:p.map((e=>e.namespace_type)),search:null==e?void 0:e.search,pagination:n,signal:a.signal});return{data:l.map((e=>Object(tn.b)(e))),pageIndex:i,itemsPerPage:r,total:o}}),[y.pageIndex,y.pageSize,p,s.http]),N=Object(l.useCallback)((async e=>{try{const{pageIndex:t,itemsPerPage:a,total:n,data:i}=await _(e);T(n>0?null:"empty"),w({exceptions:i,pagination:{page:t,perPage:a,total:n}}),T(n>0?null:"empty")}catch(e){T("error"),o.addError(e,{title:dn,toastMessage:pn})}}),[_,w,T,o]),R=Object(l.useCallback)((async e=>{try{T("searching");const{pageIndex:t,itemsPerPage:a,total:n,data:i}=await _(e);T(n>0?null:"empty_search"),w({exceptions:i,pagination:{page:t,perPage:a,total:n}})}catch(e){o.addError(e,{title:mn,toastMessage:gn})}}),[_,w,T,o]),P=Object(l.useCallback)((()=>{I("addException")}),[I]),L=Object(l.useCallback)((e=>{j({type:"updateExceptionToEdit",exception:e}),I("editException")}),[I]),B=Object(l.useCallback)((e=>{I(null),e&&null!=r&&r()}),[r,I]),q=Object(l.useCallback)((e=>{I(null),e&&null!=r&&r(),N()}),[I,N,r]),z=Object(l.useCallback)((async({id:e,name:t,namespaceType:a})=>{const n=new AbortController;try{T("deleting"),await Object(an.e)({http:s.http,id:e,namespaceType:a,signal:n.signal}),o.addSuccess({title:yn,text:(r=t,i.i18n.translate("xpack.securitySolution.ruleExceptions.allExceptionItems.exceptionItemDeleteSuccessText",{values:{itemName:r},defaultMessage:'"{itemName}" deleted successfully.'}))}),await N()}catch(e){T("error"),o.addError(e,{title:bn})}var r}),[N,s.http,T,o]);Object(l.useEffect)((()=>{C(a||!u||!d)}),[C,a,u,d]),Object(l.useEffect)((()=>{p.length>0?N():T("empty")}),[p.length,N,T]);const $=Object(l.useMemo)((()=>null!=D&&null!=E?D[E.list_id]:null),[D,E]);return c.a.createElement(c.a.Fragment,null,"editException"===h&&null!=$&&null!=E&&null!=e&&c.a.createElement(Fi.a,{rule:e,list:$,itemToEdit:E,showAlertCloseOptions:!0,onCancel:B,onConfirm:q,"data-test-subj":"editExceptionItemFlyout"}),"addException"===h&&null!=e&&c.a.createElement(Di.a,{rules:[e],isBulkAction:!1,isEndpointItem:b,onCancel:B,onConfirm:q,"data-test-subj":"addExceptionItemFlyout",showAlertCloseOptions:!0,isNonTimeline:!0}),c.a.createElement(n.EuiPanel,{hasBorder:!1,hasShadow:!1},c.a.createElement(c.a.Fragment,null,c.a.createElement(_i,{size:"s"},b?hn:En),c.a.createElement(n.EuiSpacer,{size:"l"}),!Ni.includes(x)&&c.a.createElement(On,{canAddException:k,isEndpoint:b,isSearching:"searching"===x,onSearch:R,onAddExceptionClick:P}),!Ri.includes(x)&&c.a.createElement(c.a.Fragment,null,c.a.createElement(n.EuiSpacer,{size:"l"}),c.a.createElement(Dn,{pagination:y,lastUpdated:S})),c.a.createElement(Mi,{isReadOnly:k,disableActions:k||"deleting"===x,exceptions:f,isEndpoint:b,ruleReferences:D,viewerState:x,onDeleteException:z,onEditExceptionItem:L,onCreateExceptionListItem:P}),!Ri.includes(x)&&c.a.createElement(Tn,{onPaginationChange:N,pagination:y}))))};Li.displayName="ExceptionsViewerComponent";const Bi=c.a.memo(Li);function qi({ruleId:e,disabled:t=!1,disabledReason:a}){const{application:{navigateToApp:i}}=Object(v.k)().services,r=Object(l.useCallback)((t=>{t.preventDefault(),i(le.B,{deepLinkId:we.a.rules,path:Object(w.b)(e)})}),[i,e]);return c.a.createElement(n.EuiToolTip,{position:"top",content:a},c.a.createElement(yi.l,{"data-test-subj":"editRuleSettingsLink",onClick:r,iconType:"controlsHorizontal",isDisabled:t,deepLinkId:we.a.rules,path:Object(w.b)(e)},he.Bb))}Bi.displayName="ExceptionsViewer";var zi=a(828),$i=a(889),Vi=a(890);const Ui=m.a.div.withConfig({displayName:"StyledFullHeightContainer",componentId:"sc-1m4bij9-0"})(["display:flex;flex-direction:column;flex:1 1 auto;"]),Hi=m.a.div.withConfig({displayName:"StyledMinHeightTabContainer",componentId:"sc-1m4bij9-1"})(["min-height:800px;"]);let Gi;!function(e){e.alerts="alerts",e.exceptions="rule_exceptions",e.endpointExceptions="endpoint_exceptions",e.executionResults="execution_results",e.executionEvents="execution_events"}(Gi||(Gi={}));const Qi={[Gi.alerts]:Ba.a,[Gi.exceptions]:Ua,[Gi.endpointExceptions]:Ha,[Gi.executionResults]:Ga,[Gi.executionEvents]:Qa},Wi=({clearEventsDeleted:e,clearEventsLoading:t,clearSelected:a})=>{var p,m,F,D,A;const{data:_,application:{navigateToApp:N,capabilities:{actions:R}},timelines:P,spaces:L}=Object(v.k)().services,B=Object(d.useDispatch)(),q=Object(l.useRef)(null),z=Object(l.useMemo)((()=>O.b.getTableByIdSelector()),[]),$=Object(E.b)((e=>{var t;return(null!==(t=z(e,x.g.alertsOnRuleDetailsPage))&&void 0!==t?t:j.a).graphEventId})),V=Object(E.b)((e=>{var t;return(null!==(t=z(e,x.g.alertsOnRuleDetailsPage))&&void 0!==t?t:j.a).updated})),U=Object(E.b)((e=>{var t;return(null!==(t=z(e,x.g.alertsOnAlertsPage))&&void 0!==t?t:j.a).isLoading})),H=Object(l.useMemo)((()=>se.d.globalFiltersQuerySelector()),[]),G=Object(l.useMemo)((()=>se.d.globalQuerySelector()),[]),Q=Object(E.a)(G),W=Object(E.a)(H),{to:ce,from:ue}=Object(re.a)(),[{loading:de,isSignalIndexExists:pe,isAuthenticated:me,hasEncryptionKey:be,canUserCRUD:fe,hasIndexWrite:ye,hasIndexRead:Ee,hasIndexMaintenance:ve,signalIndexName:xe}]=Object(X.b)(),{loading:Ae,needsConfiguration:_e}=Object(C.a)(),{indexPattern:Re,runtimeMappings:Pe,loading:Le}=Object(Me.d)(Fe.SourcererScopeName.detections),Be=de||Ae,{detailName:qe}=Object(u.useParams)(),{rule:ze,refresh:$e,loading:Ve,isExistingRule:Ue}=Object(Ja.a)(qe),{pollForSignalIndex:He}=Object(Za.a)(),[Ge,Qe]=Object(l.useState)(null),We=Ve&&null==Ge,{starting:Ke,startMlJobs:Ye}=Object(zi.a)(),Je=Object(l.useCallback)((async()=>{await Ye(null==Ge?void 0:Ge.machine_learning_job_id)}),[Ge,Ye]),Xe=Object(l.useMemo)((()=>({[Gi.alerts]:{id:Gi.alerts,name:Qi[Gi.alerts],disabled:!1,href:`/rules/id/${qe}/${Gi.alerts}`},[Gi.exceptions]:{id:Gi.exceptions,name:Qi[Gi.exceptions],disabled:null==Ge,href:`/rules/id/${qe}/${Gi.exceptions}`},[Gi.endpointExceptions]:{id:Gi.endpointExceptions,name:Qi[Gi.endpointExceptions],disabled:null==Ge,href:`/rules/id/${qe}/${Gi.endpointExceptions}`},[Gi.executionResults]:{id:Gi.executionResults,name:Qi[Gi.executionResults],disabled:!Ue,href:`/rules/id/${qe}/${Gi.executionResults}`},[Gi.executionEvents]:{id:Gi.executionEvents,name:Qi[Gi.executionEvents],disabled:!Ue,href:`/rules/id/${qe}/${Gi.executionEvents}`}})),[Ue,Ge,qe]),[Ze,et]=Object(l.useState)(Xe),{aboutRuleData:tt,modifiedAboutRuleDetailsData:at,defineRuleData:nt,scheduleRuleData:it}=null!=Ge?Object(ie.g)({rule:Ge,detailsView:!0}):{aboutRuleData:null,modifiedAboutRuleDetailsData:null,defineRuleData:null,scheduleRuleData:null},[rt,st]=Object(l.useState)();Object(l.useEffect)((()=>{(async()=>{if(null!=(null==nt?void 0:nt.dataViewId)&&""!==(null==nt?void 0:nt.dataViewId)){const e=await _.dataViews.get(null==nt?void 0:nt.dataViewId);st(e.title)}})()}),[_.dataViews,null==nt?void 0:nt.dataViewId]);const[ot,lt]=Object(l.useState)(!1),[ct,ut]=Object(l.useState)(!1),dt=Object(Se.a)(),{globalFullScreen:pt}=Object(Te.a)(),[mt,gt]=Object(l.useState)(Xa.b),[bt,ft]=Object(l.useState)({}),{isSavedQueryLoading:yt,savedQueryBar:ht}=Object(qa.a)(null==Ge?void 0:Ge.saved_id,{ruleType:null==Ge?void 0:Ge.type}),[Et]=Object(v.q)(le.S),[vt]=Object(v.q)(le.eb);Object(l.useEffect)((()=>{(async()=>{const e=await _.dataViews.getIdsWithTitle();if(e.length>0){const t=e.reduce(((e,t)=>({...e,[t.id]:t})),{});ft(t)}})()}),[_.dataViews]);const xt=Object(Oe.a)(dt)&&Object(je.a)(dt),kt=Object(l.useMemo)((()=>!(null!=(null==Ge?void 0:Ge.actions)&&(null==Ge?void 0:Ge.actions.length)>0&&Object(ge.d)(R.show))||R.show),[R,null==Ge?void 0:Ge.actions]),St=Object(l.useCallback)((()=>{N(le.B,{deepLinkId:we.a.rules,path:Object(w.c)(null!=qe?qe:"","alerts","")})}),[N,qe]);Object(l.useEffect)((()=>{null!=ze&&Qe(ze)}),[ze]),Object(l.useEffect)((()=>{if(Ge){const e=Ge.outcome;if(L&&"aliasMatch"===e){const e=`rules/id/${Ge.id}${window.location.search}${window.location.hash}`;L.ui.redirectLegacyUrl({path:e,aliasPurpose:Ge.alias_purpose,objectNoun:i.i18n.translate("xpack.triggersActionsUI.sections.ruleDetails.redirectObjectNoun",{defaultMessage:"rule"})})}}}),[Ge,L]);const jt=Object(l.useMemo)((()=>{if(null!=(null==Ge?void 0:Ge.alias_target_id)&&L&&"conflict"===Ge.outcome){const e=Ge.alias_target_id,t=`rules/id/${e}${window.location.search}${window.location.hash}`;return c.a.createElement(c.a.Fragment,null,c.a.createElement(n.EuiSpacer,null),L.ui.components.getLegacyUrlConflict({objectNoun:i.i18n.translate("xpack.triggersActionsUI.sections.ruleDetails.redirectObjectNoun",{defaultMessage:"rule"}),currentObjectId:Ge.id,otherObjectId:e,otherObjectPath:t}))}return null}),[Ge,L]),Ot=(()=>{const e=Object(Nt.a)("extendedRuleExecutionLoggingEnabled"),t=Rt(le.Eb,!1),a=Rt(le.Fb,Ne.c.off);return Object(l.useMemo)((()=>({extendedLogging:{isEnabled:e&&t,minLevel:a}})),[e,t,a])})();Object(l.useEffect)((()=>{const e=[];var t;(Ee||e.push(Gi.alerts),Ot.extendedLogging.isEnabled||e.push(Gi.executionEvents),null!=Ge)&&((null!==(t=Ge.exceptions_list)&&void 0!==t?t:[]).some((e=>e.type===g.b.ENDPOINT))||e.push(Gi.endpointExceptions));const a=Object(o.omit)(e,Xe);et(a)}),[Ee,Ge,Xe,Ot]);const wt=Object(l.useMemo)((()=>Le||U||Be),[Le,U,Be]),Tt=Object(l.useMemo)((()=>c.a.createElement(c.a.Fragment,null,null==Ge?void 0:Ge.name," ",Ve&&c.a.createElement(n.EuiLoadingSpinner,{size:"m"}))),[Ge,Ve]),It=Object(l.useMemo)((()=>Ve||Ue?void 0:{text:Wa,color:"default"}),[Ue,Ve]),Ct=Object(l.useMemo)((()=>{var e,t,a,i;return Ge?[c.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.ruleDetails.ruleCreationDescription",defaultMessage:"Created by: {by} on {date}",values:{by:null!==(e=null==Ge?void 0:Ge.created_by)&&void 0!==e?e:Va,date:c.a.createElement(S.a,{value:null!==(t=null==Ge?void 0:Ge.created_at)&&void 0!==t?t:(new Date).toISOString(),fieldName:"createdAt"})}}),null!=(null==Ge?void 0:Ge.updated_by)?c.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.ruleDetails.ruleUpdateDescription",defaultMessage:"Updated by: {by} on {date}",values:{by:null!==(a=null==Ge?void 0:Ge.updated_by)&&void 0!==a?a:Va,date:c.a.createElement(S.a,{value:null!==(i=null==Ge?void 0:Ge.updated_at)&&void 0!==i?i:(new Date).toISOString(),fieldName:"updatedAt"})}}):""]:Ve?c.a.createElement(n.EuiLoadingSpinner,{size:"m"}):null}),[Ge,Ve]),Mt=Object(l.useCallback)((n=>{const i=x.g.alertsOnRuleDetailsPage;t({id:i}),e({id:i}),a({id:i}),gt(n)}),[t,e,a,gt]);Object(l.useEffect)((()=>{lt(null!=(null==Ge?void 0:Ge.building_block_type))}),[Ge]);const Ft=Object(l.useMemo)((()=>{var e;return[...Object(te.c)(null!==(e=null==Ge?void 0:Ge.rule_id)&&void 0!==e?e:""),...Object(te.d)(ot),...Object(te.a)(mt),...Object(te.e)(ct)]}),[Ge,ot,ct,mt]),Dt=Object(l.useMemo)((()=>{var e;return[...Object(te.c)(null!==(e=null==Ge?void 0:Ge.rule_id)&&void 0!==e?e:""),...Object(te.d)(ot),...Object(te.e)(ct)]}),[Ge,ot,ct]),_t=Object(l.useMemo)((()=>[...Ft,...W]),[Ft,W]),Pt=null==Ge||null===(p=Ge.execution_summary)||void 0===p?void 0:p.last_execution,Lt=null==Pt?void 0:Pt.status,Bt=null!==(m=null==Pt?void 0:Pt.date)&&void 0!==m?m:"",qt=null!==(F=null==Pt?void 0:Pt.message)&&void 0!==F?F:"",zt=Object(l.useMemo)((()=>Ve?c.a.createElement(n.EuiFlexItem,null,c.a.createElement(n.EuiLoadingSpinner,{size:"m","data-test-subj":"rule-status-loader"})):c.a.createElement(De.a,{status:Lt,date:Bt},c.a.createElement(n.EuiButtonIcon,{"data-test-subj":"refreshButton",color:"primary",onClick:$e,iconType:"refresh","aria-label":he.Yb,isDisabled:!Ue}))),[Lt,Bt,Ve,Ue,$e]),$t=Object(l.useMemo)((()=>Ve?c.a.createElement(n.EuiFlexItem,null,c.a.createElement(n.EuiLoadingSpinner,{size:"m","data-test-subj":"rule-status-loader"})):c.a.createElement(De.c,{status:Lt,date:Bt,message:qt})),[Lt,Bt,qt,Ve]),Vt=Object(l.useCallback)((({x:e})=>{if(!e)return;const[t,a]=e;B(Object(oe.setAbsoluteRangeDatePicker)({id:h.a.global,from:new Date(t).toISOString(),to:new Date(a).toISOString()}))}),[B]),Ut=Object(l.useCallback)((e=>{Qe((t=>t?{...t,enabled:e}:t))}),[]),Ht=Object(l.useCallback)((e=>{lt(e)}),[lt]),Gt=Object(l.useCallback)((e=>{ut(e)}),[ut]),Qt=Object(l.useCallback)((()=>{Object(Ce.j)(q.current)}),[q]),Wt=Object(l.useCallback)((()=>{Object(Ce.m)()}),[]),Yt=Object(l.useCallback)((e=>{Object(b.isTab)(e)&&Object(Ce.l)({containerElement:q.current,keyboardEvent:e,onSkipFocusBeforeEventsTable:Qt,onSkipFocusAfterEventsTable:Wt})}),[q,Qt,Wt]),{isBulkDuplicateConfirmationVisible:Jt,showBulkDuplicateConfirmation:Xt,cancelRuleDuplication:Zt,confirmRuleDuplication:ea}=Object($i.a)();return Object(ie.h)(pe,me,be,_e)?(N(le.B,{deepLinkId:we.a.alerts,path:Object(w.a)()}),null):c.a.createElement(c.a.Fragment,null,c.a.createElement(Ka.a,null),c.a.createElement(Ya.a,null),Jt&&c.a.createElement(Vi.a,{onCancel:Zt,onConfirm:ea,rulesCount:1}),c.a.createElement(Ui,{onKeyDown:Yt,ref:q},c.a.createElement(n.EuiWindowEvent,{event:"resize",handler:o.noop}),c.a.createElement(k.a,{show:Object(Ce.n)({globalFullScreen:pt,graphEventId:$})},c.a.createElement(T.a,{id:h.a.global,pollForSignalIndex:He,indexPattern:Re})),c.a.createElement(Kt,null,c.a.createElement(I.a,{noPadding:pt},c.a.createElement(Ie.a,{show:!pt},c.a.createElement(en.a,{backOptions:{path:Object(w.e)(),text:za,pageId:we.a.rules,dataTestSubj:"ruleDetailsBackToAllRules"},border:!0,subtitle:Ct,subtitle2:c.a.createElement(c.a.Fragment,null,c.a.createElement(n.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",justifyContent:"flexStart"},c.a.createElement(n.EuiFlexItem,{grow:!1},De.d.STATUS,":"),zt)),title:Tt,badgeOptions:It},c.a.createElement(n.EuiFlexGroup,{alignItems:"center"},c.a.createElement(n.EuiFlexItem,{grow:!1},c.a.createElement(n.EuiToolTip,{position:"top",content:Object(ge.b)(Ge,xt,kt,fe)},c.a.createElement(n.EuiFlexGroup,null,c.a.createElement(ae.a,{id:null!==(D=null==Ge?void 0:Ge.id)&&void 0!==D?D:"-1",isDisabled:!Ue||!Object(ge.a)(Ge,kt)||!Object(ge.c)(fe)||Object(f.d)(null==Ge?void 0:Ge.type)&&!xt,enabled:Ue&&null!==(A=null==Ge?void 0:Ge.enabled)&&void 0!==A&&A,startMlJobsIfNeeded:Je,onChange:Ut}),c.a.createElement(n.EuiFlexItem,null,$a)))),c.a.createElement(n.EuiFlexItem,{grow:!1},c.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1},c.a.createElement(n.EuiFlexItem,{grow:!1},c.a.createElement(qi,{ruleId:qe,disabled:!Ue||!Object(ge.c)(fe)||Object(f.d)(null==Ge?void 0:Ge.type)&&!xt,disabledReason:Object(ge.b)(Ge,xt,kt,fe)})),c.a.createElement(n.EuiFlexItem,{grow:!1},c.a.createElement(ke,{rule:Ge,userHasPermissions:Ue&&Object(ge.c)(fe),canDuplicateRuleWithActions:Object(ge.a)(Ge,kt),showBulkDuplicateExceptionsConfirmation:Xt})))))),$t,jt,c.a.createElement(n.EuiSpacer,null),c.a.createElement(n.EuiFlexGroup,null,c.a.createElement(n.EuiFlexItem,{"data-test-subj":"aboutRule",component:"section",grow:1},c.a.createElement(K,{loading:We,stepData:tt,stepDataDetails:at})),c.a.createElement(n.EuiFlexItem,{grow:1},c.a.createElement(n.EuiFlexGroup,{direction:"column"},c.a.createElement(n.EuiFlexItem,{component:"section",grow:1,"data-test-subj":"defineRule"},c.a.createElement(ne.a,{loading:We||yt,title:he.sb},null!=nt&&!yt&&!Ke&&c.a.createElement(Z.b,{descriptionColumns:"singleSplit",isReadOnlyView:!0,isLoading:!1,defaultValues:{dataViewTitle:rt,...nt,queryBar:null!=ht?ht:nt.queryBar},kibanaDataViews:bt,indicesConfig:Et,threatIndicesConfig:vt}))),c.a.createElement(n.EuiSpacer,null),c.a.createElement(n.EuiFlexItem,{"data-test-subj":"schedule",component:"section",grow:1},c.a.createElement(ne.a,{loading:We,title:he.Fc},null!=it&&c.a.createElement(ee.a,{descriptionColumns:"singleSplit",isReadOnlyView:!0,isLoading:!1,defaultValues:it})))))),c.a.createElement(n.EuiSpacer,null),c.a.createElement(y.a,{navTabs:Ze}),c.a.createElement(n.EuiSpacer,null)),c.a.createElement(Hi,null,c.a.createElement(u.Switch,null,c.a.createElement(r.Route,{path:`/rules/id/:detailName/:tabName(${Gi.alerts})`},c.a.createElement(c.a.Fragment,null,c.a.createElement(n.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween"},c.a.createElement(n.EuiFlexItem,{grow:!1},c.a.createElement(Xa.a,{status:mt,onFilterGroupChanged:Mt})),c.a.createElement(n.EuiFlexItem,{grow:!1},V&&P.getLastUpdated({updatedAt:V||Date.now(),showUpdating:wt}))),c.a.createElement(n.EuiSpacer,{size:"l"}),c.a.createElement(Ie.a,{show:!pt},c.a.createElement(Y.a,{filters:_t,query:Q,signalIndexName:xe,defaultStackByOption:"event.category",updateDateRange:Vt,runtimeMappings:Pe}),c.a.createElement(n.EuiSpacer,null)),null!=qe&&c.a.createElement(J.a,{filterGroup:mt,tableId:x.g.alertsOnRuleDetailsPage,defaultFilters:Dt,hasIndexWrite:null!=ye&&ye,hasIndexMaintenance:null!=ve&&ve,from:ue,loading:Be,showBuildingBlockAlerts:ot,showOnlyThreatIndicatorAlerts:ct,onShowBuildingBlockAlertsChanged:Ht,onShowOnlyThreatIndicatorAlertsChanged:Gt,onRuleChange:$e,to:ce}))),c.a.createElement(r.Route,{path:`/rules/id/:detailName/:tabName(${Gi.exceptions})`},c.a.createElement(Bi,{rule:Ge,listTypes:[g.b.DETECTION,g.b.RULE_DEFAULT],onRuleChange:$e,isViewReadOnly:!Ue,"data-test-subj":"exceptionTab"})),c.a.createElement(r.Route,{path:`/rules/id/:detailName/:tabName(${Gi.endpointExceptions})`},c.a.createElement(Bi,{rule:Ge,listTypes:[g.b.ENDPOINT],onRuleChange:$e,isViewReadOnly:!Ue,"data-test-subj":"endpointExceptionsTab"})),c.a.createElement(r.Route,{path:`/rules/id/:detailName/:tabName(${Gi.executionResults})`},c.a.createElement(La,{ruleId:qe,selectAlertsTab:St})),c.a.createElement(r.Route,{path:`/rules/id/:detailName/:tabName(${Gi.executionEvents})`},c.a.createElement(At,{ruleId:qe}))))))),c.a.createElement(M.a,{pageName:we.a.rules,state:{ruleName:null==Ge?void 0:Ge.name}}))},Ki=Object(d.connect)(null,(e=>({clearSelected:({id:t})=>e(O.a.clearSelected({id:t})),clearEventsLoading:({id:t})=>e(O.a.clearEventsLoading({id:t})),clearEventsDeleted:({id:t})=>e(O.a.clearEventsDeleted({id:t}))})));Wi.displayName="RuleDetailsPageComponent";const Yi=Ki(c.a.memo(Wi));Yi.displayName="RuleDetailsPage"},function(e,t,a){"use strict";a.d(t,"a",(function(){return H}));var n=a(34),i=a(32),r=a(4),s=a.n(r),o=a(33),l=a.n(o),c=a(88),u=a(104);const d="destination.ip",p="destination.port",m="event.category",g="file.name",b="host.name",f="kibana.alert.rule.name",y="kibana.alert.severity",h="process.parent.name",E="process.name",v="source.ip",x="source.port",k="user.name",S=[d,p,g,E,h,v,x],j=l()(i.EuiFlexGroup).withConfig({displayName:"AlertFieldFlexGroup",componentId:"sc-16po602-0"})(["flex-grow:0;gap:","px;"],(({$scopeId:e})=>e===u.d.active?0:3)),O=({contextId:e,eventId:t,field:a,fieldType:n="keyword",isAggregatable:r=!0,isDraggable:o,showSeparator:l,scopeId:u,value:d})=>s.a.createElement(j,{alignItems:"center","data-test-subj":"alertFieldBadge",$scopeId:u,gutterSize:"none"},s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(c.c,{contextId:`${e}-alert-field`,eventId:t,field:a,fieldType:n,isAggregatable:r,isDraggable:o,scopeId:u,value:d})),l&&s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement("span",{"data-test-subj":"separator"},", ")));O.displayName="AlertFieldBadgeComponent";const w=s.a.memo(O),T=({contextId:e,"data-test-subj":t="alertField",eventId:a,field:n,fieldType:r="keyword",isAggregatable:o=!0,isDraggable:l,prefix:c,suffix:u,scopeId:d,values:p})=>null!=p?s.a.createElement(j,{alignItems:"center","data-test-subj":t,$scopeId:d,gutterSize:"none"},null!=c&&s.a.createElement(i.EuiFlexItem,{"data-test-subj":"prefix",grow:!1},c),p.map(((t,c)=>s.a.createElement(i.EuiFlexItem,{key:`${t}-${c}`,grow:!1},s.a.createElement(w,{contextId:`${e}-alert-field`,eventId:a,field:n,fieldType:r,isAggregatable:o,isDraggable:l,showSeparator:c<p.length-1,scopeId:d,value:t})))),null!=u&&s.a.createElement(i.EuiFlexItem,{"data-test-subj":"suffix",grow:!1},u)):null;T.displayName="AlertFieldComponent";const I=s.a.memo(T);var C=a(97),M=a(223),F=a(0);const D=F.i18n.translate("xpack.securitySolution.renderers.alertRenderer.alertLabel",{defaultMessage:"alert"}),A=F.i18n.translate("xpack.securitySolution.renderers.alertRenderer.byLabel",{defaultMessage:"by"}),_=F.i18n.translate("xpack.securitySolution.renderers.alertRenderer.createdLabel",{defaultMessage:"created"}),N=F.i18n.translate("xpack.securitySolution.renderers.alertRenderer.destinationLabel",{defaultMessage:"destination"}),R=F.i18n.translate("xpack.securitySolution.renderers.alertRenderer.eventLabel",{defaultMessage:"event"}),P=F.i18n.translate("xpack.securitySolution.renderers.alertRenderer.fileLabel",{defaultMessage:"file"}),L=F.i18n.translate("xpack.securitySolution.renderers.alertRenderer.onLabel",{defaultMessage:"on"}),B=F.i18n.translate("xpack.securitySolution.renderers.alertRenderer.parentProcessLabel",{defaultMessage:"parent process"}),q=F.i18n.translate("xpack.securitySolution.renderers.alertRenderer.processLabel",{defaultMessage:"process"}),z=F.i18n.translate("xpack.securitySolution.renderers.alertRenderer.sourceLabel",{defaultMessage:"source"}),$=F.i18n.translate("xpack.securitySolution.renderers.alertRenderer.withLabel",{defaultMessage:"with"}),V=l()(i.EuiFlexGroup).withConfig({displayName:"AlertRendererFlexGroup",componentId:"sc-jss410-0"})(["gap:",";"],(({theme:e})=>e.eui.euiSizeXS)),U={id:u.b.alert,isInstance:e=>{return null!==(a=null==(t=Object(n.get)("event.kind",e))?void 0:t.some((e=>null!=e.toLocaleLowerCase&&"signal"===e.toLowerCase())))&&void 0!==a&&a;var t,a},renderRow:({contextId:e="alert-renderer",data:t,isDraggable:a,scopeId:r})=>{const o=Object(n.get)("_id",t),l=Object(n.get)(d,t),c=Object(n.get)(p,t),u=Object(n.get)(m,t),j=Object(n.get)(g,t),O=Object(n.get)(b,t),w=Object(n.get)(f,t),T=Object(n.get)(y,t),F=Object(n.get)(E,t),U=Object(n.get)(h,t),H=Object(n.get)(v,t),G=Object(n.get)(x,t),Q=Object(n.get)(k,t);return s.a.createElement(M.a,null,s.a.createElement(C.b,{"data-test-subj":"alertRenderer"},s.a.createElement(V,{alignItems:"center",gutterSize:"none",justifyContent:"center",wrap:!0},s.a.createElement(I,{contextId:e,"data-test-subj":m,eventId:o,field:m,isDraggable:a,scopeId:r,values:u}),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement("span",{"data-test-subj":"event"},` ${R} `)),(({data:e,fieldNames:t})=>t.some((t=>Object(n.has)(t,e))))({data:t,fieldNames:S})&&s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement("span",{"data-test-subj":"with"},` ${$} `)),s.a.createElement(I,{contextId:e,"data-test-subj":E,eventId:o,field:E,isDraggable:a,prefix:` ${q} `,suffix:", ",scopeId:r,values:F}),s.a.createElement(I,{contextId:e,"data-test-subj":h,eventId:o,field:h,isDraggable:a,prefix:` ${B} `,suffix:", ",scopeId:r,values:U}),s.a.createElement(I,{contextId:e,"data-test-subj":g,eventId:o,field:g,isDraggable:a,prefix:` ${P} `,suffix:", ",scopeId:r,values:j}),s.a.createElement(I,{contextId:e,"data-test-subj":v,eventId:o,field:v,isDraggable:a,prefix:` ${z} `,scopeId:r,values:H}),s.a.createElement(I,{contextId:e,"data-test-subj":x,eventId:o,field:x,isDraggable:a,prefix:":",suffix:", ",scopeId:r,values:G}),s.a.createElement(I,{contextId:e,"data-test-subj":d,eventId:o,field:d,isDraggable:a,prefix:` ${N} `,scopeId:r,values:l}),s.a.createElement(I,{contextId:e,"data-test-subj":p,eventId:o,field:p,isDraggable:a,prefix:":",suffix:", ",scopeId:r,values:c}),s.a.createElement(I,{contextId:e,"data-test-subj":k,eventId:o,field:k,isDraggable:a,prefix:` ${A} `,scopeId:r,values:Q}),s.a.createElement(I,{contextId:e,"data-test-subj":b,eventId:o,field:b,isDraggable:a,prefix:` ${L} `,scopeId:r,values:O}),s.a.createElement(I,{contextId:e,"data-test-subj":y,eventId:o,field:y,isDraggable:a,prefix:` ${_} `,suffix:` ${D} `,scopeId:r,values:T}),s.a.createElement(I,{contextId:e,"data-test-subj":f,eventId:o,field:f,isDraggable:a,suffix:".",scopeId:r,values:w}))))}},H=({data:e,rowRenderers:t})=>{var a;const n=null!==(a=t.find((t=>t.isInstance(e))))&&void 0!==a?a:null;return U.isInstance(e)?null!=n?(({a:e,b:t,id:a})=>({id:a,isInstance:a=>e.isInstance(a)||t.isInstance(a),renderRow:({contextId:a,data:n,isDraggable:i,scopeId:r})=>s.a.createElement(s.a.Fragment,null,e.isInstance(n)&&e.renderRow({contextId:a,data:n,isDraggable:i,scopeId:r}),t.isInstance(n)&&t.renderRow({contextId:a,data:n,isDraggable:i,scopeId:r}))}))({a:U,b:n,id:n.id}):U:n}},,function(e,t,a){"use strict";a.d(t,"a",(function(){return B}));var n,i=a(32),r=a(34),s=a(4),o=a.n(s),l=a(33),c=a.n(l),u=a(45),d=a(48),p=a(911),m=a(296),g=a(77),b=a(695),f=a(62),y=a(157),h=a(518),E=a(825),v=a(378),x=a(469);!function(e){e.info="info",e.warning="warning",e.error="error"}(n||(n={}));const k=({message:e})=>{if(!e)return null;let t="primary",a="alert";return e.level===n.info?a="iInCircle":e.level===n.warning?t="warning":e.level===n.error&&(t="danger"),o.a.createElement(i.EuiToolTip,{content:e.text},o.a.createElement(i.EuiIcon,{type:a,color:t}))},S=o.a.memo(k),j=({job:e})=>{const t=Object(y.c)(e.jobState,e.datafeedState),a=t?"success":"danger",n=t?x.h:x.i;return o.a.createElement(i.EuiBadge,{"data-test-subj":"machineLearningJobStatus",color:a},n)},O=o.a.memo(j),w=c()(i.EuiLink).withConfig({displayName:"JobLink",componentId:"sc-c3w1h4-0"})(["margin-right:",";"],(({theme:e})=>e.eui.euiSizeS)),T=c.a.div.withConfig({displayName:"Wrapper",componentId:"sc-c3w1h4-1"})(["overflow:hidden;"]),I=({job:e,loading:t,refreshJob:a})=>{const{services:{http:n,ml:r}}=Object(g.k)(),{enableDatafeed:l,isLoading:c}=Object(h.a)(),u=e.id,d=Object(f.useMlHref)(r,n.basePath.get(),{page:f.ML_PAGES.ANOMALY_DETECTION_JOBS_MANAGE,pageState:{jobId:[u]}}),p=o.a.createElement("span",{"data-test-subj":"machineLearningJobId"},u),m=Object(y.c)(e.jobState,e.datafeedState),b=Object(s.useCallback)((async(t,n,i)=>{await l(e,n,i),a(e)}),[l,e,a]);return o.a.createElement(T,null,o.a.createElement("div",null,o.a.createElement(w,{href:d,target:"_blank"},p),o.a.createElement(S,{message:e.auditMessage})),o.a.createElement(i.EuiFlexGroup,{justifyContent:"flexStart"},o.a.createElement(i.EuiFlexItem,{grow:!1,style:{marginRight:"0"}},o.a.createElement(O,{job:e})),o.a.createElement(i.EuiFlexItem,{grow:!1},o.a.createElement(E.a,{job:e,isSecurityJobsLoading:t||c,onJobStateChange:b})),o.a.createElement(i.EuiFlexItem,{grow:!1,style:{marginLeft:"0"}},m?x.k:x.j)))},C=o.a.memo(I),M=({jobIds:e})=>{const{loading:t,jobs:a,refetch:n}=Object(v.a)(),i=a.filter((t=>e.includes(t.id)));return o.a.createElement(o.a.Fragment,null,i.map((e=>o.a.createElement(C,{key:e.id,job:e,loading:t,refreshJob:n}))))},F=({actions:e})=>e.length?o.a.createElement("ul",null,e.map(((e,t)=>o.a.createElement("li",{key:t},D(e.actionTypeId))))):null,D=e=>{if(!e)return"";const t=e.split(".")[1];return t?Object(r.startCase)(t):""};var A=a(566);const _=(e=A.a.value,t)=>{const a=Object(r.find)(["value",e],A.c);return{title:t,description:a?a.text:e}};var N=a(415),R=a(13);const P=c()(i.EuiDescriptionList).withConfig({displayName:"DescriptionListContainer",componentId:"sc-1jqwta0-0"})(["&.euiDescriptionList--column .euiDescriptionList__title{width:30%;}&.euiDescriptionList--column .euiDescriptionList__description{width:70%;overflow-wrap:anywhere;}"]),L=({data:e,columns:t="multi",indexPatterns:a,schema:n})=>{const l=Object(g.k)(),c=Object(R.b)(),[u]=Object(s.useState)(new d.FilterManager(l.services.uiSettings)),p=Object.keys(n).reduce(((t,i)=>{return"machineLearningJobId"===i?[...t,(s=Object(r.get)(i,e),l=Object(r.get)(i,n).label,{title:l,description:o.a.createElement(M,{jobIds:s})})]:"throttle"===i?[...t,_(Object(r.get)(i,e),Object(r.get)([i,"label"],n))]:"actions"===i?[...t,(d=Object(r.get)(i,e),p=Object(r.get)([i,"label"],n),{title:d.length?p:"",description:o.a.createElement(F,{actions:d})})]:[...t,...q(e,Object(r.pick)(i,n),u,c,a)];var s,l,d,p}),[]);return"multi"===t?o.a.createElement(i.EuiFlexGroup,null,Object(r.chunk)(Math.ceil(p.length/2),p).map(((e,t)=>o.a.createElement(i.EuiFlexItem,{"data-test-subj":"listItemColumnStepRuleDescription",key:`description-step-rule-${t}`},o.a.createElement(i.EuiDescriptionList,{listItems:e}))))):o.a.createElement(i.EuiFlexGroup,null,o.a.createElement(i.EuiFlexItem,{"data-test-subj":"listItemColumnStepRuleDescription"},"single"===t?o.a.createElement(i.EuiDescriptionList,{listItems:p}):o.a.createElement(P,{"data-test-subj":"singleSplitStepRuleDescriptionList",type:"column",listItems:p})))},B=Object(s.memo)(L),q=(e,t,a,n,i)=>Object.keys(t).reduce(((s,o)=>[...s,...$(o,Object(r.get)([o,"label"],t),e,a,n,i)]),[]),z=e=>e.map((e=>null==e.$state?{$state:{store:u.FilterStateStore.APP_STATE},...e}:e)),$=(e,t,a,n,i,s)=>{if("queryBar"===e){var o;const t=z(null!==(o=Object(r.get)("queryBar.filters",a))&&void 0!==o?o:[]),i=Object(r.get)("queryBar.query.query",a),l=Object(r.get)("queryBar.saved_id",a),c=Object(r.get)("queryBar.title",a);return Object(b.d)({field:e,filters:t,filterManager:n,query:i,savedId:l,savedQueryName:c,indexPatterns:s})}if("groupByFields"===e){const n=Object(r.get)(e,a);return Object(b.a)(t,n,i)}if("eqlOptions"===e){const t=Object(r.get)(e,a);return Object(b.b)(t)}if("threat"===e){const n=Object(r.get)(e,a);return Object(b.j)({label:t,threat:Object(N.a)(n)})}if("threshold"===e){const n=Object(r.get)(e,a);return Object(b.l)(t,n)}if("references"===e){const n=Object(r.get)(e,a);return Object(b.n)(t,n)}if("falsePositives"===e){const n=Object(r.get)(e,a);return Object(b.m)(t,e,n)}if("riskScore"===e){const t=Object(r.get)(e,a);return Object(b.f)(t)}if("severity"===e){const t=Object(r.get)(e,a);return Object(b.h)(t)}if("requiredFields"===e){const n=Object(r.get)(e,a);return Object(b.e)(t,n)}if("relatedIntegrations"===e){const n=Object(r.get)(e,a);return Object(p.b)(t,n)}var l;if("timeline"===e)return[{title:t,description:null!==(l=Object(r.get)(e,a).title)&&void 0!==l?l:m.b}];if("note"===e){const n=Object(r.get)(e,a);return Object(b.c)(t,n)}if("ruleType"===e){const n=Object(r.get)(e,a);return Object(b.g)(t,n)}if("kibanaSiemAppUrl"===e)return[];if("threatQueryBar"===e){var c;const t=z(null!==(c=Object(r.get)("threatQueryBar.filters",a))&&void 0!==c?c:[]),i=Object(r.get)("threatQueryBar.query.query",a),o=Object(r.get)("threatQueryBar.saved_id",a);return Object(b.d)({field:e,filters:t,filterManager:n,query:i,savedId:o,indexPatterns:s,queryLabel:x.t})}if("threatMapping"===e){const n=Object(r.get)(e,a);return Object(b.k)(t,n)}if("dataViewId"===e)return[];if(Array.isArray(Object(r.get)(e,a))&&"threatMapping"!==e){const n=Object(r.get)(e,a);return Object(b.i)(t,e,n)}if("index"===e&&Object(r.get)("dataViewId",a))return[];const u=Object(r.get)(e,a);return Object(r.isNumber)(u)||!Object(r.isEmpty)(u)?[{title:t,description:u}]:[]}},function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var n=a(4),i=a(34),r=a(1),s=a(366),o=a(259),l=a(84),c=a(77),u=a(507);const d=["siem_cloudtrail","siem_packetbeat","security_auth","security_linux_v3","security_network","security_windows_v3"],p=(e,t,a)=>{const n=t.find((t=>t.id===e));return void 0!==n?{moduleId:n.moduleId,defaultIndexPattern:n.defaultIndexPattern,isCompatible:a.includes(n.moduleId),isElasticJob:!0}:{moduleId:"",defaultIndexPattern:"",isCompatible:!0,isElasticJob:!1}};var m=a(120),g=a(389),b=a(534);const f=()=>{const[e,t]=Object(n.useState)([]),[a,f]=Object(n.useState)(!0),y=Object(m.a)(),[h]=Object(c.q)(r.S),E=Object(c.j)(),{addError:v}=Object(l.a)(),x=Object(n.useRef)(i.noop),k=Object(s.a)(y),S=Object(o.a)(y);return Object(n.useEffect)((()=>{let e=!0;const a=new AbortController;async function n(){if(f(!0),k&&S)try{const[n,i,r]=await Promise.all([Object(b.a)({http:E,signal:a.signal}),Object(u.b)({signal:a.signal}),Object(u.a)({indexPatternName:h,signal:a.signal})]),s=((e,t,a)=>{const n=a.map((e=>e.id)),i=((e,t)=>e.filter((e=>d.includes(e.id))).map((e=>[...e.jobs.map((a=>((e,t,a)=>({datafeedId:"",datafeedIndices:[],datafeedState:"",hasDatafeed:!1,isSingleMetricViewerJob:!1,jobState:"closed",memory_status:"",processed_record_count:0,id:t.id,description:t.config.description,groups:[...t.config.groups].sort(),defaultIndexPattern:e.defaultIndexPattern,moduleId:e.id,isCompatible:a,isInstalled:!1,isElasticJob:!0,awaitingNodeAssignment:!1,jobTags:{},bucketSpanSeconds:900}))(e,a,t.includes(e.id))))])).flat())(t,n),r=((e,t,a)=>e.filter((({groups:e})=>e.includes("siem")||e.includes("security"))).map((e=>({...e,...p(e.id,t,a),isInstalled:!0}))))(e,i,n);return((e,t)=>{const a=e.map((e=>e.id));return[...e,...t.filter((e=>!a.includes(e.id)))].sort(((e,t)=>e.id.localeCompare(t.id)))})(r,i)})(n,i,r);e&&t(s)}catch(t){e&&v(t,{title:g.a})}e&&f(!1)}return n(),x.current=n,()=>{e=!1,a.abort()}}),[k,S,h,v,E]),{isLicensed:S,isMlAdmin:k,jobs:e,loading:a,refetch:x.current}}},function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return E}));var n=a(78),i=a(105);function r(e){return Object(n.useSelector)((function(t){return e(t[i.u][i.t])}))}var s=a(4),o=a.n(s),l=a(35),c=a(64),u=a(116),d=a(691),p=a(107),m=a(1),g=a(153),b=a(280),f=a(240),y=a(191),h=a(653);const E=(e,t)=>{const{getAppUrl:a}=Object(f.b)(),n=r(b.agentPolicies),i=r(b.uiQueryParams),E=Object(d.c)(),v=Object(p.a)("responseActionsConsoleEnabled"),{canAccessResponseConsole:x,canIsolateHost:k,canUnIsolateHost:S,canAccessEndpointActionsLogManagement:j}=Object(u.a)().endpointPrivileges;return Object(s.useMemo)((()=>{if(e){const r=Object(y.b)(e),s=e.agent.id,u=e.Endpoint.policy.applied.id,d=e.host.hostname,p=e.elastic.agent.id,b=Object(h.a)({osName:e.host.os.name,version:e.agent.version,capabilities:e.Endpoint.capabilities}),{show:f,selected_endpoint:O,...w}=i,T=Object(g.d)({name:"endpointActivityLog",...w,selected_endpoint:s}),I=Object(g.d)({name:"endpointIsolate",...w,selected_endpoint:s}),C=Object(g.d)({name:"endpointUnIsolate",...w,selected_endpoint:s}),M=[];return r&&S?M.push({"data-test-subj":"unIsolateLink",icon:"lockOpen",key:"unIsolateHost",navigateAppId:m.B,navigateOptions:{path:C},href:a({path:C}),children:o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.unIsolateHost",defaultMessage:"Release host"})}):b&&k&&M.push({"data-test-subj":"isolateLink",icon:"lock",key:"isolateHost",navigateAppId:m.B,navigateOptions:{path:I},href:a({path:I}),children:o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.isolateHost",defaultMessage:"Isolate host"})}),[...M,...v&&x?[{"data-test-subj":"console",icon:"console",key:"consoleLink",onClick:t=>{t.preventDefault(),E(e)},children:o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.console",defaultMessage:"Respond"})}]:[],...null!=t&&t.isEndpointList&&j?[{"data-test-subj":"actionsLink",icon:"logoSecurity",key:"actionsLogLink",navigateAppId:m.B,navigateOptions:{path:T},href:a({path:T}),children:o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.responseActionsHistory",defaultMessage:"View response actions history"})}]:[],{"data-test-subj":"hostLink",icon:"logoSecurity",key:"hostDetailsLink",navigateAppId:m.B,navigateOptions:{path:`/hosts/${d}`},href:a({path:`/hosts/${d}`}),children:o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.hostDetails",defaultMessage:"View host details"})},{icon:"gear",key:"agentConfigLink","data-test-subj":"agentPolicyLink",navigateAppId:"fleet",navigateOptions:{path:`${c.pagePathGetters.policy_details({policyId:n[u]})[1]}`},href:`${a({appId:"fleet"})}${c.pagePathGetters.policy_details({policyId:n[u]})[1]}`,disabled:void 0===n[u],children:o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.agentPolicy",defaultMessage:"View agent policy"})},{icon:"gear",key:"agentDetailsLink","data-test-subj":"agentDetailsLink",navigateAppId:"fleet",navigateOptions:{path:`${c.pagePathGetters.agent_details({agentId:p})[1]}`},href:`${a({appId:"fleet"})}${c.pagePathGetters.agent_details({agentId:p})[1]}`,children:o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.agentDetails",defaultMessage:"View agent details"})},{icon:"gear",key:"agentPolicyReassignLink","data-test-subj":"agentPolicyReassignLink",navigateAppId:"fleet",navigateOptions:{path:`${c.pagePathGetters.agent_details({agentId:p})[1]}?openReassignFlyout=true`},href:`${a({appId:"fleet"})}${c.pagePathGetters.agent_details({agentId:p})[1]}?openReassignFlyout=true`,children:o.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.agentPolicyReassign",defaultMessage:"Reassign agent policy"})}]}return[]}),[i,x,j,e,n,a,v,E,null==t?void 0:t.isEndpointList,k,S])}},function(e,t,a){"use strict";a.d(t,"a",(function(){return x}));var n=a(4),i=a.n(n),r=a(92),s=a.n(r),o=a(77),l=a(183),c=a(904),u=a(32),d=a(34),p=a(37),m=a(17),g=a(14);const b=({disabled:e,hrefWithSearch:t,id:a,name:r,isSelected:s,isBeta:l,betaOptions:c})=>{var d;const{getAppUrl:p,navigateTo:b}=Object(o.m)(),f=Object(n.useCallback)((e=>{e.preventDefault(),b({path:t}),Object(m.e)(m.a.CLICK,`${m.b.TAB_CLICKED}${a}`)}),[b,t,a]),y=p({path:t});return i.a.createElement(u.EuiTab,{"data-href":y,"data-test-subj":`navigation-${a}`,disabled:e,isSelected:s,href:y,onClick:f,append:l&&i.a.createElement(u.EuiBetaBadge,{label:null!==(d=null==c?void 0:c.text)&&void 0!==d?d:g.a,size:"s"})},r)},f=i.a.memo(b),y=({navTabs:e,tabName:t})=>{const a=Object(n.useCallback)((()=>Object(d.getOr)("","id",Object.values(e).find((e=>t===e.id)))),[t,e]),[r,s]=Object(n.useState)(a());Object(n.useEffect)((()=>{const e=a();e!==r&&s(e)}),[t,e,a,r]);const{search:o}=Object(p.useLocation)(),l=Object(n.useMemo)((()=>Object.values(e).map((e=>{const t=r===e.id;return i.a.createElement(f,{key:`navigation-${e.id}`,id:e.id,hrefWithSearch:e.href+o,name:e.name,disabled:e.disabled,isSelected:t,isBeta:e.isBeta,betaOptions:e.betaOptions})}))),[e,r,o]);return i.a.createElement(u.EuiTabs,null,l)};y.displayName="TabNavigationComponent";const h=i.a.memo(y,((e,t)=>e.display===t.display&&e.tabName===t.tabName&&s()(e.navTabs,t.navTabs)));h.displayName="TabNavigation";const E=i.a.memo((({detailName:e,display:t,flowTarget:a,navTabs:r,pageName:s,pathName:l,search:u,state:d,tabName:p})=>{const{chrome:m,application:{getUrlForApp:g,navigateToUrl:b}}=Object(o.k)().services,f=Object(c.a)();return Object(n.useEffect)((()=>{(l||s)&&f({detailName:e,flowTarget:a,navTabs:r,pageName:s,pathName:l,search:u,state:d,tabName:p},m,b)}),[m,s,l,u,r,d,e,a,p,g,b,f]),i.a.createElement(h,{display:t,navTabs:r,pageName:s,pathName:l,tabName:p})}));E.displayName="TabNavigationComponent";const v=i.a.memo(E,((e,t)=>e.pathName===t.pathName&&e.search===t.search&&s()(e.navTabs,t.navTabs)&&s()(e.state,t.state))),x=i.a.memo((e=>{const[t]=Object(l.a)(),a={...t,...e};return i.a.createElement(v,a)}),((e,t)=>s()(e.navTabs,t.navTabs)));x.displayName="SecuritySolutionTabNavigation"},,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"d",(function(){return r})),a.d(t,"e",(function(){return s})),a.d(t,"f",(function(){return o})),a.d(t,"b",(function(){return l})),a.d(t,"g",(function(){return c})),a.d(t,"h",(function(){return u})),a.d(t,"c",(function(){return d}));var n=a(0);const i=n.i18n.translate("xpack.securitySolution.notes.addNoteButtonLabel",{defaultMessage:"Add Note"}),r=n.i18n.translate("xpack.securitySolution.notes.noteLabel",{defaultMessage:"Note"}),s=n.i18n.translate("xpack.securitySolution.notes.notesTitle",{defaultMessage:"Notes"}),o=n.i18n.translate("xpack.securitySolution.notes.search.FilterByUserOrNotePlaceholder",{defaultMessage:"Filter by User or Note"}),l=n.i18n.translate("xpack.securitySolution.notes.cancelButtonLabel",{defaultMessage:"Cancel"}),c=n.i18n.translate("xpack.securitySolution.notes.youAreEditingANoteScreenReaderOnly",{defaultMessage:"You are editing a note. Click Add Note when finished, or press escape to cancel."}),u=e=>n.i18n.translate("xpack.securitySolution.notes.youAreViewingNotesScreenReaderOnly",{values:{row:e},defaultMessage:"You are viewing notes for the event in row {row}. Press the up arrow key when finished to return to the event."}),d=n.i18n.translate("xpack.securitySolution.notes.createdByLabel",{defaultMessage:"Created by"})},function(e,t,a){"use strict";a.d(t,"c",(function(){return i})),a.d(t,"e",(function(){return r})),a.d(t,"d",(function(){return s})),a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return l}));var n=a(142);const i=()=>({windows:{events:{dll_and_driver_load:!0,dns:!0,file:!0,network:!0,process:!0,registry:!0,security:!0},malware:{mode:n.e.prevent,blocklist:!0},ransomware:{mode:n.e.prevent,supported:!0},memory_protection:{mode:n.e.prevent,supported:!0},behavior_protection:{mode:n.e.prevent,supported:!0},popup:{malware:{message:"",enabled:!0},ransomware:{message:"",enabled:!0},memory_protection:{message:"",enabled:!0},behavior_protection:{message:"",enabled:!0}},logging:{file:"info"},antivirus_registration:{enabled:!1},attack_surface_reduction:{credential_hardening:{enabled:!0}}},mac:{events:{process:!0,file:!0,network:!0},malware:{mode:n.e.prevent,blocklist:!0},behavior_protection:{mode:n.e.prevent,supported:!0},memory_protection:{mode:n.e.prevent,supported:!0},popup:{malware:{message:"",enabled:!0},behavior_protection:{message:"",enabled:!0},memory_protection:{message:"",enabled:!0}},logging:{file:"info"}},linux:{events:{process:!0,file:!0,network:!0,session_data:!1,tty_io:!1},malware:{mode:n.e.prevent,blocklist:!0},behavior_protection:{mode:n.e.prevent,supported:!0},memory_protection:{mode:n.e.prevent,supported:!0},popup:{malware:{message:"",enabled:!0},behavior_protection:{message:"",enabled:!0},memory_protection:{message:"",enabled:!0}},logging:{file:"info"}}}),r=(e=i())=>{const t={rollback:{self_healing:{enabled:!1}}};return{...e,windows:{...e.windows,advanced:void 0===e.windows.advanced?void 0:{...e.windows.advanced,alerts:void 0===e.windows.advanced.alerts?{...t}:{...e.windows.advanced.alerts,...t}},ransomware:{mode:n.e.off,supported:!1},memory_protection:{mode:n.e.off,supported:!1},behavior_protection:{mode:n.e.off,supported:!1},attack_surface_reduction:{credential_hardening:{enabled:!1}},popup:{...e.windows.popup,malware:{message:"",enabled:!0},ransomware:{message:"",enabled:!1},memory_protection:{message:"",enabled:!1},behavior_protection:{message:"",enabled:!1}}},mac:{...e.mac,behavior_protection:{mode:n.e.off,supported:!1},memory_protection:{mode:n.e.off,supported:!1},popup:{...e.mac.popup,malware:{message:"",enabled:!0},memory_protection:{message:"",enabled:!1},behavior_protection:{message:"",enabled:!1}}},linux:{...e.linux,behavior_protection:{mode:n.e.off,supported:!1},memory_protection:{mode:n.e.off,supported:!1},popup:{...e.linux.popup,malware:{message:"",enabled:!0},memory_protection:{message:"",enabled:!1},behavior_protection:{message:"",enabled:!1}}}}},s=(e=i())=>({...e,windows:{...e.windows,ransomware:{...e.windows.ransomware,supported:!0},memory_protection:{...e.windows.memory_protection,supported:!0},behavior_protection:{...e.windows.behavior_protection,supported:!0}},mac:{...e.mac,behavior_protection:{...e.windows.behavior_protection,supported:!0},memory_protection:{...e.mac.memory_protection,supported:!0}},linux:{...e.linux,behavior_protection:{...e.windows.behavior_protection,supported:!0},memory_protection:{...e.linux.memory_protection,supported:!0}}}),o="Elastic Security {action} {filename}",l="Elastic Security {action} {rule}"},function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"e",(function(){return l})),a.d(t,"f",(function(){return c})),a.d(t,"d",(function(){return u})),a.d(t,"c",(function(){return d})),a.d(t,"b",(function(){return p}));var n=a(37),i=a(108),r=a(105);const s=e=>e.artifacts.location,o=e=>{var t;return null===(t=e.location)||void 0===t?void 0:t.pathname},l=Object(i.createSelector)(o,(e=>null!==Object(n.matchPath)(null!=e?e:"",{path:r.n,exact:!0}))),c=Object(i.createSelector)(o,(e=>null!==Object(n.matchPath)(null!=e?e:"",{path:r.q,exact:!0}))),u=Object(i.createSelector)(o,(e=>null!==Object(n.matchPath)(null!=e?e:"",{path:r.m,exact:!0}))),d=Object(i.createSelector)(o,(e=>null!==Object(n.matchPath)(null!=e?e:"",{path:r.o,exact:!0}))),p=Object(i.createSelector)(o,(e=>null!==Object(n.matchPath)(null!=e?e:"",{path:r.l,exact:!0})))},function(e,t,a){"use strict";a.d(t,"a",(function(){return f})),a.d(t,"c",(function(){return y})),a.d(t,"b",(function(){return h})),a.d(t,"d",(function(){return v}));var n=a(32),i=a(4),r=a.n(i),s=a(33),o=a.n(s),l=a(78),c=a(79),u=a(86),d=a(81),p=a(242),m=a(210),g=a(112);o()(n.EuiBadge).withConfig({displayName:"NotesCountBadge",componentId:"sc-mazy8j-0"})(["margin-left:5px;"]).displayName="NotesCountBadge";const b=({timelineId:e})=>{const t=Object(l.useDispatch)(),a=Object(i.useMemo)((()=>u.b.getTimelineByIdSelector()),[]),s=Object(d.b)((t=>{var n;return(null!==(n=a(t,e))&&void 0!==n?n:g.b).isFavorite})),o=Object(d.b)((t=>{var n;return(null!==(n=a(t,e))&&void 0!==n?n:g.b).status}))===c.l.immutable,m=Object(i.useCallback)((()=>t(u.a.updateIsFavorite({id:e,isFavorite:!s}))),[t,e,s]);return r.a.createElement(n.EuiButton,{isSelected:s,fill:s,iconType:s?"starFilled":"starEmpty",onClick:m,"data-test-subj":`timeline-favorite-${s?"filled":"empty"}-star`,disabled:o},s?p.j:p.b)};b.displayName="AddToFavoritesButtonComponent";const f=r.a.memo(b),y=r.a.memo((({closeGearMenu:e,outline:t=!1,timelineId:a,title:n=p.h})=>{const{getButton:i}=Object(m.b)({timelineId:a,timelineType:c.n.default,closeGearMenu:e});return i({outline:t,title:n})}));y.displayName="NewTimeline";const h="notes-button",E=r.a.memo((({ariaLabel:e=p.i,isDisabled:t,toggleShowNotes:a,timelineType:i})=>{const s=i===c.n.template;return r.a.createElement(n.EuiButtonIcon,{"aria-label":e,className:h,"data-test-subj":"timeline-notes-button-small",disabled:t,iconType:"editorComment",onClick:a,size:"s",isDisabled:s})}));E.displayName="SmallNotesButton";const v=r.a.memo((({ariaLabel:e,isDisabled:t,showNotes:a,timelineType:i,toggleShowNotes:s,toolTip:o})=>a?r.a.createElement(E,{ariaLabel:e,isDisabled:t,toggleShowNotes:s,timelineType:i}):r.a.createElement(n.EuiToolTip,{content:o||"","data-test-subj":"timeline-notes-tool-tip"},r.a.createElement(E,{ariaLabel:e,isDisabled:t,toggleShowNotes:s,timelineType:i}))));v.displayName="NotesButton"},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=e=>{const t=Object.entries(e);if(Array.isArray(t[0])){const[[e,a]]=t;return[e,a]}return[null,null]}},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=a(0).i18n.translate("xpack.securitySolution.components.mlPopup.hooks.errors.siemJobFetchFailureTitle",{defaultMessage:"Security job fetch failure"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));var n=a(4),i=a.n(n),r=a(34),s=a(40),o=a(633);const{euiColorVis0:l,euiColorVis5:c,euiColorVis7:u,euiColorVis9:d}=s.euiLightVars,p={low:l,medium:c,high:u,critical:d},m=({value:e})=>{var t;const a=Object(r.upperFirst)(e),n=null!==(t=p[e])&&void 0!==t?t:"subdued";return i.a.createElement(o.a,{healthColor:n,tooltipContent:a,dataTestSubj:"severity"},a)},g=i.a.memo(m)},function(e,t){const a=/^[0-9]+$/,n=(e,t)=>{const n=a.test(e),i=a.test(t);return n&&i&&(e=+e,t=+t),e===t?0:n&&!i?-1:i&&!n?1:e<t?-1:1};e.exports={compareIdentifiers:n,rcompareIdentifiers:(e,t)=>n(t,e)}},function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return u})),a.d(t,"c",(function(){return d}));var n=a(39),i=a(4),r=a(1),s=a(138),o=a(353);const l=["GET",r.qb],c=(e,t)=>Object(n.useQuery)([...l,e],(async({signal:t})=>{const a=await Object(s.f)({signal:t,...e});return{rules:a.data,total:a.total}}),{...o.a,...t}),u=()=>{const e=Object(n.useQueryClient)();return Object(i.useCallback)((()=>{e.invalidateQueries(l,{refetchType:"active"})}),[e])},d=()=>{const e=Object(n.useQueryClient)();return Object(i.useCallback)((t=>{e.setQueriesData(l,(e=>e?{rules:p(e.rules,t),total:e.total}:void 0))}),[e])};function p(e,t){const a=new Map(t.map((e=>[e.id,e])));return e.some((e=>a.has(e.id)))?e.map((e=>{var t;return null!==(t=a.get(e.id))&&void 0!==t?t:e})):e}},function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));var n=a(82),i=a.n(n),r=a(4),s=a.n(r),o=a(32),l=a(33),c=a.n(l),u=a(243),d=a(91);const p=c()(o.EuiContextMenuItem).withConfig({displayName:"StyledEuiContextMenuItem",componentId:"sc-gn0u4-0"})([".additional-info{display:none;max-width:50%;}&:hover{.additional-info{display:block !important;}}"]),m=c()("div").withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-gn0u4-1"})(["max-width:50%;padding-right:10px;"]),g=Object(r.memo)((({navigateAppId:e,navigateOptions:t,onClick:a,textTruncate:n,hoverInfo:l,children:c,...g})=>{const b=Object(u.a)(null!=e?e:"",{...t,onClick:a}),f=Object(d.a)(g["data-test-subj"]),y=Object(r.useMemo)((()=>{const e="additional-info "+("object"!=typeof l?"eui-textTruncate":"");return l?s.a.createElement(m,{className:e},l):null}),[l]);return s.a.createElement(p,i()({},g,{onClick:e?b:a}),s.a.createElement(o.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},n?s.a.createElement(s.a.Fragment,null,s.a.createElement("div",i()({className:"eui-textTruncate","data-test-subj":f("truncateWrapper")},"string"==typeof c?{title:c}:{}),c),y):s.a.createElement(s.a.Fragment,null,s.a.createElement(o.EuiFlexItem,null,c),y)))}));g.displayName="EuiContextMenuItemNavByRouter"},function(e,t,a){"use strict";a.d(t,"c",(function(){return l})),a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return u}));var n=a(39),i=a(77),r=a(105),s=a(373),o=a(687);function l({onError:e,page:t,perPage:a}={page:1,perPage:r.c}){const s=Object(i.j)();return Object(n.useQuery)(["endpointSpecificPolicies",t,a],(()=>Object(o.a)(s,{query:{page:t,perPage:a}})),e?{onError:e}:void 0)}function c({agentPolicyIds:e,customQueryOptions:t}){const a=Object(i.j)();return Object(n.useQuery)(["endpointCountForPolicy",e],(()=>Object(s.b)(a,e)),t)}function u({customQueryOptions:e}){const t=Object(i.j)();return Object(n.useQuery)(["endpointPackageVersion",e],(()=>Object(s.d)(t)),e)}},,function(e,t,a){"use strict";a.d(t,"b",(function(){return p})),a.d(t,"a",(function(){return m}));var n=a(4),i=a.n(n),r=a(32),s=a(0);s.i18n.translate("xpack.securitySolution.firstLastSeenHost.errorSearchDescription",{defaultMessage:"An error has occurred on first last seen host search"});const o=s.i18n.translate("xpack.securitySolution.firstLastSeenHost.failSearchDescription",{defaultMessage:"Failed to run search on first last seen host"});var l=a(130),c=a(85),u=a(87),d=a(101);let p;!function(e){e.FIRST_SEEN="first-seen",e.LAST_SEEN="last-seen"}(p||(p={}));const m=i.a.memo((({indexPatterns:e,field:t,type:a,value:s})=>{const[m,{firstSeen:g,lastSeen:b,errorMessage:f}]=(({field:e,value:t,order:a,defaultIndex:i})=>{const{loading:r,result:s,search:u,error:d}=Object(l.a)({factoryQueryType:c.d,initialResult:{firstSeen:null,lastSeen:null},errorMessage:o});return Object(n.useEffect)((()=>{u({defaultIndex:i,factoryQueryType:c.d,field:e,value:t,order:a})}),[i,e,t,a,u]),[r,Object(n.useMemo)((()=>({firstSeen:s.firstSeen,lastSeen:s.lastSeen,errorMessage:d?d.toString():null})),[s,d])]})({field:t,value:s,order:a===p.FIRST_SEEN?c.b.asc:c.b.desc,defaultIndex:e}),y=Object(n.useMemo)((()=>a===p.FIRST_SEEN?g:b),[g,b,a]);return null!=f?i.a.createElement(r.EuiToolTip,{position:"top",content:f,"data-test-subj":"firstLastSeenErrorToolTip","aria-label":`firstLastSeenError-${a}`,id:`firstLastSeenError-${t}-${a}`},i.a.createElement(r.EuiIcon,{"aria-describedby":`firstLastSeenError-${t}-${a}`,type:"alert"})):i.a.createElement(i.a.Fragment,null,m&&i.a.createElement(r.EuiLoadingSpinner,{"data-test-subj":"loading-spinner",size:"m"}),m||null==y||"Invalid Date"!==new Date(y).toString()?!m&&null!==y&&i.a.createElement(r.EuiText,{"data-test-subj":"first-last-seen-value",size:"s"},i.a.createElement(d.b,{value:`${y}`})):y,!m&&null===y&&Object(u.d)())}));m.displayName="FirstLastSeen"},,function(e,t,a){"use strict";a.d(t,"b",(function(){return m})),a.d(t,"a",(function(){return g.a}));var n=a(82),i=a.n(n),r=a(4),s=a.n(r),o=a(34),l=a(32),c=a(696);const u=({disableLinks:e,href:t,target:a,children:n,...i})=>s.a.createElement(l.EuiToolTip,{content:t},s.a.createElement(l.EuiLink,{href:e?void 0:t,"data-test-subj":"markdown-link",rel:"nofollow",target:"_blank"},n)),d=Object(r.memo)(u),p=({children:e,disableLinks:t})=>{const a=Object(r.useMemo)((()=>e=>s.a.createElement(d,i()({},e,{disableLinks:t}))),[t]),n=Object(o.cloneDeep)(c.b);return n[1][1].components.a=a,s.a.createElement(l.EuiMarkdownFormat,{parsingPluginList:c.a,processingPluginList:n},e)};p.displayName="MarkdownRendererComponent";const m=Object(r.memo)(p);var g=a(458);a(459)},function(e,t,a){"use strict";a.d(t,"k",(function(){return u})),a.d(t,"l",(function(){return p})),a.d(t,"i",(function(){return m})),a.d(t,"g",(function(){return g})),a.d(t,"h",(function(){return b})),a.d(t,"m",(function(){return f})),a.d(t,"c",(function(){return h})),a.d(t,"j",(function(){return k})),a.d(t,"d",(function(){return S})),a.d(t,"e",(function(){return j})),a.d(t,"f",(function(){return O})),a.d(t,"b",(function(){return w})),a.d(t,"a",(function(){return T})),a.d(t,"n",(function(){return I}));var n=a(37),i=a(108),r=a(19),s=a(385),o=a(105),l=a(591),c=a(386);const u=e=>e.policyItem,d=Object(i.createSelector)(u,(e=>e.license),((e,t)=>{if(e){const a=((e,t)=>Object(r.b)(t,"platinum")?Object(s.d)(e):Object(s.e)(e))(e.inputs[0].config.policy.value,t);return{...e,inputs:[{...e.inputs[0],config:{...e.inputs[0].config,policy:{...e.inputs[0].config.policy,value:a}}}]}}return e})),p=Object(i.createSelector)(d,(e=>{if(e)return Object(l.a)(e)})),m=e=>!e.policyItem&&!e.apiError,g=e=>Object(c.e)(e)||Object(c.f)(e)||Object(c.d)(e)||Object(c.c)(e)||Object(c.b)(e),b=e=>e.license,f=Object(i.createSelector)((e=>e.location),(e=>{var t,a,i,r;return null!==(t=null===(a=Object(n.matchPath)(null!==(r=null==e?void 0:e.pathname)&&void 0!==r?r:"",{path:[o.n,o.q,o.m,o.o,o.l],exact:!0}))||void 0===a||null===(i=a.params)||void 0===i?void 0:i.policyId)&&void 0!==t?t:""})),y=Object(s.c)(),h=Object(i.createSelector)(d,(e=>{var t,a,n,i;return null!==(t=null==e||null===(a=e.inputs[0])||void 0===a||null===(n=a.config)||void 0===n||null===(i=n.policy)||void 0===i?void 0:i.value)&&void 0!==t?t:y})),E=Object(i.createSelector)(h,(e=>null==e?void 0:e.windows)),v=Object(i.createSelector)(h,(e=>null==e?void 0:e.mac)),x=Object(i.createSelector)(h,(e=>null==e?void 0:e.linux)),k=Object(i.createSelector)(E,v,x,((e,t,a)=>({windows:{advanced:e.advanced,events:e.events,malware:e.malware,ransomware:e.ransomware,memory_protection:e.memory_protection,behavior_protection:e.behavior_protection,popup:e.popup,antivirus_registration:e.antivirus_registration,attack_surface_reduction:e.attack_surface_reduction},mac:{advanced:t.advanced,events:t.events,malware:t.malware,behavior_protection:t.behavior_protection,memory_protection:t.memory_protection,popup:t.popup},linux:{advanced:a.advanced,events:a.events,malware:a.malware,behavior_protection:a.behavior_protection,memory_protection:a.memory_protection,popup:a.popup}}))),S=Object(i.createSelector)(k,(e=>e.windows.antivirus_registration.enabled)),j=Object(i.createSelector)(k,(e=>e.windows.attack_surface_reduction.credential_hardening.enabled)),O=e=>e.isLoading,w=e=>e.apiError,T=e=>e.agentStatusSummary,I=e=>e.updateStatus},function(e,t,a){e.exports=a(27)(171)},,,,,,function(e,t,a){"use strict";a.r(t),a.d(t,"updateTableActivePage",(function(){return r})),a.d(t,"setHostTablesActivePageToZero",(function(){return s})),a.d(t,"setHostDetailsTablesActivePageToZero",(function(){return o})),a.d(t,"updateTableLimit",(function(){return l})),a.d(t,"updateHostsSort",(function(){return c})),a.d(t,"updateHostRiskScoreSort",(function(){return u})),a.d(t,"updateHostRiskScoreSeverityFilter",(function(){return d})),a.d(t,"updateHostsAnomaliesJobIdFilter",(function(){return p})),a.d(t,"updateHostsAnomaliesInterval",(function(){return m}));var n=a(16);const i=a.n(n)()("x-pack/security_solution/local/hosts"),r=i("UPDATE_HOST_TABLE_ACTIVE_PAGE"),s=i("SET_HOST_TABLES_ACTIVE_PAGE_TO_ZERO"),o=i("SET_HOST_DETAILS_TABLES_ACTIVE_PAGE_TO_ZERO"),l=i("UPDATE_HOST_TABLE_LIMIT"),c=i("UPDATE_HOSTS_SORT"),u=i("UPDATE_HOST_RISK_SCORE_SORT"),d=i("UPDATE_HOST_RISK_SCORE_SEVERITY"),p=i("UPDATE_HOSTS_ANOMALIES_JOB_ID_FILTER"),m=i("UPDATE_HOSTS_ANOMALIES_INTERVAL")},function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return r}));var n=a(1);const i=`${n.pb}/prepackaged`,r=`${n.pb}/prepackaged/_status`},function(e,t,a){(function(t){var a;a=function(){"use strict";var e=function(){if("undefined"!=typeof Map)return Map;function e(e,t){var a=-1;return e.some((function(e,n){return e[0]===t&&(a=n,!0)})),a}return function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(t){var a=e(this.__entries__,t),n=this.__entries__[a];return n&&n[1]},t.prototype.set=function(t,a){var n=e(this.__entries__,t);~n?this.__entries__[n][1]=a:this.__entries__.push([t,a])},t.prototype.delete=function(t){var a=this.__entries__,n=e(a,t);~n&&a.splice(n,1)},t.prototype.has=function(t){return!!~e(this.__entries__,t)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(e,t){void 0===t&&(t=null);for(var a=0,n=this.__entries__;a<n.length;a++){var i=n[a];e.call(t,i[1],i[0])}},t}()}(),a="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,n=void 0!==t&&t.Math===Math?t:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),i="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(n):function(e){return setTimeout((function(){return e(Date.now())}),1e3/60)},r=["top","right","bottom","left","width","height","size","weight"],s="undefined"!=typeof MutationObserver,o=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(e,t){var a=!1,n=!1,r=0;function s(){a&&(a=!1,e()),n&&l()}function o(){i(s)}function l(){var e=Date.now();if(a){if(e-r<2)return;n=!0}else a=!0,n=!1,setTimeout(o,20);r=e}return l}(this.refresh.bind(this))}return e.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},e.prototype.removeObserver=function(e){var t=this.observers_,a=t.indexOf(e);~a&&t.splice(a,1),!t.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},e.prototype.updateObservers_=function(){var e=this.observers_.filter((function(e){return e.gatherActive(),e.hasActive()}));return e.forEach((function(e){return e.broadcastActive()})),e.length>0},e.prototype.connect_=function(){a&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),s?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){a&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(e){var t=e.propertyName,a=void 0===t?"":t;r.some((function(e){return!!~a.indexOf(e)}))&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),l=function(e,t){for(var a=0,n=Object.keys(t);a<n.length;a++){var i=n[a];Object.defineProperty(e,i,{value:t[i],enumerable:!1,writable:!1,configurable:!0})}return e},c=function(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView||n},u=b(0,0,0,0);function d(e){return parseFloat(e)||0}function p(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];return t.reduce((function(t,a){return t+d(e["border-"+a+"-width"])}),0)}var m="undefined"!=typeof SVGGraphicsElement?function(e){return e instanceof c(e).SVGGraphicsElement}:function(e){return e instanceof c(e).SVGElement&&"function"==typeof e.getBBox};function g(e){return a?m(e)?function(e){var t=e.getBBox();return b(0,0,t.width,t.height)}(e):function(e){var t=e.clientWidth,a=e.clientHeight;if(!t&&!a)return u;var n=c(e).getComputedStyle(e),i=function(e){for(var t={},a=0,n=["top","right","bottom","left"];a<n.length;a++){var i=n[a],r=e["padding-"+i];t[i]=d(r)}return t}(n),r=i.left+i.right,s=i.top+i.bottom,o=d(n.width),l=d(n.height);if("border-box"===n.boxSizing&&(Math.round(o+r)!==t&&(o-=p(n,"left","right")+r),Math.round(l+s)!==a&&(l-=p(n,"top","bottom")+s)),!function(e){return e===c(e).document.documentElement}(e)){var m=Math.round(o+r)-t,g=Math.round(l+s)-a;1!==Math.abs(m)&&(o-=m),1!==Math.abs(g)&&(l-=g)}return b(i.left,i.top,o,l)}(e):u}function b(e,t,a,n){return{x:e,y:t,width:a,height:n}}var f=function(){function e(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=b(0,0,0,0),this.target=e}return e.prototype.isActive=function(){var e=g(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},e}(),y=function(e,t){var a,n,i,r,s,o,c,u=(n=(a=t).x,i=a.y,r=a.width,s=a.height,o="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,c=Object.create(o.prototype),l(c,{x:n,y:i,width:r,height:s,top:i,right:n+r,bottom:s+i,left:n}),c);l(this,{target:e,contentRect:u})},h=function(){function t(t,a,n){if(this.activeObservations_=[],this.observations_=new e,"function"!=typeof t)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=t,this.controller_=a,this.callbackCtx_=n}return t.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof c(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new f(e)),this.controller_.addObserver(this),this.controller_.refresh())}},t.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof c(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},t.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},t.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach((function(t){t.isActive()&&e.activeObservations_.push(t)}))},t.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map((function(e){return new y(e.target,e.broadcastRect())}));this.callback_.call(e,t,e),this.clearActive()}},t.prototype.clearActive=function(){this.activeObservations_.splice(0)},t.prototype.hasActive=function(){return this.activeObservations_.length>0},t}(),E="undefined"!=typeof WeakMap?new WeakMap:new e,v=function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var a=o.getInstance(),n=new h(t,a,this);E.set(this,n)};return["observe","unobserve","disconnect"].forEach((function(e){v.prototype[e]=function(){var t;return(t=E.get(this))[e].apply(t,arguments)}})),void 0!==n.ResizeObserver?n.ResizeObserver:v},e.exports=a()}).call(this,a(400))},function(e,t,a){"use strict";a.d(t,"d",(function(){return i})),a.d(t,"a",(function(){return r})),a.d(t,"e",(function(){return s})),a.d(t,"c",(function(){return o})),a.d(t,"b",(function(){return l}));var n=a(0);const i=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.stackByOptions.stackByLabel",{defaultMessage:"Stack by"}),r=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.stackByOptions.groupByLabel",{defaultMessage:"Group by"}),s=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.stackByOptions.stackByPlaceholder",{defaultMessage:"Select a field to stack by"}),o=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.stackByOptions.stackByAriaLabel",{defaultMessage:"Stack the alerts histogram by a field value"}),l=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.stackByOptions.groupByTopLabel",{defaultMessage:"Group by top"})},function(e,t,a){"use strict";a.d(t,"e",(function(){return i})),a.d(t,"f",(function(){return r})),a.d(t,"g",(function(){return s})),a.d(t,"h",(function(){return o})),a.d(t,"i",(function(){return l})),a.d(t,"j",(function(){return c})),a.d(t,"k",(function(){return u})),a.d(t,"c",(function(){return d})),a.d(t,"d",(function(){return p})),a.d(t,"n",(function(){return m})),a.d(t,"m",(function(){return g})),a.d(t,"o",(function(){return b})),a.d(t,"p",(function(){return f})),a.d(t,"q",(function(){return y})),a.d(t,"t",(function(){return h})),a.d(t,"s",(function(){return E})),a.d(t,"u",(function(){return v})),a.d(t,"w",(function(){return x})),a.d(t,"a",(function(){return k})),a.d(t,"b",(function(){return S})),a.d(t,"v",(function(){return j})),a.d(t,"r",(function(){return O})),a.d(t,"l",(function(){return w}));var n=a(0);n.i18n.translate("xpack.securitySolution.dataProviders.and",{defaultMessage:"AND"});const i=n.i18n.translate("xpack.securitySolution.dataProviders.deleteDataProvider",{defaultMessage:"Delete"}),r=n.i18n.translate("xpack.securitySolution.dataProviders.dropAnything",{defaultMessage:"Drop anything"}),s=(n.i18n.translate("xpack.securitySolution.dataProviders.edit",{defaultMessage:"Edit"}),n.i18n.translate("xpack.securitySolution.dataProviders.editMenuItem",{defaultMessage:"Edit filter"})),o=n.i18n.translate("xpack.securitySolution.dataProviders.editTitle",{defaultMessage:"EDIT FILTER"}),l=n.i18n.translate("xpack.securitySolution.dataProviders.excludeDataProvider",{defaultMessage:"Exclude results"}),c=n.i18n.translate("xpack.securitySolution.dataProviders.existsLabel",{defaultMessage:"exists"}),u=(n.i18n.translate("xpack.securitySolution.dataProviders.fieldLabel",{defaultMessage:"Field"}),n.i18n.translate("xpack.securitySolution.dataProviders.filterForFieldPresentLabel",{defaultMessage:"Filter for field present"})),d=n.i18n.translate("xpack.securitySolution.dataProviders.convertToFieldLabel",{defaultMessage:"Convert to field"}),p=n.i18n.translate("xpack.securitySolution.dataProviders.convertToTemplateFieldLabel",{defaultMessage:"Convert to template field"}),m=n.i18n.translate("xpack.securitySolution.dataProviders.highlighted",{defaultMessage:"highlighted"}),g=n.i18n.translate("xpack.securitySolution.dataProviders.hereToBuildAn",{defaultMessage:"here to build an"}),b=n.i18n.translate("xpack.securitySolution.dataProviders.includeDataProvider",{defaultMessage:"Include results"}),f=n.i18n.translate("xpack.securitySolution.dataProviders.not",{defaultMessage:"NOT"}),y=(n.i18n.translate("xpack.securitySolution.dataProviders.or",{defaultMessage:"or"}),n.i18n.translate("xpack.securitySolution.dataProviders.query",{defaultMessage:"query"})),h=(n.i18n.translate("xpack.securitySolution.dataProviders.toggle",{defaultMessage:"toggle"}),n.i18n.translate("xpack.securitySolution.dataProviders.reEnableDataProvider",{defaultMessage:"Re-enable"})),E=n.i18n.translate("xpack.securitySolution.dataProviders.removeDataProvider",{defaultMessage:"Remove Data Provider"}),v=({field:e,value:t})=>n.i18n.translate("xpack.securitySolution.dataProviders.showOptionsDataProviderAriaLabel",{values:{field:e,value:t},defaultMessage:"{field} {value} Press enter for options, or press space to begin dragging"}),x=n.i18n.translate("xpack.securitySolution.dataProviders.temporaryDisableDataProvider",{defaultMessage:"Temporarily disable"}),k=(n.i18n.translate("xpack.securitySolution.dataProviders.valuePlaceholder",{defaultMessage:"value"}),n.i18n.translate("xpack.securitySolution.dataProviders.addFieldPopoverButtonLabel",{defaultMessage:"Add field"})),S=n.i18n.translate("xpack.securitySolution.dataProviders.addTemplateFieldPopoverButtonLabel",{defaultMessage:"Add template field"}),j=n.i18n.translate("xpack.securitySolution.dataProviders.templateFieldLabel",{defaultMessage:"Template field"}),O=n.i18n.translate("xpack.securitySolution.dataProviders.queryAreaAriaLabel",{defaultMessage:"You are in the timeline query area, which contains groups of data providers that query for events"}),w=e=>n.i18n.translate("xpack.securitySolution.dataProviders.groupAreaAriaLabel",{values:{group:e},defaultMessage:"You are in group {group}"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));var n=a(4),i=a(78),r=a(117),s=a(81),o=a(95),l=a(177),c=a(256),u=a(79),d=a(210),p=a(12),m=a(98);const g=()=>{const e=Object(i.useDispatch)(),t=Object(n.useMemo)((()=>m.e.getSourcererDataViewsSelector()),[]),{defaultDataView:a,signalIndexName:g}=Object(s.a)((e=>t(e))),b=Object(d.a)({timelineId:u.j.active,timelineType:u.n.default}),f=Object(n.useCallback)(((t,n)=>{b({timeRange:n}),e(Object(p.updateProviders)({id:u.j.active,providers:t})),e(l.a.setSelectedDataView({id:o.SourcererScopeName.timeline,selectedDataViewId:a.id,selectedPatterns:[g||""]}))}),[b,a.id,e,g]);return{openTimelineWithFilters:Object(n.useCallback)(((e,t)=>{const a=[];for(const t of e){const e=t[0];if(e){const n=Object(c.a)(e.field,Object(r.v4)(),e.value,e.operator);for(const e of t.slice(1))n.and.push(Object(c.a)(e.field,Object(r.v4)(),e.value,e.operator));a.push(n)}}f(a,t)}),[f])}}},function(e,t,a){"use strict";a.r(t),a.d(t,"setUsersTablesActivePageToZero",(function(){return r})),a.d(t,"setUsersDetailsTablesActivePageToZero",(function(){return s})),a.d(t,"updateTableLimit",(function(){return o})),a.d(t,"updateTableActivePage",(function(){return l})),a.d(t,"updateTableSorting",(function(){return c})),a.d(t,"updateUserRiskScoreSeverityFilter",(function(){return u})),a.d(t,"updateUsersAnomaliesJobIdFilter",(function(){return d})),a.d(t,"updateUsersAnomaliesInterval",(function(){return p}));var n=a(16);const i=a.n(n)()("x-pack/security_solution/local/users"),r=i("SET_USERS_TABLES_ACTIVE_PAGE_TO_ZERO"),s=i("SET_USERS_DETAILS_TABLES_ACTIVE_PAGE_TO_ZERO"),o=i("UPDATE_USERS_TABLE_LIMIT"),l=i("UPDATE_USERS_ACTIVE_PAGE"),c=i("UPDATE_USERS_SORTING"),u=i("UPDATE_USERS_RISK_SEVERITY_FILTER"),d=i("UPDATE_USERS_ANOMALIES_JOB_ID_FILTER"),p=i("UPDATE_USERS_ANOMALIES_INTERVAL")},function(e,t,a){"use strict";a.d(t,"h",(function(){return i})),a.d(t,"d",(function(){return r})),a.d(t,"b",(function(){return s})),a.d(t,"g",(function(){return o})),a.d(t,"f",(function(){return l})),a.d(t,"e",(function(){return c})),a.d(t,"a",(function(){return u})),a.d(t,"c",(function(){return d}));var n=a(0);const i=n.i18n.translate("xpack.securitySolution.network.pageTitle",{defaultMessage:"Network"}),r=n.i18n.translate("xpack.securitySolution.network.navigation.flowsTitle",{defaultMessage:"Flows"}),s=n.i18n.translate("xpack.securitySolution.network.navigation.dnsTitle",{defaultMessage:"DNS"}),o=n.i18n.translate("xpack.securitySolution.network.navigation.usersTitle",{defaultMessage:"Users"}),l=n.i18n.translate("xpack.securitySolution.network.navigation.tlsTitle",{defaultMessage:"TLS"}),c=n.i18n.translate("xpack.securitySolution.network.navigation.httpTitle",{defaultMessage:"HTTP"}),u=n.i18n.translate("xpack.securitySolution.network.navigation.anomaliesTitle",{defaultMessage:"Anomalies"}),d=n.i18n.translate("xpack.securitySolution.network.navigation.eventsTitle",{defaultMessage:"Events"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(108),i=a(937),r=a(934);const s=Object(n.createSelector)(Object(r.globalFiltersQuerySelector)(),Object(r.getTimelineSelector)(),Object(r.globalQuerySelector)(),Object(r.globalQuery)(),Object(r.timelineQueryByIdSelector)(),Object(i.getTableByIdSelector)(),((e,t,a,n,i,r)=>({filters:e,input:t,query:a,globalQueries:n,timelineQuery:i,dataTable:r})))},function(e,t,a){"use strict";a.d(t,"f",(function(){return f})),a.d(t,"k",(function(){return y})),a.d(t,"i",(function(){return h})),a.d(t,"g",(function(){return E})),a.d(t,"j",(function(){return v})),a.d(t,"h",(function(){return x})),a.d(t,"b",(function(){return k})),a.d(t,"a",(function(){return j})),a.d(t,"e",(function(){return O})),a.d(t,"d",(function(){return M})),a.d(t,"c",(function(){return F}));var n=a(34),i=a(43),r=a.n(i),s=a(252),o=a.n(s),l=a(995),c=a.n(l),u=a(110),d=a(1),p=a(174),m=a(661),g=a(167),b=a(833);const f=e=>{const t={unit:"ms",value:0},a=e.match(/\d+/g),i=e.match(/[a-zA-Z]+/g);return Object(n.isEmpty)(a)||null==a||isNaN(Number(a[0]))||(t.value=Number(a[0])),!Object(n.isEmpty)(i)&&null!=i&&["s","m","h"].includes(i[0])&&(t.unit=i[0]),t},y=e=>!(null==e||!e.isValid||!e.data),h=e=>Object(n.has)("data.ruleType",e),E=e=>Object(n.has)("data.name",e),v=e=>Object(n.has)("data.interval",e),x=e=>Object(n.has)("data.actions",e),k=(e,t)=>{switch(t){case"machine_learning":const{index:t,queryBar:a,threshold:n,threatIndex:i,threatQueryBar:r,threatMapping:s,eqlOptions:o,newTermsFields:l,historyWindowSize:c,...u}=e;return u;case"threshold":const{anomalyThreshold:d,machineLearningJobId:p,threatIndex:m,threatQueryBar:g,threatMapping:b,eqlOptions:f,newTermsFields:y,historyWindowSize:h,...E}=e;return E;case"threat_match":const{anomalyThreshold:v,machineLearningJobId:x,threshold:k,eqlOptions:S,newTermsFields:j,historyWindowSize:O,...w}=e;return w;case"query":case"saved_query":const{anomalyThreshold:T,machineLearningJobId:I,threshold:C,threatIndex:M,threatQueryBar:F,threatMapping:D,eqlOptions:A,newTermsFields:_,historyWindowSize:N,...R}=e;return R;case"eql":const{anomalyThreshold:P,machineLearningJobId:L,threshold:B,threatIndex:q,threatQueryBar:z,threatMapping:$,newTermsFields:V,historyWindowSize:U,...H}=e;return H;case"new_terms":const{anomalyThreshold:G,machineLearningJobId:Q,threshold:W,threatIndex:K,threatQueryBar:Y,threatMapping:J,eqlOptions:X,...Z}=e;return Z}Object(p.a)(t)};function S(e){return e.filter((e=>"none"!==e.name))}const j=e=>e.filter((e=>"none"!==e.tactic.name)).map((e=>{var t;return{...e,technique:S(null!==(t=e.technique)&&void 0!==t?t:[]).map((e=>({...e,subtechnique:null!=e.subtechnique?S(e.subtechnique):[]})))}})),O=e=>{const t={...e};return e.dataSourceType===g.a.DataView?c()(t,["index","dataSourceType"]):e.dataSourceType===g.a.IndexPatterns?c()(t,["dataViewId","dataSourceType"]):t},w=e=>{var t,a,i,r,s,o,l,c,u,d,p,m,g,b,f,y,h,E,v,x,S,j,w,T,I,C,M,F,D,A,_,N,R,P,L,B,q,z,$,V,U,H,G,Q,W,K;const Y=O(e),J=k(Y,Y.ruleType),{ruleType:X,timeline:Z}=J;var ee;return{...{type:X,...null!=Z.id&&null!=Z.title&&{timeline_id:Z.id,timeline_title:Z.title}},...(ee=J,Object(n.has)("anomalyThreshold",ee)?{anomaly_threshold:J.anomalyThreshold,machine_learning_job_id:J.machineLearningJobId}:(e=>Object(n.has)("threshold",e))(J)?{index:J.index,filters:null===(t=J.queryBar)||void 0===t?void 0:t.filters,language:null===(a=J.queryBar)||void 0===a||null===(i=a.query)||void 0===i?void 0:i.language,query:null===(r=J.queryBar)||void 0===r||null===(s=r.query)||void 0===s?void 0:s.query,saved_id:null!==(o=null===(l=J.queryBar)||void 0===l?void 0:l.saved_id)&&void 0!==o?o:void 0,..."threshold"===X&&{threshold:{field:null!==(c=null===(u=J.threshold)||void 0===u?void 0:u.field)&&void 0!==c?c:[],value:null!==(d=parseInt(null===(p=J.threshold)||void 0===p?void 0:p.value,10))&&void 0!==d?d:0,cardinality:Object(n.isEmpty)(null===(m=J.threshold.cardinality)||void 0===m?void 0:m.field)||null==(null===(g=J.threshold.cardinality)||void 0===g?void 0:g.value)?[]:[{field:J.threshold.cardinality.field[0],value:parseInt(J.threshold.cardinality.value,10)}]}}}:(e=>Object(n.has)("threatIndex",e))(J)?{index:J.index,filters:null===(b=J.queryBar)||void 0===b?void 0:b.filters,language:null===(f=J.queryBar)||void 0===f||null===(y=f.query)||void 0===y?void 0:y.language,query:null===(h=J.queryBar)||void 0===h||null===(E=h.query)||void 0===E?void 0:E.query,saved_id:null!==(v=null===(x=J.queryBar)||void 0===x?void 0:x.saved_id)&&void 0!==v?v:void 0,threat_index:J.threatIndex,threat_query:null===(S=J.threatQueryBar)||void 0===S||null===(j=S.query)||void 0===j?void 0:j.query,threat_filters:null===(w=J.threatQueryBar)||void 0===w?void 0:w.filters,threat_mapping:J.threatMapping,threat_language:null===(T=J.threatQueryBar)||void 0===T||null===(I=T.query)||void 0===I?void 0:I.language}:(e=>Object(n.has)("eqlOptions",e))(J)?{index:J.index,filters:null===(C=J.queryBar)||void 0===C?void 0:C.filters,language:null===(M=J.queryBar)||void 0===M||null===(F=M.query)||void 0===F?void 0:F.language,query:null===(D=J.queryBar)||void 0===D||null===(A=D.query)||void 0===A?void 0:A.query,saved_id:null!==(_=null===(N=J.queryBar)||void 0===N?void 0:N.saved_id)&&void 0!==_?_:void 0,timestamp_field:null===(R=J.eqlOptions)||void 0===R?void 0:R.timestampField,event_category_override:null===(P=J.eqlOptions)||void 0===P?void 0:P.eventCategoryField,tiebreaker_field:null===(L=J.eqlOptions)||void 0===L?void 0:L.tiebreakerField}:(e=>Object(n.has)("newTermsFields",e))(J)?{index:J.index,filters:null===(B=J.queryBar)||void 0===B?void 0:B.filters,language:null===(q=J.queryBar)||void 0===q||null===(z=q.query)||void 0===z?void 0:z.language,query:null===($=J.queryBar)||void 0===$||null===(V=$.query)||void 0===V?void 0:V.query,new_terms_fields:J.newTermsFields,history_window_start:`now-${J.historyWindowSize}`}:{...J.groupByFields.length>0?{alert_suppression:{group_by:J.groupByFields}}:{},index:J.index,filters:null===(U=J.queryBar)||void 0===U?void 0:U.filters,language:null===(H=J.queryBar)||void 0===H||null===(G=H.query)||void 0===G?void 0:G.language,query:null===(Q=J.queryBar)||void 0===Q||null===(W=Q.query)||void 0===W?void 0:W.query,saved_id:void 0,type:"query",...["query","saved_query"].includes(X)&&(null===(K=J.queryBar)||void 0===K?void 0:K.saved_id)&&J.shouldLoadQueryDynamically&&{type:"saved_query",query:void 0,filters:void 0,saved_id:J.queryBar.saved_id}}),data_view_id:J.dataViewId}},T=e=>{const{...t}=e;if(!Object(n.isEmpty)(t.interval)&&!Object(n.isEmpty)(t.from)){const{unit:e,value:a}=f(t.interval),{unit:n,value:i}=f(t.from),s=r.a.duration(a,e);s.add(i,n),t.from=`now-${s.asSeconds()}s`,t.to="now"}return{...t,meta:{from:e.from}}},I=(e,t)=>{const{author:a,falsePositives:i,references:r,riskScore:s,severity:o,threat:l,isAssociatedToEndpointList:c,isBuildingBlock:d,note:p,ruleNameOverride:m,threatIndicatorPath:g,timestampOverride:b,timestampOverrideFallbackDisabled:f,...y}=e,h=null!=t?t.filter((e=>"endpoint"!==e.type)):[];return{author:a.filter((e=>!Object(n.isEmpty)(e))),...d?{building_block_type:"default"}:{},...c?{exceptions_list:[{id:u.j,list_id:u.j,namespace_type:"agnostic",type:"endpoint"},...h]}:null!=t?{exceptions_list:[...h]}:{},false_positives:i.filter((e=>!Object(n.isEmpty)(e))),references:r.filter((e=>!Object(n.isEmpty)(e))),risk_score:s.value,risk_score_mapping:s.isMappingChecked?s.mapping.filter((e=>null!=e.field&&""!==e.field)):[],rule_name_override:""!==m?m:void 0,severity:o.value,severity_mapping:o.isMappingChecked?o.mapping.filter((e=>null!=e.field&&""!==e.field&&null!=e.value)):[],threat:j(l).map((e=>({...e,framework:"MITRE ATT&CK"}))),threat_indicator_path:g,timestamp_override:""!==b?b:void 0,timestamp_override_fallback_disabled:f,...Object(n.isEmpty)(p)?{}:{note:p},...y}},C=e=>{const{actions:t=[],responseActions:a,enabled:n,kibanaSiemAppUrl:i,throttle:r=d.Wb}=e;return{actions:t.map(m.a),response_actions:null==a?void 0:a.map(m.b),enabled:n,throttle:t.length?r:d.Wb,meta:{kibana_siem_app_url:i}}},M=(e,t,a,n,i)=>o.a.all([w(e),I(t,i),T(a),C(n)]),F=({defineRuleData:e,aboutRuleData:t,scheduleRuleData:a,exceptionsList:n})=>{const i={...t,name:"Preview Rule",description:"Preview Rule"};return{...M(e,i,a,b.b,n)}}},function(e,t,a){"use strict";a.d(t,"m",(function(){return i})),a.d(t,"a",(function(){return r})),a.d(t,"c",(function(){return s})),a.d(t,"l",(function(){return o})),a.d(t,"j",(function(){return l})),a.d(t,"k",(function(){return c})),a.d(t,"i",(function(){return u})),a.d(t,"h",(function(){return d})),a.d(t,"e",(function(){return p})),a.d(t,"o",(function(){return m})),a.d(t,"n",(function(){return g})),a.d(t,"f",(function(){return b})),a.d(t,"g",(function(){return f})),a.d(t,"d",(function(){return y})),a.d(t,"b",(function(){return h}));var n=a(0);const i=n.i18n.translate("xpack.securitySolution.detectionEngine.detectionsPageTitle",{defaultMessage:"Alerts"}),r=n.i18n.translate("xpack.securitySolution.detectionEngine.alertTitle",{defaultMessage:"Alerts"}),s=n.i18n.translate("xpack.securitySolution.detectionEngine.buttonManageRules",{defaultMessage:"Manage rules"}),o=n.i18n.translate("xpack.securitySolution.detectionEngine.noIndexTitle",{defaultMessage:"Let’s set up your detection engine"}),l=n.i18n.translate("xpack.securitySolution.detectionEngine.needsSignalsAndListsIndexesMessage",{defaultMessage:"You need permissions for the signals and lists indices."}),c=n.i18n.translate("xpack.securitySolution.detectionEngine.needsSignalsIndexMessage",{defaultMessage:"You need permissions for the signals index."}),u=n.i18n.translate("xpack.securitySolution.detectionEngine.needsListsIndexesMessage",{defaultMessage:"You need permissions for the lists indices."}),d=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.needsIndexPermissionsMessage",{values:{additionalContext:e},defaultMessage:"To use the detection engine, a user with the required cluster and index privileges must first access this page. {additionalContext} For more help, contact your Elastic Stack administrator."}),p=n.i18n.translate("xpack.securitySolution.detectionEngine.goToDocumentationButton",{defaultMessage:"View documentation"}),m=n.i18n.translate("xpack.securitySolution.detectionEngine.userUnauthenticatedTitle",{defaultMessage:"Detection engine permissions required"}),g=n.i18n.translate("xpack.securitySolution.detectionEngine.userUnauthenticatedMsgBody",{defaultMessage:"You do not have the required permissions for viewing the detection engine. For more help, contact your administrator."}),b=n.i18n.translate("xpack.securitySolution.detectionEngine.mlRulesDisabledMessageTitle",{defaultMessage:"ML rules require Platinum License and ML Admin Permissions"}),f=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.mlUnavailableTitle",{values:{totalRules:e},defaultMessage:"{totalRules} {totalRules, plural, =1 {rule requires} other {rules require}} Machine Learning to enable."}),y=n.i18n.translate("xpack.securitySolution.detectionEngine.noPermissionsTitle",{defaultMessage:"Privileges required"}),h=n.i18n.translate("xpack.securitySolution.detectionEngine.noPermissionsMessage",{defaultMessage:"To view alerts, you must update privileges. For more information, contact your Kibana administrator."})},function(e,t,a){"use strict";a.d(t,"c",(function(){return s})),a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return l}));var n=a(7),i=a(174),r=a(173);const s=e=>null==e?null:e===r.f["partial failure"]?"warning":e,o=e=>{const t=s(e);return null!=t?Object(n.capitalize)(t):null},l=e=>null==e?"subdued":e===r.f.succeeded?"success":e===r.f.failed?"danger":e===r.f.running||e===r.f["partial failure"]||e===r.f["going to run"]?"warning":Object(i.a)(e,"Unknown rule execution status")},function(e,t,a){"use strict";a.d(t,"a",(function(){return EventFiltersApiClient}));var n=a(110),i=a(172),r=a(315),s=a(290);function o(e){return Object(i.a)(e)}class EventFiltersApiClient extends r.a{constructor(e){super(e,n.e,s.b,void 0,o)}static getInstance(e){return super.getInstance(e,n.e,s.b,void 0,o)}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return W}));var n=a(4),i=a.n(n),r=a(38),s=a(78),o=a(32),l=a(33),c=a.n(l),u=a(316),d=a(255),p=a(403),m=a(205),g=a(99),b=a(107),f=a(302),y=a(705),h=a(141);const E=({width:e=r.DEFAULT_ACTION_BUTTON_WIDTH,dataTestSubj:t,content:a,ariaLabel:n,iconType:s="",isDisabled:l=!1,onClick:c,children:u,buttonType:d="icon"})=>i.a.createElement(i.a.Fragment,null,"icon"===d&&i.a.createElement("div",null,i.a.createElement(h.l,{textAlign:"center",width:e},null!=u?u:i.a.createElement(o.EuiToolTip,{"data-test-subj":`${t}-tool-tip`,content:a},i.a.createElement(o.EuiButtonIcon,{"aria-label":n,"data-test-subj":`${t}-button`,iconType:s,isDisabled:l,onClick:c,size:"s"})))),"text"===d&&i.a.createElement(o.EuiContextMenuItem,{"aria-label":n,"data-test-subj":`${t}-button-menu-item`,disabled:l,onClick:c,color:"text",size:"s"},i.a.createElement(o.EuiText,{"data-test-subj":`${t}-button`,size:"m"},a)));E.displayName="ActionIconItemComponent";const v=i.a.memo(E);var x=a(118),k=a(650);const S=({ariaLabel:e=x.g,ecsRowData:t,buttonType:a,onInvestigateInTimelineAlertClick:n})=>{const{investigateInTimelineAlertClick:r}=Object(k.a)({ecsRowData:t,onInvestigateInTimelineAlertClick:n});return i.a.createElement(v,{ariaLabel:e,content:x.f,dataTestSubj:"send-alert-to-timeline",iconType:"timeline",onClick:r,isDisabled:!1,buttonType:a})},j=i.a.memo(S);var O=a(79),w=a(254),T=a(387),I=a(116);const C=({ariaLabel:e,showNotes:t,timelineType:a,toggleShowNotes:n})=>{const{kibanaSecuritySolutionsPrivileges:r}=Object(I.a)();return i.a.createElement(v,null,i.a.createElement(T.d,{ariaLabel:e,"data-test-subj":"add-note",isDisabled:!1===r.crud,showNotes:t,timelineType:a,toggleShowNotes:n,toolTip:a===O.n.template?w.h:w.i}))};C.displayName="AddEventNoteActionComponent";const M=i.a.memo(C);var F=a(879);const D=({ariaLabel:e,isAlert:t,noteIds:a,onPinClicked:s,eventIsPinned:l,timelineType:c})=>{const{kibanaSecuritySolutionsPrivileges:u}=Object(I.a)(),d=Object(n.useMemo)((()=>Object(f.g)({isPinned:l,isAlert:t,eventHasNotes:Object(f.b)(a),timelineType:c})),[l,t,a,c]);return i.a.createElement("div",{key:"timeline-action-pin-tool-tip"},i.a.createElement(h.l,{textAlign:"center",width:r.DEFAULT_ACTION_BUTTON_WIDTH},i.a.createElement(o.EuiToolTip,{"data-test-subj":"timeline-action-pin-tool-tip",content:d},i.a.createElement(F.a,{ariaLabel:e,allowUnpinning:!Object(f.b)(a),"data-test-subj":"pin-event",isDisabled:!1===u.crud,isAlert:t,onClick:s,pinned:l,timelineType:c}))))};D.displayName="PinEventActionComponent";const A=i.a.memo(D);var _=a(81),N=a(12),R=a(148),P=a(86),L=a(112),B=a(34),q=a(154),z=a(179),$=a(13);const V=e=>"signal"===e,U=c.a.div.withConfig({displayName:"ActionsContainer",componentId:"sc-1sc1j22-0"})(["align-items:center;display:flex;"]),H=({ariaRowindex:e,checked:t,columnValues:a,ecsData:l,eventId:c,eventIdToNoteIds:E,isEventPinned:v=!1,isEventViewer:x=!1,loadingEventIds:k,onEventDetailsPanelOpened:S,onRowSelected:T,onRuleChange:I,showCheckboxes:C,showNotes:F,timelineId:D,toggleShowNotes:H})=>{const G=Object(s.useDispatch)(),Q=Object(b.a)("tGridEnabled"),W=Object(n.useMemo)((()=>P.b.getTimelineByIdSelector()),[]),K=Object(_.b)((e=>(Object(g.isTimelineScope)(D)?W(e,D):L.b).timelineType)),{startTransaction:Y}=Object(q.a)(),J=Object($.b)().isEnterprise(),X=Object(n.useCallback)((e=>G(P.a.pinEvent({id:D,eventId:e}))),[G,D]),Z=Object(n.useCallback)((e=>G(P.a.unPinEvent({id:D,eventId:e}))),[G,D]),ee=Object(n.useCallback)((e=>T({eventIds:[c],isSelected:e.currentTarget.checked})),[c,T]),te=Object(n.useCallback)((()=>Object(f.f)({allowUnpinning:!E||!Object(f.b)(E[c]),eventId:c,onPinEvent:X,onUnPinEvent:Z,isEventPinned:v})),[E,c,v,X,Z]),ae=Object(f.e)(l),ne=Object(n.useMemo)((()=>{var e,t,a,n;return"signal"!==ae&&!(null!==(e=l.event)&&void 0!==e&&null!==(t=e.kind)&&void 0!==t&&t.includes("event")&&null!==(a=l.agent)&&void 0!==a&&null!==(n=a.type)&&void 0!==n&&n.includes("endpoint"))}),[l,ae]),ie=Object(n.useMemo)((()=>!(e=>{var t;return("endpoint"===Object(B.get)(["agent","type",0],e)||"winlogbeat"===Object(B.get)(["agent","type",0],e)&&"sysmon"===Object(B.get)(["event","module",0],e))&&1===(null===(t=Object(B.get)(["process","entity_id"],e))||void 0===t?void 0:t.length)&&""!==Object(B.get)(["process","entity_id",0],e)})(l)),[l]),{setGlobalFullScreen:re}=Object(R.a)(),{setTimelineFullScreen:se}=Object(R.c)(),oe=Object(g.getScopedActions)(D),le=Object(n.useCallback)((()=>{Y({name:z.a.OPEN_ANALYZER});const e=document.querySelector(".euiDataGrid--fullScreen");oe&&G(oe.updateGraphEventId({id:D,graphEventId:l._id})),D===O.j.active?(e&&se(!0),G(Object(N.setActiveTabTimeline)({id:D,activeTab:O.m.graph}))):e&&re(!0)}),[Y,oe,D,G,l._id,se,re]),ce=Object(n.useMemo)((()=>{var e,t,a,n,i;const{process:r,_id:s,timestamp:o}=l,c=null==r||null===(e=r.entry_leader)||void 0===e||null===(t=e.entity_id)||void 0===t?void 0:t[0];if(void 0===c)return null;const u=null==r||null===(a=r.entity_id)||void 0===a?void 0:a[0],d="signal"===ae||"eql"===ae?s:void 0;return{sessionEntityId:c,jumpToEntityId:u,jumpToCursor:d&&(null===(n=l.kibana)||void 0===n||null===(i=n.alert.original_time)||void 0===i?void 0:i[0])||o,investigatedAlertId:d}}),[l,ae]),ue=Object(n.useCallback)((()=>{const e=document.querySelector(".euiDataGrid--fullScreen");Y({name:z.a.OPEN_SESSION_VIEW}),D===O.j.active?(e&&se(!0),null!==ce&&G(Object(N.setActiveTabTimeline)({id:D,activeTab:O.m.session}))):e&&re(!0),null!==ce&&oe&&G(oe.updateSessionViewConfig({id:D,sessionViewConfig:ce}))}),[Y,D,ce,se,G,re,oe]),{activeStep:de,isTourShown:pe,incrementStep:me}=Object(p.b)(),ge=Object(n.useMemo)((()=>pe(m.b.alertsCases)&&"signal"===ae&&Object(d.c)(D)&&1===e),[pe,e,ae,D]),be=Object(n.useCallback)((()=>{ge&&de===m.a.expandEvent&&pe(m.b.alertsCases)&&me(m.b.alertsCases),S()}),[de,me,ge,pe,S]);return i.a.createElement(U,null,C&&!Q&&i.a.createElement("div",{key:"select-event-container","data-test-subj":"select-event-container"},i.a.createElement(h.l,{textAlign:"center",width:r.DEFAULT_ACTION_BUTTON_WIDTH},k.includes(c)?i.a.createElement(o.EuiLoadingSpinner,{size:"m","data-test-subj":"event-loader"}):i.a.createElement(o.EuiCheckbox,{"aria-label":w.e({ariaRowindex:e,columnValues:a,checked:t}),"data-test-subj":"select-event",id:c,checked:t,onChange:ee}))),i.a.createElement(u.a,{isTourAnchor:ge,onClick:be,step:m.a.expandEvent,tourId:m.b.alertsCases},i.a.createElement("div",{key:"expand-event"},i.a.createElement(h.l,{textAlign:"center",width:r.DEFAULT_ACTION_BUTTON_WIDTH},i.a.createElement(o.EuiToolTip,{"data-test-subj":"expand-event-tool-tip",content:w.r},i.a.createElement(o.EuiButtonIcon,{"aria-label":w.s({ariaRowindex:e,columnValues:a}),"data-test-subj":"expand-event",iconType:"expand",onClick:be,size:"s"}))))),i.a.createElement(i.a.Fragment,null,D!==O.j.active&&i.a.createElement(j,{ariaLabel:w.n({ariaRowindex:e,columnValues:a}),key:"investigate-in-timeline",ecsRowData:l}),!x&&H&&i.a.createElement(i.a.Fragment,null,i.a.createElement(M,{ariaLabel:w.c({ariaRowindex:e,columnValues:a}),key:"add-event-note",showNotes:null!=F&&F,toggleShowNotes:H,timelineType:K}),i.a.createElement(A,{ariaLabel:w.m({ariaRowindex:e,columnValues:a,isEventPinned:v}),isAlert:V(ae),key:"pin-event",onPinClicked:te,noteIds:E&&E[c]||[],eventIsPinned:v,timelineType:K})),i.a.createElement(y.b,{ariaLabel:w.g({ariaRowindex:e,columnValues:a}),ariaRowindex:e,columnValues:a,key:"alert-context-menu",ecsRowData:l,scopeId:D,disabled:ne,onRuleChange:I}),!1===ie?i.a.createElement("div",null,i.a.createElement(h.l,{textAlign:"center",width:r.DEFAULT_ACTION_BUTTON_WIDTH},i.a.createElement(o.EuiToolTip,{"data-test-subj":"view-in-analyzer-tool-tip",content:w.a},i.a.createElement(o.EuiButtonIcon,{"aria-label":w.b({ariaRowindex:e,columnValues:a}),"data-test-subj":"view-in-analyzer",iconType:"analyzeEvent",onClick:le,size:"s"})))):null,null===ce||!J&&D!==O.g.kubernetesPageSessions?null:i.a.createElement("div",null,i.a.createElement(h.l,{textAlign:"center",width:r.DEFAULT_ACTION_BUTTON_WIDTH},i.a.createElement(o.EuiToolTip,{"data-test-subj":"expand-event-tool-tip",content:w.j},i.a.createElement(o.EuiButtonIcon,{"aria-label":w.s({ariaRowindex:e,columnValues:a}),"data-test-subj":"session-view-button",iconType:"sessionViewer",onClick:ue,size:"s"}))))))};H.displayName="ActionsComponent";const G=i.a.memo(H);var Q=a(619);const W=e=>[{headerCellRender:()=>i.a.createElement(i.a.Fragment,null,Q.a),id:"default-timeline-control-column",rowCellRender:G,width:Object(r.getActionsColumnWidth)(e)}]},function(e,t,a){"use strict";a.d(t,"a",(function(){return O}));var n=a(82),i=a.n(n),r=a(4),s=a.n(r),o=a(1),l=a(252),c=a.n(l),u=a(126),d=a(248),p=a(77),m=a(326),g=a(0);const b=g.i18n.translate("xpack.securitySolution.containers.anomalies.stackByJobId",{defaultMessage:"job"}),f=g.i18n.translate("xpack.securitySolution.containers.anomalies.title",{defaultMessage:"Anomalies"}),y=g.i18n.translate("xpack.securitySolution.containers.anomalies.errorFetchingAnomaliesData",{defaultMessage:"Failed to query anomalies data"});var h,E=a(1068);const v=[{text:b,value:"job_id"}],x=b,k={defaultStackByOption:null!==(h=v.find((e=>e.text===x)))&&void 0!==h?h:v[0],errorMessage:y,hideHistogramIfEmpty:!0,histogramType:E.b.anomalies,stackByOptions:v,subtitle:void 0,title:f},S="anomaliesHistogramQuery",j=({deleteQuery:e,endDate:t,setQuery:a,skip:n,startDate:l,type:g,filterQuery:b,anomaliesFilterQuery:f,AnomaliesTableComponent:y,flowTarget:h,ip:E,hostName:v,userName:x,indexNames:j})=>{const{jobs:O}=Object(d.a)(),[w]=Object(p.q)(o.K),T=((e,t={},a=[],n,i,r)=>{const s=a.map((e=>e.id)).map((e=>({match_phrase:{job_id:e}}))),o=Object(u.a)(e),l=o?JSON.parse(o):{},d=c.a.all([l,t,{bool:{filter:[{bool:{should:s,minimum_should_match:1}},{match_phrase:{result_type:"record"}},i&&r&&{match_phrase:{[`${i}.ip`]:r}},{range:{record_score:{gte:n}}}]}}]);return JSON.stringify(d)})(b,f,O,w,h,E);return Object(r.useEffect)((()=>()=>{e&&e({id:S})}),[]),s.a.createElement(s.a.Fragment,null,s.a.createElement(m.a,i()({endDate:t,filterQuery:T,id:S,indexNames:j,setQuery:a,startDate:l},k)),s.a.createElement(y,{startDate:l,endDate:t,skip:n,type:g,flowTarget:h,ip:E,hostName:v,userName:x}))};j.displayName="AnomaliesQueryTabBodyComponent";const O=s.a.memo(j);O.displayName="AnomaliesQueryTabBody"},function(e,t,a){"use strict";a.d(t,"a",(function(){return y}));var n=a(4),i=a.n(n),r=a(32),s=a(33),o=a.n(s),l=a(0);const c=l.i18n.translate("xpack.securitySolution.andOrBadge.and",{defaultMessage:"AND"}),u=l.i18n.translate("xpack.securitySolution.andOrBadge.or",{defaultMessage:"OR"}),d=o()(r.EuiBadge).withConfig({displayName:"RoundBadge",componentId:"sc-wu3h16-0"})(["align-items:center;border-radius:100%;display:inline-flex;font-size:9px;height:34px;justify-content:center;margin:0 5px 0 5px;padding:7px 6px 4px 6px;user-select:none;width:34px;.euiBadge__content{position:relative;top:-1px;}.euiBadge__text{text-overflow:clip;}"]);d.displayName="RoundBadge";const p=({type:e})=>i.a.createElement(d,{"data-test-subj":"and-or-badge",color:"hollow"},"and"===e?c:u);p.displayName="RoundedBadge";const m=Object(s.css)(["background:",";position:relative;width:2px;&:after{background:",";content:'';height:8px;right:-4px;position:absolute;width:10px;clip-path:circle();}"],(({theme:e})=>e.eui.euiColorLightShade),(({theme:e})=>e.eui.euiColorLightShade)),g=o()(r.EuiFlexItem).withConfig({displayName:"TopAntenna",componentId:"sc-10c57g6-0"})([""," &:after{top:0;}"],m),b=o()(r.EuiFlexItem).withConfig({displayName:"BottomAntenna",componentId:"sc-10c57g6-1"})([""," &:after{bottom:0;}"],m),f=({type:e})=>i.a.createElement(r.EuiFlexGroup,{className:"andBadgeContainer",gutterSize:"none",direction:"column",alignItems:"center"},i.a.createElement(g,{"data-test-subj":"andOrBadgeBarTop",grow:1}),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(p,{type:e})),i.a.createElement(b,{"data-test-subj":"andOrBadgeBarBottom",grow:1}));f.displayName="RoundedBadgeAntenna";const y=i.a.memo((({type:e,includeAntennas:t=!1})=>t?i.a.createElement(f,{type:e}):i.a.createElement(p,{type:e})));y.displayName="AndOrBadge"},function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return l}));var n=a(4),i=a(231);const r=(e,t)=>{switch(t.type){case"FETCH_INIT":return{...e,parameters:t.payload,isLoading:!0};case"FETCH_SUCCESS":return{...e,data:t.payload,isLoading:!1,error:void 0};case"FETCH_FAILURE":return{...e,error:t.payload,isLoading:!1};case"FETCH_REPEAT":return{...e,isLoading:!0};default:return e}},s=(e,t,{disabled:a=!1,initialParameters:s}={})=>{const{startTracking:o}=Object(i.a)(),[{parameters:l,data:c,isLoading:u,error:d},p]=Object(n.useReducer)(r,{data:void 0,isLoading:void 0!==s,error:void 0,parameters:s}),m=Object(n.useCallback)((e=>p({type:"FETCH_INIT",payload:e})),[]),g=Object(n.useCallback)((()=>p({type:"FETCH_REPEAT"})),[]);return Object(n.useEffect)((()=>{if(!1===u||void 0===l||a)return;let n=!1;const i=new AbortController;return(async()=>{const{endTracking:a}=o({name:e});try{const e=await t(l,i.signal);a("success"),n||p({type:"FETCH_SUCCESS",payload:e})}catch(e){a(i.signal.aborted?"aborted":"error"),n||p({type:"FETCH_FAILURE",payload:e})}})(),()=>{n=!0,i.abort()}}),[u,l,a,t,o,e]),{fetch:m,refetch:g,data:c,isLoading:u,error:d}};var o=a(1);const l={SECURITY_DASHBOARDS:`${o.B} fetch security dashboards`,ANOMALIES_TABLE:`${o.B} fetch anomalies table data`,GET_RISK_SCORE_DEPRECATED:`${o.B} fetch is risk score deprecated`,ENABLE_RISK_SCORE:`${o.B} fetch enable risk score`,REFRESH_RISK_SCORE:`${o.B} fetch refresh risk score`,UPGRADE_RISK_SCORE:`${o.B} fetch upgrade risk score`}},function(e,t,a){"use strict";a.d(t,"c",(function(){return h})),a.d(t,"d",(function(){return E})),a.d(t,"a",(function(){return v})),a.d(t,"b",(function(){return x})),a.d(t,"e",(function(){return T}));var n=a(32),i=a(44),r=a.n(i),s=a(4),o=a.n(s),l=a(33),c=a.n(l);const u=c.a.span.withConfig({displayName:"ArrowBody",componentId:"sc-1jr26ur-0"})(["background-color:",";height:",";width:25px;"],(e=>e.theme.eui.euiColorLightShade),(({height:e})=>`${e}px`));u.displayName="ArrowBody";const d=o.a.memo((({direction:e})=>o.a.createElement(n.EuiIcon,{color:"subdued","data-test-subj":"arrow-icon",size:"s",type:e})));d.displayName="ArrowHead";var p=a(954);const m=Object(p.scaleLinear)().domain([0,100]).range([1,4]).clamp(!0),g=e=>Array.isArray(e)&&1===e.length;var b=a(88),f=a(257),y=a(640);const h="source.bytes",E="source.packets",v="destination.bytes",x="destination.packets",k=c.a.span.withConfig({displayName:"Percent",componentId:"sc-mlrd6t-0"})(["margin-right:5px;"]);k.displayName="Percent";const S=c()(n.EuiFlexGroup).withConfig({displayName:"SourceDestinationArrowsContainer",componentId:"sc-mlrd6t-1"})(["margin:0 2px;.euiToolTipAnchor{white-space:nowrap;}"]);S.displayName="SourceDestinationArrowsContainer";const j=c()(n.EuiText).withConfig({displayName:"Data",componentId:"sc-mlrd6t-2"})(["margin:0 5px;"]);j.displayName="Data";const O=o.a.memo((({contextId:e,eventId:t,isDraggable:a,sourceBytes:i,sourceBytesPercent:s,sourcePackets:l})=>{const c=null!=s?m(s):1;return o.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"none",justifyContent:"center"},o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(u,{height:null!=c?c:0})),null==i||isNaN(Number(i))?null:o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(b.b,{field:h,id:`source-arrow-default-draggable-${e}-${t}-${h}-${i}`,isDraggable:a,value:i},o.a.createElement(j,{size:"xs"},null!=s?o.a.createElement(k,null,`(${r()(s).format("0.00")}%)`):null,o.a.createElement("span",null,o.a.createElement(f.a,{value:i}))))),o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(u,{height:null!=c?c:0})),null==l||isNaN(Number(l))?null:o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(b.b,{field:E,id:`source-arrow-default-draggable-${e}-${t}-${E}-${l}`,isDraggable:a,value:l},o.a.createElement(j,{size:"xs"},o.a.createElement("span",null,`${l} ${y.a}`)))),o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(u,{height:null!=c?c:0})),o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(d,{direction:"arrowRight"})))}));O.displayName="SourceArrow";const w=o.a.memo((({contextId:e,destinationBytes:t,destinationBytesPercent:a,destinationPackets:i,eventId:s,isDraggable:l})=>{const c=null!=a?m(a):1;return o.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"none",justifyContent:"center"},o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(d,{direction:"arrowLeft"})),o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(u,{height:null!=c?c:0})),null==t||isNaN(Number(t))?null:o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(b.b,{field:v,id:`destination-arrow-default-draggable-${e}-${s}-${v}-${t}`,isDraggable:l,value:t},o.a.createElement(j,{size:"xs"},null!=a?o.a.createElement(k,null,`(${r()(a).format("0.00")}%)`):null,o.a.createElement("span",null,o.a.createElement(f.a,{value:t}))))),o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(u,{height:null!=c?c:0})),null==i||isNaN(Number(i))?null:o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(b.b,{field:x,id:`destination-arrow-default-draggable-${e}-${s}-${x}-${i}`,isDraggable:l,value:i},o.a.createElement(j,{size:"xs"},o.a.createElement("span",null,`${r()(i).format("0,0")} ${y.a}`)))),o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(u,{height:null!=c?c:0})))}));w.displayName="DestinationArrow";const T=o.a.memo((({contextId:e,destinationBytes:t,destinationPackets:a,eventId:i,isDraggable:r,sourceBytes:s,sourcePackets:l})=>{const c=null!=s&&g(s)?s[0]:void 0,u=null!=l&&g(l)?l[0]:void 0,d=null!=t&&g(t)?t[0]:void 0,p=null!=a&&g(a)?a[0]:void 0,m=null!=c&&null!=d?(({numerator:e,denominator:t})=>{if(!(Math.abs(t)<Number.EPSILON)&&Number.isFinite(e)&&Number.isFinite(t))return e/t*100})({numerator:Number(c),denominator:Number(c)+Number(d)}):void 0,b=null!=m?100-m:void 0;return o.a.createElement(S,{alignItems:"center",justifyContent:"center",direction:"column",gutterSize:"none"},null!=c?o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(O,{contextId:e,eventId:i,isDraggable:r,sourceBytes:c,sourcePackets:u,sourceBytesPercent:m})):null,null!=d?o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(w,{contextId:e,destinationBytes:d,destinationPackets:p,destinationBytesPercent:b,eventId:i,isDraggable:r})):null)}));T.displayName="SourceDestinationArrows"},function(e,t,a){"use strict";a.d(t,"a",(function(){return k}));var n=a(32),i=a(284),r=a(4),s=a.n(r),o=a(33),l=a.n(o),c=a(44),u=a.n(c),d=a(1),p=a(88),m=a(77),g=a(303),b=a(191);const f=l()(n.EuiFlexItem).withConfig({displayName:"CountFlexItem",componentId:"sc-rk4fis-0"})(["",""],(({theme:e})=>`margin-right: ${e.eui.euiSizeS};`)),y=s.a.memo((({value:e})=>Object(b.a)(e)?s.a.createElement(s.a.Fragment,null,e):s.a.createElement("em",{"data-test-subj":"value-wrapper-empty"},g.c)));y.displayName="ValueWrapper";const h=({legendItem:e})=>{const[t]=Object(m.q)(d.Z),{color:a,count:i,dataProviderId:r,field:o,scopeId:l,value:c}=e;return s.a.createElement(n.EuiText,{size:"xs"},s.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"none",responsive:!1},null!=a&&s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(n.EuiHealth,{"data-test-subj":"legend-color",color:a})),s.a.createElement(n.EuiFlexItem,{grow:!0},s.a.createElement(n.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween",gutterSize:"none",responsive:!1},s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(p.b,{"data-test-subj":`legend-item-${r}`,field:o,hideTopN:!0,id:r,isDraggable:!1,scopeId:l,value:c},null==e.render?s.a.createElement(y,{value:c}):e.render({field:o,value:c}))),null!=i&&s.a.createElement(f,{"data-test-subj":"legendItemCount",grow:!1},u()(i).format(t))))))};h.displayName="DraggableLegendItemComponent";const E=s.a.memo(h),v=l.a.div.withConfig({displayName:"DraggableLegendContainer",componentId:"sc-hedj5c-0"})(["height:",";overflow:auto;scrollbar-width:thin;width:100%;@media only screen and (min-width:","){width:165px;}min-width:",";&::-webkit-scrollbar{height:",";width:",";}&::-webkit-scrollbar-thumb{background-clip:content-box;background-color:",";border:"," solid transparent;}&::-webkit-scrollbar-corner,&::-webkit-scrollbar-track{background-color:transparent;}"],(({height:e})=>`${e}px`),(({theme:e})=>e.eui.euiBreakpoints.m),(({$minWidth:e})=>`${e}px`),(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>Object(i.rgba)(e.eui.euiColorDarkShade,.5)),(({theme:e})=>e.eui.euiScrollBarCorner)),x=({className:e,height:t,legendItems:a,minWidth:i=165})=>0===a.length?null:s.a.createElement(v,{className:e,"data-test-subj":"draggable-legend",height:0===t?175:t,$minWidth:i},s.a.createElement(n.EuiText,{size:"xs"},s.a.createElement(n.EuiFlexGroup,{direction:"column",gutterSize:"none"},a.map((e=>s.a.createElement(n.EuiFlexItem,{key:e.dataProviderId,grow:!1},s.a.createElement(E,{legendItem:e}),s.a.createElement(n.EuiSpacer,{"data-test-subj":"draggable-legend-spacer",size:"s"})))))));x.displayName="DraggableLegendComponent";const k=s.a.memo(x)},function(e,t,a){"use strict";e.exports=a(726)},function(e,t,a){"use strict";e.exports=a(733)},function(e,t,a){"use strict";const n=a(736);e.exports=async(e,t,{concurrency:a=1/0,stopOnError:i=!0}={})=>new Promise(((r,s)=>{if("function"!=typeof t)throw new TypeError("Mapper function is required");if(!Number.isSafeInteger(a)&&a!==1/0||!(a>=1))throw new TypeError(`Expected \`concurrency\` to be an integer from 1 and up or \`Infinity\`, got \`${a}\` (${typeof a})`);const o=[],l=[],c=e[Symbol.iterator]();let u=!1,d=!1,p=0,m=0;const g=()=>{if(u)return;const e=c.next(),a=m;if(m++,e.done)return d=!0,void(0===p&&(i||0===l.length?r(o):s(new n(l))));p++,(async()=>{try{const n=await e.value;o[a]=await t(n,a),p--,g()}catch(e){i?(u=!0,s(e)):(l.push(e),p--,g())}})()};for(let e=0;e<a&&(g(),!d);e++);}))},function(e,t,a){"use strict";a.d(t,"a",(function(){return HostIsolationExceptionsApiClient}));var n=a(110),i=a(315),r=a(523);class HostIsolationExceptionsApiClient extends i.a{constructor(e){super(e,n.h,r.a)}static getInstance(e){return super.getInstance(e,n.h,r.a)}}},,,function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return r}));var n=a(0);const i=n.i18n.translate("xpack.securitySolution.beatFields.errorSearchDescription",{defaultMessage:"An error has occurred on getting beat fields"}),r=n.i18n.translate("xpack.securitySolution.beatFields.failSearchDescription",{defaultMessage:"Failed to run search on beat fields"})},function(e,t,a){var n=a(746),i=a(747);e.exports=function(e,t,a){return n(i,e,t,a)}},function(e,t,a){var n=a(434),i=a(435),r=i?function(e,t){return i.set(e,t),e}:n;e.exports=r},function(e,t,a){e.exports=a(27)(1542)},function(e,t,a){var n=a(749),i=n&&new n;e.exports=i},function(e,t,a){e.exports=a(27)(3432)},function(e,t,a){var n=a(438),i=a(439),r=a(752),s=a(269),o=a(440),l=a(446),c=a(769),u=a(337),d=a(270);e.exports=function e(t,a,p,m,g,b,f,y,h,E){var v=128&a,x=1&a,k=2&a,S=24&a,j=512&a,O=k?void 0:s(t);return function w(){for(var T=arguments.length,I=Array(T),C=T;C--;)I[C]=arguments[C];if(S)var M=l(w),F=r(I,M);if(m&&(I=n(I,m,g,S)),b&&(I=i(I,b,f,S)),T-=F,S&&T<E){var D=u(I,M);return o(t,a,e,w.placeholder,p,I,D,y,h,E-T)}var A=x?p:this,_=k?A[t]:t;return T=I.length,y?I=c(I,y):j&&T>1&&I.reverse(),v&&h<T&&(I.length=h),this&&this!==d&&this instanceof w&&(_=O||s(_)),_.apply(A,I)}}},function(e,t){var a=Math.max;e.exports=function(e,t,n,i){for(var r=-1,s=e.length,o=n.length,l=-1,c=t.length,u=a(s-o,0),d=Array(c+u),p=!i;++l<c;)d[l]=t[l];for(;++r<o;)(p||r<s)&&(d[n[r]]=e[r]);for(;u--;)d[l++]=e[r++];return d}},function(e,t){var a=Math.max;e.exports=function(e,t,n,i){for(var r=-1,s=e.length,o=-1,l=n.length,c=-1,u=t.length,d=a(s-l,0),p=Array(d+u),m=!i;++r<d;)p[r]=e[r];for(var g=r;++c<u;)p[g+c]=t[c];for(;++o<l;)(m||r<s)&&(p[g+n[o]]=e[r++]);return p}},function(e,t,a){var n=a(753),i=a(443),r=a(444);e.exports=function(e,t,a,s,o,l,c,u,d,p){var m=8&t;t|=m?32:64,4&(t&=~(m?64:32))||(t&=-4);var g=[e,t,o,m?l:void 0,m?c:void 0,m?void 0:l,m?void 0:c,u,d,p],b=a.apply(void 0,g);return n(e)&&i(b,g),b.placeholder=s,r(b,e,t)}},function(e,t,a){var n=a(435),i=a(754),r=n?function(e){return n.get(e)}:i;e.exports=r},function(e,t,a){var n=a(330),i=a(333);function r(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}r.prototype=n(i.prototype),r.prototype.constructor=r,e.exports=r},function(e,t,a){var n=a(433),i=a(759)(n);e.exports=i},function(e,t,a){var n=a(760),i=a(761),r=a(762),s=a(763);e.exports=function(e,t,a){var o=t+"";return r(e,i(o,s(n(o),a)))}},function(e,t,a){e.exports=a(27)(3400)},function(e,t){e.exports=function(e){return e.placeholder}},function(e,t,a){e.exports=a(27)(3384)},function(e,t,a){e.exports=a(27)(3399)},function(e,t,a){e.exports=a(27)(888)},function(e,t,a){e.exports=a(27)(3065)},function(e,t,a){var n=a(331);e.exports=function(e){return e==e&&!n(e)}},function(e,t){e.exports=function(e,t){return function(a){return null!=a&&a[e]===t&&(void 0!==t||e in Object(a))}}},function(e,t,a){e.exports=a(27)(1155)},function(e,t,a){e.exports=a(27)(3394)},function(e,t,a){var n=a(808),i=a(453),r=a(449),s=a(336),o=a(331),l=a(219);e.exports=function(e,t,a,c){if(!o(e))return e;for(var u=-1,d=(t=i(t,e)).length,p=d-1,m=e;null!=m&&++u<d;){var g=l(t[u]),b=a;if("prototype"==g&&r(m))throw new Error("Illegal access of function prototype");if(u!=p){var f=hasOwnProperty.call(m,g)?m[g]:void 0;void 0===(b=c?c(f,g,m):void 0)&&(b=o(f)?f:s(t[u+1])?[]:{})}n(m,g,b),m=m[g]}return e}},function(e,t,a){e.exports=a(27)(3572)},function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return s}));var n=a(401),i=a(132);const r=e=>Object(n.flow)(l)(e),s=e=>Object(n.flow)(o)(e),o=e=>{if("threat_match"===e.type&&null!=e.threat_mapping){const t=e.threat_mapping.map((e=>{const t=e.entries.map((e=>Object(i.d)(e)));return Object(i.d)({entries:t})}));return{...e,threat_mapping:t}}return e},l=e=>{if("threat_match"===e.type&&null!=e.threat_mapping){const t=e.threat_mapping.map((e=>{const t=e.entries.map((e=>Object(i.g)(e)));return{...Object(i.g)(e),entries:t}}));return{...e,threat_mapping:t}}return e}},function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(4),i=a.n(n),r=a(32),s=a(696);const o=Object(n.forwardRef)((({onChange:e,value:t,ariaLabel:a,editorId:o,dataTestSubj:l,height:c,autoFocusDisabled:u},d)=>{const[p,m]=Object(n.useState)([]),g=Object(n.useCallback)(((e,{messages:t})=>{m(e?[e]:t)}),[]),b=Object(n.useRef)(null);return Object(n.useEffect)((()=>{var e,t;u||null===(e=b.current)||void 0===e||null===(t=e.textarea)||void 0===t||t.focus()}),[u]),Object(n.useImperativeHandle)(d,(()=>{var e,t;if(!b.current)return null;const a=null===(e=b.current)||void 0===e||null===(t=e.textarea)||void 0===t?void 0:t.closest(".euiMarkdownEditor");return{...b.current,toolbar:null==a?void 0:a.querySelector(".euiMarkdownEditorToolbar")}})),i.a.createElement(r.EuiMarkdownEditor,{ref:b,"aria-label":a,editorId:o,onChange:e,value:t,uiPlugins:s.c,parsingPluginList:s.a,processingPluginList:s.b,onParse:g,errors:p,"data-test-subj":l,height:c})}));o.displayName="MarkdownEditorComponent";const l=Object(n.memo)(o)},function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(4),i=a.n(n),r=a(33),s=a.n(r),o=a(32),l=a(100),c=a(458);const u=s()(o.EuiFlexGroup).withConfig({displayName:"BottomContentWrapper",componentId:"sc-naitv4-0"})(["",""],(({theme:e})=>`\n    padding: ${e.eui.euiSizeM} 0;\n  `)),d=i.a.memo(Object(n.forwardRef)((({id:e,field:t,dataTestSubj:a,idAria:n,bottomRightContent:r},s)=>{const{isInvalid:d,errorMessage:p}=Object(l.i)(t);return i.a.createElement(o.EuiFormRow,{"data-test-subj":a,describedByIds:n?[n]:void 0,error:p,fullWidth:!0,helpText:t.helpText,isInvalid:d,label:t.label,labelAppend:t.labelAppend},i.a.createElement(i.a.Fragment,null,i.a.createElement(c.a,{ref:s,ariaLabel:n,editorId:e,onChange:t.setValue,value:t.value,"data-test-subj":`${a}-markdown-editor`}),r&&i.a.createElement(u,{justifyContent:"flexEnd"},i.a.createElement(o.EuiFlexItem,{grow:!1},r))))})));d.displayName="MarkdownEditorForm"},function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return l})),a.d(t,"c",(function(){return u}));var n=a(49),i=a(34),r=a(198);const s=e=>e.toLocaleString(),o=({chartHeight:e,from:t,legendPosition:a,to:i,onBrushEnd:o,yTickFormatter:l,showLegend:c})=>({series:{xScaleType:n.ScaleType.Time,yScaleType:n.ScaleType.Linear,stackAccessors:["g"]},axis:{xTickFormatter:Object(r.a)([t,i]),yTickFormatter:null!=l?l:s,tickSize:8},settings:{legendPosition:null!=a?a:n.Position.Right,onBrushEnd:o,showLegend:null==c||c,showLegendExtra:!0,theme:{scales:{barsPadding:.08},chartMargins:{left:0,right:0,top:0,bottom:0},chartPaddings:{left:0,right:0,top:0,bottom:0}}},customHeight:null!=e?e:174}),l=["#1EA593","#2B70F7","#CE0060","#38007E","#FCA5D3","#F37020","#E49E29","#B0916F","#7B000B","#34130C","#GGGGGG"],c=([e,t])=>({key:e,value:t}),u=(e,t)=>{if(!e)return[];const a=Object(i.groupBy)("g",e),n=Object(i.toPairs)(a);return Object(i.map)(c,n).map(((e,a)=>{var n;const r=Object(i.get)(e.key,t);return{...e,color:null!==(n=null==r?void 0:r.color)&&void 0!==n?n:l[a]}}))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return l}));var n=a(158),i=a(159),r=a(118);const s=e=>{var t,a;const i=null!==(t=null==e||null===(a=e.isPlatinumPlus)||void 0===a?void 0:a.call(e))&&void 0!==t&&t;return[{columnHeaderType:n.a,displayAsText:r.r,id:"kibana.alert.severity",initialWidth:105},{columnHeaderType:n.a,displayAsText:r.o,id:"kibana.alert.risk_score",initialWidth:100},{columnHeaderType:n.a,displayAsText:r.n,id:"kibana.alert.reason",initialWidth:450},{columnHeaderType:n.a,id:"host.name"},i?{columnHeaderType:n.a,id:"host.risk.calculated_level"}:null,{columnHeaderType:n.a,id:"user.name"},i?{columnHeaderType:n.a,id:"user.risk.calculated_level"}:null,{columnHeaderType:n.a,id:"process.name"},{columnHeaderType:n.a,id:"file.name"},{columnHeaderType:n.a,id:"source.ip"},{columnHeaderType:n.a,id:"destination.ip"}].filter((e=>null!=e))},o=e=>[{columnHeaderType:n.a,id:"@timestamp",initialWidth:i.b+10},{columnHeaderType:n.a,displayAsText:r.p,id:"kibana.alert.rule.name",initialWidth:i.a,linkField:"kibana.alert.rule.uuid"},...s(e)],l=e=>[{columnHeaderType:n.a,id:"kibana.alert.original_time",initialWidth:i.b+10},...s(e)]},function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return r}));var n=a(4);const i=({field:e,value:t})=>null==t?e:Array.isArray(t)?`${e} ${t.join(" ")}`:`${e} ${t}`,r=e=>{const[t,a]=Object(n.useState)(!1),i=Object(n.useCallback)((()=>{a((t=>{const a=!t;return e&&e(a),a}))}),[e]);return{closeTopN:Object(n.useCallback)((()=>{a(!1)}),[]),toggleTopN:i,isShowingTopN:t}}},function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return i})),a.d(t,"c",(function(){return r})),a.d(t,"d",(function(){return s}));const n={critical:"#E7664C",high:"#DA8B45",medium:"#D6BF57",low:"#54B399"},i=4,r=(e=0)=>Math.ceil(Math.min(e||0,100)/i),s={field:"kibana.alert.workflow_status",value:"open"}},function(e,t,a){"use strict";function n(e,t,a){return Math.max(Math.min(e,a),t)}function i(e,t,a){return e*(1-a)+t*a}a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}))},function(e,t,a){"use strict";function n(e,t){return"nodeEventsInCategory"===t.panelView&&t.panelParameters.nodeID===e.nodeID&&t.panelParameters.eventCategory===e.eventCategory}function i(e,t){return e.nodeID===t.nodeID&&e.eventCategory===t.eventCategory?{nodeID:e.nodeID,eventCategory:e.eventCategory,events:[...e.events,...t.events],cursor:t.cursor,lastCursorRequested:null}:void 0}a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}))},function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"c",(function(){return r})),a.d(t,"b",(function(){return s})),a.d(t,"d",(function(){return o}));var n=a(144);function i(e){return void 0!==(null==e?void 0:e.ancestry)?200:20}function r(e){return void 0!==(null==e?void 0:e.ancestry)?0:10}function s(){return 500}function o(e){const t=new Map;for(const a of e.nodes)if(a.stats){const e=n.b(a);t.set(e,a.stats)}return t}},function(e,t,a){"use strict";function n(e,t){return!!t&&(e===t||e.databaseDocumentID===t.databaseDocumentID&&e.filters.from===t.filters.from&&e.filters.to===t.filters.to&&function(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;const a=new Set(e);for(let e=0;e<t.length;e++)if(!a.has(t[e]))return!1;return!0}(e.indices,t.indices))}a.d(t,"a",(function(){return n}))},function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"f",(function(){return r})),a.d(t,"c",(function(){return s})),a.d(t,"d",(function(){return o})),a.d(t,"a",(function(){return l})),a.d(t,"e",(function(){return c}));var n=a(0);const i=n.i18n.translate("xpack.securitySolution.threatMatch.fieldDescription",{defaultMessage:"Field"}),r=n.i18n.translate("xpack.securitySolution.threatMatch.threatFieldDescription",{defaultMessage:"Indicator index field"}),s=n.i18n.translate("xpack.securitySolution.threatMatch.fieldPlaceholderDescription",{defaultMessage:"Search"}),o=n.i18n.translate("xpack.securitySolution.threatMatch.matchesLabel",{defaultMessage:"MATCHES"}),l=n.i18n.translate("xpack.securitySolution.threatMatch.andDescription",{defaultMessage:"AND"}),c=n.i18n.translate("xpack.securitySolution.threatMatch.orDescription",{defaultMessage:"OR"})},function(e,t,a){"use strict";a.d(t,"g",(function(){return i})),a.d(t,"n",(function(){return r})),a.d(t,"t",(function(){return s})),a.d(t,"r",(function(){return o})),a.d(t,"p",(function(){return l})),a.d(t,"q",(function(){return c})),a.d(t,"l",(function(){return u})),a.d(t,"f",(function(){return d})),a.d(t,"o",(function(){return p})),a.d(t,"w",(function(){return m})),a.d(t,"s",(function(){return g})),a.d(t,"m",(function(){return b})),a.d(t,"j",(function(){return f})),a.d(t,"k",(function(){return y})),a.d(t,"h",(function(){return h})),a.d(t,"i",(function(){return E})),a.d(t,"v",(function(){return v})),a.d(t,"u",(function(){return x})),a.d(t,"c",(function(){return k})),a.d(t,"d",(function(){return S})),a.d(t,"e",(function(){return j})),a.d(t,"a",(function(){return O})),a.d(t,"b",(function(){return w}));var n=a(0);const i=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.filtersLabel",{defaultMessage:"Filters"}),r=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.QueryLabel",{defaultMessage:"Custom query"}),s=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.threatQueryLabel",{defaultMessage:"Indicator index query"}),o=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.savedIdLabel",{defaultMessage:"Saved query name"}),l=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.savedQueryFiltersLabel",{defaultMessage:"Saved query filters"}),c=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.savedQueryLabel",{defaultMessage:"Saved query"}),u=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.mlRuleTypeDescription",{defaultMessage:"Machine Learning"}),d=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.eqlRuleTypeDescription",{defaultMessage:"Event Correlation"}),p=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.queryRuleTypeDescription",{defaultMessage:"Query"}),m=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.thresholdRuleTypeDescription",{defaultMessage:"Threshold"}),g=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.threatMatchRuleTypeDescription",{defaultMessage:"Indicator Match"}),b=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.newTermsRuleTypeDescription",{defaultMessage:"New Terms"}),f=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.mlRunJobLabel",{defaultMessage:"Run job"}),y=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.mlStopJobLabel",{defaultMessage:"Stop job"}),h=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.mlJobStartedDescription",{defaultMessage:"Started"}),E=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.mlJobStoppedDescription",{defaultMessage:"Stopped"}),v=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.thresholdResultsAllDescription",{defaultMessage:"All results"}),x=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.thresholdResultsAggregatedByDescription",{defaultMessage:"Results aggregated by"}),k=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.eqlEventCategoryFieldLabel",{defaultMessage:"Event category field"}),S=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.eqlTiebreakerFieldLabel",{defaultMessage:"Tiebreaker field"}),j=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.eqlTimestampFieldLabel",{defaultMessage:"Timestamp field"}),O=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.alertSuppressionInsufficientLicense",{defaultMessage:"Alert suppression is configured but will not be applied due to insufficient licensing"}),w=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.alertSuppressionTechnicalPreview",{defaultMessage:"Technical Preview"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(4),i=a.n(n),r=a(88),s=a(87),o=a(89);const l=i.a.memo((({Component:e,contextId:t,eventId:a,fieldName:n,fieldType:l,isAggregatable:c,isDraggable:u,title:d,value:p})=>u?i.a.createElement(r.b,{"data-test-subj":"port",field:n,fieldType:l,isAggregatable:c,id:`port-default-draggable-${t}-${a}-${n}-${p}`,isDraggable:u,tooltipContent:n,value:p},i.a.createElement(o.i,{portOrServiceName:p||Object(s.e)(),Component:e,title:d})):i.a.createElement(o.i,{portOrServiceName:p||Object(s.e)(),Component:e,title:d})));l.displayName="Port"},function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"e",(function(){return r})),a.d(t,"h",(function(){return s})),a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return l})),a.d(t,"d",(function(){return c})),a.d(t,"g",(function(){return u})),a.d(t,"f",(function(){return d}));var n=a(135);n.i,n.i,n.i;const i=`${n.i}.group.id`,r=(n.i,`${n.i}.original_time`),s=`${n.i}.threshold_result`,o=`${n.i}.new_terms`,l=`${n.A}.new_terms_fields`,c=`${n.i}.original_event`,u=(n.y,n.y,n.y,n.y,n.y,n.y,n.y,n.y,n.y,n.y,`${n.y}.timeline_id`),d=(n.y,n.y,`${n.y}.indices`)},function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(4),i=a(78),r=a(38),s=a(99),o=a(217);const l=({alertStatus:e,closePopover:t,eventId:a,scopeId:l,indexName:c,refetch:u})=>{const d=Object(i.useDispatch)(),{hasIndexWrite:p}=Object(o.a)(),m=Object(n.useCallback)((()=>{t(),u&&u()}),[t,u]),g=Object(s.getScopedActions)(l),b=Object(n.useCallback)((({eventIds:e,isLoading:t})=>{g&&d(g.setEventsLoading({id:l,eventIds:e,isLoading:t}))}),[d,l,g]),f=Object(n.useCallback)((({eventIds:e,isDeleted:t})=>{g&&d(g.setEventsDeleted({id:l,eventIds:e,isDeleted:t}))}),[d,l,g]),y=Object(r.useBulkActionItems)({eventIds:[a],currentStatus:e,indexName:c,setEventsLoading:b,setEventsDeleted:f,onUpdateSuccess:m,onUpdateFailure:m});return{actionItems:p?y:[]}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n="_id"},function(e,t,a){"use strict";a.d(t,"h",(function(){return d})),a.d(t,"j",(function(){return p})),a.d(t,"i",(function(){return m})),a.d(t,"k",(function(){return g})),a.d(t,"g",(function(){return b})),a.d(t,"b",(function(){return f})),a.d(t,"d",(function(){return y})),a.d(t,"c",(function(){return h})),a.d(t,"e",(function(){return E})),a.d(t,"a",(function(){return v})),a.d(t,"f",(function(){return j}));var n=a(32),i=a(34),r=a(4),s=a.n(r),o=a(33),l=a.n(o),c=a(88),u=a(475);const d="source.geo.continent_name",p="source.geo.country_name",m="source.geo.country_iso_code",g="source.geo.region_name",b="source.geo.city_name",f="destination.geo.continent_name",y="destination.geo.country_name",h="destination.geo.country_iso_code",E="destination.geo.region_name",v="destination.geo.city_name",x=[{prop:"GeoContinentName",fieldName:"geo.continent_name"},{prop:"GeoCountryName",fieldName:"geo.country_name"},{prop:"GeoCountryIsoCode",fieldName:"geo.country_iso_code"},{prop:"GeoRegionName",fieldName:"geo.region_name"},{prop:"GeoCityName",fieldName:"geo.city_name"}],k=l()(n.EuiFlexItem).withConfig({displayName:"GeoFlexItem",componentId:"sc-pwy3t3-0"})(["margin-right:5px;"]);k.displayName="GeoFlexItem";const S=s.a.memo((({contextId:e,eventId:t,fieldName:a,isDraggable:r,values:o})=>null!=o?s.a.createElement(s.a.Fragment,null,Object(i.uniq)(o).map((i=>s.a.createElement(k,{grow:!1,key:`${e}-${t}-${a}-${i}`},s.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},a===m||a===h?s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(u.a,{countryCode:i})):null,s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(c.b,{"data-test-subj":a,field:a,id:`geo-field-values-default-draggable-${e}-${t}-${a}-${i}`,isDraggable:r,tooltipContent:a,value:i}))))))):null));S.displayName="GeoFieldValues";const j=s.a.memo((e=>{const{contextId:t,eventId:a,isDraggable:r,type:o}=e,l=(e=>x.map((({prop:t,fieldName:a})=>({prop:`${e}${t}`,fieldName:`${e}.${a}`}))))(o);return s.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},Object(i.uniq)(l).map((n=>s.a.createElement(S,{contextId:t,eventId:a,fieldName:n.fieldName,isDraggable:r,key:n.fieldName,values:Object(i.get)(n.prop,e)}))))}));j.displayName="GeoFields"},function(e,t,a){"use strict";a.d(t,"a",(function(){return m})),a.d(t,"b",(function(){return g}));var n=a(4),i=a.n(n),r=a(34),s=a(32),o=a(959),l=a.n(o),c=a(962),u=a(33);const d=a.n(u).a.span.withConfig({displayName:"FlagWrapper",componentId:"sc-1v0q7zl-0"})(["position:relative;top:1px;"]),p=e=>e&&2===e.length?e.toUpperCase().replace(/./g,(e=>String.fromCharCode(55356,56741+e.charCodeAt(0)))):null,m=Object(n.memo)((({countryCode:e,displayCountryNameOnHover:t=!1})=>{Object(n.useEffect)((()=>{t&&Object(r.isEmpty)(l.a.getNames("en"))&&l.a.registerLocale(c)}),[]);const a=p(e);return null!==a?t?i.a.createElement(s.EuiToolTip,{position:"top",content:l.a.getName(e,"en")},i.a.createElement(d,{"data-test-subj":"country-flag"},a)):i.a.createElement(d,{"data-test-subj":"country-flag"},a):null}));m.displayName="CountryFlag";const g=Object(n.memo)((({countryCode:e,displayCountryNameOnHover:t=!1})=>{const[a,o]=Object(n.useState)(!1);Object(n.useEffect)((()=>{Object(r.isEmpty)(l.a.getNames("en"))&&l.a.registerLocale(c),o(!0)}),[]);const u=p(e);return null!==u&&a?t?i.a.createElement(s.EuiToolTip,{position:"top",content:l.a.getName(e,"en")},i.a.createElement(d,{"data-test-subj":"country-flag"},u)):i.a.createElement(i.a.Fragment,null,i.a.createElement(d,{"data-test-subj":"country-flag"},u),` ${l.a.getName(e,"en")}`):null}));g.displayName="CountryFlagAndName"},function(e,t,a){"use strict";a.d(t,"c",(function(){return m})),a.d(t,"b",(function(){return g})),a.d(t,"a",(function(){return f}));var n=a(32),i=a(34),r=a(4),s=a.n(r),o=a(33),l=a.n(o),c=a(88),u=a(305),d=a(101),p=a(722);const m="event.start",g="event.end",b=l()(n.EuiIcon).withConfig({displayName:"TimeIcon",componentId:"sc-1thf9pb-0"})(["margin-right:3px;position:relative;top:-1px;"]);b.displayName="TimeIcon";const f=s.a.memo((({contextId:e,eventDuration:t,eventId:a,eventEnd:r,eventStart:o,isDraggable:l})=>s.a.createElement(n.EuiFlexGroup,{alignItems:"flexStart","data-test-subj":"duration-and-start-group",direction:"column",justifyContent:"center",gutterSize:"none"},null!=t?Object(i.uniq)(t).map((t=>s.a.createElement(n.EuiFlexItem,{grow:!1,key:t},s.a.createElement(c.b,{field:u.b,id:`duration-event-start-end-default-draggable-${e}-${a}-${u.b}-${t}`,isDraggable:l,name:name,tooltipContent:null,value:t},s.a.createElement(n.EuiText,{size:"xs"},s.a.createElement(b,{size:"m",type:"clock"}),s.a.createElement(p.a,{maybeDurationNanoseconds:t,tooltipTitle:u.b})))))):null,null!=o?Object(i.uniq)(o).map((t=>s.a.createElement(n.EuiFlexItem,{grow:!1,key:t},s.a.createElement(c.b,{field:m,id:`duration-event-start-end-default-draggable-${e}-${a}-${m}-${t}`,isDraggable:l,tooltipContent:null,value:t},s.a.createElement(n.EuiText,{size:"xs"},s.a.createElement(b,{size:"m",type:"clock"}),s.a.createElement(d.a,{fieldName:m,value:t})))))):null,null!=r?Object(i.uniq)(r).map((t=>s.a.createElement(n.EuiFlexItem,{grow:!1,key:t},s.a.createElement(c.b,{field:g,id:`duration-event-start-end-default-draggable-${e}-${a}-${g}-${t}`,isDraggable:l,tooltipContent:null,value:t},s.a.createElement(n.EuiText,{size:"xs"},s.a.createElement(b,{size:"m",type:"clock"}),s.a.createElement(d.a,{fieldName:g,value:t})))))):null)));f.displayName="DurationEventStartEnd"},function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(4),i=a.n(n),r=a(88),s=a(97);const o=({args:e,contextId:t,eventId:a,processTitle:n,isDraggable:o})=>Object(s.e)(e)&&Object(s.e)(n)?null:i.a.createElement(i.a.Fragment,null,null!=e&&e.map(((e,n)=>i.a.createElement(s.c,{key:`${t}-args-${n}-${e}`,grow:!1,component:"span"},i.a.createElement(r.c,{contextId:`${t}-args-${n}-${e}`,eventId:a,field:"process.args",isDraggable:o,value:e,fieldType:"keyword",isAggregatable:!0})))),!Object(s.e)(n)&&i.a.createElement(s.c,{grow:!1,component:"span"},i.a.createElement(r.c,{contextId:t,eventId:a,field:"process.title",isDraggable:o,value:n,fieldType:"keyword",isAggregatable:!0})));o.displayName="ArgsComponent";const l=i.a.memo(o);l.displayName="Args"},function(e,t,a){"use strict";a.d(t,"a",(function(){return O})),a.d(t,"c",(function(){return R})),a.d(t,"b",(function(){return P}));var n=a(34),i=a(43),r=a.n(i),s=a(52),o=a.n(s),l=a(45),c=a(0),u=a(135),d=a(11),p=a(471),m=a(79),g=(a(193),a(697)),b=a(112),f=a(136),y=a(146),h=a(99),E=a(651),v=a(227),x=a(77),k=a(1),S=a(876),j=a(381);const O=e=>({query:{bool:{filter:{terms:{_id:e}}}}}),w=({ecs:e})=>{var t,a;if(Array.isArray(e)){const t=e.reduce(((e,t)=>{const a=t.timestamp?new Date(t.timestamp):new Date;return e.includes(a.valueOf())?e:[...e,a.valueOf()]}),[]);return{from:new Date(Math.min(...t)).toISOString(),to:new Date(Math.max(...t)).toISOString()}}const n=e,i=Object(h.getField)(n,u.u),s=r.a.duration(r()().diff(o.a.parse(null!=i?i[0]:"now-1d"))),l=r()(null!==(t=n.timestamp)&&void 0!==t?t:new Date).subtract(s).toISOString();return{to:r()(null!==(a=n.timestamp)&&void 0!==a?a:new Date).toISOString(),from:l}},T=e=>{const t=Object(h.getField)(e,u.H);return"threshold"===t||Array.isArray(t)&&t.length>0&&"threshold"===t[0]},I=e=>{const t=Object(h.getField)(e,u.H);return"new_terms"===t||Array.isArray(t)&&t.length>0&&"new_terms"===t[0]},C=e=>null!=Object(h.getField)(e,u.Q),M=(e,t,a="Alert Ids")=>1===t.length?[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:e,params:{query:t[0]}},query:{match_phrase:{_id:t[0]}},$state:{store:l.FilterStateStore.APP_STATE}}]:[{query:{bool:{filter:{ids:{values:t}}}},meta:{alias:a,negate:!1,disabled:!1,type:"phrases",key:e,value:t.join(),params:t},$state:{store:l.FilterStateStore.APP_STATE}}],F=(e,t)=>{const a=1===t.length;return[{and:[],id:`send-alert-to-timeline-action-default-draggable-event-details-value-formatted-field-value-${m.j.active}-alert-id-${t.join(",")}`,name:t.join(","),enabled:!0,excluded:!1,kqlQuery:"",queryMatch:{field:e,value:a?t[0]:t,operator:a?":":"includes"}}]},D=(e,t,a)=>({filters:"KqlFilter"===t?M("_id",e,a):[],dataProviders:"dataProvider"===t?F("_id",e):[]}),A=async(e,t,a,n,i)=>{try{var s,l,d,g,f,y,E,v,O,w,T,I,C,M,F,D,A,_,N,R,P,L;const c=await x.b.get().http.fetch(k.mb,{method:"POST",body:JSON.stringify(Object(S.a)([e._id]))}),j=(null!==(s=null==c?void 0:c.hits.hits.reduce(((e,{_id:t,_index:a,_source:n={}})=>[...e,{...Object(S.b)(n),_id:t,_index:a,timestamp:n["@timestamp"]}]),[]))&&void 0!==s?s:[])[0],B=Object(h.getField)(j,u.A),q=(null!==(l=null!==(d=B.filters)&&void 0!==d?d:null===(g=j.signal)||void 0===g||null===(f=g.rule)||void 0===f?void 0:f.filters)&&void 0!==l?l:[]).map((e=>null!=e.meta?e:{...e,meta:{}})),z=null!==(y=null!==(E=B.language)&&void 0!==E?E:null===(v=j.signal)||void 0===v||null===(O=v.rule)||void 0===O?void 0:O.language)&&void 0!==y?y:"kuery",$=null!==(w=null!==(T=B.query)&&void 0!==T?T:null===(I=j.signal)||void 0===I||null===(C=I.rule)||void 0===C?void 0:C.query)&&void 0!==w?w:"",V=null!==(M=null!==(F=Object(h.getField)(j,p.f))&&void 0!==F?F:null===(D=j.signal)||void 0===D||null===(A=D.rule)||void 0===A?void 0:A.index)&&void 0!==M?M:[],{thresholdFrom:U,thresholdTo:H,dataProviders:G}=(e=>(Array.isArray(e)?e:[e]).reduce(((e,t)=>{var a,n,i,s;const l=null!==(a=Object(h.getField)(t,`${u.A}.threshold`))&&void 0!==a?a:null===(n=t.signal)||void 0===n||null===(i=n.rule)||void 0===i?void 0:i.threshold,c=Object(h.getField)(t,p.h),d=Object(h.getField)(t,p.e),g=Array.isArray(d)?d[0]:d,b=r()(g),f=((e,t)=>{const a=Object(h.getField)(e,u.u),n=Array.isArray(a)?a[0]:a,i=o.a.parse(n),s=r()(),l=r.a.duration(s.diff(i));return t.clone().subtract(l)})(t,b),y=Array.isArray(l.field)?l.field:[l.field];return{thresholdFrom:null!==(s=c.from)&&void 0!==s?s:f.toISOString(),thresholdTo:b.toISOString(),dataProviders:[...e.dataProviders,...y.reduce(((e,t,a)=>{const n=c.terms.filter((e=>e.field===t))[0].value,i=Array.isArray(n)?n[0]:n;if(!i)return e;const r=t.replace(".","-"),s={id:`send-alert-to-timeline-action-default-draggable-event-details-value-formatted-field-value-${m.j.active}-${r}-${i}`,name:t,enabled:!0,excluded:!1,kqlQuery:"",queryMatch:{field:t,value:i,operator:":"}};return 0===a?[...e,{...s,and:[]}]:(e[0].and.push(s),e)}),[])]}}),{dataProviders:[],thresholdFrom:"",thresholdTo:""}))(j),Q=await i(e),W=(null!==(_=n.filters)&&void 0!==_?_:q).concat(Q?[Q]:[]);return t({from:U,notes:null,timeline:{...b.b,columns:null!==(N=n.columns)&&void 0!==N?N:b.b.columns,description:`_id: ${j._id}`,filters:W,dataProviders:null!==(R=n.dataProviders)&&void 0!==R?R:G,id:m.j.active,indexNames:V,dateRange:{start:U,end:H},eventType:"all",kqlQuery:{filterQuery:{kuery:{kind:z,expression:null!==(P=n.query)&&void 0!==P?P:$},serializedQuery:null!==(L=n.query)&&void 0!==L?L:$}}},to:H,ruleNote:a})}catch(a){const{toasts:n}=x.b.get().notifications;n.addError(a,{toastMessage:c.i18n.translate("xpack.securitySolution.detectionEngine.alerts.createThresholdTimelineFailure",{defaultMessage:"Failed to create timeline for document _id: {id}",values:{id:e._id}}),title:c.i18n.translate("xpack.securitySolution.detectionEngine.alerts.createThresholdTimelineFailureTitle",{defaultMessage:"Failed to create threshold alert timeline"})});const i=j.a.toISOString(),r=j.b.toISOString();return t({from:i,notes:null,timeline:{...b.b,id:m.j.active,indexNames:[],dateRange:{start:i,end:r},eventType:"all"},to:r})}},_=async(e,t,a,n,i)=>{try{var s,o,l,d,g,f,y,E,v,O,w,T,I,C,M,F,D,A,_,N,R,P;const c=await x.b.get().http.fetch(k.mb,{method:"POST",body:JSON.stringify(Object(S.a)([e._id]))}),j=(null!==(s=null==c?void 0:c.hits.hits.reduce(((e,{_id:t,_index:a,_source:n={}})=>[...e,{...Object(S.b)(n),_id:t,_index:a,timestamp:n["@timestamp"]}]),[]))&&void 0!==s?s:[])[0],L=Object(h.getField)(j,u.A),B=(null!==(o=null!==(l=L.filters)&&void 0!==l?l:null===(d=j.signal)||void 0===d||null===(g=d.rule)||void 0===g?void 0:g.filters)&&void 0!==o?o:[]).map((e=>null!=e.meta?e:{...e,meta:{}})),q=null!==(f=null!==(y=L.language)&&void 0!==y?y:null===(E=j.signal)||void 0===E||null===(v=E.rule)||void 0===v?void 0:v.language)&&void 0!==f?f:"kuery",z=null!==(O=null!==(w=L.query)&&void 0!==w?w:null===(T=j.signal)||void 0===T||null===(I=T.rule)||void 0===I?void 0:I.query)&&void 0!==O?O:"",$=null!==(C=null!==(M=Object(h.getField)(j,p.f))&&void 0!==M?M:null===(F=j.signal)||void 0===F||null===(D=F.rule)||void 0===D?void 0:D.index)&&void 0!==C?C:[],{from:V,to:U,dataProviders:H}=(e=>{var t;const a=Array.isArray(e)?e[0]:e,n=Object(h.getField)(a,p.e),i=(null!==(t=Object(h.getField)(a,`${u.A}.new_terms_fields`))&&void 0!==t?t:[]).map(((e,t)=>{const n=e.replace(".","-"),i=Object(h.getField)(a,p.b)[t];return{id:`send-alert-to-timeline-action-default-draggable-event-details-value-formatted-field-value-${m.j.active}-${n}-${i}`,name:e,enabled:!0,excluded:!1,kqlQuery:"",queryMatch:{field:e,value:i,operator:":"},and:[]}})),s=i.length?[{...i[0],and:i.slice(1)}]:[];return{from:n,to:r()().toISOString(),dataProviders:s}})(j),G=await i(e),Q=(null!==(A=n.filters)&&void 0!==A?A:B).concat(G?[G]:[]);return t({from:V,notes:null,timeline:{...b.b,columns:null!==(_=n.columns)&&void 0!==_?_:b.b.columns,description:`_id: ${j._id}`,filters:Q,dataProviders:null!==(N=n.dataProviders)&&void 0!==N?N:H,id:m.j.active,indexNames:$,dateRange:{start:V,end:U},eventType:"all",kqlQuery:{filterQuery:{kuery:{kind:q,expression:null!==(R=n.query)&&void 0!==R?R:z},serializedQuery:null!==(P=n.query)&&void 0!==P?P:z}}},to:U,ruleNote:a})}catch(a){const{toasts:n}=x.b.get().notifications;n.addError(a,{toastMessage:c.i18n.translate("xpack.securitySolution.detectionEngine.alerts.createNewTermsTimelineFailure",{defaultMessage:"Failed to create timeline for document _id: {id}",values:{id:e._id}}),title:c.i18n.translate("xpack.securitySolution.detectionEngine.alerts.createNewTermsTimelineFailureTitle",{defaultMessage:"Failed to create new terms alert timeline"})});const i=j.a.toISOString(),r=j.b.toISOString();return t({from:i,notes:null,timeline:{...b.b,id:m.j.active,indexNames:[],dateRange:{start:i,end:r},eventType:"all"},to:r})}},N=async(e,t,a,n,i)=>{try{var r,s,o,l,d,g,f,y,E,v,O,w,T,I,C,M,F,D,A,_,N,R;const c=await x.b.get().http.fetch(k.mb,{method:"POST",body:JSON.stringify(Object(S.a)([e._id]))}),j=(null!==(r=null==c?void 0:c.hits.hits.reduce(((e,{_id:t,_index:a,_source:n={}})=>[...e,{...Object(S.b)(n),_id:t,_index:a,timestamp:n["@timestamp"]}]),[]))&&void 0!==r?r:[])[0],P=Object(h.getField)(j,u.A),L=(null!==(s=null!==(o=P.filters)&&void 0!==o?o:null===(l=j.signal)||void 0===l||null===(d=l.rule)||void 0===d?void 0:d.filters)&&void 0!==s?s:[]).map((e=>null!=e.meta?e:{...e,meta:{}})),B=null!==(g=null!==(f=P.language)&&void 0!==f?f:null===(y=j.signal)||void 0===y||null===(E=y.rule)||void 0===E?void 0:E.language)&&void 0!==g?g:"kuery",q=null!==(v=null!==(O=P.query)&&void 0!==O?O:null===(w=j.signal)||void 0===w||null===(T=w.rule)||void 0===T?void 0:T.query)&&void 0!==v?v:"",z=null!==(I=null!==(C=Object(h.getField)(j,p.f))&&void 0!==C?C:null===(M=j.signal)||void 0===M||null===(F=M.rule)||void 0===F?void 0:F.index)&&void 0!==I?I:[],{from:$,to:V,dataProviders:U}=(e=>{const t=Array.isArray(e)?e[0]:e,a=Object(h.getField)(t,u.T),n=Object(h.getField)(t,u.R),i=Object(h.getField)(t,u.U).map((e=>{const t=e.field.replace(".","-"),a=`send-alert-to-timeline-action-default-draggable-event-details-value-formatted-field-value-${m.j.active}-${t}-${e.value}`;return null==e.value?{id:a,name:t,enabled:!0,excluded:!0,kqlQuery:"",queryMatch:{field:e.field,value:"",operator:":*"}}:{id:a,name:t,enabled:!0,excluded:!1,kqlQuery:"",queryMatch:{field:e.field,value:e.value,operator:":"}}}));return{from:a,to:n,dataProviders:[{...i[0],and:i.slice(1)}]}})(j),H=await i(e),G=(null!==(D=n.filters)&&void 0!==D?D:L).concat(H?[H]:[]);return t({from:$,notes:null,timeline:{...b.b,columns:null!==(A=n.columns)&&void 0!==A?A:b.b.columns,description:`_id: ${j._id}`,filters:G,dataProviders:null!==(_=n.dataProviders)&&void 0!==_?_:U,id:m.j.active,indexNames:z,dateRange:{start:$,end:V},eventType:"all",kqlQuery:{filterQuery:{kuery:{kind:B,expression:null!==(N=n.query)&&void 0!==N?N:q},serializedQuery:null!==(R=n.query)&&void 0!==R?R:q}}},to:V,ruleNote:a})}catch(a){const{toasts:n}=x.b.get().notifications;n.addError(a,{toastMessage:c.i18n.translate("xpack.securitySolution.detectionEngine.alerts.createSuppressedTimelineFailure",{defaultMessage:"Failed to create timeline for document _id: {id}",values:{id:e._id}}),title:c.i18n.translate("xpack.securitySolution.detectionEngine.alerts.createSuppressedTimelineFailureTitle",{defaultMessage:"Failed to create suppressed alert timeline"})});const i=j.a.toISOString(),r=j.b.toISOString();return t({from:i,notes:null,timeline:{...b.b,id:m.j.active,indexNames:[],dateRange:{start:i,end:r},eventType:"all"},to:r})}},R=(e,t,a="dataProvider",n)=>{const i=Array.isArray(t)?t.map((e=>e._id)):[],{to:r,from:s}=w({ecs:t}),{dataProviders:o,filters:l}=D(i,a,n||`${t.length} event IDs`);e({from:s,notes:null,timeline:{...b.b,dataProviders:o,id:m.j.active,indexNames:[],dateRange:{start:s,end:r},eventType:"all",filters:l,kqlQuery:{filterQuery:{kuery:{kind:"kuery",expression:""},serializedQuery:""}}},to:r})},P=async({createTimeline:e,ecsData:t,updateTimelineIsLoading:a,searchStrategyClient:i,getExceptionFilter:r})=>{const s=Array.isArray(t)?t[0]:t,o=Object(h.getField)(s,u.z),l=Array.isArray(o)&&o.length>0?o[0]:"",c=Object(h.getField)(s,p.g),x=Object(n.isEmpty)(c)?"":Array.isArray(c)?c[0]:c,{to:k,from:S}=w({ecs:t});if(Object(n.isEmpty)(x)){if(T(s))return A(s,e,l,{},r);if(I(s))return _(s,e,l,{},r);if(C(s))return N(s,e,l,{},r);{let{dataProviders:a,filters:i}=D([s._id],"dataProvider");if((e=>{const t=Object(h.getField)(e,u.H),a=Object(h.getField)(e,p.a);return("eql"===t||Array.isArray(t)&&"eql"===t[0])&&(null==a?void 0:a.length)>0})(s)){const e=((e,t)=>{if(!Object(n.isEmpty)(e)&&Array.isArray(t)&&t.length>1)return{dataProviders:[],filters:M(p.a,t.reduce(((e,t)=>{const a=Object(h.getField)(t,p.a),n=Array.isArray(a)?a[0]:a;return e.includes(n)?e:[...e,n]}),[]))};if(!Array.isArray(t)||1===t.length){const e=Array.isArray(t)?t[0]:t,a=Object(h.getField)(e,p.a),n=Object(h.getFieldKey)(e,p.a),i=Array.isArray(a)?a[0]:a;return{dataProviders:[{and:[],id:`send-alert-to-timeline-action-default-draggable-event-details-value-formatted-field-value-${m.j.active}-alert-id-${i}`,name:e._id,enabled:!0,excluded:!1,kqlQuery:"",queryMatch:{field:n,value:i,operator:":"}}],filters:[]}}return{filters:[],dataProviders:[]}})([s._id],t);a=e.dataProviders,i=e.filters}return e({from:S,notes:null,timeline:{...b.b,dataProviders:a,id:m.j.active,indexNames:[],dateRange:{start:S,end:k},eventType:"all",filters:i,kqlQuery:{filterQuery:{kuery:{kind:"kuery",expression:""},serializedQuery:""}}},to:k,ruleNote:l})}}try{var j,O;a({id:m.j.active,isLoading:!0});const[t,o]=await Promise.all([Object(v.d)(x),Object(d.lastValueFrom)(i.search({defaultIndex:[],indexName:null!==(j=s._index)&&void 0!==j?j:"",eventId:s._id,factoryQueryType:g.c.details},{strategy:"timelineSearchStrategy"}))]),c=Object(n.getOr)({},"data.getOneTimeline",t),u=null!==(O=o.data)&&void 0!==O?O:[];if(!Object(n.isEmpty)(c)){var F,R,P,L,B,q,z;const t=Object(f.g)(c),{timeline:a,notes:n}=Object(f.c)(t,!0,null!==(F=t.timelineType)&&void 0!==F?F:m.n.default),i=Object(E.d)(null!==(R=null===(P=a.kqlQuery)||void 0===P||null===(L=P.filterQuery)||void 0===L||null===(B=L.kuery)||void 0===B?void 0:B.expression)&&void 0!==R?R:"",u,a.timelineType),o=Object(E.c)(null!==(q=a.filters)&&void 0!==q?q:[],u),d=Object(E.b)(null!==(z=a.dataProviders)&&void 0!==z?z:[],u,a.timelineType);return T(s)?A(s,e,l,{filters:o,query:i,dataProviders:d,columns:a.columns},r):I(s)?_(s,e,l,{filters:o,query:i,dataProviders:d,columns:a.columns},r):C(s)?N(s,e,l,{filters:o,query:i,dataProviders:d,columns:a.columns},r):e({from:S,timeline:{...a,title:"",timelineType:m.n.default,templateTimelineId:null,status:m.l.draft,dataProviders:d,eventType:"all",filters:o,dateRange:{start:S,end:k},kqlQuery:{filterQuery:{kuery:{kind:null!==($=null===(V=a.kqlQuery)||void 0===V||null===(U=V.filterQuery)||void 0===U||null===(H=U.kuery)||void 0===H?void 0:H.kind)&&void 0!==$?$:"kuery",expression:i},serializedQuery:Object(y.b)(i)}},noteIds:null!==(G=null==n?void 0:n.map((e=>e.noteId)))&&void 0!==G?G:[],show:!0},to:k,ruleNote:l,notes:null!=n?n:null});var $,V,U,H,G}}catch{return a({id:m.j.active,isLoading:!1}),e({from:S,notes:null,timeline:{...b.b,id:m.j.active,indexNames:[],dateRange:{start:S,end:k},eventType:"all"},to:k})}}},function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return r})),a.d(t,"a",(function(){return s}));var n=a(0);const i=n.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.viewListDetailActionLabel",{defaultMessage:"View list detail"}),r=n.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.viewRuleDetailActionLabel",{defaultMessage:"View rule detail"}),s=n.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToRulesTableSelection.link_column",{defaultMessage:"Link"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(129),i=a(1);const r=Object(n.d)((async({name:e,description:t,http:a,signal:n})=>await a.post(i.rc,{body:JSON.stringify({name:e,description:t}),headers:{"Content-Type":"application/json"},method:"POST",signal:n}))),s=()=>Object(n.a)(r)},function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return r})),a.d(t,"c",(function(){return s}));var n=a(0);const i=n.i18n.translate("xpack.securitySolution.exceptions.list.exception.item.card.edit.label",{defaultMessage:"Edit rule exception"}),r=n.i18n.translate("xpack.securitySolution.exceptions.list.exception.item.card.delete.label",{defaultMessage:"Delete rule exception"}),s=n.i18n.translate("xpack.securitySolution.exceptions.list.utility.title",{defaultMessage:"rule exceptions"})},function(e,t,a){const n=a(152);e.exports=(e,t,a)=>0===n(e,t,a)},function(e,t,a){const n=a(125);e.exports=(e,t,a)=>{const i=new n(e,a),r=new n(t,a);return i.compare(r)||i.compareBuild(r)}},function(e,t,a){const n=a(152);e.exports=(e,t,a)=>n(e,t,a)<0},function(e,t,a){const n=a(125),i=a(364),{ANY:r}=i,s=a(163),o=a(365),l=a(362),c=a(484),u=a(321),d=a(363);e.exports=(e,t,a,p)=>{let m,g,b,f,y;switch(e=new n(e,p),t=new s(t,p),a){case">":m=l,g=u,b=c,f=">",y=">=";break;case"<":m=c,g=d,b=l,f="<",y="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(o(e,t,p))return!1;for(let a=0;a<t.set.length;++a){const n=t.set[a];let s=null,o=null;if(n.forEach((e=>{e.semver===r&&(e=new i(">=0.0.0")),s=s||e,o=o||e,m(e.semver,s.semver,p)?s=e:b(e.semver,o.semver,p)&&(o=e)})),s.operator===f||s.operator===y)return!1;if((!o.operator||o.operator===f)&&g(e,o.semver))return!1;if(o.operator===y&&b(e,o.semver))return!1}return!0}},function(e,t,a){"use strict";e.exports=function(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}},function(e,t,a){"use strict";e.exports=function(e){return null==e?[]:"length"in e?e:[e]}},function(e,t,a){"use strict";var n=a(200);e.exports=function(e,t){return e.length?(n(e,e.length,0,t),e):t}},function(e,t,a){"use strict";e.exports=function(e,t,a){for(var n,i=[],r=-1;++r<e.length;)(n=e[r].resolveAll)&&i.indexOf(n)<0&&(t=n(t,a),i.push(n));return t}},function(e,t,a){"use strict";var n=a(202)(/[A-Za-z]/);e.exports=n},function(e,t,a){"use strict";var n=a(201),i=a(488),r=a(200),s=a(486),o=a(489),l=a(263),c=a(670),u=a(671),d=a(673),p=a(672),m={name:"labelEnd",tokenize:function(e,t,a){for(var n,i,r=this,o=r.events.length;o--;)if(("labelImage"===r.events[o][1].type||"labelLink"===r.events[o][1].type)&&!r.events[o][1]._balanced){n=r.events[o][1];break}return function(t){return n?n._inactive?c(t):(i=r.parser.defined.indexOf(s(r.sliceSerialize({start:n.end,end:r.now()})))>-1,e.enter("labelEnd"),e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelEnd"),l):a(t)};function l(a){return 40===a?e.attempt(g,t,i?t:c)(a):91===a?e.attempt(b,t,i?e.attempt(f,t,c):c)(a):i?t(a):c(a)}function c(e){return n._balanced=!0,a(e)}},resolveTo:function(e,t){for(var a,n,s,c,u,d,p,m=e.length,g=0;m--;)if(c=e[m][1],u){if("link"===c.type||"labelLink"===c.type&&c._inactive)break;"enter"===e[m][0]&&"labelLink"===c.type&&(c._inactive=!0)}else if(d){if("enter"===e[m][0]&&("labelImage"===c.type||"labelLink"===c.type)&&!c._balanced&&(u=m,"labelLink"!==c.type)){g=2;break}}else"labelEnd"===c.type&&(d=m);return a={type:"labelLink"===e[u][1].type?"link":"image",start:l(e[u][1].start),end:l(e[e.length-1][1].end)},n={type:"label",start:l(e[u][1].start),end:l(e[d][1].end)},s={type:"labelText",start:l(e[u+g+2][1].end),end:l(e[d-2][1].start)},p=i(p=[["enter",a,t],["enter",n,t]],e.slice(u+1,u+g+3)),p=i(p,[["enter",s,t]]),p=i(p,o(t.parser.constructs.insideSpan.null,e.slice(u+g+4,d-3),t)),p=i(p,[["exit",s,t],e[d-2],e[d-1],["exit",n,t]]),p=i(p,e.slice(d+1)),p=i(p,[["exit",a,t]]),r(e,u,e.length,p),e},resolveAll:function(e){for(var t,a=-1;++a<e.length;)(t=e[a][1])._used||"labelImage"!==t.type&&"labelLink"!==t.type&&"labelEnd"!==t.type||(e.splice(a+1,"labelImage"===t.type?4:2),t.type="data",a++);return e}},g={tokenize:function(e,t,a){return function(t){return e.enter("resource"),e.enter("resourceMarker"),e.consume(t),e.exit("resourceMarker"),p(e,i)};function i(t){return 41===t?o(t):c(e,r,a,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",3)(t)}function r(t){return n(t)?p(e,s)(t):o(t)}function s(t){return 34===t||39===t||40===t?d(e,p(e,o),a,"resourceTitle","resourceTitleMarker","resourceTitleString")(t):o(t)}function o(n){return 41===n?(e.enter("resourceMarker"),e.consume(n),e.exit("resourceMarker"),e.exit("resource"),t):a(n)}}},b={tokenize:function(e,t,a){var n=this;return function(t){return u.call(n,e,i,a,"reference","referenceMarker","referenceString")(t)};function i(e){return n.parser.defined.indexOf(s(n.sliceSerialize(n.events[n.events.length-1][1]).slice(1,-1)))<0?a(e):t(e)}}},f={tokenize:function(e,t,a){return function(t){return e.enter("reference"),e.enter("referenceMarker"),e.consume(t),e.exit("referenceMarker"),n};function n(n){return 93===n?(e.enter("referenceMarker"),e.consume(n),e.exit("referenceMarker"),e.exit("reference"),t):a(n)}}};e.exports=m},function(e,t,a){"use strict";a.d(t,"d",(function(){return i})),a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return s})),a.d(t,"g",(function(){return o})),a.d(t,"e",(function(){return l})),a.d(t,"i",(function(){return c})),a.d(t,"j",(function(){return u})),a.d(t,"h",(function(){return d})),a.d(t,"f",(function(){return p})),a.d(t,"k",(function(){return m})),a.d(t,"c",(function(){return g}));var n=a(0);const i=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.advancedSettingsButton",{defaultMessage:"Advanced settings"}),r=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.addReferenceDescription",{defaultMessage:"Add reference URL"}),s=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.addFalsePositiveDescription",{defaultMessage:"Add false positive example"}),o=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.endpointExceptionListLabel",{defaultMessage:"Elastic Endpoint exceptions"}),l=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.buildingBlockLabel",{defaultMessage:"Building block"}),c=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionLowDescription",{defaultMessage:"Low"}),u=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionMediumDescription",{defaultMessage:"Medium"}),d=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionHighDescription",{defaultMessage:"High"}),p=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionCriticalDescription",{defaultMessage:"Critical"}),m=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.referencesUrlInvalidError",{defaultMessage:"URL is invalid format"}),g=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutrule.noteHelpText",{defaultMessage:"Add rule investigation guide..."})},function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(4),i=a.n(n),r=a(32),s=a(113);const o=i.a.memo((({onClick:e,isDisabled:t,dataTestSubj:a="nextStep-continue"})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiHorizontalRule,{margin:"m"}),i.a.createElement(r.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd",gutterSize:"xs",responsive:!1},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButton,{fill:!0,onClick:e,isDisabled:t,"data-test-subj":a},s.pb))))));o.displayName="NextStep"},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(4),i=a(48),r=a(77);const s=()=>{const e=Object(r.k)(),{http:t}=e.services,[a,s]=Object(n.useState)(Object(i.createSavedQueryService)(t));return Object(n.useEffect)((()=>{s(Object(i.createSavedQueryService)(t))}),[t]),a}},function(e,t,a){"use strict";a.d(t,"c",(function(){return i})),a.d(t,"b",(function(){return r})),a.d(t,"e",(function(){return s})),a.d(t,"d",(function(){return o})),a.d(t,"h",(function(){return l})),a.d(t,"n",(function(){return c})),a.d(t,"m",(function(){return u})),a.d(t,"l",(function(){return d})),a.d(t,"i",(function(){return p})),a.d(t,"j",(function(){return m})),a.d(t,"o",(function(){return g})),a.d(t,"k",(function(){return b})),a.d(t,"g",(function(){return f})),a.d(t,"f",(function(){return y})),a.d(t,"p",(function(){return h})),a.d(t,"q",(function(){return E})),a.d(t,"a",(function(){return v})),a.d(t,"r",(function(){return x})),a.d(t,"s",(function(){return k}));var n=a(0);const i=n.i18n.translate("xpack.securitySolution.stepDefineRule.lastHour",{defaultMessage:"Last hour"}),r=n.i18n.translate("xpack.securitySolution.stepDefineRule.lastDay",{defaultMessage:"Last day"}),s=n.i18n.translate("xpack.securitySolution.stepDefineRule.lastWeek",{defaultMessage:"Last week"}),o=n.i18n.translate("xpack.securitySolution.stepDefineRule.lastMonth",{defaultMessage:"Last month"}),l=(n.i18n.translate("xpack.securitySolution.stepDefineRule.previewQueryButton",{defaultMessage:"Preview results"}),n.i18n.translate("xpack.securitySolution.stepDefineRule.quickPreviewToggleButton",{defaultMessage:"Quick query preview"}),n.i18n.translate("xpack.securitySolution.stepDefineRule.advancedPreviewToggleButton",{defaultMessage:"Advanced query preview"}),n.i18n.translate("xpack.securitySolution.stepDefineRule.previewTimeoutWarning",{defaultMessage:"Preview timed out after 60 seconds"})),c=(n.i18n.translate("xpack.securitySolution.stepDefineRule.previewQueryAriaLabel",{defaultMessage:"Query preview timeframe select"}),n.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewLabel",{defaultMessage:"Select a preview timeframe"})),u=n.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewInvocationCountWarningTitle",{defaultMessage:"Rule preview timeframe might cause timeout"}),d=n.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewInvocationCountWarningMessage",{defaultMessage:"The timeframe and rule interval that you selected for previewing this rule might cause timeout or take long time to execute. Try to decrease the timeframe and/or increase the interval if preview has timed out (this won't affect the actual rule run)."}),p=n.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryGraphCountLabel",{defaultMessage:"Count"}),m=n.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewTitle",{defaultMessage:"Rule Preview"}),g=n.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryGraphPreviewNoiseWarning",{defaultMessage:"Noise warning: This rule may cause a lot of noise. Consider narrowing your query. This is based on a linear progression of 1 alert per hour."}),b=n.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryGraphPreviewError",{defaultMessage:"Error fetching preview"}),f=n.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.histogramDisclaimer",{defaultMessage:"Note: Alerts with multiple event.category values will be counted more than once."}),y=n.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.mlHistogramDisclaimer",{defaultMessage:"Note: Alerts with multiple host.name values will be counted more than once."}),h=n.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewSeeAllErrors",{defaultMessage:"See all errors"}),E=n.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewSeeAllWarnings",{defaultMessage:"See all warnings"}),v=n.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.actions",{defaultMessage:"Actions"}),x=n.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.viewDetailsAriaLabel",{defaultMessage:"View details"}),k=({ariaRowindex:e,columnValues:t})=>n.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.viewDetailsForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t},defaultMessage:"View details for the alert or event in row {ariaRowindex}, with columns {columnValues}"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(4),i=a(84),r=a(680);function s(){const e=Object(i.a)();return Object(n.useCallback)((({actionType:t,error:a})=>{e.addError(function(e){return e.stack=JSON.stringify(e.body,null,2),e}(a),{title:Object(r.d)(t),toastMessage:Object(r.b)(t,a)})}),[e])}},function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var n=a(4),i=a(93),r=a(195),s=a(32),o=a(89),l=a(1),c=a(498),u=a(168),d=a(724);const p=({exceptionsList:e,handleExport:t,handleDelete:a,handleManageRules:p})=>{const[m,g]=Object(n.useState)(r.i.LOADING),[b,f]=Object(n.useState)(),[y,h]=Object(n.useState)(!1),[E,v]=Object(n.useState)(!1),{name:x,list_id:k,rules:S,type:j,created_by:O,created_at:w,description:T}=e,I=Object(n.useCallback)((()=>{g("")}),[g]),C=e=>{f(e),v(!0)},{lastUpdated:M,exceptionViewerStatus:F,exceptions:D,pagination:A,ruleReferences:_,fetchItems:N,onDeleteException:R,onPaginationChange:P}=Object(c.a)({list:e,deleteToastTitle:u.r,deleteToastBody:e=>u.q(e),errorToastBody:u.m,errorToastTitle:u.n,onEditListExceptionItem:C,onFinishFetchingExceptions:I});Object(n.useEffect)((()=>{N(null,r.i.LOADING)}),[N]);const[L,B]=Object(n.useState)(!1),q=Object(s.useGeneratedHtmlId)({prefix:"openAccordion"}),z=Object(d.a)(e),$=Object(n.useMemo)((()=>m===r.i.EMPTY?u.x:""),[m]),V=Object(n.useMemo)((()=>m===r.i.EMPTY?u.u(e.name):""),[e.name,m]),U=Object(n.useMemo)((()=>e.type===i.b.ENDPOINT?u.w:u.v),[e.type]),H=Object(n.useMemo)((()=>[{key:"Export",icon:"exportAction",label:u.C,onClick:a=>{t({id:e.id,listId:e.list_id,namespaceType:e.namespace_type})()}},{key:"Delete",icon:"trash",disabled:z,label:u.j,onClick:t=>{a({id:e.id,listId:e.list_id,namespaceType:e.namespace_type})()}},{key:"ManageRules",icon:"gear",disabled:z,label:"Manage Rules",onClick:e=>{p()}}]),[e.id,e.list_id,e.namespace_type,a,t,z,p]),G=Object(n.useCallback)((()=>{h(!0)}),[h]),Q=Object(n.useCallback)((e=>{h(!1),v(!1),e&&N()}),[N,h,v]),{onClick:W}=Object(o.o)()({deepLinkId:l.uc.exceptions,path:`/details/${e.list_id}`});return{listId:k,listName:x,listDescription:T,createdAt:new Date(w).toDateString(),createdBy:O,listRulesCount:S.length.toString(),exceptionItemsCount:A.totalItemCount.toString(),listType:j,menuActionItems:H,showAddExceptionFlyout:y,toggleAccordion:L,openAccordionId:q,viewerStatus:m,exceptionToEdit:b,showEditExceptionFlyout:E,lastUpdated:M,exceptions:D,ruleReferences:_,pagination:A,exceptionViewerStatus:F,onEditExceptionItem:C,onDeleteException:R,onPaginationChange:P,setToggleAccordion:B,onAddExceptionClick:G,handleConfirmExceptionFlyout:Q,handleCancelExceptionItemFlyout:()=>{h(!1),v(!1)},goToExceptionDetail:W,emptyViewerTitle:$,emptyViewerBody:V,emptyViewerButtonText:U}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(4),i=a(195),r=a(77),s=a(510);const o=({list:e,deleteToastTitle:t,deleteToastBody:a,errorToastTitle:o,errorToastBody:l,onEditListExceptionItem:c,onFinishFetchingExceptions:u})=>{const{services:d}=Object(r.k)(),{http:p}=d,m=Object(r.o)(),[g,b]=Object(n.useState)([]),[f,y]=Object(n.useState)({}),[h,E]=Object(n.useState)({pageIndex:0,pageSize:0,totalItemCount:0}),[v,x]=Object(n.useState)(null),[k,S]=Object(n.useState)(""),j=Object(n.useCallback)(((e,t,a)=>{null==m||m.addError(e,{title:t||o,toastMessage:a||l}),S(i.i.ERROR)}),[l,o,m]),O=Object(n.useCallback)((async()=>{try{const t=await Object(s.c)([e]);y(t)}catch(e){j(e)}}),[j,e,y]),w=Object(n.useCallback)(((e,t,a)=>{E(e),x(Date.now()),setTimeout((()=>{if(a===i.i.EMPTY_SEARCH)return S(t?"":a);S(t?"":i.i.EMPTY)}),200)}),[]),T=Object(n.useCallback)((async(t,a)=>{try{S(i.i.LOADING);const{data:n,pagination:r}=await Object(s.b)({http:p,...Object(s.g)(null,e,t)});b(n),O(),w(r,n.length,a),"function"==typeof u&&u()}catch(e){j(e)}}),[p,e,O,w,u,j]),I=Object(n.useCallback)((async({id:e,name:n,namespaceType:r})=>{try{S(i.i.LOADING),await Object(s.a)({id:e,http:p,namespaceType:r}),null==m||m.addSuccess({title:t,text:"function"==typeof a?a(n):""}),T()}catch(e){j(e)}}),[p,m,t,a,T,j]),C=Object(n.useCallback)((async e=>{T(e)}),[T]);return{exceptions:g,lastUpdated:v,pagination:h,exceptionViewerStatus:k,ruleReferences:f,fetchItems:T,onDeleteException:I,onEditExceptionItem:e=>{"function"==typeof c&&c(e)},onPaginationChange:C}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(110),i=a(129);const r=Object(i.d)((async({file:e,http:t,signal:a,overwrite:i,overwriteExceptions:r,asNewList:s})=>{const o=new FormData;return o.append("file",e),await t.post(`${n.s}/_import`,{body:o,query:{overwrite:i,overwrite_exceptions:r,as_new_list:s},headers:{"Content-Type":void 0},method:"POST",signal:a})})),s=()=>Object(i.a)(r)},function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(4),i=a(93),r=a(195),s=a(168),o=a(593);const l=(e,t)=>{const[a,l]=Object(n.useState)(!1),[c,u]=Object(n.useState)(!1),[d,p]=Object(n.useState)(),[m,g]=Object(n.useState)(r.i.LOADING),b=Object(n.useCallback)((()=>{g("")}),[g]),f=e=>{p(e),u(!0)},{exceptionViewerStatus:y,exceptions:h,lastUpdated:E,pagination:v,ruleReferences:x,fetchItems:k,onDeleteException:S,onPaginationChange:j}=Object(o.b)({list:e,deleteToastTitle:s.r,deleteToastBody:e=>s.q(e),errorToastBody:s.m,errorToastTitle:s.n,onEditListExceptionItem:f,onFinishFetchingExceptions:b});Object(n.useEffect)((()=>{k(null,r.i.LOADING)}),[k,t]);const O=Object(n.useMemo)((()=>m===r.i.EMPTY?s.x:""),[m]),w=Object(n.useMemo)((()=>m===r.i.EMPTY?s.u(e.name):""),[e.name,m]),T=Object(n.useMemo)((()=>e.type===i.b.ENDPOINT?s.w:s.v),[e.type]),I=Object(n.useCallback)((async e=>{g(r.i.SEARCHING),k(e,r.i.EMPTY_SEARCH)}),[k,g]),C=Object(n.useCallback)((()=>{l(!0),k()}),[k,l]),M=Object(n.useCallback)((e=>{l(!1),u(!1),e&&k()}),[k,l,u]);return{exceptionViewerStatus:y,listName:e.name,exceptions:h,listType:e.type,lastUpdated:E,pagination:v,viewerStatus:m,emptyViewerTitle:O,emptyViewerBody:w,emptyViewerButtonText:T,ruleReferences:x,showAddExceptionFlyout:a,showEditExceptionFlyout:c,exceptionToEdit:d,onSearch:I,onAddExceptionClick:C,onDeleteException:S,onEditExceptionItem:f,onPaginationChange:j,handleCancelExceptionItemFlyout:()=>{l(!1),u(!1)},handleConfirmExceptionFlyout:M}}},function(e,t,a){"use strict";a.d(t,"b",(function(){return Cn})),a.d(t,"a",(function(){return Mn}));var n=a(34),i=a(32),r=a(4),s=a.n(r),o=a(33),l=a.n(o),c=a(107),u=a(128),d=a(89),p=a(82),m=a.n(p),g=a(7),b=a(871),f=a(316),y=a(255),h=a(205),E=a(35),v=a(634),x=a(299),k=a(397),S=a(77),j=a(188);const O=l.a.div.withConfig({displayName:"TabContentWrapper",componentId:"sc-kmihwc-0"})(["height:100%;position:relative;"]);var w=a(78),T=a(284),I=a(38),C=a(99),M=a(180),F=a(155),D=a(715),A=a(86),_=a(175),N=a(822),R=a(112),P=a(294),L=a.n(P),B=a(635),q=a(703),z=a(182),$=a(0);const V=s.a.memo((({data:e,field:t,fieldMapping:a,scripted:n})=>{const r=function(e){switch(e){case"boolean":return $.i18n.translate("xpack.securitySolution.fieldNameIcons.booleanAriaLabel",{defaultMessage:"Boolean field"});case"conflict":return $.i18n.translate("xpack.securitySolution.fieldNameIcons.conflictFieldAriaLabel",{defaultMessage:"Conflicting field"});case"date":return $.i18n.translate("xpack.securitySolution.fieldNameIcons.dateFieldAriaLabel",{defaultMessage:"Date field"});case"geo_point":return $.i18n.translate("xpack.securitySolution.fieldNameIcons.geoPointFieldAriaLabel",{defaultMessage:"Geo point field"});case"geo_shape":return $.i18n.translate("xpack.securitySolution.fieldNameIcons.geoShapeFieldAriaLabel",{defaultMessage:"Geo shape field"});case"ip":return $.i18n.translate("xpack.securitySolution.fieldNameIcons.ipAddressFieldAriaLabel",{defaultMessage:"IP address field"});case"murmur3":return $.i18n.translate("xpack.securitySolution.fieldNameIcons.murmur3FieldAriaLabel",{defaultMessage:"Murmur3 field"});case"number":return $.i18n.translate("xpack.securitySolution.fieldNameIcons.numberFieldAriaLabel",{defaultMessage:"Number field"});case"source":return $.i18n.translate("xpack.securitySolution.fieldNameIcons.sourceFieldAriaLabel",{defaultMessage:"Source field"});case"string":return $.i18n.translate("xpack.securitySolution.fieldNameIcons.stringFieldAriaLabel",{defaultMessage:"String field"});case"nested":return $.i18n.translate("xpack.securitySolution.fieldNameIcons.nestedFieldAriaLabel",{defaultMessage:"Nested field"});default:return $.i18n.translate("xpack.securitySolution.fieldNameIcons.unknownFieldAriaLabel",{defaultMessage:"Unknown field"})}}(e.type),o=a&&a.displayName?a.displayName:t,l=o!==t?`${t} (${o})`:t,c=null==a?void 0:a.isSubtypeMulti();return s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiFlexItem,{grow:!1,className:"eventFieldsTable__fieldIcon"},s.a.createElement(q.a,{"data-test-subj":"field-type-icon",type:e.type,label:r,scripted:n})),s.a.createElement(i.EuiFlexGroup,{wrap:!0,gutterSize:"none",responsive:!1,alignItems:"flexStart","data-test-subj":"field-name-cell"},s.a.createElement(i.EuiFlexItem,{className:"eventFieldsTable__fieldName eui-textBreakAll",grow:!1},s.a.createElement(i.EuiToolTip,{position:"top",content:Object(g.isEmpty)(e.description)?l:`${e.description} ${Object(z.c)(e.example)}`,delay:"long",anchorClassName:"eui-textBreakAll"},s.a.createElement(i.EuiText,{size:"xs","data-test-subj":"field-name"},t))),c&&s.a.createElement(i.EuiToolTip,{position:"top",delay:"long",content:j.m},s.a.createElement(i.EuiBadge,{title:"",className:"eventFieldsTable__multiFieldBadge",color:"default","data-test-subj":`eventFieldsTableRow-${t}-multifieldBadge`},j.l))))}));V.displayName="FieldNameCell";var U=a(356);l()(i.EuiPanel).withConfig({displayName:"HoverActionsContainer",componentId:"sc-bbzzvi-0"})(["align-items:center;display:flex;flex-direction:row;height:25px;justify-content:center;left:5px;position:absolute;top:-10px;width:30px;"]).displayName="HoverActionsContainer";const H=L()(((e,t)=>Object(g.get)(t,e)),((e,t)=>e[0].join()===t[0].join()));var G=a(81);const Q=l.a.div.withConfig({displayName:"TableWrapper",componentId:"sc-1mn70y-0"})(["display:flex;flex:1;overflow:hidden;> div{display:flex;flex-direction:column;flex:1;overflow:hidden;> .euiFlexGroup:first-of-type{flex:0;}}"]),W=l()(i.EuiInMemoryTable).withConfig({displayName:"StyledEuiInMemoryTable",componentId:"sc-1mn70y-1"})(["flex:1;overflow:auto;overflow-x:hidden;&::-webkit-scrollbar{height:",";width:",";}&::-webkit-scrollbar-thumb{background-clip:content-box;background-color:",";border:"," solid transparent;}&::-webkit-scrollbar-corner,&::-webkit-scrollbar-track{background-color:transparent;}.eventFieldsTable__fieldIcon{padding-top:","px;}.eventFieldsTable__fieldName{line-height:",";padding:",";}.eventFieldsTable__tableRow{font-size:",";font-family:",";.hoverActions-active{.timelines__hoverActionButton,.securitySolution__hoverActionButton{opacity:1;}}&:hover{.timelines__hoverActionButton,.securitySolution__hoverActionButton{opacity:1;}}.timelines__hoverActionButton,.securitySolution__hoverActionButton{opacity:0;}}.eventFieldsTable__actionCell,.eventFieldsTable__fieldNameCell{align-items:flex-start;padding:",";}.eventFieldsTable__fieldValue{display:inline-block;word-break:break-all;word-wrap:break-word;white-space:pre-wrap;line-height:",";color:",";vertical-align:top;}"],(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>Object(T.rgba)(e.eui.euiColorDarkShade,.5)),(({theme:e})=>e.eui.euiScrollBarCorner),(({theme:e})=>1.5*parseFloat(e.eui.euiSizeXS)),(({theme:e})=>e.eui.euiLineHeight),(({theme:e})=>e.eui.euiSizeXS),(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.euiCodeFontFamily),(({theme:e})=>e.eui.euiSizeXS),(({theme:e})=>e.eui.euiLineHeight),(({theme:e})=>e.eui.euiColorFullShade)),K=[25,50,100],Y=s.a.memo((({browserFields:e,data:t,eventId:a,isDraggable:o,timelineTabType:l,scopeId:c,isReadOnly:u})=>{const d=Object(r.useRef)(null),p=Object(w.useDispatch)(),m=Object(r.useMemo)((()=>Object(C.isTimelineScope)(c)?A.b.getTimelineByIdSelector():Object(C.isInTableScope)(c)?F.b.getTableByIdSelector():void 0),[c]),g=Object(C.isTimelineScope)(c)?R.b:M.a,b=Object(G.a)((t=>{var a;const{columns:n}=null!==(a=m&&m(t,c))&&void 0!==a?a:g;return Object(N.b)(n,e)})),f=Object(r.useMemo)((()=>Object(_.a)(e)),[e]),y=Object(r.useMemo)((()=>Object(n.sortBy)(["field"],t).map(((e,t)=>({...e,...f[e.field],valuesConcatenated:null!=e.values?e.values.join():"",ariaRowindex:Object(I.arrayIndexToAriaIndex)(t)})))),[t,f]),h=Object(r.useCallback)((e=>{var a;const i=(null!==(a=b.find((t=>t.id===e)))&&void 0!==a?a:{}).linkField;if(!i)return null;const r=(null!=t?t:[]).find((e=>e.field===i)),s=Object(n.getOr)(null,"originalValue",r);return Array.isArray(s)?s[0]:s}),[t,b]),E=Object(C.getScopedActions)(c),v=Object(r.useCallback)((e=>{E&&(b.some((t=>t.id===e.id))?p(E.removeColumn({columnId:e.id,id:c})):p(E.upsertColumn({column:e,id:c,index:1})))}),[b,p,c,E]),x=Object(r.useCallback)((({ariaRowindex:e,field:t})=>({...null!=e?{"data-rowindex":e}:{},className:"eventFieldsTable__tableRow","data-test-subj":`event-fields-table-row-${t}`})),[]),k=Object(r.useCallback)((e=>{E&&p(E.updateColumns({id:c,columns:e}))}),[p,c,E]),S=Object(r.useMemo)((()=>(({browserFields:e,columnHeaders:t,eventId:a,onUpdateColumns:n,contextId:r,scopeId:o,toggleColumn:l,getLinkValue:c,isDraggable:u,isReadOnly:d})=>[...d?[]:[{field:"values",name:s.a.createElement(i.EuiText,{size:"xs"},s.a.createElement("strong",null,j.a)),sortable:!1,truncateText:!1,width:"132px",render:(t,n)=>{const i=n.isObjectArray?j.n(n.field):j.w(n.field),u=H([n.category,"fields",n.field],e);return s.a.createElement(U.a,{"aria-label":i,contextId:r,data:n,eventId:a,fieldFromBrowserField:u,getLinkValue:c,toggleColumn:l,scopeId:o,values:t})}}],{field:"field",className:"eventFieldsTable__fieldNameCell",name:s.a.createElement(i.EuiText,{size:"xs"},s.a.createElement("strong",null,j.d)),sortable:!0,truncateText:!1,render:(t,a)=>{const n=H([a.category,"fields",t],e);return s.a.createElement(V,{data:a,field:t,fieldMapping:void 0,fieldFromBrowserField:n})}},{field:"values",className:"eventFieldsTable__fieldValueCell",name:s.a.createElement(i.EuiText,{size:"xs"},s.a.createElement("strong",null,j.u)),sortable:!0,truncateText:!1,render:(t,n)=>{const i=H([n.category,"fields",n.field],e);return s.a.createElement(B.a,{contextId:r,data:n,eventId:a,fieldFromBrowserField:i,getLinkValue:c,isDraggable:u,values:t})}}])({browserFields:e,columnHeaders:b,eventId:a,onUpdateColumns:k,contextId:`event-fields-browser-for-${c}-${l}`,scopeId:c,toggleColumn:v,getLinkValue:h,isDraggable:o,isReadOnly:u})),[e,b,a,k,c,l,v,h,o,u]),O=Object(r.useCallback)((()=>{var e,t;null===(e=d.current)||void 0===e||null===(t=e.querySelector('input[type="search"]'))||void 0===t||t.focus()}),[]),T=Object(r.useCallback)((()=>{var e;null===(e=document.querySelector(`.${D.a}`))||void 0===e||e.focus()}),[]),P=Object(r.useCallback)((e=>{Object(I.isTab)(e)?Object(z.f)({containerElement:d.current,keyboardEvent:e,onSkipFocusBeforeEventsTable:O,onSkipFocusAfterEventsTable:T}):Object(I.onKeyDownFocusHandler)({colindexAttribute:I.DATA_COLINDEX_ATTRIBUTE,containerElement:null==d?void 0:d.current,event:e,maxAriaColindex:3,maxAriaRowindex:t.length,onColumnFocused:n.noop,rowindexAttribute:I.DATA_ROWINDEX_ATTRIBUTE})}),[t,T,O]);Object(r.useEffect)((()=>{O()}),[O]);const{onTableChange:L,paginationTableProp:q}=(()=>{const[e,t]=Object(r.useState)({pageIndex:0});return{onTableChange:Object(r.useCallback)((({page:{index:e}})=>{t({pageIndex:e})}),[]),paginationTableProp:Object(r.useMemo)((()=>({...e,pageSizeOptions:K})),[e])}})();return s.a.createElement(Q,{onKeyDown:P,ref:d},s.a.createElement(W,{className:z.a,items:y,itemId:"field",columns:S,onTableChange:L,pagination:q,rowProps:x,search:z.g,sorting:!1,"data-test-subj":"event-fields-browser"}))}));Y.displayName="EventFieldsBrowser";var J=a(302);const X=l.a.div.withConfig({displayName:"EuiCodeEditorContainer",componentId:"sc-4gfrjz-0"})([".euiCodeEditorWrapper{position:absolute;}"]),Z=s.a.memo((({rawEventData:e})=>{const t=Object(r.useMemo)((()=>JSON.stringify(e,J.j,2)),[e]);return s.a.createElement(X,null,s.a.createElement(i.EuiCodeBlock,{language:"json",fontSize:"m",paddingSize:"m",isCopyable:!0,"data-test-subj":"jsonView"},t))}));Z.displayName="JsonView";var ee=a(212);const te=$.i18n.translate("xpack.securitySolution.eventDetails.ctiSummary.feedNamePreposition",{defaultMessage:"from"}),ae=$.i18n.translate("xpack.securitySolution.eventDetails.ctiSummary.indicatorEnrichmentTitle",{defaultMessage:"Threat Match Detected"}),ne=$.i18n.translate("xpack.securitySolution.eventDetails.ctiSummary.investigationEnrichmentTitle",{defaultMessage:"Enriched with Threat Intelligence"}),ie=$.i18n.translate("xpack.securitySolution.eventDetails.ctiSummary.indicatorEnrichmentTooltipContent",{defaultMessage:"This field value matched a threat intelligence indicator with a rule you created."}),re=$.i18n.translate("xpack.securitySolution.eventDetails.ctiSummary.informationAriaLabel",{defaultMessage:"Information"}),se=$.i18n.translate("xpack.securitySolution.eventDetails.ctiSummary.investigationEnrichmentTooltipContent",{defaultMessage:"This field value has additional information available from threat intelligence sources."}),oe=$.i18n.translate("xpack.securitySolution.alertDetails.noInvestigationEnrichmentsDescription",{defaultMessage:"We haven't found field value has additional information available from threat intelligence sources we searched in the past 30 days by default."}),le=$.i18n.translate("xpack.securitySolution.alertDetails.noEnrichmentsFoundDescription",{defaultMessage:"We did not find threat intelligence that matches any of the indicator match rules, or any enrichment for this alert."}),ce=$.i18n.translate("xpack.securitySolution.alertDetails.investigationTimeQueryTitle",{defaultMessage:"Enrichment with Threat Intelligence"}),ue=$.i18n.translate("xpack.securitySolution.alertDetails.enrichmentQueryStartDate",{defaultMessage:"Start date"}),de=$.i18n.translate("xpack.securitySolution.alertDetails.enrichmentQueryEndDate",{defaultMessage:"End date"}),pe=$.i18n.translate("xpack.securitySolution.alertDetails.refresh",{defaultMessage:"Refresh"}),me=$.i18n.translate("xpack.securitySolution.alertDetails.overview.enrichedDataTitle",{defaultMessage:"Enriched data"}),ge=e=>$.i18n.translate("xpack.securitySolution.alertDetails.overview.hostRiskClassification",{defaultMessage:"Current {riskEntity} risk classification",values:{riskEntity:Object(ee.c)(e,!0)}}),be=e=>$.i18n.translate("xpack.securitySolution.alertDetails.overview.originalHostRiskClassification",{defaultMessage:"Original {riskEntity} risk classification",values:{riskEntity:Object(ee.c)(e,!0)}}),fe=e=>$.i18n.translate("xpack.securitySolution.alertDetails.overview.hostRiskDataTitle",{defaultMessage:"{riskEntity} Risk Data",values:{riskEntity:Object(ee.c)(e)}});var ye=a(213),he=a(85),Ee=a(87),ve=a(561),xe=a(357);const ke=({risk:e,riskEntity:t,originalRisk:a})=>{var n,r,o,l,c,u,d,p;const m=t===he.v.host?null==e||null===(n=e.result)||void 0===n||null===(r=n[0])||void 0===r||null===(o=r.host)||void 0===o||null===(l=o.risk)||void 0===l?void 0:l.calculated_level:null==e||null===(c=e.result)||void 0===c||null===(u=c[0])||void 0===u||null===(d=u.user)||void 0===d||null===(p=d.risk)||void 0===p?void 0:p.calculated_level;return s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiPanel,{hasBorder:!0,paddingSize:"s",grow:!1},s.a.createElement(et,{title:s.a.createElement(xe.a,{title:fe(t),riskScoreEntity:t}),toolTipContent:s.a.createElement(E.FormattedMessage,{id:"xpack.securitySolution.alertDetails.overview.riskDataTooltipContent",defaultMessage:"Risk classification is displayed only when available for a {riskEntity}. Ensure {riskScoreDocumentationLink} is enabled within your environment.",values:{riskEntity:t,riskScoreDocumentationLink:s.a.createElement(ve.a,{riskScoreEntity:t,title:ee.b(t)})}})}),e.loading&&s.a.createElement(i.EuiLoadingSpinner,{"data-test-subj":"loading"}),!e.loading&&s.a.createElement(s.a.Fragment,null,s.a.createElement(Ze,{field:ge(t),value:m?s.a.createElement(ye.b,{severity:m,hideBackgroundColor:!0}):Object(Ee.e)()}),a&&m!==a&&s.a.createElement(s.a.Fragment,null,s.a.createElement(Ze,{field:be(t),value:s.a.createElement(ye.b,{severity:a,hideBackgroundColor:!0})})))))},Se=s.a.memo(ke),je={"@timestamp":{type:"date",array:!1,required:!0},"agent.build.original":{type:"keyword",array:!1,required:!1},"agent.ephemeral_id":{type:"keyword",array:!1,required:!1},"agent.id":{type:"keyword",array:!1,required:!1},"agent.name":{type:"keyword",array:!1,required:!1},"agent.type":{type:"keyword",array:!1,required:!1},"agent.version":{type:"keyword",array:!1,required:!1},"client.address":{type:"keyword",array:!1,required:!1},"client.as.number":{type:"long",array:!1,required:!1},"client.as.organization.name":{type:"keyword",array:!1,required:!1},"client.bytes":{type:"long",array:!1,required:!1},"client.domain":{type:"keyword",array:!1,required:!1},"client.geo.city_name":{type:"keyword",array:!1,required:!1},"client.geo.continent_code":{type:"keyword",array:!1,required:!1},"client.geo.continent_name":{type:"keyword",array:!1,required:!1},"client.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"client.geo.country_name":{type:"keyword",array:!1,required:!1},"client.geo.location":{type:"geo_point",array:!1,required:!1},"client.geo.name":{type:"keyword",array:!1,required:!1},"client.geo.postal_code":{type:"keyword",array:!1,required:!1},"client.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"client.geo.region_name":{type:"keyword",array:!1,required:!1},"client.geo.timezone":{type:"keyword",array:!1,required:!1},"client.ip":{type:"ip",array:!1,required:!1},"client.mac":{type:"keyword",array:!1,required:!1},"client.nat.ip":{type:"ip",array:!1,required:!1},"client.nat.port":{type:"long",array:!1,required:!1},"client.packets":{type:"long",array:!1,required:!1},"client.port":{type:"long",array:!1,required:!1},"client.registered_domain":{type:"keyword",array:!1,required:!1},"client.subdomain":{type:"keyword",array:!1,required:!1},"client.top_level_domain":{type:"keyword",array:!1,required:!1},"client.user.domain":{type:"keyword",array:!1,required:!1},"client.user.email":{type:"keyword",array:!1,required:!1},"client.user.full_name":{type:"keyword",array:!1,required:!1},"client.user.group.domain":{type:"keyword",array:!1,required:!1},"client.user.group.id":{type:"keyword",array:!1,required:!1},"client.user.group.name":{type:"keyword",array:!1,required:!1},"client.user.hash":{type:"keyword",array:!1,required:!1},"client.user.id":{type:"keyword",array:!1,required:!1},"client.user.name":{type:"keyword",array:!1,required:!1},"client.user.roles":{type:"keyword",array:!0,required:!1},"cloud.account.id":{type:"keyword",array:!1,required:!1},"cloud.account.name":{type:"keyword",array:!1,required:!1},"cloud.availability_zone":{type:"keyword",array:!1,required:!1},"cloud.instance.id":{type:"keyword",array:!1,required:!1},"cloud.instance.name":{type:"keyword",array:!1,required:!1},"cloud.machine.type":{type:"keyword",array:!1,required:!1},"cloud.origin.account.id":{type:"keyword",array:!1,required:!1},"cloud.origin.account.name":{type:"keyword",array:!1,required:!1},"cloud.origin.availability_zone":{type:"keyword",array:!1,required:!1},"cloud.origin.instance.id":{type:"keyword",array:!1,required:!1},"cloud.origin.instance.name":{type:"keyword",array:!1,required:!1},"cloud.origin.machine.type":{type:"keyword",array:!1,required:!1},"cloud.origin.project.id":{type:"keyword",array:!1,required:!1},"cloud.origin.project.name":{type:"keyword",array:!1,required:!1},"cloud.origin.provider":{type:"keyword",array:!1,required:!1},"cloud.origin.region":{type:"keyword",array:!1,required:!1},"cloud.origin.service.name":{type:"keyword",array:!1,required:!1},"cloud.project.id":{type:"keyword",array:!1,required:!1},"cloud.project.name":{type:"keyword",array:!1,required:!1},"cloud.provider":{type:"keyword",array:!1,required:!1},"cloud.region":{type:"keyword",array:!1,required:!1},"cloud.service.name":{type:"keyword",array:!1,required:!1},"cloud.target.account.id":{type:"keyword",array:!1,required:!1},"cloud.target.account.name":{type:"keyword",array:!1,required:!1},"cloud.target.availability_zone":{type:"keyword",array:!1,required:!1},"cloud.target.instance.id":{type:"keyword",array:!1,required:!1},"cloud.target.instance.name":{type:"keyword",array:!1,required:!1},"cloud.target.machine.type":{type:"keyword",array:!1,required:!1},"cloud.target.project.id":{type:"keyword",array:!1,required:!1},"cloud.target.project.name":{type:"keyword",array:!1,required:!1},"cloud.target.provider":{type:"keyword",array:!1,required:!1},"cloud.target.region":{type:"keyword",array:!1,required:!1},"cloud.target.service.name":{type:"keyword",array:!1,required:!1},"container.id":{type:"keyword",array:!1,required:!1},"container.image.name":{type:"keyword",array:!1,required:!1},"container.image.tag":{type:"keyword",array:!0,required:!1},"container.labels":{type:"object",array:!1,required:!1},"container.name":{type:"keyword",array:!1,required:!1},"container.runtime":{type:"keyword",array:!1,required:!1},"destination.address":{type:"keyword",array:!1,required:!1},"destination.as.number":{type:"long",array:!1,required:!1},"destination.as.organization.name":{type:"keyword",array:!1,required:!1},"destination.bytes":{type:"long",array:!1,required:!1},"destination.domain":{type:"keyword",array:!1,required:!1},"destination.geo.city_name":{type:"keyword",array:!1,required:!1},"destination.geo.continent_code":{type:"keyword",array:!1,required:!1},"destination.geo.continent_name":{type:"keyword",array:!1,required:!1},"destination.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"destination.geo.country_name":{type:"keyword",array:!1,required:!1},"destination.geo.location":{type:"geo_point",array:!1,required:!1},"destination.geo.name":{type:"keyword",array:!1,required:!1},"destination.geo.postal_code":{type:"keyword",array:!1,required:!1},"destination.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"destination.geo.region_name":{type:"keyword",array:!1,required:!1},"destination.geo.timezone":{type:"keyword",array:!1,required:!1},"destination.ip":{type:"ip",array:!1,required:!1},"destination.mac":{type:"keyword",array:!1,required:!1},"destination.nat.ip":{type:"ip",array:!1,required:!1},"destination.nat.port":{type:"long",array:!1,required:!1},"destination.packets":{type:"long",array:!1,required:!1},"destination.port":{type:"long",array:!1,required:!1},"destination.registered_domain":{type:"keyword",array:!1,required:!1},"destination.subdomain":{type:"keyword",array:!1,required:!1},"destination.top_level_domain":{type:"keyword",array:!1,required:!1},"destination.user.domain":{type:"keyword",array:!1,required:!1},"destination.user.email":{type:"keyword",array:!1,required:!1},"destination.user.full_name":{type:"keyword",array:!1,required:!1},"destination.user.group.domain":{type:"keyword",array:!1,required:!1},"destination.user.group.id":{type:"keyword",array:!1,required:!1},"destination.user.group.name":{type:"keyword",array:!1,required:!1},"destination.user.hash":{type:"keyword",array:!1,required:!1},"destination.user.id":{type:"keyword",array:!1,required:!1},"destination.user.name":{type:"keyword",array:!1,required:!1},"destination.user.roles":{type:"keyword",array:!0,required:!1},"dll.code_signature.digest_algorithm":{type:"keyword",array:!1,required:!1},"dll.code_signature.exists":{type:"boolean",array:!1,required:!1},"dll.code_signature.signing_id":{type:"keyword",array:!1,required:!1},"dll.code_signature.status":{type:"keyword",array:!1,required:!1},"dll.code_signature.subject_name":{type:"keyword",array:!1,required:!1},"dll.code_signature.team_id":{type:"keyword",array:!1,required:!1},"dll.code_signature.timestamp":{type:"date",array:!1,required:!1},"dll.code_signature.trusted":{type:"boolean",array:!1,required:!1},"dll.code_signature.valid":{type:"boolean",array:!1,required:!1},"dll.hash.md5":{type:"keyword",array:!1,required:!1},"dll.hash.sha1":{type:"keyword",array:!1,required:!1},"dll.hash.sha256":{type:"keyword",array:!1,required:!1},"dll.hash.sha512":{type:"keyword",array:!1,required:!1},"dll.hash.ssdeep":{type:"keyword",array:!1,required:!1},"dll.name":{type:"keyword",array:!1,required:!1},"dll.path":{type:"keyword",array:!1,required:!1},"dll.pe.architecture":{type:"keyword",array:!1,required:!1},"dll.pe.company":{type:"keyword",array:!1,required:!1},"dll.pe.description":{type:"keyword",array:!1,required:!1},"dll.pe.file_version":{type:"keyword",array:!1,required:!1},"dll.pe.imphash":{type:"keyword",array:!1,required:!1},"dll.pe.original_file_name":{type:"keyword",array:!1,required:!1},"dll.pe.product":{type:"keyword",array:!1,required:!1},"dns.answers":{type:"object",array:!0,required:!1},"dns.answers.class":{type:"keyword",array:!1,required:!1},"dns.answers.data":{type:"keyword",array:!1,required:!1},"dns.answers.name":{type:"keyword",array:!1,required:!1},"dns.answers.ttl":{type:"long",array:!1,required:!1},"dns.answers.type":{type:"keyword",array:!1,required:!1},"dns.header_flags":{type:"keyword",array:!0,required:!1},"dns.id":{type:"keyword",array:!1,required:!1},"dns.op_code":{type:"keyword",array:!1,required:!1},"dns.question.class":{type:"keyword",array:!1,required:!1},"dns.question.name":{type:"keyword",array:!1,required:!1},"dns.question.registered_domain":{type:"keyword",array:!1,required:!1},"dns.question.subdomain":{type:"keyword",array:!1,required:!1},"dns.question.top_level_domain":{type:"keyword",array:!1,required:!1},"dns.question.type":{type:"keyword",array:!1,required:!1},"dns.resolved_ip":{type:"ip",array:!0,required:!1},"dns.response_code":{type:"keyword",array:!1,required:!1},"dns.type":{type:"keyword",array:!1,required:!1},"ecs.version":{type:"keyword",array:!1,required:!0},"error.code":{type:"keyword",array:!1,required:!1},"error.id":{type:"keyword",array:!1,required:!1},"error.message":{type:"match_only_text",array:!1,required:!1},"error.stack_trace":{type:"wildcard",array:!1,required:!1},"error.type":{type:"keyword",array:!1,required:!1},"event.action":{type:"keyword",array:!1,required:!1},"event.agent_id_status":{type:"keyword",array:!1,required:!1},"event.category":{type:"keyword",array:!0,required:!1},"event.code":{type:"keyword",array:!1,required:!1},"event.created":{type:"date",array:!1,required:!1},"event.dataset":{type:"keyword",array:!1,required:!1},"event.duration":{type:"long",array:!1,required:!1},"event.end":{type:"date",array:!1,required:!1},"event.hash":{type:"keyword",array:!1,required:!1},"event.id":{type:"keyword",array:!1,required:!1},"event.ingested":{type:"date",array:!1,required:!1},"event.kind":{type:"keyword",array:!1,required:!1},"event.module":{type:"keyword",array:!1,required:!1},"event.original":{type:"keyword",array:!1,required:!1},"event.outcome":{type:"keyword",array:!1,required:!1},"event.provider":{type:"keyword",array:!1,required:!1},"event.reason":{type:"keyword",array:!1,required:!1},"event.reference":{type:"keyword",array:!1,required:!1},"event.risk_score":{type:"float",array:!1,required:!1},"event.risk_score_norm":{type:"float",array:!1,required:!1},"event.sequence":{type:"long",array:!1,required:!1},"event.severity":{type:"long",array:!1,required:!1},"event.start":{type:"date",array:!1,required:!1},"event.timezone":{type:"keyword",array:!1,required:!1},"event.type":{type:"keyword",array:!0,required:!1},"event.url":{type:"keyword",array:!1,required:!1},"faas.coldstart":{type:"boolean",array:!1,required:!1},"faas.execution":{type:"keyword",array:!1,required:!1},"faas.trigger":{type:"nested",array:!1,required:!1},"faas.trigger.request_id":{type:"keyword",array:!1,required:!1},"faas.trigger.type":{type:"keyword",array:!1,required:!1},"file.accessed":{type:"date",array:!1,required:!1},"file.attributes":{type:"keyword",array:!0,required:!1},"file.code_signature.digest_algorithm":{type:"keyword",array:!1,required:!1},"file.code_signature.exists":{type:"boolean",array:!1,required:!1},"file.code_signature.signing_id":{type:"keyword",array:!1,required:!1},"file.code_signature.status":{type:"keyword",array:!1,required:!1},"file.code_signature.subject_name":{type:"keyword",array:!1,required:!1},"file.code_signature.team_id":{type:"keyword",array:!1,required:!1},"file.code_signature.timestamp":{type:"date",array:!1,required:!1},"file.code_signature.trusted":{type:"boolean",array:!1,required:!1},"file.code_signature.valid":{type:"boolean",array:!1,required:!1},"file.created":{type:"date",array:!1,required:!1},"file.ctime":{type:"date",array:!1,required:!1},"file.device":{type:"keyword",array:!1,required:!1},"file.directory":{type:"keyword",array:!1,required:!1},"file.drive_letter":{type:"keyword",array:!1,required:!1},"file.elf.architecture":{type:"keyword",array:!1,required:!1},"file.elf.byte_order":{type:"keyword",array:!1,required:!1},"file.elf.cpu_type":{type:"keyword",array:!1,required:!1},"file.elf.creation_date":{type:"date",array:!1,required:!1},"file.elf.exports":{type:"flattened",array:!0,required:!1},"file.elf.header.abi_version":{type:"keyword",array:!1,required:!1},"file.elf.header.class":{type:"keyword",array:!1,required:!1},"file.elf.header.data":{type:"keyword",array:!1,required:!1},"file.elf.header.entrypoint":{type:"long",array:!1,required:!1},"file.elf.header.object_version":{type:"keyword",array:!1,required:!1},"file.elf.header.os_abi":{type:"keyword",array:!1,required:!1},"file.elf.header.type":{type:"keyword",array:!1,required:!1},"file.elf.header.version":{type:"keyword",array:!1,required:!1},"file.elf.imports":{type:"flattened",array:!0,required:!1},"file.elf.sections":{type:"nested",array:!0,required:!1},"file.elf.sections.chi2":{type:"long",array:!1,required:!1},"file.elf.sections.entropy":{type:"long",array:!1,required:!1},"file.elf.sections.flags":{type:"keyword",array:!1,required:!1},"file.elf.sections.name":{type:"keyword",array:!1,required:!1},"file.elf.sections.physical_offset":{type:"keyword",array:!1,required:!1},"file.elf.sections.physical_size":{type:"long",array:!1,required:!1},"file.elf.sections.type":{type:"keyword",array:!1,required:!1},"file.elf.sections.virtual_address":{type:"long",array:!1,required:!1},"file.elf.sections.virtual_size":{type:"long",array:!1,required:!1},"file.elf.segments":{type:"nested",array:!0,required:!1},"file.elf.segments.sections":{type:"keyword",array:!1,required:!1},"file.elf.segments.type":{type:"keyword",array:!1,required:!1},"file.elf.shared_libraries":{type:"keyword",array:!0,required:!1},"file.elf.telfhash":{type:"keyword",array:!1,required:!1},"file.extension":{type:"keyword",array:!1,required:!1},"file.fork_name":{type:"keyword",array:!1,required:!1},"file.gid":{type:"keyword",array:!1,required:!1},"file.group":{type:"keyword",array:!1,required:!1},"file.hash.md5":{type:"keyword",array:!1,required:!1},"file.hash.sha1":{type:"keyword",array:!1,required:!1},"file.hash.sha256":{type:"keyword",array:!1,required:!1},"file.hash.sha512":{type:"keyword",array:!1,required:!1},"file.hash.ssdeep":{type:"keyword",array:!1,required:!1},"file.inode":{type:"keyword",array:!1,required:!1},"file.mime_type":{type:"keyword",array:!1,required:!1},"file.mode":{type:"keyword",array:!1,required:!1},"file.mtime":{type:"date",array:!1,required:!1},"file.name":{type:"keyword",array:!1,required:!1},"file.owner":{type:"keyword",array:!1,required:!1},"file.path":{type:"keyword",array:!1,required:!1},"file.pe.architecture":{type:"keyword",array:!1,required:!1},"file.pe.company":{type:"keyword",array:!1,required:!1},"file.pe.description":{type:"keyword",array:!1,required:!1},"file.pe.file_version":{type:"keyword",array:!1,required:!1},"file.pe.imphash":{type:"keyword",array:!1,required:!1},"file.pe.original_file_name":{type:"keyword",array:!1,required:!1},"file.pe.product":{type:"keyword",array:!1,required:!1},"file.size":{type:"long",array:!1,required:!1},"file.target_path":{type:"keyword",array:!1,required:!1},"file.type":{type:"keyword",array:!1,required:!1},"file.uid":{type:"keyword",array:!1,required:!1},"file.x509.alternative_names":{type:"keyword",array:!0,required:!1},"file.x509.issuer.common_name":{type:"keyword",array:!0,required:!1},"file.x509.issuer.country":{type:"keyword",array:!0,required:!1},"file.x509.issuer.distinguished_name":{type:"keyword",array:!1,required:!1},"file.x509.issuer.locality":{type:"keyword",array:!0,required:!1},"file.x509.issuer.organization":{type:"keyword",array:!0,required:!1},"file.x509.issuer.organizational_unit":{type:"keyword",array:!0,required:!1},"file.x509.issuer.state_or_province":{type:"keyword",array:!0,required:!1},"file.x509.not_after":{type:"date",array:!1,required:!1},"file.x509.not_before":{type:"date",array:!1,required:!1},"file.x509.public_key_algorithm":{type:"keyword",array:!1,required:!1},"file.x509.public_key_curve":{type:"keyword",array:!1,required:!1},"file.x509.public_key_exponent":{type:"long",array:!1,required:!1},"file.x509.public_key_size":{type:"long",array:!1,required:!1},"file.x509.serial_number":{type:"keyword",array:!1,required:!1},"file.x509.signature_algorithm":{type:"keyword",array:!1,required:!1},"file.x509.subject.common_name":{type:"keyword",array:!0,required:!1},"file.x509.subject.country":{type:"keyword",array:!0,required:!1},"file.x509.subject.distinguished_name":{type:"keyword",array:!1,required:!1},"file.x509.subject.locality":{type:"keyword",array:!0,required:!1},"file.x509.subject.organization":{type:"keyword",array:!0,required:!1},"file.x509.subject.organizational_unit":{type:"keyword",array:!0,required:!1},"file.x509.subject.state_or_province":{type:"keyword",array:!0,required:!1},"file.x509.version_number":{type:"keyword",array:!1,required:!1},"group.domain":{type:"keyword",array:!1,required:!1},"group.id":{type:"keyword",array:!1,required:!1},"group.name":{type:"keyword",array:!1,required:!1},"host.architecture":{type:"keyword",array:!1,required:!1},"host.boot.id":{type:"keyword",array:!1,required:!1},"host.cpu.usage":{type:"scaled_float",array:!1,required:!1,scaling_factor:1e3},"host.disk.read.bytes":{type:"long",array:!1,required:!1},"host.disk.write.bytes":{type:"long",array:!1,required:!1},"host.domain":{type:"keyword",array:!1,required:!1},"host.geo.city_name":{type:"keyword",array:!1,required:!1},"host.geo.continent_code":{type:"keyword",array:!1,required:!1},"host.geo.continent_name":{type:"keyword",array:!1,required:!1},"host.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"host.geo.country_name":{type:"keyword",array:!1,required:!1},"host.geo.location":{type:"geo_point",array:!1,required:!1},"host.geo.name":{type:"keyword",array:!1,required:!1},"host.geo.postal_code":{type:"keyword",array:!1,required:!1},"host.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"host.geo.region_name":{type:"keyword",array:!1,required:!1},"host.geo.timezone":{type:"keyword",array:!1,required:!1},"host.hostname":{type:"keyword",array:!1,required:!1},"host.id":{type:"keyword",array:!1,required:!1},"host.ip":{type:"ip",array:!0,required:!1},"host.mac":{type:"keyword",array:!0,required:!1},"host.name":{type:"keyword",array:!1,required:!1},"host.network.egress.bytes":{type:"long",array:!1,required:!1},"host.network.egress.packets":{type:"long",array:!1,required:!1},"host.network.ingress.bytes":{type:"long",array:!1,required:!1},"host.network.ingress.packets":{type:"long",array:!1,required:!1},"host.os.family":{type:"keyword",array:!1,required:!1},"host.os.full":{type:"keyword",array:!1,required:!1},"host.os.kernel":{type:"keyword",array:!1,required:!1},"host.os.name":{type:"keyword",array:!1,required:!1},"host.os.platform":{type:"keyword",array:!1,required:!1},"host.os.type":{type:"keyword",array:!1,required:!1},"host.os.version":{type:"keyword",array:!1,required:!1},"host.pid_ns_ino":{type:"keyword",array:!1,required:!1},"host.risk.calculated_level":{type:"keyword",array:!1,required:!1},"host.risk.calculated_score":{type:"float",array:!1,required:!1},"host.risk.calculated_score_norm":{type:"float",array:!1,required:!1},"host.risk.static_level":{type:"keyword",array:!1,required:!1},"host.risk.static_score":{type:"float",array:!1,required:!1},"host.risk.static_score_norm":{type:"float",array:!1,required:!1},"host.type":{type:"keyword",array:!1,required:!1},"host.uptime":{type:"long",array:!1,required:!1},"http.request.body.bytes":{type:"long",array:!1,required:!1},"http.request.body.content":{type:"wildcard",array:!1,required:!1},"http.request.bytes":{type:"long",array:!1,required:!1},"http.request.id":{type:"keyword",array:!1,required:!1},"http.request.method":{type:"keyword",array:!1,required:!1},"http.request.mime_type":{type:"keyword",array:!1,required:!1},"http.request.referrer":{type:"keyword",array:!1,required:!1},"http.response.body.bytes":{type:"long",array:!1,required:!1},"http.response.body.content":{type:"wildcard",array:!1,required:!1},"http.response.bytes":{type:"long",array:!1,required:!1},"http.response.mime_type":{type:"keyword",array:!1,required:!1},"http.response.status_code":{type:"long",array:!1,required:!1},"http.version":{type:"keyword",array:!1,required:!1},labels:{type:"object",array:!1,required:!1},"log.file.path":{type:"keyword",array:!1,required:!1},"log.level":{type:"keyword",array:!1,required:!1},"log.logger":{type:"keyword",array:!1,required:!1},"log.origin.file.line":{type:"long",array:!1,required:!1},"log.origin.file.name":{type:"keyword",array:!1,required:!1},"log.origin.function":{type:"keyword",array:!1,required:!1},"log.syslog":{type:"object",array:!1,required:!1},"log.syslog.facility.code":{type:"long",array:!1,required:!1},"log.syslog.facility.name":{type:"keyword",array:!1,required:!1},"log.syslog.priority":{type:"long",array:!1,required:!1},"log.syslog.severity.code":{type:"long",array:!1,required:!1},"log.syslog.severity.name":{type:"keyword",array:!1,required:!1},message:{type:"match_only_text",array:!1,required:!1},"network.application":{type:"keyword",array:!1,required:!1},"network.bytes":{type:"long",array:!1,required:!1},"network.community_id":{type:"keyword",array:!1,required:!1},"network.direction":{type:"keyword",array:!1,required:!1},"network.forwarded_ip":{type:"ip",array:!1,required:!1},"network.iana_number":{type:"keyword",array:!1,required:!1},"network.inner":{type:"object",array:!1,required:!1},"network.inner.vlan.id":{type:"keyword",array:!1,required:!1},"network.inner.vlan.name":{type:"keyword",array:!1,required:!1},"network.name":{type:"keyword",array:!1,required:!1},"network.packets":{type:"long",array:!1,required:!1},"network.protocol":{type:"keyword",array:!1,required:!1},"network.transport":{type:"keyword",array:!1,required:!1},"network.type":{type:"keyword",array:!1,required:!1},"network.vlan.id":{type:"keyword",array:!1,required:!1},"network.vlan.name":{type:"keyword",array:!1,required:!1},"observer.egress":{type:"object",array:!1,required:!1},"observer.egress.interface.alias":{type:"keyword",array:!1,required:!1},"observer.egress.interface.id":{type:"keyword",array:!1,required:!1},"observer.egress.interface.name":{type:"keyword",array:!1,required:!1},"observer.egress.vlan.id":{type:"keyword",array:!1,required:!1},"observer.egress.vlan.name":{type:"keyword",array:!1,required:!1},"observer.egress.zone":{type:"keyword",array:!1,required:!1},"observer.geo.city_name":{type:"keyword",array:!1,required:!1},"observer.geo.continent_code":{type:"keyword",array:!1,required:!1},"observer.geo.continent_name":{type:"keyword",array:!1,required:!1},"observer.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"observer.geo.country_name":{type:"keyword",array:!1,required:!1},"observer.geo.location":{type:"geo_point",array:!1,required:!1},"observer.geo.name":{type:"keyword",array:!1,required:!1},"observer.geo.postal_code":{type:"keyword",array:!1,required:!1},"observer.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"observer.geo.region_name":{type:"keyword",array:!1,required:!1},"observer.geo.timezone":{type:"keyword",array:!1,required:!1},"observer.hostname":{type:"keyword",array:!1,required:!1},"observer.ingress":{type:"object",array:!1,required:!1},"observer.ingress.interface.alias":{type:"keyword",array:!1,required:!1},"observer.ingress.interface.id":{type:"keyword",array:!1,required:!1},"observer.ingress.interface.name":{type:"keyword",array:!1,required:!1},"observer.ingress.vlan.id":{type:"keyword",array:!1,required:!1},"observer.ingress.vlan.name":{type:"keyword",array:!1,required:!1},"observer.ingress.zone":{type:"keyword",array:!1,required:!1},"observer.ip":{type:"ip",array:!0,required:!1},"observer.mac":{type:"keyword",array:!0,required:!1},"observer.name":{type:"keyword",array:!1,required:!1},"observer.os.family":{type:"keyword",array:!1,required:!1},"observer.os.full":{type:"keyword",array:!1,required:!1},"observer.os.kernel":{type:"keyword",array:!1,required:!1},"observer.os.name":{type:"keyword",array:!1,required:!1},"observer.os.platform":{type:"keyword",array:!1,required:!1},"observer.os.type":{type:"keyword",array:!1,required:!1},"observer.os.version":{type:"keyword",array:!1,required:!1},"observer.product":{type:"keyword",array:!1,required:!1},"observer.serial_number":{type:"keyword",array:!1,required:!1},"observer.type":{type:"keyword",array:!1,required:!1},"observer.vendor":{type:"keyword",array:!1,required:!1},"observer.version":{type:"keyword",array:!1,required:!1},"orchestrator.api_version":{type:"keyword",array:!1,required:!1},"orchestrator.cluster.id":{type:"keyword",array:!1,required:!1},"orchestrator.cluster.name":{type:"keyword",array:!1,required:!1},"orchestrator.cluster.url":{type:"keyword",array:!1,required:!1},"orchestrator.cluster.version":{type:"keyword",array:!1,required:!1},"orchestrator.namespace":{type:"keyword",array:!1,required:!1},"orchestrator.organization":{type:"keyword",array:!1,required:!1},"orchestrator.resource.id":{type:"keyword",array:!1,required:!1},"orchestrator.resource.ip":{type:"ip",array:!0,required:!1},"orchestrator.resource.name":{type:"keyword",array:!1,required:!1},"orchestrator.resource.parent.type":{type:"keyword",array:!1,required:!1},"orchestrator.resource.type":{type:"keyword",array:!1,required:!1},"orchestrator.type":{type:"keyword",array:!1,required:!1},"organization.id":{type:"keyword",array:!1,required:!1},"organization.name":{type:"keyword",array:!1,required:!1},"package.architecture":{type:"keyword",array:!1,required:!1},"package.build_version":{type:"keyword",array:!1,required:!1},"package.checksum":{type:"keyword",array:!1,required:!1},"package.description":{type:"keyword",array:!1,required:!1},"package.install_scope":{type:"keyword",array:!1,required:!1},"package.installed":{type:"date",array:!1,required:!1},"package.license":{type:"keyword",array:!1,required:!1},"package.name":{type:"keyword",array:!1,required:!1},"package.path":{type:"keyword",array:!1,required:!1},"package.reference":{type:"keyword",array:!1,required:!1},"package.size":{type:"long",array:!1,required:!1},"package.type":{type:"keyword",array:!1,required:!1},"package.version":{type:"keyword",array:!1,required:!1},"process.args":{type:"keyword",array:!0,required:!1},"process.args_count":{type:"long",array:!1,required:!1},"process.code_signature.digest_algorithm":{type:"keyword",array:!1,required:!1},"process.code_signature.exists":{type:"boolean",array:!1,required:!1},"process.code_signature.signing_id":{type:"keyword",array:!1,required:!1},"process.code_signature.status":{type:"keyword",array:!1,required:!1},"process.code_signature.subject_name":{type:"keyword",array:!1,required:!1},"process.code_signature.team_id":{type:"keyword",array:!1,required:!1},"process.code_signature.timestamp":{type:"date",array:!1,required:!1},"process.code_signature.trusted":{type:"boolean",array:!1,required:!1},"process.code_signature.valid":{type:"boolean",array:!1,required:!1},"process.command_line":{type:"wildcard",array:!1,required:!1},"process.elf.architecture":{type:"keyword",array:!1,required:!1},"process.elf.byte_order":{type:"keyword",array:!1,required:!1},"process.elf.cpu_type":{type:"keyword",array:!1,required:!1},"process.elf.creation_date":{type:"date",array:!1,required:!1},"process.elf.exports":{type:"flattened",array:!0,required:!1},"process.elf.header.abi_version":{type:"keyword",array:!1,required:!1},"process.elf.header.class":{type:"keyword",array:!1,required:!1},"process.elf.header.data":{type:"keyword",array:!1,required:!1},"process.elf.header.entrypoint":{type:"long",array:!1,required:!1},"process.elf.header.object_version":{type:"keyword",array:!1,required:!1},"process.elf.header.os_abi":{type:"keyword",array:!1,required:!1},"process.elf.header.type":{type:"keyword",array:!1,required:!1},"process.elf.header.version":{type:"keyword",array:!1,required:!1},"process.elf.imports":{type:"flattened",array:!0,required:!1},"process.elf.sections":{type:"nested",array:!0,required:!1},"process.elf.sections.chi2":{type:"long",array:!1,required:!1},"process.elf.sections.entropy":{type:"long",array:!1,required:!1},"process.elf.sections.flags":{type:"keyword",array:!1,required:!1},"process.elf.sections.name":{type:"keyword",array:!1,required:!1},"process.elf.sections.physical_offset":{type:"keyword",array:!1,required:!1},"process.elf.sections.physical_size":{type:"long",array:!1,required:!1},"process.elf.sections.type":{type:"keyword",array:!1,required:!1},"process.elf.sections.virtual_address":{type:"long",array:!1,required:!1},"process.elf.sections.virtual_size":{type:"long",array:!1,required:!1},"process.elf.segments":{type:"nested",array:!0,required:!1},"process.elf.segments.sections":{type:"keyword",array:!1,required:!1},"process.elf.segments.type":{type:"keyword",array:!1,required:!1},"process.elf.shared_libraries":{type:"keyword",array:!0,required:!1},"process.elf.telfhash":{type:"keyword",array:!1,required:!1},"process.end":{type:"date",array:!1,required:!1},"process.entity_id":{type:"keyword",array:!1,required:!1},"process.entry_leader.entity_id":{type:"keyword",array:!1,required:!1},"process.executable":{type:"keyword",array:!1,required:!1},"process.exit_code":{type:"long",array:!1,required:!1},"process.hash.md5":{type:"keyword",array:!1,required:!1},"process.hash.sha1":{type:"keyword",array:!1,required:!1},"process.hash.sha256":{type:"keyword",array:!1,required:!1},"process.hash.sha512":{type:"keyword",array:!1,required:!1},"process.hash.ssdeep":{type:"keyword",array:!1,required:!1},"process.name":{type:"keyword",array:!1,required:!1},"process.parent.args":{type:"keyword",array:!0,required:!1},"process.parent.args_count":{type:"long",array:!1,required:!1},"process.parent.code_signature.digest_algorithm":{type:"keyword",array:!1,required:!1},"process.parent.code_signature.exists":{type:"boolean",array:!1,required:!1},"process.parent.code_signature.signing_id":{type:"keyword",array:!1,required:!1},"process.parent.code_signature.status":{type:"keyword",array:!1,required:!1},"process.parent.code_signature.subject_name":{type:"keyword",array:!1,required:!1},"process.parent.code_signature.team_id":{type:"keyword",array:!1,required:!1},"process.parent.code_signature.timestamp":{type:"date",array:!1,required:!1},"process.parent.code_signature.trusted":{type:"boolean",array:!1,required:!1},"process.parent.code_signature.valid":{type:"boolean",array:!1,required:!1},"process.parent.command_line":{type:"wildcard",array:!1,required:!1},"process.parent.elf.architecture":{type:"keyword",array:!1,required:!1},"process.parent.elf.byte_order":{type:"keyword",array:!1,required:!1},"process.parent.elf.cpu_type":{type:"keyword",array:!1,required:!1},"process.parent.elf.creation_date":{type:"date",array:!1,required:!1},"process.parent.elf.exports":{type:"flattened",array:!0,required:!1},"process.parent.elf.header.abi_version":{type:"keyword",array:!1,required:!1},"process.parent.elf.header.class":{type:"keyword",array:!1,required:!1},"process.parent.elf.header.data":{type:"keyword",array:!1,required:!1},"process.parent.elf.header.entrypoint":{type:"long",array:!1,required:!1},"process.parent.elf.header.object_version":{type:"keyword",array:!1,required:!1},"process.parent.elf.header.os_abi":{type:"keyword",array:!1,required:!1},"process.parent.elf.header.type":{type:"keyword",array:!1,required:!1},"process.parent.elf.header.version":{type:"keyword",array:!1,required:!1},"process.parent.elf.imports":{type:"flattened",array:!0,required:!1},"process.parent.elf.sections":{type:"nested",array:!0,required:!1},"process.parent.elf.sections.chi2":{type:"long",array:!1,required:!1},"process.parent.elf.sections.entropy":{type:"long",array:!1,required:!1},"process.parent.elf.sections.flags":{type:"keyword",array:!1,required:!1},"process.parent.elf.sections.name":{type:"keyword",array:!1,required:!1},"process.parent.elf.sections.physical_offset":{type:"keyword",array:!1,required:!1},"process.parent.elf.sections.physical_size":{type:"long",array:!1,required:!1},"process.parent.elf.sections.type":{type:"keyword",array:!1,required:!1},"process.parent.elf.sections.virtual_address":{type:"long",array:!1,required:!1},"process.parent.elf.sections.virtual_size":{type:"long",array:!1,required:!1},"process.parent.elf.segments":{type:"nested",array:!0,required:!1},"process.parent.elf.segments.sections":{type:"keyword",array:!1,required:!1},"process.parent.elf.segments.type":{type:"keyword",array:!1,required:!1},"process.parent.elf.shared_libraries":{type:"keyword",array:!0,required:!1},"process.parent.elf.telfhash":{type:"keyword",array:!1,required:!1},"process.parent.end":{type:"date",array:!1,required:!1},"process.parent.entity_id":{type:"keyword",array:!1,required:!1},"process.parent.executable":{type:"keyword",array:!1,required:!1},"process.parent.exit_code":{type:"long",array:!1,required:!1},"process.parent.hash.md5":{type:"keyword",array:!1,required:!1},"process.parent.hash.sha1":{type:"keyword",array:!1,required:!1},"process.parent.hash.sha256":{type:"keyword",array:!1,required:!1},"process.parent.hash.sha512":{type:"keyword",array:!1,required:!1},"process.parent.hash.ssdeep":{type:"keyword",array:!1,required:!1},"process.parent.name":{type:"keyword",array:!1,required:!1},"process.parent.pe.architecture":{type:"keyword",array:!1,required:!1},"process.parent.pe.company":{type:"keyword",array:!1,required:!1},"process.parent.pe.description":{type:"keyword",array:!1,required:!1},"process.parent.pe.file_version":{type:"keyword",array:!1,required:!1},"process.parent.pe.imphash":{type:"keyword",array:!1,required:!1},"process.parent.pe.original_file_name":{type:"keyword",array:!1,required:!1},"process.parent.pe.product":{type:"keyword",array:!1,required:!1},"process.parent.pgid":{type:"long",array:!1,required:!1},"process.parent.pid":{type:"long",array:!1,required:!1},"process.parent.start":{type:"date",array:!1,required:!1},"process.parent.thread.id":{type:"long",array:!1,required:!1},"process.parent.thread.name":{type:"keyword",array:!1,required:!1},"process.parent.title":{type:"keyword",array:!1,required:!1},"process.parent.uptime":{type:"long",array:!1,required:!1},"process.parent.working_directory":{type:"keyword",array:!1,required:!1},"process.pe.architecture":{type:"keyword",array:!1,required:!1},"process.pe.company":{type:"keyword",array:!1,required:!1},"process.pe.description":{type:"keyword",array:!1,required:!1},"process.pe.file_version":{type:"keyword",array:!1,required:!1},"process.pe.imphash":{type:"keyword",array:!1,required:!1},"process.pe.original_file_name":{type:"keyword",array:!1,required:!1},"process.pe.product":{type:"keyword",array:!1,required:!1},"process.pgid":{type:"long",array:!1,required:!1},"process.pid":{type:"long",array:!1,required:!1},"process.session_leader.entity_id":{type:"keyword",array:!1,required:!1},"process.start":{type:"date",array:!1,required:!1},"process.thread.id":{type:"long",array:!1,required:!1},"process.thread.name":{type:"keyword",array:!1,required:!1},"process.title":{type:"keyword",array:!1,required:!1},"process.uptime":{type:"long",array:!1,required:!1},"process.working_directory":{type:"keyword",array:!1,required:!1},"registry.data.bytes":{type:"keyword",array:!1,required:!1},"registry.data.strings":{type:"wildcard",array:!0,required:!1},"registry.data.type":{type:"keyword",array:!1,required:!1},"registry.hive":{type:"keyword",array:!1,required:!1},"registry.key":{type:"keyword",array:!1,required:!1},"registry.path":{type:"keyword",array:!1,required:!1},"registry.value":{type:"keyword",array:!1,required:!1},"related.hash":{type:"keyword",array:!0,required:!1},"related.hosts":{type:"keyword",array:!0,required:!1},"related.ip":{type:"ip",array:!0,required:!1},"related.user":{type:"keyword",array:!0,required:!1},"rule.author":{type:"keyword",array:!0,required:!1},"rule.category":{type:"keyword",array:!1,required:!1},"rule.description":{type:"keyword",array:!1,required:!1},"rule.id":{type:"keyword",array:!1,required:!1},"rule.license":{type:"keyword",array:!1,required:!1},"rule.name":{type:"keyword",array:!1,required:!1},"rule.reference":{type:"keyword",array:!1,required:!1},"rule.ruleset":{type:"keyword",array:!1,required:!1},"rule.uuid":{type:"keyword",array:!1,required:!1},"rule.version":{type:"keyword",array:!1,required:!1},"server.address":{type:"keyword",array:!1,required:!1},"server.as.number":{type:"long",array:!1,required:!1},"server.as.organization.name":{type:"keyword",array:!1,required:!1},"server.bytes":{type:"long",array:!1,required:!1},"server.domain":{type:"keyword",array:!1,required:!1},"server.geo.city_name":{type:"keyword",array:!1,required:!1},"server.geo.continent_code":{type:"keyword",array:!1,required:!1},"server.geo.continent_name":{type:"keyword",array:!1,required:!1},"server.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"server.geo.country_name":{type:"keyword",array:!1,required:!1},"server.geo.location":{type:"geo_point",array:!1,required:!1},"server.geo.name":{type:"keyword",array:!1,required:!1},"server.geo.postal_code":{type:"keyword",array:!1,required:!1},"server.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"server.geo.region_name":{type:"keyword",array:!1,required:!1},"server.geo.timezone":{type:"keyword",array:!1,required:!1},"server.ip":{type:"ip",array:!1,required:!1},"server.mac":{type:"keyword",array:!1,required:!1},"server.nat.ip":{type:"ip",array:!1,required:!1},"server.nat.port":{type:"long",array:!1,required:!1},"server.packets":{type:"long",array:!1,required:!1},"server.port":{type:"long",array:!1,required:!1},"server.registered_domain":{type:"keyword",array:!1,required:!1},"server.subdomain":{type:"keyword",array:!1,required:!1},"server.top_level_domain":{type:"keyword",array:!1,required:!1},"server.user.domain":{type:"keyword",array:!1,required:!1},"server.user.email":{type:"keyword",array:!1,required:!1},"server.user.full_name":{type:"keyword",array:!1,required:!1},"server.user.group.domain":{type:"keyword",array:!1,required:!1},"server.user.group.id":{type:"keyword",array:!1,required:!1},"server.user.group.name":{type:"keyword",array:!1,required:!1},"server.user.hash":{type:"keyword",array:!1,required:!1},"server.user.id":{type:"keyword",array:!1,required:!1},"server.user.name":{type:"keyword",array:!1,required:!1},"server.user.roles":{type:"keyword",array:!0,required:!1},"service.address":{type:"keyword",array:!1,required:!1},"service.environment":{type:"keyword",array:!1,required:!1},"service.ephemeral_id":{type:"keyword",array:!1,required:!1},"service.id":{type:"keyword",array:!1,required:!1},"service.name":{type:"keyword",array:!1,required:!1},"service.node.name":{type:"keyword",array:!1,required:!1},"service.origin.address":{type:"keyword",array:!1,required:!1},"service.origin.environment":{type:"keyword",array:!1,required:!1},"service.origin.ephemeral_id":{type:"keyword",array:!1,required:!1},"service.origin.id":{type:"keyword",array:!1,required:!1},"service.origin.name":{type:"keyword",array:!1,required:!1},"service.origin.node.name":{type:"keyword",array:!1,required:!1},"service.origin.state":{type:"keyword",array:!1,required:!1},"service.origin.type":{type:"keyword",array:!1,required:!1},"service.origin.version":{type:"keyword",array:!1,required:!1},"service.state":{type:"keyword",array:!1,required:!1},"service.target.address":{type:"keyword",array:!1,required:!1},"service.target.environment":{type:"keyword",array:!1,required:!1},"service.target.ephemeral_id":{type:"keyword",array:!1,required:!1},"service.target.id":{type:"keyword",array:!1,required:!1},"service.target.name":{type:"keyword",array:!1,required:!1},"service.target.node.name":{type:"keyword",array:!1,required:!1},"service.target.state":{type:"keyword",array:!1,required:!1},"service.target.type":{type:"keyword",array:!1,required:!1},"service.target.version":{type:"keyword",array:!1,required:!1},"service.type":{type:"keyword",array:!1,required:!1},"service.version":{type:"keyword",array:!1,required:!1},"source.address":{type:"keyword",array:!1,required:!1},"source.as.number":{type:"long",array:!1,required:!1},"source.as.organization.name":{type:"keyword",array:!1,required:!1},"source.bytes":{type:"long",array:!1,required:!1},"source.domain":{type:"keyword",array:!1,required:!1},"source.geo.city_name":{type:"keyword",array:!1,required:!1},"source.geo.continent_code":{type:"keyword",array:!1,required:!1},"source.geo.continent_name":{type:"keyword",array:!1,required:!1},"source.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"source.geo.country_name":{type:"keyword",array:!1,required:!1},"source.geo.location":{type:"geo_point",array:!1,required:!1},"source.geo.name":{type:"keyword",array:!1,required:!1},"source.geo.postal_code":{type:"keyword",array:!1,required:!1},"source.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"source.geo.region_name":{type:"keyword",array:!1,required:!1},"source.geo.timezone":{type:"keyword",array:!1,required:!1},"source.ip":{type:"ip",array:!1,required:!1},"source.mac":{type:"keyword",array:!1,required:!1},"source.nat.ip":{type:"ip",array:!1,required:!1},"source.nat.port":{type:"long",array:!1,required:!1},"source.packets":{type:"long",array:!1,required:!1},"source.port":{type:"long",array:!1,required:!1},"source.registered_domain":{type:"keyword",array:!1,required:!1},"source.subdomain":{type:"keyword",array:!1,required:!1},"source.top_level_domain":{type:"keyword",array:!1,required:!1},"source.user.domain":{type:"keyword",array:!1,required:!1},"source.user.email":{type:"keyword",array:!1,required:!1},"source.user.full_name":{type:"keyword",array:!1,required:!1},"source.user.group.domain":{type:"keyword",array:!1,required:!1},"source.user.group.id":{type:"keyword",array:!1,required:!1},"source.user.group.name":{type:"keyword",array:!1,required:!1},"source.user.hash":{type:"keyword",array:!1,required:!1},"source.user.id":{type:"keyword",array:!1,required:!1},"source.user.name":{type:"keyword",array:!1,required:!1},"source.user.roles":{type:"keyword",array:!0,required:!1},"span.id":{type:"keyword",array:!1,required:!1},tags:{type:"keyword",array:!0,required:!1},"threat.enrichments":{type:"nested",array:!0,required:!1},"threat.enrichments.indicator":{type:"object",array:!1,required:!1},"threat.enrichments.indicator.as.number":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.as.organization.name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.confidence":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.description":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.email.address":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.accessed":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.attributes":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.code_signature.digest_algorithm":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.exists":{type:"boolean",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.signing_id":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.status":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.subject_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.team_id":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.timestamp":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.trusted":{type:"boolean",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.valid":{type:"boolean",array:!1,required:!1},"threat.enrichments.indicator.file.created":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.ctime":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.device":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.directory":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.drive_letter":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.architecture":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.byte_order":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.cpu_type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.creation_date":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.elf.exports":{type:"flattened",array:!0,required:!1},"threat.enrichments.indicator.file.elf.header.abi_version":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.header.class":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.header.data":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.header.entrypoint":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.elf.header.object_version":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.header.os_abi":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.header.type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.header.version":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.imports":{type:"flattened",array:!0,required:!1},"threat.enrichments.indicator.file.elf.sections":{type:"nested",array:!0,required:!1},"threat.enrichments.indicator.file.elf.sections.chi2":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.entropy":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.flags":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.physical_offset":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.physical_size":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.virtual_address":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.virtual_size":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.elf.segments":{type:"nested",array:!0,required:!1},"threat.enrichments.indicator.file.elf.segments.sections":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.segments.type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.shared_libraries":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.elf.telfhash":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.extension":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.fork_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.gid":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.group":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.hash.md5":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.hash.sha1":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.hash.sha256":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.hash.sha512":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.hash.ssdeep":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.inode":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.mime_type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.mode":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.mtime":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.owner":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.path":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.pe.architecture":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.pe.company":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.pe.description":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.pe.file_version":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.pe.imphash":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.pe.original_file_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.pe.product":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.size":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.target_path":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.uid":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.x509.alternative_names":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.issuer.common_name":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.issuer.country":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.issuer.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.x509.issuer.locality":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.issuer.organization":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.issuer.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.issuer.state_or_province":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.not_after":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.x509.not_before":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.x509.public_key_algorithm":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.x509.public_key_curve":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.x509.public_key_exponent":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.x509.public_key_size":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.x509.serial_number":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.x509.signature_algorithm":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.x509.subject.common_name":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.subject.country":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.subject.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.x509.subject.locality":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.subject.organization":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.subject.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.subject.state_or_province":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.version_number":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.first_seen":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.geo.city_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.continent_code":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.continent_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.country_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.location":{type:"geo_point",array:!1,required:!1},"threat.enrichments.indicator.geo.name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.postal_code":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.region_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.timezone":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.ip":{type:"ip",array:!1,required:!1},"threat.enrichments.indicator.last_seen":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.marking.tlp":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.modified_at":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.port":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.provider":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.reference":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.registry.data.bytes":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.registry.data.strings":{type:"wildcard",array:!0,required:!1},"threat.enrichments.indicator.registry.data.type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.registry.hive":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.registry.key":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.registry.path":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.registry.value":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.scanner_stats":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.sightings":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.domain":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.extension":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.fragment":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.full":{type:"wildcard",array:!1,required:!1},"threat.enrichments.indicator.url.original":{type:"wildcard",array:!1,required:!1},"threat.enrichments.indicator.url.password":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.path":{type:"wildcard",array:!1,required:!1},"threat.enrichments.indicator.url.port":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.url.query":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.registered_domain":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.scheme":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.subdomain":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.top_level_domain":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.username":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.x509.alternative_names":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.issuer.common_name":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.issuer.country":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.issuer.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.x509.issuer.locality":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.issuer.organization":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.issuer.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.issuer.state_or_province":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.not_after":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.x509.not_before":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.x509.public_key_algorithm":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.x509.public_key_curve":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.x509.public_key_exponent":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.x509.public_key_size":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.x509.serial_number":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.x509.signature_algorithm":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.x509.subject.common_name":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.subject.country":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.subject.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.x509.subject.locality":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.subject.organization":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.subject.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.subject.state_or_province":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.version_number":{type:"keyword",array:!1,required:!1},"threat.enrichments.matched.atomic":{type:"keyword",array:!1,required:!1},"threat.enrichments.matched.field":{type:"keyword",array:!1,required:!1},"threat.enrichments.matched.id":{type:"keyword",array:!1,required:!1},"threat.enrichments.matched.index":{type:"keyword",array:!1,required:!1},"threat.enrichments.matched.type":{type:"keyword",array:!1,required:!1},"threat.framework":{type:"keyword",array:!1,required:!1},"threat.group.alias":{type:"keyword",array:!0,required:!1},"threat.group.id":{type:"keyword",array:!1,required:!1},"threat.group.name":{type:"keyword",array:!1,required:!1},"threat.group.reference":{type:"keyword",array:!1,required:!1},"threat.indicator.as.number":{type:"long",array:!1,required:!1},"threat.indicator.as.organization.name":{type:"keyword",array:!1,required:!1},"threat.indicator.confidence":{type:"keyword",array:!1,required:!1},"threat.indicator.description":{type:"keyword",array:!1,required:!1},"threat.indicator.email.address":{type:"keyword",array:!1,required:!1},"threat.indicator.file.accessed":{type:"date",array:!1,required:!1},"threat.indicator.file.attributes":{type:"keyword",array:!0,required:!1},"threat.indicator.file.code_signature.digest_algorithm":{type:"keyword",array:!1,required:!1},"threat.indicator.file.code_signature.exists":{type:"boolean",array:!1,required:!1},"threat.indicator.file.code_signature.signing_id":{type:"keyword",array:!1,required:!1},"threat.indicator.file.code_signature.status":{type:"keyword",array:!1,required:!1},"threat.indicator.file.code_signature.subject_name":{type:"keyword",array:!1,required:!1},"threat.indicator.file.code_signature.team_id":{type:"keyword",array:!1,required:!1},"threat.indicator.file.code_signature.timestamp":{type:"date",array:!1,required:!1},"threat.indicator.file.code_signature.trusted":{type:"boolean",array:!1,required:!1},"threat.indicator.file.code_signature.valid":{type:"boolean",array:!1,required:!1},"threat.indicator.file.created":{type:"date",array:!1,required:!1},"threat.indicator.file.ctime":{type:"date",array:!1,required:!1},"threat.indicator.file.device":{type:"keyword",array:!1,required:!1},"threat.indicator.file.directory":{type:"keyword",array:!1,required:!1},"threat.indicator.file.drive_letter":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.architecture":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.byte_order":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.cpu_type":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.creation_date":{type:"date",array:!1,required:!1},"threat.indicator.file.elf.exports":{type:"flattened",array:!0,required:!1},"threat.indicator.file.elf.header.abi_version":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.header.class":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.header.data":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.header.entrypoint":{type:"long",array:!1,required:!1},"threat.indicator.file.elf.header.object_version":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.header.os_abi":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.header.type":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.header.version":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.imports":{type:"flattened",array:!0,required:!1},"threat.indicator.file.elf.sections":{type:"nested",array:!0,required:!1},"threat.indicator.file.elf.sections.chi2":{type:"long",array:!1,required:!1},"threat.indicator.file.elf.sections.entropy":{type:"long",array:!1,required:!1},"threat.indicator.file.elf.sections.flags":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.sections.name":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.sections.physical_offset":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.sections.physical_size":{type:"long",array:!1,required:!1},"threat.indicator.file.elf.sections.type":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.sections.virtual_address":{type:"long",array:!1,required:!1},"threat.indicator.file.elf.sections.virtual_size":{type:"long",array:!1,required:!1},"threat.indicator.file.elf.segments":{type:"nested",array:!0,required:!1},"threat.indicator.file.elf.segments.sections":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.segments.type":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.shared_libraries":{type:"keyword",array:!0,required:!1},"threat.indicator.file.elf.telfhash":{type:"keyword",array:!1,required:!1},"threat.indicator.file.extension":{type:"keyword",array:!1,required:!1},"threat.indicator.file.fork_name":{type:"keyword",array:!1,required:!1},"threat.indicator.file.gid":{type:"keyword",array:!1,required:!1},"threat.indicator.file.group":{type:"keyword",array:!1,required:!1},"threat.indicator.file.hash.md5":{type:"keyword",array:!1,required:!1},"threat.indicator.file.hash.sha1":{type:"keyword",array:!1,required:!1},"threat.indicator.file.hash.sha256":{type:"keyword",array:!1,required:!1},"threat.indicator.file.hash.sha512":{type:"keyword",array:!1,required:!1},"threat.indicator.file.hash.ssdeep":{type:"keyword",array:!1,required:!1},"threat.indicator.file.inode":{type:"keyword",array:!1,required:!1},"threat.indicator.file.mime_type":{type:"keyword",array:!1,required:!1},"threat.indicator.file.mode":{type:"keyword",array:!1,required:!1},"threat.indicator.file.mtime":{type:"date",array:!1,required:!1},"threat.indicator.file.name":{type:"keyword",array:!1,required:!1},"threat.indicator.file.owner":{type:"keyword",array:!1,required:!1},"threat.indicator.file.path":{type:"keyword",array:!1,required:!1},"threat.indicator.file.pe.architecture":{type:"keyword",array:!1,required:!1},"threat.indicator.file.pe.company":{type:"keyword",array:!1,required:!1},"threat.indicator.file.pe.description":{type:"keyword",array:!1,required:!1},"threat.indicator.file.pe.file_version":{type:"keyword",array:!1,required:!1},"threat.indicator.file.pe.imphash":{type:"keyword",array:!1,required:!1},"threat.indicator.file.pe.original_file_name":{type:"keyword",array:!1,required:!1},"threat.indicator.file.pe.product":{type:"keyword",array:!1,required:!1},"threat.indicator.file.size":{type:"long",array:!1,required:!1},"threat.indicator.file.target_path":{type:"keyword",array:!1,required:!1},"threat.indicator.file.type":{type:"keyword",array:!1,required:!1},"threat.indicator.file.uid":{type:"keyword",array:!1,required:!1},"threat.indicator.file.x509.alternative_names":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.issuer.common_name":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.issuer.country":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.issuer.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.indicator.file.x509.issuer.locality":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.issuer.organization":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.issuer.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.issuer.state_or_province":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.not_after":{type:"date",array:!1,required:!1},"threat.indicator.file.x509.not_before":{type:"date",array:!1,required:!1},"threat.indicator.file.x509.public_key_algorithm":{type:"keyword",array:!1,required:!1},"threat.indicator.file.x509.public_key_curve":{type:"keyword",array:!1,required:!1},"threat.indicator.file.x509.public_key_exponent":{type:"long",array:!1,required:!1},"threat.indicator.file.x509.public_key_size":{type:"long",array:!1,required:!1},"threat.indicator.file.x509.serial_number":{type:"keyword",array:!1,required:!1},"threat.indicator.file.x509.signature_algorithm":{type:"keyword",array:!1,required:!1},"threat.indicator.file.x509.subject.common_name":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.subject.country":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.subject.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.indicator.file.x509.subject.locality":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.subject.organization":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.subject.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.subject.state_or_province":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.version_number":{type:"keyword",array:!1,required:!1},"threat.indicator.first_seen":{type:"date",array:!1,required:!1},"threat.indicator.geo.city_name":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.continent_code":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.continent_name":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.country_name":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.location":{type:"geo_point",array:!1,required:!1},"threat.indicator.geo.name":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.postal_code":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.region_name":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.timezone":{type:"keyword",array:!1,required:!1},"threat.indicator.ip":{type:"ip",array:!1,required:!1},"threat.indicator.last_seen":{type:"date",array:!1,required:!1},"threat.indicator.marking.tlp":{type:"keyword",array:!1,required:!1},"threat.indicator.modified_at":{type:"date",array:!1,required:!1},"threat.indicator.port":{type:"long",array:!1,required:!1},"threat.indicator.provider":{type:"keyword",array:!1,required:!1},"threat.indicator.reference":{type:"keyword",array:!1,required:!1},"threat.indicator.registry.data.bytes":{type:"keyword",array:!1,required:!1},"threat.indicator.registry.data.strings":{type:"wildcard",array:!0,required:!1},"threat.indicator.registry.data.type":{type:"keyword",array:!1,required:!1},"threat.indicator.registry.hive":{type:"keyword",array:!1,required:!1},"threat.indicator.registry.key":{type:"keyword",array:!1,required:!1},"threat.indicator.registry.path":{type:"keyword",array:!1,required:!1},"threat.indicator.registry.value":{type:"keyword",array:!1,required:!1},"threat.indicator.scanner_stats":{type:"long",array:!1,required:!1},"threat.indicator.sightings":{type:"long",array:!1,required:!1},"threat.indicator.type":{type:"keyword",array:!1,required:!1},"threat.indicator.url.domain":{type:"keyword",array:!1,required:!1},"threat.indicator.url.extension":{type:"keyword",array:!1,required:!1},"threat.indicator.url.fragment":{type:"keyword",array:!1,required:!1},"threat.indicator.url.full":{type:"wildcard",array:!1,required:!1},"threat.indicator.url.original":{type:"wildcard",array:!1,required:!1},"threat.indicator.url.password":{type:"keyword",array:!1,required:!1},"threat.indicator.url.path":{type:"wildcard",array:!1,required:!1},"threat.indicator.url.port":{type:"long",array:!1,required:!1},"threat.indicator.url.query":{type:"keyword",array:!1,required:!1},"threat.indicator.url.registered_domain":{type:"keyword",array:!1,required:!1},"threat.indicator.url.scheme":{type:"keyword",array:!1,required:!1},"threat.indicator.url.subdomain":{type:"keyword",array:!1,required:!1},"threat.indicator.url.top_level_domain":{type:"keyword",array:!1,required:!1},"threat.indicator.url.username":{type:"keyword",array:!1,required:!1},"threat.indicator.x509.alternative_names":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.issuer.common_name":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.issuer.country":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.issuer.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.indicator.x509.issuer.locality":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.issuer.organization":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.issuer.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.issuer.state_or_province":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.not_after":{type:"date",array:!1,required:!1},"threat.indicator.x509.not_before":{type:"date",array:!1,required:!1},"threat.indicator.x509.public_key_algorithm":{type:"keyword",array:!1,required:!1},"threat.indicator.x509.public_key_curve":{type:"keyword",array:!1,required:!1},"threat.indicator.x509.public_key_exponent":{type:"long",array:!1,required:!1},"threat.indicator.x509.public_key_size":{type:"long",array:!1,required:!1},"threat.indicator.x509.serial_number":{type:"keyword",array:!1,required:!1},"threat.indicator.x509.signature_algorithm":{type:"keyword",array:!1,required:!1},"threat.indicator.x509.subject.common_name":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.subject.country":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.subject.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.indicator.x509.subject.locality":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.subject.organization":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.subject.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.subject.state_or_province":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.version_number":{type:"keyword",array:!1,required:!1},"threat.software.alias":{type:"keyword",array:!0,required:!1},"threat.software.id":{type:"keyword",array:!1,required:!1},"threat.software.name":{type:"keyword",array:!1,required:!1},"threat.software.platforms":{type:"keyword",array:!0,required:!1},"threat.software.reference":{type:"keyword",array:!1,required:!1},"threat.software.type":{type:"keyword",array:!1,required:!1},"threat.tactic.id":{type:"keyword",array:!0,required:!1},"threat.tactic.name":{type:"keyword",array:!0,required:!1},"threat.tactic.reference":{type:"keyword",array:!0,required:!1},"threat.technique.id":{type:"keyword",array:!0,required:!1},"threat.technique.name":{type:"keyword",array:!0,required:!1},"threat.technique.reference":{type:"keyword",array:!0,required:!1},"threat.technique.subtechnique.id":{type:"keyword",array:!0,required:!1},"threat.technique.subtechnique.name":{type:"keyword",array:!0,required:!1},"threat.technique.subtechnique.reference":{type:"keyword",array:!0,required:!1},"tls.cipher":{type:"keyword",array:!1,required:!1},"tls.client.certificate":{type:"keyword",array:!1,required:!1},"tls.client.certificate_chain":{type:"keyword",array:!0,required:!1},"tls.client.hash.md5":{type:"keyword",array:!1,required:!1},"tls.client.hash.sha1":{type:"keyword",array:!1,required:!1},"tls.client.hash.sha256":{type:"keyword",array:!1,required:!1},"tls.client.issuer":{type:"keyword",array:!1,required:!1},"tls.client.ja3":{type:"keyword",array:!1,required:!1},"tls.client.not_after":{type:"date",array:!1,required:!1},"tls.client.not_before":{type:"date",array:!1,required:!1},"tls.client.server_name":{type:"keyword",array:!1,required:!1},"tls.client.subject":{type:"keyword",array:!1,required:!1},"tls.client.supported_ciphers":{type:"keyword",array:!0,required:!1},"tls.client.x509.alternative_names":{type:"keyword",array:!0,required:!1},"tls.client.x509.issuer.common_name":{type:"keyword",array:!0,required:!1},"tls.client.x509.issuer.country":{type:"keyword",array:!0,required:!1},"tls.client.x509.issuer.distinguished_name":{type:"keyword",array:!1,required:!1},"tls.client.x509.issuer.locality":{type:"keyword",array:!0,required:!1},"tls.client.x509.issuer.organization":{type:"keyword",array:!0,required:!1},"tls.client.x509.issuer.organizational_unit":{type:"keyword",array:!0,required:!1},"tls.client.x509.issuer.state_or_province":{type:"keyword",array:!0,required:!1},"tls.client.x509.not_after":{type:"date",array:!1,required:!1},"tls.client.x509.not_before":{type:"date",array:!1,required:!1},"tls.client.x509.public_key_algorithm":{type:"keyword",array:!1,required:!1},"tls.client.x509.public_key_curve":{type:"keyword",array:!1,required:!1},"tls.client.x509.public_key_exponent":{type:"long",array:!1,required:!1},"tls.client.x509.public_key_size":{type:"long",array:!1,required:!1},"tls.client.x509.serial_number":{type:"keyword",array:!1,required:!1},"tls.client.x509.signature_algorithm":{type:"keyword",array:!1,required:!1},"tls.client.x509.subject.common_name":{type:"keyword",array:!0,required:!1},"tls.client.x509.subject.country":{type:"keyword",array:!0,required:!1},"tls.client.x509.subject.distinguished_name":{type:"keyword",array:!1,required:!1},"tls.client.x509.subject.locality":{type:"keyword",array:!0,required:!1},"tls.client.x509.subject.organization":{type:"keyword",array:!0,required:!1},"tls.client.x509.subject.organizational_unit":{type:"keyword",array:!0,required:!1},"tls.client.x509.subject.state_or_province":{type:"keyword",array:!0,required:!1},"tls.client.x509.version_number":{type:"keyword",array:!1,required:!1},"tls.curve":{type:"keyword",array:!1,required:!1},"tls.established":{type:"boolean",array:!1,required:!1},"tls.next_protocol":{type:"keyword",array:!1,required:!1},"tls.resumed":{type:"boolean",array:!1,required:!1},"tls.server.certificate":{type:"keyword",array:!1,required:!1},"tls.server.certificate_chain":{type:"keyword",array:!0,required:!1},"tls.server.hash.md5":{type:"keyword",array:!1,required:!1},"tls.server.hash.sha1":{type:"keyword",array:!1,required:!1},"tls.server.hash.sha256":{type:"keyword",array:!1,required:!1},"tls.server.issuer":{type:"keyword",array:!1,required:!1},"tls.server.ja3s":{type:"keyword",array:!1,required:!1},"tls.server.not_after":{type:"date",array:!1,required:!1},"tls.server.not_before":{type:"date",array:!1,required:!1},"tls.server.subject":{type:"keyword",array:!1,required:!1},"tls.server.x509.alternative_names":{type:"keyword",array:!0,required:!1},"tls.server.x509.issuer.common_name":{type:"keyword",array:!0,required:!1},"tls.server.x509.issuer.country":{type:"keyword",array:!0,required:!1},"tls.server.x509.issuer.distinguished_name":{type:"keyword",array:!1,required:!1},"tls.server.x509.issuer.locality":{type:"keyword",array:!0,required:!1},"tls.server.x509.issuer.organization":{type:"keyword",array:!0,required:!1},"tls.server.x509.issuer.organizational_unit":{type:"keyword",array:!0,required:!1},"tls.server.x509.issuer.state_or_province":{type:"keyword",array:!0,required:!1},"tls.server.x509.not_after":{type:"date",array:!1,required:!1},"tls.server.x509.not_before":{type:"date",array:!1,required:!1},"tls.server.x509.public_key_algorithm":{type:"keyword",array:!1,required:!1},"tls.server.x509.public_key_curve":{type:"keyword",array:!1,required:!1},"tls.server.x509.public_key_exponent":{type:"long",array:!1,required:!1},"tls.server.x509.public_key_size":{type:"long",array:!1,required:!1},"tls.server.x509.serial_number":{type:"keyword",array:!1,required:!1},"tls.server.x509.signature_algorithm":{type:"keyword",array:!1,required:!1},"tls.server.x509.subject.common_name":{type:"keyword",array:!0,required:!1},"tls.server.x509.subject.country":{type:"keyword",array:!0,required:!1},"tls.server.x509.subject.distinguished_name":{type:"keyword",array:!1,required:!1},"tls.server.x509.subject.locality":{type:"keyword",array:!0,required:!1},"tls.server.x509.subject.organization":{type:"keyword",array:!0,required:!1},"tls.server.x509.subject.organizational_unit":{type:"keyword",array:!0,required:!1},"tls.server.x509.subject.state_or_province":{type:"keyword",array:!0,required:!1},"tls.server.x509.version_number":{type:"keyword",array:!1,required:!1},"tls.version":{type:"keyword",array:!1,required:!1},"tls.version_protocol":{type:"keyword",array:!1,required:!1},"trace.id":{type:"keyword",array:!1,required:!1},"transaction.id":{type:"keyword",array:!1,required:!1},"url.domain":{type:"keyword",array:!1,required:!1},"url.extension":{type:"keyword",array:!1,required:!1},"url.fragment":{type:"keyword",array:!1,required:!1},"url.full":{type:"wildcard",array:!1,required:!1},"url.original":{type:"wildcard",array:!1,required:!1},"url.password":{type:"keyword",array:!1,required:!1},"url.path":{type:"wildcard",array:!1,required:!1},"url.port":{type:"long",array:!1,required:!1},"url.query":{type:"keyword",array:!1,required:!1},"url.registered_domain":{type:"keyword",array:!1,required:!1},"url.scheme":{type:"keyword",array:!1,required:!1},"url.subdomain":{type:"keyword",array:!1,required:!1},"url.top_level_domain":{type:"keyword",array:!1,required:!1},"url.username":{type:"keyword",array:!1,required:!1},"user.changes.domain":{type:"keyword",array:!1,required:!1},"user.changes.email":{type:"keyword",array:!1,required:!1},"user.changes.full_name":{type:"keyword",array:!1,required:!1},"user.changes.group.domain":{type:"keyword",array:!1,required:!1},"user.changes.group.id":{type:"keyword",array:!1,required:!1},"user.changes.group.name":{type:"keyword",array:!1,required:!1},"user.changes.hash":{type:"keyword",array:!1,required:!1},"user.changes.id":{type:"keyword",array:!1,required:!1},"user.changes.name":{type:"keyword",array:!1,required:!1},"user.changes.roles":{type:"keyword",array:!0,required:!1},"user.domain":{type:"keyword",array:!1,required:!1},"user.effective.domain":{type:"keyword",array:!1,required:!1},"user.effective.email":{type:"keyword",array:!1,required:!1},"user.effective.full_name":{type:"keyword",array:!1,required:!1},"user.effective.group.domain":{type:"keyword",array:!1,required:!1},"user.effective.group.id":{type:"keyword",array:!1,required:!1},"user.effective.group.name":{type:"keyword",array:!1,required:!1},"user.effective.hash":{type:"keyword",array:!1,required:!1},"user.effective.id":{type:"keyword",array:!1,required:!1},"user.effective.name":{type:"keyword",array:!1,required:!1},"user.effective.roles":{type:"keyword",array:!0,required:!1},"user.email":{type:"keyword",array:!1,required:!1},"user.full_name":{type:"keyword",array:!1,required:!1},"user.group.domain":{type:"keyword",array:!1,required:!1},"user.group.id":{type:"keyword",array:!1,required:!1},"user.group.name":{type:"keyword",array:!1,required:!1},"user.hash":{type:"keyword",array:!1,required:!1},"user.id":{type:"keyword",array:!1,required:!1},"user.name":{type:"keyword",array:!1,required:!1},"user.risk.calculated_level":{type:"keyword",array:!1,required:!1},"user.risk.calculated_score":{type:"float",array:!1,required:!1},"user.risk.calculated_score_norm":{type:"float",array:!1,required:!1},"user.risk.static_level":{type:"keyword",array:!1,required:!1},"user.risk.static_score":{type:"float",array:!1,required:!1},"user.risk.static_score_norm":{type:"float",array:!1,required:!1},"user.roles":{type:"keyword",array:!0,required:!1},"user.target.domain":{type:"keyword",array:!1,required:!1},"user.target.email":{type:"keyword",array:!1,required:!1},"user.target.full_name":{type:"keyword",array:!1,required:!1},"user.target.group.domain":{type:"keyword",array:!1,required:!1},"user.target.group.id":{type:"keyword",array:!1,required:!1},"user.target.group.name":{type:"keyword",array:!1,required:!1},"user.target.hash":{type:"keyword",array:!1,required:!1},"user.target.id":{type:"keyword",array:!1,required:!1},"user.target.name":{type:"keyword",array:!1,required:!1},"user.target.roles":{type:"keyword",array:!0,required:!1},"user_agent.device.name":{type:"keyword",array:!1,required:!1},"user_agent.name":{type:"keyword",array:!1,required:!1},"user_agent.original":{type:"keyword",array:!1,required:!1},"user_agent.os.family":{type:"keyword",array:!1,required:!1},"user_agent.os.full":{type:"keyword",array:!1,required:!1},"user_agent.os.kernel":{type:"keyword",array:!1,required:!1},"user_agent.os.name":{type:"keyword",array:!1,required:!1},"user_agent.os.platform":{type:"keyword",array:!1,required:!1},"user_agent.os.type":{type:"keyword",array:!1,required:!1},"user_agent.os.version":{type:"keyword",array:!1,required:!1},"user_agent.version":{type:"keyword",array:!1,required:!1},"vulnerability.category":{type:"keyword",array:!0,required:!1},"vulnerability.classification":{type:"keyword",array:!1,required:!1},"vulnerability.description":{type:"keyword",array:!1,required:!1},"vulnerability.enumeration":{type:"keyword",array:!1,required:!1},"vulnerability.id":{type:"keyword",array:!1,required:!1},"vulnerability.reference":{type:"keyword",array:!1,required:!1},"vulnerability.report_id":{type:"keyword",array:!1,required:!1},"vulnerability.scanner.vendor":{type:"keyword",array:!1,required:!1},"vulnerability.score.base":{type:"float",array:!1,required:!1},"vulnerability.score.environmental":{type:"float",array:!1,required:!1},"vulnerability.score.temporal":{type:"float",array:!1,required:!1},"vulnerability.score.version":{type:"keyword",array:!1,required:!1},"vulnerability.severity":{type:"keyword",array:!1,required:!1}};var Oe=a(135);const we={[Oe.e]:{type:"scaled_float",scaling_factor:100},[Oe.f]:{type:"scaled_float",scaling_factor:100}},Te={...function(e,...t){const a=Object.keys(e).filter((e=>t.some((t=>{if(t===e)return!0;const a=e.split("."),n=t.split(".");return n.indexOf("*")===n.length-1&&a.every(((e,t)=>{const a=n.length-1<t?"*":n[t];return e===a||"*"===a}))}))));return Object(g.pick)(e,a)}(je,Oe.ib,Oe.eb,Oe.db,Oe.hb),[Oe.A]:{type:"flattened",ignore_above:4096},[Oe.I]:{type:"keyword",required:!0},[Oe.n]:{type:"keyword",required:!0},[Oe.B]:{type:"keyword",required:!0},[Oe.gb]:{type:"keyword",array:!0,required:!0},[Oe.Y]:{type:"keyword",required:!0},[Oe.h]:{type:"keyword",required:!0},[Oe.O]:{type:"date"},[Oe.X]:{type:"date_range",format:"epoch_millis||strict_date_optional_time"},[Oe.d]:{type:"date"},[Oe.c]:{type:"long"},[Oe.N]:{type:"keyword"},[Oe.P]:{type:"keyword",required:!0},[Oe.g]:{type:"boolean"},[Oe.jb]:{type:"version",array:!1,required:!1},[Oe.cb]:{type:"keyword",array:!1,required:!1},[Oe.k]:{type:"float",array:!1,required:!1},[Oe.ab]:{type:"keyword",array:!1,required:!1},[Oe.bb]:{type:"keyword",array:!1,required:!1},[Oe.Z]:{type:"keyword",array:!1,required:!1},[Oe.W]:{type:"keyword",array:!1,required:!1},[Oe.a]:{type:"keyword",array:!1,required:!1},[Oe.j]:{type:"keyword",array:!1,required:!1},[Oe.l]:{type:"keyword",array:!1,required:!1},[Oe.m]:{type:"keyword",array:!1,required:!0},[Oe.L]:{type:"keyword",array:!1,required:!0},[Oe.o]:{type:"date",array:!1,required:!1},[Oe.p]:{type:"keyword",array:!1,required:!1},[Oe.q]:{type:"keyword",array:!1,required:!1},[Oe.r]:{type:"keyword",array:!1,required:!1},[Oe.t]:{type:"keyword",array:!1,required:!1},[Oe.u]:{type:"keyword",array:!1,required:!1},[Oe.v]:{type:"keyword",array:!1,required:!1},[Oe.w]:{type:"keyword",array:!1,required:!1},[Oe.x]:{type:"keyword",array:!1,required:!0},[Oe.z]:{type:"keyword",array:!1,required:!1},[Oe.C]:{type:"keyword",array:!0,required:!1},[Oe.D]:{type:"keyword",array:!1,required:!1},[Oe.E]:{type:"keyword",array:!1,required:!1},[Oe.F]:{type:"keyword",array:!0,required:!1},[Oe.G]:{type:"keyword",array:!1,required:!1},[Oe.H]:{type:"keyword",array:!1,required:!1},[Oe.J]:{type:"date",array:!1,required:!1},[Oe.K]:{type:"keyword",array:!1,required:!1},[Oe.M]:{type:"keyword",array:!1,required:!1},[Oe.S]:{type:"keyword",array:!0,required:!1},[Oe.V]:{type:"keyword",array:!0,required:!1},[Oe.T]:{type:"date",array:!1,required:!1},[Oe.R]:{type:"date",array:!1,required:!1},[Oe.Q]:{type:"long",array:!1,required:!1}};var Ie=a(1);const Ce=e=>{if(Array.isArray(e))return e.reduce(((e,t)=>{if(null!=t)switch(typeof t){case"number":case"boolean":return[...e,t.toString()];case"object":try{return[...e,JSON.stringify(t)]}catch{return[...e,"Invalid Object"]}case"string":return[...e,t];default:return[...e,`${t}`]}return e}),[]);if(null==e)return[];if(Array.isArray(e)||"object"!=typeof e)return[`${e}`];try{return[JSON.stringify(e)]}catch{return["Invalid Object"]}},Me=["@timestamp","labels","message","tags"],Fe=e=>{const t=e.length>0?e[0]:null;if(null!=t&&!Object(n.isEmpty)(t.coordinates))try{return Ce({lon:t.coordinates[0],lat:t.coordinates[1]})}catch{return Ce(e)}return Ce(e)},De=(e,t,a)=>Object.keys(e).reduce(((i,r)=>{const s=e[r],o=null!=a?a:(e=>{const t=e.split(".")[0];return!Object(n.isEmpty)(t)&&Me.includes(t)?"base":t})(r);if((e=>e.includes("geo.location")||e.includes("geoip.location"))(r))return[...i,{category:o,field:r,values:Fe(s),originalValue:Fe(s),isObjectArray:!0}];const l=(e=>{if(Array.isArray(e))return e.reduce(((e,t)=>{if(null!=t)switch(typeof t){case"number":case"boolean":return[...e,{str:t.toString()}];case"object":try{return[...e,{str:JSON.stringify(t),isObjectArray:!0}]}catch{return[...e,{str:"Invalid Object"}]}case"string":return[...e,{str:t}];default:return[...e,{str:`${t}`}]}return e}),[]);if(null==e)return[];if(Array.isArray(e)||"object"!=typeof e)return[{str:`${e}`}];try{return[{str:JSON.stringify(e),isObjectArray:!0}]}catch{return[{str:"Invalid Object"}]}})(s),c=l.map((({str:e})=>e)),u=l.some((e=>e.isObjectArray)),d=t?`${t}.${r}`:r;if(!u||void 0===Object.keys({...je,...Te,...we}).find((e=>e===r)))return[...i,{category:o,field:d,values:c,originalValue:c,isObjectArray:u}];const p=((e,t)=>(null==t?void 0:t.includes(Ie.yb))||e===Ie.yb)(r,t)?[{category:o,field:d,values:c,originalValue:c,isObjectArray:u}]:[],m=Array.isArray(s)?s.reduce(((e,t)=>[...e,De(t,d,o)]),[]).flat():De(s,t,o),g=[...i,...m,...p].reduce(((e,t)=>({...e,...null!=e[t.field]?{[t.field]:{...t,originalValue:e[t.field].originalValue.includes(t.originalValue[0])?e[t.field].originalValue:[...e[t.field].originalValue,...t.originalValue],values:e[t.field].values.includes(t.values[0])?e[t.field].values:[...e[t.field].values,...t.values]}}:{[t.field]:t}})),{});return Object.values(g)}),[]);var Ae=a(140),_e=a(548);const Ne=e=>e?e[0]:void 0,Re=e=>e===Ae.c.InvestigationTime,Pe=(e,t)=>Ne(e[t]),Le=(e,t)=>Pe(e,t)||Pe(e,`threatintel.${t}`)||Pe(e,`threat.${t}`),Be=e=>({id:Pe(e,Ae.m),field:Pe(e,Ae.l),value:Pe(e,Ae.k),type:Pe(e,Ae.n),feedName:Le(e,Ae.e)}),qe=e=>{const{id:t,field:a}=Be(e);return`${t}${a}`},ze=e=>{const t=Le(e,Ae.f),a=Date.parse(null!=t?t:"no date");return Number.isInteger(a)?a:new Date(-1).valueOf()};var $e=a(196);const Ve=l.a.span.withConfig({displayName:"EnrichmentFieldFeedName",componentId:"sc-gb4ple-0"})(["white-space:nowrap;font-style:italic;"]),Ue=l()(i.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-gb4ple-1"})([".hoverActions-active{.timelines__hoverActionButton,.securitySolution__hoverActionButton{opacity:1;}}&:hover{.timelines__hoverActionButton,.securitySolution__hoverActionButton{opacity:1;}}"]),He=({browserField:e,data:t,eventId:a,index:n,feedName:r,scopeId:o,value:l,isDraggable:c,isReadOnly:u})=>{if(!t||!l)return null;const d=`alert-details-value-formatted-field-value-${o}-${a}-${t.field}-${l}-${n}-${r}`;return s.a.createElement(Ue,{key:d,direction:"row",gutterSize:"xs",alignItems:"center"},s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement("div",null,s.a.createElement($e.a,{contextId:o,eventId:d,fieldFormat:t.format,fieldName:t.field,fieldType:t.type,isDraggable:c,isObjectArray:t.isObjectArray,value:l,truncate:!1}),r&&s.a.createElement(Ve,null," ",te," ",r))),s.a.createElement(i.EuiFlexItem,null,l&&!u&&s.a.createElement(U.a,{data:t,contextId:o,eventId:d,fieldFromBrowserField:e,scopeId:o,values:[l],applyWidthAndPadding:!1})))},Ge=({browserFields:e,data:t,enrichments:a,scopeId:r,eventId:o,isDraggable:l,isReadOnly:c})=>{const u=a.map(((a,i)=>{var r,s,o,l;const{field:c,type:u,feedName:d,value:p}=Be(a),m=t.find((e=>e.field===c)),g=null!==(r=null==m?void 0:m.category)&&void 0!==r?r:"",b=Object(n.get)([g,"fields",null!=c?c:""],e);return{fieldsData:{field:null!=c?c:"",format:null!==(s=null==b?void 0:b.format)&&void 0!==s?s:"",type:null!==(o=null==b?void 0:b.type)&&void 0!==o?o:"",isObjectArray:null!==(l=null==m?void 0:m.isObjectArray)&&void 0!==l&&l},type:u,feedName:d,index:i,field:c,browserField:b,value:p}})),[d,p]=Object(g.partition)(u,(({type:e})=>Re(e)));return s.a.createElement(s.a.Fragment,null,p.length>0&&s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiPanel,{hasBorder:!0,paddingSize:"s",grow:!1},s.a.createElement(et,{title:ae,toolTipContent:ie}),p.map((({fieldsData:e,index:t,field:a,feedName:n,browserField:i,value:u})=>s.a.createElement(Ze,{key:a,field:a,value:s.a.createElement(He,{eventId:o,index:t,feedName:n,scopeId:r,value:u,data:e,browserField:i,isDraggable:l,isReadOnly:c})}))))),d.length>0&&s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiPanel,{hasBorder:!0,paddingSize:"s",grow:!1},s.a.createElement(et,{title:ne,toolTipContent:se}),d.map((({fieldsData:e,index:t,field:a,feedName:n,browserField:i,value:u})=>s.a.createElement(Ze,{key:a,field:a,value:s.a.createElement(He,{eventId:o,index:t,feedName:n,scopeId:r,value:u,data:e,browserField:i,isDraggable:l,isReadOnly:c})}))))))},Qe=s.a.memo(Ge),We=l()(i.EuiTitle).withConfig({displayName:"UppercaseEuiTitle",componentId:"sc-1l7nex2-0"})(["text-transform:uppercase;"]),Ke=({children:e})=>s.a.createElement(We,{size:"xxxs"},s.a.createElement("h5",null,e)),Ye=l()(i.EuiTitle).withConfig({displayName:"StyledEnrichmentFieldTitle",componentId:"sc-1l7nex2-1"})(["width:220px;"]),Je=({title:e})=>s.a.createElement(Ye,{size:"xxxs"},s.a.createElement("h6",null,e)),Xe=l()(i.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-1l7nex2-2"})(["font-size:",";margin-top:",";"],(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.euiSizeS)),Ze=({field:e,value:t})=>s.a.createElement(Xe,{direction:"row",gutterSize:"none",responsive:!0,alignItems:"center","data-test-subj":"EnrichedDataRow"},s.a.createElement(i.EuiFlexItem,{style:{flexShrink:0},grow:!1},s.a.createElement(Je,{title:e})),s.a.createElement(i.EuiFlexItem,{className:"eui-textBreakWord"},t)),et=({title:e,toolTipContent:t})=>{const[a,n]=Object(r.useState)(!1),o=Object(r.useCallback)((()=>{n(!a)}),[a,n]),l=Object(r.useCallback)((()=>{n(!1)}),[n]);return s.a.createElement(i.EuiFlexGroup,{direction:"row",gutterSize:"none",alignItems:"center"},s.a.createElement(i.EuiFlexItem,null,s.a.createElement(Ke,null,e)),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiPopover,{isOpen:a,closePopover:l,anchorPosition:"leftCenter",button:s.a.createElement(i.EuiButtonIcon,{color:"text",size:"xs",iconSize:"m",iconType:"iInCircle","aria-label":re,onClick:o})},s.a.createElement(i.EuiPopoverTitle,null,e),s.a.createElement(i.EuiText,{size:"s",style:{width:"270px"}},t))))},tt=({browserFields:e,data:t,enrichments:a,eventId:n,scopeId:r,hostRisk:o,userRisk:l,isDraggable:c,isReadOnly:u})=>{var d,p,m,g;const b=null==t||null===(d=t.find((e=>"host.risk.calculated_level"===(null==e?void 0:e.field))))||void 0===d||null===(p=d.values)||void 0===p?void 0:p[0],f=null==t||null===(m=t.find((e=>"user.risk.calculated_level"===(null==e?void 0:e.field))))||void 0===m||null===(g=m.values)||void 0===g?void 0:g[0];return s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiHorizontalRule,null),s.a.createElement(i.EuiTitle,{size:"xxxs"},s.a.createElement("h5",null,me)),s.a.createElement(i.EuiSpacer,{size:"m"}),s.a.createElement(i.EuiFlexGroup,{direction:"column",gutterSize:"m",style:{flexGrow:0}},s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(Se,{riskEntity:he.v.host,risk:o,originalRisk:b})),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(Se,{riskEntity:he.v.user,risk:l,originalRisk:f})),s.a.createElement(Qe,{browserFields:e,data:t,enrichments:a,scopeId:r,eventId:n,isDraggable:c,isReadOnly:u})))},at=s.a.memo(tt),nt=e=>Re(e)?ne:ae,it=e=>Re(e)?se:ie,rt=({type:e})=>s.a.createElement(i.EuiToolTip,{title:nt(e),content:it(e)},s.a.createElement(i.EuiIcon,{type:"iInCircle",size:"m"})),st=l.a.div.withConfig({displayName:"OverflowParent",componentId:"sc-1m2w4qg-0"})(["display:inline-grid;"]),ot=l.a.div.withConfig({displayName:"OverflowContainer",componentId:"sc-1m2w4qg-1"})(["white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-weight:bold;"]),lt=({field:e="",feedName:t="",value:a=""})=>{const n=`${e} ${a}${t?` ${te} ${t}`:""}`;return s.a.createElement(i.EuiToolTip,{content:a},s.a.createElement(st,{"data-test-subj":"enrichment-button-content"},s.a.createElement(ot,null,n)))},ct=l.a.h5.withConfig({displayName:"StyledH5",componentId:"sc-tbqfly-0"})(["line-height:1.7rem;"]),ut=e=>s.a.createElement(i.EuiTitle,{size:"xxxs"},s.a.createElement(ct,null,e));ut.displayName="ThreatSummaryTitle";var dt=a(124),pt=a(129),mt=a(15),gt=a(42);const bt=Object(pt.d)((e=>(({data:e,defaultIndex:t,eventFields:a,filterQuery:n,timerange:i,signal:r})=>e.search.search({defaultIndex:t,eventFields:a,factoryQueryType:_e.a.eventEnrichment,filterQuery:n,timerange:i},{strategy:"securitySolutionSearchStrategy",abortSignal:r}))(e).pipe(Object(mt.filter)((e=>Object(gt.isErrorResponse)(e)||Object(gt.isCompleteResponse)(e))))));var ft=a(268),yt=a.n(ft),ht=a(90),Et=a(84),vt=a(184);const xt=$.i18n.translate("xpack.securitySolution.investigationEnrichment.requestError",{defaultMessage:"An error occurred while requesting threat intelligence"}),kt="investigation_time_enrichment",St=()=>{},jt={enrichments:[]},Ot=l()(i.EuiInMemoryTable).withConfig({displayName:"ThreatSummaryTable",componentId:"sc-10n0cst-0"})([".euiTableHeaderCell,.euiTableRowCell{border:none;}.euiTableHeaderCell .euiTableCellContent{padding:0;}"]),wt=l()(i.EuiAccordion).withConfig({displayName:"StyledEuiAccordion",componentId:"sc-2hwa3a-0"})([".euiAccordion__triggerWrapper{background:",";border-radius:",";height:",";margin-bottom:",";padding-left:",";}"],(({theme:e})=>e.eui.euiColorLightestShade),(({theme:e})=>e.eui.euiSizeXS),(({theme:e})=>e.eui.euiSizeXL),(({theme:e})=>e.eui.euiSizeS),(({theme:e})=>e.eui.euiSizeS)),Tt=[{field:"title",truncateText:!1,render:ut,width:"220px",name:""},{field:"description",truncateText:!1,render:({fieldName:e,value:t})=>{const a=e.match(Ae.p)?s.a.createElement(i.EuiLink,{href:t,target:"_blank"},t):s.a.createElement("span",null,t);return s.a.createElement(i.EuiToolTip,{"data-test-subj":"message-tool-tip",content:s.a.createElement(i.EuiFlexGroup,{direction:"column",gutterSize:"none"},s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement("span",null,e)))},a)},name:""}],It=e=>Object.keys(e).sort().map((t=>({title:t.startsWith(Ie.T)?t.replace(`${Ie.T}`,"indicator"):t,description:{fieldName:t,value:Ne(e[t])}}))),Ct=({enrichment:e,index:t})=>{const{id:a="threat-details-item",field:n,feedName:r,type:o,value:l}=Be(e),c=`${a}${n}`;return s.a.createElement(wt,{id:c,key:c,initialIsOpen:!0,arrowDisplay:"right",buttonContent:s.a.createElement(lt,{field:n,feedName:r,value:l}),extraAction:Re(o)&&s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(dt.b,{queryId:kt,title:ce}))},s.a.createElement(Ot,{columns:Tt,compressed:!0,"data-test-subj":`threat-details-view-${t}`,items:It(e)}))},Mt=({enrichments:e})=>s.a.createElement(s.a.Fragment,null,e.sort(((e,t)=>ze(t)-ze(e))).map(((t,a)=>s.a.createElement(s.a.Fragment,{key:`${t.id}`},s.a.createElement(Ct,{enrichment:t,index:a}),a<e.length-1&&s.a.createElement(i.EuiSpacer,{size:"m"}))))),Ft=l.a.div.withConfig({displayName:"InlineBlock",componentId:"sc-1tu9mdx-0"})(["display:inline-block;line-height:1.7em;"]),Dt=({type:e})=>e?s.a.createElement(Ft,{"data-test-subj":"no-enrichments-found"},e===Ae.c.IndicatorMatchRule?le:oe):null,At=({type:e})=>e?s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiFlexGroup,{direction:"row",gutterSize:"xs",alignItems:"baseline"},s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiTitle,{size:"xxxs"},s.a.createElement("h5",null,e===Ae.c.IndicatorMatchRule?ae:ne))),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(rt,{type:e}))),s.a.createElement(i.EuiSpacer,{size:"s"})):null,_t=({enrichments:e,type:t,loading:a,dataTestSubj:n,children:r})=>s.a.createElement("div",{"data-test-subj":n},s.a.createElement(At,{type:t}),r,Array.isArray(e)?s.a.createElement(Mt,{enrichments:e}):s.a.createElement(s.a.Fragment,null,s.a.createElement(Dt,{type:t}),a&&s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiSpacer,{size:"m"}),s.a.createElement(i.EuiLoadingContent,{"data-test-subj":"loading-enrichments",lines:4})))),Nt=({enrichments:e,showInvestigationTimeEnrichments:t,loading:a,children:n})=>{const{[Ae.c.IndicatorMatchRule]:r,[Ae.c.InvestigationTime]:o,undefined:l}=Object(g.groupBy)(e,"matched.type");return s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiSpacer,{size:"m"}),s.a.createElement(_t,{dataTestSubj:"threat-match-detected",enrichments:r,type:Ae.c.IndicatorMatchRule}),t&&s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiHorizontalRule,null),s.a.createElement(_t,{dataTestSubj:"enriched-with-threat-intel",enrichments:o,type:Ae.c.InvestigationTime,loading:a},n)),l&&s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiHorizontalRule,null),r&&s.a.createElement(i.EuiSpacer,{size:"l"}),s.a.createElement(_t,{enrichments:l,dataTestSubj:"matches-with-no-type"})))},Rt=s.a.memo(Nt),Pt=l()(i.EuiInMemoryTable).withConfig({displayName:"SummaryTable",componentId:"sc-tjbhe3-0"})([".timelines__hoverActionButton{opacity:0;}.flyoutTableHoverActions{.hoverActions-active{.timelines__hoverActionButton,.securitySolution__hoverActionButton{opacity:1;}}&:hover{.timelines__hoverActionButton,.securitySolution__hoverActionButton{opacity:1;}}}"]);var Lt=a(873),Bt=a(104),qt=a(301),zt=a(256),$t=a(114),Vt=a(186),Ut=a(185),Ht=a(98);const Gt="countOfAlertsWithSameFieldAndValue",Qt=({field:e,value:t,isActiveTimelines:a,signalIndexName:n,includeAlertIds:i=!1,ignoreTimerange:s=!1})=>{const o=Object(G.a)((e=>Ht.d.timelineTimeRangeSelector(e))),l=Object($t.a)(!1);let c,u;!1===s&&({to:c,from:u}=a?o:l);const[d]=Object(r.useState)((()=>Wt(e,t,u,c,i))),{loading:p,data:m,setQuery:g}=Object(Vt.a)({query:d,indexName:n,queryName:Ut.a.PREVALENCE});let b;if(Object(r.useEffect)((()=>{g(Wt(e,t,u,c,i))}),[g,e,t,u,c,i]),m){var f,y;const e=null===(f=m.aggregations)||void 0===f||null===(y=f[Gt])||void 0===y?void 0:y.buckets;e&&e.length>0&&(b=null==e?void 0:e.reduce(((e,t)=>{var a;return e+(null!==(a=null==t?void 0:t.doc_count)&&void 0!==a?a:0)}),0))}return{loading:p,count:b,error:!p&&void 0===b,alertIds:null==m?void 0:m.hits.hits.map((({_id:e})=>e))}},Wt=(e,t,a,n,i)=>{const r=i?{size:Ie.Y}:{size:0},s=i?{sort:{"@timestamp":"desc"}}:{},o=Array.isArray(t)&&1===t.length?t[0]:t;let l;return l={bool:{must:{match:{[e]:o}}}},void 0!==a&&void 0!==n&&(l={...l,bool:{...l.bool,filter:[{range:{"@timestamp":{gte:a,lte:n}}}]}}),Array.isArray(t)&&t.length>1&&(l={bool:{minimum_should_match:1,should:t.map((t=>({match:{[e]:t}})))}},void 0!==a&&void 0!==n&&(l={...l,bool:{...l.bool,must:[{range:{"@timestamp":{gte:a,lte:n}}}]}})),{...r,...s,_source:!1,aggs:{[Gt]:{terms:{field:e,size:Ie.Y}}},query:l,runtime_mappings:{}}},Kt=({data:e,eventId:t,fieldFromBrowserField:a,linkValue:n,scopeId:r,values:o})=>{const{loading:l,count:c}=Qt({field:e.field,isActiveTimelines:r===Bt.d.active,value:o,signalIndexName:null}),u=Object(zt.b)({contextId:r,eventId:t,field:e.field,fieldFormat:e.format,fieldFromBrowserField:a,fieldType:e.type,isObjectArray:e.isObjectArray,linkValue:n,values:o});return l?s.a.createElement(i.EuiLoadingSpinner,null):"number"==typeof c&&null!=u&&u.dataProviders&&null!=u&&u.dataProviders.length?s.a.createElement(qt.a,{asEmptyButton:!0,dataProviders:u.dataProviders},s.a.createElement("span",{"data-test-subj":"alert-prevalence"},c)):Object(Ee.d)()};Kt.displayName="PrevalenceCell";const Yt=[{field:"title",truncateText:!1,name:j.h,textOnly:!0},{field:"description",truncateText:!1,render:Lt.a,name:j.i}],Jt=[...Yt,{field:"description",truncateText:!0,render:e=>s.a.createElement(Kt,e),name:s.a.createElement(s.a.Fragment,null,j.f," ",s.a.createElement(i.EuiIconTip,{type:"iInCircle",color:"subdued",title:j.f,content:s.a.createElement("span",null,j.g)})),align:"right",width:"130px"}],Xt={className:"flyoutTableHoverActions"},Zt=({goToTable:e,rows:t,title:a,isReadOnly:n})=>{const r=n?Yt:Jt;return s.a.createElement("div",null,s.a.createElement(i.EuiFlexGroup,null,s.a.createElement(i.EuiFlexItem,null,s.a.createElement(i.EuiTitle,{size:"xxxs"},s.a.createElement("h5",null,a))),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiLink,{onClick:e},s.a.createElement(i.EuiText,{size:"xs"},j.v)))),s.a.createElement(i.EuiSpacer,{size:"s"}),s.a.createElement(Pt,{"data-test-subj":"summary-view",items:t,columns:r,rowProps:Xt,compressed:!0}))},ea=s.a.memo(Zt);var ta=a(118),aa=a(471),na=a(176),ia=a(289);let ra,sa;!function(e){e.MALICIOUS_FILE="malicious_file",e.RANSOMWARE="ransomware",e.MEMORY_SIGNATURE="memory_signature",e.SHELLCODE_THREAD="shellcode_thread",e.BEHAVIOR="behavior"}(ra||(ra={})),function(e){e.PROCESS="process",e.FILE="file",e.NETWORK="network",e.REGISTRY="registry",e.MALWARE="malware"}(sa||(sa={}));const oa=`${aa.h}.terms.field`,la=`${aa.h}.terms.value`,ca=`${aa.h}.cardinality.field`,ua=`${aa.h}.cardinality.value`,da=`${aa.h}.count`,pa=[{id:"host.name"},{id:"agent.id",overrideField:na.a,label:j.b},{id:"user.name"},{id:"rule.name"},{id:Oe.H,label:j.r}];function ma({primaryEventCategory:e,allEventCategories:t}){switch(e){case sa.PROCESS:return[{id:"process.name"},{id:"process.parent.name"},{id:"process.args"}];case sa.FILE:return[{id:"file.name"},{id:"file.hash.sha256"},{id:"file.directory"},{id:"process.name"}];case sa.NETWORK:return[{id:"destination.address"},{id:"destination.port"},{id:"source.address"},{id:"source.port"},{id:"dns.question.name"},{id:"process.name"}];case sa.REGISTRY:return[{id:"registry.key"},{id:"registry.value"},{id:"process.name"}];case sa.MALWARE:return ma({primaryEventCategory:sa.FILE,allEventCategories:t});default:let e=[];return null!=t&&t.includes(sa.FILE)&&(e=e.concat(ma({primaryEventCategory:sa.FILE}))),null!=t&&t.includes(sa.PROCESS)&&(e=e.concat(ma({primaryEventCategory:sa.PROCESS}))),e}}function ga(e,t){switch(e){case ra.BEHAVIOR:return[{id:"rule.description",label:ta.q},...ma({...t,primaryEventCategory:void 0})];case ra.SHELLCODE_THREAD:return[{id:"Target.process.executable"},{id:"Memory_protection.unique_key_v1"}];case ra.RANSOMWARE:return[{id:"Ransomware.feature"},{id:"process.hash.sha256"},...ma({...t,primaryEventCategory:void 0})];case ra.MEMORY_SIGNATURE:return ma({...t,primaryEventCategory:void 0});default:return[]}}function ba(e){switch(e){case"threshold":return[{id:da,label:ta.t},{id:oa,overrideField:la,label:ta.u},{id:ca,label:ta.s}];case"machine_learning":return[{id:`${Oe.A}.machine_learning_job_id`,legacyId:"signal.rule.machine_learning_job_id"},{id:`${Oe.A}.anomaly_threshold`,legacyId:"signal.rule.anomaly_threshold"}];case"threat_match":return[{id:`${Oe.A}.threat_index`,legacyId:"signal.rule.threat_index"},{id:`${Oe.A}.threat_query`,legacyId:"signal.rule.threat_query"}];case"new_terms":return[{id:aa.c,label:ta.m},{id:aa.b,label:ta.l}];default:return[]}}const fa=({browserFields:e,data:t,eventId:a,isDraggable:i,scopeId:o,title:l,goToTable:c,isReadOnly:u})=>{const d=Object(r.useMemo)((()=>(({data:e,browserFields:t,scopeId:a,eventId:i,isDraggable:r=!1,isReadOnly:s=!1})=>{var o,l;const c=function(e){const t=Object(n.find)({category:"event",field:"event.category"},e);let a,i;return Array.isArray(null==t?void 0:t.originalValue)?(a=null==t?void 0:t.originalValue[0],i=null==t?void 0:t.originalValue):(a=null==t?void 0:t.originalValue,a&&(i=[a])),{primaryEventCategory:a,allEventCategories:i}}(e),u=Object(n.find)({category:"event",field:"event.code"},e),d=Array.isArray(null==u?void 0:u.originalValue)?null==u||null===(o=u.originalValue)||void 0===o?void 0:o[0]:null==u?void 0:u.originalValue,p=Object(n.find)({category:"kibana",field:Oe.H},e),m=function({eventCategories:e,eventCode:t,eventRuleType:a}){const i=[...pa,...ma(e),...ga(t,e),...ba(a)];return Object(n.uniqBy)("id",i)}({eventCategories:c,eventCode:d,eventRuleType:Array.isArray(null==p?void 0:p.originalValue)?null==p||null===(l=p.originalValue)||void 0===l?void 0:l[0]:null==p?void 0:p.originalValue});return null!=e?m.reduce(((o,l)=>{var c;const u=e.find((e=>e.field===l.id||l.legacyId&&e.field===l.legacyId));if(!u||Object(n.isEmpty)(u.values))return o;u.field===l.legacyId&&(l.id=l.legacyId);const d=null!=l.linkField&&e.find((e=>e.field===l.linkField)),p={...Object(z.b)({item:u,linkValueField:d||void 0,contextId:a,scopeId:a,browserFields:t,eventId:i,field:l}),isDraggable:r,isReadOnly:s};if("agent.id"===l.id&&!Object(ia.b)({data:e}))return o;if(l.id===oa){const t=function({values:e},t,a){const n=t.find((e=>e.field===la)),i=n&&n.values;if(Array.isArray(e)&&e.length>0&&Array.isArray(i)&&e.length===i.length)return e.map(((e,t)=>({title:e,description:{...a,values:[i[t]]}}))).filter((e=>!pa.map((e=>e.id)).includes(e.title)))}(u,e,p);return t?[...o,...t]:o}if(l.id===ca){const t=function({values:e},t,a){const n=t.find((e=>e.field===ua)),i=n&&n.values;if(Array.isArray(e)&&1===e.length&&Array.isArray(i)&&e.length===i.length)return{title:ta.s,description:{...a,values:[`count(${e[0]}) >= ${i[0]}`]}}}(u,e,p);return t?[...o,t]:o}return[...o,{title:null!==(c=l.label)&&void 0!==c?c:l.id,description:p}]}),[]):[]})({browserFields:e,data:t,eventId:a,isDraggable:i,scopeId:o,isReadOnly:u})),[e,t,a,i,o,u]);return s.a.createElement(ea,{rows:d,title:l,goToTable:c,isReadOnly:u})},ya=s.a.memo(fa);var ha=a(43),Ea=a.n(ha);const va=({range:e,setRange:t,loading:a})=>{const[n,o]=Object(r.useState)(e.from===Ae.a?Ea()().subtract(30,"d"):Ea()(e.from)),[l,c]=Object(r.useState)(e.to===Ae.b?Ea()():Ea()(e.to)),u=Object(r.useCallback)((()=>{n&&l&&n.isBefore(l)&&t({from:n.toISOString(),to:l.toISOString()})}),[l,t,n]),d=Object(r.useMemo)((()=>null==n?void 0:n.isBefore(l)),[n,l]);return s.a.createElement(i.EuiFlexGroup,null,s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiDatePickerRange,{"data-test-subj":"enrichment-query-range-picker",startDateControl:s.a.createElement(i.EuiDatePicker,{className:"start-picker",selected:n,onChange:o,startDate:n,endDate:l,isInvalid:!d,"aria-label":ue,showTimeSelect:!0}),endDateControl:s.a.createElement(i.EuiDatePicker,{className:"end-picker",selected:l,onChange:c,startDate:n,endDate:l,isInvalid:!d,"aria-label":de,showTimeSelect:!0})})),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiButton,{iconType:"refresh",onClick:u,isLoading:a,"data-test-subj":"enrichment-button",isDisabled:!d},pe)))};var xa=a(509),ka=a(51);const Sa=ka.euiStyled.div`
  width: 0;
  transform: translate(6px);
  transition: transform 50ms ease-in-out;
  margin-left: ${({theme:e})=>e.eui.euiSizeS};
`,ja=Object(ka.euiStyled)(i.EuiPanel)`
  &&& {
    background-color: ${({theme:e})=>e.eui.euiColorLightestShade};
    padding: ${({theme:e})=>e.eui.euiSizeS};
    height: 78px;
  }

  & {
    .hoverActions-active {
      .timelines__hoverActionButton,
      .securitySolution__hoverActionButton {
        opacity: 1;
      }
    }

    &:hover {
      .timelines__hoverActionButton,
      .securitySolution__hoverActionButton {
        opacity: 1;
      }

      ${Sa} {
        width: auto;
        transform: translate(0);
      }
    }

    ${e=>e.$isPopoverVisible&&`\n      & ${Sa} {\n        width: auto;\n        transform: translate(0);\n      }\n    `}
  }
`,Oa=({title:e,children:t,isPopoverVisible:a=!1})=>s.a.createElement(ja,{borderRadius:"none",hasShadow:!1,hasBorder:!1,paddingSize:"s",$isPopoverVisible:a},s.a.createElement(i.EuiText,{size:"s"},e),s.a.createElement(i.EuiSpacer,{size:"s"}),t);Oa.displayName="OverviewCard";const wa=ka.euiStyled.div`
  /* Clamp text content to 2 lines */
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
`;wa.displayName="ClampedContent";const Ta=({title:e,children:t,contextId:a,dataTestSubj:n,enrichedFieldInfo:o})=>{const[l,c]=Object(r.useState)(!1);return s.a.createElement(Oa,{title:e,isPopoverVisible:l},s.a.createElement(i.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},s.a.createElement(wa,{"data-test-subj":n},t),s.a.createElement(Sa,null,s.a.createElement(U.a,m()({},o,{contextId:a,setIsPopoverVisible:c,applyWidthAndPadding:!1})))))};Ta.displayName="OverviewCardWithActions";var Ia=a(472);const Ca=s.a.memo((({eventId:e,contextId:t,enrichedFieldInfo:a,indexName:n,scopeId:o,handleOnEventClosed:l})=>{const[c,u]=Object(r.useState)(!1),d=Object(r.useCallback)((()=>u(!c)),[c]),p=Object(r.useCallback)((()=>u(!1)),[]),m=Object(r.useCallback)((()=>{p(),l()}),[p,l]),{actionItems:g}=Object(Ia.a)({closePopover:m,eventId:e,scopeId:o,indexName:n,alertStatus:a.values[0]}),b=Object(r.useMemo)((()=>g.length>0),[g]),f=Object(r.useMemo)((()=>s.a.createElement($e.a,{contextId:t,eventId:e,value:a.values[0],fieldName:a.data.field,linkValue:a.linkValue,fieldType:a.data.type,fieldFormat:a.data.format,isDraggable:!1,truncate:!1,isButton:b,onClick:b?d:void 0,onClickAriaLabel:ta.w})),[t,e,a,d,b]);return b?s.a.createElement(i.EuiPopover,{button:f,isOpen:c,closePopover:p,panelPaddingSize:"none","data-test-subj":"alertStatus"},s.a.createElement(i.EuiPopoverTitle,{paddingSize:"m"},ta.v),s.a.createElement(i.EuiContextMenuPanel,{items:g})):f}));Ca.displayName="StatusPopoverButton";var Ma=a(390),Fa=a(198),Da=a(936);const Aa=Object(ka.euiStyled)(i.EuiFlexGroup)`
  flex-grow: 0;
`,_a=s.a.memo((({browserFields:e,contextId:t,data:a,eventId:o,handleOnEventClosed:l,indexName:c,scopeId:u,isReadOnly:d})=>{const p=Object(r.useMemo)((()=>{const i=Object(n.find)({field:na.m,category:"kibana"},a);return i&&Object(z.b)({eventId:o,contextId:t,scopeId:u,browserFields:e,item:i})}),[e,t,a,o,u]),m=Object(r.useMemo)((()=>{const i=Object(n.find)({field:"kibana.alert.severity",category:"kibana"},a);return i&&Object(z.b)({eventId:o,contextId:t,scopeId:u,browserFields:e,item:i})}),[e,t,a,o,u]),g=Object(r.useMemo)((()=>{const i=Object(n.find)({field:"kibana.alert.risk_score",category:"kibana"},a);return i&&Object(z.b)({eventId:o,contextId:t,scopeId:u,browserFields:e,item:i})}),[e,t,a,o,u]),b=Object(r.useMemo)((()=>{const i=Object(n.find)({field:na.l,category:"kibana"},a),r=Object(n.find)({field:"kibana.alert.rule.uuid",category:"kibana"},a);return i&&Object(z.b)({eventId:o,contextId:t,scopeId:u,browserFields:e,item:i,linkValueField:r})}),[e,t,a,o,u]),f=Na(p)&&!d?s.a.createElement(i.EuiFlexItem,{key:"status"},s.a.createElement(Ta,{title:ta.C,enrichedFieldInfo:p,contextId:t},s.a.createElement(Ca,{eventId:o,contextId:t,enrichedFieldInfo:p,indexName:c,scopeId:u,handleOnEventClosed:l}))):null,y=Na(m)?s.a.createElement(i.EuiFlexItem,{key:"severity"},d?s.a.createElement(Oa,{title:ta.r},s.a.createElement(Ma.a,{value:m.values[0]})):s.a.createElement(Ta,{title:ta.r,enrichedFieldInfo:m,contextId:t},s.a.createElement(Ma.a,{value:m.values[0]}))):null,h=Na(g)?s.a.createElement(i.EuiFlexItem,{key:"riskScore"},d?s.a.createElement(Oa,{title:ta.o},g.values[0]):s.a.createElement(Ta,{title:ta.o,enrichedFieldInfo:g,contextId:t,dataTestSubj:"riskScore"},g.values[0])):null,E=Na(b)&&!d?s.a.createElement(i.EuiFlexItem,{key:"ruleName"},s.a.createElement(Ta,{title:ta.p,enrichedFieldInfo:b,contextId:t},s.a.createElement($e.a,{contextId:t,eventId:o,value:b.values[0],fieldName:b.data.field,linkValue:b.linkValue,fieldType:b.data.type,fieldFormat:b.data.format,isDraggable:!1,truncate:!1}))):null,{width:v,ref:x}=Object(Fa.b)(),k=0===v||v>=675,S=[f,y,h,E].filter(Da.h),j=k?s.a.createElement(Aa,{gutterSize:"s"},S):s.a.createElement(s.a.Fragment,null,Object(n.chunk)(2,S).map(((e,t,{length:a})=>{const n=t<a-1;return s.a.createElement(s.a.Fragment,null,s.a.createElement(Aa,{gutterSize:"s"},e),n&&s.a.createElement(i.EuiSpacer,{size:"s"}))})));return s.a.createElement("div",{ref:x},j)}));function Na(e){return!!e&&Array.isArray(e.values)}_a.displayName="Overview";var Ra=a(214);function Pa(e){return Boolean(e&&e.values&&e.values.length)}var La=a(13),Ba=a(39),qa=a(630);const za=Object(ka.euiStyled)(i.EuiAccordion)`
  border: 1px solid ${({theme:e})=>e.eui.euiColorLightShade};
  padding: 10px 8px;
  border-radius: 6px;
`,$a=s.a.memo((({prefix:e,state:t,text:a,renderContent:r,onToggle:o=n.noop,extraAction:l,forceState:c})=>{const u=Object(i.useGeneratedHtmlId)({prefix:e});switch(t){case"loading":return s.a.createElement(za,{id:u,buttonContent:a,onToggle:o,isLoading:!0});case"error":return s.a.createElement(za,{id:u,buttonContent:s.a.createElement("span",null,s.a.createElement(i.EuiIcon,{type:"alert",color:"danger",style:{marginRight:"6px"}}),a),onToggle:o,extraAction:l});case"success":return s.a.createElement(za,{"tour-step":`${e}-accordion`,"data-test-subj":`${e}-accordion`,id:u,buttonContent:a,onToggle:o,paddingSize:"l",extraAction:l,forceState:c},r());default:return null}}));$a.displayName="InsightAccordion";var Va=a(101);const Ua=(e,t)=>({fields:t,_source:!1,query:{ids:{values:e}}}),Ha=["@timestamp","kibana.alert.rule.name","kibana.alert.severity"],Ga=[{field:"kibana.alert.rule.name",name:"Rule"},{field:"@timestamp",name:"@timestamp",render:e=>s.a.createElement(Va.c,{value:new Date(e)})},{field:"kibana.alert.severity",name:"Severity",render:e=>s.a.createElement(Ma.a,{value:e})}],Qa=s.a.memo((({alertIds:e})=>{const t=Object(r.useMemo)((()=>e.slice(0,10)),[e]),{loading:a,error:n,data:o}=(({alertIds:e,fields:t=["*"]})=>{const[a]=Object(r.useState)((()=>Ua(e,t))),{loading:n,data:i,setQuery:s}=Object(Vt.a)({query:a,queryName:Ut.a.BY_ID});return Object(r.useEffect)((()=>{s(Ua(e,t))}),[s,e,t]),{loading:n,error:!n&&void 0===i,data:null==i?void 0:i.hits.hits}})({alertIds:t,fields:Ha}),l=Object(r.useMemo)((()=>{if(o)return o.map((e=>e.fields))}),[o]);if(a)return s.a.createElement(i.EuiLoadingContent,{lines:2});if(n)return s.a.createElement(s.a.Fragment,null,Ra.p);if(l){const t=e.length>10;return s.a.createElement(s.a.Fragment,null,t&&s.a.createElement("div",null,s.a.createElement("em",null,Ra.q),s.a.createElement(i.EuiSpacer,null)),s.a.createElement(i.EuiBasicTable,{compressed:!0,items:l,columns:Ga}))}return null}));Qa.displayName="SimpleAlertTable";var Wa=a(14);const Ka=s.a.memo((({data:e,originalDocumentId:t,index:a,eventId:n,scopeId:o})=>{const[l,c]=Object(r.useState)(!1),[u,d]=Object(r.useState)({}),p=Object(r.useCallback)((e=>c(e)),[]),m=Object(r.useCallback)((()=>l?u.alertIds?s.a.createElement(Ja,{eventId:n,scopeId:o,alertIds:u.alertIds}):s.a.createElement(Ya,{data:e,index:a,originalDocumentId:t,eventId:n,isActiveTimelines:Object(C.isActiveTimeline)(null!=o?o:""),onCacheLoad:d}):null),[l,u.alertIds,e,a,t,n,o]),g=Object(r.useMemo)((()=>s.a.createElement(i.EuiBetaBadge,{size:"s",label:Wa.a,color:"subdued"})),[]);return s.a.createElement($a,{prefix:"RelatedAlertsByProcessAncestry",state:"success",text:u.alertIds?Object(Ra.h)(u.alertIds.length):Ra.g,renderContent:m,onToggle:p,extraAction:g})}));Ka.displayName="RelatedAlertsByProcessAncestry";const Ya=({data:e,originalDocumentId:t,index:a,isActiveTimelines:n,onCacheLoad:o,eventId:l})=>{const{values:c}=e,{values:u}=a,{values:d}=t,p=Array.isArray(d)?d[0]:"",m=Array.isArray(c)?c[0]:"",{loading:g,error:b,alertIds:f}=function({processEntityId:e,documentId:t,isActiveTimeline:a,indices:n}){const i=Object(S.j)(),{selectedPatterns:r}=Object(qa.a)(a),s=[...new Set(r.concat(n))],{loading:o,id:l,schema:c}=function({documentId:e,indices:t}){const a=Object(S.j)(),n=Object(Ba.useQuery)(["getAlertPrevalenceSchema",e],(()=>a.get("/api/endpoint/resolver/entity",{query:{_id:e,indices:t}})));if(n.isLoading)return{loading:!0,error:!1,id:null,schema:null};if(n.data&&n.data.length>0){const{data:[{schema:e,id:t}]}=n;return{loading:!1,error:!1,id:t,schema:e}}return{loading:!1,error:!0,id:null,schema:null}}({documentId:t,indices:s}),u=Object(Ba.useQuery)(["getAlertPrevalenceFromProcessTree",l],(()=>i.post("/api/endpoint/resolver/tree",{body:JSON.stringify({schema:c,ancestors:200,descendants:500,indexPatterns:s,nodes:[l],includeHits:!0})})),{enabled:null!==c&&null!==l});return u.isLoading||o?{loading:!0,error:!1,alertIds:void 0}:u.data?{loading:!1,error:!1,alertIds:u.data.alertIds}:{loading:!1,error:!0,alertIds:void 0}}({processEntityId:m,isActiveTimeline:n,documentId:p,indices:null!=u?u:[]});return Object(r.useEffect)((()=>{f&&0!==f.length&&o({alertIds:f})}),[f,o]),g?s.a.createElement(i.EuiLoadingSpinner,null):b?s.a.createElement(s.a.Fragment,null,Ra.j):f&&0!==f.length?null:s.a.createElement(s.a.Fragment,null,Ra.i)};Ya.displayName="FetchAndNotifyCachedAlertsByProcessAncestry";const Ja=({alertIds:e,eventId:t,scopeId:a})=>{const n=e&&e.length&&e.length>=5,o=Object(r.useMemo)((()=>e&&e.length?n?null:e.reduce(((e,n,i)=>{const r=`${a}-${t}-event.id-${i}-${n}`;return e.push(Object(zt.a)("_id",r,n)),e}),[]):null),[e,n,a,t]),l=Object(r.useMemo)((()=>n?[{meta:{alias:Ra.k,type:"phrases",key:"_id",params:[...e],negate:!1,disabled:!1,value:e.join()},query:{bool:{should:e.map((e=>({match_phrase:{_id:e}}))),minimum_should_match:1}}}]:null),[e,n]);return o||l?s.a.createElement(s.a.Fragment,null,s.a.createElement(Qa,{alertIds:e}),s.a.createElement(i.EuiSpacer,null),s.a.createElement(qt.a,{asEmptyButton:!1,dataProviders:o,filters:l,"data-test-subj":"investigate-ancestry-in-timeline"},ta.f)):null};Ja.displayName="ActualRelatedAlertsByProcessAncestry";var Xa=a(403);const Za=s.a.memo((({eventId:e})=>{const{services:{cases:t}}=Object(S.k)(),a=Object(S.o)(),[n,i]=Object(r.useState)(void 0),[o,l]=Object(r.useState)(!1),{activeStep:c,isTourShown:u}=Object(Xa.b)(),p=Object(r.useMemo)((()=>c===h.a.viewCase&&u(h.b.alertsCases)),[c,u]),m=Object(r.useCallback)((()=>function(e=[]){const t=e.length;return s.a.createElement("span",null,s.a.createElement(E.FormattedMessage,{defaultMessage:"This alert was found in {caseCount}",id:"xpack.securitySolution.alertDetails.overview.insights_related_cases_found_content",values:{caseCount:s.a.createElement("strong",null,s.a.createElement(E.FormattedMessage,{id:"xpack.securitySolution.alertDetails.overview.insights_related_cases_found_content_count",defaultMessage:"{caseCount} {caseCount, plural, =0 {cases.} =1 {case:} other {cases:}}",values:{caseCount:t}}))}}),e.map((({id:t,title:a},n)=>t&&a?s.a.createElement("span",{key:t}," ",s.a.createElement(d.a,{detailName:t,title:a,index:n},a),e[n+1]?",":""):s.a.createElement(s.a.Fragment,null))))}(n)),[n]),[g,b]=Object(r.useState)(!1);Object(r.useEffect)((()=>{if(!g)return;let n=!1;return(async()=>{let r=[];try{var s;e&&(r=null!==(s=await t.api.getRelatedCases(e,{owner:Ie.p}))&&void 0!==s?s:[])}catch(e){n||l(!0),a.addWarning(Object(Ra.c)(e))}n||(i(r),b(!1))})(),()=>{n=!0}}),[t.api,e,g,a]),Object(r.useEffect)((()=>{b(!0)}),[e]);let f="loading";return o?f="error":n&&(f="success"),s.a.createElement($a,{prefix:"RelatedCases",state:f,text:en(f,null==n?void 0:n.length),renderContent:m,forceState:p?"open":void 0})}));function en(e,t=0){switch(e){case"loading":return Ra.d;case"error":return Ra.b;case"success":return Object(Ra.a)(t);default:return""}}Za.displayName="RelatedCases";const tn=s.a.memo((({browserFields:e,data:t,eventId:a,scopeId:n})=>{const{field:o,values:l}=t,{error:c,count:u,alertIds:d}=Qt({field:o,value:l,isActiveTimelines:Object(C.isActiveTimeline)(n),signalIndexName:null,includeAlertIds:!0}),{fieldFromBrowserField:p}=Object(z.b)({browserFields:e,contextId:n,eventId:a,field:{id:t.field},scopeId:n,item:t}),m=Object(zt.b)({field:o,values:l,contextId:n,eventId:a,fieldFromBrowserField:p,fieldFormat:null==p?void 0:p.format,fieldType:null==p?void 0:p.type}),g=0===u;let b="loading";c?b="error":d&&(b="success");const f=Object(r.useCallback)((()=>d&&null!=m&&m.dataProviders?g&&"loading"!==b?Ra.s:s.a.createElement(s.a.Fragment,null,s.a.createElement(Qa,{alertIds:d}),s.a.createElement(i.EuiSpacer,null),s.a.createElement(qt.a,{asEmptyButton:!1,dataProviders:null==m?void 0:m.dataProviders},ta.f)):null),[d,null==m?void 0:m.dataProviders,g,b]);return s.a.createElement($a,{prefix:"RelatedAlertsBySourceEvent",state:b,text:an(b,u),renderContent:f})}));function an(e,t){switch(e){case"loading":return Ra.u;case"error":return Ra.t;case"success":return Object(Ra.r)(t);default:return""}}tn.displayName="RelatedAlertsBySourceEvent";const nn=s.a.memo((({browserFields:e,data:t,eventId:a,scopeId:n})=>{const{field:o,values:l}=t,{error:c,count:u,alertIds:d}=Qt({field:o,value:l,isActiveTimelines:Object(C.isActiveTimeline)(n),signalIndexName:null,includeAlertIds:!0,ignoreTimerange:!0}),{fieldFromBrowserField:p}=Object(z.b)({browserFields:e,contextId:n,eventId:a,field:{id:t.field},scopeId:n,item:t}),m=Object(zt.b)({field:o,values:l,contextId:n,eventId:a,fieldFromBrowserField:p,fieldFormat:null==p?void 0:p.format,fieldType:null==p?void 0:p.type}),g=0===u;let b="loading";c?b="error":(d||g)&&(b="success");const f=Object(r.useCallback)((()=>d&&null!=m&&m.dataProviders?g&&"loading"!==b?Ra.m:s.a.createElement(s.a.Fragment,null,s.a.createElement(Qa,{alertIds:d}),s.a.createElement(i.EuiSpacer,null),s.a.createElement(qt.a,{asEmptyButton:!1,dataProviders:null==m?void 0:m.dataProviders},ta.f)):null),[d,null==m?void 0:m.dataProviders,g,b]);return s.a.createElement($a,{prefix:"RelatedAlertsBySession",state:b,text:rn(b,u),renderContent:f})}));function rn(e,t){switch(e){case"loading":return Ra.o;case"error":return Ra.n;case"success":return Object(Ra.l)(t);default:return""}}nn.displayName="RelatedAlertsBySession";const sn=ka.euiStyled.div`
  border: 1px solid ${({theme:e})=>e.eui.euiColorLightShade};
  padding: 12px;
  border-radius: 6px;
`,on=Object(ka.euiStyled)(i.EuiIcon)`
  margin-right: 10px;
`,ln=s.a.memo((()=>{const{getAppUrl:e,navigateTo:t}=Object(S.m)(),a=e({appId:"management",path:"stack/license_management"}),n=Object(r.useCallback)((()=>{t({url:a})}),[t,a]);return s.a.createElement(sn,null,s.a.createElement(i.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(on,{size:"m",type:"lock"})),s.a.createElement(i.EuiFlexItem,null,s.a.createElement(i.EuiText,{size:"s"},s.a.createElement(i.EuiLink,{color:"subdued",onClick:n,target:"_blank"},Ra.f)))))}));ln.displayName="RelatedAlertsUpsell";const cn=Object(ka.euiStyled)(i.EuiFlexItem)`
  border: 1px solid ${({theme:e})=>e.eui.euiColorLightShade};
  padding: 10px 8px;
  border-radius: 6px;
  display: inline-flex;
`,un=s.a.memo((({browserFields:e,eventId:t,data:a,isReadOnly:r,scopeId:o})=>{const l=Object(c.a)("insightsRelatedAlertsByProcessAncestry"),u=Object(La.b)().isPlatinumPlus(),d=Object(n.find)({category:"kibana",field:"kibana.alert.ancestors.id"},a),p=Object(n.find)({category:"kibana",field:"kibana.alert.rule.parameters.index"},a),m=Object(n.find)({category:"agent",field:"agent.type"},a),g=Object(n.find)({category:"event",field:"event.module"},a),b=Object(n.find)({category:"process",field:"process.entity_id"},a),f=Pa(b)&&function(e,t){return Pa(e)&&("endpoint"===e.values[0]||"winlogbeat"===e.values[0]&&Pa(t)&&"sysmon"===t.values[0])}(m,g),y=Object(n.find)({category:"process",field:"process.entry_leader.entity_id"},a),h=l&&Pa(y),E=Object(n.find)({category:"kibana",field:"kibana.alert.original_event.id"},a),v=Pa(E),x=Object(n.find)({category:"kibana",field:Oe.Q},a),k=Pa(x),j=Object(S.i)().read,O=l&&f&&d&&p;return r||!(j||f||v||h)?null:s.a.createElement("div",null,s.a.createElement(i.EuiFlexGroup,{direction:"column",gutterSize:"m"},s.a.createElement(i.EuiFlexItem,null,s.a.createElement(i.EuiTitle,{size:"xxxs"},s.a.createElement("h5",null,Ra.e))),k&&s.a.createElement(cn,null,s.a.createElement("div",null,s.a.createElement(i.EuiIcon,{type:"layers",style:{marginLeft:"4px",marginRight:"8px"}}),Ra.v(parseInt(x.values[0],10)),s.a.createElement(i.EuiBetaBadge,{label:Ra.w,style:{verticalAlign:"middle",marginLeft:"8px"},size:"s"}))),j&&s.a.createElement(i.EuiFlexItem,null,s.a.createElement(Za,{eventId:t})),E&&E.values&&s.a.createElement(i.EuiFlexItem,null,s.a.createElement(tn,{browserFields:e,data:E,eventId:t,scopeId:o})),y&&y.values&&s.a.createElement(i.EuiFlexItem,{"data-test-subj":"related-alerts-by-session"},s.a.createElement(nn,{browserFields:e,data:y,eventId:t,scopeId:o})),O&&(u?s.a.createElement(i.EuiFlexItem,{"data-test-subj":"related-alerts-by-ancestry"},s.a.createElement(Ka,{data:b,originalDocumentId:d,index:p,eventId:t,scopeId:o})):s.a.createElement(i.EuiFlexItem,null,s.a.createElement(ln,null)))))}));un.displayName="Insights";var dn=a(352),pn=a(291);const mn={cursorStart:0,querySize:1};var gn=a(375),bn=a(97),fn=a(292);let yn;!function(e){e.tableView="table-view",e.jsonView="json-view",e.summaryView="summary-view",e.threatIntelView="threat-intel-view",e.osqueryView="osquery-results-view"}(yn||(yn={}));const hn=l()(i.EuiTabbedContent).withConfig({displayName:"StyledEuiTabbedContent",componentId:"sc-5ll1tb-0"})(["display:flex;flex:1;flex-direction:column;overflow:hidden;> [role='tabpanel']{display:flex;flex:1;flex-direction:column;overflow:hidden;overflow-y:auto;::-webkit-scrollbar{-webkit-appearance:none;width:7px;}::-webkit-scrollbar-thumb{border-radius:4px;background-color:rgba(0,0,0,0.5);-webkit-box-shadow:0 0 1px rgba(255,255,255,0.5);}}"]),En=l.a.div.withConfig({displayName:"TabContentWrapper",componentId:"sc-5ll1tb-1"})(["height:100%;position:relative;"]),vn=l.a.div.withConfig({displayName:"RendererContainer",componentId:"sc-5ll1tb-2"})(["overflow-x:auto;padding-right:",";& ."," .euiFlexGroup{justify-content:flex-start;}"],(e=>e.theme.eui.euiSizeXS),bn.a),xn=l()(i.EuiFlexGroup).withConfig({displayName:"ThreatTacticContainer",componentId:"sc-5ll1tb-3"})(["flex-wrap:nowrap;& .euiFlexGroup{flex-wrap:nowrap;}"]),kn=l.a.div.withConfig({displayName:"ThreatTacticDescription",componentId:"sc-5ll1tb-4"})(["padding-left:",";"],(e=>e.theme.eui.euiSizeL)),Sn=({browserFields:e,data:t,detailsEcsData:a,id:n,indexName:o,isAlert:l,isDraggable:u,rawEventData:d,scopeId:p,timelineTabType:T,handleOnEventClosed:I,isReadOnly:C})=>{const[M,F]=Object(r.useState)(yn.summaryView),D=Object(r.useCallback)((e=>F(e.id)),[]),A=Object(r.useCallback)((()=>F(yn.tableView)),[]),_=Object(r.useMemo)((()=>t.reduce(((e,t)=>{if(Object(_e.b)(t.field)){const a=Ne(t.originalValue);if(a)return{...e,[t.field]:a}}return e}),{})),[t]),N=Object(r.useMemo)((()=>l?(e=>{const t=e.find((({field:e,originalValue:t})=>e===Ie.yb&&t));if(!t)return[];const{originalValue:a}=t;return(Array.isArray(a)?a:[a]).reduce(((e,t)=>{try{const a=De(JSON.parse(t));e.push(a)}catch(e){}return e}),[])})(t).map((e=>(e=>e.reduce(((e,t)=>(e[t.field]=t.originalValue,e)),{}))(e))):[]),[t,l]),{result:R,loading:P,setRange:L,range:B}=(e=>{const{addError:t}=Object(Et.a)(),{data:a,uiSettings:n}=Object(S.k)().services,i=n.get(Ie.eb),s=Object(w.useDispatch)(),[o,l]=Object(r.useState)({from:Ae.a,to:Ae.b}),{error:c,loading:u,result:d,start:p}=Object(pt.c)(bt),m=Object(r.useCallback)((()=>{s(vt.b.deleteOneQuery({inputId:ht.a.global,id:kt}))}),[s]);Object(r.useEffect)((()=>(!u&&d&&s(vt.b.setQuery({inputId:ht.a.global,id:kt,inspect:{dsl:d.inspect.dsl,response:[JSON.stringify(d.rawResponse,null,2)]},loading:u,refetch:St})),m)),[m,s,u,d]),Object(r.useEffect)((()=>{c&&t(c,{title:xt})}),[t,c]);const b=yt()(e),f=yt()(o);return Object(r.useEffect)((()=>{Object(g.isEmpty)(e)||Object(g.isEqual)(e,b)&&Object(g.isEqual)(o,f)||p({data:a,timerange:{...o,interval:""},defaultIndex:i,eventFields:e,filterQuery:""})}),[p,a,e,b,o,f,i]),{result:Object(g.isEmpty)(e)?jt:d,range:o,setRange:l,loading:u}})(_),q=Object(r.useMemo)((()=>Object(b.a)(d)),[d]),z=Object(r.useMemo)((()=>P||null==R||!R.enrichments?N:(e=>{if(e.length<2)return e;const t=Object(g.groupBy)(e,qe);return Object.values(t).map((e=>{var t;return null!==(t=e.find((e=>!Re(Pe(e,Ae.n)))))&&void 0!==t?t:e[0]}))})([...N,...R.enrichments])),[P,R,N]),$=z.length,{hostRisk:V,userRisk:U,isLicenseValid:H}=(e=>{const{hostName:t,userName:a}=Object(dn.b)(e),n=Object(r.useMemo)((()=>t?Object(he.C)([t]):void 0),[t]),{data:i,loading:s,isLicenseValid:o,isModuleEnabled:l}=Object(pn.c)({filterQuery:n,pagination:mn,riskEntity:he.v.host,skip:!n}),c=Object(r.useMemo)((()=>({loading:s,isModuleEnabled:l,result:i})),[i,s,l]),u=Object(r.useMemo)((()=>a?Object(he.D)([a]):void 0),[a]),{data:d,loading:p,isLicenseValid:m,isModuleEnabled:g}=Object(pn.c)({filterQuery:u,pagination:mn,riskEntity:he.v.user,skip:!u});return{userRisk:Object(r.useMemo)((()=>({loading:p,isModuleEnabled:g,result:d})),[p,g,d]),hostRisk:c,isLicenseValid:o&&m}})(t),G=Object(r.useMemo)((()=>null!=a?Object(gn.a)({data:a,rowRenderers:fn.b}):null),[a]),Q=Object(r.useMemo)((()=>Object(y.c)(p)),[p]),W=Object(r.useMemo)((()=>$>0||H&&(V||U)),[$,V,H,U]),K=Object(r.useMemo)((()=>l?{id:yn.summaryView,name:j.p,"data-test-subj":"overviewTab",content:s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiSpacer,{size:"m"}),s.a.createElement(_a,{browserFields:e,contextId:p,data:t,eventId:n,indexName:o,scopeId:p,handleOnEventClosed:I,isReadOnly:C}),s.a.createElement(i.EuiSpacer,{size:"l"}),s.a.createElement(xn,{direction:"column",wrap:!1,gutterSize:"none"},q&&q[0]&&s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiTitle,{size:"xxs"},s.a.createElement("h5",null,q[0].title)),s.a.createElement(kn,null,q[0].description))),s.a.createElement(i.EuiSpacer,{size:"l"}),null!=G&&null!=a&&s.a.createElement("div",null,s.a.createElement(i.EuiTitle,{size:"xs"},s.a.createElement("h5",null,j.c)),s.a.createElement(i.EuiSpacer,{size:"s"}),s.a.createElement(vn,{"data-test-subj":"renderer"},G.renderRow({contextId:"event-details",data:a,isDraggable:null!=u&&u,scopeId:p}))),s.a.createElement(i.EuiHorizontalRule,null),s.a.createElement(ya,{data:t,eventId:n,browserFields:e,isDraggable:u,scopeId:p,title:j.e,isReadOnly:C,goToTable:A}),s.a.createElement(i.EuiSpacer,{size:"xl"}),s.a.createElement(un,{browserFields:e,eventId:n,data:t,scopeId:p,isReadOnly:C}),W&&s.a.createElement(at,{isDraggable:u,hostRisk:V,userRisk:U,browserFields:e,data:t,eventId:n,scopeId:p,enrichments:z,isReadOnly:C}),P&&s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiLoadingContent,{lines:2})),s.a.createElement(xa.b,{data:t}))}:void 0),[l,e,p,t,n,o,I,C,G,a,u,A,q,W,V,U,z,P]),J=Object(r.useMemo)((()=>l&&!C?{id:yn.threatIntelView,"data-test-subj":"threatIntelTab",name:s.a.createElement(i.EuiFlexGroup,{direction:"row",alignItems:"center",justifyContent:"spaceAround",gutterSize:"xs"},s.a.createElement(i.EuiFlexItem,null,s.a.createElement("span",null,j.t)),s.a.createElement(i.EuiFlexItem,null,P?s.a.createElement(i.EuiLoadingSpinner,null):s.a.createElement(i.EuiNotificationBadge,{"data-test-subj":"enrichment-count-notification"},$))),content:s.a.createElement(Rt,{loading:P,enrichments:z,showInvestigationTimeEnrichments:!Object(g.isEmpty)(_)},s.a.createElement(s.a.Fragment,null,s.a.createElement(va,{setRange:L,loading:P,range:B}),s.a.createElement(i.EuiSpacer,{size:"m"})))}:void 0),[z,L,B,$,l,_,P,C]),X=Object(r.useMemo)((()=>({id:yn.tableView,"data-test-subj":"tableTab",name:j.s,content:s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiSpacer,{size:"l"}),s.a.createElement(Y,{browserFields:e,data:t,eventId:n,isDraggable:u,scopeId:p,timelineTabType:T,isReadOnly:C}))})),[e,t,n,u,p,T,C]),ee=Object(r.useMemo)((()=>({id:yn.jsonView,"data-test-subj":"jsonViewTab",name:j.k,content:s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiSpacer,{size:"m"}),s.a.createElement(En,{"data-test-subj":"jsonViewWrapper"},s.a.createElement(Z,{rawEventData:d})))})),[d]),te=(({rawEventData:e,ecsData:t})=>{var a,n,o,l,u,d,p,m,g,b;const{services:{osquery:f,application:y}}=Object(S.k)(),h=Object(c.a)("responseActionsEnabled"),w=Object(r.useMemo)((()=>s.a.createElement(i.EuiEmptyPrompt,{iconType:"logoOsquery",title:s.a.createElement("h2",null,v.b),titleSize:"xs",body:s.a.createElement(E.FormattedMessage,{id:"xpack.securitySolution.osquery.results.missingPrivileges",defaultMessage:"To access these results, ask your administrator for {osquery} Kibana privileges.",values:{osquery:s.a.createElement(i.EuiCode,null,"osquery")}})})),[]);if(!(f&&e&&h&&t))return;const{OsqueryResults:T}=f,I=Object(x.a)(e.fields),C=null===(a=I.kibana)||void 0===a||null===(n=a.alert)||void 0===n||null===(o=n.rule)||void 0===o?void 0:o.parameters,M=null==C?void 0:C[0].response_actions,F=null==M||null===(l=M.filter((e=>e.action_type_id===k.a.OSQUERY)))||void 0===l?void 0:l.length;if(!F)return;const D=null===(u=I.kibana)||void 0===u||null===(d=u.alert)||void 0===d||null===(p=d.rule)||void 0===p?void 0:p.name,A=null===(m=I.agent)||void 0===m?void 0:m.id,_=e._id;return{id:yn.osqueryView,"data-test-subj":"osqueryViewTab",name:s.a.createElement(i.EuiFlexGroup,{direction:"row",alignItems:"center",justifyContent:"spaceAround",gutterSize:"xs"},s.a.createElement(i.EuiFlexItem,null,s.a.createElement("span",null,j.o)),s.a.createElement(i.EuiFlexItem,null,s.a.createElement(i.EuiNotificationBadge,{"data-test-subj":"osquery-actions-notification"},F))),content:s.a.createElement(s.a.Fragment,null,s.a.createElement(O,{"data-test-subj":"osqueryViewWrapper"},null!=y&&null!==(g=y.capabilities)&&void 0!==g&&null!==(b=g.osquery)&&void 0!==b&&b.read?s.a.createElement(T,{agentIds:A,ruleName:D,alertId:_,ecsData:t}):w))}})({rawEventData:d,...null!==a?{ecsData:a}:{}}),ae=Object(r.useMemo)((()=>[K,J,X,ee,te].filter((e=>!!e))),[K,J,X,ee,te]),ne=Object(r.useMemo)((()=>{var e;return null!==(e=ae.find((e=>e.id===M)))&&void 0!==e?e:ae[0]}),[ae,M]),ie=Object(r.useMemo)((()=>Q?{"tour-step":Object(h.c)(3,h.b.alertsCases)}:{}),[Q]);return s.a.createElement(f.a,{isTourAnchor:Q,step:h.a.reviewAlertDetailsFlyout,tourId:h.b.alertsCases},s.a.createElement(hn,m()({},ie,{"data-test-subj":"eventDetails",tabs:ae,selectedTab:ne,onTabClick:D,key:"event-summary-tabs"})))};Sn.displayName="EventDetailsComponent";const jn=s.a.memo(Sn);var On=a(645);const wn=l()(i.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-v6xric-0"})(["flex:0 1 auto;",""],(({theme:e})=>`margin-top: ${e.eui.euiSizeS};`)),Tn=l()(i.EuiFlexGroup).withConfig({displayName:"StyledFlexGroup",componentId:"sc-v6xric-1"})(["height:100%;"]),In=l()(i.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-v6xric-2"})(["&.euiFlexItem{flex:1 0 0;overflow:hidden;}"]),Cn=s.a.memo((({eventId:e,isAlert:t,loading:a,handleOnEventClosed:r,ruleName:o,timestamp:l})=>{const p=Object(c.a)("alertDetailsPageEnabled"),{onClick:m}=Object(d.o)()({deepLinkId:Ie.uc.alerts,path:e&&t?Object(u.b)(e):""});return s.a.createElement(wn,{gutterSize:"none",justifyContent:"spaceBetween",wrap:!0},s.a.createElement(i.EuiFlexItem,{grow:!1},!a&&s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiTitle,{size:"s"},s.a.createElement("h4",null,t&&!Object(n.isEmpty)(o)?o:On.c)),l&&s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiSpacer,{size:"s"}),s.a.createElement(Va.c,{value:new Date(l)})),t&&e&&p&&s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiSpacer,{size:"l"}),s.a.createElement(d.k,{"data-test-subj":"open-alert-details-page",deepLinkId:Ie.uc.alerts,onClick:m},On.e),s.a.createElement(i.EuiSpacer,{size:"m"})))),r&&s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiButtonIcon,{iconType:"cross","aria-label":On.b,onClick:r})))}));Cn.displayName="ExpandableEventTitle";const Mn=s.a.memo((({browserFields:e,event:t,scopeId:a,timelineTabType:n,isAlert:r,isDraggable:o,loading:l,detailsData:c,detailsEcsData:u,rawEventData:d,handleOnEventClosed:p,isReadOnly:m})=>t.eventId?l?s.a.createElement(i.EuiLoadingContent,{lines:10}):s.a.createElement(Tn,{direction:"column",gutterSize:"none"},s.a.createElement(In,{grow:!0},s.a.createElement(jn,{browserFields:e,data:null!=c?c:[],detailsEcsData:u,id:t.eventId,isAlert:r,indexName:t.indexName,isDraggable:o,rawEventData:d,scopeId:a,timelineTabType:n,handleOnEventClosed:p,isReadOnly:m}))):s.a.createElement(i.EuiTextColor,{color:"subdued"},On.d)));Mn.displayName="ExpandableEvent"},,function(e,t,a){"use strict";a.d(t,"a",(function(){return Te})),a.d(t,"b",(function(){return Me})),a.d(t,"c",(function(){return Re})),a.d(t,"e",(function(){return ve})),a.d(t,"d",(function(){return Ne})),a.d(t,"f",(function(){return Pe.a}));var n=a(82),i=a.n(n),r=a(4),s=a.n(r),o=a(32),l=a(33),c=a.n(l),u=a(0);const d=u.i18n.translate("xpack.securitySolution.artifactCard.lastUpdated",{defaultMessage:"Last updated"}),p=u.i18n.translate("xpack.securitySolution.artifactCard.created",{defaultMessage:"Created"}),m=u.i18n.translate("xpack.securitySolution.artifactCard.lastUpdatedBy",{defaultMessage:"Updated by"}),g=u.i18n.translate("xpack.securitySolution.artifactCard.createdBy",{defaultMessage:"Created by"}),b=u.i18n.translate("xpack.securitySolution.artifactCard.globalEffectScope",{defaultMessage:"Applied globally"}),f=(e=0)=>u.i18n.translate("xpack.securitySolution.artifactCard.policyEffectScope",{defaultMessage:"Applied to {count} {count, plural, one {policy} other {policies}}",values:{count:e}}),y=(e=0)=>u.i18n.translate("xpack.securitySolution.artifactCard.policyEffectScope.title",{defaultMessage:"Applied to the following {count, plural, one {policy} other {policies}}",values:{count:e}}),h=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.matchOperator",{defaultMessage:"IS"}),E=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.matchOperator.not",{defaultMessage:"IS NOT"}),v=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.wildcardMatchesOperator",{defaultMessage:"MATCHES"}),x=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.nestedOperator",{defaultMessage:"has"}),k=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.matchAnyOperator",{defaultMessage:"is one of"}),S=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.matchAnyOperator.not",{defaultMessage:"is not one of"}),j=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.existsOperator",{defaultMessage:"exists"}),O=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.listOperator",{defaultMessage:"included in"}),w=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.os",{defaultMessage:"OS"}),T=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.and",{defaultMessage:"AND"}),I=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.windows",{defaultMessage:"Windows"}),C=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.linux",{defaultMessage:"Linux"}),M=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.macos",{defaultMessage:"Mac"}),F=u.i18n.translate("xpack.securitySolution.artifactExpandableCard.expand",{defaultMessage:"Expand"}),D=u.i18n.translate("xpack.securitySolution.artifactExpandableCard.collpase",{defaultMessage:"Collapse"}),A=u.i18n.translate("xpack.securitySolution.artifactMinifiedCard.descriptionLabel",{defaultMessage:"Description"});var _=a(101),N=a(47),R=a.n(N),P=a(87);const L=Object(r.memo)((({bold:e,truncate:t,size:a="s",withTooltip:n=!1,"data-test-subj":i,children:l})=>{const c=Object(r.useMemo)((()=>R()({"eui-textTruncate":t,"eui-textBreakWord":!0})),[t]),u=Object(r.useMemo)((()=>e?s.a.createElement("strong",null,l):l),[e,l]);return s.a.createElement(o.EuiText,{className:c,size:a,"data-test-subj":i},n&&"string"==typeof l&&l.length>0&&l!==Object(P.e)()?s.a.createElement(o.EuiToolTip,{anchorClassName:c,content:l,position:"top"},s.a.createElement(s.a.Fragment,null,u)):u)}));L.displayName="TextValueDisplay";var B=a(91);const q=c()(o.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-14lo602-0"})(["padding-top:2px;"]),z=Object(r.memo)((({date:e,type:t,"data-test-subj":a})=>{const n=Object(B.a)(a);return s.a.createElement(o.EuiFlexGroup,{responsive:!1,alignItems:"flexStart",gutterSize:"m","data-test-subj":a},s.a.createElement(q,{grow:!1},s.a.createElement(o.EuiIcon,{type:"calendar"})),s.a.createElement(o.EuiFlexItem,{grow:!0},s.a.createElement(o.EuiFlexGroup,{responsive:!1,direction:"column",alignItems:"flexStart",gutterSize:"xs"},s.a.createElement(o.EuiFlexItem,{className:"eui-textTruncate","data-test-subj":n("label")},s.a.createElement(L,null,"update"===t?d:p)),s.a.createElement(o.EuiFlexItem,{className:"eui-textTruncate","data-test-subj":n("value")},s.a.createElement(L,{bold:!0},s.a.createElement(_.b,{value:e,dateFormat:"M/D/YYYY"}))))))}));z.displayName="DateField";var $=a(117),V=a.n($),U=a(393);const H=Object(r.memo)((({items:e,button:t,panelPaddingSize:a,anchorPosition:n,maxWidth:l="32ch",maxHeight:c="255px",fixedWidth:u=!1,title:d,loading:p=!1,hoverInfo:m,...g})=>{const b=Object(B.a)(g["data-test-subj"]),[f,y]=Object(r.useState)(!1),h=Object(r.useCallback)((()=>y(!1)),[y]),E=Object(r.useCallback)((()=>y(!f)),[f]),v=Object(r.useMemo)((()=>({"data-test-subj":b("popoverPanel")})),[b]),x=Object(r.useMemo)((()=>e.map(((e,t)=>{var a,n;return p?s.a.createElement(o.EuiLoadingContent,{lines:1,key:V.a.v4(),"data-test-subj":null!==(n=e["data-test-subj"])&&void 0!==n?n:b(`item-loading-${t}`)}):s.a.createElement(U.a,i()({},e,{key:V.a.v4(),"data-test-subj":null!==(a=e["data-test-subj"])&&void 0!==a?a:b(`item-${t}`),textTruncate:Boolean(l)||e.textTruncate,hoverInfo:m,onClick:t=>{if(h(),e.onClick)return e.onClick(t)}}))}))),[b,h,e,l,p,m]),k=Object(r.useMemo)((()=>{const e={className:"eui-yScroll",style:{}};return l&&!u&&(e.style.maxWidth=l),c&&(e.style.maxHeight=c),u&&(e.style.width=null!=l?l:"32ch"),e}),[l,u,c]);return s.a.createElement(o.EuiPopover,i()({},g,{anchorPosition:n,panelPaddingSize:a,panelProps:v,button:s.a.createElement("div",{className:"eui-displayInlineBlock","data-test-subj":b("triggerButtonWrapper"),onClick:E},t),isOpen:f,closePopover:h}),d?s.a.createElement(o.EuiPopoverTitle,{paddingSize:"m"},d):null,s.a.createElement(o.EuiContextMenuPanel,i()({},k,{items:x})))}));H.displayName="ContextMenuWithRouterSupport";const G=Object(r.memo)((({items:e,"data-test-subj":t,icon:a="boxesHorizontal"})=>{const n=Object(B.a)(t),[l,c]=Object(r.useState)(!1),d=Object(r.useCallback)((()=>c(!1)),[c]),p=Object(r.useCallback)((()=>c(!l)),[l]),m=Object(r.useMemo)((()=>({"data-test-subj":n("popoverPanel")})),[n]),g=Object(r.useMemo)((()=>e.map((e=>s.a.createElement(U.a,i()({},e,{key:V.a.v4(),onClick:t=>{if(d(),e.onClick)return e.onClick(t)}}))))),[d,e]);return s.a.createElement(o.EuiPopover,{anchorPosition:"downRight",panelPaddingSize:"none",panelProps:m,"data-test-subj":t,button:s.a.createElement(o.EuiButtonIcon,{"data-test-subj":n("button"),iconType:a,onClick:p,"aria-label":u.i18n.translate("xpack.securitySolution.actionsContextMenu.label",{defaultMessage:"Open"})}),isOpen:l,closePopover:d},s.a.createElement(o.EuiContextMenuPanel,{items:g,"data-test-subj":n("contextMenuPanel")}))}));G.displayName="ActionsContextMenu";const Q=Object(r.memo)((({actions:e,"data-test-subj":t})=>e&&e.length>0?s.a.createElement(o.EuiFlexItem,{grow:!1},s.a.createElement(G,{items:e,icon:"boxesHorizontal","data-test-subj":t})):null));Q.displayName="CardActionsFlexItem";const W=c()(o.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItemSmallBottomMargin",componentId:"sc-k6t7b4-0"})(["margin-bottom:4px !important;"]),K=Object(r.memo)((({name:e,createdDate:t,updatedDate:a,actions:n,"data-test-subj":i})=>{const r=Object(B.a)(i);return s.a.createElement(o.EuiFlexGroup,{responsive:!1,alignItems:"flexStart","data-test-subj":i},s.a.createElement(W,{grow:!0},s.a.createElement(o.EuiFlexGroup,{alignItems:"flexStart"},s.a.createElement(o.EuiFlexItem,{grow:!0},s.a.createElement(o.EuiTitle,{size:"s"},s.a.createElement("h3",{"data-test-subj":r("title")},e))),s.a.createElement(o.EuiFlexItem,{grow:!1},s.a.createElement(o.EuiFlexGroup,{responsive:!1,gutterSize:"xl"},s.a.createElement(o.EuiFlexItem,{grow:!1},s.a.createElement(z,{date:a,type:"update","data-test-subj":r("updated")})),s.a.createElement(o.EuiFlexItem,{grow:!1},s.a.createElement(z,{date:t,type:"create","data-test-subj":r("created")})))))),s.a.createElement(Q,{actions:n,"data-test-subj":r("actions")}))}));K.displayName="CardHeader";const Y=c()(o.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-ylzny6-0"})(["margin:6px;"]),J=Object(r.memo)((({createdBy:e,updatedBy:t,"data-test-subj":a})=>{const n=Object(B.a)(a);return s.a.createElement(o.EuiFlexGroup,{alignItems:"center",gutterSize:"l",responsive:!1,"data-test-subj":a},s.a.createElement(o.EuiFlexItem,{grow:!1},s.a.createElement(X,{label:g,value:e,"data-test-subj":n("createdBy")})),s.a.createElement(o.EuiFlexItem,{grow:!1},s.a.createElement(X,{label:m,value:t,"data-test-subj":n("updatedBy")})))}));J.displayName="TouchedByUsers";const X=Object(r.memo)((({label:e,value:t,"data-test-subj":a})=>{const n=Object(B.a)(a);return s.a.createElement(o.EuiFlexGroup,{alignItems:"center",gutterSize:"m",wrap:!1,responsive:!1,"data-test-subj":a},s.a.createElement(Y,{grow:!1},s.a.createElement(o.EuiBadge,{"data-test-subj":n("label")},e)),s.a.createElement(Y,{grow:!1},s.a.createElement(o.EuiFlexGroup,{responsive:!1,gutterSize:"s",alignItems:"center",wrap:!1},s.a.createElement(o.EuiFlexItem,{grow:!1},s.a.createElement(o.EuiAvatar,{name:t,size:"s","data-test-subj":n("avatar")})),s.a.createElement(o.EuiFlexItem,{grow:!1,className:"eui-textTruncate","data-test-subj":n("value")},s.a.createElement(L,null,t)))))}));X.displayName="UserName";var Z=a(35);const ee=c()("div").withConfig({displayName:"StyledWithContextMenuShiftedWrapper",componentId:"sc-rwna0x-0"})(["margin-left:-10px;"]),te=c()(o.EuiButtonEmpty).withConfig({displayName:"StyledEuiButtonEmpty",componentId:"sc-rwna0x-1"})(["height:10px !important;"]),ae=Object(r.memo)((({policies:e,loadingPoliciesList:t=!1,"data-test-subj":a})=>{const n=Object(B.a)(a),[i,l]=Object(r.useMemo)((()=>e?["partial",f(e.length)]:["globe",b]),[e]),c=s.a.createElement(o.EuiFlexGroup,{responsive:!1,wrap:!1,alignItems:"center",gutterSize:"s","data-test-subj":a},s.a.createElement(o.EuiFlexItem,{grow:!1},s.a.createElement(o.EuiIcon,{type:i,size:"s"})),s.a.createElement(o.EuiFlexItem,{grow:!1,"data-test-subj":n("value")},s.a.createElement(L,{size:"xs"},l)));return e&&e.length?s.a.createElement(ee,null,s.a.createElement(ne,{policies:e,loadingPoliciesList:t,"data-test-subj":n("popupMenu")},c)):c}));ae.displayName="EffectScope";const ne=Object(r.memo)((({policies:e,loadingPoliciesList:t=!1,children:a,"data-test-subj":n})=>{const i=Object(B.a)(n),l=Object(r.useMemo)((()=>s.a.createElement(te,{flush:"right",size:"s",iconSide:"right",iconType:"popout"},s.a.createElement(Z.FormattedMessage,{id:"xpack.securitySolution.contextMenuItemByRouter.viewDetails",defaultMessage:"View details"}))),[]);return s.a.createElement(H,{maxHeight:"235px",fixedWidth:!0,panelPaddingSize:"none",items:e,anchorPosition:e.length>1?"rightCenter":"rightUp","data-test-subj":n,loading:t,hoverInfo:l,button:s.a.createElement(o.EuiButtonEmpty,{size:"xs","data-test-subj":i("button")},a),title:y(e.length)})}));ne.displayName="WithContextMenu";const ie=Object(r.memo)((({createdBy:e,updatedBy:t,policies:a,loadingPoliciesList:n=!1,"data-test-subj":i})=>{const r=Object(B.a)(i);return s.a.createElement(o.EuiFlexGroup,{alignItems:"center",responsive:!0,"data-test-subj":i},s.a.createElement(o.EuiFlexItem,{grow:!1},s.a.createElement(J,{createdBy:e,updatedBy:t,"data-test-subj":r("touchedBy")})),s.a.createElement(o.EuiFlexItem,{grow:!1},s.a.createElement(ae,{policies:a,loadingPoliciesList:n,"data-test-subj":r("effectScope")})))}));ie.displayName="CardSubHeader";var re=a(93);const se=Object.freeze({linux:C,mac:M,macos:M,windows:I}),oe=Object.freeze({[re.d.NESTED]:x,[re.d.MATCH_ANY]:k,[re.d.MATCH]:h,[re.d.WILDCARD]:v,[re.d.EXISTS]:j,[re.d.LIST]:O}),le=Object.freeze({[re.d.MATCH_ANY]:S,[re.d.MATCH]:E}),ce=c()(o.EuiFlexGroup).withConfig({displayName:"EuiFlexGroupNested",componentId:"sc-145kt5g-0"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeXL)),ue=c()(o.EuiFlexItem).withConfig({displayName:"EuiFlexItemNested",componentId:"sc-145kt5g-1"})(["margin-bottom:6px !important;margin-top:6px !important;"]),de=c()("span").withConfig({displayName:"StyledCondition",componentId:"sc-145kt5g-2"})(["margin-right:6px;"]),pe=Object(r.memo)((({os:e,entries:t,"data-test-subj":a})=>{const n=Object(B.a)(a),i=Object(r.useMemo)((()=>e.map((e=>{var t;return null!==(t=se[e])&&void 0!==t?t:e})).join(", ")),[e]),l=(e,t)=>"match_any"===e&&Array.isArray(t)?t.map((e=>s.a.createElement(o.EuiBadge,{color:"hollow"},e))):t,c=(e,t)=>{var a,n;return"nested"===e?"":"included"===t?null!==(a=oe[e])&&void 0!==a?a:e:null!==(n=le[e])&&void 0!==n?n:e},u=Object(r.useCallback)(((e,t)=>{if("nested"===e&&t.length)return t.map((({field:e,type:t,value:a,operator:i})=>s.a.createElement(ce,{"data-test-subj":n("nestedCondition"),key:e+t+a,direction:"row",alignItems:"center",gutterSize:"m",responsive:!1},s.a.createElement(ue,{grow:!1},s.a.createElement(o.EuiToken,{iconType:"tokenNested",size:"s"})),s.a.createElement(ue,{grow:!1},s.a.createElement(o.EuiExpression,{description:"",value:e,color:"subdued"})),s.a.createElement(ue,{grow:!1},s.a.createElement(o.EuiExpression,{description:c(t,i),value:l(t,a)})))))}),[n]);return s.a.createElement("div",{"data-test-subj":a},s.a.createElement("div",{"data-test-subj":n("os")},s.a.createElement("strong",null,s.a.createElement(o.EuiExpression,{description:"",value:w}),s.a.createElement(o.EuiExpression,{description:h,value:i}))),t.map((({field:e,type:t,value:a,operator:i,entries:r=[]})=>s.a.createElement("div",{"data-test-subj":n("condition"),key:e+t+a},s.a.createElement("div",{className:"eui-xScroll"},s.a.createElement(o.EuiExpression,{description:s.a.createElement(de,null,T),value:e,color:"subdued"}),s.a.createElement(o.EuiExpression,{description:c(t,i),value:l(t,a)})),u(t,r)))))}));pe.displayName="CriteriaConditions";const me=e=>"effectScope"in e;var ge=a(139);const be=e=>(e=>{const t=e.filter((e=>e.startsWith(ge.b)));return t.some((e=>e===`${ge.b}all`))?{type:"global"}:{type:"policy",policies:t.map((e=>e.substr(ge.b.length)))}})(e.tags),fe=e=>Object(r.useMemo)((()=>(e=>{var t;const a=e,{name:n,created_by:i,created_at:r,updated_at:s,updated_by:o,description:l="",entries:c}=a;return{name:n,created_by:i,created_at:r,updated_at:s,updated_by:o,description:l,comments:me(a)?[]:a.comments,entries:c,os:me(a)?[a.os]:null!==(t=a.os_types)&&void 0!==t?t:[],effectScope:me(a)?a.effectScope:be(a)}})(e)),[e]),ye=c()(o.EuiPanel).withConfig({displayName:"EuiPanelStyled",componentId:"sc-13mspil-0"})(["&.artifactEntryCard + &.artifactEntryCard{margin-top:",";}"],(({theme:e})=>e.eui.euiSizeL)),he=Object(r.memo)((({className:e,...t})=>s.a.createElement(ye,i()({},t,{hasBorder:!0,paddingSize:"none",className:`artifactEntryCard ${null!=e?e:""}`}))));he.displayName="CardContainerPanel";const Ee=c()(o.EuiPanel).withConfig({displayName:"StyledEuiPanel",componentId:"sc-1cjqxs3-0"})(["padding:32px;&.top-section{padding-bottom:24px;}&.bottom-section{padding-top:24px;}&.artifact-entry-collapsible-card{padding:24px !important;}"]),ve=Object(r.memo)((e=>s.a.createElement(Ee,i()({},e,{hasBorder:!1,hasShadow:!1,paddingSize:"l"}))));ve.displayName="CardSectionPanel";var xe=a(34),ke=a(361);const Se=c()(o.EuiAvatar).withConfig({displayName:"CustomEuiAvatar",componentId:"sc-1xphza0-0"})(["background-color:"," !important;"],(({theme:e})=>e.eui.euiColorLightShade)),je=Object(r.memo)((({comments:e,"data-test-subj":t})=>{const a=Object(B.a)(t),[n,i]=Object(r.useState)(!1),l=Object(r.useCallback)((()=>{i(!n)}),[i,n]),c=Object(r.useMemo)((()=>(e=>e.map((e=>({username:e.created_by,timestamp:s.a.createElement(_.b,{value:e.created_at,dateFormat:"MMM D, YYYY"}),event:ke.b,timelineAvatar:s.a.createElement(Se,{size:"s",name:e.created_by}),children:s.a.createElement(o.EuiText,{size:"s"},e.comment)}))))(e)),[e]),d=Object(r.useMemo)((()=>n?((e=0)=>u.i18n.translate("xpack.securitySolution.artifactCard.comments.label.hide",{defaultMessage:"Hide comments ({count})",values:{count:e}}))(e.length):((e=0)=>u.i18n.translate("xpack.securitySolution.artifactCard.comments.label.show",{defaultMessage:"Show comments ({count})",values:{count:e}}))(e.length)),[e.length,n]);return Object(xe.isEmpty)(e)?null:s.a.createElement("div",{"data-test-subj":t},s.a.createElement(o.EuiSpacer,{size:"s"}),s.a.createElement(o.EuiButtonEmpty,{onClick:l,flush:"left",size:"xs","data-test-subj":a("label")},d),s.a.createElement(o.EuiAccordion,{id:"1",arrowDisplay:"none",forceState:n?"open":"closed"},s.a.createElement(o.EuiSpacer,{size:"m"}),s.a.createElement(o.EuiCommentList,{comments:c,"data-test-subj":a("list")})))}));je.displayName="CardComments";const Oe=(e,t)=>Object(r.useMemo)((()=>"policy"===e.effectScope.type?null==e?void 0:e.effectScope.policies.map((e=>t&&t[e]?t[e]:{children:e})):void 0),[e.effectScope,t]),we=Object(r.memo)((({truncate:e,children:t,"data-test-subj":a,withTooltip:n})=>s.a.createElement(L,{size:"m",truncate:e,"data-test-subj":a,withTooltip:n},t||Object(P.e)())));we.displayName="ArtifactDescription";const Te=Object(r.memo)((({item:e,policies:t,loadingPoliciesList:a=!1,actions:n,hideDescription:r=!1,hideComments:l=!1,"data-test-subj":c,...u})=>{const d=fe(e),p=Object(B.a)(c),m=Oe(d,t);return s.a.createElement(he,i()({},u,{"data-test-subj":c}),s.a.createElement(ve,{className:"top-section"},s.a.createElement(K,{name:d.name,createdDate:d.created_at,updatedDate:d.updated_at,actions:n,"data-test-subj":p("header")}),s.a.createElement(ie,{createdBy:d.created_by,updatedBy:d.updated_by,policies:m,loadingPoliciesList:a,"data-test-subj":p("subHeader")}),!r&&s.a.createElement(s.a.Fragment,null,s.a.createElement(o.EuiSpacer,{size:"l"}),s.a.createElement(we,{"data-test-subj":p("description")},d.description)),l?null:s.a.createElement(s.a.Fragment,null,r&&s.a.createElement(o.EuiSpacer,{size:"l"}),s.a.createElement(je,{comments:d.comments,"data-test-subj":p("comments")}))),s.a.createElement(o.EuiHorizontalRule,{margin:"none"}),s.a.createElement(ve,{className:"bottom-section"},s.a.createElement(pe,{os:d.os,entries:d.entries,"data-test-subj":p("criteriaConditions")})))}));Te.displayName="ArtifactEntryCard";const Ie=c()(o.EuiSplitPanel.Outer).withConfig({displayName:"CardContainerPanel",componentId:"sc-khxq0i-0"})(["&.artifactEntryCardMinified + &.artifactEntryCardMinified{margin-top:",";}"],(({theme:e})=>e.eui.euiSizeL)),Ce=c()(o.EuiSplitPanel.Inner).withConfig({displayName:"CustomSplitInnerPanel",componentId:"sc-khxq0i-1"})(["background-color:"," !important;"],(({theme:e})=>e.eui.euiColorLightestShade)),Me=Object(r.memo)((({item:e,isSelected:t=!1,onToggleSelectedArtifact:a,"data-test-subj":n,...l})=>{var c;const u=fe(e),d=Object(B.a)(n),[p,m]=Object(r.useState)("closed"),g=Object(r.useCallback)((()=>{m((e=>"closed"===e?"open":"closed"))}),[]),b=Object(r.useCallback)((()=>"open"===p?"Hide details":"Show details"),[p]),f=Object(r.useMemo)((()=>s.a.createElement(Ce,null,s.a.createElement(o.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},s.a.createElement(o.EuiFlexItem,{grow:!1},s.a.createElement(o.EuiCheckbox,{id:u.name,"data-test-subj":`${u.name}_checkbox`,checked:t,onChange:()=>a(!t)})),s.a.createElement(o.EuiFlexItem,null,s.a.createElement(o.EuiTitle,{size:"xxs"},s.a.createElement("h5",{"data-test-subj":d("title")},u.name)))))),[u.name,d,t,a]);return s.a.createElement(Ie,i()({},l,{"data-test-subj":n,className:`${null!==(c=l.className)&&void 0!==c?c:""}  artifactEntryCardMinified`,id:u.name,hasShadow:!1,hasBorder:!0}),f,s.a.createElement(o.EuiSplitPanel.Inner,{paddingSize:"s"},s.a.createElement(o.EuiPanel,{hasBorder:!1,hasShadow:!1,paddingSize:"s"},s.a.createElement(o.EuiTitle,{size:"xxs"},s.a.createElement("h5",{"data-test-subj":d("descriptionTitle")},A)),s.a.createElement(we,{"data-test-subj":d("description")},u.description)),s.a.createElement(o.EuiPanel,{hasBorder:!1,hasShadow:!1,paddingSize:"s"},s.a.createElement(o.EuiButtonEmpty,{"data-test-subj":d("collapse"),color:"primary",size:"s",flush:"left",iconType:"open"===p?"arrowUp":"arrowDown",iconSide:"right",iconSize:"m",onClick:g,style:{fontWeight:400}},b()),s.a.createElement(o.EuiAccordion,{id:"showDetails",arrowDisplay:"none",forceState:p},s.a.createElement(pe,{os:u.os,entries:u.entries,"data-test-subj":d("criteriaConditions")})))))}));Me.displayName="ArtifactEntryCardMinified";const Fe=Object(r.memo)((({expanded:e,onClick:t,"data-test-subj":a})=>s.a.createElement(o.EuiButtonIcon,{iconType:e?"arrowUp":"arrowDown",onClick:t,"data-test-subj":a,"aria-label":e?D:F})));Fe.displayName="CardExpandButton";const De=Object(r.memo)((({artifact:e,onExpandCollapse:t,policies:a,actions:n,expanded:i=!1,"data-test-subj":o})=>{const l=Object(B.a)(o),c=Oe(e,a),u=Object(r.useCallback)((()=>{t()}),[t]);return s.a.createElement(Ne,{"data-test-subj":o,expanded:i,expandToggle:s.a.createElement(Fe,{expanded:i,onClick:u,"data-test-subj":l("expandCollapse")}),name:s.a.createElement(L,{bold:!0,truncate:!i,withTooltip:!i},e.name),description:s.a.createElement(we,{truncate:!i,withTooltip:!i},e.description),effectScope:s.a.createElement(ae,{policies:c,"data-test-subj":l("effectScope")}),actionMenu:s.a.createElement(Q,{actions:n,"data-test-subj":l("actions")})})}));De.displayName="CardCompressedHeader";const Ae=c.a.div.withConfig({displayName:"ButtonIconPlaceHolder",componentId:"sc-17lokoz-0"})(["display:inline-block;width:",";height:",";"],(({theme:e})=>e.eui.euiSizeL),(({theme:e})=>e.eui.euiSizeL)),_e=c()(o.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-17lokoz-1"})(["&.flushTop,.flushTop{padding-top:0;margin-top:0;}"]),Ne=Object(r.memo)((({expanded:e,name:t,expandToggle:a,effectScope:n,actionMenu:i,description:l,"data-test-subj":c,flushTop:u})=>{const d=Object(B.a)(c),p=(e=>Object(r.useMemo)((()=>R()({"eui-textTruncate":!e})),[e]))(e),m=u?" flushTop":"";return s.a.createElement(_e,{responsive:!1,alignItems:"center","data-test-subj":c,className:m},s.a.createElement(o.EuiFlexItem,{grow:!1,className:m,"data-test-subj":d("expandCollapseHolder")},a),s.a.createElement(o.EuiFlexItem,{className:p+m},s.a.createElement(o.EuiFlexGroup,{alignItems:"center",className:m},s.a.createElement(o.EuiFlexItem,{grow:2,className:p+m,"data-test-subj":d("titleHolder")},t),s.a.createElement(o.EuiFlexItem,{grow:3,className:p+m,"data-test-subj":d("descriptionHolder")},l),s.a.createElement(o.EuiFlexItem,{grow:1,"data-test-subj":d("effectScopeHolder"),className:m},n))),!0===i?s.a.createElement(o.EuiFlexItem,{grow:!1,"data-test-subj":d("cardActionsPlaceholder"),className:m},s.a.createElement(Ae,null)):i)}));Ne.displayName="CardCompressedHeaderLayout";const Re=Object(r.memo)((({item:e,onExpandCollapse:t,policies:a,actions:n,expanded:r=!1,"data-test-subj":l,...c})=>{const u=fe(e),d=Object(B.a)(l);return s.a.createElement(he,i()({},c,{"data-test-subj":l}),s.a.createElement(ve,{className:"artifact-entry-collapsible-card"},s.a.createElement(De,{artifact:u,actions:n,policies:a,expanded:r,onExpandCollapse:t,"data-test-subj":d("header")})),r&&s.a.createElement(s.a.Fragment,null,s.a.createElement(o.EuiHorizontalRule,{margin:"xs"}),s.a.createElement(ve,null,s.a.createElement(pe,{os:u.os,entries:u.entries,"data-test-subj":d("criteriaConditions")}))))}));Re.displayName="ArtifactEntryCollapsibleCard";var Pe=a(575)},function(e,t,a){"use strict";a.d(t,"a",(function(){return Me}));var n=a(4),i=a.n(n),r=a(78),s=a(32),o=a(99),l=a(86),c=a(112),u=a(79),d=a(81),p=a(92),m=a.n(p),g=a(501),b=a(590),f=a(646),y=a(900),h=a(352),E=a(358),v=a(246),x=a(700);const k=({browserFields:e,entityType:t="events",expandedEvent:a,handleOnEventClosed:r,isDraggable:o,isFlyoutView:l,runtimeMappings:c,tabType:u,scopeId:d,isReadOnly:p})=>{var m,k;const S=Object(E.a)(),{indexName:j}=a,O=null!==(m=Object(h.a)(j,S))&&void 0!==m?m:j,[w,T,I,C,M]=Object(b.a)({entityType:t,indexName:null!=O?O:"",eventId:null!==(k=a.eventId)&&void 0!==k?k:"",runtimeMappings:c,skip:!a.eventId}),{isolateAction:F,isHostIsolationPanelOpen:D,isIsolateActionSuccessBannerVisible:A,handleIsolationActionSuccess:_,showAlertDetails:N,showHostIsolationPanel:R}=Object(f.a)(),{alertId:P,isAlert:L,hostName:B,ruleName:q,timestamp:z}=Object(h.b)(T),$=Object(n.useMemo)((()=>l||D?i.a.createElement(y.c,{eventId:a.eventId,isHostIsolationPanelOpen:D,isAlert:L,isolateAction:F,loading:w,ruleName:q,showAlertDetails:N,timestamp:z}):i.a.createElement(g.b,{eventId:a.eventId,isAlert:L,loading:w,ruleName:q,handleOnEventClosed:r})),[a.eventId,r,L,l,D,F,w,q,N,z]),V=Object(n.useMemo)((()=>l?i.a.createElement(y.a,{alertId:P,browserFields:e,detailsData:T,detailsEcsData:C,event:a,hostName:B,handleIsolationActionSuccess:_,handleOnEventClosed:r,isAlert:L,isDraggable:o,isolateAction:F,isIsolateActionSuccessBannerVisible:A,isHostIsolationPanelOpen:D,loading:w,rawEventData:I,showAlertDetails:N,scopeId:d,isReadOnly:p}):D?i.a.createElement(i.a.Fragment,null,A&&i.a.createElement(v.d,{hostName:B,alertId:P,isolateAction:F}),i.a.createElement(s.EuiFlyoutBody,null,i.a.createElement(x.a,{details:T,cancelCallback:N,successCallback:_,isolateAction:F}))):i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(g.a,{browserFields:e,detailsData:T,detailsEcsData:C,event:a,isAlert:L,isDraggable:o,loading:w,rawEventData:I,scopeId:d,timelineTabType:u,handleOnEventClosed:r}))),[P,e,T,C,a,_,r,B,L,o,l,D,A,p,F,w,I,N,u,d]);return null!=a&&a.eventId?i.a.createElement(i.a.Fragment,null,$,V,i.a.createElement(y.b,{detailsData:T,detailsEcsData:C,expandedEvent:a,refetchFlyoutData:M,handleOnEventClosed:r,isHostIsolationPanelOpen:D,isReadOnly:p,loadingEventDetails:w,onAddIsolationStatusClick:R,scopeId:d})):null},S=i.a.memo(k,((e,t)=>m()(e.browserFields,t.browserFields)&&m()(e.expandedEvent,t.expandedEvent)&&e.scopeId===t.scopeId&&e.isDraggable===t.isDraggable));var j=a(0),O=a(33),w=a.n(O),T=a(90),I=a(89),C=a(114),M=a(94),F=a(910),D=a(143),A=a(538),_=a(892),N=a(319),R=a(920);const P=w.a.h4.withConfig({displayName:"StyledTitle",componentId:"sc-18s5s5o-0"})(["word-break:break-all;word-wrap:break-word;white-space:pre-wrap;"]),L=({hostName:e})=>i.a.createElement(s.EuiTitle,{size:"s"},i.a.createElement(P,null,j.i18n.translate("xpack.securitySolution.timeline.sidePanel.hostDetails.title",{defaultMessage:"Host details"}),`: ${e}`)),B=({hostName:e})=>i.a.createElement(I.d,{hostName:e,isButton:!0},j.i18n.translate("xpack.securitySolution.timeline.sidePanel.hostDetails.hostDetailsPageLink",{defaultMessage:"View details page"})),q=({contextID:e,hostName:t,isDraggable:a=!1})=>{const{to:s,from:o,isInitializing:l}=Object(C.a)(),{selectedPatterns:c}=Object(M.d)(),u=Object(r.useDispatch)(),[d,{hostDetails:p}]=Object(R.b)({endDate:s,hostName:t,indexNames:c,startDate:o}),m=Object(n.useCallback)(((e,t)=>{const a=Object(N.a)(e,t);u(Object(D.setAbsoluteRangeDatePicker)({id:T.a.global,from:a.from,to:a.to}))}),[u]);return i.a.createElement(A.a,{criteriaFields:Object(_.a)(p),startDate:o,endDate:s,skip:l},(({isLoadingAnomaliesData:n,anomaliesData:r})=>i.a.createElement(F.a,{contextID:e,id:R.a,isInDetailsSidePanel:!0,data:p,anomaliesData:r,isDraggable:a,isLoadingAnomaliesData:n,indexNames:c,loading:d,startDate:o,endDate:s,narrowDateRange:m,hostName:t})))},z=w()(s.EuiFlyoutBody).withConfig({displayName:"StyledEuiFlyoutBody",componentId:"sc-hctd1a-0"})([".euiFlyoutBody__overflow{display:flex;flex:1;overflow:hidden;.euiFlyoutBody__overflowContent{flex:1;overflow-x:hidden;overflow-y:scroll;margin-bottom:64px;padding:",";}}"],(({theme:e})=>`${e.eui.euiSizeXS} ${e.eui.euiSizeM} 0px`)),$=w()(s.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-hctd1a-1"})(["flex:1 0 auto;"]),V=w()(s.EuiFlexItem).withConfig({displayName:"StyledEuiFlexButtonWrapper",componentId:"sc-hctd1a-2"})(["align-self:flex-start;flex:1 0 auto;"]),U=w.a.div.withConfig({displayName:"StyledPanelContent",componentId:"sc-hctd1a-3"})(["display:block;height:100%;overflow-y:scroll;overflow-x:hidden;"]),H=i.a.memo((({contextID:e,expandedHost:t,handleOnHostClosed:a,isDraggable:n,isFlyoutView:r})=>{const{hostName:o}=t;return o?r?i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiFlyoutHeader,{hasBorder:!0},i.a.createElement(L,{hostName:o})),i.a.createElement(z,null,i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(B,{hostName:o}),i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(q,{contextID:e,hostName:o}))):i.a.createElement(i.a.Fragment,null,i.a.createElement($,{justifyContent:"spaceBetween",wrap:!1},i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(L,{hostName:o})),i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(s.EuiButtonIcon,{iconType:"cross","aria-label":j.i18n.translate("xpack.securitySolution.timeline.sidePanel.hostDetails.close",{defaultMessage:"close"}),onClick:a}))),i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(V,{grow:!1},i.a.createElement(B,{hostName:o})),i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(U,null,i.a.createElement(q,{contextID:e,hostName:o,isDraggable:n}))):null}));var G=a(42),Q=a(233),W=a(626),K=a(625),Y=a(77),J=a(146),X=a(98),Z=a(713),ee=a(111),te=a(325),ae=a(716),ne=a(248);const ie=w.a.h4.withConfig({displayName:"StyledTitle",componentId:"sc-rlvmr5-0"})(["word-break:break-all;word-wrap:break-word;white-space:pre-wrap;"]),re=({ip:e})=>i.a.createElement(s.EuiTitle,{size:"s"},i.a.createElement(ie,null,j.i18n.translate("xpack.securitySolution.timeline.sidePanel.networkDetails.title",{defaultMessage:"Network details"}),`: ${e}`)),se=({expandedNetwork:{ip:e,flowTarget:t}})=>i.a.createElement(I.h,{ip:e,flowTarget:t,isButton:!0},j.i18n.translate("xpack.securitySolution.timeline.sidePanel.networkDetails.networkDetailsPageLink",{defaultMessage:"View details page"})),oe=({contextID:e,expandedNetwork:t,isDraggable:a})=>{const{ip:s,flowTarget:o}=t,l=Object(r.useDispatch)(),{to:c,from:u,isInitializing:p}=Object(C.a)(),m=Object(n.useMemo)((()=>X.d.globalQuerySelector()),[]),g=Object(n.useMemo)((()=>X.d.globalFiltersQuerySelector()),[]),b=Object(d.a)(m),f=Object(d.a)(g),y=ee.c.NetworkType.details,h=Object(n.useCallback)(((e,t)=>{const a=Object(N.a)(e,t);l(Object(D.setAbsoluteRangeDatePicker)({id:T.a.global,from:a.from,to:a.to}))}),[l]),{services:{uiSettings:E}}=Object(Y.k)(),{indicesExist:v,indexPattern:x,selectedPatterns:k}=Object(M.d)(),[S,j]=Object(J.c)({config:Object(G.getEsQueryConfig)(E),indexPattern:x,queries:[b],filters:f}),[O,{id:w,networkDetails:I}]=Object(Z.b)({skip:p||void 0===S,filterQuery:S,indexNames:k,ip:s});Object(Q.a)({id:w,filterQuery:S,kqlError:j,query:b,startDate:u,endDate:c});const{jobIds:F}=Object(ne.b)(),[A,_]=Object(te.a)({criteriaFields:Object(K.a)(s,o),startDate:u,endDate:c,skip:p,jobIds:F,aggregationInterval:"auto"});return v?i.a.createElement(W.a,{contextID:e,id:w,ip:s,data:I,anomaliesData:_,loading:O,isInDetailsSidePanel:!0,isLoadingAnomaliesData:A,isDraggable:a,type:y,flowTarget:o,startDate:u,endDate:c,narrowDateRange:h,indexPatterns:k}):i.a.createElement(ae.a,null)},le=w()(s.EuiFlyoutBody).withConfig({displayName:"StyledEuiFlyoutBody",componentId:"sc-uvw88-0"})([".euiFlyoutBody__overflow{display:flex;flex:1;overflow-x:hidden;overflow-y:scroll;.euiFlyoutBody__overflowContent{flex:1;overflow-x:hidden;overflow-y:scroll;padding:",";}}"],(({theme:e})=>`${e.eui.euiSizeXS} ${e.eui.euiSizeM} 64px`)),ce=w()(s.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-uvw88-1"})(["flex:1 0 auto;"]),ue=w()(s.EuiFlexItem).withConfig({displayName:"StyledEuiFlexButtonWrapper",componentId:"sc-uvw88-2"})(["align-self:flex-start;flex:1 0 auto;"]),de=w.a.div.withConfig({displayName:"StyledPanelContent",componentId:"sc-uvw88-3"})(["display:block;height:100%;overflow-y:scroll;overflow-x:hidden;"]),pe=i.a.memo((({contextID:e,expandedNetwork:t,handleOnNetworkClosed:a,isFlyoutView:n,isDraggable:r})=>{const{ip:o}=t;return n?i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiFlyoutHeader,{hasBorder:!0},i.a.createElement(re,{ip:o})),i.a.createElement(le,null,i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(se,{expandedNetwork:t}),i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(oe,{contextID:e,expandedNetwork:t}))):i.a.createElement(i.a.Fragment,null,i.a.createElement(ce,{justifyContent:"spaceBetween",wrap:!1},i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(re,{ip:o})),i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(s.EuiButtonIcon,{iconType:"cross","aria-label":j.i18n.translate("xpack.securitySolution.timeline.sidePanel.networkDetails.close",{defaultMessage:"close"}),onClick:a}))),i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(ue,{grow:!1},i.a.createElement(se,{expandedNetwork:t})),i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(de,null,i.a.createElement(oe,{contextID:e,expandedNetwork:t,isDraggable:r})))}));var me=a(921),ge=a(922),be=a(829),fe=a(137);const ye=w.a.h4.withConfig({displayName:"StyledTitle",componentId:"sc-1tknvzp-0"})(["word-break:break-all;word-wrap:break-word;white-space:pre-wrap;"]),he=({userName:e})=>i.a.createElement(s.EuiTitle,{size:"s"},i.a.createElement(ye,null,j.i18n.translate("xpack.securitySolution.timeline.sidePanel.userDetails.title",{defaultMessage:"User details"}),`: ${e}`)),Ee=({userName:e})=>i.a.createElement(I.m,{userName:e,isButton:!0},j.i18n.translate("xpack.securitySolution.timeline.sidePanel.networkDetails.userDetails",{defaultMessage:"View details page"})),ve=({contextID:e,userName:t,isDraggable:a})=>{const{to:s,from:o,isInitializing:l}=Object(C.a)(),{selectedPatterns:c}=Object(M.d)(),u=Object(r.useDispatch)(),[d,{userDetails:p}]=Object(ge.a)({endDate:s,startDate:o,userName:t,indexNames:c,skip:l}),m=Object(n.useCallback)(((e,t)=>{const a=Object(N.a)(e,t);u(Object(D.setAbsoluteRangeDatePicker)({id:T.a.global,from:a.from,to:a.to}))}),[u]);return i.a.createElement(A.a,{criteriaFields:Object(be.a)(fe.UsersType.details,t),startDate:o,endDate:s,skip:l},(({isLoadingAnomaliesData:n,anomaliesData:r})=>i.a.createElement(me.a,{userName:t,isInDetailsSidePanel:!0,data:p,loading:d,contextID:e,isDraggable:a,id:"usersDetailsQuery",anomaliesData:r,isLoadingAnomaliesData:n,startDate:o,endDate:s,narrowDateRange:m,indexPatterns:c})))},xe=w()(s.EuiFlyoutBody).withConfig({displayName:"StyledEuiFlyoutBody",componentId:"sc-shafkc-0"})([".euiFlyoutBody__overflow{display:flex;flex:1;overflow-x:hidden;overflow-y:scroll;.euiFlyoutBody__overflowContent{flex:1;overflow-x:hidden;overflow-y:scroll;padding:",";}}"],(({theme:e})=>`${e.eui.euiSizeXS} ${e.eui.euiSizeM} 64px`)),ke=({contextID:e,userName:t})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiFlyoutHeader,{hasBorder:!0},i.a.createElement(he,{userName:t})),i.a.createElement(xe,null,i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(Ee,{userName:t}),i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(ve,{contextID:e,userName:t}))),Se=w()(s.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-1t5j3rb-0"})(["flex:1 0 auto;"]),je=w()(s.EuiFlexItem).withConfig({displayName:"StyledEuiFlexButtonWrapper",componentId:"sc-1t5j3rb-1"})(["align-self:flex-start;flex:1 0 auto;"]),Oe=w.a.div.withConfig({displayName:"StyledPanelContent",componentId:"sc-1t5j3rb-2"})(["display:block;height:100%;overflow-y:scroll;overflow-x:hidden;"]),we=({contextID:e,userName:t,isDraggable:a,handleOnClose:n})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(Se,{justifyContent:"spaceBetween",wrap:!1},i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(he,{userName:t})),i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(s.EuiButtonIcon,{iconType:"cross","aria-label":j.i18n.translate("xpack.securitySolution.timeline.sidePanel.networkDetails.close",{defaultMessage:"close"}),onClick:n}))),i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(je,{grow:!1},i.a.createElement(Ee,{userName:t})),i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(Oe,null,i.a.createElement(ve,{contextID:e,userName:t,isDraggable:a}))),Te=({contextID:e,userName:t,handleOnClose:a,isFlyoutView:n,isDraggable:r})=>n?i.a.createElement(ke,{userName:t,contextID:e}):i.a.createElement(we,{userName:t,contextID:e,isDraggable:r,handleOnClose:a}),Ie=i.a.memo(Te);var Ce=a(155);const Me=i.a.memo((({browserFields:e,entityType:t,handleOnPanelClosed:a,isFlyoutView:p,runtimeMappings:m,tabType:g,scopeId:b,isReadOnly:f})=>{var y,h,E,v;const x=Object(r.useDispatch)(),k=Object(n.useMemo)((()=>Object(o.isTimelineScope)(b)?l.b.getTimelineByIdSelector():Object(o.isInTableScope)(b)?Ce.b.getTableByIdSelector():void 0),[b]),j=Object(d.a)((e=>{var t,a;return null===(t=null!==(a=k&&k(e,b))&&void 0!==a?a:c.b)||void 0===t?void 0:t.expandedDetail})),O=Object(n.useCallback)((()=>{const e=Object(o.getScopedActions)(b);e&&x(e.toggleDetailPanel({id:b}))}),[x,b]),w=null!=g?g:u.m.query,T=Object(n.useCallback)((()=>{a?a():O()}),[O,a]);if(!j)return null;const I=j[w];if(null==I||!I.panelView)return null;let C=null,M="s",F=b;const D=`${b}-${w}`,A=b===u.j.active&&w===u.m.query;return"eventDetail"===(null==I?void 0:I.panelView)&&null!=I&&null!==(y=I.params)&&void 0!==y&&y.eventId&&(M="m",F=I.params.eventId,C=i.a.createElement(S,{browserFields:e,entityType:t,expandedEvent:null==I?void 0:I.params,handleOnEventClosed:T,isDraggable:A,isFlyoutView:p,runtimeMappings:m,tabType:w,scopeId:b,isReadOnly:f})),"hostDetail"===(null==I?void 0:I.panelView)&&null!=I&&null!==(h=I.params)&&void 0!==h&&h.hostName&&(F=I.params.hostName,C=i.a.createElement(H,{contextID:D,expandedHost:null==I?void 0:I.params,handleOnHostClosed:T,isDraggable:A,isFlyoutView:p})),"userDetail"===(null==I?void 0:I.panelView)&&null!=I&&null!==(E=I.params)&&void 0!==E&&E.userName&&(F=I.params.userName,C=i.a.createElement(Ie,{contextID:D,userName:I.params.userName,handleOnClose:T,isDraggable:A,isFlyoutView:p})),"networkDetail"===(null==I?void 0:I.panelView)&&null!=I&&null!==(v=I.params)&&void 0!==v&&v.ip&&(F=I.params.ip,C=i.a.createElement(pe,{contextID:D,expandedNetwork:null==I?void 0:I.params,handleOnNetworkClosed:T,isDraggable:A,isFlyoutView:p})),p?i.a.createElement(s.EuiFlyout,{"data-test-subj":"timeline:details-panel:flyout",size:M,onClose:T,ownFocus:!1,key:F},C):C}));Me.displayName="DetailsPanel"},function(e,t,a){"use strict";a.d(t,"a",(function(){return $}));var n=a(34),i=a(4),r=a.n(i),s=a(33),o=a.n(s),l=a(32),c=a(93),u=a(166),d=a(717),p=a(0);const m=p.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.linkedToListSection.title",{defaultMessage:"Linked to shared list"}),g=p.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.linkedToListSection.error",{defaultMessage:"Unable to fetch exception list."});var b=a(261);const f=o()(l.EuiTitle).withConfig({displayName:"SectionHeader",componentId:"sc-1bzei7o-0"})(["",""],(()=>Object(s.css)(["font-weight:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold)))),y=({isLoadingReferences:e,errorFetchingReferences:t,listAndReferences:a})=>{const[n,s]=Object(i.useState)(r.a.createElement(l.EuiLoadingContent,{lines:4,"data-test-subj":"exceptionItemListsTableLoading"})),[o,c]=Object(i.useState)(void 0);return Object(i.useEffect)((()=>{t?c(g):e||s(void 0)}),[t,e]),r.a.createElement(l.EuiPanel,{paddingSize:"none",hasShadow:!1,"data-test-subj":"exceptionItemLinkedToListSection"},r.a.createElement(f,{size:"xs"},r.a.createElement("h3",null,m)),r.a.createElement(l.EuiSpacer,{size:"s"}),r.a.createElement(l.EuiInMemoryTable,{tableCaption:"Table of exception lists",itemId:"id",message:n,loading:e,items:a,error:o,columns:Object(b.d)(),isSelectable:!1,sorting:!0,"data-test-subj":"exceptionItemSharedList"}))},h=r.a.memo(y);h.displayName="ExceptionsLinkedToLists";const E=p.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.linkedToRule.title",{defaultMessage:"Linked to rule"}),v=o()(l.EuiTitle).withConfig({displayName:"SectionHeader",componentId:"sc-xt2wcr-0"})(["",""],(()=>Object(s.css)(["font-weight:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold)))),x=({rule:e})=>r.a.createElement(r.a.Fragment,null,r.a.createElement(v,{size:"xs","data-test-subj":"exceptionItemLinkedToRuleSection"},r.a.createElement("h3",null,E)),r.a.createElement(l.EuiSpacer,{size:"s"}),r.a.createElement(l.EuiInMemoryTable,{tableCaption:"Rules table",itemId:"id",items:[e],columns:Object(b.c)(),sorting:!0,"data-test-subj":"addExceptionToRulesTable"})),k=r.a.memo(x);k.displayName="ExceptionsLinkedToRule";var S=a(711),j=a(718),O=a(190),w=a(656),T=a(712),I=a(657),C=a(517);const M=p.i18n.translate("xpack.securitySolution.ruleExceptions.editException.cancel",{defaultMessage:"Cancel"}),F=p.i18n.translate("xpack.securitySolution.ruleExceptions.editException.editExceptionTitle",{defaultMessage:"Edit rule exception"}),D=p.i18n.translate("xpack.securitySolution.ruleExceptions.editException.editEndpointExceptionTitle",{defaultMessage:"Edit endpoint exception"}),A=p.i18n.translate("xpack.securitySolution.ruleExceptions.editException.editRuleExceptionToastSuccessTitle",{defaultMessage:"Rule exception updated"}),_=p.i18n.translate("xpack.securitySolution.ruleExceptions.editException.editRuleExceptionToastErrorTitle",{defaultMessage:"Error updating exception"});var N=a(84),R=a(658);const P=o()(l.EuiFlyoutHeader).withConfig({displayName:"FlyoutHeader",componentId:"sc-18pz2hd-0"})(["",""],(({theme:e})=>Object(s.css)(["border-bottom:1px solid ",";"],e.eui.euiColorLightShade))),L=o()(l.EuiFlyoutBody).withConfig({displayName:"FlyoutBodySection",componentId:"sc-18pz2hd-1"})(["",""],(()=>Object(s.css)(["&.builder-section{overflow-y:scroll;}"]))),B=o()(l.EuiFlexGroup).withConfig({displayName:"FlyoutFooterGroup",componentId:"sc-18pz2hd-2"})(["",""],(({theme:e})=>Object(s.css)(["padding:",";"],e.eui.euiSizeS))),q=o()(l.EuiTitle).withConfig({displayName:"SectionHeader",componentId:"sc-18pz2hd-3"})(["",""],(()=>Object(s.css)(["font-weight:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold)))),z=({list:e,itemToEdit:t,rule:a,showAlertCloseOptions:s,openedFromListDetailPage:o,onCancel:m,onConfirm:g})=>{var f;const y=Object(i.useMemo)((()=>t.os_types),[t]),E=Object(i.useMemo)((()=>null!=a?[a]:null),[a]),v=Object(i.useMemo)((()=>e.type),[e]),{isLoading:x,indexPatterns:z}=Object(w.a)(E),[$,V]=(()=>{const{addSuccess:e,addError:t,addWarning:a}=Object(N.a)(),[n,r]=Object(R.a)(),[s,o]=Object(i.useState)(!1),l=Object(i.useRef)(null);return Object(i.useEffect)((()=>{let a=!0;const n=new AbortController;return l.current=async({itemsToUpdate:n})=>{var i,s;if(null!=r)try{o(!0),await r(n),e({title:A,text:(i=n.map((({name:e})=>e)).join(", "),s=n.length,p.i18n.translate("xpack.securitySolution.ruleExceptions.editException.editRuleExceptionToastSuccessText",{values:{exceptionItemName:i,numItems:s},defaultMessage:"{numItems, plural, =1 {Exception} other {Exceptions}} - {exceptionItemName} - {numItems, plural, =1 {has} other {have}} been updated."}))}),a&&o(!1)}catch(e){if(a)throw o(!1),t(e,{title:_}),new Error(e)}},()=>{a=!1,n.abort()}}),[e,t,a,r]),[s||n,l.current]})(),[U,H]=Object(T.a)(),[{exceptionItems:G,exceptionItemMeta:{name:Q},newComment:W,bulkCloseAlerts:K,disableBulkClose:Y,bulkCloseIndex:J,entryErrorExists:X},Z]=Object(i.useReducer)(((e,t)=>{switch(t.type){case"setExceptionItemMeta":{const{value:a}=t;return{...e,exceptionItemMeta:{...e.exceptionItemMeta,[a[0]]:a[1]}}}case"setComment":{const{comment:a}=t;return{...e,newComment:a}}case"setBulkCloseAlerts":{const{bulkClose:a}=t;return{...e,bulkCloseAlerts:a}}case"setDisableBulkCloseAlerts":{const{disableBulkCloseAlerts:a}=t;return{...e,disableBulkClose:a}}case"setBulkCloseIndex":{const{bulkCloseIndex:a}=t;return{...e,bulkCloseIndex:a}}case"setExceptionItems":{const{items:a}=t;return{...e,exceptionItems:a}}case"setConditionValidationErrorExists":{const{errorExists:a}=t;return{...e,entryErrorExists:a}}default:return e}}),{exceptionItems:[t],exceptionItemMeta:{name:t.name},newComment:"",bulkCloseAlerts:!1,disableBulkClose:!0,bulkCloseIndex:void 0,entryErrorExists:!1}),ee=Object(i.useMemo)((()=>null==a||!Object(u.b)(a.type)&&!Object(u.g)(a.type)&&!Object(u.d)(a.type)),[a]),[te,ae,ne,ie]=Object(I.a)();Object(i.useEffect)((()=>{null!=ie&&ie([{id:e.id,listId:e.list_id,namespaceType:e.namespace_type}])}),[e,ie]);const re=Object(i.useCallback)((e=>{Z({type:"setExceptionItems",items:e})}),[Z]),se=Object(i.useCallback)((e=>{Z({type:"setExceptionItemMeta",value:e})}),[Z]),oe=Object(i.useCallback)((e=>{Z({type:"setComment",comment:e})}),[Z]),le=Object(i.useCallback)((e=>{Z({type:"setBulkCloseAlerts",bulkClose:e})}),[Z]),ce=Object(i.useCallback)((e=>{Z({type:"setDisableBulkCloseAlerts",disableBulkCloseAlerts:e})}),[Z]),ue=Object(i.useCallback)((e=>{Z({type:"setBulkCloseIndex",bulkCloseIndex:e})}),[Z]),de=Object(i.useCallback)((e=>{Z({type:"setConditionValidationErrorExists",errorExists:e})}),[Z]),pe=Object(i.useCallback)((()=>{m(!1)}),[m]),me=Object(i.useCallback)((e=>e.every((e=>c.D.is(e)))),[]),ge=Object(i.useCallback)((async()=>{if(null!=V)try{const i=Object(b.a)({itemName:Q,commentToAdd:W,listType:v,selectedOs:t.os_types,items:G});if(me(i)){await V({itemsToUpdate:i});const t=null!=a?[a.rule_id]:[],r=null!=ne?ne[e.list_id].referenced_rules.map((({rule_id:e})=>e)):[],s=v===c.b.RULE_DEFAULT?t:r;null!=H&&!Object(n.isEmpty)(s)&&K&&await H(s,i,void 0,J),g(!0)}}catch(e){m(!1)}}),[V,Q,W,v,t.os_types,G,me,a,ne,e.list_id,H,K,g,J,m]),be=Object(i.useMemo)((()=>v===c.b.ENDPOINT?D:F),[v]),fe=Object(i.useMemo)((()=>$||U||G.every((e=>0===e.entries.length))||x||X),[x,X,G,$,U]);return r.a.createElement(l.EuiFlyout,{size:"l",onClose:pe,"data-test-subj":"editExceptionFlyout"},r.a.createElement(P,null,r.a.createElement(l.EuiTitle,null,r.a.createElement("h2",{"data-test-subj":"exceptionFlyoutTitle"},be)),r.a.createElement(l.EuiSpacer,{size:"m"})),x&&r.a.createElement(l.EuiLoadingContent,{"data-test-subj":"loadingEditExceptionFlyout",lines:4}),r.a.createElement(L,{className:"builder-section"},r.a.createElement(d.a,{exceptionItemName:Q,onChange:se}),r.a.createElement(l.EuiHorizontalRule,null),r.a.createElement(j.a,{exceptionItemName:Q,allowLargeValueLists:ee,exceptionListItems:[t],exceptionListType:v,indexPatterns:z,rules:E,selectedOs:y,showOsTypeOptions:v===c.b.ENDPOINT,isEdit:!0,onExceptionItemAdd:re,onSetErrorExists:de,onFilterIndexPatterns:O.h}),!o&&v===c.b.DETECTION&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.EuiHorizontalRule,null),r.a.createElement(h,{isLoadingReferences:te,errorFetchingReferences:ae,listAndReferences:null!=ne?[ne[e.list_id]]:[]})),!o&&v===c.b.RULE_DEFAULT&&null!=a&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.EuiHorizontalRule,null),r.a.createElement(k,{rule:a})),r.a.createElement(l.EuiHorizontalRule,null),r.a.createElement(C.a,{accordionTitle:r.a.createElement(q,{size:"xs"},r.a.createElement("h3",null,(ye=null!==(f=t.comments.length)&&void 0!==f?f:0,p.i18n.translate("xpack.securitySolution.ruleExceptions.editExceptionFlyout.commentsTitle",{values:{comments:ye},defaultMessage:"Add comments ({comments})"})))),exceptionItemComments:t.comments,newCommentValue:W,newCommentOnChange:oe}),s&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.EuiHorizontalRule,null),r.a.createElement(S.a,{exceptionListType:v,shouldBulkCloseAlert:K,disableBulkClose:Y,exceptionListItems:G,onDisableBulkClose:ce,onUpdateBulkCloseIndex:ue,onBulkCloseCheckboxChange:le}))),r.a.createElement(l.EuiFlyoutFooter,null,r.a.createElement(B,{justifyContent:"spaceBetween"},r.a.createElement(l.EuiButtonEmpty,{"data-test-subj":"cancelExceptionEditButton",onClick:pe},M),r.a.createElement(l.EuiButton,{"data-test-subj":"editExceptionConfirmButton",onClick:ge,isDisabled:fe,fill:!0},be))));var ye},$=r.a.memo(z);$.displayName="EditExceptionFlyout"},function(e,t,a){"use strict";a.d(t,"a",(function(){return F}));var n=a(4),i=a.n(n),r=a(32),s=a(87),o=a(34),l=a(33),c=a.n(l),u=a(627),d=a(102),p=a(628),m=a(101),g=a(388);const b=(e=[])=>e.filter((e=>!Object(o.isEmpty)(e))).map((e=>{const t=(e=>{const[t,a]=Object(g.a)(e);return null!=t&&null!=a?`${t}: "${a}"`:""})(e);return i.a.createElement(r.EuiFlexItem,{key:t,grow:!1},t)}));var f=a(0);const y=f.i18n.translate("xpack.securitySolution.ml.score.influencedByTitle",{defaultMessage:"Influenced By"}),h=f.i18n.translate("xpack.securitySolution.ml.score.maxAnomalyScoreTitle",{defaultMessage:"Max Anomaly Score"}),E=f.i18n.translate("xpack.securitySolution.ml.score.anomalyJobTitle",{defaultMessage:"Job"}),v=f.i18n.translate("xpack.securitySolution.ml.score.viewInMachineLearningLink",{defaultMessage:"View in Machine Learning"}),x=f.i18n.translate("xpack.securitySolution.ml.score.detectedTitle",{defaultMessage:"Detected"}),k=f.i18n.translate("xpack.securitySolution.ml.score.narrowToThisDateRangeLink",{defaultMessage:"Narrow to this date range"}),S=f.i18n.translate("xpack.securitySolution.ml.score.anomalousEntityTitle",{defaultMessage:"Anomalous Entity"});var j=a(629);const O=c()(r.EuiText).withConfig({displayName:"LargeScore",componentId:"sc-1ocpxoq-0"})(["font-size:45px;font-weight:lighter;"]);O.displayName="LargeScore";const w=(e,t,a,n,s)=>[{title:h,description:i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement(O,null,Object(p.a)(e.severity)))},{title:i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiSpacer,{size:"m"}),E),description:i.a.createElement(r.EuiFlexGroup,{direction:"column",gutterSize:"none",responsive:!1},i.a.createElement(r.EuiFlexItem,{grow:!1},e.jobId),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(j.a,{score:e,startDate:t,endDate:a,linkName:v})))},{title:x,description:i.a.createElement(r.EuiFlexGroup,{direction:"column",gutterSize:"none",responsive:!1},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(m.c,{value:new Date(e.time)})),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiLink,{"data-test-subj":"anomaly-description-narrow-range-link",onClick:()=>{s(e,n)},target:"_blank"},k)))},{title:S,description:i.a.createElement(r.EuiFlexGroup,{direction:"column",gutterSize:"none",responsive:!1},i.a.createElement(r.EuiFlexItem,{grow:!1},`${e.entityName}: "${e.entityValue}"`))},{title:y,description:i.a.createElement(r.EuiFlexGroup,{direction:"column",gutterSize:"none",responsive:!1},b(e.influencers))}],T=c()(r.EuiIcon).withConfig({displayName:"Icon",componentId:"sc-1pfd59a-0"})(["vertical-align:text-bottom;cursor:pointer;"]);T.displayName="Icon";const I=({jobKey:e,startDate:t,endDate:a,index:s=0,score:o,interval:l,narrowDateRange:c})=>{const[p,m]=Object(n.useState)(!1);return i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(u.a,{id:Object(d.h)(`anomaly-scores-${e}`),index:s,score:o})),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiPopover,{"data-test-subj":"anomaly-score-popover",id:"anomaly-score-popover",isOpen:p,onClick:()=>m(!p),closePopover:()=>m(!p),button:i.a.createElement(T,{type:"iInCircle"}),repositionOnScroll:!0},i.a.createElement(r.EuiDescriptionList,{"data-test-subj":"anomaly-description-list",listItems:w(o,t,a,l,c)}))))};I.displayName="AnomalyScoreComponent";const C=i.a.memo(I);C.displayName="AnomalyScore";const M=({anomalies:e,startDate:t,endDate:a,isLoading:n,narrowDateRange:l,limit:c})=>n?i.a.createElement(r.EuiLoadingSpinner,{"data-test-subj":"anomaly-score-spinner",size:"m"}):null==e||0===e.anomalies.length?Object(s.d)():i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiFlexGroup,{gutterSize:"none",responsive:!1},((e,t)=>{const a=e.reduce(((e,t)=>{const a=t.jobId,n=t.severity;return(null==e[a]||e[a].severity<n)&&(e[a]=t),e}),{}),n=Object(o.toArray)(a).sort(((e,t)=>t.severity-e.severity));return null==t?n:n.slice(0,t)})(e.anomalies,c).map(((n,r)=>{const s=(e=>`${e.jobId}-${e.severity}-${e.entityName}-${e.entityValue}`)(n);return i.a.createElement(C,{key:s,jobKey:s,startDate:t,endDate:a,index:r,score:n,interval:e.interval,narrowDateRange:l})}))));M.displayName="AnomalyScoresComponent";const F=i.a.memo(M);F.displayName="AnomalyScores"},function(e,t,a){"use strict";a.d(t,"a",(function(){return u})),a.d(t,"b",(function(){return d})),a.d(t,"c",(function(){return p})),a.d(t,"d",(function(){return m})),a.d(t,"e",(function(){return g}));const n=a(0).i18n.translate("xpack.securitySolution.components.ml.api.errors.statusCodeFailureTitle",{defaultMessage:"Status Code:"});var i=a(324),r=a(34);const s=e=>Object(r.has)("error.msg",e)&&Object(r.has)("error.response",e)&&Object(r.has)("error.statusCode",e),o=e=>Object(r.has)("error.error.reason",e),l=e=>{try{return JSON.stringify(JSON.parse(e),null,2)}catch(t){return e}};var c=a(77);const u=async({indexPatternName:e,signal:t})=>c.b.get().http.fetch(`/api/ml/modules/recognize/${e}`,{method:"GET",asSystemRequest:!0,signal:t}),d=async({moduleId:e="",signal:t})=>c.b.get().http.fetch(`/api/ml/modules/get_module/${e}`,{method:"GET",asSystemRequest:!0,signal:t}),p=async({configTemplate:e,indexPatternName:t="auditbeat-*",jobIdErrorFilter:a=[],groups:r=["security"],prefix:u=""})=>{const d=await c.b.get().http.fetch(`/api/ml/modules/setup/${e}`,{method:"POST",body:JSON.stringify({prefix:u,groups:r,indexPatternName:t,startDatafeed:!1,useDedicatedIndex:!0,applyToAllSpaces:!0}),asSystemRequest:!0});return((e,t=[])=>{const a=[...e.jobs.reduce(((e,a)=>{if(null!=a.error&&t.includes(a.id)){if(s(a))return[...e,a.error.msg,l(a.error.response),`${n} ${a.error.statusCode}`];if(o(a))return[a.error.error.reason]}return e}),[]),...e.datafeeds.reduce(((e,a)=>null!=a.error&&t.includes(a.id.substr("datafeed-".length))?[...e,a.error.msg,l(a.error.response),`${n} ${a.error.statusCode}`]:e),[])];if(a.length>0)throw new i.c(a)})(d,a),d},m=async({datafeedIds:e,start:t=0})=>{const a=await c.b.get().http.fetch("/api/ml/jobs/force_start_datafeeds",{method:"POST",body:JSON.stringify({datafeedIds:e,...0!==t&&{start:t}}),asSystemRequest:!0});return((e,t)=>{const a=t.reduce(((t,a)=>{const i=e[a];return s(i)?[...t,i.error.msg,l(i.error.response),`${n} ${i.error.statusCode}`]:o(i)?[i.error.error.reason]:t}),[]);if(a.length>0)throw new i.c(a)})(a,e),a},g=async({datafeedIds:e})=>{const t=await c.b.get().http.fetch("/api/ml/jobs/stop_datafeeds",{method:"POST",body:JSON.stringify({datafeedIds:e}),asSystemRequest:!0}),a="datafeed-";return[t,await c.b.get().http.fetch("/api/ml/jobs/close_jobs",{method:"POST",body:JSON.stringify({jobIds:e.map((e=>e.startsWith(a)?e.substring(a.length):e))}),asSystemRequest:!0})]}},function(e,t,a){"use strict";a.d(t,"o",(function(){return b})),a.d(t,"d",(function(){return f})),a.d(t,"h",(function(){return y})),a.d(t,"A",(function(){return h})),a.d(t,"B",(function(){return v})),a.d(t,"C",(function(){return x})),a.d(t,"w",(function(){return k})),a.d(t,"r",(function(){return S})),a.d(t,"s",(function(){return j})),a.d(t,"u",(function(){return T})),a.d(t,"z",(function(){return I})),a.d(t,"l",(function(){return C})),a.d(t,"c",(function(){return M})),a.d(t,"k",(function(){return F})),a.d(t,"j",(function(){return D})),a.d(t,"i",(function(){return A})),a.d(t,"G",(function(){return _})),a.d(t,"E",(function(){return N})),a.d(t,"e",(function(){return R})),a.d(t,"q",(function(){return P})),a.d(t,"f",(function(){return L})),a.d(t,"b",(function(){return B})),a.d(t,"a",(function(){return q})),a.d(t,"v",(function(){return $})),a.d(t,"H",(function(){return V})),a.d(t,"D",(function(){return U})),a.d(t,"F",(function(){return H})),a.d(t,"y",(function(){return G})),a.d(t,"x",(function(){return Q})),a.d(t,"t",(function(){return W})),a.d(t,"p",(function(){return K})),a.d(t,"g",(function(){return Y})),a.d(t,"n",(function(){return J})),a.d(t,"m",(function(){return X}));var n=a(821),i=a.n(n),r=a(108),s=a(347),o=a(513),l=a(144),c=a(465),u=a(466),d=a(467),p=a(512);var m=a(162);function g(e,t){return m.f(e.minimum,t.minimum)&&m.f(e.maximum,t.maximum)}function b(e){var t;return void 0!==(null===(t=e.tree)||void 0===t?void 0:t.pendingRequestParameters)}function f(e){return e.detectedBounds}function y(e){var t,a;return!(null===(t=e.tree)||void 0===t||!t.lastResponse||null!==(a=e.tree)&&void 0!==a&&a.lastResponse.successful)}function h(e){return e.resolverComponentInstanceID?e.resolverComponentInstanceID:""}const E=e=>{var t,a,n;return null!==(t=e.tree)&&void 0!==t&&null!==(a=t.lastResponse)&&void 0!==a&&a.successful?null===(n=e.tree)||void 0===n?void 0:n.lastResponse.result:void 0},v=e=>{var t,a,n,i,r;return!(null===(t=e.tree)||void 0===t||null===(a=t.lastResponse)||void 0===a||!a.successful)&&(null===(n=e.tree)||void 0===n||null===(i=n.lastResponse)||void 0===i||null===(r=i.result)||void 0===r?void 0:r.nodes.length)>0};function x(e){var t,a;if(null!==(t=e.tree)&&void 0!==t&&null!==(a=t.lastResponse)&&void 0!==a&&a.successful){var n;const{schema:t,dataSource:a}=null===(n=e.tree)||void 0===n?void 0:n.lastResponse;return{schema:t,dataSource:a}}}const k=Object(r.createSelector)(E,(function(e){return null==e?void 0:e.originID})),S=Object(r.createSelector)((e=>e.nodeData),(e=>t=>null==e?void 0:e.get(t))),j=Object(r.createSelector)(S,(e=>t=>{const a=e(t);return a?a.status:"loading"})),O=Object(r.createSelector)(E,(function(e){const t=new Map;if(null!=e&&e.nodes){for(const a of e.nodes){const e=l.b(a);void 0!==e&&t.set(e,a)}return[...t.values()]}return[]})),w=Object(r.createSelector)(O,k,(function(e,t){return o.b(e,t)})),T=Object(r.createSelector)(E,(e=>{if(e){const t=u.d(e);return e=>t.get(e)}return()=>{}})),I=Object(r.createSelector)(T,(e=>t=>{var a;return null===(a=e(t))||void 0===a?void 0:a.total}));function C(e){return e.currentRelatedEvent.loading}function M(e){return e.currentRelatedEvent.data}const F=Object(r.createSelector)(w,x,((e,t)=>{var a,n;return(null==t||null===(a=t.schema)||void 0===a||!a.ancestry)&&(null!==(n=e.generations)&&void 0!==n?n:0)>=u.c(null==t?void 0:t.schema)})),D=Object(r.createSelector)(w,(e=>{var t;return(null!==(t=e.descendants)&&void 0!==t?t:0)>=u.b()})),A=Object(r.createSelector)(w,x,((e,t)=>{var a;return(null!==(a=e.ancestors)&&void 0!==a?a:0)>=u.a(null==t?void 0:t.schema)}));function _(e){var t,a,n,i,r,s;return void 0===(null===(t=e.tree)||void 0===t?void 0:t.currentParameters)||d.a(null===(a=e.tree)||void 0===a?void 0:a.currentParameters,null===(n=e.tree)||void 0===n||null===(i=n.lastResponse)||void 0===i?void 0:i.parameters)||d.a(null===(r=e.tree)||void 0===r?void 0:r.currentParameters,null===(s=e.tree)||void 0===s?void 0:s.pendingRequestParameters)?null:e.tree.currentParameters}const N=Object(r.createSelector)((e=>{var t;return null===(t=e.tree)||void 0===t?void 0:t.currentParameters}),(function(e){const t=new Date(0),a=new Date(864e13),n={from:t.toISOString(),to:a.toISOString()};return void 0!==e&&(e.filters.from&&(n.from=e.filters.from),e.filters.to&&(n.to=e.filters.to)),n})),R=(Object(r.createSelector)(_,(e=>{var t;return null!==(t=null==e?void 0:e.indices)&&void 0!==t?t:[]})),Object(r.createSelector)((e=>{var t,a,n,i,r;return null!==(t=e.tree)&&void 0!==t&&null!==(a=t.lastResponse)&&void 0!==a&&a.successful?null===(n=e.tree)||void 0===n||null===(i=n.lastResponse)||void 0===i||null===(r=i.parameters)||void 0===r?void 0:r.indices:void 0}),(e=>e.indices),(function(e,t){var a;return null!==(a=null!=e?e:t)&&void 0!==a?a:[]}))),P=Object(r.createSelector)(w,k,(function(e,t){const a=p.a(e);if(!t)return a;if(null===o.f(e,t))return a;const n=p.b(a,t);return void 0===n?a:p.c(a,m.i(n,-1))})),L=Object(r.createSelector)(w,(e=>t=>o.f(e,t))),B=Object(r.createSelector)(P,L,(({ariaLevels:e},t)=>a=>{var n;const i=t(a);return i&&null!==(n=e.get(i))&&void 0!==n?n:null})),q=Object(r.createSelector)(w,L,((e,t)=>{const a=new Map;return function n(i){const r=a.get(i);if(void 0!==r)return r;const s=t(i);if(!s)throw new Error("could not find child event in process tree.");const c=o.a(e,l.d(s));let u=null;for(const e of c){if(null!==u){const t=l.b(u),n=l.b(e);void 0!==t&&void 0!==n&&a.set(t,n)}u=e}if(u){const e=l.b(u);void 0!==e&&a.set(e,null)}return n(i)}})),z=Object(r.createSelector)(P,(function({processNodePositions:e,edgeLineSegments:t}){const a=new i.a,n=[],r=[];for(const[t,a]of e){const[e,i]=a,r={minX:e-360,minY:i-120,maxX:e+360,maxY:i+120,position:a,entity:t,type:"treeNode"};n.push(r)}for(const e of t){const{points:[[t,a],[n,i]]}=e,s={minX:Math.min(t,n)-30,minY:Math.min(a,i)-30,maxX:Math.max(t,n)+30,maxY:Math.max(a,i)+30,entity:e,type:"edgeLine"};r.push(s)}return a.load([...n,...r]),a})),$=Object(r.createSelector)(z,(function(e){return Object(r.defaultMemoize)((t=>{const{minimum:[a,n],maximum:[i,r]}=t,s=e.search({minX:a,minY:n,maxX:i,maxY:r});return{processNodePositions:new Map(s.filter((e=>"treeNode"===e.type)).map((e=>[e.entity,e.position]))),connectingEdgeLineSegments:s.filter((e=>"edgeLine"===e.type)).map((e=>e.entity))}}),g)}));function V(e){var t,a,n;return void 0===(null===(t=e.tree)||void 0===t?void 0:t.pendingRequestParameters)||d.a(null===(a=e.tree)||void 0===a?void 0:a.pendingRequestParameters,null===(n=e.tree)||void 0===n?void 0:n.currentParameters)?null:e.tree.pendingRequestParameters}const U=Object(r.createSelector)(T,(e=>t=>{const a=l.b(t);if(void 0===a)return null;const n=e(a);return n?n.total:null})),H=Object(r.createSelector)(T,(e=>t=>{const a=e(t);return void 0===a?void 0:a.total})),G=Object(r.createSelector)(T,(e=>(t,a)=>{const n=e(t);return n?n.byCategory[a]:void 0})),Q=Object(r.createSelector)((e=>e.locationSearch),h,((e,t)=>Object(s.a)({locationSearch:e,resolverComponentInstanceID:t}))),W=e=>{var t,a;return null!==(t=null===(a=e.nodeEventsInCategory)||void 0===a?void 0:a.events)&&void 0!==t?t:[]},K=Object(r.createSelector)((e=>e.nodeEventsInCategory),Q,(function(e,t){return!(void 0===e||!c.a(e,t))&&null!==e.cursor})),Y=Object(r.createSelector)((e=>e.nodeEventsInCategory),Q,(function(e,t){return!(void 0===e||!c.a(e,t))&&e&&!0===e.error})),J=Object(r.createSelector)((e=>e.nodeEventsInCategory),Q,(function(e,t){const{panelView:a}=t;return"nodeEventsInCategory"===a&&void 0===e})),X=Object(r.createSelector)((e=>e.nodeEventsInCategory),Q,(function(e,t){return!(void 0===e||!c.a(e,t))&&e&&null!==e.lastCursorRequested&&e.cursor===e.lastCursorRequested}))},function(e,t,a){"use strict";a.d(t,"a",(function(){return S})),a.d(t,"b",(function(){return O}));var n=a(32),i=a(135),r=a(4),s=a.n(r),o=a(33),l=a.n(o),c=a(352),u=a(188),d=a(612),p=a(398),m=a(613),g=a(0);const b=g.i18n.translate("xpack.securitySolution.alertDetails.summary.readMore",{defaultMessage:"Read More"}),f=g.i18n.translate("xpack.securitySolution.alertDetails.summary.readLess",{defaultMessage:"Read Less"}),y=l()(n.EuiButtonEmpty).withConfig({displayName:"ReadMore",componentId:"sc-1bgugwj-0"})(["span.euiButtonContent{padding:0;}"]),h=l.a.div.withConfig({displayName:"ExpandedContent",componentId:"sc-1bgugwj-1"})(["max-height:33vh;overflow-wrap:break-word;overflow-x:hidden;overflow-y:auto;"]),E=l.a.div.withConfig({displayName:"StyledLineClamp",componentId:"sc-1bgugwj-2"})(["display:-webkit-box;-webkit-line-clamp:",";-webkit-box-orient:vertical;overflow:hidden;max-height:","em;height:","em;"],3,(({lineClampHeight:e})=>e),(({lineClampHeight:e})=>e)),v=({children:e,lineClampHeight:t=5.5})=>{const[a,n]=Object(r.useState)(null),[i,o]=Object(m.a)(e),l=Object(r.useCallback)((()=>{n((e=>!e))}),[]);return a?s.a.createElement(s.a.Fragment,null,s.a.createElement(h,{"data-test-subj":"expanded-line-clamp"},s.a.createElement("p",null,e)),i&&s.a.createElement(y,{onClick:l,size:"s","data-test-subj":"summary-view-readmore"},f)):s.a.createElement(s.a.Fragment,null,null==i||!0===i?s.a.createElement(E,{"data-test-subj":"styled-line-clamp",ref:o,lineClampHeight:t},e):e,i&&s.a.createElement(y,{onClick:l,size:"s","data-test-subj":"summary-view-readmore"},b))},x=s.a.memo(v),k=l.a.div.withConfig({displayName:"Indent",componentId:"sc-1d4zfzr-0"})(["padding:0 8px;word-break:break-word;"]),S=Object(r.createContext)({}),j=({data:e})=>{const t=Object(r.useMemo)((()=>{var t;const a=e.find((e=>"signal.rule.id"===e.field||e.field===i.L));return Array.isArray(null==a?void 0:a.originalValue)?null==a?void 0:a.originalValue[0]:null!==(t=null==a?void 0:a.originalValue)&&void 0!==t?t:null}),[e]),{rule:a}=Object(d.a)(t),o=Object(c.b)(e);return null!=a&&a.note?s.a.createElement(S.Provider,{value:o},s.a.createElement(n.EuiSpacer,{size:"l"}),s.a.createElement(n.EuiTitle,{size:"xxxs","data-test-subj":"summary-view-guide"},s.a.createElement("h5",null,u.j)),s.a.createElement(n.EuiSpacer,{size:"s"}),s.a.createElement(k,null,s.a.createElement(n.EuiText,{size:"xs"},s.a.createElement(x,{lineClampHeight:4.5},s.a.createElement(p.b,null,a.note))))):null},O=s.a.memo(j)},function(e,t,a){"use strict";a.d(t,"g",(function(){return s})),a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return l})),a.d(t,"a",(function(){return c})),a.d(t,"d",(function(){return m})),a.d(t,"e",(function(){return g})),a.d(t,"i",(function(){return b})),a.d(t,"h",(function(){return f})),a.d(t,"f",(function(){return y}));var n=a(207),i=a(172),r=a(138);const s=(e,t,a)=>{const{pagination:n,search:i,filters:r}=a||{};let s=[],o=[];return Array.isArray(e)&&e.length?(s=e.map((e=>e.list_id)),o=e.map((e=>e.namespace_type))):t&&(s=[t.list_id],o=[t.namespace_type]),{listIds:s,namespaceTypes:o,pagination:n,search:i,filters:r}},o=async({namespaceTypes:e,listIds:t,http:a,pagination:r,search:s})=>{try{const o=new AbortController,{pageIndex:l,pageSize:c,totalItemCount:u}=r||{},{page:d,per_page:p,total:m,data:g}=await Object(n.l)({filter:void 0,http:a,listIds:null!=t?t:[],namespaceTypes:null!=e?e:[],search:s,pagination:{perPage:c,page:(l||0)+1,total:u},signal:o.signal});return{data:g.map((e=>Object(i.b)(e))),pagination:{pageIndex:d-1,pageSize:p,totalItemCount:m}}}catch(e){throw new Error(e)}},l=async e=>{try{const t=new AbortController,{references:a}=await Object(r.h)({lists:e.map((e=>({id:e.id,listId:e.list_id,namespaceType:e.namespace_type}))),signal:t.signal});return a.reduce(((e,t)=>({...e,...t})),{})}catch(e){throw new Error(e)}},c=async({id:e,namespaceType:t,http:a})=>{try{const i=new AbortController;await Object(n.e)({http:a,id:e,namespaceType:t,signal:i.signal})}catch(e){throw new Error(e)}};var u=a(245),d=a(56),p=a(139);const m=async({id:e,http:t})=>{try{const a=new AbortController,i=Object(u.f)({filters:{list_id:e},namespaceTypes:["single","agnostic"],hideLists:p.a}),r=["single","agnostic"].join(),{data:s}=await Object(n.k)({filters:i,http:t,signal:a.signal,namespaceTypes:r,pagination:{}});return a.abort(),s&&s.length?s[0]:null}catch(e){throw new Error(e)}},g=async e=>{try{const t=new AbortController,{data:a}=await Object(r.f)({signal:t.signal,pagination:{page:1,perPage:1e4}});return t.abort(),a.reduce(((t,a,n)=>{var i;return(null===(i=a.exceptions_list)||void 0===i?void 0:i.find((t=>t.list_id===e)))&&t.push(a),t}),[])}catch(e){throw new Error(e)}},b=async({list:e,http:t})=>{try{const a=new AbortController;await Object(n.t)({http:t,list:e,signal:a.signal}),a.abort()}catch(e){throw new Error(e)}},f=async({rules:e,listId:t})=>{try{if(!e.length)return;const a=new AbortController;await Object(d.asyncForEach)(e,(async e=>{var n;const i=(null!==(n=e.exceptions_list)&&void 0!==n?n:[]).filter((({list_id:e})=>e!==t));await Object(r.k)({ruleProperties:{rule_id:e.rule_id,exceptions_list:i},signal:a.signal})}))}catch(e){throw new Error(e)}},y=async({rules:e,listId:t,id:a,listType:n,listNamespaceType:i})=>{try{if(!e.length)return;const s=new AbortController;await Object(d.asyncForEach)(e,(async e=>{var o;const l={list_id:t,id:a,type:n,namespace_type:i},c=[...null!==(o=e.exceptions_list)&&void 0!==o?o:[],l];await Object(r.k)({ruleProperties:{rule_id:e.rule_id,exceptions_list:c},signal:s.signal})}))}catch(e){throw new Error(e)}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var n=a(4),i=a.n(n),r=a(33),s=a.n(r),o=a(32),l=a(77),c=a(35);const u=({handleClick:e})=>i.a.createElement(o.EuiFlexGroup,{justifyContent:"flexEnd"},i.a.createElement(o.EuiFlexItem,{grow:!1},i.a.createElement(o.EuiButtonEmpty,{onClick:e,"data-test-subj":"osquery-empty-button"},i.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.footer.cancel",defaultMessage:"Cancel"})))),d=i.a.memo(u);var p=a(611);const m=s.a.div.withConfig({displayName:"OsqueryActionWrapper",componentId:"sc-18y9iwv-0"})(["padding:8px;"]),g=({agentId:e,defaultValues:t,onClose:a,ecsData:n})=>{const{services:{osquery:r}}=Object(l.k)();return null!=r&&r.OsqueryAction?i.a.createElement(o.EuiFlyout,{ownFocus:!0,maskProps:{style:"z-index: 5000"},size:"m",onClose:a},i.a.createElement(o.EuiFlyoutHeader,{hasBorder:!0,"data-test-subj":"flyout-header-osquery"},i.a.createElement(o.EuiTitle,null,i.a.createElement("h2",null,p.a))),i.a.createElement(o.EuiFlyoutBody,null,i.a.createElement(m,{"data-test-subj":"flyout-body-osquery"},i.a.createElement(r.OsqueryAction,{agentId:e,formType:"steps",defaultValues:t,ecsData:n}))),i.a.createElement(o.EuiFlyoutFooter,null,i.a.createElement(d,{handleClick:a,"data-test-subj":"flyout-footer-osquery"}))):null},b=i.a.memo(g)},function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return m})),a.d(t,"c",(function(){return g}));var n=a(144),i=a(162),r=a(513);const s=e=>{if(!e)return NaN;if("number"==typeof e)return e;let t=Date.parse(e);return Number.isNaN(t)&&(t=parseInt(e,10)),t},o=(e,t)=>{const a=s(e),n=s(t);if(Number.isNaN(a)||Number.isNaN(n))return;const i=n-a,r=36e5,o=24*r,l=7*o,c=30*o,u=365*o;let d,p,m;switch(!0){case i>=u:d=Math.floor(i/u),p="year",m="years";break;case i>=c:d=Math.floor(i/c),p="month",m="months";break;case i>=l:d=Math.floor(i/l),p="week",m="weeks";break;case i>=o:d=Math.floor(i/o),p="day",m="days";break;case i>=r:d=Math.floor(i/r),p="hour",m="hours";break;case i>=6e4:d=Math.floor(i/6e4),p="minute",m="minutes";break;case i>=1e3:d=Math.floor(i/1e3),p="second",m="seconds";break;case 0===i:d="<1",p="millisecond",m="millisecond";break;default:d=i,p="millisecond",m="milliseconds"}return{duration:d,durationType:1===d?p:m}};function l(e){const t=function(e){const t=new Map;if(0===r.e(e))return t;const a=[...r.c(e)].reverse();for(const i of a){const a=r.a(e,n.b(i)),s=a.reduce((function(e,a){var n;return e+(null!==(n=t.get(a))&&void 0!==n?n:0)}),0)+Math.max(0,a.length-1)*p;t.set(i,s)}return t}(e),a=function(e,t){const a=new Map;let n,r=0,s=0;for(const o of u(e,t))if(null===o.parent){const{node:e}=o;a.set(e,[0,0])}else{const{node:e,parent:t,isOnlyChild:l,width:c,parentWidth:u}=o;n!==t&&(r=0,s=0,n=t);const d=a.get(t);if(void 0===d)throw new Error;const m=u/-2+r*p+s+c/2;let g=-p;l||(g*=2);const b=i.a([m,g],d);a.set(e,b),r+=1,s+=c}return a}(e,t),s=function(e,t,a){const i=[];for(const s of u(e,t)){if(null===s.parent)continue;const{node:t,parent:l,parentWidth:c}=s,u=a.get(t),d=a.get(l),p=n.b(l),m=n.b(t);if(void 0===m)throw new Error("tried to graph a Resolver that had a node with without an id");const g=`edge:${null!=p?p:"undefined"}:${m}`;if(void 0===u||void 0===d)throw new Error;const b=n.a(l),f=n.a(t),y={elapsedTime:void 0!==b&&void 0!==f?o(b,f):void 0,reactKey:g},h=d[1]+(u[1]-d[1])/2,E={points:[[u[0],h],u],metadata:y},v=t===r.a(e,n.b(l))[0];if(s.isOnlyChild)i.push({points:[d,u],metadata:y});else if(v){const{firstChildWidth:e,lastChildWidth:t}=s,a={points:[d,[d[0],h]],metadata:{reactKey:`parentToMid${g}`}},n=c/-2+e/2,r=n+(c-e/2-t/2),o={points:[[d[0]+n,h],[d[0]+r,h]],metadata:{reactKey:`midway${g}`}};i.push(a,o,E)}else i.push(E)}return i}(e,t,a),l=[],m=new Map;for(const[e,t]of a)m.set(e,i.c(t,d));for(const e of s){const{points:[t,a]}=e,n={...e,points:[i.c(t,d),i.c(a,d)]};l.push(n)}return{processNodePositions:m,edgeLineSegments:l,ariaLevels:c(e)}}function c(e){const t=new Map;for(const a of r.c(e)){const n=r.d(e,a);if(void 0===n)t.set(a,1);else{const e=t.get(n);if(void 0===e)throw new Error("failed to calculate aria levels");t.set(a,e+1)}}return t}function*u(e,t){for(const a of r.c(e)){const i=r.d(e,a),s=t.get(a);if(void 0===s)throw new Error;if(void 0===i)yield{node:a,width:s,parent:null,parentWidth:null,isOnlyChild:null,firstChildWidth:null,lastChildWidth:null};else{const o=t.get(i);if(void 0===o)throw new Error;const l={node:a,width:s,parent:i,parentWidth:o},c=r.a(e,n.b(i));if(1===c.length)l.isOnlyChild=!0,l.lastChildWidth=s,l.firstChildWidth=s;else{const e=t.get(c[0]),a=t.get(c[c.length-1]);if(void 0===e||void 0===a)throw new Error;l.isOnlyChild=!1,l.firstChildWidth=e,l.lastChildWidth=a}yield l}}}const d=[Math.sqrt(2)/2,-Math.sqrt(2)/2,0,Math.sqrt(6)/6,Math.sqrt(6)/6,-Math.sqrt(6)/3,0,0,1],p=280;function m(e,t){for(const[a,i]of e.processNodePositions.entries())if(n.b(a)===t)return i}function g(e,t){return{processNodePositions:new Map([...e.processNodePositions.entries()].map((([e,a])=>[e,i.a(a,t)]))),edgeLineSegments:e.edgeLineSegments.map((({points:e,metadata:a})=>({points:[i.a(e[0],t),i.a(e[1],t)],metadata:a}))),ariaLevels:e.ariaLevels}}},function(e,t,a){"use strict";a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return c})),a.d(t,"f",(function(){return u})),a.d(t,"d",(function(){return d})),a.d(t,"e",(function(){return p})),a.d(t,"c",(function(){return m}));var n=a(342);function i({node:e,currentLevel:t,totalDescendants:a,children:n}){const r=n(e);if(r.length<=0)return{generations:t,descendants:a};let s=0,o=a;for(const e of r){const{generations:a,descendants:r}=i({node:e,currentLevel:t+1,totalDescendants:o+1,children:n});o=r,s=Math.max(s,a)}return{generations:s,descendants:o}}var r=a(144);function s(e,t){if(e)return i({node:e,currentLevel:0,totalDescendants:0,children:e=>{var a;return null!==(a=t.get(r.b(e)))&&void 0!==a?a:[]}})}function o(e,t){const a=r.d(e);return void 0===a?void 0:t.get(a)}function l(e,t){const a=new Map,i=new Map;for(const t of e){const e=r.b(t);if(void 0!==e){i.set(e,t);const n=r.d(t);let s=a.get(n);s||(s=[],a.set(n,s)),s.push(t)}}for(const e of a.values())e.sort(n.b);let l,c;if(t){const e=s(i.get(t),a);l=null==e?void 0:e.generations,c=null==e?void 0:e.descendants}const u=function(e,t){if(!e)return;let a=1,n=t.get(e);for(;void 0!==n&&void 0!==o(n,t);)a++,n=o(n,t);return a}(t,i);return{idToChildren:a,idToNode:i,originID:t,generations:l,descendants:c,ancestors:u}}function c(e,t){const a=e.idToChildren.get(t);return void 0===a?[]:a}function u(e,t){var a;return null!==(a=e.idToNode.get(t))&&void 0!==a?a:null}function d(e,t){return o(t,e.idToNode)}function p(e){return e.idToNode.size}function*m(e){const t=function(e){if(0===p(e))return null;let t=e.idToNode.values().next().value;for(;void 0!==d(e,t);)t=d(e,t);return t}(e);null!==t&&(yield*function*(e,t){let a=[e];for(;0!==a.length;){let e=[];for(const n of a)yield n,e.push(...t(n)||[]);a=e,e=[]}}(t,(t=>c(e,r.b(t)))))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return A}));var n=a(82),i=a.n(n),r=a(4),s=a.n(r),o=a(78),l=a(32),c=a(155),u=a(79),d=a(559),p=a(923),m=a(326),g=a(148),b=a(622),f=a(1),y=a(225),h=a(419),E=a(292),v=a(542),x=a(95),k=a(107),S=a(159),j=a(694),O=a(13),w=a(77);const T={meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:"event.kind",params:{query:"alert"}},query:{bool:{filter:[{bool:{should:[{match:{"event.kind":"alert"}}],minimum_should_match:1}}]}}};var I=a(568),C=a(267);const M="alertsOrEventsHistogramQuery",F="onlyExternalAlerts",D=({additionalFilters:e,deleteQuery:t,endDate:a,filterQuery:n,indexNames:C,setQuery:F,startDate:D,tableId:A})=>{const R=Object(o.useDispatch)(),{globalFullScreen:P}=Object(g.a)(),L=Object(k.a)("tGridEnabled"),[B]=Object(w.q)(f.Z),q=Object(O.b)().isEnterprise()?5:4,z=Object(r.useMemo)((()=>Object(h.a)(q)),[q]),$=_(),[V,U]=Object(r.useState)(null!=$&&$);N(V);const H=Object(r.useCallback)((()=>U((e=>!e))),[]),G=Object(r.useMemo)((()=>Object(y.d)(B,V)),[B,V]);Object(r.useEffect)((()=>{R(c.a.initializeTGridSettings({id:A,defaultColumns:p.a.columns.map((e=>L||null!=e.initialWidth?e:{...e,initialWidth:S.a})),title:b.e,showCheckboxes:!0,selectAll:!0}))}),[R,V,L,A]),Object(r.useEffect)((()=>()=>{t&&t({id:M})}),[t]);const Q=Object(r.useMemo)((()=>s.a.createElement(l.EuiCheckbox,{id:"showExternalAlertsCheckbox","data-test-subj":"showExternalAlertsCheckbox","aria-label":b.h,checked:V,color:"text",label:b.h,onChange:H})),[V,H]),W=Object(r.useMemo)((()=>({...p.a,excludedRowRendererIds:V?Object.values(u.d):[]})),[V]),K=Object(r.useMemo)((()=>V?[T,...e]:e),[e,V]),Y=Object(I.a)({localFilters:K,tableId:A,from:D,to:a,scopeId:x.SourcererScopeName.default}),J=Object(r.useMemo)((()=>({alertStatusActions:!1,customBulkActions:[Y]})),[Y]);return s.a.createElement(s.a.Fragment,null,!P&&s.a.createElement(m.a,i()({id:M,startDate:D,endDate:a,filterQuery:n,indexNames:C,setQuery:F},V?y.a:y.b,{subtitle:G})),s.a.createElement(d.a,{additionalFilters:Q,defaultCellActions:j.a,start:D,end:a,entityType:"events",leadingControlColumns:z,renderCellValue:v.a,rowRenderers:E.b,scopeId:x.SourcererScopeName.default,tableId:A,unit:V?b.b:b.f,defaultModel:W,pageFilters:K,bulkActions:J}))};D.displayName="EventsQueryTabBodyComponent";const A=s.a.memo(D);A.displayName="EventsQueryTabBody";const _=()=>{const e=Object(C.h)(),t=Object(C.g)(F),{decodedParam:a}=Object(r.useMemo)((()=>t()),[t]);return Object(r.useEffect)((()=>()=>{e([{key:F,value:null}])}),[e]),a},N=e=>{const t=Object(C.h)();Object(r.useEffect)((()=>{t([{key:F,value:e?"true":null}])}),[e,t])}},function(e,t,a){"use strict";a.d(t,"b",(function(){return m})),a.d(t,"c",(function(){return g})),a.d(t,"a",(function(){return f}));var n=a(32),i=a(4),r=a.n(i),s=a(33),o=a.n(s),l=a(88),c=a(89),u=a(0);const d=u.i18n.translate("xpack.securitySolution.certificate.fingerprint.clientCertLabel",{defaultMessage:"client cert"}),p=u.i18n.translate("xpack.securitySolution.certificate.fingerprint.serverCertLabel",{defaultMessage:"server cert"}),m="tls.client_certificate.fingerprint.sha1",g="tls.server_certificate.fingerprint.sha1",b=o.a.span.withConfig({displayName:"FingerprintLabel",componentId:"sc-196xyd5-0"})(["margin-right:5px;"]);b.displayName="FingerprintLabel";const f=r.a.memo((({eventId:e,certificateType:t,contextId:a,fieldName:i,isDraggable:s,value:o})=>r.a.createElement(l.c,{contextId:a,"data-test-subj":`${t}-certificate-fingerprint`,eventId:e,field:i,iconType:"snowflake",isDraggable:s,tooltipContent:r.a.createElement(n.EuiText,{size:"xs"},r.a.createElement("span",null,i)),value:o,isAggregatable:!0,fieldType:"keyword"},r.a.createElement(b,null,"client"===t?d:p),r.a.createElement(c.b,{certificateFingerprint:o||""}))));f.displayName="CertificateFingerprint"},function(e,t,a){"use strict";a.d(t,"a",(function(){return u})),a.d(t,"b",(function(){return p}));var n=a(4),i=a.n(n),r=a(33),s=a.n(r),o=a(88),l=a(89);const c=a(0).i18n.translate("xpack.securitySolution.ja3.fingerprint.ja3.fingerprintLabel",{defaultMessage:"ja3"}),u="tls.fingerprints.ja3.hash",d=s.a.span.withConfig({displayName:"Ja3FingerprintLabel",componentId:"sc-134zbkz-0"})(["margin-right:5px;"]);d.displayName="Ja3FingerprintLabel";const p=i.a.memo((({contextId:e,eventId:t,fieldName:a,isDraggable:n,value:r})=>i.a.createElement(o.c,{contextId:e,"data-test-subj":"ja3-hash",eventId:t,field:a,iconType:"snowflake",isDraggable:n,value:r,isAggregatable:!0,fieldType:"keyword"},i.a.createElement(d,null,c),i.a.createElement(l.e,{"data-test-subj":"ja3-hash-link",ja3Fingerprint:r||""}))));p.displayName="Ja3Fingerprint"},function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var n=a(4),i=a.n(n),r=a(33),s=a.n(r),o=a(32),l=a(0);const c=l.i18n.translate("xpack.securitySolution.rule_exceptions.itemComments.unknownAvatarName",{defaultMessage:"Uknown"}),u=l.i18n.translate("xpack.securitySolution.rule_exceptions.itemComments.addCommentPlaceholder",{defaultMessage:"Add a new comment..."});var d=a(77),p=a(190);const m="exceptionCommentAccordionButton",g=s()(o.EuiAvatar).withConfig({displayName:"MyAvatar",componentId:"sc-iqe126-0"})(["",""],(({theme:e})=>Object(r.css)(["margin-right:",";"],e.eui.euiSizeS))),b=s()(o.EuiAccordion).withConfig({displayName:"CommentAccordion",componentId:"sc-iqe126-1"})(["",""],(({theme:e})=>Object(r.css)([".","{color:",";padding:"," 0;}"],m,e.eui.euiColorPrimary,e.eui.euiSizeM))),f=Object(n.memo)((function({exceptionItemComments:e,newCommentValue:t,accordionTitle:a,newCommentOnChange:r}){const[s,f]=Object(n.useState)(!1),y=Object(d.g)(),h=null==y?void 0:y.fullName,E=null==y?void 0:y.username,v=null==y?void 0:y.email,x=Object(n.useMemo)((()=>h&&h.length>0?h:v&&v.length>0?v:E&&E.length>0?E:c),[h,v,E]),k=Object(n.useCallback)((e=>{r(e.target.value)}),[r]),S=Object(n.useCallback)((e=>{f(e)}),[]),j=Object(n.useMemo)((()=>{return e&&e.length>0?i.a.createElement(o.EuiText,{size:"s","data-test-subj":"ExceptionItemCommentsAccordionButton"},s?(e=>l.i18n.translate("xpack.securitySolution.rule_exceptions.itemComments.hideCommentsLabel",{values:{comments:e},defaultMessage:"Hide ({comments}) {comments, plural, =1 {Comment} other {Comments}}"}))(e.length):(t=e.length,l.i18n.translate("xpack.securitySolution.rule_exceptions.itemComments.showCommentsLabel",{values:{comments:t},defaultMessage:"Show ({comments}) {comments, plural, =1 {Comment} other {Comments}}"}))):null;var t}),[s,e]),O=Object(n.useMemo)((()=>e&&e.length>0?Object(p.j)(e):[]),[e]);return i.a.createElement("div",null,i.a.createElement(b,{id:"add-exception-comments-accordion",buttonClassName:m,buttonContent:null!=a?a:j,"data-test-subj":"exceptionItemCommentsAccordion",onToggle:e=>S(e)},i.a.createElement(o.EuiCommentList,{comments:O}),i.a.createElement(o.EuiFlexGroup,{gutterSize:"none"},i.a.createElement(o.EuiFlexItem,{grow:!1},i.a.createElement(g,{name:x,size:"l","data-test-subj":"exceptionItemCommentAvatar"})),i.a.createElement(o.EuiFlexItem,{grow:1},i.a.createElement(o.EuiTextArea,{placeholder:u,"aria-label":"Comment Input",value:t,onChange:k,fullWidth:!0,"data-test-subj":"newExceptionItemCommentTextArea"})))))}))},function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(4),i=a(84),r=a(17),s=a(507),o=a(0);const l=o.i18n.translate("xpack.securitySolution.components.mlPopup.hooks.errors.startJobFailureTitle",{defaultMessage:"Start job failure"}),c=o.i18n.translate("xpack.securitySolution.components.mlPopup.hooks.errors.stopJobFailureTitle",{defaultMessage:"Stop job failure"}),u=o.i18n.translate("xpack.securitySolution.components.mlPopup.hooks.errors.createJobFailureTitle",{defaultMessage:"Create job failure"}),d=()=>{const{addError:e}=Object(i.a)(),[t,a]=Object(n.useState)(!1);return{enableDatafeed:Object(n.useCallback)((async(t,n,i)=>{if(p(t,i),!t.isInstalled){a(!0);try{await Object(s.c)({configTemplate:t.moduleId,indexPatternName:t.defaultIndexPattern,jobIdErrorFilter:[t.id],groups:t.groups}),a(!1)}catch(t){return e(t,{title:u}),void a(!1)}}const o=new Date,d=o.setDate(o.getDate()-14);if(a(!0),i){const a=Math.max(n,d);try{await Object(s.d)({datafeedIds:[`datafeed-${t.id}`],start:a})}catch(t){Object(r.e)(r.a.COUNT,r.b.JOB_ENABLE_FAILURE),e(t,{title:l})}}else try{await Object(s.e)({datafeedIds:[`datafeed-${t.id}`]})}catch(t){Object(r.e)(r.a.COUNT,r.b.JOB_DISABLE_FAILURE),e(t,{title:c})}a(!1)}),[e]),isLoading:t}},p=(e,t)=>{Object(r.e)(r.a.COUNT,e.isElasticJob?t?r.b.SIEM_JOB_ENABLED:r.b.SIEM_JOB_DISABLED:t?r.b.CUSTOM_JOB_ENABLED:r.b.CUSTOM_JOB_DISABLED)}},function(e,t,a){"use strict";a.d(t,"a",(function(){return v})),a.d(t,"b",(function(){return x}));var n=a(4),i=a(1),r=a(131),s=a(2),o=a(156),l=a(17),c=a(238),u=a(39),d=a(138),p=a(569),m=a(392),g=a(570),b=a(338);const f=["POST",i.nb];var y=a(496),h=a(681),E=a(682);const v=(e,t)=>{t(i.B,{deepLinkId:s.a.rules,path:Object(o.b)(null!=e?e:"")})},x=e=>{const{mutateAsync:t}=(e=>{const t=Object(m.b)(),a=Object(b.b)(),n=Object(g.b)(),i=Object(p.b)(),s=Object(m.c)();return Object(u.useMutation)((e=>Object(d.l)(e)),{...e,mutationKey:f,onSettled:(...e)=>{var o,l,c,u,d,p;const[m,g,{bulkAction:{type:b}}]=e,f=null!==(o=null==m||null===(l=m.attributes)||void 0===l||null===(c=l.results)||void 0===c?void 0:c.updated)&&void 0!==o?o:null==g||null===(u=g.body)||void 0===u||null===(d=u.attributes)||void 0===d||null===(p=d.results)||void 0===p?void 0:p.updated;switch(b){case r.b.enable:case r.b.disable:a(),f?s(f):t();break;case r.b.delete:t(),a(),n(),i();break;case r.b.duplicate:t(),i();break;case r.b.edit:f?s(f):t(),a(),n()}}})})(),a=Object(h.a)(),i=Object(y.a)(),s=Object(E.a)(),o=Object(c.c)(),v=null==o?void 0:o.actions.setLoadingRules;return{executeBulkAction:Object(n.useCallback)((async n=>{try{var o;null==v||v({ids:null!==(o=n.ids)&&void 0!==o?o:s(n.type),action:n.type});const i=await t({bulkAction:n});return function(e,t){e!==r.b.disable&&e!==r.b.enable||(t.attributes.results.updated.some((e=>e.immutable))&&Object(l.e)(l.a.COUNT,e===r.b.enable?l.b.SIEM_RULE_ENABLED:l.b.SIEM_RULE_DISABLED),t.attributes.results.updated.some((e=>!e.immutable))&&Object(l.e)(l.a.COUNT,e===r.b.disable?l.b.CUSTOM_RULE_DISABLED:l.b.CUSTOM_RULE_ENABLED))}(n.type,i),null!=e&&e.suppressSuccessToast||a({actionType:n.type,summary:i.attributes.summary,editPayload:n.type===r.b.edit?n.editPayload:void 0}),i}catch(e){i({actionType:n.type,error:e})}finally{null==v||v({ids:[],action:null})}}),[null==e?void 0:e.suppressSuccessToast,s,v,t,a,i])}}},function(e,t,a){"use strict";a.d(t,"b",(function(){return w})),a.d(t,"a",(function(){return T}));var n=a(92),i=a.n(n),r=a(34),s=a(4),o=a(78),l=a(11),c=a(42),u=a(77),d=a(126),p=a(86),m=a(614),g=a(99),b=a(85);const f=a(0).i18n.translate("xpack.securitySolution.timelineEvents.errorSearchDescription",{defaultMessage:"An error has occurred on timeline events search"});var y=a(79),h=a(183),E=a(228),v=a(84),x=a(231),k=a(1);const S="timelineEventsQuery",j=[{field:"@timestamp",direction:b.b.asc,type:"date",esTypes:["date"]}],O=e=>({...Object(r.isEmpty)(null==e?void 0:e.eventCategoryField)?{}:{eventCategoryField:null==e?void 0:e.eventCategoryField},...Object(r.isEmpty)(null==e?void 0:e.size)?{}:{size:null==e?void 0:e.size},...Object(r.isEmpty)(null==e?void 0:e.tiebreakerField)?{}:{tiebreakerField:null==e?void 0:e.tiebreakerField},...Object(r.isEmpty)(null==e?void 0:e.timestampField)?{}:{timestampField:null==e?void 0:e.timestampField}}),w=({dataViewId:e,endDate:t,eqlOptions:a,id:n=S,indexNames:w,fields:T,filterQuery:I,runtimeMappings:C,startDate:M,language:F="kuery",limit:D,sort:A=j,skip:_=!1,timerangeKind:N})=>{const[{pageName:R}]=Object(h.a)(),P=Object(o.useDispatch)(),{data:L}=Object(u.k)().services,B=Object(s.useRef)(r.noop),q=Object(s.useRef)(new AbortController),z=Object(s.useRef)(new l.Subscription),[$,V]=Object(s.useState)(!1),[U,H]=Object(s.useState)(n===y.j.active?E.a.getActivePage():0),[G,Q]=Object(s.useState)(null),W=Object(s.useRef)(null),{startTracking:K}=Object(x.a)(),Y=Object(s.useCallback)((()=>{null!=n&&m.a.some((e=>e===n))&&(P(p.a.clearEventsLoading({id:n})),P(p.a.clearEventsDeleted({id:n})))}),[P,n]),J=Object(s.useCallback)((e=>{Y(),n===y.j.active&&(E.a.setExpandedDetail({}),E.a.setActivePage(e)),H(e)}),[Y,n]),X=Object(s.useCallback)((()=>{null!=B.current&&B.current(),J(0)}),[J]),Z=Object(s.useCallback)((e=>{P(p.a.setTimelineUpdatedAt({id:n,updated:e}))}),[P,n]),[ee,te]=Object(s.useState)({id:n,inspect:{dsl:[],response:[]},refetch:X,totalCount:-1,pageInfo:{activePage:0,querySize:0},events:[],loadPage:J,updatedAt:0}),{addWarning:ae}=Object(v.a)(),ne=Object(s.useCallback)((async(t,a)=>{if(null==t||""===R||_)return;const i=async()=>{W.current=t,q.current=new AbortController,V(!0);const{endTracking:i}=K({name:`${k.B} timeline events search`});z.current=L.search.search(t,{strategy:"eql"===t.language?"timelineEqlSearchStrategy":"timelineSearchStrategy",abortSignal:q.current.signal,indexPattern:{id:e}}).subscribe({next:e=>{Object(c.isCompleteResponse)(e)?(i("success"),V(!1),te((i=>{const r={...i,events:(s=e.edges,s.map((e=>e.node))),inspect:Object(g.getInspectResponse)(e,i.inspect),pageInfo:e.pageInfo,totalCount:e.totalCount,updatedAt:Date.now()};var s;return Z(r.updatedAt),n===y.j.active&&(E.a.setExpandedDetail({}),E.a.setPageName(R),"eql"===t.language?(E.a.setEqlRequest(t),E.a.setEqlResponse(r)):(E.a.setRequest(t),E.a.setResponse(r))),a&&a(r),r})),z.current.unsubscribe()):Object(c.isErrorResponse)(e)&&(i("invalid"),V(!1),ae(f),z.current.unsubscribe())},error:e=>{i(q.current.signal.aborted?"aborted":"error"),V(!1),L.search.showError(e),z.current.unsubscribe()}})};if(n===y.j.active&&""!==E.a.getPageName()&&R!==E.a.getPageName()){if(E.a.setPageName(R),q.current.abort(),V(!1),"eql"===t.language?(W.current=E.a.getEqlRequest(),B.current=i.bind(null,E.a.getEqlRequest())):(W.current=E.a.getRequest(),B.current=i.bind(null,E.a.getRequest())),te((e=>{const a="eql"===t.language?E.a.getEqlResponse():E.a.getResponse();return null!=a?{...a,refetch:X,loadPage:J}:e})),"eql"!==t.language&&null!=E.a.getResponse())return;if("eql"===t.language&&null!=E.a.getEqlResponse())return}z.current.unsubscribe(),q.current.abort(),await i(),B.current=i}),[R,_,n,K,L.search,e,Z,ae,X,J]);Object(s.useEffect)((()=>{0!==w.length&&Q((e=>{var r,s,o,l,c,u;const p=e,m={defaultIndex:null!==(r=null==e?void 0:e.defaultIndex)&&void 0!==r?r:[],filterQuery:null!==(s=null==e?void 0:e.filterQuery)&&void 0!==s?s:"",querySize:null!==(o=null==e?void 0:e.pagination.querySize)&&void 0!==o?o:0,sort:null!==(l=null==e?void 0:e.sort)&&void 0!==l?l:j,timerange:null!==(c=null==e?void 0:e.timerange)&&void 0!==c?c:{},runtimeMappings:null!==(u=null==e?void 0:e.runtimeMappings)&&void 0!==u?u:{},...O(p)},g=M&&t?{timerange:{interval:"12h",from:M,to:t}}:{},f={defaultIndex:w,filterQuery:Object(d.a)(I),querySize:D,sort:A,runtimeMappings:C,...g,...O(a)},h=i()(m,f)?U:0,v={defaultIndex:w,factoryQueryType:b.z.all,fieldRequested:T,fields:T,filterQuery:Object(d.a)(I),pagination:{activePage:h,querySize:D},language:F,runtimeMappings:C,sort:A,...g,...a||{}};return U!==h&&(H(h),n===y.j.active&&E.a.setActivePage(h)),i()(e,v)?e:v}))}),[P,w,U,t,a,I,n,F,D,M,A,T,C]);const ie=Object(s.useCallback)((async e=>{n===y.j.active&&"absolute"!==N&&i()(W.current,G)||await ne(G,e)}),[n,G,ne,N]);return Object(s.useEffect)((()=>{Object(r.isEmpty)(I)&&te({id:n,inspect:{dsl:[],response:[]},refetch:X,totalCount:-1,pageInfo:{activePage:0,querySize:0},events:[],loadPage:J,updatedAt:0})}),[I,n,X,J]),[$,ee,ie]},T=({dataViewId:e,endDate:t,eqlOptions:a,id:n=S,indexNames:i,fields:r,filterQuery:o,runtimeMappings:l,startDate:c,language:u="kuery",limit:d,sort:p=j,skip:m=!1,timerangeKind:g})=>{const[b,f,y]=w({dataViewId:e,endDate:t,eqlOptions:a,id:n,indexNames:i,fields:r,filterQuery:o,runtimeMappings:l,startDate:c,language:u,limit:d,sort:p,skip:m,timerangeKind:g});return Object(s.useEffect)((()=>{y&&y()}),[y]),[b,f]}},,,function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return s}));var n=a(93),i=a(110);const r=["item_id","name","description","entries.value"],s={name:i.i,namespace_type:"agnostic",description:i.g,list_id:i.h,type:n.b.ENDPOINT_HOST_ISOLATION_EXCEPTIONS}},,,,,function(e,t,a){t.set=t.assoc=t.assocPath=a(745),t.setWith=a(809)},function(e,t,a){"use strict";a.d(t,"d",(function(){return l})),a.d(t,"b",(function(){return c})),a.d(t,"c",(function(){return u})),a.d(t,"a",(function(){return d}));var n=a(4),i=a.n(n),r=a(287);const s=Object(r.c)(),o=Object(r.c)(),l=()=>{const[e]=Object(n.useState)(s);return{portalNode:e}},c=i.a.memo((()=>{const{portalNode:e}=l();return i.a.createElement(r.b,{node:e})}));c.displayName="TimelineEventsCountBadge";const u=()=>{const[e]=Object(n.useState)(o);return{portalNode:e}},d=i.a.memo((()=>{const{portalNode:e}=u();return i.a.createElement(r.b,{node:e})}));d.displayName="EqlEventsCountBadge"},function(e,t,a){"use strict";a.d(t,"a",(function(){return y})),a.d(t,"b",(function(){return E}));var n=a(32),i=a(4),r=a.n(i),s=a(33),o=a.n(s),l=a(90),c=a(546),u=a(554),d=a(556),p=a(862),m=a(863),g=a(864),b=a(194);const f=o.a.div.withConfig({displayName:"Wrapper",componentId:"sc-1gqlwr5-0"})(["&.viz-actions{position:absolute;top:0;right:0;z-index:1;}&.histogram-viz-actions{padding:",";}"],(({theme:e})=>e.eui.euiSizeS)),y="histogram-actions-trigger",h=({className:e,getLensAttributes:t,inputId:a=l.a.global,inspectIndex:s=0,isInspectButtonDisabled:o,isMultipleQuery:h,lensAttributes:E,onCloseInspect:v,queryId:x,timerange:k,title:S,stackByField:j})=>{const{lens:O}=Object(c.b)().services,{canUseEditor:w,navigateToPrefilledEditor:T}=O,[I,C]=Object(i.useState)(!1),[M,F]=Object(i.useState)(!1),D=Object(i.useCallback)((()=>{C(!I)}),[I]),A=()=>{C(!1)},_=Object(p.a)({lensAttributes:E,getLensAttributes:t,stackByField:j}),N=`stat-${x}`,{disabled:R,onAddToExistingCaseClicked:P}=Object(m.a)({onAddToCaseClicked:A,lensAttributes:_,timeRange:k}),{onAddToNewCaseClicked:L,disabled:B}=Object(g.a)({onClick:A,timeRange:k,lensAttributes:_}),q=Object(i.useCallback)((()=>{A(),k&&_&&T({id:"",timeRange:k,attributes:_},{openInNewTab:!0})}),[_,T,k]),z=Object(i.useCallback)((()=>{A(),F(!0)}),[]),$=Object(i.useCallback)((()=>{F(!1),v&&v()}),[v]),{additionalRequests:V,additionalResponses:U,handleClick:H,handleCloseModal:G,isButtonDisabled:Q,request:W,response:K}=Object(d.a)({inputId:a,inspectIndex:s,isDisabled:o,multiple:h,onCloseInspect:$,onClick:z,queryId:x}),Y=Object(i.useMemo)((()=>!w()||null==_),[_,w]),J=Object(i.useMemo)((()=>[r.a.createElement(n.EuiContextMenuItem,{icon:"inspect",key:"visualizationActionsInspect",onClick:H,disabled:Q,"data-test-subj":"viz-actions-inspect"},b.i),r.a.createElement(n.EuiContextMenuItem,{icon:"visArea",key:"visualizationActionsOpenInLens","data-test-subj":"viz-actions-open-in-lens",disabled:Y,onClick:q},b.k),r.a.createElement(n.EuiContextMenuItem,{disabled:B,icon:"plusInCircle",key:"visualizationActionsAddToNewCase",onClick:L,"data-test-subj":"viz-actions-add-to-new-case"},b.c),r.a.createElement(n.EuiContextMenuItem,{disabled:R,"data-test-subj":"viz-actions-add-to-existing-case",icon:"plusInCircle",key:"visualizationActionsAddToExistingCase",onClick:P},b.b)]),[Q,Y,H,R,B,P,L,q]),X=Object(i.useMemo)((()=>r.a.createElement(n.EuiButtonIcon,{"aria-label":b.j,className:y,"data-test-subj":N,iconType:"boxesHorizontal",onClick:D})),[N,D]);return r.a.createElement(f,{className:e},null!==W&&null!==K&&r.a.createElement(n.EuiPopover,{button:X,isOpen:I,closePopover:A,panelPaddingSize:"none",anchorPosition:"downLeft",panelClassName:"withHoverActions__popover"},r.a.createElement(n.EuiContextMenuPanel,{"data-test-subj":"viz-actions-panel",size:"s",items:J})),M&&null!==W&&null!==K&&r.a.createElement(u.a,{additionalRequests:V,additionalResponses:U,closeModal:G,inputId:a,request:W,response:K,title:S}))};h.displayName="VisualizationActionsComponent";const E=r.a.memo(h)},function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i})),a.d(t,"d",(function(){return r})),a.d(t,"c",(function(){return s}));const n="kibana.alert.rule.name",i="host.name",r=300,s=500},function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return c}));var n=a(4),i=a(37),r=a(94),s=a(175);const o=({setQuery:e,response:t,request:a,refetch:i,uniqueQueryId:r,deleteQuery:s,loading:o})=>{Object(n.useEffect)((()=>(null!=i&&null!=e&&e({id:r,inspect:{dsl:[a],response:[t]},loading:o,refetch:i}),()=>{s&&s({id:r})})),[e,o,t,a,i,r,s])};function l(e){const t=[];for(const[a,n]of Object.entries(e))!0===n.aggregatable&&t.push({label:a,value:a});return t}const c=()=>{const{pathname:e}=Object(i.useLocation)(),{browserFields:t}=Object(r.d)(Object(r.a)(e)),a=Object(n.useMemo)((()=>Object(s.a)(t)),[t]),[o,c]=Object(n.useState)((()=>l(a)));return Object(n.useEffect)((()=>{c(l(a))}),[a]),Object(n.useMemo)((()=>o),[o])}},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=e=>`${e.entityName}-${e.entityValue}-${e.severity}-${e.jobId}`},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=async({http:e,jobIds:t,signal:a})=>e.fetch("/api/ml/jobs/jobs_summary",{method:"POST",body:JSON.stringify({jobIds:null!=t?t:[]}),asSystemRequest:!0,signal:a})},function(e,t,a){"use strict";a.d(t,"d",(function(){return p})),a.d(t,"c",(function(){return m})),a.d(t,"f",(function(){return g})),a.d(t,"e",(function(){return b})),a.d(t,"b",(function(){return f})),a.d(t,"a",(function(){return h}));var n=a(166),i=a(296),r=a(156),s=a(113),o=a(2),l=a(1),c=a(167),u=a(374),d=a(310);const p=[c.b.defineRule,c.b.aboutRule,c.b.scheduleRule,c.b.ruleActions],m=(e,t)=>{var a,n,i;let c=[];var d,p,m;return e.detailName&&null!==(a=e.state)&&void 0!==a&&a.ruleName&&(c=[...c,{text:e.state.ruleName,href:t({deepLinkId:o.a.rules,path:Object(r.d)(e.detailName,"")})}]),e.detailName&&null!==(n=e.state)&&void 0!==n&&n.ruleName&&e.tabName&&(c=[...c,{text:(d=e.tabName,null!==(p=u.a[d])&&void 0!==p?p:u.a[u.b.alerts]),href:t({deepLinkId:o.a.rules,path:Object(r.c)(e.detailName,e.tabName,"")})}]),(m=e.pathName).includes(l.lc)&&m.includes("/create")&&(c=[...c,{text:s.e,href:""}]),(e=>e.includes(l.lc)&&e.includes("/edit"))(e.pathName)&&e.detailName&&null!==(i=e.state)&&void 0!==i&&i.ruleName&&(c=[...c,{text:s.Ab,href:""}]),c},g={anomalyThreshold:50,index:[],indexPattern:{fields:[],title:""},machineLearningJobId:[],ruleType:"query",threatIndex:[],queryBar:{query:{query:"",language:"kuery"},filters:[],saved_id:null},threatQueryBar:{query:{query:l.fb,language:"kuery"},filters:[],saved_id:null},requiredFields:[],relatedIntegrations:[],threatMapping:[],threshold:{field:[],value:"200",cardinality:{field:[],value:""}},timeline:{id:null,title:i.b},eqlOptions:{},dataSourceType:c.a.IndexPatterns,newTermsFields:[],historyWindowSize:"7d",shouldLoadQueryDynamically:!1,groupByFields:[]},b={author:[],name:"",description:"",isAssociatedToEndpointList:!1,isBuildingBlock:!1,severity:{value:"low",mapping:Object(d.b)([]),isMappingChecked:!1},riskScore:{value:21,mapping:[],isMappingChecked:!1},references:[""],falsePositives:[""],license:"",ruleNameOverride:"",tags:[],timestampOverride:"",threat:[{framework:"MITRE ATT&CK",tactic:{id:"none",name:"none",reference:"none"},technique:[]}],note:"",threatIndicatorPath:void 0,timestampOverrideFallbackDisabled:void 0},f=e=>({interval:Object(n.f)(e)?"1h":"5m",from:Object(n.f)(e)?"5m":"1m"}),y={...g.queryBar,query:{...g.queryBar.query,query:"*:*"}},h={forNormalRules:g.queryBar,forThreatMatchRules:y}},function(e,t,a){"use strict";let n;a.d(t,"a",(function(){return n})),function(e){e.withExceptions="withExceptions",e.withoutExceptions="withoutExceptions"}(n||(n={}))},function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(82),i=a.n(n),r=a(4),s=a.n(r),o=a(35),l=a(32),c=a(33),u=a.n(c),d=a(243);const p=u()(l.EuiButtonEmpty).withConfig({displayName:"EuiButtonEmptyStyled",componentId:"sc-mu7mbz-0"})(["margin-bottom:",";.euiIcon{width:",";height:",";}.text{font-size:",";margin-inline-start:",";}"],(({theme:e})=>e.eui.euiSizeS),(({theme:e})=>e.eui.euiSizeM),(({theme:e})=>e.eui.euiSizeM),(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.euiSizeXS)),m=Object(r.memo)((({backButtonLabel:e,backButtonUrl:t,onBackButtonNavigateTo:a,...n})=>{const r=Object(d.a)(...a);return s.a.createElement(p,i()({"data-test-subj":"backToOrigin"},n,{flush:"left",size:"xs",iconType:"arrowLeft",href:t,onClick:r,textProps:{className:"text"}}),e||s.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.list.backButton",defaultMessage:"Back"}))}));m.displayName="BackToExternalAppButton"},function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(4),i=a.n(n),r=a(248),s=a(325);const o=i.a.memo((({influencers:e,startDate:t,endDate:a,children:n,criteriaFields:o,skip:l})=>{const{jobIds:c}=Object(r.b)(),[u,d]=Object(s.a)({criteriaFields:o,influencers:e,startDate:t,endDate:a,skip:l,jobIds:c,aggregationInterval:"auto"});return i.a.createElement(i.a.Fragment,null,n({isLoadingAnomaliesData:u,anomaliesData:d}))}));o.displayName="AnomalyTableProvider"},function(e,t,a){"use strict";a.d(t,"b",(function(){return ce})),a.d(t,"a",(function(){return de}));var n=a(82),i=a.n(n),r=a(4),s=a.n(r),o=a(57),l=a(78),c=a(12),u=a(133),d=a(284),p=a(33),m=a.n(p);const g=m.a.div.attrs((({width:e})=>{if(e)return{style:{width:`${e}px`}}})).withConfig({displayName:"Field",componentId:"sc-11dh2wt-0"})(["background-color:",";border:",";box-shadow:0 2px 2px -1px ",",0 1px 5px -2px ",";font-size:",";font-weight:",";line-height:",";padding:",";"],(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiBorderThin),(({theme:e})=>Object(d.rgba)(e.eui.euiColorMediumShade,.3)),(({theme:e})=>Object(d.rgba)(e.eui.euiColorMediumShade,.3)),(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.euiFontWeightSemiBold),(({theme:e})=>e.eui.euiLineHeight),(({theme:e})=>e.eui.euiSizeXS));g.displayName="Field";const b=s.a.memo((({fieldId:e,fieldWidth:t})=>s.a.createElement(g,{"data-test-subj":"field",width:t},e)));b.displayName="DraggableFieldBadge";var f=a(102),y=a(141),h=a(32),E=a(943),v=a(83),x=a(159),k=a(79),S=a(85),j=a(123),O=a(34),w=a(45),T=a(81),I=a(86),C=a(340);const M=s.a.memo((({columnId:e,onColumnRemoved:t})=>{const a=Object(r.useCallback)((a=>{a.preventDefault(),a.stopPropagation(),t(e)}),[e,t]);return s.a.createElement(h.EuiButtonIcon,{"aria-label":C.f,color:"text","data-test-subj":"remove-column",iconType:"cross",onClick:a})}));M.displayName="CloseButton";const F=s.a.memo((({header:e,onColumnRemoved:t,sort:a,isLoading:n})=>s.a.createElement(s.a.Fragment,null,a.some((t=>t.columnId===e.id))&&n?s.a.createElement(y.d,{className:"siemEventsHeading__extra--loading"},s.a.createElement(y.h,{"data-test-subj":"timeline-loading-spinner"})):s.a.createElement(y.d,{className:"siemEventsHeading__extra--close"},s.a.createElement(M,{columnId:e.id,onColumnRemoved:t})))));F.displayName="Actions";const D=m()(h.EuiFieldText).withConfig({displayName:"FieldText",componentId:"sc-xd12j6-0"})(["min-width:",";"],(e=>e.minwidth));D.displayName="FieldText";const A=s.a.memo((({columnId:e,minWidth:t,filter:a="",onFilterChange:n=O.noop,placeholder:i="Filter"})=>s.a.createElement(D,{"data-test-subj":"textFilter",minwidth:`${t}px`,placeholder:i,value:a,onChange:t=>{n({columnId:e,filter:t.target.value})}})));A.displayName="TextFilter";const _=s.a.memo((({header:e,onFilterChange:t=O.noop})=>{var a;return"text-filter"===e.columnHeaderType?s.a.createElement(A,{columnId:e.id,minWidth:null!==(a=e.initialWidth)&&void 0!==a?a:x.a,onFilterChange:t,placeholder:e.placeholder}):null}));_.displayName="Filter";const N=({header:e,sort:t})=>t.reduce(((t,a)=>e.id===a.columnId?a.sortDirection:t),"none"),R=({header:e,sort:t})=>t.findIndex((t=>t.columnId===e.id));var P=a(203),L=a(254);const B=s.a.memo((({sortNumber:e})=>e>=0?s.a.createElement(h.EuiNotificationBadge,{color:"subdued","data-test-subj":"sortNumber"},e+1):s.a.createElement(h.EuiIcon,{"data-test-subj":"sortEmptyNumber",type:"empty"})));var q;B.displayName="SortNumber",function(e){e.SORT_UP="sortUp",e.SORT_DOWN="sortDown"}(q||(q={}));const z=s.a.memo((({sortDirection:e,sortNumber:t})=>{const a=(e=>{switch(e){case S.b.asc:return q.SORT_UP;case S.b.desc:return q.SORT_DOWN;case"none":return;default:throw new Error("Unhandled sort direction")}})(e);return null!=a?s.a.createElement(h.EuiToolTip,{content:a===q.SORT_UP?L.o:L.p,"data-test-subj":"sort-indicator-tooltip"},s.a.createElement(s.a.Fragment,null,s.a.createElement(h.EuiIcon,{"data-test-subj":"sortIndicator",type:a}),s.a.createElement(B,{sortNumber:t}))):s.a.createElement(h.EuiIcon,{"data-test-subj":"sortIndicator",type:"empty"})}));z.displayName="SortIndicator";var $=a(182);const V=m()(h.EuiIcon).withConfig({displayName:"IconType",componentId:"sc-1xrxlc-0"})(["margin-right:3px;position:relative;top:-2px;"]);V.displayName="IconType";const U=m.a.span.withConfig({displayName:"P",componentId:"sc-1xrxlc-1"})(["margin-bottom:5px;"]);U.displayName="P";const H=m.a.span.withConfig({displayName:"ToolTipTableMetadata",componentId:"sc-1xrxlc-2"})(["margin-right:5px;display:block;font-weight:bold;"]);H.displayName="ToolTipTableMetadata";const G=m.a.span.withConfig({displayName:"ToolTipTableValue",componentId:"sc-1xrxlc-3"})(["word-wrap:break-word;"]);G.displayName="ToolTipTableValue";const Q=s.a.memo((({header:e})=>{var t;return s.a.createElement(s.a.Fragment,null,!Object(O.isEmpty)(e.category)&&s.a.createElement(U,null,s.a.createElement(H,{"data-test-subj":"category"},C.a,":"),s.a.createElement(G,{"data-test-subj":"category-value"},e.category)),s.a.createElement(U,null,s.a.createElement(H,{"data-test-subj":"field"},C.c,":"),s.a.createElement(G,{"data-test-subj":"field-value"},e.id)),s.a.createElement(U,null,s.a.createElement(H,{"data-test-subj":"type"},C.j,":"),s.a.createElement(G,null,s.a.createElement(V,{"data-test-subj":"type-icon",type:Object($.d)(e.type)}),null===(t=e.esTypes)||void 0===t?void 0:t.map((e=>s.a.createElement(h.EuiBadge,{"data-test-subj":`type-value-${e}`,key:e},e))))),!Object(O.isEmpty)(e.description)&&s.a.createElement(U,null,s.a.createElement(H,{"data-test-subj":"description"},C.b,":"),s.a.createElement(G,{"data-test-subj":"description-value"},e.description)))}));Q.displayName="HeaderToolTipContent";const W=({children:e,header:t,isLoading:a,isResizing:n,onClick:i,showSortingCapability:r,sort:o})=>{var l,c;return s.a.createElement(y.c,{"data-test-subj":`header-${t.id}`,isLoading:a},t.aggregatable&&r?s.a.createElement(y.f,{"data-test-subj":"header-sort-button",onClick:n||a?O.noop:i},s.a.createElement(P.b,{"data-test-subj":`header-text-${t.id}`},s.a.createElement(h.EuiToolTip,{"data-test-subj":"header-tooltip",content:s.a.createElement(Q,{header:t})},s.a.createElement(s.a.Fragment,null,s.a.isValidElement(t.display)?t.display:null!==(l=t.displayAsText)&&void 0!==l?l:t.id))),s.a.createElement(z,{"data-test-subj":"header-sort-indicator",sortDirection:N({header:t,sort:o}),sortNumber:R({header:t,sort:o})})):s.a.createElement(y.g,null,s.a.createElement(P.b,{"data-test-subj":`header-text-${t.id}`},s.a.createElement(h.EuiToolTip,{"data-test-subj":"header-tooltip",content:s.a.createElement(Q,{header:t})},s.a.createElement(s.a.Fragment,null,s.a.isValidElement(t.display)?t.display:null!==(c=t.displayAsText)&&void 0!==c?c:t.id)))),e)},K=s.a.memo(W);var Y=a(108),J=a(527);const X=({header:e,onFilterChange:t=O.noop,sort:a,timelineId:n})=>{const i=Object(l.useDispatch)(),o=Object(r.useMemo)((()=>Object(Y.createSelector)(J.selectTimeline,(e=>(null==e?void 0:e.activeTab)===k.m.eql))),[]),c=Object(T.b)((e=>o(e,n))),u=Object(r.useCallback)((()=>{var t,r;const s=e.id,o=null!==(t=e.type)&&void 0!==t?t:"",l=null!==(r=e.esTypes)&&void 0!==r?r:[],c=(({clickedHeader:e,currentSort:t})=>t.reduce(((t,a)=>e.id===a.columnId?(e=>{switch(e.sortDirection){case S.b.desc:return S.b.asc;case S.b.asc:default:return S.b.desc}})(a):t),S.b.desc))({clickedHeader:e,currentSort:a}),u=a.findIndex((e=>e.columnId===s));let d=[];d=-1===u?[...a,{columnId:s,columnType:o,esTypes:l,sortDirection:c}]:[...a.slice(0,u),{columnId:s,columnType:o,esTypes:l,sortDirection:c},...a.slice(u+1)],i(I.a.updateSort({id:n,sort:d}))}),[i,e,a,n]),d=Object(r.useCallback)((e=>i(I.a.removeColumn({id:n,columnId:e}))),[i,n]),p=Object(r.useMemo)((()=>I.b.getTimelineByIdSelector()),[]),{isLoading:m}=Object(T.a)((e=>p(e,n)||{isLoading:!1})),g=!c&&!Object(w.isDataViewFieldSubtypeNested)(e);return s.a.createElement(s.a.Fragment,null,s.a.createElement(K,{header:e,isLoading:m,isResizing:!1,onClick:u,showSortingCapability:g,sort:a},s.a.createElement(F,{header:e,isLoading:m,onColumnRemoved:d,sort:a})),s.a.createElement(_,{header:e,onFilterChange:t}))},Z=s.a.memo(X);var ee=a(77);const te=m()(h.EuiContextMenu).withConfig({displayName:"ContextMenu",componentId:"sc-1yjxccs-0"})(["width:115px;& .euiContextMenuItem{font-size:12px;padding:4px 8px;width:115px;}"]),ae=m.a.div.withConfig({displayName:"PopoverContainer",componentId:"sc-1yjxccs-1"})(["& .euiPopover__anchor{padding-right:8px;width:","px;}"],(({$width:e})=>e)),ne={right:!0},ie=({draggableIndex:e,header:t,timelineId:a,isDragging:n,onFilterChange:c,sort:u,tabType:d})=>{const p=Object(r.useRef)(null),[m,g]=Object(r.useState)(!1),b=Object(r.useCallback)((()=>{var e;return null===(e=p.current)||void 0===e?void 0:e.focus()}),[]),O=Object(l.useDispatch)(),{timelines:w}=Object(ee.k)().services,T=Object(r.useMemo)((()=>{var e;return{width:null!==(e=t.initialWidth)&&void 0!==e?e:x.a,height:"auto"}}),[t.initialWidth]),M=Object(r.useMemo)((()=>({position:n?"absolute":"relative"})),[n]),F=Object(r.useMemo)((()=>({right:s.a.createElement(y.e,null)})),[]),D=Object(r.useCallback)(((e,n,i,r)=>{O(I.a.applyDeltaToColumnWidth({columnId:t.id,delta:r.width,id:a}))}),[O,t.id,a]),A=Object(r.useMemo)((()=>Object(f.j)({contextId:`timeline-column-headers-${d}-${a}`,fieldId:t.id})),[d,a,t.id]),_=Object(r.useCallback)((e=>{var n,i;const r=t.id,s=null!==(n=t.type)&&void 0!==n?n:"",o=null!==(i=t.esTypes)&&void 0!==i?i:[],l=u.findIndex((e=>e.columnId===r)),c=-1===l?[...u,{columnId:r,columnType:s,esTypes:o,sortDirection:e}]:[...u.slice(0,l),{columnId:r,columnType:s,esTypes:o,sortDirection:e},...u.slice(l+1)];O(I.a.updateSort({id:a,sort:c}))}),[O,t,u,a]),N=Object(r.useCallback)((()=>{g(!1),b()}),[b]),R=Object(r.useMemo)((()=>[{id:0,items:[{icon:s.a.createElement(h.EuiIcon,{type:"eyeClosed",size:"s"}),name:C.e,onClick:()=>{O(I.a.removeColumn({id:a,columnId:t.id})),N()}},...d!==k.m.eql?[{disabled:!t.aggregatable,icon:s.a.createElement(h.EuiIcon,{type:"sortUp",size:"s"}),name:C.g,onClick:()=>{_(S.b.asc),N()}},{disabled:!t.aggregatable,icon:s.a.createElement(h.EuiIcon,{type:"sortDown",size:"s"}),name:C.i,onClick:()=>{_(S.b.desc),N()}}]:[]]}]),[O,N,t.aggregatable,t.id,_,d,a]),P=Object(r.useMemo)((()=>s.a.createElement(Z,{timelineId:a,header:t,onFilterChange:c,sort:u})),[t,c,u,a]),L=Object(r.useCallback)((e=>{var a;return s.a.createElement(y.o,i()({"data-test-subj":"draggable-header"},e.draggableProps,e.dragHandleProps,{ref:e.innerRef}),s.a.createElement(y.p,null,s.a.createElement(ae,{$width:null!==(a=t.initialWidth)&&void 0!==a?a:x.a},s.a.createElement(h.EuiPopover,{anchorPosition:"downLeft",button:P,closePopover:N,isOpen:m,ownFocus:!0,panelPaddingSize:"none"},s.a.createElement(te,{initialPanelId:0,panels:R})))))}),[N,P,t.initialWidth,m,R]),B=Object(r.useCallback)((()=>{var e;null===(e=p.current)||void 0===e||e.focus()}),[]),q=Object(r.useCallback)((()=>{g(!0)}),[]),{onBlur:z,onKeyDown:$}=w.getUseDraggableKeyboardWrapper()({closePopover:N,draggableId:A,fieldName:t.id,keyboardHandlerRef:p,openPopover:q}),V=Object(r.useCallback)((e=>{m||$(e)}),[m,$]);return s.a.createElement(E.Resizable,{enable:ne,size:T,style:M,handleComponent:F,onResizeStop:D},s.a.createElement("div",{"aria-colindex":null!=e?e+j.c:void 0,className:v.a,"data-test-subj":"draggableWrapperKeyboardHandler",onClick:B,onBlur:z,onKeyDown:V,ref:p,role:"columnheader",tabIndex:0},s.a.createElement(o.Draggable,{"data-test-subj":"draggable",disableInteractiveElementBlocking:!0,draggableId:A,index:e,key:t.id},L)))},re=s.a.memo(ie);var se=a(95),oe=a(702);const le=s.a.memo((({children:e,onMount:t,onUnmount:a})=>(Object(r.useEffect)((()=>(t(),()=>a())),[t,a]),s.a.createElement(s.a.Fragment,null,e))));le.displayName="DraggableContainer";const ce=({globalFullScreen:e,isActiveTimelines:t,timelineFullScreen:a})=>t&&a||!1===t&&e,ue=({actionsColumnWidth:e,browserFields:t,columnHeaders:a,isEventViewer:n=!1,isSelectAllChecked:d,onSelectAll:p,show:m,showEventsSelect:g,showSelectAllCheckbox:h,sort:E,tabType:v,timelineId:x,leadingControlColumns:k,trailingControlColumns:S})=>{const j=Object(l.useDispatch)(),[O,w]=Object(r.useState)(null),T=Object(r.useRef)(null);Object(r.useEffect)((()=>()=>{T.current&&T.current.closeEditor()}),[]),Object(r.useEffect)((()=>{!m&&T.current&&T.current.closeEditor()}),[m]);const I=Object(r.useCallback)(((e,t,n)=>{const r=n.source.index,o=a[r];return s.a.createElement(y.o,i()({"data-test-subj":"draggable-header"},e.draggableProps,e.dragHandleProps,{ref:e.innerRef}),s.a.createElement(le,{onMount:()=>w(r),onUnmount:()=>w(null)},s.a.createElement(u.a,null,s.a.createElement(b,{fieldId:o.id,fieldWidth:o.initialWidth}))))}),[a,w]),C=Object(r.useMemo)((()=>a.map(((e,t)=>s.a.createElement(re,{key:e.id,draggableIndex:t,timelineId:x,header:e,isDragging:O===t,sort:E,tabType:v})))),[a,x,O,E,v]),M=Object(r.useCallback)(((e,t)=>s.a.createElement(s.a.Fragment,null,s.a.createElement(y.r,i()({"data-test-subj":"headers-group",ref:e.innerRef,isDragging:t.isDraggingOver},e.droppableProps),C))),[C]),F=Object(r.useMemo)((()=>k?k.map((e=>e.headerCellRender)):[]),[k]),D=Object(r.useMemo)((()=>S?S.map((e=>e.headerCellRender)):[]),[S]),A=Object(oe.a)({sourcererScope:se.SourcererScopeName.timeline,editorActionsRef:T,upsertColumn:(e,t)=>j(Object(c.upsertColumn)({column:e,id:x,index:t})),removeColumn:e=>j(Object(c.removeColumn)({columnId:e,id:x}))}),_=Object(r.useMemo)((()=>F.map(((i,r)=>{const o=k[r]&&k[r].width||e;return s.a.createElement(y.q,{actionsColumnWidth:o,"data-test-subj":"actions-container",isEventViewer:n,key:r},i&&s.a.createElement(i,{width:o,browserFields:t,columnHeaders:a,isEventViewer:n,isSelectAllChecked:d,onSelectAll:p,showEventsSelect:g,showSelectAllCheckbox:h,sort:E,tabType:v,timelineId:x,fieldBrowserOptions:A}))}))),[F,k,e,t,a,A,n,d,p,g,h,E,v,x]),N=Object(r.useMemo)((()=>D.map(((i,r)=>{const o=S[r]&&S[r].width||e;return s.a.createElement(y.q,{actionsColumnWidth:o,"data-test-subj":"actions-container",isEventViewer:n,key:r},i&&s.a.createElement(i,{width:o,browserFields:t,columnHeaders:a,isEventViewer:n,isSelectAllChecked:d,onSelectAll:p,showEventsSelect:g,showSelectAllCheckbox:h,sort:E,tabType:v,timelineId:x,fieldBrowserOptions:A}))}))),[D,S,e,t,a,A,n,d,p,g,h,E,v,x]);return s.a.createElement(y.s,{"data-test-subj":"column-headers"},s.a.createElement(y.v,null,_,s.a.createElement(o.Droppable,{direction:"horizontal",droppableId:`${f.f}-${v}.${x}`,isDropDisabled:!1,type:f.a,renderClone:I},M),N))},de=s.a.memo(ue)},function(e,t,a){"use strict";a.d(t,"c",(function(){return E})),a.d(t,"a",(function(){return p})),a.d(t,"b",(function(){return x}));var n=a(4),i=a.n(n),r=a(32),s=a(174),o=a(34);const l=a(0).i18n.translate("xpack.securitySolution.callouts.dismissButton",{defaultMessage:"Dismiss"}),c=({message:e,text:t,onClick:a=o.noop})=>{const{type:s}=e,c=s,u=null!=t?t:l,d=Object(n.useCallback)((()=>a(e)),[a,e]);return i.a.createElement(r.EuiButton,{color:c,"data-test-subj":"callout-dismiss-btn",onClick:d},u)},u=({message:e,iconType:t,dismissButtonText:a,onDismiss:n,showDismissButton:s=!0})=>{const{type:o,id:l,title:u,description:p}=e,m=null!=t?t:d(o);return i.a.createElement(r.EuiCallOut,{color:o,title:u,iconType:m,"data-test-subj":`callout-${l}`,"data-test-messages":`[${l}]`},p,s&&i.a.createElement(c,{message:e,text:a,onClick:n}))},d=e=>{switch(e){case"primary":return"iInCircle";case"success":return"cheer";case"warning":return"help";case"danger":return"alert";default:return Object(s.a)(e)}},p=Object(n.memo)(u);var m=a(1063),g=a.n(m),b=a(887);const f=(e,t)=>y(e,o.identity,(()=>t)),y=(e,t,a)=>{const n=e.map((e=>[t(e),a(e)]));return Object(o.fromPairs)(n)},h=({namespace:e,condition:t,message:a})=>{const{isVisible:s,dismiss:l}=((e,t="common")=>{const{getMessages:a,addMessage:i}=Object(b.a)(),[r,s]=g()({}),l=(e=>`kibana.securitySolution.${e}.callouts.dismissed`)(t),c=Object(n.useCallback)((()=>Object.entries(r).filter((([e,t])=>t)).map((([e,t])=>e))),[r]),u=Object(n.useCallback)((e=>{var t;return null!==(t=r[e.id])&&void 0!==t&&t}),[r]),d=Object(n.useCallback)((e=>{const{id:t,type:a}=e;s.set(t,!1),"primary"!==a&&"success"!==a||i(l,t)}),[s,i,l]),p=Object(n.useCallback)((e=>{const t=a(l),n=Object(o.difference)(e,t),i=Object(o.intersection)(e,t);s.setAll({...f(n,!0),...f(i,!1)})}),[a,l,s]);return Object(n.useEffect)((()=>{const t=e.map((e=>e.id)),a=Object.keys(r);Object(o.isEqual)(t,a)||p(t)}),[e,r,p]),{getVisibleMessageIds:c,isVisible:u,dismiss:d}})([a],e);return t&&s(a)?i.a.createElement(i.a.Fragment,null,i.a.createElement(p,{message:a,onDismiss:l}),i.a.createElement(r.EuiSpacer,{size:"l"})):null},E=Object(n.memo)(h),v=({condition:e,message:t})=>e?i.a.createElement(p,{message:t,showDismissButton:!1}):null,x=Object(n.memo)(v)},function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var n=a(4),i=a(77),r=a(83),s=a(172),o=a(0);const l=o.i18n.translate("xpack.securitySolution.containers.detectionEngine.alerts.fetchListsIndex.errorDescription",{defaultMessage:"Failed to retrieve the lists index"}),c=o.i18n.translate("xpack.securitySolution.containers.detectionEngine.alerts.createListsIndex.errorDescription",{defaultMessage:"Failed to create the lists index"});var u=a(84),d=a(116);const p=e=>{const[t]=Object.keys(e),a=e[t];return null!=a&&a.manage},m=e=>{const[t]=Object.keys(e),a=e[t];return null!=a&&a.read},g=e=>{const[t]=Object.keys(e),a=e[t];return null!=a&&(a.create||a.create_doc||a.index||a.write)},b=()=>{const[e,t]=Object(n.useState)({isAuthenticated:null,canManageIndex:null,canReadIndex:null,canWriteIndex:null}),{listPrivileges:a}=Object(d.a)();return Object(n.useEffect)((()=>{if(null!=a.result){const{is_authenticated:e,lists:{index:n},listItems:{index:i}}=a.result;t({isAuthenticated:e,canReadIndex:m(n)&&m(i),canManageIndex:p(n)&&p(i),canWriteIndex:g(n)&&g(i)})}}),[a.result]),Object(n.useEffect)((()=>{null!=a.error&&t({isAuthenticated:!1,canManageIndex:!1,canReadIndex:!1,canWriteIndex:!1})}),[a.error]),{loading:a.loading,...e}},f=()=>{const{createIndex:e,indexExists:t,loading:a,error:o}=(()=>{const[e,t]=Object(n.useState)(null),[a,o]=Object(n.useState)(null),{lists:d}=Object(i.k)().services,p=Object(i.j)(),{addError:m}=Object(u.a)(),{canReadIndex:g,canManageIndex:f,canWriteIndex:y}=b(),{loading:h,start:E,...v}=Object(s.k)(),{loading:x,start:k,...S}=Object(s.d)(),j=h||x,O=Object(n.useCallback)((()=>{d&&g&&f&&E({http:p})}),[p,d,E,g,f]),w=Object(n.useCallback)((()=>{d&&f&&y&&k({http:p})}),[k,p,d,f,y]);return Object(n.useEffect)((()=>{h||a||null!==e||O()}),[a,e,O,h]),Object(n.useEffect)((()=>{null!=v.result&&t(v.result.list_index&&v.result.list_item_index)}),[v.result]),Object(n.useEffect)((()=>{null!=S.result&&O()}),[S.result,O]),Object(n.useEffect)((()=>{const e=v.error;null!=e&&(Object(r.t)(e)&&404===e.body.status_code?t(!1):(o(e),m(e,{title:l})))}),[m,v.error]),Object(n.useEffect)((()=>{const e=S.error;null!=e&&(o(e),m(e,{title:c}))}),[m,S.error]),{createIndex:w,error:a,indexExists:e,loading:j}})(),{canManageIndex:d,canWriteIndex:p,loading:m}=b(),{lists:g}=Object(i.k)().services,f=null!=g,y=a||m,h=!1===t,E=!f||h&&(!1===d||!0===d&&null!=o);return Object(n.useEffect)((()=>{h&&d&&e()}),[d,e,h]),{canManageIndex:d,canWriteIndex:p,enabled:f,loading:y,needsConfiguration:E}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return x}));var n=a(4),i=a.n(n),r=a(237),s=a(292);var o=a(264),l=a(560),c=a(32),u=a(34),d=a(33),p=a.n(d),m=a(102),g=a(708),b=a(77),f=a(676);const y=p()(c.EuiFlexGroup).withConfig({displayName:"StyledFlexGroup",componentId:"sc-1v7juqg-0"})(["border-top:1px solid #d3dae6;border-bottom:1px solid #d3dae6;margin-top:2px;"]),h=p.a.div.withConfig({displayName:"StyledContent",componentId:"sc-1v7juqg-1"})(["padding:",";"],(({$isDetails:e})=>e?"0 8px":void 0)),E=({field:e,globalFilters:t,onFilterAdded:a,scopeId:r,value:s,closeCellPopover:o})=>{const{timelines:l,data:{query:{filterManager:d}}}=Object(b.k)().services,p=Object(n.useMemo)((()=>{var t,a;return Object(m.d)({fieldName:e.id,fieldType:null!==(t=e.type)&&void 0!==t?t:"",isAggregatable:null!==(a=e.aggregatable)&&void 0!==a&&a,hideTopN:!1})}),[e]),[E,v]=Object(n.useState)(!1),x=Object(n.useCallback)((()=>v(!E)),[E]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(h,{$isDetails:!0,"data-test-subj":"data-grid-expanded-cell-value-actions"},p?i.a.createElement(g.a,{className:"eui-displayBlock expandable-top-value-button",Component:c.EuiButtonEmpty,"data-test-subj":"data-grid-expanded-show-top-n",field:e.id,flush:"both",globalFilters:t,iconSide:"right",iconType:E?"arrowUp":"arrowDown",isExpandable:!0,onClick:x,onFilterAdded:null!=a?a:u.noop,ownFocus:!1,paddingSize:"none",showLegend:!0,showTopN:E,showTooltip:!1,scopeId:r,title:E?f.b:f.c,value:s}):null),i.a.createElement(y,{gutterSize:"s"},i.a.createElement(c.EuiFlexItem,null,l.getHoverActions().getFilterForValueButton({Component:c.EuiButtonEmpty,field:e.id,filterManager:d,onFilterAdded:a,ownFocus:!1,size:"s",showTooltip:!1,value:s,onClick:o})),i.a.createElement(c.EuiFlexItem,null,l.getHoverActions().getFilterOutValueButton({Component:c.EuiButtonEmpty,field:e.id,filterManager:d,onFilterAdded:a,ownFocus:!1,size:"s",showTooltip:!1,value:s,onClick:o}))))};E.displayName="ExpandedCellValueActionsComponent";const v=i.a.memo(E),x=({data:e,ecsData:t,eventId:a,globalFilters:c,header:u,isDetails:d,isDraggable:p,isTimeline:m,linkValues:g,rowRenderers:b,setCellProps:f,scopeId:y,truncate:E,closeCellPopover:x,enableActions:k=!0})=>{const S=Object(n.useMemo)((()=>void 0!==Object(o.b)(u.id,u.type,void 0)&&!m),[u.id,u.type,m]),j=Object(r.c)({data:e,fieldName:u.id}),O=d?"eui-textBreakWord":"eui-displayInlineBlock eui-textTruncate";return i.a.createElement(i.a.Fragment,null,i.a.createElement(h,{className:O,$isDetails:d},((e,t,a)=>{const n=t.find((t=>t.isInstance(e,a)));return null!=n?n:(()=>{throw new Error("Unhandled Column Renderer")})()})(u.id,s.a,e).renderColumn({asPlainText:S,columnName:u.id,ecsData:t,eventId:a,field:u,isDetails:d,isDraggable:p,linkValues:g,rowRenderers:b,scopeId:y,truncate:E,values:j})),k&&d&&(w=u.id)&&!l.a.includes(w)&&i.a.createElement(v,{field:u,globalFilters:c,scopeId:y,value:j,closeCellPopover:x}));var w}},function(e,t,a){"use strict";a.d(t,"a",(function(){return v}));var n=a(32),i=a(35),r=a(4),s=a.n(r),o=a(92),l=a.n(o),c=a(34),u=a(11),d=a(42),p=a(77),m=a(697),g=a(0);const b=g.i18n.translate("xpack.securitySolution.lastEventTime.errorSearchDescription",{defaultMessage:"An error has occurred on last event time search"}),f=g.i18n.translate("xpack.securitySolution.lastEventTime.failSearchDescription",{defaultMessage:"Failed to run search on last event time"});var y=a(84),h=a(87),E=a(101);const v=Object(r.memo)((({hostName:e,userName:t,indexKey:a,ip:o,indexNames:g})=>{const[v,{lastSeen:x,errorMessage:k}]=(({indexKey:e,indexNames:t,details:a})=>{const{data:n}=Object(p.k)().services,i=Object(r.useRef)(c.noop),s=Object(r.useRef)(new AbortController),o=Object(r.useRef)(new u.Subscription),[g,h]=Object(r.useState)(!1),[E,v]=Object(r.useState)({defaultIndex:t,factoryQueryType:m.c.lastEventTime,indexKey:e,details:a}),[x,k]=Object(r.useState)({lastSeen:null,refetch:i.current,errorMessage:void 0}),{addError:S,addWarning:j}=Object(y.a)(),O=Object(r.useCallback)((e=>{const t=async()=>{s.current=new AbortController,h(!0),o.current=n.search.search(e,{strategy:"timelineSearchStrategy",abortSignal:s.current.signal}).subscribe({next:e=>{Object(d.isCompleteResponse)(e)?(h(!1),k((t=>({...t,errorMessage:void 0,lastSeen:e.lastSeen,refetch:i.current})))):Object(d.isErrorResponse)(e)&&(h(!1),j(b))},error:e=>{h(!1),S(e,{title:f}),k((t=>({...t,errorMessage:e.message})))}})};o.current.unsubscribe(),s.current.abort(),t(),i.current=t}),[n.search,S,j]);return Object(r.useEffect)((()=>{v((n=>{const i={...n,defaultIndex:t,indexKey:e,details:a};return l()(n,i)?n:i}))}),[t,a,e]),Object(r.useEffect)((()=>(O(E),()=>{o.current.unsubscribe(),s.current.abort()})),[E,O]),[g,x]})({indexKey:a,indexNames:g,details:{hostName:e,ip:o,userName:t}});return null!=k?s.a.createElement(n.EuiToolTip,{position:"top",content:k,"data-test-subj":"last_event_time_error","aria-label":"last_event_time_error",id:`last_event_time_error-${a}`},s.a.createElement(n.EuiIcon,{"aria-describedby":`last_event_time_error-${a}`,type:"alert"})):s.a.createElement(s.a.Fragment,null,v&&s.a.createElement(n.EuiLoadingSpinner,{size:"m"}),v||null==x||"Invalid Date"!==new Date(x).toString()?!v&&null!=x&&s.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.headerPage.pageSubtitle",defaultMessage:"Last event: {beat}",values:{beat:s.a.createElement(E.b,{value:x})}}):x,!v&&null==x&&Object(h.d)())}));v.displayName="LastEventTime"},function(e,t,a){"use strict";a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return c}));var n=a(4),i=a.n(n),r=a(720),s=a(678);const o=()=>i.a.createElement(r.a,{docPath:s.f,linkText:s.g}),l=()=>i.a.createElement(r.a,{docPath:s.b,linkText:s.c}),c=()=>i.a.createElement(r.a,{docPath:s.d,linkText:s.e})},function(e,t,a){e.exports=a(27)(477)},,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return b})),a.d(t,"b",(function(){return f}));var n=a(32),i=a(43),r=a.n(i),s=a(4),o=a.n(s),l=a(33),c=a.n(l),u=a(117),d=a.n(u),p=a(384),m=a(160);p.f;const g=c.a.h3.withConfig({displayName:"TitleText",componentId:"sc-wz9mhv-0"})(["margin:0 5px;cursor:default;user-select:none;"]);g.displayName="TitleText",o.a.memo((({noteIds:e})=>o.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(n.EuiIcon,{color:"text",size:"l",type:"editorComment"})),o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(n.EuiTitle,{size:"s"},o.a.createElement(g,null,p.e))),o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(m.c,{color:"hollow"},e.length))))).displayName="NotesCount";const b=({newNote:e})=>({created:r.a.utc().toDate(),id:d.a.v4(),lastEdit:null,note:e,saveObjectId:null,user:"elastic",version:null}),f=({associateNote:e,newNote:t,updateNewNote:a,updateNote:n})=>{const i=b({newNote:t});n(i),e(i.id),a("")}},function(e,t,a){"use strict";function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,a,r){t=t||"&",a=a||"=";var s={};if("string"!=typeof e||0===e.length)return s;var o=/\+/g;e=e.split(t);var l=1e3;r&&"number"==typeof r.maxKeys&&(l=r.maxKeys);var c=e.length;l>0&&c>l&&(c=l);for(var u=0;u<c;++u){var d,p,m,g,b=e[u].replace(o,"%20"),f=b.indexOf(a);f>=0?(d=b.substr(0,f),p=b.substr(f+1)):(d=b,p=""),m=decodeURIComponent(d),g=decodeURIComponent(p),n(s,m)?i(s[m])?s[m].push(g):s[m]=[s[m],g]:s[m]=g}return s};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,a){"use strict";var n=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,a,o){return t=t||"&",a=a||"=",null===e&&(e=void 0),"object"==typeof e?r(s(e),(function(s){var o=encodeURIComponent(n(s))+a;return i(e[s])?r(e[s],(function(e){return o+encodeURIComponent(n(e))})).join(t):o+encodeURIComponent(n(e[s]))})).join(t):o?encodeURIComponent(n(o))+a+encodeURIComponent(n(e)):""};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function r(e,t){if(e.map)return e.map(t);for(var a=[],n=0;n<e.length;n++)a.push(t(e[n],n));return a}var s=Object.keys||function(e){var t=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.push(a);return t}},function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(32),i=a(83),r=a(4),s=a.n(r),o=a(33);const l=a.n(o)()(n.EuiPopover).withConfig({displayName:"WithHoverActionsPopover",componentId:"sc-16d4hj4-0"})([".euiPopover__anchor{width:100%;}"]),c=s.a.memo((({alwaysShow:e=!1,closePopOverTrigger:t,hoverContent:a,onCloseRequested:n,render:o})=>{const[c,u]=Object(r.useState)(null!=a&&e),[d,p]=Object(r.useState)(!1),[,m]=Object(r.useState)(void 0),g=Object(r.useRef)(null),b=Object(r.useCallback)((()=>{m((e=>{clearTimeout(e)})),p(!1),null!=n&&n()}),[n]),f=Object(r.useCallback)((()=>{m(Number(setTimeout((()=>{document.body.classList.contains(i.d)||p(!0)}),100)))}),[m,p]),y=Object(r.useCallback)((()=>{e||b()}),[e,b]),h=Object(r.useCallback)((e=>{c&&"Escape"===e.key&&y()}),[c,y]),E=Object(r.useMemo)((()=>s.a.createElement("div",{"data-test-subj":"withHoverActionsButton",onMouseEnter:f},o(d))),[f,o,d]);return Object(r.useEffect)((()=>{u(null!=a&&(d||e))}),[a,d,e]),Object(r.useEffect)((()=>{p(!1)}),[t]),Object(r.useEffect)((()=>{var e;c&&(null==g||null===(e=g.current)||void 0===e||e.positionPopoverFluid())}),[a,c]),s.a.createElement("div",{className:e?i.c:"",onMouseLeave:y},s.a.createElement(l,{ref:g,anchorPosition:"downCenter",button:E,closePopover:b,hasArrow:!1,isOpen:c,ownFocus:!1,panelPaddingSize:"none",panelClassName:"withHoverActions__popover",repositionOnScroll:!0},c?s.a.createElement("div",{onKeyDown:h},a):null))}));c.displayName="WithHoverActions"},function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return s})),a.d(t,"f",(function(){return o})),a.d(t,"k",(function(){return l})),a.d(t,"l",(function(){return c})),a.d(t,"j",(function(){return u})),a.d(t,"g",(function(){return d})),a.d(t,"h",(function(){return p})),a.d(t,"d",(function(){return m})),a.d(t,"e",(function(){return g})),a.d(t,"c",(function(){return b})),a.d(t,"p",(function(){return f})),a.d(t,"o",(function(){return y})),a.d(t,"n",(function(){return h})),a.d(t,"m",(function(){return E})),a.d(t,"i",(function(){return v}));var n=a(0),i=a(79);const r=n.i18n.translate("xpack.securitySolution.timeline.callOut.unauthorized.message.description",{defaultMessage:"You can use Timeline to investigate events, but you do not have the required permissions to save timelines for future use. If you need to save timelines, contact your Kibana administrator."}),s=n.i18n.translate("xpack.securitySolution.timeline.callOut.immutable.message.description",{defaultMessage:"This prebuilt timeline template cannot be modified. To make changes, please duplicate this template and make modifications to the duplicate template."}),o=n.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.button",{defaultMessage:"Edit timeline name and description"}),l=n.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.header",{defaultMessage:"Save Timeline"}),c=n.i18n.translate("xpack.securitySolution.timeline.saveTimelineTemplate.modal.header",{defaultMessage:"Save Timeline Template"}),u=n.i18n.translate("xpack.securitySolution.timeline.nameTimeline.save.title",{defaultMessage:"Save"}),d=n.i18n.translate("xpack.securitySolution.timeline.nameTimeline.modal.header",{defaultMessage:"Name Timeline"}),p=n.i18n.translate("xpack.securitySolution.timeline.nameTimelineTemplate.modal.header",{defaultMessage:"Name Timeline Template"}),m=n.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.discard.title",{defaultMessage:"Discard Timeline"}),g=n.i18n.translate("xpack.securitySolution.timeline.saveTimelineTemplate.modal.discard.title",{defaultMessage:"Discard Timeline Template"}),b=n.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.close.title",{defaultMessage:"Close"}),f=e=>n.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.warning.title",{values:{timeline:e===i.n.template?"timeline template":"timeline"},defaultMessage:"You have an unsaved {timeline}. Do you wish to save it?"}),y=n.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.titleTitle",{defaultMessage:"Title"}),h=n.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.titleAriaLabel",{defaultMessage:"Title"}),E=n.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.descriptionLabel",{defaultMessage:"Description"}),v=n.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.optionalLabel",{defaultMessage:"Optional"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return E}));var n=a(32),i=a(44),r=a.n(i),s=a(4),o=a.n(s),l=a(33),c=a.n(l),u=a(37),d=a(1),p=a(555),m=a(94),g=a(95);const b=c()(n.EuiDescriptionList).withConfig({displayName:"DescriptionListStyled",componentId:"sc-c8ba4g-0"})(["@media only screen and (min-width:","){.euiDescriptionList__title{width:30% !important;}.euiDescriptionList__description{width:70% !important;}}"],(e=>e.theme.eui.euiBreakpoints.s));b.displayName="DescriptionListStyled";const f=c()(n.EuiModal).withConfig({displayName:"MyEuiModal",componentId:"sc-c8ba4g-1"})(["width:min(768px,calc(100vw - 16px));min-height:41vh;.euiModal__flex{width:60vw;}.euiCodeBlock{height:auto !important;max-width:718px;}"]);f.displayName="MyEuiModal";const y=function(e){try{return e.map((e=>JSON.parse(e)))}catch{return[]}},h=(e=[])=>1===e.length&&e[0]===d.Yb?o.a.createElement("i",null,p.f):e.length>0?e.filter((e=>e!==d.Yb)).join(", "):p.k,E=({additionalRequests:e,additionalResponses:t,closeModal:a,inputId:i,request:l,response:c,title:d})=>{var E,v,x,k;const{pathname:S}=Object(u.useLocation)(),{selectedPatterns:j}=Object(m.d)("timeline"===i?g.SourcererScopeName.timeline:Object(m.a)(S)),O=[l,...null!=e?e:[]],w=[c,...null!=t?t:[]],T=y(O),I=y(w),C=Object(s.useMemo)((()=>{var e,t;return(null!==(e=null===(t=T[0])||void 0===t?void 0:t.index)&&void 0!==e?e:[]).every((e=>j.includes(e.trim())))}),[T,j]),M=[{title:o.a.createElement("span",{"data-test-subj":"index-pattern-title"},p.b," ",o.a.createElement(n.EuiIconTip,{color:"subdued",content:p.c,type:"iInCircle"})),description:o.a.createElement("span",{"data-test-subj":"index-pattern-description"},o.a.createElement("p",null,h(null!==(E=null===(v=T[0])||void 0===v?void 0:v.index)&&void 0!==E?E:[])),!C&&o.a.createElement("p",null,o.a.createElement("small",null,o.a.createElement("i",{"data-test-subj":"not-sourcerer-msg"},p.e))))},{title:o.a.createElement("span",{"data-test-subj":"query-time-title"},p.g," ",o.a.createElement(n.EuiIconTip,{color:"subdued",content:p.h,type:"iInCircle"})),description:o.a.createElement("span",{"data-test-subj":"query-time-description"},0===(null===(x=I[0])||void 0===x?void 0:x.took)?"0ms":null!==(k=I[0])&&void 0!==k&&k.took?`${r()(I[0].took).format("0,0")}ms`:p.k)},{title:o.a.createElement("span",{"data-test-subj":"request-timestamp-title"},p.i," ",o.a.createElement(n.EuiIconTip,{color:"subdued",content:p.j,type:"iInCircle"})),description:o.a.createElement("span",{"data-test-subj":"request-timestamp-description"},(new Date).toISOString())}],F=[{id:"statistics",name:"Statistics",content:o.a.createElement(o.a.Fragment,null,o.a.createElement(n.EuiSpacer,null),o.a.createElement(b,{listItems:M,type:"column"}))},{id:"request",name:"Request",content:T.length>0?T.map(((e,t)=>o.a.createElement(s.Fragment,{key:t},o.a.createElement(n.EuiSpacer,null),o.a.createElement(n.EuiCodeBlock,{language:"js",fontSize:"m",paddingSize:"m",color:"dark",overflowHeight:300,isCopyable:!0},(e=>{try{return JSON.stringify(e,null,2)}catch{return p.k}})(e.body))))):o.a.createElement(n.EuiCodeBlock,null,p.k)},{id:"response",name:"Response",content:I.length>0?w.map(((e,t)=>o.a.createElement(s.Fragment,{key:t},o.a.createElement(n.EuiSpacer,null),o.a.createElement(n.EuiCodeBlock,{language:"js",fontSize:"m",paddingSize:"m",color:"dark",overflowHeight:300,isCopyable:!0},e)))):o.a.createElement(n.EuiCodeBlock,null,p.k)}];return o.a.createElement(f,{onClose:a,"data-test-subj":"modal-inspect-euiModal"},o.a.createElement(n.EuiModalHeader,null,o.a.createElement(n.EuiModalHeaderTitle,null,p.d," ",d)),o.a.createElement(n.EuiModalBody,null,o.a.createElement(n.EuiTabbedContent,{tabs:F,initialSelectedTab:F[0],autoFocus:"selected"})),o.a.createElement(n.EuiModalFooter,null,o.a.createElement(n.EuiButton,{onClick:a,fill:!0,"data-test-subj":"modal-inspect-close"},p.a)))}},function(e,t,a){"use strict";a.d(t,"d",(function(){return i})),a.d(t,"a",(function(){return r})),a.d(t,"k",(function(){return s})),a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return l})),a.d(t,"e",(function(){return c})),a.d(t,"g",(function(){return u})),a.d(t,"h",(function(){return d})),a.d(t,"i",(function(){return p})),a.d(t,"j",(function(){return m})),a.d(t,"f",(function(){return g}));var n=a(0);const i=n.i18n.translate("xpack.securitySolution.inspectDescription",{defaultMessage:"Inspect"}),r=n.i18n.translate("xpack.securitySolution.inspect.modal.closeTitle",{defaultMessage:"Close"}),s=n.i18n.translate("xpack.securitySolution.inspect.modal.somethingWentWrongDescription",{defaultMessage:"Sorry about that, something went wrong."}),o=n.i18n.translate("xpack.securitySolution.inspect.modal.indexPatternLabel",{defaultMessage:"Index pattern"}),l=n.i18n.translate("xpack.securitySolution.inspect.modal.indexPatternDescription",{defaultMessage:"The index pattern that connected to the Elasticsearch indices. These indices can be configured in Kibana > Advanced Settings."}),c=n.i18n.translate("xpack.securitySolution.inspectPatternDifferent",{defaultMessage:"This element has a unique index pattern separate from the data view setting."}),u=n.i18n.translate("xpack.securitySolution.inspect.modal.queryTimeLabel",{defaultMessage:"Query time"}),d=n.i18n.translate("xpack.securitySolution.inspect.modal.queryTimeDescription",{defaultMessage:"The time it took to process the query. Does not include the time to send the request or parse it in the browser."}),p=n.i18n.translate("xpack.securitySolution.inspect.modal.reqTimestampLabel",{defaultMessage:"Request timestamp"}),m=n.i18n.translate("xpack.securitySolution.inspect.modal.reqTimestampDescription",{defaultMessage:"Time when the start of the request has been logged"}),g=n.i18n.translate("xpack.securitySolution.inspect.modal.noAlertIndexFound",{defaultMessage:"No alert index found"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(4),i=a(78),r=a(90),s=a(81),o=a(98),l=a(184);const c=({inputId:e=r.a.global,inspectIndex:t=0,isDisabled:a,multiple:c=!1,onClick:u,onCloseInspect:d,queryId:p})=>{const m=Object(i.useDispatch)(),g=o.d.globalQueryByIdSelector(),b=o.d.timelineQueryByIdSelector(),{loading:f,inspect:y,selectedInspectIndex:h,isInspected:E}=Object(s.a)((t=>e===r.a.global?g(t,p):b(t,p))),v=Object(n.useCallback)((()=>{u&&u(),m(l.b.setInspectionParameter({id:p,inputId:e,isInspected:!0,selectedInspectIndex:t}))}),[u,m,p,e,t]),x=Object(n.useCallback)((()=>{null!=d&&d(),m(l.b.setInspectionParameter({id:p,inputId:e,isInspected:!1,selectedInspectIndex:t}))}),[d,m,p,e,t]);let k=null,S=null;null!=y&&y.dsl.length>0&&(c?[k,...S]=y.dsl:k=y.dsl[t]);let j=null,O=null;null!=y&&y.response.length>0&&(c?[j,...O]=y.response:j=y.response[t]);const w=Object(n.useMemo)((()=>!f&&h===t&&E),[t,E,f,h]);return{additionalRequests:S,additionalResponses:O,handleClick:v,handleCloseModal:x,isButtonDisabled:Object(n.useMemo)((()=>f||a||null==k||null==j||null==p),[a,f,p,k,j]),isShowingModal:w,loading:f,request:k,response:j}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=a(0).i18n.translate("xpack.securitySolution.exitFullScreenButton",{defaultMessage:"Exit full screen"})},function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return d}));var n=a(4),i=a.n(n),r=a(33),s=a.n(r);const o="#FAFBFD",l=s.a.div.withConfig({displayName:"BigRing",componentId:"sc-1yoqpxe-0"})(["border-radius:50%;",""],(({size:e})=>`height: ${e}px;\n    width: ${e}px;\n    background-color: ${o};\n    text-align: center;\n    line-height: ${e}px;`)),c=s.a.div.withConfig({displayName:"SmallRing",componentId:"sc-1yoqpxe-1"})(["border-radius:50%;",""],(({size:e})=>`\n    height: ${e}px;\n    width: ${e}px;\n    background-color: white;\n    display: inline-block;\n    vertical-align: middle;`)),u=({size:e=90,donutWidth:t=20})=>e-t>0?i.a.createElement(l,{size:e,"data-test-subj":"empty-donut"},i.a.createElement(c,{size:e-t,"data-test-subj":"empty-donut-small"})):null,d=i.a.memo(u)},function(e,t,a){"use strict";a.d(t,"a",(function(){return w}));var n=a(4),i=a.n(n),r=a(78),s=a(33),o=a.n(s),l=a(155),c=a(90),u=a(184),d=a(1),p=a(124),m=a(148),g=a(107),b=a(414),f=a(94),y=a(560),h=a(77),E=a(917),v=a(702),x=a(375),k=a(845);const S=[],j=o.a.div.withConfig({displayName:"FullScreenContainer",componentId:"sc-z1fvak-0"})(["height:",";flex:1 1 auto;display:flex;width:100%;"],(({$isFullScreen:e})=>e?"100%":void 0)),O=({defaultCellActions:e,defaultModel:t,end:a,entityType:s,tableId:o,leadingControlColumns:O,pageFilters:w,currentFilter:T,onRuleChange:I,renderCellValue:C,rowRenderers:M,start:F,scopeId:D,additionalFilters:A,unit:_,bulkActions:N})=>{const R=Object(r.useDispatch)(),{filters:P,input:L,query:B,dataTable:{columns:q,defaultColumns:z,deletedEventIds:$,graphEventId:V,itemsPerPage:U,itemsPerPageOptions:H,sessionViewConfig:G,showCheckboxes:Q,sort:W}=t}=Object(r.useSelector)((e=>Object(b.a)(e,o))),{timelines:K}=Object(h.k)().services,{browserFields:Y,dataViewId:J,indexPattern:X,runtimeMappings:Z,selectedPatterns:ee,dataViewId:te,loading:ae}=Object(f.d)(D),{globalFullScreen:ne}=Object(m.a)(),ie=Object(g.a)("tGridEventRenderedViewEnabled"),re=Object(n.useRef)(null);Object(n.useEffect)((()=>(R(l.a.createTGrid({columns:q,dataViewId:te,defaultColumns:z,id:o,indexNames:ee,itemsPerPage:U,showCheckboxes:Q,sort:W})),()=>{R(u.b.deleteOneQuery({id:o,inputId:c.a.global})),re.current&&re.current.closeEditor()})),[]);const se=Object(n.useMemo)((()=>[...P,...null!=w?w:[]]),[P,w]),oe=S,{Navigation:le}=Object(k.b)({scopeId:o}),{DetailsPanel:ce,SessionView:ue}=Object(k.a)({entityType:s,scopeId:o}),de=Object(n.useMemo)((()=>null!=V&&V.length>0||null!=G?i.a.createElement(E.a,{scopeId:o,SessionView:ue,Navigation:le}):null),[V,o,G,ue,le]),pe=Object(n.useCallback)(((e,t,a)=>{R(u.b.setQuery({id:o,inputId:c.a.global,inspect:e,loading:t,refetch:a}))}),[R,o]),me=Object(v.a)({sourcererScope:D,editorActionsRef:re,upsertColumn:(e,t)=>R(l.a.upsertColumn({column:e,id:o,index:t})),removeColumn:e=>R(l.a.removeColumn({columnId:e,id:o}))}),ge="interval"===L.policy.kind;return i.a.createElement(i.a.Fragment,null,i.a.createElement(j,{$isFullScreen:ne},i.a.createElement(p.c,null,K.getTGrid({additionalFilters:A,appId:d.B,browserFields:Y,bulkActions:N,columns:q,dataViewId:J,defaultCellActions:e,deletedEventIds:$,disabledCellActions:y.a,end:a,entityType:s,fieldBrowserOptions:me,filters:se,filterStatus:T,getRowRenderer:x.a,globalFullScreen:ne,graphEventId:V,graphOverlay:de,id:o,indexNames:ee,indexPattern:X,isLive:ge,isLoadingIndexPattern:ae,itemsPerPage:U,itemsPerPageOptions:H,leadingControlColumns:O,onRuleChange:I,query:B,renderCellValue:C,rowRenderers:M,runtimeMappings:Z,setQuery:pe,sort:W,start:F,tGridEventRenderedViewEnabled:ie,trailingControlColumns:oe,type:"embedded",unit:_}))),ce)},w=i.a.memo(O)},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=["signal.rule.risk_score","signal.reason",a(135).k,"kibana.alert.reason"]},function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(32),i=a(4),r=a.n(i),s=a(85),o=a(1),l=a(823);const c=({riskScoreEntity:e,title:t})=>{const a=e===s.v.user?o.fc:o.dc;return r.a.createElement(n.EuiLink,{target:"_blank",rel:"noopener nofollow noreferrer",href:a},t||l.e)},u=r.a.memo(c);u.displayName="RiskScoreDocLink"},,,function(e,t,a){"use strict";a.d(t,"G",(function(){return i})),a.d(t,"m",(function(){return r})),a.d(t,"o",(function(){return s})),a.d(t,"a",(function(){return o})),a.d(t,"r",(function(){return l})),a.d(t,"q",(function(){return c})),a.d(t,"p",(function(){return u})),a.d(t,"O",(function(){return d})),a.d(t,"D",(function(){return p})),a.d(t,"N",(function(){return m})),a.d(t,"B",(function(){return g})),a.d(t,"C",(function(){return b})),a.d(t,"Q",(function(){return f})),a.d(t,"s",(function(){return y})),a.d(t,"E",(function(){return h})),a.d(t,"K",(function(){return E})),a.d(t,"R",(function(){return v})),a.d(t,"M",(function(){return x})),a.d(t,"L",(function(){return k})),a.d(t,"v",(function(){return S})),a.d(t,"w",(function(){return j})),a.d(t,"u",(function(){return O})),a.d(t,"y",(function(){return w})),a.d(t,"x",(function(){return T})),a.d(t,"t",(function(){return I})),a.d(t,"A",(function(){return C})),a.d(t,"b",(function(){return M})),a.d(t,"z",(function(){return F})),a.d(t,"F",(function(){return D})),a.d(t,"c",(function(){return A})),a.d(t,"l",(function(){return _})),a.d(t,"n",(function(){return N})),a.d(t,"f",(function(){return R})),a.d(t,"e",(function(){return P})),a.d(t,"k",(function(){return L})),a.d(t,"i",(function(){return B})),a.d(t,"j",(function(){return q})),a.d(t,"g",(function(){return z})),a.d(t,"h",(function(){return $})),a.d(t,"d",(function(){return V})),a.d(t,"P",(function(){return U})),a.d(t,"J",(function(){return H})),a.d(t,"H",(function(){return G})),a.d(t,"I",(function(){return Q}));var n=a(0);n.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.idTitle",{defaultMessage:"List ID"}),n.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.listName",{defaultMessage:"Name"}),n.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.actionsTitle",{defaultMessage:"Actions"});const i=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.showingExceptionLists",{values:{totalLists:e},defaultMessage:"Showing {totalLists} {totalLists, plural, =1 {list} other {lists}}"}),r=(n.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.rulesAssignedTitle",{defaultMessage:"Rules assigned to"}),n.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.dateCreatedTitle",{defaultMessage:"Date created"}),n.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.dateUpdatedTitle",{defaultMessage:"Last edited"}),n.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.errorFetching",{defaultMessage:"Error fetching exception lists"})),s=(n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allExceptionLists.filters.noExceptionsTitle",{defaultMessage:"No exception lists found"}),n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allExceptionLists.search.placeholder",{defaultMessage:"Search exception lists"})),o=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allExceptions.tableTitle",{defaultMessage:"Shared Exception Lists"}),l=(n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allExceptions.filters.noListsBody",{defaultMessage:"We weren't able to find any exception lists."}),n.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.exportSuccess",{defaultMessage:"Exception list export success"})),c=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.exportError",{defaultMessage:"Exception list export error"}),u=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.deleteError",{defaultMessage:"Error occurred deleting exception list"}),d=e=>n.i18n.translate("xpack.securitySolution.exceptions.referenceModalSuccessDescription",{defaultMessage:"Exception list - {listId} - deleted successfully.",values:{listId:e}}),p=n.i18n.translate("xpack.securitySolution.exceptions.referenceModalTitle",{defaultMessage:"Remove exception list"}),m=e=>n.i18n.translate("xpack.securitySolution.exceptions.referenceModalDefaultDescription",{defaultMessage:"Are you sure you wish to DELETE exception list with the name {listName}?",values:{listName:e}}),g=n.i18n.translate("xpack.securitySolution.exceptions.referenceModalCancelButton",{defaultMessage:"Cancel"}),b=n.i18n.translate("xpack.securitySolution.exceptions.referenceModalDeleteButton",{defaultMessage:"Remove exception list"}),f=e=>n.i18n.translate("xpack.securitySolution.exceptions.referenceModalDescription",{defaultMessage:"This exception list is associated with ({referenceCount}) {referenceCount, plural, =1 {rule} other {rules}}. Removing this exception list will also remove its reference from the associated rules.",values:{referenceCount:e}}),y=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.searchPlaceholder",{defaultMessage:"Search by name or list_id:id"}),h=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.refresh",{defaultMessage:"Refresh"}),E=n.i18n.translate("xpack.securitySolution.exceptions.exceptionListsImportButton",{defaultMessage:"Import list"}),v=e=>n.i18n.translate("xpack.securitySolution.lists.exceptionListImportSuccess",{defaultMessage:"Exception list {fileName} was imported",values:{fileName:e}}),x=n.i18n.translate("xpack.securitySolution.lists.exceptionListImportSuccessTitle",{defaultMessage:"Exception list imported"}),k=n.i18n.translate("xpack.securitySolution.lists.exceptionListUploadError",{defaultMessage:"There was an error uploading the exception list."}),S=n.i18n.translate("xpack.securitySolution.exceptions.manageExceptions.importExceptionList",{defaultMessage:"Import exception list"}),j=n.i18n.translate("xpack.securitySolution.exceptionsTable.importExceptionListFlyoutHeader",{defaultMessage:"Import shared exception list"}),O=n.i18n.translate("xpack.securitySolution.exceptionsTable.importExceptionListFlyoutBody",{defaultMessage:"Select shared exception lists to import"}),w=n.i18n.translate("xpack.securitySolution.exceptionsTable.importExceptionListWarning",{defaultMessage:"We found a pre-existing list with that id"}),T=n.i18n.translate("xpack.securitySolution.exceptionsTable.importExceptionListOverwrite",{defaultMessage:"Overwrite the existing list"}),I=n.i18n.translate("xpack.securitySolution.exceptionsTable.importExceptionListAsNewList",{defaultMessage:"Create new list"}),C=n.i18n.translate("xpack.securitySolution.exceptions.badge.readOnly.tooltip",{defaultMessage:"Unable to create, edit or delete exceptions"}),M=n.i18n.translate("xpack.securitySolution.exceptions.exceptionListsCloseImportFlyout",{defaultMessage:"Close"}),F=n.i18n.translate("xpack.securitySolution.exceptions.exceptionListsFilePickerPrompt",{defaultMessage:"Select or drag and drop multiple files"}),D=n.i18n.translate("xpack.securitySolution.exceptionsTable.rulesCountLabel",{defaultMessage:"Rules"}),A=n.i18n.translate("xpack.securitySolution.exceptionsTable.createdBy",{defaultMessage:"Created By"}),_=n.i18n.translate("xpack.securitySolution.exceptionsTable.createdAt",{defaultMessage:"Date created"}),N=n.i18n.translate("xpack.securitySolution.exceptionsTable.exceptionsCountLabel",{defaultMessage:"Exceptions"}),R=n.i18n.translate("xpack.securitySolution.exceptions.manageExceptions.createSharedListButton",{defaultMessage:"Create shared list"}),P=n.i18n.translate("xpack.securitySolution.exceptions.manageExceptions.createItemButton",{defaultMessage:"Create exception item"}),L=n.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListTitle",{defaultMessage:"Create shared exception list"}),B=n.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListFlyoutNameField",{defaultMessage:"Shared exception list name"}),q=n.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListFlyoutNameFieldPlaceholder",{defaultMessage:"New exception list"}),z=n.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListFlyoutDescription",{defaultMessage:"Description (optional)"}),$=n.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListFlyoutDescriptionPlaceholder",{defaultMessage:"New exception list description"}),V=n.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListFlyoutCreateButton",{defaultMessage:"Create shared exception list"}),U=e=>n.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListSuccessDescription",{defaultMessage:"List with name {listName} was created!",values:{listName:e}}),H=n.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListSuccessTitle",{defaultMessage:"Created list"}),G=n.i18n.translate("xpack.securitySolution.exceptions.sortBy",{defaultMessage:"Sort by:"}),Q=n.i18n.translate("xpack.securitySolution.exceptions.sortByCreateAt",{defaultMessage:"Created At"})},function(e,t,a){"use strict";a.d(t,"d",(function(){return i})),a.d(t,"e",(function(){return r})),a.d(t,"i",(function(){return s})),a.d(t,"j",(function(){return o})),a.d(t,"b",(function(){return l})),a.d(t,"c",(function(){return c})),a.d(t,"a",(function(){return u})),a.d(t,"h",(function(){return d})),a.d(t,"g",(function(){return p})),a.d(t,"f",(function(){return m}));var n=a(0);const i=n.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.installedTitle",{defaultMessage:"Installed"}),r=n.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.installedTooltip",{defaultMessage:"Integration is installed. Configure an integration policy and ensure Elastic Agents are assigned this policy to ingest compatible events."}),s=n.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.uninstalledTitle",{defaultMessage:"Not installed"}),o=n.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.uninstalledTooltip",{defaultMessage:"Integration is not installed. Follow the integration link to install and configure the integration."}),l=n.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.enabledTitle",{defaultMessage:"Installed: enabled"}),c=n.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.enabledTooltip",{defaultMessage:"Integration is installed and an integration policy with the required configuration exists. Ensure Elastic Agents are assigned this policy to ingest compatible events."}),u=n.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.badgeTitle",{defaultMessage:"integrations"}),d=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.popoverTitle",{values:{integrationsCount:e},defaultMessage:"[{integrationsCount}] Related {integrationsCount, plural, =1 {integration} other {integrations}} available"}),p=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.popoverDescription",{values:{integrationsCount:e},defaultMessage:"Install and configure {integrationsCount, plural, =1 {the below integration} other {one or more of the below integrations}} to ingest the necessary data for this detection rule:"}),m=(e,t)=>n.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.popoverDescriptionInstalledVersionTooltip",{values:{installedVersion:e,requiredVersion:t},defaultMessage:"Version mismatch -- please resolve! Installed version `{installedVersion}` when required version `{requiredVersion}`"})},function(e,t,a){"use strict";a.d(t,"b",(function(){return c})),a.d(t,"c",(function(){return u})),a.d(t,"a",(function(){return d})),a.d(t,"d",(function(){return p}));var n=a(82),i=a.n(n),r=a(4),s=a.n(r),o=a(1),l=a(100);const c=[{value:o.Xb,text:"On each rule execution"},{value:"1h",text:"Hourly"},{value:"1d",text:"Daily"},{value:"7d",text:"Weekly"}],u=[{value:o.Wb,text:"Perform no actions"},...c],d=u[0],p=e=>{const{setValue:t}=e.field,a=Object(r.useCallback)((e=>{const a=e.target.value;t(a)}),[t]),n={...e.euiFieldProps,onChange:a};return s.a.createElement(l.d,i()({},e,{euiFieldProps:n}))}},function(e,t,a){"use strict";a.d(t,"c",(function(){return d})),a.d(t,"d",(function(){return p})),a.d(t,"b",(function(){return m})),a.d(t,"a",(function(){return g})),a.d(t,"g",(function(){return b})),a.d(t,"f",(function(){return f})),a.d(t,"e",(function(){return y})),a.d(t,"i",(function(){return h})),a.d(t,"h",(function(){return E}));var n=a(4),i=a.n(n),r=a(33),s=a.n(r),o=a(32),l=a(40),c=a(492);const u=s()(o.EuiHealth).withConfig({displayName:"StyledEuiHealth",componentId:"sc-1mv5h4i-0"})(["line-height:inherit;"]),d=l.euiLightVars.euiColorVis0,p=l.euiLightVars.euiColorVis5,m=l.euiLightVars.euiColorVis7,g=l.euiLightVars.euiColorVis9,b=47,f=73,y=99,h=[{value:"low",inputDisplay:i.a.createElement(u,{color:d},c.i)},{value:"medium",inputDisplay:i.a.createElement(u,{color:p},c.j)},{value:"high",inputDisplay:i.a.createElement(u,{color:m},c.h)},{value:"critical",inputDisplay:i.a.createElement(u,{color:g},c.f)}],E={low:21,medium:b,high:f,critical:y}},function(e,t,a){"use strict";a.d(t,"a",(function(){return v}));var n=a(4),i=a(78),r=a(38),s=a(48),o=a(77),l=a(1),c=a(94),u=a(520),d=a(414),p=a(136),m=a(86),g=a(210),b=a(118),f=a(79),y=a(478),h=a(180),E=a(852);const v=({localFilters:e,tableId:t,from:a,to:v,scopeId:x})=>{const[k,S]=Object(n.useState)(!1),{browserFields:j,dataViewId:O,runtimeMappings:w,indexPattern:T,selectedPatterns:I}=Object(c.d)(x),C=Object(i.useDispatch)(),{uiSettings:M}=Object(o.k)().services,{filters:F,dataTable:{selectAll:D,totalCount:A,sort:_,selectedEventIds:N}=h.a}=Object(i.useSelector)((e=>Object(d.a)(e,t))),R=Object(n.useMemo)((()=>Object(s.getEsQueryConfig)(M)),[M]),P=_.map((({columnId:e,columnType:t,esTypes:a,sortDirection:n})=>({field:e,direction:n,esTypes:null!=a?a:[],type:t}))),L=Object(n.useMemo)((()=>[...e,...F]),[e,F]),B=Object(r.combineQueries)({config:R,dataProviders:[],indexPattern:T,filters:L,kqlQuery:{query:"",language:"kuery"},browserFields:j,kqlMode:"filter"}),q=Object(n.useMemo)((()=>B?B.filterQuery:""),[B]),[,,z]=Object(u.b)({dataViewId:O,endDate:v,startDate:a,id:t,fields:["_id","timestamp"],sort:P,indexNames:I,filterQuery:q,runtimeMappings:w,limit:Math.min(l.E,A),timerangeKind:"absolute"});Object(n.useEffect)((()=>{D&&A>l.E?S(!0):S(!1)}),[D,A]);const $=Object(g.a)({timelineId:f.j.active,timelineType:f.n.default}),V=Object(n.useCallback)((e=>C(m.a.updateIsLoading(e))),[C]),U=Object(n.useCallback)((({timeline:e,ruleNote:t,timeline:{filters:n}})=>{var i;$(),V({id:f.j.active,isLoading:!1}),Object(p.b)(C)({duplicate:!0,from:a,id:f.j.active,notes:[],timeline:{...e,indexNames:null!==(i=e.indexNames)&&void 0!==i?i:[],show:!0,filters:n},to:v,ruleNote:t})()}),[C,V,$,a,v]),H=Object(n.useCallback)((e=>{Object(y.c)(U,e.map((e=>e.ecs)),"KqlFilter"),C(Object(E.setSelected)({id:t,isSelectAllChecked:!1,isSelected:!1,eventIds:N}))}),[C,U,N,t]),G=Object(n.useCallback)((e=>{H(e.events),C(Object(E.setEventsLoading)({id:t,isLoading:!1,eventIds:Object.keys(N)}))}),[C,H,t,N]),Q=Object(n.useCallback)((e=>{if(e)return D?(C(Object(E.setEventsLoading)({id:t,isLoading:!0,eventIds:Object.keys(N)})),void z(G)):void H(e)}),[C,N,t,z,D,G,H]);return{label:Object(n.useMemo)((()=>k?`${b.y} ( max ${l.E} )`:b.y),[k]),key:"add-bulk-to-timeline","data-test-subj":"investigate-bulk-in-timeline",disableOnQuery:k,onClick:Q}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return c}));var n=a(4),i=a(39),r=a(138),s=a(353);const o=["GET",a(407).a],l=e=>Object(i.useQuery)(o,(async({signal:e})=>await Object(r.i)({signal:e})),{...s.a,...e}),c=()=>{const e=Object(i.useQueryClient)();return Object(n.useCallback)((()=>{e.invalidateQueries(o,{refetchType:"active"})}),[e])}},function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return u}));var n=a(39),i=a(4),r=a(1),s=a(138),o=a(353);const l=["GET",r.sb],c=e=>Object(n.useQuery)(l,(async({signal:e})=>Object(s.g)({signal:e})),{...o.a,...e}),u=()=>{const e=Object(n.useQueryClient)();return Object(i.useCallback)((()=>{e.invalidateQueries(l,{refetchType:"active"})}),[e])}},function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"d",(function(){return i})),a.d(t,"c",(function(){return r})),a.d(t,"b",(function(){return s}));const n=e=>e.sort(((e,t)=>e.toLowerCase().localeCompare(t.toLowerCase()))),i=({query:e,searchValue:t,filterOptions:a,defaultSearchTerm:n})=>{const i=null==e?void 0:e.ast.getFieldClauses();return null!=i&&i.length>0?i.reduce(((e,{field:t,value:a})=>(e[t]=`${a}`,e)),a):{[n]:t}},r=async e=>{const t=(await e.text()).split("\n").filter(Boolean).slice(-1)[0];return JSON.parse(t)},s=async e=>{const t=await r(e);return{succeeded:t.exported_rules_count,failed:t.missing_rules_count,total:t.exported_rules_count+t.missing_rules_count}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(33);const i=a.n(n).a.div.withConfig({displayName:"Display",componentId:"sc-1njjyjq-0"})(["",";"],(({show:e})=>e?"":"display: none;"));i.displayName="Display"},function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(4),i=a(138);const r=({exceptionLists:e})=>{const[t,a]=Object(n.useState)(!0),[r,s]=Object(n.useState)([]),[o,l]=Object(n.useState)({}),c=Object(n.useCallback)((t=>{const a=e.reduce(((e,{id:t,...a})=>(e[t]={...a,id:t,rules:[]},e)),{});return t.reduce(((e,t)=>{const a=t.exceptions_list;return null!=a&&a.length>0&&a.forEach((a=>{const n=e[a.id];null!=n&&(e[a.id]={...n,rules:[...n.rules,t]})})),e}),a)}),[e]);return Object(n.useEffect)((()=>{let t=!0;const n=new AbortController;return(async()=>{if(0===e.length&&t)return a(!1),s([]),void l({});try{a(!0);const{data:e}=await Object(i.f)({pagination:{page:1,perPage:1e4},signal:n.signal}),r=c(e),o=Object.keys(r).map((e=>r[e]));s(o),l(r),t&&a(!1)}catch(e){t&&a(!1)}})(),()=>{t=!1,n.abort()}}),[e.length,c]),[t,r,o]}},function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(4),i=a.n(n),r=a(32),s=a(91);const o=Object(n.memo)((({title:e,subtitle:t,actions:a,children:o,restrictWidth:l=!1,hasBottomBorder:c=!0,hideHeader:u=!1,headerBackComponent:d,...p})=>{const m=Object(n.useMemo)((()=>i.a.createElement(r.EuiFlexGroup,{direction:"column",gutterSize:"none",alignItems:"flexStart"},i.a.createElement(r.EuiFlexItem,{grow:!1},d&&i.a.createElement(i.a.Fragment,null,d)),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiTitle,{size:"l"},i.a.createElement("span",{"data-test-subj":"header-page-title"},e))))),[d,e]),g=Object(n.useMemo)((()=>t?i.a.createElement("span",{"data-test-subj":"header-panel-subtitle"},t):void 0),[t]),b=Object(s.a)(p["data-test-subj"]);return i.a.createElement("div",p,!u&&i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiPageHeader,{pageTitle:m,description:g,bottomBorder:c,rightSideItems:a?[a]:void 0,restrictWidth:l,"data-test-subj":b("header")}),i.a.createElement(r.EuiSpacer,{size:"l"})),i.a.createElement(r.EuiPageContent_Deprecated,{hasBorder:!1,hasShadow:!1,paddingSize:"none",color:"transparent",borderRadius:"none"},i.a.createElement(r.EuiPageContentBody_Deprecated,{restrictWidth:l},o)))}));o.displayName="AdministrationListPage"},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(4),i=a(77),r=a(153);const s=(e=[])=>{const{getAppUrl:t}=Object(i.d)();return Object(n.useMemo)((()=>e.reduce(((e,a)=>{var n;const i=a.id,s=Object(r.j)(i);return e[i]={href:t({path:s}),children:null!==(n=a.name)&&void 0!==n?n:i,target:"_blank"},e}),{})),[t,e])}},function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return r})),a.d(t,"c",(function(){return s})),a.d(t,"d",(function(){return o}));var n=a(139);function i(e){return(null==e?void 0:e.filter((e=>!e.startsWith("policy:"))))||[]}function r(e,t=[]){return e.isGlobal?[n.d,...t]:e.selected.map((e=>`policy:${e.id}`)).concat(t)}function s(e,t){return e.find((e=>e===n.d))?{isGlobal:!0,selected:[]}:{isGlobal:!1,selected:e.reduce(((e,a)=>{const n=a.split(":")[1],i=t.find((e=>e.id===n));return void 0!==i&&e.push(i),e}),[])}}function o(e){return void 0!==e&&void 0!==e.find((e=>e===n.d))}},function(e,t,a){"use strict";a.d(t,"e",(function(){return u})),a.d(t,"d",(function(){return d})),a.d(t,"a",(function(){return m})),a.d(t,"b",(function(){return g})),a.d(t,"c",(function(){return b}));var n=a(1),i=a(85),r=a(383),s=a(272);const o=[s.a.flows,s.a.dns,s.a.http,s.a.tls,s.a.events],l=o.join("|"),c=[...o,s.a.anomalies].join("|"),u=`${n.Sb}/:tabName(${c})`,d=`${n.Sb}/:tabName(${l})`,p=[r.a.flows,r.a.http,r.a.tls,r.a.anomalies,r.a.events,r.a.users].join("|"),m=[i.g.source,i.g.destination].join("|"),g=`${n.Sb}/ip/:detailName`,b=`${g}/:flowTarget(${m})/:tabName(${p})`},function(e,t,a){"use strict";var n=a(514);a.d(t,"a",(function(){return n.a})),a(225)},function(e,t,a){"use strict";a.d(t,"f",(function(){return i})),a.d(t,"a",(function(){return r})),a.d(t,"c",(function(){return s})),a.d(t,"b",(function(){return o})),a.d(t,"e",(function(){return l})),a.d(t,"d",(function(){return c}));var n=a(0);const i=n.i18n.translate("xpack.securitySolution.users.pageTitle",{defaultMessage:"Users"}),r=n.i18n.translate("xpack.securitySolution.users.navigation.allUsersTitle",{defaultMessage:"All users"}),s=n.i18n.translate("xpack.securitySolution.users.navigation.authenticationsTitle",{defaultMessage:"Authentications"}),o=n.i18n.translate("xpack.securitySolution.users.navigation.anomaliesTitle",{defaultMessage:"Anomalies"}),l=n.i18n.translate("xpack.securitySolution.users.navigation.riskTitle",{defaultMessage:"User risk"}),c=n.i18n.translate("xpack.securitySolution.users.navigation.eventsTitle",{defaultMessage:"Events"});n.i18n.translate("xpack.securitySolution.users.navigation.userScoreOverTimeTitle",{defaultMessage:"User risk score over time"}),n.i18n.translate("xpack.securitySolution.hosts.navigaton.hostRisk.viewDashboardButtonLabel",{defaultMessage:"View source dashboard"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"e",(function(){return r})),a.d(t,"d",(function(){return s})),a.d(t,"c",(function(){return o})),a.d(t,"b",(function(){return l}));var n=a(0);const i=n.i18n.translate("xpack.securitySolution.alerts.alertDetails.header.technicalPreview",{defaultMessage:"Technical Preview"}),r=n.i18n.translate("xpack.securitySolution.alerts.alertDetails.navigation.summary",{defaultMessage:"Summary"}),s=(n.i18n.translate("xpack.securitySolution.alerts.alertDetails.header.backToAlerts",{defaultMessage:"Back to alerts"}),n.i18n.translate("xpack.securitySolution.alerts.alertDetails.loadingPage.message",{defaultMessage:"Loading details page..."})),o=n.i18n.translate("xpack.securitySolution.alerts.alertDetails.errorPage.title",{defaultMessage:"Unable to load the details page"}),l=n.i18n.translate("xpack.securitySolution.alerts.alertDetails.errorPage.message",{defaultMessage:"There was an error loading the details page. Please confirm the following id points to a valid document"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(4),i=a(37);const r=(e,t)=>{const a=Object(i.useHistory)();return Object(n.useCallback)((n=>{try{t&&t(n)}catch(e){throw n.preventDefault(),e}n.defaultPrevented||0===n.button&&(n.currentTarget instanceof HTMLAnchorElement&&""!==n.currentTarget.target&&"_self"!==n.currentTarget.target||n.metaKey||n.altKey||n.ctrlKey||n.shiftKey||(n.preventDefault(),Array.isArray(e)?a.push(...e):a.push(e)))}),[a,t,e])}},,function(e,t,a){"use strict";a.d(t,"a",(function(){return h})),a.d(t,"b",(function(){return k})),a.d(t,"c",(function(){return j})),a.d(t,"d",(function(){return n}));var n={};a.r(n),a.d(n,"STATUS",(function(){return d})),a.d(n,"STATUS_AT",(function(){return p})),a.d(n,"STATUS_DATE",(function(){return m})),a.d(n,"REFRESH",(function(){return g})),a.d(n,"ERROR_CALLOUT_TITLE",(function(){return b})),a.d(n,"PARTIAL_FAILURE_CALLOUT_TITLE",(function(){return f}));var i=a(4),r=a.n(i),s=a(32),o=a(101),l=a(87),c=a(417),u=a(0);const d=u.i18n.translate("xpack.securitySolution.detectionEngine.ruleStatus.statusDescription",{defaultMessage:"Last response"}),p=u.i18n.translate("xpack.securitySolution.detectionEngine.ruleStatus.statusAtDescription",{defaultMessage:"at"}),m=u.i18n.translate("xpack.securitySolution.detectionEngine.ruleStatus.statusDateDescription",{defaultMessage:"Status date"}),g=u.i18n.translate("xpack.securitySolution.detectionEngine.ruleStatus.refreshButton",{defaultMessage:"Refresh"}),b=u.i18n.translate("xpack.securitySolution.detectionEngine.ruleStatus.errorCalloutTitle",{defaultMessage:"Rule failure at"}),f=u.i18n.translate("xpack.securitySolution.detectionEngine.ruleStatus.partialErrorCalloutTitle",{defaultMessage:"Warning at"}),y=({status:e,date:t,children:a})=>{const n=Object(c.c)(e),i=Object(c.b)(e);return r.a.createElement(r.a.Fragment,null,r.a.createElement(s.EuiFlexItem,{grow:!1},r.a.createElement(s.EuiHealth,{color:i},r.a.createElement(s.EuiText,{"data-test-subj":"ruleStatus",size:"xs"},null!=n?n:Object(l.d)()))),null!=t&&null!=e&&r.a.createElement(r.a.Fragment,null,r.a.createElement(s.EuiFlexItem,{grow:!1},r.a.createElement(r.a.Fragment,null,p)),r.a.createElement(s.EuiFlexItem,{grow:!0},r.a.createElement(o.a,{value:t,fieldName:m}))),r.a.createElement(s.EuiFlexItem,{grow:!1},a))},h=r.a.memo(y);h.displayName="RuleStatus";var E=a(633),v=a(173);const x=({status:e,message:t})=>{const a=e===v.f.failed||e===v.f["partial failure"],n=Object(c.a)(e),i=a&&t?t:n,s=Object(c.b)(e);return r.a.createElement(E.a,{tooltipContent:i,healthColor:s,dataTestSubj:"ruleExecutionStatus"},null!=n?n:Object(l.d)())},k=r.a.memo(x);k.displayName="RuleStatusBadge";const S=({date:e,message:t,status:a})=>{const{shouldBeDisplayed:n,color:i,title:l}=O(a);return n?r.a.createElement(s.EuiCallOut,{title:r.a.createElement(r.a.Fragment,null,l," ",r.a.createElement(o.a,{value:e,fieldName:"execution_summary.last_execution.date"})),color:i,iconType:"alert","data-test-subj":"ruleStatusFailedCallOut"},r.a.createElement("p",null,t)):null},j=r.a.memo(S);j.displayName="RuleStatusFailedCallOut";const O=e=>{switch(e){case v.f.failed:return{shouldBeDisplayed:!0,color:"danger",title:b};case v.f["partial failure"]:return{shouldBeDisplayed:!0,color:"warning",title:f};default:return{shouldBeDisplayed:!1,color:"warning",title:""}}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return g})),a.d(t,"b",(function(){return b})),a.d(t,"c",(function(){return f}));var n=a(7),i=a(166),r=a(77),s=a(167),o=a(11),l=a(42);const c=e=>"parsing_exception"===e||"verification_exception"===e||"mapping_exception"===e,u=e=>Object(n.has)(e,"error.type"),d=e=>e.error.root_cause.filter((e=>c(e.type))).map((e=>e.reason));var p=a(311);let m;!function(e){e.FAILED_REQUEST="ERR_FAILED_REQUEST",e.INVALID_EQL="ERR_INVALID_EQL"}(m||(m={}));const g=(e,t)=>{let a,n=[];return(...i)=>(a&&clearTimeout(a),a=setTimeout((()=>{const t=e(...i);n.forEach((e=>e(t))),n=[]}),t),new Promise((e=>n.push(e))))},b=async(...e)=>{const[{value:t,formData:a}]=e,{query:g}=t,b=g.query,{dataViewId:f,index:y,ruleType:h}=a;if(void 0===h&&!Object(n.isEmpty)(b)||Object(i.b)(h)&&!Object(n.isEmpty)(b))try{const{data:e}=r.b.get();let t=null==y?void 0:y.join(),i={};if(null!=f&&""!==f&&a.dataSourceType===s.a.DataView){const a=await e.dataViews.get(f);t=a.title,i=a.getRuntimeMappings()}const p=(new AbortController).signal,g=await(async({data:e,dataViewTitle:t,query:a,signal:i,runtimeMappings:r})=>{const{rawResponse:s}=await Object(o.firstValueFrom)(e.search.search({params:{index:t,body:{query:a,runtime_mappings:r,size:0}},options:{ignore:[400]}},{strategy:l.EQL_SEARCH_STRATEGY,abortSignal:i}));if((e=>u(e)&&c(Object(n.get)(e,"error.type")))(s.body))return{valid:!1,errors:d(s.body)};if(u(s.body))throw new Error(JSON.stringify(s.body));return{valid:!0,errors:[]}})({data:e,query:b,signal:p,dataViewTitle:t,runtimeMappings:i});if(!1===(null==g?void 0:g.valid))return{code:m.INVALID_EQL,message:"",messages:g.errors}}catch(e){return{code:m.FAILED_REQUEST,message:p.m,error:e}}},f=e=>{const t=e.errors.length>0,a=!e.isChangingValue&&!t;if(t){const[t]=e.errors,n=t.message;return t.code===m.INVALID_EQL?{isValid:a,message:n,messages:t.messages}:{isValid:a,message:n,error:t.error}}return{isValid:a,message:""}}},function(e,t,a){"use strict";a.d(t,"b",(function(){return ie})),a.d(t,"a",(function(){return le}));var n=a(34),i=a(32),r=a(4),s=a.n(r),o=a(78),l=a(33),c=a.n(l),u=a(38),d=a(86),p=a(112),m=a(158),g=a(95),b=a(901),f=a(79),y=a(81),h=a(228),E=a(123),v=a(296),x=a(529),k=a(859),S=a(0);const j=S.i18n.translate("xpack.securitySolution.timeline.tabs.queyTabTimelineTitle",{defaultMessage:"Query"}),O=S.i18n.translate("xpack.securitySolution.timeline.tabs.eqlTabTimelineTitle",{defaultMessage:"Correlation"}),w=S.i18n.translate("xpack.securitySolution.timeline.tabs.analyserTabTimelineTitle",{defaultMessage:"Analyzer"}),T=S.i18n.translate("xpack.securitySolution.timeline.tabs.notesTabTimelineTitle",{defaultMessage:"Notes"}),I=S.i18n.translate("xpack.securitySolution.timeline.tabs.pinnedTabTimelineTitle",{defaultMessage:"Pinned"}),C=S.i18n.translate("xpack.securitySolution.timeline.tabs.sessionTabTimelineTitle",{defaultMessage:"Session View"});var M=a(13);const F=c.a.div.attrs((({$isVisible:e=!1,isOverflowYScroll:t=!1})=>({style:{display:e?"flex":"none",overflow:t?"hidden scroll":"hidden"}}))).withConfig({displayName:"HideShowContainer",componentId:"sc-14igzi1-0"})(["flex:1;"]),D=Object(r.lazy)((()=>Promise.all([a.e(10),a.e(11),a.e(27)]).then(a.bind(null,1290)))),A=Object(r.lazy)((()=>Promise.all([a.e(10),a.e(11),a.e(26)]).then(a.bind(null,1293)))),_=Object(r.lazy)((()=>a.e(33).then(a.bind(null,1281)))),N=Object(r.lazy)((()=>a.e(30).then(a.bind(null,1297)))),R=Object(r.lazy)((()=>Promise.all([a.e(10),a.e(34)]).then(a.bind(null,1282)))),P=Object(r.lazy)((()=>a.e(35).then(a.bind(null,1283)))),L=Object(r.memo)((({renderCellValue:e,rowRenderers:t,timelineId:a})=>s.a.createElement(r.Suspense,{fallback:s.a.createElement(i.EuiLoadingContent,{lines:10})},s.a.createElement(D,{renderCellValue:e,rowRenderers:t,timelineId:a}))));L.displayName="QueryTab";const B=Object(r.memo)((({renderCellValue:e,rowRenderers:t,timelineId:a})=>s.a.createElement(r.Suspense,{fallback:s.a.createElement(i.EuiLoadingContent,{lines:10})},s.a.createElement(A,{renderCellValue:e,rowRenderers:t,timelineId:a}))));B.displayName="EqlTab";const q=Object(r.memo)((({timelineId:e})=>s.a.createElement(r.Suspense,{fallback:s.a.createElement(i.EuiLoadingContent,{lines:10})},s.a.createElement(_,{timelineId:e}))));q.displayName="GraphTab";const z=Object(r.memo)((({timelineId:e})=>s.a.createElement(r.Suspense,{fallback:s.a.createElement(i.EuiLoadingContent,{lines:10})},s.a.createElement(N,{timelineId:e}))));z.displayName="NotesTab";const $=Object(r.memo)((({timelineId:e})=>s.a.createElement(r.Suspense,{fallback:s.a.createElement(i.EuiLoadingContent,{lines:10})},s.a.createElement(P,{timelineId:e}))));$.displayName="SessionTab";const V=Object(r.memo)((({renderCellValue:e,rowRenderers:t,timelineId:a})=>s.a.createElement(r.Suspense,{fallback:s.a.createElement(i.EuiLoadingContent,{lines:10})},s.a.createElement(R,{renderCellValue:e,rowRenderers:t,timelineId:a}))));V.displayName="PinnedTab";const U=Object(r.memo)((({activeTimelineTab:e,renderCellValue:t,rowRenderers:a,timelineId:n,timelineType:i})=>{const o=Object(r.useCallback)((e=>{switch(e){case f.m.graph:return s.a.createElement(q,{timelineId:n});case f.m.notes:return s.a.createElement(z,{timelineId:n});case f.m.session:return s.a.createElement($,{timelineId:n});default:return null}}),[n]),l=Object(r.useMemo)((()=>[f.m.graph,f.m.notes,f.m.session].includes(e)),[e]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(F,{$isVisible:f.m.query===e,"data-test-subj":`timeline-tab-content-${f.m.query}`},s.a.createElement(L,{renderCellValue:t,rowRenderers:a,timelineId:n})),s.a.createElement(F,{$isVisible:f.m.pinned===e,"data-test-subj":`timeline-tab-content-${f.m.pinned}`},s.a.createElement(V,{renderCellValue:t,rowRenderers:a,timelineId:n})),i===f.n.default&&s.a.createElement(F,{$isVisible:f.m.eql===e,"data-test-subj":`timeline-tab-content-${f.m.eql}`},s.a.createElement(B,{renderCellValue:t,rowRenderers:a,timelineId:n})),s.a.createElement(F,{$isVisible:l,isOverflowYScroll:e===f.m.session,"data-test-subj":`timeline-tab-content-${f.m.graph}-${f.m.notes}`},l&&o(e)))}));U.displayName="ActiveTimelineTab";const H=c()(i.EuiBadge).withConfig({displayName:"CountBadge",componentId:"sc-14igzi1-1"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeS)),G=c()(i.EuiTab).withConfig({displayName:"StyledEuiTab",componentId:"sc-14igzi1-2"})([".euiTab__content{display:flex;flex-direction:row;white-space:pre;}:focus{text-decoration:none;> span > span{text-decoration:underline;}}"]),Q=({renderCellValue:e,rowRenderers:t,timelineId:a,timelineFullScreen:l,timelineType:c,graphEventId:u,sessionViewConfig:p,timelineDescription:m})=>{const g=Object(o.useDispatch)(),b=Object(r.useMemo)((()=>Object(k.a)()),[]),h=Object(r.useMemo)((()=>Object(k.g)()),[]),E=Object(r.useMemo)((()=>Object(k.e)()),[]),v=Object(r.useMemo)((()=>Object(k.d)()),[]),S=Object(r.useMemo)((()=>Object(k.c)()),[]),F=Object(r.useMemo)((()=>Object(k.b)()),[]),D=Object(y.b)((e=>b(e,a))),A=Object(y.b)((e=>h(e,a))),_=Object(y.b)((e=>E(e,a))),N=Object(y.a)((e=>S(e,a))),R=Object(y.a)((e=>F(e,a))),P=Object(y.a)((e=>v(e))),L=Object(M.b)().isEnterprise(),B=Object(r.useMemo)((()=>{const e=Object.values(R).reduce(((e,t)=>[...e,...t]),[]);return[...N,...e]}),[N,R]),q=Object(r.useMemo)((()=>P.filter((e=>B.includes(e.id))).length+(Object(n.isEmpty)(m)?0:1)),[P,B,m]),z=Object(r.useCallback)((e=>{g(d.a.setActiveTabTimeline({id:a,activeTab:e}))}),[g,a]),$=Object(r.useCallback)((()=>{z(f.m.query)}),[z]),V=Object(r.useCallback)((()=>{z(f.m.eql)}),[z]),Q=Object(r.useCallback)((()=>{z(f.m.graph)}),[z]),W=Object(r.useCallback)((()=>{z(f.m.notes)}),[z]),K=Object(r.useCallback)((()=>{z(f.m.pinned)}),[z]),Y=Object(r.useCallback)((()=>{z(f.m.session)}),[z]);return Object(r.useEffect)((()=>{u||D!==f.m.graph||$()}),[D,u,$]),s.a.createElement(s.a.Fragment,null,!l&&s.a.createElement(i.EuiTabs,null,s.a.createElement(G,{"data-test-subj":`timelineTabs-${f.m.query}`,onClick:$,isSelected:D===f.m.query,disabled:!1,key:f.m.query},s.a.createElement("span",null,j),A&&s.a.createElement(x.b,null)),c===f.n.default&&s.a.createElement(G,{"data-test-subj":`timelineTabs-${f.m.eql}`,onClick:V,isSelected:D===f.m.eql,disabled:!1,key:f.m.eql},s.a.createElement("span",null,O),A&&s.a.createElement(x.a,null)),s.a.createElement(i.EuiTab,{"data-test-subj":`timelineTabs-${f.m.graph}`,onClick:Q,isSelected:D===f.m.graph,disabled:!u,key:f.m.graph},w),L&&s.a.createElement(i.EuiTab,{"data-test-subj":`timelineTabs-${f.m.session}`,onClick:Y,isSelected:D===f.m.session,disabled:null===p,key:f.m.session},C),s.a.createElement(G,{"data-test-subj":`timelineTabs-${f.m.notes}`,onClick:W,isSelected:D===f.m.notes,disabled:c===f.n.template,key:f.m.notes},s.a.createElement("span",null,T),A&&q>0&&c===f.n.default&&s.a.createElement("div",null,s.a.createElement(H,null,q))),s.a.createElement(G,{"data-test-subj":`timelineTabs-${f.m.pinned}`,onClick:K,disabled:c===f.n.template,isSelected:D===f.m.pinned,key:f.m.pinned},s.a.createElement("span",null,I),A&&_>0&&c===f.n.default&&s.a.createElement("div",null,s.a.createElement(H,null,_)))),s.a.createElement(U,{activeTimelineTab:D,renderCellValue:e,rowRenderers:t,timelineId:a,timelineType:c,timelineDescription:m}))},W=Object(r.memo)(Q);var K=a(141),Y=a(148),J=a(616),X=a(37),Z=a(267),ee=a(77),te=a(281),ae=a(98);const ne=c.a.div.withConfig({displayName:"TimelineTemplateBadge",componentId:"sc-h40gwq-0"})(["background:",";color:#fff;padding:10px 15px;font-size:0.8em;"],(({theme:e})=>e.eui.euiColorVis3_behindText)),ie=Object(r.createContext)({timelineId:null}),re=({timelineId:e})=>{const t=Object(r.useMemo)((()=>d.b.getTimelineByIdSelector()),[]);return Object(y.b)((a=>{var n;return(null!==(n=t(a,e))&&void 0!==n?n:p.b).isSaving}))?s.a.createElement(i.EuiProgress,{size:"s",color:"primary",position:"absolute"}):null},se=s.a.memo(re),oe=({renderCellValue:e,rowRenderers:t,timelineId:a})=>{const l=Object(o.useDispatch)(),c=Object(r.useRef)(null),x=Object(r.useMemo)((()=>d.b.getTimelineByIdSelector()),[]),k=Object(r.useMemo)((()=>ae.e.scopeIdSelector()),[]),{selectedPatterns:S,selectedDataViewId:j}=Object(y.a)((e=>k(e,g.SourcererScopeName.timeline))),{dataViewId:O,indexNames:w,graphEventId:T,savedObjectId:I,timelineType:C,description:M,sessionViewConfig:F}=Object(y.a)((e=>{var t;return Object(n.pick)(["indexNames","dataViewId","graphEventId","savedObjectId","timelineType","description","sessionViewConfig"],null!==(t=x(e,a))&&void 0!==t?t:p.b)})),{timelineFullScreen:D}=Object(Y.c)();Object(r.useEffect)((()=>{I||l(d.a.createTimeline({id:a,columns:m.b,dataViewId:j,indexNames:S,expandedDetail:h.a.getExpandedDetail(),show:!1}))}),[]);const A=Object(r.useCallback)((()=>{!I||null==j||null===O&&0===w.length||O===j&&w.sort().join()===S.sort().join()||l(d.a.updateDataView({dataViewId:j,id:a,indexNames:S}))}),[l,I,j,O,S,w,a]);Object(r.useEffect)((()=>{A()}),[j,S]);const _=Object(r.useCallback)((()=>{var e;const t=null===(e=c.current)||void 0===e?void 0:e.querySelector(J.a);var a,n;null!=t?t.focus():null===(a=c.current)||void 0===a||null===(n=a.querySelector(".globalFilterBar__addButton"))||void 0===n||n.focus()}),[c]),N=Object(r.useCallback)((()=>{var e,t;null===(e=c.current)||void 0===e||null===(t=e.querySelector(`.${E.d}`))||void 0===t||t.focus()}),[c]),R=Object(r.useCallback)((e=>{Object(u.isTab)(e)&&Object(E.l)({containerElement:c.current,keyboardEvent:e,onSkipFocusBeforeEventsTable:_,onSkipFocusAfterEventsTable:N})}),[c,_,N]),P=Object(r.useMemo)((()=>({timelineId:a})),[a]),L=(()=>{const{search:e,pathname:t}=Object(X.useLocation)(),{spaces:a}=Object(ee.k)().services,n=Object(r.useMemo)((()=>d.b.getTimelineByIdSelector()),[]),{resolveTimelineConfig:o,savedObjectId:l,show:c,graphEventId:u,activeTab:m}=Object(y.a)((e=>{var t;return null!==(t=n(e,f.j.active))&&void 0!==t?t:p.b})),g=Object(r.useCallback)((()=>{var n,r,d;if(!a||"conflict"!==(null==o?void 0:o.outcome)||null==(null==o?void 0:o.alias_target_id))return null;const p=new URLSearchParams(e),g=null!==(n=p.get(te.a.timeline))&&void 0!==n?n:void 0,b={id:null!=l?l:"",isOpen:!!c,activeTab:m,graphEventId:u};let f=b;try{var y;f=null!==(y=Object(Z.a)(g))&&void 0!==y?y:b}catch(e){}const h=null===(r=f)||void 0===r?void 0:r.id,E=null!==(d=null==o?void 0:o.alias_target_id)&&void 0!==d?d:"",v={...f,id:E},x=Object(Z.c)(v);p.set(te.a.timeline,x);const k=`${t}?${p.toString()}${window.location.hash}`;return s.a.createElement(s.a.Fragment,null,a.ui.components.getLegacyUrlConflict({objectNoun:te.a.timeline,currentObjectId:h,otherObjectId:E,otherObjectPath:k}),s.a.createElement(i.EuiSpacer,null))}),[m,u,t,null==o?void 0:o.alias_target_id,null==o?void 0:o.outcome,l,e,c,a]);return Object(r.useMemo)((()=>g()),[g])})();return s.a.createElement(ie.Provider,{value:P},s.a.createElement(K.D,{"data-test-subj":"timeline","data-timeline-id":a,onKeyDown:R,ref:c},s.a.createElement(se,{timelineId:a}),C===f.n.template&&s.a.createElement(ne,null,v.f),L,s.a.createElement(K.y,{$isVisible:!D,"data-test-subj":"timeline-hide-show-container"},s.a.createElement(b.b,{timelineId:a}),s.a.createElement(b.a,{timelineId:a})),s.a.createElement(W,{graphEventId:T,sessionViewConfig:F,renderCellValue:e,rowRenderers:t,timelineId:a,timelineType:C,timelineDescription:M,timelineFullScreen:D})))};oe.displayName="StatefulTimelineComponent";const le=s.a.memo(oe)},function(e,t,a){"use strict";a.d(t,"a",(function(){return ee}));var n=a(32),i=a(44),r=a.n(i),s=a(4),o=a.n(s),l=a(33),c=a.n(l),u=a(34),d=a(117),p=a.n(d),m=a(45),g=a(42),b=a(114),f=a(1),y=a(102),h=a(119),E=a(186),v=a(185),x=a(128),k=a(460),S=a(124),j=a(621),O=a(77),w=a(43),T=a.n(w);const I=[],C=(e,t,a,n,i)=>({aggs:{alertsByGrouping:{terms:{field:e,order:{_count:"desc"},size:10},aggs:{alerts:{date_histogram:{field:"@timestamp",fixed_interval:`${Math.floor(T()(a).diff(T()(t))/32)}ms`,min_doc_count:0,extended_bounds:{min:t,max:a}}}}}},query:{bool:{filter:[...n,{range:{"@timestamp":{gte:t,lte:a}}}]}},runtime_mappings:i}),M=e=>{try{return null==e||Object(u.isEmpty)(e)?{}:JSON.parse(e)}catch{return{}}},F=e=>{try{return Object(u.isEmpty)(e)?[]:[M(e)]}catch{return[]}};var D=a(49),A=a(297),_=a(198),N=a(191),R=a(424),P=a(303);const L=o.a.memo((({chartHeight:e=174,data:t,from:a,legendItems:i,legendPosition:r=D.Position.Right,legendMinWidth:l,loading:c,showLegend:u,to:d,updateDateRange:p})=>{const m=Object(A.i)(),g=Object(s.useMemo)((()=>["100%",e]),[e]),b=Object(s.useMemo)((()=>["y"]),[]),f=Object(s.useMemo)((()=>[e=>Object(N.a)(e.g)?e.g:P.c]),[]),y=Object(s.useMemo)((()=>Object(_.a)([a,d])),[a,d]);return o.a.createElement(o.a.Fragment,null,c&&o.a.createElement(n.EuiProgress,{"data-test-subj":"loadingPanelAlertsHistogram",size:"xs",position:"absolute",color:"accent"}),o.a.createElement(n.EuiFlexGroup,{gutterSize:"none"},o.a.createElement(n.EuiFlexItem,{grow:!0},o.a.createElement(D.Chart,{size:g},o.a.createElement(D.Settings,{legendPosition:r,onBrushEnd:p,showLegend:u&&0===i.length,showLegendExtra:u,theme:m}),o.a.createElement(D.Axis,{id:"alertsHistogramAxisX",position:D.Position.Bottom,tickFormat:y}),o.a.createElement(D.Axis,{id:"alertsHistogramAxisY",position:D.Position.Left}),o.a.createElement(D.HistogramBarSeries,{id:"alertsHistogram",xScaleType:D.ScaleType.Time,yScaleType:D.ScaleType.Linear,xAccessor:"x",yAccessors:b,splitSeriesAccessors:f,data:t}))),o.a.createElement(n.EuiFlexItem,{grow:!1},i.length>0&&o.a.createElement(R.a,{legendItems:i,height:e,minWidth:l}))))}));L.displayName="AlertsHistogram";var B=a(0);const q=B.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.headerTitle",{defaultMessage:"Trend"}),z=B.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.notAvailableTooltip",{defaultMessage:"Not available for trend view"}),$=B.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.viewAlertsButtonLabel",{defaultMessage:"View alerts"});var V=a(89),U=a(2),H=a(531),G=a(623),Q=a(532),W=a(109),K=a(409);const Y={value:0,relation:"eq"},J=c()(n.EuiFlexItem).withConfig({displayName:"ViewAlertsFlexItem",componentId:"sc-wtx915-0"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeL)),X=c()(n.EuiFlexItem).withConfig({displayName:"OptionsFlexItem",componentId:"sc-wtx915-1"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeS)),Z=[],ee=Object(s.memo)((({alignHeader:e,chartHeight:t,chartOptionsContextMenu:a,combinedQueries:i,comboboxRef:l,defaultStackByOption:c=H.a,filters:d,headerChildren:w,inspectTitle:T,onFieldSelected:D,onlyField:A,paddingSize:_="m",panelHeight:N=H.d,query:R,legendPosition:P="right",setComboboxInputRef:ee,signalIndexName:te,showCountsInLegend:ae=!1,showGroupByPlaceholder:ne=!1,showLegend:ie=!0,showLinkToAlerts:re=!1,showTotalAlertsCount:se=!1,showStackBy:oe=!0,stackByLabel:le,stackByWidth:ce,timelineId:ue,title:de=q,updateDateRange:pe,titleSize:me="m",runtimeMappings:ge})=>{var be;const{to:fe,from:ye,deleteQuery:he,setQuery:Ee}=Object(b.a)(!1),ve=Object(s.useMemo)((()=>`detections-histogram-${p.a.v4()}`),[]),[xe,ke]=Object(s.useState)(!0),[Se,je]=Object(s.useState)(!1),[Oe]=Object(O.q)(f.Z),[we,Te]=Object(s.useState)(Y),[Ie,Ce]=Object(s.useState)(null==A?c:A),Me=Object(s.useCallback)((e=>{Ce(e),null!=D&&D(e)}),[D]);Object(s.useEffect)((()=>{Ce(null==A?c:A)}),[c,A]);const{toggleStatus:Fe,setToggleStatus:De}=Object(W.a)("detections-histogram"),[Ae,_e]=Object(s.useState)(!Fe);Object(s.useEffect)((()=>{_e(!Fe)}),[Fe]);const Ne=Object(s.useCallback)((e=>{De(e),_e(!e)}),[_e,De]),{loading:Re,data:Pe,setQuery:Le,response:Be,request:qe,refetch:ze}=Object(E.a)({query:C(Ie,ye,fe,F(i),ge),indexName:te,skip:Ae,queryName:v.a.HISTOGRAM}),$e=Object(O.k)(),{navigateToApp:Ve}=$e.services.application,{formatUrl:Ue,search:He}=Object(x.n)(U.a.alerts),Ge=Object(s.useMemo)((()=>((e,t,a)=>B.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.showingAlertsTitle",{values:{totalAlertsFormatted:e,totalAlerts:t,modifier:a},defaultMessage:"Showing: {modifier}{totalAlertsFormatted} {totalAlerts, plural, =1 {alert} other {alerts}}"}))(r()(we.value).format(Oe),we.value,"gte"===we.relation?">":"lte"===we.relation?"<":"")),[we]),Qe=Object(s.useCallback)((e=>{e.preventDefault(),Ve(f.B,{deepLinkId:U.a.alerts,path:Object(x.e)(He)})}),[Ve,He]),We=Object(s.useMemo)((()=>(e=>{var t,a,n;return(null!==(t=null==e||null===(a=e.aggregations)||void 0===a||null===(n=a.alertsByGrouping)||void 0===n?void 0:n.buckets)&&void 0!==t?t:[]).reduce(((e,{key_as_string:t,key:a,alerts:n})=>{var i;return[...e,...(null!==(i=n.buckets)&&void 0!==i?i:[]).map((({key:e,doc_count:n})=>({x:e,y:n,g:null!=t?t:a.toString()})))]}),I)})(Pe)),[Pe]),Ke=Object(s.useMemo)((()=>{var e,t;return ie&&null!=(null==Pe||null===(e=Pe.aggregations)||void 0===e||null===(t=e.alertsByGrouping)||void 0===t?void 0:t.buckets)?Pe.aggregations.alertsByGrouping.buckets.map(((e,t)=>{var a;return{color:t<k.a.length?k.a[t]:void 0,count:ae?e.doc_count:void 0,dataProviderId:Object(y.h)(`draggable-legend-item-${p.a.v4()}-${Ie}-${e.key}`),field:Ie,timelineId:ue,value:null!==(a=null==e?void 0:e.key_as_string)&&void 0!==a?a:e.key}})):Z}),[null==Pe||null===(be=Pe.aggregations)||void 0===be?void 0:be.alertsByGrouping.buckets,Ie,ae,ie,ue]);Object(s.useEffect)((()=>{let e=!1;return e||(({isInitialLoading:e,isLoadingAlerts:t})=>e&&t)({isInitialLoading:xe,isLoadingAlerts:Re})||ke(!1),()=>{e=!0}}),[xe,Re,ke]),Object(Q.a)({setQuery:Ee,response:Be,request:qe,refetch:ze,uniqueQueryId:ve,deleteQuery:he,loading:Re}),Object(s.useEffect)((()=>{var e;Te(null!==(e=null==Pe?void 0:Pe.hits.total)&&void 0!==e?e:{value:0,relation:"eq"})}),[Pe]),Object(s.useEffect)((()=>{try{let t=null;var e;t=null!=i?M(i):Object(m.buildEsQuery)(void 0,null!=R?[R]:[],null!==(e=null==d?void 0:d.filter((e=>!1===e.meta.disabled)))&&void 0!==e?e:[],{...Object(g.getEsQueryConfig)($e.services.uiSettings),dateFormatTZ:void 0}),je(!1),Le(C(Ie,ye,fe,Object(u.isEmpty)(t)?[]:[t],ge))}catch(e){je(!0),Le(C(Ie,ye,fe,[],ge))}}),[Ie,ye,fe,R,d,i,ge]);const Ye=Object(s.useMemo)((()=>{if(re)return o.a.createElement(J,{grow:!1},o.a.createElement(V.g,{"data-test-subj":"alerts-histogram-panel-go-to-alerts-page",onClick:Qe,href:Ue(Object(x.e)())},$))}),[re,Qe,Ue]),Je=Object(s.useMemo)((()=>{return null==A?de:(e=A,B.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.topNLabel",{values:{fieldName:e},defaultMessage:"Top {fieldName}"}));var e}),[A,de]);return o.a.createElement(S.c,{show:!xe&&Fe},o.a.createElement(G.a,{height:N,hasBorder:!0,paddingSize:_,"data-test-subj":"alerts-histogram-panel",$toggleStatus:Fe},o.a.createElement(h.a,{alignHeader:e,id:ve,inspectTitle:T,outerDirection:"row",title:Je,titleSize:me,toggleStatus:Fe,toggleQuery:Ne,showInspectButton:null==a,subtitle:!xe&&se&&Ge,isInspectDisabled:Se,hideSubtitle:!0},o.a.createElement(n.EuiFlexGroup,{alignItems:"flexStart","data-test-subj":"panelFlexGroup",gutterSize:"none"},o.a.createElement(n.EuiFlexItem,{grow:!1},oe&&o.a.createElement(o.a.Fragment,null,o.a.createElement(G.b,{ref:l,"data-test-subj":"stackByComboBox",selected:Ie,onSelect:Me,prepend:le,inputRef:ee,width:ce}),ne&&o.a.createElement(o.a.Fragment,null,o.a.createElement(n.EuiSpacer,{"data-test-subj":"placeholderSpacer",size:"s"}),o.a.createElement(n.EuiToolTip,{"data-test-subj":"placeholderTooltip",content:z},o.a.createElement(G.b,{isDisabled:!0,"data-test-subj":"stackByPlaceholder",onSelect:u.noop,prepend:K.b,selected:"",width:ce})))),null!=w&&w),null!=a&&o.a.createElement(X,{grow:!1},a(ve)),Ye)),Fe?xe?o.a.createElement(j.a,null):o.a.createElement(L,{chartHeight:t,data:We,from:ye,legendItems:Ke,legendPosition:P,legendMinWidth:ae?300:void 0,loading:Re,to:fe,showLegend:ie,updateDateRange:pe}):null))}));ee.displayName="AlertsHistogramPanel"},function(e,t,a){"use strict";a.d(t,"a",(function(){return I}));var n=a(4),i=a.n(n),r=a(1064),s=a.n(r),o=a(540),l=a(32),c=a(0),u=a(35),d=a(1);const p=({values:e})=>i.a.createElement(i.a.Fragment,null,e.map(((t,a)=>i.a.createElement(i.a.Fragment,{key:a},i.a.createElement(l.EuiCode,null,t),a<e.length-1?", ":""))));var m=a(544);const g=c.i18n.translate("xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.messageTitle",{defaultMessage:"Insufficient privileges"}),b=c.i18n.translate("xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.cannotEditRules",{defaultMessage:"Without that privilege you cannot create or edit detection engine rules."}),f=c.i18n.translate("xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.cannotEditLists",{defaultMessage:"Without these privileges, you cannot create or edit value lists."}),y=c.i18n.translate("xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.cannotEditAlerts",{defaultMessage:"Without these privileges, you cannot view or change status of alerts."}),h=({indexPrivileges:e,featurePrivileges:t=[]})=>i.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.messageBody.messageDetail",defaultMessage:"{essence} {indexPrivileges} {featurePrivileges} Related documentation: {docs}",values:{essence:i.a.createElement("p",null,i.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.messageBody.essenceDescription",defaultMessage:"You need the following privileges to fully access this functionality. Contact your administrator for further assistance."})),indexPrivileges:e.length>0?i.a.createElement(i.a.Fragment,null,i.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.messageBody.indexPrivilegesTitle",defaultMessage:"Missing Elasticsearch index privileges:"}),i.a.createElement("ul",null,e.map((([e,t])=>i.a.createElement("li",{key:e},x(e,t)))))):null,featurePrivileges:t.length>0?i.a.createElement(i.a.Fragment,null,i.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.messageBody.featurePrivilegesTitle",defaultMessage:"Missing Kibana feature privileges:"}),i.a.createElement("ul",null,t.map((([e,t])=>i.a.createElement("li",{key:e},k(e,t)))))):null,docs:i.a.createElement("ul",null,i.a.createElement("li",null,i.a.createElement(m.a,null)),i.a.createElement("li",null,i.a.createElement(m.c,null)))}}),E={[d.pc]:{all:b},[d.db]:{write:y},[d.X]:{write:f},[d.W]:{write:f}},v=(e,t)=>{var a;const n=null===(a=Object.entries(E).find((([e])=>t.startsWith(e))))||void 0===a?void 0:a[1];return e.map((e=>null==n?void 0:n[e])).filter(Boolean).join(" ")},x=(e,t)=>i.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.messageBody.missingIndexPrivileges",defaultMessage:"Missing {privileges} privileges for the {index} index. {explanation}",values:{privileges:i.a.createElement(p,{values:t}),index:i.a.createElement(l.EuiCode,null,e),explanation:v(t,e)}}),k=(e,t)=>i.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.missingPrivilegesCallOut.messageBody.missingFeaturePrivileges",defaultMessage:"Missing {privileges} privileges for the {index} feature. {explanation}",values:{privileges:i.a.createElement(p,{values:t}),index:i.a.createElement(l.EuiCode,null,e),explanation:v(t,e)}});var S=a(165),j=a(116);const O=["read","write","view_index_metadata","maintenance"],w=e=>{const t=(e=>{const[t]=Object.keys(e);return t})(e),a=e[t],n=O.filter((e=>!a[e]));if(n.length)return[t,n]},T=()=>{const e=(()=>{const{detectionEnginePrivileges:e,listPrivileges:t}=Object(j.a)(),[{canUserCRUD:a}]=Object(S.b)();return Object(n.useMemo)((()=>{const n=[],i=[];if(null==a||null==t.result||null==e.result)return{featurePrivileges:n,indexPrivileges:i};!1===a&&n.push([d.pc,["all"]]);const r=w(t.result.listItems.index);r&&i.push(r);const s=w(t.result.lists.index);s&&i.push(s);const o=w(e.result.index);return o&&i.push(o),{featurePrivileges:n,indexPrivileges:i}}),[a,t,e])})(),t=Object(n.useMemo)((()=>e.indexPrivileges.length>0||e.featurePrivileges.length>0?{type:"primary",id:`missing-user-privileges-${s()(e)}`,title:g,description:h(e)}:null),[e]);return t&&i.a.createElement(o.c,{namespace:"detections",condition:!0,message:t})},I=Object(n.memo)(T)},function(e,t,a){"use strict";a.d(t,"i",(function(){return n})),a.d(t,"h",(function(){return i})),a.d(t,"g",(function(){return r})),a.d(t,"f",(function(){return s})),a.d(t,"e",(function(){return o})),a.d(t,"d",(function(){return l})),a.d(t,"c",(function(){return c})),a.d(t,"b",(function(){return u})),a.d(t,"a",(function(){return d}));const n=e=>"UninitialisedResourceState"===e.type,i=e=>"LoadingResourceState"===e.type,r=e=>"LoadedResourceState"===e.type,s=e=>"FailedResourceState"===e.type,o=()=>({type:"UninitialisedResourceState"}),l=e=>({type:"LoadingResourceState",previousState:e}),c=e=>({type:"LoadedResourceState",data:e}),u=(e,t)=>({type:"FailedResourceState",error:e,lastLoadedState:t}),d=e=>{switch(e.type){case"LoadedResourceState":case"FailedResourceState":return e;case"UninitialisedResourceState":case"LoadingResourceState":return o()}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return b})),a.d(t,"b",(function(){return f}));var n=a(32),i=a(4),r=a.n(i),s=a(316),o=a(255),l=a(205),c=a(176),u=a(104),d=a(94),p=a(95),m=a(542),g=a(0);const b=e=>{var t,a,u;const{columnId:d,rowIndex:p,scopeId:b}=e,f=Object(i.useMemo)((()=>d===c.l&&Object(o.c)(b)&&0===p&&!e.isDetails),[d,e.isDetails,p,b]),y=null===(t=e.ecsData)||void 0===t||null===(a=t.kibana)||void 0===a||null===(u=a.alert.suppression)||void 0===u?void 0:u.docs_count,h=r.a.createElement(s.a,{isTourAnchor:f,step:l.a.pointToAlertName,tourId:l.b.alertsCases},r.a.createElement(m.a,e));return d===c.l&&y&&parseInt(y[0],10)>0?r.a.createElement(n.EuiFlexGroup,{gutterSize:"xs"},r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiToolTip,{position:"top",content:(E=parseInt(y[0],10),g.i18n.translate("xpack.securitySolution.configurations.suppressedAlerts",{defaultMessage:"Alert has {numAlertsSuppressed} suppressed alerts",values:{numAlertsSuppressed:E}}))},r.a.createElement(n.EuiIcon,{type:"layers"}))),r.a.createElement(n.EuiFlexItem,{grow:!1},h)):h;var E},f=({setFlyoutAlert:e})=>{const{browserFields:t}=Object(d.d)(p.SourcererScopeName.detections);return({columnId:e,colIndex:a,data:n,ecsData:i,eventId:s,globalFilters:o,header:l,isDetails:c=!1,isDraggable:d=!1,isExpandable:p,isExpanded:g,linkValues:b,rowIndex:f,rowRenderers:y,setCellProps:h,truncate:E=!0})=>{const v=e.split(".");let x=null!=l?l:{id:e};if(v.length>1&&t[v[0]]){var k,S;const a=null!==(k=(null!==(S=t[v[0]].fields)&&void 0!==S?S:{})[e])&&void 0!==k?k:{};x={...x,...a}}else if(1===v.length){var j,O;const a=null!==(j=(null!==(O=t.base.fields)&&void 0!==O?O:{})[e])&&void 0!==j?j:{};x={...x,...a}}return r.a.createElement(m.a,{browserFields:t,columnId:e,data:n,ecsData:i,eventId:s,globalFilters:o,header:x,isDetails:c,isDraggable:d,isExpandable:p,isExpanded:g,linkValues:b,rowIndex:f,colIndex:a,rowRenderers:y,setCellProps:h,scopeId:u.d.casePage,truncate:E})}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));var n=a(34),i=a(4),r=a(53),s=a.n(r),o=a(92),l=a.n(o),c=a(11),u=a(42),d=a(50),p=a(77),m=a(85),g=a(84),b=a(0);const f=b.i18n.translate("xpack.securitySolution.timeline.failDescription",{defaultMessage:"An error has occurred"}),y=b.i18n.translate("xpack.securitySolution.timeline.failSearchDescription",{defaultMessage:"Failed to run search"}),h=({entityType:e=d.EntityType.EVENTS,indexName:t,eventId:a,runtimeMappings:r,skip:o})=>{const{data:b}=Object(p.k)().services,h=Object(i.useRef)((()=>Promise.resolve())),E=Object(i.useRef)(new AbortController),v=Object(i.useRef)(new c.Subscription),[x,k]=Object(i.useState)(!0),[S,j]=Object(i.useState)(null),{addError:O,addWarning:w}=Object(g.a)(),[T,I]=Object(i.useState)(null),[C,M]=Object(i.useState)(null),[F,D]=Object(i.useState)(void 0),A=Object(i.useCallback)((e=>{if(null==e||o||Object(n.isEmpty)(e.eventId))return;const t=async()=>{E.current=new AbortController,k(!0),v.current=b.search.search(e,{strategy:"timelineSearchStrategy",abortSignal:E.current.signal}).subscribe({next:e=>{Object(u.isCompleteResponse)(e)?Promise.resolve().then((()=>{s.a.unstable_batchedUpdates((()=>{k(!1),I(e.data||[]),D(e.rawResponse.hits.hits[0]),M(e.ecs||null),v.current.unsubscribe()}))})):Object(u.isErrorResponse)(e)&&(k(!1),w(f),v.current.unsubscribe())},error:e=>{k(!1),O(e,{title:y}),v.current.unsubscribe()}})};v.current.unsubscribe(),E.current.abort(),t(),h.current=t}),[b.search,O,w,o]);return Object(i.useEffect)((()=>{j((n=>{const i={...null!=n?n:{},entityType:e,indexName:t,eventId:a,factoryQueryType:m.z.details,runtimeMappings:r};return l()(n,i)?n:i}))}),[e,a,t,r]),Object(i.useEffect)((()=>(A(S),()=>{v.current.unsubscribe(),E.current.abort()})),[S,A]),[x,T,F,C,h.current]}},function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(7);const i=e=>{const{id:t,revision:a,created_by:i,created_at:r,updated_by:s,updated_at:o,...l}=e,c=Object(n.cloneDeep)(l),u=c.inputs[0].config.policy.value;return[u.windows.popup.malware,u.mac.popup.malware].forEach((e=>e.message.trim())),c}},function(e,t,a){"use strict";a.d(t,"a",(function(){return y}));var n=a(82),i=a.n(n),r=a(32),s=a(34),o=a(4),l=a.n(o),c=a(33),u=a.n(c),d=a(100),p=a(0);const m=[{value:"s",text:p.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRuleForm.secondsOptionDescription",{defaultMessage:"Seconds"})},{value:"m",text:p.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRuleForm.minutesOptionDescription",{defaultMessage:"Minutes"})},{value:"h",text:p.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRuleForm.hoursOptionDescription",{defaultMessage:"Hours"})},{value:"d",text:p.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRuleForm.daysOptionDescription",{defaultMessage:"Days"})}],g=u()(r.EuiFlexItem).withConfig({displayName:"StyledLabelAppend",componentId:"sc-d3i8n6-0"})(["&.euiFlexItem.euiFlexItem--flexGrowZero{margin-left:31px;}"]),b=u()(r.EuiFormRow).withConfig({displayName:"StyledEuiFormRow",componentId:"sc-d3i8n6-1"})(["max-width:none;.euiFormControlLayout{max-width:auto;width:auto;}.euiFormControlLayout__childrenWrapper > *:first-child{box-shadow:none;height:38px;width:100%;}.euiFormControlLayout__childrenWrapper > select{background-color:",";color:",";}.euiFormControlLayout--group .euiFormControlLayout{min-width:100px;}.euiFormControlLayoutIcons{color:",";}.euiFormControlLayout:not(:first-child){border-left:1px solid ",";}"],(({theme:e})=>Object(r.transparentize)(e.eui.euiColorPrimary,.1)),(({theme:e})=>e.eui.euiColorPrimary),(({theme:e})=>e.eui.euiColorPrimary),(({theme:e})=>e.eui.euiColorLightShade)),f=u()(r.EuiSelect).withConfig({displayName:"MyEuiSelect",componentId:"sc-d3i8n6-2"})(["width:auto;"]),y=({dataTestSubj:e,field:t,idAria:a,isDisabled:n,minimumValue:c=0,timeTypes:u=["s","m","h"],fullWidth:p=!1})=>{const[y,h]=Object(o.useState)(u[0]),[E,v]=Object(o.useState)(0),{isInvalid:x,errorMessage:k}=Object(d.i)(t),{value:S,setValue:j}=t,O=Object(o.useCallback)((e=>{h(e.target.value),j(`${E}${e.target.value}`)}),[j,E]),w=Object(o.useCallback)((e=>{const t=((e,t=0)=>{const a=parseInt(e,10);return Number.isNaN(a)?t:Math.max(t,Math.min(a,Number.MAX_SAFE_INTEGER))})(e.target.value,c);v(t),j(`${t}${y}`)}),[c,j,y]);Object(o.useEffect)((()=>{if(S!==`${E}${y}`){const e=S.match(/\d+/g),t=S.match(/[a-zA-Z]+/g);Object(s.isEmpty)(e)||null==e||isNaN(Number(e[0]))||Number(e[0])===Number(E)||v(Number(e[0])),!Object(s.isEmpty)(t)&&null!=t&&u.includes(t[0])&&t[0]!==y&&h(t[0])}}),[y,u,E,S]);const T={disabled:n},I=Object(o.useMemo)((()=>l.a.createElement(r.EuiFlexGroup,{gutterSize:"s",justifyContent:"flexStart",alignItems:"center"},l.a.createElement(r.EuiFlexItem,{grow:!1,component:"span"},t.label),l.a.createElement(g,{grow:!1,component:"span"},t.labelAppend))),[t.label,t.labelAppend]);return l.a.createElement(b,{label:I,helpText:t.helpText,error:k,isInvalid:x,fullWidth:p,"data-test-subj":e,describedByIds:a?[a]:void 0},l.a.createElement(r.EuiFormControlLayout,{append:l.a.createElement(f,i()({fullWidth:!1,options:m.filter((e=>u.includes(e.value))),onChange:O,value:y,"data-test-subj":"timeType"},T))},l.a.createElement(r.EuiFieldNumber,i()({fullWidth:!0,min:c,max:Number.MAX_SAFE_INTEGER,onChange:w,value:E,"data-test-subj":"interval"},T))))}},function(e,t,a){"use strict";a.d(t,"b",(function(){return n.a})),a.d(t,"a",(function(){return y})),a(573),a(480),a(497),a(499);var n=a(498),i=(a(500),a(4)),r=a(195),s=a(172),o=a(7),l=a(139),c=a(165),u=a(1),d=a(77),p=a(510),m=a(724),g=a(168),b=a(338);const f={contentText:"",rulesReferences:[],isLoading:!1,listId:"",listNamespaceType:"single"},y=e=>{const t=Object(d.o)(),{services:a}=Object(d.k)(),{http:n,notifications:y}=a,{navigateToApp:h}=a.application,{exportExceptionList:E,deleteExceptionList:v}=Object(s.c)(n),[{loading:x,canUserCRUD:k,canUserREAD:S}]=Object(c.b)(),[j,O]=Object(i.useState)(),[w,T]=Object(i.useState)(!1),[I,C]=Object(i.useState)(),[M,F]=Object(i.useState)(!1),[D,A]=Object(i.useState)([]),[_,N]=Object(i.useState)([]),[R,P]=Object(i.useState)(!0),[L,B]=Object(i.useState)(""),[q,z]=Object(i.useState)(),[$,V]=Object(i.useState)(!1),[U,H]=Object(i.useState)(f),[G,Q]=Object(i.useState)(!0),[W,K]=Object(i.useState)(!1),Y=Object(b.b)(),J=Object(i.useMemo)((()=>({pageId:u.uc.exceptions,path:"",onNavigate:()=>{h(u.B,{deepLinkId:u.uc.exceptions,path:""})}})),[h]),X=Object(i.useCallback)(((e,a,n,i)=>{null==t||t.addError(e,{title:null!=n?n:"",toastMessage:null!=i?i:""}),B(null!=a?a:"")}),[t]),Z=Object(i.useCallback)((async e=>{const t=await Object(p.e)(e.list_id);A(t)}),[]),ee=Object(i.useCallback)((async()=>{try{if(l.a.includes(e))return F(!0);O(!0);const t=await Object(p.d)({id:e,http:n});if(!t||!Object(m.b)(t))return O(!1),F(!0);if(C(t),await Z(t),O(!1),F(!1),Object(m.a)(t))return P(!1)}catch(e){X(e,r.i.ERROR,g.n,g.m)}}),[e,n,Z,X]);Object(i.useEffect)((()=>{ee()}),[ee]);const[te,ae]=Object(i.useState)(!1),ne=Object(i.useCallback)((async t=>{try{I&&await Object(p.i)({http:n,list:{id:I.id,list_id:e,type:I.type,name:t.name,description:t.description||I.description,namespace_type:I.namespace_type}})}catch(e){X(e)}}),[e,X,n,I]),ie=Object(i.useCallback)((async()=>{try{if(!I)return;await E({id:I.id,listId:I.list_id,namespaceType:I.namespace_type,onError:e=>X(e),onSuccess:e=>{z(e),null==t||t.addSuccess(g.y(I.list_id))}})}catch(e){X(e,void 0,g.o,g.p)}}),[I,E,X,t]),re=Object(i.useCallback)((e=>()=>{y.toasts.addSuccess({title:g.ab(null!=e?e:U.listId)})}),[y.toasts,U.listId]),se=Object(i.useCallback)((e=>{X(e)}),[X]),oe=Object(i.useCallback)((async()=>{try{if(!I)return;await v({id:I.id,namespaceType:I.namespace_type,onError:se,onSuccess:re})}catch(e){X(e)}finally{H(f),V(!1),h(u.B,{deepLinkId:u.uc.exceptions,path:""})}}),[I,v,se,re,X,h]),le=Object(i.useCallback)((()=>{try{if(!I)return;H({contentText:D.length?g.cb(D.length):g.Z(I.name),rulesReferences:D.map((({name:e})=>e)),isLoading:!0,listId:I.list_id,listNamespaceType:I.namespace_type}),V(!0)}catch(e){X(e)}}),[X,D,I]),ce=Object(i.useCallback)((()=>{V(!1),H({contentText:"",rulesReferences:[],isLoading:!1,listId:"",listNamespaceType:"single"})}),[]),ue=Object(i.useCallback)((async()=>{try{await Object(p.h)({rules:D,listId:e}),oe()}catch(e){X(e)}}),[e,D,X,oe]),de=Object(i.useCallback)((()=>{A(_),N(_),ae(!1),T(!1),Q(!0)}),[_]),pe=Object(i.useCallback)((()=>{ae(!0)}),[]),me=Object(i.useCallback)((()=>_.filter((e=>!D.includes(e)))),[D,_]),ge=Object(i.useCallback)((()=>D.filter((e=>!_.includes(e)))),[D,_]),be=Object(i.useCallback)((e=>{N(e),Q(!1)}),[]),fe=Object(i.useCallback)((async()=>{try{if(!I)return ae(!1);T(!0);const t=me(),a=ge();if(!t.length&&!a.length||Object(o.isEqual)(t,a))return de();Promise.all([Object(p.h)({rules:a,listId:e}),Object(p.f)({rules:t,listId:e,id:I.id,listType:I.type,listNamespaceType:I.namespace_type})]).then((()=>{K(!0),de()})).then((()=>K(!1))).then((()=>Y())).catch((e=>{X(e,void 0,g.A,g.B),T(!1)}))}catch(e){X(e)}}),[I,me,ge,e,de,X,Y]),ye=Object(i.useCallback)((()=>{ae(!1)}),[]);return{isLoading:j||x,invalidListId:M,isReadOnly:!(k||!S),list:I,listName:null==I?void 0:I.name,listDescription:null==I?void 0:I.description,listId:e,canUserEditList:R,linkedRules:D,exportedList:q,viewerStatus:L,showManageRulesFlyout:te,headerBackOptions:J,referenceModalState:U,showReferenceErrorModal:$,showManageButtonLoader:w,refreshExceptions:W,disableManageButton:G,handleDelete:le,onEditListDetails:ne,onExportList:ie,onDeleteList:oe,onManageRules:pe,onSaveManageRules:fe,onCancelManageRules:ye,onRuleSelectionChange:be,handleCloseReferenceErrorModal:ce,handleReferenceDelete:ue}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return T}));var n=a(32),i=a(4),r=a.n(i),s=a(33),o=a.n(s),l=a(0),c=a(38),u=a(79),d=a(617),p=a(7),m=a(48),g=a(78),b=a(99),f=a(86),y=a(77),h=a(102),E=a(708),v=a(12),x=a(81),k=a(2);const S=o.a.div.withConfig({displayName:"AdditionalContent",componentId:"sc-19ewdav-0"})(["padding:2px;"]);S.displayName="AdditionalContent";const j=o.a.div.withConfig({displayName:"StyledHoverActionsContainer",componentId:"sc-19ewdav-1"})(["display:flex;"," ",""],(e=>e.$isActive?"\n    .hoverActions-active {\n      .timelines__hoverActionButton,\n      .securitySolution__hoverActionButton {\n        opacity: 1;\n      }\n    }\n  ":""),(e=>e.$showOwnFocus?`\n    &:focus-within {\n      .timelines__hoverActionButton,\n      .securitySolution__hoverActionButton {\n        opacity: 1;\n      }\n    }\n\n    &:hover {\n      .timelines__hoverActionButton,\n      .securitySolution__hoverActionButton {\n        opacity: 1;\n      }\n    }\n\n  .timelines__hoverActionButton,\n  .securitySolution__hoverActionButton {\n    opacity: ${e.$showTopN?1:0};\n\n      &:focus {\n        opacity: 1;\n      }\n    }\n  `:"")),O=o()(j).withConfig({displayName:"StyledHoverActionsContainerWithPaddingsAndMinWidth",componentId:"sc-19ewdav-2"})(["min-width:",";padding:",";position:relative;"],(({$hiddenActionsCount:e})=>138-26*e+"px"),(e=>`0 ${e.theme.eui.euiSizeS}`)),w=({ownFocus:e,showTopN:t})=>!t&&!e,T=r.a.memo((({additionalContent:e=null,closePopOver:t,closeTopN:a,dataProvider:s,dataType:o,draggableId:T,enableOverflowButton:I=!1,applyWidthAndPadding:C=!0,field:M,fieldType:F,isAggregatable:D,goGetTimelineId:A,isObjectArray:_,hideAddToTimeline:N=!1,hideTopN:R=!1,onFilterAdded:P,ownFocus:L,showOwnFocus:B=!0,showTopN:q,scopeId:z,toggleColumn:$,toggleTopN:V,values:U})=>{const[H,G]=Object(i.useState)(),[Q,W]=Object(i.useState)(!1),[K,Y]=Object(i.useState)(!1),J=Object(i.useCallback)((()=>{W((e=>!e)),Y(!K)}),[K,Y]),X=Object(i.useCallback)((()=>{a&&a(),W(!1),Y(!1),t&&t()}),[t,a]),Z=Object(i.useRef)(!0),ee=Object(i.useRef)(null);Object(i.useEffect)((()=>{Z.current&&null!=A&&null==z&&(Z.current=!1,A(!0))}),[A,z]),Object(i.useEffect)((()=>{L&&setTimeout((()=>{var e;null===(e=ee.current)||void 0===e||e.focus()}),0)}),[L]);const te=Object(i.useCallback)((e=>{if(L)switch(e.key){case d.a:Object(c.stopPropagationAndPreventDefault)(e),V();break;case"Enter":break;case"Escape":Object(c.stopPropagationAndPreventDefault)(e);break;default:G(e)}}),[L,V]),ae=z===u.j.casePage,ne=z===u.j.active,ie=z===u.j.detectionsAlertDetailsPage,re=z===k.a.entityAnalytics,se=Object(i.useMemo)((()=>(ie||re)&&!ne),[ne,ie,re]),oe=Object(i.useMemo)((()=>(R?1:0)+(se?2:0)),[se,R]),{overflowActionItems:le,allActionItems:ce}=(({dataProvider:e,dataType:t,defaultFocusedButtonRef:a,draggableId:s,enableOverflowButton:o,field:l,fieldType:c,isAggregatable:d,handleHoverActionClicked:k,hideFilters:S,hideTopN:j,hideAddToTimeline:O,isCaseView:w,isObjectArray:T,isOverflowPopoverOpen:I,itemsToShow:C=2,onFilterAdded:M,onOverflowButtonClick:F,ownFocus:D,showTopN:A,stKeyboardEvent:_,scopeId:N,toggleColumn:R,toggleTopN:P,values:L})=>{const B=Object(y.k)(),q=Object(g.useDispatch)(),{timelines:z,uiSettings:$}=B.services,{getAddToTimelineButton:V,getColumnToggleButton:U,getCopyButton:H,getFilterForValueButton:G,getFilterOutValueButton:Q,getOverflowButton:W}=z.getHoverActions(),K=Object(i.useMemo)((()=>B.services.data.query.filterManager),[B.services.data.query.filterManager]),Y=Object(i.useMemo)((()=>f.b.getTimelineByIdSelector()),[]),J=Object(x.a)((e=>{var t;return Object(b.isActiveTimeline)(null!=N?N:"")?null===(t=Y(e,null!=N?N:""))||void 0===t?void 0:t.filterManager:void 0})),X=Object(i.useMemo)((()=>Object(b.isActiveTimeline)(null!=N?N:"")?null!=J?J:new m.FilterManager($):K),[N,J,$,K]),Z=Object(i.useCallback)((()=>{e&&!Object(p.isEmpty)(e)&&q(Object(v.addProvider)({id:u.j.active,providers:e instanceof Array?e:[e]}))}),[e,q]),ee=Object(i.useCallback)((()=>{k&&k(),Z()}),[k,Z]),te=Object(i.useMemo)((()=>!S&&null!=L&&(o||!A&&!o)&&!w),[o,S,w,A,L]),ae=T&&"geo_point"!==l||w,ne=Object(i.useMemo)((()=>r.a.createElement(E.a,{Component:o?n.EuiContextMenuItem:void 0,"data-test-subj":"hover-actions-show-top-n",enablePopOver:!o&&w,field:l,key:"hover-actions-show-top-n",onClick:P,onFilterAdded:M,ownFocus:D,showTopN:A,showTooltip:!o,scopeId:N,value:L})),[o,w,l,P,M,D,A,N,L]),ie=Object(i.useMemo)((()=>[te?r.a.createElement("div",{"data-test-subj":"hover-actions-filter-for",key:"hover-actions-filter-for"},G({defaultFocusedButtonRef:a,field:l,filterManager:X,keyboardEvent:_,onClick:k,onFilterAdded:M,ownFocus:D,showTooltip:!o,value:L})):null,te?r.a.createElement("div",{"data-test-subj":"hover-actions-filter-out",key:"hover-actions-filter-out"},Q({field:l,filterManager:X,keyboardEvent:_,onFilterAdded:M,ownFocus:D,onClick:k,showTooltip:!o,value:L})):null,R&&!ae?r.a.createElement("div",{"data-test-subj":"hover-actions-toggle-column",key:"hover-actions-toggle-column"},U({Component:o?n.EuiContextMenuItem:void 0,field:l,isDisabled:T&&"geo_point"!==t,isObjectArray:T,keyboardEvent:_,ownFocus:D,onClick:k,showTooltip:!o,toggleColumn:R,value:L})):null,null==L||null==s&&Object(p.isEmpty)(e)||O?null:r.a.createElement("div",{"data-test-subj":"hover-actions-add-timeline",key:"hover-actions-add-timeline"},V({Component:o?n.EuiContextMenuItem:void 0,dataProvider:e,draggableId:s,field:l,keyboardEvent:_,ownFocus:D,onClick:ee,showTooltip:!o,value:L})),Object(h.d)({fieldType:c,isAggregatable:d,fieldName:l,hideTopN:j})?ne:null,null!=l?r.a.createElement("div",{"data-test-subj":"hover-actions-copy-button",key:"hover-actions-copy-button"},H({Component:o?n.EuiContextMenuItem:void 0,field:l,isHoverAction:!0,keyboardEvent:_,ownFocus:D,onClick:k,showTooltip:!o,value:L})):null].filter((e=>null!=e))),[e,t,a,s,o,l,c,d,X,V,U,H,G,Q,k,ee,O,j,T,M,D,ae,te,ne,_,R,L]);return{overflowActionItems:Object(i.useMemo)((()=>[...ie.slice(0,C),...o&&C>0&&C<ie.length?[W({closePopOver:k,field:l,keyboardEvent:_,ownFocus:D,onClick:F,showTooltip:!o,value:L,items:A?[ne]:ie.slice(C),isOverflowPopoverOpen:!!I})]:[]].filter((e=>null!=e))),[ie,o,l,W,k,I,C,F,ne,D,A,_,L]),allActionItems:Object(i.useMemo)((()=>!A||o||w?ie:[ne]),[A,o,w,ne,ie])}})({dataProvider:s,dataType:o,defaultFocusedButtonRef:ee,draggableId:T,enableOverflowButton:I&&!ae,field:M,fieldType:F,hideFilters:se,isAggregatable:D,handleHoverActionClicked:X,hideAddToTimeline:N,hideTopN:R,isCaseView:ae,isObjectArray:_,isOverflowPopoverOpen:K,onFilterAdded:P,onOverflowButtonClick:J,ownFocus:L,showTopN:q,stKeyboardEvent:H,toggleColumn:$,toggleTopN:V,values:U,scopeId:z}),ue=C?O:j;return r.a.createElement(n.EuiFocusTrap,{disabled:w({ownFocus:L,showTopN:q})},r.a.createElement(ue,{onKeyDown:te,$showTopN:q,$showOwnFocus:B,$hiddenActionsCount:oe,$isActive:Q,className:Q?"hoverActions-active":""},r.a.createElement(n.EuiScreenReaderOnly,null,r.a.createElement("p",null,(de=M,l.i18n.translate("xpack.securitySolution.dragAndDrop.youAreInADialogContainingOptionsScreenReaderOnly",{values:{fieldName:de},defaultMessage:"You are in a dialog, containing options for field {fieldName}. Press tab to navigate options. Press escape to exit."})))),null!=e&&r.a.createElement(S,null,e),I&&!ae?le:ce));var de}));T.displayName="HoverActions"},function(e,t,a){"use strict";a.d(t,"a",(function(){return b})),a.d(t,"b",(function(){return S})),a.d(t,"c",(function(){return j}));var n=a(43),i=a.n(n),r=a(87),s=a(0);const o=s.i18n.translate("xpack.securitySolution.formatted.duration.noDurationTooltip",{defaultMessage:"no duration"}),l=s.i18n.translate("xpack.securitySolution.formatted.duration.invalidDurationTooltip",{defaultMessage:"invalid duration"}),c=s.i18n.translate("xpack.securitySolution.formatted.duration.aNanosecondTooltip",{defaultMessage:"a nanosecond"}),u=s.i18n.translate("xpack.securitySolution.formatted.duration.aFewNanosecondsTooltip",{defaultMessage:"a few nanoseconds"}),d=s.i18n.translate("xpack.securitySolution.formatted.duration.aMillisecondTooltip",{defaultMessage:"a millisecond"}),p=s.i18n.translate("xpack.securitySolution.formatted.duration.aFewMillisecondsTooltip",{defaultMessage:"a few milliseconds"}),m=s.i18n.translate("xpack.securitySolution.formatted.duration.aSecondTooltip",{defaultMessage:"a second"}),g=s.i18n.translate("xpack.securitySolution.formatted.duration.zeroNanosecondsTooltip",{defaultMessage:"zero nanoseconds"}),b=1e6,f=1e3,y=e=>Number.isInteger(e.milliseconds())?`${e.milliseconds()}ms`:`${e.milliseconds().toFixed(6)}ms`,h=e=>`${e.seconds().toFixed()}s${e.milliseconds()>0?` ${y(e)}`:""}`,E=e=>`${e.minutes()}m ${h(e)}`,v=e=>`${e.hours()}h ${E(e)}`,x=e=>`${e.days()}d ${v(e)}`,k=e=>`${e.years()>0||e.months()>0?`${e.months()}m `:""}${x(e)}`,S=e=>{const t=Number(e);if(null==e)return Object(r.e)();if(Number.isNaN(t)||t<0)return`${e}`;if(t<b)return`${t}ns`;const a=i.a.duration(t/b),n=a.asMilliseconds();return n<f?y(a):n<6e4?h(a):n<36e5?E(a):n<864e5?v(a):n<2592e6?x(a):n<31536e6?k(a):(e=>`${e.years()>0?`${e.years()}y `:""}${k(e)}`)(a)},j=e=>{if(null==e)return o;const t=Number(e);if(Number.isNaN(t)||t<0)return l;if(0===t)return g;if(1===t)return c;if(t<b)return u;if(t===b)return d;const a=t/b;return a<f?p:a===f?m:i.a.duration(a).humanize()}},,,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(33),i=a.n(n),r=a(4),s=a.n(r),o=(a(36),a(32)),l=a(14);const c=({text:e,className:t})=>{const{euiTheme:a}=Object(o.useEuiTheme)();return s.a.createElement(u,{label:null!=e?e:l.a,size:"s",className:t,$_css:a.size.s,$_css2:a.colors.text})};var u=i()(o.EuiBetaBadge).withConfig({displayName:"_StyledEuiBetaBadge",componentId:"sc-oot5f7-0"})(["margin-left:",";color:",";"],(e=>e.$_css),(e=>e.$_css2))},function(e,t,a){"use strict";a.d(t,"c",(function(){return s})),a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return l}));var n=a(85),i=a(253),r=a(134);const s=e=>({...e.page.queries,[r.HostsTableType.authentications]:{...e.page.queries[r.HostsTableType.authentications],activePage:i.a},[r.HostsTableType.hosts]:{...e.page.queries[r.HostsTableType.hosts],activePage:i.a},[r.HostsTableType.events]:{...e.page.queries[r.HostsTableType.events],activePage:i.a},[r.HostsTableType.uncommonProcesses]:{...e.page.queries[r.HostsTableType.uncommonProcesses],activePage:i.a}}),o=e=>({...e.details.queries,[r.HostsTableType.authentications]:{...e.details.queries[r.HostsTableType.authentications],activePage:i.a},[r.HostsTableType.hosts]:{...e.details.queries[r.HostsTableType.hosts],activePage:i.a},[r.HostsTableType.events]:{...e.details.queries[r.HostsTableType.events],activePage:i.a},[r.HostsTableType.uncommonProcesses]:{...e.details.queries[r.HostsTableType.uncommonProcesses],activePage:i.a}}),l=(e,t)=>e.length>0?[{query:{bool:{should:e.map((e=>({match_phrase:{[t===n.v.user?n.w.userRisk:n.w.hostRisk]:{query:e}}})))}},meta:{alias:null,disabled:!1,negate:!1}}]:[]},function(e,t,a){"use strict";a.d(t,"h",(function(){return i})),a.d(t,"a",(function(){return r})),a.d(t,"c",(function(){return s})),a.d(t,"g",(function(){return o})),a.d(t,"b",(function(){return l})),a.d(t,"d",(function(){return c})),a.d(t,"e",(function(){return u})),a.d(t,"f",(function(){return d}));var n=a(0);const i=n.i18n.translate("xpack.securitySolution.hosts.pageTitle",{defaultMessage:"Hosts"}),r=n.i18n.translate("xpack.securitySolution.hosts.navigation.allHostsTitle",{defaultMessage:"All hosts"}),s=n.i18n.translate("xpack.securitySolution.hosts.navigation.authenticationsTitle",{defaultMessage:"Authentications"}),o=n.i18n.translate("xpack.securitySolution.hosts.navigation.uncommonProcessesTitle",{defaultMessage:"Uncommon processes"}),l=n.i18n.translate("xpack.securitySolution.hosts.navigation.anomaliesTitle",{defaultMessage:"Anomalies"}),c=n.i18n.translate("xpack.securitySolution.hosts.navigation.eventsTitle",{defaultMessage:"Events"}),u=n.i18n.translate("xpack.securitySolution.hosts.navigation.hostRiskTitle",{defaultMessage:"Host risk"}),d=n.i18n.translate("xpack.securitySolution.hosts.navigation.sessionsTitle",{defaultMessage:"Sessions"});n.i18n.translate("xpack.securitySolution.hosts.navigaton.matrixHistogram.errorFetchingEventsData",{defaultMessage:"Failed to query events data"}),n.i18n.translate("xpack.securitySolution.hosts.navigaton.hostRisk.viewDashboardButtonLabel",{defaultMessage:"View source dashboard"}),n.i18n.translate("xpack.securitySolution.hosts.navigaton.hostScoreOverTimeTitle",{defaultMessage:"Host risk score over time"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(4),i=a.n(n),r=a(33),s=a.n(r),o=a(123);const l=s.a.div.withConfig({displayName:"ProviderContainerComponent",componentId:"sc-ifkluc-0"})([""," ",""],(({isDragging:e})=>!e&&Object(r.css)(["&{border-radius:2px;padding:0 4px 0 8px;position:relative;z-index:"," !important;&::before{background-image:linear-gradient( 135deg,"," 25%,transparent 25% ),linear-gradient( -135deg,"," 25%,transparent 25% ),linear-gradient( 135deg,transparent 75%,"," 75% ),linear-gradient( -135deg,transparent 75%,"," 75% );background-position:0 0,1px 0,1px -1px,0px 1px;background-size:2px 2px;bottom:2px;content:'';display:block;left:2px;position:absolute;top:2px;width:4px;}}&:hover{&,& .euiBadge,& .euiBadge__text{cursor:move;cursor:grab;}}.",":hover &,tr:hover &{&::before{background-image:linear-gradient( 135deg,"," 25%,transparent 25% ),linear-gradient( -135deg,"," 25%,transparent 25% ),linear-gradient( 135deg,transparent 75%,"," 75% ),linear-gradient( -135deg,transparent 75%,"," 75% );}}&:hover,&:focus,.",":hover &:hover,.",":focus &:focus,tr:hover &:hover,tr:hover &:focus{background-color:",";&,& a,& a:hover{color:",";}&::before{background-image:linear-gradient( 135deg,"," 25%,transparent 25% ),linear-gradient( -135deg,"," 25%,transparent 25% ),linear-gradient( 135deg,transparent 75%,"," 75% ),linear-gradient( -135deg,transparent 75%,"," 75% );}}"],(({theme:e})=>e.eui.euiZLevel0),(({theme:e})=>e.eui.euiColorMediumShade),(({theme:e})=>e.eui.euiColorMediumShade),(({theme:e})=>e.eui.euiColorMediumShade),(({theme:e})=>e.eui.euiColorMediumShade),o.f,(({theme:e})=>e.eui.euiColorDarkShade),(({theme:e})=>e.eui.euiColorDarkShade),(({theme:e})=>e.eui.euiColorDarkShade),(({theme:e})=>e.eui.euiColorDarkShade),o.f,o.f,(({theme:e})=>e.eui.euiColorPrimary),(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiColorEmptyShade))),(({isDragging:e})=>e&&Object(r.css)(["&{z-index:9999 !important;}"])));l.displayName="ProviderContainerComponent";const c=i.a.memo(l);c.displayName="ProviderContainer"},function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return r}));var n=a(0);const i=n.i18n.translate("xpack.securitySolution.dragAndDrop.copyToClipboardTooltip",{defaultMessage:"Copy to Clipboard"}),r=n.i18n.translate("xpack.securitySolution.dragAndDrop.draggableKeyboardInstructionsNotDraggingScreenReaderOnly",{defaultMessage:"Press enter for options, or press space to begin dragging."});n.i18n.translate("xpack.securitySolution.dragAndDrop.fieldLabel",{defaultMessage:"Field"}),n.i18n.translate("xpack.securitySolution.dragAndDrop.closeButtonLabel",{defaultMessage:"Close"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(32),i=a(4),r=a.n(i),s=a(121),o=a(897);const l=r.a.memo((({hideActions:e=[],modalTitle:t,onClose:a,onOpen:i})=>r.a.createElement(n.EuiModal,{"data-test-subj":"open-timeline-modal",maxWidth:1100,onClose:a},r.a.createElement(o.a,{closeModalTimeline:a,hideActions:e,isModal:!0,defaultPageSize:10,onOpenTimeline:i,title:null!=t?t:s.F}))));l.displayName="OpenTimelineModal"},function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(32),i=a(4),r=a.n(i),s=a(33);const o=a.n(s)()((({iconSide:e,children:t,...a})=>r.a.createElement(n.EuiLink,a,t))).withConfig({displayName:"Link",componentId:"sc-142a1cw-0"})(["",""],(({iconSide:e,theme:t})=>Object(s.css)(["align-items:center;display:inline-flex;vertical-align:top;white-space:nowrap;"," ",""],"left"===e&&Object(s.css)([".euiIcon{margin-right:",";}"],t.eui.euiSizeXS),"right"===e&&Object(s.css)(["flex-direction:row-reverse;.euiIcon{margin-left:",";}"],t.eui.euiSizeXS))));o.displayName="Link";const l=r.a.memo((({ariaLabel:e,children:t,color:a,dataTestSubj:s,disabled:l,href:c,iconSide:u="left",iconSize:d="s",iconType:p,onClick:m})=>{const g=Object(i.useCallback)((e=>"object"==typeof e&&null!=e&&"props"in e&&e.props&&e.props.children?g(e.props.children):null!=e&&Object.keys(e).length>0?e:""),[]),b=Object(i.useMemo)((()=>e||g(t)),[e,t,g]);return r.a.createElement(o,{className:"siemLinkIcon",color:a,"data-test-subj":s,disabled:l,href:c,iconSide:u,onClick:m,"aria-label":b},r.a.createElement(n.EuiIcon,{size:d,type:p}),r.a.createElement("span",{className:"siemLinkIcon__label"},t))}));l.displayName="LinkIcon"},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=(e,t)=>{const a=window.URL.createObjectURL(e),n=document.createElement("a");n.href=a,n.download=t,n.click(),window.URL.revokeObjectURL(a),n.remove()}},function(e,t,a){"use strict";a.d(t,"a",(function(){return E}));var n=a(32),i=a(34),r=a(4),s=a.n(r),o=a(33),l=a.n(o),c=a(79),u=a(599),d=a(136),p=a(121),m=a(87),g=a(296),b=a(85);const f=l()(n.EuiFlexItem).withConfig({displayName:"TimelineContentItem",componentId:"sc-37b7dw-0"})(["max-width:calc(100% - 56px);"]),y=l()(n.EuiFilterButton).withConfig({displayName:"StyledEuiFilterButton",componentId:"sc-37b7dw-1"})(["border-top:0;border-bottom:0;"]),h=({hideUntitled:e=!1,getSelectableOptions:t,onClosePopover:a,onTimelineChange:o,timelineType:l,placeholder:h})=>{const[E,v]=Object(r.useState)(50),[x,k]=Object(r.useState)(0),[S,j]=Object(r.useState)(""),[O,w]=Object(r.useState)(!1),{fetchAllTimeline:T,timelines:I,loading:C,totalCount:M}=Object(u.b)(),F=Object(r.useRef)(null),D=Object(r.useRef)(null),A=Object(r.useMemo)((()=>Object(i.debounce)(500,j)),[]),_=Object(r.useCallback)((e=>{A(e)}),[A]),N=Object(r.useCallback)((()=>{w(!O)}),[O]),R=Object(r.useCallback)(((e,t,a)=>{if(e<t&&F.current&&D.current){const e=F.current.clientHeight,t=D.current.clientHeight,n=1.2*e;a>10&&t-a<n&&t>x&&(k(t),v(E+50))}}),[x,E]),P=Object(r.useCallback)(((e,t)=>{const a=Object(d.f)({...e,title:e.timelineTitle})?p.Y:e.timelineTitle,r=null!=e.description&&e.description.trim().length>0?e.description:null;return s.a.createElement(n.EuiFlexGroup,{gutterSize:"s",justifyContent:"spaceBetween",alignItems:"center",responsive:!1},s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(n.EuiIcon,{type:"on"===e.checked?"check":"empty",color:"primary"})),s.a.createElement(f,{grow:!0},s.a.createElement(n.EuiFlexGroup,{gutterSize:"none",direction:"column",responsive:!1},s.a.createElement(n.EuiFlexItem,{"data-test-subj":"timeline"},s.a.createElement(n.EuiToolTip,{content:a,anchorClassName:"eui-textTruncate eui-alignMiddle"},s.a.createElement(n.EuiHighlight,{search:t},a))),s.a.createElement(n.EuiFlexItem,null,s.a.createElement(n.EuiToolTip,{content:r,anchorClassName:"eui-textTruncate eui-alignMiddle"},s.a.createElement(n.EuiTextColor,{color:"subdued",component:"span"},s.a.createElement("small",null,null!=r?r:Object(m.d)())))))),s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(n.EuiIcon,{type:null!=e.favorite&&Object(i.isEmpty)(e.favorite)?"starEmpty":"starFilled"})))}),[]),L=Object(r.useCallback)((e=>{const t=e.filter((e=>"on"===e.checked));var n;null!=t&&t.length>0&&o(Object(i.isEmpty)(t[0].timelineTitle)?p.Y:t[0].timelineTitle,"-1"===t[0].id?null:t[0].id,null!==(n=t[0].graphEventId)&&void 0!==n?n:""),a()}),[a,o]),B=Object(r.useCallback)(((e,t)=>s.a.createElement(s.a.Fragment,null,t,e)),[]),q=Object(r.useMemo)((()=>({"data-test-subj":"timeline-super-select-search-box",placeholder:null!=h?h:g.e(l),onSearch:_,incremental:!1,append:s.a.createElement(y,{"data-test-subj":"only-favorites-toggle",hasActiveFilters:O,onClick:N},p.B)})),[N,_,O,l,h]),z=Object(r.useMemo)((()=>({rowHeight:50,showIcons:!1,windowProps:{onScroll:({scrollOffset:t})=>R((null!=I?I:[]).filter((t=>!e||""!==t.title)).length,M,t),outerRef:F,innerRef:D}})),[R,e,M,I]);return Object(r.useEffect)((()=>{T({pageInfo:{pageIndex:1,pageSize:E},search:S,sort:{sortField:c.f.updated,sortOrder:b.b.desc},onlyUserFavorite:O,status:null,timelineType:l})}),[T,O,E,S,l]),s.a.createElement(n.EuiSelectable,{"data-test-subj":"selectable-input",height:260,isLoading:C&&null==I,listProps:z,renderOption:P,onChange:L,searchable:!0,searchProps:q,singleSelection:!0,options:($=t({timelines:null!=I?I:[],onlyFavorites:O,searchTimelineValue:S,timelineType:l}),$.map((({title:e,...t})=>({...t,title:void 0,timelineTitle:e}))))},B);var $},E=Object(r.memo)(h)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=(n=a(4))&&"object"==typeof n&&"default"in n?n:{default:n},r=e=>"checkbox"===e.type,s=e=>e instanceof Date,o=e=>null==e;const l=e=>"object"==typeof e;var c=e=>!o(e)&&!Array.isArray(e)&&l(e)&&!s(e),u=e=>c(e)&&e.target?r(e.target)?e.target.checked:e.target.value:e,d=(e,t)=>e.has((e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e)(t)),p=e=>Array.isArray(e)?e.filter(Boolean):[],m=e=>void 0===e,g=(e,t,a)=>{if(!t||!c(e))return a;const n=p(t.split(/[,[\].]+?/)).reduce(((e,t)=>o(e)?e:e[t]),e);return m(n)||n===e?m(e[t])?a:e[t]:n};const b="blur",f="onChange",y="onSubmit",h="all",E="pattern",v="required",x=i.default.createContext(null),k=()=>i.default.useContext(x);var S=(e,t,a,n=!0)=>{const i={defaultValues:t._defaultValues};for(const r in e)Object.defineProperty(i,r,{get:()=>{const i=r;return t._proxyFormState[i]!==h&&(t._proxyFormState[i]=!n||h),a&&(a[i]=!0),e[i]}});return i},j=e=>c(e)&&!Object.keys(e).length,O=(e,t,a)=>{const{name:n,...i}=e;return j(i)||Object.keys(i).length>=Object.keys(t).length||Object.keys(i).find((e=>t[e]===(!a||h)))},w=e=>Array.isArray(e)?e:[e],T=(e,t,a)=>a&&t?e===t:!e||!t||e===t||w(e).some((e=>e&&(e.startsWith(t)||t.startsWith(e))));function I(e){const t=i.default.useRef(e);t.current=e,i.default.useEffect((()=>{const a=!e.disabled&&t.current.subject.subscribe({next:t.current.callback});return()=>{a&&a.unsubscribe()}}),[e.disabled])}function C(e){const t=k(),{control:a=t.control,disabled:n,name:r,exact:s}=e||{},[o,l]=i.default.useState(a._formState),c=i.default.useRef(!0),u=i.default.useRef({isDirty:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1}),d=i.default.useRef(r);return d.current=r,I({disabled:n,callback:i.default.useCallback((e=>c.current&&T(d.current,e.name,s)&&O(e,u.current)&&l({...a._formState,...e})),[a,s]),subject:a._subjects.state}),i.default.useEffect((()=>(c.current=!0,()=>{c.current=!1})),[]),S(o,a,u.current,!1)}var M=e=>"string"==typeof e,F=(e,t,a,n)=>{const i=Array.isArray(e);return M(e)?(n&&t.watch.add(e),g(a,e)):i?e.map((e=>(n&&t.watch.add(e),g(a,e)))):(n&&(t.watchAll=!0),a)},D=e=>"function"==typeof e,A=e=>{for(const t in e)if(D(e[t]))return!0;return!1};function _(e){const t=k(),{control:a=t.control,name:n,defaultValue:r,disabled:s,exact:o}=e||{},l=i.default.useRef(n);l.current=n,I({disabled:s,subject:a._subjects.watch,callback:i.default.useCallback((e=>{if(T(l.current,e.name,o)){const t=F(l.current,a._names,e.values||a._formValues);d(m(l.current)||c(t)&&!A(t)?{...t}:Array.isArray(t)?[...t]:m(t)?r:t)}}),[a,o,r])});const[u,d]=i.default.useState(m(r)?a._getWatch(n):r);return i.default.useEffect((()=>a._removeUnmounted())),u}function N(e){const t=k(),{name:a,control:n=t.control,shouldUnregister:r}=e,s=d(n._names.array,a),o=_({control:n,name:a,defaultValue:g(n._formValues,a,g(n._defaultValues,a,e.defaultValue)),exact:!0}),l=C({control:n,name:a}),c=i.default.useRef(n.register(a,{...e.rules,value:o}));return i.default.useEffect((()=>{const e=(e,t)=>{const a=g(n._fields,e);a&&(a._f.mount=t)};return e(a,!0),()=>{const t=n._options.shouldUnregister||r;(s?t&&!n._stateFlags.action:t)?n.unregister(a):e(a,!1)}}),[a,n,s,r]),{field:{name:a,value:o,onChange:i.default.useCallback((e=>c.current.onChange({target:{value:u(e),name:a},type:"change"})),[a]),onBlur:i.default.useCallback((()=>c.current.onBlur({target:{value:g(n._formValues,a),name:a},type:b})),[a,n]),ref:e=>{const t=g(n._fields,a);t&&e&&(t._f.ref={focus:()=>e.focus(),select:()=>e.select(),setCustomValidity:t=>e.setCustomValidity(t),reportValidity:()=>e.reportValidity()})}},formState:l,fieldState:Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!g(l.errors,a)},isDirty:{enumerable:!0,get:()=>!!g(l.dirtyFields,a)},isTouched:{enumerable:!0,get:()=>!!g(l.touchedFields,a)},error:{enumerable:!0,get:()=>g(l.errors,a)}})}}var R=(e,t,a,n,i)=>t?{...a[e],types:{...a[e]&&a[e].types?a[e].types:{},[n]:i||!0}}:{},P=e=>/^\w*$/.test(e),L=e=>p(e.replace(/["|']|\]/g,"").split(/\.|\[/));function B(e,t,a){let n=-1;const i=P(t)?[t]:L(t),r=i.length,s=r-1;for(;++n<r;){const t=i[n];let r=a;if(n!==s){const a=e[t];r=c(a)||Array.isArray(a)?a:isNaN(+i[n+1])?{}:[]}e[t]=r,e=e[t]}return e}const q=(e,t,a)=>{for(const n of a||Object.keys(e)){const a=g(e,n);if(a){const{_f:e,...n}=a;if(e&&t(e.name)){if(e.ref.focus){e.ref.focus();break}if(e.refs&&e.refs[0].focus){e.refs[0].focus();break}}else c(n)&&q(n,t)}}};var z=()=>{const e="undefined"==typeof performance?Date.now():1e3*performance.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const a=(16*Math.random()+e)%16|0;return("x"==t?a:3&a|8).toString(16)}))},$=(e,t,a={})=>a.shouldFocus||m(a.shouldFocus)?a.focusName||`${e}.${m(a.focusIndex)?t:a.focusIndex}.`:"",V=(e,t,a)=>!a&&(t.watchAll||t.watch.has(e)||[...t.watch].some((t=>e.startsWith(t)&&/^\.\w+/.test(e.slice(t.length))))),U=(e,t,a)=>{const n=p(g(e,a));return B(n,"root",t[a]),B(e,a,n),e},H=e=>"boolean"==typeof e,G=e=>"file"===e.type,Q=e=>M(e)||i.default.isValidElement(e),W=e=>"radio"===e.type,K=e=>e instanceof RegExp;const Y={value:!1,isValid:!1},J={value:!0,isValid:!0};var X=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter((e=>e&&e.checked&&!e.disabled)).map((e=>e.value));return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!m(e[0].attributes.value)?m(e[0].value)||""===e[0].value?J:{value:e[0].value,isValid:!0}:J:Y}return Y};const Z={isValid:!1,value:null};var ee=e=>Array.isArray(e)?e.reduce(((e,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:e),Z):Z;function te(e,t,a="validate"){if(Q(e)||Array.isArray(e)&&e.every(Q)||H(e)&&!e)return{type:a,message:Q(e)?e:"",ref:t}}var ae=e=>c(e)&&!K(e)?e:{value:e,message:""},ne=async(e,t,a,n,i)=>{const{ref:s,refs:l,required:u,maxLength:d,minLength:p,min:m,max:g,pattern:b,validate:f,name:y,valueAsNumber:h,mount:x,disabled:k}=e._f;if(!x||k)return{};const S=l?l[0]:s,O=e=>{n&&M(e)&&(S.setCustomValidity(e),S.reportValidity())},w={},T=W(s),I=r(s),C=T||I,F=(h||G(s))&&!s.value||""===t||Array.isArray(t)&&!t.length,A=R.bind(null,y,a,w),_=(e,t,a,n="maxLength",i="minLength")=>{const r=e?t:a;w[y]={type:e?n:i,message:r,ref:s,...A(e?n:i,r)}};if(i?!Array.isArray(t)||!t.length:u&&(!C&&(F||o(t))||H(t)&&!t||I&&!X(l).isValid||T&&!ee(l).isValid)){const{value:e,message:t}=Q(u)?{value:!!u,message:u}:ae(u);if(e&&(w[y]={type:v,message:t,ref:S,...A(v,t)},!a))return O(t),w}if(!(F||o(m)&&o(g))){let e,n;const i=ae(g),r=ae(m);if(o(t)||isNaN(t)){const a=s.valueAsDate||new Date(t),o=e=>new Date((new Date).toDateString()+" "+e),l="time"==s.type,c="week"==s.type;M(i.value)&&t&&(e=l?o(t)>o(i.value):c?t>i.value:a>new Date(i.value)),M(r.value)&&t&&(n=l?o(t)<o(r.value):c?t<r.value:a<new Date(r.value))}else{const a=s.valueAsNumber||(t?+t:t);o(i.value)||(e=a>i.value),o(r.value)||(n=a<r.value)}if((e||n)&&(_(!!e,i.message,r.message,"max","min"),!a))return O(w[y].message),w}if((d||p)&&!F&&(M(t)||i&&Array.isArray(t))){const e=ae(d),n=ae(p),i=!o(e.value)&&t.length>e.value,r=!o(n.value)&&t.length<n.value;if((i||r)&&(_(i,e.message,n.message),!a))return O(w[y].message),w}if(b&&!F&&M(t)){const{value:e,message:n}=ae(b);if(K(e)&&!t.match(e)&&(w[y]={type:E,message:n,ref:s,...A(E,n)},!a))return O(n),w}if(f)if(D(f)){const e=te(await f(t),S);if(e&&(w[y]={...e,...A("validate",e.message)},!a))return O(e.message),w}else if(c(f)){let e={};for(const n in f){if(!j(e)&&!a)break;const i=te(await f[n](t),S,n);i&&(e={...i,...A(n,i.message)},O(i.message),a&&(w[y]=e))}if(!j(e)&&(w[y]={ref:S,...e},!a))return w}return O(!0),w};function ie(e,t){return[...e,...w(t)]}var re="undefined"!=typeof window&&void 0!==window.HTMLElement&&"undefined"!=typeof document;function se(e){let t;const a=Array.isArray(e);if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set(e);else{if(re&&(e instanceof Blob||e instanceof FileList)||!a&&!c(e))return e;if(t=a?[]:{},Array.isArray(e)||(e=>{const t=e.constructor&&e.constructor.prototype;return c(t)&&t.hasOwnProperty("isPrototypeOf")})(e))for(const a in e)t[a]=se(e[a]);else t=e}return t}var oe=e=>Array.isArray(e)?e.map((()=>{})):void 0,le=e=>({isOnSubmit:!e||e===y,isOnBlur:"onBlur"===e,isOnChange:e===f,isOnAll:e===h,isOnTouch:"onTouched"===e});function ce(e,t,a){return[...e.slice(0,t),...w(a),...e.slice(t)]}var ue=(e,t,a)=>Array.isArray(e)?(m(e[a])&&(e[a]=void 0),e.splice(a,0,e.splice(t,1)[0]),e):[];function de(e,t){return[...w(t),...w(e)]}var pe=(e,t)=>m(t)?[]:function(e,t){let a=0;const n=[...e];for(const e of t)n.splice(e-a,1),a++;return p(n).length?n:[]}(e,w(t).sort(((e,t)=>e-t))),me=(e,t,a)=>{e[t]=[e[a],e[a]=e[t]][0]};function ge(e){for(const t in e)if(!m(e[t]))return!1;return!0}function be(e,t){const a=P(t)?[t]:L(t),n=1==a.length?e:function(e,t){const a=t.slice(0,-1).length;let n=0;for(;n<a;)e=m(e)?n++:e[t[n++]];return e}(e,a),i=a[a.length-1];let r;n&&delete n[i];for(let t=0;t<a.slice(0,-1).length;t++){let n,i=-1;const s=a.slice(0,-(t+1)),o=s.length-1;for(t>0&&(r=e);++i<s.length;){const t=s[i];n=n?n[t]:e[t],o===i&&(c(n)&&j(n)||Array.isArray(n)&&ge(n))&&(r?delete r[t]:delete e[t]),r=n}}return e}var fe=(e,t,a)=>(e[t]=a,e);function ye(){let e=[];return{get observers(){return e},next:t=>{for(const a of e)a.next(t)},subscribe:t=>(e.push(t),{unsubscribe:()=>{e=e.filter((e=>e!==t))}}),unsubscribe:()=>{e=[]}}}var he=e=>o(e)||!l(e);function Ee(e,t){if(he(e)||he(t))return e===t;if(s(e)&&s(t))return e.getTime()===t.getTime();const a=Object.keys(e),n=Object.keys(t);if(a.length!==n.length)return!1;for(const i of a){const a=e[i];if(!n.includes(i))return!1;if("ref"!==i){const e=t[i];if(s(a)&&s(e)||c(a)&&c(e)||Array.isArray(a)&&Array.isArray(e)?!Ee(a,e):a!==e)return!1}}return!0}var ve=e=>{const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},xe=e=>"select-multiple"===e.type,ke=e=>ve(e)&&e.isConnected;function Se(e,t={}){const a=Array.isArray(e);if(c(e)||a)for(const a in e)Array.isArray(e[a])||c(e[a])&&!A(e[a])?(t[a]=Array.isArray(e[a])?[]:{},Se(e[a],t[a])):o(e[a])||(t[a]=!0);return t}var je=(e,t)=>function e(t,a,n){const i=Array.isArray(t);if(c(t)||i)for(const i in t)Array.isArray(t[i])||c(t[i])&&!A(t[i])?m(a)||he(n[i])?n[i]=Array.isArray(t[i])?Se(t[i],[]):{...Se(t[i])}:e(t[i],o(a)?{}:a[i],n[i]):Ee(t[i],a[i])?delete n[i]:n[i]=!0;return n}(e,t,Se(t)),Oe=(e,{valueAsNumber:t,valueAsDate:a,setValueAs:n})=>m(e)?e:t?""===e?NaN:e?+e:e:a&&M(e)?new Date(e):n?n(e):e;function we(e){const t=e.ref;if(!(e.refs?e.refs.every((e=>e.disabled)):t.disabled))return G(t)?t.files:W(t)?ee(e.refs).value:xe(t)?[...t.selectedOptions].map((({value:e})=>e)):r(t)?X(e.refs).value:Oe(m(t.value)?e.ref.value:t.value,e)}var Te=e=>m(e)?void 0:K(e)?e.source:c(e)?K(e.value)?e.value.source:e.value:e;function Ie(e,t,a){const n=g(e,a);if(n||P(a))return{error:n,name:a};const i=a.split(".");for(;i.length;){const n=i.join("."),r=g(t,n),s=g(e,n);if(r&&!Array.isArray(r)&&a!==n)return{name:a};if(s&&s.type)return{name:n,error:s};i.pop()}return{name:a}}const Ce={mode:y,reValidateMode:f,shouldFocusError:!0};function Me(e={}){let t,a={...Ce,...e},n={submitCount:0,isDirty:!1,isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},errors:{}},i={},l=se(a.defaultValues)||{},c=a.shouldUnregister?{}:se(l),f={action:!1,mount:!1,watch:!1},y={mount:new Set,unMount:new Set,array:new Set,watch:new Set},E=0,v={};const x={isDirty:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},k={watch:ye(),array:ye(),state:ye()},S=le(a.mode),O=le(a.reValidateMode),T=a.criteriaMode===h,I=async()=>{let e=!1;return x.isValid&&(e=a.resolver?j((await N()).errors):await R(i,!0),e!==n.isValid&&(n.isValid=e,k.state.next({isValid:e}))),e},C=(e,t,a,n)=>{const r=g(i,e);if(r){const i=g(c,e,m(a)?g(l,e):a);m(i)||n&&n.defaultChecked||t?B(c,e,t?i:we(r._f)):z(e,i),f.mount&&I()}},A=(e,t,a,i,r)=>{let s=!1;const o={name:e},c=g(n.touchedFields,e);if(x.isDirty){const e=n.isDirty;n.isDirty=o.isDirty=P(),s=e!==o.isDirty}if(x.dirtyFields&&(!a||i)){const a=g(n.dirtyFields,e);Ee(g(l,e),t)?be(n.dirtyFields,e):B(n.dirtyFields,e,!0),o.dirtyFields=n.dirtyFields,s=s||a!==g(n.dirtyFields,e)}return a&&!c&&(B(n.touchedFields,e,a),o.touchedFields=n.touchedFields,s=s||x.touchedFields&&c!==a),s&&r&&k.state.next(o),s?o:{}},_=(a,i,r,s)=>{const o=g(n.errors,a),l=x.isValid&&H(i)&&n.isValid!==i;var c;if(e.delayError&&r?(c=()=>((e,t)=>{B(n.errors,e,t),k.state.next({errors:n.errors})})(a,r),t=e=>{clearTimeout(E),E=window.setTimeout(c,e)},t(e.delayError)):(clearTimeout(E),t=null,r?B(n.errors,a,r):be(n.errors,a)),(r?!Ee(o,r):o)||!j(s)||l){const e={...s,...l&&H(i)?{isValid:i}:{},errors:n.errors,name:a};n={...n,...e},k.state.next(e)}v[a]--,x.isValidating&&!Object.values(v).some((e=>e))&&(k.state.next({isValidating:!1}),v={})},N=async e=>a.resolver?await a.resolver({...c},a.context,((e,t,a,n)=>{const i={};for(const a of e){const e=g(t,a);e&&B(i,a,e._f)}return{criteriaMode:a,names:[...e],fields:i,shouldUseNativeValidation:n}})(e||y.mount,i,a.criteriaMode,a.shouldUseNativeValidation)):{},R=async(e,t,i={valid:!0})=>{for(const r in e){const s=e[r];if(s){const{_f:e,...r}=s;if(e){const r=y.array.has(e.name),o=await ne(s,g(c,e.name),T,a.shouldUseNativeValidation,r);if(o[e.name]&&(i.valid=!1,t))break;!t&&(g(o,e.name)?r?U(n.errors,o,e.name):B(n.errors,e.name,o[e.name]):be(n.errors,e.name))}r&&await R(r,t,i)}}return i.valid},P=(e,t)=>(e&&t&&B(c,e,t),!Ee(J(),l)),L=(e,t,a)=>{const n={...f.mount?c:m(t)?l:M(e)?{[e]:t}:t};return F(e,y,n,a)},z=(e,t,a={})=>{const n=g(i,e);let s=t;if(n){const a=n._f;a&&(!a.disabled&&B(c,e,Oe(t,a)),s=re&&ve(a.ref)&&o(t)?"":t,xe(a.ref)?[...a.ref.options].forEach((e=>e.selected=s.includes(e.value))):a.refs?r(a.ref)?a.refs.length>1?a.refs.forEach((e=>(!e.defaultChecked||!e.disabled)&&(e.checked=Array.isArray(s)?!!s.find((t=>t===e.value)):s===e.value))):a.refs[0]&&(a.refs[0].checked=!!s):a.refs.forEach((e=>e.checked=e.value===s)):G(a.ref)?a.ref.value="":(a.ref.value=s,a.ref.type||k.watch.next({name:e})))}(a.shouldDirty||a.shouldTouch)&&A(e,s,a.shouldTouch,a.shouldDirty,!0),a.shouldValidate&&Y(e)},$=(e,t,a)=>{for(const n in t){const r=t[n],o=`${e}.${n}`,l=g(i,o);!y.array.has(e)&&he(r)&&(!l||l._f)||s(r)?z(o,r,a):$(o,r,a)}},Q=(e,t,a={})=>{const r=g(i,e),s=y.array.has(e),u=se(t);B(c,e,u),s?(k.array.next({name:e,values:c}),(x.isDirty||x.dirtyFields)&&a.shouldDirty&&(n.dirtyFields=je(l,c),k.state.next({name:e,dirtyFields:n.dirtyFields,isDirty:P(e,u)}))):!r||r._f||o(u)?z(e,u,a):$(e,u,a),V(e,y)&&k.state.next({}),k.watch.next({name:e})},K=async e=>{const r=e.target;let s=r.name;const o=g(i,s);if(o){let d,p;const m=r.type?we(o._f):u(e),f=e.type===b||"focusout"===e.type,h=!((l=o._f).mount&&(l.required||l.min||l.max||l.maxLength||l.minLength||l.pattern||l.validate)||a.resolver||g(n.errors,s)||o._f.deps)||((e,t,a,n,i)=>!i.isOnAll&&(!a&&i.isOnTouch?!(t||e):(a?n.isOnBlur:i.isOnBlur)?!e:!(a?n.isOnChange:i.isOnChange)||e))(f,g(n.touchedFields,s),n.isSubmitted,O,S),E=V(s,y,f);B(c,s,m),f?(o._f.onBlur&&o._f.onBlur(e),t&&t(0)):o._f.onChange&&o._f.onChange(e);const w=A(s,m,f,!1),C=!j(w)||E;if(!f&&k.watch.next({name:s,type:e.type}),h)return x.isValid&&I(),C&&k.state.next({name:s,...E?{}:w});if(!f&&E&&k.state.next({}),v[s]=v[s]?v[s]+1:1,k.state.next({isValidating:!0}),a.resolver){const{errors:e}=await N([s]),t=Ie(n.errors,i,s),a=Ie(e,i,t.name||s);d=a.error,s=a.name,p=j(e)}else d=(await ne(o,g(c,s),T,a.shouldUseNativeValidation))[s],I();o._f.deps&&Y(o._f.deps),_(s,p,d,w)}var l},Y=async(e,t={})=>{let r,s;const o=w(e);if(k.state.next({isValidating:!0}),a.resolver){const t=await(async e=>{const{errors:t}=await N();if(e)for(const a of e){const e=g(t,a);e?B(n.errors,a,e):be(n.errors,a)}else n.errors=t;return t})(m(e)?e:o);r=j(t),s=e?!o.some((e=>g(t,e))):r}else e?(s=(await Promise.all(o.map((async e=>{const t=g(i,e);return await R(t&&t._f?{[e]:t}:t)})))).every(Boolean),(s||n.isValid)&&I()):s=r=await R(i);return k.state.next({...!M(e)||x.isValid&&r!==n.isValid?{}:{name:e},...a.resolver||!e?{isValid:r}:{},errors:n.errors,isValidating:!1}),t.shouldFocus&&!s&&q(i,(e=>e&&g(n.errors,e)),e?o:y.mount),s},J=e=>{const t={...l,...f.mount?c:{}};return m(e)?t:M(e)?g(t,e):e.map((e=>g(t,e)))},X=(e,t)=>({invalid:!!g((t||n).errors,e),isDirty:!!g((t||n).dirtyFields,e),isTouched:!!g((t||n).touchedFields,e),error:g((t||n).errors,e)}),Z=(e,t={})=>{for(const r of e?w(e):y.mount)y.mount.delete(r),y.array.delete(r),g(i,r)&&(t.keepValue||(be(i,r),be(c,r)),!t.keepError&&be(n.errors,r),!t.keepDirty&&be(n.dirtyFields,r),!t.keepTouched&&be(n.touchedFields,r),!a.shouldUnregister&&!t.keepDefaultValue&&be(l,r));k.watch.next({}),k.state.next({...n,...t.keepDirty?{isDirty:P()}:{}}),!t.keepIsValid&&I()},ee=(e,t={})=>{let n=g(i,e);const s=H(t.disabled);return B(i,e,{...n||{},_f:{...n&&n._f?n._f:{ref:{name:e}},name:e,mount:!0,...t}}),y.mount.add(e),n?s&&B(c,e,t.disabled?void 0:g(c,e,we(n._f))):C(e,!0,t.value),{...s?{disabled:t.disabled}:{},...a.shouldUseNativeValidation?{required:!!t.required,min:Te(t.min),max:Te(t.max),minLength:Te(t.minLength),maxLength:Te(t.maxLength),pattern:Te(t.pattern)}:{},name:e,onChange:K,onBlur:K,ref:s=>{if(s){ee(e,t),n=g(i,e);const a=m(s.value)&&s.querySelectorAll&&s.querySelectorAll("input,select,textarea")[0]||s,o=(e=>W(e)||r(e))(a),c=n._f.refs||[];if(o?c.find((e=>e===a)):a===n._f.ref)return;B(i,e,{_f:{...n._f,...o?{refs:[...c.filter(ke),a,...Array.isArray(g(l,e))?[{}]:[]],ref:{type:a.type,name:e}}:{ref:a}}}),C(e,!1,void 0,a)}else n=g(i,e,{}),n._f&&(n._f.mount=!1),(a.shouldUnregister||t.shouldUnregister)&&(!d(y.array,e)||!f.action)&&y.unMount.add(e)}}},te=()=>a.shouldFocusError&&q(i,(e=>e&&g(n.errors,e)),y.mount);return{control:{register:ee,unregister:Z,getFieldState:X,_executeSchema:N,_focusError:te,_getWatch:L,_getDirty:P,_updateValid:I,_removeUnmounted:()=>{for(const e of y.unMount){const t=g(i,e);t&&(t._f.refs?t._f.refs.every((e=>!ke(e))):!ke(t._f.ref))&&Z(e)}y.unMount=new Set},_updateFieldArray:(e,t=[],a,r,s=!0,o=!0)=>{if(r&&a){if(f.action=!0,o&&Array.isArray(g(i,e))){const t=a(g(i,e),r.argA,r.argB);s&&B(i,e,t)}if(x.errors&&o&&Array.isArray(g(n.errors,e))){const t=a(g(n.errors,e),r.argA,r.argB);s&&B(n.errors,e,t),((e,t)=>{!p(g(e,t)).length&&be(e,t)})(n.errors,e)}if(x.touchedFields&&o&&Array.isArray(g(n.touchedFields,e))){const t=a(g(n.touchedFields,e),r.argA,r.argB);s&&B(n.touchedFields,e,t)}x.dirtyFields&&(n.dirtyFields=je(l,c)),k.state.next({isDirty:P(e,t),dirtyFields:n.dirtyFields,errors:n.errors,isValid:n.isValid})}else B(c,e,t)},_getFieldArray:t=>p(g(f.mount?c:l,t,e.shouldUnregister?g(l,t,[]):[])),_subjects:k,_proxyFormState:x,get _fields(){return i},get _formValues(){return c},get _stateFlags(){return f},set _stateFlags(e){f=e},get _defaultValues(){return l},get _names(){return y},set _names(e){y=e},get _formState(){return n},set _formState(e){n=e},get _options(){return a},set _options(e){a={...a,...e}}},trigger:Y,register:ee,handleSubmit:(e,t)=>async r=>{r&&(r.preventDefault&&r.preventDefault(),r.persist&&r.persist());let s=!0,o=se(c);k.state.next({isSubmitting:!0});try{if(a.resolver){const{errors:e,values:t}=await N();n.errors=e,o=t}else await R(i);j(n.errors)?(k.state.next({errors:{},isSubmitting:!0}),await e(o,r)):(t&&await t({...n.errors},r),te())}catch(e){throw s=!1,e}finally{n.isSubmitted=!0,k.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:j(n.errors)&&s,submitCount:n.submitCount+1,errors:n.errors})}},watch:(e,t)=>D(e)?k.watch.subscribe({next:a=>e(L(void 0,t),a)}):L(e,t,!0),setValue:Q,getValues:J,reset:(t,a)=>((t,a={})=>{const r=t||l,s=se(r),o=t&&!j(t)?s:l;if(a.keepDefaultValues||(l=r),!a.keepValues){if(a.keepDirtyValues)for(const e of y.mount)g(n.dirtyFields,e)?B(o,e,g(c,e)):Q(e,g(o,e));else{if(re&&m(t))for(const e of y.mount){const t=g(i,e);if(t&&t._f){const e=Array.isArray(t._f.refs)?t._f.refs[0]:t._f.ref;if(ve(e)){const t=e.closest("form");if(t){t.reset();break}}}}i={}}c=e.shouldUnregister?a.keepDefaultValues?se(l):{}:s,k.array.next({values:o}),k.watch.next({values:o})}y={mount:new Set,unMount:new Set,array:new Set,watch:new Set,watchAll:!1,focus:""},f.mount=!x.isValid||!!a.keepIsValid,f.watch=!!e.shouldUnregister,k.state.next({submitCount:a.keepSubmitCount?n.submitCount:0,isDirty:a.keepDirty||a.keepDirtyValues?n.isDirty:!(!a.keepDefaultValues||Ee(t,l)),isSubmitted:!!a.keepIsSubmitted&&n.isSubmitted,dirtyFields:a.keepDirty||a.keepDirtyValues?n.dirtyFields:a.keepDefaultValues&&t?je(l,t):{},touchedFields:a.keepTouched?n.touchedFields:{},errors:a.keepErrors?n.errors:{},isSubmitting:!1,isSubmitSuccessful:!1})})(D(t)?t(c):t,a),resetField:(e,t={})=>{g(i,e)&&(m(t.defaultValue)?Q(e,g(l,e)):(Q(e,t.defaultValue),B(l,e,t.defaultValue)),t.keepTouched||be(n.touchedFields,e),t.keepDirty||(be(n.dirtyFields,e),n.isDirty=t.defaultValue?P(e,g(l,e)):P()),t.keepError||(be(n.errors,e),x.isValid&&I()),k.state.next({...n}))},clearErrors:e=>{e?w(e).forEach((e=>be(n.errors,e))):n.errors={},k.state.next({errors:n.errors})},unregister:Z,setError:(e,t,a)=>{const r=(g(i,e,{_f:{}})._f||{}).ref;B(n.errors,e,{...t,ref:r}),k.state.next({name:e,errors:n.errors,isValid:!1}),a&&a.shouldFocus&&r&&r.focus&&r.focus()},setFocus:(e,t={})=>{const a=g(i,e),n=a&&a._f;if(n){const e=n.refs?n.refs[0]:n.ref;e.focus&&(e.focus(),t.shouldSelect&&e.select())}},getFieldState:X}}t.Controller=e=>e.render(N(e)),t.FormProvider=e=>{const{children:t,...a}=e;return i.default.createElement(x.Provider,{value:a},t)},t.appendErrors=R,t.get=g,t.set=B,t.useController=N,t.useFieldArray=function(e){const t=k(),{control:a=t.control,name:n,keyName:r="id",shouldUnregister:s}=e,[o,l]=i.default.useState(a._getFieldArray(n)),c=i.default.useRef(a._getFieldArray(n).map(z)),u=i.default.useRef(o),d=i.default.useRef(n),p=i.default.useRef(!1);d.current=n,u.current=o,a._names.array.add(n),e.rules&&a.register(n,e.rules),I({callback:i.default.useCallback((({values:e,name:t})=>{if(t===d.current||!t){const t=g(e,d.current);Array.isArray(t)&&(l(t),c.current=t.map(z))}}),[]),subject:a._subjects.array});const m=i.default.useCallback((e=>{p.current=!0,a._updateFieldArray(n,e)}),[a,n]);return i.default.useEffect((()=>{if(a._stateFlags.action=!1,V(n,a._names)&&a._subjects.state.next({}),p.current&&(!le(a._options.mode).isOnSubmit||a._formState.isSubmitted))if(a._options.resolver)a._executeSchema([n]).then((e=>{const t=g(e.errors,n),i=g(a._formState.errors,n);(i?!t&&i.type:t&&t.type)&&(t?B(a._formState.errors,n,t):be(a._formState.errors,n),a._subjects.state.next({errors:a._formState.errors}))}));else{const e=g(a._fields,n);e&&e._f&&ne(e,g(a._formValues,n),a._options.criteriaMode===h,a._options.shouldUseNativeValidation,!0).then((e=>!j(e)&&a._subjects.state.next({errors:U(a._formState.errors,e,n)})))}a._subjects.watch.next({name:n,values:a._formValues}),a._names.focus&&q(a._fields,(e=>!!e&&e.startsWith(a._names.focus))),a._names.focus="",a._proxyFormState.isValid&&a._updateValid()}),[o,n,a]),i.default.useEffect((()=>(!g(a._formValues,n)&&a._updateFieldArray(n),()=>{(a._options.shouldUnregister||s)&&a.unregister(n)})),[n,a,r,s]),{swap:i.default.useCallback(((e,t)=>{const i=a._getFieldArray(n);me(i,e,t),me(c.current,e,t),m(i),l(i),a._updateFieldArray(n,i,me,{argA:e,argB:t},!1)}),[m,n,a]),move:i.default.useCallback(((e,t)=>{const i=a._getFieldArray(n);ue(i,e,t),ue(c.current,e,t),m(i),l(i),a._updateFieldArray(n,i,ue,{argA:e,argB:t},!1)}),[m,n,a]),prepend:i.default.useCallback(((e,t)=>{const i=w(se(e)),r=de(a._getFieldArray(n),i);a._names.focus=$(n,0,t),c.current=de(c.current,i.map(z)),m(r),l(r),a._updateFieldArray(n,r,de,{argA:oe(e)})}),[m,n,a]),append:i.default.useCallback(((e,t)=>{const i=w(se(e)),r=ie(a._getFieldArray(n),i);a._names.focus=$(n,r.length-1,t),c.current=ie(c.current,i.map(z)),m(r),l(r),a._updateFieldArray(n,r,ie,{argA:oe(e)})}),[m,n,a]),remove:i.default.useCallback((e=>{const t=pe(a._getFieldArray(n),e);c.current=pe(c.current,e),m(t),l(t),a._updateFieldArray(n,t,pe,{argA:e})}),[m,n,a]),insert:i.default.useCallback(((e,t,i)=>{const r=w(se(t)),s=ce(a._getFieldArray(n),e,r);a._names.focus=$(n,e,i),c.current=ce(c.current,e,r.map(z)),m(s),l(s),a._updateFieldArray(n,s,ce,{argA:e,argB:oe(t)})}),[m,n,a]),update:i.default.useCallback(((e,t)=>{const i=se(t),r=fe(a._getFieldArray(n),e,i);c.current=[...r].map(((t,a)=>t&&a!==e?c.current[a]:z())),m(r),l([...r]),a._updateFieldArray(n,r,fe,{argA:e,argB:i},!0,!1)}),[m,n,a]),replace:i.default.useCallback((e=>{const t=w(se(e));c.current=t.map(z),m([...t]),l([...t]),a._updateFieldArray(n,[...t],(e=>e),{},!0,!1)}),[m,n,a]),fields:i.default.useMemo((()=>o.map(((e,t)=>({...e,[r]:c.current[t]||z()})))),[o,r])}},t.useForm=function(e={}){const t=i.default.useRef(),[a,n]=i.default.useState({isDirty:!1,isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},errors:{},defaultValues:e.defaultValues});t.current||(t.current={...Me(e),formState:a});const r=t.current.control;return r._options=e,I({subject:r._subjects.state,callback:i.default.useCallback((e=>{O(e,r._proxyFormState,!0)&&(r._formState={...r._formState,...e},n({...r._formState}))}),[r])}),i.default.useEffect((()=>{r._stateFlags.mount||(r._proxyFormState.isValid&&r._updateValid(),r._stateFlags.mount=!0),r._stateFlags.watch&&(r._stateFlags.watch=!1,r._subjects.state.next({})),r._removeUnmounted()})),i.default.useEffect((()=>{a.submitCount&&r._focusError()}),[r,a.submitCount]),t.current.formState=S(a,r),t.current},t.useFormContext=k,t.useFormState=C,t.useWatch=_},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=a(0).i18n.translate("xpack.securitySolution.alertsView.osqueryAlertTitle",{defaultMessage:"Run Osquery"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));var n=a(135),i=a(83),r=a(4),s=a(299),o=a(84),l=a(185),c=a(186),u=a(457),d=a(300),p=a(813);const m=e=>({query:{bool:{filter:[{bool:{should:[{match:{"signal.rule.id":e}},{match:{[n.L]:e}}],minimum_should_match:1}}]}},size:1}),g=e=>{const{isFetching:t,data:a,error:n,refetch:s}=Object(p.a)(e,!1),{addError:g}=Object(o.a)(),f=!Object(i.s)(n),{loading:y,data:h}=Object(c.a)({query:m(e),skip:f,queryName:l.a.BY_RULE_ID});Object(r.useEffect)((()=>{null==n||Object(i.s)(n)||g(n,{title:d.b})}),[g,n]);const E=Object(r.useMemo)((()=>{const e=f?a:null==h?void 0:b(h);if(e)return Object(u.a)(e)}),[f,h,a]);return{error:n,loading:t||y,refresh:s,rule:null!=E?E:null,isExistingRule:f}},b=e=>{var t,a,n,i;if(0===e.hits.hits.length)return;const r=e.hits.hits[0],o=null!==(t=null===(a=r._source.signal)||void 0===a?void 0:a.rule)&&void 0!==t?t:null===(n=r._source.kibana)||void 0===n||null===(i=n.alert)||void 0===i?void 0:i.rule;if(null==o){var l,c,u,d,p,m;const e=Object(s.a)(null!==(l=r._source)&&void 0!==l?l:{}),t={...null==e||null===(c=e.kibana)||void 0===c||null===(u=c.alert)||void 0===u?void 0:u.rule,...null==e||null===(d=e.kibana)||void 0===d||null===(p=d.alert)||void 0===p||null===(m=p.rule)||void 0===m?void 0:m.parameters};return delete t.parameters,t}return o}},function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(4);const i=e=>{const[t,a]=Object(n.useState)(null),i=Object(n.useRef)(null);return Object(n.useEffect)((()=>{var e,t,n,r,s,o,l,c,u;null!=(null===(e=i.current)||void 0===e?void 0:e.clientHeight)&&((null!==(t=null==i||null===(n=i.current)||void 0===n?void 0:n.scrollHeight)&&void 0!==t?t:0)>(null!==(r=null==i||null===(s=i.current)||void 0===s?void 0:s.clientHeight)&&void 0!==r?r:0)&&a(!0),(null!==(o=null===(l=i.current)||void 0===l?void 0:l.scrollHeight)&&void 0!==o?o:0)<=(null!==(c=null==i||null===(u=i.current)||void 0===u?void 0:u.clientHeight)&&void 0!==c?c:0)&&a(!1))}),[i,e]),[t,i]}},function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a(1);var n=a(79);const i=[n.g.alertsOnAlertsPage,n.g.alertsOnRuleDetailsPage]},function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(4),i=a.n(n),r=a(33);const s=a.n(r).a.div.withConfig({displayName:"Wrapper",componentId:"sc-1f8m9hq-0"})(["",""],(({theme:e})=>Object(r.css)(["margin-top:",";.siemSubtitle__item{color:",";font-size:",";line-height:",";@media only screen and (min-width:","){display:inline-block;margin-right:",";&:last-child{margin-right:0;}}}"],e.eui.euiSizeS,e.eui.euiTextSubduedColor,e.eui.euiFontSizeXS,e.eui.euiLineHeight,e.eui.euiBreakpoints.s,e.eui.euiSize)));s.displayName="Wrapper";const o=i.a.memo((({children:e,dataTestSubj:t="header-panel-subtitle"})=>"string"==typeof e?i.a.createElement("p",{className:"siemSubtitle__item siemSubtitle__item--text","data-test-subj":t},e):i.a.createElement("div",{className:"siemSubtitle__item siemSubtitle__item--node","data-test-subj":t},e)));o.displayName="SubtitleItem";const l=i.a.memo((({items:e})=>i.a.createElement(s,{className:"siemSubtitle"},Array.isArray(e)?e.map(((e,t)=>i.a.createElement(o,{key:t},e))):i.a.createElement(o,null,e))));l.displayName="Subtitle"},function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return p}));var n=a(32),i=a(4),r=a.n(i),s=a(33),o=a.n(s),l=a(557);const c="exit-full-screen",u=o()(n.EuiButton).withConfig({displayName:"StyledEuiButton",componentId:"sc-4dkrmi-0"})(["margin:",";"],(({theme:e})=>e.eui.euiSizeS)),d=({fullScreen:e,setFullScreen:t})=>{const a=Object(i.useCallback)((()=>{t(!1)}),[t]),s=Object(i.useCallback)((e=>{"Escape"===e.key&&(e.preventDefault(),a())}),[a]);return e?r.a.createElement(r.a.Fragment,null,r.a.createElement(n.EuiWindowEvent,{event:"keydown",handler:s}),r.a.createElement(u,{className:c,"data-test-subj":"exit-full-screen",fullWidth:!1,iconType:"fullScreen",isDisabled:!e,onClick:a},l.a)):null};d.displayName="ExitFullScreenComponent";const p=r.a.memo(d)},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n="t"},function(e,t,a){"use strict";a.d(t,"c",(function(){return i})),a.d(t,"b",(function(){return r})),a.d(t,"d",(function(){return s})),a.d(t,"a",(function(){return o}));var n=a(0);const i=n.i18n.translate("xpack.securitySolution.topN.closeButtonLabel",{defaultMessage:"Close"}),r=n.i18n.translate("xpack.securitySolution.topN.allEventsSelectLabel",{defaultMessage:"Alerts and events"}),s=n.i18n.translate("xpack.securitySolution.topN.rawEventsSelectLabel",{defaultMessage:"Raw events"}),o=n.i18n.translate("xpack.securitySolution.topN.alertEventsSelectLabel",{defaultMessage:"Detection alerts"})},function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return r})),a.d(t,"a",(function(){return s}));var n=a(0);const i=n.i18n.translate("xpack.securitySolution.eventsViewer.showingLabel",{defaultMessage:"Showing"}),r=(n.i18n.translate("xpack.securitySolution.eventsViewer.eventsLabel",{defaultMessage:"Events"}),e=>n.i18n.translate("xpack.securitySolution.eventsViewer.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {event} other {events}}"})),s=n.i18n.translate("xpack.securitySolution.eventsViewer.actionsColumnLabel",{defaultMessage:"Actions"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return P}));var n=a(82),i=a.n(n),r=a(32),s=a(4),o=a.n(s),l=a(49),c=a(34),u=a(252),d=a.n(u),p=a(117),m=a.n(p),g=a(33),b=a.n(g),f=a(92),y=a.n(f),h=a(102),E=a(77),v=a(460),x=a(198),k=a(191),S=a(303),j=a(861),O=a(297),w=a(424),T=a(530),I=a(211);const C=b()(r.EuiFlexItem).withConfig({displayName:"LegendFlexItem",componentId:"sc-9bd0gp-0"})(["overview:hidden;"]),M=e=>null!=e&&!!Object(c.get)("value.length",e)&&(e.value||[]).every((({x:e,y:t})=>Object(c.isNumber)(t)&&t>=0)),F=["y"],D=[e=>Object(k.a)(e.g)?e.g:S.c],A=({data:e,forceHiddenLegend:t=!1,yAxisTitle:a,...n})=>{const r=Object(O.i)(),u=Object(E.n)(),p=Object(c.get)("configs.axis.xTickFormatter",n),m=Object(c.get)("configs.axis.yTickFormatter",n),g=Object(c.getOr)(0,"configs.axis.tickSize",n),b=`stat-items-barchart-${e[0].key}-x`,f=`stat-items-barchart-${e[0].key}-y`,y={...O.e,...d()(Object(c.get)("configs.settings",n),{theme:r})},h=Object(s.useMemo)((()=>d()({tickLine:{size:g}},Object(c.getOr)({},"configs.axis.bottom.style",n))),[n,g]),v=Object(s.useMemo)((()=>d()({tickLine:{size:g}},Object(c.getOr)({},"configs.axis.left.style",n))),[n,g]),x=Object(c.get)("configs.axis.bottom.labelFormat",n);return n.width&&n.height?o.a.createElement(l.Chart,null,o.a.createElement(l.Settings,i()({},y,{showLegend:y.showLegend&&!t})),e.map((e=>{var t;const a=e.key;return M(e)?o.a.createElement(l.BarSeries,{id:a,key:a,name:e.key,xScaleType:Object(c.getOr)(l.ScaleType.Linear,"configs.series.xScaleType",n),yScaleType:Object(c.getOr)(l.ScaleType.Linear,"configs.series.yScaleType",n),xAccessor:"x",yAccessors:F,timeZone:u,splitSeriesAccessors:D,data:null!==(t=e.value)&&void 0!==t?t:[],stackAccessors:Object(c.get)("configs.series.stackAccessors",n),color:e.color?e.color:void 0,barSeriesStyle:Object(c.get)("configs.series.barSeriesStyle",n)}):null})),o.a.createElement(l.Axis,{id:b,position:l.Position.Bottom,showOverlappingTicks:!1,style:h,tickFormat:p,labelFormat:x}),o.a.createElement(l.Axis,{id:f,position:l.Position.Left,style:v,tickFormat:m,title:a})):null};A.displayName="BarChartBaseComponent";const _=o.a.memo(A);_.displayName="BarChartBase";const N=[],R=({barChart:e,configs:t,stackByField:a,scopeId:n,visualizationActionsOptions:l})=>{const{ref:u,width:d,height:p}=Object(x.b)(),g=Object(s.useMemo)((()=>null!=e&&null!=a?e.map(((e,t)=>{var i;return{color:null!==(i=e.color)&&void 0!==i?i:t<v.a.length?v.a[t]:void 0,dataProviderId:Object(h.h)(`draggable-legend-item-${m.a.v4()}-${a}-${e.key}`),scopeId:n,field:a,value:e.key}})):N),[e,a,n]),b=Object(c.get)("yAxisTitle",t),f=Object(c.get)("customHeight",t),y=Object(c.get)("customWidth",t),E=Object(O.g)(f,p),k=Object(O.h)(y,d),S=Object(s.useMemo)((()=>{return t=e,Array.isArray(t)&&!Object(O.f)(t)&&t.some(M);var t}),[e]);return o.a.createElement(O.d,null,o.a.createElement(I.a,{targetClassNames:[T.a]},S&&e&&o.a.createElement(O.a,{gutterSize:"none"},o.a.createElement(r.EuiFlexItem,{grow:!0},o.a.createElement(O.c,{ref:u,height:E},o.a.createElement(_,{configs:t,data:e,yAxisTitle:b,forceHiddenLegend:null!=a,height:E,width:E}))),o.a.createElement(C,{grow:!1},o.a.createElement(w.a,{legendItems:g,height:p}))),!S&&o.a.createElement(j.a,{height:E,width:k,data:e}),null!=l&&o.a.createElement(T.b,i()({},l,{className:"viz-actions"}))))},P=o.a.memo(R,((e,t)=>e.stackByField===t.stackByField&&e.scopeId===t.scopeId&&y()(e.configs,t.configs)&&y()(e.barChart,t.barChart)))},function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(4),i=a.n(n),r=a(32),s=a(33);const o=a.n(s)()(r.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-1h00mnn-0"})(["flex:1;"]),l=()=>i.a.createElement(o,{alignItems:"center",justifyContent:"center",gutterSize:"none"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiLoadingSpinner,{size:"xl"}))),c=i.a.memo(l)},function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"f",(function(){return r})),a.d(t,"g",(function(){return s})),a.d(t,"a",(function(){return o})),a.d(t,"c",(function(){return l})),a.d(t,"d",(function(){return c})),a.d(t,"h",(function(){return u})),a.d(t,"e",(function(){return d}));var n=a(0);const i=e=>n.i18n.translate("xpack.securitySolution.eventsTab.unit",{values:{totalCount:e},defaultMessage:"external {totalCount, plural, =1 {alert} other {alerts}}"}),r=e=>n.i18n.translate("xpack.securitySolution.hosts.navigaton.eventsUnit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {event} other {events}}"}),s=n.i18n.translate("xpack.securitySolution.eventsTab.showing",{defaultMessage:"Showing"}),o=n.i18n.translate("xpack.securitySolution.eventsTab.alertsGraphTitle",{defaultMessage:"External alert trend"}),l=n.i18n.translate("xpack.securitySolution.eventsTab.errorFetchingAlertsData",{defaultMessage:"Failed to query alerts data"}),c=n.i18n.translate("xpack.securitySolution.eventsTab.errorFetchingEventsData",{defaultMessage:"Failed to query events data"}),u=n.i18n.translate("xpack.securitySolution.eventsTab.showExternalAlerts",{defaultMessage:"Show only external alerts"}),d=n.i18n.translate("xpack.securitySolution.eventsGraphTitle",{defaultMessage:"Events"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return d})),a.d(t,"b",(function(){return m}));var n=a(32),i=a(33),r=a.n(i),s=a(4),o=a.n(s),l=a(531),c=a(532),u=a(409);const d=r()(n.EuiPanel).withConfig({displayName:"KpiPanel",componentId:"sc-1kirhxq-0"})(["display:flex;flex-direction:column;position:relative;overflow-x:hidden;overflow-y:",";@media only screen and (min-width:","){","}",""],(({$overflowY:e})=>null!=e?e:"hidden"),(e=>e.theme.eui.euiBreakpoints.m),(({height:e,$toggleStatus:t})=>t&&`\n      height: ${null!=e?e:l.d}px;\n  `),(({$toggleStatus:e})=>e&&`\n    height: ${l.c}px;\n  `)),p=r.a.div.withConfig({displayName:"StackByComboBoxWrapper",componentId:"sc-1kirhxq-1"})(["max-width:400px;width:","px;"],(({width:e})=>e)),m=o.a.forwardRef((({"aria-label":e=u.c,"data-test-subj":t,isDisabled:a=!1,onSelect:i,prepend:r=u.d,selected:l,inputRef:d,width:m=400},g)=>{const b=Object(s.useCallback)((e=>{e&&e.length>0?i(e[0].value):i("")}),[i]),f=Object(s.useMemo)((()=>[{label:l,value:l}]),[l]),y=Object(c.b)(),h=Object(s.useMemo)((()=>({asPlainText:!0})),[]);return o.a.createElement(p,{width:m},o.a.createElement(n.EuiComboBox,{"data-test-subj":t,"aria-label":e,inputRef:d,isDisabled:a,placeholder:u.e,prepend:r,ref:g,singleSelection:h,isClearable:!1,sortMatchesBy:"startsWith",options:y,selectedOptions:f,compressed:!0,onChange:b}))}));m.displayName="StackByComboBox"},function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return l}));var n=a(4),i=a.n(n),r=a(88),s=a(257);const o="bytes",l=i.a.memo((({contextId:e,eventId:t,fieldName:a,fieldType:n,isAggregatable:o,isDraggable:l,value:c,scopeId:u})=>l?i.a.createElement(r.b,{id:`bytes-default-draggable-${e}-${t}-${a}-${c}`,fieldType:n,isAggregatable:o,isDraggable:l,name:name,field:a,tooltipContent:null,value:c,scopeId:u},i.a.createElement(s.a,{value:`${c}`})):i.a.createElement(s.a,{value:`${c}`})));l.displayName="Bytes"},function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(85);const i=(e,t)=>t===n.g.source?[{fieldName:"source.ip",fieldValue:e}]:t===n.g.destination?[{fieldName:"destination.ip",fieldValue:e}]:[]},function(e,t,a){"use strict";a.d(t,"a",(function(){return E}));var n=a(40),i=a(4),r=a.n(i),s=a(1),o=a(77),l=a(87),c=a(221),u=a(396),d=a(430),p=a(160),m=a(187),g=a(506),b=a(120),f=a(171),y=a(124),h=a(354);const E=r.a.memo((({contextID:e,id:t,ip:a,data:i,isDraggable:E=!1,isInDetailsSidePanel:v=!1,loading:x,flowTarget:k,startDate:S,endDate:j,isLoadingAnomaliesData:O,anomaliesData:w,narrowDateRange:T,indexPatterns:I})=>{const C=Object(b.a)(),M=Object(f.a)(C),[F]=Object(o.q)(s.O),D=i[k],A=[{title:d.i,description:Object(c.g)([`${k}.geo.city_name`,`${k}.geo.region_name`],i,e,E)},{title:d.c,description:D?Object(c.d)(D.autonomousSystem,k,e,E):Object(l.d)()}],_=[M?[...A,{title:d.j,description:r.a.createElement(g.a,{anomalies:w,startDate:S,endDate:j,isLoading:O,narrowDateRange:T})}]:A,[{title:d.d,description:r.a.createElement(u.a,{indexPatterns:I,field:`${k}.ip`,value:a,type:u.b.FIRST_SEEN})},{title:d.h,description:r.a.createElement(u.a,{indexPatterns:I,field:`${k}.ip`,value:a,type:u.b.LAST_SEEN})}],[{title:d.e,description:D&&i.host?Object(c.e)({host:i.host,isDraggable:E,ipFilter:a,contextID:e}):Object(l.d)()},{title:d.f,description:D&&i.host?Object(c.f)(i.host,a,e,E):Object(l.d)()}],[{title:d.o,description:Object(c.i)(a)},{title:d.k,description:Object(c.h)(a)}]];return r.a.createElement(y.c,null,r.a.createElement(p.g,{direction:v?"column":"row"},!v&&r.a.createElement(y.b,{queryId:t,title:d.g,inspectIndex:0}),_.map(((e,t)=>r.a.createElement(h.a,{descriptionList:e,key:t}))),x&&r.a.createElement(m.a,{overlay:!0,overlayBackground:F?n.euiDarkVars.euiPageBackgroundColor:n.euiLightVars.euiPageBackgroundColor,size:"xl"})))}));E.displayName="IpOverview"},function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(4),i=a.n(n),r=a(133),s=a(106),o=a(150),l=a(160),c=a(628);const u=({id:e,index:t=0,score:a})=>{const u=Object(c.a)(a.severity),d=Object(n.useMemo)((()=>({and:[],enabled:!0,id:e,name:a.entityName,excluded:!1,kqlQuery:"",queryMatch:{field:a.entityName,value:a.entityValue,operator:s.d}})),[e,a.entityName,a.entityValue]),p=Object(n.useCallback)(((e,a,n)=>n.isDragging?i.a.createElement(r.a,null,i.a.createElement(o.a,{dataProvider:e})):i.a.createElement(i.a.Fragment,null,0!==t&&i.a.createElement(i.a.Fragment,null,",",i.a.createElement(l.i,null)),u)),[t,u]);return i.a.createElement(r.b,{key:`draggable-score-draggable-wrapper-${e}`,dataProvider:d,render:p,isAggregatable:!0,fieldType:"keyword"})};u.displayName="DraggableScoreComponent";const d=i.a.memo(u);d.displayName="DraggableScore"},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(4),i=a.n(n),r=a(32);const s=e=>String(Math.ceil(e));i.a.memo((({score:e})=>{const t=s(e),a=o(e);return i.a.createElement(r.EuiHealth,{color:a},t)})).displayName="ScoreHealth";const o=e=>e>=75?"#fe5050":e>=50?"#fba740":e>=25?"#fdec25":e>=3?"#8bc8fb":e>=0?"#d2e9f7":"#ffffff"},function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(4),i=a.n(n),r=a(32),s=a(62),o=a(77);const l=({score:e,startDate:t,endDate:a,linkName:n})=>{const{services:{ml:l,http:c}}=Object(o.k)(),u=Object(s.useMlHref)(l,c.basePath.get(),{page:"explorer",pageState:{jobIds:[e.jobId],timeRange:{from:new Date(t).toISOString(),to:new Date(a).toISOString(),mode:"absolute"},refreshInterval:{pause:!0,value:0,display:"Off"}}});return u?i.a.createElement(r.EuiLink,{href:u,target:"_blank"},n):null}},function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(4),i=a(37),r=a(81),s=a(149),o=a(95),l=a(94),c=a(98);function u(e){const t=Object(n.useMemo)((()=>Object(s.i)()),[]),a=Object(n.useMemo)((()=>Object(s.b)()),[]),u=Object(n.useMemo)((()=>Object(s.d)()),[]),d=Object(r.a)((t=>u(e?t.inputs.timeline:t.inputs.global))),p=Object(r.a)((a=>t(e?a.inputs.timeline:a.inputs.global))),m=Object(r.a)((t=>a(e?t.inputs.timeline:t.inputs.global))),g=Object(n.useMemo)((()=>c.e.defaultDataViewSelector()),[]),b=Object(r.a)(g),{pathname:f}=Object(i.useLocation)(),{selectedPatterns:y}=Object(l.d)(Object(l.a)(f)),{selectedPatterns:h}=Object(l.d)(o.SourcererScopeName.timeline);return{selectedPatterns:Object(n.useMemo)((()=>e?[...new Set([...h,...b.patternList])]:[...new Set([...y,...b.patternList])]),[e,h,y,b.patternList]),from:p,to:m,shouldUpdate:d}}},function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return r})),a.d(t,"g",(function(){return s})),a.d(t,"h",(function(){return o})),a.d(t,"d",(function(){return l})),a.d(t,"c",(function(){return c})),a.d(t,"e",(function(){return u})),a.d(t,"f",(function(){return d}));var n=a(0);const i=n.i18n.translate("xpack.securitySolution.alerts.severityMapping.severityTitle",{defaultMessage:"Default severity"}),r=n.i18n.translate("xpack.securitySolution.alerts.severityMapping.defaultSeverityTitle",{defaultMessage:"Severity"}),s=n.i18n.translate("xpack.securitySolution.alerts.severityMapping.sourceFieldTitle",{defaultMessage:"Source field"}),o=n.i18n.translate("xpack.securitySolution.alerts.severityMapping.sourceValueTitle",{defaultMessage:"Source value"}),l=n.i18n.translate("xpack.securitySolution.alerts.severityMapping.severityMappingTitle",{defaultMessage:"Severity override"}),c=n.i18n.translate("xpack.securitySolution.alerts.severityMapping.defaultDescriptionLabel",{defaultMessage:"Select a severity level for all alerts generated by this rule."}),u=n.i18n.translate("xpack.securitySolution.alerts.severityMapping.mappingDescriptionLabel",{defaultMessage:"Use source event values to override the default severity."}),d=n.i18n.translate("xpack.securitySolution.alerts.severityMapping.mappingDetailsLabel",{defaultMessage:"For multiple matches the highest severity match will apply. If no match is found, the default severity will be used."})},function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return r})),a.d(t,"d",(function(){return s})),a.d(t,"h",(function(){return o})),a.d(t,"e",(function(){return l})),a.d(t,"c",(function(){return c})),a.d(t,"f",(function(){return u})),a.d(t,"g",(function(){return d}));var n=a(0);const i=n.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.riskScoreTitle",{defaultMessage:"Risk score"}),r=n.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.defaultRiskScoreTitle",{defaultMessage:"Default risk score"}),s=n.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.riskScoreFieldTitle",{defaultMessage:"kibana.alert.risk_score"}),o=n.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.sourceFieldTitle",{defaultMessage:"Source field"}),l=n.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.riskScoreMappingTitle",{defaultMessage:"Risk score override"}),c=n.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.defaultDescriptionLabel",{defaultMessage:"Select a risk score for all alerts generated by this rule."}),u=n.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.mappingDescriptionLabel",{defaultMessage:"Use a source event value to override the default risk score."}),d=n.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.mappingDetailsLabel",{defaultMessage:"If value is out of bounds, or field is not present, the default risk score will be used."})},function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(4),i=a.n(n),r=a(33),s=a.n(r),o=a(32);const l=s.a.div.withConfig({displayName:"StatusTextWrapper",componentId:"sc-185wwqd-0"})(["width:100%;display:inline-grid;"]),c=({tooltipContent:e,children:t,healthColor:a,dataTestSubj:n})=>i.a.createElement(o.EuiToolTip,{content:e},i.a.createElement(o.EuiHealth,{color:a,"data-test-subj":n},i.a.createElement(l,null,i.a.createElement("span",{className:"eui-textTruncate"},t))));c.displayName="HealthTruncateText"},function(e,t,a){"use strict";a.d(t,"c",(function(){return i})),a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return s}));var n=a(0);const i=n.i18n.translate("xpack.securitySolution.osquery.action.shortEmptyTitle",{defaultMessage:"Osquery is not available"}),r=n.i18n.translate("xpack.securitySolution.osquery.action.permissionDenied",{defaultMessage:"Permission denied"}),s=n.i18n.translate("xpack.securitySolution.osquery.action.unavailable",{defaultMessage:"The Osquery Manager integration is not added to the agent policy. To run queries on the host, add the Osquery Manager integration to the agent policy in Fleet."})},function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(4),i=a.n(n),r=a(32),s=a(181),o=a(196),l=a(176);const c=i.a.memo((({contextId:e,data:t,eventId:a,fieldFromBrowserField:n,getLinkValue:c,isDraggable:u=!1,linkValue:d,style:p,values:m})=>i.a.createElement(r.EuiFlexGroup,{alignItems:"flexStart","data-test-subj":`event-field-${t.field}`,direction:"column",gutterSize:"none",style:p},null!=m&&m.map(((p,m)=>{var g;return null==n?i.a.createElement(r.EuiFlexItem,{grow:!1,key:`${m}-${p}`},i.a.createElement(r.EuiText,{size:"xs",key:`${m}-${p}`},p)):i.a.createElement(r.EuiFlexItem,{className:"eventFieldsTable__fieldValue",grow:!1,key:`${m}-${p}`},t.field===l.h?i.a.createElement(s.a,{value:p}):i.a.createElement(o.a,{contextId:`${e}-${a}-${t.field}-${m}-${p}`,eventId:a,fieldFormat:t.format,fieldName:t.field,fieldType:t.type,isAggregatable:n.aggregatable,isDraggable:u,isObjectArray:t.isObjectArray,value:p,linkValue:null!==(g=c&&c(t.field))&&void 0!==g?g:d,truncate:!1}))})))));c.displayName="FieldValueCell"},function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(34);const i=e=>null==e?"":Object(n.isObject)(e)?JSON.stringify(e):Object(n.isNumber)(e)?e:e.toString()},function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(7),i=a(4),r=a(193),s=a(918),o=a(191),l=a(142);const c=({agentId:e})=>{const[t,a]=Object(i.useState)(!1),[c,u]=Object(i.useState)([]),[d,p]=Object(i.useState)(),[m,g]=Object(i.useState)(0),[b,f]=Object(i.useState)(0),[y,h]=Object(i.useState)(!1);return Object(i.useEffect)((()=>{const t=new AbortController;let i,c=!0;return h(!0),Object(n.isEmpty)(e)||(async()=>{try{const n=await Object(r.g)({agentId:e,signal:t.signal});c&&(a(Object(o.b)(n.metadata)),n.metadata.Endpoint.capabilities&&u([...n.metadata.Endpoint.capabilities]),p(n.host_status),i=n.metadata.elastic.agent.id)}catch(e){if("AbortError"===e.name)return;c&&400===e.body.statusCode&&p(l.b.UNENROLLED)}try{const{data:e}=await Object(s.a)(i);var n,d,m,b;c&&(g(null!==(n=null===(d=e[0].pending_actions)||void 0===d?void 0:d.isolate)&&void 0!==n?n:0),f(null!==(m=null===(b=e[0].pending_actions)||void 0===b?void 0:b.unisolate)&&void 0!==m?m:0))}catch(e){return}c&&h(!1)})(),()=>{c=!1,t.abort()}}),[e]),{loading:y,capabilities:c,isIsolated:t,agentStatus:d,pendingIsolation:m,pendingUnisolation:b}}},,function(e,t,a){"use strict";a.d(t,"c",(function(){return i})),a.d(t,"b",(function(){return r})),a.d(t,"e",(function(){return s})),a.d(t,"a",(function(){return o})),a.d(t,"d",(function(){return l}));var n=a(0);const i=n.i18n.translate("xpack.securitySolution.entityAnalytics.totalLabel",{defaultMessage:"Total"}),r=n.i18n.translate("xpack.securitySolution.entityAnalytics.hostsRiskDashboard.title",{defaultMessage:"Host Risk Scores"}),s=n.i18n.translate("xpack.securitySolution.entityAnalytics.usersRiskDashboard.title",{defaultMessage:"User Risk Scores"}),o=n.i18n.translate("xpack.securitySolution.entityAnalytics.hostsRiskDashboard.hostsTableTooltip",{defaultMessage:"The host risk table is not affected by the time range. This table shows the latest recorded risk score for each host."}),l=n.i18n.translate("xpack.securitySolution.entityAnalytics.usersRiskDashboard.usersTableTooltip",{defaultMessage:"The user risk table is not affected by the time range. This table shows the latest recorded risk score for each user."})},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=a(0).i18n.translate("xpack.securitySolution.source.destination.packetsLabel",{defaultMessage:"pkts"})},function(e,t,a){!function(e){"use strict";function t(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function a(e){let a=e,n=e;function i(e,t,a,i){for(null==a&&(a=0),null==i&&(i=e.length);a<i;){const r=a+i>>>1;n(e[r],t)<0?a=r+1:i=r}return a}return 1===e.length&&(a=(t,a)=>e(t)-a,n=function(e){return(a,n)=>t(e(a),n)}(e)),{left:i,center:function(e,t,n,r){null==n&&(n=0),null==r&&(r=e.length);const s=i(e,t,n,r-1);return s>n&&a(e[s-1],t)>-a(e[s],t)?s-1:s},right:function(e,t,a,i){for(null==a&&(a=0),null==i&&(i=e.length);a<i;){const r=a+i>>>1;n(e[r],t)>0?i=r:a=r+1}return a}}}function n(e){return null===e?NaN:+e}const i=a(t),r=i.right,s=i.left,o=a(n).center;function l(e,t){let a=0;if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&++a;else{let n=-1;for(let i of e)null!=(i=t(i,++n,e))&&(i=+i)>=i&&++a}return a}function c(e){return 0|e.length}function u(e){return!(e>0)}function d(e){return"object"!=typeof e||"length"in e?e:Array.from(e)}function p(e,t){let a,n=0,i=0,r=0;if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&(a=t-i,i+=a/++n,r+=a*(t-i));else{let s=-1;for(let o of e)null!=(o=t(o,++s,e))&&(o=+o)>=o&&(a=o-i,i+=a/++n,r+=a*(o-i))}if(n>1)return r/(n-1)}function m(e,t){const a=p(e,t);return a?Math.sqrt(a):a}function g(e,t){let a,n;if(void 0===t)for(const t of e)null!=t&&(void 0===a?t>=t&&(a=n=t):(a>t&&(a=t),n<t&&(n=t)));else{let i=-1;for(let r of e)null!=(r=t(r,++i,e))&&(void 0===a?r>=r&&(a=n=r):(a>r&&(a=r),n<r&&(n=r)))}return[a,n]}class Adder{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const t=this._partials;let a=0;for(let n=0;n<this._n&&n<32;n++){const i=t[n],r=e+i,s=Math.abs(e)<Math.abs(i)?e-(r-i):i-(r-e);s&&(t[a++]=s),e=r}return t[a]=e,this._n=a+1,this}valueOf(){const e=this._partials;let t,a,n,i=this._n,r=0;if(i>0){for(r=e[--i];i>0&&(t=r,a=e[--i],r=t+a,n=a-(r-t),!n););i>0&&(n<0&&e[i-1]<0||n>0&&e[i-1]>0)&&(a=2*n,t=r+a,a==t-r&&(r=t))}return r}}class InternMap extends Map{constructor(e,t=h){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const[t,a]of e)this.set(t,a)}get(e){return super.get(b(this,e))}has(e){return super.has(b(this,e))}set(e,t){return super.set(f(this,e),t)}delete(e){return super.delete(y(this,e))}}class InternSet extends Set{constructor(e,t=h){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const t of e)this.add(t)}has(e){return super.has(b(this,e))}add(e){return super.add(f(this,e))}delete(e){return super.delete(y(this,e))}}function b({_intern:e,_key:t},a){const n=t(a);return e.has(n)?e.get(n):a}function f({_intern:e,_key:t},a){const n=t(a);return e.has(n)?e.get(n):(e.set(n,a),a)}function y({_intern:e,_key:t},a){const n=t(a);return e.has(n)&&(a=e.get(a),e.delete(n)),a}function h(e){return null!==e&&"object"==typeof e?e.valueOf():e}function E(e){return e}function v(e,...t){return S(e,E,E,t)}function x(e,t,...a){return S(e,E,t,a)}function k(e){if(1!==e.length)throw new Error("duplicate key");return e[0]}function S(e,t,a,n){return function e(i,r){if(r>=n.length)return a(i);const s=new InternMap,o=n[r++];let l=-1;for(const e of i){const t=o(e,++l,i),a=s.get(t);a?a.push(e):s.set(t,[e])}for(const[t,a]of s)s.set(t,e(a,r));return t(s)}(e,0)}function j(e,t){return Array.from(t,(t=>e[t]))}function O(e,...a){if("function"!=typeof e[Symbol.iterator])throw new TypeError("values is not iterable");e=Array.from(e);let[n=t]=a;if(1===n.length||a.length>1){const i=Uint32Array.from(e,((e,t)=>t));return a.length>1?(a=a.map((t=>e.map(t))),i.sort(((e,n)=>{for(const i of a){const a=t(i[e],i[n]);if(a)return a}}))):(n=e.map(n),i.sort(((e,a)=>t(n[e],n[a])))),j(e,i)}return e.sort(n)}var w=Array.prototype.slice;function T(e){return function(){return e}}var I=Math.sqrt(50),C=Math.sqrt(10),M=Math.sqrt(2);function F(e,t,a){var n,i,r,s,o=-1;if(a=+a,(e=+e)==(t=+t)&&a>0)return[e];if((n=t<e)&&(i=e,e=t,t=i),0===(s=D(e,t,a))||!isFinite(s))return[];if(s>0){let a=Math.round(e/s),n=Math.round(t/s);for(a*s<e&&++a,n*s>t&&--n,r=new Array(i=n-a+1);++o<i;)r[o]=(a+o)*s}else{s=-s;let a=Math.round(e*s),n=Math.round(t*s);for(a/s<e&&++a,n/s>t&&--n,r=new Array(i=n-a+1);++o<i;)r[o]=(a+o)/s}return n&&r.reverse(),r}function D(e,t,a){var n=(t-e)/Math.max(0,a),i=Math.floor(Math.log(n)/Math.LN10),r=n/Math.pow(10,i);return i>=0?(r>=I?10:r>=C?5:r>=M?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(r>=I?10:r>=C?5:r>=M?2:1)}function A(e,t,a){let n;for(;;){const i=D(e,t,a);if(i===n||0===i||!isFinite(i))return[e,t];i>0?(e=Math.floor(e/i)*i,t=Math.ceil(t/i)*i):i<0&&(e=Math.ceil(e*i)/i,t=Math.floor(t*i)/i),n=i}}function _(e){return Math.ceil(Math.log(l(e))/Math.LN2)+1}function N(){var e=E,t=g,a=_;function n(n){Array.isArray(n)||(n=Array.from(n));var i,s,o=n.length,l=new Array(o);for(i=0;i<o;++i)l[i]=e(n[i],i,n);var c=t(l),u=c[0],d=c[1],p=a(l,u,d);if(!Array.isArray(p)){const e=d,a=+p;if(t===g&&([u,d]=A(u,d,a)),(p=F(u,d,a))[p.length-1]>=d)if(e>=d&&t===g){const e=D(u,d,a);isFinite(e)&&(e>0?d=(Math.floor(d/e)+1)*e:e<0&&(d=(Math.ceil(d*-e)+1)/-e))}else p.pop()}for(var m=p.length;p[0]<=u;)p.shift(),--m;for(;p[m-1]>d;)p.pop(),--m;var b,f=new Array(m+1);for(i=0;i<=m;++i)(b=f[i]=[]).x0=i>0?p[i-1]:u,b.x1=i<m?p[i]:d;for(i=0;i<o;++i)u<=(s=l[i])&&s<=d&&f[r(p,s,0,m)].push(n[i]);return f}return n.value=function(t){return arguments.length?(e="function"==typeof t?t:T(t),n):e},n.domain=function(e){return arguments.length?(t="function"==typeof e?e:T([e[0],e[1]]),n):t},n.thresholds=function(e){return arguments.length?(a="function"==typeof e?e:Array.isArray(e)?T(w.call(e)):T(e),n):a},n}function R(e,t){let a;if(void 0===t)for(const t of e)null!=t&&(a<t||void 0===a&&t>=t)&&(a=t);else{let n=-1;for(let i of e)null!=(i=t(i,++n,e))&&(a<i||void 0===a&&i>=i)&&(a=i)}return a}function P(e,t){let a;if(void 0===t)for(const t of e)null!=t&&(a>t||void 0===a&&t>=t)&&(a=t);else{let n=-1;for(let i of e)null!=(i=t(i,++n,e))&&(a>i||void 0===a&&i>=i)&&(a=i)}return a}function L(e,a,n=0,i=e.length-1,r=t){for(;i>n;){if(i-n>600){const t=i-n+1,s=a-n+1,o=Math.log(t),l=.5*Math.exp(2*o/3),c=.5*Math.sqrt(o*l*(t-l)/t)*(s-t/2<0?-1:1);L(e,a,Math.max(n,Math.floor(a-s*l/t+c)),Math.min(i,Math.floor(a+(t-s)*l/t+c)),r)}const t=e[a];let s=n,o=i;for(B(e,n,a),r(e[i],t)>0&&B(e,n,i);s<o;){for(B(e,s,o),++s,--o;r(e[s],t)<0;)++s;for(;r(e[o],t)>0;)--o}0===r(e[n],t)?B(e,n,o):(++o,B(e,o,i)),o<=a&&(n=o+1),a<=o&&(i=o-1)}return e}function B(e,t,a){const n=e[t];e[t]=e[a],e[a]=n}function q(e,t,a){if(n=(e=Float64Array.from(function*(e,t){if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&(yield t);else{let a=-1;for(let n of e)null!=(n=t(n,++a,e))&&(n=+n)>=n&&(yield n)}}(e,a))).length){if((t=+t)<=0||n<2)return P(e);if(t>=1)return R(e);var n,i=(n-1)*t,r=Math.floor(i),s=R(L(e,r).subarray(0,r+1));return s+(P(e.subarray(r+1))-s)*(i-r)}}function z(e,t){let a,n=-1,i=-1;if(void 0===t)for(const t of e)++i,null!=t&&(a<t||void 0===a&&t>=t)&&(a=t,n=i);else for(let r of e)null!=(r=t(r,++i,e))&&(a<r||void 0===a&&r>=r)&&(a=r,n=i);return n}function $(e,t){let a,n=-1,i=-1;if(void 0===t)for(const t of e)++i,null!=t&&(a>t||void 0===a&&t>=t)&&(a=t,n=i);else for(let r of e)null!=(r=t(r,++i,e))&&(a>r||void 0===a&&r>=r)&&(a=r,n=i);return n}function V(e,t){return[e,t]}function U(e,a=t){if(1===a.length)return $(e,a);let n,i=-1,r=-1;for(const t of e)++r,(i<0?0===a(t,t):a(t,n)<0)&&(n=t,i=r);return i}var H=G(Math.random);function G(e){return function(t,a=0,n=t.length){let i=n-(a=+a);for(;i;){const n=e()*i--|0,r=t[i+a];t[i+a]=t[n+a],t[n+a]=r}return t}}function Q(e){if(!(i=e.length))return[];for(var t=-1,a=P(e,W),n=new Array(a);++t<a;)for(var i,r=-1,s=n[t]=new Array(i);++r<i;)s[r]=e[r][t];return n}function W(e){return e.length}function K(e){return e instanceof Set?e:new Set(e)}function Y(e,t){const a=e[Symbol.iterator](),n=new Set;for(const e of t){if(n.has(e))continue;let t,i;for(;({value:t,done:i}=a.next());){if(i)return!1;if(n.add(t),Object.is(e,t))break}}return!0}e.Adder=Adder,e.InternMap=InternMap,e.InternSet=InternSet,e.ascending=t,e.bin=N,e.bisect=r,e.bisectCenter=o,e.bisectLeft=s,e.bisectRight=r,e.bisector=a,e.count=l,e.cross=function(...e){const t="function"==typeof e[e.length-1]&&function(e){return t=>e(...t)}(e.pop()),a=(e=e.map(d)).map(c),n=e.length-1,i=new Array(n+1).fill(0),r=[];if(n<0||a.some(u))return r;for(;;){r.push(i.map(((t,a)=>e[a][t])));let s=n;for(;++i[s]===a[s];){if(0===s)return t?r.map(t):r;i[s--]=0}}},e.cumsum=function(e,t){var a=0,n=0;return Float64Array.from(e,void 0===t?e=>a+=+e||0:i=>a+=+t(i,n++,e)||0)},e.descending=function(e,t){return t<e?-1:t>e?1:t>=e?0:NaN},e.deviation=m,e.difference=function(e,...t){e=new Set(e);for(const a of t)for(const t of a)e.delete(t);return e},e.disjoint=function(e,t){const a=t[Symbol.iterator](),n=new Set;for(const t of e){if(n.has(t))return!1;let e,i;for(;({value:e,done:i}=a.next())&&!i;){if(Object.is(t,e))return!1;n.add(e)}}return!0},e.every=function(e,t){if("function"!=typeof t)throw new TypeError("test is not a function");let a=-1;for(const n of e)if(!t(n,++a,e))return!1;return!0},e.extent=g,e.fcumsum=function(e,t){const a=new Adder;let n=-1;return Float64Array.from(e,void 0===t?e=>a.add(+e||0):i=>a.add(+t(i,++n,e)||0))},e.filter=function(e,t){if("function"!=typeof t)throw new TypeError("test is not a function");const a=[];let n=-1;for(const i of e)t(i,++n,e)&&a.push(i);return a},e.fsum=function(e,t){const a=new Adder;if(void 0===t)for(let t of e)(t=+t)&&a.add(t);else{let n=-1;for(let i of e)(i=+t(i,++n,e))&&a.add(i)}return+a},e.greatest=function(e,a=t){let n,i=!1;if(1===a.length){let r;for(const s of e){const e=a(s);(i?t(e,r)>0:0===t(e,e))&&(n=s,r=e,i=!0)}}else for(const t of e)(i?a(t,n)>0:0===a(t,t))&&(n=t,i=!0);return n},e.greatestIndex=function(e,a=t){if(1===a.length)return z(e,a);let n,i=-1,r=-1;for(const t of e)++r,(i<0?0===a(t,t):a(t,n)>0)&&(n=t,i=r);return i},e.group=v,e.groupSort=function(e,a,n){return(1===a.length?O(x(e,a,n),(([e,a],[n,i])=>t(a,i)||t(e,n))):O(v(e,n),(([e,n],[i,r])=>a(n,r)||t(e,i)))).map((([e])=>e))},e.groups=function(e,...t){return S(e,Array.from,E,t)},e.histogram=N,e.index=function(e,...t){return S(e,E,k,t)},e.indexes=function(e,...t){return S(e,Array.from,k,t)},e.intersection=function(e,...t){e=new Set(e),t=t.map(K);e:for(const a of e)for(const n of t)if(!n.has(a)){e.delete(a);continue e}return e},e.least=function(e,a=t){let n,i=!1;if(1===a.length){let r;for(const s of e){const e=a(s);(i?t(e,r)<0:0===t(e,e))&&(n=s,r=e,i=!0)}}else for(const t of e)(i?a(t,n)<0:0===a(t,t))&&(n=t,i=!0);return n},e.leastIndex=U,e.map=function(e,t){if("function"!=typeof e[Symbol.iterator])throw new TypeError("values is not iterable");if("function"!=typeof t)throw new TypeError("mapper is not a function");return Array.from(e,((a,n)=>t(a,n,e)))},e.max=R,e.maxIndex=z,e.mean=function(e,t){let a=0,n=0;if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&(++a,n+=t);else{let i=-1;for(let r of e)null!=(r=t(r,++i,e))&&(r=+r)>=r&&(++a,n+=r)}if(a)return n/a},e.median=function(e,t){return q(e,.5,t)},e.merge=function(e){return Array.from(function*(e){for(const t of e)yield*t}(e))},e.min=P,e.minIndex=$,e.nice=A,e.pairs=function(e,t=V){const a=[];let n,i=!1;for(const r of e)i&&a.push(t(n,r)),n=r,i=!0;return a},e.permute=j,e.quantile=q,e.quantileSorted=function(e,t,a=n){if(i=e.length){if((t=+t)<=0||i<2)return+a(e[0],0,e);if(t>=1)return+a(e[i-1],i-1,e);var i,r=(i-1)*t,s=Math.floor(r),o=+a(e[s],s,e);return o+(+a(e[s+1],s+1,e)-o)*(r-s)}},e.quickselect=L,e.range=function(e,t,a){e=+e,t=+t,a=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+a;for(var n=-1,i=0|Math.max(0,Math.ceil((t-e)/a)),r=new Array(i);++n<i;)r[n]=e+n*a;return r},e.reduce=function(e,t,a){if("function"!=typeof t)throw new TypeError("reducer is not a function");const n=e[Symbol.iterator]();let i,r,s=-1;if(arguments.length<3){if(({done:i,value:a}=n.next()),i)return;++s}for(;({done:i,value:r}=n.next()),!i;)a=t(a,r,++s,e);return a},e.reverse=function(e){if("function"!=typeof e[Symbol.iterator])throw new TypeError("values is not iterable");return Array.from(e).reverse()},e.rollup=x,e.rollups=function(e,t,...a){return S(e,Array.from,t,a)},e.scan=function(e,t){const a=U(e,t);return a<0?void 0:a},e.shuffle=H,e.shuffler=G,e.some=function(e,t){if("function"!=typeof t)throw new TypeError("test is not a function");let a=-1;for(const n of e)if(t(n,++a,e))return!0;return!1},e.sort=O,e.subset=function(e,t){return Y(t,e)},e.sum=function(e,t){let a=0;if(void 0===t)for(let t of e)(t=+t)&&(a+=t);else{let n=-1;for(let i of e)(i=+t(i,++n,e))&&(a+=i)}return a},e.superset=Y,e.thresholdFreedmanDiaconis=function(e,t,a){return Math.ceil((a-t)/(2*(q(e,.75)-q(e,.25))*Math.pow(l(e),-1/3)))},e.thresholdScott=function(e,t,a){return Math.ceil((a-t)/(3.5*m(e)*Math.pow(l(e),-1/3)))},e.thresholdSturges=_,e.tickIncrement=D,e.tickStep=function(e,t,a){var n=Math.abs(t-e)/Math.max(0,a),i=Math.pow(10,Math.floor(Math.log(n)/Math.LN10)),r=n/i;return r>=I?i*=10:r>=C?i*=5:r>=M&&(i*=2),t<e?-i:i},e.ticks=F,e.transpose=Q,e.union=function(...e){const t=new Set;for(const a of e)for(const e of a)t.add(e);return t},e.variance=p,e.zip=function(){return Q(arguments)},Object.defineProperty(e,"__esModule",{value:!0})}(t)},function(e,t,a){!function(e,t){"use strict";var a=new Date,n=new Date;function i(e,t,r,s){function o(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return o.floor=function(t){return e(t=new Date(+t)),t},o.ceil=function(a){return e(a=new Date(a-1)),t(a,1),e(a),a},o.round=function(e){var t=o(e),a=o.ceil(e);return e-t<a-e?t:a},o.offset=function(e,a){return t(e=new Date(+e),null==a?1:Math.floor(a)),e},o.range=function(a,n,i){var r,s=[];if(a=o.ceil(a),i=null==i?1:Math.floor(i),!(a<n&&i>0))return s;do{s.push(r=new Date(+a)),t(a,i),e(a)}while(r<a&&a<n);return s},o.filter=function(a){return i((function(t){if(t>=t)for(;e(t),!a(t);)t.setTime(t-1)}),(function(e,n){if(e>=e)if(n<0)for(;++n<=0;)for(;t(e,-1),!a(e););else for(;--n>=0;)for(;t(e,1),!a(e););}))},r&&(o.count=function(t,i){return a.setTime(+t),n.setTime(+i),e(a),e(n),Math.floor(r(a,n))},o.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?o.filter(s?function(t){return s(t)%e==0}:function(t){return o.count(0,t)%e==0}):o:null}),o}var r=i((function(){}),(function(e,t){e.setTime(+e+t)}),(function(e,t){return t-e}));r.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?i((function(t){t.setTime(Math.floor(t/e)*e)}),(function(t,a){t.setTime(+t+a*e)}),(function(t,a){return(a-t)/e})):r:null};var s=r.range;const o=1e3,l=6e4,c=36e5,u=864e5,d=6048e5,p=2592e6,m=31536e6;var g=i((function(e){e.setTime(e-e.getMilliseconds())}),(function(e,t){e.setTime(+e+t*o)}),(function(e,t){return(t-e)/o}),(function(e){return e.getUTCSeconds()})),b=g.range,f=i((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*o)}),(function(e,t){e.setTime(+e+t*l)}),(function(e,t){return(t-e)/l}),(function(e){return e.getMinutes()})),y=f.range,h=i((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*o-e.getMinutes()*l)}),(function(e,t){e.setTime(+e+t*c)}),(function(e,t){return(t-e)/c}),(function(e){return e.getHours()})),E=h.range,v=i((e=>e.setHours(0,0,0,0)),((e,t)=>e.setDate(e.getDate()+t)),((e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*l)/u),(e=>e.getDate()-1)),x=v.range;function k(e){return i((function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)}),(function(e,t){e.setDate(e.getDate()+7*t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*l)/d}))}var S=k(0),j=k(1),O=k(2),w=k(3),T=k(4),I=k(5),C=k(6),M=S.range,F=j.range,D=O.range,A=w.range,_=T.range,N=I.range,R=C.range,P=i((function(e){e.setDate(1),e.setHours(0,0,0,0)}),(function(e,t){e.setMonth(e.getMonth()+t)}),(function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())}),(function(e){return e.getMonth()})),L=P.range,B=i((function(e){e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,t){e.setFullYear(e.getFullYear()+t)}),(function(e,t){return t.getFullYear()-e.getFullYear()}),(function(e){return e.getFullYear()}));B.every=function(e){return isFinite(e=Math.floor(e))&&e>0?i((function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,a){t.setFullYear(t.getFullYear()+a*e)})):null};var q=B.range,z=i((function(e){e.setUTCSeconds(0,0)}),(function(e,t){e.setTime(+e+t*l)}),(function(e,t){return(t-e)/l}),(function(e){return e.getUTCMinutes()})),$=z.range,V=i((function(e){e.setUTCMinutes(0,0,0)}),(function(e,t){e.setTime(+e+t*c)}),(function(e,t){return(t-e)/c}),(function(e){return e.getUTCHours()})),U=V.range,H=i((function(e){e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+t)}),(function(e,t){return(t-e)/u}),(function(e){return e.getUTCDate()-1})),G=H.range;function Q(e){return i((function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+7*t)}),(function(e,t){return(t-e)/d}))}var W=Q(0),K=Q(1),Y=Q(2),J=Q(3),X=Q(4),Z=Q(5),ee=Q(6),te=W.range,ae=K.range,ne=Y.range,ie=J.range,re=X.range,se=Z.range,oe=ee.range,le=i((function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCMonth(e.getUTCMonth()+t)}),(function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())}),(function(e){return e.getUTCMonth()})),ce=le.range,ue=i((function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)}),(function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()}),(function(e){return e.getUTCFullYear()}));ue.every=function(e){return isFinite(e=Math.floor(e))&&e>0?i((function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,a){t.setUTCFullYear(t.getUTCFullYear()+a*e)})):null};var de=ue.range;function pe(e,a,n,i,s,b){const f=[[g,1,o],[g,5,5e3],[g,15,15e3],[g,30,3e4],[b,1,l],[b,5,3e5],[b,15,9e5],[b,30,18e5],[s,1,c],[s,3,108e5],[s,6,216e5],[s,12,432e5],[i,1,u],[i,2,1728e5],[n,1,d],[a,1,p],[a,3,7776e6],[e,1,m]];function y(a,n,i){const s=Math.abs(n-a)/i,o=t.bisector((([,,e])=>e)).right(f,s);if(o===f.length)return e.every(t.tickStep(a/m,n/m,i));if(0===o)return r.every(Math.max(t.tickStep(a,n,i),1));const[l,c]=f[s/f[o-1][2]<f[o][2]/s?o-1:o];return l.every(c)}return[function(e,t,a){const n=t<e;n&&([e,t]=[t,e]);const i=a&&"function"==typeof a.range?a:y(e,t,a),r=i?i.range(e,+t+1):[];return n?r.reverse():r},y]}const[me,ge]=pe(ue,le,W,H,V,z),[be,fe]=pe(B,P,S,v,h,f);e.timeDay=v,e.timeDays=x,e.timeFriday=I,e.timeFridays=N,e.timeHour=h,e.timeHours=E,e.timeInterval=i,e.timeMillisecond=r,e.timeMilliseconds=s,e.timeMinute=f,e.timeMinutes=y,e.timeMonday=j,e.timeMondays=F,e.timeMonth=P,e.timeMonths=L,e.timeSaturday=C,e.timeSaturdays=R,e.timeSecond=g,e.timeSeconds=b,e.timeSunday=S,e.timeSundays=M,e.timeThursday=T,e.timeThursdays=_,e.timeTickInterval=fe,e.timeTicks=be,e.timeTuesday=O,e.timeTuesdays=D,e.timeWednesday=w,e.timeWednesdays=A,e.timeWeek=S,e.timeWeeks=M,e.timeYear=B,e.timeYears=q,e.utcDay=H,e.utcDays=G,e.utcFriday=Z,e.utcFridays=se,e.utcHour=V,e.utcHours=U,e.utcMillisecond=r,e.utcMilliseconds=s,e.utcMinute=z,e.utcMinutes=$,e.utcMonday=K,e.utcMondays=ae,e.utcMonth=le,e.utcMonths=ce,e.utcSaturday=ee,e.utcSaturdays=oe,e.utcSecond=g,e.utcSeconds=b,e.utcSunday=W,e.utcSundays=te,e.utcThursday=X,e.utcThursdays=re,e.utcTickInterval=ge,e.utcTicks=me,e.utcTuesday=Y,e.utcTuesdays=ne,e.utcWednesday=J,e.utcWednesdays=ie,e.utcWeek=W,e.utcWeeks=te,e.utcYear=ue,e.utcYears=de,Object.defineProperty(e,"__esModule",{value:!0})}(t,a(641))},function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return c})),a.d(t,"c",(function(){return u}));var n=a(32),i=a(34),r=a(4),s=a.n(r),o=a(88);const l="process.name",c="user.name",u=s.a.memo((({contextId:e,eventId:t,isDraggable:a,processName:r,userName:u})=>s.a.createElement(n.EuiFlexGroup,{alignItems:"flexStart","data-test-subj":"user-process",direction:"column",justifyContent:"center",gutterSize:"none"},null!=u?Object(i.uniq)(u).map((i=>s.a.createElement(n.EuiFlexItem,{grow:!1,key:i},s.a.createElement(o.c,{contextId:e,"data-test-subj":"user-name",eventId:t,field:c,isDraggable:a,value:i,iconType:"user",isAggregatable:!0,fieldType:"keyword"})))):null,null!=r?Object(i.uniq)(r).map((i=>s.a.createElement(n.EuiFlexItem,{grow:!1,key:i},s.a.createElement(o.c,{contextId:e,eventId:t,field:l,isDraggable:a,value:i,iconType:"console",isAggregatable:!0,fieldType:"keyword"})))):null)));u.displayName="UserProcess"},function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(4),i=a.n(n),r=a(88),s=a(260),o=a(97);const l=i.a.memo((({contextId:e,eventId:t,hostName:a,workingDirectory:n,isDraggable:l})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(o.c,{grow:!1,component:"span"},i.a.createElement(r.c,{contextId:e,eventId:t,field:"host.name",value:a,isDraggable:l,fieldType:"keyword",isAggregatable:!0})),null!=n&&i.a.createElement(o.c,{grow:!1,component:"span"},s.d),i.a.createElement(o.c,{grow:!1,component:"span"},i.a.createElement(r.c,{contextId:e,eventId:t,field:"process.working_directory",value:n,iconType:"folderOpen",isDraggable:l,fieldType:"keyword",isAggregatable:!0})))));l.displayName="HostWorkingDir"},function(e,t,a){"use strict";a.d(t,"e",(function(){return i})),a.d(t,"b",(function(){return r})),a.d(t,"d",(function(){return s})),a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return l}));var n=a(0);n.i18n.translate("xpack.securitySolution.timeline.expandableEvent.messageTitle",{defaultMessage:"Message"});const i=n.i18n.translate("xpack.securitySolution.timeline.expandableEvent.openAlertDetails",{defaultMessage:"Open alert details page"}),r=n.i18n.translate("xpack.securitySolution.timeline.expandableEvent.closeEventDetailsLabel",{defaultMessage:"close"}),s=n.i18n.translate("xpack.securitySolution.timeline.expandableEvent.placeholder",{defaultMessage:"Select an event to show event details"}),o=n.i18n.translate("xpack.securitySolution.timeline.expandableEvent.eventTitleLabel",{defaultMessage:"Event details"}),l=n.i18n.translate("xpack.securitySolution.timeline.expandableEvent.alertTitleLabel",{defaultMessage:"Alert details"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(4),i=a(875);const r={isolateAction:"isolateHost",isHostIsolationPanelOpen:!1,isIsolateActionSuccessBannerVisible:!1};function s(e,t){switch(t.type){case"setIsolateAction":return{...e,isolateAction:t.isolateAction};case"setIsHostIsolationPanel":return{...e,isHostIsolationPanelOpen:t.isHostIsolationPanelOpen};case"setIsIsolateActionSuccessBannerVisible":return{...e,isIsolateActionSuccessBannerVisible:t.isIsolateActionSuccessBannerVisible};default:throw new Error}}const o=()=>{const[{isolateAction:e,isHostIsolationPanelOpen:t,isIsolateActionSuccessBannerVisible:a},o]=Object(n.useReducer)(s,r),l=Object(n.useCallback)((()=>{o({type:"setIsHostIsolationPanel",isHostIsolationPanelOpen:!1}),o({type:"setIsIsolateActionSuccessBannerVisible",isIsolateActionSuccessBannerVisible:!1})}),[]),c=Object(n.useCallback)((e=>{"isolateHost"!==e&&"unisolateHost"!==e||(o({type:"setIsHostIsolationPanel",isHostIsolationPanelOpen:!0}),o({type:"setIsolateAction",isolateAction:e}))}),[]),u=Object(i.b)(),d=Object(n.useCallback)((()=>{o({type:"setIsIsolateActionSuccessBannerVisible",isIsolateActionSuccessBannerVisible:!0}),u&&u.refreshCase()}),[u]);return Object(n.useMemo)((()=>({isolateAction:e,isHostIsolationPanelOpen:t,isIsolateActionSuccessBannerVisible:a,handleIsolationActionSuccess:d,showAlertDetails:l,showHostIsolationPanel:c})),[t,a,e,d,l,c])}},,function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return s})),a.d(t,"d",(function(){return o}));var n=a(0);const i=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.additionalFiltersTitle",{defaultMessage:"Additional filters"}),r=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.additionalFiltersActions.showBuildingBlockTitle",{defaultMessage:"Include building block alerts"}),s=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.additionalFiltersActions.showOnlyThreatIndicatorAlerts",{defaultMessage:"Show only threat indicator alerts"}),o=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.takeActionTitle",{defaultMessage:"Take action"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(4),i=a.n(n),r=a(32),s=a(93),o=a(165),l=a(118);const c=({isEndpointAlert:e,onAddExceptionTypeClick:t})=>{const[{canUserCRUD:a,hasIndexWrite:c}]=Object(o.b)(),u=Object(n.useCallback)((()=>{t()}),[t]),d=Object(n.useCallback)((()=>{t(s.b.ENDPOINT)}),[t]),p=!a||!c||!e,m=!a||!c;return{exceptionActionItems:Object(n.useMemo)((()=>m?[]:[i.a.createElement(r.EuiContextMenuItem,{key:"add-endpoint-exception-menu-item","data-test-subj":"add-endpoint-exception-menu-item",disabled:p,onClick:d},l.b),i.a.createElement(r.EuiContextMenuItem,{key:"add-exception-menu-item","data-test-subj":"add-exception-menu-item",disabled:m,onClick:u},l.e)]),[p,m,u,d])}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return S}));var n=a(4),i=a.n(n),r=a(78),s=a(32),o=a(0),l=a(135),c=a(172),u=a(112),d=a(77),p=a(79),m=a(86),g=a(478),b=a(136),f=a(210),y=a(118),h=a(81),E=a(99),v=a(84),x=a(154),k=a(179);const S=({ecsRowData:e,onInvestigateInTimelineAlertClick:t})=>{const{addError:a}=Object(v.a)(),{data:{search:S,query:j}}=Object(d.k)().services,O=Object(r.useDispatch)(),{startTransaction:w}=Object(x.a)(),{services:T}=Object(d.k)(),{getExceptionFilterFromIds:I}=Object(c.c)(T.http),C=Object(n.useCallback)((async e=>{var t;let n=null!==(t=Object(E.getField)(e,l.s))&&void 0!==t?t:[];if(0===n.length)try{var i;const t=null!==(i=Object(E.getField)(e,l.A))&&void 0!==i?i:{};if(t.length>0){var r;const e=JSON.parse(t[0]);n=null!==(r=null==e?void 0:e.exceptions_list)&&void 0!==r?r:[]}}catch(e){}const s=n.reduce(((e,t)=>{const a="string"==typeof t?JSON.parse(t):t;if("detection"===a.type){const t={exception_list_id:a.list_id,namespace_type:a.namespace_type};e.push(t)}return e}),[]);let c;return s.length>0&&await I({exceptionListIds:s,excludeExceptions:!0,chunkSize:20,alias:"Exceptions",onSuccess:e=>{c=e},onError:e=>{a(e,{title:o.i18n.translate("xpack.securitySolution.detectionEngine.alerts.fetchExceptionFilterFailure",{defaultMessage:"Error fetching exception filter."})})}}),c}),[a,I]),M=Object(n.useMemo)((()=>j.filterManager),[j.filterManager]),F=Object(n.useMemo)((()=>m.b.getTimelineByIdSelector()),[]),{filterManager:D}=Object(h.a)((e=>{var t,a;return null!==(t=F(e,null!==(a=p.j.active)&&void 0!==a?a:""))&&void 0!==t?t:u.b})),A=Object(n.useMemo)((()=>null!=D?D:M),[D,M]),_=Object(n.useCallback)((e=>O(m.a.updateIsLoading(e))),[O]),N=Object(f.a)({timelineId:p.j.active,timelineType:p.n.default}),R=Object(n.useCallback)((({from:e,timeline:t,to:a,ruleNote:n})=>{var i;N(),_({id:p.j.active,isLoading:!1}),Object(b.b)(O)({duplicate:!0,from:e,id:p.j.active,notes:[],timeline:{...t,filterManager:A,indexNames:null!==(i=t.indexNames)&&void 0!==i?i:[],show:!0},to:a,ruleNote:n})()}),[O,A,_,N]),P=Object(n.useCallback)((async()=>{w({name:k.a.INVESTIGATE_IN_TIMELINE}),t&&t(),null!=e&&await Object(g.b)({createTimeline:R,ecsData:e,searchStrategyClient:S,updateTimelineIsLoading:_,getExceptionFilter:C})}),[w,R,e,t,S,_,C]);return{investigateInTimelineActionItems:Object(n.useMemo)((()=>[i.a.createElement(s.EuiContextMenuItem,{key:"investigate-in-timeline-action-item","data-test-subj":"investigate-in-timeline-action-item",disabled:null==e,onClick:P},y.f)]),[e,P]),investigateInTimelineAlertClick:P}}},function(e,t,a){"use strict";a.d(t,"d",(function(){return u})),a.d(t,"c",(function(){return d})),a.d(t,"b",(function(){return m})),a.d(t,"a",(function(){return g}));var n=a(34),i=a(45),r=a(79),s=a(106);const o=["host.name","host.hostname","host.domain","host.id","host.ip","client.ip","destination.ip","server.ip","source.ip","network.community_id","user.name","process.name"],l=(e,t,a=console)=>{var n,i;const r=null!==(n=null===(i=t.find((t=>t.field===e)))||void 0===i?void 0:i.values)&&void 0!==n?n:null;return null==r?[]:"string"==typeof r?[r]:Array.isArray(r)&&r.every((e=>"string"==typeof e))?r:(a.trace("Data type that is not a string or string array detected:",r,"when trying to access field:",e,"from data object of:",t),[])},c=(e,t=[])=>{let a=t;return"is"===e.function&&o.includes(e.arguments[0].value)&&(a=[...a,{field:e.arguments[0].value,valueToChange:e.arguments[1].value}]),e.arguments.reduce(((e,t)=>"is"===t.function&&o.includes(t.arguments[0].value)?[...e,{field:t.arguments[0].value,valueToChange:t.arguments[1].value}]:t.arguments?c(t,e):e),a)},u=(e,t,a=r.n.default)=>a===r.n.default?""!==e.trim()?c(Object(i.fromKueryExpression)(e)).reduce(((e,a)=>{const n=l(a.field,t);return n.length?e.replace(a.valueToChange,n[0]):e}),e):"":e.trim(),d=(e,t)=>e.map((e=>{if("phrase"===e.meta.type&&null!=e.meta.key&&o.includes(e.meta.key)){const a=l(e.meta.key,t);a.length&&(e.meta.params={query:a[0]},e.query={match_phrase:{[e.meta.key]:a[0]}})}return e})),p=(e,t,a=r.n.default)=>{if(a!==r.n.template){if(o.includes(e.queryMatch.field)){const a=l(e.queryMatch.field,t);a.length&&(e.id=e.id.replace(e.name,a[0]),e.name=a[0],e.queryMatch.value=a[0],e.queryMatch.displayField=void 0,e.queryMatch.displayValue=void 0)}return e.type=s.a.default,e}if(a===r.n.template){var n;if(e.type===s.a.template&&":"===e.queryMatch.operator){const a=l(e.queryMatch.field,t);return a.length||(e.enabled=!1),e.id=e.id.replace(e.name,a[0]),e.name=a[0],e.queryMatch.value=a[0],e.queryMatch.displayField=void 0,e.queryMatch.displayValue=void 0,e.type=s.a.default,e}return e.type=null!==(n=e.type)&&void 0!==n?n:s.a.default,e}return e},m=(e,t,a=r.n.default)=>e.map((e=>{const i=p(e,t,a);return null==i.and||Object(n.isEmpty)(i.and)||(i.and=i.and.map((e=>p(e,t,a)))),i})),g=(e,t)=>[{range:{"@timestamp":{gte:e,lt:t,format:"strict_date_optional_time"}},meta:{type:"range",disabled:!1,negate:!1,alias:null,key:"@timestamp",params:{gte:e,lt:t,format:"strict_date_optional_time"}},$state:{store:i.FilterStateStore.APP_STATE}}]},function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(4),i=a.n(n),r=a(32),s=a(118);const o=({onAddEventFilterClick:e,disabled:t=!1,tooltipMessage:a})=>({eventFilterActionItems:Object(n.useMemo)((()=>[i.a.createElement(r.EuiContextMenuItem,{key:"add-event-filter-menu-item","data-test-subj":"add-event-filter-menu-item",onClick:e,disabled:t,toolTipContent:a},s.c)]),[e,t,a])})},function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(321),i=a.n(n);const r={macos:!0,windows:!0};function s(e){return e.includes("-")?e.substring(0,e.indexOf("-")):e}const o=({osName:e,version:t,capabilities:a})=>!(!t||!(({currentVersion:e,minVersionRequired:t="7.14.0"})=>{try{const a=s(e);return i()(t,a)}catch(a){return window&&window.console&&window.console.warn(`SecuritySolution: isVersionSupported(): Unable to determine if current version [${e}] meets minimum version [${t}]. Error: ${a.message}`),!1}})({currentVersion:t}))&&(function(e){const t=s(e);return i()("7.15.0",t)}(t)?function(e=[]){return e.includes("isolation")}(a):function(e){return(({currentOs:e,supportedOss:t=r})=>!!t[e])({currentOs:e.toLowerCase()})}(e))},function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(4),i=a.n(n),r=a(32),s=a(611);const o=({handleClick:e})=>i.a.createElement(r.EuiContextMenuItem,{key:"osquery-action-item","data-test-subj":"osquery-action-item",onClick:e},s.a)},function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(4);const i=({refetch:e,onRuleChange:t,isActiveTimelines:a})=>{const[i,r]=Object(n.useState)(!1),[s,o]=Object(n.useState)(null);return{exceptionFlyoutType:s,openAddExceptionFlyout:i,onAddExceptionTypeClick:Object(n.useCallback)((e=>{o(null!=e?e:null),r(!0)}),[]),onAddExceptionCancel:Object(n.useCallback)((()=>{o(null),r(!1)}),[]),onAddExceptionConfirm:Object(n.useCallback)(((n,i,s)=>{e&&(!1===a||s)&&e(),null!=t&&n&&t(),r(!1)}),[t,e,a])}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(4),i=a(723),r=a(77),s=a(175);const o=e=>{const{data:t,spaces:a}=Object(r.k)().services,[o,l]=Object(n.useState)(!1),[c,u]=Object(n.useState)(""),d=Object(n.useMemo)((()=>null!=e&&1===e.length),[e]),p=Object(n.useMemo)((()=>null!=e&&d&&"machine_learning"===e[0].type),[d,e]);Object(n.useEffect)((()=>{(async()=>{if(a){const e=await a.getActiveSpace();u(e.id)}})()}),[a]);const m=Object(n.useMemo)((()=>null!=e&&d?e[0].data_view_id||null:`security-solution-${c}`),[d,e,c]),g=Object(n.useMemo)((()=>!m&&null!=e&&d&&null!=e[0].index?e[0].index:[]),[m,d,e]),b=Object(n.useMemo)((()=>{var t;return p&&d&&null!=e&&null!==(t=e[0].machine_learning_job_id)&&void 0!==t?t:[]}),[p,d,e]),{loading:f,jobs:y}=Object(i.a)(b),h=Object(n.useMemo)((()=>p&&y.length>0?y[0].results_index_name?[`.ml-anomalies-${y[0].results_index_name}`]:[]:null!=m?[]:g),[y,p,m,g]),[E,{indexPatterns:v}]=Object(s.b)(h),[x,k]=Object(n.useState)(null);return Object(n.useEffect)((()=>{(async()=>{if(""!==c&&m){l(!0);const e=await t.dataViews.get(m);l(!1),k(e)}})()}),[m,t.dataViews,k,c]),{isLoading:E||f||o,indexPatterns:Object(n.useMemo)((()=>m&&null!=x?x:v),[m,x,v])}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(4),i=a(138),r=a(77),s=a(361);const o=()=>{const e=Object(r.o)(),[t,a]=Object(n.useState)(!0),[o,l]=Object(n.useState)(!1),[c,u]=Object(n.useState)(null),d=Object(n.useRef)(null);return Object(n.useEffect)((()=>{let t=!0;const n=new AbortController;return d.current=async r=>{try{a(!0);const{references:e}=await Object(i.h)({lists:r,signal:n.signal}),s=e.reduce(((e,t)=>{const[[a,n]]=Object.entries(t);return e[a]=n,e}),{});t&&(a(!1),l(!1),u(s))}catch(n){t&&(l(!0),a(!1),e.addError(n,{title:s.c}))}},()=>{t=!1,n.abort()}}),[e]),[t,o,c,d.current]}},function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(4),i=a(172),r=a(190),s=a(77);const o=()=>{const{services:{http:e}}=Object(s.k)(),[t,a]=Object(n.useState)(!1),o=Object(n.useRef)(null),{addExceptionListItem:l,updateExceptionListItem:c}=Object(i.c)(e);return Object(n.useEffect)((()=>{const e=new AbortController;return o.current=async e=>{a(!0);const t=await Promise.all(e.map((e=>{if("id"in e&&null!=e.id){const t=Object(r.i)(e);return c({listItem:t})}return l({listItem:e})})));return a(!1),t},()=>{a(!1),e.abort()}}),[c,e,l]),[t,o.current]}},function(e,t,a){const n=a(152);e.exports=(e,t,a)=>0!==n(e,t,a)},function(e,t,a){const n=a(482),i=a(659),r=a(362),s=a(363),o=a(484),l=a(321);e.exports=(e,t,a,c)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof a&&(a=a.version),e===a;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof a&&(a=a.version),e!==a;case"":case"=":case"==":return n(e,a,c);case"!=":return i(e,a,c);case">":return r(e,a,c);case">=":return s(e,a,c);case"<":return o(e,a,c);case"<=":return l(e,a,c);default:throw new TypeError(`Invalid operator: ${t}`)}}},function(e,t,a){"use strict";a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){return i})),a.d(t,"d",(function(){return r})),a.d(t,"b",(function(){return s}));const n=({group:e,id:t,action_type_id:a,params:n})=>({group:e,id:t,params:n,actionTypeId:a}),i=({group:e,id:t,actionTypeId:a,params:n})=>({group:e,id:t,params:n,action_type_id:a}),r=({action_type_id:e,params:t})=>{const{saved_query_id:a,ecs_mapping:n,pack_id:i,...r}=t;return{params:{...r,savedQueryId:a,ecsMapping:n,packId:i},actionTypeId:e}},s=({actionTypeId:e,params:t})=>{const{savedQueryId:a,ecsMapping:n,packId:i,...r}=t;return{params:{...r,saved_query_id:a,ecs_mapping:n,pack_id:i},action_type_id:e}}},function(e,t,a){"use strict";const n=a(4),i=a(996),r=a(997),s=a(998),o=a(1045),l=a(1077),c=a(1046),u=a(1047),d=a(1049),p=a(1050).hastChildrenToReact;e.exports=b;const m={}.hasOwnProperty,g={renderers:{to:"components",id:"change-renderers-to-components"},astPlugins:{id:"remove-buggy-html-in-markdown-parser"},allowDangerousHtml:{id:"remove-buggy-html-in-markdown-parser"},escapeHtml:{id:"remove-buggy-html-in-markdown-parser"},source:{to:"children",id:"change-source-to-children"},allowNode:{to:"allowElement",id:"replace-allownode-allowedtypes-and-disallowedtypes"},allowedTypes:{to:"allowedElements",id:"replace-allownode-allowedtypes-and-disallowedtypes"},disallowedTypes:{to:"disallowedElements",id:"replace-allownode-allowedtypes-and-disallowedtypes"},includeNodeIndex:{to:"includeElementIndex",id:"change-includenodeindex-to-includeelementindex"}};function b(e){for(const t in g)if(m.call(g,t)&&m.call(e,t)){const e=g[t];console.warn(`[react-markdown] Warning: please ${e.to?`use \`${e.to}\` instead of`:"remove"} \`${t}\` (see <https://github.com/remarkjs/react-markdown/blob/main/changelog.md#${e.id}> for more info)`),delete g[t]}const t=r().use(s).use(e.remarkPlugins||e.plugins||[]).use(o,{allowDangerousHtml:!0}).use(e.rehypePlugins||[]).use(u,e);let a;"string"==typeof e.children?a=i(e.children):(void 0!==e.children&&null!==e.children&&console.warn(`[react-markdown] Warning: please pass a string as \`children\` (not: \`${e.children}\`)`),a=i());const l=t.runSync(t.parse(a),a);if("root"!==l.type)throw new TypeError("Expected a `root` node");let d=n.createElement(n.Fragment,{},p({options:e,schema:c,listDepth:0},l));return e.className&&(d=n.createElement("div",{className:e.className},d)),d}b.defaultProps={transformLinkUri:d},b.propTypes={children:l.string,className:l.string,allowElement:l.func,allowedElements:l.arrayOf(l.string),disallowedElements:l.arrayOf(l.string),unwrapDisallowed:l.bool,remarkPlugins:l.arrayOf(l.oneOfType([l.object,l.func,l.arrayOf(l.oneOfType([l.object,l.func]))])),rehypePlugins:l.arrayOf(l.oneOfType([l.object,l.func,l.arrayOf(l.oneOfType([l.object,l.func]))])),sourcePos:l.bool,rawSourcePos:l.bool,skipHtml:l.bool,includeElementIndex:l.bool,transformLinkUri:l.oneOfType([l.func,l.bool]),linkTarget:l.oneOfType([l.func,l.string]),transformImageUri:l.func,components:l.object},b.uriTransformer=d},function(e,t,a){"use strict";var n={}.hasOwnProperty;e.exports=n},function(e,t,a){"use strict";e.exports=function(e){for(var t=-1,a=0;++t<e.length;)a+="string"==typeof e[t]?e[t].length:1;return a}},function(e,t,a){"use strict";var n=a(309),i=a(200),r=a(263);function s(e,t){for(var a,n,r,s,o,l,c=e[t][1],u=e[t][2],d=t-1,p=[],m=c._tokenizer||u.parser[c.contentType](c.start),g=m.events,b=[],f={};c;){for(;e[++d][1]!==c;);p.push(d),c._tokenizer||(a=u.sliceStream(c),c.next||a.push(null),n&&m.defineSkip(c.start),c.isInFirstContentOfListItem&&(m._gfmTasklistFirstContentOfListItem=!0),m.write(a),c.isInFirstContentOfListItem&&(m._gfmTasklistFirstContentOfListItem=void 0)),n=c,c=c.next}for(c=n,r=g.length;r--;)"enter"===g[r][0]?s=!0:s&&g[r][1].type===g[r-1][1].type&&g[r][1].start.line!==g[r][1].end.line&&(y(g.slice(r+1,o)),c._tokenizer=c.next=void 0,c=c.previous,o=r+1);for(m.events=c._tokenizer=c.next=void 0,y(g.slice(0,o)),r=-1,l=0;++r<b.length;)f[l+b[r][0]]=l+b[r][1],l+=b[r][1]-b[r][0]-1;return f;function y(t){var a=p.pop();b.unshift([a,a+t.length-1]),i(e,a,2,t)}}e.exports=function(e){for(var t,a,o,l,c,u,d,p={},m=-1;++m<e.length;){for(;m in p;)m=p[m];if(t=e[m],m&&"chunkFlow"===t[1].type&&"listItemPrefix"===e[m-1][1].type&&((o=0)<(u=t[1]._tokenizer.events).length&&"lineEndingBlank"===u[o][1].type&&(o+=2),o<u.length&&"content"===u[o][1].type))for(;++o<u.length&&"content"!==u[o][1].type;)"chunkText"===u[o][1].type&&(u[o][1].isInFirstContentOfListItem=!0,o++);if("enter"===t[0])t[1].contentType&&(n(p,s(e,m)),m=p[m],d=!0);else if(t[1]._container||t[1]._movePreviousLineEndings){for(o=m,a=void 0;o--&&("lineEnding"===(l=e[o])[1].type||"lineEndingBlank"===l[1].type);)"enter"===l[0]&&(a&&(e[a][1].type="lineEndingBlank"),l[1].type="lineEnding",a=o);a&&(t[1].end=r(e[a][1].start),(c=e.slice(a,m)).unshift(t),i(e,a,m-a+1,c))}}return!d}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(309),i=a(263),r=l("text"),s=l("string"),o={resolveAll:c()};function l(e){return{tokenize:function(t){var a=this,n=this.parser.constructs[e],i=t.attempt(n,r,s);return r;function r(e){return l(e)?i(e):s(e)}function s(e){if(null!==e)return t.enter("data"),t.consume(e),o;t.consume(e)}function o(e){return l(e)?(t.exit("data"),i(e)):(t.consume(e),o)}function l(e){var t=n[e],i=-1;if(null===e)return!0;if(t)for(;++i<t.length;)if(!t[i].previous||t[i].previous.call(a,a.previous))return!0}},resolveAll:c("text"===e?u:void 0)}}function c(e){return function(t,a){for(var n,i=-1;++i<=t.length;)void 0===n?t[i]&&"data"===t[i][1].type&&(n=i,i++):t[i]&&"data"===t[i][1].type||(i!==n+2&&(t[n][1].end=t[i-1][1].end,t.splice(n+2,i-n-2),i=n+2),n=void 0);return e?e(t,a):t}}function u(e,t){for(var a,r,s,o,l,c,u,d,p=-1;++p<=e.length;)if((p===e.length||"lineEnding"===e[p][1].type)&&"data"===e[p-1][1].type){for(r=e[p-1][1],o=(a=t.sliceStream(r)).length,l=-1,c=0,u=void 0;o--;)if("string"==typeof(s=a[o])){for(l=s.length;32===s.charCodeAt(l-1);)c++,l--;if(l)break;l=-1}else if(-2===s)u=!0,c++;else if(-1!==s){o++;break}c&&(d={type:p===e.length||u||c<2?"lineSuffix":"hardBreakTrailing",start:{line:r.end.line,column:r.end.column-c,offset:r.end.offset-c,_index:r.start._index+o,_bufferIndex:o?l:r.start._bufferIndex+l},end:i(r.end)},r.end=i(d.start),r.start.offset===r.end.offset?n(r,d):(e.splice(p,0,["enter",d,t],["exit",d,t]),p+=2)),p++}return e}t.resolver=o,t.string=s,t.text=r},function(e,t,a){"use strict";e.exports=function(e){return e<32||127===e}},function(e,t,a){e.exports=a(27)(3126)},function(e,t,a){"use strict";var n=a(202)(/\d/);e.exports=n},function(e,t,a){"use strict";var n=a(667),i=a(201),r=a(115);e.exports=function(e,t,a,s,o,l,c,u,d){var p=d||1/0,m=0;return function(t){return 60===t?(e.enter(s),e.enter(o),e.enter(l),e.consume(t),e.exit(l),g):n(t)||41===t?a(t):(e.enter(s),e.enter(c),e.enter(u),e.enter("chunkString",{contentType:"string"}),y(t))};function g(a){return 62===a?(e.enter(l),e.consume(a),e.exit(l),e.exit(o),e.exit(s),t):(e.enter(u),e.enter("chunkString",{contentType:"string"}),b(a))}function b(t){return 62===t?(e.exit("chunkString"),e.exit(u),g(t)):null===t||60===t||r(t)?a(t):(e.consume(t),92===t?f:b)}function f(t){return 60===t||62===t||92===t?(e.consume(t),b):b(t)}function y(r){return 40===r?++m>p?a(r):(e.consume(r),y):41===r?m--?(e.consume(r),y):(e.exit("chunkString"),e.exit(u),e.exit(c),e.exit(s),t(r)):null===r||i(r)?m?a(r):(e.exit("chunkString"),e.exit(u),e.exit(c),e.exit(s),t(r)):n(r)?a(r):(e.consume(r),92===r?h:y)}function h(t){return 40===t||41===t||92===t?(e.consume(t),y):y(t)}}},function(e,t,a){"use strict";var n=a(115),i=a(189);e.exports=function(e,t,a,r,s,o){var l,c=this,u=0;return function(t){return e.enter(r),e.enter(s),e.consume(t),e.exit(s),e.enter(o),d};function d(i){return null===i||91===i||93===i&&!l||94===i&&!u&&"_hiddenFootnoteSupport"in c.parser.constructs||u>999?a(i):93===i?(e.exit(o),e.enter(s),e.consume(i),e.exit(s),e.exit(r),t):n(i)?(e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),d):(e.enter("chunkString",{contentType:"string"}),p(i))}function p(t){return null===t||91===t||93===t||n(t)||u++>999?(e.exit("chunkString"),d(t)):(e.consume(t),l=l||!i(t),92===t?m:p)}function m(t){return 91===t||92===t||93===t?(e.consume(t),u++,p):p(t)}}},function(e,t,a){"use strict";var n=a(115),i=a(189),r=a(122);e.exports=function(e,t){var a;return function s(o){return n(o)?(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),a=!0,s):i(o)?r(e,s,a?"linePrefix":"lineSuffix")(o):t(o)}}},function(e,t,a){"use strict";var n=a(115),i=a(122);e.exports=function(e,t,a,r,s,o){var l;return function(t){return e.enter(r),e.enter(s),e.consume(t),e.exit(s),l=40===t?41:t,c};function c(a){return a===l?(e.enter(s),e.consume(a),e.exit(s),e.exit(r),t):(e.enter(o),u(a))}function u(t){return t===l?(e.exit(o),c(l)):null===t?a(t):n(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),i(e,u,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),d(t))}function d(t){return t===l||null===t||n(t)?(e.exit("chunkString"),u(t)):(e.consume(t),92===t?p:d)}function p(t){return t===l||92===t?(e.consume(t),d):d(t)}}},function(e,t,a){"use strict";var n=a(115),i=a(189),r=a(122),s={name:"thematicBreak",tokenize:function(e,t,a){var s,o=0;return function(t){return e.enter("thematicBreak"),s=t,l(t)};function l(u){return u===s?(e.enter("thematicBreakSequence"),c(u)):i(u)?r(e,l,"whitespace")(u):o<3||null!==u&&!n(u)?a(u):(e.exit("thematicBreak"),t(u))}function c(t){return t===s?(e.consume(t),o++,c):(e.exit("thematicBreakSequence"),l(t))}}};e.exports=s},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=a(0).i18n.translate("xpack.securitySolution.detectionEngine.createRule.ruleActionsField.ruleActionsFormErrorsTitle",{defaultMessage:"Please fix issues listed below"})},function(e,t,a){"use strict";a.d(t,"c",(function(){return i})),a.d(t,"b",(function(){return r})),a.d(t,"e",(function(){return s})),a.d(t,"j",(function(){return o})),a.d(t,"a",(function(){return l})),a.d(t,"h",(function(){return c})),a.d(t,"g",(function(){return u})),a.d(t,"i",(function(){return d})),a.d(t,"d",(function(){return p})),a.d(t,"f",(function(){return m}));var n=a(0);const i=n.i18n.translate("xpack.securitySolution.expandedValue.showTopN.showTopValues",{defaultMessage:"Show top values"}),r=n.i18n.translate("xpack.securitySolution.expandedValue.hideTopValues.HideTopValues",{defaultMessage:"Hide top values"}),s=n.i18n.translate("xpack.securitySolution.expandedValue.links.viewHostSummary",{defaultMessage:"View host summary"}),o=n.i18n.translate("xpack.securitySolution.expandedValue.links.viewUserSummary",{defaultMessage:"View user summary"}),l=n.i18n.translate("xpack.securitySolution.expandedValue.links.expandIpDetails",{defaultMessage:"Expand ip details"}),c=n.i18n.translate("xpack.securitySolution.expandedValue.links.viewRuleDetails",{defaultMessage:"View rule details"}),u=n.i18n.translate("xpack.securitySolution.expandedValue.links.viewPortDetails",{defaultMessage:"View port details"}),d=n.i18n.translate("xpack.securitySolution.expandedValue.links.viewRuleReference",{defaultMessage:"View rule reference"}),p=n.i18n.translate("xpack.securitySolution.expandedValue.links.viewEventReference",{defaultMessage:"View event reference"}),m=n.i18n.translate("xpack.securitySolution.expandedValue.links.viewIndicatorReference",{defaultMessage:"View indicator reference"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(4),i=a.n(n),r=a(92),s=a.n(r),o=a(48),l=a(60),c=a(18);const u=Object(n.memo)((({dateRangeFrom:e,dateRangeTo:t,hideSavedQuery:a=!1,indexPattern:r,isLoading:u=!1,isRefreshPaused:d,filterQuery:p,filterManager:m,filters:g,onChangedQuery:b,onSubmitQuery:f,refreshInterval:y,savedQuery:h,onSavedQuery:E,dataTestSubj:v,displayStyle:x,isDisabled:k})=>{const S=Object(n.useCallback)((e=>{null==e.query||s()(e.query,p)||f(e.query)}),[p,f]),j=Object(n.useCallback)((e=>{b&&null!=e.query&&!s()(e.query,p)&&b(e.query)}),[p,b]),O=Object(n.useCallback)((e=>{const{query:t,filters:a,timefilter:n}=e.attributes;f(t,n),m.setFilters(a||[]),E(e)}),[m,f,E]),w=Object(n.useCallback)((()=>{null!=h&&(f({query:"",language:h.attributes.query.language}),m.setFilters([]),E(void 0))}),[m,f,E,h]),T=Object(n.useCallback)((e=>{m.setFilters(e)}),[m]),I=Object(n.useMemo)((()=>[r]),[r]),C=Object(n.useMemo)((()=>new o.TimeHistory(new c.Storage(localStorage))),[]);return i.a.createElement(l.SearchBar,{showSubmitButton:!1,dateRangeFrom:e,dateRangeTo:t,filters:g,indexPatterns:I,isLoading:u,isRefreshPaused:d,query:p,onClearSavedQuery:w,onFiltersUpdated:T,onQueryChange:j,onQuerySubmit:S,onSaved:E,onSavedQueryUpdated:O,refreshInterval:y,showAutoRefreshOnly:!1,showFilterBar:!a,showDatePicker:!1,showQueryInput:!0,showSaveQuery:!0,timeHistory:C,dataTestSubj:v,savedQuery:h,displayStyle:x,isDisabled:k})}));u.displayName="QueryBar"},function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"f",(function(){return r})),a.d(t,"g",(function(){return s})),a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return l})),a.d(t,"d",(function(){return c})),a.d(t,"e",(function(){return u}));var n=a(0);const i=n.i18n.translate("xpack.securitySolution.documentationLinks.ariaLabelEnding",{defaultMessage:"click to open documentation in a new tab"}),r="sec-requirements.html",s=n.i18n.translate("xpack.securitySolution.documentationLinks.solutionRequirements.text",{defaultMessage:"Elastic Security system requirements"}),o="detections-permissions-section.html",l=n.i18n.translate("xpack.securitySolution.documentationLinks.detectionsRequirements.text",{defaultMessage:"Detections prerequisites and requirements"}),c="alerts-ui-monitor.html#ml-job-compatibility",u=n.i18n.translate("xpack.securitySolution.documentationLinks.mlJobCompatibility.text",{defaultMessage:"ML job compatibility"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(6),i=a.n(n);class InvariantError extends Error{constructor(...e){super(...e),i()(this,"name","InvariantError")}}function r(e,t){if(!e)throw new InvariantError(t)}},function(e,t,a){"use strict";a.d(t,"e",(function(){return r})),a.d(t,"c",(function(){return s})),a.d(t,"a",(function(){return o})),a.d(t,"d",(function(){return l})),a.d(t,"b",(function(){return c}));var n=a(131),i=a(113);function r(e){switch(e){case n.b.export:return i.zc;case n.b.duplicate:return i.lc;case n.b.delete:return i.dc;case n.b.enable:return i.uc;case n.b.disable:return i.hc;case n.b.edit:return i.pc}}function s(e,t){switch(e){case n.b.export:return u(t.succeeded,t.total);case n.b.duplicate:return i.mc(t.succeeded);case n.b.delete:return i.ec(t.succeeded);case n.b.enable:return i.vc(t.succeeded);case n.b.disable:return i.ic(t.succeeded)}}function o(e,t){return e.some((e=>e.type===n.a.add_index_patterns||e.type===n.a.set_index_patterns||e.type===n.a.delete_index_patterns))?`${i.qc(t.succeeded)}. ${i.rc}`:i.qc(t.succeeded)}function l(e){switch(e){case n.b.export:return i.wc;case n.b.duplicate:return i.jc;case n.b.delete:return i.bc;case n.b.enable:return i.sc;case n.b.disable:return i.fc;case n.b.edit:return i.nc}}function c(e,t){var a,r;const s=null===(a=t.body)||void 0===a||null===(r=a.attributes)||void 0===r?void 0:r.summary;if(!s)return"";switch(e){case n.b.export:return i.xc(s.failed);case n.b.duplicate:return i.kc(s.failed);case n.b.delete:return i.cc(s.failed);case n.b.enable:return i.tc(s.failed);case n.b.disable:return i.gc(s.failed);case n.b.edit:return i.oc(s.failed)}}const u=(e,t)=>{const a=[i.Ac(e,t)];return t>e&&a.push(i.yc),a.join(" ")}},function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(4),i=a(84),r=a(131),s=a(680);function o(){const e=Object(i.a)();return Object(n.useCallback)((({actionType:t,summary:a,editPayload:n})=>{const i=t===r.b.edit?Object(s.a)(null!=n?n:[],a):Object(s.c)(t,a);e.addSuccess({title:Object(s.e)(t),text:i})}),[e])}},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(4),i=a(131),r=a(238);function s(){const e=Object(r.c)();return Object(n.useCallback)((t=>{const a=null!=e&&e.state.isAllSelected?e.state.rules:[];return(t===i.b.enable?a.filter((e=>!e.enabled)):t===i.b.disable?a.filter((e=>e.enabled)):a).map((e=>e.id))}),[e])}},function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));var n=a(4),i=a(0),r=a(78),s=a(98),o=a(81),l=a(94),c=a(95),u=a(317),d=a(177),p=a(285),m=a(84);const g=()=>{const{indicesExist:e}=Object(l.d)(c.SourcererScopeName.detections),{indexFieldsSearch:t}=Object(p.b)(),a=Object(r.useDispatch)(),{addError:g}=Object(m.a)(),b=Object(n.useRef)(new AbortController),f=Object(n.useMemo)((()=>s.e.defaultDataViewSelector()),[]),y=Object(n.useMemo)((()=>s.e.signalIndexNameSelector()),[]),h=Object(o.a)(y),E=Object(o.a)(f),v=Object(n.useMemo)((()=>!E.title.includes(`${h}`)),[E.title,h]),x=Object(n.useMemo)((()=>!e&&!v),[e,v]),k=Object(n.useCallback)((()=>{null!==h&&(b.current.abort(),(async()=>{b.current=new AbortController;try{const e=await Object(u.b)({body:{patternList:E.title.split(",")},signal:b.current.signal});null!==h&&e.defaultDataView.patternList.includes(h)&&(t({dataViewId:e.defaultDataView.id}),a(d.a.setSourcererDataViews(e)))}catch(e){g(e,{title:i.i18n.translate("xpack.securitySolution.sourcerer.error.title",{defaultMessage:"Error updating Security Data View"}),toastMessage:i.i18n.translate("xpack.securitySolution.sourcerer.error.toastMessage",{defaultMessage:"Refresh the page"})})}})())}),[g,E.title,a,t,h]);return{...x?{pollForSignalIndex:k}:{},signalIndexNeedsInit:v}}},function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return l})),a.d(t,"d",(function(){return c})),a.d(t,"c",(function(){return u}));var n=a(4),i=a.n(n),r=a(0),s=a(35);const o={FORM_TITLE:r.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.applyTimelineTemplate.formTitle",{defaultMessage:"Apply Timeline template"}),TEMPLATE_SELECTOR_LABEL:r.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.applyTimelineTemplate.templateSelectorLabel",{defaultMessage:"Apply Timeline template to selected rules"}),TEMPLATE_SELECTOR_HELP_TEXT:r.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.applyTimelineTemplate.templateSelectorHelpText",{defaultMessage:"Select which Timeline to apply to selected rules when investigating generated alerts."}),TEMPLATE_SELECTOR_PLACEHOLDER:r.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.applyTimelineTemplate.templateSelectorPlaceholder",{defaultMessage:"Search Timeline template"}),TEMPLATE_SELECTOR_DEFAULT_VALUE:r.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.applyTimelineTemplate.templateSelectorDefaultValue",{defaultMessage:"None"}),warningCalloutMessage:e=>i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.applyTimelineTemplate.warningCalloutMessage",defaultMessage:"You're about to apply changes to {rulesCount, plural, one {# selected rule} other {# selected rules}}. If you previously applied Timeline templates to these rules, they will be overwritten or (if you select 'None') reset to none.",values:{rulesCount:e}})},l={FORM_TITLE:r.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.addRuleActions.formTitle",{defaultMessage:"Add rule actions"}),OVERWRITE_LABEL:r.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.addRuleActions.overwriteCheckboxLabel",{defaultMessage:"Overwrite all selected rules actions"}),THROTTLE_LABEL:r.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.addRuleActions.throttleLabel",{defaultMessage:"Actions frequency"}),THROTTLE_HELP_TEXT:r.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.addRuleActions.throttleHelpText",{defaultMessage:"Select when automated actions should be performed if a rule evaluates as true."}),RULE_VARIABLES_DETAIL:r.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.addRuleActions.ruleVariablesDetail",{defaultMessage:"Rule variables may affect only some of the rules you select, based on the rule types (for example, \\u007b\\u007bcontext.rule.threshold\\u007d\\u007d will only display values for threshold rules)."})},c={FORM_TITLE:r.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.setSchedule.formTitle",{defaultMessage:"Update rule schedules"}),INTERVAL_LABEL:r.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.setSchedule.intervalLabel",{defaultMessage:"Runs every"}),INTERVAL_HELP_TEXT:r.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.setSchedule.intervalHelpText",{defaultMessage:"Rules run periodically and detect alerts within the specified time frame."}),LOOKBACK_LABEL:r.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.setSchedule.lookbackLabel",{defaultMessage:"Additional look-back time"}),LOOKBACK_HELP_TEXT:r.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.setSchedule.lookbackHelpText",{defaultMessage:"Adds time to the look-back period to prevent missed alerts."}),warningCalloutMessage:e=>i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.setSchedule.warningCalloutMessage",defaultMessage:"You're about to apply changes to {rulesCount, plural, one {# selected rule} other {# selected rules}}. The changes you make will overwrite the existing rule schedules and additional look-back time (if any).",values:{rulesCount:e}})},u={MODAL_TITLE:e=>i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.exceptionsConfirmation.modalTitle",defaultMessage:"Duplicate {rulesCount, plural, one {the rule} other {rules}} with exceptions?",values:{rulesCount:e}}),MODAL_TEXT:e=>i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.exceptionsConfirmation.modalBody",defaultMessage:"You are duplicating {rulesCount, plural, one {# selected rule} other {# selected rules}}, please select how you would like to duplicate the existing exceptions",values:{rulesCount:e}}),DUPLICATE_EXCEPTIONS_TEXT:e=>i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.exceptionsConfirmation.with",defaultMessage:"Duplicate {rulesCount, plural, one {rule} other {rules}} and their exceptions",values:{rulesCount:e}}),DUPLICATE_WITHOUT_EXCEPTIONS_TEXT:e=>i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.exceptionsConfirmation.without",defaultMessage:"Only duplicate {rulesCount, plural, one {the rule} other {rules}}",values:{rulesCount:e}}),CONTINUE_BUTTON:r.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.exceptionsConfirmation.continueButton",{defaultMessage:"Duplicate"}),CANCEL_BUTTON:r.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.exceptionsConfirmation.cancelButton",{defaultMessage:"Cancel"}),DUPLICATE_TOOLTIP:r.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.exceptionsConfirmation.tooltip",{defaultMessage:" If you duplicate exceptions, then the shared exceptions list will be duplicated by reference and the default rule exception will be copied and created as a new one"})}},function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(206);const i=(e,t)=>{const a=Object(n.g)(e),i=Object(n.b)(e);return"create"===t?i:a}},function(e,t,a){"use strict";a.d(t,"a",(function(){return w}));var n=a(4),i=a.n(n),r=a(7),s=a(32),o=a(35),l=a(245),c=a(132),u=a(66),d=a(91),p=a(175),m=a(187),g=a(13),b=a(77),f=a(372),y=a(891),h=a(279),E=a(290),v=a(721),x=a(576),k=a(517),S=a(190);const j=[c.c.MAC,c.c.WINDOWS,c.c.LINUX].map((e=>({value:e,inputDisplay:h.a[e]}))),O=e=>e.entries.map((e=>(delete e.id,e))),w=Object(n.memo)((({allowSelectOs:e=!0,item:t,policies:a,policiesIsLoading:h,onChange:w,mode:T})=>{const I=Object(d.a)("eventFilters-form"),{http:C,unifiedSearch:M}=Object(b.k)().services,[F,D]=Object(n.useState)(!1),[A,_]=Object(n.useState)(!t.name),[N,R]=Object(n.useState)(""),[P,L]=Object(n.useState)(!1),[B,q]=Object(n.useState)([]),z=Object(g.b)().isPlatinumPlus(),$=Object(n.useMemo)((()=>Object(f.e)(t)),[t]),[V,U]=Object(n.useState)(!Object(x.d)(null==t?void 0:t.tags)),[H,G]=Object(n.useState)(!1),Q=Object(n.useMemo)((()=>["logs-endpoint.events.*"]),[]),[W,{indexPatterns:K}]=Object(p.b)(Q),[Y,J]=Object(n.useState)(!!t.entries.length||!1),X=Object(n.useMemo)((()=>null==t?void 0:t.comments),[]),Z=Object(n.useMemo)((()=>z||"edit"===T&&(!$||V&&$&&F)),[T,$,F,z,V]),ee=Object(n.useMemo)((()=>!A&&!!t.entries.length&&t.entries.some((e=>""!==e.value||e.value.length))),[A,t.entries]),te=Object(n.useCallback)((e=>{const a=e?{...t,...e}:t;O(a),w({item:a,isValid:ee&&Y})}),[Y,t,ee,w]);Object(n.useEffect)((()=>{!F&&t.tags&&U(!Object(x.d)(t.tags))}),[t.tags,F]),Object(n.useEffect)((()=>{if(F)return;const e=t.tags?Object(f.c)({tags:t.tags}):[];if(!e.length)return;const n=a.filter((t=>e.includes(t.id)));q(n)}),[F,t,a]);const ae=Object(n.useMemo)((()=>{const e=t;return e.entries=t.entries.length?t.entries:[{field:"",operator:"included",type:"match",value:""}],O(e),J(!!t.entries.length),e}),[t]),ne=Object(n.useCallback)((e=>{if(!t)return;const a=e.target.value.trim();_(!a),te({name:a}),F||D(!0)}),[t,F,te]),ie=Object(n.useMemo)((()=>{var e;return i.a.createElement(s.EuiFormRow,{label:y.e,fullWidth:!0,isInvalid:A&&P,error:y.d},i.a.createElement(s.EuiFieldText,{"aria-label":y.e,id:"eventFiltersFormInputName",defaultValue:null!==(e=null==t?void 0:t.name)&&void 0!==e?e:"","data-test-subj":I("name-input"),fullWidth:!0,maxLength:256,required:P,onChange:ne,onBlur:()=>!P&&L(!0)}))}),[I,A,ne,P,null==t?void 0:t.name]),re=Object(n.useCallback)((e=>{t&&(F||D(!0),te({description:e.target.value.toString().trim()}))}),[t,F,te]),se=Object(n.useMemo)((()=>{var e;return i.a.createElement(s.EuiFormRow,{label:y.b,fullWidth:!0},i.a.createElement(s.EuiTextArea,{id:"eventFiltersFormInputDescription",defaultValue:null!==(e=null==t?void 0:t.description)&&void 0!==e?e:"",onChange:re,fullWidth:!0,"data-test-subj":I("description-input"),"aria-label":y.b,maxLength:256}))}),[null==t?void 0:t.description,I,re]),oe=Object(n.useMemo)((()=>{var e;return null!=t&&null!==(e=t.os_types)&&void 0!==e&&e.length?t.os_types[0]:c.c.WINDOWS}),[null==t?void 0:t.os_types]),le=Object(n.useCallback)((e=>{t&&(te({os_types:[e],entries:t.entries}),F||D(!0))}),[t,F,te]),ce=Object(n.useMemo)((()=>i.a.createElement(s.EuiFormRow,{label:y.f,fullWidth:!0},i.a.createElement(s.EuiSuperSelect,{name:"os",options:j,fullWidth:!0,valueOfSelected:oe,onChange:le}))),[le,oe]),ue=Object(n.useCallback)((e=>{t&&(R(e),te({comments:[{comment:e}]}),F||D(!0))}),[t,F,te]),de=Object(n.useMemo)((()=>i.a.createElement(k.a,{exceptionItemComments:X,newCommentValue:N,newCommentOnChange:ue})),[X,ue,N]),pe=Object(n.useMemo)((()=>i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiText,{size:"xs"},i.a.createElement("h3",null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.eventFilters.commentsSectionTitle",defaultMessage:"Comments"}))),i.a.createElement(s.EuiSpacer,{size:"xs"}),i.a.createElement(s.EuiText,{size:"s"},i.a.createElement("p",null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.eventFilters.commentsSectionDescription",defaultMessage:"Add a comment to your event filter."}))),i.a.createElement(s.EuiSpacer,{size:"m"}),de)),[de]),me=Object(n.useMemo)((()=>i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiText,{size:"xs"},i.a.createElement("h3",null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.eventFilters.detailsSectionTitle",defaultMessage:"Details"}))),i.a.createElement(s.EuiSpacer,{size:"xs"}),i.a.createElement(s.EuiText,{size:"s"},i.a.createElement("p",null,y.a)),i.a.createElement(s.EuiSpacer,{size:"m"}),ie,se)),[ie,se]),ge=Object(n.useCallback)((e=>{var a,n,i,s,o,l,u,d,p;if(!F&&void 0===e.exceptionItems[0]||Object(r.isEqual)(null===(a=e.exceptionItems[0])||void 0===a?void 0:a.entries,null==t?void 0:t.entries)){var m;const t=(null===(m=e.exceptionItems[0])||void 0===m?void 0:m.entries.map((e=>e.field)))||[""];return G((p=t.reduce(((e,t)=>(t in e?e[t]++:e[t]=1,e)),{}),Object.values(p).some((e=>e>1)))),void(F||D(!0))}const g=void 0!==e.exceptionItems[0]?{...e.exceptionItems[0],name:null!==(n=null==t?void 0:t.name)&&void 0!==n?n:"",description:null!==(i=null==t?void 0:t.description)&&void 0!==i?i:"",comments:null!==(s=null==t?void 0:t.comments)&&void 0!==s?s:[],os_types:null!==(o=null==t?void 0:t.os_types)&&void 0!==o?o:[c.c.WINDOWS],tags:null!==(l=null==t?void 0:t.tags)&&void 0!==l?l:[]}:t,b=void 0!==e.exceptionItems[0]&&!(e.errorExists&&(null===(u=e.exceptionItems[0])||void 0===u||null===(d=u.entries)||void 0===d||!d.length));J(b),te(g),F||D(!0)}),[t,F,te]),be=Object(n.useMemo)((()=>Object(u.getExceptionBuilderComponentLazy)({allowLargeValueLists:!1,httpService:C,autocompleteService:M.autocomplete,exceptionListItems:[ae],listType:E.c,listId:E.a,listNamespaceType:"agnostic",ruleName:y.g,indexPatterns:K,isOrDisabled:!0,isOrHidden:!0,isAndDisabled:!1,isNestedDisabled:!1,dataTestSubj:"alert-exception-builder",idAria:"alert-exception-builder",onChange:ge,listTypeSpecificIndexPatternFilter:S.h,operatorsList:l.b,osTypes:t.os_types})),[M,ge,C,K,t,ae]),fe=Object(n.useMemo)((()=>i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiText,{size:"xs"},i.a.createElement("h3",null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.eventFilters.criteriaSectionTitle",defaultMessage:"Conditions"}))),i.a.createElement(s.EuiSpacer,{size:"xs"}),i.a.createElement(s.EuiText,{size:"s"},i.a.createElement("p",null,e?i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.eventFilters.criteriaSectionDescription.withOs",defaultMessage:"Select an operating system and add conditions."}):i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.eventFilters.criteriaSectionDescription.withoutOs",defaultMessage:"Add conditions."}))),i.a.createElement(s.EuiSpacer,{size:"m"}),e?i.a.createElement(i.a.Fragment,null,ce,i.a.createElement(s.EuiSpacer,null)):null,be)),[e,be,ce]),ye=Object(n.useCallback)((e=>{const t=e.isGlobal?[f.b]:e.selected.map((e=>`${f.a}${e.id}`));e.isGlobal||q(e.selected),te({tags:t}),F||D(!0)}),[te,F,q]),he=Object(n.useMemo)((()=>i.a.createElement(v.a,{selected:B,options:a,isGlobal:$,isLoading:h,isPlatinumPlus:z,onChange:ye,"data-test-subj":"effectedPolicies-select"})),[a,B,$,z,ye,h]);return Object(n.useEffect)((()=>{te()}),[te]),W||!t?i.a.createElement(m.a,{size:"xl"}):i.a.createElement(s.EuiForm,{component:"div"},me,i.a.createElement(s.EuiHorizontalRule,null),fe,H&&i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiSpacer,{size:"xs"}),i.a.createElement(s.EuiText,{color:"subdued",size:"xs","data-test-subj":"duplicate-fields-warning-message"},i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.eventFilters.warningMessage.duplicateFields",defaultMessage:"Using multiples of the same filed values can degrade Endpoint performance and/or create ineffective rules"}))),Z&&i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiHorizontalRule,null),he),i.a.createElement(s.EuiHorizontalRule,null),pe)}));w.displayName="EventFiltersForm"},function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(59),i=a(373);const r=(e,t={})=>{var a;return e.get(i.a,{...t,query:{...t.query,kuery:`${null!=t&&null!==(a=t.query)&&void 0!==a&&a.kuery?`${t.query.kuery} and `:""}${n.PACKAGE_POLICY_SAVED_OBJECT_TYPE}.package.name: endpoint`}})}},function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(4);const i=()=>{const[e,t]=Object(n.useState)(!1),a=Object(n.useCallback)((()=>{t(!0)}),[]);return{closeAddEventFilterModal:Object(n.useCallback)((()=>{t(!1)}),[]),isAddEventFilterModalOpen:e,onAddEventFilterClick:a}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(32),i=a(33);const r=a.n(i)()(n.EuiFlexGroup).withConfig({displayName:"ConditionalFlexGroup",componentId:"sc-jyindk-0"})(["@media only screen and (min-width:1441px){flex-direction:row !important;}"]);r.displayName="ConditionalFlexGroup"},function(e,t,a){"use strict";let n;a.d(t,"a",(function(){return n})),function(e){e.summary="summary"}(n||(n={}))},,function(e,t,a){"use strict";a.d(t,"a",(function(){return X}));var n=a(4),i=a.n(n),r=a(32),s=a(37),o=a(129),l=a(574),c=a(927),u=a(503),d=a(0),p=a(232);const m=["create","edit"],g=(e=!0,t=!0)=>{var a;const i=null!==(a=Object(p.a)().urlParams.show)&&void 0!==a?a:"";return Object(n.useMemo)((()=>!!m.includes(i)&&("create"===i&&t||"edit"===i&&e)),[t,e,i])};var b=a(91),f=a(7);const y=()=>{const e=Object(s.useLocation)(),t=Object(s.useHistory)(),{toUrlParams:a,urlParams:i}=Object(p.a)();return Object(n.useCallback)(((n,r=!1)=>{t.push({...e,search:a(r?n:Object(f.pickBy)({...i,...n},(e=>void 0!==e)))})}),[i,t,e,a])};var h=a(563),E=a(77),v=a(314),x=a(685),k=a(116),S=a(372),j=a(206);const O=Object.freeze({flyoutEditTitle:d.i18n.translate("xpack.securitySolution.artifactListPage.flyoutEditTitle",{defaultMessage:"Add artifact"}),flyoutCreateTitle:d.i18n.translate("xpack.securitySolution.artifactListPage.flyoutCreateTitle",{defaultMessage:"Create artifact"}),flyoutCancelButtonLabel:d.i18n.translate("xpack.securitySolution.artifactListPage.flyoutCancelButtonLabel",{defaultMessage:"Cancel"}),flyoutCreateSubmitButtonLabel:d.i18n.translate("xpack.securitySolution.artifactListPage.flyoutCreateSubmitButtonLabel",{defaultMessage:"Add"}),flyoutEditSubmitButtonLabel:d.i18n.translate("xpack.securitySolution.artifactListPage.flyoutEditSubmitButtonLabel",{defaultMessage:"Save"}),flyoutDowngradedLicenseTitle:d.i18n.translate("xpack.securitySolution.artifactListPage.expiredLicenseTitle",{defaultMessage:"Expired License"}),flyoutDowngradedLicenseInfo:d.i18n.translate("xpack.securitySolution.artifactListPage.flyoutDowngradedLicenseInfo",{defaultMessage:"Your Kibana license has been downgraded. Future policy configurations will now be globally assigned to all policies."}),flyoutDowngradedLicenseDocsInfo:e=>d.i18n.translate("xpack.securitySolution.artifactListPage.flyoutDowngradedLicenseDocsInfo",{defaultMessage:"For more information, see our documentation."}),flyoutEditItemLoadFailure:e=>d.i18n.translate("xpack.securitySolution.artifactListPage.flyoutEditItemLoadFailure",{defaultMessage:"Failed to retrieve item for edit. Reason: {errorMessage}",values:{errorMessage:e}}),flyoutCreateSubmitSuccess:({name:e})=>d.i18n.translate("xpack.securitySolution.some_page.flyoutCreateSubmitSuccess",{defaultMessage:'"{name}" has been added.',values:{name:e}}),flyoutEditSubmitSuccess:({name:e})=>d.i18n.translate("xpack.securitySolution.artifactListPage.flyoutEditSubmitSuccess",{defaultMessage:'"{name}" has been updated.',values:{name:e}})}),w=(e,t)=>({isValid:!1,item:null!=t?t:Object(v.a)(e)}),T=Object(n.memo)((({apiClient:e,item:t,policies:a,policiesIsLoading:s,FormComponent:l,onSuccess:c,onClose:u,submitHandler:d,labels:m={},"data-test-subj":f,size:v="m"})=>{var T,I;const{docLinks:{links:{securitySolution:C}}}=Object(E.k)().services,M=Object(b.a)(f),F=Object(E.o)(),D=g(),A=y(),{urlParams:_}=Object(p.a)(),N=Object(o.b)(),R=Object(n.useMemo)((()=>({...O,...m})),[m]),[P,L]=Object(n.useState)(!1),[B,q]=Object(n.useState)(void 0),z="edit"===_.show,$=z?"edit":"create",{isLoading:V,mutateAsync:U,error:H}=Object(x.a)(e,$),G=Object(n.useMemo)((()=>d?P:V),[P,V,d]),Q=Object(n.useMemo)((()=>d?B:H),[B,H,d]),{isRefetching:W,error:K,refetch:Y}=Object(j.d)(e,null!==(T=_.itemId)&&void 0!==T?T:"",void 0,{enabled:!1}),[J,X]=Object(n.useState)(w.bind(null,e.listId,t)),Z=((e,t)=>{const a=Object(k.a)().endpointPrivileges;return Object(n.useMemo)((()=>"edit"===t&&!a.canCreateArtifactsByPolicy&&Object(S.d)(e)),[a.canCreateArtifactsByPolicy,e,t])})({tags:null!==(I=J.item.tags)&&void 0!==I?I:[]},$),ee=Object(n.useMemo)((()=>!!t||!!J.item.item_id),[J.item.item_id,t]),te=Object(n.useMemo)((()=>z&&!ee),[ee,z]),ae=Object(n.useCallback)((()=>{G||(A({..._,itemId:void 0,show:void 0},!0),u())}),[G,u,A,_]),ne=Object(n.useCallback)((({item:e,isValid:t})=>{N()&&X({item:e,isValid:t})}),[N]),ie=Object(n.useCallback)((e=>{F.addSuccess(z?R.flyoutEditSubmitSuccess(e):R.flyoutCreateSubmitSuccess(e)),N()&&(A({..._,itemId:void 0,show:void 0},!0),c())}),[z,N,R,c,A,F,_]),re=Object(n.useCallback)((()=>{d?(L(!0),d(J.item,$).then(ie).catch((e=>{N()&&q(e)})).finally((()=>{N()&&L(!1)}))):U(J.item).then(ie)}),[$,J.item,ie,N,U,d]);return Object(n.useEffect)((()=>{!z||ee||K||!te||W||Y().then((({data:t})=>{t&&N()&&X(w(e.listId,t))}))}),[e.listId,K,Y,z,te,W,ee,N]),Object(n.useEffect)((()=>{var e;z&&K&&(F.addWarning(R.flyoutEditItemLoadFailure((null==K||null===(e=K.body)||void 0===e?void 0:e.message)||K.message)),A({itemId:void 0,show:void 0}))}),[K,z,R,A,F,_.itemId]),!D||K?null:i.a.createElement(r.EuiFlyout,{size:v,onClose:ae,"data-test-subj":f},i.a.createElement(r.EuiFlyoutHeader,{hasBorder:!0},i.a.createElement(r.EuiTitle,{size:"m"},i.a.createElement("h2",null,z?R.flyoutEditTitle:R.flyoutCreateTitle))),!te&&Z&&i.a.createElement(r.EuiCallOut,{title:R.flyoutDowngradedLicenseTitle,color:"warning",iconType:"help","data-test-subj":M("expiredLicenseCallout")},R.flyoutDowngradedLicenseInfo," ",R.flyoutDowngradedLicenseDocsInfo(C)),i.a.createElement(r.EuiFlyoutBody,null,te&&i.a.createElement(h.a,{"data-test-subj":M("loader")}),!te&&i.a.createElement(l,{onChange:ne,disabled:G,item:J.item,error:null!=Q?Q:void 0,mode:$,policies:a,policiesIsLoading:s})),!te&&i.a.createElement(r.EuiFlyoutFooter,null,i.a.createElement(r.EuiFlexGroup,{justifyContent:"spaceBetween"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButtonEmpty,{"data-test-subj":M("cancelButton"),onClick:ae,disabled:G},R.flyoutCancelButtonLabel)),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButton,{"data-test-subj":M("submitButton"),fill:!0,disabled:!J.isValid||G,onClick:re,isLoading:G},z?R.flyoutEditSubmitButtonLabel:R.flyoutCreateSubmitButtonLabel)))))}));T.displayName="ArtifactFlyout";var I=a(82),C=a.n(I);const M=Object(n.memo)((e=>{const t=Object(n.useRef)(null),a=i.a.createElement(r.EuiButton,C()({buttonRef:t},e));return Object(n.useEffect)((()=>{t.current&&t.current.focus()}),[]),a}));M.displayName="AutoFocusButton";const F=Object.freeze({deleteActionFailure:(e,t)=>d.i18n.translate("xpack.securitySolution.artifactListPage.deleteActionFailure",{defaultMessage:'Unable to remove "{itemName}". Reason: {errorMessage}',values:{itemName:e,errorMessage:t}}),deleteActionSuccess:e=>d.i18n.translate("xpack.securitySolution.artifactListPage.deleteActionSuccess",{defaultMessage:'"{itemName}" has been removed',values:{itemName:e}})}),D=Object.freeze({deleteModalTitle:e=>d.i18n.translate("xpack.securitySolution.artifactListPage.deleteModalTitle",{defaultMessage:"Delete {itemName}",values:{itemName:e}}),deleteModalImpactTitle:d.i18n.translate("xpack.securitySolution.artifactListPage.deleteModalImpactTitle",{defaultMessage:"Warning"}),deleteModalImpactInfo:e=>d.i18n.translate("xpack.securitySolution.artifactListPage.deleteModalImpactInfo",{defaultMessage:"Deleting this entry will remove it from {count} associated {count, plural, one {policy} other {policies}}.",values:{count:Object(S.e)(e)?d.i18n.translate("xpack.securitySolution.artifactListPage.deleteModalImpactInfoAll",{defaultMessage:"all"}):Object(S.c)(e).length}}),deleteModalConfirmInfo:d.i18n.translate("xpack.securitySolution.artifactListPage.deleteModalConfirmInfo",{defaultMessage:"This action cannot be undone. Are you sure you wish to continue?"}),deleteModalSubmitButtonTitle:d.i18n.translate("xpack.securitySolution.artifactListPage.deleteModalSubmitButtonTitle",{defaultMessage:"Delete"}),deleteModalCancelButtonTitle:d.i18n.translate("xpack.securitySolution.artifactListPage.deleteModalCancelButtonTitle",{defaultMessage:"Cancel"})}),A=Object(n.memo)((({apiClient:e,item:t,onCancel:a,onSuccess:s,"data-test-subj":o,labels:l})=>{const c=Object(b.a)(o),{deleteArtifactItem:u,isLoading:d}=((e,t,a)=>{const i=Object(E.o)(),r=Object(j.c)(e,{onError:e=>{var n;i.addDanger(a.deleteActionFailure(t.name,(null===(n=e.body)||void 0===n?void 0:n.message)||e.message))},onSuccess:e=>{i.addSuccess(a.deleteActionSuccess(e.name))}});return Object(n.useMemo)((()=>({...r,deleteArtifactItem:r.mutateAsync})),[r])})(e,t,l),p=Object(n.useCallback)((()=>{u(t).then((()=>s()))}),[u,t,s]),m=Object(n.useCallback)((()=>{d||a()}),[d,a]);return i.a.createElement(r.EuiModal,{onClose:m,"data-test-subj":o},i.a.createElement(r.EuiModalHeader,{"data-test-subj":c("header")},i.a.createElement(r.EuiModalHeaderTitle,null,l.deleteModalTitle(t.name))),i.a.createElement(r.EuiModalBody,{"data-test-subj":c("body")},i.a.createElement(r.EuiText,null,i.a.createElement(r.EuiCallOut,{"data-test-subj":c("impactCallout"),title:l.deleteModalImpactTitle,color:"danger",iconType:"alert"},i.a.createElement("p",{"data-test-subj":c("impactCalloutInfo")},l.deleteModalImpactInfo(t))),i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement("p",null,l.deleteModalConfirmInfo))),i.a.createElement(r.EuiModalFooter,null,i.a.createElement(r.EuiButtonEmpty,{onClick:m,isDisabled:d,"data-test-subj":c("cancelButton")},l.deleteModalCancelButtonTitle),i.a.createElement(M,{fill:!0,color:"danger",onClick:p,isLoading:d,isDisabled:d,"data-test-subj":c("submitButton")},l.deleteModalSubmitButtonTitle)))}));A.displayName="ArtifactDeleteModal";const _=Object.freeze({pageTitle:d.i18n.translate("xpack.securitySolution.artifactListPage.pageTitle",{defaultMessage:"Artifact"}),pageAboutInfo:d.i18n.translate("xpack.securitySolution.artifactListPage.aboutInfo",{defaultMessage:"A list of artifacts for endpoint"}),pageAddButtonTitle:d.i18n.translate("xpack.securitySolution.artifactListPage.addButtonTitle",{defaultMessage:"Add artifact"}),emptyStateTitle:d.i18n.translate("xpack.securitySolution.artifactListPage.emptyStateTitle",{defaultMessage:"Add your first artifact"}),emptyStateInfo:d.i18n.translate("xpack.securitySolution.artifactListPage.emptyStateInfo",{defaultMessage:"Add an artifact"}),emptyStatePrimaryButtonLabel:d.i18n.translate("xpack.securitySolution.artifactListPage.emptyStatePrimaryButtonLabel",{defaultMessage:"Add"}),searchPlaceholderInfo:d.i18n.translate("xpack.securitySolution.artifactListPage.searchPlaceholderInfo",{defaultMessage:"Search on the fields below: name, description, comments, value"}),getShowingCountLabel:e=>d.i18n.translate("xpack.securitySolution.artifactListPage.showingTotal",{defaultMessage:"Showing {total, plural, one {# artifact} other {# artifacts}}",values:{total:e}}),cardActionEditLabel:d.i18n.translate("xpack.securitySolution.artifactListPage.cardActionEditLabel",{defaultMessage:"Edit artifact"}),cardActionDeleteLabel:d.i18n.translate("xpack.securitySolution.artifactListPage.cardActionDeleteLabel",{defaultMessage:"Delete event filter"}),...O,...D,...F});var N=a(840),R=a(394),P=a(279),L=a(33),B=a.n(L),q=a(647);const z=B()(r.EuiEmptyPrompt).withConfig({displayName:"EmptyPrompt",componentId:"sc-1kgkcft-0"})(["",""],(()=>Object(L.css)(["max-width:100%;"]))),$=Object(n.memo)((({onAdd:e,isAddDisabled:t=!1,backComponent:a,"data-test-subj":n,titleLabel:s,aboutInfo:o,primaryButtonLabel:l,secondaryAboutInfo:c})=>{const u=Object(b.a)(n);return i.a.createElement(q.a,null,i.a.createElement(z,{"data-test-subj":n,iconType:"plusInCircle",title:i.a.createElement("h2",{"data-test-subj":u("title")},s),body:i.a.createElement("div",{"data-test-subj":u("aboutInfo")},o,c?i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiSpacer,{size:"m"}),c):void 0),actions:[i.a.createElement(r.EuiButton,{fill:!0,isDisabled:t,onClick:e,"data-test-subj":u("addButton")},l),...a?[a]:[]]}))}));$.displayName="NoDataEmptyState";var V=a(39),U=a(105),H=a(350),G=a(405);var Q=a(139),W=a(35),K=a(243);const Y=Object(n.memo)((({backButtonLabel:e,backButtonUrl:t,onBackButtonNavigateTo:a,...n})=>{const s=Object(K.a)(...a);return i.a.createElement(r.EuiButtonEmpty,C()({},n,{"data-test-subj":"backToOrigin",size:"s",href:t,onClick:s,textProps:{className:"text"}}),e||i.a.createElement(W.FormattedMessage,{id:"xpack.securitySolution.list.backButton",defaultMessage:"Back"}))}));Y.displayName="BackToExternalAppSecondaryButton";var J=a(537);const X=Object(n.memo)((({apiClient:e,ArtifactFormComponent:t,searchableFields:a=Q.c,labels:d={},secondaryPageInfo:m,onFormSubmit:f,flyoutSize:v,"data-test-subj":x,allowCardEditAction:k=!0,allowCardCreateAction:S=!0,allowCardDeleteAction:O=!0})=>{var w,I;const{state:C}=Object(s.useLocation)(),M=Object(b.a)(x),F=Object(E.o)(),D=Object(o.b)(),L=g(k,S),B=y(),{urlParams:{filter:q,includedPolicies:z}}=Object(p.a)(),{isPageInitializing:W,isFetching:K,data:X,uiPagination:Z,doesDataExist:ee,error:te,refetch:ae}=((e,t)=>{const a=Object(o.b)(),{urlParams:{filter:i,includedPolicies:r}}=Object(p.a)(),{pagination:{page:s,pageSize:l}}=Object(G.b)(),c=((e,t,a)=>Object(n.useMemo)((()=>Object(H.a)({kuery:Object(H.b)(e,t),policies:a?a.split(","):[]})),[t,e,a]))(i,t,r),{data:u,isFetching:d,refetch:m}=Object(V.useQuery)(["does-data-exists",e],(async()=>e.hasData()),{enabled:!0,keepPreviousData:!0,refetchOnWindowFocus:!1}),[g,b]=Object(n.useState)({totalItemCount:0,pageSize:l,pageSizeOptions:[...U.f],pageIndex:s-1}),[f,y]=Object(n.useState)(!0),h=Object(j.e)(e,{page:s,perPage:l,filter:i,policies:r?r.split(","):[]},t),{data:E,isFetching:v,error:x,isSuccess:k}=h;return Object(n.useEffect)((()=>{a()&&f&&!d&&y(!1)}),[d,a,f]),Object(n.useEffect)((()=>{a()&&E&&!v&&k&&b((e=>({...e,pageIndex:E.page-1,pageSize:E.per_page,totalItemCount:E.total})))}),[v,a,k,E]),Object(n.useEffect)((()=>{!a()||v||d||x||"1"!==String(s)||c||!(E&&0===E.total&&u||E&&E.total>0&&!u)||m()}),[m,u,i,r,d,v,a,c,E,x,s]),Object(n.useMemo)((()=>({isPageInitializing:f,doesDataExist:null!=u&&u,uiPagination:g,...h})),[u,f,h,g])})(e,a);Object(n.useEffect)((()=>{var e;!K&&te&&F.addDanger((null==te||null===(e=te.body)||void 0===e?void 0:e.message)||te.message)}),[te,F,K]);const ne=Object(n.useMemo)((()=>{var e;return null!==(e=null==X?void 0:X.data)&&void 0!==e?e:[]}),[null==X?void 0:X.data]),[ie,re]=Object(n.useState)(void 0),[se,oe]=Object(n.useState)(void 0),le=Object(n.useMemo)((()=>({..._,...d})),[d]),ce=(({items:e,onAction:t,cardActionDeleteLabel:a,cardActionEditLabel:i,dataTestSubj:r,allowCardDeleteAction:s=!0,allowCardEditAction:o=!0})=>{const l=Object(b.a)(r),c=Object(E.o)(),{data:d}=Object(R.c)({onError:e=>{c.addDanger(Object(P.b)(e))}}),p=Object(u.f)(null==d?void 0:d.items),m=Object(n.useMemo)((()=>{const n={};for(const c of e){const e=[];o&&e.push({icon:"controlsHorizontal",onClick:()=>{t({type:"edit",item:c})},"data-test-subj":l("cardEditAction"),children:i}),s&&e.push({icon:"trash",onClick:()=>{t({type:"delete",item:c})},"data-test-subj":l("cardDeleteAction"),children:a}),n[c.id]={item:c,policies:p,"data-test-subj":r,actions:e.length>0?e:void 0,hideDescription:!c.description,hideComments:!c.comments.length}}return n}),[e,o,s,p,r,l,i,t,a]);return Object(n.useCallback)((e=>m[e.id]),[m])})({items:ne,onAction:Object(n.useCallback)((({type:e,item:t})=>{switch(e){case"edit":oe(t),B({show:"edit",itemId:t.item_id});break;case"delete":re(t)}}),[B]),cardActionDeleteLabel:le.cardActionDeleteLabel,cardActionEditLabel:le.cardActionEditLabel,dataTestSubj:M("card"),allowCardDeleteAction:O,allowCardEditAction:k}),ue=Object(R.c)({onError:e=>{F.addWarning(Object(P.b)(e))}}),de=function(e){const[t,a]=Object(n.useState)();return Object(n.useEffect)((()=>{e&&e.onBackButtonNavigateTo&&a(e)}),[e]),t}(C),pe=Object(n.useMemo)((()=>{if(de&&de.onBackButtonNavigateTo)return i.a.createElement(Y,de)}),[de]),me=Object(n.useMemo)((()=>{if(de&&de.onBackButtonNavigateTo)return i.a.createElement(J.a,de)}),[de]),ge=Object(n.useCallback)((()=>{B({show:"create"})}),[B]),be=Object(n.useCallback)((({pageIndex:e,pageSize:t})=>{B({page:e+1,pageSize:t}),window.scrollTo({top:0,left:0,behavior:"smooth"})}),[B]),fe=Object(n.useCallback)(((e,t,a)=>{const n=e!==(null!=q?q:"")||t!==(null!=z?z:"");B({filter:""===e.trim()?void 0:e,includedPolicies:""===t.trim()?void 0:t}),a&&!n&&ae()}),[q,z,ae,B]),ye=Object(n.useCallback)((()=>{D()&&(re(void 0),ae())}),[D,ae]),he=Object(n.useCallback)((()=>{re(void 0)}),[]),Ee=Object(n.useCallback)((()=>{oe(void 0),ae()}),[ae]),ve=Object(n.useCallback)((()=>{oe(void 0)}),[]),xe=Object(n.useMemo)((()=>{const e=le.pageAboutInfo?i.a.createElement("span",{"data-test-subj":"header-panel-subtitle"},le.pageAboutInfo):void 0,t=m?i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiSpacer,{size:"m"}),m):void 0;return i.a.createElement(i.a.Fragment,null,e,t)}),[le.pageAboutInfo,m]);return W?i.a.createElement(h.a,{"data-test-subj":M("pageLoader")}):i.a.createElement(l.a,{headerBackComponent:me,hideHeader:!ee,title:le.pageTitle,subtitle:xe,actions:S&&i.a.createElement(r.EuiButton,{fill:!0,iconType:"plusInCircle",isDisabled:L,onClick:ge,"data-test-subj":M("pageAddButton")},le.pageAddButtonTitle),"data-test-subj":M("container")},L&&i.a.createElement(T,{apiClient:e,item:se,onSuccess:Ee,onClose:ve,FormComponent:t,labels:le,size:v,submitHandler:f,policies:(null===(w=ue.data)||void 0===w?void 0:w.items)||[],policiesIsLoading:ue.isLoading,"data-test-subj":M("flyout")}),ie&&i.a.createElement(A,{apiClient:e,item:ie,labels:le,"data-test-subj":M("deleteModal"),onSuccess:ye,onCancel:he}),ee?i.a.createElement(i.a.Fragment,null,i.a.createElement(N.a,{defaultValue:q,onSearch:fe,placeholder:le.searchPlaceholderInfo,hasPolicyFilter:!0,policyList:null===(I=ue.data)||void 0===I?void 0:I.items,defaultIncludedPolicies:z}),i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement(r.EuiText,{color:"subdued",size:"xs","data-test-subj":M("showCount")},le.getShowingCountLabel(Z.totalItemCount)),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(c.a,{items:ne,ItemComponent:u.a,itemComponentProps:ce,onChange:be,error:te,loading:K,pagination:Z,contentClassName:"card-container","data-test-subj":M("list")})):i.a.createElement($,{onAdd:ge,titleLabel:le.emptyStateTitle,aboutInfo:le.emptyStateInfo,primaryButtonLabel:le.emptyStatePrimaryButtonLabel,backComponent:pe,"data-test-subj":M("emptyState"),secondaryAboutInfo:m}))}));X.displayName="ArtifactListPage"},function(e,t,a){"use strict";a.d(t,"a",(function(){return G}));var n=a(32),i=a(4),r=a.n(i),s=a(34),o=a(515),l=a(516);const c=r.a.memo((({contextId:e,eventId:t,isDraggable:a,tlsClientCertificateFingerprintSha1:i,tlsFingerprintsJa3Hash:c,tlsServerCertificateFingerprintSha1:u})=>r.a.createElement(n.EuiFlexGroup,{alignItems:"center","data-test-subj":"fingerprints-group",direction:"column",justifyContent:"center",gutterSize:"none"},null!=c?Object(s.uniq)(c).map((i=>r.a.createElement(n.EuiFlexItem,{grow:!1,key:i},r.a.createElement(l.b,{eventId:t,fieldName:l.a,contextId:e,isDraggable:a,value:i})))):null,null!=i?Object(s.uniq)(i).map((i=>r.a.createElement(n.EuiFlexItem,{grow:!1,key:i},r.a.createElement(o.a,{eventId:t,certificateType:"client",contextId:e,fieldName:o.b,isDraggable:a,value:i})))):null,null!=u?Object(s.uniq)(u).map((i=>r.a.createElement(n.EuiFlexItem,{grow:!1,key:i},r.a.createElement(o.a,{eventId:t,certificateType:"server",contextId:e,fieldName:o.c,isDraggable:a,value:i})))):null)));c.displayName="Fingerprints";var u=a(33),d=a.n(u),p=a(85),m=a(88),g=a(359);const b="questionInCircle",f=e=>{if(null==e)return b;switch(`${e}`.toLowerCase()){case p.m.outbound:case p.m.outgoing:return"arrowUp";case p.m.inbound:case p.m.incoming:case p.m.listening:return"arrowDown";case p.m.external:return"globe";case p.m.internal:return"bullseye";case p.m.unknown:default:return b}},y=r.a.memo((({contextId:e,eventId:t,direction:a,isDraggable:n})=>r.a.createElement(m.c,{contextId:e,eventId:t,field:g.c,iconType:f(a),isDraggable:n,value:a,isAggregatable:!0,fieldType:"keyword"})));y.displayName="DirectionBadge";var h=a(640),E=a(257);const v=d()(n.EuiFlexItem).withConfig({displayName:"EuiFlexItemMarginRight",componentId:"sc-cu0yeq-0"})(["margin-right:3px;"]);v.displayName="EuiFlexItemMarginRight";const x=d()(n.EuiText).withConfig({displayName:"Stats",componentId:"sc-cu0yeq-1"})(["margin:0 5px;"]);x.displayName="Stats";const k=r.a.memo((({bytes:e,communityId:t,contextId:a,direction:i,eventId:o,isDraggable:l,packets:c,protocol:u,transport:d})=>r.a.createElement(n.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none"},null!=i?Object(s.uniq)(i).map((e=>r.a.createElement(v,{grow:!1,key:e},r.a.createElement(y,{contextId:a,direction:e,eventId:o,isDraggable:l})))):null,null!=u?Object(s.uniq)(u).map((e=>r.a.createElement(v,{grow:!1,key:e},r.a.createElement(m.c,{contextId:a,eventId:o,field:g.e,isDraggable:l,value:e,isAggregatable:!0,fieldType:"keyword"})))):null,null!=e?Object(s.uniq)(e).map((e=>isNaN(Number(e))?null:r.a.createElement(v,{grow:!1,key:e},r.a.createElement(m.b,{field:g.a,id:`network-default-draggable-${a}-${o}-${g.a}-${e}`,isDraggable:l,value:e},r.a.createElement(x,{size:"xs"},r.a.createElement("span",null,r.a.createElement(E.a,{value:e}))))))):null,null!=c?Object(s.uniq)(c).map((e=>r.a.createElement(v,{grow:!1,key:e},r.a.createElement(m.b,{field:g.d,id:`network-default-draggable-${a}-${o}-${g.d}-${e}`,isDraggable:l,value:e},r.a.createElement(x,{size:"xs"},r.a.createElement("span",null,`${e} ${h.a}`)))))):null,null!=d?Object(s.uniq)(d).map((e=>r.a.createElement(v,{grow:!1,key:e},r.a.createElement(m.c,{contextId:a,"data-test-subj":"network-transport",eventId:o,field:g.f,isDraggable:l,value:e,isAggregatable:!0,fieldType:"keyword"})))):null,null!=t?Object(s.uniq)(t).map((e=>r.a.createElement(n.EuiFlexItem,{grow:!1,key:e},r.a.createElement(m.c,{contextId:a,eventId:o,field:g.b,isDraggable:l,value:e,isAggregatable:!0,fieldType:"keyword"})))):null)));k.displayName="Network";var S=a(423),j=a(92),O=a.n(j),w=a(306),T=a(470),I=a(258),C=a(260),M=a(474);const F=d.a.span.withConfig({displayName:"IpPortSeparator",componentId:"sc-1a6zx74-0"})(["margin:0 3px;"]);F.displayName="IpPortSeparator";const D=r.a.memo((({contextId:e,eventId:t,isDraggable:a,port:i,portFieldName:s})=>null!=i?r.a.createElement(n.EuiFlexGroup,{gutterSize:"none"},r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(F,{"data-test-subj":"ip-port-separator"},":")),r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(T.a,{contextId:e,"data-test-subj":"port",eventId:t,fieldName:s,isDraggable:a,value:i}))):null));D.displayName="PortWithSeparator";const A=r.a.memo((({contextId:e,eventId:t,ip:a,ipFieldName:i,isDraggable:s,port:o,portFieldName:l})=>r.a.createElement(n.EuiFlexGroup,{gutterSize:"none"},r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(w.c,{contextId:e,"data-test-subj":"ip",eventId:t,fieldName:i,isDraggable:s,value:a})),r.a.createElement(n.EuiFlexItem,null,r.a.createElement(D,{contextId:e,eventId:t,isDraggable:s,port:o,portFieldName:l})))));A.displayName="IpWithPort";const _=d.a.div.withConfig({displayName:"Label",componentId:"sc-1jislg4-0"})(["font-weight:bold;margin-top:2px;"]),N=({destinationIp:e,sourceIp:t,type:a})=>"source"===a&&null!=t&&t.some((e=>!Object(s.isEmpty)(e)))||"destination"===a&&null!=e&&e.some((e=>!Object(s.isEmpty)(e))),R=({destinationPort:e,sourcePort:t,type:a})=>("source"===a&&null!=t?t:"destination"===a&&null!=e?e:[]).filter((e=>null!=e)).map((e=>`${e}`)).filter((e=>!Object(s.isEmpty)(e))),P=r.a.memo((({contextId:e,destinationIp:t,destinationPort:a,eventId:i,isDraggable:o,sourceIp:l,sourcePort:c,type:u})=>{const d="source"===u?l:t,p="source"===u?w.d:w.a,m="source"===u?c:a,g="source"===u?I.c:I.a;if(null==d)return null;const b=null!=m&&d.length===m.length?d.map(((e,t)=>({ip:e,port:null!=m[t]?`${m[t]}`:null}))):d.map((e=>({ip:e,port:null})));return r.a.createElement(n.EuiFlexGroup,{gutterSize:"none"},Object(s.uniqWith)(O.a,b).map((t=>null!=t.ip&&r.a.createElement(n.EuiFlexItem,{grow:!1,key:t.ip},r.a.createElement(A,{contextId:e,"data-test-subj":`${u}-ip-and-port`,eventId:i,ip:t.ip,ipFieldName:p,isDraggable:o,port:t.port,portFieldName:g})))))}));P.displayName="IpAdressesWithPorts";const L=r.a.memo((({contextId:e,destinationGeoContinentName:t,destinationGeoCountryName:a,destinationGeoCountryIsoCode:i,destinationGeoRegionName:s,destinationGeoCityName:o,destinationIp:l,destinationPort:c,eventId:u,isDraggable:d,sourceGeoContinentName:p,sourceGeoCountryName:m,sourceGeoCountryIsoCode:g,sourceGeoRegionName:b,sourceGeoCityName:f,sourceIp:y,sourcePort:h,type:E})=>{const v="source"===E?C.g:C.a;return N({destinationIp:l,sourceIp:y,type:E})||(({destinationPort:e,sourcePort:t,type:a})=>R({destinationPort:e,sourcePort:t,type:a}).length>0)({destinationPort:c,sourcePort:h,type:E})?r.a.createElement(n.EuiBadge,{"data-test-subj":`${E}-ip-badge`,color:"hollow",title:""},r.a.createElement(n.EuiFlexGroup,{alignItems:"center","data-test-subj":`${E}-ip-group`,direction:"column",gutterSize:"xs"},r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(_,null,v)),r.a.createElement(n.EuiFlexItem,{grow:!1},N({destinationIp:l,sourceIp:y,type:E})?r.a.createElement(P,{contextId:e,destinationIp:l,destinationPort:c,eventId:u,isDraggable:d,sourceIp:y,sourcePort:h,type:E}):r.a.createElement(n.EuiFlexGroup,{gutterSize:"none"},R({destinationPort:c,sourcePort:h,type:E}).map(((t,a)=>r.a.createElement(n.EuiFlexItem,{key:`port-${t}-${a}`,grow:!1},r.a.createElement(T.a,{contextId:e,"data-test-subj":"port",eventId:u,fieldName:`${E}.port`,isDraggable:d,value:t})))))),r.a.createElement(n.EuiFlexItem,null,r.a.createElement(M.f,{contextId:e,destinationGeoContinentName:t,destinationGeoCountryName:a,destinationGeoCountryIsoCode:i,destinationGeoRegionName:s,destinationGeoCityName:o,eventId:u,isDraggable:d,sourceGeoContinentName:p,sourceGeoCountryName:m,sourceGeoCountryIsoCode:g,sourceGeoRegionName:b,sourceGeoCityName:f,type:E})))):null}));L.displayName="SourceDestinationIp";const B=r.a.memo((({contextId:e,destinationBytes:t,destinationGeoContinentName:a,destinationGeoCountryName:i,destinationGeoCountryIsoCode:s,destinationGeoRegionName:o,destinationGeoCityName:l,destinationIp:c,destinationPackets:u,destinationPort:d,eventId:p,isDraggable:m,sourceBytes:g,sourceGeoContinentName:b,sourceGeoCountryName:f,sourceGeoCountryIsoCode:y,sourceGeoRegionName:h,sourceGeoCityName:E,sourcePackets:v,sourceIp:x,sourcePort:k})=>r.a.createElement(n.EuiFlexGroup,{justifyContent:"center",gutterSize:"none"},r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(L,{contextId:e,destinationGeoContinentName:a,destinationGeoCountryName:i,destinationGeoCountryIsoCode:s,destinationGeoRegionName:o,destinationGeoCityName:l,destinationIp:c,destinationPort:d,eventId:p,isDraggable:m,sourceGeoContinentName:b,sourceGeoCountryName:f,sourceGeoCountryIsoCode:y,sourceGeoRegionName:h,sourceGeoCityName:E,sourceIp:x,sourcePort:k,type:"source"})),r.a.createElement(S.e,{contextId:e,destinationBytes:t,destinationPackets:u,eventId:p,isDraggable:m,sourceBytes:g,sourcePackets:v}),r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(L,{contextId:e,destinationGeoContinentName:a,destinationGeoCountryName:i,destinationGeoCountryIsoCode:s,destinationGeoRegionName:o,destinationGeoCityName:l,destinationIp:c,destinationPort:d,eventId:p,isDraggable:m,sourceGeoContinentName:b,sourceGeoCountryName:f,sourceGeoCountryIsoCode:y,sourceGeoRegionName:h,sourceGeoCityName:E,sourceIp:x,sourcePort:k,type:"destination"})))));B.displayName="SourceDestinationWithArrows";const q=d()(n.EuiFlexItem).withConfig({displayName:"EuiFlexItemMarginTop",componentId:"sc-loapjb-0"})(["margin-top:3px;"]);q.displayName="EuiFlexItemMarginTop";const z=r.a.memo((({contextId:e,destinationBytes:t,destinationGeoContinentName:a,destinationGeoCountryName:i,destinationGeoCountryIsoCode:s,destinationGeoRegionName:o,destinationGeoCityName:l,destinationIp:c,destinationPackets:u,destinationPort:d,eventId:p,isDraggable:m,networkBytes:g,networkCommunityId:b,networkDirection:f,networkPackets:y,networkProtocol:h,sourceBytes:E,sourceGeoContinentName:v,sourceGeoCountryName:x,sourceGeoCountryIsoCode:S,sourceGeoRegionName:j,sourceGeoCityName:O,sourceIp:w,sourcePackets:T,sourcePort:I,transport:C})=>r.a.createElement(n.EuiFlexGroup,{alignItems:"center",direction:"column",justifyContent:"center",gutterSize:"none"},r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(k,{bytes:g,packets:y,communityId:b,contextId:e,direction:f,eventId:p,isDraggable:m,protocol:h,transport:C})),r.a.createElement(q,{grow:!1},r.a.createElement(B,{contextId:e,destinationBytes:t,destinationGeoContinentName:a,destinationGeoCountryName:i,destinationGeoCountryIsoCode:s,destinationGeoRegionName:o,destinationGeoCityName:l,destinationIp:c,destinationPackets:u,destinationPort:d,eventId:p,isDraggable:m,sourceBytes:E,sourceGeoContinentName:v,sourceGeoCountryName:x,sourceGeoCountryIsoCode:S,sourceGeoRegionName:j,sourceGeoCityName:O,sourceIp:w,sourcePackets:T,sourcePort:I})))));z.displayName="SourceDestination";var $=a(476),V=a(643);const U=d()(n.EuiFlexItem).withConfig({displayName:"EuiFlexItemMarginRight",componentId:"sc-19k371j-0"})(["margin-right:10px;"]);U.displayName="EuiFlexItemMarginRight";const H=r.a.memo((({contextId:e,destinationBytes:t,destinationGeoContinentName:a,destinationGeoCountryName:i,destinationGeoCountryIsoCode:s,destinationGeoRegionName:o,destinationGeoCityName:l,destinationIp:c,destinationPackets:u,destinationPort:d,eventDuration:p,eventId:m,eventEnd:g,eventStart:b,isDraggable:f,networkBytes:y,networkCommunityId:h,networkDirection:E,networkPackets:v,networkProtocol:x,processName:k,sourceBytes:S,sourceGeoContinentName:j,sourceGeoCountryName:O,sourceGeoCountryIsoCode:w,sourceGeoRegionName:T,sourceGeoCityName:I,sourceIp:C,sourcePackets:M,sourcePort:F,transport:D,userName:A})=>r.a.createElement(n.EuiFlexGroup,{"data-test-subj":"netflow-columns",gutterSize:"none",justifyContent:"center",wrap:!0},r.a.createElement(U,{grow:!1},r.a.createElement(V.c,{contextId:e,eventId:m,isDraggable:f,processName:k,userName:A})),r.a.createElement(U,{grow:!1},r.a.createElement($.a,{contextId:e,eventDuration:p,eventId:m,eventEnd:g,eventStart:b,isDraggable:f})),r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(z,{contextId:e,destinationBytes:t,destinationGeoContinentName:a,destinationGeoCountryName:i,destinationGeoCountryIsoCode:s,destinationGeoRegionName:o,destinationGeoCityName:l,destinationIp:c,destinationPackets:u,destinationPort:d,eventId:m,isDraggable:f,networkBytes:y,networkCommunityId:h,networkDirection:E,networkPackets:v,networkProtocol:x,sourceBytes:S,sourceGeoContinentName:j,sourceGeoCountryName:O,sourceGeoCountryIsoCode:w,sourceGeoRegionName:T,sourceGeoCityName:I,sourceIp:C,sourcePackets:M,sourcePort:F,transport:D})))));H.displayName="NetflowColumns";const G=r.a.memo((({contextId:e,destinationBytes:t,destinationGeoContinentName:a,destinationGeoCountryName:i,destinationGeoCountryIsoCode:s,destinationGeoRegionName:o,destinationGeoCityName:l,destinationIp:u,destinationPackets:d,destinationPort:p,eventDuration:m,eventId:g,eventEnd:b,eventStart:f,isDraggable:y,networkBytes:h,networkCommunityId:E,networkDirection:v,networkPackets:x,networkProtocol:k,processName:S,sourceBytes:j,sourceGeoContinentName:O,sourceGeoCountryName:w,sourceGeoCountryIsoCode:T,sourceGeoRegionName:I,sourceGeoCityName:C,sourcePackets:M,sourceIp:F,sourcePort:D,tlsClientCertificateFingerprintSha1:A,tlsFingerprintsJa3Hash:_,tlsServerCertificateFingerprintSha1:N,transport:R,userName:P})=>r.a.createElement(n.EuiFlexGroup,{alignItems:"center","data-test-subj":"netflow-rows",direction:"column",justifyContent:"center",wrap:!0,gutterSize:"none"},r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(H,{contextId:e,destinationBytes:t,destinationGeoContinentName:a,destinationGeoCountryName:i,destinationGeoCountryIsoCode:s,destinationGeoRegionName:o,destinationGeoCityName:l,destinationIp:u,destinationPackets:d,destinationPort:p,eventDuration:m,eventId:g,eventEnd:b,eventStart:f,isDraggable:y,networkBytes:h,networkCommunityId:E,networkDirection:v,networkPackets:x,networkProtocol:k,processName:S,sourceBytes:j,sourceGeoContinentName:O,sourceGeoCountryName:w,sourceGeoCountryIsoCode:T,sourceGeoRegionName:I,sourceGeoCityName:C,sourceIp:F,sourcePackets:M,sourcePort:D,transport:R,userName:P})),r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(c,{contextId:e,eventId:g,isDraggable:y,tlsClientCertificateFingerprintSha1:A,tlsFingerprintsJa3Hash:_,tlsServerCertificateFingerprintSha1:N})))));G.displayName="Netflow"},function(e,t,a){"use strict";a.d(t,"a",(function(){return y}));var n=a(4),i=a.n(n),r=a(38),s=a(237),o=a(264),l=a(78),c=a(104),u=a(106),d=a(102),p=a(12),m=a(34),g=a(196);const b=e=>Object(m.isObject)(e)?JSON.stringify(e):e;var f=a(99);const y=[({data:e,pageSize:t,closeCellPopover:a})=>e&&e.length>0?function({rowIndex:l,columnId:c,Component:u}){const{timelines:d,filterManager:p}=Object(o.d)(),m=Object(r.getPageRowIndex)(l,t),g=Object(n.useMemo)((()=>({data:e[m],fieldName:c})),[m,c]),b=Object(s.c)(g),f=Object(n.useMemo)((()=>d.getHoverActions().getFilterForValueButton),[d]),y=Object(n.useMemo)((()=>({Component:u,field:c,filterManager:p,onFilterAdded:o.c,ownFocus:!1,showTooltip:!1,value:b,onClick:a})),[u,c,p,b]);return m>=e.length?i.a.createElement(i.a.Fragment,null,o.a):i.a.createElement(i.a.Fragment,null,f(y))}:o.a,({data:e,pageSize:t,closeCellPopover:a})=>e&&e.length>0?function({rowIndex:l,columnId:c,Component:u}){const{timelines:d,filterManager:p}=Object(o.d)(),m=Object(r.getPageRowIndex)(l,t),g=Object(n.useMemo)((()=>({data:e[m],fieldName:c})),[m,c]),b=Object(s.c)(g),f=Object(n.useMemo)((()=>d.getHoverActions().getFilterOutValueButton),[d]),y=Object(n.useMemo)((()=>({Component:u,field:c,filterManager:p,onFilterAdded:o.c,ownFocus:!1,showTooltip:!1,value:b,onClick:a})),[u,c,p,b]);return m>=e.length?i.a.createElement(i.a.Fragment,null,o.a):i.a.createElement(i.a.Fragment,null,f(y))}:o.a,({data:e,pageSize:t,closeCellPopover:a})=>e&&e.length>0?function({rowIndex:m,columnId:g,Component:b}){const f=Object(l.useDispatch)(),{timelines:y}=Object(o.d)(),h=Object(r.getPageRowIndex)(m,t),E=Object(n.useMemo)((()=>({data:e[h],fieldName:g})),[h,g]),v=Object(s.c)(E),x=Object(n.useMemo)((()=>y.getHoverActions().getAddToTimelineButton),[y]),k=Object(n.useMemo)((()=>{const e=`${Object(d.h)(g)}-row-${m}-col-${g}`;return v?v.map((t=>({and:[],enabled:!0,excluded:!1,kqlQuery:"",id:`${e}-val-${t}`,name:t,queryMatch:{field:g,value:t,operator:u.d}}))):[{and:[],enabled:!0,kqlQuery:"",id:`${e}`,name:"",excluded:!0,queryMatch:{field:g,value:"",operator:u.b}}]}),[g,m,v]),S=Object(n.useCallback)((()=>{f(Object(p.addProvider)({id:c.d.active,providers:k})),a&&a()}),[k,f]),j=Object(n.useMemo)((()=>({Component:b,dataProvider:k,field:g,ownFocus:!1,showTooltip:!1,onClick:S,timelineType:"default"})),[b,g,k,S]);return h>=e.length?i.a.createElement(i.a.Fragment,null,o.a):i.a.createElement(i.a.Fragment,null,x(j))}:o.a,({data:e,pageSize:t,closeCellPopover:a})=>e&&e.length>0?function({rowIndex:l,columnId:c,Component:u}){const{timelines:d}=Object(o.d)(),p=Object(r.getPageRowIndex)(l,t),m=Object(n.useMemo)((()=>d.getHoverActions().getCopyButton),[d]),g=Object(n.useMemo)((()=>({data:e[p],fieldName:c})),[p,c]),b=Object(s.c)(g),f=Object(n.useMemo)((()=>({Component:u,field:c,isHoverAction:!1,ownFocus:!1,showTooltip:!1,value:b,onClick:a})),[u,c,b]);return p>=e.length?i.a.createElement(i.a.Fragment,null,o.a):i.a.createElement(i.a.Fragment,null,m(f))}:o.a,({data:e,ecsData:t,header:a,scopeId:l,pageSize:c,closeCellPopover:u})=>void 0!==a?function({rowIndex:d,columnId:p,Component:y}){var h;const{pageRowIndex:E,link:v,eventId:x,value:k,values:S,title:j,fieldName:O,fieldFormat:w,fieldType:T,linkValue:I}=(({rowIndex:e,pageSize:t,ecsData:a,columnId:i,header:l,data:c})=>{const u=Object(r.getPageRowIndex)(e,t),d=a[u],p=Object(o.b)(i,null==l?void 0:l.type,null==l?void 0:l.linkField),g=null!=l&&l.linkField?null==l?void 0:l.linkField:null==p?void 0:p.linkField,y=l&&Object(m.getOr)([],null!=g?g:"",d),h=l&&Object(m.get)("_id",d)||"",E=Object(n.useMemo)((()=>({data:c[u],fieldName:i})),[u,i,c]),v=Object(s.c)(E),x=b(Object(m.head)(v)),k=v&&v.length>1?`${null==p?void 0:p.label}: ${x}`:null==p?void 0:p.label;if(void 0!==g&&0===y.length&&void 0!==v){const e=Object(f.getField)(d,g),t=Object(f.getFieldKey)(d,g),a=Object(f.getFieldKey)(d,i),n=Object(o.b)(a,null==l?void 0:l.type,t);return{pageRowIndex:u,link:n,eventId:h,fieldFormat:(null==l?void 0:l.format)||"",fieldName:a,fieldType:(null==l?void 0:l.type)||"",value:b(Object(m.head)(a)),values:v,title:k,linkValue:Object(m.head)(e)}}return{pageRowIndex:u,link:p,eventId:h,fieldFormat:(null==l?void 0:l.format)||"",fieldName:i,fieldType:(null==l?void 0:l.type)||"",value:x,values:v,title:k,linkValue:Object(m.head)(y)}})({rowIndex:d,pageSize:c,ecsData:t,columnId:p,header:a,data:e});return!1===Object(n.useMemo)((()=>{const t=void 0!==v&&S&&!Object(m.isEmpty)(k);return E>=e.length||!0!==t}),[v,E,k,S])?i.a.createElement(g.a,{Component:y,contextId:`expanded-value-${p}-row-${E}-${l}`,eventId:x,fieldFormat:w,isAggregatable:null!==(h=a.aggregatable)&&void 0!==h&&h,fieldName:O,fieldType:T,isButton:!0,isDraggable:!1,value:k,truncate:!1,title:j,linkValue:I,onClick:u}):o.a}:o.a]},function(e,t,a){"use strict";a.d(t,"d",(function(){return $})),a.d(t,"b",(function(){return V})),a.d(t,"j",(function(){return U})),a.d(t,"m",(function(){return H})),a.d(t,"i",(function(){return G})),a.d(t,"h",(function(){return W})),a.d(t,"f",(function(){return K})),a.d(t,"n",(function(){return J})),a.d(t,"c",(function(){return X})),a.d(t,"g",(function(){return Z})),a.d(t,"l",(function(){return ee})),a.d(t,"k",(function(){return te})),a.d(t,"e",(function(){return ne})),a.d(t,"a",(function(){return ie}));var n,i,r=a(32),s=a(135),o=a(945),l=a.n(o),c=a(946),u=a.n(c),d=a(6),p=a.n(d);!function(e){e._ID="_id",e._INDEX="_index",e._SOURCE="_source",e._TYPE="_type",e.STRING="string",e.TEXT="text",e.MATCH_ONLY_TEXT="match_only_text",e.KEYWORD="keyword",e.VERSION="version",e.BOOLEAN="boolean",e.OBJECT="object",e.DATE="date",e.DATE_NANOS="date_nanos",e.DATE_RANGE="date_range",e.GEO_POINT="geo_point",e.GEO_SHAPE="geo_shape",e.FLOAT="float",e.HALF_FLOAT="half_float",e.SCALED_FLOAT="scaled_float",e.DOUBLE="double",e.INTEGER="integer",e.LONG="long",e.SHORT="short",e.UNSIGNED_LONG="unsigned_long",e.AGGREGATE_METRIC_DOUBLE="aggregate_metric_double",e.FLOAT_RANGE="float_range",e.DOUBLE_RANGE="double_range",e.INTEGER_RANGE="integer_range",e.LONG_RANGE="long_range",e.NESTED="nested",e.BYTE="byte",e.IP="ip",e.IP_RANGE="ip_range",e.ATTACHMENT="attachment",e.TOKEN_COUNT="token_count",e.MURMUR3="murmur3",e.HISTOGRAM="histogram"}(n||(n={})),function(e){e._SOURCE="_source",e.ATTACHMENT="attachment",e.BOOLEAN="boolean",e.DATE="date",e.DATE_RANGE="date_range",e.GEO_POINT="geo_point",e.GEO_SHAPE="geo_shape",e.IP="ip",e.IP_RANGE="ip_range",e.MURMUR3="murmur3",e.NUMBER="number",e.NUMBER_RANGE="number_range",e.STRING="string",e.UNKNOWN="unknown",e.CONFLICT="conflict",e.OBJECT="object",e.NESTED="nested",e.HISTOGRAM="histogram",e.MISSING="missing"}(i||(i={}));var m=l()((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};u()(this,e),p()(this,"name",void 0),p()(this,"sortable",void 0),p()(this,"filterable",void 0),p()(this,"esTypes",void 0),this.name=t.name||i.UNKNOWN,this.sortable=t.sortable||!1,this.filterable=t.filterable||!1,this.esTypes=Object.freeze((t.esTypes||[]).slice())})),g=new m({name:i.UNKNOWN}),b=[new m({name:i.STRING,sortable:!0,filterable:!0,esTypes:[n.STRING,n.TEXT,n.MATCH_ONLY_TEXT,n.KEYWORD,n.VERSION,n._TYPE,n._ID]}),new m({name:i.NUMBER,sortable:!0,filterable:!0,esTypes:[n.FLOAT,n.HALF_FLOAT,n.SCALED_FLOAT,n.DOUBLE,n.INTEGER,n.LONG,n.UNSIGNED_LONG,n.SHORT,n.BYTE,n.TOKEN_COUNT,n.AGGREGATE_METRIC_DOUBLE]}),new m({name:i.NUMBER_RANGE,sortable:!0,filterable:!0,esTypes:[n.FLOAT_RANGE,n.DOUBLE_RANGE,n.INTEGER_RANGE,n.LONG_RANGE]}),new m({name:i.DATE,sortable:!0,filterable:!0,esTypes:[n.DATE,n.DATE_NANOS]}),new m({name:i.DATE_RANGE,sortable:!0,filterable:!0,esTypes:[n.DATE_RANGE]}),new m({name:i.IP,sortable:!0,filterable:!0,esTypes:[n.IP]}),new m({name:i.IP_RANGE,sortable:!0,filterable:!0,esTypes:[n.IP_RANGE]}),new m({name:i.BOOLEAN,sortable:!0,filterable:!0,esTypes:[n.BOOLEAN]}),new m({name:i.OBJECT,esTypes:[n.OBJECT]}),new m({name:i.NESTED,esTypes:[n.NESTED]}),new m({name:i.GEO_POINT,esTypes:[n.GEO_POINT]}),new m({name:i.GEO_SHAPE,esTypes:[n.GEO_SHAPE]}),new m({name:i.ATTACHMENT,esTypes:[n.ATTACHMENT]}),new m({name:i.MURMUR3,esTypes:[n.MURMUR3]}),new m({name:i._SOURCE,esTypes:[n._SOURCE]}),new m({name:i.HISTOGRAM,filterable:!0,esTypes:[n.HISTOGRAM]}),new m({name:i.CONFLICT}),g],f=a(34),y=a(4),h=a.n(y),E=a(33),v=a.n(E),x=a(703),k=a(48),S=a(60),j=a(468),O=a(174),w=a(631),T=a(632),I=a(244),C=a(469),M=a(390),F=a(87),D=a(952),A=a.n(D);const _=v()(r.EuiFlexGroup).withConfig({displayName:"ThreatEuiFlexGroupStyles",componentId:"sc-1kubah9-0"})([".euiFlexItem{margin-bottom:0px;}"]),N=v()(r.EuiFlexItem).withConfig({displayName:"SubtechniqueFlexItem",componentId:"sc-1kubah9-1"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeM)),R=v()(r.EuiButtonEmpty).withConfig({displayName:"TechniqueLinkItem",componentId:"sc-1kubah9-2"})([".euiIcon{width:8px;height:8px;}align-self:flex-start;"]),P=({label:e,threat:t})=>{const[n,i]=Object(y.useState)([]),[s,o]=Object(y.useState)([]),[l,c]=Object(y.useState)([]);return Object(y.useEffect)((()=>{!async function(){const e=await a.e(14).then(a.bind(null,1284));c(e.subtechniquesOptions),i(e.techniquesOptions),o(e.tacticsOptions)}()}),[]),h.a.createElement(_,{direction:"column"},t.map(((e,t)=>{const a=s.find((t=>t.id===e.tactic.id));return h.a.createElement(r.EuiFlexItem,{key:`${e.tactic.name}-${t}`},h.a.createElement(r.EuiLink,{"data-test-subj":"threatTacticLink",href:e.tactic.reference,target:"_blank"},null!=a?a.text:`${e.tactic.name} (${e.tactic.id})`),h.a.createElement(r.EuiFlexGroup,{gutterSize:"none",alignItems:"flexStart",direction:"column"},e.technique&&e.technique.map(((e,t)=>{var a;const i=n.find((t=>t.id===e.id));return h.a.createElement(r.EuiFlexItem,{key:null!==(a=null==i?void 0:i.id)&&void 0!==a?a:t},h.a.createElement(R,{"data-test-subj":"threatTechniqueLink",href:e.reference,target:"_blank",iconType:A.a,size:"xs"},null!=i?i.label:`${e.name} (${e.id})`),h.a.createElement(r.EuiFlexGroup,{gutterSize:"none",alignItems:"flexStart",direction:"column"},null!=e.subtechnique&&e.subtechnique.map(((e,t)=>{var a;const n=l.find((t=>t.id===e.id));return h.a.createElement(N,{key:null!==(a=null==n?void 0:n.id)&&void 0!==a?a:t},h.a.createElement(R,{"data-test-subj":"threatSubtechniqueLink",href:e.reference,target:"_blank",iconType:A.a,size:"xs"},null!=n?n.label:`${e.name} (${e.id})`))}))))}))))})),h.a.createElement(r.EuiSpacer,null))},L=v()(r.EuiFlexItem).withConfig({displayName:"NoteDescriptionContainer",componentId:"sc-123zi2b-0"})(["height:105px;overflow-y:hidden;"]),B=e=>!Object(f.isEmpty)(e.join("")),q=v()(r.EuiBadge).withConfig({displayName:"EuiBadgeWrap",componentId:"sc-123zi2b-1"})([".euiBadge__text{white-space:pre-wrap !important;}"]),z=v.a.div.withConfig({displayName:"Query",componentId:"sc-123zi2b-2"})(["white-space:pre-wrap;"]),$=({field:e,filters:t,filterManager:a,query:n,savedId:i,savedQueryName:s,indexPatterns:o,queryLabel:l})=>{let c=[];const u=!Object(f.isEmpty)(i)&&!Object(f.isEmpty)(s);return u&&(c=[...c,{title:h.a.createElement(h.a.Fragment,null,C.r," "),description:h.a.createElement(h.a.Fragment,null,s," ")}]),Object(f.isEmpty)(t)||(a.setFilters(t),c=[...c,{title:h.a.createElement(h.a.Fragment,null,u?C.p:C.g," "),description:h.a.createElement(r.EuiFlexGroup,{wrap:!0,responsive:!1,gutterSize:"xs"},a.getFilters().map(((t,a)=>h.a.createElement(r.EuiFlexItem,{grow:!1,key:`${e}-filter-${a}`},h.a.createElement(q,{color:"hollow"},null!=o?h.a.createElement(S.FilterLabel,{filter:t,valueLabel:Object(k.getDisplayValueFromFilter)(t,[o])}):h.a.createElement(r.EuiLoadingSpinner,{size:"m"}))))))}]),Object(f.isEmpty)(n)||(c=[...c,{title:h.a.createElement(h.a.Fragment,null,u?C.q:null!=l?l:C.n),description:h.a.createElement(z,null,n)}]),c},V=e=>{let t=[];return Object(f.isEmpty)(e.eventCategoryField)||(t=[...t,{title:h.a.createElement(h.a.Fragment,null,C.c),description:h.a.createElement(h.a.Fragment,null,e.eventCategoryField)}]),Object(f.isEmpty)(e.tiebreakerField)||(t=[...t,{title:h.a.createElement(h.a.Fragment,null,C.d),description:h.a.createElement(h.a.Fragment,null,e.tiebreakerField)}]),Object(f.isEmpty)(e.timestampField)||(t=[...t,{title:h.a.createElement(h.a.Fragment,null,C.e),description:h.a.createElement(h.a.Fragment,null,e.timestampField)}]),t},U=({label:e,threat:t})=>t.length>0?[{title:e,description:h.a.createElement(P,{label:e,threat:t})}]:[],H=(e,t,a)=>B(a)?[{title:e,description:h.a.createElement(r.EuiText,{size:"s"},h.a.createElement("ul",null,a.map((e=>Object(f.isEmpty)(e)?null:h.a.createElement("li",{"data-test-subj":"unorderedListArrayDescriptionItem",key:`${t}-${e}`},e)))))}]:[],G=(e,t,a)=>B(a)?[{title:e,description:h.a.createElement(r.EuiFlexGroup,{responsive:!1,gutterSize:"xs",wrap:!0},a.map((e=>Object(f.isEmpty)(e)?null:h.a.createElement(r.EuiFlexItem,{grow:!1,key:`${t}-${e}`},h.a.createElement(q,{"data-test-subj":"stringArrayDescriptionBadgeItem",color:"hollow"},e)))))}]:[],Q=v()(r.EuiFlexItem).withConfig({displayName:"OverrideColumn",componentId:"sc-123zi2b-3"})(["width:125px;max-width:125px;overflow:hidden;text-overflow:ellipsis;"]),W=e=>[{title:w.a,description:h.a.createElement(M.a,{value:e.value})},...e.isMappingChecked?e.mapping.filter((e=>""!==e.field)).map(((e,t)=>({title:0===t?w.d:"",description:h.a.createElement(r.EuiFlexGroup,{alignItems:"center"},h.a.createElement(Q,null,h.a.createElement(r.EuiToolTip,{content:e.field,"data-test-subj":`severityOverrideField${t}`},h.a.createElement(h.a.Fragment,null,`${e.field}:`))),h.a.createElement(Q,null,h.a.createElement(r.EuiToolTip,{content:e.value,"data-test-subj":`severityOverrideValue${t}`},Object(F.a)(e.value))),h.a.createElement(r.EuiFlexItem,{grow:!1},h.a.createElement(r.EuiIcon,{type:"sortRight"})),h.a.createElement(r.EuiFlexItem,null,h.a.createElement(M.a,{"data-test-subj":`severityOverrideSeverity${t}`,value:e.severity})))}))):[]],K=e=>[{title:T.b,description:e.value},...e.isMappingChecked?e.mapping.filter((e=>""!==e.field)).map(((e,t)=>({title:0===t?T.e:"",description:h.a.createElement(r.EuiFlexGroup,{alignItems:"center"},h.a.createElement(Q,null,h.a.createElement(r.EuiToolTip,{content:e.field,"data-test-subj":`riskScoreOverrideField${t}`},h.a.createElement(h.a.Fragment,null,e.field))),h.a.createElement(r.EuiFlexItem,{grow:!1},h.a.createElement(r.EuiIcon,{type:"sortRight"})),h.a.createElement(r.EuiFlexItem,null,s.k))}))):[]],Y=v()(r.EuiLink).withConfig({displayName:"MyRefUrlLink",componentId:"sc-123zi2b-4"})(["word-break:break-word;"]),J=(e,t)=>B(t)?[{title:e,description:h.a.createElement(r.EuiText,{size:"s"},h.a.createElement("ul",null,t.filter((e=>!Object(f.isEmpty)(e))).map(((e,t)=>h.a.createElement("li",{"data-test-subj":"urlsDescriptionReferenceLinkItem",key:`${t}-${e}`},h.a.createElement(Y,{href:e,external:!0,target:"_blank"},e))))))}]:[],X=(e,t)=>""!==t.trim()?[{title:e,description:h.a.createElement(L,null,h.a.createElement("div",{"data-test-subj":"noteDescriptionItem",className:"eui-yScrollWithShadows"},t))}]:[],Z=(e,t)=>{switch(t){case"machine_learning":return[{title:e,description:C.l}];case"query":case"saved_query":return[{title:e,description:C.o}];case"threshold":return[{title:e,description:C.w}];case"eql":return[{title:e,description:C.f}];case"threat_match":return[{title:e,description:C.s}];case"new_terms":return[{title:e,description:C.m}];default:return Object(O.a)(t)}},ee=(e,t)=>[{title:e,description:h.a.createElement(h.a.Fragment,null,Object(f.isEmpty)(t.field[0])?`${C.v} >= ${t.value}`:`${C.u} ${Array.isArray(t.field)?t.field.join(","):t.field} >= ${t.value}`)}],te=(e,t)=>[{title:e,description:t.reduce(((e,t,a,{length:n})=>{const i=t.entries.reduce(((e,t,a,{length:n})=>1===n?`${t.field} ${j.d} ${t.value}`:0===a?`(${t.field} ${j.d} ${t.value})`:`${e} ${j.a} (${t.field} ${j.d} ${t.value})`),"");return 1===n?`${i}`:0===a?`(${i})`:`${e} ${j.e} (${i})`}),"")}],ae=v()(r.EuiText).withConfig({displayName:"FieldTypeText",componentId:"sc-123zi2b-5"})(["font-size:",";font-family:",";display:inline;"],(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.euiCodeFontFamily)),ne=(e,t)=>Object(f.isEmpty)(t)?[]:[{title:e,description:h.a.createElement(r.EuiFlexGrid,{gutterSize:"s"},t.map(((e,a)=>{return h.a.createElement(r.EuiFlexItem,{grow:!1},h.a.createElement(r.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},h.a.createElement(r.EuiFlexItem,{grow:!1},h.a.createElement(x.a,{"data-test-subj":"field-type-icon",type:(n=e.type,s=b.find((function(e){return e.esTypes.includes(n)})),s&&s.name?s.name:i.UNKNOWN),label:e.type})),h.a.createElement(r.EuiFlexItem,{grow:!1},h.a.createElement(ae,{grow:!1,size:"s"},` ${e.name}${a+1!==t.length?", ":""}`))));var n,s})))}],ie=(e,t,a)=>{if(Object(f.isEmpty)(t))return[];const n=h.a.createElement(r.EuiFlexGroup,{responsive:!1,gutterSize:"xs",wrap:!0},t.map((t=>Object(f.isEmpty)(t)?null:h.a.createElement(r.EuiFlexItem,{grow:!1,key:`${e}-${t}`},h.a.createElement(q,{"data-test-subj":"stringArrayDescriptionBadgeItem",color:"hollow"},t)))));return[{title:h.a.createElement(h.a.Fragment,null,e,h.a.createElement(r.EuiBetaBadge,{label:C.b,style:{verticalAlign:"middle",marginLeft:"8px"},size:"s"}),!a.isAtLeast(I.O)&&h.a.createElement(r.EuiToolTip,{position:"top",content:C.a},h.a.createElement(r.EuiIcon,{type:"alert",size:"l",color:"#BD271E",style:{marginLeft:"8px"}}))),description:n}]}},function(e,t,a){"use strict";a.d(t,"c",(function(){return B})),a.d(t,"a",(function(){return q})),a.d(t,"b",(function(){return z}));var n=a(32),i=a(903),r=a(7),s=a(4),o=a.n(s),l=a(610),c=a(33),u=a.n(c),d=a(0),p=a(35),m=a(77),g=a(82),b=a.n(g);const f=({euiFieldProps:e})=>{const{field:{onChange:t,value:a,name:i},fieldState:{error:r}}=Object(l.useController)({name:"label",defaultValue:""}),c=Object(s.useMemo)((()=>!(null==r||!r.message)),[null==r?void 0:r.message]);return o.a.createElement(n.EuiFormRow,{label:d.i18n.translate("xpack.securitySolution.markdown.osquery.labelFieldText",{defaultMessage:"Label"}),error:null==r?void 0:r.message,isInvalid:c,fullWidth:!0},o.a.createElement(n.EuiFieldText,b()({isInvalid:c,onChange:t,value:a,name:i,fullWidth:!0,"data-test-subj":"input"},e)))},y=o.a.memo(f);var h=a(939),E=a.n(h),v=a(511),x=a(509);const k=d.i18n.translate("xpack.securitySolution.markdown.osquery.permissionDenied",{defaultMessage:"Permission denied"}),S=()=>o.a.createElement(n.EuiEmptyPrompt,{iconType:"logoOsquery",title:o.a.createElement("h2",null,k),titleSize:"xs",body:o.a.createElement("p",null,o.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.missingPrivileges",defaultMessage:"To access this page, ask your administrator for {osquery} Kibana privileges.",values:{osquery:o.a.createElement(n.EuiCode,null,"osquery")}}))}),j=u()(n.EuiButton).withConfig({displayName:"StyledEuiButton",componentId:"sc-105ly5j-0"})(["> span > img{margin-block-end:0;}"]),O=({node:e,onSave:t,onCancel:a})=>{var i,c,u;const g=null!=e,{osquery:b,application:{capabilities:{osquery:f}}}=Object(m.k)().services,h=Object(l.useForm)({defaultValues:{label:null==e||null===(i=e.configuration)||void 0===i?void 0:i.label,query:null==e||null===(c=e.configuration)||void 0===c?void 0:c.query,ecs_mapping:null==e||null===(u=e.configuration)||void 0===u?void 0:u.ecs_mapping}}),E=Object(s.useCallback)((e=>{t(`!{osquery${JSON.stringify(Object(r.pickBy)({query:e.query,label:e.label,ecs_mapping:e.ecs_mapping},(e=>!Object(r.isEmpty)(e))))}}`,{block:!0})}),[t]),v=Object(s.useMemo)((()=>!(f.runSavedQueries&&f.readSavedQueries||f.writeLiveQueries)),[f.readSavedQueries,f.runSavedQueries,f.writeLiveQueries]),x=Object(s.useMemo)((()=>{if(null!=b&&b.LiveQueryField){const{LiveQueryField:e}=b;return o.a.createElement(l.FormProvider,h,o.a.createElement(y,null),o.a.createElement(n.EuiSpacer,{size:"m"}),o.a.createElement(e,{formMethods:h}))}return null}),[h,b]);return v?o.a.createElement(S,null):o.a.createElement(o.a.Fragment,null,o.a.createElement(n.EuiModalHeader,null,o.a.createElement(n.EuiModalHeaderTitle,null,g?o.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.editModalTitle",defaultMessage:"Edit query"}):o.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.addModalTitle",defaultMessage:"Add query"}))),o.a.createElement(n.EuiModalBody,null,o.a.createElement(o.a.Fragment,null,x)),o.a.createElement(n.EuiModalFooter,null,o.a.createElement(n.EuiButtonEmpty,{onClick:a},d.i18n.translate("xpack.securitySolution.markdown.osquery.modalCancelButtonLabel",{defaultMessage:"Cancel"})),o.a.createElement(n.EuiButton,{onClick:h.handleSubmit(E),fill:!0},g?o.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.addModalConfirmButtonLabel",defaultMessage:"Add query"}):o.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.editModalConfirmButtonLabel",defaultMessage:"Save changes"}))))},w=o.a.memo(O),T={name:"osquery",button:{label:"Osquery",iconType:"logoOsquery"},helpText:o.a.createElement("div",null,o.a.createElement(n.EuiCodeBlock,{language:"md",fontSize:"l",paddingSize:"s",isCopyable:!0},"!{osquery{options}}"),o.a.createElement(n.EuiSpacer,{size:"s"})),editor:w};var I=a(84),C=a(42),M=a(79),F=a(146),D=a(520),A=a(94),_=a(95),N=a(50),R=a(106),P=a(301),L=a(381);const{uiPlugins:B,parsingPlugins:q,processingPlugins:z}={uiPlugins:Object(n.getDefaultEuiMarkdownUiPlugins)(),parsingPlugins:Object(n.getDefaultEuiMarkdownParsingPlugins)(),processingPlugins:Object(n.getDefaultEuiMarkdownProcessingPlugins)()};B.push(i.b),B.push(T),q.push((function(){const e=this.Parser,t=e.prototype.inlineTokenizers,a=e.prototype.inlineMethods,n="!{insight",i=function(e,t,a){if(!1===t.startsWith(n))return!1;const i=t[n.length];if("{"!==i&&"}"!==i)return!1;if(a)return!0;let r={};if("{"===i){let a="",i=0;for(let e=n.length;e<t.length;e++){const n=t[e];if("{"===n)i++,a+=n;else if("}"===n){if(i--,-1===i)break;a+=n}else a+=n}try{return r=JSON.parse(a),e(t)({type:"insight",...r,providers:JSON.stringify(r.providers)})}catch(t){const a=e.now();this.file.fail(d.i18n.translate("xpack.securitySolution.markdownEditor.plugins.insightConfigError",{values:{err:t},defaultMessage:"Unable to parse insight JSON configuration: {err}"}),{line:a.line,column:a.column+n.length})}}return!1};i.locator=(e,t)=>e.indexOf(n,t),t.insight=i,a.splice(a.indexOf("text"),0,"insight")})),q.push(i.a),q.push((function(){const e=this.Parser,t=e.prototype.blockTokenizers,a=e.prototype.blockMethods;t.osquery=function(e,t,a){if(!1===t.startsWith("!{osquery"))return!1;const n=t[9];if("{"!==n&&"}"!==n)return!1;if(a)return!0;let i="!{osquery",r={};if("{"===n){let a="",n=0;for(let e=9;e<t.length;e++){const i=t[e];if("{"===i)n++,a+=i;else if("}"===i){if(n--,-1===n)break;a+=i}else a+=i}i+=a;try{r=JSON.parse(a)}catch(t){const a=e.now();this.file.fail(`Unable to parse osquery JSON configuration: ${t}`,{line:a.line,column:a.column+9})}}return i+="}",e(i)({type:"osquery",configuration:r})},a.splice(a.indexOf("text"),0,"osquery")})),z[1][1].components.insight=({label:e,description:t,providers:a})=>{const{addError:i}=Object(I.a)();let r=[];try{void 0!==a&&(r=JSON.parse(a))}catch(e){i(e,{title:d.i18n.translate("xpack.securitySolution.markdownEditor.plugins.insightProviderError",{defaultMessage:"Unable to parse insight provider configuration"})})}const{data:l}=Object(s.useContext)(x.a),c=(({providers:e,alertData:t})=>{function a(e,t){const a=e.find((e=>e.field===t));return null!=a&&a.values?a.values[0]:"*"}return Object(s.useMemo)((()=>t?e.map((e=>e.reduce(((e,n,i)=>{const{field:r,value:s,type:o}=n;if(0===i)return{and:[],enabled:!0,id:JSON.stringify(r+s+o),name:r,excluded:!1,kqlQuery:"",type:N.DataProviderType.default,queryMatch:{field:r,value:"parameter"===o?a(t,s):s,operator:R.d}};{const n={and:[],enabled:!0,id:JSON.stringify(r+s+o),name:r,excluded:!1,kqlQuery:"",type:N.DataProviderType.default,queryMatch:{field:r,value:"parameter"===o?a(t,s):s,operator:R.d}};e.and.push(n)}return e}),{}))):e.map((e=>e.reduce(((e,t,a)=>{const{field:n,value:i,type:r}=t;if(0===a)return{and:[],enabled:!0,id:JSON.stringify(n+i+r),name:n,excluded:!1,kqlQuery:"",type:"parameter"===r?N.DataProviderType.template:N.DataProviderType.default,queryMatch:{field:n,value:"parameter"===r?`{${i}}`:i,operator:R.d}};{const t={and:[],enabled:!0,id:JSON.stringify(n+i+r),name:n,excluded:!1,kqlQuery:"",type:"parameter"===r?N.DataProviderType.template:N.DataProviderType.default,queryMatch:{field:n,value:"parameter"===r?`{${i}}`:i,operator:R.d}};e.and.push(t)}return e}),{})))),[t,e])})({providers:r,alertData:l}),{totalCount:u,isQueryLoading:p,oldestTimestamp:g,hasError:b}=(({dataProviders:e})=>{const{uiSettings:t}=Object(m.k)().services,a=Object(s.useMemo)((()=>Object(C.getEsQueryConfig)(t)),[t]),{browserFields:n,selectedPatterns:i,indexPattern:r,dataViewId:o}=Object(A.d)(_.SourcererScopeName.timeline),[l,c]=Object(s.useState)(!1),u=Object(s.useMemo)((()=>{try{if(!1===l)return Object(F.a)({config:a,dataProviders:e,indexPattern:r,browserFields:n,filters:[],kqlQuery:{query:"",language:"kuery"},kqlMode:"filter"})}catch(e){return c(!0),null}}),[n,e,a,l,r]),[d,{events:p,totalCount:g}]=Object(D.a)({dataViewId:o,fields:["*"],filterQuery:null==u?void 0:u.filterQuery,id:M.j.active,indexNames:i,language:"kuery",limit:1,runtimeMappings:{}}),[b]=p,f=b&&b.data&&b.data.find((e=>"@timestamp"===e.field));return{isQueryLoading:d,totalCount:g,oldestTimestamp:f&&f.value&&f.value[0],hasError:l}})({dataProviders:c}),f=Object(s.useMemo)((()=>{if(null!=g)return{kind:"absolute",from:g,to:(new Date).toISOString()};{const{to:e,from:t,fromStr:a,toStr:n}=Object(L.d)();return{kind:"relative",to:e,from:t,fromStr:a,toStr:n}}}),[g]);return p?o.a.createElement(n.EuiLoadingSpinner,{size:"l"}):o.a.createElement(P.a,{asEmptyButton:!1,isDisabled:b,dataProviders:c,timeRange:f,keepDataView:!0,"data-test-subj":"insight-investigate-in-timeline-button"},o.a.createElement(n.EuiIcon,{type:"timeline"}),` ${e} (${u}) - ${t}`)},z[1][1].components.timeline=i.c,z[1][1].components.osquery=({configuration:e})=>{var t;const[a,n]=Object(s.useState)(!1),{agentId:i,alertId:r}=Object(s.useContext)(x.a),l=Object(s.useCallback)((()=>n(!0)),[n]),c=Object(s.useCallback)((()=>n(!1)),[n]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(j,{iconType:E.a,onClick:l},null!==(t=e.label)&&void 0!==t?t:d.i18n.translate("xpack.securitySolution.markdown.osquery.runOsqueryButtonLabel",{defaultMessage:"Run Osquery"})),a&&o.a.createElement(v.a,{defaultValues:{...r?{alertIds:[r]}:{},query:e.query,ecs_mapping:e.ecs_mapping,queryField:!1},agentId:i,onClose:c}))}},,function(e,t,a){"use strict";a.d(t,"a",(function(){return _}));var n=a(4),i=a.n(n),r=a(78),s=a(32),o=a(325),l=a(119),c=a(171),u=a(288);const d=["source.ip","destination.ip"],p=e=>null!=e&&d.includes(e);var m=a(388);const g=(e,t)=>!!p(e.entityName)&&(null==t||e.entityValue===t);var b=a(187),f=a(181),y=a(533),h=a(89),E=a(229),v=a(847);var x=a(120),k=a(816),S=a(85);const j=(e,t,a)=>e===E.NetworkType.details&&null!=t?a===S.f.source?[{fieldName:"source.ip",fieldValue:t}]:a===S.f.destination?[{fieldName:"destination.ip",fieldValue:t}]:[]:[];var O=a(318),w=a(109),T=a(248),I=a(81),C=a(817),M=a(111),F=a(818);const D={sort:{field:"anomaly.severity",direction:"desc"}},A=({startDate:e,endDate:t,skip:a,ip:d,type:S,flowTarget:A})=>{const _=Object(x.a)(),N=Object(r.useDispatch)(),{toggleStatus:R,setToggleStatus:P}=Object(w.a)(`AnomaliesNetwork-${A}`),[L,B]=Object(n.useState)(a||!R);Object(n.useEffect)((()=>{B(a||!R)}),[a,R]);const q=Object(n.useCallback)((e=>{P(e),B(!e)}),[B,P]),{jobIds:z,loading:$}=Object(T.b)(),V=Object(n.useMemo)((()=>M.e.networkAnomaliesJobIdFilterSelector()),[]),U=Object(I.a)((e=>V(e,S))),H=Object(n.useCallback)((e=>{N(M.b.updateNetworkAnomaliesJobIdFilter({jobIds:e,networkType:S}))}),[N,S]),G=Object(n.useMemo)((()=>M.e.networkAnomaliesIntervalSelector()),[]),Q=Object(I.a)((e=>G(e,S))),W=Object(n.useCallback)((e=>{N(M.b.updateNetworkAnomaliesInterval({interval:e,networkType:S}))}),[N,S]),[K,Y]=Object(o.a)({startDate:e,endDate:t,skip:L,criteriaFields:j(S,d,A),jobIds:U.length>0?U:z,aggregationInterval:Q}),J=((e,t)=>null==e?[]:e.anomalies.reduce(((e,a)=>{if(p(a.entityName)&&g(a,t))return[...e,{ip:a.entityValue,type:a.entityName,anomaly:a}];{const n=((e=[],t)=>{const a=e.find((e=>{const[a,n]=Object(m.a)(e);return!!p(a)&&(null==t||n===t)}));if(null!=a){const[e]=Object(m.a)(a);return p(e)?{ip:Object.values(a)[0],type:e}:{ip:Object.values(a)[0],type:"destination.ip"}}return null})(a.influencers,t);return null!=n?[...e,{ip:n.ip,type:n.type,anomaly:a}]:e}}),[]))(Y,d),X=((e,t,a,n)=>{const r=((e,t,a)=>[{name:u.m,field:"ip",sortable:!0,render:(e,t)=>Object(f.b)({rowItem:e,attrName:t.type,idPrefix:`anomalies-network-table-ip-${Object(y.a)(t.anomaly)}`,render:e=>i.a.createElement(h.h,{ip:e,flowTarget:a}),isAggregatable:!0,fieldType:"ip"})},...Object(v.a)(e,t)])(t,a,n);return e===E.NetworkType.details?r.filter((e=>e.name!==u.m)):r})(S,e,t,A),Z={initialPageIndex:0,initialPageSize:10,totalItemCount:J.length,pageSizeOptions:[5,10,20,50],showPerPageOptions:!0};return Object(c.a)(_)?i.a.createElement(O.a,{loading:K||$},i.a.createElement(l.a,{subtitle:`${u.o}: ${Z.totalItemCount.toLocaleString()} ${u.r(Z.totalItemCount)}`,title:u.a,tooltip:u.q,toggleQuery:q,toggleStatus:R,isInspectDisabled:a,headerFilters:i.a.createElement(s.EuiFlexGroup,null,i.a.createElement(s.EuiFlexItem,null,i.a.createElement(F.a,{interval:Q,onChange:W})),i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(C.a,{title:u.l,onSelect:H,selectedJobIds:U,jobIds:z})))}),R&&i.a.createElement(k.a,{"data-test-subj":"network-anomalies-table",columns:X,items:J,pagination:Z,sorting:D}),(K||$)&&i.a.createElement(b.a,{"data-test-subj":"anomalies-network-table-loading-panel",overlay:!0,size:"xl"})):null},_=i.a.memo(A)},function(e,t,a){"use strict";a.d(t,"a",(function(){return m})),a.d(t,"b",(function(){return g}));var n=a(4),i=a.n(n),r=a(68);const s={capabilities:Object(r.getDefaultMlCapabilities)(),isPlatinumOrTrialLicense:!1,mlFeatureEnabledInSpace:!1,upgradeInProgress:!1};var o=a(84),l=a(77),c=a(129);const u=Object(c.d)((async({http:e,signal:t})=>e.fetch("/api/ml/ml_capabilities",{method:"GET",asSystemRequest:!0,signal:t}))),d=a(0).i18n.translate("xpack.securitySolution.components.ml.permissions.errors.machineLearningPermissionsFailureTitle",{defaultMessage:"Machine learning permissions failure"}),p={...s,capabilitiesFetched:!1},m=i.a.createContext(p);m.displayName="MlCapabilitiesContext";const g=i.a.memo((({children:e})=>{const[t,a]=Object(n.useState)(p),r=Object(l.j)(),{addError:s}=Object(o.a)(),{start:g,result:b,error:f}=Object(c.a)(u);return Object(n.useEffect)((()=>{g({http:r})}),[r,g]),Object(n.useEffect)((()=>{b&&a({...b,capabilitiesFetched:!0})}),[b]),Object(n.useEffect)((()=>{f&&s(f,{title:d})}),[s,f]),i.a.createElement(m.Provider,{value:t},e)}));g.displayName="MlCapabilitiesProvider"},function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var n=a(4),i=a.n(n),r=a(34),s=a(1082),o=a(32),l=a(35),c=a(84),u=a(404),d=a(193),p=a(360),m=a(246);const g=i.a.memo((({endpointId:e,hostName:t,casesInfo:a,cancelCallback:r,successCallback:s})=>{const[g,b]=Object(n.useState)(""),[f,y]=Object(n.useState)(!1),h=a.map((e=>e.id)),{loading:E,isolateHost:v}=(({endpointId:e,comment:t,caseIds:a})=>{const[i,r]=Object(n.useState)(!1),{addError:s}=Object(c.a)();return{loading:i,isolateHost:Object(n.useCallback)((async()=>{try{r(!0);const n=await Object(d.b)({endpointId:e,comment:t,caseIds:a});return r(!1),!!n.action}catch(e){return r(!1),s(e.message,{title:u.b}),!1}}),[e,t,a,s])}})({endpointId:e,comment:g,caseIds:h}),x=Object(n.useCallback)((async()=>{const e=await v();y(e),e&&s&&s()}),[v,s]),k=Object(n.useCallback)((()=>r()),[r]),S=Object(n.useCallback)((({comment:e})=>b(e)),[]),j=Object(n.useMemo)((()=>a.length),[a]),O=Object(n.useMemo)((()=>i.a.createElement(m.a,{onClick:k,buttonText:p.c})),[k]),w=Object(n.useMemo)((()=>i.a.createElement(i.a.Fragment,null,i.a.createElement(o.EuiSpacer,{size:"m"}),i.a.createElement(m.c,{hostName:t,onCancel:k,onConfirm:x,onChange:S,comment:g,isLoading:E,messageAppend:i.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.detections.hostIsolation.impactedCases",defaultMessage:"This action will be added to {cases}.",values:{cases:i.a.createElement("b",null,Object(p.a)(j))}})}))),[t,k,x,S,g,E,j]);return f?O:w}));g.displayName="IsolateHost";const b=i.a.memo((({endpointId:e,hostName:t,casesInfo:a,cancelCallback:r,successCallback:s})=>{const[g,b]=Object(n.useState)(""),[f,y]=Object(n.useState)(!1),h=a.map((e=>e.id)),{loading:E,unIsolateHost:v}=(({endpointId:e,comment:t,caseIds:a})=>{const[i,r]=Object(n.useState)(!1),{addError:s}=Object(c.a)();return{loading:i,unIsolateHost:Object(n.useCallback)((async()=>{try{r(!0);const n=await Object(d.c)({endpointId:e,comment:t,caseIds:a});return r(!1),!!n.action}catch(e){return r(!1),s(e.message,{title:u.b}),!1}}),[e,t,a,s])}})({endpointId:e,comment:g,caseIds:h}),x=Object(n.useCallback)((async()=>{const e=await v();y(e),e&&s&&s()}),[s,v]),k=Object(n.useCallback)((()=>r()),[r]),S=Object(n.useCallback)((({comment:e})=>b(e)),[]),j=Object(n.useMemo)((()=>a.length),[a]),O=Object(n.useMemo)((()=>i.a.createElement(m.a,{onClick:k,buttonText:p.c})),[k]),w=Object(n.useMemo)((()=>i.a.createElement(i.a.Fragment,null,i.a.createElement(o.EuiSpacer,{size:"m"}),i.a.createElement(m.e,{hostName:t,onCancel:k,onConfirm:x,onChange:S,comment:g,isLoading:E,messageAppend:i.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.detections.hostIsolation.impactedCases",defaultMessage:"This action will be added to {cases}.",values:{cases:i.a.createElement("b",null,Object(p.a)(j))}})}))),[t,k,x,S,g,E,j]);return f?O:w}));b.displayName="UnisolateHost";const f=i.a.memo((({details:e,cancelCallback:t,successCallback:a,isolateAction:o})=>{const l=Object(n.useMemo)((()=>{var t;const a=null===(t=Object(r.find)({category:"agent",field:"agent.id"},e))||void 0===t?void 0:t.values;return a?a[0]:""}),[e]),c=Object(n.useMemo)((()=>{var t;const a=null===(t=Object(r.find)({category:"host",field:"host.name"},e))||void 0===t?void 0:t.values;return a?a[0]:""}),[e]),u=Object(n.useMemo)((()=>{var t;const a=null===(t=Object(r.find)({category:"_id",field:"_id"},e))||void 0===t?void 0:t.values;return a?a[0]:""}),[e]),{casesInfo:d}=Object(s.a)({alertId:u});return"isolateHost"===o?i.a.createElement(g,{endpointId:l,hostName:c,casesInfo:d,cancelCallback:t,successCallback:a}):i.a.createElement(b,{endpointId:l,hostName:c,casesInfo:d,cancelCallback:t,successCallback:a})}));f.displayName="HostIsolationContent"},function(e,t,a){"use strict";a.d(t,"a",(function(){return j}));var n=a(32),i=a(4),r=a.n(i),s=a(78),o=a(116),l=a(79),c=a(81),u=a(86),d=a(108),p=a(34),m=a(268),g=a.n(m),b=a(100),f=a(210),y=a(242),h=a(553);const E={title:{type:b.a.TEXT,validations:[{validator:b.h.emptyField("")}]},description:{type:b.a.TEXTAREA,validations:[]}};var v=a(154),x=a(179);const k=Object(b.j)({component:b.b}),S=r.a.memo((({closeSaveTimeline:e,initialFocus:t,timelineId:a,showWarning:o})=>{const{startTransaction:d}=Object(v.a)(),m=Object(i.useMemo)((()=>u.b.getTimelineByIdSelector()),[]),{isSaving:S,description:j="",status:O,title:w="",timelineType:T}=Object(c.a)((e=>Object(p.pick)(["isSaving","description","status","title","timelineType"],m(e,a)))),I=g()(S),C=Object(s.useDispatch)(),M=Object(f.a)({timelineId:l.j.active,timelineType:l.n.default}),F=Object(i.useCallback)(((e,t)=>(t&&C(u.a.updateTitleAndDescription({id:a,...e})),Promise.resolve())),[C,a]),D=Object(i.useMemo)((()=>({title:w,description:j})),[w,j]),{form:A}=Object(b.k)({id:"timelineTitleAndDescriptionForm",schema:E,onSubmit:F,options:{stripEmptyFields:!1},defaultValue:D}),{isSubmitted:_,isSubmitting:N,submit:R}=A,P=Object(i.useCallback)((()=>{d({name:x.f.SAVE}),R()}),[R,d]),L=Object(i.useCallback)((()=>{o&&M(),e()}),[e,M,o]),B=Object(i.useMemo)((()=>O===l.l.draft&&o?T===l.n.template?h.e:h.d:h.c),[o,O,T]),q=Object(i.useMemo)((()=>O===l.l.draft?T===l.n.template?h.l:h.k:T===l.n.template?h.h:h.g),[O,T]),z=Object(i.useMemo)((()=>O===l.l.draft&&o?T===l.n.template?h.l:h.k:h.j),[o,O,T]),$=Object(i.useMemo)((()=>h.p(T)),[T]),V=Object(i.useMemo)((()=>`${h.m} (${h.i})`),[]),U=Object(i.useMemo)((()=>({"aria-label":h.n,autoFocus:"title"===t,"data-test-subj":"save-timeline-title",disabled:S,spellCheck:!0,placeholder:T===l.n.template?y.k:y.l})),[t,S,T]),H=Object(i.useMemo)((()=>({"aria-label":h.m,autoFocus:"description"===t,"data-test-subj":"save-timeline-description",disabled:S,placeholder:y.f})),[t,S]);return Object(i.useEffect)((()=>{_&&!S&&I&&e()}),[_,S,I,e]),r.a.createElement(n.EuiModal,{"data-test-subj":"save-timeline-modal",maxWidth:1024,onClose:e},S&&r.a.createElement(n.EuiProgress,{size:"s",color:"primary",position:"absolute","data-test-subj":"progress-bar"}),r.a.createElement(n.EuiModalHeader,{"data-test-subj":"modal-header"},q),r.a.createElement(n.EuiModalBody,null,o&&r.a.createElement(n.EuiFlexItem,{grow:!0},r.a.createElement(n.EuiCallOut,{title:$,color:"danger",iconType:"alert","data-test-subj":"save-timeline-callout"}),r.a.createElement(n.EuiSpacer,{size:"m"})),r.a.createElement(b.c,{form:A},r.a.createElement(n.EuiFlexItem,{grow:!0},r.a.createElement(k,{path:"title",fullWidth:!0,label:h.o,euiFieldProps:U}),r.a.createElement(n.EuiSpacer,null)),r.a.createElement(n.EuiFlexItem,{grow:!0},r.a.createElement(k,{label:V,path:"description",fullWidth:!0,euiFieldProps:H}),r.a.createElement(n.EuiSpacer,null)),r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},r.a.createElement(n.EuiFlexItem,{grow:!1,component:"span"},r.a.createElement(n.EuiButton,{size:"s",fill:!1,onClick:L,isDisabled:S,"data-test-subj":"close-button"},B)),r.a.createElement(n.EuiFlexItem,{grow:!1,component:"span"},r.a.createElement(n.EuiButton,{size:"s",isDisabled:S||N,fill:!0,onClick:P,"data-test-subj":"save-button"},z)))))))}));S.displayName="TimelineTitleAndDescription";const j=r.a.memo((({initialFocus:e,timelineId:t,toolTip:a})=>{const p=Object(s.useDispatch)(),m=Object(i.useMemo)((()=>Object(d.createSelector)(u.b.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.showSaveModal)&&void 0!==t&&t}))),[]),g=Object(c.a)((e=>m(e,t))),[b,f]=Object(i.useState)(!1),y=Object(i.useCallback)((()=>{f(!1),g&&p(u.a.toggleModalSaveTimeline({id:l.j.active,showModalSaveTimeline:!1}))}),[p,f,g]),E=Object(i.useCallback)((()=>{f(!0)}),[f]),{kibanaSecuritySolutionsPrivileges:{crud:v}}=Object(o.a)(),x=Object(i.useMemo)((()=>v?a:h.b),[a,v]),k=Object(i.useMemo)((()=>r.a.createElement(n.EuiButtonIcon,{"aria-label":h.f,isDisabled:!v,onClick:E,iconType:"pencil","data-test-subj":"save-timeline-button-icon"})),[E,v]);return"title"===e&&g||b?r.a.createElement(r.a.Fragment,null,k,r.a.createElement(S,{closeSaveTimeline:y,initialFocus:e,timelineId:t,showWarning:"title"===e&&g})):r.a.createElement(n.EuiToolTip,{content:null!=x?x:"","data-test-subj":"save-timeline-btn-tooltip"},k)}));j.displayName="SaveTimelineButton"},function(e,t,a){"use strict";a.d(t,"a",(function(){return R}));var n=a(4),i=a.n(n),r=a(285),s=a(81),o=a(77),l=a(98),c=a(158),u=a(159),d=a(32),p=a(33),m=a.n(p),g=a(0);const b=g.i18n.translate("xpack.securitySolution.fieldBrowser.createFieldButton",{defaultMessage:"Create field"}),f=m()(d.EuiButton).withConfig({displayName:"StyledButton",componentId:"sc-pj2czg-0"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeM)),y=g.i18n.translate("xpack.securitySolution.fieldBrowser.fieldName",{defaultMessage:"Name"}),h=g.i18n.translate("xpack.securitySolution.fieldBrowser.descriptionLabel",{defaultMessage:"Description"}),E=g.i18n.translate("xpack.securitySolution.fieldBrowser.categoryLabel",{defaultMessage:"Category"}),v=g.i18n.translate("xpack.securitySolution.fieldBrowser.runtimeLabel",{defaultMessage:"Runtime"}),x=g.i18n.translate("xpack.securitySolution.fieldBrowser.runtimeTitle",{defaultMessage:"Runtime Field"}),k=g.i18n.translate("xpack.securitySolution.fieldBrowser.actionsLabel",{defaultMessage:"Actions"}),S=g.i18n.translate("xpack.securitySolution.fieldBrowser.editButton",{defaultMessage:"Edit"}),j=g.i18n.translate("xpack.securitySolution.fieldBrowser.removeButton",{defaultMessage:"Remove"}),O=g.i18n.translate("xpack.securitySolution.fieldBrowser.editButtonDescription",{defaultMessage:"Edit runtime field"}),w=g.i18n.translate("xpack.securitySolution.fieldBrowser.removeButtonDescription",{defaultMessage:"Delete runtime field"});var T=a(182),I=a(87),C=a(203);const M=m()(d.EuiIcon).withConfig({displayName:"TypeIcon",componentId:"sc-bemp51-0"})(["margin:0 4px;position:relative;top:-1px;"]);M.displayName="TypeIcon";const F=m.a.span.withConfig({displayName:"Description",componentId:"sc-bemp51-1"})(["user-select:text;width:",";"],(({width:e})=>e));F.displayName="Description";const D=i.a.memo((({fieldId:e,highlight:t=""})=>i.a.createElement(d.EuiText,{size:"xs"},i.a.createElement(d.EuiHighlight,{"data-test-subj":`field-${e}-name`,search:t},e))));D.displayName="FieldName";const A=({hasFieldEditPermission:e,openFieldEditor:t,openDeleteFieldModal:a})=>Object(n.useCallback)((({highlight:n,onHide:r})=>{const s=e?[{name:S,description:O,type:"icon",icon:"pencil",isPrimary:!0,onClick:({name:e})=>{t(e),r()},available:({isRuntime:e})=>e,"data-test-subj":"actionEditRuntimeField"},{name:j,description:w,type:"icon",icon:"trash",color:"danger",isPrimary:!0,onClick:({name:e})=>{a(e),r()},available:({isRuntime:e})=>e,"data-test-subj":"actionDeleteRuntimeField"}]:[];return[{field:"name",name:y,render:(e,{type:t})=>i.a.createElement(d.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiToolTip,{content:t},i.a.createElement(M,{"data-test-subj":`field-${e}-icon`,type:Object(T.d)(null!=t?t:null)}))),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(D,{fieldId:e,highlight:n}))),sortable:!0,width:"225px"},{field:"description",name:h,render:(e,{name:t,example:a})=>{return i.a.createElement(d.EuiToolTip,{content:e},i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiScreenReaderOnly,{"data-test-subj":"descriptionForScreenReaderOnly"},i.a.createElement("p",null,(n=t,g.i18n.translate("xpack.securitySolution.fieldBrowser.descriptionForScreenReaderOnly",{values:{field:n},defaultMessage:"Description for field {field}:"})))),i.a.createElement(C.a,null,i.a.createElement(F,{width:s.length>0?"335px":"400px","data-test-subj":`field-${t}-description`},`${null!=e?e:Object(I.e)()} ${Object(T.c)(a)}`))));var n},sortable:!0,width:s.length>0?"335px":"400px"},{field:"isRuntime",name:v,render:e=>e?i.a.createElement(d.EuiHealth,{color:"success",title:x}):null,sortable:!0,width:"80px"},{field:"category",name:E,render:(e,{name:t})=>i.a.createElement(d.EuiBadge,{"data-test-subj":`field-${t}-category`},e),sortable:!0,width:"115px"},...s.length>0?[{name:k,actions:s,width:"80px"}]:[]]}),[e,t,a]);var _=a(154),N=a(179);const R=({sourcererScope:e,editorActionsRef:t,removeColumn:a,upsertColumn:d})=>{const[p,m]=Object(n.useState)(null),{startTransaction:g}=Object(_.a)(),{indexFieldsSearch:y}=Object(r.b)(),{dataViewFieldEditor:h,data:{dataViews:E}}=Object(o.k)().services,v=Object(n.useMemo)((()=>l.e.scopeIdSelector()),[]),{missingPatterns:x,selectedDataViewId:k}=Object(s.a)((t=>v(t,e)));Object(n.useEffect)((()=>{null==k||x.length||E.get(k).then((e=>{m(e)}))}),[k,x,E]);const S=Object(n.useCallback)((e=>{if(p&&k){const n=h.openEditor({ctx:{dataView:p},fieldName:e,onSave:async n=>{g({name:N.c.FIELD_SAVED}),await y({dataViewId:k,cleanCache:!0});for(const t of n)e&&e!==t.name&&a(e),d({columnHeaderType:c.a,id:t.name,initialWidth:u.a},0);t&&(t.current=null)}});t&&(t.current={closeEditor:()=>{t.current=null,n()}})}}),[p,k,h,t,y,a,d,g]),j=Object(n.useCallback)((e=>{p&&k&&h.openDeleteModal({ctx:{dataView:p},fieldName:e,onDelete:async()=>{g({name:N.c.FIELD_DELETED}),await y({dataViewId:k}),a(e)}})}),[p,k,h,y,a,g]),O=Object(n.useMemo)((()=>null==h?void 0:h.userPermissions.editIndexPattern()),[null==h?void 0:h.userPermissions]),w=(({isAllowed:e,loading:t,openFieldEditor:a})=>{const r=Object(n.useCallback)((({onHide:e})=>i.a.createElement(f,{iconType:t?"none":"plusInCircle","aria-label":b,"data-test-subj":"create-field",onClick:()=>{a(),e()},isLoading:t},b)),[t,a]);return e?r:void 0})({isAllowed:O&&!!k,loading:!p,openFieldEditor:S});return{createFieldButton:w,getFieldTableColumns:A({hasFieldEditPermission:O,openFieldEditor:S,openDeleteFieldModal:j})}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));var n=a(82),i=a.n(n),r=a(249),s=a.n(r),o=(a(4),a(47)),l=a.n(o),c=a(32),u=a(36),d=["type","label","size","scripted","className"],p={iconType:"questionInCircle",color:"gray"},m={boolean:{iconType:"tokenBoolean"},conflict:{iconType:"alert",color:"euiColorVis9",shape:"square"},date:{iconType:"tokenDate"},date_range:{iconType:"tokenDate"},geo_point:{iconType:"tokenGeo"},geo_shape:{iconType:"tokenGeo"},ip:{iconType:"tokenIP"},ip_range:{iconType:"tokenIP"},match_only_text:{iconType:"tokenString"},murmur3:{iconType:"tokenSearchType"},number:{iconType:"tokenNumber"},number_range:{iconType:"tokenNumber"},histogram:{iconType:"tokenHistogram"},_source:{iconType:"editorCodeBlock",color:"gray"},string:{iconType:"tokenString"},text:{iconType:"tokenString"},keyword:{iconType:"tokenKeyword"},gauge:{iconType:"tokenMetricGauge"},counter:{iconType:"tokenMetricCounter"},nested:{iconType:"tokenNested"},version:{iconType:"tokenTag"}};function g(e){var t=e.type,a=e.label,n=e.size,r=void 0===n?"s":n,o=e.scripted,g=e.className,b=s()(e,d),f=m[t]||p;return Object(u.jsx)(c.EuiToken,i()({},f,{className:l()("kbnFieldIcon",g),"aria-label":a||t,title:a||t,size:r,fill:o?"dark":void 0},b))}a(947);Object.keys({s:"kbnFieldButton--small",m:null})},function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));var n=a(4),i=a.n(n),r=a(32),s=a(7),o=a(0);const l=o.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToRulesTableSelection.addToSelectedRulesDescription",{defaultMessage:"After you create the exception, it is added to the rules you link. "});var c=a(479),u=a(719),d=a(261);const p=Object(n.memo)((({rule:e,linkedRules:t,onRuleLinkChange:a})=>{const s=Object(n.useMemo)((()=>Boolean(t.find((t=>t.id===e.id)))),[t,e.id]),o=Object(n.useCallback)((({target:{checked:n}})=>{const i=n?[...t,e]:null==t?void 0:t.filter((t=>t.id!==e.id));"function"==typeof a&&a(i)}),[t,a,e]);return i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiSwitch,{onChange:o,label:"",checked:s}))}));p.displayName="LinkRuleSwitch";const m=({initiallySelectedRules:e,onRuleSelectionChange:t})=>{const{isLoading:a,searchOptions:m,pagination:g,sortedRulesByLinkedRulesOnTop:b,rulesTableColumnsWithLinkSwitch:f,onTableChange:y,addToSelectedRulesDescription:h}=(({initiallySelectedRules:e,onRuleSelectionChange:t})=>{const{data:{rules:a}={rules:[],total:0},isFetched:r}=Object(u.a)({isInMemorySorting:!0,filterOptions:{filter:"",showCustomRules:!1,showElasticRules:!1,tags:[]},sortingOptions:void 0,pagination:void 0,refetchInterval:!1}),[m,g]=Object(n.useState)({pageIndex:0,initialPageSize:5,showPerPageOptions:!1}),[b,f]=Object(n.useState)(e||[]);Object(n.useEffect)((()=>{t(b)}),[b,t]);const y=Object(n.useMemo)((()=>Object(s.sortBy)(a,[t=>null==e?void 0:e.find((e=>e.id===t.id))])),[e,a]),h=Object(n.useMemo)((()=>[...y.reduce(((e,t)=>{const{tags:a}=t;return a.forEach((t=>e.add(t))),e}),new Set)].map((e=>({value:e,name:e})))),[y]),E=Object(n.useMemo)((()=>({box:{incremental:!0},filters:[{type:"field_value_selection",field:"tags",name:o.i18n.translate("xpack.securitySolution.exceptions.addToRulesTable.tagsFilterLabel",{defaultMessage:"Tags"}),multiSelect:"or",options:h}]})),[h]),v=Object(n.useMemo)((()=>[{field:"link",name:c.a,align:"left","data-test-subj":"ruleActionLinkRuleSwitch",render:(e,t)=>i.a.createElement(p,{rule:t,linkedRules:b,onRuleLinkChange:f})},...Object(d.c)()]),[b]),x=Object(n.useCallback)((({page:{index:e}})=>g({...m,pageIndex:e})),[m]);return{isLoading:!r,pagination:m,searchOptions:E,sortedRulesByLinkedRulesOnTop:y,rulesTableColumnsWithLinkSwitch:v,addToSelectedRulesDescription:l,onTableChange:x}})({initiallySelectedRules:e,onRuleSelectionChange:t});return i.a.createElement(r.EuiPanel,{color:"subdued",borderRadius:"none",hasShadow:!1},i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiText,{size:"s"},h),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(r.EuiInMemoryTable,{tableLayout:"auto",search:m,"data-test-subj":"addExceptionToRulesTable",tableCaption:"Rules table",items:b,loading:a,columns:f,message:a?i.a.createElement(r.EuiLoadingContent,{lines:4,"data-test-subj":"exceptionItemViewerEmptyPrompts-loading"}):void 0,pagination:g,onTableChange:y})))},g=i.a.memo(m);g.displayName="ExceptionsAddToRulesTable"},function(e,t,a){"use strict";a.d(t,"b",(function(){return $})),a.d(t,"a",(function(){return V}));var n=a(4),i=a.n(n),r=a(32),s=a(7),o=a(78),l=a(93),c=a(34),u=a(38),d=a(99),p=a(654),m=a(77),g=a(511),b=a(183),f=a(190),y=a(116),h=a(141),E=a(345),v=a(118),x=a(98),k=a(104),S=a(186),j=a(185),O=a(230),w=a(706),T=a(472),I=a(655),C=a(649),M=a(688),F=a(254),D=a(652),A=a(714),_=a(289),N=a(0),R=a(89),P=a(107),L=a(128),B=a(1);const q=N.i18n.translate("xpack.securitySolution.detectionEngine.alerts.actions.openAlertDetails",{defaultMessage:"Open alert details page"}),z=({ariaLabel:e=v.A,ariaRowindex:t,columnValues:a,disabled:o,ecsRowData:l,onRuleChange:f,scopeId:E,globalQuery:x,timelineQuery:S})=>{var j,O,N,z,$,U,H,G,Q,W,K,Y,J,X,Z,ee,te,ae,ne,ie;const[re,se]=Object(n.useState)(!1),[oe,le]=Object(n.useState)(!1),[ce]=Object(b.a)(),ue=Object(n.useCallback)((()=>{se(!1)}),[]),de=null!=l&&null!==(pe=l.kibana)&&void 0!==pe&&pe.alert?null==l?void 0:l._id:null;var pe;const me=Object(c.get)(0,null==l||null===(j=l.kibana)||void 0===j||null===(O=j.alert)||void 0===O||null===(N=O.rule)||void 0===N?void 0:N.uuid),ge=Object(c.get)(0,null==l||null===(z=l.kibana)||void 0===z||null===($=z.alert)||void 0===$||null===(U=$.rule)||void 0===U?void 0:U.rule_id),be=Object(c.get)(0,null==l||null===(H=l.kibana)||void 0===H||null===(G=H.alert)||void 0===G||null===(Q=G.rule)||void 0===Q?void 0:Q.name),fe=[k.c.alertsOnAlertsPage,k.c.alertsOnRuleDetailsPage].includes(E),{addToCaseActionItems:ye}=Object(A.a)({ecsData:l,onMenuItemClick:ue,isActiveTimelines:Object(d.isActiveTimeline)(null!=E?E:""),ariaLabel:Object(F.d)({ariaRowindex:t,columnValues:a}),isInDetections:fe}),{loading:he,canAccessEndpointManagement:Ee}=Object(y.a)().endpointPrivileges,ve=Object(n.useMemo)((()=>!he&&Ee),[Ee,he]),xe=Object(c.get)(0,null==l||null===(W=l.kibana)||void 0===W||null===(K=W.alert)||void 0===K?void 0:K.workflow_status),ke=Object(n.useMemo)((()=>{var e;return-1!==Object(s.indexOf)(null===(e=l.event)||void 0===e?void 0:e.kind,"event")}),[l]),Se=Object(n.useMemo)((()=>{var e,t;return null===(e=l.agent)||void 0===e||null===(t=e.type)||void 0===t?void 0:t.includes("endpoint")}),[l]),je=Object(n.useMemo)((()=>ke&&Se),[ke,Se]),Oe=Object(n.useMemo)((()=>E===k.c.hostsPageEvents||E===k.c.usersPageEvents),[E]),we=Object(n.useCallback)((()=>{se(!re)}),[re]),Te=Object(n.useCallback)((()=>{se(!1)}),[]),Ie=Object(n.useMemo)((()=>i.a.createElement(r.EuiToolTip,{position:"top",content:v.A},i.a.createElement(r.EuiButtonIcon,{"aria-label":e,"data-test-subj":"timeline-context-menu-button",size:"s",iconType:"boxesHorizontal",onClick:we,isDisabled:o}))),[o,we,e]),Ce=e=>{e.forEach((e=>e.refetch&&e.refetch()))},Me=Object(n.useCallback)((()=>{Object(d.isActiveTimeline)(null!=E?E:"")?(Ce([S]),"alerts"===ce.pageName&&Ce(x)):Ce(x)}),[E,x,S,ce]),Fe=null!==(Y=null===(J=l["kibana.alert.rule.parameters"])||void 0===J?void 0:J.index)&&void 0!==Y?Y:null==l||null===(X=l.signal)||void 0===X||null===(Z=X.rule)||void 0===Z?void 0:Z.index,De=null!==(ee=null===(te=l["kibana.alert.rule.parameters"])||void 0===te?void 0:te.data_view_id)&&void 0!==ee?ee:null==l||null===(ae=l.signal)||void 0===ae||null===(ne=ae.rule)||void 0===ne?void 0:ne.data_view_id,{exceptionFlyoutType:Ae,openAddExceptionFlyout:_e,onAddExceptionCancel:Ne,onAddExceptionConfirm:Re,onAddExceptionTypeClick:Pe}=Object(I.a)({refetch:Me,onRuleChange:f,isActiveTimelines:Object(d.isActiveTimeline)(null!=E?E:"")}),{closeAddEventFilterModal:Le,isAddEventFilterModalOpen:Be,onAddEventFilterClick:qe}=Object(M.a)(),{actionItems:ze}=Object(T.a)({alertStatus:xe,eventId:null==l?void 0:l._id,indexName:null!==(ie=null==l?void 0:l._index)&&void 0!==ie?ie:"",scopeId:E,refetch:Me,closePopover:Te}),$e=Object(n.useCallback)((e=>{Pe(e),Te()}),[Te,Pe]),Ve=Object(n.useCallback)((()=>{qe(),Te()}),[Te,qe]),{exceptionActionItems:Ue}=Object(C.a)({isEndpointAlert:Object(_.a)({ecsData:l}),onAddExceptionTypeClick:$e}),{eventFilterActionItems:He}=Object(D.a)({onAddEventFilterClick:Ve,disabled:!je||!ve||!Oe,tooltipMessage:Oe?void 0:v.d}),Ge=Object(n.useMemo)((()=>{var e;return Object(c.get)(0,null==l||null===(e=l.agent)||void 0===e?void 0:e.id)}),[l]),Qe=Object(n.useCallback)((()=>{le((e=>!e)),se(!1)}),[]),{osqueryActionItems:We}=(({handleClick:e})=>{const t=Object(n.useMemo)((()=>i.a.createElement(p.a,{handleClick:e})),[e]),a=Object(m.k)().services.application.capabilities.osquery;return{osqueryActionItems:null!=a&&a.writeLiveQueries||null!=a&&a.runSavedQueries?[t]:[]}})({handleClick:Qe}),{alertDetailsActionItems:Ke}=(({ruleId:e,closePopover:t,alertId:a})=>{const n=Object(P.a)("alertDetailsPageEnabled"),s=[],{onClick:o}=Object(R.o)()({deepLinkId:B.uc.alerts,path:a?Object(L.b)(a):""});return e&&a&&n&&s.push(i.a.createElement(r.EuiContextMenuItem,{key:"open-alert-details-item","data-test-subj":"open-alert-details-page-menu-item",onClick:o},q)),{alertDetailsActionItems:s}})({alertId:de,closePopover:Te,ruleId:me}),Ye=Object(n.useMemo)((()=>!ke&&me?[...ye,...ze,...Ue,...Ge?We:[],...Ke]:[...ye,...He,...Ge?We:[]]),[ke,me,ye,ze,Ue,Ge,We,Ke,He]);return i.a.createElement(i.a.Fragment,null,Ye.length>0&&i.a.createElement("div",{key:"actions-context-menu"},i.a.createElement(h.l,{textAlign:"center",width:u.DEFAULT_ACTION_BUTTON_WIDTH},i.a.createElement(r.EuiPopover,{id:"singlePanel",button:Ie,isOpen:re,closePopover:Te,panelPaddingSize:"none",anchorPosition:"downLeft",repositionOnScroll:!0},i.a.createElement(r.EuiContextMenuPanel,{size:"s",items:Ye})))),_e&&me&&ge&&null!=be&&null!=(null==l?void 0:l._id)&&i.a.createElement(V,{ruleId:me,ruleRuleId:ge,ruleIndices:Fe,ruleDataViewId:De,ruleName:be,exceptionListType:Ae,eventId:null==l?void 0:l._id,onCancel:Ne,onConfirm:Re,alertStatus:xe}),Be&&null!=l&&i.a.createElement(w.a,{data:l,onCancel:Le}),oe&&Ge&&null!=l&&i.a.createElement(g.a,{agentId:Ge,defaultValues:de?{alertIds:[de]}:void 0,onClose:Qe,ecsData:l}))},$=Object(o.connect)((()=>{const e=x.d.globalQuery(),t=x.d.timelineQueryByIdSelector();return(a,{scopeId:n})=>({globalQuery:e(a),timelineQuery:t(a,n)})}))(i.a.memo(z)),V=({ruleId:e,ruleRuleId:t,ruleIndices:a,ruleDataViewId:r,ruleName:s,exceptionListType:o,eventId:c,onCancel:u,onConfirm:d,alertStatus:p})=>{const{loading:m,signalIndexName:g}=Object(O.a)(),{loading:b,data:y}=Object(S.a)({query:Object(f.a)(c),indexName:g,queryName:j.a.ADD_EXCEPTION_FLYOUT}),h=Object(n.useMemo)((()=>{if(!1===b){const e=null==y?void 0:y.hits.hits[0];if(!e)return;const{_id:t,_index:a,_source:n}=e;return{...n,_id:t,_index:a}}}),[null==y?void 0:y.hits.hits,b]),v=Object(n.useMemo)((()=>{var e,t,n;return null!=h&&null!=(null===(e=h["kibana.alert.rule.parameters"])||void 0===e?void 0:e.index)?Array.isArray(h["kibana.alert.rule.parameters"].index)?h["kibana.alert.rule.parameters"].index:[h["kibana.alert.rule.parameters"].index]:null!=h&&null!=(null==h||null===(t=h.signal)||void 0===t||null===(n=t.rule)||void 0===n?void 0:n.index)?Array.isArray(h.signal.rule.index)?h.signal.rule.index:[h.signal.rule.index]:a}),[h,a]),x=Object(n.useMemo)((()=>{var e;return null!=h&&null!=(null===(e=h["kibana.alert.rule.parameters"])||void 0===e?void 0:e.data_view_id)?h["kibana.alert.rule.parameters"].data_view_id:r}),[h,r]),k=Object(n.useMemo)((()=>null!=h&&null!=h["kibana.alert.rule.parameters"]?[{...h["kibana.alert.rule.parameters"],id:e,rule_id:t,name:s,index:v,data_view_id:x}]:[{id:e,rule_id:t,name:s,index:v,data_view_id:x}]),[h,x,v,e,s,t]),w=b&&m||null==h||null==v&&null==x;return i.a.createElement(E.a,{rules:k,isEndpointItem:o===l.b.ENDPOINT,alertData:h,isAlertDataLoading:w,alertStatus:p,isBulkAction:!1,showAlertCloseOptions:!0,onCancel:u,onConfirm:d})}},function(e,t,a){"use strict";a.d(t,"a",(function(){return k}));var n=a(82),i=a.n(n),r=a(4),s=a.n(r),o=a(35),l=a(32),c=a(11),u=a(685),d=a(686),p=a(117),m=a.n(p),g=a(290);const b=e=>{var t,a,n,i,r,s,o;return null!=e&&null!==(t=e.agent)&&void 0!==t&&null!==(a=t.type)&&void 0!==a&&a.includes("endpoint")?((null==e||null===(n=e.host)||void 0===n||null===(i=n.os)||void 0===i?void 0:i.name)||["windows"]).map((e=>e.toLowerCase())):null!==(r=null==e||null===(s=e.host)||void 0===s||null===(o=s.os)||void 0===o?void 0:o.family)&&void 0!==r?r:["windows"]},f=e=>{var t,a;return{comments:[],description:"",entries:e&&e.event&&e.process?[{field:"event.category",operator:"included",type:"match",value:(null!==(t=e.event.category)&&void 0!==t?t:[])[0]},{field:"process.executable",operator:"included",type:"match",value:(null!==(a=e.process.executable)&&void 0!==a?a:[])[0]}]:[{field:"",operator:"included",type:"match",value:""}],item_id:void 0,list_id:g.a,meta:{temporaryUuid:m.a.v4()},name:"",namespace_type:"agnostic",tags:["policy:all"],type:"simple",os_types:b(e)}};var y=a(77),h=a(394),E=a(279),v=a(418),x=a(0);const k=Object(r.memo)((({onCancel:e,data:t,...a})=>{var n,p;const m=Object(y.o)(),g=Object(y.j)(),{isLoading:b,mutateAsync:k}=Object(u.a)(v.a.getInstance(g),"create"),[S,j]=Object(r.useState)(),[O,w]=Object(r.useState)(!1),{data:{search:T}}=Object(y.k)().services,I=Object(h.c)({perPage:1e3,onError:e=>{m.addWarning(Object(E.b)(e))}}),[C,M]=Object(r.useState)(f(t)),F=Object(r.useMemo)((()=>I.isLoading||I.isRefetching),[I]);Object(r.useEffect)((()=>(t&&(async()=>{var e;if(!t||!t._index)return;const a=await Object(c.lastValueFrom)(T.search({params:{index:t._index,body:{query:{match:{_id:t._id}}}}}));j({...t,host:{...t.host,os:{...(null==t||null===(e=t.host)||void 0===e?void 0:e.os)||{},name:[a.rawResponse.hits.hits[0]._source.host.os.name]}}})})(),()=>{M(f())})),[]);const D=Object(r.useCallback)((()=>{F||b||e()}),[b,F,e]),A=Object(r.useCallback)((()=>k(C,{onSuccess:t=>{var a;m.addSuccess((a=t,x.i18n.translate("xpack.securitySolution.eventFilter.flyoutForm.creationSuccessToastTitle",{defaultMessage:'"{name}" has been added to the event filters list.',values:{name:null==a?void 0:a.name}}))),e()},onError:e=>{m.addError(e,{title:'There was an error creating the new event filter: "{error}"',message:{error:e.message}})}})),[C,e,k,m]),_=Object(r.useMemo)((()=>s.a.createElement(l.EuiButton,{"data-test-subj":"add-exception-confirm-button",fill:!0,disabled:!O||b||!!t&&!S||F,onClick:A,isLoading:F},t?s.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.eventFilters.eventFiltersFlyout.actions.confirm.update.withData",defaultMessage:"Add endpoint event filter"}):s.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.eventFilters.eventFiltersFlyout.actions.confirm.create",defaultMessage:"Add event filter"}))),[t,S,A,O,b,F]),N=Object(r.useCallback)((e=>{e&&(w(e.isValid),M(e.item))}),[]);return s.a.createElement(l.EuiFlyout,i()({size:"l",onClose:D,"data-test-subj":"eventFiltersCreateFlyout"},a),s.a.createElement(l.EuiFlyoutHeader,{hasBorder:!0},s.a.createElement(l.EuiTitle,{size:"m"},s.a.createElement("h2",null,t?s.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.eventFilters.eventFiltersFlyout.title.create.withData",defaultMessage:"Add endpoint event filter"}):s.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.eventFilters.eventFiltersFlyout.subtitle.create",defaultMessage:"Add event filter"}))),t?s.a.createElement(l.EuiTextColor,{color:"subdued"},s.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.eventFilters.eventFiltersFlyout.subtitle.create.withData",defaultMessage:"Endpoint security"})):null),s.a.createElement(l.EuiFlyoutBody,null,s.a.createElement(d.a,{allowSelectOs:!t,error:void 0,disabled:!1,item:C,mode:"create",onChange:N,policies:null!==(n=null==I||null===(p=I.data)||void 0===p?void 0:p.items)&&void 0!==n?n:[],policiesIsLoading:F})),s.a.createElement(l.EuiFlyoutFooter,null,s.a.createElement(l.EuiFlexGroup,{justifyContent:"spaceBetween"},s.a.createElement(l.EuiFlexItem,{grow:!1},s.a.createElement(l.EuiButtonEmpty,{isDisabled:b,"data-test-subj":"cancelExceptionAddButton",onClick:D},s.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.eventFilters.eventFiltersFlyout.actions.cancel",defaultMessage:"Cancel"}))),s.a.createElement(l.EuiFlexItem,{grow:!1},_))))}));k.displayName="EventFiltersFlyout"},function(e,t,a){"use strict";a.d(t,"a",(function(){return N}));var n=a(32),i=a(4),r=a.n(i),s=a(33),o=a.n(s),l=a(855),c=a(1),u=a(119),d=a(211),p=a(124),m=a(114),g=a(186),b=a(185),f=a(127),y=a(339);const h={critical:y.D,high:y.E,medium:y.H,low:y.G},E=({additionalFilters:e=[],from:t,to:a,entityFilter:n})=>({size:0,query:{bool:{filter:[...e,{range:{"@timestamp":{gte:t,lte:a}}},...n?[{term:{[n.field]:n.value}}]:[]]}},aggs:{alertsByStatus:{terms:{field:"kibana.alert.workflow_status"},aggs:{statusBySeverity:{terms:{field:"kibana.alert.severity"}}}}}});var v=a(109),x=a(273),k=a(463),S=a(234),j=a(865),O=a(925),w=a(558),T=a(327),I=a(89),C=a(411);const M=o()(n.EuiFlexItem).withConfig({displayName:"StyledFlexItem",componentId:"sc-3zhuyw-0"})(["padding:0 4px;"]),F=o()(n.EuiFlexItem).withConfig({displayName:"StyledLegendFlexItem",componentId:"sc-3zhuyw-1"})(["padding-left:32px;padding-top:45px;"]),D=[{key:"critical",label:y.D,color:k.b.critical},{key:"high",label:y.E,color:k.b.high},{key:"medium",label:y.H,color:k.b.medium},{key:"low",label:y.G,color:k.b.low}],A="detection-response-alerts-by-status",_={field:"event.kind",value:"signal"},N=({additionalFilters:e,signalIndexName:t,entityFilter:a})=>{var s,o,k,N,R,P,L,B,q;const{toggleStatus:z,setToggleStatus:$}=Object(v.a)(A),{openTimelineWithFilters:V}=Object(C.a)(),{onClick:U,href:H}=Object(I.o)()({deepLinkId:c.uc.alerts}),G=Object(n.useIsWithinMinBreakpoint)("xl"),Q=Object(n.useIsWithinMaxBreakpoint)("s")||G?120:90,W=Object(i.useMemo)((()=>({name:a?y.o:x.k,href:a?void 0:H,onClick:a?()=>V([[a,_]]):U})),[a,H,U,V]),{items:K,isLoading:Y,updatedAt:J}=(({additionalFilters:e,entityFilter:t,queryId:a,signalIndexName:n,skip:r=!1})=>{const{to:s,from:o,deleteQuery:l,setQuery:c}=Object(m.a)(),[u,d]=Object(i.useState)(Date.now()),[p,y]=Object(i.useState)(null),{data:v,loading:x,refetch:k,request:S,response:j,setQuery:O}=Object(g.a)({query:E({from:o,to:s,entityFilter:t,additionalFilters:e}),indexName:n,skip:r,queryName:b.a.BY_STATUS});Object(i.useEffect)((()=>{O(E({from:o,to:s,entityFilter:t,additionalFilters:e}))}),[O,o,s,t,e]),Object(i.useEffect)((()=>{y(null==v?null:(e=>{var t,a,n;const i=null!==(t=null==e||null===(a=e.aggregations)||void 0===a||null===(n=a.alertsByStatus)||void 0===n?void 0:n.buckets)&&void 0!==t?t:[];return 0===i.length?null:i.reduce(((e,t)=>{var a,n;const i=null!==(a=null===(n=t.statusBySeverity)||void 0===n?void 0:n.buckets)&&void 0!==a?a:[];return{...e,[t.key]:{total:t.doc_count,severities:i.map((e=>({key:e.key,value:e.doc_count,label:h[e.key]})))}}}),{})})(v)),d(Date.now())}),[v]);const w=Object(i.useCallback)((()=>{!r&&k&&k()}),[r,k]);return Object(f.b)({deleteQuery:l,inspect:{dsl:[S],response:[j]},refetch:w,setQuery:c,queryId:a,loading:x}),{items:p,isLoading:x,updatedAt:u}})({additionalFilters:e,entityFilter:a,signalIndexName:t,skip:!z,queryId:A}),X=Object(i.useMemo)((()=>D.map((e=>({color:e.color,field:"kibana.alert.severity",value:e.label})))),[]),Z=null!==(s=null==K||null===(o=K.open)||void 0===o?void 0:o.total)&&void 0!==s?s:0,ee=null!==(k=null==K||null===(N=K.acknowledged)||void 0===N?void 0:N.total)&&void 0!==k?k:0,te=null!==(R=null==K||null===(P=K.closed)||void 0===P?void 0:P.total)&&void 0!==R?R:0,ae=Y||null==K?0:Z+ee+te,ne=Object(i.useCallback)((e=>{var t,a;return null!==(t=null===(a=D.find((t=>t.label===e.dataName)))||void 0===a?void 0:a.color)&&void 0!==t?t:w.b}),[]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(d.a,{show:!0,targetClassNames:[p.a]},r.a.createElement(n.EuiPanel,{hasBorder:!0,"data-test-subj":"detection-response-alerts-by-status-panel"},Y&&r.a.createElement(n.EuiProgress,{"data-test-subj":"initialLoadingPanelMatrixOverTime",size:"xs",position:"absolute",color:"accent"}),r.a.createElement(u.a,{id:A,title:a?y.b:y.c,titleSize:"m",subtitle:r.a.createElement(T.a,{isUpdating:Y,updatedAt:J}),inspectMultiple:!0,toggleStatus:z,toggleQuery:$},r.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(I.g,{"data-test-subj":"view-details-button",onClick:W.onClick,href:W.href},W.name)))),z&&r.a.createElement(r.a.Fragment,null,r.a.createElement(n.EuiFlexGroup,{justifyContent:"center",gutterSize:"none"},r.a.createElement(n.EuiFlexItem,{grow:!1},0!==ae&&r.a.createElement(n.EuiText,{className:"eui-textCenter",size:"s"},r.a.createElement(r.a.Fragment,null,r.a.createElement("b",null,r.a.createElement(S.a,{count:ae})),r.a.createElement(r.a.Fragment,null," "),r.a.createElement("small",null,Object(y.a)(ae)))),r.a.createElement(n.EuiSpacer,{size:"l"}),r.a.createElement(n.EuiFlexGroup,{justifyContent:"center"},r.a.createElement(M,{key:"alerts-status-open",grow:!1},r.a.createElement(l.a,{data:null==K||null===(L=K.open)||void 0===L?void 0:L.severities,fillColor:ne,height:Q,label:y.I,title:r.a.createElement(j.a,{count:Z}),totalCount:Z})),r.a.createElement(M,{key:"alerts-status-acknowledged",grow:!1},r.a.createElement(l.a,{data:null==K||null===(B=K.acknowledged)||void 0===B?void 0:B.severities,fillColor:ne,height:Q,label:y.B,title:r.a.createElement(j.a,{count:ee}),totalCount:ee})),r.a.createElement(M,{key:"alerts-status-closed",grow:!1},r.a.createElement(l.a,{data:null==K||null===(q=K.closed)||void 0===q?void 0:q.severities,fillColor:ne,height:Q,label:y.C,title:r.a.createElement(j.a,{count:te}),totalCount:te})))),r.a.createElement(F,{grow:!1},X.length>0&&r.a.createElement(O.a,{legendItems:X}))),r.a.createElement(n.EuiSpacer,{size:"m"})))))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return q}));var n=a(4),i=a.n(n),r=a(32),s=a(0),o=a(99),l=a(78),c=a(42),u=a(90),d=a(114),p=a(77),m=a(146),g=a(98),b=a(112),f=a(86),y=a(255),h=a(33),E=a.n(h),v=a(860),x=a(914),k=a(94),S=a(618);const j=E.a.div.withConfig({displayName:"TopNContainer",componentId:"sc-kt1n4x-0"})(["min-width:600px;"]),O=E()(r.EuiButtonIcon).withConfig({displayName:"CloseButton",componentId:"sc-kt1n4x-1"})(["z-index:999999;position:absolute;right:4px;top:4px;"]),w=E()(r.EuiSuperSelect).withConfig({displayName:"ViewSelect",componentId:"sc-kt1n4x-2"})(["z-index:999999;width:170px;"]),T=E.a.div.withConfig({displayName:"TopNContent",componentId:"sc-kt1n4x-3"})(["margin-top:4px;margin-right:",";.euiPanel{border:none;}"],(({theme:e})=>e.eui.euiSizeXS)),I=({combinedQueries:e,defaultView:t,deleteQuery:a,filters:r,field:s,from:o,indexPattern:l,options:c,paddingSize:u,query:d,showLegend:p,setAbsoluteRangeDatePickerTarget:m,setQuery:g,scopeId:b,to:f,toggleTopN:h})=>{const[E,I]=Object(n.useState)(t),C=Object(n.useCallback)((e=>I(e)),[I]),{selectedPatterns:M,runtimeMappings:F}=Object(k.d)(Object(y.b)({scopeId:b,view:E}));Object(n.useEffect)((()=>{I(t)}),[t]);const D=Object(n.useMemo)((()=>i.a.createElement(w,{"data-test-subj":"view-select",disabled:1===c.length,onChange:C,options:c,valueOfSelected:E})),[C,c,E]),A=Object(n.useMemo)((()=>Object(y.d)({filters:r,tableId:b,view:E})),[r,b,E]);return i.a.createElement(j,{"data-test-subj":"topN-container"},i.a.createElement(O,{"aria-label":S.c,"data-test-subj":"close",iconType:"cross",onClick:h}),i.a.createElement(T,null,"raw"===E||"all"===E?i.a.createElement(v.a,{combinedQueries:e,deleteQuery:a,filters:A,from:o,headerChildren:D,indexPattern:l,indexNames:M,runtimeMappings:F,onlyField:s,paddingSize:u,query:d,queryType:"topN",showLegend:p,setAbsoluteRangeDatePickerTarget:m,setQuery:g,showSpacer:!1,toggleTopN:h,scopeId:b,to:f}):i.a.createElement(x.a,{combinedQueries:e,filters:A,headerChildren:D,onlyField:s,paddingSize:u,query:d,showLegend:p,setAbsoluteRangeDatePickerTarget:m,runtimeMappings:F})))};I.displayName="TopNComponent";const C=i.a.memo(I);var M=a(79);const F=[],D={query:"",language:"kuery"},A=Object(l.connect)((()=>{const e=g.d.globalQuerySelector(),t=g.d.globalFiltersQuerySelector(),a=f.b.getTimelineByIdSelector(),n=g.d.getTimelineSelector(),i=f.b.getKqlFilterQuerySelector();return(r,s)=>{var o,l;const c=null!==(o=a(r,M.j.active))&&void 0!==o?o:b.b,u=null!==(l=c.filters)&&void 0!==l?l:F,d=n(r),{globalFilters:p}=s;return{activeTimelineEventType:c.eventType,activeTimelineFilters:c.activeTab===M.m.query?u:F,activeTimelineFrom:d.timerange.from,activeTimelineKqlQueryExpression:c.activeTab===M.m.query?i(r,M.j.active):null,activeTimelineTo:d.timerange.to,dataProviders:c.activeTab===M.m.query?c.dataProviders:[],globalQuery:e(r),globalFilters:null!=p?p:t(r),kqlMode:c.kqlMode}}})),_=({activeTimelineEventType:e,activeTimelineFilters:t,activeTimelineFrom:a,activeTimelineKqlQueryExpression:r,activeTimelineTo:s,browserFields:l,dataProviders:g,field:b,indexPattern:f,globalFilters:h=F,globalQuery:E=D,kqlMode:v,onFilterAdded:x,paddingSize:k,showLegend:S,scopeId:j,toggleTopN:O,value:w})=>{const{uiSettings:T}=Object(p.k)().services,{from:I,deleteQuery:M,setQuery:A,to:_}=Object(d.a)(!1),N=Object(y.a)(Object(o.isActiveTimeline)(null!=j?j:"")?e:void 0),R=Object(n.useMemo)((()=>{var e;return Object(o.isActiveTimeline)(null!=j?j:"")?null===(e=Object(m.a)({browserFields:l,config:Object(c.getEsQueryConfig)(T),dataProviders:g,filters:t,indexPattern:f,kqlMode:v,kqlQuery:{language:"kuery",query:null!=r?r:""}}))||void 0===e?void 0:e.filterQuery:void 0}),[j,l,T,g,t,f,v,r]),P=Object(n.useMemo)((()=>Object(y.c)(j)?"alert":N[0].value),[N,j]);return i.a.createElement(C,{combinedQueries:R,"data-test-subj":"top-n",defaultView:P,deleteQuery:Object(o.isActiveTimeline)(null!=j?j:"")?void 0:M,field:b,filters:Object(o.isActiveTimeline)(null!=j?j:"")?F:h,from:Object(o.isActiveTimeline)(null!=j?j:"")?a:I,indexPattern:f,options:N,paddingSize:k,query:Object(o.isActiveTimeline)(null!=j?j:"")?D:E,showLegend:S,setAbsoluteRangeDatePickerTarget:Object(o.isActiveTimeline)(null!=j?j:"")?u.a.timeline:u.a.global,setQuery:A,scopeId:j,to:Object(o.isActiveTimeline)(null!=j?j:"")?s:_,toggleTopN:O,onFilterAdded:x,value:w})};_.displayName="StatefulTopNComponent";const N=A(i.a.memo(_));var R=a(95),P=a(709),L=a(462),B=a(617);const q=i.a.memo((({className:e,Component:t,enablePopOver:a,field:l,flush:c,iconSide:u,iconType:d,isExpandable:p,onClick:m,onFilterAdded:g,ownFocus:b,paddingSize:f,showLegend:h,showTooltip:E=!0,showTopN:v,scopeId:x,title:S,value:j,globalFilters:O})=>{const w=Object(o.isActiveTimeline)(null!=x?x:"")?R.SourcererScopeName.timeline:null!=x&&Object(y.c)(x)?R.SourcererScopeName.detections:R.SourcererScopeName.default,{browserFields:T,indexPattern:I}=Object(k.d)(w),C=null!=d?d:"visBarVertical",M=null!=u?u:"left",F=null!=S?S:(D=l,s.i18n.translate("xpack.securitySolution.hoverActions.showTopTooltip",{values:{fieldName:D},defaultMessage:"Show top {fieldName}"}));var D;const A=Object(n.useMemo)((()=>t?i.a.createElement(t,{"aria-label":F,className:e,"data-test-subj":"show-top-field",icon:C,iconType:C,iconSide:M,flush:c,onClick:m,title:F},F):i.a.createElement(r.EuiButtonIcon,{"aria-label":F,className:"securitySolution__hoverActionButton","data-test-subj":"show-top-field",iconSize:"s",iconType:C,onClick:m})),[t,F,e,c,C,m,M]),_=Object(n.useMemo)((()=>E&&!v?i.a.createElement(r.EuiToolTip,{content:i.a.createElement(P.a,{additionalScreenReaderOnlyContext:Object(L.a)({field:l,value:j}),content:F,shortcut:B.a,showShortcut:b})},A):A),[A,F,l,b,E,v,j]),q=Object(n.useMemo)((()=>i.a.createElement(N,{browserFields:T,field:l,indexPattern:I,onFilterAdded:g,paddingSize:f,showLegend:h,scopeId:null!=x?x:void 0,toggleTopN:m,value:j,globalFilters:O})),[T,l,I,g,f,h,x,m,j,O]);return p?i.a.createElement(i.a.Fragment,null,A,v&&q):v?a?i.a.createElement(r.EuiPopover,{button:A,isOpen:v,closePopover:m,panelClassName:"withHoverActions__popover","data-test-subj":"showTopNContainer"},q):q:_}));q.displayName="ShowTopNButton"},function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(32),i=a(4),r=a.n(i);const s=a(0).i18n.translate("xpack.securitySolution.accessibility.tooltipWithKeyboardShortcut.pressTooltipLabel",{defaultMessage:"Press"}),o=({additionalScreenReaderOnlyContext:e="",content:t,shortcut:a,showShortcut:i})=>r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{"data-test-subj":"content"},t),""!==e&&r.a.createElement(n.EuiScreenReaderOnly,{"data-test-subj":"additionalScreenReaderOnlyContext"},r.a.createElement("p",null,e)),i&&r.a.createElement(n.EuiText,{color:"subdued","data-test-subj":"shortcut",size:"s",textAlign:"center"},r.a.createElement("span",null,s)," ",r.a.createElement(n.EuiBadge,{color:"hollow"},a))),l=r.a.memo(o);l.displayName="TooltipWithKeyboardShortcut"},function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));var n=a(32),i=a(4),r=a.n(i),s=a(709),o=a(605),l=a(47),c=a.n(l),u=a(963),d=a.n(u),p=a(0);p.i18n.translate("xpack.securitySolution.clipboard.copy",{defaultMessage:"Copy"});const m=p.i18n.translate("xpack.securitySolution.clipboard.copied",{defaultMessage:"Copied"}),g=p.i18n.translate("xpack.securitySolution.clipboard.to.the.clipboard",{defaultMessage:"to the clipboard"}),b=p.i18n.translate("xpack.securitySolution.clipboard.copy.to.the.clipboard",{defaultMessage:"Copy to the clipboard"});var f=a(84);const y=({children:e,content:t,isHoverAction:a,onCopy:i,titleSummary:s,toastLifeTimeMs:o})=>{const{addSuccess:l}=Object(f.a)(),u=c()("copy-to-clipboard",{securitySolution__hoverActionButton:a});return r.a.createElement(n.EuiButtonIcon,{"aria-label":b,className:u,"data-test-subj":"clipboard",iconType:"copyClipboard",onClick:e=>{e.preventDefault(),e.stopPropagation();const a=d()(`${t}`,{debug:!0});null!=i&&i({content:t,isSuccess:a}),a&&l(`${m} ${s} ${g}`,{toastLifeTimeMs:o})}},e)},h=r.a.memo((({isHoverAction:e,keyboardShortcut:t="",text:a,titleSummary:i})=>r.a.createElement(n.EuiToolTip,{content:r.a.createElement(s.a,{additionalScreenReaderOnlyContext:a,content:o.a,shortcut:t,showShortcut:""!==t})},r.a.createElement(y,{content:a,isHoverAction:e,titleSummary:i,toastLifeTimeMs:800}))));h.displayName="WithCopyToClipboard"},function(e,t,a){"use strict";a.d(t,"a",(function(){return x}));var n=a(4),i=a.n(n),r=a(33),s=a.n(r),o=a(32),l=a(230),c=a(175),u=a(93),d=a(245),p=a(0);const m=p.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.alertsActions.sectionTitle",{defaultMessage:"Alerts actions"}),g=p.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.alertsActions.singleAlertCloseLabel",{defaultMessage:"Close this alert"}),b=p.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.alertsActions.bulkCloseLabel.disabled",{defaultMessage:"Close all alerts that match this exception and were generated by this rule (Lists and non-ECS fields are not supported)"}),f=p.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.alertsActions.bulkCloseLabel",{defaultMessage:"Close all alerts that match this exception and were generated by selected rule/s"}),y=p.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.alertsActions.endpointQuarantineText",{defaultMessage:"On all Endpoint hosts, quarantined files that match the exception are automatically restored to their original locations. This exception applies to all rules using Endpoint exceptions."}),h=s.a.section.withConfig({displayName:"FlyoutCheckboxesSection",componentId:"sc-1qdq0iq-0"})(["overflow-y:inherit;height:auto;.euiFlyoutBody__overflowContent{padding-top:0;}"]),E=s()(o.EuiTitle).withConfig({displayName:"SectionHeader",componentId:"sc-1qdq0iq-1"})(["",""],(()=>Object(r.css)(["font-weight:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold)))),v=({isAlertDataLoading:e,exceptionListItems:t,exceptionListType:a,shouldCloseSingleAlert:r,shouldBulkCloseAlert:s,disableBulkClose:p,alertData:v,alertStatus:x,onDisableBulkClose:k,onUpdateBulkCloseIndex:S,onBulkCloseCheckboxChange:j,onSingleAlertCloseCheckboxChange:O})=>{const{loading:w,signalIndexName:T}=Object(l.a)(),I=Object(n.useMemo)((()=>null!==T?[T]:[]),[T]),[C,{indexPatterns:M}]=Object(c.b)(I),F=Object(n.useCallback)((e=>{j(e.currentTarget.checked)}),[j]),D=Object(n.useCallback)((e=>{null!=O&&O(e.currentTarget.checked)}),[O]);return Object(n.useEffect)((()=>{S(s&&null!=I?I:void 0)}),[I,S,s]),Object(n.useEffect)((()=>{!0===p&&j(!1)}),[p,j]),Object(n.useEffect)((()=>{!1===C&&!1===w&&k((e=>{for(const{entries:t}of e)for(const e of null!=t?t:[])if(Object(d.i)(e)===u.d.LIST)return!0;return!1})(t)||((e,t)=>{const a=e=>t.fields.some((({name:t})=>t===e.field));if(0===e.length)return!1;for(const{entries:t}of e)for(const e of null!=t?t:[])if("nested"===e.type){for(const t of e.entries)if(!1===a(t))return!0}else if(!1===a(e))return!0;return!1})(t,M)||t.every((e=>0===e.entries.length)))}),[k,t,C,w,M]),i.a.createElement(h,null,i.a.createElement(E,{size:"xs"},i.a.createElement("h3",null,m)),i.a.createElement(o.EuiSpacer,{size:"s"}),null!=v&&"closed"!==x&&i.a.createElement(o.EuiFormRow,{fullWidth:!0},i.a.createElement(o.EuiCheckbox,{"data-test-subj":"closeAlertOnAddExceptionCheckbox",id:"close-alert-on-add-add-exception-checkbox",label:g,checked:r,onChange:D,disabled:w||C||e})),i.a.createElement(o.EuiFormRow,{fullWidth:!0},i.a.createElement(o.EuiCheckbox,{"data-test-subj":"bulkCloseAlertOnAddExceptionCheckbox",id:"bulk-close-alert-on-add-add-exception-checkbox",label:p?b:f,checked:s,onChange:F,disabled:p||w||C||e})),"endpoint"===a&&i.a.createElement(i.a.Fragment,null,i.a.createElement(o.EuiSpacer,{size:"s"}),i.a.createElement(o.EuiText,{"data-test-subj":"addExceptionEndpointText",color:"subdued",size:"s"},y)))},x=i.a.memo(v);x.displayName="ExceptionItemsFlyoutAlertsActions"},function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var n=a(4),i=a(193),r=a(478),s=a(274),o=a(207),l=a(45),c=a(77);var u=a(190),d=a(14),p=a(0);const m=p.i18n.translate("xpack.securitySolution.ruleExceptions.logic.closeAlerts.error",{defaultMessage:"Failed to close alerts"});var g=a(84);const b=()=>{const{addSuccess:e,addError:t,addWarning:a}=Object(g.a)(),[b,f]=Object(n.useState)(!1),y=Object(n.useRef)(null);return Object(n.useEffect)((()=>{let n=!0;const g=new AbortController;return y.current=async(b,y,h,E)=>{try{var v,x,k,S,j,O,w,T;let t,m;if(f(!0),null!=h&&(t=await Object(i.j)({query:Object(r.a)([h]),status:"closed",signal:g.signal})),null!=E){const e=Object(s.b)(["open","acknowledged","in-progress"]),t=await(async(e,t,a,n,i,r=!0)=>{const s={fields:[],title:n.join()},{filter:u}=await Object(o.p)({http:c.b.get().http,exceptions:i,excludeExceptions:r,chunkSize:10}),d={query:e,language:t},p=((e,t)=>null!=t?[...e,t]:[...e])(a,u);return Object(l.buildEsQuery)(s,d,p,{allowLeadingWildcards:!0,queryStringOptions:{analyze_wildcard:!0},ignoreFilterIfFieldNotInIndex:!1,dateFormatTZ:"Zulu"})})("","kuery",[...b.flatMap((e=>Object(s.c)(e))),...e],E,Object(u.l)(y),!1);m=await Object(i.j)({query:{query:t},status:"closed",signal:g.signal})}const C=(null!==(v=null===(x=t)||void 0===x?void 0:x.updated)&&void 0!==v?v:0)+(null!==(k=null===(S=m)||void 0===S?void 0:S.updated)&&void 0!==k?k:0),M=null!==(j=null===(O=t)||void 0===O?void 0:O.version_conflicts)&&void 0!==j?j:0+(null!==(w=null===(T=m)||void 0===T?void 0:T.version_conflicts)&&void 0!==w?w:0);n&&(f(!1),e((I=C,p.i18n.translate("xpack.securitySolution.ruleExceptions.logic.closeAlerts.success",{values:{numAlerts:I},defaultMessage:"Successfully updated {numAlerts} {numAlerts, plural, =1 {alert} other {alerts}}"}))),M>0&&a({title:d.f(M),text:d.g(C,M)}))}catch(e){n&&(f(!1),t(e,{title:m}))}var I},()=>{n=!1,g.abort()}}),[e,t,a]),[b,y.current]}},function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return u}));var n=a(4),i=a(126),r=a(85),s=a(0);const o=s.i18n.translate("xpack.securitySolution.networkDetails.errorSearchDescription",{defaultMessage:"An error has occurred on network details search"});s.i18n.translate("xpack.securitySolution.networkDetails.failSearchDescription",{defaultMessage:"Failed to run search on network details"});var l=a(130);const c="networkDetailsQuery",u=({filterQuery:e,id:t=c,indexNames:a,ip:s,skip:u})=>{const{loading:d,result:p,search:m,refetch:g,inspect:b}=Object(l.a)({factoryQueryType:r.q.details,initialResult:{networkDetails:{}},errorMessage:o,abort:u}),f=Object(n.useMemo)((()=>({networkDetails:p.networkDetails,id:t,inspect:b,isInspected:!1,refetch:g})),[t,b,g,p.networkDetails]),y=Object(n.useMemo)((()=>({defaultIndex:a,factoryQueryType:r.q.details,filterQuery:Object(i.a)(e),ip:s})),[e,a,s]);return Object(n.useEffect)((()=>{!u&&y&&m(y)}),[y,m,u]),[d,f]}},function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));var n=a(4),i=a.n(n),r=a(32),s=a(8),o=a(205),l=a(316);const c=()=>document.querySelector('[tour-step="create-case-submit"]'),u=()=>{const[e,t]=Object(n.useState)(o.a.createCase),a=Object(n.useCallback)((()=>{var e;null===(e=c())||void 0===e||e.scrollIntoView()}),[]),r=Object(n.useCallback)((()=>{t(o.a.submitCase),a(),setTimeout((()=>{var e;null===(e=c())||void 0===e||e.focus()}),500)}),[a]);return i.a.createElement(i.a.Fragment,null,e===o.a.createCase&&i.a.createElement(l.a,{onClick:r,step:o.a.createCase,tourId:o.b.alertsCases}),e===o.a.submitCase&&i.a.createElement(l.a,{step:o.a.submitCase,tourId:o.b.alertsCases}))};var d=a(403),p=a(77),m=a(118);const g=({onMenuItemClick:e,ariaLabel:t,ecsData:a,nonEcsData:l,onSuccess:c,isActiveTimelines:g,isInDetections:b})=>{const{cases:f}=Object(p.k)().services,y=Object(p.i)(),h=Object(n.useMemo)((()=>{var e,t;return null==a||null===(e=a.event)||void 0===e||null===(t=e.kind)||void 0===t?void 0:t.includes("signal")}),[a]),E=Object(n.useMemo)((()=>{var e,t;return null!=a&&a._id?[{alertId:null!==(e=null==a?void 0:a._id)&&void 0!==e?e:"",index:null!==(t=null==a?void 0:a._index)&&void 0!==t?t:"",type:s.CommentType.alert,rule:f.helpers.getRuleIdFromEvent({ecs:a,data:null!=l?l:[]})}]:[]}),[f.helpers,a,l]),{activeStep:v,incrementStep:x,setStep:k,isTourShown:S}=Object(d.b)(),j=Object(n.useCallback)((async()=>{S(o.b.alertsCases)&&k(o.b.alertsCases,o.a.viewCase)}),[k,S]),O=Object(n.useMemo)((()=>!S(o.b.alertsCases)||v!==o.a.addAlertToCase&&v!==o.a.createCase&&v!==o.a.submitCase?{}:{initialValue:o.d}),[v,S]),w=f.hooks.getUseCasesAddToNewCaseFlyout({onClose:e,onSuccess:c,afterCaseCreated:j,...O}),T=f.hooks.getUseCasesAddToExistingCaseModal({onClose:e,onRowClick:c}),I=Object(n.useCallback)((()=>{e(),w.open({attachments:E,...S(o.b.alertsCases)?{headerContent:i.a.createElement(u,null)}:{}}),S(o.b.alertsCases)&&v===o.a.addAlertToCase&&x(o.b.alertsCases)}),[e,w,E,S,v,x]),C=Object(n.useCallback)((()=>{e(),T.open({attachments:E})}),[E,e,T]);return{addToCaseActionItems:Object(n.useMemo)((()=>(g||b)&&y.create&&y.read&&h?[i.a.createElement(r.EuiContextMenuItem,{"aria-label":t,"data-test-subj":"add-to-existing-case-action",key:"add-to-existing-case-action",onClick:C,size:"s"},m.i),i.a.createElement(r.EuiContextMenuItem,{"aria-label":t,"data-test-subj":"add-to-new-case-action",key:"add-to-new-case-action",onClick:I,size:"s"},m.j)]:[]),[t,C,I,y.create,y.read,b,g,h]),handleAddToNewCaseClick:I}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return p})),a.d(t,"b",(function(){return b}));var n=a(32),i=a(4),r=a.n(i),s=a(121);const o=r.a.memo((({onClick:e})=>r.a.createElement(n.EuiButtonEmpty,{color:"text","data-test-subj":"open-timeline-button",iconSide:"left",iconType:"folderOpen",onClick:e},s.E)));o.displayName="OpenTimelineModalButton";var l=a(606),c=a(242),u=a(387),d=a(858);const p="add-timeline-button",m=["createFrom"],g=({timelineId:e})=>{const[t,a]=Object(i.useState)(!1),[s,g]=Object(i.useState)(!1),b=Object(i.useCallback)((()=>a(!t)),[t]),f=Object(i.useCallback)((()=>a(!1)),[]),y=Object(i.useCallback)((()=>g(!1)),[]),h=Object(i.useCallback)((()=>{f(),g(!0)}),[f]),E=Object(i.useMemo)((()=>r.a.createElement(n.EuiButtonIcon,{className:p,"data-test-subj":"settings-plus-in-circle",iconType:"plusInCircle",color:"primary",size:"m",onClick:b,"aria-label":c.a})),[b]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiPopover,{anchorPosition:"downRight",button:E,id:"timelineSettingsPopover",panelProps:{"data-test-subj":"timeline-addPopupPanel"},isOpen:t,closePopover:f,ownFocus:!0,repositionOnScroll:!0},r.a.createElement(n.EuiFlexGroup,{alignItems:"flexStart",direction:"column",gutterSize:"none"},r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(u.c,{timelineId:e,title:c.h,closeGearMenu:f})),r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(d.a,{closeGearMenu:f,timelineId:e,title:c.g})),r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(o,{onClick:h}))))),s?r.a.createElement(l.a,{onClose:y,hideActions:m}):null)},b=r.a.memo(g)},function(e,t,a){"use strict";a.d(t,"a",(function(){return R}));var n=a(4),i=a.n(n),r=a(32),s=a(33),o=a.n(s),l=a(198),c=a(0);const u=c.i18n.translate("xpack.securitySolution.overview.landingCards.box.siem.header",{defaultMessage:"Elastic Security"}),d=c.i18n.translate("xpack.securitySolution.overview.landingCards.box.siem.title",{defaultMessage:"Security at the speed of Elastic"}),p=c.i18n.translate("xpack.securitySolution.overview.landingCards.box.siem.desc",{defaultMessage:"Elastic Security equips teams to prevent, detect, and respond to threats at cloud speed and scale — securing business operations with a unified, open platform."}),m=c.i18n.translate("xpack.securitySolution.overview.landingCards.box.siem.cta",{defaultMessage:"Add security integrations"}),g=c.i18n.translate("xpack.securitySolution.overview.landingCards.box.endpoint.title",{defaultMessage:"Endpoint security at scale"}),b=c.i18n.translate("xpack.securitySolution.overview.landingCards.box.endpoint.desc",{defaultMessage:"Prevent, collect, detect and respond — all with Elastic Agent."}),f=c.i18n.translate("xpack.securitySolution.overview.landingCards.box.siemCard.title",{defaultMessage:"SIEM for the modern SOC"}),y=c.i18n.translate("xpack.securitySolution.overview.landingCards.box.siemCard.desc",{defaultMessage:"Detect, investigate, and respond to evolving threats in your environment."}),h=c.i18n.translate("xpack.securitySolution.overview.landingCards.box.cloudCard.title",{defaultMessage:"Cloud protection end-to-end"}),E=c.i18n.translate("xpack.securitySolution.overview.landingCards.box.cloudCard.desc",{defaultMessage:"Assess your Cloud Posture and protect your workloads from attacks."}),v=c.i18n.translate("xpack.securitySolution.overview.landingCards.box.unify.title",{defaultMessage:"Unify SIEM, endpoint security, and cloud security"}),x=c.i18n.translate("xpack.securitySolution.overview.landingCards.box.unify.desc",{defaultMessage:"Elastic Security modernizes security operations — enabling analytics across years of data, automating key processes, and protecting every host."});var k=a(940),S=a.n(k),j=a(941),O=a.n(j),w=a(942),T=a.n(w),I=a(1),C=a(77);const M={cloud:O.a,siem:T.a,endpoint:S.a},F=o()(r.EuiCard).withConfig({displayName:"StyledEuiCard",componentId:"sc-1d1l7kb-0"})(["span.euiTitle{font-size:36px;line-height:100%;}"]),D=o()(r.EuiCard).withConfig({displayName:"StyledEuiCardTop",componentId:"sc-1d1l7kb-1"})(["span.euiTitle{font-size:36px;line-height:100%;}max-width:600px;display:block;margin:20px auto 0;"]),A=o()(r.EuiPageHeader).withConfig({displayName:"StyledEuiPageHeader",componentId:"sc-1d1l7kb-2"})(["h1{font-size:18px;}"]),_=o()(r.EuiCard).withConfig({displayName:"StyledImgEuiCard",componentId:"sc-1d1l7kb-3"})(["img{margin-top:20px;max-width:400px;}"]),N=o()(r.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-1d1l7kb-4"})(["background:",";padding:20px;margin:-12px !important;"],(({theme:e})=>e.eui.euiColorLightestShade)),R=Object(n.memo)((()=>{const{http:{basePath:{prepend:e}},cloudExperiments:t}=Object(C.k)().services,[a,s]=Object(n.useState)(I.a);Object(l.c)(t,"security-solutions.add-integrations-url",I.a,s);const o=Object(n.useMemo)((()=>e(a)),[e,a]);return i.a.createElement(r.EuiFlexGroup,{"data-test-subj":"siem-landing-page",direction:"column",gutterSize:"l"},i.a.createElement(r.EuiFlexItem,null,i.a.createElement(r.EuiFlexGroup,{gutterSize:"l"},i.a.createElement(r.EuiFlexItem,null,i.a.createElement(A,{pageTitle:u,iconType:"logoSecurity"}),i.a.createElement(F,{display:"plain",description:p,textAlign:"left",title:d,footer:i.a.createElement(r.EuiButton,{"data-test-subj":"add-integrations-header",href:o},m)})),i.a.createElement(r.EuiFlexItem,null,i.a.createElement("iframe",{allowFullScreen:!0,allowTransparency:!0,className:"vidyard_iframe",frameBorder:"0",height:"100%",referrerPolicy:"no-referrer",sandbox:"allow-scripts allow-same-origin",scrolling:"no",src:"//play.vidyard.com/K6kKDBbP9SpXife9s2tHNP.html?",title:u,width:"100%"})))),i.a.createElement(N,null,i.a.createElement(r.EuiFlexGroup,{gutterSize:"m"},i.a.createElement(r.EuiFlexItem,null,i.a.createElement(_,{hasBorder:!0,description:y,image:M.siem,textAlign:"center",title:f})),i.a.createElement(r.EuiFlexItem,null,i.a.createElement(_,{hasBorder:!0,description:b,image:M.endpoint,textAlign:"center",title:g})),i.a.createElement(r.EuiFlexItem,null,i.a.createElement(_,{hasBorder:!0,description:E,image:M.cloud,textAlign:"center",title:h})))),i.a.createElement(r.EuiFlexItem,null,i.a.createElement(D,{display:"plain",description:x,paddingSize:"l",textAlign:"center",title:v,footer:i.a.createElement(r.EuiButton,{"data-test-subj":"add-integrations-footer",href:o},m)})))}));R.displayName="LandingCards"},function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(4),i=a.n(n),r=a(32),s=a(0);const o=s.i18n.translate("xpack.securitySolution.rule_exceptions.itemMeta.nameLabel",{defaultMessage:"Exception name"}),l=s.i18n.translate("xpack.securitySolution.rule_exceptions.itemMeta.namePlaceholder",{defaultMessage:"Name your exception"}),c=({exceptionItemName:e,onChange:t})=>{const a=Object(n.useCallback)((e=>{t(["name",e.target.value])}),[t]);return i.a.createElement(r.EuiFormRow,{label:o,"data-test-subj":"exceptionFlyoutName"},i.a.createElement(r.EuiFieldText,{placeholder:l,value:e,onChange:a,"data-test-subj":"exceptionFlyoutNameInput"}))},u=i.a.memo(c);u.displayName="ExceptionsFlyoutMeta"},function(e,t,a){"use strict";a.d(t,"a",(function(){return j}));var n=a(4),i=a.n(n),r=a(32),s=a(66),o=a(93),l=a(33),c=a.n(l),u=a(110),d=a(166),p=a(77),m=a(0);const g=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.itemConditions.conditionsTitle",{defaultMessage:"Conditions"}),b=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.itemConditions.infoLabel",{defaultMessage:"Alerts are generated when the rule's conditions are met, except when:"}),f=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.itemConditions.sequenceWarningAdd",{defaultMessage:"This rule's query contains an EQL sequence statement. The exception created will apply to all events in the sequence."}),y=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.itemConditions.sequenceWarningEdit",{defaultMessage:"This rule's query contains an EQL sequence statement. The exception modified will apply to all events in the sequence."}),h=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.itemConditions.operatingSystemPlaceHolder",{defaultMessage:"Select an operating system"});var E=a(361);const v=[{label:E.g,value:["windows"]},{label:E.f,value:["macos"]},{label:E.e,value:["linux"]},{label:E.h,value:["windows","macos"]}],x=c()(r.EuiTitle).withConfig({displayName:"SectionHeader",componentId:"sc-t4gsg-0"})(["",""],(()=>Object(l.css)(["font-weight:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold)))),k=Object(l.createGlobalStyle)(['[data-test-subj="comboBoxOptionsList osSelectionDropdown-optionsList"]{z-index:6000 !important;}']),S=({exceptionItemName:e,allowLargeValueLists:t,exceptionListItems:a,indexPatterns:l,rules:c,exceptionListType:m,showOsTypeOptions:S,selectedOs:j,isEdit:O,onOsChange:w,onExceptionItemAdd:T,onSetErrorExists:I,onFilterIndexPatterns:C})=>{const{http:M,unifiedSearch:F}=Object(p.k)().services,D=Object(n.useMemo)((()=>m===o.b.ENDPOINT),[m]),A=Object(n.useMemo)((()=>null!=c&&c.some((e=>Object(d.b)(e.type)&&Object(d.a)(e.query)))),[c]),_=Object(n.useMemo)((()=>{if(D)return"endpoint_list";const e=D?u.j:void 0;return O?a[0].list_id:e}),[D,O,a]),N=Object(n.useMemo)((()=>{const e=D?"agnostic":void 0;return O?a[0].namespace_type:e}),[a,O,D]),R=Object(n.useCallback)((({exceptionItems:e,errorExists:t})=>{T(e),I(t)}),[I,T]),P=Object(n.useCallback)((e=>{const t=e[0].value;null!=w&&w(t||void 0)}),[w]),L=Object(n.useMemo)((()=>({asPlainText:!0})),[]),B=Object(n.useMemo)((()=>v.filter((e=>j===e.value))),[j]),q=Object(n.useMemo)((()=>S&&void 0===j),[S,j]),z=Object(n.useMemo)((()=>O?y:f),[O]),$=Object(n.useMemo)((()=>{var e;return null!==(e=O?a[0].os_types:j)&&void 0!==e?e:[]}),[a,O,j]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(x,{size:"xs"},i.a.createElement("h3",null,g)),A&&i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiCallOut,{"data-test-subj":"eqlSequenceCallout",title:z}),i.a.createElement(r.EuiSpacer,null)),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(r.EuiText,{size:"s"},b),i.a.createElement(r.EuiSpacer,{size:"s"}),S&&!O&&i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiFormRow,{label:E.d},i.a.createElement(r.EuiComboBox,{placeholder:h,singleSelection:L,options:v,selectedOptions:B,onChange:P,isClearable:!1,"data-test-subj":"osSelectionDropdown"})),i.a.createElement(k,null),i.a.createElement(r.EuiSpacer,{size:"l"})),S&&O&&i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiText,{size:"xs","data-test-subj":"exceptionItemSelectedOs"},i.a.createElement("dl",null,i.a.createElement("dt",null,E.d),i.a.createElement("dd",null,(e=>e.reduce(((e,t)=>`${(e=>"linux"===e?E.e:"macos"===e?E.f:E.g)(t)}, ${e}`),"").slice(0,-2))($)))),i.a.createElement(r.EuiSpacer,null)),Object(s.getExceptionBuilderComponentLazy)({allowLargeValueLists:t,httpService:M,autocompleteService:F.autocomplete,exceptionListItems:a,listType:m,osTypes:$,listId:_,listNamespaceType:N,listTypeSpecificIndexPatternFilter:C,exceptionItemName:e,indexPatterns:l,isOrDisabled:q,isAndDisabled:q,isNestedDisabled:q,dataTestSubj:"alertExceptionBuilder",idAria:"alertExceptionBuilder",onChange:R,isDisabled:q,allowCustomFieldOptions:!D}))},j=i.a.memo(S);j.displayName="ExceptionsConditions"},function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(84),i=a(392),r=a(300);const s=(e,t)=>{const{addError:a}=Object(n.a)();return Object(i.a)(e,{onError:e=>a(e,{title:r.b}),...t})},o=e=>{const{pagination:t,filterOptions:a,sortingOptions:n,isInMemorySorting:i,refetchInterval:r}=e,o=s({pagination:{page:1,perPage:1e4},filterOptions:a},{refetchInterval:r,enabled:i,keepPreviousData:!0}),l=s({pagination:t,filterOptions:a,sortingOptions:n},{refetchInterval:r,enabled:!i,keepPreviousData:!0});return i?o:l}},function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(4),i=a.n(n),r=a(77),s=a(32);const o=({url:e,children:t,ariaLabel:a})=>t?i.a.createElement(s.EuiToolTip,{content:e,position:"top","data-test-subj":"externalLinkTooltip"},i.a.createElement(s.EuiLink,{href:e,"aria-label":a,external:!0,target:"_blank",rel:"noopener","data-test-subj":"externalLink"},t)):null;var l=a(678);const c=({guidePath:e="security",docPath:t,linkText:a})=>{const{services:n}=Object(r.k)(),{ELASTIC_WEBSITE_URL:s,DOC_LINK_VERSION:c}=n.docLinks,u=`${s}guide/en/${e}/${c}/${t}`,d=`${a} - ${l.a}`;return i.a.createElement(o,{url:u,ariaLabel:d},a)},u=Object(n.memo)(c)},function(e,t,a){"use strict";a.d(t,"a",(function(){return j}));var n=a(82),i=a.n(n),r=a(4),s=a.n(r),o=a(32),l=a(0),c=a(35),u=a(33),d=a.n(u),p=a(323),m=a(153),g=a(91),b=a(240),f=a(187);const y=()=>{},h={bordered:!0,showIcons:!1},E={className:"effected-policies-search"},v=d.a.div.withConfig({displayName:"StyledEuiSelectable",componentId:"sc-zldyw-0"})([".effected-policies-search{border-bottom-left-radius:0;border-bottom-right-radius:0;}.euiSelectableList{border-top-left-radius:0;border-top-right-radius:0;border-top-width:0;}"]),x=d()(o.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItemButtonGroup",componentId:"sc-zldyw-1"})(["@media only screen and (max-width:","){align-items:center;}"],(e=>e.theme.eui.euiBreakpoints.m)),k=d()(o.EuiButtonGroup).withConfig({displayName:"StyledButtonGroup",componentId:"sc-zldyw-2"})(["display:flex;justify-content:right;.euiButtonGroupButton{padding-right:",";}"],(e=>e.theme.eui.euiSizeL)),S=d.a.div.withConfig({displayName:"EffectivePolicyFormContainer",componentId:"sc-zldyw-3"})([".policy-name .euiSelectableListItem__text{text-decoration:none !important;color:"," !important;}"],(e=>e.theme.eui.euiTextColor)),j=Object(r.memo)((({isGlobal:e,isPlatinumPlus:t,description:a,isLoading:n=!1,onChange:u,listProps:d,options:j,selected:O=[],disabled:w=!1,"data-test-subj":T,...I})=>{const{getAppUrl:C}=Object(b.b)(),M=Object(g.a)(T),F=Object(r.useMemo)((()=>[{id:"globalPolicy",label:l.i18n.translate("xpack.securitySolution.endpoint.effectedPolicySelect.global",{defaultMessage:"Global"}),iconType:e?"checkInCircleFilled":"empty","data-test-subj":M("global")},{id:"perPolicy",label:l.i18n.translate("xpack.securitySolution.endpoint.effectedPolicySelect.perPolicy",{defaultMessage:"Per Policy"}),iconType:e?"empty":"checkInCircleFilled","data-test-subj":M("perPolicy")}]),[M,e]),D=Object(r.useMemo)((()=>{const a=new Set(O.map((e=>e.id)));return j.map((n=>({label:n.name,className:"policy-name",prepend:s.a.createElement(o.EuiCheckbox,{id:Object(o.htmlIdGenerator)()(),onChange:y,checked:a.has(n.id),disabled:e||!t||w,"data-test-subj":`policy-${n.id}-checkbox`}),append:s.a.createElement(p.a,{href:C({path:Object(m.j)(n.id)}),appPath:Object(m.j)(n.id),target:"_blank"},s.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.effectedPolicySelect.viewPolicyLinkLabel",defaultMessage:"View policy"})),policy:n,checked:a.has(n.id)?"on":void 0,disabled:e||!t||w,"data-test-subj":`policy-${n.id}`}))).sort((({label:e},{label:t})=>e.localeCompare(t)))}),[w,C,e,t,j,O]),A=Object(r.useCallback)((t=>{u({isGlobal:e,selected:t.filter((e=>e.checked)).map((e=>e.policy))})}),[e,u]),_=Object(r.useCallback)((e=>{u({isGlobal:"globalPolicy"===e,selected:O})}),[u,O]),N=Object(r.useCallback)(((e,t)=>s.a.createElement(s.a.Fragment,null,t,e)),[]);return s.a.createElement(S,null,s.a.createElement(o.EuiText,{size:"xs"},s.a.createElement("h3",null,s.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.effectedPolicySelect.assignmentSectionTitle",defaultMessage:"Assignment"}))),s.a.createElement(o.EuiSpacer,{size:"xs"}),s.a.createElement(o.EuiFlexGroup,null,s.a.createElement(o.EuiFlexItem,{grow:2},s.a.createElement(o.EuiText,{size:"s"},s.a.createElement("p",null,a||l.i18n.translate("xpack.securitySolution.effectedPolicySelect.assignmentSectionDescription",{defaultMessage:"Assign globally across all policies, or assign it to specific policies."})))),s.a.createElement(x,{grow:1},s.a.createElement(o.EuiFormRow,{fullWidth:!0,isDisabled:w},s.a.createElement(k,{legend:"Global Policy Toggle",options:F,idSelected:e?"globalPolicy":"perPolicy",onChange:_,color:"primary","data-test-subj":M("byPolicyGlobalButtonGroup"),isDisabled:w})))),s.a.createElement(o.EuiSpacer,null),!e&&(n?s.a.createElement(f.a,{size:"l","data-test-subj":M("policiesLoader")}):s.a.createElement(o.EuiFormRow,{fullWidth:!0},s.a.createElement(v,null,s.a.createElement(o.EuiSelectable,i()({},I,{options:D,listProps:d||h,onChange:A,searchProps:E,searchable:!0,"data-test-subj":M("policiesSelectable")}),N)))))}));j.displayName="EffectedPolicySelect"},function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var n=a(4),i=a.n(n),r=a(595),s=a(32),o=a(35),l=a(33);const c=a.n(l).a.p.withConfig({displayName:"P",componentId:"sc-1p4er2f-0"})(["margin-bottom:5px;"]);c.displayName="P";const u=i.a.memo((({maybeDurationNanoseconds:e,tooltipTitle:t})=>i.a.createElement(i.a.Fragment,null,null!=t?i.a.createElement(c,{"data-test-subj":"title"},t):null,i.a.createElement(c,{"data-test-subj":"humanized"},Object(r.c)(e)),i.a.createElement(c,{"data-test-subj":"raw-value"},i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.formattedDuration.tooltipLabel",defaultMessage:"raw"}),": ",e))));u.displayName="FormattedDurationTooltipContent";const d=i.a.memo((({children:e,maybeDurationNanoseconds:t,tooltipTitle:a})=>i.a.createElement(s.EuiToolTip,{"data-test-subj":"formatted-duration-tooltip",content:i.a.createElement(u,{maybeDurationNanoseconds:t,tooltipTitle:a})},i.a.createElement(i.a.Fragment,null,e))));d.displayName="FormattedDurationTooltip";const p=i.a.memo((({maybeDurationNanoseconds:e,tooltipTitle:t})=>i.a.createElement(d,{maybeDurationNanoseconds:e,tooltipTitle:t},i.a.createElement("div",{"data-test-subj":"formatted-duration"},Object(r.b)(e)))));p.displayName="FormattedDuration"},function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var n=a(4),i=a(129),r=a(171),s=a(259),o=a(84),l=a(77),c=a(120),u=a(389);const d=Object(i.d)((async({http:e,jobIds:t,signal:a})=>e.fetch("/api/ml/jobs/jobs",{method:"POST",body:JSON.stringify({jobIds:t}),asSystemRequest:!0,signal:a}))),p=e=>{const[t,a]=Object(n.useState)([]),{addError:p}=Object(o.a)(),m=Object(c.a)(),g=Object(l.j)(),{error:b,loading:f,result:y,start:h}=Object(i.a)(d),E=Object(r.a)(m),v=Object(s.a)(m);return Object(n.useEffect)((()=>{E&&v&&e.length>0&&h({http:g,jobIds:e})}),[g,E,v,h,e]),Object(n.useEffect)((()=>{y&&a(y)}),[y]),Object(n.useEffect)((()=>{b&&p(b,{title:u.a})}),[p,b]),{isLicensed:v,isMlUser:E,jobs:t,loading:f}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return s}));var n=a(93);const i=["endpoint_list"],r=e=>!!i.find((t=>t===e.list_id)),s=e=>n.o.is(e)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a(63),a(425),a(426);var n=a(734).default({key:"css"}),i=n.flush,r=n.hydrate,s=n.cx,o=n.merge,l=n.getRegisteredStyles,c=n.injectGlobal,u=n.keyframes,d=n.css,p=n.sheet,m=n.cache;t.cache=m,t.css=d,t.cx=s,t.flush=i,t.getRegisteredStyles=l,t.hydrate=r,t.injectGlobal=c,t.keyframes=u,t.merge=o,t.sheet=p},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(727),i=a(729),r=a(731);function s(e){return e&&e.__esModule?e:{default:e}}var o=s(n),l=s(i),c=/[A-Z]|^ms/g,u=/_EMO_([^_]+?)_([^]*?)_EMO_/g,d=function(e){return 45===e.charCodeAt(1)},p=function(e){return null!=e&&"boolean"!=typeof e},m=s(r).default((function(e){return d(e)?e:e.replace(c,"-$&").toLowerCase()})),g=function(e,t){switch(e){case"animation":case"animationName":if("string"==typeof t)return t.replace(u,(function(e,t,a){return f={name:t,styles:a,next:f},t}))}return 1===l.default[e]||d(e)||"number"!=typeof t||0===t?t:t+"px"};function b(e,t,a){if(null==a)return"";if(void 0!==a.__emotion_styles)return a;switch(typeof a){case"boolean":return"";case"object":if(1===a.anim)return f={name:a.name,styles:a.styles,next:f},a.name;if(void 0!==a.styles){var n=a.next;if(void 0!==n)for(;void 0!==n;)f={name:n.name,styles:n.styles,next:f},n=n.next;return a.styles+";"}return function(e,t,a){var n="";if(Array.isArray(a))for(var i=0;i<a.length;i++)n+=b(e,t,a[i])+";";else for(var r in a){var s=a[r];if("object"!=typeof s)null!=t&&void 0!==t[s]?n+=r+"{"+t[s]+"}":p(s)&&(n+=m(r)+":"+g(r,s)+";");else if(!Array.isArray(s)||"string"!=typeof s[0]||null!=t&&void 0!==t[s[0]]){var o=b(e,t,s);switch(r){case"animation":case"animationName":n+=m(r)+":"+o+";";break;default:n+=r+"{"+o+"}"}}else for(var l=0;l<s.length;l++)p(s[l])&&(n+=m(r)+":"+g(r,s[l])+";")}return n}(e,t,a);case"function":if(void 0!==e){var i=f,r=a(e);return f=i,b(e,t,r)}}if(null==t)return a;var s=t[a];return void 0!==s?s:a}var f,y=/label:\s*([^\s;\n{]+)\s*(;|$)/g;t.serializeStyles=function(e,t,a){if(1===e.length&&"object"==typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var n=!0,i="";f=void 0;var r=e[0];null==r||void 0===r.raw?(n=!1,i+=b(a,t,r)):i+=r[0];for(var s=1;s<e.length;s++)i+=b(a,t,e[s]),n&&(i+=r[s]);y.lastIndex=0;for(var l,c="";null!==(l=y.exec(i));)c+="-"+l[1];return{name:o.default(i)+c,styles:i,next:f}}},function(e,t,a){"use strict";e.exports=a(728)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t,a=0,n=0,i=e.length;i>=4;++n,i-=4)t=1540483477*(65535&(t=255&e.charCodeAt(n)|(255&e.charCodeAt(++n))<<8|(255&e.charCodeAt(++n))<<16|(255&e.charCodeAt(++n))<<24))+(59797*(t>>>16)<<16),a=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&a)+(59797*(a>>>16)<<16);switch(i){case 3:a^=(255&e.charCodeAt(n+2))<<16;case 2:a^=(255&e.charCodeAt(n+1))<<8;case 1:a=1540483477*(65535&(a^=255&e.charCodeAt(n)))+(59797*(a>>>16)<<16)}return(((a=1540483477*(65535&(a^=a>>>13))+(59797*(a>>>16)<<16))^a>>>15)>>>0).toString(36)}},function(e,t,a){"use strict";e.exports=a(730)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1}},function(e,t,a){"use strict";e.exports=a(732)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=Object.create(null);return function(a){return void 0===t[a]&&(t[a]=e(a)),t[a]}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="undefined"!=typeof document,i=function(e,t,a){var i=e.key+"-"+t.name;(!1===a||!1===n&&void 0!==e.compat)&&void 0===e.registered[i]&&(e.registered[i]=t.styles)};t.getRegisteredStyles=function(e,t,a){var n="";return a.split(" ").forEach((function(a){void 0!==e[a]?t.push(e[a]+";"):n+=a+" "})),n},t.insertStyles=function(e,t,a){i(e,t,a);var r=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var s="",o=t;do{var l=e.insert(t===o?"."+r:"",o,e.sheet,!0);n||void 0===l||(s+=l),o=o.next}while(void 0!==o);if(!n&&0!==s.length)return s}},t.registerStyles=i},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(63),i=a(425),r=a(426);function s(e){return e&&e.__esModule?e:{default:e}}var o=s(n);function l(e,t){if(void 0===e.inserted[t.name])return e.insert("",t,e.sheet,!0)}function c(e,t,a){var n=[],i=r.getRegisteredStyles(e,n,a);return n.length<2?a:i+t(n)}var u=function e(t){for(var a="",n=0;n<t.length;n++){var i=t[n];if(null!=i){var r=void 0;switch(typeof i){case"boolean":break;case"object":if(Array.isArray(i))r=e(i);else for(var s in r="",i)i[s]&&s&&(r&&(r+=" "),r+=s);break;default:r=i}r&&(a&&(a+=" "),a+=r)}}return a};t.default=function(e){var t=o.default(e);t.sheet.speedy=function(e){this.isSpeedy=e},t.compat=!0;var a=function(){for(var e=arguments.length,a=new Array(e),n=0;n<e;n++)a[n]=arguments[n];var s=i.serializeStyles(a,t.registered,void 0);return r.insertStyles(t,s,!1),t.key+"-"+s.name};return{css:a,cx:function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return c(t.registered,a,u(n))},injectGlobal:function(){for(var e=arguments.length,a=new Array(e),n=0;n<e;n++)a[n]=arguments[n];var r=i.serializeStyles(a,t.registered);l(t,r)},keyframes:function(){for(var e=arguments.length,a=new Array(e),n=0;n<e;n++)a[n]=arguments[n];var r=i.serializeStyles(a,t.registered),s="animation-"+r.name;return l(t,{name:r.name,styles:"@keyframes "+s+"{"+r.styles+"}"}),s},hydrate:function(e){e.forEach((function(e){t.inserted[e]=!0}))},flush:function(){t.registered={},t.inserted={},t.sheet.flush()},sheet:t.sheet,cache:t,getRegisteredStyles:r.getRegisteredStyles.bind(null,t.registered),merge:c.bind(null,t.registered,a)}}},,function(e,t,a){"use strict";const n=a(737),i=a(738);class AggregateError extends Error{constructor(e){if(!Array.isArray(e))throw new TypeError("Expected input to be an Array, got "+typeof e);let t=(e=[...e].map((e=>e instanceof Error?e:null!==e&&"object"==typeof e?Object.assign(new Error(e.message),e):new Error(e)))).map((e=>"string"==typeof e.stack?i(e.stack).replace(/\s+at .*aggregate-error\/index.js:\d+:\d+\)?/g,""):String(e))).join("\n");t="\n"+n(t,4),super(t),this.name="AggregateError",Object.defineProperty(this,"_errors",{value:e})}*[Symbol.iterator](){for(const e of this._errors)yield e}}e.exports=AggregateError},function(e,t,a){"use strict";e.exports=(e,t=1,a)=>{if(a={indent:" ",includeEmptyLines:!1,...a},"string"!=typeof e)throw new TypeError(`Expected \`input\` to be a \`string\`, got \`${typeof e}\``);if("number"!=typeof t)throw new TypeError(`Expected \`count\` to be a \`number\`, got \`${typeof t}\``);if("string"!=typeof a.indent)throw new TypeError(`Expected \`options.indent\` to be a \`string\`, got \`${typeof a.indent}\``);if(0===t)return e;const n=a.includeEmptyLines?/^/gm:/^(?!\s*$)/gm;return e.replace(n,a.indent.repeat(t))}},function(e,t,a){"use strict";const n=a(739),i=/\s+at.*(?:\(|\s)(.*)\)?/,r=/^(?:(?:(?:node|(?:internal\/[\w/]*|.*node_modules\/(?:babel-polyfill|pirates)\/.*)?\w+)\.js:\d+:\d+)|native)/,s=void 0===n.homedir?"":n.homedir();e.exports=(e,t)=>(t=Object.assign({pretty:!1},t),e.replace(/\\/g,"/").split("\n").filter((e=>{const t=e.match(i);if(null===t||!t[1])return!0;const a=t[1];return!a.includes(".app/Contents/Resources/electron.asar")&&!a.includes(".app/Contents/Resources/default_app.asar")&&!r.test(a)})).filter((e=>""!==e.trim())).map((e=>t.pretty?e.replace(i,((e,t)=>e.replace(t,t.replace(s,"~")))):e)).join("\n"))},function(e,t){},,,,,,function(e,t,a){var n=a(432)("set",a(806));n.placeholder=a(456),e.exports=n},function(e,t,a){e.exports=a(27)(3570)},function(e,t,a){e.exports={ary:a(748),assign:a(772),clone:a(773),curry:a(774),forEach:a(445),isArray:a(218),isError:a(775),isFunction:a(449),isWeakMap:a(778),iteratee:a(780),keys:a(798),rearg:a(799),toInteger:a(447),toPath:a(801)}},function(e,t,a){var n=a(329);e.exports=function(e,t,a){return t=a?void 0:t,t=e&&null==t?e.length:t,n(e,128,void 0,void 0,void 0,void 0,t)}},function(e,t,a){e.exports=a(27)(3111)},function(e,t,a){var n=a(269),i=a(270);e.exports=function(e,t,a){var r=1&t,s=n(e);return function t(){var n=this&&this!==i&&this instanceof t?s:e;return n.apply(r?a:this,arguments)}}},function(e,t,a){var n=a(436),i=a(269),r=a(437),s=a(440),o=a(446),l=a(337),c=a(270);e.exports=function(e,t,a){var u=i(e);return function i(){for(var d=arguments.length,p=Array(d),m=d,g=o(i);m--;)p[m]=arguments[m];var b=d<3&&p[0]!==g&&p[d-1]!==g?[]:l(p,g);if((d-=b.length)<a)return s(e,t,r,i.placeholder,void 0,p,b,void 0,void 0,a-d);var f=this&&this!==c&&this instanceof i?u:e;return n(f,this,p)}}},function(e,t){e.exports=function(e,t){for(var a=e.length,n=0;a--;)e[a]===t&&++n;return n}},function(e,t,a){var n=a(332),i=a(441),r=a(755),s=a(757);e.exports=function(e){var t=r(e),a=s[t];if("function"!=typeof a||!(t in n.prototype))return!1;if(e===a)return!0;var o=i(a);return!!o&&e===o[0]}},function(e,t){e.exports=function(){}},function(e,t,a){var n=a(756),i=Object.prototype.hasOwnProperty;e.exports=function(e){for(var t=e.name+"",a=n[t],r=i.call(n,t)?a.length:0;r--;){var s=a[r],o=s.func;if(null==o||o==e)return s.name}return t}},function(e,t){e.exports={}},function(e,t,a){var n=a(332),i=a(442),r=a(333),s=a(218),o=a(334),l=a(758),c=Object.prototype.hasOwnProperty;function u(e){if(o(e)&&!s(e)&&!(e instanceof n)){if(e instanceof i)return e;if(c.call(e,"__wrapped__"))return l(e)}return new i(e)}u.prototype=r.prototype,u.prototype.constructor=u,e.exports=u},function(e,t,a){var n=a(332),i=a(442),r=a(335);e.exports=function(e){if(e instanceof n)return e.clone();var t=new i(e.__wrapped__,e.__chain__);return t.__actions__=r(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}},function(e,t,a){e.exports=a(27)(3436)},function(e,t){var a=/\{\n\/\* \[wrapped with (.+)\] \*/,n=/,? & /;e.exports=function(e){var t=e.match(a);return t?t[1].split(n):[]}},function(e,t){var a=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;e.exports=function(e,t){var n=t.length;if(!n)return e;var i=n-1;return t[i]=(n>1?"& ":"")+t[i],t=t.join(n>2?", ":" "),e.replace(a,"{\n/* [wrapped with "+t+"] */\n")}},function(e,t,a){e.exports=a(27)(3433)},function(e,t,a){var n=a(445),i=a(764),r=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]];e.exports=function(e,t){return n(r,(function(a){var n="_."+a[0];t&a[1]&&!i(e,n)&&e.push(n)})),e.sort()}},function(e,t,a){var n=a(765);e.exports=function(e,t){return!(null==e||!e.length)&&n(e,t,0)>-1}},function(e,t,a){var n=a(766),i=a(767),r=a(768);e.exports=function(e,t,a){return t==t?r(e,t,a):n(e,i,a)}},function(e,t){e.exports=function(e,t,a,n){for(var i=e.length,r=a+(n?1:-1);n?r--:++r<i;)if(t(e[r],r,e))return r;return-1}},function(e,t){e.exports=function(e){return e!=e}},function(e,t){e.exports=function(e,t,a){for(var n=a-1,i=e.length;++n<i;)if(e[n]===t)return n;return-1}},function(e,t,a){var n=a(335),i=a(336),r=Math.min;e.exports=function(e,t){for(var a=e.length,s=r(t.length,a),o=n(e);s--;){var l=t[s];e[s]=i(l,a)?o[l]:void 0}return e}},function(e,t,a){var n=a(436),i=a(269),r=a(270);e.exports=function(e,t,a,s){var o=1&t,l=i(e);return function t(){for(var i=-1,c=arguments.length,u=-1,d=s.length,p=Array(d+c),m=this&&this!==r&&this instanceof t?l:e;++u<d;)p[u]=s[u];for(;c--;)p[u++]=arguments[++i];return n(m,o?a:this,p)}}},function(e,t,a){var n=a(438),i=a(439),r=a(337),s="__lodash_placeholder__",o=Math.min;e.exports=function(e,t){var a=e[1],l=t[1],c=a|l,u=c<131,d=128==l&&8==a||128==l&&256==a&&e[7].length<=t[8]||384==l&&t[7].length<=t[8]&&8==a;if(!u&&!d)return e;1&l&&(e[2]=t[2],c|=1&a?0:4);var p=t[3];if(p){var m=e[3];e[3]=m?n(m,p,t[4]):p,e[4]=m?r(e[3],s):t[4]}return(p=t[5])&&(m=e[5],e[5]=m?i(m,p,t[6]):p,e[6]=m?r(e[5],s):t[6]),(p=t[7])&&(e[7]=p),128&l&&(e[8]=null==e[8]?t[8]:o(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=c,e}},function(e,t,a){e.exports=a(27)(3401)},function(e,t,a){var n=a(448);e.exports=function(e){return n(e,4)}},function(e,t,a){var n=a(329);function i(e,t,a){var r=n(e,8,void 0,void 0,void 0,void 0,void 0,t=a?void 0:t);return r.placeholder=i.placeholder,r}i.placeholder={},e.exports=i},function(e,t,a){var n=a(776),i=a(334),r=a(777);e.exports=function(e){if(!i(e))return!1;var t=n(e);return"[object Error]"==t||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!r(e)}},function(e,t,a){e.exports=a(27)(332)},function(e,t,a){e.exports=a(27)(3426)},function(e,t,a){var n=a(779),i=a(334);e.exports=function(e){return i(e)&&"[object WeakMap]"==n(e)}},function(e,t,a){e.exports=a(27)(760)},function(e,t,a){var n=a(448),i=a(781);e.exports=function(e){return i("function"==typeof e?e:n(e,1))}},function(e,t,a){var n=a(782),i=a(787),r=a(434),s=a(218),o=a(794);e.exports=function(e){return"function"==typeof e?e:null==e?r:"object"==typeof e?s(e)?i(e[0],e[1]):n(e):o(e)}},function(e,t,a){var n=a(783),i=a(785),r=a(452);e.exports=function(e){var t=i(e);return 1==t.length&&t[0][2]?r(t[0][0],t[0][1]):function(a){return a===e||n(a,e,t)}}},function(e,t,a){var n=a(784),i=a(450);e.exports=function(e,t,a,r){var s=a.length,o=s,l=!r;if(null==e)return!o;for(e=Object(e);s--;){var c=a[s];if(l&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++s<o;){var u=(c=a[s])[0],d=e[u],p=c[1];if(l&&c[2]){if(void 0===d&&!(u in e))return!1}else{var m=new n;if(r)var g=r(d,p,u,e,t,m);if(!(void 0===g?i(p,d,3,r,m):g))return!1}}return!0}},function(e,t,a){e.exports=a(27)(1493)},function(e,t,a){var n=a(451),i=a(786);e.exports=function(e){for(var t=i(e),a=t.length;a--;){var r=t[a],s=e[r];t[a]=[r,s,n(s)]}return t}},function(e,t,a){e.exports=a(27)(1136)},function(e,t,a){var n=a(450),i=a(788),r=a(789),s=a(454),o=a(451),l=a(452),c=a(219);e.exports=function(e,t){return s(e)&&o(t)?l(c(e),t):function(a){var s=i(a,e);return void 0===s&&s===t?r(a,e):n(t,s,3)}}},function(e,t,a){e.exports=a(27)(1812)},function(e,t,a){var n=a(790),i=a(791);e.exports=function(e,t){return null!=e&&i(e,t,n)}},function(e,t){e.exports=function(e,t){return null!=e&&t in Object(e)}},function(e,t,a){var n=a(453),i=a(792),r=a(218),s=a(336),o=a(793),l=a(219);e.exports=function(e,t,a){for(var c=-1,u=(t=n(t,e)).length,d=!1;++c<u;){var p=l(t[c]);if(!(d=null!=e&&a(e,p)))break;e=e[p]}return d||++c!=u?d:!!(u=null==e?0:e.length)&&o(u)&&s(p,u)&&(r(e)||i(e))}},function(e,t,a){e.exports=a(27)(1502)},function(e,t,a){e.exports=a(27)(1505)},function(e,t,a){var n=a(795),i=a(796),r=a(454),s=a(219);e.exports=function(e){return r(e)?n(s(e)):i(e)}},function(e,t){e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},function(e,t,a){var n=a(797);e.exports=function(e){return function(t){return n(t,e)}}},function(e,t,a){e.exports=a(27)(1544)},function(e,t,a){e.exports=a(27)(3106)},function(e,t,a){var n=a(329),i=a(800)((function(e,t){return n(e,256,void 0,void 0,void 0,t)}));e.exports=i},function(e,t,a){e.exports=a(27)(3427)},function(e,t,a){var n=a(802),i=a(335),r=a(218),s=a(803),o=a(804),l=a(219),c=a(805);e.exports=function(e){return r(e)?n(e,l):s(e)?[e]:i(o(c(e)))}},function(e,t,a){e.exports=a(27)(1545)},function(e,t,a){e.exports=a(27)(770)},function(e,t,a){e.exports=a(27)(3395)},function(e,t,a){e.exports=a(27)(3397)},function(e,t,a){e.exports=a(807)},function(e,t,a){var n=a(455);e.exports=function(e,t,a){return null==e?e:n(e,t,a)}},function(e,t,a){e.exports=a(27)(1547)},function(e,t,a){var n=a(432)("setWith",a(810));n.placeholder=a(456),e.exports=n},function(e,t,a){e.exports=a(811)},function(e,t,a){var n=a(455);e.exports=function(e,t,a,i){return i="function"==typeof i?i:void 0,null==e?e:n(e,t,a,i)}},function(e,t,a){"use strict";a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return d}));var n=a(34),i=a(236),r=a(134),s=a(382),o=a(603),l=a(2);const c=i.b.HostsType.details,u={[r.HostsTableType.hosts]:o.a,[r.HostsTableType.authentications]:o.c,[r.HostsTableType.uncommonProcesses]:o.g,[r.HostsTableType.anomalies]:o.b,[r.HostsTableType.events]:o.d,[r.HostsTableType.risk]:o.e,[r.HostsTableType.sessions]:o.f},d=(e,t)=>{let a=[];if(null!=e.detailName&&(a=[...a,{text:e.detailName,href:t({path:Object(s.a)(e.detailName,""),deepLinkId:l.a.hosts})}]),null!=e.tabName){const t=Object(n.get)("tabName",e);if(!t)return a;a=[...a,{text:u[t],href:""}]}return a}},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(84),i=a(338),r=a(300);const s=(e,t=!0)=>{const{addError:a}=Object(n.a)();return Object(i.a)(e,t?{onError:e=>{a(e,{title:r.b})}}:void 0)}},function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(146);const i=["alert.attributes.name","alert.attributes.params.index","alert.attributes.params.threat.tactic.id","alert.attributes.params.threat.tactic.name","alert.attributes.params.threat.technique.id","alert.attributes.params.threat.technique.name","alert.attributes.params.threat.technique.subtechnique.id","alert.attributes.params.threat.technique.subtechnique.name"],r=({showCustomRules:e,showElasticRules:t,filter:a,tags:r,excludeRuleTypes:s=[]})=>{const o=[];if(e&&t||(t?o.push("alert.attributes.params.immutable: true"):e&&o.push("alert.attributes.params.immutable: false")),r.length>0&&o.push(`alert.attributes.tags:(${r.map((e=>`"${Object(n.d)(e)}"`)).join(" AND ")})`),a.length){const e=i.map((e=>`${e}: "${Object(n.d)(a)}"`)).join(" OR ");o.push(`(${e})`)}return s.length&&o.push(`NOT alert.attributes.params.type: (${s.map((e=>`"${Object(n.d)(e)}"`)).join(" OR ")})`),o.join(" AND ")}},function(e,t,a){"use strict";var n,i=(n=a(408))&&"object"==typeof n&&"default"in n?n.default:n,r=a(4);function s(){return s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},s.apply(this,arguments)}e.exports=function(e){var t=void 0===e?{}:e,a=t.ref,n=t.onResize,o=r.useRef(null);a=a||o;var l=r.useState({width:void 0,height:void 0}),c=l[0],u=l[1],d=r.useRef({width:void 0,height:void 0});return r.useEffect((function(){if("object"==typeof a&&null!==a&&a.current instanceof Element){var e=a.current,t=new i((function(e){if(Array.isArray(e)&&e.length){var t=e[0],a=Math.round(t.contentRect.width),i=Math.round(t.contentRect.height);if(d.current.width!==a||d.current.height!==i){var r={width:a,height:i};n?n(r):(d.current.width=a,d.current.height=i,u(r))}}}));return t.observe(e),function(){return t.unobserve(e)}}}),[a,n]),r.useMemo((function(){return s({ref:a},c)}),[a,c?c.width:null,c?c.height:null])}},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(33),i=a.n(n),r=a(32);const s=i()(r.EuiInMemoryTable).withConfig({displayName:"BasicTable",componentId:"sc-1c8nyx9-0"})(["tbody{th,td{vertical-align:top;}.euiTableCellContent{display:block;}}"]);s.displayName="BasicTable"},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(4),i=a.n(n),r=a(32);const s=({selectedJobIds:e,onSelect:t,title:a,jobIds:s})=>{const[o,l]=Object(n.useState)(!1),c=Object(n.useCallback)((()=>{l(!o)}),[o]),u=Object(n.useCallback)((()=>{l(!1)}),[]),d=Object(n.useCallback)((a=>{const n=null!=e?e:[],i=n.includes(a)?n.filter((e=>e!==a)):[...n,a];t(i)}),[e,t]),p=Object(n.useMemo)((()=>i.a.createElement(r.EuiFilterButton,{disabled:0===s.length,"data-test-subj":"job-id-filter-button",hasActiveFilters:e.length>0,iconType:"arrowDown",isSelected:o,numActiveFilters:e.length,onClick:c,contentProps:{style:{minWidth:112}}},a)),[o,c,a,e.length,s]);return i.a.createElement(r.EuiFilterGroup,null,i.a.createElement(r.EuiPopover,{button:p,isOpen:o,closePopover:u,panelPaddingSize:"none"},i.a.createElement("div",{className:"euiFilterSelect__items"},s.map((t=>i.a.createElement(r.EuiFilterSelectItem,{"data-test-subj":`job-id-filter-item-${t}`,checked:e.includes(t)?"on":void 0,key:t,onClick:()=>d(t)},t))))))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(4),i=a.n(n),r=a(32),s=a(288);const o=[{value:"auto",text:s.g},{value:"hour",text:s.i},{value:"day",text:s.h},{value:"second",text:s.j}],l=({interval:e,onChange:t})=>{const a=Object(n.useCallback)((e=>{t(e.target.value)}),[t]);return i.a.createElement(r.EuiSelect,{"data-test-subj":"selectInterval",prepend:s.f,append:i.a.createElement(r.EuiToolTip,{content:s.k},i.a.createElement(r.EuiIcon,{type:"questionInCircle",color:"subdued"})),options:o,value:e,onChange:a})}},function(e,t,a){"use strict";var n=a(295).compose;t.__esModule=!0,t.composeWithDevTools=function(){if(0!==arguments.length)return"object"==typeof arguments[0]?n:n.apply(null,arguments)},t.devToolsEnhancer=function(){return function(e){return e}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.easing={linear:function(e){return e},quadratic:function(e){return e*(-e*e*e+4*e*e-6*e+4)},cubic:function(e){return e*(4*e*e-9*e+6)},elastic:function(e){return e*(33*e*e*e*e-106*e*e*e+126*e*e-67*e+15)},inQuad:function(e){return e*e},outQuad:function(e){return e*(2-e)},inOutQuad:function(e){return e<.5?2*e*e:(4-2*e)*e-1},inCubic:function(e){return e*e*e},outCubic:function(e){return--e*e*e+1},inOutCubic:function(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},inQuart:function(e){return e*e*e*e},outQuart:function(e){return 1- --e*e*e*e},inOutQuart:function(e){return e<.5?8*e*e*e*e:1-8*--e*e*e*e},inQuint:function(e){return e*e*e*e*e},outQuint:function(e){return 1+--e*e*e*e*e},inOutQuint:function(e){return e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e},inSine:function(e){return 1-Math.cos(e*(Math.PI/2))},outSine:function(e){return Math.sin(e*(Math.PI/2))},inOutSine:function(e){return-(Math.cos(Math.PI*e)-1)/2},inExpo:function(e){return Math.pow(2,10*(e-1))},outExpo:function(e){return 1-Math.pow(2,-10*e)},inOutExpo:function(e){return(e/=.5)<1?Math.pow(2,10*(e-1))/2:(e--,(2-Math.pow(2,-10*e))/2)},inCirc:function(e){return 1-Math.sqrt(1-e*e)},outCirc:function(e){return Math.sqrt(1-(e-=1)*e)},inOutCirc:function(e){return(e/=.5)<1?-(Math.sqrt(1-e*e)-1)/2:(e-=2,(Math.sqrt(1-e*e)+1)/2)}}},function(e,t,a){e.exports=function(){"use strict";function e(e,n,i,r,s){!function e(a,n,i,r,s){for(;r>i;){if(r-i>600){var o=r-i+1,l=n-i+1,c=Math.log(o),u=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*u*(o-u)/o)*(l-o/2<0?-1:1);e(a,n,Math.max(i,Math.floor(n-l*u/o+d)),Math.min(r,Math.floor(n+(o-l)*u/o+d)),s)}var p=a[n],m=i,g=r;for(t(a,i,n),s(a[r],p)>0&&t(a,i,r);m<g;){for(t(a,m,g),m++,g--;s(a[m],p)<0;)m++;for(;s(a[g],p)>0;)g--}0===s(a[i],p)?t(a,i,g):t(a,++g,r),g<=n&&(i=g+1),n<=g&&(r=g-1)}}(e,n,i||0,r||e.length-1,s||a)}function t(e,t,a){var n=e[t];e[t]=e[a],e[a]=n}function a(e,t){return e<t?-1:e>t?1:0}var n=function(e){void 0===e&&(e=9),this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function i(e,t,a){if(!a)return t.indexOf(e);for(var n=0;n<t.length;n++)if(a(e,t[n]))return n;return-1}function r(e,t){s(e,0,e.children.length,t,e)}function s(e,t,a,n,i){i||(i=g(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var r=t;r<a;r++){var s=e.children[r];o(i,e.leaf?n(s):s)}return i}function o(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function l(e,t){return e.minX-t.minX}function c(e,t){return e.minY-t.minY}function u(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function d(e){return e.maxX-e.minX+(e.maxY-e.minY)}function p(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function m(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function g(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function b(t,a,n,i,r){for(var s=[a,n];s.length;)if(!((n=s.pop())-(a=s.pop())<=i)){var o=a+Math.ceil((n-a)/i/2)*i;e(t,o,a,n,r),s.push(a,o,o,n)}}return n.prototype.all=function(){return this._all(this.data,[])},n.prototype.search=function(e){var t=this.data,a=[];if(!m(e,t))return a;for(var n=this.toBBox,i=[];t;){for(var r=0;r<t.children.length;r++){var s=t.children[r],o=t.leaf?n(s):s;m(e,o)&&(t.leaf?a.push(s):p(e,o)?this._all(s,a):i.push(s))}t=i.pop()}return a},n.prototype.collides=function(e){var t=this.data;if(!m(e,t))return!1;for(var a=[];t;){for(var n=0;n<t.children.length;n++){var i=t.children[n],r=t.leaf?this.toBBox(i):i;if(m(e,r)){if(t.leaf||p(e,r))return!0;a.push(i)}}t=a.pop()}return!1},n.prototype.load=function(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(var t=0;t<e.length;t++)this.insert(e[t]);return this}var a=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===a.height)this._splitRoot(this.data,a);else{if(this.data.height<a.height){var n=this.data;this.data=a,a=n}this._insert(a,this.data.height-a.height-1,!0)}else this.data=a;return this},n.prototype.insert=function(e){return e&&this._insert(e,this.data.height-1),this},n.prototype.clear=function(){return this.data=g([]),this},n.prototype.remove=function(e,t){if(!e)return this;for(var a,n,r,s=this.data,o=this.toBBox(e),l=[],c=[];s||l.length;){if(s||(s=l.pop(),n=l[l.length-1],a=c.pop(),r=!0),s.leaf){var u=i(e,s.children,t);if(-1!==u)return s.children.splice(u,1),l.push(s),this._condense(l),this}r||s.leaf||!p(s,o)?n?(a++,s=n.children[a],r=!1):s=null:(l.push(s),c.push(a),a=0,n=s,s=s.children[0])}return this},n.prototype.toBBox=function(e){return e},n.prototype.compareMinX=function(e,t){return e.minX-t.minX},n.prototype.compareMinY=function(e,t){return e.minY-t.minY},n.prototype.toJSON=function(){return this.data},n.prototype.fromJSON=function(e){return this.data=e,this},n.prototype._all=function(e,t){for(var a=[];e;)e.leaf?t.push.apply(t,e.children):a.push.apply(a,e.children),e=a.pop();return t},n.prototype._build=function(e,t,a,n){var i,s=a-t+1,o=this._maxEntries;if(s<=o)return r(i=g(e.slice(t,a+1)),this.toBBox),i;n||(n=Math.ceil(Math.log(s)/Math.log(o)),o=Math.ceil(s/Math.pow(o,n-1))),(i=g([])).leaf=!1,i.height=n;var l=Math.ceil(s/o),c=l*Math.ceil(Math.sqrt(o));b(e,t,a,c,this.compareMinX);for(var u=t;u<=a;u+=c){var d=Math.min(u+c-1,a);b(e,u,d,l,this.compareMinY);for(var p=u;p<=d;p+=l){var m=Math.min(p+l-1,d);i.children.push(this._build(e,p,m,n-1))}}return r(i,this.toBBox),i},n.prototype._chooseSubtree=function(e,t,a,n){for(;n.push(t),!t.leaf&&n.length-1!==a;){for(var i=1/0,r=1/0,s=void 0,o=0;o<t.children.length;o++){var l=t.children[o],c=u(l),d=(p=e,m=l,(Math.max(m.maxX,p.maxX)-Math.min(m.minX,p.minX))*(Math.max(m.maxY,p.maxY)-Math.min(m.minY,p.minY))-c);d<r?(r=d,i=c<i?c:i,s=l):d===r&&c<i&&(i=c,s=l)}t=s||t.children[0]}var p,m;return t},n.prototype._insert=function(e,t,a){var n=a?e:this.toBBox(e),i=[],r=this._chooseSubtree(n,this.data,t,i);for(r.children.push(e),o(r,n);t>=0&&i[t].children.length>this._maxEntries;)this._split(i,t),t--;this._adjustParentBBoxes(n,i,t)},n.prototype._split=function(e,t){var a=e[t],n=a.children.length,i=this._minEntries;this._chooseSplitAxis(a,i,n);var s=this._chooseSplitIndex(a,i,n),o=g(a.children.splice(s,a.children.length-s));o.height=a.height,o.leaf=a.leaf,r(a,this.toBBox),r(o,this.toBBox),t?e[t-1].children.push(o):this._splitRoot(a,o)},n.prototype._splitRoot=function(e,t){this.data=g([e,t]),this.data.height=e.height+1,this.data.leaf=!1,r(this.data,this.toBBox)},n.prototype._chooseSplitIndex=function(e,t,a){for(var n,i,r,o,l,c,d,p=1/0,m=1/0,g=t;g<=a-t;g++){var b=s(e,0,g,this.toBBox),f=s(e,g,a,this.toBBox),y=(i=b,r=f,void 0,void 0,void 0,void 0,o=Math.max(i.minX,r.minX),l=Math.max(i.minY,r.minY),c=Math.min(i.maxX,r.maxX),d=Math.min(i.maxY,r.maxY),Math.max(0,c-o)*Math.max(0,d-l)),h=u(b)+u(f);y<p?(p=y,n=g,m=h<m?h:m):y===p&&h<m&&(m=h,n=g)}return n||a-t},n.prototype._chooseSplitAxis=function(e,t,a){var n=e.leaf?this.compareMinX:l,i=e.leaf?this.compareMinY:c;this._allDistMargin(e,t,a,n)<this._allDistMargin(e,t,a,i)&&e.children.sort(n)},n.prototype._allDistMargin=function(e,t,a,n){e.children.sort(n);for(var i=this.toBBox,r=s(e,0,t,i),l=s(e,a-t,a,i),c=d(r)+d(l),u=t;u<a-t;u++){var p=e.children[u];o(r,e.leaf?i(p):p),c+=d(r)}for(var m=a-t-1;m>=t;m--){var g=e.children[m];o(l,e.leaf?i(g):g),c+=d(l)}return c},n.prototype._adjustParentBBoxes=function(e,t,a){for(var n=a;n>=0;n--)o(t[n],e)},n.prototype._condense=function(e){for(var t=e.length-1,a=void 0;t>=0;t--)0===e[t].children.length?t>0?(a=e[t-1].children).splice(a.indexOf(e[t]),1):this.clear():r(e[t],this.toBBox)},n}()},function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return o}));var n=a(34),i=a(159),r=a(158);const s=(e,t)=>e?e.map((e=>{const a=e.id.split("."),i=a.length>1?a[0]:(({browserFields:e,field:t})=>Object(n.has)(`base.fields.${t}`,e)?"base":t)({field:e.id,browserFields:t});return{...e,...Object(n.get)([i,"fields",e.id],t)}})):[],o=(e,t)=>{var a;return{columnHeaderType:r.a,id:e,initialWidth:i.a,...null!==(a=t.find((t=>t.id===e)))&&void 0!==a?a:{}}}},function(e,t,a){"use strict";a.d(t,"d",(function(){return r})),a.d(t,"c",(function(){return s})),a.d(t,"b",(function(){return o})),a.d(t,"g",(function(){return l})),a.d(t,"e",(function(){return c}));var n=a(0),i=a(212);a.d(t,"a",(function(){return i.a})),a.d(t,"f",(function(){return i.b}));const r=e=>n.i18n.translate("xpack.securitySolution.entityAnalytics.riskDashboard.riskToolTip",{defaultMessage:"{riskEntity} risk classification is determined by {riskEntityLowercase} risk score. {riskEntity}s classified as Critical or High are indicated as risky.",values:{riskEntity:Object(i.c)(e),riskEntityLowercase:Object(i.c)(e,!0)}}),s=e=>n.i18n.translate("xpack.securitySolution.entityAnalytics.riskDashboard.riskClassificationTitle",{defaultMessage:"{riskEntity} risk classification",values:{riskEntity:Object(i.c)(e)}}),o=e=>n.i18n.translate("xpack.securitySolution.entityAnalytics.riskDashboard.nameTitle",{defaultMessage:"{riskEntity} Name",values:{riskEntity:Object(i.c)(e)}}),l=n.i18n.translate("xpack.securitySolution.entityAnalytics.riskDashboard.viewAllLabel",{defaultMessage:"View all"}),c=n.i18n.translate("xpack.securitySolution.entityAnalytics.riskDashboard.learnMore",{defaultMessage:"Learn more"})},,function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(33),i=a.n(n),r=a(4),s=a.n(r),o=a(32),l=a(157);const c=i()(o.EuiSwitch).withConfig({displayName:"StaticSwitch",componentId:"sc-1xsgv9-0"})([".euiSwitch__thumb,.euiSwitch__icon{transition:none;}"]);c.displayName="StaticSwitch";const u=({job:e,isSecurityJobsLoading:t,onJobStateChange:a})=>{const[n,i]=Object(r.useState)(!1),u=Object(r.useCallback)((async t=>{i(!0),await a(e,e.latestTimestampMs||0,t.target.checked),i(!1)}),[e,i,a]);return s.a.createElement(o.EuiFlexGroup,{justifyContent:"spaceAround"},s.a.createElement(o.EuiFlexItem,{grow:!1},t||n||Object(l.b)(e.jobState,e.datafeedState)?s.a.createElement(o.EuiLoadingSpinner,{size:"m","data-test-subj":"job-switch-loader"}):s.a.createElement(c,{"data-test-subj":"job-switch",disabled:Object(l.a)(e.jobState,e.datafeedState),checked:Object(l.c)(e.jobState,e.datafeedState),onChange:u,showLabel:!1,label:""})))};u.displayName="JobSwitchComponent";const d=s.a.memo(u);d.displayName="JobSwitch"},function(e,t,a){"use strict";var n=a(461);a.d(t,"b",(function(){return n.a}));var i=a(589);a.d(t,"a",(function(){return i.a}))},function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(4),i=a(131),r=a(608),s=a(113),o=a(571),l=a(496),c=a(681);const u=`${s.Gb}.ndjson`;function d(){const e=Object(c.a)(),t=Object(l.a)();return Object(n.useCallback)((async a=>{try{Object(r.a)(a,u),e({actionType:i.b.export,summary:await Object(o.b)(a)})}catch(e){t({actionType:i.b.export,error:e})}}),[e,t])}},function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(4),i=a(157),r=a(378),s=a(518);const o=()=>{const{enableDatafeed:e,isLoading:t}=Object(s.a)(),{loading:a,jobs:o,refetch:l}=Object(r.a)(),[c,u]=Object(n.useState)(!1),d=Object(n.useCallback)((async n=>{if(a||t)return;if(!n||!n.length)return;u(!0);const r=o.filter((e=>n.includes(e.id)));await Promise.all(r.map((async t=>{var a;if(Object(i.c)(t.jobState,t.datafeedState))return!0;const n=null!==(a=t.latestTimestampMs)&&void 0!==a?a:0;await e(t,n,!0)}))),l(),u(!1)}),[e,t,a,o,l]);return{loading:a,jobs:o,starting:c,startMlJobs:d}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(137);const i=(e,t)=>e===n.UsersType.details&&null!=t?[{fieldName:"user.name",fieldValue:t}]:[]},function(e,t,a){"use strict";a.d(t,"e",(function(){return E})),a.d(t,"f",(function(){return k})),a.d(t,"j",(function(){return w})),a.d(t,"i",(function(){return I})),a.d(t,"a",(function(){return ge})),a.d(t,"b",(function(){return Ve})),a.d(t,"c",(function(){return lt})),a.d(t,"d",(function(){return It})),a.d(t,"g",(function(){return Wt})),a.d(t,"h",(function(){return ba}));var n=a(82),i=a.n(n),r=a(4),s=a.n(r),o=a(37),l=a(41),c=a(32),u=a(192),d=a(578),p=a(698),m=a(304),g=a(420),b=a(104),f=a(689),y=a(272),h=a(1);const E=s.a.memo((({type:e,to:t,filterQuery:a,isInitializing:n,from:r,indexPattern:E,indexNames:v,setQuery:x})=>{const k={startDate:r,endDate:t,indexNames:v,skip:n,type:e,setQuery:x,filterQuery:a},S={...k,indexPattern:E},j={...k,anomaliesFilterQuery:{bool:{should:[{exists:{field:"source.ip"}},{exists:{field:"destination.ip"}}],minimum_should_match:1}},AnomaliesTableComponent:p.a};return s.a.createElement(o.Switch,null,s.a.createElement(l.Route,{path:`${h.Sb}/:tabName(${y.a.dns})`},s.a.createElement(Ve,S)),s.a.createElement(l.Route,{path:`${h.Sb}/:tabName(${y.a.flows})`},s.a.createElement(s.a.Fragment,null,s.a.createElement(f.a,{direction:"column"},s.a.createElement(c.EuiFlexItem,null,s.a.createElement(It,i()({},S,{flowTarget:u.b.source}))),s.a.createElement(c.EuiFlexItem,null,s.a.createElement(It,i()({},S,{flowTarget:u.b.destination})))),s.a.createElement(c.EuiSpacer,null),s.a.createElement(f.a,{direction:"column"},s.a.createElement(c.EuiFlexItem,null,s.a.createElement(ge,i()({},S,{flowTarget:u.b.source}))),s.a.createElement(c.EuiFlexItem,null,s.a.createElement(ge,i()({},S,{flowTarget:u.b.destination})))))),s.a.createElement(l.Route,{path:`${h.Sb}/:tabName(${y.a.http})`},s.a.createElement(lt,S)),s.a.createElement(l.Route,{path:`${h.Sb}/:tabName(${y.a.tls})`},s.a.createElement(Wt,i()({},S,{flowTarget:u.b.source}))),s.a.createElement(l.Route,{path:`${h.Sb}/:tabName(${y.a.anomalies})`},s.a.createElement(g.a,i()({},j,{AnomaliesTableComponent:p.a}))),s.a.createElement(l.Route,{path:`${h.Sb}/:tabName(${y.a.events})`},s.a.createElement(d.a,i()({additionalFilters:m.f,tableId:b.c.networkPageEvents},S))))}));E.displayName="NetworkRoutes";var v=a(33);const x=a.n(v)()(c.EuiFlexGroup).withConfig({displayName:"FlexGroup",componentId:"sc-1sbaj97-0"})(["min-height:200px;"]);x.displayName="FlexGroup";const k=()=>s.a.createElement(x,{justifyContent:"center",alignItems:"center"},s.a.createElement(c.EuiFlexItem,{grow:!1},s.a.createElement(c.EuiLoadingSpinner,{size:"xl"})));k.displayName="NetworkRoutesLoading";var S=a(34),j=a(413);const O=e=>`${h.Sb}/${e}`,w=e=>{const t={[y.a.flows]:{id:y.a.flows,name:j.d,href:O(y.a.flows),disabled:!1},[y.a.dns]:{id:y.a.dns,name:j.b,href:O(y.a.dns),disabled:!1},[y.a.http]:{id:y.a.http,name:j.e,href:O(y.a.http),disabled:!1},[y.a.tls]:{id:y.a.tls,name:j.f,href:O(y.a.tls),disabled:!1},[y.a.anomalies]:{id:y.a.anomalies,name:j.a,href:O(y.a.anomalies),disabled:!1},[y.a.events]:{id:y.a.events,name:j.c,href:O(y.a.events),disabled:!1}};return e?t:Object(S.omit)([y.a.anomalies],t)};var T=a(577);const I=(e,t)=>e&&!t?T.d:T.e;var C=a(78),M=a(92),F=a.n(M),D=a(111),A=a(85),_=a(81),N=a(197),R=a(44),P=a.n(R),L=a(475),B=a(133),q=a(102),z=a(87),$=a(106),V=a(150),U=a(0);const H=e=>U.i18n.translate("xpack.securitySolution.networkTopCountriesTable.heading.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {Country} other {Countries}}"}),G=U.i18n.translate("xpack.securitySolution.networkTopCountriesTable.column.countryTitle",{defaultMessage:"Country"}),Q=U.i18n.translate("xpack.securitySolution.networkTopCountriesTable.column.bytesInTitle",{defaultMessage:"Bytes in"}),W=U.i18n.translate("xpack.securitySolution.networkTopCountriesTable.column.bytesOutTitle",{defaultMessage:"Bytes out"}),K=U.i18n.translate("xpack.securitySolution.networkTopCountriesTable.column.flows",{defaultMessage:"Flows"}),Y=U.i18n.translate("xpack.securitySolution.networkTopCountriesTable.heading.destinationCountries",{defaultMessage:"Destination countries"}),J=U.i18n.translate("xpack.securitySolution.networkTopCountriesTable.heading.sourceCountries",{defaultMessage:"Source countries"}),X=U.i18n.translate("xpack.securitySolution.networkTopCountriesTable.column.destinationIps",{defaultMessage:"Destination IPs"}),Z=U.i18n.translate("xpack.securitySolution.networkTopCountriesTable.column.sourceIps",{defaultMessage:"Source IPs"}),ee=U.i18n.translate("xpack.securitySolution.networkTopCountriesTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),te=U.i18n.translate("xpack.securitySolution.networkTopCountriesTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"});var ae=a(257);const ne=e=>e===u.b.source?u.b.destination:u.b.source,ie=[{text:ee,numberOfRow:5},{text:te,numberOfRow:10}],re=({data:e,fakeTotalCount:t,flowTargeted:a,id:n,indexPattern:i,isInspect:o,loading:l,loadPage:c,setQuerySkip:d,showMorePagesIndicator:p,totalCount:m,type:g})=>{const b=Object(C.useDispatch)(),f=Object(r.useMemo)((()=>D.e.topCountriesSelector()),[]),{activePage:y,limit:h,sort:E}=Object(_.a)((e=>f(e,g,a))),v=Object(r.useMemo)((()=>a===A.g.source?J:Y),[a]),x=Object(r.useMemo)((()=>g===D.c.NetworkType.page?a===A.g.source?D.c.NetworkTableType.topCountriesSource:D.c.NetworkTableType.topCountriesDestination:a===A.g.source?D.c.NetworkDetailsTableType.topCountriesSource:D.c.NetworkDetailsTableType.topCountriesDestination),[a,g]),k=E.field===A.s.bytes_out||E.field===A.s.bytes_in?`node.network.${E.field}`:`node.${a}.${E.field}`,j=Object(r.useCallback)((e=>b(D.b.updateNetworkTable({networkType:g,tableType:x,updates:{limit:e}}))),[b,g,x]),O=Object(r.useCallback)((e=>b(D.b.updateNetworkTable({networkType:g,tableType:x,updates:{activePage:e}}))),[b,g,x]),w=Object(r.useCallback)((e=>{if(null!=e.sort){const t=e.sort.field.split("."),a=Object(S.last)(t),n={field:a,direction:a!==E.field?A.b.desc:e.sort.direction};F()(n,E)||b(D.b.updateNetworkTable({networkType:g,tableType:x,updates:{sort:n}}))}}),[E,b,g,x]),T=Object(r.useMemo)((()=>((e,t,a,n)=>{const i=((e,t,a,n)=>[{name:G,render:({node:e})=>{const a=Object(S.get)(`${t}.country`,e),i=`${t}.geo.country_iso_code`,r=Object(q.h)(`${n}-table-${t}-country-${a}`);return null!=a?s.a.createElement(B.b,{key:r,dataProvider:{and:[],enabled:!0,id:r,name:a,excluded:!1,kqlQuery:"",queryMatch:{field:i,value:a,operator:$.d}},isAggregatable:!0,fieldType:"keyword",render:(e,t,n)=>n.isDragging?s.a.createElement(B.a,null,s.a.createElement(V.a,{dataProvider:e})):s.a.createElement(s.a.Fragment,null,s.a.createElement(L.b,{countryCode:a}))}):Object(z.d)()},width:"20%"},{align:"right",field:"node.network.bytes_in",name:Q,sortable:!0,render:e=>null!=e?s.a.createElement(ae.a,{value:e}):Object(z.d)()},{align:"right",field:"node.network.bytes_out",name:W,sortable:!0,render:e=>null!=e?s.a.createElement(ae.a,{value:e}):Object(z.d)()},{align:"right",field:`node.${t}.flows`,name:K,sortable:!0,render:e=>null!=e?P()(e).format("0,000"):Object(z.d)()},{align:"right",field:`node.${t}.${t}_ips`,name:t===u.b.source?Z:X,sortable:!0,render:e=>null!=e?P()(e).format("0,000"):Object(z.d)()},{align:"right",field:`node.${t}.${ne(t)}_ips`,name:ne(t)===u.b.source?Z:X,sortable:!0,render:e=>null!=e?P()(e).format("0,000"):Object(z.d)()}])(0,t,0,n);return a===D.c.NetworkType.details?(i.pop(),i):i})(0,a,g,"networkTopCountries-top-talkers")),[i,a,g]);return s.a.createElement(N.a,{activePage:y,columns:T,dataTestSubj:`table-${x}`,headerCount:m,headerTitle:v,headerUnit:H(m),id:n,isInspect:o,itemsPerRow:ie,limit:h,loading:l,loadPage:c,onChange:w,pageOfItems:e,setQuerySkip:d,showMorePagesIndicator:p,sorting:{field:k,direction:E.direction},totalCount:t,updateActivePage:O,updateLimitPagination:j})};re.displayName="NetworkTopCountriesTableComponent";const se=s.a.memo(re);var oe=a(126),le=a(215);const ce=U.i18n.translate("xpack.securitySolution.networkTopCountries.failSearchDescription",{defaultMessage:"Failed to run search on network top countries"});var ue=a(130),de=a(127),pe=a(109);const me=Object(de.a)(se),ge=({endDate:e,filterQuery:t,flowTarget:a,indexNames:n,indexPattern:i,ip:o,setQuery:l,skip:c,startDate:u,type:d})=>{const p=`networkTopCountriesQuery-${a}-${d}`,{toggleStatus:m}=Object(pe.a)(p),[g,b]=Object(r.useState)(c||!m);Object(r.useEffect)((()=>{b(c||!m)}),[c,m]);const[f,{id:y,inspect:h,isInspected:E,loadPage:v,networkTopCountries:x,pageInfo:k,refetch:j,totalCount:O}]=(({endDate:e,filterQuery:t,flowTarget:a,id:n,indexNames:i,ip:s,skip:o,startDate:l,type:c})=>{const u=Object(r.useMemo)((()=>D.e.topCountriesSelector()),[]),{activePage:d,limit:p,sort:m}=Object(_.a)((e=>u(e,c,a))),[g,b]=Object(r.useState)(null),f=Object(r.useCallback)((e=>{b((t=>t?{...t,pagination:Object(le.a)(e,p)}:t))}),[p]),{loading:y,result:h,search:E,refetch:v,inspect:x}=Object(ue.a)({factoryQueryType:A.q.topCountries,initialResult:{edges:[],totalCount:-1,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1}},errorMessage:ce,abort:o}),k=Object(r.useMemo)((()=>({endDate:e,networkTopCountries:h.edges,id:n,inspect:x,isInspected:!1,loadPage:f,pageInfo:h.pageInfo,refetch:v,startDate:l,totalCount:h.totalCount})),[e,n,x,v,h.edges,h.pageInfo,h.totalCount,l,f]);return Object(r.useEffect)((()=>{b((n=>{const r={...null!=n?n:{},defaultIndex:i,factoryQueryType:A.q.topCountries,filterQuery:Object(oe.a)(t),flowTarget:a,ip:s,pagination:Object(le.a)(d,p),sort:m,timerange:{interval:"12h",from:l,to:e}};return F()(n,r)?n:r}))}),[d,i,e,t,s,p,l,m,a]),Object(r.useEffect)((()=>{!o&&g&&E(g)}),[g,E,o]),[y,k]})({endDate:e,flowTarget:a,filterQuery:t,id:p,indexNames:n,ip:o,skip:g,startDate:u,type:d});return s.a.createElement(me,{data:x,fakeTotalCount:Object(S.getOr)(50,"fakeTotalCount",k),flowTargeted:a,id:y,indexPattern:i,inspect:h,isInspect:E,loading:f,loadPage:v,refetch:j,setQuery:l,setQuerySkip:b,showMorePagesIndicator:Object(S.getOr)(!1,"showMorePagesIndicator",k),totalCount:O,type:d})};ge.displayName="CountriesQueryTabBody";const be=U.i18n.translate("xpack.securitySolution.networkDnsTable.title",{defaultMessage:"Top DNS domains"}),fe=e=>U.i18n.translate("xpack.securitySolution.networkDnsTable.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {domain} other {domains}}"}),ye=U.i18n.translate("xpack.securitySolution.networkDnsTable.helperTooltip",{defaultMessage:"This shows DNS protocol traffic only and can be useful for hunting domains used in DNS data exfiltration."}),he=U.i18n.translate("xpack.securitySolution.networkDnsTable.column.registeredDomain",{defaultMessage:"Registered domain"}),Ee=U.i18n.translate("xpack.securitySolution.networkDnsTable.column.TotalQueriesTitle",{defaultMessage:"Total queries"}),ve=U.i18n.translate("xpack.securitySolution.networkDnsTable.column.uniqueDomainsTitle",{defaultMessage:"Unique domains"}),xe=U.i18n.translate("xpack.securitySolution.networkDnsTable.column.bytesInTitle",{defaultMessage:"DNS bytes in"}),ke=U.i18n.translate("xpack.securitySolution.networkDnsTable.column.bytesOutTitle",{defaultMessage:"DNS bytes out"}),Se=U.i18n.translate("xpack.securitySolution.networkDnsTable.select.includePtrRecords",{defaultMessage:"Include PTR records"}),je=U.i18n.translate("xpack.securitySolution.networkDnsTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),Oe=U.i18n.translate("xpack.securitySolution.networkDnsTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),we=s.a.memo((({isPtrIncluded:e,onChange:t})=>s.a.createElement(c.EuiSwitch,{name:"switch-ptr-included",label:Se,checked:e,onChange:t})));we.displayName="IsPtrIncluded";const Te=D.c.NetworkTableType.dns,Ie=[{text:je,numberOfRow:5},{text:Oe,numberOfRow:10}],Ce=({data:e,fakeTotalCount:t,id:a,isInspect:n,loading:i,loadPage:o,showMorePagesIndicator:l,setQuerySkip:c,totalCount:u,type:d})=>{const p=Object(C.useDispatch)(),m=Object(r.useMemo)((()=>D.e.dnsSelector()),[]),{activePage:g,isPtrIncluded:b,limit:f,sort:y}=Object(_.a)(m),h=Object(r.useCallback)((e=>p(D.b.updateNetworkTable({networkType:d,tableType:Te,updates:{limit:e}}))),[d,p]),E=Object(r.useCallback)((e=>p(D.b.updateNetworkTable({networkType:d,tableType:Te,updates:{activePage:e}}))),[p,d]),v=Object(r.useCallback)((e=>{if(null!=e.sort){const t={field:e.sort.field.split(".")[1],direction:e.sort.direction};F()(t,y)||p(D.b.updateNetworkTable({networkType:d,tableType:Te,updates:{sort:t}}))}}),[y,d,p]),x=Object(r.useCallback)((()=>p(D.b.updateNetworkTable({networkType:d,tableType:Te,updates:{isPtrIncluded:!b}}))),[p,d,b]),k=Object(r.useMemo)((()=>[{field:`node.${A.n.dnsName}`,name:he,truncateText:!1,mobileOptions:{show:!0},sortable:!0,render:e=>{if(null!=e){const t=Object(q.h)(`networkDns-table--name-${e}`);return s.a.createElement(B.b,{key:t,dataProvider:{and:[],enabled:!0,id:t,name:e,excluded:!1,kqlQuery:"",queryMatch:{field:"dns.question.registered_domain",value:e,operator:$.d}},isAggregatable:!0,fieldType:"keyword",render:(t,a,n)=>n.isDragging?s.a.createElement(B.a,null,s.a.createElement(V.a,{dataProvider:t})):Object(z.a)(e)})}return Object(z.d)()}},{align:"right",field:`node.${A.n.queryCount}`,name:Ee,sortable:!0,truncateText:!1,mobileOptions:{show:!0},render:e=>null!=e?P()(e).format("0"):Object(z.d)()},{align:"right",field:`node.${A.n.uniqueDomains}`,name:ve,sortable:!0,truncateText:!1,mobileOptions:{show:!0},render:e=>null!=e?P()(e).format("0"):Object(z.d)()},{align:"right",field:`node.${A.n.dnsBytesIn}`,name:xe,sortable:!0,truncateText:!1,mobileOptions:{show:!0},render:e=>null!=e?s.a.createElement(ae.a,{value:e}):Object(z.d)()},{align:"right",field:`node.${A.n.dnsBytesOut}`,name:ke,sortable:!0,truncateText:!1,mobileOptions:{show:!0},render:e=>null!=e?s.a.createElement(ae.a,{value:e}):Object(z.d)()}]),[]),S=Object(r.useMemo)((()=>({field:`node.${y.field}`,direction:y.direction})),[y.direction,y.field]),j=Object(r.useMemo)((()=>s.a.createElement(we,{isPtrIncluded:b,onChange:x})),[b,x]);return s.a.createElement(N.a,{activePage:g,columns:k,dataTestSubj:`table-${Te}`,headerCount:u,headerSupplement:j,headerTitle:be,headerTooltip:ye,headerUnit:fe(u),id:a,itemsPerRow:Ie,isInspect:n,limit:f,loading:i,loadPage:o,onChange:v,pageOfItems:e,setQuerySkip:c,showMorePagesIndicator:l,sorting:S,totalCount:t,updateActivePage:E,updateLimitPagination:h})};Ce.displayName="NetworkDnsTableComponent";const Me=s.a.memo(Ce),Fe=U.i18n.translate("xpack.securitySolution.networkDns.errorSearchDescription",{defaultMessage:"An error has occurred on network dns search"}),De=U.i18n.translate("xpack.securitySolution.hosts.navigation.dns.histogram.errorFetchingDnsData",{defaultMessage:"Failed to query DNS data"});var Ae=a(326),_e=a(376),Ne=a(194);const Re={title:"Top domains by dns.question.registered_domain",description:"Security Solution Network DNS",visualizationType:"lnsXY",state:{visualization:{legend:{isVisible:!0,position:"right"},valueLabels:"hide",fittingFunction:"None",yLeftExtent:{mode:"full"},yRightExtent:{mode:"full"},axisTitlesVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},tickLabelsVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},labelsOrientation:{x:0,yLeft:0,yRight:0},gridlinesVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},preferredSeriesType:"bar",layers:[{layerId:"b1c3efc6-c886-4fba-978f-3b6bb5e7948a",accessors:["2a4d5e20-f570-48e4-b9ab-ff3068919377"],position:"top",seriesType:"bar",showGridlines:!1,layerType:"data",xAccessor:"d1452b87-0e9e-4fc0-a725-3727a18e0b37",splitAccessor:"e8842815-2a45-4c74-86de-c19a391e2424"}]},query:{query:"",language:"kuery"},filters:[{meta:{alias:null,negate:!0,disabled:!1,type:"phrase",key:"dns.question.type",params:{query:"PTR"},indexRefName:"filter-index-pattern-0"},query:{match_phrase:{"dns.question.type":"PTR"}},$state:{store:"appState"}}],datasourceStates:{formBased:{layers:{"b1c3efc6-c886-4fba-978f-3b6bb5e7948a":{columns:{"d1452b87-0e9e-4fc0-a725-3727a18e0b37":{label:"@timestamp",dataType:"date",operationType:"date_histogram",sourceField:"@timestamp",isBucketed:!0,scale:"interval",params:{interval:"auto"}},"2a4d5e20-f570-48e4-b9ab-ff3068919377":{label:Object(Ne.o)("dns.question.registered_domain"),dataType:"number",operationType:"unique_count",scale:"ratio",sourceField:"dns.question.registered_domain",isBucketed:!1},"e8842815-2a45-4c74-86de-c19a391e2424":{label:Object(Ne.n)("dns.question.name"),dataType:"string",operationType:"terms",scale:"ordinal",sourceField:"dns.question.name",isBucketed:!0,params:{size:6,orderBy:{type:"column",columnId:"2a4d5e20-f570-48e4-b9ab-ff3068919377"},orderDirection:"desc",otherBucket:!0,missingBucket:!1}}},columnOrder:["e8842815-2a45-4c74-86de-c19a391e2424","d1452b87-0e9e-4fc0-a725-3727a18e0b37","2a4d5e20-f570-48e4-b9ab-ff3068919377"],incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-b1c3efc6-c886-4fba-978f-3b6bb5e7948a"},{name:"filter-index-pattern-0",type:"index-pattern",id:"{dataViewId}"}]};var Pe;const Le="networkDnsHistogramQuery",Be=Object(de.a)(Me),qe=[{text:"dns.question.registered_domain",value:"dns.question.registered_domain"}],ze={defaultStackByOption:null!==(Pe=qe.find((e=>"dns.question.registered_domain"===e.text)))&&void 0!==Pe?Pe:qe[0],errorMessage:De,histogramType:_e.j.dns,stackByOptions:qe,subtitle:void 0,lensAttributes:Re},$e=({deleteQuery:e,endDate:t,filterQuery:a,indexNames:n,skip:o,startDate:l,setQuery:c,type:u})=>{const d=D.e.dnsSelector(),p=Object(_.b)((e=>d(e).isPtrIncluded));Object(r.useEffect)((()=>()=>{e&&e({id:Le})}),[e]);const m=`networkDnsQuery-${u}`,{toggleStatus:g}=Object(pe.a)(m),[b,f]=Object(r.useState)(o||!g);Object(r.useEffect)((()=>{f(o||!g)}),[o,g]);const[y,{totalCount:h,networkDns:E,pageInfo:v,loadPage:x,id:k,inspect:j,isInspected:O,refetch:w}]=(({endDate:e,filterQuery:t,id:a,indexNames:n,skip:i,startDate:s})=>{const o=Object(r.useMemo)((()=>D.e.dnsSelector()),[]),{activePage:l,sort:c,isPtrIncluded:u,limit:d}=Object(_.a)(o),[p,m]=Object(r.useState)(null),g=Object(r.useCallback)((e=>{m((t=>t?{...t,pagination:Object(le.a)(e,d)}:t))}),[d]),{loading:b,result:f,search:y,refetch:h,inspect:E}=Object(ue.a)({factoryQueryType:A.q.dns,initialResult:{edges:[],totalCount:-1,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1}},errorMessage:Fe,abort:i}),v=Object(r.useMemo)((()=>({id:a,inspect:E,isInspected:!1,loadPage:g,networkDns:f.edges,pageInfo:f.pageInfo,refetch:h,totalCount:f.totalCount})),[a,E,h,f.edges,f.pageInfo,f.totalCount,g]);return Object(r.useEffect)((()=>{m((a=>{const i={...null!=a?a:{},defaultIndex:n,isPtrIncluded:u,factoryQueryType:A.q.dns,filterQuery:Object(oe.a)(t),pagination:Object(le.a)(l,d,!0),sort:c,timerange:{interval:"12h",from:s,to:e}};return F()(a,i)?a:i}))}),[l,n,e,t,d,s,c,u]),Object(r.useEffect)((()=>{!i&&p&&y(p)}),[p,y,i]),[b,v]})({endDate:t,filterQuery:a,id:m,indexNames:n,skip:b,startDate:l}),T=Object(r.useCallback)((e=>{return t=e.text,U.i18n.translate("xpack.securitySolution.network.dns.stackByUniqueSubdomain",{values:{groupByField:t},defaultMessage:"Top domains by {groupByField}"});var t}),[]),I=Object(r.useMemo)((()=>({...ze,title:T})),[T]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(Ae.a,i()({id:Le,isPtrIncluded:p,endDate:t,filterQuery:a,indexNames:n,setQuery:c,showLegend:!0,startDate:l},I)),s.a.createElement(Be,{data:E,fakeTotalCount:Object(S.getOr)(50,"fakeTotalCount",v),id:k,inspect:j,isInspect:O,loading:y,loadPage:x,refetch:w,setQuery:c,setQuerySkip:f,showMorePagesIndicator:Object(S.getOr)(!1,"showMorePagesIndicator",v),totalCount:h,type:u}))};$e.displayName="DnsQueryTabBodyComponent";const Ve=s.a.memo($e);var Ue=a(89);const He=U.i18n.translate("xpack.securitySolution.networkHttpTable.title",{defaultMessage:"HTTP Requests"}),Ge=e=>U.i18n.translate("xpack.securitySolution.networkHttpTable.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {request} other {requests}}"}),Qe=U.i18n.translate("xpack.securitySolution.networkHttpTable.column.methodTitle",{defaultMessage:"Method"}),We=U.i18n.translate("xpack.securitySolution.networkHttpTable.column.domainTitle",{defaultMessage:"Domain"}),Ke=U.i18n.translate("xpack.securitySolution.networkHttpTable.column.pathTitle",{defaultMessage:"Path"}),Ye=U.i18n.translate("xpack.securitySolution.networkHttpTable.column.statusTitle",{defaultMessage:"Status"}),Je=U.i18n.translate("xpack.securitySolution.networkHttpTable.column.lastHostTitle",{defaultMessage:"Last host"}),Xe=U.i18n.translate("xpack.securitySolution.networkHttpTable.column.lastSourceIpTitle",{defaultMessage:"Last source Ip"}),Ze=U.i18n.translate("xpack.securitySolution.networkHttpTable.column.requestsTitle",{defaultMessage:"Requests"}),et=U.i18n.translate("xpack.securitySolution.networkHttpTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),tt=U.i18n.translate("xpack.securitySolution.networkHttpTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"});var at=a(181);const nt=[{text:et,numberOfRow:5},{text:tt,numberOfRow:10}],it=({data:e,fakeTotalCount:t,id:a,isInspect:n,loading:i,loadPage:o,setQuerySkip:l,showMorePagesIndicator:c,totalCount:d,type:p})=>{const m=Object(C.useDispatch)(),g=Object(r.useMemo)((()=>D.e.httpSelector()),[]),{activePage:b,limit:f,sort:y}=Object(_.a)((e=>g(e,p))),h=p===D.c.NetworkType.page?D.c.NetworkTableType.http:D.c.NetworkDetailsTableType.http,E=Object(r.useCallback)((e=>m(D.b.updateNetworkTable({networkType:p,tableType:h,updates:{limit:e}}))),[m,p,h]),v=Object(r.useCallback)((e=>m(D.b.updateNetworkTable({networkType:p,tableType:h,updates:{activePage:e}}))),[m,p,h]),x=Object(r.useCallback)((e=>{null!=e.sort&&e.sort.direction!==y.direction&&m(D.b.updateNetworkTable({networkType:p,tableType:h,updates:{sort:{direction:e.sort.direction}}}))}),[y.direction,m,p,h]),k={field:`node.${A.o.requestCount}`,direction:y.direction},S=Object(r.useMemo)((()=>{return e=h,[{name:Qe,render:({node:{methods:t,path:a}})=>Array.isArray(t)&&t.length>0?Object(at.c)({attrName:"http.request.method",displayCount:3,idPrefix:Object(q.h)(`${e}-table-methods-${a}`),rowItems:t,isAggregatable:!0,fieldType:"keyword"}):Object(z.d)()},{name:We,render:({node:{domains:t,path:a}})=>Array.isArray(t)&&t.length>0?Object(at.c)({attrName:"url.domain",displayCount:3,idPrefix:Object(q.h)(`${e}-table-domains-${a}`),rowItems:t,isAggregatable:!0,fieldType:"keyword"}):Object(z.d)()},{field:`node.${u.e.path}`,name:Ke,render:t=>null!=t?Object(at.b)({attrName:"url.path",idPrefix:Object(q.h)(`${e}-table-path-${t}`),rowItem:t,isAggregatable:!0,fieldType:"keyword"}):Object(z.d)()},{name:Ye,render:({node:{statuses:t,path:a}})=>Array.isArray(t)&&t.length>0?Object(at.c)({attrName:"http.response.status_code",displayCount:3,idPrefix:Object(q.h)(`${e}-table-statuses-${a}`),rowItems:t,isAggregatable:!0,fieldType:"keyword"}):Object(z.d)()},{name:Je,render:({node:{lastHost:t,path:a}})=>null!=t?Object(at.b)({attrName:"host.name",idPrefix:Object(q.h)(`${e}-table-lastHost-${a}`),rowItem:t,isAggregatable:!0,fieldType:"keyword"}):Object(z.d)()},{name:Xe,render:({node:{lastSourceIp:t,path:a}})=>null!=t?Object(at.b)({attrName:"source.ip",idPrefix:Object(q.h)(`${e}-table-lastSourceIp-${a}`),rowItem:t,render:()=>s.a.createElement(Ue.h,{ip:t}),isAggregatable:!0,fieldType:"keyword"}):Object(z.d)()},{align:"right",field:`node.${u.e.requestCount}`,name:Ze,sortable:!0,render:e=>null!=e?P()(e).format("0,000"):Object(z.d)()}];var e}),[h]);return s.a.createElement(N.a,{activePage:b,columns:S,dataTestSubj:`table-${h}`,headerCount:d,headerTitle:He,headerUnit:Ge(d),id:a,itemsPerRow:nt,isInspect:n,limit:f,loading:i,loadPage:o,onChange:x,pageOfItems:e,setQuerySkip:l,showMorePagesIndicator:c,sorting:k,totalCount:t,updateActivePage:v,updateLimitPagination:E})};it.displayName="NetworkHttpTableComponent";const rt=s.a.memo(it),st=U.i18n.translate("xpack.securitySolution.networkHttp.failSearchDescription",{defaultMessage:"Failed to run search on network http"}),ot=Object(de.a)(rt),lt=({endDate:e,filterQuery:t,indexNames:a,skip:n,startDate:i,setQuery:o,type:l})=>{const c=`networkHttpQuery-${l}`,{toggleStatus:u}=Object(pe.a)(c),[d,p]=Object(r.useState)(n||!u);Object(r.useEffect)((()=>{p(n||!u)}),[n,u]);const[m,{id:g,inspect:b,isInspected:f,loadPage:y,networkHttp:h,pageInfo:E,refetch:v,totalCount:x}]=(({endDate:e,filterQuery:t,id:a,indexNames:n,ip:i,skip:s,startDate:o,type:l})=>{const c=Object(r.useMemo)((()=>D.e.httpSelector()),[]),{activePage:u,limit:d,sort:p}=Object(_.a)((e=>c(e,l))),[m,g]=Object(r.useState)(null),b=Object(r.useCallback)((e=>{g((t=>t?{...t,pagination:Object(le.a)(e,d)}:t))}),[d]),{loading:f,result:y,search:h,refetch:E,inspect:v}=Object(ue.a)({factoryQueryType:A.q.http,initialResult:{edges:[],totalCount:-1,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1}},errorMessage:st,abort:s}),x=Object(r.useMemo)((()=>({endDate:e,networkHttp:y.edges,id:a,inspect:v,isInspected:!1,loadPage:b,pageInfo:y.pageInfo,refetch:E,startDate:o,totalCount:y.totalCount})),[e,a,v,E,y.edges,y.pageInfo,y.totalCount,o,b]);return Object(r.useEffect)((()=>{g((a=>{const r={...null!=a?a:{},defaultIndex:n,factoryQueryType:A.q.http,filterQuery:Object(oe.a)(t),ip:i,pagination:Object(le.a)(u,d),sort:p,timerange:{interval:"12h",from:o,to:e}};return F()(a,r)?a:r}))}),[u,n,e,t,i,d,o,p]),Object(r.useEffect)((()=>{!s&&m&&h(m)}),[m,h,s]),[f,x]})({endDate:e,filterQuery:t,id:c,indexNames:a,skip:d,startDate:i,type:l});return s.a.createElement(ot,{data:h,fakeTotalCount:Object(S.getOr)(50,"fakeTotalCount",E),id:g,inspect:b,isInspect:f,loading:m,loadPage:y,refetch:v,setQuery:o,setQuerySkip:p,showMorePagesIndicator:Object(S.getOr)(!1,"showMorePagesIndicator",E),totalCount:x,type:l})};lt.displayName="HttpQueryTabBody";const ct=e=>U.i18n.translate("xpack.securitySolution.networkTopNFlowTable.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {IP} other {IPs}}"}),ut=U.i18n.translate("xpack.securitySolution.networkTopNFlowTable.column.sourceIpTitle",{defaultMessage:"Source IPs"}),dt=U.i18n.translate("xpack.securitySolution.networkTopNFlowTable.column.destinationIpTitle",{defaultMessage:"Destination IPs"}),pt=U.i18n.translate("xpack.securitySolution.networkTopNFlowTable.column.IpTitle",{defaultMessage:"IP"}),mt=U.i18n.translate("xpack.securitySolution.networkTopNFlowTable.column.domainTitle",{defaultMessage:"Domain"}),gt=U.i18n.translate("xpack.securitySolution.networkTopNFlowTable.column.bytesInTitle",{defaultMessage:"Bytes in"}),bt=U.i18n.translate("xpack.securitySolution.networkTopNFlowTable.column.bytesOutTitle",{defaultMessage:"Bytes out"}),ft=U.i18n.translate("xpack.securitySolution.networkTopNFlowTable.column.asTitle",{defaultMessage:"Autonomous system"}),yt=U.i18n.translate("xpack.securitySolution.networkTopNFlowTable.flows",{defaultMessage:"Flows"}),ht=U.i18n.translate("xpack.securitySolution.networkTopNFlowTable.destinationIps",{defaultMessage:"Destination IPs"}),Et=U.i18n.translate("xpack.securitySolution.networkTopNFlowTable.sourceIps",{defaultMessage:"Source IPs"}),vt=U.i18n.translate("xpack.securitySolution.networkTopNFlowTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),xt=U.i18n.translate("xpack.securitySolution.networkTopNFlowTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),kt=e=>e===A.g.source?A.g.destination:A.g.source,St=[{text:vt,numberOfRow:5},{text:xt,numberOfRow:10}],jt=({data:e,fakeTotalCount:t,flowTargeted:a,id:n,isInspect:i,loading:o,loadPage:l,setQuerySkip:c,showMorePagesIndicator:u,totalCount:d,type:p})=>{const m=Object(C.useDispatch)(),g=Object(r.useMemo)((()=>D.e.topNFlowSelector()),[]),{activePage:b,limit:f,sort:y}=Object(_.a)((e=>g(e,p,a))),h=Object(r.useMemo)((()=>((e,t,a)=>{const n=((e,t)=>[{name:pt,render:({node:a})=>{const n=`${e}.ip`,i=Object(S.get)(n,a),r=`${e}.location.geo.country_iso_code[0]`,o=`${e}.geo.country_iso_code`,l=Object(S.get)(r,a),c=Object(q.h)(`${t}-table-${e}-ip-${i}`);return null!=i?s.a.createElement(s.a.Fragment,null,s.a.createElement(B.b,{key:c,dataProvider:{and:[],enabled:!0,id:c,name:i,excluded:!1,kqlQuery:"",queryMatch:{field:n,value:i,operator:$.d}},isAggregatable:!0,fieldType:"ip",render:(t,a,n)=>n.isDragging?s.a.createElement(B.a,null,s.a.createElement(V.a,{dataProvider:t})):s.a.createElement(Ue.h,{ip:i,flowTarget:e})}),l&&s.a.createElement(B.b,{key:`${c}-${l}`,dataProvider:{and:[],enabled:!0,id:`${c}-${l}`,name:l,excluded:!1,kqlQuery:"",queryMatch:{field:o,value:l,operator:$.d}},isAggregatable:!0,fieldType:"geo_point",render:(e,t,a)=>a.isDragging?s.a.createElement(B.a,null,s.a.createElement(V.a,{dataProvider:e})):s.a.createElement(s.a.Fragment,null," ",s.a.createElement(L.a,{countryCode:l})," ",l)})):Object(z.d)()},width:"20%"},{name:mt,render:({node:a})=>{const n=`${e}.domain`,i=`${e}.ip`,r=Object(S.get)(n,a),s=Object(S.get)(i,a);if(Array.isArray(r)&&r.length>0){const e=Object(q.h)(`${t}-table-${s}`);return Object(at.c)({rowItems:r,attrName:n,idPrefix:e,displayCount:1,isAggregatable:!0,fieldType:"keyword"})}return Object(z.d)()},width:"20%"},{name:ft,render:({node:a,cursor:{value:n}})=>{const i=`${e}.autonomous_system`,r=Object(S.get)(i,a);if(null!=r){const a=Object(q.h)(`${t}-table-${e}-ip-${n}`);return s.a.createElement(s.a.Fragment,null,r.name&&Object(at.b)({rowItem:r.name,attrName:`${e}.as.organization.name`,idPrefix:`${a}-name`,isAggregatable:!0,fieldType:"keyword"}),r.number&&s.a.createElement(s.a.Fragment,null," ",Object(at.b)({rowItem:`${r.number}`,attrName:`${e}.as.number`,idPrefix:`${a}-number`,isAggregatable:!0,fieldType:"keyword"})))}return Object(z.d)()},width:"20%"},{align:"right",field:"node.network.bytes_in",name:gt,sortable:!0,render:e=>null!=e?s.a.createElement(ae.a,{value:e}):Object(z.d)()},{align:"right",field:"node.network.bytes_out",name:bt,sortable:!0,render:e=>null!=e?s.a.createElement(ae.a,{value:e}):Object(z.d)()},{align:"right",field:`node.${e}.flows`,name:yt,sortable:!0,render:e=>null!=e?P()(e).format("0,000"):Object(z.d)()},{align:"right",field:`node.${e}.${kt(e)}_ips`,name:e===A.g.source?ht:Et,sortable:!0,render:e=>null!=e?P()(e).format("0,000"):Object(z.d)()}])(e,a);return t===D.c.NetworkType.details?(n.pop(),n):n})(a,p,"networkTopSourceFlow-top-talkers")),[a,p]);let E;const v=a===A.g.source?ut:dt;E=p===D.c.NetworkType.page?a===A.g.source?D.c.NetworkTableType.topNFlowSource:D.c.NetworkTableType.topNFlowDestination:a===A.g.source?D.c.NetworkDetailsTableType.topNFlowSource:D.c.NetworkDetailsTableType.topNFlowDestination;const x=Object(r.useCallback)((e=>{if(null!=e.sort){const t=e.sort.field.split("."),a=Object(S.last)(t),n={field:a,direction:a!==y.field?A.b.desc:e.sort.direction};F()(n,y)||m(D.b.updateNetworkTable({networkType:p,tableType:E,updates:{sort:n}}))}}),[y,m,p,E]),k=Object(r.useMemo)((()=>({field:y.field===A.s.bytes_out||y.field===A.s.bytes_in?`node.network.${y.field}`:`node.${a}.${y.field}`,direction:y.direction})),[a,y]),j=Object(r.useCallback)((e=>m(D.b.updateNetworkTable({networkType:p,tableType:E,updates:{activePage:e}}))),[m,p,E]),O=Object(r.useCallback)((e=>m(D.b.updateNetworkTable({networkType:p,tableType:E,updates:{limit:e}}))),[m,p,E]);return s.a.createElement(N.a,{activePage:b,columns:h,dataTestSubj:`table-${E}`,headerCount:d,headerTitle:v,headerUnit:ct(d),id:n,isInspect:i,itemsPerRow:St,limit:f,loading:o,loadPage:l,onChange:x,pageOfItems:e,setQuerySkip:c,showMorePagesIndicator:u,sorting:k,totalCount:t,updateActivePage:j,updateLimitPagination:O})},Ot=s.a.memo(jt),wt=U.i18n.translate("xpack.securitySolution.networkTopNFlow.failSearchDescription",{defaultMessage:"Failed to run search on network top n flow"}),Tt=Object(de.a)(Ot),It=({endDate:e,filterQuery:t,flowTarget:a,indexNames:n,ip:i,setQuery:o,skip:l,startDate:c,type:u})=>{const d=`networkTopNFlowQuery-${a}-${u}`,{toggleStatus:p}=Object(pe.a)(d),[m,g]=Object(r.useState)(l||!p);Object(r.useEffect)((()=>{g(l||!p)}),[l,p]);const[b,{id:f,inspect:y,isInspected:h,loadPage:E,networkTopNFlow:v,pageInfo:x,refetch:k,totalCount:j}]=(({endDate:e,filterQuery:t,flowTarget:a,id:n,indexNames:i,ip:s,skip:o,startDate:l,type:c})=>{const u=Object(r.useMemo)((()=>D.e.topNFlowSelector()),[]),{activePage:d,limit:p,sort:m}=Object(_.a)((e=>u(e,c,a))),[g,b]=Object(r.useState)(null),f=Object(r.useCallback)((e=>{b((t=>t?{...t,pagination:Object(le.a)(e,p)}:t))}),[p]),{loading:y,result:h,search:E,refetch:v,inspect:x}=Object(ue.a)({factoryQueryType:A.q.topNFlow,initialResult:{edges:[],totalCount:-1,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1}},errorMessage:wt,abort:o}),k=Object(r.useMemo)((()=>({endDate:e,networkTopNFlow:h.edges,id:n,inspect:x,isInspected:!1,loadPage:f,pageInfo:h.pageInfo,refetch:v,startDate:l,totalCount:h.totalCount})),[e,n,x,v,h.edges,h.pageInfo,h.totalCount,l,f]);return Object(r.useEffect)((()=>{b((n=>{const r={...null!=n?n:{},defaultIndex:i,factoryQueryType:A.q.topNFlow,filterQuery:Object(oe.a)(t),flowTarget:a,ip:s,pagination:Object(le.a)(d,p),timerange:{interval:"12h",from:l,to:e},sort:m};return F()(n,r)?n:r}))}),[d,e,t,i,s,p,l,m,a]),Object(r.useEffect)((()=>{!o&&g&&E(g)}),[g,E,o]),[y,k]})({endDate:e,flowTarget:a,filterQuery:t,id:d,indexNames:n,ip:i,skip:m,startDate:c,type:u});return s.a.createElement(Tt,{data:v,fakeTotalCount:Object(S.getOr)(50,"fakeTotalCount",x),flowTargeted:a,id:f,inspect:y,isInspect:h,loading:b,loadPage:E,refetch:k,setQuery:o,setQuerySkip:g,showMorePagesIndicator:Object(S.getOr)(!1,"showMorePagesIndicator",x),totalCount:j,type:u})};It.displayName="IPsQueryTabBody",U.i18n.translate("xpack.securitySolution.networkTls.errorSearchDescription",{defaultMessage:"An error has occurred on network tls search"});const Ct=U.i18n.translate("xpack.securitySolution.networkTls.failSearchDescription",{defaultMessage:"Failed to run search on network tls"});var Mt=a(43),Ft=a.n(Mt),Dt=a(1081),At=a(101);const _t=U.i18n.translate("xpack.securitySolution.network.ipDetails.tlsTable.transportLayerSecurityTitle",{defaultMessage:"Transport Layer Security"}),Nt=e=>U.i18n.translate("xpack.securitySolution.network.ipDetails.tlsTable.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {server certificate} other {server certificates}}"}),Rt=U.i18n.translate("xpack.securitySolution.network.ipDetails.tlsTable.columns.issuerTitle",{defaultMessage:"Issuer"}),Pt=U.i18n.translate("xpack.securitySolution.network.ipDetails.tlsTable.columns.subjectTitle",{defaultMessage:"Subject"}),Lt=U.i18n.translate("xpack.securitySolution.network.ipDetails.tlsTable.columns.sha1FingerPrintTitle",{defaultMessage:"SHA1 fingerprint"}),Bt=U.i18n.translate("xpack.securitySolution.network.ipDetails.tlsTable.columns.ja3FingerPrintTitle",{defaultMessage:"JA3 fingerprint"}),qt=U.i18n.translate("xpack.securitySolution.network.ipDetails.tlsTable.columns.validUntilTitle",{defaultMessage:"Valid until"}),zt=[{text:U.i18n.translate("xpack.securitySolution.network.ipDetails.tlsTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),numberOfRow:5},{text:U.i18n.translate("xpack.securitySolution.network.ipDetails.tlsTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),numberOfRow:10}],$t=({data:e,fakeTotalCount:t,id:a,isInspect:n,loading:i,loadPage:o,setQuerySkip:l,showMorePagesIndicator:c,totalCount:u,type:d})=>{const p=Object(C.useDispatch)(),m=Object(r.useMemo)((()=>D.e.tlsSelector()),[]),{activePage:g,limit:b,sort:f}=Object(_.a)((e=>m(e,d))),y=d===D.c.NetworkType.page?D.c.NetworkTableType.tls:D.c.NetworkDetailsTableType.tls,h=Object(r.useCallback)((e=>p(D.b.updateNetworkTable({networkType:d,tableType:y,updates:{limit:e}}))),[p,d,y]),E=Object(r.useCallback)((e=>p(D.b.updateNetworkTable({networkType:d,tableType:y,updates:{activePage:e}}))),[p,d,y]),v=Object(r.useCallback)((e=>{if(null!=e.sort){const t=e.sort.field.split("."),a={field:Ht(t[t.length-1]),direction:e.sort.direction};F()(a,f)||p(D.b.updateNetworkTable({networkType:d,tableType:y,updates:{sort:a}}))}}),[f,p,d,y]),x=Object(r.useMemo)((()=>("tls-table",[{field:"node",name:Rt,truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:({_id:e,issuers:t})=>Object(at.c)({rowItems:t,attrName:"tls.server.issuer",idPrefix:`tls-table-${e}-table-issuers`,isAggregatable:!0,fieldType:"keyword"})},{field:"node",name:Pt,truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:({_id:e,subjects:t})=>Object(at.c)({rowItems:t,attrName:"tls.server.subject",idPrefix:`tls-table-${e}-table-subjects`,isAggregatable:!0,fieldType:"keyword"})},{field:"node._id",name:Lt,truncateText:!1,mobileOptions:{show:!0},sortable:!0,render:e=>Object(at.b)({rowItem:e,attrName:"tls.server.hash.sha1",idPrefix:`tls-table-${e}-table-sha1`,isAggregatable:!0,fieldType:"keyword"})},{field:"node",name:Bt,truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:({_id:e,ja3:t})=>Object(at.c)({rowItems:t,attrName:"tls.server.ja3s",idPrefix:`tls-table-${e}-table-ja3`,isAggregatable:!0,fieldType:"keyword"})},{field:"node",name:qt,truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:({_id:e,notAfter:t})=>Object(at.c)({rowItems:t,attrName:"tls.server.not_after",idPrefix:`tls-table-${e}-table-notAfter`,render:e=>s.a.createElement(Dt.a,{date:Ft()(new Date(e)).toDate()},s.a.createElement(At.c,{value:new Date(e)}))})}])),[]);return s.a.createElement(N.a,{activePage:g,columns:x,dataTestSubj:`table-${y}`,showMorePagesIndicator:c,headerCount:u,headerTitle:_t,headerUnit:Nt(u),id:a,isInspect:n,itemsPerRow:zt,limit:b,loading:i,loadPage:o,onChange:v,pageOfItems:e,setQuerySkip:l,sorting:Ut(f),totalCount:t,updateActivePage:E,updateLimitPagination:h})};$t.displayName="TlsTableComponent";const Vt=s.a.memo($t),Ut=e=>({field:`node.${e.field}`,direction:e.direction}),Ht=e=>A.r._id,Gt=Object(de.a)(Vt),Qt=({endDate:e,filterQuery:t,flowTarget:a,indexNames:n,ip:i="",setQuery:o,skip:l,startDate:c,type:d})=>{const p=`networkTlsQuery-${d}`,{toggleStatus:m}=Object(pe.a)(p),[g,b]=Object(r.useState)(l||!m);Object(r.useEffect)((()=>{b(l||!m)}),[l,m]);const[f,{id:y,inspect:h,isInspected:E,tls:v,totalCount:x,pageInfo:k,loadPage:j,refetch:O}]=(({endDate:e,filterQuery:t,flowTarget:a,id:n,indexNames:i,ip:s,skip:o,startDate:l,type:c})=>{const d=Object(r.useMemo)((()=>D.e.tlsSelector()),[]),{activePage:p,limit:m,sort:g}=Object(_.a)((e=>d(e,c))),[b,f]=Object(r.useState)(null),y=Object(r.useCallback)((e=>{f((t=>t?{...t,pagination:Object(le.a)(e,m)}:t))}),[m]),{loading:h,result:E,search:v,refetch:x,inspect:k}=Object(ue.a)({factoryQueryType:u.g.tls,initialResult:{edges:[],totalCount:-1,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1}},errorMessage:Ct,abort:o}),S=Object(r.useMemo)((()=>({endDate:e,tls:E.edges,id:n,inspect:k,isInspected:!1,loadPage:y,pageInfo:E.pageInfo,refetch:x,startDate:l,totalCount:E.totalCount})),[e,n,k,x,E.edges,E.pageInfo,E.totalCount,l,y]);return Object(r.useEffect)((()=>{f((n=>{const r={...null!=n?n:{},defaultIndex:i,factoryQueryType:u.g.tls,filterQuery:Object(oe.a)(t),flowTarget:a,ip:s,pagination:Object(le.a)(p,m),timerange:{interval:"12h",from:l,to:e},sort:g};return F()(n,r)?n:r}))}),[p,i,e,t,m,l,g,a,s,n]),Object(r.useEffect)((()=>{!o&&b&&v(b)}),[b,v,o]),[h,S]})({endDate:e,filterQuery:t,flowTarget:a,id:p,indexNames:n,ip:i,skip:g,startDate:c,type:d});return s.a.createElement(Gt,{data:v,id:y,inspect:h,isInspect:E,fakeTotalCount:Object(S.getOr)(50,"fakeTotalCount",k),loading:f,loadPage:j,showMorePagesIndicator:Object(S.getOr)(!1,"showMorePagesIndicator",k),refetch:O,setQuery:o,setQuerySkip:b,totalCount:x,type:d})};Qt.displayName="TlsQueryTabBodyComponent";const Wt=s.a.memo(Qt);var Kt=a(77);U.i18n.translate("xpack.securitySolution.networkUsers.errorSearchDescription",{defaultMessage:"An error has occurred on network users search"});const Yt=U.i18n.translate("xpack.securitySolution.networkUsers.failSearchDescription",{defaultMessage:"Failed to run search on network users"});var Jt=a(174);const Xt=U.i18n.translate("xpack.securitySolution.network.ipDetails.usersTable.usersTitle",{defaultMessage:"Users"}),Zt=e=>U.i18n.translate("xpack.securitySolution.network.ipDetails.usersTable.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {user} other {users}}"}),ea=U.i18n.translate("xpack.securitySolution.network.ipDetails.usersTable.columns.userNameTitle",{defaultMessage:"User"}),ta=U.i18n.translate("xpack.securitySolution.network.ipDetails.usersTable.columns.userIdTitle",{defaultMessage:"ID"}),aa=U.i18n.translate("xpack.securitySolution.network.ipDetails.usersTable.columns.groupNameTitle",{defaultMessage:"Group name"}),na=U.i18n.translate("xpack.securitySolution.network.ipDetails.usersTable.columns.groupIdTitle",{defaultMessage:"Group ID"}),ia=U.i18n.translate("xpack.securitySolution.network.ipDetails.usersTable.columns.documentCountTitle",{defaultMessage:"Document count"}),ra=U.i18n.translate("xpack.securitySolution.network.ipDetails.usersTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),sa=U.i18n.translate("xpack.securitySolution.network.ipDetails.usersTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),oa=D.c.NetworkDetailsTableType.users,la=[{text:ra,numberOfRow:5},{text:sa,numberOfRow:10}],ca="users-table",ua=({data:e,fakeTotalCount:t,flowTarget:a,id:n,isInspect:i,loading:o,loadPage:l,setQuerySkip:c,showMorePagesIndicator:u,totalCount:d,type:p})=>{const m=Object(C.useDispatch)(),g=Object(r.useMemo)((()=>D.e.usersSelector()),[]),{activePage:b,sort:f,limit:y}=Object(_.a)(g),h=Object(r.useCallback)((e=>m(D.b.updateNetworkTable({networkType:p,tableType:oa,updates:{limit:e}}))),[m,p]),E=Object(r.useCallback)((e=>m(D.b.updateNetworkTable({networkType:p,tableType:oa,updates:{activePage:e}}))),[m,p]),v=Object(r.useCallback)((e=>{if(null!=e.sort){const t=e.sort.field.split("."),a={field:ma(t[t.length-1]),direction:e.sort.direction};F()(a,f)||m(D.b.updateNetworkTable({networkType:p,tableType:oa,updates:{sort:a}}))}}),[m,f,p]),x=Object(r.useMemo)((()=>((e,t)=>[{field:"node.user.name",name:ea,truncateText:!1,mobileOptions:{show:!0},sortable:!0,render:a=>Object(at.b)({rowItem:a,attrName:"user.name",idPrefix:`${t}-table-${e}-user`,isAggregatable:!0,fieldType:"keyword"})},{field:"node.user.id",name:ta,truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:a=>Object(at.c)({rowItems:a,attrName:"user.id",idPrefix:`${t}-table-${e}`,isAggregatable:!0,fieldType:"keyword"})},{field:"node.user.groupName",name:aa,truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:a=>Object(at.c)({rowItems:a,attrName:"user.group.name",idPrefix:`${t}-table-${e}`,isAggregatable:!0,fieldType:"keyword"})},{field:"node.user.groupId",name:na,truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:a=>Object(at.c)({rowItems:a,attrName:"user.group.id",idPrefix:`${t}-table-${e}`,isAggregatable:!0,fieldType:"keyword"})},{align:"right",field:"node.user.count",name:ia,truncateText:!1,mobileOptions:{show:!0},sortable:!0,render:e=>Object(z.a)(e)}])(a,ca)),[a,ca]);return s.a.createElement(N.a,{activePage:b,columns:x,dataTestSubj:`table-${oa}`,showMorePagesIndicator:u,headerCount:d,headerTitle:Xt,headerUnit:Zt(d),id:n,isInspect:i,itemsPerRow:la,limit:y,loading:o,loadPage:l,onChange:v,pageOfItems:e,setQuerySkip:c,sorting:pa(f),totalCount:t,updateActivePage:E,updateLimitPagination:h})};ua.displayName="UsersTableComponent";const da=s.a.memo(ua),pa=e=>{switch(e.field){case A.t.name:case A.t.count:return{field:`node.user.${e.field}`,direction:e.direction}}return Object(Jt.a)(e.field)},ma=e=>{switch(e){case A.t.name.valueOf():return A.t.name;case A.t.count.valueOf():return A.t.count;default:return A.t.name}},ga=Object(de.a)(da),ba=({endDate:e,filterQuery:t,flowTarget:a,ip:n,setQuery:i,skip:o,startDate:l,type:c})=>{const d=`networkUsersQuery-${c}`,{toggleStatus:p}=Object(pe.a)(d),[m,g]=Object(r.useState)(o||!p);Object(r.useEffect)((()=>{g(o||!p)}),[o,p]);const[b,{id:f,inspect:y,isInspected:E,networkUsers:v,totalCount:x,pageInfo:k,loadPage:j,refetch:O}]=(({endDate:e,filterQuery:t,flowTarget:a,id:n,ip:i,skip:s,startDate:o})=>{const l=Object(r.useMemo)((()=>D.e.usersSelector()),[]),{activePage:c,sort:d,limit:p}=Object(_.a)(l),{uiSettings:m}=Object(Kt.k)().services,g=m.get(h.S),[b,f]=Object(r.useState)(null),y=Object(r.useCallback)((e=>{f((t=>t?{...t,pagination:Object(le.a)(e,p)}:t))}),[p]),{loading:E,result:v,search:x,refetch:k,inspect:S}=Object(ue.a)({factoryQueryType:u.g.users,initialResult:{edges:[],totalCount:-1,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1}},errorMessage:Yt,abort:s}),j=Object(r.useMemo)((()=>({endDate:e,networkUsers:v.edges,id:n,inspect:S,isInspected:!1,loadPage:y,pageInfo:v.pageInfo,refetch:k,startDate:o,totalCount:v.totalCount})),[e,n,S,k,v.edges,v.pageInfo,v.totalCount,o,y]);return Object(r.useEffect)((()=>{f((n=>{const r={...null!=n?n:{},ip:i,defaultIndex:g,factoryQueryType:u.g.users,filterQuery:Object(oe.a)(t),flowTarget:a,pagination:Object(le.a)(c,p),sort:d,timerange:{interval:"12h",from:o,to:e}};return F()(n,r)?n:r}))}),[c,g,e,t,p,o,d,i,a]),Object(r.useEffect)((()=>{!s&&b&&x(b)}),[b,x,s]),[E,j]})({endDate:e,filterQuery:t,flowTarget:a,id:d,ip:n,skip:m,startDate:l});return s.a.createElement(ga,{data:v,id:f,inspect:y,isInspect:E,flowTarget:a,fakeTotalCount:Object(S.getOr)(50,"fakeTotalCount",k),loading:b,loadPage:j,showMorePagesIndicator:Object(S.getOr)(!1,"showMorePagesIndicator",k),refetch:O,setQuery:i,setQuerySkip:g,totalCount:x,type:c})};ba.displayName="UsersQueryTable"},function(e,t,a){"use strict";a.d(t,"a",(function(){return kt}));var n=a(4),i=a.n(n),r=a(78),s=a(32),o=a(35),l=a(37),c=a(96),u=a(341),d=a(33),p=a.n(d),m=a(162);function g(e,t,a){return t+(e>1?a*(e-1):0)}var b=a(40);function f(){return Object(n.useMemo)((()=>({copyableFieldBackground:b.euiThemeVars.euiColorLightShade,descriptionText:b.euiThemeVars.euiTextColor,full:b.euiThemeVars.euiColorFullShade,graphControls:b.euiThemeVars.euiColorDarkestShade,graphControlsBackground:b.euiThemeVars.euiColorEmptyShade,graphControlsBorderColor:b.euiThemeVars.euiColorLightShade,processBackingFill:`${b.euiThemeVars.euiColorPrimary}${b.darkMode?"1F":"0F"}`,resolverBackground:b.euiThemeVars.euiColorEmptyShade,resolverEdge:b.darkMode?b.euiThemeVars.euiColorLightShade:b.euiThemeVars.euiColorLightestShade,resolverBreadcrumbBackground:b.euiThemeVars.euiColorLightestShade,resolverEdgeText:b.darkMode?b.euiThemeVars.euiColorFullShade:b.euiThemeVars.euiColorDarkShade,triggerBackingFill:`${b.euiThemeVars.euiColorDanger}${b.darkMode?"1F":"0F"}`,pillStroke:b.euiThemeVars.euiColorLightShade,linkColor:b.euiThemeVars.euiLinkColor})),[])}const y=p.a.div.withConfig({displayName:"StyledEdgeLine",componentId:"sc-6iesrv-0"})(["position:absolute;height:",";background-color:",";z-index:10;"],(e=>`${g(e.magFactorX,12,8.5)}px`),(e=>e.resolverEdgeColor)),h=p.a.div.withConfig({displayName:"StyledElapsedTime",componentId:"sc-6iesrv-1"})(["background-color:",";color:",";font-size:",";font-weight:bold;max-width:75%;overflow:hidden;position:absolute;text-overflow:ellipsis;top:50%;white-space:nowrap;left:",";padding:6px 8px;border-radius:999px;transform:translate(-50%,-50%);user-select:none;"],(e=>e.backgroundColor),(e=>e.textColor),(e=>`${e.scaledTypeSize}px`),(e=>`${e.leftPct}%`)),E=i.a.memo((({className:e,edgeLineMetadata:t,startPosition:a,endPosition:n,projectionMatrix:r})=>{const s=Object(m.c)(a,r),l=Object(m.c)(n,r),[c]=r,u=f(),d=null==t?void 0:t.elapsedTime,p=Object(m.d)(s,l),b=g(c,10,7.5),E={left:`${s[0]}px`,top:`${s[1]}px`,width:`${p}px`,transformOrigin:"top left",transform:`translateY(-50%) rotateZ(${Object(m.b)(s,l)}rad)`};let v=50;return c<1&&(v+=1/c*(10*(1-c))),i.a.createElement(y,{className:e,style:E,resolverEdgeColor:u.resolverEdge,magFactorX:c,"data-test-subj":"resolver:graph:edgeline"},d&&i.a.createElement(h,{backgroundColor:u.resolverEdge,leftPct:v,scaledTypeSize:b,textColor:u.resolverEdgeText},i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.elapsedTime",defaultMessage:"{duration} {durationType}",values:{duration:d.duration,durationType:d.durationType}})))}));var v=a(0),x=a(408);const k={timestamp:()=>Date.now(),requestAnimationFrame:(...e)=>window.requestAnimationFrame(...e),cancelAnimationFrame:(...e)=>window.cancelAnimationFrame(...e),ResizeObserver:a.n(x).a,writeTextToClipboard:e=>navigator.clipboard.writeText(e),getBoundingClientRect:e=>e.getBoundingClientRect()},S=Object(n.createContext)(k),j=p()(s.EuiDescriptionList).withConfig({displayName:"StyledDescriptionList",componentId:"sc-254p1f-0"})(["&.euiDescriptionList.euiDescriptionList--column dt.euiDescriptionList__title.desc-title{max-width:10em;}"]),O=p()("h4").withConfig({displayName:"StyledTitle",componentId:"sc-254p1f-1"})(["overflow-wrap:break-word;"]),w=p()(s.EuiBreadcrumbs).withConfig({displayName:"ThemedBreadcrumbs",componentId:"sc-254p1f-2"})(["&.euiBreadcrumbs{background-color:",";color:",";padding:1em;border-radius:5px;}& .euiBreadcrumbSeparator{background:",";}"],(e=>e.background),(e=>e.text),(e=>e.text)),T=p.a.div.withConfig({displayName:"StyledButtonTextContainer",componentId:"sc-254p1f-3"})(["align-items:center;display:flex;flex-direction:row;"]),I=p.a.div.withConfig({displayName:"StyledAnalyzedEvent",componentId:"sc-254p1f-4"})(["color:",";font-size:10.5px;font-weight:700;"],(e=>e.color)),C=p.a.div.withConfig({displayName:"StyledLabelTitle",componentId:"sc-254p1f-5"})([""]),M=p.a.div.withConfig({displayName:"StyledLabelContainer",componentId:"sc-254p1f-6"})(["display:inline-block;flex:3;min-width:0;",",","{overflow:hidden;text-align:left;text-overflow:ellipsis;white-space:nowrap;}"],I,C),F=p()(s.EuiCode).withConfig({displayName:"BoldCode",componentId:"sc-254p1f-7"})(["&.euiCodeBlock code.euiCodeBlock__code{font-weight:900;}"]),D=p()("time").withConfig({displayName:"StyledTime",componentId:"sc-254p1f-8"})(["display:inline-block;text-align:start;"]);function A(){const e=Object(r.useSelector)(c.E);return Object(n.useMemo)((()=>{const t=`${e}-symbols`;return{processNodeLabel:`${t}-nodeSymbol`,runningProcessCube:`${t}-runningCube`,runningTriggerCube:`${t}-runningTriggerCube`,terminatedProcessCube:`${t}-terminatedCube`,terminatedTriggerCube:`${t}-terminatedTriggerCube`,processCubeActiveBacking:`${t}-activeBacking`,loadingCube:`${t}-loadingCube`,errorCube:`${t}-errorCube`}}),[e])}function _(e,t){const a=A(),i=f(),r=Object(n.useMemo)((()=>({runningProcessCube:{backingFill:i.processBackingFill,cubeSymbol:`#${a.runningProcessCube}`,descriptionFill:i.descriptionText,descriptionText:v.i18n.translate("xpack.securitySolution.endpoint.resolver.runningProcess",{defaultMessage:"Running Process"}),isLabelFilled:!0,labelButtonFill:"primary",strokeColor:b.euiThemeVars.euiColorPrimary},loadingCube:{backingFill:i.processBackingFill,cubeSymbol:`#${a.loadingCube}`,descriptionFill:i.descriptionText,descriptionText:v.i18n.translate("xpack.securitySolution.endpoint.resolver.loadingProcess",{defaultMessage:"Loading Process"}),isLabelFilled:!1,labelButtonFill:"primary",strokeColor:b.euiThemeVars.euiColorPrimary},errorCube:{backingFill:i.processBackingFill,cubeSymbol:`#${a.errorCube}`,descriptionFill:i.descriptionText,descriptionText:v.i18n.translate("xpack.securitySolution.endpoint.resolver.errorProcess",{defaultMessage:"Error Process"}),isLabelFilled:!1,labelButtonFill:"primary",strokeColor:b.euiThemeVars.euiColorPrimary},runningTriggerCube:{backingFill:i.triggerBackingFill,cubeSymbol:`#${a.runningTriggerCube}`,descriptionFill:i.descriptionText,descriptionText:v.i18n.translate("xpack.securitySolution.endpoint.resolver.runningTrigger",{defaultMessage:"Running Trigger"}),isLabelFilled:!0,labelButtonFill:"danger",strokeColor:b.euiThemeVars.euiColorDanger},terminatedProcessCube:{backingFill:i.processBackingFill,cubeSymbol:`#${a.terminatedProcessCube}`,descriptionFill:i.descriptionText,descriptionText:v.i18n.translate("xpack.securitySolution.endpoint.resolver.terminatedProcess",{defaultMessage:"Terminated Process"}),isLabelFilled:!1,labelButtonFill:"primary",strokeColor:b.euiThemeVars.euiColorPrimary},terminatedTriggerCube:{backingFill:i.triggerBackingFill,cubeSymbol:`#${a.terminatedTriggerCube}`,descriptionFill:i.descriptionText,descriptionText:v.i18n.translate("xpack.securitySolution.endpoint.resolver.terminatedTrigger",{defaultMessage:"Terminated Trigger"}),isLabelFilled:!1,labelButtonFill:"danger",strokeColor:b.euiThemeVars.euiColorDanger}})),[a,i]);return"terminated"===e?t?r.terminatedTriggerCube:r[N.processTerminated]:"running"===e?t?r[N.processCausedAlert]:r[N.processRan]:"error"===e?r[N.processError]:r[N.processLoading]}const N={processCreated:"runningProcessCube",processRan:"runningProcessCube",processTerminated:"terminatedProcessCube",unknownProcessEvent:"runningProcessCube",processCausedAlert:"runningTriggerCube",processLoading:"loadingCube",processError:"errorCube",unknownEvent:"runningProcessCube"},R=Object(n.memo)((function({className:e,size:t="2.15em",state:a,isOrigin:n,"data-test-subj":r}){const{cubeSymbol:s,strokeColor:o}=_(a,!1),{processCubeActiveBacking:l}=A();return i.a.createElement(P,{className:e,width:t,height:t,viewBox:"0 0 34 34","data-test-subj":r,isOrigin:n,style:{verticalAlign:"middle"}},i.a.createElement("desc",null,v.i18n.translate("xpack.securitySolution.resolver.node_icon",{defaultMessage:"{state, select, running {Running Process} terminated {Terminated Process} loading {Loading Process} error {Error Process}}",values:{state:a}})),n&&i.a.createElement("use",{xlinkHref:`#${l}`,fill:"transparent",x:0,y:-1,stroke:o,strokeDashoffset:0,width:"100%",height:"100%"}),i.a.createElement("use",{role:"presentation",xlinkHref:s,x:5.25,y:4.25,width:"70%",height:"70%",opacity:"1",className:"cube"}))})),P=p.a.svg.withConfig({displayName:"StyledSVG",componentId:"sc-14ztjy8-0"})(["margin-right:",";"],(e=>e.isOrigin?"0.15em":0)),L=i.a.memo((function({children:e}){return i.a.createElement(i.a.Fragment,null,i.a.Children.map(e,(e=>{if("string"==typeof e){const t=e.split(/\b/);return t.length<2?t[0]:[t[0],...t.splice(1).reduce((function(e,t){return[...e,t,i.a.createElement("wbr",null)]}),[])]}return e})))})),B=p()(s.EuiRange).withConfig({displayName:"StyledEuiRange",componentId:"sc-1wdm067-0"})(["& .euiRangeTrack:after{left:-65px;transform:rotate(90deg);}"]),q=p.a.div.withConfig({displayName:"StyledGraphControlsColumn",componentId:"sc-1wdm067-1"})(["display:flex;flex-direction:column;&:not(last-of-type){margin-right:5px;}"]),z=p()(s.EuiDescriptionListTitle).withConfig({displayName:"StyledEuiDescriptionListTitle",componentId:"sc-1wdm067-2"})(["text-transform:uppercase;max-width:25%;"]),$=p()(s.EuiDescriptionListDescription).withConfig({displayName:"StyledEuiDescriptionListDescription",componentId:"sc-1wdm067-3"})(["min-width:75%;width:75%;"]),V=p()(s.EuiButtonIcon).withConfig({displayName:"StyledEuiButtonIcon",componentId:"sc-1wdm067-4"})(["background-color:",";color:",";border-color:",";border-width:1px;border-style:solid;border-radius:4px;width:40px;height:40px;&:not(last-of-type){margin-bottom:7px;}"],(e=>e.$backgroundColor),(e=>e.$iconColor),(e=>e.$borderColor)),U=p.a.div.withConfig({displayName:"StyledGraphControls",componentId:"sc-1wdm067-5"})(["display:flex;flex-direction:row;position:absolute;top:5px;right:5px;background-color:transparent;color:",";.zoom-controls{display:flex;flex-direction:column;align-items:center;padding:5px 0px;.zoom-slider{width:20px;height:150px;margin:5px 0px 2px 0px;input[type='range']{width:150px;height:20px;transform-origin:75px 75px;transform:rotate(-90deg);}}}.panning-controls{text-align:center;}"],(e=>e.$iconColor)),H=i.a.memo((({className:e})=>{const t=Object(r.useDispatch)(),a=Object(r.useSelector)(c.H),{timestamp:o}=Object(n.useContext)(S),[l,u]=Object(n.useState)(null),d=f(),p=Object(n.useCallback)((e=>{u(e===l?null:e)}),[u,l]),m=Object(n.useCallback)((()=>u(null)),[]),g=Object(n.useCallback)((e=>{const a=parseFloat(e.target.value);!1===isNaN(a)&&t({type:"userSetZoomLevel",payload:a})}),[t]),b=Object(n.useCallback)((()=>{t({type:"userSetPositionOfCamera",payload:[0,0]})}),[t]),y=Object(n.useCallback)((()=>{t({type:"userClickedZoomOut"})}),[t]),h=Object(n.useCallback)((()=>{t({type:"userClickedZoomIn"})}),[t]),[E,x,k,j]=Object(n.useMemo)((()=>[[0,1],[1,0],[0,-1],[-1,0]].map((e=>()=>{const a={type:"userNudgedCamera",payload:{direction:e,time:o()}};t(a)}))),[t,o]);return i.a.createElement(U,{className:e,$iconColor:d.graphControls,"data-test-subj":"resolver:graph-controls"},i.a.createElement(q,null,i.a.createElement(G,{closePopover:m,isOpen:"schemaInfo"===l,setActivePopover:p}),i.a.createElement(Q,{closePopover:m,isOpen:"nodeLegend"===l,setActivePopover:p})),i.a.createElement(q,null,i.a.createElement(s.EuiPanel,{className:"panning-controls",paddingSize:"none",hasBorder:!0},i.a.createElement("div",{className:"panning-controls-top"},i.a.createElement("button",{className:"north-button","data-test-subj":"resolver:graph-controls:north-button",title:v.i18n.translate("xpack.securitySolution.resolver.graphControls.north",{defaultMessage:"North"}),onClick:E},i.a.createElement(s.EuiIcon,{type:"arrowUp"}))),i.a.createElement("div",{className:"panning-controls-middle"},i.a.createElement("button",{className:"west-button","data-test-subj":"resolver:graph-controls:west-button",title:v.i18n.translate("xpack.securitySolution.resolver.graphControls.west",{defaultMessage:"West"}),onClick:j},i.a.createElement(s.EuiIcon,{type:"arrowLeft"})),i.a.createElement("button",{className:"center-button","data-test-subj":"resolver:graph-controls:center-button",title:v.i18n.translate("xpack.securitySolution.resolver.graphControls.center",{defaultMessage:"Center"}),onClick:b},i.a.createElement(s.EuiIcon,{type:"bullseye"})),i.a.createElement("button",{className:"east-button","data-test-subj":"resolver:graph-controls:east-button",title:v.i18n.translate("xpack.securitySolution.resolver.graphControls.east",{defaultMessage:"East"}),onClick:x},i.a.createElement(s.EuiIcon,{type:"arrowRight"}))),i.a.createElement("div",{className:"panning-controls-bottom"},i.a.createElement("button",{className:"south-button","data-test-subj":"resolver:graph-controls:south-button",title:v.i18n.translate("xpack.securitySolution.resolver.graphControls.south",{defaultMessage:"South"}),onClick:k},i.a.createElement(s.EuiIcon,{type:"arrowDown"})))),i.a.createElement(s.EuiPanel,{className:"zoom-controls",paddingSize:"none",hasBorder:!0},i.a.createElement("button",{title:v.i18n.translate("xpack.securitySolution.resolver.graphControls.zoomIn",{defaultMessage:"Zoom In"}),"data-test-subj":"resolver:graph-controls:zoom-in",onClick:h},i.a.createElement(s.EuiIcon,{type:"plusInCircle"})),i.a.createElement(B,{className:"zoom-slider","data-test-subj":"resolver:graph-controls:zoom-slider",min:0,max:1,step:.01,value:a,onChange:g}),i.a.createElement("button",{title:v.i18n.translate("xpack.securitySolution.resolver.graphControls.zoomOut",{defaultMessage:"Zoom Out"}),"data-test-subj":"resolver:graph-controls:zoom-out",onClick:y},i.a.createElement(s.EuiIcon,{type:"minusInCircle"})))))})),G=({closePopover:e,setActivePopover:t,isOpen:a})=>{var o,l,u;const d=f(),p=Object(r.useSelector)(c.G),m=Object(n.useCallback)((()=>t("schemaInfo")),[t]),g=v.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaInfoButtonTitle",{defaultMessage:"Schema Information"}),b=v.i18n.translate("xpack.securitySolution.resolver.graphControls.unknownSchemaValue",{defaultMessage:"Unknown"});return i.a.createElement(s.EuiPopover,{button:i.a.createElement(V,{"data-test-subj":"resolver:graph-controls:schema-info-button",size:"m",title:g,"aria-label":g,onClick:m,iconType:"iInCircle",$backgroundColor:d.graphControlsBackground,$iconColor:d.graphControls,$borderColor:d.graphControlsBorderColor}),isOpen:a,closePopover:e,anchorPosition:"leftCenter"},i.a.createElement(s.EuiPopoverTitle,{style:{textTransform:"uppercase"}},v.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaInfoTitle",{defaultMessage:"process tree"}),i.a.createElement(s.EuiIconTip,{content:v.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaInfoTooltip",{defaultMessage:"These are the fields used to create the process tree"}),position:"right"})),i.a.createElement("div",{style:{maxWidth:"268px"}},i.a.createElement(j,{"data-test-subj":"resolver:graph-controls:schema-info",type:"column",align:"left",compressed:!0},i.a.createElement(i.a.Fragment,null,i.a.createElement(z,{"data-test-subj":"resolver:graph-controls:schema-info:title",style:{width:"30%"}},v.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaSource",{defaultMessage:"source"})),i.a.createElement($,{"data-test-subj":"resolver:graph-controls:schema-info:description",style:{width:"70%"}},i.a.createElement(L,null,null!==(o=null==p?void 0:p.dataSource)&&void 0!==o?o:b)),i.a.createElement(z,{"data-test-subj":"resolver:graph-controls:schema-info:title",style:{width:"30%"}},v.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaID",{defaultMessage:"id"})),i.a.createElement($,{"data-test-subj":"resolver:graph-controls:schema-info:description",style:{width:"70%"}},i.a.createElement(L,null,null!==(l=null==p?void 0:p.schema.id)&&void 0!==l?l:b)),i.a.createElement(z,{"data-test-subj":"resolver:graph-controls:schema-info:title",style:{width:"30%"}},v.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaEdge",{defaultMessage:"edge"})),i.a.createElement($,{"data-test-subj":"resolver:graph-controls:schema-info:description",style:{width:"70%"}},i.a.createElement(L,null,null!==(u=null==p?void 0:p.schema.parent)&&void 0!==u?u:b))))))},Q=({closePopover:e,setActivePopover:t,isOpen:a})=>{const r=Object(n.useCallback)((()=>t("nodeLegend")),[t]),o=f(),l=v.i18n.translate("xpack.securitySolution.resolver.graphControls.nodeLegendButtonTitle",{defaultMessage:"Node Legend"});return i.a.createElement(s.EuiPopover,{button:i.a.createElement(V,{"data-test-subj":"resolver:graph-controls:node-legend-button",size:"m",title:l,"aria-label":l,onClick:r,iconType:"node",$backgroundColor:o.graphControlsBackground,$iconColor:o.graphControls,$borderColor:o.graphControlsBorderColor}),isOpen:a,closePopover:e,anchorPosition:"leftCenter"},i.a.createElement(s.EuiPopoverTitle,{style:{textTransform:"uppercase"}},v.i18n.translate("xpack.securitySolution.resolver.graphControls.nodeLegend",{defaultMessage:"legend"})),i.a.createElement("div",{style:{maxWidth:"212px"}},i.a.createElement(j,{"data-test-subj":"resolver:graph-controls:node-legend",type:"column",align:"left",compressed:!0},i.a.createElement(i.a.Fragment,null,i.a.createElement(z,{"data-test-subj":"resolver:graph-controls:node-legend:title",style:{width:"20% "}},i.a.createElement(R,{size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"running"})),i.a.createElement($,{"data-test-subj":"resolver:graph-controls:node-legend:description",style:{width:"80%",lineHeight:"2.2em"}},i.a.createElement(L,null,v.i18n.translate("xpack.securitySolution.resolver.graphControls.runningProcessCube",{defaultMessage:"Running Process"}))),i.a.createElement(z,{"data-test-subj":"resolver:graph-controls:node-legend:title",style:{width:"20% "}},i.a.createElement(R,{size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"terminated"})),i.a.createElement($,{"data-test-subj":"resolver:graph-controls:node-legend:description",style:{width:"80%",lineHeight:"2.2em"}},i.a.createElement(L,null,v.i18n.translate("xpack.securitySolution.resolver.graphControls.terminatedProcessCube",{defaultMessage:"Terminated Process"}))),i.a.createElement(z,{"data-test-subj":"resolver:graph-controls:node-legend:title",style:{width:"20% "}},i.a.createElement(R,{size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"loading"})),i.a.createElement($,{"data-test-subj":"resolver:graph-controls:node-legend:description",style:{width:"80%",lineHeight:"2.2em"}},i.a.createElement(L,null,v.i18n.translate("xpack.securitySolution.resolver.graphControls.currentlyLoadingCube",{defaultMessage:"Loading Process"}))),i.a.createElement(z,{"data-test-subj":"resolver:graph-controls:node-legend:title",style:{width:"20% "}},i.a.createElement(R,{size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"error"})),i.a.createElement($,{"data-test-subj":"resolver:graph-controls:node-legend:description",style:{width:"80%",lineHeight:"2.2em"}},i.a.createElement(L,null,v.i18n.translate("xpack.securitySolution.resolver.graphControls.errorCube",{defaultMessage:"Error Process"})))))))};function W(e){return function(e,t){const a=Object(l.useHistory)(),i=Object(n.useCallback)((t=>{t.defaultPrevented||0===t.button&&(t.currentTarget instanceof HTMLAnchorElement&&""!==t.currentTarget.target&&"_self"!==t.currentTarget.target||t.metaKey||t.altKey||t.ctrlKey||t.shiftKey||(t.preventDefault(),a.push(e)))}),[a,t,e]);return{href:a.createHref(e),onClick:i}}({search:Object(r.useSelector)((t=>c.D(t)(e)))})}var K=a(234);const Y=i.a.memo((({className:e,nodeID:t,nodeStats:a})=>{const r=Object(n.useMemo)((()=>void 0===a?[]:Object.entries(a.byCategory).map((([e,t])=>({prefix:i.a.createElement(K.a,{count:t||0}),category:e})))),[a]);return void 0===r?null:i.a.createElement("ul",{className:`${e} options`,"aria-describedby":t},r.sort(((e,t)=>e.category.localeCompare(t.category))).map((e=>i.a.createElement(J,{pill:e,nodeID:t,key:e.category}))))})),J=({pill:e,nodeID:t})=>{const a=W({panelView:"nodeEventsInCategory",panelParameters:{nodeID:t,eventCategory:e.category}}),{pillStroke:s,resolverBackground:o}=f(),l=Object(n.useMemo)((()=>({border:`1.5px solid ${s}`,backgroundColor:o})),[s,o]),c=Object(r.useDispatch)(),{timestamp:u}=Object(n.useContext)(S),d=Object(n.useCallback)((e=>{a.onClick(e),c({type:"userSelectedResolverNode",payload:{nodeID:t,time:u()}})}),[u,a,c,t]);return i.a.createElement("li",{className:"item","data-test-subj":"resolver:map:node-submenu-item",style:l,key:e.category},i.a.createElement("button",{type:"button",className:"kbn-resetFocusState",onClick:d},e.prefix," ",e.category))},X=p()(Y).withConfig({displayName:"NodeSubMenu",componentId:"sc-1p5k68h-0"})(["margin:2px 0 0 0;padding:0;border:none;display:flex;flex-flow:column;z-index:auto;&.options{font-size:0.8rem;display:flex;flex-flow:row wrap;background:transparent;position:absolute;top:4.5em;overflow-x:visible;width:24ch;z-index:auto;}&.options::after{position:absolute;content:'';width:100%;height:100%;left:0;top:0;z-index:20;backdrop-filter:blur(2px);pointer-events:none;}&.options .item{margin:0.25ch 0.35ch 0.35ch 0;padding:0.35em 0.5em;height:fit-content;width:fit-content;border-radius:2px;line-height:0.8;z-index:40;}&.options .item button{appearance:none;height:fit-content;width:fit-content;line-height:0.8;outline-style:none;border-color:transparent;box-shadow:none;}&.options .item button:focus{outline-style:none;border-color:transparent;box-shadow:none;text-decoration:underline;}&.options .item button:active{transform:scale(0.95);}"]),Z=p.a.div.withConfig({displayName:"StyledMapContainer",componentId:"sc-1p5k68h-1"})(["&,.resolver-graph{display:flex;flex-grow:1;}.loading-container{display:flex;align-items:center;justify-content:center;flex-grow:1;}min-height:652px;position:relative;overflow:hidden;contain:strict;background-color:",";"],(e=>e.backgroundColor)),ee=p()(s.EuiPanel).withConfig({displayName:"StyledPanel",componentId:"sc-1p5k68h-2"})(["position:absolute;left:0;top:0;bottom:0;overflow:auto;width:25em;max-width:50%;border-radius:0;border-top:none;"]),te=p.a.div.withConfig({displayName:"GraphContainer",componentId:"sc-1p5k68h-3"})(["display:flex;flex-grow:1;contain:layout;position:relative;z-index:0;"]),ae=p()(s.EuiCallOut).withConfig({displayName:"LimitWarningsEuiCallOut",componentId:"sc-1p5k68h-4"})(["flex-flow:row wrap;display:block;align-items:baseline;margin-top:1em;& .euiCallOutHeader{display:inline;margin-right:0.25em;}& .euiText{display:inline;}& .euiText p{display:inline;}"]),ne=r.useDispatch;var ie=a(144),re=a(151),se=a(222);const oe=p.a.div.withConfig({displayName:"StyledActionsContainer",componentId:"sc-14u1iy3-0"})(["background-color:transparent;color:",";display:flex;flex-flow:column;font-size:",";left:20.9%;line-height:140%;padding:0.25rem 0 0 0.1rem;position:absolute;top:",";width:auto;pointer-events:all;"],(e=>e.color),(e=>`${e.fontSize}px`),(e=>`${e.topPct}%`)),le=p.a.div.withConfig({displayName:"StyledDescriptionText",componentId:"sc-14u1iy3-1"})(["background-color:",";color:",";display:",";font-size:0.8rem;font-weight:bold;letter-spacing:-0.01px;line-height:1;margin:0;padding:4px 0 0 2px;text-align:left;text-transform:uppercase;width:fit-content;z-index:45;"],(e=>e.backgroundColor),(e=>e.color),(e=>e.isDisplaying?"block":"none")),ce=p.a.span.withConfig({displayName:"StyledEuiButtonContent",componentId:"sc-14u1iy3-2"})(["padding:",";"],(e=>e.isShowingIcon?"0px":"0 12px")),ue=p.a.g.withConfig({displayName:"StyledOuterGroup",componentId:"sc-14u1iy3-3"})(["fill:none;pointer-events:visiblePainted;",""],(e=>e.isNodeLoading&&"\n    & .cube {\n    animation-name: pulse;\n    /**\n     * his is a multiple of .6 so it can match up with the EUI button's loading spinner\n     * which is (0.6s). Using .6 here makes it a bit too fast.\n     */\n    animation-duration: 1.8s;\n    animation-delay: 0;\n    animation-direction: normal;\n    animation-iteration-count: infinite;\n    animation-timing-function: linear;\n  }\n\n  /**\n   * Animation loading state of the cube.\n   */\n  @keyframes pulse {\n    0% {\n      opacity: 1;\n    }\n    50% {\n      opacity: 0.35;\n    }\n    100% {\n      opacity: 1;\n    }\n  }\n  ")),de=i.a.memo((({className:e,position:t,node:a,nodeID:l,projectionMatrix:u,timeAtRender:d})=>{const p=`resolver:${Object(r.useSelector)(c.E)}`,b=A(),{timestamp:y}=Object(n.useContext)(S),[h,E]=Object(m.c)(t,u),[x]=u,k=Object(r.useSelector)(c.a),j=Object(r.useSelector)(c.I),O=Object(r.useSelector)(c.y),w=Object(r.useSelector)((e=>c.x(e)(l))),T=Object(n.useCallback)((e=>Object(s.htmlIdGenerator)(p)(`${e}:node`)),[p]),I=Object(r.useSelector)((e=>c.c(e)(l))),C=Object(r.useSelector)((e=>c.b(e)(d)(l))),M=x>.8,F=x>=.55,D=(M?3.5:F?1:21)*x+5,N=360*(M?-.147413:-.147413-.08*(x-.5))*x,R=120*(M?-.53684:.2*-x*(1-x)/x-.53684)*x,P=Object(n.useMemo)((()=>({left:`${h+N}px`,top:`${E+R}px`,width:360*x+"px",height:120*x+"px"})),[h,x,N,R,E]),L=g(x,18.75,12.5),B=i.a.createRef(),q=f(),z=Object(r.useSelector)((e=>c.v(e)(l))),$="loading"===z,{backingFill:V,cubeSymbol:U,descriptionText:H,isLabelFilled:G,labelButtonFill:Q,strokeColor:K}=_(z,!1),Y=Object(s.htmlIdGenerator)("resolver")(`${l}:label`),J=l===k,Z=l===j,ee=l===O,te=ne(),ae=W({panelView:"nodeDetail",panelParameters:{nodeID:l}}),de=Object(n.useCallback)((()=>{te({type:"userFocusedOnResolverNode",payload:{nodeID:l,time:y()}})}),[te,l,y]),pe=Object(n.useCallback)((e=>{var t;null!==(t=B.current)&&void 0!==t&&t.beginElement&&B.current.beginElement(),"error"===z?te({type:"userReloadedResolverNode",payload:l}):(te({type:"userSelectedResolverNode",payload:{nodeID:l,time:y()}}),ae.onClick(e))}),[B,te,l,ae,z,y]),me=Object(r.useSelector)((e=>c.J(e)(a))),ge=ie.c(a),be=Object(r.useSelector)((e=>se.a(c.u(e)(String(a.id))))),fe=Object(n.useMemo)((()=>void 0!==be?re.l(be):ge),[be,ge]);return i.a.createElement("div",{"data-test-subj":"resolver:node","data-test-resolver-node-id":l,className:`${e} kbn-resetFocusState`,role:"treeitem","aria-level":null===I?void 0:I,"aria-flowto":null===C?void 0:T(C),"aria-labelledby":Y,"aria-haspopup":"true","aria-current":J?"true":void 0,"aria-selected":Z?"true":void 0,style:P,id:T(l),tabIndex:-1},i.a.createElement("svg",{viewBox:"-15 -15 90 30",preserveAspectRatio:"xMidYMid meet",onClick:e=>{de(),pe(e)},role:"img","aria-labelledby":Y,fill:"none",style:{display:"block",width:"100%",height:"100%",position:"absolute",top:"0",left:"0",outline:"transparent",border:"none",pointerEvents:"none",zIndex:30}},i.a.createElement(ue,{isNodeLoading:$},i.a.createElement("use",{xlinkHref:`#${b.processCubeActiveBacking}`,fill:V,x:-15.35,y:-15.35,stroke:K,width:22.5,height:22.5,className:"backing"}),ee&&i.a.createElement("use",{xlinkHref:`#${b.processCubeActiveBacking}`,fill:"transparent",x:-15.35,y:-15.35,stroke:K,strokeOpacity:.35,strokeDashoffset:0,width:22.5,height:22.5,className:"origin"}),i.a.createElement("use",{role:"presentation",xlinkHref:U,x:-11.5,y:-11.5,width:15,height:15,opacity:"1",className:"cube"},i.a.createElement("animateTransform",{attributeType:"XML",attributeName:"transform",type:"scale",values:"1 1; 1 .83; 1 .8; 1 .83; 1 1",dur:"0.2s",repeatCount:"1",className:"squish",ref:B})))),i.a.createElement(oe,{color:q.full,fontSize:L,topPct:D},i.a.createElement(le,{backgroundColor:q.resolverBackground,color:q.descriptionText,isDisplaying:F,"data-test-subj":"resolver:node:description"},i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.processDescription",defaultMessage:"{isEventBeingAnalyzed, select, true {Analyzed Event · {descriptionText}} false {{descriptionText}}}",values:{isEventBeingAnalyzed:ee,descriptionText:H}})),i.a.createElement("div",{className:"euiButton euiButton--small",id:Y,onClick:pe,onFocus:de,tabIndex:-1,style:{backgroundColor:q.resolverBackground,alignSelf:"flex-start",padding:0,zIndex:45}},i.a.createElement(s.EuiButton,{iconSide:$?"right":"left",isLoading:$,color:Q,fill:G,iconType:"error"===z?"refresh":"",size:"s",style:{maxHeight:`${Math.min(26+3*x,32)}px`,maxWidth:(M?400:210*x)+"px"},tabIndex:-1,title:fe,"data-test-subj":"resolver:node:primary-button","data-test-resolver-node-id":l},i.a.createElement(ce,{isShowingIcon:"loading"===z||"error"===z,className:"eui-textTruncate","data-test-subj":"euiButton__text"},v.i18n.translate("xpack.securitySolution.resolver.node_button_name",{defaultMessage:"{nodeState, select, error {Reload {nodeName}} other {{nodeName}}}",values:{nodeState:z,nodeName:fe}})))),i.a.createElement(s.EuiFlexGroup,{justifyContent:"flexStart",gutterSize:"xs",style:{alignSelf:"flex-start",background:q.resolverBackground,display:M?"flex":"none",margin:"2px 0 0 0",padding:0}},i.a.createElement(s.EuiFlexItem,{grow:!1,className:"related-dropdown"},null!==me&&me>0&&i.a.createElement(X,{buttonFill:q.resolverBackground,nodeStats:w,nodeID:l})))))})),pe=p()(de).withConfig({displayName:"ProcessEventDot",componentId:"sc-14u1iy3-4"})(["position:absolute;text-align:left;font-size:10px;user-select:none;box-sizing:border-box;border-radius:10%;white-space:nowrap;will-change:left,top,width,height;min-width:280px;min-height:90px;overflow-y:visible;pointer-events:none;z-index:auto;& .backing{stroke-dasharray:500;stroke-dashoffset:500;fill-opacity:0;}&:hover:not([aria-current]) .backing{transition-property:fill-opacity;transition-duration:0.25s;fill-opacity:1;}&[aria-current] .backing{transition-property:stroke-dashoffset;transition-duration:1s;stroke-dashoffset:0;}& .euiButton{width:fit-content;}& .euiSelectableList-bordered{border-top-right-radius:0px;border-top-left-radius:0px;}& .euiSelectableListItem{background-color:black;}& .euiSelectableListItem path{fill:white;}& .euiSelectableListItem__text{color:white;}"]);var me=a(41);function ge(){const e=Object(r.useSelector)(c.E);return Object(n.useMemo)((()=>{const t=`${e}-symbols`;return{runningProcessCube:`${t}-psRunningProcessCube`,runningTriggerCube:`${t}-psRunningTriggerCube`,terminatedProcessCube:`${t}-psTerminatedProcessCube`,terminatedTriggerCube:`${t}-psTerminatedTriggerCube`,loadingCube:`${t}-psLoadingCube`,errorCube:`${t}-psErrorCube`}}),[e])}const be=v.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.loadingProcess",{defaultMessage:"Loading Process"}),fe=v.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.errorProcess",{defaultMessage:"Error Process"}),ye=v.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.runningProcess",{defaultMessage:"Running Process"}),he=v.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.triggerProcess",{defaultMessage:"Trigger Process"}),Ee=v.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.terminatedProcess",{defaultMessage:"Terminated Process"}),ve=v.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.terminatedTriggerProcess",{defaultMessage:"Terminated Trigger Process"}),xe=v.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.hoveredProcessBackground",{defaultMessage:"Hovered Process Background"}),ke=Object(n.memo)((({isDarkMode:e})=>{const t=ge();return i.a.createElement(i.a.Fragment,null,i.a.createElement("linearGradient",{id:t.errorCube,x1:"10.2372",y1:"9.49068",x2:"46.5307",y2:"45.7844",gradientUnits:"userSpaceOnUse"},i.a.createElement("stop",{stopColor:"#6D6D6D"}),i.a.createElement("stop",{offset:"1",stopColor:"#B9B9B9"})),i.a.createElement("linearGradient",{id:t.runningProcessCube,x1:"-381.23556",y1:"264.73802",x2:"-380.48514",y2:"263.8816",gradientTransform:"matrix(70.05179, 0, 0, -79.94774, 26724.01618, 21181.09848)",gradientUnits:"userSpaceOnUse"},i.a.createElement("stop",{offset:"0.00087",stopColor:"#006bb4"}),i.a.createElement("stop",{offset:"1",stopColor:"#54b399"})),i.a.createElement("linearGradient",{id:t.runningTriggerCube,x1:"-381.18643",y1:"264.68195",x2:"-380.48514",y2:"263.8816",gradientTransform:"matrix(70.05179, 0, 0, -79.94774, 26724.01618, 21181.09848)",gradientUnits:"userSpaceOnUse"},i.a.createElement("stop",{offset:"0",stopColor:"#dd0a73"}),i.a.createElement("stop",{offset:"1",stopColor:"#f66"})),e?i.a.createElement(i.a.Fragment,null,i.a.createElement("linearGradient",{id:t.terminatedProcessCube,x1:"-381.23752",y1:"264.24026",x2:"-380.48514",y2:"263.3816",gradientTransform:"matrix(70.05178, 0, 0, -79.94771, 26724.01313, 21140.72096)",gradientUnits:"userSpaceOnUse"},i.a.createElement("stop",{offset:"0",stopColor:"#4c82c3"}),i.a.createElement("stop",{offset:"1",stopColor:"#8bd1c7"})),i.a.createElement("linearGradient",{id:t.terminatedTriggerCube,x1:"-381.18658",y1:"264.68187",x2:"-380.48546",y2:"263.8817",gradientTransform:"matrix(70.05179, 0, 0, -79.94774, 26724.01618, 21181.09848)",gradientUnits:"userSpaceOnUse"},i.a.createElement("stop",{offset:"0",stopColor:"#dd0a73"}),i.a.createElement("stop",{offset:"1",stopColor:"#f66"}))):i.a.createElement(i.a.Fragment,null,i.a.createElement("linearGradient",{id:t.terminatedProcessCube,x1:"10.5206",y1:"9.49068",x2:"46.8141",y2:"45.7844",gradientUnits:"userSpaceOnUse"},i.a.createElement("stop",{offset:"0",stopColor:"#2F6EB6"}),i.a.createElement("stop",{offset:"1",stopColor:"#00B4AC"})),i.a.createElement("linearGradient",{id:t.terminatedTriggerCube,x1:"15.4848",y1:"12.0468",x2:"43.1049",y2:"47.2331",gradientUnits:"userSpaceOnUse"},i.a.createElement("stop",{stopColor:"#DD0A73"}),i.a.createElement("stop",{offset:"1",stopColor:"#FF6666"}))))})),Se=Object(n.memo)((({isDarkMode:e})=>{const t=A(),a=ge();return i.a.createElement(i.a.Fragment,null,i.a.createElement("symbol",{id:t.processNodeLabel,viewBox:"0 0 144 25",preserveAspectRatio:"xMidYMid meet"},i.a.createElement("rect",{x:"1",y:"1",width:"142",height:"23",fill:"inherit",strokeWidth:"0",paintOrder:"normal"})),i.a.createElement("symbol",{id:t.loadingCube,viewBox:"0 0 88 100"},i.a.createElement("title",null,be),i.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",fill:e?"#1d1e24":"white",stroke:"#98A2B3",strokeWidth:"2"})),i.a.createElement("symbol",{id:t.errorCube,viewBox:"0 0 88 100"},i.a.createElement("title",null,fe),i.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",transform:"translate(0.00001 0)",fill:`url(#${a.errorCube})`}),i.a.createElement("g",{opacity:"0.6"},i.a.createElement("path",{opacity:.6,d:"M87.52113,24.73352a3.7956,3.7956,0,0,0-1.43182-1.47166L45.91012.17918a3.8365,3.8365,0,0,0-3.82049,0L1.91029,23.26186A3.86312,3.86312,0,0,0-.00009,26.55445V72.7199a3.79834,3.79834,0,0,0,1.91041,3.29249L42.08963,99.09514a3.83689,3.83689,0,0,0,3.82049,0L86.08931,76.01239a3.79852,3.79852,0,0,0,1.91056-3.29249V26.55445A3.77643,3.77643,0,0,0,87.52113,24.73352Z",transform:"translate(0.00013 0.39551)",fill:`url(#${a.errorCube})`}),i.a.createElement("path",{opacity:.4,d:"M.57134,24.52282a3.79906,3.79906,0,0,1,1.34824-1.32625L42.09878.11387a3.83708,3.83708,0,0,1,3.8208,0L86.09877,23.19655a3.79771,3.79771,0,0,1,1.43182,1.47165L44.00909,49.57182Z",transform:"translate(0.00013 0.39551)",fill:"#fff",style:{isolation:"isolate"}}),i.a.createElement("path",{opacity:.4,d:"M43.99972,49.63713V99.60449a3.83406,3.83406,0,0,1-1.91025-.50932L1.91029,76.01239A3.79835,3.79835,0,0,1-.00013,72.7199V26.55445A3.77431,3.77431,0,0,1,.562,24.5882Z",transform:"translate(0.00013 0.39551)",fill:"#353944",style:{isolation:"isolate"}}))),i.a.createElement("symbol",{id:t.runningProcessCube,viewBox:"0 0 88 100"},i.a.createElement("title",null,ye),i.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",transform:"translate(0.00001 0)",fill:`url(#${a.runningProcessCube})`}),i.a.createElement("g",{opacity:"0.5"},i.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff"}),i.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),i.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),i.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),i.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),i.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}})),i.a.createElement("path",{d:"M.57144,24.91834a3.79909,3.79909,0,0,1,1.34825-1.32625L42.0989.50939a3.837,3.837,0,0,1,3.82081,0L86.09892,23.59206a3.79782,3.79782,0,0,1,1.4318,1.47169L44.00915,49.96733Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.3",style:{isolation:"isolate"}}),i.a.createElement("path",{d:"M43.99984,50.03265V100a3.83392,3.83392,0,0,1-1.91024-.50933L1.91039,76.40791A3.79835,3.79835,0,0,1,0,73.11541V26.95a3.77423,3.77423,0,0,1,.56216-1.96625Z",transform:"translate(0.00001 0)",fill:"#353944",opacity:"0.2",style:{isolation:"isolate"}})),i.a.createElement("symbol",{id:t.runningTriggerCube,viewBox:"0 0 88 100"},i.a.createElement("title",null,he),i.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",transform:"translate(0.00001 0)",fill:`url(#${a.runningTriggerCube})`}),i.a.createElement("g",{opacity:"0.5"},i.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff"}),i.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),i.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),i.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),i.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),i.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}})),i.a.createElement("path",{d:"M.57144,24.91834a3.79909,3.79909,0,0,1,1.34825-1.32625L42.0989.50939a3.837,3.837,0,0,1,3.82081,0L86.09892,23.59206a3.79782,3.79782,0,0,1,1.4318,1.47169L44.00915,49.96733Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.3",style:{isolation:"isolate"}}),i.a.createElement("path",{d:"M43.99984,50.03265V100a3.83392,3.83392,0,0,1-1.91024-.50933L1.91039,76.40791A3.79835,3.79835,0,0,1,0,73.11541V26.95a3.77423,3.77423,0,0,1,.56216-1.96625Z",transform:"translate(0.00001 0)",fill:"#353944",opacity:"0.2",style:{isolation:"isolate"}})),i.a.createElement("symbol",{viewBox:"0 0 88 100",id:t.terminatedProcessCube},i.a.createElement("title",null,Ee),i.a.createElement("path",{d:"M87.52113,24.73352a3.7956,3.7956,0,0,0-1.43182-1.47166L45.91012.17918a3.8365,3.8365,0,0,0-3.82049,0L1.91029,23.26186A3.86312,3.86312,0,0,0-.00009,26.55445V72.7199a3.79834,3.79834,0,0,0,1.91041,3.29249L42.08963,99.09514a3.83689,3.83689,0,0,0,3.82049,0L86.08931,76.01239a3.79852,3.79852,0,0,0,1.91056-3.29249V26.55445A3.77643,3.77643,0,0,0,87.52113,24.73352Z",transform:"translate(0.00013 0.39551)",fill:e?"#010101":"#fff"}),i.a.createElement("g",{opacity:"0.7"},i.a.createElement("path",{opacity:e?1:.6,d:"M87.52113,24.73352a3.7956,3.7956,0,0,0-1.43182-1.47166L45.91012.17918a3.8365,3.8365,0,0,0-3.82049,0L1.91029,23.26186A3.86312,3.86312,0,0,0-.00009,26.55445V72.7199a3.79834,3.79834,0,0,0,1.91041,3.29249L42.08963,99.09514a3.83689,3.83689,0,0,0,3.82049,0L86.08931,76.01239a3.79852,3.79852,0,0,0,1.91056-3.29249V26.55445A3.77643,3.77643,0,0,0,87.52113,24.73352Z",transform:"translate(0.00013 0.39551)",fill:`url(#${a.terminatedProcessCube})`}),i.a.createElement("path",{opacity:e?.3:.4,d:"M.57134,24.52282a3.79906,3.79906,0,0,1,1.34824-1.32625L42.09878.11387a3.83708,3.83708,0,0,1,3.8208,0L86.09877,23.19655a3.79771,3.79771,0,0,1,1.43182,1.47165L44.00909,49.57182Z",transform:"translate(0.00013 0.39551)",fill:"#fff",style:{isolation:"isolate"}}),i.a.createElement("path",{opacity:e?.2:.4,d:"M43.99972,49.63713V99.60449a3.83406,3.83406,0,0,1-1.91025-.50932L1.91029,76.01239A3.79835,3.79835,0,0,1-.00013,72.7199V26.55445A3.77431,3.77431,0,0,1,.562,24.5882Z",transform:"translate(0.00013 0.39551)",fill:"#353944",style:{isolation:"isolate"}}))),i.a.createElement("symbol",{id:t.terminatedTriggerCube,viewBox:"0 0 88 100"},i.a.createElement("title",null,ve),e&&i.a.createElement("path",{opacity:"1",d:"M87.52143,25.06372a3.795,3.795,0,0,0-1.43129-1.47166L45.92578.50939a3.83384,3.83384,0,0,0-3.81907,0L1.94219,23.59206A3.8634,3.8634,0,0,0,.03252,26.88465V73.05008a3.7986,3.7986,0,0,0,1.90971,3.2925L42.10671,99.42532a3.83423,3.83423,0,0,0,3.81907,0L86.09014,76.34258A3.79881,3.79881,0,0,0,88,73.05008V26.88465A3.77748,3.77748,0,0,0,87.52143,25.06372Z",transform:"translate(0)",fill:"#010101"}),i.a.createElement("g",{opacity:"0.6"},!e&&i.a.createElement("path",{opacity:"0.6",d:"M87.52143,25.06372a3.795,3.795,0,0,0-1.43129-1.47166L45.92578.50939a3.83384,3.83384,0,0,0-3.81907,0L1.94219,23.59206A3.8634,3.8634,0,0,0,.03252,26.88465V73.05008a3.7986,3.7986,0,0,0,1.90971,3.2925L42.10671,99.42532a3.83423,3.83423,0,0,0,3.81907,0L86.09014,76.34258A3.79881,3.79881,0,0,0,88,73.05008V26.88465A3.77748,3.77748,0,0,0,87.52143,25.06372Z",transform:"translate(0)",fill:"#010101"}),i.a.createElement("path",{opacity:e?1:.604,d:"M87.48893,25.129a3.79468,3.79468,0,0,0-1.4313-1.47165L45.89329.57472a3.83381,3.83381,0,0,0-3.81908,0L1.90969,23.65739A3.86331,3.86331,0,0,0,0,26.95V73.11541a3.79859,3.79859,0,0,0,1.90969,3.2925L42.07421,99.49067a3.83425,3.83425,0,0,0,3.81908,0L86.05763,76.40791a3.79876,3.79876,0,0,0,1.90985-3.2925V26.95A3.77746,3.77746,0,0,0,87.48893,25.129Z",transform:"translate(0)",fill:`url(#${a.terminatedTriggerCube})`}),i.a.createElement("path",{d:"M.57124,24.91834A3.79833,3.79833,0,0,1,1.919,23.59209L42.08335.50939a3.83441,3.83441,0,0,1,3.8194,0L86.06711,23.59206a3.7972,3.7972,0,0,1,1.43128,1.47169L43.99289,49.96733Z",transform:"translate(0)",fill:"#fff",opacity:"0.3",style:{isolation:"isolate"}}),i.a.createElement("path",{d:"M43.98359,50.03265V100a3.83139,3.83139,0,0,1-1.90953-.50933L1.90969,76.40791A3.79859,3.79859,0,0,1,0,73.11541V26.95a3.77523,3.77523,0,0,1,.56195-1.96625Z",transform:"translate(0)",fill:"#353944",opacity:"0.2",style:{isolation:"isolate"}}))),i.a.createElement("symbol",{viewBox:"0 -3 88 106",id:t.processCubeActiveBacking},i.a.createElement("title",null,xe),i.a.createElement("path",{d:"m87.521 25.064a3.795 3.795 0 0 0-1.4313-1.4717l-40.164-23.083a3.8338 3.8338 0 0 0-3.8191 0l-40.165 23.083a3.8634 3.8634 0 0 0-1.9097 3.2926v46.165a3.7986 3.7986 0 0 0 1.9097 3.2925l40.164 23.083a3.8342 3.8342 0 0 0 3.8191 0l40.164-23.083a3.7988 3.7988 0 0 0 1.9099-3.2925v-46.165a3.7775 3.7775 0 0 0-0.47857-1.8209z",strokeWidth:"2"})))})),je=Object(n.memo)((()=>{const e=Object(me.useUiSetting)("theme:darkMode");return i.a.createElement(Oe,null,i.a.createElement("defs",null,i.a.createElement(ke,{isDarkMode:e}),i.a.createElement(Se,{isDarkMode:e})))})),Oe=p()("svg").withConfig({displayName:"HiddenSVG",componentId:"sc-1sziupc-0"})(["position:absolute;left:100%;top:100%;width:0;height:0;"]);var we=a(82),Te=a.n(we);const Ie=Object(n.memo)((function({breadcrumbs:e}){const t=Object(n.useMemo)((()=>{const t=e.slice(-1).map((e=>(e["data-test-subj"]="resolver:breadcrumbs:last",e.truncate=!0,e)));return[...e.slice(0,-1),...t]}),[e]),{resolverBreadcrumbBackground:a,resolverEdgeText:r}=f();return i.a.createElement(i.a.Fragment,null,i.a.createElement(w,{background:a,text:r,breadcrumbs:t,truncate:!1}))})),Ce=p.a.span.withConfig({displayName:"StyledSpinnerFlexItem",componentId:"sc-1wo8ziw-0"})(["margin-right:5px;"]);function Me(){const e=v.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.relatedDetail.wait",{defaultMessage:"Loading Events..."}),t=v.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.events",{defaultMessage:"Events"}),a=W({panelView:"nodes"}),r=Object(n.useMemo)((()=>[{text:t,...a}]),[a,t]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(Ie,{breadcrumbs:r}),i.a.createElement(s.EuiSpacer,{size:"l"}),i.a.createElement(s.EuiFlexGroup,{alignItems:"center",direction:"row",gutterSize:"none"},i.a.createElement(Ce,null,i.a.createElement(s.EuiLoadingSpinner,{size:"m"})),i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(s.EuiText,{"data-test-subj":"resolver:panel:loading"},e))))}function Fe({event:e}){var t,a,n,r,s,l,c,u,d,p,m,g,b,f,y,h,E,v,x;return Object(re.i)(e)?i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.legacyEventLabel",defaultMessage:"{ processName }",values:{processName:Object(re.l)(e)}}):null!==(t=e.network)&&void 0!==t&&t.forwarded_ip?i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.networkEventLabel",defaultMessage:"{ networkDirection } { forwardedIP }",values:{forwardedIP:String(null===(p=e.network)||void 0===p?void 0:p.forwarded_ip),networkDirection:String(null===(m=e.network)||void 0===m?void 0:m.direction)}}):null!==(a=e.kibana)&&void 0!==a&&null!==(n=a.alert)&&void 0!==n&&null!==(r=n.rule)&&void 0!==r&&r.name?i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.alertEventNameLabel",defaultMessage:"{ ruleName }",values:{ruleName:String(null===(g=e.kibana)||void 0===g||null===(b=g.alert)||void 0===b||null===(f=b.rule)||void 0===f?void 0:f.name)}}):null!==(s=e.file)&&void 0!==s&&s.path?i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.fileEventLabel",defaultMessage:"{ filePath }",values:{filePath:String(null===(y=e.file)||void 0===y?void 0:y.path)}}):null!==(l=e.registry)&&void 0!==l&&l.path?i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.registryPathLabel",defaultMessage:"{ registryPath }",values:{registryPath:String(null===(h=e.registry)||void 0===h?void 0:h.path)}}):null!==(c=e.registry)&&void 0!==c&&c.key?i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.registryKeyLabel",defaultMessage:"{ registryKey }",values:{registryKey:String(null===(E=e.registry)||void 0===E?void 0:E.key)}}):null!==(u=e.dns)&&void 0!==u&&null!==(d=u.question)&&void 0!==d&&d.name?i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.dnsQuestionNameLabel",defaultMessage:"{ dnsQuestionName }",values:{dnsQuestionName:String(null===(v=e.dns)||void 0===v||null===(x=v.question)||void 0===x?void 0:x.name)}}):i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.entityIDLabel",defaultMessage:"{ entityID }",values:{entityID:Object(re.b)(e)}})}var De=a(58),Ae=a.n(De);const _e=v.i18n.translate("xpack.securitySolution.enpdoint.resolver.panelutils.invaliddate",{defaultMessage:"Invalid Date"}),Ne=new Intl.DateTimeFormat(v.i18n.getLocale(),{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"});function Re(e){const t=Object(me.useUiSetting)("dateFormat"),a=Object(me.useUiSetting)("dateFormat:tz"),n="Browser"===a?Ae.a.tz.guess():a;if(!e)return;const i=new Date(e);return i&&Number.isFinite(i.getTime())?t?Ae.a.tz(i,n).format(t):Ne.format(i):_e}var Pe=a(299);const Le=Object(n.memo)((function({nodeID:e,eventCategory:t}){const a=Object(r.useSelector)((t=>c.g(t)(e))),n=Object(r.useSelector)(c.p),l=Object(r.useSelector)(c.h);return i.a.createElement(i.a.Fragment,null,n?i.a.createElement(ee,{hasBorder:!0},i.a.createElement(Me,null)):i.a.createElement(ee,{hasBorder:!0,"data-test-subj":"resolver:panel:events-in-category"},l||!a?i.a.createElement(s.EuiCallOut,{title:v.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.nodeEventsByType.errorPrimary",{defaultMessage:"Unable to load events."}),color:"danger",iconType:"alert","data-test-subj":"resolver:nodeEventsInCategory:error"},i.a.createElement("p",null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.nodeEventsByType.errorSecondary",defaultMessage:"An error occurred when fetching the events."}))):i.a.createElement(i.a.Fragment,null,i.a.createElement(ze,{nodeName:a.name,eventCategory:t,nodeID:e}),i.a.createElement(s.EuiSpacer,{size:"l"}),i.a.createElement(qe,{eventCategory:t,nodeID:e}))))})),Be=Object(n.memo)((function({event:e,nodeID:t,eventCategory:a}){const n=Object(Pe.a)(e),r=re.g(n),l=re.e(n),c=re.p(n),u=Re(r)||v.i18n.translate("xpack.securitySolution.enpdoint.resolver.panelutils.noTimestampRetrieved",{defaultMessage:"No timestamp retrieved"}),d=W({panelView:"eventDetail",panelParameters:{nodeID:t,eventCategory:a,eventID:l,eventTimestamp:String(r),winlogRecordID:String(c)}});return i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiText,null,i.a.createElement(F,null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.categoryAndType",values:{category:re.d(n).join(", "),eventType:re.h(n).join(", ")},defaultMessage:"{category} {eventType}"})),i.a.createElement(D,{dateTime:u},i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.atTime",values:{date:u},defaultMessage:"@ {date}"}))),i.a.createElement(s.EuiSpacer,{size:"xs"}),i.a.createElement(s.EuiButtonEmpty,Te()({"data-test-subj":"resolver:panel:node-events-in-category:event-link"},d),i.a.createElement(Fe,{event:n})))})),qe=Object(n.memo)((function({eventCategory:e,nodeID:t}){const a=Object(r.useSelector)(c.w),l=ne(),u=Object(n.useCallback)((()=>{l({type:"userRequestedAdditionalRelatedEvents"})}),[l]),d=Object(r.useSelector)(c.o),p=Object(r.useSelector)(c.r);return i.a.createElement(i.a.Fragment,null,a.map(((r,o)=>i.a.createElement(n.Fragment,{key:o},i.a.createElement(Be,{nodeID:t,eventCategory:e,event:r}),o===a.length-1?null:i.a.createElement(s.EuiHorizontalRule,{margin:"m"})))),p&&i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(s.EuiButton,{color:"primary",size:"s",fill:!0,onClick:u,isLoading:d,"data-test-subj":"resolver:nodeEventsInCategory:loadMore"},i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.nodeEventsByType.loadMore",defaultMessage:"Load More Data"}))))})),ze=Object(n.memo)((function({nodeName:e,eventCategory:t,nodeID:a}){const n=Object(r.useSelector)((e=>c.L(e)(a))),s=Object(r.useSelector)((e=>c.B(e)(a,t))),l=W({panelView:"nodes"}),u=W({panelView:"nodeDetail",panelParameters:{nodeID:a}}),d=W({panelView:"nodeEvents",panelParameters:{nodeID:a}});return i.a.createElement(Ie,{breadcrumbs:[{text:v.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.processEventListByType.events",{defaultMessage:"Events"}),"data-test-subj":"resolver:node-events-in-category:breadcrumbs:node-list-link",...l},{text:e,...u},{text:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventList.numberOfEvents",values:{totalCount:n},defaultMessage:"{totalCount} Events"}),...d},{text:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventList.countByCategory",values:{count:s,category:t},defaultMessage:"{count} {category}"})}]})}));function $e({nodeID:e}){const t=Object(r.useSelector)((t=>se.a(c.u(t)(e)))),a=Object(r.useSelector)((t=>c.x(t)(e)));return void 0===t||void 0===a?i.a.createElement(ee,{hasBorder:!0},i.a.createElement(Me,null)):i.a.createElement(ee,{hasBorder:!0},i.a.createElement(Ue,{nodeName:re.l(t),nodeID:e,totalEventCount:a.total}),i.a.createElement(s.EuiSpacer,{size:"l"}),i.a.createElement(Ve,{nodeID:e,relatedStats:a}))}const Ve=Object(n.memo)((function({nodeID:e,relatedStats:t}){const a=Object(n.useMemo)((()=>Object.entries(t.byCategory).map((([e,t])=>({eventType:e,count:t})))),[t.byCategory]),r=Object(n.useMemo)((()=>[{field:"count",name:v.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.count",{defaultMessage:"Count"}),"data-test-subj":"resolver:panel:node-events:event-type-count",width:"20%",sortable:!0},{field:"eventType",name:v.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.eventType",{defaultMessage:"Event Type"}),width:"80%",sortable:!0,render:t=>i.a.createElement(He,{nodeID:e,eventType:t},t)}]),[e]);return i.a.createElement(s.EuiInMemoryTable,{items:a,columns:r,sorting:!0})})),Ue=Object(n.memo)((function({nodeID:e,nodeName:t,totalEventCount:a}){return i.a.createElement(Ie,{breadcrumbs:[{text:v.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.processEventCounts.events",{defaultMessage:"Events"}),...W({panelView:"nodes"})},{text:t,...W({panelView:"nodeDetail",panelParameters:{nodeID:e}})},{text:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedCounts.numberOfEventsInCrumb",values:{totalCount:a},defaultMessage:"{totalCount} Events"}),...W({panelView:"nodeEvents",panelParameters:{nodeID:e}})}]})})),He=Object(n.memo)((({nodeID:e,eventType:t,children:a})=>{const n=W({panelView:"nodeEventsInCategory",panelParameters:{nodeID:e,eventCategory:t}});return i.a.createElement(s.EuiButtonEmpty,Te()({"data-test-subj":"resolver:panel:node-events:event-type-link"},n),a)})),Ge=p.a.div.withConfig({displayName:"StyledCopyableField",componentId:"sc-3rurpv-0"})(["border-radius:3px;padding:4px;transition:background 0.2s ease;",":hover &{background-color:",";&:hover{background-color:",";color:#fff;}}"],ee,(e=>e.backgroundColor),(e=>e.activeBackgroundColor)),Qe=Object(n.memo)((({textToCopy:e,content:t})=>{var a;const{linkColor:r,copyableFieldBackground:o}=f(),[l,c]=Object(n.useState)(!1),u=null===(a=Object(me.useKibana)().services.notifications)||void 0===a?void 0:a.toasts,d=()=>c(!0),p=()=>c(!1),m=Object(n.useMemo)((()=>i.a.createElement(Ge,{backgroundColor:o,"data-test-subj":"resolver:panel:copyable-field-hover-area",activeBackgroundColor:r,onMouseEnter:d},t)),[t,o,r]),{writeTextToClipboard:g}=Object(n.useContext)(S),b=Object(n.useCallback)((async()=>{try{await g(e)}catch(e){u&&u.addError(e,{title:v.i18n.translate("xpack.securitySolution.resolver.panel.copyFailureTitle",{defaultMessage:"Copy Failure"})})}}),[e,u,g]);return i.a.createElement("div",{onMouseLeave:p},i.a.createElement(s.EuiPopover,{anchorPosition:"downCenter",button:m,closePopover:p,hasArrow:!1,isOpen:l,panelPaddingSize:"s"},i.a.createElement(s.EuiToolTip,{content:v.i18n.translate("xpack.securitySolution.resolver.panel.copyToClipboard",{defaultMessage:"Copy to Clipboard"})},i.a.createElement(s.EuiButtonIcon,{"aria-label":v.i18n.translate("xpack.securitySolution.resolver.panel.copyToClipboard",{defaultMessage:"Copy to Clipboard"}),color:"text","data-test-subj":"resolver:panel:clipboard",iconType:"copyClipboard",onClick:b}))))}));var We=a(342);const Ke=Object(n.memo)((function({translatedErrorMessage:e}){const t=W({panelView:"nodes"}),a=Object(n.useMemo)((()=>[{text:v.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.error.events",{defaultMessage:"Events"}),...t},{text:v.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.error.error",{defaultMessage:"Error"})}]),[t]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(Ie,{breadcrumbs:a}),i.a.createElement(s.EuiSpacer,{size:"l"}),i.a.createElement(s.EuiText,{textAlign:"center","data-test-subj":"resolver:panel:error"},e),i.a.createElement(s.EuiSpacer,{size:"l"}),i.a.createElement(s.EuiButtonEmpty,t,v.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.error.goBack",{defaultMessage:"View all processes"})))})),Ye=p()(R).withConfig({displayName:"StyledCubeForProcess",componentId:"sc-821tkc-0"})(["position:relative;"]),Je=v.i18n.translate("xpack.securitySolution.resolver.panel.nodeDetail.Error",{defaultMessage:"Node details were unable to be retrieved"}),Xe=Object(n.memo)((function({nodeID:e}){const t=Object(r.useSelector)((t=>se.a(c.u(t)(e))));return"loading"===Object(r.useSelector)((t=>c.v(t)(e)))?i.a.createElement(ee,{hasBorder:!0},i.a.createElement(Me,null)):t?i.a.createElement(ee,{hasBorder:!0,"data-test-subj":"resolver:panel:node-detail"},i.a.createElement(Ze,{nodeID:e,processEvent:t})):i.a.createElement(ee,{hasBorder:!0},i.a.createElement(Ke,{translatedErrorMessage:Je}))})),Ze=Object(n.memo)((function({processEvent:e,nodeID:t}){const a=re.l(e),l=Object(r.useSelector)((e=>c.v(e)(t))),u=Object(r.useSelector)((e=>c.C(e)(t))),d=Re(re.g(e)),p=Object(n.useMemo)((()=>{const t={title:"@timestamp",description:d},a={title:"process.executable",description:Object(We.d)(e)},n={title:"process.pid",description:Object(We.c)(e)},r={title:"user.name",description:re.o(e)};return[t,a,n,{title:"process.entity_id",description:re.c(e)},r,{title:"user.domain",description:re.n(e)},{title:"process.parent.pid",description:re.k(e)},{title:"process.hash.md5",description:re.j(e)},{title:"process.args",description:re.a(e)}].reduce(((e,t)=>Array.isArray(t.description)?[...e,...t.description.map((e=>({title:t.title,description:e})))]:[...e,t]),[]).filter((e=>void 0!==e.description)).map((e=>({...e,description:i.a.createElement(Qe,{textToCopy:String(e.description),content:i.a.createElement(L,null,String(e.description))})})))}),[d,e]),m=W({panelView:"nodes"}),g=Object(n.useMemo)((()=>[{text:v.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.processDescList.events",{defaultMessage:"Events"}),"data-test-subj":"resolver:node-detail:breadcrumbs:node-list-link",...m},{text:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.detailsForProcessName",values:{processName:a},defaultMessage:"Details for: {processName}"})}]),[a,m]),{descriptionText:b}=_(l,!1),f=W({panelView:"nodeEvents",panelParameters:{nodeID:t}}),y=Object(n.useMemo)((()=>Object(s.htmlIdGenerator)("resolverTable")()),[]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(Ie,{breadcrumbs:g}),i.a.createElement(s.EuiSpacer,{size:"l"}),i.a.createElement(s.EuiTitle,{size:"xs"},i.a.createElement(O,{"aria-describedby":y},i.a.createElement(Ye,{"data-test-subj":"resolver:node-detail:title-icon",state:l}),i.a.createElement("span",{"data-test-subj":"resolver:node-detail:title"},i.a.createElement(L,null,a)))),i.a.createElement(s.EuiText,null,i.a.createElement(s.EuiTextColor,{color:"subdued"},i.a.createElement("span",{id:y},b))),i.a.createElement(s.EuiSpacer,{size:"s"}),i.a.createElement(s.EuiLink,Te()({},f,{"data-test-subj":"resolver:node-detail:node-events-link"}),i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.processDescList.numberOfEvents",values:{relatedEventTotal:u},defaultMessage:"{relatedEventTotal} Events"})),i.a.createElement(s.EuiSpacer,{size:"l"}),i.a.createElement(j,{"data-test-subj":"resolver:node-detail",type:"column",align:"left",titleProps:{"data-test-subj":"resolver:node-detail:entry-title",className:"desc-title"},descriptionProps:{"data-test-subj":"resolver:node-detail:entry-description"},compressed:!0,listItems:p}))})),et=i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.eitherLineageLimitExceeded",defaultMessage:"Some process events in the visualization and event list below could not be displayed because the data limit has been reached."}),tt=i.a.memo((function({numberOfEntries:e}){return i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.relatedEventLimitTitle",defaultMessage:"This list includes {numberOfEntries} process events.",values:{numberOfEntries:e}})})),at=i.a.memo((function({numberDisplayed:e}){return i.a.createElement(ae,{size:"s",title:i.a.createElement(tt,{numberOfEntries:e})},i.a.createElement("p",null,et))})),nt=Object(n.memo)((()=>{const e=Object(n.useMemo)((()=>[{field:"name",name:v.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.processNameTitle",{defaultMessage:"Process Name"}),sortable:!0,truncateText:!0,render:(e,t)=>i.a.createElement(it,{name:e,nodeID:t.nodeID})},{field:"timestamp",name:v.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.timestampTitle",{defaultMessage:"Timestamp"}),dataType:"date",sortable:!0,render:e=>i.a.createElement(rt,{eventDate:e})}]),[]),t=Object(r.useSelector)(Object(n.useCallback)((e=>{const{processNodePositions:t}=c.s(e),a=[];for(const e of t.keys()){const t=ie.c(e),n=ie.b(e);void 0!==n&&a.push({name:t,timestamp:ie.e(e),nodeID:n})}return a}),[])),a=t.length,o=Object(n.useMemo)((()=>[{text:v.i18n.translate("xpack.securitySolution.resolver.panel.nodeList.title",{defaultMessage:"All Process Events"})}]),[]),l=Object(r.useSelector)(c.k),u=Object(r.useSelector)(c.j),d=Object(r.useSelector)(c.l),p=!0===l||!0===u||!0===d,m=Object(n.useMemo)((()=>({"data-test-subj":"resolver:node-list:item"})),[]);return i.a.createElement(ee,{hasBorder:!0},i.a.createElement(Ie,{breadcrumbs:o}),p&&i.a.createElement(at,{numberDisplayed:a}),i.a.createElement(s.EuiSpacer,{size:"l"}),i.a.createElement(s.EuiInMemoryTable,{rowProps:m,"data-test-subj":"resolver:node-list",items:t,columns:e,sorting:!0}))}));function it({name:e,nodeID:t}){const a=Object(r.useSelector)((e=>c.y(e)===t)),o=Object(r.useSelector)((e=>c.v(e)(t))),{descriptionText:l}=f(),u=W({panelView:"nodeDetail",panelParameters:{nodeID:t}}),d=Object(r.useDispatch)(),{timestamp:p}=Object(n.useContext)(S),m=Object(n.useCallback)((e=>{u.onClick(e),d({type:"userSelectedResolverNode",payload:{nodeID:t,time:p()}})}),[p,u,d,t]);return i.a.createElement(s.EuiButtonEmpty,{onClick:m,href:u.href,"data-test-subj":"resolver:node-list:node-link","data-test-node-id":t},void 0===e?i.a.createElement(s.EuiBadge,{color:"warning"},v.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.valueMissingDescription",{defaultMessage:"Value is missing"})):i.a.createElement(T,null,i.a.createElement(R,{state:o,isOrigin:a,"data-test-subj":"resolver:node-list:node-link:icon"}),i.a.createElement(M,null,a&&i.a.createElement(I,{color:l,"data-test-subj":"resolver:node-list:node-link:analyzed-event"},v.i18n.translate("xpack.securitySolution.resolver.panel.table.row.analyzedEvent",{defaultMessage:"ANALYZED EVENT"})),i.a.createElement(C,{"data-test-subj":"resolver:node-list:node-link:title"},e))))}const rt=Object(n.memo)((({eventDate:e})=>{const t=Re(e);return t?i.a.createElement(Qe,{textToCopy:t,content:t}):i.a.createElement("span",null,"—")}));function st(e){const t=[{path:[],value:e}],a=[];for(;t.length;){const e=t.shift();if(void 0===e)throw new Error;const{path:n,value:i}=e;Array.isArray(i)?t.push(...i.map((e=>({path:[...n],value:e})))):"object"==typeof i&&null!==i?t.push(...Object.keys(i).map((e=>({path:[...n,e],value:i[e]})))):null!=i&&a.push([n,i])}return a}const ot=v.i18n.translate("xpack.securitySolution.resolver.panel.eventDetail.requestError",{defaultMessage:"Event details were unable to be retrieved"}),lt=Object(n.memo)((function({nodeID:e,eventCategory:t}){const a=Object(r.useSelector)(c.n),n=Object(r.useSelector)(c.q),s=Object(r.useSelector)((t=>se.a(c.u(t)(e)))),o=Object(r.useSelector)((t=>c.v(t)(e))),l=a||n||"loading"===o,u=Object(r.useSelector)(c.d);return l?i.a.createElement(ee,{hasBorder:!0},i.a.createElement(Me,null)):u?i.a.createElement(ct,{nodeID:e,event:u,processEvent:s,eventType:t}):i.a.createElement(ee,{hasBorder:!0},i.a.createElement(Ke,{translatedErrorMessage:ot}))})),ct=Object(n.memo)((function({nodeID:e,event:t,eventType:a,processEvent:n}){const r=Re(re.m(t))||v.i18n.translate("xpack.securitySolution.enpdoint.resolver.panelutils.noTimestampRetrieved",{defaultMessage:"No timestamp retrieved"}),l=n?re.l(n):null;return i.a.createElement(ee,{hasBorder:!0,"data-test-subj":"resolver:panel:event-detail"},i.a.createElement(dt,{nodeID:e,nodeName:l,event:t,breadcrumbEventCategory:a}),i.a.createElement(s.EuiSpacer,{size:"l"}),i.a.createElement(s.EuiText,{size:"s"},i.a.createElement(F,null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.categoryAndType",values:{category:a,eventType:String(re.h(t))},defaultMessage:"{category} {eventType}"})),i.a.createElement(D,{dateTime:r},i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.atTime",values:{date:r},defaultMessage:"@ {date}"}))),i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(mt,null,i.a.createElement(L,null,i.a.createElement(Fe,{event:t}))),i.a.createElement(s.EuiSpacer,{size:"l"}),i.a.createElement(ut,{event:t}))}));function ut({event:e}){const t=Object(n.useMemo)((()=>{const t=[],a=Object(Pe.a)(e);for(const[e,n]of Object.entries(a)){if("agent"===e||"ecs"===e||"@timestamp"===e||!n)continue;const a={namespace:i.a.createElement(L,null,e),descriptions:st(n).map((([t,a])=>{const n=[e,...t].join(".");return{title:i.a.createElement(L,null,n),description:i.a.createElement(Qe,{textToCopy:String(a),content:i.a.createElement(L,null,String(a))})}}))};t.push(a)}return t}),[e]);return i.a.createElement(i.a.Fragment,null,t.map((({namespace:e,descriptions:a},r)=>i.a.createElement(n.Fragment,{key:r},0===r?null:i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(s.EuiTitle,{size:"xxxs"},i.a.createElement(s.EuiTextColor,{color:"subdued"},i.a.createElement(gt,null,e,i.a.createElement(bt,null)))),i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(pt,{type:"column",align:"left",titleProps:{className:"desc-title","data-test-subj":"resolver:panel:event-detail:event-field-title"},compressed:!0,listItems:a}),r===t.length-1?null:i.a.createElement(s.EuiSpacer,{size:"m"})))))}function dt({nodeID:e,nodeName:t,event:a,breadcrumbEventCategory:s}){const l=Object(r.useSelector)((t=>c.B(t)(e,s))),u=Object(r.useSelector)((t=>c.C(t)(e))),d=W({panelView:"nodes"}),p=W({panelView:"nodeDetail",panelParameters:{nodeID:e}}),m=W({panelView:"nodeEvents",panelParameters:{nodeID:e}}),g=W({panelView:"nodeEventsInCategory",panelParameters:{nodeID:e,eventCategory:s}}),b=Object(n.useMemo)((()=>{const e=[{text:v.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.events",{defaultMessage:"Events"}),"data-test-subj":"resolver:event-detail:breadcrumbs:node-list-link",...d},{text:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.numberOfEvents",values:{totalCount:u},defaultMessage:"{totalCount} Events"}),...m},{text:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.countByCategory",values:{count:l,category:s},defaultMessage:"{count} {category}"}),...g},{text:i.a.createElement(Fe,{event:a})}];return t&&e.splice(1,0,{text:t,...p}),e}),[s,l,a,p,m,t,u,d,g]);return i.a.createElement(Ie,{breadcrumbs:b})}const pt=Object(n.memo)(p()(s.EuiDescriptionList).withConfig({displayName:"StyledDescriptionList",componentId:"sc-wbnmrd-0"})(["&.euiDescriptionList.euiDescriptionList--column dt.euiDescriptionList__title.desc-title{max-width:8em;overflow-wrap:break-word;}&.euiDescriptionList.euiDescriptionList--column dd.euiDescriptionList__description{max-width:calc(100% - 8.5em);overflow-wrap:break-word;}"])),mt=Object(n.memo)(p()(s.EuiText).withConfig({displayName:"StyledDescriptiveName",componentId:"sc-wbnmrd-1"})(["padding-right:1em;overflow-wrap:break-word;"])),gt=Object(n.memo)(p()("h3").withConfig({displayName:"StyledFlexTitle",componentId:"sc-wbnmrd-2"})(["align-items:center;display:flex;flex-flow:row;font-size:1.2em;"])),bt=Object(n.memo)((()=>i.a.createElement(s.EuiHorizontalRule,{margin:"none",size:"half"}))),ft=Object(n.memo)((function(){const e=Object(r.useSelector)(c.z);return"nodeDetail"===e.panelView?i.a.createElement(Xe,{nodeID:e.panelParameters.nodeID}):"nodeEvents"===e.panelView?i.a.createElement($e,{nodeID:e.panelParameters.nodeID}):"nodeEventsInCategory"===e.panelView?i.a.createElement(Le,{nodeID:e.panelParameters.nodeID,eventCategory:e.panelParameters.eventCategory}):"eventDetail"===e.panelView?i.a.createElement(lt,{nodeID:e.panelParameters.nodeID,eventCategory:e.panelParameters.eventCategory}):i.a.createElement(nt,null)}));var yt=a(347);const ht=p()(s.EuiCodeBlock).withConfig({displayName:"StyledEuiCodeBlock",componentId:"sc-r4p8yj-0"})(["align-self:flex-start;display:inline-block;"]),Et=p()(s.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-r4p8yj-1"})(["max-width:600px;margin:60px auto 0;"]),vt=()=>i.a.createElement(Et,{"data-test-subj":"resolver:no-process-events",direction:"column"},i.a.createElement(s.EuiTitle,null,i.a.createElement("h4",null,v.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.title",{defaultMessage:"No Process Events Found"}))),i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(s.EuiText,{size:"s"},v.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.timeRange",{defaultMessage:"\n            The Analyze Event tool creates graphs based on process events.\n            If the analyzed event does not have an associated process in the current time range,\n            or stored in Elasticsearch within any time range, a graph will not be created.\n            You can check for associated processes by expanding your time range.\n          "})),i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(s.EuiText,{size:"s"},v.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.dataView",{defaultMessage:'In case you selected a different data view,\n          make sure your data view contains all of the indices that are stored in the source event at "{field}".',values:{field:"kibana.alert.rule.parameters.index"}})),i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(s.EuiText,{size:"s"},v.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.eventCategory",{defaultMessage:"You may also add the below to your timeline query to check for process events.\n            If none are listed, a graph cannot be created from events found in that query."})),i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(ht,{language:"html",paddingSize:"s",isCopyable:!0},'event.category: "process"'));var xt=a(84);const kt=i.a.memo(i.a.forwardRef((function({className:e,databaseDocumentID:t,resolverComponentInstanceID:a,indices:d,shouldUpdate:p,filters:m},g){!function(){const e=Object(n.useRef)();e.current=Object(l.useLocation)().search;const t=Object(l.useHistory)(),a=Object(r.useSelector)(c.E),i=Object(u.a)(a);Object(n.useEffect)((()=>{const a=i;return()=>{const n=new URLSearchParams(e.current);n.delete(a);const i={search:n.toString()};t.replace(i)}}),[i,t])}(),function({databaseDocumentID:e,resolverComponentInstanceID:t,indices:a,filters:i,shouldUpdate:r}){const s=ne(),o=Object(l.useLocation)().search;Object(n.useLayoutEffect)((()=>{s({type:"appReceivedNewExternalProperties",payload:{databaseDocumentID:e,resolverComponentInstanceID:t,locationSearch:o,indices:a,shouldUpdate:r,filters:i}})}),[s,e,t,o,a,r,i])}({databaseDocumentID:t,resolverComponentInstanceID:a,indices:d,shouldUpdate:p,filters:m}),function(){const{addSuccess:e}=Object(xt.a)(),{from:t,to:a}=Object(r.useSelector)((e=>{const t=c.e(e);return{from:null!=t&&t.from?t.from:void 0,to:null!=t&&t.to?t.to:void 0}})),i=Re(t),s=Re(a),o=Object(n.useMemo)((()=>v.i18n.translate("xpack.securitySolution.resolver.unboundedRequest.toast",{defaultMessage:"No results found in the selected time, expanded to {from} - {to}.",values:{from:i,to:s}})),[i,s]);Object(n.useEffect)((()=>{(t||a)&&e(o)}),[e,o,t,a])}(),function(){const e=Object(r.useDispatch)(),t=Object(r.useSelector)(c.E),a=Object(l.useLocation)().search,i=Object(n.useContext)(S),s=Object(r.useSelector)(c.I),o=Object(r.useSelector)(c.g),u=Object(yt.a)({locationSearch:a,resolverComponentInstanceID:t});let d;"nodes"!==u.panelView&&(d=u.panelParameters.nodeID),Object(n.useEffect)((()=>{d&&o(d)&&d!==s&&e({type:"userSelectedResolverNode",payload:{nodeID:d,time:i.timestamp()}})}),[u.panelView,d,e,o,s,i])}();const{timestamp:b}=Object(n.useContext)(S),y=b(),{processNodePositions:h,connectingEdgeLineSegments:x}=Object(r.useSelector)((e=>c.P(e)(y))),{projectionMatrix:k,ref:j,onMouseDown:O}=function(){const e=ne(),t=Object(n.useContext)(S),[a,i]=Object(n.useState)(null),s=Object(r.useSelector)(c.A),o=Object(n.useRef)(),[l,u]=Object(n.useState)(s(t.timestamp())),d=Object(r.useSelector)(c.O),p=Object(r.useSelector)(c.m),[m,g]=function(){const{getBoundingClientRect:e}=Object(n.useContext)(S),[t,a]=Object(n.useState)(null),{ResizeObserver:i,requestAnimationFrame:r}=Object(n.useContext)(S),[s,o]=Object(n.useState)(null),l=Object(n.useCallback)((e=>{o(e)}),[]);return Object(n.useEffect)((()=>{null!==s&&a(e(s))}),[s,e]),Object(n.useEffect)((()=>{let t=window.scrollX,n=window.scrollY;const i=()=>{r((()=>{const i=window.scrollX,r=window.scrollY;null===s||t===i&&n===r||a(e(s)),t=i,n=r}))};return window.addEventListener("scroll",i,{passive:!0}),()=>{window.removeEventListener("scroll",i)}}),[s,r,e]),Object(n.useEffect)((()=>{if(null!==s){const t=new i((t=>{null!==s&&s===t[0].target&&a(e(s))}));return t.observe(s),()=>{t.disconnect()}}}),[i,s,e]),[t,l]}(),b=Object(n.useCallback)((e=>null===m?null:[e.clientX-m.x,e.clientY-m.y]),[m]),f=Object(n.useCallback)((a=>{const n=b(a);null!==n&&e({type:"userStartedPanning",payload:{screenCoordinates:n,time:t.timestamp()}})}),[e,b,t]),y=Object(n.useCallback)((a=>{const n=b(a);n&&e({type:"userMovedPointer",payload:{screenCoordinates:n,time:t.timestamp()}})}),[e,b,t]),h=Object(n.useCallback)((()=>{d&&e({type:"userStoppedPanning",payload:{time:t.timestamp()}})}),[e,t,d]),E=Object(n.useCallback)((a=>{null!==m&&a.ctrlKey&&0!==a.deltaY&&0===a.deltaMode&&(a.preventDefault(),e({type:"userZoomed",payload:{zoomChange:a.deltaY/-m.height,time:t.timestamp()}}))}),[m,e,t]),v=Object(n.useCallback)((e=>{i(e),g(e)}),[g]);return Object(n.useEffect)((()=>(window.addEventListener("mouseup",h,{passive:!0}),()=>{window.removeEventListener("mouseup",h)})),[h]),Object(n.useEffect)((()=>(window.addEventListener("mousemove",y,{passive:!0}),()=>{window.removeEventListener("mousemove",y)})),[y]),Object(n.useEffect)((()=>{if(null!==a)return a.addEventListener("wheel",E),()=>{a.removeEventListener("wheel",E)}}),[a,E]),Object(n.useLayoutEffect)((()=>{o.current=s}),[s]),Object(n.useLayoutEffect)((()=>{u(s(t.timestamp()))}),[s,t]),Object(n.useLayoutEffect)((()=>{const e=t.timestamp();if(p(e)){let e=null;const a=()=>{const n=t.timestamp();void 0!==o.current&&u(o.current(n)),e=p(n)?t.requestAnimationFrame(a):null};return e=t.requestAnimationFrame(a),()=>{null!==e&&t.cancelAnimationFrame(e)}}}),[p,t]),Object(n.useEffect)((()=>{null!==m&&e({type:"userSetRasterSize",payload:[m.width,m.height]})}),[e,m]),{ref:v,onMouseDown:f,projectionMatrix:l}}(),w=Object(n.useCallback)((e=>{j(e),"function"==typeof g?g(e):null!==g&&(g.current=e)}),[j,g]),T=Object(r.useSelector)(c.q),I=Object(r.useSelector)(c.i),C=Object(r.useSelector)(c.a),M=Object(r.useSelector)(c.F),F=f();return i.a.createElement(Z,{className:e,backgroundColor:F.resolverBackground},T?i.a.createElement("div",{"data-test-subj":"resolver:graph:loading",className:"loading-container"},i.a.createElement(s.EuiLoadingSpinner,{size:"xl"})):I?i.a.createElement("div",{"data-test-subj":"resolver:graph:error",className:"loading-container"},i.a.createElement("div",null," ",i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.loadingError",defaultMessage:"Error loading data."}))):M?i.a.createElement(i.a.Fragment,null,i.a.createElement(te,{"data-test-subj":"resolver:graph",className:"resolver-graph kbn-resetFocusState",onMouseDown:O,ref:w,role:"tree",tabIndex:0,"aria-activedescendant":C||void 0},x.map((({points:[e,t],metadata:a})=>i.a.createElement(E,{edgeLineMetadata:a,key:a.reactKey,startPosition:e,endPosition:t,projectionMatrix:k}))),[...h].map((([e,t])=>{const a=ie.b(e);if(void 0===a)throw new Error("Tried to render a node without an ID");return i.a.createElement(pe,{key:a,nodeID:a,position:t,projectionMatrix:k,node:e,timeAtRender:y})}))),i.a.createElement(ft,null)):i.a.createElement(vt,null),i.a.createElement(H,null),i.a.createElement(je,null))})))},function(e,t,a){"use strict";a.d(t,"a",(function(){return Lt})),a.d(t,"b",(function(){return zt}));var n=a(32),i=a(4),r=a.n(i),s=a(33),o=a.n(s),l=a(0),c=a(7),u=a(268),d=a.n(u),p=a(35),m=a(157),g=a(366),b=a(259),f=a(120),y=a(77),h=a(415),E=a(167),v=a(377),x=a(11),k=a(92),S=a.n(k),j=a(48),O=a(606),w=a(677),T=a(123),I=a(880),C=a(146),M=a(494),F=a(100);const D=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.importTimelineModalTitle",{defaultMessage:"Import query from saved timeline"}),A=["duplicate","createFrom"],_=e=>{var t;return{filters:null!==(t=e.attributes.filters)&&void 0!==t?t:[],query:e.attributes.query,saved_id:e.id,title:e.attributes.title}},N=({defaultSavedQuery:e,browserFields:t,dataTestSubj:a,field:s,idAria:o,indexPattern:l,isLoading:c=!1,onCloseTimelineSearch:u,openTimelineSearch:d=!1,resizeParentContainer:p,onValidityChange:m,isDisabled:g,resetToSavedQuery:b,onSavedQueryError:f})=>{const{value:h,setValue:E}=s,[v,k]=Object(i.useState)(-1),[N,R]=Object(i.useState)(!1),[P,L]=Object(i.useState)(e),[B,q]=Object(i.useState)(!1),{isInvalid:z,errorMessage:$}=Object(F.i)(s),{uiSettings:V}=Object(y.k)().services,[U]=Object(i.useState)(new j.FilterManager(V)),H=Object(M.a)();Object(i.useEffect)((()=>{null!=m&&m(!z)}),[z,m]),Object(i.useEffect)((()=>{let e=!0;const t=new x.Subscription;return U.setFilters([]),t.add(U.getUpdates$().subscribe({next:()=>{if(e){const e=U.getFilters(),{filters:t}=h;S()(t,e)||E({...h,filters:e})}}})),()=>{e=!1,t.unsubscribe()}}),[h,U,E]),Object(i.useEffect)((()=>{let e=!0;return async function(){const{filters:t,saved_id:a}=h;if(S()(t,U.getFilters())||U.setFilters(t),null!=a&&null!=P&&a!==P.id||null!=a&&null==P)try{const t=await H.getSavedQuery(a);e&&null!=t&&L(t),q(!1)}catch{L(void 0),q(!0)}else null==a&&null!=P&&L(void 0)}(),()=>{e=!1}}),[h,U,P,H,q,E]),Object(i.useEffect)((()=>{B&&(null==f||f())}),[f,B]),Object(i.useEffect)((()=>{if(b&&P){const e=_(P);E(e)}}),[b,P,E]);const G=Object(i.useCallback)((e=>{const{query:t}=h;S()(t,e)||E({...h,query:e})}),[h,E]),Q=Object(i.useCallback)((e=>{const{query:t}=h;if(!S()(t,e)){const t=B?null:h.saved_id;E({...h,query:e,saved_id:t})}}),[h,E,B]),W=Object(i.useCallback)((e=>{if(null!=e){const{saved_id:t}=h;if(q(!1),L(e),e.id!==t){const t=_(e);E(t)}else E({filters:[],query:{query:"",language:"kuery"},saved_id:null})}}),[h,E,q]),K=Object(i.useCallback)((()=>{R(!0),u()}),[u]),Y=Object(i.useCallback)((e=>{var a,n,i,r,s,o,c;R(!1);const u={query:null!==(a=null===(n=e.kqlQuery.filterQuery)||void 0===n||null===(i=n.kuery)||void 0===i?void 0:i.expression)&&void 0!==a?a:"",language:null!==(r=null===(s=e.kqlQuery.filterQuery)||void 0===s||null===(o=s.kuery)||void 0===o?void 0:o.kind)&&void 0!==r?r:"kuery"},d=null!=e.dataProviders&&e.dataProviders.length>0?Object(C.b)(Object(T.g)(e.dataProviders,t),l):"",p=null!==(c=e.filters)&&void 0!==c?c:[];E({filters:""!==d?[...p,Object(I.b)(d)]:p,query:u,saved_id:null})}),[t,l,E]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(n.EuiFormRow,{label:s.label,labelAppend:s.labelAppend,helpText:s.helpText,error:$,isInvalid:z,fullWidth:!0,"data-test-subj":a,describedByIds:o?[o]:void 0},r.a.createElement(n.EuiMutationObserver,{observerOptions:{subtree:!0,attributes:!0,childList:!0},onMutation:()=>{if(null!=p){const e=document.getElementById("kbnTypeahead__items");if(null!=e){const t=e.getBoundingClientRect(),a=document.getElementById("define-rule");if(null!=a){const e=a.getBoundingClientRect();(-1===v||e.height<v+t.height)&&p(v+t.height-100),-1===v&&k(e.height)}}else p(-1)}}},(e=>r.a.createElement("div",{ref:e},r.a.createElement(w.a,{indexPattern:l,isLoading:c||N,isRefreshPaused:!1,filterQuery:h.query,filterManager:U,filters:U.getFilters()||[],onChangedQuery:Q,onSubmitQuery:G,savedQuery:P,onSavedQuery:W,hideSavedQuery:!1,displayStyle:"inPage",isDisabled:g}))))),d?r.a.createElement(O.a,{hideActions:A,modalTitle:D,onClose:K,onOpen:Y}):null)};var R=a(349),P=a(166);const L=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.eqlTypeTitle",{defaultMessage:"Event Correlation"}),B=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.eqlTypeDescription",{defaultMessage:"Use Event Query Language (EQL) to match events, generate sequences, and stack data"}),q=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.queryTypeTitle",{defaultMessage:"Custom query"}),z=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.queryTypeDescription",{defaultMessage:"Use KQL or Lucene to detect issues across indices."}),$=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.mlTypeTitle",{defaultMessage:"Machine Learning"}),V=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.mlTypeDescription",{defaultMessage:"Select ML job to detect anomalous activity."}),U=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.thresholdTypeTitle",{defaultMessage:"Threshold"}),H=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.thresholdTypeDescription",{defaultMessage:"Aggregate query results to detect when number of matches exceeds threshold."}),G=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.threatMatchTitle",{defaultMessage:"Indicator Match"}),Q=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.threatMatchDescription",{defaultMessage:"Use indicators from intelligence sources to detect matching events and alerts."}),W=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.newTermsTitle",{defaultMessage:"New Terms"}),K=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.newTermsDescription",{defaultMessage:"Find documents with values appearing for the first time."}),Y=o.a.span.withConfig({displayName:"SmallText",componentId:"sc-lss4m0-0"})(["font-size:",";"],(({theme:e})=>e.eui.euiFontSizeS)),J=({hasValidLicense:e=!1})=>r.a.createElement(Y,null,e?V:r.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.mlTypeDisabledDescription",defaultMessage:"Access to ML requires a {subscriptionsLink}.",values:{subscriptionsLink:r.a.createElement(n.EuiLink,{href:"https://www.elastic.co/subscriptions",target:"_blank"},r.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.components.stepDefineRule.ruleTypeField.subscriptionsLink",defaultMessage:"Platinum subscription"}))}}));J.displayName="MlCardDescriptionComponent";const X=r.a.memo(J);X.displayName="MlCardDescription";const Z=({describedByIds:e=[],field:t,isUpdateView:a,hasValidLicense:s,isMlAdmin:o})=>{const l=t.value,c=Object(i.useCallback)((e=>{t.setValue(e)}),[t]),u=Object(i.useCallback)((()=>c("eql")),[c]),d=Object(i.useCallback)((()=>c("machine_learning")),[c]),p=Object(i.useCallback)((()=>c("query")),[c]),g=Object(i.useCallback)((()=>c("threshold")),[c]),b=Object(i.useCallback)((()=>c("threat_match")),[c]),f=Object(i.useCallback)((()=>c("new_terms")),[c]),y=Object(i.useMemo)((()=>({onClick:u,isSelected:Object(P.b)(l)})),[l,u]),h=Object(i.useMemo)((()=>({onClick:p,isSelected:Object(P.e)(l)})),[l,p]),E=Object(i.useMemo)((()=>({isDisabled:!s||!o,onClick:d,isSelected:Object(m.d)(l)})),[l,d,s,o]),v=Object(i.useMemo)((()=>({onClick:g,isSelected:Object(P.g)(l)})),[l,g]),x=Object(i.useMemo)((()=>({onClick:b,isSelected:Object(P.f)(l)})),[l,b]),k=Object(i.useMemo)((()=>({onClick:f,isSelected:Object(P.d)(l)})),[l,f]),S=R.css`
    padding-bottom: 60px;
    position: relative;

    & > button {
      position: absolute;
      left: 0;
      right: 0;
      bottom: 0;
      border-radius: 0;
    }
  `;return r.a.createElement(n.EuiFormRow,{fullWidth:!0,"data-test-subj":"selectRuleType",describedByIds:e,label:t.label},r.a.createElement(n.EuiFlexGrid,{columns:3},(!a||h.isSelected)&&r.a.createElement(n.EuiFlexItem,null,r.a.createElement(n.EuiCard,{"data-test-subj":"customRuleType",title:q,titleSize:"xs",description:z,icon:r.a.createElement(n.EuiIcon,{size:"xl",type:"search"}),selectable:h,layout:"horizontal",className:S})),(!a||E.isSelected)&&r.a.createElement(n.EuiFlexItem,null,r.a.createElement(n.EuiCard,{"data-test-subj":"machineLearningRuleType",title:$,titleSize:"xs",description:r.a.createElement(X,{hasValidLicense:s}),icon:r.a.createElement(n.EuiIcon,{size:"l",type:"machineLearningApp"}),isDisabled:E.isDisabled&&!E.isSelected,selectable:E,layout:"horizontal",className:S})),(!a||v.isSelected)&&r.a.createElement(n.EuiFlexItem,null,r.a.createElement(n.EuiCard,{"data-test-subj":"thresholdRuleType",title:U,titleSize:"xs",description:H,icon:r.a.createElement(n.EuiIcon,{size:"l",type:"indexFlush"}),selectable:v,layout:"horizontal",className:S})),(!a||y.isSelected)&&r.a.createElement(n.EuiFlexItem,null,r.a.createElement(n.EuiCard,{"data-test-subj":"eqlRuleType",title:L,titleSize:"xs",description:B,icon:r.a.createElement(n.EuiIcon,{size:"l",type:"eql"}),selectable:y,layout:"horizontal",className:S})),(!a||x.isSelected)&&r.a.createElement(n.EuiFlexItem,null,r.a.createElement(n.EuiCard,{"data-test-subj":"threatMatchRuleType",title:G,titleSize:"xs",description:Q,icon:r.a.createElement(n.EuiIcon,{size:"l",type:"list"}),selectable:x,layout:"horizontal",className:S})),(!a||k.isSelected)&&r.a.createElement(n.EuiFlexItem,null,r.a.createElement(n.EuiCard,{"data-test-subj":"newTermsRuleType",title:W,titleSize:"xs",description:K,icon:r.a.createElement(n.EuiIcon,{size:"l",type:"magnifyWithPlus"}),selectable:k,layout:"horizontal",className:S}))))},ee=({describedByIds:e=[],field:t})=>{const a=t.value,s=Object(i.useCallback)((e=>{const a=Number(e.target.value);t.setValue(a)}),[t]);return r.a.createElement(n.EuiFormRow,{label:t.label,"data-test-subj":"anomalyThresholdSlider",describedByIds:e},r.a.createElement(n.EuiFlexGroup,null,r.a.createElement(n.EuiFlexItem,null,r.a.createElement(n.EuiRange,{value:a,onChange:s,fullWidth:!0,showInput:!0,showRange:!0,showTicks:!0,tickInterval:25}))))};var te=a(378);const ae=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customQueryFieldRequiredError",{defaultMessage:"A custom query is required."}),ne=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.savedQueryFieldRequiredError",{defaultMessage:"Failed to load the saved query. Select a new one or add a custom query."}),ie=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.eqlQueryFieldRequiredError",{defaultMessage:"An EQL query is required."}),re=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customQueryFieldInvalidError",{defaultMessage:"The KQL is invalid"}),se=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.indicesHelperDescription",{defaultMessage:"Enter the pattern of Elasticsearch indices where you would like this rule to run. By default, these will include index patterns defined in Security Solution advanced settings."}),oe=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.resetDefaultIndicesButton",{defaultMessage:"Reset to default index patterns"}),le=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.importTimelineQueryButton",{defaultMessage:"Import query from saved timeline"}),ce=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.mlJobSelectPlaceholderText",{defaultMessage:"Select a job"}),ue=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldQuerBarLabel",{defaultMessage:"Custom query"}),de=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.EqlQueryBarLabel",{defaultMessage:"EQL query"}),pe=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.SavedQueryFormRowLabel",{defaultMessage:"Saved query"}),me=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.threatMatchingIcesHelperDescription",{defaultMessage:"Select threat indices"}),ge=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customThreatQueryFieldRequiredError",{defaultMessage:"At least one indicator match is required."}),be=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customThreatQueryFieldRequiredEmptyError",{defaultMessage:"All matches require both a field and threat index field."}),fe=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.source",{defaultMessage:"Source"}),ye=(l.i18n.translate("xpack.securitySolution.detections.dataSource.popover.title",{defaultMessage:"Select a data source"}),l.i18n.translate("xpack.securitySolution.detections.dataSource.popover.subTitle",{defaultMessage:"Data sources"}),l.i18n.translate("xpack.securitySolution.detections.dataSource.popover.content",{defaultMessage:"Rules can now query index patterns or data views."}),l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.rulePreviewTitle",{defaultMessage:"Rule Preview"}),o.a.div.withConfig({displayName:"HelpTextWarningContainer",componentId:"sc-v7btd6-0"})(["margin-top:10px;"])),he=({href:e,notRunningJobIds:t})=>r.a.createElement(r.a.Fragment,null,r.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.createRule.stepDefineRule.machineLearningJobIdHelpText",defaultMessage:"We've provided a few common jobs to get you started. To add your own custom jobs, assign a group of 'security' to those jobs in the {machineLearning} application to make them appear here.",values:{machineLearning:r.a.createElement(n.EuiLink,{href:e,target:"_blank"},r.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.components.mlJobSelect.machineLearningLink",defaultMessage:"Machine Learning"}))}}),t.length>0&&r.a.createElement(ye,{"data-test-subj":"ml-warning-not-running-jobs"},r.a.createElement(n.EuiText,{size:"xs"},r.a.createElement("span",null,1===t.length?r.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.createRule.stepDefineRule.mlEnableJobSingle",defaultMessage:"The selected ML job, {jobName}, is not currently running. We will start {jobName} when you enable this rule.",values:{jobName:t[0]}}):r.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.createRule.stepDefineRule.mlEnableJobMulti",defaultMessage:"The selected ML jobs, {jobNames}, are not currently running. We will start all of these jobs when you enable this rule.",values:{jobNames:t.reduce(((e,t,a,n)=>e+(a<n.length-1?", ":", and ")+t))}}))))),Ee=r.a.memo(he),ve=l.i18n.translate("xpack.securitySolution.detectionEngine.mlSelectJob.createCustomJobButtonTitle",{defaultMessage:"Create custom job"}),xe=o.a.div.withConfig({displayName:"JobDisplayContainer",componentId:"sc-1kiq2lp-0"})(["width:100%;height:100%;display:flex;flex-direction:column;"]),ke=o()(n.EuiFlexGroup).withConfig({displayName:"MlJobSelectEuiFlexGroup",componentId:"sc-1kiq2lp-1"})(["margin-bottom:5px;"]),Se=o()(n.EuiButton).withConfig({displayName:"MlJobEuiButton",componentId:"sc-1kiq2lp-2"})(["margin-top:20px;"]),je=({id:e,description:t})=>r.a.createElement(xe,null,r.a.createElement("strong",null,e),r.a.createElement(n.EuiToolTip,{content:t},r.a.createElement(n.EuiText,{size:"xs",color:"subdued"},r.a.createElement("p",null,t)))),Oe=e=>r.a.createElement(je,{id:e.value.id,description:e.value.description}),we=({describedByIds:e=[],field:t})=>{const a=t.value,{isInvalid:s,errorMessage:o}=Object(F.i)(t),{loading:l,jobs:c}=Object(te.a)(),{getUrlForApp:u,navigateToApp:d}=Object(y.k)().services.application,p=u("ml"),g=Object(i.useCallback)((e=>{const a=e.map((e=>e.value.id));t.setValue(a)}),[t]),b=c.map((e=>({value:{id:e.id,description:e.description},label:e.id}))),f=b.filter((e=>a.includes(e.value.id))),h=Object(i.useMemo)((()=>c.filter((({id:e})=>a.includes(e))).reduce(((e,t)=>(Object(m.c)(t.jobState,t.datafeedState)||e.push(t.id),e)),[])),[c,a]);return r.a.createElement(ke,{justifyContent:"flexStart"},r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiFormRow,{label:t.label,helpText:r.a.createElement(Ee,{href:p,notRunningJobIds:h}),isInvalid:s,error:o,"data-test-subj":"mlJobSelect",describedByIds:e},r.a.createElement(n.EuiFlexGroup,null,r.a.createElement(n.EuiFlexItem,null,r.a.createElement(n.EuiComboBox,{isLoading:l,onChange:g,options:b,placeholder:ce,renderOption:Oe,rowHeight:50,selectedOptions:f}))))),r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(Se,{iconType:"popout",iconSide:"right",onClick:()=>d("ml",{openInNewTab:!0})},ve)))};var Te=a(919),Ie=a(371),Ce=a(493);const Me=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.thresholdField.thresholdFieldPlaceholderText",{defaultMessage:"All results"}),Fe=o()(n.EuiFlexItem).withConfig({displayName:"OperatorWrapper",componentId:"sc-10hzoxx-0"})(["align-self:center;"]),De=["detectionEngineStepDefineRuleThresholdField"],Ae=["detectionEngineStepDefineRuleThresholdValue"],_e=["detectionEngineStepDefineRuleThresholdCardinalityField"],Ne=["detectionEngineStepDefineRuleThresholdCardinalityValue"],Re=({thresholdField:e,thresholdValue:t,browserFields:a,thresholdCardinalityField:s,thresholdCardinalityValue:o})=>{const l=Object(i.useMemo)((()=>({fullWidth:!0,noSuggestions:!1,options:a.map((e=>({label:e.name}))),placeholder:Me,onCreateOption:void 0,style:{width:"410px"}})),[a]),c=Object(i.useMemo)((()=>({fullWidth:!0,noSuggestions:!1,options:a.map((e=>({label:e.name}))),placeholder:Me,onCreateOption:void 0,style:{width:"410px"},singleSelection:{asPlainText:!0}})),[a]);return r.a.createElement(n.EuiFlexGroup,{direction:"column",style:{marginLeft:0}},r.a.createElement(n.EuiFlexGroup,null,r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(F.b,{field:e,idAria:De[0],"data-test-subj":De[0],describedByIds:De,type:e.type,euiFieldProps:l})),r.a.createElement(Fe,{grow:!1},">="),r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(F.b,{field:t,idAria:Ae[0],"data-test-subj":Ae[0],describedByIds:Ae,type:t.type}))),r.a.createElement(n.EuiFlexGroup,null,r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(F.b,{field:s,idAria:_e[0],"data-test-subj":_e[0],describedByIds:_e,type:s.type,euiFieldProps:c})),r.a.createElement(Fe,{grow:!1},">="),r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(F.b,{field:o,idAria:Ne[0],"data-test-subj":Ne[0],describedByIds:Ne,type:o.type}))))},Pe=r.a.memo(Re);var Le=a(45),Be=a(117),qe=a.n(Be),ze=a(132),$e=a(502);const Ve=()=>Object(ze.d)({field:"",type:"mapping",value:""});var Ue=a(1),He=a(584);const Ge={index:{defaultValue:[],fieldsToValidateOnChange:["index","queryBar"],type:F.a.COMBO_BOX,label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fiedIndexPatternsLabel",{defaultMessage:"Index patterns"}),helpText:r.a.createElement(n.EuiText,{size:"xs"},se),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(!Object(m.d)(t.ruleType)&&t.dataSourceType===E.a.IndexPatterns)return F.h.emptyField(l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.outputIndiceNameFieldRequiredError",{defaultMessage:"A minimum of one index pattern is required."}))(...e)}}]},dataViewTitle:{label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.dataViewSelector",{defaultMessage:"Data View"}),validations:[]},dataViewId:{fieldsToValidateOnChange:["dataViewId"],validations:[{validator:(...e)=>{const[{path:t,formData:a}]=e,n=null!=a.dataViewId&&""!==a.dataViewId;if(!Object(m.d)(a.ruleType)&&!n&&a.dataSourceType===E.a.DataView)return{path:t,message:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.dataViewSelectorFieldRequired",{defaultMessage:"Please select an available Data View or Index Pattern."})}}}]},eqlOptions:{},queryBar:{validations:[{validator:(...e)=>{const[{value:t,path:a,formData:n}]=e,{query:i,filters:r,saved_id:s}=t;if(!Object(m.d)(n.ruleType)&&Object(c.isEmpty)(i.query)&&Object(c.isEmpty)(r))return s?{code:"ERR_FIELD_MISSING",path:a,message:ne}:{code:"ERR_FIELD_MISSING",path:a,message:Object(P.b)(n.ruleType)?ie:ae}}},{validator:(...e)=>{const[{value:t,path:a,formData:n}]=e,{query:i}=t;if(!Object(m.d)(n.ruleType)&&!Object(c.isEmpty)(i.query)&&"kuery"===i.language)try{Object(Le.fromKueryExpression)(i.query)}catch(e){return{code:"ERR_FIELD_FORMAT",path:a,message:re}}}},{validator:Object(He.a)(He.b,300)}]},ruleType:{label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldRuleTypeLabel",{defaultMessage:"Rule type"}),validations:[]},anomalyThreshold:{label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldAnomalyThresholdLabel",{defaultMessage:"Anomaly score threshold"}),validations:[]},machineLearningJobId:{label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldMachineLearningJobIdLabel",{defaultMessage:"Machine Learning job"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(m.d)(t.ruleType))return F.h.emptyField(l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.machineLearningJobIdRequired",{defaultMessage:"A Machine Learning job is required."}))(...e)}}]},relatedIntegrations:{label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRelatedIntegrationsLabel",{defaultMessage:"Related integrations"}),helpText:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRelatedIntegrationsHelpText",{defaultMessage:"Integration related to this Rule."})},requiredFields:{label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRequiredFieldsLabel",{defaultMessage:"Required fields"}),helpText:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRequiredFieldsHelpText",{defaultMessage:"Fields required for this Rule to function."})},timeline:{label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimelineTemplateLabel",{defaultMessage:"Timeline template"}),helpText:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimelineTemplateHelpText",{defaultMessage:"Select which timeline to use when investigating generated alerts."})},threshold:{label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThresholdLabel",{defaultMessage:"Threshold"}),field:{type:F.a.COMBO_BOX,label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThresholdFieldLabel",{defaultMessage:"Group by"}),helpText:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThresholdFieldHelpText",{defaultMessage:"Select fields to group by. Fields are joined together with 'AND'"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(P.g)(t.ruleType))return F.h.maxLengthField({length:3,message:l.i18n.translate("xpack.securitySolution.detectionEngine.validations.thresholdFieldFieldData.arrayLengthGreaterThanMaxErrorMessage",{defaultMessage:"Number of fields must be 3 or less."})})(...e)}}]},value:{type:F.a.NUMBER,label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThresholdValueLabel",{defaultMessage:"Threshold"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(P.g)(t.ruleType))return F.h.numberGreaterThanField({than:1,message:l.i18n.translate("xpack.securitySolution.detectionEngine.validations.thresholdValueFieldData.numberGreaterThanOrEqualOneErrorMessage",{defaultMessage:"Value must be greater than or equal to one."}),allowEquality:!0})(...e)}}]},cardinality:{field:{defaultValue:[],fieldsToValidateOnChange:["threshold.cardinality.field","threshold.cardinality.value"],type:F.a.COMBO_BOX,label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThresholdCardinalityFieldLabel",{defaultMessage:"Count"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(P.g)(t.ruleType))return Object(c.isEmpty)(t["threshold.cardinality.field"])&&!Object(c.isEmpty)(t["threshold.cardinality.value"])?F.h.emptyField(l.i18n.translate("xpack.securitySolution.detectionEngine.validations.thresholdCardinalityFieldFieldData.thresholdCardinalityFieldNotSuppliedMessage",{defaultMessage:"A Cardinality Field is required."}))(...e):void 0}}],helpText:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThresholdFieldCardinalityFieldHelpText",{defaultMessage:"Select a field to check cardinality"})},value:{fieldsToValidateOnChange:["threshold.cardinality.field","threshold.cardinality.value"],type:F.a.NUMBER,label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThresholdCardinalityValueFieldLabel",{defaultMessage:"Unique values"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(P.g)(t.ruleType))return Object(c.isEmpty)(t["threshold.cardinality.field"])?void 0:F.h.numberGreaterThanField({than:1,message:l.i18n.translate("xpack.securitySolution.detectionEngine.validations.thresholdCardinalityValueFieldData.numberGreaterThanOrEqualOneErrorMessage",{defaultMessage:"Value must be greater than or equal to one."}),allowEquality:!0})(...e)}}]}}},threatIndex:{type:F.a.COMBO_BOX,label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThreatIndexPatternsLabel",{defaultMessage:"Indicator index patterns"}),helpText:r.a.createElement(n.EuiText,{size:"xs"},me),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(P.f)(t.ruleType))return F.h.emptyField(l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.threatMatchoutputIndiceNameFieldRequiredError",{defaultMessage:"A minimum of one index pattern is required."}))(...e)}},{validator:(...e)=>{const[{formData:t,value:a}]=e;if(Object(P.f)(t.ruleType))return((e,t)=>{let a;if(a="string"==typeof e?e===t:!!Array.isArray(e)&&!!e.find((e=>e===t)),a)return{code:"ERR_FIELD_FORMAT",message:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.threatMatchIndexForbiddenError",{defaultMessage:"The index pattern cannot be { forbiddenString }. Please choose a more specific index pattern.",values:{forbiddenString:t}})}})(a,"*")}}]},threatMapping:{label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThreatMappingLabel",{defaultMessage:"Indicator mapping"}),validations:[{validator:(...e)=>{const[{path:t,formData:a}]=e;var n;if(Object(P.f)(a.ruleType))return 1===(n=a.threatMapping).length&&1===n[0].entries.length&&""===n[0].entries[0].field&&""===n[0].entries[0].value?{code:"ERR_FIELD_MISSING",path:t,message:ge}:(e=>e.some((e=>e.entries.some((e=>""===e.field||""===e.value)))))(a.threatMapping)?{code:"ERR_FIELD_MISSING",path:t,message:be}:void 0}}]},threatQueryBar:{label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThreatQueryBarLabel",{defaultMessage:"Indicator index query"}),validations:[{validator:(...e)=>{const[{value:t,path:a,formData:n}]=e;if(!Object(P.f)(n.ruleType))return;const{query:i,filters:r}=t;return Object(c.isEmpty)(i.query)&&Object(c.isEmpty)(r)?{code:"ERR_FIELD_MISSING",path:a,message:ae}:void 0}},{validator:(...e)=>{const[{value:t,path:a,formData:n}]=e;if(!Object(P.f)(n.ruleType))return;const{query:i}=t;if(!Object(c.isEmpty)(i.query)&&"kuery"===i.language)try{Object(Le.fromKueryExpression)(i.query)}catch(e){return{code:"ERR_FIELD_FORMAT",path:a,message:re}}}}]},groupByFields:{type:F.a.COMBO_BOX,label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.groupByFieldsLabel",{defaultMessage:"Suppress alerts by"}),labelAppend:r.a.createElement(n.EuiText,{color:"subdued",size:"xs"},l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.groupByFieldsLabelAppend",{defaultMessage:"Optional (Technical Preview)"})),helpText:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldGroupByFieldHelpText",{defaultMessage:"Select field(s) to use for suppressing extra alerts"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(P.e)(t.ruleType))return F.h.maxLengthField({length:3,message:l.i18n.translate("xpack.securitySolution.detectionEngine.validations.stepDefineRule.groupByFieldsMax",{defaultMessage:"Number of grouping fields must be at most 3"})})(...e)}}]},newTermsFields:{type:F.a.COMBO_BOX,label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.newTermsFieldsLabel",{defaultMessage:"Fields"}),helpText:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldNewTermsFieldHelpText",{defaultMessage:"Select a field to check for new terms."}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(P.d)(t.ruleType))return F.h.emptyField(l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.newTermsFieldsMin",{defaultMessage:"A minimum of one field is required."}))(...e)}},{validator:(...e)=>{const[{formData:t}]=e;if(Object(P.d)(t.ruleType))return F.h.maxLengthField({length:Ue.Qb,message:l.i18n.translate("xpack.securitySolution.detectionEngine.validations.stepDefineRule.newTermsFieldsMax",{defaultMessage:"Number of fields must be 3 or less."})})(...e)}}]},historyWindowSize:{label:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.historyWindowSizeLabel",{defaultMessage:"History Window Size"}),helpText:l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.historyWindowSizeHelpText",{defaultMessage:"New terms rules only alert if terms don't appear in historical data."})},shouldLoadQueryDynamically:{type:F.a.CHECKBOX,defaultValue:!1}};var Qe=a(906);const We=l.i18n.translate("xpack.securitySolution.detectionEngine.stepDefineRule.pickDataView",{defaultMessage:"Select a Data View"}),Ke=l.i18n.translate("xpack.securitySolution.detectionEngine.stepDefineRule.dataViewNotFoundLabel",{defaultMessage:"Selected data view not found"}),Ye=l.i18n.translate("xpack.securitySolution.detectionEngine.stepDefineRule.dataViewIncludesAlertsIndexLabel",{defaultMessage:"Default Security data view"}),Je=l.i18n.translate("xpack.securitySolution.detectionEngine.stepDefineRule.dataViewIncludesAlertsIndexDescription",{defaultMessage:"The default Security data view includes the alerts index. This could result in redundant alerts being generated from existing alerts."}),Xe=({kibanaDataViews:e,field:t})=>{let a,s,o;if(null!=t){const e=Object(F.i)(t);a=e.isInvalid,s=e.errorMessage,o=t.value}const c=Object(i.useMemo)((()=>null!=e&&Object.keys(e).length>0),[e]),u=Object(i.useMemo)((()=>null!=o&&""!==o&&c&&!Object.hasOwn(e,o)),[c,o,e]),[d,p]=Object(i.useState)(u||null==o||""===o?[]:[{id:e[o].id,label:e[o].title}]),[m,g]=Object(i.useState)(!1);Object(i.useEffect)((()=>{if(!u&&o){const t=e[o].title,a=e[o].id;g("security-solution-default"===a),p([{id:a,label:t}])}else p([])}),[o,t,e,u,g]);const b=Object(i.useMemo)((()=>c?Object.values(e).map((e=>({label:e.title,id:e.id}))):[]),[c,e]);return r.a.createElement(r.a.Fragment,null,u&&null!=o&&r.a.createElement(r.a.Fragment,null,r.a.createElement(n.EuiCallOut,{title:Ke,color:"warning",iconType:"help"},r.a.createElement("p",null,(f=o,l.i18n.translate("xpack.securitySolution.detectionEngine.stepDefineRule.dataViewNotFoundDescription",{values:{dataView:f},defaultMessage:'Your data view of "id": "{dataView}" was not found. It could be that it has since been deleted.'})))),r.a.createElement(n.EuiSpacer,{size:"s"})),m&&r.a.createElement(r.a.Fragment,null,r.a.createElement(n.EuiCallOut,{title:Ye,color:"warning",iconType:"help","data-test-subj":"defaultSecurityDataViewWarning"},r.a.createElement("p",null,Je)),r.a.createElement(n.EuiSpacer,{size:"s"})),r.a.createElement(n.EuiFormRow,{label:null==t?void 0:t.label,helpText:null==t?void 0:t.helpText,error:s,isInvalid:a,"data-test-subj":"pick-rule-data-source"},r.a.createElement(n.EuiComboBox,{isClearable:!0,singleSelection:{asPlainText:!0},onChange:e=>{const a=e;if(p(null!=a?a:[]),null!=a&&a.length>0&&null!=a[0].id){const e=a[0].id;null==t||t.setValue(e)}else null==t||t.setValue(void 0)},options:b,selectedOptions:d,"aria-label":We,placeholder:We,"data-test-subj":"detectionsDataViewSelectorDropdown"})));var f};var Ze=a(265),et=a(468);const tt=o()(n.EuiFlexItem).withConfig({displayName:"FlexItemWithLabel",componentId:"sc-1i1appc-0"})(["padding-top:20px;text-align:center;"]),at=o()(n.EuiFlexItem).withConfig({displayName:"FlexItemWithoutLabel",componentId:"sc-1i1appc-1"})(["text-align:center;"]),nt=({entry:e,indexPattern:t,threatIndexPatterns:a,showLabel:s,onChange:o})=>{const l=Object(i.useCallback)((([t])=>{const{updatedEntry:a,index:n}=((e,t)=>{const{entryIndex:a}=e;return{updatedEntry:{id:e.id,field:null!=t?t.name:"",type:"mapping",value:null!=e.value?e.value.name:""},index:a}})(e,t);o(a,n)}),[o,e]),c=Object(i.useCallback)((([t])=>{const{updatedEntry:a,index:n}=((e,t)=>{const{entryIndex:a}=e;return{updatedEntry:{id:e.id,field:null!=e.field?e.field.name:"",type:"mapping",value:null!=t?t.name:""},index:a}})(e,t);o(a,n)}),[o,e]),u=Object(i.useMemo)((()=>{const a=r.a.createElement(Ze.b,{placeholder:et.c,indexPattern:t,selectedField:e.field,isClearable:!1,isLoading:!1,isDisabled:null==t,onChange:l,"data-test-subj":"entryField",fieldInputWidth:360});return s?r.a.createElement(n.EuiFormRow,{label:et.b,"data-test-subj":"entryItemFieldInputFormRow"},a):r.a.createElement(n.EuiFormRow,{label:"","data-test-subj":"entryItemFieldInputFormRow"},a)}),[l,t,e,s]),d=Object(i.useMemo)((()=>{const t=r.a.createElement(Ze.b,{placeholder:et.c,indexPattern:a,selectedField:e.value,isClearable:!1,isLoading:!1,isDisabled:null==a,onChange:c,"data-test-subj":"threatEntryField",fieldInputWidth:360});return s?r.a.createElement(n.EuiFormRow,{label:et.f,"data-test-subj":"threatFieldInputFormRow"},t):r.a.createElement(n.EuiFormRow,{label:"","data-test-subj":"threatFieldInputFormRow"},t)}),[c,a,e,s]);return r.a.createElement(n.EuiFlexGroup,{direction:"row",gutterSize:"s",alignItems:"center",justifyContent:"spaceAround","data-test-subj":"itemEntryContainer"},r.a.createElement(n.EuiFlexItem,{grow:!1},u),r.a.createElement(n.EuiFlexItem,{grow:!0},r.a.createElement(n.EuiFlexGroup,{justifyContent:"spaceAround",alignItems:"center"},s?r.a.createElement(tt,{grow:!0},et.d):r.a.createElement(at,{grow:!0},et.d))),r.a.createElement(n.EuiFlexItem,{grow:!1},d))};nt.displayName="EntryItem";const it=o()(n.EuiFlexItem).withConfig({displayName:"MyFirstRowContainer",componentId:"sc-136w498-0"})(["padding-top:20px;"]),rt=r.a.memo((({entries:e,isOnlyItem:t,entryIndex:a,itemIndex:s,onDelete:o})=>{const l=t&&1===e.length&&0===s&&(null==e[0].field||""===e[0].field),c=Object(i.useCallback)((()=>{o(a)}),[o,a]),u=r.a.createElement(n.EuiButtonIcon,{color:"danger",iconType:"trash",onClick:c,isDisabled:l,"aria-label":"entryDeleteButton",className:"itemEntryDeleteButton","data-test-subj":"itemEntryDeleteButton"});return 0===a&&0===s?r.a.createElement(it,{grow:!1,"data-test-subj":"firstRowDeleteButton"},u):r.a.createElement(n.EuiFlexItem,{grow:!1,"data-test-subj":"deleteButton"},u)}));rt.displayName="EntryDeleteButton";var st=a(421);const ot=o()(n.EuiFlexItem).withConfig({displayName:"MyInvisibleAndBadge",componentId:"sc-d6yaa8-0"})(["visibility:hidden;"]),lt=o()(n.EuiFlexItem).withConfig({displayName:"MyFirstRowContainer",componentId:"sc-d6yaa8-1"})(["padding-top:20px;"]),ct=r.a.memo((({entriesLength:e,entryItemIndex:t})=>{const a=r.a.createElement(st.a,{includeAntennas:!0,type:"and"});return e>1&&0===t?r.a.createElement(lt,{grow:!1,"data-test-subj":"entryItemEntryFirstRowAndBadge"},a):e<=1?r.a.createElement(ot,{grow:!1,"data-test-subj":"entryItemEntryInvisibleAndBadge"},a):r.a.createElement(n.EuiFlexItem,{grow:!1,"data-test-subj":"entryItemEntryAndBadge"},a)}));ct.displayName="AndBadge";const ut=o()(n.EuiFlexItem).withConfig({displayName:"MyOverflowContainer",componentId:"sc-o1uavm-0"})(["overflow:hidden;width:100%;"]),dt=r.a.memo((({listItem:e,listItemIndex:t,indexPattern:a,threatIndexPatterns:s,isOnlyItem:o,andLogicIncluded:l,onDeleteEntryItem:c,onChangeEntryItem:u})=>{const d=Object(i.useCallback)(((a,n)=>{const i=[...e.entries.slice(0,n),{...a},...e.entries.slice(n+1)],r={...e,entries:i};u(r,t)}),[u,e,t]),p=Object(i.useCallback)((a=>{const n=((e,t)=>({...e,entries:[...e.entries.slice(0,t),...e.entries.slice(t+1)]}))(e,a);c(n,t)}),[e,c,t]),m=Object(i.useMemo)((()=>null!=a&&e.entries.length>0?((e,t,a)=>a.reduce(((a,n,i)=>{const r=((e,t,a,n,i=qe.a.v4)=>{var r;const{fields:s}=e,{fields:o}=t,l=a.field,c=a.value,[u]=s.filter((({name:e})=>null!=l&&l===e)),[d]=o.filter((({name:e})=>null!=c&&c===e));return{id:null!==(r=a.id)&&void 0!==r?r:i(),field:u,type:"mapping",value:d,entryIndex:n}})(e,t,n,i);return[...a,r]}),[]))(a,s,e.entries):[]),[e.entries,a,s]);return r.a.createElement(n.EuiFlexItem,null,r.a.createElement(n.EuiFlexGroup,{gutterSize:"s","data-test-subj":"entriesContainer"},l&&r.a.createElement(ct,{entriesLength:e.entries.length,entryItemIndex:t}),r.a.createElement(ut,{grow:6},r.a.createElement(n.EuiFlexGroup,{gutterSize:"s",direction:"column"},m.map(((i,l)=>r.a.createElement(n.EuiFlexItem,{key:i.id,grow:1},r.a.createElement(n.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",direction:"row"},r.a.createElement(ut,{grow:1},r.a.createElement(nt,{entry:i,threatIndexPatterns:s,indexPattern:a,showLabel:0===t&&0===l,onChange:d})),r.a.createElement(rt,{entries:e.entries,isOnlyItem:o,entryIndex:i.entryIndex,itemIndex:t,onDelete:p})))))))))}));dt.displayName="ListItem";const pt=o()(n.EuiButton).withConfig({displayName:"MyEuiButton",componentId:"sc-1dsnlky-0"})(["min-width:95px;"]),mt=({isOrDisabled:e=!1,isAndDisabled:t=!1,onAndClicked:a,onOrClicked:i})=>r.a.createElement(n.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(pt,{fill:!0,size:"s",iconType:"plusInCircle",onClick:a,"data-test-subj":"andButton",isDisabled:t},et.a)),r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(pt,{fill:!0,size:"s",iconType:"plusInCircle",onClick:i,isDisabled:e,"data-test-subj":"orButton"},et.e))),gt=o()(n.EuiFlexItem).withConfig({displayName:"MyInvisibleAndBadge",componentId:"sc-ph2s87-0"})(["visibility:hidden;"]),bt=o()(st.a).withConfig({displayName:"MyAndBadge",componentId:"sc-ph2s87-1"})(["& > .euiFlexItem{margin:0;}"]),ft=o()(n.EuiFlexItem).withConfig({displayName:"MyButtonsContainer",componentId:"sc-ph2s87-2"})(["margin:16px 0;"]),yt={andLogicIncluded:!1,entries:[],entriesToDelete:[]},ht=({listItems:e,indexPatterns:t,threatIndexPatterns:a,onChange:s})=>{const[{entries:o,entriesToDelete:l,andLogicIncluded:c},u]=Object(i.useReducer)(((e,t)=>{switch(t.type){case"setEntries":{const a=t.entries.filter((({entries:e})=>e.length>1)).length>0;return{...e,andLogicIncluded:a,entries:t.entries}}case"setDefault":return{...e,...t.initialState,entries:[{...t.lastEntry,entries:[Ve()]}]};default:return e}}),{...yt}),d=Object(i.useCallback)((e=>{u({type:"setEntries",entries:e})}),[u]),p=Object(i.useCallback)((e=>{u({type:"setDefault",initialState:yt,lastEntry:e})}),[u]),m=Object(i.useCallback)(((e,t)=>{const a=[...o.slice(0,t),{...e},...o.slice(t+1)];d(a)}),[d,o]),g=Object(i.useCallback)(((e,t)=>{0===e.entries.length?0===[...o.slice(0,t),...o.slice(t+1)].length?p(e):d([...o.slice(0,t),...o.slice(t+1)]):m(e,t)}),[m,d,o,p]),b=Object(i.useCallback)((()=>{const e=o[o.length-1],{entries:t}=e,a={...e,entries:[...t,Ve()]};d([...o.slice(0,o.length-1),{...a}])}),[d,o]),f=Object(i.useCallback)((()=>{const e=Object(ze.d)({entries:[Object(ze.d)({field:"",type:"mapping",value:""})]});d([...o,{...e}])}),[d,o]),y=Object(i.useCallback)((()=>{b()}),[b]);return Object(i.useEffect)((()=>{var e;s({entryItems:(e=o,e.reduce(((e,t)=>{const a={...t,entries:t.entries};return $e.t.is(a)?[...e,a]:e}),[])),entriesToDelete:l})}),[s,l,o]),Object(i.useEffect)((()=>{(0===o.length||1===o.length&&null!=o[0].entries&&0===o[0].entries.length)&&f()}),[o,f]),Object(i.useEffect)((()=>{e.length>0&&d(e)}),[]),r.a.createElement(n.EuiFlexGroup,{gutterSize:"s",direction:"column"},o.map(((e,i)=>{var s;const l=null!==(s=e.id)&&void 0!==s?s:`${i}`;return r.a.createElement(n.EuiFlexItem,{grow:1,key:l},r.a.createElement(n.EuiFlexGroup,{gutterSize:"s",direction:"column"},0!==i&&(c?r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiFlexGroup,{gutterSize:"none",direction:"row"},r.a.createElement(gt,{grow:!1},r.a.createElement(bt,{includeAntennas:!0,type:"and"})),r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(bt,{type:"or"})))):r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(bt,{type:"or"}))),r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(dt,{key:l,listItem:e,indexPattern:t,threatIndexPatterns:a,listItemIndex:i,andLogicIncluded:c,isOnlyItem:1===o.length,onDeleteEntryItem:g,onChangeEntryItem:m}))))})),r.a.createElement(ft,{"data-test-subj":"andOrOperatorButtons"},r.a.createElement(n.EuiFlexGroup,{gutterSize:"s"},c&&r.a.createElement(gt,{grow:!1},r.a.createElement(st.a,{includeAntennas:!0,type:"and"})),r.a.createElement(n.EuiFlexItem,{grow:1},r.a.createElement(mt,{isOrDisabled:!1,isAndDisabled:!1,onOrClicked:f,onAndClicked:y})))))};ht.displayName="ThreatMatch";const Et=Object(F.j)({component:F.b}),vt=({threatIndexModified:e,handleResetThreatIndices:t,threatMapping:a,indexPatterns:s,threatIndexPatterns:o,threatIndexPatternsLoading:l,threatBrowserFields:c,onValidityChange:u})=>{const{setValue:d,value:p}=a,{isInvalid:m,errorMessage:g}=Object(F.i)(a),[b,f]=Object(i.useState)(!1);Object(i.useEffect)((()=>{u&&u(!m&&b)}),[b,m,u]);const y=Object(i.useCallback)((({entryItems:e})=>{d(e)}),[d]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(n.EuiSpacer,{size:"m"}),r.a.createElement(n.EuiFlexGroup,{direction:"column"},r.a.createElement(n.EuiFlexItem,{grow:!0},r.a.createElement(Et,{path:"threatIndex",config:{...Ge.threatIndex,labelAppend:e?r.a.createElement(Lt,{onClick:t,iconType:"refresh"},oe):null},componentProps:{idAria:"detectionEngineStepDefineRuleThreatMatchIndices","data-test-subj":"detectionEngineStepDefineRuleThreatMatchIndices",euiFieldProps:{fullWidth:!0,isDisabled:!1,placeholder:""}}})),r.a.createElement(n.EuiFlexItem,{grow:!0},r.a.createElement(F.e,{path:"threatQueryBar",config:{...Ge.threatQueryBar,labelAppend:null},component:N,componentProps:{browserFields:c,idAria:"detectionEngineStepDefineThreatRuleQueryBar",indexPattern:o,isDisabled:!1,isLoading:l,dataTestSubj:"detectionEngineStepDefineThreatRuleQueryBar",openTimelineSearch:!1,onValidityChange:f}}))),r.a.createElement(n.EuiSpacer,{size:"m"}),r.a.createElement(n.EuiFormRow,{label:a.label,labelAppend:a.labelAppend,helpText:a.helpText,error:g,isInvalid:m,fullWidth:!0},r.a.createElement(ht,{listItems:p,indexPatterns:s,threatIndexPatterns:o,"data-test-subj":"threatmatch-builder","id-aria":"threatmatch-builder",onChange:y})),r.a.createElement(n.EuiSpacer,{size:"m"}))},xt=r.a.memo(vt);var kt=a(175);const St=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.newTermsField.placeholderText",{defaultMessage:"Select a field"}),jt=({browserFields:e,field:t})=>{const a=Object(i.useMemo)((()=>({fullWidth:!0,noSuggestions:!1,options:e.map((e=>({label:e.name}))),placeholder:St,onCreateOption:void 0,style:{width:"410px"}})),[e]);return r.a.createElement(F.b,{field:t,idAria:"detectionEngineStepDefineRuleNewTermsField",euiFieldProps:a})},Ot=r.a.memo(jt);var wt=a(592),Tt=a(720),It=a(535),Ct=a(881);const Mt=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.groupBy.placeholderText",{defaultMessage:"Select a field"}),Ft=l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.groupBy.licenseWarning",{defaultMessage:"Alert suppression is enabled with Platinum license or above"}),Dt=({browserFields:e,isDisabled:t,field:a})=>{const s=Object(i.useMemo)((()=>({fullWidth:!0,noSuggestions:!1,options:e.map((e=>({label:e.name}))),placeholder:Mt,onCreateOption:void 0,style:{width:"410px"},isDisabled:t})),[e,t]),o=r.a.createElement(F.b,{field:a,idAria:"detectionEngineStepDefineRuleGroupByField",euiFieldProps:s});return t?r.a.createElement(n.EuiToolTip,{position:"right",content:Ft},o):o},At=r.a.memo(Dt);var _t=a(13),Nt=a(244);const Rt=Object(F.j)({component:F.b}),Pt=o.a.div.withConfig({displayName:"StyledVisibleContainer",componentId:"sc-f0vskm-0"})(["display:",";"],(e=>e.isVisible?"block":"none")),Lt=o()(n.EuiButtonEmpty).withConfig({displayName:"MyLabelButton",componentId:"sc-f0vskm-1"})(["height:18px;font-size:12px;.euiIcon{width:14px;height:14px;}"]);Lt.defaultProps={flush:"right"};const Bt=o()(n.EuiFormRow).attrs((({$isVisible:e})=>({style:{display:e?"flex":"none"}}))).withConfig({displayName:"RuleTypeEuiFormRow",componentId:"sc-f0vskm-2"})([""]),qt=({addPadding:e=!1,defaultValues:t,descriptionColumns:a="singleSplit",isReadOnlyView:s,isLoading:u,isUpdateView:x=!1,onSubmit:k,setForm:S,kibanaDataViews:j,indicesConfig:O,threatIndicesConfig:w,onRuleDataChange:T,onPreviewDisabledStateChange:I,defaultSavedQuery:C})=>{const M=Object(f.a)(),[D,A]=Object(i.useState)(!1),[_,R]=Object(i.useState)(!1),[L,B]=Object(i.useState)(!1),[q,z]=Object(i.useState)(),$=Object(_t.b)(),{form:V}=Object(F.k)({defaultValue:t,options:{stripEmptyFields:!1},schema:Ge}),{getFields:U,getFormData:H,reset:G,validate:Q}=V,[W]=Object(F.m)({form:V,watch:["index","ruleType","queryBar","threshold","dataViewId","threshold.field","threshold.value","threshold.cardinality.field","threshold.cardinality.value","threatIndex","threatMapping","machineLearningJobId","anomalyThreshold","dataSourceType","newTermsFields","historyWindowSize","shouldLoadQueryDynamically","groupByFields"],onChange:e=>{T&&T({...e,eqlOptions:Me})}}),{index:K,ruleType:Y,queryBar:J,dataViewId:X,threatIndex:te,threatMapping:ae,machineLearningJobId:ne,dataSourceType:ie,newTermsFields:re,shouldLoadQueryDynamically:se}=W,[ce,me]=Object(i.useState)(!1),[ge,be]=Object(i.useState)(!1),ye=K||t.index,he=X||t.dataViewId,Ee=te||t.threatIndex,ve=Y||t.ruleType,xe=ie||t.dataSourceType,ke=null!=ne?ne:t.machineLearningJobId,[Se,je]=Object(i.useState)(!1);Object(i.useEffect)((()=>{I&&I(!Se)}),[Se,I]),Object(i.useEffect)((()=>{const e=Object(Ct.b)({ruleType:ve,isQueryBarValid:ce,isThreatQueryBarValid:ge,index:ye,dataViewId:X,dataSourceType:xe,threatIndex:Ee,threatMapping:ae,machineLearningJobId:ke,queryBar:null!=J?J:t.queryBar,newTermsFields:re});je(!e)}),[xe,X,re,J,ae,ye,t.queryBar,ce,ge,ke,ve,Ee]);const Oe=d()(ve),[Me,Fe]=Object(i.useState)(t.eqlOptions||{}),[De,{browserFields:Ae,indexPatterns:_e}]=Object(kt.b)(ye,!1),[Ne,Re]=Object(i.useState)(_e),{data:Le}=Object(y.k)().services;Object(i.useEffect)((()=>{xe===E.a.IndexPatterns&&(De||Re(_e)),xe===E.a.DataView&&(async()=>{if(null!=he){const e=await Le.dataViews.get(he);z(e.title),Re(e)}})()}),[xe,De,Le,he,_e]);const Be=Object(i.useCallback)((e=>{V.setFieldValue("dataSourceType",e),V.getFields().index.reset({resetValue:!1}),V.getFields().dataViewId.reset({resetValue:!1})}),[V]),[qe,ze]=Object(i.useState)([]);Object(i.useEffect)((()=>{const{fields:e}=Ne;ze(function(e){return e.filter((e=>!0===e.aggregatable))}(e))}),[Ne]);const $e=Object(i.useMemo)((()=>(e=>{const t=new Set(["string","number","ip","boolean"]);return e.filter((e=>!0===e.aggregatable&&t.has(e.type)))})(qe)),[qe]),[Ve,{browserFields:Ue,indexPatterns:He}]=Object(kt.b)(Ee);Object(i.useEffect)((()=>{G({resetValues:!1})}),[G,ve]),Object(i.useEffect)((()=>{R(!Object(c.isEqual)(ye,O))}),[ye,O]),Object(i.useEffect)((()=>{B(!Object(c.isEqual)(Ee,w))}),[Ee,w]),Object(i.useEffect)((()=>{const{queryBar:e}=U();null!=e&&(Object(P.f)(ve)&&!Object(P.f)(Oe)&&Object(c.isEqual)(e.value,It.a.forNormalRules)?e.reset({defaultValue:It.a.forThreatMatchRules}):!Object(P.f)(ve)&&Object(P.f)(Oe)&&Object(c.isEqual)(e.value,It.a.forThreatMatchRules)&&e.reset({defaultValue:It.a.forNormalRules}))}),[ve,Oe,U]);const We=Object(i.useCallback)((()=>{ce||V.setFieldValue("shouldLoadQueryDynamically",!1)}),[ce,V]),Ke=Object(i.useCallback)((()=>{k&&k()}),[k]),Ye=Object(i.useCallback)((async()=>({isValid:await new Promise((e=>{setTimeout((async()=>{const t=await Q();e(t)}),0)})),data:{...H(),eqlOptions:Me}})),[H,Me,Q]);Object(i.useEffect)((()=>{let e=!1;return S&&!e&&S(E.b.defineRule,Ye),()=>{e=!0}}),[Ye,S]);const Je=Object(i.useCallback)((()=>{U().index.setValue(O)}),[U,O]),Ze=Object(i.useCallback)((()=>{U().threatIndex.setValue(w)}),[U,w]),et=Object(i.useCallback)((()=>{A(!0)}),[]),tt=Object(i.useCallback)((()=>{A(!1)}),[]),at=Object(i.useCallback)((({thresholdField:e,thresholdValue:t,thresholdCardinalityField:a,thresholdCardinalityValue:n})=>r.a.createElement(Pe,{browserFields:qe,thresholdField:e,thresholdValue:t,thresholdCardinalityField:a,thresholdCardinalityValue:n})),[qe]);o()(n.EuiFlexItem).withConfig({displayName:"SourcererFlex",componentId:"sc-f0vskm-3"})(["align-items:flex-end;"]).displayName="SourcererFlex";const nt=Object(i.useCallback)((({threatMapping:e})=>r.a.createElement(xt,{handleResetThreatIndices:Ze,indexPatterns:Ne,threatBrowserFields:Ue,threatIndexModified:L,threatIndexPatterns:He,threatIndexPatternsLoading:Ve,threatMapping:e,onValidityChange:be})),[Ze,Ne,Ue,L,He,Ve]),it=Object(i.useMemo)((()=>[{id:E.a.IndexPatterns,label:l.i18n.translate("xpack.securitySolution.ruleDefine.indexTypeSelect.indexPattern",{defaultMessage:"Index Patterns"}),iconType:xe===E.a.IndexPatterns?"checkInCircleFilled":"empty","data-test-subj":`rule-index-toggle-${E.a.IndexPatterns}`},{id:E.a.DataView,label:l.i18n.translate("xpack.securitySolution.ruleDefine.indexTypeSelect.dataView",{defaultMessage:"Data View"}),iconType:xe===E.a.DataView?"checkInCircleFilled":"empty","data-test-subj":`rule-index-toggle-${E.a.DataView}`}]),[xe]),rt=Object(i.useMemo)((()=>null==j||0===Object.keys(j).length?r.a.createElement(n.EuiLoadingSpinner,{size:"l"}):r.a.createElement(F.e,{key:"DataViewSelector",path:"dataViewId",component:Xe,componentProps:{kibanaDataViews:j}})),[j]),st=Object(i.useMemo)((()=>r.a.createElement(Bt,{label:fe,$isVisible:!0,fullWidth:!0},r.a.createElement(n.EuiFlexGroup,{direction:"column",gutterSize:"s","data-test-subj":"dataViewIndexPatternButtonGroupFlexGroup"},r.a.createElement(n.EuiFlexItem,null,r.a.createElement(n.EuiText,{size:"xs"},r.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.dataViewSelectorText1",defaultMessage:"Use Kibana "}),r.a.createElement(Tt.a,{guidePath:"kibana",docPath:"data-views.html",linkText:"Data Views"}),r.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.dataViewSelectorText2",defaultMessage:" or specify individual "}),r.a.createElement(Tt.a,{guidePath:"kibana",docPath:"index-patterns-api-create.html",linkText:"index patterns"}),r.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.dataViewSelectorText3",defaultMessage:" as your rule's data source to be searched."}))),r.a.createElement(n.EuiFlexItem,null,r.a.createElement(Bt,{$isVisible:!0},r.a.createElement(n.EuiButtonGroup,{isFullWidth:!0,legend:"Rule index pattern or data view selector","data-test-subj":"dataViewIndexPatternButtonGroup",idSelected:xe,onChange:Be,options:it,color:"primary"}))),r.a.createElement(n.EuiFlexItem,null,r.a.createElement(Pt,{isVisible:xe===E.a.DataView},rt),r.a.createElement(Pt,{isVisible:xe===E.a.IndexPatterns},r.a.createElement(Rt,{path:"index",config:{...Object(c.omit)(Ge.index,"label"),labelAppend:_?r.a.createElement(Lt,{onClick:Je,iconType:"refresh"},oe):null},componentProps:{idAria:"detectionEngineStepDefineRuleIndices","data-test-subj":"detectionEngineStepDefineRuleIndices",euiFieldProps:{fullWidth:!0,placeholder:""}}})))))),[xe,Be,it,rt,_,Je]),ot=Object(i.useMemo)((()=>r.a.createElement(F.e,{key:"QueryBarDefineRule",path:"queryBar",config:{...Ge.queryBar,label:ue,labelAppend:r.a.createElement(Lt,{"data-test-subj":"importQueryFromSavedTimeline",onClick:et,disabled:se},le)},component:N,componentProps:{browserFields:Ae,idAria:"detectionEngineStepDefineRuleQueryBar",indexPattern:Ne,isDisabled:u||se,resetToSavedQuery:se,isLoading:De,dataTestSubj:"detectionEngineStepDefineRuleQueryBar",openTimelineSearch:D,onValidityChange:me,onCloseTimelineSearch:tt,onSavedQueryError:We,defaultSavedQuery:C}})),[Ae,tt,et,Ne,De,u,D,se,We,C]),lt=Object(i.useCallback)(((e,t)=>{Fe((a=>({...a,[e]:t})))}),[]),ct=Object(i.useMemo)((()=>Object(c.isEmpty)(Ne.fields)?{keywordFields:[],dateFields:[],nonDateFields:[]}:{keywordFields:Ne.fields.filter((e=>{var t;return null===(t=e.esTypes)||void 0===t?void 0:t.includes("keyword")})).map((e=>({label:e.name}))),dateFields:Ne.fields.filter((e=>"date"===e.type)).map((e=>({label:e.name}))),nonDateFields:Ne.fields.filter((e=>"date"!==e.type)).map((e=>({label:e.name})))}),[Ne]),ut=Object(h.e)(t);return xe===E.a.DataView&&(ut.dataViewTitle=q),s?r.a.createElement(Ie.a,{"data-test-subj":"definitionRule",addPadding:e},r.a.createElement(v.a,{columns:a,indexPatterns:Ne,schema:Object(h.b)(Ge,ve),data:Object(h.b)(ut,ve)})):r.a.createElement(r.a.Fragment,null,r.a.createElement(Ie.a,{addPadding:!x},r.a.createElement(F.c,{form:V,"data-test-subj":"stepDefineRule"},r.a.createElement(Pt,{isVisible:!1},r.a.createElement(F.e,{path:"dataSourceType",componentProps:{euiFieldProps:{fullWidth:!0,placeholder:""}}})),r.a.createElement(F.e,{path:"ruleType",component:Z,componentProps:{describedByIds:["detectionEngineStepDefineRuleType"],isUpdateView:x,hasValidLicense:Object(b.a)(M),isMlAdmin:Object(g.a)(M)}}),r.a.createElement(Bt,{$isVisible:!Object(m.d)(ve),fullWidth:!0},r.a.createElement(r.a.Fragment,null,r.a.createElement(n.EuiSpacer,{size:"s"}),st,r.a.createElement(n.EuiSpacer,{size:"s"}),Object(P.b)(ve)?r.a.createElement(F.e,{key:"EqlQueryBar",path:"queryBar",component:Qe.a,componentProps:{optionsData:ct,optionsSelected:Me,isSizeOptionDisabled:!0,onOptionsChange:lt,onValidityChange:me,idAria:"detectionEngineStepDefineRuleEqlQueryBar",isDisabled:u,isLoading:De,indexPattern:Ne,showFilterBar:!0,dataTestSubj:"detectionEngineStepDefineRuleEqlQueryBar"},config:{...Ge.queryBar,label:de}}):ot)),Object(P.e)(ve)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(n.EuiSpacer,{size:"s"}),r.a.createElement(Bt,{label:pe,$isVisible:Boolean((null==J?void 0:J.saved_id)&&(null==J?void 0:J.title)),fullWidth:!0},r.a.createElement(Rt,{path:"shouldLoadQueryDynamically",componentProps:{idAria:"detectionEngineStepDefineRuleShouldLoadQueryDynamically","data-test-subj":"detectionEngineStepDefineRuleShouldLoadQueryDynamically",euiFieldProps:{disabled:u,label:null!=J&&J.title?(dt=J.title,l.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldShouldLoadQueryDynamicallyLabel",{defaultMessage:'Load saved query "{savedQueryName}" dynamically on each rule execution',values:{savedQueryName:dt}})):void 0}}}))),r.a.createElement(Bt,{$isVisible:Object(P.e)(ve)},r.a.createElement(F.e,{path:"groupByFields",component:At,componentProps:{browserFields:$e,isDisabled:!$.isAtLeast(Nt.O)&&0===t.groupByFields.length}})),r.a.createElement(Bt,{$isVisible:Object(m.d)(ve),fullWidth:!0},r.a.createElement(r.a.Fragment,null,r.a.createElement(F.e,{path:"machineLearningJobId",component:we,componentProps:{describedByIds:["detectionEngineStepDefineRulemachineLearningJobId"]}}),r.a.createElement(F.e,{path:"anomalyThreshold",component:ee,componentProps:{describedByIds:["detectionEngineStepDefineRuleAnomalyThreshold"]}}))),r.a.createElement(Bt,{$isVisible:Object(P.g)(ve),"data-test-subj":"thresholdInput",fullWidth:!0},r.a.createElement(r.a.Fragment,null,r.a.createElement(F.f,{fields:{thresholdField:{path:"threshold.field"},thresholdValue:{path:"threshold.value"},thresholdCardinalityField:{path:"threshold.cardinality.field"},thresholdCardinalityValue:{path:"threshold.cardinality.value"}}},at))),r.a.createElement(Bt,{$isVisible:Object(P.f)(ve),"data-test-subj":"threatMatchInput",fullWidth:!0},r.a.createElement(r.a.Fragment,null,r.a.createElement(F.f,{fields:{threatMapping:{path:"threatMapping"}}},nt))),r.a.createElement(Bt,{$isVisible:Object(P.d)(ve),"data-test-subj":"newTermsInput",fullWidth:!0},r.a.createElement(r.a.Fragment,null,r.a.createElement(F.e,{path:"newTermsFields",component:Ot,componentProps:{browserFields:$e}}),r.a.createElement(F.e,{path:"historyWindowSize",component:wt.a,componentProps:{idAria:"detectionEngineStepDefineRuleHistoryWindowSize",dataTestSubj:"detectionEngineStepDefineRuleHistoryWindowSize",timeTypes:["m","h","d"]}}))),r.a.createElement(F.e,{path:"timeline",component:Te.a,componentProps:{idAria:"detectionEngineStepDefineRuleTimeline",isDisabled:u,dataTestSubj:"detectionEngineStepDefineRuleTimeline"}}))),!x&&r.a.createElement(Ce.a,{dataTestSubj:"define-continue",onClick:Ke,isDisabled:u}));var dt},zt=Object(i.memo)(qt)},function(e,t,a){"use strict";a.d(t,"b",(function(){return Z})),a.d(t,"a",(function(){return ne}));var n=a(32),i=a(34),r=a(4),s=a.n(r),o=a(35),l=a(46),c=a(166),u=a(107),d=a(33),p=a.n(d),m=a(7),g=a(662),b=a.n(g),f=a(36),y=a(675),h=a(0);const E=()=>s.a.createElement(s.a.Fragment,null,s.a.createElement(n.EuiFlexGroup,{gutterSize:"s",alignItems:"center",responsive:!1,"data-test-subj":"response-actions-header"},s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(n.EuiTitle,{size:"s"},s.a.createElement("h4",null,s.a.createElement(o.FormattedMessage,{defaultMessage:"Response Actions",id:"xpack.securitySolution.actionForm.responseActionSectionsDescription"})))),s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(n.EuiBetaBadge,{tooltipContent:h.i18n.translate("xpack.securitySolution.actionForm.experimentalTooltip",{defaultMessage:"This functionality is in technical preview and may be changed or removed completely in a future release. Elastic will take a best effort approach to fix any issues, but features in technical preview are not subject to the support SLA of official GA features."}),label:h.i18n.translate("xpack.securitySolution.rules.actionForm.experimentalTitle",{defaultMessage:"Technical preview"})}))),s.a.createElement(n.EuiSpacer,{size:"m"}),s.a.createElement(n.EuiFlexItem,null,s.a.createElement(o.FormattedMessage,{defaultMessage:"Response actions are run on each rule execution",id:"xpack.securitySolution.actionForm.responseActionSectionsTitle"})),s.a.createElement(n.EuiSpacer,{size:"m"}));var v=a(13),x=a(100);const k=({supportedResponseActionTypes:e,addActionType:t,updateActionTypeId:a})=>{const[i]=Object(x.m)(),[l,c]=Object(r.useState)(i.responseActions&&i.responseActions.length>0),u=Object(v.b)().isGoldPlus(),d=Object(r.useCallback)((e=>{c(!1),t(),a(e.id)}),[t,a]),p=Object(r.useMemo)((()=>s.a.createElement(n.EuiFlexGroup,null,s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(n.EuiSpacer,{size:"m"}),s.a.createElement(n.EuiButton,{size:"s","data-test-subj":"addAlertActionButton",onClick:()=>c(!1)},s.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.sections.actionForm.addResponseActionButtonLabel",defaultMessage:"Add response action"}))))),[]),m=Object(r.useMemo)((()=>(null==e?void 0:e.length)&&e.map((function(e,t){const a=s.a.createElement(n.EuiKeyPadMenuItem,{key:t,isDisabled:!u,"data-test-subj":`${e.name}-response-action-type-selection-option`,label:e.name,onClick:()=>d(e)},s.a.createElement(n.EuiIcon,{size:"xl",type:e.iconClass}));return s.a.createElement(n.EuiFlexItem,{grow:!1,key:`keypad-${e.id}`},a)}))),[d,u,e]);return null!=e&&e.length?s.a.createElement(s.a.Fragment,null,l?p:m):s.a.createElement(s.a.Fragment,null)};var S=a(397),j=a(129),O=a(77);const w=s.a.memo((({field:e})=>{const{setErrors:t,clearErrors:a,value:n,setValue:i}=e,{osquery:o}=Object(O.k)().services,l=Object(r.useMemo)((()=>null==o?void 0:o.OsqueryResponseActionTypeForm),[null==o?void 0:o.OsqueryResponseActionTypeForm]),c=Object(r.useCallback)((e=>{Object(m.isEmpty)(e)?a():t(Object(m.map)(e,(e=>({message:e.message}))))}),[t,a]);return s.a.createElement(l,{defaultValues:n,onError:c,onChange:i})}));w.displayName="ResponseActionFormField";var T=a(634);const I=()=>s.a.createElement(s.a.Fragment,null),C=s.a.memo((e=>{const{osquery:t,application:a}=Object(O.k)().services,i=Object(r.useMemo)((()=>null==t?void 0:t.OsqueryResponseActionTypeForm),[null==t?void 0:t.OsqueryResponseActionTypeForm]),l=Object(j.b)();if(t){var c,u,d,p,m,g,b,f;const{disabled:r,permissionDenied:y}=t.fetchInstallationStatus(),h=!(null!=a&&null!==(c=a.capabilities)&&void 0!==c&&null!==(u=c.osquery)&&void 0!==u&&u.writeLiveQueries||null!=a&&null!==(d=a.capabilities)&&void 0!==d&&null!==(p=d.osquery)&&void 0!==p&&p.runSavedQueries&&(null!=a&&null!==(m=a.capabilities)&&void 0!==m&&null!==(g=m.osquery)&&void 0!==g&&g.readSavedQueries||null!=a&&null!==(b=a.capabilities)&&void 0!==b&&null!==(f=b.osquery)&&void 0!==f&&f.readPacks));if(y||h)return s.a.createElement(s.a.Fragment,null,s.a.createElement(x.e,{path:`${e.item.path}.params`,component:I}),s.a.createElement(n.EuiEmptyPrompt,{title:s.a.createElement("h2",null,T.b),titleSize:"xs",iconType:"logoOsquery",body:s.a.createElement("p",null,s.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.osquery.action.missingPrivileges",defaultMessage:"To access this page, ask your administrator for {osquery} Kibana privileges.",values:{osquery:s.a.createElement(n.EuiCode,null,"osquery")}}))}));if(r)return s.a.createElement(s.a.Fragment,null,s.a.createElement(x.e,{path:`${e.item.path}.params`,component:I}),s.a.createElement(n.EuiEmptyPrompt,{iconType:"logoOsquery",title:s.a.createElement("h2",null,T.c),titleSize:"xs",body:s.a.createElement("p",null,T.a)}));if(l()&&i)return s.a.createElement(x.e,{path:`${e.item.path}.params`,component:w,readDefaultValueOnForm:!e.item.isNew})}return null}));C.displayName="OsqueryResponseAction";const M=p()(n.EuiAccordion).withConfig({displayName:"StyledEuiAccordion",componentId:"sc-1xv9108-0"})(["background:",";.euiAccordion__buttonContent{padding:",";}"],(({theme:e})=>e.eui.euiColorLightestShade),(({theme:e})=>e.eui.euiSizeM)),F=({item:e,onDeleteAction:t})=>{const[a,i]=Object(r.useState)(!0),[o]=Object(x.m)(),l=Object(m.get)(o,e.path),c=Object(r.useCallback)((()=>(null==l?void 0:l.actionTypeId)===S.a.OSQUERY?s.a.createElement(C,{item:e}):null),[null==l?void 0:l.actionTypeId,e]),u=Object(r.useCallback)((()=>{t(e.id)}),[e,t]),d=Object(r.useMemo)((()=>{const{logo:e,name:t}=(null==l||l.actionTypeId,S.a.OSQUERY,{logo:"logoOsquery",name:"Osquery"});return s.a.createElement(n.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(n.EuiIcon,{type:e,size:"m"})),s.a.createElement(n.EuiFlexItem,null,s.a.createElement(n.EuiText,null,t)))}),[null==l?void 0:l.actionTypeId]),p=Object(r.useMemo)((()=>s.a.createElement(n.EuiButtonIcon,{"data-test-subj":"remove-response-action",iconType:"minusInCircle",color:"danger",className:"actAccordionActionForm__extraAction","aria-label":h.i18n.translate("xpack.securitySolution.actionTypeForm.accordion.deleteIconAriaLabel",{defaultMessage:"Delete"}),onClick:u})),[u]);return s.a.createElement(M,{initialIsOpen:!0,key:e.id,id:e.id.toString(),onToggle:i,paddingSize:"l","data-test-subj":"alertActionAccordion",buttonContent:d,extraAction:p},c())};F.displayName="ResponseActionTypeForm";const D=s.a.memo(F),A=()=>s.a.createElement(s.a.Fragment,null),_=s.a.memo((({items:e,removeItem:t,supportedResponseActionTypes:a,addItem:i})=>{const o=Object(r.useRef)(null),l=Object(r.useCallback)((e=>{o.current=e}),[]),c=Object(x.l)(),u=Object(r.useMemo)((()=>s.a.createElement(k,{supportedResponseActionTypes:a,addActionType:i,updateActionTypeId:l})),[i,l,a]);return Object(r.useEffect)((()=>{if(o.current){const t=`responseActions[${e.length-1}].actionTypeId`;c.setFieldValue(t,o.current),o.current=null}}),[c,e.length]),s.a.createElement("div",{"data-test-subj":"response-actions-list"},e.map(((e,a)=>s.a.createElement("div",{key:e.id,"data-test-subj":`response-actions-list-item-${a}`},s.a.createElement(n.EuiSpacer,{size:"m"}),s.a.createElement(D,{item:e,onDeleteAction:t}),s.a.createElement(x.e,{path:`${e.path}.actionTypeId`,component:A})))),s.a.createElement(n.EuiSpacer,{size:"m"}),u)}));_.displayName="ResponseActionsList";const N=[{id:S.a.OSQUERY,name:"osquery",iconClass:"logoOsquery"}],R=f.css`
  margin-bottom: 0;
`,P=({items:e,addItem:t,removeItem:a,form:i})=>{const o=(()=>{const[e,t]=Object(r.useState)(),a=(()=>{const{osquery:e}=Object(O.k)().services,t=null==e?void 0:e.fetchInstallationStatus();return!(null!=t&&t.loading||null!=t&&t.disabled||null!=t&&t.permissionDenied)})();return Object(r.useEffect)((()=>{const e=N.filter((e=>S.c.includes(e.id)));t(e)}),[a]),e})(),[l,c]=Object(r.useState)(null),u=i.getFields(),d=i.getErrors(),p=Object(r.useMemo)((()=>null!=o&&o.length?s.a.createElement(_,{items:e,removeItem:a,supportedResponseActionTypes:o,addItem:t}):null),[t,e,a,o]);return Object(r.useEffect)((()=>{c((()=>{const t=Object(m.reduce)(Object(m.map)(e,"path"),((e,t)=>{var a,n;return null!==(a=u[`${t}.params`])&&void 0!==a&&null!==(n=a.errors)&&void 0!==n&&n.length?(e.push({type:Object(m.upperFirst)(u[`${t}.actionTypeId`].value.substring(1)),errors:Object(m.map)(u[`${t}.params`].errors,"message")}),e):e}),[]);return Object(m.reduce)(t,((e,t)=>(e.push(`**${t.type}:**\n`),t.errors.forEach((t=>{e.push(`- ${t}\n`)})),e)),[]).join("\n")}))}),[u,d,e]),s.a.createElement(s.a.Fragment,null,s.a.createElement(n.EuiSpacer,{size:"xxl","data-test-subj":"response-actions-form"}),s.a.createElement(E,null),null!=l&&l.length&&i.isSubmitted?s.a.createElement(s.a.Fragment,null,s.a.createElement(L,null,s.a.createElement(n.EuiCallOut,{"data-test-subj":"response-actions-error",title:y.a,color:"danger",iconType:"alert"},s.a.createElement(b.a,null,l))),s.a.createElement(n.EuiSpacer,null)):null,p)};var L=p()("p").withConfig({displayName:"_StyledP",componentId:"sc-1drd97h-0"})(["",""],R),B=a(167),q=a(377),z=a(371),$=a(566),V=a(878),U=a(912);const H=h.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.completeWithoutEnablingTitle",{defaultMessage:"Create rule without enabling it"}),G=h.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.completeWithEnablingTitle",{defaultMessage:"Create & enable rule"}),Q=h.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.noReadActionsPrivileges",{defaultMessage:'Cannot create rule actions. You do not have "Read" permissions for the "Actions" plugin.'}),W=h.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.fieldThrottleHelpText",{defaultMessage:"Select when automated actions should be performed if a rule evaluates as true."}),K=h.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.fieldThrottleHelpTextWhenQuery",{defaultMessage:"Select when automated actions should be performed if a rule evaluates as true. This frequency does not apply to Response Actions."});var Y=a(1),J=a(8);const X="Cases",Z={enabled:!0,actions:[],responseActions:[],kibanaSiemAppUrl:"",throttle:$.a.value},ee=()=>s.a.createElement(s.a.Fragment,null),te=()=>s.a.createElement(s.a.Fragment,null,s.a.createElement(n.EuiTitle,{size:"s"},s.a.createElement("h4",null,s.a.createElement(o.FormattedMessage,{defaultMessage:"Actions",id:"xpack.securitySolution.detectionEngine.rule.editRule.actionSectionsTitle"}))),s.a.createElement(n.EuiSpacer,{size:"l"})),ae=({addPadding:e=!1,defaultValues:t,isReadOnlyView:a,isLoading:o,isUpdateView:d=!1,onSubmit:p,setForm:m,actionMessageParams:g,ruleType:b})=>{const[f]=(()=>{const e=Object(r.useRef)(!0),[t,a]=Object(r.useState)(!0),[n,i]=Object(r.useState)(!1);return Object(r.useEffect)((()=>{const t=new AbortController;return e.current&&(e.current=!1,(async()=>{try{Object(O.c)(await O.b.get().http.fetch(Object(J.getAllConnectorsUrl)(),{method:"GET",signal:t.signal})).some((e=>".case"===e.connectorTypeId&&e.name===X))||await O.b.get().http.post(Object(J.getCreateConnectorUrl)(),{method:"POST",body:JSON.stringify({connector_type_id:".case",config:{},name:X,secrets:{}}),signal:t.signal}),a(!1)}catch{a(!1),i(!0)}})()),()=>{t.abort()}}),[]),[t,n]})(),{services:{application:y,triggersActionsUi:{actionTypeRegistry:E}}}=Object(O.k)(),v=Object(u.a)("responseActionsEnabled"),k=Object(r.useMemo)((()=>y.getUrlForApp(`${Y.B}`,{absolute:!0})),[y]),S={...null!=t?t:Z,kibanaSiemAppUrl:k},j=Object(r.useMemo)((()=>(({actionTypeRegistry:e})=>({actions:{validations:[{validator:Object(U.a)(e)}]},enabled:{},kibanaSiemAppUrl:{},throttle:{label:h.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.fieldThrottleLabel",{defaultMessage:"Actions frequency"})}}))({actionTypeRegistry:E})),[E]),{form:w}=Object(x.k)({defaultValue:S,options:{stripEmptyFields:!1},schema:j}),{getFields:T,getFormData:I,submit:C}=w,[{throttle:M}]=Object(x.m)({form:w,watch:["throttle"]}),F=M||S.throttle,D=Object(r.useCallback)((e=>{T().enabled.setValue(e),p&&p()}),[T,p]),A=Object(r.useCallback)((async()=>{const e=await C();return null!=e&&e.isValid?e:{isValid:!1,data:I()}}),[I,C]);Object(r.useEffect)((()=>{let e=!1;return m&&!e&&m(B.b.ruleActions,A),()=>{e=!0}}),[A,m]);const _=Object(r.useMemo)((()=>(e=>e&&Object(i.findIndex)(["value",e],$.c)<0?[...$.c,{value:e,text:e}]:$.c)(F)),[F]),N=Object(r.useMemo)((()=>({idAria:"detectionEngineStepRuleActionsThrottle",isDisabled:o,isLoading:f,dataTestSubj:"detectionEngineStepRuleActionsThrottle",hasNoInitialSelection:!1,helpText:Object(c.e)(b)?K:W,euiFieldProps:{options:_}})),[o,f,b,_]),R=Object(r.useMemo)((()=>F!==Z.throttle?s.a.createElement(s.a.Fragment,null,s.a.createElement(n.EuiSpacer,null),s.a.createElement(x.e,{path:"actions",component:V.a,componentProps:{messageVariables:g}})):s.a.createElement(x.e,{path:"actions",component:ee})),[F,g]),L=Object(r.useMemo)((()=>Object(c.e)(b)?s.a.createElement(l.UseArray,{path:"responseActions",initialNumberOfItems:0},P):null),[b]),ae=Object(r.useMemo)((()=>y.capabilities.actions.show?s.a.createElement(s.a.Fragment,null,s.a.createElement(te,null),s.a.createElement(x.e,{path:"throttle",component:$.d,componentProps:N}),R,v&&L,s.a.createElement(x.e,{path:"kibanaSiemAppUrl",component:ee}),s.a.createElement(x.e,{path:"enabled",component:ee})):s.a.createElement(s.a.Fragment,null,s.a.createElement(n.EuiText,null,Q),s.a.createElement(x.e,{path:"throttle",componentProps:N,component:ee}),s.a.createElement(x.e,{path:"actions",component:ee}),s.a.createElement(x.e,{path:"kibanaSiemAppUrl",component:ee}),s.a.createElement(x.e,{path:"enabled",component:ee}))),[y.capabilities.actions.show,R,L,v,N]);return a?s.a.createElement(z.a,{addPadding:e},s.a.createElement(q.a,{schema:j,data:S,columns:"single"})):s.a.createElement(s.a.Fragment,null,s.a.createElement(z.a,{addPadding:!d},s.a.createElement(x.c,{form:w,"data-test-subj":"stepRuleActions"},s.a.createElement(n.EuiForm,null,ae))),!d&&s.a.createElement(s.a.Fragment,null,s.a.createElement(n.EuiHorizontalRule,{margin:"m"}),s.a.createElement(n.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd",gutterSize:"xs",responsive:!1},s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(n.EuiButton,{fill:!1,isDisabled:o,isLoading:o,onClick:()=>D(!1),"data-test-subj":"create-enabled-false"},H)),s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(n.EuiButton,{fill:!0,isDisabled:o,isLoading:o,onClick:()=>D(!0),"data-test-subj":"create-enable"},G)))))},ne=Object(r.memo)(ae)},function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return J})),a.d(t,"d",(function(){return Z})),a.d(t,"e",(function(){return A})),a.d(t,"f",(function(){return V})),a.d(t,"g",(function(){return ae})),a.d(t,"i",(function(){return Q})),a.d(t,"c",(function(){return ne})),a.d(t,"h",(function(){return oe}));var n=a(4),i=a.n(n),r=a(32),s=a(0),o=a(480),l=a(168);const c=Object(n.memo)((({handleRefresh:e,http:t,handleCloseFlyout:a,addSuccess:c,addError:u})=>{const{start:d,...p}=Object(o.a)(),m=Object(n.useRef)(new AbortController);let g;!function(e){e.name="name",e.description="description"}(g||(g={}));const[b,f]=Object(n.useState)({name:"",description:""}),y=({target:e},t)=>{const{value:a}=e;f({...b,[t]:a})},h=Object(n.useCallback)((()=>{var e;p.loading||""===b.name||(m.current=new AbortController,d({http:t,signal:m.current.signal,name:b.name,description:null!==(e=b.description)&&void 0!==e?e:""}))}),[d,p.loading,b,t]),E=Object(n.useCallback)((t=>{c({text:Object(l.bb)(b.name),title:l.V}),e(),a()}),[c,a,e,b]),v=Object(n.useCallback)((e=>{var t;e.message.includes("AbortError")||null!=e&&null!==(t=e.body)&&void 0!==t&&t.message.includes("AbortError")||u(e,{title:s.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListErrorTitle",{defaultMessage:"creation error"})})}),[u]);return Object(n.useEffect)((()=>{p.loading||(null!=p&&p.result?E(p.result):null!=p&&p.error&&v(null==p?void 0:p.error))}),[null==p?void 0:p.error,p.loading,p.result,v,E]),i.a.createElement(r.EuiFlyout,{ownFocus:!0,size:"s",onClose:a,"data-test-subj":"createSharedExceptionListFlyout"},i.a.createElement(r.EuiFlyoutHeader,{hasBorder:!0},i.a.createElement(r.EuiTitle,{size:"m"},i.a.createElement("h2",{"data-test-subj":"createSharedExceptionListTitle"},l.h))),i.a.createElement(r.EuiFlyoutBody,null,i.a.createElement(r.EuiText,null,l.f),i.a.createElement(r.EuiFieldText,{placeholder:l.g,value:b.name,onChange:e=>y(e,g.name),"aria-label":"Use aria labels when no actual label is in use"}),i.a.createElement(r.EuiSpacer,null),i.a.createElement(r.EuiText,null,l.d),i.a.createElement(r.EuiTextArea,{placeholder:l.e,value:b.description,onChange:e=>y(e,g.description),"aria-label":"Stop the hackers"})),i.a.createElement(r.EuiFlyoutFooter,null,i.a.createElement(r.EuiFlexGroup,{justifyContent:"spaceBetween"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButtonEmpty,{iconType:"cross",onClick:a,flush:"left"},l.a)),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButton,{"data-test-subj":"exception-lists-form-create-shared",onClick:h,disabled:""===b.name},l.c)))))}));c.displayName="CreateSharedListFlyout";var u=a(36),d=a(93),p=a(195),m=a(33),g=a.n(m),b=a(40),f=a(505),y=a(345);const h=g()(r.EuiFlexItem).withConfig({displayName:"StyledFlexItem",componentId:"sc-cbckbl-0"})(["border-right:1px solid #d3dae6;padding:"," "," "," 0;"],b.euiThemeVars.euiSizeXS,b.euiThemeVars.euiSizeS,b.euiThemeVars.euiSizeXS),E=g()(r.EuiText).withConfig({displayName:"TextContainer",componentId:"sc-cbckbl-1"})(["width:max-content;"]),v=Object(n.memo)((({title:e,badgeString:t})=>i.a.createElement(r.EuiFlexGroup,{alignItems:"center"},i.a.createElement(r.EuiFlexItem,null,i.a.createElement(E,{grow:!0,size:"xs"},`${e}:`)),i.a.createElement(h,null,i.a.createElement(r.EuiBadge,null,t)))));v.displayName="TitleBadge";var x=a(101),k=a(43),S=a.n(k);const j=s.i18n.translate("xpack.securitySolution.exceptions.commentEventLabel",{defaultMessage:"added a comment"}),O=(s.i18n.translate("xpack.securitySolution.exceptions.operatingSystemFullLabel",{defaultMessage:"Operating System"}),s.i18n.translate("xpack.securitySolution.exceptions.viewer.addToEndpointListLabel",{defaultMessage:"Add endpoint exception"}),s.i18n.translate("xpack.securitySolution.exceptions.viewer.addToDetectionsListLabel",{defaultMessage:"Add rule exception"}),s.i18n.translate("xpack.securitySolution.exceptions.viewer.addCommentPlaceholder",{defaultMessage:"Add a new comment..."}),s.i18n.translate("xpack.securitySolution.exceptions.viewer.addToClipboard",{defaultMessage:"Comment"}));s.i18n.translate("xpack.securitySolution.exceptions.clearExceptionsLabel",{defaultMessage:"Remove Exception List"}),s.i18n.translate("xpack.securitySolution.exceptions.fetchError",{defaultMessage:"Error fetching exception list"}),s.i18n.translate("xpack.securitySolution.exceptions.errorLabel",{defaultMessage:"Error"}),s.i18n.translate("xpack.securitySolution.exceptions.cancelLabel",{defaultMessage:"Cancel"}),s.i18n.translate("xpack.securitySolution.exceptions.modalErrorAccordionText",{defaultMessage:"Show rule reference information:"}),s.i18n.translate("xpack.securitySolution.exceptions.disassociateExceptionListError",{defaultMessage:"Failed to remove exception list"}),s.i18n.translate("xpack.securitySolution.exceptions.operatingSystemWindows",{defaultMessage:"Windows"}),s.i18n.translate("xpack.securitySolution.exceptions.operatingSystemMac",{defaultMessage:"macOS"}),s.i18n.translate("xpack.securitySolution.exceptions.operatingSystemWindowsAndMac",{defaultMessage:"Windows and macOS"}),s.i18n.translate("xpack.securitySolution.exceptions.operatingSystemLinux",{defaultMessage:"Linux"}),s.i18n.translate("xpack.securitySolution.exceptions.fetchingReferencesErrorToastTitle",{defaultMessage:"Error fetching exception references"});var w=a(710);const T=e=>e.map((e=>({username:e.created_by,timestamp:S()(e.created_at).format("on MMM Do YYYY @ HH:mm:ss"),event:j,timelineAvatar:i.a.createElement(r.EuiAvatar,{size:"l",name:e.created_by.toUpperCase()}),children:i.a.createElement(r.EuiText,{size:"s"},e.comment),actions:i.a.createElement(w.a,{"data-test-subj":"copy-to-clipboard",text:e.comment,titleSummary:O})})));var I=a(1),C=a(156),M=a(374),F=a(89);const D=({referenceName:e,referenceId:t,external:a})=>i.a.createElement(F.k,{"data-test-subj":"SecuritySolutionLinkAnchor",deepLinkId:I.uc.rules,path:Object(C.c)(t,M.b.alerts),external:a},e);D.displayName="LinkAnchor";const A=i.a.memo(D);A.displayName="ListDetailsLinkAnchor";var _=a(35),N=a(247);const R=g.a.span.withConfig({displayName:"StyledText",componentId:"sc-1sobm2a-0"})(["font-weight:bold;color:",";"],(({theme:e})=>e.eui.euiColorDarkestShade)),P=g()(r.EuiFlexGroup).withConfig({displayName:"MyUtilities",componentId:"sc-1sobm2a-1"})(["height:50px;"]),L=g.a.span.withConfig({displayName:"StyledCondition",componentId:"sc-1sobm2a-2"})(["display:inline-block !important;vertical-align:middle !important;line-height:1;"]),B=({dataTestSubj:e,pagination:t,lastUpdated:a,exceptionsTitle:n})=>{const{pageSize:s,totalItemCount:o}=t;return i.a.createElement(P,{alignItems:"center",justifyContent:"spaceBetween"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(N.a,null,i.a.createElement(N.d,null,i.a.createElement(N.c,null,i.a.createElement(N.e,{dataTestSubj:`${e}ShowingText`},i.a.createElement(_.FormattedMessage,{id:"xpack.securitySolution.exceptions.viewer.paginationDetails",defaultMessage:"Showing {partOne} of {partTwo}",values:{partOne:i.a.createElement(R,null,`1-${Math.min(s,o)}`),partTwo:i.a.createElement(R,null,`${o}`)}})),n&&i.a.createElement(R,{"data-test-subj":`${e}exceptionsTitle`},n))))),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiText,{size:"s","data-test-subj":`${e}LastUpdated`},i.a.createElement(_.FormattedMessage,{id:"xpack.securitySolution.exceptions.viewer.lastUpdated",defaultMessage:"Updated {updated}",values:{updated:i.a.createElement(L,null,i.a.createElement(x.b,{value:a,tooltipAnchorClassName:"eui-textTruncate"}))}}))))};B.displayName="ExceptionsUtilityComponent";const q=i.a.memo(B);q.displayName="ExceptionsUtility";var z=a(481);const $=({isReadOnly:e,exceptions:t,listType:a,lastUpdated:n,pagination:r,emptyViewerTitle:s,emptyViewerBody:o,emptyViewerButtonText:l,viewerStatus:c,ruleReferences:u,hideUtility:d=!1,onDeleteException:m,onEditExceptionItem:g,onPaginationChange:b,onCreateExceptionListItem:f})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(p.c,{viewerStatus:c,listType:a,ruleReferences:u,isReadOnly:e,exceptions:t,emptyViewerTitle:s,emptyViewerBody:o,emptyViewerButtonText:l,pagination:r,lastUpdated:n,editActionLabel:z.b,deleteActionLabel:z.a,onPaginationChange:b,onEditExceptionItem:g,onDeleteException:m,getFormattedComments:T,securityLinkAnchorComponent:A,formattedDateComponent:x.a,onCreateExceptionListItem:f,exceptionsUtilityComponent:()=>d?null:i.a.createElement(q,{exceptionsTitle:z.c,pagination:r,lastUpdated:n})}));$.displayName="ListExceptionItemsComponent";const V=i.a.memo($);V.displayName="ListExceptionItems";var U=a(593),H=a(497),G=a(704);const Q=Object(n.memo)((({linkedRules:e,showButtonLoader:t,saveIsDisabled:a=!0,onSave:n,onCancel:s,onRuleSelectionChange:o})=>{const c=Object(r.useGeneratedHtmlId)({prefix:"complicatedFlyoutTitle"});return i.a.createElement(r.EuiFlyout,{hideCloseButton:!0,ownFocus:!0,onClose:s,"aria-labelledby":c},i.a.createElement(r.EuiFlyoutHeader,{hasBorder:!0},i.a.createElement(r.EuiTitle,{size:"m"},i.a.createElement("h2",{id:c},l.L)),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(r.EuiText,{size:"s",color:"subdued"},l.K)),i.a.createElement(r.EuiFlyoutBody,null,i.a.createElement(G.a,{initiallySelectedRules:e,onRuleSelectionChange:o})),i.a.createElement(r.EuiFlyoutFooter,null,i.a.createElement(r.EuiFlexGroup,{justifyContent:"spaceBetween"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButtonEmpty,{onClick:s,flush:"left"},l.J)),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButton,{isLoading:t,disabled:a,onClick:n,fill:!0},l.M)))))}));Q.displayName="ManageRules";const W=u.css`
  // Ask KIBANA Team why Emotion is not working fully under xpack
  width: 100%;
  z-index: 100;
  span {
    cursor: pointer;
    display: block;
  }
`,K=g()(r.EuiPanel).withConfig({displayName:"ExceptionPanel",componentId:"sc-1xn0pid-0"})(["margin:-"," "," 0 ",";"],b.euiThemeVars.euiSizeS,b.euiThemeVars.euiSizeM,b.euiThemeVars.euiSizeM),Y=g()(r.EuiFlexGroup).withConfig({displayName:"ListHeaderContainer",componentId:"sc-1xn0pid-1"})(["padding:",";text-align:initial;"],b.euiThemeVars.euiSizeS),J=Object(n.memo)((({exceptionsList:e,handleDelete:t,handleExport:a,readOnly:n})=>{const{linkedRules:s,showManageRulesFlyout:o,showManageButtonLoader:c,disableManageButton:u,onManageRules:m,onSaveManageRules:g,onCancelManageRules:b,onRuleSelectionChange:h}=Object(U.a)(e.list_id),{listId:E,listName:x,listType:k,createdAt:S,createdBy:j,exceptions:O,pagination:w,ruleReferences:T,toggleAccordion:I,openAccordionId:C,menuActionItems:M,listRulesCount:F,listDescription:D,exceptionItemsCount:A,onEditExceptionItem:_,onDeleteException:N,onPaginationChange:R,setToggleAccordion:P,exceptionViewerStatus:L,showAddExceptionFlyout:B,showEditExceptionFlyout:q,exceptionToEdit:z,onAddExceptionClick:$,handleConfirmExceptionFlyout:G,handleCancelExceptionItemFlyout:J,goToExceptionDetail:X,emptyViewerTitle:Z,emptyViewerBody:ee,emptyViewerButtonText:te}=Object(H.a)({exceptionsList:e,handleExport:a,handleDelete:t,handleManageRules:m});return i.a.createElement(r.EuiFlexGroup,{gutterSize:"none"},i.a.createElement(r.EuiFlexItem,null,i.a.createElement(r.EuiPanel,{hasShadow:!1},i.a.createElement(r.EuiAccordion,{buttonProps:{css:W},id:C,arrowDisplay:"none",onToggle:()=>P(!I),buttonContent:i.a.createElement(r.EuiPanel,null,i.a.createElement(Y,{gutterSize:"m",alignItems:"flexStart"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButtonIcon,{iconType:I?"arrowDown":"arrowRight","aria-label":"Next"})),i.a.createElement(r.EuiFlexItem,null,i.a.createElement(r.EuiFlexGroup,{direction:"column",key:E,alignItems:"flexStart",gutterSize:"none"},i.a.createElement(r.EuiFlexItem,{grow:!0},i.a.createElement(r.EuiText,{size:"m"},i.a.createElement(r.EuiLink,{"data-test-subj":"exception-list-name",onClick:X},x))),i.a.createElement(r.EuiFlexItem,{grow:!0},i.a.createElement(r.EuiText,{size:"xs"},i.a.createElement(r.EuiTextColor,{color:"subdued"},D))))),i.a.createElement(r.EuiFlexItem,null,i.a.createElement(r.EuiFlexGroup,{alignItems:"center"},i.a.createElement(r.EuiFlexItem,null,i.a.createElement(v,{title:l.i,badgeString:S})),i.a.createElement(r.EuiFlexItem,null,i.a.createElement(v,{title:l.b,badgeString:j})),i.a.createElement(r.EuiFlexItem,null,i.a.createElement(v,{title:l.k,badgeString:A})),i.a.createElement(r.EuiFlexItem,null,i.a.createElement(v,{title:l.S,badgeString:F})),i.a.createElement(r.EuiFlexItem,null,i.a.createElement(p.e,{disableActions:n,dataTestSubj:"sharedListOverflowCard",actions:M}))))))},i.a.createElement(K,{hasBorder:!0},i.a.createElement(V,{isReadOnly:n,exceptions:O,listType:e.type,pagination:w,hideUtility:!0,viewerStatus:L,ruleReferences:T,onDeleteException:N,onEditExceptionItem:_,onPaginationChange:R,onCreateExceptionListItem:$,lastUpdated:null,emptyViewerTitle:Z,emptyViewerBody:ee,emptyViewerButtonText:te}))))),B?i.a.createElement(y.a,{rules:null,isBulkAction:!1,isEndpointItem:k===d.b.ENDPOINT,sharedListToAddTo:[e],onCancel:J,onConfirm:G,"data-test-subj":"addExceptionItemFlyoutInSharedLists",showAlertCloseOptions:!1,isNonTimeline:!0}):null,q&&z?i.a.createElement(f.a,{list:e,itemToEdit:z,showAlertCloseOptions:!0,openedFromListDetailPage:!0,onCancel:J,onConfirm:G,"data-test-subj":"editExceptionItemFlyoutInSharedLists"}):null,o?i.a.createElement(Q,{linkedRules:s,showButtonLoader:c,saveIsDisabled:u,onSave:g,onCancel:b,onRuleSelectionChange:h}):null)}));J.displayName="ExceptionsListCard";var X=a(499);const Z=i.a.memo((({handleRefresh:e,http:t,addSuccess:a,addError:s,setDisplayImportListFlyout:o})=>{var c;const u=Object(n.useRef)(null),d=Object(r.useGeneratedHtmlId)({prefix:"filePicker"}),[p,m]=Object(n.useState)(null),[g,b]=Object(n.useState)(!1),[f,y]=Object(n.useState)(!1),[h,E]=Object(n.useState)(!1),v=Object(n.useCallback)((()=>{var e;null!==(e=u.current)&&void 0!==e&&e.fileInput&&(u.current.fileInput.value="",u.current.handleChange()),m(null),E(!1),y(!1),b(!1)}),[]),{start:x,...k}=Object(X.a)(),S=Object(n.useRef)(new AbortController),j=Object(n.useCallback)((()=>{!k.loading&&p&&(S.current=new AbortController,x({file:p,http:t,signal:S.current.signal,overwrite:g,overwriteExceptions:g,asNewList:f}))}),[f,p,t,x,k.loading,g]),O=Object(n.useCallback)((t=>{var n;v(),a({text:l.db(null!==(n=null==p?void 0:p.name)&&void 0!==n?n:""),title:l.Y}),e()}),[v,a,e]),w=Object(n.useCallback)((e=>{e.forEach((e=>{e.error.message.includes("AbortError")||s(e.error.message,{title:l.X})}))}),[s]);Object(n.useEffect)((()=>{var e;if(!k.loading)if(null!=k&&null!==(e=k.result)&&void 0!==e&&e.success)O(null==k?void 0:k.result);else{var t,a;const e=[];var n,i;null!=k&&null!==(t=k.error)&&void 0!==t&&t.body&&e.push({error:{...null==k||null===(n=k.error)||void 0===n?void 0:n.body}}),null!=k&&null!==(a=k.result)&&void 0!==a&&a.errors&&(null==k||null===(i=k.result)||void 0===i||i.errors.forEach((t=>{t.error.message.includes("already exists")&&E(!0),e.push(t)}))),w(e)}}),[w,O,null==k?void 0:k.error,k.loading,null==k?void 0:k.result,null==k||null===(c=k.result)||void 0===c?void 0:c.errors]);const T=Object(n.useCallback)((e=>{var t;m(null!==(t=null==e?void 0:e.item(0))&&void 0!==t?t:null)}),[]);return i.a.createElement(r.EuiFlyout,{ownFocus:!0,size:"s",onClose:()=>o(!1)},i.a.createElement(r.EuiFlyoutHeader,{hasBorder:!0},i.a.createElement(r.EuiTitle,{size:"m"},i.a.createElement("h2",null,l.F))),i.a.createElement(r.EuiFlyoutBody,null,i.a.createElement(r.EuiText,null,l.E),i.a.createElement(r.EuiFilePicker,{id:d,multiple:!0,ref:u,initialPromptText:l.I,onChange:T,display:"large","aria-label":"Use aria labels when no actual label is in use"}),h&&i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiSpacer,null),i.a.createElement(r.EuiTextColor,{color:"danger"},l.H),i.a.createElement(r.EuiSpacer,null),i.a.createElement(r.EuiCheckbox,{id:"basicCheckboxId",label:l.G,checked:g,onChange:e=>{b(!g),y(!1)}}),i.a.createElement(r.EuiCheckbox,{id:"createNewListCheckbox",label:l.D,checked:f,onChange:e=>{y(!f),b(!1)}}))),i.a.createElement(r.EuiFlyoutFooter,null,i.a.createElement(r.EuiFlexGroup,{justifyContent:"spaceBetween"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButtonEmpty,{iconType:"cross",onClick:()=>o(!1),flush:"left"},l.a)),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButton,{"data-test-subj":"exception-lists-form-import-action",onClick:j,disabled:null==p||k.loading},l.W)))))}));var ee=a(500);const te=({list:e,isReadOnly:t,refreshExceptions:a})=>{const{listName:n,exceptions:s,listType:o,lastUpdated:c,pagination:u,emptyViewerTitle:m,emptyViewerBody:g,emptyViewerButtonText:b,viewerStatus:h,ruleReferences:E,showAddExceptionFlyout:v,showEditExceptionFlyout:x,exceptionToEdit:k,exceptionViewerStatus:S,onSearch:j,onAddExceptionClick:O,onDeleteException:w,onEditExceptionItem:T,onPaginationChange:I,handleCancelExceptionItemFlyout:C,handleConfirmExceptionFlyout:M}=Object(ee.a)(e,a);return i.a.createElement(i.a.Fragment,null,v?i.a.createElement(y.a,{rules:null,isBulkAction:!1,isEndpointItem:o===d.b.ENDPOINT,sharedListToAddTo:[e],onCancel:C,onConfirm:M,"data-test-subj":"addExceptionItemFlyoutInList",showAlertCloseOptions:!1,isNonTimeline:!0}):h===p.i.EMPTY||h===p.i.LOADING?i.a.createElement(p.a,{isReadOnly:t,viewerStatus:h,onCreateExceptionListItem:O,title:l.x,body:l.u(n),buttonText:l.v}):i.a.createElement(r.EuiPanel,{hasBorder:!1,hasShadow:!1},i.a.createElement(i.a.Fragment,null,x&&k&&i.a.createElement(f.a,{list:e,itemToEdit:k,showAlertCloseOptions:!0,openedFromListDetailPage:!0,onCancel:C,onConfirm:M,"data-test-subj":"editExceptionItemFlyoutInList"}),i.a.createElement(p.g,{addExceptionButtonText:o===d.b.ENDPOINT?l.t:l.s,listType:o,onSearch:j,onAddExceptionClick:O,isSearching:h===p.i.SEARCHING,isButtonFilled:!1,buttonIconType:"plusInCircle"}),i.a.createElement(V,{viewerStatus:S,listType:o,ruleReferences:E,isReadOnly:t,exceptions:s,emptyViewerTitle:m,emptyViewerBody:g,emptyViewerButtonText:b,pagination:u,lastUpdated:c,onPaginationChange:I,onEditExceptionItem:T,onDeleteException:w,onCreateExceptionListItem:O}))))};te.displayName="ListWithSearchComponent";const ae=i.a.memo(te);ae.displayName="ListWithSearch";const ne=({onRefresh:e,totalExceptionLists:t,setSort:a,sort:n,sortFields:s})=>{var o;const c=null==s?void 0:s.find((e=>e.field===(null==n?void 0:n.field)));return i.a.createElement(N.a,{border:!0},i.a.createElement(N.d,null,i.a.createElement(N.c,null,i.a.createElement(N.e,{dataTestSubj:"showingExceptionLists"},l.T(t))),i.a.createElement(N.c,null,i.a.createElement(N.b,{dataTestSubj:"refreshRulesAction",iconSide:"left",iconType:"refresh",onClick:e},l.R))),i.a.createElement(N.d,null,i.a.createElement(i.a.Fragment,null,i.a.createElement(N.c,null,n&&i.a.createElement(N.b,{dataTestSubj:"sortExceptions",iconSide:"right",iconType:"asc"===n.order?"sortUp":"sortDown",popoverPanelPaddingSize:"s",popoverContent:()=>i.a.createElement(r.EuiContextMenuPanel,{size:"s",items:null==s?void 0:s.map((e=>{const t=(null==c?void 0:c.field)===e.field;let s=e.defaultOrder;return t&&(s="asc"===n.order?"desc":"asc"),i.a.createElement(r.EuiContextMenuItem,{key:e.field,onClick:()=>null==a?void 0:a({field:e.field,order:s})},i.a.createElement(ie,null,e.label," ",(null==c?void 0:c.field)===e.field&&i.a.createElement(re,{type:"asc"===n.order?"sortUp":"sortDown"})))}))})},i.a.createElement(ie,null,l.U," ",null==s||null===(o=s.find((e=>e.field===n.field)))||void 0===o?void 0:o.label))))))},ie=g()("div").withConfig({displayName:"SortMenuItem",componentId:"sc-1xmymh5-0"})(["display:flex;align-items:center;"]),re=g()(r.EuiIcon).withConfig({displayName:"SortIcon",componentId:"sc-1xmymh5-1"})(["margin-left:8px;"]);ne.displayName="ExceptionsTableUtilityBar";const se={strict:!0,fields:{created_by:{type:"string"},name:{type:"string"},type:{type:"string"},list_id:{type:"string"},tags:{type:"string"}}},oe=i.a.memo((({onSearch:e})=>i.a.createElement(r.EuiSearchBar,{"data-test-subj":"exceptionsHeaderSearch","aria-label":l.l,onChange:e,box:{"data-test-subj":"exceptionsHeaderSearchInput",placeholder:l.z,incremental:!1,schema:se}})));oe.displayName="ListsSearchBar"},function(e,t,a){"use strict";a.d(t,"a",(function(){return ve}));var n=a(32),i=a(4),r=a.n(i),s=a(33),o=a.n(s),l=a(166),c=a(167),u=a(82),d=a.n(u),p=a(34),m=a(113),g=a(100);const b=o()(n.EuiFormRow).withConfig({displayName:"MyEuiFormRow",componentId:"sc-1urlknr-0"})([".euiFormRow__labelWrapper{.euiText{padding-right:32px;}}"]),f=o()(n.EuiButtonEmpty).withConfig({displayName:"MyAddItemButton",componentId:"sc-1urlknr-1"})(["margin:4px 0px;&.euiButtonEmpty--small{font-size:12px;}.euiIcon{width:12px;height:12px;}"]);f.defaultProps={flush:"left",iconType:"plusInCircle",size:"s"};const y=({addText:e,dataTestSubj:t,field:a,idAria:s,isDisabled:o,validate:l})=>{const[c,u]=Object(i.useState)(!1),{isInvalid:y,errorMessage:h}=Object(g.i)(a),[E,v]=Object(i.useState)(-1),x=Object(i.useRef)([]),k=Object(i.useCallback)((e=>{const t=a.value,n=[...t.slice(0,e),...t.slice(e+1)];a.setValue(0===n.length?[""]:n),x.current=[...x.current.slice(0,e),...x.current.slice(e+1)],x.current=x.current.map(((t,a)=>(a>=e&&null!=x.current[e]&&(t.value="re-render"),t)))}),[a]),S=Object(i.useCallback)((()=>{const e=a.value;a.setValue([...e,""])}),[a]),j=Object(i.useCallback)(((e,t)=>{const n=a.value,i=e.target.value;a.setValue([...n.slice(0,t),i,...n.slice(t+1)])}),[a]),O=Object(i.useCallback)(((e,t)=>{null!=t&&(x.current=[...x.current.slice(0,e),t,...x.current.slice(e+1)])}),[x]);Object(i.useEffect)((()=>{-1===E||Object(p.isEmpty)(x.current)||null==x.current[E]||(x.current[E].focus(),v(-1))}),[E,x.current]);const w=a.value;return r.a.createElement(b,{label:a.label,labelAppend:a.labelAppend,error:c?h:null,isInvalid:c&&y,fullWidth:!0,"data-test-subj":t,describedByIds:s?[s]:void 0},r.a.createElement(r.a.Fragment,null,w.map(((e,t)=>{const a={disabled:o,...t===w.length-1?{inputRef:O.bind(null,t)}:{},value:e,isInvalid:null!=l&&c&&l(e)};return r.a.createElement("div",{key:t},r.a.createElement(n.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},r.a.createElement(n.EuiFlexItem,{grow:!0},r.a.createElement(n.EuiFieldText,d()({onBlur:()=>u(!0),onChange:e=>j(e,t),fullWidth:!0},a))),r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiButtonIcon,{color:"danger",iconType:"trash",isDisabled:o||Object(p.isEmpty)(e)&&1===w.length,onClick:()=>k(t),"aria-label":m.tb}))),w.length-1!==t&&r.a.createElement(n.EuiSpacer,{size:"s"}))})),r.a.createElement(f,{onClick:S,isDisabled:o},e)))};var h=a(377),E=a(7),v=a(310);const x=[{framework:"MITRE ATT&CK",tactic:{id:"none",name:"none",reference:"none"},technique:[]}];Object(v.b)([]);var k=a(0);const S=k.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.threatsDescription",{defaultMessage:"threats"}),j=k.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.tacticsDescription",{defaultMessage:"tactic"}),O=k.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.techniquesDescription",{defaultMessage:"technique"}),w=k.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.subtechniquesDescription",{defaultMessage:"subtechnique"}),T=k.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.addTacticTitle",{defaultMessage:"Add tactic"}),I=k.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.addTechniqueTitle",{defaultMessage:"Add technique"}),C=k.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.addSubtechniqueTitle",{defaultMessage:"Add subtechnique"}),M=k.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.tacticPlaceHolderDescription",{defaultMessage:"Select a tactic ..."}),F=k.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.techniquePlaceHolderDescription",{defaultMessage:"Select a technique ..."}),D=k.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.subtechniquePlaceHolderDescription",{defaultMessage:"Select a subtechnique ..."}),A=o.a.div.withConfig({displayName:"SubtechniqueContainer",componentId:"sc-1cb5h5o-0"})(["margin-left:48px;"]),_=({field:e,idAria:t,isDisabled:s,threatIndex:o,techniqueIndex:l,onFieldChange:c})=>{const u=e.value,[d,g]=Object(i.useState)([]);Object(i.useEffect)((()=>{!async function(){const e=await a.e(14).then(a.bind(null,1284));g(e.subtechniquesOptions)}()}),[]);const b=Object(i.useMemo)((()=>{var e;return[...null!==(e=u[o].technique)&&void 0!==e?e:[]]}),[u,o]),y=Object(i.useCallback)((t=>{var a;const n=[...e.value],i=null!==(a=b[l].subtechnique)&&void 0!==a?a:[];null!=i&&(i.splice(t,1),b[l]={...b[l],subtechnique:i},n[o].technique=b,c(n))}),[e,c,l,b,o]),h=Object(i.useCallback)((()=>{const t=[...e.value],a=b[l].subtechnique;b[l]=null!=a?{...b[l],subtechnique:[...a,{id:"none",name:"none",reference:"none"}]}:{...b[l],subtechnique:[{id:"none",name:"none",reference:"none"}]},t[o].technique=b,c(t)}),[e,c,l,b,o]),E=Object(i.useCallback)(((t,a)=>{const n=[...e.value],{id:i,reference:r,name:s}=d.find((e=>e.value===a))||{id:"",name:"",reference:""},u=b[l].subtechnique;null!=u&&c([...n.slice(0,o),{...n[o],technique:[...b.slice(0,l),{...b[l],subtechnique:[...u.slice(0,t),{id:i,reference:r,name:s},...u.slice(t+1)]},...b.slice(l+1)]},...n.slice(o+1)])}),[e.value,d,b,l,c,o]),v=Object(i.useCallback)(((t,a,i)=>{const s=d.filter((e=>e.techniqueId===b[l].id));return r.a.createElement(r.a.Fragment,null,r.a.createElement(n.EuiSuperSelect,{id:"mitreAttackSubtechnique",options:[..."none"===i.name?[{inputDisplay:r.a.createElement(r.a.Fragment,null,D),value:"none",disabled:a}]:[],...s.map((e=>({inputDisplay:r.a.createElement(r.a.Fragment,null,e.label),value:e.value,disabled:a})))],prepend:`${e.label} ${w}`,"aria-label":"",onChange:E.bind(null,t),fullWidth:!0,valueOfSelected:Object(p.camelCase)(i.name),"data-test-subj":"mitreAttackSubtechnique",disabled:a,placeholder:D}))}),[d,e.label,E,b,l]),x=Object(i.useMemo)((()=>b[l].subtechnique),[b,l]);return r.a.createElement(A,null,null!=x&&x.map(((e,a)=>r.a.createElement("div",{key:a},r.a.createElement(n.EuiSpacer,{size:"s"}),r.a.createElement(n.EuiFormRow,{fullWidth:!0,describedByIds:t?[`${t} ${w}`]:void 0},r.a.createElement(n.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},r.a.createElement(n.EuiFlexItem,{grow:!0},v(a,s,e)),r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiButtonIcon,{color:"danger",iconType:"trash",isDisabled:s,onClick:()=>y(a),"aria-label":m.tb}))))))),r.a.createElement(f,{"data-test-subj":"addMitreAttackSubtechnique",onClick:h,isDisabled:s},C))},N=(e,t)=>e.some((e=>e.techniqueId===t.id)),R=o.a.div.withConfig({displayName:"TechniqueContainer",componentId:"sc-1fugnao-0"})(["",""],(({theme:e})=>Object(s.css)(["margin-left:24px;padding-left:24px;border-left:2px solid ",";"],e.eui.euiColorLightestShade))),P=({field:e,idAria:t,isDisabled:s,threatIndex:o,onFieldChange:l})=>{var c;const u=e.value,[d,g]=Object(i.useState)([]),[b,y]=Object(i.useState)([]);Object(i.useEffect)((()=>{!async function(){const e=await a.e(14).then(a.bind(null,1284));g(e.techniquesOptions),y(e.subtechniquesOptions)}()}),[]);const h=Object(i.useCallback)((t=>{var a;const n=[...e.value],i=null!==(a=n[o].technique)&&void 0!==a?a:[];i.splice(t,1),n[o]={...n[o],technique:i},l(n)}),[e,o,l]),E=Object(i.useCallback)((()=>{var t;const a=[...e.value];a[o]={...a[o],technique:[...null!==(t=a[o].technique)&&void 0!==t?t:[],{id:"none",name:"none",reference:"none",subtechnique:[]}]},l(a)}),[e,o,l]),v=Object(i.useCallback)(((t,a)=>{var n;const i=[...e.value],{id:r,reference:s,name:c}=d.find((e=>e.value===a))||{id:"",name:"",reference:""},u=null!==(n=i[o].technique)&&void 0!==n?n:[];l([...i.slice(0,o),{...i[o],technique:[...u.slice(0,t),{id:r,reference:s,name:c,subtechnique:[]},...u.slice(t+1)]},...i.slice(o+1)])}),[e.value,d,o,l]),x=Object(i.useCallback)(((t,a,i,s)=>{const o=d.filter((e=>e.tactics.includes(Object(p.kebabCase)(t))));return r.a.createElement(r.a.Fragment,null,r.a.createElement(n.EuiSuperSelect,{id:"mitreAttackTechnique",options:[..."none"===s.name?[{inputDisplay:r.a.createElement(r.a.Fragment,null,F),value:"none",disabled:i}]:[],...o.map((e=>({inputDisplay:r.a.createElement(r.a.Fragment,null,e.label),value:e.value,disabled:i})))],prepend:`${e.label} ${O}`,"aria-label":"",onChange:v.bind(null,a),fullWidth:!0,valueOfSelected:Object(p.camelCase)(s.name),"data-test-subj":"mitreAttackTechnique",disabled:i,placeholder:F}))}),[e.label,d,v]),k=null!==(c=u[o].technique)&&void 0!==c?c:[];return r.a.createElement(R,null,k.map(((a,i)=>r.a.createElement("div",{key:i},r.a.createElement(n.EuiSpacer,{size:"s"}),r.a.createElement(n.EuiFormRow,{fullWidth:!0,describedByIds:t?[`${t} ${O}`]:void 0},r.a.createElement(n.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},r.a.createElement(n.EuiFlexItem,{grow:!0},x(u[o].tactic.name,i,s,a)),r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiButtonIcon,{color:"danger",iconType:"trash",isDisabled:s,onClick:()=>h(i),"aria-label":m.tb})))),r.a.createElement(_,{field:e,idAria:t,isDisabled:s||"none"===a.name||!1===N(b,a),threatIndex:o,techniqueIndex:i,onFieldChange:l})))),r.a.createElement(f,{"data-test-subj":"addMitreAttackTechnique",onClick:E,isDisabled:s},I))},L=o.a.div.withConfig({displayName:"MitreAttackContainer",componentId:"sc-bsl0gv-0"})(["margin-top:16px;"]),B=o()(n.EuiFormRow).withConfig({displayName:"InitialMitreAttackFormRow",componentId:"sc-bsl0gv-1"})([".euiFormRow__labelWrapper{.euiText{padding-right:32px;}}"]),q=Object(i.memo)((({field:e,idAria:t,isDisabled:s})=>{const o=Object(i.useCallback)((t=>{const a=[...e.value];a.splice(t,1),Object(p.isEmpty)(a)?e.setValue(x):e.setValue(a)}),[e]),l=Object(i.useCallback)((()=>{const t=[...e.value];Object(p.isEmpty)(t[t.length-1])?e.setValue([{tactic:{id:"none",name:"none",reference:"none"},technique:[]}]):e.setValue([...t,{tactic:{id:"none",name:"none",reference:"none"},technique:[]}])}),[e]),[c,u]=Object(i.useState)([]);Object(i.useEffect)((()=>{!async function(){const e=await a.e(14).then(a.bind(null,1284));u(e.tacticsOptions)}()}),[]);const d=Object(i.useCallback)(((t,a)=>{const n=[...e.value],{id:i,reference:r,name:s}=c.find((e=>e.value===a))||{id:"",name:"",reference:""};n.splice(t,1,{...n[t],tactic:{id:i,reference:r,name:s},technique:[]}),e.setValue([...n])}),[e,c]),g=Object(i.useMemo)((()=>[...e.value]),[e]),b=Object(i.useCallback)(((t,a,i)=>{const l=t.tactic.name;return r.a.createElement(n.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},r.a.createElement(n.EuiFlexItem,{grow:!0},r.a.createElement(n.EuiSuperSelect,{id:"mitreAttackTactic",options:[..."none"===l?[{inputDisplay:r.a.createElement(r.a.Fragment,null,M),value:"none",disabled:i}]:[],...c.map((e=>({inputDisplay:r.a.createElement(r.a.Fragment,null,e.text),value:e.value,disabled:i})))],prepend:`${e.label} ${j}`,"aria-label":"",onChange:d.bind(null,a),fullWidth:!0,valueOfSelected:Object(p.camelCase)(l),"data-test-subj":"mitreAttackTactic",placeholder:M})),r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiButtonIcon,{color:"danger",iconType:"trash",isDisabled:s||Object(E.isEqual)(g,x),onClick:()=>o(a),"aria-label":m.tb})))}),[e.label,s,o,c,d,g]),y=Object(i.useCallback)((t=>{e.setValue(t)}),[e]);return r.a.createElement(L,null,g.map(((a,i)=>r.a.createElement("div",{key:i},0===i?r.a.createElement(B,{fullWidth:!0,label:`${e.label} ${S}`,labelAppend:e.labelAppend,describedByIds:t?[`${t} ${j}`]:void 0},r.a.createElement(r.a.Fragment,null,b(a,i,s))):r.a.createElement(n.EuiFormRow,{fullWidth:!0,describedByIds:t?[`${t} ${j}`]:void 0},b(a,i,s)),r.a.createElement(P,{field:e,threatIndex:i,isDisabled:s||"none"===a.tactic.name,idAria:t,onFieldChange:y})))),r.a.createElement(f,{"data-test-subj":"addMitreAttackTactic",onClick:l,isDisabled:s},T))}));var z=a(567),$=a(191);const V=r.a.createElement(n.EuiText,{color:"subdued",size:"xs"},m.Ub);var U=a(492);const{emptyField:H}=g.h,G={author:{type:g.a.COMBO_BOX,label:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldAuthorLabel",{defaultMessage:"Author"}),helpText:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldAuthorHelpText",{defaultMessage:"Type one or more authors for this rule. Press enter after each author to add a new one."}),labelAppend:V,validations:[{validator:H(k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.authorFieldEmptyError",{defaultMessage:"An author must not be empty"})),type:g.g.ARRAY_ITEM,isBlocking:!1}]},name:{type:g.a.TEXT,label:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldNameLabel",{defaultMessage:"Name"}),validations:[{validator:H(k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.nameFieldRequiredError",{defaultMessage:"A name is required."}))}]},description:{type:g.a.TEXTAREA,label:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldDescriptionLabel",{defaultMessage:"Description"}),validations:[{validator:H(k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.descriptionFieldRequiredError",{defaultMessage:"A description is required."}))}]},isBuildingBlock:{type:g.a.CHECKBOX,label:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldBuildingBlockLabel",{defaultMessage:'Mark all generated alerts as "building block" alerts'}),labelAppend:V},isAssociatedToEndpointList:{type:g.a.CHECKBOX,label:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldAssociatedToEndpointListLabel",{defaultMessage:"Add existing Endpoint exceptions to the rule"}),labelAppend:V},severity:{value:{},mapping:{},isMappingChecked:{}},riskScore:{value:{},mapping:{},isMappingChecked:{}},references:{label:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldReferenceUrlsLabel",{defaultMessage:"Reference URLs"}),labelAppend:V,validations:[{validator:(...e)=>{const[{value:t,path:a}]=e;let n=!1;return t.forEach((e=>{Object($.c)(e)&&(n=!0)})),n?{code:"ERR_FIELD_FORMAT",path:a,message:U.k}:void 0}}]},falsePositives:{label:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldFalsePositiveLabel",{defaultMessage:"False positive examples"}),labelAppend:V},license:{type:g.a.TEXT,label:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldLicenseLabel",{defaultMessage:"License"}),helpText:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldLicenseHelpText",{defaultMessage:"Add a license name"}),labelAppend:V},ruleNameOverride:{type:g.a.TEXT,label:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRuleNameOverrideLabel",{defaultMessage:"Rule name override"}),helpText:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRuleNameOverrideHelpText",{defaultMessage:"Choose a field from the source event to populate the rule name in the alert list."}),labelAppend:V},threat:{label:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldMitreThreatLabel",{defaultMessage:"MITRE ATT&CK\\u2122"}),labelAppend:V},threatIndicatorPath:{type:g.a.TEXT,label:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThreatIndicatorPathLabel",{defaultMessage:"Indicator prefix override"}),helpText:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThreatIndicatorPathHelpText",{defaultMessage:"Specify the document prefix containing your indicator fields. Used for enrichment of indicator match alerts."}),labelAppend:V},timestampOverride:{type:g.a.TEXT,label:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimestampOverrideLabel",{defaultMessage:"Timestamp override"}),helpText:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimestampOverrideHelpText",{defaultMessage:"Choose timestamp field used when executing rule. Pick field with timestamp closest to ingest time (e.g. event.ingested)."}),labelAppend:V},timestampOverrideFallbackDisabled:{type:g.a.CHECKBOX,defaultValue:!1,label:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimestampOverrideFallbackDisabledLabel",{defaultMessage:"Do not use @timestamp as a fallback timestamp field"}),labelAppend:V},tags:{type:g.a.COMBO_BOX,label:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTagsLabel",{defaultMessage:"Tags"}),helpText:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTagsHelpText",{defaultMessage:"Type one or more custom identifying tags for this rule. Press enter after each tag to begin a new one."}),labelAppend:V,validations:[{validator:H(k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.tagFieldEmptyError",{defaultMessage:"A tag must not be empty"})),type:g.g.ARRAY_ITEM,isBlocking:!1}]},note:{type:g.a.TEXTAREA,label:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.guideLabel",{defaultMessage:"Investigation guide"}),helpText:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.guideHelpText",{defaultMessage:"Provide helpful information for analysts that are investigating detection alerts. This guide will appear on the rule details page and in timelines (as notes) created from detection alerts generated by this rule."}),labelAppend:V}},Q={type:g.a.TEXT,label:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThreatIndicatorPathLabel",{defaultMessage:"Indicator prefix override"}),helpText:k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThreatIndicatorPathHelpText",{defaultMessage:"Specify the document prefix containing your indicator fields. Used for enrichment of indicator match alerts."}),validations:[{validator:H(k.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.threatIndicatorPathFieldEmptyError",{defaultMessage:"Indicator prefix override must not be empty"})),type:g.g.FIELD}]};var W=a(371),K=a(493),Y=a(459),J=a(265),X=a(77),Z=a(631);const ee=o.a.div.withConfig({displayName:"NestedContent",componentId:"sc-1o9f6e3-0"})(["margin-left:24px;"]),te=o()(n.EuiFlexItem).withConfig({displayName:"EuiFlexItemComboBoxColumn",componentId:"sc-1o9f6e3-1"})(["max-width:376px;"]),ae=o()(n.EuiFlexItem).withConfig({displayName:"EuiFlexItemIconColumn",componentId:"sc-1o9f6e3-2"})(["width:20px;"]),ne=o()(n.EuiFlexItem).withConfig({displayName:"EuiFlexItemSeverityColumn",componentId:"sc-1o9f6e3-3"})(["width:80px;"]),ie=({dataTestSubj:e,field:t,idAria:a,indices:s,isDisabled:o,options:l})=>{const{services:c}=Object(X.k)(),{value:u,isMappingChecked:d,mapping:m}=t.value,{setValue:g}=t,b=Object(i.useCallback)(((e,t)=>{g({value:u,isMappingChecked:d,mapping:[...m.slice(0,t),...e,...m.slice(t+1)]})}),[u,d,m,g]),f=Object(i.useCallback)(((e,t,[a])=>{var n;const i=[{...m[e],field:null!==(n=null==a?void 0:a.name)&&void 0!==n?n:"",value:null!=a?m[e].value:"",operator:"equals",severity:t}];b(i,e)}),[m,b]),y=Object(i.useCallback)((e=>{g({value:e,isMappingChecked:d,mapping:m})}),[d,m,g]),h=Object(i.useCallback)(((e,t,a)=>{const n=[{...m[e],field:m[e].field,value:null!=m[e].field&&""!==m[e].field?a:"",operator:"equals",severity:t}];b(n,e)}),[m,b]),E=Object(i.useCallback)((()=>{g({value:u,mapping:[...m],isMappingChecked:!d})}),[d,m,u,g]),v=Object(i.useMemo)((()=>r.a.createElement("div",null,r.a.createElement(n.EuiFlexGroup,{gutterSize:"s"},r.a.createElement(n.EuiFlexItem,null,Z.b)),r.a.createElement(n.EuiSpacer,{size:"xs"}),r.a.createElement(n.EuiText,{size:"xs"},Z.c))),[]),x=Object(i.useMemo)((()=>r.a.createElement("div",null,r.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"s",onClick:o?p.noop:E},r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiCheckbox,{id:"severity-mapping-override",checked:d,disabled:o,onChange:E})),r.a.createElement(n.EuiFlexItem,null,Z.d)),r.a.createElement(n.EuiSpacer,{size:"xs"}),r.a.createElement(ee,null,r.a.createElement(n.EuiText,{size:"xs"},Z.e)))),[E,o,d]);return r.a.createElement(n.EuiFlexGroup,{direction:"column"},r.a.createElement(n.EuiFlexItem,null,r.a.createElement(n.EuiFormRow,{label:v,labelAppend:t.labelAppend,helpText:t.helpText,error:"errorMessage",isInvalid:!1,fullWidth:!0,"data-test-subj":"detectionEngineStepAboutRuleSeverity",describedByIds:["detectionEngineStepAboutRuleSeverity"]},r.a.createElement(n.EuiSuperSelect,{fullWidth:!1,disabled:!1,valueOfSelected:u,onChange:y,options:l,"data-test-subj":"select"}))),r.a.createElement(n.EuiFlexItem,null,r.a.createElement(n.EuiFormRow,{label:x,labelAppend:t.labelAppend,helpText:d?r.a.createElement(ee,null,Z.f):"",error:"errorMessage",isInvalid:!1,fullWidth:!0,"data-test-subj":`${e}-severityOverride`,describedByIds:a?[a]:void 0},r.a.createElement(ee,null,r.a.createElement(n.EuiSpacer,{size:"s"}),d&&r.a.createElement(n.EuiFlexGroup,{direction:"column",gutterSize:"s"},r.a.createElement(n.EuiFlexItem,null,r.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},r.a.createElement(te,null,r.a.createElement(n.EuiFormLabel,null,Z.g)),r.a.createElement(te,null,r.a.createElement(n.EuiFormLabel,null,Z.h)),r.a.createElement(ae,{grow:!1}),r.a.createElement(ne,{grow:!1},r.a.createElement(n.EuiFormLabel,null,Z.a)))),m.map(((e,t)=>{var a;return r.a.createElement(n.EuiFlexItem,{key:`${e.severity}-${t}`},r.a.createElement(n.EuiFlexGroup,{"data-test-subj":"severityOverrideRow",alignItems:"center",gutterSize:"s"},r.a.createElement(te,null,r.a.createElement(J.b,{placeholder:"",selectedField:re(e,s),isLoading:!1,isDisabled:o,isClearable:!1,indexPattern:s,onChange:f.bind(null,t,e.severity),"data-test-subj":`detectionEngineStepAboutRuleSeverityMappingField-${e.severity}-${t}`,"aria-label":`detectionEngineStepAboutRuleSeverityMappingField-${e.severity}-${t}`})),r.a.createElement(te,null,r.a.createElement(J.a,{autocompleteService:c.unifiedSearch.autocomplete,placeholder:"",selectedField:re(e,s),selectedValue:e.value,isClearable:!1,isDisabled:o,isLoading:!1,indexPattern:s,onChange:h.bind(null,t,e.severity),"data-test-subj":`detectionEngineStepAboutRuleSeverityMappingValue-${e.severity}-${t}`,"aria-label":`detectionEngineStepAboutRuleSeverityMappingValue-${e.severity}-${t}`})),r.a.createElement(ae,{grow:!1},r.a.createElement(n.EuiIcon,{type:"sortRight"})),r.a.createElement(ne,{grow:!1},null===(a=l.find((t=>t.value===e.severity)))||void 0===a?void 0:a.inputDisplay)))})))))))},re=(e,t)=>{const{field:a}=e,[n]=t.fields.filter((({name:e})=>a===e));return null!=n?n:{name:a,type:"string"}};var se=a(632);const oe=o.a.div.withConfig({displayName:"NestedContent",componentId:"sc-1k1nimg-0"})(["margin-left:24px;"]),le=o()(n.EuiFlexItem).withConfig({displayName:"EuiFlexItemComboBoxColumn",componentId:"sc-1k1nimg-1"})(["max-width:376px;"]),ce=o()(n.EuiFlexItem).withConfig({displayName:"EuiFlexItemIconColumn",componentId:"sc-1k1nimg-2"})(["width:20px;"]),ue=o()(n.EuiFlexItem).withConfig({displayName:"EuiFlexItemRiskScoreColumn",componentId:"sc-1k1nimg-3"})(["width:160px;"]),de=({dataTestSubj:e,field:t,idAria:a,indices:s,isDisabled:o,placeholder:l})=>{const{value:c,isMappingChecked:u,mapping:d}=t.value,{setValue:m}=t,g=Object(i.useMemo)((()=>["number"]),[]),b=Object(i.useMemo)((()=>pe(d,s)),[d,s]),f=Object(i.useCallback)((e=>{const t=e.target.value;m({value:Number(t.trim()),isMappingChecked:u,mapping:d})}),[m,u,d]),y=Object(i.useCallback)((([e])=>{var t;m({value:c,isMappingChecked:u,mapping:[{field:null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"",operator:"equals",value:"",risk_score:void 0}]})}),[m,c,u]),h=Object(i.useCallback)((()=>{m({value:c,isMappingChecked:!u,mapping:[...d]})}),[m,c,u,d]),E=Object(i.useMemo)((()=>r.a.createElement("div",null,r.a.createElement(n.EuiFlexGroup,{gutterSize:"s"},r.a.createElement(n.EuiFlexItem,null,se.a)),r.a.createElement(n.EuiSpacer,{size:"xs"}),r.a.createElement(n.EuiText,{size:"xs"},se.c))),[]),v=Object(i.useMemo)((()=>r.a.createElement("div",null,r.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"s",onClick:o?p.noop:h},r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiCheckbox,{id:"risk_score-mapping-override",checked:u,disabled:o,onChange:h})),r.a.createElement(n.EuiFlexItem,null,se.e)),r.a.createElement(n.EuiSpacer,{size:"xs"}),r.a.createElement(oe,null,r.a.createElement(n.EuiText,{size:"xs"},se.f)))),[u,h,o]);return r.a.createElement(n.EuiFlexGroup,{direction:"column"},r.a.createElement(n.EuiFlexItem,null,r.a.createElement(n.EuiFormRow,{label:E,labelAppend:t.labelAppend,helpText:t.helpText,error:"errorMessage",isInvalid:!1,fullWidth:!0,"data-test-subj":`${e}-defaultRisk`,describedByIds:a?[a]:void 0},r.a.createElement(n.EuiRange,{value:c,onChange:f,max:100,min:0,showRange:!0,showInput:!0,fullWidth:!1,showTicks:!0,tickInterval:25,"data-test-subj":`${e}-defaultRiskRange`}))),r.a.createElement(n.EuiFlexItem,null,r.a.createElement(n.EuiFormRow,{label:v,labelAppend:t.labelAppend,helpText:u?r.a.createElement(oe,null,se.g):"",error:"errorMessage",isInvalid:!1,fullWidth:!0,"data-test-subj":`${e}-riskOverride`,describedByIds:a?[a]:void 0},r.a.createElement(oe,null,r.a.createElement(n.EuiSpacer,{size:"s"}),u&&r.a.createElement(n.EuiFlexGroup,{direction:"column",gutterSize:"s"},r.a.createElement(n.EuiFlexItem,null,r.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},r.a.createElement(le,null,r.a.createElement(n.EuiFormLabel,null,se.h)),r.a.createElement(ce,{grow:!1}),r.a.createElement(ue,{grow:!1},r.a.createElement(n.EuiFormLabel,null,se.a)))),r.a.createElement(n.EuiFlexItem,null,r.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},r.a.createElement(le,null,r.a.createElement(J.b,{placeholder:null!=l?l:"",indexPattern:s,selectedField:b,fieldTypeFilter:g,isLoading:!1,isClearable:!1,isDisabled:o,onChange:y,"data-test-subj":e,"aria-label":a})),r.a.createElement(ce,{grow:!1},r.a.createElement(n.EuiIcon,{type:"sortRight"})),r.a.createElement(ue,{grow:!1},r.a.createElement(n.EuiText,{size:"s"},se.d)))))))))},pe=(e,t)=>{var a,n;const i=null!==(a=null==e||null===(n=e[0])||void 0===n?void 0:n.field)&&void 0!==a?a:"",[r]=t.fields.filter((({name:e})=>null!=i&&i===e));return null!=r?r:{name:i,type:"number"}},me=({dataTestSubj:e,field:t,idAria:a,indices:s,isDisabled:o,fieldType:l,placeholder:c})=>{const u=Object(i.useCallback)((([e])=>{var a;t.setValue(null!==(a=null==e?void 0:e.name)&&void 0!==a?a:"")}),[t]),d=Object(i.useMemo)((()=>{var e;const a=null!==(e=t.value)&&void 0!==e?e:"",[n]=s.fields.filter((({name:e})=>null!=a&&a===e));return n}),[t.value,s]),p=Object(i.useMemo)((()=>[l]),[l]);return r.a.createElement(n.EuiFormRow,{"data-test-subj":e,describedByIds:a?[a]:void 0,fullWidth:!0,helpText:t.helpText,label:t.label,labelAppend:t.labelAppend},r.a.createElement(J.b,{placeholder:null!=c?c:"",indexPattern:s,selectedField:d,fieldTypeFilter:p,isLoading:!1,isDisabled:o,isClearable:!1,onChange:u,"data-test-subj":e,"aria-label":a,fieldInputWidth:500}))};var ge=a(175),be=a(1),fe=a(723);const ye=Object(g.j)({component:g.b});o.a.div.withConfig({displayName:"ThreeQuartersContainer",componentId:"sc-1nsr0kk-0"})(["max-width:740px;"]).displayName="ThreeQuartersContainer";const he=o.a.div.withConfig({displayName:"TagContainer",componentId:"sc-1nsr0kk-1"})(["margin-top:16px;"]);he.displayName="TagContainer";const Ee=({addPadding:e=!1,defaultValues:t,defineRuleData:a,descriptionColumns:s="singleSplit",isReadOnlyView:o,isUpdateView:u=!1,isLoading:d,onSubmit:p,setForm:m,onRuleDataChange:b})=>{const{data:f}=Object(X.k)().services,E=Object(i.useMemo)((()=>Object(l.f)(null==a?void 0:a.ruleType)),[a]),v=Object(i.useMemo)((()=>E?{...G,threatIndicatorPath:Q}:G),[E]),[x,k]=Object(i.useState)(t.severity.value),{ruleIndices:S}=((e,t)=>{const a=Object(i.useMemo)((()=>null!=e?e:[]),[e]),{loading:n,jobs:r}=Object(fe.a)(a);return{mlJobLoading:n,ruleIndices:Object(i.useMemo)((()=>r.length>0?r[0].results_index_name?[`.ml-anomalies-${r[0].results_index_name}`]:[]:null!=t?t:[]),[r,t])}})(null==a?void 0:a.machineLearningJobId,null==a?void 0:a.index),[j,{indexPatterns:O}]=Object(ge.b)(S),[w,T]=Object(i.useState)(O);Object(i.useEffect)((()=>{null==(null==a?void 0:a.index)||""!==(null==a?void 0:a.dataViewId)&&null!=(null==a?void 0:a.dataViewId)||T(O)}),[null==a?void 0:a.dataViewId,null==a?void 0:a.index,O]),Object(i.useEffect)((()=>{(async()=>{if(null!=(null==a?void 0:a.dataViewId)&&""!==(null==a?void 0:a.dataViewId)){const e=await f.dataViews.get(null==a?void 0:a.dataViewId);T(e)}})()}),[f.dataViews,a,O,T]);const{form:I}=Object(g.k)({defaultValue:t,options:{stripEmptyFields:!1},schema:v}),{getFields:C,getFormData:M,submit:F}=I,[{severity:D,timestampOverride:A}]=Object(g.m)({form:I,watch:["isAssociatedToEndpointList","isBuildingBlock","riskScore","ruleNameOverride","severity","timestampOverride","threat","timestampOverrideFallbackDisabled"],onChange:e=>{b&&b({threatIndicatorPath:void 0,timestampOverrideFallbackDisabled:void 0,...e})}});Object(i.useEffect)((()=>{const e=null==D?void 0:D.value;if(null!=e&&e!==x){k(e);const t=z.h[e];if(null!=t){const e=C().riskScore;e.setValue({...e.value,value:t})}}}),[null==D?void 0:D.value,C,x]);const _=Object(i.useCallback)((async()=>{const e=await F();return null!=e&&e.isValid?{isValid:!0,data:{threatIndicatorPath:void 0,timestampOverrideFallbackDisabled:void 0,...e.data}}:{isValid:!1,data:M()}}),[M,F]),N=Object(i.useCallback)((()=>{p&&p()}),[p]);return Object(i.useEffect)((()=>{let e=!1;return m&&!e&&m(c.b.aboutRule,_),()=>{e=!0}}),[_,m]),o?r.a.createElement(W.a,{"data-test-subj":"aboutStep",addPadding:e},r.a.createElement(h.a,{columns:s,schema:v,data:t})):r.a.createElement(r.a.Fragment,null,r.a.createElement(W.a,{addPadding:!u},r.a.createElement(g.c,{form:I},r.a.createElement(ye,{path:"name",componentProps:{idAria:"detectionEngineStepAboutRuleName","data-test-subj":"detectionEngineStepAboutRuleName",euiFieldProps:{fullWidth:!0,disabled:d}}}),r.a.createElement(n.EuiSpacer,{size:"l"}),r.a.createElement(ye,{path:"description",componentProps:{idAria:"detectionEngineStepAboutRuleDescription","data-test-subj":"detectionEngineStepAboutRuleDescription",euiFieldProps:{disabled:d,compressed:!0,fullWidth:!0}}}),r.a.createElement(n.EuiSpacer,{size:"l"}),r.a.createElement(n.EuiFlexItem,null,r.a.createElement(g.e,{path:"severity",component:ie,componentProps:{dataTestSubj:"detectionEngineStepAboutRuleSeverityField",idAria:"detectionEngineStepAboutRuleSeverityField",isDisabled:d||j,options:z.i,indices:w}})),r.a.createElement(n.EuiSpacer,{size:"l"}),r.a.createElement(n.EuiFlexItem,null,r.a.createElement(ye,{path:"riskScore",component:de,componentProps:{dataTestSubj:"detectionEngineStepAboutRuleRiskScore",idAria:"detectionEngineStepAboutRuleRiskScore",isDisabled:d||j,indices:w}})),r.a.createElement(he,null,r.a.createElement(ye,{path:"tags",componentProps:{idAria:"detectionEngineStepAboutRuleTags","data-test-subj":"detectionEngineStepAboutRuleTags",euiFieldProps:{fullWidth:!0,isDisabled:d||j,placeholder:""}}})),r.a.createElement(n.EuiSpacer,{size:"l"}),r.a.createElement(n.EuiAccordion,{"data-test-subj":"advancedSettings",id:"advancedSettingsAccordion",buttonContent:U.d},r.a.createElement(n.EuiSpacer,{size:"l"}),r.a.createElement(g.e,{path:"references",component:y,componentProps:{addText:U.b,idAria:"detectionEngineStepAboutRuleReferenceUrls",isDisabled:d,dataTestSubj:"detectionEngineStepAboutRuleReferenceUrls",validate:$.c}}),r.a.createElement(g.e,{path:"falsePositives",component:y,componentProps:{addText:U.a,idAria:"detectionEngineStepAboutRuleFalsePositives",isDisabled:d,dataTestSubj:"detectionEngineStepAboutRuleFalsePositives"}}),r.a.createElement(g.e,{path:"threat",component:q,componentProps:{idAria:"detectionEngineStepAboutRuleMitreThreat",isDisabled:d,dataTestSubj:"detectionEngineStepAboutRuleMitreThreat"}}),r.a.createElement(n.EuiSpacer,{size:"l"}),r.a.createElement(g.e,{path:"note",component:Y.a,componentProps:{idAria:"detectionEngineStepAboutRuleNote",isDisabled:d,dataTestSubj:"detectionEngineStepAboutRuleNote",placeholder:U.c}}),r.a.createElement(n.EuiSpacer,{size:"l"}),r.a.createElement(ye,{path:"author",componentProps:{idAria:"detectionEngineStepAboutRuleAuthor","data-test-subj":"detectionEngineStepAboutRuleAuthor",euiFieldProps:{fullWidth:!0,isDisabled:d,placeholder:""}}}),r.a.createElement(n.EuiSpacer,{size:"l"}),r.a.createElement(ye,{path:"license",componentProps:{idAria:"detectionEngineStepAboutRuleLicense","data-test-subj":"detectionEngineStepAboutRuleLicense",euiFieldProps:{fullWidth:!0,disabled:d,placeholder:""}}}),r.a.createElement(n.EuiSpacer,{size:"l"}),r.a.createElement(n.EuiFormRow,{label:U.g,fullWidth:!0},r.a.createElement(ye,{path:"isAssociatedToEndpointList",componentProps:{idAria:"detectionEngineStepAboutRuleAssociatedToEndpointList","data-test-subj":"detectionEngineStepAboutRuleAssociatedToEndpointList",euiFieldProps:{disabled:d}}})),r.a.createElement(n.EuiFormRow,{label:U.e,fullWidth:!0},r.a.createElement(ye,{path:"isBuildingBlock",componentProps:{idAria:"detectionEngineStepAboutRuleBuildingBlock","data-test-subj":"detectionEngineStepAboutRuleBuildingBlock",euiFieldProps:{disabled:d}}})),r.a.createElement(n.EuiSpacer,{size:"l"}),E&&r.a.createElement(r.a.Fragment,null,r.a.createElement(ye,{path:"threatIndicatorPath",componentProps:{idAria:"detectionEngineStepAboutThreatIndicatorPath","data-test-subj":"detectionEngineStepAboutThreatIndicatorPath",euiFieldProps:{fullWidth:!0,disabled:d,placeholder:be.T}}})),r.a.createElement(n.EuiSpacer,{size:"l"}),r.a.createElement(g.e,{path:"ruleNameOverride",component:me,componentProps:{dataTestSubj:"detectionEngineStepAboutRuleRuleNameOverride",fieldType:"string",idAria:"detectionEngineStepAboutRuleRuleNameOverride",indices:w,isDisabled:d||j,placeholder:""}}),r.a.createElement(n.EuiSpacer,{size:"l"}),r.a.createElement(g.e,{path:"timestampOverride",component:me,componentProps:{dataTestSubj:"detectionEngineStepAboutRuleTimestampOverride",fieldType:"date",idAria:"detectionEngineStepAboutRuleTimestampOverride",indices:w,isDisabled:d||j,placeholder:""}}),!!A&&"@timestamp"!==A&&r.a.createElement(r.a.Fragment,null,r.a.createElement(ye,{path:"timestampOverrideFallbackDisabled",componentProps:{idAria:"detectionTimestampOverrideFallbackDisabled","data-test-subj":"detectionTimestampOverrideFallbackDisabled",euiFieldProps:{disabled:d}}}))))),!u&&r.a.createElement(K.a,{dataTestSubj:"about-continue",onClick:N,isDisabled:d}))},ve=Object(i.memo)(Ee)},function(e,t,a){"use strict";a.d(t,"a",(function(){return S}));var n=a(295),i=a(819),r=a(346),s=a(162);function o(e,t,a,n){const i=Object(r.f)(e)(t);return 0===Object(s.d)(a,i)?{...e,animation:void 0,panning:void 0}:{...e,panning:void 0,translationNotCountingCurrentPanning:a,animation:{startTime:t,targetTranslation:a,initialTranslation:i,duration:n}}}var l=a(96),c=a(275),u=a(464);const d=e=>{const t=c.a-c.b;return Math.pow((e-c.b)/t,1/c.f)};var p=a(467),m=a(508),g=a(465),b=a(222);const f={currentRelatedEvent:{loading:!1,data:null},resolverComponentInstanceID:void 0,indices:[],detectedBounds:void 0};var y=a(512);const h=Object(n.combineReducers)({camera:(e=function(){return{scalingFactor:d(1),rasterSize:[0,0],translationNotCountingCurrentPanning:[0,0],latestFocusedWorldCoordinates:null,animation:void 0,panning:void 0}}(),t)=>{if("userSetZoomLevel"===t.type)return{...e,scalingFactor:Object(u.a)(t.payload,0,1)};if("userClickedZoomIn"===t.type)return{...e,scalingFactor:Object(u.a)(e.scalingFactor+.1,0,1)};if("userClickedZoomOut"===t.type)return{...e,scalingFactor:Object(u.a)(e.scalingFactor-.1,0,1)};if("userZoomed"===t.type){const a={...e,scalingFactor:Object(u.a)(e.scalingFactor+t.payload.zoomChange,0,1)};if(null===e.latestFocusedWorldCoordinates||r.b(e)(t.payload.time))return a;{const n=s.c(e.latestFocusedWorldCoordinates,r.c(e)(t.payload.time)),i=s.c(n,r.a(a)(t.payload.time)),o=s.j(i,e.latestFocusedWorldCoordinates),l=s.j(a.translationNotCountingCurrentPanning,o);return{...a,translationNotCountingCurrentPanning:l}}}if("userSetPositionOfCamera"===t.type)return{...e,animation:void 0,translationNotCountingCurrentPanning:t.payload};if("userStartedPanning"===t.type)return r.b(e)(t.payload.time)?e:{...e,animation:void 0,panning:{origin:t.payload.screenCoordinates,currentOffset:t.payload.screenCoordinates}};if("userStoppedPanning"===t.type)return{...e,translationNotCountingCurrentPanning:r.f(e)(t.payload.time),panning:void 0};if("userNudgedCamera"===t.type){const{direction:a,time:n}=t.payload,i=s.h(s.e([c.e,c.e],r.d(e)(n)),a);return o(e,n,s.a(e.translationNotCountingCurrentPanning,i),c.c)}if("userSetRasterSize"===t.type)return{...e,rasterSize:t.payload};if("userMovedPointer"===t.type){let a=e;return e.panning&&(a={...e,panning:{origin:e.panning.origin,currentOffset:t.payload.screenCoordinates}}),{...a,latestFocusedWorldCoordinates:s.c(t.payload.screenCoordinates,r.a(a)(t.payload.time))}}return e},data:(e=f,t)=>{if("appReceivedNewExternalProperties"===t.type){const a={...e,tree:{...e.tree,currentParameters:{databaseDocumentID:t.payload.databaseDocumentID,indices:t.payload.indices,filters:t.payload.filters}},resolverComponentInstanceID:t.payload.resolverComponentInstanceID,locationSearch:t.payload.locationSearch,indices:t.payload.indices},n=m.x(a);return{...a,nodeEventsInCategory:a.nodeEventsInCategory&&g.a(a.nodeEventsInCategory,n)?a.nodeEventsInCategory:void 0}}if("appRequestedResolverData"===t.type)return{...e,tree:{...e.tree,pendingRequestParameters:{databaseDocumentID:t.payload.databaseDocumentID,indices:t.payload.indices,filters:t.payload.filters}}};var a,n,i;if("appAbortedResolverDataRequest"===t.type)return p.a(t.payload,null===(a=e.tree)||void 0===a?void 0:a.pendingRequestParameters)?{...e,tree:{...e.tree,pendingRequestParameters:void 0}}:e;if("serverReturnedResolverData"===t.type)return{...e,tree:{...e.tree,lastResponse:{result:t.payload.result,dataSource:t.payload.dataSource,schema:t.payload.schema,parameters:t.payload.parameters,successful:!0},pendingRequestParameters:void 0},detectedBounds:t.payload.detectedBounds};if("serverFailedToReturnResolverData"===t.type)return void 0!==(null===(n=e.tree)||void 0===n?void 0:n.pendingRequestParameters)?{...e,tree:{...e.tree,pendingRequestParameters:void 0,lastResponse:{parameters:e.tree.pendingRequestParameters,successful:!1}}}:e;if("serverReturnedNodeEventsInCategory"===t.type){if(g.a(t.payload,m.x(e))){if(e.nodeEventsInCategory){const a=g.b(e.nodeEventsInCategory,t.payload);if(a)return{...e,nodeEventsInCategory:{...a}};throw new Error("Could not handle related event data because of an internal error.")}return{...e,nodeEventsInCategory:t.payload}}return e}if("userRequestedAdditionalRelatedEvents"===t.type)return e.nodeEventsInCategory?{...e,nodeEventsInCategory:{...e.nodeEventsInCategory,lastCursorRequested:null===(i=e.nodeEventsInCategory)||void 0===i?void 0:i.cursor}}:e;if("serverFailedToReturnNodeEventsInCategory"===t.type)return e.nodeEventsInCategory?{...e,nodeEventsInCategory:{...e.nodeEventsInCategory,error:!0}}:e;if("serverReturnedNodeData"===t.type){const a=b.e({storedNodeInfo:e.nodeData,receivedEvents:t.payload.nodeData,requestedNodes:t.payload.requestedIDs,numberOfRequestedEvents:t.payload.numberOfRequestedEvents});return{...e,nodeData:a}}if("userReloadedResolverNode"===t.type){const a=b.c(e.nodeData,t.payload);return{...e,nodeData:a}}if("appRequestingNodeData"===t.type){const a=b.d(e.nodeData,t.payload.requestedIDs);return{...e,nodeData:a}}if("serverFailedToReturnNodeData"===t.type){const a=b.b(e.nodeData,t.payload.requestedIDs);return{...e,nodeData:a}}return"appRequestedCurrentRelatedEventData"===t.type?{...e,currentRelatedEvent:{loading:!0,data:null}}:"serverReturnedCurrentRelatedEventData"===t.type?{...e,currentRelatedEvent:{loading:!1,data:{...t.payload}}}:"serverFailedToReturnCurrentRelatedEventData"===t.type?{...e,currentRelatedEvent:{loading:!1,data:null}}:e},ui:(e={ariaActiveDescendant:null,selectedNode:null},t)=>"serverReturnedResolverData"===t.type?{...e,ariaActiveDescendant:t.payload.result.originID,selectedNode:t.payload.result.originID}:"userFocusedOnResolverNode"===t.type?{...e,ariaActiveDescendant:t.payload.nodeID}:"userSelectedResolverNode"===t.type?{...e,selectedNode:t.payload.nodeID,ariaActiveDescendant:t.payload.nodeID}:"appReceivedNewExternalProperties"===t.type?{...e,locationSearch:t.payload.locationSearch,resolverComponentInstanceID:t.payload.resolverComponentInstanceID}:e}),E=(e,t)=>{const a=h(e,t);if("userSelectedResolverNode"===t.type||"userFocusedOnResolverNode"===t.type){const e=Object(y.b)(Object(l.s)(a),t.payload.nodeID);return e?{...a,camera:o(a.camera,t.payload.time,e,c.d)}:a}return a};var v=a(276),x=a(466),k=a(7);const S=e=>{const t=Object(i.composeWithDevTools)({name:"Resolver",actionsBlacklist:["userMovedPointer"]}),a=Object(n.applyMiddleware)((e=>t=>a=>{const n=function(e,t){let a;return async()=>{const n=t.getState(),i=l.M(n);if(l.N(n)&&a)a.abort();else if(null!==i){let r,s,o,c;a=new AbortController;const u=l.K(n);t.dispatch({type:"appRequestedResolverData",payload:i});try{const n=await e.entities({_id:i.databaseDocumentID,indices:i.indices,signal:a.signal});if(n.length<1)return void t.dispatch({type:"serverFailedToReturnResolverData",payload:i});({id:r,schema:o,name:s}=n[0]),c=await e.resolverTree({dataId:r,schema:o,timeRange:u,indices:i.indices,ancestors:Object(x.a)(o),descendants:Object(x.b)()});const l={originID:r,nodes:c};if(0===l.nodes.length){const a=await e.resolverTree({dataId:r,schema:o,indices:i.indices,ancestors:Object(x.a)(o),descendants:Object(x.b)()});if(a.length>0){const e=a.map((e=>Object(v.a)(e.data["@timestamp"]))).sort(),n=e[0],r=e.slice(-1);t.dispatch({type:"serverReturnedResolverData",payload:{result:{...l,nodes:a},dataSource:s,schema:o,parameters:i,detectedBounds:{from:String(n),to:String(r)}}})}else t.dispatch({type:"serverReturnedResolverData",payload:{result:l,dataSource:s,schema:o,parameters:i}})}else t.dispatch({type:"serverReturnedResolverData",payload:{result:l,dataSource:s,schema:o,parameters:i}})}catch(e){e instanceof DOMException&&"AbortError"===e.name?t.dispatch({type:"appAbortedResolverDataRequest",payload:i}):t.dispatch({type:"serverFailedToReturnResolverData",payload:i})}}}}(e,t),i=function(e,t){let a;return async()=>{const n=t.getState(),i=l.z(n),r=l.o(n),s=l.f(n),o=a,c=void 0!==l.e(n)?void 0:l.K(n);async function u({nodeID:a,eventCategory:n,cursor:i}){let r=null;try{r=i?await e.eventsWithEntityIDAndCategory({entityID:a,category:n,after:i,indexPatterns:s,timeRange:c}):await e.eventsWithEntityIDAndCategory({entityID:a,category:n,indexPatterns:s,timeRange:c})}catch(e){t.dispatch({type:"serverFailedToReturnNodeEventsInCategory",payload:{nodeID:a,eventCategory:n,cursor:i}})}r&&t.dispatch({type:"serverReturnedNodeEventsInCategory",payload:{events:r.events,eventCategory:n,cursor:r.nextEvent,nodeID:a}})}if(a=i,Object(k.isEqual)(i,o)){if(r){const e=n.data.nodeEventsInCategory;void 0!==e&&await u(e)}}else if("nodeEventsInCategory"===i.panelView){const e=i.panelParameters.nodeID;t.dispatch({type:"appRequestedNodeEventsInCategory",payload:{parameters:i}}),await u({nodeID:e,eventCategory:i.panelParameters.eventCategory,cursor:null})}}}(e,t),r=function(e,t){let a;return async()=>{const n=t.getState(),i=l.z(n),r=l.f(n),s=a;if(a=i,!Object(k.isEqual)(i,s)&&"eventDetail"===i.panelView){const a=i.panelParameters.eventID,s=i.panelParameters.nodeID,o=i.panelParameters.eventCategory,c=i.panelParameters.eventTimestamp,u=i.panelParameters.winlogRecordID;t.dispatch({type:"appRequestedCurrentRelatedEventData"});const d=void 0!==l.e(n)?void 0:l.K(n);let p=null;try{p=await e.event({nodeID:s,eventCategory:[o],eventTimestamp:c,eventID:a,winlogRecordID:u,indexPatterns:r,timeRange:d})}catch(e){t.dispatch({type:"serverFailedToReturnCurrentRelatedEventData"})}p?t.dispatch({type:"serverReturnedCurrentRelatedEventData",payload:p}):t.dispatch({type:"serverFailedToReturnCurrentRelatedEventData"})}}}(e,t),s=function(e,t){return async()=>{const a=t.getState(),n=l.t(a)(Number.POSITIVE_INFINITY),i=l.f(a);if(n.size<=0)return;let r;t.dispatch({type:"appRequestingNodeData",payload:{requestedIDs:n}});try{const t=void 0!==l.e(a)?void 0:l.K(a);r=await e.nodeData({ids:Array.from(n),timeRange:t,indexPatterns:i,limit:5e3})}catch(e){t.dispatch({type:"serverFailedToReturnNodeData",payload:{requestedIDs:n}})}r&&t.dispatch({type:"serverReturnedNodeData",payload:{nodeData:r,requestedIDs:n,numberOfRequestedEvents:5e3}})}}(e,t);return async e=>{a(e),n(),i(),s(),r()}})(e));return Object(n.createStore)(E,t(a))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return N}));var n=a(4),i=a.n(n),r=a(32),s=a(51),o=a(1),l=a(411),c=a(176),u=a(109),d=a(234),p=a(119),m=a(211),g=a(124),b=a(327),f=a(89),y=a(869);const h=i.a.memo((({allItems:e,selectedItems:t,title:a,onSelectedItemsChange:s})=>{const[o,l]=Object(n.useState)(!1),c=Object(n.useCallback)((e=>s(E(e,t))),[t,s]),u=Object(n.useMemo)((()=>e.map(((e,a)=>i.a.createElement(r.EuiFilterSelectItem,{checked:t.includes(e)?"on":void 0,key:`${a}-${e}`,onClick:()=>c(e),title:e},e)))),[e,t,c]),d=Object(n.useCallback)((e=>{l((t=>e||!t))}),[l]);return i.a.createElement(r.EuiPopover,{ownFocus:!0,button:i.a.createElement(r.EuiFilterGroup,null,i.a.createElement(r.EuiFilterButton,{grow:!1,"data-test-subj":"multiselect-popover-button",iconType:"arrowDown",onClick:()=>d(),numFilters:e.length,isSelected:o,hasActiveFilters:t.length>0,numActiveFilters:t.length},a)),isOpen:o,closePopover:()=>d(!1),panelPaddingSize:"none"},u)}));h.displayName="MultiSelectPopover";const E=(e,t)=>{const a=t.indexOf(e),n=[...t];return a>=0?n.splice(a,1):n.push(e),n};var v=a(0);const x=v.i18n.translate("xpack.securitySolution.alertCountByRuleByStatus.status",{defaultMessage:"Status"}),k=v.i18n.translate("xpack.securitySolution.alertCountByRuleByStatus.alertsByRule",{defaultMessage:"Alerts by Rule"}),S=v.i18n.translate("xpack.securitySolution.alertCountByRuleByStatus.ruleName",{defaultMessage:"kibana.alert.rule.name"}),j=v.i18n.translate("xpack.securitySolution.alertCountByRuleByStatus.count",{defaultMessage:"count"}),O=v.i18n.translate("xpack.securitySolution.alertCountByRuleByStatus.tooltipTitle",{defaultMessage:"Rule name"}),w=v.i18n.translate("xpack.securitySolution.alertCountByRuleByStatus.noRuleAlerts",{defaultMessage:"No alerts to display"});var T=a(185),I=a(186),C=a(114),M=a(127);const F="alertsByRuleAggregation",D=({additionalFilters:e=[],from:t,to:a,field:n,value:i,statuses:r})=>({size:0,query:{bool:{filter:[...e,{range:{"@timestamp":{gte:t,lte:a}}},{terms:{"kibana.alert.workflow_status":r}},{term:{[n]:i}}]}},aggs:{[F]:{terms:{field:"kibana.alert.rule.name",size:100},aggs:{ruleUuid:{top_hits:{_source:["kibana.alert.rule.uuid"],size:1}}}}}}),A=["open","acknowledged","closed"],_=Object(s.euiStyled)(r.EuiPanel)`
  display: flex;
  flex-direction: column;
  position: relative;
  overflow: hidden;
  max-height: 308px;
`,N=i.a.memo((({entityFilter:e,signalIndexName:t,additionalFilters:a})=>{const{field:s,value:o}=e,d=`alerts-by-status-by-rule-by-${s}`,{toggleStatus:f,setToggleStatus:E}=Object(u.a)(d),{openTimelineWithFilters:v}=Object(l.a)(),[S,j]=Object(y.a)({defaultValue:{[s]:["open"]},key:"alertCountByFieldNameWidgetSettings",isInvalidDefault:e=>!e}),O=Object(n.useMemo)((()=>R((t=>{const a=[];for(const n of S[s])a.push([e,{field:c.l,value:t},{field:c.m,value:n}]);v(a)}))),[e,s,v,S]),N=Object(n.useCallback)((e=>{j({...S,[s]:e})}),[s,S,j]),{items:P,isLoading:L,updatedAt:B}=(({additionalFilters:e,field:t,value:a,queryId:i,statuses:r,skip:s=!1,signalIndexName:o})=>{const[l,c]=Object(n.useState)(Date.now()),[u,d]=Object(n.useState)([]),{to:p,from:m,deleteQuery:g,setQuery:b}=Object(C.a)(),{loading:f,data:y,setQuery:h,response:E,request:v,refetch:x}=Object(I.a)({query:D({additionalFilters:e,from:m,to:p,field:t,value:a,statuses:r}),skip:s,queryName:T.a.ALERTS_COUNT_BY_STATUS,indexName:o});Object(n.useEffect)((()=>{h(D({additionalFilters:e,from:m,to:p,field:t,value:a,statuses:r}))}),[h,m,p,t,a,r,e]),Object(n.useEffect)((()=>{var e,t;d(y?(e=y.aggregations,(null!==(t=null==e?void 0:e[F].buckets)&&void 0!==t?t:[]).map((e=>{var t,a;const n=(null===(t=e.ruleUuid.hits)||void 0===t||null===(a=t.hits[0])||void 0===a?void 0:a._source["kibana.alert.rule.uuid"])||"";return{ruleName:e.key,count:e.doc_count,uuid:n}}))):[]),c(Date.now())}),[y]);const k=Object(n.useCallback)((()=>{!s&&x&&x()}),[s,x]);return Object(M.b)({deleteQuery:g,inspect:{dsl:[v],response:[E]},refetch:k,setQuery:b,queryId:i,loading:f}),{items:u,isLoading:f,updatedAt:l}})({additionalFilters:a,field:s,value:o,queryId:d,statuses:S[s],skip:!f,signalIndexName:t});return i.a.createElement(m.a,{show:!0,targetClassNames:[g.a]},i.a.createElement(_,{hasBorder:!0,"data-test-subj":"alertCountByRulePanel"},i.a.createElement(i.a.Fragment,null,i.a.createElement(p.a,{id:d,title:k,titleSize:"m",toggleStatus:f,toggleQuery:E,subtitle:i.a.createElement(b.a,{updatedAt:B,isUpdating:L})},i.a.createElement(h,{title:x,allItems:A,selectedItems:S[s]||["open"],onSelectedItemsChange:e=>N(e)})),f&&i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiBasicTable,{className:"eui-yScroll","data-test-subj":"alertCountByRuleTable",columns:O,items:P,loading:L,noItemsMessage:i.a.createElement(r.EuiEmptyPrompt,{title:i.a.createElement("h3",null,w),titleSize:"xs"})})))))}));N.displayName="AlertCountByStatus";const R=e=>[{field:"ruleName",name:S,"data-test-subj":S,align:"left",width:"67%",sortable:!1,render:(e,{uuid:t})=>i.a.createElement(r.EuiToolTip,{"data-test-subj":`${e}-tooltip`,title:O,content:e,anchorClassName:"eui-textTruncate"},i.a.createElement(f.k,{"data-test-subj":"severityRuleAlertsTable-name",deepLinkId:o.uc.rules,path:`id/${t}`},e))},{field:"count",name:j,width:"33%","data-test-subj":j,sortable:!0,align:"right",render:(t,{ruleName:a})=>i.a.createElement(r.EuiLink,{disabled:0===t,onClick:()=>e(a)},i.a.createElement(d.a,{count:t}))}]},,function(e,t,a){"use strict";a.d(t,"b",(function(){return j})),a.d(t,"c",(function(){return O})),a.d(t,"a",(function(){return Fe}));var n=a(34),i=a(4),r=a.n(i),s=a(79),o=a(223),l=a(32),c=a(88),u=a(277),d=a(199),p=a(97),m=a(224),g=a(477),b=a(644);const f=e=>null==e||"unset"===e.toLowerCase(),y=r.a.memo((({contextId:e,eventId:t,primary:a,secondary:n,isDraggable:i})=>f(a)&&f(n)?null:!f(a)&&f(n)?r.a.createElement(c.c,{contextId:e,eventId:t,field:"auditd.summary.actor.primary",isDraggable:i,value:a,iconType:"user",isAggregatable:!0,fieldType:"keyword"}):f(a)&&!f(n)||a===n?r.a.createElement(c.c,{contextId:e,eventId:t,field:"auditd.summary.actor.secondary",isDraggable:i,value:n,iconType:"user",isAggregatable:!0,fieldType:"keyword"}):r.a.createElement(l.EuiFlexGroup,{gutterSize:"none"},r.a.createElement(p.c,{grow:!1,component:"span"},r.a.createElement(c.c,{contextId:e,eventId:t,field:"auditd.summary.actor.primary",isDraggable:i,value:a,iconType:"user",isAggregatable:!0,fieldType:"keyword"})),r.a.createElement(p.c,{grow:!1,component:"span"},u.i),r.a.createElement(p.c,{grow:!1,component:"span"},r.a.createElement(c.c,{contextId:e,eventId:t,field:"auditd.summary.actor.secondary",isDraggable:i,value:n,iconType:"user",isAggregatable:!0,fieldType:"keyword"})))));y.displayName="PrimarySecondary";const h=r.a.memo((({contextId:e,eventId:t,userName:a,primary:n,secondary:i,isDraggable:s})=>f(a)&&f(n)&&f(i)?null:f(a)||f(n)||f(i)||a!==n||a!==i?!f(a)&&f(n)&&f(i)?r.a.createElement(c.c,{contextId:e,eventId:t,field:"user.name",isDraggable:s,value:a,iconType:"user",isAggregatable:!0,fieldType:"keyword"}):r.a.createElement(y,{contextId:e,eventId:t,isDraggable:s,primary:n,secondary:i}):r.a.createElement(c.c,{contextId:e,eventId:t,field:"user.name",isDraggable:s,value:a,iconType:"user",isAggregatable:!0,fieldType:"keyword"})));h.displayName="PrimarySecondaryUserInfo";const E=r.a.memo((({eventId:e,contextId:t,hostName:a,userName:n,primary:i,secondary:s,workingDirectory:o,session:l,isDraggable:d})=>r.a.createElement(r.a.Fragment,null,r.a.createElement(p.c,{grow:!1,component:"span"},u.Vb),r.a.createElement(p.c,{grow:!1,component:"span"},r.a.createElement(c.c,{contextId:t,eventId:e,field:"auditd.session",value:l,iconType:"number",isDraggable:d,isAggregatable:!0,fieldType:"keyword"})),r.a.createElement(p.c,{grow:!1,component:"span"},r.a.createElement(h,{contextId:t,eventId:e,userName:n,primary:i,secondary:s,isDraggable:d})),null!=a&&r.a.createElement(p.c,{grow:!1,component:"span"},"@"),r.a.createElement(b.a,{contextId:t,eventId:e,workingDirectory:o,hostName:a,isDraggable:d}))));E.displayName="SessionUserHostWorkingDir";const v=r.a.memo((({id:e,contextId:t,hostName:a,userName:n,primary:i,processName:s,processPid:o,processExecutable:d,processTitle:b,secondary:f,workingDirectory:y,args:h,result:v,session:x,text:k,isDraggable:S})=>r.a.createElement(l.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none",wrap:!0},r.a.createElement(E,{eventId:e,contextId:t,hostName:a,userName:n,primary:i,secondary:f,workingDirectory:y,session:x,isDraggable:S}),null!=d&&r.a.createElement(p.c,{grow:!1,component:"span"},k),r.a.createElement(p.c,{grow:!1,component:"span"},r.a.createElement(m.a,{contextId:t,endgamePid:void 0,endgameProcessName:void 0,eventId:e,processPid:o,processName:s,processExecutable:d,isDraggable:S})),r.a.createElement(g.a,{eventId:e,args:h,contextId:t,isDraggable:S,processTitle:b}),null!=v&&r.a.createElement(p.c,{grow:!1,component:"span"},u.pc),r.a.createElement(p.c,{grow:!1,component:"span"},r.a.createElement(c.c,{contextId:t,eventId:e,field:"auditd.result",isDraggable:S,queryValue:v,value:v,isAggregatable:!0,fieldType:"keyword"})))));v.displayName="AuditdGenericLine";const x=r.a.memo((({data:e,contextId:t,isDraggable:a,text:i,timelineId:s})=>{const o=e._id,c=Object(n.get)("auditd.session[0]",e),u=Object(n.get)("host.name[0]",e),m=Object(n.get)("user.name[0]",e),g=Object(n.get)("auditd.result[0]",e),b=Object(n.get)("process.pid[0]",e),f=Object(n.get)("process.name[0]",e),y=Object(n.get)("process.executable[0]",e),h=Object(n.get)("process.title[0]",e),E=Object(n.get)("process.working_directory[0]",e),x=Object(n.get)("auditd.summary.actor.primary[0]",e),k=Object(n.get)("auditd.summary.actor.secondary[0]",e),S=Object(n.get)("process.args",e);return null!=e.process?r.a.createElement(p.b,null,r.a.createElement(v,{id:o,contextId:t,text:i,hostName:u,userName:m,processName:f,processPid:b,processExecutable:y,processTitle:h,workingDirectory:E,args:S,session:c,primary:x,result:g,secondary:k,isDraggable:a}),r.a.createElement(l.EuiSpacer,{size:"s"}),r.a.createElement(d.a,{data:e,isDraggable:a,timelineId:s})):null}));x.displayName="AuditdGenericDetails";const k=r.a.memo((({id:e,contextId:t,hostName:a,userName:n,result:i,primary:s,secondary:o,filePath:d,processName:b,processPid:f,processExecutable:y,processTitle:h,workingDirectory:v,args:x,session:k,text:S,fileIcon:j,isDraggable:O})=>r.a.createElement(l.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none",wrap:!0},r.a.createElement(E,{eventId:e,contextId:t,hostName:a,userName:n,primary:s,secondary:o,workingDirectory:v,session:k,isDraggable:O}),(null!=d||null!=y)&&r.a.createElement(p.c,{grow:!1,component:"span"},S),r.a.createElement(p.c,{grow:!1,component:"span"},r.a.createElement(c.c,{contextId:t,eventId:e,field:"file.path",isDraggable:O,value:d,iconType:j})),null!=y&&r.a.createElement(p.c,{grow:!1,component:"span"},u.kc),r.a.createElement(p.c,{grow:!1,component:"span"},r.a.createElement(m.a,{contextId:t,endgamePid:void 0,endgameProcessName:void 0,eventId:e,isDraggable:O,processPid:f,processName:b,processExecutable:y})),r.a.createElement(g.a,{eventId:e,args:x,contextId:t,isDraggable:O,processTitle:h}),null!=i&&r.a.createElement(p.c,{grow:!1,component:"span"},u.pc),r.a.createElement(p.c,{grow:!1,component:"span"},r.a.createElement(c.c,{contextId:t,eventId:e,field:"auditd.result",isDraggable:O,queryValue:i,value:i})))));k.displayName="AuditdGenericFileLine";const S=r.a.memo((({data:e,contextId:t,text:a,fileIcon:i="document",timelineId:s,isDraggable:o})=>{const c=e._id,u=Object(n.get)("auditd.session[0]",e),m=Object(n.get)("host.name[0]",e),g=Object(n.get)("user.name[0]",e),b=Object(n.get)("auditd.result[0]",e),f=Object(n.get)("process.pid[0]",e),y=Object(n.get)("process.name[0]",e),h=Object(n.get)("process.executable[0]",e),E=Object(n.get)("process.title[0]",e),v=Object(n.get)("process.working_directory[0]",e),x=Object(n.get)("file.path[0]",e),S=Object(n.get)("auditd.summary.actor.primary[0]",e),j=Object(n.get)("auditd.summary.actor.secondary[0]",e),O=Object(n.get)("process.args",e);return null!=e.process?r.a.createElement(p.b,null,r.a.createElement(k,{id:c,contextId:t,text:a,hostName:m,userName:g,filePath:x,processName:y,processPid:f,processExecutable:h,processTitle:E,workingDirectory:v,args:O,session:u,primary:S,secondary:j,fileIcon:i,result:b,isDraggable:o}),r.a.createElement(l.EuiSpacer,{size:"s"}),r.a.createElement(d.a,{data:e,isDraggable:o,timelineId:s})):null}));S.displayName="AuditdGenericFileDetails";const j=({actionName:e,text:t})=>({id:s.d.auditd,isInstance:t=>{const a=Object(n.get)("event.module[0]",t),i=Object(n.get)("event.action[0]",t);return null!=a&&"auditd"===a.toLowerCase()&&null!=i&&i.toLowerCase()===e},renderRow:({data:a,isDraggable:n,scopeId:i})=>r.a.createElement(o.a,null,r.a.createElement(x,{data:a,isDraggable:n,contextId:`${e}-${i}`,text:t,timelineId:i}))}),O=({actionName:e,text:t,fileIcon:a="document"})=>({id:s.d.auditd_file,isInstance:t=>{const a=Object(n.get)("event.module[0]",t),i=Object(n.get)("event.action[0]",t);return null!=a&&"auditd"===a.toLowerCase()&&null!=i&&i.toLowerCase()===e},renderRow:({data:n,isDraggable:i,scopeId:s})=>r.a.createElement(o.a,null,r.a.createElement(S,{contextId:`${e}-${s}`,data:n,fileIcon:a,isDraggable:i,text:t,timelineId:s}))}),w=j({actionName:"was-authorized",text:u.oc}),T=j({actionName:"started-session",text:u.Yb}),I=j({actionName:"logged-in",text:u.m}),C=j({actionName:"login",text:u.m}),M=j({actionName:"executed",text:u.gb}),F=j({actionName:"ended-session",text:u.eb}),D=j({actionName:"acquired-credentials",text:u.e}),A=j({actionName:"disposed-credentials",text:u.db}),_=j({actionName:"connected-to",text:u.T}),N=O({actionName:"opened-file",text:u.Db}),R=j({actionName:"changed-file-attributes-of",text:u.y}),P=O({actionName:"changed-file-permissions-of",text:u.A}),L=O({actionName:"changed-file-ownership-of",text:u.z}),B=j({actionName:"loaded-kernel-module",text:u.ob}),q=j({actionName:"unloaded-kernel-module",text:u.gc}),z=O({actionName:"created-directory",text:u.V,fileIcon:"folderOpen"}),$=O({actionName:"mounted",text:u.Bb}),V=O({actionName:"renamed",text:u.Ob}),U=O({actionName:"checked-metadata-of",text:u.S}),H=O({actionName:"checked-filesystem-metadata-of",text:u.Q}),G=O({actionName:"symlinked",text:u.dc}),Q=O({actionName:"unmounted",text:u.ic}),W=O({actionName:"deleted",text:u.Z}),K=O({actionName:"changed-timestamp-of",text:u.N}),Y=j({actionName:"listen-for-connections",text:u.mb}),J=j({actionName:"bound-socket",text:u.t}),X=j({actionName:"received-from",text:u.Hb}),Z=j({actionName:"sent-to",text:u.Ub}),ee=j({actionName:"killed-pid",text:u.lb}),te=j({actionName:"changed-identity-of",text:u.D}),ae=j({actionName:"changed-system-time",text:u.M}),ne=j({actionName:"make-device",text:u.ub}),ie=j({actionName:"changed-system-name",text:u.L}),re=j({actionName:"allocated-memory",text:u.h}),se=j({actionName:"adjusted-scheduling-policy-of",text:u.Rb}),oe=j({actionName:"added-user-account",text:u.g}),le=j({actionName:"caused-mac-policy-error",text:u.u}),ce=j({actionName:"loaded-firewall-rule-to",text:u.nb}),ue=j({actionName:"changed-promiscuous-mode-on-device",text:u.H}),de=j({actionName:"locked-account",text:u.rb}),pe=j({actionName:"unlocked-account",text:u.hc}),me=j({actionName:"added-group-account-to",text:u.f}),ge=j({actionName:"crashed-program",text:u.U}),be=j({actionName:"attempted-execution-of-forbidden-program",text:u.hb}),fe=j({actionName:"used-suspcious-link",text:u.jc}),ye=j({actionName:"used-suspicious-link",text:u.jc}),he=j({actionName:"failed-log-in-too-many-times-to",text:u.ib}),Ee=j({actionName:"failed-login-too-many-times-to",text:u.ib}),ve=j({actionName:"attempted-log-in-from-unusual-place-to",text:u.o}),xe=j({actionName:"attempted-login-from-unusual-place-to",text:u.o}),ke=j({actionName:"opened-too-many-sessions-to",text:u.Eb}),Se=j({actionName:"attempted-log-in-during-unusual-hour-to",text:u.n}),je=j({actionName:"attempted-login-during-unusual-hour-to",text:u.n}),Oe=j({actionName:"tested-file-system-integrity-of",text:u.ec}),we=j({actionName:"violated-selinux-policy",text:u.nc}),Te=j({actionName:"violated-apparmor-policy",text:u.lc}),Ie=j({actionName:"changed-group",text:u.B}),Ce=j({actionName:"changed-user-id",text:u.P}),Me=j({actionName:"changed-auditd-configuration",text:u.v}),Fe=[M,I,C,w,D,F,A,T,_,N,R,P,L,B,q,z,$,V,U,H,G,Q,W,K,Y,J,X,Z,ee,te,ae,ne,ie,re,se,oe,me,be,le,ue,ge,ce,de,fe,ye,pe,he,Ee,xe,ke,ve,Se,je,Oe,we,Te,Ie,Ce,j({actionName:"changed-audit-configuration",text:u.v}),j({actionName:"refreshed-credentials",text:u.Jb}),j({actionName:"negotiated-crypto-key",text:u.Cb}),j({actionName:"crypto-officer-logged-in",text:u.X}),j({actionName:"crypto-officer-login",text:u.X}),j({actionName:"crypto-officer-logged-out",text:u.Y}),j({actionName:"crypto-officer-logout",text:u.Y}),j({actionName:"started-crypto-session",text:u.ac}),j({actionName:"access-result",text:u.d}),j({actionName:"aborted-auditd-startup",text:u.a}),j({actionName:"aborted-audit-startup",text:u.a}),j({actionName:"remote-audit-connected",text:u.Lb}),j({actionName:"remote-audit-disconnected",text:u.Mb}),j({actionName:"shutdown-audit",text:u.Wb}),j({actionName:"audit-error",text:u.p}),j({actionName:"reconfigured-auditd",text:u.Ib}),j({actionName:"reconfigured-audit",text:u.Ib}),j({actionName:"resumed-audit-logging",text:u.Pb}),j({actionName:"rotated-audit-logs",text:u.Qb}),j({actionName:"started-audit",text:u.Zb}),j({actionName:"deleted-group-account-from",text:u.ab}),j({actionName:"deleted-user-account",text:u.bb}),j({actionName:"changed-audit-feature",text:u.w}),j({actionName:"relabeled-filesystem",text:u.Kb}),j({actionName:"authenticated-to-group",text:u.q}),j({actionName:"changed-group-password",text:u.C}),j({actionName:"modified-group-account",text:u.xb}),j({actionName:"initialized-audit-subsystem",text:u.jb}),j({actionName:"modified-level-of",text:u.yb}),j({actionName:"overrode-label-of",text:u.Fb}),j({actionName:"changed-login-id-to",text:u.E}),j({actionName:"mac-permission",text:u.tb}),j({actionName:"changed-selinux-boolean",text:u.J}),j({actionName:"loaded-selinux-policy",text:u.qb}),j({actionName:"changed-selinux-enforcement",text:u.K}),j({actionName:"assigned-user-role-to",text:u.j}),j({actionName:"modified-role",text:u.zb}),j({actionName:"removed-use-role-from",text:u.Nb}),j({actionName:"removed-user-role-from",text:u.Nb}),Me,j({actionName:"violated-seccomp-policy",text:u.mc}),j({actionName:"started-service",text:u.bc}),j({actionName:"stopped-service",text:u.cc}),j({actionName:"booted-system",text:u.s}),j({actionName:"changed-to-runlevel",text:u.O}),j({actionName:"shutdown-system",text:u.Xb}),j({actionName:"sent-test",text:u.Tb}),j({actionName:"unknown",text:u.fc}),j({actionName:"sent-message",text:u.Sb}),j({actionName:"access-permission",text:u.c}),j({actionName:"authenticated",text:u.r}),j({actionName:"changed-password",text:u.G}),j({actionName:"ran-command",text:u.Gb}),j({actionName:"error",text:u.fb}),j({actionName:"logged-out",text:u.sb}),j({actionName:"logout",text:u.sb}),j({actionName:"changed-mac-configuration",text:u.F}),j({actionName:"loaded-mac-policy",text:u.pb}),j({actionName:"modified-user-account",text:u.Ab}),j({actionName:"changed-role-to",text:u.I}),j({actionName:"access-error",text:u.b}),j({actionName:"changed-configuration",text:u.x}),j({actionName:"issued-vm-control",text:u.kb}),j({actionName:"created-vm-image",text:u.W}),j({actionName:"deleted-vm-image",text:u.cb}),j({actionName:"checked-integrity-of",text:u.R}),j({actionName:"assigned-vm-id",text:u.k}),j({actionName:"migrated-vm-from",text:u.vb}),j({actionName:"migrated-vm-to",text:u.wb}),j({actionName:"assigned-vm-resource",text:u.l})]},function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(4),i=a.n(n),r=a(32),s=a(0),o=a(35),l=a(107);const c=s.i18n.translate("xpack.securitySolution.management.policiesSelector.globalEntries",{defaultMessage:"Global entries"}),u=s.i18n.translate("xpack.securitySolution.management.policiesSelector.unassignedEntries",{defaultMessage:"Unassigned entries"}),d=Object(n.memo)((({policies:e,onChangeSelection:t,defaultExcludedPolicies:a,defaultIncludedPolicies:s})=>{const[d,p]=Object(n.useState)(!1),[m,g]=Object(n.useState)(""),[b,f]=Object(n.useState)([]),y=Object(l.a)("excludePoliciesInFilterEnabled");Object(n.useEffect)((()=>{const t=s?s.split(",").reduce(((e,t)=>({...e,[t]:!0})),{}):{},n=a?a.split(",").reduce(((e,t)=>({...e,[t]:!0})),{}):{},i=e=>t[e]?"on":n[e]?"off":void 0;f([...e.map((e=>({name:e.name,id:e.id,checked:i(e.id)}))),{name:c,id:"global",checked:i("global")},{name:u,id:"unassigned",checked:i("unassigned")}])}),[e]);const h=Object(n.useCallback)((()=>{p((e=>!e))}),[]),E=Object(n.useCallback)((()=>{p(!1)}),[]),v=Object(n.useCallback)((e=>{const t=e.target.value||"";g(t)}),[]),x=Object(n.useCallback)((e=>{if(!b[e])return;const a=[...b];switch(a[e].checked){case"on":a[e].checked=y?"off":void 0;break;case"off":a[e].checked=void 0;break;default:a[e].checked="on"}f(a),t(a)}),[b,t,y]),k=Object(n.useMemo)((()=>b.map(((e,t)=>e.name.toLowerCase().includes(m.toLowerCase())?i.a.createElement(r.EuiFilterSelectItem,{checked:e.checked,key:t,onClick:()=>x(t),"data-test-subj":`policiesSelector-popover-items-${e.id}`},e.name):null))),[b,m,x]),S=Object(n.useMemo)((()=>i.a.createElement(r.EuiFilterButton,{iconType:"arrowDown","data-test-subj":"policiesSelectorButton",onClick:h,isSelected:d,numFilters:b.length,hasActiveFilters:!!b.find((e=>"on"===e.checked)),numActiveFilters:b.filter((e=>"on"===e.checked)).length},i.a.createElement(r.EuiText,null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.management.policiesSelector.label",defaultMessage:"Policies"})))),[d,b,h]);return i.a.createElement(r.EuiFlexGroup,{"data-test-subj":"policiesSelector",direction:"row",alignItems:"center",gutterSize:"l"},i.a.createElement(r.EuiFlexItem,null,i.a.createElement(r.EuiFilterGroup,null,i.a.createElement(r.EuiPopover,{button:S,isOpen:d,closePopover:E,panelPaddingSize:"none"},i.a.createElement(r.EuiPopoverTitle,{paddingSize:"s"},i.a.createElement(r.EuiFieldSearch,{"data-test-subj":"policiesSelectorSearch",compressed:!0,onChange:v,value:m})),i.a.createElement("div",{"data-test-subj":"policiesSelector-popover",className:"euiFilterSelect__items"},k)))))}));d.displayName="PoliciesSelector";var p=a(116);const m=Object(n.memo)((({defaultValue:e="",onSearch:t,placeholder:a,hasPolicyFilter:o,policyList:l,defaultIncludedPolicies:c,hideRefreshButton:u=!1})=>{const{canCreateArtifactsByPolicy:m}=Object(p.a)().endpointPrivileges,[g,b]=Object(n.useState)(e),[f,y]=Object(n.useState)(c||""),h=Object(n.useCallback)((e=>{const a=e.filter((e=>"on"===e.checked)).map((e=>e.id)).join(",");y(a),t(g,a,!1)}),[t,g]),E=Object(n.useCallback)((e=>b(e.target.value)),[b]),v=Object(n.useCallback)((()=>t(g,f,!0)),[t,g,f]),x=Object(n.useCallback)((e=>{t(e,f,!1)}),[t,f]);return i.a.createElement(r.EuiFlexGroup,{"data-test-subj":"searchExceptions",direction:"row",alignItems:"center",gutterSize:"m"},i.a.createElement(r.EuiFlexItem,null,i.a.createElement(r.EuiFieldSearch,{defaultValue:e,placeholder:a,onChange:E,onSearch:x,isClearable:!0,fullWidth:!0,"data-test-subj":"searchField"})),m&&o&&l?i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(d,{policies:l,defaultIncludedPolicies:c,onChangeSelection:h})):null,u?null:i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButton,{iconType:"refresh",onClick:v,"data-test-subj":"searchButton"},s.i18n.translate("xpack.securitySolution.management.search.button",{defaultMessage:"Refresh"}))))}));m.displayName="SearchExceptions"},,function(e,t,a){"use strict";a.d(t,"a",(function(){return y}));var n=a(33),i=a.n(n),r=a(4),s=a.n(r),o=a(167),l=a(377),c=a(592),u=a(100),d=a(371),p=a(493),m=a(0);const g={interval:{label:m.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldIntervalLabel",{defaultMessage:"Runs every"}),helpText:m.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldIntervalHelpText",{defaultMessage:"Rules run periodically and detect alerts within the specified time frame."})},from:{label:m.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldAdditionalLookBackLabel",{defaultMessage:"Additional look-back time"}),helpText:m.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldAdditionalLookBackHelpText",{defaultMessage:"Adds time to the look-back period to prevent missed alerts."})}},b=i()(u.c).withConfig({displayName:"StyledForm",componentId:"sc-9ljx3m-0"})(["max-width:235px !important;"]),f=({addPadding:e=!1,defaultValues:t,descriptionColumns:a="singleSplit",isReadOnlyView:n,isLoading:i,isUpdateView:m=!1,onSubmit:f,setForm:y,onRuleDataChange:h})=>{const{form:E}=Object(u.k)({defaultValue:t,options:{stripEmptyFields:!1},schema:g}),{getFormData:v,submit:x}=E;Object(u.m)({form:E,watch:["from","interval"],onChange:e=>{h&&h(e)}});const k=Object(r.useCallback)((()=>{f&&f()}),[f]),S=Object(r.useCallback)((async()=>{const e=await x();return null!=e&&e.isValid?e:{isValid:!1,data:v()}}),[v,x]);return Object(r.useEffect)((()=>{let e=!1;return y&&!e&&y(o.b.scheduleRule,S),()=>{e=!0}}),[S,y]),n?s.a.createElement(d.a,{addPadding:e},s.a.createElement(l.a,{columns:a,schema:g,data:t})):s.a.createElement(s.a.Fragment,null,s.a.createElement(d.a,{addPadding:!m},s.a.createElement(b,{form:E,"data-test-subj":"stepScheduleRule"},s.a.createElement(u.e,{path:"interval",component:c.a,componentProps:{idAria:"detectionEngineStepScheduleRuleInterval",isDisabled:i,dataTestSubj:"detectionEngineStepScheduleRuleInterval",minimumValue:1}}),s.a.createElement(u.e,{path:"from",component:c.a,componentProps:{idAria:"detectionEngineStepScheduleRuleFrom",isDisabled:i,dataTestSubj:"detectionEngineStepScheduleRuleFrom",minimumValue:1}}))),!m&&s.a.createElement(p.a,{dataTestSubj:"schedule-continue",onClick:k,isDisabled:i}))},y=Object(r.memo)(f)},function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(4),i=a.n(n),r=a(32),s=a(540),o=a(165),l=a(0),c=a(35),u=a(544);const d={type:"primary",id:"need-admin-for-update-rules",title:l.i18n.translate("xpack.securitySolution.detectionEngine.needAdminForUpdateCallOutBody.messageTitle",{defaultMessage:"Administration permissions required for alert migration"}),description:i.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.needAdminForUpdateCallOutBody.messageBody.messageDetail",defaultMessage:"{essence} Related documentation: {docs}",values:{essence:i.a.createElement("p",null,i.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.needAdminForUpdateCallOutBody.messageBody.essenceDescription",defaultMessage:"You are currently missing the required permissions to auto migrate your alert data. Please have your administrator visit this page one time to auto migrate your alert data."})),docs:i.a.createElement("ul",null,i.a.createElement("li",null,i.a.createElement(u.a,null)),i.a.createElement("li",null,i.a.createElement(u.c,null)))}})},p=()=>{const[{signalIndexMappingOutdated:e,hasIndexManage:t}]=Object(o.b)();return null!=e&&e&&null!=t&&!t?i.a.createElement(i.a.Fragment,null,i.a.createElement(s.b,{condition:!0,message:d}),i.a.createElement(r.EuiSpacer,{size:"l"})):null},m=Object(n.memo)(p)},function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var n=a(4),i=a(131),r=a(238),s=a(39),o=a(1),l=a(138);const c=["POST",o.nb];var u=a(496),d=a(682);function p(){const{mutateAsync:e}=Object(s.useMutation)((e=>Object(l.b)(e)),{mutationKey:c});const t=Object(u.a)(),a=Object(d.a)(),o=Object(r.c)(),p=null==o?void 0:o.actions.setLoadingRules;return{bulkExport:Object(n.useCallback)((async n=>{try{var r;return null==p||p({ids:null!==(r=n.ids)&&void 0!==r?r:a(i.b.export),action:i.b.export}),await e(n)}catch(e){t({actionType:i.b.export,error:e})}finally{null==p||p({ids:[],action:null})}}),[a,p,e,t])}}},function(e,t,a){"use strict";a.d(t,"b",(function(){return D})),a.d(t,"a",(function(){return A}));var n=a(4),i=a.n(n),r=a(32),s=a(33),o=a.n(s),l=a(78),c=a(99),u=a(77),d=a(0);const p=d.i18n.translate("xpack.securitySolution.timeline.graphOverlay.closeAnalyzerButton",{defaultMessage:"Close analyzer"}),m=d.i18n.translate("xpack.securitySolution.timeline.graphOverlay.closeSessionButton",{defaultMessage:"Close session viewer"});var g=a(79),b=a(870),f=a(95),y=a(539),h=a(1),E=a(340),v=a(557),x=a(148),k=a(614),S=a(116),j=a(86),O=a(112),w=a(81),T=a(155),I=a(180);const C=o()(r.EuiButtonIcon).withConfig({displayName:"FullScreenButtonIcon",componentId:"sc-2qihun-0"})(["margin:4px 0 4px 0;"]),M=({fullScreen:e,globalFullScreen:t,onCloseOverlay:a,isActiveTimelines:n,timelineFullScreen:s,toggleFullScreen:o,graphEventId:l,activeTab:c})=>i.a.createElement(r.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButtonEmpty,{iconType:"cross",onClick:a,size:"xs"},n?c===g.m.graph?p:m:l?p:m)),!1===n&&i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiToolTip,{content:e?v.a:E.d},i.a.createElement(C,{"aria-label":Object(y.b)({globalFullScreen:t,isActiveTimelines:n,timelineFullScreen:s})?v.a:E.d,className:e?h.Gb:"",color:e?"ghost":"primary","data-test-subj":"full-screen",iconType:"fullScreen",onClick:o}))));M.displayName="NavigationComponent";const F=i.a.memo(M),D=({scopeId:e})=>{const t=Object(l.useDispatch)(),a=Object(n.useMemo)((()=>Object(c.isTimelineScope)(e)?j.b.getTimelineByIdSelector():Object(c.isInTableScope)(e)?T.b.getTableByIdSelector():void 0),[e]),{globalFullScreen:r,setGlobalFullScreen:s}=Object(x.a)(),{timelineFullScreen:o,setTimelineFullScreen:u}=Object(x.c)(),d=Object(c.isTimelineScope)(e)?O.b:I.a,{graphEventId:p,sessionViewConfig:m,activeTab:b,prevActiveTab:f}=Object(w.a)((t=>{var n;return{activeTab:O.b.activeTab,prevActiveTab:O.b.prevActiveTab,...null!==(n=a&&a(t,e))&&void 0!==n?n:d}})),E=Object(c.getScopedActions)(e),v=Object(n.useCallback)((()=>{null!==document.querySelector(".euiDataGrid--fullScreen")?Object(c.isActiveTimeline)(e)?document.body.classList.add("euiDataGrid__restrictBody"):document.body.classList.add(h.oc,"euiDataGrid__restrictBody"):Object(c.isActiveTimeline)(e)?u(!1):s(!1),!1===Object(c.isActiveTimeline)(e)?E&&(t(E.updateGraphEventId({id:e,graphEventId:""})),t(E.updateSessionViewConfig({id:e,sessionViewConfig:null}))):b===g.m.graph?(E&&t(E.updateGraphEventId({id:e,graphEventId:""})),f!==g.m.session||m||t(j.a.setActiveTabTimeline({id:e,activeTab:g.m.query}))):b===g.m.session&&(Object(c.isTimelineScope)(e)&&(f!==g.m.graph||p?t(j.a.setActiveTabTimeline({id:e,activeTab:f})):t(j.a.setActiveTabTimeline({id:e,activeTab:g.m.query}))),E&&t(E.updateSessionViewConfig({id:e,sessionViewConfig:null})))}),[u,s,E,t,e,b,f,m,p]),k=Object(n.useMemo)((()=>Object(y.b)({globalFullScreen:r,isActiveTimelines:Object(c.isActiveTimeline)(e),timelineFullScreen:o})),[r,e,o]),S=Object(n.useCallback)((()=>{Object(c.isActiveTimeline)(e)?u(!o):s(!r)}),[e,u,o,s,r]),C=Object(n.useMemo)((()=>i.a.createElement(F,{fullScreen:k,globalFullScreen:r,activeTab:b,onCloseOverlay:v,isActiveTimelines:Object(c.isActiveTimeline)(e),timelineFullScreen:o,toggleFullScreen:S,graphEventId:p})),[k,r,b,v,e,o,S,p]);return{onCloseOverlay:v,Navigation:C}},A=({scopeId:e,entityType:t,height:a})=>{const{sessionView:i}=Object(u.k)().services,r=Object(n.useMemo)((()=>Object(c.isTimelineScope)(e)?j.b.getTimelineByIdSelector():Object(c.isInTableScope)(e)?T.b.getTableByIdSelector():void 0),[e]),{globalFullScreen:s}=Object(x.a)(),{timelineFullScreen:o}=Object(x.c)(),{canAccessEndpointManagement:l}=Object(S.a)().endpointPrivileges,d=Object(c.isTimelineScope)(e)?O.b:I.a,{sessionViewConfig:p,activeTab:m}=Object(w.a)((t=>{var a;return{activeTab:O.b.activeTab,prevActiveTab:O.b.prevActiveTab,...null!==(a=r&&r(t,e))&&void 0!==a?a:d}})),h=Object(n.useMemo)((()=>Object(y.b)({globalFullScreen:s,isActiveTimelines:Object(c.isActiveTimeline)(e),timelineFullScreen:o})),[s,e,o]),E=Object(n.useMemo)((()=>Object(c.isActiveTimeline)(e)?f.SourcererScopeName.timeline:k.a.includes(e)?f.SourcererScopeName.detections:f.SourcererScopeName.default),[e]),{openEventDetailsPanel:v,shouldShowDetailsPanel:C,DetailsPanel:M}=Object(b.a)({isFlyoutView:!Object(c.isActiveTimeline)(e),entityType:t,sourcererScope:E,scopeId:e,tabType:Object(c.isActiveTimeline)(e)?m:g.m.query}),F=Object(n.useMemo)((()=>{const e=a?a-118:void 0;return null!==p?i.getSessionView({...p,loadAlertDetails:v,isFullScreen:h,height:e,canAccessEndpointManagement:l}):null}),[a,p,i,v,h,l]);return{openEventDetailsPanel:v,shouldShowDetailsPanel:C,SessionView:F,DetailsPanel:M}}},function(e,t,a){"use strict";a.d(t,"b",(function(){return O})),a.d(t,"a",(function(){return I}));var n=a(34),i=a(32),r=a(35),s=a(4),o=a.n(s),l=a(33),c=a.n(l),u=a(78),d=a(87),p=a(398),m=a(86),g=a(302),b=a(0);const f=b.i18n.translate("xpack.securitySolution.timeline.toggleEventDetailsTitle",{defaultMessage:"Expand event details"}),y=b.i18n.translate("xpack.securitySolution.timeline.addedANoteLabel",{defaultMessage:"added a note"}),h=b.i18n.translate("xpack.securitySolution.timeline.addedADescriptionLabel",{defaultMessage:"added description"}),E=b.i18n.translate("xpack.securitySolution.timeline.anUnknownUserLabel",{defaultMessage:"an unknown user"});var v=a(79),x=a(81),k=a(701),S=a(95),j=a(94);const O=c.a.section.withConfig({displayName:"NotePreviewsContainer",componentId:"sc-1g73res-0"})(["padding-top:",";"],(({theme:e})=>`${e.eui.euiSizeS}`));O.displayName="NotePreviewsContainer";const w=({eventId:e,timelineId:t})=>{const a=Object(u.useDispatch)(),{selectedPatterns:n}=Object(j.d)(S.SourcererScopeName.timeline),r=Object(s.useCallback)((()=>{a(m.a.toggleDetailPanel({panelView:"eventDetail",tabType:v.m.notes,id:t,params:{eventId:e,indexName:n.join(",")}}))}),[a,e,n,t]);return o.a.createElement(i.EuiButtonIcon,{title:f,"aria-label":f,color:"text",iconType:"arrowRight",onClick:r})},T=o.a.memo(w),I=o.a.memo((({eventIdToNoteIds:e,notes:t,timelineId:a,showTimelineDescription:l})=>{const c=Object(s.useMemo)((()=>m.b.getTimelineByIdSelector()),[]),u=Object(x.a)((e=>a?c(e,a):null)),b=Object(s.useMemo)((()=>l&&a&&null!=u&&u.description?[{username:Object(d.a)(u.updatedBy),event:h,"data-test-subj":"note-preview-description",id:"note-preview-description",timestamp:u.updated?o.a.createElement(r.FormattedRelative,{"data-test-subj":"updated",value:new Date(u.updated)}):Object(d.e)(),children:o.a.createElement(i.EuiText,{size:"s"},u.description),timelineAvatar:o.a.createElement(i.EuiAvatar,{"data-test-subj":"avatar",name:null!=u.updatedBy?u.updatedBy:"?",size:"l"}),actions:o.a.createElement(k.a,{timelineId:a,initialFocus:"description"})}]:[]),[u,a,l]),f=Object(s.useMemo)((()=>Object(n.uniqBy)("savedObjectId",t).map((t=>{var n,s,l;const c=null!=e?Object.entries(e).reduce(((e,[a,n])=>{var i;return n.includes(null!==(i=t.noteId)&&void 0!==i?i:"")?a:e}),null):null!==(n=t.eventId)&&void 0!==n?n:null;return{"data-test-subj":`note-preview-${t.savedObjectId}`,username:Object(d.a)(t.updatedBy),event:y,timestamp:t.updated?o.a.createElement(r.FormattedRelative,{"data-test-subj":"updated",value:new Date(t.updated)}):Object(d.e)(),children:o.a.createElement("div",{className:g.a,tabIndex:0},o.a.createElement(i.EuiScreenReaderOnly,{"data-test-subj":"screenReaderOnlyUserAddedANote"},o.a.createElement("p",null,`${null!==(s=t.updatedBy)&&void 0!==s?s:E} ${y}`)),o.a.createElement(p.b,null,null!==(l=t.note)&&void 0!==l?l:"")),actions:c&&a?o.a.createElement(T,{eventId:c,timelineId:a}):null,timelineAvatar:o.a.createElement(i.EuiAvatar,{"data-test-subj":"avatar",name:null!=t.updatedBy?t.updatedBy:"?",size:"l"})}}))),[e,t,a]);return o.a.createElement(i.EuiCommentList,{"data-test-subj":"note-comment-list",comments:[...b,...f]})}));I.displayName="NotePreviews"},function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));var n=a(4),i=a.n(n),r=a(32),s=a(133),o=a(106),l=a(150),c=a(102);const u=({idPrefix:e,entityName:t,entityValue:a})=>{const r=Object(c.h)(`entity-draggable-${e}-${t}-${a}`),u=Object(n.useMemo)((()=>({and:[],enabled:!0,id:r,name:a,excluded:!1,kqlQuery:"",queryMatch:{field:t,value:a,operator:o.d}})),[t,a,r]),d=Object(n.useCallback)(((e,n,r)=>r.isDragging?i.a.createElement(s.a,null,i.a.createElement(l.a,{dataProvider:e})):i.a.createElement(i.a.Fragment,null,`${t}: "${a}"`)),[t,a]);return i.a.createElement(s.b,{key:r,dataProvider:u,render:d,isAggregatable:!0,fieldType:"keyword"})};u.displayName="EntityDraggableComponent";const d=i.a.memo(u);d.displayName="EntityDraggable";var p=a(533),m=a(288),g=a(388),b=a(627),f=a(629),y=a(101);const h=(e,t)=>[{name:m.b,field:"anomaly.jobId",sortable:!0,render:(a,n)=>i.a.createElement(f.a,{score:n.anomaly,startDate:e,endDate:t,linkName:a})},{name:m.n,field:"anomaly.severity",sortable:!0,render:(e,t)=>i.a.createElement(b.a,{id:Object(c.h)(`anomalies-table-severity-${Object(p.a)(t.anomaly)}`),score:t.anomaly})},{name:m.c,field:"anomaly.entityValue",sortable:!0,render:(e,t)=>i.a.createElement(d,{idPrefix:`anomalies-table-entityValue${Object(p.a)(t.anomaly)}-entity`,entityName:t.anomaly.entityName,entityValue:e})},{name:m.e,field:"anomaly.influencers",render:(e,t)=>i.a.createElement(r.EuiFlexGroup,{direction:"column",gutterSize:"none",responsive:!1},e&&e.map((e=>{const[a,n]=Object(g.a)(e),s=null!=a?a:"",o=null!=n?n:"";return i.a.createElement(r.EuiFlexItem,{key:`${s}-${o}-${Object(p.a)(t.anomaly)}`,grow:!1},i.a.createElement(r.EuiFlexGroup,{gutterSize:"none",responsive:!1},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(d,{idPrefix:`anomalies-table-influencers-${s}-${o}-${Object(p.a)(t.anomaly)}`,entityName:s,entityValue:o}))))})))},{name:m.p,field:"anomaly.time",sortable:!0,render:e=>i.a.createElement(y.b,{value:e})}]},,,,,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var n=a(32),i=a(4),r=a.n(i),s=a(49),o=a(33),l=a.n(o),c=a(297),u=a(424),d=a(558);const p={chartMargins:{top:0,bottom:0,left:0,right:0},partition:{idealFontSizeJump:1.1,outerSizeRatio:1,emptySizeRatio:.8,circlePadding:4}},m=l()(n.EuiFlexGroup).withConfig({displayName:"DonutTextWrapper",componentId:"sc-1oomqeq-0"})(["top:34%;width:100%;max-width:77px;position:absolute;z-index:1;"]),g=l()(n.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-1oomqeq-1"})(["position:relative;align-items:center;"]),b=({data:e,fillColor:t,height:a=90,label:o,legendItems:l,title:b,totalCount:f})=>{const y=Object(c.i)(),{euiTheme:h}=Object(n.useEuiTheme)(),E=Object(i.useMemo)((()=>({color:h.colors.disabled})),[h.colors.disabled]);return r.a.createElement(n.EuiFlexGroup,{alignItems:"center",justifyContent:"center",responsive:!1,gutterSize:"l","data-test-subj":"donut-chart"},r.a.createElement(g,{grow:!1},r.a.createElement(m,{direction:"column",gutterSize:"none",alignItems:"center",justifyContent:"center"},r.a.createElement(n.EuiFlexItem,null,b),r.a.createElement(n.EuiFlexItem,{className:"eui-textTruncate"},r.a.createElement(n.EuiToolTip,{content:o},r.a.createElement(n.EuiText,{className:"eui-textTruncate",size:"s",style:e?void 0:E},o)))),null==e||null==f||0===f?r.a.createElement(d.a,{size:a}):r.a.createElement(s.Chart,{size:a},r.a.createElement(s.Settings,{theme:p,baseTheme:y}),r.a.createElement(s.Partition,{id:"donut-chart",data:e,layout:s.PartitionLayout.sunburst,valueAccessor:e=>e.value,valueFormatter:e=>`${Object(s.defaultPartitionValueFormatter)(e)}`,layers:[{groupByRollup:e=>{var t;return null!==(t=e.label)&&void 0!==t?t:e.key},nodeLabel:e=>e,shape:{fillColor:t}}]}))),l&&(null==l?void 0:l.length)>0&&r.a.createElement(n.EuiFlexItem,null,r.a.createElement(u.a,{legendItems:l,height:a})))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(0);const i=e=>e?n.i18n.translate("xpack.securitySolution.toggleQuery.on",{defaultMessage:"Open"}):n.i18n.translate("xpack.securitySolution.toggleQuery.off",{defaultMessage:"Closed"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(4),i=a.n(n),r=a(32),s=a(79),o=a(121),l=a(227);const c=({timelineType:e,elasticTemplateTimelineCount:t,customTemplateTimelineCount:a})=>{const[c,u]=Object(n.useState)(null),d=Object(n.useMemo)((()=>e===s.n.template),[e]),p=Object(n.useMemo)((()=>d?c:null),[c,d]),m=Object(n.useMemo)((()=>null==p?null:p===s.h.elastic?s.l.immutable:s.l.active),[p]),g=Object(n.useMemo)((()=>[{id:s.h.elastic,name:o.q,disabled:!d,withNext:!0,count:null!=t?t:void 0},{id:s.h.custom,name:o.p,disabled:!d,withNext:!1,count:null!=a?a:void 0}]),[a,t,d]),b=Object(n.useCallback)((e=>{u(c===e?null:e)}),[u,c]),f=Object(n.useMemo)((()=>d?g.map((e=>i.a.createElement(r.EuiFilterButton,{hasActiveFilters:e.id===p,key:`template-timeline-filter-${e.id}`,numFilters:e.count,onClick:b.bind(null,e.id),withNext:e.withNext,isDisabled:e.disabled,"data-test-subj":e.name},e.name))):null),[p,g,d,b]),y=Object(n.useCallback)((async()=>{p!==s.h.custom&&await Object(l.f)()}),[p]);return{timelineStatus:m,templateTimelineType:p,templateTimelineFilter:f,installPrepackagedTimelines:y}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(4),i=a.n(n),r=a(79),s=a(210);const o=({closeGearMenu:e,outline:t,title:a,timelineId:n=r.j.active})=>{const{getButton:i}=Object(s.b)({timelineId:n,timelineType:r.n.template,closeGearMenu:e});return i({outline:t,title:a})},l=i.a.memo(o);l.displayName="NewTemplateTimeline"},function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"g",(function(){return l})),a.d(t,"e",(function(){return c})),a.d(t,"c",(function(){return u})),a.d(t,"b",(function(){return d})),a.d(t,"d",(function(){return p})),a.d(t,"f",(function(){return m}));var n=a(108),i=a(79),r=a(932),s=a(527);const o=()=>Object(n.createSelector)(s.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.activeTab)&&void 0!==t?t:i.m.query})),l=()=>Object(n.createSelector)(s.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.show)&&void 0!==t&&t})),c=()=>Object(n.createSelector)(s.selectTimeline,(e=>{var t;return Object.keys(null!==(t=null==e?void 0:e.pinnedEventIds)&&void 0!==t?t:{}).length})),u=()=>Object(n.createSelector)(s.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.noteIds)&&void 0!==t?t:[]})),d=()=>Object(n.createSelector)(s.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.eventIdToNoteIds)&&void 0!==t?t:{}})),p=()=>Object(n.createSelector)(r.selectNotesById,(e=>Object.values(e))),m=()=>Object(n.createSelector)(s.selectTimeline,(e=>null==e?void 0:e.scrollToTop))},function(e,t,a){"use strict";a.d(t,"a",(function(){return C}));var n=a(82),i=a.n(n),r=a(49),s=a(44),o=a.n(s),l=a(4),c=a.n(l),u=a(33),d=a.n(u),p=a(32),m=a(42),g=a(1),b=a(619),f=a(382),y=a(326),h=a(146),E=a(77),v=a(225),x=a(134),k=a(273),S=a(2),j=a(128),O=a(233);const w=e=>({text:e,value:e}),T=d()(p.EuiButton).withConfig({displayName:"StyledLinkButton",componentId:"sc-18xuh7o-0"})(["margin-left:0;@media only screen and (min-width:","){margin-left:",";}"],(e=>e.theme.eui.euiBreakpoints.m),(({theme:e})=>e.eui.euiSizeL)),I=({combinedQueries:e,deleteQuery:t,filters:a,from:n,headerChildren:s,indexPattern:u,indexNames:d,runtimeMappings:p,onlyField:I,paddingSize:C,query:M,queryType:F,setAbsoluteRangeDatePickerTarget:D,setQuery:A,showLegend:_,showSpacer:N=!0,scopeId:R,to:P,toggleTopN:L})=>{const B=Object(l.useMemo)((()=>`eventsByDatasetOverview-${F}`),[F]);Object(l.useEffect)((()=>()=>{t&&t({id:B})}),[t,B]);const q=Object(E.k)(),{formatUrl:z,search:$}=Object(j.n)(S.a.hosts),{navigateToApp:V}=q.services.application,[U]=Object(E.q)(g.Z),H=Object(l.useCallback)((e=>{e.preventDefault(),V(g.B,{deepLinkId:S.a.hosts,path:Object(f.c)(x.HostsTableType.events,$)})}),[V,$]),G=Object(l.useMemo)((()=>c.a.createElement(T,{onClick:H,href:z(Object(f.c)(x.HostsTableType.events))},k.l)),[H,z]),[Q,W]=Object(l.useMemo)((()=>null==e?Object(h.c)({config:Object(m.getEsQueryConfig)(q.services.uiSettings),indexPattern:u,queries:[M],filters:a}):[e]),[e,q,u,M,a]);Object(O.a)({id:B,filterQuery:Q,kqlError:W,query:M,startDate:n,endDate:P});const K=Object(l.useMemo)((()=>{var e;return{...v.b,stackByOptions:null!=I?[w(I)]:v.b.stackByOptions,defaultStackByOption:null!=I?w(I):null!==(e=v.c.find((e=>"event.dataset"===e.text)))&&void 0!==e?e:v.c[0],legendPosition:r.Position.Right,subtitle:e=>`${b.b}: ${o()(e).format(U)} ${Object(b.c)(e)}`,titleSize:null==I?"m":"s"}}),[I,U]),Y=Object(l.useMemo)((()=>null==I||null!=s?c.a.createElement(c.a.Fragment,null,s,null==I&&G):null),[I,s,G]);return c.a.createElement(y.a,i()({endDate:P,filterQuery:Q,headerChildren:Y,id:B,indexNames:d,runtimeMappings:p,onError:L,paddingSize:C,setAbsoluteRangeDatePickerTarget:D,setQuery:A,showSpacer:N,showLegend:_,skip:void 0===Q,startDate:n,scopeId:R},K,{title:null!=I?k.j(I):K.title}))};I.displayName="EventsByDatasetComponent";const C=c.a.memo(I)},function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(4),i=a.n(n),r=a(32),s=a(33),o=a.n(s),l=a(297),c=a(303);const u=o()(r.EuiFlexGroup).withConfig({displayName:"FlexGroup",componentId:"sc-k2lbwg-0"})(["height:",";width:",";position:relative;margin:0;"],(({height:e})=>e||"100%"),(({width:e})=>e||"100%"));u.displayName="FlexGroup";const d=({height:e="100%",width:t="100%",data:a})=>i.a.createElement(u,{justifyContent:"center",alignItems:"center",height:e,width:t},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiText,{size:"s",textAlign:"center",color:"subdued","data-test-subj":"chartHolderText"},Object(l.f)(a)?c.a:c.b)))},function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var n=a(4),i=a(1),r=a(134),s=a(272),o=a(94),l=a(81),c=a(98),u=a(183),d=a(304);const p=({lensAttributes:e,getLensAttributes:t,stackByField:a,title:p})=>{const{selectedPatterns:m,dataViewId:g}=Object(o.d)(),b=Object(n.useMemo)((()=>c.d.globalQuerySelector()),[]),f=Object(n.useMemo)((()=>c.d.globalFiltersQuerySelector()),[]),y=Object(l.a)(b),h=Object(l.a)(f),[{detailName:E,pageName:v,tabName:x}]=Object(u.a)(),k=Object(n.useMemo)((()=>v===i.uc.hosts&&x===r.HostsTableType.events?d.e:v===i.uc.network&&x===s.a.events?d.f:[]),[v,x]),S=Object(n.useMemo)((()=>v===i.uc.hosts&&null!=E?Object(d.a)(E):[]),[E,v]),j=Object(n.useMemo)((()=>Object(d.b)(m)),[m]);return Object(n.useMemo)((()=>{if(null==e&&(null==t||null==a))return null;const n=null!=e?e:t&&a&&t(a);return{...n,...null!=p?{title:p}:{},state:{...n.state,query:y,filters:[...n.state.filters,...h,...S,...k,...j]},references:n.references.map((e=>({...e,id:g})))}}),[e,t,a,p,y,h,S,k,j,g])}},function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(4),i=a(8),r=a(77),s=a(194);const o=({onAddToCaseClicked:e,lensAttributes:t,timeRange:a})=>{const o=Object(r.i)(),{cases:l}=Object(r.k)().services,c=Object(n.useMemo)((()=>[{comment:`!{lens${JSON.stringify({timeRange:a,attributes:t})}}`,type:i.CommentType.user}]),[t,a]),u=l.hooks.getUseCasesAddToExistingCaseModal({onClose:e,toastContent:s.a});return{onAddToExistingCaseClicked:Object(n.useCallback)((()=>{e&&e(),u.open({attachments:c})}),[c,e,u]),disabled:null==t||null==a||!o.create||!o.read}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(4),i=a(8),r=a(77),s=a(194);const o=({onClick:e,timeRange:t,lensAttributes:a})=>{const o=Object(r.i)(),{cases:l}=Object(r.k)().services,c=Object(n.useMemo)((()=>[{comment:`!{lens${JSON.stringify({timeRange:t,attributes:a})}}`,type:i.CommentType.user}]),[a,t]),u=l.hooks.getUseCasesAddToNewCaseFlyout({toastContent:s.a});return{onAddToNewCaseClicked:Object(n.useCallback)((()=>{e&&e(),u.open({attachments:c})}),[c,u,e]),disabled:null==a||null==t||!o.create||!o.read}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(4),i=a.n(n),r=a(33),s=a.n(r),o=a(234);const l=s.a.div.withConfig({displayName:"PlaceHolder",componentId:"sc-u1bwbv-0"})(["padding:",";"],(e=>e.theme.eui.euiSizeS)),c=({count:e})=>null!=e?i.a.createElement("b",null,i.a.createElement(o.a,{count:e})):i.a.createElement(l,null);c.displayName="ChartLabelComponent";const u=i.a.memo(c)},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(4),i=a(287);const r=Object(i.c)(),s=()=>{const[e]=Object(n.useState)(r);return{globalKQLHeaderPortalNode:e}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(4),i=a.n(n),r=a(32),s=a(33),o=a.n(s),l=a(88),c=a(203);const u=o.a.h1.withConfig({displayName:"Header",componentId:"sc-1tun0gt-0"})(["display:grid;grid-gap:12px;grid-template-columns:auto auto;align-items:center;justify-items:start;justify-content:start;"]);u.displayName="Header";const d=o.a.span.withConfig({displayName:"TitleWrapper",componentId:"sc-1tun0gt-1"})(["min-width:0;max-width:100%;"]);d.displayName="TitleWrapper";const p=({draggableArguments:e,title:t,badgeOptions:a})=>i.a.createElement(r.EuiTitle,{size:"l"},i.a.createElement(u,{"data-test-subj":"header-page-title"},e?i.a.createElement(l.b,{"data-test-subj":"header-page-draggable",id:`header-page-draggable-${e.field}-${e.value}`,field:e.field,value:`${e.value}`}):i.a.createElement(d,null,i.a.createElement(c.b,{tooltipContent:t},t)),a&&i.a.createElement(i.a.Fragment,null,a.beta?i.a.createElement(r.EuiBetaBadge,{label:a.text,tooltipContent:a.tooltip,tooltipPosition:"bottom",size:a.size}):i.a.createElement(r.EuiBadge,{color:a.color||"hollow",title:""},a.text)))),m=i.a.memo(p)},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=a(0).i18n.translate("xpack.securitySolution.components.ml.anomaly.errors.anomaliesTableFetchFailureTitle",{defaultMessage:"Anomalies table fetch failure"})},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(4),i=a(1),r=a(77);const s=({defaultValue:e,key:t,plugin:a=i.p,isInvalidDefault:s})=>{const{storage:o}=Object(r.k)().services,[l,c]=Object(n.useState)(!1),[u,d]=Object(n.useState)(e),p=Object(n.useCallback)((()=>{const n=o.get(`${a}.${t}`),i=typeof n!=typeof e,r=null!=s&&s(n);d(i||r?e:n)}),[e,s,t,a,o]),m=Object(n.useCallback)((e=>{o.set(`${a}.${t}`,e),d(e)}),[t,a,o]);return Object(n.useEffect)((()=>{l||(p(),c(!0))}),[l,p]),[u,m]}},function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var n=a(4),i=a.n(n),r=a(78),s=a(99),o=a(86),l=a(94),c=a(228),u=a(79),d=a(112),p=a(81),m=a(504),g=a(155);const b=({entityType:e,isFlyoutView:t,sourcererScope:a,scopeId:b,tabType:f=u.m.query})=>{const{browserFields:y,selectedPatterns:h,runtimeMappings:E}=Object(l.d)(a),v=Object(r.useDispatch)(),x=Object(n.useMemo)((()=>Object(s.isTimelineScope)(b)?o.b.getTimelineByIdSelector():Object(s.isInTableScope)(b)?g.b.getTableByIdSelector():void 0),[b]),k=Object(n.useMemo)((()=>h.join(",")),[h]),S=Object(p.a)((e=>{var t,a;return null===(t=null!==(a=x&&x(e,b))&&void 0!==a?a:d.b)||void 0===t?void 0:t.expandedDetail})),j=Object(n.useRef)((()=>{})),O=()=>{},w=Object(n.useMemo)((()=>{var e;return!!(f&&S&&S[f]&&null!==(e=S[f])&&void 0!==e&&e.panelView)}),[S,f]),T=Object(s.getScopedActions)(b),I=Object(n.useCallback)((e=>{e&&T&&v(T.toggleDetailPanel({...e,tabType:f,id:b}))}),[T,b,v,f]),C=Object(n.useCallback)(((e,t)=>{e&&I({panelView:"eventDetail",params:{eventId:e,indexName:k}}),j.current=null!=t?t:O}),[I,k]),M=Object(n.useCallback)(((e,t)=>{I({panelView:"hostDetail",params:{hostName:e}}),j.current=null!=t?t:O}),[I]),F=Object(n.useCallback)(((e,t,a)=>{I({panelView:"networkDetail",params:{ip:e,flowTarget:t}}),j.current=null!=a?a:O}),[I]),D=Object(n.useCallback)(((e,t)=>{I({panelView:"userDetail",params:{userName:e}}),j.current=null!=t?t:O}),[I]),A=Object(n.useCallback)((()=>{var e;j.current&&j.current(),T&&v(T.toggleDetailPanel({tabType:f,id:b})),f&&null!==(e=S[f])&&void 0!==e&&e.panelView&&b===u.j.active&&w&&c.a.toggleExpandedDetail({})}),[T,f,S,b,w,v]),_=Object(n.useMemo)((()=>w?i.a.createElement(m.a,{browserFields:y,entityType:e,handleOnPanelClosed:A,isFlyoutView:t,runtimeMappings:E,tabType:f,scopeId:b}):null),[y,e,A,t,E,w,f,b]);return{openEventDetailsPanel:C,openHostDetailsPanel:M,openNetworkDetailsPanel:F,openUserDetailsPanel:D,handleOnDetailsPanelClosed:A,shouldShowDetailsPanel:w,DetailsPanel:_}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(695);const i=e=>{var t;const a=null!=e&&e.fields?null==e?void 0:e.fields["kibana.alert.rule.parameters"]:null,i=a?null===(t=a[0])||void 0===t?void 0:t.threat:null;return i&&i.length>0?Object(n.j)({label:i[0].framework,threat:i}):null}},function(e,t,a){"use strict";a.d(t,"d",(function(){return i})),a.d(t,"b",(function(){return r})),a.d(t,"f",(function(){return s})),a.d(t,"a",(function(){return o})),a.d(t,"e",(function(){return l})),a.d(t,"c",(function(){return c}));var n=a(0);const i=n.i18n.translate("xpack.securitySolution.riskScore.technicalPreviewLabel",{defaultMessage:"Technical Preview"}),r=n.i18n.translate("xpack.securitySolution.riskScore.hostsDashboardWarningPanelTitle",{defaultMessage:"No host risk score data available to display"}),s=n.i18n.translate("xpack.securitySolution.riskScore.usersDashboardWarningPanelTitle",{defaultMessage:"No user risk score data available to display"}),o=n.i18n.translate("xpack.securitySolution.riskScore.hostsDashboardWarningPanelBody",{defaultMessage:"We haven't detected any host risk score data from the hosts in your environment. The data might need an hour to be generated after enabling the module."}),l=n.i18n.translate("xpack.securitySolution.riskScore.usersDashboardWarningPanelBody",{defaultMessage:"We haven't detected any user risk score data from the users in your environment. The data might need an hour to be generated after enabling the module."}),c=n.i18n.translate("xpack.securitySolution.riskScore.usersDashboardRestartTooltip",{defaultMessage:"The risk score calculation might take a while to run. However, by pressing restart, you can force it to run immediately."})},function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(4),i=a.n(n),r=a(356),s=a(635),o=a(182),l=a(104);const c={flexGrow:0},u=({data:e,eventId:t,fieldFromBrowserField:a,isDraggable:n,linkValue:u,scopeId:d,values:p,isReadOnly:m})=>{const g=Object(o.e)(e.field);return i.a.createElement(i.a.Fragment,null,i.a.createElement(s.a,{contextId:d,data:e,eventId:t,fieldFromBrowserField:a,linkValue:u,isDraggable:n,style:c,values:p}),d!==l.d.active&&!m&&g&&i.a.createElement(r.a,{contextId:d,data:e,eventId:t,fieldFromBrowserField:a,linkValue:u,scopeId:d,values:p,applyWidthAndPadding:!1,hideAddToTimeline:!1}))};u.displayName="SummaryValueCell"},function(e,t,a){"use strict";a.d(t,"a",(function(){return j}));var n=a(34),i=a(4),r=a.n(i),s=a(33),o=a.n(s),l=a(79),c=a(351),u=a(515),d=a(305),p=a(473),m=a(306),g=a(516),b=a(693),f=a(476),y=a(643),h=a(258),E=a(359),v=a(474),x=a(423),k=a(223);const S=o.a.div.withConfig({displayName:"Details",componentId:"sc-1v02rai-0"})(["margin:5px 0;"]);S.displayName="Details";const j={id:l.d.netflow,isInstance:e=>"network_traffic"===`${Object(n.get)("event.category",e)}`.toLowerCase()||(e=>{const t=`${e}`.toLowerCase();return"network_flow"===t||"netflow_flow"===t})(Object(n.get)("event.action",e)),renderRow:({data:e,isDraggable:t,scopeId:a})=>r.a.createElement(k.a,null,r.a.createElement(S,null,r.a.createElement(b.a,{contextId:`netflow-row-renderer-render-row-${a}-${e._id}`,destinationBytes:Object(c.a)(Object(n.get)(x.a,e)),destinationGeoContinentName:Object(c.a)(Object(n.get)(v.b,e)),destinationGeoCountryName:Object(c.a)(Object(n.get)(v.d,e)),destinationGeoCountryIsoCode:Object(c.a)(Object(n.get)(v.c,e)),destinationGeoRegionName:Object(c.a)(Object(n.get)(v.e,e)),destinationGeoCityName:Object(c.a)(Object(n.get)(v.a,e)),destinationIp:Object(c.a)(Object(n.get)(m.a,e)),destinationPackets:Object(c.a)(Object(n.get)(x.b,e)),destinationPort:Object(c.a)(Object(n.get)(h.a,e)),eventDuration:Object(c.a)(Object(n.get)(d.b,e)),eventId:Object(n.get)(p.a,e),eventEnd:Object(c.a)(Object(n.get)(f.b,e)),eventStart:Object(c.a)(Object(n.get)(f.c,e)),isDraggable:t,networkBytes:Object(c.a)(Object(n.get)(E.a,e)),networkCommunityId:Object(c.a)(Object(n.get)(E.b,e)),networkDirection:Object(c.a)(Object(n.get)(E.c,e)),networkPackets:Object(c.a)(Object(n.get)(E.d,e)),networkProtocol:Object(c.a)(Object(n.get)(E.e,e)),processName:Object(c.a)(Object(n.get)(y.a,e)),sourceBytes:Object(c.a)(Object(n.get)(x.c,e)),sourceGeoContinentName:Object(c.a)(Object(n.get)(v.h,e)),sourceGeoCountryName:Object(c.a)(Object(n.get)(v.j,e)),sourceGeoCountryIsoCode:Object(c.a)(Object(n.get)(v.i,e)),sourceGeoRegionName:Object(c.a)(Object(n.get)(v.k,e)),sourceGeoCityName:Object(c.a)(Object(n.get)(v.g,e)),sourceIp:Object(c.a)(Object(n.get)(m.d,e)),sourcePackets:Object(c.a)(Object(n.get)(x.d,e)),sourcePort:Object(c.a)(Object(n.get)(h.c,e)),tlsClientCertificateFingerprintSha1:Object(c.a)(Object(n.get)(u.b,e)),tlsFingerprintsJa3Hash:Object(c.a)(Object(n.get)(g.a,e)),tlsServerCertificateFingerprintSha1:Object(c.a)(Object(n.get)(u.c,e)),transport:Object(c.a)(Object(n.get)(E.f,e)),userName:Object(c.a)(Object(n.get)(y.b,e))})))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return r}));var n=a(4);const i=a.n(n).a.createContext(null),r=()=>{var e;return null===(e=Object(n.useContext)(i))||void 0===e?void 0:e.current}},function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return s}));var n=a(56);a(7);const i=e=>0===e.length?{}:{query:{bool:{filter:{ids:{values:e}}}},size:1e4},r=(e,t)=>{const a=e.split(".");return 1===a.length?{[a[0]]:t}:{[a[0]]:r(a.slice(1).join("."),t)}},s=e=>{return t=e,Array.isArray(t)?t:Object.entries(t).reduce(((e,[t,a])=>Object(n.merge)(e,r(t,a))),{});var t}},function(e,t,a){const n=a(125),i=a(262),{re:r,t:s}=a(235);e.exports=(e,t)=>{if(e instanceof n)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;let a=null;if((t=t||{}).rtl){let t;for(;(t=r[s.COERCERTL].exec(e))&&(!a||a.index+a[0].length!==e.length);)a&&t.index+t[0].length===a.index+a[0].length||(a=t),r[s.COERCERTL].lastIndex=t.index+t[1].length+t[2].length;r[s.COERCERTL].lastIndex=-1}else a=e.match(r[s.COERCE]);return null===a?null:i(`${a[2]}.${a[3]||"0"}.${a[4]||"0"}`,t)}},function(e,t,a){"use strict";a.d(t,"a",(function(){return E}));var n=a(34),i=a(32),r=a(4),s=a.n(r),o=a(252),l=a.n(o),c=a(662),u=a.n(c),d=a(33),p=a.n(d),m=a(70),g=a(100),b=a(77),f=a(675);const y=p.a.div.withConfig({displayName:"FieldErrorsContainer",componentId:"sc-1brsijn-0"})(["p{margin-bottom:0;}"]),h=p.a.div.attrs((({className:e="",$caseIndexes:t=[]})=>({className:e}))).withConfig({displayName:"ContainerActions",componentId:"sc-1brsijn-1"})(["",""],(({$caseIndexes:e})=>e.map((e=>`\n        div[id="${e}"].euiAccordion__childWrapper .euiAccordion__padding--l {\n          padding: 0px;\n          .euiFlexGroup {\n            display: none;\n          }\n          .euiSpacer.euiSpacer--xl {\n            height: 0px;\n          }\n        }\n      `)))),E=({field:e,messageVariables:t})=>{const[a,o]=Object(r.useState)(null),c=Object(g.l)(),{isSubmitted:d,isSubmitting:p,isValid:E}=c,{triggersActionsUi:{getActionForm:v}}=Object(b.k)().services,x=Object(r.useMemo)((()=>Object(n.isEmpty)(e.value)?[]:e.value),[e.value]),k=Object(r.useMemo)((()=>x.reduce(((e,t,a)=>".case"===t.actionTypeId?[...e,`${a}`]:e),[])),[x]),S=Object(r.useCallback)(((t,a)=>{const n=[...x];n[a]=l()(n[a],{id:t}),e.setValue(n)}),[e,x]),j=Object(r.useCallback)((t=>e.setValue(t)),[e]),O=Object(r.useCallback)(((t,a,n)=>{setTimeout((()=>e.setValue((e=>{const i=[...e];return i[n]={...i[n],params:{...i[n].params,[t]:a}},i}))),0)}),[e]),w=Object(r.useMemo)((()=>v({actions:x,messageVariables:t,defaultActionGroupId:"default",setActionIdByIndex:S,setActions:j,setActionParamsProperty:O,featureId:m.SecurityConnectorFeatureId,defaultActionMessage:"Rule {{context.rule.name}} generated {{state.signals_count}} alerts",hideActionHeader:!0})),[x,v,t,S,O,j]);return Object(r.useEffect)((()=>{if(p||!e.errors.length)return o(null);if(d&&!p&&!1===E&&e.errors.length){const t=e.errors.map((({message:e})=>e)).join("\n");return o(t)}}),[d,p,e.isChangingValue,E,e.errors,o]),s.a.createElement(h,{$caseIndexes:k},a?s.a.createElement(s.a.Fragment,null,s.a.createElement(y,null,s.a.createElement(i.EuiCallOut,{title:f.a,color:"danger",iconType:"alert"},s.a.createElement(u.a,null,a))),s.a.createElement(i.EuiSpacer,null)):null,w)}},function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(32),i=a(34),r=a(4),s=a.n(r),o=a(79),l=a(254);const c=e=>e?"pinFilled":"pin",u=s.a.memo((({ariaLabel:e,allowUnpinning:t,isAlert:a,isDisabled:r,onClick:u=i.noop,pinned:d,timelineType:p})=>{const m=p===o.n.template,g=(({isAlert:e,isTemplate:t,isPinned:a})=>t?l.f(e):a?l.k(e):l.q(e))({isAlert:a,isTemplate:m,isPinned:d}),b=null!=e?e:g;return s.a.createElement(n.EuiButtonIcon,{"aria-label":b,"data-test-subj":"pin",iconType:c(d),onClick:u,isDisabled:r||m||!t,size:"s"})}));u.displayName="Pin"},function(e,t,a){"use strict";a.d(t,"a",(function(){return x})),a.d(t,"b",(function(){return k}));var n=a(34),i=a(4),r=a.n(i),s=a(78),o=a(11),l=a(92),c=a.n(l),u=a(45),d=a(90),p=a(94),m=a(95),g=a(146),b=a(494),f=a(677),y=a(123),h=a(86);const E="timeline-filter-drop-area",v=(e=[])=>e.filter((e=>e.meta.controlledBy!==E)),x=Object(i.memo)((({dataProviders:e,filters:t,filterManager:a,filterQuery:n,from:l,fromStr:u,kqlMode:x,isRefreshPaused:S,savedQueryId:j,setFilters:O,setSavedQueryId:w,refreshInterval:T,timelineId:I,to:C,toStr:M,updateReduxTime:F})=>{const D=Object(s.useDispatch)(),[A,_]=Object(i.useState)(null!=u?u:new Date(l).toISOString()),[N,R]=Object(i.useState)(null!=M?M:new Date(C).toISOString()),{browserFields:P,indexPattern:L}=Object(p.d)(m.SourcererScopeName.timeline),[B,q]=Object(i.useState)(void 0),[z,$]=Object(i.useState)({query:null!=n?n.expression:"",language:null!=n?n.kind:"kuery"}),[V,U]=Object(i.useState)(v(t)),[H,G]=Object(i.useState)(Object(g.b)(Object(y.g)(e,P),L)),Q=Object(b.a)(),W=Object(i.useCallback)(((e,t)=>D(h.a.applyKqlFilterQuery({id:I,filterQuery:{kuery:{kind:t,expression:e},serializedQuery:Object(g.b)(e,L)}}))),[D,L,I]);Object(i.useEffect)((()=>{let e=!0;const n=new o.Subscription;return a.setFilters(t),n.add(a.getUpdates$().subscribe({next:()=>{if(e){const e=v(a.getFilters());O(e),U(e)}}})),()=>{e=!1,n.unsubscribe()}}),[]),Object(i.useEffect)((()=>{const e=v(a.getFilters());c()(t,e)||a.setFilters(t)}),[t]),Object(i.useEffect)((()=>{$({query:null!=n?n.expression:"",language:null!=n?n.kind:"kuery"})}),[n]),Object(i.useEffect)((()=>{G(Object(g.b)(Object(y.g)(e,P),L))}),[e,P,L]),Object(i.useEffect)((()=>{null!=u&&null!=M?(_(u),R(M)):null!=l&&null!=C&&(_(new Date(l).toISOString()),R(new Date(C).toISOString()))}),[l,u,C,M]),Object(i.useEffect)((()=>{let e=!0;return async function(){if(null!=j&&null!=Q)try{const a=await Q.getSavedQuery(j);e&&null!=a&&q({...a,attributes:{...a.attributes,filters:v(t)}})}catch(e){q(void 0)}else e&&q(void 0)}(),()=>{e=!1}}),[j]);const K=Object(i.useCallback)(((e,t)=>{if((null==n||null!=n&&n.expression!==e.query||n.kind!==e.language)&&W(e.query,e.language),null!=t){const e=t.from.includes("now")||t.to.includes("now");F({id:d.a.timeline,end:t.to,start:t.from,isInvalid:!1,isQuickSelection:e,timelineId:I})}}),[n,I]),Y=Object(i.useCallback)((e=>{if(null!=e){if(e.id!==j&&w(e.id),null!=Q&&""!==H){const t=null!=e.attributes.filters?e.attributes.filters.findIndex((e=>e.meta.controlledBy===E)):-1;Q.updateQuery(e.id,{...e.attributes,filters:null!=e.attributes.filters?t>-1?[...e.attributes.filters.slice(0,t),k(H),...e.attributes.filters.slice(t+1)]:[...e.attributes.filters,k(H)]:[]})}}else w(null)}),[H,j,Q]);return r.a.createElement(f.a,{dateRangeFrom:A,dateRangeTo:N,hideSavedQuery:"search"===x,indexPattern:L,isRefreshPaused:S,filterQuery:z,filterManager:a,filters:V,onSubmitQuery:K,refreshInterval:T,savedQuery:B,onSavedQuery:Y,dataTestSubj:"timelineQueryInput",displayStyle:"inPage"})})),k=e=>{const t=JSON.parse(e),a=Object.keys(t);return{...t,meta:{alias:E,controlledBy:E,negate:!1,disabled:!1,type:"custom",key:Object(n.isEmpty)(a)?"bool":a[0],value:e},$state:{store:u.FilterStateStore.APP_STATE}}}},function(e,t,a){"use strict";a.d(t,"c",(function(){return c})),a.d(t,"a",(function(){return u})),a.d(t,"b",(function(){return d}));var n=a(7),i=a(49),r=a(495),s=a(198),o=a(167),l=a(1);const c=(e,t)=>e/Math.max((t.timeframeEnd.valueOf()-t.timeframeStart.valueOf())/36e5,1)>1,u=(e,t,a=!1)=>({series:{xScaleType:i.ScaleType.Time,yScaleType:i.ScaleType.Linear,stackAccessors:["g"]},axis:{xTickFormatter:Object(s.a)([e,t]),yTickFormatter:e=>e.toLocaleString(),tickSize:8},yAxisTitle:r.i,settings:{legendPosition:i.Position.Right,showLegend:a,showLegendExtra:a,theme:{scales:{barsPadding:.08},chartMargins:{left:0,right:0,top:0,bottom:0},chartPaddings:{left:0,right:0,top:0,bottom:0}}},customHeight:200}),d=({ruleType:e,isQueryBarValid:t,isThreatQueryBarValid:a,index:i,dataViewId:r,dataSourceType:s,threatIndex:c,threatMapping:u,machineLearningJobId:d,queryBar:p,newTermsFields:m})=>{if(!t||s===o.a.DataView&&!r||s===o.a.IndexPatterns&&0===i.length)return!0;if("threat_match"===e){var g;if(!a||!c.length||!u)return!0;if(!(u.length&&null!==(g=u[0].entries)&&void 0!==g&&g.length&&u[0].entries[0].field&&u[0].entries[0].value))return!0}return"machine_learning"===e?0===d.length:"eql"===e||"query"===e||"threshold"===e?Object(n.isEmpty)(p.query.query)&&Object(n.isEmpty)(p.filters):"new_terms"===e&&(e=>0===e.length||e.length>l.Qb)(m)}},function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var n=a(32),i=a(4),r=a.n(i),s=a(33),o=a.n(s),l=a(131),c=a(179),u=a(154),d=a(519),p=a(238);const m=o()(n.EuiSwitch).withConfig({displayName:"StaticSwitch",componentId:"sc-12pilng-0"})([".euiSwitch__thumb,.euiSwitch__icon{transition:none;}"]);m.displayName="StaticSwitch";const g=({id:e,isDisabled:t,isLoading:a,enabled:s,startMlJobsIfNeeded:o,onChange:g})=>{const[b,f]=Object(i.useState)(!1),y=Object(p.c)(),{startTransaction:h}=Object(u.a)(),{executeBulkAction:E}=Object(d.b)({suppressSuccessToast:!y}),v=Object(i.useCallback)((async t=>{f(!0),h({name:s?c.e.DISABLE:c.e.ENABLE});const a=t.target.checked;a&&await(null==o?void 0:o());const n=await E({type:a?l.b.enable:l.b.disable,ids:[e]});null!=n&&n.attributes.results.updated.length&&(null==g||g(n.attributes.results.updated[0].enabled)),f(!1)}),[s,E,e,g,o,h]),x=Object(i.useMemo)((()=>b!==a&&a||b),[b,a]);return r.a.createElement(n.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceAround",id:`rule-switch-${e}`},r.a.createElement(n.EuiFlexItem,{grow:!1},x?r.a.createElement(n.EuiLoadingSpinner,{size:"m","data-test-subj":"ruleSwitchLoader"}):r.a.createElement(m,{"data-test-subj":"ruleSwitch",label:void 0,disabled:t,checked:s,onChange:v})))},b=r.a.memo(g);b.displayName="RuleSwitch"},function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(32),i=a(4),r=a.n(i),s=a(33),o=a.n(s),l=a(119);const c=o()(n.EuiPanel).withConfig({displayName:"MyPanel",componentId:"sc-177nzsv-0"})(["position:relative;"]);c.displayName="MyPanel";const u=({children:e,loading:t,title:a})=>r.a.createElement(c,{hasBorder:!0},t&&r.a.createElement(n.EuiProgress,{size:"xs",color:"accent",position:"absolute","data-test-subj":"stepPanelProgress"}),a&&r.a.createElement(l.a,{title:a}),e),d=Object(i.memo)(u)},function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(4),i=a.n(n),r=a(32),s=a(113);const o=({columnName:e,children:t})=>{const[a,o]=Object(n.useState)(!1);return i.a.createElement(r.EuiPopover,{anchorPosition:"upCenter",isOpen:a,closePopover:()=>o(!1),button:i.a.createElement(r.EuiButtonIcon,{"aria-label":s.Xb(e),onClick:e=>{o(!a),e.stopPropagation()},size:"xs",color:"primary",iconType:"questionInCircle",style:{height:"auto"}})},t)},l=i.a.memo(o);l.displayName="PopoverTooltip"},function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(4),i=a.n(n),r=a(32);const s=({title:e,tooltipContent:t,customTooltip:a})=>i.a.createElement(r.EuiFlexGrid,{gutterSize:"none"},i.a.createElement(r.EuiFlexItem,{style:{width:"calc(100% - 20px)"}},i.a.createElement("span",{className:"eui-textTruncate"},e)),null!=a?a:i.a.createElement(r.EuiToolTip,{content:t},i.a.createElement(r.EuiIcon,{"data-test-subj":"tableHeaderIcon",size:"m",color:"subdued",type:"questionInCircle",style:{marginLeft:4}}))),o=i.a.memo(s);o.displayName="TableHeaderTooltipCell"},function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(4),i=a(39),r=a(494),s=a(84),o=a(113);const l=(e,{ruleType:t,onError:a})=>{var l;const c=Object(r.a)(),{addError:u}=Object(s.a)(),d=Object(i.useQuery)(["detectionEngine","rule","savedQuery",e],(async()=>e&&"saved_query"===t?c.getSavedQuery(e):null),{onError:null!=a?a:e=>{u(e,{title:o.Ec})},retry:!1}),p=Object(n.useMemo)((()=>{var e;return d.data?{saved_id:d.data.id,filters:null!==(e=d.data.attributes.filters)&&void 0!==e?e:[],query:d.data.attributes.query,title:d.data.attributes.title}:null}),[d.data]);return{isSavedQueryLoading:!!e&&d.isLoading,savedQueryBar:p,savedQuery:null!==(l=d.data)&&void 0!==l?l:void 0}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(4),i=a(77);const r=()=>{const{storage:e}=Object(i.k)().services,t=Object(n.useCallback)((t=>{var a;return null!==(a=e.get(`${t}-messages`))&&void 0!==a?a:[]}),[e]),a=Object(n.useCallback)(((t,a)=>{var n;const i=null!==(n=e.get(`${t}-messages`))&&void 0!==n?n:[];e.set(`${t}-messages`,[...i,a])}),[e]),r=Object(n.useCallback)(((t,a)=>{var n;return(null!==(n=e.get(`${t}-messages`))&&void 0!==n?n:[]).filter((e=>e===a)).length>0}),[e]),s=Object(n.useCallback)(((t,a)=>{var n;const i=null!==(n=e.get(`${t}-messages`))&&void 0!==n?n:[];e.set(`${t}-messages`,[...i.filter((e=>e!==a))])}),[e]);return{getMessages:t,addMessage:a,clearAllMessages:Object(n.useCallback)((t=>e.remove(`${t}-messages`)),[e]),removeMessage:s,hasMessage:r}}},function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return c}));var n=a(32),i=a(4),r=a.n(i),s=a(118);const o="open",l=({status:e=o,onFilterGroupChanged:t})=>{const a=[{id:"open",label:s.B,"data-test-subj":"openAlerts"},{id:"acknowledged",label:s.a,"data-test-subj":"acknowledgedAlerts"},{id:"closed",label:s.x,"data-test-subj":"closedAlerts"}],l=Object(i.useCallback)((e=>{t(e)}),[t]);return r.a.createElement(n.EuiButtonGroup,{legend:"filter status",color:"primary",options:a,idSelected:e,"data-test-subj":"alerts-table-filter-group",onChange:l})},c=r.a.memo(l)},function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(4),i=a(312);const r=()=>{const[e,t,a]=Object(i.a)(),r=Object(n.useRef)(),s=Object(n.useCallback)((e=>{var t;null===(t=r.current)||void 0===t||t.call(r,e)}),[]),o=Object(n.useCallback)((()=>{var e;null===(e=r.current)||void 0===e||e.call(r,null)}),[]),l=Object(n.useCallback)((()=>(t(),new Promise((e=>{r.current=e})).finally((()=>{a()})))),[t,a]);return{isBulkDuplicateConfirmationVisible:e,showBulkDuplicateConfirmation:Object(n.useCallback)((async()=>{const e=await l();return e?s(e):o(),e}),[l,s,o]),cancelRuleDuplication:o,confirmRuleDuplication:s}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(4),i=a.n(n),r=a(32),s=a(536),o=a(684);const l=({onCancel:e,onConfirm:t,rulesCount:a})=>{const[l,c]=Object(n.useState)(s.a.withExceptions),u=Object(n.useCallback)((e=>{c(e)}),[c]),d=Object(n.useCallback)((()=>{t(l)}),[t,l]);return i.a.createElement(r.EuiConfirmModal,{title:o.c.MODAL_TITLE(a),onConfirm:d,cancelButtonText:o.c.CANCEL_BUTTON,confirmButtonText:o.c.CONTINUE_BUTTON,defaultFocusedButton:"confirm",onCancel:e},i.a.createElement(r.EuiText,null,o.c.MODAL_TEXT(a)," ",i.a.createElement(r.EuiIconTip,{content:o.c.DUPLICATE_TOOLTIP,position:"bottom"})),i.a.createElement(r.EuiSpacer,null),i.a.createElement(r.EuiRadioGroup,{options:[{id:s.a.withExceptions,label:o.c.DUPLICATE_EXCEPTIONS_TEXT(a)},{id:s.a.withoutExceptions,label:o.c.DUPLICATE_WITHOUT_EXCEPTIONS_TEXT(a)}],idSelected:l,onChange:u}))},c=i.a.memo(l);c.displayName="BulkActionDuplicateExceptionsConfirmation"},function(e,t,a){"use strict";a.d(t,"a",(function(){return m})),a.d(t,"e",(function(){return g})),a.d(t,"b",(function(){return b})),a.d(t,"d",(function(){return f})),a.d(t,"f",(function(){return y})),a.d(t,"g",(function(){return h})),a.d(t,"c",(function(){return v}));var n=a(4),i=a.n(n),r=a(0),s=a(35),o=a(32),l=a(77),c=a(692),u=a(418),d=a(686),p=a(290);const m=r.i18n.translate("xpack.securitySolution.eventFilters.aboutInfo",{defaultMessage:"Event filters exclude high volume or unwanted events from being written to Elasticsearch."}),g=r.i18n.translate("xpack.securitySolution.eventFilter.form.name.label",{defaultMessage:"Name"}),b=r.i18n.translate("xpack.securitySolution.eventFilter.form.description.placeholder",{defaultMessage:"Description"}),f=r.i18n.translate("xpack.securitySolution.eventFilter.form.name.error",{defaultMessage:"The name can't be empty"}),y=r.i18n.translate("xpack.securitySolution.eventFilter.form.os.label",{defaultMessage:"Select operating system"}),h=r.i18n.translate("xpack.securitySolution.eventFilter.form.rule.name",{defaultMessage:"Endpoint Event Filtering"}),E={pageTitle:r.i18n.translate("xpack.securitySolution.eventFilters.pageTitle",{defaultMessage:"Event Filters"}),pageAboutInfo:r.i18n.translate("xpack.securitySolution.eventFilters.pageAboutInfo",{defaultMessage:"Event filters exclude high volume or unwanted events from being written to Elasticsearch."}),pageAddButtonTitle:r.i18n.translate("xpack.securitySolution.eventFilters.pageAddButtonTitle",{defaultMessage:"Add event filter"}),getShowingCountLabel:e=>r.i18n.translate("xpack.securitySolution.eventFilters.showingTotal",{defaultMessage:"Showing {total} {total, plural, one {event filter} other {event filters}}",values:{total:e}}),cardActionEditLabel:r.i18n.translate("xpack.securitySolution.eventFilters.cardActionEditLabel",{defaultMessage:"Edit event filter"}),cardActionDeleteLabel:r.i18n.translate("xpack.securitySolution.eventFilters.cardActionDeleteLabel",{defaultMessage:"Delete event filter"}),flyoutCreateTitle:r.i18n.translate("xpack.securitySolution.eventFilters.flyoutCreateTitle",{defaultMessage:"Add event filter"}),flyoutEditTitle:r.i18n.translate("xpack.securitySolution.eventFilters.flyoutEditTitle",{defaultMessage:"Edit event filter"}),flyoutCreateSubmitButtonLabel:r.i18n.translate("xpack.securitySolution.eventFilters.flyoutCreateSubmitButtonLabel",{defaultMessage:"Add event filter"}),flyoutCreateSubmitSuccess:({name:e})=>r.i18n.translate("xpack.securitySolution.eventFilters.flyoutCreateSubmitSuccess",{defaultMessage:'"{name}" has been added to the event filters list.',values:{name:e}}),flyoutEditSubmitSuccess:({name:e})=>r.i18n.translate("xpack.securitySolution.eventFilters.flyoutEditSubmitSuccess",{defaultMessage:'"{name}" has been updated.',values:{name:e}}),flyoutDowngradedLicenseDocsInfo:e=>i.a.createElement(i.a.Fragment,null,i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventFilters.flyoutDowngradedLicenseDocsInfo",defaultMessage:"For more information, see our "}),i.a.createElement(o.EuiLink,{target:"_blank",href:`${e.eventFilters}`},i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventFilters.flyoutDowngradedLicenseDocsLink",defaultMessage:"Event filters documentation"}))),deleteActionSuccess:e=>r.i18n.translate("xpack.securitySolution.eventFilters.deleteSuccess",{defaultMessage:'"{itemName}" has been removed from event filters list.',values:{itemName:e}}),emptyStateTitle:r.i18n.translate("xpack.securitySolution.eventFilters.emptyStateTitle",{defaultMessage:"Add your first event filter"}),emptyStateInfo:r.i18n.translate("xpack.securitySolution.eventFilters.emptyStateInfo",{defaultMessage:"Add an event filter to exclude high volume or unwanted events from being written to Elasticsearch."}),emptyStatePrimaryButtonLabel:r.i18n.translate("xpack.securitySolution.eventFilters.emptyStatePrimaryButtonLabel",{defaultMessage:"Add event filter"}),searchPlaceholderInfo:r.i18n.translate("xpack.securitySolution.eventFilters.searchPlaceholderInfo",{defaultMessage:"Search on the fields below: name, description, comments, value"})},v=Object(n.memo)((()=>{const e=Object(l.j)(),t=u.a.getInstance(e);return i.a.createElement(c.a,{apiClient:t,ArtifactFormComponent:d.a,labels:E,"data-test-subj":"EventFiltersListPage",searchableFields:p.d,flyoutSize:"l"})}));v.displayName="EventFiltersList"},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=e=>null==e?[]:null!=e.host&&null!=e.host.name?[{fieldName:"host.name",fieldValue:e.host.name[0]}]:[]},function(e,t,a){"use strict";a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return d}));var n=a(34),i=a(266),r=a(137),s=a(600),o=a(579),l=a(2);const c=i.c.UsersType.details,u={[r.UsersTableType.allUsers]:o.a,[r.UsersTableType.authentications]:o.c,[r.UsersTableType.anomalies]:o.b,[r.UsersTableType.risk]:o.e,[r.UsersTableType.events]:o.d,[r.UsersTableType.risk]:o.e},d=(e,t)=>{let a=[];if(null!=e.detailName&&(a=[{text:e.detailName,href:t({path:Object(s.c)(e.detailName,""),deepLinkId:l.a.users})}]),null!=e.tabName){const t=Object(n.get)("tabName",e);if(!t)return a;a=[...a,{text:u[t],href:""}]}return a}},function(e,t,a){"use strict";a.d(t,"a",(function(){return TrustedAppsApiClient}));var n=a(110),i=a(1072),r=a(315),s=a(895);function o(e){return{...e,entries:Object(i.b)(e.entries)}}function l(e){return{...e,entries:Object(i.a)(e.entries,!0)}}class TrustedAppsApiClient extends r.a{constructor(e){super(e,n.m,s.b,o,l)}static getInstance(e){return super.getInstance(e,n.m,s.b,o,l)}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return s}));var n=a(93),i=a(110);const r=["name","description","item_id","entries.value","entries.entries.value"],s={name:i.n,namespace_type:"agnostic",description:i.l,list_id:i.m,type:n.b.ENDPOINT_TRUSTED_APPS}},function(e,t,a){"use strict";a.d(t,"a",(function(){return BlocklistsApiClient}));var n=a(110),i=a(1072),r=a(315),s=a(1066);function o(e){return{...e,entries:Object(i.b)(e.entries)}}function l(e){return{...e,entries:Object(i.a)(e.entries)}}class BlocklistsApiClient extends r.a{constructor(e){super(e,n.b,s.a,o,l)}static getInstance(e){return super.getInstance(e,n.b,s.a,o,l)}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return pe}));var n=a(4),i=a.n(n),r=a(78),s=a(81),o=a(79),l=a(86),c=a(12),u=a(599),d=a(158),p=a(35),m=a(33),g=a.n(m),b=a(913),f=a(247),y=a(227),h=a(32),E=a(121),v=a(37),x=a(84),k=a(608);const S=({onComplete:e,isEnableDownloader:t,exportedIds:a})=>{const{tabName:i}=Object(v.useParams)(),{addSuccess:r}=Object(x.a)(),s=Object(n.useCallback)((t=>{null!=e&&e(),r({title:i===o.n.template?E.S(t):E.R(t),"data-test-subj":"addObjectToContainerSuccess"})}),[r,e,i]),l=Object(n.useCallback)((()=>{null!=e&&e()}),[e]);return Object(n.useEffect)((()=>{(async()=>{if(null!=a&&a.length&&t){const e=await Object(y.b)({ids:a});e instanceof Blob?(Object(k.a)(e,`${E.l}.ndjson`),s(a.length)):l()}})()}),[a,t]),null};S.displayName="ExportTimeline";const j=i.a.memo(S);var O=a(34);const w=i.a.memo((({title:e,closeModal:t,onDelete:a})=>{const{tabName:r}=Object(v.useParams)(),s=r===o.n.template?E.h:E.i,l=Object(n.useCallback)((()=>{const t=null!=e?e.trim():"",a=Object(O.isEmpty)(t)?E.Y:t;return i.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.open.timeline.deleteTimelineModalTitle",defaultMessage:'Delete "{title}"?',"data-test-subj":"title",values:{title:a}})}),[e]);return i.a.createElement(h.EuiConfirmModal,{buttonColor:"danger",cancelButtonText:E.b,confirmButtonText:E.f,defaultFocusedButton:h.EUI_MODAL_CONFIRM_BUTTON,onCancel:t,onConfirm:a,title:l()},i.a.createElement("div",{"data-test-subj":"warning"},s))}));w.displayName="DeleteTimelineModal";const T=Object(m.createGlobalStyle)(["div[data-popover-open]{display:none;}"]),I=i.a.memo((({deleteTimelines:e,isModalOpen:t,savedObjectIds:a,title:r,onComplete:s})=>{const{addSuccess:l}=Object(x.a)(),{tabName:c}=Object(v.useParams)(),u=Object(n.useCallback)((()=>{null!=s&&s()}),[s]),d=Object(n.useCallback)((()=>{a.length>0&&(e(a),l({title:c===o.n.template?E.Q(a.length):E.P(a.length)})),null!=s&&s()}),[e,a,s,l,c]);return i.a.createElement(i.a.Fragment,null,t&&i.a.createElement(T,{"data-test-subj":"remove-popover"}),t?i.a.createElement(h.EuiModal,{maxWidth:600,onClose:u},i.a.createElement(w,{"data-test-subj":"delete-timeline-modal",onDelete:d,title:r,closeModal:u})):null)}));I.displayName="DeleteTimelineModalOverlay";const C=({deleteTimelines:e,ids:t,isEnableDownloader:a,isDeleteTimelineModalOpen:n,onComplete:r,title:s})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(j,{"data-test-subj":"TimelineDownloader",exportedIds:t,isEnableDownloader:a,onComplete:r}),null!=e&&i.a.createElement(I,{"data-test-subj":"DeleteTimelineModalOverlay",deleteTimelines:e,isModalOpen:n,onComplete:r,savedObjectIds:t,title:s})),M=i.a.memo(C),F=()=>{const[e,t]=Object(n.useState)(null),[a,i]=Object(n.useState)(!1),[r,s]=Object(n.useState)(!1),o=Object(n.useCallback)((()=>{i(!1),t(null)}),[e]),l=Object(n.useCallback)((e=>{i(!0),null!=e&&t(e)}),[]),c=Object(n.useCallback)((e=>{s(!0),null!=e&&t(e)}),[]),u=Object(n.useCallback)((()=>{s(!1),t(null)}),[]);return{actionItem:e,onCompleteEditTimelineAction:Object(n.useCallback)((()=>{i(!1),s(!1),t(null)}),[]),isDeleteTimelineModalOpen:a,onCloseDeleteTimelineModal:o,onOpenDeleteTimelineModal:l,isEnableDownloader:r,enableExportTimelineDownloader:c,disableExportTimelineDownloader:u}},D=g.a.div.withConfig({displayName:"SearchRowContainer",componentId:"sc-12vyhis-0"})(["&:not(:last-child){margin-bottom:",";}"],(e=>e.theme.eui.euiSizeL));D.displayName="SearchRowContainer";const A=g()(h.EuiFlexGroup).withConfig({displayName:"SearchRowFlexGroup",componentId:"sc-12vyhis-1"})(["margin-bottom:",";"],(e=>e.theme.eui.euiSizeXS));A.displayName="SearchRowFlexGroup";const _=i.a.memo((({favoriteCount:e,onlyFavorites:t,onQueryChange:a,onToggleOnlyFavorites:r,children:s,timelineType:l})=>{const c=Object(n.useMemo)((()=>({placeholder:l===o.n.default?E.J:E.K,incremental:!1,"data-test-subj":"search-bar"})),[l]);return i.a.createElement(D,null,i.a.createElement(A,{gutterSize:"s"},i.a.createElement(h.EuiFlexItem,null,i.a.createElement(h.EuiSearchBar,{box:c,onChange:a})),i.a.createElement(h.EuiFlexItem,{grow:!1},i.a.createElement(h.EuiFilterGroup,{fullWidth:!0},i.a.createElement(i.a.Fragment,null,i.a.createElement(h.EuiFilterButton,{"data-test-subj":"only-favorites-toggle",hasActiveFilters:t,onClick:r,numFilters:null!=e?e:void 0},E.B),!!s&&s)))))}));_.displayName="SearchRow";var N=a(82),R=a.n(N);const P=({actionTimelineToShow:e,deleteTimelines:t,enableExportTimelineDownloader:a,onOpenDeleteTimelineModal:n,onOpenTimeline:i})=>[{width:"80px",actions:[{name:E.e,icon:"timeline",onClick:({savedObjectId:e})=>{i({duplicate:!0,timelineType:o.n.default,timelineId:e})},type:"icon",enabled:({savedObjectId:e})=>null!=e,description:E.e,"data-test-subj":"create-from-template",available:t=>t.timelineType===o.n.template&&e.includes("createFrom")},{name:E.d,icon:"visText",onClick:({savedObjectId:e})=>{i({duplicate:!0,timelineType:o.n.template,timelineId:e})},type:"icon",enabled:({savedObjectId:e})=>null!=e,description:E.d,"data-test-subj":"create-template-from-timeline",available:t=>t.timelineType!==o.n.template&&e.includes("createFrom")},{name:E.C,icon:"copy",onClick:({savedObjectId:e})=>{i({duplicate:!0,timelineId:null!=e?e:""})},type:"icon",enabled:({savedObjectId:e})=>null!=e,description:E.C,"data-test-subj":"open-duplicate",available:t=>t.timelineType!==o.n.template&&e.includes("duplicate")},{name:E.D,icon:"copy",onClick:({savedObjectId:e})=>{i({duplicate:!0,timelineId:null!=e?e:""})},type:"icon",enabled:({savedObjectId:e})=>null!=e,description:E.D,"data-test-subj":"open-duplicate-template",available:t=>t.timelineType===o.n.template&&e.includes("duplicate")},{name:E.m,icon:"exportAction",onClick:e=>{null!=a&&a(e)},enabled:e=>null!=e.savedObjectId&&e.status!==o.l.immutable,description:E.m,"data-test-subj":"export-timeline",available:()=>e.includes("export")},{name:E.g,icon:"trash",onClick:e=>{null!=n&&n(e)},enabled:({savedObjectId:e,status:t})=>null!=e&&t!==o.l.immutable,description:E.g,"data-test-subj":"delete-timeline",available:()=>e.includes("delete")&&null!=t}]}],L="45px";var B=a(136),q=a(846),z=a(87),$=a(101);const V=g.a.span.withConfig({displayName:"LineClampTextContainer",componentId:"sc-oh8wsp-0"})(["text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:5;-webkit-box-orient:vertical;overflow:hidden;"]),U=({itemIdToExpandedNotesRowMap:e,onOpenTimeline:t,onToggleShowNotes:a,timelineType:n})=>[{isExpander:!0,render:({notes:t,savedObjectId:n})=>null!=t&&t.length>0&&null!=n?i.a.createElement(h.EuiButtonIcon,{"data-test-subj":"expand-notes",onClick:()=>null!=e[n]?a(Object(O.omit)(n,e)):a({...e,[n]:i.a.createElement(q.a,{notes:t})}),"aria-label":e[n]?E.c:E.k,iconType:e[n]?"arrowDown":"arrowRight"}):null,width:L},{dataType:"string",field:"title",name:n===o.n.default?E.W:E.X,render:(e,a)=>null!=a.savedObjectId?i.a.createElement(h.EuiLink,{"data-test-subj":`title-${a.savedObjectId}`,onClick:()=>t({duplicate:!1,timelineId:`${a.savedObjectId}`})},Object(B.f)(a)?E.Y:i.a.createElement(V,null,e)):i.a.createElement("div",{"data-test-subj":`title-no-saved-object-id-${e||"no-title"}`},Object(B.f)(a)?E.Y:e),sortable:!1},{dataType:"string",field:"description",name:E.j,render:e=>i.a.createElement(V,{"data-test-subj":"description"},null!=e&&e.trim().length>0?e:Object(z.d)()),sortable:!1},{dataType:"date",field:"updated",name:E.w,render:(e,t)=>i.a.createElement("div",{"data-test-subj":"updated"},null!=t.updated?i.a.createElement($.b,{value:e}):Object(z.d)()),sortable:!0}],H=e=>e?[{dataType:"string",field:"updatedBy",name:E.z,render:e=>i.a.createElement("div",{"data-test-subj":"username"},Object(z.a)(e)),sortable:!1}]:[],G=({timelineType:e})=>{const t={note:{align:"center",field:"eventIdToNoteIds",name:i.a.createElement(h.EuiToolTip,{content:E.A},i.a.createElement(h.EuiIcon,{"data-test-subj":"notes-count-header-icon",size:"m",type:"editorComment"})),render:(e,t)=>i.a.createElement("span",{"data-test-subj":"notes-count"},Object(B.d)(t)),sortable:!1,width:L},pinnedEvent:{align:"center",field:"pinnedEventIds",name:i.a.createElement(h.EuiToolTip,{content:E.H},i.a.createElement(h.EuiIcon,{"data-test-subj":"pinned-event-header-icon",size:"m",type:"pin"})),render:(e,t)=>i.a.createElement("span",{"data-test-subj":"pinned-event-count"},`${Object(B.e)(t)}`),sortable:!1,width:L},favorite:{align:"center",field:"favorite",name:i.a.createElement(h.EuiToolTip,{content:E.n},i.a.createElement(h.EuiIcon,{"data-test-subj":"favorites-header-icon",size:"m",type:"starEmpty"})),render:e=>{const t=null!=e&&e.length>0?"starFilled":"starEmpty";return i.a.createElement(h.EuiIcon,{"data-test-subj":`favorite-${t}-star`,type:t,size:"m"})},sortable:!1,width:L}},a=[t.note,t.favorite],n=[t.pinnedEvent,t.note,t.favorite];return e===o.n.template?a:n},Q=h.EuiBasicTable,W=g()(Q).withConfig({displayName:"BasicTable",componentId:"sc-1ng8ufe-0"})([".euiTableCellContent{animation:none;}.euiTableRow-isExpandedRow .euiTableCellContent__text{width:100%;}"]);W.displayName="BasicTable";const K=i.a.memo((({actionTimelineToShow:e,deleteTimelines:t,defaultPageSize:a,loading:r,itemIdToExpandedNotesRowMap:s,enableExportTimelineDownloader:l,onOpenDeleteTimelineModal:c,onOpenTimeline:u,onSelectionChange:d,onTableChange:p,onToggleShowNotes:m,pageIndex:g,pageSize:b,searchResults:f,showExtendedColumns:y,sortField:h,sortDirection:v,tableRef:x,timelineType:k,totalSearchResultsCount:S})=>{const j={showPerPageOptions:y,pageIndex:g,pageSize:b,pageSizeOptions:[Math.floor(Math.max(a,1)/2),a,2*a],totalItemCount:S},O={sort:{field:h,direction:v}},w={selectable:e=>null!=e.savedObjectId&&e.status!==o.l.immutable,selectableMessage:e=>e?void 0:E.y,onSelectionChange:d},T=null!=x?{ref:x}:{},I=Object(n.useMemo)((()=>(({actionTimelineToShow:e,deleteTimelines:t,enableExportTimelineDownloader:a,itemIdToExpandedNotesRowMap:n,onOpenDeleteTimelineModal:i,onOpenTimeline:r,onToggleShowNotes:s,showExtendedColumns:o,timelineType:l})=>[...U({itemIdToExpandedNotesRowMap:n,onOpenTimeline:r,onToggleShowNotes:s,timelineType:l}),...H(o),...G({timelineType:l}),...e.length?P({actionTimelineToShow:e,deleteTimelines:t,enableExportTimelineDownloader:a,onOpenDeleteTimelineModal:i,onOpenTimeline:r}):[]])({actionTimelineToShow:e,deleteTimelines:t,itemIdToExpandedNotesRowMap:s,enableExportTimelineDownloader:l,onOpenDeleteTimelineModal:c,onOpenTimeline:u,onSelectionChange:d,onToggleShowNotes:m,showExtendedColumns:y,timelineType:k})),[e,t,s,l,c,u,d,m,y,k]),C=r||null==f?E.x:k===o.n.template?E.bb:E.ab;return i.a.createElement(W,R()({columns:I,"data-test-subj":"timelines-table",isExpandable:!0,isSelectable:e.includes("selectable"),itemId:"savedObjectId",itemIdToExpandedRowMap:s,items:null!=f?f:[],loading:r,noItemsMessage:C,onChange:p,pagination:j,selection:e.includes("selectable")?w:void 0,sorting:O},T))}));K.displayName="TimelinesTable";const Y=g.a.span.withConfig({displayName:"QueryText",componentId:"sc-hd5h98-0"})(["white-space:normal;word-break:break-word;"]),J=i.a.memo((({deleteTimelines:e,defaultPageSize:t,favoriteCount:a,isLoading:r,itemIdToExpandedNotesRowMap:s,importDataModalToggle:l,onDeleteSelected:c,onlyFavorites:u,onOpenTimeline:d,onQueryChange:m,onSelectionChange:g,onTableChange:v,onToggleOnlyFavorites:x,onToggleShowNotes:k,pageIndex:S,pageSize:j,query:O,refetch:w,searchResults:T,selectedItems:I,sortDirection:C,setImportDataModalToggle:D,sortField:A,timelineType:N=o.n.default,timelineStatus:R,timelineFilter:P,templateTimelineFilter:L,totalSearchResultsCount:q})=>{var z;const $=Object(n.useRef)(),{actionItem:V,enableExportTimelineDownloader:U,isEnableDownloader:H,isDeleteTimelineModalOpen:G,onOpenDeleteTimelineModal:Q,onCompleteEditTimelineAction:W}=F(),{getBatchItemsPopoverContent:J}=(({deleteTimelines:e,selectedItems:t,tableRef:a,timelineType:r=o.n.default})=>{const{enableExportTimelineDownloader:s,disableExportTimelineDownloader:l,isEnableDownloader:c,isDeleteTimelineModalOpen:u,onOpenDeleteTimelineModal:d,onCloseDeleteTimelineModal:p}=F(),m=Object(n.useCallback)((e=>{null!=e&&e(),null!=a&&null!=a.current&&a.current.changeSelection([]),l(),p()}),[l,p,a]),g=Object(n.useMemo)((()=>{return e=null!=t?t:[],(Array.isArray(e)?e:[e]).reduce(((e,t)=>null!=t.savedObjectId?[...e,t.savedObjectId]:[...e]),[]);var e}),[t]),b=Object(n.useCallback)((()=>s()),[s]),f=Object(n.useCallback)((()=>d()),[d]),y=Object(n.useCallback)((a=>{var n,s,l,d;const p=null==t||0===t.length;return i.a.createElement(i.a.Fragment,null,i.a.createElement(M,{deleteTimelines:e,ids:g,isEnableDownloader:c,isDeleteTimelineModalOpen:u,onComplete:m.bind(null,a),title:1!==(null==t?void 0:t.length)?r===o.n.template?E.L(null!==(n=null==t?void 0:t.length)&&void 0!==n?n:0):E.M(null!==(s=null==t?void 0:t.length)&&void 0!==s?s:0):null!==(l=null===(d=t[0])||void 0===d?void 0:d.title)&&void 0!==l?l:""}),i.a.createElement(h.EuiContextMenuPanel,{items:[i.a.createElement(h.EuiContextMenuItem,{"data-test-subj":"export-timeline-action",disabled:p,icon:"exportAction",key:"ExportItemKey",onClick:b},E.m),i.a.createElement(h.EuiContextMenuItem,{"data-test-subj":"delete-timeline-action",disabled:p,icon:"trash",key:"DeleteItemKey",onClick:f},E.g)]}))}),[t,e,g,c,u,m,r,b,f]);return{onCompleteBatchActions:m,getBatchItemsPopoverContent:y}})({deleteTimelines:e,selectedItems:I,tableRef:$,timelineType:N}),X=Object(n.useMemo)((()=>i.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.open.timeline.showingNTemplatesLabel",defaultMessage:"{totalSearchResultsCount} {totalSearchResultsCount, plural, one {template} other {templates}} {with}",values:{totalSearchResultsCount:q,with:i.a.createElement(Y,{"data-test-subj":"selectable-query-text"},O.trim().length?`${E.Z} "${O.trim()}"`:"")}})),[q,O]),Z=Object(n.useMemo)((()=>i.a.createElement(p.FormattedMessage,{id:"xpack.securitySolution.open.timeline.showingNTimelinesLabel",defaultMessage:"{totalSearchResultsCount} {totalSearchResultsCount, plural, one {timeline} other {timelines}} {with}",values:{totalSearchResultsCount:q,with:i.a.createElement(Y,{"data-test-subj":"selectable-query-text"},O.trim().length?`${E.Z} "${O.trim()}"`:"")}})),[q,O]),ee=Object(n.useMemo)((()=>null!=V&&null!=V.savedObjectId?[V.savedObjectId]:[]),[V]),te=Object(n.useCallback)((()=>{null!=w&&w()}),[w]),ae=Object(n.useCallback)((()=>{null!=D&&D(!1)}),[D]),ne=Object(n.useCallback)((()=>{null!=D&&D(!1),null!=w&&w()}),[D,w]),ie=Object(n.useMemo)((()=>{const t=["createFrom","duplicate"];return R!==o.l.immutable&&(t.push("export"),t.push("selectable")),null!=c&&null!=e&&R!==o.l.immutable&&t.push("delete"),t}),[c,e,R]),re=Object(n.useMemo)((()=>i.a.createElement(i.a.Fragment,null,L)),[L]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(M,{deleteTimelines:e,ids:ee,isDeleteTimelineModalOpen:G,isEnableDownloader:H,onComplete:W,title:null!==(z=null==V?void 0:V.title)&&void 0!==z?z:E.Y}),i.a.createElement(b.a,{checkBoxLabel:E.G,closeModal:ae,description:E.N,errorMessage:E.r,failedDetailed:E.s,importComplete:ne,importData:y.e,successMessage:E.T,showCheckBox:!1,showModal:null!=l&&l,submitBtnText:E.u,subtitle:E.v,title:E.t}),i.a.createElement("div",{className:B.a},!!P&&P,i.a.createElement(_,{"data-test-subj":"search-row",favoriteCount:a,onlyFavorites:u,onQueryChange:m,onToggleOnlyFavorites:x,query:O,timelineType:N},re),i.a.createElement(f.a,{border:!0},i.a.createElement(f.d,null,i.a.createElement(f.c,null,i.a.createElement(f.e,{"data-test-subj":"query-message"},i.a.createElement(i.a.Fragment,null,E.O," ",N===o.n.template?X:Z))),i.a.createElement(f.c,null,R!==o.l.immutable&&i.a.createElement(i.a.Fragment,null,i.a.createElement(f.e,{"data-test-subj":"selected-count"},N===o.n.template?E.L(I.length):E.M(I.length)),i.a.createElement(f.b,{dataTestSubj:"batchActions",iconSide:"right",iconType:"arrowDown",popoverContent:J,"data-test-subj":"utility-bar-action"},i.a.createElement("span",{"data-test-subj":"utility-bar-action-button"},E.a))),i.a.createElement(f.b,{dataTestSubj:"refreshButton",iconSide:"right",iconType:"refresh",onClick:te},E.I)))),i.a.createElement(K,{actionTimelineToShow:ie,"data-test-subj":"timelines-table",deleteTimelines:e,defaultPageSize:t,loading:r,itemIdToExpandedNotesRowMap:s,enableExportTimelineDownloader:U,onOpenDeleteTimelineModal:Q,onOpenTimeline:d,onSelectionChange:g,onTableChange:v,onToggleShowNotes:k,pageIndex:S,pageSize:j,searchResults:T,showExtendedColumns:!0,sortDirection:C,sortField:A,timelineType:N,tableRef:$,totalSearchResultsCount:q})))}));J.displayName="OpenTimeline";var X=a(119);const Z=i.a.memo((({children:e,onAddTimelinesToFavorites:t,selectedTimelinesCount:a,title:n})=>i.a.createElement(X.a,{title:n,split:!0,height:40},i.a.createElement(h.EuiFlexGroup,{gutterSize:"s",responsive:!1},t&&i.a.createElement(h.EuiFlexItem,{grow:!1},i.a.createElement(h.EuiButton,{"data-test-subj":"favorite-selected",iconSide:"left",iconType:"starEmptySpace",isDisabled:0===a,onClick:t},E.o)),e&&i.a.createElement(h.EuiFlexItem,null,e)))));Z.displayName="TitleRow";const ee=g.a.div.withConfig({displayName:"HeaderContainer",componentId:"sc-1nojoni-0"})(["width:100%;"]);ee.displayName="HeaderContainer";const te=Object(n.memo)((({deleteTimelines:e,defaultPageSize:t,favoriteCount:a,hideActions:r=[],isLoading:s,itemIdToExpandedNotesRowMap:o,onAddTimelinesToFavorites:l,onDeleteSelected:c,onlyFavorites:u,onOpenTimeline:d,onQueryChange:p,onSelectionChange:m,onTableChange:g,onToggleOnlyFavorites:b,onToggleShowNotes:f,pageIndex:y,pageSize:E,searchResults:v,selectedItems:x,sortDirection:k,sortField:S,timelineFilter:j,timelineType:O,templateTimelineFilter:w,title:T,totalSearchResultsCount:I})=>{const C=Object(n.useMemo)((()=>{const t=["createFrom","duplicate"];return null!=c&&null!=e&&t.push("delete"),t.filter((e=>!r.includes(e)))}),[c,e,r]),M=Object(n.useMemo)((()=>i.a.createElement(n.Fragment,{key:"search-row-content"},!!w&&w)),[w]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(h.EuiModalHeader,null,i.a.createElement(ee,null,i.a.createElement(Z,{"data-test-subj":"title-row",onAddTimelinesToFavorites:l,selectedTimelinesCount:x.length,title:T}))),i.a.createElement(h.EuiModalBody,null,i.a.createElement(i.a.Fragment,null,!!j&&i.a.createElement(i.a.Fragment,null,j,i.a.createElement(h.EuiSpacer,{size:"m"})),i.a.createElement(_,{"data-test-subj":"search-row",onlyFavorites:u,onQueryChange:p,onToggleOnlyFavorites:b,query:"",timelineType:O},M),i.a.createElement(K,{actionTimelineToShow:C,"data-test-subj":"timelines-table",deleteTimelines:e,defaultPageSize:t,loading:s,itemIdToExpandedNotesRowMap:o,onOpenTimeline:d,onSelectionChange:m,onTableChange:g,onToggleShowNotes:f,pageIndex:y,pageSize:E,searchResults:v,showExtendedColumns:!1,sortDirection:k,sortField:S,timelineType:O,totalSearchResultsCount:I}))))}));te.displayName="OpenTimelineModalBody";var ae=a(2),ne=a(128);let ie;!function(e){e.tab="tab",e.filter="filter"}(ie||(ie={}));var re=a(77),se=a(857),oe=a(95),le=a(94),ce=a(154),ue=a(179);const de=i.a.memo((({closeModalTimeline:e,defaultPageSize:t,hideActions:a=[],isModal:p=!1,importDataModalToggle:m,onOpenTimeline:g,setImportDataModalToggle:b,title:f})=>{const x=Object(r.useDispatch)(),{startTransaction:k}=Object(ce.a)(),[S,j]=Object(n.useState)({}),[w,T]=Object(n.useState)(!1),[I,C]=Object(n.useState)(0),[M,F]=Object(n.useState)(t),[D,A]=Object(n.useState)(""),[_,N]=Object(n.useState)([]),[R,P]=Object(n.useState)("desc"),[L,q]=Object(n.useState)("updated"),z=Object(n.useMemo)((()=>l.b.getTimelineByIdSelector()),[]),$=Object(s.b)((e=>{var t,a;return null!==(t=null===(a=z(e,o.j.active))||void 0===a?void 0:a.savedObjectId)&&void 0!==t?t:""})),{dataViewId:V,selectedPatterns:U}=Object(le.d)(oe.SourcererScopeName.timeline),H=Object(n.useMemo)((()=>Object(B.b)(x)),[x]),G=Object(n.useCallback)((e=>x(Object(c.updateIsLoading)(e))),[x]),{customTemplateTimelineCount:Q,defaultTimelineCount:W,elasticTemplateTimelineCount:K,favoriteCount:Y,fetchAllTimeline:X,timelines:Z,loading:ee,totalCount:de,templateTimelineCount:pe}=Object(u.b)(),{timelineType:me,timelineTabs:ge,timelineFilters:be}=(({defaultTimelineCount:e,templateTimelineCount:t})=>{const{formatUrl:a,search:r}=Object(ne.n)(ae.a.timelines),{navigateToUrl:s}=Object(re.k)().services.application,{tabName:l}=Object(v.useParams)(),[c,u]=Object(n.useState)(l===o.n.default||l===o.n.template?l:o.n.default),d=a(Object(ne.l)(o.n.default,r)),p=a(Object(ne.l)(o.n.template,r)),m=Object(n.useCallback)((e=>{e.preventDefault(),s(d)}),[s,d]),g=Object(n.useCallback)((e=>{e.preventDefault(),s(p)}),[s,p]),b=Object(n.useCallback)((e=>[{id:o.n.default,name:E.V,href:d,disabled:!1,onClick:e===ie.tab?m:O.noop},{id:o.n.template,name:E.U,href:p,disabled:!1,onClick:e===ie.tab?g:O.noop}]),[d,p,m,g]),f=Object(n.useCallback)(((e,t)=>{u((t=>(t!==e&&u(e),t)))}),[u]),y=Object(n.useMemo)((()=>i.a.createElement(i.a.Fragment,null,i.a.createElement(h.EuiTabs,{"data-test-subj":"open-timeline-subtabs"},b(ie.tab).map((e=>i.a.createElement(h.EuiTab,{"data-test-subj":`timeline-${ie.tab}-${e.id}`,isSelected:e.id===l,disabled:e.disabled,key:`timeline-${ie.tab}-${e.id}`,href:e.href,onClick:t=>{e.onClick(t),f(e.id,ie.tab)}},e.name)))),i.a.createElement(h.EuiSpacer,{size:"m"}))),[l]),x=Object(n.useMemo)((()=>i.a.createElement(h.EuiTabs,null,b(ie.filter).map((e=>i.a.createElement(h.EuiTab,{"data-test-subj":`open-timeline-modal-body-${ie.filter}-${e.id}`,isSelected:e.id===c,key:`timeline-${ie.filter}-${e.id}`,onClick:t=>{e.onClick(t),f(e.id,ie.filter)}},e.name))))),[c,b,f]);return{timelineType:c,timelineTabs:y,timelineFilters:x}})({defaultTimelineCount:W,templateTimelineCount:pe}),{timelineStatus:fe,templateTimelineFilter:ye,installPrepackagedTimelines:he}=Object(se.a)({timelineType:me,customTemplateTimelineCount:Q,elasticTemplateTimelineCount:K}),Ee=Object(n.useCallback)((()=>{X({pageInfo:{pageIndex:I+1,pageSize:M},search:D,sort:{sortField:L,sortOrder:R},onlyUserFavorite:w,timelineType:me,status:fe})}),[X,I,M,D,L,R,me,fe,w]),ve=Object(n.useCallback)((e=>{A(e.queryText.trim())}),[]),xe=Object(n.useCallback)((async e=>{k({name:e.length>1?ue.f.BULK_DELETE:ue.f.DELETE}),e.includes($)&&x(Object(c.createTimeline)({id:o.j.active,columns:d.b,dataViewId:V,indexNames:U,show:!1})),await Object(y.a)(e),Ee()}),[k,$,Ee,x,V,U]),ke=Object(n.useCallback)((async e=>{await xe(e)}),[xe]),Se=Object(n.useCallback)((async()=>{await xe((e=>e.reduce(((e,t)=>null!=t.savedObjectId?[...e,t.savedObjectId]:e),[]))(_)),Ie()}),[_,xe]),je=Object(n.useCallback)((e=>{N(e)}),[]),Oe=Object(n.useCallback)((({page:e,sort:t})=>{const{index:a,size:n}=e,{field:i,direction:r}=t;C(a),F(n),P(r),q(i)}),[]),we=Object(n.useCallback)((()=>{T(!w)}),[w]),Te=Object(n.useCallback)((e=>{j(e)}),[]),Ie=Object(n.useCallback)((()=>{N([])}),[]),Ce=Object(n.useCallback)((({duplicate:t,timelineId:a,timelineType:n})=>{t&&k({name:ue.f.DUPLICATE}),p&&null!=e&&e(),Object(B.h)({duplicate:t,onOpenTimeline:g,timelineId:a,timelineType:n,updateIsLoading:G,updateTimeline:H})}),[G,H]);return Object(n.useEffect)((()=>{(()=>{const e=document.querySelector(`.${B.a} input`);null!=e&&e.focus()})()}),[]),Object(n.useEffect)((()=>{(async()=>{await he(),Ee()})()}),[Ee,he]),p?i.a.createElement(te,{"data-test-subj":"open-timeline-modal",deleteTimelines:ke,defaultPageSize:t,favoriteCount:Y,hideActions:a,isLoading:ee,itemIdToExpandedNotesRowMap:S,onAddTimelinesToFavorites:void 0,onlyFavorites:w,onOpenTimeline:Ce,onQueryChange:ve,onSelectionChange:je,onTableChange:Oe,onToggleOnlyFavorites:we,onToggleShowNotes:Te,pageIndex:I,pageSize:M,query:D,searchResults:Z,selectedItems:_,sortDirection:R,sortField:L,templateTimelineFilter:ye,timelineType:me,timelineStatus:fe,timelineFilter:be,title:f,totalSearchResultsCount:de}):i.a.createElement(J,{"data-test-subj":"open-timeline",deleteTimelines:ke,defaultPageSize:t,favoriteCount:Y,isLoading:ee,itemIdToExpandedNotesRowMap:S,importDataModalToggle:m,onAddTimelinesToFavorites:void 0,onDeleteSelected:Se,onlyFavorites:w,onOpenTimeline:Ce,onQueryChange:ve,onSelectionChange:je,onTableChange:Oe,onToggleOnlyFavorites:we,onToggleShowNotes:Te,pageIndex:I,pageSize:M,query:D,refetch:Ee,searchResults:Z,setImportDataModalToggle:b,selectedItems:_,sortDirection:R,sortField:L,templateTimelineFilter:ye,timelineType:me,timelineStatus:fe,timelineFilter:ge,title:f,totalSearchResultsCount:de})})),pe=i.a.memo(de)},,function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));var n=a(4),i=a(7),r=a(969),s=a.n(r);const o=(e,t)=>null==t?`${Object(i.capitalize)(e)}`:`${Object(i.capitalize)(e)} ${Object(i.capitalize)(t)}`,l=e=>{var t;return null!==(t=s.a.valid(s.a.coerce(e)))&&void 0!==t?t:""},c=(e,t,a)=>`app/integrations/detail/${a?`${e}-${a}`:e}/overview${t?`?integration=${t}`:""}`;var u=a(39);const d=`${a(1).Jb}/fleet/integrations/installed`;var p=a(77);const m=()=>p.b.get().http,g=e=>{const{data:t}=(({packages:e})=>Object(u.useQuery)(["installedIntegrations",{packages:e}],(async({signal:t})=>{var a;return null!==(a=(await(e=>{var t;const{packages:a,signal:n}=e;return m().fetch(d,{method:"GET",query:{packages:null==a||null===(t=a.sort())||void 0===t?void 0:t.join(",")},signal:n})})({packages:e,signal:t})).installed_integrations)&&void 0!==a?a:[]}),{keepPreviousData:!0,staleTime:3e5,onError:e=>{}}))({packages:[]});return Object(n.useMemo)((()=>{const a=((e,t)=>((e,t)=>e.map((e=>{if(null==t)return{related:e,installed:null,isLoaded:!1};{const a=t.find((t=>t.package_name===e.package&&(null==t?void 0:t.integration_name)===(null==e?void 0:e.integration)));return{related:e,installed:null!=a?a:null,isLoaded:!0}}})))(e,t).map((e=>(e=>{var t;const{related:a,installed:n,isLoaded:i}=e,r=a.package,u=null!==(t=a.integration)&&void 0!==t?t:null,d=a.version;if(!i){const e=o(r,u),t=l(d);return{packageName:r,integrationName:u,integrationTitle:e,requiredVersion:d,targetVersion:t,targetUrl:c(r,u,t),installationStatus:{isKnown:!1}}}if(null==n){const e=o(r,u),t=l(d);return{packageName:r,integrationName:u,integrationTitle:e,requiredVersion:d,targetVersion:t,targetUrl:c(r,u,t),installationStatus:{isKnown:!0,isInstalled:!1,isEnabled:!1,isVersionMismatch:!1,installedVersion:""}}}{var p;const e=null!==(p=n.integration_title)&&void 0!==p?p:n.package_title,t=n.package_version,a=s.a.satisfies(t,d),i=a?t:l(d);return{packageName:r,integrationName:u,integrationTitle:e,requiredVersion:d,targetVersion:i,targetUrl:c(r,u,i),installationStatus:{isKnown:!0,isInstalled:!0,isEnabled:n.is_enabled,isVersionMismatch:!a,installedVersion:t}}}})(e))).sort(((e,t)=>e.integrationTitle.localeCompare(t.integrationTitle))))(e,t);return{integrations:a,isLoaded:null!=t}}),[e,t])}},function(e,t,a){"use strict";a.d(t,"a",(function(){return O})),a.d(t,"c",(function(){return h})),a.d(t,"b",(function(){return ie})),a.d(t,"d",(function(){return ce}));var n=a(50),i=a(34),r=a(4),s=a.n(r),o=a(104),l=a(646),c=a(32),u=a(501),d=a(360),p=a(645);const m=({showAlertDetails:e,isolateAction:t})=>s.a.createElement(s.a.Fragment,null,s.a.createElement(c.EuiButtonEmpty,{iconType:"arrowLeft",iconSide:"left",flush:"left",onClick:e},s.a.createElement(c.EuiText,{size:"xs"},s.a.createElement("p",null,p.a))),s.a.createElement(c.EuiTitle,null,s.a.createElement("h2",null,"isolateHost"===t?d.b:d.d))),g=s.a.memo(m),b=({eventId:e,isAlert:t,isHostIsolationPanelOpen:a,isolateAction:n,loading:i,ruleName:r,showAlertDetails:o,timestamp:l})=>s.a.createElement(s.a.Fragment,null,a?s.a.createElement(g,{isolateAction:n,showAlertDetails:o}):s.a.createElement(u.b,{eventId:e,isAlert:t,loading:i,ruleName:r,timestamp:l})),f=s.a.memo(b),y=({eventId:e,isAlert:t,isHostIsolationPanelOpen:a,isolateAction:n,loading:i,ruleName:r,showAlertDetails:o,timestamp:l})=>s.a.createElement(c.EuiFlyoutHeader,{hasBorder:a},s.a.createElement(b,{eventId:e,isAlert:t,isHostIsolationPanelOpen:a,isolateAction:n,loading:i,ruleName:r,showAlertDetails:o,timestamp:l})),h=s.a.memo(y);var E=a(33),v=a.n(E),x=a(246),k=a(700);const S=v()(c.EuiFlyoutBody).withConfig({displayName:"StyledEuiFlyoutBody",componentId:"sc-1yky9hy-0"})([".euiFlyoutBody__overflow{display:flex;flex:1;overflow:hidden;.euiFlyoutBody__overflowContent{flex:1;overflow:hidden;padding:",";}}"],(({theme:e})=>`0 ${e.eui.euiSizeM} ${e.eui.euiSizeM}`)),j=({alertId:e,browserFields:t,detailsData:a,detailsEcsData:n,event:i,handleIsolationActionSuccess:r,handleOnEventClosed:o,hostName:l,isAlert:c,isDraggable:d,isReadOnly:p,isolateAction:m,isHostIsolationPanelOpen:g,isIsolateActionSuccessBannerVisible:b,loading:f,rawEventData:y,showAlertDetails:h,scopeId:E})=>s.a.createElement(S,null,b&&s.a.createElement(x.d,{hostName:l,alertId:e,isolateAction:m}),g?s.a.createElement(k.a,{details:a,cancelCallback:h,successCallback:r,isolateAction:m}):s.a.createElement(u.a,{browserFields:t,detailsData:a,detailsEcsData:n,event:i,isAlert:c,isDraggable:d,loading:f,rawEventData:y,scopeId:E,timelineTabType:"flyout",handleOnEventClosed:o,isReadOnly:p})),O=s.a.memo(j);var w=a(82),T=a.n(w),I=a(78),C=a(99),M=a(316),F=a(205),D=a(116),A=a(289),_=a(35),N=a(926);const R=Object(r.memo)((({endpointId:e,onClick:t})=>{const{handleResponseActionsClick:a,isDisabled:n,tooltip:i}=Object(N.a)({endpointId:e,onClick:t});return s.a.createElement(c.EuiContextMenuItem,{key:"endpointResponseActions-action-item","data-test-subj":"endpointResponseActions-action-item",disabled:n,toolTipContent:i,size:"s",onClick:a},s.a.createElement(_.FormattedMessage,{id:"xpack.securitySolution.endpoint.detections.takeAction.responseActionConsole.buttonLabel",defaultMessage:"Respond"}))}));R.displayName="ResponderContextMenuItem";var P=a(107),L=a(298),B=a(648),q=a(649),z=a(472),$=a(650),V=a(652),U=a(653),H=a(142),G=a(637),Q=a(714),W=a(77),K=a(654);const Y=s.a.memo((({detailsData:e,ecsData:t,handleOnEventClosed:a,indexName:n,isHostIsolationPanelOpen:i,loadingEventDetails:l,onAddEventFilterClick:u,onAddExceptionTypeClick:p,onAddIsolationStatusClick:m,refetch:g,refetchFlyoutData:b,onOsqueryClick:f,scopeId:y})=>{var h;const E=Object(P.a)("tGridEnabled"),{loading:v,canAccessEndpointManagement:x}=Object(D.a)().endpointPrivileges,k=Object(r.useMemo)((()=>!v&&x),[x,v]),{osquery:S}=Object(W.k)().services,[j,O]=Object(r.useState)(!1),w=Object(r.useMemo)((()=>[{category:"kibana",field:"kibana.alert.rule.uuid",name:"ruleId"},{category:"kibana",field:"kibana.alert.rule.name",name:"ruleName"},{category:"kibana",field:"kibana.alert.workflow_status",name:"alertStatus"},{category:"event",field:"event.kind",name:"eventKind"},{category:"_id",field:"_id",name:"eventId"}].reduce(((t,a)=>({...t,[a.name]:Object(L.a)({category:a.category,field:a.field},e)})),{})),[e]),T="event"===w.eventKind,I=Object(r.useMemo)((()=>{var e,a;return null==t||null===(e=t.agent)||void 0===e||null===(a=e.type)||void 0===a?void 0:a.includes("endpoint")}),[t]),_=Object(r.useMemo)((()=>T&&I),[T,I]),N=Object(r.useMemo)((()=>Object(L.a)({category:"agent",field:"agent.id"},e)),[e]),Y=Object(r.useCallback)((()=>{O(!j)}),[j]),J=Object(r.useCallback)((()=>{O(!1)}),[]),X=Object(r.useCallback)((()=>{a(),O(!1)}),[a]),Z=Object(r.useCallback)((e=>{m(e),O(!1)}),[m]),ee=(({closePopover:e,detailsData:t,isHostIsolationPanelOpen:a,onAddIsolationStatusClick:n})=>{const i=Object(r.useMemo)((()=>Object(A.b)({data:t||[]})),[t]),o=Object(r.useMemo)((()=>Object(L.a)({category:"agent",field:"agent.id"},t)),[t]),l=Object(r.useMemo)((()=>Object(L.a)({category:"host",field:"host.os.name"},t)),[t]),u=Object(r.useMemo)((()=>Object(L.a)({category:"agent",field:"agent.version"},t)),[t]),{loading:p,isIsolated:m,agentStatus:g,capabilities:b}=Object(G.a)({agentId:o}),f=Object(r.useMemo)((()=>!!i&&Object(U.a)({osName:l,version:u,capabilities:b})),[u,b,l,i]),y=Object(D.a)().endpointPrivileges.canIsolateHost,h=Object(r.useCallback)((()=>{e(),n(!1===m?"isolateHost":"unisolateHost")}),[e,m,n]),E=!1===m?d.b:d.d;return Object(r.useMemo)((()=>y&&i&&f&&!1===a&&!1===p?[s.a.createElement(c.EuiContextMenuItem,{key:"isolate-host-action-item","data-test-subj":"isolate-host-action-item",disabled:g===H.b.UNENROLLED,onClick:h},E)]:[]),[g,i,a,y,h,E,f,p])})({closePopover:J,detailsData:e,onAddIsolationStatusClick:Z,isHostIsolationPanelOpen:i}),te=((e,t)=>{const a=Object(P.a)("responseActionsConsoleEnabled"),{loading:n,canAccessResponseConsole:i}=Object(D.a)().endpointPrivileges,o=Object(r.useMemo)((()=>Object(A.c)(e||[])),[e]),l=Object(r.useMemo)((()=>Object(A.b)({data:e||[]})),[e]),c=Object(r.useMemo)((()=>Object(L.a)({category:"agent",field:"agent.id"},e)),[e]);return Object(r.useMemo)((()=>{const e=[];return a&&!n&&i&&o&&e.push(s.a.createElement(R,{key:"endpointResponseActions-action-item",endpointId:l?c:"",onClick:t})),e}),[i,c,o,n,l,a,t])})(e,J),ae=Object(r.useCallback)((e=>{p(e),O(!1)}),[p]),{exceptionActionItems:ne}=Object(q.a)({isEndpointAlert:Object(A.a)({ecsData:t}),onAddExceptionTypeClick:ae}),ie=Object(r.useCallback)((()=>{u(),O(!1)}),[u]),{eventFilterActionItems:re}=Object(V.a)({onAddEventFilterClick:ie,disabled:!_||!k}),se=Object(r.useCallback)((()=>{J()}),[J]),{actionItems:oe}=Object(z.a)({alertStatus:w.alertStatus,closePopover:X,eventId:w.eventId,indexName:n,refetch:g,scopeId:y}),{investigateInTimelineActionItems:le}=Object($.a)({ecsRowData:t,onInvestigateInTimelineAlertClick:J}),ce=null==S?void 0:S.isOsqueryAvailable({agentId:N}),ue=Object(r.useCallback)((()=>{f(N),O(!1)}),[f,O,N]),de=Object(r.useMemo)((()=>Object(K.a)({handleClick:ue})),[ue]),pe=Object(r.useMemo)((()=>!T&&w.ruleId?[...oe,...ne]:_?re:[]),[re,_,ne,oe,T,w.ruleId]),me=[o.c.alertsOnAlertsPage,o.c.alertsOnRuleDetailsPage].includes(y),{addToCaseActionItems:ge,handleAddToNewCaseClick:be}=Object(Q.a)({ecsData:t,nonEcsData:null!==(h=null==e?void 0:e.map((e=>({field:e.field,value:e.values}))))&&void 0!==h?h:[],onMenuItemClick:se,onSuccess:b,isActiveTimelines:Object(C.isActiveTimeline)(y),isInDetections:me}),fe=Object(r.useMemo)((()=>[...E?ge:[],...pe,...ee,...te,...ce?[de]:[],...le]),[E,ge,pe,ee,te,ce,de,le]),ye=Object(r.useMemo)((()=>s.a.createElement(M.a,{onClick:be,step:F.a.addAlertToCase,tourId:F.b.alertsCases},s.a.createElement(c.EuiButton,{"data-test-subj":"take-action-dropdown-btn",fill:!0,iconSide:"right",iconType:"arrowDown",onClick:Y},B.d))),[be,Y]);return fe.length&&!l&&t?s.a.createElement(c.EuiPopover,{id:"AlertTakeActionPanel",button:ye,isOpen:j,closePopover:J,panelPaddingSize:"none",anchorPosition:"downLeft",repositionOnScroll:!0},s.a.createElement(c.EuiContextMenuPanel,{"data-test-subj":"takeActionPanelMenu",size:"s",items:fe})):null}));var J=a(655),X=a(705),Z=a(706),ee=a(688),te=a(98),ae=a(511);const ne=s.a.memo((({detailsData:e,detailsEcsData:t,expandedEvent:a,handleOnEventClosed:n,isHostIsolationPanelOpen:o,isReadOnly:l,loadingEventDetails:u,onAddIsolationStatusClick:d,scopeId:p,globalQuery:m,timelineQuery:g,refetchFlyoutData:b})=>{var f;const y=null!=t&&null!==(f=t.kibana)&&void 0!==f&&f.alert?null==t?void 0:t._id:null,h=Object(r.useMemo)((()=>{var t,a,n;return null!==(t=null===(a=Object(i.find)({category:"signal",field:"signal.rule.index"},e))||void 0===a?void 0:a.values)&&void 0!==t?t:null===(n=Object(i.find)({category:"kibana",field:"kibana.alert.rule.parameters.index"},e))||void 0===n?void 0:n.values}),[e]),E=Object(r.useMemo)((()=>Array.isArray(h)?h:void 0),[h]),v=Object(r.useMemo)((()=>{var t,a,n;return null!==(t=null===(a=Object(i.find)({category:"signal",field:"signal.rule.data_view_id"},e))||void 0===a?void 0:a.values)&&void 0!==t?t:null===(n=Object(i.find)({category:"kibana",field:"kibana.alert.rule.parameters.data_view_id"},e))||void 0===n?void 0:n.values}),[e]),x=Object(r.useMemo)((()=>Array.isArray(v)?v[0]:void 0),[v]),k=Object(r.useMemo)((()=>[{category:"signal",field:"signal.rule.id",name:"ruleId"},{category:"signal",field:"signal.rule.rule_id",name:"ruleRuleId"},{category:"signal",field:"signal.rule.name",name:"ruleName"},{category:"signal",field:"kibana.alert.workflow_status",name:"alertStatus"},{category:"_id",field:"_id",name:"eventId"}].reduce(((t,a)=>({...t,[a.name]:Object(L.a)({category:a.category,field:a.field},e)})),{})),[e]),S=e=>{e.forEach((e=>e.refetch&&e.refetch()))},j=Object(r.useCallback)((()=>{Object(C.isActiveTimeline)(p)?S([g]):S(m)}),[p,g,m]),{exceptionFlyoutType:O,openAddExceptionFlyout:w,onAddExceptionTypeClick:I,onAddExceptionCancel:M,onAddExceptionConfirm:F}=Object(J.a)({refetch:j,isActiveTimelines:Object(C.isActiveTimeline)(p)}),{closeAddEventFilterModal:D,isAddEventFilterModalOpen:A,onAddEventFilterClick:_}=Object(ee.a)(),[N,R]=Object(r.useState)(null),P=Object(r.useCallback)((()=>{R(null)}),[R]);return l?null:s.a.createElement(s.a.Fragment,null,s.a.createElement(c.EuiFlyoutFooter,{"data-test-subj":"side-panel-flyout-footer"},s.a.createElement(c.EuiFlexGroup,{justifyContent:"flexEnd"},s.a.createElement(c.EuiFlexItem,{grow:!1},t&&s.a.createElement(Y,{detailsData:e,ecsData:t,handleOnEventClosed:n,isHostIsolationPanelOpen:o,loadingEventDetails:u,onAddEventFilterClick:_,onAddExceptionTypeClick:I,onAddIsolationStatusClick:d,refetchFlyoutData:b,refetch:j,indexName:a.indexName,scopeId:p,onOsqueryClick:R})))),w&&null!=k.ruleId&&null!=k.ruleRuleId&&null!=k.eventId&&s.a.createElement(X.a,T()({},k,{ruleIndices:E,ruleDataViewId:x,exceptionListType:O,onCancel:M,onConfirm:F})),A&&null!=t&&s.a.createElement(Z.a,{data:t,onCancel:D,maskProps:{style:"z-index: 5000"}}),N&&null!=t&&s.a.createElement(ae.a,{agentId:N,defaultValues:y?{alertIds:[y]}:void 0,onClose:P,ecsData:t}))})),ie=Object(I.connect)((()=>{const e=te.d.globalQuery(),t=te.d.timelineQueryByIdSelector();return(a,{scopeId:n})=>({globalQuery:e(a),timelineQuery:t(a,n)})}))(s.a.memo(ne));var re=a(590),se=a(94),oe=a(95),le=a(352);const ce=()=>{var e,t;const{browserFields:a,runtimeMappings:c}=Object(se.d)(oe.SourcererScopeName.detections),[u,d]=Object(r.useState)({id:void 0,indexName:void 0}),[p,m,g,b,y]=Object(re.a)({entityType:n.EntityType.EVENTS,indexName:null!==(e=u.indexName)&&void 0!==e?e:"",eventId:null!==(t=u.id)&&void 0!==t?t:"",runtimeMappings:c,skip:!u.id}),{alertId:h,isAlert:E,hostName:v,ruleName:x,timestamp:k}=Object(le.b)(m),{isolateAction:S,isHostIsolationPanelOpen:j,isIsolateActionSuccessBannerVisible:w,handleIsolationActionSuccess:T,showAlertDetails:I,showHostIsolationPanel:C}=Object(l.a)(),M=Object(r.useCallback)((({isLoading:e,alert:t})=>(d((e=>e.id!==t._id?{id:t._id,indexName:t._index}:e)),s.a.createElement(O,{alertId:h,browserFields:a,detailsData:m,detailsEcsData:b,event:{eventId:t._id,indexName:t._index},hostName:null!=v?v:"",handleIsolationActionSuccess:T,handleOnEventClosed:i.noop,isAlert:E,isDraggable:!1,isolateAction:S,isIsolateActionSuccessBannerVisible:w,isHostIsolationPanelOpen:j,loading:e||p,rawEventData:g,showAlertDetails:I,scopeId:o.d.casePage,isReadOnly:!1}))),[h,a,m,b,T,v,E,j,w,S,p,g,I]),F=Object(r.useCallback)((({isLoading:e})=>s.a.createElement(f,{isHostIsolationPanelOpen:j,isAlert:E,eventId:h,isolateAction:S,loading:e||p,ruleName:x,showAlertDetails:I,timestamp:k})),[E,h,j,S,p,x,I,k]),D=Object(r.useCallback)((({isLoading:e,alert:t})=>s.a.createElement(ie,{detailsData:m,detailsEcsData:b,expandedEvent:{eventId:t._id,indexName:t._index},refetchFlyoutData:y,handleOnEventClosed:i.noop,isHostIsolationPanelOpen:j,isReadOnly:!1,loadingEventDetails:e||p,onAddIsolationStatusClick:C,scopeId:o.d.casePage})),[m,b,j,p,y,C]);return Object(r.useMemo)((()=>({body:M,header:F,footer:D})),[M,F,D])}},function(e,t,a){"use strict";a.d(t,"b",(function(){return be})),a.d(t,"a",(function(){return Me}));var n=a(32),i=a(4),r=a.n(i),s=a(34),o=a(78),l=a(33),c=a.n(l),u=a(35),d=a(42),p=a(90),m=a(81),g=a(79),b=a(86),f=a(112),y=a(387),h=a(1),E=a(12),v=a(77),x=a(128),k=a(2),S=a(242);const j=({timelineId:e})=>{const t=Object(i.useMemo)((()=>b.b.getTimelineByIdSelector()),[]),{cases:a,application:{navigateToApp:l}}=Object(v.k)().services,c=Object(o.useDispatch)(),{graphEventId:u,savedObjectId:d,status:p,title:y,timelineType:j}=Object(m.a)((a=>{var n;return Object(s.pick)(["graphEventId","savedObjectId","status","title","timelineType"],null!==(n=t(a,e))&&void 0!==n?n:f.b)})),[O,w]=Object(i.useState)(!1),[T,I]=Object(i.useState)(!1),C=Object(i.useCallback)((async t=>{I(!1),await l(h.B,{deepLinkId:k.a.case,path:null!=t?Object(x.c)({id:t.id}):Object(x.d)()}),c(Object(E.setInsertTimeline)({graphEventId:u,timelineId:e,timelineSavedObjectId:d,timelineTitle:y}))}),[c,u,l,d,e,y]),M=Object(v.i)(),F=Object(i.useCallback)((()=>{w((e=>!e))}),[]),D=Object(i.useCallback)((()=>w(!1)),[]),A=Object(i.useCallback)((()=>{D(),l(h.B,{deepLinkId:k.a.case,path:Object(x.d)()}).then((()=>{c(Object(E.setInsertTimeline)({graphEventId:u,timelineId:e,timelineSavedObjectId:d,timelineTitle:y.length>0?y:S.l})),c(Object(E.showTimeline)({id:g.j.active,show:!1}))}))}),[c,u,l,D,d,e,y]),_=Object(i.useCallback)((()=>{D(),I(!0)}),[I,D]),N=Object(i.useCallback)((()=>{I(!1)}),[I]),R=Object(i.useCallback)((()=>{w(!1)}),[]),P=Object(i.useMemo)((()=>r.a.createElement(n.EuiButton,{fill:!0,size:"m","data-test-subj":"attach-timeline-case-button",iconType:"arrowDown",iconSide:"right",onClick:F,disabled:p===g.l.draft||j!==g.n.default},S.c)),[F,p,j]),L=Object(i.useMemo)((()=>[r.a.createElement(n.EuiContextMenuItem,{key:"new-case","data-test-subj":"attach-timeline-new-case",onClick:A},S.e),r.a.createElement(n.EuiContextMenuItem,{key:"existing-case","data-test-subj":"attach-timeline-existing-case",onClick:_},S.d)]),[_,A]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(n.EuiPopover,{id:"singlePanel",button:P,isOpen:O,closePopover:R,panelPaddingSize:"none",anchorPosition:"downLeft"},r.a.createElement(n.EuiContextMenuPanel,{items:L})),T&&a.ui.getAllCasesSelectorModal({onRowClick:C,onClose:N,owner:[h.p],permissions:M}))};j.displayName="AddToCaseButtonComponent";const O=r.a.memo(j);var w=a(715),T=a(701),I=a(124),C=a(92),M=a.n(C),F=a(11),D=a(48),A=a(85),_=a(84),N=a(0);const R=N.i18n.translate("xpack.securitySolution.timeline.kpiFailDescription",{defaultMessage:"An error has occurred"}),P=N.i18n.translate("xpack.securitySolution.timeline.kpiFailSearchDescription",{defaultMessage:"Failed to load KPIs"});var L=a(94),B=a(149),q=a(123),z=a(146),$=a(95),V=a(529);const U=e=>N.i18n.translate("xpack.securitySolution.timeline.flyout.header.closeTimelineButtonLabel",{defaultMessage:"Close {isTimeline, select, true {timeline} false {template}}",values:{isTimeline:e}}),H=N.i18n.translate("xpack.securitySolution.timeline.properties.unsavedLabel",{defaultMessage:"Unsaved"}),G=N.i18n.translate("xpack.securitySolution.timeline.properties.autosavedLabel",{defaultMessage:"Autosaved"}),Q=N.i18n.translate("xpack.securitySolution.timeline.properties.inspectTimelineTitle",{defaultMessage:"Timeline"}),W=N.i18n.translate("xpack.securitySolution.timeline.kpis.processKpiTitle",{defaultMessage:"Processes"}),K=N.i18n.translate("xpack.securitySolution.timeline.kpis.hostKpiTitle",{defaultMessage:"Hosts"}),Y=N.i18n.translate("xpack.securitySolution.timeline.kpis.sourceIpKpiTitle",{defaultMessage:"Source IPs"}),J=N.i18n.translate("xpack.securitySolution.timeline.kpis.destinationKpiTitle",{defaultMessage:"Destination IPs"}),X=N.i18n.translate("xpack.securitySolution.timeline.kpis.userKpiTitle",{defaultMessage:"Users"}),Z=N.i18n.translate("xpack.securitySolution.timeline.properties.readMore",{defaultMessage:"Read More"}),ee=({isOpen:e,title:t})=>N.i18n.translate("xpack.securitySolution.timeline.properties.timelineToggleButtonAriaLabel",{values:{isOpen:e,title:t},defaultMessage:"{isOpen, select, false {Open} true {Close} other {Toggle}} timeline {title}"}),te=c()(n.EuiHealth).withConfig({displayName:"EuiHealthStyled",componentId:"sc-4g9vxo-0"})(["display:block;"]),ae=c()(n.EuiButtonEmpty).withConfig({displayName:"StyledEuiButtonEmpty",componentId:"sc-4g9vxo-1"})(["> span{padding:0;}"]),ne=c()(n.EuiFlexItem).withConfig({displayName:"TitleConatiner",componentId:"sc-4g9vxo-2"})(["overflow:hidden;display:inline-block;text-overflow:ellipsis;"]),ie=({timelineId:e,timelineStatus:t,timelineType:a,timelineTitle:l,updated:c,isOpen:d})=>{const p=Object(o.useDispatch)(),m=Object(i.useCallback)((()=>{p(b.a.showTimeline({id:e,show:!d})),Object(q.i)()}),[p,d,e]),f=Object(s.isEmpty)(l)?a===g.n.template?S.k:S.l:l,y=Object(i.useMemo)((()=>t===g.l.draft?r.a.createElement(r.a.Fragment,null,H):r.a.createElement(r.a.Fragment,null,G," ",r.a.createElement(u.FormattedRelative,{"data-test-subj":"timeline-status",key:"timeline-status-autosaved",value:new Date(c)}))),[t,c]);return r.a.createElement(ae,{"aria-label":ee({isOpen:d,title:f}),className:q.b,flush:"both","data-test-subj":"flyoutOverlay",size:"s",isSelected:d,onClick:m},r.a.createElement(n.EuiFlexGroup,{gutterSize:"none",alignItems:"center",justifyContent:"flexStart",responsive:!1},r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiToolTip,{position:"top",content:y},r.a.createElement(te,{color:t===g.l.draft?"warning":"success"}))),r.a.createElement(ne,{grow:!1},f),!d&&r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(V.b,null))))},re=r.a.memo(ie);var se=a(108),oe=a(44),le=a.n(oe),ce=a(87);const ue=c()(n.EuiStat).withConfig({displayName:"NoWrapEuiStat",componentId:"sc-9jxvke-0"})(["& .euiStat__description{white-space:nowrap;}"]),de=r.a.memo((({kpis:e,isLoading:t})=>{const a="0,0.[000]a",[s]=Object(v.q)(h.Z),o=Object(i.useMemo)((()=>({process:null===e?Object(ce.e)():le()(e.processCount).format(a),user:null===e?Object(ce.e)():le()(e.userCount).format(a),host:null===e?Object(ce.e)():le()(e.hostCount).format(a),sourceIp:null===e?Object(ce.e)():le()(e.sourceIpCount).format(a),destinationIp:null===e?Object(ce.e)():le()(e.destinationIpCount).format(a)})),[e]),l=Object(i.useMemo)((()=>({process:le()(null==e?void 0:e.processCount).format(s),user:le()(null==e?void 0:e.userCount).format(s),host:le()(null==e?void 0:e.hostCount).format(s),sourceIp:le()(null==e?void 0:e.sourceIpCount).format(s),destinationIp:le()(null==e?void 0:e.destinationIpCount).format(s)})),[e,s]);return r.a.createElement(n.EuiFlexGroup,{wrap:!0,"data-test-subj":"siem-timeline-kpis"},r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiToolTip,{position:"left",content:l.process},r.a.createElement(ue,{"data-test-subj":"siem-timeline-process-kpi",title:o.process,description:W,titleSize:"s",isLoading:t}))),r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiToolTip,{position:"left",content:l.user},r.a.createElement(ue,{"data-test-subj":"siem-timeline-user-kpi",title:o.user,description:X,titleSize:"s",isLoading:t}))),r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiToolTip,{position:"left",content:l.host},r.a.createElement(ue,{"data-test-subj":"siem-timeline-host-kpi",title:o.host,description:K,titleSize:"s",isLoading:t}))),r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiToolTip,{position:"left",content:l.sourceIp},r.a.createElement(ue,{"data-test-subj":"siem-timeline-source-ip-kpi",title:o.sourceIp,description:Y,titleSize:"s",isLoading:t}))),r.a.createElement(n.EuiFlexItem,{grow:!1,style:{minWidth:100}},r.a.createElement(n.EuiToolTip,{position:"left",content:l.destinationIp},r.a.createElement(ue,{"data-test-subj":"siem-timeline-destination-ip-kpi",title:o.destinationIp,description:J,titleSize:"s",isLoading:t}))))}));de.displayName="TimelineKPIs";var pe=a(613);const me=c()(n.EuiFlexItem).withConfig({displayName:"ActiveTimelinesContainer",componentId:"sc-12xgwp3-0"})(["overflow:hidden;"]),ge=({timelineId:e})=>{const t=Object(o.useDispatch)(),{browserFields:a,indexPattern:l}=Object(L.d)($.SourcererScopeName.timeline),{uiSettings:c}=Object(v.k)().services,u=Object(i.useMemo)((()=>Object(d.getEsQueryConfig)(c)),[c]),y=Object(i.useMemo)((()=>b.b.getTimelineByIdSelector()),[]),{activeTab:h,dataProviders:E,kqlQuery:x,title:k,timelineType:S,status:j,updated:O,show:T,filters:C,kqlMode:M}=Object(m.a)((t=>{var a;return Object(s.pick)(["activeTab","dataProviders","kqlQuery","status","title","timelineType","updated","show","filters","kqlMode"],null!==(a=y(t,e))&&void 0!==a?a:f.b)})),F=Object(i.useMemo)((()=>!Object(s.isEmpty)(E)||!Object(s.isEmpty)(Object(s.get)("filterQuery.kuery.expression",x))),[E,x]),D=Object(i.useMemo)((()=>b.b.getKqlFilterQuerySelector()),[]),A=Object(o.useSelector)((t=>D(t,e))),_=Object(s.isEmpty)(E)&&Object(s.isEmpty)(A)&&"template"===S?" ":A,N=Object(i.useMemo)((()=>({query:_,language:"kuery"})),[_]),R=Object(i.useMemo)((()=>Object(z.a)({config:u,dataProviders:E,indexPattern:l,browserFields:a,filters:C||[],kqlQuery:N,kqlMode:M})),[a,E,u,C,l,M,N]),P=Object(i.useCallback)((()=>{t(b.a.showTimeline({id:e,show:!1})),Object(q.i)()}),[t,e]),{euiTheme:B}=Object(n.useEuiTheme)();return r.a.createElement(n.EuiPanel,{borderRadius:"none",grow:!1,paddingSize:"s",hasShadow:!1,"data-test-subj":"timeline-flyout-header-panel",style:{backgroundColor:B.colors.emptyShade,color:B.colors.text}},r.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1},r.a.createElement(w.b,{timelineId:e}),r.a.createElement(me,{grow:!1},r.a.createElement(re,{timelineId:e,timelineType:S,timelineTitle:k,timelineStatus:j,isOpen:T,updated:O})),T&&r.a.createElement(n.EuiFlexItem,null,r.a.createElement(n.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s",responsive:!1},(h===g.m.query||h===g.m.eql)&&r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(I.b,{compact:!0,queryId:`${e}-${h}`,inputId:p.a.timeline,inspectIndex:0,isDisabled:!F||void 0===(null==R?void 0:R.filterQuery),title:Q})),r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiToolTip,{content:U("default"===S)},r.a.createElement(n.EuiButtonIcon,{"aria-label":U("default"===S),"data-test-subj":"close-timeline",iconType:"cross",onClick:P})))))))},be=r.a.memo(ge),fe=c.a.div.withConfig({displayName:"StyledDiv",componentId:"sc-12xgwp3-1"})(["display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;overflow:hidden;word-break:break-word;"]),ye=({description:e,onclick:t})=>{const[a,i]=Object(pe.a)(e);return r.a.createElement(r.a.Fragment,null,r.a.createElement(fe,{ref:i},e),a&&r.a.createElement(n.EuiButtonEmpty,{flush:"left",onClick:t},Z))},he=c()(n.EuiFlexGroup).withConfig({displayName:"StyledTimelineHeader",componentId:"sc-12xgwp3-2"})([""," flex:0;"],(({theme:e})=>`margin: ${e.eui.euiSizeXS} ${e.eui.euiSizeS} 0 ${e.eui.euiSizeS};`)),Ee=c.a.span.withConfig({displayName:"TimelineStatusInfoContainer",componentId:"sc-12xgwp3-3"})([""," white-space:nowrap;"],(({theme:e})=>`margin-left: ${e.eui.euiSizeS};`)),ve=c.a.div.withConfig({displayName:"KpisContainer",componentId:"sc-12xgwp3-4"})(["",""],(({theme:e})=>`margin-right: ${e.eui.euiSizeM};`)),xe=c()(n.EuiFlexItem).withConfig({displayName:"RowFlexItem",componentId:"sc-12xgwp3-5"})(["flex-direction:row;align-items:center;"]),ke=c.a.h3.withConfig({displayName:"TimelineTitleContainer",componentId:"sc-12xgwp3-6"})(["display:-webkit-box;overflow:hidden;-webkit-line-clamp:1;-webkit-box-orient:vertical;word-break:break-word;"]),Se=({timelineId:e})=>{const t=Object(i.useMemo)((()=>b.b.getTimelineByIdSelector()),[]),{title:a,timelineType:o}=Object(m.a)((a=>{var n;return Object(s.pick)(["title","timelineType"],null!==(n=t(a,e))&&void 0!==n?n:f.b)})),l=Object(i.useMemo)((()=>o===g.n.template?S.k:S.l),[o]),c=Object(i.useMemo)((()=>a||l),[a,l]);return r.a.createElement(n.EuiToolTip,{content:c,position:"bottom"},r.a.createElement(n.EuiText,null,r.a.createElement(ke,{"data-test-subj":"timeline-title"},c)))},je=r.a.memo(Se),Oe=({timelineId:e})=>{const t=Object(i.useMemo)((()=>b.b.getTimelineByIdSelector()),[]),a=Object(m.a)((a=>{var n;return(null!==(n=t(a,e))&&void 0!==n?n:f.b).description})),s=Object(o.useDispatch)(),l=Object(i.useCallback)((t=>{s(Object(E.setActiveTabTimeline)({id:e,activeTab:g.m.notes,scrollToTop:!0}))}),[s,e]);return r.a.createElement(n.EuiText,{size:"s","data-test-subj":"timeline-description"},r.a.createElement(ye,{description:a||S.f,onclick:l}))},we=r.a.memo(Oe),Te=({timelineId:e})=>{const t=Object(i.useMemo)((()=>Object(se.createSelector)(b.b.selectTimeline,(e=>{var t,a;return{status:null!==(t=null==e?void 0:e.status)&&void 0!==t?t:g.l.draft,updated:null!==(a=null==e?void 0:e.updated)&&void 0!==a?a:void 0}}))),[]),{status:a,updated:s}=Object(m.a)((a=>t(a,e)));return Object(i.useMemo)((()=>a===g.l.draft),[a])?r.a.createElement(n.EuiText,{size:"xs"},r.a.createElement(n.EuiTextColor,{color:"warning","data-test-subj":"timeline-status"},H)):r.a.createElement(n.EuiText,{size:"xs"},r.a.createElement(n.EuiTextColor,{color:"default"},G," ",r.a.createElement(u.FormattedRelative,{"data-test-subj":"timeline-status",key:"timeline-status-autosaved",value:new Date(s)})))},Ie=r.a.memo(Te),Ce=({timelineId:e})=>{var t;const{selectedPatterns:a,indexPattern:l,browserFields:c}=Object(L.d)($.SourcererScopeName.timeline),u=Object(i.useMemo)((()=>Object(B.i)()),[]),p=Object(i.useMemo)((()=>Object(B.b)()),[]),h=Object(i.useMemo)((()=>e===g.j.active),[e]),E=Object(m.a)((e=>h?{from:u(e.inputs.timeline),to:p(e.inputs.timeline),interval:""}:{from:u(e.inputs.global),to:p(e.inputs.global),interval:""})),{uiSettings:x}=Object(v.k)().services,k=Object(i.useMemo)((()=>Object(d.getEsQueryConfig)(x)),[x]),S=Object(i.useMemo)((()=>b.b.getTimelineByIdSelector()),[]),j=Object(o.useSelector)((t=>{var a;return null!==(a=S(t,e))&&void 0!==a?a:f.b})),{dataProviders:w,filters:I,timelineType:C,kqlMode:N,activeTab:q}=j,V=Object(i.useMemo)((()=>b.b.getKqlFilterQuerySelector()),[]),U=Object(o.useSelector)((t=>V(t,e))),H=Object(s.isEmpty)(w)&&Object(s.isEmpty)(U)&&"template"===C?" ":U,G=Object(i.useMemo)((()=>({query:H,language:"kuery"})),[H]),Q=Object(i.useMemo)((()=>Object(z.a)({config:k,dataProviders:w,indexPattern:l,browserFields:c,filters:I||[],kqlQuery:G,kqlMode:N})),[c,w,k,I,l,N,G]),W=Object(i.useMemo)((()=>Object(s.isEmpty)(w)&&Object(s.isEmpty)(I)&&Object(s.isEmpty)(G.query)||void 0===(null==Q?void 0:Q.filterQuery)),[w,I,G,Q]),[K,Y]=(({timerange:e,filterQuery:t,defaultIndex:a,isBlankTimeline:n})=>{const{data:r}=Object(v.k)().services,o=Object(i.useRef)(s.noop),l=Object(i.useRef)(new AbortController),c=Object(i.useRef)(new F.Subscription),[u,d]=Object(i.useState)(!1),[p,m]=Object(i.useState)(null),[g,b]=Object(i.useState)(null),{addError:f,addWarning:y}=Object(_.a)(),h=Object(i.useCallback)((e=>{if(null==e)return;const t=async()=>{l.current=new AbortController,d(!0),c.current=r.search.search(e,{strategy:"timelineSearchStrategy",abortSignal:l.current.signal}).subscribe({next:e=>{Object(D.isCompleteResponse)(e)?(d(!1),b(e),c.current.unsubscribe()):Object(D.isErrorResponse)(e)&&(d(!1),y(R),c.current.unsubscribe())},error:e=>{d(!1),f(e,{title:P}),c.current.unsubscribe()}})};c.current.unsubscribe(),l.current.abort(),t(),o.current=t}),[r.search,f,y]);return Object(i.useEffect)((()=>{m((n=>{const i={...null!=n?n:{},defaultIndex:a,timerange:e,filterQuery:t,factoryQueryType:A.z.kpi};return M()(n,i)?n:i}))}),[a,e,t]),Object(i.useEffect)((()=>(n?(d(!1),b(null)):h(p),()=>{c.current.unsubscribe(),l.current.abort()})),[n,p,h]),[u,g]})({defaultIndex:a,timerange:E,isBlankTimeline:W,filterQuery:null!==(t=null==Q?void 0:Q.filterQuery)&&void 0!==t?t:""}),J=Object(v.i)();return r.a.createElement(he,{alignItems:"center",gutterSize:"s"},r.a.createElement(n.EuiFlexItem,null,r.a.createElement(n.EuiFlexGroup,{"data-test-subj":"properties-left",direction:"column",gutterSize:"none"},r.a.createElement(xe,null,r.a.createElement(je,{timelineId:e}),r.a.createElement(T.a,{timelineId:e,initialFocus:"title"}),r.a.createElement(Ee,null,r.a.createElement(Ie,{timelineId:e}))),r.a.createElement(xe,null,r.a.createElement(we,{timelineId:e}),r.a.createElement(T.a,{timelineId:e,initialFocus:"description"})))),r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(ve,null,q===g.m.query?r.a.createElement(de,{kpis:Y,isLoading:K}):null)),r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiFlexGroup,{gutterSize:"s"},r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(y.a,{timelineId:e})),J.create&&J.read&&r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(O,{timelineId:e})))))};Ce.displayName="FlyoutHeaderComponent";const Me=r.a.memo(Ce)},function(e,t,a){"use strict";a.d(t,"b",(function(){return Te})),a.d(t,"a",(function(){return Me}));var n=a(4),i=a.n(n),r=a(78),s=a(37),o=a(32),l=a(42),c=a(45),u=a(707),d=a(230),p=a(90),m=a(81),g=a(85),b=a(114),f=a(293),y=a(220),h=a(543),E=a(325),v=a(625),x=a(319),k=a(127),S=a(33),j=a.n(S),O=a(430),w=a(0);const T=w.i18n.translate("xpack.securitySolution.components.flowControls.selectFlowTarget.sourceDropDownOptionLabel",{defaultMessage:"Source"}),I=w.i18n.translate("xpack.securitySolution.components.flowControls.selectFlowTarget.destinationDropDownOptionLabel",{defaultMessage:"Destination"}),C=w.i18n.translate("xpack.securitySolution.components.flowControls.selectFlowTarget.clientDropDownOptionLabel",{defaultMessage:"CLIENT"}),M=w.i18n.translate("xpack.securitySolution.components.flowControls.selectFlowTarget.serverDropDownOptionLabel",{defaultMessage:"SERVER"}),F=(w.i18n.translate("xpack.securitySolution.components.flowControls.selectFlowDirection.unidirectionalButtonLabel",{defaultMessage:"Unidirectional"}),w.i18n.translate("xpack.securitySolution.components.flowControls.selectFlowDirection.bidirectionalButtonLabel",{defaultMessage:"Bidirectional"}),(e,t)=>[{id:`${e}-select-flow-target-${g.f.source}`,value:g.f.source,inputDisplay:t[0]||T,directions:[g.e.uniDirectional,g.e.biDirectional]},{id:`${e}-select-flow-target-${g.f.destination}`,value:g.f.destination,inputDisplay:t[1]||I,directions:[g.e.uniDirectional,g.e.biDirectional]},{id:`${e}-select-flow-target-${g.f.client}`,value:g.f.client,inputDisplay:t[2]||C,directions:[g.e.biDirectional]},{id:`${e}-select-flow-target-${g.f.server}`,value:g.f.server,inputDisplay:t[3]||M,directions:[g.e.biDirectional]}]),D=({id:e,isLoading:t=!1,selectedDirection:a,selectedTarget:n,displayTextOverride:r=[],updateFlowTargetAction:s})=>i.a.createElement(o.EuiSuperSelect,{options:a?F(e,r).filter((e=>e.directions.includes(a))):F(e,r),valueOfSelected:n,onChange:s,isLoading:t}),A=i.a.memo(D);var _=a(221);const N=j()(o.EuiFlexItem).withConfig({displayName:"SelectTypeItem",componentId:"sc-12qgll-0"})(["min-width:180px;"]);N.displayName="SelectTypeItem";const R=({flowTarget:e})=>{const t=Object(s.useHistory)(),a=Object(s.useLocation)(),r=Object(n.useCallback)((n=>{const i=((e,t,a)=>`${e.pathname.replace(t,a)}${e.search}`)(a,e,n);t.push(i)}),[t,a,e]);return i.a.createElement(N,{grow:!1,"data-test-subj":`${_.b}-select-flow-target`},i.a.createElement(A,{id:_.b,isLoading:!e,selectedDirection:g.e.uniDirectional,selectedTarget:e,displayTextOverride:[O.b,O.a],updateFlowTargetAction:r}))},P=i.a.memo(R);var L=a(626),B=a(282),q=a(164),z=a(713),$=a(77),V=a(351),U=a(98),H=a(143),G=a(355),Q=a(161),W=a(111),K=a(2),Y=a(94),J=a(233),X=a(320),Z=a(380),ee=a(304),te=a(171),ae=a(837),ne=a(120),ie=a(217),re=a(1),se=a(413),oe=a(383);const le=(e,t,a)=>`${re.Sb}/ip/${e}/${a}/${t}`,ce=(e,t,a)=>{const n={[oe.a.flows]:{id:oe.a.flows,name:se.d,href:le(e,oe.a.flows,a),disabled:!1},[oe.a.users]:{id:oe.a.users,name:se.g,href:le(e,oe.a.users,a),disabled:!1},[oe.a.http]:{id:oe.a.http,name:se.e,href:le(e,oe.a.http,a),disabled:!1},[oe.a.tls]:{id:oe.a.tls,name:se.f,href:le(e,oe.a.tls,a),disabled:!1},[oe.a.anomalies]:{id:oe.a.anomalies,name:se.a,href:le(e,oe.a.anomalies,a),disabled:!1},[oe.a.events]:{id:oe.a.events,name:se.c,href:le(e,oe.a.events,a),disabled:!1}};return t||delete n.anomalies,n};var ue=a(82),de=a.n(ue),pe=a(41),me=a(104),ge=a(698),be=a(192),fe=a(514),ye=a(420),he=a(577),Ee=a(830),ve=a(689);const xe=i.a.memo((({flowTarget:e,indexPattern:t,networkDetailsFilter:a,...n})=>{const r={...n,type:W.c.NetworkType.details},l={...r,indexPattern:t},c={...r,flowTarget:e};return i.a.createElement(s.Switch,null,i.a.createElement(pe.Route,{path:`${he.b}/:flowTarget/:tabName(${oe.a.flows})`},i.a.createElement(i.a.Fragment,null,i.a.createElement(ve.a,{direction:"column"},i.a.createElement(o.EuiFlexItem,null,i.a.createElement(Ee.d,de()({},l,{flowTarget:be.b.source}))),i.a.createElement(o.EuiFlexItem,null,i.a.createElement(Ee.d,de()({},l,{flowTarget:be.b.destination})))),i.a.createElement(o.EuiSpacer,null),i.a.createElement(ve.a,{direction:"column"},i.a.createElement(o.EuiFlexItem,null,i.a.createElement(Ee.a,de()({},l,{flowTarget:be.b.source}))),i.a.createElement(o.EuiFlexItem,null,i.a.createElement(Ee.a,de()({},l,{flowTarget:be.b.destination})))))),i.a.createElement(pe.Route,{path:`${he.b}/:flowTarget/:tabName(${oe.a.users})`},i.a.createElement(Ee.h,c)),i.a.createElement(pe.Route,{path:`${he.b}/:flowTarget/:tabName(${oe.a.http})`},i.a.createElement(Ee.c,r)),i.a.createElement(pe.Route,{path:`${he.b}/:flowTarget/:tabName(${oe.a.tls})`},i.a.createElement(Ee.g,c)),i.a.createElement(pe.Route,{path:`${he.b}/:flowTarget/:tabName(${oe.a.anomalies})`},i.a.createElement(ye.a,de()({},c,{hideHistogramIfEmpty:!0,AnomaliesTableComponent:ge.a}))),i.a.createElement(pe.Route,{path:`${he.b}/:flowTarget/:tabName(${oe.a.events})`},i.a.createElement(fe.a,de()({additionalFilters:a},r,{tableId:me.c.networkPageEvents}))))}));xe.displayName="UsersDetailsTabs";var ke=a(248),Se=a(34),je=a(854),Oe=a(272);W.c.NetworkType.details;const we={[oe.a.events]:se.c,[oe.a.anomalies]:se.a,[oe.a.flows]:se.d,[oe.a.users]:se.g,[oe.a.http]:se.e,[oe.a.tls]:se.f,[Oe.a.dns]:se.b},Te=(e,t)=>{let a=[];null!=e.detailName&&(a=[{text:Object(V.c)(e.detailName),href:t({deepLinkId:K.a.network,path:Object(je.a)(e.detailName,e.flowTarget,"")})}]);const n=Object(Se.get)("tabName",e);return n?(a=[...a,{text:we[n],href:""}],a):a},Ie=Object(k.a)(L.a),Ce=()=>{const e=Object(r.useDispatch)(),t=Object(ne.a)(),{to:a,from:k,setQuery:S,isInitializing:j}=Object(b.a)(),{detailName:O,flowTarget:w}=Object(s.useParams)(),T=Object(n.useMemo)((()=>U.d.globalQuerySelector()),[]),I=Object(n.useMemo)((()=>U.d.globalFiltersQuerySelector()),[]),{signalIndexName:C}=Object(d.a)(),{hasKibanaREAD:M,hasIndexRead:F}=Object(ie.a)(),D=M&&F,A=Object(m.a)(T),_=Object(m.a)(I),N=W.c.NetworkType.details,R=Object(n.useCallback)(((t,a)=>{const n=Object(x.a)(t,a);e(Object(H.setAbsoluteRangeDatePicker)({id:p.a.global,from:n.from,to:n.to}))}),[e]),{services:{uiSettings:L}}=Object($.k)();Object(n.useEffect)((()=>{e(Object(G.setNetworkDetailsTablesActivePageToZero)())}),[O,e]);const{indicesExist:re,indexPattern:se,selectedPatterns:oe}=Object(Y.d)(),le=Object(V.c)(O),ue=Object(n.useMemo)((()=>Object(ee.c)(le)),[le]),[de,pe]=Object(n.useMemo)((()=>{try{return[Object(c.buildEsQuery)(se,[A],[...ue,..._],Object(l.getEsQueryConfig)(L))]}catch(e){return[void 0,e]}}),[_,se,ue,A,L]),me=JSON.stringify(de);Object(J.a)({id:z.a,filterQuery:me,kqlError:pe,query:A,startDate:k,endDate:a});const[ge,{id:be,inspect:fe,networkDetails:ye,refetch:he}]=Object(z.b)({skip:j,filterQuery:me,indexNames:oe,ip:le}),{jobIds:Ee}=Object(ke.b)(),[ve,Se]=Object(E.a)({criteriaFields:Object(v.a)(O,w),startDate:k,endDate:a,skip:j,jobIds:Ee,aggregationInterval:"auto"}),je=Object(n.useMemo)((()=>({field:`${w}.ip`,value:le})),[w,le]),Oe=Object(n.useMemo)((()=>({field:`${w}.ip`,value:O})),[O,w]);return i.a.createElement("div",{"data-test-subj":"network-details-page"},re?i.a.createElement(i.a.Fragment,null,i.a.createElement(f.a,null,i.a.createElement(B.a,{indexPattern:se,id:p.a.global})),i.a.createElement(q.a,null,i.a.createElement(y.a,{border:!0,"data-test-subj":"network-details-headline",draggableArguments:je,subtitle:i.a.createElement(h.a,{indexKey:g.k.ipDetails,indexNames:oe,ip:le}),title:le},i.a.createElement(P,{flowTarget:w})),i.a.createElement(Ie,{id:be,inspect:fe,ip:le,isInDetailsSidePanel:!1,data:ye,anomaliesData:Se,loading:ge,isLoadingAnomaliesData:ve,type:N,flowTarget:w,refetch:he,setQuery:S,startDate:k,endDate:a,narrowDateRange:R,indexPatterns:oe}),i.a.createElement(o.EuiHorizontalRule,null),i.a.createElement(o.EuiSpacer,null),D&&i.a.createElement(i.a.Fragment,null,i.a.createElement(o.EuiFlexGroup,null,i.a.createElement(o.EuiFlexItem,null,i.a.createElement(u.a,{signalIndexName:C,entityFilter:Oe,additionalFilters:de?[de]:[]})),i.a.createElement(o.EuiFlexItem,null,i.a.createElement(ae.a,{entityFilter:Oe,signalIndexName:C,additionalFilters:de?[de]:[]}))),i.a.createElement(o.EuiSpacer,null)),i.a.createElement(Z.a,{navTabs:ce(le,Object(te.a)(t),w)}),i.a.createElement(o.EuiSpacer,null),i.a.createElement(xe,{ip:le,endDate:a,startDate:k,filterQuery:me,indexNames:oe,skip:j||!!pe,setQuery:S,indexPattern:se,flowTarget:w,networkDetailsFilter:ue}))):i.a.createElement(X.a,null),i.a.createElement(Q.a,{pageName:K.a.network}))};Ce.displayName="NetworkDetailsComponent";const Me=i.a.memo(Ce)},function(e,t,a){"use strict";a.d(t,"b",(function(){return v})),a.d(t,"a",(function(){return S})),a.d(t,"c",(function(){return C}));var n=a(4),i=a.n(n),r=a(32),s=a(79),o=a(609),l=a(128);const c="timeline";var u=a(0);const d=u.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.insertTimelineButtonLabel",{defaultMessage:"Insert timeline link"}),p=u.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.noTimelineNameFoundErrorMsg",{defaultMessage:"No timeline name found"}),m=u.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.noTimelineIdFoundErrorMsg",{defaultMessage:"No timeline id found"}),g=u.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.noParenthesesErrorMsg",{defaultMessage:"Expected left parentheses"}),b=e=>u.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.failedRetrieveTimelineErrorMsg",{defaultMessage:"Failed to retrieve timeline id: { timelineId }",values:{timelineId:e}}),f=u.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.timelineErrorTitle",{defaultMessage:"Timeline Error"});var y=a(2);const h=({onClosePopover:e,onInsert:t})=>{const{formatUrl:a}=Object(l.n)(y.a.timelines),c=Object(n.useCallback)((({timelines:e})=>[...e.map(((e,t)=>({description:e.description,favorite:e.favorite,label:e.title,id:e.savedObjectId,key:`${e.title}-${t}`,title:e.title,checked:void 0})))]),[]),u=Object(n.useCallback)(((e,n,i)=>{const r=a(Object(l.m)(null!=n?n:"",i),{absolute:!0,skipSearch:!0});t(`[${e}](${r})`,{block:!1})}),[a,t]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiModalHeader,null),i.a.createElement(r.EuiModalBody,null,i.a.createElement(o.a,{hideUntitled:!0,getSelectableOptions:c,onTimelineChange:u,onClosePopover:e,timelineType:s.n.default})))},E=Object(n.memo)(h),v={name:c,button:{label:d,iconType:"timeline"},helpText:i.a.createElement(r.EuiCodeBlock,{language:"md",paddingSize:"s",fontSize:"l"},"[title](url)"),editor:function({node:e,onSave:t,onCancel:a}){return i.a.createElement(E,{onClosePopover:a,onInsert:t})}};var x=a(598),k=a(267);const S=function(){const e=this.Parser,t=e.prototype.inlineTokenizers,a=e.prototype.inlineMethods,n=function(e,t,a){let n=0;if("["!==t[n])return!1;if(a)return!0;function i(e,a){if(t[n]!==e)throw new Error(g);n++;let i="",r=0;for(;n<t.length;n++){const s=t[n];if(s===a&&0===r)return n++,i;s===a?r--:s===e&&r++,i+=s}return""}const r=i("[","]"),s=i("(",")"),o=e.now();if(!r)return this.file.info(p,{line:o.line,column:o.column}),!1;try{var l,d;const t=s.split("?"),a=Object(x.parse)(t[1]),{id:n="",graphEventId:i=""}=null!==(l=Object(k.a)(null!==(d=a.timeline)&&void 0!==d?d:""))&&void 0!==l?l:{id:null,graphEventId:""};return n?e(`[${r}](${s})`)({type:c,id:n,title:r,graphEventId:i}):(this.file.info(m,{line:o.line,column:o.column+s.indexOf("id")}),!1)}catch{this.file.info((e=>u.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.toolTip.timelineUrlIsNotValidErrorMsg",{defaultMessage:"Timeline URL is not valid => {timelineUrl}",values:{timelineUrl:e}}))(s),{line:o.line,column:o.column})}return!1},i=function(e,t,a){return!(!1===t.startsWith("[")||!0===t.startsWith("[")&&!t.includes("timelines?timeline=(id"))&&n.call(this,e,t,a)};i.locator=(e,t)=>e.indexOf("[",t),t.timeline=i,a.splice(a.indexOf("url"),0,c)};var j=a(78),O=a(136),w=a(12),T=a(84);const I=({id:e,title:t,graphEventId:a})=>{const{addError:s}=Object(T.a)(),o=(()=>{const e=Object(j.useDispatch)();return Object(n.useCallback)(((t,a,n)=>{Object(O.h)({graphEventId:n,timelineId:t,onError:a,updateIsLoading:({id:t,isLoading:a})=>e(Object(w.updateIsLoading)({id:t,isLoading:a})),updateTimeline:Object(O.b)(e)})}),[e])})(),l=Object(n.useCallback)(((e,t)=>{s(e,{title:f,toastMessage:b(t)})}),[s]),c=Object(n.useCallback)((()=>o(null!=e?e:"",l,a)),[e,a,o,l]);return i.a.createElement(r.EuiToolTip,{content:(d=null!=e?e:"",u.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.toolTip.timelineId",{defaultMessage:"Timeline id: { timelineId }",values:{timelineId:d}}))},i.a.createElement(r.EuiLink,{onClick:c,"data-test-subj":`markdown-timeline-link-${e}`},t));var d},C=Object(n.memo)(I)},function(e,t,a){"use strict";a.d(t,"a",(function(){return v}));var n=a(34),i=a(78),r=a(812),s=a(902),o=a(535),l=a(1);var c=a(893),u=a(2),d=a(128),p=a(690),m=a(580);const g={[p.a.summary]:m.e};var b=a(86),f=a(79),y=a(209),h=a(9),E=a(521);const v=()=>{const e=Object(i.useDispatch)(),t=Object(d.o)(),a=Object(E.b)();return(n,i,r)=>{const s=x(n,t,a);s&&i.setBreadcrumbs(s.map((t=>({...t,...t.href&&!t.onClick?{onClick:a=>{a.preventDefault(),e(b.a.showTimeline({id:f.j.active,show:!1})),r(t.href)}}:{}}))))}},x=(e,t,a)=>{const i=Object(n.omit)("navTabs",e);if(!i||!e.navTabs||!i.pageName||w(i)||F(i))return null;const r=((e,t,a,n)=>{const i=t({deepLinkId:u.a.landing});var r;return[{text:l.s,href:(r=i,`${r}${Object(y.a)(undefined)}`)},...Object(h.a)(e).map((({title:e,id:i})=>{const r=e,s=a[i]?a[i].name:e;return{text:n?r:s,href:t({deepLinkId:i})}}))]})(i.pageName,t,e.navTabs,a),s=r[r.length-1],o=r[0];return D([...a?r:[o,s],...k(i,t)])},k=(e,t)=>j(e)?Object(r.a)(e,t):S(e)?Object(s.b)(e,t):O(e)?Object(c.a)(e,t):C(e)?Object(o.c)(e,t):M(e)?((e,t)=>{var a;let n=[];var i;return(i=e.pathName).includes(l.Bb)&&i.includes("/details")&&null!==(a=e.state)&&void 0!==a&&a.listName&&(n=[...n,{text:e.state.listName}]),n})(e):T(e)?((e,t)=>{let a=[];return null!=e.detailName&&(a=[{text:e.detailName,href:t({path:Object(d.g)(e.detailName,""),deepLinkId:u.a.kubernetes})}]),a})(e,t):I(e)?((e,t)=>{let a=[];var n,i;return null!=e.detailName&&(a=[...a,{text:null!==(n=null===(i=e.state)||void 0===i?void 0:i.ruleName)&&void 0!==n?n:e.detailName,href:t({path:Object(d.b)(e.detailName,""),deepLinkId:l.uc.alerts})}]),null!=e.tabName&&(a=[...a,{text:g[e.tabName],href:""}]),a})(e,t):[],S=e=>e.pageName===u.a.network,j=e=>e.pageName===u.a.hosts,O=e=>e.pageName===u.a.users,w=e=>e.pageName===u.a.case,T=e=>e.pageName===u.a.kubernetes,I=e=>e.pageName===u.a.alerts,C=e=>e.pageName===u.a.rules||e.pageName===u.a.rulesCreate,M=e=>e.pageName===u.a.exceptions,F=e=>e.pageName===u.a.cloudSecurityPostureRules,D=e=>{const t=e.slice(0,-1),a=Object(n.last)(e);return a?[...t,{...a,href:""}]:e}},function(e,t,a){"use strict";a.d(t,"a",(function(){return S}));var n=a(79),i=a(7),r=a(33),s=a.n(r),o=a(1),l=a(140);const c=s.a.div.withConfig({displayName:"HorizontalSpacer",componentId:"sc-j61h0h-0"})(["margin:0 ",";"],(({theme:e})=>e.eui.euiSizeXS));var u=a(32),d=a(4),p=a.n(d),m=a(473),g=a(223),b=a(35),f=a(88);const y=({contextId:e,eventId:t,isDraggable:a,sourceField:n,sourceValue:i})=>p.a.createElement(u.EuiFlexGroup,{alignItems:"center","data-test-subj":"threat-match-details",direction:"row",justifyContent:"center",gutterSize:"none",wrap:!0},p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(f.c,{contextId:e,"data-test-subj":"threat-match-details-source-field",eventId:t,field:l.g,isDraggable:a,value:n,isAggregatable:!0,fieldType:"keyword"})),p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(c,null,p.a.createElement(b.FormattedMessage,{defaultMessage:"matched",id:"xpack.securitySolution.alerts.rowRenderers.cti.threatMatch.matchedVerb"}))),p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(f.c,{contextId:e,"data-test-subj":"threat-match-details-source-value",eventId:t,field:n,isDraggable:a,value:i,isAggregatable:!0,fieldType:"keyword"})));var h=a(196);const E=({contextId:e,eventId:t,feedName:a,indicatorReference:n,indicatorType:i,isDraggable:r})=>p.a.createElement(u.EuiFlexGroup,{alignItems:"flexStart","data-test-subj":"threat-match-indicator-details",direction:"row",justifyContent:"center",gutterSize:"none",wrap:!0},i&&p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(f.c,{contextId:e,"data-test-subj":"threat-match-indicator-details-indicator-type",eventId:t,field:l.h,isDraggable:r,value:i,isAggregatable:!0,fieldType:"keyword"})),a&&p.a.createElement(p.a.Fragment,null,p.a.createElement(u.EuiFlexItem,{grow:!1,component:"span"},p.a.createElement(c,null,p.a.createElement(b.FormattedMessage,{defaultMessage:"provided by",id:"xpack.securitySolution.alerts.rowRenderers.cti.threatMatch.providerPreposition"}))),p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(f.c,{contextId:e,"data-test-subj":"threat-match-indicator-details-indicator-feedName",eventId:t,field:l.e,isDraggable:r,value:a,isAggregatable:!0,fieldType:"keyword"}))),n&&p.a.createElement(p.a.Fragment,null,p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(c,null,":")),p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(h.a,{contextId:e,"data-test-subj":"threat-match-indicator-details-indicator-reference",eventId:t,fieldName:l.j,isDraggable:r,value:n,isAggregatable:!0,fieldType:"keyword"})))),v=({contextId:e,data:t,eventId:a,isDraggable:n})=>{const r={contextId:e,eventId:a,indicatorReference:Object(i.get)(t,l.p)[0],feedName:Object(i.get)(t,l.e)[0],indicatorType:Object(i.get)(t,l.n)[0],isDraggable:n,sourceField:Object(i.get)(t,l.l)[0],sourceValue:Object(i.get)(t,l.k)[0]};return p.a.createElement(x,r)},x=({contextId:e,eventId:t,feedName:a,indicatorReference:n,indicatorType:i,isDraggable:r,sourceField:s,sourceValue:o})=>p.a.createElement(u.EuiFlexGroup,{alignItems:"center","data-test-subj":"threat-match-row",gutterSize:"s",justifyContent:"center"},p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(y,{contextId:e,eventId:t,isDraggable:r,sourceField:s,sourceValue:o})),p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(E,{contextId:e,eventId:t,feedName:a,indicatorReference:n,indicatorType:i,isDraggable:r}))),k=s.a.div.withConfig({displayName:"SpacedContainer",componentId:"sc-1n3i04b-0"})(["margin:"," 0;"],(({theme:e})=>e.eui.euiSizeS)),S={id:n.d.threat_match,isInstance:e=>(e=>{const t=Object(i.get)(e,o.yb);return null==t?[]:Array.isArray(t)?t:[t]})(e).some((e=>l.i.some((t=>!Object(i.isEmpty)(Object(i.get)(e,t)))))),renderRow:({data:e,isDraggable:t,scopeId:a})=>{const n=Object(i.get)(e,o.yb),r=Object(i.get)(e,m.a);return p.a.createElement(g.a,{"data-test-subj":"threat-match-row-renderer"},p.a.createElement(k,null,n.map(((e,i)=>{const s=`threat-match-row-${a}-${r}-${i}`;return p.a.createElement(d.Fragment,{key:s},p.a.createElement(v,{contextId:s,data:e,eventId:r,isDraggable:t}),i<n.length-1&&p.a.createElement(u.EuiHorizontalRule,{margin:"s"}))}))))}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return M}));var n=a(4),i=a.n(n),r=a(11),s=a(33),o=a.n(s),l=a(92),c=a.n(l),u=a(32),d=a(48),p=a(60);const m=Object(n.memo)((({indexPattern:e,isLoading:t=!1,isRefreshPaused:a,filterQuery:r,filterManager:s,filters:o,refreshInterval:l,dataTestSubj:c,displayStyle:u})=>{const d=Object(n.useCallback)((e=>{s.setFilters(e)}),[s]),m=Object(n.useMemo)((()=>[e]),[e]);return i.a.createElement(p.SearchBar,{showSubmitButton:!1,filters:o,indexPatterns:m,isLoading:t,isRefreshPaused:a,query:r,onFiltersUpdated:d,refreshInterval:l,showAutoRefreshOnly:!1,showFilterBar:!0,showDatePicker:!1,showQueryInput:!1,showSaveQuery:!1,dataTestSubj:c,displayStyle:u})}));m.displayName="FilterBar";var g=a(84),b=a(311),f=a(7);const y=({ariaLabel:e,errors:t})=>{const[a,r]=Object(n.useState)(!1),s=Object(n.useCallback)((()=>{r(!a)}),[a]),o=Object(n.useCallback)((()=>{r(!1)}),[]);return i.a.createElement(u.EuiPopover,{"data-test-subj":"eql-validation-errors-popover",button:i.a.createElement(u.EuiButtonEmpty,{"data-test-subj":"eql-validation-errors-popover-button",iconType:"crossInACircleFilled",size:"s",color:"danger","aria-label":e,onClick:s},t.length),isOpen:a,closePopover:o,anchorPosition:"downCenter"},i.a.createElement("div",{"data-test-subj":"eql-validation-errors-popover-content"},i.a.createElement(u.EuiPopoverTitle,null,b.k),t.map(((e,t)=>i.a.createElement(u.EuiText,{key:t},e)))))};var h=a(77);const E=o()(u.EuiText).withConfig({displayName:"InlineText",componentId:"sc-i91hzt-0"})(["display:inline-block;"]),v=()=>{const e=Object(h.k)().services.docLinks.links.query.eql;return i.a.createElement(u.EuiLink,{external:!0,href:e,target:"_blank"},i.a.createElement(E,{size:"xs"},b.i))},x=o()(u.EuiPanel).withConfig({displayName:"Container",componentId:"sc-10yczbx-0"})(["border-radius:0;background:",";padding:"," ",";"],(({theme:e})=>e.eui.euiPageBackgroundColor),(({theme:e})=>e.eui.euiSizeXS),(({theme:e})=>e.eui.euiSizeS)),k=o()(u.EuiFlexGroup).withConfig({displayName:"FlexGroup",componentId:"sc-10yczbx-1"})(["min-height:",";"],(({theme:e})=>e.eui.euiSizeXL)),S=o()(u.EuiFlexItem).withConfig({displayName:"FlexItemLeftBorder",componentId:"sc-10yczbx-2"})(["border-left:1px solid ",";"],(({theme:e})=>e.eui.euiColorLightShade)),j=o()(u.EuiFlexItem).withConfig({displayName:"FlexItemWithMarginRight",componentId:"sc-10yczbx-3"})(["margin-right:",";"],(({theme:e})=>e.eui.euiSizeS)),O=o()(u.EuiLoadingSpinner).withConfig({displayName:"Spinner",componentId:"sc-10yczbx-4"})(["margin:0 ",";"],(({theme:e})=>e.eui.euiSizeS)),w={asPlainText:!0},T=({errors:e,isLoading:t,isSizeOptionDisabled:a,optionsData:r,optionsSelected:s,onOptionsChange:o})=>{var l;const[c,d]=Object(n.useState)(!1),[p,m]=Object(n.useState)(null!==(l=null==s?void 0:s.size)&&void 0!==l?l:100),g=Object(n.useRef)(),h=Object(n.useCallback)((()=>{d(!0)}),[]),E=Object(n.useCallback)((()=>{d(!1)}),[]),T=Object(n.useCallback)((e=>{o&&(e.length>0?o("eventCategoryField",e[0].label):o("eventCategoryField",void 0))}),[o]),I=Object(n.useCallback)((e=>{o&&(e.length>0?o("tiebreakerField",e[0].label):o("tiebreakerField",void 0))}),[o]),C=Object(n.useCallback)((e=>{o&&(e.length>0?o("timestampField",e[0].label):o("timestampField",void 0))}),[o]),M=Object(n.useCallback)((e=>{var t,a,n,i;o&&(m(null==e||null===(t=e.target)||void 0===t?void 0:t.value),null!==(a=g.current)&&void 0!==a&&a.cancel&&(null===(i=g.current)||void 0===i||i.cancel()),g.current=Object(f.debounce)((e=>o("size",e)),800),g.current(null==e||null===(n=e.target)||void 0===n?void 0:n.value))}),[o]),F=Object(n.useMemo)((()=>null!=(null==s?void 0:s.eventCategoryField)?[{label:null==s?void 0:s.eventCategoryField}]:void 0),[null==s?void 0:s.eventCategoryField]),D=Object(n.useMemo)((()=>null!=(null==s?void 0:s.tiebreakerField)?[{label:null==s?void 0:s.tiebreakerField}]:void 0),[null==s?void 0:s.tiebreakerField]),A=Object(n.useMemo)((()=>null!=(null==s?void 0:s.timestampField)?[{label:null==s?void 0:s.timestampField}]:void 0),[null==s?void 0:s.timestampField]);return i.a.createElement(x,null,i.a.createElement(k,{alignItems:"center",justifyContent:"spaceBetween",gutterSize:"none"},i.a.createElement(u.EuiFlexItem,null,e.length>0&&i.a.createElement(y,{ariaLabel:b.l,errors:e}),t&&i.a.createElement(O,{"data-test-subj":"eql-validation-loading",size:"m"})),!o&&i.a.createElement(u.EuiFlexItem,{grow:!1},i.a.createElement(v,null)),o&&i.a.createElement(i.a.Fragment,null,i.a.createElement(j,{grow:!1},i.a.createElement(v,null)),i.a.createElement(S,{grow:!1},i.a.createElement(u.EuiPopover,{button:i.a.createElement(u.EuiButtonIcon,{onClick:h,iconType:"controlsVertical",isDisabled:c,"aria-label":"eql settings","data-test-subj":"eql-settings-trigger"}),isOpen:c,closePopover:E,anchorPosition:"downCenter",ownFocus:!1},i.a.createElement(u.EuiPopoverTitle,null,b.j),i.a.createElement("div",{style:{width:"300px"}},!a&&i.a.createElement(u.EuiFormRow,{label:b.h,helpText:b.g},i.a.createElement(u.EuiFieldNumber,{value:p,onChange:M,min:1,max:1e4})),i.a.createElement(u.EuiFormRow,{label:b.b,helpText:b.a},i.a.createElement(u.EuiComboBox,{options:null==r?void 0:r.keywordFields,selectedOptions:F,singleSelection:w,onChange:T})),i.a.createElement(u.EuiFormRow,{label:b.d,helpText:b.c},i.a.createElement(u.EuiComboBox,{options:null==r?void 0:r.nonDateFields,selectedOptions:D,singleSelection:w,onChange:I})),i.a.createElement(u.EuiFormRow,{label:b.f,helpText:b.e},i.a.createElement(u.EuiComboBox,{options:null==r?void 0:r.dateFields,selectedOptions:A,singleSelection:w,onChange:C}))))))))};var I=a(584);const C=o()(u.EuiTextArea).withConfig({displayName:"TextArea",componentId:"sc-4u43ce-0"})(["display:block;border:",";border-bottom:0;box-shadow:none;min-height:",";"],(({theme:e})=>e.eui.euiBorderThin),(({theme:e})=>e.eui.euiFormControlHeight)),M=({dataTestSubj:e,field:t,isLoading:a=!1,indexPattern:s,showFilterBar:o,idAria:l,optionsData:p,optionsSelected:f,isSizeOptionDisabled:y,onOptionsChange:E,onValidityChange:v,onValiditingChange:x})=>{const{addError:k}=Object(g.a)(),[S,j]=Object(n.useState)([]),{isValidating:O,value:w,setValue:M}=t,{isValid:F,message:D,messages:A,error:_}=Object(I.c)(t),{uiSettings:N}=Object(h.k)().services,R=Object(n.useRef)(new d.FilterManager(N));Object(n.useEffect)((()=>{null!=v&&v(F)}),[F,v]),Object(n.useEffect)((()=>{j(null!=A?A:[])}),[A]),Object(n.useEffect)((()=>{_&&k(_,{title:b.m})}),[_,k]),Object(n.useEffect)((()=>{x&&x(O)}),[O,x]),Object(n.useEffect)((()=>{let e=!0;const t=new r.Subscription;return R.current.setFilters([]),t.add(R.current.getUpdates$().subscribe({next:()=>{if(e){const e=R.current.getFilters(),{filters:t}=w;c()(t,e)||M({...w,filters:e})}}})),()=>{e=!1,t.unsubscribe()}}),[w,R,M]),Object(n.useEffect)((()=>{const{filters:e}=w;c()(e,R.current.getFilters())||R.current.setFilters(e)}),[w,R]);const P=Object(n.useCallback)((e=>{const t=e.target.value;x&&x(!0),j([]),M({filters:w.filters,query:{query:t,language:"eql"},saved_id:null})}),[w,M,x]);return i.a.createElement(u.EuiFormRow,{label:t.label,labelAppend:t.labelAppend,helpText:t.helpText,error:D,isInvalid:!F&&!O,fullWidth:!0,"data-test-subj":e,describedByIds:l?[l]:void 0},i.a.createElement(i.a.Fragment,null,i.a.createElement(C,{"data-test-subj":"eqlQueryBarTextInput",fullWidth:!0,isInvalid:!F&&!O,value:w.query.query,onChange:P}),i.a.createElement(T,{errors:S,isLoading:O,isSizeOptionDisabled:y,optionsData:p,optionsSelected:f,onOptionsChange:E}),o&&i.a.createElement(i.a.Fragment,null,i.a.createElement(u.EuiSpacer,{size:"s"}),i.a.createElement(m,{"data-test-subj":"eqlFilterBar",indexPattern:s,isLoading:a,isRefreshPaused:!1,filterQuery:w.query,filterManager:R.current,filters:R.current.getFilters()||[],displayStyle:"inPage"}))))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return $}));var n=a(34),i=a(32),r=a(4),s=a.n(r),o=a(33),l=a.n(o),c=a(106),u=a(50),d=a(175),p=a(0);const m=p.i18n.translate("xpack.securitySolution.editDataProvider.doesNotExistLabel",{defaultMessage:"does not exist"}),g=p.i18n.translate("xpack.securitySolution.editDataProvider.existsLabel",{defaultMessage:"exists"}),b=p.i18n.translate("xpack.securitySolution.editDataProvider.fieldLabel",{defaultMessage:"Field"}),f=p.i18n.translate("xpack.securitySolution.editDataProvider.placeholder",{defaultMessage:"Select a field"}),y=p.i18n.translate("xpack.securitySolution.editDataProvider.isLabel",{defaultMessage:"is"}),h=p.i18n.translate("xpack.securitySolution.editDataProvider.isOneOfLabel",{defaultMessage:"is one of"}),E=p.i18n.translate("xpack.securitySolution.editDataProvider.isNotLabel",{defaultMessage:"is not"}),v=p.i18n.translate("xpack.securitySolution.editDataProvider.isNotOneOfLabel",{defaultMessage:"is not one of"}),x=p.i18n.translate("xpack.securitySolution.editDataProvider.includesPlaceholder",{defaultMessage:"enter one or more values"}),k=p.i18n.translate("xpack.securitySolution.editDataProvider.operatorLabel",{defaultMessage:"Operator"}),S=p.i18n.translate("xpack.securitySolution.editDataProvider.saveButton",{defaultMessage:"Save"}),j=p.i18n.translate("xpack.securitySolution.editDataProvider.valuePlaceholder",{defaultMessage:"value"}),O=p.i18n.translate("xpack.securitySolution.editDataProvider.valueLabel",{defaultMessage:"Value"}),w=p.i18n.translate("xpack.securitySolution.editDataProvider.selectAnOperatorPlaceholder",{defaultMessage:"Select an operator"}),T=e=>p.i18n.translate("xpack.securitySolution.editDataProvider.unavailableOperator",{values:{operator:e},defaultMessage:"{operator} operator is unavailable with templates"}),I=[{label:y},{label:E},{label:h},{label:v},{label:g},{label:m}],C=[],M=e=>e?Object.keys(e).sort().map((t=>{return{label:t,options:(a=e[t],null!=a.fields&&Object.keys(a.fields).length>0?Object.keys(a.fields):C).map((e=>({label:e})))};var a})):C,F=({browserFields:e,selectedField:t,selectedOperator:a,type:i})=>{const r=t.length>0?t[0].label:"",s=a.length>0?a[0].label:"",o=e&&null!=Object(d.a)(e)[r],l=-1!==Object(n.findIndex)((e=>e.label===s),I),c=i===u.DataProviderType.template&&(s===h||s===v);return o&&l&&!c},D=e=>{switch(e.length>0?e[0].label:""){case y:case E:return c.d;case h:case v:return c.c;case g:case m:return c.b;default:return c.d}},A=e=>{switch(e.length>0?e[0].label:""){case E:case v:case m:return!0;default:return!1}},_=e=>Array.isArray(e)?e.length?`${e[0]}`:"":`${e}`;var N=a(123);const R=({value:e,onChangeCallback:t})=>{const[a,n]=Object(r.useState)(P(e));Object(r.useEffect)((()=>{t(L(a))}),[a,t]);const o=Object(r.useCallback)(((e,t=a)=>{const i=e.trim().toLowerCase();i&&-1===t.findIndex((e=>e.label.trim().toLowerCase()===i))&&n([...a,{label:e}])}),[a]),l=Object(r.useCallback)((e=>{n(e)}),[]);return s.a.createElement(i.EuiComboBox,{noSuggestions:!0,isClearable:!0,"data-test-subj":"is-one-of-combobox-input",selectedOptions:a,placeholder:x,onCreateOption:o,onChange:l})},P=e=>Object(N.k)(e)?e.map((e=>({label:String(e)}))):[],L=e=>e.map((e=>e.label)),B=({value:e,onChangeCallback:t})=>{const[a,n]=Object(r.useState)(q(e));Object(r.useEffect)((()=>{t(_(a))}),[a,t]);const o=Object(r.useCallback)((e=>{n(e.target.value)}),[]);return s.a.createElement(i.EuiFieldText,{className:"edit-data-provider-value",onChange:o,placeholder:j,value:_(a)})},q=e=>{var t;return Object(N.k)(e)?null!==(t=e[0])&&void 0!==t?t:"":e},z="edit-data-provider-save";l.a.div.withConfig({displayName:"HeaderContainer",componentId:"sc-osu70s-0"})(["width:",";"],400).displayName="HeaderContainer";const $=s.a.memo((({andProviderId:e,browserFields:t,field:a,isExcluded:o,onDataProviderEdited:l,operator:u,providerId:d,timelineId:p,value:x,type:j=c.a.default})=>{const[C,_]=Object(r.useState)([{label:a}]),[N,P]=Object(r.useState)(((e,t)=>":"===t?e?[{label:E}]:[{label:y}]:"includes"===t?e?[{label:v}]:[{label:h}]:e?[{label:m}]:[{label:g}])(o,u)),[L,q]=Object(r.useState)(x),$=Object(r.useMemo)((()=>N.length>0&&(N[0].label===h||N[0].label===v)),[N]),V=Object(r.useMemo)((()=>j!==c.a.template&&N.length>0&&N[0].label!==g&&N[0].label!==m&&!$),[$,j,N]),U=Object(r.useMemo)((()=>$&&Array.isArray(L)&&!L.length),[$,L]),H=()=>{const e=document.getElementsByClassName("edit-data-provider-value");if(e.length>0)e[0].focus();else{const e=document.getElementsByClassName(z);e.length>0&&e[0].focus()}},G=Object(r.useCallback)((e=>{_(e),j===c.a.template&&q(`{${e[0].label}}`),H()}),[j]),Q=Object(r.useCallback)((e=>{P(e),H()}),[]),W=Object(r.useCallback)((e=>{q(e)}),[]),K=Object(r.useCallback)((()=>{l({andProviderId:e,excluded:A(N),field:C.length>0?C[0].label:"",id:p,operator:D(N),providerId:d,value:L,type:j})}),[l,e,N,C,p,d,L,j]);return Object(r.useEffect)((()=>((()=>{const e=void 0!==window.pageXOffset?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,t=void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;window.onscroll=()=>window.scrollTo(e,t)})(),()=>{window.onscroll=()=>n.noop})),[]),s.a.createElement(i.EuiPanel,{paddingSize:"s"},s.a.createElement(i.EuiFlexGroup,{direction:"column",gutterSize:"none"},s.a.createElement(i.EuiFlexItem,{grow:!0},s.a.createElement(i.EuiFormRow,{label:b},s.a.createElement(i.EuiComboBox,{autoFocus:!0,"data-test-subj":"field",isClearable:!1,onChange:G,options:M(t),placeholder:f,selectedOptions:C,singleSelection:{asPlainText:!0},fullWidth:!0}))),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiSpacer,{size:"m"})),s.a.createElement(i.EuiFlexItem,{grow:!0},s.a.createElement(i.EuiFlexGroup,{gutterSize:"s",direction:"row",justifyContent:"spaceBetween"},s.a.createElement(i.EuiFlexItem,{grow:!0},s.a.createElement(i.EuiFormRow,{label:k},s.a.createElement(i.EuiComboBox,{"data-test-subj":"operator",isClearable:!1,onChange:Q,options:I,placeholder:w,selectedOptions:N,singleSelection:{asPlainText:!0},style:{minWidth:152}}))))),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiSpacer,{size:"m"})),s.a.createElement(i.EuiFlexItem,{grow:!1},V&&s.a.createElement(i.EuiFormRow,{label:O},s.a.createElement(B,{onChangeCallback:W,value:x})),$&&j!==c.a.template&&s.a.createElement(i.EuiFormRow,{label:O},s.a.createElement(R,{onChangeCallback:W,value:x}))),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiSpacer,{size:"m"})),s.a.createElement(i.EuiFlexItem,{grow:!1},j===c.a.template&&$&&s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiCallOut,{color:"warning",iconType:"alert",size:"s",title:T(N[0].label)}),s.a.createElement(i.EuiSpacer,{size:"m"})),s.a.createElement(i.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"none"},s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiButton,{className:z,color:"primary","data-test-subj":"save",fill:!0,isDisabled:!F({type:j,browserFields:t,selectedField:C,selectedOperator:N})||U,onClick:K,size:"m"},S))))))}));$.displayName="StatefulEditDataProvider"},function(e,t,a){"use strict";a.d(t,"a",(function(){return F}));var n=a(34),i=a(4),r=a.n(i),s=a(79),o=a(223),l=a(32),c=a(33),u=a.n(c),d=a(199),p=a(133),m=a(102),g=a(89),b=a(150),f=a(97);const y=["IPv4","IPv6"];var h=a(88),E=a(106);const v="suricata.eve.alert.signature_id",x=u()(l.EuiFlexItem).withConfig({displayName:"SignatureFlexItem",componentId:"sc-1vydse8-0"})(["min-width:77px;"]);x.displayName="SignatureFlexItem";const k=u()(l.EuiBadge).withConfig({displayName:"Badge",componentId:"sc-1vydse8-1"})(["vertical-align:top;"]);k.displayName="Badge";const S=u()(l.EuiFlexItem).withConfig({displayName:"LinkFlexItem",componentId:"sc-1vydse8-2"})(["margin-left:6px;"]);S.displayName="LinkFlexItem";const j=r.a.memo((({tokens:e})=>r.a.createElement(r.a.Fragment,null,e.map((e=>r.a.createElement(f.c,{key:e,grow:!1},r.a.createElement(l.EuiBadge,{iconType:"tag",color:"hollow",title:""},e)))))));j.displayName="Tokens";const O=r.a.memo((({id:e,isDraggable:t,signatureId:a})=>{const n=Object(i.useMemo)((()=>({and:[],enabled:!0,id:Object(m.h)(`suricata-draggable-signature-id-${e}-sig-${a}`),name:String(a),excluded:!1,kqlQuery:"",queryMatch:{field:v,value:a,operator:E.d}})),[e,a]),s=Object(i.useCallback)(((e,t,n)=>n.isDragging?r.a.createElement(p.a,null,r.a.createElement(b.a,{dataProvider:e})):r.a.createElement(l.EuiToolTip,{"data-test-subj":"signature-id-tooltip",content:v},r.a.createElement(k,{iconType:"number",color:"hollow",title:""},a))),[a]);return r.a.createElement(x,{grow:!1},r.a.createElement(p.b,{dataProvider:n,isDraggable:t,render:s,isAggregatable:!0,fieldType:"keyword"}))}));O.displayName="DraggableSignatureId";const w=r.a.memo((({contextId:e,id:t,isDraggable:a,signature:n,signatureId:i})=>{const s=(e=>e.trim().split(" ").reduce(((e,t,a)=>e.length===a&&t===t.toUpperCase()&&""!==t||y.includes(t)?[...e,t]:e),[]))(n);return r.a.createElement(l.EuiFlexGroup,{justifyContent:"center",gutterSize:"none",wrap:!0},r.a.createElement(O,{id:`draggable-signature-id-${e}-${t}`,isDraggable:a,signatureId:i}),r.a.createElement(j,{tokens:s}),r.a.createElement(S,{grow:!1},r.a.createElement(h.b,{"data-test-subj":"draggable-signature-link",field:"suricata.eve.alert.signature",id:`suricata-signature-default-draggable-${e}-${t}-suricata.eve.alert.signature`,isDraggable:a,value:n,tooltipPosition:"bottom"},r.a.createElement("div",null,r.a.createElement(g.c,{link:n},n.split(" ").splice(s.length).join(" "))))))}));w.displayName="SuricataSignature";const T=u()(l.EuiFlexItem).withConfig({displayName:"LinkEuiFlexItem",componentId:"sc-7j8o7u-0"})(["display:inline;"]);T.displayName="LinkEuiFlexItem";const I=r.a.memo((({signatureId:e})=>{const[t,s]=Object(i.useState)(void 0);return Object(i.useEffect)((()=>{let t=!0;return async function(){if(null!=e)try{const i=await(async e=>{const t=(await a.e(15).then(a.t.bind(null,1285,7))).db,i=(r=t,s=e,Object.prototype.hasOwnProperty.call(r,s)?t[e]:null);var r,s;return null!=i?Object(n.uniq)(i):[]})(e);t&&null!=i&&s(i)}catch(e){s(void 0)}else t&&s(void 0)}(),()=>{t=!1}}),[e]),r.a.createElement(l.EuiFlexGroup,{"data-test-subj":"suricataRefs",gutterSize:"none",justifyContent:"center",wrap:!0},t&&t.map((e=>r.a.createElement(T,{key:e,grow:!1},r.a.createElement(l.EuiLink,{href:e,color:"subdued",target:"_blank"},e)))))}));I.displayName="SuricataRefs";const C=u.a.div.withConfig({displayName:"Details",componentId:"sc-1a0lqov-0"})(["margin:5px 0;"]);C.displayName="Details";const M=r.a.memo((({data:e,isDraggable:t,timelineId:a})=>{const i=Object(n.get)("suricata.eve.alert.signature[0]",e),s=Object(n.get)("suricata.eve.alert.signature_id[0]",e);return null!=s&&null!=i?r.a.createElement(C,null,r.a.createElement(w,{contextId:`suricata-signature-${a}-${e._id}`,id:e._id,isDraggable:t,signature:i,signatureId:s}),r.a.createElement(I,{signatureId:s}),r.a.createElement(l.EuiSpacer,{size:"s"}),r.a.createElement(d.a,{data:e,isDraggable:t,timelineId:a})):null}));M.displayName="SuricataDetails";const F={id:s.d.suricata,isInstance:e=>{const t=Object(n.get)("event.module[0]",e);return null!=t&&"suricata"===t.toLowerCase()},renderRow:({data:e,isDraggable:t,scopeId:a})=>r.a.createElement(o.a,null,r.a.createElement(M,{data:e,isDraggable:t,timelineId:a}))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return G}));var n=a(34),i=a(4),r=a.n(i),s=a(79),o=a(223),l=a(32),c=a(33),u=a.n(c),d=a(199),p=a(133),m=a(102),g=a(89),b=a(150),f=a(106),y=a(0);const h=y.i18n.translate("xpack.securitySolution.zeek.s0Description",{defaultMessage:"Connection attempt seen, no reply"}),E=y.i18n.translate("xpack.securitySolution.zeek.s1Description",{defaultMessage:"Connection established, not terminated"}),v=y.i18n.translate("xpack.securitySolution.zeek.s2Description",{defaultMessage:"Connection established and close attempt by originator seen (but no reply from responder)"}),x=y.i18n.translate("xpack.securitySolution.zeek.s3Description",{defaultMessage:"Connection established and close attempt by responder seen (but no reply from originator)"}),k=y.i18n.translate("xpack.securitySolution.zeek.sfDescription",{defaultMessage:"Normal SYN/FIN completion"}),S=y.i18n.translate("xpack.securitySolution.zeek.rejDescription",{defaultMessage:"Connection attempt rejected"}),j=y.i18n.translate("xpack.securitySolution.zeek.rstoODescription",{defaultMessage:"Connection established, originator aborted (sent a RST)"}),O=y.i18n.translate("xpack.securitySolution.zeek.rstrDescription",{defaultMessage:"Established, responder aborted"}),w=y.i18n.translate("xpack.securitySolution.zeek.rstosoDescription",{defaultMessage:"Originator sent a SYN followed by a RST, no SYN-ACK from the responder"}),T=y.i18n.translate("xpack.securitySolution.zeek.rstrhDescription",{defaultMessage:"Responder sent a SYN ACK followed by a RST, no SYN from the (purported) originator"}),I=y.i18n.translate("xpack.securitySolution.zeek.shDescription",{defaultMessage:"Originator sent a SYN followed by a FIN, no SYN ACK from the responder"}),C=y.i18n.translate("xpack.securitySolution.zeek.shrDescription",{defaultMessage:"Responder sent a SYN ACK followed by a FIN, no SYN from the originator"}),M=y.i18n.translate("xpack.securitySolution.zeek.othDescription",{defaultMessage:"No SYN seen, just midstream traffic"}),F=u()(l.EuiBadge).withConfig({displayName:"Badge",componentId:"sc-33j7s9-0"})(["vertical-align:top;"]);F.displayName="Badge";const D=u()(l.EuiFlexItem).withConfig({displayName:"TokensFlexItem",componentId:"sc-33j7s9-1"})(["margin-left:3px;"]);D.displayName="TokensFlexItem";const A=u()(l.EuiFlexItem).withConfig({displayName:"LinkFlexItem",componentId:"sc-33j7s9-2"})(["margin-left:6px;"]);A.displayName="LinkFlexItem";const _=e=>e,N=e=>{const t=e.split(".");return t.length>=2&&null!=t[1]?""!==t[1]?t[1]:t[0]:e},R=e=>`Dropped:${e}`,P=e=>`md5: ${e.substr(0,7)}...`,L=e=>`sha1: ${e.substr(0,7)}...`,B=r.a.memo((({id:e,field:t,isDraggable:a,value:n,stringRenderer:s=_})=>{const o=Object(i.useMemo)((()=>({and:[],enabled:!0,id:Object(m.h)(`draggable-zeek-element-draggable-wrapper-${e}-${t}-${n}`),name:String(n),excluded:!1,kqlQuery:"",queryMatch:{field:t,value:String(n),operator:f.d}})),[t,e,n]),c=Object(i.useCallback)(((e,a,i)=>i.isDragging?r.a.createElement(p.a,null,r.a.createElement(b.a,{dataProvider:e})):r.a.createElement(l.EuiToolTip,{"data-test-subj":"badge-tooltip",content:t},r.a.createElement(F,{iconType:"tag",color:"hollow",title:""},s(String(n))))),[t,s,n]);return null!=n?r.a.createElement(D,{grow:!1},r.a.createElement(p.b,{dataProvider:o,isDraggable:a,render:c,isAggregatable:!0,fieldType:"keyword"})):null}));B.displayName="DraggableZeekElement";const q=r.a.memo((({value:e,link:t})=>null!=e?null!=t?r.a.createElement(A,{grow:!1},r.a.createElement("div",null,r.a.createElement(g.c,{link:t},e))):r.a.createElement(A,{grow:!1},r.a.createElement("div",null,r.a.createElement(g.c,{link:e}))):null));q.displayName="Link";const z=r.a.memo((({value:e})=>null!=e?r.a.createElement(A,{grow:!1},r.a.createElement("div",null,r.a.createElement(g.j,{domain:e,overflowIndexStart:1,showDomain:!0,"data-test-subj":"reputationLinkSha"}))):null));z.displayName="TotalVirusLinkSha";const $={S0:h,S1:E,S2:v,S3:x,SF:k,REJ:S,RSTO:j,RSTR:O,RSTOS0:w,RSTRH:T,SH:I,SHR:C,OTH:M},V=r.a.memo((({data:e,isDraggable:t,timelineId:a})=>{const i=`zeek-signature-draggable-zeek-element-${a}-${e._id}`,s=Object(n.get)("zeek.session_id[0]",e),o=Object(n.get)("event.dataset[0]",e),c=Object(n.get)("zeek.ssl.version[0]",e),u=Object(n.get)("zeek.ssl.cipher[0]",e),d=Object(n.get)("zeek.connection.state[0]",e),p=Object(n.get)("zeek.connection.history[0]",e),m=Object(n.get)("zeek.notice.note[0]",e),g=Object(n.get)("zeek.notice.msg[0]",e),b=(e=>null!=e?String(e):null)(Object(n.get)("zeek.notice.dropped[0]",e)),f=Object(n.get)("zeek.dns.query[0]",e),y=Object(n.get)("zeek.dns.qclass_name[0]",e),h=Object(n.get)("http.request.method[0]",e),E=Object(n.get)("http.response.status_code[0]",e),v=Object(n.get)("url.original[0]",e),x=Object(n.get)("zeek.files.sha1[0]",e),k=Object(n.get)("zeek.files.md5[0]",e),S=(e=>{if(null!=e){const t=$[e];return null!=t?`${e} ${t}`:e}return null})(d),j=(e=>null!=e&&null!=$[e]?$[e]:null)(d);return r.a.createElement(r.a.Fragment,null,r.a.createElement(l.EuiFlexGroup,{justifyContent:"center",gutterSize:"none",wrap:!0},r.a.createElement(B,{id:i,field:"zeek.session_id",isDraggable:t,value:s}),r.a.createElement(B,{id:i,field:"event.dataset",isDraggable:t,value:o,stringRenderer:N}),r.a.createElement(B,{id:i,field:"zeek.files.sha1",isDraggable:t,value:x,stringRenderer:L}),r.a.createElement(B,{id:i,field:"zeek.files.md5",isDraggable:t,value:k,stringRenderer:P}),r.a.createElement(B,{id:i,field:"zeek.notice.dropped",isDraggable:t,value:b,stringRenderer:R}),r.a.createElement(B,{id:i,field:"zeek.ssl.version",isDraggable:t,value:c}),r.a.createElement(B,{id:i,field:"zeek.ssl.cipher",isDraggable:t,value:u}),r.a.createElement(B,{id:i,field:"zeek.connection.state",isDraggable:t,value:d}),r.a.createElement(B,{id:i,field:"http.request.method",isDraggable:t,value:h}),r.a.createElement(B,{id:i,field:"zeek.connection.history",isDraggable:t,value:p}),r.a.createElement(B,{id:i,field:"zeek.notice.note",isDraggable:t,value:m}),r.a.createElement(B,{id:i,field:"zeek.dns.query",isDraggable:t,value:f}),r.a.createElement(B,{id:i,field:"zeek.dns.qclass_name",isDraggable:t,value:y}),r.a.createElement(B,{id:i,field:"http.response.status_code",isDraggable:t,value:E})),r.a.createElement(l.EuiFlexGroup,{justifyContent:"center",gutterSize:"none"},r.a.createElement(q,{link:S,value:j}),r.a.createElement(q,{value:u}),r.a.createElement(q,{value:f}),r.a.createElement(q,{value:g}),r.a.createElement(q,{value:v}),r.a.createElement(z,{value:x})))}));V.displayName="ZeekSignature";const U=u.a.div.withConfig({displayName:"Details",componentId:"sc-1p2wwsn-0"})(["margin:5px 0;"]);U.displayName="Details";const H=r.a.memo((({data:e,isDraggable:t,timelineId:a})=>null!=e.zeek?r.a.createElement(U,null,r.a.createElement(V,{data:e,isDraggable:t,timelineId:a}),r.a.createElement(l.EuiSpacer,{size:"s"}),r.a.createElement(d.a,{data:e,isDraggable:t,timelineId:a})):null));H.displayName="ZeekDetails";const G={id:s.d.zeek,isInstance:e=>{const t=Object(n.get)("event.module[0]",e);return null!=t&&"zeek"===t.toLowerCase()},renderRow:({data:e,isDraggable:t,scopeId:a})=>r.a.createElement(o.a,null,r.a.createElement(H,{data:e,isDraggable:t,timelineId:a}))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return ae}));var n=a(32),i=a(40),r=a(34),s=a(4),o=a.n(s),l=a(33),c=a.n(l),u=a(114),d=a(85),p=a(1),m=a(77),g=a(87),b=a(221),f=a(396),y=a(124),h=a(187),E=a(89),v=a(171),x=a(120),k=a(506),S=a(160),j=a(0);const O=j.i18n.translate("xpack.securitySolution.host.details.overview.hostIdTitle",{defaultMessage:"Host ID"}),w=j.i18n.translate("xpack.securitySolution.host.details.firstSeenTitle",{defaultMessage:"First seen"}),T=j.i18n.translate("xpack.securitySolution.host.details.lastSeenTitle",{defaultMessage:"Last seen"}),I=j.i18n.translate("xpack.securitySolution.host.details.overview.maxAnomalyScoreByJobTitle",{defaultMessage:"Max anomaly score by job"}),C=j.i18n.translate("xpack.securitySolution.host.details.overview.hostRiskScoreTitle",{defaultMessage:"Host risk score"}),M=j.i18n.translate("xpack.securitySolution.host.details.overview.hostRiskClassification",{defaultMessage:"Host risk classification"}),F=j.i18n.translate("xpack.securitySolution.host.details.overview.ipAddressesTitle",{defaultMessage:"IP addresses"}),D=j.i18n.translate("xpack.securitySolution.host.details.overview.macAddressesTitle",{defaultMessage:"MAC addresses"}),A=j.i18n.translate("xpack.securitySolution.host.details.overview.platformTitle",{defaultMessage:"Platform"}),_=j.i18n.translate("xpack.securitySolution.host.details.overview.osTitle",{defaultMessage:"Operating system"}),N=j.i18n.translate("xpack.securitySolution.host.details.overview.familyTitle",{defaultMessage:"Family"}),R=j.i18n.translate("xpack.securitySolution.host.details.versionLabel",{defaultMessage:"Version"}),P=j.i18n.translate("xpack.securitySolution.host.details.architectureLabel",{defaultMessage:"Architecture"}),L=j.i18n.translate("xpack.securitySolution.host.details.overview.cloudProviderTitle",{defaultMessage:"Cloud provider"}),B=j.i18n.translate("xpack.securitySolution.host.details.overview.regionTitle",{defaultMessage:"Region"}),q=j.i18n.translate("xpack.securitySolution.host.details.overview.instanceIdTitle",{defaultMessage:"Instance ID"}),z=j.i18n.translate("xpack.securitySolution.host.details.overview.machineTypeTitle",{defaultMessage:"Machine type"}),$=j.i18n.translate("xpack.securitySolution.host.details.overview.inspectTitle",{defaultMessage:"Host overview"});var V=a(354);const U=j.i18n.translate("xpack.securitySolution.host.details.endpoint.endpointPolicy",{defaultMessage:"Endpoint integration policy"}),H=j.i18n.translate("xpack.securitySolution.host.details.endpoint.policyStatus",{defaultMessage:"Policy Status"}),G=j.i18n.translate("xpack.securitySolution.host.details.endpoint.sensorversion",{defaultMessage:"Endpoint version"}),Q=j.i18n.translate("xpack.securitySolution.host.details.endpoint.fleetAgentStatus",{defaultMessage:"Agent status"});var W=a(582),K=a(638),Y=a(246);const J=o.a.memo((({contextID:e,data:t})=>{const a=Object(s.useCallback)(((t,a,n)=>o.a.createElement(b.a,{rowItems:[Object(r.getOr)("",t,a)],attrName:n,idPrefix:e?`endpoint-overview-${e}`:"endpoint-overview"})),[e]),i=Object(s.useMemo)((()=>{var e,i,r,s,l,c,u,d,p,m;return[[{title:U,description:null!=t&&null!=t.endpointPolicy?t.endpointPolicy:Object(g.d)()}],[{title:H,description:null!=t&&null!=t.policyStatus?o.a.createElement(n.EuiHealth,{"aria-label":t.policyStatus,color:t.policyStatus===W.a.failure?"danger":t.policyStatus},t.policyStatus):Object(g.d)()}],[{title:G,description:null!=t&&null!=t.sensorVersion?a("sensorVersion",t,"agent.version"):Object(g.d)()}],[{title:Q,description:null!=t&&t.elasticAgentStatus?o.a.createElement(o.a.Fragment,null,o.a.createElement(K.a,{hostStatus:t.elasticAgentStatus}),o.a.createElement(Y.b,{isIsolated:Boolean(t.isolation),pendingActions:{pendingIsolate:null!==(e=null===(i=t.pendingActions)||void 0===i?void 0:i.isolate)&&void 0!==e?e:0,pendingUnIsolate:null!==(r=null===(s=t.pendingActions)||void 0===s?void 0:s.unisolate)&&void 0!==r?r:0,pendingKillProcess:null!==(l=null===(c=t.pendingActions)||void 0===c?void 0:c["kill-process"])&&void 0!==l?l:0,pendingSuspendProcess:null!==(u=null===(d=t.pendingActions)||void 0===d?void 0:d["suspend-process"])&&void 0!==u?u:0,pendingRunningProcesses:null!==(p=null===(m=t.pendingActions)||void 0===m?void 0:m["running-processes"])&&void 0!==p?p:0}})):Object(g.d)()}]]}),[t,a]);return o.a.createElement(o.a.Fragment,null,i.map(((e,t)=>o.a.createElement(V.a,{dataTestSubj:"endpoint-overview",descriptionList:e,key:t}))))}));J.displayName="EndpointOverview";var X=a(291),Z=a(213),ee=a(357);const te=c()(n.EuiFlexGroup).withConfig({displayName:"HostRiskOverviewWrapper",componentId:"sc-16e3omv-0"})(["padding-top:",";width:",";"],(({theme:e})=>e.eui.euiSizeM),(({$width:e})=>e)),ae=o.a.memo((({anomaliesData:e,contextID:t,data:a,endDate:l,id:c,isDraggable:j=!1,isInDetailsSidePanel:U=!1,isLoadingAnomaliesData:H,indexNames:G,loading:Q,narrowDateRange:W,startDate:K,hostName:Y})=>{const ae=Object(x.a)(),ne=Object(v.a)(ae),[ie]=Object(m.q)(p.O),re=Object(s.useMemo)((()=>Y?Object(d.C)([Y]):void 0),[Y]),{from:se,to:oe}=Object(u.a)(),le=Object(s.useMemo)((()=>({from:se,to:oe})),[se,oe]),{data:ce,isLicenseValid:ue}=Object(X.c)({filterQuery:re,riskEntity:d.v.host,skip:null==Y,timerange:le}),de=Object(s.useCallback)(((e,a)=>o.a.createElement(b.a,{rowItems:Object(r.getOr)([],e,a),attrName:e,idPrefix:t?`host-overview-${t}`:"host-overview",isDraggable:j})),[t,j]),[pe,me]=Object(s.useMemo)((()=>{const e=ce&&ce.length>0?ce[0]:void 0;return[{title:o.a.createElement(ee.a,{title:C,riskScoreEntity:d.v.host}),description:o.a.createElement(o.a.Fragment,null,e?Math.round(e.host.risk.calculated_score_norm):Object(g.d)())},{title:o.a.createElement(ee.a,{title:M,riskScoreEntity:d.v.host}),description:o.a.createElement(o.a.Fragment,null,e?o.a.createElement(Z.b,{severity:e.host.risk.calculated_level,hideBackgroundColor:!0}):Object(g.d)())}]}),[ce]),ge=Object(s.useMemo)((()=>[{title:O,description:a&&a.host?Object(b.e)({host:a.host,isDraggable:j,noLink:!0}):Object(g.d)()},{title:w,description:o.a.createElement(f.a,{indexPatterns:G,field:"host.name",value:Y,type:f.b.FIRST_SEEN})},{title:T,description:o.a.createElement(f.a,{indexPatterns:G,field:"host.name",value:Y,type:f.b.LAST_SEEN})}]),[a,G,Y,j]),be=Object(s.useMemo)((()=>ne?[...ge,{title:I,description:o.a.createElement(k.a,{anomalies:e,startDate:K,endDate:l,isLoading:H,narrowDateRange:W})}]:ge),[e,ge,l,H,W,K,ne]),fe=Object(s.useMemo)((()=>[be,[{title:F,description:o.a.createElement(b.a,{rowItems:Object(r.getOr)([],"host.ip",a),attrName:"host.ip",idPrefix:t?`host-overview-${t}`:"host-overview",isDraggable:j,render:e=>null!=e?o.a.createElement(E.h,{ip:e}):Object(g.d)()})},{title:D,description:de("host.mac",a)},{title:A,description:de("host.os.platform",a)}],[{title:_,description:de("host.os.name",a)},{title:N,description:de("host.os.family",a)},{title:R,description:de("host.os.version",a)},{title:P,description:de("host.architecture",a)}],[{title:L,description:de("cloud.provider",a)},{title:B,description:de("cloud.region",a)},{title:q,description:de("cloud.instance.id",a)},{title:z,description:de("cloud.machine.type",a)}]]),[t,a,be,de,j]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(y.c,null,o.a.createElement(S.g,{direction:U?"column":"row","data-test-subj":"host-overview"},!U&&o.a.createElement(y.b,{queryId:c,title:$,inspectIndex:0}),fe.map(((e,t)=>o.a.createElement(V.a,{descriptionList:e,key:t}))),Q&&o.a.createElement(h.a,{overlay:!0,overlayBackground:ie?i.euiDarkVars.euiPageBackgroundColor:i.euiLightVars.euiPageBackgroundColor,size:"xl"}))),ue&&o.a.createElement(te,{gutterSize:U?"m":"none",direction:U?"column":"row","data-test-subj":"host-risk-overview",$width:U?"100%":"50%"},o.a.createElement(n.EuiFlexItem,null,o.a.createElement(S.d,{listItems:[pe]})),o.a.createElement(n.EuiFlexItem,null,o.a.createElement(S.d,{listItems:[me]}))),a&&null!=a.endpoint?o.a.createElement(o.a.Fragment,null,o.a.createElement(n.EuiHorizontalRule,null),o.a.createElement(S.g,{direction:U?"column":"row"},o.a.createElement(J,{contextID:t,data:a.endpoint}),Q&&o.a.createElement(h.a,{overlay:!0,overlayBackground:ie?i.euiDarkVars.euiPageBackgroundColor:i.euiLightVars.euiPageBackgroundColor,size:"xl"}))):null)}));ae.displayName="HostOverview"},function(e,t,a){"use strict";a.d(t,"a",(function(){return x})),a.d(t,"b",(function(){return S}));var n=a(4),i=a.n(n),r=a(33),s=a.n(r),o=a(899),l=a(32),c=a(77);const u=({integration:e})=>{const t=Object(c.e)(),a=e.integrationTitle,n=`${t}/${e.targetUrl}`;return i.a.createElement(l.EuiLink,{href:n,target:"_blank","data-test-subj":"integrationLink"},a)},d=i.a.memo(u);d.displayName="IntegrationLink";var p=a(565);const m=s()(l.EuiBadge).withConfig({displayName:"PaddedBadge",componentId:"sc-q84pbl-0"})(["margin-left:5px;"]),g=({integration:e})=>{const{installationStatus:t}=e;if(!t.isKnown)return null;const{isInstalled:a,isEnabled:n}=t,r=a?"success":"#E0E5EE",s=a?n?p.c:p.e:p.j,o=a?n?p.b:p.d:p.i;return i.a.createElement(l.EuiToolTip,{content:s},i.a.createElement(m,{color:r,"data-test-subj":"statusBadge"},o))},b=i.a.memo(g);b.displayName="IntegrationStatusBadge";const f=s.a.span.withConfig({displayName:"VersionWarningIconContainer",componentId:"sc-1qsec7-0"})(["margin-left:5px;"]),y=({integration:e})=>{const{installationStatus:t}=e;return t.isKnown&&t.isInstalled&&t.isVersionMismatch?i.a.createElement(f,null,i.a.createElement(l.EuiIconTip,{type:"alert",color:"warning",content:p.f(t.installedVersion,e.requiredVersion)})):null},h=i.a.memo(y);h.displayName="IntegrationVersionMismatchIcon";const E=s.a.div.withConfig({displayName:"Wrapper",componentId:"sc-ea1y1-0"})(["overflow:hidden;"]),v=({integration:e})=>i.a.createElement(E,null,i.a.createElement(d,{integration:e})," ",i.a.createElement(b,{integration:e}),i.a.createElement(h,{integration:e})),x=i.a.memo(v),k=({relatedIntegrations:e})=>{const{integrations:t}=Object(o.a)(e);return i.a.createElement(i.a.Fragment,null,t.map(((e,t)=>i.a.createElement(x,{key:`${e.packageName}-${t}`,integration:e}))))},S=(e,t)=>null==t||0===t.length?[]:[{title:e,description:i.a.createElement(k,{relatedIntegrations:t})}]},function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(1057),i=a.n(n),r=a(34),s=a(0);const o=e=>{if(!e)return"";const t=e.split(".")[1];return t?Object(r.startCase)(t):""},l=e=>{const t=[];return Object.entries(e).forEach((([e,a])=>{if(Object(r.isString)(a))try{i.a.render(a,{})}catch(a){t.push((e=>s.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.invalidMustacheTemplateErrorMessage",{defaultMessage:"{key} is not valid mustache template",values:{key:Object(r.startCase)(e)}}))(e))}})),t},c=async(e,t)=>{const a=await(async(e,t)=>{var a;const n=await(null===(a=t.get(e.actionTypeId))||void 0===a?void 0:a.validateParams(e.params));if(n){const e=Object.values(n.errors);if(e.length){const t=e.filter((e=>Object(r.isString)(e)||Object(r.isArray)(e))),a=Object(r.uniq)(Object(r.flattenDeep)(t));if(a.length)return a}}return[]})(e,t);return[...a,...l(e.params)]},u=e=>async(...t)=>{const[{value:a,path:n}]=t,i=[];for(const t of a){const a=await c(t,e);if(a.length){const e=o(t.actionTypeId),n=a.map((e=>`*   ${e}\n`));i.push(`\n**${e}:**\n${n.join("")}`)}}if(i.length)return{code:"ERR_FIELD_FORMAT",path:n,message:`${i.join("\n")}`}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(32),i=a(4),r=a.n(i),s=a(84),o=a(0);const l=o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.cancelTitle",{defaultMessage:"Cancel"}),c=o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.overwriteExceptionLabel",{defaultMessage:'Overwrite existing exception lists with conflicting "list_id"'}),u=e=>o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importExceptionsFailedLabel",{values:{totalExceptions:e},defaultMessage:"Failed to import {totalExceptions} {totalExceptions, plural, =1 {exception} other {exceptions}}"}),d=(e,t,a)=>{const n=a.map((t=>e(t.error.message))),i=new Error(n.join(". "));return i.stack=void 0,i.name="Network errors",i.raw_network_error=t,i},p=({checkBoxLabel:e,closeModal:t,description:a,errorMessage:p,failedDetailed:m,importComplete:g,importData:b,showCheckBox:f=!0,showExceptionsCheckBox:y=!1,showModal:h,submitBtnText:E,subtitle:v,successMessage:x,title:k})=>{const[S,j]=Object(i.useState)(null),[O,w]=Object(i.useState)(!1),[T,I]=Object(i.useState)(!1),[C,M]=Object(i.useState)(!1),{addError:F,addSuccess:D}=Object(s.a)(),A=Object(i.useCallback)((()=>{w(!1),j(null),t(),I(!1),M(!1)}),[w,j,t,I,M]),_=Object(i.useCallback)((async()=>{if(null!=S){w(!0);const e=new AbortController;try{(({importResponse:e,exceptionsIncluded:t,successMessage:a,errorMessage:n,errorMessageDetailed:i,addError:r,addSuccess:s})=>{var l;t?(e.success&&e.success_count>0&&s(a(e.success_count)),e.errors.length>0&&e.rules_count&&r(d(i,e,e.errors),{title:n(e.rules_count-e.success_count)}),e.exceptions_success&&null!=e.exceptions_success_count&&e.exceptions_success_count>0&&s((l=e.exceptions_success_count,o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.exceptionsSuccessLabel",{values:{totalExceptions:l},defaultMessage:"Successfully imported {totalExceptions} {totalExceptions, plural, =1 {exception} other {exceptions}}."}))),null!=e.exceptions_errors&&e.exceptions_errors.length>0&&r(d(i,e,e.exceptions_errors),{title:u(e.exceptions_errors.length)})):(e.success&&s(a(e.success_count)),e.errors.length>0&&r(d(i,e,e.errors),{title:n(e.errors.length)}))})({importResponse:await b({fileToImport:S[0],overwrite:T,overwriteExceptions:C,signal:e.signal}),exceptionsIncluded:y,successMessage:x,errorMessage:p,errorMessageDetailed:m,addError:F,addSuccess:D}),g(),A()}catch(e){A(),F(e,{title:p(1)})}}}),[S,b,T,C,y,x,p,m,F,D,g,A]),N=Object(i.useCallback)((()=>{A()}),[A]),R=Object(i.useCallback)((()=>{I((e=>!e))}),[]),P=Object(i.useCallback)((()=>{M((e=>!e))}),[]);return r.a.createElement(r.a.Fragment,null,h&&r.a.createElement(n.EuiModal,{onClose:N,maxWidth:"750px"},r.a.createElement(n.EuiModalHeader,null,r.a.createElement(n.EuiModalHeaderTitle,null,k)),r.a.createElement(n.EuiModalBody,null,r.a.createElement(n.EuiText,{size:"s"},r.a.createElement("h4",null,a)),r.a.createElement(n.EuiSpacer,{size:"s"}),r.a.createElement(n.EuiFilePicker,{"data-test-subj":"rule-file-picker",accept:".ndjson",id:"rule-file-picker",initialPromptText:v,onChange:e=>{j(e&&e.length>0?e:null)},display:"large",fullWidth:!0,isLoading:O}),r.a.createElement(n.EuiSpacer,{size:"s"}),f&&r.a.createElement(r.a.Fragment,null,r.a.createElement(n.EuiCheckbox,{"data-test-subj":"import-data-modal-checkbox-label",id:"import-data-modal-checkbox-label",label:e,checked:T,onChange:R}),y&&r.a.createElement(n.EuiCheckbox,{"data-test-subj":"import-data-modal-exceptions-checkbox-label",id:"import-data-modal-exceptions-checkbox-label",label:c,checked:C,onChange:P}))),r.a.createElement(n.EuiModalFooter,null,r.a.createElement(n.EuiButtonEmpty,{onClick:N},l),r.a.createElement(n.EuiButton,{"data-test-subj":"import-data-modal-button",onClick:_,disabled:null==S||O,fill:!0},E))))};p.displayName="ImportDataModalComponent";const m=r.a.memo(p);m.displayName="ImportDataModal"},function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(4),i=a.n(n),r=a(78),s=a(586),o=a(230),l=a(143),c=a(90),u=a(273),d=a(274);const p=({combinedQueries:e,filters:t,headerChildren:a,onlyField:p,paddingSize:m,query:g,showLegend:b,setAbsoluteRangeDatePickerTarget:f=c.a.global,runtimeMappings:y})=>{const h=Object(r.useDispatch)(),{signalIndexName:E}=Object(o.a)(),v=(x=t,Object(n.useMemo)((()=>[...x,...Object(d.d)(!1)]),[x]));var x;const k=Object(n.useCallback)((({x:e})=>{if(!e)return;const[t,a]=e;h(Object(l.setAbsoluteRangeDatePicker)({id:f,from:new Date(t).toISOString(),to:new Date(a).toISOString()}))}),[h,f]);return i.a.createElement(s.a,{combinedQueries:e,filters:v,headerChildren:a,legendPosition:"right",onlyField:p,paddingSize:m,query:g,showLegend:b,showLinkToAlerts:null==p,showStackBy:null==p,showTotalAlertsCount:!0,signalIndexName:E,runtimeMappings:y,title:u.a,titleSize:null==p?"m":"s",updateDateRange:k})};p.displayName="SignalsByCategoryComponent";const m=i.a.memo(p)},function(e,t,a){"use strict";a.d(t,"a",(function(){return B}));var n=a(34),i=a(4),r=a.n(i),s=a(78),o=a(42),l=a(180),c=a(155),u=a(414),d=a(559),p=a(94),m=a(107),g=a(233),b=a(694),f=a(77),y=a(98),h=a(95),E=a(159),v=a(419),x=a(292),k=a(146),S=a(826),j=a(32),O=a(33),w=a.n(O),T=a(247),I=a(648);const C=w()(j.EuiFlexGroup).withConfig({displayName:"UtilityBarFlexGroup",componentId:"sc-srl83m-0"})(["min-width:175px;"]),M=w()(j.EuiFlexItem).withConfig({displayName:"AdditionalFiltersItem",componentId:"sc-srl83m-1"})(["padding:",";"],(({theme:e})=>e.eui.euiSizeS)),F=w()(M).withConfig({displayName:"BuildingBlockContainer",componentId:"sc-srl83m-2"})(["background:",";"],(({theme:e})=>e.eui.euiColorHighlight)),D=({areEventsLoading:e,onShowBuildingBlockAlertsChanged:t,showBuildingBlockAlerts:a,onShowOnlyThreatIndicatorAlertsChanged:n,showOnlyThreatIndicatorAlerts:s})=>{const o=Object(i.useCallback)((e=>r.a.createElement(C,{direction:"column",gutterSize:"none"},r.a.createElement(F,null,r.a.createElement(j.EuiCheckbox,{id:"showBuildingBlockAlertsCheckbox","aria-label":"showBuildingBlockAlerts",onChange:a=>{e(),t(a.target.checked)},checked:a,color:"text","data-test-subj":"showBuildingBlockAlertsCheckbox",label:I.b})),r.a.createElement(M,null,r.a.createElement(j.EuiCheckbox,{id:"showOnlyThreatIndicatorAlertsCheckbox","aria-label":"showOnlyThreatIndicatorAlerts",onChange:t=>{e(),n(t.target.checked)},checked:s,color:"text","data-test-subj":"showOnlyThreatIndicatorAlertsCheckbox",label:I.c})))),[t,n,a,s]);return r.a.createElement(T.b,{dataTestSubj:"additionalFilters",disabled:e,iconType:"arrowDown",iconSide:"right",ownFocus:!0,popoverContent:o},I.a)};var A=a(274),_=a(651),N=a(118),R=a(13),P=a(568);const L=({defaultFilters:e,from:t,globalFilters:a,globalQuery:l,hasIndexMaintenance:y,hasIndexWrite:j,isSelectAllChecked:O,loading:w,loadingEventIds:T,onRuleChange:I,onShowBuildingBlockAlertsChanged:C,onShowOnlyThreatIndicatorAlertsChanged:M,showBuildingBlockAlerts:F,showOnlyThreatIndicatorAlerts:L,tableId:B,to:q,filterGroup:z="open"})=>{var $,V;const U=Object(s.useDispatch)(),{globalQueries:H}=Object(s.useSelector)((e=>Object(u.a)(e,B))),{browserFields:G,indexPattern:Q,selectedPatterns:W}=Object(p.d)(h.SourcererScopeName.detections),K=Object(f.k)(),Y=Object(R.b)(),J=Object(R.b)().isEnterprise()?5:4,X=Object(i.useCallback)((n=>null!=G&&null!=Q?Object(k.a)({config:Object(o.getEsQueryConfig)(K.services.uiSettings),dataProviders:[],indexPattern:Q,browserFields:G,filters:[...null!=e?e:[],...a,...n,...Object(_.a)(t,q)],kqlQuery:l,kqlMode:l.language}):null),[G,e,a,l,Q,K,q,t]);Object(g.a)({id:B,filterQuery:null===($=X([]))||void 0===$?void 0:$.filterQuery,kqlError:null===(V=X([]))||void 0===V?void 0:V.kqlError,query:l,startDate:t,endDate:q}),Object(i.useEffect)((()=>{O&&U(c.a.setTGridSelectAll({id:B,selectAll:!1}))}),[U,O,B]);const Z=Object(i.useMemo)((()=>r.a.createElement(D,{areEventsLoading:T.length>0,onShowBuildingBlockAlertsChanged:C,showBuildingBlockAlerts:F,onShowOnlyThreatIndicatorAlertsChanged:M,showOnlyThreatIndicatorAlerts:L})),[T.length,C,M,F,L]),ee=Object(i.useMemo)((()=>{const t=Object(A.a)(z);return Object(n.isEmpty)(e)?t:null==e||Object(n.isEmpty)(e)?void 0:[...e,...t]}),[e,z]),{filterManager:te}=K.services.data.query,ae=Object(m.a)("tGridEnabled");Object(i.useEffect)((()=>{U(c.a.initializeTGridSettings({defaultColumns:Object(S.b)(Y).map((e=>ae||null!=e.initialWidth?e:{...e,initialWidth:E.a})),id:B,loadingText:N.z,queryFields:A.h,title:N.k,showCheckboxes:!0}))}),[U,te,ae,B,Y]);const ne=Object(i.useMemo)((()=>Object(v.a)(J)),[J]),ie=Object(i.useCallback)((e=>{e.forEach((e=>e.refetch&&e.refetch()))}),[]),re=(({onClose:e,onSuccess:t}={})=>{const{cases:a}=Object(f.k)().services,n=Object(f.i)(),r=a.hooks.getUseCasesAddToNewCaseFlyout({onClose:e,onSuccess:t}),s=a.hooks.getUseCasesAddToExistingCaseModal({onClose:e,onRowClick:t});return Object(i.useMemo)((()=>n.create&&n.read?[{label:N.j,key:"attach-new-case","data-test-subj":"attach-new-case",disableOnQuery:!0,disabledLabel:N.h,onClick:e=>{const t=e?a.helpers.groupAlertsByRule(e):[];r.open({attachments:t})}},{label:N.i,key:"attach-existing-case",disableOnQuery:!0,disabledLabel:N.h,"data-test-subj":"attach-existing-case",onClick:e=>{const t=e?a.helpers.groupAlertsByRule(e):[];s.open({attachments:t})}}]:[]),[a.helpers,r,n.create,n.read,s])})(),se=Object(P.a)({localFilters:null!=ee?ee:[],tableId:B,from:t,to:q,scopeId:h.SourcererScopeName.detections}),oe=Object(i.useMemo)((()=>({onAlertStatusActionSuccess:()=>{ie(H)},customBulkActions:[...re,se]})),[H,ie,re,se]);return w||Object(n.isEmpty)(W)?null:r.a.createElement(d.a,{additionalFilters:Z,currentFilter:z,defaultCellActions:b.a,defaultModel:Object(A.f)(Y),end:q,bulkActions:oe,entityType:"events",hasAlertsCrud:j&&y,tableId:B,leadingControlColumns:ne,onRuleChange:I,pageFilters:ee,renderCellValue:S.a,rowRenderers:x.b,scopeId:h.SourcererScopeName.detections,start:t})},B=Object(s.connect)((()=>{const e=c.b.getTableByIdSelector(),t=y.d.globalSelector();return(a,n)=>{var i;const{tableId:r}=n,s=null!==(i=e(a,r))&&void 0!==i?i:l.a,{isSelectAllChecked:o,loadingEventIds:c}=s,u=t(a),{query:d,filters:p}=u;return{globalQuery:d,globalFilters:p,isSelectAllChecked:o,loadingEventIds:c}}}))(r.a.memo(L))},function(e,t,a){"use strict";a.d(t,"a",(function(){return L}));var n=a(34),i=a(4),r=a.n(i),s=a(78),o=a(79),l=a(81),c=a(86),u=a(32),d=a(47),p=a.n(d),m=a(33),g=a.n(m),b=a(87),f=a(604),y=a(106),h=a(410);const E=g()(u.EuiBadge).withConfig({displayName:"ProviderBadgeStyled",componentId:"sc-1kjk6zz-0"})([".euiToolTipAnchor{&::after{font-style:normal;content:'|';padding:0px 3px;}}&.globalFilterItem{white-space:nowrap;min-width:",";display:flex;&.globalFilterItem-isDisabled{text-decoration:line-through;font-weight:400;font-style:italic;}&.globalFilterItem-isError{box-shadow:0 1px 1px -1px rgba(152,162,179,0.2),0 3px 2px -2px rgba(152,162,179,0.2),inset 0 0 0 1px #bd271e;}}"],(({$timelineType:e})=>e===o.n.template?"140px":"none"));E.displayName="ProviderBadgeStyled";const v=g.a.div.withConfig({displayName:"ProviderFieldBadge",componentId:"sc-1kjk6zz-1"})(["display:block;color:#fff;padding:6px 8px;font-size:0.6em;"]),x=g()(v).withConfig({displayName:"StyledTemplateFieldBadge",componentId:"sc-1kjk6zz-2"})(["background:",";text-transform:uppercase;"],(({theme:e})=>e.eui.euiColorVis3_behindText)),k=g()(v).withConfig({displayName:"ConvertFieldBadge",componentId:"sc-1kjk6zz-3"})(["background:",";cursor:pointer;&:hover{text-decoration:underline;}"],(({theme:e})=>e.eui.euiColorDarkShade)),S=({type:e,toggleType:t})=>e!==y.a.template?r.a.createElement(k,{onClick:t},h.d):r.a.createElement(x,null,h.v),j=r.a.memo(S),O={tabIndex:-1},w=r.a.memo((({deleteProvider:e,field:t,isEnabled:a,isExcluded:s,operator:l,providerId:c,togglePopover:u,toggleType:d,displayValue:m,val:g,type:v,timelineType:x})=>{const k=Object(i.useCallback)((t=>{t.stopPropagation&&t.stopPropagation(),e()}),[e]),S=Object(i.useMemo)((()=>p()("globalFilterItem",{"globalFilterItem-isDisabled":!a,"globalFilterItem-isExcluded":s})),[a,s]),w=Object(i.useMemo)((()=>Object(n.isString)(g)&&""===g?Object(b.b)():g),[g]),T=Object(i.useMemo)((()=>s?r.a.createElement("span",null,h.p," "):null),[s]),I=Object(i.useMemo)((()=>r.a.createElement(r.a.Fragment,null,T,l!==y.b?r.a.createElement("span",{className:"field-value"},`${t}: "${"includes"===l?m:w}"`):r.a.createElement("span",{className:"field-value"},t," ",h.j))),[m,t,w,l,T]),C=Object(i.useMemo)((()=>h.u({field:t,value:`${w}`})),[t,w]);return r.a.createElement(f.a,{id:`${c}-${t}-${g}`},r.a.createElement(r.a.Fragment,null,r.a.createElement(E,{className:S,color:"hollow",title:"",iconOnClick:k,iconOnClickAriaLabel:h.s,iconType:"cross",iconSide:"right",onClick:u,onClickAriaLabel:C,closeButtonProps:O,"data-test-subj":"providerBadge",$timelineType:x},I),x===o.n.template&&l!==y.c&&r.a.createElement(j,{toggleType:d,type:v})))}));w.displayName="ProviderBadge";var T=a(6),I=a.n(T),C=a(907);const M="edit-data-provider",F="exclude-data-provider",D="enable-data-provider",A="filter-for-field-present-data-provider",_="delete-data-provider",N=g()(u.EuiPopover).withConfig({displayName:"MyEuiPopover",componentId:"sc-cqo117-0"})(["height:100%;user-select:none;"]);N.displayName="MyEuiPopover";class provider_item_actions_ProviderItemActions extends r.a.PureComponent{constructor(...e){super(...e),I()(this,"onDataProviderEdited",(({andProviderId:e,excluded:t,field:a,id:n,operator:i,providerId:r,value:s,type:o})=>{null!=this.props.onDataProviderEdited&&this.props.onDataProviderEdited({andProviderId:e,excluded:t,field:a,id:n,operator:i,providerId:r,value:s,type:o}),this.props.closePopover()})),I()(this,"onFilterForFieldPresent",(()=>{const{andProviderId:e,field:t,timelineId:a,providerId:n,value:i,type:r}=this.props;null!=this.props.onDataProviderEdited&&this.props.onDataProviderEdited({andProviderId:e,excluded:!1,field:t,id:`${a}`,operator:y.b,providerId:n,value:i,type:r}),this.props.closePopover()}))}render(){const{andProviderId:e,browserFields:t,button:a,closePopover:n,deleteProvider:i,field:s,isEnabled:l,isExcluded:c,isLoading:d,isOpen:p,operator:m,providerId:g,timelineId:b,timelineType:f,toggleEnabledProvider:E,toggleExcludedProvider:v,toggleTypeProvider:x,value:k,type:S}=this.props,j=(({andProviderId:e,browserFields:t,deleteItem:a,field:n,isEnabled:i,isExcluded:s,isLoading:l,operator:c,onDataProviderEdited:u,onFilterForFieldPresent:d,providerId:p,timelineId:m,timelineType:g,toggleEnabled:b,toggleExcluded:f,toggleType:E,type:v,value:x})=>[{id:0,items:[{className:M,disabled:l,icon:"pencil",name:h.g,panel:1},{className:F,disabled:l,icon:s?"plusInCircle":"minusInCircle",name:s?h.o:h.i,onClick:f},{className:D,disabled:l,icon:i?"eyeClosed":"eye",name:i?h.w:h.t,onClick:b},{className:A,disabled:l,icon:"logstashFilter",name:h.k,onClick:d},g===o.n.template?{className:"convert-to-field-data-provider",disabled:l||c===y.c,icon:"visText",name:v===y.a.template?h.c:h.d,onClick:E}:{name:null},{className:_,disabled:l,icon:"trash",name:h.e,onClick:a}].filter((e=>null!=e.name))},{content:null!=t&&null!=m&&null!=u?r.a.createElement(C.a,{andProviderId:e,browserFields:t,field:n,isExcluded:s,onDataProviderEdited:u,operator:c,providerId:p,timelineId:m,value:x,type:v}):null,id:1,title:h.h,width:400}])({andProviderId:e,browserFields:t,deleteItem:i,field:s,isEnabled:l,isExcluded:c,isLoading:d,onDataProviderEdited:this.onDataProviderEdited,onFilterForFieldPresent:this.onFilterForFieldPresent,operator:m,providerId:g,timelineId:b,timelineType:f,toggleEnabled:E,toggleExcluded:v,toggleType:x,value:k,type:S});return r.a.createElement(N,{id:`popoverFor_${g}-${s}-${k}`,isOpen:p,closePopover:n,button:a,anchorPosition:"downCenter",panelPaddingSize:"none",ownFocus:!0},r.a.createElement("div",{style:{userSelect:"none"}},r.a.createElement(u.EuiContextMenu,{initialPanelId:0,panels:j,"data-test-subj":"providerActions"})))}}var R=a(395),P=a(112);const L=r.a.memo((({andProviderId:e,browserFields:t,deleteProvider:a,field:u,kqlQuery:d,isEnabled:p,isExcluded:m,isPopoverOpen:g,onDataProviderEdited:b,operator:f,providerId:h,register:E,setIsPopoverOpen:v,timelineId:x,toggleEnabledProvider:k,toggleExcludedProvider:S,toggleTypeProvider:j,displayValue:O,val:T,type:I=y.a.default,wrapperRef:C})=>{const M=Object(i.useMemo)((()=>c.b.getTimelineByIdSelector()),[]),F=Object(l.b)((e=>{var t,a;return x&&null!==(t=null===(a=M(e,x))||void 0===a?void 0:a.timelineType)&&void 0!==t?t:o.n.default})),{isLoading:D}=Object(l.a)((e=>{var t;return null!==(t=M(e,null!=x?x:""))&&void 0!==t?t:P.b})),A=Object(i.useCallback)((()=>{v(!g)}),[g,v]),_=Object(i.useCallback)((()=>{var e;v(!1),null==C||null===(e=C.current)||void 0===e||e.focus()}),[C,v]),N=Object(i.useCallback)((()=>{k(),_()}),[_,k]),L=Object(i.useCallback)((()=>{S(),_()}),[S,_]),B=Object(i.useCallback)((()=>{j(),_()}),[j,_]),[q,z]=Object(i.useState)(!1),$=Object(s.useDispatch)();Object(i.useEffect)((()=>{null!=E&&($(R.a.registerProvider({provider:{...E,and:[]}})),z(!0))}),[q,$,E,z]);const V=Object(i.useCallback)((()=>{q&&null!=E&&$(R.a.unRegisterProvider({id:E.id}))}),[q,$,E]);Object(i.useEffect)((()=>()=>{V()}),[V]);const U=Object(i.useMemo)((()=>r.a.createElement(w,{deleteProvider:D?n.noop:a,field:u,kqlQuery:d,isEnabled:p,isExcluded:m,providerId:h,togglePopover:A,toggleType:B,displayValue:null!=O?O:String(T),val:T,operator:f,type:I,timelineType:F})),[a,O,u,p,m,D,d,B,f,h,F,A,I,T]);return r.a.createElement(provider_item_actions_ProviderItemActions,{andProviderId:e,browserFields:t,button:U,closePopover:_,deleteProvider:a,field:u,kqlQuery:d,isEnabled:p,isExcluded:m,isLoading:D,isOpen:g,onDataProviderEdited:b,operator:f,providerId:h,timelineId:x,timelineType:F,toggleEnabledProvider:N,toggleExcludedProvider:L,toggleTypeProvider:B,value:T,type:I})}));L.displayName="ProviderItemBadge"},function(e,t,a){"use strict";a.d(t,"a",(function(){return _}));var n=a(4),i=a.n(n),r=a(32),s=a(40),o=a(78),l=a(33),c=a.n(l),u=a(99),d=a(81),p=a(90),m=a(148),g=a(539),b=a(184),f=a(41),y=a(836);function h(e){return e?{timeRange:{from:e.from,to:e.to}}:[]}var E=a(831);const v=i.a.memo((e=>{const t=Object(f.useKibana)(),a=Object(n.useMemo)((()=>function(e){return{relatedEvents:async({entityID:t,timeRange:a,indexPatterns:n})=>({...await e.services.http.post("/api/endpoint/resolver/events",{query:{},body:JSON.stringify({indexPatterns:n,...h(a),filter:JSON.stringify({bool:{filter:[{term:{"process.entity_id":t}},{bool:{must_not:{term:{"event.category":"process"}}}}]}})})}),entityID:t}),eventsWithEntityIDAndCategory({entityID:t,category:a,after:n,timeRange:i,indexPatterns:r}){const s={query:{afterEvent:n,limit:25},body:{...h(i),indexPatterns:r}};return"alert"===a?e.services.http.post("/api/endpoint/resolver/events",{query:s.query,body:JSON.stringify({...s.body,entityType:"alerts",eventID:t})}):e.services.http.post("/api/endpoint/resolver/events",{query:s.query,body:JSON.stringify({...s.body,filter:JSON.stringify({bool:{filter:[{term:{"process.entity_id":t}},{term:{"event.category":a}}]}})})})},async nodeData({ids:t,timeRange:a,indexPatterns:n,limit:i}){const r={query:{limit:i},body:JSON.stringify({indexPatterns:n,...h(a),filter:JSON.stringify({bool:{filter:[{terms:{"process.entity_id":t}},{term:{"event.category":"process"}}]}})})};return(await e.services.http.post("/api/endpoint/resolver/events",r)).events},async event({nodeID:t,eventID:a,eventCategory:n,eventTimestamp:i,winlogRecordID:r,timeRange:s,indexPatterns:o}){const l=void 0===a?{bool:{filter:[{terms:{"event.category":n}},{term:{"process.entity_id":t}},{term:{"@timestamp":i}},{term:{"winlog.record_id":r}}]}}:{bool:{filter:[{term:{"event.id":a}}]}};if(!1===n.includes("alert")){const t=await e.services.http.post("/api/endpoint/resolver/events",{query:{limit:1},body:JSON.stringify({indexPatterns:o,...h(s),filter:JSON.stringify(l)})}),[a]=t.events;return null!=a?a:null}{const t=await e.services.http.post("/api/endpoint/resolver/events",{query:{limit:1},body:JSON.stringify({indexPatterns:o,...h(s),entityType:"alertDetail",eventID:a})}),[n]=t.events;return null!=n?n:null}},resolverTree:async({dataId:t,schema:a,timeRange:n,indices:i,ancestors:r,descendants:s})=>e.services.http.post("/api/endpoint/resolver/tree",{body:JSON.stringify({ancestors:r,descendants:s,timeRange:n,schema:a,nodes:[t],indexPatterns:i})}),entities:async({_id:t,indices:a,signal:n})=>e.services.http.get("/api/endpoint/resolver/entity",{signal:n,query:{_id:t,indices:a}})}}(t)),[t]),r=Object(n.useMemo)((()=>Object(y.a)(a)),[a]),[s,l]=Object(n.useState)(r);return Object(n.useEffect)((()=>{e.shouldUpdate&&l(Object(y.a)(a))}),[a,e.shouldUpdate]),i.a.createElement(o.Provider,{store:s},i.a.createElement(E.a,e))}));var x=a(630),k=a(86),S=a(112),j=a(155),O=a(180);const w="sessionViewFullScreen",T=Object(l.css)(["display:flex;flex-direction:column;flex:1;width:100%;"]),I=c.a.div.withConfig({displayName:"OverlayContainer",componentId:"sc-g96n2a-0"})(["",""],T),C=Object(l.css)(["position:fixed;top:0;bottom:2em;left:0;right:0;z-index:",";"],s.euiThemeVars.euiZLevel3),M=c.a.div.withConfig({displayName:"FullScreenOverlayContainer",componentId:"sc-g96n2a-1"})(["",""],C),F=c()(v).withConfig({displayName:"StyledResolver",componentId:"sc-g96n2a-2"})(["height:100%;"]),D=c()(r.EuiFlexItem).withConfig({displayName:"ScrollableFlexItem",componentId:"sc-g96n2a-3"})([""," overflow:hidden;width:100%;&.","{","}"],(({theme:e})=>`background-color: ${e.eui.euiColorEmptyShade};`),w,(({theme:e})=>`padding: 0 ${e.eui.euiSizeM}`)),A=({SessionView:e,Navigation:t,scopeId:a})=>{const s=Object(o.useDispatch)(),{globalFullScreen:l}=Object(m.a)(),{timelineFullScreen:c}=Object(m.c)(),f=Object(n.useMemo)((()=>Object(u.isInTableScope)(a)?j.b.getTableByIdSelector():Object(u.isTimelineScope)(a)?k.b.getTimelineByIdSelector():void 0),[a]),y=Object(u.isInTableScope)(a)?O.a:S.b,{graphEventId:h,sessionViewConfig:E}=Object(d.a)((e=>{var t;return null!==(t=f&&f(e,a))&&void 0!==t?t:y})),v=Object(n.useMemo)((()=>Object(g.b)({globalFullScreen:l,isActiveTimelines:Object(u.isActiveTimeline)(a),timelineFullScreen:c})),[l,a,c]);Object(n.useEffect)((()=>()=>{const e=Object(u.getScopedActions)(a);e&&s(e.updateGraphEventId({id:a,graphEventId:""})),Object(u.isActiveTimeline)(a)?s(b.b.setFullScreen({id:p.a.timeline,fullScreen:!1})):s(b.b.setFullScreen({id:p.a.global,fullScreen:!1}))}),[s,a]);const{from:A,to:_,shouldUpdate:N,selectedPatterns:R}=Object(x.a)(Object(u.isActiveTimeline)(a)),P=Object(n.useRef)(null);return Object(n.useLayoutEffect)((()=>{v&&P.current?P.current.setAttribute("style",C.join("")):P.current&&P.current.setAttribute("style",T.join(""))}),[v]),Object(u.isActiveTimeline)(a)||null===E?v&&!Object(u.isActiveTimeline)(a)?i.a.createElement(M,{"data-test-subj":"overlayContainer"},i.a.createElement(r.EuiHorizontalRule,{margin:"none"}),i.a.createElement(r.EuiFlexGroup,{gutterSize:"none",justifyContent:"spaceBetween"},i.a.createElement(r.EuiFlexItem,{grow:!1},t)),i.a.createElement(r.EuiHorizontalRule,{margin:"none"}),void 0!==h?i.a.createElement(F,{databaseDocumentID:h,resolverComponentInstanceID:a,indices:R,shouldUpdate:N,filters:{from:A,to:_}}):i.a.createElement(r.EuiFlexGroup,{alignItems:"center",justifyContent:"center",style:{height:"100%"}},i.a.createElement(r.EuiLoadingSpinner,{size:"xl"}))):i.a.createElement(I,{"data-test-subj":"overlayContainer"},i.a.createElement(r.EuiHorizontalRule,{margin:"none"}),i.a.createElement(r.EuiFlexGroup,{gutterSize:"none",justifyContent:"spaceBetween"},i.a.createElement(r.EuiFlexItem,{grow:!1},t)),i.a.createElement(r.EuiHorizontalRule,{margin:"none"}),void 0!==h?i.a.createElement(F,{databaseDocumentID:h,resolverComponentInstanceID:a,indices:R,shouldUpdate:N,filters:{from:A,to:_}}):i.a.createElement(r.EuiFlexGroup,{alignItems:"center",justifyContent:"center",style:{height:"100%"}},i.a.createElement(r.EuiLoadingSpinner,{size:"xl"}))):i.a.createElement(I,{"data-test-subj":"overlayContainer",ref:P},i.a.createElement(r.EuiFlexGroup,{alignItems:"flexStart",gutterSize:"none",direction:"column"},i.a.createElement(r.EuiHorizontalRule,{margin:"none"}),i.a.createElement(r.EuiFlexItem,{grow:!1},t),i.a.createElement(r.EuiHorizontalRule,{margin:"none"}),i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement(D,{grow:2,className:v?w:""},e)))},_=i.a.memo(A)},,function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var n=a(32),i=a(4),r=a.n(i),s=a(33),o=a.n(s),l=a(609),c=a(296),u=a(79);const d=o()(n.EuiFieldText).withConfig({displayName:"StyledEuiFieldText",componentId:"sc-oqcycb-0"})(["padding-left:12px;padding-right:40px;&[readonly]{cursor:pointer;background-size:0 100%;background-repeat:no-repeat;&:focus{background-color:",";background-image:linear-gradient( to top,",","," 2px,transparent 2px,transparent 100% );background-size:100% 100%;}}& + .euiFormControlLayoutIcons{left:unset;right:12px;}"],(({theme:e})=>e.eui.euiFormBackgroundColor),(({theme:e})=>e.eui.euiFocusRingColor),(({theme:e})=>e.eui.euiFocusRingColor)),p=e=>[{description:c.a,favorite:[],label:c.b,id:void 0,title:c.b,checked:"-1"===e?"on":void 0}],m=({isDisabled:e,hideUntitled:t=!1,timelineId:a,timelineTitle:s,timelineType:o=u.n.template,onTimelineChange:m,placeholder:g})=>{const[b,f]=Object(i.useState)(!1),y=Object(i.useCallback)((()=>{f(!1)}),[]),h=Object(i.useCallback)((()=>{f(!0)}),[]),E=Object(i.useMemo)((()=>r.a.createElement(d,{readOnly:!0,disabled:e,onFocus:h,onClick:h,value:null!=s?s:c.b,icon:"arrowDown"})),[h,e,s]),v=Object(i.useCallback)((({timelines:e,onlyFavorites:n,searchTimelineValue:i})=>[...n||""!==i?[]:p(null==a?"-1":a),...e.filter((e=>!t||""!==e.title)).map(((e,t)=>({description:e.description,favorite:e.favorite,label:e.title,id:o===u.n.template?e.templateTimelineId:e.savedObjectId,key:`${e.title}-${t}`,title:e.title,checked:[e.savedObjectId,e.templateTimelineId].includes(a)?"on":void 0})))]),[t,a,o]);return r.a.createElement(n.EuiInputPopover,{id:"searchTimelinePopover",input:E,isOpen:b,closePopover:y},r.a.createElement(l.a,{hideUntitled:t,getSelectableOptions:v,onClosePopover:y,onTimelineChange:m,timelineType:o,placeholder:g}))},g=Object(i.memo)(m);var b=a(100);const f=({dataTestSubj:e,field:t,idAria:a,isDisabled:s=!1,placeholder:o})=>{const[l,c]=Object(i.useState)(null),[u,d]=Object(i.useState)(null),{isInvalid:p,errorMessage:m}=Object(b.i)(t);Object(i.useEffect)((()=>{const{id:e,title:a}=t.value;l!==e&&(c(e),d(a))}),[t.value,l]);const f=Object(i.useCallback)(((e,a)=>{null===a?t.setValue({id:a,title:null}):l!==a&&t.setValue({id:a,title:e})}),[t,l]);return r.a.createElement(n.EuiFormRow,{label:t.label,labelAppend:t.labelAppend,helpText:t.helpText,error:m,isInvalid:p,"data-test-subj":e,describedByIds:a?[a]:void 0},r.a.createElement(g,{isDisabled:s,hideUntitled:!0,timelineId:l,timelineTitle:u,onTimelineChange:f,placeholder:o}))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return c}));var n=a(4),i=a(582),r=a(0);r.i18n.translate("xpack.securitySolution.overviewHost.errorSearchDescription",{defaultMessage:"An error has occurred on host overview search"});const s=r.i18n.translate("xpack.securitySolution.overviewHost.failSearchDescription",{defaultMessage:"Failed to run search on host overview"});var o=a(130);const l="hostsDetailsQuery",c=({endDate:e,hostName:t,indexNames:a,id:r=l,skip:c=!1,startDate:u})=>{const{loading:d,result:p,search:m,refetch:g,inspect:b}=Object(o.a)({factoryQueryType:i.d.details,initialResult:{hostDetails:{}},errorMessage:s,abort:c}),f=Object(n.useMemo)((()=>({endDate:e,hostDetails:p.hostDetails,id:r,inspect:b,isInspected:!1,refetch:g,startDate:u})),[e,p.hostDetails,r,b,g,u]),y=Object(n.useMemo)((()=>({defaultIndex:a,factoryQueryType:i.d.details,hostName:t,timerange:{interval:"12h",from:u,to:e}})),[e,t,a,u]);return Object(n.useEffect)((()=>{c||m(y)}),[y,m,c]),[d,f]}},function(e,t,a){"use strict";a.d(t,"a",(function(){return z}));var n=a(32),i=a(40),r=a(34),s=a(4),o=a.n(s),l=a(33),c=a.n(l),u=a(114),d=a(85),p=a(1),m=a(77),g=a(87),b=a(221),f=a(396),y=a(124),h=a(187),E=a(89),v=a(171),x=a(120),k=a(506),S=a(160),j=a(0);const O=j.i18n.translate("xpack.securitySolution.user.details.overview.userIdTitle",{defaultMessage:"User ID"}),w=j.i18n.translate("xpack.securitySolution.user.details.overview.userDomainTitle",{defaultMessage:"Domain"}),T=j.i18n.translate("xpack.securitySolution.user.details.overview.familyTitle",{defaultMessage:"Family"}),I=j.i18n.translate("xpack.securitySolution.user.details.overview.ipAddressesTitle",{defaultMessage:"IP addresses"}),C=j.i18n.translate("xpack.securitySolution.user.details.overview.osTitle",{defaultMessage:"Operating system"}),M=j.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.firstSeenTitle",{defaultMessage:"First seen"}),F=j.i18n.translate("xpack.securitySolution.user.ipDetails.ipOverview.lastSeenTitle",{defaultMessage:"Last seen"}),D=j.i18n.translate("xpack.securitySolution.user.details.overview.inspectTitle",{defaultMessage:"User overview"}),A=j.i18n.translate("xpack.securitySolution.user.details.overview.maxAnomalyScoreByJobTitle",{defaultMessage:"Max anomaly score by job"}),_=j.i18n.translate("xpack.securitySolution.user.details.overview.userRiskScoreTitle",{defaultMessage:"User risk score"}),N=j.i18n.translate("xpack.securitySolution.user.details.overview.userRiskClassification",{defaultMessage:"User risk classification"});var R=a(354),P=a(291),L=a(213),B=a(357);const q=c()(n.EuiFlexGroup).withConfig({displayName:"UserRiskOverviewWrapper",componentId:"sc-enfgw9-0"})(["padding-top:",";width:",";"],(({theme:e})=>e.eui.euiSizeM),(({$width:e})=>e)),z=o.a.memo((({anomaliesData:e,contextID:t,data:a,id:l,isDraggable:c=!1,isInDetailsSidePanel:j=!1,isLoadingAnomaliesData:z,loading:$,narrowDateRange:V,startDate:U,endDate:H,userName:G,indexPatterns:Q})=>{const W=Object(x.a)(),K=Object(v.a)(W),[Y]=Object(m.q)(p.O),J=Object(s.useMemo)((()=>G?Object(d.D)([G]):void 0),[G]),{from:X,to:Z}=Object(u.a)(),ee=Object(s.useMemo)((()=>({from:X,to:Z})),[X,Z]),{data:te,isLicenseValid:ae}=Object(P.c)({filterQuery:J,skip:null==G,timerange:ee,riskEntity:d.v.user}),ne=Object(s.useCallback)(((e,a)=>o.a.createElement(b.a,{rowItems:Object(r.getOr)([],e,a),attrName:e,idPrefix:t?`user-overview-${t}`:"user-overview",isDraggable:c})),[t,c]),[ie,re]=Object(s.useMemo)((()=>{const e=te&&te.length>0?te[0]:void 0;return[{title:o.a.createElement(B.a,{title:_,riskScoreEntity:d.v.user}),description:o.a.createElement(o.a.Fragment,null,e?Math.round(e.user.risk.calculated_score_norm):Object(g.d)())},{title:o.a.createElement(B.a,{title:N,riskScoreEntity:d.v.host}),description:o.a.createElement(o.a.Fragment,null,e?o.a.createElement(L.b,{severity:e.user.risk.calculated_level,hideBackgroundColor:!0}):Object(g.d)())}]}),[te]),se=Object(s.useMemo)((()=>[{title:O,description:a&&a.user?ne("user.id",a):Object(g.d)()},{title:w,description:a&&a.user?ne("user.domain",a):Object(g.d)()}]),[a,ne]),oe=Object(s.useMemo)((()=>K?[...se,{title:A,description:o.a.createElement(k.a,{anomalies:e,startDate:U,endDate:H,isLoading:z,narrowDateRange:V})}]:se),[e,se,H,z,V,U,K]),le=Object(s.useMemo)((()=>[oe,[{title:M,description:o.a.createElement(f.a,{indexPatterns:Q,field:"user.name",value:G,type:f.b.FIRST_SEEN})},{title:F,description:o.a.createElement(f.a,{indexPatterns:Q,field:"user.name",value:G,type:f.b.LAST_SEEN})}],[{title:C,description:ne("host.os.name",a)},{title:T,description:ne("host.os.family",a)},{title:I,description:o.a.createElement(b.a,{rowItems:Object(r.getOr)([],"host.ip",a),attrName:"host.ip",idPrefix:t?`user-overview-${t}`:"user-overview",isDraggable:c,render:e=>null!=e?o.a.createElement(E.h,{ip:e}):Object(g.d)()})}]]),[a,Q,ne,t,c,G,oe]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(y.c,null,o.a.createElement(S.g,{direction:j?"column":"row","data-test-subj":"user-overview"},!j&&o.a.createElement(y.b,{queryId:l,title:D,inspectIndex:0}),le.map(((e,t)=>o.a.createElement(R.a,{descriptionList:e,key:t}))),$&&o.a.createElement(h.a,{overlay:!0,overlayBackground:Y?i.euiDarkVars.euiPageBackgroundColor:i.euiLightVars.euiPageBackgroundColor,size:"xl"}))),ae&&o.a.createElement(q,{gutterSize:j?"m":"none",direction:j?"column":"row","data-test-subj":"user-risk-overview",$width:j?"100%":"66.6%"},o.a.createElement(n.EuiFlexItem,null,o.a.createElement(S.d,{listItems:[ie]})),o.a.createElement(n.EuiFlexItem,null,o.a.createElement(S.d,{listItems:[re]}))))}));z.displayName="UserOverview"},function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(4);const i=a(0).i18n.translate("xpack.securitySolution.userDetails.failSearchDescription",{defaultMessage:"Failed to run search on user details"});var r=a(838),s=a(130);const o=({endDate:e,userName:t,indexNames:a,id:o="usersDetailsQuery",skip:l=!1,startDate:c})=>{const{loading:u,result:d,search:p,refetch:m,inspect:g}=Object(s.a)({factoryQueryType:r.b.details,initialResult:{userDetails:{}},errorMessage:i,abort:l}),b=Object(n.useMemo)((()=>({endDate:e,userDetails:d.userDetails,id:o,inspect:g,isInspected:!1,refetch:m,startDate:c})),[e,o,g,m,d.userDetails,c]),f=Object(n.useMemo)((()=>({defaultIndex:a,factoryQueryType:r.b.details,userName:t,timerange:{interval:"12h",from:c,to:e}})),[e,a,c,t]);return Object(n.useEffect)((()=>{l||p(f)}),[f,p,l]),[u,b]}},function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(180),i=a(158),r=a(159);const s=[{columnHeaderType:i.a,id:"@timestamp",initialWidth:r.b,esTypes:["date"],type:"date"},{columnHeaderType:i.a,id:"message"},{columnHeaderType:i.a,id:"host.name"},{columnHeaderType:i.a,id:"event.module"},{columnHeaderType:i.a,id:"agent.type"},{columnHeaderType:i.a,id:"event.dataset"},{columnHeaderType:i.a,id:"event.action"},{columnHeaderType:i.a,id:"user.name"},{columnHeaderType:i.a,id:"source.ip"},{columnHeaderType:i.a,id:"destination.ip"}],o={...n.a,columns:s}},function(e,t,a){"use strict";a.d(t,"a",(function(){return x}));var n=a(92),i=a.n(n),r=a(34),s=a(4),o=a(11),l=a(42),c=a(126),u=a(77),d=a(376),p=a(99),m=a(0);const g=m.i18n.translate("xpack.securitySolution.matrixHistogram.errorSearchDescription",{defaultMessage:"An error has occurred on matrix histogram search"}),b=m.i18n.translate("xpack.securitySolution.matrixHistogram.failSearchDescription",{defaultMessage:"Failed to run search on matrix histogram"});var f=a(84),y=a(231),h=a(1);const E=[],v=({endDate:e,errorMessage:t,filterQuery:a,histogramType:n,indexNames:m,isPtrIncluded:v,onError:x,stackByField:k,runtimeMappings:S,startDate:j,threshold:O,skip:w=!1,includeMissingData:T=!0})=>{const{data:I}=Object(u.k)().services,C=Object(s.useRef)(r.noop),M=Object(s.useRef)(new AbortController),F=Object(s.useRef)(new o.Subscription),[D,A]=Object(s.useState)(!1),{startTracking:_}=Object(y.a)(),[N,R]=Object(s.useState)({defaultIndex:m,factoryQueryType:d.i,filterQuery:Object(c.a)(a),histogramType:n,timerange:{interval:"12h",from:j,to:e},stackByField:k,runtimeMappings:S,threshold:O,...null!=v?{isPtrIncluded:v}:{},...null!=T?{includeMissingData:T}:{}}),{addError:P,addWarning:L}=Object(f.a)(),[B,q]=Object(s.useState)({data:[],inspect:{dsl:[],response:[]},refetch:C.current,totalCount:-1,buckets:[]}),z=Object(s.useCallback)((e=>{const a=async()=>{M.current=new AbortController,A(!0);const{endTracking:a}=_({name:`${h.B} matrixHistogram ${n}`});F.current=I.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:M.current.signal}).subscribe({next:e=>{if(Object(l.isCompleteResponse)(e)){const t=Object(r.getOr)(E,d.k[n],e.rawResponse);A(!1),q((a=>({...a,data:e.matrixHistogramData,inspect:Object(p.getInspectResponse)(e,a.inspect),refetch:C.current,totalCount:t.reduce(((e,t)=>t.doc_count+e),0),buckets:t}))),a("success"),F.current.unsubscribe()}else Object(l.isErrorResponse)(e)&&(A(!1),L(g),a("invalid"),F.current.unsubscribe())},error:e=>{A(!1),P(e,{title:null!=t?t:b}),a("error"),F.current.unsubscribe()}})};F.current.unsubscribe(),M.current.abort(),a(),C.current=a}),[I.search,n,L,P,t,_]);return Object(s.useEffect)((()=>{R((t=>{const r={...t,defaultIndex:m,filterQuery:Object(c.a)(a),histogramType:n,timerange:{interval:"12h",from:j,to:e},stackByField:k,threshold:O,...null!=v?{isPtrIncluded:v}:{}};return i()(t,r)?t:r}))}),[m,e,a,j,k,n,O,v]),Object(s.useEffect)((()=>(w||z(N),()=>{F.current.unsubscribe(),M.current.abort()})),[N,z,w]),Object(s.useEffect)((()=>{w&&(A(!1),F.current.unsubscribe(),M.current.abort())}),[w]),[D,B,Object(s.useCallback)(((e,t)=>{z({...N,timerange:{interval:"12h",from:t,to:e}})}),[N,z])]},x=e=>{const[t,a]=v({...e,includeMissingData:!0}),n=Object(s.useMemo)((()=>!e.stackByField.endsWith(".ip")),[e.stackByField]),[i,r]=v({...e,includeMissingData:!1,skip:n||void 0===e.filterQuery}),o=Object(s.useMemo)((()=>t||i),[t,i]),l=Object(s.useMemo)((()=>{if(n)return a;const{data:e,inspect:t,totalCount:i,refetch:s,buckets:l}=a,{data:c,inspect:u,totalCount:d,refetch:p}=r,m=()=>{s(),p()};return o?{data:[],inspect:{dsl:[],response:[]},refetch:m,totalCount:-1,buckets:[]}:{data:[...e,...c],inspect:{dsl:[...t.dsl,...u.dsl],response:[...t.response,...u.response]},totalCount:i+d,refetch:m,buckets:l}}),[o,a,r,n]);return[o,l]}},function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var n=a(32),i=a(4),r=a.n(i),s=a(33),o=a.n(s),l=a(303),c=a(191);const u=o.a.span.withConfig({displayName:"LegendText",componentId:"sc-11u62u-0"})(["font-size:10.5px;"]),d=r.a.memo((({value:e})=>Object(c.a)(e)?r.a.createElement(u,null,e):r.a.createElement(u,{"data-test-subj":"value-wrapper-empty"},l.c)));d.displayName="ValueWrapper";const p=({legendItem:e})=>{const{color:t,value:a}=e;return r.a.createElement(n.EuiText,{size:"xs"},r.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"none",responsive:!1},null!=t&&r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiHealth,{"data-test-subj":"legend-color",color:t})),r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(d,{value:a}))))};p.displayName="LegendItemComponent";const m=r.a.memo(p),g=({legendItems:e})=>0===e.length?null:r.a.createElement(n.EuiText,{size:"xs","data-test-subj":"legend"},r.a.createElement(n.EuiFlexGroup,{direction:"column",gutterSize:"none"},e.map(((e,t)=>r.a.createElement(n.EuiFlexItem,{key:`legend-item-${t}`,grow:!1},r.a.createElement(m,{legendItem:e}),r.a.createElement(n.EuiSpacer,{"data-test-subj":"legend-spacer",size:"s"}))))));g.displayName="LegendComponent";const b=r.a.memo(g)},function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(4),i=a(691),r=a(142),s=a(0);const o=s.i18n.translate("xpack.securitySolution.endpoint.detections.takeAction.responseActionConsole.notSupportedTooltip",{defaultMessage:"Add the Elastic Defend integration via Elastic Agent to enable this feature"}),l=s.i18n.translate("xpack.securitySolution.endpoint.detections.takeAction.responseActionConsole.unenrolledTooltip",{defaultMessage:"Host is no longer enrolled with the Elastic Defend integration"}),c=s.i18n.translate("xpack.securitySolution.endpoint.detections.takeAction.responseActionConsole.loadingTooltip",{defaultMessage:"Loading"}),u=s.i18n.translate("xpack.securitySolution.endpoint.detections.takeAction.responseActionConsole.generalMetadataErrorTooltip",{defaultMessage:"Failed to retrieve Endpoint metadata"}),d=({endpointId:e,onClick:t})=>{const a=Object(i.c)(),{data:s,isFetching:d,error:p}=Object(i.b)(e,{enabled:Boolean(e)}),[m,g]=Object(n.useMemo)((()=>{var t,a;return e?d?[!0,c]:p&&400===(null===(t=p.body)||void 0===t?void 0:t.statusCode)&&null!==(a=p.body)&&void 0!==a&&a.message.includes("unenrolled")||(null==s?void 0:s.host_status)===r.b.UNENROLLED?[!0,l]:p?[!0,u]:[!1,void 0]:[!0,o]}),[s,e,p,d]);return{handleResponseActionsClick:Object(n.useCallback)((()=>{s&&a(s.metadata),t&&t()}),[s,t,a]),isDisabled:m,tooltip:g}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return y}));var n=a(82),i=a.n(n),r=a(4),s=a.n(r),o=a(32),l=a(33),c=a.n(l),u=a(35),d=a(117),p=a(91),m=a(105);const g=c.a.div.withConfig({displayName:"RootContainer",componentId:"sc-nycnfh-0"})(["position:relative;padding-top:",";.body{min-height:",";&-content{position:relative;}}"],(({theme:e})=>e.eui.euiSizeXS),(({theme:e})=>e.eui.gutterTypes.gutterExtraLarge)),b=Object(r.memo)((({"data-test-subj":e})=>s.a.createElement(o.EuiEmptyPrompt,{"data-test-subj":e,title:s.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.endpoint.paginatedContent.noItemsFoundTitle",defaultMessage:"No items found"})})));b.displayName="DefaultNoItemsFound";const f=Object(r.memo)((({message:e,"data-test-subj":t})=>s.a.createElement(o.EuiText,{textAlign:"center","data-test-subj":t},s.a.createElement(o.EuiSpacer,{size:"m"}),s.a.createElement(o.EuiIcon,{type:"minusInCircle",color:"danger"})," ",e,s.a.createElement(o.EuiSpacer,{size:"m"}))));f.displayName="ErrorMessage";const y=Object(r.memo)((({items:e,ItemComponent:t,itemComponentProps:a,itemId:n,onChange:l,pagination:c,loading:u,noItemsMessage:y,error:h,contentClassName:E,"data-test-subj":v,"aria-label":x,className:k,children:S})=>{const[j]=Object(r.useState)(new WeakMap),O=Object(p.a)(v),w=Object(r.useMemo)((()=>Math.ceil(((null==c?void 0:c.totalItemCount)||1)/((null==c?void 0:c.pageSize)||1))),[null==c?void 0:c.pageSize,null==c?void 0:c.totalItemCount]);Object(r.useEffect)((()=>{!u&&w>0&&w<((null==c?void 0:c.pageIndex)||0)+1&&l({pageIndex:w-1,pageSize:(null==c?void 0:c.pageSize)||0})}),[w,l,c,u]);const T=Object(r.useCallback)((e=>{if(null!=c&&c.pageIndex){var t,a;const n=Math.floor((null!==(t=null==c?void 0:c.pageIndex)&&void 0!==t?t:m.b)*(null!==(a=null==c?void 0:c.pageSize)&&void 0!==a?a:m.c)/e);l({pageSize:e,pageIndex:isNaN(n)?m.b:n})}else l({pageSize:e,pageIndex:m.b})}),[l,c]),I=Object(r.useCallback)((e=>{l({pageIndex:e,pageSize:(null==c?void 0:c.pageSize)||m.c})}),[l,null==c?void 0:c.pageSize]),C=Object(r.useMemo)((()=>{if(h)return h instanceof Error?s.a.createElement(f,{message:h.message,"data-test-subj":O("error")}):"string"==typeof h?s.a.createElement(f,{message:h,"data-test-subj":O("error")}):h;const r=t;return e.length?e.map((e=>{let t;return n?t=e[n]:j.has(e)?t=j.get(e):(t=Object(d.v4)(),j.set(e,t)),s.a.createElement(r,i()({},a(e),{key:t}))})):u?void 0:y||s.a.createElement(b,{"data-test-subj":O("noResults")})}),[t,h,O,a,n,j,e,y,u]);return s.a.createElement(g,{"data-test-subj":v,"aria-label":x,className:k},u&&s.a.createElement(o.EuiProgress,{size:"xs",color:"primary",position:"absolute","data-test-subj":O("loader")}),s.a.createElement("div",{className:"body","data-test-subj":O("body")},s.a.createElement("div",{className:`body-content ${E}`},S||C)),c&&(S||e.length>0)&&s.a.createElement("div",{"data-test-subj":O("footer")},s.a.createElement(o.EuiSpacer,{size:"l"}),s.a.createElement(o.EuiTablePagination,{activePage:c.pageIndex,itemsPerPage:c.pageSize,itemsPerPageOptions:c.pageSizeOptions,pageCount:w,showPerPageOptions:c.showPerPageOptions,onChangeItemsPerPage:T,onChangePage:I})))}));y.displayName="PaginatedContent"},,,function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(4),i=a(841),r=a(240),s=a(206),o=a(428);function l(){const e=Object(r.h)(),t=Object(i.b)(),a=Object(s.f)(o.a.getInstance(e),void 0,void 0,{enabled:!1}),{data:l,isFetching:c,refetch:u,isFetched:d}=a,p=Object(n.useMemo)((()=>t.canAccessEndpointManagement&&(t.canIsolateHost||Boolean(null==l?void 0:l.total))),[t.canIsolateHost,t.canAccessEndpointManagement,null==l?void 0:l.total]);return Object(n.useEffect)((()=>{t.canIsolateHost||t.loading||d||c||u()}),[u,d,c,t.canIsolateHost,t.loading]),p}},,,,,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return s}));var n=a(4),i=a(9);const r=()=>{const e=Object(i.h)();return Object(n.useMemo)((()=>o(e)),[e])},s=e=>r().find((({id:t})=>t===e)),o=e=>e.map((e=>({id:e.id,title:e.title,...null!=e.categories?{categories:e.categories}:{},...null!=e.description?{description:e.description}:{},...!0===e.sideNavDisabled?{disabled:!0}:{},...null!=e.landingIcon?{icon:e.landingIcon}:{},...null!=e.landingImage?{image:e.landingImage}:{},...null!=e.skipUrlState?{skipUrlState:e.skipUrlState}:{},...null!=e.isBeta?{isBeta:e.isBeta}:{},...null!=e.betaOptions?{betaOptions:e.betaOptions}:{},...e.links&&e.links.length?{links:o(e.links)}:{}})))},function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+Cjxzdmcgd2lkdGg9IjI1NnB4IiBoZWlnaHQ9IjI1NXB4IiB2aWV3Qm94PSIwIDAgMjU2IDI1NSIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJ4TWlkWU1pZCI+Cgk8Zz4KCQk8cGF0aCBkPSJNMjU1LjIxNDYxNywwLjI1NzU4MDI0NyBMMjU1LjIxNDYxNyw2My45OTM2NzkgTDE5MS42MDk2NzksMTI3LjU5ODYxNyBMMTkxLjYwOTY3OSw2My43Mjk3Nzc4IEwyNTUuMjE0NjE3LDAuMjU3NTgwMjQ3IiBmaWxsPSIjQTU5NkZGIj48L3BhdGg+CgkJPHBhdGggZD0iTTEyOC4wMDYzMjEsMC4yNTc1ODAyNDcgTDEyOC4wMDYzMjEsNjMuOTkzNjc5IEwxOTEuNjExMjU5LDEyNy41OTg2MTcgTDE5MS42MTEyNTksNjMuNzI5Nzc3OCBMMTI4LjAwNjMyMSwwLjI1NzU4MDI0NyIgZmlsbD0iIzAwMDAwMCI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0yNTUuMzQ1Nzc4LDI1NC44MDM3NTMgTDE5MS42MDk2NzksMjU0LjgwMzc1MyBMMTI4LjAwNDc0MSwxOTEuMTk4ODE1IEwxOTEuODcyLDE5MS4xOTg4MTUgTDI1NS4zNDU3NzgsMjU0LjgwMzc1MyIgZmlsbD0iI0E1OTZGRiI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0yNTUuMzQ1Nzc4LDEyNy41OTU0NTcgTDE5MS42MDk2NzksMTI3LjU5NTQ1NyBMMTI4LjAwNDc0MSwxOTEuMjAwMzk1IEwxOTEuODcyLDE5MS4yMDAzOTUgTDI1NS4zNDU3NzgsMTI3LjU5NTQ1NyIgZmlsbD0iIzAwMDAwMCI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0wLjgwMTE4NTE4NSwyNTQuOTM2NDk0IEwwLjgwMTE4NTE4NSwxOTEuMTk4ODE1IEw2NC40MDYxMjM1LDEyNy41OTM4NzcgTDY0LjQwNjEyMzUsMTkxLjQ2MjcxNiBMMC44MDExODUxODUsMjU0LjkzNjQ5NCIgZmlsbD0iI0E1OTZGRiI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0xMjguMDA5NDgxLDI1NC45MzY0OTQgTDEyOC4wMDk0ODEsMTkxLjE5ODgxNSBMNjQuNDA0NTQzMiwxMjcuNTkzODc3IEw2NC40MDQ1NDMyLDE5MS40NjI3MTYgTDEyOC4wMDk0ODEsMjU0LjkzNjQ5NCIgZmlsbD0iIzAwMDAwMCI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0wLjY3MTYwNDkzOCwwLjM4NTU4MDI0NyBMNjQuNDA3NzAzNywwLjM4NTU4MDI0NyBMMTI4LjAxMjY0Miw2My45OTA1MTg1IEw2NC4xNDUzODI3LDYzLjk5MDUxODUgTDAuNjcxNjA0OTM4LDAuMzg1NTgwMjQ3IiBmaWxsPSIjQTU5NkZGIj48L3BhdGg+CgkJPHBhdGggZD0iTTAuNjcxNjA0OTM4LDEyNy41OTM4NzcgTDY0LjQwNzcwMzcsMTI3LjU5Mzg3NyBMMTI4LjAxMjY0Miw2My45ODg5MzgzIEw2NC4xNDUzODI3LDYzLjk4ODkzODMgTDAuNjcxNjA0OTM4LDEyNy41OTM4NzciIGZpbGw9IiMwMDAwMDAiPjwvcGF0aD4KCTwvZz4KPC9zdmc+Cg=="},function(e,t,a){e.exports=a.p+"ed6ae68d913c232ecd384fa643fb5d97.svg"},function(e,t,a){e.exports=a.p+"9084b765fae17c788e62c5caa2fd0c56.svg"},function(e,t,a){e.exports=a.p+"b3f78a837df74b5c68f457351e9f23e3.svg"},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=a(4),r=(n=a(944))&&"object"==typeof n&&"default"in n?n.default:n,s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])},s(e,t)},o=function(){return o=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},o.apply(this,arguments)},l={top:{width:"100%",height:"10px",top:"-5px",left:"0px",cursor:"row-resize"},right:{width:"10px",height:"100%",top:"0px",right:"-5px",cursor:"col-resize"},bottom:{width:"100%",height:"10px",bottom:"-5px",left:"0px",cursor:"row-resize"},left:{width:"10px",height:"100%",top:"0px",left:"-5px",cursor:"col-resize"},topRight:{width:"20px",height:"20px",position:"absolute",right:"-10px",top:"-10px",cursor:"ne-resize"},bottomRight:{width:"20px",height:"20px",position:"absolute",right:"-10px",bottom:"-10px",cursor:"se-resize"},bottomLeft:{width:"20px",height:"20px",position:"absolute",left:"-10px",bottom:"-10px",cursor:"sw-resize"},topLeft:{width:"20px",height:"20px",position:"absolute",left:"-10px",top:"-10px",cursor:"nw-resize"}};function c(e){return i.createElement("div",{className:e.className||"",style:o({position:"absolute",userSelect:"none"},l[e.direction],e.replaceStyles||{}),onMouseDown:function(t){e.onResizeStart(t,e.direction)},onTouchStart:function(t){e.onResizeStart(t,e.direction)}},e.children)}var u={width:"auto",height:"auto"},d=r((function(e,t,a){return Math.max(Math.min(e,a),t)})),p=r((function(e,t){return Math.round(e/t)*t})),m=r((function(e,t){return new RegExp(e,"i").test(t)})),g=r((function(e,t,a){void 0===a&&(a=0);var n=t.reduce((function(a,n,i){return Math.abs(n-e)<Math.abs(t[a]-e)?i:a}),0),i=Math.abs(t[n]-e);return 0===a||i<a?t[n]:e})),b=r((function(e,t){return e.substr(e.length-t.length,t.length)===t})),f=r((function(e){return"auto"===(e=e.toString())||b(e,"px")||b(e,"%")||b(e,"vh")||b(e,"vw")||b(e,"vmax")||b(e,"vmin")?e:e+"px"})),y=function(e,t){if(e&&"string"==typeof e){if(b(e,"%"))return t*(Number(e.replace("%",""))/100);if(b(e,"vw")){var a=Number(e.replace("vw",""))/100;return window.innerWidth*a}if(b(e,"vh"))return a=Number(e.replace("vh",""))/100,window.innerHeight*a}return e},h=r((function(e,t,a,n,i){return t=y(t,e.width),a=y(a,e.height),n=y(n,e.width),i=y(i,e.height),{maxWidth:void 0===t?void 0:Number(t),maxHeight:void 0===a?void 0:Number(a),minWidth:void 0===n?void 0:Number(n),minHeight:void 0===i?void 0:Number(i)}})),E=["style","className","grid","snap","bounds","size","defaultSize","minWidth","minHeight","maxWidth","maxHeight","lockAspectRatio","lockAspectRatioExtraWidth","lockAspectRatioExtraHeight","enable","handleStyles","handleClasses","handleWrapperStyle","handleWrapperClass","children","onResizeStart","onResize","onResizeStop","handleComponent","scale","resizeRatio","snapGap"],v="__resizable_base__",x=function(e){function t(t){var a=e.call(this,t)||this;return a.ratio=1,a.resizable=null,a.parentLeft=0,a.parentTop=0,a.resizableLeft=0,a.resizableTop=0,a.targetLeft=0,a.targetTop=0,a.state={isResizing:!1,resizeCursor:"auto",width:void 0===(a.propsSize&&a.propsSize.width)?"auto":a.propsSize&&a.propsSize.width,height:void 0===(a.propsSize&&a.propsSize.height)?"auto":a.propsSize&&a.propsSize.height,direction:"right",original:{x:0,y:0,width:0,height:0}},a.onResizeStart=a.onResizeStart.bind(a),a.onMouseMove=a.onMouseMove.bind(a),a.onMouseUp=a.onMouseUp.bind(a),a}return function(e,t){function a(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}(t,e),Object.defineProperty(t.prototype,"parentNode",{get:function(){return this.resizable?this.resizable.parentNode:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"propsSize",{get:function(){return this.props.size||this.props.defaultSize||u},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"base",{get:function(){var e=this.parentNode;if(e)for(var t=0,a=[].slice.call(e.children);t<a.length;t++){var n=a[t];if(n instanceof HTMLElement&&n.classList.contains(v))return n}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){var e=0,t=0;if("undefined"!=typeof window&&this.resizable){var a=this.resizable.offsetWidth,n=this.resizable.offsetHeight,i=this.resizable.style.position;"relative"!==i&&(this.resizable.style.position="relative"),e="auto"!==this.resizable.style.width?this.resizable.offsetWidth:a,t="auto"!==this.resizable.style.height?this.resizable.offsetHeight:n,this.resizable.style.position=i}return{width:e,height:t}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sizeStyle",{get:function(){var e=this,t=this.props.size,a=function(t){if(void 0===e.state[t]||"auto"===e.state[t])return"auto";if(e.propsSize&&e.propsSize[t]&&b(e.propsSize[t].toString(),"%")){if(b(e.state[t].toString(),"%"))return e.state[t].toString();var a=e.getParentSize();return Number(e.state[t].toString().replace("px",""))/a[t]*100+"%"}return f(e.state[t])};return{width:t&&void 0!==t.width&&!this.state.isResizing?f(t.width):a("width"),height:t&&void 0!==t.height&&!this.state.isResizing?f(t.height):a("height")}},enumerable:!0,configurable:!0}),t.prototype.getParentSize=function(){if(!this.base||!this.parentNode)return{width:window.innerWidth,height:window.innerHeight};var e=!1,t=this.parentNode.style.flexWrap,a=this.base.style.minWidth;"wrap"!==t&&(e=!0,this.parentNode.style.flexWrap="wrap"),this.base.style.position="relative",this.base.style.minWidth="100%";var n={width:this.base.offsetWidth,height:this.base.offsetHeight};return this.base.style.position="absolute",e&&(this.parentNode.style.flexWrap=t),this.base.style.minWidth=a,n},t.prototype.bindEvents=function(){"undefined"!=typeof window&&(window.addEventListener("mouseup",this.onMouseUp),window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("mouseleave",this.onMouseUp),window.addEventListener("touchmove",this.onMouseMove),window.addEventListener("touchend",this.onMouseUp))},t.prototype.unbindEvents=function(){"undefined"!=typeof window&&(window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseleave",this.onMouseUp),window.removeEventListener("touchmove",this.onMouseMove),window.removeEventListener("touchend",this.onMouseUp))},t.prototype.componentDidMount=function(){this.setState({width:this.state.width||this.size.width,height:this.state.height||this.size.height});var e=this.parentNode;if(e instanceof HTMLElement&&!this.base){var t=document.createElement("div");t.style.width="100%",t.style.height="100%",t.style.position="absolute",t.style.transform="scale(0, 0)",t.style.left="0",t.style.flex="0",t.classList?t.classList.add(v):t.className+=v,e.appendChild(t)}},t.prototype.componentWillUnmount=function(){if("undefined"!=typeof window){this.unbindEvents();var e=this.parentNode;if(!this.base||!e)return;if(!(e instanceof HTMLElement&&this.base instanceof Node))return;e.removeChild(this.base)}},t.prototype.createSizeForCssProperty=function(e,t){var a=this.propsSize&&this.propsSize[t];return"auto"!==this.state[t]||this.state.original[t]!==e||void 0!==a&&"auto"!==a?e:"auto"},t.prototype.calculateNewMaxFromBoundary=function(e,t){if("parent"===this.props.bounds){var a=this.parentNode;if(a instanceof HTMLElement){var n=a.offsetWidth+(this.parentLeft-this.resizableLeft),i=a.offsetHeight+(this.parentTop-this.resizableTop);e=e&&e<n?e:n,t=t&&t<i?t:i}}else"window"===this.props.bounds?"undefined"!=typeof window&&(n=window.innerWidth-this.resizableLeft,i=window.innerHeight-this.resizableTop,e=e&&e<n?e:n,t=t&&t<i?t:i):this.props.bounds instanceof HTMLElement&&(n=this.props.bounds.offsetWidth+(this.targetLeft-this.resizableLeft),i=this.props.bounds.offsetHeight+(this.targetTop-this.resizableTop),e=e&&e<n?e:n,t=t&&t<i?t:i);return{maxWidth:e,maxHeight:t}},t.prototype.calculateNewSizeFromDirection=function(e,t){var a=this.props.scale||1,n=this.props.resizeRatio||1,i=this.state,r=i.direction,s=i.original,o=this.props,l=o.lockAspectRatio,c=o.lockAspectRatioExtraHeight,u=o.lockAspectRatioExtraWidth,d=s.width,p=s.height,g=c||0,b=u||0;return m("right",r)&&(d=s.width+(e-s.x)*n/a,l&&(p=(d-b)/this.ratio+g)),m("left",r)&&(d=s.width-(e-s.x)*n/a,l&&(p=(d-b)/this.ratio+g)),m("bottom",r)&&(p=s.height+(t-s.y)*n/a,l&&(d=(p-g)*this.ratio+b)),m("top",r)&&(p=s.height-(t-s.y)*n/a,l&&(d=(p-g)*this.ratio+b)),{newWidth:d,newHeight:p}},t.prototype.calculateNewSizeFromAspectRatio=function(e,t,a,n){var i=this.props,r=i.lockAspectRatio,s=i.lockAspectRatioExtraHeight,o=i.lockAspectRatioExtraWidth,l=void 0===n.width?10:n.width,c=void 0===a.width||a.width<0?e:a.width,u=void 0===n.height?10:n.height,p=void 0===a.height||a.height<0?t:a.height,m=s||0,g=o||0;if(r){var b=(u-m)*this.ratio+g,f=(p-m)*this.ratio+g,y=(l-g)/this.ratio+m,h=(c-g)/this.ratio+m,E=Math.max(l,b),v=Math.min(c,f),x=Math.max(u,y),k=Math.min(p,h);e=d(e,E,v),t=d(t,x,k)}else e=d(e,l,c),t=d(t,u,p);return{newWidth:e,newHeight:t}},t.prototype.setBoundingClientRect=function(){if("parent"===this.props.bounds){var e=this.parentNode;if(e instanceof HTMLElement){var t=e.getBoundingClientRect();this.parentLeft=t.left,this.parentTop=t.top}}if(this.props.bounds instanceof HTMLElement){var a=this.props.bounds.getBoundingClientRect();this.targetLeft=a.left,this.targetTop=a.top}if(this.resizable){var n=this.resizable.getBoundingClientRect(),i=n.left,r=n.top;this.resizableLeft=i,this.resizableTop=r}},t.prototype.onResizeStart=function(e,t){var a=0,n=0;if(e.nativeEvent instanceof MouseEvent){if(a=e.nativeEvent.clientX,n=e.nativeEvent.clientY,3===e.nativeEvent.which)return}else e.nativeEvent instanceof TouchEvent&&(a=e.nativeEvent.touches[0].clientX,n=e.nativeEvent.touches[0].clientY);this.props.onResizeStart&&this.resizable&&!1===this.props.onResizeStart(e,t,this.resizable)||(this.props.size&&(void 0!==this.props.size.height&&this.props.size.height!==this.state.height&&this.setState({height:this.props.size.height}),void 0!==this.props.size.width&&this.props.size.width!==this.state.width&&this.setState({width:this.props.size.width})),this.ratio="number"==typeof this.props.lockAspectRatio?this.props.lockAspectRatio:this.size.width/this.size.height,this.setBoundingClientRect(),this.bindEvents(),this.setState({original:{x:a,y:n,width:this.size.width,height:this.size.height},isResizing:!0,resizeCursor:window.getComputedStyle(e.target).cursor||"auto",direction:t}))},t.prototype.onMouseMove=function(e){if(this.state.isResizing&&this.resizable){var t=this.props,a=t.maxWidth,n=t.maxHeight,i=t.minWidth,r=t.minHeight,s=e instanceof MouseEvent?e.clientX:e.touches[0].clientX,o=e instanceof MouseEvent?e.clientY:e.touches[0].clientY,l=this.state,c=l.direction,u=l.original,d=l.width,m=l.height,f=this.getParentSize(),y=h(f,a,n,i,r);a=y.maxWidth,n=y.maxHeight,i=y.minWidth,r=y.minHeight;var E=this.calculateNewSizeFromDirection(s,o),v=E.newHeight,x=E.newWidth,k=this.calculateNewMaxFromBoundary(a,n),S=this.calculateNewSizeFromAspectRatio(x,v,{width:k.maxWidth,height:k.maxHeight},{width:i,height:r});if(x=S.newWidth,v=S.newHeight,this.props.grid){var j=p(x,this.props.grid[0]),O=p(v,this.props.grid[1]),w=this.props.snapGap||0;x=0===w||Math.abs(j-x)<=w?j:x,v=0===w||Math.abs(O-v)<=w?O:v}this.props.snap&&this.props.snap.x&&(x=g(x,this.props.snap.x,this.props.snapGap)),this.props.snap&&this.props.snap.y&&(v=g(v,this.props.snap.y,this.props.snapGap));var T={width:x-u.width,height:v-u.height};d&&"string"==typeof d&&(b(d,"%")?x=x/f.width*100+"%":b(d,"vw")?x=x/window.innerWidth*100+"vw":b(d,"vh")&&(x=x/window.innerHeight*100+"vh")),m&&"string"==typeof m&&(b(m,"%")?v=v/f.height*100+"%":b(m,"vw")?v=v/window.innerWidth*100+"vw":b(m,"vh")&&(v=v/window.innerHeight*100+"vh")),this.setState({width:this.createSizeForCssProperty(x,"width"),height:this.createSizeForCssProperty(v,"height")}),this.props.onResize&&this.props.onResize(e,c,this.resizable,T)}},t.prototype.onMouseUp=function(e){var t=this.state,a=t.isResizing,n=t.direction,i=t.original;if(a&&this.resizable){var r={width:this.size.width-i.width,height:this.size.height-i.height};this.props.onResizeStop&&this.props.onResizeStop(e,n,this.resizable,r),this.props.size&&this.setState(this.props.size),this.unbindEvents(),this.setState({isResizing:!1,resizeCursor:"auto"})}},t.prototype.updateSize=function(e){this.setState({width:e.width,height:e.height})},t.prototype.renderResizer=function(){var e=this,t=this.props,a=t.enable,n=t.handleStyles,r=t.handleClasses,s=t.handleWrapperStyle,o=t.handleWrapperClass,l=t.handleComponent;if(!a)return null;var u=Object.keys(a).map((function(t){return!1!==a[t]?i.createElement(c,{key:t,direction:t,onResizeStart:e.onResizeStart,replaceStyles:n&&n[t],className:r&&r[t]},l&&l[t]?l[t]:null):null}));return i.createElement("span",{className:o,style:s},u)},t.prototype.render=function(){var e=this,t=Object.keys(this.props).reduce((function(t,a){return-1!==E.indexOf(a)||(t[a]=e.props[a]),t}),{});return i.createElement("div",o({ref:function(t){t&&(e.resizable=t)},style:o({position:"relative",userSelect:this.state.isResizing?"none":"auto"},this.props.style,this.sizeStyle,{maxWidth:this.props.maxWidth,maxHeight:this.props.maxHeight,minWidth:this.props.minWidth,minHeight:this.props.minHeight,boxSizing:"border-box",flexShrink:0}),className:this.props.className},t),this.state.isResizing&&i.createElement("div",{style:{height:"100%",width:"100%",backgroundColor:"rgba(0,0,0,0)",cursor:""+(this.state.resizeCursor||"auto"),opacity:0,position:"fixed",zIndex:9999,top:"0",left:"0",bottom:"0",right:"0"}}),this.props.children,this.renderResizer())},t.defaultProps={onResizeStart:function(){},onResize:function(){},onResizeStop:function(){},enable:{top:!0,right:!0,bottom:!0,left:!0,topRight:!0,bottomRight:!0,bottomLeft:!0,topLeft:!0},style:{},grid:[1,1],lockAspectRatio:!1,lockAspectRatioExtraWidth:0,lockAspectRatioExtraHeight:0,scale:1,resizeRatio:1,snapGap:0},t}(i.PureComponent);t.Resizable=x},function(e,t){function a(e,t,a,n){var i,r=null==(i=n)||"number"==typeof i||"boolean"==typeof i?n:a(n),s=t.get(r);return void 0===s&&(s=e.call(this,n),t.set(r,s)),s}function n(e,t,a){var n=Array.prototype.slice.call(arguments,3),i=a(n),r=t.get(i);return void 0===r&&(r=e.apply(this,n),t.set(i,r)),r}function i(e,t,a,n,i){return a.bind(t,e,n,i)}function r(e,t){return i(e,this,1===e.length?a:n,t.cache.create(),t.serializer)}function s(){return JSON.stringify(arguments)}function o(){this.cache=Object.create(null)}o.prototype.has=function(e){return e in this.cache},o.prototype.get=function(e){return this.cache[e]},o.prototype.set=function(e,t){this.cache[e]=t};var l={create:function(){return new o}};e.exports=function(e,t){var a=t&&t.cache?t.cache:l,n=t&&t.serializer?t.serializer:s;return(t&&t.strategy?t.strategy:r)(e,{cache:a,serializer:n})},e.exports.strategies={variadic:function(e,t){return i(e,this,n,t.cache.create(),t.serializer)},monadic:function(e,t){return i(e,this,a,t.cache.create(),t.serializer)}}},function(e,t,a){e.exports=a(27)(17)},function(e,t,a){e.exports=a(27)(16)},function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(948);case"v8light":return a(950)}},function(e,t,a){var n=a(250),i=a(949);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);n(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,a){(t=a(251)(!1)).push([e.i,".kbnFieldButton{align-items:center;border-radius:6px;display:flex;font-size:14px;font-size:1rem;line-height:1.71429rem;margin-bottom:4px;transition:box-shadow .15s cubic-bezier(.694,.0482,.335,1),background-color .15s cubic-bezier(.694,.0482,.335,1)}.kbnFieldButton-isActive,.kbnFieldButton:focus-within{outline:2px solid currentColor}.kbnFieldButton-isActive:focus-visible,.kbnFieldButton:focus-within:focus-visible{outline-style:auto}.kbnFieldButton-isActive:not(:focus-visible),.kbnFieldButton:focus-within:not(:focus-visible){outline:none}.kbnFieldButton--isDraggable{background:#25262e}.kbnFieldButton--isDraggable:focus,.kbnFieldButton--isDraggable:focus-within,.kbnFieldButton--isDraggable:hover{border-radius:6px;box-shadow:0 .9px 4px -1px #0003,0 2.6px 8px -1px #00000026,0 5.7px 12px -1px rgba(0,0,0,.125),0 15px 15px -1px #0000001a;z-index:2}.kbnFieldButton--isDraggable .kbnFieldButton__button:focus,.kbnFieldButton--isDraggable .kbnFieldButton__button:hover{cursor:grab}.kbnFieldButton__button{align-items:flex-start;display:flex;flex-grow:1;line-height:normal;padding:8px;text-align:left}.kbnFieldButton__fieldIcon{flex-shrink:0;line-height:0;margin-right:8px}.kbnFieldButton__name{flex-grow:1;word-break:break-word}.kbnFieldButton__infoIcon{flex-shrink:0;margin-left:4px}.kbnFieldButton__fieldAction{margin-right:8px}.kbnFieldButton--small{font-size:12px}.kbnFieldButton--small .kbnFieldButton__button{padding:4px}.kbnFieldButton--small .kbnFieldButton__fieldAction,.kbnFieldButton--small .kbnFieldButton__fieldIcon{margin-right:4px}",""]),e.exports=t},function(e,t,a){var n=a(250),i=a(951);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);n(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,a){(t=a(251)(!1)).push([e.i,".kbnFieldButton{align-items:center;border-radius:6px;display:flex;font-size:14px;font-size:1rem;line-height:1.71429rem;margin-bottom:4px;transition:box-shadow .15s cubic-bezier(.694,.0482,.335,1),background-color .15s cubic-bezier(.694,.0482,.335,1)}.kbnFieldButton-isActive,.kbnFieldButton:focus-within{outline:2px solid currentColor}.kbnFieldButton-isActive:focus-visible,.kbnFieldButton:focus-within:focus-visible{outline-style:auto}.kbnFieldButton-isActive:not(:focus-visible),.kbnFieldButton:focus-within:not(:focus-visible){outline:none}.kbnFieldButton--isDraggable{background:#fff}.kbnFieldButton--isDraggable:focus,.kbnFieldButton--isDraggable:focus-within,.kbnFieldButton--isDraggable:hover{border-radius:6px;box-shadow:0 .9px 4px -1px #00000014,0 2.6px 8px -1px #0000000f,0 5.7px 12px -1px #0000000d,0 15px 15px -1px #0000000a;z-index:2}.kbnFieldButton--isDraggable .kbnFieldButton__button:focus,.kbnFieldButton--isDraggable .kbnFieldButton__button:hover{cursor:grab}.kbnFieldButton__button{align-items:flex-start;display:flex;flex-grow:1;line-height:normal;padding:8px;text-align:left}.kbnFieldButton__fieldIcon{flex-shrink:0;line-height:0;margin-right:8px}.kbnFieldButton__name{flex-grow:1;word-break:break-word}.kbnFieldButton__infoIcon{flex-shrink:0;margin-left:4px}.kbnFieldButton__fieldAction{margin-right:8px}.kbnFieldButton--small{font-size:12px}.kbnFieldButton--small .kbnFieldButton__button{padding:4px}.kbnFieldButton--small .kbnFieldButton__fieldAction,.kbnFieldButton--small .kbnFieldButton__fieldIcon{margin-right:4px}",""]),e.exports=t},function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI4IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMSAwSDB2OGg4VjdIMVYweiIgZmlsbD0iI0QzREFFNiIvPjwvc3ZnPg=="},function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2NCIgaGVpZ2h0PSI2NCIgdmlld0JveD0iMCAwIDY0IDY0Ij4KICA8ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgPHBhdGggZmlsbD0iI0YwNEU5OCIgZD0iTTI5LDMyLjAwMDEgTDE1LjkzNSw5LjQzMjEgQzEzLjQ4LDUuMTk0MSA3LDYuOTM1MSA3LDExLjgzMjEgTDcsNTIuMTY4MSBDNyw1Ny4wNjUxIDEzLjQ4LDU4LjgwNjEgMTUuOTM1LDU0LjU2NzEgTDI5LDMyLjAwMDEgWiIvPgogICAgPHBhdGggZmlsbD0iI0ZBNzQ0RSIgZD0iTTM0Ljc3NzMsMzIuMDAwMSBMMzMuMzI3MywzNC41MDUxIEwyMC4yNjEzLDU3LjA3MzEgQzE5Ljg0NzMsNTcuNzg3MSAxOS4zNTMzLDU4LjQyNzEgMTguODAyMyw1OS4wMDAxIEwzNC45MjczLDU5LjAwMDEgQzM4LjcwNzMsNTkuMDAwMSA0Mi4yMjEzLDU3LjA2MDEgNDQuMjM2Myw1My44NjExIEw1OC4wMDAzLDMyLjAwMDEgTDM0Ljc3NzMsMzIuMDAwMSBaIi8+CiAgICA8cGF0aCBmaWxsPSIjMzQzNzQxIiBkPSJNNDQuMjM2MywxMC4xMzkyIEM0Mi4yMjEzLDYuOTQwMiAzOC43MDczLDUuMDAwMiAzNC45MjczLDUuMDAwMiBMMTguODAyMyw1LjAwMDIgQzE5LjM1MzMsNS41NzMyIDE5Ljg0NzMsNi4yMTIyIDIwLjI2MTMsNi45MjcyIEwzMy4zMjczLDI5LjQ5NDIgTDM0Ljc3NzMsMzIuMDAwMiBMNTguMDAwMywzMi4wMDAyIEw0NC4yMzYzLDEwLjEzOTIgWiIvPgogIDwvZz4KPC9zdmc+Cg=="},function(e,t,a){!function(e,t,a,n,i,r){"use strict";function s(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function o(e,t){switch(arguments.length){case 0:break;case 1:"function"==typeof e?this.interpolator(e):this.range(e);break;default:this.domain(e),"function"==typeof t?this.interpolator(t):this.range(t)}return this}const l=Symbol("implicit");function c(){var e=new Map,t=[],a=[],n=l;function i(i){var r=i+"",s=e.get(r);if(!s){if(n!==l)return n;e.set(r,s=t.push(i))}return a[(s-1)%a.length]}return i.domain=function(a){if(!arguments.length)return t.slice();t=[],e=new Map;for(const n of a){const a=n+"";e.has(a)||e.set(a,t.push(n))}return i},i.range=function(e){return arguments.length?(a=Array.from(e),i):a.slice()},i.unknown=function(e){return arguments.length?(n=e,i):n},i.copy=function(){return c(t,a).unknown(n)},s.apply(i,arguments),i}function u(){var e,a,n=c().unknown(void 0),i=n.domain,r=n.range,o=0,l=1,d=!1,p=0,m=0,g=.5;function b(){var n=i().length,s=l<o,c=s?l:o,u=s?o:l;e=(u-c)/Math.max(1,n-p+2*m),d&&(e=Math.floor(e)),c+=(u-c-e*(n-p))*g,a=e*(1-p),d&&(c=Math.round(c),a=Math.round(a));var b=t.range(n).map((function(t){return c+e*t}));return r(s?b.reverse():b)}return delete n.unknown,n.domain=function(e){return arguments.length?(i(e),b()):i()},n.range=function(e){return arguments.length?([o,l]=e,o=+o,l=+l,b()):[o,l]},n.rangeRound=function(e){return[o,l]=e,o=+o,l=+l,d=!0,b()},n.bandwidth=function(){return a},n.step=function(){return e},n.round=function(e){return arguments.length?(d=!!e,b()):d},n.padding=function(e){return arguments.length?(p=Math.min(1,m=+e),b()):p},n.paddingInner=function(e){return arguments.length?(p=Math.min(1,e),b()):p},n.paddingOuter=function(e){return arguments.length?(m=+e,b()):m},n.align=function(e){return arguments.length?(g=Math.max(0,Math.min(1,e)),b()):g},n.copy=function(){return u(i(),[o,l]).round(d).paddingInner(p).paddingOuter(m).align(g)},s.apply(b(),arguments)}function d(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return d(t())},e}function p(e){return+e}var m=[0,1];function g(e){return e}function b(e,t){return(t-=e=+e)?function(a){return(a-e)/t}:(a=isNaN(t)?NaN:.5,function(){return a});var a}function f(e,t,a){var n=e[0],i=e[1],r=t[0],s=t[1];return i<n?(n=b(i,n),r=a(s,r)):(n=b(n,i),r=a(r,s)),function(e){return r(n(e))}}function y(e,a,n){var i=Math.min(e.length,a.length)-1,r=new Array(i),s=new Array(i),o=-1;for(e[i]<e[0]&&(e=e.slice().reverse(),a=a.slice().reverse());++o<i;)r[o]=b(e[o],e[o+1]),s[o]=n(a[o],a[o+1]);return function(a){var n=t.bisect(e,a,1,i)-1;return s[n](r[n](a))}}function h(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function E(){var e,t,n,i,r,s,o=m,l=m,c=a.interpolate,u=g;function d(){var e,t,a,n=Math.min(o.length,l.length);return u!==g&&(e=o[0],t=o[n-1],e>t&&(a=e,e=t,t=a),u=function(a){return Math.max(e,Math.min(t,a))}),i=n>2?y:f,r=s=null,b}function b(t){return null==t||isNaN(t=+t)?n:(r||(r=i(o.map(e),l,c)))(e(u(t)))}return b.invert=function(n){return u(t((s||(s=i(l,o.map(e),a.interpolateNumber)))(n)))},b.domain=function(e){return arguments.length?(o=Array.from(e,p),d()):o.slice()},b.range=function(e){return arguments.length?(l=Array.from(e),d()):l.slice()},b.rangeRound=function(e){return l=Array.from(e),c=a.interpolateRound,d()},b.clamp=function(e){return arguments.length?(u=!!e||g,d()):u!==g},b.interpolate=function(e){return arguments.length?(c=e,d()):c},b.unknown=function(e){return arguments.length?(n=e,b):n},function(a,n){return e=a,t=n,d()}}function v(){return E()(g,g)}function x(e,a,i,r){var s,o=t.tickStep(e,a,i);switch((r=n.formatSpecifier(null==r?",f":r)).type){case"s":var l=Math.max(Math.abs(e),Math.abs(a));return null!=r.precision||isNaN(s=n.precisionPrefix(o,l))||(r.precision=s),n.formatPrefix(r,l);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(s=n.precisionRound(o,Math.max(Math.abs(e),Math.abs(a))))||(r.precision=s-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(s=n.precisionFixed(o))||(r.precision=s-2*("%"===r.type))}return n.format(r)}function k(e){var a=e.domain;return e.ticks=function(e){var n=a();return t.ticks(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,t){var n=a();return x(n[0],n[n.length-1],null==e?10:e,t)},e.nice=function(n){null==n&&(n=10);var i,r,s=a(),o=0,l=s.length-1,c=s[o],u=s[l],d=10;for(u<c&&(r=c,c=u,u=r,r=o,o=l,l=r);d-- >0;){if((r=t.tickIncrement(c,u,n))===i)return s[o]=c,s[l]=u,a(s);if(r>0)c=Math.floor(c/r)*r,u=Math.ceil(u/r)*r;else{if(!(r<0))break;c=Math.ceil(c*r)/r,u=Math.floor(u*r)/r}i=r}return e},e}function S(e,t){var a,n=0,i=(e=e.slice()).length-1,r=e[n],s=e[i];return s<r&&(a=n,n=i,i=a,a=r,r=s,s=a),e[n]=t.floor(r),e[i]=t.ceil(s),e}function j(e){return Math.log(e)}function O(e){return Math.exp(e)}function w(e){return-Math.log(-e)}function T(e){return-Math.exp(-e)}function I(e){return isFinite(e)?+("1e"+e):e<0?0:e}function C(e){return function(t){return-e(-t)}}function M(e){var a,i,r=e(j,O),s=r.domain,o=10;function l(){return a=function(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}(o),i=function(e){return 10===e?I:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}(o),s()[0]<0?(a=C(a),i=C(i),e(w,T)):e(j,O),r}return r.base=function(e){return arguments.length?(o=+e,l()):o},r.domain=function(e){return arguments.length?(s(e),l()):s()},r.ticks=function(e){var n,r=s(),l=r[0],c=r[r.length-1];(n=c<l)&&(m=l,l=c,c=m);var u,d,p,m=a(l),g=a(c),b=null==e?10:+e,f=[];if(!(o%1)&&g-m<b){if(m=Math.floor(m),g=Math.ceil(g),l>0){for(;m<=g;++m)for(d=1,u=i(m);d<o;++d)if(!((p=u*d)<l)){if(p>c)break;f.push(p)}}else for(;m<=g;++m)for(d=o-1,u=i(m);d>=1;--d)if(!((p=u*d)<l)){if(p>c)break;f.push(p)}2*f.length<b&&(f=t.ticks(l,c,b))}else f=t.ticks(m,g,Math.min(g-m,b)).map(i);return n?f.reverse():f},r.tickFormat=function(e,t){if(null==t&&(t=10===o?".0e":","),"function"!=typeof t&&(t=n.format(t)),e===1/0)return t;null==e&&(e=10);var s=Math.max(1,o*e/r.ticks().length);return function(e){var n=e/i(Math.round(a(e)));return n*o<o-.5&&(n*=o),n<=s?t(e):""}},r.nice=function(){return s(S(s(),{floor:function(e){return i(Math.floor(a(e)))},ceil:function(e){return i(Math.ceil(a(e)))}}))},r}function F(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function D(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function A(e){var t=1,a=e(F(t),D(t));return a.constant=function(a){return arguments.length?e(F(t=+a),D(t)):t},k(a)}function _(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function N(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function R(e){return e<0?-e*e:e*e}function P(e){var t=e(g,g),a=1;function n(){return 1===a?e(g,g):.5===a?e(N,R):e(_(a),_(1/a))}return t.exponent=function(e){return arguments.length?(a=+e,n()):a},k(t)}function L(){var e=P(E());return e.copy=function(){return h(e,L()).exponent(e.exponent())},s.apply(e,arguments),e}function B(e){return Math.sign(e)*e*e}function q(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function z(e){return new Date(e)}function $(e){return e instanceof Date?+e:+new Date(+e)}function V(e,t,a,n,i,r,s,o,l,c){var u=v(),d=u.invert,p=u.domain,m=c(".%L"),g=c(":%S"),b=c("%I:%M"),f=c("%I %p"),y=c("%a %d"),E=c("%b %d"),x=c("%B"),k=c("%Y");function j(e){return(l(e)<e?m:o(e)<e?g:s(e)<e?b:r(e)<e?f:n(e)<e?i(e)<e?y:E:a(e)<e?x:k)(e)}return u.invert=function(e){return new Date(d(e))},u.domain=function(e){return arguments.length?p(Array.from(e,$)):p().map(z)},u.ticks=function(t){var a=p();return e(a[0],a[a.length-1],null==t?10:t)},u.tickFormat=function(e,t){return null==t?j:c(t)},u.nice=function(e){var a=p();return e&&"function"==typeof e.range||(e=t(a[0],a[a.length-1],null==e?10:e)),e?p(S(a,e)):u},u.copy=function(){return h(u,V(e,t,a,n,i,r,s,o,l,c))},u}function U(){var e,t,n,i,r,s=0,o=1,l=g,c=!1;function u(t){return null==t||isNaN(t=+t)?r:l(0===n?.5:(t=(i(t)-e)*n,c?Math.max(0,Math.min(1,t)):t))}function d(e){return function(t){var a,n;return arguments.length?([a,n]=t,l=e(a,n),u):[l(0),l(1)]}}return u.domain=function(a){return arguments.length?([s,o]=a,e=i(s=+s),t=i(o=+o),n=e===t?0:1/(t-e),u):[s,o]},u.clamp=function(e){return arguments.length?(c=!!e,u):c},u.interpolator=function(e){return arguments.length?(l=e,u):l},u.range=d(a.interpolate),u.rangeRound=d(a.interpolateRound),u.unknown=function(e){return arguments.length?(r=e,u):r},function(a){return i=a,e=a(s),t=a(o),n=e===t?0:1/(t-e),u}}function H(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function G(){var e=P(U());return e.copy=function(){return H(e,G()).exponent(e.exponent())},o.apply(e,arguments)}function Q(){var e,t,n,i,r,s,o,l=0,c=.5,u=1,d=1,p=g,m=!1;function b(e){return isNaN(e=+e)?o:(e=.5+((e=+s(e))-t)*(d*e<d*t?i:r),p(m?Math.max(0,Math.min(1,e)):e))}function f(e){return function(t){var n,i,r;return arguments.length?([n,i,r]=t,p=a.piecewise(e,[n,i,r]),b):[p(0),p(.5),p(1)]}}return b.domain=function(a){return arguments.length?([l,c,u]=a,e=s(l=+l),t=s(c=+c),n=s(u=+u),i=e===t?0:.5/(t-e),r=t===n?0:.5/(n-t),d=t<e?-1:1,b):[l,c,u]},b.clamp=function(e){return arguments.length?(m=!!e,b):m},b.interpolator=function(e){return arguments.length?(p=e,b):p},b.range=f(a.interpolate),b.rangeRound=f(a.interpolateRound),b.unknown=function(e){return arguments.length?(o=e,b):o},function(a){return s=a,e=a(l),t=a(c),n=a(u),i=e===t?0:.5/(t-e),r=t===n?0:.5/(n-t),d=t<e?-1:1,b}}function W(){var e=P(Q());return e.copy=function(){return H(e,W()).exponent(e.exponent())},o.apply(e,arguments)}e.scaleBand=u,e.scaleDiverging=function e(){var t=k(Q()(g));return t.copy=function(){return H(t,e())},o.apply(t,arguments)},e.scaleDivergingLog=function e(){var t=M(Q()).domain([.1,1,10]);return t.copy=function(){return H(t,e()).base(t.base())},o.apply(t,arguments)},e.scaleDivergingPow=W,e.scaleDivergingSqrt=function(){return W.apply(null,arguments).exponent(.5)},e.scaleDivergingSymlog=function e(){var t=A(Q());return t.copy=function(){return H(t,e()).constant(t.constant())},o.apply(t,arguments)},e.scaleIdentity=function e(t){var a;function n(e){return null==e||isNaN(e=+e)?a:e}return n.invert=n,n.domain=n.range=function(e){return arguments.length?(t=Array.from(e,p),n):t.slice()},n.unknown=function(e){return arguments.length?(a=e,n):a},n.copy=function(){return e(t).unknown(a)},t=arguments.length?Array.from(t,p):[0,1],k(n)},e.scaleImplicit=l,e.scaleLinear=function e(){var t=v();return t.copy=function(){return h(t,e())},s.apply(t,arguments),k(t)},e.scaleLog=function e(){var t=M(E()).domain([1,10]);return t.copy=function(){return h(t,e()).base(t.base())},s.apply(t,arguments),t},e.scaleOrdinal=c,e.scalePoint=function(){return d(u.apply(null,arguments).paddingInner(1))},e.scalePow=L,e.scaleQuantile=function e(){var a,n=[],i=[],r=[];function o(){var e=0,a=Math.max(1,i.length);for(r=new Array(a-1);++e<a;)r[e-1]=t.quantileSorted(n,e/a);return l}function l(e){return null==e||isNaN(e=+e)?a:i[t.bisect(r,e)]}return l.invertExtent=function(e){var t=i.indexOf(e);return t<0?[NaN,NaN]:[t>0?r[t-1]:n[0],t<r.length?r[t]:n[n.length-1]]},l.domain=function(e){if(!arguments.length)return n.slice();n=[];for(let t of e)null==t||isNaN(t=+t)||n.push(t);return n.sort(t.ascending),o()},l.range=function(e){return arguments.length?(i=Array.from(e),o()):i.slice()},l.unknown=function(e){return arguments.length?(a=e,l):a},l.quantiles=function(){return r.slice()},l.copy=function(){return e().domain(n).range(i).unknown(a)},s.apply(l,arguments)},e.scaleQuantize=function e(){var a,n=0,i=1,r=1,o=[.5],l=[0,1];function c(e){return null!=e&&e<=e?l[t.bisect(o,e,0,r)]:a}function u(){var e=-1;for(o=new Array(r);++e<r;)o[e]=((e+1)*i-(e-r)*n)/(r+1);return c}return c.domain=function(e){return arguments.length?([n,i]=e,n=+n,i=+i,u()):[n,i]},c.range=function(e){return arguments.length?(r=(l=Array.from(e)).length-1,u()):l.slice()},c.invertExtent=function(e){var t=l.indexOf(e);return t<0?[NaN,NaN]:t<1?[n,o[0]]:t>=r?[o[r-1],i]:[o[t-1],o[t]]},c.unknown=function(e){return arguments.length?(a=e,c):c},c.thresholds=function(){return o.slice()},c.copy=function(){return e().domain([n,i]).range(l).unknown(a)},s.apply(k(c),arguments)},e.scaleRadial=function e(){var t,a=v(),n=[0,1],i=!1;function r(e){var n=q(a(e));return isNaN(n)?t:i?Math.round(n):n}return r.invert=function(e){return a.invert(B(e))},r.domain=function(e){return arguments.length?(a.domain(e),r):a.domain()},r.range=function(e){return arguments.length?(a.range((n=Array.from(e,p)).map(B)),r):n.slice()},r.rangeRound=function(e){return r.range(e).round(!0)},r.round=function(e){return arguments.length?(i=!!e,r):i},r.clamp=function(e){return arguments.length?(a.clamp(e),r):a.clamp()},r.unknown=function(e){return arguments.length?(t=e,r):t},r.copy=function(){return e(a.domain(),n).round(i).clamp(a.clamp()).unknown(t)},s.apply(r,arguments),k(r)},e.scaleSequential=function e(){var t=k(U()(g));return t.copy=function(){return H(t,e())},o.apply(t,arguments)},e.scaleSequentialLog=function e(){var t=M(U()).domain([1,10]);return t.copy=function(){return H(t,e()).base(t.base())},o.apply(t,arguments)},e.scaleSequentialPow=G,e.scaleSequentialQuantile=function e(){var a=[],n=g;function i(e){if(null!=e&&!isNaN(e=+e))return n((t.bisect(a,e,1)-1)/(a.length-1))}return i.domain=function(e){if(!arguments.length)return a.slice();a=[];for(let t of e)null==t||isNaN(t=+t)||a.push(t);return a.sort(t.ascending),i},i.interpolator=function(e){return arguments.length?(n=e,i):n},i.range=function(){return a.map(((e,t)=>n(t/(a.length-1))))},i.quantiles=function(e){return Array.from({length:e+1},((n,i)=>t.quantile(a,i/e)))},i.copy=function(){return e(n).domain(a)},o.apply(i,arguments)},e.scaleSequentialSqrt=function(){return G.apply(null,arguments).exponent(.5)},e.scaleSequentialSymlog=function e(){var t=A(U());return t.copy=function(){return H(t,e()).constant(t.constant())},o.apply(t,arguments)},e.scaleSqrt=function(){return L.apply(null,arguments).exponent(.5)},e.scaleSymlog=function e(){var t=A(E());return t.copy=function(){return h(t,e()).constant(t.constant())},s.apply(t,arguments)},e.scaleThreshold=function e(){var a,n=[.5],i=[0,1],r=1;function o(e){return null!=e&&e<=e?i[t.bisect(n,e,0,r)]:a}return o.domain=function(e){return arguments.length?(n=Array.from(e),r=Math.min(n.length,i.length-1),o):n.slice()},o.range=function(e){return arguments.length?(i=Array.from(e),r=Math.min(n.length,i.length-1),o):i.slice()},o.invertExtent=function(e){var t=i.indexOf(e);return[n[t-1],n[t]]},o.unknown=function(e){return arguments.length?(a=e,o):a},o.copy=function(){return e().domain(n).range(i).unknown(a)},s.apply(o,arguments)},e.scaleTime=function(){return s.apply(V(i.timeTicks,i.timeTickInterval,i.timeYear,i.timeMonth,i.timeWeek,i.timeDay,i.timeHour,i.timeMinute,i.timeSecond,r.timeFormat).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},e.scaleUtc=function(){return s.apply(V(i.utcTicks,i.utcTickInterval,i.utcYear,i.utcMonth,i.utcWeek,i.utcDay,i.utcHour,i.utcMinute,i.utcSecond,r.utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)},e.tickFormat=x,Object.defineProperty(e,"__esModule",{value:!0})}(t,a(641),a(955),a(957),a(642),a(958))},function(e,t,a){!function(e,t){"use strict";function a(e,t,a,n,i){var r=e*e,s=r*e;return((1-3*e+3*r-s)*t+(4-6*r+3*s)*a+(1+3*e+3*r-3*s)*n+s*i)/6}function n(e){var t=e.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),r=e[i],s=e[i+1],o=i>0?e[i-1]:2*r-s,l=i<t-1?e[i+2]:2*s-r;return a((n-i/t)*t,o,r,s,l)}}function i(e){var t=e.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*t),r=e[(i+t-1)%t],s=e[i%t],o=e[(i+1)%t],l=e[(i+2)%t];return a((n-i/t)*t,r,s,o,l)}}var r=e=>()=>e;function s(e,t){return function(a){return e+a*t}}function o(e,t){var a=t-e;return a?s(e,a>180||a<-180?a-360*Math.round(a/360):a):r(isNaN(e)?t:e)}function l(e){return 1==(e=+e)?c:function(t,a){return a-t?function(e,t,a){return e=Math.pow(e,a),t=Math.pow(t,a)-e,a=1/a,function(n){return Math.pow(e+n*t,a)}}(t,a,e):r(isNaN(t)?a:t)}}function c(e,t){var a=t-e;return a?s(e,a):r(isNaN(e)?t:e)}var u=function e(a){var n=l(a);function i(e,a){var i=n((e=t.rgb(e)).r,(a=t.rgb(a)).r),r=n(e.g,a.g),s=n(e.b,a.b),o=c(e.opacity,a.opacity);return function(t){return e.r=i(t),e.g=r(t),e.b=s(t),e.opacity=o(t),e+""}}return i.gamma=e,i}(1);function d(e){return function(a){var n,i,r=a.length,s=new Array(r),o=new Array(r),l=new Array(r);for(n=0;n<r;++n)i=t.rgb(a[n]),s[n]=i.r||0,o[n]=i.g||0,l[n]=i.b||0;return s=e(s),o=e(o),l=e(l),i.opacity=1,function(e){return i.r=s(e),i.g=o(e),i.b=l(e),i+""}}}var p=d(n),m=d(i);function g(e,t){t||(t=[]);var a,n=e?Math.min(t.length,e.length):0,i=t.slice();return function(r){for(a=0;a<n;++a)i[a]=e[a]*(1-r)+t[a]*r;return i}}function b(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function f(e,t){var a,n=t?t.length:0,i=e?Math.min(n,e.length):0,r=new Array(i),s=new Array(n);for(a=0;a<i;++a)r[a]=S(e[a],t[a]);for(;a<n;++a)s[a]=t[a];return function(e){for(a=0;a<i;++a)s[a]=r[a](e);return s}}function y(e,t){var a=new Date;return e=+e,t=+t,function(n){return a.setTime(e*(1-n)+t*n),a}}function h(e,t){return e=+e,t=+t,function(a){return e*(1-a)+t*a}}function E(e,t){var a,n={},i={};for(a in null!==e&&"object"==typeof e||(e={}),null!==t&&"object"==typeof t||(t={}),t)a in e?n[a]=S(e[a],t[a]):i[a]=t[a];return function(e){for(a in n)i[a]=n[a](e);return i}}var v=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,x=new RegExp(v.source,"g");function k(e,t){var a,n,i,r=v.lastIndex=x.lastIndex=0,s=-1,o=[],l=[];for(e+="",t+="";(a=v.exec(e))&&(n=x.exec(t));)(i=n.index)>r&&(i=t.slice(r,i),o[s]?o[s]+=i:o[++s]=i),(a=a[0])===(n=n[0])?o[s]?o[s]+=n:o[++s]=n:(o[++s]=null,l.push({i:s,x:h(a,n)})),r=x.lastIndex;return r<t.length&&(i=t.slice(r),o[s]?o[s]+=i:o[++s]=i),o.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var a,n=0;n<t;++n)o[(a=l[n]).i]=a.x(e);return o.join("")})}function S(e,a){var n,i=typeof a;return null==a||"boolean"===i?r(a):("number"===i?h:"string"===i?(n=t.color(a))?(a=n,u):k:a instanceof t.color?u:a instanceof Date?y:b(a)?g:Array.isArray(a)?f:"function"!=typeof a.valueOf&&"function"!=typeof a.toString||isNaN(a)?E:h)(e,a)}var j,O=180/Math.PI,w={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function T(e,t,a,n,i,r){var s,o,l;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(l=e*a+t*n)&&(a-=e*l,n-=t*l),(o=Math.sqrt(a*a+n*n))&&(a/=o,n/=o,l/=o),e*n<t*a&&(e=-e,t=-t,l=-l,s=-s),{translateX:i,translateY:r,rotate:Math.atan2(t,e)*O,skewX:Math.atan(l)*O,scaleX:s,scaleY:o}}function I(e,t,a,n){function i(e){return e.length?e.pop()+" ":""}return function(r,s){var o=[],l=[];return r=e(r),s=e(s),function(e,n,i,r,s,o){if(e!==i||n!==r){var l=s.push("translate(",null,t,null,a);o.push({i:l-4,x:h(e,i)},{i:l-2,x:h(n,r)})}else(i||r)&&s.push("translate("+i+t+r+a)}(r.translateX,r.translateY,s.translateX,s.translateY,o,l),function(e,t,a,r){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),r.push({i:a.push(i(a)+"rotate(",null,n)-2,x:h(e,t)})):t&&a.push(i(a)+"rotate("+t+n)}(r.rotate,s.rotate,o,l),function(e,t,a,r){e!==t?r.push({i:a.push(i(a)+"skewX(",null,n)-2,x:h(e,t)}):t&&a.push(i(a)+"skewX("+t+n)}(r.skewX,s.skewX,o,l),function(e,t,a,n,r,s){if(e!==a||t!==n){var o=r.push(i(r)+"scale(",null,",",null,")");s.push({i:o-4,x:h(e,a)},{i:o-2,x:h(t,n)})}else 1===a&&1===n||r.push(i(r)+"scale("+a+","+n+")")}(r.scaleX,r.scaleY,s.scaleX,s.scaleY,o,l),r=s=null,function(e){for(var t,a=-1,n=l.length;++a<n;)o[(t=l[a]).i]=t.x(e);return o.join("")}}}var C=I((function(e){const t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?w:T(t.a,t.b,t.c,t.d,t.e,t.f)}),"px, ","px)","deg)"),M=I((function(e){return null==e?w:(j||(j=document.createElementNS("http://www.w3.org/2000/svg","g")),j.setAttribute("transform",e),(e=j.transform.baseVal.consolidate())?T((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):w)}),", ",")",")");function F(e){return((e=Math.exp(e))+1/e)/2}var D=function e(t,a,n){function i(e,i){var r,s,o=e[0],l=e[1],c=e[2],u=i[0],d=i[1],p=i[2],m=u-o,g=d-l,b=m*m+g*g;if(b<1e-12)s=Math.log(p/c)/t,r=function(e){return[o+e*m,l+e*g,c*Math.exp(t*e*s)]};else{var f=Math.sqrt(b),y=(p*p-c*c+n*b)/(2*c*a*f),h=(p*p-c*c-n*b)/(2*p*a*f),E=Math.log(Math.sqrt(y*y+1)-y),v=Math.log(Math.sqrt(h*h+1)-h);s=(v-E)/t,r=function(e){var n,i=e*s,r=F(E),u=c/(a*f)*(r*(n=t*i+E,((n=Math.exp(2*n))-1)/(n+1))-function(e){return((e=Math.exp(e))-1/e)/2}(E));return[o+u*m,l+u*g,c*r/F(t*i+E)]}}return r.duration=1e3*s*t/Math.SQRT2,r}return i.rho=function(t){var a=Math.max(.001,+t),n=a*a;return e(a,n,n*n)},i}(Math.SQRT2,2,4);function A(e){return function(a,n){var i=e((a=t.hsl(a)).h,(n=t.hsl(n)).h),r=c(a.s,n.s),s=c(a.l,n.l),o=c(a.opacity,n.opacity);return function(e){return a.h=i(e),a.s=r(e),a.l=s(e),a.opacity=o(e),a+""}}}var _=A(o),N=A(c);function R(e){return function(a,n){var i=e((a=t.hcl(a)).h,(n=t.hcl(n)).h),r=c(a.c,n.c),s=c(a.l,n.l),o=c(a.opacity,n.opacity);return function(e){return a.h=i(e),a.c=r(e),a.l=s(e),a.opacity=o(e),a+""}}}var P=R(o),L=R(c);function B(e){return function a(n){function i(a,i){var r=e((a=t.cubehelix(a)).h,(i=t.cubehelix(i)).h),s=c(a.s,i.s),o=c(a.l,i.l),l=c(a.opacity,i.opacity);return function(e){return a.h=r(e),a.s=s(e),a.l=o(Math.pow(e,n)),a.opacity=l(e),a+""}}return n=+n,i.gamma=a,i}(1)}var q=B(o),z=B(c);e.interpolate=S,e.interpolateArray=function(e,t){return(b(t)?g:f)(e,t)},e.interpolateBasis=n,e.interpolateBasisClosed=i,e.interpolateCubehelix=q,e.interpolateCubehelixLong=z,e.interpolateDate=y,e.interpolateDiscrete=function(e){var t=e.length;return function(a){return e[Math.max(0,Math.min(t-1,Math.floor(a*t)))]}},e.interpolateHcl=P,e.interpolateHclLong=L,e.interpolateHsl=_,e.interpolateHslLong=N,e.interpolateHue=function(e,t){var a=o(+e,+t);return function(e){var t=a(e);return t-360*Math.floor(t/360)}},e.interpolateLab=function(e,a){var n=c((e=t.lab(e)).l,(a=t.lab(a)).l),i=c(e.a,a.a),r=c(e.b,a.b),s=c(e.opacity,a.opacity);return function(t){return e.l=n(t),e.a=i(t),e.b=r(t),e.opacity=s(t),e+""}},e.interpolateNumber=h,e.interpolateNumberArray=g,e.interpolateObject=E,e.interpolateRgb=u,e.interpolateRgbBasis=p,e.interpolateRgbBasisClosed=m,e.interpolateRound=function(e,t){return e=+e,t=+t,function(a){return Math.round(e*(1-a)+t*a)}},e.interpolateString=k,e.interpolateTransformCss=C,e.interpolateTransformSvg=M,e.interpolateZoom=D,e.piecewise=function(e,t){void 0===t&&(t=e,e=S);for(var a=0,n=t.length-1,i=t[0],r=new Array(n<0?0:n);a<n;)r[a]=e(i,i=t[++a]);return function(e){var t=Math.max(0,Math.min(n-1,Math.floor(e*=n)));return r[t](e-t)}},e.quantize=function(e,t){for(var a=new Array(t),n=0;n<t;++n)a[n]=e(n/(t-1));return a},Object.defineProperty(e,"__esModule",{value:!0})}(t,a(956))},function(e,t,a){!function(e){"use strict";function t(e,t,a){e.prototype=t.prototype=a,a.constructor=e}function a(e,t){var a=Object.create(e.prototype);for(var n in t)a[n]=t[n];return a}function n(){}var i=.7,r=1/i,s="\\s*([+-]?\\d+)\\s*",o="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",l="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",c=/^#([0-9a-f]{3,8})$/,u=new RegExp("^rgb\\("+[s,s,s]+"\\)$"),d=new RegExp("^rgb\\("+[l,l,l]+"\\)$"),p=new RegExp("^rgba\\("+[s,s,s,o]+"\\)$"),m=new RegExp("^rgba\\("+[l,l,l,o]+"\\)$"),g=new RegExp("^hsl\\("+[o,l,l]+"\\)$"),b=new RegExp("^hsla\\("+[o,l,l,o]+"\\)$"),f={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function y(){return this.rgb().formatHex()}function h(){return this.rgb().formatRgb()}function E(e){var t,a;return e=(e+"").trim().toLowerCase(),(t=c.exec(e))?(a=t[1].length,t=parseInt(t[1],16),6===a?v(t):3===a?new j(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===a?x(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===a?x(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=u.exec(e))?new j(t[1],t[2],t[3],1):(t=d.exec(e))?new j(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=p.exec(e))?x(t[1],t[2],t[3],t[4]):(t=m.exec(e))?x(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=g.exec(e))?I(t[1],t[2]/100,t[3]/100,1):(t=b.exec(e))?I(t[1],t[2]/100,t[3]/100,t[4]):f.hasOwnProperty(e)?v(f[e]):"transparent"===e?new j(NaN,NaN,NaN,0):null}function v(e){return new j(e>>16&255,e>>8&255,255&e,1)}function x(e,t,a,n){return n<=0&&(e=t=a=NaN),new j(e,t,a,n)}function k(e){return e instanceof n||(e=E(e)),e?new j((e=e.rgb()).r,e.g,e.b,e.opacity):new j}function S(e,t,a,n){return 1===arguments.length?k(e):new j(e,t,a,null==n?1:n)}function j(e,t,a,n){this.r=+e,this.g=+t,this.b=+a,this.opacity=+n}function O(){return"#"+T(this.r)+T(this.g)+T(this.b)}function w(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}function T(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function I(e,t,a,n){return n<=0?e=t=a=NaN:a<=0||a>=1?e=t=NaN:t<=0&&(e=NaN),new F(e,t,a,n)}function C(e){if(e instanceof F)return new F(e.h,e.s,e.l,e.opacity);if(e instanceof n||(e=E(e)),!e)return new F;if(e instanceof F)return e;var t=(e=e.rgb()).r/255,a=e.g/255,i=e.b/255,r=Math.min(t,a,i),s=Math.max(t,a,i),o=NaN,l=s-r,c=(s+r)/2;return l?(o=t===s?(a-i)/l+6*(a<i):a===s?(i-t)/l+2:(t-a)/l+4,l/=c<.5?s+r:2-s-r,o*=60):l=c>0&&c<1?0:o,new F(o,l,c,e.opacity)}function M(e,t,a,n){return 1===arguments.length?C(e):new F(e,t,a,null==n?1:n)}function F(e,t,a,n){this.h=+e,this.s=+t,this.l=+a,this.opacity=+n}function D(e,t,a){return 255*(e<60?t+(a-t)*e/60:e<180?a:e<240?t+(a-t)*(240-e)/60:t)}t(n,E,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:y,formatHex:y,formatHsl:function(){return C(this).formatHsl()},formatRgb:h,toString:h}),t(j,S,a(n,{brighter:function(e){return e=null==e?r:Math.pow(r,e),new j(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?i:Math.pow(i,e),new j(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:O,formatHex:O,formatRgb:w,toString:w})),t(F,M,a(n,{brighter:function(e){return e=null==e?r:Math.pow(r,e),new F(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?i:Math.pow(i,e),new F(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,a=this.l,n=a+(a<.5?a:1-a)*t,i=2*a-n;return new j(D(e>=240?e-240:e+120,i,n),D(e,i,n),D(e<120?e+240:e-120,i,n),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}}));const A=Math.PI/180,_=180/Math.PI,N=.96422,R=.82521,P=4/29,L=6/29,B=3*L*L;function q(e){if(e instanceof $)return new $(e.l,e.a,e.b,e.opacity);if(e instanceof K)return Y(e);e instanceof j||(e=k(e));var t,a,n=G(e.r),i=G(e.g),r=G(e.b),s=V((.2225045*n+.7168786*i+.0606169*r)/1);return n===i&&i===r?t=a=s:(t=V((.4360747*n+.3850649*i+.1430804*r)/N),a=V((.0139322*n+.0971045*i+.7141733*r)/R)),new $(116*s-16,500*(t-s),200*(s-a),e.opacity)}function z(e,t,a,n){return 1===arguments.length?q(e):new $(e,t,a,null==n?1:n)}function $(e,t,a,n){this.l=+e,this.a=+t,this.b=+a,this.opacity=+n}function V(e){return e>.008856451679035631?Math.pow(e,1/3):e/B+P}function U(e){return e>L?e*e*e:B*(e-P)}function H(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function G(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Q(e){if(e instanceof K)return new K(e.h,e.c,e.l,e.opacity);if(e instanceof $||(e=q(e)),0===e.a&&0===e.b)return new K(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*_;return new K(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function W(e,t,a,n){return 1===arguments.length?Q(e):new K(e,t,a,null==n?1:n)}function K(e,t,a,n){this.h=+e,this.c=+t,this.l=+a,this.opacity=+n}function Y(e){if(isNaN(e.h))return new $(e.l,0,0,e.opacity);var t=e.h*A;return new $(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}t($,z,a(n,{brighter:function(e){return new $(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker:function(e){return new $(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,a=isNaN(this.b)?e:e-this.b/200;return new j(H(3.1338561*(t=N*U(t))-1.6168667*(e=1*U(e))-.4906146*(a=R*U(a))),H(-.9787684*t+1.9161415*e+.033454*a),H(.0719453*t-.2289914*e+1.4052427*a),this.opacity)}})),t(K,W,a(n,{brighter:function(e){return new K(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker:function(e){return new K(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb:function(){return Y(this).rgb()}}));var J=-.14861,X=1.78277,Z=-.29227,ee=-.90649,te=1.97294,ae=te*ee,ne=te*X,ie=X*Z-ee*J;function re(e){if(e instanceof oe)return new oe(e.h,e.s,e.l,e.opacity);e instanceof j||(e=k(e));var t=e.r/255,a=e.g/255,n=e.b/255,i=(ie*n+ae*t-ne*a)/(ie+ae-ne),r=n-i,s=(te*(a-i)-Z*r)/ee,o=Math.sqrt(s*s+r*r)/(te*i*(1-i)),l=o?Math.atan2(s,r)*_-120:NaN;return new oe(l<0?l+360:l,o,i,e.opacity)}function se(e,t,a,n){return 1===arguments.length?re(e):new oe(e,t,a,null==n?1:n)}function oe(e,t,a,n){this.h=+e,this.s=+t,this.l=+a,this.opacity=+n}t(oe,se,a(n,{brighter:function(e){return e=null==e?r:Math.pow(r,e),new oe(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?i:Math.pow(i,e),new oe(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*A,t=+this.l,a=isNaN(this.s)?0:this.s*t*(1-t),n=Math.cos(e),i=Math.sin(e);return new j(255*(t+a*(J*n+X*i)),255*(t+a*(Z*n+ee*i)),255*(t+a*(te*n)),this.opacity)}})),e.color=E,e.cubehelix=se,e.gray=function(e,t){return new $(e,0,0,null==t?1:t)},e.hcl=W,e.hsl=M,e.lab=z,e.lch=function(e,t,a,n){return 1===arguments.length?Q(e):new K(a,t,e,null==n?1:n)},e.rgb=S,Object.defineProperty(e,"__esModule",{value:!0})}(t)},function(e,t,a){!function(e){"use strict";function t(e,t){if((a=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var a,n=e.slice(0,a);return[n.length>1?n[0]+n.slice(2):n,+e.slice(a+1)]}function a(e){return(e=t(Math.abs(e)))?e[1]:NaN}var n,i=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function r(e){if(!(t=i.exec(e)))throw new Error("invalid format: "+e);var t;return new s({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function s(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function o(e,a){var n=t(e,a);if(!n)return e+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}r.prototype=s.prototype,s.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var l={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>o(100*e,t),r:o,s:function(e,a){var i=t(e,a);if(!i)return e+"";var r=i[0],s=i[1],o=s-(n=3*Math.max(-8,Math.min(8,Math.floor(s/3))))+1,l=r.length;return o===l?r:o>l?r+new Array(o-l+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+t(e,Math.max(0,a+o-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function c(e){return e}var u,d=Array.prototype.map,p=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function m(e){var t,i,s=void 0===e.grouping||void 0===e.thousands?c:(t=d.call(e.grouping,Number),i=e.thousands+"",function(e,a){for(var n=e.length,r=[],s=0,o=t[0],l=0;n>0&&o>0&&(l+o+1>a&&(o=Math.max(1,a-l)),r.push(e.substring(n-=o,n+o)),!((l+=o+1)>a));)o=t[s=(s+1)%t.length];return r.reverse().join(i)}),o=void 0===e.currency?"":e.currency[0]+"",u=void 0===e.currency?"":e.currency[1]+"",m=void 0===e.decimal?".":e.decimal+"",g=void 0===e.numerals?c:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(d.call(e.numerals,String)),b=void 0===e.percent?"%":e.percent+"",f=void 0===e.minus?"−":e.minus+"",y=void 0===e.nan?"NaN":e.nan+"";function h(e){var t=(e=r(e)).fill,a=e.align,i=e.sign,c=e.symbol,d=e.zero,h=e.width,E=e.comma,v=e.precision,x=e.trim,k=e.type;"n"===k?(E=!0,k="g"):l[k]||(void 0===v&&(v=12),x=!0,k="g"),(d||"0"===t&&"="===a)&&(d=!0,t="0",a="=");var S="$"===c?o:"#"===c&&/[boxX]/.test(k)?"0"+k.toLowerCase():"",j="$"===c?u:/[%p]/.test(k)?b:"",O=l[k],w=/[defgprs%]/.test(k);function T(e){var r,o,l,c=S,u=j;if("c"===k)u=O(e)+u,e="";else{var b=(e=+e)<0||1/e<0;if(e=isNaN(e)?y:O(Math.abs(e),v),x&&(e=function(e){e:for(var t,a=e.length,n=1,i=-1;n<a;++n)switch(e[n]){case".":i=t=n;break;case"0":0===i&&(i=n),t=n;break;default:if(!+e[n])break e;i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(t+1):e}(e)),b&&0==+e&&"+"!==i&&(b=!1),c=(b?"("===i?i:f:"-"===i||"("===i?"":i)+c,u=("s"===k?p[8+n/3]:"")+u+(b&&"("===i?")":""),w)for(r=-1,o=e.length;++r<o;)if(48>(l=e.charCodeAt(r))||l>57){u=(46===l?m+e.slice(r+1):e.slice(r))+u,e=e.slice(0,r);break}}E&&!d&&(e=s(e,1/0));var T=c.length+e.length+u.length,I=T<h?new Array(h-T+1).join(t):"";switch(E&&d&&(e=s(I+e,I.length?h-u.length:1/0),I=""),a){case"<":e=c+e+u+I;break;case"=":e=c+I+e+u;break;case"^":e=I.slice(0,T=I.length>>1)+c+e+u+I.slice(T);break;default:e=I+c+e+u}return g(e)}return v=void 0===v?6:/[gprs]/.test(k)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v)),T.toString=function(){return e+""},T}return{format:h,formatPrefix:function(e,t){var n=h(((e=r(e)).type="f",e)),i=3*Math.max(-8,Math.min(8,Math.floor(a(t)/3))),s=Math.pow(10,-i),o=p[8+i/3];return function(e){return n(s*e)+o}}}}function g(t){return u=m(t),e.format=u.format,e.formatPrefix=u.formatPrefix,u}g({thousands:",",grouping:[3],currency:["$",""]}),e.FormatSpecifier=s,e.formatDefaultLocale=g,e.formatLocale=m,e.formatSpecifier=r,e.precisionFixed=function(e){return Math.max(0,-a(Math.abs(e)))},e.precisionPrefix=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(a(t)/3)))-a(Math.abs(e)))},e.precisionRound=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,a(t)-a(e))+1},Object.defineProperty(e,"__esModule",{value:!0})}(t)},function(e,t,a){!function(e,t){"use strict";function a(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function n(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function i(e,t,a){return{y:e,m:t,d:a,H:0,M:0,S:0,L:0}}function r(e){var r=e.dateTime,s=e.date,l=e.time,c=e.periods,u=e.days,d=e.shortDays,p=e.months,G=e.shortMonths,pe=m(c),je=g(c),Oe=m(u),we=g(u),Te=m(d),Ie=g(d),Ce=m(p),Me=g(p),Fe=m(G),De=g(G),Ae={a:function(e){return d[e.getDay()]},A:function(e){return u[e.getDay()]},b:function(e){return G[e.getMonth()]},B:function(e){return p[e.getMonth()]},c:null,d:N,e:N,f:q,g:J,G:Z,H:R,I:P,j:L,L:B,m:z,M:$,p:function(e){return c[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:ke,s:Se,S:V,u:U,U:H,V:Q,w:W,W:K,x:null,X:null,y:Y,Y:X,Z:ee,"%":xe},_e={a:function(e){return d[e.getUTCDay()]},A:function(e){return u[e.getUTCDay()]},b:function(e){return G[e.getUTCMonth()]},B:function(e){return p[e.getUTCMonth()]},c:null,d:te,e:te,f:se,g:ye,G:Ee,H:ae,I:ne,j:ie,L:re,m:oe,M:le,p:function(e){return c[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:ke,s:Se,S:ce,u:ue,U:de,V:me,w:ge,W:be,x:null,X:null,y:fe,Y:he,Z:ve,"%":xe},Ne={a:function(e,t,a){var n=Te.exec(t.slice(a));return n?(e.w=Ie.get(n[0].toLowerCase()),a+n[0].length):-1},A:function(e,t,a){var n=Oe.exec(t.slice(a));return n?(e.w=we.get(n[0].toLowerCase()),a+n[0].length):-1},b:function(e,t,a){var n=Fe.exec(t.slice(a));return n?(e.m=De.get(n[0].toLowerCase()),a+n[0].length):-1},B:function(e,t,a){var n=Ce.exec(t.slice(a));return n?(e.m=Me.get(n[0].toLowerCase()),a+n[0].length):-1},c:function(e,t,a){return Le(e,r,t,a)},d:O,e:O,f:F,g:x,G:v,H:T,I:T,j:w,L:M,m:j,M:I,p:function(e,t,a){var n=pe.exec(t.slice(a));return n?(e.p=je.get(n[0].toLowerCase()),a+n[0].length):-1},q:S,Q:A,s:_,S:C,u:f,U:y,V:h,w:b,W:E,x:function(e,t,a){return Le(e,s,t,a)},X:function(e,t,a){return Le(e,l,t,a)},y:x,Y:v,Z:k,"%":D};function Re(e,t){return function(a){var n,i,r,s=[],l=-1,c=0,u=e.length;for(a instanceof Date||(a=new Date(+a));++l<u;)37===e.charCodeAt(l)&&(s.push(e.slice(c,l)),null!=(i=o[n=e.charAt(++l)])?n=e.charAt(++l):i="e"===n?" ":"0",(r=t[n])&&(n=r(a,i)),s.push(n),c=l+1);return s.push(e.slice(c,l)),s.join("")}}function Pe(e,r){return function(s){var o,l,c=i(1900,void 0,1);if(Le(c,e,s+="",0)!=s.length)return null;if("Q"in c)return new Date(c.Q);if("s"in c)return new Date(1e3*c.s+("L"in c?c.L:0));if(r&&!("Z"in c)&&(c.Z=0),"p"in c&&(c.H=c.H%12+12*c.p),void 0===c.m&&(c.m="q"in c?c.q:0),"V"in c){if(c.V<1||c.V>53)return null;"w"in c||(c.w=1),"Z"in c?(l=(o=n(i(c.y,0,1))).getUTCDay(),o=l>4||0===l?t.utcMonday.ceil(o):t.utcMonday(o),o=t.utcDay.offset(o,7*(c.V-1)),c.y=o.getUTCFullYear(),c.m=o.getUTCMonth(),c.d=o.getUTCDate()+(c.w+6)%7):(l=(o=a(i(c.y,0,1))).getDay(),o=l>4||0===l?t.timeMonday.ceil(o):t.timeMonday(o),o=t.timeDay.offset(o,7*(c.V-1)),c.y=o.getFullYear(),c.m=o.getMonth(),c.d=o.getDate()+(c.w+6)%7)}else("W"in c||"U"in c)&&("w"in c||(c.w="u"in c?c.u%7:"W"in c?1:0),l="Z"in c?n(i(c.y,0,1)).getUTCDay():a(i(c.y,0,1)).getDay(),c.m=0,c.d="W"in c?(c.w+6)%7+7*c.W-(l+5)%7:c.w+7*c.U-(l+6)%7);return"Z"in c?(c.H+=c.Z/100|0,c.M+=c.Z%100,n(c)):a(c)}}function Le(e,t,a,n){for(var i,r,s=0,l=t.length,c=a.length;s<l;){if(n>=c)return-1;if(37===(i=t.charCodeAt(s++))){if(i=t.charAt(s++),!(r=Ne[i in o?t.charAt(s++):i])||(n=r(e,a,n))<0)return-1}else if(i!=a.charCodeAt(n++))return-1}return n}return Ae.x=Re(s,Ae),Ae.X=Re(l,Ae),Ae.c=Re(r,Ae),_e.x=Re(s,_e),_e.X=Re(l,_e),_e.c=Re(r,_e),{format:function(e){var t=Re(e+="",Ae);return t.toString=function(){return e},t},parse:function(e){var t=Pe(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=Re(e+="",_e);return t.toString=function(){return e},t},utcParse:function(e){var t=Pe(e+="",!0);return t.toString=function(){return e},t}}}var s,o={"-":"",_:" ",0:"0"},l=/^\s*\d+/,c=/^%/,u=/[\\^$*+?|[\]().{}]/g;function d(e,t,a){var n=e<0?"-":"",i=(n?-e:e)+"",r=i.length;return n+(r<a?new Array(a-r+1).join(t)+i:i)}function p(e){return e.replace(u,"\\$&")}function m(e){return new RegExp("^(?:"+e.map(p).join("|")+")","i")}function g(e){return new Map(e.map(((e,t)=>[e.toLowerCase(),t])))}function b(e,t,a){var n=l.exec(t.slice(a,a+1));return n?(e.w=+n[0],a+n[0].length):-1}function f(e,t,a){var n=l.exec(t.slice(a,a+1));return n?(e.u=+n[0],a+n[0].length):-1}function y(e,t,a){var n=l.exec(t.slice(a,a+2));return n?(e.U=+n[0],a+n[0].length):-1}function h(e,t,a){var n=l.exec(t.slice(a,a+2));return n?(e.V=+n[0],a+n[0].length):-1}function E(e,t,a){var n=l.exec(t.slice(a,a+2));return n?(e.W=+n[0],a+n[0].length):-1}function v(e,t,a){var n=l.exec(t.slice(a,a+4));return n?(e.y=+n[0],a+n[0].length):-1}function x(e,t,a){var n=l.exec(t.slice(a,a+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),a+n[0].length):-1}function k(e,t,a){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(a,a+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),a+n[0].length):-1}function S(e,t,a){var n=l.exec(t.slice(a,a+1));return n?(e.q=3*n[0]-3,a+n[0].length):-1}function j(e,t,a){var n=l.exec(t.slice(a,a+2));return n?(e.m=n[0]-1,a+n[0].length):-1}function O(e,t,a){var n=l.exec(t.slice(a,a+2));return n?(e.d=+n[0],a+n[0].length):-1}function w(e,t,a){var n=l.exec(t.slice(a,a+3));return n?(e.m=0,e.d=+n[0],a+n[0].length):-1}function T(e,t,a){var n=l.exec(t.slice(a,a+2));return n?(e.H=+n[0],a+n[0].length):-1}function I(e,t,a){var n=l.exec(t.slice(a,a+2));return n?(e.M=+n[0],a+n[0].length):-1}function C(e,t,a){var n=l.exec(t.slice(a,a+2));return n?(e.S=+n[0],a+n[0].length):-1}function M(e,t,a){var n=l.exec(t.slice(a,a+3));return n?(e.L=+n[0],a+n[0].length):-1}function F(e,t,a){var n=l.exec(t.slice(a,a+6));return n?(e.L=Math.floor(n[0]/1e3),a+n[0].length):-1}function D(e,t,a){var n=c.exec(t.slice(a,a+1));return n?a+n[0].length:-1}function A(e,t,a){var n=l.exec(t.slice(a));return n?(e.Q=+n[0],a+n[0].length):-1}function _(e,t,a){var n=l.exec(t.slice(a));return n?(e.s=+n[0],a+n[0].length):-1}function N(e,t){return d(e.getDate(),t,2)}function R(e,t){return d(e.getHours(),t,2)}function P(e,t){return d(e.getHours()%12||12,t,2)}function L(e,a){return d(1+t.timeDay.count(t.timeYear(e),e),a,3)}function B(e,t){return d(e.getMilliseconds(),t,3)}function q(e,t){return B(e,t)+"000"}function z(e,t){return d(e.getMonth()+1,t,2)}function $(e,t){return d(e.getMinutes(),t,2)}function V(e,t){return d(e.getSeconds(),t,2)}function U(e){var t=e.getDay();return 0===t?7:t}function H(e,a){return d(t.timeSunday.count(t.timeYear(e)-1,e),a,2)}function G(e){var a=e.getDay();return a>=4||0===a?t.timeThursday(e):t.timeThursday.ceil(e)}function Q(e,a){return e=G(e),d(t.timeThursday.count(t.timeYear(e),e)+(4===t.timeYear(e).getDay()),a,2)}function W(e){return e.getDay()}function K(e,a){return d(t.timeMonday.count(t.timeYear(e)-1,e),a,2)}function Y(e,t){return d(e.getFullYear()%100,t,2)}function J(e,t){return d((e=G(e)).getFullYear()%100,t,2)}function X(e,t){return d(e.getFullYear()%1e4,t,4)}function Z(e,a){var n=e.getDay();return d((e=n>=4||0===n?t.timeThursday(e):t.timeThursday.ceil(e)).getFullYear()%1e4,a,4)}function ee(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+d(t/60|0,"0",2)+d(t%60,"0",2)}function te(e,t){return d(e.getUTCDate(),t,2)}function ae(e,t){return d(e.getUTCHours(),t,2)}function ne(e,t){return d(e.getUTCHours()%12||12,t,2)}function ie(e,a){return d(1+t.utcDay.count(t.utcYear(e),e),a,3)}function re(e,t){return d(e.getUTCMilliseconds(),t,3)}function se(e,t){return re(e,t)+"000"}function oe(e,t){return d(e.getUTCMonth()+1,t,2)}function le(e,t){return d(e.getUTCMinutes(),t,2)}function ce(e,t){return d(e.getUTCSeconds(),t,2)}function ue(e){var t=e.getUTCDay();return 0===t?7:t}function de(e,a){return d(t.utcSunday.count(t.utcYear(e)-1,e),a,2)}function pe(e){var a=e.getUTCDay();return a>=4||0===a?t.utcThursday(e):t.utcThursday.ceil(e)}function me(e,a){return e=pe(e),d(t.utcThursday.count(t.utcYear(e),e)+(4===t.utcYear(e).getUTCDay()),a,2)}function ge(e){return e.getUTCDay()}function be(e,a){return d(t.utcMonday.count(t.utcYear(e)-1,e),a,2)}function fe(e,t){return d(e.getUTCFullYear()%100,t,2)}function ye(e,t){return d((e=pe(e)).getUTCFullYear()%100,t,2)}function he(e,t){return d(e.getUTCFullYear()%1e4,t,4)}function Ee(e,a){var n=e.getUTCDay();return d((e=n>=4||0===n?t.utcThursday(e):t.utcThursday.ceil(e)).getUTCFullYear()%1e4,a,4)}function ve(){return"+0000"}function xe(){return"%"}function ke(e){return+e}function Se(e){return Math.floor(+e/1e3)}function je(t){return s=r(t),e.timeFormat=s.format,e.timeParse=s.parse,e.utcFormat=s.utcFormat,e.utcParse=s.utcParse,s}je({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var Oe="%Y-%m-%dT%H:%M:%S.%LZ";var we=Date.prototype.toISOString?function(e){return e.toISOString()}:e.utcFormat(Oe);var Te=+new Date("2000-01-01T00:00:00.000Z")?function(e){var t=new Date(e);return isNaN(t)?null:t}:e.utcParse(Oe);e.isoFormat=we,e.isoParse=Te,e.timeFormatDefaultLocale=je,e.timeFormatLocale=r,Object.defineProperty(e,"__esModule",{value:!0})}(t,a(642))},function(e,t,a){"use strict";var n=a(960),i=a(961).remove,r={},s={},o={},l={},c={};function u(e){return String("000"+(e||"")).slice(-3)}function d(e){return o[e]}function p(e){return s[e]}function m(e){var t=u(e);return p(l[t])}function g(e){var t=u(e);return l[t]}function b(e){if("string"==typeof e){if(/^[0-9]*$/.test(e))return g(e);if(2===e.length)return e.toUpperCase();if(3===e.length)return d(e.toUpperCase())}if("number"==typeof e)return g(e)}n.forEach((function(e){var t=e;s[t[0]]=t[1],o[t[1]]=t[0],l[t[2]]=t[0],c[t[0]]=t[2]})),t.registerLocale=function(e){if(!e.locale)throw new TypeError("Missing localeData.locale");if(!e.countries)throw new TypeError("Missing localeData.countries");r[e.locale]=e.countries},t.alpha3ToAlpha2=d,t.alpha2ToAlpha3=p,t.alpha3ToNumeric=function(e){return c[d(e)]},t.alpha2ToNumeric=function(e){return c[e]},t.numericToAlpha3=m,t.numericToAlpha2=g,t.toAlpha3=function(e){if("string"==typeof e){if(/^[0-9]*$/.test(e))return m(e);if(2===e.length)return p(e.toUpperCase());if(3===e.length)return e.toUpperCase()}if("number"==typeof e)return m(e)},t.toAlpha2=b,t.getName=function(e,t){try{return r[t.toLowerCase()][b(e)]}catch(e){return}},t.getNames=function(e){var t=r[e.toLowerCase()];return void 0===t?{}:t},t.getAlpha2Code=function(e,t){try{var a,n=r[t.toLowerCase()];for(a in n)if(n.hasOwnProperty(a)&&n[a].toLowerCase()===e.toLowerCase())return a;return}catch(e){return}},t.getSimpleAlpha2Code=function(e,t){try{var a,n=r[t.toLowerCase()];for(a in n)if(n.hasOwnProperty(a)&&i(n[a].toLowerCase())===i(e.toLowerCase()))return a;return}catch(e){return}},t.getAlpha2Codes=function(){return s},t.getAlpha3Code=function(e,t){var a=this.getAlpha2Code(e,t);return a?this.toAlpha3(a):void 0},t.getSimpleAlpha3Code=function(e,t){var a=this.getSimpleAlpha2Code(e,t);return a?this.toAlpha3(a):void 0},t.getAlpha3Codes=function(){return o},t.getNumericCodes=function(){return l},t.langs=function(){return Object.keys(r)},t.isValid=function(e){if(!e)return!1;var t=e.toString().toUpperCase();return o.hasOwnProperty(t)||s.hasOwnProperty(t)||l.hasOwnProperty(t)}},function(e){e.exports=JSON.parse('[["AF","AFG","004","ISO 3166-2:AF"],["AX","ALA","248","ISO 3166-2:AX"],["AL","ALB","008","ISO 3166-2:AL"],["DZ","DZA","012","ISO 3166-2:DZ"],["AS","ASM","016","ISO 3166-2:AS"],["AD","AND","020","ISO 3166-2:AD"],["AO","AGO","024","ISO 3166-2:AO"],["AI","AIA","660","ISO 3166-2:AI"],["AQ","ATA","010","ISO 3166-2:AQ"],["AG","ATG","028","ISO 3166-2:AG"],["AR","ARG","032","ISO 3166-2:AR"],["AM","ARM","051","ISO 3166-2:AM"],["AW","ABW","533","ISO 3166-2:AW"],["AU","AUS","036","ISO 3166-2:AU"],["AT","AUT","040","ISO 3166-2:AT"],["AZ","AZE","031","ISO 3166-2:AZ"],["BS","BHS","044","ISO 3166-2:BS"],["BH","BHR","048","ISO 3166-2:BH"],["BD","BGD","050","ISO 3166-2:BD"],["BB","BRB","052","ISO 3166-2:BB"],["BY","BLR","112","ISO 3166-2:BY"],["BE","BEL","056","ISO 3166-2:BE"],["BZ","BLZ","084","ISO 3166-2:BZ"],["BJ","BEN","204","ISO 3166-2:BJ"],["BM","BMU","060","ISO 3166-2:BM"],["BT","BTN","064","ISO 3166-2:BT"],["BO","BOL","068","ISO 3166-2:BO"],["BQ","BES","535","ISO 3166-2:BQ"],["BA","BIH","070","ISO 3166-2:BA"],["BW","BWA","072","ISO 3166-2:BW"],["BV","BVT","074","ISO 3166-2:BV"],["BR","BRA","076","ISO 3166-2:BR"],["IO","IOT","086","ISO 3166-2:IO"],["BN","BRN","096","ISO 3166-2:BN"],["BG","BGR","100","ISO 3166-2:BG"],["BF","BFA","854","ISO 3166-2:BF"],["BI","BDI","108","ISO 3166-2:BI"],["KH","KHM","116","ISO 3166-2:KH"],["CM","CMR","120","ISO 3166-2:CM"],["CA","CAN","124","ISO 3166-2:CA"],["CV","CPV","132","ISO 3166-2:CV"],["KY","CYM","136","ISO 3166-2:KY"],["CF","CAF","140","ISO 3166-2:CF"],["TD","TCD","148","ISO 3166-2:TD"],["CL","CHL","152","ISO 3166-2:CL"],["CN","CHN","156","ISO 3166-2:CN"],["CX","CXR","162","ISO 3166-2:CX"],["CC","CCK","166","ISO 3166-2:CC"],["CO","COL","170","ISO 3166-2:CO"],["KM","COM","174","ISO 3166-2:KM"],["CG","COG","178","ISO 3166-2:CG"],["CD","COD","180","ISO 3166-2:CD"],["CK","COK","184","ISO 3166-2:CK"],["CR","CRI","188","ISO 3166-2:CR"],["CI","CIV","384","ISO 3166-2:CI"],["HR","HRV","191","ISO 3166-2:HR"],["CU","CUB","192","ISO 3166-2:CU"],["CW","CUW","531","ISO 3166-2:CW"],["CY","CYP","196","ISO 3166-2:CY"],["CZ","CZE","203","ISO 3166-2:CZ"],["DK","DNK","208","ISO 3166-2:DK"],["DJ","DJI","262","ISO 3166-2:DJ"],["DM","DMA","212","ISO 3166-2:DM"],["DO","DOM","214","ISO 3166-2:DO"],["EC","ECU","218","ISO 3166-2:EC"],["EG","EGY","818","ISO 3166-2:EG"],["SV","SLV","222","ISO 3166-2:SV"],["GQ","GNQ","226","ISO 3166-2:GQ"],["ER","ERI","232","ISO 3166-2:ER"],["EE","EST","233","ISO 3166-2:EE"],["ET","ETH","231","ISO 3166-2:ET"],["FK","FLK","238","ISO 3166-2:FK"],["FO","FRO","234","ISO 3166-2:FO"],["FJ","FJI","242","ISO 3166-2:FJ"],["FI","FIN","246","ISO 3166-2:FI"],["FR","FRA","250","ISO 3166-2:FR"],["GF","GUF","254","ISO 3166-2:GF"],["PF","PYF","258","ISO 3166-2:PF"],["TF","ATF","260","ISO 3166-2:TF"],["GA","GAB","266","ISO 3166-2:GA"],["GM","GMB","270","ISO 3166-2:GM"],["GE","GEO","268","ISO 3166-2:GE"],["DE","DEU","276","ISO 3166-2:DE"],["GH","GHA","288","ISO 3166-2:GH"],["GI","GIB","292","ISO 3166-2:GI"],["GR","GRC","300","ISO 3166-2:GR"],["GL","GRL","304","ISO 3166-2:GL"],["GD","GRD","308","ISO 3166-2:GD"],["GP","GLP","312","ISO 3166-2:GP"],["GU","GUM","316","ISO 3166-2:GU"],["GT","GTM","320","ISO 3166-2:GT"],["GG","GGY","831","ISO 3166-2:GG"],["GN","GIN","324","ISO 3166-2:GN"],["GW","GNB","624","ISO 3166-2:GW"],["GY","GUY","328","ISO 3166-2:GY"],["HT","HTI","332","ISO 3166-2:HT"],["HM","HMD","334","ISO 3166-2:HM"],["VA","VAT","336","ISO 3166-2:VA"],["HN","HND","340","ISO 3166-2:HN"],["HK","HKG","344","ISO 3166-2:HK"],["HU","HUN","348","ISO 3166-2:HU"],["IS","ISL","352","ISO 3166-2:IS"],["IN","IND","356","ISO 3166-2:IN"],["ID","IDN","360","ISO 3166-2:ID"],["IR","IRN","364","ISO 3166-2:IR"],["IQ","IRQ","368","ISO 3166-2:IQ"],["IE","IRL","372","ISO 3166-2:IE"],["IM","IMN","833","ISO 3166-2:IM"],["IL","ISR","376","ISO 3166-2:IL"],["IT","ITA","380","ISO 3166-2:IT"],["JM","JAM","388","ISO 3166-2:JM"],["JP","JPN","392","ISO 3166-2:JP"],["JE","JEY","832","ISO 3166-2:JE"],["JO","JOR","400","ISO 3166-2:JO"],["KZ","KAZ","398","ISO 3166-2:KZ"],["KE","KEN","404","ISO 3166-2:KE"],["KI","KIR","296","ISO 3166-2:KI"],["KP","PRK","408","ISO 3166-2:KP"],["KR","KOR","410","ISO 3166-2:KR"],["KW","KWT","414","ISO 3166-2:KW"],["KG","KGZ","417","ISO 3166-2:KG"],["LA","LAO","418","ISO 3166-2:LA"],["LV","LVA","428","ISO 3166-2:LV"],["LB","LBN","422","ISO 3166-2:LB"],["LS","LSO","426","ISO 3166-2:LS"],["LR","LBR","430","ISO 3166-2:LR"],["LY","LBY","434","ISO 3166-2:LY"],["LI","LIE","438","ISO 3166-2:LI"],["LT","LTU","440","ISO 3166-2:LT"],["LU","LUX","442","ISO 3166-2:LU"],["MO","MAC","446","ISO 3166-2:MO"],["MK","MKD","807","ISO 3166-2:MK"],["MG","MDG","450","ISO 3166-2:MG"],["MW","MWI","454","ISO 3166-2:MW"],["MY","MYS","458","ISO 3166-2:MY"],["MV","MDV","462","ISO 3166-2:MV"],["ML","MLI","466","ISO 3166-2:ML"],["MT","MLT","470","ISO 3166-2:MT"],["MH","MHL","584","ISO 3166-2:MH"],["MQ","MTQ","474","ISO 3166-2:MQ"],["MR","MRT","478","ISO 3166-2:MR"],["MU","MUS","480","ISO 3166-2:MU"],["YT","MYT","175","ISO 3166-2:YT"],["MX","MEX","484","ISO 3166-2:MX"],["FM","FSM","583","ISO 3166-2:FM"],["MD","MDA","498","ISO 3166-2:MD"],["MC","MCO","492","ISO 3166-2:MC"],["MN","MNG","496","ISO 3166-2:MN"],["ME","MNE","499","ISO 3166-2:ME"],["MS","MSR","500","ISO 3166-2:MS"],["MA","MAR","504","ISO 3166-2:MA"],["MZ","MOZ","508","ISO 3166-2:MZ"],["MM","MMR","104","ISO 3166-2:MM"],["NA","NAM","516","ISO 3166-2:NA"],["NR","NRU","520","ISO 3166-2:NR"],["NP","NPL","524","ISO 3166-2:NP"],["NL","NLD","528","ISO 3166-2:NL"],["NC","NCL","540","ISO 3166-2:NC"],["NZ","NZL","554","ISO 3166-2:NZ"],["NI","NIC","558","ISO 3166-2:NI"],["NE","NER","562","ISO 3166-2:NE"],["NG","NGA","566","ISO 3166-2:NG"],["NU","NIU","570","ISO 3166-2:NU"],["NF","NFK","574","ISO 3166-2:NF"],["MP","MNP","580","ISO 3166-2:MP"],["NO","NOR","578","ISO 3166-2:NO"],["OM","OMN","512","ISO 3166-2:OM"],["PK","PAK","586","ISO 3166-2:PK"],["PW","PLW","585","ISO 3166-2:PW"],["PS","PSE","275","ISO 3166-2:PS"],["PA","PAN","591","ISO 3166-2:PA"],["PG","PNG","598","ISO 3166-2:PG"],["PY","PRY","600","ISO 3166-2:PY"],["PE","PER","604","ISO 3166-2:PE"],["PH","PHL","608","ISO 3166-2:PH"],["PN","PCN","612","ISO 3166-2:PN"],["PL","POL","616","ISO 3166-2:PL"],["PT","PRT","620","ISO 3166-2:PT"],["PR","PRI","630","ISO 3166-2:PR"],["QA","QAT","634","ISO 3166-2:QA"],["RE","REU","638","ISO 3166-2:RE"],["RO","ROU","642","ISO 3166-2:RO"],["RU","RUS","643","ISO 3166-2:RU"],["RW","RWA","646","ISO 3166-2:RW"],["BL","BLM","652","ISO 3166-2:BL"],["SH","SHN","654","ISO 3166-2:SH"],["KN","KNA","659","ISO 3166-2:KN"],["LC","LCA","662","ISO 3166-2:LC"],["MF","MAF","663","ISO 3166-2:MF"],["PM","SPM","666","ISO 3166-2:PM"],["VC","VCT","670","ISO 3166-2:VC"],["WS","WSM","882","ISO 3166-2:WS"],["SM","SMR","674","ISO 3166-2:SM"],["ST","STP","678","ISO 3166-2:ST"],["SA","SAU","682","ISO 3166-2:SA"],["SN","SEN","686","ISO 3166-2:SN"],["RS","SRB","688","ISO 3166-2:RS"],["SC","SYC","690","ISO 3166-2:SC"],["SL","SLE","694","ISO 3166-2:SL"],["SG","SGP","702","ISO 3166-2:SG"],["SX","SXM","534","ISO 3166-2:SX"],["SK","SVK","703","ISO 3166-2:SK"],["SI","SVN","705","ISO 3166-2:SI"],["SB","SLB","090","ISO 3166-2:SB"],["SO","SOM","706","ISO 3166-2:SO"],["ZA","ZAF","710","ISO 3166-2:ZA"],["GS","SGS","239","ISO 3166-2:GS"],["SS","SSD","728","ISO 3166-2:SS"],["ES","ESP","724","ISO 3166-2:ES"],["LK","LKA","144","ISO 3166-2:LK"],["SD","SDN","729","ISO 3166-2:SD"],["SR","SUR","740","ISO 3166-2:SR"],["SJ","SJM","744","ISO 3166-2:SJ"],["SZ","SWZ","748","ISO 3166-2:SZ"],["SE","SWE","752","ISO 3166-2:SE"],["CH","CHE","756","ISO 3166-2:CH"],["SY","SYR","760","ISO 3166-2:SY"],["TW","TWN","158","ISO 3166-2:TW"],["TJ","TJK","762","ISO 3166-2:TJ"],["TZ","TZA","834","ISO 3166-2:TZ"],["TH","THA","764","ISO 3166-2:TH"],["TL","TLS","626","ISO 3166-2:TL"],["TG","TGO","768","ISO 3166-2:TG"],["TK","TKL","772","ISO 3166-2:TK"],["TO","TON","776","ISO 3166-2:TO"],["TT","TTO","780","ISO 3166-2:TT"],["TN","TUN","788","ISO 3166-2:TN"],["TR","TUR","792","ISO 3166-2:TR"],["TM","TKM","795","ISO 3166-2:TM"],["TC","TCA","796","ISO 3166-2:TC"],["TV","TUV","798","ISO 3166-2:TV"],["UG","UGA","800","ISO 3166-2:UG"],["UA","UKR","804","ISO 3166-2:UA"],["AE","ARE","784","ISO 3166-2:AE"],["GB","GBR","826","ISO 3166-2:GB"],["US","USA","840","ISO 3166-2:US"],["UM","UMI","581","ISO 3166-2:UM"],["UY","URY","858","ISO 3166-2:UY"],["UZ","UZB","860","ISO 3166-2:UZ"],["VU","VUT","548","ISO 3166-2:VU"],["VE","VEN","862","ISO 3166-2:VE"],["VN","VNM","704","ISO 3166-2:VN"],["VG","VGB","092","ISO 3166-2:VG"],["VI","VIR","850","ISO 3166-2:VI"],["WF","WLF","876","ISO 3166-2:WF"],["EH","ESH","732","ISO 3166-2:EH"],["YE","YEM","887","ISO 3166-2:YE"],["ZM","ZMB","894","ISO 3166-2:ZM"],["ZW","ZWE","716","ISO 3166-2:ZW"],["XK","XKX","","ISO 3166-2:XK"]]')},function(e,t){t.remove=function(e){return e.replace(/[^\u0000-\u007e]/g,(function(e){return n[e]||e}))};for(var a=[{base:" ",chars:" "},{base:"0",chars:"߀"},{base:"A",chars:"ⒶＡÀÁÂẦẤẪẨÃĀĂẰẮẴẲȦǠÄǞẢÅǺǍȀȂẠẬẶḀĄȺⱯ"},{base:"AA",chars:"Ꜳ"},{base:"AE",chars:"ÆǼǢ"},{base:"AO",chars:"Ꜵ"},{base:"AU",chars:"Ꜷ"},{base:"AV",chars:"ꜸꜺ"},{base:"AY",chars:"Ꜽ"},{base:"B",chars:"ⒷＢḂḄḆɃƁ"},{base:"C",chars:"ⒸＣꜾḈĆCĈĊČÇƇȻ"},{base:"D",chars:"ⒹＤḊĎḌḐḒḎĐƊƉᴅꝹ"},{base:"Dh",chars:"Ð"},{base:"DZ",chars:"ǱǄ"},{base:"Dz",chars:"ǲǅ"},{base:"E",chars:"ɛⒺＥÈÉÊỀẾỄỂẼĒḔḖĔĖËẺĚȄȆẸỆȨḜĘḘḚƐƎᴇ"},{base:"F",chars:"ꝼⒻＦḞƑꝻ"},{base:"G",chars:"ⒼＧǴĜḠĞĠǦĢǤƓꞠꝽꝾɢ"},{base:"H",chars:"ⒽＨĤḢḦȞḤḨḪĦⱧⱵꞍ"},{base:"I",chars:"ⒾＩÌÍÎĨĪĬİÏḮỈǏȈȊỊĮḬƗ"},{base:"J",chars:"ⒿＪĴɈȷ"},{base:"K",chars:"ⓀＫḰǨḲĶḴƘⱩꝀꝂꝄꞢ"},{base:"L",chars:"ⓁＬĿĹĽḶḸĻḼḺŁȽⱢⱠꝈꝆꞀ"},{base:"LJ",chars:"Ǉ"},{base:"Lj",chars:"ǈ"},{base:"M",chars:"ⓂＭḾṀṂⱮƜϻ"},{base:"N",chars:"ꞤȠⓃＮǸŃÑṄŇṆŅṊṈƝꞐᴎ"},{base:"NJ",chars:"Ǌ"},{base:"Nj",chars:"ǋ"},{base:"O",chars:"ⓄＯÒÓÔỒỐỖỔÕṌȬṎŌṐṒŎȮȰÖȪỎŐǑȌȎƠỜỚỠỞỢỌỘǪǬØǾƆƟꝊꝌ"},{base:"OE",chars:"Œ"},{base:"OI",chars:"Ƣ"},{base:"OO",chars:"Ꝏ"},{base:"OU",chars:"Ȣ"},{base:"P",chars:"ⓅＰṔṖƤⱣꝐꝒꝔ"},{base:"Q",chars:"ⓆＱꝖꝘɊ"},{base:"R",chars:"ⓇＲŔṘŘȐȒṚṜŖṞɌⱤꝚꞦꞂ"},{base:"S",chars:"ⓈＳẞŚṤŜṠŠṦṢṨȘŞⱾꞨꞄ"},{base:"T",chars:"ⓉＴṪŤṬȚŢṰṮŦƬƮȾꞆ"},{base:"Th",chars:"Þ"},{base:"TZ",chars:"Ꜩ"},{base:"U",chars:"ⓊＵÙÚÛŨṸŪṺŬÜǛǗǕǙỦŮŰǓȔȖƯỪỨỮỬỰỤṲŲṶṴɄ"},{base:"V",chars:"ⓋＶṼṾƲꝞɅ"},{base:"VY",chars:"Ꝡ"},{base:"W",chars:"ⓌＷẀẂŴẆẄẈⱲ"},{base:"X",chars:"ⓍＸẊẌ"},{base:"Y",chars:"ⓎＹỲÝŶỸȲẎŸỶỴƳɎỾ"},{base:"Z",chars:"ⓏＺŹẐŻŽẒẔƵȤⱿⱫꝢ"},{base:"a",chars:"ⓐａẚàáâầấẫẩãāăằắẵẳȧǡäǟảåǻǎȁȃạậặḁąⱥɐɑ"},{base:"aa",chars:"ꜳ"},{base:"ae",chars:"æǽǣ"},{base:"ao",chars:"ꜵ"},{base:"au",chars:"ꜷ"},{base:"av",chars:"ꜹꜻ"},{base:"ay",chars:"ꜽ"},{base:"b",chars:"ⓑｂḃḅḇƀƃɓƂ"},{base:"c",chars:"ｃⓒćĉċčçḉƈȼꜿↄ"},{base:"d",chars:"ⓓｄḋďḍḑḓḏđƌɖɗƋᏧԁꞪ"},{base:"dh",chars:"ð"},{base:"dz",chars:"ǳǆ"},{base:"e",chars:"ⓔｅèéêềếễểẽēḕḗĕėëẻěȅȇẹệȩḝęḙḛɇǝ"},{base:"f",chars:"ⓕｆḟƒ"},{base:"ff",chars:"ﬀ"},{base:"fi",chars:"ﬁ"},{base:"fl",chars:"ﬂ"},{base:"ffi",chars:"ﬃ"},{base:"ffl",chars:"ﬄ"},{base:"g",chars:"ⓖｇǵĝḡğġǧģǥɠꞡꝿᵹ"},{base:"h",chars:"ⓗｈĥḣḧȟḥḩḫẖħⱨⱶɥ"},{base:"hv",chars:"ƕ"},{base:"i",chars:"ⓘｉìíîĩīĭïḯỉǐȉȋịįḭɨı"},{base:"j",chars:"ⓙｊĵǰɉ"},{base:"k",chars:"ⓚｋḱǩḳķḵƙⱪꝁꝃꝅꞣ"},{base:"l",chars:"ⓛｌŀĺľḷḹļḽḻſłƚɫⱡꝉꞁꝇɭ"},{base:"lj",chars:"ǉ"},{base:"m",chars:"ⓜｍḿṁṃɱɯ"},{base:"n",chars:"ⓝｎǹńñṅňṇņṋṉƞɲŉꞑꞥлԉ"},{base:"nj",chars:"ǌ"},{base:"o",chars:"ⓞｏòóôồốỗổõṍȭṏōṑṓŏȯȱöȫỏőǒȍȏơờớỡởợọộǫǭøǿꝋꝍɵɔᴑ"},{base:"oe",chars:"œ"},{base:"oi",chars:"ƣ"},{base:"oo",chars:"ꝏ"},{base:"ou",chars:"ȣ"},{base:"p",chars:"ⓟｐṕṗƥᵽꝑꝓꝕρ"},{base:"q",chars:"ⓠｑɋꝗꝙ"},{base:"r",chars:"ⓡｒŕṙřȑȓṛṝŗṟɍɽꝛꞧꞃ"},{base:"s",chars:"ⓢｓśṥŝṡšṧṣṩșşȿꞩꞅẛʂ"},{base:"ss",chars:"ß"},{base:"t",chars:"ⓣｔṫẗťṭțţṱṯŧƭʈⱦꞇ"},{base:"th",chars:"þ"},{base:"tz",chars:"ꜩ"},{base:"u",chars:"ⓤｕùúûũṹūṻŭüǜǘǖǚủůűǔȕȗưừứữửựụṳųṷṵʉ"},{base:"v",chars:"ⓥｖṽṿʋꝟʌ"},{base:"vy",chars:"ꝡ"},{base:"w",chars:"ⓦｗẁẃŵẇẅẘẉⱳ"},{base:"x",chars:"ⓧｘẋẍ"},{base:"y",chars:"ⓨｙỳýŷỹȳẏÿỷẙỵƴɏỿ"},{base:"z",chars:"ⓩｚźẑżžẓẕƶȥɀⱬꝣ"}],n={},i=0;i<a.length;i+=1)for(var r=a[i].chars,s=0;s<r.length;s+=1)n[r[s]]=a[i].base;t.replacementList=a,t.diacriticsMap=n},function(e){e.exports=JSON.parse('{"locale":"en","countries":{"AF":"Afghanistan","AL":"Albania","DZ":"Algeria","AS":"American Samoa","AD":"Andorra","AO":"Angola","AI":"Anguilla","AQ":"Antarctica","AG":"Antigua and Barbuda","AR":"Argentina","AM":"Armenia","AW":"Aruba","AU":"Australia","AT":"Austria","AZ":"Azerbaijan","BS":"Bahamas","BH":"Bahrain","BD":"Bangladesh","BB":"Barbados","BY":"Belarus","BE":"Belgium","BZ":"Belize","BJ":"Benin","BM":"Bermuda","BT":"Bhutan","BO":"Bolivia","BA":"Bosnia and Herzegovina","BW":"Botswana","BV":"Bouvet Island","BR":"Brazil","IO":"British Indian Ocean Territory","BN":"Brunei Darussalam","BG":"Bulgaria","BF":"Burkina Faso","BI":"Burundi","KH":"Cambodia","CM":"Cameroon","CA":"Canada","CV":"Cape Verde","KY":"Cayman Islands","CF":"Central African Republic","TD":"Chad","CL":"Chile","CN":"China","CX":"Christmas Island","CC":"Cocos (Keeling) Islands","CO":"Colombia","KM":"Comoros","CG":"Congo","CD":"Congo, the Democratic Republic of the","CK":"Cook Islands","CR":"Costa Rica","CI":"Cote D\'Ivoire","HR":"Croatia","CU":"Cuba","CY":"Cyprus","CZ":"Czech Republic","DK":"Denmark","DJ":"Djibouti","DM":"Dominica","DO":"Dominican Republic","EC":"Ecuador","EG":"Egypt","SV":"El Salvador","GQ":"Equatorial Guinea","ER":"Eritrea","EE":"Estonia","ET":"Ethiopia","FK":"Falkland Islands (Malvinas)","FO":"Faroe Islands","FJ":"Fiji","FI":"Finland","FR":"France","GF":"French Guiana","PF":"French Polynesia","TF":"French Southern Territories","GA":"Gabon","GM":"Gambia","GE":"Georgia","DE":"Germany","GH":"Ghana","GI":"Gibraltar","GR":"Greece","GL":"Greenland","GD":"Grenada","GP":"Guadeloupe","GU":"Guam","GT":"Guatemala","GN":"Guinea","GW":"Guinea-Bissau","GY":"Guyana","HT":"Haiti","HM":"Heard Island and Mcdonald Islands","VA":"Holy See (Vatican City State)","HN":"Honduras","HK":"Hong Kong","HU":"Hungary","IS":"Iceland","IN":"India","ID":"Indonesia","IR":"Iran, Islamic Republic of","IQ":"Iraq","IE":"Ireland","IL":"Israel","IT":"Italy","JM":"Jamaica","JP":"Japan","JO":"Jordan","KZ":"Kazakhstan","KE":"Kenya","KI":"Kiribati","KP":"North Korea","KR":"South Korea","KW":"Kuwait","KG":"Kyrgyzstan","LA":"Lao People\'s Democratic Republic","LV":"Latvia","LB":"Lebanon","LS":"Lesotho","LR":"Liberia","LY":"Libya","LI":"Liechtenstein","LT":"Lithuania","LU":"Luxembourg","MO":"Macao","MG":"Madagascar","MW":"Malawi","MY":"Malaysia","MV":"Maldives","ML":"Mali","MT":"Malta","MH":"Marshall Islands","MQ":"Martinique","MR":"Mauritania","MU":"Mauritius","YT":"Mayotte","MX":"Mexico","FM":"Micronesia, Federated States of","MD":"Moldova, Republic of","MC":"Monaco","MN":"Mongolia","MS":"Montserrat","MA":"Morocco","MZ":"Mozambique","MM":"Myanmar","NA":"Namibia","NR":"Nauru","NP":"Nepal","NL":"Netherlands","NC":"New Caledonia","NZ":"New Zealand","NI":"Nicaragua","NE":"Niger","NG":"Nigeria","NU":"Niue","NF":"Norfolk Island","MK":"North Macedonia, Republic of","MP":"Northern Mariana Islands","NO":"Norway","OM":"Oman","PK":"Pakistan","PW":"Palau","PS":"Palestinian Territory, Occupied","PA":"Panama","PG":"Papua New Guinea","PY":"Paraguay","PE":"Peru","PH":"Philippines","PN":"Pitcairn","PL":"Poland","PT":"Portugal","PR":"Puerto Rico","QA":"Qatar","RE":"Reunion","RO":"Romania","RU":"Russian Federation","RW":"Rwanda","SH":"Saint Helena","KN":"Saint Kitts and Nevis","LC":"Saint Lucia","PM":"Saint Pierre and Miquelon","VC":"Saint Vincent and the Grenadines","WS":"Samoa","SM":"San Marino","ST":"Sao Tome and Principe","SA":"Saudi Arabia","SN":"Senegal","SC":"Seychelles","SL":"Sierra Leone","SG":"Singapore","SK":"Slovakia","SI":"Slovenia","SB":"Solomon Islands","SO":"Somalia","ZA":"South Africa","GS":"South Georgia and the South Sandwich Islands","ES":"Spain","LK":"Sri Lanka","SD":"Sudan","SR":"Suriname","SJ":"Svalbard and Jan Mayen","SZ":"Swaziland","SE":"Sweden","CH":"Switzerland","SY":"Syrian Arab Republic","TW":"Taiwan","TJ":"Tajikistan","TZ":"Tanzania, United Republic of","TH":"Thailand","TL":"Timor-Leste","TG":"Togo","TK":"Tokelau","TO":"Tonga","TT":"Trinidad and Tobago","TN":"Tunisia","TR":"Turkey","TM":"Turkmenistan","TC":"Turks and Caicos Islands","TV":"Tuvalu","UG":"Uganda","UA":"Ukraine","AE":"United Arab Emirates","GB":"United Kingdom","US":"United States of America","UM":"United States Minor Outlying Islands","UY":"Uruguay","UZ":"Uzbekistan","VU":"Vanuatu","VE":"Venezuela","VN":"Viet Nam","VG":"Virgin Islands, British","VI":"Virgin Islands, U.S.","WF":"Wallis and Futuna","EH":"Western Sahara","YE":"Yemen","ZM":"Zambia","ZW":"Zimbabwe","AX":"Åland Islands","BQ":"Bonaire, Sint Eustatius and Saba","CW":"Curaçao","GG":"Guernsey","IM":"Isle of Man","JE":"Jersey","ME":"Montenegro","BL":"Saint Barthélemy","MF":"Saint Martin (French part)","RS":"Serbia","SX":"Sint Maarten (Dutch part)","SS":"South Sudan","XK":"Kosovo"}}')},function(e,t,a){"use strict";var n=a(964),i={"text/plain":"Text","text/html":"Url",default:"Text"};e.exports=function(e,t){var a,r,s,o,l,c,u=!1;t||(t={}),a=t.debug||!1;try{if(s=n(),o=document.createRange(),l=document.getSelection(),(c=document.createElement("span")).textContent=e,c.style.all="unset",c.style.position="fixed",c.style.top=0,c.style.clip="rect(0, 0, 0, 0)",c.style.whiteSpace="pre",c.style.webkitUserSelect="text",c.style.MozUserSelect="text",c.style.msUserSelect="text",c.style.userSelect="text",c.addEventListener("copy",(function(n){if(n.stopPropagation(),t.format)if(n.preventDefault(),void 0===n.clipboardData){a&&console.warn("unable to use e.clipboardData"),a&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var r=i[t.format]||i.default;window.clipboardData.setData(r,e)}else n.clipboardData.clearData(),n.clipboardData.setData(t.format,e);t.onCopy&&(n.preventDefault(),t.onCopy(n.clipboardData))})),document.body.appendChild(c),o.selectNodeContents(c),l.addRange(o),!document.execCommand("copy"))throw new Error("copy command was unsuccessful");u=!0}catch(n){a&&console.error("unable to copy using execCommand: ",n),a&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(t.format||"text",e),t.onCopy&&t.onCopy(window.clipboardData),u=!0}catch(n){a&&console.error("unable to copy using clipboardData: ",n),a&&console.error("falling back to prompt"),r=function(e){var t=(/mac os x/i.test(navigator.userAgent)?"⌘":"Ctrl")+"+C";return e.replace(/#{\s*key\s*}/g,t)}("message"in t?t.message:"Copy to clipboard: #{key}, Enter"),window.prompt(r,e)}}finally{l&&("function"==typeof l.removeRange?l.removeRange(o):l.removeAllRanges()),c&&document.body.removeChild(c),s()}return u}},function(e,t){e.exports=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var t=document.activeElement,a=[],n=0;n<e.rangeCount;n++)a.push(e.getRangeAt(n));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||a.forEach((function(t){e.addRange(t)})),t&&t.focus()}}},function(e){e.exports=JSON.parse('["file.path","file.target_path","Target.process.command_line","Target.process.executable","Target.process.name","Target.process.parent.command_line","Target.process.parent.executable","Target.process.parent.name","Target.process.parent.working_directory","Target.process.working_directory","host.os.full","host.os.name","process.command_line","process.executable","process.name","process.parent.command_line","process.parent.executable","process.parent.name","process.parent.working_directory","process.working_directory"]')},function(e){e.exports=JSON.parse('["file.path.caseless","file.target_path.caseless","Target.process.command_line.caseless","Target.process.executable.caseless","Target.process.name.caseless","Target.process.parent.command_line.caseless","Target.process.parent.executable.caseless","Target.process.parent.name.caseless","Target.process.parent.working_directory.caseless","Target.process.working_directory.caseless","host.os.full.caseless","host.os.name.caseless","process.command_line.caseless","process.executable.caseless","process.name.caseless","process.parent.command_line.caseless","process.parent.executable.caseless","process.parent.name.caseless","process.parent.working_directory.caseless","process.working_directory.caseless","Target.process.Ext.code_signature.status","Target.process.Ext.code_signature.subject_name","Target.process.Ext.code_signature.trusted","Target.process.Ext.code_signature.valid","Target.process.parent.Ext.code_signature.status","Target.process.parent.Ext.code_signature.subject_name","Target.process.parent.Ext.code_signature.trusted","Target.process.parent.Ext.code_signature.valid","file.Ext.code_signature.status","file.Ext.code_signature.subject_name","file.Ext.code_signature.trusted","file.Ext.code_signature.valid","process.parent.Ext.code_signature.status","process.parent.Ext.code_signature.subject_name","process.parent.Ext.code_signature.trusted","process.parent.Ext.code_signature.valid"]')},function(e){e.exports=JSON.parse('["Endpoint.policy.applied.id","Target.process.Ext.services","Target.process.Ext.user","Target.process.executable","Target.process.hash.md5","Target.process.hash.sha1","Target.process.hash.sha256","Target.process.hash.sha512","Target.process.name","Target.process.parent.hash.md5","Target.process.parent.hash.sha1","Target.process.parent.hash.sha256","Target.process.parent.hash.sha512","Target.process.parent.pgid","Target.process.pe.company","Target.process.pe.description","Target.process.pe.file_version","Target.process.pe.original_file_name","Target.process.pe.product","Target.process.pgid","Target.process.Ext.memory_region.allocation_type","Target.process.thread.Ext.start_address_bytes_disasm_hash","Target.process.thread.Ext.start_address_allocation_offset","Target.process.Ext.memory_region.allocation_size","Target.process.Ext.memory_region.region_size","Target.process.Ext.memory_region.region_protection","Target.process.Ext.memory_region.memory_pe.imphash","Target.process.thread.Ext.start_address_bytes","agent.id","agent.type","agent.version","elastic.agent.id","event.action","event.category","event.code","event.hash","event.kind","event.module","event.outcome","event.provider","event.type","file.attributes","file.device","file.directory","file.drive_letter","file.extension","file.gid","file.group","file.hash.md5","file.hash.sha1","file.hash.sha256","file.hash.sha512","file.inode","file.mime_type","file.mode","file.name","file.owner","file.path","file.pe.company","file.pe.description","file.pe.file_version","file.pe.original_file_name","file.pe.product","file.size","file.type","file.uid","group.Ext.real.id","group.domain","group.id","host.architecture","host.domain","host.id","host.os.Ext.variant","host.os.family","host.os.kernel","host.os.platform","host.os.version","host.type","process.command_line","process.code_signature.subject_name","process.Ext.services","process.Ext.user","process.Ext.code_signature","process.Ext.token.integrity_level_name","process.Ext.memory_region.malware_signature.all_names","process.executable","process.hash.md5","process.hash.sha1","process.hash.sha256","process.hash.sha512","process.name","process.parent.executable","process.parent.hash.md5","process.parent.hash.sha1","process.parent.hash.sha256","process.parent.hash.sha512","process.parent.pgid","process.pe.company","process.pe.description","process.pe.file_version","process.pe.original_file_name","process.pe.product","process.pgid","rule.uuid","rule.id","source.ip","source.port","destination.ip","destination.port","registry.path","registry.value","registry.data.strings","user.domain","user.email","user.hash","user.id","Ransomware.feature","Ransomware.files.data","Ransomware.files.entropy","Ransomware.files.extension","Ransomware.files.operation","Ransomware.files.path","Ransomware.child_processes.files.data","Ransomware.child_processes.files.entropy","Ransomware.child_processes.files.extension","Ransomware.child_processes.files.operation","Ransomware.child_processes.files.path","Memory_protection.feature","Memory_protection.self_injection","dll.path","dll.code_signature.subject_name","dll.pe.original_file_name","dns.question.name","dns.question.type"]')},function(e,t,a){e.exports=a.p+"94cccf20036d014924e63d4d595e88e1.svg"},function(e,t,a){const n=a(235);e.exports={re:n.re,src:n.src,tokens:n.t,SEMVER_SPEC_VERSION:a(308).SEMVER_SPEC_VERSION,SemVer:a(125),compareIdentifiers:a(391).compareIdentifiers,rcompareIdentifiers:a(391).rcompareIdentifiers,parse:a(262),valid:a(970),clean:a(971),inc:a(972),diff:a(973),major:a(974),minor:a(975),patch:a(976),prerelease:a(977),compare:a(152),rcompare:a(978),compareLoose:a(979),compareBuild:a(483),sort:a(980),rsort:a(981),gt:a(362),lt:a(484),eq:a(482),neq:a(659),gte:a(363),lte:a(321),cmp:a(660),coerce:a(877),Comparator:a(364),Range:a(163),satisfies:a(365),toComparators:a(985),maxSatisfying:a(986),minSatisfying:a(987),minVersion:a(988),validRange:a(989),outside:a(485),gtr:a(990),ltr:a(991),intersects:a(992),simplifyRange:a(993),subset:a(994)}},function(e,t,a){const n=a(262);e.exports=(e,t)=>{const a=n(e,t);return a?a.version:null}},function(e,t,a){const n=a(262);e.exports=(e,t)=>{const a=n(e.trim().replace(/^[=v]+/,""),t);return a?a.version:null}},function(e,t,a){const n=a(125);e.exports=(e,t,a,i)=>{"string"==typeof a&&(i=a,a=void 0);try{return new n(e instanceof n?e.version:e,a).inc(t,i).version}catch(e){return null}}},function(e,t,a){const n=a(262),i=a(482);e.exports=(e,t)=>{if(i(e,t))return null;{const a=n(e),i=n(t),r=a.prerelease.length||i.prerelease.length,s=r?"pre":"",o=r?"prerelease":"";for(const e in a)if(("major"===e||"minor"===e||"patch"===e)&&a[e]!==i[e])return s+e;return o}}},function(e,t,a){const n=a(125);e.exports=(e,t)=>new n(e,t).major},function(e,t,a){const n=a(125);e.exports=(e,t)=>new n(e,t).minor},function(e,t,a){const n=a(125);e.exports=(e,t)=>new n(e,t).patch},function(e,t,a){const n=a(262);e.exports=(e,t)=>{const a=n(e,t);return a&&a.prerelease.length?a.prerelease:null}},function(e,t,a){const n=a(152);e.exports=(e,t,a)=>n(t,e,a)},function(e,t,a){const n=a(152);e.exports=(e,t)=>n(e,t,!0)},function(e,t,a){const n=a(483);e.exports=(e,t)=>e.sort(((e,a)=>n(e,a,t)))},function(e,t,a){const n=a(483);e.exports=(e,t)=>e.sort(((e,a)=>n(a,e,t)))},function(e,t,a){"use strict";const n=a(983),i=Symbol("max"),r=Symbol("length"),s=Symbol("lengthCalculator"),o=Symbol("allowStale"),l=Symbol("maxAge"),c=Symbol("dispose"),u=Symbol("noDisposeOnSet"),d=Symbol("lruList"),p=Symbol("cache"),m=Symbol("updateAgeOnGet"),g=()=>1,b=(e,t,a)=>{const n=e[p].get(t);if(n){const t=n.value;if(f(e,t)){if(h(e,n),!e[o])return}else a&&(e[m]&&(n.value.now=Date.now()),e[d].unshiftNode(n));return t.value}},f=(e,t)=>{if(!t||!t.maxAge&&!e[l])return!1;const a=Date.now()-t.now;return t.maxAge?a>t.maxAge:e[l]&&a>e[l]},y=e=>{if(e[r]>e[i])for(let t=e[d].tail;e[r]>e[i]&&null!==t;){const a=t.prev;h(e,t),t=a}},h=(e,t)=>{if(t){const a=t.value;e[c]&&e[c](a.key,a.value),e[r]-=a.length,e[p].delete(a.key),e[d].removeNode(t)}};class Entry{constructor(e,t,a,n,i){this.key=e,this.value=t,this.length=a,this.now=n,this.maxAge=i||0}}const E=(e,t,a,n)=>{let i=a.value;f(e,i)&&(h(e,a),e[o]||(i=void 0)),i&&t.call(n,i.value,i.key,e)};e.exports=class LRUCache{constructor(e){if("number"==typeof e&&(e={max:e}),e||(e={}),e.max&&("number"!=typeof e.max||e.max<0))throw new TypeError("max must be a non-negative number");this[i]=e.max||1/0;const t=e.length||g;if(this[s]="function"!=typeof t?g:t,this[o]=e.stale||!1,e.maxAge&&"number"!=typeof e.maxAge)throw new TypeError("maxAge must be a number");this[l]=e.maxAge||0,this[c]=e.dispose,this[u]=e.noDisposeOnSet||!1,this[m]=e.updateAgeOnGet||!1,this.reset()}set max(e){if("number"!=typeof e||e<0)throw new TypeError("max must be a non-negative number");this[i]=e||1/0,y(this)}get max(){return this[i]}set allowStale(e){this[o]=!!e}get allowStale(){return this[o]}set maxAge(e){if("number"!=typeof e)throw new TypeError("maxAge must be a non-negative number");this[l]=e,y(this)}get maxAge(){return this[l]}set lengthCalculator(e){"function"!=typeof e&&(e=g),e!==this[s]&&(this[s]=e,this[r]=0,this[d].forEach((e=>{e.length=this[s](e.value,e.key),this[r]+=e.length}))),y(this)}get lengthCalculator(){return this[s]}get length(){return this[r]}get itemCount(){return this[d].length}rforEach(e,t){t=t||this;for(let a=this[d].tail;null!==a;){const n=a.prev;E(this,e,a,t),a=n}}forEach(e,t){t=t||this;for(let a=this[d].head;null!==a;){const n=a.next;E(this,e,a,t),a=n}}keys(){return this[d].toArray().map((e=>e.key))}values(){return this[d].toArray().map((e=>e.value))}reset(){this[c]&&this[d]&&this[d].length&&this[d].forEach((e=>this[c](e.key,e.value))),this[p]=new Map,this[d]=new n,this[r]=0}dump(){return this[d].map((e=>!f(this,e)&&{k:e.key,v:e.value,e:e.now+(e.maxAge||0)})).toArray().filter((e=>e))}dumpLru(){return this[d]}set(e,t,a){if((a=a||this[l])&&"number"!=typeof a)throw new TypeError("maxAge must be a number");const n=a?Date.now():0,o=this[s](t,e);if(this[p].has(e)){if(o>this[i])return h(this,this[p].get(e)),!1;const s=this[p].get(e).value;return this[c]&&(this[u]||this[c](e,s.value)),s.now=n,s.maxAge=a,s.value=t,this[r]+=o-s.length,s.length=o,this.get(e),y(this),!0}const m=new Entry(e,t,o,n,a);return m.length>this[i]?(this[c]&&this[c](e,t),!1):(this[r]+=m.length,this[d].unshift(m),this[p].set(e,this[d].head),y(this),!0)}has(e){if(!this[p].has(e))return!1;const t=this[p].get(e).value;return!f(this,t)}get(e){return b(this,e,!0)}peek(e){return b(this,e,!1)}pop(){const e=this[d].tail;return e?(h(this,e),e.value):null}del(e){h(this,this[p].get(e))}load(e){this.reset();const t=Date.now();for(let a=e.length-1;a>=0;a--){const n=e[a],i=n.e||0;if(0===i)this.set(n.k,n.v);else{const e=i-t;e>0&&this.set(n.k,n.v,e)}}}prune(){this[p].forEach(((e,t)=>b(this,t,!1)))}}},function(e,t,a){"use strict";function n(e){var t=this;if(t instanceof n||(t=new n),t.tail=null,t.head=null,t.length=0,e&&"function"==typeof e.forEach)e.forEach((function(e){t.push(e)}));else if(arguments.length>0)for(var a=0,i=arguments.length;a<i;a++)t.push(arguments[a]);return t}function i(e,t,a){var n=t===e.head?new o(a,null,t,e):new o(a,t,t.next,e);return null===n.next&&(e.tail=n),null===n.prev&&(e.head=n),e.length++,n}function r(e,t){e.tail=new o(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function s(e,t){e.head=new o(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function o(e,t,a,n){if(!(this instanceof o))return new o(e,t,a,n);this.list=n,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,a?(a.prev=this,this.next=a):this.next=null}e.exports=n,n.Node=o,n.create=n,n.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,a=e.prev;return t&&(t.prev=a),a&&(a.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=a),e.list.length--,e.next=null,e.prev=null,e.list=null,t},n.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},n.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},n.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)r(this,arguments[e]);return this.length},n.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)s(this,arguments[e]);return this.length},n.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},n.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},n.prototype.forEach=function(e,t){t=t||this;for(var a=this.head,n=0;null!==a;n++)e.call(t,a.value,n,this),a=a.next},n.prototype.forEachReverse=function(e,t){t=t||this;for(var a=this.tail,n=this.length-1;null!==a;n--)e.call(t,a.value,n,this),a=a.prev},n.prototype.get=function(e){for(var t=0,a=this.head;null!==a&&t<e;t++)a=a.next;if(t===e&&null!==a)return a.value},n.prototype.getReverse=function(e){for(var t=0,a=this.tail;null!==a&&t<e;t++)a=a.prev;if(t===e&&null!==a)return a.value},n.prototype.map=function(e,t){t=t||this;for(var a=new n,i=this.head;null!==i;)a.push(e.call(t,i.value,this)),i=i.next;return a},n.prototype.mapReverse=function(e,t){t=t||this;for(var a=new n,i=this.tail;null!==i;)a.push(e.call(t,i.value,this)),i=i.prev;return a},n.prototype.reduce=function(e,t){var a,n=this.head;if(arguments.length>1)a=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");n=this.head.next,a=this.head.value}for(var i=0;null!==n;i++)a=e(a,n.value,i),n=n.next;return a},n.prototype.reduceReverse=function(e,t){var a,n=this.tail;if(arguments.length>1)a=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");n=this.tail.prev,a=this.tail.value}for(var i=this.length-1;null!==n;i--)a=e(a,n.value,i),n=n.prev;return a},n.prototype.toArray=function(){for(var e=new Array(this.length),t=0,a=this.head;null!==a;t++)e[t]=a.value,a=a.next;return e},n.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,a=this.tail;null!==a;t++)e[t]=a.value,a=a.prev;return e},n.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var a=new n;if(t<e||t<0)return a;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=0,r=this.head;null!==r&&i<e;i++)r=r.next;for(;null!==r&&i<t;i++,r=r.next)a.push(r.value);return a},n.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var a=new n;if(t<e||t<0)return a;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=this.length,r=this.tail;null!==r&&i>t;i--)r=r.prev;for(;null!==r&&i>e;i--,r=r.prev)a.push(r.value);return a},n.prototype.splice=function(e,t,...a){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var n=0,r=this.head;null!==r&&n<e;n++)r=r.next;var s=[];for(n=0;r&&n<t;n++)s.push(r.value),r=this.removeNode(r);for(null===r&&(r=this.tail),r!==this.head&&r!==this.tail&&(r=r.prev),n=0;n<a.length;n++)r=i(this,r,a[n]);return s},n.prototype.reverse=function(){for(var e=this.head,t=this.tail,a=e;null!==a;a=a.prev){var n=a.prev;a.prev=a.next,a.next=n}return this.head=t,this.tail=e,this};try{a(984)(n)}catch(e){}},function(e,t,a){"use strict";e.exports=function(e){e.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}},function(e,t,a){const n=a(163);e.exports=(e,t)=>new n(e,t).set.map((e=>e.map((e=>e.value)).join(" ").trim().split(" ")))},function(e,t,a){const n=a(125),i=a(163);e.exports=(e,t,a)=>{let r=null,s=null,o=null;try{o=new i(t,a)}catch(e){return null}return e.forEach((e=>{o.test(e)&&(r&&-1!==s.compare(e)||(r=e,s=new n(r,a)))})),r}},function(e,t,a){const n=a(125),i=a(163);e.exports=(e,t,a)=>{let r=null,s=null,o=null;try{o=new i(t,a)}catch(e){return null}return e.forEach((e=>{o.test(e)&&(r&&1!==s.compare(e)||(r=e,s=new n(r,a)))})),r}},function(e,t,a){const n=a(125),i=a(163),r=a(362);e.exports=(e,t)=>{e=new i(e,t);let a=new n("0.0.0");if(e.test(a))return a;if(a=new n("0.0.0-0"),e.test(a))return a;a=null;for(let t=0;t<e.set.length;++t){const i=e.set[t];let s=null;i.forEach((e=>{const t=new n(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":s&&!r(t,s)||(s=t);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${e.operator}`)}})),!s||a&&!r(a,s)||(a=s)}return a&&e.test(a)?a:null}},function(e,t,a){const n=a(163);e.exports=(e,t)=>{try{return new n(e,t).range||"*"}catch(e){return null}}},function(e,t,a){const n=a(485);e.exports=(e,t,a)=>n(e,t,">",a)},function(e,t,a){const n=a(485);e.exports=(e,t,a)=>n(e,t,"<",a)},function(e,t,a){const n=a(163);e.exports=(e,t,a)=>(e=new n(e,a),t=new n(t,a),e.intersects(t))},function(e,t,a){const n=a(365),i=a(152);e.exports=(e,t,a)=>{const r=[];let s=null,o=null;const l=e.sort(((e,t)=>i(e,t,a)));for(const e of l)n(e,t,a)?(o=e,s||(s=e)):(o&&r.push([s,o]),o=null,s=null);s&&r.push([s,null]);const c=[];for(const[e,t]of r)e===t?c.push(e):t||e!==l[0]?t?e===l[0]?c.push(`<=${t}`):c.push(`${e} - ${t}`):c.push(`>=${e}`):c.push("*");const u=c.join(" || "),d="string"==typeof t.raw?t.raw:String(t);return u.length<d.length?u:t}},function(e,t,a){const n=a(163),i=a(364),{ANY:r}=i,s=a(365),o=a(152),l=(e,t,a)=>{if(e===t)return!0;if(1===e.length&&e[0].semver===r){if(1===t.length&&t[0].semver===r)return!0;e=a.includePrerelease?[new i(">=0.0.0-0")]:[new i(">=0.0.0")]}if(1===t.length&&t[0].semver===r){if(a.includePrerelease)return!0;t=[new i(">=0.0.0")]}const n=new Set;let l,d,p,m,g,b,f;for(const t of e)">"===t.operator||">="===t.operator?l=c(l,t,a):"<"===t.operator||"<="===t.operator?d=u(d,t,a):n.add(t.semver);if(n.size>1)return null;if(l&&d){if(p=o(l.semver,d.semver,a),p>0)return null;if(0===p&&(">="!==l.operator||"<="!==d.operator))return null}for(const e of n){if(l&&!s(e,String(l),a))return null;if(d&&!s(e,String(d),a))return null;for(const n of t)if(!s(e,String(n),a))return!1;return!0}let y=!(!d||a.includePrerelease||!d.semver.prerelease.length)&&d.semver,h=!(!l||a.includePrerelease||!l.semver.prerelease.length)&&l.semver;y&&1===y.prerelease.length&&"<"===d.operator&&0===y.prerelease[0]&&(y=!1);for(const e of t){if(f=f||">"===e.operator||">="===e.operator,b=b||"<"===e.operator||"<="===e.operator,l)if(h&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===h.major&&e.semver.minor===h.minor&&e.semver.patch===h.patch&&(h=!1),">"===e.operator||">="===e.operator){if(m=c(l,e,a),m===e&&m!==l)return!1}else if(">="===l.operator&&!s(l.semver,String(e),a))return!1;if(d)if(y&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===y.major&&e.semver.minor===y.minor&&e.semver.patch===y.patch&&(y=!1),"<"===e.operator||"<="===e.operator){if(g=u(d,e,a),g===e&&g!==d)return!1}else if("<="===d.operator&&!s(d.semver,String(e),a))return!1;if(!e.operator&&(d||l)&&0!==p)return!1}return!(l&&b&&!d&&0!==p||d&&f&&!l&&0!==p||h||y)},c=(e,t,a)=>{if(!e)return t;const n=o(e.semver,t.semver,a);return n>0?e:n<0||">"===t.operator&&">="===e.operator?t:e},u=(e,t,a)=>{if(!e)return t;const n=o(e.semver,t.semver,a);return n<0?e:n>0||"<"===t.operator&&"<="===e.operator?t:e};e.exports=(e,t,a={})=>{if(e===t)return!0;e=new n(e,a),t=new n(t,a);let i=!1;e:for(const n of e.set){for(const e of t.set){const t=l(n,e,a);if(i=i||null!==t,t)continue e}if(i)return!1}return!0}},function(e,t,a){e.exports=a(27)(1813)},function(e,t,a){e.exports=a(27)(3453)},function(e,t,a){e.exports=a(27)(997)},function(e,t,a){"use strict";e.exports=function(e){var t=this;this.Parser=function(a){return n(a,Object.assign({},t.data("settings"),e,{extensions:t.data("micromarkExtensions")||[],mdastExtensions:t.data("fromMarkdownExtensions")||[]}))}};var n=a(999)},function(e,t,a){"use strict";e.exports=a(1e3)},function(e,t,a){"use strict";e.exports=function(e,t,a){return"string"!=typeof t&&(a=t,t=void 0),function(e){var t=e||{},a=function(e,t){for(var a=-1;++a<t.length;)m(e,t[a]);return e}({canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:f(M),autolinkProtocol:k,autolinkEmail:k,atxHeading:f(T),blockQuote:f((function(){return{type:"blockquote",children:[]}})),characterEscape:k,characterReference:k,codeFenced:f(w),codeFencedFenceInfo:y,codeFencedFenceMeta:y,codeIndented:f(w,y),codeText:f((function(){return{type:"inlineCode",value:""}}),y),codeTextData:k,data:k,codeFlowValue:k,definition:f((function(){return{type:"definition",identifier:"",label:null,title:null,url:""}})),definitionDestinationString:y,definitionLabelString:y,definitionTitleString:y,emphasis:f((function(){return{type:"emphasis",children:[]}})),hardBreakEscape:f(I),hardBreakTrailing:f(I),htmlFlow:f(C,y),htmlFlowData:k,htmlText:f(C,y),htmlTextData:k,image:f((function(){return{type:"image",title:null,url:"",alt:null}})),label:y,link:f(M),listItem:f((function(e){return{type:"listItem",spread:e._spread,checked:null,children:[]}})),listItemValue:function(e){g("expectingFirstListItemValue")&&(this.stack[this.stack.length-2].start=parseInt(this.sliceSerialize(e),10),u("expectingFirstListItemValue"))},listOrdered:f(F,(function(){u("expectingFirstListItemValue",!0)})),listUnordered:f(F),paragraph:f((function(){return{type:"paragraph",children:[]}})),reference:function(){u("referenceType","collapsed")},referenceString:y,resourceDestinationString:y,resourceTitleString:y,setextHeading:f(T),strong:f((function(){return{type:"strong",children:[]}})),thematicBreak:f((function(){return{type:"thematicBreak"}}))},exit:{atxHeading:E(),atxHeadingSequence:function(e){this.stack[this.stack.length-1].depth||(this.stack[this.stack.length-1].depth=this.sliceSerialize(e).length)},autolink:E(),autolinkEmail:function(e){S.call(this,e),this.stack[this.stack.length-1].url="mailto:"+this.sliceSerialize(e)},autolinkProtocol:function(e){S.call(this,e),this.stack[this.stack.length-1].url=this.sliceSerialize(e)},blockQuote:E(),characterEscapeValue:S,characterReferenceMarkerHexadecimal:O,characterReferenceMarkerNumeric:O,characterReferenceValue:function(e){var t,a,n=this.sliceSerialize(e),i=g("characterReferenceType");i?(t=o(n,"characterReferenceMarkerNumeric"===i?10:16),u("characterReferenceType")):t=d(n),(a=this.stack.pop()).value+=t,a.position.end=b(e.end)},codeFenced:E((function(){var e=this.resume();this.stack[this.stack.length-1].value=e.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),u("flowCodeInside")})),codeFencedFence:function(){g("flowCodeInside")||(this.buffer(),u("flowCodeInside",!0))},codeFencedFenceInfo:function(){var e=this.resume();this.stack[this.stack.length-1].lang=e},codeFencedFenceMeta:function(){var e=this.resume();this.stack[this.stack.length-1].meta=e},codeFlowValue:S,codeIndented:E((function(){var e=this.resume();this.stack[this.stack.length-1].value=e})),codeText:E((function(){var e=this.resume();this.stack[this.stack.length-1].value=e})),codeTextData:S,data:S,definition:E(),definitionDestinationString:function(){var e=this.resume();this.stack[this.stack.length-1].url=e},definitionLabelString:function(e){var t=this.resume();this.stack[this.stack.length-1].label=t,this.stack[this.stack.length-1].identifier=s(this.sliceSerialize(e)).toLowerCase()},definitionTitleString:function(){var e=this.resume();this.stack[this.stack.length-1].title=e},emphasis:E(),hardBreakEscape:E(j),hardBreakTrailing:E(j),htmlFlow:E((function(){var e=this.resume();this.stack[this.stack.length-1].value=e})),htmlFlowData:S,htmlText:E((function(){var e=this.resume();this.stack[this.stack.length-1].value=e})),htmlTextData:S,image:E((function(){var e=this.stack[this.stack.length-1];g("inReference")?(e.type+="Reference",e.referenceType=g("referenceType")||"shortcut",delete e.url,delete e.title):(delete e.identifier,delete e.label,delete e.referenceType),u("referenceType")})),label:function(){var e=this.stack[this.stack.length-1],t=this.resume();this.stack[this.stack.length-1].label=t,u("inReference",!0),"link"===this.stack[this.stack.length-1].type?this.stack[this.stack.length-1].children=e.children:this.stack[this.stack.length-1].alt=t},labelText:function(e){this.stack[this.stack.length-2].identifier=s(this.sliceSerialize(e)).toLowerCase()},lineEnding:function(e){var t=this.stack[this.stack.length-1];if(g("atHardBreak"))return t.children[t.children.length-1].position.end=b(e.end),void u("atHardBreak");!g("setextHeadingSlurpLineEnding")&&a.canContainEols.indexOf(t.type)>-1&&(k.call(this,e),S.call(this,e))},link:E((function(){var e=this.stack[this.stack.length-1];g("inReference")?(e.type+="Reference",e.referenceType=g("referenceType")||"shortcut",delete e.url,delete e.title):(delete e.identifier,delete e.label,delete e.referenceType),u("referenceType")})),listItem:E(),listOrdered:E(),listUnordered:E(),paragraph:E(),referenceString:function(e){var t=this.resume();this.stack[this.stack.length-1].label=t,this.stack[this.stack.length-1].identifier=s(this.sliceSerialize(e)).toLowerCase(),u("referenceType","full")},resourceDestinationString:function(){var e=this.resume();this.stack[this.stack.length-1].url=e},resourceTitleString:function(){var e=this.resume();this.stack[this.stack.length-1].title=e},resource:function(){u("inReference")},setextHeading:E((function(){u("setextHeadingSlurpLineEnding")})),setextHeadingLineSequence:function(e){this.stack[this.stack.length-1].depth=61===this.sliceSerialize(e).charCodeAt(0)?1:2},setextHeadingText:function(){u("setextHeadingSlurpLineEnding",!0)},strong:E(),thematicBreak:E()}},t.mdastExtensions||[]),l={};return function(e){for(var t,n=[{type:"root",children:[]}],s=[],o=[],l=-1,d={stack:n,tokenStack:s,config:a,enter:h,exit:v,buffer:y,resume:x,setData:u,getData:g};++l<e.length;)"listOrdered"!==e[l][1].type&&"listUnordered"!==e[l][1].type||("enter"===e[l][0]?o.push(l):l=c(e,o.pop(l),l));for(l=-1;++l<e.length;)t=a[e[l][0]],r.call(t,e[l][1].type)&&t[e[l][1].type].call(i({sliceSerialize:e[l][2].sliceSerialize},d),e[l][1]);if(s.length)throw new Error("Cannot close document, a token (`"+s[s.length-1].type+"`, "+p({start:s[s.length-1].start,end:s[s.length-1].end})+") is still open");return n[0].position={start:b(e.length?e[0][1].start:{line:1,column:1,offset:0}),end:b(e.length?e[e.length-2][1].end:{line:1,column:1,offset:0})},n[0]};function c(e,t,a){for(var n,i,r,s,o,l,c,u=t-1,d=-1,p=!1;++u<=a;)if("listUnordered"===(o=e[u])[1].type||"listOrdered"===o[1].type||"blockQuote"===o[1].type?("enter"===o[0]?d++:d--,c=void 0):"lineEndingBlank"===o[1].type?"enter"===o[0]&&(!n||c||d||l||(l=u),c=void 0):"linePrefix"===o[1].type||"listItemValue"===o[1].type||"listItemMarker"===o[1].type||"listItemPrefix"===o[1].type||"listItemPrefixWhitespace"===o[1].type||(c=void 0),!d&&"enter"===o[0]&&"listItemPrefix"===o[1].type||-1===d&&"exit"===o[0]&&("listUnordered"===o[1].type||"listOrdered"===o[1].type)){if(n){for(i=u,r=void 0;i--;)if("lineEnding"===(s=e[i])[1].type||"lineEndingBlank"===s[1].type){if("exit"===s[0])continue;r&&(e[r][1].type="lineEndingBlank",p=!0),s[1].type="lineEnding",r=i}else if("linePrefix"!==s[1].type&&"blockQuotePrefix"!==s[1].type&&"blockQuotePrefixWhitespace"!==s[1].type&&"blockQuoteMarker"!==s[1].type&&"listItemIndent"!==s[1].type)break;l&&(!r||l<r)&&(n._spread=!0),n.end=b(r?e[r][1].start:o[1].end),e.splice(r||u,0,["exit",n,o[2]]),u++,a++}"listItemPrefix"===o[1].type&&(n={type:"listItem",_spread:!1,start:b(o[1].start)},e.splice(u,0,["enter",n,o[2]]),u++,a++,l=void 0,c=!0)}return e[t][1]._spread=p,a}function u(e,t){l[e]=t}function g(e){return l[e]}function b(e){return{line:e.line,column:e.column,offset:e.offset}}function f(e,t){return function(a){h.call(this,e(a),a),t&&t.call(this,a)}}function y(){this.stack.push({type:"fragment",children:[]})}function h(e,t){return this.stack[this.stack.length-1].children.push(e),this.stack.push(e),this.tokenStack.push(t),e.position={start:b(t.start)},e}function E(e){return function(t){e&&e.call(this,t),v.call(this,t)}}function v(e){var t=this.stack.pop(),a=this.tokenStack.pop();if(!a)throw new Error("Cannot close `"+e.type+"` ("+p({start:e.start,end:e.end})+"): it’s not open");if(a.type!==e.type)throw new Error("Cannot close `"+e.type+"` ("+p({start:e.start,end:e.end})+"): a different token (`"+a.type+"`, "+p({start:a.start,end:a.end})+") is open");return t.position.end=b(e.end),t}function x(){return n(this.stack.pop())}function k(e){var t=this.stack[this.stack.length-1].children,a=t[t.length-1];a&&"text"===a.type||((a={type:"text",value:""}).position={start:b(e.start)},this.stack[this.stack.length-1].children.push(a)),this.stack.push(a)}function S(e){var t=this.stack.pop();t.value+=this.sliceSerialize(e),t.position.end=b(e.end)}function j(){u("atHardBreak",!0)}function O(e){u("characterReferenceType",e.type)}function w(){return{type:"code",lang:null,meta:null,value:""}}function T(){return{type:"heading",depth:void 0,children:[]}}function I(){return{type:"break"}}function C(){return{type:"html",value:""}}function M(){return{type:"link",title:null,url:"",children:[]}}function F(e){return{type:"list",ordered:"listOrdered"===e.type,start:null,spread:e._spread,children:[]}}}(a)(u(l(a).document().write(c()(e,t,!0))))};var n=a(1001),i=a(309),r=a(663),s=a(486),o=a(1002),l=a(1003),c=a(1042),u=a(1043),d=a(668),p=a(1044);function m(e,t){var a,n;for(a in t)n=r.call(e,a)?e[a]:e[a]={},"canContainEols"===a?e[a]=[].concat(n,t[a]):Object.assign(n,t[a])}},function(e,t,a){"use strict";function n(e){return e&&(e.value||e.alt||e.title||"children"in e&&i(e.children)||"length"in e&&i(e))||""}function i(e){for(var t=[],a=-1;++a<e.length;)t[a]=n(e[a]);return t.join("")}e.exports=n},function(e,t,a){"use strict";var n=a(367);e.exports=function(e,t){var a=parseInt(e,t);return a<9||11===a||a>13&&a<32||a>126&&a<160||a>55295&&a<57344||a>64975&&a<65008||65535==(65535&a)||65534==(65535&a)||a>1114111?"�":n(a)}},function(e,t,a){"use strict";var n=a(1004),i=a(1005),r=a(1006),s=a(666),o=a(1009),l=a(1010),c=a(487),u=a(1013);e.exports=function(e){var t={defined:[],constructs:o([u].concat(c((e||{}).extensions))),content:a(n),document:a(i),flow:a(r),string:a(s.string),text:a(s.text)};return t;function a(e){return function(a){return l(t,e,a)}}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(115),i=a(122);t.tokenize=function(e){var t,a=e.attempt(this.parser.constructs.contentInitial,(function(t){if(null!==t)return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),i(e,a,"linePrefix");e.consume(t)}),(function(t){return e.enter("paragraph"),r(t)}));return a;function r(a){var n=e.enter("chunkText",{contentType:"text",previous:t});return t&&(t.next=n),t=n,s(a)}function s(t){return null===t?(e.exit("chunkText"),e.exit("paragraph"),void e.consume(t)):n(t)?(e.consume(t),e.exit("chunkText"),r):(e.consume(t),s)}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(115),i=a(122),r=a(368),s={tokenize:function(e,t,a){return i(e,e.attempt(this.parser.constructs.document,t,a),"linePrefix",this.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)}},o={tokenize:function(e,t,a){return i(e,e.lazy(this.parser.constructs.flow,t,a),"linePrefix",this.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)}};t.tokenize=function(e){var t,a,i,l=this,c=[],u=0,d={tokenize:function(e,n){var i=0;return t={},u;function u(n){return i<c.length?(l.containerState=c[i][1],e.attempt(c[i][0].continuation,d,p)(n)):a.currentConstruct&&a.currentConstruct.concrete?(t.flowContinue=!0,b(n)):(l.interrupt=a.currentConstruct&&a.currentConstruct.interruptible,l.containerState={},e.attempt(s,g,b)(n))}function d(e){return i++,l.containerState._closeFlow?g(e):u(e)}function p(t){return a.currentConstruct&&a.currentConstruct.lazy?(l.containerState={},e.attempt(s,g,e.attempt(o,g,e.check(r,g,m)))(t)):g(t)}function m(e){return i=c.length,t.lazy=!0,t.flowContinue=!0,b(e)}function g(e){return t.flowEnd=!0,b(e)}function b(e){return t.continued=i,l.interrupt=l.containerState=void 0,n(e)}},partial:!0};return p;function p(t){return u<c.length?(l.containerState=c[u][1],e.attempt(c[u][0].continuation,m,g)(t)):g(t)}function m(e){return u++,p(e)}function g(n){return t&&t.flowContinue?f(n):(l.interrupt=a&&a.currentConstruct&&a.currentConstruct.interruptible,l.containerState={},e.attempt(s,b,f)(n))}function b(e){return c.push([l.currentConstruct,l.containerState]),l.containerState=void 0,g(e)}function f(t){return null===t?(v(0,!0),void e.consume(t)):(a=a||l.parser.flow(l.now()),e.enter("chunkFlow",{contentType:"flow",previous:i,_tokenizer:a}),y(t))}function y(t){return null===t?(E(e.exit("chunkFlow")),f(t)):n(t)?(e.consume(t),E(e.exit("chunkFlow")),e.check(d,h)):(e.consume(t),y)}function h(e){return v(t.continued,t&&t.flowEnd),u=0,p(e)}function E(e){i&&(i.next=e),i=e,a.lazy=t&&t.lazy,a.defineSkip(e.start),a.write(l.sliceStream(e))}function v(t,n){var r=c.length;for(a&&n&&(a.write([null]),i=a=void 0);r-- >t;)l.containerState=c[r][1],c[r][0].exit.call(l,e);c.length=t}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(1007),i=a(122),r=a(368);t.tokenize=function(e){var t=this,a=e.attempt(r,(function(n){if(null!==n)return e.enter("lineEndingBlank"),e.consume(n),e.exit("lineEndingBlank"),t.currentConstruct=void 0,a;e.consume(n)}),e.attempt(this.parser.constructs.flowInitial,s,i(e,e.attempt(this.parser.constructs.flow,s,e.attempt(n,s)),"linePrefix")));return a;function s(n){if(null!==n)return e.enter("lineEnding"),e.consume(n),e.exit("lineEnding"),t.currentConstruct=void 0,a;e.consume(n)}}},function(e,t,a){"use strict";var n=a(115),i=a(369),r=a(665),s=a(122),o={tokenize:function(e,t){var a;return function(t){return e.enter("content"),a=e.enter("chunkContent",{contentType:"content"}),i(t)};function i(t){return null===t?r(t):n(t)?e.check(l,s,r)(t):(e.consume(t),i)}function r(a){return e.exit("chunkContent"),e.exit("content"),t(a)}function s(t){return e.consume(t),e.exit("chunkContent"),a=a.next=e.enter("chunkContent",{contentType:"content",previous:a}),i}},resolve:function(e){return r(e),e},interruptible:!0,lazy:!0},l={tokenize:function(e,t,a){var r=this;return function(t){return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),s(e,o,"linePrefix")};function o(s){return null===s||n(s)?a(s):r.parser.constructs.disable.null.indexOf("codeIndented")>-1||i(r.events,"linePrefix")<4?e.interrupt(r.parser.constructs.flow,a,t)(s):t(s)}},partial:!0};e.exports=o},function(e,t,a){"use strict";var n=[].splice;e.exports=n},function(e,t,a){"use strict";var n=a(663),i=a(200),r=a(487);function s(e,t){var a,i,s,l;for(a in t)for(l in i=n.call(e,a)?e[a]:e[a]={},s=t[a])i[l]=o(r(s[l]),n.call(i,l)?i[l]:[])}function o(e,t){for(var a=-1,n=[];++a<e.length;)("after"===e[a].add?t:n).push(e[a]);return i(t,0,0,n),t}e.exports=function(e){for(var t={},a=-1;++a<e.length;)s(t,e[a]);return t}},function(e,t,a){"use strict";var n=a(309),i=a(115),r=a(488),s=a(200),o=a(487),l=a(489),c=a(1011),u=a(263),d=a(1012);e.exports=function(e,t,a){var p=a?u(a):{line:1,column:1,offset:0},m={},g=[],b=[],f=[],y={consume:function(e){i(e)?(p.line++,p.column=1,p.offset+=-3===e?2:1,w()):-1!==e&&(p.column++,p.offset++),p._bufferIndex<0?p._index++:(p._bufferIndex++,p._bufferIndex===b[p._index].length&&(p._bufferIndex=-1,p._index++)),h.previous=e},enter:function(e,t){var a=t||{};return a.type=e,a.start=x(),h.events.push(["enter",a,h]),f.push(a),a},exit:function(e){var t=f.pop();return t.end=x(),h.events.push(["exit",t,h]),t},attempt:j((function(e,t){O(e,t.from)})),check:j(S),interrupt:j(S,{interrupt:!0}),lazy:j(S,{lazy:!0})},h={previous:null,events:[],parser:e,sliceStream:v,sliceSerialize:function(e){return c(v(e))},now:x,defineSkip:function(e){m[e.line]=e.column,w()},write:function(e){return b=r(b,e),function(){for(var e,t;p._index<b.length;)if("string"==typeof(t=b[p._index]))for(e=p._index,p._bufferIndex<0&&(p._bufferIndex=0);p._index===e&&p._bufferIndex<t.length;)k(t.charCodeAt(p._bufferIndex));else k(t)}(),null!==b[b.length-1]?[]:(O(t,0),h.events=l(g,h.events,h),h.events)}},E=t.tokenize.call(h,y);return t.resolveAll&&g.push(t),p._index=0,p._bufferIndex=-1,h;function v(e){return d(b,e)}function x(){return u(p)}function k(e){E=E(e)}function S(e,t){t.restore()}function j(e,t){return function(a,i,r){var s,l,c,u;return a.tokenize||"length"in a?d(o(a)):function(e){return e in a||null in a?d(a.null?o(a[e]).concat(o(a.null)):a[e])(e):r(e)};function d(e){return s=e,m(e[l=0])}function m(e){return function(a){var i,r,s,o,l;return i=x(),r=h.previous,s=h.currentConstruct,o=h.events.length,l=Array.from(f),u={restore:function(){p=i,h.previous=r,h.currentConstruct=s,h.events.length=o,f=l,w()},from:o},c=e,e.partial||(h.currentConstruct=e),e.name&&h.parser.constructs.disable.null.indexOf(e.name)>-1?b():e.tokenize.call(t?n({},h,t):h,y,g,b)(a)}}function g(t){return e(c,u),i}function b(e){return u.restore(),++l<s.length?m(s[l]):r}}}function O(e,t){e.resolveAll&&g.indexOf(e)<0&&g.push(e),e.resolve&&s(h.events,t,h.events.length-t,e.resolve(h.events.slice(t),h)),e.resolveTo&&(h.events=e.resolveTo(h.events,h))}function w(){p.line in m&&p.column<2&&(p.column=m[p.line],p.offset+=m[p.line]-1)}}},function(e,t,a){"use strict";var n=a(367);e.exports=function(e){for(var t,a,i,r=-1,s=[];++r<e.length;){if("string"==typeof(t=e[r]))a=t;else if(-5===t)a="\r";else if(-4===t)a="\n";else if(-3===t)a="\r\n";else if(-2===t)a="\t";else if(-1===t){if(i)continue;a=" "}else a=n(t);i=-2===t,s.push(a)}return s.join("")}},function(e,t,a){"use strict";e.exports=function(e,t){var a,n=t.start._index,i=t.start._bufferIndex,r=t.end._index,s=t.end._bufferIndex;return n===r?a=[e[n].slice(i,s)]:(a=e.slice(n,r),i>-1&&(a[0]=a[0].slice(i)),s>0&&a.push(e[r].slice(0,s))),a}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(666),i=a(1014),r=a(1020),s=a(1022),o=a(1023),l=a(1025),c=a(1027),u=a(1028),d=a(1029),p=a(1030),m=a(1031),g=a(1032),b=a(1033),f=a(1036),y=a(491),h=a(1037),E=a(1038),v=a(1039),x=a(1040),k=a(1041),S=a(674),j={42:x,43:x,45:x,48:x,49:x,50:x,51:x,52:x,53:x,54:x,55:x,56:x,57:x,62:s},O={91:p},w={"-2":u,"-1":u,32:u},T={35:g,42:S,45:[k,S],60:b,61:k,95:S,96:c,126:c},I={38:l,92:o},C={"-5":v,"-4":v,"-3":v,33:h,38:l,42:i,60:[r,f],91:E,92:[m,o],93:y,95:i,96:d},M={null:[i,n.resolver]};t.contentInitial=O,t.disable={null:[]},t.document=j,t.flow=T,t.flowInitial=w,t.insideSpan=M,t.string=I,t.text=C},function(e,t,a){"use strict";var n=a(488),i=a(200),r=a(1015),s=a(1019),o=a(489),l=a(263),c={name:"attention",tokenize:function(e,t){var a,n=r(this.previous);return function(t){return e.enter("attentionSequence"),a=t,i(t)};function i(s){var o,l,c,u;return s===a?(e.consume(s),i):(o=e.exit("attentionSequence"),c=!(l=r(s))||2===l&&n,u=!n||2===n&&l,o._open=42===a?c:c&&(n||!u),o._close=42===a?u:u&&(l||!c),t(s))}},resolveAll:function(e,t){for(var a,r,c,u,d,p,m,g,b=-1;++b<e.length;)if("enter"===e[b][0]&&"attentionSequence"===e[b][1].type&&e[b][1]._close)for(a=b;a--;)if("exit"===e[a][0]&&"attentionSequence"===e[a][1].type&&e[a][1]._open&&t.sliceSerialize(e[a][1]).charCodeAt(0)===t.sliceSerialize(e[b][1]).charCodeAt(0)){if((e[a][1]._close||e[b][1]._open)&&(e[b][1].end.offset-e[b][1].start.offset)%3&&!((e[a][1].end.offset-e[a][1].start.offset+e[b][1].end.offset-e[b][1].start.offset)%3))continue;u={type:(p=e[a][1].end.offset-e[a][1].start.offset>1&&e[b][1].end.offset-e[b][1].start.offset>1?2:1)>1?"strongSequence":"emphasisSequence",start:s(l(e[a][1].end),-p),end:l(e[a][1].end)},d={type:p>1?"strongSequence":"emphasisSequence",start:l(e[b][1].start),end:s(l(e[b][1].start),p)},c={type:p>1?"strongText":"emphasisText",start:l(e[a][1].end),end:l(e[b][1].start)},r={type:p>1?"strong":"emphasis",start:l(u.start),end:l(d.end)},e[a][1].end=l(u.start),e[b][1].start=l(d.end),m=[],e[a][1].end.offset-e[a][1].start.offset&&(m=n(m,[["enter",e[a][1],t],["exit",e[a][1],t]])),m=n(m,[["enter",r,t],["enter",u,t],["exit",u,t],["enter",c,t]]),m=n(m,o(t.parser.constructs.insideSpan.null,e.slice(a+1,b),t)),m=n(m,[["exit",c,t],["enter",d,t],["exit",d,t],["exit",r,t]]),e[b][1].end.offset-e[b][1].start.offset?(g=2,m=n(m,[["enter",e[b][1],t],["exit",e[b][1],t]])):g=0,i(e,a-1,b-a+3,m),b=a+m.length-g-2;break}for(b=-1;++b<e.length;)"attentionSequence"===e[b][1].type&&(e[b][1].type="data");return e}};e.exports=c},function(e,t,a){"use strict";var n=a(201),i=a(1016),r=a(1018);e.exports=function(e){return null===e||n(e)||r(e)?1:i(e)?2:void 0}},function(e,t,a){"use strict";var n=a(1017),i=a(202)(n);e.exports=i},function(e,t,a){"use strict";e.exports=/[!-\/:-@\[-`\{-~\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]/},function(e,t,a){"use strict";var n=a(202)(/\s/);e.exports=n},function(e,t,a){"use strict";e.exports=function(e,t){return e.column+=t,e.offset+=t,e._bufferIndex+=t,e}},function(e,t,a){"use strict";var n=a(490),i=a(370),r=a(1021),s=a(667),o={name:"autolink",tokenize:function(e,t,a){var o=1;return function(t){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(t),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),l};function l(t){return n(t)?(e.consume(t),c):r(t)?p(t):a(t)}function c(e){return 43===e||45===e||46===e||i(e)?u(e):p(e)}function u(t){return 58===t?(e.consume(t),d):(43===t||45===t||46===t||i(t))&&o++<32?(e.consume(t),u):p(t)}function d(t){return 62===t?(e.exit("autolinkProtocol"),f(t)):32===t||60===t||s(t)?a(t):(e.consume(t),d)}function p(t){return 64===t?(e.consume(t),o=0,m):r(t)?(e.consume(t),p):a(t)}function m(e){return i(e)?g(e):a(e)}function g(t){return 46===t?(e.consume(t),o=0,m):62===t?(e.exit("autolinkProtocol").type="autolinkEmail",f(t)):b(t)}function b(t){return(45===t||i(t))&&o++<63?(e.consume(t),45===t?b:g):a(t)}function f(a){return e.enter("autolinkMarker"),e.consume(a),e.exit("autolinkMarker"),e.exit("autolink"),t}}};e.exports=o},function(e,t,a){"use strict";var n=a(202)(/[#-'*+\--9=?A-Z^-~]/);e.exports=n},function(e,t,a){"use strict";var n=a(189),i=a(122),r={name:"blockQuote",tokenize:function(e,t,a){var i=this;return function(t){return 62===t?(i.containerState.open||(e.enter("blockQuote",{_container:!0}),i.containerState.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(t),e.exit("blockQuoteMarker"),r):a(t)};function r(a){return n(a)?(e.enter("blockQuotePrefixWhitespace"),e.consume(a),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),t):(e.exit("blockQuotePrefix"),t(a))}},continuation:{tokenize:function(e,t,a){return i(e,e.attempt(r,t,a),"linePrefix",this.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)}},exit:function(e){e.exit("blockQuote")}};e.exports=r},function(e,t,a){"use strict";var n=a(1024),i={name:"characterEscape",tokenize:function(e,t,a){return function(t){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(t),e.exit("escapeMarker"),i};function i(i){return n(i)?(e.enter("characterEscapeValue"),e.consume(i),e.exit("characterEscapeValue"),e.exit("characterEscape"),t):a(i)}}};e.exports=i},function(e,t,a){"use strict";var n=a(202)(/[!-/:-@[-`{-~]/);e.exports=n},function(e,t,a){"use strict";var n=a(668),i=a(370),r=a(669),s=a(1026);function o(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var l=o(n),c={name:"characterReference",tokenize:function(e,t,a){var n,o,c=this,u=0;return function(t){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(t),e.exit("characterReferenceMarker"),d};function d(t){return 35===t?(e.enter("characterReferenceMarkerNumeric"),e.consume(t),e.exit("characterReferenceMarkerNumeric"),p):(e.enter("characterReferenceValue"),n=31,o=i,m(t))}function p(t){return 88===t||120===t?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(t),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),n=6,o=s,m):(e.enter("characterReferenceValue"),n=7,o=r,m(t))}function m(r){var s;return 59===r&&u?(s=e.exit("characterReferenceValue"),o!==i||l.default(c.sliceSerialize(s))?(e.enter("characterReferenceMarker"),e.consume(r),e.exit("characterReferenceMarker"),e.exit("characterReference"),t):a(r)):o(r)&&u++<n?(e.consume(r),m):a(r)}}};e.exports=c},function(e,t,a){"use strict";var n=a(202)(/[\dA-Fa-f]/);e.exports=n},function(e,t,a){"use strict";var n=a(115),i=a(201),r=a(369),s=a(122),o={name:"codeFenced",tokenize:function(e,t,a){var o,l=this,c={tokenize:function(e,t,a){var i=0;return s(e,(function(t){return e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),r(t)}),"linePrefix",this.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4);function r(t){return t===o?(e.consume(t),i++,r):i<d?a(t):(e.exit("codeFencedFenceSequence"),s(e,l,"whitespace")(t))}function l(i){return null===i||n(i)?(e.exit("codeFencedFence"),t(i)):a(i)}},partial:!0},u=r(this.events,"linePrefix"),d=0;return function(t){return e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),o=t,p(t)};function p(t){return t===o?(e.consume(t),d++,p):(e.exit("codeFencedFenceSequence"),d<3?a(t):s(e,m,"whitespace")(t))}function m(t){return null===t||n(t)?y(t):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),g(t))}function g(t){return null===t||i(t)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),s(e,b,"whitespace")(t)):96===t&&t===o?a(t):(e.consume(t),g)}function b(t){return null===t||n(t)?y(t):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),f(t))}function f(t){return null===t||n(t)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),y(t)):96===t&&t===o?a(t):(e.consume(t),f)}function y(a){return e.exit("codeFencedFence"),l.interrupt?t(a):h(a)}function h(t){return null===t?v(t):n(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),e.attempt(c,v,u?s(e,h,"linePrefix",u+1):h)):(e.enter("codeFlowValue"),E(t))}function E(t){return null===t||n(t)?(e.exit("codeFlowValue"),h(t)):(e.consume(t),E)}function v(a){return e.exit("codeFenced"),t(a)}},concrete:!0};e.exports=o},function(e,t,a){"use strict";var n=a(115),i=a(200),r=a(369),s=a(122),o={name:"codeIndented",tokenize:function(e,t,a){return e.attempt(l,i,a);function i(a){return null===a?t(a):n(a)?e.attempt(l,i,t)(a):(e.enter("codeFlowValue"),r(a))}function r(t){return null===t||n(t)?(e.exit("codeFlowValue"),i(t)):(e.consume(t),r)}},resolve:function(e,t){var a={type:"codeIndented",start:e[0][1].start,end:e[e.length-1][1].end};return i(e,0,0,[["enter",a,t]]),i(e,e.length,0,[["exit",a,t]]),e}},l={tokenize:function(e,t,a){var i=this;return s(e,(function o(l){return n(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),s(e,o,"linePrefix",5)):r(i.events,"linePrefix")<4?a(l):t(l)}),"linePrefix",5)},partial:!0};e.exports=o},function(e,t,a){"use strict";var n=a(115),i={name:"codeText",tokenize:function(e,t,a){var i,r,s=0;return function(t){return e.enter("codeText"),e.enter("codeTextSequence"),o(t)};function o(t){return 96===t?(e.consume(t),s++,o):(e.exit("codeTextSequence"),l(t))}function l(t){return null===t?a(t):96===t?(r=e.enter("codeTextSequence"),i=0,u(t)):32===t?(e.enter("space"),e.consume(t),e.exit("space"),l):n(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),l):(e.enter("codeTextData"),c(t))}function c(t){return null===t||32===t||96===t||n(t)?(e.exit("codeTextData"),l(t)):(e.consume(t),c)}function u(a){return 96===a?(e.consume(a),i++,u):i===s?(e.exit("codeTextSequence"),e.exit("codeText"),t(a)):(r.type="codeTextData",c(a))}},resolve:function(e){var t,a,n=e.length-4,i=3;if(!("lineEnding"!==e[i][1].type&&"space"!==e[i][1].type||"lineEnding"!==e[n][1].type&&"space"!==e[n][1].type))for(t=i;++t<n;)if("codeTextData"===e[t][1].type){e[n][1].type=e[i][1].type="codeTextPadding",i+=2,n-=2;break}for(t=i-1,n++;++t<=n;)void 0===a?t!==n&&"lineEnding"!==e[t][1].type&&(a=t):t!==n&&"lineEnding"!==e[t][1].type||(e[a][1].type="codeTextData",t!==a+2&&(e[a][1].end=e[t-1][1].end,e.splice(a+2,t-a-2),n-=t-a-2,t=a+2),a=void 0);return e},previous:function(e){return 96!==e||"characterEscape"===this.events[this.events.length-1][1].type}};e.exports=i},function(e,t,a){"use strict";var n=a(115),i=a(201),r=a(486),s=a(670),o=a(671),l=a(122),c=a(672),u=a(673),d={name:"definition",tokenize:function(e,t,a){var i,u=this;return function(t){return e.enter("definition"),o.call(u,e,d,a,"definitionLabel","definitionLabelMarker","definitionLabelString")(t)};function d(t){return i=r(u.sliceSerialize(u.events[u.events.length-1][1]).slice(1,-1)),58===t?(e.enter("definitionMarker"),e.consume(t),e.exit("definitionMarker"),c(e,s(e,e.attempt(p,l(e,m,"whitespace"),l(e,m,"whitespace")),a,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString"))):a(t)}function m(r){return null===r||n(r)?(e.exit("definition"),u.parser.defined.indexOf(i)<0&&u.parser.defined.push(i),t(r)):a(r)}}},p={tokenize:function(e,t,a){return function(t){return i(t)?c(e,r)(t):a(t)};function r(t){return 34===t||39===t||40===t?u(e,l(e,s,"whitespace"),a,"definitionTitle","definitionTitleMarker","definitionTitleString")(t):a(t)}function s(e){return null===e||n(e)?t(e):a(e)}},partial:!0};e.exports=d},function(e,t,a){"use strict";var n=a(115),i={name:"hardBreakEscape",tokenize:function(e,t,a){return function(t){return e.enter("hardBreakEscape"),e.enter("escapeMarker"),e.consume(t),i};function i(i){return n(i)?(e.exit("escapeMarker"),e.exit("hardBreakEscape"),t(i)):a(i)}}};e.exports=i},function(e,t,a){"use strict";var n=a(115),i=a(201),r=a(189),s=a(200),o=a(122),l={name:"headingAtx",tokenize:function(e,t,a){var s=this,l=0;return function(t){return e.enter("atxHeading"),e.enter("atxHeadingSequence"),c(t)};function c(n){return 35===n&&l++<6?(e.consume(n),c):null===n||i(n)?(e.exit("atxHeadingSequence"),s.interrupt?t(n):u(n)):a(n)}function u(a){return 35===a?(e.enter("atxHeadingSequence"),d(a)):null===a||n(a)?(e.exit("atxHeading"),t(a)):r(a)?o(e,u,"whitespace")(a):(e.enter("atxHeadingText"),p(a))}function d(t){return 35===t?(e.consume(t),d):(e.exit("atxHeadingSequence"),u(t))}function p(t){return null===t||35===t||i(t)?(e.exit("atxHeadingText"),u(t)):(e.consume(t),p)}},resolve:function(e,t){var a,n,i=e.length-2,r=3;return"whitespace"===e[r][1].type&&(r+=2),i-2>r&&"whitespace"===e[i][1].type&&(i-=2),"atxHeadingSequence"===e[i][1].type&&(r===i-1||i-4>r&&"whitespace"===e[i-2][1].type)&&(i-=r+1===i?2:4),i>r&&(a={type:"atxHeadingText",start:e[r][1].start,end:e[i][1].end},n={type:"chunkText",start:e[r][1].start,end:e[i][1].end,contentType:"text"},s(e,r,i-r+1,[["enter",a,t],["enter",n,t],["exit",n,t],["exit",a,t]])),e}};e.exports=l},function(e,t,a){"use strict";var n=a(490),i=a(370),r=a(115),s=a(201),o=a(189),l=a(367),c=a(1034),u=a(1035),d=a(368),p={name:"htmlFlow",tokenize:function(e,t,a){var d,p,g,b,f,y=this;return function(t){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(t),h};function h(i){return 33===i?(e.consume(i),E):47===i?(e.consume(i),k):63===i?(e.consume(i),d=3,y.interrupt?t:$):n(i)?(e.consume(i),g=l(i),p=!0,S):a(i)}function E(i){return 45===i?(e.consume(i),d=2,v):91===i?(e.consume(i),d=5,g="CDATA[",b=0,x):n(i)?(e.consume(i),d=4,y.interrupt?t:$):a(i)}function v(n){return 45===n?(e.consume(n),y.interrupt?t:$):a(n)}function x(n){return n===g.charCodeAt(b++)?(e.consume(n),b===g.length?y.interrupt?t:N:x):a(n)}function k(t){return n(t)?(e.consume(t),g=l(t),S):a(t)}function S(n){return null===n||47===n||62===n||s(n)?47!==n&&p&&u.indexOf(g.toLowerCase())>-1?(d=1,y.interrupt?t(n):N(n)):c.indexOf(g.toLowerCase())>-1?(d=6,47===n?(e.consume(n),j):y.interrupt?t(n):N(n)):(d=7,y.interrupt?a(n):p?w(n):O(n)):45===n||i(n)?(e.consume(n),g+=l(n),S):a(n)}function j(n){return 62===n?(e.consume(n),y.interrupt?t:N):a(n)}function O(t){return o(t)?(e.consume(t),O):A(t)}function w(t){return 47===t?(e.consume(t),A):58===t||95===t||n(t)?(e.consume(t),T):o(t)?(e.consume(t),w):A(t)}function T(t){return 45===t||46===t||58===t||95===t||i(t)?(e.consume(t),T):I(t)}function I(t){return 61===t?(e.consume(t),C):o(t)?(e.consume(t),I):w(t)}function C(t){return null===t||60===t||61===t||62===t||96===t?a(t):34===t||39===t?(e.consume(t),f=t,M):o(t)?(e.consume(t),C):(f=void 0,F(t))}function M(t){return t===f?(e.consume(t),D):null===t||r(t)?a(t):(e.consume(t),M)}function F(t){return null===t||34===t||39===t||60===t||61===t||62===t||96===t||s(t)?I(t):(e.consume(t),F)}function D(e){return 47===e||62===e||o(e)?w(e):a(e)}function A(t){return 62===t?(e.consume(t),_):a(t)}function _(t){return o(t)?(e.consume(t),_):null===t||r(t)?N(t):a(t)}function N(t){return 45===t&&2===d?(e.consume(t),L):60===t&&1===d?(e.consume(t),B):62===t&&4===d?(e.consume(t),V):63===t&&3===d?(e.consume(t),$):93===t&&5===d?(e.consume(t),z):!r(t)||6!==d&&7!==d?null===t||r(t)?R(t):(e.consume(t),N):e.check(m,V,R)(t)}function R(t){return e.exit("htmlFlowData"),P(t)}function P(t){return null===t?U(t):r(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),P):(e.enter("htmlFlowData"),N(t))}function L(t){return 45===t?(e.consume(t),$):N(t)}function B(t){return 47===t?(e.consume(t),g="",q):N(t)}function q(t){return 62===t&&u.indexOf(g.toLowerCase())>-1?(e.consume(t),V):n(t)&&g.length<8?(e.consume(t),g+=l(t),q):N(t)}function z(t){return 93===t?(e.consume(t),$):N(t)}function $(t){return 62===t?(e.consume(t),V):N(t)}function V(t){return null===t||r(t)?(e.exit("htmlFlowData"),U(t)):(e.consume(t),V)}function U(a){return e.exit("htmlFlow"),t(a)}},resolveTo:function(e){for(var t=e.length;t--&&("enter"!==e[t][0]||"htmlFlow"!==e[t][1].type););return t>1&&"linePrefix"===e[t-2][1].type&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2)),e},concrete:!0},m={tokenize:function(e,t,a){return function(n){return e.exit("htmlFlowData"),e.enter("lineEndingBlank"),e.consume(n),e.exit("lineEndingBlank"),e.attempt(d,t,a)}},partial:!0};e.exports=p},function(e,t,a){"use strict";e.exports=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","section","source","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"]},function(e,t,a){"use strict";e.exports=["pre","script","style","textarea"]},function(e,t,a){"use strict";var n=a(490),i=a(370),r=a(115),s=a(201),o=a(189),l=a(122),c={name:"htmlText",tokenize:function(e,t,a){var c,u,d,p,m=this;return function(t){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(t),g};function g(t){return 33===t?(e.consume(t),b):47===t?(e.consume(t),I):63===t?(e.consume(t),w):n(t)?(e.consume(t),F):a(t)}function b(t){return 45===t?(e.consume(t),f):91===t?(e.consume(t),u="CDATA[",d=0,x):n(t)?(e.consume(t),O):a(t)}function f(t){return 45===t?(e.consume(t),y):a(t)}function y(t){return null===t||62===t?a(t):45===t?(e.consume(t),h):E(t)}function h(e){return null===e||62===e?a(e):E(e)}function E(t){return null===t?a(t):45===t?(e.consume(t),v):r(t)?(p=E,B(t)):(e.consume(t),E)}function v(t){return 45===t?(e.consume(t),z):E(t)}function x(t){return t===u.charCodeAt(d++)?(e.consume(t),d===u.length?k:x):a(t)}function k(t){return null===t?a(t):93===t?(e.consume(t),S):r(t)?(p=k,B(t)):(e.consume(t),k)}function S(t){return 93===t?(e.consume(t),j):k(t)}function j(t){return 62===t?z(t):93===t?(e.consume(t),j):k(t)}function O(t){return null===t||62===t?z(t):r(t)?(p=O,B(t)):(e.consume(t),O)}function w(t){return null===t?a(t):63===t?(e.consume(t),T):r(t)?(p=w,B(t)):(e.consume(t),w)}function T(e){return 62===e?z(e):w(e)}function I(t){return n(t)?(e.consume(t),C):a(t)}function C(t){return 45===t||i(t)?(e.consume(t),C):M(t)}function M(t){return r(t)?(p=M,B(t)):o(t)?(e.consume(t),M):z(t)}function F(t){return 45===t||i(t)?(e.consume(t),F):47===t||62===t||s(t)?D(t):a(t)}function D(t){return 47===t?(e.consume(t),z):58===t||95===t||n(t)?(e.consume(t),A):r(t)?(p=D,B(t)):o(t)?(e.consume(t),D):z(t)}function A(t){return 45===t||46===t||58===t||95===t||i(t)?(e.consume(t),A):_(t)}function _(t){return 61===t?(e.consume(t),N):r(t)?(p=_,B(t)):o(t)?(e.consume(t),_):D(t)}function N(t){return null===t||60===t||61===t||62===t||96===t?a(t):34===t||39===t?(e.consume(t),c=t,R):r(t)?(p=N,B(t)):o(t)?(e.consume(t),N):(e.consume(t),c=void 0,L)}function R(t){return t===c?(e.consume(t),P):null===t?a(t):r(t)?(p=R,B(t)):(e.consume(t),R)}function P(e){return 62===e||47===e||s(e)?D(e):a(e)}function L(t){return null===t||34===t||39===t||60===t||61===t||96===t?a(t):62===t||s(t)?D(t):(e.consume(t),L)}function B(t){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),l(e,q,"linePrefix",m.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)}function q(t){return e.enter("htmlTextData"),p(t)}function z(n){return 62===n?(e.consume(n),e.exit("htmlTextData"),e.exit("htmlText"),t):a(n)}}};e.exports=c},function(e,t,a){"use strict";var n={name:"labelStartImage",tokenize:function(e,t,a){var n=this;return function(t){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(t),e.exit("labelImageMarker"),i};function i(t){return 91===t?(e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelImage"),r):a(t)}function r(e){return 94===e&&"_hiddenFootnoteSupport"in n.parser.constructs?a(e):t(e)}},resolveAll:a(491).resolveAll};e.exports=n},function(e,t,a){"use strict";var n={name:"labelStartLink",tokenize:function(e,t,a){var n=this;return function(t){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelLink"),i};function i(e){return 94===e&&"_hiddenFootnoteSupport"in n.parser.constructs?a(e):t(e)}},resolveAll:a(491).resolveAll};e.exports=n},function(e,t,a){"use strict";var n=a(122),i={name:"lineEnding",tokenize:function(e,t){return function(a){return e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),n(e,t,"linePrefix")}}};e.exports=i},function(e,t,a){"use strict";var n=a(669),i=a(189),r=a(369),s=a(664),o=a(122),l=a(368),c=a(674),u={name:"list",tokenize:function(e,t,a){var o=this,u=r(o.events,"linePrefix"),p=0;return function(t){var i=o.containerState.type||(42===t||43===t||45===t?"listUnordered":"listOrdered");if("listUnordered"===i?!o.containerState.marker||t===o.containerState.marker:n(t)){if(o.containerState.type||(o.containerState.type=i,e.enter(i,{_container:!0})),"listUnordered"===i)return e.enter("listItemPrefix"),42===t||45===t?e.check(c,a,g)(t):g(t);if(!o.interrupt||49===t)return e.enter("listItemPrefix"),e.enter("listItemValue"),m(t)}return a(t)};function m(t){return n(t)&&++p<10?(e.consume(t),m):(!o.interrupt||p<2)&&(o.containerState.marker?t===o.containerState.marker:41===t||46===t)?(e.exit("listItemValue"),g(t)):a(t)}function g(t){return e.enter("listItemMarker"),e.consume(t),e.exit("listItemMarker"),o.containerState.marker=o.containerState.marker||t,e.check(l,o.interrupt?a:b,e.attempt(d,y,f))}function b(e){return o.containerState.initialBlankLine=!0,u++,y(e)}function f(t){return i(t)?(e.enter("listItemPrefixWhitespace"),e.consume(t),e.exit("listItemPrefixWhitespace"),y):a(t)}function y(a){return o.containerState.size=u+s(o.sliceStream(e.exit("listItemPrefix"))),t(a)}},continuation:{tokenize:function(e,t,a){var n=this;return n.containerState._closeFlow=void 0,e.check(l,(function(a){return n.containerState.furtherBlankLines=n.containerState.furtherBlankLines||n.containerState.initialBlankLine,o(e,t,"listItemIndent",n.containerState.size+1)(a)}),(function(a){return n.containerState.furtherBlankLines||!i(a)?(n.containerState.furtherBlankLines=n.containerState.initialBlankLine=void 0,r(a)):(n.containerState.furtherBlankLines=n.containerState.initialBlankLine=void 0,e.attempt(p,t,r)(a))}));function r(i){return n.containerState._closeFlow=!0,n.interrupt=void 0,o(e,e.attempt(u,t,a),"linePrefix",n.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)(i)}}},exit:function(e){e.exit(this.containerState.type)}},d={tokenize:function(e,t,a){var n=this;return o(e,(function(e){return i(e)||!r(n.events,"listItemPrefixWhitespace")?a(e):t(e)}),"listItemPrefixWhitespace",n.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:5)},partial:!0},p={tokenize:function(e,t,a){var n=this;return o(e,(function(e){return r(n.events,"listItemIndent")===n.containerState.size?t(e):a(e)}),"listItemIndent",n.containerState.size+1)},partial:!0};e.exports=u},function(e,t,a){"use strict";var n=a(115),i=a(263),r=a(122),s={name:"setextUnderline",tokenize:function(e,t,a){for(var i,s,o=this,l=o.events.length;l--;)if("lineEnding"!==o.events[l][1].type&&"linePrefix"!==o.events[l][1].type&&"content"!==o.events[l][1].type){s="paragraph"===o.events[l][1].type;break}return function(t){return o.lazy||!o.interrupt&&!s?a(t):(e.enter("setextHeadingLine"),e.enter("setextHeadingLineSequence"),i=t,c(t))};function c(t){return t===i?(e.consume(t),c):(e.exit("setextHeadingLineSequence"),r(e,u,"lineSuffix")(t))}function u(i){return null===i||n(i)?(e.exit("setextHeadingLine"),t(i)):a(i)}},resolveTo:function(e,t){for(var a,n,r,s,o=e.length;o--;)if("enter"===e[o][0]){if("content"===e[o][1].type){a=o;break}"paragraph"===e[o][1].type&&(n=o)}else"content"===e[o][1].type&&e.splice(o,1),r||"definition"!==e[o][1].type||(r=o);return s={type:"setextHeading",start:i(e[n][1].start),end:i(e[e.length-1][1].end)},e[n][1].type="setextHeadingText",r?(e.splice(n,0,["enter",s,t]),e.splice(r+1,0,["exit",e[a][1],t]),e[a][1].end=i(e[r][1].end)):e[a][1]=s,e.push(["exit",s,t]),e}};e.exports=s},function(e,t,a){"use strict";var n=/[\0\t\n\r]/g;e.exports=function(){var e,t=!0,a=1,i="";return function(r,s,o){var l,c,u,d,p,m=[];for(r=i+r.toString(s),u=0,i="",t&&(65279===r.charCodeAt(0)&&u++,t=void 0);u<r.length;){if(n.lastIndex=u,d=(l=n.exec(r))?l.index:r.length,p=r.charCodeAt(d),!l){i=r.slice(u);break}if(10===p&&u===d&&e)m.push(-3),e=void 0;else if(e&&(m.push(-5),e=void 0),u<d&&(m.push(r.slice(u,d)),a+=d-u),0===p)m.push(65533),a++;else if(9===p)for(c=4*Math.ceil(a/4),m.push(-2);a++<c;)m.push(-1);else 10===p?(m.push(-4),a=1):(e=!0,a=1);u=d+1}return o&&(e&&m.push(-5),i&&m.push(i),m.push(null)),m}}},function(e,t,a){"use strict";var n=a(665);e.exports=function(e){for(;!n(e););return e}},function(e,t,a){e.exports=a(27)(3455)},function(e,t,a){e.exports=a(27)(1887)},function(e,t,a){e.exports=a(27)(1516)},function(e,t,a){const n=a(1048);e.exports=function(e){if(e.allowedElements&&e.disallowedElements)throw new TypeError("Only one of `allowedElements` and `disallowedElements` should be defined");if(e.allowedElements||e.disallowedElements||e.allowElement)return e=>{n(e,"element",t)};function t(t,a,n){const i=t,r=n;let s;if(e.allowedElements?s=!e.allowedElements.includes(i.tagName):e.disallowedElements&&(s=e.disallowedElements.includes(i.tagName)),!s&&e.allowElement&&"number"==typeof a&&(s=!e.allowElement(i,a,r)),s&&"number"==typeof a)return e.unwrapDisallowed&&i.children?r.children.splice(a,1,...i.children):r.children.splice(a,1),a}}},function(e,t,a){e.exports=a(27)(338)},function(e,t){const a=["http","https","mailto","tel"];e.exports=function(e){const t=(e||"").trim(),n=t.charAt(0);if("#"===n||"/"===n)return t;const i=t.indexOf(":");if(-1===i)return t;let r=-1;for(;++r<a.length;){const e=a[r];if(i===e.length&&t.slice(0,e.length).toLowerCase()===e)return t}return r=t.indexOf("?"),-1!==r&&i>r?t:(r=t.indexOf("#"),-1!==r&&i>r?t:"javascript:void(0)")}},function(e,t,a){"use strict";const n=a(4),i=a(1078),r=a(1051),s=a(1052),o=a(1053),l=a(1054),c=a(1055),u=a(1056);t.hastToReact=g,t.hastChildrenToReact=m;const d={}.hasOwnProperty,p=new Set(["table","thead","tbody","tfoot","tr"]);function m(e,t){const a=[];let n,i=-1;for(;++i<t.children.length;)n=t.children[i],"element"===n.type?a.push(g(e,n,i,t)):"text"===n.type?"element"===t.type&&p.has(t.tagName)&&"\n"===n.value||a.push(n.value):"raw"!==n.type||e.options.skipHtml||a.push(n.value);return a}function g(e,t,a,s){const o=e.options,l=e.schema,c=t.tagName,u={};let p,g=l;if("html"===l.space&&"svg"===c&&(g=r,e.schema=g),t.properties)for(p in t.properties)d.call(t.properties,p)&&f(u,p,t.properties[p],e);"ol"!==c&&"ul"!==c||e.listDepth++;const y=m(e,t);"ol"!==c&&"ul"!==c||e.listDepth--,e.schema=l;const h=t.position||{start:{line:null,column:null,offset:null},end:{line:null,column:null,offset:null}},E=o.components&&d.call(o.components,c)?o.components[c]:c,v="string"==typeof E||E===n.Fragment;if(!i.isValidElementType(E))throw new TypeError(`Component for name \`${c}\` not defined or is not renderable`);if(u.key=[c,h.start.line,h.start.column,a].join("-"),"a"===c&&o.linkTarget&&(u.target="function"==typeof o.linkTarget?o.linkTarget(u.href,t.children,u.title):o.linkTarget),"a"===c&&o.transformLinkUri&&(u.href=o.transformLinkUri(u.href,t.children,u.title)),v||"code"!==c||"element"!==s.type||"pre"===s.tagName||(u.inline=!0),v||"h1"!==c&&"h2"!==c&&"h3"!==c&&"h4"!==c&&"h5"!==c&&"h6"!==c||(u.level=parseInt(c.charAt(1),10)),"img"===c&&o.transformImageUri&&(u.src=o.transformImageUri(u.src,u.alt,u.title)),!v&&"li"===c&&"element"===s.type){const e=function(e){let t=-1;for(;++t<e.children.length;){const a=e.children[t];if("element"===a.type&&"input"===a.tagName)return a}return null}(t);u.checked=e&&e.properties?Boolean(e.properties.checked):null,u.index=b(s,t),u.ordered="ol"===s.tagName}var x;return v||"ol"!==c&&"ul"!==c||(u.ordered="ol"===c,u.depth=e.listDepth),"td"!==c&&"th"!==c||(u.align&&(u.style||(u.style={}),u.style.textAlign=u.align,delete u.align),v||(u.isHeader="th"===c)),v||"tr"!==c||"element"!==s.type||(u.isHeader=Boolean("thead"===s.tagName)),o.sourcePos&&(u["data-sourcepos"]=[(x=h).start.line,":",x.start.column,"-",x.end.line,":",x.end.column].map((e=>String(e))).join("")),!v&&o.rawSourcePos&&(u.sourcePosition=t.position),!v&&o.includeElementIndex&&(u.index=b(s,t),u.siblingCount=b(s)),v||(u.node=t),y.length>0?n.createElement(E,u,y):n.createElement(E,u)}function b(e,t){let a=-1,n=0;for(;++a<e.children.length&&e.children[a]!==t;)"element"===e.children[a].type&&n++;return n}function f(e,t,a,n){const i=s(n.schema,t);let r=a;null!=r&&r==r&&(r&&"object"==typeof r&&"length"in r&&(r=(i.commaSeparated?c:l).stringify(r)),"style"===i.property&&"string"==typeof r&&(r=function(e){const t={};try{u(e,(function(e,a){const n="-ms-"===e.slice(0,4)?`ms-${e.slice(4)}`:e;t[n.replace(/-([a-z])/g,y)]=a}))}catch(e){}return t}(r)),i.space&&i.property?e[d.call(o,i.property)?o[i.property]:i.property]=r:i.attribute&&(e[i.attribute]=r))}function y(e,t){return t.toUpperCase()}},function(e,t,a){e.exports=a(27)(3517)},function(e,t,a){e.exports=a(27)(1527)},function(e,t,a){e.exports=a(27)(3519)},function(e,t,a){e.exports=a(27)(1528)},function(e,t,a){e.exports=a(27)(1529)},function(e,t,a){e.exports=a(27)(3520)},function(e,t,a){var n,i,r,s;
/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */s=function(e){var t=Object.prototype.toString,a=Array.isArray||function(e){return"[object Array]"===t.call(e)};function n(e){return"function"==typeof e}function i(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function r(e,t){return null!=e&&"object"==typeof e&&t in e}var s=RegExp.prototype.test,o=/\S/;var l={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},c=/\s*/,u=/\s+/,d=/\s*=/,p=/\s*\}/,m=/#|\^|\/|>|\{|&|=|!/;function g(e){this.string=e,this.tail=e,this.pos=0}function b(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function f(){this.cache={}}g.prototype.eos=function(){return""===this.tail},g.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return"";var a=t[0];return this.tail=this.tail.substring(a.length),this.pos+=a.length,a},g.prototype.scanUntil=function(e){var t,a=this.tail.search(e);switch(a){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,a),this.tail=this.tail.substring(a)}return this.pos+=t.length,t},b.prototype.push=function(e){return new b(e,this)},b.prototype.lookup=function(e){var t,a=this.cache;if(a.hasOwnProperty(e))t=a[e];else{for(var i,s,o=this,l=!1;o;){if(e.indexOf(".")>0)for(t=o.view,i=e.split("."),s=0;null!=t&&s<i.length;)s===i.length-1&&(l=r(t,i[s])),t=t[i[s++]];else t=o.view[e],l=r(o.view,e);if(l)break;o=o.parent}a[e]=t}return n(t)&&(t=t.call(this.view)),t},f.prototype.clearCache=function(){this.cache={}},f.prototype.parse=function(t,n){var r=this.cache,l=r[t];return null==l&&(l=r[t]=function(t,n){if(!t)return[];var r,l,b,f,y=[],h=[],E=[],v=!1,x=!1;function k(){if(v&&!x)for(;E.length;)delete h[E.pop()];else E=[];v=!1,x=!1}function S(e){if("string"==typeof e&&(e=e.split(u,2)),!a(e)||2!==e.length)throw new Error("Invalid tags: "+e);r=new RegExp(i(e[0])+"\\s*"),l=new RegExp("\\s*"+i(e[1])),b=new RegExp("\\s*"+i("}"+e[1]))}S(n||e.tags);for(var j,O,w,T,I,C,M=new g(t);!M.eos();){if(j=M.pos,w=M.scanUntil(r))for(var F=0,D=w.length;F<D;++F)f=T=w.charAt(F),function(e,t){return s.call(e,t)}(o,f)?x=!0:E.push(h.length),h.push(["text",T,j,j+1]),j+=1,"\n"===T&&k();if(!M.scan(r))break;if(v=!0,O=M.scan(m)||"name",M.scan(c),"="===O?(w=M.scanUntil(d),M.scan(d),M.scanUntil(l)):"{"===O?(w=M.scanUntil(b),M.scan(p),M.scanUntil(l),O="&"):w=M.scanUntil(l),!M.scan(l))throw new Error("Unclosed tag at "+M.pos);if(I=[O,w,j,M.pos],h.push(I),"#"===O||"^"===O)y.push(I);else if("/"===O){if(!(C=y.pop()))throw new Error('Unopened section "'+w+'" at '+j);if(C[1]!==w)throw new Error('Unclosed section "'+C[1]+'" at '+j)}else"name"===O||"{"===O||"&"===O?x=!0:"="===O&&S(w)}if(C=y.pop())throw new Error('Unclosed section "'+C[1]+'" at '+M.pos);return function(e){for(var t,a=[],n=a,i=[],r=0,s=e.length;r<s;++r)switch((t=e[r])[0]){case"#":case"^":n.push(t),i.push(t),n=t[4]=[];break;case"/":i.pop()[5]=t[2],n=i.length>0?i[i.length-1][4]:a;break;default:n.push(t)}return a}(function(e){for(var t,a,n=[],i=0,r=e.length;i<r;++i)(t=e[i])&&("text"===t[0]&&a&&"text"===a[0]?(a[1]+=t[1],a[3]=t[3]):(n.push(t),a=t));return n}(h))}(t,n)),l},f.prototype.render=function(e,t,a){var n=this.parse(e),i=t instanceof b?t:new b(t);return this.renderTokens(n,i,a,e)},f.prototype.renderTokens=function(e,t,a,n){for(var i,r,s,o="",l=0,c=e.length;l<c;++l)s=void 0,"#"===(r=(i=e[l])[0])?s=this.renderSection(i,t,a,n):"^"===r?s=this.renderInverted(i,t,a,n):">"===r?s=this.renderPartial(i,t,a,n):"&"===r?s=this.unescapedValue(i,t):"name"===r?s=this.escapedValue(i,t):"text"===r&&(s=this.rawValue(i)),void 0!==s&&(o+=s);return o},f.prototype.renderSection=function(e,t,i,r){var s=this,o="",l=t.lookup(e[1]);if(l){if(a(l))for(var c=0,u=l.length;c<u;++c)o+=this.renderTokens(e[4],t.push(l[c]),i,r);else if("object"==typeof l||"string"==typeof l||"number"==typeof l)o+=this.renderTokens(e[4],t.push(l),i,r);else if(n(l)){if("string"!=typeof r)throw new Error("Cannot use higher-order sections without the original template");null!=(l=l.call(t.view,r.slice(e[3],e[5]),(function(e){return s.render(e,t,i)})))&&(o+=l)}else o+=this.renderTokens(e[4],t,i,r);return o}},f.prototype.renderInverted=function(e,t,n,i){var r=t.lookup(e[1]);if(!r||a(r)&&0===r.length)return this.renderTokens(e[4],t,n,i)},f.prototype.renderPartial=function(e,t,a){if(a){var i=n(a)?a(e[1]):a[e[1]];return null!=i?this.renderTokens(this.parse(i),t,a,i):void 0}},f.prototype.unescapedValue=function(e,t){var a=t.lookup(e[1]);if(null!=a)return a},f.prototype.escapedValue=function(t,a){var n=a.lookup(t[1]);if(null!=n)return e.escape(n)},f.prototype.rawValue=function(e){return e[1]},e.name="mustache.js",e.version="2.3.2",e.tags=["{{","}}"];var y=new f;return e.clearCache=function(){return y.clearCache()},e.parse=function(e,t){return y.parse(e,t)},e.render=function(e,t,n){if("string"!=typeof e)throw new TypeError('Invalid template! Template should be a "string" but "'+(a(i=e)?"array":typeof i)+'" was given as the first argument for mustache#render(template, view, partials)');var i;return y.render(e,t,n)},e.to_html=function(t,a,i,r){var s=e.render(t,a,i);if(!n(r))return s;r(s)},e.escape=function(e){return String(e).replace(/[&<>"'`=\/]/g,(function(e){return l[e]}))},e.Scanner=g,e.Context=b,e.Writer=f,e},t&&"string"!=typeof t.nodeName?s(t):(i=[t],void 0===(r="function"==typeof(n=s)?n.apply(t,i):n)||(e.exports=r))},function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(1059);case"v8light":return a(1061)}},function(e,t,a){var n=a(250),i=a(1060);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);n(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,a){(t=a(251)(!1)).push([e.i,".kbnOverlayMountWrapper{display:flex;flex-direction:column;height:100%;overflow:hidden}",""]),e.exports=t},function(e,t,a){var n=a(250),i=a(1062);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);n(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,a){(t=a(251)(!1)).push([e.i,".kbnOverlayMountWrapper{display:flex;flex-direction:column;height:100%;overflow:hidden}",""]),e.exports=t},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(67),i=a(4);t.default=function(e){void 0===e&&(e={});var t=i.useState(e),a=t[0],r=t[1],s=i.useMemo((function(){return{set:function(e,t){r((function(a){var i;return n.__assign(n.__assign({},a),((i={})[e]=t,i))}))},setAll:function(e){r(e)},remove:function(e){r((function(t){var a=t,i=e;return a[i],n.__rest(a,["symbol"==typeof i?i:i+""])}))},reset:function(){return r(e)}}}),[r]),o=n.__assign({get:i.useCallback((function(e){return a[e]}),[a])},s);return[a,o]}},function(e,t,a){e.exports=function e(t,a,n){function i(s,o){if(!a[s]){if(!t[s]){if(r)return r(s,!0);throw new Error("Cannot find module '"+s+"'")}var l=a[s]={exports:{}};t[s][0].call(l.exports,(function(e){return i(t[s][1][e]||e)}),l,l.exports,e,t,a,n)}return a[s].exports}for(var r=!1,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(e,t,a){(function(n,i,r,s,o,l,c,u,d){"use strict";function p(e,t){return function(e,t){var a;if(void 0===(a="passthrough"!==t.algorithm?y.createHash(t.algorithm):new f).write&&(a.write=a.update,a.end=a.update),b(t,a).dispatch(e),a.update||a.end(""),a.digest)return a.digest("buffer"===t.encoding?void 0:t.encoding);var n=a.read();return"buffer"===t.encoding?n:n.toString(t.encoding)}(e,t=m(e,t))}function m(e,t){if((t=t||{}).algorithm=t.algorithm||"sha1",t.encoding=t.encoding||"hex",t.excludeValues=!!t.excludeValues,t.algorithm=t.algorithm.toLowerCase(),t.encoding=t.encoding.toLowerCase(),t.ignoreUnknown=!0===t.ignoreUnknown,t.respectType=!1!==t.respectType,t.respectFunctionNames=!1!==t.respectFunctionNames,t.respectFunctionProperties=!1!==t.respectFunctionProperties,t.unorderedArrays=!0===t.unorderedArrays,t.unorderedSets=!1!==t.unorderedSets,t.unorderedObjects=!1!==t.unorderedObjects,t.replacer=t.replacer||void 0,t.excludeKeys=t.excludeKeys||void 0,void 0===e)throw new Error("Object argument required.");for(var a=0;a<h.length;++a)h[a].toLowerCase()===t.algorithm.toLowerCase()&&(t.algorithm=h[a]);if(-1===h.indexOf(t.algorithm))throw new Error('Algorithm "'+t.algorithm+'"  not supported. supported values: '+h.join(", "));if(-1===E.indexOf(t.encoding)&&"passthrough"!==t.algorithm)throw new Error('Encoding "'+t.encoding+'"  not supported. supported values: '+E.join(", "));return t}function g(e){return"function"==typeof e&&null!=/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(e))}function b(e,t,a){a=a||[];var n=function(e){return t.update?t.update(e,"utf8"):t.write(e,"utf8")};return{dispatch:function(t){e.replacer&&(t=e.replacer(t));var a=typeof t;return null===t&&(a="null"),this["_"+a](t)},_object:function(t){var i=Object.prototype.toString.call(t),s=/\[object (.*)\]/i.exec(i);s=(s=s?s[1]:"unknown:["+i+"]").toLowerCase();var o;if((o=a.indexOf(t))>=0)return this.dispatch("[CIRCULAR:"+o+"]");if(a.push(t),void 0!==r&&r.isBuffer&&r.isBuffer(t))return n("buffer:"),n(t);if("object"===s||"function"===s){var l=Object.keys(t);e.unorderedObjects&&(l=l.sort()),!1===e.respectType||g(t)||l.splice(0,0,"prototype","__proto__","constructor"),e.excludeKeys&&(l=l.filter((function(t){return!e.excludeKeys(t)}))),n("object:"+l.length+":");var c=this;return l.forEach((function(a){c.dispatch(a),n(":"),e.excludeValues||c.dispatch(t[a]),n(",")}))}if(!this["_"+s]){if(e.ignoreUnknown)return n("["+s+"]");throw new Error('Unknown object type "'+s+'"')}this["_"+s](t)},_array:function(t,i){i=void 0!==i?i:!1!==e.unorderedArrays;var r=this;if(n("array:"+t.length+":"),!i||t.length<=1)return t.forEach((function(e){return r.dispatch(e)}));var s=[],o=t.map((function(t){var n=new f,i=a.slice();return b(e,n,i).dispatch(t),s=s.concat(i.slice(a.length)),n.read().toString()}));return a=a.concat(s),o.sort(),this._array(o,!1)},_date:function(e){return n("date:"+e.toJSON())},_symbol:function(e){return n("symbol:"+e.toString())},_error:function(e){return n("error:"+e.toString())},_boolean:function(e){return n("bool:"+e.toString())},_string:function(e){n("string:"+e.length+":"),n(e.toString())},_function:function(t){n("fn:"),g(t)?this.dispatch("[native]"):this.dispatch(t.toString()),!1!==e.respectFunctionNames&&this.dispatch("function-name:"+String(t.name)),e.respectFunctionProperties&&this._object(t)},_number:function(e){return n("number:"+e.toString())},_xml:function(e){return n("xml:"+e.toString())},_null:function(){return n("Null")},_undefined:function(){return n("Undefined")},_regexp:function(e){return n("regex:"+e.toString())},_uint8array:function(e){return n("uint8array:"),this.dispatch(Array.prototype.slice.call(e))},_uint8clampedarray:function(e){return n("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(e))},_int8array:function(e){return n("uint8array:"),this.dispatch(Array.prototype.slice.call(e))},_uint16array:function(e){return n("uint16array:"),this.dispatch(Array.prototype.slice.call(e))},_int16array:function(e){return n("uint16array:"),this.dispatch(Array.prototype.slice.call(e))},_uint32array:function(e){return n("uint32array:"),this.dispatch(Array.prototype.slice.call(e))},_int32array:function(e){return n("uint32array:"),this.dispatch(Array.prototype.slice.call(e))},_float32array:function(e){return n("float32array:"),this.dispatch(Array.prototype.slice.call(e))},_float64array:function(e){return n("float64array:"),this.dispatch(Array.prototype.slice.call(e))},_arraybuffer:function(e){return n("arraybuffer:"),this.dispatch(new Uint8Array(e))},_url:function(e){return n("url:"+e.toString())},_map:function(t){n("map:");var a=Array.from(t);return this._array(a,!1!==e.unorderedSets)},_set:function(t){n("set:");var a=Array.from(t);return this._array(a,!1!==e.unorderedSets)},_blob:function(){if(e.ignoreUnknown)return n("[blob]");throw Error('Hashing Blob objects is currently not supported\n(see https://github.com/puleos/object-hash/issues/26)\nUse "options.replacer" or "options.ignoreUnknown"\n')},_domwindow:function(){return n("domwindow")},_process:function(){return n("process")},_timer:function(){return n("timer")},_pipe:function(){return n("pipe")},_tcp:function(){return n("tcp")},_udp:function(){return n("udp")},_tty:function(){return n("tty")},_statwatcher:function(){return n("statwatcher")},_securecontext:function(){return n("securecontext")},_connection:function(){return n("connection")},_zlib:function(){return n("zlib")},_context:function(){return n("context")},_nodescript:function(){return n("nodescript")},_httpparser:function(){return n("httpparser")},_dataview:function(){return n("dataview")},_signal:function(){return n("signal")},_fsevent:function(){return n("fsevent")},_tlswrap:function(){return n("tlswrap")}}}function f(){return{buf:"",write:function(e){this.buf+=e},end:function(e){this.buf+=e},read:function(){return this.buf}}}var y=e("crypto");(a=t.exports=p).sha1=function(e){return p(e)},a.keys=function(e){return p(e,{excludeValues:!0,algorithm:"sha1",encoding:"hex"})},a.MD5=function(e){return p(e,{algorithm:"md5",encoding:"hex"})},a.keysMD5=function(e){return p(e,{algorithm:"md5",encoding:"hex",excludeValues:!0})};var h=y.getHashes?y.getHashes().slice():["sha1","md5"];h.push("passthrough");var E=["buffer","hex","binary","base64"];a.writeToStream=function(e,t,a){return void 0===a&&(a=t,t={}),b(t=m(e,t),a).dispatch(e)}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/fake_e8180ef5.js","/")},{buffer:3,crypto:5,lYpoI2:10}],2:[function(e,t,a){(function(e,t,n,i,r,s,o,l,c){!function(e){"use strict";function t(e){var t=e.charCodeAt(0);return t===n||t===l?62:t===i||t===c?63:t<r?-1:t<r+10?t-r+26+26:t<o+26?t-o:t<s+26?t-s+26:void 0}var a="undefined"!=typeof Uint8Array?Uint8Array:Array,n="+".charCodeAt(0),i="/".charCodeAt(0),r="0".charCodeAt(0),s="a".charCodeAt(0),o="A".charCodeAt(0),l="-".charCodeAt(0),c="_".charCodeAt(0);e.toByteArray=function(e){function n(e){c[d++]=e}var i,r,s,o,l,c;if(e.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var u=e.length;l="="===e.charAt(u-2)?2:"="===e.charAt(u-1)?1:0,c=new a(3*e.length/4-l),s=l>0?e.length-4:e.length;var d=0;for(i=0,r=0;i<s;i+=4,r+=3)n((16711680&(o=t(e.charAt(i))<<18|t(e.charAt(i+1))<<12|t(e.charAt(i+2))<<6|t(e.charAt(i+3))))>>16),n((65280&o)>>8),n(255&o);return 2===l?n(255&(o=t(e.charAt(i))<<2|t(e.charAt(i+1))>>4)):1===l&&(n((o=t(e.charAt(i))<<10|t(e.charAt(i+1))<<4|t(e.charAt(i+2))>>2)>>8&255),n(255&o)),c},e.fromByteArray=function(e){function t(e){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e)}function a(e){return t(e>>18&63)+t(e>>12&63)+t(e>>6&63)+t(63&e)}var n,i,r,s=e.length%3,o="";for(n=0,r=e.length-s;n<r;n+=3)o+=a(i=(e[n]<<16)+(e[n+1]<<8)+e[n+2]);switch(s){case 1:o+=t((i=e[e.length-1])>>2),o+=t(i<<4&63),o+="==";break;case 2:o+=t((i=(e[e.length-2]<<8)+e[e.length-1])>>10),o+=t(i>>4&63),o+=t(i<<2&63),o+="="}return o}}(void 0===a?this.base64js={}:a)}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/base64-js/lib/b64.js","/node_modules/gulp-browserify/node_modules/base64-js/lib")},{buffer:3,lYpoI2:10}],3:[function(e,t,a){(function(t,n,i,r,s,o,l,c,u){function i(e,t,a){if(!(this instanceof i))return new i(e,t,a);var n,r,s,o=typeof e;if("base64"===t&&"string"===o)for(e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e);e.length%4!=0;)e+="=";if("number"===o)n=M(e);else if("string"===o)n=i.byteLength(e,t);else{if("object"!==o)throw new Error("First argument needs to be a number, array or string.");n=M(e.length)}if(i._useTypedArrays?r=i._augment(new Uint8Array(n)):((r=this).length=n,r._isBuffer=!0),i._useTypedArrays&&"number"==typeof e.byteLength)r._set(e);else if(function(e){return F(e)||i.isBuffer(e)||e&&"object"==typeof e&&"number"==typeof e.length}(e))for(s=0;s<n;s++)i.isBuffer(e)?r[s]=e.readUInt8(s):r[s]=e[s];else if("string"===o)r.write(e,0,t);else if("number"===o&&!i._useTypedArrays&&!a)for(s=0;s<n;s++)r[s]=0;return r}function d(e,t,a,n){a=Number(a)||0;var r=e.length-a;n?(n=Number(n))>r&&(n=r):n=r;var s=t.length;q(s%2==0,"Invalid hex string"),n>s/2&&(n=s/2);for(var o=0;o<n;o++){var l=parseInt(t.substr(2*o,2),16);q(!isNaN(l),"Invalid hex string"),e[a+o]=l}return i._charsWritten=2*o,o}function p(e,t,a,n){return i._charsWritten=N(A(t),e,a,n)}function m(e,t,a,n){return i._charsWritten=N(function(e){for(var t=[],a=0;a<e.length;a++)t.push(255&e.charCodeAt(a));return t}(t),e,a,n)}function g(e,t,a,n){return i._charsWritten=N(_(t),e,a,n)}function b(e,t,a,n){return i._charsWritten=N(function(e){for(var t,a,n,i=[],r=0;r<e.length;r++)a=(t=e.charCodeAt(r))>>8,n=t%256,i.push(n),i.push(a);return i}(t),e,a,n)}function f(e,t,a){var n="";a=Math.min(e.length,a);for(var i=t;i<a;i++)n+=String.fromCharCode(e[i]);return n}function y(e,t,a,n){n||(q("boolean"==typeof a,"missing or invalid endian"),q(null!=t,"missing offset"),q(t+1<e.length,"Trying to read beyond buffer length"));var i,r=e.length;if(!(t>=r))return a?(i=e[t],t+1<r&&(i|=e[t+1]<<8)):(i=e[t]<<8,t+1<r&&(i|=e[t+1])),i}function h(e,t,a,n){n||(q("boolean"==typeof a,"missing or invalid endian"),q(null!=t,"missing offset"),q(t+3<e.length,"Trying to read beyond buffer length"));var i,r=e.length;if(!(t>=r))return a?(t+2<r&&(i=e[t+2]<<16),t+1<r&&(i|=e[t+1]<<8),i|=e[t],t+3<r&&(i+=e[t+3]<<24>>>0)):(t+1<r&&(i=e[t+1]<<16),t+2<r&&(i|=e[t+2]<<8),t+3<r&&(i|=e[t+3]),i+=e[t]<<24>>>0),i}function E(e,t,a,n){if(n||(q("boolean"==typeof a,"missing or invalid endian"),q(null!=t,"missing offset"),q(t+1<e.length,"Trying to read beyond buffer length")),!(t>=e.length)){var i=y(e,t,a,!0);return 32768&i?-1*(65535-i+1):i}}function v(e,t,a,n){if(n||(q("boolean"==typeof a,"missing or invalid endian"),q(null!=t,"missing offset"),q(t+3<e.length,"Trying to read beyond buffer length")),!(t>=e.length)){var i=h(e,t,a,!0);return 2147483648&i?-1*(4294967295-i+1):i}}function x(e,t,a,n){return n||(q("boolean"==typeof a,"missing or invalid endian"),q(t+3<e.length,"Trying to read beyond buffer length")),$.read(e,t,a,23,4)}function k(e,t,a,n){return n||(q("boolean"==typeof a,"missing or invalid endian"),q(t+7<e.length,"Trying to read beyond buffer length")),$.read(e,t,a,52,8)}function S(e,t,a,n,i){i||(q(null!=t,"missing value"),q("boolean"==typeof n,"missing or invalid endian"),q(null!=a,"missing offset"),q(a+1<e.length,"trying to write beyond buffer length"),P(t,65535));var r=e.length;if(!(a>=r))for(var s=0,o=Math.min(r-a,2);s<o;s++)e[a+s]=(t&255<<8*(n?s:1-s))>>>8*(n?s:1-s)}function j(e,t,a,n,i){i||(q(null!=t,"missing value"),q("boolean"==typeof n,"missing or invalid endian"),q(null!=a,"missing offset"),q(a+3<e.length,"trying to write beyond buffer length"),P(t,4294967295));var r=e.length;if(!(a>=r))for(var s=0,o=Math.min(r-a,4);s<o;s++)e[a+s]=t>>>8*(n?s:3-s)&255}function O(e,t,a,n,i){i||(q(null!=t,"missing value"),q("boolean"==typeof n,"missing or invalid endian"),q(null!=a,"missing offset"),q(a+1<e.length,"Trying to write beyond buffer length"),L(t,32767,-32768)),a>=e.length||S(e,t>=0?t:65535+t+1,a,n,i)}function w(e,t,a,n,i){i||(q(null!=t,"missing value"),q("boolean"==typeof n,"missing or invalid endian"),q(null!=a,"missing offset"),q(a+3<e.length,"Trying to write beyond buffer length"),L(t,2147483647,-2147483648)),a>=e.length||j(e,t>=0?t:4294967295+t+1,a,n,i)}function T(e,t,a,n,i){i||(q(null!=t,"missing value"),q("boolean"==typeof n,"missing or invalid endian"),q(null!=a,"missing offset"),q(a+3<e.length,"Trying to write beyond buffer length"),B(t,34028234663852886e22,-34028234663852886e22)),a>=e.length||$.write(e,t,a,n,23,4)}function I(e,t,a,n,i){i||(q(null!=t,"missing value"),q("boolean"==typeof n,"missing or invalid endian"),q(null!=a,"missing offset"),q(a+7<e.length,"Trying to write beyond buffer length"),B(t,17976931348623157e292,-17976931348623157e292)),a>=e.length||$.write(e,t,a,n,52,8)}function C(e,t,a){return"number"!=typeof e?a:(e=~~e)>=t?t:e>=0||(e+=t)>=0?e:0}function M(e){return(e=~~Math.ceil(+e))<0?0:e}function F(e){return(Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)})(e)}function D(e){return e<16?"0"+e.toString(16):e.toString(16)}function A(e){for(var t=[],a=0;a<e.length;a++){var n=e.charCodeAt(a);if(n<=127)t.push(e.charCodeAt(a));else{var i=a;n>=55296&&n<=57343&&a++;for(var r=encodeURIComponent(e.slice(i,a+1)).substr(1).split("%"),s=0;s<r.length;s++)t.push(parseInt(r[s],16))}}return t}function _(e){return z.toByteArray(e)}function N(e,t,a,n){for(var i=0;i<n&&!(i+a>=t.length||i>=e.length);i++)t[i+a]=e[i];return i}function R(e){try{return decodeURIComponent(e)}catch(e){return String.fromCharCode(65533)}}function P(e,t){q("number"==typeof e,"cannot write a non-number as a number"),q(e>=0,"specified a negative value for writing an unsigned value"),q(e<=t,"value is larger than maximum value for type"),q(Math.floor(e)===e,"value has a fractional component")}function L(e,t,a){q("number"==typeof e,"cannot write a non-number as a number"),q(e<=t,"value larger than maximum allowed value"),q(e>=a,"value smaller than minimum allowed value"),q(Math.floor(e)===e,"value has a fractional component")}function B(e,t,a){q("number"==typeof e,"cannot write a non-number as a number"),q(e<=t,"value larger than maximum allowed value"),q(e>=a,"value smaller than minimum allowed value")}function q(e,t){if(!e)throw new Error(t||"Failed assertion")}var z=e("base64-js"),$=e("ieee754");a.Buffer=i,a.SlowBuffer=i,a.INSPECT_MAX_BYTES=50,i.poolSize=8192,i._useTypedArrays=function(){try{var e=new ArrayBuffer(0),t=new Uint8Array(e);return t.foo=function(){return 42},42===t.foo()&&"function"==typeof t.subarray}catch(e){return!1}}(),i.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},i.isBuffer=function(e){return!(null==e||!e._isBuffer)},i.byteLength=function(e,t){var a;switch(e+="",t||"utf8"){case"hex":a=e.length/2;break;case"utf8":case"utf-8":a=A(e).length;break;case"ascii":case"binary":case"raw":a=e.length;break;case"base64":a=_(e).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":a=2*e.length;break;default:throw new Error("Unknown encoding")}return a},i.concat=function(e,t){if(q(F(e),"Usage: Buffer.concat(list, [totalLength])\nlist should be an Array."),0===e.length)return new i(0);if(1===e.length)return e[0];var a;if("number"!=typeof t)for(t=0,a=0;a<e.length;a++)t+=e[a].length;var n=new i(t),r=0;for(a=0;a<e.length;a++){var s=e[a];s.copy(n,r),r+=s.length}return n},i.prototype.write=function(e,t,a,n){if(isFinite(t))isFinite(a)||(n=a,a=void 0);else{var i=n;n=t,t=a,a=i}t=Number(t)||0;var r,s=this.length-t;switch(a?(a=Number(a))>s&&(a=s):a=s,n=String(n||"utf8").toLowerCase()){case"hex":r=d(this,e,t,a);break;case"utf8":case"utf-8":r=p(this,e,t,a);break;case"ascii":r=m(this,e,t,a);break;case"binary":r=function(e,t,a,n){return m(e,t,a,n)}(this,e,t,a);break;case"base64":r=g(this,e,t,a);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":r=b(this,e,t,a);break;default:throw new Error("Unknown encoding")}return r},i.prototype.toString=function(e,t,a){var n,i=this;if(e=String(e||"utf8").toLowerCase(),t=Number(t)||0,(a=void 0!==a?Number(a):a=i.length)===t)return"";switch(e){case"hex":n=function(e,t,a){var n=e.length;(!t||t<0)&&(t=0),(!a||a<0||a>n)&&(a=n);for(var i="",r=t;r<a;r++)i+=D(e[r]);return i}(i,t,a);break;case"utf8":case"utf-8":n=function(e,t,a){var n="",i="";a=Math.min(e.length,a);for(var r=t;r<a;r++)e[r]<=127?(n+=R(i)+String.fromCharCode(e[r]),i=""):i+="%"+e[r].toString(16);return n+R(i)}(i,t,a);break;case"ascii":n=f(i,t,a);break;case"binary":n=function(e,t,a){return f(e,t,a)}(i,t,a);break;case"base64":n=function(e,t,a){return 0===t&&a===e.length?z.fromByteArray(e):z.fromByteArray(e.slice(t,a))}(i,t,a);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":n=function(e,t,a){for(var n=e.slice(t,a),i="",r=0;r<n.length;r+=2)i+=String.fromCharCode(n[r]+256*n[r+1]);return i}(i,t,a);break;default:throw new Error("Unknown encoding")}return n},i.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},i.prototype.copy=function(e,t,a,n){var r=this;if(a||(a=0),n||0===n||(n=this.length),t||(t=0),n!==a&&0!==e.length&&0!==r.length){q(n>=a,"sourceEnd < sourceStart"),q(t>=0&&t<e.length,"targetStart out of bounds"),q(a>=0&&a<r.length,"sourceStart out of bounds"),q(n>=0&&n<=r.length,"sourceEnd out of bounds"),n>this.length&&(n=this.length),e.length-t<n-a&&(n=e.length-t+a);var s=n-a;if(s<100||!i._useTypedArrays)for(var o=0;o<s;o++)e[o+t]=this[o+a];else e._set(this.subarray(a,a+s),t)}},i.prototype.slice=function(e,t){var a=this.length;if(e=C(e,a,0),t=C(t,a,a),i._useTypedArrays)return i._augment(this.subarray(e,t));for(var n=t-e,r=new i(n,void 0,!0),s=0;s<n;s++)r[s]=this[s+e];return r},i.prototype.get=function(e){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(e)},i.prototype.set=function(e,t){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(e,t)},i.prototype.readUInt8=function(e,t){if(t||(q(null!=e,"missing offset"),q(e<this.length,"Trying to read beyond buffer length")),!(e>=this.length))return this[e]},i.prototype.readUInt16LE=function(e,t){return y(this,e,!0,t)},i.prototype.readUInt16BE=function(e,t){return y(this,e,!1,t)},i.prototype.readUInt32LE=function(e,t){return h(this,e,!0,t)},i.prototype.readUInt32BE=function(e,t){return h(this,e,!1,t)},i.prototype.readInt8=function(e,t){if(t||(q(null!=e,"missing offset"),q(e<this.length,"Trying to read beyond buffer length")),!(e>=this.length))return 128&this[e]?-1*(255-this[e]+1):this[e]},i.prototype.readInt16LE=function(e,t){return E(this,e,!0,t)},i.prototype.readInt16BE=function(e,t){return E(this,e,!1,t)},i.prototype.readInt32LE=function(e,t){return v(this,e,!0,t)},i.prototype.readInt32BE=function(e,t){return v(this,e,!1,t)},i.prototype.readFloatLE=function(e,t){return x(this,e,!0,t)},i.prototype.readFloatBE=function(e,t){return x(this,e,!1,t)},i.prototype.readDoubleLE=function(e,t){return k(this,e,!0,t)},i.prototype.readDoubleBE=function(e,t){return k(this,e,!1,t)},i.prototype.writeUInt8=function(e,t,a){a||(q(null!=e,"missing value"),q(null!=t,"missing offset"),q(t<this.length,"trying to write beyond buffer length"),P(e,255)),t>=this.length||(this[t]=e)},i.prototype.writeUInt16LE=function(e,t,a){S(this,e,t,!0,a)},i.prototype.writeUInt16BE=function(e,t,a){S(this,e,t,!1,a)},i.prototype.writeUInt32LE=function(e,t,a){j(this,e,t,!0,a)},i.prototype.writeUInt32BE=function(e,t,a){j(this,e,t,!1,a)},i.prototype.writeInt8=function(e,t,a){a||(q(null!=e,"missing value"),q(null!=t,"missing offset"),q(t<this.length,"Trying to write beyond buffer length"),L(e,127,-128)),t>=this.length||(e>=0?this.writeUInt8(e,t,a):this.writeUInt8(255+e+1,t,a))},i.prototype.writeInt16LE=function(e,t,a){O(this,e,t,!0,a)},i.prototype.writeInt16BE=function(e,t,a){O(this,e,t,!1,a)},i.prototype.writeInt32LE=function(e,t,a){w(this,e,t,!0,a)},i.prototype.writeInt32BE=function(e,t,a){w(this,e,t,!1,a)},i.prototype.writeFloatLE=function(e,t,a){T(this,e,t,!0,a)},i.prototype.writeFloatBE=function(e,t,a){T(this,e,t,!1,a)},i.prototype.writeDoubleLE=function(e,t,a){I(this,e,t,!0,a)},i.prototype.writeDoubleBE=function(e,t,a){I(this,e,t,!1,a)},i.prototype.fill=function(e,t,a){if(e||(e=0),t||(t=0),a||(a=this.length),"string"==typeof e&&(e=e.charCodeAt(0)),q("number"==typeof e&&!isNaN(e),"value is not a number"),q(a>=t,"end < start"),a!==t&&0!==this.length){q(t>=0&&t<this.length,"start out of bounds"),q(a>=0&&a<=this.length,"end out of bounds");for(var n=t;n<a;n++)this[n]=e}},i.prototype.inspect=function(){for(var e=[],t=this.length,n=0;n<t;n++)if(e[n]=D(this[n]),n===a.INSPECT_MAX_BYTES){e[n+1]="...";break}return"<Buffer "+e.join(" ")+">"},i.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(i._useTypedArrays)return new i(this).buffer;for(var e=new Uint8Array(this.length),t=0,a=e.length;t<a;t+=1)e[t]=this[t];return e.buffer}throw new Error("Buffer.toArrayBuffer not supported in this browser")};var V=i.prototype;i._augment=function(e){return e._isBuffer=!0,e._get=e.get,e._set=e.set,e.get=V.get,e.set=V.set,e.write=V.write,e.toString=V.toString,e.toLocaleString=V.toString,e.toJSON=V.toJSON,e.copy=V.copy,e.slice=V.slice,e.readUInt8=V.readUInt8,e.readUInt16LE=V.readUInt16LE,e.readUInt16BE=V.readUInt16BE,e.readUInt32LE=V.readUInt32LE,e.readUInt32BE=V.readUInt32BE,e.readInt8=V.readInt8,e.readInt16LE=V.readInt16LE,e.readInt16BE=V.readInt16BE,e.readInt32LE=V.readInt32LE,e.readInt32BE=V.readInt32BE,e.readFloatLE=V.readFloatLE,e.readFloatBE=V.readFloatBE,e.readDoubleLE=V.readDoubleLE,e.readDoubleBE=V.readDoubleBE,e.writeUInt8=V.writeUInt8,e.writeUInt16LE=V.writeUInt16LE,e.writeUInt16BE=V.writeUInt16BE,e.writeUInt32LE=V.writeUInt32LE,e.writeUInt32BE=V.writeUInt32BE,e.writeInt8=V.writeInt8,e.writeInt16LE=V.writeInt16LE,e.writeInt16BE=V.writeInt16BE,e.writeInt32LE=V.writeInt32LE,e.writeInt32BE=V.writeInt32BE,e.writeFloatLE=V.writeFloatLE,e.writeFloatBE=V.writeFloatBE,e.writeDoubleLE=V.writeDoubleLE,e.writeDoubleBE=V.writeDoubleBE,e.fill=V.fill,e.inspect=V.inspect,e.toArrayBuffer=V.toArrayBuffer,e}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/buffer/index.js","/node_modules/gulp-browserify/node_modules/buffer")},{"base64-js":2,buffer:3,ieee754:11,lYpoI2:10}],4:[function(e,t,a){(function(a,n,i,r,s,o,l,c,u){i=e("buffer").Buffer;var d=4,p=new i(d);p.fill(0);var m=8;t.exports={hash:function(e,t,a,n){return i.isBuffer(e)||(e=new i(e)),function(e,t,a){for(var n=new i(t),r=a?n.writeInt32BE:n.writeInt32LE,s=0;s<e.length;s++)r.call(n,e[s],4*s,!0);return n}(t(function(e,t){if(e.length%d!=0){var a=e.length+(d-e.length%d);e=i.concat([e,p],a)}for(var n=[],r=t?e.readInt32BE:e.readInt32LE,s=0;s<e.length;s+=d)n.push(r.call(e,s));return n}(e,n),e.length*m),a,n)}}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/helpers.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:10}],5:[function(e,t,a){(function(t,n,i,r,s,o,l,c,u){function d(e,t){var a=f[e=e||"sha1"],n=[];return a||p("algorithm:",e,"is not yet supported"),{update:function(e){return i.isBuffer(e)||(e=new i(e)),n.push(e),e.length,this},digest:function(e){var r=i.concat(n),s=t?function(e,t,a){i.isBuffer(t)||(t=new i(t)),i.isBuffer(a)||(a=new i(a)),t.length>y?t=e(t):t.length<y&&(t=i.concat([t,h],y));for(var n=new i(y),r=new i(y),s=0;s<y;s++)n[s]=54^t[s],r[s]=92^t[s];var o=e(i.concat([n,a]));return e(i.concat([r,o]))}(a,t,r):a(r);return n=null,e?s.toString(e):s}}}function p(){var e=[].slice.call(arguments).join(" ");throw new Error([e,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join("\n"))}i=e("buffer").Buffer;var m=e("./sha"),g=e("./sha256"),b=e("./rng"),f={sha1:m,sha256:g,md5:e("./md5")},y=64,h=new i(y);h.fill(0),a.createHash=function(e){return d(e)},a.createHmac=function(e,t){return d(e,t)},a.randomBytes=function(e,t){if(!t||!t.call)return new i(b(e));try{t.call(this,void 0,new i(b(e)))}catch(e){t(e)}},function(e,t){for(var a in e)t(e[a],a)}(["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"],(function(e){a[e]=function(){p("sorry,",e,"is not implemented yet")}}))}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/index.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./md5":6,"./rng":7,"./sha":8,"./sha256":9,buffer:3,lYpoI2:10}],6:[function(e,t,a){(function(a,n,i,r,s,o,l,c,u){function d(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var a=1732584193,n=-271733879,i=-1732584194,r=271733878,s=0;s<e.length;s+=16){var o=a,l=n,c=i,u=r;a=m(a,n,i,r,e[s+0],7,-680876936),r=m(r,a,n,i,e[s+1],12,-389564586),i=m(i,r,a,n,e[s+2],17,606105819),n=m(n,i,r,a,e[s+3],22,-1044525330),a=m(a,n,i,r,e[s+4],7,-176418897),r=m(r,a,n,i,e[s+5],12,1200080426),i=m(i,r,a,n,e[s+6],17,-1473231341),n=m(n,i,r,a,e[s+7],22,-45705983),a=m(a,n,i,r,e[s+8],7,1770035416),r=m(r,a,n,i,e[s+9],12,-1958414417),i=m(i,r,a,n,e[s+10],17,-42063),n=m(n,i,r,a,e[s+11],22,-1990404162),a=m(a,n,i,r,e[s+12],7,1804603682),r=m(r,a,n,i,e[s+13],12,-40341101),i=m(i,r,a,n,e[s+14],17,-1502002290),a=g(a,n=m(n,i,r,a,e[s+15],22,1236535329),i,r,e[s+1],5,-165796510),r=g(r,a,n,i,e[s+6],9,-1069501632),i=g(i,r,a,n,e[s+11],14,643717713),n=g(n,i,r,a,e[s+0],20,-373897302),a=g(a,n,i,r,e[s+5],5,-701558691),r=g(r,a,n,i,e[s+10],9,38016083),i=g(i,r,a,n,e[s+15],14,-660478335),n=g(n,i,r,a,e[s+4],20,-405537848),a=g(a,n,i,r,e[s+9],5,568446438),r=g(r,a,n,i,e[s+14],9,-1019803690),i=g(i,r,a,n,e[s+3],14,-187363961),n=g(n,i,r,a,e[s+8],20,1163531501),a=g(a,n,i,r,e[s+13],5,-1444681467),r=g(r,a,n,i,e[s+2],9,-51403784),i=g(i,r,a,n,e[s+7],14,1735328473),a=b(a,n=g(n,i,r,a,e[s+12],20,-1926607734),i,r,e[s+5],4,-378558),r=b(r,a,n,i,e[s+8],11,-2022574463),i=b(i,r,a,n,e[s+11],16,1839030562),n=b(n,i,r,a,e[s+14],23,-35309556),a=b(a,n,i,r,e[s+1],4,-1530992060),r=b(r,a,n,i,e[s+4],11,1272893353),i=b(i,r,a,n,e[s+7],16,-155497632),n=b(n,i,r,a,e[s+10],23,-1094730640),a=b(a,n,i,r,e[s+13],4,681279174),r=b(r,a,n,i,e[s+0],11,-358537222),i=b(i,r,a,n,e[s+3],16,-722521979),n=b(n,i,r,a,e[s+6],23,76029189),a=b(a,n,i,r,e[s+9],4,-640364487),r=b(r,a,n,i,e[s+12],11,-421815835),i=b(i,r,a,n,e[s+15],16,530742520),a=f(a,n=b(n,i,r,a,e[s+2],23,-995338651),i,r,e[s+0],6,-198630844),r=f(r,a,n,i,e[s+7],10,1126891415),i=f(i,r,a,n,e[s+14],15,-1416354905),n=f(n,i,r,a,e[s+5],21,-57434055),a=f(a,n,i,r,e[s+12],6,1700485571),r=f(r,a,n,i,e[s+3],10,-1894986606),i=f(i,r,a,n,e[s+10],15,-1051523),n=f(n,i,r,a,e[s+1],21,-2054922799),a=f(a,n,i,r,e[s+8],6,1873313359),r=f(r,a,n,i,e[s+15],10,-30611744),i=f(i,r,a,n,e[s+6],15,-1560198380),n=f(n,i,r,a,e[s+13],21,1309151649),a=f(a,n,i,r,e[s+4],6,-145523070),r=f(r,a,n,i,e[s+11],10,-1120210379),i=f(i,r,a,n,e[s+2],15,718787259),n=f(n,i,r,a,e[s+9],21,-343485551),a=y(a,o),n=y(n,l),i=y(i,c),r=y(r,u)}return Array(a,n,i,r)}function p(e,t,a,n,i,r){return y(function(e,t){return e<<t|e>>>32-t}(y(y(t,e),y(n,r)),i),a)}function m(e,t,a,n,i,r,s){return p(t&a|~t&n,e,t,i,r,s)}function g(e,t,a,n,i,r,s){return p(t&n|a&~n,e,t,i,r,s)}function b(e,t,a,n,i,r,s){return p(t^a^n,e,t,i,r,s)}function f(e,t,a,n,i,r,s){return p(a^(t|~n),e,t,i,r,s)}function y(e,t){var a=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(a>>16)<<16|65535&a}var h=e("./helpers");t.exports=function(e){return h.hash(e,d,16)}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/md5.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:10}],7:[function(e,t,a){(function(e,a,n,i,r,s,o,l,c){!function(){var e,a;e=function(e){for(var t,a=new Array(e),n=0;n<e;n++)0==(3&n)&&(t=4294967296*Math.random()),a[n]=t>>>((3&n)<<3)&255;return a},this.crypto&&crypto.getRandomValues&&(a=function(e){var t=new Uint8Array(e);return crypto.getRandomValues(t),t}),t.exports=a||e}()}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/rng.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:10}],8:[function(e,t,a){(function(a,n,i,r,s,o,l,c,u){function d(e,t){e[t>>5]|=128<<24-t%32,e[15+(t+64>>9<<4)]=t;for(var a=Array(80),n=1732584193,i=-271733879,r=-1732584194,s=271733878,o=-1009589776,l=0;l<e.length;l+=16){for(var c=n,u=i,d=r,f=s,y=o,h=0;h<80;h++){a[h]=h<16?e[l+h]:b(a[h-3]^a[h-8]^a[h-14]^a[h-16],1);var E=g(g(b(n,5),p(h,i,r,s)),g(g(o,a[h]),m(h)));o=s,s=r,r=b(i,30),i=n,n=E}n=g(n,c),i=g(i,u),r=g(r,d),s=g(s,f),o=g(o,y)}return Array(n,i,r,s,o)}function p(e,t,a,n){return e<20?t&a|~t&n:e<40?t^a^n:e<60?t&a|t&n|a&n:t^a^n}function m(e){return e<20?1518500249:e<40?1859775393:e<60?-1894007588:-899497514}function g(e,t){var a=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(a>>16)<<16|65535&a}function b(e,t){return e<<t|e>>>32-t}var f=e("./helpers");t.exports=function(e){return f.hash(e,d,20,!0)}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:10}],9:[function(e,t,a){(function(a,n,i,r,s,o,l,c,u){var d=e("./helpers"),p=function(e,t){var a=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(a>>16)<<16|65535&a},m=function(e,t){return e>>>t|e<<32-t},g=function(e,t){return e>>>t},b=function(e,t,a){return e&t^~e&a},f=function(e,t,a){return e&t^e&a^t&a},y=function(e){return m(e,2)^m(e,13)^m(e,22)},h=function(e){return m(e,6)^m(e,11)^m(e,25)},E=function(e){return m(e,7)^m(e,18)^g(e,3)},v=function(e){return m(e,17)^m(e,19)^g(e,10)},x=function(e,t){var a,n,i,r,s,o,l,c,u,d,m=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),g=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),x=new Array(64);e[t>>5]|=128<<24-t%32,e[15+(t+64>>9<<4)]=t;for(var k=0;k<e.length;k+=16){a=g[0],n=g[1],i=g[2],r=g[3],s=g[4],o=g[5],l=g[6],c=g[7];for(var S=0;S<64;S++)x[S]=S<16?e[S+k]:p(p(p(v(x[S-2]),x[S-7]),E(x[S-15])),x[S-16]),u=p(p(p(p(c,h(s)),b(s,o,l)),m[S]),x[S]),d=p(y(a),f(a,n,i)),c=l,l=o,o=s,s=p(r,u),r=i,i=n,n=a,a=p(u,d);g[0]=p(a,g[0]),g[1]=p(n,g[1]),g[2]=p(i,g[2]),g[3]=p(r,g[3]),g[4]=p(s,g[4]),g[5]=p(o,g[5]),g[6]=p(l,g[6]),g[7]=p(c,g[7])}return g};t.exports=function(e){return d.hash(e,x,32,!0)}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha256.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:10}],10:[function(e,t,a){(function(e,a,n,i,r,s,o,l,c){function u(){}(e=t.exports={}).nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};if(t){var a=[];return window.addEventListener("message",(function(e){var t=e.source;(t===window||null===t)&&"process-tick"===e.data&&(e.stopPropagation(),a.length>0)&&a.shift()()}),!0),function(e){a.push(e),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),e.title="browser",e.browser=!0,e.env={},e.argv=[],e.on=u,e.addListener=u,e.once=u,e.off=u,e.removeListener=u,e.removeAllListeners=u,e.emit=u,e.binding=function(e){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(e){throw new Error("process.chdir is not supported")}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/process/browser.js","/node_modules/gulp-browserify/node_modules/process")},{buffer:3,lYpoI2:10}],11:[function(e,t,a){(function(e,t,n,i,r,s,o,l,c){a.read=function(e,t,a,n,i){var r,s,o=8*i-n-1,l=(1<<o)-1,c=l>>1,u=-7,d=a?i-1:0,p=a?-1:1,m=e[t+d];for(d+=p,r=m&(1<<-u)-1,m>>=-u,u+=o;u>0;r=256*r+e[t+d],d+=p,u-=8);for(s=r&(1<<-u)-1,r>>=-u,u+=n;u>0;s=256*s+e[t+d],d+=p,u-=8);if(0===r)r=1-c;else{if(r===l)return s?NaN:1/0*(m?-1:1);s+=Math.pow(2,n),r-=c}return(m?-1:1)*s*Math.pow(2,r-n)},a.write=function(e,t,a,n,i,r){var s,o,l,c=8*r-i-1,u=(1<<c)-1,d=u>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,m=n?0:r-1,g=n?1:-1,b=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,s=u):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),(t+=s+d>=1?p/l:p*Math.pow(2,1-d))*l>=2&&(s++,l/=2),s+d>=u?(o=0,s=u):s+d>=1?(o=(t*l-1)*Math.pow(2,i),s+=d):(o=t*Math.pow(2,d-1)*Math.pow(2,i),s=0));i>=8;e[a+m]=255&o,m+=g,o/=256,i-=8);for(s=s<<i|o,c+=i;c>0;e[a+m]=255&s,m+=g,s/=256,c-=8);e[a+m-g]|=128*b}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/ieee754/index.js","/node_modules/ieee754")},{buffer:3,lYpoI2:10}]},{},[1])(1)},function(e,t,a){e.exports=a.p+"94cccf20036d014924e63d4d595e88e1.svg"},function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return o}));var n=a(93),i=a(110);const r=n.b.ENDPOINT_BLOCKLISTS,s={name:i.c,namespace_type:"agnostic",description:i.a,list_id:i.b,type:r},o=["name","description","item_id","entries.value","entries.entries.value","comments.comment"]},,,function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return g})),a.d(t,"a",(function(){return d}));var n=a(385),i=a(399),r=a(373),s=a(591);const o=e=>{const t={coreStart:e};return e=>a=>async o=>{a(o),(async({coreStart:e},{dispatch:t,getState:a},o)=>{const l=e.http,c=a();if("userChangedUrl"===o.type&&Object(i.i)(c)&&Object(i.g)(c)){const e=Object(i.m)(c);let a;try{a=(await Object(r.g)(l,e)).item,""===a.inputs[0].config.policy.value.windows.popup.malware.message&&(a.inputs[0].config.policy.value.windows.popup.malware.message=n.a,a.inputs[0].config.policy.value.mac.popup.malware.message=n.a,a.inputs[0].config.policy.value.linux.popup.malware.message=n.a),""===a.inputs[0].config.policy.value.windows.popup.ransomware.message&&(a.inputs[0].config.policy.value.windows.popup.ransomware.message=n.a),""===a.inputs[0].config.policy.value.windows.popup.memory_protection.message&&(a.inputs[0].config.policy.value.windows.popup.memory_protection.message=n.b),""===a.inputs[0].config.policy.value.mac.popup.memory_protection.message&&(a.inputs[0].config.policy.value.mac.popup.memory_protection.message=n.b),""===a.inputs[0].config.policy.value.linux.popup.memory_protection.message&&(a.inputs[0].config.policy.value.linux.popup.memory_protection.message=n.b),""===a.inputs[0].config.policy.value.windows.popup.behavior_protection.message&&(a.inputs[0].config.policy.value.windows.popup.behavior_protection.message=n.b),""===a.inputs[0].config.policy.value.mac.popup.behavior_protection.message&&(a.inputs[0].config.policy.value.mac.popup.behavior_protection.message=n.b),""===a.inputs[0].config.policy.value.linux.popup.behavior_protection.message&&(a.inputs[0].config.policy.value.linux.popup.behavior_protection.message=n.b)}catch(e){return void t({type:"serverFailedToReturnPolicyDetailsData",payload:e.body||e})}if(t({type:"serverReturnedPolicyDetailsData",payload:{policyItem:a}}),a.policy_id){const{results:e}=await Object(r.e)(l,a.policy_id);t({type:"serverReturnedPolicyDetailsAgentSummaryData",payload:{agentStatusSummary:e}})}}else if("userClickedPolicyDetailsSaveButton"===o.type){const{id:e}=Object(i.k)(c),a=Object(i.l)(c);let n;try{n=await Object(r.h)(l,e,a).catch((t=>t.response&&409===t.response.status?Object(r.g)(l,e).then((t=>{const n=t.item;return n.inputs[0].config.policy=a.inputs[0].config.policy,Object(r.h)(l,e,Object(s.a)(n))})):Promise.reject(t)))}catch(e){return void t({type:"serverReturnedPolicyDetailsUpdateFailure",payload:{success:!1,error:e.body||e}})}t({type:"serverReturnedUpdatedPolicyDetailsData",payload:{policyItem:n.item,updateStatus:{success:!0}}})}})(t,e,o)}};var l=a(271),c=a(153),u=a(105);const d=()=>({policyItem:void 0,isLoading:!1,agentStatusSummary:{error:0,events:0,offline:0,online:0,total:0,other:0},artifacts:{location:{page:u.b,pageSize:u.c,show:void 0,filter:""}}}),p=(e,t)=>({...e,inputs:e.inputs.map((e=>({...e,config:e.config&&{...e.config,policy:{...e.config.policy,value:t}}})))}),m=(e=d(),t)=>{if("serverReturnedPolicyDetailsData"===t.type||"serverReturnedUpdatedPolicyDetailsData"===t.type)return{...e,...t.payload,isLoading:!1};if("serverFailedToReturnPolicyDetailsData"===t.type)return{...e,isLoading:!1,apiError:t.payload};if("serverReturnedPolicyDetailsAgentSummaryData"===t.type)return{...e,...t.payload};if("serverReturnedPolicyDetailsUpdateFailure"===t.type)return{...e,isLoading:!1,updateStatus:t.payload};if("userClickedPolicyDetailsSaveButton"===t.type)return{...e,isLoading:!0,updateApiError:void 0};if("licenseChanged"===t.type)return{...e,license:t.payload};if("userChangedUrl"===t.type){const a={...e,location:t.payload,artifacts:{...e.artifacts,location:Object(c.b)(Object(l.parse)(t.payload.search.slice(1)))}},n=Object(i.g)(a),r=Object(i.g)(e),s=Object(i.h)(a);return n?r?a:{...a,isLoading:!0}:{...d(),location:t.payload,license:s}}if("userChangedPolicyConfig"===t.type){if(!e.policyItem)return e;const a={...e,policyItem:{...e.policyItem}},n={...Object(i.c)(e)};return a.policyItem.inputs[0].config.policy.value=n,Object.entries(t.payload.policyConfig).forEach((([e,t])=>{n[e]={...n[e],...t}})),a}if("userChangedAntivirusRegistration"===t.type){if(e.policyItem){const a=Object(i.c)(e);return{...e,policyItem:p(e.policyItem,{...a,windows:{...a.windows,antivirus_registration:{enabled:t.payload.enabled}}})}}return e}if("userChangedCredentialHardening"===t.type){if(e.policyItem){const a=Object(i.c)(e);return{...e,policyItem:p(e.policyItem,{...a,windows:{...a.windows,attack_surface_reduction:{credential_hardening:{enabled:t.payload.enabled}}}})}}return e}return e},g=(e=d(),t)=>[m].reduce(((e,a)=>a(e,t)),e)},,function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var n=a(4),i=a.n(n),r=a(78),s=a(32),o=a(7),l=a(35),c=a(0),u=a(178),d=a(170);const p=[{key:"linux.advanced.agent.connection_delay",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.agent.connection_delay",{defaultMessage:"How long to wait for agent connectivity before sending first policy reply, in seconds. Default: 60."})},{key:"linux.advanced.artifacts.global.base_url",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.artifacts.global.base_url",{defaultMessage:"Base URL from which to download global artifact manifests. Default: https://artifacts.security.elastic.co."})},{key:"linux.advanced.artifacts.global.manifest_relative_url",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.artifacts.global.manifest_relative_url",{defaultMessage:"Relative URL from which to download global artifact manifests. Default: /downloads/endpoint/manifest/artifacts-<version>.zip."})},{key:"linux.advanced.artifacts.global.public_key",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.artifacts.global.public_key",{defaultMessage:"PEM-encoded public key used to verify the global artifact manifest signature."})},{key:"linux.advanced.artifacts.global.interval",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.artifacts.global.interval",{defaultMessage:"Interval between global artifact manifest download attempts, in seconds. Default: 3600."})},{key:"linux.advanced.artifacts.user.public_key",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.artifacts.user.public_key",{defaultMessage:"PEM-encoded public key used to verify the user artifact manifest signature."})},{key:"linux.advanced.elasticsearch.delay",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.elasticsearch.delay",{defaultMessage:"Delay for sending events to Elasticsearch, in seconds. Default: 120."})},{key:"linux.advanced.elasticsearch.tls.verify_peer",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.elasticsearch.tls.verify_peer",{defaultMessage:"Whether to verify the certificates presented by the peer. Default: true."})},{key:"linux.advanced.elasticsearch.tls.verify_hostname",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.elasticsearch.tls.verify_hostname",{defaultMessage:"Whether to verify the hostname of the peer is what's in the certificate. Default: true."})},{key:"linux.advanced.elasticsearch.tls.ca_cert",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.elasticsearch.tls.ca_cert",{defaultMessage:"PEM-encoded certificate for Elasticsearch certificate authority."})},{key:"linux.advanced.logging.file",first_supported_version:"7.11",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.logging.file",{defaultMessage:"A supplied value will override the log level configured for logs that are saved to disk and streamed to Elasticsearch. It is recommended Fleet be used to change this logging in most circumstances. Allowed values are error, warning, info, debug, and trace."})},{key:"linux.advanced.logging.syslog",first_supported_version:"7.11",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.logging.syslog",{defaultMessage:"A supplied value will configure logging to syslog. Allowed values are error, warning, info, debug, and trace."})},{key:"linux.advanced.tty_io.max_kilobytes_per_process",first_supported_version:"8.5",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.tty_io.max_kilobytes_per_process",{defaultMessage:"The maximum kilobytes of terminal output to record for a single process. Default: 512"})},{key:"linux.advanced.tty_io.max_kilobytes_per_event",first_supported_version:"8.5",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.tty_io.max_kilobytes_per_event",{defaultMessage:"The maximum kilobytes of terminal output to record in a single event. Default: 512"})},{key:"linux.advanced.capture_env_vars",first_supported_version:"8.6",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.capture_env_vars",{defaultMessage:"The list of environment variables to capture (up to five), separated by commas."})},{key:"linux.advanced.tty_io.max_event_interval_seconds",first_supported_version:"8.5",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.tty_io.max_event_interval_seconds",{defaultMessage:"The maximum amount of time (seconds) to batch terminal output in a single event. Default: 30"})},{key:"mac.advanced.agent.connection_delay",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.agent.connection_delay",{defaultMessage:"How long to wait for agent connectivity before sending first policy reply, in seconds. Default: 60."})},{key:"mac.advanced.artifacts.global.base_url",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.artifacts.global.base_url",{defaultMessage:"URL from which to download global artifact manifests."})},{key:"mac.advanced.artifacts.global.manifest_relative_url",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.artifacts.global.manifest_relative_url",{defaultMessage:"Relative URL from which to download global artifact manifests. Default: /downloads/endpoint/manifest/artifacts-<version>.zip."})},{key:"mac.advanced.artifacts.global.public_key",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.artifacts.global.public_key",{defaultMessage:"PEM-encoded public key used to verify the global artifact manifest signature."})},{key:"mac.advanced.artifacts.global.interval",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.artifacts.global.interval",{defaultMessage:"Interval between global artifact manifest download attempts, in seconds. Default: 3600."})},{key:"mac.advanced.artifacts.user.public_key",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.artifacts.user.public_key",{defaultMessage:"PEM-encoded public key used to verify the user artifact manifest signature."})},{key:"mac.advanced.elasticsearch.delay",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.elasticsearch.delay",{defaultMessage:"Delay for sending events to Elasticsearch, in seconds. Default: 120."})},{key:"mac.advanced.elasticsearch.tls.verify_peer",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.elasticsearch.tls.verify_peer",{defaultMessage:"Whether to verify the certificates presented by the peer. Default: true."})},{key:"mac.advanced.elasticsearch.tls.verify_hostname",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.elasticsearch.tls.verify_hostname",{defaultMessage:"Whether to verify the hostname of the peer is what's in the certificate. Default: true."})},{key:"mac.advanced.elasticsearch.tls.ca_cert",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.elasticsearch.tls.ca_cert",{defaultMessage:"PEM-encoded certificate for Elasticsearch certificate authority."})},{key:"mac.advanced.logging.file",first_supported_version:"7.11",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.logging.file",{defaultMessage:"A supplied value will override the log level configured for logs that are saved to disk and streamed to Elasticsearch. It is recommended Fleet be used to change this logging in most circumstances. Allowed values are error, warning, info, debug, and trace."})},{key:"mac.advanced.logging.syslog",first_supported_version:"7.11",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.logging.syslog",{defaultMessage:"A supplied value will configure logging to syslog. Allowed values are error, warning, info, debug, and trace."})},{key:"mac.advanced.malware.quarantine",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.malware.quarantine",{defaultMessage:"Whether quarantine should be enabled when malware prevention is enabled. Default: true."})},{key:"mac.advanced.malware.threshold",first_supported_version:"7.11",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.malware.threshold",{defaultMessage:"The threshold that should be used for evaluating malware. Allowed values are normal, conservative, and aggressive. Default: normal."})},{key:"mac.advanced.kernel.connect",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.kernel.connect",{defaultMessage:"Whether to connect to the kernel driver. Default: true."})},{key:"mac.advanced.kernel.process",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.kernel.process",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel process events. Default: true."})},{key:"mac.advanced.kernel.filewrite",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.kernel.filewrite",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel file write events. Default: true."})},{key:"mac.advanced.kernel.network",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.kernel.network",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel network events. Default: true."})},{key:"mac.advanced.harden.self_protect",first_supported_version:"7.11",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.harden.self_protect",{defaultMessage:"Enables self-protection on macOS. Default: true."})},{key:"windows.advanced.agent.connection_delay",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.agent.connection_delay",{defaultMessage:"How long to wait for agent connectivity before sending first policy reply, in seconds. Default: 60."})},{key:"windows.advanced.artifacts.global.base_url",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.artifacts.global.base_url",{defaultMessage:"URL from which to download global artifact manifests."})},{key:"windows.advanced.artifacts.global.manifest_relative_url",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.artifacts.global.manifest_relative_url",{defaultMessage:"Relative URL from which to download global artifact manifests. Default: /downloads/endpoint/manifest/artifacts-<version>.zip."})},{key:"windows.advanced.artifacts.global.public_key",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.artifacts.global.public_key",{defaultMessage:"PEM-encoded public key used to verify the global artifact manifest signature."})},{key:"windows.advanced.artifacts.global.interval",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.artifacts.global.interval",{defaultMessage:"Interval between global artifact manifest download attempts, in seconds. Default: 3600."})},{key:"windows.advanced.artifacts.user.public_key",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.artifacts.user.public_key",{defaultMessage:"PEM-encoded public key used to verify the user artifact manifest signature."})},{key:"windows.advanced.elasticsearch.delay",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.elasticsearch.delay",{defaultMessage:"Delay for sending events to Elasticsearch, in seconds. Default: 120."})},{key:"windows.advanced.elasticsearch.tls.verify_peer",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.elasticsearch.tls.verify_peer",{defaultMessage:"Whether to verify the certificates presented by the peer. Default: true."})},{key:"windows.advanced.elasticsearch.tls.verify_hostname",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.elasticsearch.tls.verify_hostname",{defaultMessage:"Whether to verify the hostname of the peer is what's in the certificate. Default: true."})},{key:"windows.advanced.elasticsearch.tls.ca_cert",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.elasticsearch.tls.ca_cert",{defaultMessage:"PEM-encoded certificate for Elasticsearch certificate authority."})},{key:"windows.advanced.logging.file",first_supported_version:"7.11",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.logging.file",{defaultMessage:"A supplied value will override the log level configured for logs that are saved to disk and streamed to Elasticsearch. It is recommended Fleet be used to change this logging in most circumstances. Allowed values are error, warning, info, debug, and trace."})},{key:"windows.advanced.logging.debugview",first_supported_version:"7.11",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.logging.debugview",{defaultMessage:"A supplied value will configure logging to Debugview (a Sysinternals tool). Allowed values are error, warning, info, debug, and trace."})},{key:"windows.advanced.malware.quarantine",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.malware.quarantine",{defaultMessage:"Whether quarantine should be enabled when malware prevention is enabled. Default: true."})},{key:"windows.advanced.malware.threshold",first_supported_version:"7.11",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.malware.threshold",{defaultMessage:"The threshold that should be used for evaluating malware. Allowed values are normal, conservative, and aggressive. Default: normal."})},{key:"windows.advanced.kernel.connect",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.connect",{defaultMessage:"Whether to connect to the kernel driver. Default: true."})},{key:"windows.advanced.kernel.process",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.process",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel process events. Default: true."})},{key:"windows.advanced.kernel.filewrite",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.filewrite",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel file write events. Default: true."})},{key:"windows.advanced.kernel.network",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.network",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel network events. Default: true."})},{key:"windows.advanced.kernel.fileopen",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.fileopen",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel file open events. Default: true."})},{key:"windows.advanced.kernel.asyncimageload",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.asyncimageload",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel async image load events. Default: true."})},{key:"windows.advanced.kernel.syncimageload",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.syncimageload",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel sync image load events. Default: true."})},{key:"windows.advanced.kernel.registry",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.registry",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel registry events. Default: true."})},{key:"windows.advanced.kernel.fileaccess",first_supported_version:"7.15",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.fileaccess",{defaultMessage:"Report limited file access (read) events. Paths are not user-configurable. Default value is true."})},{key:"windows.advanced.kernel.registryaccess",first_supported_version:"7.15",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.registryaccess",{defaultMessage:"Report limited registry access (queryvalue, savekey) events. Paths are not user-configurable. Default value is true."})},{key:"windows.advanced.diagnostic.enabled",first_supported_version:"7.11",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.diagnostic.enabled",{defaultMessage:"A value of 'false' disables running diagnostic features on Endpoint. Default: true."})},{key:"linux.advanced.diagnostic.enabled",first_supported_version:"7.12",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.diagnostic.enabled",{defaultMessage:"A value of 'false' disables running diagnostic features on Endpoint. Default: true."})},{key:"mac.advanced.diagnostic.enabled",first_supported_version:"7.12",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.diagnostic.enabled",{defaultMessage:"A value of 'false' disables running diagnostic features on Endpoint. Default: true."})},{key:"windows.advanced.alerts.cloud_lookup",first_supported_version:"7.12",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.alerts.cloud_lookup",{defaultMessage:"A value of 'false' disables cloud lookup for Windows alerts. Default: true."})},{key:"mac.advanced.alerts.cloud_lookup",first_supported_version:"7.12",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.alerts.cloud_lookup",{defaultMessage:"A value of 'false' disables cloud lookup for Mac alerts. Default: true."})},{key:"windows.advanced.ransomware.mbr",first_supported_version:"7.12",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.ransomware.mbr",{defaultMessage:"A value of 'false' disables Ransomware MBR protection. Default: true."})},{key:"windows.advanced.ransomware.canary",first_supported_version:"7.14",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.ransomware.canary",{defaultMessage:"A value of 'false' disables Ransomware canary protection. Default: true."})},{key:"windows.advanced.memory_protection.shellcode",first_supported_version:"7.15",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.memory_protection.shellcode",{defaultMessage:"Enable shellcode injection detection as a part of memory protection. Default: true."})},{key:"windows.advanced.memory_protection.memory_scan",first_supported_version:"7.15",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.memory_protection.memory_scan",{defaultMessage:"Enable scanning for malicious memory regions as a part of memory protection. Default: true."})},{key:"linux.advanced.malware.quarantine",first_supported_version:"7.14",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.malware.quarantine",{defaultMessage:"Whether quarantine should be enabled when malware prevention is enabled. Default: true."})},{key:"windows.advanced.memory_protection.shellcode_collect_sample",first_supported_version:"7.15",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.memory_protection.shellcode_collect_sample",{defaultMessage:"Collect 4MB of memory surrounding detected shellcode regions. Default: false. Enabling this value may significantly increase the amount of data stored in Elasticsearch."})},{key:"windows.advanced.memory_protection.memory_scan_collect_sample",first_supported_version:"7.15",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.memory_protection.memory_scan_collect_sample",{defaultMessage:"Collect 4MB of memory surrounding detected malicious memory regions. Default: false. Enabling this value may significantly increase the amount of data stored in Elasticsearch."})},{key:"windows.advanced.memory_protection.shellcode_enhanced_pe_parsing",first_supported_version:"7.15",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.memory_protection.shellcode_enhanced_pe_parsing",{defaultMessage:"Attempt to identify and extract PE metadata from injected shellcode, including Authenticode signatures and version resource information. Default: true."})},{key:"mac.advanced.memory_protection.memory_scan_collect_sample",first_supported_version:"7.16",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.memory_protection.memory_scan_collect_sample",{defaultMessage:"Collect 4MB of memory surrounding detected malicious memory regions. Default: false. Enabling this value may significantly increase the amount of data stored in Elasticsearch."})},{key:"mac.advanced.memory_protection.memory_scan",first_supported_version:"7.16",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.memory_protection.memory_scan",{defaultMessage:"Enable scanning for malicious memory regions as a part of memory protection. Default: true."})},{key:"linux.advanced.memory_protection.memory_scan_collect_sample",first_supported_version:"7.16",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.memory_protection.memory_scan_collect_sample",{defaultMessage:"Collect 4MB of memory surrounding detected malicious memory regions. Default: false. Enabling this value may significantly increase the amount of data stored in Elasticsearch."})},{key:"linux.advanced.memory_protection.memory_scan",first_supported_version:"7.16",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.memory_protection.memory_scan",{defaultMessage:"Enable scanning for malicious memory regions as a part of memory protection. Default: true."})},{key:"linux.advanced.artifacts.user.ca_cert",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.artifacts.user.ca_cert",{defaultMessage:"PEM-encoded certificate for Fleet Server certificate authority."})},{key:"windows.advanced.artifacts.user.ca_cert",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.artifacts.user.ca_cert",{defaultMessage:"PEM-encoded certificate for Fleet Server certificate authority."})},{key:"mac.advanced.artifacts.user.ca_cert",first_supported_version:"7.9",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.artifacts.user.ca_cert",{defaultMessage:"PEM-encoded certificate for Fleet Server certificate authority."})},{key:"windows.advanced.events.etw",first_supported_version:"8.1",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.events.etw",{defaultMessage:"Enable collection of ETW events. Default: true"})},{key:"windows.advanced.diagnostic.rollback_telemetry_enabled",first_supported_version:"8.1",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.diagnostic.rollback_telemetry_enabled",{defaultMessage:"Enable diagnostic rollback telemetry. Default: true"})},{key:"mac.advanced.kernel.network_extension.enable_content_filtering",first_supported_version:"8.1",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.kernel.network_extension.enable_content_filtering",{defaultMessage:"Enable or disable the network content filter, this will enable/disable network eventing. Host isolation will fail if this option is disabled. Default: true"})},{key:"mac.advanced.kernel.network_extension.enable_packet_filtering",first_supported_version:"8.1",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.kernel.network_extension.enable_packet_filtering",{defaultMessage:"Enable or disable the network packet filter. Host isolation will fail if this option is disabled. Default: true"})},{key:"windows.advanced.memory_protection.shellcode_trampoline_detection",first_supported_version:"8.1",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.memory_protection.shellcode_trampoline_detection",{defaultMessage:"Enable trampoline-based shellcode injection detection as a part of memory protection. Default: true"})},{key:"linux.advanced.kernel.capture_mode",first_supported_version:"8.2",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.kernel.capture_mode",{defaultMessage:"Allows users to control whether kprobes or ebpf are used to gather data. Options are kprobe, ebpf, or auto. Auto uses ebpf if possible, otherwise uses kprobe. Default: auto"})},{key:"linux.advanced.event_filter.default",first_supported_version:"8.3",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.event_filter.default",{defaultMessage:"Download default event filter rules from Elastic.  Default: true"})},{key:"mac.advanced.event_filter.default",first_supported_version:"8.3",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.event_filter.default",{defaultMessage:"Download default event filter rules from Elastic.  Default: true"})},{key:"windows.advanced.event_filter.default",first_supported_version:"8.3",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.event_filter.default",{defaultMessage:"Download default event filter rules from Elastic.  Default: true"})},{key:"windows.advanced.utilization_limits.cpu",first_supported_version:"8.3",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.utilization_limits.cpu",{defaultMessage:"The percentage of the aggregate system CPU to restrict Endpoint to. The range is 20-100%. Anything under 20 gets ignored and causes a policy warning.  Default: 100"})},{key:"linux.advanced.utilization_limits.cpu",first_supported_version:"8.3",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.utilization_limits.cpu",{defaultMessage:"The percentage of the aggregate system CPU to restrict Endpoint to. The range is 20-100%. Anything under 20 gets ignored and causes a policy warning.  Default: 50"})},{key:"windows.advanced.alerts.rollback.self_healing.enabled",first_supported_version:"8.4",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.alerts.rollback.self_healing.enabled",{defaultMessage:"Self-healing erases attack artifacts when prevention alerts are triggered. Warning: data loss can occur. Default: false"}),license:"platinum"},{key:"linux.advanced.fanotify.ignore_unknown_filesystems",first_supported_version:"8.4",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.fanotify.ignore_unknown_filesystems",{defaultMessage:'Whether fanotify should ignore unknown filesystems. When true, only CI tested filesystems will be marked by default; additional filesystems can be added or removed with "monitored_filesystems" and "ignored_filesystems", respectively. When false, only an internally curated list of filesystems will be ignored, all others will be marked; additional filesystems can be ignored via "ignored_filesystems". "monitored_filesystems" is ignored when "ignore_unknown_filesystems" is false. Default: true'})},{key:"linux.advanced.fanotify.monitored_filesystems",first_supported_version:"8.4",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.fanotify.monitored_filesystems",{defaultMessage:'Additional filesystems for fanotify to monitor. The format is a comma separated list of filesystem names as they appear in "/proc/filesystems", e.g. "jfs,ufs,ramfs". It is recommended to avoid network-backed filesystems. When "ignore_unknown_filesystems" is false, this option is ignored. When "ignore_unknown_filesystems" is true, parsed entries of this option are monitored by fanotify unless overridden by entries in "ignored_filesystems" or internally known bad filesystems.'})},{key:"linux.advanced.fanotify.ignored_filesystems",first_supported_version:"8.4",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.fanotify.ignored_filesystems",{defaultMessage:'Additional filesystems for fanotify to ignore. The format is a comma separated list of filesystem names as they appear in "/proc/filesystems", e.g. "ext4,tmpfs". When "ignore_unknown_filesystems" is false, parsed entries of this option supplement internally known bad filesystems to be ignored. When "ignore_unknown_filesystems" is true, parsed entries of this option override entries in "monitored_filesystems" and internally CI tested filesystems.'})},{key:"windows.advanced.memory_protection.context_manipulation_detection",first_supported_version:"8.4",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.memory_protection.context_manipulation_detection",{defaultMessage:"Detect injection based on thread context manipulation (e.g. `SetThreadContext`) as a part of memory protection. Default: true"})},{key:"windows.advanced.kernel.image_and_process_file_timestamp",first_supported_version:"8.4",documentation:c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.image_and_process_file_timestamp",{defaultMessage:"Collect executable/dll timestamps for process and async image load events. Default: true"})}],m=c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.calloutTitle",{defaultMessage:"Proceed with caution!"}),g=c.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.warningMessage",{defaultMessage:"This section contains policy values that support advanced use cases. If not configured\n    properly, these values can cause unpredictable behavior. Please consult documentation\n    carefully or contact support before editing these values."}),b=i.a.memo((({isPlatinumPlus:e})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiCallOut,{title:m,color:"warning",iconType:"alert"},i.a.createElement("p",null,g)),i.a.createElement(s.EuiSpacer,null),i.a.createElement(s.EuiText,{size:"xs",color:"subdued"},i.a.createElement("h4",null,i.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.advanced",defaultMessage:"Advanced settings"}))),i.a.createElement(s.EuiPanel,{"data-test-subj":"advancedPolicyPanel",paddingSize:"s"},p.map(((t,a)=>{const n=t.key.split(".");return!(!e&&"platinum"===t.license)&&i.a.createElement(f,{key:a,configPath:n,firstSupportedVersion:t.first_supported_version,lastSupportedVersion:t.last_supported_version,documentation:t.documentation})}))))));b.displayName="AdvancedPolicyForms";const f=i.a.memo((({configPath:e,firstSupportedVersion:t,lastSupportedVersion:a,documentation:l})=>{const c=Object(r.useDispatch)(),p=Object(d.c)(u.l),m=Object(n.useCallback)((t=>{if(p){const a=Object(o.cloneDeep)(p);!function(e,t,a){let n=e;for(let e=0;e<a.length-1;e++)n[a[e]]||(n[a[e]]={}),n=n[a[e]];if(n[a[a.length-1]]=t,""===t||void 0===t){n=e;for(let t=a.length;t>=0;t--){const i=a.slice(0,t);for(let e=0;e<i.length-1;e++)n=n[i[e]];if(void 0!==n[i[i.length-1]]&&""!==n[i[i.length-1]]&&0!==Object.keys(n[i[i.length-1]]).length)break;"advanced"===i[i.length-1]?n[i[i.length-1]]=void 0:delete n[i[i.length-1]],n=e}}}(a,t.target.value,e),c({type:"userChangedPolicyConfig",payload:{policyConfig:a}})}}),[c,p,e]),g=p&&function(e,t){let a=e;for(let e=0;e<t.length-1;e++){if(!a[t[e]])return;a=a[t[e]]}return a[t[t.length-1]]}(p,e);return i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiFormRow,{fullWidth:!0,label:i.a.createElement(s.EuiFlexGroup,{responsive:!1},i.a.createElement(s.EuiFlexItem,{grow:!0},e.join(".")),l&&i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(s.EuiIconTip,{content:l,position:"right"}))),labelAppend:i.a.createElement(s.EuiText,{size:"xs"},a?`${t}-${a}`:`${t}+`)},i.a.createElement(s.EuiFieldText,{"data-test-subj":e.join("."),fullWidth:!0,value:g,onChange:m})))}));f.displayName="PolicyAdvanced"},function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return d}));var n=a(132);const i="included",r=e=>{switch(e.length){case 32:return"md5";case 40:return"sha1";case 64:return"sha256"}},s=(e,t)=>({field:e,value:t,type:"match",operator:i}),o=(e,t)=>({field:e,value:t,type:"match_any",operator:i});const l=(e,t=!1)=>{const a=[];return e.forEach((e=>{if(e.field.includes(n.b.HASH))(function(e,t){const a=[];if(!Array.isArray(t.value)){const i=s(`${e}${n.b.HASH}${r(t.value)}`,t.value.toLowerCase());return a.push(i),a}const i=t.value.reduce(((e,t)=>{const a=r(t);return a?{...e,[a]:[...e[a],t]}:e}),{md5:[],sha1:[],sha256:[]});return Object.entries(i).forEach((([t,i])=>{if(!i.length)return;const r=o(`${e}${n.b.HASH}${t}`,i);a.push(r)})),a})(e.field.split(".")[0],e).forEach((e=>a.push(e)));else if(e.field.includes(n.b.SIGNER)){const n=function(e,t,a=!1){const n=Array.isArray(t)?o("subject_name",t):s("subject_name",t),i=[];return a&&i.push(s("trusted","true")),i.push(n),((e,t)=>({field:e,entries:t,type:"nested"}))(e,i)}(e.field,e.value,t);a.push(n)}else if((e.field.includes(n.b.EXECUTABLE)||e.field.includes(n.b.PATH))&&"wildcard"===e.type){const t=function(e,t){return Array.isArray(t)?o(e,t):((e,t)=>({field:e,value:t,type:"wildcard",operator:i}))(e,t)}(e.field,e.value);a.push(t)}else{const t=(l=e.field,c=e.value,Array.isArray(c)?o(l,c):s(l,c));a.push(t)}var l,c})),a},c=(e,t,a)=>({field:e,value:a,type:t,operator:i});function u(e){return`${e.split(".")[0]}${n.b.HASH}*`}const d=e=>{const t=(e=>e.reduce(((e,t)=>{const a=t.field;if(a.includes(n.b.HASH)&&"match"===t.type){const n=u(a);return{...e,[n]:c(n,t.type,t.value)}}if(a.includes(n.b.HASH)&&"match_any"===t.type){var i,r;const n=u(a),s=null!==(i=null===(r=e[n])||void 0===r?void 0:r.value)&&void 0!==i?i:[];return{...e,[n]:c(n,t.type,[...s,...t.value])}}if((a.includes(n.b.EXECUTABLE)||a.includes(n.b.PATH))&&("match"===t.type||"match_any"===t.type||"wildcard"===t.type))return{...e,[a]:c(a,t.type,t.value)};if(a.includes(n.b.SIGNER)&&"nested"===t.type){const n=t.entries.find((e=>"subject_name"===e.field&&("match"===e.type||"match_any"===e.type)));if(n)return{...e,[a]:c(a,n.type,n.value)}}return e}),{}))(e);return Object.values(t).reduce(((e,t)=>t?[...e,t]:e),[])}},,,,,,,,,,,,,function(e,t,a){"use strict";a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return d}));var n=a(4),i=a.n(n),r=a(32),s=a(1092),o=a(581),l=a(77);let c;!function(e){e.overview="details",e.activityLog="activity_log"}(c||(c={}));const u=Object(n.memo)((({tab:e,isSelected:t})=>{const{getAppUrl:a}=Object(l.d)(),n=Object(o.a)(e.route);return i.a.createElement(r.EuiTab,{href:a({path:e.route}),onClick:n,isSelected:t,key:e.id,"data-test-subj":`endpoint-details-flyout-tab-${e.id}`},e.name)}));u.displayName="EndpointDetailsTab";const d=Object(n.memo)((({hostname:e,show:t,tabs:a})=>{const o=Object(n.useMemo)((()=>a.find((e=>e.id===t))),[a,t]),l=a.map((e=>i.a.createElement(u,{key:e.id,tab:e,isSelected:e.id===(null==o?void 0:o.id)})));return i.a.createElement(i.a.Fragment,null,i.a.createElement(s.a,{hostname:e,hasBorder:!0},i.a.createElement(r.EuiTabs,{bottomBorder:!1,style:{marginBottom:"-25px"}},l)),i.a.createElement(r.EuiFlyoutBody,{"data-test-subj":`endpoint${"details"===(null==o?void 0:o.id)?"Details":"ActivityLog"}FlyoutBody`},null==o?void 0:o.content))}));d.displayName="EndpointDetailsFlyoutTabs"},function(e,t,a){"use strict";var n=a(896);a.d(t,"a",(function(){return n.a}))},,,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(4),i=a.n(n),r=a(32),s=a(379),o=a(280),l=a(0),c=a(153),u=a(581),d=a(240);const p=Object(n.memo)((({endpointId:e})=>{var t;const{getAppUrl:a}=Object(d.b)(),{show:p,...m}=Object(s.b)(o.uiQueryParams),g=Object(n.useMemo)((()=>Object(c.d)({name:"endpointDetails",...m,selected_endpoint:e})),[m,e]),b=Object(u.a)(g),f=Object(n.useMemo)((()=>({title:l.i18n.translate("xpack.securitySolution.endpoint.policyResponse.backLinkTitle",{defaultMessage:"Endpoint details"}),href:a({path:g}),onClick:b})),[b,a,g]);return i.a.createElement("div",null,i.a.createElement(r.EuiButtonEmpty,{flush:"both","data-test-subj":"flyoutSubHeaderBackButton",iconType:"arrowLeft",size:"xs",href:null!==(t=null==f?void 0:f.href)&&void 0!==t?t:"",onClick:null==f?void 0:f.onClick},null==f?void 0:f.title))}));p.displayName="BackToEndpointDetailsFlyoutSubHeader";const m=Object(n.memo)((({endpointId:e,hasBorder:t=!1,hostname:a,children:n})=>{const l=Object(s.b)(o.detailsLoading);return i.a.createElement(r.EuiFlyoutHeader,{hasBorder:t},e&&i.a.createElement(p,{endpointId:e}),l?i.a.createElement(r.EuiLoadingContent,{lines:1}):i.a.createElement(r.EuiToolTip,{content:a,anchorClassName:"eui-textTruncate"},i.a.createElement(r.EuiTitle,{size:"s"},i.a.createElement("h2",{style:{overflow:"hidden",textOverflow:"ellipsis"},"data-test-subj":"endpointDetailsFlyoutTitle"},a))),n)}));m.displayName="EndpointDetailsFlyoutHeader"},,,,,,,,,,,,,,,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=(e,t,a)=>{const n=t.indexOf(e),i=[...t];n>=0?i.splice(n,1):i.push(e),a(i)}},function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var n=a(4),i=a.n(n),r=a(32),s=a(33),o=a.n(s);const l=o()(r.EuiFlexGroup).withConfig({displayName:"PopoverItemsWrapper",componentId:"sc-3vrhxe-0"})(["width:100%;"]),c=o()(r.EuiBadgeGroup).withConfig({displayName:"PopoverWrapper",componentId:"sc-3vrhxe-1"})(["max-height:200px;max-width:600px;overflow:auto;line-height:",";"],(({theme:e})=>e.eui.euiLineHeight)),u=({items:e,renderItem:t,popoverTitle:a,popoverButtonTitle:s,popoverButtonIcon:o,numberOfItemsToDisplay:u=0,dataTestPrefix:d="items"})=>{const[p,m]=Object(n.useState)(!1),g=({items:e})=>i.a.createElement(i.a.Fragment,null,e.map(t));return e.length<=u?i.a.createElement(l,{"data-test-subj":d,alignItems:"center",gutterSize:"s"},i.a.createElement(g,{items:e})):i.a.createElement(l,{alignItems:"center",gutterSize:"s","data-test-subj":d},0!==u&&i.a.createElement(r.EuiFlexItem,{grow:1,className:"eui-textTruncate"},i.a.createElement(g,{items:e.slice(0,u)})),i.a.createElement(r.EuiPopover,{ownFocus:!0,"data-test-subj":`${d}DisplayPopover`,button:i.a.createElement(r.EuiBadge,{iconType:o,color:"hollow","data-test-subj":`${d}DisplayPopoverButton`,onClick:()=>m(!p),onClickAriaLabel:s},s),isOpen:p,closePopover:()=>m(!p),repositionOnScroll:!0},a?i.a.createElement(r.EuiPopoverTitle,{"data-test-subj":`${d}DisplayPopoverTitle`},a):null,i.a.createElement(c,{"data-test-subj":`${d}DisplayPopoverWrapper`},i.a.createElement(g,{items:e.slice(u)}))))},d=i.a.memo(u);d.displayName="PopoverItems";const p=d},,function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(4),i=a.n(n),r=a(78),s=a(13);const o=Object(n.memo)((({children:e})=>{const t=Object(r.useDispatch)();return Object(n.useEffect)((()=>{var e;const a=null===(e=s.a.getLicenseInformation$())||void 0===e?void 0:e.subscribe((e=>{t({type:"licenseChanged",payload:e})}));return()=>null==a?void 0:a.unsubscribe()}),[t]),i.a.createElement(i.a.Fragment,null,e)}));o.displayName="CurrentLicense"},,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return ne}));var n=a(32),i=a(4),r=a.n(i),s=a(35),o=a(0),l=a(132),c=a(78),u=a(7),d=a(1),p=a(2),m=a(142),g=a(33),b=a.n(g),f=a(279);const y={type:o.i18n.translate("xpack.securitySolution.endpoint.policyDetailType",{defaultMessage:"Type"}),os:o.i18n.translate("xpack.securitySolution.endpoint.policyDetailOS",{defaultMessage:"Operating system"})},h=Object(i.memo)((({children:e})=>r.a.createElement(n.EuiTitle,{size:"xxs"},r.a.createElement("h5",null,e))));h.displayName="ConfigFormHeading";const E=Object(i.memo)((({type:e,supportedOss:t,osRestriction:a,dataTestSubj:o,rightCorner:l,children:c})=>{const u=Object(i.useContext)(g.ThemeContext).eui.euiPanelPaddingModifiers.paddingMedium;return r.a.createElement(n.EuiPanel,{"data-test-subj":o,hasBorder:!0,hasShadow:!1,paddingSize:"none"},r.a.createElement(n.EuiFlexGroup,{direction:"row",gutterSize:"none",alignItems:"center",style:{padding:`${u} ${u} 0 ${u}`}},r.a.createElement(n.EuiFlexItem,{grow:1},r.a.createElement(h,null,y.type),r.a.createElement(n.EuiText,{size:"s"},e)),r.a.createElement(n.EuiFlexItem,{grow:2},r.a.createElement(h,null,y.os),r.a.createElement(n.EuiFlexGroup,{direction:"row",gutterSize:"s",alignItems:"center"},r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiText,{size:"s"},t.map((e=>f.a[e])).join(", ")," ")),a&&r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiFlexGroup,{direction:"row",gutterSize:"xs"},r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiTextColor,{color:"subdued"},r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.antivirusRegistration.osRestriction",defaultMessage:"Restrictions"}))),r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiIconTip,{type:"iInCircle",color:"subdued",content:a})))))),r.a.createElement(n.EuiShowFor,{sizes:["m","l","xl"]},r.a.createElement(n.EuiFlexItem,{grow:3},r.a.createElement(n.EuiFlexGroup,{direction:"row",gutterSize:"none",justifyContent:"flexEnd"},r.a.createElement(n.EuiFlexItem,{grow:!1},l)))),r.a.createElement(n.EuiShowFor,{sizes:l?["s","xs"]:[]},r.a.createElement(n.EuiFlexItem,null,l))),r.a.createElement(n.EuiHorizontalRule,{margin:"m"}),r.a.createElement("div",{style:{padding:`0 ${u} ${u} ${u}`}},c))}));E.displayName="ConfigForm";var v=a(323),x=a(13),k=a(170),S=a(178);const j=r.a.memo((({protection:e,protectionMode:t,osList:a,label:s})=>{const o=Object(k.c)(S.l),l=Object(c.useDispatch)(),d=Object(i.useMemo)((()=>Object(n.htmlIdGenerator)()()),[]),p=o&&o.windows[e].mode,g=Object(x.b)().isPlatinumPlus(),b=Object(i.useCallback)((()=>{if(o){const n=Object(u.cloneDeep)(o);for(const i of a)("windows"===i||"mac"===i||"linux"===i)&&(n[i][e].mode=t),g&&("windows"===i||"mac"===i||"linux"===i)&&(t===m.e.prevent?n[i].popup[e].enabled=!0:n[i].popup[e].enabled=!1);l({type:"userChangedPolicyConfig",payload:{policyConfig:n}})}}),[l,t,o,g,a,e]);return r.a.createElement(n.EuiRadio,{className:"policyDetailsProtectionRadio",label:s,id:d,checked:p===t,onChange:b,disabled:p===m.e.off})}));j.displayName="ProtectionRadio";const O=b()(n.EuiFlexGroup).withConfig({displayName:"RadioFlexGroup",componentId:"sc-5bp4yp-0"})([".no-right-margin-radio{margin-right:0;}.no-horizontal-margin-radio{margin:"," 0;}"],(e=>e.theme.eui.euiSizeM)),w=r.a.memo((({protection:e,osList:t})=>{const a=Object(i.useMemo)((()=>[{id:m.e.detect,label:o.i18n.translate("xpack.securitySolution.endpoint.policy.details.detect",{defaultMessage:"Detect"})},{id:m.e.prevent,label:o.i18n.translate("xpack.securitySolution.endpoint.policy.details.prevent",{defaultMessage:"Prevent"})}]),[]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(h,null,r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyDetailsConfig.protectionLevel",defaultMessage:"Protection level"})),r.a.createElement(n.EuiSpacer,{size:"xs"}),r.a.createElement(O,null,r.a.createElement(n.EuiFlexItem,{className:"no-right-margin-radio",grow:1},r.a.createElement(j,{protection:e,protectionMode:a[0].id,osList:t,key:{protection:e}+a[0].id,label:a[0].label})),r.a.createElement(n.EuiFlexItem,{className:"no-horizontal-margin-radio",grow:5},r.a.createElement(j,{protection:e,protectionMode:a[1].id,osList:t,key:{protection:e}+a[1].id,label:a[1].label}))))}));w.displayName="RadioButtons";const T=new Map([["malware","7.11+"],["ransomware","7.12+"],["memory_protection","7.15+"],["behavior_protection","7.15+"]]),I=({optionName:e})=>{const t=T.get(e);return t?r.a.createElement(n.EuiText,{color:"subdued",size:"xs","data-test-subj":"policySupportedVersions"},r.a.createElement("i",null,r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyDetails.supportedVersion",defaultMessage:"Agent version {version}",values:{version:t}}))):null},C=r.a.memo((({protection:e,osList:t})=>{const a=Object(k.c)(S.l),l=Object(c.useDispatch)(),d=a&&a.windows[e].mode,p=a&&a.windows.popup[e].enabled,g=a&&a.windows.popup[e].message,b=Object(i.useCallback)((n=>{if(a){const i=Object(u.cloneDeep)(a);for(const a of t)("windows"===a||"mac"===a||"linux"===a)&&(i[a].popup[e].enabled=n.target.checked);l({type:"userChangedPolicyConfig",payload:{policyConfig:i}})}}),[a,l,e,t]),f=Object(i.useCallback)((n=>{if(a){const i=Object(u.cloneDeep)(a);for(const a of t)("windows"===a||"mac"===a||"linux"===a)&&(i[a].popup[e].message=n.target.value);l({type:"userChangedPolicyConfig",payload:{policyConfig:i}})}}),[a,l,e,t]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(n.EuiSpacer,{size:"m"}),r.a.createElement(h,null,r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyDetailsConfig.userNotification",defaultMessage:"User notification"})),r.a.createElement(I,{optionName:e}),r.a.createElement(n.EuiSpacer,{size:"s"}),r.a.createElement(n.EuiCheckbox,{"data-test-subj":`${e}UserNotificationCheckbox`,id:`${e}UserNotificationCheckbox}`,onChange:b,checked:p,disabled:d===m.e.off,label:o.i18n.translate("xpack.securitySolution.endpoint.policyDetail.notifyUser",{defaultMessage:"Notify user"})}),p&&r.a.createElement(r.a.Fragment,null,r.a.createElement(n.EuiSpacer,{size:"m"}),r.a.createElement(n.EuiFlexGroup,{gutterSize:"xs"},r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiText,{size:"s"},r.a.createElement("h4",null,r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyDetailsConfig.customizeUserNotification",defaultMessage:"Customize notification message"})))),r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiIconTip,{position:"right","data-test-subj":`${e}Tooltip`,content:r.a.createElement(r.a.Fragment,null,r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyDetailsConfig.notifyUserTooltip.a",defaultMessage:"Selecting the user notification option will display a notification to the host user when { protectionName } is prevented or detected.",values:{protectionName:(y=e,"memory_protection"===y?o.i18n.translate("xpack.securitySolution.endpoint.policyDetail.memoryProtectionTooltip",{defaultMessage:"memory threat"}):"behavior_protection"===y?o.i18n.translate("xpack.securitySolution.endpoint.policyDetail.behaviorProtectionTooltip",{defaultMessage:"malicious behavior"}):y)}}),r.a.createElement(n.EuiSpacer,{size:"m"}),r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyDetailsConfig.notifyUserTooltip.c",defaultMessage:" The user notification can be customized in the text box below. Bracketed tags can be used to dynamically populate the applicable action (such as prevented or detected) and the { bracketText }.",values:{bracketText:(t=>"memory_protection"===t||"behavior_protection"===e?o.i18n.translate("xpack.securitySolution.endpoint.policyDetail.rule",{defaultMessage:"rule"}):o.i18n.translate("xpack.securitySolution.endpoint.policyDetail.filename",{defaultMessage:"filename"}))(e)}}))}))),r.a.createElement(n.EuiSpacer,{size:"xs"}),r.a.createElement(n.EuiTextArea,{placeholder:o.i18n.translate("xpack.securitySolution.endpoint.policyDetails.userNotification.placeholder",{defaultMessage:"Input your custom notification message"}),value:g,onChange:f,fullWidth:!0,"data-test-subj":`${e}UserNotificationCustomMessage`})));var y}));C.displayName="UserNotification";const M=r.a.memo((({protection:e,protectionLabel:t,osList:a,additionalOnSwitchChange:s})=>{const l=Object(k.c)(S.l),d=Object(x.b)().isPlatinumPlus(),p=Object(c.useDispatch)(),g=l&&l.windows[e].mode,b=Object(i.useCallback)((t=>{if(l){const n=Object(u.cloneDeep)(l);if(!1===t.target.checked)for(const i of a)("windows"===i||"mac"===i||"linux"===i)&&(n[i][e].mode=m.e.off),d&&("windows"===i||"mac"===i||"linux"===i)&&(n[i].popup[e].enabled=t.target.checked);else for(const i of a)("windows"===i||"mac"===i||"linux"===i)&&(n[i][e].mode=m.e.prevent),d&&("windows"===i||"mac"===i||"linux"===i)&&(n[i].popup[e].enabled=t.target.checked);p(s?{type:"userChangedPolicyConfig",payload:{policyConfig:s({value:t.target.checked,policyConfigData:n,protectionOsList:a})}}:{type:"userChangedPolicyConfig",payload:{policyConfig:n}})}}),[p,l,d,e,a,s]);return r.a.createElement(n.EuiSwitch,{label:o.i18n.translate("xpack.securitySolution.endpoint.policy.details.protectionsEnabled",{defaultMessage:"{protectionLabel} {mode, select, true {enabled} false {disabled}}",values:{protectionLabel:t,mode:g!==m.e.off}}),checked:g!==m.e.off,onChange:b})}));M.displayName="ProtectionSwitch";const F=r.a.memo((()=>{const e=Object(i.useMemo)((()=>[m.d.windows,m.d.mac,m.d.linux]),[]),t="malware",a=o.i18n.translate("xpack.securitySolution.endpoint.policy.protections.malware",{defaultMessage:"Malware protections"}),g=o.i18n.translate("xpack.securitySolution.endpoint.policy.protections.blocklist",{defaultMessage:"Blocklist enabled"}),b=Object(x.b)().isPlatinumPlus(),f=Object(c.useDispatch)(),y=Object(k.c)(S.l),h=({value:e,policyConfigData:t,protectionOsList:a})=>{const n=Object(u.cloneDeep)(t);for(const t of a)n[t].malware.blocklist=e;return n},j=Object(i.useCallback)((t=>{if(y){const a=h({value:t.target.checked,policyConfigData:Object(u.cloneDeep)(y),protectionOsList:e});f({type:"userChangedPolicyConfig",payload:{policyConfig:a}})}}),[f,e,y]);return r.a.createElement(E,{type:o.i18n.translate("xpack.securitySolution.endpoint.policy.details.malware",{defaultMessage:"Malware"}),supportedOss:[l.c.WINDOWS,l.c.MAC,l.c.LINUX],dataTestSubj:"malwareProtectionsForm",rightCorner:r.a.createElement(M,{protection:t,protectionLabel:a,osList:e,additionalOnSwitchChange:h})},r.a.createElement(w,{protection:t,osList:e}),r.a.createElement(n.EuiSpacer,{size:"m"}),r.a.createElement(n.EuiFlexGroup,{gutterSize:"xs"},r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiSwitch,{label:g,checked:y.windows.malware.blocklist,onChange:j,disabled:"off"===y.windows.malware.mode})),r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiIconTip,{position:"right",content:r.a.createElement(r.a.Fragment,null,r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyDetailsConfig.blocklistTooltip",defaultMessage:"Enables or disables the blocklist associated with this policy. The blocklist is a collection hashes, paths, or signers which extends the list of processes the endpoint considers malicious. See the blocklist tab for entry details."}))}))),b&&r.a.createElement(C,{protection:t,osList:e}),r.a.createElement(n.EuiSpacer,{size:"m"}),r.a.createElement(n.EuiCallOut,{iconType:"iInCircle"},r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.detectionRulesMessage",defaultMessage:"View {detectionRulesLink}. Prebuilt rules are tagged “Elastic” on the Detection Rules page.",values:{detectionRulesLink:r.a.createElement(v.a,{appId:d.B,deepLinkId:p.a.rules},r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.detectionRulesLink",defaultMessage:"related detection rules"}))}})))}));F.displayName="MalwareProtections";const D=r.a.memo((()=>{const e=[m.d.windows,m.d.mac,m.d.linux],t="memory_protection",a=o.i18n.translate("xpack.securitySolution.endpoint.policy.protections.memory",{defaultMessage:"Memory threat protections"});return r.a.createElement(E,{type:o.i18n.translate("xpack.securitySolution.endpoint.policy.details.memory_protection",{defaultMessage:"Memory threat"}),supportedOss:[l.c.WINDOWS,l.c.MAC,l.c.LINUX],dataTestSubj:"memoryProtectionsForm",rightCorner:r.a.createElement(M,{protection:t,protectionLabel:a,osList:e})},r.a.createElement(w,{protection:t,osList:e}),r.a.createElement(C,{protection:t,osList:e}),r.a.createElement(n.EuiSpacer,{size:"m"}),r.a.createElement(n.EuiCallOut,{iconType:"iInCircle"},r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.detectionRulesMessage",defaultMessage:"View {detectionRulesLink}. Prebuilt rules are tagged “Elastic” on the Detection Rules page.",values:{detectionRulesLink:r.a.createElement(v.a,{appId:d.B,deepLinkId:p.a.rules},r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.detectionRulesLink",defaultMessage:"related detection rules"}))}})))}));D.displayName="MemoryProtection";const A=r.a.memo((()=>{const e=[m.d.windows,m.d.mac,m.d.linux],t="behavior_protection",a=o.i18n.translate("xpack.securitySolution.endpoint.policy.protections.behavior",{defaultMessage:"Malicious behavior protections"});return r.a.createElement(E,{type:o.i18n.translate("xpack.securitySolution.endpoint.policy.details.behavior_protection",{defaultMessage:"Malicious behavior"}),supportedOss:[l.c.WINDOWS,l.c.MAC,l.c.LINUX],dataTestSubj:"behaviorProtectionsForm",rightCorner:r.a.createElement(M,{protection:t,protectionLabel:a,osList:e})},r.a.createElement(w,{protection:t,osList:e}),r.a.createElement(C,{protection:t,osList:e}),r.a.createElement(n.EuiSpacer,{size:"m"}),r.a.createElement(n.EuiCallOut,{iconType:"iInCircle"},r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.detectionRulesMessage",defaultMessage:"View {detectionRulesLink}. Prebuilt rules are tagged “Elastic” on the Detection Rules page.",values:{detectionRulesLink:r.a.createElement(v.a,{appId:d.B,deepLinkId:p.a.rules},r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.detectionRulesLink",defaultMessage:"related detection rules"}))}})))}));A.displayName="BehaviorProtection";const _=e=>t=>a=>n=>i=>{const r=Object(u.cloneDeep)(e);return r[t][a][n]=i,r},N={[l.c.WINDOWS]:"Windows",[l.c.LINUX]:"Linux",[l.c.MAC]:"Mac"},R=({os:e,options:t,selection:a,onValueSelection:s,supplementalOptions:l})=>{const c=Object(k.c)(S.l),u=Object(i.useContext)(g.ThemeContext),d=Object(i.useCallback)((()=>{const e=l?l.map((e=>e.protectionField)):[];return Object.entries(a).filter((([t,a])=>!e.includes(t)&&a)).length}),[a,l]);return r.a.createElement(E,{type:o.i18n.translate("xpack.securitySolution.endpoint.policy.details.eventCollection",{defaultMessage:"Event collection"}),supportedOss:[e],rightCorner:r.a.createElement(n.EuiText,{size:"s",color:"subdued"},o.i18n.translate("xpack.securitySolution.endpoint.policy.details.eventCollectionsEnabled",{defaultMessage:"{selected} / {total} event collections enabled",values:{selected:d(),total:t.length}}))},r.a.createElement(h,null,o.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.eventingEvents",{defaultMessage:"Events"})),r.a.createElement(n.EuiSpacer,{size:"s"}),t.map((({name:t,protectionField:i})=>r.a.createElement(n.EuiCheckbox,{key:String(i),id:Object(n.htmlIdGenerator)()(),label:t,"data-test-subj":`policy${N[e]}Event_${i}`,checked:a[i],onChange:e=>s(i,e.target.checked)}))),l&&l.map((({title:t,description:i,name:o,protectionField:l,tooltipText:d,beta:p,indented:m,isDisabled:g})=>r.a.createElement("div",{key:String(l),style:m?{paddingLeft:u.eui.euiSizeL}:{}},t&&r.a.createElement(r.a.Fragment,null,r.a.createElement(n.EuiSpacer,{size:"m"}),r.a.createElement(h,null,t)),i&&r.a.createElement(r.a.Fragment,null,r.a.createElement(n.EuiSpacer,{size:"s"}),r.a.createElement(n.EuiText,{size:"xs",color:"subdued"},i)),r.a.createElement(n.EuiFlexGroup,{direction:"row",gutterSize:"xs",alignItems:"center"},r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiSpacer,{size:"s"}),r.a.createElement(n.EuiCheckbox,{id:Object(n.htmlIdGenerator)()(),label:o,"data-test-subj":`policy${N[e]}Event_${l}`,checked:a[l],onChange:e=>s(l,e.target.checked),disabled:!!g&&g(c)})),d&&r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiIconTip,{position:"right",content:d})),p&&r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiBetaBadge,{label:"beta",size:"s"})))))))};R.displayName="EventsForm";const P=r.a.memo(R),L=[{name:o.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.windows.events.dllDriverLoad",{defaultMessage:"DLL and Driver Load"}),protectionField:"dll_and_driver_load"},{name:o.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.windows.events.dns",{defaultMessage:"DNS"}),protectionField:"dns"},{name:o.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.windows.events.file",{defaultMessage:"File"}),protectionField:"file"},{name:o.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.windows.events.network",{defaultMessage:"Network"}),protectionField:"network"},{name:o.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.windows.events.process",{defaultMessage:"Process"}),protectionField:"process"},{name:o.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.windows.events.registry",{defaultMessage:"Registry"}),protectionField:"registry"},{name:o.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.windows.events.security",{defaultMessage:"Security"}),protectionField:"security"}],B=Object(i.memo)((()=>{const e=Object(k.c)(S.l),t=Object(c.useDispatch)();return r.a.createElement(P,{os:l.c.WINDOWS,selection:e.windows.events,options:L,onValueSelection:(a,n)=>t({type:"userChangedPolicyConfig",payload:{policyConfig:_(e)("windows")("events")(a)(n)}})})}));B.displayName="WindowsEvents";const q=[{name:o.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.mac.events.file",{defaultMessage:"File"}),protectionField:"file"},{name:o.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.mac.events.process",{defaultMessage:"Process"}),protectionField:"process"},{name:o.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.mac.events.network",{defaultMessage:"Network"}),protectionField:"network"}],z=Object(i.memo)((()=>{const e=Object(k.c)(S.l),t=Object(c.useDispatch)();return r.a.createElement(P,{os:l.c.MAC,selection:e.mac.events,options:q,onValueSelection:(a,n)=>t({type:"userChangedPolicyConfig",payload:{policyConfig:_(e)("mac")("events")(a)(n)}})})}));z.displayName="MacEvents";const $=[{name:o.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.linux.events.file",{defaultMessage:"File"}),protectionField:"file"},{name:o.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.linux.events.network",{defaultMessage:"Network"}),protectionField:"network"},{name:o.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.linux.events.process",{defaultMessage:"Process"}),protectionField:"process"}],V=[{title:o.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.linux.events.session_data.title",{defaultMessage:"Session data"}),description:o.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.linux.events.session_data.description",{defaultMessage:"Turn this on to capture the extended process data required for Session View. Session View provides you a visual representation of session and process execution data. Session View data is organized according to the Linux process model to help you investigate process, user, and service activity on your Linux infrastructure."}),name:o.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.linux.events.session_data",{defaultMessage:"Collect session data"}),protectionField:"session_data",isDisabled:e=>!e.linux.events.process},{name:o.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.linux.events.tty_io",{defaultMessage:"Capture terminal output"}),protectionField:"tty_io",tooltipText:o.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.linux.events.tty_io.tooltip",{defaultMessage:"Turn this on to collect terminal (tty) output. Terminal output appears in Session View, and you can view it separately to see what commands were executed and how they were typed, provided the terminal is in echo mode. Only works on hosts that support ebpf."}),indented:!0,isDisabled:e=>!e.linux.events.session_data,beta:!0}],U=Object(i.memo)((()=>{const e=Object(k.c)(S.l),t=Object(c.useDispatch)();return r.a.createElement(P,{os:l.c.LINUX,selection:e.linux.events,options:$,supplementalOptions:V,onValueSelection:(a,n)=>{let i=_(e)("linux")("events")(a)(n);"session_data"!==a||n||(i=_(i)("linux")("events")("tty_io")(!1)),t({type:"userChangedPolicyConfig",payload:{policyConfig:i}})}})}));U.displayName="LinuxEvents";var H=a(1071);const G={title:o.i18n.translate("xpack.securitySolution.endpoint.policy.details.antivirusRegistration.type",{defaultMessage:"Register as antivirus"}),description:o.i18n.translate("xpack.securitySolution.endpoint.policy.details.antivirusRegistration.explanation",{defaultMessage:"Toggle on to register Elastic as an official Antivirus solution for Windows OS. This will also disable Windows Defender."}),label:o.i18n.translate("xpack.securitySolution.endpoint.policy.details.antivirusRegistration.toggle",{defaultMessage:"Register as antivirus"})},Q=Object(i.memo)((()=>{const e=Object(k.c)(S.d),t=Object(c.useDispatch)(),a=Object(i.useCallback)((e=>t({type:"userChangedAntivirusRegistration",payload:{enabled:e.target.checked}})),[t]);return r.a.createElement(E,{type:G.title,supportedOss:[l.c.WINDOWS],osRestriction:o.i18n.translate("xpack.securitySolution.endpoint.policy.details.av.windowsServerNotSupported",{defaultMessage:"Windows Server operating systems unsupported"})},r.a.createElement(n.EuiText,{size:"s"},G.description),r.a.createElement(n.EuiSpacer,{size:"s"}),r.a.createElement(n.EuiSwitch,{label:G.label,checked:e,onChange:a}))}));Q.displayName="AntivirusRegistrationForm";const W={title:o.i18n.translate("xpack.securitySolution.endpoint.policy.details.attackSurfaceReduction.type",{defaultMessage:"Attack surface reduction"}),label:o.i18n.translate("xpack.securitySolution.endpoint.policy.details.credentialHardening.toggle",{defaultMessage:"Credential hardening"})},K=Object(i.memo)((()=>{const e=Object(k.c)(S.e),t=Object(c.useDispatch)(),a=Object(i.useCallback)((e=>t({type:"userChangedCredentialHardening",payload:{enabled:e.target.checked}})),[t]);return r.a.createElement(E,{type:W.title,supportedOss:[l.c.WINDOWS]},r.a.createElement(n.EuiSwitch,{label:W.label,checked:e,onChange:a}))}));K.displayName="AttackSurfaceReductionForm";const Y=r.a.memo((()=>{const e=[m.d.windows],t="ransomware",a=o.i18n.translate("xpack.securitySolution.endpoint.policy.protections.ransomware",{defaultMessage:"Ransomware protections"});return r.a.createElement(E,{type:o.i18n.translate("xpack.securitySolution.endpoint.policy.details.ransomware",{defaultMessage:"Ransomware"}),supportedOss:[l.c.WINDOWS],dataTestSubj:"ransomwareProtectionsForm",rightCorner:r.a.createElement(M,{protectionLabel:a,protection:t,osList:e})},r.a.createElement(w,{protection:t,osList:e}),r.a.createElement(C,{protection:t,osList:e}),r.a.createElement(n.EuiSpacer,{size:"m"}),r.a.createElement(n.EuiCallOut,{iconType:"iInCircle"},r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.detectionRulesMessage",defaultMessage:"View {detectionRulesLink}. Prebuilt rules are tagged “Elastic” on the Detection Rules page.",values:{detectionRulesLink:r.a.createElement(v.a,{appId:d.B,deepLinkId:p.a.rules},r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.detectionRulesLink",defaultMessage:"related detection rules"}))}})))}));Y.displayName="RansomwareProtections";const J=b.a.div.withConfig({displayName:"LockedPolicyDiv",componentId:"sc-pvk7p4-0"})([".euiCard__betaBadgeWrapper{.euiCard__betaBadge{width:auto;}}.lockedCardDescription{padding:0 ",";}"],(e=>e.theme.eui.fractions.thirds.percentage)),X=Object(i.memo)((({title:e})=>r.a.createElement(J,null,r.a.createElement(n.EuiCard,{"data-test-subj":"lockedPolicyCard",betaBadgeProps:{label:o.i18n.translate("xpack.securitySolution.endpoint.policy.details.platinum",{defaultMessage:"Platinum"})},isDisabled:!0,icon:r.a.createElement(n.EuiIcon,{size:"xl",type:"lock"}),title:r.a.createElement("h3",null,r.a.createElement("strong",null,e)),description:!1},r.a.createElement(n.EuiFlexGroup,{className:"lockedCardDescription",direction:"column",gutterSize:"none"},r.a.createElement(n.EuiText,null,r.a.createElement(n.EuiFlexItem,null,r.a.createElement("h4",null,r.a.createElement(n.EuiTextColor,{color:"subdued"},r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.upgradeToPlatinum",defaultMessage:"Upgrade to Elastic Platinum"})))),r.a.createElement(n.EuiFlexItem,null,r.a.createElement("p",null,r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.lockedCardUpgradeMessage",defaultMessage:"To turn on this protection, you must upgrade your license to Platinum, start a free 30-day trial, or spin up a {cloudDeploymentLink} on AWS, GCP, or Azure.",values:{cloudDeploymentLink:r.a.createElement(n.EuiLink,{href:"https://www.elastic.co/cloud/",target:"_blank"},r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.cloudDeploymentLInk",defaultMessage:"cloud deployment"}))}})))))))));X.displayName="LockedPolicyCard";const Z=o.i18n.translate("xpack.securitySolution.endpoint.policy.details.ransomware",{defaultMessage:"Ransomware"}),ee=o.i18n.translate("xpack.securitySolution.endpoint.policy.details.memory",{defaultMessage:"Memory Threat"}),te=o.i18n.translate("xpack.securitySolution.endpoint.policy.details.behavior",{defaultMessage:"Malicious Behavior"}),ae=o.i18n.translate("xpack.securitySolution.endpoint.policy.details.attack_surface_reduction",{defaultMessage:"Attack Surface Reduction"}),ne=Object(i.memo)((()=>{const[e,t]=Object(i.useState)(!1),a=Object(i.useCallback)((()=>{t(!e)}),[e]),o=Object(x.b)().isPlatinumPlus();return r.a.createElement(r.a.Fragment,null,r.a.createElement(n.EuiText,{size:"xs",color:"subdued"},r.a.createElement("h4",null,r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.protections",defaultMessage:"Protections"}))),r.a.createElement(n.EuiSpacer,{size:"s"}),r.a.createElement(F,null),r.a.createElement(n.EuiSpacer,{size:"l"}),o?r.a.createElement(Y,null):r.a.createElement(X,{title:Z}),r.a.createElement(n.EuiSpacer,{size:"l"}),o?r.a.createElement(D,null):r.a.createElement(X,{title:ee}),r.a.createElement(n.EuiSpacer,{size:"l"}),o?r.a.createElement(A,null):r.a.createElement(X,{title:te}),r.a.createElement(n.EuiSpacer,{size:"l"}),o?r.a.createElement(K,null):r.a.createElement(X,{title:ae}),r.a.createElement(n.EuiSpacer,{size:"l"}),r.a.createElement(n.EuiText,{size:"xs",color:"subdued"},r.a.createElement("h4",null,r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.settings",defaultMessage:"Settings"}))),r.a.createElement(n.EuiSpacer,{size:"s"}),r.a.createElement(B,null),r.a.createElement(n.EuiSpacer,{size:"l"}),r.a.createElement(z,null),r.a.createElement(n.EuiSpacer,{size:"l"}),r.a.createElement(U,null),r.a.createElement(n.EuiSpacer,{size:"l"}),r.a.createElement(Q,null),r.a.createElement(n.EuiSpacer,{size:"m"}),r.a.createElement(n.EuiButtonEmpty,{"data-test-subj":"advancedPolicyButton",onClick:a},r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.advanced.show",defaultMessage:"{action} advanced settings",values:{action:e?"Hide":"Show"}})),r.a.createElement(n.EuiSpacer,{size:"l"}),e&&r.a.createElement(H.a,{isPlatinumPlus:o}))}));ne.displayName="PolicyDetailsForm"},,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return F}));var n=a(4),i=a.n(n),r=a(32),s=a(35),o=a(77),l=a(101),c=a(39),u=a(226),d=a(33),p=a.n(d),m=a(142),g=a(6),b=a.n(g),f=a(0);const y=Object.freeze(new Map([["logging",f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.logging",{defaultMessage:"Logging"})],["streaming",f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.streaming",{defaultMessage:"Streaming"})],["malware",f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.malware",{defaultMessage:"Malware"})],["events",f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.events",{defaultMessage:"Events"})],["memory_protection",f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.memory_protection",{defaultMessage:"Memory Threat"})],["behavior_protection",f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.behavior_protection",{defaultMessage:"Malicious Behavior"})]])),h=Object.freeze(new Map([["configure_dns_events",f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_dns_events",{defaultMessage:"Configure DNS Events"})],["configure_elasticsearch_connection",f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_elasticsearch_connection",{defaultMessage:"Configure Elasticsearch Connection"})],["configure_file_events",f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_file_events",{defaultMessage:"Configure File Events"})],["configure_imageload_events",f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_imageload_events",{defaultMessage:"Configure Image Load Events"})],["configure_kernel",f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_kernel",{defaultMessage:"Configure Kernel"})],["configure_logging",f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_logging",{defaultMessage:"Configure Logging"})],["configure_malware",f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_malware",{defaultMessage:"Configure Malware"})],["configure_network_events",f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_network_events",{defaultMessage:"Configure Network Events"})],["configure_process_events",f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_process_events",{defaultMessage:"Configure Process Events"})],["configure_registry_events",f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_registry_events",{defaultMessage:"Configure Registry Events"})],["configure_security_events",f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.configure_security_events",{defaultMessage:"Configure Security Events"})],["connect_kernel",f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.connect_kernel",{defaultMessage:"Connect Kernel"})],["detect_async_image_load_events",f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.detect_async_image_load_events",{defaultMessage:"Detect Async Image Load Events"})],["detect_file_open_events",f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.detect_file_open_events",{defaultMessage:"Detect File Open Events"})],["detect_file_write_events",f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.detect_file_write_events",{defaultMessage:"Detect File Write Events"})],["detect_network_events",f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.detect_network_events",{defaultMessage:"Detect Network Events"})],["detect_process_events",f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.detect_process_events",{defaultMessage:"Detect Process Events"})],["detect_registry_events",f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.detect_registry_events",{defaultMessage:"Detect Registry Events"})],["detect_sync_image_load_events",f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.detect_sync_image_load_events",{defaultMessage:"Detect Sync Image Load Events"})],["download_global_artifacts",f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.download_global_artifacts",{defaultMessage:"Download Global Artifacts"})],["download_user_artifacts",f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.download_user_artifacts",{defaultMessage:"Download User Artifacts"})],["load_config",f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.load_config",{defaultMessage:"Load Config"})],["load_malware_model",f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.load_malware_model",{defaultMessage:"Load Malware Model"})],["read_elasticsearch_config",f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.read_elasticsearch_config",{defaultMessage:"Read Elasticsearch Config"})],["read_events_config",f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.read_events_config",{defaultMessage:"Read Events Config"})],["read_kernel_config",f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.read_kernel_config",{defaultMessage:"Read Kernel Config"})],["read_logging_config",f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.read_logging_config",{defaultMessage:"Read Logging Config"})],["read_malware_config",f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.read_malware_config",{defaultMessage:"Read Malware Config"})],["workflow",f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.workflow",{defaultMessage:"Workflow"})],["full_disk_access",f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.full_disk_access",{defaultMessage:"Full Disk Access"})],["macos_system_ext",f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.macos_system_ext",{defaultMessage:"Permissions required"})],["linux_deadlock",f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.linux_deadlock",{defaultMessage:"Disabled to avoid potential system deadlock"})]])),E=Object.freeze(new Map([[m.a.success,f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.success",{defaultMessage:"Success"})],[m.a.warning,f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.warning",{defaultMessage:"Warning"})],[m.a.failure,f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.failed",{defaultMessage:"Failed"})],[m.a.unsupported,f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.unsupported",{defaultMessage:"Unsupported"})]])),v=Object.freeze(new Map([["full_disk_access",f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.description.full_disk_access",{defaultMessage:"You must enable full disk access for Elastic Endpoint on your machine."})],["macos_system_ext",f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.description.macos_system_ext",{defaultMessage:"You must enable the Mac system extension for Elastic Endpoint on your machine."})],["linux_deadlock",f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.description.linux_deadlock",{defaultMessage:"Malware protection was disabled to avoid a potential system deadlock. To resolve this issue, the file systems causing this need to be identified in integration policy advanced settings (linux.advanced.fanotify.ignored_filesystems). Learn more in our"})]])),x=Object.freeze(new Map([["full_disk_access",f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.link.text.full_disk_access",{defaultMessage:" Learn more."})],["macos_system_ext",f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.link.text.macos_system_ext",{defaultMessage:" Learn more."})],["linux_deadlock",f.i18n.translate("xpack.securitySolution.endpoint.details.policyResponse.link.text.linux_deadlock",{defaultMessage:" troubleshooting docs."})]])),k=new Set(["load_malware_model","configure_malware"]);function S(e,t){return"macos"===e&&"connect_kernel"===t.name&&t.status===m.a.failure}function j(e,t){return"linux"===e&&k.has(t.name)&&"Disabled due to potential system deadlock"===t.message}class policy_response_friendly_names_PolicyResponseActionFormatter{constructor(e,t,a=""){var n;b()(this,"key",void 0),b()(this,"title",void 0),b()(this,"description",void 0),b()(this,"hasError",void 0),b()(this,"errorTitle",void 0),b()(this,"errorDescription",void 0),b()(this,"status",void 0),b()(this,"linkText",void 0),this.policyResponseAppliedAction=e,this.docLinks=t,this.os=a,this.key=e.name,this.title=null!==(n=h.get(this.errorKey||this.key))&&void 0!==n?n:this.key.replace(/_/g," ").replace(/\b(\w)/g,(e=>e.toUpperCase())),this.hasError=e.status===m.a.failure||e.status===m.a.warning,this.description=v.get(this.key)||e.message,this.errorDescription=v.get(this.errorKey||this.key)||this.policyResponseAppliedAction.message,this.errorTitle=this.errorDescription?this.title:e.name,this.status=E.get(e.status),this.linkText=x.get(this.errorKey||this.key)}get linkUrl(){return this.docLinks[this.errorKey]}get isGeneric(){return e=this.os,t=this.policyResponseAppliedAction,!!("macos"===e&&"full_disk_access"===t.name||S(this.os,this.policyResponseAppliedAction)||j(this.os,this.policyResponseAppliedAction));var e,t}get errorKey(){return S(this.os,this.policyResponseAppliedAction)?"macos_system_ext":j(this.os,this.policyResponseAppliedAction)?"linux_deadlock":this.policyResponseAppliedAction.name}}const O=p()(r.EuiCallOut).withConfig({displayName:"StyledEuiCallout",componentId:"sc-15759fc-0"})(["padding:",";"],(({theme:e})=>e.eui.euiSizeS)),w=p()(r.EuiText).withConfig({displayName:"StyledEuiText",componentId:"sc-15759fc-1"})(["white-space:break-spaces;text-align:left;line-height:inherit;"]),T=Object(n.memo)((({policyResponseActionFormatter:e})=>e.hasError?i.a.createElement(O,{title:e.errorTitle,color:"danger",iconType:"alert","data-test-subj":"endpointPolicyResponseErrorCallOut"},i.a.createElement(w,{size:"s","data-test-subj":"endpointPolicyResponseMessage"},e.errorDescription,e.linkText&&e.linkUrl&&i.a.createElement(r.EuiLink,{target:"_blank",href:e.linkUrl,"data-test-subj":"endpointPolicyResponseErrorCallOutLink"},e.linkText))):i.a.createElement(w,{size:"xs","data-test-subj":"endpointPolicyResponseMessage"},e.description||e.title)));T.displayName="PolicyResponseActionItem";const I=p()(r.EuiTreeView).withConfig({displayName:"StyledEuiTreeView",componentId:"sc-a7dddx-0"})([".policy-response-action-item-expanded{height:auto;padding-top:",";padding-bottom:",";.euiTreeView__nodeLabel{width:100%;}}.policyResponseStatusHealth{padding-top:5px;}.euiTreeView__node--expanded{max-height:none !important;.policy-response-action-expanded + div{.euiTreeView__node{max-height:none !important;}}}.euiTreeView__node{max-height:none !important;.euiNotificationBadge{margin-right:5px;}.euiTreeView__nodeLabel{.euiText{font-size:",";}}}"],(({theme:e})=>e.eui.euiSizeS),(({theme:e})=>e.eui.euiSizeS),(({theme:e})=>e.eui.euiFontSize)),C=Object(n.memo)((({hostOs:e,policyResponseConfig:t,policyResponseActions:a,policyResponseAttentionCount:l})=>{const{docLinks:c}=Object(o.k)().services,u=Object(n.useCallback)(((e,t)=>e===m.a.success?i.a.createElement(r.EuiHealth,{color:"success","data-test-subj":"endpointPolicyResponseStatusSuccessHealth",className:"policyResponseStatusHealth"}):e===m.a.unsupported?i.a.createElement(r.EuiHealth,{color:"subdued","data-test-subj":"endpointPolicyResponseStatusSuccessHealth",className:"policyResponseStatusHealth"}):i.a.createElement(r.EuiNotificationBadge,{"data-test-subj":"endpointPolicyResponseStatusAttentionHealth"},t)),[]),d=Object(n.useCallback)((t=>t.map((t=>{const n=a.find((e=>e.name===t)),s=new policy_response_friendly_names_PolicyResponseActionFormatter(n||{},c.links.securitySolution.policyResponseTroubleshooting,e);return{label:i.a.createElement(r.EuiText,{color:n.status!==m.a.success&&n.status!==m.a.unsupported?"danger":"default","data-test-subj":"endpointPolicyResponseAction"},s.title),id:t,className:n.status!==m.a.success&&n.status!==m.a.unsupported?"policy-response-action-expanded":"",icon:u(n.status,n.status!==m.a.success?1:0),children:[{label:i.a.createElement(T,{policyResponseActionFormatter:s}),id:`action_message_${t}`,isExpanded:!0,className:"policy-response-action-item-expanded"}]}}))),[c.links.securitySolution.policyResponseTroubleshooting,u,a,e]),p=Object(n.useCallback)((()=>Object.entries(t).map((([e,t])=>{const a=l.get(e);return{label:i.a.createElement(r.EuiText,{color:a?"danger":"default",size:"s","data-test-subj":"endpointPolicyResponseConfig"},(n=e,y.has(n)||y.set(n,n.replace(/_/g," ").replace(/\b(\w)/g,(e=>e.toUpperCase()))),y.get(n))),id:e,icon:a?i.a.createElement(r.EuiNotificationBadge,{"data-test-subj":"endpointPolicyResponseStatusAttentionHealth"},a):i.a.createElement(r.EuiHealth,{color:"success","data-test-subj":"endpointPolicyResponseStatusSuccessHealth",className:"policyResponseStatusHealth"}),children:d(t.concerned_actions)};var n}))),[d,l,t]),g=Object(n.useCallback)((()=>{let e=0;for(const t of l.values())e+=t;return[{label:i.a.createElement(r.EuiText,{color:e?"danger":"default",size:"s","data-test-subj":"endpointPolicyResponseTitle"},i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyResponse.title",defaultMessage:"Policy Response"})),id:"policyResponse",icon:e?i.a.createElement(r.EuiNotificationBadge,{"data-test-subj":"endpointPolicyResponseStatusHealth"},e):void 0,children:p()}]}),[p,l])();return i.a.createElement(I,{items:g,showExpansionArrows:!0,"aria-label":"policyResponseTreeView","aria-labelledby":"policyResponseTreeView"})}));C.displayName="PolicyResponse";var M=a(691);const F=Object(n.memo)((({endpointId:e,showRevisionMessage:t=!0,onShowNeedsAttentionBadge:a})=>{var d,p,g;const{data:b,isLoading:f,isFetching:y,isError:h}=function(e,t){const a=Object(o.j)();return Object(c.useQuery)(["getEndpointPolicyResponse",e],(()=>a.get(u.e,{query:{agentId:e}})),void 0)}(e),{data:E}=Object(M.b)(e),{docLinks:v}=Object(o.k)().services,[x,k]=Object(n.useState)(),[S,j]=Object(n.useState)(),[O,w]=Object(n.useState)(new Map);Object(n.useEffect)((()=>{!b||f||y||h||(k(b.policy_response.Endpoint.policy.applied.response.configurations),j(b.policy_response.Endpoint.policy.applied.actions),w((e=>{var t;const a=new Map;return void 0!==(null==e||null===(t=e.response)||void 0===t?void 0:t.configurations)&&void 0!==(null==e?void 0:e.actions)&&Object.entries(e.response.configurations).map((([t,n])=>{let i=0;for(const t of n.concerned_actions){var r;const a=null===(r=e.actions.find((e=>e.name===t)))||void 0===r?void 0:r.status;a!==m.a.failure&&a!==m.a.warning||(i+=1)}return a.set(t,i)})),a})(b.policy_response.Endpoint.policy.applied)))}),[b,f,y,h]),Object(n.useEffect)((()=>{if(a)for(const e of O.values())if(e)return void a(!0)}),[O,a]);const I=Object(n.useMemo)((()=>x||S?null==S?void 0:S.reduce(((e,t)=>{const a=new policy_response_friendly_names_PolicyResponseActionFormatter(t,v.links.securitySolution.policyResponseTroubleshooting,null==E?void 0:E.metadata.host.os.name.toLowerCase());return a.isGeneric&&a.hasError&&e.push(a),e}),[]):[]),[v.links.securitySolution.policyResponseTroubleshooting,S,x,null==E?void 0:E.metadata.host.os.name]);return i.a.createElement(i.a.Fragment,null,t&&i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiText,{size:"xs",color:"subdued","data-test-subj":"endpointPolicyResponseTimestamp"},i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyResponse.appliedOn",defaultMessage:"Revision {rev} applied on {date}",values:{rev:null!==(d=null==b?void 0:b.policy_response.Endpoint.policy.applied.endpoint_policy_version)&&void 0!==d?d:"",date:i.a.createElement(l.d,{value:null!==(p=null==b?void 0:b.policy_response["@timestamp"])&&void 0!==p?p:""})}})),i.a.createElement(r.EuiSpacer,{size:"s"})),h&&i.a.createElement(r.EuiEmptyPrompt,{title:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.details.noPolicyResponse",defaultMessage:"No policy response available"})}),f&&i.a.createElement(r.EuiLoadingSpinner,{size:"m"}),void 0!==x&&void 0!==S&&i.a.createElement(i.a.Fragment,null,i.a.createElement(C,{hostOs:null!==(g=null==E?void 0:E.metadata.host.os.name.toLowerCase())&&void 0!==g?g:"",policyResponseConfig:x,policyResponseActions:S,policyResponseAttentionCount:O}),i.a.createElement(r.EuiSpacer,{size:"m"}),null==I?void 0:I.map((e=>i.a.createElement(i.a.Fragment,{key:e.key},i.a.createElement(T,{policyResponseActionFormatter:e}),i.a.createElement(r.EuiSpacer,{size:"m"}))))))}));F.displayName="PolicyResponse"},function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(295),i=a(1069),r=a(105),s=a(280),o=a(588);const l=()=>({hosts:[],pageSize:10,pageIndex:0,total:0,loading:!1,error:void 0,endpointDetails:{hostDetails:{details:void 0,detailsLoading:!1,detailsError:void 0}},policyResponse:void 0,policyResponseLoading:!1,policyResponseError:void 0,location:void 0,policyItems:[],selectedPolicyId:void 0,policyItemsLoading:!1,endpointPackageInfo:Object(o.e)(),nonExistingPolicies:{},agentPolicies:{},endpointsExist:!0,patterns:[],patternsError:void 0,isAutoRefreshEnabled:!0,autoRefreshInterval:r.a,agentsWithEndpointsTotal:0,agentsWithEndpointsTotalError:void 0,endpointsTotal:0,endpointsTotalError:void 0,policyVersionInfo:void 0,hostStatus:void 0,isolationRequestState:Object(o.e)(),endpointPendingActions:Object(o.c)(new Map),metadataTransformStats:Object(o.e)()}),c=n.combineReducers,u=(r.v,Object(i.a)(),r.t,l(),c({[r.v]:i.c,[r.t]:(e=l(),t)=>{if("serverReturnedEndpointList"===t.type){const{data:a,total:n,page:i,pageSize:r}=t.payload;return{...e,hosts:a,total:n,pageIndex:i,pageSize:r,loading:!1,error:void 0}}if("serverFailedToReturnEndpointList"===t.type)return{...e,error:t.payload,loading:!1};if("serverReturnedEndpointNonExistingPolicies"===t.type)return{...e,nonExistingPolicies:{...e.nonExistingPolicies,...t.payload}};if("serverReturnedEndpointAgentPolicies"===t.type)return{...e,agentPolicies:{...e.agentPolicies,...t.payload}};if("serverReturnedMetadataPatterns"===t.type)return{...e,patterns:t.payload,patternsError:void 0};if("serverFailedToReturnMetadataPatterns"===t.type)return{...e,patternsError:t.payload};if("serverReturnedEndpointDetails"===t.type)return{...e,endpointDetails:{...e.endpointDetails,hostDetails:{...e.endpointDetails.hostDetails,details:t.payload.metadata,detailsLoading:!1,detailsError:void 0}},policyVersionInfo:t.payload.policy_info,hostStatus:t.payload.host_status};if("serverFailedToReturnEndpointDetails"===t.type)return{...e,endpointDetails:{...e.endpointDetails,hostDetails:{...e.endpointDetails.hostDetails,detailsError:t.payload,detailsLoading:!1}}};if("endpointPendingActionsStateChanged"===t.type)return((e,t)=>Object(s.isOnEndpointPage)(e)?{...e,endpointPendingActions:t.payload}:e)(e,t);if("serverReturnedPoliciesForOnboarding"===t.type)return{...e,policyItems:t.payload.policyItems,policyItemsLoading:!1};if("serverFailedToReturnPoliciesForOnboarding"===t.type)return{...e,error:t.payload,policyItemsLoading:!1};if("serverReturnedEndpointPolicyResponse"===t.type)return{...e,policyResponse:t.payload.policy_response,policyResponseLoading:!1,policyResponseError:void 0};if("serverFailedToReturnEndpointPolicyResponse"===t.type)return{...e,policyResponseError:t.payload,policyResponseLoading:!1};if("userSelectedEndpointPolicy"===t.type)return{...e,selectedPolicyId:t.payload.selectedPolicyId,policyResponseLoading:!1};if("serverCancelledEndpointListLoading"===t.type)return{...e,loading:!1};if("serverCancelledPolicyItemsLoading"===t.type)return{...e,policyItemsLoading:!1};if("endpointPackageInfoStateChanged"===t.type)return((e,t)=>({...e,endpointPackageInfo:t.payload}))(e,t);if("serverReturnedEndpointExistValue"===t.type)return{...e,endpointsExist:t.payload};if("serverReturnedAgenstWithEndpointsTotal"===t.type)return{...e,agentsWithEndpointsTotal:t.payload,agentsWithEndpointsTotalError:void 0};if("serverFailedToReturnAgenstWithEndpointsTotal"===t.type)return{...e,agentsWithEndpointsTotalError:t.payload};if("serverReturnedEndpointsTotal"===t.type)return{...e,endpointsTotal:t.payload,endpointsTotalError:void 0};if("serverFailedToReturnEndpointsTotal"===t.type)return{...e,endpointsTotalError:t.payload};var a,n;if("userUpdatedEndpointListRefreshOptions"===t.type)return{...e,isAutoRefreshEnabled:null!==(a=t.payload.isAutoRefreshEnabled)&&void 0!==a?a:e.isAutoRefreshEnabled,autoRefreshInterval:null!==(n=t.payload.autoRefreshInterval)&&void 0!==n?n:e.autoRefreshInterval};if("endpointIsolationRequestStateChange"===t.type)return((e,t)=>({...e,isolationRequestState:t.payload}))(e,t);if("userChangedUrl"===t.type){const a={...e,location:t.payload},n=Object(s.isOnEndpointPage)(a)&&!Object(s.hasSelectedEndpoint)(a),i=Object(s.isOnEndpointPage)(e)&&!Object(s.hasSelectedEndpoint)(e),r=Object(s.isOnEndpointPage)(a)&&Object(s.hasSelectedEndpoint)(a),l=Object(s.isOnEndpointPage)(e)&&Object(s.hasSelectedEndpoint)(e),c=Object(s.isOnEndpointPage)(e)&&Object(s.hasSelectedEndpoint)(e)&&Object(s.getIsOnEndpointDetailsActivityLog)(e),u=Object(s.isOnEndpointPage)(a)&&Object(s.hasSelectedEndpoint)(a)&&Object(s.getIsOnEndpointDetailsActivityLog)(a)||c&&Object(s.uiQueryParams)(e).selected_endpoint===Object(s.uiQueryParams)(a).selected_endpoint,d={location:t.payload,error:void 0,policyResponseError:void 0};if("isolate"===Object(s.uiQueryParams)(a).show||Object(o.i)(Object(s.getCurrentIsolationRequestState)(a))||(d.isolationRequestState=Object(o.e)()),n){if(!i)return{...e,...d,endpointDetails:{...e.endpointDetails,hostDetails:{...e.endpointDetails.hostDetails,detailsError:void 0}},loading:!0,policyItemsLoading:!0}}else if(r)return l||i?{...e,...d,endpointDetails:{...e.endpointDetails,hostDetails:{...e.endpointDetails.hostDetails,detailsLoading:!u,detailsError:void 0}},detailsLoading:!0,policyResponseLoading:!0}:{...e,...d,endpointDetails:{...e.endpointDetails,hostDetails:{...e.endpointDetails.hostDetails,detailsLoading:!0,detailsError:void 0}},loading:!0,policyResponseLoading:!0,policyItemsLoading:!0};return{...e,...d,endpointDetails:{...e.endpointDetails,hostDetails:{...e.endpointDetails.hostDetails,detailsError:void 0}},endpointsExist:!0}}return"metadataTransformStatsChanged"===t.type?((e,t)=>({...e,metadataTransformStats:t.payload}))(e,t):e}}))},function(e,t,a){"use strict";a.d(t,"a",(function(){return O}));var n=a(98),i=a(105),r=a(1069),s=a(363),o=a.n(s),l=a(226),c=a(740),u=a(918),d=a(547),p=a(687),m=a(588),g=a(373),b=a(280);const f=console.error,y=(e,t)=>{async function a(e){var a;const n=null!==(a=Object(b.endpointPackageVersion)(e))&&void 0!==a?a:"",i=n.includes("-")?n.substring(0,n.indexOf("-")):n,r=o()(i,"1.2.0")?l.o:l.r,{indexPatterns:s}=t.data;return[{title:r,fields:await s.getFieldsForWildcard({pattern:r})}]}return t=>n=>async i=>{n(i);const{getState:r,dispatch:s}=t;if(await async function(e,t,a){if(Object(b.getIsEndpointPackageInfoUninitialized)(e)){t({type:"endpointPackageInfoStateChanged",payload:Object(m.d)(Object(m.a)(Object(b.endpointPackageInfo)(e)))});try{const e=await Object(g.d)(a.http);t({type:"endpointPackageInfoStateChanged",payload:Object(m.c)(e)})}catch(e){f(e),t({type:"endpointPackageInfoStateChanged",payload:Object(m.b)(e)})}}}(r(),s,e),"userChangedUrl"!==i.type&&"appRequestedEndpointList"!==i.type||!Object(b.isOnEndpointPage)(r())||Object(b.hasSelectedEndpoint)(r())||await async function({store:e,coreStart:t,fetchIndexPatterns:a}){const{getState:n,dispatch:i}=e,{page_index:r,page_size:s}=Object(b.uiQueryParams)(n());let o;try{const a=Object(b.searchBarQuery)(n());o=await t.http.get(l.k,{query:{page:r,pageSize:s,kuery:a.query}}),i({type:"serverReturnedEndpointList",payload:o}),x(e);try{i({type:"serverReturnedEndpointsTotal",payload:await E(t.http)})}catch(e){i({type:"serverFailedToReturnEndpointsTotal",payload:e})}try{i({type:"serverReturnedAgenstWithEndpointsTotal",payload:(await Object(g.f)(t.http)).total})}catch(e){i({type:"serverFailedToReturnAgenstWithEndpointsTotal",payload:e})}S({http:t.http,hosts:o.data,store:e})}catch(e){i({type:"serverFailedToReturnEndpointList",payload:e})}if(0===Object(b.patterns)(n()).length)try{const e=await a(n());void 0!==e&&i({type:"serverReturnedMetadataPatterns",payload:e})}catch(e){i({type:"serverFailedToReturnMetadataPatterns",payload:e})}if(o&&0===o.data.length){const e=t.http;if(await(async e=>{try{return await E(e)>0}catch(e){f("error while trying to check if endpoints exist"),f(e)}return!1})(e))return;i({type:"serverReturnedEndpointExistValue",payload:!1});try{i({type:"serverReturnedPoliciesForOnboarding",payload:{policyItems:(await Object(p.a)(e,{query:{perPage:50,page:1}})).items}})}catch(e){var c;i({type:"serverFailedToReturnPoliciesForOnboarding",payload:null!==(c=e.body)&&void 0!==c?c:e})}}else i({type:"serverCancelledPolicyItemsLoading"}),i({type:"serverReturnedEndpointExistValue",payload:!0})}({coreStart:e,store:t,fetchIndexPatterns:a}),"userChangedUrl"===i.type&&Object(b.hasSelectedEndpoint)(r())){const{selected_endpoint:a}=Object(b.uiQueryParams)(r());await async function({coreStart:e,selectedEndpoint:t,store:a}){const{getState:n,dispatch:i}=a;if(i({type:"serverCancelledPolicyItemsLoading"}),0===Object(b.listData)(n()).length){const{page_index:t,page_size:r}=Object(b.uiQueryParams)(n());try{const n=await e.http.get(l.k,{query:{page:t,pageSize:r}});i({type:"serverReturnedEndpointList",payload:n}),S({http:e.http,hosts:n.data,store:a})}catch(e){i({type:"serverFailedToReturnEndpointList",payload:e})}}else i({type:"serverCancelledEndpointListLoading"});void 0!==t&&await k({store:a,coreStart:e,selectedEndpoint:t})}({store:t,coreStart:e,selectedEndpoint:a})}return"endpointDetailsLoad"===i.type&&await k({store:t,coreStart:e,selectedEndpoint:i.payload.endpointId}),"endpointIsolationRequest"===i.type?v(t,i):"loadMetadataTransformStats"===i.type?async function(e,t){const{getState:a,dispatch:n}=t;if(!e||!a||!n)return;const i=a();if(!Object(b.isMetadataTransformStatsLoading)(i)){n({type:"metadataTransformStatsChanged",payload:Object(m.d)(Object(m.a)(Object(b.getMetadataTransformStats)(i)))});try{const t=await e.get(l.n);n({type:"metadataTransformStatsChanged",payload:Object(m.c)(t.transforms)})}catch(e){n({type:"metadataTransformStatsChanged",payload:Object(m.b)(e)})}}}(e.http,t):void 0}},h=async(e,t,a)=>{if(0===t.length)return;const n=[...new Set(t.reduce(((e,t)=>{const n=t.metadata.Endpoint.policy.applied.id;return a[n]||e.push(n),e}),[]))];if(0===n.length)return;const i=(await Object(g.c)(e,n)).items.reduce(((e,t)=>(e.packagePolicy[t.id]=!0,e.agentPolicy[t.id]=t.policy_id,e)),{packagePolicy:{},agentPolicy:{}}),r=n.reduce(((e,t)=>i.packagePolicy[t]?(e.agentPolicy[t]=i.agentPolicy[t],e):(e.packagePolicy[t]=!0,e)),{packagePolicy:{},agentPolicy:{}});return 0!==Object.keys(r.packagePolicy).length||0!==Object.keys(r.agentPolicy).length?r:void 0},E=async e=>{try{return(await e.get(l.k,{query:{page:0,pageSize:1}})).total}catch(e){f("error while trying to check for total endpoints"),f(e)}return 0},v=async({getState:e,dispatch:t},a)=>{const n=e();if(!Object(b.getIsIsolationRequestPending)(n)){t({type:"endpointIsolationRequestStateChange",payload:Object(m.d)(Object(m.a)(Object(b.getCurrentIsolationRequestState)(n)))});try{let e;e="unisolate"===a.payload.type?await Object(c.b)(a.payload.data):await Object(c.a)(a.payload.data),t({type:"endpointIsolationRequestStateChange",payload:Object(m.c)(e)})}catch(e){var i;t({type:"endpointIsolationRequestStateChange",payload:Object(m.b)(null!==(i=e.body)&&void 0!==i?i:e)})}}},x=async({getState:e,dispatch:t})=>{const a=e(),n=Object(b.detailsData)(a),i=Object(b.listData)(a),r=new Set;n&&r.add(n.elastic.agent.id);for(const e of i)r.add(e.metadata.elastic.agent.id);if(0!==r.size)try{const{data:e}=await Object(u.a)(Array.from(r)),a=new Map;for(const t of e)a.set(t.agent_id,t.pending_actions);t({type:"endpointPendingActionsStateChanged",payload:Object(m.c)(a)})}catch(e){f(e)}};async function k({selectedEndpoint:e,store:t,coreStart:a}){const{getState:n,dispatch:i}=t;try{const t=await a.http.get(Object(d.a)(l.j,{id:e}));i({type:"serverReturnedEndpointDetails",payload:t});try{const e=await h(a.http,[t],Object(b.nonExistingPolicies)(n()));void 0!==e&&i({type:"serverReturnedEndpointNonExistingPolicies",payload:e.packagePolicy}),void 0!==(null==e?void 0:e.agentPolicy)&&i({type:"serverReturnedEndpointAgentPolicies",payload:e.agentPolicy})}catch(e){f(e)}}catch(e){i({type:"serverFailedToReturnEndpointDetails",payload:e})}x(t);try{i({type:"serverReturnedEndpointPolicyResponse",payload:await a.http.get(l.e,{query:{agentId:e}})})}catch(e){i({type:"serverFailedToReturnEndpointPolicyResponse",payload:e})}}async function S({store:e,hosts:t,http:a}){const{getState:n,dispatch:i}=e;try{const e=await h(a,t,Object(b.nonExistingPolicies)(n()));void 0!==(null==e?void 0:e.packagePolicy)&&i({type:"serverReturnedEndpointNonExistingPolicies",payload:e.packagePolicy}),void 0!==(null==e?void 0:e.agentPolicy)&&i({type:"serverReturnedEndpointAgentPolicies",payload:e.agentPolicy})}catch(e){f(e)}}const j=e=>t=>t[i.u][e],O=(e,t)=>[Object(n.f)(j(i.v),Object(r.b)(e,t)),Object(n.f)(j(i.t),y(e,t))]},function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(4),i=a.n(n),r=a(32),s=a(35);const o=Object(n.memo)((()=>i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiEmptyPrompt,{iconType:"alert",iconColor:"danger",titleSize:"l","data-test-subj":"noIngestPermissions",title:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpointManagemnet.noPermissionsText",defaultMessage:"You do not have the required Kibana permissions to use Elastic Security Administration"}),body:i.a.createElement(r.EuiText,{color:"subdued"},i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpointManagement.noPermissionsSubText",defaultMessage:"You must have the superuser role to use this feature. If you do not have the superuser role and do not have permissions to edit user roles, contact your Kibana administrator."}))}))));o.displayName="NoPermissions"},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){e.exports=p,p.Minimatch=m;var n=function(){try{return a(1258)}catch(e){}}()||{sep:"/"};p.sep=n.sep;var i=p.GLOBSTAR=m.GLOBSTAR={},r=a(1259),s={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},o="[^/]",l="[^/]*?",c="().*{}+?[]^$\\!".split("").reduce((function(e,t){return e[t]=!0,e}),{}),u=/\/+/;function d(e,t){t=t||{};var a={};return Object.keys(e).forEach((function(t){a[t]=e[t]})),Object.keys(t).forEach((function(e){a[e]=t[e]})),a}function p(e,t,a){return b(t),a||(a={}),!(!a.nocomment&&"#"===t.charAt(0))&&new m(t,a).match(e)}function m(e,t){if(!(this instanceof m))return new m(e,t);b(e),t||(t={}),e=e.trim(),t.allowWindowsEscape||"/"===n.sep||(e=e.split(n.sep).join("/")),this.options=t,this.set=[],this.pattern=e,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!t.partial,this.make()}function g(e,t){return t||(t=this instanceof m?this.options:{}),e=void 0===e?this.pattern:e,b(e),t.nobrace||!/\{(?:(?!\{).)*\}/.test(e)?[e]:r(e)}p.filter=function(e,t){return t=t||{},function(a,n,i){return p(a,e,t)}},p.defaults=function(e){if(!e||"object"!=typeof e||!Object.keys(e).length)return p;var t=p,a=function(a,n,i){return t(a,n,d(e,i))};return(a.Minimatch=function(a,n){return new t.Minimatch(a,d(e,n))}).defaults=function(a){return t.defaults(d(e,a)).Minimatch},a.filter=function(a,n){return t.filter(a,d(e,n))},a.defaults=function(a){return t.defaults(d(e,a))},a.makeRe=function(a,n){return t.makeRe(a,d(e,n))},a.braceExpand=function(a,n){return t.braceExpand(a,d(e,n))},a.match=function(a,n,i){return t.match(a,n,d(e,i))},a},m.defaults=function(e){return p.defaults(e).Minimatch},m.prototype.debug=function(){},m.prototype.make=function(){var e=this.pattern,t=this.options;if(t.nocomment||"#"!==e.charAt(0))if(e){this.parseNegate();var a=this.globSet=this.braceExpand();t.debug&&(this.debug=function(){console.error.apply(console,arguments)}),this.debug(this.pattern,a),a=this.globParts=a.map((function(e){return e.split(u)})),this.debug(this.pattern,a),a=a.map((function(e,t,a){return e.map(this.parse,this)}),this),this.debug(this.pattern,a),a=a.filter((function(e){return-1===e.indexOf(!1)})),this.debug(this.pattern,a),this.set=a}else this.empty=!0;else this.comment=!0},m.prototype.parseNegate=function(){var e=this.pattern,t=!1,a=0;if(!this.options.nonegate){for(var n=0,i=e.length;n<i&&"!"===e.charAt(n);n++)t=!t,a++;a&&(this.pattern=e.substr(a)),this.negate=t}},p.braceExpand=function(e,t){return g(e,t)},m.prototype.braceExpand=g;var b=function(e){if("string"!=typeof e)throw new TypeError("invalid pattern");if(e.length>65536)throw new TypeError("pattern is too long")};m.prototype.parse=function(e,t){b(e);var a=this.options;if("**"===e){if(!a.noglobstar)return i;e="*"}if(""===e)return"";var n,r="",u=!!a.nocase,d=!1,p=[],m=[],g=!1,y=-1,h=-1,E="."===e.charAt(0)?"":a.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",v=this;function x(){if(n){switch(n){case"*":r+=l,u=!0;break;case"?":r+=o,u=!0;break;default:r+="\\"+n}v.debug("clearStateChar %j %j",n,r),n=!1}}for(var k,S=0,j=e.length;S<j&&(k=e.charAt(S));S++)if(this.debug("%s\t%s %s %j",e,S,r,k),d&&c[k])r+="\\"+k,d=!1;else switch(k){case"/":return!1;case"\\":x(),d=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s\t%s %s %j <-- stateChar",e,S,r,k),g){this.debug("  in class"),"!"===k&&S===h+1&&(k="^"),r+=k;continue}v.debug("call clearStateChar %j",n),x(),n=k,a.noext&&x();continue;case"(":if(g){r+="(";continue}if(!n){r+="\\(";continue}p.push({type:n,start:S-1,reStart:r.length,open:s[n].open,close:s[n].close}),r+="!"===n?"(?:(?!(?:":"(?:",this.debug("plType %j %j",n,r),n=!1;continue;case")":if(g||!p.length){r+="\\)";continue}x(),u=!0;var O=p.pop();r+=O.close,"!"===O.type&&m.push(O),O.reEnd=r.length;continue;case"|":if(g||!p.length||d){r+="\\|",d=!1;continue}x(),r+="|";continue;case"[":if(x(),g){r+="\\"+k;continue}g=!0,h=S,y=r.length,r+=k;continue;case"]":if(S===h+1||!g){r+="\\"+k,d=!1;continue}var w=e.substring(h+1,S);try{RegExp("["+w+"]")}catch(e){var T=this.parse(w,f);r=r.substr(0,y)+"\\["+T[0]+"\\]",u=u||T[1],g=!1;continue}u=!0,g=!1,r+=k;continue;default:x(),d?d=!1:!c[k]||"^"===k&&g||(r+="\\"),r+=k}for(g&&(w=e.substr(h+1),T=this.parse(w,f),r=r.substr(0,y)+"\\["+T[0],u=u||T[1]),O=p.pop();O;O=p.pop()){var I=r.slice(O.reStart+O.open.length);this.debug("setting tail",r,O),I=I.replace(/((?:\\{2}){0,64})(\\?)\|/g,(function(e,t,a){return a||(a="\\"),t+t+a+"|"})),this.debug("tail=%j\n   %s",I,I,O,r);var C="*"===O.type?l:"?"===O.type?o:"\\"+O.type;u=!0,r=r.slice(0,O.reStart)+C+"\\("+I}x(),d&&(r+="\\\\");var M=!1;switch(r.charAt(0)){case"[":case".":case"(":M=!0}for(var F=m.length-1;F>-1;F--){var D=m[F],A=r.slice(0,D.reStart),_=r.slice(D.reStart,D.reEnd-8),N=r.slice(D.reEnd-8,D.reEnd),R=r.slice(D.reEnd);N+=R;var P=A.split("(").length-1,L=R;for(S=0;S<P;S++)L=L.replace(/\)[+*?]?/,"");var B="";""===(R=L)&&t!==f&&(B="$"),r=A+_+R+B+N}if(""!==r&&u&&(r="(?=.)"+r),M&&(r=E+r),t===f)return[r,u];if(!u)return e.replace(/\\(.)/g,"$1");var q=a.nocase?"i":"";try{var z=new RegExp("^"+r+"$",q)}catch(e){return new RegExp("$.")}return z._glob=e,z._src=r,z};var f={};p.makeRe=function(e,t){return new m(e,t||{}).makeRe()},m.prototype.makeRe=function(){if(this.regexp||!1===this.regexp)return this.regexp;var e=this.set;if(!e.length)return this.regexp=!1,this.regexp;var t=this.options,a=t.noglobstar?l:t.dot?"(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?":"(?:(?!(?:\\/|^)\\.).)*?",n=t.nocase?"i":"",r=e.map((function(e){return e.map((function(e){return e===i?a:"string"==typeof e?e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"):e._src})).join("\\/")})).join("|");r="^(?:"+r+")$",this.negate&&(r="^(?!"+r+").*$");try{this.regexp=new RegExp(r,n)}catch(e){this.regexp=!1}return this.regexp},p.match=function(e,t,a){var n=new m(t,a=a||{});return e=e.filter((function(e){return n.match(e)})),n.options.nonull&&!e.length&&e.push(t),e},m.prototype.match=function(e,t){if(void 0===t&&(t=this.partial),this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return""===e;if("/"===e&&t)return!0;var a=this.options;"/"!==n.sep&&(e=e.split(n.sep).join("/")),e=e.split(u),this.debug(this.pattern,"split",e);var i,r,s=this.set;for(this.debug(this.pattern,"set",s),r=e.length-1;r>=0&&!(i=e[r]);r--);for(r=0;r<s.length;r++){var o=s[r],l=e;if(a.matchBase&&1===o.length&&(l=[i]),this.matchOne(l,o,t))return!!a.flipNegate||!this.negate}return!a.flipNegate&&this.negate},m.prototype.matchOne=function(e,t,a){var n=this.options;this.debug("matchOne",{this:this,file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var r=0,s=0,o=e.length,l=t.length;r<o&&s<l;r++,s++){this.debug("matchOne loop");var c,u=t[s],d=e[r];if(this.debug(t,u,d),!1===u)return!1;if(u===i){this.debug("GLOBSTAR",[t,u,d]);var p=r,m=s+1;if(m===l){for(this.debug("** at the end");r<o;r++)if("."===e[r]||".."===e[r]||!n.dot&&"."===e[r].charAt(0))return!1;return!0}for(;p<o;){var g=e[p];if(this.debug("\nglobstar while",e,p,t,m,g),this.matchOne(e.slice(p),t.slice(m),a))return this.debug("globstar found match!",p,o,g),!0;if("."===g||".."===g||!n.dot&&"."===g.charAt(0)){this.debug("dot detected!",e,p,t,m);break}this.debug("globstar swallow a segment, and continue"),p++}return!(!a||(this.debug("\n>>> no match, partial?",e,p,t,m),p!==o))}if("string"==typeof u?(c=d===u,this.debug("string match",u,d,c)):(c=d.match(u),this.debug("pattern match",u,d,c)),!c)return!1}if(r===o&&s===l)return!0;if(r===o)return a;if(s===l)return r===o-1&&""===e[r];throw new Error("wtf?")}},function(e,t,a){e.exports=a(27)(1624)},function(e,t,a){var n=a(1260),i=a(1261);e.exports=function(e){return e?("{}"===e.substr(0,2)&&(e="\\{\\}"+e.substr(2)),y(function(e){return e.split("\\\\").join(r).split("\\{").join(s).split("\\}").join(o).split("\\,").join(l).split("\\.").join(c)}(e),!0).map(d)):[]};var r="\0SLASH"+Math.random()+"\0",s="\0OPEN"+Math.random()+"\0",o="\0CLOSE"+Math.random()+"\0",l="\0COMMA"+Math.random()+"\0",c="\0PERIOD"+Math.random()+"\0";function u(e){return parseInt(e,10)==e?parseInt(e,10):e.charCodeAt(0)}function d(e){return e.split(r).join("\\").split(s).join("{").split(o).join("}").split(l).join(",").split(c).join(".")}function p(e){if(!e)return[""];var t=[],a=i("{","}",e);if(!a)return e.split(",");var n=a.pre,r=a.body,s=a.post,o=n.split(",");o[o.length-1]+="{"+r+"}";var l=p(s);return s.length&&(o[o.length-1]+=l.shift(),o.push.apply(o,l)),t.push.apply(t,o),t}function m(e){return"{"+e+"}"}function g(e){return/^-?0\d/.test(e)}function b(e,t){return e<=t}function f(e,t){return e>=t}function y(e,t){var a=[],r=i("{","}",e);if(!r||/\$$/.test(r.pre))return[e];var s,l=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(r.body),c=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(r.body),d=l||c,h=r.body.indexOf(",")>=0;if(!d&&!h)return r.post.match(/,.*\}/)?y(e=r.pre+"{"+r.body+o+r.post):[e];if(d)s=r.body.split(/\.\./);else if(1===(s=p(r.body)).length&&1===(s=y(s[0],!1).map(m)).length)return(x=r.post.length?y(r.post,!1):[""]).map((function(e){return r.pre+s[0]+e}));var E,v=r.pre,x=r.post.length?y(r.post,!1):[""];if(d){var k=u(s[0]),S=u(s[1]),j=Math.max(s[0].length,s[1].length),O=3==s.length?Math.abs(u(s[2])):1,w=b;S<k&&(O*=-1,w=f);var T=s.some(g);E=[];for(var I=k;w(I,S);I+=O){var C;if(c)"\\"===(C=String.fromCharCode(I))&&(C="");else if(C=String(I),T){var M=j-C.length;if(M>0){var F=new Array(M+1).join("0");C=I<0?"-"+F+C.slice(1):F+C}}E.push(C)}}else E=n(s,(function(e){return y(e,!1)}));for(var D=0;D<E.length;D++)for(var A=0;A<x.length;A++){var _=v+E[D]+x[A];(!t||d||_)&&a.push(_)}return a}},function(e,t){e.exports=function(e,t){for(var n=[],i=0;i<e.length;i++){var r=t(e[i],i);a(r)?n.push.apply(n,r):n.push(r)}return n};var a=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,a){"use strict";function n(e,t,a){e instanceof RegExp&&(e=i(e,a)),t instanceof RegExp&&(t=i(t,a));var n=r(e,t,a);return n&&{start:n[0],end:n[1],pre:a.slice(0,n[0]),body:a.slice(n[0]+e.length,n[1]),post:a.slice(n[1]+t.length)}}function i(e,t){var a=t.match(e);return a?a[0]:null}function r(e,t,a){var n,i,r,s,o,l=a.indexOf(e),c=a.indexOf(t,l+1),u=l;if(l>=0&&c>0){if(e===t)return[l,c];for(n=[],r=a.length;u>=0&&!o;)u==l?(n.push(u),l=a.indexOf(e,u+1)):1==n.length?o=[n.pop(),c]:((i=n.pop())<r&&(r=i,s=c),c=a.indexOf(t,u+1)),u=l<c&&l>=0?l:c;n.length&&(o=[r,s])}return o}e.exports=n,n.range=r},function(e,t,a){"use strict";const n=a(1263);e.exports=(e,t={})=>{if(!Number.isFinite(e))throw new TypeError("Expected a finite number");t.colonNotation&&(t.compact=!1,t.formatSubMilliseconds=!1,t.separateMilliseconds=!1,t.verbose=!1),t.compact&&(t.secondsDecimalDigits=0,t.millisecondsDecimalDigits=0);const a=[],i=(e,n,i,r)=>{if(!(0!==a.length&&t.colonNotation||0!==e||t.colonNotation&&"m"===i))return;let s,o;if(r=(r||e||"0").toString(),t.colonNotation){s=a.length>0?":":"",o="";const e=r.includes(".")?r.split(".")[0].length:r.length,t=a.length>0?2:1;r="0".repeat(Math.max(0,t-e))+r}else s="",o=t.verbose?" "+(l=n,1===e?l:`${l}s`):i;var l;a.push(s+r+o)};if(("number"==typeof t.secondsDecimalDigits?t.secondsDecimalDigits:1)<1){const t=1e3-e%1e3;t<500&&(e+=t)}if(e>=59950&&!t.separateMilliseconds&&!t.formatSubMilliseconds){const t=60-e%60;t<=50&&(e+=t)}const r=n(e);if(i(Math.trunc(r.days/365),"year","y"),i(r.days%365,"day","d"),i(r.hours,"hour","h"),i(r.minutes,"minute","m"),t.separateMilliseconds||t.formatSubMilliseconds||e<1e3)if(i(r.seconds,"second","s"),t.formatSubMilliseconds)i(r.milliseconds,"millisecond","ms"),i(r.microseconds,"microsecond","µs"),i(r.nanoseconds,"nanosecond","ns");else{const e=r.milliseconds+r.microseconds/1e3+r.nanoseconds/1e6,a="number"==typeof t.millisecondsDecimalDigits?t.millisecondsDecimalDigits:0,n=e>=1?Math.round(e):Math.ceil(e),s=a?e.toFixed(a):n;i(parseFloat(s,10),"millisecond","ms",s)}else{const a=e/1e3%60,n="number"==typeof t.secondsDecimalDigits?t.secondsDecimalDigits:1,r=a.toFixed(n),s=t.keepDecimalsOnWholeSeconds?r:r.replace(/\.0+$/,"");i(parseFloat(s,10),"second","s",s)}return 0===a.length?"0"+(t.verbose?" milliseconds":"ms"):t.compact?a[0]:"number"==typeof t.unitCount?a.slice(0,Math.max(t.unitCount,1)).join(" "):t.colonNotation?a.join(""):a.join(" ")}},function(e,t,a){"use strict";e.exports=e=>{if("number"!=typeof e)throw new TypeError("Expected a number");const t=e>0?Math.floor:Math.ceil;return{days:t(e/864e5),hours:t(e/36e5)%24,minutes:t(e/6e4)%60,seconds:t(e/1e3)%60,milliseconds:t(e)%1e3,microseconds:t(1e3*e)%1e3,nanoseconds:t(1e6*e)%1e3}}},function(e,t,a){e.exports=a.p+"593328a61facc1e96ac261fcede5db93.png"},function(e,t,a){e.exports=a.p+"ae37f7e28b2ba3954b127510d84d3ac5.svg"},function(e,t,a){!function(t){"use strict";const a="(0?\\d+|0x[a-f0-9]+)",n={fourOctet:new RegExp(`^${a}\\.${a}\\.${a}\\.${a}$`,"i"),threeOctet:new RegExp(`^${a}\\.${a}\\.${a}$`,"i"),twoOctet:new RegExp(`^${a}\\.${a}$`,"i"),longValue:new RegExp(`^${a}$`,"i")},i=new RegExp("^0[0-7]+$","i"),r=new RegExp("^0x[a-f0-9]+$","i"),s="%[0-9a-z]{1,}",o="(?:[0-9a-f]+::?)+",l={zoneIndex:new RegExp(s,"i"),native:new RegExp(`^(::)?(${o})?([0-9a-f]+)?(::)?(${s})?$`,"i"),deprecatedTransitional:new RegExp(`^(?:::)(${a}\\.${a}\\.${a}\\.${a}(${s})?)$`,"i"),transitional:new RegExp(`^((?:${o})|(?:::)(?:${o})?)${a}\\.${a}\\.${a}\\.${a}(${s})?$`,"i")};function c(e,t){if(e.indexOf("::")!==e.lastIndexOf("::"))return null;let a,n,i=0,r=-1,s=(e.match(l.zoneIndex)||[])[0];for(s&&(s=s.substring(1),e=e.replace(/%.+$/,""));(r=e.indexOf(":",r+1))>=0;)i++;if("::"===e.substr(0,2)&&i--,"::"===e.substr(-2,2)&&i--,i>t)return null;for(n=t-i,a=":";n--;)a+="0:";return":"===(e=e.replace("::",a))[0]&&(e=e.slice(1)),":"===e[e.length-1]&&(e=e.slice(0,-1)),{parts:t=function(){const t=e.split(":"),a=[];for(let e=0;e<t.length;e++)a.push(parseInt(t[e],16));return a}(),zoneId:s}}function u(e,t,a,n){if(e.length!==t.length)throw new Error("ipaddr: cannot match CIDR for objects with different lengths");let i,r=0;for(;n>0;){if(i=a-n,i<0&&(i=0),e[r]>>i!=t[r]>>i)return!1;n-=a,r+=1}return!0}function d(e){if(r.test(e))return parseInt(e,16);if("0"===e[0]&&!isNaN(parseInt(e[1],10))){if(i.test(e))return parseInt(e,8);throw new Error(`ipaddr: cannot parse ${e} as octal`)}return parseInt(e,10)}function p(e,t){for(;e.length<t;)e=`0${e}`;return e}const m={};m.IPv4=function(){function e(e){if(4!==e.length)throw new Error("ipaddr: ipv4 octet count should be 4");let t,a;for(t=0;t<e.length;t++)if(a=e[t],!(0<=a&&a<=255))throw new Error("ipaddr: ipv4 octet should fit in 8 bits");this.octets=e}return e.prototype.SpecialRanges={unspecified:[[new e([0,0,0,0]),8]],broadcast:[[new e([255,255,255,255]),32]],multicast:[[new e([224,0,0,0]),4]],linkLocal:[[new e([169,254,0,0]),16]],loopback:[[new e([127,0,0,0]),8]],carrierGradeNat:[[new e([100,64,0,0]),10]],private:[[new e([10,0,0,0]),8],[new e([172,16,0,0]),12],[new e([192,168,0,0]),16]],reserved:[[new e([192,0,0,0]),24],[new e([192,0,2,0]),24],[new e([192,88,99,0]),24],[new e([198,51,100,0]),24],[new e([203,0,113,0]),24],[new e([240,0,0,0]),4]]},e.prototype.kind=function(){return"ipv4"},e.prototype.match=function(e,t){let a;if(void 0===t&&(a=e,e=a[0],t=a[1]),"ipv4"!==e.kind())throw new Error("ipaddr: cannot match ipv4 address with non-ipv4 one");return u(this.octets,e.octets,8,t)},e.prototype.prefixLengthFromSubnetMask=function(){let e=0,t=!1;const a={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0};let n,i,r;for(n=3;n>=0;n-=1){if(i=this.octets[n],!(i in a))return null;if(r=a[i],t&&0!==r)return null;8!==r&&(t=!0),e+=r}return 32-e},e.prototype.range=function(){return m.subnetMatch(this,this.SpecialRanges)},e.prototype.toByteArray=function(){return this.octets.slice(0)},e.prototype.toIPv4MappedAddress=function(){return m.IPv6.parse(`::ffff:${this.toString()}`)},e.prototype.toNormalizedString=function(){return this.toString()},e.prototype.toString=function(){return this.octets.join(".")},e}(),m.IPv4.broadcastAddressFromCIDR=function(e){try{const t=this.parseCIDR(e),a=t[0].toByteArray(),n=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),i=[];let r=0;for(;r<4;)i.push(parseInt(a[r],10)|255^parseInt(n[r],10)),r++;return new this(i)}catch(e){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},m.IPv4.isIPv4=function(e){return null!==this.parser(e)},m.IPv4.isValid=function(e){try{return new this(this.parser(e)),!0}catch(e){return!1}},m.IPv4.isValidFourPartDecimal=function(e){return!(!m.IPv4.isValid(e)||!e.match(/^(0|[1-9]\d*)(\.(0|[1-9]\d*)){3}$/))},m.IPv4.networkAddressFromCIDR=function(e){let t,a,n,i,r;try{for(t=this.parseCIDR(e),n=t[0].toByteArray(),r=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),i=[],a=0;a<4;)i.push(parseInt(n[a],10)&parseInt(r[a],10)),a++;return new this(i)}catch(e){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},m.IPv4.parse=function(e){const t=this.parser(e);if(null===t)throw new Error("ipaddr: string is not formatted like an IPv4 Address");return new this(t)},m.IPv4.parseCIDR=function(e){let t;if(t=e.match(/^(.+)\/(\d+)$/)){const e=parseInt(t[2]);if(e>=0&&e<=32){const a=[this.parse(t[1]),e];return Object.defineProperty(a,"toString",{value:function(){return this.join("/")}}),a}}throw new Error("ipaddr: string is not formatted like an IPv4 CIDR range")},m.IPv4.parser=function(e){let t,a,i;if(t=e.match(n.fourOctet))return function(){const e=t.slice(1,6),n=[];for(let t=0;t<e.length;t++)a=e[t],n.push(d(a));return n}();if(t=e.match(n.longValue)){if(i=d(t[1]),i>4294967295||i<0)throw new Error("ipaddr: address outside defined range");return function(){const e=[];let t;for(t=0;t<=24;t+=8)e.push(i>>t&255);return e}().reverse()}return(t=e.match(n.twoOctet))?function(){const e=t.slice(1,4),a=[];if(i=d(e[1]),i>16777215||i<0)throw new Error("ipaddr: address outside defined range");return a.push(d(e[0])),a.push(i>>16&255),a.push(i>>8&255),a.push(255&i),a}():(t=e.match(n.threeOctet))?function(){const e=t.slice(1,5),a=[];if(i=d(e[2]),i>65535||i<0)throw new Error("ipaddr: address outside defined range");return a.push(d(e[0])),a.push(d(e[1])),a.push(i>>8&255),a.push(255&i),a}():null},m.IPv4.subnetMaskFromPrefixLength=function(e){if((e=parseInt(e))<0||e>32)throw new Error("ipaddr: invalid IPv4 prefix length");const t=[0,0,0,0];let a=0;const n=Math.floor(e/8);for(;a<n;)t[a]=255,a++;return n<4&&(t[n]=Math.pow(2,e%8)-1<<8-e%8),new this(t)},m.IPv6=function(){function e(e,t){let a,n;if(16===e.length)for(this.parts=[],a=0;a<=14;a+=2)this.parts.push(e[a]<<8|e[a+1]);else{if(8!==e.length)throw new Error("ipaddr: ipv6 part count should be 8 or 16");this.parts=e}for(a=0;a<this.parts.length;a++)if(n=this.parts[a],!(0<=n&&n<=65535))throw new Error("ipaddr: ipv6 part should fit in 16 bits");t&&(this.zoneId=t)}return e.prototype.SpecialRanges={unspecified:[new e([0,0,0,0,0,0,0,0]),128],linkLocal:[new e([65152,0,0,0,0,0,0,0]),10],multicast:[new e([65280,0,0,0,0,0,0,0]),8],loopback:[new e([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new e([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new e([0,0,0,0,0,65535,0,0]),96],rfc6145:[new e([0,0,0,0,65535,0,0,0]),96],rfc6052:[new e([100,65435,0,0,0,0,0,0]),96],"6to4":[new e([8194,0,0,0,0,0,0,0]),16],teredo:[new e([8193,0,0,0,0,0,0,0]),32],reserved:[[new e([8193,3512,0,0,0,0,0,0]),32]]},e.prototype.isIPv4MappedAddress=function(){return"ipv4Mapped"===this.range()},e.prototype.kind=function(){return"ipv6"},e.prototype.match=function(e,t){let a;if(void 0===t&&(a=e,e=a[0],t=a[1]),"ipv6"!==e.kind())throw new Error("ipaddr: cannot match ipv6 address with non-ipv6 one");return u(this.parts,e.parts,16,t)},e.prototype.prefixLengthFromSubnetMask=function(){let e=0,t=!1;const a={0:16,32768:15,49152:14,57344:13,61440:12,63488:11,64512:10,65024:9,65280:8,65408:7,65472:6,65504:5,65520:4,65528:3,65532:2,65534:1,65535:0};let n,i;for(let r=7;r>=0;r-=1){if(n=this.parts[r],!(n in a))return null;if(i=a[n],t&&0!==i)return null;16!==i&&(t=!0),e+=i}return 128-e},e.prototype.range=function(){return m.subnetMatch(this,this.SpecialRanges)},e.prototype.toByteArray=function(){let e;const t=[],a=this.parts;for(let n=0;n<a.length;n++)e=a[n],t.push(e>>8),t.push(255&e);return t},e.prototype.toFixedLengthString=function(){const e=function(){const e=[];for(let t=0;t<this.parts.length;t++)e.push(p(this.parts[t].toString(16),4));return e}.call(this).join(":");let t="";return this.zoneId&&(t=`%${this.zoneId}`),e+t},e.prototype.toIPv4Address=function(){if(!this.isIPv4MappedAddress())throw new Error("ipaddr: trying to convert a generic ipv6 address to ipv4");const e=this.parts.slice(-2),t=e[0],a=e[1];return new m.IPv4([t>>8,255&t,a>>8,255&a])},e.prototype.toNormalizedString=function(){const e=function(){const e=[];for(let t=0;t<this.parts.length;t++)e.push(this.parts[t].toString(16));return e}.call(this).join(":");let t="";return this.zoneId&&(t=`%${this.zoneId}`),e+t},e.prototype.toRFC5952String=function(){const e=/((^|:)(0(:|$)){2,})/g,t=this.toNormalizedString();let a,n=0,i=-1;for(;a=e.exec(t);)a[0].length>i&&(n=a.index,i=a[0].length);return i<0?t:`${t.substring(0,n)}::${t.substring(n+i)}`},e.prototype.toString=function(){return this.toNormalizedString().replace(/((^|:)(0(:|$))+)/,"::")},e}(),m.IPv6.isIPv6=function(e){return null!==this.parser(e)},m.IPv6.isValid=function(e){if("string"==typeof e&&-1===e.indexOf(":"))return!1;try{const t=this.parser(e);return new this(t.parts,t.zoneId),!0}catch(e){return!1}},m.IPv6.parse=function(e){const t=this.parser(e);if(null===t.parts)throw new Error("ipaddr: string is not formatted like an IPv6 Address");return new this(t.parts,t.zoneId)},m.IPv6.parseCIDR=function(e){let t,a,n;if((a=e.match(/^(.+)\/(\d+)$/))&&(t=parseInt(a[2]),t>=0&&t<=128))return n=[this.parse(a[1]),t],Object.defineProperty(n,"toString",{value:function(){return this.join("/")}}),n;throw new Error("ipaddr: string is not formatted like an IPv6 CIDR range")},m.IPv6.parser=function(e){let t,a,n,i,r,s;if(n=e.match(l.deprecatedTransitional))return this.parser(`::ffff:${n[1]}`);if(l.native.test(e))return c(e,8);if((n=e.match(l.transitional))&&(s=n[6]||"",t=c(n[1].slice(0,-1)+s,6),t.parts)){for(r=[parseInt(n[2]),parseInt(n[3]),parseInt(n[4]),parseInt(n[5])],a=0;a<r.length;a++)if(i=r[a],!(0<=i&&i<=255))return null;return t.parts.push(r[0]<<8|r[1]),t.parts.push(r[2]<<8|r[3]),{parts:t.parts,zoneId:t.zoneId}}return null},m.fromByteArray=function(e){const t=e.length;if(4===t)return new m.IPv4(e);if(16===t)return new m.IPv6(e);throw new Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")},m.isValid=function(e){return m.IPv6.isValid(e)||m.IPv4.isValid(e)},m.parse=function(e){if(m.IPv6.isValid(e))return m.IPv6.parse(e);if(m.IPv4.isValid(e))return m.IPv4.parse(e);throw new Error("ipaddr: the address has neither IPv6 nor IPv4 format")},m.parseCIDR=function(e){try{return m.IPv6.parseCIDR(e)}catch(t){try{return m.IPv4.parseCIDR(e)}catch(e){throw new Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}},m.process=function(e){const t=this.parse(e);return"ipv6"===t.kind()&&t.isIPv4MappedAddress()?t.toIPv4Address():t},m.subnetMatch=function(e,t,a){let n,i,r,s;for(i in null==a&&(a="unicast"),t)if(Object.prototype.hasOwnProperty.call(t,i))for(r=t[i],!r[0]||r[0]instanceof Array||(r=[r]),n=0;n<r.length;n++)if(s=r[n],e.kind()===s[0].kind()&&e.match.apply(e,s))return i;return a},e.exports?e.exports=m:t.ipaddr=m}(this)},,,,,,,,,,,,,,,,,,,,function(e,t,a){"use strict";a.r(t),a.d(t,"subPluginClasses",(function(){return UF}));var n=a(4),i=a.n(n),r=a(55),s=a(1),o=a(78),l=a(403),c=a(205),u=a(79),d=a(128),p=a(77),m=a(86),g=a(94),b=a(95),f=a(875),y=a(164),h=a(153),E=a(161),v=a(34),x=a(81),k=a(2),S=a(12);const j=(e,t)=>{const a=Object(o.useDispatch)(),{formatUrl:i}=Object(d.n)(k.a.timelines),r=Object(x.b)(m.b.selectInsertTimeline),s=Object(n.useCallback)(((a,n,r)=>{let s=`[${a}](${i(Object(d.m)(null!=n?n:"",r),{absolute:!0,skipSearch:!0})})`;Object(v.isEmpty)(e)||(s=`${e} ${s}`),t(s)}),[e,t,i]);return Object(n.useEffect)((()=>{null!=r&&null!=e&&(a(m.a.showTimeline({id:r.timelineId,show:!1})),s(r.timelineTitle,r.timelineSavedObjectId,r.graphEventId),a(Object(S.setInsertTimeline)(null)))}),[r,a,s,e]),{handleOnTimelineChange:s}};var O=a(903),w=a(504),T=a(186),I=a(185),C=a(876);const M=e=>{const{selectedPatterns:t}=Object(g.d)(b.SourcererScopeName.detections),a=Object(n.useMemo)((()=>Object(C.a)(e)),[e]),{loading:i,data:r}=Object(T.a)({query:a,indexName:t[0],queryName:I.a.CASES});return[i,Object(n.useMemo)((()=>{var e;return null!==(e=null==r?void 0:r.hits.hits.reduce(((e,{_id:t,_index:a,_source:n})=>({...e,[t]:{...Object(C.b)(n),_id:t,_index:a,timestamp:n["@timestamp"]}})),{}))&&void 0!==e?e:{}}),[null==r?void 0:r.hits.hits])]},F=()=>{const{browserFields:e,runtimeMappings:t}=Object(g.d)(b.SourcererScopeName.detections);return i.a.createElement(w.a,{browserFields:e,entityType:"events",isFlyoutView:!0,runtimeMappings:t,scopeId:u.j.casePage})},D=()=>{const{cases:e}=Object(p.k)().services,{getAppUrl:t,navigateTo:a}=Object(p.m)(),r=Object(p.i)(),g=Object(o.useDispatch)(),{formatUrl:b,search:v}=Object(d.n)(s.uc.rules),x=Object(n.useCallback)((e=>b(Object(d.j)(null!=e?e:"",v))),[b,v]),k=Object(n.useCallback)(((e,t)=>{g(m.a.toggleDetailPanel({panelView:"eventDetail",id:u.j.casePage,params:{eventId:e,indexName:t}}))}),[g]),S=Object(n.useCallback)((()=>{g(m.a.createTimeline({id:u.j.casePage,columns:[],dataViewId:null,indexNames:[],expandedDetail:{},show:!1}))}),[g]),w=Object(n.useRef)(null),{activeStep:T,endTourStep:I,isTourShown:C}=Object(l.b)(),D=Object(n.useMemo)((()=>T===c.a.viewCase&&C(c.b.alertsCases)),[T,C]);return Object(n.useEffect)((()=>{D&&I(c.b.alertsCases)}),[I,D]),i.a.createElement(y.a,{noPadding:!0},i.a.createElement(f.a.Provider,{value:w},e.ui.getCases({basePath:s.H,owner:[s.p],features:{metrics:["alerts.count","alerts.users","alerts.hosts","connectors","lifespan"],alerts:{isExperimental:!0}},refreshRef:w,onComponentInitialized:S,actionsNavigation:{href:e=>t({path:Object(h.d)({name:"endpointActivityLog",selected_endpoint:e})}),onClick:(e,t)=>(t&&t.preventDefault(),a({path:Object(h.d)({name:"endpointActivityLog",selected_endpoint:e})}))},ruleDetailsNavigation:{href:x,onClick:async(e,t)=>(t&&t.preventDefault(),a({deepLinkId:s.uc.rules,path:Object(d.j)(null!=e?e:"")}))},showAlertDetails:k,timelineIntegration:{editor_plugins:{parsingPlugin:O.a,processingPluginRenderer:O.c,uiPlugin:O.b},hooks:{useInsertTimeline:j},ui:{renderTimelineDetailsPanel:F}},useFetchAlertData:M,permissions:r})),i.a.createElement(E.a,{pageName:s.uc.case}))},A=i.a.memo(D),_=({children:e,...t})=>{const{services:{securityLayout:{getPluginWrapper:a}}}=Object(p.k)(),n=a();return i.a.createElement(n,t,e)},N=[{path:s.H,component:()=>i.a.createElement(_,null,i.a.createElement(r.TrackApplicationView,{viewId:"case"},i.a.createElement(A,null)))}];var R=a(743),P=a(37),L=a(41),B=a(107),q=a(343),z=a(0);const $=z.i18n.translate("xpack.securitySolution.alerts.badge.readOnly.tooltip",{defaultMessage:"Unable to update alerts"});var V=a(32),U=a(33),H=a.n(U),G=a(38),Q=a(180),W=a(155),K=a(90),Y=a(114),J=a(293),X=a(156),Z=a(282),ee=a(145),te=a(143),ae=a(915);const ne=z.i18n.translate("xpack.securitySolution.detectionEngine.noApiIntegrationKeyCallOutTitle",{defaultMessage:"API integration key required"}),ie=z.i18n.translate("xpack.securitySolution.detectionEngine.noApiIntegrationKeyCallOutMsg",{defaultMessage:"A new encryption key is generated for saved objects each time you start Kibana. Without a persistent key, you cannot delete or modify rules after Kibana restarts. To set a persistent key, add the xpack.encryptedSavedObjects.encryptionKey setting with any text value of 32 or more characters to the kibana.yml file."}),re=z.i18n.translate("xpack.securitySolution.detectionEngine.dismissNoApiIntegrationKeyButton",{defaultMessage:"Dismiss"}),se=()=>{const[e,t]=Object(n.useState)(!0),a=Object(n.useCallback)((()=>t(!1)),[t]);return e?i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiCallOut,{title:ne,color:"danger",iconType:"alert"},i.a.createElement("p",null,ie),i.a.createElement(V.EuiButton,{color:"danger",onClick:a},re)),i.a.createElement(V.EuiSpacer,{size:"l"})):null},oe=Object(n.memo)(se);var le=a(165),ce=a(853),ue=a(416);const de=({needsListsIndex:e,needsSignalsIndex:t})=>{const a=Object(p.k)().services.docLinks,r=Object(n.useMemo)((()=>({detections:{icon:"documents",label:ue.e,url:`${a.links.siem.detectionsReq}`,target:"_blank"}})),[a]),s=((e,t)=>t&&e?ue.h(ue.j):t?ue.h(ue.k):e?ue.h(ue.i):ue.h(""))(e,t);return i.a.createElement(ce.a,{actions:r,"data-test-subj":"no_index",message:s,title:ue.l})},pe=i.a.memo(de);var me=a(541);const ge=i.a.memo((()=>{const e=Object(p.k)().services.docLinks,t=Object(n.useMemo)((()=>({detectionUnauthenticated:{icon:"documents",label:ue.e,url:`${e.links.siem.detectionsReq}`,target:"_blank"}})),[e]);return i.a.createElement(ce.a,{actions:t,message:ue.n,"data-test-subj":"no_index",title:ue.o})}));ge.displayName="DetectionEngineUserUnauthenticated";var be=a(89),fe=a(148),ye=a(572),he=a(123),Ee=a(274),ve=a(869);const xe=({category:e,page:t,setting:a})=>`${t}.${e}.${a}`,ke=e=>"string"!=typeof e||Object(v.isEmpty)(e.trim()),Se="alerts",je="table",Oe="treemap",we="stack-by-0",Te="stack-by-1";var Ie=a(531);const Ce=z.i18n.translate("xpack.securitySolution.components.chartSelect.selectAChartAriaLabel",{defaultMessage:"Select a chart"}),Me=z.i18n.translate("xpack.securitySolution.components.chartSelect.tableOption",{defaultMessage:"Table"}),Fe=z.i18n.translate("xpack.securitySolution.components.chartSelect.trendOption",{defaultMessage:"Trend"}),De=z.i18n.translate("xpack.securitySolution.components.chartSelect.treemapOption",{defaultMessage:"Treemap"}),Ae="trend",_e=e=>{const t={"data-test-subj":e,icon:"visTable",name:Me};switch(e){case"table":return t;case Ae:return{"data-test-subj":e,icon:"visBarVerticalStacked",name:Fe};case"treemap":return{"data-test-subj":e,icon:"grid",name:De};default:return t}};var Ne=a(124);const Re=z.i18n.translate("xpack.securitySolution.components.chartSettingsPopover.ariaLabel",{defaultMessage:"Chart settings"}),Pe=({initialPanelId:e,isPopoverOpen:t,panels:a,setIsPopoverOpen:r})=>{const s=Object(n.useCallback)((()=>r((e=>!e))),[r]),o=Object(n.useCallback)((()=>r(!1)),[r]),l=Object(n.useMemo)((()=>i.a.createElement(V.EuiButtonIcon,{"aria-label":Re,color:"text",iconType:"boxesHorizontal",onClick:s,size:"xs"})),[s]);return i.a.createElement(V.EuiPopover,{anchorPosition:"downCenter",button:l,className:Ne.a,closePopover:o,isOpen:t,panelPaddingSize:"none"},i.a.createElement(V.EuiContextMenu,{initialPanelId:e,panels:a}))};Pe.displayName="ChartSettingsPopoverComponent";const Le=i.a.memo(Pe);var Be=a(556);const qe=z.i18n.translate("xpack.securitySolution.components.chartSettingsPopover.contextMenuItems.inspectTitle",{defaultMessage:"Inspect"}),ze=z.i18n.translate("xpack.securitySolution.components.chartSettingsPopover.contextMenuItems.resetGroupByFieldsMenuItem",{defaultMessage:"Reset group by fields"}),$e="default-initial-panel",Ve=({defaultStackByField:e,defaultStackByField1:t,onReset:a=v.noop,queryId:r,setStackBy:s,setStackByField1:o})=>{const l=Object(n.useCallback)((()=>{a(),s(e),null!=o&&o(t)}),[e,t,a,s,o]),{defaultInitialPanelId:c,defaultMenuItems:u,isPopoverOpen:d,setIsPopoverOpen:p}=(({onResetStackByFields:e,queryId:t})=>{const[a,i]=Object(n.useState)(!1),{handleClick:r}=Object(Be.a)({queryId:t}),s=Object(n.useMemo)((()=>[{id:$e,items:[{icon:"inspect",name:qe,onClick:()=>{i(!1),r()}},{name:ze,onClick:()=>{i(!1),e()}}]}]),[r,e]);return{defaultInitialPanelId:$e,defaultMenuItems:s,isPopoverOpen:a,setIsPopoverOpen:i}})({onResetStackByFields:l,queryId:r});return i.a.createElement(Le,{initialPanelId:c,isPopoverOpen:d,panels:u,setIsPopoverOpen:p})};Ve.displayName="ChartContextMenuComponent";const Ue=i.a.memo(Ve),He=H()(V.EuiIcon).withConfig({displayName:"ChartTypeIcon",componentId:"sc-o4fq00-0"})(["margin-right:",";"],(({theme:e})=>e.eui.euiSizeS)),Ge=({alertViewSelection:e,setAlertViewSelection:t})=>{const[a,r]=Object(n.useState)(!1),s=Object(n.useCallback)((()=>r(!1)),[]),o=Object(n.useCallback)((()=>r((e=>!e))),[]),l=Object(n.useMemo)((()=>{const t=_e(e);return i.a.createElement(V.EuiButton,{"aria-label":Ce,className:"kbnToolbarButton",color:"text","data-test-subj":"chartSelect",iconSide:"right",iconType:"arrowDown",onClick:o},i.a.createElement(He,{type:t.icon}),i.a.createElement("span",null,t.name))}),[e,o]),c=Object(n.useMemo)((()=>(({alertViewSelection:e,closePopover:t,setAlertViewSelection:a})=>[{id:0,items:[{..._e("table"),onClick:()=>{t(),a("table")}},{..._e("trend"),onClick:()=>{t(),a("trend")}},{..._e("treemap"),onClick:()=>{t(),a("treemap")}}]}])({alertViewSelection:e,closePopover:s,setAlertViewSelection:t})),[e,s,t]);return i.a.createElement(V.EuiPopover,{anchorPosition:"downLeft",button:l,closePopover:s,isOpen:a,panelPaddingSize:"none"},i.a.createElement(V.EuiContextMenu,{initialPanelId:0,panels:c}))};Ge.displayName="ChartSelectComponent";const Qe=i.a.memo(Ge);var We=a(45),Ke=a(117),Ye=a.n(Ke),Je=a(49),Xe=a(297),Ze=a(424),et=a(567);const tt=({riskScore:e,colorPalette:t})=>{const a=Math.min(100,t.length);return t[Object(v.clamp)(0,a,e)]},at=({buckets:e,maxRiskSubAggregations:t,stackByField0:a})=>e.flatMap((e=>(({bucket:e,maxRiskSubAggregations:t})=>{var a,n,i;return null!==(a=null===(n=e.stackByField1)||void 0===n||null===(i=n.buckets)||void 0===i?void 0:i.map((t=>{var a,n;return{doc_count:e.doc_count,key:null!==(a=e.key_as_string)&&void 0!==a?a:e.key,maxRiskSubAggregation:e.maxRiskSubAggregation,stackByField1Key:null!==(n=t.key_as_string)&&void 0!==n?n:t.key,stackByField1DocCount:t.doc_count}})))&&void 0!==a?a:[]})({bucket:e,maxRiskSubAggregations:t})));var nt=a(102);const it=z.i18n.translate("xpack.securitySolution.components.alertsTreemap.noDataLabel",{defaultMessage:"No data to display"}),rt=e=>z.i18n.translate("xpack.securitySolution.components.alertsTreemap.noDataReasonLabel",{values:{stackByField1:e},defaultMessage:"The {stackByField1} field was not present in any groups"}),st=({baseLabel:e,riskScore:t})=>null!=t?`${e} ${(e=>z.i18n.translate("xpack.securitySolution.components.alertsTreemap.riskLabel",{values:{riskScore:e},defaultMessage:"(Risk {riskScore})"}))(t)}`:e,ot=({bucket:e,colorPalette:t,maxRiskSubAggregations:a,showColor:n,stackByField0:i})=>{var r,s;return{color:n?tt({riskScore:null!==(r=a[e.key])&&void 0!==r?r:0,colorPalette:t}):void 0,count:e.doc_count,dataProviderId:Object(nt.h)(`draggable-legend-item-treemap-${i}-${e.key}-${Ye.a.v4()}`),render:()=>{var t,a;return st({baseLabel:null!==(t=e.key_as_string)&&void 0!==t?t:e.key,riskScore:null===(a=e.maxRiskSubAggregation)||void 0===a?void 0:a.value})},field:i,value:null!==(s=e.key_as_string)&&void 0!==s?s:e.key}},lt=({colorPalette:e,flattenedBucket:{key:t,stackByField1Key:a,stackByField1DocCount:n},maxRiskSubAggregations:i,stackByField0:r,stackByField1:s})=>{var o;return{color:tt({riskScore:null!==(o=i[t])&&void 0!==o?o:0,colorPalette:e}),count:n,dataProviderId:Object(nt.h)(`draggable-legend-item-treemap-${t}-${a}-${Ye.a.v4()}`),render:()=>`${a}`,field:`${s}`,value:`${a}`}},ct=({buckets:e,maxItems:t})=>{var a;return null!==(a=null==e?void 0:e.slice(0,t))&&void 0!==a?a:[]},ut=e=>e.reduce(((e,t)=>{var a,n;return{...e,[t.key]:null!==(a=null===(n=t.maxRiskSubAggregation)||void 0===n?void 0:n.value)&&void 0!==a?a:void 0}}),{}),dt=e=>null!=e&&""!==e.trim(),pt=e=>`${e}`,mt=e=>e.key,gt=H()(V.EuiText).withConfig({displayName:"NoDataLabel",componentId:"sc-t58uod-0"})(["text-align:center;"]),bt=({reason:e})=>i.a.createElement(V.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},i.a.createElement(V.EuiFlexItem,{grow:!0},i.a.createElement(gt,{color:"subdued","data-test-subj":"noDataLabel",size:"xs"},it),null!=e&&i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiSpacer,{size:"s"}),i.a.createElement(gt,{color:"subdued","data-test-subj":"reasonLabel",size:"xs"},e))));bt.displayName="NoDataComponent";const ft=i.a.memo(bt),yt=H.a.div.withConfig({displayName:"LegendContainer",componentId:"sc-m8zedo-0"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeS)),ht=H()(V.EuiFlexItem).withConfig({displayName:"ChartFlexItem",componentId:"sc-m8zedo-1"})(["min-height:",";"],(({$minChartHeight:e})=>`${e}px`)),Et=({addFilter:e,data:t,maxBuckets:a,minChartHeight:r=370,stackByField0:s,stackByField1:o})=>{var l,c;const u=Object(Xe.i)(),d=Object(n.useMemo)((()=>u.background.color),[u.background.color]),p=Object(n.useMemo)((()=>[{partition:{fillLabel:{valueFont:{fontWeight:700}},idealFontSizeJump:1.15,maxFontSize:16,minFontSize:4,sectorLineStroke:d,sectorLineWidth:1.5}}]),[d]),m=Object(n.useMemo)((()=>{var e,n;return ct({buckets:null===(e=t.aggregations)||void 0===e||null===(n=e.stackByField0)||void 0===n?void 0:n.buckets,maxItems:a})}),[null===(l=t.aggregations)||void 0===l||null===(c=l.stackByField0)||void 0===c?void 0:c.buckets,a]),g=Object(n.useMemo)((()=>ut(m)),[m]),b=Object(n.useMemo)((()=>at({buckets:m,maxRiskSubAggregations:g,stackByField0:s})),[m,g,s]),f=Object(n.useMemo)((()=>Array(101).fill(0).map(((e,t)=>t>=et.e?et.a:t>=et.f?et.b:t>=et.g?et.d:et.c))),[]),y=Object(n.useMemo)((()=>0===b.length?(({buckets:e,colorPalette:t,maxRiskSubAggregations:a,stackByField0:n})=>e.map((e=>ot({bucket:e,colorPalette:t,maxRiskSubAggregations:a,showColor:!0,stackByField0:n}))))({buckets:m,colorPalette:f,maxRiskSubAggregations:g,stackByField0:s}):(({buckets:e,colorPalette:t,flattenedBuckets:a,maxRiskSubAggregations:n,stackByField0:i,stackByField1:r})=>{const s=(({buckets:e,colorPalette:t,maxRiskSubAggregations:a,stackByField0:n})=>e.reduce(((e,i)=>({...e,[i.key]:[ot({bucket:i,colorPalette:t,maxRiskSubAggregations:a,showColor:!1,stackByField0:n})]})),{}))({buckets:e,colorPalette:t,maxRiskSubAggregations:n,stackByField0:i}),o=a.reduce(((e,a)=>{var s;return{...e,[a.key]:[...null!==(s=e[a.key])&&void 0!==s?s:[],lt({colorPalette:t,flattenedBucket:a,maxRiskSubAggregations:n,stackByField0:i,stackByField1:r})]}}),s);return e.reduce(((e,t)=>[...e,...o[t.key]]),[])})({buckets:m,colorPalette:f,flattenedBuckets:b,maxRiskSubAggregations:g,stackByField0:s,stackByField1:o})),[m,f,b,g,s,o]),h=Object(n.useCallback)((t=>{const{groupByField0:a,groupByField1:n}=(e=>{const t=e.flat(2);return{groupByField0:t.length>0&&"groupByRollup"in t[0]&&null!=t[0].groupByRollup?`${t[0].groupByRollup}`:"",groupByField1:t.length>1&&"groupByRollup"in t[1]&&null!=t[1].groupByRollup?`${t[1].groupByRollup}`:""}})(t);null==e||Object(v.isEmpty)(a.trim())||e({field:s,value:a}),null==e||Object(v.isEmpty)(null==o?void 0:o.trim())||Object(v.isEmpty)(n.trim())||e({field:`${o}`,value:n})}),[e,s,o]),E=Object(n.useMemo)((()=>dt(o)?(({colorPalette:e,layer0FillColor:t,maxRiskSubAggregations:a})=>[{fillLabel:{valueFormatter:pt},groupByRollup:mt,nodeLabel:e=>st({baseLabel:e,riskScore:a[e]}),shape:{fillColor:t}},{fillLabel:{valueFormatter:pt},groupByRollup:e=>e.stackByField1Key,nodeLabel:e=>`${e}`,shape:{fillColor:t=>{var n,i;const r=null!==(n=(e=>{var t,a;const n=(null!==(t=null===(a=e.path)||void 0===a?void 0:a.length)&&void 0!==t?t:0)-2;return Array.isArray(e.path)&&n>0?e.path[n].value:void 0})(t))&&void 0!==n?n:"";return tt({riskScore:null!==(i=a[r])&&void 0!==i?i:0,colorPalette:e})}}}])({colorPalette:f,layer0FillColor:d,maxRiskSubAggregations:g}):(({colorPalette:e,maxRiskSubAggregations:t})=>[{fillLabel:{valueFormatter:pt},groupByRollup:mt,nodeLabel:e=>st({baseLabel:e,riskScore:t[e]}),shape:{fillColor:a=>{var n;return tt({riskScore:null!==(n=t[a.dataName])&&void 0!==n?n:0,colorPalette:e})}}}])({colorPalette:f,maxRiskSubAggregations:g})),[f,d,g,o]),x=Object(n.useMemo)((()=>dt(o)?e=>e.stackByField1DocCount:e=>e.doc_count),[o]),k=dt(o)?b:m;return 0===m.length?i.a.createElement(ft,null):i.a.createElement("div",{"data-test-subj":"treemap"},i.a.createElement(V.EuiFlexGroup,{gutterSize:"none"},i.a.createElement(ht,{grow:!0,$minChartHeight:r},null==o||Object(v.isEmpty)(o)||0!==k.length?i.a.createElement(Je.Chart,null,i.a.createElement(Je.Settings,{baseTheme:u,showLegend:!1,theme:p,onElementClick:h}),i.a.createElement(Je.Partition,{data:k,id:"spec_1",layers:E,layout:Je.PartitionLayout.treemap,valueAccessor:x})):i.a.createElement(ft,{reason:rt(o)})),i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(yt,null,y.length>0&&i.a.createElement(Ze.a,{className:"eui-yScroll",height:r,legendItems:y,minWidth:300})))))},vt=i.a.memo(Et);var xt=a(623),kt=a(532),St=a(409);const jt=H()(V.EuiFlexItem).withConfig({displayName:"ChartOptionsFlexItem",componentId:"sc-ltb99n-0"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeS)),Ot=({chartOptionsContextMenu:e,setStackByField0:t,setStackByField0ComboboxInputRef:a,setStackByField1:n,setStackByField1ComboboxInputRef:r,stackByField0:s,stackByField0ComboboxRef:o,stackByField1:l,stackByField1ComboboxRef:c,stackByWidth:u,uniqueQueryId:d})=>i.a.createElement(V.EuiFlexGroup,{alignItems:"flexStart","data-test-subj":"fieldSelection",gutterSize:"none"},i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(xt.b,{"aria-label":St.a,ref:o,"data-test-subj":"groupBy",onSelect:t,prepend:St.a,selected:s,inputRef:a,width:u}),i.a.createElement(V.EuiSpacer,{size:"s"}),i.a.createElement(xt.b,{"aria-label":St.b,ref:c,"data-test-subj":"groupByTop",onSelect:n,prepend:St.b,selected:null!=l?l:"",inputRef:r,width:u})),i.a.createElement(V.EuiFlexItem,{grow:!1},null!=e&&i.a.createElement(jt,{grow:!1},e(d))));Ot.displayName="FieldSelectionComponent";const wt=i.a.memo(Ot);var Tt=a(119);const It=({stackByField1:e,stackByField1Size:t})=>null==e||Object(v.isEmpty)(e.trim())?{}:{stackByField1:{terms:{field:e,order:{_count:"desc"},size:t}}},Ct=({additionalFilters:e=[],from:t,runtimeMappings:a,stackByField0:n,stackByField0Size:i=1e3,stackByField1:r,stackByField1Size:s=1e3,riskSubAggregationField:o,to:l})=>({size:0,aggs:{stackByField0:{terms:{field:n,order:{_count:"desc"},size:i},aggs:{...It({stackByField1:r,stackByField1Size:s}),maxRiskSubAggregation:{max:{field:o}}}}},query:{bool:{filter:[...e,{range:{"@timestamp":{gte:t,lte:l}}}]}},runtime_mappings:a}),Mt=({addFilter:e,alignHeader:t,chartOptionsContextMenu:a,inspectTitle:r,isPanelExpanded:s,filters:o,height:l=504,query:c,riskSubAggregationField:u,runtimeMappings:d,setIsPanelExpanded:p,setStackByField0:m,setStackByField0ComboboxInputRef:g,setStackByField1:b,setStackByField1ComboboxInputRef:f,signalIndexName:y,stackByField0:h,stackByField0ComboboxRef:E,stackByField1:v,stackByField1ComboboxRef:x,stackByWidth:k,title:S})=>{const{to:j,from:O,deleteQuery:w,setQuery:C}=Object(Y.a)(!1),M=Object(n.useMemo)((()=>`alerts-treemap-${Ye.a.v4()}`),[]),F=Object(n.useMemo)((()=>{try{var e;return[Object(We.buildEsQuery)(void 0,null!=c?[c]:[],null!==(e=null==o?void 0:o.filter((e=>!1===e.meta.disabled)))&&void 0!==e?e:[])]}catch(e){return[]}}),[c,o]),{data:D,loading:A,refetch:_,request:N,response:R,setQuery:P}=Object(T.a)({query:Ct({additionalFilters:F,from:O,riskSubAggregationField:u,runtimeMappings:d,stackByField0:h,stackByField1:v,to:j}),skip:!s,indexName:y,queryName:I.a.TREE_MAP});return Object(n.useEffect)((()=>{P(Ct({additionalFilters:F,from:O,riskSubAggregationField:u,runtimeMappings:d,stackByField0:h,stackByField1:v,to:j}))}),[F,O,u,d,P,h,v,j]),Object(kt.a)({deleteQuery:w,loading:A,response:R,setQuery:C,refetch:_,request:N,uniqueQueryId:M}),i.a.createElement(Ne.c,null,i.a.createElement(xt.a,{className:"eui-yScroll","data-test-subj":"treemapPanel",hasBorder:!0,height:s?l:64,$overflowY:s?"auto":"hidden",$toggleStatus:!0},i.a.createElement(Tt.a,{alignHeader:t,hideSubtitle:!0,id:M,inspectTitle:r,outerDirection:"row",showInspectButton:null==a,title:S,titleSize:"s",toggleQuery:p,toggleStatus:s},s&&i.a.createElement(wt,{chartOptionsContextMenu:a,setStackByField0:m,setStackByField0ComboboxInputRef:g,setStackByField1:b,setStackByField1ComboboxInputRef:f,stackByField0:h,stackByField0ComboboxRef:E,stackByField1:v,stackByField1ComboboxRef:x,stackByWidth:k,uniqueQueryId:M})),A&&s?i.a.createElement(V.EuiProgress,{color:"accent","data-test-subj":"progress",position:"absolute",size:"xs"}):i.a.createElement(i.a.Fragment,null,null!=D&&s&&i.a.createElement(vt,{addFilter:e,data:D,maxBuckets:1e3,stackByField0:h,stackByField1:v}))))};Mt.displayName="AlertsTreemapPanelComponent";const Ft=i.a.memo(Mt),Dt=()=>{const e=Object(n.useRef)(null),[t,a]=Object(n.useState)(null),i=Object(n.useCallback)((()=>{var a;null===(a=e.current)||void 0===a||a.clearSearchValue(),null!=t&&(t.value="")}),[t]);return{comboboxRef:e,onReset:i,setComboboxInputRef:a}};var At=a(586);const _t=1e3,Nt=({additionalFilters:e=[],from:t,runtimeMappings:a,stackByField0:n,stackByField1:i,to:r})=>({size:0,aggs:{stackByField0:{terms:{field:n,order:{_count:"desc"},size:_t},aggs:{...It({stackByField1:i,stackByField1Size:1e3})}}},query:{bool:{filter:[...e,{range:{"@timestamp":{gte:t,lte:r}}}]}},runtime_mappings:a}),Rt=z.i18n.translate("xpack.securitySolution.detectionEngine.alerts.count.countTableColumnTitle",{defaultMessage:"Count of records"}),Pt=z.i18n.translate("xpack.securitySolution.detectionEngine.alerts.count.countTableTitle",{defaultMessage:"Count"}),Lt=({fieldName:e,topN:t})=>z.i18n.translate("xpack.securitySolution.detectionEngine.alerts.count.columnLabel",{values:{fieldName:e,topN:t},defaultMessage:"Top {topN} values of {fieldName}"});var Bt=a(44),qt=a.n(Bt),zt=a(88);const $t=H.a.div.withConfig({displayName:"Wrapper",componentId:"sc-1p6ej67-0"})(["margin-top:-",";"],(({theme:e})=>e.eui.euiSizeS)),Vt=({data:e,loading:t,stackByField0:a,stackByField1:r})=>{var o,l;const[c]=Object(p.q)(s.Z),u=Object(n.useMemo)((()=>Object(v.isEmpty)(null==r?void 0:r.trim())?(({defaultNumberFormat:e,stackByField0:t})=>[{"data-test-subj":"stackByField0Key",field:"key",name:t,render:function(e){return i.a.createElement(zt.b,{isDraggable:!1,field:t,hideTopN:!0,id:`alert-count-draggable-stackByField0-${t}-${e}`,value:e,tooltipContent:null})},truncateText:!1},{"data-test-subj":"doc_count",dataType:"number",field:"doc_count",name:Rt,render:t=>qt()(t).format(e),sortable:!0,textOnly:!0}])({defaultNumberFormat:c,stackByField0:a}):(({defaultNumberFormat:e,stackByField0:t,stackByField1:a})=>[{"data-test-subj":"stackByField0Key",field:"key",name:Lt({fieldName:t,topN:_t}),render:function(e){return i.a.createElement(zt.b,{isDraggable:!1,field:t,hideTopN:!0,id:`alert-count-draggable-stackByField0-${t}-${a}-${e}`,value:e,tooltipContent:null})},truncateText:!1},{"data-test-subj":"stackByField1Key",field:"stackByField1Key",name:Lt({fieldName:null!=a?a:"",topN:1e3}),render:function(e){return i.a.createElement(zt.b,{isDraggable:!1,field:null!=a?a:"",hideTopN:!0,id:`alert-count-draggable-stackByField1-${t}-${a}-${e}`,value:e,tooltipContent:null})},truncateText:!1},{"data-test-subj":"stackByField1DocCount",dataType:"number",field:"stackByField1DocCount",name:Rt,render:t=>qt()(t).format(e),sortable:!0,textOnly:!0}])({defaultNumberFormat:c,stackByField0:a,stackByField1:r})),[c,a,r]),d=Object(n.useMemo)((()=>{var t,a;return ct({buckets:null===(t=e.aggregations)||void 0===t||null===(a=t.stackByField0)||void 0===a?void 0:a.buckets,maxItems:_t})}),[null===(o=e.aggregations)||void 0===o||null===(l=o.stackByField0)||void 0===l?void 0:l.buckets]),m=Object(n.useMemo)((()=>ut(d)),[d]),g=Object(n.useMemo)((()=>Object(v.isEmpty)(null==r?void 0:r.trim())?d:at({buckets:d,maxRiskSubAggregations:m,stackByField0:a})),[d,m,a,r]);return i.a.createElement($t,{"data-test-subj":"alertsCountTable",className:"eui-yScroll"},i.a.createElement(V.EuiInMemoryTable,{isSelectable:!1,columns:u,items:g,loading:t,sorting:!0}))};Vt.displayName="AlertsCountComponent";const Ut=i.a.memo(Vt);var Ht=a(109);const Gt=Object(n.memo)((({alignHeader:e,chartOptionsContextMenu:t,filters:a,inspectTitle:r,panelHeight:s,query:o,runtimeMappings:l,setStackByField0:c,setStackByField0ComboboxInputRef:u,setStackByField1:d,setStackByField1ComboboxInputRef:p,signalIndexName:m,stackByField0:g,stackByField0ComboboxRef:b,stackByField1:f,stackByField1ComboboxRef:y,stackByWidth:h,title:E=Pt})=>{const{to:v,from:x,deleteQuery:k,setQuery:S}=Object(Y.a)(!1),j=Object(n.useMemo)((()=>`detections-alerts-count-${Ye.a.v4()}`),[]),O=Object(n.useMemo)((()=>{try{var e;return[Object(We.buildEsQuery)(void 0,null!=o?[o]:[],null!==(e=null==a?void 0:a.filter((e=>!1===e.meta.disabled)))&&void 0!==e?e:[])]}catch(e){return[]}}),[o,a]),{toggleStatus:w,setToggleStatus:C}=Object(Ht.a)("detections-alerts-count"),[M,F]=Object(n.useState)(!w);Object(n.useEffect)((()=>{F(!w)}),[w]);const D=Object(n.useCallback)((e=>{C(e),F(!e)}),[F,C]),{loading:A,data:_,setQuery:N,response:R,request:P,refetch:L}=Object(T.a)({query:Nt({stackByField0:g,stackByField1:f,from:x,to:v,additionalFilters:O,runtimeMappings:l}),indexName:m,skip:M,queryName:I.a.COUNT});return Object(n.useEffect)((()=>{N(Nt({additionalFilters:O,from:x,runtimeMappings:l,stackByField0:g,stackByField1:f,to:v}))}),[O,x,l,N,g,f,v]),Object(kt.a)({setQuery:S,response:R,request:P,refetch:L,uniqueQueryId:j,deleteQuery:k,loading:A}),i.a.createElement(Ne.c,{show:w},i.a.createElement(xt.a,{$toggleStatus:w,"data-test-subj":"alertsCountPanel",hasBorder:!0,height:s},i.a.createElement(Tt.a,{alignHeader:e,id:j,inspectTitle:r,outerDirection:"row",title:E,titleSize:"s",hideSubtitle:!0,showInspectButton:null==t,toggleStatus:w,toggleQuery:D},i.a.createElement(wt,{chartOptionsContextMenu:t,setStackByField0:c,setStackByField0ComboboxInputRef:u,setStackByField1:d,setStackByField1ComboboxInputRef:p,stackByField0:g,stackByField0ComboboxRef:b,stackByField1:f,stackByField1ComboboxRef:y,stackByWidth:h,uniqueQueryId:j})),w&&null!=_&&i.a.createElement(Ut,{data:_,loading:A,stackByField0:g,stackByField1:f})))}));Gt.displayName="AlertsCountPanel";const Qt=H()(V.EuiFlexItem).withConfig({displayName:"FullHeightFlexItem",componentId:"sc-p2i2qk-0"})(["height:100%;"]),Wt=H.a.div.withConfig({displayName:"ChartSelectContainer",componentId:"sc-p2i2qk-1"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeS)),Kt=({addFilter:e,alertsHistogramDefaultFilters:t,isLoadingIndexPattern:a,query:r,runtimeMappings:s,signalIndexName:o,updateDateRangeCallback:l})=>{const{alertViewSelection:c,countTableStackBy0:u,countTableStackBy1:d,isTreemapPanelExpanded:p,riskChartStackBy0:m,riskChartStackBy1:g,setAlertViewSelection:b,setCountTableStackBy0:f,setCountTableStackBy1:y,setIsTreemapPanelExpanded:h,setRiskChartStackBy0:E,setRiskChartStackBy1:v,setTrendChartStackBy:x,trendChartStackBy:k}=(()=>{const[e,t]=Object(ve.a)({defaultValue:Ae,key:xe({category:"view",page:Se,setting:"alert-view-selection"}),isInvalidDefault:ke}),[a,n]=Object(ve.a)({defaultValue:!0,key:xe({category:Oe,page:Se,setting:"expand"})}),[i,r]=Object(ve.a)({defaultValue:Ie.a,key:xe({category:Oe,page:Se,setting:we}),isInvalidDefault:ke}),[s,o]=Object(ve.a)({defaultValue:Ie.b,key:xe({category:Oe,page:Se,setting:Te})}),[l,c]=Object(ve.a)({defaultValue:Ie.a,key:xe({category:je,page:Se,setting:we}),isInvalidDefault:ke}),[u,d]=Object(ve.a)({defaultValue:Ie.b,key:xe({category:je,page:Se,setting:Te})}),[p,m]=Object(ve.a)({defaultValue:Ie.a,key:xe({category:"trend",page:Se,setting:"stack-by"}),isInvalidDefault:ke});return{alertViewSelection:e,countTableStackBy0:l,countTableStackBy1:u,isTreemapPanelExpanded:a,riskChartStackBy0:i,riskChartStackBy1:s,setAlertViewSelection:t,setCountTableStackBy0:c,setCountTableStackBy1:d,setIsTreemapPanelExpanded:n,setRiskChartStackBy0:r,setRiskChartStackBy1:o,setTrendChartStackBy:m,trendChartStackBy:p}})(),S=Object(n.useCallback)((e=>{x(e),f(e),E(e)}),[f,E,x]),j=Object(n.useCallback)((e=>{y(e),v(e)}),[y,v]),{comboboxRef:O,onReset:w,setComboboxInputRef:T}=Dt(),{comboboxRef:I,onReset:C,setComboboxInputRef:M}=Dt(),F=Object(n.useCallback)((()=>{w(),C()}),[w,C]),D=Object(n.useCallback)((e=>i.a.createElement(Ue,{defaultStackByField:Ie.a,defaultStackByField1:Ie.b,onReset:F,queryId:e,setStackBy:S,setStackByField1:j})),[F,S,j]),A=Object(n.useMemo)((()=>i.a.createElement(Wt,null,i.a.createElement(Qe,{alertViewSelection:c,setAlertViewSelection:b}))),[c,b]);return i.a.createElement("div",{"data-test-subj":"chartPanels"},"trend"===c&&i.a.createElement(Qt,{grow:2},a?i.a.createElement(V.EuiLoadingSpinner,{"data-test-subj":"trendLoadingSpinner",size:"xl"}):i.a.createElement(At.a,{alignHeader:"flexStart",chartHeight:127,chartOptionsContextMenu:D,comboboxRef:O,defaultStackByOption:k,filters:t,inspectTitle:Fe,setComboboxInputRef:T,onFieldSelected:S,panelHeight:256,query:r,showCountsInLegend:!0,showGroupByPlaceholder:!0,showTotalAlertsCount:!1,stackByLabel:St.a,title:A,titleSize:"s",signalIndexName:o,updateDateRange:l,runtimeMappings:s})),"table"===c&&i.a.createElement(Qt,{grow:1},a?i.a.createElement(V.EuiLoadingSpinner,{"data-test-subj":"tableLoadingSpinner",size:"xl"}):i.a.createElement(Gt,{alignHeader:"flexStart",chartOptionsContextMenu:D,filters:t,inspectTitle:Me,panelHeight:330,query:r,runtimeMappings:s,setStackByField0:S,setStackByField0ComboboxInputRef:T,stackByField0ComboboxRef:O,setStackByField1:j,setStackByField1ComboboxInputRef:M,stackByField1ComboboxRef:I,signalIndexName:o,stackByField0:u,stackByField1:d,title:A})),"treemap"===c&&i.a.createElement(Qt,{grow:1},a?i.a.createElement(V.EuiLoadingSpinner,{"data-test-subj":"treemapLoadingSpinner",size:"xl"}):i.a.createElement(Ft,{addFilter:e,alignHeader:"flexStart",chartOptionsContextMenu:D,inspectTitle:De,isPanelExpanded:p,filters:t,query:r,setIsPanelExpanded:h,setStackByField0:S,setStackByField0ComboboxInputRef:T,stackByField0ComboboxRef:O,setStackByField1:j,setStackByField1ComboboxInputRef:M,stackByField1ComboboxRef:I,signalIndexName:o,stackByField0:m,stackByField1:g,title:A,riskSubAggregationField:"kibana.alert.risk_score",runtimeMappings:s})))},Yt=i.a.memo(Kt);var Jt=a(683),Xt=a(843),Zt=a(587),ea=a(888),ta=a(220),aa=a(320);const na=H.a.div.withConfig({displayName:"StyledFullHeightContainer",componentId:"sc-7rr6ls-0"})(["display:flex;flex-direction:column;flex:1 1 auto;"]),ia=({clearEventsDeleted:e,clearEventsLoading:t})=>{const a=Object(o.useDispatch)(),r=Object(n.useRef)(null),s=Object(n.useMemo)((()=>W.b.getTableByIdSelector()),[]),l=Object(x.b)((e=>{var t;return(null!==(t=s(e,u.g.alertsOnAlertsPage))&&void 0!==t?t:Q.a).graphEventId})),c=Object(x.b)((e=>{var t;return(null!==(t=s(e,u.g.alertsOnAlertsPage))&&void 0!==t?t:Q.a).updated})),m=Object(x.b)((e=>{var t;return(null!==(t=s(e,u.g.alertsOnAlertsPage))&&void 0!==t?t:Q.a).isLoading})),f=Object(n.useMemo)((()=>ee.d.globalFiltersQuerySelector()),[]),h=Object(n.useMemo)((()=>ee.d.globalQuerySelector()),[]),E=Object(x.a)(h),S=Object(x.a)(f),{to:j,from:O}=Object(Y.a)(),{globalFullScreen:w}=Object(fe.a)(),[{loading:T,isAuthenticated:I,hasEncryptionKey:C,signalIndexName:M,hasIndexWrite:F=!1,hasIndexMaintenance:D=!1,canUserREAD:A,hasIndexRead:_}]=Object(le.b)(),{loading:N,needsConfiguration:R}=Object(me.a)(),{indexPattern:P,runtimeMappings:L,loading:B}=Object(g.d)(b.SourcererScopeName.detections),{formatUrl:q}=Object(d.n)(k.a.rules),[z,$]=Object(n.useState)(!1),[U,H]=Object(n.useState)(!1),ne=T||N,{application:{navigateToUrl:ie},timelines:re,data:se,docLinks:de}=Object(p.k)().services,[ve,xe]=Object(n.useState)(ea.b),{filterManager:ke}=se.query,Se=Object(n.useCallback)((({field:e,value:t})=>{ke.addFilters([{meta:{alias:null,disabled:!1,negate:!1},query:{match_phrase:{[e]:t}}}])}),[ke]),je=Object(n.useMemo)((()=>m||ne),[m,ne]),Oe=Object(n.useCallback)((({x:e})=>{if(!e)return;const[t,n]=e;a(Object(te.setAbsoluteRangeDatePicker)({id:K.a.global,from:new Date(t).toISOString(),to:new Date(n).toISOString()}))}),[a]),we=Object(n.useCallback)((e=>{e.preventDefault(),ie(q(Object(X.e)()))}),[q,ie]),Te=Object(n.useCallback)((a=>{const n=u.g.alertsOnAlertsPage;t({id:n}),e({id:n}),xe(a)}),[t,e,xe]),Ie=Object(n.useMemo)((()=>[...S,...Object(Ee.d)(z),...Object(Ee.a)(ve),...Object(Ee.e)(U)]),[S,z,U,ve]),Ce=Object(n.useMemo)((()=>[...Object(Ee.d)(z),...Object(Ee.e)(U)]),[z,U]),Me=Object(n.useCallback)((e=>{$(e)}),[$]),Fe=Object(n.useCallback)((e=>{H(e)}),[H]),{signalIndexNeedsInit:De,pollForSignalIndex:Ae}=Object(Jt.a)(),_e=Object(n.useCallback)((()=>{Object(he.j)(r.current)}),[r]),Ne=Object(n.useCallback)((()=>{Object(he.m)()}),[]),Re=Object(n.useCallback)((e=>{Object(G.isTab)(e)&&Object(he.l)({containerElement:r.current,keyboardEvent:e,onSkipFocusBeforeEventsTable:_e,onSkipFocusAfterEventsTable:Ne})}),[r,_e,Ne]),Pe=Object(n.useMemo)((()=>({feature:{icon:"documents",label:ue.e,url:`${de.links.siem.privileges}`,target:"_blank"}})),[de]);return ne?i.a.createElement(y.a,null,i.a.createElement(ta.a,{border:!0,title:ue.m,isLoading:ne}),i.a.createElement(V.EuiFlexGroup,{justifyContent:"center",alignItems:"center"},i.a.createElement(V.EuiLoadingSpinner,{size:"xl"}))):null==I||I||ne?!ne&&De||R?i.a.createElement(y.a,null,i.a.createElement(ta.a,{border:!0,title:ue.m}),i.a.createElement(pe,{needsSignalsIndex:De,needsListsIndex:R})):i.a.createElement(i.a.Fragment,null,null!=C&&!C&&i.a.createElement(oe,null),i.a.createElement(Xt.a,null),i.a.createElement(Zt.a,null),De||!1!==_&&!1!==A?!De&&_&&A?i.a.createElement(na,{onKeyDown:Re,ref:r},i.a.createElement(V.EuiWindowEvent,{event:"resize",handler:v.noop}),i.a.createElement(J.a,{show:Object(he.n)({globalFullScreen:w,graphEventId:l})},i.a.createElement(Z.a,{id:K.a.global,pollForSignalIndex:Ae,indexPattern:P})),i.a.createElement(y.a,{noPadding:w,"data-test-subj":"detectionsAlertsPage"},i.a.createElement(ye.a,{show:!w},i.a.createElement(ta.a,{title:ue.m},i.a.createElement(be.l,{onClick:we,deepLinkId:k.a.rules,"data-test-subj":"manage-alert-detection-rules",fill:!0},ue.c)),i.a.createElement(V.EuiHorizontalRule,{margin:"m"}),i.a.createElement(V.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween"},i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(ea.a,{status:ve,onFilterGroupChanged:Te})),i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},i.a.createElement(V.EuiFlexItem,{grow:!1},c&&re.getLastUpdated({updatedAt:c||Date.now(),showUpdating:je}))))),i.a.createElement(V.EuiSpacer,{size:"m"}),i.a.createElement(Yt,{addFilter:Se,alertsHistogramDefaultFilters:Ie,isLoadingIndexPattern:B,query:E,runtimeMappings:L,signalIndexName:M,updateDateRangeCallback:Oe}),i.a.createElement(V.EuiSpacer,{size:"l"})),i.a.createElement(ae.a,{tableId:u.g.alertsOnAlertsPage,loading:ne,hasIndexWrite:null!=F&&F,hasIndexMaintenance:null!=D&&D,from:O,defaultFilters:Ce,showBuildingBlockAlerts:z,onShowBuildingBlockAlertsChanged:Me,showOnlyThreatIndicatorAlerts:U,onShowOnlyThreatIndicatorAlertsChanged:Fe,to:j,filterGroup:ve}))):i.a.createElement(aa.a,null):i.a.createElement(ce.a,{actions:Pe,message:ue.b,"data-test-subj":"no_feature_permissions-alerts",title:ue.d})):i.a.createElement(y.a,null,i.a.createElement(ta.a,{border:!0,title:ue.m}),i.a.createElement(ge,null))},ra=Object(o.connect)(null,(e=>({clearSelected:({id:t})=>e(W.a.clearSelected({id:t})),clearEventsLoading:({id:t})=>e(W.a.clearEventsLoading({id:t})),clearEventsDeleted:({id:t})=>e(W.a.clearEventsDeleted({id:t}))})))(i.a.memo(ia)),sa=z.i18n.translate("xpack.securitySolution.badge.readOnly.text",{defaultMessage:"Read only"});var oa=a(217);function la(e){const{hasKibanaREAD:t,hasKibanaCRUD:a}=Object(oa.a)(),i=Object(p.k)().services.chrome;Object(n.useEffect)((()=>(t&&!a&&i.setBadge({text:sa,tooltip:e,iconType:"glasses"}),()=>{i.setBadge()})),[i,t,a,e])}var ca=a(135),ua=a(104);const da=(e,t,a)=>{const n=a[e];return Array.isArray(n)?n.map((e=>Object(v.getOr)(null,t,e))).filter((e=>null!==e)):Object(v.getOr)(void 0,t,n)},pa=e=>{const t=Object(n.useMemo)((()=>e),[e]),a=Object(n.useMemo)((()=>({})),[]),i=Object(n.useCallback)(((e,t)=>{a[e]=t}),[a]);return Object(n.useCallback)((e=>{let n;return n=Object.hasOwn(a,e)?a[e]:t?((e,t,a)=>{if(e&&t){if(Object.hasOwn(t,e))return t[e];{const n=(e=>{const t=(e=>{const t=RegExp("[.]","g"),a=[];let n=t.exec(e);for(;n;)a.push(n.index),n=t.exec(e);return a.reverse()})(e);return t.map((t=>[e.slice(0,t),e.slice(t+1)]))})(e);for(const[i,r]of n)if(Object.hasOwn(t,i)&&t[i]){const n=da(i,r,t);return a(e,n),n}}}})(e,t,i):void 0,Array.isArray(n)&&0===n.length?void 0:n}),[i,a,t])};var ma=a(690),ga=a(380),ba=a(580);const fa=(e,t)=>`${s.d}/${e}/${t}`;var ya=a(151),ha=a(590);const Ea=Object(n.memo)((({eventId:e})=>i.a.createElement(V.EuiEmptyPrompt,{"data-test-subj":"alert-details-page-loading",color:"subdued",icon:i.a.createElement(V.EuiLoadingSpinner,{"data-test-subj":"loading-spinner",size:"l"}),body:i.a.createElement("p",null,ba.d)})));Ea.displayName="AlertDetailsLoadingPage";const va=Object(n.memo)((({eventId:e})=>i.a.createElement(V.EuiEmptyPrompt,{color:"danger","data-test-subj":"alert-details-page-error",iconType:"alert",title:i.a.createElement("h2",null,ba.c),body:i.a.createElement("div",null,i.a.createElement("p",null,ba.b),i.a.createElement("p",null,i.a.createElement(V.EuiCode,{style:{wordWrap:"break-word",overflowWrap:"break-word"}},`_id: ${e}`)))})));va.displayName="AlertDetailsErrorPage";var xa=a(101);const ka=i.a.memo((({loading:e,ruleName:t,timestamp:a})=>i.a.createElement(ta.a,{badgeOptions:{beta:!0,text:ba.a},border:!0,isLoading:e,subtitle:a?i.a.createElement(xa.c,{value:new Date(a)}):"",title:t})));ka.displayName="AlertDetailsHeader";var Sa=a(870),ja=a(292),Oa=a(375),wa=a(36),Ta=a(211);const Ia=({children:e,grow:t})=>i.a.createElement(V.EuiFlexItem,{grow:t},i.a.createElement(Fa,{direction:"column",wrap:!1},e)),Ca=({children:e,grow:t})=>i.a.createElement(V.EuiFlexItem,{grow:t},i.a.createElement(V.EuiFlexGroup,{direction:"row",wrap:!0},e)),Ma=({actionsClassName:e,children:t,description:a,grow:n=!1,renderActionsPopover:r,title:s})=>i.a.createElement(V.EuiFlexItem,{grow:n},i.a.createElement(V.EuiPanel,{hasShadow:!1,hasBorder:!0},i.a.createElement(Ta.a,{targetClassNames:[null!=e?e:""]},i.a.createElement(V.EuiFlexGroup,{direction:"row",justifyContent:"spaceBetween"},i.a.createElement(V.EuiFlexItem,null,i.a.createElement(V.EuiTitle,{size:"s"},i.a.createElement("h3",null,s)),i.a.createElement(V.EuiSpacer,{size:"xs"}),a&&i.a.createElement(V.EuiText,{color:"subdued",size:"xs"},i.a.createElement("p",null,a))),e&&r?i.a.createElement(V.EuiFlexItem,{grow:!1},r()):null)),i.a.createElement(V.EuiSpacer,{size:"l"}),t));var Fa=H()(V.EuiFlexGroup).withConfig({displayName:"_StyledEuiFlexGroup",componentId:"sc-1kibu94-0"})(["flex-wrap:nowrap;"]);const Da=z.i18n.translate("xpack.securitySolution.alerts.alertDetails.summary.cases.title",{defaultMessage:"Cases"}),Aa=z.i18n.translate("xpack.securitySolution.alerts.alertDetails.summary.cases.status",{defaultMessage:"Status"}),_a=z.i18n.translate("xpack.securitySolution.alerts.alertDetails.summary.alertReason.title",{defaultMessage:"Alert reason"}),Na=z.i18n.translate("xpack.securitySolution.alerts.alertDetails.summary.rule.title",{defaultMessage:"Rule"}),Ra=z.i18n.translate("xpack.securitySolution.alerts.alertDetails.summary.host.title",{defaultMessage:"Host"}),Pa=z.i18n.translate("xpack.securitySolution.alerts.alertDetails.summary.user.title",{defaultMessage:"User"}),La=z.i18n.translate("xpack.securitySolution.alerts.alertDetails.summary.rule.name",{defaultMessage:"Rule name"}),Ba=z.i18n.translate("xpack.securitySolution.alerts.alertDetails.summary.rule.riskScore",{defaultMessage:"Risk score"}),qa=z.i18n.translate("xpack.securitySolution.alerts.alertDetails.summary.rule.severity",{defaultMessage:"Severity"}),za=z.i18n.translate("xpack.securitySolution.alerts.alertDetails.summary.rule.description",{defaultMessage:"Rule description"}),$a=z.i18n.translate("xpack.securitySolution.alerts.alertDetails.summary.rule.action.openRuleDetailsPage",{defaultMessage:"Open rule details page"}),Va=z.i18n.translate("xpack.securitySolution.alerts.alertDetails.summary.case.noCasesFound",{defaultMessage:"Related cases were not found for this alert"}),Ua=z.i18n.translate("xpack.securitySolution.alerts.alertDetails.summary.case.loading",{defaultMessage:"Loading related cases..."}),Ha=z.i18n.translate("xpack.securitySolution.alerts.alertDetails.summary.case.error",{defaultMessage:"Error loading related cases"}),Ga=z.i18n.translate("xpack.securitySolution.alerts.alertDetails.summary.case.noRead",{defaultMessage:"You do not have the required permissions to view related cases. If you need to view cases, contact your Kibana administrator"}),Qa=z.i18n.translate("xpack.securitySolution.alerts.alertDetails.summary.case.addToExistingCase",{defaultMessage:"Add to existing case"}),Wa=z.i18n.translate("xpack.securitySolution.alerts.alertDetails.summary.case.addToNewCase",{defaultMessage:"Add to new case"}),Ka=z.i18n.translate("xpack.securitySolution.alerts.alertDetails.summary.host.hostName.title",{defaultMessage:"Host name"}),Ya=z.i18n.translate("xpack.securitySolution.alerts.alertDetails.summary.host.osName.title",{defaultMessage:"Operating system"}),Ja=z.i18n.translate("xpack.securitySolution.alerts.alertDetails.summary.host.agentStatus.title",{defaultMessage:"Agent status"}),Xa=z.i18n.translate("xpack.securitySolution.alerts.alertDetails.summary.ipAddresses.title",{defaultMessage:"IP addresses"}),Za=z.i18n.translate("xpack.securitySolution.alerts.alertDetails.summary.lastSeen.title",{defaultMessage:"Last seen"}),en=z.i18n.translate("xpack.securitySolution.alerts.alertDetails.summary.host.action.viewHostSummary",{defaultMessage:"View host summary"}),tn=z.i18n.translate("xpack.securitySolution.alerts.alertDetails.summary.host.action.openHostDetailsPage",{defaultMessage:"Open host details page"}),an=z.i18n.translate("xpack.securitySolution.alerts.alertDetails.summary.host.riskScore",{defaultMessage:"Host risk score"}),nn=z.i18n.translate("xpack.securitySolution.alerts.alertDetails.summary.host.riskClassification",{defaultMessage:"Host risk classification"}),rn=z.i18n.translate("xpack.securitySolution.alerts.alertDetails.summary.user.userName.title",{defaultMessage:"User name"}),sn=z.i18n.translate("xpack.securitySolution.alerts.alertDetails.summary.user.riskScore",{defaultMessage:"User risk score"}),on=z.i18n.translate("xpack.securitySolution.alerts.alertDetails.summary.user.riskClassification",{defaultMessage:"User risk classification"}),ln=z.i18n.translate("xpack.securitySolution.alerts.alertDetails.summary.user.action.viewUserSummary",{defaultMessage:"View user summary"}),cn=z.i18n.translate("xpack.securitySolution.alerts.alertDetails.summary.user.action.openUserDetailsPage",{defaultMessage:"Open user details page"}),un=z.i18n.translate("xpack.securitySolution.alerts.alertDetails.summary.panelMoreActions",{defaultMessage:"More actions"}),dn=H.a.div.withConfig({displayName:"RendererContainer",componentId:"sc-1m0yfgv-0"})(["overflow-x:auto;margin-left:-24px;& .euiFlexGroup{justify-content:flex-start;}"]),pn=i.a.memo((({dataAsNestedObject:e})=>{const t=Object(n.useMemo)((()=>null!=e?Object(Oa.a)({data:e,rowRenderers:ja.b}):null),[e]);return i.a.createElement(Ma,{title:_a},null!=t&&null!=e&&i.a.createElement("div",null,i.a.createElement(dn,{"data-test-subj":"alert-renderer-panel"},t.renderRow({data:e,isDraggable:!1,scopeId:ua.d.detectionsAlertDetailsPage}))))}));pn.displayName="AlertRendererPanel";var mn=a(390),gn=a(182),bn=a(196),fn=a(871);const yn=(e,t)=>{var a;const n=null==t||null===(a=t.find((t=>t.field===e)))||void 0===a?void 0:a.values;return n&&n.length>0?n[0]:""},hn="rule-panel-actions-trigger",En=i.a.memo((({className:e,ruleUuid:t})=>{const[a,r]=Object(n.useState)(!1),{href:s}=Object(be.o)()({deepLinkId:k.a.rules,path:Object(d.j)(t)}),o=Object(n.useCallback)((()=>{r(!a)}),[a]),l=()=>{r(!1)},c=Object(n.useMemo)((()=>[i.a.createElement(V.EuiContextMenuItem,{icon:"popout",key:"ruleActionsOpenRuleDetailsPage","data-test-subj":"rule-panel-actions-open-rule-details",onClick:l,href:s,target:"_blank"},$a)]),[s]),u=Object(n.useMemo)((()=>i.a.createElement(V.EuiButtonIcon,{"aria-label":un,className:hn,iconType:"boxesHorizontal",onClick:o})),[o]);return i.a.createElement("div",{className:e},i.a.createElement(V.EuiPopover,{button:u,isOpen:a,closePopover:l,panelPaddingSize:"none",anchorPosition:"downLeft",panelClassName:"withHoverActions__popover"},i.a.createElement(V.EuiContextMenuPanel,{"data-test-subj":"rule-actions-panel",size:"s",items:c})))}));En.displayName="RulePanelActions";const vn=wa.css`
  flex-wrap: nowrap;
  & .euiFlexGroup {
    flex-wrap: nowrap;
  }
`,xn=({grow:e,title:t,children:a,"data-test-subj":n})=>i.a.createElement(V.EuiFlexItem,{grow:e,"data-test-subj":n},i.a.createElement(V.EuiTitle,{size:"xxs"},i.a.createElement("h5",null,t)),i.a.createElement(V.EuiSpacer,{size:"xs"}),a),kn=i.a.memo((({data:e,id:t,searchHit:a,browserFields:r})=>{var s,o;const l=Object(n.useMemo)((()=>yn(ca.L,e)),[e]),c=Object(n.useMemo)((()=>Object(fn.a)(a)),[a]),u=Object(n.useMemo)((()=>yn(ca.k,e)),[e]),d=Object(n.useMemo)((()=>yn(ca.N,e)),[e]),p=Object(n.useMemo)((()=>yn(ca.q,e)),[e]),m=!!c&&(null==c?void 0:c.length)>0,g=Object(n.useCallback)((()=>i.a.createElement(En,{ruleUuid:l})),[l]),b=Object(n.useMemo)((()=>{const a=Object(v.find)({field:ca.x,category:ca.fb},e),n=Object(v.find)({field:ca.L,category:ca.fb},e);return a&&Object(gn.b)({eventId:t,contextId:ua.d.detectionsAlertDetailsPage,scopeId:ua.d.detectionsAlertDetailsPage,browserFields:r,item:a,linkValueField:n})}),[r,e,t]);return i.a.createElement(Ma,{actionsClassName:hn,renderActionsPopover:g,title:Na},i.a.createElement(V.EuiFlexGroup,{"data-test-subj":"rule-panel"},i.a.createElement(V.EuiFlexItem,{grow:2},i.a.createElement(V.EuiFlexGroup,null,i.a.createElement(xn,{title:La,grow:2},i.a.createElement(bn.a,{contextId:ua.d.active,eventId:t,value:null==b||null===(s=b.values)||void 0===s?void 0:s[0],fieldName:null!==(o=null==b?void 0:b.data.field)&&void 0!==o?o:"",linkValue:null==b?void 0:b.linkValue,fieldType:null==b?void 0:b.data.type,fieldFormat:null==b?void 0:b.data.format,isDraggable:!1,truncate:!1})),i.a.createElement(xn,{title:Ba},u),i.a.createElement(xn,{"data-test-subj":"rule-panel-severity",title:qa},i.a.createElement(mn.a,{value:d}))),i.a.createElement(V.EuiSpacer,{size:"l"}),i.a.createElement(V.EuiFlexGroup,null,i.a.createElement(xn,{title:za,grow:2},p)),i.a.createElement(V.EuiSpacer,{size:"l"}),i.a.createElement(Sn,{"data-test-subj":"rule-panel-threat-tactic",wrap:!1},m&&i.a.createElement(xn,{title:c[0].title,grow:2},c[0].description)),i.a.createElement(V.EuiSpacer,null))))}));kn.displayName="RulePanel";var Sn=H()(V.EuiFlexGroup).withConfig({displayName:"_StyledEuiFlexGroup",componentId:"sc-oqbcwh-0"})(["",""],vn),jn=a(8),On=a(214);const wn="cases-panel-actions-trigger",Tn=i.a.memo((({addToNewCase:e,addToExistingCase:t,className:a,userCasesPermissions:r})=>{const[s,o]=Object(n.useState)(!1),l=Object(n.useCallback)((()=>{o(!s)}),[s]),c=Object(n.useMemo)((()=>{const a=[];return r.create&&a.push(i.a.createElement(V.EuiContextMenuItem,{key:"casesActionsAddToNewCase",onClick:e,"data-test-subj":"cases-panel-actions-add-to-new-case"},Wa)),r.update&&a.push(i.a.createElement(V.EuiContextMenuItem,{key:"caseActionsAddToExistingCase","data-test-subj":"cases-panel-actions-add-to-existing-case",onClick:t,target:"_blank"},Qa)),a}),[t,e,r.create,r.update]),u=Object(n.useMemo)((()=>i.a.createElement(V.EuiButtonIcon,{"aria-label":un,className:wn,iconType:"boxesHorizontal",onClick:l})),[l]);return i.a.createElement("div",{className:a},i.a.createElement(V.EuiPopover,{button:u,isOpen:s,closePopover:()=>{o(!1)},panelPaddingSize:"none",anchorPosition:"downLeft",panelClassName:"withHoverActions__popover"},i.a.createElement(V.EuiContextMenuPanel,{"data-test-subj":"cases-actions-panel",size:"s",items:c})))}));Tn.displayName="CasesPanelActions";var In,Cn=a(6),Mn=a.n(Cn),Fn=z.i18n.translate("cases.components.status.open",{defaultMessage:"Open"}),Dn=z.i18n.translate("cases.components.status.inProgress",{defaultMessage:"In progress"}),An=z.i18n.translate("cases.components.status.closed",{defaultMessage:"Closed"});!function(e){e.open="open",e["in-progress"]="in-progress",e.closed="closed"}(In||(In={}));var _n,Nn=(_n={},Mn()(_n,In.open,{color:"primary",label:Fn,icon:"folderOpen"}),Mn()(_n,In["in-progress"],{color:"warning",label:Dn,icon:"folderExclamation"}),Mn()(_n,In.closed,{color:"default",label:An,icon:"folderCheck"}),_n),Rn=function(e){var t,a,n=e.status,i=e.dataTestSubj;return Object(wa.jsx)(V.EuiBadge,{"data-test-subj":i||"case-status-badge-".concat(n),color:null===(t=Nn[n])||void 0===t?void 0:t.color},null===(a=Nn[n])||void 0===a?void 0:a.label)};Rn.displayName="Status";var Pn=Object(n.memo)(Rn);const Ln=H()(V.EuiText).withConfig({displayName:"DescriptionText",componentId:"sc-1wy37b5-0"})(["text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;word-break:normal;"]),Bn=H()(V.EuiFlexGroup).withConfig({displayName:"ChildFlexGroup",componentId:"sc-1wy37b5-1"})(["margin:0;"]),qn=H.a.span.withConfig({displayName:"StyledStatusText",componentId:"sc-1wy37b5-2"})(["margin-right:",";"],(({theme:e})=>e.eui.euiSizeS)),zn=H()(V.EuiIcon).withConfig({displayName:"StyledIcon",componentId:"sc-1wy37b5-3"})(["margin-right:",";"],(({theme:e})=>e.eui.euiSizeS)),$n=({relatedCases:e,maximumVisible:t})=>{const a=Object(n.useMemo)((()=>e?e.sort(((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime())):[]),[e]),r=Object(n.useMemo)((()=>t&&t>0?a.slice(0,t):a),[t,a]);return i.a.createElement(i.a.Fragment,null,null==r?void 0:r.map((({id:e,title:t,description:a,status:n,totals:r})=>i.a.createElement(V.EuiFlexItem,{key:e},i.a.createElement(be.a,{detailName:e,title:t},t),i.a.createElement(V.EuiSpacer,{size:"s"}),i.a.createElement(Ln,{color:"subdued",size:"relative"},a),i.a.createElement(V.EuiSpacer,{size:"s"}),i.a.createElement(Bn,{justifyContent:"spaceBetween"},i.a.createElement(V.EuiFlexItem,null,i.a.createElement(V.EuiFlexGroup,{dir:"row",alignItems:"center"},i.a.createElement(qn,null,`${Aa}:`),i.a.createElement(Pn,{status:n}))),i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiFlexGroup,{dir:"row",alignItems:"center",gutterSize:"xl"},i.a.createElement(V.EuiFlexItem,null,i.a.createElement(V.EuiFlexGroup,{dir:"row"},i.a.createElement(zn,{type:"editorComment"}),i.a.createElement("span",null,r.userComments))),i.a.createElement(V.EuiFlexItem,null,i.a.createElement(V.EuiFlexGroup,{dir:"row"},i.a.createElement(zn,{type:"alert"}),i.a.createElement("span",null,r.alerts))))))))))},Vn=H()(V.EuiFlexGroup).withConfig({displayName:"StyledCasesFlexGroup",componentId:"sc-1r8ewm4-0"})(["max-height:300px;overflow-y:auto;"]),Un=()=>i.a.createElement(V.EuiEmptyPrompt,{icon:i.a.createElement(V.EuiLoadingSpinner,{size:"l"}),title:i.a.createElement("h2",null,Ua),titleSize:"xxs"}),Hn=()=>i.a.createElement(i.a.Fragment,null,Ha),Gn=()=>i.a.createElement(V.EuiEmptyPrompt,{body:Ga}),Qn=i.a.memo((({eventId:e,dataAsNestedObject:t,detailsData:a})=>{const{cases:r}=Object(p.k)().services,{loading:o,error:l,relatedCases:c,refetchRelatedCases:u}=(e=>{const{services:{cases:t}}=Object(p.k)(),a=Object(p.o)(),[i,r]=Object(n.useState)(void 0),[o,l]=Object(n.useState)(!1),[c,u]=Object(n.useState)(null),d=Object(n.useCallback)((async()=>{l(!0);let n=[];try{var i;e&&(n=null!==(i=await t.api.getRelatedCases(e,{owner:s.p}))&&void 0!==i?i:[])}catch(e){u(e),a.addWarning(Object(On.c)(e))}finally{r(n),l(!1)}}),[e,t.api,a]);return Object(n.useEffect)((()=>{d()}),[e,d]),{loading:o,error:c,relatedCases:i,refetchRelatedCases:d}})(e),d=Object(p.i)(),m=Object(n.useMemo)((()=>{var n;return t?[{alertId:e,index:null!==(n=t._index)&&void 0!==n?n:"",type:jn.CommentType.alert,rule:r.helpers.getRuleIdFromEvent({ecs:t,data:a})}]:[]}),[r.helpers,t,a,e]),g=r.hooks.getUseCasesAddToNewCaseFlyout({onSuccess:u}),b=r.hooks.getUseCasesAddToExistingCaseModal({onRowClick:u}),f=Object(n.useCallback)((()=>{d.create&&g.open({attachments:m})}),[d.create,g,m]),y=Object(n.useCallback)((()=>{d.update&&b.open({attachments:m})}),[m,b,d.update]),h=Object(n.useCallback)((()=>i.a.createElement(Tn,{addToNewCase:f,addToExistingCase:y,eventId:e,dataAsNestedObject:t,detailsData:a,userCasesPermissions:d})),[y,f,t,a,e,d]),E=c?c.length:0,v=Object(n.useMemo)((()=>Math.min(E,25)),[E]),x=E>0;return o?i.a.createElement(Un,null):l||void 0===c?i.a.createElement(Hn,null):i.a.createElement(Ma,{actionsClassName:wn,title:Da,description:x?(k=v,z.i18n.translate("xpack.securitySolution.alerts.alertDetails.summary.cases.subTitle",{values:{caseCount:k},defaultMessage:"Showing the {caseCount} most recently created cases containing this alert"})):void 0,renderActionsPopover:x?h:void 0},x?i.a.createElement(Vn,{direction:"column","data-test-subj":"case-panel"},i.a.createElement($n,{maximumVisible:25,relatedCases:c})):i.a.createElement(V.EuiEmptyPrompt,{iconColor:"default",body:Va,actions:i.a.createElement(V.EuiFlexGroup,null,d.update&&i.a.createElement(V.EuiFlexItem,null,i.a.createElement(V.EuiButton,{size:"s","data-test-subj":"add-to-existing-case-button",color:"primary",onClick:y},Qa)),d.create&&i.a.createElement(V.EuiFlexItem,null,i.a.createElement(V.EuiButton,{size:"s","data-test-subj":"add-to-new-case-button",color:"primary",fill:!0,onClick:f},Wa)))}));var k}));Qn.displayName="CasesPanel";var Wn=a(289),Kn=a(873),Yn=a(291),Jn=a(85),Xn=a(87),Zn=a(213),ei=a(396),ti=a(221);const ai="host-panel-actions-trigger",ni=i.a.memo((({className:e,openHostDetailsPanel:t,hostName:a})=>{const[r,s]=Object(n.useState)(!1),{href:o}=Object(be.o)()({deepLinkId:k.a.hosts,path:Object(d.f)(a)}),l=Object(n.useCallback)((()=>{s(!r)}),[r]),c=()=>{s(!1)},u=Object(n.useCallback)((()=>{t(a),c()}),[a,t]),p=Object(n.useMemo)((()=>[i.a.createElement(V.EuiContextMenuItem,{icon:"expand",key:"hostActionsViewHostSummary",onClick:u,"data-test-subj":"host-panel-actions-view-summary"},en),i.a.createElement(V.EuiContextMenuItem,{icon:"popout",key:"hostActionsOpenHostDetailsPage","data-test-subj":"host-panel-actions-open-host-details",onClick:c,href:o,target:"_blank"},tn)]),[u,o]),m=Object(n.useMemo)((()=>i.a.createElement(V.EuiButtonIcon,{"aria-label":un,className:ai,iconType:"boxesHorizontal",onClick:l})),[l]);return i.a.createElement("div",{className:e},i.a.createElement(V.EuiPopover,{button:m,isOpen:r,closePopover:c,panelPaddingSize:"none",anchorPosition:"downLeft",panelClassName:"withHoverActions__popover"},i.a.createElement(V.EuiContextMenuPanel,{"data-test-subj":"host-actions-panel",size:"s",items:p})))}));ni.displayName="HostPanelActions";const ii=({grow:e,title:t,children:a})=>a?i.a.createElement(V.EuiFlexItem,{grow:e},t&&i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiTitle,{size:"xxs"},i.a.createElement("h5",null,t)),i.a.createElement(V.EuiSpacer,{size:"xs"})),a):null,ri=i.a.memo((({data:e,id:t,browserFields:a,openHostDetailsPanel:r,selectedPatterns:s})=>{const o=yn("host.name",e),l=yn("host.os.name",e),c=Object(n.useMemo)((()=>{const n=Object(v.find)({field:"agent.id",category:"agent"},e);return e&&Object(Wn.b)({data:e})?n&&Object(gn.b)({eventId:t,contextId:ua.d.detectionsAlertDetailsPage,scopeId:ua.d.detectionsAlertDetailsPage,browserFields:a,item:n,field:{id:"agent.id",overrideField:"agent.status"},linkValueField:void 0}):null}),[a,e,t]),{data:u,isLicenseValid:d}=Object(Yn.c)({riskEntity:Jn.v.host,skip:null==o}),[p,m]=Object(n.useMemo)((()=>{const e=u&&u.length>0?u[0]:void 0;return[e?Math.round(e.host.risk.calculated_score_norm):Object(Xn.d)(),e?i.a.createElement(Zn.b,{severity:e.host.risk.calculated_level,hideBackgroundColor:!0}):Object(Xn.d)()]}),[u]),g=Object(n.useMemo)((()=>{var t,a;return null!==(t=null===(a=Object(v.find)({field:"host.ip",category:"host"},e))||void 0===a?void 0:a.values)&&void 0!==t?t:[]}),[e]),b=Object(n.useCallback)((e=>null!=e?i.a.createElement(be.h,{ip:e}):Object(Xn.d)()),[]),f=Object(n.useCallback)((()=>i.a.createElement(ni,{openHostDetailsPanel:r,hostName:o})),[o,r]);return i.a.createElement(Ma,{actionsClassName:ai,grow:!0,renderActionsPopover:o?f:void 0,title:Ra},i.a.createElement(V.EuiFlexGroup,{"data-test-subj":"host-panel"},i.a.createElement(V.EuiFlexItem,{grow:2},i.a.createElement(V.EuiFlexGroup,null,i.a.createElement(ii,{grow:!1},i.a.createElement(V.EuiIcon,{type:"storage",size:"xl"})),i.a.createElement(ii,{title:Ka},i.a.createElement(be.d,{hostName:o}))),i.a.createElement(V.EuiSpacer,{size:"l"}),i.a.createElement(V.EuiFlexGroup,{"data-test-subj":"host-panel-agent-status"},i.a.createElement(ii,{title:Ya},l),c&&i.a.createElement(ii,{title:Ja},i.a.createElement(Kn.a,c))),i.a.createElement(V.EuiSpacer,{size:"l"}),d&&i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiFlexGroup,{"data-test-subj":"host-panel-risk"},p&&i.a.createElement(ii,{title:an},p),m&&i.a.createElement(ii,{title:nn},m)),i.a.createElement(V.EuiSpacer,{size:"l"})),i.a.createElement(V.EuiFlexGroup,{"data-test-subj":"host-panel-ip"},i.a.createElement(ii,{title:Xa,grow:2},i.a.createElement(ti.a,{rowItems:g,attrName:"host.ip",idPrefix:"alert-details-page-user",render:b}))),i.a.createElement(V.EuiSpacer,{size:"l"}),i.a.createElement(V.EuiFlexGroup,null,i.a.createElement(ii,{title:Za,grow:2},i.a.createElement(ei.a,{indexPatterns:s,field:"host.name",value:o,type:ei.b.LAST_SEEN}))),i.a.createElement(V.EuiSpacer,null))))}));ri.displayName="HostPanel";var si=a(600);const oi="user-panel-actions-trigger",li=i.a.memo((({className:e,openUserDetailsPanel:t,userName:a})=>{const[r,s]=Object(n.useState)(!1),{href:o}=Object(be.o)()({deepLinkId:k.a.users,path:Object(si.c)(a)}),l=Object(n.useCallback)((()=>{s(!r)}),[r]),c=()=>{s(!1)},u=Object(n.useCallback)((()=>{t(a),c()}),[a,t]),d=Object(n.useMemo)((()=>[i.a.createElement(V.EuiContextMenuItem,{icon:"expand",key:"userActionsViewUserSummary",onClick:u,"data-test-subj":"user-panel-actions-view-summary"},ln),i.a.createElement(V.EuiContextMenuItem,{icon:"popout",key:"userActionsOpenUserDetailsPage","data-test-subj":"user-panel-actions-open-user-details",onClick:c,href:o,target:"_blank"},cn)]),[u,o]),p=Object(n.useMemo)((()=>i.a.createElement(V.EuiButtonIcon,{"aria-label":un,className:oi,iconType:"boxesHorizontal",onClick:l})),[l]);return i.a.createElement("div",{className:e},i.a.createElement(V.EuiPopover,{button:p,isOpen:r,closePopover:c,panelPaddingSize:"none",anchorPosition:"downLeft",panelClassName:"withHoverActions__popover"},i.a.createElement(V.EuiContextMenuPanel,{"data-test-subj":"user-actions-panel",size:"s",items:d})))}));li.displayName="UserPanelActions";const ci=({grow:e,title:t,children:a})=>a?i.a.createElement(V.EuiFlexItem,{grow:e},t&&i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiTitle,{size:"xxs"},i.a.createElement("h5",null,t)),i.a.createElement(V.EuiSpacer,{size:"xs"})),a):null,ui=i.a.memo((({data:e,selectedPatterns:t,openUserDetailsPanel:a})=>{const r=Object(n.useMemo)((()=>yn("user.name",e)),[e]),{data:s,isLicenseValid:o}=Object(Yn.c)({riskEntity:Jn.v.user,skip:null==r}),l=Object(n.useCallback)((()=>i.a.createElement(li,{openUserDetailsPanel:a,userName:r})),[a,r]),[c,u]=Object(n.useMemo)((()=>{const e=s&&s.length>0?s[0]:void 0;return[e?Math.round(e.user.risk.calculated_score_norm):Object(Xn.d)(),e?i.a.createElement(Zn.b,{severity:e.user.risk.calculated_level,hideBackgroundColor:!0}):Object(Xn.d)()]}),[s]),d=Object(n.useMemo)((()=>{var t,a;return null!==(t=null===(a=Object(v.find)({field:"source.ip",category:"source"},e))||void 0===a?void 0:a.values)&&void 0!==t?t:[]}),[e]),p=Object(n.useCallback)((e=>null!=e?i.a.createElement(be.h,{ip:e}):Object(Xn.d)()),[]);return i.a.createElement(Ma,{actionsClassName:oi,grow:!0,renderActionsPopover:r?l:void 0,title:Pa},i.a.createElement(V.EuiFlexGroup,{"data-test-subj":"user-panel"},i.a.createElement(V.EuiFlexItem,{grow:2},i.a.createElement(V.EuiFlexGroup,null,i.a.createElement(ci,{grow:!1},i.a.createElement(V.EuiIcon,{type:"userAvatar",size:"xl"})),i.a.createElement(ci,{title:rn},r?i.a.createElement(be.m,{userName:r}):Object(Xn.d)())),i.a.createElement(V.EuiSpacer,{size:"l"}),o&&i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiFlexGroup,{"data-test-subj":"user-panel-risk"},c&&i.a.createElement(ci,{title:sn},c),u&&i.a.createElement(ci,{title:on},u)),i.a.createElement(V.EuiSpacer,{size:"l"})),i.a.createElement(V.EuiFlexGroup,{"data-test-subj":"user-panel-ip"},i.a.createElement(ci,{title:Xa,grow:2},i.a.createElement(ti.a,{rowItems:d,attrName:"source.ip",idPrefix:"alert-details-page-user",render:p}))),i.a.createElement(V.EuiSpacer,{size:"l"}),i.a.createElement(V.EuiFlexGroup,null,i.a.createElement(ci,{title:Za,grow:2},i.a.createElement(ei.a,{indexPatterns:t,field:"user.name",value:r,type:ei.b.LAST_SEEN}))),i.a.createElement(V.EuiSpacer,null))))}));ui.displayName="UserPanel";const di=i.a.memo((({dataAsNestedObject:e,detailsData:t,searchHit:a,eventId:n,sourcererDataView:r})=>{const s=Object(p.i)(),{DetailsPanel:o,openHostDetailsPanel:l,openUserDetailsPanel:c}=Object(Sa.a)({isFlyoutView:!0,sourcererScope:b.SourcererScopeName.detections,scopeId:ua.d.detectionsAlertDetailsPage});return i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiFlexGroup,{"data-test-subj":"alert-details-page-summary-tab",direction:"row",wrap:!0},i.a.createElement(Ia,{grow:2},i.a.createElement(pn,{dataAsNestedObject:e}),i.a.createElement(kn,{id:n,data:t,searchHit:a,browserFields:r.browserFields}),i.a.createElement(Ca,null,i.a.createElement(ri,{id:n,data:t,openHostDetailsPanel:l,selectedPatterns:r.selectedPatterns,browserFields:r.browserFields}),i.a.createElement(ui,{data:t,selectedPatterns:r.selectedPatterns,openUserDetailsPanel:c}))),i.a.createElement(Ia,{grow:1},s.read?i.a.createElement(Qn,{eventId:n,dataAsNestedObject:e,detailsData:t}):i.a.createElement(Gn,null))),o)}));di.displayName="DetailsSummaryTab";const pi=Object(n.memo)((()=>{const{detailName:e}=Object(P.useParams)(),t=Object(o.useDispatch)(),a=Object(g.d)(b.SourcererScopeName.detections),r=Object(n.useMemo)((()=>a.selectedPatterns.join(",")),[a.selectedPatterns]),[l,c,u,p]=Object(ha.a)({indexName:r,eventId:e,runtimeMappings:a.runtimeMappings,skip:!ya.e}),f=!l&&!c,y=!l&&c,h=pa(null==u?void 0:u.fields),v=h(ca.ib),x=h(ca.x);return Object(n.useEffect)((()=>{t(m.a.createTimeline({id:ua.d.detectionsAlertDetailsPage,columns:[],dataViewId:null,indexNames:[],expandedDetail:{},show:!1}))}),[t]),i.a.createElement(i.a.Fragment,null,l&&i.a.createElement(Ea,{eventId:e}),f&&i.a.createElement(va,{eventId:e}),y&&i.a.createElement(i.a.Fragment,null,i.a.createElement(ka,{loading:l,ruleName:x,timestamp:v}),i.a.createElement(ga.a,{navTabs:(k=e,{[ma.a.summary]:{id:ma.a.summary,name:ba.e,href:fa(k,ma.a.summary),disabled:!1}})}),i.a.createElement(V.EuiSpacer,{size:"l"}),i.a.createElement(P.Switch,null,i.a.createElement(L.Route,{exact:!0,path:Object(d.a)(e,ma.a.summary)},i.a.createElement(di,{eventId:e,dataAsNestedObject:p,searchHit:u,detailsData:c,sourcererDataView:a})))),i.a.createElement(E.a,{pageName:s.uc.alerts,state:{ruleName:x}}));var k})),mi=()=>i.a.createElement(r.TrackApplicationView,{viewId:s.uc.alerts},i.a.createElement(ra,null),i.a.createElement(E.a,{pageName:s.uc.alerts})),gi=()=>i.a.createElement(r.TrackApplicationView,{viewId:s.uc.alerts},i.a.createElement(pi,null)),bi=()=>{la($);const e=Object(B.a)("alertDetailsPageEnabled");return i.a.createElement(P.Switch,null,i.a.createElement(L.Route,{path:s.d,exact:!0,component:mi}),e&&i.a.createElement(i.a.Fragment,null,i.a.createElement(L.Route,{path:`${s.d}/:detailName`,render:({match:{params:{detailName:e}},location:{search:t=""}})=>i.a.createElement(P.Redirect,{to:{pathname:fa(e,ma.a.summary),search:t}})}),i.a.createElement(L.Route,{path:`${s.d}/:detailName/:tabName`,component:gi})),i.a.createElement(L.Route,{component:q.a}))},fi=i.a.memo(bi),yi=[{path:s.ib,render:({location:e})=>e.pathname===s.ib?i.a.createElement(P.Redirect,{to:{...e,pathname:s.d}}):i.a.createElement(P.Redirect,{to:{...e,pathname:e.pathname.replace(s.ib,"")}})},{path:s.d,component:()=>i.a.createElement(_,null,i.a.createElement(fi,null))}],hi=[u.g.alertsOnRuleDetailsPage,u.g.alertsOnAlertsPage];var Ei=a(168),vi=a(93),xi=a(172);const ki=H.a.a.withConfig({displayName:"InvisibleAnchor",componentId:"sc-bxvucm-0"})(["display:none;"]),Si=({blob:e,name:t,onDownload:a})=>{const r=Object(n.useRef)(null);return Object(n.useEffect)((()=>{if(e&&null!=r&&r.current){if("function"==typeof window.navigator.msSaveOrOpenBlob)window.navigator.msSaveBlob(e);else{const a=window.URL.createObjectURL(e);r.current.href=a,r.current.download=null!=t?t:"download.txt",r.current.click(),window.URL.revokeObjectURL(a)}a&&a()}}),[e,t,a]),i.a.createElement(ki,{ref:r})};var ji=a(187),Oi=a(84),wi=a(564),Ti=a(834),Ii=a(573),Ci=a(284);const Mi=H.a.div.withConfig({displayName:"MarkdownContainer",componentId:"sc-1038msv-0"})(["max-height:200px;overflow-y:auto;&::-webkit-scrollbar{height:",";width:",";}&::-webkit-scrollbar-thumb{background-clip:content-box;background-color:",";border:"," solid transparent;}&::-webkit-scrollbar-corner,&::-webkit-scrollbar-track{background-color:transparent;}"],(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>Object(Ci.rgba)(e.eui.euiColorDarkShade,.5)),(({theme:e})=>e.eui.euiScrollBarCorner)),Fi=({cancelText:e,confirmText:t,contentText:a,onClose:n,onCancel:r,onConfirm:s,references:o=[],showModal:l,titleText:c})=>l?i.a.createElement(V.EuiConfirmModal,{maxWidth:460,title:c,onCancel:r,onConfirm:s,cancelButtonText:e,confirmButtonText:t,buttonColor:"danger",defaultFocusedButton:"confirm","data-test-subj":"referenceErrorModal"},i.a.createElement("p",null,a),i.a.createElement(Mi,null,i.a.createElement(V.EuiListGroup,{gutterSize:"none",showToolTips:!0},o.map(((e,t)=>i.a.createElement(V.EuiListGroupItem,{key:`${t}-${e}`,label:e})))))):null;Fi.displayName="ReferenceErrorModalComponent";const Di=i.a.memo(Fi);Di.displayName="ReferenceErrorModal";var Ai=a(138),_i=a(571),Ni=a(139),Ri=a(345);const Pi={contentText:"",rulesReferences:[],isLoading:!1,listId:"",listNamespaceType:"single"},Li=[{field:"created_at",label:wi.I,defaultOrder:"desc"}],Bi=i.a.memo((()=>{const[{loading:e,canUserCRUD:t,canUserREAD:a}]=Object(le.b)(),{loading:r}=Object(me.a)(),s=e||r,{services:{http:o,notifications:l,timelines:c,application:{navigateToApp:u}}}=Object(p.k)(),{exportExceptionList:d,deleteExceptionList:m}=Object(xi.c)(o),[g,b]=Object(n.useState)(!1),[f,y]=Object(n.useState)(Pi),[h,E]=Object(n.useState)(),[v,x,k,S,j,O,w]=Object(xi.g)({errorMessage:wi.m,filterOptions:{...h,types:[vi.b.DETECTION,vi.b.ENDPOINT]},http:o,namespaceTypes:["single","agnostic"],notifications:l,hideLists:Ni.a}),[T,I,C]=Object(Ii.a)({exceptionLists:null!=x?x:[]}),[M,F]=Object(n.useState)(!0),[D,A]=Object(n.useState)(Date.now()),[_,N]=Object(n.useState)({}),[R,P]=Object(n.useState)(!1),{addError:L,addSuccess:B}=Object(Oi.a)(),q=Object(n.useCallback)((e=>()=>{l.toasts.addSuccess({title:wi.O(null!=e?e:f.listId)})}),[l.toasts,f.listId]),z=Object(n.useCallback)((e=>{L(e,{title:wi.p})}),[L]),$=Object(n.useCallback)((({id:e,listId:t,namespaceType:a})=>async()=>{try{null!=C[e]&&(y({contentText:C[e].rules.length>0?wi.Q(C[e].rules.length):wi.N(C[e].name),rulesReferences:C[e].rules.map((({name:e})=>e)),isLoading:!0,listId:e,listNamespaceType:a}),b(!0))}catch(e){z(e)}}),[C,z]),U=Object(n.useCallback)((e=>t=>{B(wi.r),N({name:e,blob:t})}),[B]),H=Object(n.useCallback)((e=>{L(e,{title:wi.q})}),[L]),G=Object(n.useCallback)((({id:e,listId:t,namespaceType:a})=>async()=>{await d({id:e,listId:t,namespaceType:a,onError:H,onSuccess:U(t)})}),[d,H,U]),Q=Object(n.useCallback)((()=>{null!=j&&(A(Date.now()),j())}),[j]);Object(n.useEffect)((()=>{!M||s||v||T||F(!1)}),[M,s,v,T]);const W=Object(n.useCallback)((async({query:e,queryText:t})=>{const a=Object(_i.d)({defaultSearchTerm:"name",filterOptions:{name:null,list_id:null,created_by:null,type:null,tags:null},query:e,searchValue:t});E(a)}),[]),K=Object(n.useCallback)((()=>{b(!1),y({contentText:"",rulesReferences:[],isLoading:!1,listId:"",listNamespaceType:"single"})}),[]),Y=Object(n.useCallback)((async()=>{const e=f.listId,t=f.listNamespaceType,a=C[e].rules;try{await Promise.all(a.map((t=>{var a;const n=new AbortController,i=(null!==(a=t.exceptions_list)&&void 0!==a?a:[]).filter((({id:t})=>t!==e));return Object(Ai.k)({ruleProperties:{rule_id:t.rule_id,exceptions_list:i},signal:n.signal})}))),await m({id:e,namespaceType:t,onError:z,onSuccess:q()})}catch(e){z(e)}finally{y(Pi),b(!1),null!=j&&j()}}),[f.listId,f.listNamespaceType,C,m,z,q,j]),J=Object(n.useCallback)((()=>{N({})}),[]),[X,Z]=Object(n.useState)(0),[ee,te]=Object(n.useState)(5),[ae,ne]=Object(n.useState)(!1),ie=()=>ne(!1),re=i.a.createElement(V.EuiButtonEmpty,{size:"xs",color:"text",iconType:"arrowDown",iconSide:"right",onClick:()=>ne((e=>!e))},`Rows per page: ${ee}`),se=e=>e===ee?"check":"empty",oe=[i.a.createElement(V.EuiContextMenuItem,{key:"5 rows",icon:se(5),onClick:()=>{ie(),te(5)}},"5 rows"),i.a.createElement(V.EuiContextMenuItem,{key:"10 rows",icon:se(10),onClick:()=>{ie(),te(10)}},"10 rows"),i.a.createElement(V.EuiContextMenuItem,{key:"25 rows",icon:se(25),onClick:()=>{ie(),te(25)}},"25 rows")];Object(n.useEffect)((()=>{S({page:X+1,perPage:ee,total:0})}),[X,ee,S]);const[ce,ue]=Object(n.useState)(!1),[de,pe]=Object(n.useState)(!1),[ge,be]=Object(n.useState)(!1),fe=()=>{pe(!1),ue(!1)};return i.a.createElement(i.a.Fragment,null,i.a.createElement(Zt.a,null),i.a.createElement(V.EuiFlexGroup,null,i.a.createElement(V.EuiFlexItem,null,i.a.createElement(V.EuiPageHeader,{pageTitle:wi.a,description:i.a.createElement(i.a.Fragment,null,i.a.createElement("div",null,"To view rule specific exceptions navigate to that rule's details page.",i.a.createElement(V.EuiButtonIcon,{iconType:"popout","aria-label":"go-to-rules",color:"primary",onClick:()=>u("security",{openInNewTab:!0,path:"/rules"})})),i.a.createElement("div",null,c.getLastUpdated({showUpdating:s,updatedAt:D})))})),i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiButton,{iconType:"importAction",onClick:()=>P(!0)},wi.v)),i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiPopover,{"data-test-subj":"manageExceptionListCreateButton",button:i.a.createElement(V.EuiButton,{iconType:"arrowDown",onClick:()=>ue((e=>!e))},wi.d),isOpen:ce,closePopover:fe},i.a.createElement(V.EuiContextMenuPanel,{items:[i.a.createElement(V.EuiContextMenuItem,{key:"createList",onClick:()=>{fe(),be(!0)}},wi.f),i.a.createElement(V.EuiContextMenuItem,{key:"createItem",onClick:()=>{fe(),pe(!0)}},wi.e)]})))),ge&&i.a.createElement(Ti.a,{handleRefresh:Q,http:o,addSuccess:B,addError:L,handleCloseFlyout:()=>be(!1)}),de&&i.a.createElement(Ri.a,{rules:null,isEndpointItem:!1,isBulkAction:!1,showAlertCloseOptions:!0,onCancel:e=>pe(!1),onConfirm:e=>{pe(!1),e&&Q()},isNonTimeline:!0}),R&&i.a.createElement(Ti.d,{handleRefresh:Q,http:o,addSuccess:B,addError:L,setDisplayImportListFlyout:P}),i.a.createElement(V.EuiHorizontalRule,null),i.a.createElement("div",{"data-test-subj":"allExceptionListsPanel"},T&&i.a.createElement(V.EuiProgress,{"data-test-subj":"loadingRulesInfoProgress",size:"xs",position:"absolute",color:"accent"}),!M&&i.a.createElement(Ti.h,{onSearch:W}),i.a.createElement(V.EuiSpacer,{size:"m"}),T&&!M&&!g&&i.a.createElement(ji.a,{"data-test-subj":"loadingPanelAllRulesTable",overlay:!0,size:"xl"}),M||T?i.a.createElement(V.EuiLoadingContent,{"data-test-subj":"initialLoadingPanelAllRulesTable",lines:10}):i.a.createElement(i.a.Fragment,null,i.a.createElement(Ti.c,{totalExceptionLists:I.length,onRefresh:Q,setSort:w,sort:O,sortFields:Li}),I.length>0&&null!==t&&null!==a&&i.a.createElement("div",{"data-test-subj":"exceptionsTable"},I.map((e=>i.a.createElement(Ti.b,{key:e.list_id,"data-test-subj":"exceptionsListCard",readOnly:a&&!t,exceptionsList:e,handleDelete:$,handleExport:G}))))),i.a.createElement(V.EuiFlexGroup,null,i.a.createElement(V.EuiFlexItem,{style:{flex:"1 1 auto"}},i.a.createElement(V.EuiFlexGroup,{alignItems:"flexStart"},i.a.createElement(V.EuiFlexItem,null,i.a.createElement(V.EuiPopover,{button:re,isOpen:ae,closePopover:ie},i.a.createElement(V.EuiContextMenuPanel,{items:oe}))))),i.a.createElement(V.EuiFlexItem,{style:{alignItems:"flex-end"}},i.a.createElement(V.EuiFlexGroup,{alignItems:"flexEnd"},i.a.createElement(V.EuiFlexItem,null,i.a.createElement(V.EuiPagination,{"aria-label":"Custom pagination example",pageCount:k.total?Math.ceil(k.total/ee):0,activePage:X,onPageClick:e=>Z(e)}))))),i.a.createElement(Si,{blob:_.blob,name:`${_.name}.ndjson`,onDownload:J}),i.a.createElement(Di,{cancelText:wi.B,confirmText:wi.C,contentText:f.contentText,onCancel:K,onClose:K,onConfirm:Y,references:f.rulesReferences,showModal:g,titleText:wi.D})))}));Bi.displayName="SharedLists";var qi=a(195),zi=a(593);const $i=()=>{const{detailName:e}=Object(P.useParams)(),{isLoading:t,invalidListId:a,isReadOnly:r,list:o,canUserEditList:l,listId:c,linkedRules:u,exportedList:d,viewerStatus:p,listName:m,listDescription:g,showManageRulesFlyout:b,headerBackOptions:f,showReferenceErrorModal:y,referenceModalState:h,showManageButtonLoader:v,refreshExceptions:x,disableManageButton:k,onEditListDetails:S,onExportList:j,onManageRules:O,onSaveManageRules:w,onCancelManageRules:T,onRuleSelectionChange:I,handleDelete:C,handleCloseReferenceErrorModal:M,handleReferenceDelete:F}=Object(zi.a)(e),D=Object(n.useMemo)((()=>p===qi.i.ERROR?i.a.createElement(qi.a,{isReadOnly:r,viewerStatus:p}):t?i.a.createElement(V.EuiLoadingContent,{lines:4,"data-test-subj":"loading"}):!a&&m&&o?i.a.createElement(i.a.Fragment,null,i.a.createElement(Zt.a,null),i.a.createElement(qi.d,{name:m,description:g,listId:c,linkedRules:u,isReadonly:r,canUserEditList:l,backOptions:f,securityLinkAnchorComponent:Ti.e,onEditListDetails:S,onExportList:j,onDeleteList:C,onManageRules:O}),i.a.createElement(Si,{blob:d,name:c}),i.a.createElement(Ti.g,{list:o,refreshExceptions:x,isReadOnly:r}),i.a.createElement(Di,{cancelText:Ei.O,confirmText:Ei.P,contentText:h.contentText,onCancel:M,onClose:M,onConfirm:F,references:h.rulesReferences,showModal:y,titleText:Ei.Q}),b?i.a.createElement(Ti.i,{linkedRules:u,showButtonLoader:v,saveIsDisabled:k,onSave:w,onCancel:T,onRuleSelectionChange:I}):null):i.a.createElement(q.a,null)),[l,k,d,f,a,t,r,u,o,g,c,m,h.contentText,h.rulesReferences,x,v,b,y,p,T,S,j,O,I,w,M,C,F]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(E.a,{pageName:s.uc.exceptions,state:{listName:m}}),D)};$i.displayName="ListsDetailViewComponent";const Vi=i.a.memo($i);Vi.displayName="ListsDetailView";const Ui=()=>i.a.createElement(_,null,i.a.createElement(r.TrackApplicationView,{viewId:s.uc.exceptions},i.a.createElement(Bi,null),i.a.createElement(E.a,{pageName:s.uc.exceptions}))),Hi=()=>i.a.createElement(_,null,i.a.createElement(r.TrackApplicationView,{viewId:s.uc.exceptions},i.a.createElement(Vi,null))),Gi=()=>(la(Ei.N),i.a.createElement(P.Switch,null,i.a.createElement(L.Route,{path:s.Bb,exact:!0,component:Ui}),i.a.createElement(L.Route,{path:s.Cb,component:Hi}),i.a.createElement(L.Route,{component:q.a}))),Qi=i.a.memo(Gi),Wi=[{path:s.Bb,render:()=>i.a.createElement(Qi,null)}];var Ki=a(42),Yi=a(707),Ji=a(230),Xi=a(543),Zi=a(538),er=a(892),tr=a(171),ar=a(120),nr=a(319),ir=a(910),rr=a(98),sr=a(406),or=a(82),lr=a.n(or);const cr="Current Risk Score for Hosts",ur="Current Risk Score for Users";var dr=a(35),pr=a(358);const mr=(e,t="default")=>`ml_${e}riskscore_pivot_transform_${t}`,gr=(e,t="default")=>`ml_${e}riskscore_latest_transform_${t}`,br=(e,t="default")=>`ml_${e}riskscore_ingest_pipeline_${t}`,fr=(e,t="default")=>`ml_${e}riskscore_levels_script_${t}`,yr=(e,t="default")=>`ml_${e}riskscore_init_script_${t}`,hr=(e,t="default")=>`ml_${e}riskscore_map_script_${t}`,Er=(e,t="default")=>`ml_${e}riskscore_reduce_script_${t}`,vr=e=>`ml_${e}riskscore_ingest_pipeline`,xr=e=>`ml_${e}riskscore_levels_script`,kr=e=>`ml_${e}riskscore_init_script`,Sr=e=>`ml_${e}riskscore_map_script`,jr=e=>`ml_${e}riskscore_reduce_script`,Or=(z.i18n.translate("xpack.securitySolution.riskScore.api.ingestPipeline.create.errorMessageTitle",{defaultMessage:"Failed to create Ingest pipeline"}),e=>z.i18n.translate("xpack.securitySolution.riskScore.api.ingestPipeline.delete.errorMessageTitle",{values:{totalCount:e},defaultMessage:"Failed to delete Ingest {totalCount, plural, =1 {pipeline} other {pipelines}}"})),wr=(z.i18n.translate("xpack.securitySolution.riskScore.api.storedScript.create.errorMessageTitle",{defaultMessage:"Failed to create stored script"}),z.i18n.translate("xpack.securitySolution.riskScore.api.storedScript.delete.errorMessageTitle",{defaultMessage:"Failed to delete stored script"})),Tr=(z.i18n.translate("xpack.securitySolution.riskScore.api.transforms.create.errorMessageTitle",{defaultMessage:"Failed to create Transform"}),e=>z.i18n.translate("xpack.securitySolution.riskScore.api.transforms.delete.errorMessageTitle",{values:{totalCount:e},defaultMessage:"Failed to delete {totalCount, plural, =1 {Transform} other {Transforms}}"})),Ir=z.i18n.translate("xpack.securitySolution.riskScore.api.transforms.getState.errorMessageTitle",{defaultMessage:"Failed to get Transform state"}),Cr=z.i18n.translate("xpack.securitySolution.riskScore.api.transforms.getState.notFoundMessageTitle",{defaultMessage:"Transform not found"}),Mr=e=>z.i18n.translate("xpack.securitySolution.riskScore.api.transforms.start.errorMessageTitle",{values:{totalCount:e},defaultMessage:"Failed to start {totalCount, plural, =1 {Transform} other {Transforms}}"}),Fr=e=>z.i18n.translate("xpack.securitySolution.riskScore.api.transforms.stop.errorMessageTitle",{values:{totalCount:e},defaultMessage:"Failed to stop {totalCount, plural, =1 {Transform} other {Transforms}}"}),Dr=z.i18n.translate("xpack.securitySolution.riskScore.install.errorMessageTitle",{defaultMessage:"Installation error"}),Ar=z.i18n.translate("xpack.securitySolution.riskScore.uninstall.errorMessageTitle",{defaultMessage:"Uninstallation error"}),_r=z.i18n.translate("xpack.securitySolution.riskScore.savedObjects.bulkCreateFailureTitle",{defaultMessage:"Failed to import saved objects"}),Nr=z.i18n.translate("xpack.securitySolution.riskScore.savedObjects.bulkDeleteFailureTitle",{defaultMessage:"Failed to delete saved objects"}),Rr=z.i18n.translate("xpack.securitySolution.riskScore.hostRiskScoresEnabledTitle",{defaultMessage:"Host Risk Scores enabled"}),Pr=z.i18n.translate("xpack.securitySolution.riskScore.userRiskScoresEnabledTitle",{defaultMessage:"User Risk Scores enabled"});async function Lr({errorMessage:e,http:t,names:a,notifications:n,renderDocLink:i,signal:r,theme:s}){const o=a.split(",").length;return await t.delete(`/api/ingest_pipelines/${a}`,{signal:r}).catch((t=>{var a,r,l;null==n||null===(a=n.toasts)||void 0===a||a.addDanger({title:null!=e?e:Or(o),text:Object(L.toMountPoint)(i?i(null==t||null===(r=t.body)||void 0===r?void 0:r.message):null==t||null===(l=t.body)||void 0===l?void 0:l.message,{theme$:null==s?void 0:s.theme$})})}))}const Br=6e5,qr=({messageBody:e,renderDocLink:t})=>t?t(e):e;async function zr({http:e,notifications:t,signal:a,errorMessage:n,transformIds:i,renderDocLink:r}){const s=await async function({http:e,notifications:t,signal:a,errorMessage:n,transformIds:i}){const r=await Promise.all(i.map((i=>{const r=async function({http:e,notifications:t,renderDocLink:a,signal:n,errorMessage:i=Ir,transformId:r}){return await e.get(`/api/transform/transforms/${r}/_stats`,{signal:n}).then((e=>{var n;return 0===e.count&&(null==t||null===(n=t.toasts)||void 0===n||n.addError(new Error(i),{title:i,toastMessage:qr({messageBody:`${Cr}: ${r}`,renderDocLink:a}),toastLifeTimeMs:Br})),e})).catch((e=>{var n,r;null==t||null===(n=t.toasts)||void 0===n||n.addError(e,{title:i,toastMessage:qr({messageBody:null==e||null===(r=e.body)||void 0===r?void 0:r.message,renderDocLink:a}),toastLifeTimeMs:Br})}))}({http:e,notifications:t,signal:a,errorMessage:n,transformId:i});return r})));return r}({http:e,signal:a,transformIds:i});return await e.post("/api/transform/stop_transforms",{body:JSON.stringify(s.reduce(((e,t)=>null!=t&&t.transforms.length>0?[...e,{id:t.transforms[0].id,state:t.transforms[0].state}]:e),[])),signal:a}).then((e=>{const a=Object.entries(e).reduce(((e,[t,a])=>{var n,i;return a.success?e:[...e,null!=a&&null!==(n=a.error)&&void 0!==n&&n.reason?`${t}: ${null==a||null===(i=a.error)||void 0===i?void 0:i.reason}`:t]}),[]),i=null!=n?n:Fr(a.length);var s;return a.length>0&&(null==t||null===(s=t.toasts)||void 0===s||s.addError(new Error(i),{title:i,toastMessage:qr({messageBody:a.join(", "),renderDocLink:r}),toastLifeTimeMs:Br})),e})).catch((e=>{var a,s;null==t||null===(a=t.toasts)||void 0===a||a.addError(e,{title:null!=n?n:Fr(i.length),toastMessage:qr({messageBody:null==e||null===(s=e.body)||void 0===s?void 0:s.message,renderDocLink:r}),toastLifeTimeMs:Br})}))}async function $r({http:e,notifications:t,signal:a,errorMessage:n,transformIds:i,options:r,renderDocLink:s}){return await zr({http:e,signal:a,transformIds:i}),await e.post("/api/transform/delete_transforms",{body:JSON.stringify({transformsInfo:i.map((e=>({id:e,state:"stopped"}))),...r||{}}),signal:a}).then((e=>{const a=Object.entries(e).reduce(((e,[t,a])=>{var n,i,r,s;return a.transformDeleted.success?e:[...e,null!=a&&null!==(n=a.transformDeleted)&&void 0!==n&&null!==(i=n.error)&&void 0!==i&&i.reason?`${t}: ${null==a||null===(r=a.transformDeleted)||void 0===r||null===(s=r.error)||void 0===s?void 0:s.reason}`:t]}),[]),i=null!=n?n:Tr(a.length);var r;return a.length>0&&(null==t||null===(r=t.toasts)||void 0===r||r.addError(new Error(i),{title:i,toastMessage:qr({messageBody:a.join(", "),renderDocLink:s}),toastLifeTimeMs:Br})),e})).catch((e=>{var a,r;null==t||null===(a=t.toasts)||void 0===a||a.addError(e,{title:null!=n?n:Tr(i.length),toastMessage:qr({messageBody:null==e||null===(r=e.body)||void 0===r?void 0:r.message,renderDocLink:s}),toastLifeTimeMs:Br})}))}async function Vr({http:e,notifications:t,signal:a,errorMessage:n,ids:i}){const r=await Promise.all(i.map((i=>async function({errorMessage:e,http:t,notifications:a,options:n,renderDocLink:i,signal:r,theme:o}){return await t.delete(s.ic,{body:JSON.stringify(n),signal:r}).catch((t=>{var n,r,s;null==a||null===(n=a.toasts)||void 0===n||n.addDanger({title:null!=e?e:wr,text:Object(L.toMountPoint)(i?i(null==t||null===(r=t.body)||void 0===r?void 0:r.message):null==t||null===(s=t.body)||void 0===s?void 0:s.message,{theme$:null==o?void 0:o.theme$})})}))}({http:e,notifications:t,signal:a,errorMessage:n,options:{id:i}}))));return r}const Ur=6e5,Hr=async({dashboard:e,to:t,errorMessage:a,http:n,notifications:i,options:r,renderDashboardLink:o,renderDocLink:l,from:c,theme:u})=>await n.post(Object(s.Ic)(r.templateName)).then((n=>{var s;const d=n[r.templateName],p=null==d||null===(s=d.error)||void 0===s?void 0:s.message;if(p){var m;null==i||null===(m=i.toasts)||void 0===m||m.addError(new Error(null!=a?a:_r),{title:null!=a?a:_r,toastMessage:l?l(p):p,toastLifeTimeMs:Ur})}else{var g,b,f,y,h;const a=r.templateName===`${Jn.v.user}RiskScoreDashboards`?ur:cr,n=null==d||null===(g=d.body)||void 0===g?void 0:g.find((e=>"dashboard"===e.type&&(null==e?void 0:e.title)===a));let s;var E;null!=n&&n.id&&(s=null==e||null===(E=e.locator)||void 0===E?void 0:E.getRedirectUrl({dashboardId:null==n?void 0:n.id,timeRange:{to:t,from:c}}));const l=null==d||null===(b=d.body)||void 0===b?void 0:b.map((e=>{var t;return null!==(t=null==e?void 0:e.title)&&void 0!==t?t:null==e?void 0:e.name})).join(", ");if(null==l||null==(null==d||null===(f=d.body)||void 0===f?void 0:f.length))return;null==i||null===(y=i.toasts)||void 0===y||y.addSuccess({"data-test-subj":`${r.templateName}SuccessToast`,title:(v=null==d||null===(h=d.body)||void 0===h?void 0:h.length,z.i18n.translate("xpack.securitySolution.riskScore.savedObjects.bulkCreateSuccessTitle",{values:{totalCount:v},defaultMessage:"{totalCount} {totalCount, plural, =1 {saved object} other {saved objects}} imported successfully"})),text:Object(L.toMountPoint)(o&&s?o(l,s):l,{theme$:null==u?void 0:u.theme$}),toastLifeTimeMs:Ur})}var v})).catch((e=>{var t,n,r;null==i||null===(t=i.toasts)||void 0===t||t.addError(new Error(null!=a?a:_r),{title:null!=a?a:_r,toastMessage:l?l(null==e||null===(n=e.body)||void 0===n?void 0:n.message):null==e||null===(r=e.body)||void 0===r?void 0:r.message,toastLifeTimeMs:Ur})})),Gr=async({http:e,notifications:t,errorMessage:a,options:n})=>await e.post(Object(s.Jc)(n.templateName)).catch((e=>{var n,i;null==t||null===(n=t.toasts)||void 0===n||n.addDanger({title:null!=a?a:Nr,text:null==e||null===(i=e.body)||void 0===i?void 0:i.message})})),Qr=6e5,Wr=({errorMessage:e,http:t,notifications:a,options:n,renderDocLink:i,signal:r})=>t.post(s.Kb,{body:JSON.stringify(n),signal:r}).then((t=>{const r=t.reduce(((e,t)=>{const[[a,n]]=Object.entries(t);return n.success?null!=n.success?{...e,success:[...e.success,`${a}`]}:e:null!=n.error?{...e,error:[...e.error,`${a}: ${null==n||null===(i=n.error)||void 0===i?void 0:i.message}`]}:e;var i}),{success:[],error:[]});var s,o,l;r.error.length>0?null==a||null===(s=a.toasts)||void 0===s||s.addError(new Error(null!=e?e:Dr),{title:null!=e?e:Dr,toastMessage:i?i(r.error.join(", ")):r.error.join(", "),toastLifeTimeMs:Qr}):null==a||null===(o=a.toasts)||void 0===o||o.addSuccess({"data-test-subj":`${n.riskScoreEntity}EnableSuccessToast`,title:n.riskScoreEntity===Jn.v.user?Pr:Rr,text:(l=r.success.join(", "),z.i18n.translate("xpack.securitySolution.riskScore.savedObjects.enableRiskScoreSuccessTitle",{values:{items:l},defaultMessage:"{items} imported successfully"}))})})).catch((t=>{var n,r,s;null==a||null===(n=a.toasts)||void 0===n||n.addError(new Error(null!=e?e:Dr),{title:null!=e?e:Dr,toastMessage:i?i(null==t||null===(r=t.body)||void 0===r?void 0:r.message):null==t||null===(s=t.body)||void 0===s?void 0:s.message,toastLifeTimeMs:Qr})})),Kr=async e=>{e.riskScoreEntity===Jn.v.user?await(async({dashboard:e,http:t,notifications:a,refetch:n,renderDashboardLink:i,renderDocLink:r,spaceId:s="default",theme:o,timerange:l})=>{await Wr({http:t,renderDocLink:r,notifications:a,options:{riskScoreEntity:Jn.v.user}}),await Hr({dashboard:e,http:t,notifications:a,options:{templateName:`${Jn.v.user}RiskScoreDashboards`},renderDashboardLink:i,renderDocLink:r,...l,theme:o}),n&&n()})(e):await(async({dashboard:e,http:t,notifications:a,refetch:n,renderDashboardLink:i,renderDocLink:r,theme:s,timerange:o})=>{await Wr({http:t,renderDocLink:r,notifications:a,options:{riskScoreEntity:Jn.v.host}}),await Hr({http:t,theme:s,dashboard:e,renderDashboardLink:i,renderDocLink:r,...o,notifications:a,options:{templateName:`${Jn.v.host}RiskScoreDashboards`}}),n&&n()})(e)},Yr=async({http:e,notifications:t,refetch:a,renderDocLink:n,riskScoreEntity:i,spaceId:r="default",theme:s})=>{const o=[mr(i,r),gr(i,r)],l=[xr(Jn.v.host),kr(Jn.v.host),Sr(Jn.v.host),jr(Jn.v.host),fr(Jn.v.host,r),yr(Jn.v.host,r),hr(Jn.v.host,r),Er(Jn.v.host,r)],c=[xr(Jn.v.user),Sr(Jn.v.user),jr(Jn.v.user),fr(Jn.v.user,r),hr(Jn.v.user,r),Er(Jn.v.user,r)],u=[vr(i),br(i,r)];await Promise.all([Gr({http:e,options:{templateName:`${i}RiskScoreDashboards`}}),$r({http:e,theme:s,renderDocLink:n,notifications:t,errorMessage:`${Ar} - ${Tr(o.length)}`,transformIds:o,options:{deleteDestIndex:!0,deleteDestDataView:!0,forceDelete:!1}}),Lr({http:e,errorMessage:`${Ar} - ${Or(u.length)}`,names:u.join(",")}),Vr({http:e,ids:i===Jn.v.user?c:l})]),a&&a()},Jr=async({dashboard:e,http:t,notifications:a,refetch:n,renderDashboardLink:i,renderDocLink:r,spaceId:s="default",theme:o,timerange:l})=>{await Yr({http:t,notifications:a,renderDocLink:r,riskScoreEntity:Jn.v.host,spaceId:s,theme:o}),await Kr({dashboard:e,http:t,notifications:a,refetch:n,renderDashboardLink:i,renderDocLink:r,riskScoreEntity:Jn.v.host,spaceId:s,theme:o,timerange:l})},Xr=async({dashboard:e,http:t,notifications:a,refetch:n,renderDashboardLink:i,renderDocLink:r,spaceId:s="default",theme:o,timerange:l})=>{await Yr({http:t,notifications:a,renderDocLink:r,riskScoreEntity:Jn.v.user,spaceId:s,theme:o}),await Kr({dashboard:e,http:t,notifications:a,refetch:n,renderDashboardLink:i,renderDocLink:r,riskScoreEntity:Jn.v.user,spaceId:s,theme:o,timerange:l})},Zr=async({http:e,notifications:t,refetch:a,renderDocLink:n,riskScoreEntity:i,spaceId:r})=>{const s=[mr(i,r),gr(i,r)];await zr({http:e,notifications:t,renderDocLink:n,transformIds:s});const o=await async function({http:e,notifications:t,renderDocLink:a,signal:n,errorMessage:i,transformIds:r}){return await e.post("/api/transform/start_transforms",{body:JSON.stringify(r.map((e=>({id:e})))),signal:n}).then((e=>{const n=Object.entries(e).reduce(((e,[t,a])=>{var n,i;return a.success?e:[...e,null!=a&&null!==(n=a.error)&&void 0!==n&&n.reason?`${t}: ${null==a||null===(i=a.error)||void 0===i?void 0:i.reason}`:t]}),[]),r=null!=i?i:Mr(n.length);var s;return n.length>0&&(null==t||null===(s=t.toasts)||void 0===s||s.addError(new Error(r),{title:r,toastMessage:qr({messageBody:n.join(", "),renderDocLink:a}),toastLifeTimeMs:Br})),e})).catch((e=>{var n,s;null==t||null===(n=t.toasts)||void 0===n||n.addError(e,{title:null!=i?i:Mr(r.length),toastMessage:qr({messageBody:null==e||null===(s=e.body)||void 0===s?void 0:s.message,renderDocLink:a}),toastLifeTimeMs:Br})}))}({http:e,notifications:t,renderDocLink:n,transformIds:s});return a&&a(),o};var es=a(561);const ts=H()(V.EuiButton).withConfig({displayName:"StyledButton",componentId:"sc-deic3m-0"})(["float:right;"]),as=e=>{const t=Object(n.useCallback)((t=>i.a.createElement(i.a.Fragment,null,t," ",i.a.createElement(es.a,{riskScoreEntity:e}))),[e]),a=Object(n.useCallback)(((e,t)=>i.a.createElement(i.a.Fragment,null,e,i.a.createElement(V.EuiSpacer,{size:"s"}),i.a.createElement(ts,{href:t,target:"_blank"},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.risk_score.toast.viewDashboard",defaultMessage:"View dashboard"})))),[]);return Object(n.useMemo)((()=>({renderDocLink:t,renderDashboardLink:a})),[a,t])};var ns=a(422);const is=({disabled:e,refetch:t,riskScoreEntity:a,timerange:r,title:s})=>{const o=Object(pr.a)(),{http:l,notifications:c,theme:u,dashboard:d}=Object(p.k)().services,{renderDocLink:m,renderDashboardLink:g}=as(a),{fetch:b,isLoading:f}=Object(ns.b)(ns.a.UPGRADE_RISK_SCORE,a===Jn.v.user?Xr:Jr),[y,h]=Object(n.useState)(!1),E=Object(n.useCallback)((()=>h(!1)),[]),v=Object(n.useCallback)((()=>h(!0)),[]),x=Object(n.useCallback)((async()=>{E(),b({http:l,notifications:c,spaceId:o,timerange:r,refetch:t,renderDashboardLink:g,renderDocLink:m,riskScoreEntity:a,theme:u,dashboard:d})}),[E,b,l,c,o,r,t,g,m,a,u,d]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiButton,{color:"primary","data-test-subj":`${a}-risk-score-upgrade`,disabled:e,fill:!0,isLoading:f,onClick:v},s),y&&i.a.createElement(V.EuiConfirmModal,{"data-test-subj":`${a}-risk-score-upgrade-confirmation-modal`,title:s,onCancel:E,onConfirm:x,cancelButtonText:i.a.createElement(es.a,{riskScoreEntity:a,title:i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.riskScore.upgradeConfirmation.cancel",defaultMessage:"Preserve data"})}),confirmButtonText:i.a.createElement(dr.FormattedMessage,{"data-test-subj":`${a}-risk-score-upgrade-confirmation-button`,id:"xpack.securitySolution.riskScore.upgradeConfirmation.confirm",defaultMessage:"Erase data and Upgrade"}),buttonColor:"danger",defaultFocusedButton:"confirm"},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.riskScore.upgradeConfirmation.content",defaultMessage:"The upgrade will delete existing risk scores from your environment. You may preserve existing risk data before upgrading the Risk Score package. Do you wish to upgrade?"})))},rs=i.a.memo(is);rs.displayName="RiskScoreUpgradeButton";var ss=a(83),os=a(193),ls=a(404);var cs=a(357);const us=({refetch:e,riskScoreEntity:t,disabled:a=!1,timerange:r})=>{const s=Object(pr.a)(),{http:o,notifications:l,theme:c,dashboard:u}=Object(p.k)().services,{renderDocLink:d,renderDashboardLink:m}=as(t),{fetch:g,isLoading:b}=Object(ns.b)(ns.a.ENABLE_RISK_SCORE,Kr),f=Object(n.useCallback)((()=>{g({dashboard:u,http:o,notifications:l,refetch:e,renderDashboardLink:m,renderDocLink:d,riskScoreEntity:t,spaceId:s,theme:c,timerange:r})}),[u,g,o,l,e,m,d,t,s,c,r]);return i.a.createElement(V.EuiButton,{color:"primary",fill:!0,onClick:f,isLoading:b,"data-test-subj":`enable_${t}_risk_score`,disabled:a},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.riskScore.enableButtonTitle",defaultMessage:"Enable"}))},ds=i.a.memo(us);ds.displayName="RiskScoreEnableButton";var ps=a(212);const ms=z.i18n.translate("xpack.securitySolution.enableRiskScore.enableRiskScorePopoverTitle",{defaultMessage:"Alerts need to be available before enabling module"}),gs=z.i18n.translate("xpack.securitySolution.riskDeprecated.entity.upgradeRiskScoreDescription",{defaultMessage:"Current data is no longer supported. Please migrate your data and upgrade the module. The data might need an hour to be generated after enabling the module."}),bs=e=>z.i18n.translate("xpack.securitySolution.enableRiskScore.enableRiskScore",{defaultMessage:"Enable {riskEntity} Risk Score",values:{riskEntity:Object(ps.c)(e)}}),fs=e=>z.i18n.translate("xpack.securitySolution.enableRiskScore.enableRiskScoreDescription",{defaultMessage:"Once you have enabled this feature you can get quick access to the {riskEntity} risk scores in this section. The data might need an hour to be generated after enabling the module.",values:{riskEntity:Object(ps.c)(e,!0)}}),ys=({isDeprecated:e,isDisabled:t,entityType:a,refetch:r,timerange:s})=>{const{signalIndexExists:o}=(()=>{const[e,t]=Object(n.useState)(!0),[a,i]=Object(n.useState)({signalIndexExists:null,signalIndexName:null,signalIndexMappingOutdated:null}),{addError:r}=Object(Oi.a)(),{hasIndexRead:s}=Object(oa.a)();return Object(n.useEffect)((()=>{let e=!0;const a=new AbortController;return s?(async()=>{try{t(!0);const n=await Object(os.a)({signal:a.signal});e&&null!=n&&i({signalIndexExists:null==n?void 0:n.indexExists,signalIndexName:n.name,signalIndexMappingOutdated:n.index_mapping_outdated})}catch(t){e&&(i({signalIndexExists:!1,signalIndexName:null,signalIndexMappingOutdated:null}),Object(ss.t)(t)&&404!==t.body.status_code&&r(t,{title:ls.c}))}e&&t(!1)})():t(!1),()=>{e=!1,a.abort()}}),[r,s]),{loading:e,...a}})();if(!e&&!t)return null;const l=e?{cta:(c=a,z.i18n.translate("xpack.securitySolution.enableRiskScore.upgradeRiskScore",{defaultMessage:"Upgrade {riskEntity} Risk Score",values:{riskEntity:Object(ps.c)(c)}})),body:gs}:{cta:bs(a),body:fs(a)};var c;return i.a.createElement(V.EuiPanel,{hasBorder:!0},i.a.createElement(Tt.a,{title:i.a.createElement(cs.a,{riskScoreEntity:a}),titleSize:"s"}),i.a.createElement(V.EuiEmptyPrompt,{title:i.a.createElement("h2",null,l.cta),body:i.a.createElement(i.a.Fragment,null,l.body," ",i.a.createElement(es.a,{riskScoreEntity:a})),actions:i.a.createElement(V.EuiToolTip,{content:o?null:ms},e?i.a.createElement(rs,{refetch:r,riskScoreEntity:a,disabled:!o,timerange:s,"data-test-subj":`upgrade_${a}_risk_score`,title:l.cta}):i.a.createElement(ds,{disabled:!o,refetch:r,riskScoreEntity:a,timerange:s}))}))},hs=i.a.memo(ys);hs.displayName="EnableRiskScore";var Es=a(236),vs=a(266);const xs=z.i18n.translate("xpack.securitySolution.riskInformation.classificationHeader",{defaultMessage:"Classification"}),ks=(z.i18n.translate("xpack.securitySolution.riskInformation.informationAriaLabel",{defaultMessage:"Information"}),e=>z.i18n.translate("xpack.securitySolution.riskInformation.riskHeader",{defaultMessage:"{riskEntity} risk score range",values:{riskEntity:Object(ps.c)(e)}})),Ss=z.i18n.translate("xpack.securitySolution.riskInformation.unknownRiskDescription",{defaultMessage:"Less than 20"}),js=z.i18n.translate("xpack.securitySolution.riskInformation.criticalRiskDescription",{defaultMessage:"90 and above"}),Os=z.i18n.translate("xpack.securitySolution.riskInformation.closeBtn",{defaultMessage:"Close"}),ws=z.i18n.translate("xpack.securitySolution.riskInformation.buttonLabel",{defaultMessage:"How is risk score calculated?"}),Ts=e=>[{field:"classification",name:xs,render:e=>{if(null!=e)return i.a.createElement(Zn.b,{severity:e,hideBackgroundColor:!0})}},{field:"range",name:ks(e)}],Is=[{classification:Jn.x.critical,range:js},{classification:Jn.x.high,range:"70 - 90 "},{classification:Jn.x.moderate,range:"40 - 70"},{classification:Jn.x.low,range:"20 - 40"},{classification:Jn.x.unknown,range:Ss}],Cs=({riskEntity:e})=>{const[t,a,r]=(()=>{const[e,t]=Object(n.useState)(!1),a=Object(n.useCallback)((()=>{t(!1)}),[]);return[e,Object(n.useCallback)((()=>{t(!0)}),[]),a]})();return i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiButtonEmpty,{onClick:a,"data-test-subj":"open-risk-information-flyout-trigger"},ws),t&&i.a.createElement(Ms,{riskEntity:e,handleOnClose:r}))},Ms=({handleOnClose:e,riskEntity:t})=>{const a=Object(V.useGeneratedHtmlId)({prefix:"RiskInformation"});return i.a.createElement(V.EuiFlyout,{ownFocus:!0,onClose:e,"aria-labelledby":a,size:450,"data-test-subj":"open-risk-information-flyout"},i.a.createElement(V.EuiFlyoutHeader,{hasBorder:!0},i.a.createElement(V.EuiTitle,{size:"m"},i.a.createElement("h2",{id:a},(e=>z.i18n.translate("xpack.securitySolution.riskInformation.title",{defaultMessage:"How is {riskEntity} risk calculated?",values:{riskEntity:Object(ps.c)(e,!0)}}))(t)))),i.a.createElement(V.EuiFlyoutBody,null,i.a.createElement(V.EuiText,{size:"s"},i.a.createElement("p",null,(e=>z.i18n.translate("xpack.securitySolution.riskInformation.introduction",{defaultMessage:"The {riskEntity} Risk Score capability surfaces risky {riskEntityLowerPlural} from within your environment.",values:{riskEntity:Object(ps.c)(e),riskEntityLowerPlural:Object(ps.c)(e,!0,!0)}}))(t)),i.a.createElement("p",null,(e=>z.i18n.translate("xpack.securitySolution.riskInformation.explanation",{defaultMessage:'This feature utilizes a transform, with a scripted metric aggregation to calculate {riskEntityLower} risk scores based on detection rule alerts with an "open" status, within a 5 day time window. The transform runs hourly to keep the score updated as new detection rule alerts stream in.',values:{riskEntityLower:Object(ps.c)(e,!0)}}))(t))),i.a.createElement(V.EuiSpacer,null),i.a.createElement(V.EuiBasicTable,{columns:Ts(t),items:Is,"data-test-subj":"risk-information-table"}),i.a.createElement(V.EuiSpacer,{size:"l"}),i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.riskInformation.learnMore",defaultMessage:"You can learn more about {riskEntity} risk {riskScoreDocumentationLink}",values:{riskScoreDocumentationLink:i.a.createElement(es.a,{riskScoreEntity:t,title:i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.riskInformation.link",defaultMessage:"here"})}),riskEntity:Object(ps.c)(t,!0)}})),i.a.createElement(V.EuiFlyoutFooter,null,i.a.createElement(V.EuiFlexGroup,{justifyContent:"flexEnd"},i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiButton,{onClick:e},Os)))))},Fs=e=>z.i18n.translate("xpack.securitySolution.riskTabBody.scoreOverTimeTitle",{defaultMessage:"{riskEntity} risk score over time",values:{riskEntity:Object(ps.c)(e)}}),Ds=z.i18n.translate("xpack.securitySolution.riskTabBody.viewDashboardButtonLabel",{defaultMessage:"View source dashboard"});var As=a(127),_s=a(40),Ns=a(198);const Rs=z.i18n.translate("xpack.securitySolution.hosts.hostScoreOverTime.riskyThresholdHeader",{defaultMessage:"Risky threshold"}),Ps=z.i18n.translate("xpack.securitySolution.hosts.hostScoreOverTime.riskyLabel",{defaultMessage:"Risky"}),Ls=z.i18n.translate("xpack.securitySolution.hosts.hostScoreOverTime.riskScore",{defaultMessage:"Risk score"}),Bs=H()(V.EuiText).withConfig({displayName:"StyledEuiText",componentId:"sc-1km8b2b-0"})(["font-size:9px;font-weight:",";margin-right:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold),(({theme:e})=>e.eui.euiSizeXS)),qs=H()(V.EuiLoadingChart).withConfig({displayName:"LoadingChart",componentId:"sc-1km8b2b-1"})(["display:block;text-align:center;"]),zs=e=>Math.round(e).toString(),$s=({from:e,to:t,riskScore:a,loading:r,queryId:s,title:o,toggleStatus:l,toggleQuery:c})=>{const u=Object(p.n)(),d=Object(n.useMemo)((()=>Object(Ns.a)([e,t])),[e,t]),m=Object(n.useCallback)((e=>i.a.createElement(xa.c,{value:e.value})),[]),g=Object(Xe.i)(),b=Object(n.useMemo)((()=>{var e;return null!==(e=null==a?void 0:a.map((e=>({x:e["@timestamp"],y:(Object(Jn.G)(e)?e.user:e.host).risk.calculated_score_norm}))).reverse())&&void 0!==e?e:[]}),[a]);return i.a.createElement(Ne.c,null,i.a.createElement(V.EuiPanel,{hasBorder:!0,"data-test-subj":"RiskScoreOverTime"},i.a.createElement(V.EuiFlexGroup,{gutterSize:"none"},i.a.createElement(V.EuiFlexItem,{grow:1},i.a.createElement(Tt.a,{title:o,hideSubtitle:!0,toggleQuery:c,toggleStatus:l})),l&&i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(Ne.b,{queryId:s,title:o}))),l&&i.a.createElement(V.EuiFlexGroup,{gutterSize:"none",direction:"column"},i.a.createElement(V.EuiFlexItem,{grow:1},i.a.createElement("div",{style:{height:250}},r?i.a.createElement(qs,{size:"l","data-test-subj":"RiskScoreOverTime-loading"}):i.a.createElement(Je.Chart,null,i.a.createElement(Je.Settings,lr()({},Xe.e,{theme:g,tooltip:{headerFormatter:m}})),i.a.createElement(Je.Axis,{id:"bottom",position:Je.Position.Bottom,tickFormat:d,showGridLines:!0,gridLine:{strokeWidth:1,opacity:1,dash:[3,5]}}),i.a.createElement(Je.Axis,{domain:{min:0,max:100},id:"left",position:Je.Position.Left,ticks:3,style:{tickLine:{visible:!1},tickLabel:{padding:10}}}),i.a.createElement(Je.LineSeries,{id:"RiskOverTime",name:Ls,xScaleType:Je.ScaleType.Time,yScaleType:Je.ScaleType.Linear,xAccessor:"x",yAccessors:["y"],timeZone:u,data:b,tickFormat:zs}),i.a.createElement(Je.LineAnnotation,{id:"RiskOverTime_annotation",domainType:Je.AnnotationDomainType.YDomain,dataValues:[{dataValue:70,details:"70",header:Rs}],markerPosition:"left",style:{line:{strokeWidth:1,stroke:_s.euiThemeVars.euiColorDanger,opacity:1}},marker:i.a.createElement(Bs,{color:_s.euiThemeVars.euiColorDarkestShade},Ps)})))))))};$s.displayName="RiskScoreOverTimeComponent";const Vs=i.a.memo($s);Vs.displayName="RiskScoreOverTime";const Us=z.i18n.translate("xpack.securitySolution.hosts.topRiskScoreContributors.title",{defaultMessage:"Top risk score contributors"}),Hs=z.i18n.translate("xpack.securitySolution.hosts.topRiskScoreContributors.rankColumnTitle",{defaultMessage:"Rank"}),Gs=z.i18n.translate("xpack.securitySolution.hosts.topRiskScoreContributors.ruleNameColumnTitle",{defaultMessage:"Rule name"});var Qs=a(43),Ws=a.n(Qs),Ks=a(157),Ys=a(1111),Js=a(313),Xs=a(911),Zs=a(899),eo=a(565);const to=H()(V.EuiFlexGroup).withConfig({displayName:"IntegrationsPopoverWrapper",componentId:"sc-1rv38wr-0"})(["width:100%;"]),ao=H()(V.EuiPopoverTitle).withConfig({displayName:"PopoverTitleWrapper",componentId:"sc-1rv38wr-1"})(["max-width:390px;"]),no=H()("div").withConfig({displayName:"PopoverContentWrapper",componentId:"sc-1rv38wr-2"})(["max-height:400px;max-width:390px;overflow:auto;line-height:",";"],(({theme:e})=>e.eui.euiLineHeight)),io=H()("li").withConfig({displayName:"IntegrationListItem",componentId:"sc-1rv38wr-3"})(["list-style-type:disc;margin-left:25px;margin-bottom:5px;"]),ro=({relatedIntegrations:e})=>{const[t,a]=Object(n.useState)(!1),{integrations:r,isLoaded:s}=Object(Zs.a)(e),o=Object(n.useMemo)((()=>r.filter((e=>e.installationStatus.isKnown&&e.installationStatus.isEnabled))),[r]),l=r.length,c=o.length,u=Object(n.useMemo)((()=>s?`${c}/${l} ${eo.a}`:`${l} ${eo.a}`),[s,l,c]);return i.a.createElement(to,{alignItems:"center",gutterSize:"s","data-test-subj":"IntegrationsWrapper"},i.a.createElement(V.EuiPopover,{ownFocus:!0,"data-test-subj":"IntegrationsDisplayPopover",button:i.a.createElement(V.EuiBadge,{iconType:"package",color:"hollow","data-test-subj":"IntegrationsDisplayPopoverButton",onClick:()=>a(!t),onClickAriaLabel:u},u),isOpen:t,closePopover:()=>a(!t),repositionOnScroll:!0},i.a.createElement(ao,{"data-test-subj":"IntegrationsPopoverTitle"},eo.h(l)),i.a.createElement(no,{"data-test-subj":"IntegrationsPopoverContentWrapper"},i.a.createElement(V.EuiText,{size:"s"},eo.g(l)),i.a.createElement(V.EuiSpacer,{size:"s"}),i.a.createElement("ul",null,r.map(((e,t)=>i.a.createElement(io,{key:`${e.packageName}-${t}`},i.a.createElement(Xs.a,{integration:e}))))))))},so=i.a.memo(ro);so.displayName="IntegrationsPopover";const oo=so;var lo=a(583),co=a(882),uo=a(113),po=a(374),mo=a(884),go=a(238),bo=a(885);const fo=()=>{const{services:{application:{capabilities:{actions:e}}}}=Object(p.k)();return!Object(Js.d)(e.show)||e.show};var yo=a(366),ho=a(259);const Eo=()=>{const e=Object(ar.a)();return Object(ho.a)(e)&&Object(yo.a)(e)};var vo=a(536),xo=a(131),ko=a(179),So=a(154),jo=a(844),Oo=a(519),wo=a(827),To=a(173);const Io=z.i18n.translate("xpack.securitySolution.detectionEngine.ruleManagementUi.rulesTable.mlJobsWarning.popover.description",{defaultMessage:"The following jobs are not running and might cause the rule to generate wrong results:"}),Co=z.i18n.translate("xpack.securitySolution.detectionEngine.ruleManagementUi.rulesTable.mlJobsWarning.popover.buttonLabel",{defaultMessage:"Visit rule details page to investigate"});var Mo=a(312),Fo=a(166),Do=a(417);const Ao=({rule:e,loadingJobs:t,jobs:a})=>{const[n,,r,o]=Object(Mo.a)();if(!Object(Fo.c)(e.type)||t||!e.machine_learning_job_id)return null;const l=e.machine_learning_job_id,c=a.filter((e=>l.includes(e.id)&&!Object(Ks.c)(e.jobState,e.datafeedState)));if(!c.length)return null;const u=i.a.createElement(V.EuiButtonIcon,{display:"empty",color:"warning",iconType:"alert",onClick:o}),d=Object(Do.a)(To.f["partial failure"]);return i.a.createElement(V.EuiPopover,{button:u,isOpen:n,closePopover:r,anchorPosition:"leftCenter"},i.a.createElement(V.EuiPopoverTitle,null,d),i.a.createElement("div",{style:{width:"340px"}},i.a.createElement(V.EuiText,{size:"s"},i.a.createElement("p",null,Io))),i.a.createElement(V.EuiSpacer,{size:"s"}),c.map((e=>i.a.createElement(V.EuiText,null,e.id))),i.a.createElement(V.EuiPopoverFooter,null,i.a.createElement(be.l,{"data-test-subj":"open-rule-details",fullWidth:!0,deepLinkId:s.uc.rules,path:Object(X.c)(e.id,po.b.alerts)},Co)))},_o=i.a.memo(Ao);_o.displayName="MlRuleWarningPopover";const No=({hasCRUDPermissions:e,startMlJobs:t})=>{const a=Eo(),r=fo(),{loadingRulesAction:s,loadingRuleIds:o}=Object(go.b)().state,l=Object(n.useMemo)((()=>["disable","enable","edit","delete"].includes(null!=s?s:"")?o:[]),[o,s]);return Object(n.useMemo)((()=>({field:"enabled",name:uo.ab,render:(n,s)=>i.a.createElement(V.EuiToolTip,{position:"top",content:Object(Js.b)(s,a,r,e)},i.a.createElement(co.a,{id:s.id,enabled:s.enabled,startMlJobsIfNeeded:()=>t(s.machine_learning_job_id),isDisabled:!Object(Js.a)(s,r)||!e||Object(Ks.d)(s.type)&&!a,isLoading:l.includes(s.id)})),width:"95px",sortable:!0})),[a,r,e,l,t])},Ro=({name:e,id:t})=>i.a.createElement(V.EuiToolTip,{content:e,anchorClassName:"eui-textTruncate"},i.a.createElement(be.k,{"data-test-subj":"ruleName",deepLinkId:s.uc.rules,path:Object(X.c)(t,po.b.alerts)},e)),Po=()=>Object(n.useMemo)((()=>({field:"name",name:uo.lb,render:(e,t)=>i.a.createElement(Ro,{id:t.id,name:e}),sortable:!0,truncateText:!0,width:"38%"})),[]),Lo=({sortable:e,width:t,isLoadingJobs:a,mlJobs:r})=>Object(n.useMemo)((()=>({field:"execution_summary.last_execution.status",name:uo.gb,render:(e,t)=>{var n;return i.a.createElement(V.EuiFlexGroup,{justifyContent:"spaceBetween"},i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(lo.b,{status:e,message:null===(n=t.execution_summary)||void 0===n?void 0:n.last_execution.message})),i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(_o,{rule:t,loadingJobs:a,jobs:r})))},sortable:e,truncateText:!0,width:t})),[a,r,e,t]),Bo={field:"tags",name:null,align:"center",render:e=>0===e.length?null:i.a.createElement(Ys.a,{items:e,popoverTitle:uo.nb,popoverButtonTitle:e.length.toString(),popoverButtonIcon:"tag",dataTestPrefix:"tags",renderItem:(e,t)=>i.a.createElement(V.EuiBadge,{color:"hollow",key:`${e}-${t}`,"data-test-subj":"tag"},e)}),width:"65px",truncateText:!0},qo={field:"related_integrations",name:null,align:"center",render:e=>null==e||0===e.length?null:i.a.createElement(oo,{relatedIntegrations:e}),width:"143px",truncateText:!0},zo=({showExceptionsDuplicateConfirmation:e})=>{const t=(({showExceptionsDuplicateConfirmation:e})=>{const{navigateToApp:t}=Object(p.k)().services.application,a=fo(),{startTransaction:n}=Object(So.a)(),{executeBulkAction:r}=Object(Oo.b)(),{bulkExport:s}=Object(jo.a)(),o=Object(wo.a)();return[{type:"icon","data-test-subj":"editRuleAction",description:uo.Bb,name:a?uo.Bb:i.a.createElement(V.EuiToolTip,{position:"left",content:uo.Ob},i.a.createElement(i.a.Fragment,null,uo.Bb)),icon:"controlsHorizontal",onClick:e=>Object(Oo.a)(e.id,t),enabled:e=>Object(Js.a)(e,a)},{type:"icon","data-test-subj":"duplicateRuleAction",description:uo.zb,icon:"copy",name:a?uo.zb:i.a.createElement(V.EuiToolTip,{position:"left",content:uo.Ob},i.a.createElement(i.a.Fragment,null,uo.zb)),enabled:e=>Object(Js.a)(e,a),onClick:async a=>{n({name:ko.e.DUPLICATE});const i=await e();if(null===i)return;const s=await r({type:xo.b.duplicate,ids:[a.id],duplicatePayload:{include_exceptions:i===vo.a.withExceptions}}),o=null==s?void 0:s.attributes.results.created;null!=o&&o.length&&Object(Oo.a)(o[0].id,t)}},{type:"icon","data-test-subj":"exportRuleAction",description:uo.Hb,icon:"exportAction",name:uo.Hb,onClick:async e=>{n({name:ko.e.EXPORT});const t=await s({ids:[e.id]});t&&await o(t)},enabled:e=>!e.immutable},{type:"icon","data-test-subj":"deleteRuleAction",description:uo.yb,icon:"trash",name:uo.yb,onClick:async e=>{n({name:ko.e.DELETE}),await r({type:xo.b.delete,ids:[e.id]})}}]})({showExceptionsDuplicateConfirmation:e});return Object(n.useMemo)((()=>({actions:t,width:"40px"})),[t])},$o=[{name:Hs,field:"rank",width:"45px",align:"right"},{name:Gs,field:"name",sortable:!0,truncateText:!0,render:(e,{id:t})=>t?i.a.createElement(Ro,{id:t,name:e}):e}],Vo=({rules:e=[],loading:t,queryId:a,toggleStatus:r,toggleQuery:s})=>{const o=Object(n.useMemo)((()=>null==e?void 0:e.sort(((e,t)=>t.rule_risk-e.rule_risk)).map((({rule_name:e,rule_id:t},a)=>({rank:a+1,name:e,id:t})))),[e]),l=Object(n.useMemo)((()=>({showPerPageOptions:!1,pageSize:5,totalItemCount:o.length})),[o.length]);return i.a.createElement(Ne.c,null,i.a.createElement(V.EuiPanel,{hasBorder:!0,"data-test-subj":"topRiskScoreContributors"},i.a.createElement(V.EuiFlexGroup,{gutterSize:"none"},i.a.createElement(V.EuiFlexItem,{grow:1},i.a.createElement(Tt.a,{title:Us,hideSubtitle:!0,toggleQuery:s,toggleStatus:r})),r&&i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(Ne.b,{queryId:a,title:Us}))),r&&i.a.createElement(V.EuiFlexGroup,{"data-test-subj":"topRiskScoreContributors-table",gutterSize:"none",direction:"column"},i.a.createElement(V.EuiFlexItem,{grow:1},i.a.createElement(V.EuiInMemoryTable,{items:o,columns:$o,pagination:l,loading:t})))))},Uo=i.a.memo(Vo);Uo.displayName="TopRiskScoreContributors";var Ho=a(872);const Go=({refetch:e,riskScoreEntity:t})=>{const{fetch:a,isLoading:r}=Object(ns.b)(ns.a.REFRESH_RISK_SCORE,Zr),s=Object(pr.a)(),{renderDocLink:o}=as(t),{http:l,notifications:c}=Object(p.k)().services,u=Object(n.useCallback)((async()=>{a({http:l,notifications:c,refetch:e,renderDocLink:o,riskScoreEntity:t,spaceId:s})}),[a,l,c,e,o,t,s]);return i.a.createElement(V.EuiButton,{color:"primary",fill:!0,onClick:u,isLoading:r,"data-test-subj":`restart_${t}_risk_score`},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.riskScore.restartButtonTitle",defaultMessage:"Restart"}))},Qo=i.a.memo(Go);Qo.displayName="RiskScoreRestartButton";var Wo=a(639);const Ko=({entityType:e,refetch:t})=>{const a=Object(n.useMemo)((()=>({title:e===Jn.v.user?Ho.f:Ho.b,body:e===Jn.v.user?Ho.e:Ho.a})),[e]);return i.a.createElement(V.EuiPanel,{"data-test-subj":`${e}-risk-score-no-data-detected`,hasBorder:!0},i.a.createElement(Tt.a,{title:i.a.createElement(cs.a,{riskScoreEntity:e}),titleSize:"s",tooltip:e===Jn.v.user?Wo.d:Wo.a}),i.a.createElement(V.EuiEmptyPrompt,{title:i.a.createElement("h2",null,a.title),body:a.body,actions:i.a.createElement(V.EuiToolTip,{content:Ho.c},i.a.createElement(Qo,{refetch:t,riskScoreEntity:e}))}))},Yo=i.a.memo(Ko);Yo.displayName="RiskScoresNoDataDetected";const Jo=H()(V.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-1dmz59u-0"})(["margin-top:",";"],(({theme:e})=>e.eui.euiSizeL)),Xo=e=>e===Jn.v.host?cr:ur,Zo=({entityName:e,startDate:t,endDate:a,setQuery:r,deleteQuery:s,riskEntity:o})=>{const l=Object(n.useMemo)((()=>o===Jn.v.host?Yn.a.HOST_DETAILS_RISK_SCORE:Yn.b.USER_DETAILS_RISK_SCORE),[o]),c=Object(x.a)((e=>o===Jn.v.host?Es.d.hostRiskScoreSeverityFilterSelector()(e,Es.b.HostsType.details):vs.e.userRiskScoreSeverityFilterSelector()(e))),{buttonHref:u}=(({to:e,from:t,title:a})=>{const{dashboard:i,savedObjects:{client:r}}=Object(p.k)().services,[s,o]=Object(n.useState)();return Object(n.useEffect)((()=>{null!=i&&i.locator&&r&&r.find((e=>({type:"dashboard",search:`"${e}"`,fields:["title"]}))(a)).then((async a=>{var n;if(null!=a&&null!==(n=a.savedObjects)&&void 0!==n&&n.length&&e&&t){var r;const n=await(null==i||null===(r=i.locator)||void 0===r?void 0:r.getUrl({dashboardId:a.savedObjects[0].id,timeRange:{to:e,from:t}}));o(n)}}))}),[i,t,r,e,a]),{buttonHref:s}})({to:a,from:t,title:Xo(o)}),d=Object(n.useMemo)((()=>({from:t,to:a})),[t,a]),{toggleStatus:m,setToggleStatus:g}=Object(Ht.a)(`${l} overTime`),{toggleStatus:b,setToggleStatus:f}=Object(Ht.a)(`${l} contributors`),y=Object(n.useMemo)((()=>e?Object(Jn.B)([e],o):{}),[e,o]),{data:h,loading:E,refetch:v,inspect:k,isDeprecated:S,isModuleEnabled:j}=Object(Yn.c)({filterQuery:y,onlyLatest:!1,riskEntity:o,skip:!m&&!b,timerange:d}),O=Object(n.useMemo)((()=>{const e=h&&h.length>0?h[h.length-1]:null;return e?o===Jn.v.host?e.host.risk.rule_risks:e.user.risk.rule_risks:[]}),[h,o]);Object(As.b)({queryId:l,loading:E,refetch:v,setQuery:r,deleteQuery:s,inspect:k});const w=Object(n.useCallback)((e=>{f(e)}),[f]),T=Object(n.useCallback)((e=>{g(e)}),[g]),I={isDisabled:!j&&!E,isDeprecated:S&&!E};return I.isDisabled||I.isDeprecated?i.a.createElement(hs,lr()({},I,{entityType:o,refetch:v,timerange:d})):j&&0===c.length&&h&&0===h.length?i.a.createElement(Yo,{entityType:o,refetch:v}):i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiFlexGroup,{direction:"row"},i.a.createElement(V.EuiFlexItem,{grow:2},i.a.createElement(Vs,{from:t,to:a,loading:E,riskScore:h,queryId:l,title:Fs(o),toggleStatus:m,toggleQuery:T})),i.a.createElement(V.EuiFlexItem,{grow:1},i.a.createElement(Uo,{loading:E,queryId:l,toggleStatus:b,toggleQuery:w,rules:O}))),i.a.createElement(Jo,{gutterSize:"s"},i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiButton,{href:u,isDisabled:!u,"data-test-subj":`risky-${o}s-view-dashboard-button`,target:"_blank"},Ds)),i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(Cs,{riskEntity:o}))))};Zo.displayName="RiskDetailsTabBodyComponent";const el=i.a.memo(Zo);el.displayName="RiskDetailsTabBody";var tl=a(134),al=a(420),nl=a(325),il=a(288),rl=a(181),sl=a(533),ol=a(847);var ll=a(388);const cl=(e,t)=>"host.name"===e.entityName&&(null==t||e.entityValue===t);var ul=a(816);const dl=(e,t)=>e===tl.HostsType.details&&null!=t?[{fieldName:"host.name",fieldValue:t}]:[];var pl=a(318),ml=a(248),gl=a(817),bl=a(818);const fl={sort:{field:"anomaly.severity",direction:"desc"}},yl=({startDate:e,endDate:t,hostName:a,skip:r,type:s})=>{const l=Object(o.useDispatch)(),c=Object(ar.a)(),{toggleStatus:u,setToggleStatus:d}=Object(Ht.a)("AnomaliesHostTable"),[p,m]=Object(n.useState)(r||!u);Object(n.useEffect)((()=>{m(r||!u)}),[r,u]);const g=Object(n.useCallback)((e=>{d(e),m(!e)}),[m,d]),{jobIds:b,loading:f}=Object(ml.b)(),y=Object(n.useMemo)((()=>Es.d.hostsAnomaliesJobIdFilterSelector()),[]),h=Object(x.a)((e=>y(e,s))),E=Object(n.useCallback)((e=>{l(Es.a.updateHostsAnomaliesJobIdFilter({jobIds:e,hostsType:s}))}),[l,s]),v=Object(n.useMemo)((()=>Es.d.hostsAnomaliesIntervalSelector()),[]),k=Object(x.a)((e=>v(e,s))),S=Object(n.useCallback)((e=>{l(Es.a.updateHostsAnomaliesInterval({interval:e,hostsType:s}))}),[l,s]),[j,O]=Object(nl.a)({startDate:e,endDate:t,skip:p,criteriaFields:dl(s,a),filterQuery:{exists:{field:"host.name"}},jobIds:h.length>0?h:b,aggregationInterval:k}),w=((e,t)=>null==e?[]:e.anomalies.reduce(((e,a)=>{if(cl(a,t))return[...e,{hostName:a.entityValue,anomaly:a}];{const n=((e=[],t)=>{const a=e.find((e=>{const[a,n]=Object(ll.a)(e);return"host.name"===a&&(null==t||n===t)}));return null!=a?Object.values(a)[0]:null})(a.influencers,t);return null!=n?[...e,{hostName:n,anomaly:a}]:e}}),[]))(O,a),T=((e,t,a)=>{const n=((e,t)=>[{name:il.d,field:"hostName",sortable:!0,render:(e,t)=>Object(rl.b)({rowItem:e,attrName:"host.name",idPrefix:`anomalies-host-table-hostName-${Object(sl.a)(t.anomaly)}-hostName`,render:e=>i.a.createElement(be.d,{hostName:e}),isAggregatable:!0,fieldType:"keyword"})},...Object(ol.a)(e,t)])(t,a);return e===tl.HostsType.details?n.filter((e=>e.name!==il.d)):n})(s,e,t),I={initialPageIndex:0,initialPageSize:10,totalItemCount:w.length,pageSizeOptions:[5,10,20,50],showPerPageOptions:!0};return Object(tr.a)(c)?i.a.createElement(pl.a,{loading:j||f},i.a.createElement(Tt.a,{subtitle:`${il.o}: ${I.totalItemCount.toLocaleString()} ${il.r(I.totalItemCount)}`,title:il.a,toggleQuery:g,toggleStatus:u,tooltip:il.q,isInspectDisabled:r,headerFilters:i.a.createElement(V.EuiFlexGroup,null,i.a.createElement(V.EuiFlexItem,null,i.a.createElement(bl.a,{interval:k,onChange:S})),i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(gl.a,{title:il.l,onSelect:E,selectedJobIds:h,jobIds:b})))}),u&&i.a.createElement(ul.a,{"data-test-subj":"host-anomalies-table",columns:T,items:w,pagination:I,sorting:fl}),(j||f)&&i.a.createElement(ji.a,{"data-test-subj":"anomalies-host-table-loading-panel",overlay:!0,size:"xl"})):null},hl=i.a.memo(yl);var El=a(578),vl=a(812),xl=a(326),kl=a(197);const Sl=z.i18n.translate("xpack.securitySolution.authenticationsTable.authentications",{defaultMessage:"Authentications"}),jl=e=>z.i18n.translate("xpack.securitySolution.authenticationsTable.usersUnit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {user} other {users}}"}),Ol=e=>z.i18n.translate("xpack.securitySolution.authenticationsTable.hostsUnit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {host} other {hosts}}"}),wl=z.i18n.translate("xpack.securitySolution.authenticationsTable.lastSuccessfulSource",{defaultMessage:"Last successful source"}),Tl=z.i18n.translate("xpack.securitySolution.authenticationsTable.lastSuccessfulDestination",{defaultMessage:"Last successful destination"}),Il=z.i18n.translate("xpack.securitySolution.authenticationsTable.lastSuccessfulTime",{defaultMessage:"Last success"}),Cl=z.i18n.translate("xpack.securitySolution.authenticationsTable.lastFailedSource",{defaultMessage:"Last failed source"}),Ml=z.i18n.translate("xpack.securitySolution.authenticationsTable.lastFailedDestination",{defaultMessage:"Last failed destination"}),Fl=z.i18n.translate("xpack.securitySolution.authenticationsTable.lastFailedTime",{defaultMessage:"Last failure"}),Dl=z.i18n.translate("xpack.securitySolution.authenticationsTable.successes",{defaultMessage:"Successes"}),Al=z.i18n.translate("xpack.securitySolution.authenticationsTable.failures",{defaultMessage:"Failures"}),_l=z.i18n.translate("xpack.securitySolution.authenticationsTable.user",{defaultMessage:"User"}),Nl=z.i18n.translate("xpack.securitySolution.authenticationsTable.host",{defaultMessage:"Host"}),Rl=z.i18n.translate("xpack.securitySolution.authenticationsTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),Pl=z.i18n.translate("xpack.securitySolution.authenticationsTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),Ll=z.i18n.translate("xpack.securitySolution.hosts.navigation.authenticationsTitle",{defaultMessage:"Authentications"}),Bl=z.i18n.translate("xpack.securitySolution.hosts.navigaton.matrixHistogram.errorFetchingAuthenticationsData",{defaultMessage:"Failed to query authentications data"});var ql=a(194);const zl={title:"Authentication",description:"",visualizationType:"lnsXY",state:{visualization:{title:"Empty XY chart",legend:{isVisible:!0,position:"right"},valueLabels:"hide",preferredSeriesType:"bar_stacked",layers:[{layerId:"3fd0c5d5-f762-4a27-8c56-14eee0223e13",accessors:["5417777d-d9d9-4268-9cdc-eb29b873bd65"],position:"top",seriesType:"bar_stacked",showGridlines:!1,layerType:"data",xAccessor:"b41a2958-650b-470a-84c4-c6fd8f0c6d37",yConfig:[{forAccessor:"5417777d-d9d9-4268-9cdc-eb29b873bd65",color:"#54b399"}]},{layerId:"bef502be-e5ff-442f-9e3e-229f86ca2afa",seriesType:"bar_stacked",accessors:["a3bf9dc1-c8d2-42d6-9e60-31892a4c509e"],layerType:"data",xAccessor:"cded27f7-8ef8-458c-8d9b-70db48ae340d",yConfig:[{forAccessor:"a3bf9dc1-c8d2-42d6-9e60-31892a4c509e",color:"#da8b45"}]}],yRightExtent:{mode:"full"},yLeftExtent:{mode:"full"},axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!0}},query:{query:"",language:"kuery"},filters:[{meta:{index:"6f4dbdc7-35b6-4e20-ac53-1272167e3919",type:"custom",disabled:!1,negate:!1,alias:null,key:"query",value:'{"bool":{"must":[{"term":{"event.category":"authentication"}}]}}'},$state:{store:"appState"},query:{bool:{must:[{term:{"event.category":"authentication"}}]}}}],datasourceStates:{formBased:{layers:{"3fd0c5d5-f762-4a27-8c56-14eee0223e13":{columns:{"b41a2958-650b-470a-84c4-c6fd8f0c6d37":{label:"@timestamp",dataType:"date",operationType:"date_histogram",sourceField:"@timestamp",isBucketed:!0,scale:"interval",params:{interval:"auto"}},"5417777d-d9d9-4268-9cdc-eb29b873bd65":{label:ql.e,dataType:"number",operationType:"count",isBucketed:!1,scale:"ratio",sourceField:"___records___",filter:{query:'event.outcome : "success"',language:"kuery"},customLabel:!0}},columnOrder:["b41a2958-650b-470a-84c4-c6fd8f0c6d37","5417777d-d9d9-4268-9cdc-eb29b873bd65"],incompleteColumns:{}},"bef502be-e5ff-442f-9e3e-229f86ca2afa":{columns:{"cded27f7-8ef8-458c-8d9b-70db48ae340d":{label:"@timestamp",dataType:"date",operationType:"date_histogram",sourceField:"@timestamp",isBucketed:!0,scale:"interval",params:{interval:"auto"}},"a3bf9dc1-c8d2-42d6-9e60-31892a4c509e":{label:ql.d,dataType:"number",operationType:"count",isBucketed:!1,scale:"ratio",sourceField:"___records___",filter:{query:'event.outcome : "failure"',language:"kuery"},customLabel:!0}},columnOrder:["cded27f7-8ef8-458c-8d9b-70db48ae340d","a3bf9dc1-c8d2-42d6-9e60-31892a4c509e"],incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-3fd0c5d5-f762-4a27-8c56-14eee0223e13"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-bef502be-e5ff-442f-9e3e-229f86ca2afa"},{type:"index-pattern",name:"6f4dbdc7-35b6-4e20-ac53-1272167e3919",id:"{dataViewId}"}]};var $l;const Vl=()=>[Xl,ec,Hl,Gl,Ql,Wl,Kl,Yl,Jl],Ul=[{text:Rl,numberOfRow:5},{text:Pl,numberOfRow:10}],Hl={name:Al,field:"node.failures",truncateText:!1,mobileOptions:{show:!0},width:"8%"},Gl={name:Il,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>{var t,a;return Object(v.has)("lastSuccess.timestamp",e)&&null!=(null===(t=e.lastSuccess)||void 0===t?void 0:t.timestamp)?i.a.createElement(xa.b,{value:null===(a=e.lastSuccess)||void 0===a?void 0:a.timestamp}):Object(Xn.d)()}},Ql={name:wl,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>{var t,a;return Object(rl.c)({rowItems:(null===(t=e.lastSuccess)||void 0===t||null===(a=t.source)||void 0===a?void 0:a.ip)||null,isAggregatable:!0,fieldType:"ip",attrName:"source.ip",idPrefix:`authentications-table-${e._id}-lastSuccessSource`,render:e=>i.a.createElement(be.h,{ip:e})})}},Wl={name:Tl,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>{var t,a,n;return Object(rl.c)({rowItems:null!==(t=null===(a=e.lastSuccess)||void 0===a||null===(n=a.host)||void 0===n?void 0:n.name)&&void 0!==t?t:null,isAggregatable:!0,fieldType:"keyword",attrName:"host.name",idPrefix:`authentications-table-${e._id}-lastSuccessfulDestination`,render:e=>i.a.createElement(be.d,{hostName:e})})}},Kl={name:Fl,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>{var t,a;return Object(v.has)("lastFailure.timestamp",e)&&null!=(null===(t=e.lastFailure)||void 0===t?void 0:t.timestamp)?i.a.createElement(xa.b,{value:null===(a=e.lastFailure)||void 0===a?void 0:a.timestamp}):Object(Xn.d)()}},Yl={name:Cl,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>{var t,a;return Object(rl.c)({rowItems:(null===(t=e.lastFailure)||void 0===t||null===(a=t.source)||void 0===a?void 0:a.ip)||null,isAggregatable:!0,fieldType:"ip",attrName:"source.ip",idPrefix:`authentications-table-${e._id}-lastFailureSource`,render:e=>i.a.createElement(be.h,{ip:e})})}},Jl={name:Ml,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>{var t,a;return Object(rl.c)({rowItems:(null===(t=e.lastFailure)||void 0===t||null===(a=t.host)||void 0===a?void 0:a.name)||null,attrName:"host.name",idPrefix:`authentications-table-${e._id}-lastFailureDestination`,render:e=>i.a.createElement(be.d,{hostName:e}),isAggregatable:!0,fieldType:"ip"})}},Xl={name:_l,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>Object(rl.c)({rowItems:e.stackedValue,attrName:"user.name",isAggregatable:!0,fieldType:"keyword",idPrefix:`authentications-table-${e._id}-userName`,render:e=>i.a.createElement(be.m,{userName:e})})},Zl={name:Nl,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>Object(rl.c)({rowItems:e.stackedValue,attrName:"host.name",isAggregatable:!0,fieldType:"keyword",idPrefix:`authentications-table-${e._id}-hostName`,render:e=>i.a.createElement(be.d,{hostName:e})})},ec={name:Dl,field:"node.successes",truncateText:!1,mobileOptions:{show:!0},width:"8%"},tc=[{text:"event.outcome",value:"event.outcome"}];var ac;let nc;!function(e){e.authenticationsSuccess="success",e.authenticationsFailure="failure"}(ac||(ac={})),function(e){e.authenticationsSuccess="#54B399",e.authenticationsFailure="#E7664C"}(nc||(nc={}));const ic={[ac.authenticationsSuccess]:{key:ac.authenticationsSuccess,value:null,color:nc.authenticationsSuccess},[ac.authenticationsFailure]:{key:ac.authenticationsFailure,value:null,color:nc.authenticationsFailure}},rc={defaultStackByOption:null!==($l=tc.find((e=>"event.outcome"===e.text)))&&void 0!==$l?$l:tc[0],errorMessage:Bl,histogramType:Jn.l.authentications,mapping:ic,stackByOptions:tc,title:Ll,lensAttributes:zl};var sc=a(92),oc=a.n(sc),lc=a(376),cc=a(126),uc=a(215);const dc=z.i18n.translate("xpack.securitySolution.authentications.failSearchDescription",{defaultMessage:"Failed to run search on authentications"});var pc=a(130);const mc=({activePage:e,endDate:t,filterQuery:a,indexNames:i,limit:r,skip:s,stackByField:o,startDate:l})=>{const[c,u]=Object(n.useState)(null),d=Object(n.useCallback)((e=>{u((t=>t?{...t,pagination:Object(uc.a)(e,r)}:t))}),[r]),{loading:p,result:m,search:g,refetch:b,inspect:f}=Object(pc.a)({factoryQueryType:lc.y.authentications,initialResult:{edges:[],totalCount:-1,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1}},errorMessage:dc,abort:s}),y=Object(n.useMemo)((()=>({endDate:t,authentications:m.edges,inspect:f,isInspected:!1,loadPage:d,pageInfo:m.pageInfo,refetch:b,startDate:l,totalCount:m.totalCount})),[t,f,b,m.edges,m.pageInfo,m.totalCount,l,d]);return Object(n.useEffect)((()=>{u((n=>{const s={...null!=n?n:{},defaultIndex:i,factoryQueryType:lc.y.authentications,filterQuery:Object(cc.a)(a),stackByField:o,pagination:Object(uc.a)(e,r),timerange:{interval:"12h",from:l,to:t},sort:{}};return oc()(n,s)?n:s}))}),[e,t,a,i,o,r,l]),Object(n.useEffect)((()=>{!s&&c&&g(c)}),[c,g,s]),[p,y]},gc="authenticationsHostsTableQuery",bc=Es.b.HostsTableType.authentications,fc=({endDate:e,filterQuery:t,indexNames:a,skip:r,startDate:s,type:l,setQuery:c,deleteQuery:u})=>{const d=Object(o.useDispatch)(),{toggleStatus:p}=Object(Ht.a)(gc),[m,g]=Object(n.useState)(r||!p);Object(n.useEffect)((()=>{g(r||!p)}),[r,p]);const b=Es.d.authenticationsSelector(),{activePage:f,limit:y}=Object(x.a)((e=>b(e,l))),[h,{authentications:E,totalCount:k,pageInfo:S,loadPage:j,inspect:O,isInspected:w,refetch:T}]=mc({endDate:e,filterQuery:t,indexNames:a,skip:m,startDate:s,stackByField:Jn.a.userName,activePage:f,limit:y}),I=l===Es.b.HostsType.details?[Xl,ec,Hl,Gl,Ql,Kl,Yl]:Vl(),C=Object(n.useCallback)((e=>d(Es.a.updateTableLimit({hostsType:l,limit:e,tableType:bc}))),[l,d]),M=Object(n.useCallback)((e=>d(Es.a.updateTableActivePage({activePage:e,hostsType:l,tableType:bc}))),[l,d]);return Object(As.b)({queryId:gc,loading:h,refetch:T,setQuery:c,deleteQuery:u,inspect:O}),i.a.createElement(kl.a,{activePage:f,columns:I,dataTestSubj:"authentications-host-table",headerCount:k,headerTitle:Sl,headerUnit:jl(k),id:gc,isInspect:w,itemsPerRow:Ul,limit:y,loading:h,loadPage:j,pageOfItems:E,setQuerySkip:g,showMorePagesIndicator:Object(v.getOr)(!1,"showMorePagesIndicator",S),totalCount:Object(v.getOr)(50,"fakeTotalCount",S),updateLimitPagination:C,updateActivePage:M})};fc.displayName="AuthenticationsHostTableComponent";const yc=i.a.memo(fc),hc=({deleteQuery:e,endDate:t,filterQuery:a,indexNames:n,skip:r,setQuery:s,startDate:o,type:l})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(xl.a,lr()({endDate:t,filterQuery:a,id:"authenticationsHistogramQuery",indexNames:n,setQuery:s,startDate:o},rc)),i.a.createElement(yc,{endDate:t,filterQuery:a,indexNames:n,setQuery:s,deleteQuery:e,startDate:o,type:l,skip:r}));hc.displayName="AuthenticationsQueryTabBodyComponent";const Ec=i.a.memo(hc);Ec.displayName="AuthenticationsQueryTabBody";const vc=z.i18n.translate("xpack.securitySolution.allHost.failSearchDescription",{defaultMessage:"Failed to run search on all hosts"}),xc="hostsAllQuery";var kc=a(133),Sc=a(106),jc=a(150);const Oc=z.i18n.translate("xpack.securitySolution.hostsTable.hostsTitle",{defaultMessage:"All hosts"}),wc=e=>z.i18n.translate("xpack.securitySolution.hostsTable.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {host} other {hosts}}"}),Tc=(z.i18n.translate("xpack.securitySolution.hostsRiskTable.tableTitle",{defaultMessage:"Host risk"}),z.i18n.translate("xpack.securitySolution.hostsTable.nameTitle",{defaultMessage:"Host name"})),Ic=z.i18n.translate("xpack.securitySolution.hostsTable.lastSeenTitle",{defaultMessage:"Last seen"}),Cc=z.i18n.translate("xpack.securitySolution.hostsTable.firstLastSeenToolTip",{defaultMessage:"Relative to the selected date range"}),Mc=z.i18n.translate("xpack.securitySolution.hostsTable.hostRiskToolTip",{defaultMessage:"Host risk classification is determined by host risk score. Hosts classified as Critical or High are indicated as risky."}),Fc=z.i18n.translate("xpack.securitySolution.hostsTable.osLastSeenToolTip",{defaultMessage:"Last observed operating system"}),Dc=z.i18n.translate("xpack.securitySolution.hostsTable.osTitle",{defaultMessage:"Operating system"}),Ac=z.i18n.translate("xpack.securitySolution.hostsTable.versionTitle",{defaultMessage:"Version"}),_c=z.i18n.translate("xpack.securitySolution.hostsTable.hostRiskTitle",{defaultMessage:"Host risk classification"}),Nc=z.i18n.translate("xpack.securitySolution.hostsTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),Rc=z.i18n.translate("xpack.securitySolution.hostsTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),Pc=z.i18n.translate("xpack.securitySolution.hostsRiskTable.hostNameTitle",{defaultMessage:"Host Name"}),Lc=z.i18n.translate("xpack.securitySolution.hostsRiskTable.hostRiskScoreTitle",{defaultMessage:"Host risk score"}),Bc=z.i18n.translate("xpack.securitySolution.hostsRiskTable.riskTitle",{defaultMessage:"Host risk classification"}),qc=z.i18n.translate("xpack.securitySolution.hostsRiskTable.hostRiskToolTip",{defaultMessage:"Host risk classification is determined by host risk score. Hosts classified as Critical or High are indicated as risky."}),zc=z.i18n.translate("xpack.securitySolution.hostsRiskTable.hostRiskTitle",{defaultMessage:"Host risk"}),$c=z.i18n.translate("xpack.securitySolution.hostsRiskTable.hostsTableTooltip",{defaultMessage:"The host risk table is not affected by the KQL time range. This table shows the latest recorded risk score for each host."}),Vc=e=>z.i18n.translate("xpack.securitySolution.hostsRiskTable.filteredHostsTitle",{values:{severity:e},defaultMessage:"View {severity} risk hosts"});var Uc=a(582),Hc=a(240);const Gc=Es.b.HostsTableType.hosts,Qc=[{text:Nc,numberOfRow:5},{text:Rc,numberOfRow:10}],Wc=({data:e,fakeTotalCount:t,id:a,isInspect:r,loading:l,loadPage:c,setQuerySkip:u,showMorePagesIndicator:d,totalCount:p,type:m})=>{const g=Object(o.useDispatch)(),{navigateTo:b}=Object(Hc.i)(),f=Object(n.useMemo)((()=>Es.d.hostsSelector()),[]),{activePage:y,direction:h,limit:E,sortField:v}=Object(x.a)((e=>f(e,m))),k=Object(n.useCallback)((e=>g(Es.a.updateTableLimit({hostsType:m,limit:e,tableType:Gc}))),[m,g]),S=Object(n.useCallback)((e=>g(Es.a.updateTableActivePage({activePage:e,hostsType:m,tableType:Gc}))),[m,g]),j=Object(n.useCallback)((e=>{if(null!=e.sort){const t={field:Kc(e.sort.field),direction:e.sort.direction};t.direction===h&&t.field===v||g(Es.a.updateHostsSort({sort:t,hostsType:m}))}}),[h,v,m,g]),O=Object(ar.a)().isPlatinumOrTrialLicense,w=Object(n.useCallback)((e=>{g(Es.a.updateHostRiskScoreSeverityFilter({severitySelection:[e],hostsType:m})),b({deepLinkId:s.uc.hosts,path:tl.HostsTableType.risk})}),[g,b,m]),T=Object(n.useMemo)((()=>((e,t)=>{const a=[{field:"node.host.name",name:Tc,truncateText:!1,mobileOptions:{show:!0},sortable:!0,render:e=>{if(null!=e&&e.length>0){const t=Object(nt.h)(`hosts-table-hostName-${e[0]}`);return i.a.createElement(kc.b,{key:t,dataProvider:{and:[],enabled:!0,excluded:!1,id:t,name:e[0],kqlQuery:"",queryMatch:{field:"host.name",value:e[0],operator:Sc.d}},isAggregatable:!0,fieldType:"keyword",render:(t,a,n)=>n.isDragging?i.a.createElement(kc.a,null,i.a.createElement(jc.a,{dataProvider:t})):i.a.createElement(be.d,{hostName:e[0]})})}return Object(Xn.d)()},width:"35%"},{field:"node.lastSeen",name:i.a.createElement(V.EuiToolTip,{content:Cc},i.a.createElement(i.a.Fragment,null,Ic," ",i.a.createElement(V.EuiIcon,{color:"subdued",type:"iInCircle",className:"eui-alignTop"}))),truncateText:!1,mobileOptions:{show:!0},sortable:!0,render:e=>null!=e&&e.length>0?i.a.createElement(xa.b,{value:Array.isArray(e)?e[0]:e}):Object(Xn.d)()},{field:"node.host.os.name",name:i.a.createElement(V.EuiToolTip,{content:Fc},i.a.createElement(i.a.Fragment,null,Dc," ",i.a.createElement(V.EuiIcon,{color:"subdued",type:"iInCircle",className:"eui-alignTop"}))),truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:e=>null!=e?i.a.createElement(zt.b,{id:`host-page-draggable-host.os.name-${e[0]}`,field:"host.os.name",value:e[0],isDraggable:!1,hideTopN:!0,tooltipContent:null}):Object(Xn.d)()},{field:"node.host.os.version",name:Ac,truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:e=>null!=e?i.a.createElement(zt.b,{id:`host-page-draggable-host.os.version-${e[0]}`,field:"host.os.version",value:e[0],isDraggable:!1,hideTopN:!0,tooltipContent:null}):Object(Xn.d)()}];return e&&a.push({field:"node.risk",name:i.a.createElement(V.EuiToolTip,{content:Mc},i.a.createElement(i.a.Fragment,null,_c," ",i.a.createElement(V.EuiIcon,{color:"subdued",type:"iInCircle",className:"eui-alignTop"}))),truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:e=>null!=e?i.a.createElement(Zn.b,{toolTipContent:i.a.createElement(V.EuiLink,{onClick:()=>t(e)},i.a.createElement(V.EuiText,{size:"xs"},Vc(e.toLowerCase()))),severity:e}):Object(Xn.d)()}),a})(O,w)),[w,O]),I=Object(n.useMemo)((()=>((e,t)=>({field:Yc(e),direction:t}))(v,h)),[v,h]);return i.a.createElement(kl.a,{activePage:y,columns:T,dataTestSubj:`table-${Gc}`,headerCount:p,headerTitle:Oc,headerUnit:wc(p),id:a,isInspect:r,itemsPerRow:Qc,limit:E,loading:l,loadPage:c,onChange:j,pageOfItems:e,setQuerySkip:u,showMorePagesIndicator:d,sorting:I,totalCount:t,updateLimitPagination:k,updateActivePage:S})};Wc.displayName="HostsTableComponent";const Kc=e=>"node.host.name"===e?Uc.b.hostName:Uc.b.lastSeen,Yc=e=>{switch(e){case Uc.b.hostName:return"node.host.name";case Uc.b.lastSeen:return"node.lastSeen"}},Jc=i.a.memo(Wc);Jc.displayName="HostsTable";const Xc=Object(As.a)(Jc),Zc=({deleteQuery:e,endDate:t,filterQuery:a,indexNames:r,skip:s,setQuery:o,startDate:l,type:c})=>{const{toggleStatus:u}=Object(Ht.a)(xc),[d,p]=Object(n.useState)(s||!u);Object(n.useEffect)((()=>{p(s||!u)}),[s,u]);const[m,{hosts:g,totalCount:b,pageInfo:f,loadPage:y,id:h,inspect:E,isInspected:k,refetch:S}]=(({endDate:e,filterQuery:t,indexNames:a,skip:i=!1,startDate:r,type:s})=>{const o=Object(n.useMemo)((()=>Es.d.hostsSelector()),[]),{activePage:l,direction:c,limit:u,sortField:d}=Object(x.a)((e=>o(e,s))),[p,m]=Object(n.useState)(null),g=Object(n.useCallback)((e=>{m((t=>t?{...t,pagination:Object(uc.a)(e,u)}:t))}),[u]),{loading:b,result:f,search:y,refetch:h,inspect:E}=Object(pc.a)({factoryQueryType:Jn.j.hosts,initialResult:{edges:[],totalCount:-1,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1}},errorMessage:vc,abort:i}),v=Object(n.useMemo)((()=>({endDate:e,hosts:f.edges,id:xc,inspect:E,isInspected:!1,loadPage:g,pageInfo:f.pageInfo,refetch:h,startDate:r,totalCount:f.totalCount})),[e,E,h,f.edges,f.pageInfo,f.totalCount,r,g]);return Object(n.useEffect)((()=>{m((n=>{const i={...null!=n?n:{},defaultIndex:a,factoryQueryType:Jn.j.hosts,filterQuery:Object(cc.a)(t),pagination:Object(uc.a)(l,u),timerange:{interval:"12h",from:r,to:e},sort:{direction:c,field:d}};return oc()(n,i)?n:i}))}),[l,c,e,t,a,u,r,d]),Object(n.useEffect)((()=>{!i&&p&&y(p)}),[p,y,i]),[b,v]})({endDate:t,filterQuery:a,indexNames:r,skip:d,startDate:l,type:c});return i.a.createElement(Xc,{deleteQuery:e,data:g,fakeTotalCount:Object(v.getOr)(50,"fakeTotalCount",f),id:h,inspect:E,isInspect:k,loading:m,loadPage:y,refetch:S,setQuery:o,setQuerySkip:p,showMorePagesIndicator:Object(v.getOr)(!1,"showMorePagesIndicator",f),totalCount:b,type:c})};Zc.displayName="HostsQueryTabBody";const eu=z.i18n.translate("xpack.securitySolution.uncommonProcesses.failSearchDescription",{defaultMessage:"Failed to run search on uncommon processes"}),tu="hostsUncommonProcessesQuery",au=z.i18n.translate("xpack.securitySolution.authenticationsTable.uncommonProcessTable",{defaultMessage:"Uncommon processes"}),nu=e=>z.i18n.translate("xpack.securitySolution.uncommonProcessTable.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {process} other {processes}}"}),iu=z.i18n.translate("xpack.securitySolution.uncommonProcessTable.hostsTitle",{defaultMessage:"Host names"}),ru=z.i18n.translate("xpack.securitySolution.uncommonProcessTable.numberOfHostsTitle",{defaultMessage:"Hosts"}),su=z.i18n.translate("xpack.securitySolution.uncommonProcessTable.numberOfInstances",{defaultMessage:"Instances"}),ou=z.i18n.translate("xpack.securitySolution.uncommonProcessTable.lastCommandTitle",{defaultMessage:"Last command"}),lu=z.i18n.translate("xpack.securitySolution.uncommonProcessTable.lastUserTitle",{defaultMessage:"Last user"}),cu=z.i18n.translate("xpack.securitySolution.uncommonProcessTable.nameTitle",{defaultMessage:"Process name"}),uu=z.i18n.translate("xpack.securitySolution.uncommonProcessTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),du=z.i18n.translate("xpack.securitySolution.uncommonProcessTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),pu=Es.b.HostsTableType.uncommonProcesses,mu=[{text:uu,numberOfRow:5},{text:du,numberOfRow:10}],gu=i.a.memo((({data:e,fakeTotalCount:t,id:a,isInspect:r,loading:s,loadPage:l,totalCount:c,setQuerySkip:u,showMorePagesIndicator:d,type:p})=>{const m=Object(o.useDispatch)(),g=Object(n.useMemo)((()=>Es.d.uncommonProcessesSelector()),[]),{activePage:b,limit:f}=Object(x.a)((e=>g(e,p))),y=Object(n.useCallback)((e=>m(Es.a.updateTableLimit({hostsType:p,limit:e,tableType:pu}))),[p,m]),h=Object(n.useCallback)((e=>m(Es.a.updateTableActivePage({activePage:e,hostsType:p,tableType:pu}))),[p,m]),E=Object(n.useMemo)((()=>fu(p)),[p]);return i.a.createElement(kl.a,{activePage:b,columns:E,dataTestSubj:`table-${pu}`,headerCount:c,headerTitle:au,headerUnit:nu(c),id:a,isInspect:r,itemsPerRow:mu,limit:f,loading:s,loadPage:l,pageOfItems:e,setQuerySkip:u,showMorePagesIndicator:d,totalCount:t,updateLimitPagination:y,updateActivePage:h})}));gu.displayName="UncommonProcessTableComponent";const bu=i.a.memo(gu);bu.displayName="UncommonProcessTable";const fu=e=>{const t=[{name:cu,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>Object(rl.c)({rowItems:e.process.name,attrName:"process.name",idPrefix:`uncommon-process-table-${e._id}-processName`,isAggregatable:!0,fieldType:"keyword"}),width:"20%"},{align:"right",name:ru,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>i.a.createElement(i.a.Fragment,null,null!=e.hosts?e.hosts.length:Object(Xn.e)()),width:"8%"},{align:"right",name:su,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>Object(Xn.a)(e.instances),width:"8%"},{name:iu,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>{return Object(rl.c)({rowItems:(t=e.hosts,null!=t?t.filter((e=>null!=e.name&&null!=e.name[0])).map((e=>null!=e.name&&null!=e.name[0]?e.name[0]:"")):[]),attrName:"host.name",idPrefix:`uncommon-process-table-${e._id}-processHost`,render:e=>i.a.createElement(be.d,{hostName:e}),isAggregatable:!0,fieldType:"keyword"});var t},width:"25%"},{name:ou,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>Object(rl.c)({rowItems:null!=e.process?e.process.args:null,attrName:"process.args",idPrefix:`uncommon-process-table-${e._id}-processArgs`,displayCount:1,isAggregatable:!0,fieldType:"keyword"}),width:"25%"},{name:lu,truncateText:!1,mobileOptions:{show:!0},render:({node:e})=>Object(rl.c)({rowItems:null!=e.user?e.user.name:null,attrName:"user.name",idPrefix:`uncommon-process-table-${e._id}-processUser`,isAggregatable:!0,fieldType:"keyword"})}];return e===tl.HostsType.details?[iu,ru].reduce(((e,t)=>(e.splice(e.findIndex((e=>e.name===t)),1),e)),t):t},yu=Object(As.a)(bu),hu=({deleteQuery:e,endDate:t,filterQuery:a,indexNames:r,skip:s,setQuery:o,startDate:l,type:c})=>{const{toggleStatus:u}=Object(Ht.a)(tu),[d,p]=Object(n.useState)(s||!u);Object(n.useEffect)((()=>{p(s||!u)}),[s,u]);const[m,{uncommonProcesses:g,totalCount:b,pageInfo:f,loadPage:y,id:h,inspect:E,isInspected:k,refetch:S}]=(({endDate:e,filterQuery:t,indexNames:a,skip:i=!1,startDate:r,type:s})=>{const o=Object(n.useMemo)((()=>Es.d.uncommonProcessesSelector()),[]),{activePage:l,limit:c}=Object(x.a)((e=>o(e,s))),[u,d]=Object(n.useState)(null),p=Object(n.useCallback)((e=>{d((t=>t?{...t,pagination:Object(uc.a)(e,c)}:t))}),[c]),{loading:m,result:g,search:b,refetch:f,inspect:y}=Object(pc.a)({factoryQueryType:Jn.j.uncommonProcesses,initialResult:{edges:[],totalCount:-1,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1}},errorMessage:eu,abort:i}),h=Object(n.useMemo)((()=>({id:tu,inspect:y,isInspected:!1,loadPage:p,pageInfo:g.pageInfo,refetch:f,totalCount:g.totalCount,uncommonProcesses:g.edges})),[y,f,g.edges,g.pageInfo,g.totalCount,p]);return Object(n.useEffect)((()=>{d((n=>{const i={...null!=n?n:{},defaultIndex:a,factoryQueryType:Jn.j.uncommonProcesses,filterQuery:Object(cc.a)(t),pagination:Object(uc.a)(l,c),timerange:{interval:"12h",from:r,to:e},sort:{}};return oc()(n,i)?n:i}))}),[l,a,e,t,c,r]),Object(n.useEffect)((()=>{!i&&u&&b(u)}),[b,i,u]),[m,h]})({endDate:t,filterQuery:a,indexNames:r,skip:d,startDate:l,type:c});return i.a.createElement(yu,{deleteQuery:e,data:g,fakeTotalCount:Object(v.getOr)(50,"fakeTotalCount",f),id:h,inspect:E,isInspect:k,loading:m,loadPage:y,refetch:S,setQuery:o,setQuerySkip:p,showMorePagesIndicator:Object(v.getOr)(!1,"showMorePagesIndicator",f),totalCount:b,type:c})};hu.dispalyName="UncommonProcessQueryTabBody";const Eu=i.a.memo((({severityCount:e})=>i.a.createElement(V.EuiFlexGroup,{justifyContent:"spaceBetween",gutterSize:"m","data-test-subj":"risk-score-severity-badges"},i.a.createElement(V.EuiFlexItem,{grow:!1}),i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiFlexGroup,{gutterSize:"m"},Object.keys(Zn.a).map((t=>i.a.createElement(V.EuiFlexItem,{key:t,grow:!1},i.a.createElement(vu,{status:t,count:e[t]||0})))))))));Eu.displayName="SeverityBadges";const vu=i.a.memo((({status:e,count:t})=>i.a.createElement(V.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(Zn.b,{severity:e})),i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiNotificationBadge,{size:"s",color:"subdued"},t)))));vu.displayName="SeverityBadge";const xu=H()(V.EuiColorPaletteDisplay).withConfig({displayName:"StyledEuiColorPaletteDisplay",componentId:"sc-s3n26r-0"})(["&.risk-score-severity-bar{border:none;border-radius:0;&:after{border:none;}}"]),ku=({severityCount:e})=>{const t=Object(n.useMemo)((()=>Object.keys(Zn.a).reduce(((t,a)=>{const n={stop:(t.length>0?t[t.length-1].stop:0)+(e[a]||0),color:Zn.a[a]};return t.push(n),t}),[])),[e]);return i.a.createElement(xu,{className:"risk-score-severity-bar","data-test-subj":"risk-score-severity-bar",size:"s",palette:t})},Su=({severityCount:e,selectedSeverities:t,onSelect:a,title:r})=>{const[s,o]=Object(n.useState)(!1),l=Object(n.useCallback)((()=>{o(!s)}),[s]),c=Object(n.useCallback)((()=>{o(!1)}),[]),u=Object(V.useGeneratedHtmlId)({prefix:"filterGroupPopover"}),d=Object(n.useMemo)((()=>Jn.y.map((a=>({risk:a,count:e[a],checked:t.includes(a)?"on":void 0})))),[e,t]),p=Object(n.useCallback)((e=>{const n=null!=t?t:[],i=n.includes(e)?n.filter((t=>t!==e)):[...n,e];a(i)}),[t,a]),m=Object(n.useMemo)((()=>d.reduce(((e,t)=>"on"===t.checked?e+t.count:e),0)),[d]),g=Object(n.useMemo)((()=>i.a.createElement(V.EuiFilterButton,{"data-test-subj":"risk-filter-button",hasActiveFilters:!!d.find((e=>"on"===e.checked)),iconType:"arrowDown",isSelected:s,numActiveFilters:m,onClick:l},r)),[s,d,l,m,r]);return i.a.createElement(V.EuiFilterGroup,null,i.a.createElement(V.EuiPopover,{id:u,button:g,isOpen:s,closePopover:c,panelPaddingSize:"none"},i.a.createElement("div",{className:"euiFilterSelect__items"},d.map(((e,t)=>i.a.createElement(V.EuiFilterSelectItem,{"data-test-subj":`risk-filter-item-${e.risk}`,checked:e.checked,key:t+e.risk,onClick:()=>p(e.risk)},i.a.createElement(Zn.b,{severity:e.risk})))))))},ju=[{text:Nc,numberOfRow:5},{text:Rc,numberOfRow:10}],Ou=Es.b.HostsTableType.risk,wu=({data:e,id:t,isInspect:a,loading:r,loadPage:s,setQuerySkip:l,severityCount:c,totalCount:u,type:d})=>{const p=Object(o.useDispatch)(),m=Object(n.useMemo)((()=>Es.d.hostRiskScoreSelector()),[]),{activePage:g,limit:b,sort:f}=Object(x.a)((e=>m(e,Es.b.HostsType.page))),y=Object(n.useCallback)((e=>p(Es.a.updateTableLimit({hostsType:d,limit:e,tableType:Ou}))),[d,p]),h=Object(n.useCallback)((e=>p(Es.a.updateTableActivePage({activePage:e,hostsType:d,tableType:Ou}))),[d,p]),E=Object(n.useCallback)((e=>{if(null!=e.sort){const t=e.sort;t.direction===f.direction&&t.field===f.field||p(Es.a.updateHostRiskScoreSort({sort:t,hostsType:d}))}}),[p,f,d]),v=Object(n.useCallback)((e=>{p(Es.a.updateHostRiskScoreSeverityFilter({severitySelection:[e],hostsType:d}))}),[p,d]),k=Object(n.useMemo)((()=>(({dispatchSeverityUpdate:e})=>[{field:"host.name",name:Pc,truncateText:!1,mobileOptions:{show:!0},sortable:!0,render:e=>{if(null!=e&&e.length>0){const t=Object(nt.h)(`host-risk-score-table-hostName-${e}`);return i.a.createElement(kc.b,{key:t,dataProvider:{and:[],enabled:!0,excluded:!1,id:t,name:e,kqlQuery:"",queryMatch:{field:"host.name",value:e,operator:Sc.d}},isAggregatable:!0,fieldType:"keyword",render:(t,a,n)=>n.isDragging?i.a.createElement(kc.a,null,i.a.createElement(jc.a,{dataProvider:t})):i.a.createElement(be.d,{hostName:e,hostTab:tl.HostsTableType.risk})})}return Object(Xn.d)()}},{field:Jn.w.hostRiskScore,name:Lc,truncateText:!0,mobileOptions:{show:!0},sortable:!0,render:e=>null!=e?i.a.createElement("span",{"data-test-subj":"risk-score-truncate",title:`${e}`},Math.round(e)):Object(Xn.d)()},{field:Jn.w.hostRisk,name:i.a.createElement(V.EuiToolTip,{content:qc},i.a.createElement(i.a.Fragment,null,Bc," ",i.a.createElement(V.EuiIcon,{color:"subdued",type:"iInCircle",className:"eui-alignTop"}))),truncateText:!1,mobileOptions:{show:!0},sortable:!0,render:t=>null!=t?i.a.createElement(Zn.b,{toolTipContent:i.a.createElement(V.EuiLink,{onClick:()=>e(t)},i.a.createElement(V.EuiText,{size:"xs"},Vc(t.toLowerCase()))),severity:t}):Object(Xn.d)()}])({dispatchSeverityUpdate:v})),[v]),S=i.a.createElement(V.EuiFlexGroup,{direction:"column",gutterSize:"s"},i.a.createElement(V.EuiFlexItem,null,i.a.createElement(Eu,{severityCount:c})),i.a.createElement(V.EuiFlexItem,null,i.a.createElement(ku,{severityCount:c}))),j=Object(n.useMemo)((()=>Es.d.hostRiskScoreSeverityFilterSelector()),[]),O=Object(x.a)((e=>j(e,d))),w=Object(n.useCallback)((e=>{p(Es.a.updateHostRiskScoreSeverityFilter({severitySelection:e,hostsType:d}))}),[p,d]);return i.a.createElement(kl.a,{activePage:g,columns:k,dataTestSubj:`table-${Ou}`,headerCount:u,headerFilters:i.a.createElement(Su,{selectedSeverities:O,severityCount:c,title:_c,onSelect:w}),headerSupplement:S,headerTitle:zc,headerUnit:wc(u),headerTooltip:$c,id:t,isInspect:a,itemsPerRow:ju,limit:b,loading:r,loadPage:s,onChange:E,pageOfItems:e,setQuerySkip:l,showMorePagesIndicator:!1,sorting:f,split:!0,stackHeader:!0,totalCount:u,updateLimitPagination:y,updateActivePage:h})};wu.displayName="HostRiskScoreTableComponent";const Tu=i.a.memo(wu);Tu.displayName="HostRiskScoreTable";const Iu=Object(As.a)(Tu),Cu=({deleteQuery:e,endDate:t,filterQuery:a,setQuery:r,skip:s,startDate:o,type:l})=>{const c=Object(n.useMemo)((()=>Es.d.hostRiskScoreSelector()),[]),{activePage:u,limit:d,sort:p}=Object(x.a)((e=>c(e,Es.b.HostsType.page))),m=Object(n.useMemo)((()=>Es.d.hostRiskScoreSeverityFilterSelector()),[]),g=Object(x.a)((e=>m(e,Es.b.HostsType.page))),b=Object(n.useMemo)((()=>({cursorStart:u*d,querySize:d})),[u,d]),{toggleStatus:f}=Object(Ht.a)(Yn.a.HOSTS_BY_RISK),[y,h]=Object(n.useState)(s||!f);Object(n.useEffect)((()=>{h(!f)}),[f]);const E=Object(n.useMemo)((()=>({from:o,to:t})),[o,t]),{data:k,inspect:S,isDeprecated:j,isInspected:O,isModuleEnabled:w,loading:T,refetch:I,totalCount:C}=Object(Yn.c)({filterQuery:a,pagination:b,riskEntity:Jn.v.host,skip:y,sort:p,timerange:E}),{severityCount:M,loading:F}=Object(Yn.d)({filterQuery:a,skip:y,riskEntity:Jn.v.host}),D={isDisabled:!w&&!T,isDeprecated:j&&!T};return D.isDisabled||D.isDeprecated?i.a.createElement(hs,lr()({},D,{entityType:Jn.v.host,refetch:I,timerange:E})):!T&&w&&0===g.length&&k&&0===k.length?i.a.createElement(Yo,{entityType:Jn.v.host,refetch:I}):i.a.createElement(Iu,{deleteQuery:e,data:null!=k?k:[],id:Yn.a.HOSTS_BY_RISK,inspect:S,isInspect:O,loading:T||F,loadPage:v.noop,refetch:I,setQuery:r,setQuerySkip:h,severityCount:null!=M?M:Jn.c,totalCount:C,type:l})};Cu.displayName="HostRiskScoreQueryTabBody";var Mu=a(73),Fu=a(568),Du=a(559),Au=a(158),_u=a(159);const Nu=z.i18n.translate("xpack.securitySolution.sessionsView.sessionsTitle",{defaultMessage:"Sessions"}),Ru=z.i18n.translate("xpack.securitySolution.sessionsView.totalCountOfSessions",{defaultMessage:"sessions"}),Pu=z.i18n.translate("xpack.securitySolution.sessionsView.singleCountOfSessions",{defaultMessage:"session"}),Lu=z.i18n.translate("xpack.securitySolution.sessionsView.columnSessionStart",{defaultMessage:"Started"}),Bu=z.i18n.translate("xpack.securitySolution.sessionsView.columnExecutable",{defaultMessage:"Executable"}),qu=z.i18n.translate("xpack.securitySolution.sessionsView.columnEntryUser",{defaultMessage:"User"}),zu=z.i18n.translate("xpack.securitySolution.sessionsView.columnInteractive",{defaultMessage:"Interactive"}),$u=z.i18n.translate("xpack.securitySolution.sessionsView.columnHostName",{defaultMessage:"Hostname"}),Vu=z.i18n.translate("xpack.securitySolution.sessionsView.columnEntryType",{defaultMessage:"Type"}),Uu=z.i18n.translate("xpack.securitySolution.sessionsView.columnEntrySourceIp",{defaultMessage:"Source IP"}),Hu=[{columnHeaderType:Au.a,id:"process.entry_leader.start",initialWidth:_u.b,display:Lu},{columnHeaderType:Au.a,id:"process.entry_leader.executable",display:Bu},{columnHeaderType:Au.a,id:"process.entry_leader.user.name",display:qu},{columnHeaderType:Au.a,id:"process.entry_leader.interactive",display:zu},{columnHeaderType:Au.a,id:"host.hostname",display:$u},{columnHeaderType:Au.a,id:"process.entry_leader.entry_meta.type",display:Vu},{id:"process.entry_leader.entry_meta.source.ip",columnHeaderType:Au.a,display:Uu}],Gu=(e,t)=>({...Q.a,columns:e,defaultColumns:t,sort:[{columnId:"process.entry_leader.start",columnType:"date",sortDirection:"desc"}]});var Qu=a(542),Wu=a(419),Ku=a(13),Yu=a(923);const Ju={query:{bool:{filter:[{bool:{should:[{term:{[ca.db]:Mu.EventAction.exec}},{term:{[ca.db]:Mu.EventAction.fork}},{term:{[ca.db]:Mu.EventAction.end}}]}},{bool:{filter:{exists:{field:Mu.ENTRY_SESSION_ENTITY_ID_PROPERTY}}}}]}},meta:{alias:null,disabled:!1,key:Mu.ENTRY_SESSION_ENTITY_ID_PROPERTY,negate:!1,params:{},type:"string"}},Xu=({tableId:e,endDate:t,entityType:a="sessions",pageFilters:r,startDate:s,filterQuery:l,columns:c=Hu,defaultColumns:d=Hu})=>{const p=Object(o.useDispatch)(),m=Object(B.a)("tGridEnabled"),g=Object(n.useMemo)((()=>l&&""!==l?JSON.parse(l):{}),[l]),f=Object(n.useMemo)((()=>[{...Ju,query:{...Ju.query,bool:{...Ju.query.bool,filter:Ju.query.bool.filter.concat(g)}}},...r]),[r,g]);Object(n.useEffect)((()=>{p(W.a.initializeTGridSettings({id:e,title:Nu,defaultColumns:Yu.a.columns.map((e=>m||null!=e.initialWidth?e:{...e,initialWidth:_u.a})),showCheckboxes:!0,selectAll:!0}))}),[p,m,e]);const y=Object(Ku.b)().isEnterprise()||e===u.g.kubernetesPageSessions?5:4,h=Object(n.useMemo)((()=>Object(Wu.a)(y)),[y]),E=Object(Fu.a)({localFilters:f,tableId:e,from:s,to:t,scopeId:b.SourcererScopeName.default}),v=Object(n.useMemo)((()=>({alertStatusActions:!1,customBulkActions:[E]})),[E]);return i.a.createElement("div",{"data-test-subj":"security_solution:sessions_viewer:sessions_view"},i.a.createElement(Du.a,{pageFilters:f,defaultModel:Gu(c,d),end:t,bulkActions:v,entityType:a,tableId:e,leadingControlColumns:h,renderCellValue:Qu.a,rowRenderers:ja.b,scopeId:b.SourcererScopeName.default,start:s,unit:e=>e>1?Ru:Pu}))};Xu.displayName="SessionsViewComponent";const Zu=i.a.memo(Xu);var ed=a(304);const td=i.a.memo((e=>{const{pageFilters:t,filterQuery:a,...r}=e,s=Object(n.useMemo)((()=>null!=t?[...ed.e,...t]:ed.e),[t]);return Object(Ku.b)().isEnterprise()?i.a.createElement(Zu,lr()({entityType:"sessions",tableId:u.g.hostsPageSessions},r,{pageFilters:s,filterQuery:a})):null}));td.displayName="SessionsTabBody";const ad=i.a.memo((({detailName:e,filterQuery:t,indexNames:a,indexPattern:n,hostDetailsPagePath:r,hostDetailsFilter:s})=>{const{from:o,to:l,isInitializing:c,deleteQuery:u,setQuery:d}=Object(Y.a)(),p={deleteQuery:u,endDate:l,filterQuery:t,skip:c||void 0===t,setQuery:d,startDate:o,type:vl.b,indexPattern:n,indexNames:a,hostName:e};return i.a.createElement(P.Switch,null,i.a.createElement(L.Route,{path:`${r}/:tabName(${tl.HostsTableType.authentications})`},i.a.createElement(Ec,p)),i.a.createElement(L.Route,{path:`${r}/:tabName(${tl.HostsTableType.uncommonProcesses})`},i.a.createElement(hu,p)),i.a.createElement(L.Route,{path:`${r}/:tabName(${tl.HostsTableType.anomalies})`},i.a.createElement(al.a,lr()({},p,{AnomaliesTableComponent:hl}))),i.a.createElement(L.Route,{path:`${r}/:tabName(${tl.HostsTableType.events})`},i.a.createElement(El.a,lr()({additionalFilters:s,tableId:ua.c.hostsPageEvents},p))),i.a.createElement(L.Route,{path:`${r}/:tabName(${tl.HostsTableType.risk})`},i.a.createElement(el,lr()({},p,{riskEntity:Jn.v.host,entityName:p.hostName}))),i.a.createElement(L.Route,{path:`${r}/:tabName(${tl.HostsTableType.sessions})`},i.a.createElement(td,p)))}));ad.displayName="HostDetailsTabs";var nd=a(603),id=a(273);const rd=(e,t)=>`${s.Hb}/name/${e}/${t}`,sd=({hasMlUserPermissions:e,isRiskyHostsEnabled:t,hostName:a,isEnterprise:n})=>{const i=[],r={[tl.HostsTableType.authentications]:{id:tl.HostsTableType.authentications,name:nd.c,href:rd(a,tl.HostsTableType.authentications),disabled:!1},[tl.HostsTableType.uncommonProcesses]:{id:tl.HostsTableType.uncommonProcesses,name:nd.g,href:rd(a,tl.HostsTableType.uncommonProcesses),disabled:!1},[tl.HostsTableType.anomalies]:{id:tl.HostsTableType.anomalies,name:nd.b,href:rd(a,tl.HostsTableType.anomalies),disabled:!1},[tl.HostsTableType.events]:{id:tl.HostsTableType.events,name:nd.d,href:rd(a,tl.HostsTableType.events),disabled:!1},[tl.HostsTableType.risk]:{id:tl.HostsTableType.risk,name:nd.e,href:rd(a,tl.HostsTableType.risk),disabled:!1,isBeta:!0,betaOptions:{text:id.i}},[tl.HostsTableType.sessions]:{id:tl.HostsTableType.sessions,name:nd.f,href:rd(a,tl.HostsTableType.sessions),disabled:!1,isBeta:!1}};return e||i.push(tl.HostsTableType.anomalies),t||i.push(tl.HostsTableType.risk),n||i.push(tl.HostsTableType.sessions),Object(v.omit)(i,r)};var od=a(146),ld=a(920),cd=a(233),ud=a(837),dd=a(926),pd=a(116);const md=Object(n.memo)((({endpointId:e,onClick:t})=>{const{handleResponseActionsClick:a,isDisabled:n,tooltip:r}=Object(dd.a)({endpointId:e,onClick:t});if(!Object(pd.a)().endpointPrivileges.canAccessResponseConsole)return null;const s="endpointResponseActions-action-button";return i.a.createElement(V.EuiToolTip,{position:"top",content:r},i.a.createElement(V.EuiButton,{fill:!0,key:s,"data-test-subj":s,disabled:n,onClick:a},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.endpoint.detections.takeAction.responseActionConsole.buttonLabel",defaultMessage:"Respond"})))}));md.displayName="ResponderActionButton";const gd=Object(As.a)(ir.a),bd=({detailName:e,hostDetailsPagePath:t})=>{var a,r;const s=Object(o.useDispatch)(),l=Object(n.useMemo)((()=>W.b.getTableByIdSelector()),[]),c=Object(x.b)((e=>{var t;return(null!==(t=l(e,u.g.hostsPageEvents))&&void 0!==t?t:Q.a).graphEventId})),d=Object(n.useMemo)((()=>rr.d.globalFiltersQuerySelector()),[]),m=Object(n.useMemo)((()=>rr.d.globalQuerySelector()),[]),b=Object(x.a)(m),f=Object(x.a)(d),{to:h,from:S,deleteQuery:j,setQuery:O,isInitializing:w}=Object(Y.a)(),{globalFullScreen:T}=Object(fe.a)(),{signalIndexName:I}=Object(Ji.a)(),C=Object(ar.a)(),{services:{uiSettings:M}}=Object(p.k)(),F=Object(n.useMemo)((()=>{return[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:"host.name",value:t=e,params:{query:t}},query:{match:{"host.name":{query:t,type:"phrase"}}}}];var t}),[e]),D=Object(Ku.b)().isEnterprise(),A=Object(n.useCallback)(((e,t)=>{const a=Object(nr.a)(e,t);s(Object(te.setAbsoluteRangeDatePicker)({id:K.a.global,from:a.from,to:a.to}))}),[s]),{indexPattern:_,indicesExist:N,selectedPatterns:R}=Object(g.d)(),[P,{inspect:L,hostDetails:B,id:q,refetch:z}]=Object(ld.b)({endDate:h,startDate:S,hostName:e,indexNames:R,skip:0===R.length}),[$,U]=Object(n.useMemo)((()=>{try{return[Object(We.buildEsQuery)(_,[b],[...F,...f],Object(Ki.getEsQueryConfig)(M))]}catch(e){return[void 0,e]}}),[f,_,b,M,F]),H=JSON.stringify($);Object(cd.a)({id:ld.a,filterQuery:H,kqlError:U,query:b,startDate:S,endDate:h}),Object(n.useEffect)((()=>{s(Object(sr.setHostDetailsTablesActivePageToZero)())}),[s,e]);const G=Object(ar.a)().isPlatinumOrTrialLicense,{hasKibanaREAD:X,hasIndexRead:ee}=Object(oa.a)(),ae=X&&ee,ne=Object(n.useMemo)((()=>({field:"host.hostname",value:e})),[e]);return i.a.createElement(i.a.Fragment,null,N?i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiWindowEvent,{event:"resize",handler:v.noop}),i.a.createElement(J.a,{show:Object(he.n)({globalFullScreen:T,graphEventId:c})},i.a.createElement(Z.a,{indexPattern:_,id:K.a.global})),i.a.createElement(y.a,{noPadding:T,"data-test-subj":"hostDetailsPage"},i.a.createElement(ye.a,{show:!T},i.a.createElement(ta.a,{border:!0,subtitle:i.a.createElement(Xi.a,{indexKey:Jn.k.hostDetails,hostName:e,indexNames:R}),title:e,rightSideItems:[(null===(a=B.endpoint)||void 0===a?void 0:a.fleetAgentId)&&i.a.createElement(md,{endpointId:null===(r=B.endpoint)||void 0===r?void 0:r.fleetAgentId})]}),i.a.createElement(Zi.a,{criteriaFields:Object(er.a)(B),startDate:S,endDate:h,skip:w},(({isLoadingAnomaliesData:t,anomaliesData:a})=>i.a.createElement(gd,{id:q,isInDetailsSidePanel:!1,data:B,anomaliesData:a,isLoadingAnomaliesData:t,loading:P,startDate:S,endDate:h,narrowDateRange:A,setQuery:O,refetch:z,inspect:L,hostName:e,indexNames:R}))),i.a.createElement(V.EuiHorizontalRule,null),i.a.createElement(V.EuiSpacer,null),ae&&i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiFlexGroup,null,i.a.createElement(V.EuiFlexItem,null,i.a.createElement(Yi.a,{signalIndexName:I,entityFilter:ne,additionalFilters:$?[$]:[]})),i.a.createElement(V.EuiFlexItem,null,i.a.createElement(ud.a,{entityFilter:ne,signalIndexName:I,additionalFilters:$?[$]:[]}))),i.a.createElement(V.EuiSpacer,null)),i.a.createElement(ga.a,{navTabs:sd({hasMlUserPermissions:Object(tr.a)(C),isRiskyHostsEnabled:G,hostName:e,isEnterprise:D})}),i.a.createElement(V.EuiSpacer,null)),i.a.createElement(ad,{indexNames:R,isInitializing:w,deleteQuery:j,hostDetailsFilter:F,to:h,from:S,detailName:e,type:vl.b,setQuery:O,filterQuery:H,hostDetailsPagePath:t,indexPattern:_}))):i.a.createElement(aa.a,null),i.a.createElement(E.a,{pageName:k.a.hosts}))};bd.displayName="HostDetailsComponent";const fd=i.a.memo(bd);var yd=a(598),hd=a(18),Ed=a(54);const vd=e=>{try{return Object(Ed.decode)(e)}catch(e){return null}},xd=e=>Object(v.isObject)(e),kd=e=>Object(v.isString)(e),Sd=(e,t)=>t.reduce(((t,a,n)=>{const i=((e,t)=>1===e.length?`${e[0]}: "${t}"`:e.reduce(((e,a,n,i)=>0===n?`(${a}: "${t}"`:n===i.length-1?`${e} or ${a}: "${t}")`:`${e} or ${a}: "${t}"`),""))(e,a);return 0===n?i:`${t} or ${i}`}),""),jd=(e,t,a)=>{const n=vd(a);if(xd(n)){const a=n;if(xd(a)&&kd(a.query)){const i=Sd(e,t);return""!==a.query&&""!==i?a.query=`(${i}) and (${a.query})`:""===a.query&&""!==i&&(a.query=`(${i})`),Object(Ed.encode)(n)}}else if(null==n){const a=Sd(e,t);return Object(Ed.encode)({query:`(${a})`,language:"kuery"})}return a},Od=(e,t,a)=>`(${a.split(",").reduce(((e,a,n)=>0===n?`${t}: "${a}"`:`${e} or ${t}: "${a}"`),"")})`,wd=e=>{const t=vd(e);if(xd(t)){const e=t;if(xd(e)&&kd(e.query))return e.query=e.query.replace(/([\w\.\-\[\]]+)\s*:\s*"(([\w\.\-\(\)\[\]]+,[\w\.\-\(\)\[\]]+){1,})"/g,Od),Object(Ed.encode)(t)}return e},Td=["and","or","not"],Id=(e,...t)=>{if(null==t)return"";const a=t.reduce(((e,t)=>null!=t&&Td.includes(t)?[...e,t]:e),[]);return a.length>1?` ${a[a.length-1].trim()} `:""},Cd=e=>{const t=vd(e);if(xd(t)){const e=t;if(xd(e)&&kd(e.query))return e.query=e.query.replace(/(\s+)*(and|or|not){0,1}(\s+)*([\w\.\-\[\]]+)\s*:\s*"(\$[\w\.\-\(\)\[\]]+\$)"(\s+)*(and|or|not){0,1}(\s+)*/g,Id),Object(Ed.encode)(t)}return e},Md=e=>Object(v.flow)(wd,Cd)(e),Fd=e=>""===e.trim()||e.startsWith("$")&&e.endsWith("$"),Dd=e=>e.split(",").length>1,Ad=e=>e.split(","),_d=i.a.memo((()=>{const{path:e}=Object(P.useRouteMatch)();return i.a.createElement(P.Switch,null,i.a.createElement(L.Route,{strict:!0,exact:!0,path:e,render:({location:e})=>{const t=Object(yd.parse)(e.search.substring(1),{sort:!1});null!=t.query&&(t.query=Md(t.query));const a=Object(yd.stringify)(hd.url.encodeQuery(t),{sort:!1,encode:!1});return i.a.createElement(P.Redirect,{to:`${s.Hb}?${a}`})}}),i.a.createElement(L.Route,{path:`${e}/:hostName`,render:({location:e,match:{params:{hostName:t}}})=>{const a=Object(yd.parse)(e.search.substring(1),{sort:!1});if(null!=a.query&&(a.query=Md(a.query)),Fd(t)){const e=Object(yd.stringify)(hd.url.encodeQuery(a),{sort:!1,encode:!1});return i.a.createElement(P.Redirect,{to:`${s.Hb}/${tl.HostsTableType.anomalies}?${e}`})}if(Dd(t)){const e=Ad(t);a.query=jd(["host.name"],e,a.query||"");const n=Object(yd.stringify)(hd.url.encodeQuery(a),{sort:!1,encode:!1});return i.a.createElement(P.Redirect,{to:`${s.Hb}/${tl.HostsTableType.anomalies}?${n}`})}{const e=Object(yd.stringify)(hd.url.encodeQuery(a),{sort:!1,encode:!1});return i.a.createElement(P.Redirect,{to:`${s.Hb}/name/${t}/${tl.HostsTableType.anomalies}?${e}`})}}}),i.a.createElement(L.Route,{path:`${s.Hb}/ml-hosts/`,render:({location:{search:e=""}})=>i.a.createElement(P.Redirect,{from:`${s.Hb}/ml-hosts/`,to:`${s.Hb}/ml-hosts${e}`})}))}));_d.displayName="MlHostConditionalContainer";const Nd={description:"",state:{datasourceStates:{formBased:{layers:{"416b6fad-1923-4f6a-a2df-b223bb287e30":{columnOrder:["5eea817b-67b7-4268-8ecb-7688d1094721","b00c65ea-32be-4163-bfc8-f795b1ef9d06"],columns:{"5eea817b-67b7-4268-8ecb-7688d1094721":{dataType:"date",isBucketed:!0,label:"@timestamp",operationType:"date_histogram",params:{interval:"auto"},scale:"interval",sourceField:"@timestamp"},"b00c65ea-32be-4163-bfc8-f795b1ef9d06":{customLabel:!0,dataType:"number",isBucketed:!1,label:Object(ql.o)("host.name"),operationType:"unique_count",scale:"ratio",sourceField:"host.name"}},incompleteColumns:{}}}}},filters:[],query:{language:"kuery",query:""},visualization:{axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!1},fittingFunction:"None",gridlinesVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},labelsOrientation:{x:0,yLeft:0,yRight:0},layers:[{accessors:["b00c65ea-32be-4163-bfc8-f795b1ef9d06"],layerId:"416b6fad-1923-4f6a-a2df-b223bb287e30",layerType:"data",seriesType:"area",xAccessor:"5eea817b-67b7-4268-8ecb-7688d1094721"}],legend:{isVisible:!0,position:"right"},preferredSeriesType:"area",tickLabelsVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},valueLabels:"hide",yLeftExtent:{mode:"full"},yRightExtent:{mode:"full"}}},title:"[Host] Hosts - area",visualizationType:"lnsXY",references:[{id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-416b6fad-1923-4f6a-a2df-b223bb287e30",type:"index-pattern"}]};var Rd=a(11);const Pd=z.i18n.translate("xpack.securitySolution.hostsKpiHosts.errorSearchDescription",{defaultMessage:"An error has occurred on hosts kpi hosts search"}),Ld=z.i18n.translate("xpack.securitySolution.hostsKpiHosts.failSearchDescription",{defaultMessage:"Failed to run search on hosts kpi hosts"});var Bd=a(99);const qd="hostsKpiHostsQuery";var zd=a(861),$d=a(530);const Vd=e=>!!Object(v.get)("value.length",e)&&Object(v.get)("value",e).every((({x:e,y:t})=>!Object(v.isNull)(e)&&Object(v.isNumber)(t)&&t>0)),Ud={tickLine:{visible:!1},tickLabel:{padding:3}},Hd=({data:e,...t})=>{const a=Object(Xe.i)(),n=Object(p.n)(),r=Object(v.get)("configs.axis.xTickFormatter",t),s=Object(v.get)("configs.axis.yTickFormatter",t),o=`group-${e[0].key}-x`,l=`group-${e[0].key}-y`,c={...Xe.e,theme:a,...Object(v.get)("configs.settings",t)};return t.width&&t.height?i.a.createElement("div",{style:{height:t.height,width:t.width,position:"relative"}},i.a.createElement(Je.Chart,null,i.a.createElement(Je.Settings,c),e.map((e=>{const a=e.key;return Vd(e)?i.a.createElement(Je.AreaSeries,{id:a,key:a,name:e.key.replace("Histogram",""),data:e.value||[],xScaleType:Object(v.getOr)(Je.ScaleType.Linear,"configs.series.xScaleType",t),yScaleType:Object(v.getOr)(Je.ScaleType.Linear,"configs.series.yScaleType",t),timeZone:n,xAccessor:"x",yAccessors:["y"],areaSeriesStyle:{area:{opacity:.04,visible:!0},line:{strokeWidth:1,visible:!0},point:{visible:!1,radius:.2,strokeWidth:1,opacity:1}},color:e.color?e.color:void 0}):null})),i.a.createElement(Je.Axis,{id:o,position:Je.Position.Bottom,showOverlappingTicks:!1,tickFormat:r,style:Ud}),i.a.createElement(Je.Axis,{id:l,position:Je.Position.Left,style:Ud,tickFormat:s}))):null};Hd.displayName="AreaChartBaseComponent";const Gd=i.a.memo(Hd);Gd.displayName="AreaChartBase";const Qd=({areaChart:e,configs:t,visualizationActionsOptions:a})=>{const{ref:r,width:s,height:o}=Object(Ns.b)(),l=Object(v.get)("customHeight",t),c=Object(v.get)("customWidth",t),u=Object(Xe.g)(l,o),d=Object(Xe.h)(c,s),p=Object(n.useMemo)((()=>{return t=e,Array.isArray(t)&&t.some(Vd);var t}),[e]);return i.a.createElement(Xe.d,null,i.a.createElement(Ta.a,{targetClassNames:[$d.a]},p&&e&&i.a.createElement(Xe.b,{gutterSize:"none"},i.a.createElement(V.EuiFlexItem,{grow:!0},i.a.createElement(Xe.c,{ref:r,height:u},i.a.createElement(Gd,{data:e,height:u,width:d,configs:t})))),!p&&i.a.createElement(zd.a,{height:u,width:d,data:e}),null!=a&&i.a.createElement($d.b,lr()({},a,{className:"viz-actions"}))))},Wd=i.a.memo(Qd);var Kd=a(620);const Yd="120px",Jd=H()(V.EuiFlexGroup).withConfig({displayName:"FlexGroup",componentId:"sc-1iv398l-0"})([".no-margin{margin-top:0 !important;margin-bottom:0 !important;}"]),Xd=H()(V.EuiFlexItem).withConfig({displayName:"FlexItem",componentId:"sc-1iv398l-1"})(["min-width:0;position:relative;"]);Xd.displayName="FlexItem";const Zd=H()(V.EuiFlexItem).withConfig({displayName:"MetricItem",componentId:"sc-1iv398l-2"})(["&.euiFlexItem{flex-basis:0;flex-grow:0;}"]);Zd.displayName="MetricItem";const ep=H()(V.EuiTitle).withConfig({displayName:"StatValue",componentId:"sc-1iv398l-3"})(["overflow:hidden;text-overflow:ellipsis;white-space:nowrap;"]);ep.displayName="StatValue";const tp=H.a.h6.withConfig({displayName:"StyledTitle",componentId:"sc-1iv398l-4"})(["line-height:200%;"]),ap=e=>e.toLocaleString(),np=e=>({series:{xScaleType:Je.ScaleType.Time,yScaleType:Je.ScaleType.Linear},axis:{xTickFormatter:Object(v.get)("xTickFormatter",e),yTickFormatter:ap},settings:{onBrushEnd:Object(v.getOr)((()=>{}),"onBrushEnd",e)},customHeight:74}),ip=(e,t)=>e.map((e=>({...e,value:Object(v.get)(e.key,t)}))),rp=(e,t)=>e.filter((e=>null!=Object(v.get)(`${e.key}Histogram`,t))).map((({lensAttributes:e,...a})=>({...a,value:Object(v.get)(`${a.key}Histogram`,t),key:`${a.key}Histogram`}))),sp=(e,t)=>0===e.length?[]:e.reduce(((a,n,i)=>{const{key:r,color:s}=n,o=Object(v.getOr)(null,r,t);return[...a,{key:r,color:s,value:[{x:Object(v.get)(`${i}.name`,e)||Object(v.getOr)("",`${i}.description`,e),y:o,g:r,y0:0}]}]}),[]);var op=a(856);const lp=({onToggle:e,isToggleExpanded:t,description:a})=>i.a.createElement(Jd,{gutterSize:"none"},i.a.createElement(V.EuiFlexItem,{className:t?"":"no-margin"},i.a.createElement(V.EuiFlexGroup,{gutterSize:"none",responsive:!1},i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiButtonIcon,{"aria-label":op.a(t),"data-test-subj":"query-toggle-stat",color:"text",display:"empty",iconType:t?"arrowDown":"arrowRight",onClick:e,size:"xs",title:op.a(t)})),i.a.createElement(V.EuiFlexItem,null,i.a.createElement(V.EuiTitle,{size:"xxxs"},i.a.createElement(tp,null,a)))))),cp=i.a.memo(lp);cp.displayName="StatItemHeader";const up=({fields:e,id:t,timerange:a,isAreaChartDataAvailable:n,isBarChartDataAvailable:r,inspectTitle:s,inspectIndex:o})=>i.a.createElement(V.EuiFlexGroup,null,e.map((e=>i.a.createElement(Xd,{key:`stat-items-field-${e.key}`},i.a.createElement(V.EuiFlexGroup,{alignItems:"center",gutterSize:"m",responsive:!1},(n||r)&&e.icon&&i.a.createElement(Xd,{grow:!1},i.a.createElement(V.EuiIcon,{type:e.icon,color:e.color,size:"l","data-test-subj":"stat-icon"})),i.a.createElement(Xd,null,i.a.createElement(Ta.a,{targetClassNames:[$d.a]},i.a.createElement(ep,null,i.a.createElement("p",{"data-test-subj":"stat-title"},null!=e.value?e.value.toLocaleString():Object(Xn.d)()," ",e.description)),e.lensAttributes&&a&&i.a.createElement($d.b,{lensAttributes:e.lensAttributes,queryId:t,inspectIndex:o,timerange:a,title:s,className:"viz-actions"})))))))),dp=i.a.memo(up);var pp=a(71),mp=a(862),gp=a(546),bp=a(863),fp=a(864),yp=a(555);const hp=({callback:e})=>({id:"openInLens",getDisplayName:e=>ql.k,getIconType:e=>"visArea",type:"actionButton",isCompatible:async e=>!0,async execute(t){e()},order:3}),Ep=({callback:e,disabled:t})=>({id:"addToNewCase",getDisplayName:e=>ql.c,getIconType:e=>"plusInCircle",type:"actionButton",isCompatible:async e=>!0,async execute(t){e()},disabled:t,order:2}),vp=({callback:e,disabled:t})=>({id:"inspect",getDisplayName:e=>yp.d,getIconType:e=>"inspect",type:"actionButton",isCompatible:async e=>!0,async execute(t){e()},disabled:t,order:4}),xp=({callback:e,disabled:t})=>({id:"addToExistingCase",getDisplayName:e=>ql.b,getIconType:e=>"plusInCircle",type:"actionButton",isCompatible:async e=>!0,async execute(t){e()},disabled:t,order:1});var kp=a(554);const Sp=H.a.div.withConfig({displayName:"LensComponentWrapper",componentId:"sc-y015n4-0"})(["height:",";> div{background-color:transparent;}.expExpressionRenderer__expression{padding:0 !important;}.legacyMtrVis__container{padding:0;}"],(({height:e})=>null!=e?e:"auto")),jp={requests:void 0,responses:void 0,isLoading:!0},Op={height:"100%",minWidth:"100px"},wp=({getLensAttributes:e,height:t,id:a,inputsModelId:r=K.a.global,lensAttributes:s,stackByField:l,timerange:c,inspectTitle:u})=>{const{lens:d}=Object(p.k)().services,m=Object(o.useDispatch)(),[g,b]=Object(n.useState)(!1),[f,y]=Object(n.useState)(jp),h=rr.d.globalQueryByIdSelector(),{searchSessionId:E}=Object(x.a)((e=>h(e,a))),v=Object(mp.a)({lensAttributes:s,getLensAttributes:e,stackByField:l,title:""}),k=d.EmbeddableComponent,S=(({withActions:e,attributes:t,timeRange:a,inspectActionProps:i})=>{const{lens:r}=Object(gp.b)().services,{navigateToPrefilledEditor:s}=r,[o,l]=Object(n.useState)(["inspect","openInLens","addToNewCase","addToExistingCase"]);Object(n.useEffect)((()=>{!1===e&&l([])}),[e]);const c=Object(n.useCallback)((()=>{a&&t&&s({id:"",timeRange:a,attributes:t},{openInNewTab:!0})}),[t,s,a]),{disabled:u,onAddToExistingCaseClicked:d}=Object(bp.a)({lensAttributes:t,timeRange:a}),{onAddToNewCaseClicked:p,disabled:m}=Object(fp.a)({timeRange:a,lensAttributes:t});return Object(n.useMemo)((()=>o.reduce(((e,t)=>"inspect"===t&&null!=i?[...e,vp({callback:null==i?void 0:i.onInspectActionClicked,disabled:null==i?void 0:i.isDisabled})]:"addToExistingCase"===t?[...e,xp({callback:d,disabled:u})]:"addToNewCase"===t?[...e,Ep({callback:p,disabled:m})]:"openInLens"===t?[...e,hp({callback:c})]:e),[])),[o,i,d,u,p,m,c])})({withActions:!0,attributes:v,timeRange:c,inspectActionProps:Object(n.useMemo)((()=>({onInspectActionClicked:()=>{b(!0)},isDisabled:f.isLoading})),[f.isLoading])}),j=Object(n.useCallback)((()=>{b(!1)}),[]),O=Object(n.useCallback)((({range:e})=>{const[t,a]=e;m(Object(te.setAbsoluteRangeDatePicker)({id:r,from:new Date(t).toISOString(),to:new Date(a).toISOString()}))}),[m,r]),w=Object(n.useMemo)((()=>{var e;const[t,...a]=null!==(e=f.requests)&&void 0!==e?e:[];return{request:t,additionalRequests:a}}),[f.requests]),T=Object(n.useMemo)((()=>{var e;const[t,...a]=null!==(e=f.responses)&&void 0!==e?e:[];return{response:t,additionalResponses:a}}),[f.responses]),I=Object(n.useCallback)(((e,t)=>{var a;if(!t)return;const n=Object(ed.d)(null==t||null===(a=t.requests)||void 0===a?void 0:a.getRequests());y({requests:n.requests,responses:n.responses,isLoading:e})}),[]);return i.a.createElement(i.a.Fragment,null,v&&E?i.a.createElement(Sp,{height:t},i.a.createElement(k,{id:a,style:Op,timeRange:c,attributes:v,onLoad:I,onBrushEnd:O,viewMode:pp.ViewMode.VIEW,withDefaultActions:!1,extraActions:S,searchSessionId:E,showInspector:!1})):null,g&&null!==w.request&&null!==T.response&&i.a.createElement(kp.a,{additionalRequests:w.additionalRequests,additionalResponses:T.additionalResponses,closeModal:j,"data-test-subj":"inspect-modal",inputId:r,request:w.request,response:T.response,title:u}))},Tp=i.a.memo(wp),Ip=({fields:e,id:t,timerange:a,inspectTitle:n})=>i.a.createElement(V.EuiFlexGroup,{gutterSize:"none",className:"metricEmbeddable"},e.map((e=>i.a.createElement(Xd,{key:`stat-items-field-${e.key}`},i.a.createElement(V.EuiFlexGroup,{alignItems:"center",gutterSize:"none",responsive:!1},e.icon&&i.a.createElement(Xd,{grow:!1},i.a.createElement(V.EuiIcon,{type:e.icon,color:e.color,size:"l","data-test-subj":"stat-icon"})),i.a.createElement(Zd,null,e.lensAttributes&&i.a.createElement("div",{"data-test-subj":"stat-title"},i.a.createElement(Tp,{"data-test-subj":"embeddable-metric",height:"36px",id:t,lensAttributes:e.lensAttributes,timerange:a,inspectTitle:n}))),null!=e.description&&i.a.createElement(Xd,null,i.a.createElement(ep,null,i.a.createElement("p",{"data-test-subj":"stat-title"},e.description)))))))),Cp=i.a.memo(Ip),Mp=i.a.memo((({areaChart:e,barChart:t,description:a,enableAreaChart:r,enableBarChart:s,fields:o,from:l,grow:c,id:u,loading:d=!1,index:p,updateDateRange:m,statKey:g="item",to:b,barChartLensAttributes:f,areaChartLensAttributes:y,setQuerySkip:h})=>{const E=!!(t&&t.length&&t.every((e=>null!=e.value&&e.value.length>0))),x=!!(e&&e.length&&e.every((e=>null!=e.value&&e.value.length>0))),k=Object(n.useMemo)((()=>({from:l,to:b})),[l,b]),{isToggleExpanded:S,onToggle:j}=(({id:e,setQuerySkip:t})=>{const{toggleStatus:a,setToggleStatus:i}=Object(Ht.a)(e),r=Object(n.useCallback)((e=>{i(e),t(!e)}),[t,i]),s=Object(n.useCallback)((()=>r(!a)),[r,a]);return{isToggleExpanded:a,onToggle:s}})({id:u,setQuerySkip:h}),O=Object(B.a)("chartEmbeddablesEnabled");return i.a.createElement(Xd,{grow:c,"data-test-subj":`stat-${g}`},i.a.createElement(V.EuiPanel,{hasBorder:!0},i.a.createElement(cp,{onToggle:j,isToggleExpanded:S,description:a}),d&&i.a.createElement(V.EuiFlexGroup,{justifyContent:"center",alignItems:"center"},i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiLoadingSpinner,{size:"l","data-test-subj":"loading-spinner"}))),S&&!d&&i.a.createElement(i.a.Fragment,null,O?i.a.createElement(Cp,{fields:o,id:u,timerange:k,inspectTitle:a}):i.a.createElement(dp,{fields:o,id:u,timerange:k,isAreaChartDataAvailable:x,isBarChartDataAvailable:E,inspectTitle:a,inspectIndex:p}),(r||s)&&i.a.createElement(V.EuiHorizontalRule,null),i.a.createElement(V.EuiFlexGroup,{gutterSize:O?"none":"l"},s&&i.a.createElement(Xd,null,O&&f?i.a.createElement(Tp,{"data-test-subj":"embeddable-bar-chart",lensAttributes:f,timerange:k,id:u,height:Yd,inspectTitle:a}):i.a.createElement(Kd.a,{barChart:t,configs:{series:{xScaleType:Je.ScaleType.Ordinal,yScaleType:Je.ScaleType.Linear,stackAccessors:["y0"]},axis:{xTickFormatter:ap},settings:{onElementClick:Object(v.getOr)((()=>{}),"onElementClick",undefined),rotation:90},customHeight:74},visualizationActionsOptions:{lensAttributes:f,queryId:u,inspectIndex:p,timerange:k,title:a}})),r&&null!=l&&null!=b&&i.a.createElement(i.a.Fragment,null,i.a.createElement(Xd,null,O&&y?i.a.createElement(Tp,{"data-test-subj":"embeddable-area-chart",lensAttributes:y,timerange:k,id:u,height:Yd,inspectTitle:a}):i.a.createElement(Wd,{areaChart:e,configs:np({xTickFormatter:Object(Ns.a)([l,b]),onBrushEnd:m}),visualizationActionsOptions:{lensAttributes:y,queryId:u,inspectIndex:p,timerange:k,title:a}})))))))}),((e,t)=>e.description===t.description&&e.enableAreaChart===t.enableAreaChart&&e.enableBarChart===t.enableBarChart&&e.from===t.from&&e.grow===t.grow&&e.loading===t.loading&&e.setQuerySkip===t.setQuerySkip&&e.id===t.id&&e.index===t.index&&e.updateDateRange===t.updateDateRange&&e.statKey===t.statKey&&e.to===t.to&&oc()(e.areaChart,t.areaChart)&&oc()(e.barChart,t.barChart)&&oc()(e.fields,t.fields)));Mp.displayName="StatItemsComponent",H()(V.EuiFlexGroup).withConfig({displayName:"FlexGroup",componentId:"sc-17i7jd7-0"})(["min-height:","px;"],247).displayName="FlexGroup";const Fp=i.a.memo((({fieldsMapping:e,data:t,id:a,loading:n=!1,from:r,to:s,updateDateRange:o,setQuerySkip:l})=>{const c=((e,t,a,n,i,r,s,o)=>e.map((e=>({...e,areaChart:e.enableAreaChart?rp(e.fields,t):void 0,barChart:e.enableBarChart?sp(e.fields,t):void 0,fields:ip(e.fields,t),id:a,key:`kpi-summary-${e.key}`,statKey:`${e.key}`,from:n,to:i,updateDateRange:r,setQuerySkip:s,loading:o}))))(e,t,a,r,s,o,l,n);return i.a.createElement(V.EuiFlexGroup,{wrap:!0},c.map((e=>i.a.createElement(Mp,e))))}),((e,t)=>e.fieldsMapping===t.fieldsMapping&&e.id===t.id&&e.loading===t.loading&&e.from===t.from&&e.to===t.to&&e.updateDateRange===t.updateDateRange&&oc()(e.data,t.data)));Fp.displayName="KpiBaseComponent";const Dp=Object(As.a)(Fp);let Ap;!function(e){e.uniqueSourceIps="#D36086",e.uniqueDestinationIps="#9170B8",e.hosts="#6092C0"}(Ap||(Ap={}));const _p=z.i18n.translate("xpack.securitySolution.kpiHosts.hosts.title",{defaultMessage:"Hosts"});var Np=a(184);const Rp=({inputId:e,queryId:t})=>{const a=Object(o.useDispatch)(),{data:i}=Object(p.k)().services,r=Object(n.useRef)(i.search.session),s=Object(n.useMemo)((()=>r.current.start()),[r]),l=rr.d.globalQueryByIdSelector(),c=rr.d.timelineQueryByIdSelector(),{selectedInspectIndex:u}=Object(x.a)((a=>e===K.a.global?l(a,t):c(a,t))),d=Object(n.useCallback)((()=>{a(Np.b.setInspectionParameter({id:t,selectedInspectIndex:u,isInspected:!1,inputId:K.a.global,searchSessionId:r.current.start()}))}),[a,t,u]);return Object(n.useEffect)((()=>()=>{i.search.session.clear()})),{searchSessionId:s,refetchByRestartingSession:d}},Pp=[{key:"hosts",fields:[{key:"hosts",value:null,color:Ap.hosts,icon:"storage",lensAttributes:{description:"",state:{datasourceStates:{formBased:{layers:{"416b6fad-1923-4f6a-a2df-b223bb287e30":{columnOrder:["b00c65ea-32be-4163-bfc8-f795b1ef9d06"],columns:{"b00c65ea-32be-4163-bfc8-f795b1ef9d06":{customLabel:!0,dataType:"number",isBucketed:!1,label:" ",operationType:"unique_count",scale:"ratio",sourceField:"host.name"}},incompleteColumns:{}}}}},filters:[],query:{language:"kuery",query:""},visualization:{accessor:"b00c65ea-32be-4163-bfc8-f795b1ef9d06",layerId:"416b6fad-1923-4f6a-a2df-b223bb287e30",layerType:"data"}},title:"[Host] Hosts - metric",visualizationType:"lnsLegacyMetric",references:[{id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-416b6fad-1923-4f6a-a2df-b223bb287e30",type:"index-pattern"}]}}],enableAreaChart:!0,description:_p,areaChartLensAttributes:Nd}],Lp=({filterQuery:e,from:t,indexNames:a,to:r,updateDateRange:s,setQuery:o,skip:l})=>{const{toggleStatus:c}=Object(Ht.a)(qd),[u,d]=Object(n.useState)(l||!c),m=Object(B.a)("chartEmbeddablesEnabled");Object(n.useEffect)((()=>{d(l||!c)}),[l,c]);const[g,{refetch:b,id:f,inspect:y,...h}]=(({filterQuery:e,endDate:t,indexNames:a,skip:i=!1,startDate:r})=>{const{data:s}=Object(p.k)().services,o=Object(n.useRef)(v.noop),l=Object(n.useRef)(new AbortController),c=Object(n.useRef)(new Rd.Subscription),[u,d]=Object(n.useState)(!1),[m,g]=Object(n.useState)(null),[b,f]=Object(n.useState)({hosts:0,hostsHistogram:[],id:qd,inspect:{dsl:[],response:[]},isInspected:!1,refetch:o.current}),{addError:y,addWarning:h}=Object(Oi.a)(),E=Object(n.useCallback)((e=>{if(null==e||i)return;const t=async()=>{l.current=new AbortController,d(!0),c.current=s.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:l.current.signal}).subscribe({next:e=>{e.isPartial||e.isRunning?e.isPartial&&!e.isRunning&&(d(!1),h(Pd),c.current.unsubscribe()):(d(!1),f((t=>({...t,hosts:e.hosts,hostsHistogram:e.hostsHistogram,inspect:Object(Bd.getInspectResponse)(e,t.inspect),refetch:o.current}))),c.current.unsubscribe())},error:e=>{d(!1),y(e,{title:Ld}),c.current.unsubscribe()}})};c.current.unsubscribe(),l.current.abort(),t(),o.current=t}),[s.search,y,h,i]);return Object(n.useEffect)((()=>{g((n=>{const i={...null!=n?n:{},defaultIndex:a,factoryQueryType:Jn.i.kpiHosts,filterQuery:Object(cc.a)(e),timerange:{interval:"12h",from:r,to:t}};return oc()(n,i)?n:i}))}),[a,t,e,r]),Object(n.useEffect)((()=>(E(m),()=>{c.current.unsubscribe(),l.current.abort()})),[m,E]),Object(n.useEffect)((()=>{i&&(d(!1),c.current.unsubscribe(),l.current.abort())}),[i]),[u,b]})({filterQuery:e,endDate:r,indexNames:a,startDate:t,skip:u||m}),{searchSessionId:E,refetchByRestartingSession:x}=Rp({inputId:K.a.global,queryId:f});return i.a.createElement(Dp,{data:h,id:f,inspect:y,loading:g,fieldsMapping:Pp,from:t,to:r,updateDateRange:s,refetch:m?x:b,setQuery:o,setQuerySkip:d,searchSessionId:m?E:void 0})},Bp=i.a.memo(Lp),qp={description:"",state:{datasourceStates:{formBased:{layers:{"8be0156b-d423-4a39-adf1-f54d4c9f2e69":{columnOrder:["a0cb6400-f708-46c3-ad96-24788f12dae4","d9a6eb6b-8b78-439e-98e7-a718f8ffbebe"],columns:{"a0cb6400-f708-46c3-ad96-24788f12dae4":{dataType:"date",isBucketed:!0,label:"@timestamp",operationType:"date_histogram",params:{interval:"auto"},scale:"interval",sourceField:"@timestamp"},"d9a6eb6b-8b78-439e-98e7-a718f8ffbebe":{customLabel:!0,dataType:"number",isBucketed:!1,label:ql.l,operationType:"unique_count",scale:"ratio",sourceField:"source.ip"}},incompleteColumns:{}},"ca05ecdb-0fa4-49a8-9305-b23d91012a46":{columnOrder:["f95e74e6-99dd-4b11-8faf-439b4d959df9","e7052671-fb9e-481f-8df3-7724c98cfc6f"],columns:{"e7052671-fb9e-481f-8df3-7724c98cfc6f":{customLabel:!0,dataType:"number",isBucketed:!1,label:ql.g,operationType:"unique_count",scale:"ratio",sourceField:"destination.ip"},"f95e74e6-99dd-4b11-8faf-439b4d959df9":{dataType:"date",isBucketed:!0,label:"@timestamp",operationType:"date_histogram",params:{interval:"auto"},scale:"interval",sourceField:"@timestamp"}},incompleteColumns:{}}}}},filters:[],query:{language:"kuery",query:""},visualization:{axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!0},fittingFunction:"None",gridlinesVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},labelsOrientation:{x:0,yLeft:0,yRight:0},layers:[{accessors:["d9a6eb6b-8b78-439e-98e7-a718f8ffbebe"],layerId:"8be0156b-d423-4a39-adf1-f54d4c9f2e69",layerType:"data",seriesType:"area",xAccessor:"a0cb6400-f708-46c3-ad96-24788f12dae4",yConfig:[{color:"#d36186",forAccessor:"d9a6eb6b-8b78-439e-98e7-a718f8ffbebe"}]},{accessors:["e7052671-fb9e-481f-8df3-7724c98cfc6f"],layerId:"ca05ecdb-0fa4-49a8-9305-b23d91012a46",layerType:"data",seriesType:"area",xAccessor:"f95e74e6-99dd-4b11-8faf-439b4d959df9",yConfig:[{color:"#9170b8",forAccessor:"e7052671-fb9e-481f-8df3-7724c98cfc6f"}]}],legend:{isVisible:!1,position:"right",showSingleSeries:!1},preferredSeriesType:"area",tickLabelsVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},valueLabels:"hide",yLeftExtent:{mode:"full"},yRightExtent:{mode:"full"}}},title:"[Host] Unique IPs - area",visualizationType:"lnsXY",references:[{id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-8be0156b-d423-4a39-adf1-f54d4c9f2e69",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-ca05ecdb-0fa4-49a8-9305-b23d91012a46",type:"index-pattern"}],type:"lens",updated_at:"2022-02-09T17:44:03.359Z",version:"WzI5MTI5OSwzXQ=="},zp={description:"",state:{datasourceStates:{formBased:{layers:{"8be0156b-d423-4a39-adf1-f54d4c9f2e69":{columnOrder:["f8bfa719-5c1c-4bf2-896e-c318d77fc08e","32f66676-f4e1-48fd-b7f8-d4de38318601"],columns:{"32f66676-f4e1-48fd-b7f8-d4de38318601":{dataType:"number",isBucketed:!1,label:Object(ql.o)("source.ip"),operationType:"unique_count",scale:"ratio",sourceField:"source.ip"},"f8bfa719-5c1c-4bf2-896e-c318d77fc08e":{dataType:"string",isBucketed:!0,label:"Filters",operationType:"filters",params:{filters:[{input:{language:"kuery",query:""},label:ql.l}]},scale:"ordinal"}},incompleteColumns:{}},"ec84ba70-2adb-4647-8ef0-8ad91a0e6d4e":{columnOrder:["c72aad6a-fc9c-43dc-9194-e13ca3ee8aff","b7e59b08-96e6-40d1-84fd-e97b977d1c47"],columns:{"b7e59b08-96e6-40d1-84fd-e97b977d1c47":{dataType:"number",isBucketed:!1,label:Object(ql.o)("destination.ip"),operationType:"unique_count",scale:"ratio",sourceField:"destination.ip"},"c72aad6a-fc9c-43dc-9194-e13ca3ee8aff":{customLabel:!0,dataType:"string",isBucketed:!0,label:ql.g,operationType:"filters",params:{filters:[{input:{language:"kuery",query:""},label:"Dest."}]},scale:"ordinal"}},incompleteColumns:{}}}}},filters:[],query:{language:"kuery",query:""},visualization:{axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!0},fittingFunction:"None",gridlinesVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},labelsOrientation:{x:0,yLeft:0,yRight:0},layers:[{accessors:["32f66676-f4e1-48fd-b7f8-d4de38318601"],layerId:"8be0156b-d423-4a39-adf1-f54d4c9f2e69",layerType:"data",seriesType:"bar_horizontal_stacked",xAccessor:"f8bfa719-5c1c-4bf2-896e-c318d77fc08e",yConfig:[{color:"#d36186",forAccessor:"32f66676-f4e1-48fd-b7f8-d4de38318601"}]},{accessors:["b7e59b08-96e6-40d1-84fd-e97b977d1c47"],layerId:"ec84ba70-2adb-4647-8ef0-8ad91a0e6d4e",layerType:"data",seriesType:"bar_horizontal_stacked",xAccessor:"c72aad6a-fc9c-43dc-9194-e13ca3ee8aff",yConfig:[{color:"#9170b8",forAccessor:"b7e59b08-96e6-40d1-84fd-e97b977d1c47"}]}],legend:{isVisible:!1,position:"right",showSingleSeries:!1},preferredSeriesType:"bar_horizontal_stacked",tickLabelsVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},valueLabels:"hide",yLeftExtent:{mode:"full"},yRightExtent:{mode:"full"}}},title:"[Host] Unique IPs - bar",visualizationType:"lnsXY",references:[{id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-8be0156b-d423-4a39-adf1-f54d4c9f2e69",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-ec84ba70-2adb-4647-8ef0-8ad91a0e6d4e",type:"index-pattern"}]},$p=z.i18n.translate("xpack.securitySolution.hostsKpiUniqueIps.errorSearchDescription",{defaultMessage:"An error has occurred on hosts kpi unique ips search"}),Vp=z.i18n.translate("xpack.securitySolution.hostsKpiUniqueIps.failSearchDescription",{defaultMessage:"Failed to run search on hosts kpi unique ips"}),Up="hostsKpiUniqueIpsQuery",Hp=z.i18n.translate("xpack.securitySolution.kpiHosts.uniqueIps.title",{defaultMessage:"Unique IPs"}),Gp=z.i18n.translate("xpack.securitySolution.kpiHosts.uniqueIps.sourceUnitLabel",{defaultMessage:"source"}),Qp=z.i18n.translate("xpack.securitySolution.kpiHosts.uniqueIps.destinationUnitLabel",{defaultMessage:"destination"}),Wp=z.i18n.translate("xpack.securitySolution.kpiHosts.uniqueIps.sourceChartLabel",{defaultMessage:"Src."}),Kp=z.i18n.translate("xpack.securitySolution.kpiHosts.uniqueIps.destinationChartLabel",{defaultMessage:"Dest."}),Yp=[{key:"uniqueIps",fields:[{key:"uniqueSourceIps",name:Wp,description:Gp,value:null,color:Ap.uniqueSourceIps,icon:"visMapCoordinate",lensAttributes:{description:"",state:{datasourceStates:{formBased:{layers:{"8be0156b-d423-4a39-adf1-f54d4c9f2e69":{columnOrder:["d9a6eb6b-8b78-439e-98e7-a718f8ffbebe"],columns:{"d9a6eb6b-8b78-439e-98e7-a718f8ffbebe":{customLabel:!0,dataType:"number",isBucketed:!1,label:" ",operationType:"unique_count",scale:"ratio",sourceField:"source.ip"}},incompleteColumns:{}}}}},filters:[],query:{language:"kuery",query:""},visualization:{accessor:"d9a6eb6b-8b78-439e-98e7-a718f8ffbebe",layerId:"8be0156b-d423-4a39-adf1-f54d4c9f2e69",layerType:"data"}},title:"[Host] Unique IPs - source metric",visualizationType:"lnsLegacyMetric",references:[{id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-8be0156b-d423-4a39-adf1-f54d4c9f2e69",type:"index-pattern"}]}},{key:"uniqueDestinationIps",name:Kp,description:Qp,value:null,color:Ap.uniqueDestinationIps,icon:"visMapCoordinate",lensAttributes:{description:"",state:{datasourceStates:{formBased:{layers:{"8be0156b-d423-4a39-adf1-f54d4c9f2e69":{columnOrder:["d9a6eb6b-8b78-439e-98e7-a718f8ffbebe"],columns:{"d9a6eb6b-8b78-439e-98e7-a718f8ffbebe":{customLabel:!0,dataType:"number",isBucketed:!1,label:" ",operationType:"unique_count",scale:"ratio",sourceField:"destination.ip"}},incompleteColumns:{}}}}},filters:[],query:{language:"kuery",query:""},visualization:{accessor:"d9a6eb6b-8b78-439e-98e7-a718f8ffbebe",layerId:"8be0156b-d423-4a39-adf1-f54d4c9f2e69",layerType:"data"}},title:"[Host] Unique IPs - destination metric",visualizationType:"lnsLegacyMetric",references:[{id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-8be0156b-d423-4a39-adf1-f54d4c9f2e69",type:"index-pattern"}]}}],enableAreaChart:!0,enableBarChart:!0,description:Hp,areaChartLensAttributes:qp,barChartLensAttributes:zp}],Jp=({filterQuery:e,from:t,indexNames:a,to:r,updateDateRange:s,setQuery:o,skip:l})=>{const{toggleStatus:c}=Object(Ht.a)(Up),[u,d]=Object(n.useState)(l||!c),m=Object(B.a)("chartEmbeddablesEnabled");Object(n.useEffect)((()=>{d(l||!c)}),[l,c]);const[g,{refetch:b,id:f,inspect:y,...h}]=(({filterQuery:e,endDate:t,indexNames:a,skip:i=!1,startDate:r})=>{const{data:s}=Object(p.k)().services,o=Object(n.useRef)(v.noop),l=Object(n.useRef)(new AbortController),c=Object(n.useRef)(new Rd.Subscription),[u,d]=Object(n.useState)(!1),[m,g]=Object(n.useState)(null),[b,f]=Object(n.useState)({uniqueSourceIps:0,uniqueSourceIpsHistogram:[],uniqueDestinationIps:0,uniqueDestinationIpsHistogram:[],id:Up,inspect:{dsl:[],response:[]},isInspected:!1,refetch:o.current}),{addError:y,addWarning:h}=Object(Oi.a)(),E=Object(n.useCallback)((e=>{if(null==e||i)return;const t=async()=>{l.current=new AbortController,d(!0),c.current=s.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:l.current.signal}).subscribe({next:e=>{e.isPartial||e.isRunning?e.isPartial&&!e.isRunning&&(d(!1),h($p),c.current.unsubscribe()):(d(!1),f((t=>({...t,uniqueSourceIps:e.uniqueSourceIps,uniqueSourceIpsHistogram:e.uniqueSourceIpsHistogram,uniqueDestinationIps:e.uniqueDestinationIps,uniqueDestinationIpsHistogram:e.uniqueDestinationIpsHistogram,inspect:Object(Bd.getInspectResponse)(e,t.inspect),refetch:o.current}))),c.current.unsubscribe())},error:e=>{d(!1),y(e,{title:Vp}),c.current.unsubscribe()}})};c.current.unsubscribe(),l.current.abort(),t(),o.current=t}),[s.search,y,h,i]);return Object(n.useEffect)((()=>{g((n=>{const i={...null!=n?n:{},defaultIndex:a,factoryQueryType:Jn.i.kpiUniqueIps,filterQuery:Object(cc.a)(e),timerange:{interval:"12h",from:r,to:t}};return oc()(n,i)?n:i}))}),[a,t,e,i,r]),Object(n.useEffect)((()=>(E(m),()=>{c.current.unsubscribe(),l.current.abort()})),[m,E]),Object(n.useEffect)((()=>{i&&(d(!1),c.current.unsubscribe(),l.current.abort())}),[i]),[u,b]})({filterQuery:e,endDate:r,indexNames:a,startDate:t,skip:u||m}),{searchSessionId:E,refetchByRestartingSession:x}=Rp({inputId:K.a.global,queryId:f});return i.a.createElement(Dp,{data:h,id:f,inspect:y,loading:g,fieldsMapping:Yp,from:t,to:r,updateDateRange:s,refetch:m?x:b,setQuery:o,setQuerySkip:d,searchSessionId:m?E:void 0})},Xp=i.a.memo(Jp),Zp=i.a.memo((({filterQuery:e,from:t,indexNames:a,to:n,setQuery:r,skip:s,updateDateRange:o})=>i.a.createElement(V.EuiFlexGroup,{wrap:!0},i.a.createElement(V.EuiFlexItem,{grow:1},i.a.createElement(Bp,{filterQuery:e,from:t,indexNames:a,to:n,updateDateRange:o,setQuery:r,skip:s})),i.a.createElement(V.EuiFlexItem,{grow:2},i.a.createElement(Xp,{filterQuery:e,from:t,indexNames:a,to:n,updateDateRange:o,setQuery:r,skip:s})))));Zp.displayName="HostsKpiComponent",i.a.memo((({filterQuery:e,from:t,indexNames:a,to:n,setQuery:r,skip:s,updateDateRange:o})=>i.a.createElement(V.EuiFlexGroup,{wrap:!0},i.a.createElement(V.EuiFlexItem,{grow:1},i.a.createElement(Xp,{filterQuery:e,from:t,indexNames:a,to:n,updateDateRange:o,setQuery:r,skip:s}))))).displayName="HostsDetailsKpiComponent";const em=i.a.memo((({deleteQuery:e,filterQuery:t,from:a,indexNames:n,isInitializing:r,setQuery:o,to:l,type:c})=>{const u={deleteQuery:e,endDate:l,filterQuery:t,indexNames:n,skip:r||void 0===t,setQuery:o,startDate:a,type:c};return i.a.createElement(P.Switch,null,i.a.createElement(L.Route,{path:`${s.Hb}/:tabName(${tl.HostsTableType.hosts})`},i.a.createElement(Zc,u)),i.a.createElement(L.Route,{path:`${s.Hb}/:tabName(${tl.HostsTableType.risk})`},i.a.createElement(Cu,u)),i.a.createElement(L.Route,{path:`${s.Hb}/:tabName(${tl.HostsTableType.uncommonProcesses})`},i.a.createElement(hu,u)),i.a.createElement(L.Route,{path:`${s.Hb}/:tabName(${tl.HostsTableType.anomalies})`},i.a.createElement(al.a,lr()({},u,{AnomaliesTableComponent:hl}))),i.a.createElement(L.Route,{path:`${s.Hb}/:tabName(${tl.HostsTableType.events})`},i.a.createElement(El.a,lr()({additionalFilters:ed.e,tableId:ua.c.hostsPageEvents},u))),i.a.createElement(L.Route,{path:`${s.Hb}/:tabName(${tl.HostsTableType.sessions})`},i.a.createElement(td,u)))}));em.displayName="HostsTabs";const tm=e=>`${s.Hb}/${e}`,am=({hasMlUserPermissions:e,isRiskyHostsEnabled:t,isEnterprise:a})=>{const n=[],i={[tl.HostsTableType.hosts]:{id:tl.HostsTableType.hosts,name:nd.a,href:tm(tl.HostsTableType.hosts),disabled:!1},[tl.HostsTableType.uncommonProcesses]:{id:tl.HostsTableType.uncommonProcesses,name:nd.g,href:tm(tl.HostsTableType.uncommonProcesses),disabled:!1},[tl.HostsTableType.anomalies]:{id:tl.HostsTableType.anomalies,name:nd.b,href:tm(tl.HostsTableType.anomalies),disabled:!1},[tl.HostsTableType.events]:{id:tl.HostsTableType.events,name:nd.d,href:tm(tl.HostsTableType.events),disabled:!1},[tl.HostsTableType.risk]:{id:tl.HostsTableType.risk,name:nd.e,href:tm(tl.HostsTableType.risk),disabled:!1,isBeta:!0,betaOptions:{text:id.i}},[tl.HostsTableType.sessions]:{id:tl.HostsTableType.sessions,name:nd.f,href:tm(tl.HostsTableType.sessions),disabled:!1,isBeta:!1}};return e||n.push(tl.HostsTableType.anomalies),t||n.push(tl.HostsTableType.risk),a||n.push(tl.HostsTableType.sessions),Object(v.omit)(n,i)};var nm=a(602);const im=H.a.div.withConfig({displayName:"StyledFullHeightContainer",componentId:"sc-13ka402-0"})(["display:flex;flex-direction:column;flex:1 1 auto;"]),rm=()=>{const e=Object(o.useDispatch)(),t=Object(n.useRef)(null),a=Object(n.useMemo)((()=>W.b.getTableByIdSelector()),[]),r=Object(x.b)((e=>{var t;return(null!==(t=a(e,u.g.hostsPageEvents))&&void 0!==t?t:Q.a).graphEventId})),s=Object(n.useMemo)((()=>rr.d.globalFiltersQuerySelector()),[]),l=Object(n.useMemo)((()=>rr.d.globalQuerySelector()),[]),c=Object(x.a)(l),d=Object(x.a)(s),m=Object(n.useMemo)((()=>Es.d.hostRiskScoreSeverityFilterSelector()),[]),b=Object(x.a)((e=>m(e,Es.b.HostsType.page))),{to:f,from:h,deleteQuery:S,setQuery:j,isInitializing:O}=Object(Y.a)(),{globalFullScreen:w}=Object(fe.a)(),T=Object(ar.a)(),{uiSettings:I}=Object(p.k)().services,{tabName:C}=Object(P.useParams)(),M=i.a.useMemo((()=>{if(C===tl.HostsTableType.events)return[...d,...ed.e];if(C===tl.HostsTableType.risk){const e=Object(nm.a)(b,Jn.v.host);return[...d,...ed.e,...e]}return d}),[d,b,C]),F=Object(n.useCallback)((({x:t})=>{if(!t)return;const[a,n]=t;e(Object(te.setAbsoluteRangeDatePicker)({id:K.a.global,from:new Date(a).toISOString(),to:new Date(n).toISOString()}))}),[e]),{indicesExist:D,indexPattern:A,selectedPatterns:_}=Object(g.d)(),[N,R]=Object(n.useMemo)((()=>Object(od.c)({config:Object(Ki.getEsQueryConfig)(I),indexPattern:A,queries:[c],filters:d})),[d,A,I,c]),[L]=Object(n.useMemo)((()=>Object(od.c)({config:Object(Ki.getEsQueryConfig)(I),indexPattern:A,queries:[c],filters:M})),[A,c,M,I]);Object(cd.a)({id:xc,filterQuery:N,kqlError:R,query:c,startDate:h,endDate:f});const B=Object(Ku.b)().isEnterprise(),q=Object(n.useCallback)((()=>{var e,a;null===(e=t.current)||void 0===e||null===(a=e.querySelector(".inspectButtonComponent:last-of-type"))||void 0===a||a.focus()}),[t]),z=Object(n.useCallback)((()=>{Object(he.m)()}),[]),$=Object(n.useCallback)((e=>{Object(G.isTab)(e)&&Object(he.l)({containerElement:t.current,keyboardEvent:e,onSkipFocusBeforeEventsTable:q,onSkipFocusAfterEventsTable:z})}),[t,q,z]);return i.a.createElement(i.a.Fragment,null,D?i.a.createElement(im,{onKeyDown:$,ref:t},i.a.createElement(V.EuiWindowEvent,{event:"resize",handler:v.noop}),i.a.createElement(J.a,{show:Object(he.n)({globalFullScreen:w,graphEventId:r})},i.a.createElement(Z.a,{indexPattern:A,id:K.a.global})),i.a.createElement(y.a,{noPadding:w},i.a.createElement(ye.a,{show:!w},i.a.createElement(ta.a,{subtitle:i.a.createElement(Xi.a,{indexKey:Jn.k.hosts,indexNames:_}),title:nd.h,border:!0}),i.a.createElement(Zp,{filterQuery:N,indexNames:_,from:h,setQuery:j,to:f,skip:O||!!R,updateDateRange:F}),i.a.createElement(V.EuiSpacer,null),i.a.createElement(ga.a,{navTabs:am({hasMlUserPermissions:Object(tr.a)(T),isRiskyHostsEnabled:T.isPlatinumOrTrialLicense,isEnterprise:B})}),i.a.createElement(V.EuiSpacer,null)),i.a.createElement(em,{deleteQuery:S,to:f,filterQuery:L,isInitializing:O,indexNames:_,setQuery:j,from:h,type:Es.b.HostsType.page}))):i.a.createElement(aa.a,null),i.a.createElement(E.a,{pageName:k.a.hosts}))};rm.displayName="HostsComponent";const sm=i.a.memo(rm),om=`${s.Hb}/name/:detailName`,lm=i.a.memo((()=>i.a.createElement(P.Switch,null,i.a.createElement(L.Route,{path:`${s.Hb}/ml-hosts`},i.a.createElement(_d,null)),i.a.createElement(L.Route,{path:`${s.Hb}/externalAlerts`,render:({location:{search:e=""}})=>i.a.createElement(P.Redirect,{to:{pathname:`${s.Hb}/${tl.HostsTableType.events}`,search:`${e}&onlyExternalAlerts=true`}})}),i.a.createElement(L.Route,{path:`${s.Hb}/:tabName(${tl.HostsTableType.hosts}|${tl.HostsTableType.uncommonProcesses}|${tl.HostsTableType.anomalies}|${tl.HostsTableType.events}|${tl.HostsTableType.risk}|${tl.HostsTableType.sessions})`},i.a.createElement(sm,null)),i.a.createElement(L.Route,{path:`${om}/:tabName(${tl.HostsTableType.authentications}|${tl.HostsTableType.uncommonProcesses}|${tl.HostsTableType.anomalies}|${tl.HostsTableType.events}|${tl.HostsTableType.risk}|${tl.HostsTableType.sessions})`,render:({match:{params:{detailName:e}}})=>i.a.createElement(fd,{hostDetailsPagePath:om,detailName:decodeURIComponent(e)})}),i.a.createElement(L.Route,{path:om,render:({match:{params:{detailName:e}},location:{search:t=""}})=>i.a.createElement(P.Redirect,{to:{pathname:`${s.Hb}/name/${e}/${tl.HostsTableType.authentications}`,search:t}})}),i.a.createElement(L.Route,{path:`${s.Hb}/:detailName/:tabName?`,render:({match:{params:{detailName:e,tabName:t=tl.HostsTableType.authentications}},location:{search:a=""}})=>i.a.createElement(P.Redirect,{to:{pathname:`${s.Hb}/name/${e}/${t}`,search:a}})}),i.a.createElement(L.Route,{path:s.Hb,render:({location:{search:e=""}})=>i.a.createElement(P.Redirect,{to:{pathname:`${s.Hb}/${tl.HostsTableType.hosts}`,search:e}})}))));lm.displayName="HostsContainer";const cm=[{path:s.Hb,component:()=>i.a.createElement(_,null,i.a.createElement(r.TrackApplicationView,{viewId:k.a.hosts},i.a.createElement(lm,null)))}],um=[u.g.hostsPageEvents,u.g.hostsPageSessions];var dm=a(137);const pm=z.i18n.translate("xpack.securitySolution.usersTable.title",{defaultMessage:"Users"}),mm=z.i18n.translate("xpack.securitySolution.usersTable.userNameTitle",{defaultMessage:"User name"}),gm=z.i18n.translate("xpack.securitySolution.usersTable.lastSeenTitle",{defaultMessage:"Last seen"}),bm=z.i18n.translate("xpack.securitySolution.usersTable.domainTitle",{defaultMessage:"Domain"}),fm=z.i18n.translate("xpack.securitySolution.usersTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),ym=z.i18n.translate("xpack.securitySolution.usersTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),hm=e=>z.i18n.translate("xpack.securitySolution.usersTable.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {user} other {users}}"}),Em=z.i18n.translate("xpack.securitySolution.usersTable.userRiskToolTip",{defaultMessage:"User risk classification is determined by user risk score. Users classified as Critical or High are indicated as risky."}),vm=z.i18n.translate("xpack.securitySolution.usersTable.riskTitle",{defaultMessage:"User risk classification"}),xm=z.i18n.translate("xpack.securitySolution.usersRiskTable.userNameTitle",{defaultMessage:"User Name"}),km=z.i18n.translate("xpack.securitySolution.usersRiskTable.userRiskScoreTitle",{defaultMessage:"User risk score"}),Sm=z.i18n.translate("xpack.securitySolution.usersRiskTable.userRiskToolTip",{defaultMessage:"User risk classification is determined by user risk score. Users classified as Critical or High are indicated as risky."}),jm=z.i18n.translate("xpack.securitySolution.usersRiskTable.riskTitle",{defaultMessage:"User risk classification"}),Om=e=>z.i18n.translate("xpack.securitySolution.usersRiskTable.filteredUsersTitle",{values:{severity:e},defaultMessage:"View {severity} risk users"}),wm=e=>z.i18n.translate("xpack.securitySolution.usersTable.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {user} other {users}}"}),Tm=z.i18n.translate("xpack.securitySolution.usersTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),Im=z.i18n.translate("xpack.securitySolution.usersTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),Cm=z.i18n.translate("xpack.securitySolution.hostsRiskTable.usersTableTooltip",{defaultMessage:"The user risk table is not affected by the KQL time range. This table shows the latest recorded risk score for each user."}),Mm=vs.c.UsersTableType.allUsers,Fm=[{text:fm,numberOfRow:5},{text:ym,numberOfRow:10}],Dm=({users:e,totalCount:t,type:a,id:r,fakeTotalCount:s,loading:l,loadPage:c,showMorePagesIndicator:u,sort:d,setQuerySkip:m})=>{const g=Object(o.useDispatch)(),b=Object(n.useMemo)((()=>vs.e.allUsersSelector()),[]),{activePage:f,limit:y}=Object(x.a)((e=>b(e))),h=Object(ar.a)().isPlatinumOrTrialLicense,{navigateTo:E}=Object(p.l)(),v=Object(n.useCallback)((e=>{g(vs.b.updateTableLimit({usersType:a,limit:e,tableType:Mm}))}),[a,g]),S=Object(n.useCallback)((e=>{g(vs.b.updateTableActivePage({activePage:e,usersType:a,tableType:Mm}))}),[a,g]),j=Object(n.useCallback)((e=>{if(null!=e.sort){const t=e.sort;t.direction===d.direction&&t.field===d.field||g(vs.b.updateTableSorting({sort:t,tableType:Mm}))}}),[g,d]),O=Object(n.useCallback)((e=>{g(vs.b.updateUserRiskScoreSeverityFilter({severitySelection:[e]})),E({deepLinkId:k.a.users,path:dm.UsersTableType.risk})}),[g,E]),w=Object(n.useMemo)((()=>((e,t)=>{const a=[{field:"name",name:mm,truncateText:!1,sortable:!0,mobileOptions:{show:!0},render:e=>null!=e&&e.length>0?Object(rl.c)({rowItems:[e],attrName:"user.name",idPrefix:`users-table-${e}-name`,render:e=>i.a.createElement(be.m,{userName:e}),isAggregatable:!0,fieldType:"keyword"}):Object(Xn.f)(e)},{field:"lastSeen",name:gm,sortable:!0,truncateText:!1,mobileOptions:{show:!0},render:e=>i.a.createElement(xa.b,{value:e})},{field:"domain",name:bm,sortable:!1,truncateText:!1,mobileOptions:{show:!0},render:e=>null!=e&&e.length>0?Object(rl.c)({rowItems:[e],attrName:"user.domain",idPrefix:`users-table-${e}-domain`,isAggregatable:!0,fieldType:"keyword"}):Object(Xn.f)(e)}];return e&&a.push({field:"risk",name:i.a.createElement(V.EuiToolTip,{content:Em},i.a.createElement(i.a.Fragment,null,vm," ",i.a.createElement(V.EuiIcon,{color:"subdued",type:"iInCircle",className:"eui-alignTop"}))),truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:e=>null!=e?i.a.createElement(Zn.b,{toolTipContent:i.a.createElement(V.EuiLink,{onClick:()=>t(e)},i.a.createElement(V.EuiText,{size:"xs"},Om(e.toLowerCase()))),severity:e}):Object(Xn.d)()}),a})(h,O)),[h,O]);return i.a.createElement(kl.a,{activePage:f,columns:w,dataTestSubj:`table-${Mm}`,headerCount:t,headerTitle:pm,headerUnit:hm(t),id:r,itemsPerRow:Fm,limit:y,loading:l,loadPage:c,pageOfItems:e,showMorePagesIndicator:u,totalCount:s,updateLimitPagination:v,updateActivePage:S,sorting:d,onChange:j,setQuerySkip:m})};Dm.displayName="UsersTableComponent";const Am=i.a.memo(Dm);var _m=a(838);const Nm=z.i18n.translate("xpack.securitySolution.userTab.errorFetchingsData",{defaultMessage:"Failed to query users data"}),Rm=Object(As.a)(Am),Pm="UsersTable",Lm=({endDate:e,filterQuery:t,indexNames:a,skip:r,setQuery:s,startDate:o,type:l,deleteQuery:c})=>{const{toggleStatus:u}=Object(Ht.a)(Pm),[d,p]=Object(n.useState)(r||!u);Object(n.useEffect)((()=>{p(r||!u)}),[r,u]);const m=Object(n.useMemo)((()=>vs.e.allUsersSelector()),[]),{activePage:g,limit:b,sort:f}=Object(x.a)((e=>m(e))),{loading:y,result:{users:h,pageInfo:E,totalCount:k},search:S,refetch:j,inspect:O}=Object(pc.a)({factoryQueryType:_m.b.users,initialResult:{users:[],totalCount:0,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1}},errorMessage:Nm,abort:d});return Object(n.useEffect)((()=>{d||S({filterQuery:t,defaultIndex:a,timerange:{interval:"12h",from:o,to:e},pagination:Object(uc.a)(g,b),sort:f})}),[S,o,e,t,a,d,g,b,f]),i.a.createElement(Rm,{users:h,deleteQuery:c,fakeTotalCount:Object(v.getOr)(50,"fakeTotalCount",E),id:Pm,inspect:O,loading:y,loadPage:v.noop,refetch:j,showMorePagesIndicator:Object(v.getOr)(!1,"showMorePagesIndicator",E),setQuery:s,totalCount:k,type:l,sort:f,setQuerySkip:p})};Lm.displayName="AllUsersQueryTabBody";var Bm=a(1105);const qm="authenticationsUsersTableQuery",zm=({endDate:e,filterQuery:t,indexNames:a,skip:r,startDate:s,type:l,setQuery:c,deleteQuery:u,userName:d})=>{const p=Object(o.useDispatch)(),{toggleStatus:m}=Object(Ht.a)(qm),[g,b]=Object(n.useState)(r||!m);Object(n.useEffect)((()=>{b(r||!m)}),[r,m]);const f=Object(n.useMemo)((()=>vs.e.authenticationsSelector()),[]),{activePage:y,limit:h}=Object(x.a)((e=>f(e))),[E,{authentications:k,totalCount:S,pageInfo:j,loadPage:O,inspect:w,isInspected:T,refetch:I}]=mc({endDate:e,filterQuery:t,indexNames:a,skip:g,startDate:s,activePage:y,limit:h,stackByField:d?Bm.a.hostName:Bm.a.userName}),C=Object(n.useMemo)((()=>d?[Zl,ec,Hl,Gl,Ql,Kl,Yl]:Vl()),[d]),M=Object(n.useCallback)((e=>p(vs.b.updateTableLimit({usersType:l,limit:e,tableType:vs.c.UsersTableType.authentications}))),[l,p]),F=Object(n.useCallback)((e=>p(vs.b.updateTableActivePage({activePage:e,usersType:l,tableType:vs.c.UsersTableType.authentications}))),[l,p]);return Object(As.b)({queryId:qm,loading:E,refetch:I,setQuery:c,deleteQuery:u,inspect:w}),i.a.createElement(kl.a,{activePage:y,columns:C,dataTestSubj:"table-users-authentications",headerCount:S,headerTitle:Sl,headerUnit:d?Ol(S):jl(S),id:qm,isInspect:T,itemsPerRow:Ul,limit:h,loading:E,loadPage:O,pageOfItems:k,setQuerySkip:b,showMorePagesIndicator:Object(v.getOr)(!1,"showMorePagesIndicator",j),totalCount:Object(v.getOr)(50,"fakeTotalCount",j),updateLimitPagination:M,updateActivePage:F})};zm.displayName="AuthenticationsUserTableComponent";const $m=i.a.memo(zm),Vm=({endDate:e,filterQuery:t,indexNames:a,skip:n,setQuery:r,startDate:s,type:o,deleteQuery:l,userName:c})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(xl.a,lr()({endDate:e,filterQuery:t,id:"usersAuthenticationsHistogramQuery",indexNames:a,setQuery:r,startDate:s},rc)),i.a.createElement($m,{endDate:e,filterQuery:t,indexNames:a,setQuery:r,deleteQuery:l,startDate:s,type:o,skip:n,userName:c}));Vm.displayName="AllUsersQueryTabBody";var Um=a(829);const Hm=(e,t)=>"user.name"===e.entityName&&(null==t||e.entityValue===t),Gm={sort:{field:"anomaly.severity",direction:"desc"}},Qm=({startDate:e,endDate:t,userName:a,skip:r,type:s})=>{const l=Object(o.useDispatch)(),c=Object(ar.a)(),{toggleStatus:u,setToggleStatus:d}=Object(Ht.a)("AnomaliesUserTable"),[p,m]=Object(n.useState)(r||!u);Object(n.useEffect)((()=>{m(r||!u)}),[r,u]);const g=Object(n.useCallback)((e=>{d(e),m(!e)}),[m,d]),{jobIds:b,loading:f}=Object(ml.b)(),y=Object(n.useMemo)((()=>vs.e.usersAnomaliesJobIdFilterSelector()),[]),h=Object(x.a)((e=>y(e,s))),E=Object(n.useCallback)((e=>{l(vs.b.updateUsersAnomaliesJobIdFilter({jobIds:e,usersType:s}))}),[l,s]),v=Object(n.useMemo)((()=>vs.e.usersAnomaliesIntervalSelector()),[]),k=Object(x.a)((e=>v(e,s))),S=Object(n.useCallback)((e=>{l(vs.b.updateUsersAnomaliesInterval({interval:e,usersType:s}))}),[l,s]),[j,O]=Object(nl.a)({startDate:e,endDate:t,skip:p,criteriaFields:Object(Um.a)(s,a),filterQuery:{exists:{field:"user.name"}},jobIds:h.length>0?h:b,aggregationInterval:k}),w=((e,t)=>null==e?[]:e.anomalies.reduce(((e,a)=>{if(Hm(a,t))return[...e,{userName:a.entityValue,anomaly:a}];{const n=((e=[],t)=>{const a=e.find((e=>{const[a,n]=Object(ll.a)(e);return"user.name"===a&&(null==t||n===t)}));return null!=a?Object.values(a)[0]:null})(a.influencers,t);return null!=n?[...e,{userName:n,anomaly:a}]:e}}),[]))(O,a),T=((e,t,a)=>{const n=((e,t)=>[{name:il.s,field:"userName",sortable:!0,render:(e,t)=>Object(rl.b)({rowItem:e,attrName:"user.name",idPrefix:`anomalies-user-table-userName-${Object(sl.a)(t.anomaly)}-userName`,render:e=>i.a.createElement(be.m,{userName:e}),isAggregatable:!0,fieldType:"keyword"})},...Object(ol.a)(e,t)])(t,a);return e===dm.UsersType.details?n.filter((e=>e.name!==il.s)):n})(s,e,t),I={initialPageIndex:0,initialPageSize:10,totalItemCount:w.length,pageSizeOptions:[5,10,20,50],showPerPageOptions:!0};return Object(tr.a)(c)?i.a.createElement(pl.a,{loading:j||f,"data-test-subj":"user-anomalies-tab"},i.a.createElement(Tt.a,{subtitle:`${il.o}: ${I.totalItemCount.toLocaleString()} ${il.r(I.totalItemCount)}`,title:il.a,toggleQuery:g,toggleStatus:u,tooltip:il.q,isInspectDisabled:r,headerFilters:i.a.createElement(V.EuiFlexGroup,null,i.a.createElement(V.EuiFlexItem,null,i.a.createElement(bl.a,{interval:k,onChange:S})),i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(gl.a,{title:il.l,onSelect:E,selectedJobIds:h,jobIds:b})))}),u&&i.a.createElement(ul.a,{"data-test-subj":"user-anomalies-table",columns:T,items:w,pagination:I,sorting:Gm}),(j||f)&&i.a.createElement(ji.a,{"data-test-subj":"anomalies-user-table-loading-panel",overlay:!0,size:"xl"})):null},Wm=i.a.memo(Qm);var Km=a(579);const Ym=[{text:Tm,numberOfRow:5},{text:Im,numberOfRow:10}],Jm=vs.c.UsersTableType.risk,Xm=({data:e,id:t,isInspect:a,loading:r,loadPage:s,setQuerySkip:l,severityCount:c,totalCount:u,type:d})=>{const p=Object(o.useDispatch)(),m=Object(n.useMemo)((()=>vs.e.userRiskScoreSelector()),[]),{activePage:g,limit:b,sort:f}=Object(x.a)((e=>m(e))),y=Object(n.useCallback)((e=>{p(vs.b.updateTableLimit({usersType:d,limit:e,tableType:Jm}))}),[d,p]),h=Object(n.useCallback)((e=>{p(vs.b.updateTableActivePage({activePage:e,usersType:d,tableType:Jm}))}),[d,p]),E=Object(n.useCallback)((e=>{if(null!=e.sort){const t=e.sort;t.direction===f.direction&&t.field===f.field||p(vs.b.updateTableSorting({sort:t,tableType:Jm}))}}),[p,f]),v=Object(n.useCallback)((e=>{p(vs.b.updateUserRiskScoreSeverityFilter({severitySelection:[e]}))}),[p]),k=Object(n.useMemo)((()=>(({dispatchSeverityUpdate:e})=>[{field:"user.name",name:xm,truncateText:!1,mobileOptions:{show:!0},sortable:!0,render:e=>{if(null!=e&&e.length>0){const t=Object(nt.h)(`user-risk-score-table-userName-${e}`);return i.a.createElement(kc.b,{key:t,dataProvider:{and:[],enabled:!0,excluded:!1,id:t,name:e,kqlQuery:"",queryMatch:{field:"user.name",value:e,operator:Sc.d}},render:(t,a,n)=>n.isDragging?i.a.createElement(kc.a,null,i.a.createElement(jc.a,{dataProvider:t})):i.a.createElement(be.m,{userName:e,userTab:dm.UsersTableType.risk}),isAggregatable:!0,fieldType:"keyword"})}return Object(Xn.d)()}},{field:Jn.w.userRiskScore,name:km,truncateText:!0,mobileOptions:{show:!0},sortable:!0,render:e=>null!=e?i.a.createElement("span",{"data-test-subj":"risk-score-truncate",title:`${e}`},Math.round(e)):Object(Xn.d)()},{field:Jn.w.userRisk,name:i.a.createElement(V.EuiToolTip,{content:Sm},i.a.createElement(i.a.Fragment,null,jm," ",i.a.createElement(V.EuiIcon,{color:"subdued",type:"iInCircle",className:"eui-alignTop"}))),truncateText:!1,mobileOptions:{show:!0},sortable:!0,render:t=>null!=t?i.a.createElement(Zn.b,{toolTipContent:i.a.createElement(V.EuiLink,{onClick:()=>e(t)},i.a.createElement(V.EuiText,{size:"xs"},Om(t.toLowerCase()))),severity:t}):Object(Xn.d)()}])({dispatchSeverityUpdate:v})),[v]),S=i.a.createElement(V.EuiFlexGroup,{direction:"column",gutterSize:"s"},i.a.createElement(V.EuiFlexItem,null,i.a.createElement(Eu,{severityCount:c})),i.a.createElement(V.EuiFlexItem,null,i.a.createElement(ku,{severityCount:c}))),j=Object(n.useMemo)((()=>vs.e.userRiskScoreSeverityFilterSelector()),[]),O=Object(x.a)((e=>j(e))),w=Object(n.useCallback)((e=>{p(vs.b.updateUserRiskScoreSeverityFilter({severitySelection:e}))}),[p]);return i.a.createElement(kl.a,{activePage:g,columns:k,dataTestSubj:`table-${Jm}`,headerCount:u,headerFilters:i.a.createElement(Su,{selectedSeverities:O,severityCount:c,title:jm,onSelect:w}),headerSupplement:S,headerTitle:Km.e,headerTooltip:Cm,headerUnit:wm(u),id:t,isInspect:a,itemsPerRow:Ym,limit:b,loading:r,loadPage:s,onChange:E,pageOfItems:e,setQuerySkip:l,showMorePagesIndicator:!1,sorting:f,split:!0,stackHeader:!0,totalCount:u,updateLimitPagination:y,updateActivePage:h})};Xm.displayName="UserRiskScoreTableComponent";const Zm=i.a.memo(Xm);Zm.displayName="UserRiskScoreTable";const eg=Object(As.a)(Zm),tg=({deleteQuery:e,endDate:t,filterQuery:a,setQuery:r,skip:s,startDate:o,type:l})=>{const c=Object(n.useMemo)((()=>vs.e.userRiskScoreSelector()),[]),{activePage:u,limit:d,sort:p}=Object(x.a)((e=>c(e))),m=Object(n.useMemo)((()=>vs.e.userRiskScoreSeverityFilterSelector()),[]),g=Object(x.a)((e=>m(e))),b=Object(n.useMemo)((()=>({cursorStart:u*d,querySize:d})),[u,d]),{toggleStatus:f}=Object(Ht.a)(Yn.b.USERS_BY_RISK),[y,h]=Object(n.useState)(s||!f);Object(n.useEffect)((()=>{h(s||!f)}),[s,f]);const E=Object(n.useMemo)((()=>({from:o,to:t})),[o,t]),{data:k,inspect:S,isDeprecated:j,isInspected:O,isModuleEnabled:w,loading:T,refetch:I,totalCount:C}=Object(Yn.c)({filterQuery:a,pagination:b,riskEntity:Jn.v.user,skip:y,sort:p,timerange:E}),{severityCount:M,loading:F}=Object(Yn.d)({filterQuery:a,riskEntity:Jn.v.user,skip:y}),D={isDisabled:!w&&!T,isDeprecated:j&&!T};return D.isDisabled||D.isDeprecated?i.a.createElement(hs,lr()({},D,{entityType:Jn.v.user,refetch:I,timerange:E})):w&&0===g.length&&k&&0===k.length?i.a.createElement(Yo,{entityType:Jn.v.user,refetch:I}):i.a.createElement(eg,{deleteQuery:e,data:null!=k?k:[],id:Yn.b.USERS_BY_RISK,inspect:S,isInspect:O,loading:T||F,loadPage:v.noop,refetch:I,setQuery:r,setQuerySkip:h,severityCount:null!=M?M:Jn.c,totalCount:C,type:l})};tg.displayName="UserRiskScoreQueryTabBody";const ag=[{query:{bool:{filter:[{bool:{should:[{exists:{field:"user.name"}}],minimum_should_match:1}}]}},meta:{alias:"",disabled:!1,key:"bool",negate:!1,type:"custom",value:'{"query": {"bool": {"filter": [{"bool": {"should": [{"exists": {"field": "user.name"}}],"minimum_should_match": 1}}]}}}'}}],ng=Object(n.memo)((({deleteQuery:e,filterQuery:t,from:a,indexNames:n,isInitializing:r,setQuery:o,to:l,type:c})=>{const u={deleteQuery:e,endDate:l,filterQuery:t,indexNames:n,skip:r||void 0===t,setQuery:o,startDate:a,type:c};return i.a.createElement(P.Switch,null,i.a.createElement(L.Route,{path:`${s.Gc}/:tabName(${dm.UsersTableType.allUsers})`},i.a.createElement(Lm,u)),i.a.createElement(L.Route,{path:`${s.Gc}/:tabName(${dm.UsersTableType.authentications})`},i.a.createElement(Vm,u)),i.a.createElement(L.Route,{path:`${s.Gc}/:tabName(${dm.UsersTableType.anomalies})`},i.a.createElement(al.a,lr()({},u,{AnomaliesTableComponent:Wm}))),i.a.createElement(L.Route,{path:`${s.Gc}/:tabName(${dm.UsersTableType.risk})`},i.a.createElement(tg,u)),i.a.createElement(L.Route,{path:`${s.Gc}/:tabName(${dm.UsersTableType.events})`},i.a.createElement(El.a,lr()({additionalFilters:ag,tableId:ua.c.usersPageEvents},u))))}));ng.displayName="UsersTabs";const ig=e=>`${s.Gc}/${e}`,rg={title:"[Host] User authentications - area ",description:"",visualizationType:"lnsXY",state:{visualization:{axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!0},fittingFunction:"None",gridlinesVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},labelsOrientation:{x:0,yLeft:0,yRight:0},layers:[{accessors:["0eb97c09-a351-4280-97da-944e4bd30dd7"],layerId:"4590dafb-4ac7-45aa-8641-47a3ff0b817c",layerType:"data",seriesType:"area",xAccessor:"49a42fe6-ebe8-4adb-8eed-1966a5297b7e",yConfig:[{color:"#54b399",forAccessor:"0eb97c09-a351-4280-97da-944e4bd30dd7"}]},{accessors:["2b27c80e-a20d-46f1-8fb2-79626ef4563c"],layerId:"31213ae3-905b-4e88-b987-0cccb1f3209f",layerType:"data",seriesType:"area",xAccessor:"33a6163d-0c0a-451d-aa38-8ca6010dd5bf",yConfig:[{color:"#e7664c",forAccessor:"2b27c80e-a20d-46f1-8fb2-79626ef4563c"}]}],legend:{isVisible:!1,position:"right",showSingleSeries:!1},preferredSeriesType:"area",tickLabelsVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},valueLabels:"hide",yLeftExtent:{mode:"full"},yRightExtent:{mode:"full"}},query:{language:"kuery",query:""},filters:[{$state:{store:"appState"},meta:{alias:null,disabled:!1,indexRefName:"filter-index-pattern-0",key:"query",negate:!1,type:"custom",value:'{"bool":{"filter":[{"term":{"event.category":"authentication"}}]}}'},query:{bool:{filter:[{term:{"event.category":"authentication"}}]}}}],datasourceStates:{formBased:{layers:{"31213ae3-905b-4e88-b987-0cccb1f3209f":{columnOrder:["33a6163d-0c0a-451d-aa38-8ca6010dd5bf","2b27c80e-a20d-46f1-8fb2-79626ef4563c"],columns:{"2b27c80e-a20d-46f1-8fb2-79626ef4563c":{customLabel:!0,dataType:"number",filter:{language:"kuery",query:'event.outcome: "failure" '},isBucketed:!1,label:ql.h,operationType:"count",scale:"ratio",sourceField:"___records___"},"33a6163d-0c0a-451d-aa38-8ca6010dd5bf":{dataType:"date",isBucketed:!0,label:"@timestamp",operationType:"date_histogram",params:{interval:"auto"},scale:"interval",sourceField:"@timestamp"}},incompleteColumns:{}},"4590dafb-4ac7-45aa-8641-47a3ff0b817c":{columnOrder:["49a42fe6-ebe8-4adb-8eed-1966a5297b7e","0eb97c09-a351-4280-97da-944e4bd30dd7"],columns:{"0eb97c09-a351-4280-97da-944e4bd30dd7":{customLabel:!0,dataType:"number",filter:{language:"kuery",query:'event.outcome : "success" '},isBucketed:!1,label:ql.m,operationType:"count",scale:"ratio",sourceField:"___records___"},"49a42fe6-ebe8-4adb-8eed-1966a5297b7e":{dataType:"date",isBucketed:!0,label:"@timestamp",operationType:"date_histogram",params:{interval:"auto"},scale:"interval",sourceField:"@timestamp"}},incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-31213ae3-905b-4e88-b987-0cccb1f3209f"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-4590dafb-4ac7-45aa-8641-47a3ff0b817c"}]},sg={title:"[Host] User authentications - bar ",description:"",visualizationType:"lnsXY",state:{visualization:{axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!0},fittingFunction:"None",gridlinesVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},labelsOrientation:{x:0,yLeft:0,yRight:0},layers:[{accessors:["938b445a-a291-4bbc-84fe-4f47b69c20e4"],layerId:"31213ae3-905b-4e88-b987-0cccb1f3209f",layerType:"data",seriesType:"bar_horizontal_stacked",xAccessor:"430e690c-9992-414f-9bce-00812d99a5e7",yConfig:[]},{accessors:["c8165fc3-7180-4f1b-8c87-bc3ea04c6df7"],layerId:"b9acd453-f476-4467-ad38-203e37b73e55",layerType:"data",seriesType:"bar_horizontal_stacked",xAccessor:"e959c351-a3a2-4525-b244-9623f215a8fd",yConfig:[{color:"#e7664c",forAccessor:"c8165fc3-7180-4f1b-8c87-bc3ea04c6df7"}]}],legend:{isVisible:!1,position:"right",showSingleSeries:!1},preferredSeriesType:"bar_horizontal_stacked",tickLabelsVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},valueLabels:"hide",yLeftExtent:{mode:"full"},yRightExtent:{mode:"full"}},query:{language:"kuery",query:""},filters:[{$state:{store:"appState"},meta:{alias:null,disabled:!1,indexRefName:"filter-index-pattern-0",key:"query",negate:!1,type:"custom",value:'{"bool":{"filter":[{"term":{"event.category":"authentication"}}]}}'},query:{bool:{filter:[{term:{"event.category":"authentication"}}]}}}],datasourceStates:{formBased:{layers:{"31213ae3-905b-4e88-b987-0cccb1f3209f":{columnOrder:["430e690c-9992-414f-9bce-00812d99a5e7","938b445a-a291-4bbc-84fe-4f47b69c20e4"],columns:{"430e690c-9992-414f-9bce-00812d99a5e7":{dataType:"string",isBucketed:!0,label:"Filters",operationType:"filters",params:{filters:[{input:{language:"kuery",query:'event.outcome : "success" '},label:ql.m}]},scale:"ordinal"},"938b445a-a291-4bbc-84fe-4f47b69c20e4":{dataType:"number",isBucketed:!1,label:ql.m,operationType:"count",scale:"ratio",sourceField:"___records___"}},incompleteColumns:{}},"b9acd453-f476-4467-ad38-203e37b73e55":{columnOrder:["e959c351-a3a2-4525-b244-9623f215a8fd","c8165fc3-7180-4f1b-8c87-bc3ea04c6df7"],columns:{"c8165fc3-7180-4f1b-8c87-bc3ea04c6df7":{dataType:"number",isBucketed:!1,label:"Fail",operationType:"count",scale:"ratio",sourceField:"___records___"},"e959c351-a3a2-4525-b244-9623f215a8fd":{customLabel:!0,dataType:"string",isBucketed:!0,label:ql.h,operationType:"filters",params:{filters:[{input:{language:"kuery",query:'event.outcome:"failure" '},label:ql.h}]},scale:"ordinal"}},incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-31213ae3-905b-4e88-b987-0cccb1f3209f"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-b9acd453-f476-4467-ad38-203e37b73e55"}]},og=z.i18n.translate("xpack.securitySolution.usersKpiAuthentications.errorSearchDescription",{defaultMessage:"An error has occurred on users kpi authentications search"}),lg=z.i18n.translate("xpack.securitySolution.usersKpiAuthentications.failSearchDescription",{defaultMessage:"Failed to run search on users kpi authentications"}),cg="usersKpiAuthenticationsQuery",ug=z.i18n.translate("xpack.securitySolution.kpiHosts.userAuthentications.title",{defaultMessage:"User authentications"}),dg=z.i18n.translate("xpack.securitySolution.kpiHosts.userAuthentications.successUnitLabel",{defaultMessage:"success"}),pg=z.i18n.translate("xpack.securitySolution.kpiHosts.userAuthentications.failUnitLabel",{defaultMessage:"fail"}),mg=z.i18n.translate("xpack.securitySolution.kpiHosts.userAuthentications.successChartLabel",{defaultMessage:"Succ."}),gg=z.i18n.translate("xpack.securitySolution.kpiHosts.userAuthentications.failChartLabel",{defaultMessage:"Fail"});var bg;!function(e){e.authenticationsSuccess="#54B399",e.authenticationsFailure="#E7664C"}(bg||(bg={}));const fg=[{key:"authentication",fields:[{key:"authenticationsSuccess",name:mg,description:dg,value:null,color:bg.authenticationsSuccess,icon:"check",lensAttributes:{title:"[Host] User authentications - metric success ",description:"",visualizationType:"lnsLegacyMetric",state:{visualization:{accessor:"0eb97c09-a351-4280-97da-944e4bd30dd7",layerId:"4590dafb-4ac7-45aa-8641-47a3ff0b817c",layerType:"data"},query:{language:"kuery",query:""},filters:[{$state:{store:"appState"},meta:{alias:null,disabled:!1,indexRefName:"filter-index-pattern-0",key:"query",negate:!1,type:"custom",value:'{"bool":{"filter":[{"term":{"event.category":"authentication"}}]}}'},query:{bool:{filter:[{term:{"event.category":"authentication"}}]}}}],datasourceStates:{formBased:{layers:{"4590dafb-4ac7-45aa-8641-47a3ff0b817c":{columnOrder:["0eb97c09-a351-4280-97da-944e4bd30dd7"],columns:{"0eb97c09-a351-4280-97da-944e4bd30dd7":{customLabel:!0,dataType:"number",filter:{language:"kuery",query:'event.outcome : "success" '},isBucketed:!1,label:" ",operationType:"count",scale:"ratio",sourceField:"___records___"}},incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-4590dafb-4ac7-45aa-8641-47a3ff0b817c"}]}},{key:"authenticationsFailure",name:gg,description:pg,value:null,color:bg.authenticationsFailure,icon:"cross",lensAttributes:{title:"[Host] User authentications - metric failure ",description:"",visualizationType:"lnsLegacyMetric",state:{visualization:{accessor:"0eb97c09-a351-4280-97da-944e4bd30dd7",layerId:"4590dafb-4ac7-45aa-8641-47a3ff0b817c",layerType:"data"},query:{language:"kuery",query:""},filters:[{$state:{store:"appState"},meta:{alias:null,disabled:!1,indexRefName:"filter-index-pattern-0",key:"query",negate:!1,type:"custom",value:'{"bool":{"filter":[{"term":{"event.category":"authentication"}}]}}'},query:{bool:{filter:[{term:{"event.category":"authentication"}}]}}}],datasourceStates:{formBased:{layers:{"4590dafb-4ac7-45aa-8641-47a3ff0b817c":{columnOrder:["0eb97c09-a351-4280-97da-944e4bd30dd7"],columns:{"0eb97c09-a351-4280-97da-944e4bd30dd7":{dataType:"number",filter:{language:"kuery",query:'event.outcome : "failure" '},isBucketed:!1,label:"",operationType:"count",scale:"ratio",sourceField:"___records___"}},incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-4590dafb-4ac7-45aa-8641-47a3ff0b817c"}]}}],enableAreaChart:!0,enableBarChart:!0,description:ug,areaChartLensAttributes:rg,barChartLensAttributes:sg}],yg=({filterQuery:e,from:t,indexNames:a,to:r,updateDateRange:s,setQuery:o,skip:l})=>{const{toggleStatus:c}=Object(Ht.a)(cg),[u,d]=Object(n.useState)(l||!c),m=Object(B.a)("chartEmbeddablesEnabled");Object(n.useEffect)((()=>{d(l||!c)}),[l,c]);const[g,{refetch:b,id:f,inspect:y,...h}]=(({filterQuery:e,endDate:t,indexNames:a,skip:i=!1,startDate:r})=>{const{data:s}=Object(p.k)().services,o=Object(n.useRef)(v.noop),l=Object(n.useRef)(new AbortController),c=Object(n.useRef)(new Rd.Subscription),[u,d]=Object(n.useState)(!1),[m,g]=Object(n.useState)(null),[b,f]=Object(n.useState)({authenticationsSuccess:0,authenticationsSuccessHistogram:[],authenticationsFailure:0,authenticationsFailureHistogram:[],id:cg,inspect:{dsl:[],response:[]},isInspected:!1,refetch:o.current}),{addError:y,addWarning:h}=Object(Oi.a)(),E=Object(n.useCallback)((e=>{if(null==e||i)return;const t=async()=>{l.current=new AbortController,d(!0),c.current=s.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:l.current.signal}).subscribe({next:e=>{e.isPartial||e.isRunning?e.isPartial&&!e.isRunning&&(d(!1),h(og),c.current.unsubscribe()):(d(!1),f((t=>({...t,authenticationsSuccess:e.authenticationsSuccess,authenticationsSuccessHistogram:e.authenticationsSuccessHistogram,authenticationsFailure:e.authenticationsFailure,authenticationsFailureHistogram:e.authenticationsFailureHistogram,inspect:Object(Bd.getInspectResponse)(e,t.inspect),refetch:o.current}))),c.current.unsubscribe())},error:e=>{d(!1),y(e,{title:lg}),c.current.unsubscribe()}})};c.current.unsubscribe(),l.current.abort(),t(),o.current=t}),[s.search,y,h,i]);return Object(n.useEffect)((()=>{g((n=>{const i={...null!=n?n:{},defaultIndex:a,factoryQueryType:Jn.A.kpiAuthentications,filterQuery:Object(cc.a)(e),timerange:{interval:"12h",from:r,to:t}};return oc()(n,i)?n:i}))}),[a,t,e,r]),Object(n.useEffect)((()=>(E(m),()=>{c.current.unsubscribe(),l.current.abort()})),[m,E]),Object(n.useEffect)((()=>{i&&(d(!1),c.current.unsubscribe(),l.current.abort())}),[i]),[u,b]})({filterQuery:e,endDate:r,indexNames:a,startDate:t,skip:u}),{searchSessionId:E,refetchByRestartingSession:x}=Rp({inputId:K.a.global,queryId:f});return i.a.createElement(Dp,{data:h,id:f,inspect:y,loading:g,fieldsMapping:fg,from:t,to:r,updateDateRange:s,refetch:m?x:b,setQuery:o,setQuerySkip:d,searchSessionId:m?E:void 0})};yg.displayName="UsersKpiAuthenticationsComponent";const hg=i.a.memo(yg),Eg={description:"",state:{datasourceStates:{formBased:{layers:{"416b6fad-1923-4f6a-a2df-b223bb287e30":{columnOrder:["5eea817b-67b7-4268-8ecb-7688d1094721","b00c65ea-32be-4163-bfc8-f795b1ef9d06"],columns:{"5eea817b-67b7-4268-8ecb-7688d1094721":{dataType:"date",isBucketed:!0,label:"@timestamp",operationType:"date_histogram",params:{interval:"auto"},scale:"interval",sourceField:"@timestamp"},"b00c65ea-32be-4163-bfc8-f795b1ef9d06":{customLabel:!0,dataType:"number",isBucketed:!1,label:Object(ql.o)("user.name"),operationType:"unique_count",scale:"ratio",sourceField:"user.name"}},incompleteColumns:{}}}}},filters:[],query:{language:"kuery",query:""},visualization:{axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!1},fittingFunction:"None",gridlinesVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},labelsOrientation:{x:0,yLeft:0,yRight:0},layers:[{accessors:["b00c65ea-32be-4163-bfc8-f795b1ef9d06"],layerId:"416b6fad-1923-4f6a-a2df-b223bb287e30",layerType:"data",seriesType:"area",xAccessor:"5eea817b-67b7-4268-8ecb-7688d1094721"}],legend:{isVisible:!0,position:"right"},preferredSeriesType:"area",tickLabelsVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},valueLabels:"hide",yLeftExtent:{mode:"full"},yRightExtent:{mode:"full"}}},title:"[User] Users - area",visualizationType:"lnsXY",references:[{id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-416b6fad-1923-4f6a-a2df-b223bb287e30",type:"index-pattern"}]},vg=z.i18n.translate("xpack.securitySolution.kpiUsers.totalUsers.title",{defaultMessage:"Users"}),xg=z.i18n.translate("xpack.securitySolution.kpiUsers.totalUsers.errorSearchDescription",{defaultMessage:"An error has occurred on total users kpi search"}),kg=[{key:"users",fields:[{key:"users",value:null,color:Object(V.euiPaletteColorBlind)()[1],icon:"storage",lensAttributes:{description:"",state:{datasourceStates:{formBased:{layers:{"416b6fad-1923-4f6a-a2df-b223bb287e30":{columnOrder:["3e51b035-872c-4b44-824b-fe069c222e91"],columns:{"3e51b035-872c-4b44-824b-fe069c222e91":{dataType:"number",isBucketed:!1,label:" ",operationType:"unique_count",scale:"ratio",sourceField:"user.name"}},incompleteColumns:{}}}}},filters:[],query:{language:"kuery",query:""},visualization:{accessor:"3e51b035-872c-4b44-824b-fe069c222e91",layerId:"416b6fad-1923-4f6a-a2df-b223bb287e30",layerType:"data"}},title:"[User] Users - metric",visualizationType:"lnsLegacyMetric",references:[{id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-416b6fad-1923-4f6a-a2df-b223bb287e30",type:"index-pattern"}]}}],enableAreaChart:!0,description:vg,areaChartLensAttributes:Eg}],Sg="TotalUsersKpiQuery",jg=({filterQuery:e,from:t,indexNames:a,to:r,updateDateRange:s,setQuery:o,skip:l})=>{const{toggleStatus:c}=Object(Ht.a)(Sg),[u,d]=Object(n.useState)(l||!c),p=Object(B.a)("chartEmbeddablesEnabled");Object(n.useEffect)((()=>{d(l||!c)}),[l,c]);const{loading:m,result:g,search:b,refetch:f,inspect:y}=Object(pc.a)({factoryQueryType:_m.b.kpiTotalUsers,initialResult:{users:0,usersHistogram:[]},errorMessage:xg,abort:u||p}),{searchSessionId:h,refetchByRestartingSession:E}=Rp({inputId:K.a.global,queryId:Sg});return Object(n.useEffect)((()=>{u||b({filterQuery:e,defaultIndex:a,timerange:{interval:"12h",from:t,to:r}})}),[b,t,r,e,a,u]),i.a.createElement(Dp,{data:g,id:Sg,inspect:y,loading:m,fieldsMapping:kg,from:t,to:r,updateDateRange:s,refetch:p?E:f,setQuery:o,setQuerySkip:d,searchSessionId:p?h:void 0})},Og=i.a.memo(jg),wg=i.a.memo((({filterQuery:e,from:t,indexNames:a,to:n,setQuery:r,skip:s,updateDateRange:o})=>i.a.createElement(V.EuiFlexGroup,{wrap:!0},i.a.createElement(V.EuiFlexItem,{grow:1},i.a.createElement(Og,{filterQuery:e,from:t,indexNames:a,to:n,updateDateRange:o,setQuery:r,skip:s})),i.a.createElement(V.EuiFlexItem,{grow:2},i.a.createElement(hg,{filterQuery:e,from:t,indexNames:a,to:n,updateDateRange:o,setQuery:r,skip:s})))));wg.displayName="UsersKpiComponent";const Tg=H.a.div.withConfig({displayName:"StyledFullHeightContainer",componentId:"sc-1ndcmza-0"})(["display:flex;flex-direction:column;flex:1 1 auto;"]),Ig=()=>{const e=Object(o.useDispatch)(),t=Object(n.useRef)(null),a=Object(n.useMemo)((()=>rr.d.globalFiltersQuerySelector()),[]),r=Object(n.useMemo)((()=>rr.d.globalQuerySelector()),[]),s=Object(x.a)(r),l=Object(x.a)(a),c=Object(n.useMemo)((()=>vs.e.userRiskScoreSeverityFilterSelector()),[]),u=Object(x.a)((e=>c(e))),{to:d,from:m,deleteQuery:b,setQuery:f,isInitializing:h}=Object(Y.a)(),{globalFullScreen:S}=Object(fe.a)(),{uiSettings:j}=Object(p.k)().services,{tabName:O}=Object(P.useParams)(),w=i.a.useMemo((()=>O===dm.UsersTableType.events?[...l,...ag]:O===dm.UsersTableType.risk?[...Object(nm.a)(u,Jn.v.user),...l]:l),[u,O,l]),{indicesExist:T,indexPattern:I,selectedPatterns:C}=Object(g.d)(),[M,F]=Object(n.useMemo)((()=>Object(od.c)({config:Object(Ki.getEsQueryConfig)(j),indexPattern:I,queries:[s],filters:l})),[l,I,j,s]),[D]=Object(n.useMemo)((()=>Object(od.c)({config:Object(Ki.getEsQueryConfig)(j),indexPattern:I,queries:[s],filters:w})),[I,s,w,j]);Object(cd.a)({id:"UsersQueryId",filterQuery:M,kqlError:F,query:s,startDate:m,endDate:d});const A=Object(n.useCallback)((()=>{var e,a;null===(e=t.current)||void 0===e||null===(a=e.querySelector(".inspectButtonComponent:last-of-type"))||void 0===a||a.focus()}),[t]),_=Object(n.useCallback)((()=>{Object(he.m)()}),[]),N=Object(n.useCallback)((e=>{Object(G.isTab)(e)&&Object(he.l)({containerElement:t.current,keyboardEvent:e,onSkipFocusBeforeEventsTable:A,onSkipFocusAfterEventsTable:_})}),[t,A,_]),R=Object(n.useCallback)((({x:t})=>{if(!t)return;const[a,n]=t;e(Object(te.setAbsoluteRangeDatePicker)({id:K.a.global,from:new Date(a).toISOString(),to:new Date(n).toISOString()}))}),[e]),L=Object(ar.a)(),B=Object(ar.a)().isPlatinumOrTrialLicense,q=Object(n.useMemo)((()=>((e,t)=>{const a=[],n={[dm.UsersTableType.allUsers]:{id:dm.UsersTableType.allUsers,name:Km.a,href:ig(dm.UsersTableType.allUsers),disabled:!1},[dm.UsersTableType.authentications]:{id:dm.UsersTableType.authentications,name:Km.c,href:ig(dm.UsersTableType.authentications),disabled:!1},[dm.UsersTableType.anomalies]:{id:dm.UsersTableType.anomalies,name:Km.b,href:ig(dm.UsersTableType.anomalies),disabled:!1},[dm.UsersTableType.events]:{id:dm.UsersTableType.events,name:Km.d,href:ig(dm.UsersTableType.events),disabled:!1},[dm.UsersTableType.risk]:{id:dm.UsersTableType.risk,name:Km.e,href:ig(dm.UsersTableType.risk),disabled:!1,isBeta:!0,betaOptions:{text:id.i}}};return e||a.push(dm.UsersTableType.anomalies),t||a.push(dm.UsersTableType.risk),Object(v.omit)(a,n)})(Object(tr.a)(L),B)),[L,B]);return i.a.createElement(i.a.Fragment,null,T?i.a.createElement(Tg,{onKeyDown:N,ref:t},i.a.createElement(V.EuiWindowEvent,{event:"resize",handler:v.noop}),i.a.createElement(J.a,null,i.a.createElement(Z.a,{indexPattern:I,id:K.a.global})),i.a.createElement(y.a,{noPadding:S},i.a.createElement(ta.a,{subtitle:i.a.createElement(Xi.a,{indexKey:Jn.k.users,indexNames:C}),border:!0,title:Km.f}),i.a.createElement(wg,{filterQuery:M,indexNames:C,from:m,setQuery:f,to:d,skip:h||!!F,updateDateRange:R}),i.a.createElement(V.EuiSpacer,null),i.a.createElement(ga.a,{navTabs:q}),i.a.createElement(V.EuiSpacer,null),i.a.createElement(ng,{deleteQuery:b,filterQuery:D,from:m,indexNames:C,isInitializing:h,setQuery:f,to:d,type:vs.c.UsersType.page}))):i.a.createElement(aa.a,null),i.a.createElement(E.a,{pageName:k.a.users}))};Ig.displayName="UsersComponent";const Cg=i.a.memo(Ig);var Mg=a(412);const Fg=`${s.Gc}/name/:detailName`,Dg=`${s.Gc}/:tabName(${dm.UsersTableType.allUsers}|${dm.UsersTableType.authentications}|${dm.UsersTableType.anomalies}|${dm.UsersTableType.risk}|${dm.UsersTableType.events}|)`,Ag=`${Fg}/:tabName(${dm.UsersTableType.authentications}|${dm.UsersTableType.anomalies}|${dm.UsersTableType.events}|${dm.UsersTableType.risk})`,_g=i.a.memo((({deleteQuery:e,filterQuery:t,from:a,indexNames:n,isInitializing:r,setQuery:s,to:o,type:l,detailName:c,userDetailFilter:u})=>{const d={deleteQuery:e,endDate:o,filterQuery:t,indexNames:n,skip:r||void 0===t,setQuery:s,startDate:a,type:l,userName:c};return i.a.createElement(P.Switch,null,i.a.createElement(L.Route,{path:`${Fg}/:tabName(${dm.UsersTableType.authentications})`},i.a.createElement(Vm,d)),i.a.createElement(L.Route,{path:`${Fg}/:tabName(${dm.UsersTableType.anomalies})`},i.a.createElement(al.a,lr()({},d,{AnomaliesTableComponent:Wm}))),i.a.createElement(L.Route,{path:`${Fg}/:tabName(${dm.UsersTableType.events})`},i.a.createElement(El.a,lr()({additionalFilters:u,tableId:ua.c.usersPageEvents},d))),i.a.createElement(L.Route,{path:`${Fg}/:tabName(${dm.UsersTableType.risk})`},i.a.createElement(el,lr()({},d,{riskEntity:Jn.v.user,entityName:d.userName}))))}));_g.displayName="UsersDetailsTabs";const Ng=(e,t)=>`${s.Gc}/name/${e}/${t}`,Rg=(e,t,a)=>{const n=[],i={[dm.UsersTableType.authentications]:{id:dm.UsersTableType.authentications,name:Km.c,href:Ng(e,dm.UsersTableType.authentications),disabled:!1},[dm.UsersTableType.anomalies]:{id:dm.UsersTableType.anomalies,name:Km.b,href:Ng(e,dm.UsersTableType.anomalies),disabled:!1},[dm.UsersTableType.events]:{id:dm.UsersTableType.events,name:Km.d,href:Ng(e,dm.UsersTableType.events),disabled:!1},[dm.UsersTableType.risk]:{id:dm.UsersTableType.risk,name:Km.e,href:Ng(e,dm.UsersTableType.risk),disabled:!1,isBeta:!0,betaOptions:{text:id.i}}};return t||n.push(dm.UsersTableType.anomalies),a||n.push(dm.UsersTableType.risk),Object(v.omit)(n,i)};var Pg=a(893),Lg=a(112),Bg=a(921),qg=a(922);const zg="UsersDetailsQueryId",$g=({detailName:e,usersDetailsPagePath:t})=>{const a=Object(o.useDispatch)(),r=Object(ar.a)().isPlatinumOrTrialLicense,s=Object(n.useMemo)((()=>W.b.getTableByIdSelector()),[]),l=Object(x.b)((e=>{var t;return(null!==(t=s(e,ua.c.hostsPageEvents))&&void 0!==t?t:Lg.b).graphEventId})),c=Object(n.useMemo)((()=>rr.d.globalFiltersQuerySelector()),[]),u=Object(n.useMemo)((()=>rr.d.globalQuerySelector()),[]),d=Object(x.a)(u),m=Object(x.a)(c),{signalIndexName:b}=Object(Ji.a)(),{hasKibanaREAD:f,hasIndexRead:h}=Object(oa.a)(),S=f&&h,{to:j,from:O,deleteQuery:w,setQuery:T,isInitializing:I}=Object(Y.a)(),{globalFullScreen:C}=Object(fe.a)(),{services:{uiSettings:M}}=Object(p.k)(),F=Object(n.useMemo)((()=>{return[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:"user.name",value:t=e,params:{query:t}},query:{match:{"user.name":{query:t,type:"phrase"}}}}];var t}),[e]),{indicesExist:D,indexPattern:A,selectedPatterns:_}=Object(g.d)(),[N,R]=Object(n.useMemo)((()=>{try{return[Object(We.buildEsQuery)(A,[d],[...F,...m],Object(Ki.getEsQueryConfig)(M))]}catch(e){return[void 0,e]}}),[m,A,d,M,F]),P=JSON.stringify(N);Object(cd.a)({id:zg,filterQuery:P,kqlError:R,query:d,startDate:O,endDate:j}),Object(n.useEffect)((()=>{a(Object(Mg.setUsersDetailsTablesActivePageToZero)())}),[a,e]);const[L,{inspect:B,userDetails:q,refetch:z}]=Object(qg.a)({id:zg,endDate:j,startDate:O,userName:e,indexNames:_,skip:0===_.length}),$=Object(ar.a)();Object(As.b)({setQuery:T,deleteQuery:w,refetch:z,inspect:B,loading:L,queryId:zg});const U=Object(n.useCallback)(((e,t)=>{const n=Object(nr.a)(e,t);a(Object(te.setAbsoluteRangeDatePicker)({id:K.a.global,from:n.from,to:n.to}))}),[a]),H=Object(n.useMemo)((()=>({field:"user.name",value:e})),[e]);return i.a.createElement(i.a.Fragment,null,D?i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiWindowEvent,{event:"resize",handler:v.noop}),i.a.createElement(J.a,{show:Object(he.n)({globalFullScreen:C,graphEventId:l})},i.a.createElement(Z.a,{indexPattern:A,id:K.a.global})),i.a.createElement(y.a,{noPadding:C},i.a.createElement(ta.a,{subtitle:i.a.createElement(Xi.a,{indexKey:Jn.k.userDetails,indexNames:_,userName:e}),title:e}),i.a.createElement(Zi.a,{criteriaFields:Object(Um.a)(dm.UsersType.details,e),startDate:O,endDate:j,skip:I},(({isLoadingAnomaliesData:t,anomaliesData:a})=>i.a.createElement(Bg.a,{userName:e,id:zg,isInDetailsSidePanel:!1,data:q,anomaliesData:a,isLoadingAnomaliesData:t,loading:L,startDate:O,endDate:j,narrowDateRange:U,indexPatterns:_}))),i.a.createElement(V.EuiHorizontalRule,null),i.a.createElement(V.EuiSpacer,null),S&&i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiFlexGroup,null,i.a.createElement(V.EuiFlexItem,null,i.a.createElement(Yi.a,{signalIndexName:b,entityFilter:H,additionalFilters:N?[N]:[]})),i.a.createElement(V.EuiFlexItem,null,i.a.createElement(ud.a,{entityFilter:H,signalIndexName:b,additionalFilters:N?[N]:[]}))),i.a.createElement(V.EuiSpacer,null)),i.a.createElement(ga.a,{navTabs:Rg(e,Object(tr.a)($),r)}),i.a.createElement(V.EuiSpacer,null),i.a.createElement(_g,{deleteQuery:w,detailName:e,filterQuery:P,from:O,indexNames:_,indexPattern:A,isInitializing:I,userDetailFilter:F,setQuery:T,to:j,type:Pg.b,usersDetailsPagePath:t}))):i.a.createElement(aa.a,null),i.a.createElement(E.a,{pageName:k.a.users}))};$g.displayName="UsersDetailsComponent";const Vg=i.a.memo($g),Ug=i.a.memo((()=>i.a.createElement(P.Switch,null,i.a.createElement(L.Route,{path:Dg},i.a.createElement(Cg,null)),i.a.createElement(L.Route,{path:`${s.Gc}/externalAlerts`,render:({location:{search:e=""}})=>i.a.createElement(P.Redirect,{to:{pathname:`${s.Gc}/${dm.UsersTableType.events}`,search:`${e}&onlyExternalAlerts=true`}})}),i.a.createElement(L.Route,{path:Ag,render:({match:{params:{detailName:e}}})=>i.a.createElement(Vg,{usersDetailsPagePath:Fg,detailName:decodeURIComponent(e)})}),i.a.createElement(L.Route,{path:Fg,render:({match:{params:{detailName:e}},location:{search:t=""}})=>i.a.createElement(P.Redirect,{to:{pathname:`${s.Gc}/name/${e}/${dm.UsersTableType.authentications}`,search:t}})}),i.a.createElement(L.Route,{path:`${s.Gc}/:detailName/:tabName?`,render:({match:{params:{detailName:e,tabName:t=dm.UsersTableType.authentications}},location:{search:a=""}})=>i.a.createElement(P.Redirect,{to:{pathname:`${s.Gc}/name/${e}/${t}`,search:a}})}),i.a.createElement(L.Route,{path:s.Gc,render:({location:{search:e=""}})=>i.a.createElement(P.Redirect,{to:{pathname:`${s.Gc}/${dm.UsersTableType.allUsers}`,search:e}})}))));Ug.displayName="UsersContainer";const Hg=[{path:s.Gc,component:()=>i.a.createElement(_,null,i.a.createElement(r.TrackApplicationView,{viewId:k.a.users},i.a.createElement(Ug,null)))}];var Gg=a(902),Qg=a(287),Wg=a(324);const Kg=H()(V.EuiPanel).withConfig({displayName:"Panel",componentId:"sc-4inzan-0"})(["overflow:hidden;"]);Kg.displayName="Panel";const Yg=i.a.memo((({children:e})=>i.a.createElement("section",{className:"siemEmbeddable","data-test-subj":"siemEmbeddable"},i.a.createElement(Kg,{paddingSize:"none",hasBorder:!0},e))));Yg.displayName="Embeddable",a(1257);var Jg=a(74),Xg=a(75);const Zg=z.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.embeddableHeaderTitle",{defaultMessage:"Network map"}),eb=z.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.embeddableHeaderHelp",{defaultMessage:"Map configuration help"}),tb=z.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.embeddablePanelTitle",{defaultMessage:"Source -> Destination Point-to-Point Map"}),ab=z.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.sourceLayerLabel",{defaultMessage:"Source Point"}),nb=z.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.destinationLayerLabel",{defaultMessage:"Destination Point"}),ib=z.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.clientLayerLabel",{defaultMessage:"Client Point"}),rb=z.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.serverLayerLabel",{defaultMessage:"Server Point"}),sb=z.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.lineLayerLabel",{defaultMessage:"Line"}),ob=z.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.errorCreatingMapEmbeddableTitle",{defaultMessage:"Error creating Map Embeddable"}),lb=z.i18n.translate("xpack.securitySolution.components.embeddables.indexPatternsMissingPrompt.errorTitle",{defaultMessage:"Required index patterns not configured"}),cb=z.i18n.translate("xpack.securitySolution.components.embeddables.indexPatternsMissingPrompt.errorButtonLabel",{defaultMessage:"Configure index patterns"}),ub=z.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.errorTitle",{defaultMessage:"Error loading map features"}),db=z.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.hostTitle",{defaultMessage:"Host"}),pb=z.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.sourceIPTitle",{defaultMessage:"Source IP"}),mb=z.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.destinationIPTitle",{defaultMessage:"Destination IP"}),gb=z.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.clientIPTitle",{defaultMessage:"Client IP"}),bb=z.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.serverIPTitle",{defaultMessage:"Server IP"}),fb=z.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.sourceDomainTitle",{defaultMessage:"Source domain"}),yb=z.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.destinationDomainTitle",{defaultMessage:"Destination domain"}),hb=z.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.clientDomainTitle",{defaultMessage:"Client domain"}),Eb=z.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.serverDomainTitle",{defaultMessage:"Server domain"}),vb=z.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.locationTitle",{defaultMessage:"Location"}),xb=z.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.asnTitle",{defaultMessage:"ASN"}),kb=z.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.lineContent.sourceLabel",{defaultMessage:"Source"}),Sb=z.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.lineContent.destinationLabel",{defaultMessage:"Destination"}),jb=z.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.lineContent.clientLabel",{defaultMessage:"Client"}),Ob=z.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.lineContent.serverLabel",{defaultMessage:"Server"}),wb=Object(V.euiPaletteColorBlind)(),Tb={"host.name":db,"source.ip":pb,"source.domain":fb,"source.geo.country_iso_code":vb,"source.as.organization.name":xb},Ib={"host.name":db,"destination.ip":mb,"destination.domain":yb,"destination.geo.country_iso_code":vb,"destination.as.organization.name":xb},Cb={"host.name":db,"client.ip":gb,"client.domain":hb,"client.geo.country_iso_code":vb,"client.as.organization.name":xb},Mb={"host.name":db,"server.ip":bb,"server.domain":Eb,"server.geo.country_iso_code":vb,"server.as.organization.name":xb},Fb={...Tb,...Ib,...Cb,...Mb},Db="sum_of_source.bytes",Ab={source:{metricField:"client.bytes",geoField:"client.geo.location",tooltipProperties:Object.keys(Cb),label:ib},destination:{metricField:"server.bytes",geoField:"server.geo.location",tooltipProperties:Object.keys(Mb),label:rb}},_b={default:{source:{metricField:"source.bytes",geoField:"source.geo.location",tooltipProperties:Object.keys(Tb),label:ab},destination:{metricField:"destination.bytes",geoField:"destination.geo.location",tooltipProperties:Object.keys(Ib),label:nb}},"apm-*":Ab,"traces-apm*,logs-apm*,metrics-apm*,apm-*":Ab},Nb=e=>[{sourceDescriptor:{type:Xg.SOURCE_TYPES.EMS_TMS,isAutoSelect:!0},id:Ye.a.v4(),label:null,minZoom:0,maxZoom:24,alpha:1,visible:!0,style:null,type:Xg.LAYER_TYPE.EMS_VECTOR_TILE},...e.reduce(((e,{title:t,id:a})=>{var n,i,r,s,o;const l={id:Ye.a.v4(),label:t,sourceDescriptor:null,type:Xg.LAYER_TYPE.LAYER_GROUP,visible:!0};return[...e,Lb(t,a,l.id,null!==(n=_b[t])&&void 0!==n?n:_b.default),Pb(t,a,l.id,null!==(i=null===(r=_b[t])||void 0===r?void 0:r.destination)&&void 0!==i?i:_b.default.destination),Rb(t,a,l.id,null!==(s=null===(o=_b[t])||void 0===o?void 0:o.source)&&void 0!==s?s:_b.default.source),l]}),[])],Rb=(e,t,a,n)=>({sourceDescriptor:{id:Ye.a.v4(),type:"ES_SEARCH",applyGlobalQuery:!0,geoField:n.geoField,filterByMapBounds:!1,tooltipProperties:n.tooltipProperties,useTopHits:!1,topHitsTimeField:"@timestamp",topHitsSize:1,indexPatternId:t},style:{type:"VECTOR",properties:{fillColor:{type:"STATIC",options:{color:wb[1]}},lineColor:{type:"STATIC",options:{color:"#FFFFFF"}},lineWidth:{type:"STATIC",options:{size:2}},iconSize:{type:"STATIC",options:{size:8}},iconOrientation:{type:"STATIC",options:{orientation:0}},symbolizeAs:{options:{value:"icon"}},icon:{type:"STATIC",options:{value:"home"}}}},id:Ye.a.v4(),parent:a,label:`${e} | ${n.label}`,minZoom:0,maxZoom:24,alpha:1,visible:!0,type:Xg.LAYER_TYPE.GEOJSON_VECTOR,query:{query:"",language:"kuery"},joins:[]}),Pb=(e,t,a,n)=>({sourceDescriptor:{id:Ye.a.v4(),type:"ES_SEARCH",scalingType:Xg.SCALING_TYPES.LIMIT,applyGlobalQuery:!0,geoField:n.geoField,filterByMapBounds:!0,tooltipProperties:n.tooltipProperties,useTopHits:!1,topHitsTimeField:"@timestamp",topHitsSize:1,indexPatternId:t},style:{type:"VECTOR",properties:{fillColor:{type:"STATIC",options:{color:wb[2]}},lineColor:{type:"STATIC",options:{color:"#FFFFFF"}},lineWidth:{type:"STATIC",options:{size:2}},iconSize:{type:"STATIC",options:{size:8}},iconOrientation:{type:"STATIC",options:{orientation:0}},symbolizeAs:{options:{value:"icon"}},icon:{type:"STATIC",options:{value:"marker"}}}},id:Ye.a.v4(),parent:a,label:`${e} | ${n.label}`,minZoom:0,maxZoom:24,alpha:1,visible:!0,type:Xg.LAYER_TYPE.GEOJSON_VECTOR,query:{query:"",language:"kuery"}}),Lb=(e,t,a,n)=>({sourceDescriptor:{type:Xg.SOURCE_TYPES.ES_PEW_PEW,applyGlobalQuery:!0,id:Ye.a.v4(),indexPatternId:t,sourceGeoField:n.source.geoField,destGeoField:n.destination.geoField,metrics:[{type:"sum",field:n.source.metricField,label:n.source.metricField},{type:"sum",field:n.destination.metricField,label:n.destination.metricField}]},style:{type:"VECTOR",properties:{fillColor:{type:"STATIC",options:{color:"#1EA593"}},lineColor:{type:"STATIC",options:{color:wb[1]}},lineWidth:{type:"DYNAMIC",options:{field:{label:"count",name:"doc_count",origin:"source"},minSize:1,maxSize:8,fieldMetaOptions:{isEnabled:!0,sigma:3}}},iconSize:{type:"STATIC",options:{size:10}},iconOrientation:{type:"STATIC",options:{orientation:0}},symbolizeAs:{options:{value:"icon"}},icon:{type:"STATIC",options:{value:"airfield"}}}},id:Ye.a.v4(),parent:a,label:`${e} | ${sb}`,minZoom:0,maxZoom:24,alpha:.5,visible:!0,type:Xg.LAYER_TYPE.GEOJSON_VECTOR,query:{query:"",language:"kuery"}}),Bb=()=>{const{docLinks:e}=Object(p.k)().services,t=`${Object(p.e)()}/app`;return i.a.createElement(V.EuiEmptyPrompt,{iconType:"gisApp",title:i.a.createElement("h2",null,lb),titleSize:"xs",body:i.a.createElement(i.a.Fragment,null,i.a.createElement("p",null,i.a.createElement(dr.FormattedMessage,{defaultMessage:"To display map data, you must define SIEM indices ({defaultIndex}) and Kibana index patterns with matching glob patterns. When using {beats}, you can run the {setup} command on your hosts to automatically create the index patterns. For example: {example}.",id:"xpack.securitySolution.components.embeddables.indexPatternsMissingPrompt.errorDescription1",values:{defaultIndex:i.a.createElement("a",{href:`${t}/management/kibana/settings`,rel:"noopener noreferrer",target:"_blank"},"securitySolution:defaultIndex"),beats:i.a.createElement("a",{href:`${e.links.libbeat.getStarted}`,rel:"noopener noreferrer",target:"_blank"},"beats"),setup:i.a.createElement(V.EuiCode,null,"setup"),example:i.a.createElement(V.EuiCode,null,"./packetbeat setup")}})),i.a.createElement("p",null,i.a.createElement(dr.FormattedMessage,{defaultMessage:"You can also configure index patterns manually in Kibana.",id:"xpack.securitySolution.components.embeddables.indexPatternsMissingPrompt.errorDescription2"}))),actions:i.a.createElement(V.EuiButton,{href:`${t}/management/kibana/dataViews`,color:"primary",target:"_blank",fill:!0},cb)})};Bb.displayName="IndexPatternsMissingPromptComponent";const qb=i.a.memo(Bb);qb.displayName="IndexPatternsMissingPrompt",H()(V.EuiIcon).withConfig({displayName:"Icon",componentId:"sc-s0r863-0"})(["margin-right:",";"],_s.euiLightVars.euiSizeS).displayName="Icon";const zb=({featureIndex:e,totalFeatures:t,previousFeature:a,nextFeature:n})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiHorizontalRule,{margin:"s"}),i.a.createElement(V.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center",gutterSize:"xs"},i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiText,{size:"xs"},((e,t)=>z.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.footerLabel",{values:{currentFeature:e,totalFeatures:t},defaultMessage:"{currentFeature} of {totalFeatures} {totalFeatures, plural, =1 {feature} other {features}}"}))(e+1,t))),i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement("span",null,i.a.createElement(V.EuiButtonIcon,{"data-test-subj":"previous-feature-button",color:"text",onClick:a,iconType:"arrowLeft","aria-label":"Next",isDisabled:e<=0}),i.a.createElement(V.EuiButtonIcon,{"data-test-subj":"next-feature-button",color:"text",onClick:n,iconType:"arrowRight","aria-label":"Next",isDisabled:e>=t-1})))));zb.displayName="ToolTipFooterComponent";const $b=i.a.memo(zb);$b.displayName="ToolTipFooter";var Vb=a(423);const Ub=H()(V.EuiBadge).withConfig({displayName:"FlowBadge",componentId:"sc-120vo88-0"})(["height:45px;min-width:85px;"]),Hb=H()(V.EuiFlexGroup).withConfig({displayName:"EuiFlexGroupStyled",componentId:"sc-120vo88-1"})(["margin:0 auto;"]),Gb=({contextId:e,featureProps:t})=>{const a=t.reduce(((e,t)=>{var a;const n=null!==(a=t.getRawValue())&&void 0!==a?a:[];return{...e,[t.getPropertyKey()]:Array.isArray(n)?n:[n]}}),{}),n=Object.keys(a).includes(Db);return i.a.createElement(V.EuiFlexGroup,{justifyContent:"center",gutterSize:"none"},i.a.createElement(V.EuiFlexItem,null,i.a.createElement(Ub,{color:"hollow"},i.a.createElement(Hb,{direction:"column"},i.a.createElement(V.EuiFlexItem,{grow:!1},n?kb:jb)))),i.a.createElement(Vb.e,{contextId:e,destinationBytes:n?a["sum_of_destination.bytes"]:a["sum_of_server.bytes"],eventId:`map-line-tooltip-${e}`,sourceBytes:n?a[Db]:a["sum_of_client.bytes"]}),i.a.createElement(V.EuiFlexItem,null,i.a.createElement(Ub,{color:"hollow"},i.a.createElement(Hb,null,i.a.createElement(V.EuiFlexItem,{grow:!1},n?Sb:Ob)))))};Gb.displayName="LineToolTipContentComponent";const Qb=i.a.memo(Gb);Qb.displayName="LineToolTipContent";var Wb=a(160);const Kb=({contextId:e,featureProps:t})=>{const a=Object(n.useMemo)((()=>t.map((t=>{var a;const n=t.getPropertyKey(),r=null!==(a=t.getRawValue())&&void 0!==a?a:[];return{title:Fb[n],description:i.a.createElement(i.a.Fragment,null,null!=r?i.a.createElement(ti.a,{rowItems:Array.isArray(r)?r:[r],attrName:n,idPrefix:`map-point-tooltip-${e}-${n}-${r}`,render:e=>Jb(n,e)}):Object(Xn.d)())}}))),[e,t]);return i.a.createElement(Wb.d,{listItems:a})};Kb.displayName="PointToolTipContentComponent";const Yb=i.a.memo(Kb);Yb.displayName="PointToolTipContent";const Jb=(e,t)=>{if(""===t)return Object(Xn.f)(t);if(["host.name"].includes(e))return i.a.createElement(be.d,{hostName:t});if(["source.ip","destination.ip"].includes(e)){const a=e.split(".")[0];return i.a.createElement(be.h,{ip:t,flowTarget:a})}return i.a.createElement(i.a.Fragment,null,t)},Xb=({closeTooltip:e,features:t=[],getLayerName:a,loadFeatureProperties:r,loadFeatureGeometry:s})=>{const[o,l]=Object(n.useState)(!0),[c,u]=Object(n.useState)(!1),[d,p]=Object(n.useState)(!1),[m,g]=Object(n.useState)(0),[b,f]=Object(n.useState)([]),[y,h]=Object(n.useState)(null),[,E]=Object(n.useState)(""),v=Object(n.useCallback)((()=>{null!=e&&(e(),g(0))}),[e]),x=Object(n.useCallback)((()=>{g((e=>e-1)),u(!0)}),[]),k=Object(n.useCallback)((()=>{g((e=>e+1)),u(!0)}),[]),S=Object(n.useMemo)((()=>d?i.a.createElement(V.EuiFlexGroup,{justifyContent:"spaceAround"},i.a.createElement(V.EuiFlexItem,{grow:!1},ub)):o&&!c?i.a.createElement(V.EuiFlexGroup,{justifyContent:"spaceAround"},i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiLoadingSpinner,{size:"m"}))):i.a.createElement("div",null,null!=y&&"LineString"===y.type?i.a.createElement(Qb,{contextId:`${t[m].layerId}-${t[m].id}-${m}`,featureProps:b}):i.a.createElement(Yb,{contextId:`${t[m].layerId}-${t[m].id}-${m}`,featureProps:b}),t.length>1&&i.a.createElement($b,{featureIndex:m,totalFeatures:t.length,previousFeature:x,nextFeature:k}),c&&i.a.createElement(ji.a,{"data-test-subj":"loading-panel",overlay:!0,size:"m"}))),[y,m,b,t,k,x,d,o,c]);return Object(n.useEffect)((()=>{0!==t.length&&null!=a&&null!=r&&null!=s&&(c||l(!0),p(!1),(async()=>{if(null!=t[m]){const e=t[m].layerId,n=t[m].id;try{const i=s({layerId:e,featureId:n}),[o,c]=await Promise.all([r({layerId:e,properties:t[m].mbProperties}),a(e)]);f(o),h(i),c&&E(c)}catch(e){p(!0)}finally{l(!1),u(!1)}}})())}),[m,t,a,c,s,r]),i.a.createElement(V.EuiOutsideClickDetector,{onOutsideClick:v},S)};Xb.displayName="MapToolTipComponent";const Zb=i.a.memo(Xb);Zb.displayName="MapToolTip";var ef=a(177);const tf="network_map_visbile",af=H.a.div.attrs((()=>({className:"siemEmbeddable__map"}))).withConfig({displayName:"EmbeddableMap",componentId:"sc-1t0ky4k-0"})([".embPanel{border:none;box-shadow:none;}.mapToolbarOverlay__button{display:none;}",""],(({maintainRatio:e})=>e&&Object(U.css)(["padding-top:calc(3 / 4 * 100%);position:relative;@media only screen and (min-width:","){padding-top:calc(9 / 32 * 100%);}@media only screen and (min-width:1441px) and (min-height:901px){padding-top:calc(9 / 21 * 100%);}.embPanel{bottom:0;left:0;position:absolute;right:0;top:0;}"],(({theme:e})=>e.eui.euiBreakpoints.m)))),nf=H()(V.EuiText).withConfig({displayName:"StyledEuiText",componentId:"sc-1t0ky4k-1"})(["margin-right:16px;"]),rf=H()(V.EuiAccordion).withConfig({displayName:"StyledEuiAccordion",componentId:"sc-1t0ky4k-2"})(["& .euiAccordion__triggerWrapper{padding:16px;}"]);af.displayName="EmbeddableMap";const sf=({endDate:e,filters:t,query:a,setQuery:r,startDate:s})=>{var o;const[l,c]=i.a.useState(void 0),{services:u}=Object(p.k)(),{storage:d}=u,[m,f]=Object(n.useState)(!1),[y,h]=Object(n.useState)(!1),[E,v]=Object(n.useState)(null===(o=d.get(tf))||void 0===o||o),[,k]=Object(Wg.g)(),S=Object(n.useMemo)((()=>ef.d.getSourcererDataViewsSelector()),[]),{kibanaDataViews:j}=Object(x.a)((e=>S(e))),{selectedPatterns:O}=Object(g.d)(b.SourcererScopeName.default),[w,T]=Object(n.useState)(j.filter((e=>O.includes(e.title)))),I=i.a.useMemo((()=>Object(Qg.c)()),[]);Object(n.useEffect)((()=>{T((e=>{const t=j.filter((e=>O.includes(e.title)));return oc()(t,e)?e:(0===t.length&&f(!0),t)}))}),[j,O]),Object(n.useEffect)((()=>{let n=!0;return null==l&&O.length>0&&async function(){try{const o=await(async(e,t,a,n,r,s,o,l)=>{const c=l.getEmbeddableFactory(Jg.MAP_SAVED_OBJECT_TYPE);if(!c)throw new Error("Map embeddable factory undefined");const u={title:tb,attributes:{title:""},id:Ye.a.v4(),filters:e,hidePanelTitles:!0,query:a,timeRange:{from:new Date(n).toISOString(),to:new Date(r).toISOString()},viewMode:pp.ViewMode.VIEW,isLayerTOCOpen:!1,openTOCDetails:[],hideFilterActions:!1,mapCenter:{lon:-1.05469,lat:15.96133,zoom:1},disabledActions:["CUSTOM_TIME_RANGE","CUSTOM_TIME_RANGE_BADGE"]},d=await c.create(u);if(!d)throw new Error("Map embeddable is undefined");return Object(pp.isErrorEmbeddable)(d)||(d.setRenderTooltipContent((({addFilters:e,closeTooltip:t,features:a,isLocked:n,getLayerName:r,loadFeatureProperties:s,loadFeatureGeometry:l})=>{const c={addFilters:e,closeTooltip:t,features:a,isLocked:n,getLayerName:r,loadFeatureProperties:s,loadFeatureGeometry:l};return i.a.createElement(Qg.b,lr()({node:o},c))})),d.setLayerList(Nb(t))),s({id:"embeddedMap",inspect:null,loading:!1,refetch:()=>d.reload()}),d})(t,w,a,s,e,r,I,u.embeddable);n&&(0===w.length?h(!0):(c(o),h(!1)))}catch(e){n&&(Object(Wg.d)(ob,[e.message],k),f(!0))}}(),()=>{n=!1}}),[k,e,l,t,w,a,I,u.embeddable,O,r,s]),Object(n.useEffect)((()=>{null==l||Object(pp.isErrorEmbeddable)(l)||(async()=>{null!=l&&(await l.setLayerList(Nb(w)),l.reload())})()}),[l,w]),Object(n.useEffect)((()=>{null!=l&&l.updateInput({query:a})}),[l,a]),Object(n.useEffect)((()=>{null!=l&&l.updateInput({filters:t})}),[l,t]),Object(n.useEffect)((()=>{if(null!=l&&null!=s&&null!=e){const t={from:new Date(s).toISOString(),to:new Date(e).toISOString()};l.updateInput({timeRange:t})}}),[l,s,e]);const C=Object(n.useCallback)((e=>{d.set(tf,e),v(e)}),[d]),M=Object(n.useMemo)((()=>E?i.a.createElement(Yg,null,i.a.createElement(Qg.a,{node:I},i.a.createElement(Zb,null)),i.a.createElement(af,{maintainRatio:!y},y?i.a.createElement(qb,{"data-test-subj":"missing-prompt"}):null!=l?i.a.createElement(u.embeddable.EmbeddablePanel,{embeddable:l}):i.a.createElement(ji.a,{"data-test-subj":"loading-panel",overlay:!0,size:"xl"}))):null),[l,y,I,u,E]);return m?null:i.a.createElement(rf,{onToggle:C,id:"network-map",arrowDisplay:"right",arrowProps:{color:"primary","data-test-subj":`${E}-toggle-network-map`},buttonContent:i.a.createElement("strong",null,Zg),extraAction:i.a.createElement(nf,{size:"xs"},i.a.createElement(V.EuiLink,{href:`${u.docLinks.links.siem.networkMap}`,target:"_blank"},eb)),paddingSize:"none",initialIsOpen:E},M)};sf.displayName="EmbeddedMapComponent";const of=i.a.memo(sf);of.displayName="EmbeddedMap";const lf=z.i18n.translate("xpack.securitySolution.networkKpiDns.errorSearchDescription",{defaultMessage:"An error has occurred on network kpi dns search"}),cf=z.i18n.translate("xpack.securitySolution.networkKpiDns.failSearchDescription",{defaultMessage:"Failed to run search on network kpi dns"}),uf="networkKpiDnsQuery",df=[{key:"dnsQueries",fields:[{key:"dnsQueries",value:null,lensAttributes:{title:"[Network] DNS metric",description:"",visualizationType:"lnsLegacyMetric",state:{visualization:{layerId:"cea37c70-8f91-43bf-b9fe-72d8c049f6a3",accessor:"0374e520-eae0-4ac1-bcfe-37565e7fc9e3",layerType:"data",colorMode:"None",autoScaleMetricAlignment:"left"},query:{query:"",language:"kuery"},filters:[{meta:{index:"196d783b-3779-4c39-898e-6606fe633d05",type:"custom",disabled:!1,negate:!1,alias:null,key:"query",value:'{"bool":{"should":[{"exists":{"field":"dns.question.name"}},{"term":{"suricata.eve.dns.type":{"value":"query"}}},{"exists":{"field":"zeek.dns.query"}}],"minimum_should_match":1}}'},$state:{store:"appState"},query:{bool:{should:[{exists:{field:"dns.question.name"}},{term:{"suricata.eve.dns.type":{value:"query"}}},{exists:{field:"zeek.dns.query"}}],minimum_should_match:1}}}],datasourceStates:{formBased:{layers:{"cea37c70-8f91-43bf-b9fe-72d8c049f6a3":{columns:{"0374e520-eae0-4ac1-bcfe-37565e7fc9e3":{label:"",dataType:"number",operationType:"count",isBucketed:!1,scale:"ratio",sourceField:"___records___",customLabel:!0}},columnOrder:["0374e520-eae0-4ac1-bcfe-37565e7fc9e3"],incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-cea37c70-8f91-43bf-b9fe-72d8c049f6a3"},{type:"index-pattern",name:"196d783b-3779-4c39-898e-6606fe633d05",id:"{dataViewId}"}]}}],description:z.i18n.translate("xpack.securitySolution.kpiNetwork.dnsQueries.title",{defaultMessage:"DNS queries"})}],pf=({filterQuery:e,from:t,indexNames:a,to:r,updateDateRange:s,setQuery:o,skip:l})=>{const{toggleStatus:c}=Object(Ht.a)(uf),[u,d]=Object(n.useState)(l||!c),m=Object(B.a)("chartEmbeddablesEnabled");Object(n.useEffect)((()=>{d(l||!c)}),[l,c]);const[g,{refetch:b,id:f,inspect:y,...h}]=(({filterQuery:e,endDate:t,indexNames:a,skip:i=!1,startDate:r})=>{const{data:s}=Object(p.k)().services,o=Object(n.useRef)(v.noop),l=Object(n.useRef)(new AbortController),c=Object(n.useRef)(new Rd.Subscription),[u,d]=Object(n.useState)(!1),[m,g]=Object(n.useState)(null),[b,f]=Object(n.useState)({dnsQueries:0,id:uf,inspect:{dsl:[],response:[]},isInspected:!1,refetch:o.current}),{addError:y,addWarning:h}=Object(Oi.a)(),E=Object(n.useCallback)((e=>{if(null==e||i)return;const t=async()=>{l.current=new AbortController,d(!0),c.current=s.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:l.current.signal}).subscribe({next:e=>{Object(Ki.isCompleteResponse)(e)?(d(!1),f((t=>({...t,dnsQueries:e.dnsQueries,inspect:Object(Bd.getInspectResponse)(e,t.inspect),refetch:o.current}))),c.current.unsubscribe()):Object(Ki.isErrorResponse)(e)&&(d(!1),h(lf),c.current.unsubscribe())},error:e=>{d(!1),y(e,{title:cf}),c.current.unsubscribe()}})};c.current.unsubscribe(),l.current.abort(),t(),o.current=t}),[s.search,y,h,i]);return Object(n.useEffect)((()=>{g((n=>{const i={...null!=n?n:{},defaultIndex:a,factoryQueryType:Jn.p.dns,filterQuery:Object(cc.a)(e),timerange:{interval:"12h",from:r,to:t}};return oc()(n,i)?n:i}))}),[a,t,e,r]),Object(n.useEffect)((()=>(E(m),()=>{c.current.unsubscribe(),l.current.abort()})),[m,E]),Object(n.useEffect)((()=>{i&&(d(!1),c.current.unsubscribe(),l.current.abort())}),[i]),[u,b]})({filterQuery:e,endDate:r,indexNames:a,startDate:t,skip:u||m}),{searchSessionId:E,refetchByRestartingSession:x}=Rp({inputId:K.a.global,queryId:f});return i.a.createElement(Dp,{data:h,id:f,inspect:y,loading:g,fieldsMapping:df,from:t,to:r,updateDateRange:s,refetch:m?x:b,setQuery:o,setQuerySkip:d,searchSessionId:m?E:void 0})},mf=i.a.memo(pf),gf=z.i18n.translate("xpack.securitySolution.networkKpiNetworkEvents.errorSearchDescription",{defaultMessage:"An error has occurred on network kpi network events search"}),bf=z.i18n.translate("xpack.securitySolution.networkKpiNetworkEvents.failSearchDescription",{defaultMessage:"Failed to run search on network kpi network events"}),ff="networkKpiNetworkEventsQuery",yf=z.i18n.translate("xpack.securitySolution.kpiNetwork.networkEvents.title",{defaultMessage:"Network events"}),hf=[{key:"networkEvents",fields:[{key:"networkEvents",value:null,color:Object(V.euiPaletteColorBlind)()[1],lensAttributes:{title:"[Network] Network events",description:"",visualizationType:"lnsLegacyMetric",state:{visualization:{layerId:"eaadfec7-deaa-4aeb-a403-3b4e516416d2",accessor:"370ebd07-5ce0-4f46-a847-0e363c50d037",layerType:"data",autoScaleMetricAlignment:"left"},query:{query:"",language:"kuery"},filters:[{meta:{index:"security-solution-default",alias:null,negate:!1,disabled:!1,type:"exists",key:"source.ip",value:"exists"},query:{exists:{field:"source.ip"}},$state:{store:"appState"}},{meta:{index:"security-solution-default",alias:null,negate:!1,disabled:!1,type:"exists",key:"destination.ip",value:"exists"},query:{exists:{field:"destination.ip"}},$state:{store:"appState"}}],datasourceStates:{formBased:{layers:{"eaadfec7-deaa-4aeb-a403-3b4e516416d2":{columns:{"370ebd07-5ce0-4f46-a847-0e363c50d037":{label:" ",dataType:"number",operationType:"count",isBucketed:!1,scale:"ratio",sourceField:"___records___",customLabel:!0}},columnOrder:["370ebd07-5ce0-4f46-a847-0e363c50d037"],incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-eaadfec7-deaa-4aeb-a403-3b4e516416d2"},{type:"index-pattern",name:"861af17d-be25-45a3-a82d-d6e697b76e51",id:"{dataViewId}"},{type:"index-pattern",name:"09617767-f732-410e-af53-bebcbd0bf4b9",id:"{dataViewId}"}]}}],description:yf}],Ef=({filterQuery:e,from:t,indexNames:a,to:r,updateDateRange:s,setQuery:o,skip:l})=>{const{toggleStatus:c}=Object(Ht.a)(ff),[u,d]=Object(n.useState)(l||!c),m=Object(B.a)("chartEmbeddablesEnabled");Object(n.useEffect)((()=>{d(l||!c)}),[l,c]);const[g,{refetch:b,id:f,inspect:y,...h}]=(({filterQuery:e,endDate:t,indexNames:a,skip:i=!1,startDate:r})=>{const{data:s}=Object(p.k)().services,o=Object(n.useRef)(v.noop),l=Object(n.useRef)(new AbortController),c=Object(n.useRef)(new Rd.Subscription),[u,d]=Object(n.useState)(!1),[m,g]=Object(n.useState)(null),[b,f]=Object(n.useState)({networkEvents:0,id:ff,inspect:{dsl:[],response:[]},isInspected:!1,refetch:o.current}),{addError:y,addWarning:h}=Object(Oi.a)(),E=Object(n.useCallback)((e=>{if(null==e||i)return;const t=async()=>{l.current=new AbortController,d(!0),c.current=s.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:l.current.signal}).subscribe({next:e=>{Object(Ki.isCompleteResponse)(e)?(d(!1),f((t=>({...t,networkEvents:e.networkEvents,inspect:Object(Bd.getInspectResponse)(e,t.inspect),refetch:o.current}))),c.current.unsubscribe()):Object(Ki.isErrorResponse)(e)&&(d(!1),h(gf),c.current.unsubscribe())},error:e=>{d(!1),y(e,{title:bf}),c.current.unsubscribe()}})};c.current.unsubscribe(),l.current.abort(),t(),o.current=t}),[s.search,y,h,i]);return Object(n.useEffect)((()=>{g((n=>{const i={...null!=n?n:{},defaultIndex:a,factoryQueryType:Jn.p.networkEvents,filterQuery:Object(cc.a)(e),timerange:{interval:"12h",from:r,to:t}};return oc()(n,i)?n:i}))}),[a,t,e,r]),Object(n.useEffect)((()=>(E(m),()=>{c.current.unsubscribe(),l.current.abort()})),[m,E]),Object(n.useEffect)((()=>{i&&(d(!1),c.current.unsubscribe(),l.current.abort())}),[i]),[u,b]})({filterQuery:e,endDate:r,indexNames:a,startDate:t,skip:u||m}),{searchSessionId:E,refetchByRestartingSession:x}=Rp({inputId:K.a.global,queryId:f});return i.a.createElement(Dp,{data:h,id:f,inspect:y,loading:g,fieldsMapping:hf,from:t,to:r,updateDateRange:s,refetch:m?x:b,setQuery:o,setQuerySkip:d,searchSessionId:m?E:void 0})},vf=i.a.memo(Ef),xf=z.i18n.translate("xpack.securitySolution.networkKpiTlsHandshakes.errorSearchDescription",{defaultMessage:"An error has occurred on network kpi tls handshakes search"}),kf=z.i18n.translate("xpack.securitySolution.networkKpiTlsHandshakes.failSearchDescription",{defaultMessage:"Failed to run search on network kpi tls handshakes"}),Sf="networkKpiTlsHandshakesQuery",jf=[{key:"tlsHandshakes",fields:[{key:"tlsHandshakes",value:null,lensAttributes:{title:"[Network] TLS handshakes",description:"",visualizationType:"lnsLegacyMetric",state:{visualization:{layerId:"1f48a633-8eee-45ae-9471-861227e9ca03",accessor:"21052b6b-5504-4084-a2e2-c17f772345cf",layerType:"data",autoScaleMetricAlignment:"left"},query:{query:"(source.ip: * or destination.ip: *) and (tls.version: * or suricata.eve.tls.version: * or zeek.ssl.version: * )",language:"kuery"},filters:[{meta:{index:"32ee22d9-2e77-4aee-8073-87750e92c3ee",type:"custom",disabled:!1,negate:!1,alias:null,key:"query",value:'{"bool":{"should":[{"exists":{"field":"source.ip"}},{"exists":{"field":"destination.ip"}}],"minimum_should_match":1}}'},$state:{store:"appState"},query:{bool:{should:[{exists:{field:"source.ip"}},{exists:{field:"destination.ip"}}],minimum_should_match:1}}},{meta:{index:"1e93f984-9374-4755-a198-de57751533c6",type:"custom",disabled:!1,negate:!1,alias:null,key:"query",value:'{"bool":{"should":[{"exists":{"field":"tls.version"}},{"exists":{"field":"suricata.eve.tls.version"}},{"exists":{"field":"zeek.ssl.version"}}],"minimum_should_match":1}}'},$state:{store:"appState"},query:{bool:{should:[{exists:{field:"tls.version"}},{exists:{field:"suricata.eve.tls.version"}},{exists:{field:"zeek.ssl.version"}}],minimum_should_match:1}}}],datasourceStates:{formBased:{layers:{"1f48a633-8eee-45ae-9471-861227e9ca03":{columns:{"21052b6b-5504-4084-a2e2-c17f772345cf":{label:" ",dataType:"number",operationType:"count",isBucketed:!1,scale:"ratio",sourceField:"___records___",customLabel:!0}},columnOrder:["21052b6b-5504-4084-a2e2-c17f772345cf"],incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-1f48a633-8eee-45ae-9471-861227e9ca03"}]}}],description:z.i18n.translate("xpack.securitySolution.kpiNetwork.tlsHandshakes.title",{defaultMessage:"TLS handshakes"})}],Of=({filterQuery:e,from:t,indexNames:a,to:r,updateDateRange:s,setQuery:o,skip:l})=>{const{toggleStatus:c}=Object(Ht.a)(Sf),[u,d]=Object(n.useState)(l||!c),m=Object(B.a)("chartEmbeddablesEnabled");Object(n.useEffect)((()=>{d(l||!c)}),[l,c]);const[g,{refetch:b,id:f,inspect:y,...h}]=(({filterQuery:e,endDate:t,indexNames:a,skip:i=!1,startDate:r})=>{const{data:s}=Object(p.k)().services,o=Object(n.useRef)(v.noop),l=Object(n.useRef)(new AbortController),c=Object(n.useRef)(new Rd.Subscription),[u,d]=Object(n.useState)(!1),[m,g]=Object(n.useState)(null),[b,f]=Object(n.useState)({tlsHandshakes:0,id:Sf,inspect:{dsl:[],response:[]},isInspected:!1,refetch:o.current}),{addError:y,addWarning:h}=Object(Oi.a)(),E=Object(n.useCallback)((e=>{if(null==e||i)return;const t=async()=>{l.current=new AbortController,d(!0),c.current=s.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:l.current.signal}).subscribe({next:e=>{Object(Ki.isCompleteResponse)(e)?(d(!1),f((t=>({...t,tlsHandshakes:e.tlsHandshakes,inspect:Object(Bd.getInspectResponse)(e,t.inspect),refetch:o.current}))),c.current.unsubscribe()):Object(Ki.isErrorResponse)(e)&&(d(!1),h(xf),c.current.unsubscribe())},error:e=>{d(!1),y(e,{title:kf}),c.current.unsubscribe()}})};c.current.unsubscribe(),l.current.abort(),t(),o.current=t}),[s.search,y,h,i]);return Object(n.useEffect)((()=>{g((n=>{const i={...null!=n?n:{},defaultIndex:a,factoryQueryType:Jn.p.tlsHandshakes,filterQuery:Object(cc.a)(e),timerange:{interval:"12h",from:r,to:t}};return oc()(n,i)?n:i}))}),[a,t,e,r]),Object(n.useEffect)((()=>(E(m),()=>{c.current.unsubscribe(),l.current.abort()})),[m,E]),Object(n.useEffect)((()=>{i&&(d(!1),c.current.unsubscribe(),l.current.abort())}),[i]),[u,b]})({filterQuery:e,endDate:r,indexNames:a,startDate:t,skip:u||m}),{searchSessionId:E,refetchByRestartingSession:x}=Rp({inputId:K.a.global,queryId:f});return i.a.createElement(Dp,{data:h,id:f,inspect:y,loading:g,fieldsMapping:jf,from:t,to:r,updateDateRange:s,refetch:m?x:b,setQuery:o,setQuerySkip:d,searchSessionId:m?E:void 0})},wf=i.a.memo(Of),Tf=z.i18n.translate("xpack.securitySolution.networkKpiUniqueFlows.errorSearchDescription",{defaultMessage:"An error has occurred on network kpi unique flows search"}),If=z.i18n.translate("xpack.securitySolution.networkKpiUniqueFlows.failSearchDescription",{defaultMessage:"Failed to run search on network kpi unique flows"}),Cf="networkKpiUniqueFlowsQuery",Mf=[{key:"uniqueFlowId",fields:[{key:"uniqueFlowId",value:null,lensAttributes:{title:"[Network] Unique flow IDs",description:"",visualizationType:"lnsLegacyMetric",state:{visualization:{layerId:"5d46d48f-6ce8-46be-a797-17ad50642564",accessor:"a27f3503-9c73-4fc1-86bb-12461dae4b70",layerType:"data",autoScaleMetricAlignment:"left"},query:{query:"source.ip: * or destination.ip: * ",language:"kuery"},filters:[{meta:{index:"c01edc8a-90ce-4d49-95f0-76954a034eb2",type:"custom",disabled:!1,negate:!1,alias:null,key:"query",value:'{"bool":{"should":[{"exists":{"field":"source.ip"}},{"exists":{"field":"destination.ip"}}],"minimum_should_match":1}}'},$state:{store:"appState"},query:{bool:{should:[{exists:{field:"source.ip"}},{exists:{field:"destination.ip"}}],minimum_should_match:1}}}],datasourceStates:{formBased:{layers:{"5d46d48f-6ce8-46be-a797-17ad50642564":{columns:{"a27f3503-9c73-4fc1-86bb-12461dae4b70":{label:" ",dataType:"number",operationType:"unique_count",scale:"ratio",sourceField:"network.community_id",isBucketed:!1,customLabel:!0}},columnOrder:["a27f3503-9c73-4fc1-86bb-12461dae4b70"],incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-5d46d48f-6ce8-46be-a797-17ad50642564"}]}}],description:z.i18n.translate("xpack.securitySolution.kpiNetwork.uniqueFlowIds.title",{defaultMessage:"Unique flow IDs"})}],Ff=({filterQuery:e,from:t,indexNames:a,to:r,updateDateRange:s,setQuery:o,skip:l})=>{const{toggleStatus:c}=Object(Ht.a)(Cf),[u,d]=Object(n.useState)(l||!c),m=Object(B.a)("chartEmbeddablesEnabled");Object(n.useEffect)((()=>{d(l||!c)}),[l,c]);const[g,{refetch:b,id:f,inspect:y,...h}]=(({filterQuery:e,endDate:t,indexNames:a,skip:i=!1,startDate:r})=>{const{data:s}=Object(p.k)().services,o=Object(n.useRef)(v.noop),l=Object(n.useRef)(new AbortController),c=Object(n.useRef)(new Rd.Subscription),[u,d]=Object(n.useState)(!1),[m,g]=Object(n.useState)(null),[b,f]=Object(n.useState)({uniqueFlowId:0,id:Cf,inspect:{dsl:[],response:[]},isInspected:!1,refetch:o.current}),{addError:y,addWarning:h}=Object(Oi.a)(),E=Object(n.useCallback)((e=>{if(null==e||i)return;const t=async()=>{l.current=new AbortController,d(!0),c.current=s.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:l.current.signal}).subscribe({next:e=>{Object(Ki.isCompleteResponse)(e)?(d(!1),f((t=>({...t,uniqueFlowId:e.uniqueFlowId,inspect:Object(Bd.getInspectResponse)(e,t.inspect),refetch:o.current}))),c.current.unsubscribe()):Object(Ki.isErrorResponse)(e)&&(d(!1),h(Tf),c.current.unsubscribe())},error:e=>{d(!1),y(e,{title:If}),c.current.unsubscribe()}})};c.current.unsubscribe(),l.current.abort(),t(),o.current=t}),[s.search,y,h,i]);return Object(n.useEffect)((()=>{g((n=>{const i={...null!=n?n:{},defaultIndex:a,factoryQueryType:Jn.p.uniqueFlows,filterQuery:Object(cc.a)(e),timerange:{interval:"12h",from:r,to:t}};return oc()(n,i)?n:i}))}),[a,t,e,r]),Object(n.useEffect)((()=>(E(m),()=>{c.current.unsubscribe(),l.current.abort()})),[m,E]),Object(n.useEffect)((()=>{i&&(d(!1),c.current.unsubscribe(),l.current.abort())}),[i]),[u,b]})({filterQuery:e,endDate:r,indexNames:a,startDate:t,skip:u||m}),{searchSessionId:E,refetchByRestartingSession:x}=Rp({inputId:K.a.global,queryId:f});return i.a.createElement(Dp,{data:h,id:f,inspect:y,loading:g,fieldsMapping:Mf,from:t,to:r,updateDateRange:s,refetch:m?x:b,setQuery:o,setQuerySkip:d,searchSessionId:m?E:void 0})},Df=i.a.memo(Ff),Af=z.i18n.translate("xpack.securitySolution.networkKpiUniquePrivateIps.errorSearchDescription",{defaultMessage:"An error has occurred on network kpi unique private ips search"}),_f=z.i18n.translate("xpack.securitySolution.networkKpiUniquePrivateIps.failSearchDescription",{defaultMessage:"Failed to run search on network kpi unique private ips"}),Nf="networkKpiUniquePrivateIpsQuery",Rf=z.i18n.translate("xpack.securitySolution.kpiNetwork.uniquePrivateIps.title",{defaultMessage:"Unique private IPs"}),Pf=z.i18n.translate("xpack.securitySolution.kpiNetwork.uniquePrivateIps.sourceUnitLabel",{defaultMessage:"source"}),Lf=z.i18n.translate("xpack.securitySolution.kpiNetwork.uniquePrivateIps.destinationUnitLabel",{defaultMessage:"destination"}),Bf=z.i18n.translate("xpack.securitySolution.kpiNetwork.uniquePrivateIps.sourceChartLabel",{defaultMessage:"Src."}),qf=z.i18n.translate("xpack.securitySolution.kpiNetwork.uniquePrivateIps.destinationChartLabel",{defaultMessage:"Dest."}),zf={title:"[Network] Unique private IPs - area chart",description:"",visualizationType:"lnsXY",state:{visualization:{legend:{isVisible:!1,position:"right",showSingleSeries:!1},valueLabels:"hide",fittingFunction:"None",yLeftExtent:{mode:"full"},yRightExtent:{mode:"full"},axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!0},tickLabelsVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},labelsOrientation:{x:0,yLeft:0,yRight:0},gridlinesVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},preferredSeriesType:"area",layers:[{layerId:"38aa6532-6bf9-4c8f-b2a6-da8d32f7d0d7",seriesType:"area",accessors:["5f317308-cfbb-4ee5-bfb9-07653184fabf"],layerType:"data",xAccessor:"662cd5e5-82bf-4325-a703-273f84b97e09",yConfig:[{forAccessor:"5f317308-cfbb-4ee5-bfb9-07653184fabf",color:"#d36186"}]},{layerId:"72dc4b99-b07d-4dc9-958b-081d259e11fa",seriesType:"area",accessors:["ac1eb80c-ddde-46c4-a90c-400261926762"],layerType:"data",xAccessor:"36444b8c-7e10-4069-8298-6c1b46912be2",yConfig:[{forAccessor:"ac1eb80c-ddde-46c4-a90c-400261926762",color:"#9170b8"}]}]},query:{query:"",language:"kuery"},filters:[],datasourceStates:{formBased:{layers:{"38aa6532-6bf9-4c8f-b2a6-da8d32f7d0d7":{columns:{"662cd5e5-82bf-4325-a703-273f84b97e09":{label:"@timestamp",dataType:"date",operationType:"date_histogram",sourceField:"@timestamp",isBucketed:!0,scale:"interval",params:{interval:"auto"}},"5f317308-cfbb-4ee5-bfb9-07653184fabf":{label:ql.l,dataType:"number",operationType:"unique_count",scale:"ratio",sourceField:"source.ip",isBucketed:!1,customLabel:!0,filter:{query:'"source.ip": "10.0.0.0/8" or "source.ip": "192.168.0.0/16" or "source.ip": "172.16.0.0/12" or "source.ip": "fd00::/8"',language:"kuery"}}},columnOrder:["662cd5e5-82bf-4325-a703-273f84b97e09","5f317308-cfbb-4ee5-bfb9-07653184fabf"],incompleteColumns:{}},"72dc4b99-b07d-4dc9-958b-081d259e11fa":{columns:{"36444b8c-7e10-4069-8298-6c1b46912be2":{label:"@timestamp",dataType:"date",operationType:"date_histogram",sourceField:"@timestamp",isBucketed:!0,scale:"interval",params:{interval:"auto"}},"ac1eb80c-ddde-46c4-a90c-400261926762":{label:ql.g,dataType:"number",operationType:"unique_count",scale:"ratio",sourceField:"destination.ip",isBucketed:!1,filter:{query:'"destination.ip": "10.0.0.0/8" or "destination.ip": "192.168.0.0/16" or "destination.ip": "172.16.0.0/12" or "destination.ip": "fd00::/8"',language:"kuery"}}},columnOrder:["36444b8c-7e10-4069-8298-6c1b46912be2","ac1eb80c-ddde-46c4-a90c-400261926762"],incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-38aa6532-6bf9-4c8f-b2a6-da8d32f7d0d7"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-72dc4b99-b07d-4dc9-958b-081d259e11fa"}]},$f={title:"[Network] Unique private IPs - bar chart",description:"",visualizationType:"lnsXY",state:{visualization:{legend:{isVisible:!1,position:"right",showSingleSeries:!1},valueLabels:"hide",fittingFunction:"None",yLeftExtent:{mode:"full"},yRightExtent:{mode:"full"},axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!0},tickLabelsVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},labelsOrientation:{x:0,yLeft:0,yRight:0},gridlinesVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},preferredSeriesType:"bar_horizontal_stacked",layers:[{layerId:"e406bf4f-942b-41ac-b516-edb5cef06ec8",accessors:["5acd4c9d-dc3b-4b21-9632-e4407944c36d"],position:"top",seriesType:"bar_horizontal_stacked",showGridlines:!1,layerType:"data",yConfig:[{forAccessor:"5acd4c9d-dc3b-4b21-9632-e4407944c36d",color:"#d36186"}],xAccessor:"d9c438c5-f776-4436-9d20-d62dc8c03be8"},{layerId:"38aa6532-6bf9-4c8f-b2a6-da8d32f7d0d7",seriesType:"bar_horizontal_stacked",accessors:["d27e0966-daf9-41f4-9033-230cf1e76dc9"],layerType:"data",yConfig:[{forAccessor:"d27e0966-daf9-41f4-9033-230cf1e76dc9",color:"#9170b8"}],xAccessor:"4607c585-3af3-43b9-804f-e49b27796d79"}]},query:{query:"",language:"kuery"},filters:[],datasourceStates:{formBased:{layers:{"e406bf4f-942b-41ac-b516-edb5cef06ec8":{columns:{"5acd4c9d-dc3b-4b21-9632-e4407944c36d":{label:Object(ql.o)("source.ip"),dataType:"number",isBucketed:!1,operationType:"unique_count",scale:"ratio",sourceField:"source.ip",filter:{query:'source.ip: "10.0.0.0/8" or source.ip: "192.168.0.0/16" or source.ip: "172.16.0.0/12" or source.ip: "fd00::/8"',language:"kuery"}},"d9c438c5-f776-4436-9d20-d62dc8c03be8":{label:"Filters",dataType:"string",operationType:"filters",scale:"ordinal",isBucketed:!0,params:{filters:[{input:{query:"",language:"kuery"},label:ql.l}]}}},columnOrder:["d9c438c5-f776-4436-9d20-d62dc8c03be8","5acd4c9d-dc3b-4b21-9632-e4407944c36d"],incompleteColumns:{}},"38aa6532-6bf9-4c8f-b2a6-da8d32f7d0d7":{columns:{"d27e0966-daf9-41f4-9033-230cf1e76dc9":{label:Object(ql.o)("destination.ip"),dataType:"number",isBucketed:!1,operationType:"unique_count",scale:"ratio",sourceField:"destination.ip",filter:{query:'"destination.ip": "10.0.0.0/8" or "destination.ip": "192.168.0.0/16" or "destination.ip": "172.16.0.0/12" or "destination.ip": "fd00::/8"',language:"kuery"}},"4607c585-3af3-43b9-804f-e49b27796d79":{label:"Filters",dataType:"string",operationType:"filters",scale:"ordinal",isBucketed:!0,params:{filters:[{input:{query:"",language:"kuery"},label:ql.g}]}}},columnOrder:["4607c585-3af3-43b9-804f-e49b27796d79","d27e0966-daf9-41f4-9033-230cf1e76dc9"],incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-e406bf4f-942b-41ac-b516-edb5cef06ec8"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-38aa6532-6bf9-4c8f-b2a6-da8d32f7d0d7"}]},Vf=Object(V.euiPaletteColorBlind)(),Uf=[{key:"UniqueIps",fields:[{key:"uniqueSourcePrivateIps",value:null,name:Bf,description:Pf,color:Vf[2],icon:"visMapCoordinate",lensAttributes:{description:"",state:{datasourceStates:{formBased:{layers:{"cea37c70-8f91-43bf-b9fe-72d8c049f6a3":{columnOrder:["bd17c23e-4f83-4108-8005-2669170d064b"],columns:{"bd17c23e-4f83-4108-8005-2669170d064b":{customLabel:!0,dataType:"number",isBucketed:!1,label:"",operationType:"unique_count",scale:"ratio",sourceField:"source.ip",filter:{query:'source.ip: "10.0.0.0/8" or source.ip: "192.168.0.0/16" or source.ip: "172.16.0.0/12" or source.ip: "fd00::/8"',language:"kuery"}}},incompleteColumns:{}}}}},filters:[],query:{language:"kuery",query:""},visualization:{accessor:"bd17c23e-4f83-4108-8005-2669170d064b",layerId:"cea37c70-8f91-43bf-b9fe-72d8c049f6a3",layerType:"data"}},title:"[Network] Unique private IPs - source metric",visualizationType:"lnsLegacyMetric",references:[{id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-cea37c70-8f91-43bf-b9fe-72d8c049f6a3",type:"index-pattern"}]}},{key:"uniqueDestinationPrivateIps",value:null,name:qf,description:Lf,color:Vf[3],icon:"visMapCoordinate",lensAttributes:{description:"",state:{datasourceStates:{formBased:{layers:{"cea37c70-8f91-43bf-b9fe-72d8c049f6a3":{columnOrder:["bd17c23e-4f83-4108-8005-2669170d064b"],columns:{"bd17c23e-4f83-4108-8005-2669170d064b":{customLabel:!0,dataType:"number",isBucketed:!1,label:"",operationType:"unique_count",scale:"ratio",sourceField:"destination.ip",filter:{language:"kuery",query:'"destination.ip": "10.0.0.0/8" or "destination.ip": "192.168.0.0/16" or "destination.ip": "172.16.0.0/12" or "destination.ip": "fd00::/8"'}}},incompleteColumns:{}}}}},filters:[],query:{language:"kuery",query:""},visualization:{accessor:"bd17c23e-4f83-4108-8005-2669170d064b",layerId:"cea37c70-8f91-43bf-b9fe-72d8c049f6a3",layerType:"data"}},title:"[Network] Unique private IPs - destination metric",visualizationType:"lnsLegacyMetric",references:[{id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern",type:"index-pattern"},{id:"{dataViewId}",name:"indexpattern-datasource-layer-cea37c70-8f91-43bf-b9fe-72d8c049f6a3",type:"index-pattern"}]}}],description:Rf,enableAreaChart:!0,enableBarChart:!0,areaChartLensAttributes:zf,barChartLensAttributes:$f}],Hf=({filterQuery:e,from:t,indexNames:a,to:r,updateDateRange:s,setQuery:o,skip:l})=>{const{toggleStatus:c}=Object(Ht.a)(Nf),[u,d]=Object(n.useState)(l||!c),m=Object(B.a)("chartEmbeddablesEnabled");Object(n.useEffect)((()=>{d(l||!c)}),[l,c]);const[g,{refetch:b,id:f,inspect:y,...h}]=(({filterQuery:e,endDate:t,indexNames:a,skip:i=!1,startDate:r})=>{const{data:s}=Object(p.k)().services,o=Object(n.useRef)(v.noop),l=Object(n.useRef)(new AbortController),c=Object(n.useRef)(new Rd.Subscription),[u,d]=Object(n.useState)(!1),[m,g]=Object(n.useState)(null),[b,f]=Object(n.useState)({uniqueDestinationPrivateIps:0,uniqueDestinationPrivateIpsHistogram:null,uniqueSourcePrivateIps:0,uniqueSourcePrivateIpsHistogram:null,id:Nf,inspect:{dsl:[],response:[]},isInspected:!1,refetch:o.current}),{addError:y,addWarning:h}=Object(Oi.a)(),E=Object(n.useCallback)((e=>{if(null==e||i)return;const t=async()=>{l.current=new AbortController,d(!0),c.current=s.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:l.current.signal}).subscribe({next:e=>{Object(Ki.isCompleteResponse)(e)?(d(!1),f((t=>({...t,uniqueDestinationPrivateIps:e.uniqueDestinationPrivateIps,uniqueDestinationPrivateIpsHistogram:e.uniqueDestinationPrivateIpsHistogram,uniqueSourcePrivateIps:e.uniqueSourcePrivateIps,uniqueSourcePrivateIpsHistogram:e.uniqueSourcePrivateIpsHistogram,inspect:Object(Bd.getInspectResponse)(e,t.inspect),refetch:o.current}))),c.current.unsubscribe()):Object(Ki.isErrorResponse)(e)&&(d(!1),h(Af),c.current.unsubscribe())},error:e=>{d(!1),y(e,{title:_f}),c.current.unsubscribe()}})};c.current.unsubscribe(),l.current.abort(),t(),o.current=t}),[s.search,y,h,i]);return Object(n.useEffect)((()=>{g((n=>{const i={...null!=n?n:{},defaultIndex:a,factoryQueryType:Jn.p.uniquePrivateIps,filterQuery:Object(cc.a)(e),timerange:{interval:"12h",from:r,to:t}};return oc()(n,i)?n:i}))}),[a,t,e,r]),Object(n.useEffect)((()=>(E(m),()=>{c.current.unsubscribe(),l.current.abort()})),[m,E]),Object(n.useEffect)((()=>{i&&(d(!1),c.current.unsubscribe(),l.current.abort())}),[i]),[u,b]})({filterQuery:e,endDate:r,indexNames:a,startDate:t,skip:u||m}),{searchSessionId:E,refetchByRestartingSession:x}=Rp({inputId:K.a.global,queryId:f});return i.a.createElement(Dp,{data:h,id:f,inspect:y,loading:g,fieldsMapping:Uf,from:t,to:r,updateDateRange:s,refetch:m?x:b,setQuery:o,setQuerySkip:d,searchSessionId:m?E:void 0})},Gf=i.a.memo(Hf),Qf=i.a.memo((({filterQuery:e,from:t,indexNames:a,to:n,setQuery:r,skip:s,updateDateRange:o})=>i.a.createElement(V.EuiFlexGroup,{wrap:!0},i.a.createElement(V.EuiFlexItem,{grow:1},i.a.createElement(V.EuiFlexGroup,{wrap:!0},i.a.createElement(V.EuiFlexItem,null,i.a.createElement(vf,{filterQuery:e,from:t,indexNames:a,to:n,updateDateRange:o,setQuery:r,skip:s})),i.a.createElement(V.EuiFlexItem,null,i.a.createElement(mf,{filterQuery:e,from:t,indexNames:a,to:n,updateDateRange:o,setQuery:r,skip:s}))),i.a.createElement(V.EuiSpacer,{size:"l"}),i.a.createElement(V.EuiFlexGroup,{wrap:!0},i.a.createElement(V.EuiFlexItem,null,i.a.createElement(Df,{filterQuery:e,from:t,indexNames:a,to:n,updateDateRange:o,setQuery:r,skip:s})),i.a.createElement(V.EuiFlexItem,null,i.a.createElement(wf,{filterQuery:e,from:t,indexNames:a,to:n,updateDateRange:o,setQuery:r,skip:s})))),i.a.createElement(V.EuiFlexItem,{grow:1},i.a.createElement(Gf,{filterQuery:e,from:t,indexNames:a,to:n,updateDateRange:o,setQuery:r,skip:s})))));Qf.displayName="NetworkKpiComponent";var Wf=a(111),Kf=a(830),Yf=a(413),Jf=a(272);const Xf=H.a.div.withConfig({displayName:"StyledFullHeightContainer",componentId:"sc-5donvf-0"})(["display:flex;flex-direction:column;flex:1 1 auto;"]),Zf=i.a.memo((({hasMlUserPermissions:e,capabilitiesFetched:t})=>{const a=Object(o.useDispatch)(),r=Object(n.useRef)(null),s=Object(n.useMemo)((()=>W.b.getTableByIdSelector()),[]),l=Object(x.b)((e=>{var t;return(null!==(t=s(e,u.g.networkPageEvents))&&void 0!==t?t:Q.a).graphEventId})),c=Object(n.useMemo)((()=>rr.d.globalFiltersQuerySelector()),[]),d=Object(n.useMemo)((()=>rr.d.globalQuerySelector()),[]),m=Object(x.a)(d),b=Object(x.a)(c),{to:f,from:h,setQuery:S,isInitializing:j}=Object(Y.a)(),{globalFullScreen:O}=Object(fe.a)(),w=Object(p.k)(),{tabName:T}=Object(P.useParams)(),I=w.services.application.capabilities.maps.show,C=Object(n.useMemo)((()=>T===Jf.a.events?[...b,...ed.f]:b),[T,b]),M=Object(n.useCallback)((({x:e})=>{if(!e)return;const[t,n]=e;a(Object(te.setAbsoluteRangeDatePicker)({id:K.a.global,from:new Date(t).toISOString(),to:new Date(n).toISOString()}))}),[a]),{indicesExist:F,indexPattern:D,selectedPatterns:A}=Object(g.d)(),_=Object(n.useCallback)((()=>{var e,t;null===(e=r.current)||void 0===e||null===(t=e.querySelector(".inspectButtonComponent:last-of-type"))||void 0===t||t.focus()}),[r]),N=Object(n.useCallback)((()=>{Object(he.m)()}),[]),R=Object(n.useCallback)((e=>{Object(G.isTab)(e)&&Object(he.l)({containerElement:r.current,keyboardEvent:e,onSkipFocusBeforeEventsTable:_,onSkipFocusAfterEventsTable:N})}),[r,_,N]),[L,B]=Object(od.c)({config:Object(Ki.getEsQueryConfig)(w.services.uiSettings),indexPattern:D,queries:[m],filters:b}),[q]=Object(od.c)({config:Object(Ki.getEsQueryConfig)(w.services.uiSettings),indexPattern:D,queries:[m],filters:C});return Object(cd.a)({id:"NetworkQueryId",filterQuery:L,kqlError:B,query:m,startDate:h,endDate:f}),i.a.createElement(i.a.Fragment,null,F?i.a.createElement(Xf,{onKeyDown:R,ref:r},i.a.createElement(V.EuiWindowEvent,{event:"resize",handler:v.noop}),i.a.createElement(J.a,{show:Object(he.n)({globalFullScreen:O,graphEventId:l})},i.a.createElement(Z.a,{indexPattern:D,id:K.a.global})),i.a.createElement(y.a,{noPadding:O},i.a.createElement(ye.a,{show:!O},i.a.createElement(ta.a,{subtitle:i.a.createElement(Xi.a,{indexKey:Jn.k.network,indexNames:A}),title:Yf.h,border:!0}),I&&i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiPanel,{hasBorder:!0,paddingSize:"none","data-test-subj":"conditional-embeddable-map"},i.a.createElement(of,{query:m,filters:b,startDate:h,endDate:f,setQuery:S})),i.a.createElement(V.EuiSpacer,null)),i.a.createElement(Qf,{filterQuery:L,from:h,indexNames:A,updateDateRange:M,setQuery:S,skip:j||void 0===L,to:f})),t&&!j?i.a.createElement(i.a.Fragment,null,i.a.createElement(ye.a,{show:!O},i.a.createElement(V.EuiSpacer,null),i.a.createElement(ga.a,{navTabs:Object(Kf.j)(e)}),i.a.createElement(V.EuiSpacer,null)),i.a.createElement(Kf.e,{filterQuery:q,from:h,isInitializing:j,indexPattern:D,indexNames:A,setQuery:S,type:Wf.c.NetworkType.page,to:f})):i.a.createElement(Kf.f,null))):i.a.createElement(aa.a,null),i.a.createElement(E.a,{pageName:k.a.network}))}));Zf.displayName="NetworkComponent";const ey=i.a.memo(Zf),ty=i.a.memo((()=>{const{path:e}=Object(P.useRouteMatch)();return i.a.createElement(P.Switch,null,i.a.createElement(L.Route,{strict:!0,exact:!0,path:e,render:({location:e})=>{const t=Object(yd.parse)(e.search.substring(1),{sort:!1});null!=t.query&&(t.query=Md(t.query));const a=Object(yd.stringify)(hd.url.encodeQuery(t),{sort:!1,encode:!1});return i.a.createElement(P.Redirect,{to:`${s.Sb}?${a}`})}}),i.a.createElement(L.Route,{path:`${e}/ip/:ip`,render:({location:e,match:{params:{ip:t}}})=>{const a=Object(yd.parse)(e.search.substring(1),{sort:!1});if(null!=a.query&&(a.query=Md(a.query)),Fd(t)){const e=Object(yd.stringify)(hd.url.encodeQuery(a),{sort:!1,encode:!1});return i.a.createElement(P.Redirect,{to:`${s.Sb}?${e}`})}if(Dd(t)){const e=Ad(t);a.query=jd(["source.ip","destination.ip"],e,a.query||"");const n=Object(yd.stringify)(hd.url.encodeQuery(a),{sort:!1,encode:!1});return i.a.createElement(P.Redirect,{to:`${s.Sb}?${n}`})}{const e=Object(yd.stringify)(hd.url.encodeQuery(a),{sort:!1,encode:!1});return i.a.createElement(P.Redirect,{to:`${s.Sb}/ip/${t}?${e}`})}}}),i.a.createElement(L.Route,{path:`${s.Sb}/ml-network/`,render:({location:{search:e=""}})=>i.a.createElement(P.Redirect,{from:`${s.Sb}/ml-network/`,to:{pathname:`${s.Sb}/ml-network`,search:e}})}))}));ty.displayName="MlNetworkConditionalContainer";var ay=a(577);const ny=(e,t)=>`${s.Sb}/ip/${e}/${t||Jn.g.source}/${Jf.a.flows}`,iy=()=>{const e=Object(ar.a)(),t=e.capabilitiesFetched,a=Object(n.useMemo)((()=>Object(tr.a)(e)),[e]),r=Object(n.useMemo)((()=>Object(Kf.i)(t,a)),[t,a]);return i.a.createElement(P.Switch,null,i.a.createElement(L.Route,{exact:!0,strict:!0,path:s.Sb,render:({location:{search:e=""}})=>i.a.createElement(P.Redirect,{to:{pathname:`${s.Sb}/${Jf.a.flows}`,search:e}})}),i.a.createElement(L.Route,{path:`${s.Sb}/ml-network`},i.a.createElement(ty,null)),i.a.createElement(L.Route,{strict:!0,path:r},i.a.createElement(ey,{capabilitiesFetched:e.capabilitiesFetched,hasMlUserPermissions:a})),i.a.createElement(L.Route,{path:ay.c},i.a.createElement(Gg.a,null)),i.a.createElement(L.Route,{path:`${ay.b}/:flowTarget(${ay.a})?`,render:({match:{params:{detailName:e,flowTarget:t}},location:{search:a=""}})=>i.a.createElement(P.Redirect,{to:{pathname:ny(e,t),search:a}})}),i.a.createElement(L.Route,null,i.a.createElement(P.Redirect,{to:{pathname:s.Sb}})))},ry=i.a.memo(iy),sy=[{path:s.Sb,component:()=>i.a.createElement(_,null,i.a.createElement(r.TrackApplicationView,{viewId:k.a.network},i.a.createElement(ry,null)))}],oy=z.i18n.translate("xpack.securitySolution.kubernetes.columnSessionStart",{defaultMessage:"Date connected"}),ly=z.i18n.translate("xpack.securitySolution.kubernetes.columnExecutable",{defaultMessage:"Session leader"}),cy=z.i18n.translate("xpack.securitySolution.kubernetes.columnNode",{defaultMessage:"Node"}),uy=z.i18n.translate("xpack.securitySolution.kubernetes.columnEntryUser",{defaultMessage:"Session entry user"}),dy=z.i18n.translate("xpack.securitySolution.kubernetes.columnInteractive",{defaultMessage:"Interactivity"}),py=z.i18n.translate("xpack.securitySolution.kubernetes.columnEntryType",{defaultMessage:"Entry type"}),my=z.i18n.translate("xpack.securitySolution.kubernetes.columnContainer",{defaultMessage:"Container"}),gy=z.i18n.translate("xpack.securitySolution.kubernetes.columnPod",{defaultMessage:"Pod"}),by=[{columnHeaderType:Au.a,id:"process.entry_leader.start",initialWidth:_u.b,display:oy},{columnHeaderType:Au.a,id:"process.entry_leader.user.name",display:uy},{columnHeaderType:Au.a,id:"process.entry_leader.executable",display:ly},{columnHeaderType:Au.a,id:"cloud.instance.name",display:cy},{columnHeaderType:Au.a,id:"process.entry_leader.entry_meta.type",display:py},{columnHeaderType:Au.a,id:"process.entry_leader.interactive",display:dy},{columnHeaderType:Au.a,id:"container.name",display:my},{columnHeaderType:Au.a,id:"orchestrator.resource.name",display:gy}],fy=i.a.memo((()=>{const{kubernetesSecurity:e,uiSettings:t}=Object(p.k)().services,{globalFullScreen:a}=Object(fe.a)(),{indexPattern:r}=Object(g.d)(),{from:o,to:l}=Object(Y.a)(),c=Object(n.useMemo)((()=>rr.d.globalFiltersQuerySelector()),[]),d=Object(n.useMemo)((()=>rr.d.globalQuerySelector()),[]),m=Object(x.a)(d),b=Object(x.a)(c),[f,h]=Object(n.useMemo)((()=>Object(od.c)({config:Object(Ki.getEsQueryConfig)(t),indexPattern:r,queries:[m],filters:b})),[b,r,t,m]);Object(cd.a)({id:"kubernetesQuery",filterQuery:f,kqlError:h,query:m,startDate:o,endDate:l});const v=Object(n.useCallback)((e=>i.a.createElement(Zu,{tableId:u.g.kubernetesPageSessions,endDate:l,pageFilters:[],startDate:o,filterQuery:e,columns:by,defaultColumns:by})),[o,l]);return i.a.createElement(y.a,{noPadding:!0},e.getKubernetesPage({filter:i.a.createElement(J.a,{show:Object(he.n)({globalFullScreen:a,graphEventId:void 0})},i.a.createElement(Z.a,{id:K.a.global,indexPattern:r})),indexPattern:r,globalFilter:{filterQuery:f,startDate:o,endDate:l},renderSessionsView:v}),i.a.createElement(E.a,{pageName:s.uc.kubernetes}))}));fy.displayName="KubernetesContainer";const yy=[{path:s.Mb,component:()=>i.a.createElement(_,null,i.a.createElement(r.TrackApplicationView,{viewId:k.a.kubernetes},i.a.createElement(fy,null)))}],hy=Object(n.memo)((()=>i.a.createElement(i.a.Fragment,null,i.a.createElement(aa.a,null),i.a.createElement(E.a,{pageName:s.uc.landing}))));hy.displayName="LandingPage";var Ey=a(175),vy=a(860);const xy=z.i18n.translate("xpack.securitySolution.allHost.failSearchDescription",{defaultMessage:"Failed to run search on all hosts"}),ky="overviewHostQuery",Sy=H.a.div.withConfig({displayName:"ProgressContainer",componentId:"sc-1qvjg2g-0"})(["margin-left:8px;min-width:100px;@media only screen and (min-width:1400px){min-width:200px;}"]),jy=H()(V.EuiLoadingContent).withConfig({displayName:"LoadingContent",componentId:"sc-1qvjg2g-1"})([".euiLoadingContent__singleLine{margin-bottom:0px;}"]),Oy=({count:e,isGroupStat:t,isLoading:a,max:r})=>{const[o]=Object(p.q)(s.Z),[l,c]=Object(n.useState)(!0);return Object(n.useEffect)((()=>{l&&!a&&c(!1)}),[a,l,c]),i.a.createElement(V.EuiFlexGroup,{alignItems:"center",gutterSize:"none",responsive:!1,justifyContent:"spaceBetween"},i.a.createElement(V.EuiFlexItem,{grow:!1},!l&&i.a.createElement(V.EuiText,{color:t?"default":"subdued",size:t?"m":"s"},qt()(e).format(o))),i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(Sy,null,a?i.a.createElement(jy,{"data-test-subj":"stat-value-loading-spinner",lines:1}):i.a.createElement(V.EuiProgress,{color:t?"primary":"subdued",max:r,size:"m",value:e}))))};Oy.displayName="StatValueComponent";const wy=i.a.memo(Oy),Ty=e=>{var t,a,n,r,s,o,l,c,u,d,p,m,g,b,f,y;return[{count:null!==(t=e.auditbeatAuditd)&&void 0!==t?t:0,title:i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.overview.auditBeatAuditTitle",defaultMessage:"Audit"}),id:"auditbeatAuditd"},{count:null!==(a=e.auditbeatFIM)&&void 0!==a?a:0,title:i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.overview.auditBeatFimTitle",defaultMessage:"File Integrity Module"}),id:"auditbeatFIM"},{count:null!==(n=e.auditbeatLogin)&&void 0!==n?n:0,title:i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.overview.auditBeatLoginTitle",defaultMessage:"Login"}),id:"auditbeatLogin"},{count:null!==(r=e.auditbeatPackage)&&void 0!==r?r:0,title:i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.overview.auditBeatPackageTitle",defaultMessage:"Package"}),id:"auditbeatPackage"},{count:null!==(s=e.auditbeatProcess)&&void 0!==s?s:0,title:i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.overview.auditBeatProcessTitle",defaultMessage:"Process"}),id:"auditbeatProcess"},{count:null!==(o=e.auditbeatUser)&&void 0!==o?o:0,title:i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.overview.auditBeatUserTitle",defaultMessage:"User"}),id:"auditbeatUser"},{count:null!==(l=e.endgameDns)&&void 0!==l?l:0,title:i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.overview.endgameDnsTitle",defaultMessage:"DNS"}),id:"endgameDns"},{count:null!==(c=e.endgameFile)&&void 0!==c?c:0,title:i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.overview.endgameFileTitle",defaultMessage:"File"}),id:"endgameFile"},{count:null!==(u=e.endgameImageLoad)&&void 0!==u?u:0,title:i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.overview.endgameImageLoadTitle",defaultMessage:"Image Load"}),id:"endgameImageLoad"},{count:null!==(d=e.endgameNetwork)&&void 0!==d?d:0,title:i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.overview.endgameNetworkTitle",defaultMessage:"Network"}),id:"endgameNetwork"},{count:null!==(p=e.endgameProcess)&&void 0!==p?p:0,title:i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.overview.endgameProcessTitle",defaultMessage:"Process"}),id:"endgameProcess"},{count:null!==(m=e.endgameRegistry)&&void 0!==m?m:0,title:i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.overview.endgameRegistryTitle",defaultMessage:"Registry"}),id:"endgameRegistry"},{count:null!==(g=e.endgameSecurity)&&void 0!==g?g:0,title:i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.overview.endgameSecurityTitle",defaultMessage:"Security"}),id:"endgameSecurity"},{count:null!==(b=e.filebeatSystemModule)&&void 0!==b?b:0,title:i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.overview.filebeatSystemModuleTitle",defaultMessage:"System Module"}),id:"filebeatSystemModule"},{count:null!==(f=e.winlogbeatSecurity)&&void 0!==f?f:0,title:i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.overview.winlogbeatSecurityTitle",defaultMessage:"Security"}),id:"winlogbeatSecurity"},{count:null!==(y=e.winlogbeatMWSysmonOperational)&&void 0!==y?y:0,title:i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.overview.winlogbeatMWSysmonOperational",defaultMessage:"Microsoft-Windows-Sysmon/Operational"}),id:"winlogbeatMWSysmonOperational"}]},Iy=H.a.div.withConfig({displayName:"HostStatsContainer",componentId:"sc-ej4zfy-0"})([".accordion-button{width:100%;}"]),Cy=[{groupId:"auditbeat",name:i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.overview.hostStatGroupAuditbeat",defaultMessage:"Auditbeat"}),statIds:["auditbeatAuditd","auditbeatFIM","auditbeatLogin","auditbeatPackage","auditbeatProcess","auditbeatUser"]},{groupId:"endgame",name:i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.overview.hostStatGroupElasticEndpointSecurity",defaultMessage:"Endpoint Security"}),statIds:["endgameDns","endgameFile","endgameImageLoad","endgameNetwork","endgameProcess","endgameRegistry","endgameSecurity"]},{groupId:"filebeat",name:i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.overview.hostStatGroupFilebeat",defaultMessage:"Filebeat"}),statIds:["filebeatSystemModule"]},{groupId:"winlogbeat",name:i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.overview.hostStatGroupWinlogbeat",defaultMessage:"Winlogbeat"}),statIds:["winlogbeatSecurity","winlogbeatMWSysmonOperational"]}],My=H.a.div.withConfig({displayName:"MoveItLeftTitle",componentId:"sc-ej4zfy-1"})(["margin-left:24px;@media only screen and (min-width:","){max-width:40px;}"],(({theme:e})=>e.eui.euiBreakpoints.m)),Fy=H.a.div.withConfig({displayName:"MoveItLeft",componentId:"sc-ej4zfy-2"})(["margin-left:24px;"]),Dy=H()(V.EuiFlexItem).withConfig({displayName:"NoMarginTopFlexItem",componentId:"sc-ej4zfy-3"})(["@media only screen and (max-width:","){margin-top:-10px !important;}"],(({theme:e})=>e.eui.euiBreakpoints.m)),Ay=H.a.div.withConfig({displayName:"AccordionContent",componentId:"sc-ej4zfy-4"})(["margin-top:8px;"]),_y=({data:e,loading:t})=>{const a=Ty(e),n=a.reduce(((e,t)=>e+t.count),0);return i.a.createElement(Iy,{"data-test-subj":"overview-hosts-stats"},Cy.map(((e,r)=>{const s=a.filter((t=>e.statIds.includes(t.id))),o=s.reduce(((e,t)=>e+t.count),0);return i.a.createElement(i.a.Fragment,{key:e.groupId},i.a.createElement(V.EuiHorizontalRule,{margin:"xs"}),i.a.createElement(V.EuiAccordion,{id:`host-stat-accordion-group${e.groupId}`,buttonContent:i.a.createElement(V.EuiFlexGroup,{gutterSize:"s",justifyContent:"spaceBetween"},i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiText,null,e.name)),i.a.createElement(Dy,{grow:!1},i.a.createElement(wy,{count:o,isGroupStat:!0,isLoading:t,max:n}))),buttonContentClassName:"accordion-button"},i.a.createElement(Ay,null,s.map((e=>i.a.createElement(V.EuiFlexGroup,{key:e.id,gutterSize:"s",justifyContent:"spaceBetween"},i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiText,{color:"subdued",size:"s"},i.a.createElement(My,null,e.title))),i.a.createElement(Dy,{"data-test-subj":`host-stat-${e.id}`,grow:!1},i.a.createElement(Fy,null,i.a.createElement(wy,{count:e.count,isGroupStat:!1,isLoading:t,max:o})))))))))})))},Ny=i.a.memo(_y),Ry=Object(As.a)(Ny),Py=({endDate:e,filterQuery:t,indexNames:a,startDate:r,setQuery:o})=>{const[l]=Object(p.q)(s.Z),{toggleStatus:c,setToggleStatus:u}=Object(Ht.a)(ky),[d,m]=Object(n.useState)(void 0===t||!c);Object(n.useEffect)((()=>{m(void 0===t||!c)}),[t,c]);const g=Object(n.useCallback)((e=>{u(e),m(!e)}),[m,u]),[b,{overviewHost:f,id:y,inspect:h,refetch:E}]=(({filterQuery:e,endDate:t,indexNames:a,skip:i=!1,startDate:r})=>{const{loading:s,result:o,search:l,refetch:c,inspect:u}=Object(pc.a)({factoryQueryType:lc.h.overview,initialResult:{overviewHost:{}},errorMessage:xy,abort:i}),d=Object(n.useMemo)((()=>({endDate:t,overviewHost:o.overviewHost,id:ky,inspect:u,isInspected:!1,refetch:c,startDate:r})),[t,u,c,o.overviewHost,r]),p=Object(n.useMemo)((()=>({defaultIndex:a,factoryQueryType:lc.h.overview,filterQuery:Object(cc.a)(e),timerange:{interval:"12h",from:r,to:t}})),[t,e,a,r]);return Object(n.useEffect)((()=>{i||l(p)}),[p,l,i]),[s,d]})({endDate:e,filterQuery:t,indexNames:a,startDate:r,skip:d}),x=Object(n.useMemo)((()=>Ty(f).reduce(((e,t)=>e+t.count),0)),[f]),S=Object(n.useMemo)((()=>qt()(x).format(l)),[l,x]),j=Object(n.useMemo)((()=>i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.overview.hostsTitle",defaultMessage:"Host events"})),[]),O=Object(n.useMemo)((()=>Object(v.isEmpty)(f)?i.a.createElement(i.a.Fragment,null,""):i.a.createElement(dr.FormattedMessage,{defaultMessage:"Showing: {formattedHostEventsCount} {hostEventsCount, plural, one {event} other {events}}",id:"xpack.securitySolution.overview.overviewHost.hostsSubtitle",values:{hostEventsCount:x,formattedHostEventsCount:S}})),[S,x,f]);return i.a.createElement(Ne.c,{show:c},i.a.createElement(V.EuiPanel,{hasBorder:!0},i.a.createElement(Tt.a,{id:ky,subtitle:O,toggleStatus:c,toggleQuery:g,title:j,isInspectDisabled:void 0===t},i.a.createElement(be.l,{deepLinkId:k.a.hosts},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.overview.hostsAction",defaultMessage:"View hosts"}))),c&&i.a.createElement(Ry,{loading:b,data:f,setQuery:o,id:y,inspect:h,refetch:E})))};Py.displayName="OverviewHostComponent";const Ly=i.a.memo(Py),By=(z.i18n.translate("xpack.securitySolution.allHost.errorSearchDescription",{defaultMessage:"An error has occurred on all hosts search"}),z.i18n.translate("xpack.securitySolution.allHost.failSearchDescription",{defaultMessage:"Failed to run search on all hosts"})),qy="overviewNetworkQuery",zy=e=>{var t,a,n,r,s,o,l,c,u;return[{count:null!==(t=e.auditbeatSocket)&&void 0!==t?t:0,title:i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.overview.auditBeatSocketTitle",defaultMessage:"Socket"}),id:"auditbeatSocket"},{count:null!==(a=e.filebeatCisco)&&void 0!==a?a:0,title:i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.overview.filebeatCiscoTitle",defaultMessage:"Cisco"}),id:"filebeatCisco"},{count:null!==(n=e.filebeatNetflow)&&void 0!==n?n:0,title:i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.overview.filebeatNetflowTitle",defaultMessage:"Netflow"}),id:"filebeatNetflow"},{count:null!==(r=e.filebeatPanw)&&void 0!==r?r:0,title:i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.overview.filebeatPanwTitle",defaultMessage:"Palo Alto Networks"}),id:"filebeatPanw"},{count:null!==(s=e.filebeatSuricata)&&void 0!==s?s:0,title:i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.overview.fileBeatSuricataTitle",defaultMessage:"Suricata"}),id:"filebeatSuricata"},{count:null!==(o=e.filebeatZeek)&&void 0!==o?o:0,title:i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.overview.fileBeatZeekTitle",defaultMessage:"Zeek"}),id:"filebeatZeek"},{count:null!==(l=e.packetbeatDNS)&&void 0!==l?l:0,title:i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.overview.packetBeatDnsTitle",defaultMessage:"DNS"}),id:"packetbeatDNS"},{count:null!==(c=e.packetbeatFlow)&&void 0!==c?c:0,title:i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.overview.packetBeatFlowTitle",defaultMessage:"Flow"}),id:"packetbeatFlow"},{count:null!==(u=e.packetbeatTLS)&&void 0!==u?u:0,title:i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.overview.packetbeatTLSTitle",defaultMessage:"TLS"}),id:"packetbeatTLS"}]},$y=[{groupId:"auditbeat",name:i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.overview.networkStatGroupAuditbeat",defaultMessage:"Auditbeat"}),statIds:["auditbeatSocket"]},{groupId:"filebeat",name:i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.overview.networkStatGroupFilebeat",defaultMessage:"Filebeat"}),statIds:["filebeatCisco","filebeatNetflow","filebeatPanw","filebeatSuricata","filebeatZeek"]},{groupId:"packetbeat",name:i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.overview.networkStatGroupPacketbeat",defaultMessage:"Packetbeat"}),statIds:["packetbeatDNS","packetbeatFlow","packetbeatTLS"]}],Vy=H.a.div.withConfig({displayName:"NetworkStatsContainer",componentId:"sc-1wm45zw-0"})([".accordion-button{width:100%;}"]),Uy=H.a.div.withConfig({displayName:"MoveItLeftTitle",componentId:"sc-1wm45zw-1"})(["margin-left:24px;@media only screen and (min-width:","){max-width:40px;}"],(({theme:e})=>e.eui.euiBreakpoints.m)),Hy=H.a.div.withConfig({displayName:"MoveItLeft",componentId:"sc-1wm45zw-2"})(["margin-left:24px;"]),Gy=H()(V.EuiFlexItem).withConfig({displayName:"NoMarginTopFlexItem",componentId:"sc-1wm45zw-3"})(["@media only screen and (max-width:","){margin-top:-10px !important;}"],(({theme:e})=>e.eui.euiBreakpoints.m)),Qy=H.a.div.withConfig({displayName:"AccordionContent",componentId:"sc-1wm45zw-4"})(["margin-top:8px;"]),Wy=({data:e,loading:t})=>{const a=zy(e),n=a.reduce(((e,t)=>e+t.count),0);return i.a.createElement(Vy,{"data-test-subj":"overview-network-stats"},$y.map(((e,r)=>{const s=a.filter((t=>e.statIds.includes(t.id))),o=s.reduce(((e,t)=>e+t.count),0);return i.a.createElement(i.a.Fragment,{key:e.groupId},i.a.createElement(V.EuiHorizontalRule,{margin:"xs"}),i.a.createElement(V.EuiAccordion,{id:`network-stat-accordion-group${e.groupId}`,buttonContent:i.a.createElement(V.EuiFlexGroup,{"data-test-subj":`network-stat-group-${e.groupId}`,justifyContent:"spaceBetween",gutterSize:"s"},i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiText,null,e.name)),i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(wy,{count:o,isGroupStat:!0,isLoading:t,max:n}))),buttonContentClassName:"accordion-button"},i.a.createElement(Qy,null,s.map((e=>i.a.createElement(V.EuiFlexGroup,{key:e.id,gutterSize:"s",justifyContent:"spaceBetween"},i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiText,{color:"subdued",size:"s"},i.a.createElement(Uy,null,e.title))),i.a.createElement(Gy,{"data-test-subj":`network-stat-${e.id}`,grow:!1},i.a.createElement(Hy,null,i.a.createElement(wy,{count:e.count,isGroupStat:!1,isLoading:t,max:o})))))))))})))},Ky=i.a.memo(Wy),Yy=Object(As.a)(Ky),Jy=({endDate:e,filterQuery:t,indexNames:a,startDate:r,setQuery:o})=>{const{formatUrl:l,search:c}=Object(d.n)(k.a.network),{navigateToApp:u}=Object(p.k)().services.application,[m]=Object(p.q)(s.Z),{toggleStatus:g,setToggleStatus:b}=Object(Ht.a)(qy),[f,y]=Object(n.useState)(void 0===t||!g);Object(n.useEffect)((()=>{y(void 0===t||!g)}),[t,g]);const h=Object(n.useCallback)((e=>{b(e),y(!e)}),[y,b]),[E,{overviewNetwork:x,id:S,inspect:j,refetch:O}]=(({filterQuery:e,endDate:t,indexNames:a,skip:i=!1,startDate:r})=>{const{loading:s,result:o,search:l,refetch:c,inspect:u}=Object(pc.a)({factoryQueryType:lc.p.overview,initialResult:{overviewNetwork:{}},errorMessage:By,abort:i}),d=Object(n.useMemo)((()=>({endDate:t,overviewNetwork:o.overviewNetwork,id:qy,inspect:u,isInspected:!1,refetch:c,startDate:r})),[t,u,c,o.overviewNetwork,r]),p=Object(n.useMemo)((()=>({defaultIndex:a,factoryQueryType:lc.p.overview,filterQuery:Object(cc.a)(e),timerange:{interval:"12h",from:r,to:t}})),[t,e,a,r]);return Object(n.useEffect)((()=>{i||l(p)}),[p,l,i]),[s,d]})({endDate:e,filterQuery:t,indexNames:a,startDate:r,skip:f}),w=Object(n.useCallback)((e=>{e.preventDefault(),u(s.B,{deepLinkId:k.a.network,path:Object(d.i)(c)})}),[u,c]),T=Object(n.useMemo)((()=>zy(x).reduce(((e,t)=>e+t.count),0)),[x]),I=Object(n.useMemo)((()=>qt()(T).format(m)),[m,T]),C=Object(n.useMemo)((()=>i.a.createElement(be.g,{"data-test-subj":"overview-network-go-to-network-page",onClick:w,href:l(Object(d.i)())},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.overview.networkAction",defaultMessage:"View network"}))),[w,l]),M=Object(n.useMemo)((()=>i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.overview.networkTitle",defaultMessage:"Network events"})),[]),F=Object(n.useMemo)((()=>Object(v.isEmpty)(x)?i.a.createElement(i.a.Fragment,null,""):i.a.createElement(dr.FormattedMessage,{defaultMessage:"Showing: {formattedNetworkEventsCount} {networkEventsCount, plural, one {event} other {events}}",id:"xpack.securitySolution.overview.overviewNetwork.networkSubtitle",values:{formattedNetworkEventsCount:I,networkEventsCount:T}})),[I,T,x]);return i.a.createElement(Ne.c,{show:g},i.a.createElement(V.EuiPanel,{hasBorder:!0,"data-test-subj":"overview-network-query"},i.a.createElement(i.a.Fragment,null,i.a.createElement(Tt.a,{id:qy,subtitle:F,title:M,toggleStatus:g,toggleQuery:h,isInspectDisabled:void 0===t},C),g&&i.a.createElement(Yy,{loading:E,data:x,id:S,inspect:j,setQuery:o,refetch:O}))))};Jy.displayName="OverviewNetworkComponent";const Xy=i.a.memo(Jy),Zy=({filters:e,from:t,indexNames:a,indexPattern:r,query:s,setQuery:o,to:l})=>{const{uiSettings:c}=Object(p.k)().services,[u,d]=Object(n.useMemo)((()=>Object(od.c)({config:Object(Ki.getEsQueryConfig)(c),indexPattern:r,queries:[s],filters:[...e,...ed.e]})),[e,r,s,c]),[m]=Object(n.useMemo)((()=>Object(od.c)({config:Object(Ki.getEsQueryConfig)(c),indexPattern:r,queries:[s],filters:[...e,...ed.f]})),[e,r,c,s]);return Object(cd.a)({id:ky,filterQuery:u||m,kqlError:d,query:s,startDate:t,endDate:l}),i.a.createElement(V.EuiFlexGroup,{direction:"row"},i.a.createElement(V.EuiFlexItem,{grow:1},i.a.createElement(Ly,{endDate:l,filterQuery:u,indexNames:a,startDate:t,setQuery:o})),i.a.createElement(V.EuiFlexItem,{grow:1},i.a.createElement(Xy,{endDate:l,filterQuery:m,indexNames:a,startDate:t,setQuery:o})))},eh=i.a.memo(Zy),th=z.i18n.translate("xpack.securitySolution.recentTimelines.favoritesButtonLabel",{defaultMessage:"Favorites"}),ah=z.i18n.translate("xpack.securitySolution.recentTimelines.noFavoriteTimelinesMessage",{defaultMessage:"You haven't favorited any timelines yet. Get out there and start threat hunting!"}),nh=z.i18n.translate("xpack.securitySolution.recentTimelines.lastUpdatedButtonLabel",{defaultMessage:"Last updated"}),ih=z.i18n.translate("xpack.securitySolution.recentTimelines.noTimelinesMessage",{defaultMessage:"You haven't created any timelines yet. Get out there and start threat hunting!"}),rh=z.i18n.translate("xpack.securitySolution.recentTimelines.notesTooltip",{defaultMessage:"Notes"}),sh=z.i18n.translate("xpack.securitySolution.recentTimelines.openAsDuplicateTooltip",{defaultMessage:"Open as a timeline duplicate"}),oh=z.i18n.translate("xpack.securitySolution.recentTimelines.openAsDuplicateTemplateTooltip",{defaultMessage:"Open as a template duplicate"}),lh=z.i18n.translate("xpack.securitySolution.recentTimelines.pinnedEventsTooltip",{defaultMessage:"Pinned events"}),ch=z.i18n.translate("xpack.securitySolution.recentTimelines.untitledTimelineLabel",{defaultMessage:"Untitled timeline"}),uh=z.i18n.translate("xpack.securitySolution.recentTimelines.viewAllTimelinesLink",{defaultMessage:"View all timelines"}),dh=z.i18n.translate("xpack.securitySolution.recentTimelines.filterControlLegend",{defaultMessage:"Timelines filter"}),ph=[{id:"favorites",label:th,iconType:"starFilled"},{id:"recently-updated",label:nh,iconType:"documentEdit"}],mh=i.a.memo((({filterBy:e,setFilterBy:t})=>i.a.createElement(V.EuiButtonGroup,{options:ph,idSelected:e,onChange:e=>{t(e)},isIconOnly:!0,legend:dh})));mh.displayName="Filters";var gh=a(599),bh=a(136);const fh=i.a.memo((({onOpenTimeline:e,timeline:t,timeline:{title:a,savedObjectId:r}})=>{const s=Object(n.useCallback)((()=>e({duplicate:!1,timelineId:`${r}`})),[e,r]);return i.a.createElement(V.EuiText,{size:"s"},i.a.createElement(V.EuiLink,{onClick:s},Object(bh.f)(t)?ch:a))}));fh.displayName="RecentTimelineHeader";var yh=a(552);const hh=H()(V.EuiIcon).withConfig({displayName:"Icon",componentId:"sc-1ht70gq-0"})(["margin-right:8px;"]),Eh=H()(V.EuiFlexGroup).withConfig({displayName:"FlexGroup",componentId:"sc-1ht70gq-1"})(["margin-right:16px;"]),vh=i.a.memo((({count:e,icon:t,tooltip:a})=>i.a.createElement(V.EuiToolTip,{content:a},i.a.createElement(Eh,{alignItems:"center",gutterSize:"none"},i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(hh,{color:"subdued",size:"s",type:t})),i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiText,{color:"subdued",size:"xs"},e))))));vh.displayName="IconWithCount";const xh=i.a.memo((({timeline:e})=>i.a.createElement("div",null,i.a.createElement(vh,{count:Object(bh.e)(e),icon:"pinFilled",tooltip:lh}),i.a.createElement(vh,{count:Object(bh.d)(e),icon:"editorComment",tooltip:rh}))));xh.displayName="RecentTimelineCounts";const kh=H.a.div.withConfig({displayName:"ClampText",componentId:"sc-1pmjzib-0"})(["display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden;word-break:break-word;"]),Sh=i.a.memo((({timeline:e,onOpenTimeline:t,isLastItem:a})=>{const r=Object(n.useCallback)((()=>t({duplicate:!0,timelineId:`${e.savedObjectId}`})),[t,e.savedObjectId]),s=Object(n.useCallback)((a=>i.a.createElement(V.EuiFlexGroup,{gutterSize:"none",justifyContent:"spaceBetween","data-test-subj":"overview-recent-timelines"},i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(fh,{onOpenTimeline:t,timeline:e}),i.a.createElement(xh,{timeline:e}),e.description&&e.description.length&&i.a.createElement(V.EuiText,{color:"subdued",size:"xs"},i.a.createElement(kh,null,e.description))),a&&i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiToolTip,{content:e.timelineType===u.n.default?sh:oh},i.a.createElement(V.EuiButtonIcon,{"aria-label":e.timelineType===u.n.default?sh:oh,"data-test-subj":"open-duplicate",isDisabled:null==e.savedObjectId,iconSize:"s",iconType:"copy",onClick:r,size:"s"}))))),[r,t,e]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(yh.a,{render:s}),i.a.createElement(i.a.Fragment,null,!a&&i.a.createElement(V.EuiSpacer,{size:"l"})))}));Sh.displayName="RecentTimelinesItem";const jh=i.a.memo((({noTimelinesMessage:e,onOpenTimeline:t,timelines:a})=>{const r=Object(n.useMemo)((()=>a.map(((e,n)=>i.a.createElement(Sh,{key:`${e.savedObjectId}-${e.title}`,timeline:e,onOpenTimeline:t,isLastItem:n===a.length-1})))),[t,a]);return 0===a.length?i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiText,{color:"subdued",size:"s"},e)):i.a.createElement(i.a.Fragment,null,r)}));jh.displayName="RecentTimelines";const Oh=({lines:e,placeholders:t})=>i.a.createElement(i.a.Fragment,null,[...Array(t).keys()].map(((a,n)=>i.a.createElement(i.a.Fragment,{key:n},i.a.createElement(V.EuiLoadingContent,{lines:e}),n!==t-1&&i.a.createElement(V.EuiSpacer,{size:"l"})))));Oh.displayName="LoadingPlaceholdersComponent";const wh=i.a.memo(Oh);var Th=a(857);const Ih=({filterBy:e})=>{const t=Object(o.useDispatch)(),a=Object(n.useCallback)((e=>t(Object(S.updateIsLoading)(e))),[t]),r=Object(n.useMemo)((()=>Object(bh.b)(t)),[t]),{formatUrl:l}=Object(d.n)(k.a.timelines),{navigateToApp:c}=Object(p.k)().services.application,m=Object(n.useCallback)((({duplicate:e,timelineId:t})=>{Object(bh.h)({duplicate:e,timelineId:t,updateIsLoading:a,updateTimeline:r})}),[a,r]),g=Object(n.useCallback)((e=>{e.preventDefault(),c(s.B,{deepLinkId:k.a.timelines})}),[c]),b="favorites"===e?ah:ih,f=Object(n.useMemo)((()=>i.a.createElement(be.f,{onClick:g,href:l("")},uh)),[g,l]),y=Object(n.useMemo)((()=>i.a.createElement(wh,{lines:2,placeholders:"favorites"===e?1:3})),[e]),{fetchAllTimeline:h,timelines:E,loading:v}=Object(gh.b)(),x=u.n.default,{timelineStatus:j}=Object(Th.a)({timelineType:x});return Object(n.useEffect)((()=>{h({pageInfo:{pageIndex:1,pageSize:3},search:"",sort:{sortField:u.f.updated,sortOrder:Jn.b.desc},onlyUserFavorite:"favorites"===e,status:j,timelineType:x})}),[h,e,j,x]),i.a.createElement(i.a.Fragment,null,v?y:i.a.createElement(jh,{noTimelinesMessage:b,onOpenTimeline:m,timelines:null!=E?E:[]}),i.a.createElement(V.EuiHorizontalRule,{margin:"s"}),i.a.createElement(V.EuiText,{size:"xs"},f))};Ih.displayName="StatefulRecentTimelinesComponent";const Ch=i.a.memo(Ih);var Mh=a(877),Fh=a.n(Mh);const Dh="en",Ah=[],_h=i.a.memo((({children:e,title:t})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiFlexGroup,{alignItems:"center",gutterSize:"none",justifyContent:"spaceBetween"},i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiTitle,{size:"xs"},i.a.createElement("h2",null,t))),i.a.createElement(V.EuiFlexItem,{grow:!1},e)),i.a.createElement(V.EuiHorizontalRule,{margin:"s"}))));_h.displayName="SidebarHeader";const Nh=z.i18n.translate("xpack.securitySolution.newsFeed.noNewsMessage",{defaultMessage:"Your current news feed URL returned no recent news."}),Rh=z.i18n.translate("xpack.securitySolution.newsFeed.noNewsMessageForAdmin",{defaultMessage:"Your current news feed URL returned no recent news. You may update the URL or disable security news via"}),Ph=z.i18n.translate("xpack.securitySolution.newsFeed.advancedSettingsLinkTitle",{defaultMessage:"Security Solution advanced settings"}),Lh=i.a.memo((()=>{var e;const{getUrlForApp:t,navigateToApp:a,capabilities:r}=Object(p.k)().services.application,s=null!==(e=r.management.kibana.settings)&&void 0!==e&&e,o=Object(n.useCallback)((()=>a("management",{path:"/kibana/settings"})),[a]);return i.a.createElement(V.EuiText,{color:"subdued",size:"s"},s?Rh:Nh,s&&i.a.createElement(i.a.Fragment,null," ",i.a.createElement(be.f,{onClick:o,href:`${t("management",{path:"/kibana/settings"})}`},Ph),"."))}));Lh.displayName="NoNews";const Bh=({href:e,children:t})=>i.a.createElement(V.EuiLink,{href:e,rel:"noopener nofollow noreferrer",target:"_blank"},t),qh=H.a.img.withConfig({displayName:"NewsItemPreviewImage",componentId:"sc-e9sq8j-0"})(["height:56px;margin-left:16px;min-width:56px;padding:4px;width:56px;"]),zh=i.a.memo((({newsItem:e})=>{const{linkUrl:t,title:a,publishOn:n,description:r,imageUrl:s}=e;return(({publishOn:e,expireOn:t})=>Ws()(Date.now()).isAfter(e)&&Ws()(Date.now()).isBefore(t))(e)?i.a.createElement(V.EuiFlexGroup,{gutterSize:"none",justifyContent:"spaceBetween"},i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiText,{size:"s"},i.a.createElement(Bh,{href:t},a)),i.a.createElement(V.EuiText,{color:"subdued",size:"xs"},i.a.createElement(xa.e,{value:n}),i.a.createElement(V.EuiSpacer,{size:"s"}),i.a.createElement("div",null,r),i.a.createElement(V.EuiSpacer,{size:"l"}))),i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement("div",null,s&&i.a.createElement(qh,{alt:a,className:"euiPanel",src:s})))):null}));zh.displayName="Post";const $h=({news:e})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(_h,{title:id.e}),null==e?i.a.createElement(wh,{lines:4,placeholders:5}):0===e.length?i.a.createElement(Lh,null):e.map((e=>i.a.createElement(zh,{key:e.hash,newsItem:e}))));$h.displayName="NewsFeedComponent";const Vh=i.a.memo($h),Uh=i.a.memo((({enableNewsFeedSetting:e,newsFeedSetting:t})=>{const a=Object(p.k)().services.newsfeed,[r]=Object(p.q)(e),[s]=Object(p.q)(t),[o,l]=Object(n.useState)(null),c=a&&r,u=(({newsFeedUrlSetting:e,getKibanaVersion:t})=>{return[null==e?void 0:e.trim().replace(/\/$/,""),`v${a=t(),null!==(n=null===(i=Fh()(a))||void 0===i?void 0:i.version)&&void 0!==n?n:a}.json`].join("/");var a,n,i})({newsFeedUrlSetting:s,getKibanaVersion:()=>p.b.getKibanaVersion()});return Object(n.useEffect)((()=>{let e=!1;return c&&(async()=>{try{const t=await(async({newsFeedUrl:e})=>p.b.get().http.fetch(e,{method:"GET",credentials:"omit",mode:"cors"}))({newsFeedUrl:u});e||l((e=>{const t=""===document.documentElement.lang?"en":null!==(a=document.documentElement.lang)&&void 0!==a?a:"en";var a;return null==e||null==e.items?Ah:e.items.filter((e=>null!=e)).map((e=>{var a,n,i,r,s,o,l,c,u,d,p;return{description:null!==(a=null!==(n=Object(v.get)(t,e.description))&&void 0!==n?n:Object(v.get)(Dh,e.description))&&void 0!==a?a:"",expireOn:new Date(null!==(i=e.expire_on)&&void 0!==i?i:""),hash:null!==(r=e.hash)&&void 0!==r?r:Ye.a.v4(),imageUrl:null!==(s=null!==(o=Object(v.get)(t,e.image_url))&&void 0!==o?o:Object(v.get)(Dh,e.image_url))&&void 0!==s?s:null,linkUrl:null!==(l=null!==(c=Object(v.get)(t,e.link_url))&&void 0!==c?c:Object(v.get)(Dh,e.link_url))&&void 0!==l?l:"",publishOn:new Date(null!==(u=e.publish_on)&&void 0!==u?u:""),title:null!==(d=null!==(p=Object(v.get)(t,e.title))&&void 0!==p?p:Object(v.get)(Dh,e.title))&&void 0!==d?d:""}}))})(t))}catch{e||l([])}})(),()=>{e=!0}}),[c,u]),i.a.createElement(i.a.Fragment,null,c?i.a.createElement(Vh,{news:o}):null)}));Uh.displayName="StatefulNewsFeed";const Hh=()=>{const{cases:e}=Object(p.k)().services,t=Object(p.i)();return e.ui.getRecentCases({permissions:t,maxCasesToShow:3,owner:[s.p]})};Hh.displayName="RecentCasesComponent";const Gh=i.a.memo(Hh),Qh=i.a.memo((({recentTimelinesFilterBy:e,setRecentTimelinesFilterBy:t})=>{const a=Object(n.useMemo)((()=>i.a.createElement(mh,{filterBy:e,setFilterBy:t})),[e,t]),r=Object(p.i)().read;return i.a.createElement(V.EuiFlexGroup,{direction:"column",responsive:!1,gutterSize:"l"},r&&i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(Gh,null)),i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(_h,{title:id.h},a),i.a.createElement(Ch,{filterBy:e})),i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(Uh,{enableNewsFeedSetting:s.vb,newsFeedSetting:s.Tb})))}));Qh.displayName="Sidebar";const Wh=i.a.memo((()=>{const[e,t]=Object(n.useState)("favorites");return i.a.createElement(Qh,{recentTimelinesFilterBy:e,setRecentTimelinesFilterBy:t})}));Wh.displayName="StatefulSidebar";var Kh=a(914),Yh=a(243);const Jh=Object(n.memo)((({onDismiss:e})=>{const{getUrlForApp:t}=Object(p.k)().services.application,a=Object(h.e)({name:"endpointList"}),n=t(s.B,{path:a}),r=Object(Yh.a)(s.B,{path:a});return i.a.createElement(V.EuiCallOut,{"data-test-subj":"endpoint-prompt-banner",iconType:"cheer",title:i.a.createElement(i.a.Fragment,null,i.a.createElement("b",null,i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.overview.endpointNotice.introducing",defaultMessage:"Introducing: "})),i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.overview.endpointNotice.title",defaultMessage:"Endpoint Security"}))},i.a.createElement(i.a.Fragment,null,i.a.createElement("p",null,i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.overview.endpointNotice.message",defaultMessage:"Protect your hosts with threat prevention, detection, and deep security data visibility."})),i.a.createElement(V.EuiButton,{onClick:r,href:n},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.overview.endpointNotice.tryButton",defaultMessage:"Try Endpoint Security"})),i.a.createElement(V.EuiButtonEmpty,{onClick:e},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.overview.endpointNotice.dismiss",defaultMessage:"Dismiss message"}))))}));Jh.displayName="EndpointNotice";var Xh=a(887),Zh=a(15),eE=a(129),tE=a(48),aE=a(548);const nE=z.i18n.translate("xpack.securitySolution.overview.ctiDashboardDangerPanelTitle",{defaultMessage:"No threat intelligence data"}),iE=z.i18n.translate("xpack.securitySolution.overview.ctiDashboardEnableThreatIntel",{defaultMessage:"You need to enable threat intel sources in order to view data."}),rE=z.i18n.translate("xpack.securitySolution.overview.ctiDashboardDangerButton",{defaultMessage:"Enable sources"}),sE=z.i18n.translate("xpack.securitySolution.overview.ctiDashboardTitle",{defaultMessage:"Threat Intelligence"}),oE=(z.i18n.translate("xpack.securitySolution.overview.ctiViewDasboard",{defaultMessage:"View dashboard"}),z.i18n.translate("xpack.securitySolution.overview.ctiDashboardOtherDatasourceTitle",{defaultMessage:"Others"})),lE=z.i18n.translate("xpack.securitySolution.overview.ctiLinkSource",{defaultMessage:"Source"});var cE=a(140);const uE="ctiEventCountQuery",dE=Object(eE.d)((e=>(({data:e,defaultIndex:t,timerange:a,signal:n})=>e.search.search({defaultIndex:t,factoryQueryType:aE.a.dataSource,timerange:a},{strategy:"securitySolutionSearchStrategy",abortSignal:n}))(e).pipe(Object(Zh.filter)((e=>Object(tE.isErrorResponse)(e)||Object(tE.isCompleteResponse)(e)))))),pE=({to:e,from:t,allTiDataSources:a,setQuery:i,deleteQuery:r})=>{const[o,l]=Object(n.useState)([]),[c,u]=Object(n.useState)(!1),{data:d,uiSettings:m}=Object(p.k)().services,g=m.get(s.eb),{result:b,start:f,loading:y}=Object(eE.c)(dE);Object(n.useEffect)((()=>{f({data:d,timerange:e&&t?{to:e,from:t,interval:""}:void 0,defaultIndex:g})}),[e,t,f,d,g]),Object(n.useEffect)((()=>{var e,t;!y&&null!=b&&b.rawResponse&&null!=b&&b.inspect&&i&&i({id:uE,inspect:{dsl:null!==(e=null==b||null===(t=b.inspect)||void 0===t?void 0:t.dsl)&&void 0!==e?e:[],response:[JSON.stringify(b.rawResponse,null,2)]},loading:y,refetch:()=>{}})}),[i,y,b]),Object(n.useEffect)((()=>()=>{r&&r({id:uE})}),[r]),Object(n.useEffect)((()=>{b&&!c&&u(!0)}),[c,b]),Object(n.useEffect)((()=>{if(!y&&b){var e,t,n,i;const r=null!==(e=null==b||null===(t=b.rawResponse)||void 0===t||null===(n=t.aggregations)||void 0===n||null===(i=n.dataset)||void 0===i?void 0:i.buckets)&&void 0!==e?e:[],s=e=>{var t,a;return null==e||null===(t=e.buckets)||void 0===t||null===(a=t[0])||void 0===a?void 0:a.key},o=r.reduce(((e,t)=>{const a=s(null==t?void 0:t.name);if(a)return{...e,[t.key]:{dataset:null==t?void 0:t.key,name:a,dashboardId:s(null==t?void 0:t.dashboard),count:null==t?void 0:t.doc_count}};{var n,i,r;const a=cE.o,s=null!==(n=null===(i=e[a])||void 0===i?void 0:i.count)&&void 0!==n?n:0;return{...e,[a]:{dataset:a,name:oE,count:s+(null!==(r=null==t?void 0:t.doc_count)&&void 0!==r?r:0)}}}}),{});Array.isArray(a)&&a.forEach((e=>{o[e.dataset]||(o[e.dataset]={...e,count:0})})),l(Object.values(o))}}),[b,y,a]);const h=o.reduce(((e,t)=>e+t.count),0);return{tiDataSources:o,totalCount:h,isInitiallyLoaded:c}},mE={type:"tag",search:"threat intel",searchFields:["name"]},gE=z.i18n.translate("xpack.securitySolution.overview.linkPanelLearnMoreButton",{defaultMessage:"Learn More"}),bE=H()(V.EuiFlexGroup).withConfig({displayName:"ButtonContainer",componentId:"sc-1se23m-0"})(["padding:",";"],(({theme:e})=>e.eui.euiSizeS)),fE=H()(V.EuiIcon).withConfig({displayName:"Icon",componentId:"sc-1se23m-1"})(["padding:0;margin-top:",";margin-left:12px;transform:scale(",");"],(({theme:e})=>e.eui.euiSizeM),(({color:e})=>"primary"===e?1.4:1)),yE=H()(V.EuiSplitPanel.Inner).withConfig({displayName:"PanelContainer",componentId:"sc-1se23m-2"})(["margin-bottom:",";"],(({theme:e})=>e.eui.euiSizeM)),hE=H()(V.EuiText).withConfig({displayName:"Title",componentId:"sc-1se23m-3"})(["color:",";margin-bottom:",";"],(({theme:e,textcolor:t})=>"primary"===t?e.eui.euiColorPrimary:e.eui.euiColorWarningText),(({theme:e})=>e.eui.euiSizeM)),EE=({body:e,button:t,color:a,dataTestSubj:n,learnMoreLink:r,title:s})=>i.a.createElement(yE,{grow:!1,color:a},i.a.createElement(V.EuiFlexGroup,{direction:"column","data-test-subj":n},i.a.createElement(V.EuiFlexItem,null,i.a.createElement(V.EuiFlexGroup,{direction:"row"},i.a.createElement(fE,{type:"primary"===a?"iInCircle":"help",size:"m",color:a}),i.a.createElement(V.EuiFlexItem,null,i.a.createElement(hE,{"data-test-subj":"inner-link-panel-title",textcolor:a},s))),i.a.createElement("p",null,e," ",r&&i.a.createElement(V.EuiLink,{href:r,target:"_blank","data-test-subj":`${n}-learn-more`,external:!0},gE))),t&&i.a.createElement(bE,null,i.a.createElement(V.EuiFlexItem,{grow:!1},t))));EE.displayName="InnerLinkPanel";var vE=a(7);const xE=H()(V.EuiBasicTable).withConfig({displayName:"StyledTable",componentId:"sc-1cmro1k-0"})(["[data-test-subj='panel-link'],[data-test-subj='panel-no-link']{opacity:0;}tr:hover{[data-test-subj='panel-link'],[data-test-subj='panel-no-link']{opacity:1;}}"]),kE=({button:e,columns:t,dataTestSubj:a,defaultSortField:r,defaultSortOrder:s,infoPanel:o,inspectQueryId:l,listItems:c,panelTitle:u,splitPanel:d,subtitle:p})=>{const[m,g]=Object(n.useState)(0),[b,f]=Object(n.useState)(null!=r?r:"title"),[y,h]=Object(n.useState)(null!=s?s:"asc"),E=Object(n.useMemo)((()=>((e,t,a)=>{const n=[...e].sort(((e,a)=>{const n=e[t],i=a[t];return void 0!==n&&void 0!==i?n===i?e.title>a.title?1:e.title<a.title?-1:0:n>i?1:n<i?-1:0:0}));return"desc"===a&&n.reverse(),Object(vE.chunk)(n,5)})(c,b,y)),[c,y,b]),v=Object(n.useMemo)((()=>({showPerPageOptions:!1,pageIndex:m,pageSize:5,totalItemCount:c.length})),[m,c.length]),x=Object(n.useMemo)((()=>({sort:{direction:y,field:b}})),[b,y]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiSpacer,{"data-test-subj":"spacer",size:"l"}),i.a.createElement(V.EuiFlexGroup,{gutterSize:"l",justifyContent:"spaceBetween","data-test-subj":a},i.a.createElement(V.EuiFlexItem,{grow:1},i.a.createElement(Ne.c,null,i.a.createElement(V.EuiPanel,{hasBorder:!0},i.a.createElement(Tt.a,{id:l,subtitle:p,title:u},i.a.createElement(i.a.Fragment,null,e)),d,o,E.length>0&&i.a.createElement(xE,{columns:t,itemId:"id",items:E[m]||[],onChange:({page:e,sort:t})=>{const{index:a}=e;if(g(a),t){const{field:e,direction:a}=t;f(e),h(a)}},pagination:v,sorting:x}))))))},SE=i.a.memo(kE);SE.displayName="LinkPanel";const jE=({path:e,copy:t})=>e?i.a.createElement(V.EuiLink,{href:e,target:"_blank","data-test-subj":"panel-link"},t):i.a.createElement(V.EuiText,{color:"subdued",size:"s","data-test-subj":"panel-no-link"},t);jE.displayName="Link";const OE=[{name:"Name",field:"title",sortable:!0,truncateText:!0,width:"100%"},{name:"Indicator",field:"count",render:e=>{var t;if(e<1e4)return e.toString();const{magnitude:a,unit:n}=null!==(t=[{magnitude:1e18,unit:"E"},{magnitude:1e15,unit:"P"},{magnitude:1e12,unit:"T"},{magnitude:1e9,unit:"B"},{magnitude:1e6,unit:"M"},{magnitude:1e3,unit:"K"}].find((t=>e>=t.magnitude)))&&void 0!==t?t:{magnitude:1,unit:""};return((e,t)=>{const a=e.toFixed(t);return+a<=e?a:(+a-Math.pow(.1,t)).toFixed(t)})(e/a,1).replace(/\.0+$|(\.[0-9]*[1-9])0+$/,"$1")+n},sortable:!0,truncateText:!0,width:"70px",align:"right"},{name:"",field:"path",truncateText:!0,width:"80px",render:e=>i.a.createElement(jE,{path:e,copy:lE})}],wE=({isInspectEnabled:e=!0,listItems:t,splitPanel:a,totalCount:r=0})=>i.a.createElement(SE,{columns:OE,dataTestSubj:"cti-dashboard-links",inspectQueryId:e?uE:void 0,listItems:t,panelTitle:sE,splitPanel:a,subtitle:Object(n.useMemo)((()=>i.a.createElement(dr.FormattedMessage,{"data-test-subj":"cti-total-event-count",defaultMessage:"Showing: {totalCount} {totalCount, plural, one {indicator} other {indicators}}",id:"xpack.securitySolution.overview.ctiDashboardSubtitle",values:{totalCount:r}})),[r]),button:Object(n.useMemo)((()=>i.a.createElement(be.l,{"data-test-subj":"cti-view-indicators",deepLinkId:s.uc.threatIntelligenceIndicators},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.overview.threatIndicatorsAction",defaultMessage:"View indicators"}))),[])}),TE=e=>{const{to:t,from:a,allTiDataSources:r,setQuery:s,deleteQuery:o}=e,{tiDataSources:l,totalCount:c}=pE({to:t,from:a,allTiDataSources:r,setQuery:s,deleteQuery:o}),{listItems:u}=(({to:e,from:t,tiDataSources:a=[]})=>{var i;const[r,s]=Object(n.useState)([]),o=null===(i=Object(p.k)().services.dashboard)||void 0===i?void 0:i.locator,l=Object(p.k)().services.savedObjects.client,c=Object(n.useCallback)((e=>{var t;if(null!=e&&null!==(t=e.savedObjects)&&void 0!==t&&t.length)return l.find({type:"dashboard",hasReference:{id:e.savedObjects[0].id,type:"tag"}})}),[l]);return Object(n.useEffect)((()=>{l&&l.find(mE).then(c).then((async e=>{var t;null!=e&&null!==(t=e.savedObjects)&&void 0!==t&&t.length&&s(e.savedObjects.map((e=>{var t;return null!==(t=e.id)&&void 0!==t?t:""})).filter(Boolean))}))}),[c,l]),{listItems:a.map((a=>{const n={title:a.name,count:a.count,path:""};return a.dashboardId&&r.includes(a.dashboardId)&&o&&(n.path=o.getRedirectUrl({dashboardId:a.dashboardId,timeRange:{to:e,from:t}})),n}))}})({to:t,from:a,tiDataSources:l});return i.a.createElement(wE,{listItems:u,totalCount:c})},IE=i.a.memo(TE);IE.displayName="CtiEnabledModule";const CE=({bodyCopy:e,buttonCopy:t,dataTestSubjPrefix:a,docLink:n,learnMoreUrl:r,LinkPanelViewComponent:s,listItems:o,moreButtons:l,titleCopy:c})=>i.a.createElement(s,{listItems:o,splitPanel:i.a.createElement(EE,{body:e,button:i.a.createElement(V.EuiFlexGroup,null,t&&n&&i.a.createElement(V.EuiFlexItem,null,i.a.createElement(be.g,{color:"warning",href:n,target:"_blank","data-test-subj":`${a}-enable-module-button`},t)),l&&l),color:"warning",dataTestSubj:`${a}-inner-panel-danger`,learnMoreLink:r,title:c})}),ME=Object(n.memo)(CE);ME.displayName="DisabledLinkPanel";const FE=()=>{const e=`${Object(p.e)()}/app/integrations/browse/threat_intel`;return i.a.createElement(ME,{bodyCopy:iE,buttonCopy:rE,dataTestSubjPrefix:"cti",docLink:e,listItems:[],titleCopy:nE,LinkPanelViewComponent:wE})},DE=i.a.memo(FE);DE.displayName="CtiDisabledModule";const AE=e=>{const{allTiDataSources:t}=e;return t.length>0?i.a.createElement("div",{"data-test-subj":"cti-enabled-module"},i.a.createElement(IE,lr()({},e,{allTiDataSources:t}))):i.a.createElement("div",{"data-test-subj":"cti-disabled-module"},i.a.createElement(DE,null))},_E=i.a.memo(AE);_E.displayName="ThreatIntelDashboardLinksComponent";const NE=()=>{const e=Object(n.useMemo)((()=>rr.d.globalFiltersQuerySelector()),[]),t=Object(n.useMemo)((()=>rr.d.globalQuerySelector()),[]),a=Object(x.a)(t),r=Object(x.a)(e),{from:o,deleteQuery:l,setQuery:c,to:u}=Object(Y.a)(),{indicesExist:d,indexPattern:p,selectedPatterns:m}=Object(g.d)(),b=Object(n.useMemo)((()=>[s.xb]),[]),[,{indexExists:f}]=Object(Ey.b)(b,!0),{addMessage:h,hasMessage:v}=Object(Xh.a)(),S=Object(n.useMemo)((()=>v("management","dismissEndpointNotice")),[v]),[j,O]=Object(n.useState)(S),w=Object(n.useCallback)((()=>{O(!0),h("management","dismissEndpointNotice")}),[h]),{endpointPrivileges:{canAccessFleet:T}}=Object(pd.a)(),{hasIndexRead:I,hasKibanaREAD:C}=Object(oa.a)(),{tiDataSources:M,isInitiallyLoaded:F}=(()=>{const{to:e,from:t}=Object(n.useMemo)((()=>({to:(new Date).toISOString(),from:new Date(0).toISOString()})),[]),{tiDataSources:a,isInitiallyLoaded:i}=pE({to:e,from:t});return{tiDataSources:a,isInitiallyLoaded:i}})();return i.a.createElement(i.a.Fragment,null,d?i.a.createElement(i.a.Fragment,null,i.a.createElement(J.a,null,i.a.createElement(Z.a,{id:K.a.global,indexPattern:p})),i.a.createElement(y.a,null,!j&&!f&&T&&i.a.createElement(i.a.Fragment,null,i.a.createElement(Jh,{onDismiss:w}),i.a.createElement(V.EuiSpacer,{size:"l"})),i.a.createElement(V.EuiFlexGroup,null,i.a.createElement(V.EuiShowFor,{sizes:["xl"]},i.a.createElement(V.EuiFlexItem,{grow:1},i.a.createElement(Wh,null))),i.a.createElement(V.EuiFlexItem,{grow:3},i.a.createElement(V.EuiFlexGroup,{direction:"column",responsive:!1,gutterSize:"none"},I&&C&&i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(Kh.a,{filters:r,query:a}),i.a.createElement(V.EuiSpacer,{size:"l"})),i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(vy.a,{deleteQuery:l,filters:r,from:o,indexPattern:p,indexNames:m,query:a,queryType:"overview",setQuery:c,to:u})),i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(eh,{filters:r,from:o,indexNames:m,indexPattern:p,query:a,setQuery:c,to:u})),i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiFlexGroup,{direction:"row"},i.a.createElement(V.EuiFlexItem,{grow:1},F&&i.a.createElement(_E,{allTiDataSources:M,deleteQuery:l,from:o,setQuery:c,to:u}))))))))):i.a.createElement(aa.a,null),i.a.createElement(E.a,{pageName:k.a.overview}))},RE=i.a.memo(NE),PE=z.i18n.translate("xpack.securitySolution.socTrends.properties.lockDatePickerTooltip",{defaultMessage:"Disable syncing of date/time range between the currently viewed page and SOC Trends"}),LE=z.i18n.translate("xpack.securitySolution.socTrends.properties.unlockDatePickerTooltip",{defaultMessage:"Enable syncing of date/time range between the currently viewed page and SOC Trends"}),BE=z.i18n.translate("xpack.securitySolution.socTrends.properties.lockDatePickerDescription",{defaultMessage:"Lock global date picker to SOC Trends date picker"}),qE=z.i18n.translate("xpack.securitySolution.socTrends.properties.unlockDatePickerDescription",{defaultMessage:"Unlock global date picker from SOC Trends date picker"}),zE=()=>{const e=Object(o.useDispatch)(),t=Object(n.useMemo)((()=>ee.d.globalSelector()),[]),a=Object(x.b)((e=>t(e).linkTo.includes(K.a.socTrends))),r=Object(n.useCallback)((()=>e(ee.b.toggleSocTrendsLinkTo())),[e]);return i.a.createElement(V.EuiToolTip,{"data-test-subj":"socTrends-date-picker-lock-tooltip",position:"top",content:a?PE:LE},i.a.createElement(V.EuiButtonIcon,{"data-test-subj":`socTrends-date-picker-${a?"lock":"unlock"}-button`,color:"primary",onClick:r,iconType:a?"lock":"lockOpen","aria-label":a?qE:BE}))};zE.displayName="SocTrendsDatePickerLockComponent";const $E=i.a.memo(zE);var VE=a(286),UE=a(327);const HE=z.i18n.translate("xpack.securitySolution.detectionResponse.socTrends",{defaultMessage:"SOC Trends"}),GE=z.i18n.translate("xpack.securitySolution.detectionResponse.mttr",{defaultMessage:"Average case response time"}),QE=z.i18n.translate("xpack.securitySolution.detectionResponse.mttrDescription",{defaultMessage:"The average duration (from creation to closure) for your current cases"}),WE=z.i18n.translate("xpack.securitySolution.detectionResponse.criticalAlerts",{defaultMessage:"Open critical alerts"}),KE=z.i18n.translate("xpack.securitySolution.detectionResponse.criticalAlertsDescription",{defaultMessage:"The count of open critical alerts for the current time range"}),YE=e=>z.i18n.translate("xpack.securitySolution.detectionResponse.noChange",{defaultMessage:"Your {dataType} is unchanged",values:{dataType:e}}),JE=e=>z.i18n.translate("xpack.securitySolution.detectionResponse.noData",{defaultMessage:"There is no {dataType} data to compare",values:{dataType:e}}),XE=e=>z.i18n.translate("xpack.securitySolution.detectionResponse.noDataCompare",{defaultMessage:"There is no {dataType} data to compare from the compare time range",values:{dataType:e}}),ZE=e=>z.i18n.translate("xpack.securitySolution.detectionResponse.noDataCurrent",{defaultMessage:"There is no {dataType} data to compare from the current time range",values:{dataType:e}}),ev=({upOrDown:e,percentageChange:t,stat:a,statType:n})=>z.i18n.translate("xpack.securitySolution.detectionResponse.timeDifference",{defaultMessage:"Your {statType} is {upOrDown} by {percentageChange} from {stat}",values:{upOrDown:e,percentageChange:t,stat:a,statType:n}}),tv=(e,t)=>{switch(t.type){case"setIsLoading":return{...e,isLoading:t.isLoading};case"setUpdatedAt":return{...e,updatedAt:t.updatedAt};case"setStat":return{...e,stat:t.stat};case"setPercentage":return{...e,percentage:t.percentage};default:throw new Error}};var av=a(1262),nv=a.n(av);const iv=(e,t)=>null!=e&&0!==e&&null!=t&&0!==t?`${((e-t)/t*100).toFixed(1)}%`:null,rv=e=>nv()(1e3*e,{compact:!0,verbose:!1}),sv=({from:e,to:t})=>({size:0,query:{bool:{filter:[{range:{"@timestamp":{gte:e,lte:t}}}]}},aggs:{open:{filter:{term:{"kibana.alert.workflow_status":"open"}},aggs:{critical:{filter:{term:{"kibana.alert.severity":"critical"}}}}}}}),ov="socTrends",lv=H()(V.EuiPanel).withConfig({displayName:"StyledEuiPanel",componentId:"sc-16ex3ir-0"})(["min-width:300px;"]),cv=H()(V.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-16ex3ir-1"})(["max-width:300px;"]),uv=({signalIndexName:e})=>{const{toggleStatus:t,setToggleStatus:a}=Object(Ht.a)(ov),{stats:r,latestUpdate:o,isUpdating:l}=(({skip:e=!1,signalIndexName:t})=>{const{to:a,from:i,setQuery:r,deleteQuery:o}=Object(Y.a)(),{from:l="",to:c=""}=Object(x.a)((e=>Object(v.pick)(["from","to"],rr.d.socTrendsTimeRangeSelector(e)))),u=(({deleteQuery:e,from:t,fromCompare:a,setQuery:i,skip:r=!1,to:o,toCompare:l})=>{const{services:{cases:c}}=Object(p.k)(),u=Object(n.useMemo)((()=>`useCasesMttr-${Ye.a.v4()}`),[]),[d,m]=Object(n.useReducer)(tv,{description:QE,isLoading:!0,percentage:{percent:null,color:"hollow",note:JE("case")},stat:"-",testRef:"casesMttr",title:GE,updatedAt:Date.now()});return Object(n.useEffect)((()=>{let n=!0;const d=new AbortController,p=async()=>{try{const[e,i]=await Promise.all([c.api.cases.getCasesMetrics({from:t,to:o,owner:s.p,features:["mttr"]},d.signal),c.api.cases.getCasesMetrics({from:a,to:l,owner:s.p,features:["mttr"]},d.signal)]),r=iv(e.mttr,i.mttr);if(n&&null!=e.mttr?m({type:"setStat",stat:rv(e.mttr)}):n&&m({type:"setStat",stat:"-"}),null!=e.mttr&&null!=i.mttr&&null!=r){const e="-"===r.charAt(0),t="0.0%"===r;m({type:"setPercentage",percentage:{percent:e||t?r:`+${r}`,color:t?"hollow":e?"success":"danger",note:t?YE("case resolution time"):ev({upOrDown:e?"down":"up",percentageChange:e?r.substring(1):r,stat:rv(i.mttr),statType:"case resolution time"})}})}else{const t=null==e.mttr,a=null==i.mttr,n=t&&a?JE("case"):t?ZE("case"):XE("case");m({type:"setPercentage",percentage:{percent:null,color:"hollow",note:n}})}}catch(e){n&&m({type:"setStat",stat:"-"})}n&&(m({type:"setIsLoading",isLoading:!1}),m({type:"setUpdatedAt",updatedAt:Date.now()}))};return r||(p(),i({id:u,inspect:null,loading:!1,refetch:p})),r&&(m({type:"setIsLoading",isLoading:!1}),n=!1,d.abort()),()=>{n=!1,d.abort(),e&&e({id:u})}}),[c.api.cases,t,r,o,i,e,u,a,l]),d})({deleteQuery:o,from:i,fromCompare:l,setQuery:r,skip:e,to:a,toCompare:c}),d=(({from:e,fromCompare:t,skip:a=!1,signalIndexName:i,to:r,toCompare:s})=>{var o,l;const[c,u]=Object(n.useReducer)(tv,{description:KE,isLoading:!0,percentage:{percent:null,color:"hollow",note:JE("alerts")},stat:"-",testRef:"criticalAlerts",title:WE,updatedAt:Date.now()}),d=Object(n.useMemo)((()=>sv({from:e,to:r})),[e,r]),p=Object(n.useMemo)((()=>sv({from:t,to:s})),[t,s]),{data:m,loading:g,setQuery:b}=Object(T.a)({query:d,indexName:i,skip:a,queryName:I.a.SOC_TRENDS}),{data:f,loading:y,setQuery:h}=Object(T.a)({query:p,indexName:i,skip:a,queryName:I.a.SOC_TRENDS});Object(n.useEffect)((()=>{b(d)}),[d,b]),Object(n.useEffect)((()=>{h(p)}),[p,h]),Object(n.useEffect)((()=>{u({type:"setIsLoading",isLoading:g||y})}),[g,y]);const E=Object(n.useMemo)((()=>{var e,t;return null!==(e=null==m||null===(t=m.aggregations)||void 0===t?void 0:t.open.critical.doc_count)&&void 0!==e?e:null}),[null==m||null===(o=m.aggregations)||void 0===o?void 0:o.open.critical.doc_count]),v=Object(n.useMemo)((()=>{var e,t;return null!==(e=null==f||null===(t=f.aggregations)||void 0===t?void 0:t.open.critical.doc_count)&&void 0!==e?e:null}),[null==f||null===(l=f.aggregations)||void 0===l?void 0:l.open.critical.doc_count]);return Object(n.useEffect)((()=>{const e=iv(E,v);if(u(null!=E?{type:"setStat",stat:`${E}`}:{type:"setStat",stat:"-"}),null!=E&&null!=v&&0!==E&&0!==v&&null!=e){const t="-"===e.charAt(0),a="0.0%"===e;u({type:"setPercentage",percentage:{percent:t||a?e:`+${e}`,color:a?"hollow":t?"success":"danger",note:a?YE("open critical alert count"):ev({upOrDown:t?"down":"up",percentageChange:t?e.substring(1):e,stat:`${v}`,statType:"open critical alert count"})}})}else{const e=null==E||0===E,t=null==v||0===v,a=e&&t?JE("alerts"):e?ZE("alerts"):XE("alerts");u({type:"setPercentage",percentage:{percent:null,color:"hollow",note:a}})}u({type:"setUpdatedAt",updatedAt:Date.now()})}),[E,v]),c})({from:i,fromCompare:l,skip:e,signalIndexName:t,to:a,toCompare:c}),m=Object(n.useMemo)((()=>Math.max(u.updatedAt,d.updatedAt)),[u.updatedAt,d.updatedAt]),g=Object(n.useMemo)((()=>u.isLoading||d.isLoading),[u.isLoading,d.isLoading]);return{stats:[u,d],isUpdating:g,latestUpdate:m}})({skip:!t,signalIndexName:e}),c=Object(n.useMemo)((()=>r.map((e=>(e=>({title:i.a.createElement(V.EuiToolTip,{content:e.description},i.a.createElement(V.EuiText,null,i.a.createElement("h6",null,e.title," ",i.a.createElement(V.EuiIcon,{type:"questionInCircle"})))),description:e.isLoading?i.a.createElement(V.EuiLoadingSpinner,{"data-test-subj":`${e.testRef}-stat-loading-spinner`}):i.a.createElement(i.a.Fragment,null,e.stat," ",i.a.createElement(V.EuiToolTip,{content:e.percentage.note},i.a.createElement(V.EuiBadge,{color:e.percentage.color},null!=e.percentage.percent?e.percentage.percent:"-")))}))(e)))),[r]);return i.a.createElement(lv,{hasBorder:!0},i.a.createElement(Tt.a,{id:ov,showInspectButton:!1,stackHeader:!0,subtitle:i.a.createElement(UE.a,{updatedAt:o,isUpdating:l}),title:HE,titleSize:"s",toggleQuery:a,toggleStatus:t},i.a.createElement(cv,{gutterSize:"s"},i.a.createElement(V.EuiFlexItem,null,i.a.createElement(VE.a,{id:K.a.socTrends,showUpdateButton:"iconOnly",width:"auto",compressed:!0})),i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement($E,null)))),t&&i.a.createElement(V.EuiFlexGroup,{direction:"column",gutterSize:"s"},i.a.createElement(V.EuiFlexItem,{grow:!0},i.a.createElement(V.EuiDescriptionList,{"data-test-subj":"statsList",textStyle:"reverse",listItems:c}))))},dv=i.a.memo(uv);var pv=a(234),mv=a(411),gv=a(339),bv=a(463);const fv={pageCount:0,currentPage:0},yv=({from:e,to:t,currentPage:a})=>({query:{bool:{filter:[{term:{"kibana.alert.workflow_status":"open"}},{range:{"@timestamp":{gte:e,lte:t}}}]}},size:0,aggs:{host_count:{cardinality:{field:"host.name"}},hostsBySeverity:{terms:{size:100,field:"host.name",order:[{"critical.doc_count":"desc"},{"high.doc_count":"desc"},{"medium.doc_count":"desc"},{"low.doc_count":"desc"}]},aggs:{critical:{filter:{term:{"kibana.alert.severity":"critical"}}},high:{filter:{term:{"kibana.alert.severity":"high"}}},medium:{filter:{term:{"kibana.alert.severity":"medium"}}},low:{filter:{term:{"kibana.alert.severity":"low"}}},bucketOfPagination:{bucket_sort:{from:bv.a*a,size:4}}}}}}),hv="vulnerableHostsBySeverityQuery",Ev=i.a.memo((({signalIndexName:e})=>{const{openTimelineWithFilters:t}=Object(mv.a)(),a=Object(n.useCallback)((({hostName:e,severity:a})=>{const n={field:"host.name",value:e},i=a?{field:"kibana.alert.severity",value:a}:void 0;t(i?[[n,bv.d,i]]:[[n,bv.d]])}),[t]),{toggleStatus:r,setToggleStatus:s}=Object(Ht.a)(hv),{items:o,isLoading:l,updatedAt:c,pagination:u}=(({skip:e,queryId:t,signalIndexName:a})=>{const[i,r]=Object(n.useState)(Date.now()),[s,o]=Object(n.useState)([]),[l,c]=Object(n.useState)(fv),{to:u,from:d,setQuery:p,deleteQuery:m}=Object(Y.a)(),{data:g,request:b,response:f,setQuery:y,loading:h,refetch:E}=Object(T.a)({query:yv({from:d,to:u,currentPage:l.currentPage}),indexName:a,skip:e,queryName:I.a.VULNERABLE_HOSTS});Object(n.useEffect)((()=>{y(yv({from:d,to:u,currentPage:l.currentPage}))}),[y,d,u,l.currentPage]),Object(n.useEffect)((()=>{var e,t;null!=g&&g.aggregations?(o((null!==(t=null==(e=g.aggregations)?void 0:e.hostsBySeverity.buckets)&&void 0!==t?t:[]).reduce(((e,t)=>(e.push({hostName:t.key||"—",totalAlerts:t.doc_count,low:t.low.doc_count,medium:t.medium.doc_count,high:t.high.doc_count,critical:t.critical.doc_count}),e)),[])),c((e=>{var t;return{...e,pageCount:Object(bv.c)(null===(t=g.aggregations)||void 0===t?void 0:t.host_count.value)}}))):o([]),r(Date.now())}),[g]);const v=Object(n.useCallback)((()=>{!e&&E&&E()}),[e,E]);return Object(As.b)({deleteQuery:m,inspect:{dsl:[b],response:[f]},refetch:v,setQuery:p,queryId:t,loading:h}),{items:s,isLoading:h,updatedAt:i,pagination:{...l,setPage:e=>{c((t=>({...t,currentPage:e})))}}}})({skip:!r,queryId:hv,signalIndexName:e}),d=Object(n.useMemo)((()=>vv(a)),[a]);return i.a.createElement(Ta.a,{show:!0,targetClassNames:[Ne.a]},i.a.createElement(V.EuiPanel,{hasBorder:!0,"data-test-subj":"severityHostAlertsPanel"},i.a.createElement(Tt.a,{id:hv,title:gv.m,subtitle:i.a.createElement(UE.a,{updatedAt:c,isUpdating:l}),titleSize:"s",toggleQuery:s,toggleStatus:r,tooltip:gv.n}),r&&i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiBasicTable,{items:o,columns:d,loading:l,"data-test-subj":"severityHostAlertsTable",noItemsMessage:i.a.createElement(V.EuiEmptyPrompt,{title:i.a.createElement("h3",null,gv.p),titleSize:"xs"})}),i.a.createElement(V.EuiSpacer,{size:"m"}),u.pageCount>1&&i.a.createElement(V.EuiTablePagination,{"data-test-subj":"hostTablePaginator",activePage:u.currentPage,itemsPerPage:bv.a,pageCount:u.pageCount,onChangePage:u.setPage,showPerPageOptions:!1}))))}));Ev.displayName="HostAlertsTable";const vv=e=>[{field:"hostName",name:gv.l,"data-test-subj":"hostSeverityAlertsTable-hostName",render:e=>i.a.createElement(V.EuiToolTip,{title:gv.t,content:e,anchorClassName:"eui-textTruncate"},i.a.createElement(be.d,{hostName:e}))},{field:"totalAlerts",name:gv.c,"data-test-subj":"hostSeverityAlertsTable-totalAlerts",render:(t,{hostName:a})=>i.a.createElement(V.EuiLink,{"data-test-subj":"hostSeverityAlertsTable-totalAlertsLink",disabled:0===t,onClick:()=>e({hostName:a})},i.a.createElement(pv.a,{count:t}))},{field:"critical",name:gv.D,render:(t,{hostName:a})=>i.a.createElement(V.EuiHealth,{"data-test-subj":"hostSeverityAlertsTable-critical",color:bv.b.critical},i.a.createElement(V.EuiLink,{"data-test-subj":"hostSeverityAlertsTable-criticalLink",disabled:0===t,onClick:()=>e({hostName:a,severity:"critical"})},i.a.createElement(pv.a,{count:t})))},{field:"high",name:gv.E,render:(t,{hostName:a})=>i.a.createElement(V.EuiHealth,{"data-test-subj":"hostSeverityAlertsTable-high",color:bv.b.high},i.a.createElement(V.EuiLink,{disabled:0===t,onClick:()=>e({hostName:a,severity:"high"})},i.a.createElement(pv.a,{count:t})))},{field:"medium",name:gv.H,render:(t,{hostName:a})=>i.a.createElement(V.EuiHealth,{"data-test-subj":"hostSeverityAlertsTable-medium",color:bv.b.medium},i.a.createElement(V.EuiLink,{disabled:0===t,onClick:()=>e({hostName:a,severity:"medium"})},i.a.createElement(pv.a,{count:t})))},{field:"low",name:gv.G,render:(t,{hostName:a})=>i.a.createElement(V.EuiHealth,{"data-test-subj":"hostSeverityAlertsTable-low",color:bv.b.low},i.a.createElement(V.EuiLink,{disabled:0===t,onClick:()=>e({hostName:a,severity:"low"})},i.a.createElement(pv.a,{count:t})))}],xv=({from:e,to:t})=>({size:0,query:{bool:{filter:[{term:{"kibana.alert.workflow_status":"open"}},{range:{"@timestamp":{gte:e,lte:t}}}]}},aggs:{alertsByRule:{terms:{field:"kibana.alert.rule.name",size:4,order:[{critical:"desc"},{high:"desc"},{medium:"desc"},{low:"desc"}]},aggs:{critical:{filter:{term:{"kibana.alert.severity":"critical"}}},high:{filter:{term:{"kibana.alert.severity":"high"}}},medium:{filter:{term:{"kibana.alert.severity":"medium"}}},low:{filter:{term:{"kibana.alert.severity":"low"}}},lastRuleAlert:{top_hits:{size:1,sort:{"@timestamp":"desc"}}}}}}}),kv="detection-response-rule-alerts-severity-table",Sv=i.a.memo((({signalIndexName:e})=>{const{getAppUrl:t,navigateTo:a}=Object(p.m)(),{toggleStatus:r,setToggleStatus:o}=Object(Ht.a)(kv),{items:l,isLoading:c,updatedAt:u}=(({queryId:e,signalIndexName:t,skip:a=!1})=>{const[i,r]=Object(n.useState)([]),[s,o]=Object(n.useState)(Date.now()),{to:l,from:c,deleteQuery:u,setQuery:d}=Object(Y.a)(),{loading:p,data:m,setQuery:g,response:b,request:f,refetch:y}=Object(T.a)({query:xv({from:c,to:l}),indexName:t,skip:a,queryName:I.a.BY_SEVERITY});Object(n.useEffect)((()=>{g(xv({from:c,to:l}))}),[g,c,l]),Object(n.useEffect)((()=>{var e,t;r(null==m?[]:(null!==(t=null==(e=m.aggregations)?void 0:e.alertsByRule.buckets)&&void 0!==t?t:[]).map((e=>{const t=e.lastRuleAlert.hits.hits[0]._source;return{id:t["kibana.alert.rule.uuid"],alert_count:e.lastRuleAlert.hits.total.value,name:t["kibana.alert.rule.name"],last_alert_at:t["@timestamp"],severity:t["kibana.alert.severity"]}}))),o(Date.now())}),[m]);const h=Object(n.useCallback)((()=>{!a&&y&&y()}),[a,y]);return Object(As.b)({deleteQuery:u,inspect:{dsl:[f],response:[b]},refetch:h,setQuery:d,queryId:e,loading:p}),{items:i,isLoading:p,updatedAt:s}})({signalIndexName:e,queryId:kv,skip:!r}),{openTimelineWithFilters:d}=Object(mv.a)(),m=Object(n.useCallback)((e=>{d([[{field:"kibana.alert.rule.name",value:e},bv.d]])}),[d]),g=Object(n.useCallback)((()=>{a({deepLinkId:s.uc.alerts})}),[a]),b=Object(n.useMemo)((()=>(({getAppUrl:e,navigateTo:t,openRuleInTimeline:a})=>[{field:"name",name:gv.y,render:(a,{id:n})=>{const r=e({deepLinkId:s.uc.rules,path:`id/${n}`});return i.a.createElement(V.EuiToolTip,{"data-test-subj":`${n}-tooltip`,title:gv.u,content:a,anchorClassName:"eui-textTruncate"},i.a.createElement(V.EuiLink,{"data-test-subj":"severityRuleAlertsTable-name",href:r,onClick:e=>{e&&e.preventDefault(),t({url:r})}},a))}},{field:"last_alert_at",name:gv.x,"data-test-subj":"severityRuleAlertsTable-lastAlertAt",render:e=>i.a.createElement(dr.FormattedRelative,{value:new Date(e)})},{field:"alert_count",name:gv.w,"data-test-subj":"severityRuleAlertsTable-alertCount",render:(e,{name:t})=>i.a.createElement(V.EuiLink,{"data-test-subj":"severityRuleAlertsTable-alertCountLink",disabled:0===e,onClick:()=>a(t)},i.a.createElement(pv.a,{count:e}))},{field:"severity",name:gv.z,"data-test-subj":"severityRuleAlertsTable-severity",render:e=>i.a.createElement(V.EuiHealth,{color:bv.b[e]},Object(vE.capitalize)(e))}])({getAppUrl:t,navigateTo:a,openRuleInTimeline:m})),[t,a,m]);return i.a.createElement(Ta.a,{show:!0,targetClassNames:[Ne.a]},i.a.createElement(V.EuiPanel,{hasBorder:!0,"data-test-subj":"severityRuleAlertsPanel"},i.a.createElement(Tt.a,{id:kv,title:gv.A,titleSize:"s",toggleStatus:r,toggleQuery:o,subtitle:i.a.createElement(UE.a,{updatedAt:u,isUpdating:c})}),r&&i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiBasicTable,{"data-test-subj":"severityRuleAlertsTable",columns:b,items:l,loading:c,noItemsMessage:i.a.createElement(V.EuiEmptyPrompt,{title:i.a.createElement("h3",null,gv.p),titleSize:"xs"})}),i.a.createElement(V.EuiSpacer,{size:"m"}),i.a.createElement(V.EuiButton,{"data-test-subj":"severityRuleAlertsButton",onClick:g},gv.r))))}));Sv.displayName="RuleAlertsTable";const jv={pageCount:0,currentPage:0},Ov=({from:e,to:t,currentPage:a})=>({query:{bool:{filter:[{term:{"kibana.alert.workflow_status":"open"}},{range:{"@timestamp":{gte:e,lte:t}}}]}},size:0,aggs:{user_count:{cardinality:{field:"user.name"}},usersBySeverity:{terms:{size:100,field:"user.name",order:[{"critical.doc_count":"desc"},{"high.doc_count":"desc"},{"medium.doc_count":"desc"},{"low.doc_count":"desc"}]},aggs:{critical:{filter:{term:{"kibana.alert.severity":"critical"}}},high:{filter:{term:{"kibana.alert.severity":"high"}}},medium:{filter:{term:{"kibana.alert.severity":"medium"}}},low:{filter:{term:{"kibana.alert.severity":"low"}}},bucketOfPagination:{bucket_sort:{from:bv.a*a,size:4}}}}}}),wv="vulnerableUsersBySeverityQuery",Tv=i.a.memo((({signalIndexName:e})=>{const{openTimelineWithFilters:t}=Object(mv.a)(),a=Object(n.useCallback)((({userName:e,severity:a})=>{const n={field:"user.name",value:e},i=a?{field:"kibana.alert.severity",value:a}:void 0;t(i?[[n,bv.d,i]]:[[n,bv.d]])}),[t]),{toggleStatus:r,setToggleStatus:s}=Object(Ht.a)(wv),{items:o,isLoading:l,updatedAt:c,pagination:u}=(({skip:e,queryId:t,signalIndexName:a})=>{const[i,r]=Object(n.useState)(Date.now()),[s,o]=Object(n.useState)([]),[l,c]=Object(n.useState)(jv),{to:u,from:d,setQuery:p,deleteQuery:m}=Object(Y.a)(),{setQuery:g,data:b,loading:f,request:y,response:h,refetch:E}=Object(T.a)({query:Ov({from:d,to:u,currentPage:l.currentPage}),indexName:a,skip:e,queryName:I.a.VULNERABLE_USERS});Object(n.useEffect)((()=>{g(Ov({from:d,to:u,currentPage:l.currentPage}))}),[g,d,u,l.currentPage]),Object(n.useEffect)((()=>{var e,t;null!=b&&b.aggregations?(o((null!==(t=null==(e=b.aggregations)?void 0:e.usersBySeverity.buckets)&&void 0!==t?t:[]).reduce(((e,t)=>(e.push({userName:t.key||"—",totalAlerts:t.doc_count,low:t.low.doc_count,medium:t.medium.doc_count,high:t.high.doc_count,critical:t.critical.doc_count}),e)),[])),c((e=>{var t;return{...e,pageCount:Object(bv.c)(null===(t=b.aggregations)||void 0===t?void 0:t.user_count.value)}}))):o([]),r(Date.now())}),[b]);const v=Object(n.useCallback)((()=>{!e&&E&&E()}),[e,E]);return Object(As.b)({deleteQuery:m,inspect:{dsl:[y],response:[h]},refetch:v,setQuery:p,queryId:t,loading:f}),{items:s,isLoading:f,updatedAt:i,pagination:{...l,setPage:e=>{c((t=>({...t,currentPage:e})))}}}})({skip:!r,queryId:wv,signalIndexName:e}),d=Object(n.useMemo)((()=>Iv(a)),[a]);return i.a.createElement(Ta.a,{show:!0,targetClassNames:[Ne.a]},i.a.createElement(V.EuiPanel,{hasBorder:!0,"data-test-subj":"severityUserAlertsPanel"},i.a.createElement(Tt.a,{id:wv,title:gv.J,titleSize:"s",toggleStatus:r,toggleQuery:s,subtitle:i.a.createElement(UE.a,{updatedAt:c,isUpdating:l}),tooltip:gv.L}),r&&i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiBasicTable,{"data-test-subj":"severityUserAlertsTable",columns:d,items:o,loading:l,noItemsMessage:i.a.createElement(V.EuiEmptyPrompt,{title:i.a.createElement("h3",null,gv.p),titleSize:"xs"})}),i.a.createElement(V.EuiSpacer,{size:"m"}),u.pageCount>1&&i.a.createElement(V.EuiTablePagination,{"data-test-subj":"userTablePaginator",activePage:u.currentPage,itemsPerPage:bv.a,pageCount:u.pageCount,onChangePage:u.setPage,showPerPageOptions:!1}))))}));Tv.displayName="UserAlertsTable";const Iv=e=>[{field:"userName",name:gv.K,"data-test-subj":"userSeverityAlertsTable-userName",render:e=>i.a.createElement(V.EuiToolTip,{title:gv.v,content:e,anchorClassName:"eui-textTruncate"},i.a.createElement(be.m,{userName:e}))},{field:"totalAlerts",name:gv.c,"data-test-subj":"userSeverityAlertsTable-totalAlerts",render:(t,{userName:a})=>i.a.createElement(V.EuiLink,{"data-test-subj":"userSeverityAlertsTable-totalAlertsLink",disabled:0===t,onClick:()=>e({userName:a})},i.a.createElement(pv.a,{count:t}))},{field:"critical",name:gv.D,render:(t,{userName:a})=>i.a.createElement(V.EuiHealth,{"data-test-subj":"userSeverityAlertsTable-critical",color:bv.b.critical},i.a.createElement(V.EuiLink,{"data-test-subj":"userSeverityAlertsTable-criticalLink",disabled:0===t,onClick:()=>e({userName:a,severity:"critical"})},i.a.createElement(pv.a,{count:t})))},{field:"high",name:gv.E,render:(t,{userName:a})=>i.a.createElement(V.EuiHealth,{"data-test-subj":"userSeverityAlertsTable-high",color:bv.b.high},i.a.createElement(V.EuiLink,{disabled:0===t,onClick:()=>e({userName:a,severity:"high"})},i.a.createElement(pv.a,{count:t})))},{field:"medium",name:gv.H,render:(t,{userName:a})=>i.a.createElement(V.EuiHealth,{"data-test-subj":"userSeverityAlertsTable-medium",color:bv.b.medium},i.a.createElement(V.EuiLink,{disabled:0===t,onClick:()=>e({userName:a,severity:"medium"})},i.a.createElement(pv.a,{count:t})))},{field:"low",name:gv.G,render:(t,{userName:a})=>i.a.createElement(V.EuiHealth,{"data-test-subj":"userSeverityAlertsTable-low",color:bv.b.low},i.a.createElement(V.EuiLink,{disabled:0===t,onClick:()=>e({userName:a,severity:"low"})},i.a.createElement(pv.a,{count:t})))}],Cv={[jn.CaseStatuses.open]:{color:"primary",label:gv.I},[jn.CaseStatuses["in-progress"]]:{color:"warning",label:gv.F},[jn.CaseStatuses.closed]:{color:"default",label:gv.C}},Mv=({status:e})=>i.a.createElement(V.EuiBadge,{color:Cv[e].color,"data-test-subj":"case-status-badge"},Cv[e].label);Mv.displayName="StatusBadge";var Fv=a(402);const Dv="recentlyCreatedCasesQuery",Av=i.a.memo((()=>{const{getAppUrl:e,navigateTo:t}=Object(p.m)(),{toggleStatus:a,setToggleStatus:r}=Object(Ht.a)(Dv),{items:o,isLoading:l,updatedAt:c}=(({skip:e})=>{const{services:{cases:t}}=Object(p.k)(),{to:a,from:i,setQuery:r,deleteQuery:o}=Object(Y.a)(),[l,c]=Object(n.useState)(!0),[u,d]=Object(n.useState)(Date.now()),[m,g]=Object(n.useState)([]),b=Object(n.useMemo)((()=>`useCaseItems-${Ye.a.v4()}`),[]);return Object(n.useEffect)((()=>{let n=!0;const l=new AbortController,u=async()=>{try{const e=await t.api.cases.find({from:i,to:a,owner:s.p,sortField:"create_at",sortOrder:"desc",page:1,perPage:4});n&&(g(function(e){return(e.cases||[]).reduce(((e,t)=>(e.push({id:t.id,name:t.title,totalAlerts:t.totalAlerts,createdAt:t.createdAt,createdBy:t.createdBy.username||"—",status:t.status}),e)),[])}(e)),d(Date.now()))}catch(e){n&&Object(Fv.addError)(e,{title:gv.k})}c(!1)};return e||(u(),r({id:b,inspect:null,loading:!1,refetch:u})),e&&(c(!1),n=!1,l.abort()),()=>{n=!1,l.abort(),o({id:b})}}),[t.api.cases,i,e,a,r,o,b]),{items:m,isLoading:l,updatedAt:u}})({skip:!a}),u=Object(n.useCallback)((()=>{t({deepLinkId:k.a.case})}),[t]),d=Object(n.useMemo)((()=>_v({getAppUrl:e,navigateTo:t})),[e,t]);return i.a.createElement(Ta.a,{show:!0,targetClassNames:[Ne.a]},i.a.createElement(V.EuiPanel,{hasBorder:!0,"data-test-subj":"recentlyCreatedCasesPanel"},i.a.createElement(Tt.a,{id:Dv,title:gv.j,titleSize:"s",toggleStatus:a,toggleQuery:r,subtitle:i.a.createElement(UE.a,{updatedAt:c,isUpdating:l}),showInspectButton:!1}),a&&i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiBasicTable,{"data-test-subj":"recentlyCreatedCasesTable",columns:d,items:o,loading:l,noItemsMessage:i.a.createElement(V.EuiEmptyPrompt,{title:i.a.createElement("h3",null,gv.q),titleSize:"xs"})}),i.a.createElement(V.EuiSpacer,{size:"m"}),i.a.createElement(V.EuiButton,{"data-test-subj":"allCasesButton",onClick:u},gv.N))))}));Av.displayName="CasesTable";const _v=()=>[{field:"id",name:gv.g,"data-test-subj":"recentlyCreatedCaseName",render:(e,{name:t})=>i.a.createElement(V.EuiToolTip,{title:gv.s,content:t,anchorClassName:"eui-textTruncate"},i.a.createElement(be.a,{detailName:e},t))},{field:"totalAlerts",name:gv.c,truncateText:!0,textOnly:!0,"data-test-subj":"recentlyCreatedCaseAlert",render:e=>i.a.createElement(pv.a,{count:e})},{field:"createdAt",name:gv.i,render:e=>i.a.createElement(xa.a,{fieldName:gv.i,value:e,className:"eui-textTruncate",dateFormat:"MMMM D, YYYY"}),"data-test-subj":"recentlyCreatedCaseTime"},{field:"createdBy",name:gv.f,render:e=>i.a.createElement(V.EuiText,{"data-test-subj":"recentlyCreatedCaseCreatedBy",size:"s"},e)},{field:"status",name:gv.h,render:e=>i.a.createElement(Mv,{status:e}),"data-test-subj":"recentlyCreatedCaseStatus"}];var Nv=a(209);const Rv="casesByStatus",Pv={series:{xScaleType:Je.ScaleType.Ordinal,yScaleType:Je.ScaleType.Linear,stackAccessors:["g"],barSeriesStyle:{rect:{widthPixel:22,opacity:1}}},axis:{xTickFormatter:e=>e.toLocaleString(),left:{style:{tickLine:{size:0},tickLabel:{padding:16,fontSize:14}}},bottom:{style:{tickLine:{size:0},tickLabel:{padding:16,fontSize:10.5}},labelFormat:e=>qt()(e).format("0")}},settings:{rotation:90},customHeight:146},Lv=H()(V.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-1ovqqq4-0"})(["align-items:center;width:70%;"]),Bv=H.a.div.withConfig({displayName:"Wrapper",componentId:"sc-1ovqqq4-1"})(["width:100%;"]),qv=()=>{const{toggleStatus:e,setToggleStatus:t}=Object(Ht.a)(Rv),{getAppUrl:a,navigateTo:r}=Object(p.m)(),{search:o}=Object(d.n)(s.uc.case),l=a({deepLinkId:s.uc.case,path:Object(Nv.a)(o)}),c=Object(n.useCallback)((e=>{e.preventDefault(),r({url:l})}),[l,r]),{closed:u,inProgress:m,isLoading:g,open:b,totalCounts:f,updatedAt:y}=(({skip:e=!1})=>{var t,a,i,r,o,l;const{services:{cases:c}}=Object(p.k)(),{to:u,from:d,setQuery:m,deleteQuery:g}=Object(Y.a)(),b=Object(n.useMemo)((()=>`useCaseItems-${Ye.a.v4()}`),[]),[f,y]=Object(n.useState)(Date.now()),[h,E]=Object(n.useState)(!0),[v,x]=Object(n.useState)(null);return Object(n.useEffect)((()=>{let t=!0;const a=new AbortController,n=async()=>{try{const e=await c.api.cases.getCasesStatus({from:d,to:u,owner:s.p},a.signal);t&&x(e)}catch(e){t&&x(null)}t&&(E(!1),y(Date.now()))};return e||(n(),m({id:b,inspect:null,loading:!1,refetch:n})),e&&(E(!1),t=!1,a.abort()),()=>{t=!1,a.abort(),g({id:b})}}),[c.api.cases,d,e,u,m,g,b]),{closed:null!==(t=null==v?void 0:v.countClosedCases)&&void 0!==t?t:0,inProgress:null!==(a=null==v?void 0:v.countInProgressCases)&&void 0!==a?a:0,isLoading:h,open:null!==(i=null==v?void 0:v.countOpenCases)&&void 0!==i?i:0,totalCounts:(null!==(r=null==v?void 0:v.countClosedCases)&&void 0!==r?r:0)+(null!==(o=null==v?void 0:v.countInProgressCases)&&void 0!==o?o:0)+(null!==(l=null==v?void 0:v.countOpenCases)&&void 0!==l?l:0),updatedAt:f}})({skip:!e}),h=Object(n.useMemo)((()=>[{key:"open",value:[{y:b,x:gv.I,g:gv.I}],color:"#79aad9"},{key:"in-progress",value:[{y:m,x:gv.F,g:gv.F}],color:"#f1d86f"},{key:"closed",value:[{y:u,x:gv.C,g:gv.C}],color:"#d3dae6"}]),[u,m,b]);return i.a.createElement(V.EuiPanel,{hasBorder:!0},i.a.createElement(Tt.a,{id:Rv,title:gv.e,titleSize:"s",toggleStatus:e,toggleQuery:t,subtitle:i.a.createElement(UE.a,{updatedAt:y,isUpdating:g}),showInspectButton:!1},i.a.createElement(V.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(be.g,{href:l,onClick:c},gv.M)))),!g&&e&&i.a.createElement(V.EuiFlexGroup,{justifyContent:"center",alignItems:"center",direction:"column",gutterSize:"s"},i.a.createElement(V.EuiFlexItem,null,0!==f&&i.a.createElement(V.EuiText,{className:"eui-textCenter",size:"s",grow:!1},i.a.createElement(i.a.Fragment,null,i.a.createElement("b",null,i.a.createElement(dr.FormattedNumber,{value:f}))," ",i.a.createElement("span",null," ",Object(gv.d)(f))))),i.a.createElement(Lv,{grow:!1},i.a.createElement(Bv,{"data-test-subj":"chart-wrapper"},i.a.createElement(Kd.a,{configs:Pv,barChart:h})))))},zv=i.a.memo(qv),$v=()=>{const{docLinks:e}=Object(p.k)().services,t=Object(n.useMemo)((()=>({feature:{icon:"documents",label:id.d,url:`${e.links.siem.privileges}`,target:"_blank"}})),[e]);return i.a.createElement(ce.a,{"data-test-subj":"noPermissionPage",actions:t,title:id.g,message:id.f})},Vv=()=>{const{indicesExist:e,indexPattern:t,loading:a}=Object(g.d)(),{signalIndexName:n}=Object(Ji.a)(),{hasKibanaREAD:r,hasIndexRead:s}=Object(oa.a)(),o=Object(p.i)().read,l=r&&s,c=Object(B.a)("socTrendsEnabled");return l||o?i.a.createElement(i.a.Fragment,null,e?i.a.createElement(i.a.Fragment,null,i.a.createElement(y.a,{"data-test-subj":"detectionResponsePage"},i.a.createElement(ta.a,{title:id.b},i.a.createElement(Z.a,{id:K.a.global,indexPattern:t,hideFilterBar:!0,hideQueryInput:!0})),a?i.a.createElement(V.EuiLoadingSpinner,{size:"l","data-test-subj":"detectionResponseLoader"}):i.a.createElement(V.EuiFlexGroup,{direction:"column","data-test-subj":"detectionResponseSections"},i.a.createElement(V.EuiFlexItem,null,i.a.createElement(V.EuiFlexGroup,null,l&&i.a.createElement(V.EuiFlexItem,null,i.a.createElement(Yi.a,{signalIndexName:n})),o&&i.a.createElement(V.EuiFlexItem,null,i.a.createElement(zv,null)))),i.a.createElement(V.EuiFlexItem,null,i.a.createElement(V.EuiFlexGroup,null,i.a.createElement(V.EuiFlexItem,null,i.a.createElement(V.EuiFlexGroup,{direction:"column"},l&&i.a.createElement(V.EuiFlexItem,null,i.a.createElement(Sv,{signalIndexName:n})),o&&i.a.createElement(V.EuiFlexItem,null,i.a.createElement(Av,null)))),c&&i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(dv,{signalIndexName:n})))),l&&i.a.createElement(V.EuiFlexItem,null,i.a.createElement(V.EuiFlexGroup,null,i.a.createElement(V.EuiFlexItem,null,i.a.createElement(Ev,{signalIndexName:n})),i.a.createElement(V.EuiFlexItem,null,i.a.createElement(Tv,{signalIndexName:n}))))))):i.a.createElement(aa.a,null),i.a.createElement(E.a,{pageName:k.a.detectionAndResponse})):i.a.createElement($v,null)},Uv=i.a.memo(Vv);var Hv=a(382),Gv=a(823),Qv=a(594);const Wv=({fieldName:e,fieldValue:t,idPrefix:a,onFilterAdded:r})=>{const s=Object(n.useMemo)((()=>Object(nt.h)(`${a}-${e}-${t}`)),[a,e,t]),o=Object(n.useMemo)((()=>({and:[],enabled:!0,id:s,name:t,excluded:!1,kqlQuery:"",queryMatch:{field:e,value:t,displayValue:t,operator:ua.a}})),[e,t,s]);return i.a.createElement(Qv.a,{applyWidthAndPadding:!0,closeTopN:v.noop,dataProvider:o,dataType:"string",field:e,fieldType:"keyword",hideTopN:!0,isAggregatable:!0,isObjectArray:!1,onFilterAdded:r,ownFocus:!1,scopeId:k.a.entityAnalytics,showTopN:!1,toggleTopN:v.noop,values:[t]})};Wv.displayName="EntityAnalyticsHoverActions";var Kv=a(558),Yv=a(855),Jv=a(925),Xv=a(865);const Zv=e=>{var t;return null!==(t=Zn.a[e.dataName])&&void 0!==t?t:Kv.b},ex=H()(V.EuiFlexItem).withConfig({displayName:"DonutContainer",componentId:"sc-1tc3rph-0"})(["padding-right:",";padding-left:",";"],(({theme:e})=>e.eui.euiSizeXXL),(({theme:e})=>e.eui.euiSizeM)),tx=H()(V.EuiFlexItem).withConfig({displayName:"StyledLegendItems",componentId:"sc-1tc3rph-1"})(["justify-content:center;"]),ax=({severityCount:e})=>{const[t,a,r]=(e=>{const[t,a,i]=Object(n.useMemo)((()=>{const t=Object.keys(Zn.a);return[t.map((t=>({key:t,value:e[t]}))),t.map((e=>({color:Zn.a[e],field:"kibana.alert.severity",value:e}))),Object(v.sum)(Object.values(e))]}),[e]);return[t,a,i]})(e);return i.a.createElement(V.EuiFlexGroup,{responsive:!1},i.a.createElement(tx,{grow:!1},a.length>0&&i.a.createElement(Jv.a,{legendItems:a})),i.a.createElement(ex,{grow:!1,className:"eui-textCenter"},i.a.createElement(Yv.a,{data:null!=t?t:null,fillColor:Zv,height:120,label:Wo.c,title:i.a.createElement(Xv.a,{count:r}),totalCount:r})))},nx=H()(V.EuiBasicTable).withConfig({displayName:"StyledBasicTable",componentId:"sc-1ftog4t-0"})([".euiTableRow{.euiTableRowCell{border-bottom:none !important;}}.timelines__hoverActionButton{opacity:0;}.EntityAnalyticsTableHoverActions{.hoverActions-active{.timelines__hoverActionButton,.securitySolution__hoverActionButton{opacity:1;}}&:hover{.timelines__hoverActionButton,.securitySolution__hoverActionButton{opacity:1;}}}"]);var ix=a(149);const rx=({riskEntity:e})=>{const{deleteQuery:t,setQuery:a,from:r,to:l}=Object(Y.a)(),[c,u]=Object(n.useState)(Date.now()),d=Object(o.useDispatch)(),p=Object(n.useMemo)((()=>e===Jn.v.host?{docLink:s.dc,linkProps:{deepLinkId:k.a.hosts,path:Object(Hv.c)(tl.HostsTableType.risk),onClick:()=>{d(Es.a.updateHostRiskScoreSeverityFilter({severitySelection:[],hostsType:tl.HostsType.page}))}},tableQueryId:"hostRiskDashboardTable",kpiQueryId:"headerHostRiskScoreKpiQuery"}:{docLink:s.fc,linkProps:{deepLinkId:k.a.users,path:Object(si.b)(dm.UsersTableType.risk),onClick:()=>{d(vs.b.updateUserRiskScoreSeverityFilter({severitySelection:[]}))}},tableQueryId:"userRiskDashboardTable",kpiQueryId:"headerUserRiskScoreKpiQuery"}),[d,e]),{openTimelineWithFilters:m}=Object(mv.a)(),g=Object(n.useCallback)(((t,a)=>{const n=a?{kind:"relative",from:null!=a?a:"",fromStr:null!=a?a:"",to:(new Date).toISOString(),toStr:"now"}:void 0,i={field:e===Jn.v.host?"host.name":"user.name",value:t};m([[i,bv.d]],n)}),[e,m]),{toggleStatus:b,setToggleStatus:f}=Object(Ht.a)(p.tableQueryId),y=Object(n.useMemo)((()=>((e,t)=>[{field:e===Jn.v.host?"host.name":"user.name",name:Gv.b(e),truncateText:!1,mobileOptions:{show:!0},render:t=>null!=t&&t.length>0?e===Jn.v.host?i.a.createElement(i.a.Fragment,null,i.a.createElement(be.d,{hostName:t,hostTab:tl.HostsTableType.risk}),i.a.createElement(Wv,{idPrefix:`hosts-risk-table-${t}`,fieldName:"host.name",fieldValue:t})):i.a.createElement(i.a.Fragment,null,i.a.createElement(be.m,{userName:t,userTab:dm.UsersTableType.risk}),i.a.createElement(Wv,{idPrefix:`users-risk-table-${t}`,fieldName:"user.name",fieldValue:t})):Object(Xn.d)()},{field:e===Jn.v.host?Jn.w.hostRiskScore:Jn.w.userRiskScore,width:"15%",name:Gv.f(e),truncateText:!0,mobileOptions:{show:!0},render:e=>null!=e?i.a.createElement("span",{"data-test-subj":"risk-score-truncate",title:`${e}`},Math.round(e)):Object(Xn.d)()},{field:e===Jn.v.host?Jn.w.hostRisk:Jn.w.userRisk,width:"30%",name:i.a.createElement(V.EuiToolTip,{content:Gv.d(e)},i.a.createElement(i.a.Fragment,null,Gv.c(e),i.a.createElement(V.EuiIcon,{color:"subdued",type:"iInCircle",className:"eui-alignTop"}))),truncateText:!1,mobileOptions:{show:!0},render:e=>null!=e?i.a.createElement(Zn.b,{severity:e}):Object(Xn.d)()},{field:Jn.w.alertsCount,width:"10%",name:Gv.a,truncateText:!1,mobileOptions:{show:!0},render:(e,a)=>i.a.createElement(V.EuiLink,{"data-test-subj":"risk-score-alerts",disabled:0===e,onClick:()=>{var e;return t(null!==(e=Object(v.get)("host.name",a))&&void 0!==e?e:Object(v.get)("user.name",a),a.oldestAlertTimestamp)}},i.a.createElement(pv.a,{count:e}))}])(e,g)),[e,g]),[h,E]=Object(n.useState)([]),S=Object(be.o)(),j=Object(n.useMemo)((()=>{const[t]=Object(nm.a)(h,e);return t?JSON.stringify(t.query):void 0}),[e,h]),O=Object(n.useMemo)((()=>({from:r,to:l})),[r,l]),{severityCount:w,loading:T,refetch:I,inspect:C}=Object(Yn.d)({filterQuery:j,skip:!b,timerange:O,riskEntity:e});Object(As.b)({queryId:p.kpiQueryId,loading:T,refetch:I,setQuery:a,deleteQuery:t,inspect:C});const{data:M,loading:F,inspect:D,refetch:A,isDeprecated:_,isLicenseValid:N,isModuleEnabled:R}=Object(Yn.c)({filterQuery:j,skip:!b,pagination:{cursorStart:0,querySize:5},timerange:O,riskEntity:e,includeAlertsCount:!0});Object(As.b)({queryId:p.tableQueryId,loading:F,refetch:A,setQuery:a,deleteQuery:t,inspect:D}),Object(n.useEffect)((()=>{u(Date.now())}),[F,T]);const[P,L]=Object(n.useMemo)((()=>{const{onClick:e,href:t}=S(p.linkProps);return[e,t]}),[p.linkProps,S]),B=(()=>{const e=Object(n.useMemo)((()=>Object(ix.h)()),[]),t=Object(x.a)((t=>e(t,K.a.global)));return Object(n.useCallback)((()=>{t.forEach((e=>e.refetch&&e.refetch()))}),[t])})();if(!N)return null;const q={isDisabled:!R&&!F,isDeprecated:_&&!F};return q.isDisabled||q.isDeprecated?i.a.createElement(hs,lr()({},q,{entityType:e,refetch:B,timerange:O})):R&&0===h.length&&M&&0===M.length?i.a.createElement(Yo,{entityType:e,refetch:B}):i.a.createElement(Ne.c,null,i.a.createElement(pl.a,{hasBorder:!0,"data-test-subj":`entity_analytics_${e}s`},i.a.createElement(Tt.a,{title:i.a.createElement(cs.a,{riskScoreEntity:e}),titleSize:"s",subtitle:i.a.createElement(UE.a,{isUpdating:F||T,updatedAt:c}),id:p.tableQueryId,toggleStatus:b,toggleQuery:f,tooltip:Wo.a},b&&i.a.createElement(V.EuiFlexGroup,{alignItems:"center",gutterSize:"m"},i.a.createElement(V.EuiFlexItem,null,i.a.createElement(V.EuiButtonEmpty,{rel:"noopener nofollow noreferrer",href:p.docLink,target:"_blank"},Gv.e)),i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(Su,{selectedSeverities:h,severityCount:null!=w?w:Jn.c,title:Gv.c(e),onSelect:E})),i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(be.g,{"data-test-subj":"view-all-button",onClick:P,href:L},Gv.g)))),b&&i.a.createElement(V.EuiFlexGroup,{"data-test-subj":"entity_analytics_content"},i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(ax,{severityCount:null!=w?w:Jn.c})),i.a.createElement(V.EuiFlexItem,null,i.a.createElement(nx,{responsive:!1,items:null!=M?M:[],columns:y,loading:F,id:p.tableQueryId,rowProps:{className:"EntityAnalyticsTableHoverActions"}}))),(F||T)&&i.a.createElement(ji.a,{"data-test-subj":"loadingPanelRiskScore",overlay:!0,size:"xl"})))},sx=i.a.memo(rx);sx.displayName="EntityAnalyticsRiskScores";var ox=a(3);const lx=z.i18n.translate("xpack.securitySolution.paywall.platinum",{defaultMessage:"Platinum"}),cx=z.i18n.translate("xpack.securitySolution.paywall.upgradeMessage",{defaultMessage:"This feature is available with Platinum or higher subscription"}),ux=z.i18n.translate("xpack.securitySolution.paywall.upgradeButton",{defaultMessage:"Upgrade to Platinum"});var dx=a(1264),px=a.n(dx);const mx=H.a.div.withConfig({displayName:"PaywallDiv",componentId:"sc-10p6lrh-0"})(["max-width:75%;margin:0 auto;.euiCard__betaBadgeWrapper{.euiCard__betaBadge{width:auto;}}.platinumCardDescription{padding:0 15%;}"]),gx=H()(V.EuiCard).withConfig({displayName:"StyledEuiCard",componentId:"sc-10p6lrh-1"})(["span.euiTitle{max-width:540px;display:block;margin:0 auto;}"]),bx=Object(n.memo)((({heading:e})=>{const{getAppUrl:t,navigateTo:a}=Object(p.m)(),r=t({appId:"management",path:"stack/license_management"}),s=Object(n.useCallback)((()=>{a({url:r})}),[a,r]);return i.a.createElement(mx,null,i.a.createElement(gx,{"data-test-subj":"platinumCard",betaBadgeProps:{label:lx},icon:i.a.createElement(V.EuiIcon,{size:"xl",type:"lock"}),display:"subdued",title:i.a.createElement("h3",null,i.a.createElement("strong",null,e)),description:!1,paddingSize:"xl"},i.a.createElement(V.EuiFlexGroup,{className:"platinumCardDescription",direction:"column",gutterSize:"none"},i.a.createElement(V.EuiText,null,i.a.createElement(V.EuiFlexItem,null,i.a.createElement("p",null,i.a.createElement(V.EuiTextColor,{color:"subdued"},cx))),i.a.createElement(V.EuiFlexItem,null,i.a.createElement("div",null,i.a.createElement(V.EuiButton,{onClick:s,fill:!0},ux)))))),i.a.createElement(V.EuiFlexGroup,null,i.a.createElement(V.EuiFlexItem,null,i.a.createElement(V.EuiImage,{alt:cx,src:px.a,size:"fullWidth"}))))}));bx.displayName="Paywall";const fx=z.i18n.translate("xpack.securitySolution.entityAnalytics.header.criticalHosts",{defaultMessage:"Critical Hosts"}),yx=z.i18n.translate("xpack.securitySolution.entityAnalytics.header.criticalUsers",{defaultMessage:"Critical Users"}),hx=z.i18n.translate("xpack.securitySolution.entityAnalytics.header.anomalies",{defaultMessage:"Anomalies"});var Ex=a(868);const vx=["auth_rare_source_ip_for_a_user","packetbeat_dns_tunneling","packetbeat_rare_server_domain","packetbeat_rare_dns_question","suspicious_login_activity","v3_windows_anomalous_script"];var xx=a(378);let kx;!function(e){e[e.User=0]="User",e[e.Host=1]="Host"}(kx||(kx={}));const Sx=({skip:e,from:t,to:a})=>{const[i,r]=Object(n.useState)(jx([],[])),{loading:o,isMlAdmin:l,jobs:c,refetch:u}=Object(xx.a)(),[d,m]=Object(n.useState)(!0),{addError:g}=Object(Oi.a)(),[b]=Object(p.q)(s.K),{notableAnomaliesJobs:f,query:y}=Object(n.useMemo)((()=>{const e=c.filter((({id:e})=>vx.some((t=>Ox(e,t))))),n=(({from:e,to:t,jobIds:a,anomalyScoreThreshold:n})=>({size:0,query:{bool:{filter:[{term:{result_type:"record"}},{range:{record_score:{gte:n}}},{range:{timestamp:{gte:e,lte:t}}},{terms:{job_id:a}}]}},aggs:{number_of_anomalies:{terms:{field:"job_id"},aggs:{entity:{top_hits:{_source:{includes:["host.name","user.name"]},size:1}}}}}}))({jobIds:e.map((({id:e})=>e)),anomalyScoreThreshold:b,from:t,to:a});return{query:n,notableAnomaliesJobs:e}}),[c,b,t,a]);return Object(n.useEffect)((()=>{let t=!0;const a=new AbortController;return async function(){if(t)if(!e&&l&&0!==f.length){m(!0);try{const e=await(async(e,t)=>p.b.get().http.fetch("/api/ml/results/anomaly_search",{method:"POST",body:JSON.stringify(e),asSystemRequest:!0,signal:t}))({jobIds:f.filter((e=>e.isInstalled)).map((({id:e})=>e)),query:y},a.signal);if(t){var n,i;m(!1);const t=null!==(n=null===(i=e.aggregations)||void 0===i?void 0:i.number_of_anomalies.buckets)&&void 0!==n?n:[];r(jx(t,f))}}catch(e){t&&"AbortError"!==e.name&&(g(e,{title:Ex.a}),m(!1))}}else m(!1)}(),()=>{t=!1,a.abort()}}),[e,l,g,y,f,u]),{isLoading:d||o,data:i,refetch:u}};function jx(e,t){return vx.map((a=>{var n;const i=wx(a)(t),r=e.find((({key:e})=>e===(null==i?void 0:i.id))),s=Object(v.has)("entity.hits.hits[0]._source['user.name']",r);return{name:a,count:null!==(n=null==r?void 0:r.doc_count)&&void 0!==n?n:0,entity:s?kx.User:kx.Host,job:i}}))}const Ox=(e,t)=>e.endsWith(t),wx=e=>Object(v.pipe)(Object(v.filter)((({id:t})=>Ox(t,e))),Object(v.orderBy)("latestTimestampSortValue","desc"),v.head);var Tx=a(62);const Ix=z.i18n.translate("xpack.securitySolution.entityAnalytics.anomalies.anomaliesTitle",{defaultMessage:"Notable Anomalies"}),Cx=z.i18n.translate("xpack.securitySolution.entityAnalytics.anomalies.anomalyName",{defaultMessage:"Anomaly name"}),Mx=z.i18n.translate("xpack.securitySolution.entityAnalytics.anomalies.anomalyCount",{defaultMessage:"Count"}),Fx=z.i18n.translate("xpack.securitySolution.entityAnalytics.anomalies.viewUsersAnomalies",{defaultMessage:"View all user anomalies"}),Dx=z.i18n.translate("xpack.securitySolution.entityAnalytics.anomalies.viewHostsAnomalies",{defaultMessage:"View all host anomalies"}),Ax=z.i18n.translate("xpack.securitySolution.entityAnalytics.anomalies.viewAnomalies",{defaultMessage:"View all"}),_x=z.i18n.translate("xpack.securitySolution.entityAnalytics.anomalies.enableJob",{defaultMessage:"Run job"}),Nx=(z.i18n.translate("xpack.securitySolution.entityAnalytics.anomalies.jobStatusDisabled",{defaultMessage:"disabled"}),z.i18n.translate("xpack.securitySolution.entityAnalytics.anomalies.jobStatusUninstalled",{defaultMessage:"uninstalled"}),z.i18n.translate("xpack.securitySolution.entityAnalytics.anomalies.jobStatusFailed",{defaultMessage:"failed"})),Rx=e=>z.i18n.translate("xpack.securitySolution.entityAnalytics.anomalies.moduleNotCompatibleTitle",{values:{incompatibleJobCount:e},defaultMessage:"{incompatibleJobCount} {incompatibleJobCount, plural, =1 {job is} other {jobs are}} currently unavailable"}),Px=z.i18n.translate("xpack.securitySolution.entityAnalytics.anomalies.AnomalyDetectionDocsTitle",{defaultMessage:"Anomaly Detection with Machine Learning"}),Lx=H.a.span.withConfig({displayName:"MediumShadeText",componentId:"sc-16wzidn-0"})(["color:",";"],(({theme:e})=>e.eui.euiColorMediumShade)),Bx=({job:e,isLoading:t,onJobStateChange:a})=>{const r=Object(n.useCallback)((()=>a(e)),[e,a]);return t||Object(Ks.b)(e.jobState,e.datafeedState)?i.a.createElement(V.EuiLoadingSpinner,{size:"m","data-test-subj":"job-switch-loader"}):i.a.createElement(be.f,{onClick:r,"data-test-subj":"enable-job"},_x)},qx=({count:e,jobId:t,entity:a})=>{const r=Object(o.useDispatch)(),s=a===kx.User?k.a.usersAnomalies:k.a.hostsAnomalies,l=Object(n.useCallback)((()=>{t&&(a===kx.User?(r(vs.b.updateUsersAnomaliesJobIdFilter({jobIds:[t],usersType:dm.UsersType.page})),r(vs.b.updateUsersAnomaliesInterval({interval:"second",usersType:dm.UsersType.page}))):(r(Es.a.updateHostsAnomaliesJobIdFilter({jobIds:[t],hostsType:tl.HostsType.page})),r(Es.a.updateHostsAnomaliesInterval({interval:"second",hostsType:tl.HostsType.page}))))}),[t,r,a]);return i.a.createElement(be.k,{onClick:l,deepLinkId:s},e)};var zx=a(518);const $x="entityAnalyticsDashboardAnomaliesTable",Vx={sort:{field:"count",direction:"desc"}},Ux=()=>{const{services:{ml:e,http:t,docLinks:a}}=Object(p.k)(),r=Object(Tx.useMlHref)(e,t.basePath.get(),{page:Tx.ML_PAGES.ANOMALY_DETECTION_JOBS_MANAGE}),[s,o]=Object(n.useState)(Date.now()),{toggleStatus:l,setToggleStatus:c}=Object(Ht.a)($x),{deleteQuery:u,setQuery:d,from:m,to:g}=Object(Y.a)(!1),{isLoading:b,data:f,refetch:y}=Sx({skip:!l,from:m,to:g}),{isLoading:h,enableDatafeed:E}=Object(zx.a)(),v=Object(n.useCallback)((async e=>{const t=await E(e,e.latestTimestampMs||0,!0);return y(),t}),[y,E]),x=(S=b||h,j=v,Object(n.useMemo)((()=>[{field:"name",name:Cx,truncateText:!0,mobileOptions:{show:!0},"data-test-subj":"anomalies-table-column-name",render:(e,{count:t,job:a})=>t>0||a&&Object(Ks.c)(a.jobState,a.datafeedState)?e:i.a.createElement(Lx,null,e)},{field:"count",sortable:({count:e,job:t})=>e>0?e:t&&Object(Ks.c)(t.jobState,t.datafeedState)?0:-1,truncateText:!0,align:"right",name:Mx,mobileOptions:{show:!0},width:"15%","data-test-subj":"anomalies-table-column-count",render:(e,{entity:t,job:a})=>a?e>0||Object(Ks.c)(a.jobState,a.datafeedState)?i.a.createElement(qx,{count:e,jobId:a.id,entity:t}):Object(Ks.a)(a.jobState,a.datafeedState)?Nx:a.isCompatible?i.a.createElement(Bx,{job:a,isLoading:S,onJobStateChange:j}):i.a.createElement(V.EuiIcon,{"aria-label":"Warning",size:"s",type:"alert",color:"warning"}):""}]),[S,j]));var S,j;const O=Object(be.o)();Object(n.useEffect)((()=>{o(Date.now())}),[b]),Object(As.b)({refetch:y,queryId:$x,loading:b,setQuery:d,deleteQuery:u});const[w,T]=Object(n.useMemo)((()=>{const{onClick:e,href:t}=O({deepLinkId:k.a.hosts,path:Object(Hv.c)(tl.HostsTableType.anomalies)});return[e,t]}),[O]),[I,C]=Object(n.useMemo)((()=>{const{onClick:e,href:t}=O({deepLinkId:k.a.users,path:Object(si.b)(dm.UsersTableType.anomalies)});return[e,t]}),[O]),M=Object(n.useMemo)((()=>f.filter((({job:e})=>!!e&&e.isInstalled)).map((({job:e})=>{var t;return null!==(t=null==e?void 0:e.id)&&void 0!==t?t:""}))),[f]),F=Object(n.useMemo)((()=>f.filter((({job:e})=>e&&!e.isCompatible)).length),[f]);return i.a.createElement(V.EuiPanel,{hasBorder:!0,"data-test-subj":"entity_analytics_anomalies"},i.a.createElement(Tt.a,{title:Ix,titleSize:"s",subtitle:i.a.createElement(UE.a,{isUpdating:b,updatedAt:s}),toggleStatus:l,toggleQuery:c},i.a.createElement(V.EuiFlexGroup,{alignItems:"center"},i.a.createElement(V.EuiFlexItem,null,i.a.createElement(be.f,{"data-test-subj":"anomalies_table_hosts_link",onClick:w,href:T,className:"eui-textNoWrap"},Dx)),i.a.createElement(V.EuiFlexItem,null,i.a.createElement(be.f,{"data-test-subj":"anomalies_table_users_link",onClick:I,href:C,className:"eui-textNoWrap"},Fx)),i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(be.g,{"data-test-subj":"anomalies_table_all",href:r,target:"_blank"},Ax)))),l&&i.a.createElement(i.a.Fragment,null,F>0&&i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiCallOut,{title:Rx(F),"data-test-subj":"incompatible_jobs_warnings",color:"warning",iconType:"alert",size:"s"},i.a.createElement("p",null,i.a.createElement(dr.FormattedMessage,{defaultMessage:"We could not find any data, see {mlDocs} for more information on Machine Learning job requirements.",id:"xpack.securitySolution.components.mlPopup.moduleNotCompatibleDescription",values:{mlDocs:i.a.createElement("a",{href:`${a.links.siem.ml}`,rel:"noopener noreferrer",target:"_blank"},Px)}}))),i.a.createElement(V.EuiSpacer,{size:"m"})),i.a.createElement(Tx.MLJobsAwaitingNodeWarning,{jobIds:M}),i.a.createElement(V.EuiInMemoryTable,{responsive:!1,items:f,columns:x,loading:b,id:$x,sorting:Vx})))},Hx=H()(V.EuiTitle).withConfig({displayName:"StyledEuiTitle",componentId:"sc-yr7774-0"})(["color:",";"],(({theme:{eui:e}})=>e.euiColorDanger)),Gx=()=>{const{from:e,to:t}=Object(Y.a)(!1),a=Object(n.useMemo)((()=>({from:e,to:t})),[e,t]),{severityCount:r,loading:s,inspect:l,refetch:c}=Object(Yn.d)({timerange:a,riskEntity:Jn.v.host}),{severityCount:u,loading:d,refetch:p,inspect:m}=Object(Yn.d)({timerange:a,riskEntity:Jn.v.user}),{data:g}=Sx({skip:!1,from:e,to:t}),b=Object(o.useDispatch)(),f=Object(be.o)(),y=Object(ar.a)().isPlatinumOrTrialLicense,[h,E]=Object(n.useMemo)((()=>{const{onClick:e,href:t}=f({deepLinkId:k.a.hosts,path:Object(Hv.c)(tl.HostsTableType.risk),onClick:()=>{b(Es.a.updateHostRiskScoreSeverityFilter({severitySelection:[Jn.x.critical],hostsType:tl.HostsType.page})),b(Es.a.updateHostRiskScoreSort({sort:{field:Jn.w.hostRiskScore,direction:Jn.b.desc},hostsType:tl.HostsType.page}))}});return[e,t]}),[b,f]),[x,S]=Object(n.useMemo)((()=>{const{onClick:e,href:t}=f({deepLinkId:k.a.users,path:Object(si.b)(dm.UsersTableType.risk),onClick:()=>{b(vs.b.updateUserRiskScoreSeverityFilter({severitySelection:[Jn.x.critical]})),b(vs.b.updateTableSorting({sort:{field:Jn.w.userRiskScore,direction:Jn.b.desc},tableType:dm.UsersTableType.risk}))}});return[e,t]}),[b,f]),{deleteQuery:j,setQuery:O}=Object(Y.a)();Object(As.b)({queryId:"userRiskScoreKpiQuery",loading:d,refetch:p,setQuery:O,deleteQuery:j,inspect:m}),Object(As.b)({queryId:"hostRiskScoreKpiQuery",loading:s,refetch:c,setQuery:O,deleteQuery:j,inspect:l});const w=Object(n.useMemo)((()=>g.some((({job:e,count:t})=>t>0||e&&Object(Ks.c)(e.jobState,e.datafeedState)))),[g]),T=Object(n.useMemo)((()=>w?i.a.createElement(pv.a,{count:Object(v.sumBy)("count",g)}):"-"),[g,w]),I=Object(n.useCallback)((()=>{const e=document.querySelector('[data-test-subj="entity_analytics_anomalies"]');e&&e.scrollIntoView({behavior:"smooth"})}),[]);return i.a.createElement(V.EuiPanel,{hasBorder:!0,paddingSize:"l"},i.a.createElement(V.EuiFlexGroup,{justifyContent:"spaceAround",responsive:!1},y&&i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiFlexGroup,{direction:"column",gutterSize:"s",responsive:!1},i.a.createElement(V.EuiFlexItem,{className:"eui-textCenter"},i.a.createElement(Hx,{"data-test-subj":"critical_hosts_quantity",size:"l"},i.a.createElement("span",null,r?i.a.createElement(pv.a,{count:r[Jn.x.critical]}):"-"))),i.a.createElement(V.EuiFlexItem,null,i.a.createElement(be.f,{onClick:h,href:E,"data-test-subj":"critical_hosts_link"},fx)))),y&&i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiFlexGroup,{direction:"column",gutterSize:"s",responsive:!1},i.a.createElement(V.EuiFlexItem,{className:"eui-textCenter"},i.a.createElement(Hx,{"data-test-subj":"critical_users_quantity",size:"l"},i.a.createElement("span",null,u?i.a.createElement(pv.a,{count:u[Jn.x.critical]}):"-"))),i.a.createElement(V.EuiFlexItem,null,i.a.createElement(be.f,{onClick:x,href:S,"data-test-subj":"critical_users_link"},yx)))),i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiFlexGroup,{direction:"column",gutterSize:"s",responsive:!1},i.a.createElement(V.EuiFlexItem,{className:"eui-textCenter"},i.a.createElement(V.EuiTitle,{"data-test-subj":"anomalies_quantity",size:"l"},i.a.createElement("span",null,T))),i.a.createElement(V.EuiFlexItem,null,i.a.createElement(V.EuiLink,{"data-test-subj":"all_anomalies_link",onClick:I},hx))))))},Qx=()=>{const{indicesExist:e,loading:t,indexPattern:a}=Object(g.d)(),{isPlatinumOrTrialLicense:n,capabilitiesFetched:r}=Object(ar.a)();return i.a.createElement(i.a.Fragment,null,e?i.a.createElement(i.a.Fragment,null,i.a.createElement(y.a,{"data-test-subj":"entityAnalyticsPage"},i.a.createElement(ta.a,{title:ox.i},n&&r&&i.a.createElement(Z.a,{id:K.a.global,indexPattern:a,hideFilterBar:!0,hideQueryInput:!0})),!n&&r?i.a.createElement(bx,{heading:id.c}):t?i.a.createElement(V.EuiLoadingSpinner,{size:"l","data-test-subj":"entityAnalyticsLoader"}):i.a.createElement(V.EuiFlexGroup,{direction:"column","data-test-subj":"entityAnalyticsSections"},i.a.createElement(V.EuiFlexItem,null,i.a.createElement(Gx,null)),i.a.createElement(V.EuiFlexItem,null,i.a.createElement(sx,{riskEntity:Jn.v.host})),i.a.createElement(V.EuiFlexItem,null,i.a.createElement(sx,{riskEntity:Jn.v.user})),i.a.createElement(V.EuiFlexItem,null,i.a.createElement(Ux,null))))):i.a.createElement(aa.a,null),i.a.createElement(E.a,{pageName:k.a.entityAnalytics}))},Wx=i.a.memo(Qx),Kx=[{path:s.Zb,component:()=>i.a.createElement(_,null,i.a.createElement(r.TrackApplicationView,{viewId:s.uc.overview},i.a.createElement(RE,null)))},{path:s.tb,component:()=>i.a.createElement(_,null,i.a.createElement(r.TrackApplicationView,{viewId:s.uc.detectionAndResponse},i.a.createElement(Uv,null)))},{path:s.Nb,render:()=>i.a.createElement(_,null,i.a.createElement(r.TrackApplicationView,{viewId:s.uc.landing},i.a.createElement(hy,null)))},{path:s.zb,render:()=>i.a.createElement(_,null,i.a.createElement(r.TrackApplicationView,{viewId:s.uc.entityAnalytics},i.a.createElement(Wx,null)))}],Yx=z.i18n.translate("xpack.securitySolution.rules.badge.readOnly.tooltip",{defaultMessage:"Unable to create, edit or delete rules"});var Jx=a(913),Xx=a(540);const Zx=["v2_rare_process_by_host_linux_ecs","v2_linux_rare_metadata_user","v2_linux_rare_metadata_process","v2_linux_anomalous_user_name_ecs","v2_linux_anomalous_process_all_hosts_ecs","v2_linux_anomalous_network_port_activity_ecs","v2_rare_process_by_host_windows_ecs","v2_windows_anomalous_network_activity_ecs","v2_windows_anomalous_path_activity_ecs","v2_windows_anomalous_process_all_hosts_ecs","v2_windows_anomalous_process_creation","v2_windows_anomalous_user_name_ecs","v2_windows_rare_metadata_process","v2_windows_rare_metadata_user","rare_process_by_host_linux_ecs","linux_anomalous_network_activity_ecs","linux_anomalous_network_port_activity_ecs","linux_anomalous_network_service","linux_anomalous_network_url_activity_ecs","linux_anomalous_process_all_hosts_ecs","linux_anomalous_user_name_ecs","linux_rare_metadata_process","linux_rare_metadata_user","linux_rare_user_compiler","linux_rare_kernel_module_arguments","linux_rare_sudo_user","linux_system_user_discovery","linux_system_information_discovery","linux_system_process_discovery","linux_network_connection_discovery","linux_network_configuration_discovery","rare_process_by_host_windows_ecs","windows_anomalous_network_activity_ecs","windows_anomalous_path_activity_ecs","windows_anomalous_process_all_hosts_ecs","windows_anomalous_process_creation","windows_anomalous_script","windows_anomalous_service","windows_anomalous_user_name_ecs","windows_rare_user_runas_event","windows_rare_metadata_process","windows_rare_metadata_user","windows_rare_user_type10_remote_login"];var ek=a(544);const tk=()=>i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.mlJobCompatibilityCallout.messageBody",defaultMessage:"{summary} Related documentation: {docs}",values:{summary:i.a.createElement("p",null,i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.mlJobCompatibilityCallout.messageBody.summary",defaultMessage:"Machine learning rules use ML jobs that in turn have dependencies on data fields populated by the Beats and Elastic Agent integrations that were current when the ML job was created. New ML jobs, prefixed with V3, have been released to operate on now-current ECS fields. If you're using multiple versions of Beats or Elastic Agent, you may need to duplicate or create new machine learning rules that specify the new ML (V3) jobs and enable them to run alongside your existing rules, to ensure continued rule coverage using V1/V2 jobs."})),docs:i.a.createElement("ul",null,i.a.createElement("li",null,i.a.createElement(ek.b,null)))}}),ak={type:"primary",id:"ml-job-compatibility",title:z.i18n.translate("xpack.securitySolution.detectionEngine.mlJobCompatibilityCallout.messageTitle",{defaultMessage:"Your ML jobs may be incompatible with your data sources and/or ML rules"}),description:i.a.createElement(tk,null)},nk=()=>{const{loading:e,jobs:t}=Object(ml.a)(),a=t.some((e=>Zx.includes(e.id)));return i.a.createElement(Xx.c,{namespace:"detections",condition:!e&&a,message:ak})},ik=Object(n.memo)(nk);var rk=a(39),sk=a(569),ok=a(392),lk=a(570);const ck=["PUT",a(407).b];var uk=a(300);const dk=e=>{const{rules_installed:t,rules_updated:a,timelines_installed:n,timelines_updated:i}=e;return 0===t&&(n>0||i>0)?uk.g:(t>0||a>0)&&0===n?uk.e:uk.d},pk=()=>{const{addError:e}=Object(Oi.a)();return Object(sk.a)({onError:t=>{e(t,{title:uk.b})}})},mk=z.i18n.translate("xpack.securitySolution.detectionEngine.mlJobUpgradeModal.messageTitle",{defaultMessage:"ML rule updates may override your existing rules"}),gk=z.i18n.translate("xpack.securitySolution.detectionEngine.mlJobUpgradeModal.cancelTitle",{defaultMessage:"Cancel"}),bk=z.i18n.translate("xpack.securitySolution.detectionEngine.mlJobUpgradeModal.confirmTitle",{defaultMessage:"Load rules"}),fk=z.i18n.translate("xpack.securitySolution.detectionEngine.mlJobUpgradeModal.affectedJobsTitle",{defaultMessage:"Affected jobs:"}),yk=()=>i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.mlJobUpgradeModal.messageBody",defaultMessage:"{summary} Documentation: {docs}",values:{summary:i.a.createElement("p",null,i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.mlJobUpgradeModal.messageBody.summary",defaultMessage:"New V3 machine learning jobs have been released, and the latest corresponding prebuilt detection rules now use these new ML jobs. You're currently running one or more V1/V2 jobs, which only work with legacy prebuilt rules. To ensure continued coverage using V1/V2 jobs, you may need to duplicate or create new rules before updating your Elastic prebuilt detection rules. Check the documentation below for instructions on how to keep using the V1/V2 jobs, and how to start using the new V3 jobs."})),docs:i.a.createElement("ul",null,i.a.createElement("li",null,i.a.createElement(ek.b,null)))}}),hk=H.a.ul.withConfig({displayName:"JobsUL",componentId:"sc-yxot17-0"})(["max-height:200px;overflow-y:auto;&::-webkit-scrollbar{height:",";width:",";}&::-webkit-scrollbar-thumb{background-clip:content-box;background-color:",";border:"," solid transparent;}&::-webkit-scrollbar-corner,&::-webkit-scrollbar-track{background-color:transparent;}"],(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>Object(Ci.rgba)(e.eui.euiColorDarkShade,.5)),(({theme:e})=>e.eui.euiScrollBarCorner)),Ek=({jobs:e,onCancel:t,onConfirm:a})=>i.a.createElement(V.EuiConfirmModal,{title:mk,onCancel:t,onConfirm:a,cancelButtonText:gk,confirmButtonText:bk,buttonColor:"danger",defaultFocusedButton:"confirm"},i.a.createElement(yk,null),fk,i.a.createElement(hk,null,e.map((e=>i.a.createElement("li",{key:e.id},e.id))))),vk=Object(n.memo)(Ek),xk=({children:e})=>{const{isFetching:t}=pk(),{createPrePackagedRules:a,canCreatePrePackagedRules:r,isLoading:s}=(()=>{const[{isSignalIndexExists:e,isAuthenticated:t,hasEncryptionKey:a,canUserCRUD:i,hasIndexWrite:r}]=Object(le.b)(),{mutateAsync:s,isLoading:o}=(()=>{const{addError:e,addSuccess:t}=Object(Oi.a)();return(e=>{const t=Object(ok.b)(),a=Object(sk.b)(),n=Object(lk.b)();return Object(rk.useMutation)((()=>Object(Ai.c)()),{...e,mutationKey:ck,onSettled:(...i)=>{a(),t(),n(),null!=e&&e.onSettled&&e.onSettled(...i)}})})({onError:t=>{e(t,{title:uk.c})},onSuccess:e=>{t(dk(e))}})})(),l=i&&r&&t&&a&&e;return{isLoading:o,createPrePackagedRules:Object(n.useCallback)((async()=>{l&&await s()}),[l,s]),canCreatePrePackagedRules:l}})(),{startTransaction:o}=Object(So.a)(),l=Object(n.useCallback)((async()=>{o({name:ko.d.LOAD_PREBUILT}),await a()}),[a,o]),[c,u,d]=Object(Mo.a)(!1),{loading:p,jobs:m}=Object(ml.a)(),g=m.filter((e=>Zx.includes(e.id))),b=Object(n.useCallback)((async()=>{g.length>0?u():await l()}),[l,g.length,u]),f=Object(n.useCallback)((()=>{d(),l()}),[l,d]),y=!r||t||p;return i.a.createElement(i.a.Fragment,null,e({isLoading:s,isDisabled:y,onClick:b}),c&&i.a.createElement(vk,{jobs:g,onCancel:()=>d(),onConfirm:f}))};var kk=a(310);const Sk=()=>{const{data:e}=pk();return Object(kk.e)(null==e?void 0:e.rules_installed,null==e?void 0:e.rules_not_installed,null==e?void 0:e.rules_not_updated)},jk=()=>{const{data:e}=pk();return Object(kk.f)(null==e?void 0:e.timelines_installed,null==e?void 0:e.timelines_not_installed,null==e?void 0:e.timelines_not_updated)};var Ok=a(1074),wk=a.n(Ok);const Tk=z.i18n.translate("xpack.securitySolution.detectionEngine.rules.guidedOnboarding.installPrebuiltRules.title",{defaultMessage:"Load the Elastic prebuilt rules"}),Ik=z.i18n.translate("xpack.securitySolution.detectionEngine.rules.guidedOnboarding.installPrebuiltRules.content",{defaultMessage:"To get started you need to load the Elastic prebuilt rules."}),Ck=z.i18n.translate("xpack.securitySolution.detectionEngine.rules.guidedOnboarding.searchFirstRule.title",{defaultMessage:"Find your first rule"}),Mk=e=>z.i18n.translate("xpack.securitySolution.detectionEngine.rules.guidedOnboarding.searchFirstRule.content",{defaultMessage:'Search for "{name}" or click next.',values:{name:e}}),Fk=z.i18n.translate("xpack.securitySolution.detectionEngine.rules.guidedOnboarding.enableFirstRule.title",{defaultMessage:"Enable the rule"}),Dk=e=>z.i18n.translate("xpack.securitySolution.detectionEngine.rules.guidedOnboarding.enableFirstRule.content",{defaultMessage:'Enable "{name}" or click next.',values:{name:e}}),Ak=z.i18n.translate("xpack.securitySolution.detectionEngine.rules.guidedOnboarding.nextButton",{defaultMessage:"Next"}),_k=e=>{const[t,a]=Object(n.useState)(!1);return Object(n.useEffect)((()=>{const n=new MutationObserver((()=>{const n=!!document.getElementById(e);n&&!t&&a(!0),!n&&t&&a(!1)}));return n.observe(document.body,{childList:!0,subtree:!0}),()=>n.disconnect()}),[t,e]),t},Nk="install-prebuilt-rules-anchor",Rk="search-first-rule-anchor",Pk={filter:"",showCustomRules:!1,showElasticRules:!0,tags:["Guided Onboarding"]};let Lk;!function(e){e.inactive="inactive",e.installRules="installRules",e.searchRules="searchRules",e.enableRules="enableRules",e.completed="completed"}(Lk||(Lk={}));const Bk=()=>{var e;const{guidedOnboardingApi:t}=Object(p.k)().services.guidedOnboarding,{executeBulkAction:a}=Object(Oo.b)(),{actions:r}=Object(go.b)(),s=wk()(null!==(e=null==t?void 0:t.isGuideStepActive$("security","rules"))&&void 0!==e?e:Object(Rd.of)(!1),!1),{data:o}=Object(ok.a)({filterOptions:Pk},{enabled:s}),l=Object(n.useMemo)((()=>{if(null!=o&&o.rules.length)return o.rules[0]}),[o]),c=l?`rule-switch-${l.id}`:"",u=_k(Nk),d=_k(Rk),m=_k(c),g=Object(n.useMemo)((()=>s&&o?0===o.total?Lk.installRules:null!=l&&l.enabled?Lk.completed:m?Lk.enableRules:Lk.searchRules:Lk.inactive),[null==l?void 0:l.enabled,m,s,o]);Object(n.useEffect)((()=>{s&&g===Lk.completed&&(null==t||t.completeGuideStep("security","rules"))}),[t,s,g]);const b=Object(n.useCallback)((async()=>{l&&await a({type:xo.b.enable,ids:[l.id]})}),[l,a]),f=Object(n.useCallback)((()=>{l&&r.setFilterOptions({filter:l.name})}),[r,l]);return i.a.createElement(i.a.Fragment,null,u&&i.a.createElement(V.EuiTourStep,{title:Tk,content:Ik,onFinish:vE.noop,step:1,stepsTotal:3,isOpen:g===Lk.installRules,anchor:"#install-prebuilt-rules-anchor",anchorPosition:"downCenter",footerAction:i.a.createElement("div",null)}),d&&l&&i.a.createElement(V.EuiTourStep,{title:Ck,content:Mk(l.name),onFinish:vE.noop,step:2,stepsTotal:3,isOpen:g===Lk.searchRules,anchor:"#search-first-rule-anchor",anchorPosition:"upCenter",footerAction:i.a.createElement(V.EuiButton,{size:"s",color:"success",onClick:f},Ak)}),m&&l&&i.a.createElement(V.EuiTourStep,{title:Fk,content:Dk(l.name),onFinish:vE.noop,step:3,stepsTotal:3,isOpen:g===Lk.enableRules,anchor:`#${c}`,anchorPosition:"upCenter",footerAction:i.a.createElement(V.EuiButton,{size:"s",color:"success",onClick:b},Ak)}))},qk=z.i18n.translate("xpack.securitySolution.detectionEngine.rules.prePackagedRules.emptyPromptTitle",{defaultMessage:"Load Elastic prebuilt detection rules"}),zk=z.i18n.translate("xpack.securitySolution.detectionEngine.rules.prePackagedRules.emptyPromptMessage",{defaultMessage:"Elastic Security comes with prebuilt detection rules that run in the background and create alerts when their conditions are met. By default, all prebuilt rules except the Endpoint Security rule are disabled. You can select additional rules you want to enable."}),$k=z.i18n.translate("xpack.securitySolution.detectionEngine.rules.prePackagedRules.createOwnRuletButton",{defaultMessage:"Create your own rules"}),Vk=z.i18n.translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedRulesTitle",{defaultMessage:"Update available for Elastic prebuilt rules or timeline templates"}),Uk=(e,t)=>z.i18n.translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedRulesAndTimelinesMsg",{values:{updateRules:e,updateTimelines:t},defaultMessage:"You can update {updateRules} Elastic prebuilt {updateRules, plural, =1 {rule} other {rules}} and {updateTimelines} Elastic prebuilt {updateTimelines, plural, =1 {timeline} other {timelines}}. Note that this will reload deleted Elastic prebuilt rules."}),Hk=e=>z.i18n.translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedRulesButton",{values:{updateRules:e},defaultMessage:"Update {updateRules} Elastic prebuilt {updateRules, plural, =1 {rule} other {rules}}"}),Gk=e=>z.i18n.translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedTimelinesButton",{values:{updateTimelines:e},defaultMessage:"Update {updateTimelines} Elastic prebuilt {updateTimelines, plural, =1 {timeline} other {timelines}}"}),Qk=(e,t)=>z.i18n.translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedRulesAndTimelinesButton",{values:{updateRules:e,updateTimelines:t},defaultMessage:"Update {updateRules} Elastic prebuilt {updateRules, plural, =1 {rule} other {rules}} and {updateTimelines} Elastic prebuilt {updateTimelines, plural, =1 {timeline} other {timelines}}"}),Wk=z.i18n.translate("xpack.securitySolution.detectionEngine.rules.releaseNotesHelp",{defaultMessage:"Release notes"}),Kk=z.i18n.translate("xpack.securitySolution.detectionEngine.rules.loadPrePackagedRulesButton",{defaultMessage:"Load Elastic prebuilt rules"}),Yk=z.i18n.translate("xpack.securitySolution.detectionEngine.rules.loadPrePackagedTimelineTemplatesButton",{defaultMessage:"Load Elastic prebuilt timeline templates"}),Jk=z.i18n.translate("xpack.securitySolution.detectionEngine.rules.loadPrePackagedRulesAndTemplatesButton",{defaultMessage:"Load Elastic prebuilt rules and timeline templates"}),Xk=({fill:e,"data-test-subj":t="loadPrebuiltRulesBtn",isLoading:a,isDisabled:n,onClick:r})=>{const{data:s}=pk(),o=Sk(),l=jk();return"ruleNotInstalled"!==o&&"timelinesNotInstalled"!==l||"someRuleUninstall"===o?"someRuleUninstall"===o||"someTimelineUninstall"===l?i.a.createElement("div",null,i.a.createElement(V.EuiButton,{id:Nk,fill:e,iconType:"plusInCircle",isLoading:a,isDisabled:n,onClick:r,"data-test-subj":t},(m=null!==(d=null==s?void 0:s.rules_not_installed)&&void 0!==d?d:0,g=null!==(p=null==s?void 0:s.timelines_not_installed)&&void 0!==p?p:0,m>0&&0===g?(e=>z.i18n.translate("xpack.securitySolution.detectionEngine.rules.reloadMissingPrePackagedRulesButton",{values:{missingRules:e},defaultMessage:"Install {missingRules} Elastic prebuilt {missingRules, plural, =1 {rule} other {rules}} "}))(m):0===m&&g>0?(e=>z.i18n.translate("xpack.securitySolution.detectionEngine.rules.reloadMissingPrePackagedTimelinesButton",{values:{missingTimelines:e},defaultMessage:"Install {missingTimelines} Elastic prebuilt {missingTimelines, plural, =1 {timeline} other {timelines}} "}))(g):m>0&&g>0?((e,t)=>z.i18n.translate("xpack.securitySolution.detectionEngine.rules.reloadMissingPrePackagedRulesAndTimelinesButton",{values:{missingRules:e,missingTimelines:t},defaultMessage:"Install {missingRules} Elastic prebuilt {missingRules, plural, =1 {rule} other {rules}} and {missingTimelines} Elastic prebuilt {missingTimelines, plural, =1 {timeline} other {timelines}} "}))(m,g):void 0))):null:i.a.createElement("div",null,i.a.createElement(V.EuiButton,{id:Nk,fill:e,iconType:"indexOpen",isLoading:a,isDisabled:n,onClick:r,"data-test-subj":t},(u=l,"ruleNotInstalled"===(c=o)&&"timelinesNotInstalled"===u?Jk:"ruleNotInstalled"===c&&"timelinesNotInstalled"!==u?Kk:"ruleNotInstalled"!==c&&"timelinesNotInstalled"===u?Yk:void 0)));var c,u,d,p,m,g},Zk=()=>{var e,t;const{services:a}=Object(p.k)(),{data:r}=pk(),s=null!==(e=null==r?void 0:r.rules_not_updated)&&void 0!==e?e:0,o=null!==(t=null==r?void 0:r.timelines_not_updated)&&void 0!==t?t:0,l=Object(n.useMemo)((()=>{return s>0&&0===o?{callOutMessage:(t=s,z.i18n.translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedRulesMsg",{values:{updateRules:t},defaultMessage:"You can update {updateRules} Elastic prebuilt {updateRules, plural, =1 {rule} other {rules}}"})),buttonTitle:Hk(s)}:0===s&&o>0?{callOutMessage:(e=o,z.i18n.translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedTimelinesMsg",{values:{updateTimelines:e},defaultMessage:"You can update {updateTimelines} Elastic prebuilt {updateTimelines, plural, =1 {timeline} other {timelines}}"})),buttonTitle:Gk(o)}:s>0&&o>0?{callOutMessage:Uk(s,o),buttonTitle:Qk(s,o)}:void 0;var e,t}),[s,o]);return i.a.createElement(V.EuiCallOut,{title:Vk,"data-test-subj":"update-callout"},i.a.createElement("p",null,null==l?void 0:l.callOutMessage,i.a.createElement("br",null),i.a.createElement(V.EuiLink,{href:`${a.docLinks.links.siem.ruleChangeLog}`,target:"_blank"},Wk)),i.a.createElement(xk,null,(e=>i.a.createElement(V.EuiButton,lr()({size:"s","data-test-subj":"update-callout-button"},e),null==l?void 0:l.buttonTitle))))},eS=Object(n.memo)(Zk);var tS=a(207);const aS=z.i18n.translate("xpack.securitySolution.lists.importValueListTitle",{defaultMessage:"Import value lists"}),nS=z.i18n.translate("xpack.securitySolution.lists.importValueListDescription",{defaultMessage:"Import single value lists to use while writing rule exceptions."}),iS=z.i18n.translate("xpack.securitySolution.lists.uploadValueListPrompt",{defaultMessage:"Select or drag and drop a file"}),rS=z.i18n.translate("xpack.securitySolution.lists.closeValueListsModalTitle",{defaultMessage:"Close"}),sS=z.i18n.translate("xpack.securitySolution.lists.cancelValueListsImportTitle",{defaultMessage:"Cancel import"}),oS=z.i18n.translate("xpack.securitySolution.lists.valueListsImportButton",{defaultMessage:"Import list"}),lS=z.i18n.translate("xpack.securitySolution.lists.valueListsImportSuccessTitle",{defaultMessage:"Value list imported"}),cS=z.i18n.translate("xpack.securitySolution.lists.valueListsUploadError",{defaultMessage:"There was an error uploading the value list."}),uS=z.i18n.translate("xpack.securitySolution.lists.valueListsExportError",{defaultMessage:"There was an error exporting the value list."}),dS=z.i18n.translate("xpack.securitySolution.lists.valueListsTable.fileNameColumn",{defaultMessage:"Filename"}),pS=z.i18n.translate("xpack.securitySolution.lists.valueListsTable.typeColumn",{defaultMessage:"Type"}),mS=z.i18n.translate("xpack.securitySolution.lists.valueListsTable.importDateColumn",{defaultMessage:"Import Date"}),gS=z.i18n.translate("xpack.securitySolution.lists.valueListsTable.createdByColumn",{defaultMessage:"Created by"}),bS=z.i18n.translate("xpack.securitySolution.lists.valueListsTable.actionsColumn",{defaultMessage:"Actions"}),fS=z.i18n.translate("xpack.securitySolution.lists.valueListsTable.exportActionDescription",{defaultMessage:"Export value list"}),yS=z.i18n.translate("xpack.securitySolution.lists.valueListsTable.deleteActionDescription",{defaultMessage:"Remove value list"}),hS=z.i18n.translate("xpack.securitySolution.lists.valueListsTable.title",{defaultMessage:"Value lists"}),ES=z.i18n.translate("xpack.securitySolution.lists.valueListsForm.listTypesRadioLabel",{defaultMessage:"Type of value list"}),vS=z.i18n.translate("xpack.securitySolution.lists.valueListsForm.ipRadioLabel",{defaultMessage:"IP addresses"}),xS=z.i18n.translate("xpack.securitySolution.lists.valueListsForm.keywordsRadioLabel",{defaultMessage:"Keywords"}),kS=z.i18n.translate("xpack.securitySolution.lists.valueListsForm.ipRangesRadioLabel",{defaultMessage:"IP ranges"}),SS=z.i18n.translate("xpack.securitySolution.lists.valueListsForm.textRadioLabel",{defaultMessage:"Text"}),jS=z.i18n.translate("xpack.securitySolution.lists.referenceModalTitle",{defaultMessage:"Remove value list"}),OS=z.i18n.translate("xpack.securitySolution.lists.referenceModalCancelButton",{defaultMessage:"Cancel"}),wS=z.i18n.translate("xpack.securitySolution.lists.referenceModalDeleteButton",{defaultMessage:"Remove value list"}),TS=[{value:"keyword",text:xS},{value:"ip",text:vS},{value:"ip_range",text:kS},{value:"text",text:SS}],IS="keyword",CS=["text/csv","text/plain"],MS=({onError:e,onSuccess:t})=>{const a=Object(n.useRef)(new AbortController),[r,s]=Object(n.useState)(null),[o,l]=Object(n.useState)(IS),c=Object(n.useRef)(null),{http:u}=Object(p.k)().services,{start:d,...m}=Object(xi.j)(),g=!r||CS.some((e=>r.type===e)),b=Object(n.useCallback)((e=>l(e.target.value)),[l]),f=Object(n.useCallback)((e=>{var t;s(null!==(t=null==e?void 0:e.item(0))&&void 0!==t?t:null)}),[]),y=Object(n.useCallback)((()=>{var e;null!==(e=c.current)&&void 0!==e&&e.fileInput&&(c.current.fileInput.value="",c.current.handleChange()),s(null),l(IS)}),[]),h=Object(n.useCallback)((()=>{a.current.abort()}),[]),E=Object(n.useCallback)((e=>{y(),t(e)}),[y,t]),v=Object(n.useCallback)((t=>{e(t)}),[e]),x=Object(n.useCallback)((()=>{!m.loading&&r&&(a.current=new AbortController,d({file:r,listId:void 0,http:u,signal:a.current.signal,type:o}))}),[m.loading,r,d,u,o]);return Object(n.useEffect)((()=>{!m.loading&&m.result?E(m.result):!m.loading&&m.error&&v(m.error)}),[v,E,m.error,m.loading,m.result]),Object(n.useEffect)((()=>h),[h]),i.a.createElement(V.EuiForm,null,i.a.createElement(V.EuiFormRow,{"data-test-subj":"value-list-file-picker-row",label:nS,fullWidth:!0,isInvalid:!g,error:[(k=CS.join(", "),z.i18n.translate("xpack.securitySolution.lists.uploadValueListExtensionValidationMessage",{values:{fileTypes:k},defaultMessage:"File must be one of the following types: [{fileTypes}]"}))]},i.a.createElement(V.EuiFilePicker,{accept:CS.join(),"data-test-subj":"value-list-file-picker",id:"value-list-file-picker",initialPromptText:iS,ref:c,onChange:f,fullWidth:!0,isLoading:m.loading,isInvalid:!g})),i.a.createElement(V.EuiFormRow,{fullWidth:!0},i.a.createElement(V.EuiFlexGroup,null,i.a.createElement(V.EuiFlexItem,null,i.a.createElement(V.EuiFormRow,{label:ES},i.a.createElement(V.EuiSelect,{"data-test-subj":"value-lists-form-select-type-action",options:TS,value:o,onChange:b,name:"valueListType"}))),i.a.createElement(V.EuiFlexItem,null,i.a.createElement(V.EuiFormRow,{hasEmptyLabelSpace:!0},i.a.createElement(V.EuiFlexGroup,{alignItems:"flexEnd"},i.a.createElement(V.EuiFlexItem,null,m.loading&&i.a.createElement(V.EuiButtonEmpty,{onClick:h},sS)),i.a.createElement(V.EuiFlexItem,null,i.a.createElement(V.EuiButton,{"data-test-subj":"value-lists-form-import-action",onClick:x,disabled:null==r||!g||m.loading},oS))))))));var k};MS.displayName="ValueListsFormComponent";const FS=i.a.memo(MS);FS.displayName="ValueListsForm";const DS=H()(V.EuiLoadingSpinner).withConfig({displayName:"AlignedSpinner",componentId:"sc-ul6fx2-0"})(["margin:",";vertical-align:middle;"],(({theme:e})=>e.eui.euiSizeXS)),AS={contentText:"",exceptionListReferences:[],isLoading:!1,valueListId:""},_S=({onClose:e,showFlyout:t})=>{var a,r,s,o;const[l,c]=Object(n.useState)(0),[u,d]=Object(n.useState)(5),[m,g]=Object(xi.e)({pageIndex:l,pageSize:u}),{http:b}=Object(p.k)().services,{start:f,...y}=Object(xi.h)(),{start:h,result:E,error:x}=Object(xi.f)(),[k,S]=Object(n.useState)([]),[j,O]=Object(n.useState)([]),[w,T]=Object(n.useState)({}),{addError:I,addSuccess:C}=Object(Oi.a)(),[M,F]=Object(n.useState)(!1),[D,A]=Object(n.useState)(AS),_=Object(n.useCallback)((()=>{f({cursor:m,http:b,pageIndex:l+1,pageSize:u,sortOrder:"desc",sortField:"created_at"})}),[m,b,f,l,u]),N=Object(n.useCallback)((({deleteReferences:e,id:t})=>{S([...k,t]),h({deleteReferences:e,http:b,id:t})}),[h,k,b]),R=Object(n.useCallback)((async()=>{F(!1),h({deleteReferences:!0,http:b,id:D.valueListId}),A(AS),S([])}),[h,b,D.valueListId]);Object(n.useEffect)((()=>{null!=E&&(S((e=>[...e.filter((e=>e!==E.id))])),_())}),[E,_]),Object(n.useEffect)((()=>{if(!Object(v.isEmpty)(x)){var e,t,a,n,i,r,s,o;const c=null!==(e=null==x||null===(t=x.body)||void 0===t||null===(a=t.message)||void 0===a||null===(n=a.error)||void 0===n||null===(i=n.references)||void 0===i?void 0:i.map((e=>null==e?void 0:e.exception_list.name)))&&void 0!==e?e:[],u=Array.from(new Set(c));F(!0),A({contentText:(l=u.length,z.i18n.translate("xpack.securitySolution.lists.referenceModalDescription",{defaultMessage:"This value list is associated with ({referenceCount}) exception {referenceCount, plural, =1 {list} other {lists}}. Removing this list will remove all exception items that reference this value list.",values:{referenceCount:l}})),exceptionListReferences:u,isLoading:!1,valueListId:null==x||null===(r=x.body)||void 0===r||null===(s=r.message)||void 0===s||null===(o=s.error)||void 0===o?void 0:o.value_list_id})}var l}),[x]);const P=Object(n.useCallback)((async({id:e})=>{try{O((t=>[...t,e]));const t=await Object(tS.h)({http:b,listId:e,signal:(new AbortController).signal});T({name:e,blob:t})}catch(e){I(e,{title:uS})}finally{O((t=>[...t.filter((t=>t!==e))]))}}),[I,b]),L=Object(n.useCallback)((({page:{index:e,size:t}})=>{c(e),d(t)}),[c,d]),B=Object(n.useCallback)((e=>{"AbortError"!==e.name&&I(e,{title:cS})}),[I]),q=Object(n.useCallback)((e=>{var t;C({text:(t=e.name,z.i18n.translate("xpack.securitySolution.lists.valueListsImportSuccess",{defaultMessage:"Value list '{fileName}' was imported",values:{fileName:t}})),title:lS}),_(),c(0)}),[C]);Object(n.useEffect)((()=>{t&&_()}),[t,_]),Object(n.useEffect)((()=>{var e;!y.loading&&null!==(e=y.result)&&void 0!==e&&e.cursor&&g(y.result.cursor)}),[y.loading,y.result,g]);const $=Object(n.useCallback)((()=>{S([]),F(!1),A({contentText:"",exceptionListReferences:[],isLoading:!1,valueListId:""})}),[]);if(!t)return null;const U=(null!==(a=null===(r=y.result)||void 0===r?void 0:r.data)&&void 0!==a?a:[]).map((e=>({...e,isDeleting:k.includes(e.id),isExporting:j.includes(e.id)}))),H={pageIndex:l,pageSize:u,totalItemCount:null!==(s=null===(o=y.result)||void 0===o?void 0:o.total)&&void 0!==s?s:0,showPerPageOptions:!1},G=(Q=P,W=N,[{field:"name",name:dS,truncateText:!1},{field:"type",name:pS,width:"15%",truncateText:!0,render:e=>{const t=TS.find((({value:t})=>t===e));return i.a.createElement(i.a.Fragment,null,t?t.text:e)}},{field:"created_at",name:mS,render:e=>i.a.createElement(xa.a,{value:e,fieldName:"created_at"}),width:"30%"},{field:"created_by",name:gS,truncateText:!0,width:"20%"},{name:bS,actions:[{render:e=>i.a.createElement(V.EuiToolTip,{content:fS},e.isExporting?i.a.createElement(DS,{size:"m"}):i.a.createElement(V.EuiButtonIcon,{"aria-label":fS,"data-test-subj":"action-export-value-list",iconType:"exportAction",onClick:()=>Q(e)}))},{render:e=>i.a.createElement(V.EuiToolTip,{content:yS},e.isDeleting?i.a.createElement(DS,{size:"m"}):i.a.createElement(V.EuiButtonIcon,{"aria-label":yS,"data-test-subj":`action-delete-value-list-${e.name}`,iconType:"trash",onClick:()=>W(e)}))}],width:"15%"}]);var Q,W;return i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiFlyout,{onClose:e,maxWidth:800},i.a.createElement(V.EuiFlyoutHeader,null,i.a.createElement(V.EuiTitle,null,i.a.createElement("h2",null,aS))),i.a.createElement(V.EuiFlyoutBody,null,i.a.createElement(FS,{onSuccess:q,onError:B}),i.a.createElement(V.EuiSpacer,null),i.a.createElement(V.EuiText,{size:"s"},i.a.createElement("h2",null,hS)),i.a.createElement(V.EuiBasicTable,{"data-test-subj":"value-lists-table",columns:G,items:U,loading:y.loading,onChange:L,pagination:H})),i.a.createElement(V.EuiFlyoutFooter,null,i.a.createElement(V.EuiButton,{"data-test-subj":"value-lists-flyout-close-action",onClick:e},rS))),i.a.createElement(Di,{cancelText:OS,confirmText:wS,contentText:D.contentText,onCancel:$,onClose:$,onConfirm:R,references:D.exceptionListReferences,showModal:M,titleText:jS}),i.a.createElement(Si,{blob:w.blob,name:w.name,onDownload:()=>T({})}))};_S.displayName="ValueListsFlyoutComponent";const NS=i.a.memo(_S);NS.displayName="ValueListsFlyout";var RS=a(457),PS=a(338);const LS=["PUT",s.pb],BS=["POST",s.pb];var qS=a(80),zS=a(502),$S=a(244);qS.exact(qS.type({group:qS.string,id:qS.string,action_type_id:qS.string,params:qS.record(qS.string,qS.any)}));const VS=qS.intersection([qS.type({from:qS.string}),qS.partial({throttle:qS.string,kibana_siem_app_url:qS.string})]),US=qS.intersection([qS.type({author:$S.o,created_at:qS.string,created_by:qS.string,description:$S.p,enabled:$S.j,false_positives:$S.q,from:zS.k,id:$S.v,interval:zS.j,immutable:$S.k,name:$S.t,max_signals:$S.l,references:$S.x,related_integrations:$S.m,required_fields:$S.n,risk_score:zS.c,risk_score_mapping:zS.d,rule_id:$S.y,severity:zS.m,severity_mapping:zS.n,setup:$S.E,tags:$S.z,type:zS.A,to:zS.l,threat:$S.F,updated_at:qS.string,updated_by:qS.string,actions:zS.e,throttle:qS.union([zS.i,qS.null])}),qS.partial({outcome:$S.D,alias_target_id:$S.C,alias_purpose:$S.B,building_block_type:$S.d,anomaly_threshold:qS.number,filters:$S.r,index:$S.h,data_view_id:$S.e,language:qS.string,license:$S.s,meta:VS,machine_learning_job_id:qS.array(qS.string),new_terms_fields:qS.array(qS.string),history_window_start:qS.string,output_index:$S.b,query:$S.w,rule_name_override:$S.u,saved_id:qS.string,threshold:$S.G,threat_query:zS.z,threat_filters:zS.u,threat_index:zS.v,threat_indicator_path:zS.w,threat_mapping:zS.y,threat_language:zS.x,timeline_id:$S.I,timeline_title:$S.J,timestamp_override:$S.L,timestamp_override_fallback_disabled:$S.M,event_category_override:$S.f,timestamp_field:$S.K,tiebreaker_field:$S.H,note:$S.i,exceptions_list:$S.g,uuid:qS.string,version:$S.A,execution_summary:To.g,alert_suppression:$S.a})]);qS.array(US);var HS=a(813);const GS=H()(V.EuiEmptyPrompt).withConfig({displayName:"EmptyPrompt",componentId:"sc-1rs1rob-0"})(["align-self:center;"]);GS.displayName="EmptyPrompt";const QS=()=>{const[{canUserCRUD:e}]=Object(le.b)(),t=Object(Js.c)(e);return i.a.createElement(GS,{"data-test-subj":"rulesEmptyPrompt",title:i.a.createElement("h2",null,qk),body:i.a.createElement("p",null,zk),actions:i.a.createElement(V.EuiFlexGroup,{justifyContent:"center"},i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(xk,null,(e=>i.a.createElement(Xk,lr()({fill:!0,"data-test-subj":"load-prebuilt-rules"},e))))),i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(be.l,{isDisabled:!t,iconType:"plusInCircle",deepLinkId:k.a.rulesCreate},$k)))})},WS=Object(n.memo)(QS),KS=({errorCode:e,message:t,rulesCount:a})=>{switch(e){case s.F.IMMUTABLE:return i.a.createElement("li",{key:t},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.elasticRulesEditDescription",defaultMessage:"{rulesCount, plural, =1 {# prebuilt Elastic rule} other {# prebuilt Elastic rules}} (editing prebuilt rules is not supported)",values:{rulesCount:a}}));case s.F.MACHINE_LEARNING_INDEX_PATTERN:return i.a.createElement("li",{key:t},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.machineLearningRulesIndexEditDescription",defaultMessage:"{rulesCount, plural, =1 {# custom machine learning rule} other {# custom machine learning rules}} (these rules don't have index patterns)",values:{rulesCount:a}}));case s.F.MACHINE_LEARNING_AUTH:return i.a.createElement("li",{key:t},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.machineLearningRulesAuthDescription",defaultMessage:"{rulesCount, plural, =1 {# machine learning rule} other {# machine learning rules}} can't be edited ({message})",values:{rulesCount:a,message:t}}));default:return i.a.createElement("li",{key:t},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.defaultRulesEditFailureDescription",defaultMessage:"{rulesCount, plural, =1 {# rule} other {# rules}} can't be edited ({message})",values:{rulesCount:a,message:t}}))}},YS=({errorCode:e,message:t,rulesCount:a})=>e===s.F.IMMUTABLE?i.a.createElement("li",{key:t},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.elasticRulesExportDescription",defaultMessage:"{rulesCount, plural, =1 {# prebuilt Elastic rule} other {# prebuilt Elastic rules}} (exporting prebuilt rules is not supported)",values:{rulesCount:a}})):i.a.createElement("li",{key:t},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.defaultRulesExportFailureDescription",defaultMessage:"{rulesCount, plural, =1 {# rule} other {# rules}} can't be exported ({message})",values:{rulesCount:a,message:t}})),JS=({ruleErrors:e=[],bulkAction:t})=>0===e.length?null:i.a.createElement(i.a.Fragment,null,i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.actionRejectionDescription",defaultMessage:"This action can't be applied to the following rules in your selection:"}),i.a.createElement(V.EuiSpacer,null),i.a.createElement("ul",null,e.map((({message:e,errorCode:a,ruleIds:n})=>{const r=n.length;switch(t){case xo.b.edit:return i.a.createElement(KS,{message:e,errorCode:a,rulesCount:r});case xo.b.export:return i.a.createElement(YS,{message:e,errorCode:a,rulesCount:r});default:return null}})))),XS=i.a.memo(JS);XS.displayName="BulkActionRuleErrorsList";var ZS=a(174);const ej=(e,t)=>{switch(e){case xo.b.edit:return uo.A(t);case xo.b.export:return uo.Y(t);default:Object(ZS.a)(e)}},tj=(e,t)=>{switch(e){case xo.b.edit:return uo.z(t);case xo.b.export:return uo.X(t);default:Object(ZS.a)(e)}},aj=({onCancel:e,onConfirm:t,result:a,bulkAction:n})=>{const{failedRulesCount:r=0,succeededRulesCount:s=0,ruleErrors:o=[]}=null!=a?a:{};return 0===s?i.a.createElement(V.EuiConfirmModal,{title:ej(n,r),onCancel:e,onConfirm:e,confirmButtonText:uo.l,defaultFocusedButton:"confirm","data-test-subj":"bulkActionRejectModal"},i.a.createElement(XS,{bulkAction:n,ruleErrors:o})):i.a.createElement(V.EuiConfirmModal,{title:uo.m(s),onCancel:e,onConfirm:t,confirmButtonText:tj(n,s),cancelButtonText:uo.y,defaultFocusedButton:"confirm","data-test-subj":"bulkActionConfirmationModal"},i.a.createElement(XS,{bulkAction:n,ruleErrors:o}))},nj=i.a.memo(aj);nj.displayName="BulkActionDryRunConfirmation";var ij=a(100);const rj=({form:e,title:t,banner:a,children:n,onClose:r,onSubmit:s,flyoutSize:o="s"})=>{const l=Object(V.useGeneratedHtmlId)({prefix:"RulesBulkEditForm"}),{isValid:c}=e;return i.a.createElement(V.EuiFlyout,{ownFocus:!0,onClose:r,"aria-labelledby":l,size:o},i.a.createElement(V.EuiFlyoutHeader,{hasBorder:!0},i.a.createElement(V.EuiTitle,{size:"m","data-test-subj":"rulesBulkEditFormTitle"},i.a.createElement("h2",{id:l},t))),i.a.createElement(V.EuiFlyoutBody,{banner:a},i.a.createElement(ij.c,{form:e},n)),i.a.createElement(V.EuiFlyoutFooter,null,i.a.createElement(V.EuiFlexGroup,{justifyContent:"spaceBetween"},i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiButtonEmpty,{onClick:r,flush:"left","data-test-subj":"rulesBulkEditFormCancelBtn"},uo.K)),i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiButton,{onClick:s,fill:!0,disabled:!1===c,"data-test-subj":"rulesBulkEditFormSaveBtn"},uo.S)))))},sj=i.a.memo(rj);sj.displayName="BulkEditFormWrapper";const oj=Object(ij.j)({component:ij.b}),lj={index:{fieldsToValidateOnChange:["index"],type:ij.a.COMBO_BOX,validations:[{validator:ij.h.emptyField(uo.E)}]},overwrite:{type:ij.a.CHECKBOX,label:uo.D},overwriteDataViews:{type:ij.a.CHECKBOX,label:uo.L}},cj={index:[],overwrite:!1,overwriteDataViews:!1},uj=({editAction:e,rulesCount:t,onClose:a,onConfirm:n})=>{const{form:r}=Object(ij.k)({defaultValue:cj,schema:lj}),{indexHelpText:o,indexLabel:l,formTitle:c}=(e=>e===xo.a.add_index_patterns?{indexLabel:uo.C,indexHelpText:uo.B,formTitle:uo.F}:{indexLabel:uo.N,indexHelpText:uo.M,formTitle:uo.O})(e),[{overwrite:u,overwriteDataViews:d}]=Object(ij.m)({form:r,watch:["overwrite","overwriteDataViews"]}),{uiSettings:m}=Object(p.k)().services,g=m.get(s.S);return i.a.createElement(sj,{form:r,onClose:a,onSubmit:async()=>{const{data:t,isValid:a}=await r.submit();if(!a)return;const i={value:t.index,type:t.overwrite?xo.a.set_index_patterns:e,overwrite_data_views:t.overwriteDataViews};n(i)},title:c},i.a.createElement(oj,{path:"index",config:{...lj.index,label:l,helpText:o},componentProps:{idAria:"bulkEditRulesIndexPatterns","data-test-subj":"bulkEditRulesIndexPatterns",euiFieldProps:{fullWidth:!0,placeholder:"",noSuggestions:!1,options:g.map((e=>({label:e})))}}}),e===xo.a.add_index_patterns&&i.a.createElement(oj,{path:"overwrite",componentProps:{idAria:"bulkEditRulesOverwriteIndexPatterns","data-test-subj":"bulkEditRulesOverwriteIndexPatterns"}}),u&&i.a.createElement(V.EuiFormRow,{fullWidth:!0},i.a.createElement(V.EuiCallOut,{color:"warning",size:"s","data-test-subj":"bulkEditRulesIndexPatternsWarning"},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.setIndexPatternsWarningCallout",defaultMessage:"You’re about to overwrite index patterns for {rulesCount, plural, one {# selected rule} other {# selected rules}}, press Save to apply changes.",values:{rulesCount:t}}))),e===xo.a.add_index_patterns&&i.a.createElement(oj,{path:"overwriteDataViews",componentProps:{idAria:"bulkEditRulesOverwriteRulesWithDataViews","data-test-subj":"bulkEditRulesOverwriteRulesWithDataViews"}}),d&&i.a.createElement(V.EuiFormRow,{fullWidth:!0},i.a.createElement(V.EuiCallOut,{color:"warning",size:"s","data-test-subj":"bulkEditRulesDataViewsWarning"},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.setDataViewsOverwriteWarningCallout",defaultMessage:"If you have selected rules which depend on a data view this action will force those rules to read from the index pattern as defined after this update, not the dataview, and may result in broken rules."}))),e===xo.a.delete_index_patterns&&i.a.createElement(V.EuiFormRow,{fullWidth:!0},i.a.createElement(V.EuiCallOut,{color:"warning",size:"s","data-test-subj":"bulkEditRulesDataViewsWarning"},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteIndexPattnersDataViewsOverwriteWarningCallout",defaultMessage:"If you have selected rules which depend on a data view this action will not have any effect on those rules."}))))},dj=i.a.memo(uj);dj.displayName="IndexPatternsForm";const pj=()=>{const{addError:e}=Object(Oi.a)();return Object(lk.a)({onError:t=>{e(t,{title:uk.f})}})},mj=Object(ij.j)({component:ij.b}),gj={tags:{fieldsToValidateOnChange:["tags"],type:ij.a.COMBO_BOX,validations:[{validator:ij.h.emptyField(uo.T)}]},overwrite:{type:ij.a.CHECKBOX,label:uo.I}},bj={tags:[],overwrite:!1},fj=({editAction:e,rulesCount:t,onClose:a,onConfirm:r})=>{const{data:s=[]}=pj(),{form:o}=Object(ij.k)({defaultValue:bj,schema:gj}),[{overwrite:l}]=Object(ij.m)({form:o,watch:["overwrite"]}),c=Object(n.useMemo)((()=>Object(_i.a)(s)),[s]),{tagsLabel:u,tagsHelpText:d,formTitle:p}=(e=>e===xo.a.add_tags?{tagsLabel:uo.H,tagsHelpText:uo.G,formTitle:uo.J}:{tagsLabel:uo.Q,tagsHelpText:uo.P,formTitle:uo.R})(e);return i.a.createElement(sj,{form:o,onClose:a,onSubmit:async()=>{const{data:t,isValid:a}=await o.submit();if(!a)return;const n={value:t.tags,type:t.overwrite?xo.a.set_tags:e};r(n)},title:p},i.a.createElement(mj,{path:"tags",config:{...gj.tags,label:u,helpText:d},componentProps:{idAria:"bulkEditRulesTags","data-test-subj":"bulkEditRulesTags",euiFieldProps:{fullWidth:!0,placeholder:"",noSuggestions:!1,options:c.map((e=>({label:e})))}}}),e===xo.a.add_tags?i.a.createElement(mj,{path:"overwrite",componentProps:{idAria:"bulkEditRulesOverwriteTags","data-test-subj":"bulkEditRulesOverwriteTags"}}):null,l&&i.a.createElement(V.EuiFormRow,null,i.a.createElement(V.EuiCallOut,{color:"warning",size:"s","data-test-subj":"bulkEditRulesTagsWarning"},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.setTagsWarningCallout",defaultMessage:"You’re about to overwrite tags for {rulesCount, plural, one {# selected rule} other {# selected rules}}, press Save to apply changes.",values:{rulesCount:t}}))))},yj=i.a.memo(fj);yj.displayName="TagsForm";var hj=a(919),Ej=a(684);const vj={timeline:{label:Ej.b.TEMPLATE_SELECTOR_LABEL,helpText:Ej.b.TEMPLATE_SELECTOR_HELP_TEXT}},xj={timeline:{id:null,title:Ej.b.TEMPLATE_SELECTOR_DEFAULT_VALUE}},kj=e=>{const{rulesCount:t,onClose:a,onConfirm:r}=e,{form:s}=Object(ij.k)({schema:vj,defaultValue:xj}),o=Object(n.useCallback)((async()=>{const{data:e,isValid:t}=await s.submit();if(!t)return;const a=e.timeline.id||"",n=a?e.timeline.title:"";r({type:xo.a.set_timeline,value:{timeline_id:a,timeline_title:n}})}),[s,r]),l=i.a.createElement(V.EuiCallOut,{color:"warning","data-test-subj":"bulkEditRulesTimelineTemplateWarning"},Ej.b.warningCalloutMessage(t));return i.a.createElement(sj,{form:s,title:Ej.b.FORM_TITLE,banner:l,onClose:a,onSubmit:o},i.a.createElement(ij.e,{path:"timeline",component:hj.a,componentProps:{idAria:"bulkEditRulesTimelineTemplateSelector",dataTestSubj:"bulkEditRulesTimelineTemplateSelector",placeholder:Ej.b.TEMPLATE_SELECTOR_PLACEHOLDER}}))},Sj=i.a.memo(kj);Sj.displayName="TimelineTemplateForm";var jj=a(566),Oj=a(878),wj=a(912);const Tj=Object(ij.j)({component:ij.b}),Ij={throttle:s.Xb,actions:[],overwrite:!1},Cj=({rulesCount:e,onClose:t,onConfirm:a})=>{const{services:{triggersActionsUi:{actionTypeRegistry:r}}}=Object(p.k)(),s=Object(n.useMemo)((()=>(e=>({throttle:{label:Ej.a.THROTTLE_LABEL,helpText:Ej.a.THROTTLE_HELP_TEXT},actions:{validations:[{validator:Object(wj.a)(e)}]},overwrite:{type:ij.a.CHECKBOX,label:Ej.a.OVERWRITE_LABEL}}))(r)),[r]),{form:o}=Object(ij.k)({schema:s,defaultValue:Ij}),[{overwrite:l}]=Object(ij.m)({form:o,watch:["overwrite","throttle"]}),c=Object(n.useCallback)((async()=>{const{data:e,isValid:t}=await o.submit();if(!t)return;const{actions:n=[],throttle:i,overwrite:r}=e,s=r?xo.a.set_rule_actions:xo.a.add_rule_actions;a({type:s,value:{actions:n.map((({actionTypeId:e,...t})=>t)),throttle:i}})}),[o,a]),u=Object(n.useMemo)((()=>({idAria:"bulkEditRulesRuleActionThrottle","data-test-subj":"bulkEditRulesRuleActionThrottle",hasNoInitialSelection:!1,euiFieldProps:{options:jj.b}})),[]),d=Object(n.useMemo)((()=>Object(kk.d)()),[]);return i.a.createElement(sj,{form:o,title:Ej.a.FORM_TITLE,onClose:t,onSubmit:c,flyoutSize:"l"},i.a.createElement(V.EuiCallOut,{color:"primary","data-test-subj":"bulkEditRulesRuleActionInfo",title:i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.addRuleActions.infoCalloutTitle",defaultMessage:"Configure actions for {rulesCount, plural, one {# rule} other {# rules}} you’ve selected",values:{rulesCount:e}})},i.a.createElement("ul",null,i.a.createElement("li",null,i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.addRuleActions.actionFrequencyDetail",defaultMessage:"The actions frequency you select below is applied to all actions (both new and existing) for all selected rules."})),i.a.createElement("li",null,Ej.a.RULE_VARIABLES_DETAIL))),i.a.createElement(V.EuiSpacer,{size:"m"}),i.a.createElement(ij.e,{path:"throttle",component:jj.d,componentProps:u}),i.a.createElement(V.EuiSpacer,{size:"m"}),i.a.createElement(ij.e,{path:"actions",component:Oj.a,componentProps:{messageVariables:d}}),i.a.createElement(V.EuiSpacer,{size:"m"}),i.a.createElement(Tj,{path:"overwrite",componentProps:{idAria:"bulkEditRulesOverwriteRuleActions","data-test-subj":"bulkEditRulesOverwriteRuleActions"}}),l&&i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiSpacer,{size:"m"}),i.a.createElement(V.EuiCallOut,{color:"warning","data-test-subj":"bulkEditRulesRuleActionsWarning"},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.addRuleActions.warningCalloutMessage",defaultMessage:"You're about to overwrite rule actions for {rulesCount, plural, one {# selected rule} other {# selected rules}}. Click {saveButton} to apply changes.",values:{rulesCount:e,saveButton:i.a.createElement("strong",null,i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.addRuleActions.warningCalloutMessage.buttonLabel",defaultMessage:"Save"}))}}))))},Mj=i.a.memo(Cj);Mj.displayName="RuleActionsForm";var Fj=a(592);const Dj={interval:{label:Ej.d.INTERVAL_LABEL,helpText:Ej.d.INTERVAL_HELP_TEXT},lookback:{label:Ej.d.LOOKBACK_LABEL,helpText:Ej.d.LOOKBACK_HELP_TEXT}},Aj={interval:"5m",lookback:"1m"},_j=({rulesCount:e,onClose:t,onConfirm:a})=>{const{form:r}=Object(ij.k)({schema:Dj,defaultValue:Aj}),s=Object(n.useCallback)((async()=>{const{data:e,isValid:t}=await r.submit();t&&a({type:xo.a.set_schedule,value:{interval:e.interval,lookback:e.lookback}})}),[r,a]),o=i.a.createElement(V.EuiCallOut,{color:"warning","data-test-subj":"bulkEditRulesSchedulesWarning"},Ej.d.warningCalloutMessage(e));return i.a.createElement(sj,{form:r,title:Ej.d.FORM_TITLE,banner:o,onClose:t,onSubmit:s},i.a.createElement(ij.e,{path:"interval",component:Fj.a,componentProps:{idAria:"bulkEditRulesScheduleIntervalSelector",dataTestSubj:"bulkEditRulesScheduleIntervalSelector",fullWidth:!0,minimumValue:1}}),i.a.createElement(ij.e,{path:"lookback",component:Fj.a,componentProps:{idAria:"bulkEditRulesScheduleLookbackSelector",dataTestSubj:"bulkEditRulesScheduleLookbackSelector",fullWidth:!0,minimumValue:1}}))},Nj=({editAction:e,...t})=>{switch(e){case xo.a.add_index_patterns:case xo.a.delete_index_patterns:case xo.a.set_index_patterns:return i.a.createElement(dj,lr()({},t,{editAction:e}));case xo.a.add_tags:case xo.a.delete_tags:case xo.a.set_tags:return i.a.createElement(yj,lr()({},t,{editAction:e}));case xo.a.set_timeline:return i.a.createElement(Sj,t);case xo.a.add_rule_actions:case xo.a.set_rule_actions:return i.a.createElement(Mj,t);case xo.a.set_schedule:return i.a.createElement(_j,t);default:return null}},Rj=i.a.memo(Nj);Rj.displayName="BulkEditFlyout";var Pj=a(814);function Lj(e){switch(e){case xo.a.add_index_patterns:case xo.a.delete_index_patterns:case xo.a.set_index_patterns:case xo.a.add_tags:case xo.a.delete_tags:case xo.a.set_tags:return[{type:e,value:[]}];case xo.a.set_timeline:return[{type:e,value:{timeline_id:"",timeline_title:""}}];case xo.a.add_rule_actions:case xo.a.set_rule_actions:return[{type:e,value:{throttle:"1h",actions:[]}}];case xo.a.set_schedule:return[{type:e,value:{interval:"5m",lookback:"1m"}}];default:Object(ZS.a)(e)}return[{type:e,value:[]}]}const Bj=({dryRunResult:e,...t})=>{if("selectedRuleIds"in t){const a=new Set(null==e?void 0:e.ruleErrors.flatMap((({ruleIds:e})=>e)));return{ids:t.selectedRuleIds.filter((e=>!a.has(e)))}}let a={...t.filterOptions};return null==e||e.ruleErrors.forEach((({errorCode:e})=>{var t;switch(e){case s.F.IMMUTABLE:a={...a,showCustomRules:!0};break;case s.F.MACHINE_LEARNING_INDEX_PATTERN:case s.F.MACHINE_LEARNING_AUTH:a={...a,excludeRuleTypes:[...null!==(t=a.excludeRuleTypes)&&void 0!==t?t:[],"machine_learning"]}}})),{query:Object(Pj.a)(a)}},qj=({onInit:e,onFinish:t})=>{const a=Object(n.useRef)(),i=Object(n.useCallback)((()=>{var e;null===(e=a.current)||void 0===e||e.call(a,!0)}),[]),r=Object(n.useCallback)((()=>{var e;null===(e=a.current)||void 0===e||e.call(a,!1)}),[]);return[Object(n.useCallback)((()=>(e(),new Promise((e=>{a.current=e})).finally((()=>{t()})))),[e,t]),i,r]};var zj=a(1110);const $j=H.a.div.withConfig({displayName:"PopoverContentWrapper",componentId:"sc-k6xbb4-0"})(["width:275px;"]),Vj=H.a.div.withConfig({displayName:"ScrollableDiv",componentId:"sc-k6xbb4-1"})(["max-height:250px;overflow-y:auto;"]),Uj=H.a.span.withConfig({displayName:"TagOverflowContainer",componentId:"sc-k6xbb4-2"})(["overflow:hidden;text-overflow:ellipsis;white-space:nowrap;"]),Hj=({tags:e,selectedTags:t,onSelectedTagsChanged:a})=>{const r=Object(n.useMemo)((()=>Object(_i.a)(Array.from(new Set([...e,...t])))),[t,e]),[s,o]=Object(n.useState)(!1),[l,c]=Object(n.useState)(""),[u,d]=Object(n.useState)(r),p=Object(n.useMemo)((()=>u.map(((e,n)=>i.a.createElement(V.EuiFilterSelectItem,{checked:t.includes(e)?"on":void 0,key:`${n}-${e}`,onClick:()=>Object(zj.a)(e,t,a),title:e},i.a.createElement(Uj,null,e))))),[a,t,u]),m=Object(n.useCallback)((e=>{c(e.target.value)}),[]);return Object(n.useEffect)((()=>{d(r.filter((e=>e.toLowerCase().includes(l.toLowerCase()))))}),[r,l]),i.a.createElement(V.EuiPopover,{ownFocus:!0,button:i.a.createElement(V.EuiFilterButton,{grow:!0,"data-test-subj":"tags-filter-popover-button",iconType:"arrowDown",onClick:()=>o(!s),numFilters:e.length,isSelected:s,hasActiveFilters:t.length>0,numActiveFilters:t.length},uo.Oc),isOpen:s,closePopover:()=>o(!s),panelPaddingSize:"none",repositionOnScroll:!0},i.a.createElement($j,null,i.a.createElement(V.EuiPopoverTitle,null,i.a.createElement(V.EuiFieldSearch,{placeholder:"Search tags",value:l,onChange:m,isClearable:!0,"aria-label":"Rules tag search"})),i.a.createElement(Vj,null,p),0===u.length&&i.a.createElement(V.EuiFlexGroup,{gutterSize:"m",justifyContent:"spaceAround"},i.a.createElement(V.EuiFlexItem,{grow:!0},i.a.createElement(V.EuiPanel,null,i.a.createElement(V.EuiText,null,uo.Tb))))))};Hj.displayName="TagsFilterPopoverComponent";const Gj=i.a.memo(Hj);Gj.displayName="TagsFilterPopover";const Qj=H()(V.EuiFlexGroup).withConfig({displayName:"FilterWrapper",componentId:"sc-10wrjwy-0"})(["margin-bottom:",";"],(({theme:e})=>e.eui.euiSizeXS)),Wj=H()(V.EuiFlexItem).withConfig({displayName:"SearchBarWrapper",componentId:"sc-10wrjwy-1"})(["& .euiPopover,& .euiPopover__anchor{display:block;}"]),Kj=()=>{const{startTransaction:e}=Object(So.a)(),{state:{filterOptions:t},actions:{setFilterOptions:a}}=Object(go.b)(),{data:r=[]}=pj(),{data:s}=pk(),o=null==s?void 0:s.rules_custom_installed,l=null==s?void 0:s.rules_installed,{showCustomRules:c,showElasticRules:u,tags:d}=t,[p,m]=Object(n.useState)(t.filter);Object(n.useEffect)((()=>{m(t.filter)}),[t.filter]);const g=Object(n.useCallback)((e=>m(e.target.value)),[]),b=Object(n.useCallback)((t=>{e({name:ko.d.FILTER}),a({filter:t.trim()})}),[a,e]),f=Object(n.useCallback)((()=>{e({name:ko.d.FILTER}),a({showElasticRules:!u,showCustomRules:!1})}),[a,u,e]),y=Object(n.useCallback)((()=>{e({name:ko.d.FILTER}),a({showCustomRules:!c,showElasticRules:!1})}),[a,c,e]),h=Object(n.useCallback)((t=>{Object(v.isEqual)(t,d)||(e({name:ko.d.FILTER}),a({tags:t}))}),[d,a,e]);return i.a.createElement(Qj,{gutterSize:"m",justifyContent:"flexEnd"},i.a.createElement(Wj,{grow:!0},i.a.createElement(V.EuiFieldSearch,{id:Rk,value:p,"aria-label":uo.Ic,fullWidth:!0,incremental:!1,placeholder:uo.Hc,onSearch:b,onChange:g})),i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiFilterGroup,null,i.a.createElement(Gj,{onSelectedTagsChanged:h,selectedTags:d,tags:r,"data-test-subj":"allRulesTagPopover"}))),i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiFilterGroup,null,i.a.createElement(V.EuiFilterButton,{hasActiveFilters:u,onClick:f,"data-test-subj":"showElasticRulesFilterButton",withNext:!0},uo.Cb,null!=l?` (${l})`:""),i.a.createElement(V.EuiFilterButton,{hasActiveFilters:c,onClick:y,"data-test-subj":"showCustomRulesFilterButton"},uo.qb,null!=o?` (${o})`:""))))};Kj.displayName="RulesTableFiltersComponent";const Yj=i.a.memo(Kj);Yj.displayName="RulesTableFilters";const Jj=H.a.div.withConfig({displayName:"ToolbarLayout",componentId:"sc-1o3prwf-0"})(["display:grid;grid-template-columns:1fr auto;align-items:center;grid-gap:16px;box-shadow:inset 0 -1px 0 ",";"],(({theme:e})=>e.eui.euiBorderColor));let Xj;!function(e){e.rules="rules",e.monitoring="monitoring"}(Xj||(Xj={}));const Zj=[{id:Xj.rules,name:uo.Bc,disabled:!1},{id:Xj.monitoring,name:uo.Qb,disabled:!1}],eO=i.a.memo((({onTabChange:e,activeTab:t})=>{const{state:{isInMemorySorting:a},actions:{setIsInMemorySorting:r}}=Object(go.b)(),{startTransaction:s}=Object(So.a)(),o=Object(n.useCallback)((e=>{s({name:a?ko.d.PREVIEW_OFF:ko.d.PREVIEW_ON}),r(e.target.checked)}),[a,r,s]);return i.a.createElement(Jj,null,i.a.createElement(V.EuiTabs,null,Zj.map((a=>i.a.createElement(V.EuiTab,{"data-test-subj":`allRulesTableTab-${a.id}`,onClick:()=>e(a.id),isSelected:a.id===t,disabled:a.disabled,key:a.id},a.name)))),i.a.createElement(V.EuiToolTip,{content:uo.Db},i.a.createElement(V.EuiSwitch,{"data-test-subj":a?"allRulesTableTechnicalPreviewOff":"allRulesTableTechnicalPreviewOn",label:a?uo.Fb:uo.Eb,checked:a,onChange:o})))}));eO.displayName="RulesTableToolbar";var tO=a(247);const aO=i.a.memo((({canBulkEdit:e,onGetBulkItemsPopoverContent:t,onToggleSelectAll:a,isBulkActionInProgress:r})=>{const{timelines:s}=Object(p.k)().services,{startTransaction:o}=Object(So.a)(),l=Object(go.b)(),{pagination:c,selectedRuleIds:u,isRefreshOn:d,isAllSelected:m,loadingRulesAction:g}=l.state,{reFetchRules:b,setIsRefreshOn:f}=l.actions,y=m?c.total:u.length,h=y>0,E=null!=g,v=Object(n.useCallback)((()=>{o({name:ko.d.REFRESH}),b()}),[b,o]),x=Object(n.useCallback)((e=>null!=t?i.a.createElement(V.EuiContextMenu,{initialPanelId:0,panels:t(e)}):null),[t]),k=Object(n.useCallback)((e=>t=>{const a=t.target.checked;a&&b(),f(a),e()}),[b,f]),S=Object(n.useCallback)((e=>i.a.createElement(V.EuiContextMenuPanel,{items:[i.a.createElement(V.EuiSwitch,{key:"allRulesAutoRefreshSwitch",label:uo.Zb,checked:null!=d&&d,onChange:k(e),compressed:!0,disabled:h,"data-test-subj":"refreshSettingsSwitch"}),...h?[i.a.createElement("div",{key:"refreshSettingsSelectionNote"},i.a.createElement(V.EuiSpacer,{size:"s"}),i.a.createElement(V.EuiTextColor,{color:"subdued","data-test-subj":"refreshSettingsSelectionNote"},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rules.refreshRulePopoverSelectionHelpText",defaultMessage:"Note: Refresh is disabled while there is an active selection."})))]:[]]})),[d,k,h]);return i.a.createElement(tO.a,{border:!0},i.a.createElement(tO.d,null,i.a.createElement(tO.c,null,i.a.createElement(tO.e,{dataTestSubj:"showingRules"},uo.Mc(...(({page:e,perPage:t,total:a})=>[0===a?0:(e-1)*t+1,e*t>a?a:e*t,a])(c)))),i.a.createElement(i.a.Fragment,null,i.a.createElement(tO.c,{"data-test-subj":"tableBulkActions"},i.a.createElement(tO.e,{dataTestSubj:"selectedRules"},uo.Jc(y)),e&&i.a.createElement(tO.b,{disabled:E,dataTestSubj:"selectAllRules",iconType:m?"cross":"pagesSelect",iconSide:"left",onClick:a},m?uo.Z:uo.Kc(c.total)),e&&i.a.createElement(tO.b,{disabled:E,inProgress:r,dataTestSubj:"bulkActions",iconSide:"right",iconType:"arrowDown",popoverPanelPaddingSize:"none",popoverContent:x},uo.f),i.a.createElement(tO.b,{disabled:E,dataTestSubj:"refreshRulesAction",iconSide:"left",iconType:"refresh",onClick:v},uo.Yb),i.a.createElement(tO.b,{disabled:E,dataTestSubj:"refreshSettings",iconSide:"right",iconType:"arrowDown",popoverContent:S},uo.ac)))),i.a.createElement(tO.d,{dataTestSubj:"refreshRulesStatus"},s.getLastUpdated({showUpdating:l.state.isFetching,updatedAt:l.state.lastUpdated})))}));aO.displayName="RulesTableUtilityBar";var nO=a(889),iO=a(890),rO=a(828);const sO=i.a.createElement(V.EuiEmptyPrompt,{title:i.a.createElement("h3",null,uo.Rb),titleSize:"xs",body:uo.Sb}),oO=i.a.memo((({selectedTab:e})=>{var t;const[{canUserCRUD:a}]=Object(le.b)(),r=Object(Js.c)(a),o=Object(n.useRef)(null),l=Object(go.b)(),{data:c,isLoading:u}=pk(),{state:{rules:d,filterOptions:m,isPreflightInProgress:g,isAllSelected:b,isFetched:f,isLoading:y,isRefetching:h,loadingRuleIds:E,loadingRulesAction:v,pagination:x,selectedRuleIds:k,sortingOptions:S},actions:{setIsAllSelected:j,setPage:O,setPerPage:w,setSelectedRuleIds:T,setSortingOptions:I}}=l,[C,M,F]=Object(Mo.a)(),[D,A,_]=qj({onInit:M,onFinish:F}),{bulkActionsDryRunResult:N,bulkAction:R,isBulkActionConfirmationVisible:P,showBulkActionConfirmation:B,cancelBulkActionConfirmation:q,approveBulkActionConfirmation:z}=(()=>{const[e,t]=Object(n.useState)(),[a,i]=Object(n.useState)(),[r,s,o]=Object(Mo.a)(),[l,c,u]=qj({onInit:s,onFinish:o});return{bulkActionsDryRunResult:a,bulkAction:e,isBulkActionConfirmationVisible:r,showBulkActionConfirmation:Object(n.useCallback)((async(e,a)=>{var n;if(t(a),i(e),!((null!==(n=null==e?void 0:e.failedRulesCount)&&void 0!==n?n:0)>0))return!0;const r=await l();return r&&c(),r}),[l,c]),cancelBulkActionConfirmation:u,approveBulkActionConfirmation:c}})(),{isBulkDuplicateConfirmationVisible:$,showBulkDuplicateConfirmation:U,cancelRuleDuplication:H,confirmRuleDuplication:G}=Object(nO.a)(),{bulkEditActionType:Q,isBulkEditFlyoutVisible:W,handleBulkEditFormConfirm:K,handleBulkEditFormCancel:Y,completeBulkEditForm:J}=(()=>{const e=Object(n.useRef)(null),[t,a]=Object(n.useState)(),[i,r,s]=Object(Mo.a)(),[o,l,c]=qj({onInit:r,onFinish:s}),u=Object(n.useCallback)((async t=>(a(t),!0===await o()?e.current:null)),[o]);return{bulkEditActionType:t,isBulkEditFlyoutVisible:i,handleBulkEditFormConfirm:Object(n.useCallback)((t=>{e.current=t,l()}),[l]),handleBulkEditFormCancel:c,completeBulkEditForm:u}})(),{isBulkActionsDryRunLoading:X,executeBulkActionsDryRun:Z}=(()=>{const{data:e,mutateAsync:t,isLoading:a}=Object(rk.useMutation)(["bulkActionsDryRun"],(async e=>{let t;try{t=await Object(Ai.l)({bulkAction:e,dryRun:!0})}catch(e){var a,n,i;if(void 0===(null===(a=e.body)||void 0===a||null===(n=a.attributes)||void 0===n||null===(i=n.summary)||void 0===i?void 0:i.total))return;t=e.body}return{succeededRulesCount:null==(r=t)?void 0:r.attributes.summary.succeeded,failedRulesCount:null==r?void 0:r.attributes.summary.failed,ruleErrors:null!==(s=null==r||null===(o=r.attributes.errors)||void 0===o?void 0:o.map((({message:e,err_code:t,rules:a})=>({message:e,errorCode:t,ruleIds:a.map((({id:e})=>e))}))))&&void 0!==s?s:[]};var r,s,o}));return{bulkActionsDryRunResult:e,isBulkActionsDryRunLoading:a,executeBulkActionsDryRun:t}})(),ee=(({filterOptions:e,confirmDeletion:t,showBulkActionConfirmation:a,showBulkDuplicateConfirmation:r,completeBulkEditForm:o,executeBulkActionsDryRun:l})=>{const c=Eo(),u=Object(go.b)(),d=fo(),p=Object(Oi.a)(),m=Object(Pj.a)(e),{startTransaction:g}=Object(So.a)(),{executeBulkAction:b}=Object(Oo.b)(),{bulkExport:f}=Object(jo.a)(),y=Object(wo.a)(),{state:{isAllSelected:h,rules:E,loadingRuleIds:v,selectedRuleIds:x},actions:{clearRulesSelection:k,setIsPreflightInProgress:S}}=u;return Object(n.useCallback)((n=>{const u=E.filter((({id:e})=>x.includes(e))),j=u.some((({enabled:e})=>e)),O=u.some((({enabled:e})=>!e)),w=x.some((e=>v.includes(e))),T=u.some((({immutable:e})=>e)),I=!d&&u.some((e=>!Object(Js.a)(e,d))),C=t=>async()=>{let r,s=!1;n(),S(!0);const c=await l({type:xo.b.edit,...h?{query:Object(Pj.a)(e)}:{ids:x},editPayload:Lj(t)});if(S(!1),!1===await a(c,xo.b.edit))return;const u=await o(t);if(null==u)return;g({name:ko.b.EDIT});const d=()=>{r&&p.api.remove(r)};setTimeout((()=>{var e;s||(r=p.addWarning({title:uo.W,text:Object(L.toMountPoint)(i.a.createElement(i.a.Fragment,null,i.a.createElement("p",null,uo.U(null!==(e=null==c?void 0:c.succeededRulesCount)&&void 0!==e?e:0)),i.a.createElement(V.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiButton,{color:"warning",size:"s",onClick:d},uo.V))))),iconType:void 0},{toastLifeTimeMs:6e5}))}),5e3),await b({type:xo.b.edit,...Bj({...h?{filterOptions:e}:{selectedRuleIds:x},dryRunResult:c}),editPayload:[u]}),d(),s=!0},M=w||0===x.length,F=I||w||0===x.length;return[{id:0,title:uo.v,items:[{key:uo.s,name:uo.s,"data-test-subj":"enableRuleBulk",disabled:I||w||!O&&!h,onClick:async()=>{g({name:ko.b.ENABLE}),n();const e=u.filter((({enabled:e})=>!e)),t=e.filter((({type:e})=>!Object(Ks.d)(e))),a=e.length-t.length;!c&&a>0&&p.addWarning(ue.g(a));const i=c?e.map((({id:e})=>e)):t.map((({id:e})=>e));await b({type:xo.b.enable,...h?{query:m}:{ids:i}})},toolTipContent:I?uo.Ob:void 0,toolTipPosition:"right",icon:void 0},{key:uo.r,name:uo.r,"data-test-subj":"duplicateRuleBulk",disabled:F,onClick:async()=>{g({name:ko.b.DUPLICATE}),n();const e=await r();null!==e&&(await b({type:xo.b.duplicate,duplicatePayload:{include_exceptions:e===vo.a.withExceptions},...h?{query:m}:{ids:x}}),k())},toolTipContent:I?uo.Ob:void 0,toolTipPosition:"right",icon:void 0},{key:uo.u,name:uo.u,"data-test-subj":"indexPatternsBulkEditRule",disabled:F,panel:2},{key:uo.x,name:uo.x,"data-test-subj":"tagsBulkEditRule",disabled:F,panel:1},{key:uo.i,name:uo.i,"data-test-subj":"addRuleActionsBulk",disabled:!d||F,onClick:C(xo.a.add_rule_actions),toolTipContent:d?void 0:uo.Ob,toolTipPosition:"right",icon:void 0},{key:uo.w,name:uo.w,"data-test-subj":"setScheduleBulk",disabled:F,onClick:C(xo.a.set_schedule),toolTipContent:I?uo.Ob:void 0,toolTipPosition:"right",icon:void 0},{key:uo.k,name:uo.k,"data-test-subj":"applyTimelineTemplateBulk",disabled:F,onClick:C(xo.a.set_timeline),toolTipContent:I?uo.Ob:void 0,toolTipPosition:"right",icon:void 0},{key:uo.t,name:uo.t,"data-test-subj":"exportRuleBulk",disabled:w||0===x.length,onClick:async()=>{n(),g({name:ko.b.EXPORT});const e=await f(h?{query:m}:{ids:x});if(!e)return;const t=await Object(_i.c)(e),i=await a((e=>({succeededRulesCount:e.exported_rules_count,failedRulesCount:e.missing_rules_count,ruleErrors:e.missing_rules.length?[{errorCode:s.F.IMMUTABLE,message:"Prebuilt rules can't be exported.",ruleIds:e.missing_rules.map((({rule_id:e})=>e))}]:[]}))(t),xo.b.export);!1!==i&&await y(e)},icon:void 0},{key:uo.q,name:uo.q,"data-test-subj":"disableRuleBulk",disabled:I||w||!j&&!h,onClick:async()=>{g({name:ko.b.DISABLE}),n();const e=u.filter((({enabled:e})=>e)).map((({id:e})=>e));await b({type:xo.b.disable,...h?{query:m}:{ids:e}})},toolTipContent:I?uo.Ob:void 0,toolTipPosition:"right",icon:void 0},{key:uo.n,name:i.a.createElement(V.EuiTextColor,{color:M?_s.euiThemeVars.euiButtonColorDisabledText:"danger"},uo.n),"data-test-subj":"deleteRuleBulk",disabled:M,onClick:async()=>{n(),h&&!1===await t()||(g({name:ko.b.DELETE}),await b({type:xo.b.delete,...h?{query:m}:{ids:x}}))},toolTipContent:T?uo.g:void 0,toolTipPosition:"right",icon:void 0}]},{id:1,title:uo.v,items:[{key:uo.j,name:uo.j,"data-test-subj":"addTagsBulkEditRule",onClick:C(xo.a.add_tags),disabled:F,toolTipContent:I?uo.Ob:void 0,toolTipPosition:"right"},{key:uo.p,name:uo.p,"data-test-subj":"deleteTagsBulkEditRule",onClick:C(xo.a.delete_tags),disabled:F,toolTipContent:I?uo.Ob:void 0,toolTipPosition:"right"}]},{id:2,title:uo.v,items:[{key:uo.h,name:uo.h,"data-test-subj":"addIndexPatternsBulkEditRule",onClick:C(xo.a.add_index_patterns),disabled:F,toolTipContent:I?uo.Ob:void 0,toolTipPosition:"right"},{key:uo.o,name:uo.o,"data-test-subj":"deleteIndexPatternsBulkEditRule",onClick:C(xo.a.delete_index_patterns),disabled:F,toolTipContent:I?uo.Ob:void 0,toolTipPosition:"right"}]}]}),[E,x,d,h,v,g,c,b,m,p,r,k,t,f,a,y,S,l,e,o])})({filterOptions:m,confirmDeletion:D,showBulkActionConfirmation:B,showBulkDuplicateConfirmation:U,completeBulkEditForm:J,executeBulkActionsDryRun:Z}),te=Object(n.useMemo)((()=>({pageIndex:x.page-1,pageSize:x.perPage,totalItemCount:x.total,pageSizeOptions:s.mc})),[x]),ae=Object(n.useCallback)((({page:e,sort:t})=>{var a,n;I({field:null!==(a=null==t?void 0:t.field)&&void 0!==a?a:"enabled",order:null!==(n=null==t?void 0:t.direction)&&void 0!==n?n:"desc"}),O(e.index+1),w(e.size)}),[O,w,I]),{loading:ne,jobs:ie,startMlJobs:re}=Object(rO.a)(),se=(({hasCRUDPermissions:e,isLoadingJobs:t,mlJobs:a,startMlJobs:r,showExceptionsDuplicateConfirmation:o})=>{const l=zo({showExceptionsDuplicateConfirmation:o}),c=Po(),{isInMemorySorting:u}=Object(go.b)().state,[d]=Object(p.q)(s.sc),m=No({hasCRUDPermissions:e,isLoadingJobs:t,mlJobs:a,startMlJobs:r}),g=Lo({sortable:!!u,width:"16%",isLoadingJobs:t,mlJobs:a});return Object(n.useMemo)((()=>[c,...d?[qo]:[],Bo,{field:"risk_score",name:uo.kb,render:e=>i.a.createElement(V.EuiText,{"data-test-subj":"riskScore",size:"s"},e),sortable:!0,truncateText:!0,width:"85px"},{field:"severity",name:uo.mb,render:e=>i.a.createElement(mn.a,{value:e}),sortable:!0,truncateText:!0,width:"12%"},{field:"execution_summary.last_execution.date",name:uo.fb,render:e=>null==e?Object(Xn.d)():i.a.createElement(xa.b,{tooltipFieldName:uo.fb,relativeThresholdInHrs:s.bb,value:e,tooltipAnchorClassName:"eui-textTruncate"}),sortable:!!u,truncateText:!0,width:"16%"},g,{field:"updated_at",name:uo.hb,render:e=>null==e?Object(Xn.d)():i.a.createElement(xa.b,{tooltipFieldName:uo.hb,relativeThresholdInHrs:s.bb,value:e,tooltipAnchorClassName:"eui-textTruncate"}),sortable:!0,width:"18%",truncateText:!0},{field:"version",name:uo.ob,render:e=>null==e?Object(Xn.d)():i.a.createElement(V.EuiText,{"data-test-subj":"version",size:"s"},e),sortable:!!u,truncateText:!0,width:"65px"},m,...e?[l]:[]]),[l,m,g,e,u,c,d])})({hasCRUDPermissions:r,isLoadingJobs:ne,mlJobs:ie,startMlJobs:re,showExceptionsDuplicateConfirmation:U}),oe=(({hasCRUDPermissions:e,isLoadingJobs:t,mlJobs:a,startMlJobs:r,showExceptionsDuplicateConfirmation:o})=>{const l=Object(p.k)().services.docLinks,c=zo({showExceptionsDuplicateConfirmation:o}),u=Po(),{isInMemorySorting:d}=Object(go.b)().state,[m]=Object(p.q)(s.sc),g=No({hasCRUDPermissions:e,isLoadingJobs:t,mlJobs:a,startMlJobs:r}),b=Lo({sortable:!!d,width:"12%",isLoadingJobs:t,mlJobs:a});return Object(n.useMemo)((()=>[{...u,width:"28%"},...m?[qo]:[],Bo,{field:"execution_summary.last_execution.metrics.total_indexing_duration_ms",name:i.a.createElement(bo.a,{title:uo.db,tooltipContent:uo.eb}),render:e=>i.a.createElement(V.EuiText,{"data-test-subj":"total_indexing_duration_ms",size:"s"},null!=e?e.toFixed():Object(Xn.d)()),sortable:!!d,truncateText:!0,width:"16%"},{field:"execution_summary.last_execution.metrics.total_search_duration_ms",name:i.a.createElement(bo.a,{title:uo.ib,tooltipContent:uo.jb}),render:e=>i.a.createElement(V.EuiText,{"data-test-subj":"total_search_duration_ms",size:"s"},null!=e?e.toFixed():Object(Xn.d)()),sortable:!!d,truncateText:!0,width:"14%"},{field:"execution_summary.last_execution.metrics.execution_gap_duration_s",name:i.a.createElement(bo.a,{title:uo.bb,customTooltip:i.a.createElement("div",{style:{maxWidth:"20px"}},i.a.createElement(mo.a,{columnName:uo.bb},i.a.createElement(V.EuiText,{style:{width:300}},i.a.createElement("p",null,i.a.createElement(dr.FormattedMessage,{defaultMessage:"Duration of most recent gap in Rule execution. Adjust Rule look-back or {seeDocs} for mitigating gaps.",id:"xpack.securitySolution.detectionEngine.rules.allRules.columns.gapTooltip",values:{seeDocs:i.a.createElement(V.EuiLink,{href:`${l.links.siem.troubleshootGaps}`,target:"_blank"},uo.cb)}})))))}),render:e=>i.a.createElement(V.EuiText,{"data-test-subj":"gap",size:"s"},null!=e?Ws.a.duration(e,"seconds").humanize():Object(Xn.d)()),sortable:!!d,truncateText:!0,width:"14%"},b,{field:"execution_summary.last_execution.date",name:uo.fb,render:e=>null==e?Object(Xn.d)():i.a.createElement(xa.b,{tooltipFieldName:uo.fb,relativeThresholdInHrs:s.bb,value:e,tooltipAnchorClassName:"eui-textTruncate"}),sortable:!!d,truncateText:!0,width:"16%"},g,...e?[c]:[]]),[c,l.links.siem.troubleshootGaps,g,b,e,d,u,m])})({hasCRUDPermissions:r,isLoadingJobs:ne,mlJobs:ie,startMlJobs:re,showExceptionsDuplicateConfirmation:U}),ce=Object(n.useRef)(!1);((e,t)=>{const a=Object(n.useRef)(t);Object(n.useEffect)((()=>{JSON.stringify(a.current)!==JSON.stringify(t)&&(a.current=t,e(t))}),[e,t])})((e=>{null!=o.current&&o.current.setSelection(d.filter((t=>e.includes(t.id))))}),k);const de=Object(n.useMemo)((()=>({selectable:e=>!E.includes(e.id),onSelectionChange:e=>{ce.current?(ce.current=!1,0===e.length&&(j(!1),T([]))):(T(e.map((({id:e})=>e))),j(!1))}})),[E,j,T]),pe=Object(n.useCallback)((()=>{ce.current=!0,j(!b),T(b?[]:d.map((({id:e})=>e)))}),[d,b,j,T]),me=!u&&0===(null==c?void 0:c.rules_custom_installed)&&0===c.rules_installed,ge=!u&&!y&&!me,be=e===Xj.rules?{"data-test-subj":"rules-table",columns:se}:{"data-test-subj":"monitoring-table",columns:oe},fe=f&&h,ye=!f&&h||g;return i.a.createElement(i.a.Fragment,null,fe&&i.a.createElement(V.EuiProgress,{"data-test-subj":"loadingRulesInfoProgress",size:"xs",position:"absolute",color:"accent"}),ye&&i.a.createElement(ji.a,{"data-test-subj":"loadingPanelAllRulesTable",overlay:!0,size:"xl"}),ge&&i.a.createElement(Yj,null),me&&i.a.createElement(WS,null),y&&i.a.createElement(V.EuiLoadingContent,{"data-test-subj":"initialLoadingPanelAllRulesTable",lines:10}),C&&i.a.createElement(V.EuiConfirmModal,{title:uo.xb,onCancel:_,onConfirm:A,confirmButtonText:uo.wb,cancelButtonText:uo.vb,buttonColor:"danger",defaultFocusedButton:"confirm","data-test-subj":"allRulesDeleteConfirmationModal"},i.a.createElement("p",null,uo.ub)),P&&R&&i.a.createElement(nj,{bulkAction:R,result:N,onCancel:q,onConfirm:z}),$&&i.a.createElement(iO.a,{onCancel:H,onConfirm:G,rulesCount:null!=k&&k.length?null==k?void 0:k.length:1}),W&&void 0!==Q&&i.a.createElement(Rj,{rulesCount:null!==(t=null==N?void 0:N.succeededRulesCount)&&void 0!==t?t:0,editAction:Q,onClose:Y,onConfirm:K}),ge&&i.a.createElement(i.a.Fragment,null,i.a.createElement(aO,{canBulkEdit:r,onGetBulkItemsPopoverContent:ee,onToggleSelectAll:pe,isBulkActionInProgress:X||null!=v}),i.a.createElement(V.EuiBasicTable,lr()({itemId:"id",items:d,isSelectable:r,noItemsMessage:sO,onChange:ae,pagination:te,ref:o,selection:r?de:void 0,sorting:{sort:{field:S.field,direction:S.order}}},be))))}));oO.displayName="RulesTables";const lO=i.a.memo((()=>{const[e,t]=Object(n.useState)(Xj.rules);return i.a.createElement(i.a.Fragment,null,i.a.createElement(Bk,null),i.a.createElement(eO,{activeTab:e,onTabChange:t}),i.a.createElement(V.EuiSpacer,null),i.a.createElement(oO,{selectedTab:e}))}));lO.displayName="AllRules";const cO=z.i18n.translate("xpack.securitySolution.detectionEngine.rules.tour.createRuleTourTitle",{defaultMessage:"New security rule features are available"}),uO=z.i18n.translate("xpack.securitySolution.detectionEngine.rules.tour.createRuleTourContent",{defaultMessage:"Alert suppression options are now available for Custom Query rules and multiple fields can be selected in New Terms rules"}),dO=({children:e})=>{var t;const a={currentTourStep:1,isTourActive:!0,tourPopoverWidth:300},{storage:r,guidedOnboarding:{guidedOnboardingApi:o}}=Object(p.k)().services,l=wk()(null!==(t=null==o?void 0:o.isGuideStepActive$("security","rules"))&&void 0!==t?t:Object(Rd.of)(!1),!0),[c,u]=Object(n.useState)((()=>{const e=r.get(s.Ub.RULE_MANAGEMENT_PAGE);return null!=e?e:a})),d=[{step:1,title:cO,content:i.a.createElement(V.EuiText,null,uO)}],m=Object(n.useCallback)((()=>{u({...c,isTourActive:!1})}),[c]);return Object(n.useEffect)((()=>{r.set(s.Ub.RULE_MANAGEMENT_PAGE,c)}),[c,r]),i.a.createElement(V.EuiTourStep,{content:d[0].content,isStepOpen:1===c.currentTourStep&&c.isTourActive&&!l,minWidth:c.tourPopoverWidth,onFinish:m,step:1,stepsTotal:d.length,subtitle:c.tourSubtitle,title:d[0].title,anchorPosition:"rightUp"},e)},pO=()=>{const[e,t,a]=Object(Mo.a)(),[r,o,l]=Object(Mo.a)(),{navigateToApp:c}=Object(p.k)().services.application,u=Object(ok.b)(),d=Object(sk.b)(),m=Object(n.useCallback)((()=>{u(),d()}),[u,d]),[{loading:g,isSignalIndexExists:b,isAuthenticated:f,hasEncryptionKey:h,canUserCRUD:v}]=Object(le.b)(),{loading:x,canWriteIndex:S,needsConfiguration:j}=Object(me.a)(),O=g||x,w=Sk(),T=jk();return Object(kk.h)(b,f,h,j)?(c(s.B,{deepLinkId:k.a.alerts,path:Object(X.a)()}),null):i.a.createElement(i.a.Fragment,null,i.a.createElement(Xt.a,null),i.a.createElement(Zt.a,null),i.a.createElement(ik,null),i.a.createElement(NS,{showFlyout:r,onClose:l}),i.a.createElement(Jx.a,{checkBoxLabel:uo.Vb,closeModal:a,description:uo.Lc,errorMessage:uo.Ib,failedDetailed:uo.Jb,importComplete:m,importData:Ai.j,successMessage:uo.Nc,showModal:e,submitBtnText:uo.Lb,subtitle:uo.Nb,title:uo.Kb,showExceptionsCheckBox:!0,showCheckBox:!0}),i.a.createElement(go.a,null,i.a.createElement(y.a,null,i.a.createElement(ta.a,{title:uo.Wb},i.a.createElement(V.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1,wrap:!0},i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(xk,null,(e=>i.a.createElement(Xk,e)))),i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiToolTip,{position:"top",content:uo.Pc},i.a.createElement(V.EuiButton,{"data-test-subj":"open-value-lists-modal-button",iconType:"importAction",isDisabled:!S||!v||O,onClick:o},uo.Mb))),i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiButton,{"data-test-subj":"rules-import-modal-button",iconType:"importAction",isDisabled:!Object(Js.c)(v)||O,onClick:t},uo.Kb)),i.a.createElement(dO,null,i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(be.l,{"data-test-subj":"create-new-rule",fill:!0,iconType:"plusInCircle",isDisabled:!Object(Js.c)(v)||O,deepLinkId:k.a.rulesCreate},uo.d))))),("ruleNeedUpdate"===w||"timelineNeedUpdate"===T)&&i.a.createElement(eS,{"data-test-subj":"update-callout-button"}),i.a.createElement(lO,{"data-test-subj":"all-rules"}))),i.a.createElement(E.a,{pageName:k.a.rules}))},mO=i.a.memo(pO),gO=H.a.div.withConfig({displayName:"RuleStatusIconStyled",componentId:"sc-1sbrlhw-0"})(["position:relative;svg{position:absolute;top:8px;left:9px;}"]),bO=({name:e,type:t})=>{const a=(()=>{const[e]=Object(p.q)(s.O);return e?_s.euiDarkVars:_s.euiLightVars})(),n="passive"===t?a.euiColorLightestShade:a.euiColorPrimary;return i.a.createElement(gO,null,i.a.createElement(V.EuiAvatar,{color:n,name:"valid"===t?"":e,size:"l"}),"valid"===t?i.a.createElement(V.EuiIcon,{type:"check",color:a.euiColorEmptyShade,size:"l"}):null)},fO=Object(n.memo)(bO),yO=({name:e,title:t,type:a})=>i.a.createElement(V.EuiFlexGroup,{alignItems:"center",gutterSize:"m",responsive:!1},i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(fO,{name:e,type:a})),i.a.createElement(V.EuiFlexItem,null,i.a.createElement(V.EuiTitle,{size:"s",className:"euiAccordionForm__title"},i.a.createElement("h6",null,t)))),hO=i.a.memo(yO);var EO=a(832),vO=a(835),xO=a(842),kO=a(833),SO=a(167),jO=a(415);const OO=z.i18n.translate("xpack.securitySolution.detectionEngine.createRule.pageTitle",{defaultMessage:"Create new rule"}),wO=z.i18n.translate("xpack.securitySolution.detectionEngine.createRule.backToRulesButton",{defaultMessage:"Rules"}),TO=z.i18n.translate("xpack.securitySolution.detectionEngine.createRule.rulePreviewTitle",{defaultMessage:"Rule preview"}),IO=(z.i18n.translate("xpack.securitySolution.detectionEngine.createRule.rulePreviewDescription",{defaultMessage:"Rule preview reflects the current configuration of your rule settings and exceptions, click refresh icon to see the updated preview."}),z.i18n.translate("xpack.securitySolution.detectionEngine.createRule.cancelButtonLabel",{defaultMessage:"Cancel"}),z.i18n.translate("xpack.securitySolution.detectionEngine.createRule.editRuleButton",{defaultMessage:"Edit"}));var CO=a(535),MO=a(52),FO=a.n(MO),DO=a(495);const AO=({timeframeOptions:e})=>{const t=1e3*(e.timeframeEnd.valueOf()/1e3-e.timeframeStart.valueOf()/1e3),{unit:a,value:n}=Object(jO.f)(e.interval),i=Ws.a.duration(n,a),r=i.asMilliseconds(),s=Math.max(Math.ceil(t/r),1),o=e.interval,{unit:l,value:c}=Object(jO.f)(e.lookback);return i.add(c,l),{invocationCount:s,interval:o,from:`now-${i.asSeconds()}s`}},_O={previewId:void 0,logs:[],isAborted:!1};var NO=a(268),RO=a.n(NO),PO=a(414),LO=a(881),BO=a(924),qO=a(560),zO=a(826);const $O=e=>Object(zO.a)({...e,enableActions:!1}),VO=H.a.div.attrs((({className:e})=>({className:`siemEventsTable__tdContent ${null!=e?e:""}`}))).withConfig({displayName:"EventsTdContent",componentId:"sc-w2s741-0"})(["font-size:",";line-height:",";min-width:0;padding:",";text-align:",";width:",";button.euiButtonIcon{margin-left:",";}"],(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.euiLineHeight),(({theme:e})=>e.eui.euiSizeXS),(({textAlign:e})=>e),(({width:e})=>null!=e?`${e}px`:"100%"),(({theme:e})=>`-${e.eui.euiSizeXS}`)),UO=H.a.div.withConfig({displayName:"ActionsContainer",componentId:"sc-w2s741-1"})(["align-items:center;display:flex;"]),HO=({ariaRowindex:e,columnValues:t,onEventDetailsPanelOpened:a})=>i.a.createElement(UO,null,i.a.createElement("div",{key:"expand-event"},i.a.createElement(VO,{textAlign:"center",width:G.DEFAULT_ACTION_BUTTON_WIDTH+10},i.a.createElement(V.EuiToolTip,{"data-test-subj":"expand-event-tool-tip",content:DO.r},i.a.createElement(V.EuiButtonIcon,{"aria-label":DO.s({ariaRowindex:e,columnValues:t}),"data-test-subj":"expand-event",iconType:"expand",onClick:a,size:"s"})))));HO.displayName="PreviewActionsComponent";const GO=i.a.memo(HO),QO=H()(V.EuiLoadingChart).withConfig({displayName:"LoadingChart",componentId:"sc-1g7nn5q-0"})(["display:block;margin:0 auto;"]),WO=H.a.div.withConfig({displayName:"FullScreenContainer",componentId:"sc-1g7nn5q-1"})(["height:",";flex:1 1 auto;display:flex;width:100%;"],(({$isFullScreen:e})=>e?"100%":void 0)),KO=({previewId:e,addNoiseWarning:t,spaceId:a,ruleType:r,indexPattern:l,timeframeOptions:c})=>{const u=Object(o.useDispatch)(),{setQuery:d,isInitializing:m}=Object(Y.a)(),{timelines:f}=Object(p.k)().services,y=Object(n.useMemo)((()=>c.timeframeStart.toISOString()),[c]),h=Object(n.useMemo)((()=>c.timeframeEnd.toISOString()),[c]),E=Object(n.useMemo)((()=>c.timeframeEnd.add("1","s").toISOString()),[c]),v=Object(n.useMemo)((()=>"eql"===r),[r]),x=Object(n.useMemo)((()=>"machine_learning"===r),[r]),[k,{data:S,inspect:j,totalCount:O,refetch:T}]=(({previewId:e,startDate:t,endDate:a,spaceId:i,ruleType:r,indexPattern:o})=>{const{uiSettings:l}=Object(p.k)().services,[c,u]=Object(od.c)({config:Object(Ki.getEsQueryConfig)(l),indexPattern:o,queries:[{query:`kibana.alert.rule.uuid:${e}`,language:"kuery"}],filters:[]}),d=Object(n.useMemo)((()=>"machine_learning"===r?"host.name":"event.category"),[r]),m=Object(n.useMemo)((()=>({endDate:a,errorMessage:DO.k,filterQuery:c,histogramType:Jn.l.preview,indexNames:[`${s.ab}-${i}`],stackByField:d,startDate:t,includeMissingData:!1,skip:null!=u})),[t,a,c,i,u,d]);return Object(BO.a)(m)})({previewId:e,startDate:y,endDate:h,spaceId:a,indexPattern:l,ruleType:r}),I=Object(Ku.b)(),{dataTable:{columns:C,defaultColumns:M,deletedEventIds:F,itemsPerPage:D,itemsPerPageOptions:A,sort:_}=Object(Ee.g)(I)}=Object(o.useSelector)((e=>Object(PO.a)(e,ua.c.rulePreview))),{browserFields:N,indexPattern:R,runtimeMappings:P,dataViewId:L,loading:q}=Object(g.d)(b.SourcererScopeName.detections),{globalFullScreen:z}=Object(fe.a)(),$=RO()(e),U=Object(B.a)("tGridEventRenderedViewEnabled");Object(n.useEffect)((()=>{$!==e&&O>0&&Object(LO.c)(O,c)&&t()}),[O,t,$,e,c]),Object(n.useEffect)((()=>{k||m||d({id:`previewHistogram-${e}`,inspect:j,loading:k,refetch:T})}),[d,j,k,m,T,e]),Object(n.useEffect)((()=>{u(W.a.createTGrid({columns:C,dataViewId:L,defaultColumns:M,id:ua.c.rulePreview,indexNames:[`${s.ab}-${a}`],itemsPerPage:D,sort:_}))}),[]);const H=Object(n.useMemo)((()=>Object(LO.a)(h,y,!v)),[h,y,v]),Q=Object(n.useMemo)((()=>[{key:"hits",value:S}]),[S]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(pl.a,{height:300,"data-test-subj":"preview-histogram-panel"},i.a.createElement(V.EuiFlexGroup,{gutterSize:"none",direction:"column"},i.a.createElement(V.EuiFlexItem,{grow:1},i.a.createElement(Tt.a,{id:`previewHistogram-${e}`,title:DO.j,titleSize:"xs"})),i.a.createElement(V.EuiFlexItem,{grow:1},k?i.a.createElement(QO,{size:"l","data-test-subj":"preview-histogram-loading"}):i.a.createElement(Kd.a,{configs:H,barChart:Q,"data-test-subj":"preview-histogram-bar-chart"})),i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiSpacer,null),i.a.createElement(V.EuiText,{size:"s",color:"subdued"},i.a.createElement("p",null,x?DO.f:DO.g)))))),i.a.createElement(V.EuiSpacer,null),i.a.createElement(WO,{$isFullScreen:z},i.a.createElement(Ne.c,null,f.getTGrid({additionalFilters:i.a.createElement(i.a.Fragment,null),appId:s.B,browserFields:N,columns:C,deletedEventIds:F,disabledCellActions:qO.a,end:E,start:y,entityType:"events",filters:[],globalFullScreen:z,id:ua.c.rulePreview,indexNames:[`${s.ab}-${a}`],indexPattern:R,isLive:!1,isLoadingIndexPattern:q,itemsPerPage:D,itemsPerPageOptions:A,query:{query:`kibana.alert.rule.uuid:${e}`,language:"kuery"},renderCellValue:$O,rowRenderers:ja.b,runtimeMappings:P,setQuery:()=>{},sort:_,tGridEventRenderedViewEnabled:U,type:"embedded",leadingControlColumns:(1.5,[{headerCellRender:()=>i.a.createElement(i.a.Fragment,null,DO.a),id:"default-timeline-control-column",rowCellRender:GO,width:Object(G.getActionsColumnWidth)(1.5)}])}))),i.a.createElement(w.a,{browserFields:N,entityType:"events",isFlyoutView:!0,runtimeMappings:P,scopeId:ua.c.rulePreview,isReadOnly:!0}))},YO=({message:e})=>i.a.createElement(V.EuiCallOut,{color:"warning",iconType:"alert","data-test-subj":"preview-abort"},i.a.createElement(V.EuiText,null,i.a.createElement("p",null,e))),JO=(e,t,a,n)=>t.length?[{startedAt:e,logs:t,duration:a},...n]:n,XO=({logs:e,hasNoiseWarning:t,isAborted:a})=>{const r=Object(n.useMemo)((()=>e.reduce((({errors:e,warnings:t},a)=>({errors:JO(a.startedAt,a.errors,a.duration,e),warnings:JO(a.startedAt,a.warnings,a.duration,t)})),{errors:[],warnings:[]})),[e]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiSpacer,{size:"s"}),null!=t?t:i.a.createElement(YO,{message:DO.o}),i.a.createElement(ZO,{logs:r.errors,isError:!0}),i.a.createElement(ZO,{logs:r.warnings},a?i.a.createElement(YO,{message:DO.h}):null))},ZO=({logs:e,isError:t,children:a})=>{const n=e[0];if(!a&&!n)return null;const r=a?e:e.slice(1),s=null!=a?a:i.a.createElement(ew,{logs:n.logs,startedAt:n.startedAt,isError:t,duration:n.duration});return i.a.createElement(i.a.Fragment,null,s,r.length>0?i.a.createElement(V.EuiAccordion,{id:t?"previewErrorAccordion":"previewWarningAccordion",buttonContent:t?DO.p:DO.q},r.map(((e,a)=>i.a.createElement(ew,{key:`accordion-log-${a}`,logs:e.logs,startedAt:e.startedAt,duration:e.duration,isError:t})))):null,i.a.createElement(V.EuiSpacer,{size:"m"}))},ew=({logs:e,startedAt:t,isError:a,duration:r})=>e.length>0?i.a.createElement(i.a.Fragment,null,e.map(((e,s)=>i.a.createElement(n.Fragment,{key:s},i.a.createElement(V.EuiCallOut,{color:a?"danger":"warning",iconType:"alert","data-test-subj":a?"preview-error":"preview-warning",title:`${t?`[${t}] `:""}[${r}ms]`},i.a.createElement(V.EuiText,null,i.a.createElement("p",null,e))),i.a.createElement(V.EuiSpacer,{size:"s"}))))):null,tw=H()(V.EuiLoadingChart).withConfig({displayName:"LoadingChart",componentId:"sc-179y2u8-0"})(["display:block;margin:0 auto;"]),aw=()=>i.a.createElement(pl.a,{height:300,"data-test-subj":"preview-histogram-panel"},i.a.createElement(V.EuiFlexGroup,{gutterSize:"none",direction:"column"},i.a.createElement(V.EuiFlexItem,{grow:1},i.a.createElement(Tt.a,{title:DO.j,titleSize:"xs",subtitle:"loading"})),i.a.createElement(V.EuiFlexItem,{grow:1},i.a.createElement(tw,{size:"l","data-test-subj":"preview-histogram-loading"})),i.a.createElement(V.EuiSpacer,null))),nw=[{start:"now/d",end:"now",label:"Today"},{start:"now/w",end:"now",label:"This week"},{start:"now-15m",end:"now",label:"Last 15 minutes"},{start:"now-30m",end:"now",label:"Last 30 minutes"},{start:"now-1h",end:"now",label:"Last 1 hour"},{start:"now-24h",end:"now",label:"Last 24 hours"},{start:"now-7d",end:"now",label:"Last 7 days"},{start:"now-30d",end:"now",label:"Last 30 days"}],iw=(e,t)=>({start:FO.a.parse(e)||Ws()().subtract(1,"hour"),end:FO.a.parse(t)||Ws()()}),rw=({isDisabled:e,defineRuleData:t,aboutRuleData:a,scheduleRuleData:r,exceptionsList:s})=>{const{indexPattern:o,ruleType:l}=t,{spaces:c}=Object(p.k)().services,[u,d]=Object(n.useState)("");Object(n.useEffect)((()=>{c&&c.getActiveSpace().then((e=>d(e.id)))}),[c]);const[m,g]=Object(n.useState)("now-1h"),[b,f]=Object(n.useState)("now"),[y,h]=Object(n.useState)(Ws()().subtract(1,"hour")),[E,v]=Object(n.useState)(Ws()()),[x,k]=Object(n.useState)(!1);Object(n.useEffect)((()=>{const{start:e,end:t}=iw(m,b);h(e),v(t)}),[m,b]);const[S,j]=Object(n.useState)({timeframeOptions:{timeframeStart:y,timeframeEnd:E,interval:"5m",lookback:"1m"}}),{invocationCount:O}=AO({timeframeOptions:{timeframeStart:y,timeframeEnd:E,interval:r.interval,lookback:r.from}}),w=O>200,{addNoiseWarning:T,createPreview:I,isPreviewRequestInProgress:C,previewId:M,logs:F,hasNoiseWarning:D,isAborted:A}=(({defineRuleData:e,aboutRuleData:t,scheduleRuleData:a,exceptionsList:i,timeframeOptions:r})=>{var s,o;const[l,c]=Object(n.useState)(!1),{isLoading:u,response:d,rule:p,setRule:m}=(({timeframeOptions:e})=>{const[t,a]=Object(n.useState)(null),[i,r]=Object(n.useState)(_O),[s,o]=Object(n.useState)(!1),{addError:l}=Object(Oi.a)(),{invocationCount:c,interval:u,from:d}=AO({timeframeOptions:e}),p=Object(n.useMemo)((()=>e.timeframeEnd.toISOString()),[e]);return Object(n.useEffect)((()=>{t||(r(_O),o(!1))}),[t]),Object(n.useEffect)((()=>{let e=!0;const a=new AbortController;return r(_O),(async()=>{if(null!=t){try{o(!0);const n=await Object(Ai.m)({rule:{...Object(RS.b)({...t,interval:u,from:d}),invocationCount:c,timeframeEnd:p},signal:a.signal});e&&r(n)}catch(t){e&&l(t,{title:uk.a})}e&&o(!1)}})(),()=>{e=!1,a.abort()}}),[t,l,c,d,u,p]),{isLoading:s,response:i,rule:t,setRule:a}})({timeframeOptions:r}),[g,b]=Object(n.useState)(null!==(s=d.logs)&&void 0!==s?s:[]),[f,y]=Object(n.useState)(!!d.isAborted),[h,E]=Object(n.useState)(!1);Object(n.useEffect)((()=>{var e;b(null!==(e=d.logs)&&void 0!==e?e:[]),y(!!d.isAborted)}),[d]);const v=Object(n.useCallback)((()=>{E(!0)}),[E]),x=Object(n.useCallback)((()=>{m(null),b([]),y(!1),c(!1),E(!1)}),[m]);return Object(n.useEffect)((()=>{x()}),[x,e,t,a]),Object(n.useEffect)((()=>{e&&t&&a&&l&&null===p&&m(Object(jO.c)({defineRuleData:e,aboutRuleData:t,scheduleRuleData:a,exceptionsList:i}))}),[l,p,m,e,t,a,i]),{hasNoiseWarning:h,addNoiseWarning:v,createPreview:()=>c(!0),clearPreview:x,isPreviewRequestInProgress:u,previewId:null!==(o=d.previewId)&&void 0!==o?o:"",logs:g,isAborted:f}})({defineRuleData:S.defineRuleData,aboutRuleData:S.aboutRuleData,scheduleRuleData:S.scheduleRuleData,exceptionsList:s,timeframeOptions:S.timeframeOptions}),{startTransaction:_}=Object(So.a)(),[N,R]=Object(n.useState)(!1);Object(n.useEffect)((()=>{N&&(I(),R(!1))}),[N,I]),Object(n.useEffect)((()=>{const{start:e,end:t}=iw(m,b);h(e),v(t)}),[b,m]);const P=Object(n.useCallback)((({start:e,end:t,isInvalid:a})=>{k(a),a||(g(e),f(t))}),[]),L=Object(n.useCallback)((()=>{_({name:ko.e.PREVIEW});const{start:e,end:n}=iw(m,b);h(e),v(n),j({defineRuleData:t,aboutRuleData:a,scheduleRuleData:r,timeframeOptions:{timeframeStart:e,timeframeEnd:n,interval:r.interval,lookback:r.from}}),R(!0)}),[a,t,b,r,m,_]),B=Object(n.useMemo)((()=>!(y.isSame(S.timeframeOptions.timeframeStart)&&E.isSame(S.timeframeOptions.timeframeEnd)&&Object(vE.isEqual)(t,S.defineRuleData)&&Object(vE.isEqual)(a,S.aboutRuleData)&&Object(vE.isEqual)(r,S.scheduleRuleData))),[a,t,S.aboutRuleData,S.defineRuleData,S.scheduleRuleData,S.timeframeOptions.timeframeEnd,S.timeframeOptions.timeframeStart,r,E,y]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiSpacer,{size:"s"}),w&&i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiCallOut,{color:"warning",title:DO.m,"data-test-subj":"previewInvocationCountWarning"},DO.l),i.a.createElement(V.EuiSpacer,null)),i.a.createElement(V.EuiFormRow,{label:DO.n,error:void 0,isInvalid:!1,"data-test-subj":"rule-preview",describedByIds:["rule-preview"]},i.a.createElement(V.EuiFlexGroup,{alignItems:"center",responsive:!1,gutterSize:"s"},i.a.createElement(V.EuiSuperDatePicker,{start:m,end:b,isDisabled:e,onTimeChange:P,showUpdateButton:!1,commonlyUsedRanges:nw,onRefresh:L,"data-test-subj":"preview-time-frame"}),i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiSuperUpdateButton,{isDisabled:x||e,iconType:B?"kqlFunction":"refresh",onClick:L,color:B?"success":"primary",fill:!0,"data-test-subj":"previewSubmitButton"})))),i.a.createElement(V.EuiSpacer,{size:"l"}),C&&i.a.createElement(aw,null),!C&&M&&u&&i.a.createElement(KO,{ruleType:l,previewId:M,addNoiseWarning:T,spaceId:u,indexPattern:o,timeframeOptions:S.timeframeOptions}),i.a.createElement(XO,{logs:F,hasNoiseWarning:D,isAborted:A}))},sw=i.a.memo(rw),ow=z.i18n.translate("xpack.securitySolution.detectionEngine.createRule.rulePreviewTitle",{defaultMessage:"Rule preview"}),lw=z.i18n.translate("xpack.securitySolution.detectionEngine.createRule.rulePreviewDescription",{defaultMessage:"Rule preview reflects the current configuration of your rule settings and exceptions, click refresh icon to see the updated preview."}),cw=z.i18n.translate("xpack.securitySolution.detectionEngine.createRule.cancelButtonLabel",{defaultMessage:"Cancel"}),uw=H()(V.EuiFlyout).withConfig({displayName:"StyledEuiFlyout",componentId:"sc-1oj0sti-0"})(["clip-path:none;"]),dw=H()(V.EuiFlyoutBody).withConfig({displayName:"StyledEuiFlyoutBody",componentId:"sc-1oj0sti-1"})(["overflow-y:hidden;flex:1;.euiFlyoutBody__overflow{mask-image:none;}"]),pw=({isDisabled:e,defineStepData:t,aboutStepData:a,scheduleStepData:n,exceptionsList:r,onClose:s})=>i.a.createElement(uw,{type:"push",size:"550px",ownFocus:!1,onClose:s},i.a.createElement(V.EuiFlyoutHeader,{hasBorder:!0},i.a.createElement(V.EuiTitle,{size:"m"},i.a.createElement("h2",null,ow)),i.a.createElement(V.EuiSpacer,{size:"s"}),i.a.createElement(V.EuiText,{color:"subdued"},i.a.createElement("p",null,lw))),i.a.createElement(dw,null,i.a.createElement(sw,{isDisabled:e,defineRuleData:t,aboutRuleData:a,scheduleRuleData:n,exceptionsList:r})),i.a.createElement(V.EuiFlyoutFooter,null,i.a.createElement(V.EuiButton,{onClick:s},cw))),mw=i.a.memo(pw),gw=async()=>{},bw=H()(V.EuiPanel).withConfig({displayName:"MyEuiPanel",componentId:"sc-9ipbhp-0"})(["position:relative;z-index:",";> .euiAccordion > .euiAccordion__triggerWrapper{.euiAccordion__button{cursor:default !important;&:hover{text-decoration:none !important;}}.euiAccordion__iconWrapper{display:none;}}.euiAccordion__childWrapper{transform:none;}"],(e=>e.zindex));bw.displayName="MyEuiPanel";const fw=(e,t)=>t!==e?"0":"1",yw=()=>{var e;const[{loading:t,isSignalIndexExists:a,isAuthenticated:r,hasEncryptionKey:o,canUserCRUD:l}]=Object(le.b)(),{loading:c,needsConfiguration:u}=Object(me.a)(),{addSuccess:d}=Object(Oi.a)(),{navigateToApp:m}=Object(p.k)().services.application,{data:g}=Object(p.k)().services,b=t||c,[f,h]=Object(n.useState)(SO.b.defineRule),v=Object(n.useRef)(null),x=Object(n.useRef)(null),S=Object(n.useRef)(null),j=Object(n.useRef)(null),[O]=Object(p.q)(s.S),[w]=Object(p.q)(s.eb),T=Object(n.useRef)({[SO.b.defineRule]:gw,[SO.b.aboutRule]:gw,[SO.b.scheduleRule]:gw,[SO.b.ruleActions]:gw}),I=Object(n.useCallback)(((e,t)=>{T.current[e]=t}),[]),C=Object(n.useRef)({[SO.b.defineRule]:{isValid:!1,data:void 0},[SO.b.aboutRule]:{isValid:!1,data:void 0},[SO.b.scheduleRule]:{isValid:!1,data:void 0},[SO.b.ruleActions]:{isValid:!1,data:void 0}}),M=(e,t)=>{C.current[e]=t},[F,D]=Object(n.useState)({[SO.b.defineRule]:!1,[SO.b.aboutRule]:!1,[SO.b.scheduleRule]:!1,[SO.b.ruleActions]:!1}),{mutateAsync:A,isLoading:_}=(()=>{const{addError:e}=Object(Oi.a)();return(e=>{const t=Object(ok.b)(),a=Object(lk.b)(),n=Object(sk.b)();return Object(rk.useMutation)((e=>Object(Ai.d)({rule:Object(RS.b)(e)})),{...e,mutationKey:BS,onSettled:(...i)=>{n(),t(),a(),null!=e&&e.onSettled&&e.onSettled(...i)}})})({onError:t=>{e(t,{title:uk.a})}})})(),N=null===(e=C.current[SO.b.defineRule].data)||void 0===e?void 0:e.ruleType,R=Object(n.useMemo)((()=>Object(kk.c)(N)),[N]),[P,L]=Object(n.useState)({}),[B,q]=Object(n.useState)(!1),[$,U]=Object(n.useState)(!1),[H,G]=Object(n.useState)({...CO.f,index:O,threatIndex:w}),[Q,W]=Object(n.useState)(CO.e),[K,Y]=Object(n.useState)(Object(CO.b)(H.ruleType));Object(n.useEffect)((()=>{const e=Object(Fo.f)(H.ruleType);W(e?{...CO.e,threatIndicatorPath:s.T}:CO.e),Y(Object(CO.b)(H.ruleType))}),[H.ruleType]);const J=Object(n.useCallback)((e=>{f===SO.b.defineRule?G(e):f===SO.b.aboutRule?W(e):f===SO.b.scheduleRule&&Y(e)}),[f]),{starting:Z,startMlJobs:ee}=Object(rO.a)();Object(n.useEffect)((()=>{(async()=>{const e=(await g.dataViews.getIdsWithTitle()).reduce(((e,t)=>({...e,[t.id]:t})),{});L(e)})()}),[g.dataViews]);const te=Object(n.useCallback)(((e,t)=>D((a=>({...a,[e]:t})))),[]),ae=Object(n.useCallback)((e=>{CO.d.indexOf(e)>CO.d.indexOf(f)&&!F[e]&&ne(e),h(e)}),[f,F]),ne=e=>{var t;if(e===SO.b.defineRule)null===(t=v.current)||void 0===t||t.onToggle();else if(e===SO.b.aboutRule){var a;null===(a=x.current)||void 0===a||a.onToggle()}else if(e===SO.b.scheduleRule){var n;null===(n=S.current)||void 0===n||n.onToggle()}else if(e===SO.b.ruleActions){var i;null===(i=j.current)||void 0===i||i.onToggle()}},ie=Object(n.useCallback)((async e=>{const t=await T.current[f]();null!=t&&t.isValid&&(M(f,t),ae(e))}),[f,ae]),re=Object(n.useCallback)((async e=>{const t=await T.current[e]();if(null!=t&&t.isValid&&t.data){J(t.data),M(e,t);const n=(e=>CO.d[CO.d.indexOf(e)+1])(e);if(null!=n)ae(n);else{const e=C.current[SO.b.defineRule],t=C.current[SO.b.aboutRule],n=C.current[SO.b.scheduleRule],i=C.current[SO.b.ruleActions];if(Object(jO.k)(e)&&Object(jO.k)(t)&&Object(jO.k)(n)&&Object(jO.k)(i)){const r=async()=>{Object(Fo.c)(e.data.ruleType)&&i.data.enabled&&await ee(e.data.machineLearningJobId)},[,o]=await Promise.all([r(),A(Object(jO.d)(e.data,t.data,n.data,i.data))]);d((a=o.name,z.i18n.translate("xpack.securitySolution.detectionEngine.rules.create.successfullyCreatedRuleTitle",{values:{ruleName:a},defaultMessage:"{ruleName} was created"}))),m(s.B,{deepLinkId:k.a.rules,path:Object(X.d)(o.id)})}}}var a}),[J,ae,A,m,ee,d]),se=Object(n.useCallback)((e=>e===f?"active":C.current[e].isValid?"valid":"passive"),[f]),oe=i.a.createElement(hO,{name:"1",title:uo.rb,type:se(SO.b.defineRule)}),ce=i.a.createElement(hO,{name:"2",title:uo.b,type:se(SO.b.aboutRule)}),ue=i.a.createElement(hO,{name:"3",title:uo.Gc,type:se(SO.b.scheduleRule)}),de=i.a.createElement(hO,{name:"4",title:uo.Cc,type:se(SO.b.ruleActions)});return Object(kk.h)(a,r,o,u)?(m(s.B,{deepLinkId:k.a.alerts,path:Object(X.a)()}),null):Object(Js.c)(l)?i.a.createElement(i.a.Fragment,null,i.a.createElement(y.a,null,i.a.createElement(V.EuiFlexGroup,{direction:"row",justifyContent:"spaceAround"},i.a.createElement(kk.a,null,i.a.createElement(ta.a,{backOptions:{path:Object(X.e)(),text:wO,pageId:k.a.rules},isLoading:_||b,title:OO},i.a.createElement(V.EuiButton,{"data-test-subj":"preview-flyout",iconType:"visBarVerticalStacked",onClick:()=>U((e=>!e))},TO)),i.a.createElement(bw,{zindex:4,hasBorder:!0},i.a.createElement(V.EuiAccordion,{initialIsOpen:!0,id:SO.b.defineRule,buttonContent:oe,paddingSize:"xs",ref:v,onToggle:te.bind(null,SO.b.defineRule),extraAction:C.current[SO.b.defineRule].isValid&&i.a.createElement(V.EuiButtonEmpty,{"data-test-subj":"edit-define-rule",iconType:"pencil",size:"xs",onClick:()=>ie(SO.b.defineRule)},IO)},i.a.createElement(V.EuiHorizontalRule,{margin:"m"}),i.a.createElement(EO.b,{addPadding:!0,defaultValues:H,isReadOnlyView:f!==SO.b.defineRule,isLoading:_||b,setForm:I,onSubmit:()=>re(SO.b.defineRule),kibanaDataViews:P,descriptionColumns:"singleSplit",key:fw(SO.b.defineRule,f),indicesConfig:O,threatIndicesConfig:w,onRuleDataChange:J,onPreviewDisabledStateChange:q}))),i.a.createElement(V.EuiSpacer,{size:"l"}),i.a.createElement(bw,{hasBorder:!0,zindex:3},i.a.createElement(V.EuiAccordion,{initialIsOpen:!1,id:SO.b.aboutRule,buttonContent:ce,paddingSize:"xs",ref:x,onToggle:te.bind(null,SO.b.aboutRule),extraAction:C.current[SO.b.aboutRule].isValid&&i.a.createElement(V.EuiButtonEmpty,{"data-test-subj":"edit-about-rule",iconType:"pencil",size:"xs",onClick:()=>ie(SO.b.aboutRule)},IO)},i.a.createElement(V.EuiHorizontalRule,{margin:"m"}),i.a.createElement(vO.a,{addPadding:!0,defaultValues:Q,defineRuleData:H,descriptionColumns:"singleSplit",isReadOnlyView:f!==SO.b.aboutRule,isLoading:_||b,setForm:I,onSubmit:()=>re(SO.b.aboutRule),key:fw(SO.b.aboutRule,f),onRuleDataChange:J}))),i.a.createElement(V.EuiSpacer,{size:"l"}),i.a.createElement(bw,{hasBorder:!0,zindex:2},i.a.createElement(V.EuiAccordion,{initialIsOpen:!1,id:SO.b.scheduleRule,buttonContent:ue,paddingSize:"xs",ref:S,onToggle:te.bind(null,SO.b.scheduleRule),extraAction:C.current[SO.b.scheduleRule].isValid&&i.a.createElement(V.EuiButtonEmpty,{iconType:"pencil",size:"xs",onClick:()=>ie(SO.b.scheduleRule)},IO)},i.a.createElement(V.EuiHorizontalRule,{margin:"m"}),i.a.createElement(xO.a,{addPadding:!0,defaultValues:K,descriptionColumns:"singleSplit",isReadOnlyView:f!==SO.b.scheduleRule,isLoading:_||b,setForm:I,onSubmit:()=>re(SO.b.scheduleRule),key:fw(SO.b.scheduleRule,f),onRuleDataChange:J}))),i.a.createElement(V.EuiSpacer,{size:"l"}),i.a.createElement(bw,{hasBorder:!0,zindex:1},i.a.createElement(V.EuiAccordion,{initialIsOpen:!1,id:SO.b.ruleActions,buttonContent:de,paddingSize:"xs",ref:j,onToggle:te.bind(null,SO.b.ruleActions),extraAction:C.current[SO.b.ruleActions].isValid&&i.a.createElement(V.EuiButtonEmpty,{iconType:"pencil",size:"xs",onClick:()=>ie(SO.b.ruleActions)},IO)},i.a.createElement(V.EuiHorizontalRule,{margin:"m"}),i.a.createElement(kO.a,{addPadding:!0,defaultValues:C.current[SO.b.ruleActions].data,isReadOnlyView:f!==SO.b.ruleActions,isLoading:_||b||Z,setForm:I,onSubmit:()=>re(SO.b.ruleActions),actionMessageParams:R,key:fw(SO.b.ruleActions,f),ruleType:N}))),$&&i.a.createElement(mw,{isDisabled:B&&f===SO.b.defineRule,defineStepData:H,aboutStepData:Q,scheduleStepData:K,onClose:()=>U(!1)})))),i.a.createElement(E.a,{pageName:k.a.rulesCreate})):(m(s.B,{deepLinkId:k.a.rules,path:Object(X.e)()}),null)},hw=i.a.memo(yw);var Ew=a(883);const vw=z.i18n.translate("xpack.securitySolution.detectionEngine.editRule.pageTitle",{defaultMessage:"Edit rule settings"}),xw=z.i18n.translate("xpack.securitySolution.detectionEngine.editRule.cancelTitle",{defaultMessage:"Cancel"}),kw=z.i18n.translate("xpack.securitySolution.detectionEngine.editRule.saveChangeTitle",{defaultMessage:"Save changes"}),Sw=z.i18n.translate("xpack.securitySolution.detectionEngine.editRule.errorMsgDescription",{defaultMessage:"Sorry"}),jw=z.i18n.translate("xpack.securitySolution.detectionEngine.editRule.backToDescription",{defaultMessage:"Back to"});var Ow=a(886);const ww=async()=>{},Tw=()=>{var e;const[,t]=Object(Wg.g)(),[{loading:a,isSignalIndexExists:r,isAuthenticated:o,hasEncryptionKey:l,canUserCRUD:c}]=Object(le.b)(),{loading:u,needsConfiguration:d}=Object(me.a)(),{data:m}=Object(p.k)().services,{navigateToApp:g}=Object(p.k)().services.application,{detailName:b}=Object(P.useParams)(),{data:f,isLoading:h}=Object(HS.a)(b),v=h||a||u,{isSavedQueryLoading:x,savedQueryBar:S,savedQuery:j}=Object(Ow.a)(null==f?void 0:f.saved_id,{ruleType:null==f?void 0:f.type,onError:vE.noop}),O=Object(n.useRef)({[SO.b.defineRule]:ww,[SO.b.aboutRule]:ww,[SO.b.scheduleRule]:ww,[SO.b.ruleActions]:ww}),w=Object(n.useRef)({[SO.b.defineRule]:{isValid:!1,data:void 0},[SO.b.aboutRule]:{isValid:!1,data:void 0},[SO.b.scheduleRule]:{isValid:!1,data:void 0},[SO.b.ruleActions]:{isValid:!1,data:void 0}}),[T,I]=Object(n.useState)(w.current[SO.b.defineRule]),[C,M]=Object(n.useState)(w.current[SO.b.aboutRule]),[F,D]=Object(n.useState)(w.current[SO.b.scheduleRule]),[A,_]=Object(n.useState)(w.current[SO.b.ruleActions]),[N,R]=Object(n.useState)(SO.b.defineRule),L=CO.d.filter((e=>{const t=w.current[e];return null!=t.data&&!Object(jO.k)(t)})),{mutateAsync:B,isLoading:q}=(()=>{const{addError:e}=Object(Oi.a)();return(e=>{const t=Object(ok.b)(),a=Object(lk.b)(),n=Object(PS.b)();return Object(rk.useMutation)((e=>Object(Ai.n)({rule:Object(RS.b)(e)})),{...e,mutationKey:LS,onSettled:(...i)=>{t(),n(),a(),null!=e&&e.onSettled&&e.onSettled(...i)}})})({onError:t=>{e(t,{title:uk.a})}})})(),[$,U]=Object(n.useState)({}),[H,G]=Object(n.useState)(!1),[Q,W]=Object(n.useState)(!1);Object(n.useEffect)((()=>{(async()=>{const e=(await m.dataViews.getIdsWithTitle()).reduce(((e,t)=>({...e,[t.id]:t})),{});U(e)})()}),[m.dataViews]);const K=Object(n.useMemo)((()=>Object(kk.c)(null==f?void 0:f.type)),[null==f?void 0:f.type]),Y=Object(n.useCallback)(((e,t)=>{O.current[e]=t,e===N&&t()}),[N]),J=Object(n.useCallback)(((e,t,a)=>{switch(e){case SO.b.aboutRule:const n=t;return void M({...w.current[e],data:n,isValid:a});case SO.b.defineRule:const i=t;return void I({...w.current[e],data:i,isValid:a});case SO.b.ruleActions:const r=t;return void _({...w.current[e],data:r,isValid:a});case SO.b.scheduleRule:const s=t;D({...w.current[e],data:s,isValid:a})}}),[]),Z=Object(n.useCallback)((async()=>{if(N===SO.b.defineRule){const e=await O.current[SO.b.defineRule]();null!=e&&e.isValid&&null!=e&&e.data&&I(e)}else if(N===SO.b.aboutRule){const e=await O.current[SO.b.aboutRule]();null!=e&&e.isValid&&null!=e&&e.data&&M(e)}else if(N===SO.b.scheduleRule){const e=await O.current[SO.b.scheduleRule]();null!=e&&e.isValid&&null!=e&&e.data&&D(e)}}),[N]),ee=Object(n.useCallback)((()=>W(!1)),[]),[te]=Object(p.q)(s.S),[ae]=Object(p.q)(s.eb),ne=Object(n.useMemo)((()=>T.data?{...T.data,queryBar:null!=S?S:T.data.queryBar}:T.data),[T.data,S]),ie=Object(n.useMemo)((()=>[{"data-test-subj":"edit-rule-define-tab",id:SO.b.defineRule,name:uo.sb,disabled:null==f?void 0:f.immutable,content:i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiSpacer,null),i.a.createElement(Ew.a,{loading:v||x,title:uo.sb},null!=ne&&!x&&i.a.createElement(EO.b,{isReadOnlyView:!1,isLoading:q||x,isUpdateView:!0,defaultValues:ne,setForm:Y,kibanaDataViews:$,indicesConfig:te,threatIndicesConfig:ae,onRuleDataChange:Z,onPreviewDisabledStateChange:G,defaultSavedQuery:j}),i.a.createElement(V.EuiSpacer,null)))},{"data-test-subj":"edit-rule-about-tab",id:SO.b.aboutRule,name:uo.a,disabled:null==f?void 0:f.immutable,content:i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiSpacer,null),i.a.createElement(Ew.a,{loading:v,title:uo.a},null!=C.data&&null!=T.data&&i.a.createElement(vO.a,{isReadOnlyView:!1,isLoading:q,isUpdateView:!0,defaultValues:C.data,defineRuleData:T.data,setForm:Y,onRuleDataChange:Z}),i.a.createElement(V.EuiSpacer,null)))},{"data-test-subj":"edit-rule-schedule-tab",id:SO.b.scheduleRule,name:uo.Fc,disabled:null==f?void 0:f.immutable,content:i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiSpacer,null),i.a.createElement(Ew.a,{loading:v,title:uo.Fc},null!=F.data&&i.a.createElement(xO.a,{isReadOnlyView:!1,isLoading:q,isUpdateView:!0,defaultValues:F.data,setForm:Y,onRuleDataChange:Z}),i.a.createElement(V.EuiSpacer,null)))},{"data-test-subj":"edit-rule-actions-tab",id:SO.b.ruleActions,name:uo.c,content:i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiSpacer,null),i.a.createElement(Ew.a,{loading:v},null!=A.data&&i.a.createElement(kO.a,{isReadOnlyView:!1,isLoading:q,isUpdateView:!0,defaultValues:A.data,setForm:Y,actionMessageParams:K,ruleType:null==f?void 0:f.type}),i.a.createElement(V.EuiSpacer,null)))}]),[null==f?void 0:f.immutable,null==f?void 0:f.type,v,T.data,q,x,ne,Y,$,te,ae,Z,C.data,F.data,A.data,K,j]),{startTransaction:re}=Object(So.a)(),se=Object(n.useCallback)((async()=>{const e=await O.current[N]();null!=(null==e?void 0:e.data)&&J(N,e.data,e.isValid);const a=Object(jO.i)(e)?e:T,n=Object(jO.g)(e)?e:C,i=Object(jO.j)(e)?e:F,r=Object(jO.h)(e)?e:A;var o,l;Object(jO.k)(a)&&Object(jO.k)(n)&&Object(jO.k)(i)&&Object(jO.k)(r)&&(re({name:ko.e.SAVE}),await B({...Object(jO.d)(a.data,n.data,i.data,r.data,null==f?void 0:f.exceptions_list),...b?{id:b}:{},...null!=f?{max_signals:f.max_signals}:{}}),Object(Wg.e)((l=null!==(o=null==f?void 0:f.name)&&void 0!==o?o:"",z.i18n.translate("xpack.securitySolution.detectionEngine.rules.update.successfullySavedRuleTitle",{values:{ruleName:l},defaultMessage:"{ruleName} was saved"})),t),g(s.B,{deepLinkId:k.a.rules,path:Object(X.d)(null!=b?b:"")}))}),[C,A,N,T,t,g,f,b,F,J,B,re]);Object(n.useEffect)((()=>{if(null!=f){const{aboutRuleData:e,defineRuleData:t,scheduleRuleData:a,ruleActionsData:n}=Object(kk.g)({rule:f});J(SO.b.defineRule,t,!0),J(SO.b.aboutRule,e,!0),J(SO.b.scheduleRule,a,!0),J(SO.b.ruleActions,n,!0)}}),[f,J]);const oe=Object(n.useCallback)((async e=>{R(e),await O.current[e]()}),[]),ce=Object(n.useCallback)((async e=>{const t=e.id,a=await O.current[N]();null!=(null==a?void 0:a.data)&&(J(N,a.data,a.isValid),oe(t))}),[N,oe,J]),ue=Object(n.useCallback)((e=>{e.preventDefault(),g(s.B,{deepLinkId:k.a.rules,path:Object(X.d)(null!=b?b:"")})}),[g,b]);return Object(n.useEffect)((()=>{null!=f&&f.immutable?R(SO.b.ruleActions):R(SO.b.defineRule)}),[f]),Object(kk.h)(r,o,l,d)?(g(s.B,{deepLinkId:k.a.alerts,path:Object(X.a)()}),null):Object(Js.c)(c)?i.a.createElement(i.a.Fragment,null,i.a.createElement(y.a,null,i.a.createElement(V.EuiFlexGroup,{direction:"row",justifyContent:"spaceAround"},i.a.createElement(kk.a,null,i.a.createElement(ta.a,{backOptions:{path:Object(X.d)(null!=b?b:""),text:`${jw} ${null!==(e=null==f?void 0:f.name)&&void 0!==e?e:""}`,pageId:k.a.rules,dataTestSubj:"ruleEditBackToRuleDetails"},isLoading:q,title:vw},T.data&&C.data&&F.data&&i.a.createElement(V.EuiButton,{iconType:"visBarVerticalStacked",onClick:()=>W((e=>!e))},uo.Dc)),L.length>0&&i.a.createElement(V.EuiCallOut,{title:Sw,color:"danger",iconType:"alert"},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rule.editRule.errorMsgDescription",defaultMessage:"You have an invalid input in {countError, plural, one {this tab} other {these tabs}}: {tabHasError}",values:{countError:L.length,tabHasError:L.map((e=>e===SO.b.aboutRule?uo.a:e===SO.b.defineRule?uo.sb:e===SO.b.scheduleRule?uo.Fc:e===SO.b.ruleActions?uo.Cc:e)).join(", ")}})),i.a.createElement(V.EuiTabbedContent,{initialSelectedTab:ie[0],selectedTab:ie.find((e=>e.id===N)),onTabClick:ce,tabs:ie}),i.a.createElement(V.EuiSpacer,null),i.a.createElement(V.EuiFlexGroup,{alignItems:"center",gutterSize:"s",justifyContent:"flexEnd",responsive:!1},i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiButton,{iconType:"cross",onClick:ue},xw)),i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiButton,{"data-test-subj":"ruleEditSubmitButton",fill:!0,onClick:se,iconType:"save",isLoading:q,isDisabled:v},kw))),Q&&T.data&&C.data&&F.data&&i.a.createElement(mw,{isDisabled:H,defineStepData:T.data,aboutStepData:C.data,scheduleStepData:F.data,exceptionsList:null==f?void 0:f.exceptions_list,onClose:ee})))),i.a.createElement(E.a,{pageName:k.a.rules,state:{ruleName:null==f?void 0:f.name}})):(g(s.B,{deepLinkId:k.a.rules,path:Object(X.d)(null!=b?b:"")}),null)},Iw=[{path:"/rules/id/:detailName/edit",main:Object(n.memo)(Tw),exact:!0},{path:`/rules/id/:detailName/:tabName(${po.b.alerts}|${po.b.exceptions}|${po.b.endpointExceptions}|${po.b.executionResults}|${po.b.executionEvents})`,main:po.c,exact:!0},{path:"/rules/create",main:hw,exact:!0},{path:"/rules",main:mO,exact:!0}],Cw=()=>(la(Yx),i.a.createElement(_,null,i.a.createElement(r.TrackApplicationView,{viewId:s.uc.rules},i.a.createElement(P.Switch,null,i.a.createElement(L.Route,{path:"/rules/id/:detailName",exact:!0,render:({match:{params:{detailName:e}},location:t})=>i.a.createElement(P.Redirect,{to:{...t,pathname:`/rules/id/${e}/${po.b.alerts}`,search:t.search}})}),Iw.map((e=>{var t;return i.a.createElement(L.Route,{key:`rules-route-${e.path}`,path:e.path,exact:null!==(t=null==e?void 0:e.exact)&&void 0!==t&&t},i.a.createElement(e.main,null))})),i.a.createElement(L.Route,{component:q.a}),i.a.createElement(E.a,{pageName:s.uc.rules}))))),Mw=i.a.memo(Cw),Fw=[{path:s.lc,render:()=>i.a.createElement(Mw,null)}];var Dw=a(897),Aw=a(242),_w=a(858),Nw=a(387),Rw=a(1108);const Pw=H.a.div.withConfig({displayName:"TimelinesContainer",componentId:"sc-13wjqgh-0"})(["width:100%;"]),Lw=()=>{const{tabName:e}=Object(P.useParams)(),[t,a]=Object(n.useState)(!1),r=Object(n.useCallback)((()=>{a(!0)}),[a]),{indicesExist:s}=Object(g.d)(),o=!!Object(p.k)().services.application.capabilities.siem.crud;return i.a.createElement(i.a.Fragment,null,s?i.a.createElement(i.a.Fragment,null,i.a.createElement(y.a,null,i.a.createElement(ta.a,{title:Rw.d},i.a.createElement(V.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},i.a.createElement(V.EuiFlexItem,null,o&&i.a.createElement(V.EuiButton,{iconType:"indexOpen",onClick:r,"data-test-subj":"open-import-data-modal-btn"},Rw.a)),e===u.n.default?i.a.createElement(V.EuiFlexItem,null,i.a.createElement(Nw.c,{timelineId:u.j.active,outline:!0,"data-test-subj":"create-default-btn"})):i.a.createElement(V.EuiFlexItem,null,i.a.createElement(_w.a,{outline:!0,title:Aw.g,"data-test-subj":"create-template-btn"})))),i.a.createElement(Pw,{"data-test-subj":"timelines-container"},i.a.createElement(Dw.a,{defaultPageSize:10,isModal:!1,importDataModalToggle:t&&o,setImportDataModalToggle:a,title:Rw.b,"data-test-subj":"stateful-open-timeline"})))):i.a.createElement(aa.a,null),i.a.createElement(E.a,{pageName:k.a.timelines}))},Bw=i.a.memo(Lw),qw=`${s.wc}/:tabName(${u.n.default}|${u.n.template})`,zw=`${s.wc}/${u.n.default}`,$w=i.a.memo((()=>i.a.createElement(P.Switch,null,i.a.createElement(L.Route,{exact:!0,path:qw},i.a.createElement(Bw,null)),i.a.createElement(L.Route,{path:s.wc,render:({location:{search:e=""}})=>i.a.createElement(P.Redirect,{to:`${zw}${Object(Nv.a)(e)}`})}))));$w.displayName="Timelines";const Vw=[{path:s.wc,component:()=>i.a.createElement(_,null,i.a.createElement(r.TrackApplicationView,{viewId:k.a.timelines},i.a.createElement($w,null)))}];var Uw=a(328),Hw=a(936);const Gw={timelineById:{},autoSavedWarningMsg:{timelineId:null,newTimelineModel:null},showCallOutUnauthorizedMsg:!1,insertTimeline:null},Qw=Object(Uw.reducerWithInitialState)(Gw).case(S.addTimeline,((e,{id:t,timeline:a,resolveTimelineConfig:n})=>({...e,timelineById:Object(Hw.e)({id:t,timeline:a,resolveTimelineConfig:n,timelineById:e.timelineById})}))).case(S.createTimeline,((e,{id:t,timelineType:a=u.n.default,...n})=>({...e,timelineById:Object(Hw.a)({id:t,timelineById:e.timelineById,timelineType:a,...n})}))).case(S.addNote,((e,{id:t,noteId:a})=>({...e,timelineById:Object(Hw.b)({id:t,noteId:a,timelineById:e.timelineById})}))).case(S.addNoteToEvent,((e,{id:t,noteId:a,eventId:n})=>({...e,timelineById:Object(Hw.c)({id:t,noteId:a,eventId:n,timelineById:e.timelineById})}))).case(S.addProvider,((e,{id:t,providers:a})=>({...e,timelineById:Object(Hw.d)({id:t,providers:a,timelineById:e.timelineById})}))).case(S.applyKqlFilterQuery,((e,{id:t,filterQuery:a})=>({...e,timelineById:Object(Hw.g)({id:t,filterQuery:a,timelineById:e.timelineById})}))).case(S.showTimeline,((e,{id:t,show:a})=>({...e,timelineById:Object(Hw.I)({id:t,show:a,timelineById:e.timelineById})}))).case(S.updateGraphEventId,((e,{id:t,graphEventId:a})=>({...e,timelineById:Object(Hw.w)({id:t,graphEventId:a,timelineById:e.timelineById})}))).case(S.updateSessionViewConfig,((e,{id:t,sessionViewConfig:a})=>({...e,timelineById:Object(Hw.H)({id:t,sessionViewConfig:a,timelineById:e.timelineById})}))).case(S.pinEvent,((e,{id:t,eventId:a})=>({...e,timelineById:Object(Hw.i)({id:t,eventId:a,timelineById:e.timelineById})}))).case(S.removeProvider,((e,{id:t,providerId:a,andProviderId:n})=>({...e,timelineById:Object(Hw.k)({id:t,providerId:a,timelineById:e.timelineById,andProviderId:n})}))).case(S.startTimelineSaving,((e,{id:t})=>({...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],isSaving:!0}}}))).case(S.endTimelineSaving,((e,{id:t})=>({...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],isSaving:!1}}}))).case(S.setExcludedRowRendererIds,((e,{id:t,excludedRowRendererIds:a})=>({...e,timelineById:Object(Hw.q)({id:t,excludedRowRendererIds:a,timelineById:e.timelineById})}))).case(S.updateTimeline,((e,{id:t,timeline:a})=>({...e,timelineById:{...e.timelineById,[t]:a}}))).case(S.unPinEvent,((e,{id:t,eventId:a})=>({...e,timelineById:Object(Hw.p)({id:t,eventId:a,timelineById:e.timelineById})}))).case(S.updateIsFavorite,((e,{id:t,isFavorite:a})=>({...e,timelineById:Object(Hw.x)({id:t,isFavorite:a,timelineById:e.timelineById})}))).case(S.updateKqlMode,((e,{id:t,kqlMode:a})=>({...e,timelineById:Object(Hw.z)({id:t,kqlMode:a,timelineById:e.timelineById})}))).case(S.updateTitleAndDescription,((e,{id:t,title:a,description:n})=>({...e,timelineById:Object(Hw.J)({id:t,title:a,description:n,timelineById:e.timelineById})}))).case(S.updateProviders,((e,{id:t,providers:a})=>({...e,timelineById:Object(Hw.F)({id:t,providers:a,timelineById:e.timelineById})}))).case(S.updateRange,((e,{id:t,start:a,end:n})=>({...e,timelineById:Object(Hw.G)({id:t,start:a,end:n,timelineById:e.timelineById})}))).case(S.updateDataProviderEnabled,((e,{id:t,enabled:a,providerId:n,andProviderId:i})=>({...e,timelineById:Object(Hw.B)({id:t,enabled:a,providerId:n,timelineById:e.timelineById,andProviderId:i})}))).case(S.updateDataProviderExcluded,((e,{id:t,excluded:a,providerId:n,andProviderId:i})=>({...e,timelineById:Object(Hw.C)({id:t,excluded:a,providerId:n,timelineById:e.timelineById,andProviderId:i})}))).case(S.dataProviderEdited,((e,{andProviderId:t,excluded:a,field:n,id:i,operator:r,providerId:s,value:o})=>({...e,timelineById:Object(Hw.D)({andProviderId:t,excluded:a,field:n,id:i,operator:r,providerId:s,timelineById:e.timelineById,value:o})}))).case(S.updateDataProviderType,((e,{id:t,type:a,providerId:n,andProviderId:i})=>({...e,timelineById:Object(Hw.E)({id:t,type:a,providerId:n,timelineById:e.timelineById,andProviderId:i})}))).case(S.updateAutoSaveMsg,((e,{timelineId:t,newTimelineModel:a})=>({...e,autoSavedWarningMsg:{timelineId:t,newTimelineModel:a}}))).case(S.showCallOutUnauthorizedMsg,(e=>({...e,showCallOutUnauthorizedMsg:!0}))).case(S.setSavedQueryId,((e,{id:t,savedQueryId:a})=>({...e,timelineById:Object(Hw.s)({id:t,savedQueryId:a,timelineById:e.timelineById})}))).case(S.setFilters,((e,{id:t,filters:a})=>({...e,timelineById:Object(Hw.r)({id:t,filters:a,timelineById:e.timelineById})}))).case(S.setInsertTimeline,((e,t)=>({...e,insertTimeline:t}))).case(S.updateDataView,((e,{id:t,dataViewId:a,indexNames:n})=>({...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],dataViewId:a,indexNames:n}}}))).case(S.setActiveTabTimeline,((e,{id:t,activeTab:a,scrollToTop:n})=>({...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],activeTab:a,prevActiveTab:e.timelineById[t].activeTab,scrollToTop:n?{timestamp:Math.floor(Date.now()/1e3)}:void 0}}}))).case(S.toggleModalSaveTimeline,((e,{id:t,showModalSaveTimeline:a})=>({...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],showSaveModal:a}}}))).case(S.updateEqlOptions,((e,{id:t,field:a,value:n})=>{var i;return{...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],eqlOptions:{...null!==(i=e.timelineById[t].eqlOptions)&&void 0!==i?i:{},[a]:n}}}}})).case(S.setTimelineUpdatedAt,((e,{id:t,updated:a})=>({...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],updated:a}}}))).case(S.toggleDetailPanel,((e,t)=>({...e,timelineById:{...e.timelineById,[t.id]:{...e.timelineById[t.id],expandedDetail:{...e.timelineById[t.id].expandedDetail,...Object(Hw.v)(t)}}}}))).case(S.setEventsLoading,((e,{id:t,eventIds:a,isLoading:n})=>({...e,timelineById:Object(Hw.n)({id:t,eventIds:a,timelineById:e.timelineById,isLoading:n})}))).case(S.removeColumn,((e,{id:t,columnId:a})=>({...e,timelineById:Object(Hw.j)({id:t,columnId:a,timelineById:e.timelineById})}))).case(S.upsertColumn,((e,{column:t,id:a,index:n})=>({...e,timelineById:Object(Hw.K)({column:t,id:a,index:n,timelineById:e.timelineById})}))).case(S.updateColumns,((e,{id:t,columns:a})=>({...e,timelineById:Object(Hw.t)({id:t,columns:a,timelineById:e.timelineById})}))).case(S.updateIsLoading,((e,{id:t,isLoading:a})=>({...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],isLoading:a}}}))).case(S.updateSort,((e,{id:t,sort:a})=>({...e,timelineById:Object(Hw.u)({id:t,sort:a,timelineById:e.timelineById})}))).case(S.setSelected,((e,{id:t,eventIds:a,isSelected:n,isSelectAllChecked:i})=>({...e,timelineById:Object(Hw.o)({id:t,eventIds:a,timelineById:e.timelineById,isSelected:n,isSelectAllChecked:i})}))).case(S.clearSelected,((e,{id:t})=>({...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],selectedEventIds:{},isSelectAllChecked:!1}}}))).case(S.setEventsDeleted,((e,{id:t,eventIds:a,isDeleted:n})=>({...e,timelineById:Object(Hw.l)({id:t,eventIds:a,timelineById:e.timelineById,isDeleted:n})}))).case(S.initializeTimelineSettings,((e,{id:t,...a})=>({...e,timelineById:Object(Hw.m)({id:t,timelineById:e.timelineById,timelineSettingsProps:a})}))).case(S.updateItemsPerPage,((e,{id:t,itemsPerPage:a})=>({...e,timelineById:Object(Hw.y)({id:t,itemsPerPage:a,timelineById:e.timelineById})}))).case(S.updateItemsPerPageOptions,((e,{id:t,itemsPerPageOptions:a})=>({...e,timelineById:Object(Hw.A)({id:t,itemsPerPageOptions:a,timelineById:e.timelineById})}))).case(S.applyDeltaToColumnWidth,((e,{id:t,columnId:a,delta:n})=>({...e,timelineById:Object(Hw.f)({id:t,columnId:a,delta:n,timelineById:e.timelineById})}))).case(S.clearEventsDeleted,((e,{id:t})=>({...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],deletedEventIds:[]}}}))).case(S.clearEventsLoading,((e,{id:t})=>({...e,timelineById:{...e.timelineById,[t]:{...e.timelineById[t],loadingEventIds:[]}}}))).build();var Ww=a(105),Kw=a(108),Yw=a(64),Jw=a(379),Xw=a(280),Zw=a(1118),eT=a(1121);const tT=z.i18n.translate("xpack.securitySolution.endpointDetails.overview",{defaultMessage:"Overview"}),aT={tabTitle:z.i18n.translate("xpack.securitySolution.endpointDetails.responseActionsHistory",{defaultMessage:"Response actions history"}),LogEntry:{endOfLog:z.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.action.endOfLog",{defaultMessage:"Nothing more to show"}),dateRangeMessage:z.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.dateRangeMessage.title",{defaultMessage:"Nothing to show for selected date range, please select another and try again."}),emptyState:{title:z.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.emptyState.title",{defaultMessage:"No logged actions"}),body:z.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.emptyState.body",{defaultMessage:"No actions have been logged for this endpoint."})},action:{isolatedAction:z.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.action.isolated",{defaultMessage:"submitted request: Isolate host"}),unisolatedAction:z.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.action.unisolated",{defaultMessage:"submitted request: Release host"}),failedEndpointReleaseAction:z.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.action.failedEndpointReleaseAction",{defaultMessage:"failed to submit request: Release host"}),failedEndpointIsolateAction:z.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.action.failedEndpointIsolateAction",{defaultMessage:"failed to submit request: Isolate host"})},response:{isolationCompletedAndSuccessful:z.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.response.isolationCompletedAndSuccessful",{defaultMessage:"Host isolation request completed by Endpoint"}),isolationCompletedAndUnsuccessful:z.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.response.isolationCompletedAndUnsuccessful",{defaultMessage:"Host isolation request completed by Endpoint with errors"}),unisolationCompletedAndSuccessful:z.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.response.unisolationCompletedAndSuccessful",{defaultMessage:"Release request completed by Endpoint"}),unisolationCompletedAndUnsuccessful:z.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.response.unisolationCompletedAndUnsuccessful",{defaultMessage:"Release request completed by Endpoint with errors"}),isolationSuccessful:z.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.response.isolationSuccessful",{defaultMessage:"Host isolation request received by Endpoint"}),isolationFailed:z.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.response.isolationFailed",{defaultMessage:"Host isolation request received by Endpoint with errors"}),unisolationSuccessful:z.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.response.unisolationSuccessful",{defaultMessage:"Release host request received by Endpoint"}),unisolationFailed:z.i18n.translate("xpack.securitySolution.endpointDetails.activityLog.logEntry.response.unisolationFailed",{defaultMessage:"Release host request received by Endpoint with errors"})}}};var nT=a(393);const iT=i.a.memo((()=>{const e=Object(Jw.b)(Xw.detailsData),t=Object(Jw.a)(e),[a,r]=Object(n.useState)(!1),s=Object(n.useCallback)((()=>{r(!1)}),[]),o=Object(n.useMemo)((()=>t.map((e=>i.a.createElement(nT.a,lr()({},e,{onClick:t=>{s(),e.onClick&&e.onClick(t)}}))))),[s,t]),l=Object(n.useMemo)((()=>i.a.createElement(V.EuiButton,{iconSide:"right",fill:!0,iconType:"arrowDown","data-test-subj":"endpointDetailsActionsButton",onClick:()=>{r(!a)}},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.endpoint.detailsActions.buttonLabel",defaultMessage:"Take action"}))),[a]);return i.a.createElement(V.EuiPopover,{id:"endpointDetailsActionsPanel",button:l,isOpen:a,closePopover:s,panelPaddingSize:"none",anchorPosition:"downLeft","data-test-subj":"endpointDetailsActionsPopover"},i.a.createElement(V.EuiContextMenuPanel,{size:"s",items:o}))}));iT.displayName="ActionMenu";var rT=a(1085),sT=a(246);const oT=Object(n.memo)((({hostMeta:e})=>{const t=Object(P.useHistory)(),a=Object(o.useDispatch)(),{show:r,...s}=Object(Jw.b)(Xw.uiQueryParams),l=Object(Jw.b)(Xw.getIsEndpointHostIsolated),c=Object(Jw.b)(Xw.getIsIsolationRequestPending),u=Object(Jw.b)(Xw.getWasIsolationRequestSuccessful),d=Object(Jw.b)(Xw.getIsolationRequestError),[p,m]=Object(n.useState)({comment:""}),g=l?sT.e:sT.c,b=Object(n.useCallback)((()=>{t.push(Object(h.d)({name:"endpointDetails",...s,selected_endpoint:e.agent.id}))}),[t,e.agent.id,s]),f=Object(n.useCallback)((()=>{a({type:"endpointIsolationRequest",payload:{type:l?"unisolate":"isolate",data:{endpoint_ids:[e.agent.id],comment:p.comment}}})}),[a,p.comment,e.agent.id,l]),y=Object(n.useCallback)((e=>{m((t=>({...t,...e})))}),[]);return i.a.createElement(i.a.Fragment,null,u&&i.a.createElement(sT.d,{hostName:e.host.name,isolateAction:l?"unisolateHost":"isolateHost"}),i.a.createElement(V.EuiFlyoutBody,null,u?i.a.createElement(sT.a,{onClick:b,buttonText:z.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.successProceedButton",{defaultMessage:"Return to endpoint details"})}):i.a.createElement(V.EuiForm,{isInvalid:!!d,error:null==d?void 0:d.message,"data-test-subj":"endpointIsolationForm"},i.a.createElement(g,{comment:p.comment,isLoading:c,hostName:e.host.name,onCancel:b,onConfirm:f,onChange:y}))))}));oT.displayName="EndpointIsolateFlyoutPanel";var lT=a(1092);const cT=(e,t)=>!(!t||!e.id||e.id===t.endpoint.id&&t.agent.configured.id===t.agent.applied.id&&e.version>=t.agent.applied.revision&&e.version>=t.agent.configured.revision&&e.endpoint_policy_version>=t.endpoint.revision);var uT=a(1083),dT=a(581);const pT=Object(n.memo)((({policyId:e,backLink:t,children:a,missingPolicies:r={},...s})=>{const{getAppUrl:o}=Object(Hc.b)(),{toRoutePath:l,toRouteUrl:c}=Object(n.useMemo)((()=>{const a=e?Object(h.j)(e):"";return{toRoutePath:t?{pathname:a,state:{backLink:t}}:a,toRouteUrl:o({path:a})}}),[e,o,t]),u=Object(dT.a)(l);return!e||r[e]?i.a.createElement("span",{className:s.className,"data-test-subj":s["data-test-subj"]},a,i.a.createElement(V.EuiText,{color:"subdued",size:"xs",className:"eui-textNoWrap"},i.a.createElement(V.EuiIcon,{size:"m",type:"alert",color:"warning"})," ",i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyNotFound",defaultMessage:"Policy not found!"}))):i.a.createElement(V.EuiLink,lr()({href:c,onClick:u},s),a)}));pT.displayName="EndpointPolicyLink";const mT=i.a.memo((({style:e,...t})=>i.a.createElement(V.EuiText,lr()({color:"subdued",size:"xs",className:"eui-textNoWrap eui-displayInlineBlock",style:e},t),i.a.createElement(V.EuiIcon,{className:"eui-alignTop",size:"m",type:"alert",color:"warning"}),i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.outOfDateLabel",defaultMessage:"Out-of-date"}))));mT.displayName="OutOfDate";var gT=a(638);const bT=H()(V.EuiFlexGroup).withConfig({displayName:"EuiFlexGroupStyled",componentId:"sc-4x4obe-0"})([".isolation-status{margin-left:",";}"],(({theme:e})=>e.eui.euiSizeS)),fT=Object(n.memo)((({endpointMetadata:e,hostStatus:t})=>{const a=Object(Jw.b)(Xw.getEndpointHostIsolationStatusPropsCallback);return i.a.createElement(bT,{gutterSize:"none",responsive:!1,className:"eui-textTruncate"},i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(gT.a,{hostStatus:t})),i.a.createElement(V.EuiFlexItem,{grow:!1,className:"eui-textTruncate isolation-status"},i.a.createElement(sT.b,lr()({"data-test-subj":"rowIsolationStatus"},a(e)))))}));fT.displayName="EndpointAgentStatus";const yT=H.a.div.withConfig({displayName:"EndpointDetailsContentStyled",componentId:"sc-2wf17-0"})(["dl dt{max-width:27%;}dl dd{max-width:73%;}.policyLineText{padding-right:5px;}"]),hT=({children:e})=>i.a.createElement(V.EuiText,{size:"s"},i.a.createElement("h5",null,e)),ET=Object(n.memo)((({details:e,policyInfo:t,hostStatus:a})=>{const r=Object(Jw.b)(Xw.uiQueryParams),s=Object(Jw.b)(Xw.policyResponseStatus),o=Object(Jw.b)(Xw.nonExistingPolicies),l=Object(n.useMemo)((()=>{const{selected_endpoint:t,show:a,...n}=r;return Object(h.d)({name:"endpointPolicyResponse",...n,selected_endpoint:e.agent.id})}),[e.agent.id,r]),c=Object(dT.a)(l),u=Object(n.useMemo)((()=>[{title:i.a.createElement(hT,null,i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.endpoint.details.os",defaultMessage:"OS"})),description:i.a.createElement(V.EuiText,{size:"xs"},e.host.os.full)},{title:i.a.createElement(hT,null,i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.endpoint.details.agentStatus",defaultMessage:"Agent Status"})),description:i.a.createElement(fT,{hostStatus:a,endpointMetadata:e})},{title:i.a.createElement(hT,null,i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.endpoint.details.lastSeen",defaultMessage:"Last Seen"})),description:i.a.createElement(V.EuiText,{size:"xs"},i.a.createElement(xa.a,{value:e["@timestamp"],fieldName:""}))},{title:i.a.createElement(hT,null,i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.endpoint.details.policy",defaultMessage:"Policy"})),description:i.a.createElement(V.EuiText,{size:"xs",className:"eui-textBreakWord"},i.a.createElement(pT,{policyId:e.Endpoint.policy.applied.id,"data-test-subj":"policyDetailsValue",className:"policyLineText",missingPolicies:o},e.Endpoint.policy.applied.name),e.Endpoint.policy.applied.endpoint_policy_version&&i.a.createElement(V.EuiText,{color:"subdued",size:"xs",className:"eui-displayInlineBlock eui-textNoWrap policyLineText","data-test-subj":"policyDetailsRevNo"},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.endpoint.details.policy.revisionNumber",defaultMessage:"rev. {revNumber}",values:{revNumber:e.Endpoint.policy.applied.endpoint_policy_version}})),cT(e.Endpoint.policy.applied,t)&&i.a.createElement(mT,null))},{title:i.a.createElement(hT,null,i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.endpoint.details.policyStatus",defaultMessage:"Policy Status"})),description:i.a.createElement(V.EuiHealth,{"data-test-subj":`policyStatusValue-${s}`,color:uT.b[s]||"default"},i.a.createElement(V.EuiLink,{onClick:c,"data-test-subj":"policyStatusValue"},i.a.createElement(V.EuiText,{size:"xs"},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.endpoint.details.policyStatusValue",defaultMessage:"{policyStatus, select, success {Success} warning {Warning} failure {Failed} other {Unknown}}",values:{policyStatus:s}}))))},{title:i.a.createElement(hT,null,i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.endpoint.details.endpointVersion",defaultMessage:"Endpoint Version"})),description:i.a.createElement(V.EuiText,{size:"xs"},e.agent.version)},{title:i.a.createElement(hT,null,i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.endpoint.details.ipAddress",defaultMessage:"IP Address"})),description:i.a.createElement(V.EuiFlexGroup,{direction:"column",gutterSize:"s"},e.host.ip.map(((e,t)=>i.a.createElement(V.EuiFlexItem,{key:t},i.a.createElement(V.EuiText,{size:"xs"},e)))))}]),[e,a,s,c,t,o]);return i.a.createElement(yT,null,i.a.createElement(V.EuiSpacer,{size:"s"}),i.a.createElement(V.EuiDescriptionList,{compressed:!0,type:"column",listItems:u,"data-test-subj":"endpointDetailsList"}))}));ET.displayName="EndpointDetailsContent";const vT=Object(n.memo)((()=>{var e;const t=Object(p.o)(),a=Object(Jw.b)(Xw.uiQueryParams),r=Object(Jw.b)(Xw.detailsData),s=Object(Jw.b)(Xw.detailsError),o=Object(Jw.b)(Xw.policyVersionInfo),l=Object(Jw.b)(Xw.hostStatusInfo),c=Object(Jw.b)(Xw.showView),{canAccessEndpointActionsLogManagement:u}=Object(pd.a)().endpointPrivileges,d=Object(n.useMemo)((()=>i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiLoadingContent,{lines:3}),i.a.createElement(V.EuiSpacer,{size:"l"}),i.a.createElement(V.EuiLoadingContent,{lines:3}))),[]),m=Object(n.useCallback)((e=>{const t=[{id:rT.b.overview,name:tT,route:Object(h.d)({...a,name:"endpointDetails",selected_endpoint:e}),content:void 0===r?d:i.a.createElement(ET,{details:r,policyInfo:o,hostStatus:l})}];return u&&t.push({id:rT.b.activityLog,name:aT.tabTitle,route:Object(h.d)({...a,name:"endpointActivityLog",selected_endpoint:e}),content:i.a.createElement(Zw.a,{agentIds:e})}),t}),[u,d,r,o,l,a]),g="details"===c||"policy_response"===c||"activity_log"===c;return Object(n.useEffect)((()=>{void 0!==s&&t.addDanger({title:z.i18n.translate("xpack.securitySolution.endpoint.details.errorTitle",{defaultMessage:"Could not find host"}),text:z.i18n.translate("xpack.securitySolution.endpoint.details.errorBody",{defaultMessage:"Please exit the flyout and select an available host."})})}),[s,c,t]),i.a.createElement(i.a.Fragment,null,("policy_response"===c||"isolate"===c||"unisolate"===c)&&i.a.createElement(lT.a,{hasBorder:!0,endpointId:null==r?void 0:r.agent.id,hostname:null==r||null===(e=r.host)||void 0===e?void 0:e.hostname}),void 0===r?i.a.createElement(V.EuiFlyoutBody,null,i.a.createElement(V.EuiLoadingContent,{lines:3})," ",i.a.createElement(V.EuiSpacer,{size:"l"})," ",i.a.createElement(V.EuiLoadingContent,{lines:3})):i.a.createElement(i.a.Fragment,null,("details"===c||"activity_log"===c)&&i.a.createElement(rT.a,{hostname:r.host.hostname,show:u?c:"details",tabs:m(r.agent.id)}),"policy_response"===c&&i.a.createElement(xT,{hostMeta:r}),("isolate"===c||"unisolate"===c)&&i.a.createElement(oT,{hostMeta:r}),g&&i.a.createElement(V.EuiFlyoutFooter,{className:"eui-textRight","data-test-subj":"endpointDetailsFlyoutFooter"},i.a.createElement(iT,null))))}));vT.displayName="EndpointDetails";const xT=Object(n.memo)((({hostMeta:e})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiFlyoutBody,{"data-test-subj":"endpointDetailsPolicyResponseFlyoutBody",className:"endpointDetailsPolicyResponseFlyoutBody"},i.a.createElement(eT.a,{endpointId:e.agent.id})))));xT.displayName="PolicyResponseFlyoutPanel";const kT=Object(n.memo)((()=>{const e=Object(P.useHistory)(),t=Object(Jw.b)(Xw.uiQueryParams),{selected_endpoint:a,...r}=t,s=Object(n.useCallback)((()=>{const{show:t,...a}=r;e.push(Object(h.e)({name:"endpointList",...a}))}),[e,r]);return i.a.createElement(V.EuiFlyout,{onClose:s,"data-test-subj":"endpointDetailsFlyout",size:"m",paddingSize:"l",ownFocus:!1},i.a.createElement(vT,null))}));kT.displayName="EndpointDetailsFlyout";var ST=a(1265),jT=a.n(ST);const OT=Object.freeze({textAlign:"center"}),wT=Object.freeze({maxWidth:550,maxHeight:420}),TT=i.a.memo((({loading:e,onActionClick:t,actionDisabled:a,policyEntryPoint:n=!1})=>{const r=Object(p.k)().services.docLinks;return i.a.createElement("div",{"data-test-subj":"emptyPolicyTable"},e?i.a.createElement(V.EuiFlexGroup,{alignItems:"center",justifyContent:"center"},i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiLoadingSpinner,{size:"xl",className:"essentialAnimation"}))):i.a.createElement(V.EuiFlexGroup,{"data-test-subj":"policyOnboardingInstructions",alignItems:"center"},i.a.createElement(V.EuiFlexItem,{grow:1},i.a.createElement(V.EuiText,null,i.a.createElement("h1",null,i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyList.onboardingTitle",defaultMessage:"Get started with Elastic Defend"}))),i.a.createElement(V.EuiSpacer,{size:"m"}),i.a.createElement(V.EuiText,{size:"s",color:"subdued"},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyList.onboardingSectionOne",defaultMessage:"Protect your hosts with threat prevention, detection, and deep security data visibility."})),i.a.createElement(V.EuiSpacer,{size:"m"}),i.a.createElement(V.EuiText,{size:"s",color:"subdued"},n?i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyList.onboardingSectionTwo.fromPolicyPage",defaultMessage:"From this page, you’ll be able to view and manage the Elastic Defend Integration policies in your environment running Elastic Defend."}):i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyList.onboardingSectionTwo.fromEndpointPage",defaultMessage:"From this page, you’ll be able to view and manage the hosts in your environment running Elastic Defend."})),i.a.createElement(V.EuiSpacer,{size:"m"}),i.a.createElement(V.EuiText,{size:"s",color:"subdued"},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyList.onboardingSectionThree",defaultMessage:"To get started, add the Elastic Defend integration to your Agents. For more information, "}),i.a.createElement(V.EuiLink,{external:!0,href:`${r.links.siem.guide}`},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyList.onboardingDocsLink",defaultMessage:"view the Elastic Security documentation"}))),i.a.createElement(V.EuiSpacer,{size:"l"}),i.a.createElement(V.EuiFlexGroup,null,i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiButton,{fill:!0,iconType:"plusInCircle",onClick:t,isDisabled:a,"data-test-subj":"onboardingStartButton"},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyList.actionButtonText",defaultMessage:"Add Elastic Defend"}))))),i.a.createElement(V.EuiFlexItem,{grow:2},i.a.createElement(V.EuiIcon,{type:jT.a,size:"original",style:wT}))))})),IT=i.a.memo((({loading:e,onActionClick:t,actionDisabled:a,handleSelectableOnChange:r,selectionOptions:s})=>{const o=Object(n.useMemo)((()=>[{title:z.i18n.translate("xpack.securitySolution.endpoint.list.stepOneTitle",{defaultMessage:"Select the integration you want to use"}),children:i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiText,{color:"subdued",size:"m",grow:!1},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.stepOne",defaultMessage:"Select from existing integrations. This can be changed later."})),i.a.createElement(V.EuiSpacer,{size:"xxl"}),i.a.createElement(V.EuiSelectable,{options:s,singleSelection:"always",isLoading:e,height:100,listProps:{bordered:!0,singleSelection:!0},onChange:r,"data-test-subj":"onboardingPolicySelect"},(t=>e?i.a.createElement(V.EuiSelectableMessage,null,i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.loadingPolicies",defaultMessage:"Loading integrations"})):s.length?t:i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.noPolicies",defaultMessage:"There are no integrations."}))))},{title:z.i18n.translate("xpack.securitySolution.endpoint.list.stepTwoTitle",{defaultMessage:"Enroll your agents enabled with Elastic Defend through Fleet"}),status:a?"disabled":"",children:i.a.createElement(V.EuiFlexGroup,{alignItems:"center"},i.a.createElement(V.EuiFlexItem,null,i.a.createElement(V.EuiText,{color:"subdued",size:"m",grow:!1},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.stepTwo",defaultMessage:"You’ll be provided with the necessary commands to get started."}))),i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiButton,{fill:!0,onClick:t,isDisabled:a,"data-test-subj":"onboardingStartButton"},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyList.emptyCreateNewButton",defaultMessage:"Enroll Agent"}))))}]),[s,r,e,a,t]);return i.a.createElement(CT,{loading:e,dataTestSubj:"emptyHostsTable",steps:o,headerComponent:i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.noEndpointsPrompt",defaultMessage:"Next step: Enroll an Agent with Elastic Defend"}),bodyComponent:i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.noEndpointsInstructions",defaultMessage:"You’ve added the Elastic Defend integration. Now enroll your agents using the steps below."})})})),CT=i.a.memo((({loading:e,dataTestSubj:t,steps:a,headerComponent:n,bodyComponent:r})=>i.a.createElement("div",{"data-test-subj":t},e?i.a.createElement(V.EuiFlexGroup,{alignItems:"center",justifyContent:"center"},i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiLoadingSpinner,{size:"xl",className:"essentialAnimation"}))):i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiSpacer,{size:"xxl"}),i.a.createElement(V.EuiTitle,{size:"m"},i.a.createElement("h2",{style:OT},n)),i.a.createElement(V.EuiSpacer,{size:"xxl"}),i.a.createElement(V.EuiText,{textAlign:"center",color:"subdued",size:"m"},r),i.a.createElement(V.EuiSpacer,{size:"xxl"}),a&&i.a.createElement(V.EuiFlexGroup,{alignItems:"center",justifyContent:"center"},i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiSteps,{steps:a,"data-test-subj":"onboardingSteps"})))))));TT.displayName="PolicyEmptyState",IT.displayName="HostsEmptyState",CT.displayName="ManagementEmptyState";var MT=a(60),FT=a(271),DT=a.n(FT),AT=a(252);const _T=Object(n.memo)((()=>{const e=Object(P.useHistory)(),{admin_query:t,...a}=Object(Jw.b)(Xw.uiQueryParams),r=Object(Jw.b)(Xw.patterns),s=Object(Jw.b)(Xw.searchBarQuery),o=Object(n.useMemo)((()=>r.map((e=>{return t=e,Object(AT.all)([t]);var t}))),[r]),l=Object(n.useCallback)((t=>{var n,i;e.push(function(e){return{search:DT.a.stringify(e)}}({...a,page_index:(null===(n=t.query)||void 0===n?void 0:n.query)===s.query?a.page_index:"0",...null!==(i=t.query)&&void 0!==i&&i.query.trim()?{admin_query:Object(Ed.encode)(t.query)}:{}}))}),[e,a,s.query]),c=Object(n.useMemo)((()=>new tE.TimeHistory(new hd.Storage(localStorage))),[]);return i.a.createElement("div",null,r&&r.length>0&&i.a.createElement("div",null,i.a.createElement(MT.SearchBar,{dataTestSubj:"adminSearchBar",query:s,indexPatterns:o,timeHistory:c,onQuerySubmit:l,fillSubmitButton:!0,isLoading:!1,iconType:"search",showFilterBar:!1,showDatePicker:!1,showQueryInput:!0})))}));_T.displayName="AdminSearchBar";var NT=a(574),RT=a(323);const PT=Object(n.memo)((({endpointMetadata:e})=>{const[t,a]=Object(n.useState)(!1),r=Object(Jw.a)(e,{isEndpointList:!0}),s=Object(n.useCallback)((()=>a(!1)),[a]),o=Object(n.useCallback)((()=>a(!t)),[t]),l=Object(n.useMemo)((()=>r.map((e=>i.a.createElement(nT.a,lr()({},e,{onClick:t=>{s(),e.onClick&&e.onClick(t)}}))))),[s,r]),c=Object(n.useMemo)((()=>({"data-test-subj":"tableRowActionsMenuPanel"})),[]);return i.a.createElement(V.EuiPopover,{anchorPosition:"downRight",panelPaddingSize:"none",panelProps:c,button:i.a.createElement(V.EuiButtonIcon,{"data-test-subj":"endpointTableRowActions",iconType:"boxesHorizontal",onClick:o,"aria-label":z.i18n.translate("xpack.securitySolution.endpoint.list.actionmenu",{defaultMessage:"Open"})}),isOpen:t,closePopover:s},i.a.createElement(V.EuiContextMenuPanel,{items:l}))}));PT.displayName="EndpointTableRowActions";var LT=a(226),BT=a(537),qT=a(647);const zT=H.a.div.withConfig({displayName:"StyledDatePicker",componentId:"sc-1m5xywg-0"})([".euiFormControlLayout--group{background-color:rgba(0,119,204,0.2);}.euiDatePickerRange--readOnly{background-color:",";}"],(e=>e.theme.eui.euiFormBackgroundColor)),$T=Object(n.memo)((({name:e,href:t,route:a,dataTestSubj:n})=>{const r=Object(dT.a)(a);return i.a.createElement(V.EuiLink,{"data-test-subj":n,className:"eui-displayInline eui-textTruncate",href:t,onClick:r},e)}));$T.displayName="EndpointListNavLink";const VT=Object(Kw.createStructuredSelector)(Xw),UT=()=>{var e,t;const a=Object(P.useHistory)(),{services:r}=Object(L.useKibana)(),{listData:l,pageIndex:c,pageSize:u,totalHits:p,listLoading:m,listError:g,uiQueryParams:b,hasSelectedEndpoint:f,policyItems:y,selectedPolicyId:E,policyItemsLoading:v,endpointPackageVersion:x,endpointsExist:S,autoRefreshInterval:j,isAutoRefreshEnabled:O,patternsError:w,areEndpointsEnrolling:T,agentsWithEndpointsTotalError:I,endpointsTotalError:C,metadataTransformStats:M}=Object(Jw.b)(VT),{search:F}=Object(d.n)(k.a.administration),{search:D}=Object(P.useLocation)(),{getAppUrl:A}=Object(Hc.b)(),_=Object(o.useDispatch)(),N=p>9999?9999:p,[R,B]=Object(n.useState)(!1),[q,$]=Object(n.useState)(!0),{state:U={}}=Object(P.useLocation)(),H=Object(n.useMemo)((()=>{if(null!=U&&U.backLink)return{onBackButtonNavigateTo:U.backLink.navigateTo,backButtonLabel:U.backLink.label,backButtonUrl:U.backLink.href};const e=Object(h.h)();return{backButtonLabel:z.i18n.translate("xpack.securitySolution.endpoint.list.backToPolicyButton",{defaultMessage:"Back to policy list"}),backButtonUrl:A({path:e}),onBackButtonNavigateTo:[s.B,{path:e}]}}),[A,null==U?void 0:U.backLink]),G=i.a.createElement(BT.a,lr()({},H,{"data-test-subj":"endpointListBackLink"}));Object(n.useEffect)((()=>{q&&y&&y.length&&(_({type:"loadMetadataTransformStats"}),$(!1))}),[y,q,_]),Object(n.useEffect)((()=>{const e=M.some((e=>s.Hc.has(null==e?void 0:e.state)));B(e)}),[M]);const Q=Object(n.useCallback)((()=>{B(!1)}),[]),W=Object(n.useMemo)((()=>({pageIndex:c,pageSize:u,totalItemCount:N,pageSizeOptions:[...Ww.f],showPerPageOptions:!0})),[c,u,N]),K=Object(n.useCallback)((({page:e})=>{const{index:t,size:n}=e;a.push(Object(h.e)({name:"endpointList",...b,page_index:JSON.stringify(t),page_size:JSON.stringify(n)}))}),[a,b]),Y=Object(Yh.a)("fleet",{path:`/integrations/${x?`/endpoint-${x}`:""}/add-integration`,state:{onCancelNavigateTo:[s.B,{path:Object(h.e)({name:"endpointList"})}],onCancelUrl:A({path:Object(h.e)({name:"endpointList"})}),onSaveNavigateTo:[s.B,{path:Object(h.e)({name:"endpointList"})}]}}),J=Object(n.useMemo)((()=>{const e=Object(h.e)({name:"endpointList"},D);return{navigateTo:[s.B,{path:e}],label:z.i18n.translate("xpack.securitySolution.endpoint.policy.details.backToListTitle",{defaultMessage:"View all endpoints"}),href:A({path:e})}}),[A,D]),X=Object(n.useCallback)((()=>{_({type:"appRequestedEndpointList"})}),[_]),Z=Object(n.useCallback)((e=>{_({type:"userUpdatedEndpointListRefreshOptions",payload:{isAutoRefreshEnabled:!e.isPaused,autoRefreshInterval:e.refreshInterval}})}),[_]),ee=Object(n.useCallback)((()=>{}),[]),te=Object(n.useMemo)((()=>({paddingLeft:"6px"})),[]),ae=Object(Yh.a)("fleet",{path:`/policies/${E}?openEnrollmentFlyout=true`,state:{onDoneNavigateTo:[s.B,{path:Object(h.e)({name:"endpointList"})}]}}),ne=Object(n.useMemo)((()=>y.map((e=>({key:e.policy_id,label:e.name,checked:E===e.policy_id?"on":void 0})))),[y,E]),ie=Object(n.useCallback)((e=>e.some((e=>"checked"in e&&"on"===e.checked&&(_({type:"userSelectedEndpointPolicy",payload:{selectedPolicyId:e.key}}),!0)))),[_]),re=Object(n.useCallback)((e=>({"data-endpoint-id":e.metadata.agent.id})),[]),se=Object(n.useMemo)((()=>{const e=z.i18n.translate("xpack.securitySolution.endpoint.list.lastActive",{defaultMessage:"Last active"});return[{field:"metadata",width:"15%",name:z.i18n.translate("xpack.securitySolution.endpoint.list.hostname",{defaultMessage:"Endpoint"}),render:({host:{hostname:e},agent:{id:t}})=>{const a=Object(h.d)({...b,name:"endpointDetails",selected_endpoint:t},F),n=A({path:a});return i.a.createElement(V.EuiToolTip,{content:e,anchorClassName:"eui-textTruncate"},i.a.createElement($T,{name:e,href:n,route:a,dataTestSubj:"hostnameCellLink"}))}},{field:"host_status",width:"14%",name:z.i18n.translate("xpack.securitySolution.endpoint.list.hostStatus",{defaultMessage:"Agent status"}),render:(e,t)=>i.a.createElement(fT,{hostStatus:e,endpointMetadata:t.metadata})},{field:"metadata.Endpoint.policy.applied",width:"15%",name:z.i18n.translate("xpack.securitySolution.endpoint.list.policy",{defaultMessage:"Policy"}),truncateText:!0,render:(e,t)=>i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiToolTip,{content:e.name,anchorClassName:"eui-textTruncate"},i.a.createElement(pT,{policyId:e.id,className:"eui-textTruncate","data-test-subj":"policyNameCellLink",backLink:J},e.name)),e.endpoint_policy_version&&i.a.createElement(V.EuiText,{color:"subdued",size:"xs",style:{whiteSpace:"nowrap",...te},className:"eui-textTruncate","data-test-subj":"policyListRevNo"},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.policy.revisionNumber",defaultMessage:"rev. {revNumber}",values:{revNumber:e.endpoint_policy_version}})),cT(e,t.policy_info)&&i.a.createElement(mT,{style:te,"data-test-subj":"rowPolicyOutOfDate"}))},{field:"metadata.Endpoint.policy.applied",width:"9%",name:z.i18n.translate("xpack.securitySolution.endpoint.list.policyStatus",{defaultMessage:"Policy status"}),render:(e,t)=>{const a=Object(h.d)({name:"endpointPolicyResponse",...b,selected_endpoint:t.metadata.agent.id}),n=A({path:a});return i.a.createElement(V.EuiToolTip,{content:uT.d[e.status],anchorClassName:"eui-textTruncate"},i.a.createElement(V.EuiHealth,{color:uT.c[e.status],className:"eui-textTruncate eui-fullWidth","data-test-subj":"rowPolicyStatus"},i.a.createElement($T,{name:uT.d[e.status],href:n,route:a,dataTestSubj:"policyStatusCellLink"})))}},{field:"metadata.host.os.name",width:"9%",name:z.i18n.translate("xpack.securitySolution.endpoint.list.os",{defaultMessage:"OS"}),render:e=>i.a.createElement(V.EuiToolTip,{content:e,anchorClassName:"eui-textTruncate"},i.a.createElement(V.EuiText,{size:"s",className:"eui-textTruncate eui-fullWidth"},i.a.createElement("p",{className:"eui-displayInline eui-TextTruncate"},e)))},{field:"metadata.host.ip",width:"12%",name:z.i18n.translate("xpack.securitySolution.endpoint.list.ip",{defaultMessage:"IP address"}),render:e=>i.a.createElement(V.EuiToolTip,{content:e.toString().replace(",",", "),anchorClassName:"eui-textTruncate"},i.a.createElement(V.EuiText,{size:"s",className:"eui-textTruncate eui-fullWidth"},i.a.createElement("p",{className:"eui-displayInline eui-textTruncate"},e.toString().replace(",",", "))))},{field:"metadata.agent.version",width:"9%",name:z.i18n.translate("xpack.securitySolution.endpoint.list.endpointVersion",{defaultMessage:"Version"}),render:e=>i.a.createElement(V.EuiToolTip,{content:e,anchorClassName:"eui-textTruncate"},i.a.createElement(V.EuiText,{size:"s",className:"eui-textTruncate eui-fullWidth"},i.a.createElement("p",{className:"eui-displayInline eui-TextTruncate"},e)))},{field:"metadata.@timestamp",name:e,width:"9%",render:t=>i.a.createElement(xa.a,{fieldName:e,value:t,className:"eui-textTruncate"})},{field:"",width:"8%",name:z.i18n.translate("xpack.securitySolution.endpoint.list.actions",{defaultMessage:"Actions"}),actions:[{render:e=>i.a.createElement(PT,{endpointMetadata:e.metadata})}]}]}),[b,F,A,J,te]),oe=Object(n.useMemo)((()=>S||T?i.a.createElement(V.EuiBasicTable,{"data-test-subj":"endpointListTable",items:[...l],columns:se,error:null==g?void 0:g.message,pagination:W,onChange:K,loading:m,rowProps:re}):!v&&y&&y.length>0?i.a.createElement(IT,{loading:m,onActionClick:ae,actionDisabled:void 0===E,handleSelectableOnChange:ie,selectionOptions:ne}):i.a.createElement(qT.a,null,i.a.createElement(TT,{loading:v,onActionClick:Y}))),[S,T,v,y,l,se,null==g?void 0:g.message,W,K,m,re,ae,E,ie,ne,Y]),le=l&&l.length>0,ce=Object(n.useMemo)((()=>({display:S?"flex":"none",maxWidth:200})),[S]),ue=Object(n.useMemo)((()=>!(!S||!f&&O)),[S,f,O]),de=Object(n.useMemo)((()=>S?j:Ww.a),[S,j]),pe=Object(n.useMemo)((()=>!(!C&&!I)),[C,I]),me=Object(n.useMemo)((()=>S&&!w),[S,w]),ge=Object(n.useMemo)((()=>{var e;const t=M.filter((e=>s.Hc.has(e.state))).map((e=>e.id)).join(", ");return i.a.createElement(i.a.Fragment,null,i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.transformFailed.message",defaultMessage:"A required transform, {transformId}, is currently failing. Most of the time this can be fixed by {transformsPage}. For additional help, please visit the {docsPage}",values:{transformId:t||LT.s,transformsPage:i.a.createElement(RT.a,{"data-test-subj":"failed-transform-restart-link",appId:"management",appPath:"/data/transform"},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.transformFailed.restartLink",defaultMessage:"restarting the transform"})),docsPage:i.a.createElement(V.EuiLink,{"data-test-subj":"failed-transform-docs-link",href:null==r||null===(e=r.docLinks)||void 0===e?void 0:e.links.endpoints.troubleshooting,target:"_blank"},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.transformFailed.docsLink",defaultMessage:"troubleshooting documentation"}))}}),i.a.createElement(V.EuiSpacer,{size:"s"}))}),[M,null==r||null===(e=r.docLinks)||void 0===e?void 0:e.links.endpoints.troubleshooting]),be=Object(n.useMemo)((()=>{if(R)return i.a.createElement(i.a.Fragment,null,i.a.createElement(Xx.a,{message:{id:"endpoints-list-transform-failed",type:"warning",title:z.i18n.translate("xpack.securitySolution.endpoint.list.transformFailed.title",{defaultMessage:"Required transform failed"}),description:ge},dismissButtonText:z.i18n.translate("xpack.securitySolution.endpoint.list.transformFailed.dismiss",{defaultMessage:"Dismiss"}),onDismiss:Q,showDismissButton:!0}),i.a.createElement(V.EuiSpacer,{size:"m"}))}),[R,Q,ge]);return i.a.createElement(NT.a,{"data-test-subj":"endpointPage",hideHeader:!(S||T),title:i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.pageTitle",defaultMessage:"Endpoints"}),subtitle:i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.pageSubTitle",defaultMessage:"Hosts running Elastic Defend"}),headerBackComponent:U.backLink&&G},f&&i.a.createElement(kT,null),i.a.createElement(i.a.Fragment,null,T&&!pe&&i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiCallOut,{size:"s","data-test-subj":"endpointsEnrollingNotification"},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.endpointsEnrolling",defaultMessage:"Endpoints are enrolling. {agentsLink} to track progress.",values:{agentsLink:i.a.createElement(RT.a,{appId:"fleet",appPath:`#${Yw.pagePathGetters.agent_list({kuery:'packages : "endpoint"'})}`,href:`${null==r||null===(t=r.application)||void 0===t?void 0:t.getUrlForApp("fleet")}#${Yw.pagePathGetters.agent_list({kuery:'packages : "endpoint"'})}`},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.endpointsEnrolling.viewAgentsLink",defaultMessage:"View agents"}))}})),i.a.createElement(V.EuiSpacer,{size:"m"})),be,i.a.createElement(V.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},me&&i.a.createElement(V.EuiFlexItem,null,i.a.createElement(_T,null)),i.a.createElement(V.EuiFlexItem,{grow:!1,style:ce},i.a.createElement(zT,null,i.a.createElement(V.EuiSuperDatePicker,{className:"endpointListDatePicker",onTimeChange:ee,isDisabled:f,onRefresh:X,isPaused:ue,refreshInterval:de,onRefreshChange:Z,isAutoRefreshOnly:!0})))),i.a.createElement(V.EuiSpacer,{size:"m"})),le&&i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiText,{color:"subdued",size:"xs","data-test-subj":"endpointListTableTotal"},p>1e4?i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.totalCount.limited",defaultMessage:"Showing {limit} of {totalItemCount, plural, one {# endpoint} other {# endpoints}}",values:{totalItemCount:p,limit:1e4}}):i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.endpoint.list.totalCount",defaultMessage:"Showing {totalItemCount, plural, one {# endpoint} other {# endpoints}}",values:{totalItemCount:p}})),i.a.createElement(V.EuiHorizontalRule,{margin:"xs"})),oe)},HT=Object(n.memo)((()=>i.a.createElement(P.Switch,null,i.a.createElement(L.Route,{path:Ww.h,exact:!0,component:UT}),i.a.createElement(L.Route,{path:"*",component:q.a}))));HT.displayName="EndpointsContainer";var GT=a(405),QT=a(394);const WT=Object(n.memo)((({policyId:e,nonLinkCondition:t,"data-test-subj":a,children:r,...o})=>{const l=`(language:kuery,query:'united.endpoint.Endpoint.policy.applied.id : "${e}"')`,{search:c}=Object(P.useLocation)(),{getAppUrl:u}=Object(p.d)(),{toRoutePathWithBackOptions:d,toRouteUrl:m}=Object(n.useMemo)((()=>{const e=Object(h.e)({name:"endpointList",admin_query:l}),t=Object(h.h)(c),a={navigateTo:[s.B,{path:t}],label:z.i18n.translate("xpack.securitySolution.policy.backToPolicyList",{defaultMessage:"Back to policy list"}),href:u({path:t})};return{toRoutePathWithBackOptions:{pathname:Object(h.e)({name:"endpointList"}),search:`?admin_query=${l}`,state:{backLink:a}},toRouteUrl:u({path:e})}}),[u,l,c]),g=Object(dT.a)(d);return t?i.a.createElement(V.EuiText,{size:"s","data-test-subj":`${a}_nonLink`},r):i.a.createElement(V.EuiLink,lr()({href:m,"data-test-subj":a,onClick:g},o),r)}));WT.displayName="PolicyEndpointCount";const KT=Object(n.memo)((()=>{const{pagination:e,pageSizeOptions:t,setPagination:a}=Object(GT.b)(),{search:r}=Object(P.useLocation)(),{getAppUrl:o}=Object(p.d)(),l=Object(p.o)(),{data:c,isFetching:u,error:d}=Object(QT.c)({page:e.page,perPage:e.pageSize}),m=Object(n.useMemo)((()=>{var e;return null!==(e=null==c?void 0:c.items.map((e=>e.id)))&&void 0!==e?e:[]}),[c]),g=Object(n.useMemo)((()=>{var e;return null!==(e=null==c?void 0:c.items.map((e=>e.policy_id)))&&void 0!==e?e:[]}),[c]),{data:b={items:[]}}=Object(QT.a)({agentPolicyIds:g,customQueryOptions:{enabled:g.length>0,onError:e=>{l.addDanger(z.i18n.translate("xpack.securitySolution.policyList.endpointCountError",{defaultMessage:"Error retrieving endpoint counts"}))}}}),{data:f,isFetching:y}=Object(QT.b)({customQueryOptions:{enabled:0===g.length,onError:e=>{l.addDanger(z.i18n.translate("xpack.securitySolution.policyList.packageVersionError",{defaultMessage:"Error retrieving the endpoint package version"}))}}}),E=Object(n.useMemo)((()=>{const e=new Map;for(const a of null==b?void 0:b.items)if(a.package_policies)for(const n of a.package_policies){var t;m.includes(n.id)&&e.set(n.id,null!==(t=a.agents)&&void 0!==t?t:0)}if(m.length>0&&0===e.size)for(const t of m)e.set(t,0);return e}),[b,m]),v=Object(n.useMemo)((()=>{var e;return null!==(e=null==c?void 0:c.total)&&void 0!==e?e:0}),[c]),x=Object(n.useMemo)((()=>Object(h.h)(r)),[r]),k=Object(n.useMemo)((()=>({navigateTo:[s.B,{path:x}],label:z.i18n.translate("xpack.securitySolution.policy.backToPolicyList",{defaultMessage:"Back to policy list"}),href:o({path:x})})),[o,x]),S=Object(Yh.a)("fleet",{path:Yw.pagePathGetters.add_integration_to_policy({pkgkey:f?`/endpoint-${null==f?void 0:f.version}`:""})[1],state:{onCancelNavigateTo:[s.B,{path:x}],onCancelUrl:o({path:Object(h.h)()}),onSaveNavigateTo:[s.B,{path:x}]}}),j=Object(n.useMemo)((()=>{const e=z.i18n.translate("xpack.securitySolution.policy.list.updatedAt",{defaultMessage:"Last Updated"}),t=z.i18n.translate("xpack.securitySolution.policy.list.createdAt",{defaultMessage:"Date Created"});return[{field:"",name:z.i18n.translate("xpack.securitySolution.policy.list.name",{defaultMessage:"Name"}),truncateText:!0,render:e=>i.a.createElement(V.EuiToolTip,{content:e.name,anchorClassName:"eui-textTruncate"},i.a.createElement(pT,{policyId:e.id,className:"eui-textTruncate","data-test-subj":"policyNameCellLink",backLink:k},e.name))},{field:"created_by",name:z.i18n.translate("xpack.securitySolution.policy.list.createdBy",{defaultMessage:"Created by"}),truncateText:!0,render:e=>i.a.createElement(V.EuiFlexGroup,{responsive:!1,gutterSize:"xs",alignItems:"center"},i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiAvatar,{name:e,"data-test-subj":"created-by-avatar",size:"s"})),i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiText,{size:"s","data-test-subj":"created-by-name"},e)))},{field:"created_at",name:t,truncateText:!0,render:e=>i.a.createElement(xa.a,{fieldName:t,value:e,className:"eui-textTruncate"})},{field:"updated_by",name:z.i18n.translate("xpack.securitySolution.policy.list.lastUpdatedBy",{defaultMessage:"Last updated by"}),truncateText:!0,render:e=>i.a.createElement(V.EuiFlexGroup,{responsive:!1,gutterSize:"xs",alignItems:"center"},i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiAvatar,{name:e,"data-test-subj":"updated-by-avatar",size:"s"})),i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiText,{size:"s","data-test-subj":"updated-by-name"},e)))},{field:"updated_at",name:e,truncateText:!0,render:t=>i.a.createElement(xa.a,{fieldName:e,value:t,className:"eui-textTruncate"})},{field:"",name:z.i18n.translate("xpack.securitySolution.policy.list.endpoints",{defaultMessage:"Endpoints"}),width:"8%",render:e=>{const t=E.get(e.id);return i.a.createElement(WT,{className:"eui-textTruncate","data-test-subj":"policyEndpointCountLink",policyId:e.id,nonLinkCondition:0===t},t)}}]}),[E,k]),O=Object(n.useCallback)((({page:e})=>{a({page:e.index+1,pageSize:e.size})}),[a]),w=Object(n.useMemo)((()=>({pageIndex:e.page-1,pageSize:e.pageSize,totalItemCount:v,pageSizeOptions:t})),[v,t,e.page,e.pageSize]),T=z.i18n.translate("xpack.securitySolution.policy.list.errorMessage",{defaultMessage:"Error while retrieving list of policies"});return i.a.createElement(NT.a,{"data-test-subj":"policyListPage",hideHeader:0===v,title:z.i18n.translate("xpack.securitySolution.policy.list.title",{defaultMessage:"Policies"}),subtitle:z.i18n.translate("xpack.securitySolution.policy.list.subtitle",{defaultMessage:"Use policies to customize endpoint and cloud workload protections and other configurations"})},v>0?i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiText,{color:"subdued",size:"xs","data-test-subj":"endpointListTableTotal"},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.policy.list.totalCount",defaultMessage:"Showing {totalItemCount, plural, one {# policy} other {# policies}}",values:{totalItemCount:v}})),i.a.createElement(V.EuiHorizontalRule,{margin:"xs"}),i.a.createElement(V.EuiBasicTable,{"data-test-subj":"policyListTable",items:(null==c?void 0:c.items)||[],columns:j,pagination:w,onChange:O,loading:u,error:null!==d?T:""})):i.a.createElement(qT.a,null,i.a.createElement(TT,{loading:y,onActionClick:S,policyEntryPoint:!0})))}));KT.displayName="PolicyList";var YT=a(170),JT=a(178);const XT=Object(n.memo)((e=>{const t=Object(n.useMemo)((()=>[{key:"total",title:z.i18n.translate("xpack.securitySolution.endpoint.policyDetails.agentsSummary.totalTitle",{defaultMessage:"Total agents"}),health:""},{key:"online",title:z.i18n.translate("xpack.securitySolution.endpoint.policyDetails.agentsSummary.onlineTitle",{defaultMessage:"Healthy"}),health:"success"},{key:"error",title:z.i18n.translate("xpack.securitySolution.endpoint.policyDetails.agentsSummary.errorTitle",{defaultMessage:"Unhealthy"}),health:"warning"},{key:"offline",title:z.i18n.translate("xpack.securitySolution.endpoint.policyDetails.agentsSummary.offlineTitle",{defaultMessage:"Offline"}),health:"subdued"}]),[]),a=Object(n.useContext)(U.ThemeContext);return i.a.createElement(V.EuiFlexGroup,{gutterSize:"l",responsive:!1,"data-test-subj":"policyAgentsSummary"},t.map((({key:t,title:n,health:r})=>i.a.createElement(V.EuiFlexItem,{grow:!1,key:t,style:{marginRight:"total"===t?a.eui.gutterTypes.gutterExtraLarge:void 0}},i.a.createElement(V.EuiDescriptionList,{textStyle:"reverse",style:{textAlign:"right"},listItems:[{title:n,description:i.a.createElement(i.a.Fragment,null,r&&i.a.createElement(V.EuiHealth,{color:"warning"===r?a.eui.euiColorWarning:r,className:"eui-alignMiddle"}),i.a.createElement(V.EuiI18nNumber,{value:e[t]}))}]})))))}));XT.displayName="AgentsSummary";var ZT=a(563),eI=a(232),tI=a(206);const aI=(e,t,a,i,r)=>{const{getAppUrl:o}=Object(Hc.b)(),{toRoutePath:l,toRouteUrl:c}=Object(n.useMemo)((()=>{const e=i(r);return{toRoutePath:e,toRouteUrl:o({path:e})}}),[o,i,r]),u=a(e),d=Object(n.useMemo)((()=>({backButtonLabel:z.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.empty.unassigned.backButtonLabel",{defaultMessage:"Back to {policyName} policy",values:{policyName:t}}),onBackButtonNavigateTo:[s.B,{path:u}],backButtonUrl:o({appId:s.B,path:u})})),[o,t,u]);return{onClickHandler:Object(Yh.a)(s.B,{state:d,path:l}),toRouteUrl:c,state:d}},nI=Object(n.memo)((({policyId:e,policyName:t,listId:a,labels:r,getPolicyArtifactsPath:s,getArtifactPath:o})=>{const{canCreateArtifactsByPolicy:l}=Object(pd.a)().endpointPrivileges,{onClickHandler:c,toRouteUrl:u}=aI(e,t,s,o),d=Object(YT.b)(a),p=Object(n.useCallback)((()=>d({show:"list"})),[d]);return i.a.createElement(V.EuiPageTemplate_Deprecated,{template:"centeredContent"},i.a.createElement(V.EuiEmptyPrompt,{iconType:"plusInCircle","data-test-subj":"policy-artifacts-empty-unassigned",title:i.a.createElement("h2",null,r.emptyUnassignedTitle),body:r.emptyUnassignedMessage(t),actions:[...l?[i.a.createElement(V.EuiButton,{color:"primary",fill:!0,onClick:p,"data-test-subj":"assign-artifacts-button"},r.emptyUnassignedPrimaryActionButtonTitle)]:[],i.a.createElement(V.EuiLink,{onClick:c,href:u},r.emptyUnassignedSecondaryActionButtonTitle)]}))}));nI.displayName="PolicyArtifactsEmptyUnassigned";const iI=Object(n.memo)((({policyId:e,policyName:t,labels:a,getPolicyArtifactsPath:n,getArtifactPath:r})=>{const{onClickHandler:s,toRouteUrl:o}=aI(e,t,n,r,{show:"create"});return i.a.createElement(V.EuiPageTemplate_Deprecated,{template:"centeredContent"},i.a.createElement(V.EuiEmptyPrompt,{iconType:"plusInCircle","data-test-subj":"policy-artifacts-empty-unexisting",title:i.a.createElement("h2",null,a.emptyUnexistingTitle),body:a.emptyUnexistingMessage,actions:i.a.createElement(V.EuiButton,{color:"primary",fill:!0,onClick:s,href:o},a.emptyUnexistingPrimaryActionButtonTitle)}))}));iI.displayName="PolicyArtifactsEmptyUnexisting";const rI=Object.freeze({emptyUnassignedTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.empty.unassigned.title",{defaultMessage:"No assigned artifacts"}),emptyUnassignedMessage:e=>z.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.empty.unassigned.content",{defaultMessage:"There are currently no artifacts assigned to {policyName}. Assign artifacts now or add and manage them on the artifacts page.",values:{policyName:e}}),emptyUnassignedPrimaryActionButtonTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.empty.unassigned.primaryAction",{defaultMessage:"Assign artifacts"}),emptyUnassignedSecondaryActionButtonTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.empty.unassigned.secondaryAction",{defaultMessage:"Manage artifacts"})}),sI=Object.freeze({emptyUnexistingTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.empty.unexisting.title",{defaultMessage:"No artifacts exist"}),emptyUnexistingMessage:z.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.empty.unexisting.content",{defaultMessage:"There are currently no artifacts applied to your endpoints."}),emptyUnexistingPrimaryActionButtonTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.empty.unexisting.action",{defaultMessage:"Add artifacts"})});var oI=a(840),lI=a(575),cI=a(503),uI=a(927),dI=a(91);const pI=H()(cI.e).withConfig({displayName:"GridHeaderContainer",componentId:"sc-1qje9ej-0"})(["padding-top:0;padding-bottom:",";"],(({theme:e})=>e.eui.euiSizeS)),mI=Object(n.memo)((({"data-test-subj":e,expandAllIconType:t,onExpandCollapseAll:a})=>{const r=Object(dI.a)(e),s=Object(n.useMemo)((()=>i.a.createElement(V.EuiButtonIcon,{"data-test-subj":r("expandCollapseAllButton"),"aria-label":z.i18n.translate("xpack.securitySolution.artifactCardGrid.expandCollapseLabel",{defaultMessage:"{action} all cards",values:{action:"Expand"}}),iconType:t,onClick:()=>a(),style:{marginLeft:"-5px"}})),[r,t,a]);return i.a.createElement(pI,{"data-test-subj":e},i.a.createElement(cI.d,{expanded:!1,expandToggle:s,"data-test-subj":r("layout"),flushTop:!0,name:i.a.createElement(V.EuiText,{size:"xs","data-test-subj":r("name")},i.a.createElement("strong",null,i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.artifactCardGrid.nameColumn",defaultMessage:"Name"}))),description:i.a.createElement(V.EuiText,{size:"xs","data-test-subj":r("description")},i.a.createElement("strong",null,i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.artifactCardGrid.DescriptionColumn",defaultMessage:"Description"}))),effectScope:i.a.createElement(V.EuiText,{size:"xs","data-test-subj":r("assignment")},i.a.createElement("strong",null,i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.artifactCardGrid.assignmentColumn",defaultMessage:"Assignment"}))),actionMenu:!0}))}));mI.displayName="GridHeader";const gI=uI.a,bI=Object(n.memo)((({items:e,cardComponentProps:t,onPageChange:a,onExpandCollapse:r,"data-test-subj":s,...o})=>{const l=Object(dI.a)(s),c=e,u=Object(n.useMemo)((()=>{const e=new Map;for(const a of c)e.set(a,t?t(a):{});return e}),[t,c]),d=Object(n.useCallback)((e=>{const t=[],a=[];for(const[n,i]of u){const r=Boolean(i.expanded);(n===e?!r:r)?t.push(n):a.push(n)}r({expanded:t,collapsed:a})}),[u,r]),p=Object(n.useMemo)((()=>{for(const[e,t]of u)if(!Boolean(t.expanded))return!1;return!0}),[u]),m=Object(n.useCallback)((()=>{let e=[],t=[];p?t=Array.from(u.keys()):e=Array.from(u.keys()),r({expanded:e,collapsed:t})}),[u,r,p]),g=Object(n.useMemo)((()=>{const e=new Map;for(const[a,n]of u){var t;e.set(a,{...n,item:a,onExpandCollapse:()=>d(a),"data-test-subj":null!==(t=n["data-test-subj"])&&void 0!==t?t:l("card")})}return e}),[u,l,d]),b=Object(n.useCallback)((e=>g.get(e)),[g]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(mI,{expandAllIconType:p?"fold":"unfold",onExpandCollapseAll:m,"data-test-subj":l("header")}),i.a.createElement(gI,lr()({},o,{"data-test-subj":s,items:c,ItemComponent:cI.c,itemComponentProps:b,onChange:a})))}));bI.displayName="ArtifactCardGrid";var fI=a(576);const yI=i.a.memo((({policy:e,apiClient:t,searchableFields:a,getArtifactPath:r,getPolicyArtifactsPath:o,labels:l,onDeleteActionCallback:c,externalPrivileges:u=!0})=>{var d;(()=>{const e=Object(P.useHistory)(),{urlParams:t}=Object(eI.a)();Object(n.useEffect)((()=>{(t.page_index&&!t.page||t.page_size&&!t.pageSize)&&e.replace(`${e.location.pathname}${e.location.search.replaceAll("page_size","pageSize").replaceAll(`page_index=${t.page_index}`,`page=${Number(t.page_index)+1}`)}`)}),[e,t.page,t.pageSize,t.page_index,t.page_size])})();const{getAppUrl:m}=Object(p.d)(),{canCreateArtifactsByPolicy:g}=Object(pd.a)().endpointPrivileges,b=Object(QT.c)({perPage:1e3}),f=Object(YT.b)(t.listId),{urlParams:y}=Object(eI.a)(),[h,E]=Object(n.useState)(new Map),{state:v}=aI(e.id,e.name,o,r),{pageSizeOptions:x,pagination:k,setPagination:S}=Object(GT.b)(),{data:j,isLoading:O,isRefetching:w}=Object(tI.e)(t,{page:k.page,perPage:k.pageSize,filter:y.filter,policies:[e.id,"all"]},a),T=Object(n.useMemo)((()=>({pageSize:k.pageSize,pageIndex:k.page-1,pageSizeOptions:x,totalItemCount:(null==j?void 0:j.total)||0})),[null==j?void 0:j.total,x,k.page,k.pageSize]),I=Object(n.useCallback)((e=>{f({filter:e})}),[f]),C=Object(n.useCallback)((({expanded:e,collapsed:t})=>{const a=new Map(h);for(const t of e)a.set(t.id,!0);for(const e of t)a.set(e.id,!1);E(a)}),[h]),M=Object(n.useCallback)((({pageIndex:e,pageSize:t})=>{null!=j&&j.total&&S({page:e+1,pageSize:t})}),[null==j?void 0:j.total,S]),F=Object(n.useMemo)((()=>l.listTotalItemCountMessage((null==j?void 0:j.data.length)||0)),[null==j?void 0:j.data.length,l]),D=Object(lI.a)(null===(d=b.data)||void 0===d?void 0:d.items),A=Object(n.useCallback)((e=>{const t=r({filter:e.item_id}),a={icon:"controlsHorizontal",children:l.listFullDetailsActionTitle,href:m({appId:s.B,path:t}),navigateAppId:s.B,navigateOptions:{path:t,state:v},"data-test-subj":"view-full-details-action"},n=e,i=Object(fI.d)(n.tags),o={icon:"trash",children:l.listRemoveActionTitle,onClick:()=>{c(n)},disabled:i,toolTipContent:i?l.listRemoveActionNotAllowedMessage:void 0,toolTipPosition:"top","data-test-subj":"remove-from-policy-action"};return{expanded:h.get(n.id)||!1,actions:g&&u?[a,o]:[a],policies:D}}),[D,g,h,u,m,r,l.listFullDetailsActionTitle,l.listRemoveActionNotAllowedMessage,l.listRemoveActionTitle,c,v]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(oI.a,{placeholder:l.listSearchPlaceholderMessage,defaultValue:y.filter,hideRefreshButton:!0,onSearch:I}),i.a.createElement(V.EuiSpacer,{size:"s"}),i.a.createElement(V.EuiText,{color:"subdued",size:"xs","data-test-subj":"policyDetailsArtifactsSearchCount"},F),i.a.createElement(V.EuiSpacer,{size:"m"}),i.a.createElement(bI,{items:(null==j?void 0:j.data)||[],onPageChange:M,onExpandCollapse:C,cardComponentProps:A,pagination:j?T:void 0,loading:O||w,"data-test-subj":"artifacts-collapsed-list"}))}));yI.displayName="PolicyArtifactsList";const hI=Object.freeze({listTotalItemCountMessage:e=>z.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.totalItemCount",{defaultMessage:"Showing {totalItemsCount, plural, one {# artifact} other {# artifacts}}",values:{totalItemsCount:e}}),listFullDetailsActionTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.fullDetailsAction",{defaultMessage:"View full details"}),listRemoveActionTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.removeAction",{defaultMessage:"Remove from policy"}),listRemoveActionNotAllowedMessage:z.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.removeActionNotAllowed",{defaultMessage:"Globally applied artifact cannot be removed from policy."}),listSearchPlaceholderMessage:z.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.search.placeholder",{defaultMessage:"Search on the fields below: name, description, value"})}),EI=i.a.memo((({artifacts:e,isListLoading:t,selectedArtifactIds:a,selectedArtifactsUpdated:r})=>{const s=Object(n.useMemo)((()=>a.reduce(((e,t)=>({...e,[t]:!0})),{})),[a]),o=Object(n.useMemo)((()=>{if(!e||!e.data.length)return null;const t=e.data;return i.a.createElement("div",{"data-test-subj":"artifactsList"},t.map((e=>i.a.createElement(cI.b,{key:e.id,item:e,isSelected:s[e.id]||!1,onToggleSelectedArtifact:t=>r(e.id,t)}))))}),[e,s,r]);return i.a.createElement(i.a.Fragment,null,t&&i.a.createElement(V.EuiProgress,{size:"xs",color:"primary","data-test-subj":"artifactsAssignableListLoader"}),i.a.createElement("div",null,o))}));EI.displayName="PolicyArtifactsAssignableList";const vI=i.a.memo((({policyItem:e,apiClient:t,searchableFields:a,onClose:r,labels:s})=>{const o=Object(p.o)(),l=Object(rk.useQueryClient)(),[c,u]=Object(n.useState)([]),[d,m]=Object(n.useState)(""),g=Object(tI.a)(t,{onSuccess:e=>{o.addSuccess({title:s.flyoutSuccessMessageTitle,text:s.flyoutSuccessMessageText(e)}),l.invalidateQueries(["list",t]),r()},onError:()=>{o.addDanger(s.flyoutErrorMessage)}}),{data:b,isLoading:f,isRefetching:y}=Object(tI.e)(t,{perPage:100,filter:d,excludedPolicies:[e.id,"all"]},a),{data:h,isLoading:E}=Object(tI.e)(t,{excludedPolicies:[e.id,"all"]},a),x=Object(n.useCallback)((e=>{u([]),m(e)}),[]),k=Object(n.useCallback)((()=>{if(!b)return;const t=[];c.forEach((a=>{const n=b.data.find((e=>e.id===a));n&&(n.tags=[...n.tags,`policy:${e.id}`],t.push(n))})),g.mutate(t)}),[g,b,e.id,c]),S=Object(n.useMemo)((()=>i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiCallOut,{"data-test-subj":"artifacts-too-many-results",color:"warning",size:"s",heading:"h4",title:s.flyoutWarningCalloutTitle},s.flyoutWarningCalloutMessage(100)),i.a.createElement(V.EuiSpacer,{size:"m"}))),[s]),j=Object(n.useMemo)((()=>0!==(null==h?void 0:h.total)&&(0!==(null==b?void 0:b.total)||""!==d)),[null==h?void 0:h.total,null==b?void 0:b.total,d]),O=Object(n.useMemo)((()=>f||y||E),[E,f,y]),w=Object(n.useMemo)((()=>O?null:j?0===(null==b?void 0:b.total)?i.a.createElement(V.EuiEmptyPrompt,{titleSize:"xs","data-test-subj":"artifacts-no-items-found",body:i.a.createElement("p",null,s.flyoutNoSearchResultsMessage)}):void 0:i.a.createElement(V.EuiEmptyPrompt,{titleSize:"xs","data-test-subj":"artifacts-no-assignable-items",body:i.a.createElement("p",null,s.flyoutNoArtifactsToBeAssignedMessage)})),[O,j,null==b?void 0:b.total,s.flyoutNoArtifactsToBeAssignedMessage,s.flyoutNoSearchResultsMessage]);return i.a.createElement(V.EuiFlyout,{onClose:r,"data-test-subj":"artifacts-assign-flyout"},i.a.createElement(V.EuiFlyoutHeader,{hasBorder:!0},i.a.createElement(V.EuiTitle,{size:"m"},i.a.createElement("h2",null,s.flyoutTitle)),i.a.createElement(V.EuiSpacer,{size:"m"}),s.flyoutSubtitle(e.name)),i.a.createElement(V.EuiFlyoutBody,null,((null==b?void 0:b.total)||0)>100?S:null,!E&&j&&i.a.createElement(oI.a,{onSearch:x,placeholder:s.flyoutSearchPlaceholder,hideRefreshButton:!0}),i.a.createElement(V.EuiSpacer,{size:"m"}),i.a.createElement(EI,{"data-test-subj":"artifacts-assignable-list",artifacts:b,selectedArtifactIds:c,isListLoading:f||y,selectedArtifactsUpdated:(e,t)=>{u((a=>t?[...a,e]:Object(v.without)([e],a)))}}),w),i.a.createElement(V.EuiFlyoutFooter,null,i.a.createElement(V.EuiFlexGroup,{justifyContent:"spaceBetween"},i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiButtonEmpty,{"data-test-subj":"artifacts-assign-cancel-button",onClick:r},s.flyoutCancelButtonTitle)),i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiButton,{className:"eui-textTruncate",style:{maxWidth:"300px"},"data-test-subj":"artifacts-assign-confirm-button",fill:!0,onClick:k,isLoading:g.isLoading||f||y,disabled:Object(v.isEmpty)(c),title:e.name},s.flyoutSubmitButtonTitle(e.name))))))}));vI.displayName="PolicyArtifactsFlyout";const xI=Object.freeze({flyoutWarningCalloutTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.searchWarning.title",{defaultMessage:"Limited search results"}),flyoutWarningCalloutMessage:e=>z.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.searchWarning.text",{defaultMessage:"Only the first {maxNumber} artifacts are displayed. Please use the search bar to refine the results.",values:{maxNumber:e}}),flyoutNoArtifactsToBeAssignedMessage:z.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.noAssignable",{defaultMessage:"There are no artifacts that can be assigned to this policy."}),flyoutNoSearchResultsMessage:z.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.noResults",{defaultMessage:"No items found"}),flyoutTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.title",{defaultMessage:"Assign artifacts"}),flyoutSubtitle:e=>z.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.subtitle",{defaultMessage:"Select artifacts to add to {policyName}",values:{policyName:e}}),flyoutSearchPlaceholder:z.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.search.label",{defaultMessage:"Search artifacts"}),flyoutCancelButtonTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.cancel",{defaultMessage:"Cancel"}),flyoutSubmitButtonTitle:e=>z.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.confirm",{defaultMessage:"Assign to {policyName}",values:{policyName:e}}),flyoutErrorMessage:z.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.toastError.text",{defaultMessage:"An error occurred updating artifacts"}),flyoutSuccessMessageTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.toastSuccess.title",{defaultMessage:"Success"}),flyoutSuccessMessageText:e=>e.length>1?z.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.toastSuccess.textMultiples",{defaultMessage:"{count} artifacts have been added to your list.",values:{count:e.length}}):z.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.flyout.toastSuccess.textSingle",{defaultMessage:'"{name}" has been added to your artifacts list.',values:{name:e[0].name}})});var kI=a(372);const SI=i.a.memo((({policyId:e,policyName:t,apiClient:a,exception:r,onClose:s,labels:o})=>{const l=Object(p.o)(),c=Object(rk.useQueryClient)(),{mutate:u,isLoading:d}=Object(tI.a)(a,{onSuccess:()=>{l.addSuccess({title:o.deleteModalSuccessMessageTitle,text:o.deleteModalSuccessMessageText(r,t)}),c.invalidateQueries(["list",a]),s()},onError:e=>{l.addError(e,{title:o.deleteModalErrorMessage})}}),m=Object(n.useCallback)((()=>{const t={...r,tags:r.tags.filter((t=>t!==`${kI.a}${e}`))};u([t])}),[r,e,u]),g=Object(n.useCallback)((()=>{d||s()}),[d,s]);return i.a.createElement(V.EuiConfirmModal,{onCancel:g,onConfirm:m,title:o.deleteModalTitle,cancelButtonText:o.deleteModalCancelButtonTitle,confirmButtonText:o.deleteModalSubmitButtonTitle,isLoading:d,"data-test-subj":"remove-from-policy-dialog"},i.a.createElement(V.EuiCallOut,{color:"warning",iconType:"help"},i.a.createElement("p",null,o.deleteModalImpactInfo)),i.a.createElement(V.EuiSpacer,null),i.a.createElement(V.EuiText,{size:"s"},i.a.createElement("p",null,o.deleteModalConfirmInfo)))})),jI=Object.freeze({deleteModalTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.removeDialog.title",{defaultMessage:"Remove artifact from policy"}),deleteModalImpactInfo:z.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.removeDialog.messageCallout",{defaultMessage:"This artifact will be removed only from this policy and can still be found and managed from the artifact page."}),deleteModalConfirmInfo:z.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.removeDialog.message",{defaultMessage:"Are you sure you wish to continue?"}),deleteModalSubmitButtonTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.removeDialog.confirmLabel",{defaultMessage:"Remove from policy"}),deleteModalCancelButtonTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.removeDialog.cancelLabel",{defaultMessage:"Cancel"}),deleteModalSuccessMessageTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.removeDialog.successToastTitle",{defaultMessage:"Successfully removed"}),deleteModalSuccessMessageText:(e,t)=>z.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.removeDialog.successToastText",{defaultMessage:'"{artifactName}" has been removed from {policyName} policy',values:{artifactName:e.name,policyName:t}}),deleteModalErrorMessage:z.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.list.removeDialog.errorToastTitle",{defaultMessage:"Error while attempting to remove artifact"})}),OI=Object.freeze({layoutTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.title",{defaultMessage:"Assigned artifacts"}),layoutAssignButtonTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.assignToPolicy",{defaultMessage:"Assign artifact to policy"}),layoutViewAllLinkMessage:z.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.about.viewAllLinkLabel",{defaultMessage:"view all artifacts"}),layoutAboutMessage:(e,t)=>z.i18n.translate("xpack.securitySolution.endpoint.policy.artifacts.layout.about",{defaultMessage:"There {count, plural, one {is} other {are}} {count} {count, plural, =1 {artifact} other {artifacts}} associated with this policy. Click here to view all artifacts",values:{count:e}})}),wI=Object.freeze({...OI,...jI,...xI,...rI,...sI,...hI}),TI=i.a.memo((({policyItem:e,labels:t={},getExceptionsListApiClient:a,searchableFields:r,getArtifactPath:o,getPolicyArtifactsPath:l,externalPrivileges:c=!0})=>{const u=Object(n.useMemo)((()=>a()),[a]),{getAppUrl:d}=Object(p.d)(),m=Object(YT.b)(u.listId),{canCreateArtifactsByPolicy:g}=Object(pd.a)().endpointPrivileges,{urlParams:b}=Object(eI.a)(),[f,y]=Object(n.useState)(),h=Object(n.useMemo)((()=>({...wI,...t})),[t]),{data:E,isLoading:v}=Object(tI.e)(u,{policies:e?[e.id,"all"]:[]},r),{data:x,isLoading:k,isRefetching:S}=Object(tI.e)(u,{},r,{},["allExisting"]),j=Object(n.useCallback)((()=>{m({show:"list"})}),[m]),O=Object(n.useCallback)((()=>{m({show:void 0})}),[m]),w=Object(n.useCallback)((()=>{y(void 0)}),[y]),T=Object(n.useCallback)((e=>{y(e)}),[y]),I=Object(n.useMemo)((()=>i.a.createElement(V.EuiButton,{fill:!0,iconType:"plusInCircle","data-test-subj":"artifacts-assign-button",onClick:j},h.layoutAssignButtonTitle)),[j,h.layoutAssignButtonTitle]),C=Object(n.useMemo)((()=>{const e=i.a.createElement(V.EuiLink,{href:d({appId:s.B,path:o()}),target:"_blank"},h.layoutViewAllLinkMessage);return h.layoutAboutMessage((null==E?void 0:E.total)||0,e)}),[d,o,h,null==E?void 0:E.total]),M=Object(n.useMemo)((()=>v||k||S),[v,k,S]),F=Object(n.useMemo)((()=>E&&0===E.total),[E]);return!e||M?i.a.createElement(ZT.a,{"data-test-subj":"policy-artifacts-loading-spinner"}):F?i.a.createElement(i.a.Fragment,null,g&&"list"===b.show&&i.a.createElement(vI,{policyItem:e,apiClient:u,searchableFields:[...r],onClose:O,labels:h}),x&&0!==x.total?i.a.createElement(nI,{policyId:e.id,policyName:e.name,listId:u.listId,labels:h,getPolicyArtifactsPath:l,getArtifactPath:o}):i.a.createElement(iI,{policyId:e.id,policyName:e.name,labels:h,getPolicyArtifactsPath:l,getArtifactPath:o})):i.a.createElement("div",null,i.a.createElement(V.EuiPageHeader,{alignItems:"center"},i.a.createElement(V.EuiPageHeaderSection,{"data-test-subj":"policy-artifacts-header-section"},i.a.createElement(V.EuiTitle,{size:"m"},i.a.createElement("h2",null,h.layoutTitle)),i.a.createElement(V.EuiSpacer,{size:"s"}),i.a.createElement(V.EuiText,{size:"xs","data-test-subj":"policy-artifacts-layout-about"},i.a.createElement("p",null,C))),i.a.createElement(V.EuiPageHeaderSection,null,g&&c&&I)),g&&c&&"list"===b.show&&i.a.createElement(vI,{policyItem:e,apiClient:u,searchableFields:[...r],onClose:O,labels:h}),f&&i.a.createElement(SI,{policyId:e.id,policyName:e.name,apiClient:u,exception:f,onClose:w,labels:h}),i.a.createElement(V.EuiSpacer,{size:"l"}),i.a.createElement(V.EuiPageContent_Deprecated,{hasBorder:!1,hasShadow:!1,paddingSize:"none",color:"transparent",borderRadius:"none"},i.a.createElement(yI,{policy:e,apiClient:u,searchableFields:[...r],labels:h,onDeleteActionCallback:T,externalPrivileges:c,getPolicyArtifactsPath:l,getArtifactPath:o})))}));TI.displayName="PolicyArtifactsLayout";var II=a(1117);const CI=i.a.memo((({endpointCount:e,onCancel:t,onConfirm:a})=>i.a.createElement(V.EuiConfirmModal,{"data-test-subj":"policyDetailsConfirmModal",title:z.i18n.translate("xpack.securitySolution.endpoint.policy.details.updateConfirm.title",{defaultMessage:"Save and deploy changes"}),onCancel:t,onConfirm:a,confirmButtonText:z.i18n.translate("xpack.securitySolution.endpoint.policy.details.updateConfirm.confirmButtonTitle",{defaultMessage:"Save and deploy changes"}),cancelButtonText:z.i18n.translate("xpack.securitySolution.endpoint.policy.details.updateConfirm.cancelButtonTitle",{defaultMessage:"Cancel"})},e>0&&i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiCallOut,{"data-test-subj":"policyDetailsWarningCallout",title:z.i18n.translate("xpack.securitySolution.endpoint.policy.details.updateConfirm.warningTitle",{defaultMessage:"This action will update {endpointCount, plural, one {# endpoint} other {# endpoints}}",values:{endpointCount:e}})},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.updateConfirm.warningMessage",defaultMessage:"Saving these changes will apply updates to all endpoints assigned to this agent policy."})),i.a.createElement(V.EuiSpacer,{size:"xl"})),i.a.createElement("p",null,i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.updateConfirm.message",defaultMessage:"This action cannot be undone. Are you sure you wish to continue?"})))));CI.displayName="ConfirmUpdate";const MI=i.a.memo((()=>{var e,t;const a=Object(o.useDispatch)(),{services:{theme:r,application:{navigateToApp:l}}}=Object(p.k)(),c=Object(p.o)(),{state:u}=Object(P.useLocation)(),d=Object(YT.c)(JT.m),m=Object(YT.c)(JT.a),g=Object(YT.c)(JT.p),b=Object(YT.c)(JT.f),[f,E]=Object(n.useState)(!1),[v,x]=Object(n.useState)(),k=null!==(e=null==d?void 0:d.name)&&void 0!==e?e:"",S=Object(h.e)({name:"endpointList"}),j=null==v?void 0:v.onCancelNavigateTo,O=Object(n.useMemo)((()=>null!=j?j:[s.B,{path:S}]),[S,j]);Object(n.useEffect)((()=>{g&&(g.success?(c.addSuccess({title:z.i18n.translate("xpack.securitySolution.endpoint.policy.details.updateSuccessTitle",{defaultMessage:"Success!"}),text:Object(L.toMountPoint)(i.a.createElement("span",{"data-test-subj":"policyDetailsSuccessMessage"},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.updateSuccessMessage",defaultMessage:"Integration {name} has been updated.",values:{name:k}})),{theme$:r.theme$})}),v&&v.onSaveNavigateTo&&l(...v.onSaveNavigateTo)):c.addDanger({title:z.i18n.translate("xpack.securitySolution.endpoint.policy.details.updateErrorTitle",{defaultMessage:"Failed!"}),text:g.error.message}))}),[l,c,k,g,v,r.theme$]);const w=Object(Yh.a)(...O),T=Object(n.useCallback)((()=>{E(!0)}),[]),I=Object(n.useCallback)((()=>{a({type:"userClickedPolicyDetailsSaveButton"}),E(!1)}),[a]),C=Object(n.useCallback)((()=>{E(!1)}),[]);return Object(n.useEffect)((()=>{!v&&u&&x(u)}),[u,v]),d?i.a.createElement(i.a.Fragment,null,f&&i.a.createElement(CI,{endpointCount:null!==(t=null==m?void 0:m.total)&&void 0!==t?t:0,onCancel:C,onConfirm:I}),i.a.createElement(II.a,null),i.a.createElement(V.EuiSpacer,{size:"xxl"}),i.a.createElement(V.EuiBottomBar,{paddingSize:"s"},i.a.createElement(V.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiThemeProvider,{colorMode:"dark"},i.a.createElement(V.EuiButtonEmpty,{color:"text",onClick:w,"data-test-subj":"policyDetailsCancelButton"},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.cancel",defaultMessage:"Cancel"})))),i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiButton,{fill:!0,iconType:"save","data-test-subj":"policyDetailsSaveButton",onClick:T,isLoading:b},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.save",defaultMessage:"Save"})))))):i.a.createElement(y.a,{noTimeline:!0},b?i.a.createElement(V.EuiLoadingSpinner,{size:"xl"}):null)}));MI.displayName="PolicyFormLayout";const FI=Object.freeze({deleteModalTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.list.removeDialog.title",{defaultMessage:"Remove event filter from policy"}),deleteModalImpactInfo:z.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.list.removeDialog.messageCallout",{defaultMessage:"This event filter will be removed only from this policy and can still be found and managed from the artifact page."}),deleteModalErrorMessage:z.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.list.removeDialog.errorToastTitle",{defaultMessage:"Error while attempting to remove event filter"}),flyoutWarningCalloutMessage:e=>z.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.layout.flyout.searchWarning.text",{defaultMessage:"Only the first {maxNumber} event filters are displayed. Please use the search bar to refine the results.",values:{maxNumber:e}}),flyoutNoArtifactsToBeAssignedMessage:z.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.layout.flyout.noAssignable",{defaultMessage:"There are no event filters that can be assigned to this policy."}),flyoutTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.layout.flyout.title",{defaultMessage:"Assign event filters"}),flyoutSubtitle:e=>z.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.layout.flyout.subtitle",{defaultMessage:"Select event filters to add to {policyName}",values:{policyName:e}}),flyoutSearchPlaceholder:z.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.layout.search.label",{defaultMessage:"Search event filters"}),flyoutErrorMessage:z.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.layout.flyout.toastError.text",{defaultMessage:"An error occurred updating event filters"}),flyoutSuccessMessageText:e=>e.length>1?z.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.layout.flyout.toastSuccess.textMultiples",{defaultMessage:"{count} event filters have been added to your list.",values:{count:e.length}}):z.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.layout.flyout.toastSuccess.textSingle",{defaultMessage:'"{name}" has been added to your event filter list.',values:{name:e[0].name}}),emptyUnassignedTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.empty.unassigned.title",{defaultMessage:"No assigned event filters"}),emptyUnassignedMessage:e=>z.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.empty.unassigned.content",{defaultMessage:"There are currently no event filters assigned to {policyName}. Assign event filters now or add and manage them on the event filters page.",values:{policyName:e}}),emptyUnassignedPrimaryActionButtonTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.empty.unassigned.primaryAction",{defaultMessage:"Assign event filters"}),emptyUnassignedSecondaryActionButtonTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.empty.unassigned.secondaryAction",{defaultMessage:"Manage event filters"}),emptyUnexistingTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.empty.unexisting.title",{defaultMessage:"No event filters exist"}),emptyUnexistingMessage:z.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.empty.unexisting.content",{defaultMessage:"There are currently no event filters applied to your endpoints."}),emptyUnexistingPrimaryActionButtonTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.empty.unexisting.action",{defaultMessage:"Add event filters"}),listTotalItemCountMessage:e=>z.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.list.totalItemCount",{defaultMessage:"Showing {totalItemsCount, plural, one {# event filter} other {# event filters}}",values:{totalItemsCount:e}}),listRemoveActionNotAllowedMessage:z.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.list.removeActionNotAllowed",{defaultMessage:"Globally applied event filter cannot be removed from policy."}),listSearchPlaceholderMessage:z.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.list.search.placeholder",{defaultMessage:"Search on the fields below: name, description, comments, value"}),layoutTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.layout.title",{defaultMessage:"Assigned event filters"}),layoutAssignButtonTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.layout.assignToPolicy",{defaultMessage:"Assign event filters to policy"}),layoutViewAllLinkMessage:z.i18n.translate("xpack.securitySolution.endpoint.policy.eventFilters.layout.about.viewAllLinkLabel",{defaultMessage:"view all event filters"})}),DI=Object.freeze({deleteModalTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.list.removeDialog.title",{defaultMessage:"Remove trusted application from policy"}),deleteModalImpactInfo:z.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.list.removeDialog.messageCallout",{defaultMessage:"This trusted application will be removed only from this policy and can still be found and managed from the artifact page."}),deleteModalErrorMessage:z.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.list.removeDialog.errorToastTitle",{defaultMessage:"Error while attempting to remove trusted app"}),flyoutWarningCalloutMessage:e=>z.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.flyout.searchWarning.text",{defaultMessage:"Only the first {maxNumber} trusted applications are displayed. Please use the search bar to refine the results.",values:{maxNumber:e}}),flyoutNoArtifactsToBeAssignedMessage:z.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.flyout.noAssignable",{defaultMessage:"There are no trusted applications that can be assigned to this policy."}),flyoutTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.flyout.title",{defaultMessage:"Assign trusted applications"}),flyoutSubtitle:e=>z.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.flyout.subtitle",{defaultMessage:"Select trusted applications to add to {policyName}",values:{policyName:e}}),flyoutSearchPlaceholder:z.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.search.label",{defaultMessage:"Search trusted applications"}),flyoutErrorMessage:z.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.flyout.toastError.text",{defaultMessage:"An error occurred updating trusted applications"}),flyoutSuccessMessageText:e=>e.length>1?z.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.flyout.toastSuccess.textMultiples",{defaultMessage:"{count} trusted applications have been added to your list.",values:{count:e.length}}):z.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.flyout.toastSuccess.textSingle",{defaultMessage:'"{name}" has been added to your trusted application list.',values:{name:e[0].name}}),emptyUnassignedTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.empty.unassigned.title",{defaultMessage:"No assigned trusted applications"}),emptyUnassignedMessage:e=>z.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.empty.unassigned.content",{defaultMessage:"There are currently no trusted applications assigned to {policyName}. Assign trusted applications now or add and manage them on the trusted applications page.",values:{policyName:e}}),emptyUnassignedPrimaryActionButtonTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.empty.unassigned.primaryAction",{defaultMessage:"Assign trusted applications"}),emptyUnassignedSecondaryActionButtonTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.empty.unassigned.secondaryAction",{defaultMessage:"Manage trusted applications"}),emptyUnexistingTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.empty.unexisting.title",{defaultMessage:"No trusted applications exist"}),emptyUnexistingMessage:z.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.empty.unexisting.content",{defaultMessage:"There are currently no trusted applications applied to your endpoints."}),emptyUnexistingPrimaryActionButtonTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.empty.unexisting.action",{defaultMessage:"Add trusted applications"}),listTotalItemCountMessage:e=>z.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.list.totalItemCount",{defaultMessage:"Showing {totalItemsCount, plural, one {# trusted app} other {# trusted applications}}",values:{totalItemsCount:e}}),listRemoveActionNotAllowedMessage:z.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.list.removeActionNotAllowed",{defaultMessage:"Globally applied trusted application cannot be removed from policy."}),listSearchPlaceholderMessage:z.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.list.search.placeholder",{defaultMessage:"Search on the fields below: name, description, value"}),layoutTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.title",{defaultMessage:"Assigned trusted applications"}),layoutAssignButtonTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.assignToPolicy",{defaultMessage:"Assign trusted applications to policy"}),layoutViewAllLinkMessage:z.i18n.translate("xpack.securitySolution.endpoint.policy.trustedApps.layout.about.viewAllLinkLabel",{defaultMessage:"view all trusted applications"})}),AI=Object.freeze({deleteModalTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.list.removeDialog.title",{defaultMessage:"Remove host isolation exception from policy"}),deleteModalImpactInfo:z.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.list.removeDialog.messageCallout",{defaultMessage:"This host isolation exception will be removed only from this policy and can still be found and managed from the artifact page."}),deleteModalErrorMessage:z.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.list.removeDialog.errorToastTitle",{defaultMessage:"Error while attempting to remove host isolation exception"}),flyoutWarningCalloutMessage:e=>z.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.layout.flyout.searchWarning.text",{defaultMessage:"Only the first {maxNumber} host isolation exceptions are displayed. Please use the search bar to refine the results.",values:{maxNumber:e}}),flyoutNoArtifactsToBeAssignedMessage:z.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.layout.flyout.noAssignable",{defaultMessage:"There are no host isolation exceptions that can be assigned to this policy."}),flyoutTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.layout.flyout.title",{defaultMessage:"Assign host isolation exceptions"}),flyoutSubtitle:e=>z.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.layout.flyout.subtitle",{defaultMessage:"Select host isolation exceptions to add to {policyName}",values:{policyName:e}}),flyoutSearchPlaceholder:z.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.layout.search.label",{defaultMessage:"Search host isolation exceptions"}),flyoutErrorMessage:z.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.layout.flyout.toastError.text",{defaultMessage:"An error occurred updating host isolation exceptions"}),flyoutSuccessMessageText:e=>e.length>1?z.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.layout.flyout.toastSuccess.textMultiples",{defaultMessage:"{count} host isolation exceptions have been added to your list.",values:{count:e.length}}):z.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.layout.flyout.toastSuccess.textSingle",{defaultMessage:'"{name}" has been added to your host isolation exception list.',values:{name:e[0].name}}),emptyUnassignedTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.empty.unassigned.title",{defaultMessage:"No assigned host isolation exceptions"}),emptyUnassignedMessage:e=>z.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.empty.unassigned.content",{defaultMessage:"There are currently no host isolation exceptions assigned to {policyName}. Assign host isolation exceptions now or add and manage them on the host isolation exceptions page.",values:{policyName:e}}),emptyUnassignedPrimaryActionButtonTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.empty.unassigned.primaryAction",{defaultMessage:"Assign host isolation exceptions"}),emptyUnassignedSecondaryActionButtonTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.empty.unassigned.secondaryAction",{defaultMessage:"Manage host isolation exceptions"}),emptyUnexistingTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.empty.unexisting.title",{defaultMessage:"No host isolation exceptions exist"}),emptyUnexistingMessage:z.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.empty.unexisting.content",{defaultMessage:"There are currently no host isolation exceptions applied to your endpoints."}),emptyUnexistingPrimaryActionButtonTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.empty.unexisting.action",{defaultMessage:"Add host isolation exceptions"}),listTotalItemCountMessage:e=>z.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.list.totalItemCount",{defaultMessage:"Showing {totalItemsCount, plural, one {# host isolation exception} other {# host isolation exceptions}}",values:{totalItemsCount:e}}),listRemoveActionNotAllowedMessage:z.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.list.removeActionNotAllowed",{defaultMessage:"Globally applied host isolation exception cannot be removed from policy."}),listSearchPlaceholderMessage:z.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.list.search.placeholder",{defaultMessage:"Search on the fields below: name, description, IP"}),layoutTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.layout.title",{defaultMessage:"Assigned host isolation exceptions"}),layoutAssignButtonTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.layout.assignToPolicy",{defaultMessage:"Assign host isolation exceptions to policy"}),layoutViewAllLinkMessage:z.i18n.translate("xpack.securitySolution.endpoint.policy.hostIsolationException.layout.about.viewAllLinkLabel",{defaultMessage:"view all host isolation exceptions"})}),_I=Object.freeze({deleteModalTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.list.removeDialog.title",{defaultMessage:"Remove blocklist entry from policy"}),deleteModalImpactInfo:z.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.list.removeDialog.messageCallout",{defaultMessage:"This blocklist entry will be removed only from this policy and can still be found and managed from the artifact page."}),deleteModalErrorMessage:z.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.list.removeDialog.errorToastTitle",{defaultMessage:"Error while attempting to remove blocklist entry"}),flyoutWarningCalloutMessage:e=>z.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.layout.flyout.searchWarning.text",{defaultMessage:"Only the first {maxNumber} blocklist entries are displayed. Please use the search bar to refine the results.",values:{maxNumber:e}}),flyoutNoArtifactsToBeAssignedMessage:z.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.layout.flyout.noAssignable",{defaultMessage:"There are no blocklist entries that can be assigned to this policy."}),flyoutTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.layout.flyout.title",{defaultMessage:"Assign blocklist entries"}),flyoutSubtitle:e=>z.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.layout.flyout.subtitle",{defaultMessage:"Select blocklist entries to add to {policyName}",values:{policyName:e}}),flyoutSearchPlaceholder:z.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.layout.search.label",{defaultMessage:"Search blocklist entries"}),flyoutErrorMessage:z.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.layout.flyout.toastError.text",{defaultMessage:"An error occurred updating blocklist entry"}),flyoutSuccessMessageText:e=>e.length>1?z.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.layout.flyout.toastSuccess.textMultiples",{defaultMessage:"{count} blocklist entries have been added to your list.",values:{count:e.length}}):z.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.layout.flyout.toastSuccess.textSingle",{defaultMessage:'"{name}" blocklist has been added to your list.',values:{name:e[0].name}}),emptyUnassignedTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.empty.unassigned.title",{defaultMessage:"No assigned blocklist entries"}),emptyUnassignedMessage:e=>z.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.empty.unassigned.content",{defaultMessage:"There are currently no blocklist entries assigned to {policyName}. Assign blocklist entries now or add and manage them on the blocklist page.",values:{policyName:e}}),emptyUnassignedPrimaryActionButtonTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.empty.unassigned.primaryAction",{defaultMessage:"Assign blocklist entry"}),emptyUnassignedSecondaryActionButtonTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.empty.unassigned.secondaryAction",{defaultMessage:"Manage blocklist entries"}),emptyUnexistingTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.empty.unexisting.title",{defaultMessage:"No blocklists entries exist"}),emptyUnexistingMessage:z.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.empty.unexisting.content",{defaultMessage:"There are currently no blocklist entries applied to your endpoints."}),emptyUnexistingPrimaryActionButtonTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.empty.unexisting.action",{defaultMessage:"Add blocklist entry"}),listTotalItemCountMessage:e=>z.i18n.translate("xpack.securitySolution.endpoint.policy.blocklists.list.totalItemCount",{defaultMessage:"Showing {totalItemsCount, plural, one {# blocklist entry} other {# blocklist entries}}",values:{totalItemsCount:e}}),listRemoveActionNotAllowedMessage:z.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.list.removeActionNotAllowed",{defaultMessage:"Globally applied blocklist cannot be removed from policy."}),listSearchPlaceholderMessage:z.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.list.search.placeholder",{defaultMessage:"Search on the fields below: name, description, value"}),layoutTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.layout.title",{defaultMessage:"Assigned blocklist entries"}),layoutAssignButtonTitle:z.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.layout.assignToPolicy",{defaultMessage:"Assign blocklist entry to policy"}),layoutViewAllLinkMessage:z.i18n.translate("xpack.securitySolution.endpoint.policy.blocklist.layout.about.viewAllLinkLabel",{defaultMessage:"view all blocklist entries"})});var NI,RI=a(894),PI=a(418),LI=a(896),BI=a(428),qI=a(895),zI=a(290),$I=a(523),VI=a(1066);!function(e){e.SETTINGS="settings",e.TRUSTED_APPS="trustedApps",e.EVENT_FILTERS="eventFilters",e.HOST_ISOLATION_EXCEPTIONS="hostIsolationExceptions",e.BLOCKLISTS="blocklists"}(NI||(NI={}));const UI=i.a.memo((()=>{var e;const t=Object(P.useHistory)(),a=Object(p.j)(),r=Object(YT.c)(JT.j),s=Object(YT.c)(JT.k),o=Object(YT.c)(JT.i),l=Object(YT.c)(JT.h),c=Object(YT.c)(JT.g),u=Object(YT.c)(JT.o),d=Object(YT.c)(JT.m),m=Object(pd.a)().endpointPrivileges,{state:g={}}=Object(P.useLocation)(),b=Object(tI.e)(BI.a.getInstance(a),{page:1,perPage:100,policies:[u,"all"]},$I.b,{enabled:!m.loading&&!m.canIsolateHost}),f=m.canIsolateHost||b.isFetched&&0!==(null===(e=b.data)||void 0===e?void 0:e.total);Object(n.useEffect)((()=>{l&&!f&&t.replace(Object(h.j)(u))}),[f,t,l,u]);const y=Object(n.useCallback)((()=>RI.a.getInstance(a)),[a]),E=Object(n.useCallback)((()=>PI.a.getInstance(a)),[a]),v=Object(n.useCallback)((()=>BI.a.getInstance(a)),[a]),x=Object(n.useCallback)((()=>LI.a.getInstance(a)),[a]),k=Object(n.useMemo)((()=>{const e={...DI,layoutAboutMessage:(e,t)=>i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.trustedApps.list.about",defaultMessage:"There {count, plural, one {is} other {are}} {count} trusted {count, plural, =1 {application} other {applications}} associated with this policy. Click here to {link}",values:{count:e,link:t}})},t={...FI,layoutAboutMessage:(e,t)=>i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.eventFilters.list.about",defaultMessage:"There {count, plural, one {is} other {are}} {count} event {count, plural, =1 {filter} other {filters}} associated with this policy. Click here to {link}",values:{count:e,link:t}})},a={...AI,layoutAboutMessage:(e,t)=>i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.hostIsolationExceptions.list.about",defaultMessage:"There {count, plural, one {is} other {are}} {count} host isolation {count, plural, =1 {exception} other {exceptions}} associated with this policy. Click here to {link}",values:{count:e,link:t}})},n={..._I,layoutAboutMessage:(e,t)=>i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.blocklist.list.about",defaultMessage:"There {count, plural, one {is} other {are}} {count} {count, plural, =1 {blocklist} other {blocklist entries}} associated with this policy. Click here to {link}",values:{count:e,link:t}})};return{[NI.SETTINGS]:{id:NI.SETTINGS,name:z.i18n.translate("xpack.securitySolution.endpoint.policy.details.tabs.policyForm",{defaultMessage:"Policy settings"}),content:i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiSpacer,null),i.a.createElement(MI,null))},[NI.TRUSTED_APPS]:{id:NI.TRUSTED_APPS,name:z.i18n.translate("xpack.securitySolution.endpoint.policy.details.tabs.trustedApps",{defaultMessage:"Trusted applications"}),content:i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiSpacer,null),i.a.createElement(TI,{policyItem:d,labels:e,getExceptionsListApiClient:y,searchableFields:qI.a,getArtifactPath:h.o,getPolicyArtifactsPath:h.k}))},[NI.EVENT_FILTERS]:{id:NI.EVENT_FILTERS,name:z.i18n.translate("xpack.securitySolution.endpoint.policy.details.tabs.eventFilters",{defaultMessage:"Event filters"}),content:i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiSpacer,null),i.a.createElement(TI,{policyItem:d,labels:t,getExceptionsListApiClient:E,searchableFields:zI.d,getArtifactPath:h.f,getPolicyArtifactsPath:h.l}))},[NI.HOST_ISOLATION_EXCEPTIONS]:f?{id:NI.HOST_ISOLATION_EXCEPTIONS,name:z.i18n.translate("xpack.securitySolution.endpoint.policy.details.tabs.isInHostIsolationExceptions",{defaultMessage:"Host isolation exceptions"}),content:i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiSpacer,null),i.a.createElement(TI,{policyItem:d,labels:a,getExceptionsListApiClient:v,searchableFields:$I.b,getArtifactPath:h.g,getPolicyArtifactsPath:h.m,externalPrivileges:m.canIsolateHost}))}:void 0,[NI.BLOCKLISTS]:{id:NI.BLOCKLISTS,name:z.i18n.translate("xpack.securitySolution.endpoint.policy.details.tabs.blocklists",{defaultMessage:"Blocklist"}),content:i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiSpacer,null),i.a.createElement(TI,{policyItem:d,labels:n,getExceptionsListApiClient:x,searchableFields:VI.b,getArtifactPath:h.c,getPolicyArtifactsPath:h.i}))}}}),[f,E,v,x,y,d,m.canIsolateHost]),S=Object(n.useMemo)((()=>Object.values(k).filter((e=>void 0!==e))),[k]),j=Object(n.useMemo)((()=>{const e=k[NI.SETTINGS];let t;return r?t=k[NI.SETTINGS]:s?t=k[NI.TRUSTED_APPS]:o?t=k[NI.EVENT_FILTERS]:l?t=k[NI.HOST_ISOLATION_EXCEPTIONS]:c&&(t=k[NI.BLOCKLISTS]),t||e}),[k,r,s,o,l,c]),O=Object(n.useCallback)((e=>{let a="";switch(e.id){case NI.SETTINGS:a=Object(h.j)(u);break;case NI.TRUSTED_APPS:a=Object(h.n)(u);break;case NI.EVENT_FILTERS:a=Object(h.l)(u);break;case NI.HOST_ISOLATION_EXCEPTIONS:a=Object(h.m)(u);break;case NI.BLOCKLISTS:a=Object(h.i)(u)}t.push(a,null!=g&&g.backLink?{backLink:g.backLink}:null)}),[t,u,g]);return l&&(m.loading||b.isFetching)?i.a.createElement(ZT.a,{"data-test-subj":"policyHostIsolationExceptionsTabLoading"}):i.a.createElement(V.EuiTabbedContent,{tabs:S,selectedTab:j,size:"l",onTabClick:O})}));UI.displayName="PolicyTabs";const HI=i.a.memo((()=>{var e,t,a,r,o,l;const c=Object(B.a)("policyListEnabled"),{state:u={}}=Object(P.useLocation)(),{getAppUrl:d}=Object(p.d)(),m=Object(YT.c)(JT.b),g=Object(YT.c)(JT.m),b=Object(YT.c)(JT.a),f=null!==(e=null==g?void 0:g.name)&&void 0!==e?e:"",y=null!==(t=null==g?void 0:g.description)&&void 0!==t?t:void 0,E=Object(n.useMemo)((()=>{if(null!=u&&u.backLink)return{onBackButtonNavigateTo:u.backLink.navigateTo,backButtonLabel:u.backLink.label,backButtonUrl:u.backLink.href};if(c){const e=Object(h.h)();return{backButtonLabel:z.i18n.translate("xpack.securitySolution.policyDetails.backToPolicyButton",{defaultMessage:"Back to policy list"}),backButtonUrl:d({path:e}),onBackButtonNavigateTo:[s.B,{path:e}]}}{const e=Object(h.e)({name:"endpointList"});return{backButtonLabel:z.i18n.translate("xpack.securitySolution.policyDetails.backToEndpointList",{defaultMessage:"View all endpoints"}),backButtonUrl:d({path:e}),onBackButtonNavigateTo:[s.B,{path:e}]}}}),[d,null==u?void 0:u.backLink,c]),v=i.a.createElement(XT,{total:null!==(a=null==b?void 0:b.total)&&void 0!==a?a:0,online:null!==(r=null==b?void 0:b.online)&&void 0!==r?r:0,offline:null!==(o=null==b?void 0:b.offline)&&void 0!==o?o:0,error:null!==(l=null==b?void 0:b.error)&&void 0!==l?l:0}),x=i.a.createElement(BT.a,lr()({},E,{"data-test-subj":"policyDetailsBackLink"})),k=Object(n.useMemo)((()=>m?i.a.createElement(V.EuiPageTemplate_Deprecated,{template:"centeredContent"},i.a.createElement(V.EuiCallOut,{color:"danger",title:null==m?void 0:m.error},i.a.createElement("span",{"data-test-subj":"policyDetailsIdNotFoundMessage"},null==m?void 0:m.message))):g?i.a.createElement(UI,null):i.a.createElement(V.EuiPageTemplate_Deprecated,{template:"centeredContent"},i.a.createElement(V.EuiLoadingSpinner,{className:"essentialAnimation",size:"xl","data-test-subj":"policyDetailsLoading"}))),[m,g]);return i.a.createElement(NT.a,{"data-test-subj":"policyDetailsPage",title:f,subtitle:y,headerBackComponent:x,actions:m?void 0:v,restrictWidth:!0,hasBottomBorder:!1},k)}));HI.displayName="PolicyDetails",a(1071);const GI=Object(n.memo)((()=>{const e=Object(B.a)("policyListEnabled");return i.a.createElement(P.Switch,null,i.a.createElement(L.Route,{path:[Ww.n,Ww.q,Ww.m,Ww.o,Ww.l],exact:!0,component:HI}),i.a.createElement(L.Route,{path:Ww.p,exact:!0,render:e=>i.a.createElement(P.Redirect,{to:Object(h.j)(e.match.params.policyId)})}),e&&i.a.createElement(L.Route,{path:Ww.k,exact:!0,component:KT}),i.a.createElement(L.Route,{path:"*",component:q.a}))}));GI.displayName="PolicyContainer";var QI=a(692),WI=a(132);const KI=[32,40,64],YI=/[^0-9a-f]/i,JI=e=>KI.includes(e.length)&&!YI.test(e),XI=e=>e.field!==WI.a.SIGNER,ZI=z.i18n.translate("xpack.securitySolution.trustedApps.name.label",{defaultMessage:"Name"}),eC=z.i18n.translate("xpack.securitySolution.trustedApps.details.header",{defaultMessage:"Details"}),tC=z.i18n.translate("xpack.securitySolution.trustedApps.details.header.description",{defaultMessage:"Add a trusted application to improve performance or alleviate conflicts with other applications running on your hosts. Trusted applications may still generate alerts in some cases."}),aC=z.i18n.translate("xpack.securitySolution.trustedapps.create.description",{defaultMessage:"Description"}),nC=z.i18n.translate("xpack.securitySolution.trustedApps.conditions.header",{defaultMessage:"Conditions"}),iC=z.i18n.translate("xpack.securitySolution.trustedApps.conditions.header.description",{defaultMessage:"Select an operating system and add conditions. Availability of conditions may depend on your chosen OS."}),rC=z.i18n.translate("xpack.securitySolution.trustedApps.os.label",{defaultMessage:"Select operating system"}),sC={[WI.a.HASH]:z.i18n.translate("xpack.securitySolution.trustedapps.logicalConditionBuilder.entry.field.hash",{defaultMessage:"Hash"}),[WI.a.PATH]:z.i18n.translate("xpack.securitySolution.trustedapps.logicalConditionBuilder.entry.field.path",{defaultMessage:"Path"}),[WI.a.SIGNER]:z.i18n.translate("xpack.securitySolution.trustedapps.logicalConditionBuilder.entry.field.signature",{defaultMessage:"Signature"})},oC={[WI.a.HASH]:z.i18n.translate("xpack.securitySolution.trustedapps.logicalConditionBuilder.entry.field.description.hash",{defaultMessage:"md5, sha1, or sha256"}),[WI.a.PATH]:z.i18n.translate("xpack.securitySolution.trustedapps.logicalConditionBuilder.entry.field.description.path",{defaultMessage:"The full path of the application"}),[WI.a.SIGNER]:z.i18n.translate("xpack.securitySolution.trustedapps.logicalConditionBuilder.entry.field.description.signature",{defaultMessage:"The signer of the application"})},lC={is:z.i18n.translate("xpack.securitySolution.trustedapps.card.operator.is",{defaultMessage:"is"}),matches:z.i18n.translate("xpack.securitySolution.trustedapps.card.operator.matches",{defaultMessage:"matches"})},cC={field:z.i18n.translate("xpack.securitySolution.trustedapps.trustedapp.entry.field",{defaultMessage:"Field"}),operator:z.i18n.translate("xpack.securitySolution.trustedapps.trustedapp.entry.operator",{defaultMessage:"Operator"}),value:z.i18n.translate("xpack.securitySolution.trustedapps.trustedapp.entry.value",{defaultMessage:"Value"})},uC=z.i18n.translate("xpack.securitySolution.trustedApps.assignmentSectionDescription",{defaultMessage:"Assign this trusted application globally across all policies, or assign it to specific policies."}),dC={name:z.i18n.translate("xpack.securitySolution.trustedapps.create.nameRequiredMsg",{defaultMessage:"Name is required"}),os:z.i18n.translate("xpack.securitySolution.trustedapps.create.osRequiredMsg",{defaultMessage:"Operating System is required"}),field:z.i18n.translate("xpack.securitySolution.trustedapps.create.conditionRequiredMsg",{defaultMessage:"At least one Field definition is required"}),noDuplicateField:e=>z.i18n.translate("xpack.securitySolution.trustedapps.create.conditionFieldDuplicatedMsg",{defaultMessage:"{field} cannot be added more than once",values:{field:sC[e]}}),mustHaveValue:e=>z.i18n.translate("xpack.securitySolution.trustedapps.create.conditionFieldValueRequiredMsg",{defaultMessage:"[{row}] Field entry must have a value",values:{row:e+1}}),invalidHash:e=>z.i18n.translate("xpack.securitySolution.trustedapps.create.conditionFieldInvalidHashMsg",{defaultMessage:"[{row}] Invalid hash value",values:{row:e+1}}),pathWarning:e=>z.i18n.translate("xpack.securitySolution.trustedapps.create.conditionFieldInvalidPathMsg",{defaultMessage:"[{row}] Path may be formed incorrectly; verify value",values:{row:e+1}}),wildcardPathWarning:e=>z.i18n.translate("xpack.securitySolution.trustedapps.create.conditionFieldDegradedPerformanceMsg",{defaultMessage:"[{row}] A wildcard in the filename will affect the endpoint's performance",values:{row:e+1}})};var pC=a(279),mC=a(421),gC=a(142);const bC=({os:e,field:t,type:a})=>{if(t===WI.a.PATH)return e===WI.c.WINDOWS?"wildcard"===a?"C:\\sample\\*\\path.exe":"C:\\sample\\path.exe":"wildcard"===a?"/opt/*/app":"/opt/bin"},fC=Object(n.memo)((({showLabel:e,label:t="",children:a})=>e?i.a.createElement(V.EuiFormRow,{label:t,fullWidth:!0},a):i.a.createElement(i.a.Fragment,null,a)));fC.displayName="ConditionEntryCell";const yC=H.a.div.withConfig({displayName:"InputGroup",componentId:"sc-1yk4mi3-0"})(["display:grid;grid-template-columns:25% 25% 45% 5%;grid-template-areas:'field operator value remove';"]),hC=H.a.div.withConfig({displayName:"InputItem",componentId:"sc-1yk4mi3-1"})(["grid-area:",";align-self:center;margin:4px;vertical-align:baseline;"],(({gridArea:e})=>e)),EC=Object.keys(gC.c).map((e=>({dropdownDisplay:lC[e],inputDisplay:lC[e],value:"matches"===e?"wildcard":"match"}))),vC=Object(n.memo)((({os:e,entry:t,showLabels:a=!1,onRemove:r,onChange:s,isRemoveDisabled:o=!1,onVisited:l,"data-test-subj":c})=>{const u=Object(dI.a)(c),[d,p]=Object(n.useState)(!1),m=Object(n.useCallback)((()=>{null==l||l(t),d||p(!0)}),[t,d,l]),g=Object(n.useMemo)((()=>{const t=e=>i.a.createElement(i.a.Fragment,null,sC[e],i.a.createElement(V.EuiText,{size:"xs",color:"subdued"},oC[e]));return[{dropdownDisplay:t(WI.a.HASH),inputDisplay:sC[WI.a.HASH],value:WI.a.HASH},{dropdownDisplay:t(WI.a.PATH),inputDisplay:sC[WI.a.PATH],value:WI.a.PATH},...e===WI.c.WINDOWS?[{dropdownDisplay:t(WI.a.SIGNER),inputDisplay:sC[WI.a.SIGNER],value:WI.a.SIGNER}]:[]]}),[e]),b=Object(n.useCallback)((e=>s({...t,value:e.target.value},t)),[t,s]),f=Object(n.useCallback)((e=>{s({...t,field:e},t),t.value&&m()}),[m,t,s]),y=Object(n.useCallback)((e=>s({...t,type:e},t)),[t,s]),h=Object(n.useCallback)((()=>r(t)),[t,r]),E=Object(n.useCallback)((()=>{m()}),[m]);return i.a.createElement(yC,{"data-test-subj":c},i.a.createElement(hC,{gridArea:"field"},i.a.createElement(fC,{showLabel:a,label:cC.field},i.a.createElement(V.EuiSuperSelect,{options:g,valueOfSelected:t.field,onChange:f,"data-test-subj":u("field")}))),i.a.createElement(hC,{gridArea:"operator"},i.a.createElement(fC,{showLabel:a,label:cC.operator},t.field===WI.a.PATH?i.a.createElement(V.EuiSuperSelect,{options:EC,onChange:y,valueOfSelected:t.type,"data-test-subj":u("operator")}):i.a.createElement(V.EuiFieldText,{name:"operator",value:lC.is,"data-test-subj":u("operator"),readOnly:!0}))),i.a.createElement(hC,{gridArea:"value"},i.a.createElement(fC,{showLabel:a,label:cC.value},i.a.createElement(V.EuiFieldText,{name:"value",value:t.value,placeholder:bC({os:e,field:t.field,type:t.type}),fullWidth:!0,required:d,onChange:b,onBlur:E,"data-test-subj":u("value")}))),i.a.createElement(hC,{gridArea:"remove"},i.a.createElement(fC,{showLabel:a,label:" "},i.a.createElement(V.EuiButtonIcon,{color:"danger",iconType:"trash",onClick:h,isDisabled:o,"aria-label":z.i18n.translate("xpack.securitySolution.trustedapps.logicalConditionBuilder.entry.removeLabel",{defaultMessage:"Remove Entry"}),"data-test-subj":u("remove")}))))}));vC.displayName="ConditionEntryInput";const xC=H()(V.EuiFlexGroup).withConfig({displayName:"ConditionGroupFlexGroup",componentId:"sc-7xprc5-0"})([".and-badge{padding-top:20px;padding-bottom:",";}.group-entries{margin-bottom:",";& > *{margin-bottom:",";&:last-child{margin-bottom:0;}}}.and-button{min-width:95px;}"],(({theme:e})=>`calc(${e.eui.euiButtonHeightSmall} + (${e.eui.euiSizeS} * 2) + 3px);`),(({theme:e})=>e.eui.euiSizeS),(({theme:e})=>e.eui.euiSizeS)),kC=Object(n.memo)((({os:e,entries:t,onEntryRemove:a,onEntryChange:n,onAndClicked:r,isAndDisabled:s,onVisited:o,"data-test-subj":l})=>{const c=Object(dI.a)(l);return i.a.createElement(xC,{gutterSize:"xs","data-test-subj":l},t.length>1&&i.a.createElement(V.EuiHideFor,{sizes:["xs","s"]},i.a.createElement(V.EuiFlexItem,{grow:!1,"data-test-subj":c("andConnector"),className:"and-badge"},i.a.createElement(mC.a,{type:"and",includeAntennas:!0}))),i.a.createElement(V.EuiFlexItem,{grow:1},i.a.createElement("div",{"data-test-subj":c("entries"),className:"group-entries"},t.map(((r,s)=>i.a.createElement(vC,{key:s,os:e,entry:r,showLabels:0===s,isRemoveDisabled:0===s&&t.length<=1,onRemove:a,onChange:n,onVisited:o,"data-test-subj":c(`entry${s}`)})))),i.a.createElement("div",null,i.a.createElement(V.EuiSpacer,{size:"s"}),i.a.createElement(V.EuiButton,{size:"s",iconType:"plusInCircle",onClick:r,"data-test-subj":c("AndButton"),isDisabled:s,className:"and-button"},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.trustedapps.logicalConditionBuilder.group.andOperator",defaultMessage:"AND"})))))}));kC.displayName="ConditionGroup";const SC=Object(n.memo)((({entries:e,os:t,className:a,isAndDisabled:n=!1,onAndClicked:r,onEntryRemove:s,onEntryChange:o,onVisited:l,"data-test-subj":c})=>{const u=Object(dI.a)(c);return i.a.createElement("div",{"data-test-subj":c,className:a},i.a.createElement("div",null,0===e.length?i.a.createElement(jC,null):i.a.createElement(kC,{os:t,entries:e,onEntryRemove:s,onEntryChange:o,onAndClicked:r,isAndDisabled:n,onVisited:l,"data-test-subj":u("group1")})))}));SC.displayName="LogicalConditionBuilder";const jC=Object(n.memo)((()=>i.a.createElement(V.EuiPanel,{paddingSize:"l"},i.a.createElement(V.EuiText,{textAlign:"center",size:"s",color:"subdued"},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.trustedapps.logicalConditionBuilder.noEntries",defaultMessage:"No conditions defined"})))));jC.displayName="NoEntries";var OC=a(721);const wC=Object(n.memo)((()=>{const{docLinks:{links:{securitySolution:e}}}=Object(p.k)().services;return i.a.createElement(i.a.Fragment,null,i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.trustedApps.docsLinkInfoStart",defaultMessage:"Have too many alerts? Add an "}),i.a.createElement(V.EuiLink,{target:"_blank",href:`${e.endpointArtifacts}`},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.trustedApps.docsLinkText",defaultMessage:"endpoint alert exception"})),i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.trustedApps.docsLinkInfoEnd",defaultMessage:" instead."}))}));wC.displayName="TrustedAppsArtifactsDocsLink";const TC=(e,t,a,n)=>{e.result[t]||(e.result[t]={isInvalid:!1,errors:[],warnings:[]});const r="warnings"===a?i.a.createElement("div",null,n):n;e.result[t][a].push(r),e.result[t].isInvalid=!0},IC=e=>{var t,a;let n=!0;const i={isValid:n,result:{}};e.name.trim()||(n=!1,TC(i,"name","errors",dC.name)),e.os_types||(n=!1,TC(i,"os","errors",dC.os));const r=null!==(t=(null!==(a=e.os_types)&&void 0!==a?a:[])[0])&&void 0!==t?t:WI.c.WINDOWS;if(e.entries.length){const t=(e=>{const t=new Map;return e.forEach((e=>{const a=e.field.startsWith("process.hash")?WI.a.HASH:e.field;t.set(a,[...t.get(a)||[],e])})),[...t.entries()].filter((e=>e[1].length>1)).map((e=>e[0]))})(e.entries);t.length&&(n=!1,t.forEach((e=>{TC(i,"entries","errors",dC.noDuplicateField(e))}))),e.entries.forEach(((e,t)=>{const a=Object(WI.f)({os:r,field:e.field,type:e.type,value:e.value});e.field&&e.value.trim()?e.field!==WI.a.HASH||JI(e.value)?a?a&&!Object(WI.e)({os:r,value:e.value,type:e.type})&&TC(i,"entries","warnings",dC.wildcardPathWarning(t)):TC(i,"entries","warnings",dC.pathWarning(t)):(n=!1,TC(i,"entries","errors",dC.invalidHash(t))):(n=!1,TC(i,"entries","errors",dC.mustHaveValue(t)))}))}else n=!1,TC(i,"entries","errors",dC.field);return i.isValid=n,i},CC=()=>({field:WI.a.HASH,operator:"included",type:"match",value:""}),MC=Object(n.memo)((({item:e,policies:t,policiesIsLoading:a,onChange:r,mode:s})=>{var o,l,c,u,d,p,m;const g=Object(dI.a)("trustedApps-form"),[b,f]=Object(n.useState)({}),[y,h]=Object(n.useState)([]),E=Object(Ku.b)().isPlatinumPlus(),v=Object(n.useMemo)((()=>Object(kI.e)(e)),[e]),[x,k]=Object(n.useState)(!Object(fI.d)(e.tags)),[S,j]=Object(n.useState)(!1);Object(n.useEffect)((()=>{!S&&e.tags&&k(!Object(fI.d)(e.tags))}),[e.tags,S]),Object(n.useEffect)((()=>{if(S)return;const a=e.tags?Object(kI.c)({tags:e.tags}):[];if(!a.length)return;const n=t.filter((e=>a.includes(e.id)));h(n)}),[S,e,t]);const O=Object(n.useMemo)((()=>E||"edit"===s&&(!v||x&&v&&S)),[s,v,S,E,x]),[w,T]=Object(n.useState)((()=>IC(e))),I=Object(n.useCallback)((e=>{const t=IC(e);T(t),r({item:e,isValid:t.isValid})}),[r]),C=Object(n.useCallback)((t=>{const a=t.isGlobal?[Ni.d]:t.selected.map((e=>`${Ni.b}${e.id}`)),n={...e,tags:a};t.isGlobal||h(t.selected),I(n),j(!0)}),[e,I]),M=Object(n.useCallback)((t=>{const a={...e,[t.target.name]:t.target.value};I(a),j(!0)}),[e,I]),F=Object(n.useCallback)((({target:{name:t}})=>{I(e),f((e=>({...e,[t]:!0})))}),[e,I]),D=Object(n.useMemo)((()=>[WI.c.LINUX,WI.c.MAC,WI.c.WINDOWS].map((e=>({value:e,inputDisplay:pC.a[e]})))),[]),A=Object(n.useCallback)((t=>{f((e=>({...e,os:!0})));const a={...e,os_types:[t],entries:[]};if(t!==WI.c.WINDOWS){const t=e.entries.filter((e=>XI(e)));a.entries.push(...t),0===e.entries.length&&a.entries.push(CC())}else a.entries.push(...e.entries);I(a),j(!0)}),[e,I]),_=Object(n.useCallback)((()=>{f((e=>({...e,entries:!0})))}),[]),N=Object(n.useCallback)(((t,a)=>{const n={...e,entries:e.entries.map((e=>e===a?t:e))};I(n),j(!0)}),[e,I]),R=Object(n.useCallback)((t=>{const a={...e,entries:e.entries.filter((e=>e!==t))};I(a),j(!0)}),[e,I]),P=Object(n.useCallback)((()=>{var t,a;const n={...e,entries:[]};(null!==(t=(null!==(a=e.os_types)&&void 0!==a?a:[])[0])&&void 0!==t?t:WI.c.WINDOWS)===WI.c.WINDOWS?n.entries=[...e.entries,CC()].filter((e=>e.field===WI.a.SIGNER||!0)):n.entries=[...e.entries.filter((e=>XI(e))),CC()],I(n),j(!0)}),[e,I]),L=Object(n.useMemo)((()=>{var t;return null!=e&&null!==(t=e.os_types)&&void 0!==t&&t.length?e.os_types[0]:WI.c.WINDOWS}),[null==e?void 0:e.os_types]),B=Object(n.useMemo)((()=>{const t=e;return t.entries=e.entries.length?e.entries:[CC()],t}),[e]);return i.a.createElement(V.EuiForm,{component:"div","data-test-subj":g("")},i.a.createElement(V.EuiTitle,{size:"xs"},i.a.createElement("h3",null,eC)),i.a.createElement(V.EuiSpacer,{size:"xs"}),"create"===s&&i.a.createElement(V.EuiText,{size:"s","data-test-subj":g("about")},i.a.createElement("p",null,tC,i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiSpacer,{size:"m"}),i.a.createElement(wC,null)))),i.a.createElement(V.EuiSpacer,{size:"m"}),i.a.createElement(V.EuiFormRow,{label:ZI,fullWidth:!0,"data-test-subj":g("nameRow"),isInvalid:b.name&&(null===(o=w.result.name)||void 0===o?void 0:o.isInvalid),error:null===(l=w.result.name)||void 0===l?void 0:l.errors},i.a.createElement(V.EuiFieldText,{name:"name",value:e.name,onChange:M,onBlur:F,fullWidth:!0,required:b.name,maxLength:256,"data-test-subj":g("nameTextField")})),i.a.createElement(V.EuiFormRow,{label:aC,fullWidth:!0,"data-test-subj":g("descriptionRow")},i.a.createElement(V.EuiTextArea,{name:"description",value:e.description,onChange:M,fullWidth:!0,compressed:!0,maxLength:256,"data-test-subj":g("descriptionField")})),i.a.createElement(V.EuiHorizontalRule,null),i.a.createElement(V.EuiText,{size:"xs"},i.a.createElement("h3",null,nC)),i.a.createElement(V.EuiSpacer,{size:"xs"}),i.a.createElement(V.EuiText,{size:"s"},iC),i.a.createElement(V.EuiSpacer,{size:"m"}),i.a.createElement(V.EuiFormRow,{label:rC,fullWidth:!0,"data-test-subj":g("OsRow"),isInvalid:(null==b?void 0:b.os)&&(null===(c=w.result.os)||void 0===c?void 0:c.isInvalid),error:null===(u=w.result.os)||void 0===u?void 0:u.errors},i.a.createElement(V.EuiSuperSelect,{name:"os",options:D,valueOfSelected:L,onChange:A,fullWidth:!0,"data-test-subj":g("osSelectField")})),i.a.createElement(V.EuiFormRow,{fullWidth:!0,"data-test-subj":g("conditionsRow"),isInvalid:b.entries&&(null===(d=w.result.entries)||void 0===d?void 0:d.isInvalid),error:null===(p=w.result.entries)||void 0===p?void 0:p.errors,helpText:null===(m=w.result.entries)||void 0===m?void 0:m.warnings},i.a.createElement(SC,{entries:B.entries,os:L,onAndClicked:P,onEntryRemove:R,onEntryChange:N,onVisited:_,"data-test-subj":g("conditionsBuilder")})),O?i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiHorizontalRule,null),i.a.createElement(V.EuiFormRow,{fullWidth:!0,"data-test-subj":g("policySelection")},i.a.createElement(OC.a,{isGlobal:v,isPlatinumPlus:E,selected:y,options:t,onChange:C,isLoading:a,description:uC,"data-test-subj":g("effectedPolicies")}))):null)}));MC.displayName="TrustedAppsForm";const FC={pageTitle:z.i18n.translate("xpack.securitySolution.trustedApps.pageTitle",{defaultMessage:"Trusted applications"}),pageAboutInfo:z.i18n.translate("xpack.securitySolution.trustedApps.pageAboutInfo",{defaultMessage:"Add a trusted application to improve performance or alleviate conflicts with other applications running on your hosts. Trusted applications may still generate alerts in some cases."}),pageAddButtonTitle:z.i18n.translate("xpack.securitySolution.trustedApps.pageAddButtonTitle",{defaultMessage:"Add trusted application"}),getShowingCountLabel:e=>z.i18n.translate("xpack.securitySolution.trustedApps.showingTotal",{defaultMessage:"Showing {total} {total, plural, one {trusted application} other {trusted applications}}",values:{total:e}}),cardActionEditLabel:z.i18n.translate("xpack.securitySolution.trustedApps.cardActionEditLabel",{defaultMessage:"Edit trusted application"}),cardActionDeleteLabel:z.i18n.translate("xpack.securitySolution.trustedApps.cardActionDeleteLabel",{defaultMessage:"Delete trusted application"}),flyoutCreateTitle:z.i18n.translate("xpack.securitySolution.trustedApps.flyoutCreateTitle",{defaultMessage:"Add trusted application"}),flyoutEditTitle:z.i18n.translate("xpack.securitySolution.trustedApps.flyoutEditTitle",{defaultMessage:"Edit trusted application"}),flyoutCreateSubmitButtonLabel:z.i18n.translate("xpack.securitySolution.trustedApps.flyoutCreateSubmitButtonLabel",{defaultMessage:"Add trusted application"}),flyoutCreateSubmitSuccess:({name:e})=>z.i18n.translate("xpack.securitySolution.trustedApps.flyoutCreateSubmitSuccess",{defaultMessage:'"{name}" has been added to your trusted applications.',values:{name:e}}),flyoutEditSubmitSuccess:({name:e})=>z.i18n.translate("xpack.securitySolution.trustedApps.flyoutEditSubmitSuccess",{defaultMessage:'"{name}" has been updated.',values:{name:e}}),flyoutDowngradedLicenseDocsInfo:e=>i.a.createElement(i.a.Fragment,null,i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.trustedApps.flyoutDowngradedLicenseDocsInfo",defaultMessage:"For more information, see our "}),i.a.createElement(V.EuiLink,{target:"_blank",href:`${e.trustedApps}`},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.trustedApps.flyoutDowngradedLicenseDocsLink",defaultMessage:"Trusted applications documentation"}))),deleteActionSuccess:e=>z.i18n.translate("xpack.securitySolution.trustedApps.deleteSuccess",{defaultMessage:'"{itemName}" has been removed from trusted applications.',values:{itemName:e}}),emptyStateTitle:z.i18n.translate("xpack.securitySolution.trustedApps.emptyStateTitle",{defaultMessage:"Add your first trusted application"}),emptyStateInfo:z.i18n.translate("xpack.securitySolution.trustedApps.emptyStateInfo",{defaultMessage:"Add a trusted application to improve performance or alleviate conflicts with other applications running on your hosts. Trusted applications may still generate alerts in some cases."}),emptyStatePrimaryButtonLabel:z.i18n.translate("xpack.securitySolution.trustedApps.emptyStatePrimaryButtonLabel",{defaultMessage:"Add trusted application"}),searchPlaceholderInfo:z.i18n.translate("xpack.securitySolution.trustedApps.searchPlaceholderInfo",{defaultMessage:"Search on the fields below: name, description, value"})},DC=Object(n.memo)((()=>{const e=Object(p.j)(),t=RI.a.getInstance(e);return i.a.createElement(QI.a,{apiClient:t,ArtifactFormComponent:MC,labels:FC,"data-test-subj":"trustedAppsListPage",searchableFields:qI.a,secondaryPageInfo:i.a.createElement(wC,null)})}));DC.displayName="TrustedAppsList";const AC=Object(n.memo)((()=>i.a.createElement(P.Switch,null,i.a.createElement(L.Route,{path:Ww.s,exact:!0,component:DC}),i.a.createElement(L.Route,{path:"*",component:q.a}))));AC.displayName="TrustedAppsContainer";var _C=a(891);const NC=()=>i.a.createElement(P.Switch,null,i.a.createElement(L.Route,{path:Ww.i,exact:!0,component:_C.c}),i.a.createElement(L.Route,{path:"*",component:q.a}));var RC=a(23),PC=a(1266),LC=a.n(PC);const BC=z.i18n.translate("xpack.securitySolution.hostIsolationExceptions.form.name.placeholder",{defaultMessage:"Host isolation exception name"}),qC=z.i18n.translate("xpack.securitySolution.hostIsolationExceptions.form.name.label",{defaultMessage:"Name your host isolation exceptions"}),zC=z.i18n.translate("xpack.securitySolution.hostIsolationExceptions.form.name.error",{defaultMessage:"The name can't be empty"}),$C=z.i18n.translate("xpack.securitySolution.hostIsolationExceptions.form.description.placeholder",{defaultMessage:"Describe your host isolation exception"}),VC=z.i18n.translate("xpack.securitySolution.hostIsolationExceptions.form.description.label",{defaultMessage:"Description"}),UC=z.i18n.translate("xpack.securitySolution.hostIsolationExceptions.form.ip.placeholder",{defaultMessage:"Ex 0.0.0.0/24"}),HC=z.i18n.translate("xpack.securitySolution.hostIsolationExceptions.form.ip.label",{defaultMessage:"Enter IP Address"}),GC=z.i18n.translate("xpack.securitySolution.hostIsolationExceptions.form.ip.error",{defaultMessage:"The IP is invalid. Only IPv4 with optional CIDR is supported"});var QC=a(1089);const WC=Object(n.memo)((({item:e,onChange:t,policies:a,disabled:r,mode:s,error:o})=>{var l;const c=Object(n.useMemo)((()=>e.entries[0]||{field:"destination.ip",operator:"included",type:"match",value:""}),[e.entries]),[u,d]=Object(n.useState)(!1),[p,m]=Object(n.useState)(!1),[g,b]=Object(n.useState)(!e.name),[f,y]=Object(n.useState)(!c.value),[h,E]=Object(n.useState)({isGlobal:Object(fI.d)(e.tags),selected:[]}),v=Object(n.useMemo)((()=>!g&&!f),[f,g]),x=Object(n.useCallback)((a=>{t({item:a?{...e,...a}:e,isValid:v})}),[e,v,t]),k=Object(n.useCallback)((e=>{const t=e.target.value;t.trim()?b(!1):b(!0),x({name:t})}),[x]),S=Object(n.useCallback)((e=>{const t=e.target.value;!function(e){if(/^([0-9]{1,3}\.){3}[0-9]{1,3}(\/([0-9]|[1-2][0-9]|3[0-2]))?$/.test(e))try{return LC.a.IPv4.parseCIDR(e),!0}catch(t){return LC.a.IPv4.isValid(e)}return!1}(t)?y(!0):y(!1),x({entries:[{...c,value:t}]})}),[c,x]),j=Object(n.useCallback)((t=>{t.isGlobal?E({isGlobal:!0,selected:t.selected}):E(t),x({tags:Object(fI.a)(t,Object(fI.b)(e.tags))})}),[e.tags,x]),O=Object(n.useCallback)((e=>{x({description:e.target.value})}),[x]),w=Object(n.useMemo)((()=>{var t;return i.a.createElement(V.EuiFormRow,{label:qC,fullWidth:!0,isInvalid:g&&u,error:zC,isDisabled:r,"data-test-subj":"hostIsolationExceptions-form-name-input-formRow"},i.a.createElement(V.EuiFieldText,{id:"eventFiltersFormInputName",placeholder:BC,defaultValue:null!==(t=e.name)&&void 0!==t?t:"",onChange:k,fullWidth:!0,"aria-label":BC,required:u,maxLength:256,"data-test-subj":"hostIsolationExceptions-form-name-input",onBlur:()=>!u&&d(!0),disabled:r}))}),[r,e.name,k,u,g]),T=Object(n.useMemo)((()=>{var t,a,n;return i.a.createElement(V.EuiFormRow,{label:HC,fullWidth:!0,isInvalid:f&&p,error:GC,isDisabled:r,"data-test-subj":"hostIsolationExceptions-form-ip-input-formRow"},i.a.createElement(V.EuiFieldText,{id:"eventFiltersFormInputName",placeholder:UC,defaultValue:null!==(t=null===(a=e.entries)||void 0===a||null===(n=a[0])||void 0===n?void 0:n.value)&&void 0!==t?t:"",onChange:S,fullWidth:!0,"aria-label":UC,required:p,maxLength:256,"data-test-subj":"hostIsolationExceptions-form-ip-input",onBlur:()=>!p&&m(!0),disabled:r}))}),[r,e.entries,S,p,f]),I=Object(n.useMemo)((()=>{var t;return i.a.createElement(V.EuiFormRow,{label:VC,fullWidth:!0,isDisabled:r,"data-test-subj":"hostIsolationExceptions-form-description-input-formRow"},i.a.createElement(V.EuiTextArea,{id:"eventFiltersFormInputName",placeholder:$C,defaultValue:null!==(t=e.description)&&void 0!==t?t:"",onChange:O,fullWidth:!0,"data-test-subj":"hostIsolationExceptions-form-description-input","aria-label":$C,maxLength:256,disabled:r}))}),[r,e.description,O]);return Object(n.useEffect)((()=>{0===h.selected.length&&e.tags&&E(Object(fI.c)(e.tags,a))}),[e.tags,a,h.selected.length]),Object(n.useEffect)((()=>{x()}),[x]),Object(n.useEffect)((()=>{var t,a;"create"===s&&3!==(null!==(t=null===(a=e.os_types)||void 0===a?void 0:a.length)&&void 0!==t?t:0)&&x({os_types:["windows","linux","macos"]})}),[null===(l=e.os_types)||void 0===l?void 0:l.length,s,x]),i.a.createElement(V.EuiForm,{component:"div",error:o&&i.a.createElement(QC.a,{error:o}),isInvalid:!!o,"data-test-subj":"hostIsolationExceptions-form"},i.a.createElement(V.EuiTitle,{size:"xs"},i.a.createElement("h2",null,i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.hostIsolationExceptions.form.title",defaultMessage:"Details"}))),i.a.createElement(V.EuiText,{size:"s"},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.hostIsolationExceptions.form.description",defaultMessage:"Allows isolated hosts to connect to these IP addresses. Only accepts IPv4 with optional CIDR."})),i.a.createElement(V.EuiSpacer,{size:"m"}),w,I,i.a.createElement(V.EuiSpacer,{size:"m"}),i.a.createElement(V.EuiHorizontalRule,null),i.a.createElement(V.EuiTitle,{size:"xs"},i.a.createElement("h2",null,i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.hostIsolationExceptions.form.conditions.title",defaultMessage:"Conditions"}))),i.a.createElement(V.EuiText,{size:"s"},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.hostIsolationExceptions.form.conditions.subtitle",defaultMessage:"Host Isolation exceptions will apply to all operating systems."})),i.a.createElement(V.EuiSpacer,{size:"m"}),T,i.a.createElement(V.EuiHorizontalRule,null),i.a.createElement(V.EuiFormRow,{fullWidth:!0,"data-test-subj":"effectedPolicies-container",isDisabled:r},i.a.createElement(OC.a,{isGlobal:h.isGlobal,isPlatinumPlus:!0,selected:h.selected,options:a,onChange:j,"data-test-subj":"effectedPolicies-select",disabled:r})))}));WC.displayName="HostIsolationExceptionsForm";const KC=Object.freeze({pageTitle:z.i18n.translate("xpack.securitySolution.hostIsolationExceptions.pageTitle",{defaultMessage:"Host isolation exceptions"}),pageAboutInfo:z.i18n.translate("xpack.securitySolution.hostIsolationExceptions.pageAboutInfo",{defaultMessage:"Add a host isolation exception to allow isolated hosts to communicate with specific IPs."}),pageAddButtonTitle:z.i18n.translate("xpack.securitySolution.hostIsolationExceptions.pageAddButtonTitle",{defaultMessage:"Add host isolation exception"}),getShowingCountLabel:e=>z.i18n.translate("xpack.securitySolution.hostIsolationExceptions.showingTotal",{defaultMessage:"Showing {total} {total, plural, one {host isolation exception} other {host isolation exceptions}}",values:{total:e}}),cardActionEditLabel:z.i18n.translate("xpack.securitySolution.hostIsolationExceptions.cardActionEditLabel",{defaultMessage:"Edit exception"}),cardActionDeleteLabel:z.i18n.translate("xpack.securitySolution.hostIsolationExceptions.cardActionDeleteLabel",{defaultMessage:"Delete exception"}),flyoutCreateTitle:z.i18n.translate("xpack.securitySolution.hostIsolationExceptions.flyoutCreateTitle",{defaultMessage:"Add host isolation exception"}),flyoutEditTitle:z.i18n.translate("xpack.securitySolution.hostIsolationExceptions.flyoutEditTitle",{defaultMessage:"Edit host isolation exception"}),flyoutCreateSubmitButtonLabel:z.i18n.translate("xpack.securitySolution.hostIsolationExceptions.flyoutCreateSubmitButtonLabel",{defaultMessage:"Add host isolation exception"}),flyoutCreateSubmitSuccess:({name:e})=>z.i18n.translate("xpack.securitySolution.hostIsolationExceptions.flyoutCreateSubmitSuccess",{defaultMessage:'"{name}" has been added to your host isolation exception list.',values:{name:e}}),flyoutEditSubmitSuccess:({name:e})=>z.i18n.translate("xpack.securitySolution.hostIsolationExceptions.flyoutEditSubmitSuccess",{defaultMessage:'"{name}" has been updated.',values:{name:e}}),flyoutDowngradedLicenseDocsInfo:()=>null,deleteModalTitle:()=>z.i18n.translate("xpack.securitySolution.hostIsolationExceptions.deleteModtalTitle",{defaultMessage:"Delete host isolation exception"}),deleteActionSuccess:e=>z.i18n.translate("xpack.securitySolution.hostIsolationExceptions.deleteSuccess",{defaultMessage:'"{itemName}" has been removed from host isolation exception list.',values:{itemName:e}}),emptyStateTitle:z.i18n.translate("xpack.securitySolution.hostIsolationExceptions.emptyStateTitle",{defaultMessage:"Add your first host isolation exception"}),emptyStateInfo:z.i18n.translate("xpack.securitySolution.hostIsolationExceptions.emptyStateInfo",{defaultMessage:"Add a host isolation exception to allow isolated hosts to communicate with specific IPs."}),emptyStatePrimaryButtonLabel:z.i18n.translate("xpack.securitySolution.hostIsolationExceptions.emptyStatePrimaryButtonLabel",{defaultMessage:"Add host isolation exception"}),searchPlaceholderInfo:z.i18n.translate("xpack.securitySolution.hostIsolationExceptions.searchPlaceholderInfo",{defaultMessage:"Search on the fields below: name, description, IP"})}),YC=Object(n.memo)((()=>{const e=Object(p.j)(),t=BI.a.getInstance(e),a=Object(pd.a)().endpointPrivileges.canIsolateHost;return i.a.createElement(QI.a,{apiClient:t,ArtifactFormComponent:WC,labels:KC,"data-test-subj":"hostIsolationExceptionsListPage",searchableFields:$I.b,allowCardCreateAction:a,allowCardEditAction:a})}));YC.displayName="HostIsolationExceptionsList";const JC=Object(n.memo)((()=>Object(RC.i)(s.uc.hostIsolationExceptions)?i.a.createElement(P.Switch,null,i.a.createElement(L.Route,{path:Ww.j,exact:!0,component:YC}),i.a.createElement(L.Route,{path:"*",component:q.a})):i.a.createElement(P.Redirect,{to:s.wb})));JC.displayName="HostIsolationExceptionsContainer";var XC=a(1086),ZC=a(245);const eM=z.i18n.translate("xpack.securitySolution.blocklist.details.header",{defaultMessage:"Details"}),tM=z.i18n.translate("xpack.securitySolution.blocklist.details.header.description",{defaultMessage:"The blocklist prevents selected applications from running on your hosts by extending the list of processes the Endpoint considers malicious."}),aM=z.i18n.translate("xpack.securitySolution.blocklist.name.label",{defaultMessage:"Name"}),nM=z.i18n.translate("xpack.securitySolution.blocklist.description.label",{defaultMessage:"Description"}),iM=z.i18n.translate("xpack.securitySolution.blocklist.conditions.header",{defaultMessage:"Conditions"}),rM=z.i18n.translate("xpack.securitySolution.blocklist.conditions.header.description",{defaultMessage:"Select an operating system and add conditions. Availability of conditions may depend on your chosen OS."}),sM=z.i18n.translate("xpack.securitySolution.blocklist.os.label",{defaultMessage:"Select operating system"}),oM=z.i18n.translate("xpack.securitySolution.blocklist.field.label",{defaultMessage:"Field"}),lM=z.i18n.translate("xpack.securitySolution.blocklist.operator.label",{defaultMessage:"Operator"}),cM=z.i18n.translate("xpack.securitySolution.blocklist.value.label",{defaultMessage:"Value"}),uM=z.i18n.translate("xpack.securitySolution.blocklist.value.label.helper",{defaultMessage:"Type or copy & paste one or multiple comma delimited values"}),dM={"file.hash.*":z.i18n.translate("xpack.securitySolution.blocklist.entry.field.hash",{defaultMessage:"Hash"}),"file.path":z.i18n.translate("xpack.securitySolution.blocklist.entry.field.path",{defaultMessage:"Path"}),"file.Ext.code_signature":z.i18n.translate("xpack.securitySolution.blocklist.entry.field.signature",{defaultMessage:"Signature"})},pM={"file.hash.*":z.i18n.translate("xpack.securitySolution.blocklist.entry.field.description.hash",{defaultMessage:"md5, sha1, or sha256"}),"file.path":z.i18n.translate("xpack.securitySolution.blocklist.entry.field.description.path",{defaultMessage:"The full path of the application"}),"file.Ext.code_signature":z.i18n.translate("xpack.securitySolution.blocklist.entry.field.description.signature",{defaultMessage:"The signer of the application"})},mM=z.i18n.translate("xpack.securitySolution.blocklist.policyAssignmentSectionDescription",{defaultMessage:"Assign this blocklist globally across all policies, or assign it to specific policies."}),gM={NAME_REQUIRED:z.i18n.translate("xpack.securitySolution.blocklist.errors.name.required",{defaultMessage:"Name is required"}),VALUE_REQUIRED:z.i18n.translate("xpack.securitySolution.blocklist.errors.values.required",{defaultMessage:"Field entry must have a value"}),INVALID_HASH:z.i18n.translate("xpack.securitySolution.blocklist.errors.values.invalidHash",{defaultMessage:"Invalid hash value"}),INVALID_PATH:z.i18n.translate("xpack.securitySolution.blocklist.warnings.values.invalidPath",{defaultMessage:"Path may be formed incorrectly; verify value"}),WILDCARD_PRESENT:z.i18n.translate("xpack.securitySolution.blocklist.warnings.values.wildcardPresent",{defaultMessage:"A wildcard in the filename will affect the endpoint's performance"}),DUPLICATE_VALUE:z.i18n.translate("xpack.securitySolution.blocklist.warnings.values.duplicateValue",{defaultMessage:"This value already exists"}),DUPLICATE_VALUES:z.i18n.translate("xpack.securitySolution.blocklist.warnings.values.duplicateValues",{defaultMessage:"One or more duplicate values removed"})};function bM(e){return i.a.createElement("div",null,e)}function fM(e){return i.a.createElement(i.a.Fragment,null,dM[e],i.a.createElement(V.EuiText,{size:"xs",color:"subdued"},pM[e]))}function yM(e){return!Object.values(e).some((e=>Object.keys(e).length))}const hM=Object(n.memo)((({item:e,policies:t,policiesIsLoading:a,onChange:r,mode:s})=>{const[o,l]=Object(n.useState)({name:!1,value:!1}),c=Object(n.useRef)({name:{},value:{}}),u=Object(n.useRef)({name:{},value:{}}),[d,p]=Object(n.useState)([]),m=Object(Ku.b)().isPlatinumPlus(),g=Object(n.useMemo)((()=>Object(kI.e)(e)),[e]),[b,f]=Object(n.useState)(!Object(fI.d)(e.tags)),[y,h]=Object(n.useState)(!1),E=Object(n.useMemo)((()=>m||"edit"===s&&(!g||b&&g&&y)),[s,g,y,m,b]);Object(n.useEffect)((()=>{!y&&e.tags&&f(!Object(fI.d)(e.tags))}),[e.tags,y]),Object(n.useEffect)((()=>{var a,n;if(y)return;const i=null!==(a=null===(n=e.tags)||void 0===n?void 0:n.map((e=>e.split(":")[1])))&&void 0!==a?a:[];if(!i.length)return;const r=t.filter((e=>i.includes(e.id)));p(r)}),[y,e.tags,t]);const v=Object(dI.a)("blocklist-form"),x=Object(n.useMemo)((()=>e.entries.length?e.entries[0]:{field:"file.hash.*",operator:"included",type:"match_any",value:[]}),[e.entries]),k=Object(n.useMemo)((()=>{var t;return null!=e&&null!==(t=e.os_types)&&void 0!==t&&t.length?e.os_types[0]:WI.c.WINDOWS}),[null==e?void 0:e.os_types]),S=Object(n.useMemo)((()=>x.value.map((e=>({label:e,"data-test-subj":v(`values-input-${e}`)})))),[x.value,v]),j=Object(n.useMemo)((()=>[WI.c.LINUX,WI.c.MAC,WI.c.WINDOWS].map((e=>({value:e,inputDisplay:pC.a[e]})))),[]),O=Object(n.useMemo)((()=>{const e=["file.hash.*","file.path"].map((e=>({value:e,inputDisplay:dM[e],dropdownDisplay:fM(e),"data-test-subj":v(e)})));return k===WI.c.WINDOWS&&e.push({value:"file.Ext.code_signature",inputDisplay:dM["file.Ext.code_signature"],dropdownDisplay:fM("file.Ext.code_signature"),"data-test-subj":v("file.Ext.code_signature")}),e}),[k,v]),w=Object(n.useMemo)((()=>i.a.createElement("div",null,i.a.createElement(V.EuiToolTip,{content:uM},i.a.createElement(i.a.Fragment,null,cM," ",i.a.createElement(V.EuiIcon,{color:"subdued",type:"iInCircle",className:"eui-alignTop"}))))),[]),T=Object(n.useCallback)((e=>{var t,a,n;const i=null!==(t=(null!==(a=e.os_types)&&void 0!==a?a:[])[0])&&void 0!==t?t:WI.c.WINDOWS,{field:r="file.hash.*",type:s="match_any",value:o=[]}=null!==(n=e.entries[0])&&void 0!==n?n:{},l={},d={},p={};e.name.trim()||(d.NAME_REQUIRED=bM(gM.NAME_REQUIRED)),o.length||(p.VALUE_REQUIRED=bM(gM.VALUE_REQUIRED)),"file.hash.*"===r&&o.some((e=>!JI(e)))&&(p.INVALID_HASH=bM(gM.INVALID_HASH));const m=o.some((e=>!Object(WI.f)({os:i,field:r,type:s,value:e})));"file.hash.*"!==r&&m&&(l.INVALID_PATH=bM(gM.INVALID_PATH)),o.length!==Object(vE.uniq)(o).length&&(l.DUPLICATE_VALUES=bM(gM.DUPLICATE_VALUES)),c.current={...c.current,value:l},u.current={name:d,value:p}}),[]),I=Object(n.useCallback)((()=>{T(e),l((e=>({...e,name:!0})))}),[e,T]),C=Object(n.useCallback)((()=>{T(e),l((e=>({...e,value:!0})))}),[e,T]),M=Object(n.useCallback)((t=>{const a={...e,name:t.target.value};T(a),r({isValid:yM(u.current),item:a}),h(!0)}),[T,r,e]),F=Object(n.useCallback)((t=>{const a={...e,description:t.target.value};T(a),r({isValid:yM(u.current),item:a}),h(!0)}),[r,e,T]),D=Object(n.useCallback)((t=>{const a={...e,os_types:[t],entries:[{...x,field:t!==WI.c.WINDOWS&&"file.Ext.code_signature"===x.field?"file.hash.*":x.field}]};T(a),r({isValid:yM(u.current),item:a}),h(!0)}),[T,x,r,e]),A=Object(n.useCallback)((t=>{const a={...e,entries:[{...x,field:t}]};T(a),r({isValid:yM(u.current),item:a}),h(!0)}),[T,r,e,x]),_=Object(n.useCallback)((e=>{const t={...c.current.value};x.value.includes(e)?t.DUPLICATE_VALUE=bM(gM.DUPLICATE_VALUE):delete t.DUPLICATE_VALUE,c.current={...c.current,value:t},l((e=>({...e})))}),[x]),N=Object(n.useCallback)((t=>{const a=t.map((e=>e.label)),n={...e,entries:[{...x,value:a}]};T(n),r({isValid:yM(u.current),item:n}),h(!0)}),[T,r,e,x]),R=Object(n.useCallback)((t=>{const a=t.split(",").filter((e=>e.trim())),n=[...x.value,...a],i={...e,entries:[{...x,value:n}]};T(i),i.entries[0].value=Object(vE.uniq)(i.entries[0].value),l((e=>({...e,value:!0}))),r({isValid:yM(u.current),item:i}),h(!0)}),[T,r,e,x]),P=Object(n.useCallback)((t=>{const a=t.isGlobal?[Ni.d]:t.selected.map((e=>`${Ni.b}${e.id}`)),n={...e,tags:a};t.isGlobal||p(t.selected),T(n),r({isValid:yM(u.current),item:n}),h(!0)}),[T,r,e]);return i.a.createElement(V.EuiForm,{component:"div"},i.a.createElement(V.EuiTitle,{size:"xs"},i.a.createElement("h3",null,eM)),i.a.createElement(V.EuiSpacer,{size:"xs"}),"create"===s&&i.a.createElement(V.EuiText,{size:"s","data-test-subj":v("header-description")},i.a.createElement("p",null,tM)),i.a.createElement(V.EuiSpacer,{size:"m"}),i.a.createElement(V.EuiFormRow,{label:aM,isInvalid:o.name&&!!Object.keys(u.current.name).length,error:Object.values(u.current.name),fullWidth:!0},i.a.createElement(V.EuiFieldText,{name:"name",value:e.name,onChange:M,onBlur:I,required:o.name,maxLength:256,"data-test-subj":v("name-input"),fullWidth:!0})),i.a.createElement(V.EuiFormRow,{label:nM,fullWidth:!0},i.a.createElement(V.EuiTextArea,{name:"description",value:e.description,onChange:F,"data-test-subj":v("description-input"),fullWidth:!0,compressed:!0,maxLength:256})),i.a.createElement(V.EuiHorizontalRule,null),i.a.createElement(V.EuiTitle,{size:"xs"},i.a.createElement("h3",null,iM)),i.a.createElement(V.EuiSpacer,{size:"xs"}),i.a.createElement(V.EuiText,{size:"s"},i.a.createElement("p",null,rM)),i.a.createElement(V.EuiSpacer,{size:"m"}),i.a.createElement(V.EuiFormRow,{label:sM,fullWidth:!0},i.a.createElement(V.EuiSuperSelect,{name:"os",options:j,valueOfSelected:k,onChange:D,"data-test-subj":v("os-select"),fullWidth:!0})),i.a.createElement(V.EuiSpacer,{size:"m"}),i.a.createElement(V.EuiFormRow,{fullWidth:!0},i.a.createElement(V.EuiFlexGroup,{gutterSize:"s"},i.a.createElement(V.EuiFlexItem,{grow:1},i.a.createElement(V.EuiFormRow,{label:oM,fullWidth:!0},i.a.createElement(V.EuiSuperSelect,{name:"field",options:O,valueOfSelected:x.field,onChange:A,"data-test-subj":v("field-select"),fullWidth:!0}))),i.a.createElement(V.EuiFlexItem,{grow:1},i.a.createElement(V.EuiFormRow,{label:lM,fullWidth:!0},i.a.createElement(V.EuiFieldText,{name:"operator",value:ZC.l.message,readOnly:!0}))),i.a.createElement(V.EuiFlexItem,{grow:2}))),i.a.createElement(V.EuiFormRow,{label:w,isInvalid:o.value&&!!Object.keys(u.current.value).length,helpText:Object.values(c.current.value),error:Object.values(u.current.value),fullWidth:!0},i.a.createElement(V.EuiComboBox,{selectedOptions:S,onBlur:C,onSearchChange:_,onChange:N,onCreateOption:R,"data-test-subj":v("values-input"),fullWidth:!0,noSuggestions:!0})),E&&i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiHorizontalRule,null),i.a.createElement(V.EuiFormRow,{fullWidth:!0},i.a.createElement(OC.a,{isGlobal:g,isPlatinumPlus:m,selected:d,options:t,onChange:P,isLoading:a,description:mM}))))})),EM={pageTitle:z.i18n.translate("xpack.securitySolution.blocklist.pageTitle",{defaultMessage:"Blocklist"}),pageAboutInfo:z.i18n.translate("xpack.securitySolution.blocklist.pageAboutInfo",{defaultMessage:"The blocklist prevents selected applications from running on your hosts by extending the list of processes the Endpoint considers malicious."}),pageAddButtonTitle:z.i18n.translate("xpack.securitySolution.blocklist.pageAddButtonTitle",{defaultMessage:"Add blocklist entry"}),getShowingCountLabel:e=>z.i18n.translate("xpack.securitySolution.blocklist.showingTotal",{defaultMessage:"Showing {total} {total, plural, one {blocklist entry} other {blocklist entries}}",values:{total:e}}),cardActionEditLabel:z.i18n.translate("xpack.securitySolution.blocklist.cardActionEditLabel",{defaultMessage:"Edit blocklist"}),cardActionDeleteLabel:z.i18n.translate("xpack.securitySolution.blocklist.cardActionDeleteLabel",{defaultMessage:"Delete blocklist"}),flyoutCreateTitle:z.i18n.translate("xpack.securitySolution.blocklist.flyoutCreateTitle",{defaultMessage:"Add blocklist"}),flyoutEditTitle:z.i18n.translate("xpack.securitySolution.blocklist.flyoutEditTitle",{defaultMessage:"Edit blocklist"}),flyoutCreateSubmitButtonLabel:z.i18n.translate("xpack.securitySolution.blocklist.flyoutCreateSubmitButtonLabel",{defaultMessage:"Add blocklist"}),flyoutCreateSubmitSuccess:({name:e})=>z.i18n.translate("xpack.securitySolution.blocklist.flyoutCreateSubmitSuccess",{defaultMessage:'"{name}" has been added to your blocklist.',values:{name:e}}),flyoutEditSubmitSuccess:({name:e})=>z.i18n.translate("xpack.securitySolution.blocklist.flyoutEditSubmitSuccess",{defaultMessage:'"{name}" has been updated.',values:{name:e}}),flyoutDowngradedLicenseDocsInfo:e=>i.a.createElement(i.a.Fragment,null,i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.blocklist.flyoutDowngradedLicenseDocsInfo",defaultMessage:"For more information, see our "}),i.a.createElement(V.EuiLink,{target:"_blank",href:`${e.blocklist}`},i.a.createElement(dr.FormattedMessage,{id:"xpack.securitySolution.blocklist.flyoutDowngradedLicenseDocsLink",defaultMessage:"blocklist documentation."}))),deleteActionSuccess:e=>z.i18n.translate("xpack.securitySolution.blocklist.deleteSuccess",{defaultMessage:'"{itemName}" has been removed from blocklist.',values:{itemName:e}}),emptyStateTitle:z.i18n.translate("xpack.securitySolution.blocklist.emptyStateTitle",{defaultMessage:"Add your first blocklist entry"}),emptyStateInfo:z.i18n.translate("xpack.securitySolution.blocklist.emptyStateInfo",{defaultMessage:"The blocklist prevents specified applications from running on your hosts, extending the list of processes that Endpoint Security considers malicious."}),emptyStatePrimaryButtonLabel:z.i18n.translate("xpack.securitySolution.blocklist.emptyStatePrimaryButtonLabel",{defaultMessage:"Add blocklist entry"}),searchPlaceholderInfo:z.i18n.translate("xpack.securitySolution.blocklist.searchPlaceholderInfo",{defaultMessage:"Search on the fields below: name, description, value"})},vM=Object(n.memo)((()=>{const e=Object(p.j)(),t=XC.a.getInstance(e);return i.a.createElement(QI.a,{apiClient:t,ArtifactFormComponent:hM,labels:EM,"data-test-subj":"blocklistPage",flyoutSize:"l"})}));vM.displayName="Blocklist";const xM=Object(n.memo)((()=>i.a.createElement(i.a.Fragment,null,i.a.createElement(P.Switch,null,i.a.createElement(L.Route,{path:Ww.g,exact:!0,component:vM}),i.a.createElement(L.Route,{path:"*",component:q.a})),i.a.createElement(E.a,{pageName:k.a.blocklist}))));xM.displayName="BlocklistContainer";var kM=a(562);const SM=()=>{const[e,t]=Object(n.useState)(!0),a=Object(n.useCallback)((e=>{t(!e)}),[]);return i.a.createElement(NT.a,{"data-test-subj":"responseActionsPage",title:ox.z,subtitle:kM.d.pageSubTitle,hideHeader:e},i.a.createElement(Zw.a,{showHostNames:!0,isFlyout:!1,setIsDataInResponse:a}))};SM.displayName="ResponseActionsListPage";const jM=Object(n.memo)((()=>i.a.createElement(P.Switch,null,i.a.createElement(L.Route,{path:Ww.r,exact:!0,component:SM}),i.a.createElement(L.Route,{path:"*",component:q.a}))));jM.displayName="ResponseActionsContainer";var OM=a(930);const wM=z.i18n.translate("xpack.securitySolution.noPermissionsTitle",{defaultMessage:"Privileges required"}),TM=z.i18n.translate("xpack.securitySolution.noPrivilegesDefaultMessage",{defaultMessage:"To view this page, you must update privileges. For more information, contact your Kibana administrator."}),IM=z.i18n.translate("xpack.securitySolution.goToDocumentationButton",{defaultMessage:"View documentation"}),CM=i.a.memo((({pageName:e,documentationUrl:t})=>i.a.createElement(y.a,null,i.a.createElement(V.EuiPageTemplate_Deprecated,{template:"centeredContent"},i.a.createElement(MM,{pageName:e,documentationUrl:t})))));CM.displayName="NoPrivilegePage";const MM=i.a.memo((({pageName:e,documentationUrl:t})=>{const a=Object(n.useMemo)((()=>({feature:{icon:"documents",label:IM,url:t,target:"_blank"}})),[t]),r=e?(e=>z.i18n.translate("xpack.securitySolution.noPrivilegesPerPageMessage",{values:{pageName:e},defaultMessage:"To view {pageName}, you must update privileges. For more information, contact your Kibana administrator."}))(e):TM;return i.a.createElement(ce.a,{actions:a,message:r,"data-test-subj":"noPrivilegesPage",title:wM})}));MM.displayName="NoPrivileges";var FM=a(1124);const DM=Object(n.memo)((({component:e,hasPrivilege:t,path:a})=>{const{docLinks:n}=Object(p.k)().services,r=Object(B.a)("endpointRbacEnabled"),s=Object(B.a)("endpointRbacV1Enabled");let o=e;return t||(o=r||s&&a===Ww.r?()=>i.a.createElement(CM,{documentationUrl:n.links.securitySolution.privileges}):FM.a),i.a.createElement(L.Route,{path:a,component:o})}));DM.displayName="PrivilegedRoute";const AM=()=>i.a.createElement(r.TrackApplicationView,{viewId:s.uc.endpoints},i.a.createElement(HT,null),i.a.createElement(E.a,{pageName:s.uc.endpoints})),_M=()=>i.a.createElement(r.TrackApplicationView,{viewId:s.uc.policies},i.a.createElement(GI,null),i.a.createElement(E.a,{pageName:s.uc.policies})),NM=()=>i.a.createElement(r.TrackApplicationView,{viewId:s.uc.trustedApps},i.a.createElement(AC,null),i.a.createElement(E.a,{pageName:s.uc.trustedApps})),RM=()=>i.a.createElement(r.TrackApplicationView,{viewId:s.uc.eventFilters},i.a.createElement(NC,null),i.a.createElement(E.a,{pageName:s.uc.eventFilters})),PM=()=>i.a.createElement(r.TrackApplicationView,{viewId:s.uc.hostIsolationExceptions},i.a.createElement(JC,null),i.a.createElement(E.a,{pageName:s.uc.hostIsolationExceptions})),LM=()=>i.a.createElement(r.TrackApplicationView,{viewId:s.uc.responseActionsHistory},i.a.createElement(jM,null),i.a.createElement(E.a,{pageName:s.uc.responseActionsHistory})),BM=Object(n.memo)((()=>{const{loading:e,canReadPolicyManagement:t,canReadBlocklist:a,canReadTrustedApplications:n,canReadEventFilters:r,canReadActionsLogManagement:o,canReadEndpointList:l}=Object(pd.a)().endpointPrivileges,c=Object(OM.a)();return e?i.a.createElement(V.EuiLoadingSpinner,null):i.a.createElement(P.Switch,null,i.a.createElement(DM,{path:Ww.h,component:AM,hasPrivilege:l}),i.a.createElement(DM,{path:Ww.k,component:_M,hasPrivilege:t}),i.a.createElement(DM,{path:Ww.s,component:NM,hasPrivilege:n}),i.a.createElement(DM,{path:Ww.i,component:RM,hasPrivilege:r}),i.a.createElement(DM,{path:Ww.j,component:PM,hasPrivilege:c}),i.a.createElement(DM,{path:Ww.g,component:xM,hasPrivilege:a}),i.a.createElement(DM,{path:Ww.r,component:LM,hasPrivilege:o}),l&&i.a.createElement(L.Route,{path:s.Ob,exact:!0},i.a.createElement(P.Redirect,{to:Object(h.e)({name:"endpointList"})})),i.a.createElement(L.Route,{path:"*",component:q.a}))}));BM.displayName="ManagementContainer";var qM=a(1113);const zM=[{path:s.Ob,component:()=>i.a.createElement(_,null,i.a.createElement(qM.a,null,i.a.createElement(BM,null)))}];var $M=a(1122),VM=a(1123),UM=a(938),HM=a(601);const GM=H()(V.EuiTitle).withConfig({displayName:"PrimaryEuiTitle",componentId:"sc-dlsynk-0"})(["color:",";"],(e=>e.theme.eui.euiColorPrimary)),QM=H()(V.EuiText).withConfig({displayName:"LandingLinksDescripton",componentId:"sc-dlsynk-1"})(["padding-top:",";max-width:550px;"],(({theme:e})=>e.eui.euiSizeXS)),WM=H.a.a.withConfig({displayName:"Link",componentId:"sc-dlsynk-2"})(["color:inherit;"]),KM=H()(V.EuiFlexItem).withConfig({displayName:"StyledFlexItem",componentId:"sc-dlsynk-3"})(["align-items:center;"]),YM=H()(V.EuiFlexItem).withConfig({displayName:"Content",componentId:"sc-dlsynk-4"})(["padding-left:",";"],(({theme:e})=>e.eui.euiSizeS)),JM=H.a.div.withConfig({displayName:"FlexTitle",componentId:"sc-dlsynk-5"})(["display:flex;align-items:center;"]),XM=H.a.h2.withConfig({displayName:"TitleText",componentId:"sc-dlsynk-6"})(["display:inline;"]),ZM=Object(be.p)(WM),eF=({items:e})=>i.a.createElement(V.EuiFlexGroup,{direction:"column"},e.map((({title:e,description:t,image:a,id:n,isBeta:r,betaOptions:s})=>i.a.createElement(V.EuiFlexItem,{key:n,"data-test-subj":"LandingItem"},i.a.createElement(ZM,{deepLinkId:n,tabIndex:-1},i.a.createElement(V.EuiPanel,{hasBorder:!0,hasShadow:!1,paddingSize:"m",onClick:()=>{}},i.a.createElement(V.EuiFlexGroup,null,i.a.createElement(KM,{grow:!1},a&&i.a.createElement(V.EuiImage,{"data-test-subj":"LandingLinksImage",size:"l",role:"presentation",alt:"",src:a})),i.a.createElement(YM,null,i.a.createElement(GM,{size:"s"},i.a.createElement(JM,null,i.a.createElement(XM,null,e),r&&i.a.createElement(HM.a,{text:null==s?void 0:s.text}))),i.a.createElement(QM,{size:"s",color:"text"},t))))))))),tF=H()(V.EuiFlexItem).withConfig({displayName:"LandingImageCardItem",componentId:"sc-dlsynk-7"})(["max-width:","px;"],320),aF=H.a.span.withConfig({displayName:"LandingCardDescription",componentId:"sc-dlsynk-8"})(["font-size:",";padding-top:",";"],(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.euiSizeXS)),nF=H()(V.EuiCard).withConfig({displayName:"PrimaryTitleCard",componentId:"sc-dlsynk-9"})([".euiCard__title{color:",";}"],(e=>e.theme.eui.euiColorPrimary)),iF=Object(be.p)(nF),rF=i.a.memo((({items:e})=>i.a.createElement(V.EuiFlexGroup,{direction:"row",wrap:!0},e.map((({id:e,image:t,title:a,description:n,isBeta:r,betaOptions:s})=>i.a.createElement(tF,{key:e,"data-test-subj":"LandingImageCard-item",grow:!1},i.a.createElement(iF,{deepLinkId:e,hasBorder:!0,textAlign:"left",paddingSize:"m",image:t&&i.a.createElement(V.EuiImage,{"data-test-subj":"LandingImageCard-image",role:"presentation",size:320,alt:a,src:t}),title:i.a.createElement(GM,{size:"xs"},i.a.createElement(JM,null,i.a.createElement(XM,null,a),r&&i.a.createElement(HM.a,{text:null==s?void 0:s.text}))),description:i.a.createElement(aF,null,n)})))))));rF.displayName="LandingImageCards";const sF=z.i18n.translate("xpack.securitySolution.landing.threatHunting.pageTitle",{defaultMessage:"Explore"}),oF=z.i18n.translate("xpack.securitySolution.landing.dashboards.pageTitle",{defaultMessage:"Dashboards"}),lF=z.i18n.translate("xpack.securitySolution.landing.dashboards.createButton",{defaultMessage:"Create Dashboard"}),cF=z.i18n.translate("xpack.securitySolution.landing.dashboards.section.default",{defaultMessage:"DEFAULT"}),uF=z.i18n.translate("xpack.securitySolution.landing.dashboards.section.custom",{defaultMessage:"CUSTOM"}),dF=z.i18n.translate("xpack.securitySolution.landing.manage.pageTitle",{defaultMessage:"Manage"}),pF=()=>{var e,t;const a=null!==(e=null===(t=Object(UM.b)(k.a.exploreLanding))||void 0===t?void 0:t.links)&&void 0!==e?e:[];return i.a.createElement(y.a,null,i.a.createElement(ta.a,{title:sF}),i.a.createElement(eF,{items:a}),i.a.createElement(E.a,{pageName:k.a.exploreLanding}))};var mF=a(76);const gF="Security Solution",bF=async e=>{var t;return null===(t=(await e.find({type:"tag",searchFields:["name"],search:gF})).savedObjects.find((({attributes:e})=>e.name===gF)))||void 0===t?void 0:t.id},fF=async e=>{const t=await bF(e);return t?(await e.find({type:"dashboard",hasReference:{id:t,type:"tag"}})).savedObjects:[]},yF=z.i18n.translate("xpack.securitySolution.dashboards.title",{defaultMessage:"Title"}),hF=z.i18n.translate("xpack.securitySolution.dashboards.description",{defaultMessage:"Description"}),EF=z.i18n.translate("xpack.securitySolution.dashboards.queryError",{defaultMessage:"Error retrieving security dashboards"}),vF={sort:{field:"title",direction:"asc"}},xF=()=>{const{items:e,isLoading:t,error:a}=(()=>{const{savedObjects:{client:e}}=Object(p.k)().services,{fetch:t,data:a,isLoading:i,error:r}=Object(ns.b)(ns.a.SECURITY_DASHBOARDS,fF);return Object(n.useEffect)((()=>{e&&t(e)}),[t,e]),{items:Object(n.useMemo)((()=>a?a.map((e=>{var t,a,n,i;return{...e,title:null!==(t=null===(a=e.attributes.title)||void 0===a?void 0:a.toString())&&void 0!==t?t:void 0,description:null!==(n=null===(i=e.attributes.description)||void 0===i?void 0:i.toString())&&void 0!==n?n:void 0}})):[]),[a]),isLoading:i,error:r}})(),r=(()=>{const{savedObjectsTagging:e,dashboard:t}=Object(p.k)().services,{navigateTo:a}=Object(p.l)(),r=Object(n.useCallback)((e=>t=>{t.preventDefault(),a({url:e})}),[a]);return Object(n.useMemo)((()=>[{field:"title",name:yF,sortable:!0,render:(e,{id:a})=>{var n;const s=null==t||null===(n=t.locator)||void 0===n?void 0:n.getRedirectUrl({dashboardId:a});return s?i.a.createElement(be.f,{href:s,onClick:r(s)},e):e},"data-test-subj":"dashboardTableTitleCell"},{field:"description",name:hF,sortable:!0,render:e=>e||"-","data-test-subj":"dashboardTableDescriptionCell"},...e?[e.ui.getTableColumnDefinition()]:[]]),[r,t,e])})(),{addError:s}=Object(Oi.a)(),[o,l]=Object(n.useState)(e),[c,u]=Object(n.useState)(""),d=Object(n.useMemo)((()=>{const e=Object(vE.debounce)(u,250);return{onChange:({queryText:t})=>{var a;e(null!==(a=t.toLowerCase())&&void 0!==a?a:"")},box:{incremental:!0}}}),[]);return Object(n.useEffect)((()=>{0===c.length?l(e):l(e.filter((({title:e,description:t})=>`${e} ${t}`.toLowerCase().includes(c.replace(/[^\w- ]/g,"")))))}),[e,c]),Object(n.useEffect)((()=>{a&&s(a,{title:EF})}),[a,s]),i.a.createElement(V.EuiInMemoryTable,{"data-test-subj":"dashboardsTable",items:o,columns:r,search:d,pagination:!0,sorting:vF,loading:t})};var kF=a(867);const SF=({canCreateDashboard:e})=>{const{isLoading:t,url:a}=(()=>{const{dashboard:{locator:e}={},savedObjects:{client:t},savedObjectsTagging:a}=Object(p.k)().services,[i,r]=Object(n.useState)(null);return Object(n.useEffect)((()=>{let e=!1;return(async()=>{if(t&&a){let n=await bF(t);n||(n=(await(async e=>await e.create({name:gF,description:"Security Solution auto-generated tag",color:`#${String(Math.floor(16777215*Math.random()).toString(16)).padStart(6,"0")}`}))(a.client)).id),e||r(n)}})(),()=>{e=!0}}),[t,a]),Object(n.useMemo)((()=>{var t;return{isLoading:null==i,url:i&&null!==(t=null==e?void 0:e.getRedirectUrl({tags:[i]}))&&void 0!==t?t:""}}),[i,e])})(),{navigateTo:r}=Object(p.l)();return i.a.createElement(V.EuiFlexGroup,{gutterSize:"none",direction:"row"},i.a.createElement(V.EuiFlexItem,null,i.a.createElement(kF.a,{title:oF})),e&&i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(V.EuiButton,{isDisabled:t,color:"primary",fill:!0,iconType:"plusInCircle",href:a,onClick:e=>{e.preventDefault(),r({url:a})},"data-test-subj":"createDashboardButton"},lF)))},jF=()=>{var e,t;const a=null!==(e=null===(t=Object(UM.b)(k.a.dashboardsLanding))||void 0===t?void 0:t.links)&&void 0!==e?e:[],{show:n,createNew:r}=Object(p.f)(mF.DashboardConstants.DASHBOARD_ID);return i.a.createElement(y.a,null,i.a.createElement(SF,{canCreateDashboard:r}),i.a.createElement(V.EuiSpacer,{size:"xl"}),i.a.createElement(V.EuiTitle,{size:"xxxs"},i.a.createElement("h2",null,cF)),i.a.createElement(V.EuiHorizontalRule,{margin:"s"}),i.a.createElement(rF,{items:a}),i.a.createElement(V.EuiSpacer,{size:"xxl"}),n&&i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiTitle,{size:"xxxs"},i.a.createElement("h2",null,uF)),i.a.createElement(V.EuiHorizontalRule,{margin:"s"}),i.a.createElement(V.EuiSpacer,{size:"m"}),i.a.createElement(xF,null)),i.a.createElement(E.a,{pageName:k.a.dashboardsLanding}))},OF=H.a.a.withConfig({displayName:"Link",componentId:"sc-r94plg-0"})(["color:inherit;"]),wF=Object(be.p)(OF),TF=H()(V.EuiFlexItem).withConfig({displayName:"Description",componentId:"sc-r94plg-1"})(["max-width:22em;"]),IF=H()(V.EuiTitle).withConfig({displayName:"StyledEuiTitle",componentId:"sc-r94plg-2"})(["margin-top:",";margin-bottom:",";"],(({theme:e})=>e.eui.euiSizeM),(({theme:e})=>e.eui.euiSizeXS)),CF=({items:e})=>i.a.createElement(V.EuiFlexGrid,{columns:3,gutterSize:"xl"},e.map((({title:e,description:t,id:a,icon:n,isBeta:r,betaOptions:s})=>i.a.createElement(V.EuiFlexItem,{key:a,"data-test-subj":"LandingItem"},i.a.createElement(V.EuiFlexGroup,{direction:"column",alignItems:"flexStart",gutterSize:"none",responsive:!1},i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(wF,{tabIndex:-1,deepLinkId:a},i.a.createElement(V.EuiIcon,{"aria-hidden":"true",size:"xl",type:null!=n?n:"",role:"presentation"}))),i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(IF,{size:"xxs"},i.a.createElement(V.EuiFlexGroup,{gutterSize:"none"},i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(be.k,{deepLinkId:a},i.a.createElement("h2",null,e))),r&&i.a.createElement(V.EuiFlexItem,{grow:!1},i.a.createElement(HM.a,{text:null==s?void 0:s.text}))))),i.a.createElement(TF,null,i.a.createElement(V.EuiText,{size:"s",color:"text"},t))))))),MF=()=>i.a.createElement(y.a,null,i.a.createElement(ta.a,{title:dF}),i.a.createElement(DF,null),i.a.createElement(E.a,{pageName:k.a.administration})),FF=H()(V.EuiHorizontalRule).withConfig({displayName:"StyledEuiHorizontalRule",componentId:"sc-1negbtf-0"})(["margin-top:",";margin-bottom:",";"],(({theme:e})=>e.eui.euiSizeM),(({theme:e})=>e.eui.euiSizeL)),DF=()=>{const e=(()=>{var e;const{links:t=[],categories:a=[]}=null!==(e=Object(UM.b)(k.a.administration))&&void 0!==e?e:{},n=Object.fromEntries(t.map((e=>[e.id,e])));return a.reduce(((e,{label:t,linkIds:a})=>{const i=a.reduce(((e,t)=>(n[t]&&e.push(n[t]),e)),[]);return i.length>0&&e.push({label:t,links:i}),e}),[])})();return i.a.createElement(i.a.Fragment,null,e.map((({label:e,links:t},a)=>i.a.createElement("div",{key:e},a>0&&i.a.createElement(i.a.Fragment,null,i.a.createElement(V.EuiSpacer,{key:"first",size:"xl"}),i.a.createElement(V.EuiSpacer,{key:"second",size:"xl"})),i.a.createElement(V.EuiTitle,{size:"xxxs"},i.a.createElement("h2",null,e)),i.a.createElement(FF,null),i.a.createElement(CF,{items:t})))))};DF.displayName="ManagementCategories";const AF=[{path:s.Db,component:()=>i.a.createElement(_,null,i.a.createElement(r.TrackApplicationView,{viewId:k.a.exploreLanding},i.a.createElement(pF,null)))},{path:s.I,component:()=>i.a.createElement(_,null,i.a.createElement(r.TrackApplicationView,{viewId:k.a.dashboardsLanding},i.a.createElement(jF,null)))},{path:s.Pb,component:()=>i.a.createElement(_,null,i.a.createElement(r.TrackApplicationView,{viewId:k.a.administration},i.a.createElement(MF,null)))}];var _F=a(10),NF=a(521);const RF=({pageName:e})=>i.a.createElement(E.a,{pageName:e}),PF=Object(n.memo)((()=>{const{cloudSecurityPosture:e}=Object(p.k)().services,t=Object(NF.b)(),a=e.getCloudSecurityPostureRouter(),n={getFiltersGlobalComponent:()=>J.a,getSpyRouteComponent:()=>RF,getManageBreadcrumbEntry:()=>t?{name:ox.t,path:s.Pb}:void 0};return i.a.createElement(_,null,i.a.createElement(r.TrackApplicationView,{viewId:"cloud_security_posture"},i.a.createElement(y.a,{noPadding:!0,noTimeline:!0},i.a.createElement(a,{securitySolutionContext:n}))))}));PF.displayName="CloudSecurityPosture";const LF=[{path:_F.CLOUD_SECURITY_POSTURE_BASE_PATH,render:()=>i.a.createElement(PF,null)}];var BF=a(20),qF=a(210);const zF=({dataProviders:e,from:t,to:a})=>{const{data:{query:i}}=Object(p.k)().services,r=Object(o.useDispatch)(),{startTransaction:l}=Object(So.a)(),c=Object(n.useMemo)((()=>i.filterManager),[i.filterManager]),u=Object(n.useMemo)((()=>m.b.getTimelineByIdSelector()),[]),{filterManager:d}=Object(x.a)((e=>{var t;return u(e,null!==(t=ua.d.active)&&void 0!==t?t:"")})),g=Object(n.useMemo)((()=>null!=d?d:c),[d,c]),b=Object(n.useCallback)((e=>r(m.a.updateIsLoading(e))),[r]),f=Object(qF.a)({timelineId:ua.d.active,timelineType:ua.g.default}),y=Object(n.useCallback)((({from:e,timeline:t,to:a,ruleNote:n})=>{var i;f(),b({id:ua.d.active,isLoading:!1}),Object(bh.b)(r)({duplicate:!0,from:e,id:ua.d.active,notes:[],timeline:{...t,filterManager:g,indexNames:null!==(i=t.indexNames)&&void 0!==i?i:[],show:!0},to:a,ruleNote:n})()}),[r,g,b,f]);return Object(n.useCallback)((async()=>{l({name:`${s.B} threat indicator investigateInTimeline`}),await y({from:t,notes:null,timeline:{...Lg.b,dataProviders:e,id:ua.d.active,indexNames:[],dateRange:{start:t,end:a},eventType:"all",filters:[],kqlQuery:{filterQuery:{kuery:{kind:"kuery",expression:""},serializedQuery:""}}},to:a,ruleNote:""})}),[l,y,e,t,a])},$F=Object(n.memo)((()=>{const{threatIntelligence:e}=Object(p.k)().services,t=e.getComponent(),a=Object(g.d)(),n=Object(rr.c)(),s={securitySolutionStore:n,getFiltersGlobalComponent:()=>J.a,getPageWrapper:()=>y.a,licenseService:Ku.a,sourcererDataView:a,getUseInvestigateInTimeline:zF,useQuery:()=>Object(o.useSelector)(rr.d.globalQuerySelector()),useFilters:()=>Object(o.useSelector)(rr.d.globalFiltersQuerySelector()),useGlobalTime:Y.a,registerQuery:e=>n.dispatch(Object(te.setQuery)({inputId:K.a.global,id:e.id,refetch:e.refetch,inspect:null,loading:e.loading})),deregisterQuery:e=>n.dispatch(Object(te.deleteOneQuery)({inputId:K.a.global,id:e.id})),SiemSearchBar:Z.a};return i.a.createElement(r.TrackApplicationView,{viewId:"threat_intelligence"},i.a.createElement(t,{securitySolutionContext:s}),i.a.createElement(E.a,{pageName:k.a.threatIntelligenceIndicators}))}));$F.displayName="ThreatIntelligence";const VF=[{path:BF.THREAT_INTELLIGENCE_BASE_PATH,render:()=>i.a.createElement($F,null)}],UF={Detections:class detections_Detections{setup(){}start(e){return{storageDataTables:{tableById:Object(R.b)(e,hi)},routes:yi}}},Cases:class cases_Cases{setup(){}start(){return{routes:N}}},Exceptions:class exceptions_Exceptions{setup(){}start(e){return{storageDataTables:{tableById:Object(R.b)(e,hi)},routes:Wi}}},Hosts:class public_hosts_Hosts{setup(){}start(e){return{routes:cm,storageDataTables:{tableById:Object(R.b)(e,um)},store:{initialState:{hosts:Es.e},reducer:{hosts:Es.c}}}}},Users:class public_users_Users{setup(){}start(e){return{routes:Hg,store:{initialState:{users:vs.a},reducer:{users:vs.d}}}}},Network:class public_network_Network{setup(){}start(e){return{routes:sy,storageDataTables:{tableById:Object(R.b)(e,[u.g.networkPageEvents])},store:{initialState:{network:Wf.a},reducer:{network:Wf.d}}}}},Kubernetes:class kubernetes_Kubernetes{setup(){}start(){return{routes:yy}}},Overview:class overview_Overview{setup(){}start(){return{routes:Kx}}},Rules:class rules_Rules{setup(){}start(e){return{storageDataTables:{tableById:Object(R.b)(e,hi)},routes:Fw}}},Timelines:class timelines_Timelines{setup(){}start(){return{routes:Vw,store:{initialState:{timeline:Gw},reducer:{timeline:Qw}}}}},Management:class management_Management{setup(){}start(e,t){return{routes:zM,store:{initialState:{management:{}},reducer:{management:$M.a},middleware:Object(VM.a)(e,t)}}}},LandingPages:class landing_pages_LandingPages{setup(){}start(){return{routes:AF}}},CloudSecurityPosture:class cloud_security_posture_CloudSecurityPosture{setup(){}start(){return{routes:LF}}},ThreatIntelligence:class threat_intelligence_ThreatIntelligence{setup(){}start(){return{routes:VF}}}}}])]);