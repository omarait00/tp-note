/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[9],{1069:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return y})),n.d(t,"a",(function(){return p}));var o=n(385),i=n(399),a=n(373),r=n(591);const s=e=>{const t={coreStart:e};return e=>n=>async s=>{n(s),(async({coreStart:e},{dispatch:t,getState:n},s)=>{const c=e.http,d=n();if("userChangedUrl"===s.type&&Object(i.i)(d)&&Object(i.g)(d)){const e=Object(i.m)(d);let n;try{n=(await Object(a.g)(c,e)).item,""===n.inputs[0].config.policy.value.windows.popup.malware.message&&(n.inputs[0].config.policy.value.windows.popup.malware.message=o.a,n.inputs[0].config.policy.value.mac.popup.malware.message=o.a,n.inputs[0].config.policy.value.linux.popup.malware.message=o.a),""===n.inputs[0].config.policy.value.windows.popup.ransomware.message&&(n.inputs[0].config.policy.value.windows.popup.ransomware.message=o.a),""===n.inputs[0].config.policy.value.windows.popup.memory_protection.message&&(n.inputs[0].config.policy.value.windows.popup.memory_protection.message=o.b),""===n.inputs[0].config.policy.value.mac.popup.memory_protection.message&&(n.inputs[0].config.policy.value.mac.popup.memory_protection.message=o.b),""===n.inputs[0].config.policy.value.linux.popup.memory_protection.message&&(n.inputs[0].config.policy.value.linux.popup.memory_protection.message=o.b),""===n.inputs[0].config.policy.value.windows.popup.behavior_protection.message&&(n.inputs[0].config.policy.value.windows.popup.behavior_protection.message=o.b),""===n.inputs[0].config.policy.value.mac.popup.behavior_protection.message&&(n.inputs[0].config.policy.value.mac.popup.behavior_protection.message=o.b),""===n.inputs[0].config.policy.value.linux.popup.behavior_protection.message&&(n.inputs[0].config.policy.value.linux.popup.behavior_protection.message=o.b)}catch(e){return void t({type:"serverFailedToReturnPolicyDetailsData",payload:e.body||e})}if(t({type:"serverReturnedPolicyDetailsData",payload:{policyItem:n}}),n.policy_id){const{results:e}=await Object(a.e)(c,n.policy_id);t({type:"serverReturnedPolicyDetailsAgentSummaryData",payload:{agentStatusSummary:e}})}}else if("userClickedPolicyDetailsSaveButton"===s.type){const{id:e}=Object(i.k)(d),n=Object(i.l)(d);let o;try{o=await Object(a.h)(c,e,n).catch((t=>t.response&&409===t.response.status?Object(a.g)(c,e).then((t=>{const o=t.item;return o.inputs[0].config.policy=n.inputs[0].config.policy,Object(a.h)(c,e,Object(r.a)(o))})):Promise.reject(t)))}catch(e){return void t({type:"serverReturnedPolicyDetailsUpdateFailure",payload:{success:!1,error:e.body||e}})}t({type:"serverReturnedUpdatedPolicyDetailsData",payload:{policyItem:o.item,updateStatus:{success:!0}}})}})(t,e,s)}};var c=n(271),d=n(153),l=n(105);const p=()=>({policyItem:void 0,isLoading:!1,agentStatusSummary:{error:0,events:0,offline:0,online:0,total:0,other:0},artifacts:{location:{page:l.b,pageSize:l.c,show:void 0,filter:""}}}),u=(e,t)=>({...e,inputs:e.inputs.map((e=>({...e,config:e.config&&{...e.config,policy:{...e.config.policy,value:t}}})))}),g=(e=p(),t)=>{if("serverReturnedPolicyDetailsData"===t.type||"serverReturnedUpdatedPolicyDetailsData"===t.type)return{...e,...t.payload,isLoading:!1};if("serverFailedToReturnPolicyDetailsData"===t.type)return{...e,isLoading:!1,apiError:t.payload};if("serverReturnedPolicyDetailsAgentSummaryData"===t.type)return{...e,...t.payload};if("serverReturnedPolicyDetailsUpdateFailure"===t.type)return{...e,isLoading:!1,updateStatus:t.payload};if("userClickedPolicyDetailsSaveButton"===t.type)return{...e,isLoading:!0,updateApiError:void 0};if("licenseChanged"===t.type)return{...e,license:t.payload};if("userChangedUrl"===t.type){const n={...e,location:t.payload,artifacts:{...e.artifacts,location:Object(d.b)(Object(c.parse)(t.payload.search.slice(1)))}},o=Object(i.g)(n),a=Object(i.g)(e),r=Object(i.h)(n);return o?a?n:{...n,isLoading:!0}:{...p(),location:t.payload,license:r}}if("userChangedPolicyConfig"===t.type){if(!e.policyItem)return e;const n={...e,policyItem:{...e.policyItem}},o={...Object(i.c)(e)};return n.policyItem.inputs[0].config.policy.value=o,Object.entries(t.payload.policyConfig).forEach((([e,t])=>{o[e]={...o[e],...t}})),n}if("userChangedAntivirusRegistration"===t.type){if(e.policyItem){const n=Object(i.c)(e);return{...e,policyItem:u(e.policyItem,{...n,windows:{...n.windows,antivirus_registration:{enabled:t.payload.enabled}}})}}return e}if("userChangedCredentialHardening"===t.type){if(e.policyItem){const n=Object(i.c)(e);return{...e,policyItem:u(e.policyItem,{...n,windows:{...n.windows,attack_surface_reduction:{credential_hardening:{enabled:t.payload.enabled}}}})}}return e}return e},y=(e=p(),t)=>[g].reduce(((e,n)=>n(e,t)),e)},1085:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return p}));var o=n(4),i=n.n(o),a=n(32),r=n(1092),s=n(581),c=n(77);let d;!function(e){e.overview="details",e.activityLog="activity_log"}(d||(d={}));const l=Object(o.memo)((({tab:e,isSelected:t})=>{const{getAppUrl:n}=Object(c.d)(),o=Object(s.a)(e.route);return i.a.createElement(a.EuiTab,{href:n({path:e.route}),onClick:o,isSelected:t,key:e.id,"data-test-subj":`endpoint-details-flyout-tab-${e.id}`},e.name)}));l.displayName="EndpointDetailsTab";const p=Object(o.memo)((({hostname:e,show:t,tabs:n})=>{const s=Object(o.useMemo)((()=>n.find((e=>e.id===t))),[n,t]),c=n.map((e=>i.a.createElement(l,{key:e.id,tab:e,isSelected:e.id===(null==s?void 0:s.id)})));return i.a.createElement(i.a.Fragment,null,i.a.createElement(r.a,{hostname:e,hasBorder:!0},i.a.createElement(a.EuiTabs,{bottomBorder:!1,style:{marginBottom:"-25px"}},c)),i.a.createElement(a.EuiFlyoutBody,{"data-test-subj":`endpoint${"details"===(null==s?void 0:s.id)?"Details":"ActivityLog"}FlyoutBody`},null==s?void 0:s.content))}));p.displayName="EndpointDetailsFlyoutTabs"},1092:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var o=n(4),i=n.n(o),a=n(32),r=n(379),s=n(280),c=n(0),d=n(153),l=n(581),p=n(240);const u=Object(o.memo)((({endpointId:e})=>{var t;const{getAppUrl:n}=Object(p.b)(),{show:u,...g}=Object(r.b)(s.uiQueryParams),y=Object(o.useMemo)((()=>Object(d.d)({name:"endpointDetails",...g,selected_endpoint:e})),[g,e]),f=Object(l.a)(y),h=Object(o.useMemo)((()=>({title:c.i18n.translate("xpack.securitySolution.endpoint.policyResponse.backLinkTitle",{defaultMessage:"Endpoint details"}),href:n({path:y}),onClick:f})),[f,n,y]);return i.a.createElement("div",null,i.a.createElement(a.EuiButtonEmpty,{flush:"both","data-test-subj":"flyoutSubHeaderBackButton",iconType:"arrowLeft",size:"xs",href:null!==(t=null==h?void 0:h.href)&&void 0!==t?t:"",onClick:null==h?void 0:h.onClick},null==h?void 0:h.title))}));u.displayName="BackToEndpointDetailsFlyoutSubHeader";const g=Object(o.memo)((({endpointId:e,hasBorder:t=!1,hostname:n,children:o})=>{const c=Object(r.b)(s.detailsLoading);return i.a.createElement(a.EuiFlyoutHeader,{hasBorder:t},e&&i.a.createElement(u,{endpointId:e}),c?i.a.createElement(a.EuiLoadingContent,{lines:1}):i.a.createElement(a.EuiToolTip,{content:n,anchorClassName:"eui-textTruncate"},i.a.createElement(a.EuiTitle,{size:"s"},i.a.createElement("h2",{style:{overflow:"hidden",textOverflow:"ellipsis"},"data-test-subj":"endpointDetailsFlyoutTitle"},n))),o)}));g.displayName="EndpointDetailsFlyoutHeader"},1112:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var o=n(4),i=n.n(o),a=n(39);class SecuritySolutionQueryClient extends a.QueryClient{constructor(e={}){var t,n,o;super({...e,defaultOptions:{...null!==(t=e.defaultOptions)&&void 0!==t?t:{},queries:{refetchIntervalInBackground:!1,refetchOnWindowFocus:!1,refetchOnMount:!0,keepPreviousData:!0,...null!==(n=null==e||null===(o=e.defaultOptions)||void 0===o?void 0:o.queries)&&void 0!==n?n:{}}}})}}const r=Object(o.memo)((({queryClient:e,children:t})=>{const n=Object(o.useMemo)((()=>e||new SecuritySolutionQueryClient),[e]);return i.a.createElement(a.QueryClientProvider,{client:n},t)}));r.displayName="ReactQueryClientProvider"},1113:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var o=n(4),i=n.n(o),a=n(78),r=n(13);const s=Object(o.memo)((({children:e})=>{const t=Object(a.useDispatch)();return Object(o.useEffect)((()=>{var e;const n=null===(e=r.a.getLicenseInformation$())||void 0===e?void 0:e.subscribe((e=>{t({type:"licenseChanged",payload:e})}));return()=>null==n?void 0:n.unsubscribe()}),[t]),i.a.createElement(i.a.Fragment,null,e)}));s.displayName="CurrentLicense"},1122:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var o=n(295),i=n(1069),a=n(105),r=n(280),s=n(588);const c=()=>({hosts:[],pageSize:10,pageIndex:0,total:0,loading:!1,error:void 0,endpointDetails:{hostDetails:{details:void 0,detailsLoading:!1,detailsError:void 0}},policyResponse:void 0,policyResponseLoading:!1,policyResponseError:void 0,location:void 0,policyItems:[],selectedPolicyId:void 0,policyItemsLoading:!1,endpointPackageInfo:Object(s.e)(),nonExistingPolicies:{},agentPolicies:{},endpointsExist:!0,patterns:[],patternsError:void 0,isAutoRefreshEnabled:!0,autoRefreshInterval:a.a,agentsWithEndpointsTotal:0,agentsWithEndpointsTotalError:void 0,endpointsTotal:0,endpointsTotalError:void 0,policyVersionInfo:void 0,hostStatus:void 0,isolationRequestState:Object(s.e)(),endpointPendingActions:Object(s.c)(new Map),metadataTransformStats:Object(s.e)()}),d=o.combineReducers,l=(a.v,Object(i.a)(),a.t,c(),d({[a.v]:i.c,[a.t]:(e=c(),t)=>{if("serverReturnedEndpointList"===t.type){const{data:n,total:o,page:i,pageSize:a}=t.payload;return{...e,hosts:n,total:o,pageIndex:i,pageSize:a,loading:!1,error:void 0}}if("serverFailedToReturnEndpointList"===t.type)return{...e,error:t.payload,loading:!1};if("serverReturnedEndpointNonExistingPolicies"===t.type)return{...e,nonExistingPolicies:{...e.nonExistingPolicies,...t.payload}};if("serverReturnedEndpointAgentPolicies"===t.type)return{...e,agentPolicies:{...e.agentPolicies,...t.payload}};if("serverReturnedMetadataPatterns"===t.type)return{...e,patterns:t.payload,patternsError:void 0};if("serverFailedToReturnMetadataPatterns"===t.type)return{...e,patternsError:t.payload};if("serverReturnedEndpointDetails"===t.type)return{...e,endpointDetails:{...e.endpointDetails,hostDetails:{...e.endpointDetails.hostDetails,details:t.payload.metadata,detailsLoading:!1,detailsError:void 0}},policyVersionInfo:t.payload.policy_info,hostStatus:t.payload.host_status};if("serverFailedToReturnEndpointDetails"===t.type)return{...e,endpointDetails:{...e.endpointDetails,hostDetails:{...e.endpointDetails.hostDetails,detailsError:t.payload,detailsLoading:!1}}};if("endpointPendingActionsStateChanged"===t.type)return((e,t)=>Object(r.isOnEndpointPage)(e)?{...e,endpointPendingActions:t.payload}:e)(e,t);if("serverReturnedPoliciesForOnboarding"===t.type)return{...e,policyItems:t.payload.policyItems,policyItemsLoading:!1};if("serverFailedToReturnPoliciesForOnboarding"===t.type)return{...e,error:t.payload,policyItemsLoading:!1};if("serverReturnedEndpointPolicyResponse"===t.type)return{...e,policyResponse:t.payload.policy_response,policyResponseLoading:!1,policyResponseError:void 0};if("serverFailedToReturnEndpointPolicyResponse"===t.type)return{...e,policyResponseError:t.payload,policyResponseLoading:!1};if("userSelectedEndpointPolicy"===t.type)return{...e,selectedPolicyId:t.payload.selectedPolicyId,policyResponseLoading:!1};if("serverCancelledEndpointListLoading"===t.type)return{...e,loading:!1};if("serverCancelledPolicyItemsLoading"===t.type)return{...e,policyItemsLoading:!1};if("endpointPackageInfoStateChanged"===t.type)return((e,t)=>({...e,endpointPackageInfo:t.payload}))(e,t);if("serverReturnedEndpointExistValue"===t.type)return{...e,endpointsExist:t.payload};if("serverReturnedAgenstWithEndpointsTotal"===t.type)return{...e,agentsWithEndpointsTotal:t.payload,agentsWithEndpointsTotalError:void 0};if("serverFailedToReturnAgenstWithEndpointsTotal"===t.type)return{...e,agentsWithEndpointsTotalError:t.payload};if("serverReturnedEndpointsTotal"===t.type)return{...e,endpointsTotal:t.payload,endpointsTotalError:void 0};if("serverFailedToReturnEndpointsTotal"===t.type)return{...e,endpointsTotalError:t.payload};var n,o;if("userUpdatedEndpointListRefreshOptions"===t.type)return{...e,isAutoRefreshEnabled:null!==(n=t.payload.isAutoRefreshEnabled)&&void 0!==n?n:e.isAutoRefreshEnabled,autoRefreshInterval:null!==(o=t.payload.autoRefreshInterval)&&void 0!==o?o:e.autoRefreshInterval};if("endpointIsolationRequestStateChange"===t.type)return((e,t)=>({...e,isolationRequestState:t.payload}))(e,t);if("userChangedUrl"===t.type){const n={...e,location:t.payload},o=Object(r.isOnEndpointPage)(n)&&!Object(r.hasSelectedEndpoint)(n),i=Object(r.isOnEndpointPage)(e)&&!Object(r.hasSelectedEndpoint)(e),a=Object(r.isOnEndpointPage)(n)&&Object(r.hasSelectedEndpoint)(n),c=Object(r.isOnEndpointPage)(e)&&Object(r.hasSelectedEndpoint)(e),d=Object(r.isOnEndpointPage)(e)&&Object(r.hasSelectedEndpoint)(e)&&Object(r.getIsOnEndpointDetailsActivityLog)(e),l=Object(r.isOnEndpointPage)(n)&&Object(r.hasSelectedEndpoint)(n)&&Object(r.getIsOnEndpointDetailsActivityLog)(n)||d&&Object(r.uiQueryParams)(e).selected_endpoint===Object(r.uiQueryParams)(n).selected_endpoint,p={location:t.payload,error:void 0,policyResponseError:void 0};if("isolate"===Object(r.uiQueryParams)(n).show||Object(s.i)(Object(r.getCurrentIsolationRequestState)(n))||(p.isolationRequestState=Object(s.e)()),o){if(!i)return{...e,...p,endpointDetails:{...e.endpointDetails,hostDetails:{...e.endpointDetails.hostDetails,detailsError:void 0}},loading:!0,policyItemsLoading:!0}}else if(a)return c||i?{...e,...p,endpointDetails:{...e.endpointDetails,hostDetails:{...e.endpointDetails.hostDetails,detailsLoading:!l,detailsError:void 0}},detailsLoading:!0,policyResponseLoading:!0}:{...e,...p,endpointDetails:{...e.endpointDetails,hostDetails:{...e.endpointDetails.hostDetails,detailsLoading:!0,detailsError:void 0}},loading:!0,policyResponseLoading:!0,policyItemsLoading:!0};return{...e,...p,endpointDetails:{...e.endpointDetails,hostDetails:{...e.endpointDetails.hostDetails,detailsError:void 0}},endpointsExist:!0}}return"metadataTransformStatsChanged"===t.type?((e,t)=>({...e,metadataTransformStats:t.payload}))(e,t):e}}))},1123:function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var o=n(98),i=n(105),a=n(1069),r=n(363),s=n.n(r),c=n(226),d=n(740),l=n(918),p=n(547),u=n(687),g=n(588),y=n(373),f=n(280);const h=console.error,m=(e,t)=>{async function n(e){var n;const o=null!==(n=Object(f.endpointPackageVersion)(e))&&void 0!==n?n:"",i=o.includes("-")?o.substring(0,o.indexOf("-")):o,a=s()(i,"1.2.0")?c.o:c.r,{indexPatterns:r}=t.data;return[{title:a,fields:await r.getFieldsForWildcard({pattern:a})}]}return t=>o=>async i=>{o(i);const{getState:a,dispatch:r}=t;if(await async function(e,t,n){if(Object(f.getIsEndpointPackageInfoUninitialized)(e)){t({type:"endpointPackageInfoStateChanged",payload:Object(g.d)(Object(g.a)(Object(f.endpointPackageInfo)(e)))});try{const e=await Object(y.d)(n.http);t({type:"endpointPackageInfoStateChanged",payload:Object(g.c)(e)})}catch(e){h(e),t({type:"endpointPackageInfoStateChanged",payload:Object(g.b)(e)})}}}(a(),r,e),"userChangedUrl"!==i.type&&"appRequestedEndpointList"!==i.type||!Object(f.isOnEndpointPage)(a())||Object(f.hasSelectedEndpoint)(a())||await async function({store:e,coreStart:t,fetchIndexPatterns:n}){const{getState:o,dispatch:i}=e,{page_index:a,page_size:r}=Object(f.uiQueryParams)(o());let s;try{const n=Object(f.searchBarQuery)(o());s=await t.http.get(c.k,{query:{page:a,pageSize:r,kuery:n.query}}),i({type:"serverReturnedEndpointList",payload:s}),O(e);try{i({type:"serverReturnedEndpointsTotal",payload:await b(t.http)})}catch(e){i({type:"serverFailedToReturnEndpointsTotal",payload:e})}try{i({type:"serverReturnedAgenstWithEndpointsTotal",payload:(await Object(y.f)(t.http)).total})}catch(e){i({type:"serverFailedToReturnAgenstWithEndpointsTotal",payload:e})}S({http:t.http,hosts:s.data,store:e})}catch(e){i({type:"serverFailedToReturnEndpointList",payload:e})}if(0===Object(f.patterns)(o()).length)try{const e=await n(o());void 0!==e&&i({type:"serverReturnedMetadataPatterns",payload:e})}catch(e){i({type:"serverFailedToReturnMetadataPatterns",payload:e})}if(s&&0===s.data.length){const e=t.http;if(await(async e=>{try{return await b(e)>0}catch(e){h("error while trying to check if endpoints exist"),h(e)}return!1})(e))return;i({type:"serverReturnedEndpointExistValue",payload:!1});try{i({type:"serverReturnedPoliciesForOnboarding",payload:{policyItems:(await Object(u.a)(e,{query:{perPage:50,page:1}})).items}})}catch(e){var d;i({type:"serverFailedToReturnPoliciesForOnboarding",payload:null!==(d=e.body)&&void 0!==d?d:e})}}else i({type:"serverCancelledPolicyItemsLoading"}),i({type:"serverReturnedEndpointExistValue",payload:!0})}({coreStart:e,store:t,fetchIndexPatterns:n}),"userChangedUrl"===i.type&&Object(f.hasSelectedEndpoint)(a())){const{selected_endpoint:n}=Object(f.uiQueryParams)(a());await async function({coreStart:e,selectedEndpoint:t,store:n}){const{getState:o,dispatch:i}=n;if(i({type:"serverCancelledPolicyItemsLoading"}),0===Object(f.listData)(o()).length){const{page_index:t,page_size:a}=Object(f.uiQueryParams)(o());try{const o=await e.http.get(c.k,{query:{page:t,pageSize:a}});i({type:"serverReturnedEndpointList",payload:o}),S({http:e.http,hosts:o.data,store:n})}catch(e){i({type:"serverFailedToReturnEndpointList",payload:e})}}else i({type:"serverCancelledEndpointListLoading"});void 0!==t&&await I({store:n,coreStart:e,selectedEndpoint:t})}({store:t,coreStart:e,selectedEndpoint:n})}return"endpointDetailsLoad"===i.type&&await I({store:t,coreStart:e,selectedEndpoint:i.payload.endpointId}),"endpointIsolationRequest"===i.type?v(t,i):"loadMetadataTransformStats"===i.type?async function(e,t){const{getState:n,dispatch:o}=t;if(!e||!n||!o)return;const i=n();if(!Object(f.isMetadataTransformStatsLoading)(i)){o({type:"metadataTransformStatsChanged",payload:Object(g.d)(Object(g.a)(Object(f.getMetadataTransformStats)(i)))});try{const t=await e.get(c.n);o({type:"metadataTransformStatsChanged",payload:Object(g.c)(t.transforms)})}catch(e){o({type:"metadataTransformStatsChanged",payload:Object(g.b)(e)})}}}(e.http,t):void 0}},E=async(e,t,n)=>{if(0===t.length)return;const o=[...new Set(t.reduce(((e,t)=>{const o=t.metadata.Endpoint.policy.applied.id;return n[o]||e.push(o),e}),[]))];if(0===o.length)return;const i=(await Object(y.c)(e,o)).items.reduce(((e,t)=>(e.packagePolicy[t.id]=!0,e.agentPolicy[t.id]=t.policy_id,e)),{packagePolicy:{},agentPolicy:{}}),a=o.reduce(((e,t)=>i.packagePolicy[t]?(e.agentPolicy[t]=i.agentPolicy[t],e):(e.packagePolicy[t]=!0,e)),{packagePolicy:{},agentPolicy:{}});return 0!==Object.keys(a.packagePolicy).length||0!==Object.keys(a.agentPolicy).length?a:void 0},b=async e=>{try{return(await e.get(c.k,{query:{page:0,pageSize:1}})).total}catch(e){h("error while trying to check for total endpoints"),h(e)}return 0},v=async({getState:e,dispatch:t},n)=>{const o=e();if(!Object(f.getIsIsolationRequestPending)(o)){t({type:"endpointIsolationRequestStateChange",payload:Object(g.d)(Object(g.a)(Object(f.getCurrentIsolationRequestState)(o)))});try{let e;e="unisolate"===n.payload.type?await Object(d.b)(n.payload.data):await Object(d.a)(n.payload.data),t({type:"endpointIsolationRequestStateChange",payload:Object(g.c)(e)})}catch(e){var i;t({type:"endpointIsolationRequestStateChange",payload:Object(g.b)(null!==(i=e.body)&&void 0!==i?i:e)})}}},O=async({getState:e,dispatch:t})=>{const n=e(),o=Object(f.detailsData)(n),i=Object(f.listData)(n),a=new Set;o&&a.add(o.elastic.agent.id);for(const e of i)a.add(e.metadata.elastic.agent.id);if(0!==a.size)try{const{data:e}=await Object(l.a)(Array.from(a)),n=new Map;for(const t of e)n.set(t.agent_id,t.pending_actions);t({type:"endpointPendingActionsStateChanged",payload:Object(g.c)(n)})}catch(e){h(e)}};async function I({selectedEndpoint:e,store:t,coreStart:n}){const{getState:o,dispatch:i}=t;try{const t=await n.http.get(Object(p.a)(c.j,{id:e}));i({type:"serverReturnedEndpointDetails",payload:t});try{const e=await E(n.http,[t],Object(f.nonExistingPolicies)(o()));void 0!==e&&i({type:"serverReturnedEndpointNonExistingPolicies",payload:e.packagePolicy}),void 0!==(null==e?void 0:e.agentPolicy)&&i({type:"serverReturnedEndpointAgentPolicies",payload:e.agentPolicy})}catch(e){h(e)}}catch(e){i({type:"serverFailedToReturnEndpointDetails",payload:e})}O(t);try{i({type:"serverReturnedEndpointPolicyResponse",payload:await n.http.get(c.e,{query:{agentId:e}})})}catch(e){i({type:"serverFailedToReturnEndpointPolicyResponse",payload:e})}}async function S({store:e,hosts:t,http:n}){const{getState:o,dispatch:i}=e;try{const e=await E(n,t,Object(f.nonExistingPolicies)(o()));void 0!==(null==e?void 0:e.packagePolicy)&&i({type:"serverReturnedEndpointNonExistingPolicies",payload:e.packagePolicy}),void 0!==(null==e?void 0:e.agentPolicy)&&i({type:"serverReturnedEndpointAgentPolicies",payload:e.agentPolicy})}catch(e){h(e)}}const R=e=>t=>t[i.u][e],j=(e,t)=>[Object(o.f)(R(i.v),Object(a.b)(e,t)),Object(o.f)(R(i.t),m(e,t))]},125:function(e,t,n){const o=n(307),{MAX_LENGTH:i,MAX_SAFE_INTEGER:a}=n(308),{re:r,t:s}=n(235),c=n(322),{compareIdentifiers:d}=n(391);class SemVer{constructor(e,t){if(t=c(t),e instanceof SemVer){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError(`Invalid Version: ${e}`);if(e.length>i)throw new TypeError(`version is longer than ${i} characters`);o("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const n=e.trim().match(t.loose?r[s.LOOSE]:r[s.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>a||this.major<0)throw new TypeError("Invalid major version");if(this.minor>a||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>a||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<a)return t}return e})):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(o("SemVer.compare",this.version,this.options,e),!(e instanceof SemVer)){if("string"==typeof e&&e===this.version)return 0;e=new SemVer(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof SemVer||(e=new SemVer(e,this.options)),d(this.major,e.major)||d(this.minor,e.minor)||d(this.patch,e.patch)}comparePre(e){if(e instanceof SemVer||(e=new SemVer(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const n=this.prerelease[t],i=e.prerelease[t];if(o("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return d(n,i)}while(++t)}compareBuild(e){e instanceof SemVer||(e=new SemVer(e,this.options));let t=0;do{const n=this.build[t],i=e.build[t];if(o("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return d(n,i)}while(++t)}inc(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{let e=this.prerelease.length;for(;--e>=0;)"number"==typeof this.prerelease[e]&&(this.prerelease[e]++,e=-2);-1===e&&this.prerelease.push(0)}t&&(0===d(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error(`invalid increment argument: ${e}`)}return this.format(),this.raw=this.version,this}}e.exports=SemVer},1294:function(e,t,n){"use strict";n.r(t),n.d(t,"withSecurityContext",(function(){return h}));var o=n(4),i=n.n(o),a=n(295),r=n(1122),s=n(283),c=n(21),d=n(1123);const l=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||a.compose;var p=n(78),u=n(1112),g=n(1141),y=n(1113);const f=Object(o.memo)((({store:e,depsStart:t,queryClient:n,children:o})=>i.a.createElement(p.Provider,{store:e},i.a.createElement(u.a,{queryClient:n},i.a.createElement(g.a.Provider,{value:t},i.a.createElement(y.a,null,o))))));f.displayName="RenderContextProviders";const h=({coreStart:e,depsStart:t,WrappedComponent:n})=>{let p;return Object(o.memo)((o=>(p||(p=(({coreStart:e,depsStart:t,reducersObject:n={management:r.a,app:s.b},preloadedState:o={management:void 0,app:{enableExperimental:c.a.get()}},additionalMiddleware:i=[]})=>Object(a.createStore)(Object(a.combineReducers)(n),o,l(Object(a.applyMiddleware)(...Object(d.a)(e,t),...i))))({coreStart:e,depsStart:t})),i.a.createElement(f,{store:p,depsStart:t},i.a.createElement(n,o)))))}},152:function(e,t,n){const o=n(125);e.exports=(e,t,n)=>new o(e,n).compare(new o(t,n))},153:function(e,t,n){"use strict";n.d(t,"e",(function(){return y})),n.d(t,"d",(function(){return f})),n.d(t,"h",(function(){return h})),n.d(t,"j",(function(){return m})),n.d(t,"n",(function(){return E})),n.d(t,"l",(function(){return b})),n.d(t,"a",(function(){return j})),n.d(t,"o",(function(){return w})),n.d(t,"b",(function(){return P})),n.d(t,"k",(function(){return L})),n.d(t,"f",(function(){return _})),n.d(t,"g",(function(){return N})),n.d(t,"m",(function(){return T})),n.d(t,"c",(function(){return A})),n.d(t,"i",(function(){return $}));var o=n(34),i=n(271),a=n.n(i),r=n(37),s=n(209),c=n(405),d=n(522),l=n(105);const p=(e,t)=>void 0===e||e===t||0===e,u=(e,t={})=>`${e}${Object(s.a)(a.a.stringify(((e={})=>({...p(e.page,1)?{}:{page:e.page},...p(e.pageSize,l.c)?{}:{pageSize:e.pageSize},...p(e.show,void 0)?{}:{show:e.show},...p(e.itemId,void 0)?{}:{itemId:e.itemId},...p(e.filter,"")?"":{filter:e.filter},...p(e.includedPolicies,"")?"":{includedPolicies:e.includedPolicies}}))(t)))}`,g=e=>a.a.stringify(e),y=(e,t)=>{const{name:n,...i}=e,a=g(i),c=`${a&&!Object(o.isEmpty)(t)?"&":""}${null!=t?t:""}`;return"endpointList"===n?`${Object(r.generatePath)(l.h,{tabName:d.a.endpoints})}${Object(s.a)(`${a?`${a}${c}`:c}`)}`:`${Object(s.a)(`${a?`${a}${c}`:c}`)}`},f=(e,t)=>{const{name:n,show:i,...a}=e,c={...a};switch(e.name){case"endpointDetails":c.show="details";break;case"endpointIsolate":c.show="isolate";break;case"endpointUnIsolate":c.show="unisolate";break;case"endpointPolicyResponse":c.show="policy_response";break;case"endpointActivityLog":c.show="activity_log"}const p=g(c),u=`${p&&!Object(o.isEmpty)(t)?"&":""}${null!=t?t:""}`;return`${Object(r.generatePath)(l.h,{tabName:d.a.endpoints})}${Object(s.a)(`${p?`${p}${u}`:u}`)}`},h=e=>`${Object(r.generatePath)(l.k,{tabName:d.a.policies})}${Object(s.a)(e)}`,m=(e,t)=>`${Object(r.generatePath)(l.n,{tabName:d.a.policies,policyId:e})}${Object(s.a)(t)}`,E=(e,t)=>`${Object(r.generatePath)(l.q,{tabName:d.a.policies,policyId:e})}${Object(s.a)(t)}`,b=(e,t)=>`${Object(r.generatePath)(l.m,{tabName:d.a.policies,policyId:e})}${Object(s.a)(a.a.stringify(v(t)))}`,v=e=>e?{...p(e.page,l.b+1)?{}:{page:e.page},...p(e.pageSize,l.c)?{}:{pageSize:e.pageSize},...p(e.show,void 0)?{}:{show:e.show},...p(e.filter,"")?"":{filter:e.filter}}:{},O=(e,t)=>{const n=e[t];return Array.isArray(n)?n[n.length-1]:n},I=e=>{const t=Number(O(e,"page_index"));return!Number.isFinite(t)||t<0?l.b:t},S=e=>{const t=Number(O(e,"page_size"));return l.f.includes(t)?t:l.c},R=e=>O(e,"filter")||"",j=e=>({page_index:I(e),page_size:S(e),filter:R(e)}),w=e=>{const t=Object(r.generatePath)(l.s,{tabName:d.a.trustedApps});return u(t,e)},P=e=>{const t=O(e,"show"),n=Object(c.a)(e);return{page:n.page,pageSize:n.pageSize,filter:e.filter,show:t&&"list"===t?t:void 0}},L=(e,t)=>`${Object(r.generatePath)(l.q,{tabName:d.a.policies,policyId:e})}${Object(s.a)(a.a.stringify(v(t)))}`,_=e=>`${Object(r.generatePath)(l.i,{tabName:d.a.eventFilters})}${Object(s.a)(a.a.stringify((e=>e?{...p(e.page_index,l.b)?{}:{page_index:e.page_index},...p(e.page_size,l.c)?{}:{page_size:e.page_size},...p(e.show,void 0)?{}:{show:e.show},...p(e.id,void 0)?{}:{id:e.id},...p(e.filter,"")?"":{filter:e.filter},...p(e.included_policies,"")?"":{included_policies:e.included_policies}}:{})(e)))}`,N=e=>{const t=Object(r.generatePath)(l.j,{tabName:d.a.hostIsolationExceptions});return u(t,e)},T=(e,t)=>`${Object(r.generatePath)(l.o,{tabName:d.a.policies,policyId:e})}${Object(s.a)(a.a.stringify(v(t)))}`,A=e=>{const t=Object(r.generatePath)(l.g,{tabName:d.a.blocklist});return u(t,e)},$=(e,t)=>`${Object(r.generatePath)(l.l,{tabName:d.a.policies,policyId:e})}${Object(s.a)(a.a.stringify(v(t)))}`},235:function(e,t,n){const{MAX_SAFE_COMPONENT_LENGTH:o}=n(308),i=n(307),a=(t=e.exports={}).re=[],r=t.src=[],s=t.t={};let c=0;const d=(e,t,n)=>{const o=c++;i(e,o,t),s[e]=o,r[o]=t,a[o]=new RegExp(t,n?"g":void 0)};d("NUMERICIDENTIFIER","0|[1-9]\\d*"),d("NUMERICIDENTIFIERLOOSE","[0-9]+"),d("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),d("MAINVERSION",`(${r[s.NUMERICIDENTIFIER]})\\.(${r[s.NUMERICIDENTIFIER]})\\.(${r[s.NUMERICIDENTIFIER]})`),d("MAINVERSIONLOOSE",`(${r[s.NUMERICIDENTIFIERLOOSE]})\\.(${r[s.NUMERICIDENTIFIERLOOSE]})\\.(${r[s.NUMERICIDENTIFIERLOOSE]})`),d("PRERELEASEIDENTIFIER",`(?:${r[s.NUMERICIDENTIFIER]}|${r[s.NONNUMERICIDENTIFIER]})`),d("PRERELEASEIDENTIFIERLOOSE",`(?:${r[s.NUMERICIDENTIFIERLOOSE]}|${r[s.NONNUMERICIDENTIFIER]})`),d("PRERELEASE",`(?:-(${r[s.PRERELEASEIDENTIFIER]}(?:\\.${r[s.PRERELEASEIDENTIFIER]})*))`),d("PRERELEASELOOSE",`(?:-?(${r[s.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${r[s.PRERELEASEIDENTIFIERLOOSE]})*))`),d("BUILDIDENTIFIER","[0-9A-Za-z-]+"),d("BUILD",`(?:\\+(${r[s.BUILDIDENTIFIER]}(?:\\.${r[s.BUILDIDENTIFIER]})*))`),d("FULLPLAIN",`v?${r[s.MAINVERSION]}${r[s.PRERELEASE]}?${r[s.BUILD]}?`),d("FULL",`^${r[s.FULLPLAIN]}$`),d("LOOSEPLAIN",`[v=\\s]*${r[s.MAINVERSIONLOOSE]}${r[s.PRERELEASELOOSE]}?${r[s.BUILD]}?`),d("LOOSE",`^${r[s.LOOSEPLAIN]}$`),d("GTLT","((?:<|>)?=?)"),d("XRANGEIDENTIFIERLOOSE",`${r[s.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),d("XRANGEIDENTIFIER",`${r[s.NUMERICIDENTIFIER]}|x|X|\\*`),d("XRANGEPLAIN",`[v=\\s]*(${r[s.XRANGEIDENTIFIER]})(?:\\.(${r[s.XRANGEIDENTIFIER]})(?:\\.(${r[s.XRANGEIDENTIFIER]})(?:${r[s.PRERELEASE]})?${r[s.BUILD]}?)?)?`),d("XRANGEPLAINLOOSE",`[v=\\s]*(${r[s.XRANGEIDENTIFIERLOOSE]})(?:\\.(${r[s.XRANGEIDENTIFIERLOOSE]})(?:\\.(${r[s.XRANGEIDENTIFIERLOOSE]})(?:${r[s.PRERELEASELOOSE]})?${r[s.BUILD]}?)?)?`),d("XRANGE",`^${r[s.GTLT]}\\s*${r[s.XRANGEPLAIN]}$`),d("XRANGELOOSE",`^${r[s.GTLT]}\\s*${r[s.XRANGEPLAINLOOSE]}$`),d("COERCE",`(^|[^\\d])(\\d{1,${o}})(?:\\.(\\d{1,${o}}))?(?:\\.(\\d{1,${o}}))?(?:$|[^\\d])`),d("COERCERTL",r[s.COERCE],!0),d("LONETILDE","(?:~>?)"),d("TILDETRIM",`(\\s*)${r[s.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",d("TILDE",`^${r[s.LONETILDE]}${r[s.XRANGEPLAIN]}$`),d("TILDELOOSE",`^${r[s.LONETILDE]}${r[s.XRANGEPLAINLOOSE]}$`),d("LONECARET","(?:\\^)"),d("CARETTRIM",`(\\s*)${r[s.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",d("CARET",`^${r[s.LONECARET]}${r[s.XRANGEPLAIN]}$`),d("CARETLOOSE",`^${r[s.LONECARET]}${r[s.XRANGEPLAINLOOSE]}$`),d("COMPARATORLOOSE",`^${r[s.GTLT]}\\s*(${r[s.LOOSEPLAIN]})$|^$`),d("COMPARATOR",`^${r[s.GTLT]}\\s*(${r[s.FULLPLAIN]})$|^$`),d("COMPARATORTRIM",`(\\s*)${r[s.GTLT]}\\s*(${r[s.LOOSEPLAIN]}|${r[s.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",d("HYPHENRANGE",`^\\s*(${r[s.XRANGEPLAIN]})\\s+-\\s+(${r[s.XRANGEPLAIN]})\\s*$`),d("HYPHENRANGELOOSE",`^\\s*(${r[s.XRANGEPLAINLOOSE]})\\s+-\\s+(${r[s.XRANGEPLAINLOOSE]})\\s*$`),d("STAR","(<|>)?=?\\s*\\*"),d("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),d("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},271:function(e,t,n){"use strict";t.decode=t.parse=n(550),t.encode=t.stringify=n(551)},280:function(e,t,n){"use strict";n.r(t),n.d(t,"listData",(function(){return y})),n.d(t,"pageIndex",(function(){return f})),n.d(t,"pageSize",(function(){return h})),n.d(t,"totalHits",(function(){return m})),n.d(t,"listLoading",(function(){return E})),n.d(t,"listError",(function(){return b})),n.d(t,"detailsData",(function(){return v})),n.d(t,"detailsLoading",(function(){return O})),n.d(t,"detailsError",(function(){return I})),n.d(t,"policyItems",(function(){return S})),n.d(t,"policyItemsLoading",(function(){return R})),n.d(t,"selectedPolicyId",(function(){return j})),n.d(t,"endpointPackageInfo",(function(){return w})),n.d(t,"getIsEndpointPackageInfoUninitialized",(function(){return P})),n.d(t,"isAutoRefreshEnabled",(function(){return L})),n.d(t,"autoRefreshInterval",(function(){return _})),n.d(t,"policyVersionInfo",(function(){return N})),n.d(t,"areEndpointsEnrolling",(function(){return T})),n.d(t,"agentsWithEndpointsTotalError",(function(){return A})),n.d(t,"endpointsTotalError",(function(){return $})),n.d(t,"endpointPackageVersion",(function(){return D})),n.d(t,"patterns",(function(){return k})),n.d(t,"patternsError",(function(){return C})),n.d(t,"isOnEndpointPage",(function(){return x})),n.d(t,"uiQueryParams",(function(){return F})),n.d(t,"hasSelectedEndpoint",(function(){return M})),n.d(t,"showView",(function(){return U})),n.d(t,"hostStatusInfo",(function(){return G})),n.d(t,"policyResponseStatus",(function(){return q})),n.d(t,"nonExistingPolicies",(function(){return V})),n.d(t,"agentPolicies",(function(){return B})),n.d(t,"endpointsExist",(function(){return z})),n.d(t,"searchBarQuery",(function(){return X})),n.d(t,"getCurrentIsolationRequestState",(function(){return H})),n.d(t,"getIsIsolationRequestPending",(function(){return Q})),n.d(t,"getWasIsolationRequestSuccessful",(function(){return W})),n.d(t,"getIsolationRequestError",(function(){return K})),n.d(t,"getIsOnEndpointDetailsActivityLog",(function(){return Y})),n.d(t,"getIsEndpointHostIsolated",(function(){return J})),n.d(t,"getEndpointPendingActionsState",(function(){return Z})),n.d(t,"getEndpointHostIsolationStatusPropsCallback",(function(){return ee})),n.d(t,"getMetadataTransformStats",(function(){return te})),n.d(t,"metadataTransformStats",(function(){return ne})),n.d(t,"isMetadataTransformStatsLoading",(function(){return oe}));var o=n(271),i=n.n(o),a=n(108),r=n(37),s=n(54),c=n(142),d=n(153),l=n(105),p=n(588),u=n(191),g=n(1085);const y=e=>e.hosts,f=e=>e.pageIndex,h=e=>e.pageSize,m=e=>e.total,E=e=>e.loading,b=e=>e.error,v=e=>e.endpointDetails.hostDetails.details,O=e=>e.endpointDetails.hostDetails.detailsLoading,I=e=>e.endpointDetails.hostDetails.detailsError,S=e=>e.policyItems,R=e=>e.policyItemsLoading,j=e=>e.selectedPolicyId,w=e=>e.endpointPackageInfo,P=Object(a.createSelector)(w,(e=>Object(p.i)(e))),L=e=>e.isAutoRefreshEnabled,_=e=>e.autoRefreshInterval,N=e=>e.policyVersionInfo,T=e=>e.agentsWithEndpointsTotal>e.endpointsTotal,A=e=>e.agentsWithEndpointsTotalError,$=e=>e.endpointsTotalError,D=Object(a.createSelector)(w,(e=>Object(p.g)(e)?e.data.version:void 0)),k=e=>e.patterns,C=e=>e.patternsError,x=e=>{var t,n;return null!==Object(r.matchPath)(null!==(t=null===(n=e.location)||void 0===n?void 0:n.pathname)&&void 0!==t?t:"",{path:l.h,exact:!0})},F=Object(a.createSelector)((e=>e.location),(e=>{const t={page_index:String(l.b),page_size:String(l.c)};if(e){const n=i.a.parse(e.search.slice(1)),o=Object(d.a)(n),a=["selected_endpoint","show","admin_query"],r=["policy_response","details","isolate","unisolate","activity_log"];for(const e of a){const o="string"==typeof n[e]?n[e]:Array.isArray(n[e])?n[e][n[e].length-1]:void 0;void 0!==o&&("show"===e?r.includes(o)&&(t[e]=o):t[e]=o)}t.page_size=String(o.page_size),t.page_index=String(o.page_index)}return t})),M=Object(a.createSelector)(F,(({selected_endpoint:e})=>void 0!==e)),U=Object(a.createSelector)(F,(e=>{var t;return null!==(t=e.show)&&void 0!==t?t:"details"})),G=Object(a.createSelector)((e=>e.hostStatus),(e=>e||c.b.UNHEALTHY)),q=Object(a.createSelector)((e=>e.policyResponse),(e=>{var t,n,o;return e&&(null==e||null===(t=e.Endpoint)||void 0===t||null===(n=t.policy)||void 0===n||null===(o=n.applied)||void 0===o?void 0:o.status)||""})),V=e=>e.nonExistingPolicies,B=e=>e.agentPolicies,z=e=>e.endpointsExist,X=Object(a.createSelector)(F,(({admin_query:e})=>{const t={query:"",language:"kuery"};if(e){const n=Object(s.decode)(e);n&&"string"==typeof n.query&&(t.query=n.query),!n||"string"!=typeof n.language||"kuery"!==n.language&&"lucene"!==n.language||(t.language=n.language)}return t})),H=e=>e.isolationRequestState,Q=Object(a.createSelector)(H,(e=>Object(p.h)(e))),W=Object(a.createSelector)(H,(e=>Object(p.g)(e))),K=Object(a.createSelector)(H,(e=>{if(Object(p.f)(e))return e.error})),Y=Object(a.createSelector)(F,(e=>e.show===g.b.activityLog)),J=Object(a.createSelector)(v,(e=>e&&Object(u.b)(e)||!1)),Z=e=>e.endpointPendingActions,ee=Object(a.createSelector)(Z,(e=>t=>{let n=0,o=0,i=0,a=0,r=0;if(Object(p.g)(e)){const p=e.data.get(t.elastic.agent.id);var s,c,d,l,g;p&&(n=null!==(s=null==p?void 0:p.isolate)&&void 0!==s?s:0,o=null!==(c=null==p?void 0:p.unisolate)&&void 0!==c?c:0,i=null!==(d=null==p?void 0:p["kill-process"])&&void 0!==d?d:0,a=null!==(l=null==p?void 0:p["suspend-process"])&&void 0!==l?l:0,r=null!==(g=null==p?void 0:p["running-processes"])&&void 0!==g?g:0)}return{isIsolated:Object(u.b)(t),pendingActions:{pendingIsolate:n,pendingUnIsolate:o,pendingKillProcess:i,pendingSuspendProcess:a,pendingRunningProcesses:r}}})),te=e=>e.metadataTransformStats,ne=e=>Object(p.g)(e.metadataTransformStats)?e.metadataTransformStats.data:[],oe=e=>Object(p.h)(e.metadataTransformStats)},307:function(e,t,n){(function(t){const n="object"==typeof t&&Object({IS_KIBANA_DISTRIBUTABLE:"true"})&&Object({IS_KIBANA_DISTRIBUTABLE:"true"}).NODE_DEBUG&&/\bsemver\b/i.test(Object({IS_KIBANA_DISTRIBUTABLE:"true"}).NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=n}).call(this,n(545))},308:function(e,t){const n=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:n,MAX_SAFE_COMPONENT_LENGTH:16}},321:function(e,t,n){const o=n(152);e.exports=(e,t,n)=>o(e,t,n)<=0},322:function(e,t){const n=["includePrerelease","loose","rtl"];e.exports=e=>e?"object"!=typeof e?{loose:!0}:n.filter((t=>e[t])).reduce(((e,t)=>(e[t]=!0,e)),{}):{}},363:function(e,t,n){const o=n(152);e.exports=(e,t,n)=>o(e,t,n)>=0},373:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"g",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"h",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return d})),n.d(t,"d",(function(){return l}));const o="/api/fleet/package_policies",i=(e,t,n)=>e.get(`${o}/${t}`,n),a=(e,t,n)=>e.post(`${o}/_bulk_get`,{...n,body:JSON.stringify({ids:t,ignoreMissing:!0})}),r=(e,t,n={})=>e.post("/api/fleet/agent_policies/_bulk_get",{...n,body:JSON.stringify({ids:t,ignoreMissing:!0,full:!0})}),s=(e,t,n,i={})=>e.put(`${o}/${t}`,{...i,body:JSON.stringify(n)}),c=(e,t,n={})=>e.get("/api/fleet/agent_status",{...n,query:{policyId:t}}),d=(e,t={})=>e.get("/api/fleet/agents",{...t,query:{page:1,perPage:1,kuery:'packages : "endpoint"'}}),l=async e=>{const t=(await e.get("/api/fleet/epm/packages",{query:{category:"security"}})).items.find((e=>"endpoint"===e.name));if(!t)throw new Error("Endpoint package was not found.");return t}},379:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return b}));var o=n(78),i=n(105);function a(e){return Object(o.useSelector)((function(t){return e(t[i.u][i.t])}))}var r=n(4),s=n.n(r),c=n(35),d=n(64),l=n(116),p=n(691),u=n(107),g=n(1),y=n(153),f=n(280),h=n(240),m=n(191),E=n(653);const b=(e,t)=>{const{getAppUrl:n}=Object(h.b)(),o=a(f.agentPolicies),i=a(f.uiQueryParams),b=Object(p.c)(),v=Object(u.a)("responseActionsConsoleEnabled"),{canAccessResponseConsole:O,canIsolateHost:I,canUnIsolateHost:S,canAccessEndpointActionsLogManagement:R}=Object(l.a)().endpointPrivileges;return Object(r.useMemo)((()=>{if(e){const a=Object(m.b)(e),r=e.agent.id,l=e.Endpoint.policy.applied.id,p=e.host.hostname,u=e.elastic.agent.id,f=Object(E.a)({osName:e.host.os.name,version:e.agent.version,capabilities:e.Endpoint.capabilities}),{show:h,selected_endpoint:j,...w}=i,P=Object(y.d)({name:"endpointActivityLog",...w,selected_endpoint:r}),L=Object(y.d)({name:"endpointIsolate",...w,selected_endpoint:r}),_=Object(y.d)({name:"endpointUnIsolate",...w,selected_endpoint:r}),N=[];return a&&S?N.push({"data-test-subj":"unIsolateLink",icon:"lockOpen",key:"unIsolateHost",navigateAppId:g.B,navigateOptions:{path:_},href:n({path:_}),children:s.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.unIsolateHost",defaultMessage:"Release host"})}):f&&I&&N.push({"data-test-subj":"isolateLink",icon:"lock",key:"isolateHost",navigateAppId:g.B,navigateOptions:{path:L},href:n({path:L}),children:s.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.isolateHost",defaultMessage:"Isolate host"})}),[...N,...v&&O?[{"data-test-subj":"console",icon:"console",key:"consoleLink",onClick:t=>{t.preventDefault(),b(e)},children:s.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.console",defaultMessage:"Respond"})}]:[],...null!=t&&t.isEndpointList&&R?[{"data-test-subj":"actionsLink",icon:"logoSecurity",key:"actionsLogLink",navigateAppId:g.B,navigateOptions:{path:P},href:n({path:P}),children:s.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.responseActionsHistory",defaultMessage:"View response actions history"})}]:[],{"data-test-subj":"hostLink",icon:"logoSecurity",key:"hostDetailsLink",navigateAppId:g.B,navigateOptions:{path:`/hosts/${p}`},href:n({path:`/hosts/${p}`}),children:s.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.hostDetails",defaultMessage:"View host details"})},{icon:"gear",key:"agentConfigLink","data-test-subj":"agentPolicyLink",navigateAppId:"fleet",navigateOptions:{path:`${d.pagePathGetters.policy_details({policyId:o[l]})[1]}`},href:`${n({appId:"fleet"})}${d.pagePathGetters.policy_details({policyId:o[l]})[1]}`,disabled:void 0===o[l],children:s.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.agentPolicy",defaultMessage:"View agent policy"})},{icon:"gear",key:"agentDetailsLink","data-test-subj":"agentDetailsLink",navigateAppId:"fleet",navigateOptions:{path:`${d.pagePathGetters.agent_details({agentId:u})[1]}`},href:`${n({appId:"fleet"})}${d.pagePathGetters.agent_details({agentId:u})[1]}`,children:s.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.agentDetails",defaultMessage:"View agent details"})},{icon:"gear",key:"agentPolicyReassignLink","data-test-subj":"agentPolicyReassignLink",navigateAppId:"fleet",navigateOptions:{path:`${d.pagePathGetters.agent_details({agentId:u})[1]}?openReassignFlyout=true`},href:`${n({appId:"fleet"})}${d.pagePathGetters.agent_details({agentId:u})[1]}?openReassignFlyout=true`,children:s.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.agentPolicyReassign",defaultMessage:"Reassign agent policy"})}]}return[]}),[i,O,R,e,o,n,v,b,null==t?void 0:t.isEndpointList,I,S])}},385:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c}));var o=n(142);const i=()=>({windows:{events:{dll_and_driver_load:!0,dns:!0,file:!0,network:!0,process:!0,registry:!0,security:!0},malware:{mode:o.e.prevent,blocklist:!0},ransomware:{mode:o.e.prevent,supported:!0},memory_protection:{mode:o.e.prevent,supported:!0},behavior_protection:{mode:o.e.prevent,supported:!0},popup:{malware:{message:"",enabled:!0},ransomware:{message:"",enabled:!0},memory_protection:{message:"",enabled:!0},behavior_protection:{message:"",enabled:!0}},logging:{file:"info"},antivirus_registration:{enabled:!1},attack_surface_reduction:{credential_hardening:{enabled:!0}}},mac:{events:{process:!0,file:!0,network:!0},malware:{mode:o.e.prevent,blocklist:!0},behavior_protection:{mode:o.e.prevent,supported:!0},memory_protection:{mode:o.e.prevent,supported:!0},popup:{malware:{message:"",enabled:!0},behavior_protection:{message:"",enabled:!0},memory_protection:{message:"",enabled:!0}},logging:{file:"info"}},linux:{events:{process:!0,file:!0,network:!0,session_data:!1,tty_io:!1},malware:{mode:o.e.prevent,blocklist:!0},behavior_protection:{mode:o.e.prevent,supported:!0},memory_protection:{mode:o.e.prevent,supported:!0},popup:{malware:{message:"",enabled:!0},behavior_protection:{message:"",enabled:!0},memory_protection:{message:"",enabled:!0}},logging:{file:"info"}}}),a=(e=i())=>{const t={rollback:{self_healing:{enabled:!1}}};return{...e,windows:{...e.windows,advanced:void 0===e.windows.advanced?void 0:{...e.windows.advanced,alerts:void 0===e.windows.advanced.alerts?{...t}:{...e.windows.advanced.alerts,...t}},ransomware:{mode:o.e.off,supported:!1},memory_protection:{mode:o.e.off,supported:!1},behavior_protection:{mode:o.e.off,supported:!1},attack_surface_reduction:{credential_hardening:{enabled:!1}},popup:{...e.windows.popup,malware:{message:"",enabled:!0},ransomware:{message:"",enabled:!1},memory_protection:{message:"",enabled:!1},behavior_protection:{message:"",enabled:!1}}},mac:{...e.mac,behavior_protection:{mode:o.e.off,supported:!1},memory_protection:{mode:o.e.off,supported:!1},popup:{...e.mac.popup,malware:{message:"",enabled:!0},memory_protection:{message:"",enabled:!1},behavior_protection:{message:"",enabled:!1}}},linux:{...e.linux,behavior_protection:{mode:o.e.off,supported:!1},memory_protection:{mode:o.e.off,supported:!1},popup:{...e.linux.popup,malware:{message:"",enabled:!0},memory_protection:{message:"",enabled:!1},behavior_protection:{message:"",enabled:!1}}}}},r=(e=i())=>({...e,windows:{...e.windows,ransomware:{...e.windows.ransomware,supported:!0},memory_protection:{...e.windows.memory_protection,supported:!0},behavior_protection:{...e.windows.behavior_protection,supported:!0}},mac:{...e.mac,behavior_protection:{...e.windows.behavior_protection,supported:!0},memory_protection:{...e.mac.memory_protection,supported:!0}},linux:{...e.linux,behavior_protection:{...e.windows.behavior_protection,supported:!0},memory_protection:{...e.linux.memory_protection,supported:!0}}}),s="Elastic Security {action} {filename}",c="Elastic Security {action} {rule}"},386:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return d})),n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return p})),n.d(t,"b",(function(){return u}));var o=n(37),i=n(108),a=n(105);const r=e=>e.artifacts.location,s=e=>{var t;return null===(t=e.location)||void 0===t?void 0:t.pathname},c=Object(i.createSelector)(s,(e=>null!==Object(o.matchPath)(null!=e?e:"",{path:a.n,exact:!0}))),d=Object(i.createSelector)(s,(e=>null!==Object(o.matchPath)(null!=e?e:"",{path:a.q,exact:!0}))),l=Object(i.createSelector)(s,(e=>null!==Object(o.matchPath)(null!=e?e:"",{path:a.m,exact:!0}))),p=Object(i.createSelector)(s,(e=>null!==Object(o.matchPath)(null!=e?e:"",{path:a.o,exact:!0}))),u=Object(i.createSelector)(s,(e=>null!==Object(o.matchPath)(null!=e?e:"",{path:a.l,exact:!0})))},391:function(e,t){const n=/^[0-9]+$/,o=(e,t)=>{const o=n.test(e),i=n.test(t);return o&&i&&(e=+e,t=+t),e===t?0:o&&!i?-1:i&&!o?1:e<t?-1:1};e.exports={compareIdentifiers:o,rcompareIdentifiers:(e,t)=>o(t,e)}},399:function(e,t,n){"use strict";n.d(t,"k",(function(){return l})),n.d(t,"l",(function(){return u})),n.d(t,"i",(function(){return g})),n.d(t,"g",(function(){return y})),n.d(t,"h",(function(){return f})),n.d(t,"m",(function(){return h})),n.d(t,"c",(function(){return E})),n.d(t,"j",(function(){return I})),n.d(t,"d",(function(){return S})),n.d(t,"e",(function(){return R})),n.d(t,"f",(function(){return j})),n.d(t,"b",(function(){return w})),n.d(t,"a",(function(){return P})),n.d(t,"n",(function(){return L}));var o=n(37),i=n(108),a=n(19),r=n(385),s=n(105),c=n(591),d=n(386);const l=e=>e.policyItem,p=Object(i.createSelector)(l,(e=>e.license),((e,t)=>{if(e){const n=((e,t)=>Object(a.b)(t,"platinum")?Object(r.d)(e):Object(r.e)(e))(e.inputs[0].config.policy.value,t);return{...e,inputs:[{...e.inputs[0],config:{...e.inputs[0].config,policy:{...e.inputs[0].config.policy,value:n}}}]}}return e})),u=Object(i.createSelector)(p,(e=>{if(e)return Object(c.a)(e)})),g=e=>!e.policyItem&&!e.apiError,y=e=>Object(d.e)(e)||Object(d.f)(e)||Object(d.d)(e)||Object(d.c)(e)||Object(d.b)(e),f=e=>e.license,h=Object(i.createSelector)((e=>e.location),(e=>{var t,n,i,a;return null!==(t=null===(n=Object(o.matchPath)(null!==(a=null==e?void 0:e.pathname)&&void 0!==a?a:"",{path:[s.n,s.q,s.m,s.o,s.l],exact:!0}))||void 0===n||null===(i=n.params)||void 0===i?void 0:i.policyId)&&void 0!==t?t:""})),m=Object(r.c)(),E=Object(i.createSelector)(p,(e=>{var t,n,o,i;return null!==(t=null==e||null===(n=e.inputs[0])||void 0===n||null===(o=n.config)||void 0===o||null===(i=o.policy)||void 0===i?void 0:i.value)&&void 0!==t?t:m})),b=Object(i.createSelector)(E,(e=>null==e?void 0:e.windows)),v=Object(i.createSelector)(E,(e=>null==e?void 0:e.mac)),O=Object(i.createSelector)(E,(e=>null==e?void 0:e.linux)),I=Object(i.createSelector)(b,v,O,((e,t,n)=>({windows:{advanced:e.advanced,events:e.events,malware:e.malware,ransomware:e.ransomware,memory_protection:e.memory_protection,behavior_protection:e.behavior_protection,popup:e.popup,antivirus_registration:e.antivirus_registration,attack_surface_reduction:e.attack_surface_reduction},mac:{advanced:t.advanced,events:t.events,malware:t.malware,behavior_protection:t.behavior_protection,memory_protection:t.memory_protection,popup:t.popup},linux:{advanced:n.advanced,events:n.events,malware:n.malware,behavior_protection:n.behavior_protection,memory_protection:n.memory_protection,popup:n.popup}}))),S=Object(i.createSelector)(I,(e=>e.windows.antivirus_registration.enabled)),R=Object(i.createSelector)(I,(e=>e.windows.attack_surface_reduction.credential_hardening.enabled)),j=e=>e.isLoading,w=e=>e.apiError,P=e=>e.agentStatusSummary,L=e=>e.updateStatus},545:function(e,t,n){e.exports=n(27)(477)},550:function(e,t,n){"use strict";function o(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,a){t=t||"&",n=n||"=";var r={};if("string"!=typeof e||0===e.length)return r;var s=/\+/g;e=e.split(t);var c=1e3;a&&"number"==typeof a.maxKeys&&(c=a.maxKeys);var d=e.length;c>0&&d>c&&(d=c);for(var l=0;l<d;++l){var p,u,g,y,f=e[l].replace(s,"%20"),h=f.indexOf(n);h>=0?(p=f.substr(0,h),u=f.substr(h+1)):(p=f,u=""),g=decodeURIComponent(p),y=decodeURIComponent(u),o(r,g)?i(r[g])?r[g].push(y):r[g]=[r[g],y]:r[g]=y}return r};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},551:function(e,t,n){"use strict";var o=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,s){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?a(r(e),(function(r){var s=encodeURIComponent(o(r))+n;return i(e[r])?a(e[r],(function(e){return s+encodeURIComponent(o(e))})).join(t):s+encodeURIComponent(o(e[r]))})).join(t):s?encodeURIComponent(o(s))+n+encodeURIComponent(o(e)):""};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function a(e,t){if(e.map)return e.map(t);for(var n=[],o=0;o<e.length;o++)n.push(t(e[o],o));return n}var r=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},581:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var o=n(4),i=n(37);const a=(e,t)=>{const n=Object(i.useHistory)();return Object(o.useCallback)((o=>{try{t&&t(o)}catch(e){throw o.preventDefault(),e}o.defaultPrevented||0===o.button&&(o.currentTarget instanceof HTMLAnchorElement&&""!==o.currentTarget.target&&"_self"!==o.currentTarget.target||o.metaKey||o.altKey||o.ctrlKey||o.shiftKey||(o.preventDefault(),Array.isArray(e)?n.push(...e):n.push(e)))}),[n,t,e])}},588:function(e,t,n){"use strict";n.d(t,"i",(function(){return o})),n.d(t,"h",(function(){return i})),n.d(t,"g",(function(){return a})),n.d(t,"f",(function(){return r})),n.d(t,"e",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return p}));const o=e=>"UninitialisedResourceState"===e.type,i=e=>"LoadingResourceState"===e.type,a=e=>"LoadedResourceState"===e.type,r=e=>"FailedResourceState"===e.type,s=()=>({type:"UninitialisedResourceState"}),c=e=>({type:"LoadingResourceState",previousState:e}),d=e=>({type:"LoadedResourceState",data:e}),l=(e,t)=>({type:"FailedResourceState",error:e,lastLoadedState:t}),p=e=>{switch(e.type){case"LoadedResourceState":case"FailedResourceState":return e;case"UninitialisedResourceState":case"LoadingResourceState":return s()}}},591:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(7);const i=e=>{const{id:t,revision:n,created_by:i,created_at:a,updated_by:r,updated_at:s,...c}=e,d=Object(o.cloneDeep)(c),l=d.inputs[0].config.policy.value;return[l.windows.popup.malware,l.mac.popup.malware].forEach((e=>e.message.trim())),d}},653:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var o=n(321),i=n.n(o);const a={macos:!0,windows:!0};function r(e){return e.includes("-")?e.substring(0,e.indexOf("-")):e}const s=({osName:e,version:t,capabilities:n})=>!(!t||!(({currentVersion:e,minVersionRequired:t="7.14.0"})=>{try{const n=r(e);return i()(t,n)}catch(n){return window&&window.console&&window.console.warn(`SecuritySolution: isVersionSupported(): Unable to determine if current version [${e}] meets minimum version [${t}]. Error: ${n.message}`),!1}})({currentVersion:t}))&&(function(e){const t=r(e);return i()("7.15.0",t)}(t)?function(e=[]){return e.includes("isolation")}(n):function(e){return(({currentOs:e,supportedOss:t=a})=>!!t[e])({currentOs:e.toLowerCase()})}(e))},687:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var o=n(59),i=n(373);const a=(e,t={})=>{var n;return e.get(i.a,{...t,query:{...t.query,kuery:`${null!=t&&null!==(n=t.query)&&void 0!==n&&n.kuery?`${t.query.kuery} and `:""}${o.PACKAGE_POLICY_SAVED_OBJECT_TYPE}.package.name: endpoint`}})}}}]);