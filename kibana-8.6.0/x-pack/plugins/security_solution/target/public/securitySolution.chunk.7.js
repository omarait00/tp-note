/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[7],{1070:function(e,t,a){"use strict";a.d(t,"a",(function(){return B})),a.d(t,"b",(function(){return H})),a.d(t,"c",(function(){return L})),a.d(t,"d",(function(){return _}));var n=a(82),o=a.n(n),r=a(4),i=a.n(r),s=a(0),l=a(32),u=a(35),c=a(33),d=a.n(c),m=a(47),p=a.n(m),g=a(91);const b=d()(l.EuiPanel).withConfig({displayName:"EuiPanelStyled",componentId:"sc-1jf48c9-0"})(["&.full-height,.full-height{height:100%;}.is-not-scrollable{overflow:hidden;}.is-scrollable{overflow:auto;}"]),h=Object(r.memo)((({pageTitle:e,pageDescription:t,pageBody:a,actions:n,headerHasBottomBorder:o,restrictWidth:s,paddingSize:u="l",scrollableBody:c=!1,headerBackComponent:d,children:m,"data-test-subj":h})=>{const f=!(e||t||n||d),E=Object(g.a)(h),y=Object(r.useMemo)((()=>Array.isArray(n)?n:n?[n]:void 0),[n]),O=Object(r.useMemo)((()=>({gutterSize:"s"})),[]),C=Object(r.useMemo)((()=>p()({"is-scrollable":c,"is-not-scrollable":!c,"full-height":!0})),[c]),v=Object(r.useMemo)((()=>f?null:i.a.createElement(l.EuiFlexGroup,{direction:"column",gutterSize:"none",alignItems:"flexStart",wrap:!1,responsive:!1},d&&i.a.createElement(l.EuiFlexItem,{grow:!1},d),i.a.createElement(l.EuiSpacer,{size:"m"}),i.a.createElement(l.EuiFlexItem,{grow:!1},i.a.createElement(l.EuiTitle,{size:"l"},i.a.createElement("span",{"data-test-subj":E("titleHolder")},e))))),[E,d,f,e]);return i.a.createElement(b,{hasShadow:!1,paddingSize:u,"data-test-subj":h,className:"full-height",color:"transparent"},i.a.createElement(l.EuiFlexGroup,{direction:"column",responsive:!1,gutterSize:"none",className:"full-height","data-test-subj":E("root")},!f&&i.a.createElement(l.EuiFlexItem,{grow:!1,"data-test-subj":E("headerContainer")},i.a.createElement(l.EuiPageHeader,{pageTitle:v,description:t,bottomBorder:o,rightSideItems:y,rightSideGroupProps:O,restrictWidth:s,alignItems:"bottom","data-test-subj":E("header")}),i.a.createElement(l.EuiSpacer,{size:"l"})),i.a.createElement(l.EuiFlexItem,{grow:!1},a),i.a.createElement(l.EuiFlexItem,{grow:!0,className:C,"data-test-subj":E("consoleBody")},i.a.createElement("div",{role:"main",className:"full-height"},m))))}));h.displayName="PageLayout";var f=a(37),E=a(129),y=a(148),O=a(160),C=a(141);const v=d.a.div.withConfig({displayName:"OverlayRootContainer",componentId:"sc-11sj1eu-0"})(["border:none;display:block;position:fixed;overflow:hidden;top:calc(("," * 2));bottom:0;right:0;height:calc(100% - "," * 2);width:100%;z-index:",";background-color:",";&.scrolling{overflow:auto;}&.hidden{display:none;}&.padding-xs{padding:",";}&.padding-s{padding:",";}&.padding-m{padding:",";}&.padding-l{padding:",";}&.padding-xl{padding:",";}&.fullScreen{top:0;height:100%;}.fullHeight{height:100%;}"],(({theme:{eui:e}})=>e.euiHeaderHeightCompensation),(({theme:{eui:e}})=>e.euiHeaderHeightCompensation),(({theme:{eui:e}})=>e.euiZFlyout),(({theme:{eui:e}})=>e.euiColorEmptyShade),(({theme:{eui:e}})=>e.euiSizeXS),(({theme:{eui:e}})=>e.euiSizeS),(({theme:{eui:e}})=>e.euiSizeM),(({theme:{eui:e}})=>e.euiSizeL),(({theme:{eui:e}})=>e.euiSizeXL)),j="securitySolution-pageOverlay",x="securitySolution-pageOverlay-isVisible",S="securitySolution-pageOverlay-lock",k="securitySolution-pageOverlay-fullScreen",w=Object(c.createGlobalStyle)(["body.","{overflow:hidden;}body.","{","}body.",".","{.",",.euiOverlayMask,.euiFlyout{z-index:",";}","}"],S,k,O.e,C.z,x,j,(({theme:{eui:e}})=>e[C.A]),O.j),T=()=>{document.body.classList.remove(x)},M=()=>{document.body.classList.remove(S)},I=()=>{document.body.classList.remove(k)},N=Object(r.memo)((({children:e,onHide:t,isHidden:a=!1,enableScrolling:n=!0,hideOnUrlPathnameChange:o=!0,lockDocumentBody:s=!0,appendAsBodyLastNode:u=!0,paddingSize:c,zIndex:d,"data-test-subj":m})=>{const{pathname:g}=Object(f.useLocation)(),b=Object(E.b)(),h=Object(y.b)(),[O,C]=Object(r.useState)(null),N=Object(r.useRef)(),P=Object(r.useCallback)((e=>{N.current=e}),[]),F=Object(r.useMemo)((()=>{const e={};return d&&(e.zIndex=d),e}),[d]),A=Object(r.useMemo)((()=>p()({[j]:!0,scrolling:n,hidden:a,fullScreen:h,"eui-scrollBar":n,"padding-xs":"xs"===c,"padding-s":"s"===c,"padding-m":"m"===c,"padding-l":"l"===c,"padding-xl":"xl"===c})),[n,a,c,h]);return Object(r.useEffect)((()=>{b()&&C((e=>a?null:e||(u&&N.current&&document.body.appendChild(N.current),g)))}),[u,a,b,g]),Object(r.useEffect)((()=>{b()&&t&&o&&!a&&O&&O!==g&&t()}),[o,a,b,t,O,g]),Object(r.useEffect)((()=>(b()&&(a?(T(),M(),I()):(document.body.classList.add(x),s&&document.body.classList.add(S),h&&document.body.classList.add(k))),()=>{M(),T(),I()})),[a,b,s,h]),i.a.createElement(l.EuiPortal,{portalRef:P},i.a.createElement(v,{"data-test-subj":m,className:A,style:F},i.a.createElement(l.EuiFocusTrap,{"data-test-subj":"trap-focus",className:"fullHeight"},e)),i.a.createElement(w,null))}));N.displayName="PageOverlay";const P=s.i18n.translate("xpack.securitySolution.consolePageOverlay.backButtonLabel",{defaultMessage:"Back"}),F=Object(r.memo)((({console:e,onHide:t,isHidden:a,body:n,actions:o,pageTitle:s="",showCloseButton:c=!1})=>{const d=Object(g.a)("consolePageOverlay"),m=Object(r.useCallback)((e=>{e.preventDefault(),t()}),[t]),p=Object(r.useMemo)((()=>a?{}:{pageTitle:s,pageBody:n,headerHasBottomBorder:!1,"data-test-subj":d("layout"),headerBackComponent:i.a.createElement(l.EuiButtonEmpty,{flush:"left",size:"s",iconType:"arrowLeft",onClick:m,"data-test-subj":d("header-back-link")},P),actions:c?[i.a.createElement(l.EuiButton,{fill:!0,onClick:m,minWidth:"auto","data-test-subj":d("doneButton")},i.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.consolePageOverlay.doneButtonLabel",defaultMessage:"Done"})),...null!=o?o:[]]:[...null!=o?o:[]]}),[o,n,d,m,a,s,c]);return i.a.createElement(N,{isHidden:a,"data-test-subj":"consolePageOverlay",onHide:t,paddingSize:"l",enableScrolling:!1},i.a.createElement(h,p,e))}));F.displayName="ConsolePageOverlay";var A=a(1115);const z=i.a.createContext(void 0),B=Object(r.memo)((({storage:e={},children:t})=>{const[a,n]=Object(r.useState)(e),[s]=Object(r.useState)(new Map),l=Object(r.useRef)();l.current=a;const u=Object(r.useCallback)((e=>{var t;if(null===(t=l.current)||void 0===t||!t[e])throw new Error(`Console with id ${e} not found`)}),[]),c=Object(r.useCallback)((e=>{u(e),n((t=>{const a={...t};return Object.entries(a).forEach((([e,t])=>{t.isOpen&&(a[e]={...t,isOpen:!1})})),a[e]={...a[e],isOpen:!0},a}))}),[u]),d=Object(r.useCallback)((e=>{u(e),n((t=>({...t,[e]:{...t[e],isOpen:!1}})))}),[u]),m=Object(r.useCallback)((e=>{u(e),n((t=>{const a={...t};return delete a[e],a}))}),[u]),p=Object(r.useCallback)((e=>{var t;if(null!==(t=l.current)&&void 0!==t&&t[e])return l.current[e].client}),[]),g=Object(r.useCallback)((()=>Object.values(a).map((e=>e.client))),[a]),b=Object(r.useCallback)((e=>{var t;return!(null===(t=l.current)||void 0===t||!t[e])&&l.current[e].isOpen}),[]),h=Object(r.useCallback)((({id:e,meta:t,consoleProps:r,...s})=>{if(a[e])throw new Error(`Console with id ${e} already registered`);const l=Symbol(e),u=c.bind(null,e),p=d.bind(null,e),g=m.bind(null,e),h=b.bind(null,e),f={PageBodyComponent:void 0,PageTitleComponent:void 0,ActionComponents:void 0,...s,client:{id:e,meta:t,show:()=>{setTimeout(u,0)},hide:()=>{setTimeout(p,0)},terminate:()=>{setTimeout(g,0)},isVisible:()=>h()},consoleProps:r,console:i.a.createElement(A.a,o()({},r,{managedKey:l,key:e})),isOpen:!1,key:l};return n((t=>({...t,[e]:f}))),f.client}),[a,d,b,c,m]),f=Object(r.useMemo)((()=>({register:h,show:c,hide:d,terminate:m,getOne:p,getList:g})),[g,p,d,h,c,m]),E=Object(r.useMemo)((()=>({client:f,internal:{getManagedConsole:e=>Object.values(a).find((t=>t.key===e)),getManagedConsoleState:e=>s.get(e),storeManagedConsoleState(e,t){s.set(e,t)}}})),[f,s,a]),y=Object(r.useMemo)((()=>Object.values(a).find((e=>e.isOpen))),[a]),O=Object(r.useMemo)((()=>{var e;return null!==(e=null==y?void 0:y.client.meta)&&void 0!==e?e:{}}),[null==y?void 0:y.client.meta]),C=Object(r.useCallback)((()=>{y&&f.hide(y.client.id)}),[f,y]);return i.a.createElement(z.Provider,{value:E},t,y&&i.a.createElement(F,{onHide:C,console:i.a.createElement(A.a,o()({},y.consoleProps,{managedKey:y.key,key:y.client.id})),isHidden:!y,pageTitle:y.PageTitleComponent&&i.a.createElement(y.PageTitleComponent,{meta:O}),body:y.PageBodyComponent&&i.a.createElement(y.PageBodyComponent,{meta:O}),actions:y.ActionComponents&&y.ActionComponents.map((e=>i.a.createElement(e,{meta:O}))),showCloseButton:y.showCloseButton}))}));B.displayName="ConsoleManager";const H=()=>{const e=Object(r.useContext)(z);if(!e)throw new Error("ConsoleManagerContext not found");return e.client},L=e=>{const t=Object(r.useContext)(z);if(e&&t)return t.internal.getManagedConsole(e)},_=e=>{const t=Object(r.useContext)(z);return Object(r.useMemo)((()=>e&&t?[()=>t.internal.getManagedConsoleState(e),a=>{t.internal.getManagedConsole(e)&&t.internal.storeManagedConsoleState(e,a)}]:[void 0,void 0]),[t,e])}},1074:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(67),o=a(4),r=n.__importDefault(a(1220));t.default=function(e,t){var a=o.useState(t),n=a[0],i=a[1];return r.default((function(){var t=e.subscribe(i);return function(){return t.unsubscribe()}}),[e]),n}},1080:function(e,t,a){"use strict";a.d(t,"a",(function(){return b})),a.d(t,"b",(function(){return h}));var n=a(4),o=a.n(n),r=a(1074),i=a.n(r),s=a(11),l=a(37),u=a(99),c=a(77),d=a(205);const m={activeStep:0,endTourStep:()=>{},incrementStep:()=>{},isTourShown:()=>!1,setStep:()=>{}},p=Object(n.createContext)(m),g=({children:e})=>{var t,a;const{guidedOnboardingApi:r}=Object(c.k)().services.guidedOnboarding,l=i()(null!==(t=null==r?void 0:r.isGuideStepActive$("security",d.b.rules).pipe(Object(s.timeout)(3e4),Object(s.catchError)((e=>Object(s.of)(!1)))))&&void 0!==t?t:Object(s.of)(!1),!1),u=i()(null!==(a=null==r?void 0:r.isGuideStepActive$("security",d.b.alertsCases).pipe(Object(s.timeout)(3e4),Object(s.catchError)((e=>Object(s.of)(!1)))))&&void 0!==a?a:Object(s.of)(!1),!1),m=Object(n.useMemo)((()=>({[d.b.rules]:l,[d.b.alertsCases]:u})),[l,u]),g=Object(n.useCallback)((e=>m[e]),[m]),[b,h]=Object(n.useState)(1),f=Object(n.useCallback)((e=>{h((t=>(t>=d.e[e].length?0:t)+1))}),[]),E=Object(n.useCallback)(((e,t)=>{t<=d.e[e].length&&h(t)}),[]),[y,O]=Object(n.useState)(null);Object(n.useEffect)((()=>{if(!y||!r)return;let e=!1;return(async()=>{await r.completeGuideStep("security",y),e||(O(null),h(1))})(),()=>{e=!0}}),[y,r]);const C={activeStep:b,endTourStep:Object(n.useCallback)((e=>{O(e)}),[]),incrementStep:f,isTourShown:g,setStep:E};return o.a.createElement(p.Provider,{value:C},e)},b=({children:e})=>{const{pathname:t}=Object(l.useLocation)(),a=Object(n.useMemo)((()=>Object(u.isTourPath)(t)?g:p.Provider),[t]);return o.a.createElement(a,{value:m},e)},h=()=>{const e=Object(n.useContext)(p);if(!e)throw new Error("useTourContext can only be called inside of TourContext!");return e}},1084:function(e,t,a){"use strict";var n=a(1070);a.d(t,"a",(function(){return n.a})),a.d(t,"b",(function(){return n.b}))},1088:function(e,t,a){"use strict";a.d(t,"a",(function(){return b})),a.d(t,"b",(function(){return h}));var n=a(4),o=a.n(n),r=a(1),i=a(172),s=a(84),l=a(77),u=a(0);const c=u.i18n.translate("xpack.securitySolution.containers.detectionEngine.alerts.readListsPrivileges.errorDescription",{defaultMessage:"Failed to retrieve lists privileges"}),d=u.i18n.translate("xpack.securitySolution.containers.detectionEngine.alerts.detectionEnginePrivileges.errorFetching",{defaultMessage:"Failed to retreive detection engine privileges"});var m=a(129),p=a(193);var g=a(841);const b=Object(n.createContext)({listPrivileges:{loading:!1,error:void 0,result:void 0},detectionEnginePrivileges:{loading:!1,error:void 0,result:void 0},endpointPrivileges:Object(g.a)(),kibanaSecuritySolutionsPrivileges:{crud:!1,read:!1}}),h=({kibanaCapabilities:e,children:t})=>{const a=!0===e[r.qc].crud,u=!0===e[r.qc].show,[h,f]=Object(n.useState)({crud:a,read:u}),E=((e=!0)=>{const t=Object(l.j)(),{lists:a}=Object(l.k)().services,{start:o,...r}=Object(i.l)(),{addError:u}=Object(s.a)(),d=Object(n.useRef)(new AbortController);return Object(n.useEffect)((()=>{const{loading:n,result:i,error:s}=r;!e||!a||n||i||s||(d.current.abort(),d.current=new AbortController,o({http:t,signal:d.current.signal}))}),[t,a,o,r,e]),Object(n.useEffect)((()=>()=>{d.current.abort()}),[]),Object(n.useEffect)((()=>{const e=r.error;null!=e&&u(e,{title:c})}),[u,r.error]),{loading:r.loading,error:r.error,result:r.result}})(u),y=((e=!0)=>{const{start:t,...a}=Object(m.a)(Object(m.d)(p.i)),{addError:o}=Object(s.a)(),r=Object(n.useRef)(new AbortController);return Object(n.useEffect)((()=>{const{loading:n,result:o,error:i}=a;!e||n||o||i||(r.current.abort(),r.current=new AbortController,t({signal:r.current.signal}))}),[t,a,e]),Object(n.useEffect)((()=>()=>{r.current.abort()}),[]),Object(n.useEffect)((()=>{const e=a.error;null!=e&&o(e,{title:d})}),[o,a.error]),a})(u),O=Object(g.b)();return Object(n.useEffect)((()=>{f((e=>e.read!==u||e.crud!==a?{read:u,crud:a}:e))}),[a,u]),o.a.createElement(b.Provider,{value:{listPrivileges:E,detectionEnginePrivileges:y,endpointPrivileges:O,kibanaSecuritySolutionsPrivileges:h}},t)}},1115:function(e,t,a){"use strict";a.d(t,"a",(function(){return Xe}));var n=a(4),o=a.n(n),r=a(32),i=a(33),s=a.n(i),l=a(1070),u=a(0),c=a(117),d=a(6),m=a.n(d);class parsed_command_input_ParsedCommand{constructor(e){m()(this,"name",void 0),m()(this,"args",void 0),m()(this,"hasArgs",void 0),this.input=e;const t=(e=>{const t=e.trim(),a={name:p(t),args:{}};if(!t)return a;const n=t.indexOf(" "),o=-1===n?[]:t.substring(n).trim().split(/--/);for(const e of o){const t=e.trim();if(t){const e=/[ =]/.exec(t),n=(e?t.substring(0,e.index).trim():t).trim();if(n)if(a.args[n]||(a.args[n]=[]),n!==t&&e){let o=t.substring(e.index+1).trim().replace(/\\-\\-/g,"--");'"'===o.charAt(0)&&(o=o.substring(1)),'"'===o.charAt(o.length-1)&&(o=o.substring(0,o.length-1)),a.args[n].push(o)}else a.args[n].push(!0)}}return a})(e);this.name=t.name,this.args=t.args,this.hasArgs=Object.keys(this.args).length>0}hasArg(e){return e in this.args}}const p=e=>{const t=e.trimStart();if(!t)return"";const a=e.indexOf(" ");return-1===a?t:t.substring(0,a)},g=e=>{let t="",a="";const n=[];if(e.args)for(const[o,r]of Object.entries(e.args))r.required?(t.length&&(t+=" "),t+=`--${o}`):r.exclusiveOr?n.push(`--${o}`):(a.length&&(a+=" "),a+=`--${o}`);const o=({required:e,exclusive:t,optional:a})=>`${e||""}${t?` ${t}`:""} ${a&&a.length>0?`[${a}]`:""}`.trim();return n.length>0?n.map((e=>o({required:t,exclusive:e,optional:a}))):t||a?[o({required:t,optional:a})]:[]},b=u.i18n.translate("xpack.securitySolution.handleInputAreaState.inputPlaceholderText",{defaultMessage:"Submit response action"}),h=(e,{type:t,payload:a})=>{switch(t){case"updateInputPopoverState":if(e.input.showPopover!==a.show)return{...e,input:{...e.input,showPopover:a.show}};break;case"updateInputHistoryState":return{...e,input:{...e.input,history:[{id:Object(c.v4)(),input:a.command},...e.input.history.slice(0,99)]}};case"updateInputTextEnteredState":const{textEntered:t,rightOfCursor:n={text:""}}="function"==typeof a?a({textEntered:e.input.textEntered,rightOfCursor:e.input.rightOfCursor}):a;if(e.input.textEntered!==t||e.input.rightOfCursor!==n){const a=t+n.text,o=-1!==a.trimStart().indexOf(" ")?p(a):"";return{...e,input:{...e.input,textEntered:t,rightOfCursor:n,commandEntered:o}}}break;case"updateInputPlaceholderState":if(e.input.placeholder!==a.placeholder)return{...e,input:{...e.input,placeholder:a.placeholder||b}};break;case"setInputState":if(e.input.visibleState!==a.value)return{...e,input:{...e.input,visibleState:a.value}}}return e};var f=a(35),E=a(824),y=a(91);const O=()=>te().state.dataTestSubj,C={className:"euiTruncateText"},v=Object(n.memo)((({commandDef:e})=>{const t=Object(n.useMemo)((()=>g(e).map(((t,a)=>o.a.createElement(o.a.Fragment,{key:`helpUsage-${a}`},a>0&&o.a.createElement(r.EuiSpacer,{size:"xs"}),o.a.createElement(E.a,null,`${e.name} ${t}`))))),[e]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(r.EuiDescriptionList,{compressed:!0,type:"column",className:"descriptionList-20_80",listItems:[{title:o.a.createElement(E.a,null,u.i18n.translate("xpack.securitySolution.console.commandUsage.inputUsage",{defaultMessage:"Usage"})),description:t&&t.length>0?t:e.name}],descriptionProps:C,titleProps:C}),o.a.createElement(r.EuiSpacer,{size:"s"}),e.exampleUsage&&o.a.createElement(r.EuiDescriptionList,{compressed:!0,type:"column",className:"descriptionList-20_80",listItems:[{title:o.a.createElement(E.a,null,u.i18n.translate("xpack.securitySolution.console.commandUsage.exampleUsage",{defaultMessage:"Example"})),description:o.a.createElement(E.a,null,e.exampleUsage)}],descriptionProps:C,titleProps:C}))}));v.displayName="CommandInputUsage";const j=Object(n.memo)((({commandDef:e})=>{const t=Object(y.a)(O()),a=Object(n.useMemo)((()=>{var t;return Object.keys(null!==(t=e.args)&&void 0!==t?t:[]).length>0}),[e.args]),i=Object(n.useMemo)((()=>a&&e.args?Object.entries(e.args).reduce(((e,t)=>{const a={title:`--${t[0]}`,description:t[1].about};return t[1].required?e.required.push(a):t[1].exclusiveOr?e.exclusiveOr.push(a):e.optional.push(a),e}),{required:[],exclusiveOr:[],optional:[]}):{required:[],exclusiveOr:[],optional:[]}),[e.args,a]),s=(a,n)=>{const i=n.map((e=>o.a.createElement("div",null,o.a.createElement(E.a,{bold:!0,inline:!0},e.title),o.a.createElement(E.a,{inline:!0},` - ${e.description}`))));return o.a.createElement(o.a.Fragment,null,o.a.createElement(r.EuiSpacer,{size:"s"}),e.args&&o.a.createElement(r.EuiDescriptionList,{compressed:!0,type:"column",className:"descriptionList-20_80",listItems:[{title:o.a.createElement(E.a,null,a),description:i}],descriptionProps:C,titleProps:C,"data-test-subj":t("commandUsage-options")}))};return o.a.createElement(r.EuiPanel,{paddingSize:"none",color:"transparent","data-test-subj":t("commandUsage")},o.a.createElement(r.EuiDescriptionList,{compressed:!0,type:"column",className:"descriptionList-20_80",listItems:[{title:o.a.createElement(E.a,null,u.i18n.translate("xpack.securitySolution.console.commandUsage.about",{defaultMessage:"About"})),description:o.a.createElement(E.a,null,e.about)}],descriptionProps:C,titleProps:C,"data-test-subj":t("commandUsage-options")}),o.a.createElement(r.EuiSpacer,{size:"s"}),o.a.createElement(v,{commandDef:e}),i.required&&i.required.length>0&&s(u.i18n.translate("xpack.securitySolution.console.commandUsage.requiredLabel",{defaultMessage:"Required parameters"}),i.required),i.exclusiveOr&&i.exclusiveOr.length>0&&s(u.i18n.translate("xpack.securitySolution.console.commandUsage.exclusiveOr",{defaultMessage:"Include only one parameter"}),i.exclusiveOr),i.optional&&i.optional.length>0&&s(u.i18n.translate("xpack.securitySolution.console.commandUsage.optional",{defaultMessage:"Optional parameters"}),i.optional))}));j.displayName="CommandUsage";const x=Object(n.memo)((({title:e,children:t})=>{const a=Object(y.a)(O());return o.a.createElement(r.EuiPanel,{hasShadow:!1,color:"transparent",paddingSize:"none","data-test-subj":a("helpOutput")},t)}));x.displayName="HelpOutput";const S=Object(n.memo)((e=>{const t=e.command.commandDefinition.HelpComponent;return Object(n.useEffect)((()=>{t||e.setStatus("success")}),[t,e]),t?o.a.createElement(t,e):o.a.createElement(x,{command:e.command,title:u.i18n.translate("xpack.securitySolution.console.buildInCommand.helpArgument.helpTitle",{defaultMessage:"{cmdName} command",values:{cmdName:e.command.args.name}})},o.a.createElement(j,{commandDef:e.command.commandDefinition}))}));S.displayName="HelpCommandArgument";const k=u.i18n.translate("xpack.securitySolution.console.unsupportedMessageCallout.title",{defaultMessage:"Unsupported"}),w=Object(n.memo)((({children:e,header:t=k,"data-test-subj":a})=>o.a.createElement("div",{"data-test-subj":a},o.a.createElement(r.EuiText,{size:"s"},o.a.createElement(r.EuiTextColor,{color:"danger"},t)),o.a.createElement(r.EuiSpacer,{size:"s"}),e)));w.displayName="UnsupportedMessageCallout";const T=Object(n.memo)((({command:e,setStatus:t})=>{const a=Object(y.a)(O()),i=Object(n.useMemo)((()=>o.a.createElement(E.a,null,o.a.createElement(f.FormattedMessage,{id:"xpack.securitySolution.console.unknownCommand.helpMessage",defaultMessage:"The text you entered {userInput} is unsupported! Click {helpIcon} {boldHelp} or type {helpCmd} for assistance.",values:{userInput:o.a.createElement(E.a,{bold:!0,inline:!0},e.input),helpIcon:o.a.createElement(r.EuiIcon,{type:"help"}),helpCmd:o.a.createElement(E.a,{bold:!0,inline:!0},"help"),boldHelp:o.a.createElement("strong",null,o.a.createElement(f.FormattedMessage,{id:"xpack.securitySolution.console.unknownCommand.helpMessage.help",defaultMessage:"Help"}))}}))),[e.input]);return Object(n.useEffect)((()=>{t("success")}),[t]),o.a.createElement(w,{header:o.a.createElement(E.a,{textColor:"danger"},o.a.createElement(f.FormattedMessage,{id:"xpack.securitySolution.console.unknownCommand.title",defaultMessage:"Unsupported text/command"})),"data-test-subj":a("unknownCommandError")},i)}));T.displayName="UnknownCommand";const M=Object(n.memo)((({command:e,setStatus:t,store:a})=>{const i=Object(y.a)(O());return Object(n.useEffect)((()=>{t("success")}),[t]),o.a.createElement(w,{header:o.a.createElement(E.a,{textColor:"danger"},o.a.createElement(f.FormattedMessage,{id:"xpack.securitySolution.console.badArgument.title",defaultMessage:"Unsupported argument"})),"data-test-subj":i("badArgument")},o.a.createElement("div",{"data-test-subj":i("badArgument-message")},a.errorMessage),o.a.createElement(r.EuiSpacer,{size:"s"}),o.a.createElement(v,{commandDef:e.commandDefinition}),o.a.createElement(E.a,null,o.a.createElement(r.EuiSpacer,{size:"m"}),o.a.createElement(f.FormattedMessage,{id:"xpack.securitySolution.console.badArgument.helpMessage",defaultMessage:"Enter {helpCmd} for further assistance.",values:{helpCmd:o.a.createElement(E.a,{bold:!0,inline:!0},`${e.commandDefinition.name} --help`)}})))}));M.displayName="BadArgument";const I=Object(n.memo)((({command:e,setStatus:t,store:a})=>{const i=Object(y.a)(O());return Object(n.useEffect)((()=>{t("success")}),[t]),o.a.createElement(w,{header:o.a.createElement(E.a,{textColor:"error"},o.a.createElement(f.FormattedMessage,{id:"xpack.securitySolution.console.validationError.title",defaultMessage:"Unsupported action"})),"data-test-subj":i("validationError")},o.a.createElement("div",{"data-test-subj":i("validationError-message")},a.errorMessage),o.a.createElement(r.EuiSpacer,{size:"s"}),o.a.createElement(v,{commandDef:e.commandDefinition}),o.a.createElement(E.a,null,o.a.createElement(r.EuiSpacer,{size:"m"}),o.a.createElement(f.FormattedMessage,{id:"xpack.securitySolution.console.validationError.helpMessage",defaultMessage:"Enter {helpCmd} for further assistance.",values:{helpCmd:o.a.createElement(E.a,{bold:!0,inline:!0},`${e.commandDefinition.name} --help`)}})))}));I.displayName="ValidationError";const N=e=>`--${e}`,P=(e,t)=>{const a=h(e,{type:"updateInputHistoryState",payload:{command:t.command.input}});return a.commandHistory=[...e.commandHistory,t],a},F={name:"unknown-command",about:"unknown command",RenderComponent:()=>null},A=(e={})=>({status:"pending",store:e}),z=(e,t)=>({...e,commandDefinition:{...e.commandDefinition,RenderComponent:t}}),B=(e,t=A(),a=!0)=>({id:Object(c.v4)(),isValid:a,enteredAt:(new Date).toISOString(),command:e,state:t}),H=()=>te().dispatch,L=Object(n.memo)((({status:e,setStatus:t})=>{const a=H();return Object(n.useEffect)((()=>{"pending"===e&&a({type:"clear"}),t("success")}),[e,t,a]),null}));L.displayName="ClearCommand";var _=a(7);const R=e=>{if(!e.mustHaveArgs||!e.args)return e.name;let t=!1;const a=Object.entries(e.args).reduce(((e,[a,n])=>n.required?(e[a]=n,e):n.exclusiveOr&&!t?(t=!0,e[a]=n,e):e),{});return`${e.name} --${Object.keys(a).join(" --")}`};var D=a(77);const G=s()(r.EuiBasicTable).withConfig({displayName:"StyledEuiBasicTable",componentId:"sc-1j9ijx9-0"})(["margin-top:",";.euiTableHeaderCell{.euiTableCellContent__text{color:",";font-size:",";padding-bottom:",";padding-left:",";}}"],(({theme:{eui:e}})=>e.euiSizeS),(({theme:{eui:e}})=>e.euiTextColor),(({theme:{eui:e}})=>e.euiFontSize),(({theme:{eui:e}})=>e.euiSizeS),(({theme:{eui:e}})=>e.euiSizeS)),U=s()(r.EuiCallOut).withConfig({displayName:"StyledEuiCallOut",componentId:"sc-1j9ijx9-1"})(["margin:",";padding:",";border-radius:",";"],(({theme:{eui:e}})=>e.euiSize),(({theme:{eui:e}})=>e.euiSize),(({theme:{eui:e}})=>e.euiSizeXS)),$=s()(r.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-1j9ijx9-2"})(["padding-left:",";"],(({theme:{eui:e}})=>e.euiSizeS)),q=s()(r.EuiFlexGrid).withConfig({displayName:"StyledEuiFlexGrid",componentId:"sc-1j9ijx9-3"})(["@media only screen and (min-width:","){max-width:75%;}@media only screen and (min-width:","){max-width:50%;}"],(e=>e.theme.eui.euiBreakpoints.l),(e=>e.theme.eui.euiBreakpoints.xl)),K=s()(r.EuiBadge).withConfig({displayName:"StyledEuiBadge",componentId:"sc-1j9ijx9-4"})(["font-size:10px !important;span{color:"," !important;}"],(({theme:{eui:e}})=>e.euiShadowColor)),V=Object(n.memo)((({commands:e,display:t="default"})=>{const a=Object(y.a)(O()),i=H(),{docLinks:s}=Object(D.k)().services,l=e.filter((e=>!0!==e.helpHidden)),c=Object(n.useMemo)((()=>{var e;return o.a.createElement(r.EuiDescriptionList,{compressed:!0,listItems:[{title:o.a.createElement(K,null,o.a.createElement(E.a,{inline:!0,bold:!0},null===(e=Y.find((e=>"--help"===e.name)))||void 0===e?void 0:e.name)),description:o.a.createElement(r.EuiText,{color:"subdued",size:"xs"},o.a.createElement(f.FormattedMessage,{id:"xpack.securitySolution.console.commandList.footerText",defaultMessage:"For more help with the individual commands use the --help argument. Ex: processes --help"}))}]})}),[]),d=u.i18n.translate("xpack.securitySolution.console.commandList.otherCommandsGroup.label",{defaultMessage:"Other commands"}),m=Object(n.useCallback)((e=>()=>{i({type:"updateInputTextEnteredState",payload:()=>({textEntered:e})}),i({type:"addFocusToKeyCapture"})}),[i]),p=Object(n.useMemo)((()=>Object.values(Object(_.groupBy)(l,"helpGroupLabel")).reduce(((e,t)=>(void 0!==t[0].helpGroupPosition?(e[t[0].helpGroupPosition]&&(e[e.length]=e[t[0].helpGroupPosition]),e[t[0].helpGroupPosition]=Object(_.sortBy)(t,"helpCommandPosition")):t.length&&e.push(Object(_.sortBy)(t,"helpCommandPosition")),e)),[])),[l]),g=Object(n.useCallback)((e=>e[0].helpGroupLabel===J.supporting.label?[...Y,...e].map((t=>{var a,n;return{[null!==(a=null===(n=e[0])||void 0===n?void 0:n.helpGroupLabel)&&void 0!==a?a:d]:t}})):e.map((t=>{var a,n;return{[null!==(a=null===(n=e[0])||void 0===n?void 0:n.helpGroupLabel)&&void 0!==a?a:d]:t}}))),[d]),b=Object(n.useCallback)((e=>{var t,n,i,s;return[{field:null!==(t=null===(n=e[0])||void 0===n?void 0:n.helpGroupLabel)&&void 0!==t?t:d,name:null!==(i=null===(s=e[0])||void 0===s?void 0:s.helpGroupLabel)&&void 0!==i?i:d,render:e=>{const t=R(e);return o.a.createElement($,{alignItems:"center"},o.a.createElement(r.EuiFlexItem,{grow:1},o.a.createElement(r.EuiDescriptionList,{listItems:[{title:o.a.createElement(r.EuiBadge,null,t),description:o.a.createElement(o.a.Fragment,null,o.a.createElement(r.EuiSpacer,{size:"xs"}),o.a.createElement(r.EuiText,{color:"subdued",size:"xs"},e.about))}],"data-test-subj":a("commandList-command")})),e.helpGroupLabel!==J.supporting.label&&!0!==e.helpHidden&&e.RenderComponent&&o.a.createElement(r.EuiFlexItem,{grow:!1},o.a.createElement(r.EuiToolTip,{content:!0===e.helpDisabled?u.i18n.translate("xpack.securitySolution.console.commandList.disabledButtonTooltip",{defaultMessage:"Unsupported command"}):u.i18n.translate("xpack.securitySolution.console.commandList.addButtonTooltip",{defaultMessage:"Add to text bar"})},o.a.createElement(r.EuiButtonIcon,{iconType:"plusInCircle","aria-label":`updateTextInputCommand-${e.name}`,onClick:m(`${t} `),isDisabled:!0===e.helpDisabled}))))}}]}),[a,d,m]),h=Object(n.useCallback)((e=>e.filter((e=>"help"!==e.name&&"clear"!==e.name))),[]);if("table"===t){const e=[o.a.createElement(f.FormattedMessage,{id:"xpack.securitySolution.console.commandList.callout.multipleResponses",defaultMessage:"You can enter consecutive response actions — no need to wait for previous actions to complete."}),o.a.createElement(f.FormattedMessage,{id:"xpack.securitySolution.console.commandList.callout.leavingResponder",defaultMessage:"Leaving the response console does not terminate any actions that have been submitted."}),o.a.createElement(f.FormattedMessage,{id:"xpack.securitySolution.console.commandList.callout.visitSupportSections",defaultMessage:"{learnMore} about response actions and using the console.",values:{learnMore:o.a.createElement(r.EuiLink,{href:s.links.securitySolution.responseActions,target:"_blank"},o.a.createElement(f.FormattedMessage,{id:"xpack.securitySolution.console.commandList.callout.readMoreLink",defaultMessage:"Learn more"}))}})],t=o.a.createElement(U,{title:o.a.createElement(f.FormattedMessage,{id:"xpack.securitySolution.console.commandList.callout.title",defaultMessage:"Helpful tips:"})},o.a.createElement("ul",null,e.map(((e,t)=>o.a.createElement("li",{key:t},o.a.createElement(r.EuiText,{size:"s"},e))))));return o.a.createElement(o.a.Fragment,null,p.map((e=>o.a.createElement(G,{items:g(e),columns:b(e)}))),t)}return o.a.createElement(o.a.Fragment,null,o.a.createElement(r.EuiSpacer,{size:"s"}),p.map((e=>{const t=e[0].helpGroupLabel,n=h(e);return 0===n.length?null:o.a.createElement(q,{columns:3,responsive:!1,gutterSize:"l",key:t,direction:"column"},n.map((e=>{const t=R(e);return o.a.createElement(r.EuiFlexItem,{key:e.name},o.a.createElement(r.EuiDescriptionList,{compressed:!0,listItems:[{title:o.a.createElement(r.EuiToolTip,{content:t},o.a.createElement(K,null,o.a.createElement(E.a,{inline:!0,bold:!0},t))),description:o.a.createElement(r.EuiText,{color:"subdued",size:"xs"},e.about)}],"data-test-subj":a("commandList-command")}))})))})),o.a.createElement(r.EuiSpacer,{size:"xl"}),c)}));V.displayName="CommandList";const W=()=>te().state.commands,X=Object(n.memo)((e=>{const t=W(),a=te().state.HelpComponent;return Object(n.useEffect)((()=>{a||e.setStatus("success")}),[a,e]),a?o.a.createElement(a,e):o.a.createElement(x,{command:e.command,title:u.i18n.translate("xpack.securitySolution.console.builtInCommands.help.helpTitle",{defaultMessage:"Available commands"})},o.a.createElement(V,{commands:t}))}));X.displayName="HelpCommand";const J=Object.freeze({supporting:{label:u.i18n.translate("xpack.securitySolution.console.builtInCommands.groups.supporting",{defaultMessage:"Supporting commands & parameters"})}}),Y=Object.freeze([{name:"--comment",about:u.i18n.translate("xpack.securitySolution.console.commandList.commonArgs.comment",{defaultMessage:"Add comment to any action Ex: isolate --comment your comment"})},{name:"--help",about:u.i18n.translate("xpack.securitySolution.console.commandList.commonArgs.help",{defaultMessage:"Command assistance Ex: isolate --help"})}]),Q=(e,t)=>{var a,n,r,i;let s=e;switch(t.type){case"scrollDown":e.scrollToBottom();break;case"addFocusToKeyCapture":null===(a=e.keyCapture)||void 0===a||null===(n=a.current)||void 0===n||n.focus();break;case"removeFocusFromKeyCapture":null===(r=e.keyCapture)||void 0===r||null===(i=r.current)||void 0===i||i.blur();break;case"updateFooterContent":e.footerContent!==t.payload.value&&(s={...e,footerContent:t.payload.value});break;case"executeCommand":s=((e,t)=>{const a=(n=t.payload.input,new parsed_command_input_ParsedCommand(n));var n;if(""===a.name)return e;const{commands:r}=e,i=r.find((e=>e.name===a.name));if(!i)return P(e,B({input:a.input,args:a,commandDefinition:{...F,RenderComponent:T}},void 0,!1));const s={input:a.input,args:a,commandDefinition:i},l=(c=i.args)?Object.entries(c).filter((([e,t])=>t.required)).map((([e])=>e)):[];var c;const d=(e=>e?Object.entries(e).reduce(((e,[t,a])=>(a.exclusiveOr&&e.push(t),e)),[]):[])(i.args),m=o.a.createElement(E.a,null,o.a.createElement(f.FormattedMessage,{id:"xpack.securitySolution.console.commandValidation.exclusiveOr",defaultMessage:"This command supports only one of the following arguments: {argNames}",values:{argNames:o.a.createElement(E.a,{bold:!0,inline:!0},d.map(N).join(", "))}}));if(a.hasArgs){if(a.hasArg("help"))return Object.keys(a.args).length>1||a.args.help.length>1||!0!==a.args.help[0]?P(e,B(z(s,M),void 0,!1)):P(e,B(z(s,S),void 0,!1));if(!i.args||0===Object.keys(i.args).length)return P(e,B(z(s,M),A({errorMessage:u.i18n.translate("xpack.securitySolution.console.commandValidation.noArgumentsSupported",{defaultMessage:"Command does not support any arguments"})}),!1));const t=((e,t)=>{const a=[];return Object.keys(e).forEach((e=>{"help"===e||t&&t[e]||a.push(e)})),a})(a.args,i.args);if(t.length)return P(e,B(z(s,M),A({errorMessage:o.a.createElement(E.a,null,o.a.createElement(f.FormattedMessage,{id:"xpack.securitySolution.console.commandValidation.unknownArgument",defaultMessage:"The following {command} {countOfInvalidArgs, plural, =1 {argument is} other {arguments are}} not supported by this command: {unknownArgs}",values:{countOfInvalidArgs:t.length,command:o.a.createElement(E.a,{bold:!0,inline:!0},a.name),unknownArgs:o.a.createElement(E.a,{bold:!0,inline:!0},t.map(N).join(", "))}}))}),!1));for(const t of l)if(!a.args[t])return P(e,B(z(s,M),A({errorMessage:o.a.createElement(E.a,null,u.i18n.translate("xpack.securitySolution.console.commandValidation.missingRequiredArg",{defaultMessage:"Missing required argument: {argName}",values:{argName:N(t)}}))}),!1));if(d.filter((e=>a.args[e])).length>1)return P(e,B(z(s,M),A({errorMessage:m}),!1));for(const t of Object.keys(a.args)){var p;const n=null===(p=i.args)||void 0===p?void 0:p[t],r=a.args[t];if(!n)return P(e,B(z(s,M),A({errorMessage:o.a.createElement(E.a,null,u.i18n.translate("xpack.securitySolution.console.commandValidation.unsupportedArg",{defaultMessage:"Unsupported argument: {argName}",values:{argName:N(t)}}))}),!1));if(!n.allowMultiples&&Array.isArray(r)&&r.length>1)return P(e,B(z(s,M),A({errorMessage:o.a.createElement(E.a,null,u.i18n.translate("xpack.securitySolution.console.commandValidation.argSupportedOnlyOnce",{defaultMessage:"Argument can only be used once: {argName}",values:{argName:N(t)}}))}),!1));if(n.validate){const a=n.validate(r);if(!0!==a)return P(e,B(z(s,M),A({errorMessage:o.a.createElement(E.a,null,u.i18n.translate("xpack.securitySolution.console.commandValidation.invalidArgValue",{defaultMessage:"Invalid argument value: {argName}. {error}",values:{argName:N(t),error:a}}))}),!1))}}}else{if(l.length>0)return P(e,B(z(s,M),A({errorMessage:o.a.createElement(E.a,null,u.i18n.translate("xpack.securitySolution.console.commandValidation.mustHaveArgs",{defaultMessage:"Missing required arguments: {requiredArgs}",values:{requiredArgs:l.map((e=>N(e))).join(", ")}}))}),!1));if(d.length>0)return P(e,B(z(s,M),A({errorMessage:m}),!1));if(i.mustHaveArgs)return P(e,B(z(s,M),A({errorMessage:o.a.createElement(E.a,null,u.i18n.translate("xpack.securitySolution.console.commandValidation.oneArgIsRequired",{defaultMessage:"At least one argument must be used"}))}),!1))}if(i.validate){const t=i.validate(s);if(!0!==t)return P(e,B(z(s,I),A({errorMessage:t}),!1))}return P(e,B(s))})(e,t);break;case"updateCommandStatusState":case"updateCommandStoreState":s=((e,{type:t,payload:{id:a,value:n}})=>{let o=!1;const r=e.commandHistory.map((e=>{if(o||e.id!==a)return e;o=!0;const r={...e,state:{...e.state}};switch(t){case"updateCommandStoreState":r.state.store=n(r.state.store);break;case"updateCommandStatusState":if(r.state.status===n)return o=!1,e;r.state.status=n}return r}));return o?{...e,commandHistory:r}:e})(e,t);break;case"showSidePanel":s=((e,t)=>"showSidePanel"===t.type&&e.sidePanel.show!==t.payload.show?{...e,sidePanel:{...e.sidePanel,show:t.payload.show}}:e)(e,t);break;case"updateInputPopoverState":case"updateInputHistoryState":case"updateInputTextEnteredState":case"updateInputPlaceholderState":case"setInputState":s=h(e,t);break;case"clear":s={...e,commandHistory:[]}}return s},Z=Object(n.createContext)(null),ee=Object(n.memo)((({commands:e,scrollToBottom:t,keyCapture:a,HelpComponent:r,dataTestSubj:i,managedKey:s,children:c})=>{const[d,m]=Object(l.d)(s),p=Object(n.useCallback)((e=>(({commands:e,...t},a)=>{const n=[{name:"help",about:u.i18n.translate("xpack.securitySolution.console.builtInCommands.helpAbout",{defaultMessage:"List all available commands"}),RenderComponent:X,helpGroupLabel:J.supporting.label,helpCommandPosition:1},{name:"clear",about:u.i18n.translate("xpack.securitySolution.console.builtInCommands.clearAbout",{defaultMessage:"Clear console screen"}),RenderComponent:L,helpGroupLabel:J.supporting.label,helpCommandPosition:0}].concat(e),o=null!=a?a:{commands:n,...t,commandHistory:[],sidePanel:{show:null},footerContent:"",input:{textEntered:"",rightOfCursor:{text:""},commandEntered:"",placeholder:b,showPopover:void 0,history:[],visibleState:void 0}};return a&&Object.assign(o,{commands:n,...t}),o})(e,d?d():void 0)),[d]),[g,h]=Object(n.useReducer)(Q,{commands:e,scrollToBottom:t,keyCapture:a,HelpComponent:r,dataTestSubj:i},p);return Object(n.useEffect)((()=>{m&&m(g)}),[g,m]),o.a.createElement(Z.Provider,{value:{state:g,dispatch:h}},c)}));ee.displayName="ConsoleStateProvider";const te=()=>{const e=Object(n.useContext)(Z);if(!e)throw new Error("ConsoleStateContext not defined");return e},ae=()=>te().state.input.visibleState,ne=Object(n.memo)((()=>{const e=te().state.footerContent,t=Object(y.a)(O()),a=ae(),i=Object(n.useMemo)((()=>"error"===a?"danger":"subdued"),[a]);return o.a.createElement(r.EuiPanel,{hasShadow:!1,paddingSize:"none",color:"transparent","data-test-subj":t("footer")},o.a.createElement(r.EuiText,{size:"xs",color:i,className:"font-style-italic"},e||o.a.createElement(o.a.Fragment,null," ")))}));ne.displayName="ConsoleFooter";const oe=()=>te().state.sidePanel,re=u.i18n.translate("xpack.securitySolution.console.layoutHeader.helpButtonLabel",{defaultMessage:"Show help"}),ie=s()(r.EuiButtonEmpty).withConfig({displayName:"StyledEuiButtonEmpty",componentId:"sc-1q5d3c6-0"})(["margin-left:auto;height:inherit;"]),se=Object(n.memo)((({TitleComponent:e})=>{const t=H(),a="help"===oe().show,i=Object(n.useCallback)((()=>{t({type:"showSidePanel",payload:{show:a?null:"help"}})}),[t,a]);return o.a.createElement(r.EuiFlexGroup,{gutterSize:"none",alignItems:"center",justifyContent:"spaceBetween",responsive:!1},o.a.createElement(r.EuiFlexItem,{grow:1,className:"eui-textTruncate"},e?o.a.createElement(e,null):""),!a&&o.a.createElement(r.EuiFlexItem,{grow:1},o.a.createElement(ie,{style:{marginLeft:"auto"},onClick:i,iconType:"help",title:re,"aria-label":re,isSelected:a},o.a.createElement(f.FormattedMessage,{id:"xpack.securitySolution.console.layoutHeader.helpButtonTitle",defaultMessage:"Help"}))))}));se.displayName="ConsoleHeader";var le=a(82),ue=a.n(le),ce=a(47),de=a.n(ce);class EnteredInput{constructor(e,t){this.leftOfCursorText=e,this.rightOfCursorText=t}replaceSelection(e,t){const a=this.leftOfCursorText+this.rightOfCursorText;this.leftOfCursorText=a.substring(0,a.indexOf(e))+t,this.rightOfCursorText=a.substring(a.indexOf(e)+e.length)}getLeftOfCursorText(){return this.leftOfCursorText}getRightOfCursorText(){return this.rightOfCursorText}getFullText(){return this.leftOfCursorText+this.rightOfCursorText}moveCursorTo(e){switch(e){case"end":this.leftOfCursorText=this.leftOfCursorText+this.rightOfCursorText,this.rightOfCursorText="";break;case"home":this.rightOfCursorText=this.leftOfCursorText+this.rightOfCursorText,this.leftOfCursorText="";break;case"left":this.leftOfCursorText.length&&(this.rightOfCursorText=this.leftOfCursorText.charAt(this.leftOfCursorText.length-1)+this.rightOfCursorText,this.leftOfCursorText=this.leftOfCursorText.substring(0,this.leftOfCursorText.length-1));break;case"right":this.rightOfCursorText.length&&(this.leftOfCursorText=this.leftOfCursorText+this.rightOfCursorText.charAt(0),this.rightOfCursorText=this.rightOfCursorText.substring(1))}}addValue(e,t=""){t.length&&e.length?this.replaceSelection(t,e):this.leftOfCursorText+=e}deleteChar(e=""){e?this.replaceSelection(e,""):this.rightOfCursorText&&(this.rightOfCursorText=this.rightOfCursorText.substring(1))}backspaceChar(e=""){e?this.replaceSelection(e,""):this.leftOfCursorText&&(this.leftOfCursorText=this.leftOfCursorText.substring(0,this.leftOfCursorText.length-1))}}const me=u.i18n.translate("xpack.securitySolution.inputCapture.ariaPlaceHolder",{defaultMessage:"Enter a command"}),pe=()=>{const e=getSelection();e&&e.removeAllRanges()},ge=s.a.div.withConfig({displayName:"InputCaptureContainer",componentId:"sc-8amayv-0"})([".focus-container{outline:none !important;}.textSelectionBoundaryHelper{opacity:0;position:absolute;top:-100vh;left:-100vw;}.invisible-input{&,&:focus{border:none;outline:none;background-image:none;background-color:transparent;-webkit-box-shadow:none;-moz-box-shadow:none;box-shadow:none;animation:none !important;width:1ch !important;position:absolute;opacity:0;top:-100vh;left:-100vw;}"]),be=Object(n.memo)((({onCapture:e,focusRef:t,onChangeFocus:a,children:r})=>{const i=Object(y.a)(O()),s=Object(n.useRef)(null),l=Object(n.useRef)(null),u=Object(n.useRef)(null),c=Object(n.useCallback)((()=>{if(s.current){var e,t,a;const n=document.getSelection(),o=(null!==(e=null==n?void 0:n.toString())&&void 0!==e?e:"").replace(/[\r\n]/g,""),r=!(!s.current||!n)&&(null===(t=s.current)||void 0===t?void 0:t.contains(n.focusNode))&&(null===(a=s.current)||void 0===a?void 0:a.contains(n.anchorNode));return n&&0!==o.length&&r?o:""}return""}),[]),d=Object(n.useCallback)((t=>{if(t.metaKey||t.ctrlKey){if("a"===t.key){t.preventDefault();const e=window.getSelection();if(e&&l.current){const t=document.createRange();t.selectNodeContents(l.current),t.toString().length>0&&(e.removeAllRanges(),e.addRange(t))}}return}const a=/^[\w\d]{2}/.test(t.key)?"":t.key,n=c(),o=Object(_.pick)(t,["key","altKey","ctrlKey","keyCode","metaKey","repeat","shiftKey"]);e({value:a,selection:n,eventDetails:o}),n&&pe()}),[c,e]),m=Object(n.useCallback)((t=>{t.preventDefault(),t.stopPropagation();const a=t.clipboardData.getData("text").replace(/[\r\n]/g,""),n=c();e({value:a,selection:n,eventDetails:{altKey:!1,ctrlKey:!1,key:"Meta",keyCode:91,metaKey:!0,repeat:!1,shiftKey:!1}}),n&&pe()}),[c,e]),p=Object(n.useCallback)((()=>{a&&a(!0)}),[a]),g=Object(n.useCallback)((()=>{a&&a(!1)}),[a]),b=Object(n.useMemo)((()=>({focus:(e=!1)=>{var t,a,n;!e&&(null!==(t=null===(a=window.getSelection())||void 0===a?void 0:a.toString())&&void 0!==t?t:"").length>0||document.activeElement===u.current||null===(n=u.current)||void 0===n||n.focus()},blur:()=>{var e;u.current&&document.activeElement===u.current&&(null===(e=u.current)||void 0===e||e.blur())}})),[]);return t&&(t.current=b),o.a.createElement(ge,{"data-test-subj":i("inputCapture"),onKeyDown:d,onPaste:m},o.a.createElement("div",{role:"textbox","aria-placeholder":me,tabIndex:0,ref:s,className:"focus-container","data-test-subj":i("keyCapture-input"),onBlur:g,onFocus:p},o.a.createElement("div",{className:"textSelectionBoundaryHelper"}," "),o.a.createElement("div",{ref:l,className:"text-container"},r),o.a.createElement("div",{className:"textSelectionBoundaryHelper"}," "),o.a.createElement("input",{ref:u,type:"text",value:"",tabIndex:-1,onPaste:m,onChange:()=>{},spellCheck:"false",className:"invisible-input"})))}));be.displayName="InputCapture";const he=()=>te().state.input.showPopover,fe=u.i18n.translate("xpack.securitySolution.useInputHints.noArguments",{defaultMessage:"Hit enter to execute"}),Ee=()=>{const e=te().state.input;return Object(n.useMemo)((()=>({textEntered:e.textEntered,rightOfCursor:e.rightOfCursor,fullTextEntered:e.textEntered+e.rightOfCursor.text})),[e.rightOfCursor,e.textEntered])},ye=s()(r.EuiText).withConfig({displayName:"InputPlaceholderContainer",componentId:"sc-1w11z3d-0"})(["position:absolute;pointer-events:none;padding-left:0.5em;width:96%;color:",";"],(({theme:{eui:e}})=>e.euiFormControlPlaceholderText)),Oe=Object(n.memo)((()=>{const{fullTextEntered:e}=Ee(),t=te().state.input.placeholder,a=Object(y.a)(O());return e.length>0?null:o.a.createElement(ye,{size:"s",className:"eui-textTruncate","data-test-subj":a("inputPlaceholder")},o.a.createElement("div",{className:"eui-textTruncate"},t))}));Oe.displayName="InputPlaceholder";const Ce=s()(r.EuiCode).withConfig({displayName:"StyledEuiCode",componentId:"sc-mpcnx8-0"})(["padding-left:0;"]),ve=Object(n.memo)((({input:e,isValid:t=!0})=>{const a=Object(y.a)(O()),i=Object(n.useMemo)((()=>t?e:o.a.createElement(r.EuiTextColor,null,e)),[e,t]);return o.a.createElement(Ce,{transparentBackground:!0,"data-test-subj":a("userCommandText")},i)}));ve.displayName="UserCommandInput";const je=u.i18n.translate("xpack.securitySolution.commandInputHistory.noHistoryEmptyMessage",{defaultMessage:"No commands have been entered"}),xe=Object(n.memo)((()=>{const e=H(),t=te().state.input.history,[a]=Object(n.useState)(Ee()),i=Object(n.useRef)(!1),s=Object(y.a)(O()),l=Object(n.useMemo)((()=>t.map(((e,t)=>({label:e.input,key:e.id,data:e})))),[t]),u=Object(n.useMemo)((()=>({showIcons:!1,onKeyDownCapture:e=>{"Enter"===e.key&&(e._CONSOLE_IGNORE_KEY=!0)}})),[]),c=Object(n.useCallback)(((e,t)=>e),[]),d=Object(n.useCallback)((t=>{i.current=!0;const a=t.find((e=>"on"===e.checked));e({type:"updateInputPopoverState",payload:{show:void 0}}),e({type:"updateInputPlaceholderState",payload:{placeholder:""}}),a&&e({type:"updateInputTextEnteredState",payload:{textEntered:a.label}}),e({type:"addFocusToKeyCapture"})}),[e]),m=Object(n.useCallback)((t=>{t&&e({type:"updateInputPlaceholderState",payload:{placeholder:t.data.input}})}),[e]),p=Object(n.useCallback)((e=>o.a.createElement(ve,{input:e.label})),[]);return Object(n.useEffect)((()=>(e({type:"updateInputTextEnteredState",payload:{textEntered:""}}),()=>{i.current||(e({type:"updateInputTextEnteredState",payload:{textEntered:a.textEntered,rightOfCursor:a.rightOfCursor}}),e({type:"updateInputPlaceholderState",payload:{placeholder:""}}))})),[e,i,a]),o.a.createElement(r.EuiSelectable,{options:l,onChange:d,onActiveOptionChange:m,renderOption:p,listProps:u,singleSelection:!0,emptyMessage:je,"data-test-subj":s("inputHistorySelector")},c)}));xe.displayName="CommandInputHistory";const Se=Object(n.memo)((({children:e,width:t="92vw"})=>{const a=Object(y.a)(O()),i=he(),s=void 0!==i,l=H(),u=Object(n.useMemo)((()=>({width:t})),[t]),c=Object(n.useMemo)((()=>({clickOutsideDisables:!0})),[]),d=Object(n.useCallback)((()=>{l({type:"updateInputPopoverState",payload:{show:void 0}}),l({type:"addFocusToKeyCapture"})}),[l]);return Object(n.useEffect)((()=>{i||l({type:"addFocusToKeyCapture"})}),[l,i]),o.a.createElement(r.EuiPopover,{button:e,closePopover:d,isOpen:s,panelStyle:u,anchorPosition:"upLeft",hasArrow:!1,display:"block",attachToAnchor:!0,focusTrapProps:c,ownFocus:!1,"data-test-subj":a("inputPopover")},i&&o.a.createElement(r.EuiFocusTrap,{clickOutsideDisables:!0},"input-history"===i&&o.a.createElement(xe,null)))}));Se.displayName="InputAreaPopover";const ke=s.a.div.withConfig({displayName:"CommandInputContainer",componentId:"sc-1ll2wia-0"})(["background-color:",";border-radius:",";padding:",";outline:",";&:focus-within{border-bottom:",";border-bottom-color:",";}&.error{border-bottom-color:",";}.textEntered{white-space:break-spaces;}.prompt{padding-right:1ch;}.cursor{display:inline-block;width:1px;height:","em;background-color:",";}&.hasFocus{.cursor{background-color:",";animation:cursor-blink-animation 1s steps(5,start) infinite;-webkit-animation:cursor-blink-animation 1s steps(5,start) infinite;@keyframes cursor-blink-animation{to{visibility:hidden;}}@-webkit-keyframes cursor-blink-animation{to{visibility:hidden;}}}}"],(({theme:{eui:e}})=>e.euiFormBackgroundColor),(({theme:{eui:e}})=>e.euiBorderRadius),(({theme:{eui:e}})=>e.euiSizeS),(({theme:{eui:e}})=>e.euiBorderThin),(({theme:{eui:e}})=>e.euiBorderThick),(({theme:{eui:e}})=>e.euiColorPrimary),(({theme:{eui:e}})=>e.euiColorDanger),(({theme:{eui:e}})=>e.euiLineHeight),(({theme:e})=>e.eui.euiTextSubduedColor),(({theme:{eui:e}})=>e.euiTextColor)),we=Object(n.memo)((({prompt:e="",focusRef:t,...a})=>{(()=>{const e=H(),t=Boolean(he()),a=te().state.input.commandEntered,o=W(),r=Object(n.useMemo)((()=>{if(a)return o.find((e=>e.name===a))}),[a,o]);Object(n.useEffect)((()=>{if(a&&!t)if(r&&!0!==r.helpHidden){var n,o;const t=null!==(n=null==r?void 0:r.exampleInstruction)&&void 0!==n?n:"",a=null!==(o=null==r?void 0:r.exampleUsage)&&void 0!==o?o:"";let i=null!=t?t:"";if(a&&(i+=t?` ${u.i18n.translate("xpack.securitySolution.useInputHints.exampleInstructions",{defaultMessage:"Ex: [ {exampleUsage} ]",values:{exampleUsage:a}})}`:a),!i||!a){const e=g(r);e.length>0?i+=`${r.name} ${e}`:i+=fe}e({type:"updateFooterContent",payload:{value:i}}),e({type:"setInputState",payload:{value:void 0}})}else e({type:"updateFooterContent",payload:{value:(i=a,u.i18n.translate("xpack.securitySolution.useInputHints.unknownCommand",{defaultMessage:"Unknown command {commandName}",values:{commandName:i}}))}}),e({type:"setInputState",payload:{value:"error"}});else e({type:"updateFooterContent",payload:{value:""}}),e({type:"setInputState",payload:{value:void 0}});var i}),[a,r,e,t])})();const i=H(),{rightOfCursor:s,textEntered:l,fullTextEntered:c}=Ee(),d=ae(),[m,p]=Object(n.useState)(!1),b=Object(y.a)(O()),[h,f]=Object(n.useState)(""),E=Object(n.useRef)(null),C=Object(r.useResizeObserver)(E.current),v=Object(n.useRef)(null),j=t||v,x=Object(n.useMemo)((()=>C.width?`${C.width}px`:"92vw"),[C.width]),S=Object(n.useMemo)((()=>de()({cmdInput:!0,hasFocus:m,error:"error"===d})),[m,d]),k=Object(n.useMemo)((()=>0===c.trim().length),[c]),w=Object(n.useCallback)((e=>{f(l+s.text),i({type:"updateInputTextEnteredState",payload:{textEntered:"",rightOfCursor:void 0}})}),[i,l,s.text]),T=Object(n.useCallback)((e=>{p(e)}),[]),M=Object(n.useCallback)((e=>{j.current&&j.current.focus()}),[j]),I=Object(n.useCallback)((({value:e,selection:t,eventDetails:a})=>{const n=a.keyCode;i({type:"updateInputTextEnteredState",payload:({textEntered:a,rightOfCursor:o})=>{let r=new EnteredInput(a,o.text);switch(r.addValue(null!=e?e:"",t),n){case 8:r.backspaceChar(t);break;case 46:r.deleteChar(t);break;case 13:f(r.getFullText()),r=new EnteredInput("","");break;case 37:r.moveCursorTo("left");break;case 39:r.moveCursorTo("right");break;case 36:r.moveCursorTo("home");break;case 35:r.moveCursorTo("end")}return{textEntered:r.getLeftOfCursorText(),rightOfCursor:{text:r.getRightOfCursorText()}}}})}),[i]);return Object(n.useEffect)((()=>{h&&(i({type:"executeCommand",payload:{input:h}}),f(""))}),[h,i]),o.a.createElement(Se,{width:x},o.a.createElement(ke,ue()({},a,{className:S,onClick:M,ref:E,"data-test-subj":b("cmdInput-container")}),o.a.createElement(r.EuiFlexGroup,{wrap:!0,responsive:!1,alignItems:"center",gutterSize:"none",justifyContent:"flexStart"},e&&o.a.createElement(r.EuiFlexItem,{grow:!1,"data-test-subj":b("cmdInput-prompt")},o.a.createElement("span",{className:"eui-displayInlineBlock prompt"},e)),o.a.createElement(r.EuiFlexItem,{className:"textEntered"},o.a.createElement(be,{onCapture:I,onChangeFocus:T,focusRef:t},o.a.createElement(r.EuiFlexGroup,{responsive:!1,alignItems:"center",gutterSize:"none",justifyContent:"flexStart"},o.a.createElement(r.EuiFlexItem,{grow:!1},o.a.createElement("div",{"data-test-subj":b("cmdInput-leftOfCursor")},l)),o.a.createElement(r.EuiFlexItem,{grow:!1},o.a.createElement("span",{className:"cursor essentialAnimation"})),o.a.createElement(r.EuiFlexItem,null,o.a.createElement("div",{"data-test-subj":b("cmdInput-rightOfCursor")},s.text)))),o.a.createElement(Oe,null)),o.a.createElement(r.EuiFlexItem,{grow:!1},o.a.createElement(r.EuiButtonIcon,{"data-test-subj":b("inputTextSubmitButton"),"aria-label":"submit-command",iconType:"playFilled",display:"empty",color:"primary",isDisabled:k,onClick:w})))))}));we.displayName="CommandInput";var Te=a(43),Me=a.n(Te);const Ie=Object(n.memo)((({size:e="s",color:t,children:a,"data-test-subj":n,className:i})=>{const{euiTheme:s}=Object(r.useEuiTheme)();return o.a.createElement(r.EuiText,{size:e,"data-test-subj":n,className:`font-family-code ${null!=i?i:""}`},o.a.createElement(r.EuiTextColor,{color:null!=t?t:s.colors.text},a))}));Ie.displayName="ConsoleText";const Ne=Object(n.memo)((()=>{const e=Object(y.a)(O());return o.a.createElement(Ie,{"data-test-subj":e("longRunningCommandHint")},o.a.createElement(f.FormattedMessage,{id:"xpack.securitySolution.console.longRunningCommandHintMessage",defaultMessage:"Hint: We are still working on this task. You may leave the console or place another command while this command is processing."}))}));Ne.displayName="LongRunningCommandHint";const Pe=u.i18n.translate("xpack.securitySolution.commandExecutionResult.successTitle",{defaultMessage:"Action completed."}),Fe=u.i18n.translate("xpack.securitySolution.commandExecutionResult.failureTitle",{defaultMessage:"Action failed."}),Ae=u.i18n.translate("xpack.securitySolution.commandExecutionResult.pending",{defaultMessage:"Action pending."}),ze=Object(n.memo)((({showAs:e="success",title:t,showTitle:a=!0,"data-test-subj":i,className:s,children:l})=>{const u=O(),c=Object(y.a)(null!=i?i:u),d=Object(n.useMemo)((()=>de()({"eui-displayInlineBlock":"pending"===e,"font-family-code":!0,[s||"_"]:Boolean(s)})),[s,e]);return o.a.createElement(r.EuiPanel,{hasShadow:!1,paddingSize:"none",borderRadius:"none",color:"transparent",className:d,"data-test-subj":i||c("commandExecutionResult")},"pending"===e?o.a.createElement(Ie,null,null!=l?l:Ae):o.a.createElement(o.a.Fragment,null,a&&o.a.createElement(o.a.Fragment,null,o.a.createElement(Ie,{color:"success"===e?"success":"danger"},t||("success"===e?Pe:Fe)),o.a.createElement(r.EuiSpacer,{size:"s"})),l))}));ze.displayName="CommandExecutionResult";const Be=s.a.div.withConfig({displayName:"CommandOutputContainer",componentId:"sc-10ffpqv-0"})(["position:relative;.busy-indicator{margin-left:0.5em;}"]),He=Object(n.memo)((({item:{command:e,state:t,id:a,enteredAt:i,isValid:s}})=>{const l=H(),u=e.commandDefinition.RenderComponent,[c,d]=Object(n.useState)(!1),m=Object(n.useMemo)((()=>"pending"===t.status),[t.status]),p=Object(n.useCallback)((e=>{l({type:"updateCommandStatusState",payload:{id:a,value:e}})}),[l,a]),g=Object(n.useCallback)((e=>{l({type:"updateCommandStoreState",payload:{id:a,value:e}})}),[l,a]);return Object(n.useEffect)((()=>{let e;if(m&&!c){const t=Me()().diff(Me()(i),"seconds");if(t>=15)return void d(!0);e=setTimeout((()=>{d(!0)}),1e3*(15-t))}return()=>{e&&clearTimeout(e)}}),[i,c,m]),o.a.createElement(Be,null,o.a.createElement("div",null,o.a.createElement(ve,{input:e.input,isValid:s})),o.a.createElement("div",null,o.a.createElement(r.EuiSpacer,{size:"s"}),o.a.createElement(r.EuiSpacer,{size:"xs"}),o.a.createElement(u,{command:e,store:t.store,status:t.status,setStore:g,setStatus:p,ResultComponent:ze}),m&&o.a.createElement(r.EuiLoadingChart,{className:"busy-indicator",mono:!0}),m&&c&&o.a.createElement(o.a.Fragment,null,o.a.createElement(r.EuiSpacer,{size:"s"}),o.a.createElement(Ne,null))))}));He.displayName="CommandExecutionOutput";const Le=a(51).css`
  ${({theme:{eui:e}})=>e.euiSizeL}
`,_e=s()(r.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItemHistoryItem",componentId:"sc-okrtpf-0"})(["border-bottom:"," dashed ",";margin-bottom:",";padding-bottom:",";"],(({theme:{eui:e}})=>e.euiBorderWidthThin),(({theme:{eui:e}})=>e.euiBorderColor),Le,Le),Re=Object(n.memo)((({children:e})=>{const t=Object(y.a)(O());return o.a.createElement(_e,{grow:!0,"data-test-subj":t("historyItem")},e)}));Re.displayName="HistoryItem";const De=Object(n.memo)((e=>{const t=te().state.commandHistory,a=H(),i=Object(y.a)(O()),s=Object(n.useMemo)((()=>t.map((e=>o.a.createElement(Re,{key:e.id},o.a.createElement(He,{item:e}))))),[t]);return Object(n.useEffect)((()=>{a({type:"scrollDown"})}),[a,t.length]),o.a.createElement(r.EuiFlexGroup,ue()({"data-test-subj":i("historyOutput")},e,{wrap:!0,direction:"column",alignItems:"stretch",responsive:!1,gutterSize:"none"}),s)}));De.displayName="HistoryOutput";const Ge=s()(r.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItemNoPadding",componentId:"sc-a0j7yf-0"})(["padding:0 !important;"]),Ue=Object(n.memo)((({headerContent:e,children:t})=>o.a.createElement(r.EuiFlexGroup,{direction:"column",responsive:!1,className:"eui-fullHeight",gutterSize:"none"},e&&o.a.createElement(o.a.Fragment,null,o.a.createElement(r.EuiFlexItem,{grow:!1,className:"layout-container"},e),o.a.createElement(r.EuiHorizontalRule,{margin:"none"})),o.a.createElement(Ge,{className:"eui-scrollBar eui-yScroll layout-container"},o.a.createElement("div",null,t)))));Ue.displayName="SidePanelContentLayout";const $e=s()(r.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-14x41hk-0"})(["padding-top:",";padding-right:",";"],(({theme:{eui:e}})=>e.euiPanelPaddingModifiers.paddingSmall),(({theme:{eui:e}})=>e.euiPanelPaddingModifiers.paddingSmall)),qe=Object(n.memo)((()=>{const e=H(),t=W(),a=oe().show,i=Object(n.useCallback)((()=>{e({type:"showSidePanel",payload:{show:null}})}),[e]),s=Object(n.useMemo)((()=>"help"===a?o.a.createElement(o.a.Fragment,null,o.a.createElement($e,null,o.a.createElement(r.EuiFlexItem,null,o.a.createElement(r.EuiTitle,{size:"s"},o.a.createElement("h3",null,o.a.createElement(f.FormattedMessage,{id:"xpack.securitySolution.console.sidePanel.helpTitle",defaultMessage:"Help"})))),o.a.createElement(r.EuiFlexItem,{grow:!1},o.a.createElement(r.EuiButtonIcon,{"aria-label":"closeSidePanelIcon",iconType:"cross",color:"text",onClick:i}))),o.a.createElement(r.EuiSpacer,{size:"m"}),o.a.createElement(r.EuiText,{size:"s"},o.a.createElement(f.FormattedMessage,{id:"xpack.securitySolution.console.sidePanel.helpDescription",defaultMessage:"Use the add ({icon}) button to populate a response action to the text bar. Add additional parameters or comments as necessary.",values:{icon:o.a.createElement(r.EuiIcon,{type:"plusInCircle"})}}))):null),[a,i]),l=Object(n.useMemo)((()=>"help"===a?o.a.createElement(V,{commands:t,display:"table"}):null),[t,a]);return a?o.a.createElement(Ue,{headerContent:s},l):null}));qe.displayName="RightPanelContentManager";const Ke=s()(r.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItemWhite",componentId:"sc-3okvya-0"})(["background-color:"," !important;border-radius:",";box-shadow:0 "," "," ",";"],(({theme:{eui:e}})=>e.euiHeaderBackgroundColor),(({theme:{eui:e}})=>`0 ${e.euiSizeXS} ${e.euiSizeXS} 0`),(({theme:{eui:e}})=>e.euiSizeXS),(({theme:{eui:e}})=>e.euiSizeXS),(({theme:{eui:e}})=>Object(r.transparentize)(e.euiShadowColor,.04))),Ve=Object(n.memo)((e=>Boolean(oe().show)?o.a.createElement(Ke,{grow:!1,className:"layout-rightPanel"},o.a.createElement(qe,null)):null));Ve.displayName="SidePanelFlexItem";const We=s.a.div.withConfig({displayName:"ConsoleWindow",componentId:"sc-u5ji78-0"})(["height:100%;background-color:",";border:",";border-radius:",";.layout{height:100%;min-height:300px;&-hideOverflow{overflow:hidden;}&-bottomBorder{border-bottom:"," solid ",";}&-container{padding:",";}&-header{background-color:",";border-bottom:1px solid ",";border-top-left-radius:",";border-top-right-radius:",";padding:"," "," "," ",";}&-commandInput{padding-top:",";padding-bottom:",";}&-footer{padding-top:0;padding-bottom:",";}&-rightPanel{width:35%;background-color:",";border-left:",";}&-historyOutput{overflow:auto;}&-historyViewport{height:100%;overflow-x:hidden;}}.font-family-code{font-family:",";}.font-style-italic{font-style:italic;}.descriptionList-20_80{&.euiDescriptionList{> .euiDescriptionList__title{width:20%;margin-top:",";}> .euiDescriptionList__description{width:80%;margin-top:",";}}}"],(({theme:{eui:e}})=>e.euiPageBackgroundColor),(({theme:{eui:e}})=>e.euiBorderThin),(({theme:{eui:e}})=>e.euiBorderRadiusSmall),(({theme:{eui:e}})=>e.euiSizeS),(({theme:{eui:e}})=>e.euiPageBackgroundColor),(({theme:{eui:e}})=>e.euiPanelPaddingModifiers.paddingMedium),(({theme:{eui:e}})=>e.euiColorEmptyShade),(({theme:{eui:e}})=>e.euiColorLightShade),(({theme:{eui:e}})=>e.euiBorderRadiusSmall),(({theme:{eui:e}})=>e.euiBorderRadiusSmall),(({theme:{eui:e}})=>e.euiSize),(({theme:{eui:e}})=>e.euiSize),(({theme:{eui:e}})=>e.euiSize),(({theme:{eui:e}})=>e.euiSize),(({theme:{eui:e}})=>e.euiSizeXS),(({theme:{eui:e}})=>e.euiSizeXS),(({theme:{eui:e}})=>e.euiSizeXS),(({theme:{eui:e}})=>e.euiFormBackgroundColor),(({theme:{eui:e}})=>e.euiBorderThin),(({theme:{eui:e}})=>e.euiCodeFontFamily),(({theme:{eui:e}})=>e.euiSizeS),(({theme:{eui:e}})=>e.euiSizeS)),Xe=Object(n.memo)((({prompt:e,commands:t,HelpComponent:a,TitleComponent:i,managedKey:s,...u})=>{const c=Object(n.useRef)(null),d=Object(n.useRef)(null),m=Object(y.a)(u["data-test-subj"]),p=Object(l.c)(s),g=Object(n.useCallback)((()=>{setTimeout((()=>{c.current&&(c.current.scrollTop=c.current.scrollHeight)}),1)}),[]),b=Object(n.useCallback)((()=>{d.current&&d.current.focus()}),[]);return Object(n.useEffect)((()=>{p&&!p.isOpen||setTimeout(b,2)}),[b,p]),o.a.createElement(ee,{commands:t,scrollToBottom:g,keyCapture:d,managedKey:s,HelpComponent:a,dataTestSubj:u["data-test-subj"]},o.a.createElement(We,u,o.a.createElement(r.EuiFlexGroup,{className:"layout",gutterSize:"none",responsive:!1},o.a.createElement(r.EuiFlexItem,null,o.a.createElement(r.EuiFlexGroup,{direction:"column",className:"layout",gutterSize:"none",responsive:!1,"data-test-subj":m("mainPanel")},o.a.createElement(r.EuiFlexItem,{grow:!1,className:"layout-header"},o.a.createElement(se,{TitleComponent:i})),o.a.createElement(r.EuiFlexItem,{grow:!0,className:"layout-hideOverflow"},o.a.createElement(r.EuiFlexGroup,{gutterSize:"none",responsive:!1,className:"layout-hideOverflow"},o.a.createElement(r.EuiFlexItem,{className:"eui-fullHeight layout-hideOverflow"},o.a.createElement(r.EuiFlexGroup,{direction:"column",gutterSize:"none",responsive:!1,className:"layout-hideOverflow"},o.a.createElement(r.EuiFlexItem,{grow:!0,className:"layout-historyOutput"},o.a.createElement("div",{className:"layout-container layout-historyViewport eui-scrollBar eui-yScroll",ref:c},o.a.createElement(De,null))),o.a.createElement(r.EuiFlexItem,{onClick:b,grow:!1,className:"layout-container layout-commandInput","data-test-subj":m("mainPanel-inputArea")},o.a.createElement(we,{prompt:e,focusRef:d})),o.a.createElement(r.EuiFlexItem,{grow:!1,className:"layout-container layout-footer"},o.a.createElement(ne,null)))))))),o.a.createElement(Ve,null))))}));Xe.displayName="Console"},1152:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return i}));var n=a(34),o=a(4);const r={pageName:a(2).a.noPage,detailName:void 0,tabName:void 0,search:"",pathName:"/",state:void 0},i=Object(o.createContext)([r,()=>n.noop])},116:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(4),o=a(1088);const r=()=>Object(n.useContext)(o.a)},1220:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(4),o="undefined"!=typeof window?n.useLayoutEffect:n.useEffect;t.default=o},169:function(e,t,a){"use strict";a.d(t,"b",(function(){return p})),a.d(t,"d",(function(){return g})),a.d(t,"a",(function(){return b})),a.d(t,"c",(function(){return h}));var n=a(4),o=a(34),r=a(78),i=a(268),s=a.n(i),l=a(267),u=a(81),c=a(1164),d=a(183),m=a(9);const p=(e,t)=>{const a=Object(r.useDispatch)(),o=Object(l.g)(e);Object(n.useEffect)((()=>{const{param:n,decodedParam:r}=o();return a(c.a.registerUrlParam({key:e,initialValue:null!=n?n:null})),t(r),()=>{a(c.a.deregisterUrlParam({key:e}))}}),[])},g=e=>{const t=Object(r.useDispatch)();return Object(n.useCallback)((a=>{const n=null!==a?Object(l.c)(a):null;t(c.a.updateUrlParam({key:e,value:n}))}),[t,e])},b=()=>{const e=Object(u.b)(c.c.selectGlobalUrlParam);return Object(n.useMemo)((()=>Object(l.b)(Object(o.pickBy)((e=>!Object(o.isEmpty)(e)),e))),[e])},h=()=>{const[{pageName:e}]=Object(d.a)(),t=Object(u.b)(c.c.selectGlobalUrlParam),a=s()(t),r=Object(l.h)(),i=Object(n.useMemo)((()=>Object(o.difference)(Object.keys(null!=a?a:{}),Object.keys(t))),[a,t]);Object(n.useEffect)((()=>{var a;const n=null!==(a=Object(m.b)(e))&&void 0!==a?a:{skipUrlState:!0},o=Object.entries(t).map((([e,t])=>({key:e,value:n.skipUrlState?null:t})));i.forEach((e=>{o.push({key:e,value:null})})),o.length>0&&r(o)}),[t,e,i,r])}},183:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(4),o=a(1152);const r=()=>Object(n.useContext)(o.a)},193:function(e,t,a){"use strict";a.d(t,"e",(function(){return u})),a.d(t,"j",(function(){return c})),a.d(t,"h",(function(){return d})),a.d(t,"a",(function(){return m})),a.d(t,"i",(function(){return p})),a.d(t,"d",(function(){return g})),a.d(t,"b",(function(){return b})),a.d(t,"c",(function(){return h})),a.d(t,"f",(function(){return f})),a.d(t,"g",(function(){return E}));var n=a(8),o=a(1),r=a(226),i=a(77),s=a(740),l=a(547);const u=async({query:e,signal:t})=>i.b.get().http.fetch(o.mb,{method:"POST",body:JSON.stringify(e),signal:t}),c=async({query:e,status:t,signal:a})=>i.b.get().http.fetch(o.rb,{method:"POST",body:JSON.stringify({conflicts:"proceed",status:t,...e}),signal:a}),d=async({signal:e})=>i.b.get().http.fetch(o.kb,{method:"GET",signal:e}),m=async({signal:e})=>i.b.get().http.fetch(o.jb,{method:"GET",signal:e}),p=async({signal:e})=>i.b.get().http.fetch(o.lb,{method:"GET",signal:e}),g=async({signal:e})=>i.b.get().http.fetch(o.kb,{method:"POST",signal:e}),b=async({endpointId:e,comment:t="",caseIds:a})=>Object(s.a)({endpoint_ids:[e],comment:t,case_ids:a}),h=async({endpointId:e,comment:t="",caseIds:a})=>Object(s.b)({endpoint_ids:[e],comment:t,case_ids:a}),f=async({alertId:e,owner:t})=>i.b.get().http.fetch(Object(n.getCasesFromAlertsUrl)(e),{method:"get",query:{...t.length>0?{owner:t}:{}}}),E=async({agentId:e,signal:t})=>i.b.get().http.fetch(Object(l.a)(r.j,{id:e}),{method:"GET",signal:t})},205:function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return r})),a.d(t,"c",(function(){return s})),a.d(t,"d",(function(){return u})),a.d(t,"e",(function(){return c}));var n=a(0);let o,r;!function(e){e.rules="rules",e.alertsCases="alertsCases"}(o||(o={})),function(e){e[e.none=0]="none",e[e.pointToAlertName=1]="pointToAlertName",e[e.expandEvent=2]="expandEvent",e[e.reviewAlertDetailsFlyout=3]="reviewAlertDetailsFlyout",e[e.addAlertToCase=4]="addAlertToCase",e[e.createCase=5]="createCase",e[e.submitCase=6]="submitCase",e[e.viewCase=7]="viewCase"}(r||(r={}));const i={minWidth:360,maxWidth:360,offset:10,repositionOnScroll:!0,ownFocus:!0,initialFocus:'[tour-step="nextButton"]'},s=(e,t)=>`tourStepAnchor-${t}-${e}`,l=[{...i,step:r.pointToAlertName,title:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.ruleNameStep.tourTitle",{defaultMessage:"Examine the Alerts Table"}),content:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.ruleNameStep.tourContent",{defaultMessage:"To help you practice triaging alerts, here is the alert from the rule that we enabled in the previous step."}),anchorPosition:"downCenter",dataTestSubj:s(r.pointToAlertName,o.alertsCases),initialFocus:'button[tour-step="nextButton"]'},{...i,step:r.expandEvent,title:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.openFlyout.tourTitle",{defaultMessage:"Review the alert details"}),content:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.openFlyout.tourContent",{defaultMessage:"Some information is provided at-a-glance in the table, but for full details, you'll want to open the alert."}),anchorPosition:"rightUp",dataTestSubj:s(r.expandEvent,o.alertsCases)},{...i,step:r.reviewAlertDetailsFlyout,title:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.flyoutOverview.tourTitle",{defaultMessage:"Explore alert details"}),content:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.flyoutOverview.tourContent",{defaultMessage:"Learn more about alerts by checking out all the information available."}),anchor:`[tour-step="${s(r.reviewAlertDetailsFlyout,o.alertsCases)}"] span.euiTab__content`,offset:20,anchorPosition:"leftUp",dataTestSubj:s(r.reviewAlertDetailsFlyout,o.alertsCases)},{...i,step:r.addAlertToCase,title:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.addToCase.tourTitle",{defaultMessage:"Create a case"}),content:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.addToCase.tourContent",{defaultMessage:'From the Take action menu, select "Add to new case".'}),anchorPosition:"upRight",dataTestSubj:s(r.addAlertToCase,o.alertsCases)},{...i,step:r.createCase,title:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.createCase.tourTitle",{defaultMessage:"Add Case details"}),content:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.createCase.tourContent",{defaultMessage:"Provide the relevant information to create the case. We have included sample text for you."}),anchor:'[tour-step="create-case-flyout"] label',anchorPosition:"leftUp",dataTestSubj:s(r.createCase,o.alertsCases),offset:20,repositionOnScroll:!1},{...i,step:r.submitCase,title:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.submitCase.tourTitle",{defaultMessage:"Create a case"}),content:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.submitCase.tourContent",{defaultMessage:'Press "Create case" to continue.'}),anchor:'[tour-step="create-case-flyout"] [tour-step="create-case-submit"]',anchorPosition:"leftUp",hideNextButton:!0,dataTestSubj:s(r.submitCase,o.alertsCases),offset:20,ownFocus:!1,initialFocus:'[tour-step="create-case-flyout"] [tour-step="create-case-submit"]'},{...i,step:r.viewCase,title:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.viewCase.tourTitle",{defaultMessage:"View the case"}),content:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.viewCase.tourContent",{defaultMessage:"Cases are shown under Insights, in the alert details."}),anchorPosition:"rightUp",dataTestSubj:s(r.viewCase,o.alertsCases)}],u={title:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.createCase.title",{defaultMessage:"This is a test case"}),description:n.i18n.translate("xpack.securitySolution.guided_onboarding.tour.createCase.description",{defaultMessage:"Add a description and other relevant information. The alert will be added to the case."})},c={[o.rules]:[],[o.alertsCases]:l}},226:function(e,t,a){"use strict";a.d(t,"r",(function(){return o})),a.d(t,"s",(function(){return r})),a.d(t,"o",(function(){return i})),a.d(t,"k",(function(){return s})),a.d(t,"j",(function(){return l})),a.d(t,"n",(function(){return u})),a.d(t,"e",(function(){return c})),a.d(t,"l",(function(){return d})),a.d(t,"q",(function(){return m})),a.d(t,"i",(function(){return p})),a.d(t,"m",(function(){return g})),a.d(t,"p",(function(){return b})),a.d(t,"h",(function(){return h})),a.d(t,"d",(function(){return f})),a.d(t,"c",(function(){return E})),a.d(t,"b",(function(){return y})),a.d(t,"a",(function(){return O})),a.d(t,"f",(function(){return C})),a.d(t,"g",(function(){return v}));var n=a(59);const o="metrics-endpoint.metadata_current_*",r="endpoint.metadata_current-default",i=".metrics-endpoint.metadata_united_default",s=(Object(n.getFileMetadataIndexName)("endpoint"),Object(n.getFileDataIndexName)("endpoint"),"/api/endpoint/metadata"),l="/api/endpoint/metadata/{id}",u="/api/endpoint/metadata/transforms",c="/api/endpoint/policy_response",d="/api/endpoint/isolate",m="/api/endpoint/unisolate",p="/api/endpoint/action/running_procs",g="/api/endpoint/action/kill_process",b="/api/endpoint/action/suspend_process",h="/api/endpoint/action/get_file",f="/api/endpoint/action_status",E="/api/endpoint/action/{action_id}",y="/api/endpoint/action/{action_id}/{agent_id}/file",O="/api/endpoint/action/{action_id}/{agent_id}/file/download",C="/api/endpoint/action",v={ES_CONNECTION_ERROR:-272}},267:function(e,t,a){"use strict";a.d(t,"f",(function(){return u})),a.d(t,"a",(function(){return c})),a.d(t,"c",(function(){return d})),a.d(t,"e",(function(){return m})),a.d(t,"d",(function(){return p})),a.d(t,"g",(function(){return g})),a.d(t,"b",(function(){return b})),a.d(t,"h",(function(){return h}));var n=a(54),o=a(598),r=a(18),i=a(37),s=a(4),l=a(2);const u=e=>e===l.a.alerts||e===l.a.rules||e===l.a.rulesCreate||e===l.a.exceptions,c=e=>{try{return e?Object(n.decode)(e):null}catch(e){if(e instanceof Error&&e.message.startsWith("rison decoder error"))return null;throw e}},d=e=>Object(n.encode)(e),m=e=>e.substring(1),p=(e,t)=>{const a=Object(o.parse)(e,{sort:!1})[t];return Array.isArray(a)?a[0]:a},g=e=>Object(s.useCallback)((()=>{const t=p(m(window.location.search),e);return{param:t,decodedParam:c(null!=t?t:void 0)}}),[e]),b=e=>Object(o.stringify)(r.url.encodeQuery(e),{sort:!1,encode:!1}),h=()=>{const e=Object(i.useHistory)();return Object(s.useCallback)((t=>{const a=window.location.search,n=Object(o.parse)(a,{sort:!1});t.forEach((({key:e,value:t})=>{null==t||""===t?delete n[e]:n[e]=t}));const r=b(n);m(a)!==r&&e.replace({search:r})}),[e])}},268:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(4);t.default=function(e){var t=n.useRef();return n.useEffect((function(){t.current=e})),t.current}},403:function(e,t,a){"use strict";var n=a(1080);a.d(t,"b",(function(){return n.b})),a.d(t,"a",(function(){return n.a}))},404:function(e,t,a){"use strict";a.d(t,"c",(function(){return o})),a.d(t,"d",(function(){return r})),a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return s}));var n=a(0);const o=n.i18n.translate("xpack.securitySolution.containers.detectionEngine.alerts.errorGetAlertDescription",{defaultMessage:"Failed to get signal index name"}),r=n.i18n.translate("xpack.securitySolution.containers.detectionEngine.alerts.errorPostAlertDescription",{defaultMessage:"Failed to create signal index"}),i=n.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.failedToIsolate.title",{defaultMessage:"Failed to isolate host"}),s=n.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.casesFromAlerts.title",{defaultMessage:"Failed to find associated cases"})},521:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return s}));var n=a(77),o=a(1),r=a(9);const i=(e,t)=>Object(r.e)(e)&&t.length>0?`?${t}`:"",s=()=>{const[e]=Object(n.q)(o.ub);return e}},547:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=(e,t)=>Object.keys(t).reduce(((e,a)=>e.replace(new RegExp(`{${a}}`,"g"),String(t[a]))),e)},740:function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return i}));var n=a(77),o=a(226);const r=async e=>n.b.get().http.post(o.l,{body:JSON.stringify(e)}),i=async e=>n.b.get().http.post(o.q,{body:JSON.stringify(e)})},824:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(4),o=a.n(n),r=a(32),i=a(33);const s=a.n(i)()(r.EuiText).withConfig({displayName:"CodeBlock",componentId:"sc-19djka-0"})(["font-family:",";"],(e=>e.theme.eui.euiCodeFontFamily)),l=Object(n.memo)((({children:e,inline:t=!1,textColor:a="default",bold:n=!1})=>o.a.createElement(s,{size:"relative",color:a,className:t?"eui-displayInline":""},n?o.a.createElement("strong",null,e):e)));l.displayName="ConsoleCodeBlock"},84:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(4),o=a(34),r=a(83),i=a(48),s=a(77);const l=()=>{const e=Object(s.o)(),t=Object(n.useRef)(e.addError.bind(e)).current,a=Object(n.useRef)(e.addSuccess.bind(e)).current,o=Object(n.useRef)(e.addWarning.bind(e)).current,r=Object(n.useRef)(e.remove.bind(e)).current,i=Object(n.useCallback)(((e,a)=>{const n=u(e);return t(n,a)}),[t]);return Object(n.useMemo)((()=>({api:e,addError:i,addSuccess:a,addWarning:o,remove:r})),[i,a,o,r,e])},u=e=>null!=e&&Object(i.isEsError)(e)?c(e):Object(r.q)(e)?d(e):e instanceof Error?m(e):p(e),c=e=>{var t,a,n,o,r;const i=null!=e.err?e.err:e,s=null!=(null===(t=e.err)||void 0===t?void 0:t.statusCode)?`(${e.err.statusCode})`:null!=e.statusCode?`(${e.statusCode})`:"",l=g(i),u=new Error(`${null!==(a=null===(n=e.attributes)||void 0===n?void 0:n.reason)&&void 0!==a?a:e.message} ${s}`);return u.name=null!==(o=null===(r=e.attributes)||void 0===r?void 0:r.reason)&&void 0!==o?o:e.message,null!=l&&(u.stack=l),u},d=e=>{const t=Object(r.r)(e)?`(${e.body.statusCode})`:Object(r.t)(e)?`(${e.body.status_code})`:"",a=g(e),n=new Error(`${""!==String(e.body.message).trim()?e.body.message:e.message} ${t}`);return n.name=null!=e.name?e.name:"",null!=a&&(n.stack=a),n},m=e=>{const t=g(e),a=new Error(e.message);return a.name=e.name,null!=t&&(a.stack=t),a},p=e=>{const t=g(e),a=Object(o.isString)(e)?e:e instanceof Object&&null!=t?t:String(e),n=new Error(a);return n.name=a,null!=t&&(n.stack=t),n},g=e=>{try{return JSON.stringify(e,((e,t)=>{const a=b(t);return h(a)?void 0:a}),2)}catch(e){return}},b=e=>e instanceof Error?{...e,name:e.name,message:e.message,stack:e.stack}:e,h=e=>{if(!(e instanceof Object))return!1;try{return"{}"===JSON.stringify(e)}catch(e){return!1}}}}]);