/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[17],{102:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return s}));var r=n(83),a=n(184),i=n(429);n.d(t,"e",(function(){return r.f})),n.d(t,"g",(function(){return r.h})),n.d(t,"f",(function(){return r.g})),n.d(t,"k",(function(){return r.l})),n.d(t,"j",(function(){return r.k})),n.d(t,"n",(function(){return r.p})),n.d(t,"m",(function(){return r.o})),n.d(t,"l",(function(){return r.m})),n.d(t,"h",(function(){return r.i})),n.d(t,"o",(function(){return r.u})),n.d(t,"p",(function(){return r.v})),n.d(t,"i",(function(){return r.j})),n.d(t,"a",(function(){return r.b})),n.d(t,"b",(function(){return r.e}));const o=({activeTimelineDataProviders:e,dataProviders:t,dispatch:n,result:o,timelineId:s,noProviderFound:c=a.a.noProviderFound,onAddedToTimeline:l})=>{const u=Object(r.n)(o),d=t[u];d?Object(i.b)({dataProviders:e,destination:o.destination,dispatch:n,onAddedToTimeline:l,providerToAdd:d,timelineId:s}):n(c({id:u}))},s=({isAggregatable:e,fieldType:t,fieldName:n,hideTopN:r})=>{const a=["boolean","geo-point","geo-shape","ip","keyword","number","numeric","string"].includes(t),i=["kibana.alert.ancestors.depth","kibana.alert.ancestors.id","kibana.alert.ancestors.rule","kibana.alert.ancestors.type","kibana.alert.original_event.action","kibana.alert.original_event.category","kibana.alert.original_event.code","kibana.alert.original_event.created","kibana.alert.original_event.dataset","kibana.alert.original_event.duration","kibana.alert.original_event.end","kibana.alert.original_event.hash","kibana.alert.original_event.id","kibana.alert.original_event.kind","kibana.alert.original_event.module","kibana.alert.original_event.original","kibana.alert.original_event.outcome","kibana.alert.original_event.provider","kibana.alert.original_event.risk_score","kibana.alert.original_event.risk_score_norm","kibana.alert.original_event.sequence","kibana.alert.original_event.severity","kibana.alert.original_event.start","kibana.alert.original_event.timezone","kibana.alert.original_event.type","kibana.alert.original_time","kibana.alert.rule.created_by","kibana.alert.rule.description","kibana.alert.rule.enabled","kibana.alert.rule.false_positives","kibana.alert.rule.from","kibana.alert.rule.uuid","kibana.alert.rule.immutable","kibana.alert.rule.interval","kibana.alert.rule.max_signals","kibana.alert.rule.name","kibana.alert.rule.note","kibana.alert.rule.references","kibana.alert.risk_score","kibana.alert.rule.rule_id","kibana.alert.severity","kibana.alert.rule.size","kibana.alert.rule.tags","kibana.alert.rule.threat","kibana.alert.rule.threat.tactic.id","kibana.alert.rule.threat.tactic.name","kibana.alert.rule.threat.tactic.reference","kibana.alert.rule.threat.technique.id","kibana.alert.rule.threat.technique.name","kibana.alert.rule.threat.technique.reference","kibana.alert.rule.timeline_id","kibana.alert.rule.timeline_title","kibana.alert.rule.to","kibana.alert.rule.type","kibana.alert.rule.updated_by","kibana.alert.rule.version","kibana.alert.workflow_status"].includes(n);return!r&&(i||e&&a)}},1075:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return l}));var r=n(10),a=n(20),i=n(3),o=n(1076),s=n(1);const c={[s.uc.landing]:{id:s.uc.landing,name:i.n,href:s.r,disabled:!1,urlKey:"get_started"},[s.uc.overview]:{id:s.uc.overview,name:i.x,href:s.u,disabled:!1,urlKey:"overview"},[s.uc.detectionAndResponse]:{id:s.uc.detectionAndResponse,name:i.g,href:s.h,disabled:!1,urlKey:"detection_response"},[s.uc.alerts]:{id:s.uc.alerts,name:i.a,href:s.e,disabled:!1,urlKey:"alerts"},[s.uc.rules]:{id:s.uc.rules,name:i.A,href:s.y,disabled:!1,urlKey:"rules"},[s.uc.exceptions]:{id:s.uc.exceptions,name:i.k,href:s.l,disabled:!1,urlKey:"exceptions"},[s.uc.hosts]:{id:s.uc.hosts,name:i.p,href:s.m,disabled:!1,urlKey:"host"},[s.uc.users]:{id:s.uc.users,name:i.E,href:s.C,disabled:!1,urlKey:"users"},[s.uc.network]:{id:s.uc.network,name:i.u,href:s.t,disabled:!1,urlKey:"network"},[s.uc.kubernetes]:{id:s.uc.kubernetes,name:i.s,href:s.q,disabled:!1,urlKey:"kubernetes"},[s.uc.timelines]:{id:s.uc.timelines,name:i.C,href:s.z,disabled:!1,urlKey:"timeline"},[s.uc.case]:{id:s.uc.case,name:i.c,href:s.g,disabled:!1,urlKey:"cases"},[s.uc.endpoints]:{id:s.uc.endpoints,name:i.h,href:s.i,disabled:!1,urlKey:"administration"},[s.uc.policies]:{id:s.uc.policies,name:i.y,href:s.w,disabled:!1,urlKey:"administration"},[s.uc.trustedApps]:{id:s.uc.trustedApps,name:i.D,href:s.A,disabled:!1,urlKey:"administration"},[s.uc.eventFilters]:{id:s.uc.eventFilters,name:i.j,href:s.k,disabled:!1,urlKey:"administration"},[s.uc.hostIsolationExceptions]:{id:s.uc.hostIsolationExceptions,name:i.q,href:s.n,disabled:!1,urlKey:"administration"},[s.uc.blocklist]:{id:s.uc.blocklist,name:i.b,href:s.f,disabled:!1,urlKey:"administration"},[s.uc.responseActionsHistory]:{id:s.uc.responseActionsHistory,name:i.z,href:s.x,disabled:!1,urlKey:"administration"},[s.uc.threatIntelligenceIndicators]:{...Object(a.getSecuritySolutionNavTab)("indicators",s.v),urlKey:"indicators"},[s.uc.cloudSecurityPostureFindings]:{...Object(r.getSecuritySolutionNavTab)("findings",s.v),urlKey:"findings"},[s.uc.cloudSecurityPostureDashboard]:{...Object(r.getSecuritySolutionNavTab)("dashboard",s.v),urlKey:"cloud_posture"},[s.uc.cloudSecurityPostureBenchmarks]:{...Object(r.getSecuritySolutionNavTab)("benchmarks",s.v),urlKey:"administration"},[s.uc.cloudSecurityPostureRules]:{...Object(r.getSecuritySolutionNavTab)("rules",s.v),urlKey:"administration"},[s.uc.entityAnalytics]:{id:s.uc.entityAnalytics,name:i.i,href:s.j,disabled:!1,urlKey:"entity_analytics"}},l={[o.a.dashboards]:{id:o.a.dashboards,name:i.e},[o.a.detect]:{id:o.a.detect,name:i.f},[o.a.findings]:{id:o.a.findings,name:i.m},[o.a.explore]:{id:o.a.explore,name:i.l},[o.a.intelligence]:{id:o.a.intelligence,name:i.B},[o.a.investigate]:{id:o.a.investigate,name:i.r},[o.a.manage]:{id:o.a.manage,name:i.t}}},1076:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2);let a;!function(e){e.dashboards="dashboards",e.detect="detect",e.findings="findings",e.explore="explore",e.intelligence="intelligence",e.investigate="investigate",e.manage="manage"}(a||(a={})),r.a.alerts,r.a.blocklist,r.a.detectionAndResponse,r.a.case,r.a.endpoints,r.a.landing,r.a.policies,r.a.eventFilters,r.a.exceptions,r.a.hostIsolationExceptions,r.a.hosts,r.a.network,r.a.overview,r.a.responseActionsHistory,r.a.rules,r.a.timelines,r.a.trustedApps,r.a.users,r.a.kubernetes,r.a.threatIntelligenceIndicators,r.a.cloudSecurityPostureDashboard,r.a.cloudSecurityPostureFindings,r.a.cloudSecurityPostureBenchmarks,r.a.cloudSecurityPostureRules,r.a.entityAnalytics},1110:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=(e,t,n)=>{const r=t.indexOf(e),a=[...t];r>=0?a.splice(r,1):a.push(e),n(a)}},1111:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(4),a=n.n(r),i=n(32),o=n(33),s=n.n(o);const c=s()(i.EuiFlexGroup).withConfig({displayName:"PopoverItemsWrapper",componentId:"sc-3vrhxe-0"})(["width:100%;"]),l=s()(i.EuiBadgeGroup).withConfig({displayName:"PopoverWrapper",componentId:"sc-3vrhxe-1"})(["max-height:200px;max-width:600px;overflow:auto;line-height:",";"],(({theme:e})=>e.eui.euiLineHeight)),u=({items:e,renderItem:t,popoverTitle:n,popoverButtonTitle:o,popoverButtonIcon:s,numberOfItemsToDisplay:u=0,dataTestPrefix:d="items"})=>{const[p,b]=Object(r.useState)(!1),f=({items:e})=>a.a.createElement(a.a.Fragment,null,e.map(t));return e.length<=u?a.a.createElement(c,{"data-test-subj":d,alignItems:"center",gutterSize:"s"},a.a.createElement(f,{items:e})):a.a.createElement(c,{alignItems:"center",gutterSize:"s","data-test-subj":d},0!==u&&a.a.createElement(i.EuiFlexItem,{grow:1,className:"eui-textTruncate"},a.a.createElement(f,{items:e.slice(0,u)})),a.a.createElement(i.EuiPopover,{ownFocus:!0,"data-test-subj":`${d}DisplayPopover`,button:a.a.createElement(i.EuiBadge,{iconType:s,color:"hollow","data-test-subj":`${d}DisplayPopoverButton`,onClick:()=>b(!p),onClickAriaLabel:o},o),isOpen:p,closePopover:()=>b(!p),repositionOnScroll:!0},n?a.a.createElement(i.EuiPopoverTitle,{"data-test-subj":`${d}DisplayPopoverTitle`},n):null,a.a.createElement(l,{"data-test-subj":`${d}DisplayPopoverWrapper`},a.a.createElement(f,{items:e.slice(u)}))))},d=a.a.memo(u);d.displayName="PopoverItems";const p=d},1112:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(4),a=n.n(r),i=n(39);class SecuritySolutionQueryClient extends i.QueryClient{constructor(e={}){var t,n,r;super({...e,defaultOptions:{...null!==(t=e.defaultOptions)&&void 0!==t?t:{},queries:{refetchIntervalInBackground:!1,refetchOnWindowFocus:!1,refetchOnMount:!0,keepPreviousData:!0,...null!==(n=null==e||null===(r=e.defaultOptions)||void 0===r?void 0:r.queries)&&void 0!==n?n:{}}}})}}const o=Object(r.memo)((({queryClient:e,children:t})=>{const n=Object(r.useMemo)((()=>e||new SecuritySolutionQueryClient),[e]);return a.a.createElement(i.QueryClientProvider,{client:n},t)}));o.displayName="ReactQueryClientProvider"},120:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(4),a=n(699);const i=()=>Object(r.useContext)(a.a)},1288:function(e,t,n){"use strict";n.r(t),n.d(t,"renderApp",(function(){return ht})),n.d(t,"createStoreFactory",(function(){return gt.a}));var r=n(82),a=n.n(r),i=n(4),o=n.n(i),s=n(53),c=n(37),l=n(41),u=n(343),d=n(78),p=n(32),b=n(51),f=n(165),m=n(1),h=n(81),g=n(98),v=n(283),y=n(324);const O=({toastLifeTimeMs:e=5e3})=>{const t=Object(d.useDispatch)(),n=Object(i.useMemo)((()=>g.a.errorsSelector()),[]),r=Object(h.a)(n),[{toasts:a},o]=Object(y.g)();return Object(i.useEffect)((()=>{r.forEach((({id:n,title:r,message:i})=>{a.some((e=>e.id===n))||o({type:"addToaster",toast:{color:"danger",id:n,iconType:"alert",title:r,errors:i,toastLifeTimeMs:e}}),t(v.a.removeError({id:n}))}))}),[t,o,r,e,a]),null};O.displayName="ErrorToastDispatcherComponent";const j=o.a.memo(O);var E=n(699),x=n(77),S=n(104),w=n(86);const I=Object(i.memo)((({children:e})=>{const t=Object(c.useLocation)(),n=Object(d.useDispatch)();return Object(i.useEffect)((()=>{n(w.a.showTimeline({id:S.d.active,show:!1}))}),[n,t.pathname]),Object(i.useEffect)((()=>{n({type:"userChangedUrl",payload:t})})),o.a.createElement(o.a.Fragment,null,e)}));I.displayName="RouteCapture";var k=n(1152);const _=({children:e})=>o.a.createElement(k.a.Provider,{value:Object(i.useReducer)(((e,t)=>{switch(t.type){case"updateRoute":return t.route;case"updateRouteWithOutSearch":return{...e,...t.route};case"updateSearch":return{...e,search:t.search};default:return e}}),k.b)},e),T=Object(i.memo)(_);var M=n(34),P=n(57),D=n(92),C=n.n(D),N=n(83),A=n(38),R=n(429),F=n(0);F.i18n.translate("xpack.securitySolution.components.mlPopup.hooks.errors.indexPatternFetchFailureTitle",{defaultMessage:"Index pattern fetch failure"}),F.i18n.translate("xpack.securitySolution.components.hooks.eql.partialResponse",{defaultMessage:"EQL Preview Error"}),F.i18n.translate("xpack.securitySolution.components.hooks.errors.timeIntervalsNotDefined",{defaultMessage:"Time intervals are not defined."});var L=n(79),U=n(102),q=n(112),J=n(158),B=n(159);const V=[{columnHeaderType:J.a,id:"@timestamp",initialWidth:B.b},{columnHeaderType:J.a,id:"event.module",linkField:"rule.reference"},{columnHeaderType:J.a,id:"event.dataset"},{columnHeaderType:J.a,id:"event.category"},{columnHeaderType:J.a,id:"event.severity"},{columnHeaderType:J.a,id:"observer.name"},{columnHeaderType:J.a,id:"host.name"},{columnHeaderType:J.a,id:"message"},{columnHeaderType:J.a,id:"agent.id"},{columnHeaderType:J.a,id:"agent.type"}];window["__react-beautiful-dnd-disable-dev-warnings"]=!0;const H=({browserFields:e,children:t})=>{const n=Object(d.useDispatch)(),r=Object(i.useMemo)((()=>w.b.getTimelineByIdSelector()),[]),a=Object(i.useMemo)((()=>g.b.getDataProvidersSelector()),[]),{timelines:s}=Object(x.k)().services,c=[s.getUseAddToTimelineSensor()],{dataProviders:l,timelineType:u}=Object(h.a)((e=>{var t;return Object(M.pick)(["dataProviders","timelineType"],null!==(t=r(e,L.j.active))&&void 0!==t?t:q.b)})),p=Object(h.a)(a),[,b]=Object(y.g)(),f=Object(i.useCallback)((e=>{const t=u===L.n.template?(e=>F.i18n.translate("xpack.securitySolution.hooks.useAddToTimeline.template.addedFieldMessage",{values:{fieldOrValue:e},defaultMessage:"Added {fieldOrValue} to timeline template"}))(e):(e=>F.i18n.translate("xpack.securitySolution.hooks.useAddToTimeline.addedFieldMessage",{values:{fieldOrValue:e},defaultMessage:"Added {fieldOrValue} to timeline"}))(e);Object(y.e)(t,b)}),[b,u]),m=Object(i.useCallback)((t=>{try{$(),null!=p&&(({activeTimelineDataProviders:e,browserFields:t,dataProviders:n,dispatch:r,onAddedToTimeline:a,result:i})=>{if(Object(U.p)(i))Object(R.e)({dataProviders:e,destination:i.destination,dispatch:r,source:i.source,timelineId:L.j.active});else if(Object(U.o)(i))Object(U.c)({activeTimelineDataProviders:e,dataProviders:n,dispatch:r,onAddedToTimeline:a,result:i,timelineId:L.j.active});else if(Object(U.i)(i)){var o,s;Object(A.addFieldToTimelineColumns)({browserFields:t,defaultsHeader:V,dispatch:r,result:i,timelineId:Object(A.getTimelineIdFromColumnDroppableId)(null!==(o=null===(s=i.destination)||void 0===s?void 0:s.droppableId)&&void 0!==o?o:"")})}})({activeTimelineDataProviders:l,browserFields:e,dataProviders:p,dispatch:n,onAddedToTimeline:f,result:t})}finally{document.body.classList.remove(N.d),Object(U.e)(t)&&document.body.classList.remove(U.b)}}),[l,e,p,n,f]);return o.a.createElement(P.DragDropContext,{onDragEnd:m,onBeforeCapture:z,sensors:c},t)};H.displayName="DragDropContextWrapperComponent";const K=o.a.memo(H,((e,t)=>C()(e.children,t.children)));K.displayName="DragDropContextWrapper";const z=e=>{Object(U.e)(e)||document.body.classList.add(N.d),Object(U.e)(e)&&document.body.classList.add(U.b)},$=()=>window.onscroll=()=>M.noop;var W=n(160),Q=n(14);const G=o.a.memo((()=>{const{chrome:e,docLinks:t}=Object(x.k)().services;return Object(i.useEffect)((()=>{e.setHelpExtension({appName:Q.c,links:[{content:F.i18n.translate("xpack.securitySolution.chrome.helpMenu.documentation",{defaultMessage:"Security documentation"}),href:t.links.siem.guide,iconType:"documents",linkType:"custom",target:"_blank",rel:"noopener"},{content:F.i18n.translate("xpack.securitySolution.chrome.helpMenu.documentation.ecs",{defaultMessage:"ECS documentation"}),href:t.links.ecs.guide,iconType:"documents",linkType:"custom",target:"_blank",rel:"noopener"},{linkType:"discuss",href:"https://discuss.elastic.co/c/security",target:"_blank",rel:"noopener"}]})}),[]),null}));G.displayName="HelpMenu";var Y=n(94),X=n(59),Z=n(116);var ee=n(287),te=n(198),ne=n(35),re=n(33),ae=n.n(re),ie=n(62);const oe=F.i18n.translate("xpack.securitySolution.components.mlPopover.jobsTable.filters.searchFilterPlaceholder",{defaultMessage:"e.g. rare_process_linux"}),se=F.i18n.translate("xpack.securitySolution.components.mlPopover.jobsTable.filters.groupsLabel",{defaultMessage:"Groups"}),ce=F.i18n.translate("xpack.securitySolution.components.mlPopover.jobsTable.filters.noGroupsAvailableDescription",{defaultMessage:"No Groups available"}),le=F.i18n.translate("xpack.securitySolution.components.mlPopover.jobsTable.filters.showAllJobsLabel",{defaultMessage:"Elastic jobs"}),ue=F.i18n.translate("xpack.securitySolution.components.mlPopover.jobsTable.filters.showSiemJobsLabel",{defaultMessage:"Custom jobs"});var de=n(1110);const pe=({securityJobs:e,onSelectedGroupsChanged:t})=>{const[n,r]=Object(i.useState)(!1),[a,s]=Object(i.useState)([]),c=e.map((e=>e.groups)).flat().filter((e=>"siem"!==e&&"security"!==e)),l=Array.from(new Set(c));return Object(i.useEffect)((()=>{t(a)}),[a.sort().join()]),o.a.createElement(p.EuiPopover,{ownFocus:!0,button:o.a.createElement(p.EuiFilterButton,{"data-test-subj":"groups-filter-popover-button",iconType:"arrowDown",onClick:()=>r(!n),isSelected:n,numFilters:l.length,hasActiveFilters:a.length>0,numActiveFilters:a.length},se),isOpen:n,closePopover:()=>r(!n),panelPaddingSize:"none",repositionOnScroll:!0},l.map(((e,t)=>o.a.createElement(p.EuiFilterSelectItem,{checked:a.includes(e)?"on":void 0,key:`${t}-${e}`,onClick:()=>Object(de.a)(e,a,s)},`${e} (${c.filter((t=>t===e)).length})`))),0===l.length&&o.a.createElement(p.EuiFlexGroup,{gutterSize:"m",justifyContent:"spaceAround"},o.a.createElement(p.EuiFlexItem,{grow:!0},o.a.createElement(p.EuiIcon,{type:"minusInCircle"}),o.a.createElement(p.EuiSpacer,{size:"xs"}),o.a.createElement("p",null,ce))))};pe.displayName="GroupsFilterPopoverComponent";const be=o.a.memo(pe);be.displayName="GroupsFilterPopover";const fe=({securityJobs:e,onFilterChanged:t})=>{const[n,r]=Object(i.useState)(""),[a,s]=Object(i.useState)([]),[c,l]=Object(i.useState)(!1),[u,d]=Object(i.useState)(!1);Object(i.useEffect)((()=>{t({filterQuery:n,showCustomJobs:c,showElasticJobs:u,selectedGroups:a})}),[n,a,c,u,t]);const b=Object(i.useCallback)((e=>r(e.queryText.trim())),[r]),f=Object(i.useCallback)((()=>{d(!u),l(!1)}),[d,u,l]),m=Object(i.useCallback)((()=>{l(!c),d(!1)}),[d,c,l]);return o.a.createElement(p.EuiFlexGroup,{gutterSize:"m",justifyContent:"flexEnd"},o.a.createElement(p.EuiFlexItem,{grow:!0},o.a.createElement(p.EuiSearchBar,{"data-test-subj":"jobs-filter-bar",box:{placeholder:oe,incremental:!0},onChange:b})),o.a.createElement(p.EuiFlexItem,{grow:!1},o.a.createElement(p.EuiFilterGroup,null,o.a.createElement(be,{securityJobs:e,onSelectedGroupsChanged:s}))),o.a.createElement(p.EuiFlexItem,{grow:!1},o.a.createElement(p.EuiFilterGroup,null,o.a.createElement(p.EuiFilterButton,{hasActiveFilters:u,onClick:f,"data-test-subj":"show-elastic-jobs-filter-button",withNext:!0},le),o.a.createElement(p.EuiFilterButton,{hasActiveFilters:c,onClick:m,"data-test-subj":"show-custom-jobs-filter-button"},ue))))};fe.displayName="JobsTableFiltersComponent";const me=o.a.memo(fe);me.displayName="JobsTableFilters";var he=n(1111);const ge=F.i18n.translate("xpack.securitySolution.components.mlPopup.jobsTable.jobNameColumn",{defaultMessage:"Job name"}),ve=F.i18n.translate("xpack.securitySolution.components.mlPopup.jobsTable.tagsColumn",{defaultMessage:"Groups"}),ye=F.i18n.translate("xpack.securitySolution.components.mlPopup.jobsTable.runJobColumn",{defaultMessage:"Run job"}),Oe=F.i18n.translate("xpack.securitySolution.components.mlPopup.jobsTable.noItemsDescription",{defaultMessage:"No Security Machine Learning jobs found"}),je=F.i18n.translate("xpack.securitySolution.components.mlPopup.jobsTable.createCustomJobButtonLabel",{defaultMessage:"Create custom job"});var Ee=n(825);const xe=ae.a.div.withConfig({displayName:"JobNameWrapper",componentId:"sc-1foobv2-0"})(["margin:5px 0;"]);xe.displayName="JobNameWrapper";const Se=({id:e,description:t,basePath:n})=>{const{services:{ml:r}}=Object(x.k)(),a=Object(ie.useMlHref)(r,n,{page:ie.ML_PAGES.ANOMALY_DETECTION_JOBS_MANAGE,pageState:{jobId:e}});return o.a.createElement(xe,null,o.a.createElement(p.EuiText,{size:"s"},o.a.createElement(p.EuiLink,{"data-test-subj":"jobs-table-link",href:a,target:"_blank"},e)),o.a.createElement(p.EuiText,{color:"subdued",size:"xs"},t.length>200?`${t.substring(0,200)}...`:t))},we=(e,t,n)=>[{name:ge,render:({id:e,description:t})=>o.a.createElement(Se,{id:e,description:t,basePath:n})},{name:ve,render:({groups:e})=>o.a.createElement(he.a,{items:e,numberOfItemsToDisplay:0,popoverButtonTitle:`${e.length} Groups`,renderItem:(e,t)=>o.a.createElement(p.EuiBadge,{color:"hollow",key:`${e}-${t}`,"data-test-subj":"group"},e),dataTestPrefix:"groups"}),width:"80px"},{name:ye,render:n=>n.isCompatible?o.a.createElement(Ee.a,{job:n,isSecurityJobsLoading:e,onJobStateChange:t}):o.a.createElement(p.EuiIcon,{"aria-label":"Warning",size:"s",type:"alert",color:"warning"}),align:p.CENTER_ALIGNMENT,width:"80px"}],Ie=(e,t,n)=>e.slice(t*n,t*n+n),ke=({isLoading:e,jobs:t,onJobStateChange:n})=>{const[r,a]=Object(i.useState)(0),s=Object(x.e)(),c={showPerPageOptions:!1,pageIndex:r,pageSize:5,totalItemCount:t.length};return Object(i.useEffect)((()=>{a(0)}),[t.length]),o.a.createElement(p.EuiBasicTable,{"data-test-subj":"jobs-table",columns:we(e,n,s),items:Ie(t,r,5),loading:e,noItemsMessage:o.a.createElement(Te,{basePath:s}),pagination:c,responsive:!1,onChange:({page:e})=>{a(e.index)}})};ke.displayName="JobsTableComponent";const _e=o.a.memo(ke);_e.displayName="JobsTable";const Te=o.a.memo((({basePath:e})=>{const{services:{ml:t}}=Object(x.k)(),n=Object(ie.useMlHref)(t,e,{page:ie.ML_PAGES.ANOMALY_DETECTION_CREATE_JOB_SELECT_INDEX});return o.a.createElement(p.EuiEmptyPrompt,{title:o.a.createElement("h3",null,Oe),titleSize:"xs",actions:o.a.createElement(p.EuiButton,{href:n,iconType:"popout",iconSide:"right",size:"s",target:"_blank"},je)})}));Te.displayName="NoItemsMessage";const Me=ae.a.div.withConfig({displayName:"ShowingContainer",componentId:"sc-8k6h3p-0"})(["user-select:none;margin-top:5px;"]);Me.displayName="ShowingContainer";const Pe=({filterResultsLength:e})=>o.a.createElement(Me,{"data-test-subj":"showing"},o.a.createElement(p.EuiText,{color:"subdued",size:"xs"},o.a.createElement(ne.FormattedMessage,{"data-test-subj":"query-message",id:"xpack.securitySolution.components.mlPopup.showingLabel",defaultMessage:"Showing: {filterResultsLength} {filterResultsLength, plural, one {job} other {jobs}}",values:{filterResultsLength:e}})));Pe.displayName="ShowingCountComponent";const De=o.a.memo(Pe);De.displayName="ShowingCount";const Ce=()=>o.a.createElement(p.EuiText,{size:"s"},o.a.createElement(ne.FormattedMessage,{id:"xpack.securitySolution.components.mlPopup.anomalyDetectionDescription",defaultMessage:"Run any of the Machine Learning jobs below to prepare for creating detection rules that produce alerts for detected anomalies, and to view anomalous events throughout the Security application. We’ve provided a collection of common detection jobs to get you started. If you wish to add your own custom ML jobs, create and add them to the “Security” group from the {machineLearning} application.",values:{machineLearning:o.a.createElement(p.EuiLink,{href:`${Object(x.e)()}/app/ml`,target:"_blank"},o.a.createElement(ne.FormattedMessage,{id:"xpack.securitySolution.components.mlPopup.machineLearningLink",defaultMessage:"Machine Learning"}))}}));Ce.displayName="PopoverDescriptionComponent";const Ne=o.a.memo(Ce);Ne.displayName="PopoverDescription";const Ae=F.i18n.translate("xpack.securitySolution.components.mlPopup.mlJobSettingsButtonLabel",{defaultMessage:"ML job settings"}),Re=F.i18n.translate("xpack.securitySolution.components.mlPopup.upgradeTitle",{defaultMessage:"Upgrade to Elastic Platinum"}),Fe=F.i18n.translate("xpack.securitySolution.components.mlPopup.upgradeButtonLabel",{defaultMessage:"Subscription plans"}),Le=F.i18n.translate("xpack.securitySolution.components.mlPopup.licenseButtonLabel",{defaultMessage:"Manage license"}),Ue=e=>F.i18n.translate("xpack.securitySolution.components.mlPopup.moduleNotCompatibleTitle",{values:{incompatibleJobCount:e},defaultMessage:"{incompatibleJobCount} {incompatibleJobCount, plural, =1 {job is} other {jobs are}} currently unavailable"}),qe=F.i18n.translate("xpack.securitySolution.entityAnalytics.anomalies.AnomalyDetectionDocsTitle",{defaultMessage:"Anomaly Detection with Machine Learning"}),Je=ae.a.div.withConfig({displayName:"PopoverContentsDiv",componentId:"sc-fqnfg5-0"})(["width:384px;"]);Je.displayName="PopoverContentsDiv";const Be=()=>o.a.createElement(Je,{"data-test-subj":"ml-popover-upgrade-contents"},o.a.createElement(p.EuiPopoverTitle,null,Re),o.a.createElement(p.EuiText,{size:"s"},o.a.createElement(ne.FormattedMessage,{id:"xpack.securitySolution.components.mlPopup.upgradeDescription",defaultMessage:"To access SIEM’s anomaly detection features, you must update your license to Platinum, start a free 30-day trial, or spin up a {cloudLink} on AWS, GCP, or Azure. You can then run Machine Learning jobs and view anomalies.",values:{cloudLink:o.a.createElement(p.EuiLink,{href:"https://www.elastic.co/cloud/",target:"_blank"},o.a.createElement(ne.FormattedMessage,{id:"xpack.securitySolution.components.mlPopup.cloudLink",defaultMessage:"cloud deployment"}))}})),o.a.createElement(p.EuiSpacer,null),o.a.createElement(p.EuiFlexGroup,{gutterSize:"s",wrap:!0},o.a.createElement(p.EuiFlexItem,{grow:!1},o.a.createElement(p.EuiButton,{href:"https://www.elastic.co/subscriptions",iconType:"popout",iconSide:"right",target:"_blank"},Fe)),o.a.createElement(p.EuiFlexItem,{grow:!1},o.a.createElement(p.EuiButton,{href:`${Object(x.e)()}/app/management/stack/license_management`,iconType:"gear",target:"_blank"},Le)))),Ve=o.a.memo(Be);Ve.displayName="UpgradeContents";var He=n(378),Ke=n(518);const ze=ae.a.div.withConfig({displayName:"PopoverContentsDiv",componentId:"sc-z6keba-0"})(["max-width:684px;max-height:90vh;overflow-y:auto;overflow-x:hidden;padding-bottom:15px;"]);ze.displayName="PopoverContentsDiv";const $e={filterQuery:"",showCustomJobs:!1,showElasticJobs:!1,selectedGroups:[]},We=o.a.memo((()=>{const[e,t]=Object(i.useState)(!1),[n,r]=Object(i.useState)($e),{isMlAdmin:a,isLicensed:s,loading:c,jobs:l,refetch:u}=Object(He.a)(),d=Object(x.k)().services.docLinks,{enableDatafeed:b,isLoading:f}=Object(Ke.a)(),m=Object(i.useCallback)((async(e,t,n)=>{const r=await b(e,t,n);return u(),r}),[u,b]),h=(({jobs:e,selectedGroups:t,showCustomJobs:n,showElasticJobs:r,filterQuery:a})=>((e,t)=>e.filter((e=>null==t||e.id.includes(t)||e.description.includes(t))))(e.filter((e=>!n||n&&!e.isElasticJob)).filter((e=>!r||r&&e.isElasticJob)).filter((e=>0===t.length||t.some((t=>e.groups.includes(t))))),a))({jobs:l,...n}),g=l.filter((e=>!e.isCompatible)).length,v=Object(i.useMemo)((()=>l.filter((e=>e.isInstalled)).map((e=>e.id))),[l]);return s?a?o.a.createElement(p.EuiPopover,{anchorPosition:"downRight",id:"integrations-popover",button:o.a.createElement(p.EuiHeaderSectionItemButton,{"aria-expanded":e,"aria-haspopup":"true","aria-label":Ae,color:"primary","data-test-subj":"integrations-button",iconType:"arrowDown",iconSide:"right",onClick:()=>{t(!e),u()},textProps:{style:{fontSize:"1rem"}}},Ae),isOpen:e,closePopover:()=>t(!e),repositionOnScroll:!0},o.a.createElement(ze,{"data-test-subj":"ml-popover-contents"},o.a.createElement(p.EuiPopoverTitle,null,Ae),o.a.createElement(Ne,null),o.a.createElement(p.EuiSpacer,null),o.a.createElement(me,{securityJobs:l,onFilterChanged:r}),o.a.createElement(De,{filterResultsLength:h.length}),o.a.createElement(p.EuiSpacer,{size:"m"}),g>0&&o.a.createElement(o.a.Fragment,null,o.a.createElement(p.EuiCallOut,{title:Ue(g),color:"warning",iconType:"alert",size:"s"},o.a.createElement("p",null,o.a.createElement(ne.FormattedMessage,{defaultMessage:"We could not find any data, see {mlDocs} for more information on Machine Learning job requirements.",id:"xpack.securitySolution.components.mlPopup.moduleNotCompatibleDescription",values:{mlDocs:o.a.createElement("a",{href:`${d.links.siem.ml}`,rel:"noopener noreferrer",target:"_blank"},qe)}}))),o.a.createElement(p.EuiSpacer,{size:"m"})),o.a.createElement(ie.MLJobsAwaitingNodeWarning,{jobIds:v}),o.a.createElement(_e,{isLoading:c||f,jobs:h,onJobStateChange:m}))):null:o.a.createElement(p.EuiPopover,{anchorPosition:"downRight",id:"integrations-popover",button:o.a.createElement(p.EuiHeaderSectionItemButton,{"aria-expanded":e,"aria-haspopup":"true","aria-label":Ae,color:"primary","data-test-subj":"integrations-button",iconType:"arrowDown",iconSide:"right",onClick:()=>t(!e),textProps:{style:{fontSize:"1rem"}}},Ae),isOpen:e,closePopover:()=>t(!e),repositionOnScroll:!0},o.a.createElement(Ve,null))}));We.displayName="MlPopover";var Qe=n(99),Ge=n(1119);const Ye=F.i18n.translate("xpack.securitySolution.globalHeader.buttonAddData",{defaultMessage:"Add integrations"}),Xe=o.a.memo((({setHeaderActionMenu:e})=>{const t=Object(i.useMemo)((()=>Object(ee.c)()),[]),{theme:n,http:{basePath:{prepend:r}},cloudExperiments:a}=Object(x.k)().services,{pathname:s}=Object(c.useLocation)(),u=Object(i.useMemo)((()=>w.b.getTimelineByIdSelector()),[]),d=Object(h.b)((e=>{var t;return(null!==(t=u(e,L.j.active))&&void 0!==t?t:q.b).show})),b=Object(Y.a)(s),f=Object(Y.b)(s),g=Object(Qe.isThreatIntelligencePath)(s)?m.b:m.a,[v,y]=Object(i.useState)(g);Object(te.c)(a,"security-solutions.add-integrations-url",m.a,y);const O=Object(i.useMemo)((()=>r(v)),[r,v]);return Object(i.useEffect)((()=>(e((e=>Object(l.toMountPoint)(o.a.createElement(ee.b,{node:t}),{theme$:n.theme$})(e))),()=>{t.unmount(),e(void 0)})),[t,e,n.theme$]),o.a.createElement(ee.a,{node:t},o.a.createElement(p.EuiHeaderSection,{side:"right"},Object(Qe.isDetectionsPath)(s)&&o.a.createElement(p.EuiHeaderSectionItem,null,o.a.createElement(We,null)),o.a.createElement(p.EuiHeaderSectionItem,null,o.a.createElement(p.EuiHeaderLinks,null,o.a.createElement(p.EuiHeaderLink,{color:"primary","data-test-subj":"add-data",href:O,iconType:"indexOpen"},Ye),f&&!d&&o.a.createElement(Ge.a,{scope:b,"data-test-subj":"sourcerer"})))))}));Xe.displayName="GlobalHeader";var Ze=n(1084),et=n(403),tt=n(281),nt=n(1075),rt=n(521),at=n(9),it=n(183);const ot=({children:e,setHeaderActionMenu:t})=>{const{pathname:n}=Object(c.useLocation)();Object(Y.c)(Object(Y.a)(n)),Object(tt.b)(),(()=>{const e=Object(rt.b)(),[{pageName:t}]=Object(it.a)(),n=Object(at.b)(t);Object(i.useEffect)((()=>{var r;document.title=e?`${null!==(r=null==n?void 0:n.title)&&void 0!==r?r:""} - Kibana`:`${((e,t)=>null!=t[e]?t[e].name:"")(t,nt.a)} - Kibana`}),[t,e,n])})();const{browserFields:r}=Object(Y.d)(Object(Y.a)(n));return(()=>{const e=Object(x.k)(),t=Object(Z.a)().endpointPrivileges.canAccessFleet;Object(i.useEffect)((()=>{const n=new AbortController,r=()=>{n.abort()};if(t){const t=n.signal;return(async()=>{try{var r;await(null===(r=e.services.fleet)||void 0===r?void 0:r.isInitialized()),await(async(e,t={})=>e.post(X.epmRouteService.getBulkInstallPath(),{...t,body:JSON.stringify({packages:["endpoint","security_detection_engine"]})}))(e.services.http,{signal:t})}catch(e){n.signal.aborted||console.error(e)}})(),r}}),[t,e.services.fleet,e.services.http])})(),o.a.createElement(W.h,{className:"kbnAppWrapper"},o.a.createElement(Ze.a,null,o.a.createElement(et.a,null,o.a.createElement(o.a.Fragment,null,o.a.createElement(Xe,{setHeaderActionMenu:t}),o.a.createElement(K,{browserFields:r},e),o.a.createElement(G,null)))))};ot.displayName="HomePage";const st=o.a.memo(ot),ct=({children:e,history:t,onAppLeave:n,setHeaderActionMenu:r})=>{const{cases:a}=Object(x.k)().services,s=a.ui.getCasesContext(),p=Object(x.i)(),b=Object(d.useDispatch)();return Object(i.useEffect)((()=>()=>{b({type:"userChangedUrl",payload:{pathname:"",search:"",hash:""}})}),[b]),o.a.createElement(T,null,o.a.createElement(c.Router,{history:t},o.a.createElement(I,null,o.a.createElement(c.Switch,null,o.a.createElement(l.Route,{path:"/"},o.a.createElement(s,{owner:[m.p],permissions:p},o.a.createElement(st,{setHeaderActionMenu:r},e))),o.a.createElement(l.Route,null,o.a.createElement(u.a,null))))))},lt=Object(i.memo)(ct);var ut=n(1088),dt=n(1112);const pt=({children:e,history:t,setHeaderActionMenu:n,onAppLeave:r,store:a,theme$:i})=>{const{i18n:s,application:{capabilities:c}}=Object(x.k)().services,[u]=Object(x.q)(m.O);return o.a.createElement(p.EuiErrorBoundary,null,o.a.createElement(s.Context,null,o.a.createElement(y.b,null,o.a.createElement(d.Provider,{store:a},o.a.createElement(l.KibanaThemeProvider,{theme$:i},o.a.createElement(b.EuiThemeProvider,{darkMode:u},o.a.createElement(E.b,null,o.a.createElement(ut.b,{kibanaCapabilities:c},o.a.createElement(f.a,null,o.a.createElement(dt.a,null,o.a.createElement(lt,{history:t,onAppLeave:r,setHeaderActionMenu:n},e))))))),o.a.createElement(j,null),o.a.createElement(y.a,null)))))},bt=Object(i.memo)(pt),ft=({children:e,history:t,onAppLeave:n,services:r,setHeaderActionMenu:a,store:i,theme$:s})=>o.a.createElement(x.a,{services:{appName:m.s,...r}},o.a.createElement(bt,{history:t,onAppLeave:n,setHeaderActionMenu:a,store:i,theme$:s},e)),mt=Object(i.memo)(ft),ht=({element:e,history:t,onAppLeave:n,setHeaderActionMenu:r,services:i,store:d,usageCollection:p,subPluginRoutes:b,theme$:f})=>{var m;const h=null!==(m=null==p?void 0:p.components.ApplicationUsageTrackingProvider)&&void 0!==m?m:o.a.Fragment;return Object(s.render)(o.a.createElement(mt,{history:t,onAppLeave:n,services:i,setHeaderActionMenu:r,store:d,theme$:f},o.a.createElement(h,null,o.a.createElement(c.Switch,null,b.map(((e,t)=>o.a.createElement(l.Route,a()({key:`route-${t}`},e)))),o.a.createElement(l.Route,null,o.a.createElement(u.a,null))))),e),()=>Object(s.unmountComponentAtNode)(e)};var gt=n(898)},136:function(e,t,n){"use strict";n.d(t,"a",(function(){return S})),n.d(t,"e",(function(){return w})),n.d(t,"d",(function(){return I})),n.d(t,"f",(function(){return k})),n.d(t,"g",(function(){return T})),n.d(t,"c",(function(){return B})),n.d(t,"h",(function(){return V})),n.d(t,"b",(function(){return H}));var r=n(528),a=n(34),i=n(117),o=n.n(i),s=n(252),c=n.n(s),l=n(90),u=n(79),d=n(402),p=n(143),b=n(12),f=n(112),m=n(158),h=n(159),g=n(549),v=n(106),y=n(526),O=n(177),j=n(95),E=n(381),x=n(227);const S="open-timeline",w=({pinnedEventIds:e})=>null!=e?Object.keys(e).length:0,I=({eventIdToNoteIds:e,noteIds:t})=>(null!=e?Object.keys(e).reduce(((t,n)=>t+e[n].length),0):0)+(null!=t?t.length:0),k=({title:e})=>null==e||0===e.trim().length,_=(e,t)=>"__typename"===e?void 0:t,T=e=>JSON.parse(JSON.stringify(e),_),M=e=>{try{return JSON.parse(e)}catch{return e}},P=e=>Object.entries(e).reduce(((e,[t,n])=>"id"!==t&&null!=n?{...e,[t]:n}:e),{columnHeaderType:m.a,id:null!=e.id?e.id:"unknown",initialWidth:"@timestamp"===e.id?h.b:h.a}),D=e=>({$state:{store:"appState"},meta:{...e.meta,...e.meta&&null!=e.meta.field?{params:M(e.meta.field)}:{},...e.meta&&null!=e.meta.params?{params:M(e.meta.params)}:{},...e.meta&&null!=e.meta.value?{value:M(e.meta.value)}:{}},...null!=e.exists?{exists:M(e.exists)}:{},...null!=e.match_all?{exists:M(e.match_all)}:{},...null!=e.missing?{exists:M(e.missing)}:{},...null!=e.query?{query:M(e.query)}:{},...null!=e.range?{range:M(e.range)}:{},...null!=e.script?{exists:M(e.script)}:{}}),C=(e,t)=>e?{}:null!=t?t.reduce(((e,t)=>{if(null!=t.eventId){const n=Object(a.getOr)([],t.eventId,e);return{...e,[t.eventId]:[...n,t.noteId]}}return e}),{}):{},N=(e,t)=>e?{}:null!=t?t.reduce(((e,t)=>({...e,...null!=t.eventId?{[t.eventId]:t}:{}})),{}):{},A=(e,t)=>e?{}:null!=t?t.reduce(((e,t)=>({...e,[t]:!0})),{}):{},R=(e,t,n)=>n===u.n.default&&e.timelineType===u.n.template?e.templateTimelineId:t&&e.timelineType===u.n.template?o.a.v4():e.templateTimelineId,F=({and:e,...t})=>t.type===u.a.template?c()(t,{type:u.a.default,enabled:t.queryMatch.operator!==v.d,queryMatch:{value:t.queryMatch.operator===v.d?"":t.queryMatch.value}}):t,L=(e,t,n)=>e&&t&&n===u.n.default?t.map((e=>{var t,n;return{...F(e),and:null!==(t=null===(n=e.and)||void 0===n?void 0:n.map(F))&&void 0!==t?t:[]}})):t,U=(e,t,n)=>n&&e.timelineType!==n?"":t?`${e.title} - Duplicate`:e.title||"",q=(e,t,n)=>n&&e.timelineType!==n?u.l.draft:t?u.l.active:e.status,J=(e,t,n)=>{const a=e.timelineType===u.n.template,i={...e,columns:null!=e.columns?e.columns.map(P):m.b,defaultColumns:m.b,dateRange:e.status===u.l.immutable&&e.timelineType===u.n.template?{start:E.a.toISOString(),end:E.b.toISOString()}:e.dateRange,dataProviders:L(t,e.dataProviders,n),eventIdToNoteIds:C(t,e.eventIdToNoteIds),filters:null!=e.filters?e.filters.map(D):[],isFavorite:!t&&null!=e.favorite&&e.favorite.length>0,noteIds:t?[]:null!=e.noteIds?e.noteIds:[],pinnedEventIds:A(t,e.pinnedEventIds),pinnedEventsSaveObject:N(t,e.pinnedEventsSaveObject),id:t?"":e.savedObjectId,status:q(e,t,n),savedObjectId:t?null:e.savedObjectId,version:t?null:e.version,timelineType:null!=n?n:e.timelineType,title:U(e,t,n),templateTimelineId:R(e,t,n),templateTimelineVersion:t&&a?1:e.templateTimelineVersion};return Object.entries(i).reduce(((e,[t,n])=>null!=n?Object(r.set)(t,n,e):e),{...f.b,id:""})},B=(e,t=!1,n)=>{const{notes:r,...a}=e;return{notes:r,timeline:J(a,t,n)}},V=({activeTimelineTab:e=u.m.query,duplicate:t=!1,graphEventId:n="",timelineId:r,timelineType:i,onError:o,onOpenTimeline:s,openTimeline:c=!0,updateIsLoading:l,updateTimeline:d})=>{l({id:u.j.active,isLoading:!0}),Promise.resolve(Object(x.i)(r)).then((r=>{const o=Object(a.getOr)(null,"data",r);if(!o)return;const l=T(o.timeline),{timeline:p,notes:b}=B(l,t,i);if(null!=s)s(p);else if(d){const{from:r,to:i}=Object(y.a)({from:Object(a.getOr)(null,"dateRange.start",p),to:Object(a.getOr)(null,"dateRange.end",p)});d({duplicate:t,from:r,id:u.j.active,notes:b,resolveTimelineConfig:{outcome:o.outcome,alias_target_id:o.alias_target_id,alias_purpose:o.alias_purpose},timeline:{...p,activeTab:e,graphEventId:n,show:c,dateRange:{start:r,end:i}},to:i})()}})).catch((e=>{null!=o&&o(e,r)})).finally((()=>{l({id:u.j.active,isLoading:!1})}))},H=e=>({duplicate:t,id:n,forceNotes:r=!1,from:i,notes:o,resolveTimelineConfig:s,timeline:c,to:f,ruleNote:m})=>()=>{var h;if(Object(a.isEmpty)(c.indexNames)||e(O.a.setSelectedDataView({id:j.SourcererScopeName.timeline,selectedDataViewId:c.dataViewId,selectedPatterns:c.indexNames})),c.status===u.l.immutable&&c.timelineType===u.n.template?e(Object(p.setRelativeRangeDatePicker)({id:l.a.timeline,fromStr:"now-24h",toStr:"now",from:E.a.toISOString(),to:E.b.toISOString()})):e(Object(p.setTimelineRangeDatePicker)({from:i,to:f})),e(Object(b.addTimeline)({id:n,timeline:c,resolveTimelineConfig:s,savedTimeline:t})),null!=c.kqlQuery&&null!=c.kqlQuery.filterQuery&&null!=c.kqlQuery.filterQuery.kuery&&""!==c.kqlQuery.filterQuery.kuery.expression&&e(Object(b.applyKqlFilterQuery)({id:n,filterQuery:{kuery:{kind:null!==(h=c.kqlQuery.filterQuery.kuery.kind)&&void 0!==h?h:"kuery",expression:c.kqlQuery.filterQuery.kuery.expression||""},serializedQuery:c.kqlQuery.filterQuery.serializedQuery||""}})),t&&null!=m&&!Object(a.isEmpty)(m)){const t=Object(g.a)({newNote:m});e(Object(d.updateNote)({note:t})),e(Object(b.addNote)({noteId:t.id,id:n}))}t&&!r||e(Object(d.addNotes)({notes:null!=o?o.map((e=>{var t,n;return{created:null!=e.created?new Date(e.created):new Date,id:e.noteId,lastEdit:null!=e.updated?new Date(e.updated):new Date,note:e.note||"",user:e.updatedBy||"unknown",saveObjectId:e.noteId,version:e.version,eventId:null!==(t=e.eventId)&&void 0!==t?t:null,timelineId:null!==(n=e.timelineId)&&void 0!==n?n:null}})):[]}))}},149:function(e,t,n){"use strict";n.d(t,"g",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"e",(function(){return p})),n.d(t,"i",(function(){return b})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return m})),n.d(t,"j",(function(){return h})),n.d(t,"d",(function(){return g})),n.d(t,"h",(function(){return v})),n.d(t,"f",(function(){return y}));var r=n(7),a=n(108),i=n(90);const o=e=>e.policy,s=e=>e.timerange,c=e=>e.queries,l=(e,t)=>{const n=e.inputs[t];return Object(r.isEmpty)(n.linkTo)?n.queries:n.linkTo.reduce(((t,n)=>{if(n===i.a.socTrends)return t;const r=e.inputs[n];return[...t,...r.queries]}),n.queries)},u=()=>Object(a.createSelector)(o,(e=>e.kind)),d=()=>Object(a.createSelector)(o,(e=>e.duration)),p=()=>Object(a.createSelector)(s,(e=>e.kind)),b=()=>Object(a.createSelector)(s,(e=>e.from)),f=()=>Object(a.createSelector)(s,(e=>e.to)),m=()=>Object(a.createSelector)(s,(e=>e.fromStr)),h=()=>Object(a.createSelector)(s,(e=>e.toStr)),g=()=>Object(a.createSelector)(c,(e=>e.some((e=>!0===e.loading)))),v=()=>Object(a.createSelector)(l,(e=>e.filter((e=>"kql"!==e.id)))),y=()=>Object(a.createSelector)(c,(e=>e.find((e=>"kql"===e.id))))},154:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(4),a=n(77);const i={managed:!0},o=()=>{const{services:{apm:e}}=Object(a.k)();return{startTransaction:Object(r.useCallback)((({name:t,type:n="user-interaction",options:r})=>e.startTransaction(t,n,null!=r?r:i)),[e])}}},157:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return l}));const r=["started","opened"],a=["starting","stopping","opening","closing"],i=["deleted","failed"],o=(e,t)=>r.includes(e)&&r.includes(t),s=(e,t)=>a.includes(e)||a.includes(t),c=(e,t)=>i.includes(e)||i.includes(t),l=e=>"machine_learning"===e},165:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return p})),n.d(t,"c",(function(){return b}));var r=n(34),a=n(4),i=n.n(a),o=n(217),s=n(230);const c={canUserCRUD:null,canUserREAD:null,hasIndexManage:null,hasIndexMaintenance:null,hasIndexWrite:null,hasIndexRead:null,hasIndexUpdateDelete:null,isSignalIndexExists:null,isAuthenticated:null,hasEncryptionKey:null,loading:!0,signalIndexName:null,signalIndexMappingOutdated:null},l=(e,t)=>{switch(t.type){case"updateLoading":return{...e,loading:t.loading};case"updateHasIndexManage":return{...e,hasIndexManage:t.hasIndexManage};case"updateHasIndexMaintenance":return{...e,hasIndexMaintenance:t.hasIndexMaintenance};case"updateHasIndexWrite":return{...e,hasIndexWrite:t.hasIndexWrite};case"updateHasIndexRead":return{...e,hasIndexRead:t.hasIndexRead};case"updateHasIndexUpdateDelete":return{...e,hasIndexUpdateDelete:t.hasIndexUpdateDelete};case"updateIsSignalIndexExists":return{...e,isSignalIndexExists:t.isSignalIndexExists};case"updateIsAuthenticated":return{...e,isAuthenticated:t.isAuthenticated};case"updateHasEncryptionKey":return{...e,hasEncryptionKey:t.hasEncryptionKey};case"updateSignalIndexName":return{...e,signalIndexName:t.signalIndexName};case"updateSignalIndexMappingOutdated":return{...e,signalIndexMappingOutdated:t.signalIndexMappingOutdated};case"updateCanUserCRUD":return{...e,canUserCRUD:t.canUserCRUD};case"updateCanUserREAD":return{...e,canUserREAD:t.canUserREAD};default:return e}},u=Object(a.createContext)([c,()=>r.noop]),d=()=>Object(a.useContext)(u),p=({children:e})=>i.a.createElement(u.Provider,{value:Object(a.useReducer)(l,c)},e),b=()=>{const[{canUserCRUD:e,canUserREAD:t,hasIndexManage:n,hasIndexMaintenance:r,hasIndexWrite:i,hasIndexRead:c,hasIndexUpdateDelete:l,isSignalIndexExists:u,isAuthenticated:p,hasEncryptionKey:b,loading:f,signalIndexName:m,signalIndexMappingOutdated:h},g]=d(),{loading:v,isAuthenticated:y,hasEncryptionKey:O,hasIndexManage:j,hasIndexMaintenance:E,hasIndexUpdateDelete:x,hasIndexWrite:S,hasIndexRead:w,hasKibanaCRUD:I,hasKibanaREAD:k}=Object(o.a)(),{loading:_,signalIndexExists:T,signalIndexName:M,signalIndexMappingOutdated:P,createDeSignalIndex:D}=Object(s.a)();return Object(a.useEffect)((()=>{f||e===I||g({type:"updateCanUserCRUD",canUserCRUD:I})}),[g,f,e,I]),Object(a.useEffect)((()=>{f||t===k||g({type:"updateCanUserREAD",canUserREAD:k})}),[g,f,t,k]),Object(a.useEffect)((()=>{f!==(v||_)&&g({type:"updateLoading",loading:v||_})}),[g,f,v,_]),Object(a.useEffect)((()=>{f||n===j||null==j||g({type:"updateHasIndexManage",hasIndexManage:j})}),[g,f,n,j]),Object(a.useEffect)((()=>{f||i===S||null==S||g({type:"updateHasIndexWrite",hasIndexWrite:S})}),[g,f,i,S]),Object(a.useEffect)((()=>{f||c===w||null==w||g({type:"updateHasIndexRead",hasIndexRead:w})}),[g,f,c,w]),Object(a.useEffect)((()=>{f||l===x||null==x||g({type:"updateHasIndexUpdateDelete",hasIndexUpdateDelete:x})}),[g,f,l,x]),Object(a.useEffect)((()=>{f||r===E||null==E||g({type:"updateHasIndexMaintenance",hasIndexMaintenance:E})}),[g,f,r,E]),Object(a.useEffect)((()=>{f||u===T||null==T||g({type:"updateIsSignalIndexExists",isSignalIndexExists:T})}),[g,f,u,T]),Object(a.useEffect)((()=>{f||p===y||null==y||g({type:"updateIsAuthenticated",isAuthenticated:y})}),[g,f,p,y]),Object(a.useEffect)((()=>{f||b===O||null==O||g({type:"updateHasEncryptionKey",hasEncryptionKey:O})}),[g,f,b,O]),Object(a.useEffect)((()=>{f||m===M||null==M||g({type:"updateSignalIndexName",signalIndexName:M})}),[g,f,m,M]),Object(a.useEffect)((()=>{f||h===P||null==P||g({type:"updateSignalIndexMappingOutdated",signalIndexMappingOutdated:P})}),[g,f,h,P]),Object(a.useEffect)((()=>{p&&b&&n&&(null!=u&&!u||null!=h&&h)&&null!=D&&D()}),[D,p,b,u,n,h]),{loading:f,isSignalIndexExists:u,isAuthenticated:p,hasEncryptionKey:b,canUserCRUD:e,canUserREAD:t,hasIndexManage:n,hasIndexMaintenance:r,hasIndexWrite:i,hasIndexRead:c,hasIndexUpdateDelete:l,signalIndexName:m,signalIndexMappingOutdated:h}}},175:function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return y}));var r=n(34),a=n(294),i=n.n(a),o=n(4),s=n(53),c=n.n(s),l=n(11),u=n(42),d=n(77),p=n(431),b=n(84),f=n(285);const m=e=>Object(r.keyBy)("name",function(e){const t=[];for(const n of Object.values(e))n.fields&&t.push(...Object.values(n.fields));return t}(e)),h=i()(((e,t)=>t&&t.length>0?{fields:t.map((e=>Object(r.pick)(["name","searchable","type","aggregatable","esTypes","subType"],e))),title:e}:{fields:[],title:e}),((e,t)=>e[0]===t[0]&&e[1].length===t[1].length)),g=(i()(((e,t)=>t.reduce(((e,t)=>(null==e[t.category]&&(e[t.category]={}),null==e[t.category].fields&&(e[t.category].fields={}),e[t.category].fields[t.name]=t,e)),{})),((e,t)=>e[0]===t[0]&&e[1].length===t[1].length)),{}),v={fields:[],title:""},y=(e,t=!1)=>{const{data:n}=Object(d.k)().services,a=Object(o.useRef)(new AbortController),i=Object(o.useRef)(new l.Subscription),s=Object(o.useRef)([]),[m,y]=Object(o.useState)(!1),[O,j]=Object(o.useState)({browserFields:g,indexes:e,indexExists:!0,indexPatterns:v}),{addError:E,addWarning:x}=Object(b.a)(),S=Object(o.useCallback)((e=>{i.current.unsubscribe(),a.current.abort(),(async()=>{a.current=new AbortController,y(!0),i.current=n.search.search({indices:e,onlyCheckIfIndicesExist:t},{abortSignal:a.current.signal,strategy:"indexFields"}).subscribe({next:e=>{Object(u.isCompleteResponse)(e)?Promise.resolve().then((()=>{c.a.unstable_batchedUpdates((()=>{const t=e.indicesExist.sort().join();s.current=e.indicesExist;const{browserFields:n}=Object(f.a)(t,e.indexFields);y(!1),j({browserFields:n,indexes:e.indicesExist,indexExists:e.indicesExist.length>0,indexPatterns:h(t,e.indexFields)}),i.current.unsubscribe()}))})):Object(u.isErrorResponse)(e)&&(y(!1),x(p.a),i.current.unsubscribe())},error:e=>{y(!1),E(e,{title:p.b}),i.current.unsubscribe()}})})()}),[n.search,E,x,t,y,j]);return Object(o.useEffect)((()=>(Object(r.isEmpty)(e)||Object(r.isEqual)(s.current,e)||S(e),()=>{i.current.unsubscribe(),a.current.abort()})),[e,S,s]),[m,O]}},198:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return p}));var r=n(34),a=n(4),i=n(815),o=n.n(i),s=n(49),c=n(58),l=n.n(c);const u=(e,t)=>{const n=null!=t?t:((e,t)=>{const n=t.diff(e,"days");return n<=1&&!e.isSame(t)?2:n})(l()(e[0]),l()(e[1])),r=Object(s.niceTimeFormatByDay)(n);return Object(s.timeFormatter)(r)},d=(e=100)=>{const[t,n]=Object(a.useState)({width:0,height:0}),i=Object(a.useMemo)((()=>Object(r.throttle)(e,n)),[e]),{ref:s}=o()({onResize:i});return{ref:s,...t}},p=(e,t,n,r)=>{Object(a.useEffect)((()=>{!async function(){const a=await(null==e?void 0:e.getVariation(t,n));a&&r(a)}()}),[e,t,n,r])}},217:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(4),a=n(116);const i=()=>{const[e,t]=Object(r.useState)({isAuthenticated:null,hasEncryptionKey:null,hasIndexManage:null,hasIndexRead:null,hasIndexWrite:null,hasIndexUpdateDelete:null,hasIndexMaintenance:null,hasKibanaCRUD:!1,hasKibanaREAD:!1}),{detectionEnginePrivileges:n,kibanaSecuritySolutionsPrivileges:{crud:i,read:o}}=Object(a.a)();return Object(r.useEffect)((()=>{null!=n.error&&t({isAuthenticated:!1,hasEncryptionKey:!1,hasIndexManage:!1,hasIndexRead:!1,hasIndexWrite:!1,hasIndexUpdateDelete:!1,hasIndexMaintenance:!1,hasKibanaCRUD:i,hasKibanaREAD:o})}),[n.error,i,o]),Object(r.useEffect)((()=>{if(null!=n.result){const e=n.result;if(null!=e.index&&Object.keys(e.index).length>0){const n=Object.keys(e.index)[0];t({isAuthenticated:e.is_authenticated,hasEncryptionKey:e.has_encryption_key,hasIndexManage:e.index[n].manage&&e.cluster.manage,hasIndexMaintenance:e.index[n].maintenance,hasIndexRead:e.index[n].read,hasIndexWrite:e.index[n].create||e.index[n].create_doc||e.index[n].index||e.index[n].write,hasIndexUpdateDelete:e.index[n].write,hasKibanaCRUD:i,hasKibanaREAD:o})}}}),[n.result,i,o]),{loading:n.loading,...e}}},218:function(e,t,n){e.exports=n(27)(258)},219:function(e,t,n){e.exports=n(27)(1546)},230:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(4),a=n(83),i=n(84),o=n(193),s=n(404),c=n(217);const l=()=>{const[e,t]=Object(r.useState)(!0),[n,l]=Object(r.useState)({signalIndexExists:null,signalIndexName:null,signalIndexMappingOutdated:null,createDeSignalIndex:null}),{addError:u}=Object(i.a)(),{hasIndexRead:d}=Object(c.a)();return Object(r.useEffect)((()=>{let e=!0;const n=new AbortController,r=async()=>{try{t(!0);const r=await Object(o.h)({signal:n.signal});e&&null!=r&&l({signalIndexExists:!0,signalIndexName:r.name,signalIndexMappingOutdated:r.index_mapping_outdated,createDeSignalIndex:i})}catch(t){e&&(l({signalIndexExists:!1,signalIndexName:null,signalIndexMappingOutdated:null,createDeSignalIndex:i}),Object(a.t)(t)&&404!==t.body.status_code&&u(t,{title:s.c}))}e&&t(!1)},i=async()=>{let c=!1;try{t(!0),await Object(o.d)({signal:n.signal}),e&&(c=!0,r())}catch(t){e&&(Object(a.t)(t)&&409===t.body.status_code?r():(l({signalIndexExists:!1,signalIndexName:null,signalIndexMappingOutdated:null,createDeSignalIndex:i}),u(t,{title:s.d})))}e&&!c&&t(!1)};return d?r():t(!1),()=>{e=!1,n.abort()}}),[u,d]),{loading:e,...n}}},231:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(4),a=n(154);const i=()=>{const{startTransaction:e}=Object(a.a)();return{startTracking:Object(r.useCallback)((({name:t,spanName:n="fetch"})=>{const r=e({name:t,type:"http-request",options:{managed:!1}}),a=null==r?void 0:r.startSpan(n,"http-request",{blocking:!0});return{endTracking:e=>{null==r||r.addLabels({result:e}),null==a||a.end()}}}),[e])}}},252:function(e,t,n){"use strict";var r=function(e){return function(e){return!!e&&"object"==typeof e}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===a}(e)}(e)},a="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function i(e,t){return!1!==t.clone&&t.isMergeableObject(e)?l((n=e,Array.isArray(n)?[]:{}),e,t):e;var n}function o(e,t,n){return e.concat(t).map((function(e){return i(e,n)}))}function s(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(t){return e.propertyIsEnumerable(t)})):[]}(e))}function c(e,t){try{return t in e}catch(e){return!1}}function l(e,t,n){(n=n||{}).arrayMerge=n.arrayMerge||o,n.isMergeableObject=n.isMergeableObject||r,n.cloneUnlessOtherwiseSpecified=i;var a=Array.isArray(t);return a===Array.isArray(e)?a?n.arrayMerge(e,t,n):function(e,t,n){var r={};return n.isMergeableObject(e)&&s(e).forEach((function(t){r[t]=i(e[t],n)})),s(t).forEach((function(a){(function(e,t){return c(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))})(e,a)||(c(e,a)&&n.isMergeableObject(t[a])?r[a]=function(e,t){if(!t.customMerge)return l;var n=t.customMerge(e);return"function"==typeof n?n:l}(a,n)(e[a],t[a],n):r[a]=i(t[a],n))})),r}(e,t,n):i(t,n)}l.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,n){return l(e,n,t)}),{})};var u=l;e.exports=u},259:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>e.isPlatinumOrTrialLicense},269:function(e,t,n){var r=n(330),a=n(331);e.exports=function(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=r(e.prototype),i=e.apply(n,t);return a(i)?i:n}}},270:function(e,t,n){e.exports=n(27)(286)},281:function(e,t,n){"use strict";n.d(t,"b",(function(){return S})),n.d(t,"a",(function(){return w}));var r=n(169),a=n(78),i=n(4),o=n(90),s=n(77),c=n(98),l=n(145),u=n(34),d=n(107),p=n(526),b=n(286);var f=n(268),m=n.n(f),h=n(267),g=n(183);var v=n(136),y=n(86),O=n(104),j=n(81),E=n(37);const x=({search:e,urlKey:t})=>Object(h.d)(Object(h.e)(e),t),S=()=>{Object(r.c)(),(()=>{const e=Object(a.useDispatch)(),{filterManager:t,savedQueries:n}=Object(s.k)().services.data.query,u=Object(i.useMemo)((()=>c.d.globalFiltersQuerySelector()),[]),d=Object(a.useSelector)(u),p=Object(i.useCallback)((t=>{null!=t&&e(l.b.setFilterQuery({id:o.a.global,query:t.query,language:t.language}))}),[e]),b=Object(i.useCallback)((n=>{null!=n?(t.setFilters(n),e(l.b.setSearchBarFilter({id:o.a.global,filters:n}))):(t.setAppFilters(d),e(l.b.setSearchBarFilter({id:o.a.global,filters:t.getFilters()})))}),[t,e,d]),f=Object(i.useCallback)((r=>{null!=r&&""!==r&&n.getSavedQuery(r).then((n=>{const r=n.attributes.filters||[],a=n.attributes.query;t.setFilters(r),e(l.b.setSearchBarFilter({id:o.a.global,filters:r})),e(l.b.setFilterQuery({id:o.a.global,...a})),e(l.b.setSavedQuery({id:o.a.global,savedQuery:n}))}))}),[e,t,n]);Object(r.b)(w.appQuery,p),Object(r.b)(w.filters,b),Object(r.b)(w.savedQuery,f)})(),(()=>{const e=Object(a.useDispatch)(),t=Object(d.a)("socTrendsEnabled"),n=Object(i.useCallback)((n=>((e,t,n)=>{if(null!=e){const r={linkTo:Object(u.get)("global.linkTo",e)},a=Object(u.get)("global.timerange.kind",e),i={linkTo:Object(u.get)("timeline.linkTo",e)},s=Object(u.get)("timeline.timerange.kind",e),c={linkTo:Object(u.get)("socTrends.linkTo",e)},d=Object(u.get)("socTrends.timerange.kind",e);if(n&&(Object(u.isEmpty)(c.linkTo)?t(l.b.removeLinkTo([o.a.global,o.a.socTrends])):t(l.b.addLinkTo([o.a.global,o.a.socTrends]))),Object(u.isEmpty)(r.linkTo)?(t(l.b.removeLinkTo([o.a.global,o.a.timeline])),n&&t(l.b.removeLinkTo([o.a.global,o.a.socTrends]))):(t(l.b.addLinkTo([o.a.global,o.a.timeline])),n&&t(l.b.addLinkTo([o.a.global,o.a.socTrends]))),Object(u.isEmpty)(i.linkTo)?t(l.b.removeLinkTo([o.a.global,o.a.timeline])):t(l.b.addLinkTo([o.a.global,o.a.timeline])),s){if("absolute"===s){const n=Object(p.a)(Object(u.get)("timeline.timerange",e));t(l.b.setAbsoluteRangeDatePicker({...n,id:o.a.timeline}))}if("relative"===s){const n=Object(p.a)(Object(u.get)("timeline.timerange",e));n.from=Object(b.c)(n.fromStr),n.to=Object(b.c)(n.toStr,{roundUp:!0}),t(l.b.setRelativeRangeDatePicker({...n,id:o.a.timeline}))}}if(a){if("absolute"===a){const n=Object(p.a)(Object(u.get)("global.timerange",e));t(l.b.setAbsoluteRangeDatePicker({...n,id:o.a.global}))}if("relative"===a){const n=Object(p.a)(Object(u.get)("global.timerange",e));n.from=Object(b.c)(n.fromStr),n.to=Object(b.c)(n.toStr,{roundUp:!0}),t(l.b.setRelativeRangeDatePicker({...n,id:o.a.global}))}}if(n&&d){if("absolute"===d){const n=Object(p.a)(Object(u.get)("socTrends.timerange",e));t(l.b.setAbsoluteRangeDatePicker({...n,id:o.a.socTrends}))}if("relative"===d){const n=Object(p.a)(Object(u.get)("socTrends.timerange",e));n.from=Object(b.c)(n.fromStr),n.to=Object(b.c)(n.toStr,{roundUp:!0}),t(l.b.setRelativeRangeDatePicker({...n,id:o.a.socTrends}))}}}})(n,e,t)),[e,t]);Object(r.b)(w.timerange,n)})(),(()=>{const[{pageName:e}]=Object(g.a)(),t=Object(a.useDispatch)(),n=m()(e),r=Object(i.useMemo)((()=>c.d.inputsSelector()),[]),s=Object(a.useSelector)(r),{timerange:u}=s.global,{timerange:d}=s.timeline;Object(i.useEffect)((()=>{((e,t)=>e&&t&&t!==e&&Object(h.f)(e))(e,n)&&("relative"===d.kind&&t(l.b.setRelativeRangeDatePicker({...d,from:Object(b.c)(d.fromStr),to:Object(b.c)(d.toStr,{roundUp:!0}),id:o.a.timeline})),"relative"===u.kind&&t(l.b.setRelativeRangeDatePicker({...u,from:Object(b.c)(u.fromStr),to:Object(b.c)(u.toStr,{roundUp:!0}),id:o.a.global})))}),[e,n,t,d,u])})(),(()=>{const e=Object(a.useDispatch)(),t=Object(i.useCallback)((t=>{null!=t&&""!==t.id&&Object(v.h)({activeTimelineTab:t.activeTab,duplicate:!1,graphEventId:t.graphEventId,timelineId:t.id,openTimeline:t.isOpen,updateIsLoading:t=>e(y.a.updateIsLoading(t)),updateTimeline:Object(v.b)(e)})}),[e]);Object(r.b)(w.timeline,t)})(),(()=>{const e=Object(r.d)(w.timeline),t=Object(i.useMemo)((()=>y.b.getTimelineByIdSelector()),[]),{activeTab:n,graphEventId:a,show:o,savedObjectId:s}=Object(j.b)((e=>{var n;return null!==(n=t(e,O.d.active))&&void 0!==n?n:{}}));Object(i.useEffect)((()=>{e(null!=s?{id:s,isOpen:o,activeTab:n,graphEventId:null!=a?a:""}:null)}),[n,a,s,o,e])})(),(()=>{var e;const t=Object(i.useMemo)((()=>y.b.getTimelineByIdSelector()),[]),n=Object(j.b)((e=>t(e,O.d.active))),{search:r}=Object(E.useLocation)(),o=m()(r),s=null!==(e=null==n?void 0:n.savedObjectId)&&void 0!==e?e:"",c=Object(a.useDispatch)(),[l,u]=Object(i.useMemo)((()=>{const e=x({urlKey:w.timeline,search:null!=o?o:""}),t=x({urlKey:w.timeline,search:r});if(null!=e&&null!=t){let n=null,r=null;try{n=Object(h.a)(t)}catch(e){}try{r=Object(h.a)(e)}catch(e){}return[r,n]}return[null,null]}),[o,r]),d=null==l?void 0:l.id,{id:p,activeTab:b,graphEventId:f}=u||{};Object(i.useEffect)((()=>{p&&p!==d&&p!==s&&Object(v.h)({activeTimelineTab:null!=b?b:O.f.query,duplicate:!1,graphEventId:f,timelineId:p,openTimeline:!0,updateIsLoading:e=>c(y.a.updateIsLoading(e)),updateTimeline:Object(v.b)(c)})}),[s,c,d,p,b,f])})()};let w;!function(e){e.appQuery="query",e.filters="filters",e.savedQuery="savedQuery",e.sourcerer="sourcerer",e.timeline="timeline",e.timerange="timerange"}(w||(w={}))},285:function(e,t,n){"use strict";n.d(t,"a",(function(){return v})),n.d(t,"b",(function(){return y}));var r=n(4),a=n(78),i=n(294),o=n.n(i),s=n(34),c=n(50),l=n(42),u=n(77),d=n(84),p=n(177),b=n(431),f=n(95),m=n(317),h=n(231),g=n(1);const v=o()(((e,t)=>t.reduce(((e,t)=>(null==e.browserFields[t.category]&&(e.browserFields[t.category]={}),null==e.browserFields[t.category].fields&&(e.browserFields[t.category].fields={}),e.browserFields[t.category].fields[t.name]=t,e.indexFields.push(Object(s.pick)(["name","searchable","type","aggregatable","esTypes","subType"],t)),e)),{browserFields:{},indexFields:[]})),((e,t)=>e[0]===t[0]&&e[1].length===t[1].length)),y=()=>{const{data:e}=Object(u.k)().services,t=Object(r.useRef)({}),n=Object(r.useRef)({}),i=Object(a.useDispatch)(),{addError:o,addWarning:y}=Object(d.a)(),{startTracking:O}=Object(h.a)(),j=Object(r.useCallback)((({id:e,loading:t})=>{i(p.a.setDataViewLoading({id:e,loading:t}))}),[i]),E=Object(r.useCallback)((({dataViewId:r,scopeId:a=f.SourcererScopeName.default,needToBeInit:u=!1,cleanCache:d=!1,skipScopeUpdate:h=!1})=>{const E=()=>{var e;null===(e=n.current[r])||void 0===e||e.unsubscribe(),n.current=Object(s.omit)(r,n.current),t.current=Object(s.omit)(r,t.current)};return n.current[r]&&n.current[r].unsubscribe(),t.current[r]&&t.current[r].abort(),(async()=>{t.current={...t.current,[r]:new AbortController},j({id:r,loading:!0});const{endTracking:s}=O({name:`${g.B} indexFieldsSearch`});if(u){const e=await Object(m.a)(r,t.current[r].signal);i(p.a.setDataView(e))}return new Promise((f=>{const m=e.search.search({dataViewId:r,onlyCheckIfIndicesExist:!1},{abortSignal:t.current[r].signal,strategy:"indexFields"}).subscribe({next:async e=>{if(Object(l.isCompleteResponse)(e)){s("success");const t=e.indicesExist.sort().join();u&&a&&!h&&i(p.a.setSelectedDataView({id:a,selectedDataViewId:r,selectedPatterns:e.indicesExist})),d&&v.clear();const n=v(t,e.indexFields);i(p.a.setDataView({...n,id:r,loading:!1,runtimeMappings:e.runtimeMappings}))}else Object(l.isErrorResponse)(e)&&(s("invalid"),j({id:r,loading:!1}),y(b.a));E(),f()},error:e=>{if(s("error"),e.message===c.DELETED_SECURITY_SOLUTION_DATA_VIEW)return location.reload();j({id:r,loading:!1}),o(e,{title:b.b}),E(),f()}});n.current={...n.current,[r]:m}}))})()}),[o,y,e.search,i,j,O]);return Object(r.useEffect)((()=>()=>{Object.values(n.current).forEach((e=>e.unsubscribe())),Object.values(t.current).forEach((e=>e.abort()))}),[]),{indexFieldsSearch:E}}},286:function(e,t,n){"use strict";n.d(t,"c",(function(){return O})),n.d(t,"b",(function(){return j})),n.d(t,"a",(function(){return E}));var r=n(52),a=n.n(r),i=n(32),o=n(34),s=n(4),c=n.n(s),l=n(78),u=n(92),d=n.n(u),p=n(935),b=n(1),f=n(86),m=n(77),h=n(184),g=n(90),v=n(149);const y=c.a.memo((({duration:e,end:t,fromStr:n,id:r,isLoading:a,kqlQuery:l,policy:u,queries:d,setDuration:p,showUpdateButton:f=!0,start:h,startAutoReload:g,stopAutoReload:v,timelineId:y,toStr:j,updateReduxTime:E,disabled:x,width:S="restricted",compressed:w=!1})=>{const[I,k]=Object(s.useState)([]),_=Object(s.useCallback)((({start:e,end:n})=>{const a=e.includes("now")||n.includes("now"),{kqlHaveBeenUpdated:i}=E({end:n,id:r,isInvalid:!1,isQuickSelection:a,kql:l,start:e,timelineId:y}),o=O(e),s=a?O(n,{roundUp:!0}):O(n);!d||i||a&&(h!==o||t!==s)||M(d)}),[t,r,l,d,h,y,E]),T=Object(s.useCallback)((({isPaused:t,refreshInterval:a})=>{const i=null!=n&&n.includes("now")||null!=j&&j.includes("now");e!==a&&p({id:r,duration:a}),t&&"interval"===u?v({id:r}):t||"manual"!==u||g({id:r}),d&&!t&&(!i||i&&"now"!==j)&&M(d)}),[n,j,e,u,p,r,v,g,d]),M=e=>{e.forEach((e=>e.refetch&&e.refetch()))},P=Object(s.useCallback)((({start:e,end:t,isInvalid:n})=>{const a=e.includes("now")||t.includes("now");if(!n){E({end:t,id:r,isInvalid:n,isQuickSelection:a,kql:l,start:e,timelineId:y});const i=[{start:e,end:t},...Object(o.take)(9,I.filter((n=>!(n.start===e&&n.end===t))))];k(i)}}),[E,r,l,y,I]),D=null!=j?j:new Date(t).toISOString(),C=null!=n?n:new Date(h).toISOString(),[N]=Object(m.q)(b.gb),A=Object(o.isEmpty)(N)?[]:N.map((({from:e,to:t,display:n})=>({start:e,end:t,label:n})));return c.a.createElement(i.EuiSuperDatePicker,{commonlyUsedRanges:A,end:D,isLoading:a,isPaused:"manual"===u,onRefresh:_,onRefreshChange:T,onTimeChange:P,recentlyUsedRanges:I,refreshInterval:e,showUpdateButton:f,start:C,isDisabled:x,width:S,compressed:w})}),((e,t)=>e.duration===t.duration&&e.end===t.end&&e.fromStr===t.fromStr&&e.id===t.id&&e.isLoading===t.isLoading&&e.policy===t.policy&&e.setDuration===t.setDuration&&e.start===t.start&&e.startAutoReload===t.startAutoReload&&e.stopAutoReload===t.stopAutoReload&&e.timelineId===t.timelineId&&e.disabled===t.disabled&&e.toStr===t.toStr&&e.updateReduxTime===t.updateReduxTime&&d()(e.kqlQuery,t.kqlQuery)&&d()(e.queries,t.queries))),O=(e,t)=>{const n=a.a.parse(e,t);return null!=n&&n.isValid()?n.toISOString():""},j=e=>({end:t,id:n,isQuickSelection:r,kql:a,start:i,timelineId:o})=>{const s=O(i);let c=O(t,{roundUp:!0});var l;return r?e(t===i?h.b.setAbsoluteRangeDatePicker({id:n,fromStr:i,toStr:t,from:s,to:c}):h.b.setRelativeRangeDatePicker({id:n,fromStr:i,toStr:t,from:s,to:c})):(c=O(t),e(h.b.setAbsoluteRangeDatePicker({id:n,from:O(i),to:O(t)}))),null!=o&&e(f.a.updateRange({id:o,start:s,end:c})),a&&a.refetch?{kqlHaveBeenUpdated:null!==(l=a.refetch(e))&&void 0!==l&&l}:{kqlHaveBeenUpdated:!1}};y.displayName="SuperDatePickerComponent";const E=Object(l.connect)((()=>{const e=Object(v.a)(),t=Object(v.b)(),n=Object(v.c)(),r=Object(v.d)(),a=Object(v.e)(),i=Object(v.f)(),s=Object(v.g)(),c=Object(v.h)(),l=Object(v.i)(),u=Object(v.j)();return(d,{id:b})=>{const f=Object(o.getOr)({},`inputs.${b}`,d);return{duration:e(f),end:t(f),fromStr:n(f),kind:a(f),policy:s(f),start:l(f),toStr:u(f),isLoading:!1,...Object(p.c)(f)&&(b===g.a.timeline||b===g.a.global)&&{isLoading:r(f),kqlQuery:i(f),queries:c(d,b)}}}}),(e=>({startAutoReload:({id:t})=>e(h.b.startAutoReload({id:t})),stopAutoReload:({id:t})=>e(h.b.stopAutoReload({id:t})),setDuration:({id:t,duration:n})=>e(h.b.setDuration({id:t,duration:n})),updateReduxTime:j(e)})))(y)},287:function(e,t,n){"use strict";n.d(t,"c",(function(){return p})),n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d}));var r,a=n(4),i=n(53),o=(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},r(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s="html",c="svg",l=function(e,t){var n,r,a,i={};if(e===s)a=document.createElement("div");else{if(e!==c)throw new Error('Invalid element type "'+e+'" for createPortalNode: must be "html" or "svg".');a=document.createElementNS("http://www.w3.org/2000/svg","g")}if(t&&"object"==typeof t)for(var o=0,l=Object.entries(t.attributes);o<l.length;o++){var u=l[o],d=u[0],p=u[1];a.setAttribute(d,p)}var b={element:a,elementType:e,setPortalProps:function(e){i=e},getInitialPortalProps:function(){return i},mount:function(t,a){if(a!==r){if(b.unmount(),t!==n&&!function(e,t){if(t===s)return e instanceof HTMLElement;if(t===c)return e instanceof SVGElement;throw new Error('Unrecognized element type "'+t+'" for validateElementType.')}(t,e))throw new Error('Invalid element type for portal: "'+e+'" portalNodes must be used with '+e+" elements, but OutPortal is within <"+t.tagName+">.");t.replaceChild(b.element,a),n=t,r=a}},unmount:function(e){e&&e!==r||n&&r&&(n.replaceChild(r,b.element),n=void 0,r=void 0)}};return b},u=function(e){function t(t){var n=e.call(this,t)||this;return n.addPropsChannel=function(){Object.assign(n.props.node,{setPortalProps:function(e){n.setState({nodeProps:e})}})},n.state={nodeProps:n.props.node.getInitialPortalProps()},n}return o(t,e),t.prototype.componentDidMount=function(){this.addPropsChannel()},t.prototype.componentDidUpdate=function(){this.addPropsChannel()},t.prototype.render=function(){var e=this,t=this.props,n=t.children,r=t.node;return i.createPortal(a.Children.map(n,(function(t){return a.isValidElement(t)?a.cloneElement(t,e.state.nodeProps):t})),r.element)},t}(a.PureComponent),d=function(e){function t(t){var n=e.call(this,t)||this;return n.placeholderNode=a.createRef(),n.passPropsThroughPortal(),n}return o(t,e),t.prototype.passPropsThroughPortal=function(){var e=Object.assign({},this.props,{node:void 0});this.props.node.setPortalProps(e)},t.prototype.componentDidMount=function(){var e=this.props.node;this.currentPortalNode=e;var t=this.placeholderNode.current,n=t.parentNode;e.mount(n,t),this.passPropsThroughPortal()},t.prototype.componentDidUpdate=function(){var e=this.props.node;this.currentPortalNode&&e!==this.currentPortalNode&&(this.currentPortalNode.unmount(this.placeholderNode.current),this.currentPortalNode=e);var t=this.placeholderNode.current,n=t.parentNode;e.mount(n,t),this.passPropsThroughPortal()},t.prototype.componentWillUnmount=function(){this.props.node.unmount(this.placeholderNode.current)},t.prototype.render=function(){return a.createElement("div",{ref:this.placeholderNode})},t}(a.PureComponent),p=l.bind(null,s);l.bind(null,c)},317:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var r=n(77),a=n(1);const i=async({body:e,signal:t})=>r.b.get().http.fetch(a.tc,{method:"POST",body:JSON.stringify(e),signal:t}),o=async(e,t)=>r.b.get().http.fetch(a.tc,{method:"GET",query:{dataViewId:e},asSystemRequest:!0,signal:t})},329:function(e,t,n){var r=n(433),a=n(750),i=n(751),o=n(437),s=n(770),c=n(441),l=n(771),u=n(443),d=n(444),p=n(447),b=Math.max;e.exports=function(e,t,n,f,m,h,g,v){var y=2&t;if(!y&&"function"!=typeof e)throw new TypeError("Expected a function");var O=f?f.length:0;if(O||(t&=-97,f=m=void 0),g=void 0===g?g:b(p(g),0),v=void 0===v?v:p(v),O-=m?m.length:0,64&t){var j=f,E=m;f=m=void 0}var x=y?void 0:c(e),S=[e,t,n,f,m,j,E,h,g,v];if(x&&l(S,x),e=S[0],t=S[1],n=S[2],f=S[3],m=S[4],!(v=S[9]=void 0===S[9]?y?0:e.length:b(S[9]-O,0))&&24&t&&(t&=-25),t&&1!=t)w=8==t||16==t?i(e,t,v):32!=t&&33!=t||m.length?o.apply(void 0,S):s(e,t,n,f);else var w=a(e,t,n);return d((x?r:u)(w,S),e,t)}},330:function(e,t,n){e.exports=n(27)(3416)},331:function(e,t,n){e.exports=n(27)(336)},332:function(e,t,n){var r=n(330),a=n(333);function i(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}i.prototype=r(a.prototype),i.prototype.constructor=i,e.exports=i},333:function(e,t){e.exports=function(){}},334:function(e,t,n){e.exports=n(27)(257)},335:function(e,t,n){e.exports=n(27)(3406)},336:function(e,t,n){e.exports=n(27)(1503)},337:function(e,t){var n="__lodash_placeholder__";e.exports=function(e,t){for(var r=-1,a=e.length,i=0,o=[];++r<a;){var s=e[r];s!==t&&s!==n||(e[r]=n,o[i++]=r)}return o}},343:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(4),a=n.n(r),i=n(35),o=n(32),s=n(164);const c=a.a.memo((()=>a.a.createElement(s.a,null,a.a.createElement(o.EuiPageTemplate_Deprecated,{template:"centeredContent"},a.a.createElement(o.EuiEmptyPrompt,{"data-test-subj":"notFoundPage",iconColor:"default",iconType:"logoElastic",title:a.a.createElement("p",null,a.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.pages.fourohfour.pageNotFoundDescription",defaultMessage:"Page not found"}))})))));c.displayName="NotFoundPage"},366:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>a(e)&&i(e)&&o(e)&&s(e),a=({capabilities:e})=>e.canGetDatafeeds&&e.canStartStopDatafeed&&e.canUpdateDatafeed&&e.canPreviewDatafeed,i=({capabilities:e})=>e.canCreateJob&&e.canGetJobs&&e.canUpdateJob&&e.canDeleteJob&&e.canOpenJob&&e.canCloseJob&&e.canForecastJob,o=({capabilities:e})=>e.canGetFilters&&e.canCreateFilter&&e.canDeleteFilter,s=({capabilities:e})=>e.canCreateCalendar&&e.canGetCalendars&&e.canDeleteCalendar},378:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(4),a=n(34),i=n(1),o=n(366),s=n(259),c=n(84),l=n(77),u=n(507);const d=["siem_cloudtrail","siem_packetbeat","security_auth","security_linux_v3","security_network","security_windows_v3"],p=(e,t,n)=>{const r=t.find((t=>t.id===e));return void 0!==r?{moduleId:r.moduleId,defaultIndexPattern:r.defaultIndexPattern,isCompatible:n.includes(r.moduleId),isElasticJob:!0}:{moduleId:"",defaultIndexPattern:"",isCompatible:!0,isElasticJob:!1}};var b=n(120),f=n(389),m=n(534);const h=()=>{const[e,t]=Object(r.useState)([]),[n,h]=Object(r.useState)(!0),g=Object(b.a)(),[v]=Object(l.q)(i.S),y=Object(l.j)(),{addError:O}=Object(c.a)(),j=Object(r.useRef)(a.noop),E=Object(o.a)(g),x=Object(s.a)(g);return Object(r.useEffect)((()=>{let e=!0;const n=new AbortController;async function r(){if(h(!0),E&&x)try{const[r,a,i]=await Promise.all([Object(m.a)({http:y,signal:n.signal}),Object(u.b)({signal:n.signal}),Object(u.a)({indexPatternName:v,signal:n.signal})]),o=((e,t,n)=>{const r=n.map((e=>e.id)),a=((e,t)=>e.filter((e=>d.includes(e.id))).map((e=>[...e.jobs.map((n=>((e,t,n)=>({datafeedId:"",datafeedIndices:[],datafeedState:"",hasDatafeed:!1,isSingleMetricViewerJob:!1,jobState:"closed",memory_status:"",processed_record_count:0,id:t.id,description:t.config.description,groups:[...t.config.groups].sort(),defaultIndexPattern:e.defaultIndexPattern,moduleId:e.id,isCompatible:n,isInstalled:!1,isElasticJob:!0,awaitingNodeAssignment:!1,jobTags:{},bucketSpanSeconds:900}))(e,n,t.includes(e.id))))])).flat())(t,r),i=((e,t,n)=>e.filter((({groups:e})=>e.includes("siem")||e.includes("security"))).map((e=>({...e,...p(e.id,t,n),isInstalled:!0}))))(e,a,r);return((e,t)=>{const n=e.map((e=>e.id));return[...e,...t.filter((e=>!n.includes(e.id)))].sort(((e,t)=>e.id.localeCompare(t.id)))})(i,a)})(r,a,i);e&&t(o)}catch(t){e&&O(t,{title:f.a})}e&&h(!1)}return r(),j.current=r,()=>{e=!1,n.abort()}}),[E,x,v,O,y]),{isLicensed:x,isMlAdmin:E,jobs:e,loading:n,refetch:j.current}}},384:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"g",(function(){return l})),n.d(t,"h",(function(){return u})),n.d(t,"c",(function(){return d}));var r=n(0);const a=r.i18n.translate("xpack.securitySolution.notes.addNoteButtonLabel",{defaultMessage:"Add Note"}),i=r.i18n.translate("xpack.securitySolution.notes.noteLabel",{defaultMessage:"Note"}),o=r.i18n.translate("xpack.securitySolution.notes.notesTitle",{defaultMessage:"Notes"}),s=r.i18n.translate("xpack.securitySolution.notes.search.FilterByUserOrNotePlaceholder",{defaultMessage:"Filter by User or Note"}),c=r.i18n.translate("xpack.securitySolution.notes.cancelButtonLabel",{defaultMessage:"Cancel"}),l=r.i18n.translate("xpack.securitySolution.notes.youAreEditingANoteScreenReaderOnly",{defaultMessage:"You are editing a note. Click Add Note when finished, or press escape to cancel."}),u=e=>r.i18n.translate("xpack.securitySolution.notes.youAreViewingNotesScreenReaderOnly",{values:{row:e},defaultMessage:"You are viewing notes for the event in row {row}. Press the up arrow key when finished to return to the event."}),d=r.i18n.translate("xpack.securitySolution.notes.createdByLabel",{defaultMessage:"Created by"})},389:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=n(0).i18n.translate("xpack.securitySolution.components.mlPopup.hooks.errors.siemJobFetchFailureTitle",{defaultMessage:"Security job fetch failure"})},400:function(e,t,n){e.exports=n(27)(171)},408:function(e,t,n){(function(t){var n;n=function(){"use strict";var e=function(){if("undefined"!=typeof Map)return Map;function e(e,t){var n=-1;return e.some((function(e,r){return e[0]===t&&(n=r,!0)})),n}return function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(t){var n=e(this.__entries__,t),r=this.__entries__[n];return r&&r[1]},t.prototype.set=function(t,n){var r=e(this.__entries__,t);~r?this.__entries__[r][1]=n:this.__entries__.push([t,n])},t.prototype.delete=function(t){var n=this.__entries__,r=e(n,t);~r&&n.splice(r,1)},t.prototype.has=function(t){return!!~e(this.__entries__,t)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(e,t){void 0===t&&(t=null);for(var n=0,r=this.__entries__;n<r.length;n++){var a=r[n];e.call(t,a[1],a[0])}},t}()}(),n="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,r=void 0!==t&&t.Math===Math?t:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),a="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(r):function(e){return setTimeout((function(){return e(Date.now())}),1e3/60)},i=["top","right","bottom","left","width","height","size","weight"],o="undefined"!=typeof MutationObserver,s=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(e,t){var n=!1,r=!1,i=0;function o(){n&&(n=!1,e()),r&&c()}function s(){a(o)}function c(){var e=Date.now();if(n){if(e-i<2)return;r=!0}else n=!0,r=!1,setTimeout(s,20);i=e}return c}(this.refresh.bind(this))}return e.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},e.prototype.removeObserver=function(e){var t=this.observers_,n=t.indexOf(e);~n&&t.splice(n,1),!t.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},e.prototype.updateObservers_=function(){var e=this.observers_.filter((function(e){return e.gatherActive(),e.hasActive()}));return e.forEach((function(e){return e.broadcastActive()})),e.length>0},e.prototype.connect_=function(){n&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),o?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){n&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(e){var t=e.propertyName,n=void 0===t?"":t;i.some((function(e){return!!~n.indexOf(e)}))&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),c=function(e,t){for(var n=0,r=Object.keys(t);n<r.length;n++){var a=r[n];Object.defineProperty(e,a,{value:t[a],enumerable:!1,writable:!1,configurable:!0})}return e},l=function(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView||r},u=m(0,0,0,0);function d(e){return parseFloat(e)||0}function p(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.reduce((function(t,n){return t+d(e["border-"+n+"-width"])}),0)}var b="undefined"!=typeof SVGGraphicsElement?function(e){return e instanceof l(e).SVGGraphicsElement}:function(e){return e instanceof l(e).SVGElement&&"function"==typeof e.getBBox};function f(e){return n?b(e)?function(e){var t=e.getBBox();return m(0,0,t.width,t.height)}(e):function(e){var t=e.clientWidth,n=e.clientHeight;if(!t&&!n)return u;var r=l(e).getComputedStyle(e),a=function(e){for(var t={},n=0,r=["top","right","bottom","left"];n<r.length;n++){var a=r[n],i=e["padding-"+a];t[a]=d(i)}return t}(r),i=a.left+a.right,o=a.top+a.bottom,s=d(r.width),c=d(r.height);if("border-box"===r.boxSizing&&(Math.round(s+i)!==t&&(s-=p(r,"left","right")+i),Math.round(c+o)!==n&&(c-=p(r,"top","bottom")+o)),!function(e){return e===l(e).document.documentElement}(e)){var b=Math.round(s+i)-t,f=Math.round(c+o)-n;1!==Math.abs(b)&&(s-=b),1!==Math.abs(f)&&(c-=f)}return m(a.left,a.top,s,c)}(e):u}function m(e,t,n,r){return{x:e,y:t,width:n,height:r}}var h=function(){function e(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=m(0,0,0,0),this.target=e}return e.prototype.isActive=function(){var e=f(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},e}(),g=function(e,t){var n,r,a,i,o,s,l,u=(r=(n=t).x,a=n.y,i=n.width,o=n.height,s="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,l=Object.create(s.prototype),c(l,{x:r,y:a,width:i,height:o,top:a,right:r+i,bottom:o+a,left:r}),l);c(this,{target:e,contentRect:u})},v=function(){function t(t,n,r){if(this.activeObservations_=[],this.observations_=new e,"function"!=typeof t)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=t,this.controller_=n,this.callbackCtx_=r}return t.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof l(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new h(e)),this.controller_.addObserver(this),this.controller_.refresh())}},t.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof l(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},t.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},t.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach((function(t){t.isActive()&&e.activeObservations_.push(t)}))},t.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map((function(e){return new g(e.target,e.broadcastRect())}));this.callback_.call(e,t,e),this.clearActive()}},t.prototype.clearActive=function(){this.activeObservations_.splice(0)},t.prototype.hasActive=function(){return this.activeObservations_.length>0},t}(),y="undefined"!=typeof WeakMap?new WeakMap:new e,O=function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=s.getInstance(),r=new v(t,n,this);y.set(this,r)};return["observe","unobserve","disconnect"].forEach((function(e){O.prototype[e]=function(){var t;return(t=y.get(this))[e].apply(t,arguments)}})),void 0!==r.ResizeObserver?r.ResizeObserver:O},e.exports=n()}).call(this,n(400))},431:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n(0);const a=r.i18n.translate("xpack.securitySolution.beatFields.errorSearchDescription",{defaultMessage:"An error has occurred on getting beat fields"}),i=r.i18n.translate("xpack.securitySolution.beatFields.failSearchDescription",{defaultMessage:"Failed to run search on beat fields"})},432:function(e,t,n){var r=n(746),a=n(747);e.exports=function(e,t,n){return r(a,e,t,n)}},433:function(e,t,n){var r=n(434),a=n(435),i=a?function(e,t){return a.set(e,t),e}:r;e.exports=i},434:function(e,t,n){e.exports=n(27)(1542)},435:function(e,t,n){var r=n(749),a=r&&new r;e.exports=a},436:function(e,t,n){e.exports=n(27)(3432)},437:function(e,t,n){var r=n(438),a=n(439),i=n(752),o=n(269),s=n(440),c=n(446),l=n(769),u=n(337),d=n(270);e.exports=function e(t,n,p,b,f,m,h,g,v,y){var O=128&n,j=1&n,E=2&n,x=24&n,S=512&n,w=E?void 0:o(t);return function I(){for(var k=arguments.length,_=Array(k),T=k;T--;)_[T]=arguments[T];if(x)var M=c(I),P=i(_,M);if(b&&(_=r(_,b,f,x)),m&&(_=a(_,m,h,x)),k-=P,x&&k<y){var D=u(_,M);return s(t,n,e,I.placeholder,p,_,D,g,v,y-k)}var C=j?p:this,N=E?C[t]:t;return k=_.length,g?_=l(_,g):S&&k>1&&_.reverse(),O&&v<k&&(_.length=v),this&&this!==d&&this instanceof I&&(N=w||o(N)),N.apply(C,_)}}},438:function(e,t){var n=Math.max;e.exports=function(e,t,r,a){for(var i=-1,o=e.length,s=r.length,c=-1,l=t.length,u=n(o-s,0),d=Array(l+u),p=!a;++c<l;)d[c]=t[c];for(;++i<s;)(p||i<o)&&(d[r[i]]=e[i]);for(;u--;)d[c++]=e[i++];return d}},439:function(e,t){var n=Math.max;e.exports=function(e,t,r,a){for(var i=-1,o=e.length,s=-1,c=r.length,l=-1,u=t.length,d=n(o-c,0),p=Array(d+u),b=!a;++i<d;)p[i]=e[i];for(var f=i;++l<u;)p[f+l]=t[l];for(;++s<c;)(b||i<o)&&(p[f+r[s]]=e[i++]);return p}},440:function(e,t,n){var r=n(753),a=n(443),i=n(444);e.exports=function(e,t,n,o,s,c,l,u,d,p){var b=8&t;t|=b?32:64,4&(t&=~(b?64:32))||(t&=-4);var f=[e,t,s,b?c:void 0,b?l:void 0,b?void 0:c,b?void 0:l,u,d,p],m=n.apply(void 0,f);return r(e)&&a(m,f),m.placeholder=o,i(m,e,t)}},441:function(e,t,n){var r=n(435),a=n(754),i=r?function(e){return r.get(e)}:a;e.exports=i},442:function(e,t,n){var r=n(330),a=n(333);function i(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}i.prototype=r(a.prototype),i.prototype.constructor=i,e.exports=i},443:function(e,t,n){var r=n(433),a=n(759)(r);e.exports=a},444:function(e,t,n){var r=n(760),a=n(761),i=n(762),o=n(763);e.exports=function(e,t,n){var s=t+"";return i(e,a(s,o(r(s),n)))}},445:function(e,t,n){e.exports=n(27)(3400)},446:function(e,t){e.exports=function(e){return e.placeholder}},447:function(e,t,n){e.exports=n(27)(3384)},448:function(e,t,n){e.exports=n(27)(3399)},449:function(e,t,n){e.exports=n(27)(888)},450:function(e,t,n){e.exports=n(27)(3065)},451:function(e,t,n){var r=n(331);e.exports=function(e){return e==e&&!r(e)}},452:function(e,t){e.exports=function(e,t){return function(n){return null!=n&&n[e]===t&&(void 0!==t||e in Object(n))}}},453:function(e,t,n){e.exports=n(27)(1155)},454:function(e,t,n){e.exports=n(27)(3394)},455:function(e,t,n){var r=n(808),a=n(453),i=n(449),o=n(336),s=n(331),c=n(219);e.exports=function(e,t,n,l){if(!s(e))return e;for(var u=-1,d=(t=a(t,e)).length,p=d-1,b=e;null!=b&&++u<d;){var f=c(t[u]),m=n;if("prototype"==f&&i(b))throw new Error("Illegal access of function prototype");if(u!=p){var h=hasOwnProperty.call(b,f)?b[f]:void 0;void 0===(m=l?l(h,f,b):void 0)&&(m=s(h)?h:o(t[u+1])?[]:{})}r(b,f,m),b=b[f]}return e}},456:function(e,t,n){e.exports=n(27)(3572)},507:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return p})),n.d(t,"d",(function(){return b})),n.d(t,"e",(function(){return f}));const r=n(0).i18n.translate("xpack.securitySolution.components.ml.api.errors.statusCodeFailureTitle",{defaultMessage:"Status Code:"});var a=n(324),i=n(34);const o=e=>Object(i.has)("error.msg",e)&&Object(i.has)("error.response",e)&&Object(i.has)("error.statusCode",e),s=e=>Object(i.has)("error.error.reason",e),c=e=>{try{return JSON.stringify(JSON.parse(e),null,2)}catch(t){return e}};var l=n(77);const u=async({indexPatternName:e,signal:t})=>l.b.get().http.fetch(`/api/ml/modules/recognize/${e}`,{method:"GET",asSystemRequest:!0,signal:t}),d=async({moduleId:e="",signal:t})=>l.b.get().http.fetch(`/api/ml/modules/get_module/${e}`,{method:"GET",asSystemRequest:!0,signal:t}),p=async({configTemplate:e,indexPatternName:t="auditbeat-*",jobIdErrorFilter:n=[],groups:i=["security"],prefix:u=""})=>{const d=await l.b.get().http.fetch(`/api/ml/modules/setup/${e}`,{method:"POST",body:JSON.stringify({prefix:u,groups:i,indexPatternName:t,startDatafeed:!1,useDedicatedIndex:!0,applyToAllSpaces:!0}),asSystemRequest:!0});return((e,t=[])=>{const n=[...e.jobs.reduce(((e,n)=>{if(null!=n.error&&t.includes(n.id)){if(o(n))return[...e,n.error.msg,c(n.error.response),`${r} ${n.error.statusCode}`];if(s(n))return[n.error.error.reason]}return e}),[]),...e.datafeeds.reduce(((e,n)=>null!=n.error&&t.includes(n.id.substr("datafeed-".length))?[...e,n.error.msg,c(n.error.response),`${r} ${n.error.statusCode}`]:e),[])];if(n.length>0)throw new a.c(n)})(d,n),d},b=async({datafeedIds:e,start:t=0})=>{const n=await l.b.get().http.fetch("/api/ml/jobs/force_start_datafeeds",{method:"POST",body:JSON.stringify({datafeedIds:e,...0!==t&&{start:t}}),asSystemRequest:!0});return((e,t)=>{const n=t.reduce(((t,n)=>{const a=e[n];return o(a)?[...t,a.error.msg,c(a.error.response),`${r} ${a.error.statusCode}`]:s(a)?[a.error.error.reason]:t}),[]);if(n.length>0)throw new a.c(n)})(n,e),n},f=async({datafeedIds:e})=>{const t=await l.b.get().http.fetch("/api/ml/jobs/stop_datafeeds",{method:"POST",body:JSON.stringify({datafeedIds:e}),asSystemRequest:!0}),n="datafeed-";return[t,await l.b.get().http.fetch("/api/ml/jobs/close_jobs",{method:"POST",body:JSON.stringify({jobIds:e.map((e=>e.startsWith(n)?e.substring(n.length):e))}),asSystemRequest:!0})]}},518:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(4),a=n(84),i=n(17),o=n(507),s=n(0);const c=s.i18n.translate("xpack.securitySolution.components.mlPopup.hooks.errors.startJobFailureTitle",{defaultMessage:"Start job failure"}),l=s.i18n.translate("xpack.securitySolution.components.mlPopup.hooks.errors.stopJobFailureTitle",{defaultMessage:"Stop job failure"}),u=s.i18n.translate("xpack.securitySolution.components.mlPopup.hooks.errors.createJobFailureTitle",{defaultMessage:"Create job failure"}),d=()=>{const{addError:e}=Object(a.a)(),[t,n]=Object(r.useState)(!1);return{enableDatafeed:Object(r.useCallback)((async(t,r,a)=>{if(p(t,a),!t.isInstalled){n(!0);try{await Object(o.c)({configTemplate:t.moduleId,indexPatternName:t.defaultIndexPattern,jobIdErrorFilter:[t.id],groups:t.groups}),n(!1)}catch(t){return e(t,{title:u}),void n(!1)}}const s=new Date,d=s.setDate(s.getDate()-14);if(n(!0),a){const n=Math.max(r,d);try{await Object(o.d)({datafeedIds:[`datafeed-${t.id}`],start:n})}catch(t){Object(i.e)(i.a.COUNT,i.b.JOB_ENABLE_FAILURE),e(t,{title:c})}}else try{await Object(o.e)({datafeedIds:[`datafeed-${t.id}`]})}catch(t){Object(i.e)(i.a.COUNT,i.b.JOB_DISABLE_FAILURE),e(t,{title:l})}n(!1)}),[e]),isLoading:t}},p=(e,t)=>{Object(i.e)(i.a.COUNT,e.isElasticJob?t?i.b.SIEM_JOB_ENABLED:i.b.SIEM_JOB_DISABLED:t?i.b.CUSTOM_JOB_ENABLED:i.b.CUSTOM_JOB_DISABLED)}},528:function(e,t,n){t.set=t.assoc=t.assocPath=n(745),t.setWith=n(809)},534:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=async({http:e,jobIds:t,signal:n})=>e.fetch("/api/ml/jobs/jobs_summary",{method:"POST",body:JSON.stringify({jobIds:null!=t?t:[]}),asSystemRequest:!0,signal:n})},549:function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return h}));var r=n(32),a=n(43),i=n.n(a),o=n(4),s=n.n(o),c=n(33),l=n.n(c),u=n(117),d=n.n(u),p=n(384),b=n(160);p.f;const f=l.a.h3.withConfig({displayName:"TitleText",componentId:"sc-wz9mhv-0"})(["margin:0 5px;cursor:default;user-select:none;"]);f.displayName="TitleText",s.a.memo((({noteIds:e})=>s.a.createElement(r.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},s.a.createElement(r.EuiFlexItem,{grow:!1},s.a.createElement(r.EuiIcon,{color:"text",size:"l",type:"editorComment"})),s.a.createElement(r.EuiFlexItem,{grow:!1},s.a.createElement(r.EuiTitle,{size:"s"},s.a.createElement(f,null,p.e))),s.a.createElement(r.EuiFlexItem,{grow:!1},s.a.createElement(b.c,{color:"hollow"},e.length))))).displayName="NotesCount";const m=({newNote:e})=>({created:i.a.utc().toDate(),id:d.a.v4(),lastEdit:null,note:e,saveObjectId:null,user:"elastic",version:null}),h=({associateNote:e,newNote:t,updateNewNote:n,updateNote:r})=>{const a=m({newNote:t});r(a),e(a.id),n("")}},683:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(4),a=n(0),i=n(78),o=n(98),s=n(81),c=n(94),l=n(95),u=n(317),d=n(177),p=n(285),b=n(84);const f=()=>{const{indicesExist:e}=Object(c.d)(l.SourcererScopeName.detections),{indexFieldsSearch:t}=Object(p.b)(),n=Object(i.useDispatch)(),{addError:f}=Object(b.a)(),m=Object(r.useRef)(new AbortController),h=Object(r.useMemo)((()=>o.e.defaultDataViewSelector()),[]),g=Object(r.useMemo)((()=>o.e.signalIndexNameSelector()),[]),v=Object(s.a)(g),y=Object(s.a)(h),O=Object(r.useMemo)((()=>!y.title.includes(`${v}`)),[y.title,v]),j=Object(r.useMemo)((()=>!e&&!O),[e,O]),E=Object(r.useCallback)((()=>{null!==v&&(m.current.abort(),(async()=>{m.current=new AbortController;try{const e=await Object(u.b)({body:{patternList:y.title.split(",")},signal:m.current.signal});null!==v&&e.defaultDataView.patternList.includes(v)&&(t({dataViewId:e.defaultDataView.id}),n(d.a.setSourcererDataViews(e)))}catch(e){f(e,{title:a.i18n.translate("xpack.securitySolution.sourcerer.error.title",{defaultMessage:"Error updating Security Data View"}),toastMessage:a.i18n.translate("xpack.securitySolution.sourcerer.error.toastMessage",{defaultMessage:"Refresh the page"})})}})())}),[f,y.title,n,t,v]);return{...j?{pollForSignalIndex:E}:{},signalIndexNeedsInit:O}}},699:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return f}));var r=n(4),a=n.n(r),i=n(68);const o={capabilities:Object(i.getDefaultMlCapabilities)(),isPlatinumOrTrialLicense:!1,mlFeatureEnabledInSpace:!1,upgradeInProgress:!1};var s=n(84),c=n(77),l=n(129);const u=Object(l.d)((async({http:e,signal:t})=>e.fetch("/api/ml/ml_capabilities",{method:"GET",asSystemRequest:!0,signal:t}))),d=n(0).i18n.translate("xpack.securitySolution.components.ml.permissions.errors.machineLearningPermissionsFailureTitle",{defaultMessage:"Machine learning permissions failure"}),p={...o,capabilitiesFetched:!1},b=a.a.createContext(p);b.displayName="MlCapabilitiesContext";const f=a.a.memo((({children:e})=>{const[t,n]=Object(r.useState)(p),i=Object(c.j)(),{addError:o}=Object(s.a)(),{start:f,result:m,error:h}=Object(l.a)(u);return Object(r.useEffect)((()=>{f({http:i})}),[i,f]),Object(r.useEffect)((()=>{m&&n({...m,capabilitiesFetched:!0})}),[m]),Object(r.useEffect)((()=>{h&&o(h,{title:d})}),[o,h]),a.a.createElement(b.Provider,{value:t},e)}));f.displayName="MlCapabilitiesProvider"},745:function(e,t,n){var r=n(432)("set",n(806));r.placeholder=n(456),e.exports=r},746:function(e,t,n){e.exports=n(27)(3570)},747:function(e,t,n){e.exports={ary:n(748),assign:n(772),clone:n(773),curry:n(774),forEach:n(445),isArray:n(218),isError:n(775),isFunction:n(449),isWeakMap:n(778),iteratee:n(780),keys:n(798),rearg:n(799),toInteger:n(447),toPath:n(801)}},748:function(e,t,n){var r=n(329);e.exports=function(e,t,n){return t=n?void 0:t,t=e&&null==t?e.length:t,r(e,128,void 0,void 0,void 0,void 0,t)}},749:function(e,t,n){e.exports=n(27)(3111)},750:function(e,t,n){var r=n(269),a=n(270);e.exports=function(e,t,n){var i=1&t,o=r(e);return function t(){var r=this&&this!==a&&this instanceof t?o:e;return r.apply(i?n:this,arguments)}}},751:function(e,t,n){var r=n(436),a=n(269),i=n(437),o=n(440),s=n(446),c=n(337),l=n(270);e.exports=function(e,t,n){var u=a(e);return function a(){for(var d=arguments.length,p=Array(d),b=d,f=s(a);b--;)p[b]=arguments[b];var m=d<3&&p[0]!==f&&p[d-1]!==f?[]:c(p,f);if((d-=m.length)<n)return o(e,t,i,a.placeholder,void 0,p,m,void 0,void 0,n-d);var h=this&&this!==l&&this instanceof a?u:e;return r(h,this,p)}}},752:function(e,t){e.exports=function(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}},753:function(e,t,n){var r=n(332),a=n(441),i=n(755),o=n(757);e.exports=function(e){var t=i(e),n=o[t];if("function"!=typeof n||!(t in r.prototype))return!1;if(e===n)return!0;var s=a(n);return!!s&&e===s[0]}},754:function(e,t){e.exports=function(){}},755:function(e,t,n){var r=n(756),a=Object.prototype.hasOwnProperty;e.exports=function(e){for(var t=e.name+"",n=r[t],i=a.call(r,t)?n.length:0;i--;){var o=n[i],s=o.func;if(null==s||s==e)return o.name}return t}},756:function(e,t){e.exports={}},757:function(e,t,n){var r=n(332),a=n(442),i=n(333),o=n(218),s=n(334),c=n(758),l=Object.prototype.hasOwnProperty;function u(e){if(s(e)&&!o(e)&&!(e instanceof r)){if(e instanceof a)return e;if(l.call(e,"__wrapped__"))return c(e)}return new a(e)}u.prototype=i.prototype,u.prototype.constructor=u,e.exports=u},758:function(e,t,n){var r=n(332),a=n(442),i=n(335);e.exports=function(e){if(e instanceof r)return e.clone();var t=new a(e.__wrapped__,e.__chain__);return t.__actions__=i(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}},759:function(e,t,n){e.exports=n(27)(3436)},760:function(e,t){var n=/\{\n\/\* \[wrapped with (.+)\] \*/,r=/,? & /;e.exports=function(e){var t=e.match(n);return t?t[1].split(r):[]}},761:function(e,t){var n=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;e.exports=function(e,t){var r=t.length;if(!r)return e;var a=r-1;return t[a]=(r>1?"& ":"")+t[a],t=t.join(r>2?", ":" "),e.replace(n,"{\n/* [wrapped with "+t+"] */\n")}},762:function(e,t,n){e.exports=n(27)(3433)},763:function(e,t,n){var r=n(445),a=n(764),i=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]];e.exports=function(e,t){return r(i,(function(n){var r="_."+n[0];t&n[1]&&!a(e,r)&&e.push(r)})),e.sort()}},764:function(e,t,n){var r=n(765);e.exports=function(e,t){return!(null==e||!e.length)&&r(e,t,0)>-1}},765:function(e,t,n){var r=n(766),a=n(767),i=n(768);e.exports=function(e,t,n){return t==t?i(e,t,n):r(e,a,n)}},766:function(e,t){e.exports=function(e,t,n,r){for(var a=e.length,i=n+(r?1:-1);r?i--:++i<a;)if(t(e[i],i,e))return i;return-1}},767:function(e,t){e.exports=function(e){return e!=e}},768:function(e,t){e.exports=function(e,t,n){for(var r=n-1,a=e.length;++r<a;)if(e[r]===t)return r;return-1}},769:function(e,t,n){var r=n(335),a=n(336),i=Math.min;e.exports=function(e,t){for(var n=e.length,o=i(t.length,n),s=r(e);o--;){var c=t[o];e[o]=a(c,n)?s[c]:void 0}return e}},770:function(e,t,n){var r=n(436),a=n(269),i=n(270);e.exports=function(e,t,n,o){var s=1&t,c=a(e);return function t(){for(var a=-1,l=arguments.length,u=-1,d=o.length,p=Array(d+l),b=this&&this!==i&&this instanceof t?c:e;++u<d;)p[u]=o[u];for(;l--;)p[u++]=arguments[++a];return r(b,s?n:this,p)}}},771:function(e,t,n){var r=n(438),a=n(439),i=n(337),o="__lodash_placeholder__",s=Math.min;e.exports=function(e,t){var n=e[1],c=t[1],l=n|c,u=l<131,d=128==c&&8==n||128==c&&256==n&&e[7].length<=t[8]||384==c&&t[7].length<=t[8]&&8==n;if(!u&&!d)return e;1&c&&(e[2]=t[2],l|=1&n?0:4);var p=t[3];if(p){var b=e[3];e[3]=b?r(b,p,t[4]):p,e[4]=b?i(e[3],o):t[4]}return(p=t[5])&&(b=e[5],e[5]=b?a(b,p,t[6]):p,e[6]=b?i(e[5],o):t[6]),(p=t[7])&&(e[7]=p),128&c&&(e[8]=null==e[8]?t[8]:s(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=l,e}},772:function(e,t,n){e.exports=n(27)(3401)},773:function(e,t,n){var r=n(448);e.exports=function(e){return r(e,4)}},774:function(e,t,n){var r=n(329);function a(e,t,n){var i=r(e,8,void 0,void 0,void 0,void 0,void 0,t=n?void 0:t);return i.placeholder=a.placeholder,i}a.placeholder={},e.exports=a},775:function(e,t,n){var r=n(776),a=n(334),i=n(777);e.exports=function(e){if(!a(e))return!1;var t=r(e);return"[object Error]"==t||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!i(e)}},776:function(e,t,n){e.exports=n(27)(332)},777:function(e,t,n){e.exports=n(27)(3426)},778:function(e,t,n){var r=n(779),a=n(334);e.exports=function(e){return a(e)&&"[object WeakMap]"==r(e)}},779:function(e,t,n){e.exports=n(27)(760)},780:function(e,t,n){var r=n(448),a=n(781);e.exports=function(e){return a("function"==typeof e?e:r(e,1))}},781:function(e,t,n){var r=n(782),a=n(787),i=n(434),o=n(218),s=n(794);e.exports=function(e){return"function"==typeof e?e:null==e?i:"object"==typeof e?o(e)?a(e[0],e[1]):r(e):s(e)}},782:function(e,t,n){var r=n(783),a=n(785),i=n(452);e.exports=function(e){var t=a(e);return 1==t.length&&t[0][2]?i(t[0][0],t[0][1]):function(n){return n===e||r(n,e,t)}}},783:function(e,t,n){var r=n(784),a=n(450);e.exports=function(e,t,n,i){var o=n.length,s=o,c=!i;if(null==e)return!s;for(e=Object(e);o--;){var l=n[o];if(c&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++o<s;){var u=(l=n[o])[0],d=e[u],p=l[1];if(c&&l[2]){if(void 0===d&&!(u in e))return!1}else{var b=new r;if(i)var f=i(d,p,u,e,t,b);if(!(void 0===f?a(p,d,3,i,b):f))return!1}}return!0}},784:function(e,t,n){e.exports=n(27)(1493)},785:function(e,t,n){var r=n(451),a=n(786);e.exports=function(e){for(var t=a(e),n=t.length;n--;){var i=t[n],o=e[i];t[n]=[i,o,r(o)]}return t}},786:function(e,t,n){e.exports=n(27)(1136)},787:function(e,t,n){var r=n(450),a=n(788),i=n(789),o=n(454),s=n(451),c=n(452),l=n(219);e.exports=function(e,t){return o(e)&&s(t)?c(l(e),t):function(n){var o=a(n,e);return void 0===o&&o===t?i(n,e):r(t,o,3)}}},788:function(e,t,n){e.exports=n(27)(1812)},789:function(e,t,n){var r=n(790),a=n(791);e.exports=function(e,t){return null!=e&&a(e,t,r)}},790:function(e,t){e.exports=function(e,t){return null!=e&&t in Object(e)}},791:function(e,t,n){var r=n(453),a=n(792),i=n(218),o=n(336),s=n(793),c=n(219);e.exports=function(e,t,n){for(var l=-1,u=(t=r(t,e)).length,d=!1;++l<u;){var p=c(t[l]);if(!(d=null!=e&&n(e,p)))break;e=e[p]}return d||++l!=u?d:!!(u=null==e?0:e.length)&&s(u)&&o(p,u)&&(i(e)||a(e))}},792:function(e,t,n){e.exports=n(27)(1502)},793:function(e,t,n){e.exports=n(27)(1505)},794:function(e,t,n){var r=n(795),a=n(796),i=n(454),o=n(219);e.exports=function(e){return i(e)?r(o(e)):a(e)}},795:function(e,t){e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},796:function(e,t,n){var r=n(797);e.exports=function(e){return function(t){return r(t,e)}}},797:function(e,t,n){e.exports=n(27)(1544)},798:function(e,t,n){e.exports=n(27)(3106)},799:function(e,t,n){var r=n(329),a=n(800)((function(e,t){return r(e,256,void 0,void 0,void 0,t)}));e.exports=a},800:function(e,t,n){e.exports=n(27)(3427)},801:function(e,t,n){var r=n(802),a=n(335),i=n(218),o=n(803),s=n(804),c=n(219),l=n(805);e.exports=function(e){return i(e)?r(e,c):o(e)?[e]:a(s(l(e)))}},802:function(e,t,n){e.exports=n(27)(1545)},803:function(e,t,n){e.exports=n(27)(770)},804:function(e,t,n){e.exports=n(27)(3395)},805:function(e,t,n){e.exports=n(27)(3397)},806:function(e,t,n){e.exports=n(807)},807:function(e,t,n){var r=n(455);e.exports=function(e,t,n){return null==e?e:r(e,t,n)}},808:function(e,t,n){e.exports=n(27)(1547)},809:function(e,t,n){var r=n(432)("setWith",n(810));r.placeholder=n(456),e.exports=r},810:function(e,t,n){e.exports=n(811)},811:function(e,t,n){var r=n(455);e.exports=function(e,t,n,a){return a="function"==typeof a?a:void 0,null==e?e:r(e,t,n,a)}},815:function(e,t,n){"use strict";var r,a=(r=n(408))&&"object"==typeof r&&"default"in r?r.default:r,i=n(4);function o(){return o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o.apply(this,arguments)}e.exports=function(e){var t=void 0===e?{}:e,n=t.ref,r=t.onResize,s=i.useRef(null);n=n||s;var c=i.useState({width:void 0,height:void 0}),l=c[0],u=c[1],d=i.useRef({width:void 0,height:void 0});return i.useEffect((function(){if("object"==typeof n&&null!==n&&n.current instanceof Element){var e=n.current,t=new a((function(e){if(Array.isArray(e)&&e.length){var t=e[0],n=Math.round(t.contentRect.width),a=Math.round(t.contentRect.height);if(d.current.width!==n||d.current.height!==a){var i={width:n,height:a};r?r(i):(d.current.width=n,d.current.height=a,u(i))}}}));return t.observe(e),function(){return t.unobserve(e)}}}),[n,r]),i.useMemo((function(){return o({ref:n},l)}),[n,l?l.width:null,l?l.height:null])}},825:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(33),a=n.n(r),i=n(4),o=n.n(i),s=n(32),c=n(157);const l=a()(s.EuiSwitch).withConfig({displayName:"StaticSwitch",componentId:"sc-1xsgv9-0"})([".euiSwitch__thumb,.euiSwitch__icon{transition:none;}"]);l.displayName="StaticSwitch";const u=({job:e,isSecurityJobsLoading:t,onJobStateChange:n})=>{const[r,a]=Object(i.useState)(!1),u=Object(i.useCallback)((async t=>{a(!0),await n(e,e.latestTimestampMs||0,t.target.checked),a(!1)}),[e,a,n]);return o.a.createElement(s.EuiFlexGroup,{justifyContent:"spaceAround"},o.a.createElement(s.EuiFlexItem,{grow:!1},t||r||Object(c.b)(e.jobState,e.datafeedState)?o.a.createElement(s.EuiLoadingSpinner,{size:"m","data-test-subj":"job-switch-loader"}):o.a.createElement(l,{"data-test-subj":"job-switch",disabled:Object(c.a)(e.jobState,e.datafeedState),checked:Object(c.c)(e.jobState,e.datafeedState),onChange:u,showLabel:!1,label:""})))};u.displayName="JobSwitchComponent";const d=o.a.memo(u);d.displayName="JobSwitch"},94:function(e,t,n){"use strict";n.d(t,"c",(function(){return E})),n.d(t,"d",(function(){return x})),n.d(t,"a",(function(){return w})),n.d(t,"b",(function(){return k}));var r=n(4),a=n(78),i=n(0),o=n(37),s=n(177),c=n(95),l=n(165),u=n(86),d=n(1),p=n(104),b=n(81),f=n(741),m=n(84),h=n(317),g=n(285),v=n(175),y=n(169),O=n(281),j=n(742);const E=(e=c.SourcererScopeName.default)=>{const t=Object(a.useDispatch)(),n=Object(r.useRef)(new AbortController),o=Object(r.useRef)(!0),d=Object(r.useRef)(!0),{loading:v,isSignalIndexExists:j,signalIndexName:E}=Object(l.c)(),x=Object(y.d)(O.a.sourcerer),S=Object(r.useMemo)((()=>s.d.getSourcererDataViewsSelector()),[]),{defaultDataView:w,signalIndexName:I}=Object(b.a)((e=>S(e))),{addError:k,addWarning:_}=Object(m.a)();Object(r.useEffect)((()=>{null!=w.error&&_({title:i.i18n.translate("xpack.securitySolution.sourcerer.permissions.title",{defaultMessage:"Write role required to generate data"}),text:i.i18n.translate("xpack.securitySolution.sourcerer.permissions.toastMessage",{defaultMessage:"Users with write permission need to access the Elastic Security app to initialize the app source data."})})}),[_,w.error]);const T=Object(r.useMemo)((()=>u.b.getTimelineByIdSelector()),[]),M=Object(b.a)((e=>T(e,p.d.active))),P=Object(r.useMemo)((()=>s.d.getSourcererScopeSelector()),[]),{sourcererScope:{selectedDataViewId:D,selectedPatterns:C,missingPatterns:N}}=Object(b.a)((t=>P(t,e))),{selectedDataView:A,sourcererScope:{selectedDataViewId:R,selectedPatterns:F,missingPatterns:L}}=Object(b.a)((e=>P(e,c.SourcererScopeName.timeline))),{indexFieldsSearch:U}=Object(g.b)(),q=Object(r.useCallback)((n=>{null!=n?Object.keys(n).forEach((r=>{var a,i,o,l;r===c.SourcererScopeName.default&&e===c.SourcererScopeName.detections||t(s.a.setSelectedDataView({id:r,selectedDataViewId:null!==(a=null===(i=n[r])||void 0===i?void 0:i.id)&&void 0!==a?a:null,selectedPatterns:null!==(o=null===(l=n[r])||void 0===l?void 0:l.selectedPatterns)&&void 0!==o?o:[]}))})):D&&x({[c.SourcererScopeName.default]:{id:D,selectedPatterns:C}})}),[t,D,e,C,x]);Object(y.b)(O.a.sourcerer,q);const J=Object(r.useRef)([]);Object(r.useEffect)((()=>{[...new Set([D,R])].forEach(((e,t)=>{if(null!=e&&e.length>0&&!J.current.includes(e)){J.current=[...J.current,e];const n=0===t?c.SourcererScopeName.default:c.SourcererScopeName.timeline,r=e===D?0===C.length&&0===N.length:R===e&&0===L.length&&0===(null==A?void 0:A.patternList.length);U({dataViewId:e,scopeId:n,needToBeInit:r,...r&&n===c.SourcererScopeName.timeline?{skipScopeUpdate:F.length>0}:{}})}}))}),[U,N.length,D,C.length,R,L.length,A,F.length]),Object(r.useEffect)((()=>{!v&&null!=E&&null==I&&(null==M||null==M.savedObjectId)&&o.current&&w.id.length>0?(o.current=!1,t(s.a.setSelectedDataView({id:c.SourcererScopeName.timeline,selectedDataViewId:w.id,selectedPatterns:Object(f.b)(w,c.SourcererScopeName.timeline,E,!0)}))):null!=I&&(null==M||null==M.savedObjectId)&&o.current&&w.id.length>0&&(o.current=!1,t(s.a.setSelectedDataView({id:c.SourcererScopeName.timeline,selectedDataViewId:w.id,selectedPatterns:Object(f.b)(w,c.SourcererScopeName.timeline,I,!0)})))}),[M,w,t,v,E,I]);const B=Object(r.useCallback)((e=>{-1===w.title.indexOf(e)&&(n.current.abort(),(async r=>{n.current=new AbortController,t(s.a.setSourcererScopeLoading({loading:!0}));try{const a=await Object(h.b)({body:{patternList:r},signal:n.current.signal});a.defaultDataView.patternList.includes(e)&&U({dataViewId:a.defaultDataView.id}),t(s.a.setSourcererDataViews(a)),t(s.a.setSourcererScopeLoading({loading:!1}))}catch(e){k(e,{title:i.i18n.translate("xpack.securitySolution.sourcerer.error.title",{defaultMessage:"Error updating Security Data View"}),toastMessage:i.i18n.translate("xpack.securitySolution.sourcerer.error.toastMessage",{defaultMessage:"Refresh the page"})}),t(s.a.setSourcererScopeLoading({loading:!1}))}})([...w.title.split(","),e]))}),[w.title,t,U,k]),V=Object(r.useCallback)((()=>{!v&&null!=E&&null==I&&w.id.length>0&&(B(E),t(s.a.setSignalIndexName({signalIndexName:E})))}),[w.id.length,t,v,E,I,B]);Object(r.useEffect)((()=>{V()}),[E]),Object(r.useEffect)((()=>{e===c.SourcererScopeName.detections&&j&&null!=E&&d.current&&w.id.length>0?(d.current=!1,t(s.a.setSelectedDataView({id:c.SourcererScopeName.detections,selectedDataViewId:w.id,selectedPatterns:Object(f.b)(w,c.SourcererScopeName.detections,E,!0)}))):e===c.SourcererScopeName.detections&&null!=I&&o.current&&w.id.length>0&&(d.current=!1,s.a.setSelectedDataView({id:c.SourcererScopeName.detections,selectedDataViewId:w.id,selectedPatterns:Object(f.b)(w,c.SourcererScopeName.detections,I,!0)}))}),[w,t,j,e,E,I])},x=(e=c.SourcererScopeName.default)=>{const{getDataViewsSelector:t,getSourcererDataViewSelector:n,getScopeSelector:a}=Object(r.useMemo)((()=>({getDataViewsSelector:s.d.getSourcererDataViewsSelector(),getSourcererDataViewSelector:s.d.sourcererDataViewSelector(),getScopeSelector:s.d.scopeIdSelector()})),[]),{signalIndexName:i,selectedDataView:o,sourcererScope:{missingPatterns:l,selectedPatterns:u,loading:d}}=Object(b.a)((r=>{const i=a(r,e);return{...t(r),selectedDataView:n(r,i.selectedDataViewId),sourcererScope:i}})),p=Object(r.useMemo)((()=>Object(j.b)(u)),[u]),[m,h]=Object(r.useState)([]),[g,y]=Object(v.b)(m),O=Object(r.useMemo)((()=>{var e;return{...y,runtimeMappings:{},title:"",id:null!==(e=null==o?void 0:o.id)&&void 0!==e?e:null,loading:g,patternList:y.indexes,indexFields:y.indexPatterns.fields}}),[y,g,o]);Object(r.useEffect)((()=>{null==o||l.length>0?h(p):h([])}),[l,o,p]);const E=Object(r.useMemo)((()=>null==o||l.length>0?O:o),[O,l.length,o]),x=Object(r.useMemo)((()=>!(!d&&!E.loading)||Object(f.a)({scopeId:e,signalIndexName:i,patternList:E.patternList})),[d,e,i,E.loading,E.patternList]);return Object(r.useMemo)((()=>({browserFields:E.browserFields,dataViewId:E.id,indexPattern:{fields:E.indexFields,title:p.join(",")},indicesExist:x,loading:d||E.loading,runtimeMappings:E.runtimeMappings,patternList:E.title.split(","),selectedPatterns:p,...m.length>0?{activePatterns:E.patternList}:{}})),[E,p,x,d,m.length])},S=[d.d,`${d.lc}/id/:id`,`${d.H}/:detailName`],w=e=>null==Object(o.matchPath)(e,{path:S,strict:!1})?c.SourcererScopeName.default:c.SourcererScopeName.detections,I=[d.d,`${d.lc}/id/:id`,d.Hb,d.Gc,d.Sb,d.Zb],k=e=>null!=Object(o.matchPath)(e,{path:I,strict:!1})}}]);