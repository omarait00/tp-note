/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.cases_bundle_jsonpfunction=window.cases_bundle_jsonpfunction||[]).push([[1],{115:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=a(2).i18n.translate("xpack.cases.markdownEditor.plugins.lens.visualizationButtonLabel",{defaultMessage:"Visualization"})},118:function(e,t,a){"use strict";a.d(t,"b",(function(){return G})),a.d(t,"a",(function(){return K}));var n=a(44),s=a.n(n),i=a(1),l=a.n(i),r=a(15),o=a(13);const c=({disableLinks:e,href:t,target:a,children:n,...s})=>l.a.createElement(o.EuiToolTip,{content:t},l.a.createElement(o.EuiLink,{href:e?void 0:t,"data-test-subj":"markdown-link",rel:"nofollow",target:"_blank"},n));c.displayName="MarkdownLink";const u=Object(i.memo)(c);var d=a(140),p=a(5),m=a(83),g=a(2),b=a(77),h=a(23),v=a(37),f=a.n(v),E=a(42);const O=l.a.createContext(null),j=f()(o.EuiFlexGroup).withConfig({displayName:"ModalContainer",componentId:"sc-4107jc-0"})(["width:",";height:100%;.euiModalBody{min-height:300px;}"],(({theme:e})=>e.eui.euiBreakpoints.m));var k=a(9),y=a.n(k),P=a(8),S=a(88);class saved_objects_finder_SavedObjectFinderUi extends l.a.Component{constructor(e){super(e),y()(this,"isComponentMounted",!1),y()(this,"debouncedFetch",Object(P.debounce)((async e=>{const t=this.getSavedObjectMetaDataMap(),a=Object.values(t).map((e=>e.includeFields||[])).reduce(((e,t)=>e.concat(t)),["title","name"]),n=this.props.uiSettings.get(S.LISTING_LIMIT_SETTING),s=await this.props.savedObjects.client.find({type:Object.keys(t),fields:[...new Set(a)],search:e?`${e}*`:void 0,page:1,perPage:n,searchFields:["title^3","description"],defaultSearchOperator:"AND"});s.savedObjects=s.savedObjects.filter((e=>{const a=t[e.type];return!a.showSavedObject||a.showSavedObject(e)})),this.isComponentMounted&&e===this.state.query&&this.setState({isFetchingItems:!1,page:0,items:s.savedObjects.map((e=>{const{attributes:{name:t,title:a},id:n,type:s}=e,i="string"==typeof a?a:"";return{title:i,name:t&&"string"==typeof t?t:i,id:n,type:s,savedObject:e}}))})}),300)),y()(this,"getPageOfItems",(()=>{const e=this.state.items.slice(),{sortDirection:t}=this.state;!t&&this.state.query||e.sort((({title:e},{title:a})=>{let n=1;return"desc"===t&&(n=-1),n*(e||"").toLowerCase().localeCompare((a||"").toLowerCase())}));const a=this.state.page*this.state.perPage,n=a+this.state.perPage;return e.filter((e=>0===this.state.filteredTypes.length||this.state.filteredTypes.includes(e.type))).slice(a,n)})),y()(this,"fetchItems",(()=>{this.setState({isFetchingItems:!0},this.debouncedFetch.bind(null,this.state.query))})),this.state={items:[],isFetchingItems:!1,page:0,perPage:e.initialPageSize||e.fixedPageSize||10,query:"",filterOpen:!1,filteredTypes:[],sortOpen:!1}}componentWillUnmount(){this.isComponentMounted=!1,this.debouncedFetch.cancel()}componentDidMount(){this.isComponentMounted=!0,this.fetchItems()}render(){return l.a.createElement(l.a.Fragment,null,this.renderSearchBar(),this.renderListing())}getSavedObjectMetaDataMap(){return this.props.savedObjectMetaData.reduce(((e,t)=>({...e,[t.type]:t})),{})}getPageCount(){return Math.ceil((0===this.state.filteredTypes.length?this.state.items.length:this.state.items.filter((e=>0===this.state.filteredTypes.length||this.state.filteredTypes.includes(e.type))).length)/this.state.perPage)}getAvailableSavedObjectMetaData(){const e=new Set;return this.state.items.forEach((t=>{e.add(t.type)})),this.props.savedObjectMetaData.filter((t=>e.has(t.type)))}getSortOptions(){const e=[l.a.createElement(o.EuiContextMenuItem,{key:"asc",icon:"asc"===this.state.sortDirection||""===this.state.query&&"desc"!==this.state.sortDirection?"check":"empty",onClick:()=>{this.setState({sortDirection:"asc"})}},g.i18n.translate("xpack.cases.markdownEditor.plugins.lens.savedObjects.finder.sortAsc",{defaultMessage:"Ascending"})),l.a.createElement(o.EuiContextMenuItem,{key:"desc",icon:"desc"===this.state.sortDirection?"check":"empty",onClick:()=>{this.setState({sortDirection:"desc"})}},g.i18n.translate("xpack.cases.markdownEditor.plugins.lens.savedObjects.finder.sortDesc",{defaultMessage:"Descending"}))];return this.state.query&&e.push(l.a.createElement(o.EuiContextMenuItem,{key:"auto",icon:this.state.sortDirection?"empty":"check",onClick:()=>{this.setState({sortDirection:void 0})}},g.i18n.translate("xpack.cases.markdownEditor.plugins.lens.savedObjects.finder.sortAuto",{defaultMessage:"Best match"}))),e}renderSearchBar(){const e=this.getAvailableSavedObjectMetaData();return l.a.createElement(o.EuiFormRow,s()({fullWidth:!0},this.props.euiFormRowProps||{}),l.a.createElement(o.EuiFlexGroup,{gutterSize:"m"},l.a.createElement(o.EuiFlexItem,{grow:!0},l.a.createElement(o.EuiFieldSearch,s()({placeholder:g.i18n.translate("xpack.cases.markdownEditor.plugins.lens.savedObjects.finder.searchPlaceholder",{defaultMessage:"Search…"}),"aria-label":g.i18n.translate("xpack.cases.markdownEditor.plugins.lens.savedObjects.finder.searchPlaceholder",{defaultMessage:"Search…"}),fullWidth:!0,value:this.state.query,onChange:e=>{this.setState({query:e.target.value},this.fetchItems)},"data-test-subj":"savedObjectFinderSearchInput",isLoading:this.state.isFetchingItems},this.props.euiFieldSearchProps||{}))),l.a.createElement(o.EuiFlexItem,{grow:!1},l.a.createElement(o.EuiFilterGroup,null,l.a.createElement(o.EuiPopover,{id:"addPanelSortPopover",panelClassName:"euiFilterGroup__popoverPanel",panelPaddingSize:"none",isOpen:this.state.sortOpen,closePopover:()=>this.setState({sortOpen:!1}),button:l.a.createElement(o.EuiFilterButton,{onClick:()=>this.setState((({sortOpen:e})=>({sortOpen:!e}))),iconType:"arrowDown",isSelected:this.state.sortOpen,"data-test-subj":"savedObjectFinderSortButton"},g.i18n.translate("xpack.cases.markdownEditor.plugins.lens.savedObjects.finder.sortButtonLabel",{defaultMessage:"Sort"}))},l.a.createElement(o.EuiContextMenuPanel,{items:this.getSortOptions()})),this.props.showFilter&&l.a.createElement(o.EuiPopover,{id:"addPanelFilterPopover",panelClassName:"euiFilterGroup__popoverPanel",panelPaddingSize:"none",isOpen:this.state.filterOpen,closePopover:()=>this.setState({filterOpen:!1}),button:l.a.createElement(o.EuiFilterButton,{onClick:()=>this.setState((({filterOpen:e})=>({filterOpen:!e}))),iconType:"arrowDown","data-test-subj":"savedObjectFinderFilterButton",isSelected:this.state.filterOpen,numFilters:this.props.savedObjectMetaData.length,hasActiveFilters:this.state.filteredTypes.length>0,numActiveFilters:this.state.filteredTypes.length},g.i18n.translate("xpack.cases.markdownEditor.plugins.lens.savedObjects.finder.filterButtonLabel",{defaultMessage:"Types"}))},l.a.createElement(o.EuiContextMenuPanel,{items:this.props.savedObjectMetaData.map((t=>l.a.createElement(o.EuiContextMenuItem,{key:t.type,disabled:!e.includes(t),icon:this.state.filteredTypes.includes(t.type)?"check":"empty","data-test-subj":`savedObjectFinderFilter-${t.type}`,onClick:()=>{this.setState((({filteredTypes:e})=>({filteredTypes:e.includes(t.type)?e.filter((e=>e!==t.type)):[...e,t.type],page:0})))}},t.name)))})))),this.props.children?l.a.createElement(o.EuiFlexItem,{grow:!1},this.props.children):null))}renderListing(){const e=0===this.state.items.length?[]:this.getPageOfItems(),{onChoose:t,savedObjectMetaData:a}=this.props;return l.a.createElement(l.a.Fragment,null,this.state.isFetchingItems&&0===this.state.items.length&&l.a.createElement(o.EuiFlexGroup,{justifyContent:"center"},l.a.createElement(o.EuiFlexItem,{grow:!1},l.a.createElement(o.EuiSpacer,null),l.a.createElement(o.EuiLoadingSpinner,{"data-test-subj":"savedObjectFinderLoadingIndicator"}))),e.length>0?l.a.createElement(l.a.Fragment,null,l.a.createElement(o.EuiSpacer,{size:"s"}),l.a.createElement(o.EuiListGroup,{"data-test-subj":"savedObjectFinderItemList",maxWidth:!1,flush:!0},e.map((e=>{const n=a.find((t=>t.type===e.type));if(null==n)return null;const s=n.getTooltipForSavedObject?n.getTooltipForSavedObject(e.savedObject):`${e.name} (${n.name})`,i=(n||{getIconForSavedObject:()=>"document"}).getIconForSavedObject(e.savedObject);return l.a.createElement(o.EuiListGroupItem,{key:e.id,iconType:i,label:e.name,onClick:t?()=>{t(e.id,e.type,s,e.savedObject)}:void 0,title:s,"data-test-subj":`savedObjectTitle${(e.title||"").split(" ").join("-")}`})})))):!this.state.isFetchingItems&&l.a.createElement(o.EuiEmptyPrompt,{body:this.props.noItemsMessage}),this.getPageCount()>1&&(this.props.fixedPageSize?l.a.createElement(o.EuiPagination,{activePage:this.state.page,pageCount:this.getPageCount(),onPageClick:e=>{this.setState({page:e})}}):l.a.createElement(o.EuiTablePagination,{activePage:this.state.page,pageCount:this.getPageCount(),onChangePage:e=>{this.setState({page:e})},onChangeItemsPerPage:e=>{this.setState({perPage:e})},itemsPerPage:this.state.perPage,itemsPerPageOptions:[5,10,15,25]})))}}var M=a(142),w=a(115),C=a(3),x=a(20);const F=f.a.span.withConfig({displayName:"BetaBadgeWrapper",componentId:"sc-ubq95a-0"})(["display:inline-flex;.euiToolTipAnchor{display:inline-flex;}"]),I={from:"now-7d",to:"now",mode:"relative"},T=({node:e,onCancel:t,onSave:a})=>{const n=Object(h.useLocation)(),{application:{currentAppId$:s},embeddable:r,lens:c,storage:u,savedObjects:d,uiSettings:v,data:{query:{timefilter:{timefilter:f}}}}=Object(p.f)().services,[k,y]=Object(i.useState)(void 0),{draftComment:P,clearDraftComment:S}=Object(M.a)(),w=Object(i.useContext)(O),T=Object(i.useContext)(o.EuiMarkdownContext),L=(()=>{const{appId:e}=Object(x.a)();return e===C.W})(),D=Object(i.useCallback)((()=>{k&&(null==r||r.getStateTransfer().getIncomingEmbeddablePackage(k,!0),S()),t()}),[S,k,r,t]),A=Object(i.useCallback)(((e,t)=>{a(`!{${E.b}${JSON.stringify({timeRange:t,attributes:e})}}`,{block:!0}),D()}),[D,a]),N=Object(i.useCallback)(((e,t,a)=>{T.replaceNode(a,`!{${E.b}${JSON.stringify({timeRange:t,attributes:e})}}`),D()}),[D,T]),z=Object(i.useMemo)((()=>L?`/insightsAndAlerting/cases${n.pathname}${n.search}`:`${n.pathname}${n.search}`),[L,n.pathname,n.search]),B=Object(i.useCallback)((()=>{u.set(E.a,{commentId:null==w?void 0:w.editorId,comment:null==w?void 0:w.value,position:null==e?void 0:e.position,caseTitle:null==w?void 0:w.caseTitle,caseTags:null==w?void 0:w.caseTags}),null==c||c.navigateToPrefilledEditor(void 0,{originatingApp:k,originatingPath:z})}),[u,null==w?void 0:w.editorId,null==w?void 0:w.value,null==w?void 0:w.caseTitle,null==w?void 0:w.caseTags,null==e?void 0:e.position,c,k,z]),R=Object(i.useCallback)(((t,a=I)=>{u.set(E.a,{commentId:null==w?void 0:w.editorId,comment:null==w?void 0:w.value,position:null==e?void 0:e.position,caseTitle:null==w?void 0:w.caseTitle,caseTags:null==w?void 0:w.caseTags}),null==c||c.navigateToPrefilledEditor(t||null!=e&&e.attributes?{id:"",timeRange:a,attributes:t||(null==e?void 0:e.attributes)}:void 0,{originatingApp:k,originatingPath:z})}),[u,null==w?void 0:w.editorId,null==w?void 0:w.value,null==w?void 0:w.caseTitle,null==w?void 0:w.caseTags,null==e?void 0:e.position,null==e?void 0:e.attributes,c,k,z]),$=Object(i.useCallback)(((e,t,a,n)=>{R({...n.attributes,title:"",references:n.references})}),[R]),_=Object(i.useMemo)((()=>[{type:"lens",getIconForSavedObject:()=>"lensApp",name:g.i18n.translate("xpack.cases.markdownEditor.plugins.lens.insertLensSavedObjectModal.searchSelection.savedObjectType.lens",{defaultMessage:"Lens"}),includeFields:["*"]}]),[]),q=Object(i.useMemo)((()=>({prepend:g.i18n.translate("xpack.cases.markdownEditor.plugins.lens.savedObjects.finder.searchInputPrependLabel",{defaultMessage:"Template"})})),[]),G=Object(i.useMemo)((()=>({label:g.i18n.translate("xpack.cases.markdownEditor.plugins.lens.savedObjects.finder.searchInputLabel",{defaultMessage:"Select lens"}),labelAppend:l.a.createElement(o.EuiButtonEmpty,{onClick:B,color:"primary",size:"xs"},l.a.createElement(b.FormattedMessage,{id:"xpack.cases.markdownEditor.plugins.lens.createVisualizationButtonLabel",defaultMessage:"Create visualization"})),helpText:g.i18n.translate("xpack.cases.markdownEditor.plugins.lens.savedObjects.finder.searchInputHelpText",{defaultMessage:"Insert lens from existing templates or creating a new one. You will only create lens for this comment and won’t change Visualize Library."})})),[B]);return Object(i.useEffect)((()=>{null!=e&&e.attributes&&k&&R(e.attributes,e.timeRange)}),[R,e,k]),Object(i.useEffect)((()=>{(async()=>{const e=await s.pipe(Object(m.first)()).toPromise();y(e)})()}),[s]),Object(i.useEffect)((()=>{var e,t,a;let n;if(k&&(n=null==r?void 0:r.getStateTransfer().getIncomingEmbeddablePackage(k,!0)),"lens"===(null===(e=n)||void 0===e?void 0:e.type)&&null!==(t=n)&&void 0!==t&&null!==(a=t.input)&&void 0!==a&&a.attributes){const e=f.getTime(),t=null!=e&&e.from&&null!=e&&e.to?{from:e.from,to:e.to,mode:[e.from,e.to].join("").includes("now")?"relative":"absolute"}:void 0;var s,i;if(null!=P&&P.position)return void N(null===(s=n)||void 0===s?void 0:s.input.attributes,t,P.position);P&&A(null===(i=n)||void 0===i?void 0:i.input.attributes,t)}}),[r,u,f,k,A,N,P]),l.a.createElement(j,{direction:"column",gutterSize:"none"},l.a.createElement(o.EuiModalHeader,null,l.a.createElement(o.EuiModalHeaderTitle,null,l.a.createElement(o.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},l.a.createElement(o.EuiFlexItem,{grow:!1},l.a.createElement(b.FormattedMessage,{id:"xpack.cases.markdownEditor.plugins.lens.addVisualizationModalTitle",defaultMessage:"Add visualization"})),l.a.createElement(o.EuiFlexItem,{grow:!1},l.a.createElement(F,null,l.a.createElement(o.EuiBetaBadge,{label:g.i18n.translate("xpack.cases.markdownEditor.plugins.lens.betaLabel",{defaultMessage:"Beta"}),tooltipContent:g.i18n.translate("xpack.cases.markdownEditor.plugins.lens.betaDescription",{defaultMessage:"This module is not GA. You can only insert one lens per comment for now. Please help us by reporting bugs."})})))))),l.a.createElement(o.EuiModalBody,null,l.a.createElement(saved_objects_finder_SavedObjectFinderUi,{key:"searchSavedObjectFinder",onChoose:$,showFilter:!1,noItemsMessage:l.a.createElement(b.FormattedMessage,{id:"xpack.cases.markdownEditor.plugins.lens.insertLensSavedObjectModal.searchSelection.notFoundLabel",defaultMessage:"No matching lens found."}),savedObjectMetaData:_,fixedPageSize:10,uiSettings:v,savedObjects:d,euiFieldSearchProps:q,euiFormRowProps:G})),l.a.createElement(o.EuiModalFooter,null,l.a.createElement(o.EuiButton,{onClick:D,fill:!0},l.a.createElement(b.FormattedMessage,{id:"xpack.cases.markdownEditor.plugins.lens.closeButtonLabel",defaultMessage:"Close"}))))};T.displayName="LensEditor";const L=l.a.memo(T),D={name:E.b,button:{label:w.a,iconType:"lensApp"},helpText:l.a.createElement(o.EuiCodeBlock,{language:"md",paddingSize:"s",fontSize:"l"},"!{lens<config>}"),editor:L},A=function(){const e=this.Parser,t=e.prototype.blockTokenizers,a=e.prototype.blockMethods;t.lens=function(e,t,a){if(!1===t.startsWith(E.d))return!1;const n=t[6];if("{"!==n&&"}"!==n)return!1;if(a)return!0;const s="{"===n;let i=E.d,l={};if(s){let a="",n=0;for(let e=6;e<t.length;e++){const s=t[e];if("{"===s)n++,a+=s;else if("}"===s){if(n--,-1===n)break;a+=s}else a+=s}i+=a;try{l=JSON.parse(a)}catch(t){const a=e.now();this.file.fail(`Unable to parse lens JSON configuration: ${t}`,{line:a.line,column:a.column+6})}}return i+="}",e(i)({type:E.b,...l})},a.splice(a.indexOf("text"),0,E.b)};var N=a(78);const z=f.a.div.withConfig({displayName:"Container",componentId:"sc-1q3wldf-0"})(["min-height:","px;"],E.c),B=N.createGlobalStyle`
  div.euiOverlayMask[data-relative-to-header=above] ~ [id^='echTooltipPortal'] {
    z-index: ${({theme:e})=>e.eui.euiZLevel7} !important;
  }
`,R=({attributes:e,timeRange:t})=>{const{lens:{EmbeddableComponent:a}}=Object(p.f)().services;return e?l.a.createElement(z,null,l.a.createElement(a,{id:"",style:{height:E.c},timeRange:t,attributes:e,renderMode:"view",disableTriggers:!0,executionContext:{type:"cases"}}),l.a.createElement(B,null)):null};R.displayName="LensMarkDownRenderer";const $=l.a.memo(R),_=e=>{var t,a;const n=p.a.getConfig(),s=null===(t=Object(d.a)())||void 0===t?void 0:t.editor_plugins,l=Object(p.b)();return Object(i.useMemo)((()=>{var t;const a=Object(o.getDefaultEuiMarkdownUiPlugins)(),i=Object(o.getDefaultEuiMarkdownParsingPlugins)(),r=Object(o.getDefaultEuiMarkdownProcessingPlugins)();return s&&(a.push(s.uiPlugin),i.push(s.parsingPlugin),r[1][1].components.timeline=s.processingPluginRenderer),null==n||null===(t=n.markdownPlugins)||void 0===t||!t.lens||null!=e&&e.includes(E.b)||null==l||!l.visualize.crud||a.push(D),i.push(A),r[1][1].components.lens=$,{uiPlugins:a,parsingPlugins:i,processingPlugins:r}}),[null==l?void 0:l.visualize.crud,e,null==n||null===(a=n.markdownPlugins)||void 0===a?void 0:a.lens,s])},q=({children:e,disableLinks:t})=>{const{processingPlugins:a,parsingPlugins:n}=_(),c=Object(r.cloneDeep)(a);return c[1][1].components.a=Object(i.useMemo)((()=>(e=>{const t=Object(i.memo)((t=>l.a.createElement(u,s()({},t,{disableLinks:e}))));return t.displayName="MarkdownLinkProcessingComponent",t})(t)),[t]),l.a.createElement(o.EuiMarkdownFormat,{parsingPluginList:n,processingPluginList:c,grow:!1},e)};q.displayName="MarkdownRenderer";const G=Object(i.memo)(q);var W=a(137),U=a.n(W);const V="euiButtonIcon-isDisabled",H=Object(i.forwardRef)((({ariaLabel:e,dataTestSubj:t,editorId:a,height:n,onChange:s,value:r,disabledUiPlugins:c},u)=>{const d=Object(i.useRef)(void 0),[p,m]=Object(i.useState)([]),g=Object(i.useCallback)(((e,{messages:t,ast:a})=>{m(e?[e]:t),d.current=a}),[]),{parsingPlugins:b,processingPlugins:h,uiPlugins:v}=_(c),f=Object(i.useRef)(null);return(({astRef:e,editorRef:t,uiPlugins:a,value:n})=>{const s=Object(i.useRef)(!1),[l,r]=Object(i.useState)(!1),o=Object(i.useCallback)((()=>{var e,a;if(null!=t&&null!==(e=t.current)&&void 0!==e&&e.textarea&&null!==(a=t.current)&&void 0!==a&&a.toolbar){var n,s;const e=null===(n=t.current)||void 0===n||null===(s=n.toolbar)||void 0===s?void 0:s.querySelector(`[aria-label="${w.a}"]`);if(e){const t=e.className.includes(V),a=e.getAttribute("style");t&&a&&(e.className=e.className.replace(V,""),e.setAttribute("style",a.replace("pointer-events: none;","")))}}}),[t]),c=Object(i.useCallback)((()=>{var e;if(null!=t&&null!==(e=t.current)&&void 0!==e&&e.textarea&&t.current.toolbar){var a;const e=null===(a=t.current.toolbar)||void 0===a?void 0:a.querySelector(`[aria-label="${w.a}"]`);e&&(e.className.includes(V)||(e.className+=` ${V}`,e.setAttribute("style","pointer-events: none;")))}}),[t]);Object(i.useEffect)((()=>{s.current=Object(P.some)(a,["name","lens"])}),[a]),U()((()=>{l||null==n||!n.includes(E.d)?o():c()}),100,[n,l]),Object(i.useEffect)((()=>{var a,n;if(null==(null==t||null===(a=t.current)||void 0===a?void 0:a.textarea)||null==(null==e?void 0:e.current)||!s.current)return;const i=()=>{var a;const{selectionStart:n}=null===(a=t.current)||void 0===a?void 0:a.textarea;let s=e.current;e:for(;;){if(s.children)for(let e=0;e<s.children.length;e++){const t=s.children[e];if(t.position&&t.position.start.offset<n&&n<t.position.end.offset){if("text"===t.type)break e;s=t;continue e}}break}r("lens"===s.type)},l=null===(n=t.current)||void 0===n?void 0:n.textarea;return l.addEventListener("keyup",i),l.addEventListener("mouseup",i),()=>{l.removeEventListener("keyup",i),l.removeEventListener("mouseup",i)}}),[e,t])})({astRef:d,uiPlugins:v,editorRef:u,value:r}),Object(i.useImperativeHandle)(u,(()=>{var e,t;if(!f.current)return null;const a=null===(e=f.current)||void 0===e||null===(t=e.textarea)||void 0===t?void 0:t.closest(".euiMarkdownEditor");return{...f.current,toolbar:null==a?void 0:a.querySelector(".euiMarkdownEditorToolbar")}})),l.a.createElement(o.EuiMarkdownEditor,{ref:f,"aria-label":e,editorId:a,onChange:s,value:r,uiPlugins:v,parsingPluginList:b,processingPluginList:h,onParse:g,errors:p,"data-test-subj":t,height:n})}));H.displayName="MarkdownEditor";const J=Object(i.memo)(H);var Y=a(76);const Z=f()(o.EuiFlexGroup).withConfig({displayName:"BottomContentWrapper",componentId:"sc-aza0tp-0"})(["",""],(({theme:e})=>`\n    padding: ${e.eui.euiSizeM} 0;\n  `)),K=l.a.memo(Object(i.forwardRef)((({id:e,field:t,dataTestSubj:a,idAria:n,bottomRightContent:s,caseTitle:r,caseTags:c,disabledUiPlugins:u},d)=>{const{isInvalid:p,errorMessage:m}=Object(Y.getFieldValidityAndErrorMessage)(t),g=Object(i.useMemo)((()=>({editorId:e,value:t.value,caseTitle:r,caseTags:c})),[e,t.value,r,c]);return l.a.createElement(O.Provider,{value:g},l.a.createElement(o.EuiFormRow,{"data-test-subj":a,describedByIds:n?[n]:void 0,fullWidth:!0,error:m,helpText:t.helpText,isInvalid:p,label:t.label,labelAppend:t.labelAppend},l.a.createElement(J,{ref:d,ariaLabel:n,editorId:e,onChange:t.setValue,value:t.value,disabledUiPlugins:u,"data-test-subj":`${a}-markdown-editor`})),s&&l.a.createElement(Z,{justifyContent:"flexEnd"},l.a.createElement(o.EuiFlexItem,{grow:!1},s)))})));K.displayName="MarkdownEditorForm"},140:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(1),s=a(141);const i=()=>Object(n.useContext)(s.a)},141:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return l}));var n=a(1),s=a.n(n);const i=s.a.createContext(null),l=({children:e,timelineIntegration:t})=>{const[a]=Object(n.useState)(null!=t?t:null);return s.a.createElement(i.Provider,{value:a},e)}},142:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(1),s=a(83),i=a(5),l=a(42),r=a(115);const o=()=>{const{application:{currentAppId$:e},embeddable:t,storage:a}=Object(i.f)().services,[o,c]=Object(n.useState)(null),[u,d]=Object(n.useState)(!1);return Object(n.useEffect)((()=>{(async()=>{const n=await e.pipe(Object(s.first)()).toPromise();if(!n)return;const i=null==t?void 0:t.getStateTransfer().getIncomingEmbeddablePackage(n),r=a.get(l.a);d(!!i),r&&c(r)})()}),[e,t,a]),{draftComment:o,hasIncomingLensState:u,openLensModal:Object(n.useCallback)((({editorRef:e})=>{if(e&&e.textarea&&e.toolbar){var t;const a=null===(t=e.toolbar)||void 0===t?void 0:t.querySelector(`[aria-label="${r.a}"]`);a&&a.click()}}),[]),clearDraftComment:Object(n.useCallback)((()=>{a.remove(l.a),c(null)}),[a])}}}}]);