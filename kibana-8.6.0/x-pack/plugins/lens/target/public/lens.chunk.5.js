/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.lens_bundle_jsonpfunction=window.lens_bundle_jsonpfunction||[]).push([[5],{482:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(8),o=a(483);t.default=function(e,t){var a=o.useFirstMountState();n.useEffect((function(){if(!a)return e()}),t)}},483:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useFirstMountState=void 0;var n=a(8);t.useFirstMountState=function(){var e=n.useRef(!0);return e.current?(e.current=!1,!0):e.current}},494:function(e,t,a){"use strict";a.r(t);var n=a(74),o=a.n(n),l=a(0),r=a(8),i=a.n(r),s=a(127),c=a.n(s),u=a(2),d=a(7),p=a(12),m=a.n(p),v=a(58),g=a.n(v),b=a(69),j=["palettes","activePalette","setPalette","showCustomPalette","showDynamicColorOnly"];function y(e){var t=e.palettes,a=e.activePalette,n=e.setPalette,o=e.showCustomPalette,l=e.showDynamicColorOnly,r=g()(e,j),i=t.getAll().filter((function(e){var t=e.internal,a=e.canDynamicColoring;return l?a:!t})).map((function(e){var t,n=e.id,o=e.title,l=(0,e.getCategoricalColors)((null==a||null===(t=a.params)||void 0===t?void 0:t.steps)||b.b,n===(null==a?void 0:a.name)?null==a?void 0:a.params:void 0);return{value:n,title:o,type:b.h,palette:l,"data-test-subj":"".concat(n,"-palette")}}));return o&&i.push(function(e,t){var a,n=e.get(b.a),o=n.id,l=n.title;if(t&&t.name!==b.a){var r=e.get(t.name);if(r){var i,s,c=r.getCategoricalColors((null==t||null===(i=t.params)||void 0===i?void 0:i.steps)||b.b,null==t?void 0:t.params),u=null!==(s=t.params)&&void 0!==s&&s.reverse?c.reverse():c;return{value:o,title:l,type:b.h,palette:u,"data-test-subj":"custom-palette"}}}return null!=t&&null!==(a=t.params)&&void 0!==a&&a.stops?{value:o,title:l,type:b.h,"data-test-subj":"custom-palette",palette:(t.params.colorStops||t.params.stops).map((function(e){return e.color}))}:{value:o,title:l,type:"text","data-test-subj":"custom-palette"}}(t,a)),Object(u.jsx)(d.EuiColorPalettePicker,m()({fullWidth:!0,"data-test-subj":"lns-palettePicker",compressed:!0,palettes:i,onChange:function(e){n({type:"palette",name:e})},valueOfSelected:(null==a?void 0:a.name)||b.f,selectionDisplay:"palette"},r))}var f=a(73),h=a.n(f),x=a(103),O=a.n(x),C=a(117),P=a.n(C),I=function(e){return Object(u.jsx)("svg",m()({xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},e),Object(u.jsx)("path",{d:"M2.586 9.414a2 2 0 0 1 2.809-2.847l.601.679 1.336-1.508-.462-.522a4 4 0 1 0 0 5.569l-1.5-1.328a2 2 0 0 1-2.784-.043Z"}),Object(u.jsx)("path",{d:"m5.373 9.458 1.497 1.326 3.757-4.242.002.001a2 2 0 1 1-.024 2.89l-.601-.679-1.336 1.508.462.522a4 4 0 1 0 0-5.569L5.373 9.459Z"}))},M=function(e){return Object(u.jsx)("svg",m()({width:"16",height:"14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),Object(u.jsx)("path",{d:"M8 0a.5.5 0 0 1 .384.18l2.5 3A.5.5 0 0 1 10.5 4h-5a.5.5 0 0 1-.384-.82l2.5-3A.5.5 0 0 1 8 0ZM.916 5.223A.5.5 0 0 0 0 5.5v5a.5.5 0 0 0 1 0V7.151l1.084 1.626a.5.5 0 0 0 .832 0L4 7.151V10.5a.5.5 0 0 0 1 0v-5a.5.5 0 0 0-.916-.277L2.5 7.599.916 5.223Z"}),Object(u.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.5 5h-.545l-.098.006a3.572 3.572 0 0 0-1.33.36 2.693 2.693 0 0 0-1.052.911C6.18 6.72 6 7.287 6 8v2.5a.5.5 0 0 0 1 0V9h2v1.5a.5.5 0 0 0 1 0v-5a.5.5 0 0 0-.5-.5Zm-.5.5V5v.5ZM7 8h2V6h-.011a2.57 2.57 0 0 0-.297.032c-.202.034-.463.1-.718.228a1.695 1.695 0 0 0-.667.572C7.133 7.092 7 7.462 7 8Z"}),Object(u.jsx)("path",{d:"M11.188 5.11a.5.5 0 0 1 .702.078L13.5 7.2l1.61-2.012a.5.5 0 1 1 .78.624L14.14 8l1.75 2.188a.5.5 0 1 1-.78.624L13.5 8.8l-1.61 2.012a.5.5 0 0 1-.78-.624L12.86 8l-1.75-2.188a.5.5 0 0 1 .078-.702Z"}))},w=function(e){return Object(u.jsx)("svg",m()({width:"16",height:"14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),Object(u.jsx)("path",{d:"M10.367.018a.5.5 0 0 1 .562.225L13 3.695V.5a.5.5 0 0 1 1 0v5a.5.5 0 0 1-.929.257L11 2.305V5.5a.5.5 0 0 1-1 0v-5a.5.5 0 0 1 .367-.482ZM.916.223A.5.5 0 0 0 0 .5v5a.5.5 0 0 0 1 0V2.151l1.084 1.626a.5.5 0 0 0 .832 0L4 2.151V5.5a.5.5 0 0 0 1 0v-5a.5.5 0 0 0-.916-.277L2.5 2.599.916.223ZM7 11a.5.5 0 0 0 .384-.18l2.5-3A.5.5 0 0 0 9.5 7h-5a.5.5 0 0 0-.384.82l2.5 3A.5.5 0 0 0 7 11ZM6.5 0a.5.5 0 0 0 0 1H7v4h-.5a.5.5 0 0 0 0 1h2a.5.5 0 0 0 0-1H8V1h.5a.5.5 0 0 0 0-1h-2Z"}))},T=function(e){return"end"===e},N=function(e){var t=e[e.length-1];return[].concat(P()(e),[{start:t.end,color:t.color,end:void 0}]).sort((function(e,t){var a=e.start,n=t.start;return Number(a)-Number(n)})).reduce((function(e,a,n,o){var l=a.color;return n===o.length-2&&o[n+1].start!==t.end&&(l=o[n+1].color),n!==o.length-1&&e.push({color:l,start:a.start,end:o[n+1].start}),e}),[])},E=function(e,t,a){var n=P()(e);return n[t]=h()(h()({},n[t]),a),n},V=function(e,t,a,n){var o=t?parseFloat(t):Number.NaN,l=n;return"end"===a?l=E(l,e,{end:o}):(l=E(l,e,{start:o}),e>0&&(l=E(l,e-1,{end:o}))),l};function _(e,t,a,n,o){var l,r,i,s,c,u=null!==(l=null!=o?o:null===(r=t.params)||void 0===r?void 0:r.continuity)&&void 0!==l?l:b.c,d=a;a.some((function(e,t){return t!==a.length-1&&e.start>a[t+1].start}))&&(d=N(a));var p=function(e,t){var a=Object(b.k)(t)?Number.NEGATIVE_INFINITY:e[0].start,n=Object(b.j)(t)?Number.POSITIVE_INFINITY:e[e.length-1].end;return{min:a,max:n,colorStops:e.map((function(e,t){return{color:e.color,stop:0===t?a:e.start}}))}}(d,u),m=p.max,v=p.colorStops,g=function(e,t,a,n){var o;if((null==t||null===(o=t.params)||void 0===o?void 0:o.name)===b.a){var l=Object(b.n)(e,h()(h()({steps:b.b},t.params),a),{dataBounds:n});return R(t,h()(h()({},a),{},{stops:l}))}var r=h()(h()(h()({steps:b.b},t.params),a),{},{name:b.a}),i=Object(b.n)(e,r,{prevPalette:r.colorStops?void 0:t.name,dataBounds:n});return R({name:b.a,type:"palette"},h()(h()({},r),{},{stops:i}))}(e,t,{continuity:u,colorStops:v,steps:(null===(i=t.params)||void 0===i?void 0:i.steps)||b.b,reverse:null===(s=t.params)||void 0===s?void 0:s.reverse,rangeMin:null===(c=v[0])||void 0===c?void 0:c.stop,rangeMax:m},n);return{activePalette:g,colorRanges:a}}function B(e,t,a){var n;return{colorRanges:A(e,(null===(n=t.params)||void 0===n?void 0:n.colorStops)||[],t,a),activePalette:t}}function R(e,t){return h()(h()({},e),{},{params:h()(h()({},e.params),t)})}function F(e){return""!==e&&/^#/.test(e)&&function(e){try{return O()(e),!0}catch(e){return!1}}(e)}function S(e,t,a,n){var o;if((null==a?void 0:a.name)===b.a&&null!=t&&t.length)return t;var l=Object(b.n)(e,h()({},null==a?void 0:a.params),{dataBounds:n,mapFromMinValue:!0,defaultPaletteName:a.name});return null!=a&&null!==(o=a.params)&&void 0!==o&&o.reverse&&(l=Object(b.o)(l)),l}function A(e,t,a,n){var o,l=null!==(o=a.params)&&void 0!==o?o:{},r=l.continuity,i=void 0===r?b.c:r,s=l.rangeType,c=void 0===s?b.g:s,u=Object(b.l)(c,n),d=u.min,p=u.max;return S(e,t||[],a,n).map((function(e,t,n){var o,l,r,s,c,u,m,v=0===t,g=t===n.length-1;return{color:e.color,start:v&&Object(b.k)(i)?Number.NEGATIVE_INFINITY:null!==(o=null!==(l=e.stop)&&void 0!==l?l:null===(r=a.params)||void 0===r?void 0:r.rangeMin)&&void 0!==o?o:d,end:g&&Object(b.j)(i)?Number.POSITIVE_INFINITY:null!==(s=null!==(c=null===(u=n[t+1])||void 0===u?void 0:u.stop)&&void 0!==c?c:null===(m=a.params)||void 0===m?void 0:m.rangeMax)&&void 0!==s?s:p}}))}var k=a(21),L=a(22),D=function(e){return Object(u.jsx)("svg",m()({width:"15",height:"12",viewBox:"0 0 15 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),Object(u.jsx)("path",{d:"M4 .5a.5.5 0 0 1 1 0v11a.5.5 0 0 1-1 0V.5ZM0 3a1 1 0 0 1 1-1h2v8H1a1 1 0 0 1-1-1V3ZM10.5 0a.5.5 0 0 0-.5.5v11a.5.5 0 0 0 1 0V.5a.5.5 0 0 0-.5-.5ZM6 2h3v8H6V2ZM14 2h-2v8h2a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1Z"}))},Y=["children","condition","tooltipContent"],Z=function(e){var t=e.children,a=e.condition,n=e.tooltipContent,o=g()(e,Y);return Object(u.jsx)(i.a.Fragment,null,a?Object(u.jsx)(d.EuiToolTip,m()({content:n,delay:"long"},o),Object(u.jsx)(i.a.Fragment,null,t)):t)},z=i.a.createContext({});function G(e){var t=e.dispatch,a=e.shouldDisableAdd,n=void 0!==a&&a,o=e.shouldDisableReverse,i=void 0!==o&&o,s=e.shouldDisableDistribute,c=void 0!==s&&s,p=Object(r.useContext)(z),m=p.dataBounds,v=p.palettes,g=Object(r.useCallback)((function(){t({type:"addColorRange",payload:{dataBounds:m,palettes:v}})}),[m,t,v]),b=Object(r.useCallback)((function(){t({type:"reversePalette",payload:{dataBounds:m,palettes:v}})}),[t,m,v]),j=Object(r.useCallback)((function(){t({type:"distributeEqually",payload:{dataBounds:m,palettes:v}})}),[m,t,v]),y=l.i18n.translate("coloring.dynamicColoring.customPalette.oneColorRange",{defaultMessage:"Requires more than one color"});return Object(u.jsx)(d.EuiFlexGroup,{justifyContent:"flexStart",gutterSize:"m",wrap:!0},Object(u.jsx)(d.EuiFlexItem,{grow:!1},Object(u.jsx)(Z,{tooltipContent:l.i18n.translate("coloring.dynamicColoring.customPalette.maximumStepsApplied",{defaultMessage:"You've applied the maximum number of steps"}),condition:n,position:"top",delay:"regular"},Object(u.jsx)(d.EuiButtonEmpty,{"data-test-subj":"lnsPalettePanel_dynamicColoring_addColor",iconType:"plusInCircle",color:"primary","aria-label":l.i18n.translate("coloring.dynamicColoring.customPalette.addColorAriaLabel",{defaultMessage:"Add color"}),size:"xs",flush:"left",disabled:n,onClick:g},Object(u.jsx)(L.FormattedMessage,{id:"coloring.dynamicColoring.customPalette.addColor",defaultMessage:"Add color"})))),Object(u.jsx)(d.EuiFlexItem,{grow:!1},Object(u.jsx)(Z,{tooltipContent:y,condition:i,position:"top",delay:"regular"},Object(u.jsx)(d.EuiButtonEmpty,{"data-test-subj":"lnsPalettePanel_dynamicColoring_reverseColors",iconType:"sortable",color:"primary","aria-label":l.i18n.translate("coloring.dynamicColoring.customPaletteAriaLabel",{defaultMessage:"Reverse colors"}),size:"xs",flush:"left",onClick:b,disabled:i},Object(u.jsx)(L.FormattedMessage,{id:"coloring.dynamicColoring.customPalette.reverseColors",defaultMessage:"Reverse colors"})))),Object(u.jsx)(d.EuiFlexItem,{grow:!1},Object(u.jsx)(Z,{tooltipContent:y,condition:c,position:"top",delay:"regular"},Object(u.jsx)(d.EuiButtonEmpty,{"data-test-subj":"lnsPalettePanel_dynamicColoring_distributeValues",iconType:D,color:"primary","aria-label":l.i18n.translate("coloring.dynamicColoring.customPalette.distributeValuesAriaLabel",{defaultMessage:"Distribute values"}),size:"xs",flush:"left",disabled:c,onClick:j},Object(u.jsx)(L.FormattedMessage,{id:"coloring.dynamicColoring.customPalette.distributeValues",defaultMessage:"Distribute values"})))))}var H=a(482),W=a.n(H),U=function(e){return Object(u.jsx)("svg",m()({width:"24",height:"24",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},e),Object(u.jsx)("path",{d:"M6 .5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5V8h4V6.5a.5.5 0 0 1 .82-.384l3 2.5a.5.5 0 0 1 0 .768l-3 2.5A.5.5 0 0 1 12 11.5V10H6.5a.5.5 0 0 1-.5-.5v-9Z"}))},q=function(e,t){switch(t){case"none":return e?"above":"below";case"above":return e?"none":"all";case"below":return e?"all":"none";case"all":return e?"below":"above"}};function J(e){var t=e.index,a=e.dispatch,n=Object(r.useContext)(z),o=n.dataBounds,i=n.palettes,s=Object(r.useCallback)((function(){a({type:"deleteColorRange",payload:{index:t,dataBounds:o,palettes:i}})}),[a,t,o,i]),c=l.i18n.translate("coloring.dynamicColoring.customPalette.deleteButtonAriaLabel",{defaultMessage:"Delete"});return Object(u.jsx)(d.EuiButtonIcon,{iconType:"trash",color:"danger","aria-label":c,title:c,onClick:s,"data-test-subj":"lnsPalettePanel_dynamicColoring_removeColorRange_".concat(t)})}function K(e){var t=e.index,a=e.continuity,n=e.dispatch,o=e.accessor,i=Object(r.useContext)(z),s=i.dataBounds,c=i.palettes,p=i.disableSwitchingContinuity,m=T(o),v=Object(r.useCallback)((function(){var e=q(m,a);n({type:"updateContinuity",payload:{isLast:m,continuity:e,dataBounds:s,palettes:c}})}),[m,n,a,s,c]),g=m?l.i18n.translate("coloring.dynamicColoring.customPalette.setCustomMinValue",{defaultMessage:"Set custom maximum value"}):l.i18n.translate("coloring.dynamicColoring.customPalette.setCustomMaxValue",{defaultMessage:"Set custom minimum value"});return p&&(g=l.i18n.translate("coloring.dynamicColoring.customPalette.disallowedEditMinMaxValues",{defaultMessage:"You cannot set custom value for current configuration"})),Object(u.jsx)(Z,{tooltipContent:g,condition:!0,position:"top",delay:"regular"},Object(u.jsx)(d.EuiButtonIcon,{iconType:"pencil","aria-label":g,disabled:p,onClick:v,"data-test-subj":"lnsPalettePanel_dynamicColoring_editValue_".concat(t)}))}function Q(e){var t=e.continuity,a=e.dispatch,n=e.accessor,o=e.tooltipContent,l=e.iconFactory,i=Object(r.useContext)(z),s=i.dataBounds,c=i.palettes,p=T(n),m=Object(r.useCallback)((function(){var e=q(p,t);a({type:"updateContinuity",payload:{isLast:p,continuity:e,dataBounds:s,palettes:c}})}),[t,s,a,p,c]);return Object(u.jsx)(Z,{tooltipContent:o,condition:!0,position:"top",delay:"regular"},Object(u.jsx)(d.EuiButtonIcon,{iconType:l,"aria-label":o,onClick:m,"data-test-subj":"lnsPalettePanel_dynamicColoring_autoDetect_".concat(p?"maximum":"minimum")}))}var X=function(e,t){var a=[];return"percent"===e&&a.push("%"),a};function $(e){var t,a=e.accessor,n=e.index,i=e.colorRange,s=e.rangeType,c=e.colorRanges,p=e.validation,m=e.continuity,v=e.dispatch,g=Object(r.useContext)(z),j=g.dataBounds,y=g.palettes,f=Object(r.useState)(!1),h=o()(f,2),x=h[0],O=h[1],C=Object(r.useState)(i[a]),P=o()(C,2),N=P[0],E=P[1],V=T(a),_=function(e,t,a){return!t&&e>0?"value":(t?b.j:b.k)(a)?"auto":"edit"}(n,V,m),B="auto"===_,R=F(i.color),S=function(e){return"value"===e?J:"edit"===e?Q:K}(_),A=null===(t=null==p?void 0:p.isValid)||void 0===t||t,k=Object(d.useEuiTheme)().euiTheme,L=Object(r.useCallback)((function(e){var t,a,o,l,r,s,u,d=null!==(t=null===(a=c[n-1])||void 0===a?void 0:a.start)&&void 0!==t?t:Number.NEGATIVE_INFINITY,p=null!==(o=null===(l=c[n+1])||void 0===l?void 0:l.start)&&void 0!==o?o:Number.POSITIVE_INFINITY,m=null!==(r=null===(s=c[c.length-1])||void 0===s?void 0:s.end)&&void 0!==r?r:Number.POSITIVE_INFINITY,g=i.start>p||d>i.start||!V&&i.start>m,b=(null===(u=e.currentTarget)||void 0===u?void 0:u.contains(e.relatedTarget))||x;g&&!b&&v({type:"sortColorRanges",payload:{dataBounds:j,palettes:y}})}),[i.start,c,v,n,x,j,y,V]),D=Object(r.useCallback)((function(e){var t=e.target.value;E(t),v({type:"updateValue",payload:{index:n,value:t,accessor:a,dataBounds:j,palettes:y}})}),[v,n,a,j,y]),Y=Object(r.useCallback)((function(e){v({type:"updateColor",payload:{index:n,color:e,dataBounds:j,palettes:y}})}),[v,n,j,y]);W()((function(){Number.isNaN(i[a])||i[a]===N||E(i[a])}),[N,i,a]);var Z,G,H,q=l.i18n.translate("coloring.dynamicColoring.customPalette.selectNewColor",{defaultMessage:"Select a new color"}),$=Object(r.useMemo)((function(){return Object(u.css)("display:block;min-width:",k.size.xl,";text-align:center;","")}),[k.size.xl]),ee=(G=(Z={isPercentage:"percent"===s,isUpper:V,isAuto:"auto"===_}).isPercentage,{representation:(H=Z.isUpper)?G?l.i18n.translate("coloring.dynamicColoring.customPalette.maxValuePlaceholderPercentage",{defaultMessage:"100"}):l.i18n.translate("coloring.dynamicColoring.customPalette.maxValuePlaceholder",{defaultMessage:"No max."}):G?l.i18n.translate("coloring.dynamicColoring.customPalette.minValuePlaceholderPercentage",{defaultMessage:"0"}):l.i18n.translate("coloring.dynamicColoring.customPalette.minValuePlaceholder",{defaultMessage:"No min."}),actionDescription:H?G?l.i18n.translate("coloring.dynamicColoring.customPalette.useAutoMaxValuePercentage",{defaultMessage:"Use maximum percentage"}):l.i18n.translate("coloring.dynamicColoring.customPalette.useAutoMaxValue",{defaultMessage:"No maximum value"}):G?l.i18n.translate("coloring.dynamicColoring.customPalette.useAutoMinValuePercentage",{defaultMessage:"Use minimum percentage"}):l.i18n.translate("coloring.dynamicColoring.customPalette.useAutoMinValue",{defaultMessage:"No minimum value"}),icon:G?H?M:w:I});return Object(u.jsx)(d.EuiFlexGroup,{alignItems:"center",gutterSize:"s",wrap:!1,responsive:!1},Object(u.jsx)(d.EuiFlexItem,{grow:!1,css:V?$:null},V?Object(u.jsx)(d.EuiIcon,{type:U,size:"m",color:k.colors.disabled}):Object(u.jsx)(d.EuiColorPicker,{onChange:Y,button:R?Object(u.jsx)(d.EuiColorPickerSwatch,{color:i.color,"aria-label":q,style:{width:k.size.xl,height:k.size.xl}}):Object(u.jsx)(d.EuiButtonIcon,{color:"danger",iconType:"stopSlash",iconSize:"l","aria-label":q}),secondaryInputDisplay:"top",color:i.color,showAlpha:!0,onFocus:function(){return O(!0)},onBlur:function(){O(!1)},isInvalid:!R})),Object(u.jsx)(d.EuiFlexItem,{grow:!0},Object(u.jsx)(d.EuiFieldNumber,{compressed:!0,fullWidth:!0,isInvalid:!A,value:"auto"!==_&&void 0!==N&&isFinite(N)?N:"",disabled:B,onChange:D,placeholder:"auto"===_?ee.representation:"",append:X(s),onBlur:L,"data-test-subj":"lnsPalettePanel_dynamicColoring_range_value_".concat(n),prepend:Object(u.jsx)("span",{className:"euiFormLabel"},V?"≤":"≥"),"aria-label":l.i18n.translate("coloring.dynamicColoring.customPalette.rangeAriaLabel",{defaultMessage:"Range {index}",values:{index:n+1}}),step:"any"})),S?Object(u.jsx)(d.EuiFlexItem,{grow:!1},Object(u.jsx)(S,{index:n,continuity:m,rangeType:s,colorRanges:c,dispatch:v,tooltipContent:ee.actionDescription,iconFactory:ee.icon,accessor:a})):null)}var ee=a(1),te=a.n(ee),ae=function(e,t,a){var n=[],o=e[t];return Number.isNaN(o)&&n.push("invalidValue"),"end"===t?e.start>e.end&&n.push("greaterThanMaxValue"):F(e.color)||n.push("invalidColor"),a&&![-1/0,1/0].includes(o)&&(o<0||o>100)&&n.push("percentOutOfBounds"),{isValid:!n.length,errors:n}},ne=function(e,t){var a=e.reduce((function(e,a,n){return h()(h()({},e),{},te()({},n,ae(a,"start",t)))}),{});return h()(h()({},a),{},{last:ae(e[e.length-1],"end",t)})};function oe(e){var t,a,n=e.colorRanges,i=e.paletteConfiguration,s=e.showExtraActions,c=e.dispatch,p=Object(r.useState)({}),m=o()(p,2),v=m[0],g=m[1],j=n[n.length-1],y=function(e){return Array.from(new Set(Object.values(e).map((function(e){return e.errors})).flat().map((function(e){switch(e){case"invalidColor":case"invalidValue":return l.i18n.translate("coloring.dynamicColoring.customPalette.invalidValueOrColor",{defaultMessage:"At least one color range contains the wrong value or color"});case"greaterThanMaxValue":return l.i18n.translate("coloring.dynamicColoring.customPalette.invalidMaxValue",{defaultMessage:"Maximum value must be greater than preceding values"});case"percentOutOfBounds":return l.i18n.translate("coloring.dynamicColoring.customPalette.invalidPercentValue",{defaultMessage:"Percent values must be between 0 and 100"});default:return""}}))))}(v),f=null!==(t=null==i?void 0:i.continuity)&&void 0!==t?t:b.c,h=null!==(a=null==i?void 0:i.rangeType)&&void 0!==a?a:b.g;return Object(r.useEffect)((function(){g(ne(n,"percent"===h))}),[n,h]),Object(u.jsx)(d.EuiFlexGroup,{"data-test-subj":"lnsPalettePanel_dynamicColoring_custom_color_ranges",direction:"column",gutterSize:"s"},n.map((function(e,t){var a,o;return Object(u.jsx)(d.EuiFlexItem,{grow:!1,key:"".concat(null!==(a=null!==(o=e.end)&&void 0!==o?o:0+e.start)&&void 0!==a?a:0).concat(t)},Object(u.jsx)($,{colorRange:e,dispatch:c,colorRanges:n,continuity:f,rangeType:h,index:t,validation:v[t],accessor:"start"}))})),j?Object(u.jsx)(d.EuiFlexItem,{grow:!1},Object(u.jsx)($,{colorRange:j,dispatch:c,colorRanges:n,continuity:f,rangeType:h,index:n.length-1,validation:v.last,accessor:"end"})):null,Object(u.jsx)(d.EuiFlexItem,{grow:!1},y.map((function(e){return Object(u.jsx)(d.EuiTextColor,{color:"danger",key:"".concat(Object(k.camelCase)(e))},e)}))),s?Object(u.jsx)(d.EuiFlexItem,{grow:!1},Object(u.jsx)(G,{dispatch:c,shouldDisableAdd:Boolean((null==i?void 0:i.maxSteps)&&n.length>=(null==i?void 0:i.maxSteps)||y.length),shouldDisableDistribute:Boolean(1===n.length),shouldDisableReverse:Boolean(1===n.length)})):null)}var le=function(e,t){switch(t.type){case"updateContinuity":var a,n,o=t.payload,l=o.continuity,r=o.isLast,i=o.dataBounds,s=o.palettes,c=null!==(a=null===(n=e.activePalette.params)||void 0===n?void 0:n.rangeType)&&void 0!==a?a:b.g,u=function(e,t,a,n,o){var l=Object(b.l)(n,o),r=l.max,i=l.min;return a?Object(b.j)(t)?Number.POSITIVE_INFINITY:Object(b.p)(e[e.length-1].start>r?e[e.length-1].start+1:r):Object(b.k)(t)?Number.NEGATIVE_INFINITY:Object(b.p)(e[0].end<i?e[0].end-1:i)}(e.colorRanges,l,r,c,i);return _(s,e.activePalette,V(r?e.colorRanges.length-1:0,"".concat(u),r?"end":"start",e.colorRanges),i,l);case"addColorRange":var d,p,m=t.payload,v=m.dataBounds;return _(m.palettes,e.activePalette,function(e,t,a){var n=P()(e),o=n.length-1,l=n[o].start,r=n[o].end,i=n[o].color,s=Object(b.l)(t,a).max,c=Math.max(s,r),u=Object(b.p)(Math.min(l+1,c));return u===Number.NEGATIVE_INFINITY&&(u=1),(n=E(n,o,{end:u})).push({color:i,start:u,end:r===u?r+1:r}),n}(e.colorRanges,null!==(d=null===(p=e.activePalette.params)||void 0===p?void 0:p.rangeType)&&void 0!==d?d:b.g,v),v);case"reversePalette":var g=t.payload,j=g.dataBounds;return _(g.palettes,e.activePalette,(ne=e.colorRanges).map((function(e,t){return{color:e.color,start:ne[ne.length-t-1].start,end:ne[ne.length-t-1].end}})).reverse(),j);case"distributeEqually":var y,f,x,O=t.payload,C=O.dataBounds;return _(O.palettes,e.activePalette,function(e,t,a,n){var o=e.length,l=e.length-1,r=Object(b.l)(t,n),i=r.min,s=r.max,c=Object(b.p)((s-i)/o),u=function(e){return Object(b.p)(i+c*e)},d=function(e){return 0===e?Object(b.k)(a)?Number.NEGATIVE_INFINITY:Object(b.p)(i):u(e)},p=function(e){return e===l?Object(b.j)(a)?Number.POSITIVE_INFINITY:Object(b.p)(s):u(e+1)};return e.map((function(e,t){return{color:e.color,start:d(t),end:p(t)}}))}(e.colorRanges,null===(y=e.activePalette.params)||void 0===y?void 0:y.rangeType,null!==(f=null===(x=e.activePalette.params)||void 0===x?void 0:x.continuity)&&void 0!==f?f:b.c,C),C);case"updateColor":var I=t.payload,M=I.index,w=I.color,T=I.palettes,F=I.dataBounds;return _(T,e.activePalette,function(e,t,a){return E(a,e,{color:t})}(M,w,e.colorRanges),F);case"sortColorRanges":var A=t.payload,k=A.dataBounds;return _(A.palettes,e.activePalette,N(e.colorRanges),k);case"updateValue":var L=t.payload,D=L.index,Y=L.value,Z=L.accessor,z=L.dataBounds;return _(L.palettes,e.activePalette,V(D,Y,Z,e.colorRanges),z);case"deleteColorRange":var G=t.payload,H=G.index,W=G.dataBounds;return _(G.palettes,e.activePalette,function(e,t){var a=t.length-1,n=t;return 0!==e&&(e!==a&&(n=E(n,e-1,{end:n[e+1].start})),e===a&&(n=E(n,e-1,{end:t[e].end}))),n.filter((function(t,a){return a!==e}))}(H,e.colorRanges),W);case"updateRangeType":var U=t.payload,q=U.dataBounds,J=U.palettes,K=function(e,t,a,n,o){var l,r,i,s,c=null!==(l=null===(r=t.params)||void 0===r?void 0:r.continuity)&&void 0!==l?l:b.c,u={rangeType:e},d=Object(b.l)(e,a),p=d.min,m=d.max,v=Object(b.l)(null===(i=t.params)||void 0===i?void 0:i.rangeType,a),g=v.min,j=v.max,y=function(e,t){var a=t.newInterval,n=t.oldInterval,o=t.newMin,l=t.oldMin;return(e||[]).map((function(e){var t=e.color,r=e.start,i=Object(b.i)(r,o,l,n,a);return 0===n&&(i=a+o),{color:t,stop:Object(b.p)(i)}}))}(o,{oldInterval:j-g,newInterval:m-p,newMin:p,oldMin:g});if(t.name===b.a){var f=Object(b.n)(n,h()(h()({},t.params),{},{colorStops:y},u),{dataBounds:a});u.colorStops=y,u.stops=f}else u.stops=Object(b.n)(n,h()(h()({},t.params),u),{prevPalette:t.name,dataBounds:a});var x=t.name===b.a?y[y.length-1].stop:u.stops[u.stops.length-1].stop;return u.rangeMin=Object(b.k)(c)?Number.NEGATIVE_INFINITY:t.name===b.a?y[0].stop:u.stops[0].stop,u.rangeMax=Object(b.j)(c)?Number.POSITIVE_INFINITY:null!==(s=t.params)&&void 0!==s&&s.rangeMax?Object(b.i)(t.params.rangeMax,p,g,j-g,m-p):x>m?x+1:m,u}(U.rangeType,e.activePalette,q,J,e.colorRanges);return B(J,R(e.activePalette,K),q);case"changeColorPalette":var Q=t.payload,X=Q.dataBounds,$=Q.palettes,ee=Q.palette,te=Q.disableSwitchingContinuity,ae=function(e,t,a,n,o){var l,r,i,s=e.name===b.a,c=h()(h()({},t.params),{},{name:e.name,colorStops:void 0,continuity:o&&null!==(l=null===(r=t.params)||void 0===r?void 0:r.continuity)&&void 0!==l?l:b.c,reverse:!1}),u=S(a,(null===(i=t.params)||void 0===i?void 0:i.colorStops)||[],t,n);return s&&(c.colorStops=u),h()(h()({},e),{},{params:h()(h()({},c),{},{stops:Object(b.n)(a,c,{prevPalette:s||t.name===b.a?void 0:e.name,dataBounds:n,mapFromMinValue:!0}),rangeMin:Object(b.k)(c.continuity)?Number.NEGATIVE_INFINITY:Math.min(n.min,u[0].stop),rangeMax:Object(b.j)(c.continuity)?Number.POSITIVE_INFINITY:Math.min(n.max,u[u.length-1].stop)})})}(ee,e.activePalette,$,X,te);return B($,ae,X);default:throw new Error("wrong action")}var ne};t.default=function(e){var t,a,n,s,p,m=e.palettes,v=e.activePalette,g=e.setPalette,j=e.dataBounds,f=void 0===j?Object(b.m)(null===(t=v.params)||void 0===t?void 0:t.rangeType):j,h=e.showExtraActions,x=void 0===h||h,O=e.showRangeTypeSelector,C=void 0===O||O,P=e.disableSwitchingContinuity,I=void 0!==P&&P,M=Object(r.useMemo)((function(){return Object(d.htmlIdGenerator)()()}),[]),w=A(m,(null===(a=v.params)||void 0===a?void 0:a.colorStops)||[],v,f),T=Object(r.useReducer)(le,{activePalette:v,colorRanges:w}),N=o()(T,2),E=N[0],V=N[1];c()((function(){var e,t,a;E.activePalette===v&&w===E.colorRanges||(t=E.colorRanges,a="percent"===(null===(e=E.activePalette.params)||void 0===e?void 0:e.rangeType),!Object.values(ne(t,a)).every((function(e){return e.isValid})))||g(E.activePalette)}),250,[E]);var _=Object(d.useEuiTheme)().euiTheme,B=Object(r.useMemo)((function(){return Object(u.css)("padding:",_.size.base,";","")}),[_.size.base]);return Object(u.jsx)("div",{css:B,className:"lnsPalettePanel__section"},Object(u.jsx)(d.EuiFormRow,{display:"rowCompressed",label:l.i18n.translate("coloring.dynamicColoring.palettePicker.label",{defaultMessage:"Color palette"}),fullWidth:!0},Object(u.jsx)(y,{"data-test-subj":"lnsPalettePanel_dynamicColoring_palette_picker",palettes:m,activePalette:E.activePalette,setPalette:function(e){e.name!==v.name&&V({type:"changeColorPalette",payload:{palette:e,dataBounds:f,palettes:m,disableSwitchingContinuity:I}})},showCustomPalette:!0,showDynamicColorOnly:!0})),C&&Object(u.jsx)(d.EuiFormRow,{fullWidth:!0,label:Object(u.jsx)(i.a.Fragment,null,l.i18n.translate("coloring.dynamicColoring.rangeType.label",{defaultMessage:"Value type"})," ",Object(u.jsx)(d.EuiIconTip,{content:l.i18n.translate("coloring.dynamicColoring.customPalette.colorStopsHelpPercentage",{defaultMessage:"Percent value types are relative to the full range of available data values."}),position:"top",size:"s"})),display:"rowCompressed"},Object(u.jsx)(d.EuiButtonGroup,{isFullWidth:!0,legend:l.i18n.translate("coloring.dynamicColoring.rangeType.label",{defaultMessage:"Value type"}),"data-test-subj":"lnsPalettePanel_dynamicColoring_custom_range_groups",name:"dynamicColoringRangeType",buttonSize:"compressed",options:[{id:"".concat(M,"percent"),label:l.i18n.translate("coloring.dynamicColoring.rangeType.percent",{defaultMessage:"Percent"}),"data-test-subj":"lnsPalettePanel_dynamicColoring_rangeType_groups_percent"},{id:"".concat(M,"number"),label:l.i18n.translate("coloring.dynamicColoring.rangeType.number",{defaultMessage:"Number"}),"data-test-subj":"lnsPalettePanel_dynamicColoring_rangeType_groups_number"}],idSelected:null!==(n=E.activePalette.params)&&void 0!==n&&n.rangeType?"".concat(M).concat(null===(s=E.activePalette.params)||void 0===s?void 0:s.rangeType):"".concat(M,"percent"),onChange:function(e){var t=e.replace(M,"");V({type:"updateRangeType",payload:{rangeType:t,dataBounds:f,palettes:m}})}})),Object(u.jsx)(d.EuiFormRow,{label:l.i18n.translate("coloring.dynamicColoring.palettePicker.colorRangesLabel",{defaultMessage:"Color Ranges"}),display:"rowCompressed",fullWidth:!0},Object(u.jsx)(z.Provider,{value:{dataBounds:f,palettes:m,disableSwitchingContinuity:I}},Object(u.jsx)(oe,{showExtraActions:x,paletteConfiguration:null===(p=E.activePalette)||void 0===p?void 0:p.params,colorRanges:E.colorRanges,dispatch:V}))))}}}]);