/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.osquery_bundle_jsonpfunction=window.osquery_bundle_jsonpfunction||[]).push([[2],{102:function(e,t,a){"use strict";a.d(t,"a",(function(){return y}));var r=a(5),n=a.n(r),u=a(20),i=a(0),l=a.n(i),o=a(2),s=a(18),c=a(19),d=a(9),p=a(103);const y=e=>{const{euiFieldProps:t={},idAria:a,helpText:r,...y}=e,{field:{onChange:g,value:M},fieldState:{error:f}}=Object(c.useController)({name:"platform",defaultValue:[]}),m=Object(i.useMemo)((()=>[{id:"linux",label:l.a.createElement(o.EuiFlexGroup,{gutterSize:"s"},l.a.createElement(o.EuiFlexItem,null,l.a.createElement(p.a,{platform:"linux"})),l.a.createElement(o.EuiFlexItem,null,l.a.createElement(s.FormattedMessage,{id:"xpack.osquery.pack.queryFlyoutForm.platformMacOSLabel",defaultMessage:"Linux"})))},{id:"darwin",label:l.a.createElement(o.EuiFlexGroup,{gutterSize:"s"},l.a.createElement(o.EuiFlexItem,null,l.a.createElement(p.a,{platform:"darwin"})),l.a.createElement(o.EuiFlexItem,null,l.a.createElement(s.FormattedMessage,{id:"xpack.osquery.pack.queryFlyoutForm.platformLinusLabel",defaultMessage:"macOS"})))},{id:"windows",label:l.a.createElement(o.EuiFlexGroup,{gutterSize:"s"},l.a.createElement(o.EuiFlexItem,null,l.a.createElement(p.a,{platform:"windows"})),l.a.createElement(o.EuiFlexItem,null,l.a.createElement(s.FormattedMessage,{id:"xpack.osquery.pack.queryFlyoutForm.platformWindowsLabel",defaultMessage:"Windows"})))}]),[]),[j,v]=Object(i.useState)((()=>m.reduce(((e,t)=>{var a;return e[t.id]=!!Object(u.isEmpty)(M)||null!==(a=null==M?void 0:M.includes(t.id))&&void 0!==a&&a,e}),{}))),E=Object(i.useCallback)((e=>{const t={...j,[e]:!j[e]};v(t),g(Object.keys(Object(u.pickBy)(t,(e=>!0===e))).join(","))}),[j,g]),b=Object(i.useMemo)((()=>a?[a]:[]),[a]);Object(i.useEffect)((()=>{v((()=>m.reduce(((e,t)=>{var a;return e[t.id]=!!Object(u.isEmpty)(M)||null!==(a=null==M?void 0:M.includes(t.id))&&void 0!==a&&a,e}),{})))}),[M,m]);const L=Object(i.useMemo)((()=>!(null==f||!f.message)),[null==f?void 0:f.message]);return l.a.createElement(o.EuiFormRow,n()({label:d.i18n.translate("xpack.osquery.pack.queryFlyoutForm.platformFieldLabel",{defaultMessage:"Platform"}),helpText:"function"==typeof r?r():r,error:null==f?void 0:f.message,isInvalid:L,fullWidth:!0,describedByIds:b},y),l.a.createElement(o.EuiCheckboxGroup,n()({idToSelectedMap:j,options:m,onChange:E,"data-test-subj":"input"},t)))}},103:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var r=a(2),n=a(0),u=a.n(n),i=a(104);const l=({platform:e})=>{const t=Object(n.useMemo)((()=>Object(i.a)(e)),[e]);return u.a.createElement(r.EuiIcon,{type:t,title:e,size:"l"})},o=u.a.memo(l)},104:function(e,t,a){"use strict";a.d(t,"a",(function(){return p})),a.d(t,"b",(function(){return y}));var r=a(20),n=a(105),u=a(132),i=a.n(u),l=a(133),o=a.n(l),s=a(134),c=a.n(s),d=a(106);const p=e=>{switch(e){case"darwin":return c.a;case"linux":return i.a;case"windows":return o.a;default:return`${e}`}},y=e=>{let t;try{t=null==e?void 0:e.split(",").map((e=>e.trim()))}catch(e){return}if(t)return Object(r.uniq)(t.reduce(((e,t)=>(n.a.includes(t)?e.push(t):("posix"===t&&(e.push(d.a.darwin),e.push(d.a.linux)),"ubuntu"===t&&e.push(d.a.linux)),e)),[])).join(",")}},105:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var r=a(106);const n=[r.a.darwin,r.a.linux,r.a.windows]},106:function(e,t,a){"use strict";let r;a.d(t,"a",(function(){return r})),function(e){e.darwin="darwin",e.windows="windows",e.linux="linux"}(r||(r={}))},107:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));const r=[{label:"5.0.1"},{label:"4.9.0"},{label:"4.8.0"},{label:"4.7.0"},{label:"4.6.0"},{label:"4.5.1"},{label:"4.5.0"},{label:"4.4.0"},{label:"4.3.0"},{label:"4.2.0"},{label:"4.1.2"},{label:"4.1.1"},{label:"4.0.2"},{label:"3.3.2"},{label:"3.3.0"},{label:"3.2.6"},{label:"3.2.4"},{label:"2.9.0"},{label:"2.8.0"},{label:"2.7.0"},{label:"2.11.2"},{label:"2.11.0"},{label:"2.10.2"},{label:"2.10.0"}]},108:function(e,t,a){"use strict";a.d(t,"a",(function(){return M}));var r=a(42),n=a(2),u=a(0),i=a.n(u),l=a(41),o=a.n(l),s=a(19),c=a(9),d=a(109),p=a(123);const y=o()(n.EuiCodeBlock).withConfig({displayName:"StyledEuiCodeBlock",componentId:"sc-1lwxas-0"})(["min-height:100px;"]),g=({euiFieldProps:e,labelAppend:t,helpText:a})=>{const{field:{onChange:u,value:l},fieldState:{error:o}}=Object(s.useController)({name:"query",rules:{required:{message:c.i18n.translate("xpack.osquery.pack.queryFlyoutForm.emptyQueryError",{defaultMessage:"Query is a required field"}),value:!0}},defaultValue:""});return i.a.createElement(n.EuiFormRow,{label:c.i18n.translate("xpack.osquery.savedQuery.queryEditorLabel",{defaultMessage:"Query"}),labelAppend:Object(r.isEmpty)(t)?i.a.createElement(d.a,null):t,helpText:a,isInvalid:!(null==o||!o.message),error:null==o?void 0:o.message,fullWidth:!0},null!=e&&e.isDisabled?i.a.createElement(y,{language:"sql",fontSize:"m",paddingSize:"m",transparentBackground:!l.length},l):i.a.createElement(p.a,{defaultValue:l,onChange:u}))},M=i.a.memo(g)},113:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var r=a(10),n=a(9),u=a(6),i=a(7),l=a(59),o=a(62),s=a(56);const c=({withRedirect:e})=>{const t=Object(r.useQueryClient)(),{application:{navigateToApp:a},http:c,notifications:{toasts:d}}=Object(u.e)().services,p=Object(s.a)();return Object(r.useMutation)((e=>c.post("/api/osquery/saved_queries",{body:JSON.stringify(e)})),{onError:e=>{p(e,{title:e.body.error,toastMessage:e.body.message})},onSuccess:r=>{var u,s;t.invalidateQueries([o.c]),e&&a(i.PLUGIN_ID,{path:l.a.saved_queries()}),d.addSuccess(n.i18n.translate("xpack.osquery.newSavedQuery.successToastMessageText",{defaultMessage:'Successfully saved "{savedQueryId}" query',values:{savedQueryId:null!==(u=null===(s=r.data.attributes)||void 0===s?void 0:s.id)&&void 0!==u?u:""}}))}})}},120:function(e,t,a){"use strict";a.d(t,"e",(function(){return g})),a.d(t,"b",(function(){return f})),a.d(t,"a",(function(){return v})),a.d(t,"c",(function(){return L})),a.d(t,"d",(function(){return S}));var r=a(5),n=a.n(r),u=a(0),i=a.n(u),l=a(9),o=a(2),s=a(19),c=a(18),d=a(57),p=a.n(d);const y=({euiFieldProps:e={}})=>{const{field:{onChange:t,value:a},fieldState:{error:r}}=Object(s.useController)({name:"version",defaultValue:[],rules:{}}),d=Object(u.useCallback)((e=>{const r=[...a,e];t(r)}),[t,a]),p=Object(u.useCallback)((e=>{t(e.map((e=>e.label)))}),[t]),y=Object(u.useMemo)((()=>!(null==r||!r.message)),[null==r?void 0:r.message]);return i.a.createElement(o.EuiFormRow,{label:i.a.createElement(o.EuiFlexGroup,{gutterSize:"s"},i.a.createElement(o.EuiFlexItem,{grow:!1},i.a.createElement(c.FormattedMessage,{id:"xpack.osquery.pack.queryFlyoutForm.versionFieldLabel",defaultMessage:"Minimum Osquery version"}))),labelAppend:i.a.createElement(o.EuiFlexItem,{grow:!1},i.a.createElement(o.EuiText,{size:"xs",color:"subdued"},i.a.createElement(c.FormattedMessage,{id:"xpack.osquery.queryFlyoutForm.versionFieldOptionalLabel",defaultMessage:"(optional)"}))),error:null==r?void 0:r.message,isInvalid:y,fullWidth:!0},i.a.createElement(o.EuiComboBox,n()({isInvalid:y,noSuggestions:!0,placeholder:l.i18n.translate("xpack.osquery.comboBoxField.placeHolderText",{defaultMessage:'Type and then hit "ENTER"'}),selectedOptions:a.map((e=>({label:e}))),onCreateOption:d,onChange:p,fullWidth:!0,"data-test-subj":"input"},e)))},g=i.a.memo(y,p.a),M=({euiFieldProps:e})=>{const{field:{onChange:t,value:a,name:r},fieldState:{error:c}}=Object(s.useController)({name:"description",defaultValue:""}),d=Object(u.useMemo)((()=>!(null==c||!c.message)),[null==c?void 0:c.message]);return i.a.createElement(o.EuiFormRow,{label:l.i18n.translate("xpack.osquery.pack.form.descriptionFieldLabel",{defaultMessage:"Description (optional)"}),error:null==c?void 0:c.message,isInvalid:d,fullWidth:!0},i.a.createElement(o.EuiFieldText,n()({isInvalid:d,onChange:t,value:a,name:r,fullWidth:!0,"data-test-subj":"input"},e)))},f=i.a.memo(M),m={required:{message:l.i18n.translate("xpack.osquery.pack.queryFlyoutForm.intervalFieldMinNumberError",{defaultMessage:"A positive interval value is required"}),value:!0},min:{message:l.i18n.translate("xpack.osquery.pack.queryFlyoutForm.intervalFieldMinNumberError",{defaultMessage:"A positive interval value is required"}),value:1},max:{message:l.i18n.translate("xpack.osquery.pack.queryFlyoutForm.intervalFieldMaxNumberError",{defaultMessage:"An interval value must be lower than {than}",values:{than:604800}}),value:604800}},j=({euiFieldProps:e})=>{const{field:{onChange:t,value:a},fieldState:{error:r}}=Object(s.useController)({name:"interval",defaultValue:3600,rules:{...m}}),c=Object(u.useCallback)((e=>{const a=e.target.valueAsNumber?e.target.valueAsNumber:0;t(a)}),[t]),d=Object(u.useMemo)((()=>!(null==r||!r.message)),[null==r?void 0:r.message]);return i.a.createElement(o.EuiFormRow,{label:l.i18n.translate("xpack.osquery.pack.queryFlyoutForm.intervalFieldLabel",{defaultMessage:"Interval (s)"}),error:null==r?void 0:r.message,isInvalid:d,fullWidth:!0},i.a.createElement(o.EuiFieldNumber,n()({isInvalid:d,value:a,onChange:c,fullWidth:!0,type:"number","data-test-subj":"input"},e)))},v=i.a.memo(j,p.a),E=/^[a-zA-Z0-9-_]+$/,b=({idSet:e,euiFieldProps:t})=>{const{field:{onChange:a,value:r,name:c},fieldState:{error:d}}=Object(s.useController)({name:"id",defaultValue:"",rules:e&&(y=e,{required:{message:l.i18n.translate("xpack.osquery.pack.queryFlyoutForm.emptyIdError",{defaultMessage:"ID is required"}),value:!0},validate:e=>{const t=(e=>{if(!E.test(e))return l.i18n.translate("xpack.osquery.pack.queryFlyoutForm.invalidIdError",{defaultMessage:"Characters must be alphanumeric, _, or -"})})(e),a=(e=>t=>{if(e.has(t))return l.i18n.translate("xpack.osquery.pack.queryFlyoutForm.uniqueIdError",{defaultMessage:"ID must be unique"})})(y)(e);return t||a}})}),p=Object(u.useMemo)((()=>!(null==d||!d.message)),[null==d?void 0:d.message]);var y;return i.a.createElement(o.EuiFormRow,{label:l.i18n.translate("xpack.osquery.pack.queryFlyoutForm.idFieldLabel",{defaultMessage:"ID"}),error:null==d?void 0:d.message,isInvalid:p,fullWidth:!0},i.a.createElement(o.EuiFieldText,n()({isInvalid:p,onChange:a,value:r,name:c,fullWidth:!0,"data-test-subj":"input"},t)))},L=i.a.memo(b,p.a),N={value:"snapshot",inputDisplay:i.a.createElement(c.FormattedMessage,{id:"xpack.osquery.pack.queryFlyoutForm.resultsTypeField.snapshotValueLabel",defaultMessage:"Snapshot"})},O={value:"differential",inputDisplay:i.a.createElement(c.FormattedMessage,{id:"xpack.osquery.pack.queryFlyoutForm.resultsTypeField.differentialValueLabel",defaultMessage:"Differential"})},h={value:"added_only",inputDisplay:i.a.createElement(c.FormattedMessage,{id:"xpack.osquery.pack.queryFlyoutForm.resultsTypeField.differentialAddedOnlyValueLabel",defaultMessage:"Differential (Ignore removals)"})},T=[N,O,h],x=({euiFieldProps:e={}})=>{const[t,a]=Object(u.useState)(N.value),{defaultValues:r}=Object(s.useFormState)(),{field:{onChange:d,value:p}}=Object(s.useController)({name:"snapshot",defaultValue:null==r?void 0:r.snapshot}),{field:{onChange:y,value:g}}=Object(s.useController)({name:"removed",defaultValue:null==r?void 0:r.removed}),M=Object(u.useCallback)((e=>{e===N.value&&(d(!0),y(!1)),e===O.value&&(d(!1),y(!0)),e===h.value&&(d(!1),y(!1))}),[y,d]);return Object(u.useEffect)((()=>{a((()=>p?N.value:!p&&g?O.value:p||g?N.value:h.value))}),[g,p]),i.a.createElement(o.EuiFormRow,{label:i.a.createElement(o.EuiFlexGroup,{gutterSize:"s",alignItems:"flexEnd"},i.a.createElement(o.EuiFlexItem,{grow:!1},i.a.createElement(c.FormattedMessage,{id:"xpack.osquery.pack.queryFlyoutForm.resultTypeFieldLabel",defaultMessage:"Result type"})),i.a.createElement(o.EuiFlexItem,{grow:!1},i.a.createElement(o.EuiBetaBadge,{label:l.i18n.translate("xpack.osquery.betaBadgeLabel",{defaultMessage:"Beta"}),size:"s"}))),labelAppend:i.a.createElement(o.EuiFlexItem,{grow:!1},i.a.createElement(o.EuiText,{size:"xs",color:"subdued"},i.a.createElement(c.FormattedMessage,{id:"xpack.osquery.queryFlyoutForm.fieldOptionalLabel",defaultMessage:"(optional)"}))),fullWidth:!0},i.a.createElement(o.EuiSuperSelect,n()({"data-test-subj":"resultsTypeField",options:T,fullWidth:!0,valueOfSelected:t,onChange:M},e)))},S=i.a.memo(x,p.a)},122:function(e,t,a){"use strict";a.d(t,"a",(function(){return y})),a.d(t,"c",(function(){return E})),a.d(t,"d",(function(){return L})),a.d(t,"b",(function(){return N}));var r=a(2),n=a(19),u=a(0),i=a.n(u),l=a(18),o=a(73),s=a(98),c=a(113);const d={style:"z-index: 6000"},p=({defaultValue:e,onClose:t,isExternal:a})=>{const p=Object(c.a)({withRedirect:!1}),y=Object(o.b)({defaultValue:e}),{serializer:g,idSet:M,handleSubmit:f,formState:{isSubmitting:m}}=y,j=Object(u.useCallback)((async e=>{const a=g(e);await p.mutateAsync(a).then((()=>t()))}),[p,t,g]);return i.a.createElement(r.EuiPortal,null,i.a.createElement(r.EuiFlyout,{size:"m",ownFocus:!0,onClose:t,"aria-labelledby":"flyoutTitle",maskProps:a?d:void 0},i.a.createElement(r.EuiFlyoutHeader,{hasBorder:!0},i.a.createElement(r.EuiTitle,{size:"s"},i.a.createElement("h2",{id:"flyoutTitle"},i.a.createElement(l.FormattedMessage,{id:"xpack.osquery.savedQuery.saveQueryFlyoutForm.addFormTitle",defaultMessage:"Save query"})))),i.a.createElement(r.EuiFlyoutBody,null,i.a.createElement(n.FormProvider,y,i.a.createElement(s.a,{idSet:M}))),i.a.createElement(r.EuiFlyoutFooter,null,i.a.createElement(r.EuiFlexGroup,{justifyContent:"spaceBetween"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButtonEmpty,{iconType:"cross",onClick:t,flush:"left"},i.a.createElement(l.FormattedMessage,{id:"xpack.osquery.pack.queryFlyoutForm.cancelButtonLabel",defaultMessage:"Cancel"}))),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButton,{isLoading:m,onClick:f(j),fill:!0},i.a.createElement(l.FormattedMessage,{id:"xpack.osquery.pack.queryFlyoutForm.saveButtonLabel",defaultMessage:"Save"})))))))},y=i.a.memo(p);var g=a(10),M=a(7),f=a(6),m=a(59),j=a(56),v=a(62);const E=({savedQueryId:e})=>{const{application:{navigateToApp:t},http:a}=Object(f.e)().services,r=Object(j.a)();return Object(g.useQuery)([v.d,{savedQueryId:e}],(()=>a.get(`/api/osquery/saved_queries/${e}`)),{keepPreviousData:!0,refetchOnWindowFocus:!1,select:e=>e.data,onSuccess:e=>{e.error&&(r(e.error,{title:e.error.error,toastMessage:e.error.message}),t(M.PLUGIN_ID,{path:m.a.saved_queries()}))},onError:e=>{r(e,{title:e.body.error,toastMessage:e.body.message})}})};a(68);var b=a(9);const L=({savedQueryId:e})=>{const t=Object(g.useQueryClient)(),{application:{navigateToApp:a},notifications:{toasts:r},http:n}=Object(f.e)().services,u=Object(j.a)();return Object(g.useMutation)((t=>n.put(`/api/osquery/saved_queries/${e}`,{body:JSON.stringify(t)})),{onError:e=>{u(e,{title:e.body.error,toastMessage:e.body.message})},onSuccess:n=>{var u,i;t.invalidateQueries([v.c]),t.invalidateQueries([v.d,{savedQueryId:e}]),a(M.PLUGIN_ID,{path:m.a.saved_queries()}),r.addSuccess(b.i18n.translate("xpack.osquery.editSavedQuery.successToastMessageText",{defaultMessage:'Successfully updated "{savedQueryName}" query',values:{savedQueryName:null!==(u=null===(i=n.data.attributes)||void 0===i?void 0:i.id)&&void 0!==u?u:""}}))}})},N=({savedQueryId:e})=>{const t=Object(g.useQueryClient)(),{application:{navigateToApp:a},http:r,notifications:{toasts:n}}=Object(f.e)().services,u=Object(j.a)();return Object(g.useMutation)((()=>r.delete(`/api/osquery/saved_queries/${e}`)),{onError:e=>{u(e,{title:e.body.error,toastMessage:e.body.message})},onSuccess:()=>{t.invalidateQueries([v.c]),a(M.PLUGIN_ID,{path:m.a.saved_queries()}),n.addSuccess(b.i18n.translate("xpack.osquery.editSavedQuery.deleteSuccessToastMessageText",{defaultMessage:"Successfully deleted saved query"}))}})}},132:function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzMDQuOTk4IDMwNC45OTgiPjxwYXRoIGQ9Ik0yNzQuNjU5IDI0NC44ODhjLTguOTQ0LTMuNjYzLTEyLjc3LTguNTI0LTEyLjQtMTUuNzc3LjM4MS04LjQ2Ni00LjQyMi0xNC42NjctNi43MDMtMTcuMTE3IDEuMzc4LTUuMjY0IDUuNDA1LTIzLjQ3NC4wMDQtMzkuMjkxLTUuODA0LTE2LjkzLTIzLjUyNC00Mi43ODctNDEuODA4LTY4LjIwNC03LjQ4NS0xMC40MzgtNy44MzktMjEuNzg0LTguMjQ4LTM0LjkyMi0uMzkyLTEyLjUzMS0uODM0LTI2LjczNS03LjgyMi00Mi41MjVDMTkwLjA4NCA5Ljg1OSAxNzQuODM4IDAgMTU1Ljg1MSAwYy0xMS4yOTUgMC0yMi44ODkgMy41My0zMS44MTEgOS42ODQtMTguMjcgMTIuNjA5LTE1Ljg1NSA0MC4xLTE0LjI1NyA1OC4yOTEuMjE5IDIuNDkxLjQyNSA0Ljg0NC41NDUgNi44NTMgMS4wNjQgMTcuODE2LjA5NiAyNy4yMDYtMS4xNyAzMC4wNi0uODE5IDEuODY1LTQuODUxIDcuMTczLTkuMTE4IDEyLjc5My00LjQxMyA1LjgxMi05LjQxNiAxMi40LTEzLjUxNyAxOC41MzktNC44OTMgNy4zODctOC44NDMgMTguNjc4LTEyLjY2MyAyOS41OTctMi43OTUgNy45OS01LjQzNSAxNS41MzctOC4wMDUgMjAuMDQ3YTI3LjI5NiAyNy4yOTYgMCAwMC0yLjY0NyAyMC41MDVjLTEuODQ0IDEuMjgxLTQuNTA4IDMuODAzLTYuNzU3IDguNTU3LTIuNzE4IDUuOC04LjIzMyA4LjkxNy0xOS43MDEgMTEuMTIyLTUuMjcgMS4wNzgtOC45MDQgMy4yOTQtMTAuODA0IDYuNTg2LTIuNzY1IDQuNzkxLTEuMjU5IDEwLjgxMS4xMTUgMTQuOTI1IDIuMDMgNi4wNDguNzY1IDkuODc2LTEuNTM1IDE2LjgyNi0uNTMgMS42MDQtMS4xMzEgMy40Mi0xLjc0IDUuNDIzLS45NTkgMy4xNjEtLjYxMyA2LjAzNSAxLjAyNiA4LjU0MiA0LjMzMSA2LjYyMSAxNi45NjkgOC45NTYgMjkuOTc5IDEwLjQ5MiA3Ljc2OC45MjIgMTYuMjcgNC4wMjkgMjQuNDkzIDcuMDM1IDguMDU3IDIuOTQ0IDE2LjM4OCA1Ljk4OSAyMy45NjEgNi45MTMgMS4xNTEuMTQ1IDIuMjkxLjIxOCAzLjM5LjIxOCAxMS40MzQgMCAxNi42LTcuNTg3IDE4LjIzOC0xMC43MDQgNC4xMDctLjgzOCAxOC4yNzItMy41MjIgMzIuODcxLTMuODgyIDE0LjU3Ni0uNDE2IDI4LjY3OSAyLjQ2MiAzMi42NzQgMy4zNTcgMS4yNTYgMi40MDQgNC41NjcgNy44OTUgOS44NDUgMTAuNzI0IDIuOTAxIDEuNTg2IDYuOTM4IDIuNDk1IDExLjA3MyAyLjQ5NWguMDAxYzQuNDE2IDAgMTIuODE3LTEuMDQ0IDE5LjQ2Ni04LjAzOSA2LjYzMi03LjAyOCAyMy4yMDItMTYgMzUuMzAyLTIyLjU1MWE3MTcuODcgNzE3Ljg3IDAgMDA3LjQ0MS00LjA2NWM2Ljc5Ny0zLjc2OCAxMC41MDYtOS4xNTIgMTAuMTc1LTE0Ljc3MS0uMjc2LTQuNjY3LTMuMzY1LTguNzYxLTguMDYyLTEwLjY4NHptLTE1MC40Ny0xLjM1M2MtLjg0Ni01Ljk2LTguNTEzLTExLjg3MS0xNy4zOTItMTguNzE1LTcuMjYtNS41OTctMTUuNDg5LTExLjk0LTE3Ljc1Ni0xNy4zMTItNC42ODUtMTEuMDgyLS45OTItMzAuNTY4IDUuNDQ3LTQwLjYwMiAzLjE4Mi01LjAyNCA1Ljc4MS0xMi42NDMgOC4yOTUtMjAuMDExIDIuNzE0LTcuOTU2IDUuNTIxLTE2LjE4MiA4LjY2LTE5Ljc4MyA0Ljk3MS01LjYyMiA5LjU2NS0xNi41NjEgMTAuMzc5LTI1LjE4MiA0LjY1NSA0LjQ0NCAxMS44NzYgMTAuMDgzIDE4LjU0NyAxMC4wODMgMS4wMjcgMCAyLjAyNC0uMTM0IDIuOTc3LS40MDMgNC41NjQtMS4zMTggMTEuMjc3LTUuMTk3IDE3Ljc2OS04Ljk0NyA1LjU5Ny0zLjIzNCAxMi40OTktNy4yMjIgMTUuMDk2LTcuNTg1IDQuNDUzIDYuMzk0IDMwLjMyOCA2My42NTUgMzIuOTcyIDgyLjA0NCAyLjA5MiAxNC41NS0uMTE4IDI2LjU3OC0xLjIyOSAzMS4yODlhMjMuMDE3IDIzLjAxNyAwIDAwLTMuMDgtLjIyMWMtNy4yMDcgMC05LjExNSAzLjkzNC05LjYxMiA2LjI4My0xLjI3OCA2LjEwMy0xLjQxMyAyNS42MTgtMS40MjcgMzAuMDAzLTIuNjA2IDMuMzExLTE1Ljc4NSAxOC45MDMtMzQuNzA2IDIxLjcwNi03LjcwNyAxLjEyLTE0LjkwNCAxLjY4OC0yMS4zOSAxLjY4OC01LjU0NCAwLTkuMDgyLS40MjgtMTAuNTUxLS42NTFsLTkuNTA4LTEwLjg3OWMzLjc0OS0xLjg1MSA3LjQ5Ny01Ljc1NyA2LjUwOS0xMi44MDV6bTEyLjA2NS0xNzkuMzg2Yy0uMjk3LjEyOC0uNTg5LjI2NS0uODc2LjQxMWExNy43MTMgMTcuNzEzIDAgMDAtLjE5OS0xLjk1MmMtMS4wMzgtNS45NzUtNS0xMC4zMTItOS40MTktMTAuMzEyLS4zMjcgMC0uNjU2LjAyNS0xLjAxNy4wOC0yLjYyOS40MzgtNC42OTEgMi40MTMtNS44MjEgNS4yMTMuOTkxLTYuMTQ0IDQuNDcyLTEwLjY5MyA4LjYwMi0xMC42OTMgNC44NSAwIDguOTQ3IDYuNTM2IDguOTQ3IDE0LjI3MiAwIC45NzUtLjA3MSAxLjk0NS0uMjE3IDIuOTgxem0zNy42ODYgNC42MDdjLjQ0NC0xLjQxNC42ODQtMi45NDQuNjg0LTQuNTMyIDAtNy4wMTQtNC40NS0xMi41MDktMTAuMTMxLTEyLjUwOS01LjU1MiAwLTEwLjA2OSA1LjYxMS0xMC4wNjkgMTIuNTA5IDAgLjQ3LjAyMy45NDEuMDY3IDEuNDExbC0uODYxLS4zMjlhMTkuMTI1IDE5LjEyNSAwIDAxLS45NjItNi4wMTVjMC04LjM4NyA1LjM2LTE1LjIxMSAxMS45NS0xNS4yMTEgNi41ODkgMCAxMS45NSA2LjgyNCAxMS45NSAxNS4yMTEgMCAzLjQ4OS0uOTYzIDYuODE5LTIuNjI4IDkuNDY1em0tNC44NTkgMTYuMzI0Yy0uMDk1LjQyNC0uMjk3LjYxMi0yLjUzMSAxLjc3NC0xLjEyOC41ODctMi41MzIgMS4zMTgtNC4yODkgMi4zODhsLTEuMTc0LjcxMWMtNC43MTggMi44Ni0xNS43NjUgOS41NTktMTguNzY0IDkuOTUyLTIuMDM3LjI3NC0zLjI5Ny0uNTE2LTYuMTMtMi40NDFhODguNDQxIDg4LjQ0MSAwIDAwLTIuMDQ0LTEuMzYyYy01LjEwNy0zLjM1MS04LjM5Mi03LjA0Mi04Ljc2My04LjQ4NSAxLjY2NS0xLjI4NyA1Ljc5Mi00LjUwOCA3LjkwNS02LjQxNSA0LjI4OS0zLjk4OCA4LjYwNS02LjY2OCAxMC43NDEtNi42NjguMTEzIDAgLjIxNS4wMDguMzIxLjAyOCAyLjUxLjQ0MyA4LjcwMSAyLjkxNCAxMy4yMjMgNC43MTggMi4wOS44MzQgMy44OTUgMS41NTQgNS4xNjUgMi4wMSA0LjAwMSAxLjM3NCA2LjA4NyAzLjEzMiA2LjM0IDMuNzl6bTM1Ljk0NyAxODYuMzdjMi4yNTctMTAuMTgxIDQuODU3LTI0LjAzMSA0LjQzNi0zMi4xOTYtLjA5Ny0xLjg1NS0uMjYxLTMuODc0LS40Mi01LjgyNi0uMjk3LTMuNjUtLjczOC05LjA3NS0uMjgzLTEwLjY4NC4wOS0uMDQyLjE5LS4wNzguMzAxLS4xMDkuMDE5IDQuNjY4IDEuMDMzIDEzLjk3OSA4LjQ3OSAxNy4yMjYgMi4yMTkuOTY4IDQuNzU1IDEuNDU4IDcuNTM3IDEuNDU4IDcuNDU5IDAgMTUuNzM1LTMuNjU5IDE5LjEyNS03LjA0OSAxLjk5Ni0xLjk5NiAzLjY3NS00LjQzOCA0Ljg1MS02LjM3Mi4yNTcuNzUzLjQxNSAxLjczNy4zMzIgMy4wMDUtLjQ0MyA2Ljg4NSAyLjkwMyAxNi4wMTkgOS4yNzEgMTkuMzg1bC45MjcuNDg3YzIuMjY4IDEuMTkgOC4yOTIgNC4zNTMgOC4zODkgNS44NTMtLjAwMS4wMDEtLjA1MS4xNzctLjM4Ny40ODktMS41MDkgMS4zNzktNi44MiA0LjA5MS0xMS45NTYgNi43MTQtOS4xMTEgNC42NTItMTkuNDM4IDkuOTI1LTI0LjA3NiAxNC44MDMtNi41MyA2Ljg3Mi0xMy45MTYgMTEuNDg4LTE4LjM3NiAxMS40ODhhNC44MyA0LjgzIDAgMDEtMS40NjEtLjIwNmMtNC44NDQtMS41MS04LjgzMS04LjQ5OS02LjY4OS0xOC40NjZ6TTM5LjkxNyAyNDUuNDc3Yy0uNDk0LTIuMzEyLS44ODQtNC4xMzctLjQ2NS01LjkwNS4zMDQtMS4zMSA2Ljc3MS0yLjcxNCA5LjUzMy0zLjMxMyAzLjg4My0uODQzIDcuODk5LTEuNzE0IDEwLjUyNS0zLjMwOCAzLjU1MS0yLjE1MSA1LjQ3NC02LjExOCA3LjE3LTkuNjE4IDEuMjI4LTIuNTMxIDIuNDk2LTUuMTQ4IDQuMDA1LTYuMDA3LjA4NS0uMDUuMjE1LS4xMDguNDYzLS4xMDggMi44MjcgMCA4Ljc1OSA1Ljk0MyAxMi4xNzcgMTEuMjYyLjg2NyAxLjM0MSAyLjQ3MyA0LjAyOCA0LjMzMSA3LjEzOSA1LjU1NyA5LjI5OCAxMy4xNjYgMjIuMDMzIDE3LjE0IDI2LjMwMSAzLjU4MSAzLjgzNyA5LjM3OCAxMS4yMTQgNy45NTIgMTcuNTQxLTEuMDQ0IDQuOTA5LTYuNjAyIDguOTAxLTcuOTEzIDkuNzg0LS40NzYuMTA4LTEuMDY1LjE2My0xLjc1OC4xNjMtNy42MDYgMC0yMi42NjItNi4zMjgtMzAuNzUxLTkuNzI4bC0xLjE5Ny0uNTAzYy00LjUxNy0xLjg5NC0xMS44OTEtMy4wODctMTkuMDIyLTQuMjQxLTUuNjc0LS45MTktMTMuNDQ0LTIuMTc2LTE0LjczMi0zLjMxMi0xLjA0NC0xLjE3MS4xNjctNC45NzggMS4yMzUtOC4zMzcuNzY5LTIuNDE0IDEuNTYzLTQuOTEgMS45OTgtNy41MjMuNjE3LTQuMTY4LS4xMDktNy41NjEtLjY5MS0xMC4yODd6Ii8+PC9zdmc+"},133:function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2NCIgaGVpZ2h0PSI2NCIgc2hhcGUtcmVuZGVyaW5nPSJnZW9tZXRyaWNQcmVjaXNpb24iIHRleHQtcmVuZGVyaW5nPSJnZW9tZXRyaWNQcmVjaXNpb24iIGltYWdlLXJlbmRlcmluZz0ib3B0aW1pemVRdWFsaXR5IiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgdmlld0JveD0iMCAwIDY0MCA2NDAiPjxwYXRoIGQ9Ik0uMiAyOTguNjY5TDAgOTAuNjE1bDI1Ni4wMDctMzQuNzZ2MjQyLjgxNEguMjAxek0yOTguNjU4IDQ5LjY1NEw2MzkuOTA1LS4wMTJ2Mjk4LjY4MUgyOTguNjU3VjQ5LjY1NHpNNjQwIDM0MS4zMzFsLS4wNzEgMjk4LjY4MUwyOTguNjY5IDU5MlYzNDEuMzMyaDM0MS4zM3pNMjU1Ljk4MyA1ODYuNTQzTC4xODkgNTUxLjQ2M3YtMjEwLjE4aDI1NS43OTR2MjQ1LjI2eiIvPjwvc3ZnPg=="},134:function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2NCIgaGVpZ2h0PSI2NCIgc2hhcGUtcmVuZGVyaW5nPSJnZW9tZXRyaWNQcmVjaXNpb24iIHRleHQtcmVuZGVyaW5nPSJnZW9tZXRyaWNQcmVjaXNpb24iIGltYWdlLXJlbmRlcmluZz0ib3B0aW1pemVRdWFsaXR5IiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgdmlld0JveD0iMCAwIDY0MCA2NDAiPjxwYXRoIGQ9Ik00OTQuNzgyIDM0MC4wMmMtLjgwMy04MS4wMjUgNjYuMDg0LTExOS45MDcgNjkuMDcyLTEyMS44MzItMzcuNTk1LTU0Ljk5My05Ni4xNjctNjIuNTUyLTExNy4wMzctNjMuNDAyLTQ5Ljg0My01LjAzMi05Ny4yNDIgMjkuMzYyLTEyMi41NjUgMjkuMzYyLTI1LjI1MyAwLTY0LjI3Ny0yOC42MDctMTA1LjYwNC0yNy44NS01NC4zMi44MDMtMTA0LjQgMzEuNTk0LTEzMi40MDMgODAuMjQ1QzI5LjgxIDMzNC40NTcgNzEuODEgNDc5LjU4IDEyNi44MTYgNTU4Ljk3NmMyNi44NyAzOC44ODIgNTguOTE0IDgyLjU2IDEwMC45OTcgODEgNDAuNTEyLTEuNTk0IDU1Ljg0My0yNi4yNDQgMTA0Ljg0OC0yNi4yNDQgNDguOTkzIDAgNjIuNzUzIDI2LjI0NSAxMDUuNjQgMjUuNDA2IDQzLjYwNi0uODAzIDcxLjIzMi0zOS42MzggOTcuOTI1LTc4LjY1IDMwLjg4Ny00NS4xMiA0My41NDgtODguNzUgNDQuMzE2LTkwLjk5NC0uOTY5LS40MzctODUuMDI5LTMyLjYzNC04NS44NzktMTI5LjQzOWwuMTE4LS4wMzV6TTQxNC4yMyAxMDIuMTc4QzQzNi41NTMgNzUuMDk1IDQ1MS42MzYgMzcuNSA0NDcuNTE0LS4wMjRjLTMyLjE2MiAxLjMxMS03MS4xNjMgMjEuNDM3LTk0LjI1MyA0OC40ODUtMjAuNzI5IDI0LjAxMi0zOC44MzYgNjIuMjgtMzMuOTkzIDk5LjAzNiAzNS45MTggMi44IDcyLjU5MS0xOC4yNDggOTQuOTI2LTQ1LjI3MmwuMDM2LS4wNDd6Ii8+PC9zdmc+"},57:function(e,t,a){"use strict";e.exports=function e(t,a){if(t===a)return!0;if(t&&a&&"object"==typeof t&&"object"==typeof a){if(t.constructor!==a.constructor)return!1;var r,n,u;if(Array.isArray(t)){if((r=t.length)!=a.length)return!1;for(n=r;0!=n--;)if(!e(t[n],a[n]))return!1;return!0}if(t.constructor===RegExp)return t.source===a.source&&t.flags===a.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===a.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===a.toString();if((r=(u=Object.keys(t)).length)!==Object.keys(a).length)return!1;for(n=r;0!=n--;)if(!Object.prototype.hasOwnProperty.call(a,u[n]))return!1;for(n=r;0!=n--;){var i=u[n];if(!e(t[i],a[i]))return!1}return!0}return t!=t&&a!=a}},59:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));const r={base:()=>"/",overview:()=>"/",live_queries:()=>"/live_queries",live_query_new:()=>"/live_queries/new",live_query_details:({liveQueryId:e})=>`/live_queries/${e}`,saved_queries:()=>"/saved_queries",saved_query_new:()=>"/saved_queries/new",saved_query_edit:({savedQueryId:e})=>`/saved_queries/${e}`,packs:()=>"/packs",pack_add:()=>"/packs/add",pack_details:({packId:e})=>`/packs/${e}`,pack_edit:({packId:e})=>`/packs/${e}/edit`}},60:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));const r="packList"},61:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var r=a(10),n=a(6),u=a(60);const i=({isLive:e=!1,pageIndex:t=0,pageSize:a=100,sortField:i="updated_at",sortOrder:l="desc"})=>{const{http:o}=Object(n.e)().services;return Object(r.useQuery)([u.a,{pageIndex:t,pageSize:a,sortField:i,sortOrder:l}],(()=>o.get("/api/osquery/packs",{query:{pageIndex:t,pageSize:a,sortField:i,sortOrder:l}})),{keepPreviousData:!0,refetchInterval:!!e&&1e4})}},63:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));const r={overflow:"auto"}},69:function(e,t,a){"use strict";e.exports=a(85)},70:function(e,t,a){"use strict";var r=a(88);a.d(t,"a",(function(){return r.a}));var n=a(89);a.d(t,"b",(function(){return n.a}))},73:function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return c}));var r=a(19),n=a(20),u=a(69),i=a.n(u),l=a(0),o=a(68);const s=e=>i()(e,(e=>(Object(n.isArray)(e.version)&&(e.version.length?e.version=e.version[0]:e.version=""),Object(n.isArray)(e.platform)&&!e.platform.length&&delete e.platform,e.interval&&(e.interval=e.interval+""),e))),c=({defaultValue:e})=>{const{data:t}=Object(o.a)({}),a=Object(l.useMemo)((()=>{var e;return null!==(e=Object(n.map)(null==t?void 0:t.data,"attributes.id"))&&void 0!==e?e:[]}),[t]),u=Object(l.useMemo)((()=>{const t=new Set(a);return e&&e.id&&t.delete(e.id),t}),[a,e]);return{serializer:s,idSet:u,...Object(r.useForm)({defaultValues:e?(i=e,{id:i.id,description:i.description,query:i.query,interval:i.interval?parseInt(i.interval,10):3600,snapshot:null===(c=i.snapshot)||void 0===c||c,removed:null!==(d=i.removed)&&void 0!==d&&d,platform:i.platform,version:i.version?[i.version]:[],ecs_mapping:Object(n.isEmpty)(i.ecs_mapping)?{}:i.ecs_mapping}):{id:"",query:"",interval:3600,ecs_mapping:{},snapshot:!0}})};var i,c,d}},75:function(e,t,a){"use strict";a.d(t,"g",(function(){return n})),a.d(t,"d",(function(){return u})),a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return l})),a.d(t,"c",(function(){return o})),a.d(t,"f",(function(){return s})),a.d(t,"e",(function(){return c}));var r=a(9);const n=e=>0===e?"":1===e?r.i18n.translate("xpack.osquery.agents.oneSelectedAgentText",{defaultMessage:"{numAgents} agent selected.",values:{numAgents:e}}):r.i18n.translate("xpack.osquery.agents.mulitpleSelectedAgentsText",{defaultMessage:"{numAgents} agents selected.",values:{numAgents:e}}),u=r.i18n.translate("xpack.osquery.agents.allAgentsLabel",{defaultMessage:"All agents"}),i=r.i18n.translate("xpack.osquery.agents.platformLabel",{defaultMessage:"Platform"}),l=r.i18n.translate("xpack.osquery.agents.policyLabel",{defaultMessage:"Policy"}),o=(r.i18n.translate("xpack.osquery.agents.agent",{defaultMessage:"Agent"}),r.i18n.translate("xpack.osquery.agents.selectionLabel",{defaultMessage:"Agents"})),s=(r.i18n.translate("xpack.osquery.agents.query",{defaultMessage:"Query"}),r.i18n.translate("xpack.osquery.agents.selectAgentLabel",{defaultMessage:"Select agents or groups to query"})),c=(r.i18n.translate("xpack.osquery.agents.errorSearchDescription",{defaultMessage:"An error has occurred on all agents search"}),r.i18n.translate("xpack.osquery.agents.failSearchDescription",{defaultMessage:"Failed to fetch agents"}),r.i18n.translate("xpack.osquery.agent.attachedQuery",{defaultMessage:"attached query"}))},81:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var r=a(2),n=a(0),u=a.n(n),i=a(9),l=a(41),o=a.n(l),s=a(19);const c=o()(r.EuiCard).withConfig({displayName:"StyledEuiCard",componentId:"sc-sv3i26-0"})(["padding-bottom:60px;position:relative;button{position:absolute;bottom:0;}padding:16px 92px 16px 16px !important;.euiTitle{font-size:1rem;}.euiText{margin-top:0;color:",";}> button[role='switch']{left:auto;height:100% !important;width:80px;right:0;border-radius:0 5px 5px 0;> span{> svg{width:18px;height:18px;display:inline-block !important;}> :not(svg){display:none;}}}button[aria-checked='false'] > span > svg{display:none;}"],(e=>e.theme.eui.euiTextSubduedColor)),d=({canRunSingleQuery:e,canRunPacks:t})=>{const{field:{value:a,onChange:l}}=Object(s.useController)({name:"queryType",defaultValue:"query",rules:{deps:["packId","query"]}}),o=Object(n.useCallback)((e=>{l(e)}),[l]),d=Object(n.useMemo)((()=>({onClick:()=>o("query"),isSelected:"query"===a,iconType:"check"})),[a,o]),p=Object(n.useMemo)((()=>({onClick:()=>o("pack"),isSelected:"pack"===a,iconType:"check"})),[a,o]);return u.a.createElement(r.EuiFlexItem,null,u.a.createElement(r.EuiFormRow,{label:"Query type",fullWidth:!0},u.a.createElement(r.EuiFlexGroup,{gutterSize:"m"},u.a.createElement(r.EuiFlexItem,null,u.a.createElement(c,{layout:"horizontal",title:i.i18n.translate("xpack.osquery.liveQuery.queryForm.singleQueryTypeLabel",{defaultMessage:"Single query"}),titleSize:"xs",hasBorder:!0,description:i.i18n.translate("xpack.osquery.liveQuery.queryForm.singleQueryTypeDescription",{defaultMessage:"Run a saved query or new one."}),selectable:d,isDisabled:!e})),u.a.createElement(r.EuiFlexItem,null,u.a.createElement(c,{layout:"horizontal",title:i.i18n.translate("xpack.osquery.liveQuery.queryForm.packQueryTypeLabel",{defaultMessage:"Pack"}),titleSize:"xs",hasBorder:!0,description:i.i18n.translate("xpack.osquery.liveQuery.queryForm.packQueryTypeDescription",{defaultMessage:"Run a set of queries in a pack."}),selectable:p,isDisabled:!t})))))}},85:function(e,t){function a(e){for(var t=arguments.length,a=Array(t>1?t-1:0),r=1;r<t;r++)a[r-1]=arguments[r];throw Error("[Immer] minified error nr: "+e+(a.length?" "+a.map((function(e){return"'"+e+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function r(e){return!!e&&!!e[Z]}function n(e){return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;var a=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return a===Object||"function"==typeof a&&Function.toString.call(a)===$}(e)||Array.isArray(e)||!!e[B]||!!e.constructor[B]||d(e)||p(e))}function u(e,t,a){void 0===a&&(a=!1),0===i(e)?(a?Object.keys:X)(e).forEach((function(r){a&&"symbol"==typeof r||t(r,e[r],e)})):e.forEach((function(a,r){return t(r,a,e)}))}function i(e){var t=e[Z];return t?t.t>3?t.t-4:t.t:Array.isArray(e)?1:d(e)?2:p(e)?3:0}function l(e,t){return 2===i(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function o(e,t){return 2===i(e)?e.get(t):e[t]}function s(e,t,a){var r=i(e);2===r?e.set(t,a):3===r?(e.delete(t),e.add(a)):e[t]=a}function c(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function d(e){return R&&e instanceof Map}function p(e){return W&&e instanceof Set}function y(e){return e.i||e.u}function g(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=J(e);delete t[Z];for(var a=X(t),r=0;r<a.length;r++){var n=a[r],u=t[n];!1===u.writable&&(u.writable=!0,u.configurable=!0),(u.get||u.set)&&(t[n]={configurable:!0,writable:!0,enumerable:u.enumerable,value:e[n]})}return Object.create(Object.getPrototypeOf(e),t)}function M(e,t){return void 0===t&&(t=!1),m(e)||r(e)||!n(e)||(i(e)>1&&(e.set=e.add=e.clear=e.delete=f),Object.freeze(e),t&&u(e,(function(e,t){return M(t,!0)}),!0)),e}function f(){a(2)}function m(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function j(e){var t=K[e];return t||a(18,e),t}function v(e,t){K[e]||(K[e]=t)}function E(){return Y}function b(e,t){t&&(j("Patches"),e.o=[],e.v=[],e.s=t)}function L(e){N(e),e.p.forEach(h),e.p=null}function N(e){e===Y&&(Y=e.l)}function O(e){return Y={p:[],l:Y,h:e,_:!0,m:0}}function h(e){var t=e[Z];0===t.t||1===t.t?t.j():t.O=!0}function T(e,t){t.m=t.p.length;var r=t.p[0],u=void 0!==e&&e!==r;return t.h.S||j("ES5").P(t,e,u),u?(r[Z].M&&(L(t),a(4)),n(e)&&(e=x(t,e),t.l||I(t,e)),t.o&&j("Patches").g(r[Z].u,e,t.o,t.v)):e=x(t,r,[]),L(t),t.o&&t.s(t.o,t.v),e!==G?e:void 0}function x(e,t,a){if(m(t))return t;var r=t[Z];if(!r)return u(t,(function(n,u){return S(e,r,t,n,u,a)}),!0),t;if(r.A!==e)return t;if(!r.M)return I(e,r.u,!0),r.u;if(!r.R){r.R=!0,r.A.m--;var n=4===r.t||5===r.t?r.i=g(r.k):r.i;u(3===r.t?new Set(n):n,(function(t,u){return S(e,r,n,t,u,a)})),I(e,n,!1),a&&e.o&&j("Patches").F(r,a,e.o,e.v)}return r.i}function S(e,t,a,u,i,o){if(r(i)){var c=x(e,i,o&&t&&3!==t.t&&!l(t.D,u)?o.concat(u):void 0);if(s(a,u,c),!r(c))return;e._=!1}if(n(i)&&!m(i)){if(!e.h.K&&e.m<1)return;x(e,i),t&&t.A.l||I(e,i)}}function I(e,t,a){void 0===a&&(a=!1),e.h.K&&e._&&M(t,a)}function A(e,t){var a=e[Z];return(a?y(a):e)[t]}function D(e,t){if(t in e)for(var a=Object.getPrototypeOf(e);a;){var r=Object.getOwnPropertyDescriptor(a,t);if(r)return r;a=Object.getPrototypeOf(a)}}function k(e){e.M||(e.M=!0,e.l&&k(e.l))}function z(e){e.i||(e.i=g(e.u))}function w(e,t,a){var r=d(t)?j("MapSet").$(t,a):p(t)?j("MapSet").C(t,a):e.S?function(e,t){var a=Array.isArray(e),r={t:a?1:0,A:t?t.A:E(),M:!1,R:!1,D:{},l:t,u:e,k:null,i:null,j:null,I:!1},n=r,u=ee;a&&(n=[r],u=te);var i=Proxy.revocable(n,u),l=i.revoke,o=i.proxy;return r.k=o,r.j=l,o}(t,a):j("ES5").J(t,a);return(a?a.A:E()).p.push(r),r}function C(e){return r(e)||a(22,e),function e(t){if(!n(t))return t;var a,r=t[Z],l=i(t);if(r){if(!r.M&&(r.t<4||!j("ES5").N(r)))return r.u;r.R=!0,a=F(t,l),r.R=!1}else a=F(t,l);return u(a,(function(t,n){r&&o(r.u,t)===n||s(a,t,e(n))})),3===l?new Set(a):a}(e)}function F(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return g(e)}function Q(){function e(e,t){var a=i[e];return a?a.enumerable=t:i[e]=a={configurable:!0,enumerable:t,get:function(){return ee.get(this[Z],e)},set:function(t){ee.set(this[Z],e,t)}},a}function t(e){for(var t=e.length-1;t>=0;t--){var r=e[t][Z];if(!r.M)switch(r.t){case 5:n(r)&&k(r);break;case 4:a(r)&&k(r)}}}function a(e){for(var t=e.u,a=e.k,r=X(a),n=r.length-1;n>=0;n--){var u=r[n];if(u!==Z){var i=t[u];if(void 0===i&&!l(t,u))return!0;var o=a[u],s=o&&o[Z];if(s?s.u!==i:!c(o,i))return!0}}var d=!!t[Z];return r.length!==X(t).length+(d?0:1)}function n(e){var t=e.k;if(t.length!==e.u.length)return!0;var a=Object.getOwnPropertyDescriptor(t,t.length-1);if(a&&!a.get)return!0;for(var r=0;r<t.length;r++)if(!t.hasOwnProperty(r))return!0;return!1}var i={};v("ES5",{J:function(t,a){var r=Array.isArray(t),n=function(t,a){if(t){for(var r=Array(a.length),n=0;n<a.length;n++)Object.defineProperty(r,""+n,e(n,!0));return r}var u=J(a);delete u[Z];for(var i=X(u),l=0;l<i.length;l++){var o=i[l];u[o]=e(o,t||!!u[o].enumerable)}return Object.create(Object.getPrototypeOf(a),u)}(r,t),u={t:r?5:4,A:a?a.A:E(),M:!1,R:!1,D:{},l:a,u:t,k:n,i:null,O:!1,I:!1};return Object.defineProperty(n,Z,{value:u,writable:!0}),n},P:function(e,a,i){i?r(a)&&a[Z].A===e&&t(e.p):(e.o&&function e(t){if(t&&"object"==typeof t){var a=t[Z];if(a){var r=a.u,i=a.k,o=a.D,s=a.t;if(4===s)u(i,(function(t){t!==Z&&(void 0!==r[t]||l(r,t)?o[t]||e(i[t]):(o[t]=!0,k(a)))})),u(r,(function(e){void 0!==i[e]||l(i,e)||(o[e]=!1,k(a))}));else if(5===s){if(n(a)&&(k(a),o.length=!0),i.length<r.length)for(var c=i.length;c<r.length;c++)o[c]=!1;else for(var d=r.length;d<i.length;d++)o[d]=!0;for(var p=Math.min(i.length,r.length),y=0;y<p;y++)i.hasOwnProperty(y)||(o[y]=!0),void 0===o[y]&&e(i[y])}}}}(e.p[0]),t(e.p))},N:function(e){return 4===e.t?a(e):n(e)}})}function q(){function e(t){if(!n(t))return t;if(Array.isArray(t))return t.map(e);if(d(t))return new Map(Array.from(t.entries()).map((function(t){return[t[0],e(t[1])]})));if(p(t))return new Set(Array.from(t).map(e));var a=Object.create(Object.getPrototypeOf(t));for(var r in t)a[r]=e(t[r]);return l(t,B)&&(a[B]=t[B]),a}function t(t){return r(t)?e(t):t}var s="add";v("Patches",{W:function(t,r){return r.forEach((function(r){for(var n=r.path,u=r.op,l=t,c=0;c<n.length-1;c++){var d=i(l),p=""+n[c];0!==d&&1!==d||"__proto__"!==p&&"constructor"!==p||a(24),"function"==typeof l&&"prototype"===p&&a(24),"object"!=typeof(l=o(l,p))&&a(15,n.join("/"))}var y=i(l),g=e(r.value),M=n[n.length-1];switch(u){case"replace":switch(y){case 2:return l.set(M,g);case 3:a(16);default:return l[M]=g}case s:switch(y){case 1:return"-"===M?l.push(g):l.splice(M,0,g);case 2:return l.set(M,g);case 3:return l.add(g);default:return l[M]=g}case"remove":switch(y){case 1:return l.splice(M,1);case 2:return l.delete(M);case 3:return l.delete(r.value);default:return delete l[M]}default:a(17,u)}})),t},F:function(e,a,r,n){switch(e.t){case 0:case 4:case 2:return function(e,a,r,n){var i=e.u,c=e.i;u(e.D,(function(e,u){var d=o(i,e),p=o(c,e),y=u?l(i,e)?"replace":s:"remove";if(d!==p||"replace"!==y){var g=a.concat(e);r.push("remove"===y?{op:y,path:g}:{op:y,path:g,value:p}),n.push(y===s?{op:"remove",path:g}:"remove"===y?{op:s,path:g,value:t(d)}:{op:"replace",path:g,value:t(d)})}}))}(e,a,r,n);case 5:case 1:return function(e,a,r,n){var u=e.u,i=e.D,l=e.i;if(l.length<u.length){var o=[l,u];u=o[0],l=o[1];var c=[n,r];r=c[0],n=c[1]}for(var d=0;d<u.length;d++)if(i[d]&&l[d]!==u[d]){var p=a.concat([d]);r.push({op:"replace",path:p,value:t(l[d])}),n.push({op:"replace",path:p,value:t(u[d])})}for(var y=u.length;y<l.length;y++){var g=a.concat([y]);r.push({op:s,path:g,value:t(l[y])})}u.length<l.length&&n.push({op:"replace",path:a.concat(["length"]),value:u.length})}(e,a,r,n);case 3:return function(e,t,a,r){var n=e.u,u=e.i,i=0;n.forEach((function(e){if(!u.has(e)){var n=t.concat([i]);a.push({op:"remove",path:n,value:e}),r.unshift({op:s,path:n,value:e})}i++})),i=0,u.forEach((function(e){if(!n.has(e)){var u=t.concat([i]);a.push({op:s,path:u,value:e}),r.unshift({op:"remove",path:u,value:e})}i++}))}(e,a,r,n)}},g:function(e,t,a,r){a.push({op:"replace",path:[],value:t===G?void 0:t}),r.push({op:"replace",path:[],value:e})}})}function P(){function e(e,t){function a(){this.constructor=e}l(e,t),e.prototype=(a.prototype=t.prototype,new a)}function t(e){e.i||(e.D=new Map,e.i=new Map(e.u))}function r(e){e.i||(e.i=new Set,e.u.forEach((function(t){if(n(t)){var a=w(e.A.h,t,e);e.p.set(t,a),e.i.add(a)}else e.i.add(t)})))}function i(e){e.O&&a(3,JSON.stringify(y(e)))}var l=function(e,t){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(e,t)},o=function(){function a(e,t){return this[Z]={t:2,l:t,A:t?t.A:E(),M:!1,R:!1,i:void 0,D:void 0,u:e,k:this,I:!1,O:!1},this}e(a,Map);var r=a.prototype;return Object.defineProperty(r,"size",{get:function(){return y(this[Z]).size}}),r.has=function(e){return y(this[Z]).has(e)},r.set=function(e,a){var r=this[Z];return i(r),y(r).has(e)&&y(r).get(e)===a||(t(r),k(r),r.D.set(e,!0),r.i.set(e,a),r.D.set(e,!0)),this},r.delete=function(e){if(!this.has(e))return!1;var a=this[Z];return i(a),t(a),k(a),a.u.has(e)?a.D.set(e,!1):a.D.delete(e),a.i.delete(e),!0},r.clear=function(){var e=this[Z];i(e),y(e).size&&(t(e),k(e),e.D=new Map,u(e.u,(function(t){e.D.set(t,!1)})),e.i.clear())},r.forEach=function(e,t){var a=this;y(this[Z]).forEach((function(r,n){e.call(t,a.get(n),n,a)}))},r.get=function(e){var a=this[Z];i(a);var r=y(a).get(e);if(a.R||!n(r))return r;if(r!==a.u.get(e))return r;var u=w(a.A.h,r,a);return t(a),a.i.set(e,u),u},r.keys=function(){return y(this[Z]).keys()},r.values=function(){var e,t=this,a=this.keys();return(e={})[H]=function(){return t.values()},e.next=function(){var e=a.next();return e.done?e:{done:!1,value:t.get(e.value)}},e},r.entries=function(){var e,t=this,a=this.keys();return(e={})[H]=function(){return t.entries()},e.next=function(){var e=a.next();if(e.done)return e;var r=t.get(e.value);return{done:!1,value:[e.value,r]}},e},r[H]=function(){return this.entries()},a}(),s=function(){function t(e,t){return this[Z]={t:3,l:t,A:t?t.A:E(),M:!1,R:!1,i:void 0,u:e,k:this,p:new Map,O:!1,I:!1},this}e(t,Set);var a=t.prototype;return Object.defineProperty(a,"size",{get:function(){return y(this[Z]).size}}),a.has=function(e){var t=this[Z];return i(t),t.i?!!t.i.has(e)||!(!t.p.has(e)||!t.i.has(t.p.get(e))):t.u.has(e)},a.add=function(e){var t=this[Z];return i(t),this.has(e)||(r(t),k(t),t.i.add(e)),this},a.delete=function(e){if(!this.has(e))return!1;var t=this[Z];return i(t),r(t),k(t),t.i.delete(e)||!!t.p.has(e)&&t.i.delete(t.p.get(e))},a.clear=function(){var e=this[Z];i(e),y(e).size&&(r(e),k(e),e.i.clear())},a.values=function(){var e=this[Z];return i(e),r(e),e.i.values()},a.entries=function(){var e=this[Z];return i(e),r(e),e.i.entries()},a.keys=function(){return this.values()},a[H]=function(){return this.values()},a.forEach=function(e,t){for(var a=this.values(),r=a.next();!r.done;)e.call(t,r.value,r.value,this),r=a.next()},t}();v("MapSet",{$:function(e,t){return new o(e,t)},C:function(e,t){return new s(e,t)}})}var _;Object.defineProperty(t,"__esModule",{value:!0});var Y,U="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),R="undefined"!=typeof Map,W="undefined"!=typeof Set,V="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,G=U?Symbol.for("immer-nothing"):((_={})["immer-nothing"]=!0,_),B=U?Symbol.for("immer-draftable"):"__$immer_draftable",Z=U?Symbol.for("immer-state"):"__$immer_state",H="undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator",$=""+Object.prototype.constructor,X="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,J=Object.getOwnPropertyDescriptors||function(e){var t={};return X(e).forEach((function(a){t[a]=Object.getOwnPropertyDescriptor(e,a)})),t},K={},ee={get:function(e,t){if(t===Z)return e;var a=y(e);if(!l(a,t))return function(e,t,a){var r,n=D(t,a);return n?"value"in n?n.value:null===(r=n.get)||void 0===r?void 0:r.call(e.k):void 0}(e,a,t);var r=a[t];return e.R||!n(r)?r:r===A(e.u,t)?(z(e),e.i[t]=w(e.A.h,r,e)):r},has:function(e,t){return t in y(e)},ownKeys:function(e){return Reflect.ownKeys(y(e))},set:function(e,t,a){var r=D(y(e),t);if(null==r?void 0:r.set)return r.set.call(e.k,a),!0;if(!e.M){var n=A(y(e),t),u=null==n?void 0:n[Z];if(u&&u.u===a)return e.i[t]=a,e.D[t]=!1,!0;if(c(a,n)&&(void 0!==a||l(e.u,t)))return!0;z(e),k(e)}return e.i[t]===a&&"number"!=typeof a&&(void 0!==a||t in e.i)||(e.i[t]=a,e.D[t]=!0,!0)},deleteProperty:function(e,t){return void 0!==A(e.u,t)||t in e.u?(e.D[t]=!1,z(e),k(e)):delete e.D[t],e.i&&delete e.i[t],!0},getOwnPropertyDescriptor:function(e,t){var a=y(e),r=Reflect.getOwnPropertyDescriptor(a,t);return r?{writable:!0,configurable:1!==e.t||"length"!==t,enumerable:r.enumerable,value:a[t]}:r},defineProperty:function(){a(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.u)},setPrototypeOf:function(){a(12)}},te={};u(ee,(function(e,t){te[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),te.deleteProperty=function(e,t){return te.set.call(this,e,t,void 0)},te.set=function(e,t,a){return ee.set.call(this,e[0],t,a,e[0])};var ae=function(){function e(e){var t=this;this.S=V,this.K=!0,this.produce=function(e,r,u){if("function"==typeof e&&"function"!=typeof r){var i=r;r=e;var l=t;return function(e){var t=this;void 0===e&&(e=i);for(var a=arguments.length,n=Array(a>1?a-1:0),u=1;u<a;u++)n[u-1]=arguments[u];return l.produce(e,(function(e){var a;return(a=r).call.apply(a,[t,e].concat(n))}))}}var o;if("function"!=typeof r&&a(6),void 0!==u&&"function"!=typeof u&&a(7),n(e)){var s=O(t),c=w(t,e,void 0),d=!0;try{o=r(c),d=!1}finally{d?L(s):N(s)}return"undefined"!=typeof Promise&&o instanceof Promise?o.then((function(e){return b(s,u),T(e,s)}),(function(e){throw L(s),e})):(b(s,u),T(o,s))}if(!e||"object"!=typeof e){if(void 0===(o=r(e))&&(o=e),o===G&&(o=void 0),t.K&&M(o,!0),u){var p=[],y=[];j("Patches").g(e,o,p,y),u(p,y)}return o}a(21,e)},this.produceWithPatches=function(e,a){if("function"==typeof e)return function(a){for(var r=arguments.length,n=Array(r>1?r-1:0),u=1;u<r;u++)n[u-1]=arguments[u];return t.produceWithPatches(a,(function(t){return e.apply(void 0,[t].concat(n))}))};var r,n,u=t.produce(e,a,(function(e,t){r=e,n=t}));return"undefined"!=typeof Promise&&u instanceof Promise?u.then((function(e){return[e,r,n]})):[u,r,n]},"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze)}var t=e.prototype;return t.createDraft=function(e){n(e)||a(8),r(e)&&(e=C(e));var t=O(this),u=w(this,e,void 0);return u[Z].I=!0,N(t),u},t.finishDraft=function(e,t){var a=(e&&e[Z]).A;return b(a,t),T(void 0,a)},t.setAutoFreeze=function(e){this.K=e},t.setUseProxies=function(e){e&&!V&&a(20),this.S=e},t.applyPatches=function(e,t){var a;for(a=t.length-1;a>=0;a--){var n=t[a];if(0===n.path.length&&"replace"===n.op){e=n.value;break}}a>-1&&(t=t.slice(a+1));var u=j("Patches").W;return r(e)?u(e,t):this.produce(e,(function(e){return u(e,t)}))},e}(),re=new ae,ne=re.produce,ue=re.produceWithPatches.bind(re),ie=re.setAutoFreeze.bind(re),le=re.setUseProxies.bind(re),oe=re.applyPatches.bind(re),se=re.createDraft.bind(re),ce=re.finishDraft.bind(re);t.Immer=ae,t.applyPatches=oe,t.castDraft=function(e){return e},t.castImmutable=function(e){return e},t.createDraft=se,t.current=C,t.default=ne,t.enableAllPlugins=function(){Q(),P(),q()},t.enableES5=Q,t.enableMapSet=P,t.enablePatches=q,t.finishDraft=ce,t.freeze=M,t.immerable=B,t.isDraft=r,t.isDraftable=n,t.nothing=G,t.original=function(e){return r(e)||a(23,e),e[Z].u},t.produce=ne,t.produceWithPatches=ue,t.setAutoFreeze=ie,t.setUseProxies=le},88:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var r=a(20),n=a(10),u=a(9),i=a(6),l=a(56);const o=()=>{const{http:e}=Object(i.e)().services,t=Object(l.a)();return Object(n.useQuery)(["agentPolicies"],(()=>e.get("/internal/osquery/fleet_wrapper/agent_policies")),{initialData:[],keepPreviousData:!0,select:e=>({agentPoliciesById:Object(r.mapKeys)(e,"id"),agentPolicies:e}),onSuccess:()=>t(),onError:e=>t(e,{title:u.i18n.translate("xpack.osquery.agent_policies.fetchError",{defaultMessage:"Error while fetching agent policies"})})})}},89:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var r=a(10),n=a(9),u=a(6),i=a(56);const l=({policyId:e,skip:t,silent:a})=>{const{http:l}=Object(u.e)().services,o=Object(i.a)();return Object(r.useQuery)(["agentPolicy",{policyId:e}],(()=>l.get(`/internal/osquery/fleet_wrapper/agent_policies/${e}`)),{enabled:!(!e||t),keepPreviousData:!0,select:e=>e.item,onSuccess:()=>o(),onError:e=>!a&&o(e,{title:n.i18n.translate("xpack.osquery.agent_policy_details.fetchError",{defaultMessage:"Error while fetching agent policy details"})})})}},95:function(e,t,a){"use strict";a.d(t,"a",(function(){return J}));var r=a(20),n=a(2),u=a(0),i=a.n(u),l=a(18),o=a(41),s=a.n(o),c=a(19),d=a(7),p=a(81),y=a(6),g=a(121),M=a(122),f=a(61),m=a(10),j=a(56),v=a(72),E=a(114),b=a(9),L=a(42),N=a(57),O=a.n(N),h=a(74),T=a.n(h);const x=()=>{const{http:e}=Object(y.e)().services,t=Object(j.a)();return Object(m.useQuery)(["osqueryPolicies"],(()=>e.get("/internal/osquery/fleet_wrapper/package_policies")),{select:e=>Object(r.uniq)(e.items.map((e=>e.policy_id))),onSuccess:()=>t(),onError:e=>t(e,{title:b.i18n.translate("xpack.osquery.osquery_policies.fetchError",{defaultMessage:"Error while fetching osquery policies"})})})};var S=a(46),I=a(58);let A;!function(e){e[e.All=0]="All",e[e.Platform=1]="Platform",e[e.Policy=2]="Policy",e[e.Agent=3]="Agent"}(A||(A={}));var D=a(66);var k=a(17),z=a.n(k),w=a(75);const C=(()=>{const e=Object(n.euiPaletteColorBlindBehindText)(),t=new Map;return a=>(t.has(a)||t.set(a,e[t.size]),t.get(a))})(),F=(e,t)=>({label:e,groupType:t,color:C(t),size:0,data:[]}),Q=(e,t,a)=>({label:e,options:a.map((e=>{var a,r;return{label:`${e.local_metadata.host.hostname} (${e.local_metadata.elastic.agent.id})`,key:e.local_metadata.elastic.agent.id,color:C(t),value:{groupType:t,groups:{policy:null!==(a=e.policy_id)&&void 0!==a?a:"",platform:e.local_metadata.os.platform},id:e.local_metadata.elastic.agent.id,status:null!==(r=e.status)&&void 0!==r?r:"unknown"}}}))}),q=(e,t,a)=>({label:e,options:a.map((({name:e,id:a,size:r})=>({label:e!==a?`${e} (${a})`:e,key:a,color:C(t),value:{groupType:t,id:a,size:r}})))});class agent_grouper_AgentGrouper{constructor(){z()(this,"groupOrder",[A.All,A.Platform,A.Policy,A.Agent]),z()(this,"groups",{[A.All]:F(w.d,A.All),[A.Platform]:F(w.a,A.Platform),[A.Policy]:F(w.b,A.Policy),[A.Agent]:F(w.c,A.Agent)})}updateGroup(e,t,a=!1){if(null==t||!t.length||e===A.All)return;const r=this.groups[e];a?r.data.push(...t):r.data=t,r.size=t.length}setTotalAgents(e){e<0||(this.groups[A.All].size=e)}generateOptions(){const e=[];for(const t of this.groupOrder){const{label:a,size:r,groupType:n,data:u,color:i}=this.groups[t];if(0!==r)switch(t){case A.All:e.push({label:a,options:[{label:a,value:{groupType:n,size:r},color:i}]});break;case A.Platform:case A.Policy:e.push(q(a,t,u));break;case A.Agent:e.push(Q(a,t,u))}}return e}}const P=({agentSelection:e,onChange:t,error:a})=>{const[l,o]=Object(u.useState)(""),[s,c]=Object(u.useState)(!1),[d,p]=Object(u.useState)("");T()((()=>{p(l),c(!1)}),300,[l]);const{isLoading:g,data:M,isFetched:f}=(()=>{const{data:e}=Object(y.e)().services,t=Object(j.a)(),{data:a,isFetched:n}=x(),{agentPoliciesLoading:u,agentPolicyById:i}=((e=[])=>{const{http:t}=Object(y.e)().services,a=Object(j.a)(),n=Object(m.useQueries)({queries:e.map((r=>({queryKey:["agentPolicy",r],queryFn:()=>t.get(`/internal/osquery/fleet_wrapper/agent_policies/${r}`),enabled:e.length>0,onSuccess:()=>a(),onError:e=>a(e,{title:b.i18n.translate("xpack.osquery.action_policy_details.fetchError",{defaultMessage:"Error while fetching policy details"})})})))}),u=n.some((e=>e.isLoading)),i=n.map((e=>{var t;return null===(t=e.data)||void 0===t?void 0:t.item}));return{agentPoliciesLoading:u,agentPolicies:i,agentPolicyById:Object(r.mapKeys)(i,"id")}})(a);return Object(m.useQuery)(["agentGroups"],(async()=>await Object(S.lastValueFrom)(e.search.search({filterQuery:{terms:{policy_id:a}},factoryQueryType:I.b.agents,aggregations:{platforms:{terms:{field:"local_metadata.os.platform"},aggs:{policies:{terms:{field:"policy_id"}}}},policies:{terms:{field:"policy_id"}}},pagination:Object(D.b)(0,9e3),sort:{direction:"asc",field:"local_metadata.os.platform"}},{strategy:"osquerySearchStrategy"}))),{select:e=>{var t;const{platforms:a,overlap:r,policies:n}=(e=>{var t;if(!e)return{platforms:[],overlap:{},policies:[]};const a=[],r={},n=e.platforms,u=e.policies,i=null!==(t=null==u?void 0:u.buckets.map((e=>({name:e.key,id:e.key,size:e.doc_count}))))&&void 0!==t?t:[];if(null!=n&&n.buckets)for(const{key:e,doc_count:t,policies:u}of n.buckets)a.push({name:e,id:e,size:t}),null!=u&&u.buckets&&i.length>0&&(r[e]=u.buckets.reduce(((e,t)=>(e[t.key]=t.doc_count,e)),{}));return{platforms:a,overlap:r,policies:i}})(e.rawResponse.aggregations);return{total:null!==(t=e.total)&&void 0!==t?t:0,groups:{platforms:a,overlap:r,policies:n.map((e=>{var t,a;const r=null!==(t=null===(a=i[e.id])||void 0===a?void 0:a.name)&&void 0!==t?t:e.name;return{...e,name:r}}))}}},placeholderData:{total:0,edges:[],rawResponse:{took:0,timed_out:!1,_shards:{failed:0,successful:0,total:0},hits:{hits:[]}}},refetchOnWindowFocus:!1,keepPreviousData:!0,enabled:n&&!u,onSuccess:()=>t(),onError:e=>t(e,{title:b.i18n.translate("xpack.osquery.agent_groups.fetchError",{defaultMessage:"Error while fetching agent groups"})})})})(),{isLoading:v,data:E,isFetched:N}=((e="",t={perPage:9e3})=>{const{perPage:a}=t,{http:r}=Object(y.e)().services,n=Object(j.a)(),{data:u,isFetched:i}=x();return Object(m.useQuery)(["agents",u,e,a],(()=>{let t="";return null!=u&&u.length&&(t=`(${u.map((e=>`policy_id:${e}`)).join(" or ")})`,e&&(t+=` and (local_metadata.host.hostname:*${e}* or local_metadata.elastic.agent.id:*${e}*)`)),r.get("/internal/osquery/fleet_wrapper/agents",{query:{kuery:t,perPage:a}})}),{select:e=>(null==e?void 0:e.agents)||[],enabled:i&&!(null==u||!u.length),onSuccess:()=>n(),onError:e=>{var t;return n(null==e?void 0:e.body,{title:b.i18n.translate("xpack.osquery.agents.fetchError",{defaultMessage:"Error while fetching agents"}),toastMessage:null==e||null===(t=e.body)||void 0===t?void 0:t.error})}})})(d,{perPage:10}),[h,k]=Object(u.useState)([]),[z,C]=Object(u.useState)([]),[F,Q]=Object(u.useState)(0),q=Object(u.useRef)(!1),P=Object(u.useCallback)((e=>{const{newAgentSelection:a,selectedAgents:r,selectedGroups:n}=(e=>{const t={agents:[],allAgentsSelected:!1,platformsSelected:[],policiesSelected:[]},a=[],r={policy:{},platform:{}};for(const o of e){var n,u,i,l;const e=null===(n=o.value)||void 0===n?void 0:n.groupType,s=null!==(u=null!==(i=o.key)&&void 0!==i?i:null===(l=o.value)||void 0===l?void 0:l.id)&&void 0!==u?u:o.label;let c;switch(e){case A.All:t.allAgentsSelected=!0;break;case A.Platform:c=o.value,t.allAgentsSelected||(r.platform[s]=c.size),t.platformsSelected.push(s);break;case A.Policy:c=o.value,t.allAgentsSelected||(r.policy[s]=c.size),t.policiesSelected.push(s);break;case A.Agent:c=o.value,t.allAgentsSelected||a.push(c),t.agents.push(s);break;default:console.error(`unknown group type ${e}`)}}return{newAgentSelection:t,selectedGroups:r,selectedAgents:a}})(e);if(a.allAgentsSelected){var u;Q(null!==(u=null==M?void 0:M.total)&&void 0!==u?u:0)}else{var i,l;const e=(e=>({groups:t})=>Object.keys(t).map((a=>e[a][t[a]])).every((e=>!e)))(n);Q(r.filter(e).length+(e=>{let t=0;return Object.keys(e).forEach((a=>{const r=e[a];t+=Object.keys(r).reduce(((e,t)=>e+r[t]),0)})),t})(n)-(({policy:e={},platform:t={}},a)=>{let r=0;return Object.keys(t).forEach((t=>{var n;const u=null!==(n=a[t])&&void 0!==n?n:{};Object.keys(e).forEach((e=>{var t;r+=null!==(t=u[e])&&void 0!==t?t:0}))})),r})(n,null!==(i=null==M||null===(l=M.groups)||void 0===l?void 0:l.overlap)&&void 0!==i?i:{}))}t(a),C(e)}),[M,t]);Object(u.useEffect)((()=>{const t=(e,t)=>{const a=Object(L.find)(["label",t],h);if(a){var r;const t=null===(r=a.options)||void 0===r?void 0:r.filter((t=>{if(t.key)return e.includes(t.key)}));null!=t&&t.length&&(P(t),q.current=!0)}};if(e&&!q.current&&h.length){var a,r;if(e.allAgentsSelected){const e=Object(L.find)(["label",w.d],h);null!=e&&e.options&&(P(e.options),q.current=!0)}null!==(a=e.policiesSelected)&&void 0!==a&&a.length&&t(e.policiesSelected,w.b),null!==(r=e.agents)&&void 0!==r&&r.length&&t(e.agents,w.c)}}),[e,P,h,z]),Object(u.useEffect)((()=>{if(N&&f&&M){const e=new agent_grouper_AgentGrouper;e.setTotalAgents(null==M?void 0:M.total),e.updateGroup(A.Platform,null==M?void 0:M.groups.platforms),e.updateGroup(A.Policy,null==M?void 0:M.groups.policies),e.updateGroup(A.Agent,E);const t=e.generateOptions();k((e=>O()(e,t)?e:t))}}),[g,E,N,f,M]);const _=Object(u.useCallback)(((e,t,a)=>{var r;const{label:u,value:l}=e;return(null==l?void 0:l.groupType)===A.Agent?i.a.createElement(n.EuiHealth,{color:"online"===(null==l?void 0:l.status)?"success":"danger"},i.a.createElement("span",{className:a},i.a.createElement(n.EuiHighlight,{search:t},u))):i.a.createElement("span",{className:a},i.a.createElement("span",null,"[",null!==(r=null==l?void 0:l.size)&&void 0!==r?r:0,"]")," ",i.a.createElement(n.EuiHighlight,{search:t},u))}),[]),Y=Object(u.useCallback)((e=>{c(""!==e),o(e)}),[]);return i.a.createElement("div",null,i.a.createElement(n.EuiFormRow,{label:w.c,fullWidth:!0,isInvalid:!!a,error:a},i.a.createElement(n.EuiComboBox,{"data-test-subj":"agentSelection",placeholder:w.f,isLoading:s||g||v,options:h,isClearable:!0,fullWidth:!0,onSearchChange:Y,selectedOptions:z,onChange:P,renderOption:_})),i.a.createElement(n.EuiSpacer,{size:"xs"}),F>0?i.a.createElement("span",null,Object(w.g)(F)):"")};P.displayName="AgentsTable";const _=i.a.memo(P,O.a),Y=e=>{var t,a,n;return Object(r.isEmpty)(e)?b.i18n.translate("xpack.osquery.pack.queryFlyoutForm.osqueryAgentsMissingErrorMessage",{defaultMessage:"Agents is a required field"}):e.allAgentsSelected||null!==(t=e.agents)&&void 0!==t&&t.length||null!==(a=e.platformsSelected)&&void 0!==a&&a.length||null!==(n=e.policiesSelected)&&void 0!==n&&n.length?void 0:b.i18n.translate("xpack.osquery.pack.queryFlyoutForm.osqueryAgentsMissingErrorMessage",{defaultMessage:"Agents is a required field"})},U=()=>{const{field:{onChange:e,value:t},fieldState:{error:a}}=Object(c.useController)({name:"agentSelection",rules:{validate:Y},defaultValue:{}});return i.a.createElement(_,{agentSelection:t,onChange:e,error:null==a?void 0:a.message})},R=i.a.memo(U);var W=a(73),V=a(96);const G=({defaultValue:e,onSuccess:t,queryField:a=!0,formType:o="steps",enabled:s=!0,hideAgentsField:b=!1})=>{const{application:L,appName:N}=Object(y.e)().services,O=L.capabilities.osquery,h=Object(u.useMemo)((()=>!(!O.runSavedQueries&&!O.writeLiveQueries||!O.readPacks)),[O]),T=Object(c.useForm)(),{handleSubmit:x,watch:S,setValue:I,resetField:A,clearErrors:D,getFieldState:k,register:z,formState:{isSubmitting:w}}=T,C=Object(u.useMemo)((()=>!!(O.writeLiveQueries||O.runSavedQueries&&O.readSavedQueries)),[O]),[F,Q]=Object(u.useState)(!1),[q,P]=Object(u.useState)(!1),_=k("query"),Y=S(),U=Object(u.useCallback)((()=>Q(!0)),[]),G=Object(u.useCallback)((()=>Q(!1)),[]),{queryType:B}=Y,{data:H,isLoading:$,mutateAsync:X,isError:J,isSuccess:K,reset:ee}=(({onSuccess:e})=>{const t=Object(j.a)(),{executionContext:a,http:r}=Object(y.e)().services,n=null==a?void 0:a.get();return Object(m.useMutation)((async({agentSelection:e,...t})=>{const a=await r.post("/api/osquery/live_queries",{body:JSON.stringify({...t,agent_all:e.allAgentsSelected,agent_ids:e.agents,agent_platforms:e.platformsSelected,agent_policy_ids:e.policiesSelected,metadata:{execution_context:n}})});return null==a?void 0:a.data}),{onSuccess:()=>{t(),e&&e()},onError:e=>{t(e,{title:e.body.error,toastMessage:e.body.message})}})})({onSuccess:t}),{data:te}=Object(v.a)({actionId:null==H?void 0:H.action_id,isLive:q});Object(u.useEffect)((()=>{z("savedQueryId"),z("alertIds")}),[z]);const ae=Object(u.useMemo)((()=>J||_.error?"danger":$?"loading":K?"complete":"incomplete"),[J,$,K,_]),re=Object(u.useMemo)((()=>"complete"===ae?"incomplete":"disabled"),[ae]),ne=Object(u.useCallback)((async e=>{var t;const a=Object(r.pickBy)({agentSelection:e.agentSelection,saved_query_id:e.savedQueryId,query:e.query,alert_ids:e.alertIds,pack_id:null!=e&&null!==(t=e.packId)&&void 0!==t&&t.length?null==e?void 0:e.packId[0]:void 0,ecs_mapping:e.ecs_mapping},(e=>!Object(r.isEmpty)(e)));await X(a)}),[X]),ue=Object(u.useMemo)((()=>Object(W.a)(Y)),[Y]),{data:ie,isFetched:le}=Object(f.a)({}),oe=Object(u.useMemo)((()=>i.a.createElement(n.EuiFlexItem,null,i.a.createElement(n.EuiFlexGroup,{justifyContent:"flexEnd"},"steps"===o&&"pack"!==B&&i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(n.EuiButtonEmpty,{disabled:!O.writeSavedQueries||"disabled"===re,onClick:U},i.a.createElement(l.FormattedMessage,{id:"xpack.osquery.liveQueryForm.form.saveForLaterButtonLabel",defaultMessage:"Save for later"}))),i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(n.EuiButton,{id:"submit-button",disabled:!s,isLoading:w,onClick:x(ne)},i.a.createElement(l.FormattedMessage,{id:"xpack.osquery.liveQueryForm.form.submitButtonLabel",defaultMessage:"Submit"})))))),[o,B,O.writeSavedQueries,re,U,s,w,x,ne]),se=Object(u.useMemo)((()=>{var e;return null==te||null===(e=te.queries)||void 0===e?void 0:e[0]}),[te]),ce=Object(u.useMemo)((()=>null==te?void 0:te.action_id),[te]),de=Object(u.useMemo)((()=>null!=se&&se.action_id?i.a.createElement(g.a,{actionId:null==se?void 0:se.action_id,ecsMapping:ue.ecs_mapping,endDate:null==se?void 0:se.expiration,agentIds:null==se?void 0:se.agents,liveQueryActionId:ce}):null),[null==se?void 0:se.action_id,null==se?void 0:se.expiration,null==se?void 0:se.agents,ue.ecs_mapping,ce]);Object(u.useEffect)((()=>{if(e){var t,a;if(e.agentSelection&&I("agentSelection",e.agentSelection),null!=e&&null!==(t=e.alertIds)&&void 0!==t&&t.length&&I("alertIds",e.alertIds),null!=e&&e.packId&&h){if(I("queryType","pack"),!le)return;return void(Object(r.find)(null==ie?void 0:ie.data,["id",e.packId])&&I("packId",[e.packId]))}if(null!=e&&e.query&&C)return I("query",e.query),I("savedQueryId",e.savedQueryId),void I("ecs_mapping",null!==(a=e.ecs_mapping)&&void 0!==a?a:{});if(C)return I("queryType","query");if(h)return I("queryType","pack")}}),[h,C,e,le,null==ie?void 0:ie.data,I]),Object(u.useEffect)((()=>{P((()=>!("completed"===(null==te?void 0:te.status))))}),[null==te?void 0:te.status]),Object(u.useEffect)((()=>{ee(),e||(A("packId"),A("query"),A("ecs_mapping"),A("savedQueryId"),A("alertIds"),D())}),[B,ee,A,I,D,e]);const pe=Object(u.useMemo)((()=>({gap:16})),[]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(c.FormProvider,T,i.a.createElement(Z,{direction:"column",$_css:pe},a&&i.a.createElement(p.a,{canRunPacks:h,canRunSingleQuery:C}),!b&&i.a.createElement(n.EuiFlexItem,null,i.a.createElement(R,null)),"pack"===B?i.a.createElement(V.a,{liveQueryDetails:te,submitButtonContent:oe,showResultsHeader:!0}):i.a.createElement(i.a.Fragment,null,i.a.createElement(n.EuiFlexItem,null,i.a.createElement(E.LiveQueryQueryField,{handleSubmitForm:x(ne)})),oe,i.a.createElement(n.EuiFlexItem,null,de)))),F?i.a.createElement(M.a,{isExternal:N!==d.PLUGIN_NAME,onClose:G,defaultValue:ue}):null)},B=i.a.memo(G);var Z=s()(n.EuiFlexGroup).withConfig({displayName:"_StyledEuiFlexGroup",componentId:"sc-qeb6js-0"})(["",""],(e=>e.$_css)),H=a(84),$=a(22);const X=({agentId:e,agentIds:t,alertIds:a,agentPolicyIds:o,onSuccess:s,query:c,savedQueryId:p,ecs_mapping:y,queryField:g,ecsMappingField:M,formType:f,enabled:m,hideAgentsField:j,packId:v,agentSelection:E})=>{const{data:b,isLoading:L}=Object(H.a)(),N=Object(u.useMemo)((()=>{return E||(e||null!=o&&o.length?{allAgentsSelected:!1,agents:Object(r.castArray)(null!==(a=null!=e?e:t)&&void 0!==a?a:[]),platformsSelected:[],policiesSelected:null!=o?o:[]}:null);var a}),[e,t,o,E]),O=Object(u.useMemo)((()=>{const e={...N?{agentSelection:N}:{},alertIds:a,query:c,savedQueryId:p,ecs_mapping:y,packId:v};return Object(r.isEmpty)(Object(r.pickBy)(e,(e=>!Object(r.isEmpty)(e))))?void 0:e}),[a,y,N,v,c,p]);return L?i.a.createElement(n.EuiLoadingContent,{lines:10}):b?i.a.createElement(B,{queryField:g,ecsMappingField:M,defaultValue:O,onSuccess:s,formType:f,enabled:m,hideAgentsField:j}):i.a.createElement(n.EuiEmptyPrompt,{icon:i.a.createElement($.a,null),title:i.a.createElement("h2",null,i.a.createElement(l.FormattedMessage,{id:"xpack.osquery.liveQuery.permissionDeniedPromptTitle",defaultMessage:"Permission denied"})),titleSize:"xs",body:i.a.createElement("p",null,i.a.createElement(l.FormattedMessage,{id:"xpack.osquery.liveQuery.permissionDeniedPromptBody",defaultMessage:"To view query results, ask your administrator to update your user role to have index {read} privileges on the {logs} index.",values:{read:i.a.createElement(n.EuiCode,null,"read"),logs:i.a.createElement(n.EuiCode,null,"logs-",d.OSQUERY_INTEGRATION_NAME,".result*")}}))})},J=i.a.memo(X)},96:function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var r=a(2),n=a(0),u=a.n(n),i=a(20),l=a(19),o=a(71),s=a(61),c=a(5),d=a.n(c),p=a(9),y=a(41);const g=a.n(y).a.div.withConfig({displayName:"TextTruncate",componentId:"sc-169w92d-0"})(["overflow:hidden;text-overflow:ellipsis;"]),M=({queryType:e,fieldProps:t={},idAria:a,...o})=>{var s;const{field:{value:c,onChange:y},fieldState:M}=Object(l.useController)({name:"packId",rules:{required:{message:p.i18n.translate("xpack.osquery.pack.queryFlyoutForm.osqueryPackMissingErrorMessage",{defaultMessage:"Pack is a required field"}),value:"pack"===e}},defaultValue:[]}),f=null===(s=M.error)||void 0===s?void 0:s.message,[m,j]=Object(n.useState)([]),v=Object(n.useCallback)((e=>{var t;if(!e.length)return j(e),void y([]);j(e),y([null===(t=e[0].value)||void 0===t?void 0:t.id])}),[y]),E=Object(n.useMemo)((()=>{var e,a;return null!==(e=null==t||null===(a=t.packsData)||void 0===a?void 0:a.map((e=>{var t;return{label:null!==(t=e.attributes.name)&&void 0!==t?t:"",value:{id:e.id,name:e.attributes.name,description:e.attributes.description}}})))&&void 0!==e?e:[]}),[null==t?void 0:t.packsData]),b=Object(n.useCallback)((({value:e})=>u.a.createElement(r.EuiFlexGroup,{gutterSize:"none",direction:"column",alignItems:"flexStart",justifyContent:"flexStart"},u.a.createElement(r.EuiFlexItem,null,u.a.createElement("strong",null,null==e?void 0:e.name)),u.a.createElement(r.EuiFlexItem,null,u.a.createElement(g,null,u.a.createElement(r.EuiTextColor,{color:"subdued"},null==e?void 0:e.description))))),[]);return Object(n.useEffect)((()=>{if(null!=c&&c.length){const e=Object(i.find)(E,["value.id",c[0]]);e&&j([e])}}),[c,E]),u.a.createElement(r.EuiFormRow,d()({label:p.i18n.translate("xpack.osquery.liveQuery.queryForm.packQueryTypeLabel",{defaultMessage:"Pack"}),error:f,isInvalid:!!f,fullWidth:!0,describedByIds:a?[a]:void 0},o),u.a.createElement(r.EuiComboBox,d()({placeholder:p.i18n.translate("xpack.osquery.packs.dropdown.searchFieldPlaceholder",{defaultMessage:"Search for a pack to run"}),selectedOptions:m,onChange:v,"data-test-subj":"select-live-pack",fullWidth:!0,singleSelection:{asPlainText:!0},renderOption:b,options:E,rowHeight:60},t)))},f=({liveQueryDetails:e,submitButtonContent:t,showResultsHeader:a})=>{var c,d,p,y,g;const{data:f}=Object(s.a)({}),{packId:m}=Object(l.useWatch)(),j=Object(n.useMemo)((()=>null!=m&&m.length?Object(i.find)(null==f?void 0:f.data,{id:m[0]}):null),[m,f]),v=Object(n.useMemo)((()=>null==e?void 0:e.action_id),[null==e?void 0:e.action_id]),E=Object(n.useMemo)((()=>null==e?void 0:e.agents),[null==e?void 0:e.agents]);return u.a.createElement(u.a.Fragment,null,u.a.createElement(r.EuiFlexItem,null,u.a.createElement(M,{fieldProps:{packsData:null==f?void 0:f.data},queryType:"pack"})),t,u.a.createElement(r.EuiSpacer,null),null!=e&&null!==(c=e.queries)&&void 0!==c&&c.length||null!=j&&null!==(d=j.attributes)&&void 0!==d&&null!==(p=d.queries)&&void 0!==p&&p.length?u.a.createElement(u.a.Fragment,null,u.a.createElement(r.EuiFlexItem,null,u.a.createElement(o.a,{actionId:v,agentIds:E,data:null!==(y=null==e?void 0:e.queries)&&void 0!==y?y:null==j||null===(g=j.attributes)||void 0===g?void 0:g.queries,showResultsHeader:a}))):null)}},98:function(e,t,a){"use strict";a.d(t,"a",(function(){return L}));var r=a(41),n=a.n(r),u=a(2),i=a(0),l=a.n(i),o=a(9),s=a(18),c=a(120),d=a(102),p=a(107),y=a(86),g=a(19),M=a(95);const f=n()(u.EuiFlyoutHeader).withConfig({displayName:"StyledEuiFlyoutHeader",componentId:"sc-xfzu4c-0"})(["&.euiFlyoutHeader{padding-top:21px;padding-bottom:20px;}"]),m=({enabled:e,onClose:t})=>{const{serializer:a,watch:r}=Object(g.useFormContext)(),n=r(),{query:o,ecs_mapping:c,id:d}=n,p=Object(i.useMemo)((()=>a(n)),[c]);return l.a.createElement(u.EuiFlyout,{type:"push",size:"m",onClose:t},l.a.createElement(f,{hasBorder:!0},l.a.createElement(u.EuiTitle,{size:"s"},l.a.createElement("h5",null,l.a.createElement(s.FormattedMessage,{id:"xpack.osquery.queryPlaygroundFlyout.title",defaultMessage:"Test query"})))),l.a.createElement(u.EuiFlyoutBody,null,l.a.createElement(M.a,{enabled:e&&""!==o,formType:"simple",query:o,ecs_mapping:p.ecs_mapping,savedQueryId:d,queryField:!1,ecsMappingField:!1})))},j=l.a.memo(m);var v=a(108),E=a(63);const b=({viewMode:e,hasPlayground:t,isValid:a,idSet:r})=>{const[n,g]=Object(i.useState)(!1),M=Object(i.useMemo)((()=>({isDisabled:!!e})),[e]),f=Object(i.useCallback)((()=>g(!1)),[]),m=Object(i.useCallback)((()=>g((e=>!e))),[]),E=Object(i.useMemo)((()=>({append:"s",...M})),[M]),b=Object(i.useMemo)((()=>({noSuggestions:!1,singleSelection:{asPlainText:!0},placeholder:o.i18n.translate("xpack.osquery.pack.queriesTable.osqueryVersionAllLabel",{defaultMessage:"ALL"}),options:p.a,onCreateOption:void 0,...M})),[M]);return l.a.createElement(l.a.Fragment,null,l.a.createElement(c.c,{idSet:r,euiFieldProps:M}),l.a.createElement(u.EuiSpacer,null),l.a.createElement(c.b,{euiFieldProps:M}),l.a.createElement(u.EuiSpacer,null),l.a.createElement(v.a,{euiFieldProps:M}),l.a.createElement(u.EuiSpacer,{size:"xl"}),l.a.createElement(u.EuiFlexGroup,null,l.a.createElement(N,null,l.a.createElement(y.a,{euiFieldProps:M}))),!e&&t&&l.a.createElement(u.EuiFlexGroup,null,l.a.createElement(u.EuiFlexItem,{grow:!1},l.a.createElement(u.EuiButtonEmpty,{iconType:"play",onClick:m},l.a.createElement(s.FormattedMessage,{id:"xpack.osquery.savedQueries.form.packConfigSection.testConfigButtonLabel",defaultMessage:"Test configuration"})))),l.a.createElement(u.EuiSpacer,{size:"xl"}),l.a.createElement(u.EuiFlexGroup,null,l.a.createElement(u.EuiFlexItem,null,l.a.createElement(u.EuiTitle,{size:"xs"},l.a.createElement("h5",null,l.a.createElement(s.FormattedMessage,{id:"xpack.osquery.savedQueries.form.packConfigSection.title",defaultMessage:"Pack configuration"}))),l.a.createElement(u.EuiText,{color:"subdued"},l.a.createElement(s.FormattedMessage,{id:"xpack.osquery.savedQueries.form.packConfigSection.description",defaultMessage:"The options listed below are optional and are only applied when the query is assigned to a pack."})))),l.a.createElement(u.EuiSpacer,null),l.a.createElement(u.EuiFlexGroup,null,l.a.createElement(u.EuiFlexItem,null,l.a.createElement(c.a,{euiFieldProps:E}),l.a.createElement(u.EuiSpacer,{size:"m"}),l.a.createElement(c.e,{euiFieldProps:b}),l.a.createElement(u.EuiSpacer,{size:"m"}),l.a.createElement(c.d,{euiFieldProps:M})),l.a.createElement(u.EuiFlexItem,null,l.a.createElement(d.a,{euiFieldProps:M}))),n&&l.a.createElement(j,{enabled:void 0===a||a,onClose:f}))};b.displayName="SavedQueryForm";const L=l.a.memo(b);var N=n()(u.EuiFlexItem).withConfig({displayName:"_StyledEuiFlexItem",componentId:"sc-1gryf3z-0"})(["",""],E.a)}}]);