/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.osquery_bundle_jsonpfunction=window.osquery_bundle_jsonpfunction||[]).push([[12],{161:function(e,t,a){"use strict";a.r(t),a.d(t,"OsqueryAction",(function(){return f})),a.d(t,"default",(function(){return f}));var n=a(5),i=a.n(n),l=a(2),r=a(0),o=a.n(r),c=a(18),s=a(22),u=a(26);const d=()=>o.a.createElement(l.EuiEmptyPrompt,{icon:o.a.createElement(s.a,null),title:o.a.createElement("h2",null,u.e),titleSize:"xs",body:o.a.createElement("p",null,u.b)}),m=()=>o.a.createElement(l.EuiEmptyPrompt,{icon:o.a.createElement(s.a,null),title:o.a.createElement("h2",null,u.e),titleSize:"xs",body:o.a.createElement("p",null,u.c)});var p=a(6),E=a(95),y=a(20),g=a(70),b=a(7),v=a(100);const h=({agentId:e,formType:t="simple",defaultValues:a,hideAgentsField:n})=>{const h=Object(p.e)().services.application.capabilities.osquery,{osqueryAvailable:f,agentFetched:q,isLoading:O,policyFetched:F,policyLoading:_,agentData:j}=(e=>{const{data:t,isFetched:a,isLoading:n}=Object(v.a)({agentId:e,silent:!0,skip:!e}),{data:i,isFetched:l,isError:o,isLoading:c}=Object(g.b)({policyId:null==t?void 0:t.policy_id,skip:!t,silent:!0});return{osqueryAvailable:Object(r.useMemo)((()=>{if(o)return!1;const e=Object(y.find)(null==i?void 0:i.package_policies,["package.name",b.OSQUERY_INTEGRATION_NAME]);return!Object(y.isString)(e)&&!(null==e||!e.enabled)}),[null==i?void 0:i.package_policies,o]),agentFetched:a,isLoading:n,policyFetched:l,policyLoading:c,agentData:t}})(e);return e&&q&&!j?o.a.createElement(d,null):h.runSavedQueries&&h.readSavedQueries||h.writeLiveQueries?e&&O||e&&!F&&_?o.a.createElement(l.EuiLoadingContent,{lines:10}):e&&!f?o.a.createElement(m,null):e&&"online"!==(null==j?void 0:j.status)?o.a.createElement(l.EuiEmptyPrompt,{icon:o.a.createElement(s.a,null),title:o.a.createElement("h2",null,u.e),titleSize:"xs",body:o.a.createElement("p",null,u.a)}):o.a.createElement(E.a,i()({formType:t,agentId:e,hideAgentsField:n},a)):o.a.createElement(l.EuiEmptyPrompt,{icon:o.a.createElement(s.a,null),title:o.a.createElement("h2",null,u.d),titleSize:"xs",body:o.a.createElement("p",null,o.a.createElement(c.FormattedMessage,{id:"xpack.osquery.action.missingPrivileges",defaultMessage:"To access this page, ask your administrator for {osquery} Kibana privileges.",values:{osquery:o.a.createElement(l.EuiCode,null,"osquery")}}))})};h.displayName="OsqueryAction";const f=o.a.memo(h)}}]);