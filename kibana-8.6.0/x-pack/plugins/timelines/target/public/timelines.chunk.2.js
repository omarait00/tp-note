/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.timelines_bundle_jsonpfunction=window.timelines_bundle_jsonpfunction||[]).push([[2,8,9],{111:function(e,t,n){"use strict";e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var a,l,i;if(Array.isArray(t)){if((a=t.length)!=n.length)return!1;for(l=a;0!=l--;)if(!e(t[l],n[l]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((a=(i=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(l=a;0!=l--;)if(!Object.prototype.hasOwnProperty.call(n,i[l]))return!1;for(l=a;0!=l--;){var s=i[l];if(!e(t[s],n[s]))return!1}return!0}return t!=t&&n!=n}},112:function(e,t,n){"use strict";n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return s}));var a=n(8);const l=a.i18n.translate("xpack.timelines.tgrid.body.ariaLabel",{defaultMessage:"Alerts"}),i=(a.i18n.translate("xpack.timelines.timeline.body.notes.disableEventTooltip",{defaultMessage:"Notes may not be added here while editing a template timeline"}),a.i18n.translate("xpack.timelines.timeline.body.copyToClipboardButtonLabel",{defaultMessage:"Copy to Clipboard"})),s=(a.i18n.translate("xpack.timelines.timeline.body.actions.investigateLabel",{defaultMessage:"Investigate"}),a.i18n.translate("xpack.timelines.timeline.body.pinning.pinnnedWithNotesTooltip",{defaultMessage:"This event cannot be unpinned because it has notes"}),a.i18n.translate("xpack.timelines.timeline.body.sort.sortedAscendingTooltip",{defaultMessage:"Sorted ascending"}),a.i18n.translate("xpack.timelines.timeline.body.sort.sortedDescendingTooltip",{defaultMessage:"Sorted descending"}),a.i18n.translate("xpack.timelines.timeline.body.pinning.disablePinnnedTooltip",{defaultMessage:"This event may not be pinned while editing a template timeline"}),a.i18n.translate("xpack.timelines.timeline.body.actions.viewDetailsAriaLabel",{defaultMessage:"View details"}),a.i18n.translate("xpack.timelines.timeline.body.actions.viewSummaryLabel",{defaultMessage:"View summary"}),a.i18n.translate("xpack.timelines.timeline.body.actions.expandEventTooltip",{defaultMessage:"View details"}),a.i18n.translate("xpack.timelines.timeline.body.actions.collapseAriaLabel",{defaultMessage:"Collapse"}),a.i18n.translate("xpack.timelines.timeline.body.actions.investigateInResolverTooltip",{defaultMessage:"Analyze event"}),a.i18n.translate("xpack.timelines.timeline.body.actions.investigateInResolverDisabledTooltip",{defaultMessage:"This event cannot be analyzed since it has incompatible field mappings"}),e=>a.i18n.translate("xpack.timelines.timeline.alertsUnit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {alert} other {alerts}}"}))},113:function(e,t,n){"use strict";n.r(t),n.d(t,"LoadingPanel",(function(){return d})),n.d(t,"LoadingStaticPanel",(function(){return c})),n.d(t,"LoadingStaticContentPanel",(function(){return u})),n.d(t,"default",(function(){return d}));var a=n(3),l=n(0),i=n.n(l),s=n(23),o=n.n(s);const r=o()(a.EuiFlexItem).withConfig({displayName:"SpinnerFlexItem",componentId:"sc-zdczxa-0"})(["margin-right:5px;"]);r.displayName="SpinnerFlexItem";const d=i.a.memo((({dataTestSubj:e="",height:t="auto",showBorder:n=!0,text:l,width:s,position:o="relative",zIndex:d="inherit"})=>i.a.createElement(c,{className:"app-loading",height:t,width:s,position:o,zIndex:d},i.a.createElement(u,null,i.a.createElement(a.EuiPanel,{"data-test-subj":e,className:n?"":"euiPanel-loading-hide-border"},i.a.createElement(a.EuiFlexGroup,{alignItems:"center",direction:"row",gutterSize:"none"},i.a.createElement(r,{grow:!1},i.a.createElement(a.EuiLoadingSpinner,{size:"m"})),i.a.createElement(a.EuiFlexItem,{grow:!1},i.a.createElement(a.EuiText,null,l))))))));d.displayName="LoadingPanel";const c=o.a.div.withConfig({displayName:"LoadingStaticPanel",componentId:"sc-zdczxa-1"})(["height:",";position:",";width:",";overflow:hidden;display:flex;flex-direction:column;justify-content:center;z-index:",";"],(({height:e})=>e),(({position:e})=>e),(({width:e})=>e),(({zIndex:e})=>e));c.displayName="LoadingStaticPanel";const u=o.a.div.withConfig({displayName:"LoadingStaticContentPanel",componentId:"sc-zdczxa-2"})(["flex:0 0 auto;align-self:center;text-align:center;height:fit-content;.euiPanel.euiPanel--paddingMedium{padding:10px;}"]);u.displayName="LoadingStaticContentPanel"},114:function(e,t,n){"use strict";n.r(t),n.d(t,"Updated",(function(){return c})),n.d(t,"LastUpdatedAt",(function(){return m})),n.d(t,"default",(function(){return m}));var a=n(3),l=n(26),i=n(0),s=n.n(i),o=n(8);const r=o.i18n.translate("xpack.timelines.lastUpdated.updating",{defaultMessage:"Updating..."}),d=o.i18n.translate("xpack.timelines.lastUpdated.updated",{defaultMessage:"Updated"}),c=s.a.memo((({date:e,prefix:t,updatedAt:n})=>s.a.createElement(s.a.Fragment,null,t,s.a.createElement(l.FormattedRelative,{"data-test-subj":"last-updated-at-date",key:`formatedRelative-${e}`,value:new Date(n)}))));c.displayName="Updated";const u=` ${d} `,m=s.a.memo((({compact:e=!1,updatedAt:t,showUpdating:n=!1})=>{const[l,o]=Object(i.useState)(Date.now());Object(i.useEffect)((()=>{const e=setInterval((()=>{o(Date.now())}),1e4);return()=>{clearInterval(e)}}),[]);const d=Object(i.useMemo)((()=>n?s.a.createElement("span",null," ",r):e?null:s.a.createElement(c,{date:l,prefix:u,updatedAt:t})),[e,l,n,t]);return s.a.createElement(a.EuiToolTip,{"data-test-subj":"timeline-stream-tool-tip",content:s.a.createElement(c,{date:l,prefix:u,updatedAt:t})},s.a.createElement(a.EuiText,{color:"subdued",size:"xs"},d))}));m.displayName="LastUpdatedAt"},121:function(e,t,n){"use strict";n.r(t),n.d(t,"TGrid",(function(){return gt})),n.d(t,"default",(function(){return gt})),n.d(t,"useDraggableKeyboardWrapper",(function(){return it.a})),n.d(t,"temporarilyDisableInteractiveChildTabIndexes",(function(){return lt.d})),n.d(t,"draggableKeyDownHandler",(function(){return lt.b})),n.d(t,"addFieldToTimelineColumns",(function(){return lt.a})),n.d(t,"getTimelineIdFromColumnDroppableId",(function(){return lt.c})),n.d(t,"DragDropContextWrapper",(function(){return rt})),n.d(t,"Updated",(function(){return ut.Updated})),n.d(t,"LastUpdatedAt",(function(){return ut.LastUpdatedAt})),n.d(t,"LoadingPanel",(function(){return mt.LoadingPanel})),n.d(t,"LoadingStaticPanel",(function(){return mt.LoadingStaticPanel})),n.d(t,"LoadingStaticContentPanel",(function(){return mt.LoadingStaticContentPanel}));var a=n(0),l=n.n(a),i=n(26),s=n(44),o=n(47),r=n(37),d=n(3),c=n(2),u=n(23),m=n.n(u),p=n(18),g=n(103),b=n(111),h=n.n(b);const f=e=>Object(s.useSelector)(e,h.a);var v=n(51),E=n(46),w=n(14),C=n(36),y=n(1),x=n(11),S=n(45),j=n(30),O=n(8);const k=O.i18n.translate("xpack.timelines.timelineEvents.errorSearchDescription",{defaultMessage:"An error has occurred on timeline events search"});var I=n(68);const M=[j.b.alertsOnAlertsPage,j.b.alertsOnRuleDetailsPage],T=e=>Object(c.isString)(e)?e:JSON.stringify(e),P=(e,t)=>{var n,a,l;return{dsl:null!==(n=null!==(a=null==e||null===(l=e.inspect)||void 0===l?void 0:l.dsl)&&void 0!==a?a:null==t?void 0:t.dsl)&&void 0!==n?n:[],response:null!=e?[JSON.stringify(e.rawResponse,null,2)]:null==t?void 0:t.response}},A="timelineEventsQuery",D=[{direction:x.a.desc,esTypes:["date"],field:"@timestamp",type:"date"}],R=[];var F=n(69),L=n.n(F),z=n(49),V=n(50),N=n(52),B=n(53);const q=({columnHeaders:e,controlColumn:t,data:n,disabled:i,index:o,isEventViewer:r,loadingEventIds:d,onRowSelected:c,onRuleChange:u,pageRowIndex:m,rowIndex:p,selectedEventIds:g,showCheckboxes:b,tabType:h,tableId:f,setEventsLoading:v,setEventsDeleted:E,width:C})=>{const{data:y,ecs:x,_id:S,_index:j}=Object(a.useMemo)((()=>{const e=n[m];return null!=e?e:{}}),[n,m]),O=Object(s.useDispatch)(),k=Object(a.useMemo)((()=>y&&e.map((e=>{var t;return null!==(t=(({data:e,fieldName:t})=>{const n=e.find((e=>e.field===t));if(null!=n&&null!=n.value)return n.value})({data:y,fieldName:e.id}))&&void 0!==t?t:[]})).join(" ")),[e,y]),I=Object(a.useCallback)((()=>{const e={panelView:"eventDetail",params:{eventId:null!=S?S:"",indexName:null!=j?j:""}};O(w.d.toggleDetailPanel({...e,tabType:h,id:f}))}),[O,S,j,h,f]),M=t.rowCellRender;return y&&x&&S?l.a.createElement(l.a.Fragment,null,M&&l.a.createElement(M,{ariaRowindex:m+1,checked:Object.keys(g).includes(S),columnId:t.id||"",columnValues:k||"",data:y,"data-test-subj":"actions",disabled:i,ecsData:x,eventId:S,index:o,isEventViewer:r,loadingEventIds:d,onEventDetailsPanelOpened:I,onRowSelected:c,onRuleChange:u,rowIndex:p,showCheckboxes:b,tabType:h,timelineId:f,width:C,setEventsLoading:v,setEventsDeleted:E})):l.a.createElement("span",{"data-test-subj":"noData"})},_=l.a.memo(q);var $=n(112),H=n(54);const U=({ariaRowindex:e,columnValues:t,checked:n})=>O.i18n.translate("xpack.timelines.timeline.body.actions.checkboxForRowAriaLabel",{values:{ariaRowindex:e,checked:n,columnValues:t},defaultMessage:"{checked, select, false {unchecked} true {checked}} checkbox for the alert or event in row {ariaRowindex}, with columns {columnValues}"}),Q={id:"checkbox-control-column",width:32,headerCellRender:({onSelectAll:e,isSelectAllChecked:t})=>{const n=Object(a.useCallback)((t=>{e({isSelected:t.currentTarget.checked})}),[e]);return l.a.createElement(d.EuiCheckbox,{"data-test-subj":"select-all-events",id:"select-all-events",checked:t,onChange:n})},rowCellRender:({eventId:e,onRowSelected:t,checked:n,ariaRowindex:i,columnValues:s,disabled:o,loadingEventIds:r})=>{const c=Object(a.useCallback)((n=>{o||t({eventIds:[e],isSelected:n.currentTarget.checked})}),[e,t,o]);return r.includes(e)?l.a.createElement(d.EuiLoadingSpinner,{size:"m","data-test-subj":"event-loader"}):l.a.createElement(d.EuiCheckbox,{"data-test-subj":`select-event select-event-${e}`,id:e,checked:n&&!o,disabled:o,onChange:c,"aria-label":U({ariaRowindex:i,columnValues:s,checked:n})})}};var G=n(15),W=n(105),K=n.n(W);const J=e=>Object(G.isEmpty)(e)?"":`${null!=e&&e.startsWith("?")?e:`?${e}`}`,Z=({name:e,id:t,appId:n})=>{const{navigateToApp:i,getUrlForApp:s}=Object(p.useKibana)().services.application,o=Object(a.useMemo)((()=>s(n,{deepLinkId:"rules",path:`/id/${t}${J(window.location.search)}`})),[s,t,n]),r=Object(a.useCallback)((e=>{e.preventDefault(),i(n,{deepLinkId:"rules",path:`/id/${t}${J(window.location.search)}`})}),[i,t,n]);return l.a.createElement(d.EuiLink,{href:o,onClick:r},e)},X=l.a.memo(Z),Y=m()(d.EuiFlexItem).withConfig({displayName:"EventRenderedFlexItem",componentId:"sc-o4qyf6-0"})(["div:first-child{padding-left:0px;div{margin:0px;}}"]),ee=m.a.div.withConfig({displayName:"ActionsContainer",componentId:"sc-o4qyf6-1"})(["display:flex;align-items:center;div div:first-child div.siemEventsTable__tdContent{margin-left:",";}"],(({theme:e})=>e.eui.euiSizeM)),te=m()(d.EuiBasicTable).withConfig({displayName:"StyledEuiBasicTable",componentId:"sc-o4qyf6-2"})(["padding-top:",";.EventRenderedView__buildingBlock{background:",";}& > div:last-child{height:72px;}& tr:nth-child(even){background-color:",";}& tr:nth-child(odd){background-color:",";}"],(({theme:e})=>e.eui.euiSizeM),(({theme:e})=>e.eui.euiColorHighlight),(({theme:e})=>e.eui.euiColorLightestShade),(({theme:e})=>e.eui.euiColorEmptyShade)),ne=({value:e})=>{var t,n;const a=Object(p.useUiSetting)("dateFormat:tz"),i=Object(p.useUiSetting)("dateFormat"),s=null!==(t=null===(n=K.a.tz.zone(a))||void 0===n?void 0:n.name)&&void 0!==t?t:K.a.tz.guess();return l.a.createElement("span",{"data-test-subj":"moment-date"},K.a.tz(e,s).format(i))},ae=l.a.memo(ne),le=({alertToolbar:e,appId:t,events:n,getRowRenderer:i,leadingControlColumns:s,onChangePage:o,onChangeItemsPerPage:c,pageIndex:u,pageSize:m,pageSizeOptions:p,rowRenderers:g,timelineId:b,totalItemCount:h})=>{const f=Object(a.useMemo)((()=>l.a.createElement(d.EuiFlexGroup,{gutterSize:"m"},s.map((e=>{const t=e.headerCellRender;return l.a.createElement(d.EuiFlexItem,{grow:!1},l.a.createElement(t,null))})))),[s]),v=Object(a.useMemo)((()=>[{field:"actions",name:f,truncateText:!1,mobileOptions:{show:!0},render:(e,t)=>{const a=Object(G.get)(t,"_id"),i=n.findIndex((e=>e._id===a));return l.a.createElement(ee,null,s.length>0?s.map((e=>(0,e.rowCellRender)({columnId:"actions",isDetails:!1,isExpandable:!1,isExpanded:!1,rowIndex:i,setCellProps:()=>null}))):null)},width:"184px"},{field:"ecs.timestamp",name:O.i18n.translate("xpack.timelines.alerts.EventRenderedView.timestamp.column",{defaultMessage:"Timestamp"}),truncateText:!1,mobileOptions:{show:!0},render:(e,t)=>{const n=Object(G.get)(t,"ecs.timestamp");return l.a.createElement(ae,{value:n})}},{field:`ecs.${r.c}`,name:O.i18n.translate("xpack.timelines.alerts.EventRenderedView.rule.column",{defaultMessage:"Rule"}),truncateText:!1,mobileOptions:{show:!0},render:(e,n)=>{var a,i;const s=null!==(a=Object(G.get)(n,"ecs.signal.rule.name"))&&void 0!==a?a:Object(G.get)(n,`ecs.${r.c}`),o=null!==(i=Object(G.get)(n,"ecs.signal.rule.id"))&&void 0!==i?i:Object(G.get)(n,`ecs.${r.e}`);return l.a.createElement(X,{name:s,id:o,appId:t})}},{field:"eventSummary",name:O.i18n.translate("xpack.timelines.alerts.EventRenderedView.eventSummary.column",{defaultMessage:"Event Summary"}),truncateText:!1,mobileOptions:{show:!0},render:(e,t)=>{var n,a;const s=Object(G.get)(t,"ecs"),o=null!==(n=Object(G.get)(t,"ecs.signal.reason"))&&void 0!==n?n:Object(G.get)(t,`ecs.${r.a}`),c=null!=i?i({data:s,rowRenderers:g}):null!==(a=g.find((e=>e.isInstance(s))))&&void 0!==a?a:null;return l.a.createElement(d.EuiFlexGroup,{gutterSize:"none",direction:"column",className:"eui-fullWidth"},null!=c?l.a.createElement(Y,{className:"eui-xScroll"},l.a.createElement("div",{className:"eui-displayInlineBlock"},c.renderRow({data:s,isDraggable:!1,scopeId:b}))):l.a.createElement(l.a.Fragment,null,o&&l.a.createElement(d.EuiFlexItem,{"data-test-subj":"plain-text-reason"},o)))},width:"60%"}]),[f,n,s,t,i,g,b]),E=Object(a.useCallback)((e=>{e.page.index!==u&&o(e.page.index),e.page.size!==m&&c(e.page.size)}),[o,u,m,c]),w=Object(a.useMemo)((()=>({pageIndex:u,pageSize:m,totalItemCount:h,pageSizeOptions:p,showPerPageOptions:!0})),[u,m,p,h]);return l.a.createElement(l.a.Fragment,null,e,l.a.createElement(te,{compressed:!0,items:n,columns:v,"data-test-subj":"event-rendered-view",pagination:w,onChange:E,rowProps:({ecs:e})=>Object(V.e)(e)?{className:"EventRenderedView__buildingBlock"}:{}}))},ie=l.a.memo(le),se=(O.i18n.translate("xpack.timelines.timeline.categoryTooltip",{defaultMessage:"Category"}),O.i18n.translate("xpack.timelines.timeline.descriptionTooltip",{defaultMessage:"Description"}),O.i18n.translate("xpack.timelines.timeline.fieldTooltip",{defaultMessage:"Field"}),O.i18n.translate("xpack.timelines.timeline.fullScreenButton",{defaultMessage:"Full screen"}),O.i18n.translate("xpack.timelines.timeline.sortAZLabel",{defaultMessage:"Sort A-Z"}),O.i18n.translate("xpack.timelines.timeline.sortFieldsButton",{defaultMessage:"Sort fields"}),O.i18n.translate("xpack.timelines.timeline.sortZALabel",{defaultMessage:"Sort Z-A"}),O.i18n.translate("xpack.timelines.timeline.typeTooltip",{defaultMessage:"Type"}),O.i18n.translate("xpack.timelines.timeline.flyout.pane.removeColumnButtonLabel",{defaultMessage:"Remove column"})),oe=Object(a.lazy)((()=>n.e(10).then(n.bind(null,123)))),re=e=>$.a(e),de=[],ce=()=>null,ue={border:"none",fontSize:"s",header:"underline"},me=m.a.div.withConfig({displayName:"EuiEventTableContainer",componentId:"sc-1q4165e-0"})(["ul.euiPagination__list{li.euiPagination__item:last-child{",";}}"],(({hideLastPage:e})=>e?"display:none":"")),pe=l.a.memo((({activePage:e,additionalControls:t,appId:n="",browserFields:i,bulkActions:o=!0,clearSelected:m,columnHeaders:g,data:b,defaultCellActions:h,disabledCellActions:v,fieldBrowserOptions:E,filterQuery:C,filters:y,filterStatus:x,getRowRenderer:S,hasAlertsCrud:j,hasAlertsCrudPermissions:O,id:k,indexNames:I,isEventViewer:M=!1,isLoading:T,isSelectAllChecked:P,itemsPerPageOptions:A,leadingControlColumns:D=de,loadingEventIds:R,loadPage:F,onRuleChange:L,pageSize:q,refetch:U,renderCellValue:G,rowRenderers:W,selectedEventIds:K,setSelected:J,showCheckboxes:Z,sort:X,tableView:Y="gridView",tabType:ee,totalItems:te,totalSelectAllAlerts:ne,trailingControlColumns:ae=de,unit:le=re})=>{var pe;const{triggersActionsUi:ge}=Object(p.useKibana)().services,be=Object(a.useRef)(null),he=Object(s.useDispatch)(),fe=Object(a.useMemo)((()=>w.e.getManageDataTableById()),[]),{queryFields:ve,selectAll:Ee,defaultColumns:we}=f((e=>fe(e,k))),Ce=Object(a.useMemo)((()=>`${te.toLocaleString()} ${le(te)}`),[te,le]),ye=Object(a.useMemo)((()=>Object.keys(K).length),[K]),xe=Object(a.useContext)(u.ThemeContext),Se=Object(a.useCallback)((({eventIds:e,isSelected:t})=>{J({id:k,eventIds:Object(V.c)(b,e,ve,null!=j&&j,O),isSelected:t,isSelectAllChecked:t&&ye+1===b.length})}),[J,k,b,ve,j,O,ye]),je=Object(a.useCallback)((({isSelected:e})=>e?J({id:k,eventIds:Object(V.c)(b,b.map((e=>e._id)),ve,null!=j&&j,O),isSelected:e,isSelectAllChecked:e}):m({id:k})),[J,k,b,ve,j,O,m]);Object(a.useEffect)((()=>{Ee&&!P&&je({isSelected:!0})}),[P,je,Ee]);const Oe=Object(a.useMemo)((()=>{if(o&&!0!==o)return o.onAlertStatusActionSuccess}),[o]),ke=Object(a.useMemo)((()=>{if(o&&!0!==o)return o.onAlertStatusActionFailure}),[o]),Ie=Object(a.useMemo)((()=>{if(o&&!0!==o&&void 0!==o.customBulkActions)return o.customBulkActions.map((e=>({...e,onClick:t=>{const n=b.filter((e=>t.find((t=>e._id===t))));e.onClick(n)}})))}),[o,b]),Me=Object(a.useMemo)((()=>{var e;return!!j&&("boolean"==typeof o?o:null===(e=o.alertStatusActions)||void 0===e||e)}),[o,j]),Te=Object(a.useMemo)((()=>{var e,t;return!!j&&!(0===ye||!Z)&&("boolean"==typeof o?o:null===(e=(null==o||null===(t=o.customBulkActions)||void 0===t?void 0:t.length)||(null==o?void 0:o.alertStatusActions))||void 0===e||e)}),[j,ye,Z,o]),Pe=Object(a.useCallback)((()=>{he(w.d.updateColumns({id:k,columns:we}))}),[we,he,k]),Ae=Object(a.useCallback)((e=>{g.some((({id:t})=>e===t))?he(w.d.removeColumn({columnId:e,id:k})):he(w.d.upsertColumn({column:Object(z.b)(e,we),id:k,index:1}))}),[g,he,k,we]),De=Object(a.useMemo)((()=>l.a.createElement(d.EuiFlexGroup,{gutterSize:"m",alignItems:"center"},l.a.createElement(d.EuiFlexItem,{grow:!1},l.a.createElement(H.a,null,Ce)),Te&&l.a.createElement(a.Suspense,{fallback:l.a.createElement(d.EuiLoadingSpinner,null)},l.a.createElement(oe,{showAlertStatusActions:Me,"data-test-subj":"bulk-actions",id:k,totalItems:null!=ne?ne:te,filterStatus:x,query:C,indexName:I.join(),onActionSuccess:Oe,onActionFailure:ke,customBulkActions:Ie,refetch:U})))),[Ie,Ce,C,x,k,I,ke,Oe,U,Me,Te,te,ne]),Re=Object(a.useMemo)((()=>({additionalControls:l.a.createElement(l.a.Fragment,null,T&&l.a.createElement(d.EuiProgress,{size:"xs",position:"absolute",color:"accent"}),l.a.createElement(H.a,{"data-test-subj":"server-side-event-count"},Ce),Te?l.a.createElement(l.a.Fragment,null,l.a.createElement(a.Suspense,{fallback:l.a.createElement(d.EuiLoadingSpinner,null)},l.a.createElement(oe,{showAlertStatusActions:Me,"data-test-subj":"bulk-actions",id:k,totalItems:null!=ne?ne:te,filterStatus:x,query:C,indexName:I.join(),onActionSuccess:Oe,onActionFailure:ke,customBulkActions:Ie,refetch:U})),null!=t?t:null):l.a.createElement(l.a.Fragment,null,null!=t?t:null,ge.getFieldBrowser({browserFields:i,options:E,columnIds:g.map((({id:e})=>e)),onResetColumns:Pe,onToggleColumn:Ae}))),...Te?{showColumnSelector:!1,showSortSelector:!1,showFullScreenSelector:!1}:{showColumnSelector:{allowHide:!1,allowReorder:!0},showSortSelector:!0,showFullScreenSelector:!0},showDisplaySelector:!1})),[T,Ce,Te,Me,k,ne,te,x,C,I,Oe,ke,Pe,Ae,ge,Ie,U,t,i,E,g]),Fe=Object(a.useMemo)((()=>X.map((e=>({id:e.columnId,direction:Object(V.f)(e.sortDirection)})))),[X]),Le=Object(a.useCallback)((e=>{he(w.d.updateSort({id:k,sort:Object(V.g)({columns:e,columnHeaders:g})})),setTimeout((()=>{null!=F&&F(0)}),0)}),[g,he,k,F]),ze=Object(a.useMemo)((()=>g.map((({id:e})=>e))),[g]),Ve=Object(a.useCallback)((({columnId:e,width:t})=>{he(w.d.updateColumnWidth({columnId:e,id:k,width:t}))}),[he,k]),Ne=Object(a.useCallback)((e=>{he(w.d.updateColumnOrder({columnIds:e,id:k}))}),[he,k]),Be=Object(a.useCallback)((({eventIds:e,isLoading:t})=>{he(w.d.setEventsLoading({id:k,eventIds:e,isLoading:t}))}),[he,k]),qe=Object(a.useCallback)((({eventIds:e,isDeleted:t})=>{he(w.d.setEventsDeleted({id:k,eventIds:e,isDeleted:t}))}),[he,k]),[_e,$e]=Object(a.useMemo)((()=>[Z?[Q,...D]:D,ae].map((e=>(({columnHeaders:e,controlColumns:t,data:n,fieldBrowserOptions:a,isEventViewer:i=!1,loadingEventIds:s,onRowSelected:o,onRuleChange:d,selectedEventIds:c,showCheckboxes:u,tabType:m,timelineId:p,isSelectAllChecked:g,onSelectPage:b,browserFields:h,pageSize:f,sort:v,theme:E,setEventsLoading:w,setEventsDeleted:C,hasAlertsCrudPermissions:y})=>t.map((({id:x,headerCellRender:S=ce,rowCellRender:j,width:O},k)=>({id:`${x}`,headerCellRender:()=>{const t=S;return l.a.createElement(l.a.Fragment,null,t&&l.a.createElement(t,{width:O,browserFields:h,fieldBrowserOptions:a,columnHeaders:e,isEventViewer:i,isSelectAllChecked:g,onSelectAll:b,showEventsSelect:!1,showSelectAllCheckbox:u,sort:v,tabType:m,timelineId:p}))},rowCellRender:({isDetails:a,isExpandable:g,isExpanded:b,rowIndex:h,colIndex:v,setCellProps:S})=>{const j=Object(N.a)(h,f),I=n[j];let M=!1;if(I){if(Object(V.a)(I.ecs,E,S),"checkbox-control-column"===x&&null!=y){var T,P,A,D;const e=null!==(T=null===(P=I.data.find((e=>e.field===r.b)))||void 0===P?void 0:P.value)&&void 0!==T?T:[],t=null!==(A=null===(D=I.data.find((e=>e.field===r.d)))||void 0===D?void 0:D.value)&&void 0!==A?A:[];M=!y({ruleConsumer:e.length>0?e[0]:"",ruleProducer:t.length>0?t[0]:void 0})}}else S({style:{display:"none"}});return l.a.createElement(_,{columnId:null!=x?x:"",columnHeaders:e,controlColumn:t[k],data:n,disabled:M,index:k,isDetails:a,isExpanded:b,isEventViewer:i,isExpandable:g,loadingEventIds:s,onRowSelected:o,onRuleChange:d,rowIndex:h,colIndex:v,pageRowIndex:j,selectedEventIds:c,setCellProps:S,showCheckboxes:u,tabType:m,tableId:p,width:O,setEventsLoading:w,setEventsDeleted:C})},width:O}))))({columnHeaders:g,controlColumns:e,data:b,disabledCellActions:v,fieldBrowserOptions:E,isEventViewer:M,loadingEventIds:R,onRowSelected:Se,onRuleChange:L,selectedEventIds:K,showCheckboxes:Z,tabType:ee,timelineId:k,isSelectAllChecked:P,sort:X,browserFields:i,onSelectPage:je,theme:xe,setEventsLoading:Be,setEventsDeleted:qe,pageSize:q,hasAlertsCrudPermissions:O})))),[Z,D,ae,g,b,v,E,M,k,R,Se,L,K,ee,P,X,i,je,xe,q,Be,qe,O]),He=null===(pe=be.current)||void 0===pe?void 0:pe.closeCellPopover,Ue=Object(a.useMemo)((()=>g.map((e=>{var t,n;const a=t=>t({browserFields:i,data:b.map((e=>e.data)),ecsData:b.map((e=>e.ecs)),header:g.find((t=>t.id===e.id)),pageSize:q,scopeId:k,closeCellPopover:He});return{...e,actions:{...e.actions,additional:[{iconType:"cross",label:se,onClick:()=>{he(w.d.removeColumn({id:k,columnId:e.id}))},size:"xs"}]},...Object(V.d)({columnId:e.id,disabledCellActions:v})?{cellActions:null!==(t=null===(n=e.tGridCellActions)||void 0===n?void 0:n.map(a))&&void 0!==t?t:null==h?void 0:h.map(a),visibleCellActions:3}:{}}}))),[i,g,b,h,v,he,k,q,He]),Qe=Object(a.useMemo)((()=>({columnId:e,rowIndex:t,colIndex:n,setCellProps:l,isDetails:s})=>{var o;const r=Object(N.a)(t,q),d=r<b.length?b[r].data:null,u=g.find((t=>t.id===e)),m=r<b.length?b[r]._id:null,p=r<b.length?b[r].ecs:null;return Object(a.useEffect)((()=>{const e={overflow:"hidden"};l({style:{...e}}),p&&d?Object(V.a)(p,xe,l,e):l({style:{display:"none"}})}),[t,l,p,d]),null==d||null==u||null==m||null===p?null:G({browserFields:i,columnId:u.id,data:d,ecsData:p,eventId:m,globalFilters:y,header:u,isDetails:s,isDraggable:!1,isExpandable:!0,isExpanded:!1,linkValues:Object(c.getOr)([],null!==(o=u.linkField)&&void 0!==o?o:"",p),rowIndex:t,colIndex:n,rowRenderers:W,setCellProps:l,scopeId:k,truncate:!s,closeCellPopover:He})}),[i,g,b,y,k,q,G,W,xe,He]),Ge=Object(a.useCallback)((e=>{he(w.d.updateItemsPerPage({id:k,itemsPerPage:e}))}),[k,he]),We=Object(a.useCallback)((e=>{F(e)}),[F]),[Ke]=Object(a.useState)({timelineID:k,tabType:ee,enableHostDetailsFlyout:!0,enableIpDetailsFlyout:!0});return l.a.createElement(l.a.Fragment,null,l.a.createElement(B.a.Provider,{value:Ke},"gridView"===Y&&l.a.createElement(me,{hideLastPage:te>9999},l.a.createElement(d.EuiDataGrid,{id:"body-data-grid","data-test-subj":"body-data-grid","aria-label":$.c,columns:Ue,columnVisibility:{visibleColumns:ze,setVisibleColumns:Ne},gridStyle:ue,leadingControlColumns:_e,trailingControlColumns:$e,toolbarVisibility:Re,rowCount:te,renderCellValue:Qe,sorting:{columns:Fe,onSort:Le},onColumnResize:Ve,pagination:{pageIndex:e,pageSize:q,pageSizeOptions:A,onChangeItemsPerPage:Ge,onChangePage:We},ref:be})),"eventRenderedView"===Y&&l.a.createElement(me,{hideLastPage:te>9999},l.a.createElement(ie,{appId:n,alertToolbar:De,events:b,getRowRenderer:S,leadingControlColumns:null!=_e?_e:[],onChangePage:We,onChangeItemsPerPage:Ge,pageIndex:e,pageSize:q,pageSizeOptions:A,rowRenderers:W,timelineId:k,totalItemCount:te}))))}));pe.displayName="BodyComponent";const ge={clearSelected:w.d.clearSelected,setSelected:w.d.setSelected},be=Object(s.connect)((()=>{const e=L()(z.c),t=w.e.getTGridByIdSelector();return(n,{browserFields:a,id:l,hasAlertsCrud:i})=>{const s=t(n,l),{columns:o,isSelectAllChecked:r,loadingEventIds:d,selectedEventIds:c,showCheckboxes:u,sort:m,isLoading:p}=s;return{columnHeaders:e(o,a),isSelectAllChecked:r,loadingEventIds:d,isLoading:p,id:l,selectedEventIds:c,showCheckboxes:!0===i&&u,sort:m}}}),ge)(pe);var he=n(104),fe=n.n(he);const ve=O.i18n.translate("xpack.timelines.inspectDescription",{defaultMessage:"Inspect"}),Ee=O.i18n.translate("xpack.timelines.inspect.modal.closeTitle",{defaultMessage:"Close"}),we=O.i18n.translate("xpack.timelines.inspect.modal.somethingWentWrongDescription",{defaultMessage:"Sorry about that, something went wrong."}),Ce=O.i18n.translate("xpack.timelines.inspect.modal.indexPatternLabel",{defaultMessage:"Index pattern"}),ye=O.i18n.translate("xpack.timelines.inspect.modal.indexPatternDescription",{defaultMessage:"The index pattern that connected to the Elasticsearch indices. These indices can be configured in Kibana > Advanced Settings."}),xe=O.i18n.translate("xpack.timelines.inspect.modal.queryTimeLabel",{defaultMessage:"Query time"}),Se=O.i18n.translate("xpack.timelines.inspect.modal.queryTimeDescription",{defaultMessage:"The time it took to process the query. Does not include the time to send the request or parse it in the browser."}),je=O.i18n.translate("xpack.timelines.inspect.modal.reqTimestampLabel",{defaultMessage:"Request timestamp"}),Oe=O.i18n.translate("xpack.timelines.inspect.modal.reqTimestampDescription",{defaultMessage:"Time when the start of the request has been logged"}),ke=O.i18n.translate("xpack.timelines.inspect.modal.noAlertIndexFound",{defaultMessage:"No alert index found"}),Ie="no-alert-index-049FC71A-4C2C-446F-9901-37XMC5024C51",Me=m()(d.EuiDescriptionList).withConfig({displayName:"DescriptionListStyled",componentId:"sc-mek2gz-0"})(["@media only screen and (min-width:","){.euiDescriptionList__title{width:30% !important;}.euiDescriptionList__description{width:70% !important;}}"],(e=>{var t,n,a,l;return null!==(t=null==e||null===(n=e.theme)||void 0===n||null===(a=n.eui)||void 0===a||null===(l=a.euiBreakpoints)||void 0===l?void 0:l.s)&&void 0!==t?t:"600px"}));Me.displayName="DescriptionListStyled";const Te=m()(d.EuiModal).withConfig({displayName:"MyEuiModal",componentId:"sc-mek2gz-1"})([".euiModal__flex{width:60vw;}.euiCodeBlock{height:auto !important;max-width:718px;}"]);Te.displayName="MyEuiModal";const Pe=function(e){try{return e.map((e=>JSON.parse(e)))}catch{return[]}},Ae=(e=[])=>1===e.length&&e[0]===Ie?l.a.createElement("i",null,ke):e.length>0?e.filter((e=>e!==Ie)).join(", "):we,De=({closeModal:e,isShowing:t=!1,request:n,response:i,additionalRequests:s,additionalResponses:o,title:r})=>{var c,u,m;if(!t||null==n||null==i)return null;const p=[n,...null!=s?s:[]],g=[i,...null!=o?o:[]],b=Pe(p),h=Pe(g),f=[{title:l.a.createElement("span",{"data-test-subj":"index-pattern-title"},Ce," ",l.a.createElement(d.EuiIconTip,{color:"subdued",content:ye,type:"iInCircle"})),description:l.a.createElement("span",{"data-test-subj":"index-pattern-description"},Ae(null!==(c=null===(u=b[0])||void 0===u?void 0:u.index)&&void 0!==c?c:[]))},{title:l.a.createElement("span",{"data-test-subj":"query-time-title"},xe," ",l.a.createElement(d.EuiIconTip,{color:"subdued",content:Se,type:"iInCircle"})),description:l.a.createElement("span",{"data-test-subj":"query-time-description"},null!==(m=h[0])&&void 0!==m&&m.took?`${fe()(h[0].took).format("0,0")}ms`:we)},{title:l.a.createElement("span",{"data-test-subj":"request-timestamp-title"},je," ",l.a.createElement(d.EuiIconTip,{color:"subdued",content:Oe,type:"iInCircle"})),description:l.a.createElement("span",{"data-test-subj":"request-timestamp-description"},(new Date).toISOString())}],v=[{id:"statistics",name:"Statistics",content:l.a.createElement(l.a.Fragment,null,l.a.createElement(d.EuiSpacer,null),l.a.createElement(Me,{listItems:f,type:"column"}))},{id:"request",name:"Request",content:b.length>0?b.map(((e,t)=>l.a.createElement(a.Fragment,{key:t},l.a.createElement(d.EuiSpacer,null),l.a.createElement(d.EuiCodeBlock,{language:"js",fontSize:"m",paddingSize:"m",color:"dark",overflowHeight:300,isCopyable:!0},(e=>{try{return JSON.stringify(e,null,2)}catch{return we}})(e.body))))):l.a.createElement(d.EuiCodeBlock,null,we)},{id:"response",name:"Response",content:h.length>0?g.map(((e,t)=>l.a.createElement(a.Fragment,{key:t},l.a.createElement(d.EuiSpacer,null),l.a.createElement(d.EuiCodeBlock,{language:"js",fontSize:"m",paddingSize:"m",color:"dark",overflowHeight:300,isCopyable:!0},e)))):l.a.createElement(d.EuiCodeBlock,null,we)}];return l.a.createElement(Te,{onClose:e,"data-test-subj":"modal-inspect-euiModal"},l.a.createElement(d.EuiModalHeader,null,l.a.createElement(d.EuiModalHeaderTitle,null,ve," ",r)),l.a.createElement(d.EuiModalBody,null,l.a.createElement(d.EuiTabbedContent,{tabs:v,initialSelectedTab:v[0],autoFocus:"selected"})),l.a.createElement(d.EuiModalFooter,null,l.a.createElement(d.EuiButton,{onClick:e,fill:!0,"data-test-subj":"modal-inspect-close"},Ee)))},Re="inspectButtonComponent",Fe=m.a.div.withConfig({displayName:"InspectButtonContainer",componentId:"sc-16hfz2f-0"})(["width:100%;display:flex;flex-grow:1;> *{max-width:100%;}.","{pointer-events:none;opacity:0;transition:opacity "," ease;}",""],Re,(e=>Object(c.getOr)(250,"theme.eui.euiAnimSpeedNormal",e)),(({show:e})=>e&&Object(u.css)(["&:hover .","{pointer-events:auto;opacity:1;}"],Re)));Fe.displayName="InspectButtonContainer",Fe.defaultProps={show:!0};const Le=({inspect:e,isDisabled:t,loading:n,onCloseInspect:i,title:s=""})=>{const[o,r]=Object(a.useState)(!1),c=!n&&o,u=Object(a.useCallback)((()=>{r(!0)}),[]),m=Object(a.useCallback)((()=>{null!=i&&i(),r(!1)}),[i,r]);let p=null;null!=e&&e.dsl.length>0&&(p=e.dsl[0]);let g=null;return null!=e&&e.response.length>0&&(g=e.response[0]),l.a.createElement(l.a.Fragment,null,l.a.createElement(d.EuiButtonIcon,{className:Re,"aria-label":ve,"data-test-subj":"inspect-icon-button",iconSize:"m",iconType:"inspect",isDisabled:n||t,title:ve,onClick:u}),l.a.createElement(De,{closeModal:m,isShowing:c,request:p,response:g,title:s,"data-test-subj":"inspect-modal"}))},ze=l.a.memo(Le),Ve=new o.Storage(localStorage),Ne=m.a.div.withConfig({displayName:"ContainerEuiSelectable",componentId:"sc-etesyi-0"})(["width:300px;.euiSelectableListItem__text{white-space:pre-wrap !important;line-height:normal;}"]),Be=O.i18n.translate("xpack.timelines.alerts.summaryView.gridView.label",{defaultMessage:"Grid view"}),qe=O.i18n.translate("xpack.timelines.alerts.summaryView.eventRendererView.label",{defaultMessage:"Event rendered view"}),_e=({viewSelected:e,onViewChange:t})=>{const[n,i]=Object(a.useState)(!1),s=Object(a.useCallback)((()=>i((e=>!e))),[]),o=Object(a.useCallback)((()=>i(!1)),[]),r=Object(a.useCallback)((e=>{var n,a;const l=e.filter((e=>"on"===e.checked));var s,o;Ve.set(E.a,null!==(n=null===(a=l[0])||void 0===a?void 0:a.key)&&void 0!==n?n:"gridView"),l.length>0&&t(null!==(s=null===(o=l[0])||void 0===o?void 0:o.key)&&void 0!==s?s:"gridView"),i(!1)}),[t]),c=Object(a.useMemo)((()=>l.a.createElement(d.EuiButtonEmpty,{iconType:"arrowDown",iconSide:"right",iconSize:"s",onClick:s,size:"xs",flush:"both",style:{fontWeight:"normal"}},"gridView"===e?Be:qe)),[s,e]),u=Object(a.useMemo)((()=>[{label:Be,key:"gridView",checked:"gridView"===e?"on":void 0,meta:[{text:O.i18n.translate("xpack.timelines.alerts.summaryView.options.default.description",{defaultMessage:"View as tabular data with the ability to group and sort by specific fields"})}]},{label:qe,key:"eventRenderedView",checked:"eventRenderedView"===e?"on":void 0,meta:[{text:O.i18n.translate("xpack.timelines.alerts.summaryView.options.summaryView.description",{defaultMessage:"View a rendering of the event flow for each alert"})}]}]),[e]),m=Object(a.useCallback)((e=>l.a.createElement(l.a.Fragment,null,l.a.createElement(d.EuiTitle,{size:"xxs"},l.a.createElement("h6",null,e.label)),l.a.createElement(d.EuiTextColor,{color:"subdued"},l.a.createElement("small",null,e.meta[0].text)))),[]),p=Object(a.useMemo)((()=>({rowHeight:80,showIcons:!0})),[]);return l.a.createElement(d.EuiPopover,{panelPaddingSize:"none",button:c,isOpen:n,closePopover:o},l.a.createElement(Ne,null,l.a.createElement(d.EuiSelectable,{options:u,onChange:r,renderOption:m,searchable:!1,height:160,listProps:p,singleSelection:!0},(e=>e))))},$e=l.a.memo(_e);var He=n(31);const Ue=new o.Storage(localStorage),Qe=m.a.span.withConfig({displayName:"TitleText",componentId:"sc-17dw9c-0"})(["margin-right:12px;"]),Ge=m()(d.EuiPanel).withConfig({displayName:"StyledEuiPanel",componentId:"sc-17dw9c-1"})(["display:flex;flex-direction:column;position:relative;width:100%;",""],(({$isFullScreen:e})=>e&&"\n      border: 0;\n      box-shadow: none;\n      padding-top: 0;\n      padding-bottom: 0;\n  ")),We=m.a.div.attrs((({className:e=""})=>({className:`${H.c} ${e}`}))).withConfig({displayName:"EventsContainerLoading",componentId:"sc-17dw9c-2"})(["position:relative;width:100%;overflow:hidden;flex:1;display:flex;flex-direction:column;"]),Ke=m()(d.EuiFlexGroup).withConfig({displayName:"FullWidthFlexGroup",componentId:"sc-17dw9c-3"})(["overflow:hidden;margin:0;display:",";"],(({$visible:e})=>e?"flex":"none")),Je=m()(d.EuiFlexItem).withConfig({displayName:"ScrollableFlexItem",componentId:"sc-17dw9c-4"})(["overflow:auto;"]),Ze=[r.f.SIEM],Xe=({additionalFilters:e,appId:t,browserFields:n,bulkActions:i=!0,columns:o,data:r,dataViewId:d=null,defaultCellActions:u,deletedEventIds:m,disabledCellActions:b,end:j,entityType:O,fieldBrowserOptions:F,filters:L,filterStatus:z,getRowRenderer:V,globalFullScreen:N,graphEventId:B,graphOverlay:q=null,id:_,indexNames:$,indexPattern:U,isLoadingIndexPattern:Q,itemsPerPage:G,itemsPerPageOptions:W,leadingControlColumns:K,onRuleChange:J,query:Z,renderCellValue:X,rowRenderers:Y,runtimeMappings:ee,setQuery:te,sort:ne,start:ae,tGridEventRenderedViewEnabled:le,trailingControlColumns:ie,unit:se})=>{const oe=Object(s.useDispatch)(),re=Object(c.isEmpty)(o)?v.b:o,{uiSettings:de}=Object(p.useKibana)().services,[ce,ue]=Object(a.useState)(Object(E.d)({timelineId:_,value:Ue.get(E.a)})),me=Object(a.useMemo)((()=>w.e.getManageDataTableById()),[]),{queryFields:pe,title:ge}=f((e=>me(e,null!=_?_:""))),he=Object(a.useMemo)((()=>l.a.createElement(Qe,{"data-test-subj":"title"},ge)),[ge]),fe=Object(g.getEsQueryConfig)(de),ve=Object(a.useMemo)((()=>Object(E.c)({config:fe,browserFields:n,dataProviders:[],filters:L,from:ae,indexPattern:U,kqlMode:"filter",kqlQuery:Z,to:j})),[fe,U,n,L,ae,j,Z]),Ee=Object(a.useMemo)((()=>null!=ve&&null!=Q&&!Q&&!Object(c.isEmpty)(ae)&&!Object(c.isEmpty)(j)),[Q,ve,ae,j]),we=Object(a.useMemo)((()=>[...re.map((e=>e.id)),...null!=pe?pe:[]]),[re,pe]),Ce=Object(a.useMemo)((()=>ne.map((({columnId:e,columnType:t,esTypes:n,sortDirection:a})=>({field:e,type:t,direction:a,esTypes:null!=n?n:[]})))),[ne]),[ye,{events:xe,loadPage:Se,pageInfo:je,refetch:Oe,totalCount:ke=0,inspect:Ie}]=(({alertConsumers:e=R,dataViewId:t,endDate:n,entityType:l,excludeEcsData:i=!1,id:o=A,indexNames:r,fields:d,filterQuery:u,filterStatus:m,startDate:p,language:b="kuery",limit:f,runtimeMappings:v,sort:E=D,skip:w=!1,timerangeKind:j,data:O})=>{const[F,L,z]=(({alertConsumers:e=R,dataViewId:t,endDate:n,entityType:l,excludeEcsData:i=!1,id:o=A,indexNames:r,fields:d,filterQuery:u,startDate:m,language:p="kuery",limit:b,runtimeMappings:f,sort:v=D,skip:E=!1,data:w,filterStatus:j})=>{const O=Object(s.useDispatch)(),{startTracking:F}=(e=>{const{startTransaction:t}=Object(I.b)();return{startTracking:Object(a.useCallback)((()=>{const n=t({name:Object(I.a)(e),type:"http-request",options:{managed:!1}}),a=null==n?void 0:n.startSpan("batched search","http-request",{blocking:!0});return{endTracking:e=>{null==n||n.addLabels({result:e}),null==a||a.end()}}}),[t,e])}})(o),L=Object(a.useRef)(c.noop),z=Object(a.useRef)(new AbortController),V=Object(a.useRef)(new C.Subscription),[N,B]=Object(a.useState)(!0),[q,_]=Object(a.useState)(0),[$,H]=Object(a.useState)(null),[U,Q]=Object(a.useState)(j),G=Object(a.useRef)(null),W=Object(a.useCallback)((()=>{null!=o&&M.some((e=>e===o))&&(O(Object(y.clearEventsLoading)({id:o})),O(Object(y.clearEventsDeleted)({id:o})))}),[O,o]),K=Object(a.useCallback)((e=>{W(),_(e)}),[W]),J=Object(a.useCallback)((()=>{null!=L.current&&L.current(),K(0)}),[K]),Z=Object(a.useCallback)((e=>{O(Object(y.setTableUpdatedAt)({id:o,updated:e}))}),[O,o]),X=Object(a.useCallback)((e=>O(Object(y.updateTotalCount)({id:o,totalCount:e}))),[O,o]),[Y,ee]=Object(a.useState)({consumers:{},id:o,inspect:{dsl:[],response:[]},refetch:J,totalCount:-1,pageInfo:{activePage:0,querySize:0},events:[],loadPage:K,updatedAt:0}),{addWarning:te}=Object(S.a)(),ne=Object(a.useCallback)(((e,n)=>{if(null==e||E)return;const a=async()=>{if(G.current=e,z.current=new AbortController,B(!0),w&&w.search){const{endTracking:a}=F(),i=z.current.signal;V.current=w.search.search({...e,entityType:l},{strategy:"eql"===e.language?"timelineEqlSearchStrategy":"timelineSearchStrategy",abortSignal:i,indexPattern:{id:t}}).subscribe({next:t=>{Object(g.isCompleteResponse)(t)?(a("success"),ee((e=>{const a={...e,consumers:t.consumers,events:(l=t.edges,l.map((e=>e.node))),inspect:P(t,e.inspect),pageInfo:t.pageInfo,totalCount:t.totalCount,updatedAt:Date.now()};var l;return Z(a.updatedAt),X(a.totalCount),n&&n(a),a})),U!==e.filterStatus&&O(Object(y.updateGraphEventId)({id:o,graphEventId:""})),Q(e.filterStatus),B(!1),V.current.unsubscribe()):Object(g.isErrorResponse)(t)&&(a("invalid"),B(!1),te(k),V.current.unsubscribe())},error:e=>{a(i.aborted?"aborted":"error"),B(!1),w.search.showError(e),V.current.unsubscribe()}})}};V.current.unsubscribe(),z.current.abort(),a(),L.current=a}),[E,w,X,l,t,Z,te,F,O,o,U]);Object(a.useEffect)((()=>{0!==r.length&&H((t=>{var a,l,s,o,c,g;const E={defaultIndex:null!==(a=null==t?void 0:t.defaultIndex)&&void 0!==a?a:[],filterQuery:null!==(l=null==t?void 0:t.filterQuery)&&void 0!==l?l:"",querySize:null!==(s=null==t?void 0:t.pagination.querySize)&&void 0!==s?s:0,sort:null!==(o=null==t?void 0:t.sort)&&void 0!==o?o:D,timerange:null!==(c=null==t?void 0:t.timerange)&&void 0!==c?c:{},runtimeMappings:null!==(g=null==t?void 0:t.runtimeMappings)&&void 0!==g?g:{},filterStatus:null==t?void 0:t.filterStatus},w={defaultIndex:r,filterQuery:T(u),querySize:b,sort:v,runtimeMappings:f,timerange:{interval:"12h",from:m,to:n},filterStatus:j},C=h()(E,w)?q:0,y={alertConsumers:e,defaultIndex:r,excludeEcsData:i,factoryQueryType:x.f.all,fieldRequested:d,fields:[],filterQuery:T(u),pagination:{activePage:C,querySize:b},language:p,runtimeMappings:f,sort:v,timerange:{interval:"12h",from:m,to:n},filterStatus:j};return q!==C&&_(C),h()(t,y)?t:y}))}),[e,O,r,q,n,i,u,o,p,b,m,v,d,f,j]);const ae=Object(a.useCallback)((e=>{h()(G.current,$)||ne($,e)}),[$,ne]);return Object(a.useEffect)((()=>{Object(c.isEmpty)(u)&&ee({consumers:{},id:o,inspect:{dsl:[],response:[]},refetch:J,totalCount:-1,pageInfo:{activePage:0,querySize:0},events:[],loadPage:K,updatedAt:0})}),[u,o,J,K]),[N,Y,ae]})({alertConsumers:e,dataViewId:t,endDate:n,entityType:l,excludeEcsData:i,filterStatus:m,id:o,indexNames:r,fields:d,filterQuery:u,startDate:p,language:b,limit:f,runtimeMappings:v,sort:E,skip:w,timerangeKind:j,data:O});return Object(a.useEffect)((()=>{z&&z()}),[z]),[F,L]})({alertConsumers:Ze,data:r,dataViewId:d,endDate:j,entityType:O,fields:we,filterQuery:ve,id:_,indexNames:$,limit:G,runtimeMappings:ee,skip:!Ee,sort:Ce,startDate:ae,filterStatus:z});Object(a.useEffect)((()=>{oe(w.d.updateIsLoading({id:_,isLoading:ye}))}),[oe,_,ye]);const Me=Object(a.useMemo)((()=>ke>0?ke-m.length:0),[m.length,ke]),Te=Me>0,Pe=ye&&!Te,Ae=Object(a.useMemo)((()=>xe.filter((e=>!m.includes(e._id)))),[m,xe]),De="gridView"===ce?"baseline":"center";Object(a.useEffect)((()=>{te(Ie,ye,Oe)}),[Ie,ye,Oe,te]);const Re=Object(a.useMemo)((()=>({tableId:_})),[_]);return Object(a.useEffect)((()=>{oe(w.d.clearSelected({id:_})),oe(w.d.setTGridSelectAll({id:_,selectAll:!1}))}),[Ae,oe,_]),l.a.createElement(Fe,null,l.a.createElement(Ge,{hasBorder:!1,hasShadow:!1,paddingSize:"none","data-test-subj":"events-viewer-panel",$isFullScreen:N},Pe&&l.a.createElement(He.b,{height:"short"}),q,Ee&&l.a.createElement(He.c.Provider,{value:Re},l.a.createElement(We,{"data-timeline-id":_,"data-test-subj":`events-container-loading-${ye}`},l.a.createElement(H.d,{alignItems:De,"data-test-subj":"updated-flex-group",gutterSize:"m",justifyContent:"flexEnd",$view:ce},l.a.createElement(H.e,{grow:!1,$show:!ye},l.a.createElement(ze,{title:he,inspect:Ie,loading:ye})),l.a.createElement(H.e,{grow:!1,$show:!ye},!Object(E.e)(B)&&e),le&&["alerts-page","alerts-rules-details-page"].includes(_)&&l.a.createElement(H.e,{grow:!1,$show:!ye},l.a.createElement($e,{viewSelected:ce,onViewChange:ue}))),l.a.createElement(l.a.Fragment,null,!Te&&!ye&&!q&&l.a.createElement(He.a,{height:"short"}),Te&&l.a.createElement(Ke,{$visible:!B&&null==q,gutterSize:"none"},l.a.createElement(Je,{grow:1},l.a.createElement(be,{activePage:je.activePage,appId:t,browserFields:n,bulkActions:i,data:Ae,defaultCellActions:u,disabledCellActions:b,fieldBrowserOptions:F,filterQuery:ve,filters:L,filterStatus:z,hasAlertsCrud:!0,getRowRenderer:V,id:_,indexNames:$,isEventViewer:!0,itemsPerPageOptions:W,leadingControlColumns:K,loadPage:Se,onRuleChange:J,pageSize:G,refetch:Oe,renderCellValue:X,rowRenderers:Y,tableView:ce,tabType:"query",totalItems:Me,trailingControlColumns:ie,unit:se}))))))))},Ye=l.a.memo(Xe),et=e=>{const{type:t,...n}=e;return"embedded"===t?l.a.createElement(Ye,n):null};var tt=n(7),nt=n(106),at=n(28),lt=n(25),it=n(48);const st=[at.b],ot=({browserFields:e,defaultsHeader:t,children:n})=>{const i=Object(s.useDispatch)(),o=Object(a.useCallback)((n=>{try{var a,l;ct(),Object(tt.l)(n)&&Object(lt.a)({browserFields:e,defaultsHeader:t,dispatch:i,result:n,timelineId:Object(lt.c)(null!==(a=null===(l=n.destination)||void 0===l?void 0:l.droppableId)&&void 0!==a?a:"")})}finally{document.body.classList.remove(tt.e),Object(tt.k)(n)&&document.body.classList.remove(tt.f)}}),[e,t,i]);return l.a.createElement(nt.DragDropContext,{onDragEnd:o,onBeforeCapture:dt,sensors:st},n)};ot.displayName="DragDropContextWrapperComponent";const rt=l.a.memo(ot,((e,t)=>h()(e.children,t.children)));rt.displayName="DragDropContextWrapper";const dt=e=>{Object(tt.k)(e)||document.body.classList.add(tt.e),Object(tt.k)(e)&&document.body.classList.add(tt.f)},ct=()=>window.onscroll=()=>c.noop;var ut=n(114),mt=n(113);const pt={},gt=e=>{const{store:t,storage:n,setStore:a,...o}=e;let r=pt;return null!=o.browserFields&&(r=o.browserFields),l.a.createElement(s.Provider,{store:t},l.a.createElement(i.I18nProvider,null,l.a.createElement(rt,{browserFields:r,defaultsHeader:e.columns},l.a.createElement(et,o))))}}}]);