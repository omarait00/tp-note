/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.upgradeAssistant_bundle_jsonpfunction=window.upgradeAssistant_bundle_jsonpfunction||[]).push([[1],Array(34).concat([function(e,t,s){"use strict";var a,i=function(){var e={};return function(t){if(void 0===e[t]){var s=document.querySelector(t);if(window.HTMLIFrameElement&&s instanceof window.HTMLIFrameElement)try{s=s.contentDocument.head}catch(e){s=null}e[t]=s}return e[t]}}(),n=[];function r(e){for(var t=-1,s=0;s<n.length;s++)if(n[s].identifier===e){t=s;break}return t}function o(e,t){for(var s={},a=[],i=0;i<e.length;i++){var o=e[i],l=t.base?o[0]+t.base:o[0],u=s[l]||0,c="".concat(l," ").concat(u);s[l]=u+1;var d=r(c),p={css:o[1],media:o[2],sourceMap:o[3]};-1!==d?(n[d].references++,n[d].updater(p)):n.push({identifier:c,updater:x(p,t),references:1}),a.push(c)}return a}function l(e){var t=document.createElement("style"),a=e.attributes||{};if(void 0===a.nonce){var n=s.nc;n&&(a.nonce=n)}if(Object.keys(a).forEach((function(e){t.setAttribute(e,a[e])})),"function"==typeof e.insert)e.insert(t);else{var r=i(e.insert||"head");if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(t)}return t}var u,c=(u=[],function(e,t){return u[e]=t,u.filter(Boolean).join("\n")});function d(e,t,s,a){var i=s?"":a.media?"@media ".concat(a.media," {").concat(a.css,"}"):a.css;if(e.styleSheet)e.styleSheet.cssText=c(t,i);else{var n=document.createTextNode(i),r=e.childNodes;r[t]&&e.removeChild(r[t]),r.length?e.insertBefore(n,r[t]):e.appendChild(n)}}function p(e,t,s){var a=s.css,i=s.media,n=s.sourceMap;if(i?e.setAttribute("media",i):e.removeAttribute("media"),n&&"undefined"!=typeof btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(n))))," */")),e.styleSheet)e.styleSheet.cssText=a;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(a))}}var g=null,j=0;function x(e,t){var s,a,i;if(t.singleton){var n=j++;s=g||(g=l(t)),a=d.bind(null,s,n,!1),i=d.bind(null,s,n,!0)}else s=l(t),a=p.bind(null,s,t),i=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(s)};return a(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;a(e=t)}else i()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===a&&(a=Boolean(window&&document&&document.all&&!window.atob)),a));var s=o(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var a=0;a<s.length;a++){var i=r(s[a]);n[i].references--}for(var l=o(e,t),u=0;u<s.length;u++){var c=r(s[u]);0===n[c].references&&(n[c].updater(),n.splice(c,1))}s=l}}}},function(e,t,s){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var s=function(e,t){var s,a,i,n=e[1]||"",r=e[3];if(!r)return n;if(t&&"function"==typeof btoa){var o=(s=r,a=btoa(unescape(encodeURIComponent(JSON.stringify(s)))),i="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),"/*# ".concat(i," */")),l=r.sources.map((function(e){return"/*# sourceURL=".concat(r.sourceRoot||"").concat(e," */")}));return[n].concat(l).concat([o]).join("\n")}return[n].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(s,"}"):s})).join("")},t.i=function(e,s,a){"string"==typeof e&&(e=[[null,e,""]]);var i={};if(a)for(var n=0;n<this.length;n++){var r=this[n][0];null!=r&&(i[r]=!0)}for(var o=0;o<e.length;o++){var l=[].concat(e[o]);a&&i[l[0]]||(s&&(l[2]?l[2]="".concat(s," and ").concat(l[2]):l[2]=s),t.push(l))}},t}},function(e,t){var s="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(s){var a=new Uint8Array(16);e.exports=function(){return s(a),a}}else{var i=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i}}},function(e,t){for(var s=[],a=0;a<256;++a)s[a]=(a+256).toString(16).substr(1);e.exports=function(e,t){var a=t||0,i=s;return[i[e[a++]],i[e[a++]],i[e[a++]],i[e[a++]],"-",i[e[a++]],i[e[a++]],"-",i[e[a++]],i[e[a++]],"-",i[e[a++]],i[e[a++]],"-",i[e[a++]],i[e[a++]],i[e[a++]],i[e[a++]],i[e[a++]],i[e[a++]]].join("")}},function(e,t,s){"use strict";function a(e){return e}function i(e){throw new Error("Called `absurd` function which should be uncallable")}Object.defineProperty(t,"__esModule",{value:!0}),t.bindTo_=t.bind_=t.hole=t.pipe=t.untupled=t.tupled=t.absurd=t.decrement=t.increment=t.tuple=t.flow=t.flip=t.constVoid=t.constUndefined=t.constNull=t.constFalse=t.constTrue=t.constant=t.not=t.unsafeCoerce=t.identity=void 0,t.identity=a,t.unsafeCoerce=a,t.not=function(e){return function(t){return!e(t)}},t.constant=function(e){return function(){return e}},t.constTrue=function(){return!0},t.constFalse=function(){return!1},t.constNull=function(){return null},t.constUndefined=function(){},t.constVoid=function(){},t.flip=function(e){return function(t,s){return e(s,t)}},t.flow=function(e,t,s,a,i,n,r,o,l){switch(arguments.length){case 1:return e;case 2:return function(){return t(e.apply(this,arguments))};case 3:return function(){return s(t(e.apply(this,arguments)))};case 4:return function(){return a(s(t(e.apply(this,arguments))))};case 5:return function(){return i(a(s(t(e.apply(this,arguments)))))};case 6:return function(){return n(i(a(s(t(e.apply(this,arguments))))))};case 7:return function(){return r(n(i(a(s(t(e.apply(this,arguments)))))))};case 8:return function(){return o(r(n(i(a(s(t(e.apply(this,arguments))))))))};case 9:return function(){return l(o(r(n(i(a(s(t(e.apply(this,arguments)))))))))}}},t.tuple=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e},t.increment=function(e){return e+1},t.decrement=function(e){return e-1},t.absurd=i,t.tupled=function(e){return function(t){return e.apply(void 0,t)}},t.untupled=function(e){return function(){for(var t=[],s=0;s<arguments.length;s++)t[s]=arguments[s];return e(t)}},t.pipe=function(e,t,s,a,i,n,r,o,l,u,c,d,p,g,j,x,b,f,m,O){switch(arguments.length){case 1:return e;case 2:return t(e);case 3:return s(t(e));case 4:return a(s(t(e)));case 5:return i(a(s(t(e))));case 6:return n(i(a(s(t(e)))));case 7:return r(n(i(a(s(t(e))))));case 8:return o(r(n(i(a(s(t(e)))))));case 9:return l(o(r(n(i(a(s(t(e))))))));case 10:return u(l(o(r(n(i(a(s(t(e)))))))));case 11:return c(u(l(o(r(n(i(a(s(t(e))))))))));case 12:return d(c(u(l(o(r(n(i(a(s(t(e)))))))))));case 13:return p(d(c(u(l(o(r(n(i(a(s(t(e))))))))))));case 14:return g(p(d(c(u(l(o(r(n(i(a(s(t(e)))))))))))));case 15:return j(g(p(d(c(u(l(o(r(n(i(a(s(t(e))))))))))))));case 16:return x(j(g(p(d(c(u(l(o(r(n(i(a(s(t(e)))))))))))))));case 17:return b(x(j(g(p(d(c(u(l(o(r(n(i(a(s(t(e))))))))))))))));case 18:return f(b(x(j(g(p(d(c(u(l(o(r(n(i(a(s(t(e)))))))))))))))));case 19:return m(f(b(x(j(g(p(d(c(u(l(o(r(n(i(a(s(t(e))))))))))))))))));case 20:return O(m(f(b(x(j(g(p(d(c(u(l(o(r(n(i(a(s(t(e)))))))))))))))))))}},t.hole=i,t.bind_=function(e,t,s){var a;return Object.assign({},e,((a={})[t]=s,a))},t.bindTo_=function(e){return function(t){var s;return(s={})[e]=t,s}}},function(e,t,s){e.exports=s(7)(3)},function(e,t,s){var a=s(41),i=s(42),n=i;n.v1=a,n.v4=i,e.exports=n},function(e,t,s){var a,i,n=s(36),r=s(37),o=0,l=0;e.exports=function(e,t,s){var u=t&&s||0,c=t||[],d=(e=e||{}).node||a,p=void 0!==e.clockseq?e.clockseq:i;if(null==d||null==p){var g=n();null==d&&(d=a=[1|g[0],g[1],g[2],g[3],g[4],g[5]]),null==p&&(p=i=16383&(g[6]<<8|g[7]))}var j=void 0!==e.msecs?e.msecs:(new Date).getTime(),x=void 0!==e.nsecs?e.nsecs:l+1,b=j-o+(x-l)/1e4;if(b<0&&void 0===e.clockseq&&(p=p+1&16383),(b<0||j>o)&&void 0===e.nsecs&&(x=0),x>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");o=j,l=x,i=p;var f=(1e4*(268435455&(j+=122192928e5))+x)%4294967296;c[u++]=f>>>24&255,c[u++]=f>>>16&255,c[u++]=f>>>8&255,c[u++]=255&f;var m=j/4294967296*1e4&268435455;c[u++]=m>>>8&255,c[u++]=255&m,c[u++]=m>>>24&15|16,c[u++]=m>>>16&255,c[u++]=p>>>8|128,c[u++]=255&p;for(var O=0;O<6;++O)c[u+O]=d[O];return t||r(c)}},function(e,t,s){var a=s(36),i=s(37);e.exports=function(e,t,s){var n=t&&s||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var r=(e=e||{}).random||(e.rng||a)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t)for(var o=0;o<16;++o)t[n+o]=r[o];return t||i(r)}},function(e,t,s){switch(window.__kbnThemeTag__){case"v8dark":return s(44);case"v8light":return s(46)}},function(e,t,s){var a=s(34),i=s(45);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,s){(t=s(35)(!1)).push([e.i,".upgResolveStep{margin-bottom:24px}",""]),e.exports=t},function(e,t,s){var a=s(34),i=s(47);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,s){(t=s(35)(!1)).push([e.i,".upgResolveStep{margin-bottom:24px}",""]),e.exports=t},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pipeable=t.pipe=void 0;var a=s(38);t.pipe=a.pipe,t.pipeable=function(e){var t={};return function(e){return"function"==typeof e.map}(e)&&(t.map=function(t){return function(s){return e.map(s,t)}}),function(e){return"function"==typeof e.contramap}(e)&&(t.contramap=function(t){return function(s){return e.contramap(s,t)}}),function(e){return"function"==typeof e.mapWithIndex}(e)&&(t.mapWithIndex=function(t){return function(s){return e.mapWithIndex(s,t)}}),function(e){return"function"==typeof e.ap}(e)&&(t.ap=function(t){return function(s){return e.ap(s,t)}},t.apFirst=function(t){return function(s){return e.ap(e.map(s,(function(e){return function(){return e}})),t)}},t.apSecond=function(t){return function(s){return e.ap(e.map(s,(function(){return function(e){return e}})),t)}}),function(e){return"function"==typeof e.chain}(e)&&(t.chain=function(t){return function(s){return e.chain(s,t)}},t.chainFirst=function(t){return function(s){return e.chain(s,(function(s){return e.map(t(s),(function(){return s}))}))}},t.flatten=function(t){return e.chain(t,a.identity)}),function(e){return"function"==typeof e.bimap}(e)&&(t.bimap=function(t,s){return function(a){return e.bimap(a,t,s)}},t.mapLeft=function(t){return function(s){return e.mapLeft(s,t)}}),function(e){return"function"==typeof e.extend}(e)&&(t.extend=function(t){return function(s){return e.extend(s,t)}},t.duplicate=function(t){return e.extend(t,a.identity)}),function(e){return"function"==typeof e.reduce}(e)&&(t.reduce=function(t,s){return function(a){return e.reduce(a,t,s)}},t.foldMap=function(t){var s=e.foldMap(t);return function(e){return function(t){return s(t,e)}}},t.reduceRight=function(t,s){return function(a){return e.reduceRight(a,t,s)}}),function(e){return"function"==typeof e.reduceWithIndex}(e)&&(t.reduceWithIndex=function(t,s){return function(a){return e.reduceWithIndex(a,t,s)}},t.foldMapWithIndex=function(t){var s=e.foldMapWithIndex(t);return function(e){return function(t){return s(t,e)}}},t.reduceRightWithIndex=function(t,s){return function(a){return e.reduceRightWithIndex(a,t,s)}}),function(e){return"function"==typeof e.alt}(e)&&(t.alt=function(t){return function(s){return e.alt(s,t)}}),function(e){return"function"==typeof e.compact}(e)&&(t.compact=e.compact,t.separate=e.separate),function(e){return"function"==typeof e.filter}(e)&&(t.filter=function(t){return function(s){return e.filter(s,t)}},t.filterMap=function(t){return function(s){return e.filterMap(s,t)}},t.partition=function(t){return function(s){return e.partition(s,t)}},t.partitionMap=function(t){return function(s){return e.partitionMap(s,t)}}),function(e){return"function"==typeof e.filterWithIndex}(e)&&(t.filterWithIndex=function(t){return function(s){return e.filterWithIndex(s,t)}},t.filterMapWithIndex=function(t){return function(s){return e.filterMapWithIndex(s,t)}},t.partitionWithIndex=function(t){return function(s){return e.partitionWithIndex(s,t)}},t.partitionMapWithIndex=function(t){return function(s){return e.partitionMapWithIndex(s,t)}}),function(e){return"function"==typeof e.promap}(e)&&(t.promap=function(t,s){return function(a){return e.promap(a,t,s)}}),function(e){return"function"==typeof e.compose}(e)&&(t.compose=function(t){return function(s){return e.compose(s,t)}}),function(e){return"function"==typeof e.throwError}(e)&&(t.fromOption=function(t){return function(s){return"None"===s._tag?e.throwError(t()):e.of(s.value)}},t.fromEither=function(t){return"Left"===t._tag?e.throwError(t.left):e.of(t.right)},t.fromPredicate=function(t,s){return function(a){return t(a)?e.of(a):e.throwError(s(a))}},t.filterOrElse=function(t,s){return function(a){return e.chain(a,(function(a){return t(a)?e.of(a):e.throwError(s(a))}))}}),t}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.apS=t.apSW=t.bind=t.bindW=t.bindTo=t.exists=t.elem=t.toError=t.either=t.getValidationMonoid=t.MonadThrow=t.ChainRec=t.Extend=t.Alt=t.Bifunctor=t.Traversable=t.Foldable=t.Monad=t.Applicative=t.Functor=t.getValidationSemigroup=t.getValidation=t.getAltValidation=t.getApplicativeValidation=t.getWitherable=t.getFilterable=t.getApplyMonoid=t.getApplySemigroup=t.getSemigroup=t.getEq=t.getShow=t.URI=t.throwError=t.sequence=t.traverse=t.reduceRight=t.foldMap=t.reduce=t.duplicate=t.extend=t.alt=t.flatten=t.chainFirst=t.chainFirstW=t.chain=t.chainW=t.of=t.apSecond=t.apFirst=t.ap=t.apW=t.mapLeft=t.bimap=t.map=t.filterOrElse=t.orElse=t.swap=t.getOrElse=t.getOrElseW=t.fold=t.fromPredicate=t.fromOption=t.stringifyJSON=t.parseJSON=t.tryCatch=t.fromNullable=t.right=t.left=t.isRight=t.isLeft=void 0;var a=s(50),i=s(38);function n(e,s){try{return t.right(e())}catch(e){return t.left(s(e))}}t.isLeft=function(e){return"Left"===e._tag},t.isRight=function(e){return"Right"===e._tag},t.left=function(e){return{_tag:"Left",left:e}},t.right=function(e){return{_tag:"Right",right:e}},t.fromNullable=function(e){return function(s){return null==s?t.left(e):t.right(s)}},t.tryCatch=n,t.parseJSON=function(e,t){return n((function(){return JSON.parse(e)}),t)},t.stringifyJSON=function(e,t){return n((function(){return JSON.stringify(e)}),t)},t.fromOption=function(e){return function(s){return"None"===s._tag?t.left(e()):t.right(s.value)}},t.fromPredicate=function(e,s){return function(a){return e(a)?t.right(a):t.left(s(a))}},t.fold=function(e,s){return function(a){return t.isLeft(a)?e(a.left):s(a.right)}},t.getOrElseW=function(e){return function(s){return t.isLeft(s)?e(s.left):s.right}},t.getOrElse=t.getOrElseW,t.swap=function(e){return t.isLeft(e)?t.right(e.left):t.left(e.right)},t.orElse=function(e){return function(s){return t.isLeft(s)?e(s.left):s}},t.filterOrElse=function(e,s){return t.chain((function(a){return e(a)?t.right(a):t.left(s(a))}))};var r=function(e,s){return i.pipe(e,t.map(s))},o=function(e,s){return i.pipe(e,t.ap(s))},l=function(e,s){return i.pipe(e,t.chain(s))},u=function(e,s,a){return i.pipe(e,t.reduce(s,a))},c=function(e){return function(s,a){var n=t.foldMap(e);return i.pipe(s,n(a))}},d=function(e,s,a){return i.pipe(e,t.reduceRight(s,a))},p=function(e){var s=t.traverse(e);return function(e,t){return i.pipe(e,s(t))}},g=function(e,s,a){return i.pipe(e,t.bimap(s,a))},j=function(e,s){return i.pipe(e,t.mapLeft(s))},x=function(e,s){return i.pipe(e,t.alt(s))},b=function(e,s){return i.pipe(e,t.extend(s))},f=function(e,s){return a.tailRec(s(e),(function(e){return t.isLeft(e)?t.right(t.left(e.left)):t.isLeft(e.right)?t.left(s(e.right.left)):t.right(t.right(e.right.right))}))};function m(e){return{concat:function(s,a){return t.isLeft(s)?s:t.isLeft(a)?a:t.right(e.concat(s.right,a.right))}}}function O(e){var s=t.left(e.empty);return{URI:t.URI,_E:void 0,map:r,compact:function(e){return t.isLeft(e)?e:"None"===e.right._tag?s:t.right(e.right.value)},separate:function(e){return t.isLeft(e)?{left:e,right:e}:t.isLeft(e.right)?{left:t.right(e.right.left),right:s}:{left:s,right:t.right(e.right.right)}},filter:function(e,a){return t.isLeft(e)||a(e.right)?e:s},filterMap:function(e,a){if(t.isLeft(e))return e;var i=a(e.right);return"None"===i._tag?s:t.right(i.value)},partition:function(e,a){return t.isLeft(e)?{left:e,right:e}:a(e.right)?{left:s,right:t.right(e.right)}:{left:t.right(e.right),right:s}},partitionMap:function(e,a){if(t.isLeft(e))return{left:e,right:e};var i=a(e.right);return t.isLeft(i)?{left:t.right(i.left),right:s}:{left:s,right:t.right(i.right)}}}}function h(e){return{URI:t.URI,_E:void 0,map:r,ap:function(s,a){return t.isLeft(s)?t.isLeft(a)?t.left(e.concat(s.left,a.left)):s:t.isLeft(a)?a:t.right(s.right(a.right))},of:t.of}}function v(e){return{URI:t.URI,_E:void 0,map:r,alt:function(s,a){if(t.isRight(s))return s;var i=a();return t.isLeft(i)?t.left(e.concat(s.left,i.left)):i}}}function E(e,s){return{concat:function(a,i){return t.isLeft(a)?t.isLeft(i)?t.left(e.concat(a.left,i.left)):a:t.isLeft(i)?i:t.right(s.concat(a.right,i.right))}}}t.map=function(e){return function(s){return t.isLeft(s)?s:t.right(e(s.right))}},t.bimap=function(e,s){return function(a){return t.isLeft(a)?t.left(e(a.left)):t.right(s(a.right))}},t.mapLeft=function(e){return function(s){return t.isLeft(s)?t.left(e(s.left)):s}},t.apW=function(e){return function(s){return t.isLeft(s)?s:t.isLeft(e)?e:t.right(s.right(e.right))}},t.ap=t.apW,t.apFirst=function(e){return i.flow(t.map((function(e){return function(){return e}})),t.ap(e))},t.apSecond=function(e){return i.flow(t.map((function(){return function(e){return e}})),t.ap(e))},t.of=t.right,t.chainW=function(e){return function(s){return t.isLeft(s)?s:e(s.right)}},t.chain=t.chainW,t.chainFirstW=function(e){return function(s){return i.pipe(s,t.chainW((function(s){return i.pipe(e(s),t.map((function(){return s})))})))}},t.chainFirst=t.chainFirstW,t.flatten=t.chain(i.identity),t.alt=function(e){return function(s){return t.isLeft(s)?e():s}},t.extend=function(e){return function(s){return t.isLeft(s)?s:t.right(e(s))}},t.duplicate=t.extend(i.identity),t.reduce=function(e,s){return function(a){return t.isLeft(a)?e:s(e,a.right)}},t.foldMap=function(e){return function(s){return function(a){return t.isLeft(a)?e.empty:s(a.right)}}},t.reduceRight=function(e,s){return function(a){return t.isLeft(a)?e:s(a.right,e)}},t.traverse=function(e){return function(s){return function(a){return t.isLeft(a)?e.of(t.left(a.left)):e.map(s(a.right),t.right)}}},t.sequence=function(e){return function(s){return t.isLeft(s)?e.of(t.left(s.left)):e.map(s.right,t.right)}},t.throwError=t.left,t.URI="Either",t.getShow=function(e,s){return{show:function(a){return t.isLeft(a)?"left("+e.show(a.left)+")":"right("+s.show(a.right)+")"}}},t.getEq=function(e,s){return{equals:function(a,i){return a===i||(t.isLeft(a)?t.isLeft(i)&&e.equals(a.left,i.left):t.isRight(i)&&s.equals(a.right,i.right))}}},t.getSemigroup=function(e){return{concat:function(s,a){return t.isLeft(a)?s:t.isLeft(s)?a:t.right(e.concat(s.right,a.right))}}},t.getApplySemigroup=m,t.getApplyMonoid=function(e){return{concat:m(e).concat,empty:t.right(e.empty)}},t.getFilterable=O,t.getWitherable=function(e){var s=O(e);return{URI:t.URI,_E:void 0,map:r,compact:s.compact,separate:s.separate,filter:s.filter,filterMap:s.filterMap,partition:s.partition,partitionMap:s.partitionMap,traverse:p,sequence:t.sequence,reduce:u,foldMap:c,reduceRight:d,wither:function(e){var t=p(e);return function(a,i){return e.map(t(a,i),s.compact)}},wilt:function(e){var t=p(e);return function(a,i){return e.map(t(a,i),s.separate)}}}},t.getApplicativeValidation=h,t.getAltValidation=v,t.getValidation=function(e){var s=h(e),a=v(e);return{URI:t.URI,_E:void 0,map:r,of:t.of,chain:l,bimap:g,mapLeft:j,reduce:u,foldMap:c,reduceRight:d,extend:b,traverse:p,sequence:t.sequence,chainRec:f,throwError:t.throwError,ap:s.ap,alt:a.alt}},t.getValidationSemigroup=E,t.Functor={URI:t.URI,map:r},t.Applicative={URI:t.URI,map:r,ap:o,of:t.of},t.Monad={URI:t.URI,map:r,ap:o,of:t.of,chain:l},t.Foldable={URI:t.URI,reduce:u,foldMap:c,reduceRight:d},t.Traversable={URI:t.URI,map:r,reduce:u,foldMap:c,reduceRight:d,traverse:p,sequence:t.sequence},t.Bifunctor={URI:t.URI,bimap:g,mapLeft:j},t.Alt={URI:t.URI,map:r,alt:x},t.Extend={URI:t.URI,map:r,extend:b},t.ChainRec={URI:t.URI,map:r,ap:o,chain:l,chainRec:f},t.MonadThrow={URI:t.URI,map:r,ap:o,of:t.of,chain:l,throwError:t.throwError},t.getValidationMonoid=function(e,s){return{concat:E(e,s).concat,empty:t.right(s.empty)}},t.either={URI:t.URI,map:r,of:t.of,ap:o,chain:l,reduce:u,foldMap:c,reduceRight:d,traverse:p,sequence:t.sequence,bimap:g,mapLeft:j,alt:x,extend:b,chainRec:f,throwError:t.throwError},t.toError=function(e){return e instanceof Error?e:new Error(String(e))},t.elem=function(e){return function(s,a){return!t.isLeft(a)&&e.equals(s,a.right)}},t.exists=function(e){return function(s){return!t.isLeft(s)&&e(s.right)}},t.bindTo=function(e){return t.map(i.bindTo_(e))},t.bindW=function(e,s){return t.chainW((function(a){return i.pipe(s(a),t.map((function(t){return i.bind_(a,e,t)})))}))},t.bind=t.bindW,t.apSW=function(e,s){return i.flow(t.map((function(t){return function(s){return i.bind_(t,e,s)}})),t.apW(s))},t.apS=t.apSW},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tailRec=void 0,t.tailRec=function(e,t){for(var s=t(e);"Left"===s._tag;)s=t(s.left);return s.right}},function(e,t,s){switch(window.__kbnThemeTag__){case"v8dark":return s(52);case"v8light":return s(54)}},function(e,t,s){var a=s(34),i=s(53);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,s){(t=s(35)(!1)).push([e.i,".upgStepProgress__step{align-items:center;display:flex;line-height:16px;margin-bottom:8px;margin-top:16px}.upgStepProgress__status{height:16px;margin-right:12px;width:16px}.upgStepProgress__status--circle{border-radius:12px;line-height:14px;text-align:center}.upgStepProgress__status--circle-failed{background-color:#4a201e;color:#f98982}.upgStepProgress__status--circle-complete{background-color:#264341;color:#97e5e0}.upgStepProgress__status--circle-cancelled,.upgStepProgress__status--circle-paused{background-color:#493f22;color:#f5dc8d}.upgStepProgress__title--currentStep{font-weight:700}.upgStepProgress__content{display:block;margin-left:28px}",""]),e.exports=t},function(e,t,s){var a=s(34),i=s(55);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,s){(t=s(35)(!1)).push([e.i,".upgStepProgress__step{align-items:center;display:flex;line-height:16px;margin-bottom:8px;margin-top:16px}.upgStepProgress__status{height:16px;margin-right:12px;width:16px}.upgStepProgress__status--circle{border-radius:12px;line-height:14px;text-align:center}.upgStepProgress__status--circle-failed{background-color:#f8e9e9;color:#bd271e}.upgStepProgress__status--circle-complete{background-color:#e6f9f7;color:#007e77}.upgStepProgress__status--circle-cancelled,.upgStepProgress__status--circle-paused{background-color:#fff9e8;color:#8a6a0a}.upgStepProgress__title--currentStep{font-weight:700}.upgStepProgress__content{display:block;margin-left:28px}",""]),e.exports=t},function(e,t,s){switch(window.__kbnThemeTag__){case"v8dark":return s(57);case"v8light":return s(59)}},function(e,t,s){var a=s(34),i=s(58);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,s){(t=s(35)(!1)).push([e.i,".upgToggleLoading>.upgLoadingItem{margin:6px}",""]),e.exports=t},function(e,t,s){var a=s(34),i=s(60);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,s){(t=s(35)(!1)).push([e.i,".upgToggleLoading>.upgLoadingItem{margin:6px}",""]),e.exports=t},function(e,t,s){switch(window.__kbnThemeTag__){case"v8dark":return s(62);case"v8light":return s(64)}},function(e,t,s){var a=s(34),i=s(63);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,s){(t=s(35)(!1)).push([e.i,".upgDeprecationIssuesPanel .euiCard__content,.upgDeprecationIssuesPanel__stat{display:flex;flex-direction:column;justify-content:space-between}.upgDeprecationIssuesPanel__stat{flex-grow:1;height:60px}",""]),e.exports=t},function(e,t,s){var a=s(34),i=s(65);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,s){(t=s(35)(!1)).push([e.i,".upgDeprecationIssuesPanel .euiCard__content,.upgDeprecationIssuesPanel__stat{display:flex;flex-direction:column;justify-content:space-between}.upgDeprecationIssuesPanel__stat{flex-grow:1;height:60px}",""]),e.exports=t},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s(22);t.default=function(e,t){var s=a.useRef((function(){}));a.useEffect((function(){s.current=e})),a.useEffect((function(){if(null!==t){var e=setInterval((function(){return s.current()}),t||0);return function(){return clearInterval(e)}}}),[t])}},function(e,t,s){"use strict";s.r(t),s.d(t,"mountManagementSection",(function(){return js}));var a=s(22),i=s.n(a),n=s(30),r=s(27),o=s(25),l=s(24),u=s(0),c=s(5),d=s(23);const p=Object(a.createContext)(void 0),g=({children:e,value:t})=>Object(d.jsx)(p.Provider,{value:t},e),j=()=>{const e=Object(a.useContext)(p);if(!e)throw new Error("useAppContext must be called from inside AppContext");return e};var x=s(40),b=s.n(x),f=s(3),m=s(26),O=s(6);const h=e=>f.i18n.translate("xpack.upgradeAssistant.noDeprecationsPrompt.description",{defaultMessage:"Your {deprecationType} configuration is up to date",values:{deprecationType:e}}),v=e=>Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.noDeprecationsPrompt.nextStepsDescription",defaultMessage:"Check the {overviewButton} for other Stack deprecations.",values:{overviewButton:Object(d.jsx)(l.EuiLink,{onClick:e},f.i18n.translate("xpack.upgradeAssistant.noDeprecationsPrompt.overviewLinkText",{defaultMessage:"Overview page"}))}}),E=({deprecationType:e,navigateToOverviewPage:t})=>Object(d.jsx)(l.EuiEmptyPrompt,{iconType:"check","data-test-subj":"noDeprecationsPrompt",title:Object(d.jsx)("h2",null,h(e)),body:Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)("p",{"data-test-subj":"upgradeAssistantIssueSummary"},v(t)))}),k={critical:f.i18n.translate("xpack.upgradeAssistant.levelInfoTip.criticalLabel",{defaultMessage:"Critical issues must be resolved before you upgrade"}),warning:f.i18n.translate("xpack.upgradeAssistant.levelInfoTip.warningLabel",{defaultMessage:"Warning issues can be ignored at your discretion"})},y=({level:e})=>Object(d.jsx)(l.EuiIconTip,{content:k[e],position:"top",type:"iInCircle"}),C=({totalCriticalDeprecations:e,totalWarningDeprecations:t})=>{return Object(d.jsx)(l.EuiFlexGroup,null,Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiHealth,{color:"danger","data-test-subj":"criticalDeprecationsCount"},(s=e,f.i18n.translate("xpack.upgradeAssistant.deprecationCount.criticalStatusLabel",{defaultMessage:"Critical: {count}",values:{count:s}})))),Object(d.jsx)(l.EuiFlexItem,null,Object(d.jsx)(y,{level:"critical"})))),Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiHealth,{color:"subdued","data-test-subj":"warningDeprecationsCount"},(e=>f.i18n.translate("xpack.upgradeAssistant.deprecationCount.warningStatusLabel",{defaultMessage:"Warning: {count}",values:{count:e}}))(t))),Object(d.jsx)(l.EuiFlexItem,null,Object(d.jsx)(y,{level:"warning"})))));var s},S={criticalBadgeLabel:f.i18n.translate("xpack.upgradeAssistant.deprecationBadge.criticalBadgeLabel",{defaultMessage:"Critical"}),resolvedBadgeLabel:f.i18n.translate("xpack.upgradeAssistant.deprecationBadge.resolvedBadgeLabel",{defaultMessage:"Resolved"}),warningBadgeLabel:f.i18n.translate("xpack.upgradeAssistant.deprecationBadge.warningBadgeLabel",{defaultMessage:"Warning"})},T=({isCritical:e,isResolved:t})=>t?Object(d.jsx)(l.EuiBadge,{color:"success","data-test-subj":"resolvedDeprecationBadge"},S.resolvedBadgeLabel):e?Object(d.jsx)(l.EuiBadge,{color:"danger","data-test-subj":"criticalDeprecationBadge"},S.criticalBadgeLabel):Object(d.jsx)(l.EuiBadge,{color:"default","data-test-subj":"warningDeprecationBadge"},S.warningBadgeLabel),M=({deprecationSource:e,message:t})=>Object(d.jsx)(l.EuiPageContent_Deprecated,{verticalPosition:"center",horizontalPosition:"center",color:"danger","data-test-subj":"deprecationsPageLoadingError"},Object(d.jsx)(l.EuiEmptyPrompt,{iconType:"alert",title:Object(d.jsx)("h2",null,f.i18n.translate("xpack.upgradeAssistant.deprecationsPageLoadingError.title",{defaultMessage:"Could not retrieve {deprecationSource} deprecation issues",values:{deprecationSource:e}})),body:t})),L=({documentationUrl:e})=>Object(d.jsx)(l.EuiLink,{target:"_blank","data-test-subj":"documentationLink",href:e},f.i18n.translate("xpack.upgradeAssistant.deprecationFlyout.learnMoreLinkLabel",{defaultMessage:"Learn more"})),I={cluster_settings:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.clusterDeprecationTypeLabel",{defaultMessage:"Cluster"}),index_settings:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.indexDeprecationTypeLabel",{defaultMessage:"Index"}),node_settings:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.nodeDeprecationTypeLabel",{defaultMessage:"Node"}),ml_settings:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.mlDeprecationTypeLabel",{defaultMessage:"Machine Learning"})},F={initialPageSize:50,pageSizeOptions:[50,100,200]},w={manualCellLabel:f.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.table.manualCellLabel",{defaultMessage:"Manual"}),manualCellTooltipLabel:f.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.table.manualCellTooltipLabel",{defaultMessage:"This issue needs to be resolved manually."}),automatedCellLabel:f.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.table.automatedCellLabel",{defaultMessage:"Automated"}),automationInProgressCellLabel:f.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.table.automationInProgressCellLabel",{defaultMessage:"Resolution in progress…"}),automationCompleteCellLabel:f.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.table.automationCompleteCellLabel",{defaultMessage:"Resolved"}),automationFailedCellLabel:f.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.table.automationFailedCellLabel",{defaultMessage:"Resolution failed"}),automatedCellTooltipLabel:f.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.table.automatedCellTooltipLabel",{defaultMessage:"This issue can be resolved automatically."})},D=({deprecationId:e,isAutomated:t,deprecationResolutionState:s})=>{if(t){if((null==s?void 0:s.id)===e){const{resolveDeprecationStatus:e}=s;switch(e){case"in_progress":return Object(d.jsx)(l.EuiFlexGroup,{gutterSize:"s",alignItems:"center","data-test-subj":"resolutionStatusCell"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiLoadingSpinner,{size:"m"})),Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiText,{size:"s"},w.automationInProgressCellLabel)));case"fail":return Object(d.jsx)(l.EuiFlexGroup,{gutterSize:"s",alignItems:"center","data-test-subj":"resolutionStatusCell"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiIcon,{type:"alert",color:"danger"})),Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiText,{size:"s"},w.automationFailedCellLabel)));default:return Object(d.jsx)(l.EuiFlexGroup,{gutterSize:"s",alignItems:"center","data-test-subj":"resolutionStatusCell"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiIcon,{type:"check",color:"success"})),Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiText,{size:"s"},w.automationCompleteCellLabel)))}}return Object(d.jsx)(l.EuiToolTip,{position:"top",content:w.automatedCellTooltipLabel},Object(d.jsx)(l.EuiFlexGroup,{gutterSize:"s",alignItems:"center","data-test-subj":"resolutionStatusCell"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiIcon,{type:"indexSettings"})),Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiText,{size:"s"},w.automatedCellLabel))))}return Object(d.jsx)(l.EuiToolTip,{position:"top",content:w.manualCellTooltipLabel,"data-test-subj":"resolutionStatusCell"},Object(d.jsx)(l.EuiText,{size:"s",color:"subdued"},w.manualCellLabel))},A={refreshButtonLabel:f.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.table.refreshButtonLabel",{defaultMessage:"Refresh"}),statusColumnTitle:f.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.table.statusColumnTitle",{defaultMessage:"Status"}),issueColumnTitle:f.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.table.issueColumnTitle",{defaultMessage:"Issue"}),typeColumnTitle:f.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.table.typeColumnTitle",{defaultMessage:"Type"}),resolutionColumnTitle:f.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.table.resolutionColumnTitle",{defaultMessage:"Resolution"}),configDeprecationTypeCellLabel:f.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.table.configDeprecationTypeCellLabel",{defaultMessage:"Config"}),featureDeprecationTypeCellLabel:f.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.table.featureDeprecationTypeCellLabel",{defaultMessage:"Feature"}),unknownDeprecationTypeCellLabel:f.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.table.unknownDeprecationTypeCellLabel",{defaultMessage:"Uncategorized"}),typeFilterLabel:f.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.table.typeFilterLabel",{defaultMessage:"Type"}),criticalFilterLabel:f.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.table.criticalFilterLabel",{defaultMessage:"Critical"}),searchPlaceholderLabel:f.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.table.searchPlaceholderLabel",{defaultMessage:"Filter"})},R=({deprecations:e,reload:t,toggleFlyout:s,deprecationResolutionState:a})=>{const i=[{field:"level",name:A.statusColumnTitle,width:"5%",truncateText:!0,sortable:!0,render:e=>Object(d.jsx)(T,{isCritical:"critical"===e})},{field:"title",width:"40%",name:A.issueColumnTitle,truncateText:!0,sortable:!0,render:(e,t)=>Object(d.jsx)(l.EuiLink,{onClick:()=>s(t),"data-test-subj":"deprecationDetailsLink"},e)},{field:"filterType",name:A.typeColumnTitle,width:"20%",truncateText:!0,sortable:!0,render:e=>{switch(e){case"config":return A.configDeprecationTypeCellLabel;case"feature":return A.featureDeprecationTypeCellLabel;default:return A.unknownDeprecationTypeCellLabel}}},{field:"correctiveActions",name:A.resolutionColumnTitle,width:"30%",truncateText:!0,sortable:!0,render:(e,t)=>Object(d.jsx)(D,{deprecationId:t.id,isAutomated:Boolean(null==e?void 0:e.api),deprecationResolutionState:a})}],n={filters:[{type:"field_value_toggle",name:A.criticalFilterLabel,field:"level",value:"critical"},{type:"field_value_selection",field:"filterType",name:A.typeFilterLabel,multiSelect:!1,options:[{value:"config",name:A.configDeprecationTypeCellLabel},{value:"feature",name:A.featureDeprecationTypeCellLabel},{value:"uncategorized",name:A.unknownDeprecationTypeCellLabel}]}],box:{incremental:!0,placeholder:A.searchPlaceholderLabel},toolsRight:[Object(d.jsx)(l.EuiButton,{iconType:"refresh",onClick:t,"data-test-subj":"refreshButton",key:"refreshButton"},A.refreshButtonLabel)]};return Object(d.jsx)(l.EuiInMemoryTable,{items:e||[],itemId:"name",columns:i,search:n,sorting:{sort:{field:"level",direction:"asc"}},pagination:F,rowProps:()=>({"data-test-subj":"row"}),cellProps:(e,t)=>({"data-test-subj":`${((null==t?void 0:t.name)||"table").toLowerCase()}Cell`}),"data-test-subj":"kibanaDeprecationsTable",tableLayout:"auto"})};s(43);const B={closeButtonLabel:f.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.flyout.closeButtonLabel",{defaultMessage:"Close"}),quickResolveButtonLabel:f.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.flyout.quickResolveButtonLabel",{defaultMessage:"Quick resolve"}),retryQuickResolveButtonLabel:f.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.flyout.retryQuickResolveButtonLabel",{defaultMessage:"Try again"}),resolvedButtonLabel:f.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.flyout.resolvedButtonLabel",{defaultMessage:"Resolved"}),quickResolveInProgressButtonLabel:f.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.flyout.quickResolveInProgressButtonLabel",{defaultMessage:"Resolution in progress…"}),quickResolveCalloutTitle:Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.kibanaDeprecations.flyout.quickResolveCalloutTitle",defaultMessage:"Click {quickResolve} to fix this issue automatically.",values:{quickResolve:Object(d.jsx)("strong",null,f.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.flyout.quickResolveText",{defaultMessage:"Quick resolve"}))}}),quickResolveErrorTitle:f.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.flyout.quickResolveErrorTitle",{defaultMessage:"Error resolving issue"}),manualFixTitle:f.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.flyout.manualFixTitle",{defaultMessage:"How to fix"})},P=({deprecation:e,closeFlyout:t,resolveDeprecation:s,deprecationResolutionState:n})=>{const{documentationUrl:r,message:o,correctiveActions:u,title:c}=e,p=(null==n?void 0:n.id)===e.id&&"ok"===(null==n?void 0:n.resolveDeprecationStatus),g=Object(a.useCallback)((()=>{O.s.trackUiMetric(m.METRIC_TYPE.CLICK,O.i),s(e)}),[e,s]);return Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(l.EuiFlyoutHeader,{hasBorder:!0},Object(d.jsx)(T,{isCritical:"critical"===e.level,isResolved:p}),Object(d.jsx)(l.EuiSpacer,{size:"s"}),Object(d.jsx)(l.EuiTitle,{size:"s","data-test-subj":"flyoutTitle"},Object(d.jsx)("h2",{id:"kibanaDeprecationDetailsFlyoutTitle",className:"eui-textBreakWord"},c))),Object(d.jsx)(l.EuiFlyoutBody,null,"fail"===(null==n?void 0:n.resolveDeprecationStatus)&&Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(l.EuiCallOut,{title:B.quickResolveErrorTitle,color:"danger",iconType:"alert","data-test-subj":"quickResolveError"},n.resolveDeprecationError),Object(d.jsx)(l.EuiSpacer,null)),Object(d.jsx)(l.EuiText,null,Object(d.jsx)("p",{className:"eui-textBreakWord"},o),r&&Object(d.jsx)("p",null,Object(d.jsx)(L,{documentationUrl:r}))),Object(d.jsx)(l.EuiSpacer,null),!p&&Object(d.jsx)("div",{"data-test-subj":"resolveSection"},u.api&&Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(l.EuiCallOut,{title:B.quickResolveCalloutTitle,color:"primary",iconType:"iInCircle","data-test-subj":"quickResolveCallout"}),Object(d.jsx)(l.EuiSpacer,null)),u.manualSteps.length>0&&Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(l.EuiTitle,{size:"s","data-test-subj":"manualStepsTitle"},Object(d.jsx)("h3",null,B.manualFixTitle)),Object(d.jsx)(l.EuiSpacer,{size:"s"}),Object(d.jsx)(l.EuiText,null,1===u.manualSteps.length?Object(d.jsx)("p",{"data-test-subj":"manualStep",className:"eui-textBreakWord"},u.manualSteps[0]):Object(d.jsx)("ol",{"data-test-subj":"manualStepsList"},u.manualSteps.map(((e,t)=>Object(d.jsx)("li",{"data-test-subj":"manualStepsListItem",key:`step-${t}`,className:"upgResolveStep eui-textBreakWord"},e)))))))),Object(d.jsx)(l.EuiFlyoutFooter,null,Object(d.jsx)(l.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiButtonEmpty,{onClick:t,flush:"left"},B.closeButtonLabel)),u.api&&!p&&Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiButton,{fill:!0,"data-test-subj":"resolveButton",onClick:g,isLoading:Boolean("in_progress"===(null==n?void 0:n.resolveDeprecationStatus))},(e=>"in_progress"===(null==e?void 0:e.resolveDeprecationStatus)?B.quickResolveInProgressButtonLabel:"ok"===(null==e?void 0:e.resolveDeprecationStatus)?B.resolvedButtonLabel:null!=e&&e.resolveDeprecationError?B.retryQuickResolveButtonLabel:B.quickResolveButtonLabel)(n))))))},{useGlobalFlyout:_}=c.c,N={pageTitle:f.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.pageTitle",{defaultMessage:"Kibana deprecation issues"}),pageDescription:f.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.pageDescription",{defaultMessage:"Resolve all critical issues before upgrading."}),docLinkText:f.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.docLinkText",{defaultMessage:"Documentation"}),deprecationLabel:f.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.deprecationLabel",{defaultMessage:"Kibana"}),isLoading:f.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.loadingText",{defaultMessage:"Loading deprecation issues…"}),kibanaDeprecationErrorTitle:f.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.kibanaDeprecationErrorTitle",{defaultMessage:"List of deprecation issues might be incomplete"}),getKibanaDeprecationErrorDescription:e=>f.i18n.translate("xpack.upgradeAssistant.kibanaDeprecations.kibanaDeprecationErrorDescription",{defaultMessage:"Failed to get deprecation issues for {pluginCount, plural, one {this plugin} other {these plugins}}: {pluginIds}. Check the Kibana server logs for more information.",values:{pluginCount:e.length,pluginIds:e.join(", ")}})},z=Object(r.withRouter)((({history:e})=>{const[t,s]=Object(a.useState)(void 0),[n,r]=Object(a.useState)([]),[o,u]=Object(a.useState)(!1),[p,g]=Object(a.useState)(void 0),[x,f]=Object(a.useState)(void 0),[h,v]=Object(a.useState)(void 0),{services:{core:{deprecations:k},breadcrumbs:y}}=j(),{addContent:S,removeContent:T}=_(),L=Object(a.useCallback)((async()=>{u(!0);try{const e=await k.getAllDeprecations(),t=[],a=[];e.forEach((e=>{var s;"fetch_error"!==e.level?t.push({...e,id:b.a.v4(),filterType:null!==(s=e.deprecationType)&&void 0!==s?s:"uncategorized"}):!1===a.includes(e.domainId)&&a.push(e.domainId)})),s(t),r(a)}catch(e){g(e)}u(!1)}),[k]),I=Object(a.useMemo)((()=>(e=>{const t=[],s=[];return e.forEach((e=>{"critical"!==e.level?s.push(e):t.push(e)})),{criticalDeprecations:t.length,warningDeprecations:s.length}})(t||[])),[t]),F=e=>{f(e)},w=Object(a.useCallback)((()=>{F(),T("deprecationDetails")}),[T]),D=Object(a.useCallback)((async e=>{v({id:e.id,resolveDeprecationStatus:"in_progress"});const t=await k.resolveDeprecation(e);v({id:e.id,resolveDeprecationStatus:t.status,resolveDeprecationError:"fail"===t.status?t.reason:void 0}),w()}),[w,k]);return Object(a.useEffect)((()=>{x&&S({id:"deprecationDetails",Component:P,props:{deprecation:x,closeFlyout:w,resolveDeprecation:D,deprecationResolutionState:h&&x.id===h.id?h:void 0},flyoutProps:{onClose:w,"data-test-subj":"kibanaDeprecationDetails","aria-labelledby":"kibanaDeprecationDetailsFlyoutTitle"}})}),[S,w,h,x,D]),Object(a.useEffect)((()=>{O.s.trackUiMetric(m.METRIC_TYPE.LOADED,O.h)}),[]),Object(a.useEffect)((()=>{y.setBreadcrumbs("kibanaDeprecations")}),[y]),Object(a.useEffect)((()=>{L()}),[k,L]),p?Object(d.jsx)(M,{deprecationSource:"Kibana"}):o?Object(d.jsx)(l.EuiPageContent_Deprecated,{verticalPosition:"center",horizontalPosition:"center",color:"subdued"},Object(d.jsx)(c.g,null,N.isLoading)):0===(null==t?void 0:t.length)?Object(d.jsx)(l.EuiPageContent_Deprecated,{verticalPosition:"center",horizontalPosition:"center",color:"subdued"},Object(d.jsx)(E,{deprecationType:N.deprecationLabel,navigateToOverviewPage:()=>e.push("/overview")})):Object(d.jsx)("div",{"data-test-subj":"kibanaDeprecations"},Object(d.jsx)(l.EuiPageHeader,{bottomBorder:!0,pageTitle:N.pageTitle,description:N.pageDescription},Object(d.jsx)(C,{totalCriticalDeprecations:I.criticalDeprecations,totalWarningDeprecations:I.warningDeprecations})),Object(d.jsx)(l.EuiSpacer,{size:"l"}),n.length>0&&Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(l.EuiCallOut,{title:N.kibanaDeprecationErrorTitle,color:"warning",iconType:"alert","data-test-subj":"kibanaDeprecationErrors"},Object(d.jsx)("p",null,N.getKibanaDeprecationErrorDescription(n))),Object(d.jsx)(l.EuiSpacer,null)),Object(d.jsx)(R,{deprecations:t,reload:L,toggleFlyout:F,deprecationResolutionState:h}))})),U={permissionsError:f.i18n.translate("xpack.upgradeAssistant.esDeprecationErrors.permissionsErrorMessage",{defaultMessage:"You are not authorized to view Elasticsearch deprecation issues."}),partiallyUpgradedWarning:f.i18n.translate("xpack.upgradeAssistant.esDeprecationErrors.partiallyUpgradedWarningMessage",{defaultMessage:"Upgrade Kibana to the same version as your Elasticsearch cluster. One or more nodes in the cluster is running a different version than Kibana."}),upgradedMessage:f.i18n.translate("xpack.upgradeAssistant.esDeprecationErrors.upgradedWarningMessage",{defaultMessage:"All Elasticsearch nodes have been upgraded."}),loadingError:f.i18n.translate("xpack.upgradeAssistant.esDeprecationErrors.loadingErrorMessage",{defaultMessage:"Could not retrieve Elasticsearch deprecation issues."})},W=e=>{var t,s;return 403===e.statusCode?{code:"unauthorized_error",message:U.permissionsError}:426===(null==e?void 0:e.statusCode)&&!1===(null===(t=e.attributes)||void 0===t?void 0:t.allNodesUpgraded)?{code:"partially_upgraded_error",message:U.partiallyUpgradedWarning}:426===(null==e?void 0:e.statusCode)&&!0===(null===(s=e.attributes)||void 0===s?void 0:s.allNodesUpgraded)?{code:"upgraded_error",message:U.upgradedMessage}:{code:"request_error",message:U.loadingError}};var q=s(29);const G={manualCellLabel:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.defaultDeprecation.manualCellLabel",{defaultMessage:"Manual"}),manualCellTooltipLabel:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.reindex.manualCellTooltipLabel",{defaultMessage:"This issue needs to be resolved manually."})},$=({resolutionTableCell:e,fieldName:t,deprecation:s,openFlyout:a})=>{var n,r,o;return"isCritical"===t?Object(d.jsx)(T,{isCritical:s.isCritical}):"message"===t?Object(d.jsx)(l.EuiLink,{"data-test-subj":`deprecation-${null!==(r=null===(o=s.correctiveAction)||void 0===o?void 0:o.type)&&void 0!==r?r:"default"}`,onClick:a},s.message):"type"===t?Object(d.jsx)(i.a.Fragment,null,I[s.type]):"correctiveAction"===t?e?Object(d.jsx)(i.a.Fragment,null,e):Object(d.jsx)(l.EuiToolTip,{position:"top",content:G.manualCellTooltipLabel},Object(d.jsx)(l.EuiText,{size:"s",color:"subdued"},G.manualCellLabel)):Object(d.jsx)(i.a.Fragment,null,null!==(n=s[t])&&void 0!==n?n:"")},K=Object(a.createContext)(void 0),Y=()=>{const e=Object(a.useContext)(K);if(void 0===e)throw new Error("useMlSnapshotContext must be used within a <MlSnapshotsStatusProvider />");return e},V=({api:e,snapshotId:t,jobId:s,mlUpgradeModeEnabled:i,children:n})=>{const{updateSnapshotStatus:r,snapshotState:o,upgradeSnapshot:l,deleteSnapshot:u}=(({jobId:e,snapshotId:t,api:s})=>{const[i,n]=Object(a.useState)(void 0),[r,o]=Object(a.useState)({status:"idle",jobId:e,snapshotId:t}),l=Object(a.useRef)(null),u=Object(a.useRef)(!1),c=Object(a.useCallback)((()=>{l.current&&(clearTimeout(l.current),l.current=null)}),[]),d=Object(a.useCallback)((async()=>{c();const{data:a,error:i}=await s.getMlSnapshotUpgradeStatus({jobId:e,snapshotId:t});if(i)return o({snapshotId:t,jobId:e,action:"upgrade",status:"error"}),void n(i);o({...a,action:"upgrade"}),"in_progress"===(null==a?void 0:a.status)&&(l.current=setTimeout(d,1e3))}),[s,c,e,t]),p=Object(a.useCallback)((async()=>{o({snapshotId:t,jobId:e,action:"upgrade",status:"in_progress"});const{data:a,error:i}=await s.upgradeMlSnapshot({jobId:e,snapshotId:t});if(i)return n(i),void o({snapshotId:t,jobId:e,action:"upgrade",status:"error"});o({...a,action:"upgrade"}),d()}),[s,e,t,d]),g=Object(a.useCallback)((async()=>{o({snapshotId:t,jobId:e,action:"delete",status:"in_progress"});const{error:a}=await s.deleteMlSnapshot({snapshotId:t,jobId:e});if(a)return n(a),void o({snapshotId:t,jobId:e,action:"delete",status:"error"});o({snapshotId:t,jobId:e,action:"delete",status:"complete"})}),[s,e,t]);return Object(a.useEffect)((()=>(u.current=!0,()=>{u.current=!1,c()})),[c]),{snapshotState:{...r,error:i},upgradeSnapshot:p,updateSnapshotStatus:d,deleteSnapshot:g}})({jobId:s,snapshotId:t,api:e});return Object(a.useEffect)((()=>{r()}),[r]),Object(d.jsx)(K.Provider,{value:{snapshotState:o,upgradeSnapshot:l,deleteSnapshot:u,mlUpgradeModeEnabled:i}},n)},H={upgradeInProgressText:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.mlSnapshots.upgradeInProgressText",{defaultMessage:"Upgrade in progress…"}),deleteInProgressText:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.mlSnapshots.deletingButtonLabel",{defaultMessage:"Deletion in progress…"}),upgradeCompleteText:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.mlSnapshots.upgradeCompleteText",{defaultMessage:"Upgrade complete"}),deleteCompleteText:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.mlSnapshots.deleteCompleteText",{defaultMessage:"Deletion complete"}),upgradeFailedText:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.mlSnapshots.upgradeFailedText",{defaultMessage:"Upgrade failed"}),deleteFailedText:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.mlSnapshots.deleteFailedText",{defaultMessage:"Deletion failed"}),resolutionText:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.mlSnapshots.resolutionText",{defaultMessage:"Upgrade or delete snapshots"}),resolutionTooltipLabel:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.mlSnapshots.resolutionTooltipLabel",{defaultMessage:"Resolve this issue by upgrading or deleting a job model snapshot. This issue can be resolved automatically."})},J=()=>{const{snapshotState:e}=Y();return"in_progress"===e.status?Object(d.jsx)(l.EuiFlexGroup,{gutterSize:"s",alignItems:"center","data-test-subj":"mlActionResolutionCell"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiLoadingSpinner,{size:"m"})),Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiText,{size:"s"},"delete"===e.action?H.deleteInProgressText:H.upgradeInProgressText))):"complete"===e.status?Object(d.jsx)(l.EuiFlexGroup,{gutterSize:"s",alignItems:"center","data-test-subj":"mlActionResolutionCell"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiIcon,{type:"check",color:"success"})),Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiText,{size:"s"},"delete"===e.action?H.deleteCompleteText:H.upgradeCompleteText))):"error"===e.status?Object(d.jsx)(l.EuiFlexGroup,{gutterSize:"s",alignItems:"center","data-test-subj":"mlActionResolutionCell"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiIcon,{type:"alert",color:"danger"})),Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiText,{size:"s"},"delete"===e.action?H.deleteFailedText:H.upgradeFailedText))):Object(d.jsx)(l.EuiToolTip,{position:"top",content:H.resolutionTooltipLabel},Object(d.jsx)(l.EuiFlexGroup,{gutterSize:"s",alignItems:"center","data-test-subj":"mlActionResolutionCell"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiIcon,{type:"indexSettings"})),Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiText,{size:"s"},H.resolutionText))))},Q={upgradeButtonLabel:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.mlSnapshots.flyout.upgradeButtonLabel",{defaultMessage:"Upgrade"}),upgradingButtonLabel:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.mlSnapshots.flyout.upgradingButtonLabel",{defaultMessage:"Upgrading…"}),retryUpgradeButtonLabel:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.mlSnapshots.flyout.retryUpgradeButtonLabel",{defaultMessage:"Retry upgrade"}),closeButtonLabel:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.mlSnapshots.flyout.closeButtonLabel",{defaultMessage:"Close"}),deleteButtonLabel:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.mlSnapshots.flyout.deleteButtonLabel",{defaultMessage:"Delete"}),deletingButtonLabel:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.mlSnapshots.flyout.deletingButtonLabel",{defaultMessage:"Deleting…"}),retryDeleteButtonLabel:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.mlSnapshots.flyout.retryDeleteButtonLabel",{defaultMessage:"Retry delete"}),flyoutTitle:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.mlSnapshots.flyout.title",{defaultMessage:"Upgrade or delete model snapshot"}),deleteSnapshotErrorTitle:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.mlSnapshots.flyout.deleteSnapshotErrorTitle",{defaultMessage:"Error deleting snapshot"}),upgradeSnapshotErrorTitle:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.mlSnapshots.flyout.upgradeSnapshotErrorTitle",{defaultMessage:"Error upgrading snapshot"}),upgradeModeEnabledErrorTitle:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.mlSnapshots.upgradeModeEnabledErrorTitle",{defaultMessage:"Machine Learning upgrade mode is enabled"}),upgradeModeEnabledErrorDescription:e=>Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.esDeprecations.mlSnapshots.upgradeModeEnabledErrorDescription",defaultMessage:"No actions can be taken on Machine Learning snapshots while upgrade mode is enabled. {docsLink}.",values:{docsLink:Object(d.jsx)(l.EuiLink,{href:e,target:"_blank","data-test-subj":"setUpgradeModeDocsLink"},Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.esDeprecations.mlSnapshots.upgradeModeEnabledDocsLink",defaultMessage:"Learn more"}))}})},Z=({deprecation:e,closeFlyout:t,snapshotState:s,upgradeSnapshot:a,deleteSnapshot:n,mlUpgradeModeEnabled:r})=>{const{services:{core:{docLinks:o}}}=j(),u="complete"===s.status;return Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(l.EuiFlyoutHeader,{hasBorder:!0},Object(d.jsx)(T,{isCritical:e.isCritical,isResolved:u}),Object(d.jsx)(l.EuiSpacer,{size:"s"}),Object(d.jsx)(l.EuiTitle,{size:"s","data-test-subj":"flyoutTitle"},Object(d.jsx)("h2",{id:"mlSnapshotDetailsFlyoutTitle"},Q.flyoutTitle))),Object(d.jsx)(l.EuiFlyoutBody,null,s.error&&!u&&Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(l.EuiCallOut,{title:"delete"===s.action?Q.deleteSnapshotErrorTitle:Q.upgradeSnapshotErrorTitle,color:"danger",iconType:"alert","data-test-subj":"resolveSnapshotError"},s.error.message),Object(d.jsx)(l.EuiSpacer,null)),r&&Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(l.EuiCallOut,{title:Q.upgradeModeEnabledErrorTitle,color:"warning",iconType:"alert","data-test-subj":"mlUpgradeModeEnabledError"},Object(d.jsx)("p",null,Q.upgradeModeEnabledErrorDescription(o.links.ml.setUpgradeMode))),Object(d.jsx)(l.EuiSpacer,null)),Object(d.jsx)(l.EuiText,null,Object(d.jsx)("p",null,e.details),Object(d.jsx)("p",null,Object(d.jsx)(L,{documentationUrl:e.url})))),Object(d.jsx)(l.EuiFlyoutFooter,null,Object(d.jsx)(l.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiButtonEmpty,{onClick:t,flush:"left"},Q.closeButtonLabel)),!u&&!r&&Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiFlexGroup,null,Object(d.jsx)(l.EuiFlexItem,null,Object(d.jsx)(l.EuiButtonEmpty,{"data-test-subj":"deleteSnapshotButton",color:"danger",onClick:()=>{O.s.trackUiMetric(m.METRIC_TYPE.CLICK,O.j),n(),t()},isLoading:"delete"===s.action&&"in_progress"===s.status,isDisabled:"in_progress"===s.status},(e=>"delete"===e.action?e.error?Q.retryDeleteButtonLabel:"in_progress"===e.status?Q.deletingButtonLabel:Q.deleteButtonLabel:Q.deleteButtonLabel)(s))),Object(d.jsx)(l.EuiFlexItem,null,Object(d.jsx)(l.EuiButton,{fill:!0,onClick:()=>{O.s.trackUiMetric(m.METRIC_TYPE.CLICK,O.k),a(),t()},isLoading:"upgrade"===s.action&&"in_progress"===s.status,isDisabled:"in_progress"===s.status,"data-test-subj":"upgradeSnapshotButton"},(e=>"upgrade"===e.action?e.error?Q.retryUpgradeButtonLabel:"in_progress"===e.status?Q.upgradingButtonLabel:Q.upgradeButtonLabel:Q.upgradeButtonLabel)(s))))))))},{useGlobalFlyout:X}=c.c,ee=({rowFieldNames:e,deprecation:t})=>{const[s,n]=Object(a.useState)(!1),r=Y(),{addContent:o,removeContent:u}=X(),c=Object(a.useCallback)((()=>{n(!1),u("mlFlyout")}),[u]);return Object(a.useEffect)((()=>{s&&o({id:"mlFlyout",Component:Z,props:{deprecation:t,closeFlyout:c,...r},flyoutProps:{onClose:c,className:"eui-textBreakWord","data-test-subj":"mlSnapshotDetails","aria-labelledby":"mlSnapshotDetailsFlyoutTitle"}})}),[r,o,s,t,c]),Object(d.jsx)(i.a.Fragment,null,e.map((e=>Object(d.jsx)(l.EuiTableRowCell,{key:e,truncateText:!1,"data-test-subj":`mlTableCell-${e}`},Object(d.jsx)($,{fieldName:e,openFlyout:()=>n(!0),deprecation:t,resolutionTableCell:Object(d.jsx)(J,null)})))))},te=e=>{const{services:{api:t}}=j();return Object(d.jsx)(V,{snapshotId:e.deprecation.correctiveAction.snapshotId,jobId:e.deprecation.correctiveAction.jobId,mlUpgradeModeEnabled:e.mlUpgradeModeEnabled,api:t},Object(d.jsx)(ee,e))},se={deleteInProgressText:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.indexSettings.deletingButtonLabel",{defaultMessage:"Settings removal in progress…"}),deleteCompleteText:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.indexSettings.deleteCompleteText",{defaultMessage:"Deprecated settings removed"}),deleteFailedText:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.indexSettings.deleteFailedText",{defaultMessage:"Settings removal failed"}),resolutionText:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.indexSettings.resolutionText",{defaultMessage:"Remove settings"}),resolutionTooltipLabel:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.indexSettings.resolutionTooltipLabel",{defaultMessage:"Resolve this issue by removing settings from this index. This issue can be resolved automatically."})},ae=({status:e})=>{const{statusType:t}=e;return"in_progress"===t?Object(d.jsx)(l.EuiFlexGroup,{gutterSize:"s",alignItems:"center","data-test-subj":"indexSettingsResolutionStatusCell"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiLoadingSpinner,{size:"m"})),Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiText,{size:"s"},se.deleteInProgressText))):"complete"===t?Object(d.jsx)(l.EuiFlexGroup,{gutterSize:"s",alignItems:"center","data-test-subj":"indexSettingsResolutionStatusCell"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiIcon,{type:"check",color:"success"})),Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiText,{size:"s"},se.deleteCompleteText))):"error"===t?Object(d.jsx)(l.EuiFlexGroup,{gutterSize:"s",alignItems:"center","data-test-subj":"indexSettingsResolutionStatusCell"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiIcon,{type:"alert",color:"danger"})),Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiText,{size:"s"},se.deleteFailedText))):Object(d.jsx)(l.EuiToolTip,{position:"top",content:se.resolutionTooltipLabel},Object(d.jsx)(l.EuiFlexGroup,{gutterSize:"s",alignItems:"center","data-test-subj":"indexSettingsResolutionStatusCell"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiIcon,{type:"indexSettings"})),Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiText,{size:"s"},se.resolutionText))))},ie={getFlyoutDescription:e=>f.i18n.translate("xpack.upgradeAssistant.esDeprecations.removeSettingsFlyout.secondaryDescription",{defaultMessage:"Index: {indexName}",values:{indexName:e}}),removeButtonLabel:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.removeSettingsFlyout.removeButtonLabel",{defaultMessage:"Remove deprecated settings"}),retryRemoveButtonLabel:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.removeSettingsFlyout.retryRemoveButtonLabel",{defaultMessage:"Retry removing deprecated settings"}),resolvedButtonLabel:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.removeSettingsFlyout.resolvedButtonLabel",{defaultMessage:"Resolved"}),closeButtonLabel:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.removeSettingsFlyout.closeButtonLabel",{defaultMessage:"Close"}),getConfirmationText:e=>f.i18n.translate("xpack.upgradeAssistant.esDeprecations.removeSettingsFlyout.description",{defaultMessage:"Remove the following deprecated index {indexSettingsCount, plural, one {setting} other {settings}}?",values:{indexSettingsCount:e}}),errorTitle:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.removeSettingsFlyout.deleteErrorTitle",{defaultMessage:"Error deleting index settings"})},ne=({deprecation:e,closeFlyout:t,removeIndexSettings:s,status:n})=>{const{index:r,message:o,details:u,url:c,correctiveAction:p}=e,{statusType:g,details:j}=n,x=["idle","error"].includes(g),b=Object(a.useCallback)((()=>{O.s.trackUiMetric(m.METRIC_TYPE.CLICK,O.g),s(r,p.deprecatedSettings)}),[p,r,s]);return Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(l.EuiFlyoutHeader,{hasBorder:!0},Object(d.jsx)(T,{isCritical:e.isCritical,isResolved:"complete"===g}),Object(d.jsx)(l.EuiSpacer,{size:"s"}),Object(d.jsx)(l.EuiTitle,{size:"s","data-test-subj":"flyoutTitle"},Object(d.jsx)("h2",{id:"indexSettingsDetailsFlyoutTitle"},o)),Object(d.jsx)(l.EuiText,null,Object(d.jsx)("p",null,Object(d.jsx)(l.EuiTextColor,{color:"subdued"},ie.getFlyoutDescription(r))))),Object(d.jsx)(l.EuiFlyoutBody,null,"error"===g&&Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(l.EuiCallOut,{title:ie.errorTitle,color:"danger",iconType:"alert","data-test-subj":"deleteSettingsError"},j.message),Object(d.jsx)(l.EuiSpacer,null)),Object(d.jsx)(l.EuiText,null,Object(d.jsx)("p",null,u),Object(d.jsx)("p",null,Object(d.jsx)(L,{documentationUrl:c}))),x&&Object(d.jsx)("div",{"data-test-subj":"removeSettingsPrompt"},Object(d.jsx)(l.EuiSpacer,null),Object(d.jsx)(l.EuiTitle,{size:"xs"},Object(d.jsx)("h3",null,ie.getConfirmationText(p.deprecatedSettings.length))),Object(d.jsx)(l.EuiSpacer,null),Object(d.jsx)(l.EuiText,null,Object(d.jsx)("ul",null,p.deprecatedSettings.map(((e,t)=>Object(d.jsx)("li",{key:`${e}-${t}`},Object(d.jsx)(l.EuiCode,null,e)))))))),Object(d.jsx)(l.EuiFlyoutFooter,null,Object(d.jsx)(l.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiButtonEmpty,{onClick:t,flush:"left"},ie.closeButtonLabel)),x&&Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiButton,{fill:!0,"data-test-subj":"deleteSettingsButton",color:"danger",onClick:b},"error"===g?ie.retryRemoveButtonLabel:ie.removeButtonLabel)))))},{useGlobalFlyout:re}=c.c,oe=({rowFieldNames:e,deprecation:t})=>{const[s,n]=Object(a.useState)(!1),[r,o]=Object(a.useState)({statusType:"idle"}),{services:{api:u}}=j(),{addContent:c,removeContent:p}=re(),g=Object(a.useCallback)((()=>{n(!1),p("indexSettingsFlyout")}),[p]),x=Object(a.useCallback)((async(e,t)=>{o({statusType:"in_progress"});const{error:s}=await u.updateIndexSettings(e,t);o({statusType:s?"error":"complete",details:null!=s?s:void 0}),g()}),[u,g]);return Object(a.useEffect)((()=>{s&&c({id:"indexSettingsFlyout",Component:ne,props:{closeFlyout:g,deprecation:t,removeIndexSettings:x,status:r},flyoutProps:{onClose:g,className:"eui-textBreakWord","data-test-subj":"indexSettingsDetails","aria-labelledby":"indexSettingsDetailsFlyoutTitle"}})}),[c,t,x,s,g,r]),Object(d.jsx)(i.a.Fragment,null,e.map((e=>Object(d.jsx)(l.EuiTableRowCell,{key:e,truncateText:!1,"data-test-subj":`indexSettingsTableCell-${e}`},Object(d.jsx)($,{fieldName:e,openFlyout:()=>n(!0),deprecation:t,resolutionTableCell:Object(d.jsx)(ae,{status:r})})))))},le={getFlyoutDescription:e=>f.i18n.translate("xpack.upgradeAssistant.esDeprecations.deprecationDetailsFlyout.secondaryDescription",{defaultMessage:"Index: {indexName}",values:{indexName:e}}),closeButtonLabel:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.deprecationDetailsFlyout.closeButtonLabel",{defaultMessage:"Close"})},ue=({deprecation:e,closeFlyout:t})=>{const{message:s,url:a,details:n,index:r}=e;return Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(l.EuiFlyoutHeader,{hasBorder:!0},Object(d.jsx)(T,{isCritical:e.isCritical,isResolved:!1}),Object(d.jsx)(l.EuiSpacer,{size:"s"}),Object(d.jsx)(l.EuiTitle,{size:"s","data-test-subj":"flyoutTitle"},Object(d.jsx)("h2",{id:"defaultDeprecationDetailsFlyoutTitle"},s)),r&&Object(d.jsx)(l.EuiText,{"data-test-subj":"flyoutDescription"},Object(d.jsx)("p",null,Object(d.jsx)(l.EuiTextColor,{color:"subdued"},le.getFlyoutDescription(r))))),Object(d.jsx)(l.EuiFlyoutBody,null,Object(d.jsx)(l.EuiText,null,Object(d.jsx)("p",{className:"eui-textBreakWord"},n),Object(d.jsx)("p",null,Object(d.jsx)(L,{documentationUrl:a})))),Object(d.jsx)(l.EuiFlyoutFooter,null,Object(d.jsx)(l.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiButtonEmpty,{onClick:t,flush:"left"},le.closeButtonLabel)))))},{useGlobalFlyout:ce}=c.c,de=({rowFieldNames:e,deprecation:t})=>{const[s,n]=Object(a.useState)(!1),{addContent:r,removeContent:o}=ce(),u=Object(a.useCallback)((()=>{n(!1),o("deprecationDetails")}),[o]);return Object(a.useEffect)((()=>{s&&r({id:"deprecationDetails",Component:ue,props:{deprecation:t,closeFlyout:u},flyoutProps:{onClose:u,className:"eui-textBreakWord","data-test-subj":"defaultDeprecationDetails","aria-labelledby":"defaultDeprecationDetailsFlyoutTitle"}})}),[r,u,t,s]),Object(d.jsx)(i.a.Fragment,null,e.map((e=>Object(d.jsx)(l.EuiTableRowCell,{key:e,truncateText:!1,"data-test-subj":`defaultTableCell-${e}`},Object(d.jsx)($,{fieldName:e,deprecation:t,openFlyout:()=>n(!0)})))))};let pe,ge;!function(e){e[e.created=0]="created",e[e.readonly=20]="readonly",e[e.newIndexCreated=30]="newIndexCreated",e[e.reindexStarted=40]="reindexStarted",e[e.reindexCompleted=50]="reindexCompleted",e[e.aliasCreated=60]="aliasCreated",e[e.originalIndexDeleted=70]="originalIndexDeleted",e[e.existingAliasesUpdated=80]="existingAliasesUpdated"}(pe||(pe={})),function(e){e[e.inProgress=0]="inProgress",e[e.completed=1]="completed",e[e.failed=2]="failed",e[e.paused=3]="paused",e[e.cancelled=4]="cancelled",e[e.fetchFailed=5]="fetchFailed"}(ge||(ge={})),s(48),s(49);const je=e=>e>u.k?`${u.k}+`:e.toString(),xe=(e,t,s=!1)=>{let a=0;switch(t){case pe.created:a=0;break;case pe.readonly:a=5;break;case pe.newIndexCreated:a=10;break;case pe.reindexStarted:a=null!==e?10+Math.round(e*(s?75:80)):10;break;case pe.reindexCompleted:a=s?85:90;break;case pe.aliasCreated:a=s?90:95;break;case pe.originalIndexDeleted:a=s?95:100;break;case pe.existingAliasesUpdated:a=100}return`${a}%`};let be,fe;!function(e){e[e.Loading=0]="Loading",e[e.Success=1]="Success",e[e.Error=2]="Error"}(be||(be={})),function(e){e[e.Requested=0]="Requested",e[e.Loading=1]="Loading",e[e.Success=2]="Success",e[e.Error=3]="Error"}(fe||(fe={}));const me=(e,{reindexOp:t,warnings:s,hasRequiredPrivileges:a,meta:i})=>{const n={...null!=i?i:e.meta},r=e.meta.aliases.length>0?e.meta.aliases:i.aliases,o={...e,meta:{...n,aliases:r},loadingState:be.Success};if(s&&(o.reindexWarnings=s),void 0!==a&&(o.hasRequiredPrivileges=a),t){let s=!0;t.lastCompletedStep===pe.aliasCreated&&t.status!==ge.completed&&(s=!1),s&&(o.lastCompletedStep=t.lastCompletedStep),o.status=t.status,o.reindexTaskPercComplete=t.reindexTaskPercComplete,o.errorMessage=t.errorMessage,e.cancelLoadingState!==fe.Requested&&e.cancelLoadingState!==fe.Loading||t.status!==ge.cancelled?e.cancelLoadingState===fe.Requested&&t.status===ge.inProgress?o.cancelLoadingState=fe.Loading:o.status===ge.completed&&(o.status=ge.inProgress):o.cancelLoadingState=fe.Success}return o},Oe=Object(a.createContext)(void 0),he=()=>{const e=Object(a.useContext)(Oe);if(void 0===e)throw new Error("useReindexContext must be used within a <ReindexStatusProvider />");return e},ve=({api:e,indexName:t,children:s})=>{const{reindexState:i,startReindex:n,cancelReindex:r}=(({indexName:e,api:t})=>{const[s,i]=Object(a.useState)({loadingState:be.Loading,errorMessage:null,reindexTaskPercComplete:null,meta:{indexName:e,reindexName:"",aliases:[]}}),n=Object(a.useRef)(null),r=Object(a.useRef)(!1),o=Object(a.useCallback)((()=>{n.current&&(clearTimeout(n.current),n.current=null)}),[]),l=Object(a.useCallback)((()=>{const e=s.meta.aliases.length>0,t=()=>{r.current&&i((e=>({...e,status:ge.completed,lastCompletedStep:pe.existingAliasesUpdated})))};setTimeout((()=>{r.current&&(i((t=>({...t,status:e?ge.inProgress:ge.completed,lastCompletedStep:pe.originalIndexDeleted}))),e&&setTimeout(t,1e3))}),1e3)}),[s.meta.aliases.length]),u=Object(a.useCallback)((async()=>{o();const{data:s,error:a}=await t.getReindexStatus(e);a?i((e=>({...e,loadingState:be.Error,errorMessage:a.message.toString(),status:ge.fetchFailed}))):null!==s&&(i((e=>me(e,s))),s.reindexOp&&s.reindexOp.status===ge.inProgress?n.current=setTimeout(u,1e3):s.reindexOp&&s.reindexOp.status===ge.completed&&l())}),[o,t,e,l]),c=Object(a.useCallback)((async()=>{i((e=>({...e,lastCompletedStep:e.status===ge.paused?e.lastCompletedStep:void 0,status:ge.inProgress,reindexTaskPercComplete:null,errorMessage:null,cancelLoadingState:void 0})));const{data:s,error:a}=await t.startReindexTask(e);a?i((e=>({...e,loadingState:be.Error,errorMessage:a.message.toString(),status:ge.failed}))):(i((e=>me(e,{reindexOp:s,meta:e.meta}))),u())}),[t,e,u]),d=Object(a.useCallback)((async()=>{i((e=>({...e,cancelLoadingState:fe.Requested})));const{error:s}=await t.cancelReindexTask(e);s&&i((e=>({...e,cancelLoadingState:fe.Error})))}),[t,e]);return Object(a.useEffect)((()=>{u()}),[u]),Object(a.useEffect)((()=>(r.current=!0,()=>{r.current=!1,o()})),[o]),{reindexState:s,startReindex:c,cancelReindex:d,updateStatus:u}})({indexName:t,api:e});return Object(d.jsx)(Oe.Provider,{value:{reindexState:i,startReindex:n,cancelReindex:r}},s)},Ee={reindexLoadingStatusText:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.reindex.reindexLoadingStatusText",{defaultMessage:"Loading status…"}),reindexInProgressText:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.reindex.reindexInProgressText",{defaultMessage:"Reindexing in progress…"}),reindexCompleteText:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.reindex.reindexCompleteText",{defaultMessage:"Reindex complete"}),reindexFailedText:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.reindex.reindexFailedText",{defaultMessage:"Reindex failed"}),reindexFetchFailedText:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.reindex.reindexFetchFailedText",{defaultMessage:"Reindex status not available"}),reindexCanceledText:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.reindex.reindexCanceledText",{defaultMessage:"Reindex cancelled"}),reindexPausedText:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.reindex.reindexPausedText",{defaultMessage:"Reindex paused"}),resolutionText:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.reindex.resolutionLabel",{defaultMessage:"Reindex"}),resolutionTooltipLabel:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.reindex.resolutionTooltipLabel",{defaultMessage:"Resolve this issue by reindexing this index. This issue can be resolved automatically."})},ke=()=>{const{reindexState:e}=he(),t=e.meta.aliases.length>0;if(e.loadingState===be.Loading)return Object(d.jsx)(l.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiLoadingSpinner,{size:"m"})),Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiText,{size:"s"},Ee.reindexLoadingStatusText)));switch(e.status){case ge.inProgress:return Object(d.jsx)(l.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiLoadingSpinner,{size:"m"})),Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiText,{size:"s"},Ee.reindexInProgressText," ",xe(e.reindexTaskPercComplete,e.lastCompletedStep,t))));case ge.completed:return Object(d.jsx)(l.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiIcon,{type:"check",color:"success"})),Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiText,{size:"s"},Ee.reindexCompleteText)));case ge.failed:return Object(d.jsx)(l.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiIcon,{type:"alert",color:"danger"})),Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiText,{size:"s"},Ee.reindexFailedText)));case ge.fetchFailed:return Object(d.jsx)(l.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiIcon,{type:"alert",color:"danger"})),Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiText,{size:"s"},Ee.reindexFetchFailedText)));case ge.paused:return Object(d.jsx)(l.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiIcon,{type:"alert",color:"danger"})),Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiText,{size:"s"},Ee.reindexPausedText)))}return Object(d.jsx)(l.EuiToolTip,{position:"top",content:Ee.resolutionTooltipLabel},Object(d.jsx)(l.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiIcon,{type:"indexSettings"})),Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiText,{size:"s"},Ee.resolutionText))))};var ye=s(39),Ce=s.n(ye),Se=s(31),Te=s.n(Se);s(51);const Me=({status:e,idx:t})=>{if("incomplete"===e)return Object(d.jsx)("span",{className:"upgStepProgress__status"},t+1,".");if("inProgress"===e)return Object(d.jsx)(l.EuiLoadingSpinner,{size:"m",className:"upgStepProgress__status"});if("complete"===e)return Object(d.jsx)("span",{className:"upgStepProgress__status upgStepProgress__status--circle upgStepProgress__status--circle-complete"},Object(d.jsx)(l.EuiIcon,{type:"check",size:"s"}));if("paused"===e)return Object(d.jsx)("span",{className:"upgStepProgress__status upgStepProgress__status--circle upgStepProgress__status--circle-paused"},Object(d.jsx)(l.EuiIcon,{type:"pause",size:"s"}));if("cancelled"===e)return Object(d.jsx)("span",{className:"upgStepProgress__status upgStepProgress__status--circle upgStepProgress__status--circle-cancelled"},Object(d.jsx)(l.EuiIcon,{type:"cross",size:"s"}));if("failed"===e)return Object(d.jsx)("span",{className:"upgStepProgress__status upgStepProgress__status--circle upgStepProgress__status--circle-failed"},Object(d.jsx)(l.EuiIcon,{type:"cross",size:"s"}));throw new Error(`Unsupported status: ${e}`)},Le=({title:e,status:t,children:s,idx:i})=>{const n=Te()("upgStepProgress__title",{"upgStepProgress__title--currentStep":"inProgress"===t});return Object(d.jsx)(a.Fragment,null,Object(d.jsx)("div",{className:"upgStepProgress__step"},Object(d.jsx)(Me,{status:t,idx:i}),Object(d.jsx)("div",{className:n},e)),s&&Object(d.jsx)("div",{className:"upgStepProgress__content"},s))},Ie=({steps:e})=>Object(d.jsx)("div",{className:"upgStepProgress__container"},e.map(((e,t)=>Object(d.jsx)(Le,Ce()({key:t},e,{idx:t}))))),Fe=({errorMessage:e})=>Object(d.jsx)(l.EuiCallOut,{color:"danger",title:"There was an error"},Object(d.jsx)(l.EuiText,null,Object(d.jsx)("p",null,e))),we=()=>Object(d.jsx)(l.EuiCallOut,{color:"warning",title:"This step was paused due to a Kibana restart. Click 'Resume' below to continue."}),De=({reindexState:{lastCompletedStep:e,status:t,cancelLoadingState:s},cancelReindex:a})=>{if(t===ge.cancelled)return Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexingChecklist.cancelledTitle",defaultMessage:"Reindexing cancelled."}));const n=t===ge.inProgress&&(e===pe.newIndexCreated||e===pe.reindexStarted),r=t===ge.inProgress&&e===pe.reindexStarted;let u;switch(s){case fe.Requested:case fe.Loading:u=Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexingChecklist.cancelButton.cancellingLabel",defaultMessage:"Cancelling…"});break;case fe.Success:u=Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexingChecklist.cancelButton.cancelledLabel",defaultMessage:"Cancelled"});break;case fe.Error:u=Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexingChecklist.cancelButton.errorLabel",defaultMessage:"Could not cancel"});break;default:u=Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexingChecklist.cancelButton.cancelLabel",defaultMessage:"Cancel"})}return Object(d.jsx)(l.EuiFlexGroup,{component:"span"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},n?Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexingChecklist.inProgress.reindexingDocumentsStepTitle",defaultMessage:"Reindexing documents."}):Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexingChecklist.reindexingDocumentsStepTitle",defaultMessage:"Reindex documents."})),r&&Object(d.jsx)(l.EuiFlexItem,null,Object(d.jsx)(l.EuiLink,{"data-test-subj":"cancelReindexingDocumentsButton",onClick:a,disabled:void 0!==s},u)))},Ae=Object.values(pe).sort(),Re=(e,t,s)=>e===pe.readonly?s?Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexingChecklist.inProgress.readonlyStepTitle",defaultMessage:"Setting {indexName} index to read-only.",values:{indexName:Object(d.jsx)(l.EuiCode,null,t.indexName)}}):Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexingChecklist.readonlyStepTitle",defaultMessage:"Set {indexName} index to read-only.",values:{indexName:Object(d.jsx)(l.EuiCode,null,t.indexName)}}):e===pe.newIndexCreated?s?Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexingChecklist.inProgress.createIndexStepTitle",defaultMessage:"Creating {reindexName} index.",values:{reindexName:Object(d.jsx)(l.EuiCode,null,t.reindexName)}}):Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexingChecklist.createIndexStepTitle",defaultMessage:"Create {reindexName} index.",values:{reindexName:Object(d.jsx)(l.EuiCode,null,t.reindexName)}}):e===pe.aliasCreated?s?Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexingChecklist.inProgress.aliasCreatedStepTitle",defaultMessage:"Creating {indexName} alias for {reindexName} index.",values:{indexName:Object(d.jsx)(l.EuiCode,null,t.indexName),reindexName:Object(d.jsx)(l.EuiCode,null,t.reindexName)}}):Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexingChecklist.aliasCreatedStepTitle",defaultMessage:"Create {indexName} alias for {reindexName} index.",values:{indexName:Object(d.jsx)(l.EuiCode,null,t.indexName),reindexName:Object(d.jsx)(l.EuiCode,null,t.reindexName)}}):e===pe.originalIndexDeleted?s?Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexingChecklist.inProgress.originalIndexDeletedStepTitle",defaultMessage:"Deleting original {indexName} index.",values:{indexName:Object(d.jsx)(l.EuiCode,null,t.indexName)}}):Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexingChecklist.originalIndexDeletedStepTitle",defaultMessage:"Delete original {indexName} index.",values:{indexName:Object(d.jsx)(l.EuiCode,null,t.indexName)}}):e===pe.existingAliasesUpdated?s?Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexingChecklist.inProgress.aliasesUpdatedStepTitle",defaultMessage:"Updating {existingAliases} aliases to point to {reindexName} index.",values:{existingAliases:Object(d.jsx)(l.EuiCode,null,`[${t.aliases.join(",")}]`),reindexName:Object(d.jsx)(l.EuiCode,null,t.reindexName)}}):Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexingChecklist.aliasesUpdatedStepTitle",defaultMessage:"Update {existingAliases} aliases to point to {reindexName} index.",values:{existingAliases:Object(d.jsx)(l.EuiCode,null,`[${t.aliases.join(",")}]`),reindexName:Object(d.jsx)(l.EuiCode,null,t.reindexName)}}):void 0,Be=e=>{const{errorMessage:t,lastCompletedStep:s=-1,status:a,reindexTaskPercComplete:n,meta:r}=e.reindexState,u=e=>{const i=Ae[Ae.indexOf(e)-1];return a===ge.failed&&s===i?{title:Re(e,r),status:"failed",children:Object(d.jsx)(Fe,{errorMessage:t})}:a===ge.paused&&s===i?{title:Re(e,r),status:"paused",children:Object(d.jsx)(we,null)}:a===ge.cancelled&&s===i?{title:Re(e,r),status:"cancelled"}:void 0===a||s<i?{title:Re(e,r),status:"incomplete"}:s===i?{title:Re(e,r,!0),status:"inProgress"}:{title:Re(e,r),status:"complete"}},c={title:Object(d.jsx)(De,e)};a!==ge.failed||s!==pe.newIndexCreated&&s!==pe.reindexStarted?a!==ge.paused||s!==pe.newIndexCreated&&s!==pe.reindexStarted?a!==ge.cancelled||s!==pe.newIndexCreated&&s!==pe.reindexStarted?void 0===a||s<pe.newIndexCreated?c.status="incomplete":s===pe.newIndexCreated||s===pe.reindexStarted?c.status="inProgress":c.status="complete":c.status="cancelled":(c.status="paused",c.children=Object(d.jsx)(we,null)):(c.status="failed",c.children=Object(d.jsx)(Fe,{errorMessage:t}));const p=[u(pe.readonly),u(pe.newIndexCreated),c,u(pe.aliasCreated),u(pe.originalIndexDeleted)],g=r.aliases.length>0;return g&&p.push(u(pe.existingAliasesUpdated)),Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(l.EuiTitle,{size:"xs","data-test-subj":"reindexChecklistTitle"},Object(d.jsx)("h3",null,a===ge.inProgress?Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexingInProgressTitle",defaultMessage:"Reindexing in progress… {percents}",values:{percents:xe(n,s,g)}}):Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexingChecklistTitle",defaultMessage:"Reindexing process"}))),Object(d.jsx)(Ie,{steps:p}))},Pe=({closeFlyout:e,reindexState:t,startReindex:s,cancelReindex:n})=>{const{services:{api:r,core:{docLinks:u}}}=j(),{loadingState:c,status:p,hasRequiredPrivileges:g}=t,x=c===be.Loading||p===ge.inProgress,b=p===ge.completed,m=p===ge.fetchFailed,O=p===ge.failed,{data:h}=r.useLoadNodeDiskSpace();return Object(d.jsx)(a.Fragment,null,Object(d.jsx)(l.EuiFlyoutBody,null,!1===g&&Object(d.jsx)(a.Fragment,null,Object(d.jsx)(l.EuiSpacer,null),Object(d.jsx)(l.EuiCallOut,{title:Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.insufficientPrivilegeCallout.calloutTitle",defaultMessage:"You do not have sufficient privileges to reindex this index"}),color:"danger",iconType:"alert"})),h&&h.length>0&&Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(l.EuiCallOut,{color:"warning",iconType:"alert","data-test-subj":"lowDiskSpaceCallout",title:Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.lowDiskSpaceCalloutTitle",defaultMessage:"Nodes with low disk space"})},Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.lowDiskSpaceCalloutDescription",defaultMessage:"Disk usage has exceeded the low watermark, which may prevent reindexing. The following nodes are impacted:"}),Object(d.jsx)(l.EuiSpacer,{size:"s"}),Object(d.jsx)("ul",null,h.map((({nodeName:e,available:t,nodeId:s})=>Object(d.jsx)("li",{key:s,"data-test-subj":"impactedNodeListItem"},Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.lowDiskSpaceUsedText",defaultMessage:"{nodeName} ({available} available)",values:{nodeName:e,available:t}}))))))),Object(d.jsx)(l.EuiSpacer,null)),(m||O)&&Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(l.EuiCallOut,{color:"danger",iconType:"alert","data-test-subj":m?"fetchFailedCallout":"reindexingFailedCallout",title:m?Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.fetchFailedCalloutTitle",defaultMessage:"Reindex status not available"}):Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexingFailedCalloutTitle",defaultMessage:"Reindexing error"})},t.errorMessage),Object(d.jsx)(l.EuiSpacer,null)),Object(d.jsx)(l.EuiText,null,Object(d.jsx)("p",null,Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexDescription",defaultMessage:"The index will be read-only during reindexing. You won't be able to add, update, or delete documents until reindexing is complete. If you need to reindex to a new cluster, use the reindex API. {docsLink}",values:{docsLink:Object(d.jsx)(l.EuiLink,{target:"_blank",href:u.links.upgradeAssistant.remoteReindex},f.i18n.translate("xpack.upgradeAssistant.checkupTab.reindexing.flyout.learnMoreLinkLabel",{defaultMessage:"Learn more"}))}})),Object(d.jsx)("p",null,Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.readonlyCallout.backgroundResumeDetail",defaultMessage:"Reindexing is performed in the background. You can return to the Upgrade Assistant to view progress or resume reindexing after a Kibana restart."}))),Object(d.jsx)(l.EuiSpacer,null),Object(d.jsx)(Be,{reindexState:t,cancelReindex:n})),Object(d.jsx)(l.EuiFlyoutFooter,null,Object(d.jsx)(l.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiButtonEmpty,{iconType:"cross",onClick:e,flush:"left"},Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.closeButtonLabel",defaultMessage:"Close"}))),!m&&!b&&g&&Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiButton,{fill:!0,color:p===ge.paused?"warning":"primary",iconType:p===ge.paused?"play":void 0,onClick:s,isLoading:x,disabled:x||!g,"data-test-subj":"startReindexingButton"},(e=>{switch(e){case ge.failed:return Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexButton.tryAgainLabel",defaultMessage:"Try again"});case ge.inProgress:return Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexButton.reindexingLabel",defaultMessage:"Reindexing…"});case ge.paused:return Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexButton.resumeLabel",defaultMessage:"Resume reindexing"});case ge.cancelled:return Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexButton.restartLabel",defaultMessage:"Restart reindexing"});default:return Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.reindexButton.runReindexLabel",defaultMessage:"Start reindexing"})}})(p))))))},_e=({isChecked:e,warningId:t,label:s,onChange:a,description:n,documentationUrl:r})=>Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(l.EuiText,null,Object(d.jsx)(l.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiCheckbox,{id:t,label:Object(d.jsx)("strong",null,s),checked:e,onChange:a})),void 0!==r&&Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiLink,{href:r,target:"_blank",external:!1},Object(d.jsx)(l.EuiIconTip,{content:Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.warningsStep.documentationLinkLabel",defaultMessage:"Documentation"}),position:"right",type:"help"})))),Object(d.jsx)(l.EuiSpacer,{size:"xs"}),n),Object(d.jsx)(l.EuiSpacer,null)),Ne={customTypeName:({isChecked:e,onChange:t,docLinks:s,id:a,meta:i})=>Object(d.jsx)(_e,{isChecked:e,onChange:t,warningId:a,label:Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.warningsStep.customTypeNameWarningTitle",defaultMessage:"Replace mapping type {mappingType} with {defaultType}",values:{mappingType:Object(d.jsx)(l.EuiCode,null,i.typeName),defaultType:Object(d.jsx)(l.EuiCode,null,"_doc")}}),description:Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.warningsStep.customTypeNameWarningDetail",defaultMessage:"Mapping types are no longer supported in Elastic 8.x. Ensure no application code or scripts rely on {mappingType}.",values:{mappingType:Object(d.jsx)(l.EuiCode,null,i.typeName)}}),documentationUrl:s.elasticsearch.typesRemoval}),indexSetting:({isChecked:e,onChange:t,docLinks:s,id:a,meta:n})=>Object(d.jsx)(_e,{isChecked:e,onChange:t,warningId:a,label:Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.warningsStep.deprecatedIndexSettingsWarningTitle",defaultMessage:"Remove deprecated index settings"}),description:Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.warningsStep.deprecatedIndexSettingsWarningDetail",defaultMessage:"The following deprecated index settings were detected:"}),Object(d.jsx)(l.EuiSpacer,{size:"xs"}),Object(d.jsx)("ul",null,n.deprecatedSettings.map(((e,t)=>Object(d.jsx)("li",{key:`${e}-${t}`},Object(d.jsx)(l.EuiCode,null,e)))))),documentationUrl:s.elasticsearch.indexModules}),replaceIndexWithAlias:({isChecked:e,onChange:t,docLinks:s,id:a,meta:i})=>Object(d.jsx)(_e,{isChecked:e,onChange:t,warningId:a,label:Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.warningsStep.replaceIndexWithAliasWarningTitle",defaultMessage:"Replace {indexName} index with {reindexName} index and create {indexName} index alias",values:{indexName:Object(d.jsx)(l.EuiCode,null,null==i?void 0:i.indexName),reindexName:Object(d.jsx)(l.EuiCode,null,null==i?void 0:i.reindexName)}}),description:Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.warningsStep.replaceIndexWithAliasWarningDetail",defaultMessage:"You can search {indexName} as before. To delete the data you'll have to delete {reindexName}",values:{indexName:Object(d.jsx)(l.EuiCode,null,null==i?void 0:i.indexName),reindexName:Object(d.jsx)(l.EuiCode,null,null==i?void 0:i.reindexName)}})})},ze=e=>`reindexWarning-${e}`,Ue=({warnings:e,hideWarningsStep:t,continueReindex:s,meta:n})=>{const{services:{core:{docLinks:r}}}=j(),{links:u}=r,[c,p]=Object(a.useState)(e.reduce(((e,t,s)=>(e[ze(s)]=!1,e)),{})),g=Object.values(c).filter((e=>e)).length<e.length,x=e=>{const t=e.target.id;p((e=>({...e,[t]:!c[t]})))};return Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(l.EuiFlyoutBody,null,e.length>0&&Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(l.EuiCallOut,{title:Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.warningsStep.destructiveCallout.calloutTitle",defaultMessage:"This index requires destructive changes that cannot be reversed"}),color:"warning",iconType:"alert"},Object(d.jsx)("p",null,Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.warningsStep.destructiveCallout.calloutDetail",defaultMessage:"Back up the index before continuing. To proceed with the reindex, accept each change."}))),Object(d.jsx)(l.EuiSpacer,null),Object(d.jsx)(l.EuiTitle,{size:"s"},Object(d.jsx)("h3",null,Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.warningsStep.acceptChangesTitle",defaultMessage:"Accept changes"}))),Object(d.jsx)(l.EuiSpacer,null),e.map(((e,t)=>{const s=Ne[e.warningType];return Object(d.jsx)(s,{key:ze(t),isChecked:c[ze(t)],onChange:x,docLinks:u,id:ze(t),meta:{...n,...e.meta}})})))),Object(d.jsx)(l.EuiFlyoutFooter,null,Object(d.jsx)(l.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiButtonEmpty,{iconType:"arrowLeft",onClick:t,flush:"left"},Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.cancelButtonLabel",defaultMessage:"Back"}))),Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiButton,{fill:!0,color:"primary",onClick:s,disabled:g},Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.checklistStep.continueButtonLabel",defaultMessage:"Continue reindexing"}))))))},We=({reindexState:e,startReindex:t,cancelReindex:s,closeFlyout:n,deprecation:r})=>{var u;const{status:c,reindexWarnings:p}=e,{index:g}=r,[j,x]=Object(a.useState)(!1),b=Object(a.useCallback)((()=>{O.s.trackUiMetric(m.METRIC_TYPE.CLICK,O.p),t()}),[t]),f=Object(a.useCallback)((()=>{O.s.trackUiMetric(m.METRIC_TYPE.CLICK,O.q),s()}),[s]),h=j?Object(d.jsx)(Ue,{warnings:null!==(u=e.reindexWarnings)&&void 0!==u?u:[],meta:e.meta,hideWarningsStep:()=>x(!1),continueReindex:()=>{x(!1),b()}}):Object(d.jsx)(Pe,{closeFlyout:n,startReindex:()=>{p&&p.length>0&&c!==ge.inProgress&&c!==ge.completed?x(!0):b()},reindexState:e,cancelReindex:f});return Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(l.EuiFlyoutHeader,{hasBorder:!0},Object(d.jsx)(T,{isCritical:r.isCritical,isResolved:c===ge.completed}),Object(d.jsx)(l.EuiSpacer,{size:"s"}),Object(d.jsx)(l.EuiTitle,{size:"s","data-test-subj":"flyoutTitle"},Object(d.jsx)("h2",{id:"reindexDetailsFlyoutTitle"},Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.checkupTab.reindexing.flyout.flyoutHeader",defaultMessage:"Reindex {index}",values:{index:g}})))),h)},{useGlobalFlyout:qe}=c.c,Ge=({rowFieldNames:e,deprecation:t})=>{const[s,n]=Object(a.useState)(!1),r=he(),{addContent:o,removeContent:u}=qe(),c=Object(a.useCallback)((async()=>{u("reindexFlyout"),n(!1),O.s.trackUiMetric(m.METRIC_TYPE.CLICK,O.n)}),[u]);return Object(a.useEffect)((()=>{s&&o({id:"reindexFlyout",Component:We,props:{deprecation:t,closeFlyout:c,...r},flyoutProps:{onClose:c,className:"eui-textBreakWord","data-test-subj":"reindexDetails","aria-labelledby":"reindexDetailsFlyoutTitle"}})}),[o,t,s,r,c]),Object(a.useEffect)((()=>{s&&O.s.trackUiMetric(m.METRIC_TYPE.CLICK,O.o)}),[s]),Object(d.jsx)(i.a.Fragment,null,e.map((e=>Object(d.jsx)(l.EuiTableRowCell,{key:e,truncateText:!1,"data-test-subj":`reindexTableCell-${e}`},Object(d.jsx)($,{fieldName:e,openFlyout:()=>n(!0),deprecation:t,resolutionTableCell:Object(d.jsx)(ke,null)})))))},$e=e=>{const{services:{api:t}}=j();return Object(d.jsx)(ve,{indexName:e.deprecation.index,api:t},Object(d.jsx)(Ge,e))},Ke={deleteInProgressText:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.clusterSettings.deletingButtonLabel",{defaultMessage:"Settings removal in progress…"}),deleteCompleteText:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.clusterSettings.deleteCompleteText",{defaultMessage:"Deprecated settings removed"}),deleteFailedText:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.clusterSettings.deleteFailedText",{defaultMessage:"Settings removal failed"}),resolutionText:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.clusterSettings.resolutionText",{defaultMessage:"Remove settings"}),resolutionTooltipLabel:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.clusterSettings.resolutionTooltipLabel",{defaultMessage:"Resolve this issue by removing settings from this cluster. This issue can be resolved automatically."})},Ye=({status:e})=>{const{statusType:t}=e;return"in_progress"===t?Object(d.jsx)(l.EuiFlexGroup,{gutterSize:"s",alignItems:"center","data-test-subj":"clusterSettingsResolutionStatusCell"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiLoadingSpinner,{size:"m"})),Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiText,{size:"s"},Ke.deleteInProgressText))):"complete"===t?Object(d.jsx)(l.EuiFlexGroup,{gutterSize:"s",alignItems:"center","data-test-subj":"clusterSettingsResolutionStatusCell"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiIcon,{type:"check",color:"success"})),Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiText,{size:"s"},Ke.deleteCompleteText))):"error"===t?Object(d.jsx)(l.EuiFlexGroup,{gutterSize:"s",alignItems:"center","data-test-subj":"clusterSettingsResolutionStatusCell"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiIcon,{type:"alert",color:"danger"})),Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiText,{size:"s"},Ke.deleteFailedText))):Object(d.jsx)(l.EuiToolTip,{position:"top",content:Ke.resolutionTooltipLabel},Object(d.jsx)(l.EuiFlexGroup,{gutterSize:"s",alignItems:"center","data-test-subj":"clusterSettingsResolutionStatusCell"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiIcon,{type:"indexSettings"})),Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiText,{size:"s"},Ke.resolutionText))))},Ve={removeButtonLabel:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.removeClusterSettingsFlyout.removeButtonLabel",{defaultMessage:"Remove deprecated settings"}),retryRemoveButtonLabel:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.removeClusterSettingsFlyout.retryRemoveButtonLabel",{defaultMessage:"Retry removing deprecated settings"}),resolvedButtonLabel:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.removeClusterSettingsFlyout.resolvedButtonLabel",{defaultMessage:"Resolved"}),closeButtonLabel:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.removeClusterSettingsFlyout.closeButtonLabel",{defaultMessage:"Close"}),getConfirmationText:e=>f.i18n.translate("xpack.upgradeAssistant.esDeprecations.removeClusterSettingsFlyout.description",{defaultMessage:"Remove the following deprecated cluster {clusterSettingsCount, plural, one {setting} other {settings}}?",values:{clusterSettingsCount:e}}),errorTitle:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.removeClusterSettingsFlyout.deleteErrorTitle",{defaultMessage:"Error deleting cluster settings"})},He=({deprecation:e,closeFlyout:t,removeClusterSettings:s,status:n})=>{const{message:r,details:o,url:u,correctiveAction:c}=e,{statusType:p,details:g}=n,j=["idle","error"].includes(p),x=Object(a.useCallback)((()=>{O.s.trackUiMetric(m.METRIC_TYPE.CLICK,O.c),s(c.deprecatedSettings)}),[c,s]);return Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(l.EuiFlyoutHeader,{hasBorder:!0},Object(d.jsx)(T,{isCritical:e.isCritical,isResolved:"complete"===p}),Object(d.jsx)(l.EuiSpacer,{size:"s"}),Object(d.jsx)(l.EuiTitle,{size:"s","data-test-subj":"flyoutTitle"},Object(d.jsx)("h2",{id:"removeClusterSettingsDetailsFlyoutTitle"},r))),Object(d.jsx)(l.EuiFlyoutBody,null,"error"===p&&Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(l.EuiCallOut,{title:Ve.errorTitle,color:"danger",iconType:"alert","data-test-subj":"deleteClusterSettingsError"},g.message),Object(d.jsx)(l.EuiSpacer,null)),Object(d.jsx)(l.EuiText,null,Object(d.jsx)("p",null,o),Object(d.jsx)("p",null,Object(d.jsx)(L,{documentationUrl:u}))),j&&Object(d.jsx)("div",{"data-test-subj":"removeClusterSettingsPrompt"},Object(d.jsx)(l.EuiSpacer,null),Object(d.jsx)(l.EuiTitle,{size:"xs"},Object(d.jsx)("h3",null,Ve.getConfirmationText(c.deprecatedSettings.length))),Object(d.jsx)(l.EuiSpacer,null),Object(d.jsx)(l.EuiText,null,Object(d.jsx)("ul",null,c.deprecatedSettings.map((e=>Object(d.jsx)("li",{key:e},Object(d.jsx)(l.EuiCode,null,e)))))))),Object(d.jsx)(l.EuiFlyoutFooter,null,Object(d.jsx)(l.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiButtonEmpty,{onClick:t,flush:"left"},Ve.closeButtonLabel)),j&&Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiButton,{fill:!0,"data-test-subj":"deleteClusterSettingsButton",color:"danger",onClick:x},"error"===p?Ve.retryRemoveButtonLabel:Ve.removeButtonLabel)))))},{useGlobalFlyout:Je}=c.c,Qe=({rowFieldNames:e,deprecation:t})=>{const[s,n]=Object(a.useState)(!1),[r,o]=Object(a.useState)({statusType:"idle"}),{services:{api:u}}=j(),{addContent:c,removeContent:p}=Je(),g=Object(a.useCallback)((()=>{n(!1),p("clusterSettingsFlyout")}),[p]),x=Object(a.useCallback)((async e=>{o({statusType:"in_progress"});const{error:t}=await u.updateClusterSettings(e);o({statusType:t?"error":"complete",details:null!=t?t:void 0}),g()}),[u,g]);return Object(a.useEffect)((()=>{s&&c({id:"clusterSettingsFlyout",Component:He,props:{closeFlyout:g,deprecation:t,removeClusterSettings:x,status:r},flyoutProps:{onClose:g,className:"eui-textBreakWord","data-test-subj":"clusterSettingsDetails","aria-labelledby":"removeClusterSettingsDetailsFlyoutTitle"}})}),[c,t,x,s,g,r]),Object(d.jsx)(i.a.Fragment,null,e.map((e=>Object(d.jsx)(l.EuiTableRowCell,{key:e,truncateText:!1,"data-test-subj":`clusterSettingsTableCell-${e}`},Object(d.jsx)($,{fieldName:e,openFlyout:()=>n(!0),deprecation:t,resolutionTableCell:Object(d.jsx)(Ye,{status:r})})))))},Ze={refreshButtonLabel:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.table.refreshButtonLabel",{defaultMessage:"Refresh"}),noDeprecationsMessage:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.table.noDeprecationsMessage",{defaultMessage:"No Elasticsearch deprecation issues found"}),typeFilterLabel:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.table.typeFilterLabel",{defaultMessage:"Type"}),criticalFilterLabel:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.table.criticalFilterLabel",{defaultMessage:"Critical"}),searchPlaceholderLabel:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.table.searchPlaceholderLabel",{defaultMessage:"Filter"})},Xe={isCritical:{label:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.table.statusColumnTitle",{defaultMessage:"Status"}),width:"8px"},message:{label:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.table.issueColumnTitle",{defaultMessage:"Issue"}),width:"36px"},type:{label:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.table.typeColumnTitle",{defaultMessage:"Type"}),width:"10px"},index:{label:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.table.nameColumnTitle",{defaultMessage:"Name"}),width:"24px"},correctiveAction:{label:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.table.resolutionColumnTitle",{defaultMessage:"Resolution"}),width:"24px"}},et=Object.keys(Xe),tt=F.pageSizeOptions,st=(e,t)=>{const{isSortAscending:s,sortField:a}=t,i=Object(q.sortBy)(e,[e=>"isCritical"===a?!0!==e.isCritical:e[a]]);return s?i:i.reverse()},at=({deprecations:e=[],reload:t})=>{const{services:{api:s}}=j(),{data:n}=s.useLoadMlUpgradeMode(),r=!(null==n||!n.mlUpgradeModeEnabled),[o,u]=Object(a.useState)({isSortAscending:!0,sortField:"isCritical"}),[c,p]=Object(a.useState)(F.initialPageSize),[g,x]=Object(a.useState)(0),[b,f]=Object(a.useState)(l.EuiSearchBar.Query.MATCH_ALL),[m,O]=Object(a.useState)(void 0),[h,v]=Object(a.useState)(st(e,o)),E=Object(a.useMemo)((()=>new l.Pager(e.length,c,g)),[g,e,c]),k=Object(a.useMemo)((()=>h.slice(E.firstItemIndex,E.lastItemIndex+1)),[h,E]),y=Object(a.useCallback)((e=>{const t={isSortAscending:o.sortField!==e||!o.isSortAscending,sortField:e};u(t)}),[o]),C=Object(a.useCallback)((({query:e,error:t})=>{t?O(t):(O(void 0),f(e))}),[]);return Object(a.useEffect)((()=>{const{setTotalItems:t,goToPageIndex:s}=E,a=l.EuiSearchBar.Query.execute(b,e),i=st(a,o);t(i.length),v(i),i.length!==h.length&&s(0)}),[e,o,E,b,h.length]),Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(l.EuiFlexGroup,{gutterSize:"m"},Object(d.jsx)(l.EuiFlexItem,{"data-test-subj":"searchBarContainer"},Object(d.jsx)(l.EuiSearchBar,{box:{placeholder:Ze.searchPlaceholderLabel,incremental:!0},filters:[{type:"is",field:"isCritical",name:Ze.criticalFilterLabel},{type:"field_value_selection",field:"type",name:Ze.typeFilterLabel,multiSelect:!1,options:Object.keys(I).map((e=>({value:e,name:I[e]})))}],onChange:C})),Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiButton,{iconType:"refresh",onClick:t,"data-test-subj":"refreshButton",key:"refreshButton"},Ze.refreshButtonLabel))),m&&Object(d.jsx)("div",{"data-test-subj":"invalidSearchQueryMessage"},Object(d.jsx)(l.EuiSpacer,{size:"l"}),Object(d.jsx)(l.EuiCallOut,{iconType:"alert",color:"danger",title:`Invalid search: ${m.message}`})),Object(d.jsx)(l.EuiSpacer,{size:"m"}),Object(d.jsx)(l.EuiTable,{"data-test-subj":"esDeprecationsTable"},Object(d.jsx)(l.EuiTableHeader,null,Object.entries(Xe).map((([e,t])=>Object(d.jsx)(l.EuiTableHeaderCell,{width:t.width,key:t.label,onSort:()=>y(e),isSorted:o.sortField===e,isSortAscending:o.isSortAscending},t.label)))),0===h.length?Object(d.jsx)(l.EuiTableBody,null,Object(d.jsx)(l.EuiTableRow,{"data-test-subj":"noDeprecationsRow"},Object(d.jsx)(l.EuiTableRowCell,{align:"center",colSpan:et.length,mobileOptions:{width:"100%"}},Ze.noDeprecationsMessage))):Object(d.jsx)(l.EuiTableBody,null,k.map(((e,t)=>Object(d.jsx)(l.EuiTableRow,{"data-test-subj":"deprecationTableRow",key:`deprecation-row-${t}`},((e,t)=>{var s;switch(null===(s=e.correctiveAction)||void 0===s?void 0:s.type){case"mlSnapshot":return Object(d.jsx)(te,{deprecation:e,rowFieldNames:et,mlUpgradeModeEnabled:t});case"indexSetting":return Object(d.jsx)(oe,{deprecation:e,rowFieldNames:et});case"clusterSetting":return Object(d.jsx)(Qe,{deprecation:e,rowFieldNames:et});case"reindex":return Object(d.jsx)($e,{deprecation:e,rowFieldNames:et});default:return Object(d.jsx)(de,{deprecation:e,rowFieldNames:et})}})(e,r)))))),Object(d.jsx)(l.EuiSpacer,{size:"m"}),Object(d.jsx)(l.EuiTablePagination,{"data-test-subj":"esDeprecationsPagination",activePage:E.getCurrentPageIndex(),itemsPerPage:E.itemsPerPage,itemsPerPageOptions:tt,pageCount:E.getTotalPages(),onChangeItemsPerPage:p,onChangePage:x}))},it={pageTitle:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.pageTitle",{defaultMessage:"Elasticsearch deprecation issues"}),pageDescription:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.pageDescription",{defaultMessage:"Resolve all critical issues before upgrading. Before making changes, ensure you have a current snapshot of your cluster."}),isLoading:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.loadingText",{defaultMessage:"Loading deprecation issues…"}),remoteClustersDetectedTitle:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.remoteClustersDetectedTitle",{defaultMessage:"Remote cluster compatibility"}),getRemoteClustersDetectedDescription:e=>f.i18n.translate("xpack.upgradeAssistant.esDeprecations.remoteClustersDetectedDescription",{defaultMessage:"You have {remoteClustersCount} {remoteClustersCount, plural, one {remote cluster} other {remote clusters}} configured. If you use cross-cluster search, note that 8.x can only search remote clusters running the previous minor version or later. If you use cross-cluster replication, a cluster that contains follower indices must run the same or newer version as the remote cluster.",values:{remoteClustersCount:e}}),remoteClustersLinkText:f.i18n.translate("xpack.upgradeAssistant.esDeprecations.remoteClustersLinkText",{defaultMessage:"View remote clusters."})},nt=e=>Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.esDeprecations.batchReindexingDocsDescription",defaultMessage:"To start multiple reindexing tasks in a single request, use the Kibana {docsLink}.",values:{docsLink:Object(d.jsx)(l.EuiLink,{href:e.links.upgradeAssistant.batchReindex,target:"_blank",external:!0},f.i18n.translate("xpack.upgradeAssistant.esDeprecations.batchReindexingDocsLink",{defaultMessage:"batch reindexing API"}))}}),rt=()=>{var e;const{plugins:{share:t}}=j(),s=null===(e=t.url.locators.get("REMOTE_CLUSTERS_LOCATOR"))||void 0===e?void 0:e.useUrl({page:"remoteClusters"});return Object(d.jsx)(l.EuiLink,{href:s,"data-test-subj":"remoteClustersLink"},it.remoteClustersLinkText)},ot=Object(r.withRouter)((({history:e})=>{var t;const{services:{api:s,breadcrumbs:n,core:{docLinks:r}}}=j(),{data:o,isLoading:u,error:p,resendRequest:g}=s.useLoadEsDeprecations(),{data:x}=s.useLoadRemoteClusters(),b=Object(a.useMemo)((()=>(e=>{const t=[],s=[];return e.forEach((e=>{e.isCritical?t.push(e):s.push(e)})),{criticalDeprecations:t.length,warningDeprecations:s.length}})((null==o?void 0:o.deprecations)||[])),[null==o?void 0:o.deprecations]);return Object(a.useEffect)((()=>{n.setBreadcrumbs("esDeprecations")}),[n]),Object(a.useEffect)((()=>{O.s.trackUiMetric(m.METRIC_TYPE.LOADED,O.e)}),[]),p?Object(d.jsx)(M,{deprecationSource:"Elasticsearch",message:W(p).message}):u?Object(d.jsx)(l.EuiPageContent_Deprecated,{verticalPosition:"center",horizontalPosition:"center",color:"subdued"},Object(d.jsx)(c.g,null,it.isLoading)):0===(null==o||null===(t=o.deprecations)||void 0===t?void 0:t.length)?Object(d.jsx)(l.EuiPageContent_Deprecated,{verticalPosition:"center",horizontalPosition:"center",color:"subdued"},Object(d.jsx)(E,{deprecationType:"Elasticsearch",navigateToOverviewPage:()=>e.push("/overview")})):Object(d.jsx)("div",{"data-test-subj":"esDeprecationsContent"},Object(d.jsx)(l.EuiPageHeader,{pageTitle:it.pageTitle,description:Object(d.jsx)(i.a.Fragment,null,it.pageDescription," ",nt(r))},Object(d.jsx)(i.a.Fragment,null,x&&x.length>0&&Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(l.EuiCallOut,{title:it.remoteClustersDetectedTitle,color:"warning",iconType:"help","data-test-subj":"remoteClustersWarningCallout"},Object(d.jsx)("p",null,it.getRemoteClustersDetectedDescription(x.length)," ",Object(d.jsx)(rt,null))),Object(d.jsx)(l.EuiSpacer,null)),Object(d.jsx)(C,{totalCriticalDeprecations:b.criticalDeprecations,totalWarningDeprecations:b.warningDeprecations}))),Object(d.jsx)(l.EuiSpacer,{size:"l"}),Object(d.jsx)(at,{deprecations:null==o?void 0:o.deprecations,reload:g}))}));var lt=s(32),ut=s(33);const ct=({checkpoint:e})=>{const{services:{data:t},plugins:{share:s}}=j(),[i,n]=Object(a.useState)();return Object(a.useEffect)((()=>{(async()=>{const a=s.url.locators.get("DISCOVER_APP_LOCATOR");if(!a)return;const i=await(async e=>{const t=(await e.dataViews.find(u.h)).find((e=>e.title===u.h));if(t)return t;{const t=!1,s=!0;return await e.dataViews.createAndSave({title:u.h,allowNoIndex:!0},t,s)}})(t),r=i.getFieldByName(u.i);let o=[];if(void 0!==r){const e=Object(ut.buildPhrasesFilter)(r,[...u.b],i);e.meta.negate=!0,o=[e]}const l=await(null==a?void 0:a.getUrl({indexPatternId:i.id,query:{language:"kuery",query:`@timestamp > "${e}"`},filters:o}));n(l)})()}),[t,e,s.url.locators]),void 0===i?null:Object(d.jsx)(l.EuiLink,{href:i,onClick:()=>{O.s.trackUiMetric(m.METRIC_TYPE.CLICK,O.d)},"data-test-subj":"viewDiscoverLogs"},Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.overview.viewDiscoverResultsAction",defaultMessage:"Analyze logs in Discover"}))},dt=({checkpoint:e})=>{var t;const{services:{core:{http:s}}}=j(),a=`sourceId=${u.j}&logPosition=(end:now,start:${Object(lt.encode)(e)})&logFilter=${encodeURI(`(language:kuery,query:'not ${u.i} : (${u.b.join(" or ")})')`)}`,i=null==s||null===(t=s.basePath)||void 0===t?void 0:t.prepend(`/app/logs/stream?${a}`);return Object(d.jsx)(l.EuiLink,{href:i,onClick:()=>{O.s.trackUiMetric(m.METRIC_TYPE.CLICK,O.l)},"data-test-subj":"viewObserveLogs"},Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.overview.viewObservabilityResultsAction",defaultMessage:"View deprecation logs in Observability"}))},pt=({checkpoint:e})=>{const{infra:t}=j().plugins;return Object(d.jsx)(l.EuiFlexGroup,null,t&&Object(d.jsx)(l.EuiFlexItem,null,Object(d.jsx)(l.EuiPanel,null,Object(d.jsx)(l.EuiText,{size:"s"},Object(d.jsx)("p",null,Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.overview.observe.observabilityDescription",defaultMessage:"Get insight into which deprecated APIs are being used and what applications you need to update."}))),Object(d.jsx)(l.EuiSpacer,{size:"m"}),Object(d.jsx)(dt,{checkpoint:e}))),Object(d.jsx)(l.EuiFlexItem,null,Object(d.jsx)(l.EuiPanel,null,Object(d.jsx)(l.EuiText,{size:"s"},Object(d.jsx)("p",null,Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.overview.observe.discoveryDescription",defaultMessage:"Search and filter the deprecation logs to understand the types of changes you need to make."}))),Object(d.jsx)(l.EuiSpacer,{size:"m"}),Object(d.jsx)(ct,{checkpoint:e}))))};var gt=s(28),jt=s.n(gt);const xt={calloutTitle:(e,t)=>Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.overview.verifyChanges.calloutTitle",defaultMessage:"{warningsCount, plural, =0 {No} other {{warningsCount}}} deprecation {warningsCount, plural, one {issue} other {issues}} since {previousCheck}",values:{warningsCount:e,previousCheck:Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(o.FormattedDate,{value:t,year:"numeric",month:"long",day:"2-digit"})," ",Object(d.jsx)(o.FormattedTime,{value:t,timeZoneName:"short",hour12:!1}))}}),calloutBody:f.i18n.translate("xpack.upgradeAssistant.overview.verifyChanges.calloutBody",{defaultMessage:"After making changes, reset the counter and continue monitoring to verify you're no longer using deprecated features."}),loadingError:f.i18n.translate("xpack.upgradeAssistant.overview.verifyChanges.loadingError",{defaultMessage:"An error occurred while retrieving the count of deprecation logs"}),retryButton:f.i18n.translate("xpack.upgradeAssistant.overview.verifyChanges.retryButton",{defaultMessage:"Try again"}),resetCounterButton:f.i18n.translate("xpack.upgradeAssistant.overview.verifyChanges.resetCounterButton",{defaultMessage:"Reset counter"}),errorToastTitle:f.i18n.translate("xpack.upgradeAssistant.overview.verifyChanges.errorToastTitle",{defaultMessage:"Could not delete deprecation logs cache"})},bt=({checkpoint:e,setCheckpoint:t})=>{const[s,i]=Object(a.useState)(!1),{services:{api:n,core:{notifications:r}}}=j(),{data:o,error:u,isLoading:c,resendRequest:p,isInitialRequest:g}=n.getDeprecationLogsCount(e),x=(null==o?void 0:o.count)||0,b=x>0,f=b?"warning":"success",h=b?"alert":"check",v=b?"hasWarningsCallout":"noWarningsCallout";return g&&c?Object(d.jsx)(l.EuiLoadingContent,{lines:6}):u?Object(d.jsx)(l.EuiCallOut,{title:xt.loadingError,color:"danger",iconType:"alert","data-test-subj":"errorCallout"},Object(d.jsx)("p",null,u.statusCode," - ",u.message),Object(d.jsx)(l.EuiButton,{color:"danger",onClick:p,"data-test-subj":"retryButton"},xt.retryButton)):Object(d.jsx)(l.EuiCallOut,{title:xt.calloutTitle(x,e),color:f,iconType:h,"data-test-subj":v},Object(d.jsx)("p",null,xt.calloutBody),Object(d.jsx)(l.EuiButton,{color:f,onClick:async()=>{i(!0);const{error:e}=await n.deleteDeprecationLogsCache();if(i(!1),e)return void r.toasts.addDanger({title:xt.errorToastTitle,text:e.message.toString()});const s=jt()().toISOString();O.s.trackUiMetric(m.METRIC_TYPE.CLICK,O.r),t(s)},isLoading:s||c,"data-test-subj":"resetLastStoredDate"},xt.resetCounterButton))},ft={enabledMessage:f.i18n.translate("xpack.upgradeAssistant.overview.deprecationLogs.enabledToastMessage",{defaultMessage:"Deprecated API requests will be logged and indexed."}),disabledMessage:f.i18n.translate("xpack.upgradeAssistant.overview.deprecationLogs.disabledToastMessage",{defaultMessage:"Deprecated API requests will not be logged."})},mt=()=>{const{services:{api:e,core:{notifications:t}}}=j(),{data:s,error:i,isLoading:n,resendRequest:r}=e.useLoadDeprecationLogging(),[o,l]=Object(a.useState)(!1),[u,c]=Object(a.useState)(!1),[d,p]=Object(a.useState)(!1),[g,x]=Object(a.useState)();return Object(a.useEffect)((()=>{if(!n&&s){const{isDeprecationLogIndexingEnabled:e,isDeprecationLoggingEnabled:t}=s;l(e),!e&&t&&p(!0)}}),[s,n]),{isDeprecationLogIndexingEnabled:o,isLoading:n,isUpdating:u,toggleLogging:async()=>{c(!0);const{data:s,error:a}=await e.updateDeprecationLogging({isEnabled:!o});c(!1),p(!1),a?x(a):s&&(l(s.isDeprecationLogIndexingEnabled),t.toasts.addSuccess(s.isDeprecationLogIndexingEnabled?ft.enabledMessage:ft.disabledMessage))},fetchError:i,updateError:g,resendRequest:r,onlyDeprecationLogWritingEnabled:d}};s(56);const Ot={fetchErrorMessage:f.i18n.translate("xpack.upgradeAssistant.overview.deprecationLogs.fetchErrorMessage",{defaultMessage:"Could not retrieve logging information."}),reloadButtonLabel:f.i18n.translate("xpack.upgradeAssistant.overview.deprecationLogs.reloadButtonLabel",{defaultMessage:"Try again"}),updateErrorMessage:f.i18n.translate("xpack.upgradeAssistant.overview.deprecationLogs.updateErrorMessage",{defaultMessage:"Could not update logging state."}),errorLabel:f.i18n.translate("xpack.upgradeAssistant.overview.deprecationLogs.errorLabel",{defaultMessage:"Error"}),buttonLabel:f.i18n.translate("xpack.upgradeAssistant.overview.deprecationLogs.buttonLabel",{defaultMessage:"Enable deprecation log collection"}),loadingLogsLabel:f.i18n.translate("xpack.upgradeAssistant.overview.loadingLogsLabel",{defaultMessage:"Loading deprecation log collection state…"})},ht=({error:e})=>{const[t,s]=Object(a.useState)(!1);if(!e.statusCode||!e.message)return null;const i=Object(d.jsx)(l.EuiLink,{color:"danger",onClick:()=>s(!t)},Ot.errorLabel," ",e.statusCode);return Object(d.jsx)(l.EuiPopover,{button:i,isOpen:t,closePopover:()=>s(!1)},Object(d.jsx)(l.EuiText,{style:{width:300}},Object(d.jsx)("p",null,e.message)))},vt=({isDeprecationLogIndexingEnabled:e,isLoading:t,isUpdating:s,fetchError:a,updateError:i,resendRequest:n,toggleLogging:r})=>t?Object(d.jsx)(l.EuiFlexGroup,{gutterSize:"s",alignItems:"center",className:"upgToggleLoading"},Object(d.jsx)(l.EuiFlexItem,{grow:!1,className:"upgLoadingItem"},Object(d.jsx)(l.EuiLoadingSpinner,{size:"m"})),Object(d.jsx)(l.EuiFlexItem,{grow:!1},Ot.loadingLogsLabel)):a?Object(d.jsx)(l.EuiFlexGroup,{gutterSize:"none",alignItems:"center"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiFlexGroup,{gutterSize:"xs",alignItems:"flexEnd","data-test-subj":"fetchLoggingError"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiTextColor,{color:"danger"},Ot.fetchErrorMessage)),Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(ht,{error:a})))),Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiButtonEmpty,{iconType:"refresh",onClick:n},Ot.reloadButtonLabel))):Object(d.jsx)(l.EuiFlexGroup,{gutterSize:"m",alignItems:"center"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiSwitch,{"data-test-subj":"deprecationLoggingToggle",label:Ot.buttonLabel,checked:!!e,onChange:r,disabled:Boolean(a)||s})),i&&Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiFlexGroup,{gutterSize:"xs",alignItems:"flexEnd","data-test-subj":"updateLoggingError"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiTextColor,{color:"danger"},Ot.updateErrorMessage)),Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(ht,{error:i})))),s&&Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiLoadingSpinner,{size:"m"}))),Et="kibana.upgradeAssistant.lastCheckpoint",kt=new c.h(window.localStorage),yt=()=>{const e=jt()(kt.get(Et));if(e.isValid())return e.toISOString();const t=jt()().toISOString();return kt.set(Et,t),t},Ct={analyzeTitle:f.i18n.translate("xpack.upgradeAssistant.overview.analyzeTitle",{defaultMessage:"Analyze deprecation logs"}),deprecationsCountCheckpointTitle:f.i18n.translate("xpack.upgradeAssistant.overview.deprecationsCountCheckpointTitle",{defaultMessage:"Resolve deprecation issues and verify your changes"}),apiCompatibilityNoteTitle:f.i18n.translate("xpack.upgradeAssistant.overview.apiCompatibilityNoteTitle",{defaultMessage:"Apply API compatibility headers (optional)"}),apiCompatibilityNoteBody:e=>Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.overview.apiCompatibilityNoteBody",defaultMessage:"We recommend you resolve all deprecation issues before upgrading. If needed, you can apply API compatibility headers to requests that use deprecated features. {learnMoreLink}.",values:{learnMoreLink:Object(d.jsx)(l.EuiLink,{href:e,target:"_blank"},Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.overview.apiCompatibilityNoteLink",defaultMessage:"Learn more"}))}}),onlyLogWritingEnabledTitle:f.i18n.translate("xpack.upgradeAssistant.overview.deprecationLogs.deprecationWarningTitle",{defaultMessage:"Your logs are being written to the logs directory"}),onlyLogWritingEnabledBody:f.i18n.translate("xpack.upgradeAssistant.overview.deprecationLogs.deprecationWarningBody",{defaultMessage:"Go to your logs directory to view the deprecation logs or enable deprecation log collection to see them in Kibana."}),deniedPrivilegeTitle:f.i18n.translate("xpack.upgradeAssistant.overview.deprecationLogs.deniedPrivilegeTitle",{defaultMessage:"You require index privileges to analyze the deprecation logs"}),deniedPrivilegeDescription:e=>{var t,s;return Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.overview.deprecationLogs.deniedPrivilegeDescription",defaultMessage:"The deprecation logs will continue to be indexed, but you won't be able to analyze them until you have the read index {privilegesCount, plural, one {privilege} other {privileges}} for: {missingPrivileges}",values:{missingPrivileges:Object(d.jsx)(l.EuiCode,{transparentBackground:!0},null==e||null===(t=e.index)||void 0===t?void 0:t.join(", ")),privilegesCount:null==e||null===(s=e.index)||void 0===s?void 0:s.length}})}},St=({hasPrivileges:e,privilegesMissing:t})=>{const{services:{core:{docLinks:s}}}=j(),{isDeprecationLogIndexingEnabled:n,onlyDeprecationLogWritingEnabled:r,isLoading:o,isUpdating:u,fetchError:c,updateError:p,resendRequest:g,toggleLogging:x}=mt(),[b,f]=Object(a.useState)(yt());return Object(a.useEffect)((()=>{var e;e=b,kt.set(Et,e)}),[b]),Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(vt,{isDeprecationLogIndexingEnabled:n,isLoading:o,isUpdating:u,fetchError:c,updateError:p,resendRequest:g,toggleLogging:x}),r&&Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(l.EuiSpacer,{size:"m"}),Object(d.jsx)(l.EuiCallOut,{title:Ct.onlyLogWritingEnabledTitle,color:"warning",iconType:"help","data-test-subj":"deprecationWarningCallout"},Object(d.jsx)("p",null,Ct.onlyLogWritingEnabledBody))),!e&&n&&Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(l.EuiSpacer,{size:"m"}),Object(d.jsx)(l.EuiCallOut,{iconType:"help",color:"warning",title:Ct.deniedPrivilegeTitle,"data-test-subj":"noIndexPermissionsCallout"},Object(d.jsx)("p",null,Ct.deniedPrivilegeDescription(t)))),e&&n&&Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(l.EuiSpacer,{size:"xl"}),Object(d.jsx)(l.EuiText,{"data-test-subj":"externalLinksTitle"},Object(d.jsx)("h4",null,Ct.analyzeTitle)),Object(d.jsx)(l.EuiSpacer,{size:"m"}),Object(d.jsx)(pt,{checkpoint:b}),Object(d.jsx)(l.EuiSpacer,{size:"xl"}),Object(d.jsx)(l.EuiText,{"data-test-subj":"deprecationsCountTitle"},Object(d.jsx)("h4",null,Ct.deprecationsCountCheckpointTitle)),Object(d.jsx)(l.EuiSpacer,{size:"m"}),Object(d.jsx)(bt,{checkpoint:b,setCheckpoint:f}),Object(d.jsx)(l.EuiSpacer,{size:"xl"}),Object(d.jsx)(l.EuiText,{"data-test-subj":"apiCompatibilityNoteTitle"},Object(d.jsx)("h4",null,Ct.apiCompatibilityNoteTitle)),Object(d.jsx)(l.EuiSpacer,{size:"m"}),Object(d.jsx)(l.EuiText,null,Object(d.jsx)("p",null,Ct.apiCompatibilityNoteBody(s.links.elasticsearch.apiCompatibilityHeader)))))},Tt=()=>Object(d.jsx)(c.i,{privileges:`index.${u.g}`},(({hasPrivileges:e,privilegesMissing:t,isLoading:s})=>Object(d.jsx)(St,{hasPrivileges:!s&&e,privilegesMissing:t}))),Mt=()=>{const{services:{breadcrumbs:e,core:{docLinks:t}}}=j();return Object(a.useEffect)((()=>{O.s.trackUiMetric(m.METRIC_TYPE.LOADED,O.f)}),[]),Object(a.useEffect)((()=>{e.setBreadcrumbs("esDeprecationLogs")}),[e]),Object(d.jsx)(l.EuiPageBody,{restrictWidth:!0,"data-test-subj":"esDeprecationLogs"},Object(d.jsx)(l.EuiPageContentBody_Deprecated,{color:"transparent",paddingSize:"none"},Object(d.jsx)(l.EuiPageHeader,{bottomBorder:!0,pageTitle:f.i18n.translate("xpack.upgradeAssistant.esDeprecationLogs.pageTitle",{defaultMessage:"Elasticsearch deprecation logs"}),description:f.i18n.translate("xpack.upgradeAssistant.esDeprecationLogs.pageDescription",{defaultMessage:"Review the deprecation logs to determine if your applications are using any deprecated APIs. Update your applications to prevent errors or changes in behavior after you upgrade."}),rightSideItems:[Object(d.jsx)(l.EuiButtonEmpty,{href:t.links.elasticsearch.migrationApiDeprecation,target:"_blank",iconType:"help","data-test-subj":"documentationLink"},Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.esDeprecationLogs.documentationLinkText",defaultMessage:"Documentation"}))]}),Object(d.jsx)(l.EuiSpacer,{size:"l"}),Object(d.jsx)(Tt,null)))},Lt=()=>{var e;const{plugins:{share:t}}=j(),s=null===(e=t.url.locators.get("SNAPSHOT_RESTORE_LOCATOR"))||void 0===e?void 0:e.useUrl({page:"snapshots"});return Object(d.jsx)(l.EuiButton,{href:s,onClick:()=>{O.s.trackUiMetric(m.METRIC_TYPE.CLICK,O.b)},"data-test-subj":"snapshotRestoreLink"},Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.overview.snapshotRestoreLink",defaultMessage:"Create snapshot"}))},It=()=>Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(l.EuiText,null,Object(d.jsx)("p",null,f.i18n.translate("xpack.upgradeAssistant.overview.backupStepDescription",{defaultMessage:"Make sure you have a current snapshot before making any changes."}))),Object(d.jsx)(l.EuiSpacer,{size:"s"}),Object(d.jsx)(Lt,null)),Ft=({cloudSnapshotsUrl:e,setIsComplete:t,setForceOnPremStep:s})=>{const{services:{api:n}}=j(),{isInitialRequest:r,isLoading:c,error:p,data:g,resendRequest:x}=n.useLoadCloudBackupStatus();if(Object(a.useEffect)((()=>{var e;c||(t(null!==(e=!p&&(null==g?void 0:g.isBackedUp))&&void 0!==e&&e),p&&(e=>404===e.statusCode&&e.message.toString().includes(u.d))(p)&&s(!0))}),[p,c,g,s]),r&&c)return Object(d.jsx)(l.EuiLoadingContent,{"data-test-subj":"cloudBackupLoading",lines:3});if(p)return Object(d.jsx)(l.EuiCallOut,{title:f.i18n.translate("xpack.upgradeAssistant.overview.cloudBackup.loadingError",{defaultMessage:"An error occurred while retrieving the latest snapshot status"}),color:"danger",iconType:"alert","data-test-subj":"cloudBackupErrorCallout"},Object(d.jsx)("p",null,p.statusCode," - ",p.message),Object(d.jsx)(l.EuiButton,{color:"danger",onClick:x,"data-test-subj":"cloudBackupRetryButton"},f.i18n.translate("xpack.upgradeAssistant.overview.cloudBackup.retryButton",{defaultMessage:"Try again"})));const b=jt()(g.lastBackupTime).toISOString(),h=g.isBackedUp?Object(d.jsx)(l.EuiFlexGroup,{alignItems:"center",gutterSize:"s","data-test-subj":"dataBackedUpStatus"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiIcon,{type:"check",color:"success"})),Object(d.jsx)(l.EuiFlexItem,null,Object(d.jsx)(l.EuiText,null,Object(d.jsx)("p",null,Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.overview.cloudBackup.hasSnapshotMessage",defaultMessage:"Last snapshot created on {lastBackupTime}.",values:{lastBackupTime:Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(o.FormattedDate,{value:b,year:"numeric",month:"long",day:"2-digit"})," ",Object(d.jsx)(o.FormattedTime,{value:b,timeZoneName:"short",hour12:!1}))}}))))):Object(d.jsx)(l.EuiFlexGroup,{alignItems:"center",gutterSize:"s","data-test-subj":"dataNotBackedUpStatus"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiIcon,{type:"alert",color:"danger"})),Object(d.jsx)(l.EuiFlexItem,null,Object(d.jsx)(l.EuiText,null,Object(d.jsx)("p",null,f.i18n.translate("xpack.upgradeAssistant.overview.cloudBackup.noSnapshotMessage",{defaultMessage:"Your data isn't backed up."})))));return Object(d.jsx)(i.a.Fragment,null,h,Object(d.jsx)(l.EuiSpacer,{size:"s"}),Object(d.jsx)(l.EuiButton,{href:e,onClick:()=>{O.s.trackUiMetric(m.METRIC_TYPE.CLICK,O.a)},"data-test-subj":"cloudSnapshotsLink",target:"_blank",iconType:"popout",iconSide:"right"},Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.overview.cloudBackup.snapshotsLink",defaultMessage:"Create snapshot"})))},wt=f.i18n.translate("xpack.upgradeAssistant.overview.backupStepTitle",{defaultMessage:"Back up your data"}),Dt=({cloud:e,setIsComplete:t})=>{const[s,i]=Object(a.useState)(!1);return null!=e&&e.isCloudEnabled&&!s?Object(d.jsx)(Ft,{setIsComplete:t,cloudSnapshotsUrl:e.snapshotsUrl,setForceOnPremStep:i}):Object(d.jsx)(It,null)},At=({cloud:e,isComplete:t,setIsComplete:s})=>{const a=null!=e&&e.isCloudEnabled&&t?"complete":"incomplete";return{title:wt,status:a,"data-test-subj":`backupStep-${a}`,children:Object(d.jsx)(Dt,{cloud:e,setIsComplete:s})}},Rt=({children:e})=>Object(d.jsx)(l.EuiText,{color:"subdued","data-test-subj":"loadingIssuesError"},Object(d.jsx)(l.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiIcon,{type:"alert",color:"danger"})),Object(d.jsx)(l.EuiFlexItem,{grow:!1},e))),Bt={noPartialDeprecationIssuesText:f.i18n.translate("xpack.upgradeAssistant.noPartialDeprecationsMessage",{defaultMessage:"None"}),noDeprecationIssuesText:f.i18n.translate("xpack.upgradeAssistant.noDeprecationsMessage",{defaultMessage:"No issues"})},Pt=e=>{const{isPartial:t=!1}=e;return Object(d.jsx)(l.EuiText,{color:"success"},Object(d.jsx)(l.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiIcon,{type:"check"})),Object(d.jsx)(l.EuiFlexItem,{grow:!1,"data-test-subj":e["data-test-subj"]},t?Bt.noPartialDeprecationIssuesText:Bt.noDeprecationIssuesText)))};s(61);const _t={warningDeprecationsTitle:f.i18n.translate("xpack.upgradeAssistant.deprecationStats.warningDeprecationsTitle",{defaultMessage:"Warning"}),criticalDeprecationsTitle:f.i18n.translate("xpack.upgradeAssistant.deprecationStats.criticalDeprecationsTitle",{defaultMessage:"Critical"})},Nt=e=>{const{deprecationSource:t,linkUrl:s,criticalDeprecationsCount:i,warningDeprecationsCount:n,isLoading:o,errorMessage:u,setIsFixed:p}=e,g=Object(r.useHistory)(),j=!!u,x=i>0,b=n>0,f=!(o||j||b||x);return Object(a.useEffect)((()=>{o||u||p(0===i)}),[p,i,o,u]),Object(d.jsx)(l.EuiCard,Ce()({"data-test-subj":e["data-test-subj"],className:"upgDeprecationIssuesPanel",layout:"horizontal",title:t,titleSize:"xs"},!f&&Object(c.j)(g,s)),Object(d.jsx)(l.EuiSpacer,{size:"s"}),j?Object(d.jsx)(Rt,null,u):f?Object(d.jsx)(Pt,{"data-test-subj":"noDeprecationIssues"}):Object(d.jsx)(l.EuiFlexGroup,null,Object(d.jsx)(l.EuiFlexItem,null,Object(d.jsx)(l.EuiStat,{"data-test-subj":"criticalDeprecations",className:"upgDeprecationIssuesPanel__stat",title:j?"--":x?je(i):Object(d.jsx)(Pt,{isPartial:!0,"data-test-subj":"noCriticalDeprecationIssues"}),titleElement:"span",description:_t.criticalDeprecationsTitle,titleColor:"danger",isLoading:o})),Object(d.jsx)(l.EuiFlexItem,null,Object(d.jsx)(l.EuiStat,{"data-test-subj":"warningDeprecations",className:"upgDeprecationIssuesPanel__stat",title:j?"--":b?je(n):Object(d.jsx)(Pt,{isPartial:!0,"data-test-subj":"noWarningDeprecationIssues"}),titleElement:"span",description:_t.warningDeprecationsTitle,isLoading:o}))))},zt=({setIsFixed:e})=>{var t,s,a,i,n,r;const{services:{api:o}}=j(),{data:l,isLoading:u,error:c}=o.useLoadEsDeprecations(),p=null!==(t=null==l||null===(s=l.deprecations)||void 0===s||null===(a=s.filter((e=>e.isCritical)))||void 0===a?void 0:a.length)&&void 0!==t?t:0,g=null!==(i=null==l||null===(n=l.deprecations)||void 0===n||null===(r=n.filter((e=>!1===e.isCritical)))||void 0===r?void 0:r.length)&&void 0!==i?i:0,x=c&&W(c).message;return Object(d.jsx)(Nt,{"data-test-subj":"esStatsPanel",deprecationSource:"Elasticsearch",linkUrl:"/es_deprecations",criticalDeprecationsCount:p,warningDeprecationsCount:g,isLoading:u,errorMessage:x,setIsFixed:e})},Ut=({setIsFixed:e})=>{var t,s,i,n;const{services:{core:{deprecations:r}}}=j(),[o,l]=Object(a.useState)(void 0),[u,c]=Object(a.useState)(!1),[p,g]=Object(a.useState)(void 0);Object(a.useEffect)((()=>{!async function(){c(!0);try{const e=await r.getAllDeprecations();l(e)}catch(e){g(e)}c(!1)}()}),[r]);const x=null!==(t=null==o||null===(s=o.filter((e=>"critical"===e.level)))||void 0===s?void 0:s.length)&&void 0!==t?t:0,b=null!==(i=null==o||null===(n=o.filter((e=>"warning"===e.level)))||void 0===n?void 0:n.length)&&void 0!==i?i:0,m=p&&f.i18n.translate("xpack.upgradeAssistant.deprecationStats.loadingErrorMessage",{defaultMessage:"Could not retrieve Kibana deprecation issues."});return Object(d.jsx)(Nt,{"data-test-subj":"kibanaStatsPanel",deprecationSource:"Kibana",linkUrl:"/kibana_deprecations",criticalDeprecationsCount:x,warningDeprecationsCount:b,isLoading:u,errorMessage:m,setIsFixed:e})},Wt={reviewStepTitle:f.i18n.translate("xpack.upgradeAssistant.overview.fixIssuesStepTitle",{defaultMessage:"Review deprecated settings and resolve issues"})},qt=({setIsComplete:e})=>{const[t,s]=Object(a.useState)(!1),[i,n]=Object(a.useState)(!1);return Object(a.useEffect)((()=>{e(t&&i)}),[t,i]),Object(d.jsx)(l.EuiFlexGroup,null,Object(d.jsx)(l.EuiFlexItem,null,Object(d.jsx)(zt,{setIsFixed:s})),Object(d.jsx)(l.EuiFlexItem,null,Object(d.jsx)(Ut,{setIsFixed:n})))},Gt=({isComplete:e,setIsComplete:t})=>{const s=e?"complete":"incomplete";return{title:Wt.reviewStepTitle,status:s,"data-test-subj":`fixIssuesStep-${s}`,children:Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(l.EuiText,null,Object(d.jsx)("p",null,Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.overview.fixIssuesStepDescription",defaultMessage:"You must resolve any critical Elasticsearch and Kibana configuration issues before upgrading to the next version of the Elastic Stack. Ignoring warnings might result in differences in behavior after you upgrade."}))),Object(d.jsx)(l.EuiSpacer,{size:"m"}),Object(d.jsx)(qt,{setIsComplete:t}))}},$t={upgradeStepTitle:f.i18n.translate("xpack.upgradeAssistant.overview.upgradeStepTitle",{defaultMessage:"Upgrade the Elastic Stack"}),upgradeStepDescription:f.i18n.translate("xpack.upgradeAssistant.overview.upgradeStepDescription",{defaultMessage:"Once you’ve resolved all critical issues and verified that your applications are ready, you can upgrade to the next version of the Elastic Stack. Be sure to back up your data again before upgrading."}),upgradeStepDescriptionForCloud:f.i18n.translate("xpack.upgradeAssistant.overview.upgradeStepDescriptionForCloud",{defaultMessage:"Once you've resolved all critical issues and verified that your applications are ready, you can upgrade to the next version of the Elastic Stack. Be sure to back up your data again before upgrading. Upgrade your deployment on Elastic Cloud."}),upgradeStepCloudLink:f.i18n.translate("xpack.upgradeAssistant.overview.upgradeStepCloudLink",{defaultMessage:"Upgrade on Cloud"}),loadingUpgradeStatus:f.i18n.translate("xpack.upgradeAssistant.overview.loadingUpgradeStatus",{defaultMessage:"Loading upgrade status"}),upgradeGuideLink:f.i18n.translate("xpack.upgradeAssistant.overview.upgradeGuideLink",{defaultMessage:"View upgrade guide"})},Kt=()=>{const{plugins:{cloud:e},services:{api:t,core:{docLinks:s}}}=j(),a=Boolean(null==e?void 0:e.isCloudEnabled),{data:n,isLoading:r,error:o,resendRequest:u}=t.useLoadUpgradeStatus();let c;if(a)if(o)c=Object(d.jsx)(l.EuiCallOut,{title:f.i18n.translate("xpack.upgradeAssistant.overview.errorLoadingUpgradeStatus",{defaultMessage:"An error occurred while retrieving the upgrade status"}),color:"danger",iconType:"alert","data-test-subj":"upgradeStatusErrorCallout"},Object(d.jsx)("p",null,o.statusCode," - ",o.message),Object(d.jsx)(l.EuiButton,{color:"danger",onClick:u,"data-test-subj":"upgradeStatusRetryButton",isLoading:r},f.i18n.translate("xpack.upgradeAssistant.overview.upgradeStatus.retryButton",{defaultMessage:"Try again"})));else{const t=null==n?void 0:n.readyForUpgrade,a=e.deploymentUrl+"?show_upgrade=true";c=Object(d.jsx)(l.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiButton,{href:a,target:"_blank","data-test-subj":"upgradeSetupCloudLink",iconSide:"right",iconType:"popout",isLoading:r,isDisabled:!t},r?$t.loadingUpgradeStatus:$t.upgradeStepCloudLink)),Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiButtonEmpty,{href:s.links.upgrade.upgradingStackOnCloud,target:"_blank","data-test-subj":"upgradeSetupDocsLink",iconSide:"right",iconType:"popout"},$t.upgradeGuideLink)))}else c=Object(d.jsx)(l.EuiButton,{href:s.links.upgrade.upgradingStackOnPrem,target:"_blank","data-test-subj":"upgradeSetupDocsLink",iconSide:"right",iconType:"popout"},$t.upgradeGuideLink);return Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(l.EuiText,null,Object(d.jsx)("p",null,a?$t.upgradeStepDescriptionForCloud:$t.upgradeStepDescription)),Object(d.jsx)(l.EuiSpacer,{size:"m"}),c)};var Yt=s(66),Vt=s.n(Yt);const Ht={closeButtonLabel:f.i18n.translate("xpack.upgradeAssistant.overview.systemIndices.flyoutCloseButtonLabel",{defaultMessage:"Close"}),flyoutTitle:f.i18n.translate("xpack.upgradeAssistant.overview.systemIndices.flyoutTitle",{defaultMessage:"Migrate system indices"}),flyoutDescription:f.i18n.translate("xpack.upgradeAssistant.overview.systemIndices.flyoutDescription",{defaultMessage:"Migrate the indices that store information for the following features before you upgrade."}),migrationCompleteLabel:f.i18n.translate("xpack.upgradeAssistant.overview.systemIndices.migrationCompleteLabel",{defaultMessage:"Migration complete"}),needsMigrationLabel:f.i18n.translate("xpack.upgradeAssistant.overview.systemIndices.needsMigrationLabel",{defaultMessage:"Migration required"}),migratingLabel:f.i18n.translate("xpack.upgradeAssistant.overview.systemIndices.migratingLabel",{defaultMessage:"Migration in progress"}),errorLabel:f.i18n.translate("xpack.upgradeAssistant.overview.systemIndices.errorLabel",{defaultMessage:"Migration failed"}),featureNameTableColumn:f.i18n.translate("xpack.upgradeAssistant.overview.systemIndices.featureNameTableColumn",{defaultMessage:"Feature"}),statusTableColumn:f.i18n.translate("xpack.upgradeAssistant.overview.systemIndices.statusTableColumn",{defaultMessage:"Status"})},Jt=[{field:"feature_name",name:Ht.featureNameTableColumn,sortable:!0,truncateText:!0,render:e=>Object(q.startCase)(e)},{field:"migration_status",name:Ht.statusTableColumn,sortable:!0,render:e=>"NO_MIGRATION_NEEDED"===e?Object(d.jsx)(l.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiIcon,{type:"checkInCircleFilled",color:"success"})),Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiText,{color:"green",size:"s","data-test-subj":"featureNoUpgradeNeeded"},Object(d.jsx)("p",null,Ht.migrationCompleteLabel)))):"MIGRATION_NEEDED"===e?Object(d.jsx)(l.EuiText,{size:"s","data-test-subj":"featureUpgradeNeeded"},Object(d.jsx)("p",null,Ht.needsMigrationLabel)):"IN_PROGRESS"===e?Object(d.jsx)(l.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiLoadingSpinner,{size:"m"})),Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiText,{color:"subdued",size:"s","data-test-subj":"featureInProgress"},Object(d.jsx)("p",null,Ht.migratingLabel)))):"ERROR"===e?Object(d.jsx)(l.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiIcon,{type:"alert",color:"danger"})),Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiText,{color:"danger",size:"s","data-test-subj":"featureError"},Object(d.jsx)("p",null,Ht.errorLabel)))):""}],Qt=({closeFlyout:e,data:t})=>Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(l.EuiFlyoutHeader,{hasBorder:!0},Object(d.jsx)(l.EuiTitle,{size:"s","data-test-subj":"flyoutTitle"},Object(d.jsx)("h2",null,Ht.flyoutTitle))),Object(d.jsx)(l.EuiFlyoutBody,{"data-test-subj":"flyoutDetails"},Object(d.jsx)(l.EuiText,null,Object(d.jsx)("p",null,Ht.flyoutDescription)),Object(d.jsx)(l.EuiSpacer,{size:"l"}),Object(d.jsx)(l.EuiInMemoryTable,{"data-test-subj":"featuresTable",itemId:"feature_name",items:t.features,columns:Jt,pagination:!0,sorting:!0})),Object(d.jsx)(l.EuiFlyoutFooter,null,Object(d.jsx)(l.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiButtonEmpty,{onClick:e,flush:"left"},Ht.closeButtonLabel))))),Zt="migrateSystemIndicesFlyout",{useGlobalFlyout:Xt}=c.c,es={title:f.i18n.translate("xpack.upgradeAssistant.overview.systemIndices.title",{defaultMessage:"Migrate system indices"}),bodyDescription:e=>Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.overview.systemIndices.body",defaultMessage:"Prepare the system indices that store internal information for the upgrade. This is only required during major version upgrades. Any {hiddenIndicesLink} that need to be reindexed are shown in the next step.",values:{hiddenIndicesLink:Object(d.jsx)(l.EuiLink,{external:!0,target:"_blank",href:e},Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.overview.systemIndices.body.hiddenIndicesLink",defaultMessage:"hidden indices"}))}}),startButtonLabel:f.i18n.translate("xpack.upgradeAssistant.overview.systemIndices.startButtonLabel",{defaultMessage:"Migrate indices"}),inProgressButtonLabel:f.i18n.translate("xpack.upgradeAssistant.overview.systemIndices.inProgressButtonLabel",{defaultMessage:"Migration in progress"}),noMigrationNeeded:f.i18n.translate("xpack.upgradeAssistant.overview.systemIndices.noMigrationNeeded",{defaultMessage:"System indices migration not needed."}),viewSystemIndicesStatus:f.i18n.translate("xpack.upgradeAssistant.overview.systemIndices.viewSystemIndicesStatus",{defaultMessage:"View migration details"}),retryButtonLabel:f.i18n.translate("xpack.upgradeAssistant.overview.systemIndices.retryButtonLabel",{defaultMessage:"Retry migration"}),loadingError:f.i18n.translate("xpack.upgradeAssistant.overview.systemIndices.loadingError",{defaultMessage:"Could not retrieve the system indices status"}),migrationFailedTitle:f.i18n.translate("xpack.upgradeAssistant.overview.systemIndices.migrationFailedTitle",{defaultMessage:"System indices migration failed"}),migrationFailedBody:e=>{const{feature:t,failureCause:s}=(e=>{const t=e.find((e=>"ERROR"===e.migration_status));if(t){var s;const e=t.indices.find((e=>e.failure_cause));return{feature:null==t?void 0:t.feature_name,failureCause:null==e||null===(s=e.failure_cause)||void 0===s?void 0:s.error.type}}return{}})(e);return Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.overview.systemIndices.migrationFailedBody",defaultMessage:"An error ocurred while migrating system indices for {feature}: {failureCause}",values:{feature:t,failureCause:Object(d.jsx)(l.EuiCode,null,s)}})}},ts=({setIsComplete:e})=>{var t,s,n,r,o;const{beginSystemIndicesMigration:c,startMigrationStatus:p,migrationStatus:g,setShowFlyout:x}=(()=>{const{services:{api:e}}=j(),[t,s]=Object(a.useState)(!1),[i,n]=Object(a.useState)({statusType:"idle"}),{data:r,error:o,isLoading:l,resendRequest:c,isInitialRequest:d}=e.useLoadSystemIndicesMigrationStatus(),p="IN_PROGRESS"===(null==r?void 0:r.migration_status);Vt()(c,p?u.l:null);const{addContent:g,removeContent:x}=Xt(),b=Object(a.useCallback)((()=>{s(!1),x(Zt)}),[x]);Object(a.useEffect)((()=>{t&&g({id:Zt,Component:Qt,props:{data:r,closeFlyout:b},flyoutProps:{onClose:b}})}),[g,r,t,b]);const f=Object(a.useCallback)((async()=>{const{error:t}=await e.migrateSystemIndices();n({statusType:t?"error":"started",error:null!=t?t:void 0}),t||c()}),[e,c]);return{setShowFlyout:s,startMigrationStatus:i,beginSystemIndicesMigration:f,migrationStatus:{data:r,error:o,isLoading:l,resendRequest:c,isInitialRequest:d}}})();if(Object(a.useEffect)((()=>{var t;e("NO_MIGRATION_NEEDED"===(null===(t=g.data)||void 0===t?void 0:t.migration_status))}),[null===(t=g.data)||void 0===t?void 0:t.migration_status]),g.error)return Object(d.jsx)(l.EuiCallOut,{title:es.loadingError,color:"danger",iconType:"alert","data-test-subj":"systemIndicesStatusErrorCallout"},Object(d.jsx)("p",null,g.error.statusCode," - ",g.error.message),Object(d.jsx)(l.EuiButton,{color:"danger",isLoading:g.isLoading,onClick:g.resendRequest,"data-test-subj":"systemIndicesStatusRetryButton"},es.retryButtonLabel));if("NO_MIGRATION_NEEDED"===(null===(s=g.data)||void 0===s?void 0:s.migration_status))return Object(d.jsx)(l.EuiFlexGroup,{alignItems:"center",gutterSize:"s","data-test-subj":"noMigrationNeededSection"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiIcon,{type:"check",color:"success"})),Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiText,{color:"success"},Object(d.jsx)("p",null,es.noMigrationNeeded))));const b=g.isInitialRequest&&g.isLoading,f="IN_PROGRESS"===(null===(n=g.data)||void 0===n?void 0:n.migration_status);return Object(d.jsx)(i.a.Fragment,null,"error"===p.statusType&&Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(l.EuiCallOut,{size:"s",color:"danger",iconType:"alert",title:`${p.error.statusCode} - ${p.error.message}`,"data-test-subj":"startSystemIndicesMigrationCalloutError"}),Object(d.jsx)(l.EuiSpacer,{size:"m"})),"ERROR"===(null===(r=g.data)||void 0===r?void 0:r.migration_status)&&Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(l.EuiCallOut,{size:"s",color:"danger",iconType:"alert",title:es.migrationFailedTitle,"data-test-subj":"migrationFailedCallout"},Object(d.jsx)("p",null,es.migrationFailedBody(null===(o=g.data)||void 0===o?void 0:o.features))),Object(d.jsx)(l.EuiSpacer,{size:"m"})),Object(d.jsx)(l.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiButton,{isLoading:f,isDisabled:b,onClick:c,"data-test-subj":"startSystemIndicesMigrationButton"},f?es.inProgressButtonLabel:es.startButtonLabel)),Object(d.jsx)(l.EuiFlexItem,{grow:!1},Object(d.jsx)(l.EuiButtonEmpty,{onClick:()=>x(!0),isDisabled:b,"data-test-subj":"viewSystemIndicesStateButton"},es.viewSystemIndicesStatus))))},ss=({isComplete:e,setIsComplete:t,docLinks:s})=>{const a=e?"complete":"incomplete";return{title:es.title,status:a,"data-test-subj":`migrateSystemIndicesStep-${a}`,children:Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(l.EuiText,null,Object(d.jsx)("p",null,es.bodyDescription(s.links.elasticsearch.hiddenIndices))),Object(d.jsx)(l.EuiSpacer,{size:"m"}),Object(d.jsx)(ts,{setIsComplete:t}))}},as={logsStepTitle:f.i18n.translate("xpack.upgradeAssistant.overview.logsStep.title",{defaultMessage:"Address API deprecations"}),logsStepDescription:f.i18n.translate("xpack.upgradeAssistant.overview.logsStep.description",{defaultMessage:"Review the Elasticsearch deprecation logs to ensure you're not using deprecated APIs."}),viewLogsButtonLabel:f.i18n.translate("xpack.upgradeAssistant.overview.logsStep.viewLogsButtonLabel",{defaultMessage:"View logs"}),enableLogsButtonLabel:f.i18n.translate("xpack.upgradeAssistant.overview.logsStep.enableLogsButtonLabel",{defaultMessage:"Enable logging"}),logsCountDescription:(e,t)=>Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.overview.logsStep.countDescription",defaultMessage:"You have {deprecationCount, plural, =0 {no} other {{deprecationCount}}} deprecation {deprecationCount, plural, one {issue} other {issues}} since {checkpoint}.",values:{deprecationCount:e,checkpoint:Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(o.FormattedDate,{value:t,year:"numeric",month:"long",day:"2-digit"})," ",Object(d.jsx)(o.FormattedTime,{value:t,timeZoneName:"short",hour12:!1}))}}),missingPrivilegesTitle:f.i18n.translate("xpack.upgradeAssistant.overview.logsStep.missingPrivilegesTitle",{defaultMessage:"You require index privileges to analyze the deprecation logs"}),missingPrivilegesDescription:e=>{var t,s;return Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.overview.logsStep.missingPrivilegesDescription",defaultMessage:"The deprecation logs will continue to be indexed, but you won't be able to analyze them until you have the read index {privilegesCount, plural, one {privilege} other {privileges}} for: {missingPrivileges}",values:{missingPrivileges:Object(d.jsx)(l.EuiCode,{transparentBackground:!0},null==e||null===(t=e.index)||void 0===t?void 0:t.join(", ")),privilegesCount:null==e||null===(s=e.index)||void 0===s?void 0:s.length}})},loadingError:f.i18n.translate("xpack.upgradeAssistant.overview.logsStep.loadingError",{defaultMessage:"An error occurred while retrieving the deprecation log count"}),retryButton:f.i18n.translate("xpack.upgradeAssistant.overview.logsStep.retryButton",{defaultMessage:"Try again"})},is=()=>Object(d.jsx)(l.EuiText,null,Object(d.jsx)("p",null,as.logsStepDescription)),ns=({setIsComplete:e,hasPrivileges:t,privilegesMissing:s,navigateToEsDeprecationLogs:n})=>{const{services:{api:r}}=j(),{isDeprecationLogIndexingEnabled:o}=mt(),u=yt(),{data:c,error:p,isLoading:g,resendRequest:x,isInitialRequest:b}=r.getDeprecationLogsCount(u);return Object(a.useEffect)((()=>{o||e(!1),e(0===(null==c?void 0:c.count))}),[o,c]),!1===t&&o?Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(is,null),Object(d.jsx)(l.EuiSpacer,null),Object(d.jsx)(l.EuiCallOut,{iconType:"help",color:"warning",title:as.missingPrivilegesTitle,"data-test-subj":"missingPrivilegesCallout"},Object(d.jsx)("p",null,as.missingPrivilegesDescription(s)))):g&&b?Object(d.jsx)(l.EuiLoadingContent,{lines:3}):t&&p?Object(d.jsx)(l.EuiCallOut,{title:as.loadingError,color:"danger",iconType:"alert","data-test-subj":"deprecationLogsErrorCallout"},Object(d.jsx)("p",null,p.statusCode," - ",p.message),Object(d.jsx)(l.EuiButton,{color:"danger",onClick:x,"data-test-subj":"deprecationLogsRetryButton"},as.retryButton)):Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(is,null),o&&c?Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(l.EuiSpacer,null),Object(d.jsx)(l.EuiText,null,Object(d.jsx)("p",{"data-test-subj":"logsCountDescription"},as.logsCountDescription(c.count,u))),Object(d.jsx)(l.EuiSpacer,null),Object(d.jsx)(l.EuiButton,{onClick:n,"data-test-subj":"viewLogsLink"},as.viewLogsButtonLabel)):Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(l.EuiSpacer,null),Object(d.jsx)(l.EuiButton,{onClick:n,"data-test-subj":"enableLogsLink"},as.enableLogsButtonLabel)),Object(d.jsx)(l.EuiSpacer,{size:"m"}))},rs=({isComplete:e,setIsComplete:t,navigateToEsDeprecationLogs:s})=>{const a=e?"complete":"incomplete";return{status:a,title:as.logsStepTitle,"data-test-subj":`logsStep-${a}`,children:Object(d.jsx)(c.i,{privileges:`index.${u.g}`},(({hasPrivileges:e,isLoading:a,privilegesMissing:i})=>Object(d.jsx)(ns,{setIsComplete:t,hasPrivileges:!a&&e,navigateToEsDeprecationLogs:s,privilegesMissing:i})))}},os=Object(r.withRouter)((({history:e})=>{const{featureSet:{migrateSystemIndices:t},services:{breadcrumbs:s,core:{docLinks:i}},plugins:{cloud:n}}=j();Object(a.useEffect)((()=>{O.s.trackUiMetric(m.METRIC_TYPE.LOADED,O.m)}),[]),Object(a.useEffect)((()=>{s.setBreadcrumbs("overview")}),[s]);const[r,u]=Object(a.useState)({backup:!1,migrate_system_indices:!1,fix_issues:!1,logs:!1}),c=e=>r[e],p=(e,t)=>{u({...r,[e]:t})};return Object(d.jsx)(l.EuiPageBody,{restrictWidth:!0,"data-test-subj":"overview"},Object(d.jsx)(l.EuiPageContentBody_Deprecated,{color:"transparent",paddingSize:"none"},Object(d.jsx)(l.EuiPageHeader,{bottomBorder:!0,pageTitle:f.i18n.translate("xpack.upgradeAssistant.overview.pageTitle",{defaultMessage:"Upgrade Assistant"}),description:f.i18n.translate("xpack.upgradeAssistant.overview.pageDescription",{defaultMessage:"Get ready for the next version of the Elastic Stack!"}),rightSideItems:[Object(d.jsx)(l.EuiButtonEmpty,{href:i.links.upgradeAssistant.overview,target:"_blank",iconType:"help","data-test-subj":"documentationLink"},Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.overview.documentationLinkText",defaultMessage:"Documentation"}))]},Object(d.jsx)(l.EuiText,null,Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.overview.checkUpcomingVersion",defaultMessage:"If you are not on the latest version of the Elastic Stack, use the Upgrade Assistant to prepare for the next upgrade."})),Object(d.jsx)(l.EuiText,{"data-test-subj":"whatsNewLink"},Object(d.jsx)(l.EuiLink,{href:i.links.elasticsearch.latestReleaseHighlights,target:"_blank"},Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.overview.whatsNewLink",defaultMessage:"Check the latest release highlights"})))),Object(d.jsx)(l.EuiSpacer,{size:"l"}),Object(d.jsx)(l.EuiSteps,{steps:[At({cloud:n,isComplete:c("backup"),setIsComplete:p.bind(null,"backup")}),t&&ss({docLinks:i,isComplete:c("migrate_system_indices"),setIsComplete:p.bind(null,"migrate_system_indices")}),Gt({isComplete:c("fix_issues"),setIsComplete:p.bind(null,"fix_issues")}),rs({isComplete:c("logs"),setIsComplete:p.bind(null,"logs"),navigateToEsDeprecationLogs:()=>e.push("/es_deprecation_logs")}),{title:$t.upgradeStepTitle,status:"incomplete","data-test-subj":"upgradeStep",children:Object(d.jsx)(Kt,null)}].filter(Boolean)})))})),{GlobalFlyoutProvider:ls}=c.c,us=()=>{const{services:{api:e,core:t}}=j(),s=!0!==t.application.capabilities.spaces.manage,[i,n]=Object(a.useState)("isPreparingForUpgrade");return Object(a.useEffect)((()=>{e.onClusterUpgradeStateChange((e=>{n(e)}))}),[e]),s?Object(d.jsx)(l.EuiPageContent_Deprecated,{verticalPosition:"center",horizontalPosition:"center",color:"subdued","data-test-subj":"missingKibanaPrivilegesMessage"},Object(d.jsx)(c.e,{title:Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.app.deniedPrivilegeTitle",defaultMessage:"Kibana admin role required"}),message:Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.app.deniedPrivilegeDescription",defaultMessage:"To use Upgrade Assistant and resolve deprecation issues, you must have access to manage all Kibana spaces."})})):"isUpgrading"===i?Object(d.jsx)(l.EuiPageContent_Deprecated,{hasShadow:!1,paddingSize:"none",verticalPosition:"center",horizontalPosition:"center","data-test-subj":"isUpgradingMessage"},Object(d.jsx)(l.EuiEmptyPrompt,{iconType:"logoElasticsearch",title:Object(d.jsx)("h1",null,Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.upgradingTitle",defaultMessage:"Your cluster is upgrading"})),body:Object(d.jsx)("p",null,Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.upgradingDescription",defaultMessage:"One or more Elasticsearch nodes have a newer version of Elasticsearch than Kibana. Once all your nodes are upgraded, upgrade Kibana."})),"data-test-subj":"emptyPrompt"})):"isUpgradeComplete"===i?Object(d.jsx)(l.EuiPageContent_Deprecated,{hasShadow:!1,paddingSize:"none",verticalPosition:"center",horizontalPosition:"center","data-test-subj":"isUpgradeCompleteMessage"},Object(d.jsx)(l.EuiEmptyPrompt,{iconType:"logoElasticsearch",title:Object(d.jsx)("h1",null,Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.upgradedTitle",defaultMessage:"Your cluster has been upgraded"})),body:Object(d.jsx)("p",null,Object(d.jsx)(o.FormattedMessage,{id:"xpack.upgradeAssistant.upgradedDescription",defaultMessage:"All Elasticsearch nodes have been upgraded. You may now upgrade Kibana."})),"data-test-subj":"emptyPrompt"})):Object(d.jsx)(r.Switch,null,Object(d.jsx)(r.Route,{exact:!0,path:"/overview",component:os}),Object(d.jsx)(r.Route,{exact:!0,path:"/es_deprecations",component:ot}),Object(d.jsx)(r.Route,{exact:!0,path:"/es_deprecation_logs",component:Mt}),Object(d.jsx)(r.Route,{exact:!0,path:"/kibana_deprecations",component:z}),Object(d.jsx)(r.Redirect,{from:"/",to:"/overview"}))},cs=({history:e})=>{const{services:{api:t}}=j(),{isLoading:s,isInitialRequest:a}=t.useLoadClusterUpgradeStatus();return s&&a?Object(d.jsx)(l.EuiPageContent_Deprecated,{hasShadow:!1,paddingSize:"none",verticalPosition:"center",horizontalPosition:"center"},Object(d.jsx)(l.EuiEmptyPrompt,{body:Object(d.jsx)(l.EuiLoadingSpinner,{size:"l"})})):Object(d.jsx)(r.Router,{history:e},Object(d.jsx)(us,null))},ds=e=>{const{history:t,core:{i18n:s,application:a,http:i,executionContext:n}}=e.services;return n.set({type:"application",page:"upgradeAssistant"}),Object(d.jsx)(c.f,{application:a,className:c.a},Object(d.jsx)(c.b,{httpClient:i,privilegesEndpoint:`${u.a}/privileges`},Object(d.jsx)(s.Context,null,Object(d.jsx)(c.d,{theme$:e.theme$},Object(d.jsx)(g,{value:e},Object(d.jsx)(ls,null,Object(d.jsx)(cs,{history:t})))))))};var ps=s(10),gs=s(13);function js(e,t){const{element:s,setBreadcrumbs:a}=e;return ps.a.setup(t.services.core.http),gs.a.setup(a),Object(n.render)(Object(d.jsx)(ds,t),s),()=>{Object(n.unmountComponentAtNode)(s)}}}])]);