/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.reporting_bundle_jsonpfunction=window.reporting_bundle_jsonpfunction||[]).push([[2],{35:function(e,t,i){"use strict";var n,s=function(){var e={};return function(t){if(void 0===e[t]){var i=document.querySelector(t);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(e){i=null}e[t]=i}return e[t]}}(),a=[];function o(e){for(var t=-1,i=0;i<a.length;i++)if(a[i].identifier===e){t=i;break}return t}function l(e,t){for(var i={},n=[],s=0;s<e.length;s++){var l=e[s],r=t.base?l[0]+t.base:l[0],c=i[r]||0,u="".concat(r," ").concat(c);i[r]=c+1;var p=o(u),d={css:l[1],media:l[2],sourceMap:l[3]};-1!==p?(a[p].references++,a[p].updater(d)):a.push({identifier:u,updater:f(d,t),references:1}),n.push(u)}return n}function r(e){var t=document.createElement("style"),n=e.attributes||{};if(void 0===n.nonce){var a=i.nc;a&&(n.nonce=a)}if(Object.keys(n).forEach((function(e){t.setAttribute(e,n[e])})),"function"==typeof e.insert)e.insert(t);else{var o=s(e.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}return t}var c,u=(c=[],function(e,t){return c[e]=t,c.filter(Boolean).join("\n")});function p(e,t,i,n){var s=i?"":n.media?"@media ".concat(n.media," {").concat(n.css,"}"):n.css;if(e.styleSheet)e.styleSheet.cssText=u(t,s);else{var a=document.createTextNode(s),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(a,o[t]):e.appendChild(a)}}function d(e,t,i){var n=i.css,s=i.media,a=i.sourceMap;if(s?e.setAttribute("media",s):e.removeAttribute("media"),a&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}var g=null,b=0;function f(e,t){var i,n,s;if(t.singleton){var a=b++;i=g||(g=r(t)),n=p.bind(null,i,a,!1),s=p.bind(null,i,a,!0)}else i=r(t),n=d.bind(null,i,t),s=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(i)};return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else s()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===n&&(n=Boolean(window&&document&&document.all&&!window.atob)),n));var i=l(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var n=0;n<i.length;n++){var s=o(i[n]);a[s].references--}for(var r=l(e,t),c=0;c<i.length;c++){var u=o(i[c]);0===a[u].references&&(a[u].updater(),a.splice(u,1))}i=r}}}},36:function(e,t,i){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var i=function(e,t){var i,n,s,a=e[1]||"",o=e[3];if(!o)return a;if(t&&"function"==typeof btoa){var l=(i=o,n=btoa(unescape(encodeURIComponent(JSON.stringify(i)))),s="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(n),"/*# ".concat(s," */")),r=o.sources.map((function(e){return"/*# sourceURL=".concat(o.sourceRoot||"").concat(e," */")}));return[a].concat(r).concat([l]).join("\n")}return[a].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(i,"}"):i})).join("")},t.i=function(e,i,n){"string"==typeof e&&(e=[[null,e,""]]);var s={};if(n)for(var a=0;a<this.length;a++){var o=this[a][0];null!=o&&(s[o]=!0)}for(var l=0;l<e.length;l++){var r=[].concat(e[l]);n&&s[r[0]]||(i&&(r[2]?r[2]="".concat(i," and ").concat(r[2]):r[2]=i),t.push(r))}},t}},37:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(4);t.default=function(){var e=n.useRef(!1),t=n.useCallback((function(){return e.current}),[]);return n.useEffect((function(){return e.current=!0,function(){e.current=!1}})),t}},38:function(e,t,i){switch(window.__kbnThemeTag__){case"v8dark":return i(39);case"v8light":return i(41)}},39:function(e,t,i){var n=i(35),s=i(40);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[e.i,s,""]]);n(s,{insert:"head",singleton:!1}),e.exports=s.locals||{}},40:function(e,t,i){(t=i(36)(!1)).push([e.i,".kbnReporting__reportListing__typeIcon{padding-left:8px}",""]),e.exports=t},41:function(e,t,i){var n=i(35),s=i(42);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[e.i,s,""]]);n(s,{insert:"head",singleton:!1}),e.exports=s.locals||{}},42:function(e,t,i){(t=i(36)(!1)).push([e.i,".kbnReporting__reportListing__typeIcon{padding-left:8px}",""]),e.exports=t},56:function(e,t,i){"use strict";i.r(t),i.d(t,"mountManagementSection",(function(){return V}));var n=i(5),s=i(4),a=i.n(s),o=i(33),l=i(18),r=i(0);const c=Object(s.createContext)(void 0),u=({children:e})=>{const{isLoading:t,data:i,resendRequest:n}=Object(l.c)();return Object(r.jsx)(c.Provider,{value:{isLoading:t,status:null==i?void 0:i.status,recheckStatus:n}},e)},p=()=>{const e=Object(s.useContext)(c);if(!e)throw new Error('"useIlmPolicyStatus" can only be used inside of "IlmPolicyStatusContext"');return e};var d=i(10),g=i(13),b=i.n(g),f=i(1),m=i.n(f),h=i(6),j=i(2),x=i(3),v=i(25),O=i(34),y=i.n(O);class poller_Poller{constructor(e){m()(this,"functionToPoll",void 0),m()(this,"successFunction",void 0),m()(this,"errorFunction",void 0),m()(this,"_isRunning",void 0),m()(this,"_timeoutId",void 0),m()(this,"pollFrequencyInMillis",void 0),m()(this,"trailing",void 0),m()(this,"continuePollingOnError",void 0),m()(this,"pollFrequencyErrorMultiplier",void 0),this.functionToPoll=e.functionToPoll,this.successFunction=e.successFunction||y.a.noop,this.errorFunction=e.errorFunction||y.a.noop,this.pollFrequencyInMillis=e.pollFrequencyInMillis,this.trailing=e.trailing||!1,this.continuePollingOnError=e.continuePollingOnError||!1,this.pollFrequencyErrorMultiplier=e.pollFrequencyErrorMultiplier||1,this._timeoutId=null,this._isRunning=!1}getPollFrequency(){return this.pollFrequencyInMillis}_poll(){return this.functionToPoll().then(this.successFunction).then((()=>{this._isRunning&&(this._timeoutId=setTimeout(this._poll.bind(this),this.pollFrequencyInMillis))})).catch((e=>{this.errorFunction(e),this._isRunning&&(this.continuePollingOnError?this._timeoutId=setTimeout(this._poll.bind(this),this.pollFrequencyInMillis*this.pollFrequencyErrorMultiplier):this.stop())}))}start(){this._isRunning||(this._isRunning=!0,this.trailing?this._timeoutId=setTimeout(this._poll.bind(this),this.pollFrequencyInMillis):this._poll())}stop(){this._isRunning&&(this._isRunning=!1,this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=null)}isRunning(){return this._isRunning}}var k=i(20),M=i(12),w=i(37),C=i.n(w);const I={title:j.i18n.translate("xpack.reporting.listing.ilmPolicyCallout.migrationNeededTitle",{defaultMessage:"Apply new lifecycle policy for reports"}),description:Object(r.jsx)(n.FormattedMessage,{id:"xpack.reporting.listing.ilmPolicyCallout.migrationNeededDescription",defaultMessage:"To ensure your reports are managed consistently, all reporting indices should use the {ilmPolicyName} policy.",values:{ilmPolicyName:Object(r.jsx)(h.EuiCode,null,x.k)}}),buttonLabel:j.i18n.translate("xpack.reporting.listing.ilmPolicyCallout.migrateIndicesButtonLabel",{defaultMessage:"Apply {ilmPolicyName} policy",values:{ilmPolicyName:x.k}}),migrateErrorTitle:j.i18n.translate("xpack.reporting.listing.ilmPolicyCallout.migrateIndicesErrorTitle",{defaultMessage:"Could not migrate reporting indices"}),migrateSuccessTitle:j.i18n.translate("xpack.reporting.listing.ilmPolicyCallout.migrateIndicesSuccessTitle",{defaultMessage:"Reporting policy active for all reporting indices"})},E=({toasts:e,onMigrationDone:t})=>{const[i,n]=Object(s.useState)(!1),a=C()(),{apiClient:o}=Object(l.d)();return Object(r.jsx)(h.EuiCallOut,{"data-test-subj":"migrateReportingIndicesPolicyCallOut",title:I.title},Object(r.jsx)("p",null,I.description),Object(r.jsx)(h.EuiButton,{"data-test-subj":"migrateReportingIndicesButton",isLoading:i,onClick:async()=>{try{n(!0),await o.migrateReportingIndicesIlmPolicy(),t(),e.addSuccess({title:I.migrateSuccessTitle})}catch(t){var i;e.addError(t,{title:I.migrateErrorTitle,toastMessage:null===(i=t.body)||void 0===i?void 0:i.message})}finally{a()&&n(!1)}}},I.buttonLabel))},S=({toasts:e})=>{const{isLoading:t,recheckStatus:i,status:n}=p();return t||!n||"ok"===n?null:Object(r.jsx)(a.a.Fragment,null,Object(r.jsx)(h.EuiSpacer,{size:"m"}),Object(r.jsx)(h.EuiFlexItem,null,Object(r.jsx)(E,{toasts:e,onMigrationDone:i})))},T={buttonLabel:j.i18n.translate("xpack.reporting.listing.reports.ilmPolicyLinkText",{defaultMessage:"Edit reporting ILM policy"})},F=({locator:e,navigateToUrl:t})=>Object(r.jsx)(h.EuiButtonEmpty,{"data-test-subj":"ilmPolicyLink",size:"xs",onClick:()=>{const i=e.getRedirectUrl({page:"policy_edit",policyName:x.k});t(i)}},T.buttonLabel);class report_delete_button_ReportDeleteButton extends s.PureComponent{constructor(e){super(e),this.state={showConfirm:!1}}hideConfirm(){this.setState({showConfirm:!1})}showConfirm(){this.setState({showConfirm:!0})}renderConfirm(){const{jobsToDelete:e}=this.props,t=e.length>1?j.i18n.translate("xpack.reporting.listing.table.deleteNumConfirmTitle",{defaultMessage:"Delete {num} reports?",values:{num:e.length}}):j.i18n.translate("xpack.reporting.listing.table.deleteConfirmTitle",{defaultMessage:'Delete the "{name}" report?',values:{name:e[0].title}}),i=j.i18n.translate("xpack.reporting.listing.table.deleteConfirmMessage",{defaultMessage:"You can't recover deleted reports."}),n=j.i18n.translate("xpack.reporting.listing.table.deleteConfirmButton",{defaultMessage:"Delete"}),s=j.i18n.translate("xpack.reporting.listing.table.deleteCancelButton",{defaultMessage:"Cancel"});return Object(r.jsx)(h.EuiConfirmModal,{title:t,onCancel:()=>this.hideConfirm(),onConfirm:()=>this.props.performDelete(),confirmButtonText:n,cancelButtonText:s,defaultFocusedButton:"confirm",buttonColor:"danger"},i)}render(){const{jobsToDelete:e}=this.props;return 0===e.length?null:Object(r.jsx)(s.Fragment,null,Object(r.jsx)(h.EuiButton,{onClick:()=>this.showConfirm(),iconType:"trash",color:"danger","data-test-subj":"deleteReportButton"},j.i18n.translate("xpack.reporting.listing.table.deleteReportButton",{defaultMessage:"Delete {num, plural, one {report} other {reports} }",values:{num:e.length}})),this.state.showConfirm?this.renderConfirm():null)}}var _;!function(e){e.chromeStatus="chromeStatus",e.screenshotStatus="screenshotStatus"}(_||(_={}));const P={[_.chromeStatus]:"incomplete",[_.screenshotStatus]:"incomplete",isFlyoutVisible:!1,help:[],logs:"",isBusy:!1,success:!0},L=({apiClient:e})=>{const[t,i]=Object(s.useState)(P),a=e=>i({...t,...e}),{isBusy:o,screenshotStatus:l,chromeStatus:c,isFlyoutVisible:u,help:p,logs:d,success:g}=t,b=(e,t)=>()=>{a({isBusy:!0,[t]:"incomplete"}),e().then((e=>{a({isBusy:!1,help:e.help,logs:e.logs,success:e.success,[t]:e.success?"complete":"danger"})})).catch((e=>{a({isBusy:!1,help:[j.i18n.translate("xpack.reporting.listing.diagnosticApiCallFailure",{defaultMessage:"There was a problem running the diagnostic: {error}",values:{error:e}})],logs:`${e.message}`,success:!1,[t]:"danger"})}))},f=[{title:j.i18n.translate("xpack.reporting.listing.diagnosticBrowserTitle",{defaultMessage:"Check browser"}),children:Object(r.jsx)(s.Fragment,null,Object(r.jsx)(n.FormattedMessage,{id:"xpack.reporting.listing.diagnosticBrowserMessage",defaultMessage:"Reporting uses a headless browser to generate PDF and PNGs. Validate that the browser can launch successfully."}),Object(r.jsx)(h.EuiSpacer,null),Object(r.jsx)(h.EuiButton,{disabled:o||"complete"===c,onClick:b((()=>e.verifyBrowser()),_.chromeStatus),isLoading:o&&"incomplete"===c,iconType:"complete"===c?"check":void 0},Object(r.jsx)(n.FormattedMessage,{id:"xpack.reporting.listing.diagnosticBrowserButton",defaultMessage:"Check browser"}))),status:g||"complete"===c?c:"danger"}];let m;return"complete"===c&&f.push({title:j.i18n.translate("xpack.reporting.listing.diagnosticScreenshotTitle",{defaultMessage:"Check screen capture"}),children:Object(r.jsx)(s.Fragment,null,Object(r.jsx)(n.FormattedMessage,{id:"xpack.reporting.listing.diagnosticScreenshotMessage",defaultMessage:"Ensure that the headless browser can capture a screenshot of a page."}),Object(r.jsx)(h.EuiSpacer,null),Object(r.jsx)(h.EuiButton,{disabled:o||"complete"===l,onClick:b((()=>e.verifyScreenCapture()),_.screenshotStatus),isLoading:o&&"incomplete"===l,iconType:"complete"===l?"check":void 0},Object(r.jsx)(n.FormattedMessage,{id:"xpack.reporting.listing.diagnosticScreenshotButton",defaultMessage:"Capture screenshot"}))),status:g||"complete"===l?l:"danger"}),"complete"===l&&f.push({title:j.i18n.translate("xpack.reporting.listing.diagnosticSuccessTitle",{defaultMessage:"All set!"}),children:Object(r.jsx)(s.Fragment,null,Object(r.jsx)(n.FormattedMessage,{id:"xpack.reporting.listing.diagnosticSuccessMessage",defaultMessage:"Everything looks good for reporting to function."})),status:g?l:"danger"}),g||f.push({title:j.i18n.translate("xpack.reporting.listing.diagnosticFailureTitle",{defaultMessage:"Something isn't working properly."}),children:Object(r.jsx)(s.Fragment,null,p.length?Object(r.jsx)(s.Fragment,null,Object(r.jsx)(h.EuiCallOut,{color:"danger",iconType:"alert"},Object(r.jsx)("p",null,Object(r.jsx)(h.EuiMarkdownFormat,null,p.join("\n"))))):null,d.length?Object(r.jsx)(s.Fragment,null,Object(r.jsx)(h.EuiSpacer,null),Object(r.jsx)(n.FormattedMessage,{id:"xpack.reporting.listing.diagnosticFailureDescription",defaultMessage:"Here are some details about the issue:"}),Object(r.jsx)(h.EuiSpacer,null),Object(r.jsx)(h.EuiCodeBlock,null,d)):null),status:"danger"}),u&&(m=Object(r.jsx)(h.EuiFlyout,{onClose:()=>a({...P,isFlyoutVisible:!1}),"aria-labelledby":"reportingHelperTitle",size:"m"},Object(r.jsx)(h.EuiFlyoutHeader,{hasBorder:!0},Object(r.jsx)(h.EuiTitle,{size:"m"},Object(r.jsx)("h2",null,Object(r.jsx)(n.FormattedMessage,{id:"xpack.reporting.listing.diagnosticTitle",defaultMessage:"Reporting Diagnostics"}))),Object(r.jsx)(h.EuiSpacer,{size:"s"}),Object(r.jsx)(h.EuiText,{color:"subdued"},Object(r.jsx)(n.FormattedMessage,{id:"xpack.reporting.listing.diagnosticDescription",defaultMessage:"Run diagnostics to automatically troubleshoot common reporting problems."}))),Object(r.jsx)(h.EuiFlyoutBody,null,Object(r.jsx)(h.EuiSteps,{steps:f})))),Object(r.jsx)("div",null,m,Object(r.jsx)(h.EuiButtonEmpty,{size:"xs",flush:"left",onClick:()=>a({isFlyoutVisible:!0})},Object(r.jsx)(n.FormattedMessage,{id:"xpack.reporting.listing.diagnosticButton",defaultMessage:"Run reporting diagnostics"})))},B=e=>{switch(e){case"search":return"discoverApp";case"dashboard":return"dashboardApp";case"visualization":return"visualizeApp";case"canvas workpad":return"canvasApp";default:return"apps"}},R={completed:j.i18n.translate("xpack.reporting.statusIndicator.completedLabel",{defaultMessage:"Done"}),completedWithWarnings:j.i18n.translate("xpack.reporting.statusIndicator.completedWithWarningsLabel",{defaultMessage:"Done, warnings detected"}),pending:j.i18n.translate("xpack.reporting.statusIndicator.pendingLabel",{defaultMessage:"Pending"}),processing:({attempt:e,of:t})=>void 0!==t?j.i18n.translate("xpack.reporting.statusIndicator.processingMaxAttemptsLabel",{defaultMessage:"Processing, attempt {attempt} of {of}",values:{attempt:e,of:t}}):j.i18n.translate("xpack.reporting.statusIndicator.processingLabel",{defaultMessage:"Processing, attempt {attempt}",values:{attempt:e}}),failed:j.i18n.translate("xpack.reporting.statusIndicator.failedLabel",{defaultMessage:"Failed"}),unknown:j.i18n.translate("xpack.reporting.statusIndicator.unknownLabel",{defaultMessage:"Unknown"}),lastStatusUpdate:({date:e})=>j.i18n.translate("xpack.reporting.statusIndicator.lastStatusUpdateLabel",{defaultMessage:"Updated at {date}",values:{date:e}})},A=({job:e})=>{const t=Object(s.useMemo)((()=>(e=>Boolean(e.getWarnings())||[x.m.WARNINGS,x.m.FAILED].some((t=>e.status===t)))(e)),[e]);let i,n;switch(e.status){case x.m.COMPLETED:if(t){i=Object(r.jsx)(h.EuiIcon,{type:"alert",color:"warning"}),n=R.completedWithWarnings;break}i=Object(r.jsx)(h.EuiIcon,{type:"checkInCircleFilled",color:"success"}),n=R.completed;break;case x.m.WARNINGS:i=Object(r.jsx)(h.EuiIcon,{type:"alert",color:"warning"}),n=R.completedWithWarnings;break;case x.m.PENDING:i=Object(r.jsx)(h.EuiLoadingSpinner,null),n=R.pending;break;case x.m.PROCESSING:i=Object(r.jsx)(h.EuiLoadingSpinner,null),n=R.processing({attempt:e.attempts,of:e.max_attempts});break;case x.m.FAILED:i=Object(r.jsx)(h.EuiIcon,{type:"crossInACircleFilled",color:"danger"}),n=R.failed;break;default:i=Object(r.jsx)(h.EuiIcon,{type:"cross",color:"subdued"}),n=R.unknown}return Object(r.jsx)(h.EuiToolTip,{content:R.lastStatusUpdate({date:e.getPrettyStatusTimestamp()})},Object(r.jsx)(h.EuiFlexGroup,{gutterSize:"s",alignItems:"center",responsive:!1,"aria-label":n},Object(r.jsx)(h.EuiFlexItem,{grow:!1},i),Object(r.jsx)(h.EuiFlexItem,{grow:!1},n)))};var D=i(11),z=i.n(D),N=i(23),J=i(24);const U=j.i18n.translate("xpack.reporting.listing.infoPanel.notApplicableLabel",{defaultMessage:"N/A"}),q=j.i18n.translate("xpack.reporting.listing.infoPanel.unknownLabel",{defaultMessage:"unknown"}),K=({info:e})=>{var t,i,n,s,o,l,c,u,p,g,b,f,m,v,O,y,k,M,w,C,I,E,S,T;const{services:{uiSettings:F,docLinks:_}}=Object(d.c)(),P="Browser"===F.get("dateFormat:tz")?z.a.tz.guess():F.get("dateFormat:tz"),L=(B=F.get("dateFormat"),R=P,e=>{const t=z.a.tz(e,R);return t.isValid()?t.format(B):U});var B,R;const A=e=>j.i18n.translate("xpack.reporting.listing.infoPanel.msToSeconds",{defaultMessage:"{seconds} seconds",values:{seconds:(e/1e3).toFixed(3)}}),D=null!=e.started_at,K=null!=e.completed_at,W=null!==(t=null===(i=e.metrics)||void 0===i||null===(n=i.pdf)||void 0===n?void 0:n.cpuInPercentage)&&void 0!==t?t:null===(s=e.metrics)||void 0===s||null===(o=s.png)||void 0===o?void 0:o.cpuInPercentage,H=null!==(l=null===(c=e.metrics)||void 0===c||null===(u=c.pdf)||void 0===u?void 0:u.memoryInMegabytes)&&void 0!==l?l:null===(p=e.metrics)||void 0===p||null===(g=p.png)||void 0===g?void 0:g.memoryInMegabytes,V=null!=(null===(b=e.metrics)||void 0===b||null===(f=b.csv)||void 0===f?void 0:f.rows),G=x.z.includes(e.jobtype),$=null!=(null===(m=e.metrics)||void 0===m||null===(v=m.pdf)||void 0===v?void 0:v.pages),Q=[{title:j.i18n.translate("xpack.reporting.listing.infoPanel.statusInfo",{defaultMessage:"Status"}),description:e.prettyStatus},Boolean(e.version)&&{title:j.i18n.translate("xpack.reporting.listing.infoPanel.kibanaVersion",{defaultMessage:"Kibana version"}),description:e.version},Boolean(e.spaceId)&&{title:j.i18n.translate("xpack.reporting.listing.infoPanel.space",{defaultMessage:"Kibana space"}),description:e.spaceId},{title:j.i18n.translate("xpack.reporting.listing.infoPanel.attemptsInfo",{defaultMessage:"Attempts"}),description:e.max_attempts?j.i18n.translate("xpack.reporting.listing.infoPanel.attempts",{defaultMessage:"{attempts} of {maxAttempts}",values:{attempts:e.attempts,maxAttempts:e.max_attempts}}):e.attempts},{title:j.i18n.translate("xpack.reporting.listing.infoPanel.contentTypeInfo",{defaultMessage:"Content type"}),description:e.content_type||U},{title:j.i18n.translate("xpack.reporting.listing.infoPanel.sizeInfo",{defaultMessage:"Size in bytes"}),description:(null===(O=e.size)||void 0===O?void 0:O.toString())||U},V&&{title:j.i18n.translate("xpack.reporting.listing.infoPanel.csvRows",{defaultMessage:"CSV rows"}),description:(null===(y=e.metrics)||void 0===y||null===(k=y.csv)||void 0===k||null===(M=k.rows)||void 0===M?void 0:M.toString())||U},G&&{title:j.i18n.translate("xpack.reporting.listing.infoPanel.dimensionsInfoHeight",{defaultMessage:"Height in pixels"}),description:null!=(null===(w=e.layout)||void 0===w||null===(C=w.dimensions)||void 0===C?void 0:C.height)?Math.ceil(e.layout.dimensions.height):q},G&&{title:j.i18n.translate("xpack.reporting.listing.infoPanel.dimensionsInfoWidth",{defaultMessage:"Width in pixels"}),description:null!=(null===(I=e.layout)||void 0===I||null===(E=I.dimensions)||void 0===E?void 0:E.width)?Math.ceil(e.layout.dimensions.width):q},$&&{title:j.i18n.translate("xpack.reporting.listing.infoPanel.pdfPagesInfo",{defaultMessage:"Pages count"}),description:null===(S=e.metrics)||void 0===S||null===(T=S.pdf)||void 0===T?void 0:T.pages},{title:j.i18n.translate("xpack.reporting.listing.infoPanel.processedByInfo",{defaultMessage:"Processed by"}),description:e.kibana_name&&e.kibana_id?`${e.kibana_name} (${e.kibana_id})`:U},{title:j.i18n.translate("xpack.reporting.listing.infoPanel.timeoutInfo",{defaultMessage:"Timeout"}),description:e.prettyTimeout},null!=W&&{title:j.i18n.translate("xpack.reporting.listing.infoPanel.cpuInfo",{defaultMessage:"CPU usage"}),description:`${W}%`},null!=H&&{title:j.i18n.translate("xpack.reporting.listing.infoPanel.memoryInfo",{defaultMessage:"RAM usage"}),description:`${H}MB`}].filter(Boolean),Y=[{title:j.i18n.translate("xpack.reporting.listing.infoPanel.tzInfo",{defaultMessage:"Time zone"}),description:e.browserTimezone||U},{title:j.i18n.translate("xpack.reporting.listing.infoPanel.createdAtInfo",{defaultMessage:"Created at"}),description:e.created_at?L(e.created_at):U},{title:j.i18n.translate("xpack.reporting.listing.infoPanel.startedAtInfo",{defaultMessage:"Started at"}),description:e.started_at?L(e.started_at):U},{title:j.i18n.translate("xpack.reporting.listing.infoPanel.completedAtInfo",{defaultMessage:"Completed at"}),description:e.completed_at?L(e.completed_at):U},D&&{title:j.i18n.translate("xpack.reporting.listing.infoPanel.queueTime",{defaultMessage:"Queue time"}),description:e.queue_time_ms?A(e.queue_time_ms):U},K&&{title:j.i18n.translate("xpack.reporting.listing.infoPanel.executionTime",{defaultMessage:"Execution time"}),description:e.execution_time_ms?A(e.execution_time_ms):U}].filter(Boolean),X=e.getWarnings(),Z=e.error_code===N.a.code?J.a.cloud.insufficientMemoryError(_.links.reporting.cloudMinimumRequirements):e.getError();return Object(r.jsx)(a.a.Fragment,null,Boolean(Z)&&Object(r.jsx)(a.a.Fragment,null,Object(r.jsx)(h.EuiCallOut,{title:j.i18n.translate("xpack.reporting.listing.infoPanel.callout.failedReportTitle",{defaultMessage:"No report generated"}),color:"danger"},Z),Object(r.jsx)(h.EuiSpacer,null)),Boolean(X)&&Object(r.jsx)(a.a.Fragment,null,Boolean(Z)&&Object(r.jsx)(h.EuiSpacer,{size:"s"}),Object(r.jsx)(h.EuiCallOut,{title:j.i18n.translate("xpack.reporting.listing.infoPanel.callout.warningsTitle",{defaultMessage:"Report contains warnings"}),color:"warning"},X)),Object(r.jsx)(h.EuiTitle,{size:"s"},Object(r.jsx)("h3",null,j.i18n.translate("xpack.reporting.listing.infoPanel.outputSectionTitle",{defaultMessage:"Output"}))),Object(r.jsx)(h.EuiSpacer,{size:"s"}),Object(r.jsx)(h.EuiDescriptionList,{listItems:Q,type:"column",align:"center",compressed:!0}),Object(r.jsx)(h.EuiSpacer,null),Object(r.jsx)(h.EuiTitle,{size:"s"},Object(r.jsx)("h3",null,j.i18n.translate("xpack.reporting.listing.infoPanel.timestampSectionTitle",{defaultMessage:"Timestamps"}))),Object(r.jsx)(h.EuiSpacer,{size:"s"}),Object(r.jsx)(h.EuiDescriptionList,{listItems:Y,type:"column",align:"center",compressed:!0}))},W=({onClose:e,job:t})=>{var i;const[n,a]=Object(s.useState)(!0),[o,c]=Object(s.useState)(),[u,p]=Object(s.useState)(!1),[d,g]=Object(s.useState)(),b=C()(),{apiClient:f}=Object(l.d)();Object(s.useEffect)((()=>{!async function(){if(n)try{const e=await f.getInfo(t.id);b()&&g(e)}catch(e){b()&&c(e)}finally{b()&&a(!1)}}()}),[n,f,t.id,b]);const m=Object(r.jsx)(h.EuiButton,{"data-test-subj":"reportInfoFlyoutActionsButton",iconType:"arrowUp",onClick:()=>p((e=>!e))},j.i18n.translate("xpack.reporting.reportInfoFlyout.actionsButtonLabel",{defaultMessage:"Actions"})),x=[Object(r.jsx)(h.EuiContextMenuItem,{"data-test-subj":"reportInfoFlyoutDownloadButton",key:"download",icon:"download",disabled:!t.isDownloadReady,onClick:()=>{f.downloadReport(t.id)}},j.i18n.translate("xpack.reporting.reportInfoFlyout.downloadButtonLabel",{defaultMessage:"Download"})),Object(r.jsx)(h.EuiContextMenuItem,{"data-test-subj":"reportInfoFlyoutOpenInKibanaButton",disabled:!t.canLinkToKibanaApp,key:"openInKibanaApp",icon:"popout",onClick:()=>{window.open(f.getKibanaAppHref(t),"_blank"),window.focus()}},j.i18n.translate("xpack.reporting.reportInfoFlyout.openInKibanaAppButtonLabel",{defaultMessage:"Open in Kibana"}))];return Object(r.jsx)(h.EuiPortal,null,Object(r.jsx)(h.EuiFlyout,{ownFocus:!0,onClose:e,size:"s","aria-labelledby":"flyoutTitle","data-test-subj":"reportInfoFlyout"},Object(r.jsx)(h.EuiFlyoutHeader,{hasBorder:!0},Object(r.jsx)(h.EuiTitle,{size:"m"},Object(r.jsx)("h2",{id:"flyoutTitle"},o?j.i18n.translate("xpack.reporting.listing.table.reportInfoUnableToFetch",{defaultMessage:"Unable to fetch report info."}):null!==(i=null==d?void 0:d.title)&&void 0!==i?i:j.i18n.translate("xpack.reporting.listing.table.untitledReport",{defaultMessage:"Untitled report"})))),Object(r.jsx)(h.EuiFlyoutBody,null,n?Object(r.jsx)(h.EuiLoadingSpinner,null):o?void 0:d?Object(r.jsx)(K,{info:d}):void 0),!n&&Object(r.jsx)(h.EuiFlyoutFooter,null,Object(r.jsx)(h.EuiFlexGroup,{gutterSize:"none",justifyContent:"spaceBetween"},Object(r.jsx)(h.EuiFlexItem,{grow:!1},Object(r.jsx)(h.EuiButtonEmpty,{iconType:"cross",flush:"left",onClick:e},j.i18n.translate("xpack.reporting.listing.flyout.closeButtonLabel",{defaultMessage:"Close"}))),Object(r.jsx)(h.EuiFlexItem,{grow:!1},Object(r.jsx)(h.EuiPopover,{id:"reportInfoFlyoutActionsPopover",button:m,isOpen:u,closePopover:()=>p(!1),panelPaddingSize:"none"},Object(r.jsx)(h.EuiContextMenuPanel,{items:x})))))))};i(38);class report_listing_ReportListingUi extends s.Component{constructor(e){super(e),m()(this,"isInitialJobsFetch",void 0),m()(this,"licenseSubscription",void 0),m()(this,"mounted",void 0),m()(this,"poller",void 0),m()(this,"licenseHandler",(e=>{const{enableLinks:t,showLinks:i,message:n}=Object(M.a)(e.check("reporting","basic"));this.setState({enableLinks:t,showLinks:i,badLicenseMessage:n})})),m()(this,"onSelectionChange",(e=>{this.setState((t=>({...t,selectedJobs:e})))})),m()(this,"removeJob",(e=>{const{jobs:t}=this.state,i=t.filter((t=>t.id!==e.id));this.setState((e=>({...e,jobs:i})))})),m()(this,"renderDeleteButton",(()=>{const{selectedJobs:e}=this.state;if(0!==e.length)return Object(r.jsx)(report_delete_button_ReportDeleteButton,b()({jobsToDelete:e,performDelete:async()=>{for(const t of e)try{await this.props.apiClient.deleteReport(t.id),this.removeJob(t),this.props.toasts.addSuccess(j.i18n.translate("xpack.reporting.listing.table.deleteConfim",{defaultMessage:"The {reportTitle} report was deleted",values:{reportTitle:t.title}}))}catch(e){throw this.props.toasts.addDanger(j.i18n.translate("xpack.reporting.listing.table.deleteFailedErrorMessage",{defaultMessage:"The report was not deleted: {error}",values:{error:e}})),e}this.setState((()=>({page:0})),this.fetchJobs)}},this.props))})),m()(this,"onTableChange",(({page:e})=>{const{index:t}=e;this.setState((()=>({page:t})),this.fetchJobs)})),m()(this,"fetchJobs",(async()=>{let e,t;this.isInitialJobsFetch&&this.setState((()=>({isLoading:!0})));try{e=await this.props.apiClient.list(this.state.page),t=await this.props.apiClient.total(),this.isInitialJobsFetch=!1}catch(e){return this.licenseAllowsToShowThisPage()?("Failed to fetch"===e.message&&this.props.toasts.addDanger(e.message||j.i18n.translate("xpack.reporting.listing.table.requestFailedErrorMessage",{defaultMessage:"Request failed"})),void(this.mounted&&this.setState((()=>({isLoading:!1,jobs:[],total:0}))))):(this.props.toasts.addDanger(this.state.badLicenseMessage),void this.props.redirect("management"))}this.mounted&&this.setState((()=>({isLoading:!1,total:t,jobs:e})))})),m()(this,"licenseAllowsToShowThisPage",(()=>this.state.showLinks&&this.state.enableLinks)),m()(this,"tableColumnWidths",{type:"5%",title:"30%",status:"20%",createdAt:"25%",content:"10%",actions:"10%"}),this.state={page:0,total:0,jobs:[],selectedJobs:[],isLoading:!1,showLinks:!1,enableLinks:!1,badLicenseMessage:"",selectedJob:void 0},this.isInitialJobsFetch=!0}render(){var e,t;const{ilmPolicyContextValue:i,urlService:s,navigateToUrl:o,capabilities:l}=this.props,c=s.locators.get("ILM_LOCATOR_ID"),u="policy-not-found"!==i.status,p=Boolean(c&&u);return Object(r.jsx)(a.a.Fragment,null,Object(r.jsx)(h.EuiPageHeader,{"data-test-subj":"reportingPageHeader",bottomBorder:!0,pageTitle:Object(r.jsx)(n.FormattedMessage,{id:"xpack.reporting.listing.reportstitle",defaultMessage:"Reports"}),description:Object(r.jsx)(n.FormattedMessage,{id:"xpack.reporting.listing.reports.subtitle",defaultMessage:"Get reports generated in Kibana applications."})}),Object(r.jsx)(S,{toasts:this.props.toasts}),Object(r.jsx)(h.EuiSpacer,{size:"l"}),Object(r.jsx)("div",null,this.renderTable()),Object(r.jsx)(h.EuiSpacer,{size:"s"}),Object(r.jsx)(h.EuiFlexGroup,{justifyContent:"flexEnd"},(null==l||null===(e=l.management)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.index_lifecycle_management)&&Object(r.jsx)(h.EuiFlexItem,{grow:!1},i.isLoading?Object(r.jsx)(h.EuiLoadingSpinner,null):p&&Object(r.jsx)(F,{navigateToUrl:o,locator:c})),Object(r.jsx)(h.EuiFlexItem,{grow:!1},Object(r.jsx)(L,{apiClient:this.props.apiClient}))))}componentWillUnmount(){var e;this.mounted=!1,null===(e=this.poller)||void 0===e||e.stop(),this.licenseSubscription&&this.licenseSubscription.unsubscribe()}componentDidMount(){this.mounted=!0;const{pollConfig:e,license$:t}=this.props,i=Object(k.a)(e.jobsRefresh.interval);this.poller=new poller_Poller({functionToPoll:()=>this.fetchJobs(),pollFrequencyInMillis:i,trailing:!1,continuePollingOnError:!0,pollFrequencyErrorMultiplier:e.jobsRefresh.intervalErrorMultiplier}),this.poller.start(),this.licenseSubscription=t.subscribe(this.licenseHandler)}renderTable(){const{tableColumnWidths:e}=this,t=[{field:"type",width:e.type,name:j.i18n.translate("xpack.reporting.listing.tableColumns.typeTitle",{defaultMessage:"Type"}),render:(e,t)=>Object(r.jsx)("div",{className:"kbnReporting__reportListing__typeIcon"},Object(r.jsx)(h.EuiIconTip,{type:B(t.objectType),size:"s","data-test-subj":"reportJobType",content:t.objectType})),mobileOptions:{show:!0,render:e=>Object(r.jsx)("div",{"data-test-subj":"reportJobType"},e.objectType)}},{field:"title",name:j.i18n.translate("xpack.reporting.listing.tableColumns.reportTitle",{defaultMessage:"Title"}),width:e.title,render:(e,t)=>Object(r.jsx)("div",{"data-test-subj":"reportingListItemObjectTitle"},Object(r.jsx)(h.EuiLink,{"data-test-subj":`viewReportingLink${t.id}`,onClick:()=>this.setState({selectedJob:t})},e||j.i18n.translate("xpack.reporting.listing.table.noTitleLabel",{defaultMessage:"Untitled"}))),mobileOptions:{header:!1,width:"100%"}},{field:"status",width:e.status,name:j.i18n.translate("xpack.reporting.listing.tableColumns.statusTitle",{defaultMessage:"Status"}),render:(e,t)=>Object(r.jsx)(h.EuiFlexGroup,{gutterSize:"none",responsive:!1,alignItems:"center","data-test-subj":"reportJobStatus"},Object(r.jsx)(A,{job:t})),mobileOptions:{show:!1}},{field:"created_at",width:e.createdAt,name:j.i18n.translate("xpack.reporting.listing.tableColumns.createdAtTitle",{defaultMessage:"Created at"}),render:(e,t)=>Object(r.jsx)("div",{"data-test-subj":"reportJobCreatedAt"},t.getCreatedAtDate()),mobileOptions:{show:!1}},{field:"content",width:e.content,name:j.i18n.translate("xpack.reporting.listing.tableColumns.content",{defaultMessage:"Content"}),render:(e,t)=>Object(v.b)(t.jobtype),mobileOptions:{show:!1}},{name:j.i18n.translate("xpack.reporting.listing.tableColumns.actionsTitle",{defaultMessage:"Actions"}),width:e.actions,actions:[{isPrimary:!0,"data-test-subj":"reportDownloadLink",type:"icon",icon:"download",name:j.i18n.translate("xpack.reporting.listing.table.downloadReportButtonLabel",{defaultMessage:"Download report"}),description:j.i18n.translate("xpack.reporting.listing.table.downloadReportDescription",{defaultMessage:"Download this report in a new tab."}),onClick:e=>this.props.apiClient.downloadReport(e.id),enabled:e=>e.isDownloadReady},{name:j.i18n.translate("xpack.reporting.listing.table.viewReportingInfoActionButtonLabel",{defaultMessage:"View report info"}),description:j.i18n.translate("xpack.reporting.listing.table.viewReportingInfoActionButtonDescription",{defaultMessage:"View additional information about this report."}),type:"icon",icon:"iInCircle",onClick:e=>this.setState({selectedJob:e})},{name:j.i18n.translate("xpack.reporting.listing.table.openInKibanaAppLabel",{defaultMessage:"Open in Kibana"}),"data-test-subj":"reportOpenInKibanaApp",description:j.i18n.translate("xpack.reporting.listing.table.openInKibanaAppDescription",{defaultMessage:"Open the Kibana app where this report was generated."}),available:e=>e.canLinkToKibanaApp,type:"icon",icon:"popout",onClick:e=>{const t=this.props.apiClient.getKibanaAppHref(e);window.open(t,"_blank"),window.focus()}}]}],i={pageIndex:this.state.page,pageSize:10,totalItemCount:this.state.total,showPerPageOptions:!1},n={itemId:"id",onSelectionChange:this.onSelectionChange};return Object(r.jsx)(s.Fragment,null,this.state.selectedJobs.length>0&&Object(r.jsx)(s.Fragment,null,Object(r.jsx)(h.EuiFlexGroup,{alignItems:"center",justifyContent:"flexStart",gutterSize:"m"},Object(r.jsx)(h.EuiFlexItem,{grow:!1},this.renderDeleteButton())),Object(r.jsx)(h.EuiSpacer,{size:"l"})),Object(r.jsx)(h.EuiBasicTable,{tableCaption:j.i18n.translate("xpack.reporting.listing.table.captionDescription",{defaultMessage:"Reports generated in Kibana applications"}),itemId:"id",items:this.state.jobs,loading:this.state.isLoading,columns:t,noItemsMessage:this.state.isLoading?j.i18n.translate("xpack.reporting.listing.table.loadingReportsDescription",{defaultMessage:"Loading reports"}):j.i18n.translate("xpack.reporting.listing.table.noCreatedReportsDescription",{defaultMessage:"No reports have been created"}),pagination:i,selection:n,isSelectable:!0,onChange:this.onTableChange,"data-test-subj":x.x,rowProps:()=>({"data-test-subj":x.y})}),!!this.state.selectedJob&&Object(r.jsx)(W,{onClose:()=>this.setState({selectedJob:void 0}),job:this.state.selectedJob}))}}const H=e=>{const t=p(),{apiClient:i}=Object(l.d)(),{services:{application:{capabilities:n}}}=Object(d.c)();return Object(r.jsx)(report_listing_ReportListingUi,b()({},e,{apiClient:i,capabilities:n,ilmPolicyContextValue:t}))};async function V(e,t,i,s,a,c,p){return Object(o.render)(Object(r.jsx)(n.I18nProvider,null,Object(r.jsx)(d.b,{services:{http:e.http,application:t.application,uiSettings:t.uiSettings,docLinks:t.docLinks}},Object(r.jsx)(l.a,{apiClient:a},Object(r.jsx)(u,null,Object(r.jsx)(H,{toasts:e.notifications.toasts,license$:i,pollConfig:s,redirect:t.application.navigateToApp,navigateToUrl:t.application.navigateToUrl,urlService:c}))))),p.element),()=>{Object(o.unmountComponentAtNode)(p.element)}}}}]);