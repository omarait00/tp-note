/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.cloudSecurityPosture_bundle_jsonpfunction=window.cloudSecurityPosture_bundle_jsonpfunction||[]).push([[3],{36:function(e,t,s){"use strict";s.d(t,"c",(function(){return l})),s.d(t,"a",(function(){return c})),s.d(t,"b",(function(){return r}));var a=s(4),n=s(24),i=s(5);const l={passed:n.euiThemeVars.euiColorVis0,failed:n.euiThemeVars.euiColorVis9},c="MMMM D, YYYY @ HH:mm:ss.SSS",r={kspm:{policyTemplate:"kspm",name:a.i18n.translate("xpack.csp.kspmIntegration.integration.nameTitle",{defaultMessage:"Kubernetes Security Posture Management"}),shortName:a.i18n.translate("xpack.csp.kspmIntegration.integration.shortNameTitle",{defaultMessage:"KSPM"}),options:[{type:i.c,name:a.i18n.translate("xpack.csp.kspmIntegration.vanillaOption.nameTitle",{defaultMessage:"Unmanaged Kubernetes"}),benchmark:a.i18n.translate("xpack.csp.kspmIntegration.vanillaOption.benchmarkTitle",{defaultMessage:"CIS Kubernetes"})},{type:i.b,name:a.i18n.translate("xpack.csp.kspmIntegration.eksOption.nameTitle",{defaultMessage:"EKS (Elastic Kubernetes Service)"}),benchmark:a.i18n.translate("xpack.csp.kspmIntegration.eksOption.benchmarkTitle",{defaultMessage:"CIS EKS"})}]}}},37:function(e,t,s){"use strict";s.d(t,"d",(function(){return n})),s.d(t,"a",(function(){return i})),s.d(t,"b",(function(){return l})),s.d(t,"c",(function(){return c}));var a=s(5);const n=e=>e.type===a.b,i=e=>{var t;return(null===(t=e.find((e=>e.enabled)))||void 0===t?void 0:t.type)||a.c},l=(e,t)=>({isValid:!0,updatedPolicy:{...e,inputs:e.inputs.map((e=>({...e,enabled:e.type===t,streams:e.streams.map((s=>({...s,enabled:e.type===t})))})))}}),c=(e,t,s)=>({isValid:!0,updatedPolicy:{...e,inputs:e.inputs.map((e=>n(e)?r(e,t,s):e))}}),r=(e,t,s)=>{var a,n,i;return e.streams[0]?{...e,streams:[{...e.streams[0],vars:{...null===(a=e.streams[0])||void 0===a?void 0:a.vars,[t]:{...null===(n=e.streams[0])||void 0===n||null===(i=n.vars)||void 0===i?void 0:i[t],value:s}}}]}:e}},39:function(e,t,s){"use strict";s.d(t,"a",(function(){return o})),s(1);var a=s(3),n=s(20),i=s(36),l=s(0);const c=i.b.kspm.options.map((e=>({value:e.type,label:e.name}))),r=()=>Object(l.jsx)(a.EuiToolTip,{content:Object(l.jsx)(n.FormattedMessage,{id:"xpack.csp.createPackagePolicy.stepConfigure.integrationSettingsSection.kubernetesDeploymentLabelTooltip",defaultMessage:"Select your Kubernetes deployment type"})},Object(l.jsx)(a.EuiFlexGroup,{gutterSize:"none",alignItems:"center",responsive:!1},Object(l.jsx)(a.EuiFlexItem,{grow:!0,style:{flexDirection:"row"}},Object(l.jsx)(n.FormattedMessage,{id:"xpack.csp.createPackagePolicy.stepConfigure.integrationSettingsSection.kubernetesDeploymentLabel",defaultMessage:"Kubernetes Deployment"}),"Â ",Object(l.jsx)(a.EuiIcon,{size:"m",color:"subdued",type:"questionInCircle"})))),o=({type:e,isDisabled:t,onChange:s})=>Object(l.jsx)(a.EuiDescribedFormGroup,{title:Object(l.jsx)("div",null)},Object(l.jsx)(a.EuiFormRow,{label:Object(l.jsx)(r,null)},Object(l.jsx)(a.EuiComboBox,{singleSelection:{asPlainText:!0},options:c,selectedOptions:c.filter((t=>t.value===e)),isDisabled:t,onChange:e=>!t&&(null==s?void 0:s(e[0].value))})))},40:function(e,t,s){"use strict";s.d(t,"a",(function(){return d}));var a=s(1),n=s.n(a),i=s(3),l=s(20),c=s(4),r=s(37),o=s(0);const u=[{id:"access_key_id",label:c.i18n.translate("xpack.csp.createPackagePolicy.eksIntegrationSettingsSection.accessKeyIdFieldLabel",{defaultMessage:"Access key ID"})},{id:"secret_access_key",label:c.i18n.translate("xpack.csp.createPackagePolicy.eksIntegrationSettingsSection.secretAccessKeyFieldLabel",{defaultMessage:"Secret Access Key"})},{id:"session_token",label:c.i18n.translate("xpack.csp.createPackagePolicy.eksIntegrationSettingsSection.sessionTokenFieldLabel",{defaultMessage:"Session Token"})},{id:"shared_credential_file",label:c.i18n.translate("xpack.csp.createPackagePolicy.eksIntegrationSettingsSection.sharedCredentialsFileFieldLabel",{defaultMessage:"Shared Credential File"})},{id:"credential_profile_name",label:c.i18n.translate("xpack.csp.createPackagePolicy.eksIntegrationSettingsSection.sharedCredentialFileFieldLabel",{defaultMessage:"Credential Profile Name"})},{id:"role_arn",label:c.i18n.translate("xpack.csp.createPackagePolicy.eksIntegrationSettingsSection.roleARNFieldLabel",{defaultMessage:"ARN Role"})}],d=({onChange:e,inputs:t})=>Object(o.jsx)(n.a.Fragment,null,Object(o.jsx)(i.EuiSpacer,{size:"m"}),Object(o.jsx)(p,{inputs:t,onChange:e})),p=({onChange:e,inputs:t})=>{const s=(e=>{var t,s;const a=null==e||null===(t=e.streams)||void 0===t||null===(s=t[0])||void 0===s?void 0:s.vars;return{access_key_id:(null==a?void 0:a.access_key_id.value)||"",secret_access_key:(null==a?void 0:a.secret_access_key.value)||"",session_token:(null==a?void 0:a.session_token.value)||"",shared_credential_file:(null==a?void 0:a.shared_credential_file.value)||"",credential_profile_name:(null==a?void 0:a.credential_profile_name.value)||"",role_arn:(null==a?void 0:a.role_arn.value)||""}})(t.find(r.d)),a=Object(o.jsx)("h4",null,Object(o.jsx)(l.FormattedMessage,{id:"xpack.csp.createPackagePolicy.eksIntegrationSettingsSection.awsCredentialsTitle",defaultMessage:"AWS Credentials"})),c=Object(o.jsx)(n.a.Fragment,null,Object(o.jsx)(l.FormattedMessage,{id:"xpack.csp.createPackagePolicy.eksIntegrationSettingsSection.awsCredentialsDescription",defaultMessage:"The integration needs elevated access to run some CIS benchmark rules. You can follow {link} to generate the necessary credentials.",values:{link:Object(o.jsx)(i.EuiLink,{href:"https://ela.st/getting-started-with-kspm",target:"_blank"},Object(o.jsx)(l.FormattedMessage,{id:"xpack.csp.createPackagePolicy.eksIntegrationSettingsSection.awsCredentialsInstructionsLink",defaultMessage:"these instructions"}))}}),Object(o.jsx)(i.EuiSpacer,{size:"s"}),Object(o.jsx)(l.FormattedMessage,{id:"xpack.csp.createPackagePolicy.eksIntegrationSettingsSection.awsCredentialsNote",defaultMessage:"If you choose not to provide credentials, only a subset of the benchmark rules will be evaluated against your cluster(s)."}));return Object(o.jsx)(i.EuiDescribedFormGroup,{title:a,description:c},u.map((t=>Object(o.jsx)(i.EuiFormRow,{key:t.id,label:t.label,labelAppend:Object(o.jsx)(i.EuiText,{size:"xs",color:"subdued"},Object(o.jsx)(l.FormattedMessage,{id:"xpack.csp.createPackagePolicy.eksIntegrationSettingsSection.optionalField",defaultMessage:"Optional"}))},Object(o.jsx)(i.EuiFieldText,{value:s[t.id],onChange:s=>e(t.id,s.target.value)})))))}},52:function(e,t,s){"use strict";s.r(t),s.d(t,"CspEditPolicyExtension",(function(){return u})),s.d(t,"default",(function(){return u}));var a=s(1),n=s(3),i=s(5),l=s(39),c=s(40),r=s(37),o=s(0);const u=Object(a.memo)((({newPolicy:e,onChange:t})=>{const s=Object(r.a)(e.inputs);return Object(o.jsx)(n.EuiForm,null,Object(o.jsx)(l.a,{type:s,isDisabled:!0}),s===i.b&&Object(o.jsx)(c.a,{inputs:e.inputs,onChange:(s,a)=>t(Object(r.c)(e,s,a))}))}));u.displayName="CspEditPolicyExtension"}}]);