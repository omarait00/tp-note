/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.cloudSecurityPosture_bundle_jsonpfunction=window.cloudSecurityPosture_bundle_jsonpfunction||[]).push([[2],{36:function(e,t,a){"use strict";a.d(t,"c",(function(){return l})),a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return r}));var s=a(4),n=a(24),i=a(5);const l={passed:n.euiThemeVars.euiColorVis0,failed:n.euiThemeVars.euiColorVis9},c="MMMM D, YYYY @ HH:mm:ss.SSS",r={kspm:{policyTemplate:"kspm",name:s.i18n.translate("xpack.csp.kspmIntegration.integration.nameTitle",{defaultMessage:"Kubernetes Security Posture Management"}),shortName:s.i18n.translate("xpack.csp.kspmIntegration.integration.shortNameTitle",{defaultMessage:"KSPM"}),options:[{type:i.c,name:s.i18n.translate("xpack.csp.kspmIntegration.vanillaOption.nameTitle",{defaultMessage:"Unmanaged Kubernetes"}),benchmark:s.i18n.translate("xpack.csp.kspmIntegration.vanillaOption.benchmarkTitle",{defaultMessage:"CIS Kubernetes"})},{type:i.b,name:s.i18n.translate("xpack.csp.kspmIntegration.eksOption.nameTitle",{defaultMessage:"EKS (Elastic Kubernetes Service)"}),benchmark:s.i18n.translate("xpack.csp.kspmIntegration.eksOption.benchmarkTitle",{defaultMessage:"CIS EKS"})}]}}},37:function(e,t,a){"use strict";a.d(t,"d",(function(){return n})),a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return l})),a.d(t,"c",(function(){return c}));var s=a(5);const n=e=>e.type===s.b,i=e=>{var t;return(null===(t=e.find((e=>e.enabled)))||void 0===t?void 0:t.type)||s.c},l=(e,t)=>({isValid:!0,updatedPolicy:{...e,inputs:e.inputs.map((e=>({...e,enabled:e.type===t,streams:e.streams.map((a=>({...a,enabled:e.type===t})))})))}}),c=(e,t,a)=>({isValid:!0,updatedPolicy:{...e,inputs:e.inputs.map((e=>n(e)?r(e,t,a):e))}}),r=(e,t,a)=>{var s,n,i;return e.streams[0]?{...e,streams:[{...e.streams[0],vars:{...null===(s=e.streams[0])||void 0===s?void 0:s.vars,[t]:{...null===(n=e.streams[0])||void 0===n||null===(i=n.vars)||void 0===i?void 0:i[t],value:a}}}]}:e}},39:function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a(1);var s=a(3),n=a(20),i=a(36),l=a(0);const c=i.b.kspm.options.map((e=>({value:e.type,label:e.name}))),r=()=>Object(l.jsx)(s.EuiToolTip,{content:Object(l.jsx)(n.FormattedMessage,{id:"xpack.csp.createPackagePolicy.stepConfigure.integrationSettingsSection.kubernetesDeploymentLabelTooltip",defaultMessage:"Select your Kubernetes deployment type"})},Object(l.jsx)(s.EuiFlexGroup,{gutterSize:"none",alignItems:"center",responsive:!1},Object(l.jsx)(s.EuiFlexItem,{grow:!0,style:{flexDirection:"row"}},Object(l.jsx)(n.FormattedMessage,{id:"xpack.csp.createPackagePolicy.stepConfigure.integrationSettingsSection.kubernetesDeploymentLabel",defaultMessage:"Kubernetes Deployment"}),"Â ",Object(l.jsx)(s.EuiIcon,{size:"m",color:"subdued",type:"questionInCircle"})))),o=({type:e,isDisabled:t,onChange:a})=>Object(l.jsx)(s.EuiDescribedFormGroup,{title:Object(l.jsx)("div",null)},Object(l.jsx)(s.EuiFormRow,{label:Object(l.jsx)(r,null)},Object(l.jsx)(s.EuiComboBox,{singleSelection:{asPlainText:!0},options:c,selectedOptions:c.filter((t=>t.value===e)),isDisabled:t,onChange:e=>!t&&(null==a?void 0:a(e[0].value))})))},40:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var s=a(1),n=a.n(s),i=a(3),l=a(20),c=a(4),r=a(37),o=a(0);const u=[{id:"access_key_id",label:c.i18n.translate("xpack.csp.createPackagePolicy.eksIntegrationSettingsSection.accessKeyIdFieldLabel",{defaultMessage:"Access key ID"})},{id:"secret_access_key",label:c.i18n.translate("xpack.csp.createPackagePolicy.eksIntegrationSettingsSection.secretAccessKeyFieldLabel",{defaultMessage:"Secret Access Key"})},{id:"session_token",label:c.i18n.translate("xpack.csp.createPackagePolicy.eksIntegrationSettingsSection.sessionTokenFieldLabel",{defaultMessage:"Session Token"})},{id:"shared_credential_file",label:c.i18n.translate("xpack.csp.createPackagePolicy.eksIntegrationSettingsSection.sharedCredentialsFileFieldLabel",{defaultMessage:"Shared Credential File"})},{id:"credential_profile_name",label:c.i18n.translate("xpack.csp.createPackagePolicy.eksIntegrationSettingsSection.sharedCredentialFileFieldLabel",{defaultMessage:"Credential Profile Name"})},{id:"role_arn",label:c.i18n.translate("xpack.csp.createPackagePolicy.eksIntegrationSettingsSection.roleARNFieldLabel",{defaultMessage:"ARN Role"})}],d=({onChange:e,inputs:t})=>Object(o.jsx)(n.a.Fragment,null,Object(o.jsx)(i.EuiSpacer,{size:"m"}),Object(o.jsx)(p,{inputs:t,onChange:e})),p=({onChange:e,inputs:t})=>{const a=(e=>{var t,a;const s=null==e||null===(t=e.streams)||void 0===t||null===(a=t[0])||void 0===a?void 0:a.vars;return{access_key_id:(null==s?void 0:s.access_key_id.value)||"",secret_access_key:(null==s?void 0:s.secret_access_key.value)||"",session_token:(null==s?void 0:s.session_token.value)||"",shared_credential_file:(null==s?void 0:s.shared_credential_file.value)||"",credential_profile_name:(null==s?void 0:s.credential_profile_name.value)||"",role_arn:(null==s?void 0:s.role_arn.value)||""}})(t.find(r.d)),s=Object(o.jsx)("h4",null,Object(o.jsx)(l.FormattedMessage,{id:"xpack.csp.createPackagePolicy.eksIntegrationSettingsSection.awsCredentialsTitle",defaultMessage:"AWS Credentials"})),c=Object(o.jsx)(n.a.Fragment,null,Object(o.jsx)(l.FormattedMessage,{id:"xpack.csp.createPackagePolicy.eksIntegrationSettingsSection.awsCredentialsDescription",defaultMessage:"The integration needs elevated access to run some CIS benchmark rules. You can follow {link} to generate the necessary credentials.",values:{link:Object(o.jsx)(i.EuiLink,{href:"https://ela.st/getting-started-with-kspm",target:"_blank"},Object(o.jsx)(l.FormattedMessage,{id:"xpack.csp.createPackagePolicy.eksIntegrationSettingsSection.awsCredentialsInstructionsLink",defaultMessage:"these instructions"}))}}),Object(o.jsx)(i.EuiSpacer,{size:"s"}),Object(o.jsx)(l.FormattedMessage,{id:"xpack.csp.createPackagePolicy.eksIntegrationSettingsSection.awsCredentialsNote",defaultMessage:"If you choose not to provide credentials, only a subset of the benchmark rules will be evaluated against your cluster(s)."}));return Object(o.jsx)(i.EuiDescribedFormGroup,{title:s,description:c},u.map((t=>Object(o.jsx)(i.EuiFormRow,{key:t.id,label:t.label,labelAppend:Object(o.jsx)(i.EuiText,{size:"xs",color:"subdued"},Object(o.jsx)(l.FormattedMessage,{id:"xpack.csp.createPackagePolicy.eksIntegrationSettingsSection.optionalField",defaultMessage:"Optional"}))},Object(o.jsx)(i.EuiFieldText,{value:a[t.id],onChange:a=>e(t.id,a.target.value)})))))}},53:function(e,t,a){"use strict";a.r(t),a.d(t,"CspCreatePolicyExtension",(function(){return u})),a.d(t,"default",(function(){return u}));var s=a(1),n=a(3),i=a(5),l=a(39),c=a(40),r=a(37),o=a(0);const u=Object(s.memo)((({newPolicy:e,onChange:t})=>{const a=Object(r.a)(e.inputs);return Object(o.jsx)(n.EuiForm,null,Object(o.jsx)(l.a,{type:a,onChange:a=>t(Object(r.b)(e,a))}),a===i.b&&Object(o.jsx)(c.a,{inputs:e.inputs,onChange:(a,s)=>t(Object(r.c)(e,a,s))}))}));u.displayName="CspCreatePolicyExtension"}}]);