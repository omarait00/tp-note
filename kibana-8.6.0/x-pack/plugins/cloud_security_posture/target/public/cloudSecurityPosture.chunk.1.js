/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.cloudSecurityPosture_bundle_jsonpfunction=window.cloudSecurityPosture_bundle_jsonpfunction||[]).push([[1],{35:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(9);const r=()=>Object(i.useKibana)()},36:function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c}));var i=n(4),r=n(24),a=n(5);const s={passed:r.euiThemeVars.euiColorVis0,failed:r.euiThemeVars.euiColorVis9},o="MMMM D, YYYY @ HH:mm:ss.SSS",c={kspm:{policyTemplate:"kspm",name:i.i18n.translate("xpack.csp.kspmIntegration.integration.nameTitle",{defaultMessage:"Kubernetes Security Posture Management"}),shortName:i.i18n.translate("xpack.csp.kspmIntegration.integration.shortNameTitle",{defaultMessage:"KSPM"}),options:[{type:a.c,name:i.i18n.translate("xpack.csp.kspmIntegration.vanillaOption.nameTitle",{defaultMessage:"Unmanaged Kubernetes"}),benchmark:i.i18n.translate("xpack.csp.kspmIntegration.vanillaOption.benchmarkTitle",{defaultMessage:"CIS Kubernetes"})},{type:a.b,name:i.i18n.translate("xpack.csp.kspmIntegration.eksOption.nameTitle",{defaultMessage:"EKS (Elastic Kubernetes Service)"}),benchmark:i.i18n.translate("xpack.csp.kspmIntegration.eksOption.benchmarkTitle",{defaultMessage:"CIS EKS"})}]}}},38:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),r=n(49),a=function(){};t.default=function(e,t,n){if(!r.isClient)return[t,a,a];if(!e)throw new Error("useLocalStorage key may not be falsy");var s=n?n.raw?function(e){return e}:n.deserializer:JSON.parse,o=i.useState((function(){try{var i=n?n.raw?String:n.serializer:JSON.stringify,r=localStorage.getItem(e);return null!==r?s(r):(t&&localStorage.setItem(e,i(t)),t)}catch(e){return t}})),c=o[0],u=o[1],l=i.useCallback((function(t){try{var i="function"==typeof t?t(c):t;if(void 0===i)return;var r;r=n?n.raw?"string"==typeof i?i:JSON.stringify(i):n.serializer?n.serializer(i):JSON.stringify(i):JSON.stringify(i),localStorage.setItem(e,r),u(s(r))}catch(e){}}),[e,u]),d=i.useCallback((function(){try{localStorage.removeItem(e),u(void 0)}catch(e){}}),[e,u]);return[c,l,d]}},41:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},i(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),a=this&&this.__assign||function(){return a=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},a.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s=n(43),o=s.either.map,c=s.either.chain,u=function(){function e(e,t,n,i){this.name=e,this.is=t,this.validate=n,this.encode=i,this.decode=this.decode.bind(this)}return e.prototype.pipe=function(n,i){var r=this;return void 0===i&&(i="pipe("+this.name+", "+n.name+")"),new e(i,n.is,(function(e,t){return c(r.validate(e,t),(function(e){return n.validate(e,t)}))}),this.encode===t.identity&&n.encode===t.identity?t.identity:function(e){return r.encode(n.encode(e))})},e.prototype.asDecoder=function(){return this},e.prototype.asEncoder=function(){return this},e.prototype.decode=function(e){return this.validate(e,[{key:"",type:this,actual:e}])},e}();t.Type=u,t.identity=function(e){return e},t.getFunctionName=function(e){return e.displayName||e.name||"<function"+e.length+">"},t.getContextEntry=function(e,t){return{key:e,type:t}},t.appendContext=function(e,t,n,i){for(var r=e.length,a=Array(r+1),s=0;s<r;s++)a[s]=e[s];return a[r]={key:t,type:n,actual:i},a},t.failures=s.left,t.failure=function(e,n,i){return t.failures([{value:e,context:n,message:i}])},t.success=s.right;var l=function(e,t){for(var n=t.length,i=0;i<n;i++)e.push(t[i])},d=function(e){return function(t){return t._tag===e}},p=d("AnyType"),g=d("InterfaceType"),f=d("PartialType"),b=function(e){function n(){var n=e.call(this,"null",(function(e){return null===e}),(function(e,i){return n.is(e)?t.success(e):t.failure(e,i)}),t.identity)||this;return n._tag="NullType",n}return r(n,e),n}(u);t.NullType=b,t.nullType=new b,t.null=t.nullType;var j=function(e){function n(){var n=e.call(this,"undefined",(function(e){return void 0===e}),(function(e,i){return n.is(e)?t.success(e):t.failure(e,i)}),t.identity)||this;return n._tag="UndefinedType",n}return r(n,e),n}(u);t.UndefinedType=j;var m=new j;t.undefined=m;var x=function(e){function n(){var n=e.call(this,"void",m.is,m.validate,t.identity)||this;return n._tag="VoidType",n}return r(n,e),n}(u);t.VoidType=x,t.voidType=new x,t.void=t.voidType;var h=function(e){function n(){var n=e.call(this,"unknown",(function(e){return!0}),t.success,t.identity)||this;return n._tag="UnknownType",n}return r(n,e),n}(u);t.UnknownType=h,t.unknown=new h;var y=function(e){function n(){var n=e.call(this,"string",(function(e){return"string"==typeof e}),(function(e,i){return n.is(e)?t.success(e):t.failure(e,i)}),t.identity)||this;return n._tag="StringType",n}return r(n,e),n}(u);t.StringType=y,t.string=new y;var O=function(e){function n(){var n=e.call(this,"number",(function(e){return"number"==typeof e}),(function(e,i){return n.is(e)?t.success(e):t.failure(e,i)}),t.identity)||this;return n._tag="NumberType",n}return r(n,e),n}(u);t.NumberType=O,t.number=new O;var v=function(e){function n(){var n=e.call(this,"boolean",(function(e){return"boolean"==typeof e}),(function(e,i){return n.is(e)?t.success(e):t.failure(e,i)}),t.identity)||this;return n._tag="BooleanType",n}return r(n,e),n}(u);t.BooleanType=v,t.boolean=new v;var T=function(e){function n(){var n=e.call(this,"UnknownArray",Array.isArray,(function(e,i){return n.is(e)?t.success(e):t.failure(e,i)}),t.identity)||this;return n._tag="AnyArrayType",n}return r(n,e),n}(u);t.AnyArrayType=T,t.UnknownArray=new T,t.Array=t.UnknownArray;var k=function(e){function n(){var n=e.call(this,"UnknownRecord",(function(e){return"[object Object]"===Object.prototype.toString.call(e)}),(function(e,i){return n.is(e)?t.success(e):t.failure(e,i)}),t.identity)||this;return n._tag="AnyDictionaryType",n}return r(n,e),n}(u);t.AnyDictionaryType=k,t.UnknownRecord=new k;var I=function(e){function n(){var n=e.call(this,"Function",(function(e){return"function"==typeof e}),(function(e,i){return n.is(e)?t.success(e):t.failure(e,i)}),t.identity)||this;return n._tag="FunctionType",n}return r(n,e),n}(u);t.FunctionType=I,t.Function=new I;var E=function(e){function t(t,n,i,r,a,s){var o=e.call(this,t,n,i,r)||this;return o.type=a,o.predicate=s,o._tag="RefinementType",o}return r(t,e),t}(u);t.RefinementType=E,t.brand=function(e,t,n){return X(e,t,n)},t.Int=t.brand(t.number,(function(e){return Number.isInteger(e)}),"Int");var S=function(e){function t(t,n,i,r,a){var s=e.call(this,t,n,i,r)||this;return s.value=a,s._tag="LiteralType",s}return r(t,e),t}(u);t.LiteralType=S,t.literal=function(e,n){void 0===n&&(n=JSON.stringify(e));var i=function(t){return t===e};return new S(n,i,(function(n,r){return i(n)?t.success(e):t.failure(n,r)}),t.identity,e)};var M=function(e){function t(t,n,i,r,a){var s=e.call(this,t,n,i,r)||this;return s.keys=a,s._tag="KeyofType",s}return r(t,e),t}(u);t.KeyofType=M;var w=Object.prototype.hasOwnProperty;t.keyof=function(e,n){void 0===n&&(n=Object.keys(e).map((function(e){return JSON.stringify(e)})).join(" | "));var i=function(n){return t.string.is(n)&&w.call(e,n)};return new M(n,i,(function(e,n){return i(e)?t.success(e):t.failure(e,n)}),t.identity,e)};var F=function(e){function t(t,n,i,r,a){var s=e.call(this,t,n,i,r)||this;return s.runDefinition=a,s._tag="RecursiveType",s}return r(t,e),t}(u);t.RecursiveType=F,Object.defineProperty(F.prototype,"type",{get:function(){return this.runDefinition()},enumerable:!0,configurable:!0}),t.recursion=function(e,t){var n,i=function(){return n||((n=t(r)).name=e),n},r=new F(e,(function(e){return i().is(e)}),(function(e,t){return i().validate(e,t)}),(function(e){return i().encode(e)}),i);return r};var _=function(e){function t(t,n,i,r,a){var s=e.call(this,t,n,i,r)||this;return s.type=a,s._tag="ArrayType",s}return r(t,e),t}(u);t.ArrayType=_,t.array=function(e,n){return void 0===n&&(n="Array<"+e.name+">"),new _(n,(function(n){return t.UnknownArray.is(n)&&n.every(e.is)}),(function(n,i){return c(t.UnknownArray.validate(n,i),(function(n){for(var r=n.length,a=n,o=[],c=0;c<r;c++){var u=n[c],d=e.validate(u,t.appendContext(i,String(c),e,u));if(s.isLeft(d))l(o,d.left);else{var p=d.right;p!==u&&(a===n&&(a=n.slice()),a[c]=p)}}return o.length>0?t.failures(o):t.success(a)}))}),e.encode===t.identity?t.identity:function(t){return t.map(e.encode)},e)};var C=function(e){function t(t,n,i,r,a){var s=e.call(this,t,n,i,r)||this;return s.props=a,s._tag="InterfaceType",s}return r(t,e),t}(u);t.InterfaceType=C;var L=function(e){return Object.keys(e).map((function(t){return t+": "+e[t].name})).join(", ")},N=function(e){for(var n=0;n<e.length;n++)if(e[n].encode!==t.identity)return!1;return!0},z=function(e){return"{ "+L(e)+" }"};t.type=function(e,n){void 0===n&&(n=z(e));var i=Object.keys(e),r=i.map((function(t){return e[t]})),o=i.length;return new C(n,(function(e){if(t.UnknownRecord.is(e)){for(var n=0;n<o;n++){var a=i[n];if(!w.call(e,a)||!r[n].is(e[a]))return!1}return!0}return!1}),(function(e,n){return c(t.UnknownRecord.validate(e,n),(function(e){for(var c=e,u=[],d=0;d<o;d++){var p=i[d];w.call(c,p)||(c===e&&(c=a({},e)),c[p]=c[p]);var g=c[p],f=r[d],b=f.validate(g,t.appendContext(n,p,f,g));if(s.isLeft(b))l(u,b.left);else{var j=b.right;j!==g&&(c===e&&(c=a({},e)),c[p]=j)}}return u.length>0?t.failures(u):t.success(c)}))}),N(r)?t.identity:function(e){for(var n=a({},e),s=0;s<o;s++){var c=i[s],u=r[s].encode;u!==t.identity&&(n[c]=u(e[c]))}return n},e)},t.interface=t.type;var P=function(e){function t(t,n,i,r,a){var s=e.call(this,t,n,i,r)||this;return s.props=a,s._tag="PartialType",s}return r(t,e),t}(u);t.PartialType=P;var A=function(e){return"Partial<"+e+">"};t.partial=function(e,n){void 0===n&&(n=A(z(e)));var i=Object.keys(e),r=i.map((function(t){return e[t]})),o=i.length;return new P(n,(function(n){if(t.UnknownRecord.is(n)){for(var r=0;r<o;r++){var a=i[r],s=n[a];if(void 0!==s&&!e[a].is(s))return!1}return!0}return!1}),(function(n,r){return c(t.UnknownRecord.validate(n,r),(function(n){for(var c=n,u=[],d=0;d<o;d++){var p=i[d],g=c[p],f=e[p],b=f.validate(g,t.appendContext(r,p,f,g));if(s.isLeft(b))void 0!==g&&l(u,b.left);else{var j=b.right;j!==g&&(c===n&&(c=a({},n)),c[p]=j)}}return u.length>0?t.failures(u):t.success(c)}))}),N(r)?t.identity:function(e){for(var t=a({},e),n=0;n<o;n++){var s=i[n],c=e[s];void 0!==c&&(t[s]=r[n].encode(c))}return t},e)};var R=function(e){function t(t,n,i,r,a,s){var o=e.call(this,t,n,i,r)||this;return o.domain=a,o.codomain=s,o._tag="DictionaryType",o}return r(t,e),t}(u);t.DictionaryType=R,t.record=function(e,n,i){return void 0===i&&(i="{ [K in "+e.name+"]: "+n.name+" }"),new R(i,(function(i){return t.UnknownRecord.is(i)?Object.keys(i).every((function(t){return e.is(t)&&n.is(i[t])})):p(n)&&Array.isArray(i)}),(function(i,r){if(t.UnknownRecord.is(i)){for(var a={},o=[],c=Object.keys(i),u=c.length,d=!1,g=0;g<u;g++){var f=c[g],b=i[f],j=e.validate(f,t.appendContext(r,f,e,f));if(s.isLeft(j))l(o,j.left);else{var m=j.right;d=d||m!==f,f=m;var x=n.validate(b,t.appendContext(r,f,n,b));if(s.isLeft(x))l(o,x.left);else{var h=x.right;d=d||h!==b,a[f]=h}}}return o.length>0?t.failures(o):t.success(d?a:i)}return p(n)&&Array.isArray(i)?t.success(i):t.failure(i,r)}),e.encode===t.identity&&n.encode===t.identity?t.identity:function(t){for(var i={},r=Object.keys(t),a=r.length,s=0;s<a;s++){var o=r[s];i[String(e.encode(o))]=n.encode(t[o])}return i},e,n)};var D=function(e){function t(t,n,i,r,a){var s=e.call(this,t,n,i,r)||this;return s.types=a,s._tag="UnionType",s}return r(t,e),t}(u);t.UnionType=D;var B=function(e){return"("+e.map((function(e){return e.name})).join(" | ")+")"};t.union=function(e,n){void 0===n&&(n=B(e));var i=ae(e);if(void 0!==i&&e.length>0){var r=i[0],a=i[1],o=a.length,u=function(e){for(var t=0;t<o;t++)if(-1!==a[t].indexOf(e))return t};return new G(n,(function(n){if(t.UnknownRecord.is(n)){var i=u(n[r]);return void 0!==i&&e[i].is(n)}return!1}),(function(n,i){return c(t.UnknownRecord.validate(n,i),(function(a){var s=u(a[r]);if(void 0===s)return t.failure(n,i);var o=e[s];return o.validate(a,t.appendContext(i,String(s),o,a))}))}),N(e)?t.identity:function(t){var i=u(t[r]);if(void 0===i)throw new Error("no codec found to encode value in union codec "+n);return e[i].encode(t)},e,r)}return new D(n,(function(t){return e.some((function(e){return e.is(t)}))}),(function(n,i){for(var r=[],a=0;a<e.length;a++){var o=e[a],c=o.validate(n,t.appendContext(i,String(a),o,n));if(!s.isLeft(c))return t.success(c.right);l(r,c.left)}return t.failures(r)}),N(e)?t.identity:function(t){for(var i=0,r=e;i<r.length;i++){var a=r[i];if(a.is(t))return a.encode(t)}throw new Error("no codec found to encode value in union type "+n)},e)};var U=function(e){function t(t,n,i,r,a){var s=e.call(this,t,n,i,r)||this;return s.types=a,s._tag="IntersectionType",s}return r(t,e),t}(u);t.IntersectionType=U;var V=function(e,n){for(var i=!0,r=!0,a=0,s=n;a<s.length;a++)(l=s[a])!==e&&(i=!1),t.UnknownRecord.is(l)&&(r=!1);if(i)return e;if(r)return n[n.length-1];for(var o={},c=0,u=n;c<u.length;c++){var l=u[c];for(var d in l)l[d]===e[d]&&o.hasOwnProperty(d)||(o[d]=l[d])}return o};t.intersection=function(e,n){void 0===n&&(n="("+e.map((function(e){return e.name})).join(" & ")+")");var i=e.length;return new U(n,(function(t){return e.every((function(e){return e.is(t)}))}),0===e.length?t.success:function(n,r){for(var a=[],o=[],c=0;c<i;c++){var u=e[c],d=u.validate(n,t.appendContext(r,String(c),u,n));s.isLeft(d)?l(o,d.left):a.push(d.right)}return o.length>0?t.failures(o):t.success(V(n,a))},0===e.length?t.identity:function(t){return V(t,e.map((function(e){return e.encode(t)})))},e)};var q=function(e){function t(t,n,i,r,a){var s=e.call(this,t,n,i,r)||this;return s.types=a,s._tag="TupleType",s}return r(t,e),t}(u);t.TupleType=q,t.tuple=function(e,n){void 0===n&&(n="["+e.map((function(e){return e.name})).join(", ")+"]");var i=e.length;return new q(n,(function(n){return t.UnknownArray.is(n)&&n.length===i&&e.every((function(e,t){return e.is(n[t])}))}),(function(n,r){return c(t.UnknownArray.validate(n,r),(function(n){for(var a=n.length>i?n.slice(0,i):n,o=[],c=0;c<i;c++){var u=n[c],d=e[c],p=d.validate(u,t.appendContext(r,String(c),d,u));if(s.isLeft(p))l(o,p.left);else{var g=p.right;g!==u&&(a===n&&(a=n.slice()),a[c]=g)}}return o.length>0?t.failures(o):t.success(a)}))}),N(e)?t.identity:function(t){return e.map((function(e,n){return e.encode(t[n])}))},e)};var W=function(e){function t(t,n,i,r,a){var s=e.call(this,t,n,i,r)||this;return s.type=a,s._tag="ReadonlyType",s}return r(t,e),t}(u);t.ReadonlyType=W,t.readonly=function(e,n){return void 0===n&&(n="Readonly<"+e.name+">"),new W(n,e.is,(function(t,n){return o(e.validate(t,n),(function(e){return e}))}),e.encode===t.identity?t.identity:e.encode,e)};var Q=function(e){function t(t,n,i,r,a){var s=e.call(this,t,n,i,r)||this;return s.type=a,s._tag="ReadonlyArrayType",s}return r(t,e),t}(u);t.ReadonlyArrayType=Q,t.readonlyArray=function(e,n){void 0===n&&(n="ReadonlyArray<"+e.name+">");var i=t.array(e);return new Q(n,i.is,(function(e,t){return o(i.validate(e,t),(function(e){return e}))}),i.encode,e)},t.strict=function(e,n){return t.exact(t.type(e),n)};var G=function(e){function t(t,n,i,r,a,s){var o=e.call(this,t,n,i,r,a)||this;return o.tag=s,o}return r(t,e),t}(D);t.TaggedUnionType=G,t.taggedUnion=function(e,n,i){void 0===i&&(i=B(n));var r=t.union(n,i);return r instanceof G?r:(console.warn("[io-ts] Cannot build a tagged union for "+i+", returning a de-optimized union"),new G(i,r.is,r.validate,r.encode,n,e))};var Y=function(e){function t(t,n,i,r,a){var s=e.call(this,t,n,i,r)||this;return s.type=a,s._tag="ExactType",s}return r(t,e),t}(u);t.ExactType=Y;var H=function(e){switch(e._tag){case"RefinementType":case"ReadonlyType":return H(e.type);case"InterfaceType":case"StrictType":case"PartialType":return e.props;case"IntersectionType":return e.types.reduce((function(e,t){return Object.assign(e,H(t))}),{})}},K=function(e,t){for(var n=Object.getOwnPropertyNames(e),i=!1,r={},a=0;a<n.length;a++){var s=n[a];w.call(t,s)?r[s]=e[s]:i=!0}return i?r:e};t.exact=function(e,n){void 0===n&&(n=function(e){return g(e)?"{| "+L(e.props)+" |}":f(e)?A("{| "+L(e.props)+" |}"):"Exact<"+e.name+">"}(e));var i=H(e);return new Y(n,e.is,(function(n,r){return c(t.UnknownRecord.validate(n,r),(function(){return o(e.validate(n,r),(function(e){return K(e,i)}))}))}),(function(t){return e.encode(K(t,i))}),e)},t.getValidationError=function(e,t){return{value:e,context:t}},t.getDefaultContext=function(e){return[{key:"",type:e}]};var J=function(e){function n(){var n=e.call(this,"never",(function(e){return!1}),(function(e,n){return t.failure(e,n)}),(function(){throw new Error("cannot encode never")}))||this;return n._tag="NeverType",n}return r(n,e),n}(u);t.NeverType=J,t.never=new J;var Z=function(e){function n(){var n=e.call(this,"any",(function(e){return!0}),t.success,t.identity)||this;return n._tag="AnyType",n}return r(n,e),n}(u);t.AnyType=Z,t.any=new Z,t.Dictionary=t.UnknownRecord;var $=function(e){function n(){var n=e.call(this,"object",(function(e){return null!==e&&"object"==typeof e}),(function(e,i){return n.is(e)?t.success(e):t.failure(e,i)}),t.identity)||this;return n._tag="ObjectType",n}return r(n,e),n}(u);function X(e,n,i){return void 0===i&&(i="("+e.name+" | "+t.getFunctionName(n)+")"),new E(i,(function(t){return e.is(t)&&n(t)}),(function(i,r){return c(e.validate(i,r),(function(e){return n(e)?t.success(e):t.failure(e,r)}))}),e.encode,e,n)}t.ObjectType=$,t.object=new $,t.refinement=X,t.Integer=X(t.number,Number.isInteger,"Integer"),t.dictionary=t.record;var ee=function(e){function t(t,n,i,r,a){var s=e.call(this,t,n,i,r)||this;return s.props=a,s._tag="StrictType",s}return r(t,e),t}(u);function te(e,t){for(var n=[],i=0,r=e;i<r.length;i++){var a=r[i];-1!==t.indexOf(a)&&n.push(a)}return n}function ne(e){return"LiteralType"===e._tag}t.StrictType=ee,t.clean=function(e){return e},t.alias=function(e){return function(){return e}},t.emptyTags={};var ie=[];function re(e){if(-1!==ie.indexOf(e))return t.emptyTags;if(function(e){return"InterfaceType"===e._tag}(e)||function(e){return"StrictType"===e._tag}(e)){var n=t.emptyTags;for(var i in e.props){var r=e.props[i];ne(r)&&(n===t.emptyTags&&(n={}),n[i]=[r.value])}return n}if(function(e){return"ExactType"===e._tag}(e)||function(e){return"RefinementType"===e._tag}(e))return re(e.type);if(function(e){return"IntersectionType"===e._tag}(e))return e.types.reduce((function(e,n){return function(e,n){if(e===t.emptyTags)return n;if(n===t.emptyTags)return e;var i=Object.assign({},e);for(var r in n)if(e.hasOwnProperty(r)){var a=te(e[r],n[r]);if(!(a.length>0)){i=t.emptyTags;break}i[r]=a}else i[r]=n[r];return i}(e,re(n))}),t.emptyTags);if(function(e){return"UnionType"===e._tag}(e))return e.types.slice(1).reduce((function(e,n){return function(e,n){if(e===t.emptyTags||n===t.emptyTags)return t.emptyTags;var i=t.emptyTags;for(var r in e)n.hasOwnProperty(r)&&0===te(e[r],n[r]).length&&(i===t.emptyTags&&(i={}),i[r]=e[r].concat(n[r]));return i}(e,re(n))}),re(e.types[0]));if(function(e){return"RecursiveType"===e._tag}(e)){ie.push(e);var a=re(e.type);return ie.pop(),a}return t.emptyTags}function ae(e){for(var t=re(e[0]),n=Object.keys(t),i=e.length,r=function(n){for(var r=t[n].slice(),a=[t[n]],s=1;s<i;s++){var o=re(e[s])[n];if(void 0===o)return"continue-keys";if(o.some((function(e){return-1!==r.indexOf(e)})))return"continue-keys";r.push.apply(r,o),a.push(o)}return{value:[n,a]}},a=0,s=n;a<s.length;a++){var o=r(s[a]);if("object"==typeof o)return o.value}}t.getTags=re,t.getIndex=ae},42:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(15),r=n(1),a=i.__importDefault(n(51));t.default=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=[]);var i=a.default(e,t),s=i[0],o=i[1],c=i[2];return r.useEffect(c,n),[s,o]}},43:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.apS=t.apSW=t.bind=t.bindW=t.bindTo=t.exists=t.elem=t.toError=t.either=t.getValidationMonoid=t.MonadThrow=t.ChainRec=t.Extend=t.Alt=t.Bifunctor=t.Traversable=t.Foldable=t.Monad=t.Applicative=t.Functor=t.getValidationSemigroup=t.getValidation=t.getAltValidation=t.getApplicativeValidation=t.getWitherable=t.getFilterable=t.getApplyMonoid=t.getApplySemigroup=t.getSemigroup=t.getEq=t.getShow=t.URI=t.throwError=t.sequence=t.traverse=t.reduceRight=t.foldMap=t.reduce=t.duplicate=t.extend=t.alt=t.flatten=t.chainFirst=t.chainFirstW=t.chain=t.chainW=t.of=t.apSecond=t.apFirst=t.ap=t.apW=t.mapLeft=t.bimap=t.map=t.filterOrElse=t.orElse=t.swap=t.getOrElse=t.getOrElseW=t.fold=t.fromPredicate=t.fromOption=t.stringifyJSON=t.parseJSON=t.tryCatch=t.fromNullable=t.right=t.left=t.isRight=t.isLeft=void 0;var i=n(44),r=n(45);function a(e,n){try{return t.right(e())}catch(e){return t.left(n(e))}}t.isLeft=function(e){return"Left"===e._tag},t.isRight=function(e){return"Right"===e._tag},t.left=function(e){return{_tag:"Left",left:e}},t.right=function(e){return{_tag:"Right",right:e}},t.fromNullable=function(e){return function(n){return null==n?t.left(e):t.right(n)}},t.tryCatch=a,t.parseJSON=function(e,t){return a((function(){return JSON.parse(e)}),t)},t.stringifyJSON=function(e,t){return a((function(){return JSON.stringify(e)}),t)},t.fromOption=function(e){return function(n){return"None"===n._tag?t.left(e()):t.right(n.value)}},t.fromPredicate=function(e,n){return function(i){return e(i)?t.right(i):t.left(n(i))}},t.fold=function(e,n){return function(i){return t.isLeft(i)?e(i.left):n(i.right)}},t.getOrElseW=function(e){return function(n){return t.isLeft(n)?e(n.left):n.right}},t.getOrElse=t.getOrElseW,t.swap=function(e){return t.isLeft(e)?t.right(e.left):t.left(e.right)},t.orElse=function(e){return function(n){return t.isLeft(n)?e(n.left):n}},t.filterOrElse=function(e,n){return t.chain((function(i){return e(i)?t.right(i):t.left(n(i))}))};var s=function(e,n){return r.pipe(e,t.map(n))},o=function(e,n){return r.pipe(e,t.ap(n))},c=function(e,n){return r.pipe(e,t.chain(n))},u=function(e,n,i){return r.pipe(e,t.reduce(n,i))},l=function(e){return function(n,i){var a=t.foldMap(e);return r.pipe(n,a(i))}},d=function(e,n,i){return r.pipe(e,t.reduceRight(n,i))},p=function(e){var n=t.traverse(e);return function(e,t){return r.pipe(e,n(t))}},g=function(e,n,i){return r.pipe(e,t.bimap(n,i))},f=function(e,n){return r.pipe(e,t.mapLeft(n))},b=function(e,n){return r.pipe(e,t.alt(n))},j=function(e,n){return r.pipe(e,t.extend(n))},m=function(e,n){return i.tailRec(n(e),(function(e){return t.isLeft(e)?t.right(t.left(e.left)):t.isLeft(e.right)?t.left(n(e.right.left)):t.right(t.right(e.right.right))}))};function x(e){return{concat:function(n,i){return t.isLeft(n)?n:t.isLeft(i)?i:t.right(e.concat(n.right,i.right))}}}function h(e){var n=t.left(e.empty);return{URI:t.URI,_E:void 0,map:s,compact:function(e){return t.isLeft(e)?e:"None"===e.right._tag?n:t.right(e.right.value)},separate:function(e){return t.isLeft(e)?{left:e,right:e}:t.isLeft(e.right)?{left:t.right(e.right.left),right:n}:{left:n,right:t.right(e.right.right)}},filter:function(e,i){return t.isLeft(e)||i(e.right)?e:n},filterMap:function(e,i){if(t.isLeft(e))return e;var r=i(e.right);return"None"===r._tag?n:t.right(r.value)},partition:function(e,i){return t.isLeft(e)?{left:e,right:e}:i(e.right)?{left:n,right:t.right(e.right)}:{left:t.right(e.right),right:n}},partitionMap:function(e,i){if(t.isLeft(e))return{left:e,right:e};var r=i(e.right);return t.isLeft(r)?{left:t.right(r.left),right:n}:{left:n,right:t.right(r.right)}}}}function y(e){return{URI:t.URI,_E:void 0,map:s,ap:function(n,i){return t.isLeft(n)?t.isLeft(i)?t.left(e.concat(n.left,i.left)):n:t.isLeft(i)?i:t.right(n.right(i.right))},of:t.of}}function O(e){return{URI:t.URI,_E:void 0,map:s,alt:function(n,i){if(t.isRight(n))return n;var r=i();return t.isLeft(r)?t.left(e.concat(n.left,r.left)):r}}}function v(e,n){return{concat:function(i,r){return t.isLeft(i)?t.isLeft(r)?t.left(e.concat(i.left,r.left)):i:t.isLeft(r)?r:t.right(n.concat(i.right,r.right))}}}t.map=function(e){return function(n){return t.isLeft(n)?n:t.right(e(n.right))}},t.bimap=function(e,n){return function(i){return t.isLeft(i)?t.left(e(i.left)):t.right(n(i.right))}},t.mapLeft=function(e){return function(n){return t.isLeft(n)?t.left(e(n.left)):n}},t.apW=function(e){return function(n){return t.isLeft(n)?n:t.isLeft(e)?e:t.right(n.right(e.right))}},t.ap=t.apW,t.apFirst=function(e){return r.flow(t.map((function(e){return function(){return e}})),t.ap(e))},t.apSecond=function(e){return r.flow(t.map((function(){return function(e){return e}})),t.ap(e))},t.of=t.right,t.chainW=function(e){return function(n){return t.isLeft(n)?n:e(n.right)}},t.chain=t.chainW,t.chainFirstW=function(e){return function(n){return r.pipe(n,t.chainW((function(n){return r.pipe(e(n),t.map((function(){return n})))})))}},t.chainFirst=t.chainFirstW,t.flatten=t.chain(r.identity),t.alt=function(e){return function(n){return t.isLeft(n)?e():n}},t.extend=function(e){return function(n){return t.isLeft(n)?n:t.right(e(n))}},t.duplicate=t.extend(r.identity),t.reduce=function(e,n){return function(i){return t.isLeft(i)?e:n(e,i.right)}},t.foldMap=function(e){return function(n){return function(i){return t.isLeft(i)?e.empty:n(i.right)}}},t.reduceRight=function(e,n){return function(i){return t.isLeft(i)?e:n(i.right,e)}},t.traverse=function(e){return function(n){return function(i){return t.isLeft(i)?e.of(t.left(i.left)):e.map(n(i.right),t.right)}}},t.sequence=function(e){return function(n){return t.isLeft(n)?e.of(t.left(n.left)):e.map(n.right,t.right)}},t.throwError=t.left,t.URI="Either",t.getShow=function(e,n){return{show:function(i){return t.isLeft(i)?"left("+e.show(i.left)+")":"right("+n.show(i.right)+")"}}},t.getEq=function(e,n){return{equals:function(i,r){return i===r||(t.isLeft(i)?t.isLeft(r)&&e.equals(i.left,r.left):t.isRight(r)&&n.equals(i.right,r.right))}}},t.getSemigroup=function(e){return{concat:function(n,i){return t.isLeft(i)?n:t.isLeft(n)?i:t.right(e.concat(n.right,i.right))}}},t.getApplySemigroup=x,t.getApplyMonoid=function(e){return{concat:x(e).concat,empty:t.right(e.empty)}},t.getFilterable=h,t.getWitherable=function(e){var n=h(e);return{URI:t.URI,_E:void 0,map:s,compact:n.compact,separate:n.separate,filter:n.filter,filterMap:n.filterMap,partition:n.partition,partitionMap:n.partitionMap,traverse:p,sequence:t.sequence,reduce:u,foldMap:l,reduceRight:d,wither:function(e){var t=p(e);return function(i,r){return e.map(t(i,r),n.compact)}},wilt:function(e){var t=p(e);return function(i,r){return e.map(t(i,r),n.separate)}}}},t.getApplicativeValidation=y,t.getAltValidation=O,t.getValidation=function(e){var n=y(e),i=O(e);return{URI:t.URI,_E:void 0,map:s,of:t.of,chain:c,bimap:g,mapLeft:f,reduce:u,foldMap:l,reduceRight:d,extend:j,traverse:p,sequence:t.sequence,chainRec:m,throwError:t.throwError,ap:n.ap,alt:i.alt}},t.getValidationSemigroup=v,t.Functor={URI:t.URI,map:s},t.Applicative={URI:t.URI,map:s,ap:o,of:t.of},t.Monad={URI:t.URI,map:s,ap:o,of:t.of,chain:c},t.Foldable={URI:t.URI,reduce:u,foldMap:l,reduceRight:d},t.Traversable={URI:t.URI,map:s,reduce:u,foldMap:l,reduceRight:d,traverse:p,sequence:t.sequence},t.Bifunctor={URI:t.URI,bimap:g,mapLeft:f},t.Alt={URI:t.URI,map:s,alt:b},t.Extend={URI:t.URI,map:s,extend:j},t.ChainRec={URI:t.URI,map:s,ap:o,chain:c,chainRec:m},t.MonadThrow={URI:t.URI,map:s,ap:o,of:t.of,chain:c,throwError:t.throwError},t.getValidationMonoid=function(e,n){return{concat:v(e,n).concat,empty:t.right(n.empty)}},t.either={URI:t.URI,map:s,of:t.of,ap:o,chain:c,reduce:u,foldMap:l,reduceRight:d,traverse:p,sequence:t.sequence,bimap:g,mapLeft:f,alt:b,extend:j,chainRec:m,throwError:t.throwError},t.toError=function(e){return e instanceof Error?e:new Error(String(e))},t.elem=function(e){return function(n,i){return!t.isLeft(i)&&e.equals(n,i.right)}},t.exists=function(e){return function(n){return!t.isLeft(n)&&e(n.right)}},t.bindTo=function(e){return t.map(r.bindTo_(e))},t.bindW=function(e,n){return t.chainW((function(i){return r.pipe(n(i),t.map((function(t){return r.bind_(i,e,t)})))}))},t.bind=t.bindW,t.apSW=function(e,n){return r.flow(t.map((function(t){return function(n){return r.bind_(t,e,n)}})),t.apW(n))},t.apS=t.apSW},44:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tailRec=void 0,t.tailRec=function(e,t){for(var n=t(e);"Left"===n._tag;)n=t(n.left);return n.right}},45:function(e,t,n){"use strict";function i(e){return e}function r(e){throw new Error("Called `absurd` function which should be uncallable")}Object.defineProperty(t,"__esModule",{value:!0}),t.bindTo_=t.bind_=t.hole=t.pipe=t.untupled=t.tupled=t.absurd=t.decrement=t.increment=t.tuple=t.flow=t.flip=t.constVoid=t.constUndefined=t.constNull=t.constFalse=t.constTrue=t.constant=t.not=t.unsafeCoerce=t.identity=void 0,t.identity=i,t.unsafeCoerce=i,t.not=function(e){return function(t){return!e(t)}},t.constant=function(e){return function(){return e}},t.constTrue=function(){return!0},t.constFalse=function(){return!1},t.constNull=function(){return null},t.constUndefined=function(){},t.constVoid=function(){},t.flip=function(e){return function(t,n){return e(n,t)}},t.flow=function(e,t,n,i,r,a,s,o,c){switch(arguments.length){case 1:return e;case 2:return function(){return t(e.apply(this,arguments))};case 3:return function(){return n(t(e.apply(this,arguments)))};case 4:return function(){return i(n(t(e.apply(this,arguments))))};case 5:return function(){return r(i(n(t(e.apply(this,arguments)))))};case 6:return function(){return a(r(i(n(t(e.apply(this,arguments))))))};case 7:return function(){return s(a(r(i(n(t(e.apply(this,arguments)))))))};case 8:return function(){return o(s(a(r(i(n(t(e.apply(this,arguments))))))))};case 9:return function(){return c(o(s(a(r(i(n(t(e.apply(this,arguments)))))))))}}},t.tuple=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e},t.increment=function(e){return e+1},t.decrement=function(e){return e-1},t.absurd=r,t.tupled=function(e){return function(t){return e.apply(void 0,t)}},t.untupled=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e(t)}},t.pipe=function(e,t,n,i,r,a,s,o,c,u,l,d,p,g,f,b,j,m,x,h){switch(arguments.length){case 1:return e;case 2:return t(e);case 3:return n(t(e));case 4:return i(n(t(e)));case 5:return r(i(n(t(e))));case 6:return a(r(i(n(t(e)))));case 7:return s(a(r(i(n(t(e))))));case 8:return o(s(a(r(i(n(t(e)))))));case 9:return c(o(s(a(r(i(n(t(e))))))));case 10:return u(c(o(s(a(r(i(n(t(e)))))))));case 11:return l(u(c(o(s(a(r(i(n(t(e))))))))));case 12:return d(l(u(c(o(s(a(r(i(n(t(e)))))))))));case 13:return p(d(l(u(c(o(s(a(r(i(n(t(e))))))))))));case 14:return g(p(d(l(u(c(o(s(a(r(i(n(t(e)))))))))))));case 15:return f(g(p(d(l(u(c(o(s(a(r(i(n(t(e))))))))))))));case 16:return b(f(g(p(d(l(u(c(o(s(a(r(i(n(t(e)))))))))))))));case 17:return j(b(f(g(p(d(l(u(c(o(s(a(r(i(n(t(e))))))))))))))));case 18:return m(j(b(f(g(p(d(l(u(c(o(s(a(r(i(n(t(e)))))))))))))))));case 19:return x(m(j(b(f(g(p(d(l(u(c(o(s(a(r(i(n(t(e))))))))))))))))));case 20:return h(x(m(j(b(f(g(p(d(l(u(c(o(s(a(r(i(n(t(e)))))))))))))))))))}},t.hole=r,t.bind_=function(e,t,n){var i;return Object.assign({},e,((i={})[t]=n,i))},t.bindTo_=function(e){return function(t){var n;return(n={})[e]=t,n}}},46:function(e,t,n){e.exports=n.p+"4c19e824d4ddbcb450a8dd5b72ceb88f.svg"},47:function(e,t,n){e.exports=n.p+"556aaa7f500540cdf81296a57d2a1399.svg"},48:function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2aWV3Qm94PSIwIDAgMzcuMTE4IDQxLjc3OCI+PGRlZnM+PGxpbmVhckdyYWRpZW50IGlkPSJhIiB4MT0iMy4wNjciIHkxPSI5LjkzIiB4Mj0iMjkuNTQiIHkyPSIzNi40MDMiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj48c3RvcCBvZmZzZXQ9IjAiIHN0b3AtY29sb3I9IiNjODUxMWIiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiNmOTAiLz48L2xpbmVhckdyYWRpZW50PjxsaW5lYXJHcmFkaWVudCBpZD0iYiIgeDE9IjEzLjIzMyIgeTE9Ii0xLjg5IiB4Mj0iNDAuNDAyIiB5Mj0iMjUuMjc4IiB4bGluazpocmVmPSIjYSIvPjxsaW5lYXJHcmFkaWVudCBpZD0iYyIgeDE9IjUuNDU0IiB5MT0iNi45NDgiIHgyPSIzMi40MjYiIHkyPSIzMy45MiIgeGxpbms6aHJlZj0iI2EiLz48L2RlZnM+PHBhdGggZD0iTTE4LjU2IDQxLjc3OWEuNzcuNzcgMCAwIDEtLjM4Ny0uMUwuMzg3IDMxLjQwOUEuNzczLjc3MyAwIDAgMSAwIDMwLjczN1YxMC4yYS43NzQuNzc0IDAgMCAxIC4zODctLjY3M0wxNi42MjcuMWEuNzc0Ljc3NCAwIDAgMSAxLjE2LjY3M3Y4LjlhLjc3NS43NzUgMCAwIDEtLjM4Ny42NzNMOS4yOCAxNS4wOXYxMC43MjZsOS4yOCA1LjM1OSA4LjEtNC42NGEuNzczLjc3MyAwIDAgMSAuNzczIDBMMzUuMTY2IDMxYS43NzIuNzcyIDAgMCAxIDAgMS4zNDVsLTE2LjIyMSA5LjMzM2EuNzc0Ljc3NCAwIDAgMS0uMzg1LjEwMVpNMS41NDUgMzAuMjg3bDE3LjAxMyA5LjgyOSAxNC42OTMtOC41MDctNi4xODYtMy41NzItOC4xMiA0LjcwOWEuNzc1Ljc3NSAwIDAgMS0uNzc0IDBMOC4xMTggMjYuOTM5YS43NzUuNzc1IDAgMCAxLS4zODctLjY3M3YtMTEuNmEuNzc1Ljc3NSAwIDAgMSAuMzg3LS42NzNsOC4xMi00LjcyNVYyLjExNUwxLjU0NSAxMC42MjFaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwIC0uMDAxKSIgc3R5bGU9ImZpbGw6dXJsKCNhKSIvPjxwYXRoIGQ9Ik0zNi4zNDUgMjkuNzNhLjc3Ljc3IDAgMCAxLS4zODctLjFsLTcuNzMzLTQuNDQ3YS42Ny42NyAwIDAgMS0uMzQ4LS42NzN2LTkuNDE5bC04LjE1OS00LjY0YS43NzUuNzc1IDAgMCAxLS4zODctLjY3M1YuODYyYS43NzQuNzc0IDAgMCAxIC4zODctLjY3My44Mi44MiAwIDAgMSAuNzczIDBsMTYuMjQgOS4zMzRhLjc3NS43NzUgMCAwIDEgLjM4Ny42NzN2MTguNzYxYS43NzMuNzczIDAgMCAxLS43NzMuNzczWm0tNi45Ni01LjY2MSA2LjE4NiAzLjU0MlYxMC42NDZMMjAuODc4IDIuMnY3LjEzOUwyOSAxMy45NzlhLjc3Ni43NzYgMCAwIDEgLjM4Ny42NjZaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwIC0uMDAxKSIgc3R5bGU9ImZpbGw6dXJsKCNiKSIvPjxwYXRoIGQ9Ik0xNC42OTMgMjYuM1YxNC43aDEuNTUydjUuMjgybDUuMDI3LTUuMjgyaDIuMDQxbC01LjI0OCA1LjY0OSA1LjcgNS45NTVoLTIuMTEybC01LjQwOC01LjQxOFYyNi4zWiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCAtLjAwMSkiIHN0eWxlPSJmaWxsOnVybCgjYykiLz48L3N2Zz4="},49:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDeepEqual=t.off=t.on=t.isClient=void 0;var i=n(15).__importDefault(n(50));t.isClient="object"==typeof window,t.on=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.addEventListener.apply(e,t)},t.off=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.removeEventListener.apply(e,t)},t.isDeepEqual=i.default},50:function(e,t,n){"use strict";e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var i,r,a;if(Array.isArray(t)){if((i=t.length)!=n.length)return!1;for(r=i;0!=r--;)if(!e(t[r],n[r]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((i=(a=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(r=i;0!=r--;)if(!Object.prototype.hasOwnProperty.call(n,a[r]))return!1;for(r=i;0!=r--;){var s=a[r];if(!("_owner"===s&&t.$$typeof||e(t[s],n[s])))return!1}return!0}return t!=t&&n!=n}},51:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1);t.default=function(e,t){void 0===t&&(t=0);var n=i.useRef(!1),r=i.useRef(),a=i.useRef(e),s=i.useCallback((function(){return n.current}),[]),o=i.useCallback((function(){n.current=!1,r.current&&clearTimeout(r.current),r.current=setTimeout((function(){n.current=!0,a.current()}),t)}),[t]),c=i.useCallback((function(){n.current=null,r.current&&clearTimeout(r.current)}),[]);return i.useEffect((function(){a.current=e}),[e]),i.useEffect((function(){return o(),c}),[t]),[s,c,o]}},55:function(e,t,n){"use strict";n.r(t),n.d(t,"getRoutesFromMapping",(function(){return Yn})),n.d(t,"addSpyRouteComponentToRoute",(function(){return Hn})),n.d(t,"CspRouter",(function(){return Jn})),n.d(t,"default",(function(){return Jn}));var i=n(6),r=n.n(i),a=n(1),s=n.n(a),o=n(21),c=n(22),u=n(26),l=n(16),d=n(2),p=n(35),g=n(5);const f=({options:e}={})=>{const{http:t}=Object(p.a)().services;return Object(o.useQuery)(["csp_status_key"],(()=>t.get(g.r)),e)};var b=n(3),j=n(20),m=n(4),x=n(0),h=n(10);const y=({name:e,perPage:t,page:n,sortField:i,sortOrder:r})=>{const{http:a}=Object(p.a)().services,s={benchmark_name:e,per_page:t,page:n,sort_field:i,sort_order:r};return Object(o.useQuery)(["csp_benchmark_integrations",s],(()=>a.get(g.a,{query:s})),{keepPreviousData:!0})};var O=n(23),v=n(28);const T=()=>{const{http:e}=Object(p.a)().services;return Object(o.useQuery)(["integrations"],(()=>e.get(v.epmRouteService.getInfoPath(g.d))))};var k=n(9);const I=()=>{const{application:e}=Object(p.a)().services;return Object(x.jsx)(b.EuiPageSection,{color:"danger",alignment:"center"},Object(x.jsx)(b.EuiEmptyPrompt,{iconType:"alert",title:Object(x.jsx)("h2",null,Object(x.jsx)(j.FormattedMessage,{id:"xpack.csp.subscriptionNotAllowed.promptTitle",defaultMessage:"Upgrade for subscription features"})),body:Object(x.jsx)("p",null,Object(x.jsx)(j.FormattedMessage,{id:"xpack.csp.subscriptionNotAllowed.promptDescription",defaultMessage:"To use these cloud security features, you must {link}.",values:{link:Object(x.jsx)(b.EuiLink,{href:e.getUrlForApp("management",{path:"stack/license_management/home"})},Object(x.jsx)(j.FormattedMessage,{id:"xpack.csp.subscriptionNotAllowed.promptLinkText",defaultMessage:"start a trial or upgrade your subscription"}))}}))}))};var E=n(13);const S="Cloud Security";var M=n(12);const w=()=>{const{http:e}=Object(p.a)().services,t=T();if(!t.isSuccess)return;const n=O.pagePathGetters.add_integration_to_policy({integration:g.d,pkgkey:Object(O.pkgKeyFromPackageInfo)({name:t.data.item.name,version:t.data.item.version})}).join("");return e.basePath.prepend(n)},F=e=>{var t,n,i;return!!(null!=e&&e.body&&null!=e&&null!==(t=e.body)&&void 0!==t&&t.error&&null!=e&&null!==(n=e.body)&&void 0!==n&&n.message&&null!=e&&null!==(i=e.body)&&void 0!==i&&i.statusCode)};var _={name:"1wojih0",styles:"max-width:950px"};const C=()=>Object(x.jsx)(M.a,{"data-test-subj":"cloud_posture_page_loading"},Object(x.jsx)(j.FormattedMessage,{id:"xpack.csp.cloudPosturePage.loadingDescription",defaultMessage:"Loading..."})),L=e=>Object(x.jsx)(h.a,null,Object(x.jsx)(b.EuiEmptyPrompt,{color:"danger",iconType:"alert","data-test-subj":"cloud_posture_page_error",title:Object(x.jsx)("h2",null,Object(x.jsx)(j.FormattedMessage,{id:"xpack.csp.cloudPosturePage.errorRenderer.errorTitle",defaultMessage:"We couldn't fetch your cloud security posture data"})),body:F(e)?Object(x.jsx)("p",null,Object(x.jsx)(j.FormattedMessage,{id:"xpack.csp.cloudPosturePage.errorRenderer.errorDescription",defaultMessage:"{error} {statusCode}: {body}",values:{error:e.body.error,statusCode:e.body.statusCode,body:e.body.message}})):void 0})),N=()=>Object(x.jsx)(h.a,null,Object(x.jsx)(k.NoDataPage,{"data-test-subj":"cloud_posture_page_no_data",pageTitle:m.i18n.translate("xpack.csp.cloudPosturePage.defaultNoDataConfig.pageTitle",{defaultMessage:"No data found"}),solution:m.i18n.translate("xpack.csp.cloudPosturePage.defaultNoDataConfig.solutionNameLabel",{defaultMessage:"Cloud Security Posture"}),docsLink:"https://www.elastic.co/guide/index.html",logo:"logoSecurity",actions:{}})),z=({children:e,query:t,loadingRender:n=C,errorRender:i=L,noDataRenderer:r=N})=>{const c=(()=>{const{licensing:e}=Object(p.a)().services,{isCloudEnabled:t}=Object(a.useContext)(E.a);return Object(o.useQuery)(["csp_subscription_query_key"],(async()=>{const n=await e.refresh();return((e,t)=>!!e||!!t&&"valid"===t.check(S,"enterprise").state)(t,n)}))})(),u=f(),l=w();return Object(x.jsx)(s.a.Fragment,null,c.isError?L(c.error):c.isLoading?C():c.data?u.isError?L(u.error):u.isLoading?C():"not-installed"===u.data.status?(e=>Object(x.jsx)(h.a,null,Object(x.jsx)(k.NoDataPage,{"data-test-subj":"cloud_posture_page_package_not_installed",css:_,pageTitle:m.i18n.translate("xpack.csp.cloudPosturePage.packageNotInstalled.pageTitle",{defaultMessage:"Install Integration to get started"}),solution:m.i18n.translate("xpack.csp.cloudPosturePage.packageNotInstalled.solutionNameLabel",{defaultMessage:"Cloud Security Posture"}),docsLink:"https://ela.st/kspm",logo:"logoSecurity",actions:{elasticAgent:{href:e,isDisabled:!e,title:m.i18n.translate("xpack.csp.cloudPosturePage.packageNotInstalled.buttonLabel",{defaultMessage:"Add a KSPM integration"}),description:Object(x.jsx)(j.FormattedMessage,{id:"xpack.csp.cloudPosturePage.packageNotInstalled.description",defaultMessage:"Use our {integrationFullName} (KSPM) integration to measure your Kubernetes cluster setup against CIS recommendations.",values:{integrationFullName:Object(x.jsx)(b.EuiLink,{href:"https://ela.st/kspm"},Object(x.jsx)(j.FormattedMessage,{id:"xpack.csp.cloudPosturePage.packageNotInstalled.integrationNameLabel",defaultMessage:"Kubernetes Security Posture Management"}))}})}}})))(l):t?t.isError?i(t.error):t.isLoading?n():t.data?e:r():e:Object(x.jsx)(h.a,{"data-test-subj":"cloud_posture_page_subscription_not_allowed"},Object(x.jsx)(I,null)))},P=()=>{var e,t;const n=null===(e=y({name:"",page:1,perPage:1,sortField:"package_policy.name",sortOrder:"asc"}).data)||void 0===e||null===(t=e.items)||void 0===t?void 0:t[0],i=(({addAgentToPolicyId:e="",integration:t=""})=>{const{http:n}=Object(p.a)().services,i=T();if(!i.isSuccess)return;const r=O.pagePathGetters.integration_details_policies({addAgentToPolicyId:e,integration:t,pkgkey:Object(O.pkgKeyFromPackageInfo)({name:i.data.item.name,version:i.data.item.version})}).join("");return n.basePath.prepend(r)})({addAgentToPolicyId:(null==n?void 0:n.agent_policy.id)||"",integration:(null==n?void 0:n.package_policy.id)||""});return Object(x.jsx)(b.EuiEmptyPrompt,{"data-test-subj":"status-api-no-agent-deployed",color:"plain",iconType:"fleetApp",title:Object(x.jsx)("h2",null,Object(x.jsx)(j.FormattedMessage,{id:"xpack.csp.noFindingsStates.noAgentsDeployed.noAgentsDeployedTitle",defaultMessage:"No Agents Installed"})),body:Object(x.jsx)("p",null,Object(x.jsx)(j.FormattedMessage,{id:"xpack.csp.noFindingsStates.noAgentsDeployed.noAgentsDeployedDescription",defaultMessage:"To see findings, please finish the setup process by installing an elastic agent on your Kubernetes cluster."})),actions:[Object(x.jsx)(b.EuiButton,{fill:!0,href:i,isDisabled:!i},Object(x.jsx)(j.FormattedMessage,{id:"xpack.csp.noFindingsStates.noAgentsDeployed.noAgentsDeployedButtonTitle",defaultMessage:"Install Agent"}))]})},A=()=>Object(x.jsx)(b.EuiEmptyPrompt,{"data-test-subj":"status-api-indexing",color:"plain",icon:Object(x.jsx)(b.EuiLoadingLogo,{logo:"logoSecurity",size:"xl"}),title:Object(x.jsx)("h2",null,Object(x.jsx)(j.FormattedMessage,{id:"xpack.csp.noFindingsStates.indexing.indexingButtonTitle",defaultMessage:"No Findings Yet"})),body:Object(x.jsx)("p",null,Object(x.jsx)(j.FormattedMessage,{id:"xpack.csp.noFindingsStates.indexing.indexingDescription",defaultMessage:"Waiting for data to be collected and indexed. Check back later to see your findings"}))}),R=()=>Object(x.jsx)(b.EuiEmptyPrompt,{"data-test-subj":"status-api-index-timeout",color:"plain",icon:Object(x.jsx)(b.EuiLoadingLogo,{logo:"logoSecurity",size:"xl"}),title:Object(x.jsx)("h2",null,Object(x.jsx)(j.FormattedMessage,{id:"xpack.csp.noFindingsStates.indexTimeout.indexTimeoutTitle",defaultMessage:"Findings Delayed"})),body:Object(x.jsx)("p",null,Object(x.jsx)(j.FormattedMessage,{id:"xpack.csp.noFindingsStates.indexTimeout.indexTimeoutDescription",defaultMessage:"Collecting findings is taking longer than expected, check back again soon"}))});var D={name:"1b7vz4z",styles:"text-align:initial"};const B=({unprivilegedIndices:e})=>Object(x.jsx)(b.EuiEmptyPrompt,{"data-test-subj":"status-api-unprivileged",color:"plain",icon:Object(x.jsx)(b.EuiIcon,{type:"logoSecurity",size:"xl"}),title:Object(x.jsx)("h2",null,Object(x.jsx)(j.FormattedMessage,{id:"xpack.csp.noFindingsStates.unprivileged.unprivilegedTitle",defaultMessage:"Privileges required"})),body:Object(x.jsx)("p",null,Object(x.jsx)(j.FormattedMessage,{id:"xpack.csp.noFindingsStates.unprivileged.unprivilegedDescription",defaultMessage:"To view cloud posture data, you must update privileges. For more information, contact your Kibana administrator."})),footer:Object(x.jsx)(b.EuiMarkdownFormat,{css:D,children:m.i18n.translate("xpack.csp.noFindingsStates.unprivileged.unprivilegedFooterMarkdown",{defaultMessage:"Required Elasticsearch index privilege `read` for the following indices:"})+e.map((e=>`\n- \`${e}\``))})}),U=()=>{var e,t;const n=f({options:{refetchInterval:2e4}}),i=null===(e=n.data)||void 0===e?void 0:e.status,r=null===(t=n.data)||void 0===t?void 0:t.indicesDetails,a=r&&r.filter((e=>"unprivileged"===e.status)).map((e=>e.index)).sort(((e,t)=>e.localeCompare(t)));return Object(x.jsx)(z,{query:n},Object(x.jsx)(h.a,null,"not-deployed"===i?Object(x.jsx)(P,null):"indexing"===i?Object(x.jsx)(A,null):"index-timeout"===i?Object(x.jsx)(R,null):"unprivileged"===i?Object(x.jsx)(B,{unprivilegedIndices:a||[]}):void 0))},V=6e4,q=Object(a.createContext)({}),W=()=>{const{data:{dataViews:e}}=Object(k.useKibana)().services;return Object(o.useQuery)(["latest_findings_data_view"],(async()=>{var t;const n=null===(t=await e.find(g.e))||void 0===t?void 0:t[0];if(!n)throw new Error("Findings data view not found");return n}))};var Q=n(38),G=n.n(Q);const Y=({title:e})=>Object(x.jsx)(b.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},Object(x.jsx)(b.EuiFlexItem,{grow:!1},Object(x.jsx)(b.EuiTitle,null,Object(x.jsx)("h1",null,e)))),H=s.a.createContext(void 0),K="findings_container",J=({dataView:e,loading:t,setQuery:n})=>{const{euiTheme:i}=Object(b.useEuiTheme)(),{unifiedSearch:{ui:{SearchBar:r}}}=Object(k.useKibana)().services,o=Object(a.useContext)(H);let c=Object(x.jsx)("div",{css:Z(i)},Object(x.jsx)(r,{appName:S,dataTestSubj:"findings_search_bar",showFilterBar:!0,showQueryInput:!0,showDatePicker:!1,showSaveQuery:!1,isLoading:t,indexPatterns:[e],onQuerySubmit:n,onFiltersUpdated:e=>n({filters:e}),placeholder:m.i18n.translate("xpack.csp.findings.searchBar.searchPlaceholder",{defaultMessage:'Search findings (eg. rule.section : "API Server" )'})}));if(o){const e=o.getFiltersGlobalComponent();c=Object(x.jsx)(e,null,c)}return Object(x.jsx)(s.a.Fragment,null,c)},Z=e=>Object(x.css)("border-bottom:",e.border.thin,";background-color:",e.colors.body,";padding:",e.size.base,";","");var $=n(32);const X=e=>{const t=(e=>{try{return Object($.encode)(e)}catch(e){console.error(e)}})(e);if(t)return`cspq=${t}`},ee=e=>{const t=new URLSearchParams(e).get("cspq");if(t)return(e=>{try{return Object($.decode)(e)}catch(e){console.error(e)}})(t)},te=e=>{const{push:t,replace:n}=Object(c.useHistory)(),{search:i,key:r}=Object(c.useLocation)(),s=Object(a.useMemo)((()=>({...e(),...ee(i)})),[e,i]),o=Object(a.useCallback)((n=>t({search:X({...e(),...s,...n})})),[e,s,t]);return Object(a.useEffect)((()=>{i||n({search:X(e())})}),[e,i,n]),{key:r,urlQuery:s,setUrlQuery:o}};var ne=n(27),ie=n(41);const re=e=>null!=e,ae=e=>!!e,se=(e,t="Unknown Error")=>e instanceof Error?e.message:"string"==typeof e?e:t,oe=({packagePolicyId:e,policyId:t})=>`${g.f}.attributes.package_policy_id: "${e}"${t?` AND ${g.f}.attributes.policy_id: "${t}"`:""}`;var ce=n(29);const ue={negate:!1},le=({filters:e,dataView:t,field:n,value:i,negate:r})=>{const a=t.getFieldByName(n);if(!a)return e;const s=Object(ce.buildFilter)(t,a,ce.FILTERS.PHRASE,r,!1,i,null,ce.FilterStateStore.APP_STATE);return[...e.filter((e=>!Object(ce.compareFilters)(e,s,ue))),s]},de=(e,t=[10,25,100],n=!0)=>({...e,pageSizeOptions:t,showPerPageOptions:n}),pe=e=>{const{data:{query:{filterManager:t,queryString:n}}}=Object(p.a)().services;return Object(a.useCallback)((()=>e({filters:t.getAppFilters(),query:n.getQuery()})),[e,t,n])},ge=({pageIndex:e,pageSize:t})=>({from:e*t,size:t}),fe=({dataView:e,filters:t,query:n})=>{const{notifications:{toasts:i},data:{query:{filterManager:r,queryString:s}}}=Object(p.a)().services,o=Object(a.useMemo)((()=>(({dataView:e,query:t,filters:n})=>{try{return{query:Object(ce.buildEsQuery)(e,t,n)}}catch(e){return{query:void 0,error:e instanceof Error?e:new Error("Unknown Error")}}})({dataView:e,filters:t,query:n})),[e,t,n]);return Object(a.useEffect)((()=>{r.setAppFilters(t),s.setQuery(n)}),[t,r,s,n]),Object(a.useEffect)((()=>{const e=o.error;e&&i.addError(e,{title:m.i18n.translate("xpack.csp.findings.search.queryErrorToastMessage",{defaultMessage:"Query Error"}),toastLifeTimeMs:5e3})}),[o.error,i]),o},be=({currentPageSize:e,pageIndex:t,pageSize:n})=>({pageStart:t*n+1,pageEnd:t*n+e}),je=e=>{const t=e.find((e=>"passed"===e.key)),n=e.find((e=>"failed"===e.key));return{passed:(null==t?void 0:t.doc_count)||0,failed:(null==n?void 0:n.doc_count)||0}},me=m.i18n.translate("xpack.csp.findings.findingsErrorToast.searchFailedTitle",{defaultMessage:"Search failed"}),xe=(e,t)=>{t instanceof Error?e.addError(t,{title:me}):e.addDanger(se(t,me))},he=({query:e,size:t,from:n,sort:i,pitId:r})=>({body:{query:e,sort:[{[i.field]:i.direction}],size:t,from:n,aggs:{count:{terms:{field:"result.evaluation"}}}},pit:{id:r},ignore_unavailable:!1}),ye=({query:e,from:t,size:n,pitId:i,sortDirection:r})=>({body:{query:e,size:0,aggs:{count:{terms:{field:"result.evaluation"}},resource_total:{cardinality:{field:"resource.id"}},resources:{terms:{field:"resource.id",size:6e4},aggs:{name:{terms:{field:"resource.name",size:1}},subtype:{terms:{field:"resource.sub_type",size:1}},benchmarkName:{terms:{field:"rule.benchmark.name"}},cis_sections:{terms:{field:"rule.section"}},failed_findings:{filter:{term:{"result.evaluation":"failed"}}},cluster_id:{terms:{field:"cluster_id",size:1}},sort_failed_findings:{bucket_sort:{from:t,size:n,sort:[{"failed_findings>_count":{order:r},_count:{order:"desc"},_key:{order:"asc"}}]}}}}},pit:{id:i}},ignore_unavailable:!1}),Oe=e=>{var t,n,i,r;if(!(Array.isArray(e.benchmarkName.buckets)&&Array.isArray(e.cis_sections.buckets)&&Array.isArray(e.name.buckets)&&Array.isArray(e.subtype.buckets)&&Array.isArray(e.cluster_id.buckets)&&e.benchmarkName.buckets.length&&e.cis_sections.buckets.length&&e.name.buckets.length&&e.subtype.buckets.length&&e.cluster_id.buckets.length))throw new Error("expected buckets to be an array");return{resource_id:e.key,"resource.name":null===(t=e.name.buckets[0])||void 0===t?void 0:t.key,"resource.sub_type":null===(n=e.subtype.buckets[0])||void 0===n?void 0:n.key,cluster_id:null===(i=e.cluster_id.buckets[0])||void 0===i?void 0:i.key,"rule.section":e.cis_sections.buckets.map((e=>e.key)),"rule.benchmark.name":null===(r=e.benchmarkName.buckets[0])||void 0===r?void 0:r.key,failed_findings:{count:e.failed_findings.doc_count,normalized:e.doc_count>0?e.failed_findings.doc_count/e.doc_count:0,total_findings:e.doc_count}}};var ve=n(30),Te=n.n(ve),ke=n(24);const Ie=/CIS ([0-9])(?:\.[0-9]\.?)?(?:[0-9])?/;var Ee=n(25),Se=n.n(Ee),Me=n(36);const we=({timestamp:e})=>Object(x.jsx)(b.EuiToolTip,{position:"top",content:Se()(e).format(Me.a)},Object(x.jsx)("span",null,Se()(e).fromNow())),Fe=({tooltipContent:e,columnName:t})=>Object(x.jsx)(b.EuiToolTip,{content:e},Object(x.jsx)(b.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},Object(x.jsx)(b.EuiFlexItem,null,Object(x.jsx)("span",null,t)),Object(x.jsx)(b.EuiFlexItem,null,Object(x.jsx)(b.EuiIcon,{size:"m",color:"subdued",type:"questionInCircle"})))),_e=e=>"passed"===e?"success":"failed"===e?"danger":"default",Ce=({type:e})=>Object(x.jsx)(b.EuiBadge,{color:_e(e),style:{width:46,textAlign:"center"}},"failed"===e?Object(x.jsx)(j.FormattedMessage,{id:"xpack.csp.cspEvaluationBadge.failLabel",defaultMessage:"Fail"}):Object(x.jsx)(j.FormattedMessage,{id:"xpack.csp.cspEvaluationBadge.passLabel",defaultMessage:"Pass"})),Le=({children:e})=>Object(x.jsx)(b.EuiTitle,{size:"l"},Object(x.jsx)("div",null,e,Object(x.jsx)(b.EuiSpacer,null))),Ne=({title:e})=>Object(x.jsx)("h2",null,e),ze=({onClick:e})=>({width:"40px",actions:[{name:m.i18n.translate("xpack.csp.expandColumnNameLabel",{defaultMessage:"Expand"}),description:m.i18n.translate("xpack.csp.expandColumnDescriptionLabel",{defaultMessage:"Expand"}),type:"icon",icon:"expand",onClick:e}]}),Pe=[{field:"resource.id",name:Object(x.jsx)(Fe,{columnName:m.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.resourceIdColumnLabel",{defaultMessage:"Resource ID"}),tooltipContent:m.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.resourceIdColumnTooltipLabel",{defaultMessage:"Custom Elastic Resource ID"})}),truncateText:!0,width:"150px",sortable:!0,render:e=>Object(x.jsx)(b.EuiToolTip,{position:"top",content:e,anchorClassName:"eui-textTruncate"},Object(x.jsx)("span",null,e))},{field:"result.evaluation",name:m.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.resultColumnLabel",{defaultMessage:"Result"}),width:"120px",sortable:!0,render:e=>Object(x.jsx)(Ce,{type:e})},{field:"resource.sub_type",name:m.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.resourceTypeColumnLabel",{defaultMessage:"Resource Type"}),sortable:!0,truncateText:!0,width:"10%"},{field:"resource.name",name:m.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.resourceNameColumnLabel",{defaultMessage:"Resource Name"}),sortable:!0,truncateText:!0,render:e=>Object(x.jsx)(b.EuiToolTip,{content:e,position:"left",anchorClassName:"eui-textTruncate"},Object(x.jsx)(s.a.Fragment,null,e))},{field:"rule.name",name:m.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.ruleColumnLabel",{defaultMessage:"Rule"}),sortable:!0,render:e=>Object(x.jsx)(b.EuiToolTip,{content:e,position:"left",anchorClassName:"eui-textTruncate"},Object(x.jsx)(s.a.Fragment,null,e))},{field:"rule.benchmark.name",name:m.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.ruleBenchmarkColumnLabel",{defaultMessage:"Benchmark"}),width:"10%",sortable:!0,truncateText:!0},{field:"rule.section",name:m.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.ruleSectionColumnLabel",{defaultMessage:"CIS Section"}),width:"7%",sortable:!0,truncateText:!0,render:e=>Object(x.jsx)(b.EuiToolTip,{content:e,anchorClassName:"eui-textTruncate"},Object(x.jsx)(s.a.Fragment,null,e))},{field:"rule.tags",name:m.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.ruleTagsColumnLabel",{defaultMessage:"Rule Tags"}),width:"15%",sortable:!1,truncateText:!0,render:e=>(e=>e.reduce(((e,t)=>(((e=>"Kubernetes"===e||"EKS"===e)(t)||(e=>Ie.test(e))(t))&&e.push(t),e)),[]))(e).map((e=>Object(x.jsx)(b.EuiBadge,{key:e},e)))},{field:"cluster_id",name:Object(x.jsx)(Fe,{columnName:m.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.clusterIdColumnLabel",{defaultMessage:"Cluster ID"}),tooltipContent:m.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.clusterIdColumnTooltipLabel",{defaultMessage:"Kube-System Namespace ID"})}),width:"150px",sortable:!0,truncateText:!0,render:e=>Object(x.jsx)(b.EuiToolTip,{content:e,anchorClassName:"eui-textTruncate"},Object(x.jsx)(s.a.Fragment,null,e))},{field:"@timestamp",width:"10%",name:m.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.lastCheckedColumnLabel",{defaultMessage:"Last Checked"}),truncateText:!0,sortable:!0,render:e=>Object(x.jsx)(we,{timestamp:e})}],Ae=Object.fromEntries(Pe.map((e=>[e.field,e]))),Re=(e,{onAddFilter:t})=>({...e,render:(n,i)=>{var r;return Object(x.jsx)(Ue,{onAddFilter:()=>t(e.field,n,!1),onAddNegateFilter:()=>t(e.field,n,!0),field:e.field},(null===(r=e.render)||void 0===r?void 0:r.call(e,n,i))||De(n))}}),De=e=>{if(e)return"string"==typeof e||"number"==typeof e?e:void 0};var Be={name:"1w3lhpq",styles:"opacity:0;position:absolute;right:0;top:0;display:flex"};const Ue=({children:e,onAddFilter:t,onAddNegateFilter:n,field:i})=>Object(x.jsx)("div",{css:Object(x.css)("position:relative;width:100%;&:hover{>.__filter_buttons{opacity:1;}>.__filter_value{max-width:calc(100% - calc(",ke.euiThemeVars.euiSizeL," * 2));}}","")},Object(x.jsx)("div",{className:"__filter_value eui-textTruncate"},e),Object(x.jsx)("div",{className:"__filter_buttons",css:Be},Object(x.jsx)(b.EuiButtonIcon,{iconType:"plusInCircleFilled",onClick:t,"data-test-subj":"findings_table_cell_add_filter","aria-label":m.i18n.translate("xpack.csp.findings.findingsTableCell.addFilterButton",{defaultMessage:"Add {field} filter",values:{field:i}})}),Object(x.jsx)(b.EuiButtonIcon,{iconType:"minusInCircleFilled",onClick:n,"data-test-subj":"findings_table_cell_add_negated_filter","aria-label":m.i18n.translate("xpack.csp.findings.findingsTableCell.addNegateFilterButton",{defaultMessage:"Add {field} negated filter",values:{field:i}})}))),Ve=({items:e,loading:t,pagination:n,sorting:i,setTableOptions:r,onAddFilter:s})=>{const o=Object(a.useMemo)((()=>[We.resource_id,Re(We["resource.sub_type"],{onAddFilter:s}),Re(We["resource.name"],{onAddFilter:s}),Re(We["rule.benchmark.name"],{onAddFilter:s}),We["rule.section"],Re(We.cluster_id,{onAddFilter:s}),We.failed_findings]),[s]);return t||e.length?Object(x.jsx)(b.EuiBasicTable,{loading:t,items:e,columns:o,rowProps:e=>{return{"data-test-subj":(n=e,t=[n.resource_id,...n["rule.section"]].join("/"),`findings_resource_table_row_${t}`)};var t,n},pagination:n,sorting:i,onChange:r}):Object(x.jsx)(b.EuiEmptyPrompt,{"data-test-subj":"findings-by-resource-table-no-findings-empty-state",iconType:"logoKibana",title:Object(x.jsx)("h2",null,Object(x.jsx)(j.FormattedMessage,{id:"xpack.csp.findings.findingsByResource.noFindingsTitle",defaultMessage:"There are no Findings"}))})},qe=[{...Ae["resource.id"],field:"resource_id",render:e=>Object(x.jsx)(c.Link,{to:Object(c.generatePath)(d.c.resource_findings.path,{resourceId:e}),className:"eui-textTruncate",title:e},e)},Ae["resource.sub_type"],Ae["resource.name"],Ae["rule.benchmark.name"],{field:"rule.section",truncateText:!0,name:Object(x.jsx)(j.FormattedMessage,{id:"xpack.csp.findings.findingsByResourceTable.cisSectionsColumnLabel",defaultMessage:"CIS Sections"}),render:e=>{const t=e.join(", ");return Object(x.jsx)(b.EuiToolTip,{content:t,anchorClassName:"eui-textTruncate"},Object(x.jsx)(s.a.Fragment,null,t))}},Ae.cluster_id,{field:"failed_findings",width:"150px",truncateText:!0,sortable:!0,name:Object(x.jsx)(j.FormattedMessage,{id:"xpack.csp.findings.findingsByResourceTable.failedFindingsColumnLabel",defaultMessage:"Failed Findings"}),render:e=>{return Object(x.jsx)(b.EuiToolTip,{content:m.i18n.translate("xpack.csp.findings.findingsByResourceTable.failedFindingsToolTip",{defaultMessage:"{failed} out of {total}",values:{failed:e.count,total:e.total_findings}})},Object(x.jsx)(s.a.Fragment,null,Object(x.jsx)(b.EuiTextColor,{color:0===e.count?"":"danger"},(t=e.count)<1e3?t:Te()(t).format("0.0a")),Object(x.jsx)("span",null," (",Te()(e.normalized).format("0%"),")")));var t},dataType:"number"}],We=Object.fromEntries(qe.map((e=>[e.field,e]))),Qe=s.a.memo(Ve),Ge=()=>[{value:"default",label:m.i18n.translate("xpack.csp.findings.groupBySelector.groupByNoneLabel",{defaultMessage:"None"})},{value:"resource",label:m.i18n.translate("xpack.csp.findings.groupBySelector.groupByResourceIdLabel",{defaultMessage:"Resource"})}],Ye=e=>{const[t]=e;return"resource"===(null==t?void 0:t.value)?d.c.findings_by_resource.path:d.c.findings_default.path},He=({type:e})=>{const t=Object(a.useMemo)(Ge,[]),n=Object(c.useHistory)();return g.h.showFindingsGroupBy?Object(x.jsx)("div",null,Object(x.jsx)(b.EuiComboBox,{prepend:Object(x.jsx)(Ke,null),singleSelection:{asPlainText:!0},options:t,selectedOptions:t.filter((t=>t.value===e)),onChange:e=>n.push({pathname:Ye(e)})}),Object(x.jsx)(b.EuiSpacer,null)):null},Ke=()=>Object(x.jsx)(b.EuiFormLabel,null,Object(x.jsx)(j.FormattedMessage,{id:"xpack.csp.findings.groupBySelector.groupByLabel",defaultMessage:"Group by"})),Je="1rem",Ze=({listItems:e})=>{const{euiTheme:t}=Object(b.useEuiTheme)(),n=(e=>null==e?void 0:e.filter((e=>!(null==e||!e.title||null==e||!e.description))).map((e=>({...e,title:`${e.title}:`}))))(e);return Object(x.jsx)(b.EuiDescriptionList,{type:"inline",titleProps:{style:{background:"initial",color:t.colors.subduedText,fontSize:Je,paddingRight:0}},descriptionProps:{style:{color:t.colors.subduedText,marginRight:t.size.xs,fontSize:Je}},listItems:n})},$e=({query:e,resourceId:t,from:n,size:i,pitId:r,sort:a})=>{var s;return{body:{from:n,size:i,query:{...e,bool:{...null==e?void 0:e.bool,filter:[...(null==e||null===(s=e.bool)||void 0===s?void 0:s.filter)||[],{term:{"resource.id":t}}]}},sort:[{[a.field]:a.direction}],pit:{id:r},aggs:{count:{terms:{field:"result.evaluation"}},clusterId:{terms:{field:"cluster_id"}},resourceSubType:{terms:{field:"resource.sub_type"}},resourceName:{terms:{field:"resource.name"}}}},ignore_unavailable:!1}};function Xe(e){if(!Array.isArray(e)||0===e.length)throw new Error("expected a non empty array")}const et=e=>e[0].key;var tt=n(31),nt=n(46),it=n.n(nt);const rt=e=>void 0===e?"undefined":"boolean"==typeof e||null===e?Object(x.jsx)(b.EuiCode,null,JSON.stringify(e)):"object"==typeof e?Object(x.jsx)(b.EuiCodeBlock,{isCopyable:!0,overflowHeight:300},JSON.stringify(e,null,2)):Object(x.jsx)(b.EuiText,{size:"s"},e),at=e=>Object.entries(Object(tt.getFlattenedObject)(e)).sort(((e,t)=>e[0].localeCompare(t[0]))).map((([e,t])=>({title:Object(x.jsx)(b.EuiText,{size:"s"},Object(x.jsx)("strong",null,e)),description:rt(t)}))),st=({data:e})=>{const{euiTheme:t}=Object(b.useEuiTheme)(),n=Object(a.useMemo)((()=>[{title:m.i18n.translate("xpack.csp.findings.findingsFlyout.resourceTab.resourceAccordionTitle",{defaultMessage:"Resource"}),id:"resourceAccordion",listItems:at(e.resource)},{title:m.i18n.translate("xpack.csp.findings.findingsFlyout.resourceTab.hostAccordionTitle",{defaultMessage:"Host"}),id:"hostAccordion",listItems:at(e.host)}]),[e.host,e.resource]);return Object(x.jsx)(s.a.Fragment,null,n.map((e=>Object(x.jsx)(s.a.Fragment,{key:e.id},Object(x.jsx)(b.EuiPanel,{hasShadow:!1,hasBorder:!0},Object(x.jsx)(b.EuiAccordion,{id:e.id,buttonContent:Object(x.jsx)(b.EuiText,null,Object(x.jsx)("strong",null,e.title)),arrowDisplay:"left",initialIsOpen:!0},Object(x.jsx)(b.EuiDescriptionList,{listItems:e.listItems,type:"column",style:{marginTop:t.size.l},titleProps:{style:{width:"35%"}},descriptionProps:{style:{width:"65%"}}}))),Object(x.jsx)(b.EuiSpacer,{size:"m"})))))};var ot=n(33);const ct=({data:e})=>Object(x.jsx)("div",{style:{position:"absolute",inset:0,top:120}},Object(x.jsx)(k.CodeEditor,{isCopyable:!0,allowFullScreen:!0,languageId:ot.XJsonLang.ID,value:JSON.stringify(e,null,2),options:{readOnly:!0,lineNumbers:"on",folding:!0}})),ut=(e,t)=>[{title:m.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTab.ruleNameTitle",{defaultMessage:"Rule Name"}),description:e.rule.name},{title:m.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTab.ruleTagsTitle",{defaultMessage:"Rule Tags"}),description:Object(x.jsx)(s.a.Fragment,null,e.rule.tags.map((e=>Object(x.jsx)(b.EuiBadge,null,e))))},{title:m.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTab.evaluatedAtTitle",{defaultMessage:"Evaluated at"}),description:Se()(e["@timestamp"]).format(Me.a)},{title:m.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTab.resourceIdTitle",{defaultMessage:"Resource ID"}),description:e.resource.id},{title:m.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTab.resourceNameTitle",{defaultMessage:"Resource Name"}),description:e.resource.name},{title:m.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTab.frameworkSourcesTitle",{defaultMessage:"Framework Sources"}),description:Object(x.jsx)(kt,{benchmarkId:e.rule.benchmark.id,benchmarkName:e.rule.benchmark.name})},{title:m.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTab.cisSectionTitle",{defaultMessage:"CIS Section"}),description:e.rule.section},{title:m.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTab.indexTitle",{defaultMessage:"Index"}),description:t?Object(x.jsx)(b.EuiLink,{href:t},g.i):g.i}],lt=e=>[{title:"",description:Object(x.jsx)(Tt,null,e.remediation)},...e.impact?[{title:m.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTab.impactTitle",{defaultMessage:"Impact"}),description:Object(x.jsx)(Tt,null,e.impact)}]:[],...e.default_value?[{title:m.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTab.defaultValueTitle",{defaultMessage:"Default Value"}),description:Object(x.jsx)(Tt,null,e.default_value)}]:[],{title:m.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTab.rationaleTitle",{defaultMessage:"Rationale"}),description:Object(x.jsx)(Tt,null,e.rationale)}],dt=({result:e})=>[e.expected&&{title:m.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTab.expectedTitle",{defaultMessage:"Expected"}),description:Object(x.jsx)(vt,null,JSON.stringify(e.expected,null,2))},{title:m.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTab.actualTitle",{defaultMessage:"Actual"}),description:Object(x.jsx)(vt,null,JSON.stringify(e.evidence,null,2))}].filter(ae),pt=({data:e})=>{var t;const{services:{discover:n}}=Object(p.a)(),i=W(),r=Object(a.useMemo)((()=>{var e,t;return null===(e=n.locator)||void 0===e?void 0:e.getRedirectUrl({indexPatternId:null===(t=i.data)||void 0===t?void 0:t.id})}),[n.locator,null===(t=i.data)||void 0===t?void 0:t.id]),o=Object(a.useMemo)((()=>[{initialIsOpen:!0,title:m.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTab.detailsTitle",{defaultMessage:"Details"}),id:"detailsAccordion",listItems:ut(e,r)},{initialIsOpen:!0,title:m.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTab.remediationTitle",{defaultMessage:"Remediation"}),id:"remediationAccordion",listItems:lt(e.rule)},g.h.showFindingFlyoutEvidence&&{initialIsOpen:!1,title:m.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTab.evidenceSourcesTitle",{defaultMessage:"Evidence"}),id:"evidenceAccordion",listItems:dt(e)}].filter(ae)),[e,r]);return Object(x.jsx)(s.a.Fragment,null,o.map((e=>Object(x.jsx)(s.a.Fragment,{key:e.id},Object(x.jsx)(b.EuiPanel,{hasShadow:!1,hasBorder:!0},Object(x.jsx)(b.EuiAccordion,{id:e.id,buttonContent:Object(x.jsx)(b.EuiText,null,Object(x.jsx)("strong",null,e.title)),arrowDisplay:"left",initialIsOpen:e.initialIsOpen},Object(x.jsx)(b.EuiSpacer,{size:"m"}),Object(x.jsx)(b.EuiDescriptionList,{listItems:e.listItems}))),Object(x.jsx)(b.EuiSpacer,{size:"m"})))))},gt=e=>[{title:m.i18n.translate("xpack.csp.findings.findingsFlyout.ruleTab.nameTitle",{defaultMessage:"Name"}),description:e.name},{title:m.i18n.translate("xpack.csp.findings.findingsFlyout.ruleTab.descriptionTitle",{defaultMessage:"Description"}),description:Object(x.jsx)(Tt,null,e.description)},{title:m.i18n.translate("xpack.csp.findings.findingsFlyout.ruleTab.tagsTitle",{defaultMessage:"Tags"}),description:Object(x.jsx)(s.a.Fragment,null,e.tags.map((e=>Object(x.jsx)(b.EuiBadge,null,e))))},{title:m.i18n.translate("xpack.csp.findings.findingsFlyout.ruleTab.frameworkSourcesTitle",{defaultMessage:"Framework Sources"}),description:Object(x.jsx)(kt,{benchmarkId:e.benchmark.id,benchmarkName:e.benchmark.name})},{title:m.i18n.translate("xpack.csp.findings.findingsFlyout.ruleTab.cisSectionTitle",{defaultMessage:"CIS Section"}),description:e.section},{title:m.i18n.translate("xpack.csp.findings.findingsFlyout.ruleTab.profileApplicabilityTitle",{defaultMessage:"Profile Applicability"}),description:Object(x.jsx)(Tt,null,e.profile_applicability)},{title:m.i18n.translate("xpack.csp.findings.findingsFlyout.ruleTab.benchmarkTitle",{defaultMessage:"Benchmark"}),description:e.benchmark.name},{title:m.i18n.translate("xpack.csp.findings.findingsFlyout.ruleTab.auditTitle",{defaultMessage:"Audit"}),description:Object(x.jsx)(Tt,null,e.audit)},...e.references?[{title:m.i18n.translate("xpack.csp.findings.findingsFlyout.ruleTab.referencesTitle",{defaultMessage:"References"}),description:Object(x.jsx)(Tt,null,e.references)}]:[]],ft=({data:e})=>Object(x.jsx)(b.EuiDescriptionList,{listItems:gt(e.rule)});var bt=n(47),jt=n.n(bt),mt=n(48),xt=n.n(mt);const ht=e=>"cis_eks"===e.type?xt.a:jt.a,yt=e=>Object(x.jsx)(b.EuiToolTip,{content:e.name},Object(x.jsx)(b.EuiIcon,{type:ht(e),size:"xl",css:e.style})),Ot=[{id:"overview",title:m.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTabTitle",{defaultMessage:"Overview"})},{id:"rule",title:m.i18n.translate("xpack.csp.findings.findingsFlyout.ruleTabTitle",{defaultMessage:"Rule"})},{id:"resource",title:m.i18n.translate("xpack.csp.findings.findingsFlyout.resourceTabTitle",{defaultMessage:"Resource"})},{id:"json",title:m.i18n.translate("xpack.csp.findings.findingsFlyout.jsonTabTitle",{defaultMessage:"JSON"})}],vt=e=>Object(x.jsx)(b.EuiCodeBlock,r()({isCopyable:!0,paddingSize:"s",overflowHeight:300},e)),Tt=e=>Object(x.jsx)(b.EuiMarkdownFormat,r()({textSize:"s"},e)),kt=({benchmarkId:e,benchmarkName:t})=>Object(x.jsx)(b.EuiFlexGroup,{gutterSize:"s"},Object(x.jsx)(b.EuiFlexItem,{grow:!1},Object(x.jsx)(b.EuiIcon,{type:it.a,size:"xxl"})),Object(x.jsx)(b.EuiFlexItem,{grow:!1},Object(x.jsx)(yt,{type:e,name:t}))),It=({tab:e,findings:t})=>{switch(e.id){case"overview":return Object(x.jsx)(pt,{data:t});case"rule":return Object(x.jsx)(ft,{data:t});case"resource":return Object(x.jsx)(st,{data:t});case"json":return Object(x.jsx)(ct,{data:t});default:Object(tt.assertNever)(e)}},Et=({onClose:e,findings:t})=>{const[n,i]=Object(a.useState)(Ot[0]);return Object(x.jsx)(b.EuiFlyout,{ownFocus:!1,onClose:e},Object(x.jsx)(b.EuiFlyoutHeader,null,Object(x.jsx)(b.EuiFlexGroup,{alignItems:"center"},Object(x.jsx)(b.EuiFlexItem,{grow:!1},Object(x.jsx)(Ce,{type:t.result.evaluation})),Object(x.jsx)(b.EuiFlexItem,{grow:!0,style:{minWidth:0}},Object(x.jsx)(b.EuiTitle,{size:"m",className:"eui-textTruncate"},Object(x.jsx)(b.EuiTextColor,{color:"primary",title:t.rule.name},t.rule.name)))),Object(x.jsx)(b.EuiSpacer,null),Object(x.jsx)(b.EuiTabs,null,Ot.map((e=>Object(x.jsx)(b.EuiTab,{key:e.id,isSelected:n.id===e.id,onClick:()=>i(e)},e.title))))),Object(x.jsx)(b.EuiFlyoutBody,{key:n.id},Object(x.jsx)(It,{tab:n,findings:t})))},St=({items:e,loading:t,pagination:n,sorting:i,setTableOptions:r,onAddFilter:o})=>{const[c,u]=Object(a.useState)(),l=Object(a.useMemo)((()=>[ze({onClick:u}),Re(Ae["result.evaluation"],{onAddFilter:o}),Re(Ae["rule.name"],{onAddFilter:o}),Re(Ae["rule.benchmark.name"],{onAddFilter:o}),Ae["rule.section"],Ae["rule.tags"],Ae["@timestamp"]]),[o]);return t||e.length?Object(x.jsx)(s.a.Fragment,null,Object(x.jsx)(b.EuiBasicTable,{loading:t,items:e,columns:l,onChange:r,pagination:n,sorting:i}),c&&Object(x.jsx)(Et,{findings:c,onClose:()=>u(void 0)})):Object(x.jsx)(b.EuiEmptyPrompt,{iconType:"logoKibana",title:Object(x.jsx)("h2",null,Object(x.jsx)(j.FormattedMessage,{id:"xpack.csp.findings.resourceFindings.noFindingsTitle",defaultMessage:"There are no Findings"}))})},Mt=s.a.memo(St),wt=({error:e})=>{const{data:{search:t}}=Object(p.a)().services;return Object(x.jsx)(b.EuiFlexGroup,{justifyContent:"center",alignItems:"center"},Object(x.jsx)(b.EuiFlexItem,{grow:!1},Object(x.jsx)(b.EuiPanel,{paddingSize:"l",grow:!0},Object(x.jsx)(b.EuiCallOut,{title:m.i18n.translate("xpack.csp.findings.errorCallout.pageSearchErrorTitle",{defaultMessage:"We encountered an error retrieving search results"}),color:"danger",iconType:"alert"},Object(x.jsx)(b.EuiSpacer,null),Object(x.jsx)(b.EuiButton,{size:"s",color:"danger",onClick:()=>t.showError(e)},Object(x.jsx)(j.FormattedMessage,{id:"xpack.csp.findings.errorCallout.showErrorButtonLabel",defaultMessage:"Show error message"}))))))},Ft=e=>e<1e3?e:Te()(e).format("0.0a"),_t=e=>Object(x.jsx)("div",null,Object(x.jsx)(Lt,e),Object(x.jsx)(b.EuiSpacer,{size:"s"}),Object(x.jsx)(Pt,e));var Ct={name:"1kx2ysr",styles:"align-items:flex-end"};const Lt=e=>Object(x.jsx)(b.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(x.jsx)(b.EuiFlexItem,null,Object(x.jsx)(zt,e)),Object(x.jsx)(b.EuiFlexItem,{grow:1,css:Ct},Object(x.jsx)(Nt,e))),Nt=({passed:e,failed:t})=>{const{euiTheme:n}=Object(b.useEuiTheme)();return Object(x.jsx)("div",{css:Object(x.css)("display:grid;grid-template-columns:auto auto;grid-column-gap:",n.size.m,";","")},Object(x.jsx)(Rt,{label:m.i18n.translate("xpack.csp.findings.distributionBar.totalPassedLabel",{defaultMessage:"Passed Findings"}),color:n.colors.success,value:e}),Object(x.jsx)(Rt,{label:m.i18n.translate("xpack.csp.findings.distributionBar.totalFailedLabel",{defaultMessage:"Failed Findings"}),color:n.colors.danger,value:t}))},zt=({pageEnd:e,pageStart:t,total:n,type:i})=>Object(x.jsx)(b.EuiTextColor,{color:"subdued"},Object(x.jsx)(j.FormattedMessage,{id:"xpack.csp.findings.distributionBar.showingPageOfTotalLabel",defaultMessage:"Showing {pageStart}-{pageEnd} of {total} {type}",values:{pageStart:Object(x.jsx)("b",null,t),pageEnd:Object(x.jsx)("b",null,e),total:Object(x.jsx)("b",null,Ft(n)),type:i}})),Pt=({passed:e,failed:t,distributionOnClick:n})=>{const{euiTheme:i}=Object(b.useEuiTheme)();return Object(x.jsx)(b.EuiFlexGroup,{gutterSize:"none",css:Object(x.css)("height:8px;background:",i.colors.subduedText,";","")},Object(x.jsx)(At,{value:e,color:i.colors.success,distributionOnClick:()=>{n(g.p)}}),Object(x.jsx)(At,{value:t,color:i.colors.danger,distributionOnClick:()=>{n(g.o)}}))},At=({value:e,color:t,distributionOnClick:n})=>Object(x.jsx)("button",{onClick:n,css:Object(x.css)("flex:",e,";background:",t,";height:100%;","")}),Rt=({label:e,value:t,color:n})=>Object(x.jsx)(b.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},Object(x.jsx)(b.EuiFlexItem,{grow:1},Object(x.jsx)(b.EuiHealth,{color:n},e)),Object(x.jsx)(b.EuiFlexItem,{grow:!1},Object(x.jsx)(b.EuiBadge,null,Ft(t)))),Dt=({query:e,filters:t})=>({query:e,filters:t,sort:{field:"result.evaluation",direction:"asc"},pageIndex:0,pageSize:10}),Bt=()=>Object(x.jsx)(c.Link,{to:Object(c.generatePath)(d.c.findings_by_resource.path)},Object(x.jsx)(b.EuiButtonEmpty,{iconType:"arrowLeft"},Object(x.jsx)(j.FormattedMessage,{id:"xpack.csp.findings.resourceFindings.backToResourcesPageButtonLabel",defaultMessage:"Back to group by resource view"}))),Ut=({dataView:e})=>{var t,n,i;const u=Object(c.useParams)(),l=pe(Dt),{urlQuery:d,setUrlQuery:f}=te(l),[j,h]=G()(g.m,d.pageSize),y=fe({dataView:e,filters:d.filters,query:d.query}),O=(e=>{const{data:t,notifications:{toasts:n}}=Object(p.a)().services,{pitIdRef:i,setPitId:r}=Object(a.useContext)(q),s={...e,pitId:i.current};return Object(o.useQuery)(["csp_resource_findings",{params:s}],(()=>Object(ne.lastValueFrom)(t.search.search({params:$e(s)}))),{enabled:e.enabled,keepPreviousData:!0,select:({rawResponse:{hits:e,pit_id:t,aggregations:n}})=>{if(!n)throw new Error("expected aggregations to exists");return Xe(n.count.buckets),Xe(n.clusterId.buckets),Xe(n.resourceSubType.buckets),Xe(n.resourceName.buckets),{page:e.hits.map((e=>e._source)),total:ie.number.is(e.total)?e.total:0,count:je(n.count.buckets),clusterId:et(n.clusterId.buckets),resourceSubType:et(n.resourceSubType.buckets),resourceName:et(n.resourceName.buckets),newPitId:t}},onError:e=>xe(n,e),onSuccess:({newPitId:e})=>{r(e)},refetchInterval:V,refetchIntervalInBackground:!0})})({...ge({pageSize:j||d.pageSize,pageIndex:d.pageIndex}),sort:d.sort,query:y.query,resourceId:u.resourceId,enabled:!y.error}),v=O.error||y.error;return Object(x.jsx)("div",{"data-test-subj":K},Object(x.jsx)(J,{dataView:e,setQuery:e=>{f({...e,pageIndex:0})},loading:O.isFetching}),Object(x.jsx)(Le,null,Object(x.jsx)(Bt,null),Object(x.jsx)(Ne,{title:Object(x.jsx)(Y,{title:m.i18n.translate("xpack.csp.findings.resourceFindings.resourceFindingsPageTitle",{defaultMessage:"{resourceName} - Findings",values:{resourceName:null===(t=O.data)||void 0===t?void 0:t.resourceName}})})})),Object(x.jsx)(b.EuiPageHeader,{description:O.data&&Object(x.jsx)(Ze,{listItems:(T={resourceId:u.resourceId,resourceName:O.data.resourceName,resourceSubType:O.data.resourceSubType,clusterId:O.data.clusterId},[{title:m.i18n.translate("xpack.csp.findings.resourceFindingsSharedValues.resourceTypeTitle",{defaultMessage:"Resource Type"}),description:T.resourceSubType},{title:m.i18n.translate("xpack.csp.findings.resourceFindingsSharedValues.resourceIdTitle",{defaultMessage:"Resource ID"}),description:T.resourceId},{title:m.i18n.translate("xpack.csp.findings.resourceFindingsSharedValues.clusterIdTitle",{defaultMessage:"Cluster ID"}),description:T.clusterId}])})}),Object(x.jsx)(b.EuiSpacer,null),v&&Object(x.jsx)(wt,{error:v}),!v&&Object(x.jsx)(s.a.Fragment,null,O.isSuccess&&!!O.data.page.length&&Object(x.jsx)(_t,r()({distributionOnClick:t=>{f({pageIndex:0,filters:le({filters:d.filters,dataView:e,field:"result.evaluation",value:t,negate:!1})})},type:m.i18n.translate("xpack.csp.findings.resourceFindings.tableRowTypeLabel",{defaultMessage:"Findings"}),total:O.data.total,passed:O.data.count.passed,failed:O.data.count.failed},be({pageIndex:d.pageIndex,pageSize:d.pageSize,currentPageSize:O.data.page.length}))),Object(x.jsx)(b.EuiSpacer,null),Object(x.jsx)(Mt,{loading:O.isFetching,items:(null===(n=O.data)||void 0===n?void 0:n.page)||[],pagination:de({pageSize:j||d.pageSize,pageIndex:d.pageIndex,totalItemCount:(null===(i=O.data)||void 0===i?void 0:i.total)||0}),sorting:{sort:{field:d.sort.field,direction:d.sort.direction}},setTableOptions:({page:e,sort:t})=>{h(e.size),f({pageIndex:e.index,pageSize:e.size,sort:t})},onAddFilter:(t,n,i)=>f({pageIndex:0,filters:le({filters:d.filters,dataView:e,field:t,value:n,negate:i})})})));var T},Vt=({query:e,filters:t})=>({query:e,filters:t,pageIndex:0,pageSize:10,sortDirection:"desc"}),qt=({dataView:e})=>Object(x.jsx)(c.Switch,null,Object(x.jsx)(c.Route,{exact:!0,path:d.c.findings_by_resource.path,render:()=>Object(x.jsx)(u.TrackApplicationView,{viewId:d.c.findings_by_resource.id},Object(x.jsx)(Wt,{dataView:e}))}),Object(x.jsx)(c.Route,{path:d.c.resource_findings.path,render:()=>Object(x.jsx)(u.TrackApplicationView,{viewId:d.c.resource_findings.id},Object(x.jsx)(Ut,{dataView:e}))})),Wt=({dataView:e})=>{var t,n;const i=pe(Vt),{urlQuery:c,setUrlQuery:u}=te(i),[l,d]=G()(g.k,c.pageSize),f=fe({dataView:e,filters:c.filters,query:c.query}),j=(e=>{const{data:t,notifications:{toasts:n}}=Object(p.a)().services,{pitIdRef:i,setPitId:r}=Object(a.useContext)(q),s={...e,pitId:i.current};return Object(o.useQuery)(["csp_findings_resource",{params:s}],(async()=>{const{rawResponse:{aggregations:e,pit_id:n}}=await Object(ne.lastValueFrom)(t.search.search({params:ye(s)}));if(!e)throw new Error("expected aggregations to be defined");if(!Array.isArray(e.resources.buckets)||!Array.isArray(e.count.buckets))throw new Error("expected buckets to be an array");return{page:e.resources.buckets.map(Oe),total:e.resource_total.value,count:je(e.count.buckets),newPitId:n}}),{enabled:e.enabled,keepPreviousData:!0,onError:e=>xe(n,e),onSuccess:({newPitId:e})=>{r(e)},refetchInterval:V,refetchIntervalInBackground:!0})})({...ge({pageIndex:c.pageIndex,pageSize:l||c.pageSize}),sortDirection:c.sortDirection,query:f.query,enabled:!f.error}),h=j.error||f.error;return Object(x.jsx)("div",{"data-test-subj":K},Object(x.jsx)(J,{dataView:e,setQuery:e=>{u({...e,pageIndex:0})},loading:j.isFetching}),Object(x.jsx)(b.EuiFlexGroup,null,Object(x.jsx)(b.EuiFlexItem,null,Object(x.jsx)(Le,null,Object(x.jsx)(Ne,{title:Object(x.jsx)(Y,{title:m.i18n.translate("xpack.csp.findings.findingsByResource.findingsByResourcePageTitle",{defaultMessage:"Findings"})})}))),Object(x.jsx)(b.EuiFlexItem,{grow:!1,style:{width:400}},!h&&Object(x.jsx)(He,{type:"resource"}))),h&&Object(x.jsx)(wt,{error:h}),!h&&Object(x.jsx)(s.a.Fragment,null,j.isSuccess&&!!j.data.page.length&&Object(x.jsx)(_t,r()({distributionOnClick:t=>{u({pageIndex:0,filters:le({filters:c.filters,dataView:e,field:"result.evaluation",value:t,negate:!1})})},type:m.i18n.translate("xpack.csp.findings.findingsByResource.tableRowTypeLabel",{defaultMessage:"Resources"}),total:j.data.total,passed:j.data.count.passed,failed:j.data.count.failed},be({pageIndex:c.pageIndex,pageSize:c.pageSize,currentPageSize:j.data.page.length}))),Object(x.jsx)(b.EuiSpacer,null),Object(x.jsx)(Qe,{loading:j.isFetching,items:(null===(t=j.data)||void 0===t?void 0:t.page)||[],pagination:de({pageSize:l||c.pageSize,pageIndex:c.pageIndex,totalItemCount:(null===(n=j.data)||void 0===n?void 0:n.total)||0}),setTableOptions:({sort:e,page:t})=>{d(t.size),u({sortDirection:null==e?void 0:e.direction,pageIndex:t.index,pageSize:t.size})},sorting:{sort:{field:"failed_findings",direction:c.sortDirection}},onAddFilter:(t,n,i)=>u({pageIndex:0,filters:le({filters:c.filters,dataView:e,field:t,value:n,negate:i})})})))},Qt=({loading:e,items:t,pagination:n,sorting:i,setTableOptions:r,onAddFilter:o})=>{const[c,u]=Object(a.useState)(),l=Object(a.useMemo)((()=>[ze({onClick:u}),Re(Ae["resource.id"],{onAddFilter:o}),Re(Ae["result.evaluation"],{onAddFilter:o}),Re(Ae["resource.sub_type"],{onAddFilter:o}),Re(Ae["resource.name"],{onAddFilter:o}),Re(Ae["rule.name"],{onAddFilter:o}),Re(Ae["rule.benchmark.name"],{onAddFilter:o}),Ae["rule.section"],Ae["rule.tags"],Re(Ae.cluster_id,{onAddFilter:o}),Ae["@timestamp"]]),[o]);return e||t.length?Object(x.jsx)(s.a.Fragment,null,Object(x.jsx)(b.EuiBasicTable,{loading:e,"data-test-subj":"findings_table",items:t,columns:l,pagination:n,sorting:i,onChange:r,rowProps:e=>{return{"data-test-subj":(t=e.resource.id,`findings_table_row_${t}`)};var t},cellProps:(e,t)=>{return{"data-test-subj":(n=t.field,i=e.resource.id,`findings_table_cell_${n}_${i}`)};var n,i},hasActions:!0}),c&&Object(x.jsx)(Et,{findings:c,onClose:()=>u(void 0)})):Object(x.jsx)(b.EuiEmptyPrompt,{iconType:"logoKibana","data-test-subj":"latest-findings-table-no-findings-empty-state",title:Object(x.jsx)("h2",null,Object(x.jsx)(j.FormattedMessage,{id:"xpack.csp.findings.latestFindings.noFindingsTitle",defaultMessage:"There are no Findings"}))})},Gt=s.a.memo(Qt),Yt=({query:e,filters:t})=>({query:e,filters:t,sort:{field:"@timestamp",direction:"desc"},pageIndex:0,pageSize:10}),Ht=({dataView:e})=>{var t,n;const i=pe(Yt),{urlQuery:c,setUrlQuery:u}=te(i),[l,d]=G()(g.l,c.pageSize),f=fe({dataView:e,filters:c.filters,query:c.query}),h=(e=>{const{data:t,notifications:{toasts:n}}=Object(p.a)().services,{pitIdRef:i,setPitId:r}=Object(a.useContext)(q),s={...e,pitId:i.current};return Object(o.useQuery)(["csp_findings",{params:s}],(async()=>{const{rawResponse:{hits:e,aggregations:n,pit_id:i}}=await Object(ne.lastValueFrom)(t.search.search({params:he(s)}));if(!n)throw new Error("expected aggregations to be an defined");if(!Array.isArray(n.count.buckets))throw new Error("expected buckets to be an array");return{page:e.hits.map((e=>e._source)),total:ie.number.is(e.total)?e.total:0,count:je(n.count.buckets),newPitId:i}}),{enabled:e.enabled,keepPreviousData:!0,onError:e=>xe(n,e),onSuccess:({newPitId:e})=>{r(e)},refetchInterval:V,refetchIntervalInBackground:!0})})({...ge({pageIndex:c.pageIndex,pageSize:l||c.pageSize}),query:f.query,sort:c.sort,enabled:!f.error}),y=h.error||f.error,{isLastLimitedPage:O,limitedTotalItemCount:v}=Object(a.useMemo)((()=>{var e;return((e,t,n,i)=>{const r=e>500,a=r?500:e,s=Math.ceil(a/n);return{isLastLimitedPage:r&&s===i+1,limitedTotalItemCount:a}})((null===(e=h.data)||void 0===e?void 0:e.total)||0,0,c.pageSize,c.pageIndex)}),[null===(t=h.data)||void 0===t?void 0:t.total,c.pageIndex,c.pageSize]);return Object(x.jsx)("div",{"data-test-subj":K},Object(x.jsx)(J,{dataView:e,setQuery:e=>{u({...e,pageIndex:0})},loading:h.isFetching}),Object(x.jsx)(b.EuiFlexGroup,null,Object(x.jsx)(b.EuiFlexItem,null,Object(x.jsx)(Kt,null)),Object(x.jsx)(b.EuiFlexItem,{grow:!1,style:{width:400}},!y&&Object(x.jsx)(He,{type:"default"}))),y&&Object(x.jsx)(wt,{error:y}),!y&&Object(x.jsx)(s.a.Fragment,null,h.isSuccess&&!!h.data.page.length&&Object(x.jsx)(_t,r()({distributionOnClick:t=>{u({pageIndex:0,filters:le({filters:c.filters,dataView:e,field:"result.evaluation",value:t,negate:!1})})},type:m.i18n.translate("xpack.csp.findings.latestFindings.tableRowTypeLabel",{defaultMessage:"Findings"}),total:h.data.total,passed:h.data.count.passed,failed:h.data.count.failed},be({pageIndex:c.pageIndex,pageSize:c.pageSize,currentPageSize:h.data.page.length}))),Object(x.jsx)(b.EuiSpacer,null),Object(x.jsx)(Gt,{loading:h.isFetching,items:(null===(n=h.data)||void 0===n?void 0:n.page)||[],pagination:de({pageSize:l||c.pageSize,pageIndex:c.pageIndex,totalItemCount:v}),sorting:{sort:{field:c.sort.field,direction:c.sort.direction}},setTableOptions:({page:e,sort:t})=>{d(e.size),u({sort:t,pageIndex:e.index,pageSize:e.size})},onAddFilter:(t,n,i)=>u({pageIndex:0,filters:le({filters:c.filters,dataView:e,field:t,value:n,negate:i})})}),O&&Object(x.jsx)(s.a.Fragment,null,Object(x.jsx)(b.EuiSpacer,{size:"xxl"}),Object(x.jsx)(b.EuiBottomBar,{"data-test-subj":"test-bottom-bar"},Object(x.jsx)(b.EuiText,{textAlign:"center"},Object(x.jsx)(j.FormattedMessage,{id:"xpack.csp.findings.latestFindings.bottomBarLabel",defaultMessage:"These are the first {maxItems} findings matching your search, refine your search to see others.",values:{maxItems:500}}))))))},Kt=()=>Object(x.jsx)(Le,null,Object(x.jsx)(Ne,{title:Object(x.jsx)(Y,{title:m.i18n.translate("xpack.csp.findings.latestFindings.latestFindingsPageTitle",{defaultMessage:"Findings"})})}));var Jt={name:"qefxoo",styles:"height:100%;display:flex;flex-direction:column;justify-content:space-around"};const Zt=e=>{const{euiTheme:t}=Object(b.useEuiTheme)();return Object(x.jsx)(b.EuiPanel,{hasBorder:!0,onClick:e.onClick,paddingSize:"m",css:Object(x.css)("position:relative;display:flex;align-items:center;:hover .euiIcon{color:",t.colors.primary,";transition:",t.animation.normal,";}",""),"data-test-subj":e.id},Object(x.jsx)(b.EuiStat,{css:Jt,titleSize:"s",title:e.title,titleColor:e.titleColor,descriptionElement:"h6",description:e.description}),e.onClick&&Object(x.jsx)(b.EuiIcon,{type:"link",css:Object(x.css)("position:absolute;top:",t.size.s,";right:",t.size.s,";","")}))},$t=({number:e=0,abbreviateAbove:t=999999})=>e<=t?Object(x.jsx)("span",null,e.toLocaleString()):Object(x.jsx)(b.EuiToolTip,{content:e.toLocaleString()},Object(x.jsx)("span",null,e.toLocaleString(void 0,{notation:"compact",maximumFractionDigits:1}))),Xt=()=>Object(x.jsx)(b.EuiFlexGroup,{justifyContent:"center",alignItems:"center","data-test-subj":"chart_is_loading"},Object(x.jsx)(b.EuiLoadingChart,{size:"m"})),en=()=>Object(x.jsx)(b.EuiFlexGroup,{justifyContent:"center",alignItems:"center","data-test-subj":"chart_is_error"},Object(x.jsx)(b.EuiText,{size:"xs",color:"subdued"},"Error")),tn=({title:e,hasBorder:t=!0,isLoading:n,isError:i,children:r})=>Object(x.jsx)(b.EuiPanel,{hasBorder:t,hasShadow:!1,"data-test-subj":"chart-panel"},Object(x.jsx)(b.EuiFlexGroup,{direction:"column",gutterSize:"m",style:{height:"100%"}},Object(x.jsx)(b.EuiFlexItem,{grow:!1},e&&Object(x.jsx)(b.EuiTitle,{size:"xs"},Object(x.jsx)("h3",{style:{lineHeight:"initial"}},e))),Object(x.jsx)(b.EuiFlexItem,null,n?Object(x.jsx)(Xt,null):i?Object(x.jsx)(en,null):r)));var nn=n(34);const rn=({compact:e,postureScore:t})=>{const{euiTheme:n}=Object(b.useEuiTheme)(),i=(e=>`${Math.round(e)}%`)(t);return Object(x.jsx)(b.EuiTitle,{css:Object(x.css)({fontSize:e?n.size.l:n.size.xxl},"","")},Object(x.jsx)("h3",null,i))},an=e=>({...e,timestamp:Se()(e.timestamp).valueOf()}),sn=({trend:e})=>{const t=e.map(an),{services:{charts:n}}=Object(p.a)();return Object(x.jsx)(nn.Chart,null,Object(x.jsx)(nn.Settings,{theme:n.theme.useChartsTheme(),baseTheme:n.theme.useChartsBaseTheme(),showLegend:!1,legendPosition:"right",tooltip:{headerFormatter:({value:e})=>Object(x.jsx)(s.a.Fragment,null,Object(x.jsx)(j.FormattedDate,{value:e,month:"short",day:"numeric"}),", ",Object(x.jsx)(j.FormattedTime,{value:e}))}}),Object(x.jsx)(nn.AreaSeries,{id:"Posture Score",data:t,xScaleType:"time",xAccessor:"timestamp",yAccessors:["postureScore"]}),Object(x.jsx)(nn.Axis,{id:"bottom-axis",position:"bottom",tickFormat:Object(nn.timeFormatter)(Object(nn.niceTimeFormatByDay)(2)),ticks:4}),Object(x.jsx)(nn.Axis,{ticks:3,id:"left-axis",position:"left",showGridLines:!0,domain:{min:0,max:100}}))};var on={name:"zjik7",styles:"display:flex"};const cn=({text:e,count:t,color:n,onClick:i,tooltipContent:r})=>{const{euiTheme:a}=Object(b.useEuiTheme)();return Object(x.jsx)(b.EuiToolTip,{content:r},Object(x.jsx)(b.EuiLink,{color:"text",onClick:i,css:on},Object(x.jsx)(b.EuiText,{color:n,style:{fontWeight:a.font.weight.medium},size:"s"},Object(x.jsx)($t,{number:t,abbreviateAbove:999})," "),Object(x.jsx)(b.EuiText,{size:"s"},e)))},un=({data:e,trend:t,onEvalCounterClick:n,compact:i})=>{const{euiTheme:a}=Object(b.useEuiTheme)();return Object(x.jsx)(b.EuiFlexGroup,{direction:"column",justifyContent:"spaceBetween",style:{height:"100%"},gutterSize:"none"},Object(x.jsx)(b.EuiFlexItem,{grow:2},Object(x.jsx)(b.EuiFlexGroup,{direction:"row",justifyContent:"spaceBetween",gutterSize:"none"},Object(x.jsx)(b.EuiFlexItem,{grow:!1},Object(x.jsx)(rn,r()({},e,{compact:i}))),Object(x.jsx)(b.EuiFlexItem,{grow:!1},Object(x.jsx)(b.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"none",alignItems:i?"center":"flexStart",style:{paddingRight:a.size.xl}},Object(x.jsx)(cn,{text:"passed",count:e.totalPassed,color:Me.c.passed,onClick:()=>n(g.p),tooltipContent:m.i18n.translate("xpack.csp.cloudPostureScoreChart.counterLink.passedFindingsTooltip",{defaultMessage:"Passed findings"})})," ","-"," ",Object(x.jsx)(cn,{text:"failed",count:e.totalFailed,color:Me.c.failed,onClick:()=>n(g.o),tooltipContent:m.i18n.translate("xpack.csp.cloudPostureScoreChart.counterLink.failedFindingsTooltip",{defaultMessage:"Failed findings"})}))))),Object(x.jsx)(b.EuiFlexItem,{grow:i?8:6},Object(x.jsx)(sn,{trend:t})))},ln=({data:e,maxItems:t,onCellClick:n,onViewAllClick:i,viewAllButtonTitle:r,compact:s})=>{const{euiTheme:o}=Object(b.useEuiTheme)(),c=Object(a.useMemo)((()=>[{field:"name",truncateText:!0,name:s?"":m.i18n.translate("xpack.csp.dashboard.risksTable.cisSectionColumnLabel",{defaultMessage:"CIS Section"}),render:e=>Object(x.jsx)(b.EuiLink,{onClick:()=>n(e),className:"eui-textTruncate",color:"text"},e)},{field:"postureScore",width:"115px",name:s?"":m.i18n.translate("xpack.csp.dashboard.risksTable.complianceColumnLabel",{defaultMessage:"Compliance"}),render:(e,t)=>Object(x.jsx)(b.EuiFlexGroup,{gutterSize:"none",alignItems:"center",justifyContent:"flexEnd",style:{gap:o.size.s}},Object(x.jsx)(b.EuiFlexItem,null,Object(x.jsx)(b.EuiToolTip,{content:m.i18n.translate("xpack.csp.complianceDashboard.complianceByCisSection.complianceColumnTooltip",{defaultMessage:"{passed}/{total}",values:{passed:t.totalPassed,total:t.totalFindings}})},Object(x.jsx)(b.EuiFlexGroup,{gutterSize:"none",style:{height:o.size.xs,borderRadius:o.border.radius.medium,overflow:"hidden",gap:1}},Object(x.jsx)(b.EuiFlexItem,{style:{flex:t.totalFailed,background:Me.c.failed}}),Object(x.jsx)(b.EuiFlexItem,{style:{flex:t.totalPassed,background:Me.c.passed}})))),Object(x.jsx)(b.EuiFlexItem,{grow:!1},Object(x.jsx)(b.EuiText,{size:"xs",style:{fontWeight:o.font.weight.bold}},`${(null==e?void 0:e.toFixed(0))||0}%`)))}]),[s,o.border.radius.medium,o.font.weight.bold,o.size.s,o.size.xs,n]),u=((e,t)=>e.slice().sort(((e,t)=>e.postureScore-t.postureScore)).slice(0,t))(e,t);return Object(x.jsx)(b.EuiFlexGroup,{direction:"column",justifyContent:"spaceBetween",gutterSize:"none"},Object(x.jsx)(b.EuiFlexItem,null,Object(x.jsx)(b.EuiInMemoryTable,{items:u,columns:c})),Object(x.jsx)(b.EuiFlexItem,{grow:!1},Object(x.jsx)("div",null,Object(x.jsx)(b.EuiButtonEmpty,{onClick:i,iconType:"search"},r))))},dn=e=>({query:{language:"kuery",query:"string"==typeof e?e:Object.entries(e).reduce(((e,[t,n])=>(e.push(`${t}: "${n}"`),e)),[]).join(" and ")}}),pn=()=>{const e=Object(c.useHistory)();return t=>{e.push({pathname:d.c.findings_default.path,...t&&{search:X(dn(t))}})}},gn=({complianceData:e})=>{const t=pn(),n=(()=>{const e=Object(c.useHistory)();return t=>{e.push({pathname:d.c.findings_by_resource.path,...t&&{search:X(dn(t))}})}})(),i=Object(a.useMemo)((()=>[{id:"dashboard-counter-card-clusters-evaluated",description:m.i18n.translate("xpack.csp.dashboard.summarySection.counterCard.clustersEvaluatedDescription",{defaultMessage:"Clusters Evaluated"}),title:Object(x.jsx)($t,{number:e.clusters.length})},{id:"dashboard-counter-card-resources-evaluated",description:m.i18n.translate("xpack.csp.dashboard.summarySection.counterCard.resourcesEvaluatedDescription",{defaultMessage:"Resources Evaluated"}),title:Object(x.jsx)($t,{number:e.stats.resourcesEvaluated||0}),onClick:()=>{n()}},{id:"dashboard-counter-card-failing-findings",description:m.i18n.translate("xpack.csp.dashboard.summarySection.counterCard.failingFindingsDescription",{defaultMessage:"Failing Findings"}),title:Object(x.jsx)($t,{number:e.stats.totalFailed}),titleColor:e.stats.totalFailed>0?Me.c.failed:"text",onClick:()=>{t({"result.evaluation":g.o})}}]),[e.clusters.length,e.stats.resourcesEvaluated,e.stats.totalFailed,t,n]);return Object(x.jsx)(b.EuiFlexGroup,{gutterSize:"l"},Object(x.jsx)(b.EuiFlexItem,{grow:3},Object(x.jsx)(b.EuiFlexGroup,{direction:"column"},i.map((e=>Object(x.jsx)(b.EuiFlexItem,{key:e.id},Object(x.jsx)(Zt,e)))))),Object(x.jsx)(b.EuiFlexItem,{grow:8},Object(x.jsx)(tn,{title:m.i18n.translate("xpack.csp.dashboard.summarySection.cloudPostureScorePanelTitle",{defaultMessage:"Cloud Posture Score"})},Object(x.jsx)(un,{id:"cloud_posture_score_chart",data:e.stats,trend:e.trend,onEvalCounterClick:e=>{t({"result.evaluation":e})}}))),Object(x.jsx)(b.EuiFlexItem,{grow:8},Object(x.jsx)(tn,{title:m.i18n.translate("xpack.csp.dashboard.summarySection.complianceByCisSectionPanelTitle",{defaultMessage:"Compliance By CIS Section"})},Object(x.jsx)(ln,{data:e.groupedFindingsEvaluation,maxItems:5,onCellClick:e=>{t({"rule.section":e,"result.evaluation":g.o})},onViewAllClick:()=>{t({"result.evaluation":g.o})},viewAllButtonTitle:m.i18n.translate("xpack.csp.dashboard.risksTable.viewAllButtonTitle",{defaultMessage:"View all failed findings"})}))))},fn=["csp_dashboard_stats"],bn=m.i18n.translate("xpack.csp.dashboard.benchmarkSection.defaultClusterTitle",{defaultMessage:"Cluster ID"});var jn={name:"14is9qy",styles:"font-size:20px"};const mn=({cluster:e})=>{const{euiTheme:t}=Object(b.useEuiTheme)(),n=pn(),i=e.meta.clusterId.slice(0,6),r=e.meta.clusterName||bn;return Object(x.jsx)(b.EuiFlexGroup,{direction:"column",gutterSize:"none",alignItems:"flexStart"},Object(x.jsx)(b.EuiFlexItem,{grow:!1},Object(x.jsx)(b.EuiToolTip,{position:"top",content:Object(x.jsx)(b.EuiText,null,Object(x.jsx)(j.FormattedMessage,{id:"xpack.csp.dashboard.benchmarkSection.clusterTitleTooltip.clusterPrefixTitle",defaultMessage:"Show all findings for "}),Object(x.jsx)("strong",null,Object(x.jsx)(j.FormattedMessage,{id:"xpack.csp.dashboard.benchmarkSection.clusterTitleTooltip.clusterTitle",defaultMessage:"{title} - {shortId}",values:{title:r,shortId:i}})))},Object(x.jsx)(b.EuiLink,{onClick:()=>{return t=e.meta.clusterId,void n({cluster_id:t});var t},color:"text"},Object(x.jsx)(b.EuiTitle,{css:jn},Object(x.jsx)("h5",null,Object(x.jsx)(j.FormattedMessage,{id:"xpack.csp.dashboard.benchmarkSection.clusterTitle",defaultMessage:"{title} - {shortId}",values:{title:r,shortId:i}}))))),Object(x.jsx)(b.EuiText,{size:"xs",color:"subdued"},Object(x.jsx)(j.FormattedMessage,{id:"xpack.csp.dashboard.benchmarkSection.lastEvaluatedTitle",defaultMessage:"Last evaluated {dateFromNow}",values:{dateFromNow:Se()(e.meta.lastUpdate).fromNow()}}))),Object(x.jsx)(b.EuiFlexItem,{grow:!0,style:{justifyContent:"flex-end",paddingBottom:t.size.m}},Object(x.jsx)(yt,{type:e.meta.benchmarkId,name:e.meta.benchmarkName})),g.h.showManageRulesMock&&Object(x.jsx)(b.EuiFlexItem,{grow:!1},Object(x.jsx)(b.EuiButtonEmpty,null,Object(x.jsx)(j.FormattedMessage,{id:"xpack.csp.dashboard.benchmarkSection.manageRulesButton",defaultMessage:"Manage Rules"}))))},xn=({complianceData:e})=>{const{euiTheme:t}=Object(b.useEuiTheme)(),n=pn();return Object(x.jsx)(s.a.Fragment,null,Object(x.jsx)(b.EuiFlexGroup,{alignItems:"flexStart",gutterSize:"none",style:{borderBottom:t.border.thick,borderBottomColor:t.colors.text,marginBottom:t.size.m,paddingBottom:t.size.s}},Object(x.jsx)(b.EuiFlexItem,{grow:3},Object(x.jsx)(b.EuiTitle,{size:"xxs",css:Object(x.css)({fontWeight:t.font.weight.semiBold},"","")},Object(x.jsx)("h5",null,Object(x.jsx)(j.FormattedMessage,{id:"xpack.csp.dashboard.cloudBenchmarkSection.columnsHeader.clusterNameTitle",defaultMessage:"Cluster Name"})))),Object(x.jsx)(b.EuiFlexItem,{grow:8},Object(x.jsx)(b.EuiTitle,{size:"xxs",css:Object(x.css)({fontWeight:t.font.weight.semiBold,paddingLeft:t.size.xl},"","")},Object(x.jsx)("h5",null,Object(x.jsx)(j.FormattedMessage,{id:"xpack.csp.dashboard.cloudBenchmarkSection.columnsHeader.complianceScoreTitle",defaultMessage:"Compliance Score"})))),Object(x.jsx)(b.EuiFlexItem,{grow:8},Object(x.jsx)(b.EuiTitle,{size:"xxs",css:Object(x.css)({fontWeight:t.font.weight.semiBold,paddingLeft:t.size.xl},"","")},Object(x.jsx)("h5",null,Object(x.jsx)(j.FormattedMessage,{id:"xpack.csp.dashboard.cloudBenchmarkSection.columnsHeader.complianceByCisSectionTitle",defaultMessage:"Compliance by CIS Section"}))))),e.clusters.map((e=>Object(x.jsx)(b.EuiFlexGroup,{key:e.meta.clusterId,gutterSize:"l",style:{borderBottom:t.border.thin}},Object(x.jsx)(b.EuiFlexItem,{grow:3},Object(x.jsx)(mn,{cluster:e})),Object(x.jsx)(b.EuiFlexItem,{grow:8},Object(x.jsx)("div",{style:{paddingLeft:t.size.base,paddingRight:t.size.base,height:"100%"}},Object(x.jsx)(un,{compact:!0,id:`${e.meta.clusterId}_score_chart`,data:e.stats,trend:e.trend,onEvalCounterClick:t=>((e,t)=>{n({cluster_id:e,"result.evaluation":t})})(e.meta.clusterId,t)}))),Object(x.jsx)(b.EuiFlexItem,{grow:8},Object(x.jsx)("div",{style:{paddingLeft:t.size.base,paddingRight:t.size.base}},Object(x.jsx)(ln,{compact:!0,data:e.groupedFindingsEvaluation,maxItems:3,onCellClick:t=>{return i=e.meta.clusterId,void n({cluster_id:i,"rule.section":t,"result.evaluation":g.o});var i},viewAllButtonTitle:m.i18n.translate("xpack.csp.dashboard.risksTable.clusterCardViewAllButtonTitle",{defaultMessage:"View all failed findings for this cluster"}),onViewAllClick:()=>{return t=e.meta.clusterId,void n({cluster_id:t,"result.evaluation":g.o});var t}})))))))};var hn={name:"13nk7m4",styles:"max-width:1440px;margin-left:auto;margin-right:auto"},yn=n(42),On=n.n(yn);const vn=e=>{const t=null==e?void 0:e.inputs.find((e=>e.enabled));if(!t||"string"!=typeof(n=t.policy_template)||!(n in Me.b))return null;var n;const i=Me.b[t.policy_template],r=i.options.find((e=>e.type===t.type));return{integration:i,enabledIntegrationOption:r}},Tn=({name:e,id:t})=>{const{http:n}=Object(p.a)().services,[i,r]=O.pagePathGetters.policy_details({policyId:t});return Object(x.jsx)(b.EuiLink,{href:n.basePath.prepend([i,r].join(""))},e)},kn=({packageName:e,policyId:t,packagePolicyId:n})=>{const{application:i}=Object(p.a)().services;return Object(x.jsx)(b.EuiLink,{href:i.getUrlForApp("security",{path:Object(c.generatePath)(d.b.rules.path,{packagePolicyId:n,policyId:t})})},e)},In=[{field:"package_policy.name",name:m.i18n.translate("xpack.csp.benchmarks.benchmarksTable.integrationNameColumnTitle",{defaultMessage:"Integration Name"}),render:(e,t)=>Object(x.jsx)(kn,{packageName:e,packagePolicyId:t.package_policy.id,policyId:t.package_policy.policy_id}),truncateText:!0,sortable:!0,"data-test-subj":"benchmarks-table-column-integration-name"},{field:"rules.enabled",name:m.i18n.translate("xpack.csp.benchmarks.benchmarksTable.rulesColumnTitle",{defaultMessage:"Rules"}),truncateText:!0,"data-test-subj":"benchmarks-table-column-rules"},{field:"package_policy",name:m.i18n.translate("xpack.csp.benchmarks.benchmarksTable.integrationColumnTitle",{defaultMessage:"Integration"}),dataType:"string",truncateText:!0,sortable:!0,"data-test-subj":"benchmarks-table-column-integration",render:e=>{var t;const n=vn(e);return(null==n||null===(t=n.integration)||void 0===t?void 0:t.shortName)||" "}},{field:"package_policy",name:m.i18n.translate("xpack.csp.benchmarks.benchmarksTable.deploymentTypeColumnTitle",{defaultMessage:"Deployment Type"}),dataType:"string",truncateText:!0,sortable:!0,"data-test-subj":"benchmarks-table-column-deployment-type",render:e=>{var t;const n=vn(e);return(null==n||null===(t=n.enabledIntegrationOption)||void 0===t?void 0:t.name)||" "}},{field:"agent_policy.name",name:m.i18n.translate("xpack.csp.benchmarks.benchmarksTable.agentPolicyColumnTitle",{defaultMessage:"Agent Policy"}),render:(e,t)=>Object(x.jsx)(Tn,{name:e,id:t.agent_policy.id}),truncateText:!0,"data-test-subj":"benchmarks-table-column-agent-policy"},{field:"agent_policy.agents",name:m.i18n.translate("xpack.csp.benchmarks.benchmarksTable.numberOfAgentsColumnTitle",{defaultMessage:"Number of Agents"}),truncateText:!0,"data-test-subj":"benchmarks-table-column-number-of-agents"},{field:"package_policy.created_by",name:m.i18n.translate("xpack.csp.benchmarks.benchmarksTable.createdByColumnTitle",{defaultMessage:"Created by"}),dataType:"string",truncateText:!0,sortable:!0,"data-test-subj":"benchmarks-table-column-created-by"},{field:"package_policy.created_at",name:m.i18n.translate("xpack.csp.benchmarks.benchmarksTable.createdAtColumnTitle",{defaultMessage:"Created at"}),dataType:"date",truncateText:!0,render:e=>Object(x.jsx)(we,{timestamp:e}),sortable:!0,"data-test-subj":"benchmarks-table-column-created-at"}],En=({benchmarks:e,pageIndex:t,pageSize:n,totalItemCount:i,loading:r,error:a,setQuery:s,noItemsMessage:o,sorting:c,...u})=>{const l={pageIndex:Math.max(t-1,0),pageSize:n,totalItemCount:i};return Object(x.jsx)(b.EuiBasicTable,{"data-test-subj":u["data-test-subj"],items:e,columns:In,itemId:e=>[e.agent_policy.id,e.package_policy.id].join("/"),pagination:l,onChange:({page:e,sort:t})=>{s({page:{...e,index:e.index+1},sort:t})},tableLayout:"fixed",loading:r,noItemsMessage:o,error:a,sorting:c})},Sn=()=>{const e=w();return Object(x.jsx)(b.EuiButton,{"data-test-subj":"csp_add_integration",fill:!0,iconType:"plusInCircle",href:e,isDisabled:!e},Object(x.jsx)(j.FormattedMessage,{id:"xpack.csp.benchmarks.benchmarksPageHeader.addKSPMIntegrationButtonLabel",defaultMessage:"Add a KSPM integration"}))},Mn=({name:e})=>Object(x.jsx)("div",null,Object(x.jsx)(b.EuiSpacer,{size:"l"}),Object(x.jsx)(b.EuiText,null,Object(x.jsx)("strong",null,Object(x.jsx)(j.FormattedMessage,{id:"xpack.csp.benchmarks.benchmarkEmptyState.integrationsNotFoundTitle",defaultMessage:"No benchmark integrations found"}),e&&Object(x.jsx)(j.FormattedMessage,{id:"xpack.csp.benchmarks.benchmarkEmptyState.integrationsNotFoundForNameTitle",defaultMessage:' for "{name}"',values:{name:e}}))),Object(x.jsx)(b.EuiSpacer,{size:"s"}),Object(x.jsx)(b.EuiText,null,Object(x.jsx)(b.EuiTextColor,{color:"subdued"},Object(x.jsx)(j.FormattedMessage,{id:"xpack.csp.benchmarks.benchmarkEmptyState.integrationsNotFoundWithFiltersTitle",defaultMessage:"We weren't able to find any benchmark integrations with the above filters."}))),Object(x.jsx)(b.EuiSpacer,{size:"l"})),wn=({pageCount:e,totalCount:t})=>Object(x.jsx)(b.EuiText,{size:"xs",style:{marginLeft:8}},Object(x.jsx)(b.EuiTextColor,{color:"subdued"},Object(x.jsx)(j.FormattedMessage,{id:"xpack.csp.benchmarks.totalIntegrationsCountMessage",defaultMessage:"Showing {pageCount} of {totalCount, plural, one {# integration} other {# integrations}}",values:{pageCount:e,totalCount:t}}))),Fn=({onSearch:e,isLoading:t})=>{const[n,i]=Object(a.useState)("");return On()((()=>e(n)),300,[n]),Object(x.jsx)(b.EuiFlexGroup,null,Object(x.jsx)(b.EuiFlexItem,{grow:!0,style:{alignItems:"flex-end"}},Object(x.jsx)(b.EuiFieldSearch,{onSearch:i,isLoading:t,placeholder:m.i18n.translate("xpack.csp.benchmarks.benchmarkSearchField.searchPlaceholder",{defaultMessage:"e.g. benchmark name"}),incremental:!0})))},_n=({setPagination:e,setSelectedRuleId:t,perPage:n,rules_page:i,page:r,total:s,loading:o,error:c,selectedRuleId:u})=>{const{euiTheme:l}=Object(b.useEuiTheme)(),d=Object(a.useMemo)((()=>Cn({setSelectedRuleId:t})),[t]),p={pageIndex:r,pageSize:n,totalItemCount:s,pageSizeOptions:[10,25,100]};return Object(x.jsx)(b.EuiBasicTable,{"data-test-subj":"csp_rules_table",loading:o,error:c,items:i,columns:d,pagination:p,onChange:({page:t})=>{t&&e({page:t.index,perPage:t.size})},itemId:e=>e.id,rowProps:e=>{return{"data-test-subj":(n=e.id,`csp_rules_table_row_item_name_${n}`),style:{background:e.id===u?l.colors.highlight:void 0},onClick:n=>{const i=n.target.tagName;"BUTTON"!==i&&"INPUT"!==i&&t(e.id)}};var n}})},Cn=({setSelectedRuleId:e})=>[{field:"attributes.metadata.name",name:m.i18n.translate("xpack.csp.rules.rulesTable.nameColumnLabel",{defaultMessage:"Name"}),width:"60%",truncateText:!0,render:(t,n)=>Object(x.jsx)(b.EuiButtonEmpty,{className:"eui-textTruncate",title:t,onClick:t=>{t.stopPropagation(),e(n.id)},"data-test-subj":"csp_rules_table_row_item_name"},t)},{field:"attributes.metadata.section",name:m.i18n.translate("xpack.csp.rules.rulesTable.cisSectionColumnLabel",{defaultMessage:"CIS Section"}),width:"15%"},{field:"updatedAt",name:m.i18n.translate("xpack.csp.rules.rulesTable.lastModifiedColumnLabel",{defaultMessage:"Last Modified"}),width:"15%",render:e=>Object(x.jsx)(we,{timestamp:e})}],Ln=({search:e,totalRulesCount:t,searchValue:n,isSearching:i})=>Object(x.jsx)("div",null,Object(x.jsx)(b.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween",responsive:!1,wrap:!0},Object(x.jsx)(Nn,{total:t}),Object(x.jsx)(zn,{isSearching:i,searchValue:n,search:e}))),Nn=({total:e})=>Object(x.jsx)(b.EuiFlexItem,{grow:!1,style:{flexDirection:"row",fontVariantNumeric:"tabular-nums"}},Object(x.jsx)(Pn,{count:e})),zn=({search:e,isSearching:t,searchValue:n})=>{const[i,r]=Object(a.useState)(n);return On()((()=>e(i)),300,[i]),Object(x.jsx)(b.EuiFlexItem,{grow:!0,style:{alignItems:"flex-end",maxWidth:500}},Object(x.jsx)(b.EuiFieldSearch,{isLoading:t,placeholder:m.i18n.translate("xpack.csp.rules.rulesTable.searchPlaceholder",{defaultMessage:"Search by rule name"}),value:i,onChange:e=>r(e.target.value),style:{minWidth:150},fullWidth:!0}))},Pn=({count:e})=>Object(x.jsx)(j.FormattedMessage,{id:"xpack.csp.rules.header.totalRulesCount",defaultMessage:"Showing {rules}",values:{rules:Object(x.jsx)(An,{count:e})}}),An=({count:e})=>Object(x.jsx)(s.a.Fragment,null,Object(x.jsx)("strong",{style:{margin:"0 4px"}},e),Object(x.jsx)(j.FormattedMessage,{id:"xpack.csp.rules.header.rulesCountLabel",defaultMessage:"{count, plural, one { rule} other { rules}}",values:{count:e}})),Rn=[{label:m.i18n.translate("xpack.csp.rules.ruleFlyout.overviewTabLabel",{defaultMessage:"Overview"}),id:"overview",disabled:!1},{label:m.i18n.translate("xpack.csp.rules.ruleFlyout.remediationTabLabel",{defaultMessage:"Remediation"}),id:"remediation",disabled:!1}],Dn=({onClose:e,rule:t})=>{const[n,i]=Object(a.useState)("overview");return Object(x.jsx)(b.EuiFlyout,{ownFocus:!1,onClose:e,"data-test-subj":"csp_rules_flyout_container"},Object(x.jsx)(b.EuiFlyoutHeader,null,Object(x.jsx)(b.EuiTitle,{size:"l"},Object(x.jsx)("h2",null,t.attributes.metadata.name)),Object(x.jsx)(b.EuiSpacer,null),Object(x.jsx)(b.EuiTabs,null,Rn.map((e=>Object(x.jsx)(b.EuiTab,{key:e.id,isSelected:n===e.id,onClick:()=>i(e.id),disabled:e.disabled},e.label))))),Object(x.jsx)(b.EuiFlyoutBody,null,"overview"===n&&Object(x.jsx)(Bn,{rule:t}),"remediation"===n&&Object(x.jsx)(b.EuiDescriptionList,{compressed:!1,listItems:lt(t.attributes.metadata)})))},Bn=({rule:e})=>Object(x.jsx)(b.EuiFlexGroup,{direction:"column"},Object(x.jsx)(b.EuiFlexItem,null,Object(x.jsx)(b.EuiDescriptionList,{listItems:gt(e.attributes.metadata)}))),Un=e=>e.map((e=>e.updatedAt)).filter(re).sort(((e,t)=>new Date(t).getTime()-new Date(e).getTime()))[0],Vn=()=>{const e=Object(c.useParams)(),[t,n]=Object(a.useState)(null),[i,r]=G()(g.n,10),[s,u]=Object(a.useState)({filter:oe({packagePolicyId:e.packagePolicyId,policyId:e.policyId}),search:"",page:0,perPage:i||10}),{data:l,status:d,error:f}=(({search:e,page:t,perPage:n,filter:i})=>{const{savedObjects:r}=Object(p.a)().services;return Object(o.useQuery)([g.f,{search:e,page:t,perPage:n}],(()=>r.client.find({type:g.f,search:e?`"${e}"*`:"",searchFields:["metadata.name.text"],page:1,sortField:"metadata.name",perPage:n,filter:i})))})({filter:s.filter,search:s.search,page:1,perPage:1e4}),j=Object(a.useMemo)((()=>(({status:e,data:t,error:n},i)=>{const r=(null==t?void 0:t.savedObjects)||[],a=((e,{page:t,perPage:n})=>e.slice(t*n,(t+1)*n))(r,i);return{loading:"loading"===e,error:n?se(n):void 0,all_rules:r,rules_map:new Map(r.map((e=>[e.id,e]))),rules_page:a,total:(null==t?void 0:t.total)||0,lastModified:Un(r)||null}})({data:l,error:f,status:d},s)),[l,f,d,s]);return Object(x.jsx)("div",{"data-test-subj":"csp_rules_container"},Object(x.jsx)(b.EuiPanel,{hasBorder:!1,hasShadow:!1},Object(x.jsx)(Ln,{search:e=>u((t=>({...t,search:e}))),searchValue:s.search,totalRulesCount:j.all_rules.length,isSearching:"loading"===d}),Object(x.jsx)(b.EuiSpacer,null),Object(x.jsx)(_n,{rules_page:j.rules_page,total:j.total,error:j.error,loading:j.loading,perPage:i||s.perPage,page:s.page,setPagination:e=>{r(e.perPage),u((t=>({...t,...e})))},setSelectedRuleId:n,selectedRuleId:t})),t&&Object(x.jsx)(Dn,{rule:j.rules_map.get(t),onClose:()=>n(null)}))};var qn=n(11),Wn=n.n(qn);const Qn={findings:()=>{var e;const t=Object(c.useLocation)(),n=W(),{pitQuery:i,pitIdRef:r,setPitId:s}=(e=>{const t=Object(a.useRef)(),[n,i]=Object(a.useState)(!1),r=Object(a.useCallback)((e=>{t.current=e,i(!0)}),[t,i]),{http:s}=Object(p.a)().services,c=Object(o.useQuery)(["findingsPitQuery","findings"],(()=>s.post(g.g,{query:{index_name:g.e,keep_alive:"2m"}})),{enabled:!n,onSuccess:e=>{r(e)},cacheTime:0});return{pitIdRef:t,setPitId:r,pitQuery:c}})();if("indexed"!==(null===(e=f().data)||void 0===e?void 0:e.status))return Object(x.jsx)(U,null);let l=n;return(i.isError||i.isLoading)&&(l=i),Object(x.jsx)(z,{query:l},Object(x.jsx)(q.Provider,{value:{pitQuery:i,pitIdRef:r,setPitId:s}},Object(x.jsx)(c.Switch,null,Object(x.jsx)(c.Route,{exact:!0,path:d.b.findings.path,component:()=>Object(x.jsx)(c.Redirect,{to:{pathname:d.c.findings_default.path,search:t.search}})}),Object(x.jsx)(c.Route,{path:d.c.findings_default.path,render:()=>Object(x.jsx)(u.TrackApplicationView,{viewId:d.c.findings_default.id},Object(x.jsx)(Ht,{dataView:n.data}))}),Object(x.jsx)(c.Route,{path:d.c.findings_by_resource.path,render:()=>Object(x.jsx)(qt,{dataView:n.data})}),Object(x.jsx)(c.Route,{path:"*",component:()=>Object(x.jsx)(c.Redirect,{to:d.c.findings_default.path})}))))},dashboard:()=>{var e;const t="indexed"===(null===(e=f().data)||void 0===e?void 0:e.status),n=(e=>{const{http:t}=Object(p.a)().services;return Object(o.useQuery)(fn,(()=>t.get(g.q)),e)})({enabled:t});return t?Object(x.jsx)(z,{query:n},Object(x.jsx)(b.EuiPageHeader,{bottomBorder:!0,pageTitle:Object(x.jsx)(Y,{title:m.i18n.translate("xpack.csp.dashboard.cspPageTemplate.pageTitle",{defaultMessage:"Cloud Posture"})})}),Object(x.jsx)(b.EuiSpacer,null),Object(x.jsx)("div",{"data-test-subj":"dashboard-container",css:hn},Object(x.jsx)(s.a.Fragment,null,Object(x.jsx)(gn,{complianceData:n.data}),Object(x.jsx)(b.EuiSpacer,null),Object(x.jsx)(xn,{complianceData:n.data}),Object(x.jsx)(b.EuiSpacer,null)))):Object(x.jsx)(U,null)},benchmarks:()=>{var e,t,n;const[i,r]=G()(g.j,10),[s,o]=Object(a.useState)({name:"",page:1,perPage:i||10,sortField:"package_policy.name",sortOrder:"asc"}),c=y(s),u=(null===(e=c.data)||void 0===e?void 0:e.total)||0;return Object(x.jsx)(z,null,Object(x.jsx)(b.EuiPageHeader,{"data-test-subj":"benchmarks-page-header",pageTitle:Object(x.jsx)(Y,{title:m.i18n.translate("xpack.csp.benchmarks.benchmarksPageHeader.benchmarkIntegrationsTitle",{defaultMessage:"Benchmark Integrations"})}),rightSideItems:[Object(x.jsx)(Sn,null)],bottomBorder:!0}),Object(x.jsx)(b.EuiSpacer,null),Object(x.jsx)(Fn,{isLoading:c.isFetching,onSearch:e=>o((t=>({...t,name:e})))}),Object(x.jsx)(b.EuiSpacer,null),Object(x.jsx)(wn,{pageCount:((null===(t=c.data)||void 0===t?void 0:t.items)||[]).length,totalCount:u}),Object(x.jsx)(b.EuiSpacer,{size:"s"}),Object(x.jsx)(En,{benchmarks:(null===(n=c.data)||void 0===n?void 0:n.items)||[],"data-test-subj":"csp_benchmarks_table",error:c.error?se(c.error):void 0,loading:c.isFetching,pageIndex:s.page,pageSize:i||s.perPage,sorting:{sort:{field:s.sortField,direction:s.sortOrder},allowNeutralSort:!1},totalItemCount:u,setQuery:({page:e,sort:t})=>{r(e.size),o((n=>({...n,page:e.index,perPage:e.size,sortField:(null==t?void 0:t.field)||n.sortField,sortOrder:(null==t?void 0:t.direction)||n.sortOrder})))},noItemsMessage:c.isSuccess&&!c.data.total?Object(x.jsx)(Mn,{name:s.name}):void 0}))},rules:({match:{params:e}})=>{const{http:t}=Object(p.a)().services,n=(({packagePolicyId:e,policyId:t})=>{const{http:n}=Object(p.a)().services;return Object(o.useQuery)(["cspRulesInfo",{packagePolicyId:e,policyId:t}],(()=>Promise.all([n.get(v.packagePolicyRouteService.getInfoPath(e)).then((e=>e.item)),n.get(v.agentPolicyRouteService.getInfoPath(t)).then((e=>e.item))])))})(e),i=Object(a.useContext)(H),[r]=n.data||[];(e=>{const{services:{chrome:{setBreadcrumbs:t,docTitle:n},application:{currentAppId$:i,applications$:r,navigateToApp:s}}}=Object(k.useKibana)(),o=Object(c.useRouteMatch)(),u=Wn()(i),l=Wn()(r),d=u?null==l?void 0:l.get(u):void 0,p=null==d?void 0:d.title;Object(a.useEffect)((()=>{const i=e.map((e=>{const t=((e,t)=>{if(!t.includes(":"))return e!==t?t.startsWith("/")?`${t}`:`/${t}`:void 0})(o.path,e.path);return{text:e.name,...t&&u&&{onClick:e=>{e.preventDefault(),s(u,{path:t})}}}})),r=[{text:p,...u&&{onClick:e=>{e.preventDefault(),s(u)}}},...i];t(r),n.change((e=>e.map((e=>e.text)).filter(ie.string.is))(r))}),[o.path,t,e,n,p,u,s])})(Object(a.useMemo)((()=>((e,t)=>{const n=[];return t&&n.push(t),n.push(d.b.benchmarks),e?n.push({...d.b.rules,name:e}):n.push(d.b.rules),n})(null==r?void 0:r.name,null==i?void 0:i.getManageBreadcrumbEntry())),[null==r?void 0:r.name,i]));const s=(e=>{var t;const n=vn(e),i=[];return null!=n&&null!==(t=n.integration)&&void 0!==t&&t.shortName&&i.push({title:m.i18n.translate("xpack.csp.rules.rulesPageSharedValues.integrationTitle",{defaultMessage:"Integration"}),description:null==n?void 0:n.integration.shortName}),null!=n&&n.enabledIntegrationOption?(i.push({title:m.i18n.translate("xpack.csp.rules.rulesPageSharedValues.deploymentTypeTitle",{defaultMessage:"Deployment Type"}),description:null==n?void 0:n.enabledIntegrationOption.name},{title:m.i18n.translate("xpack.csp.rules.rulesPageSharedValues.benchmarkTitle",{defaultMessage:"Benchmark"}),description:null==n?void 0:n.enabledIntegrationOption.benchmark}),i):i})(r);return Object(x.jsx)(z,{query:n},Object(x.jsx)(b.EuiPageHeader,{alignItems:"bottom",bottomBorder:!0,pageTitle:Object(x.jsx)(b.EuiFlexGroup,{direction:"column",gutterSize:"none"},Object(x.jsx)(b.EuiFlexItem,{style:{width:"fit-content"}},Object(x.jsx)(c.Link,{to:Object(c.generatePath)(d.b.benchmarks.path)},Object(x.jsx)(b.EuiButtonEmpty,{iconType:"arrowLeft",contentProps:{style:{padding:0}}},Object(x.jsx)(j.FormattedMessage,{id:"xpack.csp.rules.rulesPageHeader.benchmarkIntegrationsButtonLabel",defaultMessage:"Benchmark Integrations"})))),Object(x.jsx)(b.EuiFlexItem,null,Object(x.jsx)(Y,{title:m.i18n.translate("xpack.csp.rules.rulePageHeader.pageHeaderTitle",{defaultMessage:"Rules - {integrationName}",values:{integrationName:null==r?void 0:r.name}})}))),description:s.length&&Object(x.jsx)("div",{"data-test-subj":"csp_rules_shared_values"},Object(x.jsx)(Ze,{listItems:s})),rightSideItems:[Object(x.jsx)(b.EuiButtonEmpty,{iconType:"gear",size:"xs",href:t.basePath.prepend(O.pagePathGetters.edit_integration(e).join(""))},Object(x.jsx)(j.FormattedMessage,{id:"xpack.csp.rules.manageIntegrationButtonLabel",defaultMessage:"Manage Integration"}))]}),Object(x.jsx)(b.EuiSpacer,null),Object(x.jsx)(Vn,null))}},Gn=new o.QueryClient({defaultOptions:{queries:{refetchOnWindowFocus:!1}}}),Yn=(e,t)=>Object.entries(t).filter((([t])=>!e[t].disabled)).map((([t,n])=>({...e[t],component:n}))),Hn=(e,t)=>{const n=e.component;if(!n)return e;const i={...e,render:i=>Object(x.jsx)(s.a.Fragment,null,Object(x.jsx)(t,{pageName:e.id}),Object(x.jsx)(u.TrackApplicationView,{viewId:e.id},Object(x.jsx)(n,i)))};return delete i.component,i},Kn=Yn(d.b,Qn),Jn=({securitySolutionContext:e})=>{const t=e?e.getSpyRouteComponent():void 0,n=Object(x.jsx)(o.QueryClientProvider,{client:Gn},Object(x.jsx)(c.Switch,null,Kn.map((e=>{const n=t?Hn(e,t):e;return Object(x.jsx)(c.Route,r()({key:n.path},n))})),Object(x.jsx)(c.Route,{exact:!0,path:l.CLOUD_SECURITY_POSTURE_BASE_PATH,component:Zn})));return e?Object(x.jsx)(H.Provider,{value:e},n):Object(x.jsx)(s.a.Fragment,null,n)},Zn=()=>Object(x.jsx)(c.Redirect,{to:d.b.dashboard.path})}}]);