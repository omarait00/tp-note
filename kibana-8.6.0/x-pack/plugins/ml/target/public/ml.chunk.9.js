/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.ml_bundle_jsonpfunction=window.ml_bundle_jsonpfunction||[]).push([[9,10],{207:function(e,t,a){"use strict";a.r(t),a.d(t,"AnomalyDetectorService",(function(){return AnomalyDetectorService}));var l=a(5),n=a.n(l),s=a(25),i=a(81);class AnomalyDetectorService{constructor(e){n()(this,"apiBasePath",Object(i.basePath)()+"/anomaly_detectors"),this.httpService=e}getJobById$(e){return this.httpService.http$({path:`${this.apiBasePath}/${e}`}).pipe(Object(s.map)((e=>e.jobs[0])))}getJobs$(e){return this.httpService.http$({path:`${this.apiBasePath}/${e.join(",")}`}).pipe(Object(s.map)((e=>e.jobs)))}extractInfluencers(e){Array.isArray(e)||(e=[e]);const t=new Set;for(const a of e)for(const e of a.analysis_config.influencers||[])t.add(e);return Array.from(t)}}},256:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var l=a(24),n=a.n(l),s=a(25),i=a(23),o=(a(17),a(46)),c=a(182),r=a(211),u=a(248),b=a(13);async function d(e,t){const{http:a,uiSettings:l,theme:d,application:{currentAppId$:m}}=e;return new Promise((async(j,p)=>{try{const O={groupsMap:Object(c.b)([]),jobsMap:{}},w=l.get("dateFormat:tz"),y="Browser"!==w?w:n.a.tz.guess(),h=()=>{f.close(),p()},x=async({jobIds:e,groups:t})=>{await f.close(),j({jobIds:e,groups:t})},f=e.overlays.openFlyout(Object(o.toMountPoint)(Object(o.wrapWithTheme)(Object(b.jsx)(o.KibanaContextProvider,{services:{...e,mlServices:Object(r.getMlGlobalServices)(a)}},Object(b.jsx)(u.a,{selectedIds:t,withTimeRangeSelector:!1,dateFormatTz:y,singleSelection:!1,timeseriesOnly:!0,onFlyoutClose:h,onSelectionConfirmed:x,maps:O})),d.theme$)),{"data-test-subj":"mlFlyoutJobSelector",ownFocus:!0,closeButtonAriaLabel:"jobSelectorFlyout"});m.pipe(Object(s.skip)(1),Object(s.takeUntil)(Object(i.from)(f.onClose)),Object(s.distinctUntilChanged)()).subscribe((()=>{f.close()}))}catch(e){p(e)}}))}},648:function(e,t,a){"use strict";a.r(t),a.d(t,"resolveAnomalySwimlaneUserInput",(function(){return w}));var l=a(17),n=a.n(l),s=a(23),i=a(46),o=a(100),c=a(44),r=a(45),u=a(2),b=a(13);const d=({defaultTitle:e,influencers:t,onCreate:a,onCancel:s,initialInput:i})=>{var d;const[m,j]=Object(l.useState)(e),[p,O]=Object(l.useState)(null!==(d=null==i?void 0:i.swimlaneType)&&void 0!==d?d:o.h.OVERALL),[w,y]=Object(l.useState)(null==i?void 0:i.viewBy),h=[{id:o.h.OVERALL,label:u.i18n.translate("xpack.ml.explorer.overallLabel",{defaultMessage:"Overall"})},{id:o.h.VIEW_BY,label:u.i18n.translate("xpack.ml.explorer.viewByLabel",{defaultMessage:"View by"})}],x=["",...t].map((e=>({value:e,text:e}))),f=m.length>0,g=f&&(p===o.h.OVERALL||p===o.h.VIEW_BY&&!!w),v={panelTitle:m,swimlaneType:p,...w?{viewBy:w}:{}};return Object(b.jsx)(c.EuiModal,{initialFocus:"[name=panelTitle]",onClose:s},Object(b.jsx)(c.EuiModalHeader,null,Object(b.jsx)(c.EuiModalHeaderTitle,null,Object(b.jsx)(r.FormattedMessage,{id:"xpack.ml.swimlaneEmbeddable.setupModal.title",defaultMessage:"Anomaly swim lane configuration"}))),Object(b.jsx)(c.EuiModalBody,null,Object(b.jsx)(c.EuiForm,null,Object(b.jsx)(c.EuiFormRow,{label:Object(b.jsx)(r.FormattedMessage,{id:"xpack.ml.swimlaneEmbeddable.panelTitleLabel",defaultMessage:"Panel title"}),isInvalid:!f},Object(b.jsx)(c.EuiFieldText,{id:"panelTitle",name:"panelTitle",value:m,onChange:e=>j(e.target.value),isInvalid:!f})),Object(b.jsx)(c.EuiFormRow,{label:Object(b.jsx)(r.FormattedMessage,{id:"xpack.ml.swimlaneEmbeddable.setupModal.swimlaneTypeLabel",defaultMessage:"Swim lane type"})},Object(b.jsx)(c.EuiButtonGroup,{id:"selectSwimlaneType",name:"selectSwimlaneType",color:"primary",isFullWidth:!0,legend:u.i18n.translate("xpack.ml.swimlaneEmbeddable.setupModal.swimlaneTypeLabel",{defaultMessage:"Swim lane type"}),options:h,idSelected:p,onChange:e=>O(e)})),p===o.h.VIEW_BY&&Object(b.jsx)(n.a.Fragment,null,Object(b.jsx)(c.EuiFormRow,{label:Object(b.jsx)(r.FormattedMessage,{id:"xpack.ml.explorer.viewByLabel",defaultMessage:"View by"})},Object(b.jsx)(c.EuiSelect,{id:"selectViewBy",name:"selectViewBy",options:x,value:w,onChange:e=>y(e.target.value)}))))),Object(b.jsx)(c.EuiModalFooter,null,Object(b.jsx)(c.EuiButtonEmpty,{onClick:s},Object(b.jsx)(r.FormattedMessage,{id:"xpack.ml.swimlaneEmbeddable.setupModal.cancelButtonLabel",defaultMessage:"Cancel"})),Object(b.jsx)(c.EuiButton,{isDisabled:!g,onClick:a.bind(null,v),fill:!0},Object(b.jsx)(r.FormattedMessage,{id:"xpack.ml.swimlaneEmbeddable.setupModal.confirmButtonLabel",defaultMessage:"Confirm"}))))};var m=a(207),j=a(265),p=a(121),O=a(256);async function w(e,t){const{http:a,overlays:l}=e,n=new m.AnomalyDetectorService(new p.a(a));return new Promise((async(a,c)=>{try{var r;const{jobIds:u}=await Object(O.a)(e,null==t?void 0:t.jobIds),m=null!==(r=null==t?void 0:t.title)&&void 0!==r?r:Object(j.getDefaultSwimlanePanelTitle)(u),p=await Object(s.lastValueFrom)(n.getJobs$(u)),w=n.extractInfluencers(p);w.push(o.j);const{theme$:y}=e.theme,h=l.openModal(Object(i.toMountPoint)(Object(i.wrapWithTheme)(Object(b.jsx)(d,{defaultTitle:m,influencers:w,initialInput:t,onCreate:e=>{h.close(),a({jobIds:u,title:e.panelTitle,...e})},onCancel:()=>{h.close(),c()}}),y)))}catch(e){c(e)}}))}}}]);