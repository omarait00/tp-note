/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.ml_bundle_jsonpfunction=window.ml_bundle_jsonpfunction||[]).push([[2,28],{102:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return r}));var n=a(17);const i=a.n(n).a.createContext({}),r=()=>{const e=Object(n.useContext)(i);if(void 0===e.combinedQuery||void 0===e.currentDataView||void 0===e.currentSavedSearch||void 0===e.dataViewsContract||void 0===e.kibanaConfig)throw new Error("required attribute is undefined");return e}},111:function(e,t,a){"use strict";a.d(t,"b",(function(){return g})),a.d(t,"a",(function(){return h})),a.d(t,"d",(function(){return _})),a.d(t,"e",(function(){return y})),a.d(t,"k",(function(){return O})),a.d(t,"f",(function(){return E})),a.d(t,"i",(function(){return j})),a.d(t,"c",(function(){return v})),a.d(t,"g",(function(){return x})),a.d(t,"h",(function(){return S})),a.d(t,"j",(function(){return T})),a.d(t,"n",(function(){return C})),a.d(t,"q",(function(){return I})),a.d(t,"l",(function(){return A})),a.d(t,"o",(function(){return P})),a.d(t,"p",(function(){return F})),a.d(t,"m",(function(){return w}));var n=a(57),i=a.n(n),r=a(17),s=a(2),o=a(47),l=a(97),c=a(26),u=a(118),d=a(160),f=a(95),p=a(217),m=a(144),b=a(21);const g=10,h=1e4,_={border:"all",fontSize:"s",cellPadding:"s",stripes:!1,rowHover:"none",header:"shade"},y={showColumnSelector:!0,showDisplaySelector:!1,showSortSelector:!0,showFullScreenSelector:!1},O=e=>{const t=e.fields.map((e=>e.name));return t.filter((a=>{if(e.metaFields.includes(a))return!1;const n=a.split(".");return"keyword"!==n.pop()||!t.includes(n.join("."))}))};function E(e,t){let a={};if(e){const t=null==e?void 0:e.getComputedFields();if(void 0!==(null==t?void 0:t.runtimeFields)){const e=t.runtimeFields;Object(b.b)(e)&&(a={...a,...e})}}if(Object(b.b)(t)&&(a={...a,...t}),Object(b.b)(a))return a}const j=(e,t)=>Object.keys(e).map((a=>{let n;const i=e[a];switch(void 0!==i&&(u.a.has(i)||u.b.has(i))&&(n="numeric"),i){case"date":n="datetime";break;case"nested":case"geo_point":n="json";break;case"boolean":n="boolean";break;case"text":n=v}return a===`${t}.${d.c}`&&(n="numeric"),a.includes(`${t}.${d.d}`)&&(n="json"),a.includes(`${t}.${d.a}`)&&(n="featureImportance"),a===`${t}.${d.b}`&&(n="featureInfluence"),{id:a,schema:n,isSortable:!0}})),v="non-aggregatable",x=e=>{let t;switch(e){case o.ES_FIELD_TYPES.GEO_POINT:case o.ES_FIELD_TYPES.GEO_SHAPE:t="json";break;case o.ES_FIELD_TYPES.BOOLEAN:t="boolean";break;case o.ES_FIELD_TYPES.DATE:case o.ES_FIELD_TYPES.DATE_NANOS:t="datetime";break;case o.ES_FIELD_TYPES.BYTE:case o.ES_FIELD_TYPES.DOUBLE:case o.ES_FIELD_TYPES.FLOAT:case o.ES_FIELD_TYPES.HALF_FLOAT:case o.ES_FIELD_TYPES.INTEGER:case o.ES_FIELD_TYPES.LONG:case o.ES_FIELD_TYPES.SCALED_FLOAT:case o.ES_FIELD_TYPES.SHORT:case"number":t="numeric";case o.ES_FIELD_TYPES.KEYWORD:case o.ES_FIELD_TYPES.VERSION:case o.ES_FIELD_TYPES.TEXT:}return t},S=e=>{var t;let a;switch(null==e?void 0:e.type){case o.KBN_FIELD_TYPES.BOOLEAN:a="boolean";break;case o.KBN_FIELD_TYPES.DATE:a="datetime";break;case o.KBN_FIELD_TYPES.GEO_POINT:case o.KBN_FIELD_TYPES.GEO_SHAPE:a="json";break;case o.KBN_FIELD_TYPES.NUMBER:a="numeric";break;case o.KBN_FIELD_TYPES.NESTED:a="json"}return void 0===a&&!1===(null==e?void 0:e.aggregatable)||"numeric"===a&&null!=e&&null!==(t=e.esTypes)&&void 0!==t&&t.some((e=>e===o.ES_FIELD_TYPES.AGGREGATE_METRIC_DOUBLE))?v:a},D=(e,t)=>t?"true"===e:e,T=(e,t,a=!1)=>{const n=e[`${t}.feature_importance`];return void 0===n?[]:n.map((e=>({feature_name:Array.isArray(e.feature_name)?e.feature_name[0]:e.feature_name,classes:Array.isArray(e.classes)?e.classes.map((e=>{const t=w(e);return{importance:t.importance,class_name:D(t.class_name,a)}})):e.classes,importance:Array.isArray(e.importance)?e.importance[0]:e.importance})))},C=(e,t)=>{const a=e[`${t}.top_classes`];return void 0===a?[]:a.map((e=>w(e)))},I=(e,t,a,n,s)=>Object(r.useMemo)((()=>({rowIndex:r,columnId:c,setCellProps:u})=>{const d=r-t.pageIndex*t.pageSize,b=a[d];if(void 0===b)return null;if(void 0===e)return null;let g;void 0!==e&&(g=m.a.getFieldFormatFromIndexPattern(e,c,""));const h=function(e){if(a.hasOwnProperty(d)){const t=a[d];return t.hasOwnProperty(e)?t[e]:e===`${n}.feature_importance`?T(b,null!=n?n:l.d):e===`${n}.top_classes`?C(b,null!=n?n:l.d):Object(p.a)(a[d],e,null)}return null}(c);if("function"==typeof s&&s(c,h,b,u),"object"==typeof h&&null!==h)return JSON.stringify(h);if(null==h)return null;if(void 0!==g)return g.convert(h,"text");if("string"==typeof h||null===h)return h;const _=e.fields.getByName(c);return(null==_?void 0:_.type)===o.KBN_FIELD_TYPES.DATE?Object(f.d)(1e3*i()(h).unix()):"boolean"==typeof h?h?"true":"false":h}),[null==e?void 0:e.fields,t.pageIndex,t.pageSize,a]),A=(e,t)=>{var a;return null!==(a=Object(p.a)(e,t,null))&&void 0!==a?a:e[t]},P=e=>{const t=(a,n,i=0)=>{const r=e[i];let s=A(a,r.id),o=A(n,r.id);if("number"===r.type){var l,c;if(s=null!==(l=s)&&void 0!==l?l:0,o=null!==(c=o)&&void 0!==c?c:0,s<o)return"asc"===r.direction?-1:1;if(s>o)return"asc"===r.direction?1:-1}if("string"===r.type){var u,d;if(s=null!==(u=s)&&void 0!==u?u:"",o=null!==(d=o)&&void 0!==d?d:"",-1===s.localeCompare(o))return"asc"===r.direction?-1:1;if(1===s.localeCompare(o))return"asc"===r.direction?1:-1}return i+1<e.length?t(a,n,i+1):0};return t},F=(e,t)=>{const a=Object(c.b)(e);t.addDanger(s.i18n.translate("xpack.ml.dataGrid.columnChart.ErrorMessageToast",{defaultMessage:"An error occurred fetching the histogram charts data: {error}",values:{error:""!==a?a:e}}))},w=(e,t)=>{const a={...e};for(const e of Object.keys(a))void 0===t?Array.isArray(a[e])&&1===a[e].length&&(a[e]=a[e][0]):!1===t(e)&&Array.isArray(a[e])&&1===a[e].length&&(a[e]=a[e][0]);return a}},114:function(e,t,a){"use strict";a.d(t,"g",(function(){return i})),a.d(t,"h",(function(){return r})),a.d(t,"f",(function(){return s})),a.d(t,"c",(function(){return o})),a.d(t,"e",(function(){return l})),a.d(t,"b",(function(){return c})),a.d(t,"d",(function(){return u})),a.d(t,"a",(function(){return d}));var n=a(97);const i=e=>{if("object"!=typeof e||null===e)return!1;const t=Object.keys(e);return 1===t.length&&t[0]===n.a.OUTLIER_DETECTION},r=e=>{if("object"!=typeof e||null===e)return!1;const t=Object.keys(e);return 1===t.length&&t[0]===n.a.REGRESSION},s=e=>{if("object"!=typeof e||null===e)return!1;const t=Object.keys(e);return 1===t.length&&t[0]===n.a.CLASSIFICATION},o=e=>{let t="";return r(e)&&(t=e.regression.dependent_variable),s(e)&&(t=e.classification.dependent_variable),t},l=e=>{let t;return r(e)&&void 0!==e.regression.prediction_field_name?t=e.regression.prediction_field_name:s(e)&&void 0!==e.classification.prediction_field_name&&(t=e.classification.prediction_field_name),t},c=e=>`${o(e)}_prediction`,u=(e,t,a)=>`${e}.${l(t)||c(t)}`,d=e=>{const t=Object.keys(e||{});return 1===t.length?t[0]:"unknown"}},115:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"f",(function(){return r})),a.d(t,"g",(function(){return s})),a.d(t,"i",(function(){return o})),a.d(t,"h",(function(){return l})),a.d(t,"d",(function(){return c})),a.d(t,"c",(function(){return u})),a.d(t,"e",(function(){return d})),a(44);var n=a(97);let i;function r(e){return e===n.c.FAILED}function s(e){return e===n.c.ANALYZING||e===n.c.REINDEXING||e===n.c.STARTED||e===n.c.STARTING}function o(e){return e===n.c.STOPPED}function l(e){return"object"==typeof e&&null!==e&&{}.hasOwnProperty.call(e,"state")&&Object.values(n.c).includes(e.state)&&{}.hasOwnProperty.call(e,"progress")&&Array.isArray(e.progress)}function c(e){let t=0,a=0;for(const n of e.progress)if(t++,a=n.progress_percent,n.progress_percent<100)break;return{currentPhase:t,progress:a,totalPhases:e.progress.length}}a.d(t,"b",(function(){return n.c})),function(e){e.BATCH="batch",e.CONTINUOUS="continuous"}(i||(i={}));const u={configDestIndex:"config.dest.index",configSourceIndex:"config.source.index",configCreateTime:"config.create_time",description:"config.description",id:"id",memoryStatus:"stats.memory_usage.status"};function d(e){const t=function(e){if(l(e))return Math.round(e.progress.reduce(((e,t)=>e+t.progress_percent),0)/e.progress.length)}(e);return e.state===n.c.STOPPED&&100===t}},118:function(e,t,a){"use strict";a.d(t,"c",(function(){return l})),a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return u})),a.d(t,"d",(function(){return d})),a.d(t,"e",(function(){return f})),a.d(t,"g",(function(){return p})),a.d(t,"h",(function(){return m})),a.d(t,"f",(function(){return b}));var n=a(47),i=a(83),r=a(114),s=a(150),o=a(160);const l=10,c=new Set([n.ES_FIELD_TYPES.UNSIGNED_LONG,n.ES_FIELD_TYPES.LONG,n.ES_FIELD_TYPES.INTEGER,n.ES_FIELD_TYPES.SHORT,n.ES_FIELD_TYPES.BYTE]),u=new Set([n.ES_FIELD_TYPES.DOUBLE,n.ES_FIELD_TYPES.FLOAT,n.ES_FIELD_TYPES.HALF_FLOAT,n.ES_FIELD_TYPES.SCALED_FLOAT]),d="ml__id_copy",f="ml__incremental_id",p=e=>{var t;const{fields:a}=s.a,i=null===(t=a.find((t=>t.name===e)))||void 0===t?void 0:t.type;let r=!1;if(void 0!==i&&i===n.ES_FIELD_TYPES.KEYWORD){const t=s.a.getFieldById(e.replace(/\.keyword$/,""));r=null!==t&&t.type===n.ES_FIELD_TYPES.TEXT}else if(void 0!==i&&i===n.ES_FIELD_TYPES.TEXT){const t=s.a.getFieldById(`${e}.keyword`);r=null!==t&&t.type===n.ES_FIELD_TYPES.KEYWORD}return r},m=(e,t,a)=>{const n=a.dest.results_field;if(Object(r.g)(a.analysis)){if(e===`${n}.${o.c}`)return-1;if(t===`${n}.${o.c}`)return 1}if(Object(r.f)(a.analysis)||Object(r.h)(a.analysis)){const i=Object(r.c)(a.analysis),s=Object(r.d)(n,a.analysis,!0);if(e===`${n}.is_training`)return-1;if(t===`${n}.is_training`)return 1;if(e===s)return-1;if(t===s)return 1;if(e===i||e===i.replace(/\.keyword$/,""))return-1;if(t===i||t===i.replace(/\.keyword$/,""))return 1;if(e===`${n}.prediction_probability`)return-1;if(t===`${n}.prediction_probability`)return 1}const i=typeof e,s=typeof t,l=e.split("."),c=l[0],u=t.split("."),d=u[0];return c===n&&l.length>1&&d!==n?(l.shift(),l.shift(),l.join(".")===t?1:l.join(".").localeCompare(t)):d===n&&u.length>1&&c!==n?(u.shift(),u.shift(),u.join(".")===e?-1:e.localeCompare(u.join("."))):"string"!==i&&"string"===s?1:"string"===i&&"string"!==s?-1:e.localeCompare(t)},b=(e,t,a)=>{if(0===e.length)return{selectedFields:[],docFields:[]};const l=t.dest.results_field,c=[];let u,d;if(Object(r.g)(t.analysis)&&(e=t.analysis.outlier_detection.compute_feature_influence?e.filter((e=>!e.name.includes(`${l}.${o.b}.`))):e.filter((e=>!e.name.includes(`${l}.${o.b}`))),!0===a&&c.push({id:`${l}.${o.c}`,name:`${l}.${o.c}`,type:n.KBN_FIELD_TYPES.NUMBER})),Object(r.f)(t.analysis)||Object(r.h)(t.analysis)){var f;const p=Object(r.c)(t.analysis);u=null===(f=s.a.getFieldById(p))||void 0===f?void 0:f.type;const m=Object(r.e)(t.analysis),b=Object(i.q)(t.analysis),g=Object(i.p)(t.analysis),h=`${p}_prediction`;d=`${l}.${m||h}`,e=0===(null!=b?b:0)?e.filter((e=>!e.name.includes(`${l}.${o.a}`))):e.filter((e=>!e.name.includes(`${l}.${o.a}.`))),e=0===(null!=g?g:0)?e.filter((e=>!e.name.includes(`${l}.${o.d}`))):e.filter((e=>!e.name.includes(`${l}.${o.d}.`))),!0===a&&c.push({id:`${l}.is_training`,name:`${l}.is_training`,type:n.ES_FIELD_TYPES.BOOLEAN},{id:d,name:d,type:u})}c.push(...e),c.sort((({name:e},{name:a})=>m(e,a,t)));let p=c.filter((e=>e.name===d||!e.name.includes(".keyword")));return p.length>8&&(p=p.slice(0,8)),{selectedFields:p,docFields:c,depVarType:u}}},130:function(e,t,a){"use strict";a.d(t,"e",(function(){return n.i})),a.d(t,"c",(function(){return n.g})),a.d(t,"d",(function(){return n.h})),a.d(t,"g",(function(){return n.k})),a.d(t,"b",(function(){return n.f})),a.d(t,"j",(function(){return n.o})),a.d(t,"h",(function(){return n.l})),a.d(t,"k",(function(){return n.p})),a.d(t,"m",(function(){return n.q})),a.d(t,"i",(function(){return n.m})),a.d(t,"f",(function(){return O})),a.d(t,"l",(function(){return I})),a.d(t,"a",(function(){return de}));var n=a(111),i=a(24),r=a.n(i),s=a(23),o=a(17),l=a.n(o),c=a(90),u=a.n(c),d=a(44),f=a(2),p=a(47);const m=e=>"object"==typeof e&&e.hasOwnProperty("data")&&e.hasOwnProperty("id")&&e.hasOwnProperty("interval")&&e.hasOwnProperty("stats")&&e.hasOwnProperty("type")&&"numeric"===e.type,b=e=>"object"==typeof e&&e.hasOwnProperty("data")&&e.hasOwnProperty("cardinality")&&e.hasOwnProperty("id")&&e.hasOwnProperty("type")&&("ordinal"===e.type||"boolean"===e.type);var g=a(13);const h=new s.BehaviorSubject(null),_=Object(d.euiPaletteColorBlind)()[0],y=Object(d.euiPaletteColorBlind)({rotations:2})[10],O=e=>{if(e===n.c)return;let t;switch(e){case"datetime":t=p.KBN_FIELD_TYPES.DATE;break;case"numeric":t=p.KBN_FIELD_TYPES.NUMBER;break;case"boolean":t=p.KBN_FIELD_TYPES.BOOLEAN;break;case"json":t=p.KBN_FIELD_TYPES.OBJECT;break;default:t=p.KBN_FIELD_TYPES.STRING}return t},E=(e,t=20)=>{if("unsupported"===e.type)return f.i18n.translate("xpack.ml.dataGridChart.histogramNotAvailable",{defaultMessage:"Chart not supported."});if(0===e.data.length)return f.i18n.translate("xpack.ml.dataGridChart.notEnoughData",{defaultMessage:"0 documents contain field."});if("boolean"===e.type)return Object(g.jsx)("table",{className:"mlDataGridChart__legendBoolean"},Object(g.jsx)("tbody",null,Object(g.jsx)("tr",null,void 0!==e.data[0]&&Object(g.jsx)("td",null,e.data[0].key_as_string),void 0!==e.data[1]&&Object(g.jsx)("td",null,e.data[1].key_as_string))));if(b(e)&&e.cardinality<=t)return f.i18n.translate("xpack.ml.dataGridChart.singleCategoryLegend",{defaultMessage:"{cardinality, plural, one {# category} other {# categories}}",values:{cardinality:e.cardinality}});if(b(e)&&e.cardinality>t)return f.i18n.translate("xpack.ml.dataGridChart.topCategoriesLegend",{defaultMessage:"top {maxChartColumns} of {cardinality} categories",values:{cardinality:e.cardinality,maxChartColumns:t}});if(m(e)){const t=Math.round(100*e.stats[0])/100,a=Math.round(100*e.stats[1])/100;return t!==a?`${t} - ${a}`:""+t}return""};var j=a(14),v=a(92),x=a(68),S=a.n(x),D=a(49);a(360);const T={background:{color:"transparent"},chartMargins:{left:0,right:0,top:0,bottom:1},chartPaddings:{left:0,right:0,top:0,bottom:0},scales:{barsPadding:.1}},C=({chartData:e,columnType:t,dataTestSubj:a,hideLabel:n,maxChartColumns:i})=>{const{data:s,legendText:o}=((e,t,a)=>{const n=O(t.schema),i=u()(h),s=(e=>{switch(e){case p.KBN_FIELD_TYPES.BOOLEAN:case p.KBN_FIELD_TYPES.IP:case p.KBN_FIELD_TYPES.STRING:return"ordinal";case p.KBN_FIELD_TYPES.DATE:return"time";case p.KBN_FIELD_TYPES.NUMBER:return"linear"}})(n),o=a=>null==i||b(e)&&"ordinal"===s&&i._source[t.id]===a.key||m(e)&&"linear"===s&&i._source[t.id]>=+a.key&&i._source[t.id]<+a.key+e.interval||m(e)&&"time"===s&&1e3*r()(i._source[t.id]).unix()>=+a.key&&1e3*r()(i._source[t.id]).unix()<+a.key+e.interval?_:y;let l=[];return b(e)?l=e.data.map((e=>{var t;return{...e,key_as_string:null!==(t=e.key_as_string)&&void 0!==t?t:e.key,color:o(e)}})):m(e)&&(l=e.data.map((e=>({...e,key_as_string:e.key_as_string||e.key,color:o(e)})))),{data:l,legendText:E(e,a),xScaleType:s}})(e,t,i);return Object(g.jsx)("div",{"data-test-subj":a},!("object"==typeof(l=e)&&l.hasOwnProperty("type")&&"unsupported"===l.type)&&s.length>0&&Object(g.jsx)("div",{className:"mlDataGridChart__histogram","data-test-subj":`${a}-histogram`},Object(g.jsx)(D.Chart,null,Object(g.jsx)(D.Settings,{theme:T}),Object(g.jsx)(D.BarSeries,{id:"histogram",name:"count",xScaleType:D.ScaleType.Ordinal,yScaleType:D.ScaleType.Linear,xAccessor:"key_as_string",yAccessors:["doc_count"],styleAccessor:e=>e.datum.color,data:s}))),Object(g.jsx)("div",{className:S()("mlDataGridChart__legend",{"mlDataGridChart__legend--numeric":"number"===t.schema}),"data-test-subj":`${a}-legend`},o),!n&&Object(g.jsx)("div",{"data-test-subj":`${a}-id`},t.id));var l},I=(e,t=5,a=n.b,i)=>{const r={pageIndex:0,pageSize:t},[s,l]=Object(o.useState)(!1),[c,u]=Object(o.useState)(""),[d,f]=Object(o.useState)(""),[p,m]=Object(o.useState)(v.b.UNUSED),[b,h]=Object(o.useState)(0),[_,y]=Object(o.useState)(void 0),[O,E]=Object(o.useState)([]),[x,S]=Object(o.useState)([]),[D,T]=Object(o.useState)(r),[I,A]=Object(o.useState)([]),[P,F]=Object(o.useState)(void 0),w=Object(o.useCallback)((e=>{T((t=>({pageIndex:Math.floor(t.pageSize*t.pageIndex/e),pageSize:e})))}),[]),N=Object(o.useCallback)((e=>T((t=>({...t,pageIndex:e})))),[]),[L,k]=Object(o.useState)([]),M=e.map((e=>e.id)),R=(void 0!==i?M.filter(i):M).splice(0,a);Object(o.useEffect)((()=>{k(R)}),[R.join()]);const[G,B]=Object(o.useState)([]),$=Object(o.useCallback)((t=>{const a=t.reduce(((t,a)=>{const n=e.find((e=>e.id===a.id));return"json"===(null==n?void 0:n.schema)&&t.push(a.id),t}),[]);B(a),0===a.length&&A(t)}),[e]),Y=Object(o.useMemo)((()=>e.map(((e,t)=>{const a=O.find((t=>t.id===e.id));return{...e,display:void 0!==a&&!0===P?Object(g.jsx)(C,{chartData:a,columnType:e,dataTestSubj:`mlDataGridChart-${e.id}`}):void 0}})).sort(((e,t)=>-1===L.indexOf(e.id)&&L.indexOf(t.id)>-1?1:-1===L.indexOf(t.id)&&L.indexOf(e.id)>-1?-1:-1===L.indexOf(e.id)&&-1===L.indexOf(t.id)?e.id.localeCompare(t.id):L.indexOf(e.id)-L.indexOf(t.id)))),[e,O,P,JSON.stringify(L)]);return Object(o.useEffect)((()=>{void 0===P&&b>0&&void 0!==_&&F(b<=n.a&&_!==j.a.GTE)}),[P,b,_]),{ccsWarning:s,chartsVisible:P,chartsButtonVisible:!0,columnsWithCharts:Y,errorMessage:d,invalidSortingColumnns:G,noDataMessage:c,onChangeItemsPerPage:w,onChangePage:N,onSort:$,pagination:D,resetPagination:()=>T(r),rowCount:b,rowCountRelation:_,setColumnCharts:E,setCcsWarning:l,setErrorMessage:f,setNoDataMessage:u,setPagination:T,setRowCount:h,setRowCountRelation:y,setSortingColumns:A,setStatus:m,setTableItems:S,setVisibleColumns:k,sortingColumns:I,status:p,tableItems:x,toggleChartVisibility:()=>{void 0!==P&&F(!P)},visibleColumns:L}};var A=a(8),P=a(45),F=a(6),w=a(223),N=a(120),L=a.n(N),k=a(188);const M="feature_name",R="importance",G=1e-5,B=f.i18n.translate("xpack.ml.dataframe.analytics.decisionPathFeatureOtherTitle",{defaultMessage:"other"}),$=e=>Array.isArray(e)&&e.length>0&&3===e[0].length,Y=e=>null==e?"":"boolean"==typeof e?e?"True":"False":"number"==typeof e?e.toString():e,H=({baseline:e,featureImportance:t,predictedValue:a,predictedProbability:n})=>({decisionPathData:Object(o.useMemo)((()=>{if(void 0!==e)return Object(k.c)(e)?V({baseline:e.baseline,featureImportance:t,predictedValue:a}):Object(k.a)(e)?U({baselines:e.classes,featureImportance:t,currentClass:a,predictedProbability:n}):void 0}),[e,t,a])}),V=({baseline:e,featureImportance:t,predictedValue:a})=>{const n=t.map((e=>({...e,absImportance:Math.abs(e.importance)})));if(e&&void 0!==a&&Number.isFinite(a)){const t=a-n.reduce(((e,t)=>e+t.importance),0)-e;n.push({[M]:f.i18n.translate("xpack.ml.dataframe.analytics.decisionPathFeatureBaselineTitle",{defaultMessage:"baseline"}),[R]:e,absImportance:-1}),Math.abs(t)>G&&n.push({[M]:B,[R]:t,absImportance:0})}const i=n.filter((e=>void 0!==e)),r=i.sort(((e,t)=>t.absImportance-e.absImportance)).map((e=>[e.feature_name,e.importance,NaN]));let s=0;for(let e=i.length-1;e>=0;e--)s+=r[e][1],r[e][2]=s;return r},z=({predictedProbability:e,decisionPlotData:t})=>{if(e&&t.length>0){const a=e-t[0][2];Math.abs(a)>G&&(t.forEach((e=>e[2]=e[2]+a)),t.push([B,a,t[t.length-1][2]-a]))}return t},U=({baselines:e,featureImportance:t,currentClass:a,predictedProbability:n})=>{if(void 0===a||!(Array.isArray(e)&&e.length>=2))return[];const i=t.map((e=>{const t=Array.isArray(e.classes)?e.classes.find((e=>Y(e.class_name)===Y(a))):e;if(t&&"number"==typeof t.importance)return{[M]:e.feature_name,[R]:t.importance,absImportance:Math.abs(t.importance)}})),r=e.find((e=>Y(e.class_name)===Y(a))),s=null!=r&&r.baseline?null==r?void 0:r.baseline:0,o=i.filter((e=>void 0!==e)).sort(((e,t)=>t.absImportance-e.absImportance)).map((e=>[e.feature_name,e.importance,NaN]));return 2===e.length?(({decisionPlotData:e,startingBaseline:t,predictedProbability:a})=>{const n=e;let i=t;for(let e=n.length-1;e>=0;e--){i+=n[e][1];const t=Math.exp(i)/(Math.exp(i)+1);n[e][2]=t}return z({predictedProbability:a,decisionPlotData:n})})({startingBaseline:s,decisionPlotData:o,predictedProbability:n}):(({baselines:e,decisionPlotData:t,startingBaseline:a,featureImportance:n,predictedProbability:i})=>{const r=(({baselines:e,featureImportance:t})=>{let a=0;for(let n=0;n<e.length;n++){let i=0;for(let a=0;a<t.length;a++){const r=t[a],s=Array.isArray(r.classes)?r.classes.find((t=>Y(t.class_name)===Y(e[n].class_name))):r;s&&void 0!==s.importance&&"number"==typeof s.importance&&(i+=s.importance)}a+=Math.exp(e[n].baseline+i)}return a})({baselines:e,featureImportance:n}),s=a;let o=0;for(let e=t.length-1;e>=0;e--){o+=t[e][1];const a=Math.exp(s+o);t[e][2]=a/r}return z({predictedProbability:i,decisionPlotData:t})})({baselines:e,decisionPlotData:o,startingBaseline:s,featureImportance:t,predictedProbability:n})};var K=a(58),q=a(139);const{euiColorFullShade:W,euiColorMediumShade:J}=K.euiLightVars,Q={line:{strokeWidth:1,stroke:W,opacity:.75},details:{fontFamily:"Arial",fontSize:10,fill:J,padding:0}},X={axes:{axisLine:{stroke:J},tickLabel:{fontSize:10,fill:J},tickLine:{stroke:J},gridLine:{horizontal:{dash:[1,2]},vertical:{strokeWidth:0}}}},Z=Object(g.jsx)(d.EuiIcon,{type:"dot",size:"m"}),ee=({decisionPathData:e,predictionFieldName:t,minDomain:a,maxDomain:n,baseline:i})=>{const r=Object(o.useMemo)((()=>i&&Object(k.c)(i)?[{dataValue:i.baseline,header:Object(q.a)(i.baseline,"").toString(),details:f.i18n.translate("xpack.ml.dataframe.analytics.explorationResults.decisionPathBaselineText",{defaultMessage:"baseline (average of predictions for all data points in the training data set)"})}]:void 0),[i]),s=r?f.i18n.translate("xpack.ml.dataframe.analytics.explorationResults.decisionPathLinePredictionTitle",{defaultMessage:"Prediction"}):f.i18n.translate("xpack.ml.dataframe.analytics.explorationResults.decisionPathLinePredictionProbabilityTitle",{defaultMessage:"Prediction probability"}),l=Object(o.useCallback)((e=>Object(q.a)(e,"").toString()),[]);return Object(g.jsx)("div",{"data-test-subj":"mlDFADecisionPathChart"},Object(g.jsx)(D.Chart,{size:{height:125+10*e.length}},Object(g.jsx)(D.Settings,{theme:X,rotation:90}),r&&Object(g.jsx)(D.LineAnnotation,{id:"xpack.ml.dataframe.analytics.explorationResults.decisionPathBaseline",domainType:D.AnnotationDomainType.YDomain,dataValues:r,style:Q,marker:Z}),Object(g.jsx)(D.Axis,{id:"xpack.ml.dataframe.analytics.explorationResults.decisionPathXAxis",tickFormat:l,title:f.i18n.translate("xpack.ml.dataframe.analytics.explorationResults.decisionPathXAxisTitle",{defaultMessage:"{xAxisLabel} for '{predictionFieldName}'",values:{predictionFieldName:t,xAxisLabel:s}}),showGridLines:!1,position:D.Position.Top,showOverlappingTicks:!0,domain:a&&n?{min:a,max:n}:void 0}),Object(g.jsx)(D.Axis,{showGridLines:!0,id:"left",position:D.Position.Left}),Object(g.jsx)(D.LineSeries,{id:"xpack.ml.dataframe.analytics.explorationResults.decisionPathLine",name:s,xScaleType:D.ScaleType.Ordinal,yScaleType:D.ScaleType.Linear,xAccessor:0,yAccessors:[2],data:e})))},te=()=>Object(g.jsx)(d.EuiCallOut,{color:"warning"},Object(g.jsx)(P.FormattedMessage,{id:"xpack.ml.dataframe.analytics.explorationResults.regressionDecisionPathDataMissingCallout",defaultMessage:"No decision path data available."})),ae=({baseline:e,featureImportance:t,predictedValue:a,predictionFieldName:n})=>{const{decisionPathData:i}=H({baseline:e,featureImportance:t,predictedValue:a}),r=Object(o.useMemo)((()=>{let t,a;if(i&&$(i)){const[n,r]=L.a.extent(i,(e=>e[2]));t=r,a=n;const s=.1*Math.abs(t-a);t=("number"==typeof e?Math.max(t,e):t)+s,a=("number"==typeof e?Math.min(a,e):a)-s}return{maxDomain:t,minDomain:a}}),[i,e]);return i?Object(g.jsx)(l.a.Fragment,null,void 0===e&&Object(g.jsx)(d.EuiCallOut,{size:"s",heading:"p",title:Object(g.jsx)(P.FormattedMessage,{id:"xpack.ml.dataframe.analytics.explorationResults.missingBaselineCallout",defaultMessage:"Unable to calculate baseline value, which might result in a shifted decision path."}),color:"warning",iconType:"alert"}),Object(g.jsx)(ee,{decisionPathData:i,predictionFieldName:n,minDomain:r.minDomain,maxDomain:r.maxDomain,baseline:e})):Object(g.jsx)(te,null)},ne=({featureImportance:e})=>Object(g.jsx)(d.EuiCodeBlock,{isCopyable:!0},JSON.stringify(e)),ie=({featureImportance:e,predictedValue:t,topClasses:a,predictionFieldName:n,predictedProbability:i,baseline:r})=>{const[s,c]=Object(o.useState)(Y(a[0].class_name)),{decisionPathData:u}=H({baseline:r,featureImportance:e,predictedValue:s,predictedProbability:i}),p=Object(o.useMemo)((()=>{const e=Y(t);return Array.isArray(a)?a.map((t=>{const a=Y(t.class_name);return{value:a,inputDisplay:a===e?Object(g.jsx)(d.EuiHealth,{color:"success",style:{lineHeight:"inherit"}},a):a}})):void 0}),[a,t]),m=Object(o.useMemo)((()=>{let e,t;if(u&&$(u)){const[a,n]=L.a.extent(u,(e=>e[2])),i=.1*Math.abs(n-a);e=n+i,t=a-i}return{maxDomain:e,minDomain:t}}),[u]);return u?Object(g.jsx)(l.a.Fragment,null,Object(g.jsx)(d.EuiSpacer,{size:"xs"}),Object(g.jsx)(d.EuiTitle,{size:"xxxs"},Object(g.jsx)("span",null,f.i18n.translate("xpack.ml.dataframe.analytics.explorationResults.classificationDecisionPathClassNameTitle",{defaultMessage:"Class name"}))),void 0!==p&&Object(g.jsx)(d.EuiSuperSelect,{"data-test-subj":"mlDFADecisionPathClassNameSelect",compressed:!0,options:p,valueOfSelected:s,onChange:c}),Object(g.jsx)(ee,{decisionPathData:u,predictionFieldName:n,minDomain:m.minDomain,maxDomain:m.maxDomain})):Object(g.jsx)(te,null)};var re,se=a(80);!function(e){e.CHART="decision_path_chart",e.JSON="decision_path_json"}(re||(re={}));const oe=({baseline:e,featureImportance:t,predictedValue:a,topClasses:n,analysisType:i,predictionFieldName:r,predictedProbability:s})=>{const[c,u]=Object(o.useState)(re.CHART),{services:{docLinks:f}}=Object(se.b)(),p=f.links.ml.featureImportance;if(t.length<2)return Object(g.jsx)("div",{"data-test-subj":"mlDFADecisionPathJSONViewer"},Object(g.jsx)(ne,{featureImportance:t}));const m=[{id:re.CHART,name:Object(g.jsx)(P.FormattedMessage,{id:"xpack.ml.dataframe.analytics.explorationResults.decisionPathPlotTab",defaultMessage:"Decision plot"})},{id:re.JSON,name:Object(g.jsx)(P.FormattedMessage,{id:"xpack.ml.dataframe.analytics.explorationResults.decisionPathJSONTab",defaultMessage:"JSON"})}];return Object(g.jsx)("div",{"data-test-subj":"mlDFADecisionPathPopover"},Object(g.jsx)("div",{style:{display:"flex",width:300}},Object(g.jsx)(d.EuiTabs,{size:"s"},m.map((e=>Object(g.jsx)(d.EuiTab,{"data-test-subj":`mlDFADecisionPathPopoverTab-${e.id}`,isSelected:e.id===c,onClick:()=>u(e.id),key:e.id},e.name))))),c===re.CHART&&Object(g.jsx)(l.a.Fragment,null,Object(g.jsx)(d.EuiText,{size:"xs",color:"subdued",style:{paddingTop:5}},Object(g.jsx)(P.FormattedMessage,{id:"xpack.ml.dataframe.analytics.explorationResults.decisionPathPlotHelpText",defaultMessage:"SHAP decision plots use {linkedFeatureImportanceValues} to show how models arrive at the predicted value for '{predictionFieldName}'.",values:{predictionFieldName:r,linkedFeatureImportanceValues:Object(g.jsx)(d.EuiLink,{href:p,target:"_blank"},Object(g.jsx)(P.FormattedMessage,{id:"xpack.ml.dataframe.analytics.explorationResults.linkedFeatureImportanceValues",defaultMessage:"feature importance values"}))}})),i===v.a.CLASSIFICATION&&Object(k.a)(e)&&Object(g.jsx)(ie,{featureImportance:t,topClasses:n,predictedValue:Y(a),predictedProbability:s,predictionFieldName:r,baseline:e}),i===v.a.REGRESSION&&Object(k.c)(e)&&void 0!==a&&Object(g.jsx)(ae,{featureImportance:t,baseline:e,predictedValue:"string"==typeof a?parseFloat(a):a,predictionFieldName:r})),c===re.JSON&&Object(g.jsx)(ne,{featureImportance:t}))};var le=a(97);a(365);const ce=({title:e})=>Object(g.jsx)(d.EuiTitle,{size:"xs"},Object(g.jsx)("span",null,e));function ue(e){return"string"==typeof(null==e?void 0:e.title)&&""!==(null==e?void 0:e.title)}const de=Object(o.memo)((e=>{const{baseline:t,chartsVisible:a,chartsButtonVisible:i,ccsWarning:r,columnsWithCharts:s,dataTestSubj:l,errorMessage:c,invalidSortingColumnns:u,noDataMessage:p,onChangeItemsPerPage:m,onChangePage:b,onSort:h,pagination:_,setVisibleColumns:y,renderCellValue:O,rowCount:E,sortingColumns:j,status:x,tableItems:S,toastNotifications:D,toggleChartVisibility:T,visibleColumns:C,predictionFieldName:I,resultsField:A,analysisType:N}=e,L=Object(o.useCallback)((e=>{const{schema:a,rowIndex:i,cellContentsElement:r,DefaultCellPopover:s}=e;if(N===v.a.REGRESSION||N===v.a.CLASSIFICATION||N===v.a.OUTLIER_DETECTION){if("featureImportance"===a){const e=S[i];if(!e)return Object(g.jsx)("div",null);const a=null!=A?A:le.d;let r,s,o=[];void 0!==I&&e&&void 0!==e[`${a}.${I}`]&&(r=e[`${a}.${I}`],o=Object(n.n)(e,a),s=e[`${a}.prediction_probability`]);const l=o.reduce(((e,t)=>"boolean"==typeof t.class_name||e),!1),c=Object(n.j)(e,a,l);return Object(g.jsx)("div",{"data-test-subj":"mlDFAFeatureImportancePopover"},Object(g.jsx)(oe,{analysisType:N,predictedValue:r,predictedProbability:s,baseline:t,featureImportance:c,topClasses:o,predictionFieldName:I?I.replace("_prediction",""):void 0}))}return"featureInfluence"===a?Object(g.jsx)(d.EuiCodeBlock,{isCopyable:!0},r.textContent):Object(g.jsx)(s,e)}return Object(g.jsx)(s,e)}),[t,S]);Object(o.useEffect)((()=>{u.length>0&&u.forEach((e=>{D.addDanger(f.i18n.translate("xpack.ml.dataGrid.invalidSortingColumnError",{defaultMessage:"The column '{columnId}' cannot be used for sorting.",values:{columnId:e}}))}))}),[u,D]);const k=Object(o.useRef)(null);if(x===v.b.LOADED&&0===S.length)return Object(g.jsx)("div",{"data-test-subj":`${l} empty`},ue(e)&&Object(g.jsx)(ce,{title:e.title}),Object(g.jsx)(d.EuiCallOut,{title:f.i18n.translate("xpack.ml.dataGrid.IndexNoDataCalloutTitle",{defaultMessage:"Empty index query result."}),color:"primary"},Object(g.jsx)("p",null,f.i18n.translate("xpack.ml.dataGrid.IndexNoDataCalloutBody",{defaultMessage:"The query for the index returned no results. Please make sure you have sufficient permissions, the index contains documents and your query is not too restrictive."}))));if(""!==p)return Object(g.jsx)("div",{"data-test-subj":`${l} empty`},ue(e)&&Object(g.jsx)(ce,{title:e.title}),Object(g.jsx)(d.EuiCallOut,{title:f.i18n.translate("xpack.ml.dataGrid.dataGridNoDataCalloutTitle",{defaultMessage:"Index preview not available"}),color:"primary"},Object(g.jsx)("p",null,p)));let M;return x===v.b.ERROR&&(M=c&&!c.includes("failed to create query")?Object(g.jsx)(d.EuiCallOut,{title:f.i18n.translate("xpack.ml.dataframe.analytics.exploration.querySyntaxError",{defaultMessage:"An error occurred loading the index data. Please ensure your query syntax is valid."}),color:"danger",iconType:"cross"},Object(g.jsx)("p",null,c)):Object(g.jsx)(d.EuiCallOut,{title:f.i18n.translate("xpack.ml.dataGrid.indexDataError",{defaultMessage:"An error occurred loading the index data."}),color:"danger",iconType:"cross"},Object(g.jsx)(d.EuiCodeBlock,{language:"json",fontSize:"s",paddingSize:"s",isCopyable:!0},c))),Object(g.jsx)("div",{"data-test-subj":`${l} ${x===v.b.ERROR?"error":"loaded"}`,ref:k},ue(e)&&Object(g.jsx)(d.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween"},Object(g.jsx)(d.EuiFlexItem,null,Object(g.jsx)(ce,{title:e.title})),e.copyToClipboard&&e.copyToClipboardDescription&&Object(g.jsx)(d.EuiFlexItem,{grow:!1},Object(g.jsx)(d.EuiCopy,{beforeMessage:e.copyToClipboardDescription,textToCopy:e.copyToClipboard},(t=>Object(g.jsx)(d.EuiButtonIcon,{onClick:t,iconType:"copyClipboard","aria-label":e.copyToClipboardDescription}))))),void 0!==M&&Object(g.jsx)("div",{"data-test-subj":`${l} error`},M,Object(g.jsx)(d.EuiSpacer,{size:"m"})),r&&Object(g.jsx)("div",{"data-test-subj":`${l} ccsWarning`},Object(g.jsx)(d.EuiCallOut,{title:f.i18n.translate("xpack.ml.dataGrid.CcsWarningCalloutTitle",{defaultMessage:"Cross-cluster search returned no fields data."}),color:"warning"},Object(g.jsx)("p",null,f.i18n.translate("xpack.ml.dataGrid.CcsWarningCalloutBody",{defaultMessage:"There was an issue retrieving data for the data view. Source preview in combination with cross-cluster search is only supported for versions 7.10 and above. You may still configure and create the transform."}))),Object(g.jsx)(d.EuiSpacer,{size:"m"})),Object(g.jsx)(d.EuiMutationObserver,{observerOptions:{subtree:!0,attributes:!0,childList:!0},onMutation:()=>{if(null!==k.current){const e=k.current.querySelectorAll(".euiDataGrid__virtualized");for(const t of Array.from(e))Object(F.isPopulatedObject)(t)&&Object(F.isPopulatedObject)(t.style)&&"auto"!==t.style.height&&(t.style.height="auto")}}},(t=>Object(g.jsx)("div",{className:"mlDataGrid",ref:t},Object(g.jsx)(d.EuiDataGrid,{"aria-label":ue(e)?e.title:"",columns:s.map((e=>(e.initialWidth=165,e))),columnVisibility:{visibleColumns:C,setVisibleColumns:y},gridStyle:n.d,rowCount:E,renderCellValue:O,renderCellPopover:L,sorting:{columns:j,onSort:h},toolbarVisibility:{...n.e,...i?{additionalControls:Object(g.jsx)(d.EuiToolTip,{content:f.i18n.translate("xpack.ml.dataGrid.histogramButtonToolTipContent",{defaultMessage:"Queries run to fetch histogram chart data will use a sample size per shard of {samplerShardSize} documents.",values:{samplerShardSize:w.a}})},Object(g.jsx)(d.EuiButtonEmpty,{"aria-pressed":!0===a,className:"euiDataGrid__controlBtn"+(!0===a?" euiDataGrid__controlBtn--active":""),"data-test-subj":`${l}HistogramButton`,size:"xs",iconType:"visBarVertical",color:"text",onClick:T,disabled:void 0===a},Object(g.jsx)(P.FormattedMessage,{id:"xpack.ml.dataGrid.histogramButtonText",defaultMessage:"Histogram charts"})))}:{}},pagination:{..._,pageSizeOptions:[5,10,25],onChangeItemsPerPage:m,onChangePage:b}})))))}),((e,t)=>Object(A.isEqual)(fe(e),fe(t))));function fe(e){return[e.columnsWithCharts,e.dataTestSubj,e.errorMessage,e.invalidSortingColumnns,e.noDataMessage,e.pagination,e.rowCount,e.sortingColumns,e.status,e.tableItems,e.visibleColumns,...ue(e)?[e.copyToClipboard,e.copyToClipboardDescription,e.title]:[]]}},150:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(47),i=a(219),r=a(81);class NewJobCapsServiceAnalytics extends i.a{async initializeFromDataVIew(e){try{const t=function(e,t){const a=e[t],i=[],r={};return void 0!==a&&(a.fields.forEach((e=>{e.type===n.ES_FIELD_TYPES.NESTED&&void 0===r[e.name]&&(r[e.name]=!0,i.push(e))})),Object.keys(r).length>0?a.fields.forEach((e=>{if(e.type!==n.ES_FIELD_TYPES.NESTED){const t=e.name.split(".").shift();t&&void 0===r[t]&&i.push(e)}})):i.push(...a.fields)),i}(await r.ml.dataFrameAnalytics.newJobCapsAnalytics(e.title,"rollup"===e.type),e.title),{fieldsPreferringKeyword:a}=Object(i.b)(t);this._fields=a}catch(e){console.error("Unable to load analytics index fields",e)}}}const s=new NewJobCapsServiceAnalytics},160:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i})),a.d(t,"d",(function(){return r})),a.d(t,"c",(function(){return s}));const n="feature_importance",i="feature_influence",r="top_classes",s="outlier_score"},169:function(e,t,a){"use strict";a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return c}));var n=a(2),i=a(81),r=a(92),s=a(115),o=a(97);const l=e=>({}.hasOwnProperty.call(e,"count")&&{}.hasOwnProperty.call(e,"data_frame_analytics")&&Array.isArray(e.data_frame_analytics));const c=(e,t,a,c,u,d)=>{let f=0;const p=async(m=!1)=>{if(!0===m||!1===d){if(r.v.next(r.e.LOADING),f++,f>1)return;try{const d=await i.ml.dataFrameAnalytics.getDataFrameAnalytics(),f=await i.ml.dataFrameAnalytics.getDataFrameAnalyticsStats(),p=l(f)?function(e){const t=e.data_frame_analytics.reduce(((e,{state:t})=>(Object(s.f)(t)?e.failed.value=++e.failed.value:Object(s.g)(t)?e.started.value=++e.started.value:Object(s.i)(t)&&(e.stopped.value=++e.stopped.value),e)),{total:{label:n.i18n.translate("xpack.ml.overview.statsBar.totalAnalyticsLabel",{defaultMessage:"Total analytics jobs"}),value:0,show:!0},started:{label:n.i18n.translate("xpack.ml.overview.statsBar.runningAnalyticsLabel",{defaultMessage:"Running"}),value:0,show:!0},stopped:{label:n.i18n.translate("xpack.ml.overview.statsBar.stoppedAnalyticsLabel",{defaultMessage:"Stopped"}),value:0,show:!0},failed:{label:n.i18n.translate("xpack.ml.overview.statsBar.failedAnalyticsLabel",{defaultMessage:"Failed"}),value:0,show:!1}});return t.failed.show=t.failed.value>0,t.total.value=e.count,t}(f):void 0;let m=0;const b=d.data_frame_analytics.reduce(((e,t)=>{const a=l(f)?f.data_frame_analytics.find((e=>t.id===e.id)):void 0;return Object(s.h)(a)?(a.state===o.c.STARTING&&void 0===a.node&&m++,e.push({checkpointing:{},config:t,id:t.id,job_type:Object(r.h)(t.analysis),mode:s.a.BATCH,state:a.state,stats:a}),e):e}),[]);e(b),t(p),a(void 0),c(!0),u(m),r.v.next(r.e.IDLE)}catch(n){r.v.next(r.e.ERROR),r.v.next(r.e.IDLE),e([]),t(void 0),a(n),c(!0)}if(f--,f>0)return f=0,void p(!0)}};return p}},188:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"d",(function(){return r})),a.d(t,"a",(function(){return s})),a.d(t,"c",(function(){return o}));var n=a(6);function i(e){return void 0!==e.classes}function r(e){return void 0!==e.importance}function s(e){return Object(n.isPopulatedObject)(e,["classes"])&&Array.isArray(e.classes)}function o(e){return Object(n.isPopulatedObject)(e,["baseline"])}},216:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(2);function i(e,t){if(void 0===e||void 0===t)return{iconType:"empty",message:""};let a,i="alert",r=0,s=0;if(Array.isArray(e)){if(1!==e.length)return{iconType:"alert",message:n.i18n.translate("xpack.ml.formatters.metricChangeDescription.unusualValuesDescription",{defaultMessage:"Unusual values"})};r=e[0]}else r=e;if(Array.isArray(t)?1===t.length&&(s=t[0]):s=t,r===s)a=n.i18n.translate("xpack.ml.formatters.metricChangeDescription.actualSameAsTypicalDescription",{defaultMessage:"actual same as typical"});else{const e=r>s;if(i=e?"sortUp":"sortDown",0!==s&&0!==r){const t=e?r/s:s/r;a=t>1.5?t<=100?e?n.i18n.translate("xpack.ml.formatters.metricChangeDescription.moreThanOneAndHalfxHigherDescription",{defaultMessage:"{factor}x higher",values:{factor:Math.round(t)}}):n.i18n.translate("xpack.ml.formatters.metricChangeDescription.moreThanOneAndHalfxLowerDescription",{defaultMessage:"{factor}x lower",values:{factor:Math.round(t)}}):e?n.i18n.translate("xpack.ml.formatters.metricChangeDescription.moreThan100xHigherDescription",{defaultMessage:"More than 100x higher"}):n.i18n.translate("xpack.ml.formatters.metricChangeDescription.moreThan100xLowerDescription",{defaultMessage:"More than 100x lower"}):t>=1.05?e?n.i18n.translate("xpack.ml.formatters.metricChangeDescription.moreThanOneAndFiveHundredthsxHigherDescription",{defaultMessage:"{factor}x higher",values:{factor:t.toPrecision(2)}}):n.i18n.translate("xpack.ml.formatters.metricChangeDescription.moreThanOneAndFiveHundredthsxLowerDescription",{defaultMessage:"{factor}x lower",values:{factor:t.toPrecision(2)}}):e?n.i18n.translate("xpack.ml.formatters.metricChangeDescription.unusuallyHighDescription",{defaultMessage:"Unusually high"}):n.i18n.translate("xpack.ml.formatters.metricChangeDescription.unusuallyLowDescription",{defaultMessage:"Unusually low"})}else a=0===r?n.i18n.translate("xpack.ml.formatters.metricChangeDescription.unexpectedZeroValueDescription",{defaultMessage:"Unexpected zero value"}):n.i18n.translate("xpack.ml.formatters.metricChangeDescription.unexpectedNonZeroValueDescription",{defaultMessage:"Unexpected non-zero value"})}return{iconType:i,message:a}}},219:function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return NewJobCapabilitiesServiceBase}));var n=a(5),i=a.n(n),r=a(47);function s(e){const t=e.filter((e=>e.type===r.ES_FIELD_TYPES.KEYWORD)).map((e=>e.id)),a=e.filter((e=>e.type===r.ES_FIELD_TYPES.TEXT)).map((e=>e.id));return{fieldsPreferringKeyword:e.filter((e=>e.type!==r.ES_FIELD_TYPES.TEXT||e.type===r.ES_FIELD_TYPES.TEXT&&!1===t.includes(`${e.id}.keyword`))),fieldsPreferringText:e.filter((e=>e.type!==r.ES_FIELD_TYPES.KEYWORD||e.type===r.ES_FIELD_TYPES.KEYWORD&&!1===a.includes(e.id.replace(/\.keyword$/,""))))}}class NewJobCapabilitiesServiceBase{constructor(){i()(this,"_fields",void 0),i()(this,"_aggs",void 0),this._fields=[],this._aggs=[]}get fields(){return this._fields}get aggs(){return this._aggs}get newJobCaps(){return{fields:this._fields,aggs:this._aggs}}getFieldById(e){const t=this._fields.find((t=>t.id===e));return void 0===t?null:t}getAggById(e){const t=this._aggs.find((t=>t.id===e));return void 0===t?null:t}}},221:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(83),i=a(222);const r=e=>{switch(e){case n.b.CLASSIFICATION:return i.a.NOMINAL;case n.b.REGRESSION:return i.a.QUANTITATIVE;default:return}}},222:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n={NOMINAL:"nominal",QUANTITATIVE:"quantitative"}},223:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=5e3},360:function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(361);case"v8light":return a(363)}},361:function(e,t,a){var n=a(86),i=a(362);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);n(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},362:function(e,t,a){(t=a(87)(!1)).push([e.i,".mlDataGridChart__histogram{height:72px;width:100%}.mlDataGridChart__legend{color:#535966;display:block;font-size:12px;font-size:.85714rem;font-style:italic;font-weight:400;line-height:1.14286rem;margin:4px 0 0;max-width:100%;overflow:hidden!important;overflow-x:hidden;text-align:left;text-overflow:ellipsis!important;white-space:nowrap!important}.mlDataGridChart__legend--numeric{text-align:right}.mlDataGridChart__legendBoolean{min-width:112px;width:100%}.mlDataGridChart__legendBoolean td{text-align:center}",""]),e.exports=t},363:function(e,t,a){var n=a(86),i=a(364);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);n(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},364:function(e,t,a){(t=a(87)(!1)).push([e.i,".mlDataGridChart__histogram{height:72px;width:100%}.mlDataGridChart__legend{color:#98a2b3;display:block;font-size:12px;font-size:.85714rem;font-style:italic;font-weight:400;line-height:1.14286rem;margin:4px 0 0;max-width:100%;overflow:hidden!important;overflow-x:hidden;text-align:left;text-overflow:ellipsis!important;white-space:nowrap!important}.mlDataGridChart__legend--numeric{text-align:right}.mlDataGridChart__legendBoolean{min-width:112px;width:100%}.mlDataGridChart__legendBoolean td{text-align:center}",""]),e.exports=t},365:function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(366);case"v8light":return a(368)}},366:function(e,t,a){var n=a(86),i=a(367);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);n(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},367:function(e,t,a){(t=a(87)(!1)).push([e.i,".mlDataGrid .euiDataGridRowCell--boolean{text-transform:none}.mlDataGrid .euiDataGridHeaderCell .euiDataGridHeaderCell__icon,.mlDataGrid .euiDataGridHeaderCell .euiDataGridHeaderCell__sortingArrow,.mlDataGrid .euiDataGridHeaderCell .euiPopover{margin-top:auto}",""]),e.exports=t},368:function(e,t,a){var n=a(86),i=a(369);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);n(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},369:function(e,t,a){(t=a(87)(!1)).push([e.i,".mlDataGrid .euiDataGridRowCell--boolean{text-transform:none}.mlDataGrid .euiDataGridHeaderCell .euiDataGridHeaderCell__icon,.mlDataGrid .euiDataGridHeaderCell .euiDataGridHeaderCell__sortingArrow,.mlDataGrid .euiDataGridHeaderCell .euiPopover{margin-top:auto}",""]),e.exports=t},83:function(e,t,a){"use strict";a.d(t,"a",(function(){return d})),a.d(t,"f",(function(){return f})),a.d(t,"i",(function(){return p})),a.d(t,"k",(function(){return m})),a.d(t,"j",(function(){return b})),a.d(t,"e",(function(){return g})),a.d(t,"l",(function(){return h})),a.d(t,"n",(function(){return _})),a.d(t,"d",(function(){return y})),a.d(t,"t",(function(){return O})),a.d(t,"p",(function(){return E})),a.d(t,"q",(function(){return j})),a.d(t,"A",(function(){return v})),a.d(t,"z",(function(){return x})),a.d(t,"w",(function(){return S})),a.d(t,"g",(function(){return D})),a.d(t,"D",(function(){return T})),a.d(t,"E",(function(){return C})),a.d(t,"c",(function(){return I})),a.d(t,"u",(function(){return A})),a.d(t,"h",(function(){return F})),a.d(t,"C",(function(){return w})),a.d(t,"B",(function(){return N}));var n=a(17),i=a(23),r=a(25),s=a(8),o=a(81),l=a(26),c=a(114);a.d(t,"x",(function(){return c.g})),a.d(t,"y",(function(){return c.h})),a.d(t,"v",(function(){return c.f})),a.d(t,"s",(function(){return c.e})),a.d(t,"o",(function(){return c.c})),a.d(t,"r",(function(){return c.d}));var u=a(97);let d,f;a.d(t,"b",(function(){return u.a})),a.d(t,"m",(function(){return c.a})),function(e){e.ALPHA="alpha",e.ETA="eta",e.ETA_GROWTH_RATE_PER_TREE="eta_growth_rate_per_tree",e.DOWNSAMPLE_FACTOR="downsample_factor",e.FEATURE_BAG_FRACTION="feature_bag_fraction",e.FEATURE_INFLUENCE_THRESHOLD="feature_influence_threshold",e.GAMMA="gamma",e.LAMBDA="lambda",e.MAX_TREES="max_trees",e.MAX_OPTIMIZATION_ROUNDS_PER_HYPERPARAMETER="max_optimization_rounds_per_hyperparameter",e.METHOD="method",e.N_NEIGHBORS="n_neighbors",e.NUM_TOP_CLASSES="num_top_classes",e.NUM_TOP_FEATURE_IMPORTANCE_VALUES="num_top_feature_importance_values",e.OUTLIER_FRACTION="outlier_fraction",e.RANDOMIZE_SEED="randomize_seed",e.SOFT_TREE_DEPTH_LIMIT="soft_tree_depth_limit",e.SOFT_TREE_DEPTH_TOLERANCE="soft_tree_depth_tolerance"}(d||(d={})),function(e){e.LOF="lof",e.LDOF="ldof",e.DISTANCE_KTH_NN="distance_kth_nn",e.DISTANCE_KNN="distance_knn"}(f||(f={}));const p=1e3,m=1,b=100,g=0,h={match_all:{}},_=(e,t)=>({bool:{minimum_should_match:1,should:[{match:{[`${e}.is_training`]:t}}]}});let y;!function(e){e[e.UNUSED=0]="UNUSED",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED",e[e.ERROR=3]="ERROR"}(y||(y={}));const O=e=>{let t;return Object(c.h)(e)&&(t=e.regression.training_percent),Object(c.f)(e)&&(t=e.classification.training_percent),t},E=e=>{let t;return Object(c.f)(e)&&void 0!==e.classification.num_top_classes&&(t=e.classification.num_top_classes),t},j=e=>{let t;return Object(c.h)(e)&&void 0!==e.regression.num_top_feature_importance_values?t=e.regression.num_top_feature_importance_values:Object(c.f)(e)&&void 0!==e.classification.num_top_feature_importance_values&&(t=e.classification.num_top_feature_importance_values),t},v=e=>{if(void 0===e)return!1;const t=Object.keys(e);return 1===t.length&&"bool"===t[0]},x=e=>{var t,a;const n=Object.keys(e);return 1===n.length&&n[0]===u.a.REGRESSION&&void 0!==(null==e||null===(t=e.regression)||void 0===t?void 0:t.mse)&&void 0!==(null==e||null===(a=e.regression)||void 0===a?void 0:a.r_squared)},S=e=>{var t,a;const n=Object.keys(e);return 1===n.length&&n[0]===u.a.CLASSIFICATION&&(void 0!==(null==e||null===(t=e.classification)||void 0===t?void 0:t.multiclass_confusion_matrix)||void 0!==(null==e||null===(a=e.classification)||void 0===a?void 0:a.auc_roc))};let D;!function(e){e.ERROR="error",e.IDLE="idle",e.LOADING="loading",e.REFRESH="refresh"}(D||(D={}));const T=new i.BehaviorSubject(D.IDLE),C=(e={})=>(Object(n.useEffect)((()=>{const t=T.pipe(Object(r.distinctUntilChanged)()),a=[];return"function"==typeof e.onRefresh&&a.push(t.pipe(Object(r.filter)((e=>e===D.REFRESH))).subscribe((()=>{"function"==typeof e.onRefresh&&e.onRefresh()}))),"function"==typeof e.isLoading&&a.push(t.subscribe((t=>"function"==typeof e.isLoading&&e.isLoading(t===D.LOADING)))),()=>{a.map((e=>e.unsubscribe()))}}),[e.onRefresh]),{refresh:()=>{T.next(D.REFRESH),T.next(D.LOADING)}}),I="--";function A(e){const t={mse:I,msle:I,huber:I,r_squared:I};if(null!=e&&e.regression)for(const n in e.regression)if(e.regression.hasOwnProperty(n)){var a;let i=null===(a=e.regression[n])||void 0===a?void 0:a.value;i&&Number.isFinite(i)&&(i=Number(i.toPrecision(3))),t[n]=i}return t}function P({resultsField:e,isTraining:t,searchQuery:a,ignoreDefaultQuery:n}){let i;const r={term:{[`${e}.is_training`]:{value:t}}},o=Object(s.cloneDeep)(a);return v(o)?(void 0===o.bool.must&&(o.bool.must=[]),void 0!==t&&o.bool.must.push(r),i=o):(e=>{if(void 0===e)return!1;const t=Object.keys(e);return 1===t.length&&"query_string"===t[0]})(o)?(i={bool:{must:[o]}},void 0!==t&&i.bool.must.push(r)):i={bool:{must:void 0!==t?[r]:[]}},i}let F;!function(e){e.MSE="mse",e.MSLE="msle",e.R_SQUARED="rSquared",e.HUBER="huber"}(F||(F={}));const w=async({isTraining:e,index:t,dependentVariable:a,resultsField:n,predictionFieldName:i,searchQuery:r,ignoreDefaultQuery:s,jobType:c,requiresKeyword:d,rocCurveClassName:f,includeMulticlassConfusionMatrix:p=!0})=>{const m={success:!1,eval:null,error:null};let b=`${n}.${i||`${a}_prediction`}`;c===u.a.CLASSIFICATION&&!0===d&&(b=`${b}.keyword`);const g={classification:{accuracy:{},recall:{},...p?{multiclass_confusion_matrix:{}}:{},...void 0!==f?{auc_roc:{include_curve:!0,class_name:f}}:{}},regression:{r_squared:{},mse:{},msle:{},huber:{}}},h={index:t,query:P({resultsField:n,isTraining:e,searchQuery:r,ignoreDefaultQuery:s}),evaluation:{[c]:{actual_field:a,predicted_field:b,...c===u.a.CLASSIFICATION?{top_classes_field:`${n}.top_classes`}:{},metrics:g[c]}}};try{const e=await o.ml.dataFrameAnalytics.evaluateDataFrameAnalytics(h);return m.success=!0,m.eval=e,m}catch(e){return m.error=Object(l.b)(e),m}},N=async({ignoreDefaultQuery:e=!0,isTraining:t,searchQuery:a,resultsField:n,destIndex:i})=>{const r=P({resultsField:n,isTraining:t,ignoreDefaultQuery:e,searchQuery:a});try{const e={track_total_hits:!0,query:r},t=await o.ml.esSearch({index:i,size:0,body:e}),a=t.hits.total&&t.hits.total.value;return{docsCount:a,success:void 0!==a}}catch(e){return{docsCount:null,success:!1}}}},92:function(e,t,a){"use strict";a.d(t,"h",(function(){return n.m})),a.d(t,"k",(function(){return n.o})),a.d(t,"p",(function(){return n.s})),a.d(t,"j",(function(){return n.n})),a.d(t,"s",(function(){return n.x})),a.d(t,"v",(function(){return n.D})),a.d(t,"x",(function(){return n.E})),a.d(t,"e",(function(){return n.g})),a.d(t,"d",(function(){return n.f})),a.d(t,"r",(function(){return n.u})),a.d(t,"u",(function(){return n.C})),a.d(t,"t",(function(){return n.B})),a.d(t,"o",(function(){return n.r})),a.d(t,"b",(function(){return n.d})),a.d(t,"f",(function(){return n.i})),a.d(t,"g",(function(){return n.l})),a.d(t,"a",(function(){return n.b})),a.d(t,"i",(function(){return i.f})),a.d(t,"w",(function(){return i.h})),a.d(t,"c",(function(){return i.c})),a.d(t,"m",(function(){return l})),a.d(t,"n",(function(){return u})),a.d(t,"l",(function(){return d})),a.d(t,"q",(function(){return f.a})),a.d(t,"y",(function(){return E}));var n=a(83),i=a(118),r=a(26),s=a(130),o=a(81);const l=async(e,t,a,l)=>{if(void 0!==e){const{pagination:c,setErrorMessage:u,setRowCount:d,setRowCountRelation:f,setStatus:p,setTableItems:m,sortingColumns:b}=t;u(""),p(n.d.LOADING);try{const t=b.map((e=>{const{id:t}=e;return e.id=Object(i.g)(t)?`${t}.keyword`:t,e})).reduce(((e,t)=>(e[t.id]={order:t.direction},e)),{}),{pageIndex:r,pageSize:u}=c,g=await o.ml.esSearch({index:e.dest.index,body:{fields:["*"],_source:!1,query:a,from:r*u,size:u,...Object.keys(t).length>0?{sort:t}:{}}});l.didCancel||(d("number"==typeof g.hits.total?g.hits.total:g.hits.total.value),f("number"==typeof g.hits.total?"eq":g.hits.total.relation),m(g.hits.hits.map((t=>{var a;return Object(s.i)(null!==(a=t.fields)&&void 0!==a?a:{},(t=>t.startsWith(`${e.dest.results_field}.feature_importance`)||t.startsWith(`${e.dest.results_field}.feature_influence`)))}))),p(n.d.LOADED))}catch(e){u(Object(r.b)(e)),p(n.d.ERROR)}}};var c=a(150);const u=(e,t)=>{const{fields:a}=c.a;if(void 0!==e){const{selectedFields:n,docFields:r}=Object(i.f)(a,e,t),s={},o=[];return r.forEach((e=>{s[e.id]=e.type,o.push(e.id)})),{defaultSelectedFields:n.map((e=>e.id)),fieldTypes:s,tableFields:o}}return{defaultSelectedFields:[],fieldTypes:{},tableFields:[]}},d=e=>{var t;return null!==(t=Array.isArray(null==e?void 0:e.dest.index)?null==e?void 0:e.dest.index[0]:null==e?void 0:e.dest.index)&&void 0!==t?t:""};var f=a(221),p=a(17),m=a(2),b=a(104),g=a(102),h=a(169),_=a(137),y=a(85),O=a(114);const E=e=>{const t=Object(g.b)(),a=Object(_.b)(),[n,i]=Object(p.useState)(void 0),[s,l]=Object(p.useState)(void 0),[u,f]=Object(p.useState)(!1),[E,j]=Object(p.useState)(!1),[v,x]=Object(p.useState)(!1),[S,D]=Object(p.useState)(void 0),[T,C]=Object(p.useState)(void 0),[I,A]=Object(p.useState)(void 0),[P,F]=Object(p.useState)(void 0),[w,N]=Object(p.useState)(void 0);return Object(p.useEffect)((()=>{!async function(){x(!1);try{const g=await o.ml.dataFrameAnalytics.getDataFrameAnalytics(e),_=await o.ml.dataFrameAnalytics.getDataFrameAnalyticsStats(e),E=Object(h.b)(_)?_.data_frame_analytics[0]:void 0;if(void 0!==E&&E.state&&F(E.state),Array.isArray(g.data_frame_analytics)&&g.data_frame_analytics.length>0){const o=g.data_frame_analytics[0];if(Object(O.f)(o.analysis)||Object(O.h)(o.analysis))try{var n;const t=(await a.getTrainedModels(`${e}*`,{include:"total_feature_importance"})).find((t=>{var a,n;return(null===(a=t.metadata)||void 0===a||null===(n=a.analytics_config)||void 0===n?void 0:n.id)===e}));var s;!0===Array.isArray(null==t||null===(n=t.metadata)||void 0===n?void 0:n.total_feature_importance)&&N(null==t||null===(s=t.metadata)||void 0===s?void 0:s.total_feature_importance)}catch(e){Object(y.a)().displayErrorToast(e)}try{var u;const e=d(o),a=null!==(u=await Object(b.d)(e))&&void 0!==u?u:e;let n;try{n=await t.dataViewsContract.get(a),await t.dataViewsContract.refreshFields(n)}catch(e){n=void 0}if(void 0===n){var p;j(!0);const e=o.source.index[0],a=null!==(p=await Object(b.d)(e))&&void 0!==p?p:e;try{n=await t.dataViewsContract.get(a)}catch(e){n=void 0}}void 0!==n?(await c.a.initializeFromDataVIew(n),D(g.data_frame_analytics[0]),i(n),f(!0),x(!1)):l(m.i18n.translate("xpack.ml.dataframe.analytics.results.dataViewMissingErrorMessage",{defaultMessage:"To view this page, a Kibana data view is necessary for either the destination or source index of this analytics job."}))}catch(e){C(Object(r.b)(e)),x(!1)}}}catch(e){A(Object(r.b)(e)),x(!1)}}()}),[]),{indexPattern:n,indexPatternErrorMessage:s,isInitialized:u,isLoadingJobConfig:v,jobCapsServiceErrorMessage:T,jobConfig:S,jobConfigErrorMessage:I,jobStatus:P,needsDestIndexPattern:E,totalFeatureImportance:w}}},97:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"c",(function(){return i})),a.d(t,"d",(function(){return r})),a.d(t,"e",(function(){return s})),a.d(t,"b",(function(){return o}));const n={OUTLIER_DETECTION:"outlier_detection",REGRESSION:"regression",CLASSIFICATION:"classification"},i={ANALYZING:"analyzing",FAILED:"failed",REINDEXING:"reindexing",STARTED:"started",STARTING:"starting",STOPPED:"stopped"},r="ml",s={ANALYTICS:"analytics",TRANSFORM:"transform",INDEX:"index",TRAINED_MODEL:"trainedModel"},o="prepackaged"}}]);