/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.security_bundle_jsonpfunction=window.security_bundle_jsonpfunction||[]).push([[9],{304:function(e,s,a){"use strict";a.r(s),a.d(s,"EditUserPage",(function(){return P})),a.d(s,"CreateUserPage",(function(){return D}));var t=a(2),r=a(3),n=a.n(r),u=a(6),i=a(28),o=a.n(i),l=a(7),c=a(5),d=a(21),m=a(34),g=a(26),j=a(69),b=a(80),p=a(4),x=a(22),f=a(0);const O=({usernames:e,onCancel:s,onSuccess:a})=>{const{services:r}=Object(c.useKibana)(),[n,u]=o()((async()=>{for(const t of e)try{await new x.UserAPIClient(r.http).deleteUser(t),r.notifications.toasts.addSuccess(p.i18n.translate("xpack.security.management.users.confirmDeleteUsers.successMessage",{defaultMessage:"Deleted user '{username}'",values:{username:t}})),null==a||a()}catch(e){var s;r.notifications.toasts.addDanger({title:p.i18n.translate("xpack.security.management.users.confirmDeleteUsers.errorMessage",{defaultMessage:"Could not delete user '{username}'",values:{username:t}}),text:(null===(s=e.body)||void 0===s?void 0:s.message)||e.message})}}),[r.http]);return Object(f.jsx)(t.EuiConfirmModal,{role:"dialog",title:p.i18n.translate("xpack.security.management.users.confirmDeleteUsers.title",{defaultMessage:"Delete {count, plural, one{user '{username}'} other{{count} users}}?",values:{count:e.length,username:e[0]}}),onCancel:s,onConfirm:u,cancelButtonText:p.i18n.translate("xpack.security.management.users.confirmDeleteUsers.cancelButton",{defaultMessage:"Cancel"}),confirmButtonText:p.i18n.translate("xpack.security.management.users.confirmDeleteUsers.confirmButton",{defaultMessage:"{isLoading, select, true{Deleting {count, plural, one{user} other{users}}…} other{Delete {count, plural, one{user} other{users}}}}",values:{count:e.length,isLoading:n.loading}}),buttonColor:"danger",isLoading:n.loading},Object(f.jsx)(t.EuiText,null,Object(f.jsx)("p",null,Object(f.jsx)(l.FormattedMessage,{id:"xpack.security.management.users.confirmDeleteUsers.description",defaultMessage:"{count, plural, one{This user} other{These users}} will be permanently deleted and access to Elastic removed{count, plural, one{.} other{:}}",values:{count:e.length}})),e.length>1&&Object(f.jsx)("ul",null,e.map((e=>Object(f.jsx)("li",{key:e},e)))),Object(f.jsx)("p",null,Object(f.jsx)(l.FormattedMessage,{id:"xpack.security.management.users.confirmDelete.cannotUndoWarning",defaultMessage:"You can't recover deleted users."}))))},w=({usernames:e,onCancel:s,onSuccess:a})=>{const{services:r}=Object(c.useKibana)(),n="kibana"===e[0]||"kibana_system"===e[0],[u,i]=o()((async()=>{for(const t of e)try{await new x.UserAPIClient(r.http).disableUser(t),r.notifications.toasts.addSuccess(p.i18n.translate("xpack.security.management.users.confirmDisableUsers.successMessage",{defaultMessage:"Deactivated user '{username}'",values:{username:t}})),null==a||a()}catch(e){var s;r.notifications.toasts.addDanger({title:p.i18n.translate("xpack.security.management.users.confirmDisableUsers.errorMessage",{defaultMessage:"Could not deactivate user '{username}'",values:{username:t}}),text:(null===(s=e.body)||void 0===s?void 0:s.message)||e.message})}}),[r.http]);return Object(f.jsx)(t.EuiConfirmModal,{role:"dialog",title:p.i18n.translate("xpack.security.management.users.confirmDisableUsers.title",{defaultMessage:"Deactivate {count, plural, one{user '{username}'} other{{count} users}}?",values:{count:e.length,username:e[0]}}),onCancel:s,onConfirm:i,cancelButtonText:p.i18n.translate("xpack.security.management.users.confirmDisableUsers.cancelButton",{defaultMessage:"Cancel"}),confirmButtonText:n?p.i18n.translate("xpack.security.management.users.confirmDisableUsers.confirmSystemPasswordButton",{defaultMessage:"{isLoading, select, true{Deactivating user…} other{I understand, deactivate this user}}",values:{isLoading:u.loading}}):p.i18n.translate("xpack.security.management.users.confirmDisableUsers.confirmButton",{defaultMessage:"{isLoading, select, true{Deactivating {count, plural, one{user} other{users}}…} other{Deactivate {count, plural, one{user} other{users}}}}",values:{count:e.length,isLoading:u.loading}}),buttonColor:n?"danger":void 0,isLoading:u.loading},n?Object(f.jsx)(t.EuiText,null,Object(f.jsx)("p",null,Object(f.jsx)(l.FormattedMessage,{id:"xpack.security.management.users.confirmDisableUsers.systemUserWarning",defaultMessage:"Deactivating this user will prevent Kibana from communicating with Elasticsearch."})),Object(f.jsx)("p",null,Object(f.jsx)(l.FormattedMessage,{id:"xpack.security.management.users.confirmDisableUsers.systemUserDescription",defaultMessage:"Once deactivated, you must manually update your config file with different user details and restart Kibana."}))):Object(f.jsx)(t.EuiText,null,Object(f.jsx)("p",null,Object(f.jsx)(l.FormattedMessage,{id:"xpack.security.management.users.confirmDisableUsers.description",defaultMessage:"{count, plural, one{This user} other{These users}} will no longer be able to access Elastic{count, plural, one{.} other{:}}",values:{count:e.length}})),e.length>1&&Object(f.jsx)("ul",null,e.map((e=>Object(f.jsx)("li",{key:e},e))))))},v=({usernames:e,onCancel:s,onSuccess:a})=>{const{services:r}=Object(c.useKibana)(),[n,u]=o()((async()=>{for(const t of e)try{await new x.UserAPIClient(r.http).enableUser(t),r.notifications.toasts.addSuccess(p.i18n.translate("xpack.security.management.users.confirmEnableUsers.successMessage",{defaultMessage:"Activated user '{username}'",values:{username:t}})),null==a||a()}catch(e){var s;r.notifications.toasts.addDanger({title:p.i18n.translate("xpack.security.management.users.confirmEnableUsers.errorMessage",{defaultMessage:"Could not activate user '{username}'",values:{username:t}}),text:(null===(s=e.body)||void 0===s?void 0:s.message)||e.message})}}),[r.http]);return Object(f.jsx)(t.EuiConfirmModal,{role:"dialog",title:p.i18n.translate("xpack.security.management.users.confirmEnableUsers.title",{defaultMessage:"Activate {count, plural, one{user '{username}'} other{{count} users}}?",values:{count:e.length,username:e[0]}}),onCancel:s,onConfirm:u,cancelButtonText:p.i18n.translate("xpack.security.management.users.confirmEnableUsers.cancelButton",{defaultMessage:"Cancel"}),confirmButtonText:p.i18n.translate("xpack.security.management.users.confirmEnableUsers.confirmButton",{defaultMessage:"{isLoading, select, true{Activating {count, plural, one{user} other{users}}…} other{Activate {count, plural, one{user} other{users}}}}",values:{count:e.length,isLoading:n.loading}}),isLoading:n.loading},Object(f.jsx)(t.EuiText,null,Object(f.jsx)("p",null,Object(f.jsx)(l.FormattedMessage,{id:"xpack.security.management.users.confirmEnableUsers.description",defaultMessage:"{count, plural, one{This user} other{These users}} will be able to access Elastic{count, plural, one{.} other{:}}",values:{count:e.length}})),e.length>1&&Object(f.jsx)("ul",null,e.map((e=>Object(f.jsx)("li",{key:e},e))))))};var h=a(25),y=a(11),E=a(78),M=a(66),F=a(97),k=a(32);const C={username:"",password:"",confirm_password:"",full_name:"",email:"",roles:[]},U=({isNewUser:e=!1,isReservedUser:s=!1,defaultValues:a=C,onSuccess:u,onCancel:i,disabled:m=!1})=>{var j,b;const{services:x}=Object(c.useKibana)(),[O,w]=o()((()=>new k.RolesAPIClient(x.http).getRoles()),[x.http]),v=Object(r.useCallback)(Object(h.throttle)((()=>new g.UserAPIClient(x.http).getUsers()),1e4),[x.http]),[U,P]=Object(M.a)({onSubmit:async s=>{const{password:a,confirm_password:t,...r}=s,n=e?{password:a,...r}:r;try{await new g.UserAPIClient(x.http).saveUser(n),x.notifications.toasts.addSuccess(e?p.i18n.translate("xpack.security.management.users.userForm.createSuccessMessage",{defaultMessage:"Created user '{username}'",values:{username:n.username}}):p.i18n.translate("xpack.security.management.users.userForm.updateSuccessMessage",{defaultMessage:"Updated user '{username}'",values:{username:n.username}})),null==u||u()}catch(s){var i;throw x.notifications.toasts.addDanger({title:e?p.i18n.translate("xpack.security.management.users.userForm.createErrorMessage",{defaultMessage:"Could not create user '{username}'",values:{username:n.username}}):p.i18n.translate("xpack.security.management.users.userForm.updateErrorMessage",{defaultMessage:"Could not update user '{username}'",values:{username:n.username}}),text:(null===(i=s.body)||void 0===i?void 0:i.message)||s.message}),s}},validate:async s=>{const a={};if(e){if(s.username)if(s.username.length>y.f)a.username=p.i18n.translate("xpack.security.management.users.userForm.usernameMaxLengthError",{defaultMessage:"Username must not exceed {maxLength} characters.",values:{maxLength:y.f}});else if(s.username.trim()!==s.username)a.username=p.i18n.translate("xpack.security.management.users.userForm.usernameWhitespaceError",{defaultMessage:"Username must not contain leading or trailing spaces."});else if(s.username.match(y.g))try{const e=await v();null!=e&&e.some((e=>e.username===s.username))&&(a.username=p.i18n.translate("xpack.security.management.users.userForm.usernameTakenError",{defaultMessage:"User '{username}' already exists.",values:{username:s.username}}))}catch(e){}else a.username=p.i18n.translate("xpack.security.management.users.userForm.usernameInvalidError",{defaultMessage:"Username must contain only letters, numbers, spaces, punctuation, and symbols."});else a.username=p.i18n.translate("xpack.security.management.users.userForm.usernameRequiredError",{defaultMessage:"Enter a username."});s.password?s.password.length<6?a.password=p.i18n.translate("xpack.security.management.users.userForm.passwordInvalidError",{defaultMessage:"Password must be at least 6 characters."}):s.confirm_password?s.password!==s.confirm_password&&(a.confirm_password=p.i18n.translate("xpack.security.management.users.userForm.confirmPasswordInvalidError",{defaultMessage:"Passwords do not match."})):a.confirm_password=p.i18n.translate("xpack.security.management.users.userForm.confirmPasswordRequiredError",{defaultMessage:"Passwords do not match."}):a.password=p.i18n.translate("xpack.security.management.users.userForm.passwordRequiredError",{defaultMessage:"Enter a password."})}return a},defaultValues:a});Object(r.useEffect)((()=>{U.reset(a)}),[a]),Object(r.useEffect)((()=>{w()}),[]);const D=null!==(j=O.value)&&void 0!==j?j:[],I=null!==(b=U.values.roles)&&void 0!==b?b:[],B=I.reduce(((e,s)=>{const a=D.find((e=>e.name===s));return a&&Object(d.j)(a)&&e.push(a),e}),[]);return Object(f.jsx)(t.EuiForm,{component:"form",error:Object.values(U.errors),isInvalid:U.isInvalid,invalidCallout:U.isSubmitted?"above":"none",onSubmit:P.onSubmit,noValidate:!0},Object(f.jsx)(t.EuiDescribedFormGroup,{title:Object(f.jsx)("h2",null,Object(f.jsx)(l.FormattedMessage,{id:"xpack.security.management.users.userForm.profileTitle",defaultMessage:"Profile"})),description:p.i18n.translate("xpack.security.management.users.userForm.profileDescription",{defaultMessage:"Provide personal details."})},Object(f.jsx)(t.EuiFormRow,{label:p.i18n.translate("xpack.security.management.users.userForm.usernameLabel",{defaultMessage:"Username"}),helpText:e||s?void 0:p.i18n.translate("xpack.security.management.users.userForm.changingUserNameAfterCreationDescription",{defaultMessage:"User name cannot be changed after account creation."}),error:U.errors.username,isInvalid:U.touched.username&&!!U.errors.username},Object(f.jsx)(t.EuiFieldText,{name:"username","data-test-subj":"userFormUserNameInput",icon:"user",value:U.values.username,isLoading:U.isValidating,isInvalid:U.touched.username&&!!U.errors.username,disabled:m||!e,onChange:P.onChange,onBlur:P.onBlur})),s?void 0:Object(f.jsx)(n.a.Fragment,null,Object(f.jsx)(t.EuiFormRow,{label:p.i18n.translate("xpack.security.management.users.userForm.fullNameLabel",{defaultMessage:"Full name"}),error:U.errors.full_name,isInvalid:U.touched.full_name&&!!U.errors.full_name},Object(f.jsx)(t.EuiFieldText,{name:"full_name","data-test-subj":"userFormFullNameInput",value:U.values.full_name,isInvalid:U.touched.full_name&&!!U.errors.full_name,onChange:P.onChange,onBlur:P.onBlur,disabled:m})),Object(f.jsx)(t.EuiFormRow,{label:p.i18n.translate("xpack.security.management.users.userForm.emailLabel",{defaultMessage:"Email address"}),error:U.errors.email,isInvalid:U.touched.email&&!!U.errors.email},Object(f.jsx)(t.EuiFieldText,{name:"email","data-test-subj":"userFormEmailInput",value:U.values.email,isInvalid:U.touched.email&&!!U.errors.email,onChange:P.onChange,onBlur:P.onBlur,disabled:m})))),e?Object(f.jsx)(t.EuiDescribedFormGroup,{title:Object(f.jsx)("h2",null,Object(f.jsx)(l.FormattedMessage,{id:"xpack.security.management.users.userForm.passwordTitle",defaultMessage:"Password"})),description:p.i18n.translate("xpack.security.management.users.userForm.passwordDescription",{defaultMessage:"Protect your data with a strong password."})},Object(f.jsx)(t.EuiFormRow,{label:p.i18n.translate("xpack.security.management.users.userForm.passwordLabel",{defaultMessage:"Password"}),helpText:p.i18n.translate("xpack.security.management.users.userForm.passwordHelpText",{defaultMessage:"Password must be at least 6 characters."}),error:U.errors.password,isInvalid:U.touched.password&&!!U.errors.password},Object(f.jsx)(t.EuiFieldPassword,{name:"password","data-test-subj":"passwordInput",type:"dual",value:U.values.password,isInvalid:U.touched.password&&!!U.errors.password,autoComplete:"new-password",onChange:P.onChange,onBlur:P.onBlur,disabled:m})),Object(f.jsx)(t.EuiFormRow,{label:p.i18n.translate("xpack.security.management.users.userForm.confirmPasswordLabel",{defaultMessage:"Confirm password"}),error:U.errors.confirm_password,isInvalid:U.touched.confirm_password&&!!U.errors.confirm_password},Object(f.jsx)(t.EuiFieldPassword,{name:"confirm_password","data-test-subj":"passwordConfirmationInput",type:"dual",value:U.values.confirm_password,isInvalid:U.touched.confirm_password&&!!U.errors.confirm_password,autoComplete:"new-password",onChange:P.onChange,onBlur:P.onBlur,disabled:m}))):null,Object(f.jsx)(t.EuiDescribedFormGroup,{title:Object(f.jsx)("h2",null,Object(f.jsx)(l.FormattedMessage,{id:"xpack.security.management.users.userForm.privilegesTitle",defaultMessage:"Privileges"})),description:p.i18n.translate("xpack.security.management.users.userForm.privilegesDescription",{defaultMessage:"Assign roles to manage access and permissions."})},Object(f.jsx)(t.EuiFormRow,{label:p.i18n.translate("xpack.security.management.users.userForm.rolesLabel",{defaultMessage:"Roles"}),helpText:!s&&B.length>0?Object(f.jsx)(t.EuiTextColor,{color:"warning"},B.map((e=>{var s,a;return Object(f.jsx)("p",{key:e.name},Object(f.jsx)(l.FormattedMessage,{id:"xpack.security.management.users.userForm.deprecatedRolesAssignedWarning",defaultMessage:"Role '{name}' is deprecated. {reason}.",values:{name:e.name,reason:null===(s=e.metadata)||void 0===s||null===(a=s._deprecated_reason)||void 0===a?void 0:a.replace(/\[(.+)\]/,"'$1'")}}))}))):Object(f.jsx)(E.a,{app:"elasticsearch",doc:"built-in-roles.html"},Object(f.jsx)(l.FormattedMessage,{id:"xpack.security.management.users.userForm.rolesHelpText",defaultMessage:"Learn what privileges individual roles grant."}))},Object(f.jsx)(F.a,{availableRoles:D,selectedRoleNames:I,onChange:e=>U.setValue("roles",e),isLoading:O.loading,isDisabled:m||s})),Object(f.jsx)(t.EuiSpacer,{size:"xxl"}),m||s?Object(f.jsx)(t.EuiFlexGroup,{responsive:!1},Object(f.jsx)(t.EuiFlexItem,{grow:!1},Object(f.jsx)(t.EuiButton,{iconType:"arrowLeft",onClick:i},Object(f.jsx)(l.FormattedMessage,{id:"xpack.security.management.users.userForm.backToUsersButton",defaultMessage:"Back to users"})))):Object(f.jsx)(t.EuiFlexGroup,{responsive:!1},Object(f.jsx)(t.EuiFlexItem,{grow:!1},Object(f.jsx)(t.EuiButton,{type:"submit",isLoading:U.isSubmitting,isDisabled:U.isSubmitted&&U.isInvalid,fill:!0},e?Object(f.jsx)(l.FormattedMessage,{id:"xpack.security.management.users.userForm.createUserButton",defaultMessage:"{isSubmitting, select, true{Creating user…} other{Create user}}",values:{isSubmitting:U.isSubmitting}}):Object(f.jsx)(l.FormattedMessage,{id:"xpack.security.management.users.userForm.updateUserButton",defaultMessage:"{isSubmitting, select, true{Updating user…} other{Update user}}",values:{isSubmitting:U.isSubmitting}}))),Object(f.jsx)(t.EuiFlexItem,{grow:!1},Object(f.jsx)(t.EuiButtonEmpty,{flush:"left",isDisabled:U.isSubmitting,onClick:i},Object(f.jsx)(l.FormattedMessage,{id:"xpack.security.management.users.userForm.cancelButton",defaultMessage:"Cancel"}))))))},P=({username:e})=>{var s,a;const{services:i}=Object(c.useKibana)(),p=Object(u.useHistory)(),[{value:x,error:h},y]=o()((()=>new g.UserAPIClient(i.http).getUser(e)),[i.http]),[E,M]=Object(r.useState)("none"),F=!Object(m.a)("users").save,k=()=>p.push("/");if(Object(r.useEffect)((()=>{y()}),[]),Object(r.useEffect)((()=>{h&&k()}),[h]),!x)return null;const C=Object(j.c)(x),P=Object(j.b)(x),D=Object(d.h)({full_name:x.full_name,username:x.username});return Object(f.jsx)(n.a.Fragment,null,Object(f.jsx)(t.EuiPageHeader,{bottomBorder:!0,pageTitle:Object(f.jsx)(t.EuiFlexGroup,{alignItems:"center",responsive:!1},Object(f.jsx)(t.EuiFlexItem,{grow:!1},Object(f.jsx)(t.EuiAvatar,{name:Object(d.h)(x),size:"xl"})),Object(f.jsx)(t.EuiFlexItem,null,Object(f.jsx)(t.EuiTitle,null,Object(f.jsx)("h1",null,D)),Object(f.jsx)(t.EuiText,null,x.email)))}),Object(f.jsx)(t.EuiSpacer,{size:"l"}),P?Object(f.jsx)(n.a.Fragment,null,Object(f.jsx)(t.EuiCallOut,{title:Object(f.jsx)(l.FormattedMessage,{id:"xpack.security.management.users.editUserPage.deprecatedUserWarning",defaultMessage:"This user is deprecated."}),iconType:"alert",color:"warning"},null===(s=x.metadata)||void 0===s||null===(a=s._deprecated_reason)||void 0===a?void 0:a.replace(/\[(.+)\]/,"'$1'")),Object(f.jsx)(t.EuiSpacer,null)):C?Object(f.jsx)(n.a.Fragment,null,Object(f.jsx)(t.EuiCallOut,{title:Object(f.jsx)(l.FormattedMessage,{id:"xpack.security.management.users.editUserPage.reservedUserWarning",defaultMessage:"This user is built in and can't be updated or deleted."}),iconType:"lock"}),Object(f.jsx)(t.EuiSpacer,null)):!1===x.enabled?Object(f.jsx)(n.a.Fragment,null,Object(f.jsx)(t.EuiCallOut,{title:Object(f.jsx)(l.FormattedMessage,{id:"xpack.security.management.users.editUserPage.disabledUserWarning",defaultMessage:"This user has been deactivated and can't access Elastic."})},Object(f.jsx)(t.EuiButton,{onClick:()=>M("enableUser"),size:"s"},Object(f.jsx)(l.FormattedMessage,{id:"xpack.security.management.users.editUserPage.enableUserButton",defaultMessage:"Activate user"}))),Object(f.jsx)(t.EuiSpacer,null)):void 0,Object(f.jsx)(U,{isReservedUser:C,defaultValues:x,onCancel:k,onSuccess:k,disabled:F}),F?void 0:Object(f.jsx)(n.a.Fragment,null,"changePassword"===E?Object(f.jsx)(b.a,{username:e,onCancel:()=>M("none"),onSuccess:()=>M("none")}):"disableUser"===E?Object(f.jsx)(w,{usernames:[e],onCancel:()=>M("none"),onSuccess:()=>{M("none"),y()}}):"enableUser"===E?Object(f.jsx)(v,{usernames:[e],onCancel:()=>M("none"),onSuccess:()=>{M("none"),y()}}):"deleteUser"===E?Object(f.jsx)(O,{usernames:[e],onCancel:()=>M("none"),onSuccess:k}):void 0,Object(f.jsx)(t.EuiSpacer,null),Object(f.jsx)(t.EuiHorizontalRule,null),Object(f.jsx)(t.EuiPanel,{color:"subdued",hasShadow:!1,grow:!1},Object(f.jsx)(t.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},Object(f.jsx)(t.EuiFlexItem,null,Object(f.jsx)(t.EuiDescriptionList,null,Object(f.jsx)(t.EuiDescriptionListTitle,null,Object(f.jsx)(l.FormattedMessage,{id:"xpack.security.management.users.editUserPage.changePasswordTitle",defaultMessage:"Change password"})),Object(f.jsx)(t.EuiDescriptionListDescription,null,Object(f.jsx)(l.FormattedMessage,{id:"xpack.security.management.users.editUserPage.changePasswordDescription",defaultMessage:"The user will not be able to log in using their previous password."})))),Object(f.jsx)(t.EuiFlexItem,{grow:!1},Object(f.jsx)(t.EuiButton,{onClick:()=>M("changePassword"),size:"s","data-test-subj":"editUserChangePasswordButton"},Object(f.jsx)(l.FormattedMessage,{id:"xpack.security.management.users.editUserPage.changePasswordButton",defaultMessage:"Change password"}))))),Object(f.jsx)(t.EuiSpacer,null),!1===x.enabled?Object(f.jsx)(t.EuiPanel,{color:"subdued",hasShadow:!1,grow:!1},Object(f.jsx)(t.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},Object(f.jsx)(t.EuiFlexItem,null,Object(f.jsx)(t.EuiDescriptionList,null,Object(f.jsx)(t.EuiDescriptionListTitle,null,Object(f.jsx)(l.FormattedMessage,{id:"xpack.security.management.users.editUserPage.enableUserTitle",defaultMessage:"Activate user"})),Object(f.jsx)(t.EuiDescriptionListDescription,null,Object(f.jsx)(l.FormattedMessage,{id:"xpack.security.management.users.editUserPage.enableUserDescription",defaultMessage:"Allow the user to access Elastic."})))),Object(f.jsx)(t.EuiFlexItem,{grow:!1},Object(f.jsx)(t.EuiButton,{onClick:()=>M("enableUser"),size:"s","data-test-subj":"editUserEnableUserButton"},Object(f.jsx)(l.FormattedMessage,{id:"xpack.security.management.users.editUserPage.enableUserButton",defaultMessage:"Activate user"}))))):Object(f.jsx)(t.EuiPanel,{color:"subdued",hasShadow:!1,grow:!1},Object(f.jsx)(t.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},Object(f.jsx)(t.EuiFlexItem,null,Object(f.jsx)(t.EuiDescriptionList,null,Object(f.jsx)(t.EuiDescriptionListTitle,null,Object(f.jsx)(l.FormattedMessage,{id:"xpack.security.management.users.editUserPage.disableUserTitle",defaultMessage:"Deactivate user"})),Object(f.jsx)(t.EuiDescriptionListDescription,null,Object(f.jsx)(l.FormattedMessage,{id:"xpack.security.management.users.editUserPage.disableUserDescription",defaultMessage:"Prevent the user from accessing Elastic."})))),Object(f.jsx)(t.EuiFlexItem,{grow:!1},Object(f.jsx)(t.EuiButton,{onClick:()=>M("disableUser"),size:"s","data-test-subj":"editUserDisableUserButton"},Object(f.jsx)(l.FormattedMessage,{id:"xpack.security.management.users.editUserPage.disableUserButton",defaultMessage:"Deactivate user"}))))),!C&&Object(f.jsx)(n.a.Fragment,null,Object(f.jsx)(t.EuiSpacer,null),Object(f.jsx)(t.EuiPanel,{color:"subdued",hasShadow:!1,grow:!1},Object(f.jsx)(t.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},Object(f.jsx)(t.EuiFlexItem,null,Object(f.jsx)(t.EuiDescriptionList,null,Object(f.jsx)(t.EuiDescriptionListTitle,null,Object(f.jsx)(l.FormattedMessage,{id:"xpack.security.management.users.editUserPage.deleteUserTitle",defaultMessage:"Delete user"})),Object(f.jsx)(t.EuiDescriptionListDescription,null,Object(f.jsx)(l.FormattedMessage,{id:"xpack.security.management.users.editUserPage.deleteUserDescription",defaultMessage:"Permanently delete the user and remove access to Elastic."})))),Object(f.jsx)(t.EuiFlexItem,{grow:!1},Object(f.jsx)(t.EuiButton,{onClick:()=>M("deleteUser"),size:"s",color:"danger","data-test-subj":"editUserDeleteUserButton"},Object(f.jsx)(l.FormattedMessage,{id:"xpack.security.management.users.editUserPage.deleteUserButton",defaultMessage:"Delete user"}))))))))},D=()=>{const e=Object(u.useHistory)(),s=!Object(m.a)("users").save,a=()=>e.push("/");return Object(r.useEffect)((()=>{s&&a()}),[s]),Object(f.jsx)(n.a.Fragment,null,Object(f.jsx)(t.EuiPageHeader,{bottomBorder:!0,pageTitle:Object(f.jsx)(l.FormattedMessage,{id:"xpack.security.management.users.createUserPage.title",defaultMessage:"Create user"})}),Object(f.jsx)(t.EuiSpacer,{size:"l"}),Object(f.jsx)(U,{isNewUser:!0,onCancel:a,onSuccess:a}))}},66:function(e,s,a){"use strict";a.d(s,"a",(function(){return i}));var t=a(25),r=a(3),n=a(28),u=a.n(n);function i(e){const s=function({onSubmit:e,validate:s,defaultValues:a}){const[n,i]=Object(r.useState)(a),[l,c]=Object(r.useState)({}),[d,m]=Object(r.useState)({}),[g,j]=Object(r.useState)(0),[b,p]=u()((async e=>{const a=await s(e);return c(a),0===Object.keys(a).length&&j(0),a}),[s]),[x,f]=u()((async s=>{const a=await p(s);if(m(function(e,s){return Object(t.cloneDeepWith)(e,(e=>{if("object"!=typeof e&&null!==e)return true}))}(s)),j(g+1),0===Object.keys(a).length)return e(s)}),[p,e]);return{setValue:async(e,s)=>{const a=o(n,e,s);i(a),await p(a)},setTouched:async(e,s=!0)=>{m(o(d,e,s)),await p(n)},setError:(e,s)=>{c(o(l,e,s)),m(o(d,e,!0))},reset:e=>{i(e),c({}),m({}),j(0)},submit:()=>f(n),values:n,errors:l,touched:d,isValidating:b.loading,isSubmitting:x.loading,submitError:x.error,isInvalid:Object.keys(l).length>0,isSubmitted:g>0}}(e),a={onSubmit:e=>{e.preventDefault(),s.submit()},onChange:e=>{const{name:a,type:t,checked:r,value:n}=e.target;a&&s.setValue(a,"checkbox"===t?r:n)},onBlur:e=>{const{name:a}=e.target;a&&s.setTouched(e.target.name)}};return[s,a]}function o(e,s,a){return Object(t.get)(e,s)!==a?Object(t.set)(Object(t.cloneDeep)(e),s,a):e}},68:function(e,s,a){"use strict";a.d(s,"a",(function(){return r}));var t=a(3);function r(e=[]){const s=Object(t.useRef)(null);return Object(t.useEffect)((()=>{s.current&&s.current.focus()}),e),s}},69:function(e,s,a){"use strict";a.d(s,"c",(function(){return r})),a.d(s,"b",(function(){return n})),a.d(s,"a",(function(){return u}));var t=a(4);const r=e=>{var s,a;return null!==(s=null===(a=e.metadata)||void 0===a?void 0:a._reserved)&&void 0!==s&&s},n=e=>{var s,a;return null!==(s=null===(a=e.metadata)||void 0===a?void 0:a._deprecated)&&void 0!==s&&s},u=e=>{var s,a;const r=null!==(s=null===(a=e.metadata)||void 0===a?void 0:a._deprecated_reason)&&void 0!==s?s:"";return t.i18n.translate("xpack.security.management.users.extendedUserDeprecationNotice",{defaultMessage:"The {username} user is deprecated. {reason}",values:{username:e.username,reason:r}})}},78:function(e,s,a){"use strict";a.d(s,"a",(function(){return i}));var t=a(2),r=a(3),n=a(5),u=a(0);const i=({app:e,doc:s,children:a})=>{const[,i]=function(){const{services:e}=Object(n.useKibana)(),{links:s,ELASTIC_WEBSITE_URL:a,DOC_LINK_VERSION:t}=e.docLinks;return[s,Object(r.useCallback)(((e,s)=>`${a}guide/en/${e}/reference/${t}/${s}`),[a,t])]}();return Object(u.jsx)(t.EuiLink,{href:i(e,s),target:"_blank",external:!0},a)}},80:function(e,s,a){"use strict";a.d(s,"a",(function(){return x}));var t=a(12),r=a.n(t),n=a(2),u=a(3),i=a.n(u),o=a(4),l=a(7),c=a(5),d=a(48),m=a(17),g=a(66),j=a(68),b=a(26),p=a(0);const x=({username:e,defaultValues:s={current_password:"",password:"",confirm_password:""},onSuccess:a,onCancel:t})=>{const{services:u}=Object(c.useKibana)(),{value:x,loading:f}=Object(m.b)(),O=(null==x?void 0:x.username)===e,w="kibana"===e||"kibana_system"===e,[v,h]=Object(g.a)({onSubmit:async s=>{try{await new b.UserAPIClient(u.http).changePassword(e,s.password,s.current_password),u.notifications.toasts.addSuccess(o.i18n.translate("xpack.security.management.users.changePasswordForm.successMessage",{defaultMessage:"Password successfully changed"})),null==a||a()}catch(e){var t,r;if(403!==(null===(t=e.body)||void 0===t?void 0:t.statusCode))throw u.notifications.toasts.addDanger({title:o.i18n.translate("xpack.security.management.users.changePasswordForm.errorMessage",{defaultMessage:"Could not change password"}),text:(null===(r=e.body)||void 0===r?void 0:r.message)||e.message}),e;v.setError("current_password",o.i18n.translate("xpack.security.management.users.changePasswordForm.currentPasswordInvalidError",{defaultMessage:"Invalid password."}))}},validate:async e=>((e,s)=>{const a={};return s&&(e.current_password||(a.current_password=o.i18n.translate("xpack.security.management.users.changePasswordForm.currentPasswordRequiredError",{defaultMessage:"Enter your current password."}))),e.password?e.password.length<6?a.password=o.i18n.translate("xpack.security.management.users.changePasswordForm.passwordInvalidError",{defaultMessage:"Enter at least 6 characters."}):e.password!==e.confirm_password&&(a.confirm_password=o.i18n.translate("xpack.security.management.users.changePasswordForm.confirmPasswordInvalidError",{defaultMessage:"Passwords do not match."})):a.password=o.i18n.translate("xpack.security.management.users.changePasswordForm.passwordRequiredError",{defaultMessage:"Enter a new password."}),a})(e,O),defaultValues:s}),y=Object(j.a)([f]),E=Object(n.useGeneratedHtmlId)({prefix:"modalForm"});return Object(p.jsx)(n.EuiModal,{onClose:t},Object(p.jsx)(n.EuiModalHeader,null,Object(p.jsx)(n.EuiModalHeaderTitle,{"data-test-subj":"confirmModalTitleText"},Object(p.jsx)(l.FormattedMessage,{id:"xpack.security.management.users.changePasswordForm.title",defaultMessage:"Change password"}))),Object(p.jsx)(n.EuiModalBody,null,f?Object(p.jsx)(n.EuiLoadingContent,null):Object(p.jsx)(n.EuiForm,r()({id:E,component:"form",noValidate:!0},h),w?Object(p.jsx)(i.a.Fragment,null,Object(p.jsx)(n.EuiCallOut,{title:o.i18n.translate("xpack.security.management.users.changePasswordForm.systemUserTitle",{defaultMessage:"Kibana will lose connection to Elasticsearch"}),color:"danger",iconType:"alert",style:{maxWidth:d.euiThemeVars.euiFormMaxWidth}},Object(p.jsx)("p",null,Object(p.jsx)(l.FormattedMessage,{id:"xpack.security.management.users.changePasswordForm.systemUserWarning",defaultMessage:"After changing the password for the {username} user, Kibana will be unusable.",values:{username:e}})),Object(p.jsx)("p",null,Object(p.jsx)(l.FormattedMessage,{id:"xpack.security.management.users.changePasswordForm.systemUserDescription",defaultMessage:"To regain access, update your config file with the new password and restart Kibana."}))),Object(p.jsx)(n.EuiSpacer,null)):void 0,O?Object(p.jsx)(i.a.Fragment,null,Object(p.jsx)(n.EuiFormRow,{label:o.i18n.translate("xpack.security.management.users.changePasswordForm.currentPasswordLabel",{defaultMessage:"Current password"}),error:v.errors.current_password,isInvalid:v.touched.current_password&&!!v.errors.current_password},Object(p.jsx)(n.EuiFieldPassword,{name:"current_password",type:"dual",defaultValue:v.values.current_password,isInvalid:v.touched.current_password&&!!v.errors.current_password,autoComplete:"current-password",inputRef:y,"data-test-subj":"editUserChangePasswordCurrentPasswordInput"}))):Object(p.jsx)(n.EuiFormRow,{label:o.i18n.translate("xpack.security.management.users.changePasswordForm.userLabel",{defaultMessage:"User"})},Object(p.jsx)(n.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1},Object(p.jsx)(n.EuiFlexItem,{grow:!1},Object(p.jsx)(n.EuiIcon,{type:"user"})),Object(p.jsx)(n.EuiFlexItem,null,Object(p.jsx)(n.EuiSpacer,{size:"xs"}),Object(p.jsx)(n.EuiText,null,e),Object(p.jsx)(n.EuiSpacer,{size:"xs"})))),Object(p.jsx)(n.EuiFormRow,{label:o.i18n.translate("xpack.security.management.users.changePasswordForm.passwordLabel",{defaultMessage:"New password"}),helpText:o.i18n.translate("xpack.security.management.users.changePasswordForm.passwordHelpText",{defaultMessage:"Password must be at least 6 characters."}),error:v.errors.password,isInvalid:v.touched.password&&!!v.errors.password},Object(p.jsx)(n.EuiFieldPassword,{name:"password",type:"dual",defaultValue:v.values.password,isInvalid:v.touched.password&&!!v.errors.password,autoComplete:"new-password",inputRef:O?void 0:y,"data-test-subj":"editUserChangePasswordNewPasswordInput"})),Object(p.jsx)(n.EuiFormRow,{label:o.i18n.translate("xpack.security.management.users.changePasswordForm.confirmPasswordLabel",{defaultMessage:"Confirm password"}),error:v.errors.confirm_password,isInvalid:v.touched.confirm_password&&!!v.errors.confirm_password},Object(p.jsx)(n.EuiFieldPassword,{name:"confirm_password",type:"dual",defaultValue:v.values.confirm_password,isInvalid:v.touched.confirm_password&&!!v.errors.confirm_password,autoComplete:"new-password","data-test-subj":"editUserChangePasswordConfirmPasswordInput"})))),Object(p.jsx)(n.EuiModalFooter,null,Object(p.jsx)(n.EuiButtonEmpty,{"data-test-subj":"changePasswordFormCancelButton",isDisabled:v.isSubmitting,onClick:t},Object(p.jsx)(l.FormattedMessage,{id:"xpack.security.changePasswordForm.cancelButton",defaultMessage:"Cancel"})),Object(p.jsx)(n.EuiButton,{iconType:"lock",type:"submit",form:E,"data-test-subj":"changePasswordFormSubmitButton",isLoading:v.isSubmitting,isDisabled:f||v.isSubmitted&&v.isInvalid,color:w?"danger":void 0,fill:!0},Object(p.jsx)(l.FormattedMessage,{id:"xpack.security.changePasswordForm.confirmButton",defaultMessage:"{isSubmitting, select, true{Changing password…} other{Change password}}",values:{isSubmitting:v.isSubmitting}}))))}},97:function(e,s,a){"use strict";a.d(s,"a",(function(){return o}));var t=a(2),r=(a(3),a(4)),n=a(7),u=a(21),i=a(0);const o=e=>{var s,a,n,o,c;const d=s=>{var a,t,r,n,i;const o=e.availableRoles.find((e=>e.name===s)),l=null!==(a=o&&Object(u.m)(o))&&void 0!==a&&a,c=null!==(t=o&&Object(u.j)(o))&&void 0!==t&&t,d=null!==(r=o&&Object(u.n)(o))&&void 0!==r&&r,m=null!==(n=o&&Object(u.i)(o))&&void 0!==n&&n;return{color:c?"warning":l?"primary":void 0,"data-test-subj":`roleOption-${s}`,label:s,value:{isReserved:l,isDeprecated:c,isSystem:d,isAdmin:m,deprecatedReason:null==o||null===(i=o.metadata)||void 0===i?void 0:i._deprecated_reason}}},m=e.availableRoles.map((e=>d(e.name))),g=e.selectedRoleNames.map(d),j=m.reduce(((e,s)=>{var a,t,r,n;const u=null!==(a=s.value)&&void 0!==a&&a.isDeprecated?"deprecated":null!==(t=s.value)&&void 0!==t&&t.isSystem?"system":null!==(r=s.value)&&void 0!==r&&r.isAdmin?"admin":null!==(n=s.value)&&void 0!==n&&n.isReserved?"user":"custom";return e[u]||(e[u]=[]),e[u].push(s),e}),{});return Object(i.jsx)(t.EuiComboBox,{"data-test-subj":"rolesDropdown",id:e.id,placeholder:e.placeholder||r.i18n.translate("xpack.security.management.users.roleComboBox.placeholder",{defaultMessage:"Select roles"}),onChange:s=>{e.onChange(s.map((e=>e.label)))},isLoading:e.isLoading,isDisabled:e.isDisabled,options:[{label:r.i18n.translate("xpack.security.management.users.roleComboBox.customRoles",{defaultMessage:"Custom roles"}),options:null!==(s=j.custom)&&void 0!==s?s:[]},{label:r.i18n.translate("xpack.security.management.users.roleComboBox.userRoles",{defaultMessage:"User roles"}),options:null!==(a=j.user)&&void 0!==a?a:[]},{label:r.i18n.translate("xpack.security.management.users.roleComboBox.AdminRoles",{defaultMessage:"Admin roles"}),options:null!==(n=j.admin)&&void 0!==n?n:[]},{label:r.i18n.translate("xpack.security.management.users.roleComboBox.systemRoles",{defaultMessage:"System roles"}),options:null!==(o=j.system)&&void 0!==o?o:[]},{label:r.i18n.translate("xpack.security.management.users.roleComboBox.deprecatedRoles",{defaultMessage:"Deprecated roles"}),options:null!==(c=j.deprecated)&&void 0!==c?c:[]}],selectedOptions:g,renderOption:l})};function l(e){var s,a;return Object(i.jsx)(t.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center",responsive:!1},Object(i.jsx)(t.EuiFlexItem,null,e.label),null!==(s=e.value)&&void 0!==s&&s.isDeprecated?Object(i.jsx)(t.EuiFlexItem,{grow:!1},Object(i.jsx)(t.EuiBadge,{color:e.color},Object(i.jsx)(n.FormattedMessage,{id:"xpack.security.management.users.roleComboBox.deprecatedBadge",defaultMessage:"deprecated"}))):null!==(a=e.value)&&void 0!==a&&a.isReserved?Object(i.jsx)(t.EuiFlexItem,{grow:!1},Object(i.jsx)(t.EuiBadge,{color:e.color},Object(i.jsx)(n.FormattedMessage,{id:"xpack.security.management.users.roleComboBox.reservedBadge",defaultMessage:"built in"}))):void 0)}}}]);