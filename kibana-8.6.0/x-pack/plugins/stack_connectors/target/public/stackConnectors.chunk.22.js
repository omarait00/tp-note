/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.stackConnectors_bundle_jsonpfunction=window.stackConnectors_bundle_jsonpfunction||[]).push([[22,41],{100:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return O}));var s=n(0),o=n.n(s),a=n(17),r=n(2),i=n(4),l=n(47),c=n(16);const u=e=>({key:e.id.toString(),value:e,label:e.name}),d=({label:e,value:t},n,s)=>Object(c.jsx)(a.EuiFlexGroup,{className:s,direction:"row",alignItems:"center"},Object(c.jsx)(a.EuiFlexItem,{grow:!1},Object(c.jsx)(a.EuiHighlight,{search:n},e)),(null==t?void 0:t.published)&&Object(c.jsx)(a.EuiFlexItem,{grow:!1},Object(c.jsx)(a.EuiBadge,{color:"hollow"},l.STORY_PUBLISHED_BADGE_TEXT))),O=({actionConnector:e,actionParams:t,editAction:n,index:O,executionMode:b,errors:E})=>{var k,L,f,p,_;const{toasts:h}=Object(r.useKibana)().notifications,{subAction:R,subActionParams:y}=t,{body:A,webhook:x,webhookUrl:m}=null!=y?y:{},[T,g]=Object(s.useState)(null==e?void 0:e.id),[B,v]=Object(s.useState)(),[C,I]=Object(s.useState)(),W=Object(s.useMemo)((()=>b===r.ActionConnectorMode.Test),[b]);Object(s.useEffect)((()=>{R||n("subAction",W?i.b.TEST:i.b.RUN,O)}),[W,R]),T!==(null==e?void 0:e.id)&&(v(null),g(null==e?void 0:e.id));const j=Object(s.useCallback)((e=>{n("subActionParams",{...y,...e},O)}),[n,O,y]),{response:{stories:H,incompleteResponse:U}={},isLoading:D,error:M}=Object(r.useSubAction)({connectorId:T,subAction:"stories"}),{response:{webhooks:S,incompleteResponse:w}={},isLoading:P,error:K}=Object(r.useSubAction)({connectorId:T,subAction:"webhooks",...null!=B&&null!==(k=B.value)&&void 0!==k&&k.id?{subActionParams:{storyId:null==B||null===(L=B.value)||void 0===L?void 0:L.id}}:{disabled:!0}}),F=Object(s.useMemo)((()=>{var e;return null!==(e=null==H?void 0:H.map(u))&&void 0!==e?e:[]}),[H]),N=Object(s.useMemo)((()=>{var e;return null!==(e=null==S?void 0:S.map(u))&&void 0!==e?e:[]}),[S]);Object(s.useEffect)((()=>{M&&h.danger({title:l.STORIES_ERROR,body:M.message}),K&&h.danger({title:l.WEBHOOKS_ERROR,body:K.message})}),[h,M,K]);const Y=Object(s.useMemo)((()=>U&&!B?"Story":w&&!C?"Webhook":m?"any":null),[m,U,w,B,C]);Object(s.useEffect)((()=>{var e,t;if(void 0===B&&null!=x&&x.storyId&&H){const e=H.find((({id:e})=>e===x.storyId));e?v(u(e)):(h.warning({title:l.STORY_NOT_FOUND_WARNING}),j({webhook:void 0}))}void 0!==B&&(null==B||null===(e=B.value)||void 0===e?void 0:e.id)!==(null==x?void 0:x.storyId)&&(j({webhook:{storyId:null==B||null===(t=B.value)||void 0===t?void 0:t.id}}),I((e=>void 0===e?void 0:null)))}),[B,null==x?void 0:x.storyId,H,h,j]),Object(s.useEffect)((()=>{var e;if(void 0===C&&null!=x&&x.id&&S){const e=S.find((({id:e})=>e===x.id));e?I(u(e)):(h.warning({title:l.WEBHOOK_NOT_FOUND_WARNING}),j({webhook:{storyId:null==x?void 0:x.storyId}}))}void 0!==C&&(null==C||null===(e=C.value)||void 0===e?void 0:e.id)!==(null==x?void 0:x.id)&&j({webhook:C?C.value:{storyId:null==x?void 0:x.storyId}})}),[C,x,S,h,j]);const q=Object(s.useMemo)((()=>B?[B]:[]),[B]),G=Object(s.useMemo)((()=>C?[C]:[]),[C]),Q=Object(s.useCallback)((([e])=>{v(null!=e?e:null)}),[]),V=Object(s.useCallback)((([e])=>{I(null!=e?e:null)}),[]);return Object(c.jsx)(a.EuiFlexGroup,{direction:"column"},Object(c.jsx)(a.EuiFlexItem,null,Object(c.jsx)(a.EuiFormRow,{fullWidth:!0,error:E.story,isInvalid:!(null===(f=E.story)||void 0===f||!f.length)&&void 0!==B,label:l.STORY_LABEL,helpText:l.STORY_HELP},Object(c.jsx)(a.EuiComboBox,{"aria-label":l.STORY_PLACEHOLDER,placeholder:m?l.DISABLED_BY_WEBHOOK_URL_PLACEHOLDER:l.STORY_ARIA_LABEL,singleSelection:{asPlainText:!0},options:F,selectedOptions:q,onChange:Q,isDisabled:D||!!m,isLoading:D,renderOption:d,fullWidth:!0,"data-test-subj":"tines-storySelector"})),Object(c.jsx)(a.EuiFormRow,{fullWidth:!0,error:E.webhook,isInvalid:!(null===(p=E.webhook)||void 0===p||!p.length)&&void 0!==C,label:l.WEBHOOK_LABEL,helpText:l.WEBHOOK_HELP},Object(c.jsx)(a.EuiComboBox,{"aria-label":l.WEBHOOK_ARIA_LABEL,placeholder:m?l.DISABLED_BY_WEBHOOK_URL_PLACEHOLDER:B?l.WEBHOOK_PLACEHOLDER:l.WEBHOOK_DISABLED_PLACEHOLDER,singleSelection:{asPlainText:!0},options:N,selectedOptions:G,onChange:V,isDisabled:!B||P||!!m,isLoading:P,fullWidth:!0,"data-test-subj":"tines-webhookSelector"}))),null!=Y&&Object(c.jsx)(a.EuiFlexItem,null,"any"!==Y&&Object(c.jsx)(o.a.Fragment,null,Object(c.jsx)(a.EuiCallOut,{title:l.WEBHOOK_URL_FALLBACK_TITLE,color:"primary","data-test-subj":"tines-fallbackCallout"},l.WEBHOOK_URL_FALLBACK_TEXT(Y)),Object(c.jsx)(a.EuiSpacer,{size:"s"})),Object(c.jsx)(a.EuiFormRow,{fullWidth:!0,error:E.webhookUrl,isInvalid:!(null===(_=E.webhookUrl)||void 0===_||!_.length),label:l.WEBHOOK_URL_LABEL,helpText:l.WEBHOOK_URL_HELP},Object(c.jsx)(a.EuiFieldText,{placeholder:l.WEBHOOK_URL_PLACEHOLDER,value:m,onChange:e=>{j({webhookUrl:e.target.value})},fullWidth:!0,"data-test-subj":"tines-webhookUrlInput"}))),W&&Object(c.jsx)(a.EuiFlexItem,null,Object(c.jsx)(r.JsonEditorWithMessageVariables,{paramsProperty:"body",inputTargetValue:A,label:l.BODY_LABEL,"aria-label":l.BODY_ARIA_LABEL,errors:E.body,onDocumentsChange:e=>{j({body:e})},onBlur:()=>{A||j({body:""})},"data-test-subj":"tines-bodyJsonEditor"})))}},47:function(e,t,n){"use strict";n.r(t),n.d(t,"URL_LABEL",(function(){return a})),n.d(t,"AUTHENTICATION_TITLE",(function(){return r})),n.d(t,"EMAIL_LABEL",(function(){return i})),n.d(t,"TOKEN_LABEL",(function(){return l})),n.d(t,"URL_INVALID",(function(){return c})),n.d(t,"EMAIL_REQUIRED",(function(){return u})),n.d(t,"TOKEN_REQUIRED",(function(){return d})),n.d(t,"STORY_LABEL",(function(){return O})),n.d(t,"STORY_HELP",(function(){return b})),n.d(t,"STORY_PLACEHOLDER",(function(){return E})),n.d(t,"STORY_ARIA_LABEL",(function(){return k})),n.d(t,"STORY_PUBLISHED_BADGE_TEXT",(function(){return L})),n.d(t,"WEBHOOK_LABEL",(function(){return f})),n.d(t,"WEBHOOK_HELP",(function(){return p})),n.d(t,"WEBHOOK_PLACEHOLDER",(function(){return _})),n.d(t,"WEBHOOK_DISABLED_PLACEHOLDER",(function(){return h})),n.d(t,"WEBHOOK_ARIA_LABEL",(function(){return R})),n.d(t,"WEBHOOK_URL_LABEL",(function(){return y})),n.d(t,"WEBHOOK_URL_FALLBACK_TITLE",(function(){return A})),n.d(t,"WEBHOOK_URL_FALLBACK_TEXT",(function(){return x})),n.d(t,"WEBHOOK_URL_HELP",(function(){return m})),n.d(t,"WEBHOOK_URL_PLACEHOLDER",(function(){return T})),n.d(t,"DISABLED_BY_WEBHOOK_URL_PLACEHOLDER",(function(){return g})),n.d(t,"BODY_LABEL",(function(){return B})),n.d(t,"BODY_ARIA_LABEL",(function(){return v})),n.d(t,"STORIES_ERROR",(function(){return C})),n.d(t,"WEBHOOKS_ERROR",(function(){return I})),n.d(t,"STORY_NOT_FOUND_WARNING",(function(){return W})),n.d(t,"WEBHOOK_NOT_FOUND_WARNING",(function(){return j})),n.d(t,"ACTION_REQUIRED",(function(){return H})),n.d(t,"INVALID_ACTION",(function(){return U})),n.d(t,"BODY_REQUIRED",(function(){return D})),n.d(t,"BODY_INVALID",(function(){return M})),n.d(t,"STORY_REQUIRED",(function(){return S})),n.d(t,"WEBHOOK_REQUIRED",(function(){return w})),n.d(t,"WEBHOOK_PATH_REQUIRED",(function(){return P})),n.d(t,"WEBHOOK_SECRET_REQUIRED",(function(){return K})),n.d(t,"INVALID_WEBHOOK_URL",(function(){return F})),n.d(t,"INVALID_HOSTNAME_WEBHOOK_URL",(function(){return N})),n.d(t,"INVALID_PROTOCOL_WEBHOOK_URL",(function(){return Y}));var s=n(1),o=n(4);const a=s.i18n.translate("xpack.stackConnectors.security.tines.config.urlTextFieldLabel",{defaultMessage:"Tines tenant URL"}),r=s.i18n.translate("xpack.stackConnectors.security.tines.config.authenticationTitle",{defaultMessage:"Authentication"}),i=s.i18n.translate("xpack.stackConnectors.security.tines.config.emailTextFieldLabel",{defaultMessage:"Email"}),l=s.i18n.translate("xpack.stackConnectors.security.tines.config.tokenTextFieldLabel",{defaultMessage:"API token"}),c=s.i18n.translate("xpack.stackConnectors.security.tines.config.error.invalidUrlTextField",{defaultMessage:"Tenant URL is invalid."}),u=s.i18n.translate("xpack.stackConnectors.security.tines.config.error.requiredEmailText",{defaultMessage:"Email is required."}),d=s.i18n.translate("xpack.stackConnectors.security.tines.config.error.requiredAuthTokenText",{defaultMessage:"Auth token is required."}),O=s.i18n.translate("xpack.stackConnectors.security.tines.params.storyFieldLabel",{defaultMessage:"Tines Story"}),b=s.i18n.translate("xpack.stackConnectors.security.tines.params.storyHelp",{defaultMessage:"The Tines story to send the events to"}),E=s.i18n.translate("xpack.stackConnectors.security.tines.params.storyPlaceholder",{defaultMessage:"Select a story"}),k=s.i18n.translate("xpack.stackConnectors.security.tines.params.storyFieldAriaLabel",{defaultMessage:"Select a Tines story"}),L=s.i18n.translate("xpack.stackConnectors.security.tines.params.storyPublishedBadgeText",{defaultMessage:"Published"}),f=s.i18n.translate("xpack.stackConnectors.security.tines.params.webhookFieldLabel",{defaultMessage:"Tines Webhook action"}),p=s.i18n.translate("xpack.stackConnectors.security.tines.params.webhookHelp",{defaultMessage:"The data entry action in the story"}),_=s.i18n.translate("xpack.stackConnectors.security.tines.params.webhookPlaceholder",{defaultMessage:"Select a webhook action"}),h=s.i18n.translate("xpack.stackConnectors.security.tines.params.webhookDisabledPlaceholder",{defaultMessage:"Select a story first"}),R=s.i18n.translate("xpack.stackConnectors.security.tines.params.webhookFieldAriaLabel",{defaultMessage:"Select a Tines webhook action"}),y=s.i18n.translate("xpack.stackConnectors.security.tines.params.webhookUrlFieldLabel",{defaultMessage:"Webhook URL"}),A=s.i18n.translate("xpack.stackConnectors.security.tines.params.webhookUrlFallbackTitle",{defaultMessage:"Tines API results limit reached"}),x=e=>s.i18n.translate("xpack.stackConnectors.security.tines.params.webhookUrlFallbackText",{values:{entity:e,limit:o.a},defaultMessage:"Not possible to retrieve more than {limit} results from the Tines {entity} API. If your {entity} does not appear in the list, please fill the Webhook URL below"}),m=s.i18n.translate("xpack.stackConnectors.security.tines.params.webhookUrlHelp",{defaultMessage:"The Story and Webhook selectors will be ignored if the Webhook URL is defined"}),T=s.i18n.translate("xpack.stackConnectors.security.tines.params.webhookUrlPlaceholder",{defaultMessage:"Paste the Webhook URL here"}),g=s.i18n.translate("xpack.stackConnectors.security.tines.params.disabledByWebhookUrlPlaceholder",{defaultMessage:"Remove the Webhook URL to use this selector"}),B=s.i18n.translate("xpack.stackConnectors.security.tines.params.bodyFieldLabel",{defaultMessage:"Body"}),v=s.i18n.translate("xpack.stackConnectors.security.tines.params.bodyFieldAriaLabel",{defaultMessage:"Request body payload"}),C=s.i18n.translate("xpack.stackConnectors.security.tines.params.componentError.storiesRequestFailed",{defaultMessage:"Error retrieving stories from Tines"}),I=s.i18n.translate("xpack.stackConnectors.security.tines.params.componentError.webhooksRequestFailed",{defaultMessage:"Error retrieving webhook actions from Tines"}),W=s.i18n.translate("xpack.stackConnectors.security.tines.params.componentWarning.storyNotFound",{defaultMessage:"Cannot find the saved story. Please select a valid story from the selector"}),j=s.i18n.translate("xpack.stackConnectors.security.tines.params.componentWarning.webhookNotFound",{defaultMessage:"Cannot find the saved webhook. Please select a valid webhook from the selector"}),H=s.i18n.translate("xpack.stackConnectors.security.tines.params.error.requiredActionText",{defaultMessage:"Action is required."}),U=s.i18n.translate("xpack.stackConnectors.security.tines.params.error.invalidActionText",{defaultMessage:"Invalid action name."}),D=s.i18n.translate("xpack.stackConnectors.security.tines.params.error.requiredBodyText",{defaultMessage:"Body is required."}),M=s.i18n.translate("xpack.stackConnectors.security.tines.params.error.invalidBodyText",{defaultMessage:"Body does not have a valid JSON format."}),S=s.i18n.translate("xpack.stackConnectors.security.tines.params.error.requiredStoryText",{defaultMessage:"Story is required."}),w=s.i18n.translate("xpack.stackConnectors.security.tines.params.error.requiredWebhookText",{defaultMessage:"Webhook is required."}),P=s.i18n.translate("xpack.stackConnectors.security.tines.params.error.requiredWebhookPathText",{defaultMessage:"Webhook action path is missing."}),K=s.i18n.translate("xpack.stackConnectors.security.tines.params.error.requiredWebhookSecretText",{defaultMessage:"Webhook action secret is missing."}),F=s.i18n.translate("xpack.stackConnectors.security.tines.params.error.invalidWebhookUrlText",{defaultMessage:"Webhook URL is invalid."}),N=s.i18n.translate("xpack.stackConnectors.security.tines.params.error.invalidHostnameWebhookUrlText",{defaultMessage:'Webhook URL does not have a valid ".tines.com" domain.'}),Y=s.i18n.translate("xpack.stackConnectors.security.tines.params.error.invalidProtocolWebhookUrlText",{defaultMessage:'Webhook URL does not have a valid "https" protocol.'})}}]);