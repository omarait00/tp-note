/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.stackConnectors_bundle_jsonpfunction=window.stackConnectors_bundle_jsonpfunction||[]).push([[45],{69:function(e,t,n){"use strict";n.r(t),n.d(t,"IndexParamsFields",(function(){return l})),n.d(t,"default",(function(){return l}));var s=n(0),a=n.n(s),o=n(17),i=n(1),r=n(20),d=n(2),c=n(16);const l=({actionParams:e,index:t,editAction:n,messageVariables:l,errors:u,actionConnector:x})=>{const{docLinks:j}=Object(d.useKibana)().services,{documents:m,indexOverride:b}=e,p=d.AlertHistoryDefaultIndexName.replace(d.ALERT_HISTORY_PREFIX,""),[O,g]=Object(s.useState)(!1),f=e=>e&&e.length>0?e[0]:void 0,[I,k]=Object(s.useState)(f(m)),[E,T]=Object(s.useState)(b?b.replace(d.ALERT_HISTORY_PREFIX,""):p),[v,R]=Object(s.useState)(!1);Object(s.useEffect)((()=>{k(f(m)),null===m&&k("{}")}),[m]),Object(s.useEffect)((()=>{(null==x?void 0:x.id)===d.AlertHistoryEsIndexConnectorId?(R(!0),n("documents",[JSON.stringify(d.AlertHistoryDocumentTemplate)],t),k(JSON.stringify(d.AlertHistoryDocumentTemplate))):O&&(R(!1),n("documents",void 0,t),k(void 0)),g(!0)}),[null==x?void 0:x.id]);const h=e=>{try{const s=JSON.parse(e);n("documents",[s],t),k(e)}catch(e){n("documents",[{}],t),k(void 0)}},A=i.i18n.translate("xpack.stackConnectors.components.index.documentsFieldLabel",{defaultMessage:"Document to index"}),C=b&&b!==d.AlertHistoryDefaultIndexName?Object(c.jsx)(o.EuiText,{size:"xs"},Object(c.jsx)(o.EuiLink,{"data-test-subj":"resetDefaultIndex",onClick:()=>{n("indexOverride",d.AlertHistoryDefaultIndexName,t),T(p)}},Object(c.jsx)(o.EuiIcon,{type:"refresh"}),Object(c.jsx)(r.FormattedMessage,{id:"xpack.stackConnectors.components.index.resetDefaultIndexLabel",defaultMessage:"Reset default index"}))):Object(c.jsx)(a.a.Fragment,null),F=Object(c.jsx)(a.a.Fragment,null,Object(c.jsx)(o.EuiFormRow,{fullWidth:!0,error:u.indexOverride,isInvalid:void 0!==u.indexOverride&&u.indexOverride&&u.indexOverride.length>0,label:i.i18n.translate("xpack.stackConnectors.components.index.preconfiguredIndex",{defaultMessage:"Elasticsearch index"}),labelAppend:C,helpText:Object(c.jsx)(a.a.Fragment,null,Object(c.jsx)(r.FormattedMessage,{id:"xpack.stackConnectors.components.index.preconfiguredIndexHelpText",defaultMessage:"Documents are indexed into the {alertHistoryIndex} index. ",values:{alertHistoryIndex:`${d.ALERT_HISTORY_PREFIX}${E}`}}),Object(c.jsx)(o.EuiLink,{href:j.links.alerting.preconfiguredAlertHistoryConnector,target:"_blank"},Object(c.jsx)(r.FormattedMessage,{id:"xpack.stackConnectors.components.index.preconfiguredIndexDocLink",defaultMessage:"View docs."})))},Object(c.jsx)(o.EuiFieldText,{fullWidth:!0,"data-test-subj":"preconfiguredIndexToUse",prepend:d.ALERT_HISTORY_PREFIX,value:E,onChange:e=>{n("indexOverride",`${d.ALERT_HISTORY_PREFIX}${e.target.value}`,t),T(e.target.value)}})),Object(c.jsx)(o.EuiSpacer,{size:"m"}),Object(c.jsx)(o.EuiFormRow,{fullWidth:!0,label:A},Object(c.jsx)(o.EuiCodeBlock,{language:"json",fontSize:"s",paddingSize:"s","data-test-subj":"preconfiguredDocumentToIndex"},JSON.stringify(d.AlertHistoryDocumentTemplate,null,2)))),H=Object(c.jsx)(d.JsonEditorWithMessageVariables,{messageVariables:l,paramsProperty:"documents","data-test-subj":"documentToIndex",inputTargetValue:null===I?"{}":I,label:A,"aria-label":i.i18n.translate("xpack.stackConnectors.components.index.jsonDocAriaLabel",{defaultMessage:"Code editor"}),errors:u.documents,onDocumentsChange:h,helpText:Object(c.jsx)(o.EuiLink,{href:j.links.alerting.indexAction,target:"_blank"},Object(c.jsx)(r.FormattedMessage,{id:"xpack.stackConnectors.components.index.indexDocumentHelpLabel",defaultMessage:"Index document example."})),onBlur:()=>{I||h("{}")}});return v?F:H}}}]);