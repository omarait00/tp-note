/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.stackConnectors_bundle_jsonpfunction=window.stackConnectors_bundle_jsonpfunction||[]).push([[24,46],{54:function(e,t,n){"use strict";n.r(t),n.d(t,"INDEX_IS_NOT_VALID",(function(){return s})),n.d(t,"DOCUMENT_NOT_VALID",(function(){return o})),n.d(t,"HISTORY_NOT_VALID",(function(){return a})),n.d(t,"EXECUTION_TIME_LABEL",(function(){return c})),n.d(t,"SHOW_TIME_FIELD_TOGGLE_TOOLTIP",(function(){return r})),n.d(t,"REFRESH_FIELD_TOGGLE_TOOLTIP",(function(){return d})),n.d(t,"INDEX_LABEL",(function(){return l}));var i=n(1);const s=i.i18n.translate("xpack.stackConnectors.components.index.error.notValidIndexText",{defaultMessage:"Index is not valid."}),o=i.i18n.translate("xpack.stackConnectors.components.index.error.requiredDocumentJson",{defaultMessage:"Document is required and should be a valid JSON object."}),a=i.i18n.translate("xpack.stackConnectors.components.index.error.badIndexOverrideSuffix",{defaultMessage:"Alert history index must contain valid suffix."}),c=i.i18n.translate("xpack.stackConnectors.components.index.executionTimeFieldLabel",{defaultMessage:"Time field"}),r=i.i18n.translate("xpack.stackConnectors.components.index.definedateFieldTooltip",{defaultMessage:"Set this time field to the time the document was indexed."}),d=i.i18n.translate("xpack.stackConnectors.components.index.refreshTooltip",{defaultMessage:"Refresh the affected shards to make this operation visible to search."}),l=i.i18n.translate("xpack.stackConnectors.components.index.indicesToQueryLabel",{defaultMessage:"Index"})},68:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return g}));var i=n(0),s=n.n(i),o=n(7),a=n(17),c=n(18),r=n(21),d=n(19),l=n(20),u=n(1),x=n(2),b=n(54),j=n(16);const{indexPatternField:p,emptyField:O}=r.fieldValidators,f=e=>({label:b.INDEX_LABEL,helpText:Object(j.jsx)(s.a.Fragment,null,Object(j.jsx)(l.FormattedMessage,{id:"xpack.stackConnectors.components.index.howToBroadenSearchQueryDescription",defaultMessage:"Use * to broaden your query."}),Object(j.jsx)(a.EuiSpacer,{size:"s"}),Object(j.jsx)(a.EuiLink,{href:e.links.alerting.indexAction,target:"_blank"},Object(j.jsx)(l.FormattedMessage,{id:"xpack.stackConnectors.components.index.configureIndexHelpLabel",defaultMessage:"Configuring index connector."}))),validations:[{validator:O(b.INDEX_IS_NOT_VALID)},{validator:p(u.i18n),type:c.VALIDATION_TYPES.ARRAY_ITEM}]}),g=({readOnly:e})=>{const{http:t,docLinks:n}=Object(x.useKibana)().services,{getFieldDefaultValue:r}=Object(c.useFormContext)(),[{config:u,__internal__:p}]=Object(c.useFormData)({watch:["config.executionTimeField","config.index","__internal__.hasTimeFieldCheckbox"]}),{index:O=null}=null!=u?u:{},[g,m]=Object(i.useState)([]),[T,h]=Object(i.useState)([]),[F,_]=Object(i.useState)(!1),E=!!r("config.executionTimeField"),I=null!=O&&T.length>0,k=null!=p&&p.hasTimeFieldCheckbox,L=e=>{e.length>0?h([x.firstFieldOption,...e]):h([])},C=Object(o.debounce)((async e=>{_(!0),m(await Object(x.getIndexOptions)(t,e)),_(!1)}),250);return Object(i.useEffect)((()=>{(async()=>{if(O){const e=await Object(x.getFields)(t,[O]);Array.isArray(e)&&L(Object(x.getTimeFieldOptions)(e))}})()}),[t,O]),Object(j.jsx)(s.a.Fragment,null,Object(j.jsx)(a.EuiTitle,{size:"s"},Object(j.jsx)("h5",null,Object(j.jsx)(l.FormattedMessage,{defaultMessage:"Write to index",id:"xpack.stackConnectors.components.index.connectorSectionTitle"}))),Object(j.jsx)(a.EuiSpacer,{size:"m"}),Object(j.jsx)(c.UseField,{path:"config.index",config:f(n)},(i=>{const{isInvalid:o,errorMessage:r}=Object(c.getFieldValidityAndErrorMessage)(i);return Object(j.jsx)(a.EuiFormRow,{id:"indexConnectorSelectSearchBox",fullWidth:!0,label:Object(j.jsx)(l.FormattedMessage,{id:"xpack.stackConnectors.components.index.indicesToQueryLabel",defaultMessage:"Index"}),isInvalid:o,error:r,helpText:Object(j.jsx)(s.a.Fragment,null,Object(j.jsx)(l.FormattedMessage,{id:"xpack.stackConnectors.components.index.howToBroadenSearchQueryDescription",defaultMessage:"Use * to broaden your query."}),Object(j.jsx)(a.EuiSpacer,{size:"s"}),Object(j.jsx)(a.EuiLink,{href:n.links.alerting.indexAction,target:"_blank"},Object(j.jsx)(l.FormattedMessage,{id:"xpack.stackConnectors.components.index.configureIndexHelpLabel",defaultMessage:"Configuring index connector."})))},Object(j.jsx)(a.EuiComboBox,{fullWidth:!0,singleSelection:{asPlainText:!0},async:!0,isLoading:F,isInvalid:o,noSuggestions:!g.length,options:g,"data-test-subj":"connectorIndexesComboBox","data-testid":"connectorIndexesComboBox",selectedOptions:O?[{value:O,label:O}]:[],isDisabled:e,onChange:async e=>{i.setValue(e.length>0?e[0].value:"");const n=e.map((e=>e.value));if(0===n.length)return void L([]);const s=await Object(x.getFields)(t,n);L(Object(x.getTimeFieldOptions)(s))},onSearchChange:e=>{void 0!==e&&i.clearErrors(c.VALIDATION_TYPES.ARRAY_ITEM),C(e)}}))})),Object(j.jsx)(a.EuiSpacer,{size:"m"}),Object(j.jsx)(c.UseField,{path:"config.refresh",component:d.ToggleField,config:{defaultValue:!1},componentProps:{euiFieldProps:{label:Object(j.jsx)(s.a.Fragment,null,Object(j.jsx)(l.FormattedMessage,{id:"xpack.stackConnectors.components.index.refreshLabel",defaultMessage:"Refresh index"})," ",Object(j.jsx)(a.EuiIconTip,{position:"right",type:"questionInCircle",content:b.REFRESH_FIELD_TOGGLE_TOOLTIP})),disabled:e,"data-test-subj":"indexRefreshCheckbox"}}}),Object(j.jsx)(a.EuiSpacer,{size:"m"}),I?Object(j.jsx)(c.UseField,{path:"__internal__.hasTimeFieldCheckbox",component:d.ToggleField,config:{defaultValue:E},componentProps:{euiFieldProps:{label:Object(j.jsx)(s.a.Fragment,null,Object(j.jsx)(l.FormattedMessage,{id:"xpack.stackConnectors.components.index.defineTimeFieldLabel",defaultMessage:"Define time field for each document"}),Object(j.jsx)(a.EuiIconTip,{position:"right",type:"questionInCircle",content:b.SHOW_TIME_FIELD_TOGGLE_TOOLTIP})),disabled:e,"data-test-subj":"hasTimeFieldCheckbox"}}}):null,k?Object(j.jsx)(s.a.Fragment,null,Object(j.jsx)(a.EuiSpacer,{size:"m"}),Object(j.jsx)(c.UseField,{path:"config.executionTimeField",component:d.SelectField,config:{label:b.EXECUTION_TIME_LABEL},componentProps:{euiFieldProps:{"data-test-subj":"executionTimeFieldSelect",options:T,fullWidth:!0,readOnly:e}}})):null)}}}]);