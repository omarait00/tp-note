/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.snapshotRestore_bundle_jsonpfunction=window.snapshotRestore_bundle_jsonpfunction||[]).push([[1],Array(36).concat([function(e,t,s){e.exports=s(17)(3)},function(e,t,s){(function(t){const s="object"==typeof t&&Object({IS_KIBANA_DISTRIBUTABLE:"true"})&&Object({IS_KIBANA_DISTRIBUTABLE:"true"}).NODE_DEBUG&&/\bsemver\b/i.test(Object({IS_KIBANA_DISTRIBUTABLE:"true"}).NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=s}).call(this,s(43))},function(e,t){const s=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:s,MAX_SAFE_COMPONENT_LENGTH:16}},function(e,t,s){"use strict";const a=s(49),o=s(50),i=s(51);function r(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function n(e,t){return t.encode?t.strict?a(e):encodeURIComponent(e):e}function l(e,t){return t.decode?o(e):e}function c(e){return Array.isArray(e)?e.sort():"object"==typeof e?c(Object.keys(e)).sort(((e,t)=>Number(e)-Number(t))).map((t=>e[t])):e}function p(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function u(e){const t=(e=p(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function d(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function j(e,t){r((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const s=function(e){let t;switch(e.arrayFormat){case"index":return(e,s,a)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===a[e]&&(a[e]={}),a[e][t[1]]=s):a[e]=s};case"bracket":return(e,s,a)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==a[e]?a[e]=[].concat(a[e],s):a[e]=[s]:a[e]=s};case"comma":case"separator":return(t,s,a)=>{const o="string"==typeof s&&s.split("").indexOf(e.arrayFormatSeparator)>-1?s.split(e.arrayFormatSeparator).map((t=>l(t,e))):null===s?s:l(s,e);a[t]=o};default:return(e,t,s)=>{void 0!==s[e]?s[e]=[].concat(s[e],t):s[e]=t}}}(t),a=Object.create(null);if("string"!=typeof e)return a;if(!(e=e.trim().replace(/^[?#&]/,"")))return a;for(const o of e.split("&")){let[e,r]=i(t.decode?o.replace(/\+/g," "):o,"=");r=void 0===r?null:["comma","separator"].includes(t.arrayFormat)?r:l(r,t),s(l(e,t),r,a)}for(const e of Object.keys(a)){const s=a[e];if("object"==typeof s&&null!==s)for(const e of Object.keys(s))s[e]=d(s[e],t);else a[e]=d(s,t)}return!1===t.sort?a:(!0===t.sort?Object.keys(a).sort():Object.keys(a).sort(t.sort)).reduce(((e,t)=>{const s=a[t];return Boolean(s)&&"object"==typeof s&&!Array.isArray(s)?e[t]=c(s):e[t]=s,e}),Object.create(null))}t.extract=u,t.parse=j,t.stringify=(e,t)=>{if(!e)return"";r((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const s=s=>t.skipNull&&null==e[s]||t.skipEmptyString&&""===e[s],a=function(e){switch(e.arrayFormat){case"index":return t=>(s,a)=>{const o=s.length;return void 0===a||e.skipNull&&null===a||e.skipEmptyString&&""===a?s:null===a?[...s,[n(t,e),"[",o,"]"].join("")]:[...s,[n(t,e),"[",n(o,e),"]=",n(a,e)].join("")]};case"bracket":return t=>(s,a)=>void 0===a||e.skipNull&&null===a||e.skipEmptyString&&""===a?s:null===a?[...s,[n(t,e),"[]"].join("")]:[...s,[n(t,e),"[]=",n(a,e)].join("")];case"comma":case"separator":return t=>(s,a)=>null==a||0===a.length?s:0===s.length?[[n(t,e),"=",n(a,e)].join("")]:[[s,n(a,e)].join(e.arrayFormatSeparator)];default:return t=>(s,a)=>void 0===a||e.skipNull&&null===a||e.skipEmptyString&&""===a?s:null===a?[...s,n(t,e)]:[...s,[n(t,e),"=",n(a,e)].join("")]}}(t),o={};for(const t of Object.keys(e))s(t)||(o[t]=e[t]);const i=Object.keys(o);return!1!==t.sort&&i.sort(t.sort),i.map((s=>{const o=e[s];return void 0===o?"":null===o?n(s,t):Array.isArray(o)?o.reduce(a(s),[]).join("&"):n(s,t)+"="+n(o,t)})).filter((e=>e.length>0)).join("&")},t.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[s,a]=i(e,"#");return Object.assign({url:s.split("?")[0]||"",query:j(u(e),t)},t&&t.parseFragmentIdentifier&&a?{fragmentIdentifier:l(a,t)}:{})},t.stringifyUrl=(e,s)=>{s=Object.assign({encode:!0,strict:!0},s);const a=p(e.url).split("?")[0]||"",o=t.extract(e.url),i=t.parse(o,{sort:!1}),r=Object.assign(i,e.query);let l=t.stringify(r,s);l&&(l=`?${l}`);let c=function(e){let t="";const s=e.indexOf("#");return-1!==s&&(t=e.slice(s)),t}(e.url);return e.fragmentIdentifier&&(c=`#${n(e.fragmentIdentifier,s)}`),`${a}${l}${c}`}},function(e,t,s){const a=s(41);e.exports=(e,t,s)=>a(e,t,s)>0},function(e,t,s){const a=s(42);e.exports=(e,t,s)=>new a(e,s).compare(new a(t,s))},function(e,t,s){const a=s(37),{MAX_LENGTH:o,MAX_SAFE_INTEGER:i}=s(38),{re:r,t:n}=s(44),l=s(45),{compareIdentifiers:c}=s(46);class SemVer{constructor(e,t){if(t=l(t),e instanceof SemVer){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError(`Invalid Version: ${e}`);if(e.length>o)throw new TypeError(`version is longer than ${o} characters`);a("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const s=e.trim().match(t.loose?r[n.LOOSE]:r[n.FULL]);if(!s)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+s[1],this.minor=+s[2],this.patch=+s[3],this.major>i||this.major<0)throw new TypeError("Invalid major version");if(this.minor>i||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>i||this.patch<0)throw new TypeError("Invalid patch version");s[4]?this.prerelease=s[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<i)return t}return e})):this.prerelease=[],this.build=s[5]?s[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(a("SemVer.compare",this.version,this.options,e),!(e instanceof SemVer)){if("string"==typeof e&&e===this.version)return 0;e=new SemVer(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof SemVer||(e=new SemVer(e,this.options)),c(this.major,e.major)||c(this.minor,e.minor)||c(this.patch,e.patch)}comparePre(e){if(e instanceof SemVer||(e=new SemVer(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const s=this.prerelease[t],o=e.prerelease[t];if(a("prerelease compare",t,s,o),void 0===s&&void 0===o)return 0;if(void 0===o)return 1;if(void 0===s)return-1;if(s!==o)return c(s,o)}while(++t)}compareBuild(e){e instanceof SemVer||(e=new SemVer(e,this.options));let t=0;do{const s=this.build[t],o=e.build[t];if(a("prerelease compare",t,s,o),void 0===s&&void 0===o)return 0;if(void 0===o)return 1;if(void 0===s)return-1;if(s!==o)return c(s,o)}while(++t)}inc(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{let e=this.prerelease.length;for(;--e>=0;)"number"==typeof this.prerelease[e]&&(this.prerelease[e]++,e=-2);-1===e&&this.prerelease.push(0)}t&&(0===c(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error(`invalid increment argument: ${e}`)}return this.format(),this.raw=this.version,this}}e.exports=SemVer},function(e,t,s){e.exports=s(17)(477)},function(e,t,s){const{MAX_SAFE_COMPONENT_LENGTH:a}=s(38),o=s(37),i=(t=e.exports={}).re=[],r=t.src=[],n=t.t={};let l=0;const c=(e,t,s)=>{const a=l++;o(e,a,t),n[e]=a,r[a]=t,i[a]=new RegExp(t,s?"g":void 0)};c("NUMERICIDENTIFIER","0|[1-9]\\d*"),c("NUMERICIDENTIFIERLOOSE","[0-9]+"),c("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),c("MAINVERSION",`(${r[n.NUMERICIDENTIFIER]})\\.(${r[n.NUMERICIDENTIFIER]})\\.(${r[n.NUMERICIDENTIFIER]})`),c("MAINVERSIONLOOSE",`(${r[n.NUMERICIDENTIFIERLOOSE]})\\.(${r[n.NUMERICIDENTIFIERLOOSE]})\\.(${r[n.NUMERICIDENTIFIERLOOSE]})`),c("PRERELEASEIDENTIFIER",`(?:${r[n.NUMERICIDENTIFIER]}|${r[n.NONNUMERICIDENTIFIER]})`),c("PRERELEASEIDENTIFIERLOOSE",`(?:${r[n.NUMERICIDENTIFIERLOOSE]}|${r[n.NONNUMERICIDENTIFIER]})`),c("PRERELEASE",`(?:-(${r[n.PRERELEASEIDENTIFIER]}(?:\\.${r[n.PRERELEASEIDENTIFIER]})*))`),c("PRERELEASELOOSE",`(?:-?(${r[n.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${r[n.PRERELEASEIDENTIFIERLOOSE]})*))`),c("BUILDIDENTIFIER","[0-9A-Za-z-]+"),c("BUILD",`(?:\\+(${r[n.BUILDIDENTIFIER]}(?:\\.${r[n.BUILDIDENTIFIER]})*))`),c("FULLPLAIN",`v?${r[n.MAINVERSION]}${r[n.PRERELEASE]}?${r[n.BUILD]}?`),c("FULL",`^${r[n.FULLPLAIN]}$`),c("LOOSEPLAIN",`[v=\\s]*${r[n.MAINVERSIONLOOSE]}${r[n.PRERELEASELOOSE]}?${r[n.BUILD]}?`),c("LOOSE",`^${r[n.LOOSEPLAIN]}$`),c("GTLT","((?:<|>)?=?)"),c("XRANGEIDENTIFIERLOOSE",`${r[n.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),c("XRANGEIDENTIFIER",`${r[n.NUMERICIDENTIFIER]}|x|X|\\*`),c("XRANGEPLAIN",`[v=\\s]*(${r[n.XRANGEIDENTIFIER]})(?:\\.(${r[n.XRANGEIDENTIFIER]})(?:\\.(${r[n.XRANGEIDENTIFIER]})(?:${r[n.PRERELEASE]})?${r[n.BUILD]}?)?)?`),c("XRANGEPLAINLOOSE",`[v=\\s]*(${r[n.XRANGEIDENTIFIERLOOSE]})(?:\\.(${r[n.XRANGEIDENTIFIERLOOSE]})(?:\\.(${r[n.XRANGEIDENTIFIERLOOSE]})(?:${r[n.PRERELEASELOOSE]})?${r[n.BUILD]}?)?)?`),c("XRANGE",`^${r[n.GTLT]}\\s*${r[n.XRANGEPLAIN]}$`),c("XRANGELOOSE",`^${r[n.GTLT]}\\s*${r[n.XRANGEPLAINLOOSE]}$`),c("COERCE",`(^|[^\\d])(\\d{1,${a}})(?:\\.(\\d{1,${a}}))?(?:\\.(\\d{1,${a}}))?(?:$|[^\\d])`),c("COERCERTL",r[n.COERCE],!0),c("LONETILDE","(?:~>?)"),c("TILDETRIM",`(\\s*)${r[n.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",c("TILDE",`^${r[n.LONETILDE]}${r[n.XRANGEPLAIN]}$`),c("TILDELOOSE",`^${r[n.LONETILDE]}${r[n.XRANGEPLAINLOOSE]}$`),c("LONECARET","(?:\\^)"),c("CARETTRIM",`(\\s*)${r[n.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",c("CARET",`^${r[n.LONECARET]}${r[n.XRANGEPLAIN]}$`),c("CARETLOOSE",`^${r[n.LONECARET]}${r[n.XRANGEPLAINLOOSE]}$`),c("COMPARATORLOOSE",`^${r[n.GTLT]}\\s*(${r[n.LOOSEPLAIN]})$|^$`),c("COMPARATOR",`^${r[n.GTLT]}\\s*(${r[n.FULLPLAIN]})$|^$`),c("COMPARATORTRIM",`(\\s*)${r[n.GTLT]}\\s*(${r[n.LOOSEPLAIN]}|${r[n.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",c("HYPHENRANGE",`^\\s*(${r[n.XRANGEPLAIN]})\\s+-\\s+(${r[n.XRANGEPLAIN]})\\s*$`),c("HYPHENRANGELOOSE",`^\\s*(${r[n.XRANGEPLAINLOOSE]})\\s+-\\s+(${r[n.XRANGEPLAINLOOSE]})\\s*$`),c("STAR","(<|>)?=?\\s*\\*"),c("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),c("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},function(e,t){const s=["includePrerelease","loose","rtl"];e.exports=e=>e?"object"!=typeof e?{loose:!0}:s.filter((t=>e[t])).reduce(((e,t)=>(e[t]=!0,e)),{}):{}},function(e,t){const s=/^[0-9]+$/,a=(e,t)=>{const a=s.test(e),o=s.test(t);return a&&o&&(e=+e,t=+t),e===t?0:a&&!o?-1:o&&!a?1:e<t?-1:1};e.exports={compareIdentifiers:a,rcompareIdentifiers:(e,t)=>a(t,e)}},function(e,t,s){e.exports=s(17)(3573)},function(e,t){ace.define("ace/theme/textmate",["require","exports","module","ace/lib/dom"],(function(e,t,s){"use strict";t.isDark=!1,t.cssClass="ace-tm",t.cssText='.ace-tm .ace_gutter {background: #f0f0f0;color: #333;}.ace-tm .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-tm .ace_fold {background-color: #6B72E6;}.ace-tm {background-color: #FFFFFF;color: black;}.ace-tm .ace_cursor {color: black;}.ace-tm .ace_invisible {color: rgb(191, 191, 191);}.ace-tm .ace_storage,.ace-tm .ace_keyword {color: blue;}.ace-tm .ace_constant {color: rgb(197, 6, 11);}.ace-tm .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-tm .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-tm .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-tm .ace_invalid {background-color: rgba(255, 0, 0, 0.1);color: red;}.ace-tm .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-tm .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-tm .ace_support.ace_type,.ace-tm .ace_support.ace_class {color: rgb(109, 121, 222);}.ace-tm .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-tm .ace_string {color: rgb(3, 106, 7);}.ace-tm .ace_comment {color: rgb(76, 136, 107);}.ace-tm .ace_comment.ace_doc {color: rgb(0, 102, 255);}.ace-tm .ace_comment.ace_doc.ace_tag {color: rgb(128, 159, 191);}.ace-tm .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-tm .ace_variable {color: rgb(49, 132, 149);}.ace-tm .ace_xml-pe {color: rgb(104, 104, 91);}.ace-tm .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-tm .ace_heading {color: rgb(12, 7, 255);}.ace-tm .ace_list {color:rgb(185, 6, 144);}.ace-tm .ace_meta.ace_tag {color:rgb(0, 22, 142);}.ace-tm .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-tm .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-tm.ace_multiselect .ace_selection.ace_start {box-shadow: 0 0 3px 0px white;}.ace-tm .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-tm .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-tm .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-tm .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-tm .ace_gutter-active-line {background-color : #dcdcdc;}.ace-tm .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-tm .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}',e("../lib/dom").importCssString(t.cssText,t.cssClass)}))},function(e,t,s){"use strict";e.exports=e=>encodeURIComponent(e).replace(/[!'()*]/g,(e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`))},function(e,t,s){"use strict";var a="%[a-f0-9]{2}",o=new RegExp(a,"gi"),i=new RegExp("("+a+")+","gi");function r(e,t){try{return decodeURIComponent(e.join(""))}catch(e){}if(1===e.length)return e;t=t||1;var s=e.slice(0,t),a=e.slice(t);return Array.prototype.concat.call([],r(s),r(a))}function n(e){try{return decodeURIComponent(e)}catch(a){for(var t=e.match(o),s=1;s<t.length;s++)t=(e=r(t,s).join("")).match(o);return e}}e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"��","%FF%FE":"��"},s=i.exec(e);s;){try{t[s[0]]=decodeURIComponent(s[0])}catch(e){var a=n(s[0]);a!==s[0]&&(t[s[0]]=a)}s=i.exec(e)}t["%C2"]="�";for(var o=Object.keys(t),r=0;r<o.length;r++){var l=o[r];e=e.replace(new RegExp(l,"g"),t[l])}return e}(e)}}},function(e,t,s){"use strict";e.exports=(e,t)=>{if("string"!=typeof e||"string"!=typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===t)return[e];const s=e.indexOf(t);return-1===s?[e]:[e.slice(0,s),e.slice(s+t.length)]}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s(34),o=s(26),i=a.__importDefault(s(53));t.default=function(e,t,s){void 0===t&&(t=0),void 0===s&&(s=[]);var a=i.default(e,t),r=a[0],n=a[1],l=a[2];return o.useEffect(l,s),[r,n]}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s(26);t.default=function(e,t){void 0===t&&(t=0);var s=a.useRef(!1),o=a.useRef(),i=a.useRef(e),r=a.useCallback((function(){return s.current}),[]),n=a.useCallback((function(){s.current=!1,o.current&&clearTimeout(o.current),o.current=setTimeout((function(){s.current=!0,i.current()}),t)}),[t]),l=a.useCallback((function(){s.current=null,o.current&&clearTimeout(o.current)}),[]);return a.useEffect((function(){i.current=e}),[e]),a.useEffect((function(){return n(),l}),[t]),[r,l,n]}},function(e,t,s){"use strict";s.r(t),s.d(t,"mountManagementSection",(function(){return es}));var a=s(7),o=s(6),i=s(12),r=s(26),n=s.n(r),l=s(32),c=s(30),p=s(28),u=s(29),d=s(13),j=s(9),b=s(11),x=s(27);const g=Object(r.createContext)(void 0),m=({children:e,value:t})=>Object(x.jsx)(g.Provider,{value:t},e),h=(g.Consumer,()=>{const e=Object(r.useContext)(g);if(!e)throw new Error('"useAppContext" can only be called inside of AppContext.Provider!');return e}),O=()=>h().services,y=()=>h().core,f=()=>h().config,M=()=>{const{notifications:{toasts:e}}=y();return e},F=({data:e,children:t})=>{const{i18n:s}=O();return null!=e?t:Object(x.jsx)(n.a.Fragment,null,s.translate("xpack.snapshotRestore.dataPlaceholderLabel",{defaultMessage:"-"}))},E=({epochMs:e,type:t})=>{const s=new Date(e),a=Object(x.jsx)(u.FormattedDate,{value:s,year:"numeric",month:"short",day:"2-digit"}),o=Object(x.jsx)(u.FormattedTime,{value:s,timeZoneName:"short"});return t?"date"===t?a:o:Object(x.jsx)(r.Fragment,null,a," ",o)},R=({children:e})=>{const{i18n:t}=O(),s=M(),[a,i]=Object(r.useState)([]),[n,l]=Object(r.useState)(!1),c=Object(r.useRef)(null),d=()=>{l(!1),i([])},j=()=>{const e=[...a];Object(o.e)(e).then((({data:a,error:o})=>{const{itemsDeleted:i,errors:r}=a||{itemsDeleted:void 0,errors:void 0};if(i&&i.length){const e=i.length>1?t.translate("xpack.snapshotRestore.deleteRepository.successMultipleNotificationTitle",{defaultMessage:"Removed {count} repositories",values:{count:i.length}}):t.translate("xpack.snapshotRestore.deleteRepository.successSingleNotificationTitle",{defaultMessage:"Removed repository '{name}'",values:{name:i[0]}});s.addSuccess(e),c.current&&c.current([...i])}if(o||r&&r.length){const a=r&&r.length>1||o&&e.length>1?t.translate("xpack.snapshotRestore.deleteRepository.errorMultipleNotificationTitle",{defaultMessage:"Error removing {count} repositories",values:{count:r&&r.length||e.length}}):t.translate("xpack.snapshotRestore.deleteRepository.errorSingleNotificationTitle",{defaultMessage:"Error removing repository '{name}'",values:{name:r&&r[0].name||e[0]}});s.addDanger(a)}})),d()};return Object(x.jsx)(r.Fragment,null,e(((e,t=(()=>{}))=>{if(!e||!e.length)throw new Error("No repository names specified for deletion");l(!0),i(e),c.current=t})),(()=>{if(!n)return null;const e=1===a.length;return Object(x.jsx)(p.EuiConfirmModal,{title:e?Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.deleteRepository.confirmModal.deleteSingleTitle",defaultMessage:"Remove repository '{name}'?",values:{name:a[0]}}):Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.deleteRepository.confirmModal.deleteMultipleTitle",defaultMessage:"Remove {count} repositories?",values:{count:a.length}}),onCancel:d,onConfirm:j,cancelButtonText:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.deleteRepository.confirmModal.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:e?Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.deleteRepository.confirmModal.confirmSingleButtonLabel",defaultMessage:"Remove repository"}):Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.deleteRepository.confirmModal.confirmMultipleButtonLabel",defaultMessage:"Remove repositories"}),buttonColor:"danger","data-test-subj":"deleteRepositoryConfirmation"},e?Object(x.jsx)("p",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.deleteRepository.confirmModal.deleteSingleDescription",defaultMessage:"The snapshots in this repository will still exist, but Elasticsearch won’t have access to them. Adjust policies that use this repository to prevent scheduled snapshots from failing."})):Object(x.jsx)(r.Fragment,null,Object(x.jsx)("p",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.deleteRepository.confirmModal.deleteMultipleListDescription",defaultMessage:"You are about to remove these repositories:"})),Object(x.jsx)("ul",null,a.map((e=>Object(x.jsx)("li",{key:e},e)))),Object(x.jsx)("p",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.deleteRepository.confirmModal.deleteMultipleDescription",defaultMessage:"The snapshots in these repositories will still exist, but Elasticsearch won't have access to them. Adjust policies that use these repositories to prevent scheduled snapshots from failing."}))))})())},S=(e,t=[])=>e instanceof Object?Object.keys(e).reduce(((s,a)=>({...s,...S(e[a],[...t,a])})),{}):{[t.join(".")]:e};var k=s(31),L=(s(33),s(0));const T=e=>e&&Array.isArray(e)?e:"string"==typeof e?e.split(","):void 0;function v(e){const{expireAfterValue:t,expireAfterUnit:s,minCount:a,maxCount:o}=e,i={expire_after:t&&s?(r=t,n=s,`${r}${n}`):void 0,min_count:a||void 0,max_count:o||void 0};var r,n;const l=Object.entries(i).reduce(((e,[t,s])=>(void 0!==s&&(e[t]=s),e)),{});return Object.entries(l).length?l:void 0}var D=s(3);const I=['"',"*","\\","<","|",",",">","/","?","#"],C=e=>!e||!Boolean(e.trim()),w=(e,t=!0)=>{const{name:s,type:a,settings:o}=e,{i18n:i}=D.a,r={isValid:!0,errors:{}};if(t){const e=B(a,o);Object.keys(e).length&&(r.errors.settings=e)}C(s)&&(r.errors.name=[i.translate("xpack.snapshotRestore.repositoryValidation.nameRequired",{defaultMessage:"Repository name is required."})]),s.includes(" ")&&(r.errors.name=[i.translate("xpack.snapshotRestore.repositoryValidation.nameValidation.errorSpace",{defaultMessage:"Spaces are not allowed in the name."})]);const n=((e,t)=>{const s=Array.isArray(t)?t:[t],a=s.length;let o=!1,i=null;for(let t=0;t<a;t++)if(e.includes(s[t])){o=!0,i=s[t];break}return{containsChar:o,charFound:i}})(s,I);return n.containsChar&&(r.errors.name=[i.translate("xpack.snapshotRestore.repositoryValidation.nameValidation.invalidCharacter",{defaultMessage:'Character "{char}" is not allowed in the name.',values:{char:n.charFound}})]),(C(a)||a===L.g.source&&C(o.delegateType))&&(r.errors.type=[i.translate("xpack.snapshotRestore.repositoryValidation.delegateTypeRequired",{defaultMessage:"Type is required."})]),Object.keys(r.errors).length&&(r.isValid=!1),r},B=(e,t)=>{switch(e){case L.g.fs:return P(t);case L.g.url:return A(t);case L.g.source:return B(t.delegateType,t);case L.g.s3:return N(t);case L.g.gcs:return z(t);case L.g.hdfs:return G(t);default:return{}}},P=e=>{const t=D.a.i18n,s={},{location:a}=e;return C(a)&&(s.location=[t.translate("xpack.snapshotRestore.repositoryValidation.locationRequired",{defaultMessage:"Location is required."})]),s},A=e=>{const t=D.a.i18n,s={},{url:a}=e;return C(a)&&(s.url=[t.translate("xpack.snapshotRestore.repositoryValidation.urlRequired",{defaultMessage:"URL is required."})]),s},N=e=>{const t=D.a.i18n,s={},{bucket:a}=e;return C(a)&&(s.bucket=[t.translate("xpack.snapshotRestore.repositoryValidation.bucketRequired",{defaultMessage:"Bucket is required."})]),s},z=e=>{const t=D.a.i18n,s={},{bucket:a}=e;return C(a)&&(s.bucket=[t.translate("xpack.snapshotRestore.repositoryValidation.bucketRequired",{defaultMessage:"Bucket is required."})]),s},G=e=>{const t=D.a.i18n,s={},{uri:a,path:o}=e;return C(a)&&(s.uri=[t.translate("xpack.snapshotRestore.repositoryValidation.uriRequired",{defaultMessage:"URI is required."})]),C(o)&&(s.path=[t.translate("xpack.snapshotRestore.repositoryValidation.pathRequired",{defaultMessage:"Path is required."})]),s};var _=s(2);const W=e=>!e||!Boolean(e.trim()),V=e=>!e||!Boolean(e.trim()),U=(e,t)=>{switch(t){case j.e.fs:return e.links.snapshotRestore.registerSharedFileSystem;case j.e.url:return`${e.links.snapshotRestore.registerUrl}`;case j.e.source:return`${e.links.snapshotRestore.registerSourceOnly}`;case j.e.s3:return`${e.links.plugins.s3Repo}`;case j.e.hdfs:return`${e.links.plugins.hdfsRepo}`;case j.e.azure:return`${e.links.plugins.azureRepo}`;case j.e.gcs:return`${e.links.plugins.gcsRepo}`;default:return`${e.links.snapshotRestore.guide}`}},$=({repository:e,onNext:t,updateRepository:s,validation:a})=>{const{error:i,isLoading:n,data:l=[]}=Object(o.t)(),{docLinks:c}=y(),d=!a.isValid,g=Object(x.jsx)(p.EuiLink,{href:c.links.plugins.snapshotRestoreRepos,target:"_blank"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.fields.typePluginsDocLinkText",defaultMessage:"Learn more about repository types."}));return Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h2",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.fields.nameDescriptionTitle",defaultMessage:"Repository name"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.fields.nameDescription",defaultMessage:"A unique name for the repository."}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.fields.nameLabel",defaultMessage:"Name"}),isInvalid:Boolean(d&&a.errors.name),error:a.errors.name,fullWidth:!0},Object(x.jsx)(p.EuiFieldText,{defaultValue:e.name,fullWidth:!0,onChange:e=>{s({name:e.target.value})},"data-test-subj":"nameInput"}))),Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h2",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.fields.typeDescriptionTitle",defaultMessage:"Repository type"}))),Object(x.jsx)(p.EuiSpacer,{size:"s"}),Object(x.jsx)(p.EuiText,{id:"repositoryTypeDescription",size:"s",color:"subdued"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.fields.defaultTypeDescription",defaultMessage:"Storage location for your snapshots. {docLink}",values:{docLink:g}})),Object(x.jsx)(p.EuiFormRow,{hasEmptyLabelSpace:!0,describedByIds:["repositoryTypeDescription"],fullWidth:!0,isInvalid:Boolean(d&&a.errors.type),error:a.errors.type},i?Object(x.jsx)(b.h,{title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.loadingRepositoryTypesErrorMessage",defaultMessage:"Error loading repository types"}),error:i}):n?Object(x.jsx)(ce,null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.loadingRepositoryTypesDescription",defaultMessage:"Loading repository types…"})):l.length?Object(x.jsx)(p.EuiFlexGrid,{columns:4},l.map(((t,a)=>((t,a)=>{const o=(e.type===j.e.source?e.settings.delegateType:e.type)===t,i=D.a.getRepositoryTypeName(t);return Object(x.jsx)(p.EuiFlexItem,{key:a},Object(x.jsx)(p.EuiCard,{title:i,icon:Object(x.jsx)(ne,{type:t,size:"l"}),description:Object(x.jsx)(r.Fragment,null),footer:Object(x.jsx)(p.EuiButtonEmpty,{href:U(c,t),target:"_blank",size:"xs",iconType:"iInCircle"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.fields.typeDocsLinkText",defaultMessage:"Learn more"})),selectable:{onClick:()=>{return a=t,void(e.type===j.e.source?s({settings:{delegateType:a}}):s({type:a,settings:{}}));var a},isSelected:o},"data-test-subj":`${t}RepositoryType`}))})(t,a)))):Object(x.jsx)(p.EuiCallOut,{title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.noRepositoryTypesErrorTitle",defaultMessage:"No repository types available"}),color:"warning","data-test-subj":"noRepositoryTypesError"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.noRepositoryTypesErrorMessage",defaultMessage:"You can install plugins to enable different repository types. {docLink}",values:{docLink:g}}))),Object(x.jsx)(p.EuiSpacer,{size:"m"})),Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h2",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.fields.sourceOnlyDescriptionTitle",defaultMessage:"Source-only snapshots"}))),description:Object(x.jsx)(r.Fragment,null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.fields.sourceOnlyDescription",defaultMessage:"Creates source-only snapshots that take up to 50% less space. {docLink}",values:{docLink:Object(x.jsx)(p.EuiLink,{href:U(c,j.e.source),target:"_blank"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.fields.sourceOnlyDocLinkText",defaultMessage:"Learn more about source-only repositories."}))}})),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{hasEmptyLabelSpace:!0,fullWidth:!0},Object(x.jsx)(p.EuiSwitch,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.fields.sourceOnlyLabel",defaultMessage:"Source-only snapshots"}),checked:e.type===j.e.source,onChange:t=>{if(t.target.checked)s({type:j.e.source,settings:{...e.settings,delegateType:e.type}});else{const{settings:{delegateType:t,...a}}=e;s({type:t||null,settings:a})}},"data-test-subj":"sourceOnlyToggle"}))),d?Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiCallOut,{title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.validationErrorTitle",defaultMessage:"Fix errors before continuing."}),color:"danger","data-test-subj":"repositoryFormError"}),Object(x.jsx)(p.EuiSpacer,{size:"m"})):null,Object(x.jsx)(p.EuiButton,{color:"primary",onClick:t,fill:!0,iconType:"arrowRight",iconSide:"right","data-test-subj":"nextButton"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.nextButtonLabel",defaultMessage:"Next"})))},H=({isInvalid:e,error:t,defaultValue:s,updateSettings:a})=>Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.commonFields.chunkSizeTitle",defaultMessage:"Chunk size"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.commonFields.chunkSizeDescription",defaultMessage:"Breaks files into smaller units when taking snapshots."}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.commonFields.chunkSizeLabel",defaultMessage:"Chunk size"}),fullWidth:!0,isInvalid:e,error:t,helpText:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.commonFields.chunkSizeHelpText",defaultMessage:"Accepts byte size units, such as {example1}, {example2}, {example3}, or {example4}. Defaults to unlimited.",values:{example1:Object(x.jsx)(p.EuiCode,null,"1g"),example2:Object(x.jsx)(p.EuiCode,null,"10mb"),example3:Object(x.jsx)(p.EuiCode,null,"5k"),example4:Object(x.jsx)(p.EuiCode,null,"1024B")}})},Object(x.jsx)(p.EuiFieldText,{defaultValue:s,fullWidth:!0,onChange:e=>a("chunkSize",e.target.value),"data-test-subj":"chunkSizeInput"}))),q=({isInvalid:e,error:t,defaultValue:s,updateSettings:a})=>Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.commonFields.maxRestoreBytesTitle",defaultMessage:"Max restore bytes per second"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.commonFields.maxRestoreBytesDescription",defaultMessage:"Maximum snapshot restore rate for each node."}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.commonFields.maxRestoreBytesLabel",defaultMessage:"Max restore bytes per second"}),fullWidth:!0,isInvalid:e,error:t,helpText:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.commonFields.maxRestoreBytesHelpText",defaultMessage:"Accepts byte size units, such as {example1}, {example2}, {example3}, or {example4}. Defaults to unlimited.",values:{example1:Object(x.jsx)(p.EuiCode,null,"1g"),example2:Object(x.jsx)(p.EuiCode,null,"10mb"),example3:Object(x.jsx)(p.EuiCode,null,"5k"),example4:Object(x.jsx)(p.EuiCode,null,"1024B")}})},Object(x.jsx)(p.EuiFieldText,{defaultValue:s,fullWidth:!0,onChange:e=>a("maxRestoreBytesPerSec",e.target.value),"data-test-subj":"maxRestoreBytesInput"}))),Y=({isInvalid:e,error:t,defaultValue:s,updateSettings:a})=>Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.commonFields.maxSnapshotBytesTitle",defaultMessage:"Max snapshot bytes per second"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.commonFields.maxSnapshotBytesDescription",defaultMessage:"Maximum rate for creating snapshots for each node."}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.commonFields.maxSnapshotBytesLabel",defaultMessage:"Max snapshot bytes per second"}),fullWidth:!0,isInvalid:e,error:t,helpText:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.commonFields.maxSnapshotBytesHelpText",defaultMessage:"Accepts byte size units, such as {example1}, {example2}, {example3}, or {example4}. Defaults to {defaultSize} per second.",values:{example1:Object(x.jsx)(p.EuiCode,null,"1g"),example2:Object(x.jsx)(p.EuiCode,null,"10mb"),example3:Object(x.jsx)(p.EuiCode,null,"5k"),example4:Object(x.jsx)(p.EuiCode,null,"1024B"),defaultSize:Object(x.jsx)(p.EuiCode,null,"40mb")}})},Object(x.jsx)(p.EuiFieldText,{defaultValue:s,fullWidth:!0,onChange:e=>a("maxSnapshotBytesPerSec",e.target.value),"data-test-subj":"maxSnapshotBytesInput"}))),X=({repository:e,updateRepositorySettings:t,settingErrors:s})=>{const{settings:{client:a,container:o,basePath:i,compress:n,chunkSize:l,readonly:c,locationMode:d,maxRestoreBytesPerSec:j,maxSnapshotBytesPerSec:b}}=e,g=Boolean(Object.keys(s).length),m=["primary_only","secondary_only"].map((e=>({value:e,text:e}))),h=(e,s)=>{t({[e]:s})};return Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeAzure.clientTitle",defaultMessage:"Client"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeAzure.clientDescription",defaultMessage:"The name of the Azure client."}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeAzure.clientLabel",defaultMessage:"Client"}),fullWidth:!0,isInvalid:Boolean(g&&s.client),error:s.client},Object(x.jsx)(p.EuiFieldText,{defaultValue:a||"",fullWidth:!0,onChange:e=>{t({client:e.target.value})},"data-test-subj":"clientInput"}))),Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeAzure.containerTitle",defaultMessage:"Container"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeAzure.containerDescription",defaultMessage:"The name of the Azure container to use for snapshots."}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeAzure.containerLabel",defaultMessage:"Container"}),fullWidth:!0,isInvalid:Boolean(g&&s.container),error:s.container},Object(x.jsx)(p.EuiFieldText,{defaultValue:o||"",fullWidth:!0,onChange:e=>{t({container:e.target.value})},"data-test-subj":"containerInput"}))),Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeAzure.basePathTitle",defaultMessage:"Base path"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeAzure.basePathDescription",defaultMessage:"The container path to the repository data."}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeAzure.basePathLabel",defaultMessage:"Base path"}),fullWidth:!0,isInvalid:Boolean(g&&s.basePath),error:s.basePath},Object(x.jsx)(p.EuiFieldText,{defaultValue:i||"",fullWidth:!0,onChange:e=>{t({basePath:e.target.value})},"data-test-subj":"basePathInput"}))),Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeAzure.compressTitle",defaultMessage:"Snapshot compression"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeAzure.compressDescription",defaultMessage:"Compresses the index mapping and setting files for snapshots. Data files are not compressed."}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{hasEmptyLabelSpace:!0,fullWidth:!0,isInvalid:Boolean(g&&s.compress),error:s.compress},Object(x.jsx)(p.EuiSwitch,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeAzure.compressLabel",defaultMessage:"Compress snapshots"}),checked:!(!1===n),onChange:e=>{t({compress:e.target.checked})},"data-test-subj":"compressToggle"}))),Object(x.jsx)(H,{isInvalid:Boolean(g&&s.chunkSize),error:s.chunkSize,defaultValue:l||"",updateSettings:h}),Object(x.jsx)(Y,{isInvalid:Boolean(g&&s.maxSnapshotBytesPerSec),error:s.maxSnapshotBytesPerSec,defaultValue:b||"",updateSettings:h}),Object(x.jsx)(q,{isInvalid:Boolean(g&&s.maxRestoreBytesPerSec),error:s.maxRestoreBytesPerSec,defaultValue:j||"",updateSettings:h}),Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeAzure.locationModeTitle",defaultMessage:"Location mode"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeAzure.locationModeDescription",defaultMessage:"The primary or secondary location. If secondary, read-only is true."}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeAzure.locationModeLabel",defaultMessage:"Location mode"}),fullWidth:!0,isInvalid:Boolean(g&&s.locationMode),error:s.locationMode},Object(x.jsx)(p.EuiSelect,{options:m,value:d||m[0].value,onChange:e=>{t({locationMode:e.target.value,readonly:e.target.value===m[1].value||c})},fullWidth:!0,"data-test-subj":"locationModeSelect"}))),Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeAzure.readonlyTitle",defaultMessage:"Read-only"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeAzure.readonlyDescription",defaultMessage:"Only one cluster should have write access to this repository. All other clusters should be read-only."}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{hasEmptyLabelSpace:!0,fullWidth:!0,isInvalid:Boolean(g&&s.readonly),error:s.readonly},Object(x.jsx)(p.EuiSwitch,{disabled:d===m[1].value,label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeAzure.readonlyLabel",defaultMessage:"Read-only repository"}),checked:!!c,onChange:e=>{t({readonly:d===m[1].value||e.target.checked})},"data-test-subj":"readOnlyToggle"}))))},J=({repository:e,updateRepositorySettings:t,settingErrors:s})=>{const{settings:{location:a,compress:o,chunkSize:i,maxRestoreBytesPerSec:n,maxSnapshotBytesPerSec:l,readonly:c}}=e,d=Boolean(Object.keys(s).length),j=(e,s)=>{t({[e]:s})};return Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeFS.locationTitle",defaultMessage:"File system location"}))),description:Object(x.jsx)(r.Fragment,null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryFor.typeFS.locationDescription",defaultMessage:"The location must be registered in the {settingKey} setting on all master and data nodes.",values:{settingKey:Object(x.jsx)(p.EuiCode,null,"path.repo")}})),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeFS.locationLabel",defaultMessage:"Location (required)"}),fullWidth:!0,isInvalid:Boolean(d&&s.location),error:s.location},Object(x.jsx)(p.EuiFieldText,{defaultValue:a||"",fullWidth:!0,onChange:e=>{t({location:e.target.value})},"data-test-subj":"locationInput"}))),Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeFS.compressTitle",defaultMessage:"Snapshot compression"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeFS.compressDescription",defaultMessage:"Compresses the index mapping and setting files for snapshots. Data files are not compressed."}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{hasEmptyLabelSpace:!0,fullWidth:!0,isInvalid:Boolean(d&&s.compress),error:s.compress},Object(x.jsx)(p.EuiSwitch,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeFS.compressLabel",defaultMessage:"Compress snapshots"}),checked:!!o,onChange:e=>{t({compress:e.target.checked})},"data-test-subj":"compressToggle"}))),Object(x.jsx)(H,{isInvalid:Boolean(d&&s.chunkSize),error:s.chunkSize,defaultValue:i||"",updateSettings:j}),Object(x.jsx)(Y,{isInvalid:Boolean(d&&s.maxSnapshotBytesPerSec),error:s.maxSnapshotBytesPerSec,defaultValue:l||"",updateSettings:j}),Object(x.jsx)(q,{isInvalid:Boolean(d&&s.maxRestoreBytesPerSec),error:s.maxRestoreBytesPerSec,defaultValue:n||"",updateSettings:j}),Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeFS.readonlyTitle",defaultMessage:"Read-only"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeFS.readonlyDescription",defaultMessage:"Only one cluster should have write access to this repository. All other clusters should be read-only."}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{hasEmptyLabelSpace:!0,fullWidth:!0,isInvalid:Boolean(d&&s.readonly),error:s.readonly},Object(x.jsx)(p.EuiSwitch,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeFS.readonlyLabel",defaultMessage:"Read-only repository"}),checked:!!c,onChange:e=>{t({readonly:e.target.checked})},"data-test-subj":"readOnlyToggle"}))))},K=({repository:e,updateRepositorySettings:t,settingErrors:s})=>{const{settings:{bucket:a,client:o,basePath:i,compress:n,chunkSize:l,maxRestoreBytesPerSec:c,maxSnapshotBytesPerSec:d,readonly:j}}=e,b=Boolean(Object.keys(s).length),g=(e,s)=>{t({[e]:s})};return Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeGCS.clientTitle",defaultMessage:"Client"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeGCS.clientDescription",defaultMessage:"The name of the Google Cloud Storage client."}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeGCS.clientLabel",defaultMessage:"Client"}),fullWidth:!0,isInvalid:Boolean(b&&s.client),error:s.client},Object(x.jsx)(p.EuiFieldText,{defaultValue:o||"",fullWidth:!0,onChange:e=>{t({client:e.target.value})},"data-test-subj":"clientInput"}))),Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeGCS.bucketTitle",defaultMessage:"Bucket"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeGCS.bucketDescription",defaultMessage:"The name of the Google Cloud Storage bucket to use for snapshots."}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeGCS.bucketLabel",defaultMessage:"Bucket (required)"}),fullWidth:!0,isInvalid:Boolean(b&&s.bucket),error:s.bucket},Object(x.jsx)(p.EuiFieldText,{defaultValue:a||"",fullWidth:!0,onChange:e=>{t({bucket:e.target.value})},"data-test-subj":"bucketInput"}))),Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeGCS.basePathTitle",defaultMessage:"Base path"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeGCS.basePathDescription",defaultMessage:"The bucket path to the repository data."}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeGCS.basePathLabel",defaultMessage:"Base path"}),fullWidth:!0,isInvalid:Boolean(b&&s.basePath),error:s.basePath},Object(x.jsx)(p.EuiFieldText,{defaultValue:i||"",fullWidth:!0,onChange:e=>{t({basePath:e.target.value})},"data-test-subj":"basePathInput"}))),Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeGCS.compressTitle",defaultMessage:"Compress snapshots"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeGCS.compressDescription",defaultMessage:"Compresses the index mapping and setting files for snapshots. Data files are not compressed."}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{hasEmptyLabelSpace:!0,fullWidth:!0,isInvalid:Boolean(b&&s.compress),error:s.compress},Object(x.jsx)(p.EuiSwitch,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeGCS.compressLabel",defaultMessage:"Compress snapshots"}),checked:!(!1===n),onChange:e=>{t({compress:e.target.checked})},"data-test-subj":"compressToggle"}))),Object(x.jsx)(H,{isInvalid:Boolean(b&&s.chunkSize),error:s.chunkSize,defaultValue:l||"",updateSettings:g}),Object(x.jsx)(Y,{isInvalid:Boolean(b&&s.maxSnapshotBytesPerSec),error:s.maxSnapshotBytesPerSec,defaultValue:d||"",updateSettings:g}),Object(x.jsx)(q,{isInvalid:Boolean(b&&s.maxRestoreBytesPerSec),error:s.maxRestoreBytesPerSec,defaultValue:c||"",updateSettings:g}),Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeGCS.readonlyTitle",defaultMessage:"Read-only"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeGCS.readonlyDescription",defaultMessage:"Only one cluster should have write access to this repository. All other clusters should be read-only."}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{hasEmptyLabelSpace:!0,fullWidth:!0,isInvalid:Boolean(b&&s.readonly),error:s.readonly},Object(x.jsx)(p.EuiSwitch,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeGCS.readonlyLabel",defaultMessage:"Read-only repository"}),checked:!!j,onChange:e=>{t({readonly:e.target.checked})},"data-test-subj":"readOnlyToggle"}))))},Z=({repository:e,updateRepositorySettings:t,settingErrors:s})=>{const{name:o,settings:{delegateType:i,uri:n,path:l,loadDefaults:c,compress:d,chunkSize:j,maxRestoreBytesPerSec:g,maxSnapshotBytesPerSec:m,readonly:h,"security.principal":O,...y}}=e,f=Boolean(Object.keys(s).length),M=(e,s)=>{t({[e]:s})},[F,E]=Object(r.useState)(JSON.stringify(y,null,2)),[R,S]=Object(r.useState)(!1);return Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeHDFS.uriTitle",defaultMessage:"URI"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeHDFS.uriDescription",defaultMessage:"The URI address for HDFS."}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeHDFS.uriLabel",defaultMessage:"URI (required)"}),fullWidth:!0,isInvalid:Boolean(f&&s.uri),error:s.uri},Object(x.jsx)(p.EuiFieldText,{prepend:Object(x.jsx)(p.EuiText,{size:"s",id:"hdfsRepositoryUriProtocolDescription"},"hdfs://"),defaultValue:n?n.split("hdfs://")[1]:"",fullWidth:!0,onChange:e=>{t({uri:e.target.value?`hdfs://${e.target.value}`:""})},"aria-describedby":"hdfsRepositoryUriProtocolDescription","data-test-subj":"uriInput"}))),Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeHDFS.pathTitle",defaultMessage:"Path"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeHDFS.pathDescription",defaultMessage:"The file path where data is stored."}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeHDFS.pathLabel",defaultMessage:"Path (required)"}),fullWidth:!0,isInvalid:Boolean(f&&s.path),error:s.path},Object(x.jsx)(p.EuiFieldText,{defaultValue:l||"",fullWidth:!0,onChange:e=>{t({path:e.target.value})},"data-test-subj":"pathInput"}))),Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeHDFS.loadDefaultsTitle",defaultMessage:"Load defaults"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeHDFS.loadDefaultsDescription",defaultMessage:"Loads the default Hadoop configuration."}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{hasEmptyLabelSpace:!0,fullWidth:!0,isInvalid:Boolean(f&&s.loadDefaults),error:s.loadDefaults},Object(x.jsx)(p.EuiSwitch,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeHDFS.loadDefaultsLabel",defaultMessage:"Load defaults"}),checked:!(!1===c),onChange:e=>{t({loadDefaults:e.target.checked})},"data-test-subj":"loadDefaultsToggle"}))),Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeHDFS.compressTitle",defaultMessage:"Snapshot compression"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeHDFS.compressDescription",defaultMessage:"Compresses the index mapping and setting files for snapshots. Data files are not compressed."}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{hasEmptyLabelSpace:!0,fullWidth:!0,isInvalid:Boolean(f&&s.compress),error:s.compress},Object(x.jsx)(p.EuiSwitch,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeHDFS.compressLabel",defaultMessage:"Compress snapshots"}),checked:!(!1===d),onChange:e=>{t({compress:e.target.checked})},"data-test-subj":"compressToggle"}))),Object(x.jsx)(H,{isInvalid:Boolean(f&&s.chunkSize),error:s.chunkSize,defaultValue:j||"",updateSettings:M}),Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeHDFS.securityPrincipalTitle",defaultMessage:"Security principal"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeHDFS.securityPrincipalDescription",defaultMessage:"The Kerberos principal to use when connecting to a secured HDFS cluster."}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeHDFS.securityPrincipalLabel",defaultMessage:"Security principal"}),fullWidth:!0,isInvalid:Boolean(f&&s.securityPrincipal),error:s.securityPrincipal},Object(x.jsx)(p.EuiFieldText,{defaultValue:O||"",fullWidth:!0,onChange:e=>{t({"security.principal":e.target.value})},"data-test-subj":"securityPrincipalInput"}))),Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeHDFS.configurationTitle",defaultMessage:"Configuration"}))),description:Object(x.jsx)(r.Fragment,null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeHDFS.configurationDescription",defaultMessage:"Additional JSON format configuration parameters to add to the Hadoop configuration. Only client-oriented properties from the Hadoop core and HDFS files are recognized."})),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeHDFS.configurationLabel",defaultMessage:"Configuration"}),fullWidth:!0,isInvalid:R,error:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeHDFS.configurationFormatError",defaultMessage:"Invalid JSON format"}),helpText:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeHDFS.configurationKeyDescription",defaultMessage:"Keys should be in the format {confKeyFormat}.",values:{confKeyFormat:Object(x.jsx)(p.EuiCode,null,"conf.<key>")}})},Object(x.jsx)(b.c,{mode:"json",theme:"textmate",width:"100%",value:F,setOptions:{showLineNumbers:!1,tabSize:2,maxLines:1/0},editorProps:{$blockScrolling:1/0},showGutter:!1,minLines:6,"aria-label":a.i18n.translate("xpack.snapshotRestore.repositoryForm.typeHDFS.configurationAriaLabel",{defaultMessage:"Additional configuration for HDFS repository '{name}'",values:{name:o}}),onChange:e=>{E(e);try{const s=JSON.parse(e);S(!1),t({delegateType:i,uri:n,path:l,loadDefaults:c,compress:d,chunkSize:j,"security.principal":O,...s},!0)}catch(e){S(!0)}},"data-test-subj":"codeEditor"}))),Object(x.jsx)(Y,{isInvalid:Boolean(f&&s.maxSnapshotBytesPerSec),error:s.maxSnapshotBytesPerSec,defaultValue:m||"",updateSettings:M}),Object(x.jsx)(q,{isInvalid:Boolean(f&&s.maxRestoreBytesPerSec),error:s.maxRestoreBytesPerSec,defaultValue:g||"",updateSettings:M}),Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeHDFS.readonlyTitle",defaultMessage:"Read-only"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeHDFS.readonlyDescription",defaultMessage:"Only one cluster should have write access to this repository. All other clusters should be read-only."}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{hasEmptyLabelSpace:!0,fullWidth:!0,isInvalid:Boolean(f&&s.readonly),error:s.readonly},Object(x.jsx)(p.EuiSwitch,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeHDFS.readonlyLabel",defaultMessage:"Read-only repository"}),checked:!!h,onChange:e=>{t({readonly:e.target.checked})},"data-test-subj":"readOnlyToggle"}))))},Q=({repository:e,updateRepositorySettings:t,settingErrors:s})=>{const{settings:{url:a}}=e,o=Boolean(Object.keys(s).length),[i,n]=Object(r.useState)(a?a.split("://")[0]:"http");return Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeReadonly.urlTitle",defaultMessage:"URL"}))),description:Object(x.jsx)(r.Fragment,null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeReadonly.urlDescription",defaultMessage:"The location of the snapshots."})),fullWidth:!0},Object(x.jsx)("div",null,Object(x.jsx)(p.EuiFlexGroup,{gutterSize:"s"},Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiFormRow,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeReadonly.urlSchemeLabel",defaultMessage:"Scheme"}),fullWidth:!0},Object(x.jsx)(p.EuiSelect,{options:[{value:"http",text:"http://"},{value:"https",text:"https://"},{value:"ftp",text:"ftp://"},{value:"file",text:"file://"}],value:i,onChange:e=>n(e.target.value),"aria-controls":"readonlyRepositoryUrlHelp","data-test-subj":"schemeSelect"}))),Object(x.jsx)(p.EuiFlexItem,null,Object(x.jsx)(p.EuiFormRow,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeReadonly.urlLabel",defaultMessage:"Path (required)"}),fullWidth:!0,describedByIds:["readonlyRepositoryUrlHelp"],isInvalid:Boolean(o&&s.url),error:s.url},Object(x.jsx)(p.EuiFieldText,{defaultValue:a?a.split("://")[1]:"",fullWidth:!0,onChange:e=>{t({url:`${i}://${e.target.value}`})},"data-test-subj":"urlInput"})))),Object(x.jsx)(p.EuiFormHelpText,{id:"readonlyRepositoryUrlHelp","aria-live":"polite"},function(e){switch(e){case"http":case"https":case"ftp":return Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeReadonly.urlAllowedDescription",defaultMessage:"This URL must be registered in the {settingKey} setting.",values:{settingKey:Object(x.jsx)(p.EuiCode,null,"repositories.url.allowed_urls")}});case"file":return Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeReadonly.urlFilePathDescription",defaultMessage:"This file location must be registered in the {settingKey} setting.",values:{settingKey:Object(x.jsx)(p.EuiCode,null,"path.repo")}});default:return null}}(i)))))},ee=({repository:e,updateRepositorySettings:t,settingErrors:s})=>{const{settings:{bucket:a,client:o,basePath:i,compress:n,chunkSize:l,serverSideEncryption:c,bufferSize:d,cannedAcl:j,storageClass:b,maxRestoreBytesPerSec:g,maxSnapshotBytesPerSec:m,readonly:h}}=e,O=["private","public-read","public-read-write","authenticated-read","log-delivery-write","bucket-owner-read","bucket-owner-full-control"].map((e=>({value:e,text:e}))),y=Boolean(Object.keys(s).length),f=(e,s)=>{t({[e]:s})},M=["standard","reduced_redundancy","standard_ia"].map((e=>({value:e,text:e})));return Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeS3.clientTitle",defaultMessage:"Client"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeS3.clientDescription",defaultMessage:"The name of the AWS S3 client."}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeS3.clientLabel",defaultMessage:"Client"}),fullWidth:!0,isInvalid:Boolean(y&&s.client),error:s.client},Object(x.jsx)(p.EuiFieldText,{defaultValue:o||"",fullWidth:!0,onChange:e=>{t({client:e.target.value})},"data-test-subj":"clientInput"}))),Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeS3.bucketTitle",defaultMessage:"Bucket"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeS3.bucketDescription",defaultMessage:"The name of the AWS S3 bucket to use for snapshots."}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeS3.bucketLabel",defaultMessage:"Bucket (required)"}),fullWidth:!0,isInvalid:Boolean(y&&s.bucket),error:s.bucket},Object(x.jsx)(p.EuiFieldText,{defaultValue:a||"",fullWidth:!0,onChange:e=>{t({bucket:e.target.value})},"data-test-subj":"bucketInput"}))),Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeS3.basePathTitle",defaultMessage:"Base path"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeS3.basePathDescription",defaultMessage:"The bucket path to the repository data."}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeS3.basePathLabel",defaultMessage:"Base path"}),fullWidth:!0,isInvalid:Boolean(y&&s.basePath),error:s.basePath},Object(x.jsx)(p.EuiFieldText,{defaultValue:i||"",fullWidth:!0,onChange:e=>{t({basePath:e.target.value})},"data-test-subj":"basePathInput"}))),Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeS3.compressTitle",defaultMessage:"Snapshot compression"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeS3.compressDescription",defaultMessage:"Compresses the index mapping and setting files for snapshots. Data files are not compressed."}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{hasEmptyLabelSpace:!0,fullWidth:!0,isInvalid:Boolean(y&&s.compress),error:s.compress},Object(x.jsx)(p.EuiSwitch,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeS3.compressLabel",defaultMessage:"Compress snapshots"}),checked:!(!1===n),onChange:e=>{t({compress:e.target.checked})},"data-test-subj":"compressToggle"}))),Object(x.jsx)(H,{isInvalid:Boolean(y&&s.chunkSize),error:s.chunkSize,defaultValue:l||"",updateSettings:f}),Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeS3.serverSideEncryptionTitle",defaultMessage:"Server-side encryption"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeS3.serverSideEncryptionDescription",defaultMessage:"Encrypts files on the server using AES256 algorithm."}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{hasEmptyLabelSpace:!0,fullWidth:!0,isInvalid:Boolean(y&&s.serverSideEncryption),error:s.serverSideEncryption},Object(x.jsx)(p.EuiSwitch,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeS3.serverSideEncryptionLabel",defaultMessage:"Server-side encryption"}),checked:!!c,onChange:e=>{t({serverSideEncryption:e.target.checked})},"data-test-subj":"serverSideEncryptionToggle"}))),Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeS3.bufferSizeTitle",defaultMessage:"Buffer size"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeS3.bufferSizeDescription",defaultMessage:"Beyond this minimum threshold, the S3 repository will use the AWS Multipart Upload API to split the chunk into several parts and upload each in its own request."}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeS3.bufferSizeLabel",defaultMessage:"Buffer size"}),fullWidth:!0,isInvalid:Boolean(y&&s.bufferSize),error:s.bufferSize,helpText:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeS3.bufferSizeHelpText",defaultMessage:"Accepts byte size units, such as {example1}, {example2}, {example3}, or {example4}. Defaults to {defaultSize} or {defaultPercentage} of JVM heap, whichever is smaller.",values:{example1:Object(x.jsx)(p.EuiCode,null,"1g"),example2:Object(x.jsx)(p.EuiCode,null,"10mb"),example3:Object(x.jsx)(p.EuiCode,null,"5k"),example4:Object(x.jsx)(p.EuiCode,null,"1024B"),defaultSize:Object(x.jsx)(p.EuiCode,null,"100mb"),defaultPercentage:Object(x.jsx)(p.EuiCode,null,"5%")}})},Object(x.jsx)(p.EuiFieldText,{defaultValue:d||"",fullWidth:!0,onChange:e=>{t({bufferSize:e.target.value})},"data-test-subj":"bufferSizeInput"}))),Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeS3.cannedAclTitle",defaultMessage:"Canned ACL"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeS3.cannedAclDescription",defaultMessage:"The canned ACL to add to new S3 buckets and objects."}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeS3.cannedAclLabel",defaultMessage:"Canned ACL"}),fullWidth:!0,isInvalid:Boolean(y&&s.cannedAcl),error:s.cannedAcl},Object(x.jsx)(p.EuiSelect,{options:O,value:j||O[0].value,onChange:e=>{t({cannedAcl:e.target.value})},fullWidth:!0,"data-test-subj":"cannedAclSelect"}))),Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeS3.storageClassTitle",defaultMessage:"Storage class"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeS3.storageClassDescription",defaultMessage:"The storage class for new objects in the S3 repository."}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeS3.storageClassLabel",defaultMessage:"Storage class"}),fullWidth:!0,isInvalid:Boolean(y&&s.storageClass),error:s.storageClass},Object(x.jsx)(p.EuiSelect,{options:M,value:b||M[0].value,onChange:e=>{t({storageClass:e.target.value})},fullWidth:!0,"data-test-subj":"storageClassSelect"}))),Object(x.jsx)(Y,{isInvalid:Boolean(y&&s.maxSnapshotBytesPerSec),error:s.maxSnapshotBytesPerSec,defaultValue:m||"",updateSettings:f}),Object(x.jsx)(q,{isInvalid:Boolean(y&&s.maxRestoreBytesPerSec),error:s.maxRestoreBytesPerSec,defaultValue:g||"",updateSettings:f}),Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeS3.readonlyTitle",defaultMessage:"Read-only"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeS3.readonlyDescription",defaultMessage:"Only one cluster should have write access to this repository. All other clusters should be read-only."}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{hasEmptyLabelSpace:!0,fullWidth:!0,isInvalid:Boolean(y&&s.readonly),error:s.readonly},Object(x.jsx)(p.EuiSwitch,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.typeS3.readonlyLabel",defaultMessage:"Read-only repository"}),checked:!!h,onChange:e=>{t({readonly:e.target.checked})},"data-test-subj":"readOnlyToggle"}))))},te=({repository:e,updateRepository:t,settingErrors:s})=>{const{i18n:a}=O(),{type:o,settings:i}=e,r=(e,s)=>{t(s?{settings:e}:{settings:{...i,...e}})},n={[j.e.fs]:J,[j.e.url]:Q,[j.e.azure]:X,[j.e.gcs]:K,[j.e.hdfs]:Z,[j.e.s3]:ee},l=t=>{if(!t)return null;const o=n[t];return o?Object(x.jsx)(o,{repository:e,updateRepositorySettings:r,settingErrors:s}):Object(x.jsx)(b.h,{title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.errorUnknownRepositoryTypesTitle",defaultMessage:"Unknown repository type"}),error:{error:a.translate("xpack.snapshotRestore.repositoryForm.errorUnknownRepositoryTypesMessage",{defaultMessage:"The repository type '{type}' is not supported.",values:{type:t}})}})};return o===j.e.source?l(i.delegateType):l(o)},se=({repository:e,isManagedRepository:t,isEditing:s,isSaving:a,onSave:o,updateRepository:i,validation:n,saveError:l,onBack:c})=>{const{docLinks:d}=y(),j=!n.isValid,{name:b,type:g,settings:{delegateType:m}}=e,h=g===L.g.source?m:g;return Object(x.jsx)("div",{"data-test-subj":"stepTwo"},Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween"},Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiTitle,{size:"m"},Object(x.jsx)("h2",{"data-test-subj":"title"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.fields.settingsTitle",defaultMessage:"{repositoryName} settings",values:{repositoryName:`'${b}'`}})))),Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiButtonEmpty,{size:"s",flush:"right",href:U(d,h),target:"_blank",iconType:"help"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.repositoryTypeDocLink",defaultMessage:"{repositoryType} repository docs",values:{repositoryType:D.a.getRepositoryTypeName(h)}})))),Object(x.jsx)(p.EuiSpacer,{size:"l"}),Object(x.jsx)(te,{repository:e,updateRepository:i,settingErrors:j&&n.errors.settings?n.errors.settings:{}})),j?Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiCallOut,{title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.validationErrorTitle",defaultMessage:"Fix errors before continuing."}),color:"danger",iconType:"cross","data-test-subj":"repositoryFormError"}),Object(x.jsx)(p.EuiSpacer,{size:"m"})):null,l?Object(x.jsx)(r.Fragment,null,l,Object(x.jsx)(p.EuiSpacer,{size:"m"})):null,(()=>{const e=s?Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.saveButtonLabel",defaultMessage:"Save"}):Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.registerButtonLabel",defaultMessage:"Register"}),i=Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.savingButtonLabel",defaultMessage:"Saving…"});return Object(x.jsx)(p.EuiFlexGroup,{gutterSize:"m",alignItems:"center"},s?null:Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiButtonEmpty,{color:"primary",iconType:"arrowLeft",onClick:c,"data-test-subj":"backButton"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryForm.backButtonLabel",defaultMessage:"Back"}))),Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiButton,{color:t?"warning":"success",iconType:"check",onClick:o,fill:!t,"data-test-subj":"submitButton",isLoading:a},a?i:e)))})())},ae=({repository:e,isManagedRepository:t,isEditing:s,isSaving:a,saveError:o,clearSaveError:i,onSave:n})=>{const[l,c]=Object(r.useState)(s?2:1),[u,d]=Object(r.useState)({...e,settings:{...e.settings}}),[j,b]=Object(r.useState)({isValid:!0,errors:{}}),g=e=>{const t={...u,...e};d(t)},m=!j.isValid,h=Object.entries(S(j.errors)).reduce(((e,[t,s])=>[...e,s]),[]);return Object(x.jsx)(p.EuiForm,{isInvalid:m,error:h,"data-test-subj":"repositoryForm"},1!==l||s?Object(x.jsx)(se,{repository:u,isManagedRepository:t,isEditing:s,isSaving:a,onSave:()=>{const e=w(u,!0),{isValid:t}=e;b(e),t&&n(u)},updateRepository:g,validation:j,saveError:o,onBack:()=>{s||(b({isValid:!0,errors:{}}),c(1),i())}}):Object(x.jsx)($,{repository:u,onNext:()=>(()=>{const e=w(u,!1),{isValid:t}=e;b(e),t&&c(2)})(),updateRepository:g,validation:j}))};ae.defaultProps={isEditing:!1,isSaving:!1};const oe=({verificationResults:e})=>e?e.valid?Object(x.jsx)(p.EuiHealth,{color:"success"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryVerification.verificationSuccessfulValue",defaultMessage:"Connected"})):Object(x.jsx)(p.EuiHealth,{color:"warning"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryVerification.verificationErrorValue",defaultMessage:"Not connected"})):Object(x.jsx)(p.EuiHealth,{color:"subdued"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryVerification.verificationUnknownValue",defaultMessage:"Unknown"}));var ie=s(36),re=s.n(ie);const ne=({type:e,...t})=>{const s={[L.g.fs]:"storage",[L.g.url]:"eye",[L.g.azure]:"logoAzure",[L.g.gcs]:"logoGCP",[L.g.hdfs]:"logoApache",[L.g.s3]:"logoAWS"};return Object(x.jsx)(p.EuiIcon,re()({type:s[e]||"folderOpen"},t))},le=({children:e,...t})=>Object(x.jsx)(p.EuiFlexGroup,{justifyContent:"flexStart",alignItems:"center",gutterSize:"s"},Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiLoadingSpinner,{size:"m"})),Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiText,t,Object(x.jsx)(p.EuiTextColor,{color:"subdued"},e)))),ce=({children:e})=>Object(x.jsx)(p.EuiEmptyPrompt,{title:Object(x.jsx)(p.EuiLoadingSpinner,{size:"xl"}),body:Object(x.jsx)(p.EuiText,{color:"subdued"},e),"data-test-subj":"sectionLoading"}),pe=({children:e})=>Object(x.jsx)(p.EuiPageContent_Deprecated,{verticalPosition:"center",horizontalPosition:"center",color:"subdued"},Object(x.jsx)(p.EuiEmptyPrompt,{title:Object(x.jsx)(p.EuiLoadingSpinner,{size:"xl"}),body:Object(x.jsx)(p.EuiText,{color:"subdued"},e),"data-test-subj":"sectionLoading"})),ue=({children:e})=>{const{i18n:t}=O(),s=M(),[a,i]=Object(r.useState)([]),[n,l]=Object(r.useState)(!1),[c,d]=Object(r.useState)(!1),j=Object(r.useRef)(null),b=()=>{l(!1),i([])},g=()=>{const e=[...a];d(!0),Object(o.f)(e).then((({data:a,error:o})=>{const{itemsDeleted:i,errors:r}=a||{itemsDeleted:void 0,errors:void 0};if(b(),d(!1),i&&i.length){const e=i.length>1?t.translate("xpack.snapshotRestore.deleteSnapshot.successMultipleNotificationTitle",{defaultMessage:"Deleted {count} snapshots",values:{count:i.length}}):t.translate("xpack.snapshotRestore.deleteSnapshot.successSingleNotificationTitle",{defaultMessage:"Deleted snapshot '{name}'",values:{name:i[0].snapshot}});s.addSuccess(e),j.current&&j.current([...i])}if(o||r&&r.length){const a=r&&r.length>1||o&&e.length>1?t.translate("xpack.snapshotRestore.deleteSnapshot.errorMultipleNotificationTitle",{defaultMessage:"Error deleting {count} snapshots",values:{count:r&&r.length||e.length}}):t.translate("xpack.snapshotRestore.deleteSnapshot.errorSingleNotificationTitle",{defaultMessage:"Error deleting snapshot '{name}'",values:{name:r&&r[0].id.snapshot||e[0].snapshot}});s.addDanger(a)}}))};return Object(x.jsx)(r.Fragment,null,e(((e,t=(()=>{}))=>{if(!e||!e.length)throw new Error("No snapshot IDs specified for deletion");l(!0),i(e),j.current=t})),(()=>{if(!n)return null;const e=1===a.length;return Object(x.jsx)(p.EuiConfirmModal,{title:e?Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.deleteSnapshot.confirmModal.deleteSingleTitle",defaultMessage:"Delete snapshot '{name}'?",values:{name:a[0].snapshot}}):Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.deleteSnapshot.confirmModal.deleteMultipleTitle",defaultMessage:"Delete {count} snapshots?",values:{count:a.length}}),onCancel:b,onConfirm:g,cancelButtonText:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.deleteSnapshot.confirmModal.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.deleteSnapshot.confirmModal.confirmButtonLabel",defaultMessage:"Delete {count, plural, one {snapshot} other {snapshots}}",values:{count:a.length}}),confirmButtonDisabled:c,buttonColor:"danger","data-test-subj":"srdeleteSnapshotConfirmationModal"},e?null:Object(x.jsx)(r.Fragment,null,Object(x.jsx)("p",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.deleteSnapshot.confirmModal.deleteMultipleListDescription",defaultMessage:"You are about to delete these snapshots:"})),Object(x.jsx)("ul",null,a.map((({snapshot:e,repository:t})=>Object(x.jsx)("li",{key:`${t}/${e}`},e))))),Object(x.jsx)("p",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.deleteSnapshot.confirmModal.deleteMultipleDescription",defaultMessage:"Restore operations associated with {count, plural, one {this snapshot} other {these snapshots}} will stop.",values:{count:a.length}})),!e&&c?Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiCallOut,{color:"warning",title:Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiLoadingSpinner,null)),Object(x.jsx)(p.EuiFlexItem,null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.deleteSnapshot.confirmModal.deletingCalloutTitle",defaultMessage:"Deleting snapshots"}))))},Object(x.jsx)("p",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.deleteSnapshot.confirmModal.deletingCalloutDescription",defaultMessage:"This may take a few minutes."})))):null)})())};var de=s(40),je=s.n(de);const be=({dataStreams:e,indices:t})=>e.concat(t),xe=()=>Object(x.jsx)(p.EuiBadge,{"data-test-subj":"dataStreamBadge",color:"primary"},a.i18n.translate("xpack.snapshotRestore.policyForm.setSettings.dataStreamBadgeContent",{defaultMessage:"Data stream"})),ge=e=>a.i18n.translate("xpack.snapshotRestore.restoreForm.dataStreamsWarningCallOut.title",{defaultMessage:"This snapshot contains {count, plural, one {a data stream} other {data streams}}",values:{count:e}}),me=e=>Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.dataStreamsWarningCallOut.body",defaultMessage:"Each data stream requires a matching index template. Please ensure any restored data streams have a matching index template. You can restore index templates by restoring the global cluster state. However, this may overwrite existing templates, cluster settings, ingest pipelines, and lifecycle policies. {learnMoreLink} about restoring snapshots that contain data streams.",values:{learnMoreLink:Object(x.jsx)(p.EuiLink,{target:"_blank",href:e},a.i18n.translate("xpack.snapshotRestore.restoreForm.dataStreamsWarningCallOut.body.learnMoreLink",{defaultMessage:"Learn more"}))}}),he=({dataStreamsCount:e})=>{const{docLinks:t}=y();return Object(x.jsx)(p.EuiCallOut,{"data-test-subj":"dataStreamWarningCallOut",title:ge(e),iconType:"alert",color:"warning"},me(t.links.snapshotRestore.createSnapshot))},Oe=({onSelectionChange:e,selectedIndicesAndDataStreams:t,indices:s,dataStreams:a})=>{if(0===t.length)return Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepLogistics.noDataStreamsOrIndicesHelpText",defaultMessage:"Nothing will be restored. {selectAllLink}",values:{selectAllLink:Object(x.jsx)(p.EuiLink,{onClick:()=>{e("all")}},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepLogistics.selectAllIndicesLink",defaultMessage:"Select all"}))}});const o=t.reduce(((e,t)=>s.includes(t)?e+1:e),0),i=t.reduce(((e,t)=>a.includes(t)?e+1:e),0);return Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepLogistics.selectDataStreamsAndIndicesHelpText",defaultMessage:"{indicesCount} {indicesCount, plural, one {index} other {indices}} and {dataStreamsCount} {dataStreamsCount, plural, one {data stream} other {data streams}} will be restored. {deselectAllLink}",values:{dataStreamsCount:i,indicesCount:o,deselectAllLink:Object(x.jsx)(p.EuiLink,{"data-test-subj":"deselectIndicesLink",onClick:()=>{e("none")}},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepLogistics.deselectAllIndicesLink",defaultMessage:"Deselect all"}))}})},ye=({featureStates:e})=>Object(x.jsx)(p.EuiCallOut,{"data-test-subj":"systemIndicesInfoCallOut",title:a.i18n.translate("xpack.snapshotRestore.restoreForm.stepLogistics.systemIndicesCallOut.title",{defaultMessage:"When this snapshot is restored, system indices {featuresCount, plural, =0 {} other {from {features}}} will be overwritten with data from the snapshot.",values:{featuresCount:(null==e?void 0:e.length)||0,features:null==e?void 0:e.join(", ")}}),iconType:"pin",size:"s","aria-live":"polite","aria-atomic":"true"}),fe=({isLoadingFeatures:e=!1,featuresOptions:t,selectedOptions:s,onUpdateFormSettings:a})=>{const{i18n:o}=O(),i=Object(r.useMemo)((()=>{if(!e){const e=t.map((e=>({label:e})));return Object(k.sortBy)(e,"label")}return[]}),[e,t]);return Object(x.jsx)(p.EuiFormRow,null,Object(x.jsx)(p.EuiComboBox,{"data-test-subj":"featureStatesDropdown",placeholder:o.translate("xpack.snapshotRestore.featureStatesFormField.allFeaturesLabel",{defaultMessage:"All features"}),options:i,selectedOptions:s,onChange:e=>{a({featureStates:e.map((e=>e.label))})},isLoading:e,isClearable:!0}))},Me=({snapshotDetails:e,restoreSettings:t,updateRestoreSettings:s,errors:a})=>{var o;const{i18n:i}=O(),{docLinks:l}=y(),{indices:c,dataStreams:d=[],includeGlobalState:j,version:b,featureStates:g}=e,m=c.filter((e=>!e.startsWith(".ds"))),h=m.concat(d),f=be({dataStreams:d.map((e=>({label:e,value:{isDataStream:!0,name:e}}))),indices:m.map((e=>({label:e,value:{isDataStream:!1,name:e}})))}),{indices:M,renamePattern:F,renameReplacement:E,partial:R,includeGlobalState:S,featureStates:k,includeAliases:v}=t,[D,I]=Object(r.useState)(!Boolean(M)),[C,w]=Object(r.useState)((()=>be({dataStreams:d.map((e=>({label:e,append:Object(x.jsx)(xe,null),checked:D||"string"==typeof M||Array.isArray(M)&&M.includes(e)?"on":void 0}))),indices:m.map((e=>({label:e,checked:D||"string"==typeof M||Array.isArray(M)&&M.includes(e)?"on":void 0})))}))),[B,P]=Object(r.useState)("string"==typeof M||h.length>100?"custom":"list"),[A,N]=Object(r.useState)("string"==typeof M?M.split(","):[]),[z,G]=Object(r.useState)(Boolean(F||E)),[_,W]=Object(r.useState)({indices:[...h],renamePattern:"",renameReplacement:""}),V=Object(r.useMemo)((()=>null==k?void 0:k.map((e=>({label:e})))),[k]),U=void 0!==k&&!(null!=k&&k.includes(L.e));return Object(x.jsx)("div",{"data-test-subj":"snapshotRestoreStepLogistics",className:"snapshotRestore__restoreForm__stepLogistics"},Object(x.jsx)(p.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiTitle,null,Object(x.jsx)("h2",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepLogisticsTitle",defaultMessage:"Restore details"})))),Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiButtonEmpty,{size:"s",flush:"right",href:l.links.snapshotRestore.restoreSnapshot,target:"_blank",iconType:"help"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepLogistics.docsButtonLabel",defaultMessage:"Snapshot and Restore docs"})))),d.length?Object(x.jsx)(n.a.Fragment,null,Object(x.jsx)(p.EuiSpacer,{size:"m"}),Object(x.jsx)(he,{dataStreamsCount:d.length})):void 0,Object(x.jsx)(p.EuiSpacer,{size:"l"}),Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepLogistics.dataStreamsAndIndicesTitle",defaultMessage:"Data streams and indices"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepLogistics.dataStreamsAndIndicesDescription",defaultMessage:"Creates new data streams and indices if they don’t exist. Opens existing indices, including backing indices for a data stream, if they are closed and have the same number of shards as the snapshot index."}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{hasEmptyLabelSpace:!0,fullWidth:!0},Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiSwitch,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepLogistics.allDataStreamsAndIndicesLabel",defaultMessage:"All data streams and indices"}),checked:D,onChange:e=>{const t=e.target.checked;I(t),s(t?{indices:void 0}:{indices:"custom"===B?A.join(","):[..._.indices||[]]})}}),D?null:Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiSpacer,{size:"m"}),Object(x.jsx)(p.EuiFormRow,{className:"snapshotRestore__restoreForm__stepLogistics__indicesFieldWrapper",label:"list"===B?Object(x.jsx)(p.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepLogistics.selectDataStreamsAndIndicesLabel",defaultMessage:"Select data streams and indices"})),Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiLink,{onClick:()=>{P("custom"),s({indices:A.join(",")})}},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepLogistics.indicesToggleCustomLink",defaultMessage:"Use index patterns"})))):Object(x.jsx)(p.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepLogistics.indicesPatternLabel",defaultMessage:"Index patterns"})),Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiLink,{onClick:()=>{P("list"),s({indices:_.indices})}},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepLogistics.dataStreamsAndIndicesToggleListLink",defaultMessage:"Select data streams and indices"})))),helpText:"list"===B?Object(x.jsx)(Oe,{onSelectionChange:e=>{"all"===e?(C.forEach((e=>{e.checked="on"})),s({indices:[...h]}),W({..._,indices:[...h]})):(C.forEach((e=>{e.checked=void 0})),s({indices:[]}),W({..._,indices:[]}))},selectedIndicesAndDataStreams:null!==(o=T(M))&&void 0!==o?o:[],indices:m,dataStreams:d}):null,isInvalid:Boolean(a.indices),error:a.indices},"list"===B?Object(x.jsx)(p.EuiSelectable,{allowExclusions:!1,options:C,onChange:e=>{const t=[];e.forEach((({label:e,checked:s})=>{"on"===s&&t.push(e)})),w(e),s({indices:[...t]}),W({..._,indices:[...t]})},searchable:!0,height:300},((e,t)=>Object(x.jsx)(p.EuiPanel,{paddingSize:"s",hasShadow:!1},t,e))):Object(x.jsx)(p.EuiComboBox,{options:f,renderOption:({value:e})=>null!=e&&e.isDataStream?Object(x.jsx)(p.EuiFlexGroup,{responsive:!1,justifyContent:"spaceBetween",alignItems:"center",gutterSize:"none"},Object(x.jsx)(p.EuiFlexItem,null,e.name),Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(xe,null))):null==e?void 0:e.name,placeholder:i.translate("xpack.snapshotRestore.restoreForm.stepLogistics.indicesPatternPlaceholder",{defaultMessage:"Enter index patterns, i.e. logstash-*"}),selectedOptions:A.map((e=>({label:e}))),onCreateOption:e=>{if(!e.trim().length)return;const t=[...A,e];N(t),s({indices:t.join(",")})},onChange:e=>{const t=e.map((({label:e})=>e));N(t),s({indices:t.join(",")})}})))))),Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepLogistics.renameDataStreamsAndIndicesTitle",defaultMessage:"Rename data streams and indices"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepLogistics.renameDataStreamsAndIndicesDescription",defaultMessage:"Renames data streams and indices on restore. Ensure that a matching index template exists for renamed data streams."}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{hasEmptyLabelSpace:!0,fullWidth:!0},Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiSwitch,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepLogistics.renameDataStreamsAndIndicesLabel",defaultMessage:"Rename data streams and indices"}),checked:z,onChange:e=>{const t=e.target.checked;G(t),s(t?{renamePattern:_.renamePattern,renameReplacement:_.renameReplacement}:{renamePattern:void 0,renameReplacement:void 0})}}),z?Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiSpacer,{size:"m"}),Object(x.jsx)(p.EuiFlexGroup,null,Object(x.jsx)(p.EuiFlexItem,null,Object(x.jsx)(p.EuiFormRow,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepLogistics.renamePatternLabel",defaultMessage:"Capture pattern"}),helpText:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepLogistics.renamePatternHelpText",defaultMessage:"Use regular expressions"}),isInvalid:Boolean(a.renamePattern),error:a.renamePattern},Object(x.jsx)(p.EuiFieldText,{value:F,placeholder:"data_(.+)",onChange:e=>{W({..._,renamePattern:e.target.value}),s({renamePattern:e.target.value})}}))),Object(x.jsx)(p.EuiFlexItem,null,Object(x.jsx)(p.EuiFormRow,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepLogistics.renameReplacementLabel",defaultMessage:"Replacement pattern"}),isInvalid:Boolean(a.renameReplacement),error:a.renameReplacement},Object(x.jsx)(p.EuiFieldText,{value:E,placeholder:"restored_data_$1",onChange:e=>{W({..._,renameReplacement:e.target.value}),s({renameReplacement:e.target.value})}}))))):null))),Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepLogistics.partialTitle",defaultMessage:"Partial restore"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepLogistics.partialDescription",defaultMessage:"Allows restore of indices that don’t have snapshots of all shards."}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{hasEmptyLabelSpace:!0,fullWidth:!0},Object(x.jsx)(p.EuiSwitch,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepLogistics.partialLabel",defaultMessage:"Partial restore"}),checked:void 0!==R&&R,onChange:e=>s({partial:e.target.checked})}))),Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepLogistics.includeGlobalStateTitle",defaultMessage:"Restore global state"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepLogistics.includeGlobalStateDescription",defaultMessage:"Restores the global cluster state as part of the snapshot."}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{hasEmptyLabelSpace:!0,fullWidth:!0,helpText:j?null:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepLogistics.includeGlobalStateDisabledDescription",defaultMessage:"Not available for this snapshot."})},Object(x.jsx)(p.EuiSwitch,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepLogistics.includeGlobalStateLabel",defaultMessage:"Restore global state"}),checked:void 0!==S&&S,onChange:e=>s({includeGlobalState:e.target.checked}),disabled:!j,"data-test-subj":"includeGlobalStateSwitch"}))),Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepLogistics.includeFeatureStatesTitle",defaultMessage:"Restore feature state"}))),description:Object(x.jsx)(n.a.Fragment,null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepLogistics.includeFeatureStatesDescription",defaultMessage:"Restores the configuration, history, and other data stored in Elasticsearch by a feature such as Elasticsearch security."}),je()(b,"7.12.0")&&U&&Object(x.jsx)(n.a.Fragment,null,Object(x.jsx)(p.EuiSpacer,{size:"s"}),Object(x.jsx)(ye,{featureStates:null==t?void 0:t.featureStates}))),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{hasEmptyLabelSpace:!0,fullWidth:!0,helpText:g?null:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepLogistics.includeFeatureStatesDisabledDescription",defaultMessage:"Not available for this snapshot."})},Object(x.jsx)(p.EuiSwitch,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepLogistics.restoreFeatureStatesLabel",defaultMessage:"Restore feature state from"}),checked:U,onChange:e=>{const{checked:t}=e.target;s({featureStates:t?[]:[L.e]})},disabled:0===(null==g?void 0:g.length),"data-test-subj":"includeFeatureStatesSwitch"})),U&&Object(x.jsx)(n.a.Fragment,null,Object(x.jsx)(p.EuiSpacer,{size:"m"}),Object(x.jsx)(fe,{featuresOptions:g,selectedOptions:V,onUpdateFormSettings:s})),0===(null==g?void 0:g.length)&&Object(x.jsx)(n.a.Fragment,null,Object(x.jsx)(p.EuiSpacer,{size:"m"}),Object(x.jsx)(p.EuiCallOut,{size:"s",iconType:"help",color:"warning","data-test-subj":"noFeatureStatesCallout",title:i.translate("xpack.snapshotRestore.restoreForm.stepLogistics.noFeatureStates",{defaultMessage:"No feature states are included in this snapshot."})}))),Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepLogistics.includeAliasesTitle",defaultMessage:"Restore aliases"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepLogistics.includeAliasesDescription",defaultMessage:"Restores index aliases along with their associated indices."}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{hasEmptyLabelSpace:!0,fullWidth:!0},Object(x.jsx)(p.EuiSwitch,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepLogistics.includeAliasesLabel",defaultMessage:"Restore aliases"}),checked:void 0===v||v,onChange:e=>s({includeAliases:e.target.checked}),"data-test-subj":"includeAliasesSwitch"}))))},Fe=({restoreSettings:e,updateRestoreSettings:t,snapshotDetails:s,errors:a})=>{const{i18n:o}=O(),{docLinks:i}=y(),{indexSettings:l,ignoreIndexSettings:c}=e,{dataStreams:d}=s,[j,g]=Object(r.useState)(Boolean(l)),[m,h]=Object(r.useState)(Boolean(c)),[f,M]=Object(r.useState)({indexSettings:l||"{}",ignoreIndexSettings:c?[...c]:[]}),[F,E]=Object(r.useState)([...new Set((c||[]).concat([..._.g].sort()))].map((e=>({label:e})))),R=Object(x.jsx)(p.EuiLink,{href:i.links.elasticsearch.indexModules,target:"_blank"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepSettings.indexSettingsDocLinkText",defaultMessage:"Learn more."}));return Object(x.jsx)("div",{className:"snapshotRestore__restoreForm__stepSettings"},Object(x.jsx)(p.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiTitle,null,Object(x.jsx)("h2",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepSettingsTitle",defaultMessage:"Index settings"})))),Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiButtonEmpty,{size:"s",flush:"right",href:i.links.snapshotRestore.changeIndexSettings,target:"_blank",iconType:"help"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepSettings.docsButtonLabel",defaultMessage:"Index settings docs"})))),null!=d&&d.length?Object(x.jsx)(n.a.Fragment,null,Object(x.jsx)(p.EuiSpacer,{size:"m"}),Object(x.jsx)(p.EuiCallOut,{iconType:"help",title:o.translate("xpack.snapshotRestore.restoreForm.stepSettings.dataStreamsCallout.title",{defaultMessage:"Backing indices"})},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepSettings.dataStreamsCallout.description",defaultMessage:"These settings also apply to the backing indices of data streams."}))):void 0,Object(x.jsx)(p.EuiSpacer,{size:"l"}),Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepSettings.indexSettingsTitle",defaultMessage:"Modify index settings"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepSettings.indexSettingsDescription",defaultMessage:"Overrides index settings during restore. {docLink}",values:{docLink:R}}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{hasEmptyLabelSpace:!0,fullWidth:!0},Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiSwitch,{"data-test-subj":"modifyIndexSettingsSwitch",label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepSettings.indexSettingsLabel",defaultMessage:"Modify index settings"}),checked:j,onChange:e=>{e.target.checked?(g(!0),t({indexSettings:f.indexSettings})):(g(!1),t({indexSettings:void 0}))}}),j?Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiSpacer,{size:"m"}),Object(x.jsx)(p.EuiFormRow,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepSettings.indexSettingsEditorLabel",defaultMessage:"Index settings"}),fullWidth:!0,isInvalid:Boolean(a.indexSettings),error:a.indexSettings,helpText:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepSettings.indexSettingsEditorDescription",defaultMessage:"Use JSON format: {format}",values:{format:Object(x.jsx)(p.EuiCode,null,'{ "index.number_of_replicas": 0 }')}})},Object(x.jsx)(b.c,{mode:"json",theme:"textmate",width:"100%",value:l,setOptions:{showLineNumbers:!1,tabSize:2,maxLines:1/0},editorProps:{$blockScrolling:1/0},showGutter:!1,minLines:6,maxLines:15,"aria-label":o.translate("xpack.snapshotRestore.restoreForm.stepSettings.indexSettingsAriaLabel",{defaultMessage:"Index settings to modify"}),onChange:e=>{t({indexSettings:e}),M({...f,indexSettings:e})}}))):null))),Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepSettings.ignoreIndexSettingsTitle",defaultMessage:"Reset index settings"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepSettings.ignoreIndexSettingsDescription",defaultMessage:"Resets selected settings to default during restore. {docLink}",values:{docLink:R}}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{hasEmptyLabelSpace:!0,fullWidth:!0},Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiSwitch,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepSettings.ignoreIndexSettingsLabel",defaultMessage:"Reset index settings"}),checked:m,onChange:e=>{e.target.checked?(h(!0),t({ignoreIndexSettings:[...f.ignoreIndexSettings||[]]})):(h(!1),t({ignoreIndexSettings:void 0}))}}),m?Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiSpacer,{size:"m"}),Object(x.jsx)(p.EuiFormRow,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepSettings.selectIgnoreIndexSettingsLabel",defaultMessage:"Select settings"}),isInvalid:Boolean(a.ignoreIndexSettings),error:a.ignoreIndexSettings},Object(x.jsx)(p.EuiComboBox,{placeholder:o.translate("xpack.snapshotRestore.restoreForm.stepSettings.ignoreIndexSettingsPlaceholder",{defaultMessage:"Select or type index settings"}),options:F,selectedOptions:c?F.filter((({label:e})=>c.includes(e))):[],onChange:e=>{const s=e.map((({label:e})=>e));t({ignoreIndexSettings:s}),M({...f,ignoreIndexSettings:s})},onCreateOption:(e,s)=>{const a=e.trim().toLowerCase();a&&(!Boolean(s.find((({label:e})=>e===a)))&&E([{label:a},...F]),t({ignoreIndexSettings:[...c||[],a]}),M({...f,ignoreIndexSettings:[...c||[],a]}))},isClearable:!0}))):null))))},Ee=({items:e})=>{var t;const[s,a]=Object(r.useState)(!1),o=null!==(t=T(e))&&void 0!==t?t:[];return{items:void 0===e?"all":o.slice(0,s?1/0:10),hiddenItemsCount:o.length>10?o.length-10:0,setIsShowingFullList:a,isShowingFullList:s}},Re=({indices:e})=>{const{hiddenItemsCount:t,isShowingFullList:s,items:a,setIsShowingFullList:o}=Ee({items:e});return"all"===a?Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.indicesList.allIndicesValue",defaultMessage:"All indices"}):Object(x.jsx)(n.a.Fragment,null,Object(x.jsx)(p.EuiText,null,a.map((e=>Object(x.jsx)("div",{key:e},Object(x.jsx)(p.EuiTitle,{size:"xs"},Object(x.jsx)("span",null,e)))))),t?Object(x.jsx)(n.a.Fragment,null,Object(x.jsx)(p.EuiSpacer,{size:"xs"}),Object(x.jsx)(p.EuiLink,{onClick:()=>o(!s)},s?Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.indicesList.indicesCollapseAllLink",defaultMessage:"Hide {count, plural, one {# index} other {# indices}}",values:{count:t}}):Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.indicesList.indicesExpandAllLink",defaultMessage:"Show {count, plural, one {# index} other {# indices}}",values:{count:t}})," ",Object(x.jsx)(p.EuiIcon,{type:s?"arrowUp":"arrowDown"}))):null)},Se=({dataStreams:e})=>{const{isShowingFullList:t,setIsShowingFullList:s,items:a,hiddenItemsCount:o}=Ee({items:e});return"all"===a?Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.dataStreamsList.allDataStreamsValue",defaultMessage:"All data streams"}):Object(x.jsx)(n.a.Fragment,null,Object(x.jsx)(p.EuiText,null,a.map((e=>Object(x.jsx)("div",{key:e},Object(x.jsx)(p.EuiTitle,{size:"xs"},Object(x.jsx)("span",null,e)))))),o?Object(x.jsx)(n.a.Fragment,null,Object(x.jsx)(p.EuiSpacer,{size:"xs"}),Object(x.jsx)(p.EuiLink,{onClick:()=>s(!t)},t?Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.dataStreamsList.dataStreamsCollapseAllLink",defaultMessage:"Hide {count, plural, one {# data stream} other {# data streams}}",values:{count:o}}):Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.dataStreamsList.dataStreamsExpandAllLink",defaultMessage:"Show {count, plural, one {# data stream} other {# data streams}}",values:{count:o}})," ",Object(x.jsx)(p.EuiIcon,{type:t?"arrowUp":"arrowDown"}))):null)},ke=({featureStates:e})=>{const{isShowingFullList:t,setIsShowingFullList:s,items:a,hiddenItemsCount:o}=Ee({items:e});return"all"===a||0===a.length?Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.featureStatesList.allFeaturesLabel",defaultMessage:"All features"}):a.find((e=>e===L.e))?Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.featureStatesList.noneFeaturesLabel",defaultMessage:"No features"}):Object(x.jsx)(n.a.Fragment,null,Object(x.jsx)(p.EuiText,{"data-test-subj":"featureStatesList"},a.map((e=>Object(x.jsx)("div",{key:e},Object(x.jsx)(p.EuiTitle,{size:"xs"},Object(x.jsx)("span",null,e)))))),o?Object(x.jsx)(n.a.Fragment,null,Object(x.jsx)(p.EuiSpacer,{size:"xs"}),Object(x.jsx)(p.EuiLink,{onClick:()=>s(!t)},t?Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.featureStatesList.featureStatesCollapseAllLink",defaultMessage:"Hide {count, plural, one {# feature} other {# features}}",values:{count:o}}):Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.featureStatesList.featureStatesExpandAllLink",defaultMessage:"Show {count, plural, one {# feature} other {# features}}",values:{count:o}})," ",Object(x.jsx)(p.EuiIcon,{type:t?"arrowUp":"arrowDown"}))):null)},Le=({includeGlobalState:e,featureStates:t})=>{const s=e&&void 0===t,a=!t||(null==t?void 0:t.includes(L.e)),o=s||0===(null==t?void 0:t.length);return Object(x.jsx)(p.EuiFlexItem,{"data-test-subj":"policyFeatureStatesSummary"},Object(x.jsx)(p.EuiDescriptionList,{textStyle:"reverse"},Object(x.jsx)(p.EuiDescriptionListTitle,null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.summary.policyFeatureStatesLabel",defaultMessage:"Include feature state {hasSpecificFeatures, plural, one {from} other {}}",values:{hasSpecificFeatures:a||o?0:1}})),Object(x.jsx)(p.EuiDescriptionListDescription,{"data-test-subj":"value"},!s&&a&&Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.summary.policyNoFeatureStatesLabel",defaultMessage:"No"}),o&&Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.summary.policyAllFeatureStatesLabel",defaultMessage:"All features"}),!a&&!o&&Object(x.jsx)(ke,{featureStates:t}))))},Te=({featureStates:e})=>{const t=!e||0===e.length;return Object(x.jsx)(p.EuiFlexItem,{"data-test-subj":"snapshotFeatureStatesSummary"},Object(x.jsx)(p.EuiDescriptionList,{textStyle:"reverse"},Object(x.jsx)(p.EuiDescriptionListTitle,null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.summary.snapshotFeatureStatesLabel",defaultMessage:"Include feature state {hasSpecificFeatures, plural, one {from} other {}}",values:{hasSpecificFeatures:t?0:1}})),Object(x.jsx)(p.EuiDescriptionListDescription,{"data-test-subj":"value"},t?Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.summary.snapshotNoFeatureStatesLabel",defaultMessage:"No"}):Object(x.jsx)(ke,{featureStates:e}))))},ve=({restoreSettings:e,updateCurrentStep:t})=>{const{i18n:s}=O(),{indices:a,renamePattern:o,renameReplacement:i,partial:n,includeGlobalState:l,featureStates:c,ignoreIndexSettings:d}=e,j=function(e){const{indices:t,renamePattern:s,renameReplacement:a,includeGlobalState:o,featureStates:i,partial:r,indexSettings:n,ignoreIndexSettings:l,ignoreUnavailable:c,includeAliases:p}=e;let u;if(n)try{u=JSON.parse(n)}catch(e){}return d={indices:t,rename_pattern:s,rename_replacement:a,include_global_state:o,feature_states:i,partial:r,index_settings:u,ignore_index_settings:l,ignore_unavailable:c,include_aliases:p},Object.entries(d).reduce(((e,[t,s])=>(void 0!==s&&(e[t]=s),e)),{});var d}(e),{index_settings:g}=j;return Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiTitle,null,Object(x.jsx)("h2",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepReviewTitle",defaultMessage:"Review restore details"}))),Object(x.jsx)(p.EuiSpacer,{size:"m"}),Object(x.jsx)(p.EuiTabbedContent,{tabs:[{id:"summary",name:s.translate("xpack.snapshotRestore.restoreForm.stepReview.summaryTabTitle",{defaultMessage:"Summary"}),content:Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiSpacer,{size:"m"}),Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepReview.summaryTab.sectionLogisticsTitle",defaultMessage:"Logistics"})," ",Object(x.jsx)(p.EuiToolTip,{content:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepReview.summaryTab.editStepTooltip",defaultMessage:"Edit"})},Object(x.jsx)(p.EuiLink,{onClick:()=>t(1)},Object(x.jsx)(p.EuiIcon,{type:"pencil"}))))),Object(x.jsx)(p.EuiSpacer,{size:"s"}),Object(x.jsx)(p.EuiFlexGroup,null,Object(x.jsx)(p.EuiFlexItem,null,Object(x.jsx)(p.EuiDescriptionList,{textStyle:"reverse"},Object(x.jsx)(p.EuiDescriptionListTitle,null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepReview.summaryTab.dataStreamsAndIndicesLabel",defaultMessage:"Data streams and indices"})),Object(x.jsx)(p.EuiDescriptionListDescription,null,Object(x.jsx)(Re,{indices:a}))))),o||i?Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiSpacer,{size:"m"}),Object(x.jsx)(p.EuiTitle,{size:"xs"},Object(x.jsx)("h4",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepReview.summaryTab.sectionRenameTitle",defaultMessage:"Rename indices"}))),Object(x.jsx)(p.EuiSpacer,{size:"s"}),Object(x.jsx)(p.EuiFlexGroup,null,o?Object(x.jsx)(p.EuiFlexItem,null,Object(x.jsx)(p.EuiDescriptionList,{textStyle:"reverse"},Object(x.jsx)(p.EuiDescriptionListTitle,null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepReview.summaryTab.renamePatternLabel",defaultMessage:"Capture pattern"})),Object(x.jsx)(p.EuiDescriptionListDescription,null,o))):null,i?Object(x.jsx)(p.EuiFlexItem,null,Object(x.jsx)(p.EuiDescriptionList,{textStyle:"reverse"},Object(x.jsx)(p.EuiDescriptionListTitle,null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepReview.summaryTab.renameReplacementLabel",defaultMessage:"Replacement pattern"})),Object(x.jsx)(p.EuiDescriptionListDescription,null,i))):null)):null,void 0!==c||void 0!==l?Object(x.jsx)(p.EuiFlexGroup,null,void 0!==l?Object(x.jsx)(p.EuiFlexItem,null,Object(x.jsx)(p.EuiDescriptionList,{textStyle:"reverse"},Object(x.jsx)(p.EuiDescriptionListTitle,null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepReview.summaryTab.includeGlobalStateLabel",defaultMessage:"Restore global state"})),Object(x.jsx)(p.EuiDescriptionListDescription,null,!1===l?Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepReview.summaryTab.includeGlobalStateFalseValue",defaultMessage:"No"}):Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepReview.summaryTab.includeGlobalStateTrueValue",defaultMessage:"Yes"})))):null,void 0!==c?Object(x.jsx)(Le,{featureStates:c}):null):null,void 0!==n?Object(x.jsx)(p.EuiFlexGroup,null,Object(x.jsx)(p.EuiFlexItem,null,Object(x.jsx)(p.EuiDescriptionList,{textStyle:"reverse"},Object(x.jsx)(p.EuiDescriptionListTitle,null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepReview.summaryTab.partialLabel",defaultMessage:"Partial restore"})),Object(x.jsx)(p.EuiDescriptionListDescription,null,n?Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepReview.summaryTab.partialTrueValue",defaultMessage:"Yes"}):Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepReview.summaryTab.partialFalseValue",defaultMessage:"No"}))))):null,Object(x.jsx)(p.EuiSpacer,{size:"m"}),Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepReview.summaryTab.sectionSettingsTitle",defaultMessage:"Index settings"})," ",Object(x.jsx)(p.EuiToolTip,{content:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepReview.summaryTab.editStepTooltip",defaultMessage:"Edit"})},Object(x.jsx)(p.EuiLink,{onClick:()=>t(2)},Object(x.jsx)(p.EuiIcon,{type:"pencil"}))))),Object(x.jsx)(p.EuiSpacer,{size:"s"}),g||d?Object(x.jsx)(p.EuiFlexGroup,null,g?Object(x.jsx)(p.EuiFlexItem,{style:{maxWidth:"50%"}},Object(x.jsx)(p.EuiDescriptionList,{textStyle:"reverse"},Object(x.jsx)(p.EuiDescriptionListTitle,null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepReview.summaryTab.indexSettingsLabel",defaultMessage:"Modify"})),Object(x.jsx)(p.EuiDescriptionListDescription,null,Object(x.jsx)(p.EuiFlexGrid,{columns:2,gutterSize:"none"},Object.entries(g).map((([e,t])=>Object(x.jsx)(r.Fragment,{key:e},Object(x.jsx)(p.EuiFlexItem,null,Object(x.jsx)(p.EuiText,{size:"s"},Object(x.jsx)("strong",null,e))),Object(x.jsx)(p.EuiFlexItem,null,Object(x.jsx)(p.EuiText,{size:"s"},Object(x.jsx)("span",null," ",t)))))))))):null,d?Object(x.jsx)(p.EuiFlexItem,null,Object(x.jsx)(p.EuiDescriptionList,{textStyle:"reverse"},Object(x.jsx)(p.EuiDescriptionListTitle,null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepReview.summaryTab.ignoreIndexSettingsLabel",defaultMessage:"Reset"})),Object(x.jsx)(p.EuiDescriptionListDescription,null,Object(x.jsx)(p.EuiText,null,Object(x.jsx)("ul",null,d.map((e=>Object(x.jsx)("li",{key:e},Object(x.jsx)(p.EuiTitle,{size:"xs"},Object(x.jsx)("span",null,e)))))))))):null):Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.stepReview.summaryTab.noSettingsValue",defaultMessage:"No index setting modifications"}))},{id:"json",name:s.translate("xpack.snapshotRestore.restoreForm.stepReview.jsonTabTitle",{defaultMessage:"JSON"}),content:Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiSpacer,{size:"m"}),Object(x.jsx)(b.c,{mode:"json",theme:"textmate",isReadOnly:!0,setOptions:{maxLines:1/0},value:JSON.stringify(j,null,2),editorProps:{$blockScrolling:1/0},"aria-label":s.translate("xpack.snapshotRestore.restoreForm.stepReview.jsonTab.jsonAriaLabel",{defaultMessage:"Restore settings to be executed"})}))}]}))},De=({currentStep:e,maxCompletedStep:t,updateCurrentStep:s})=>{const{i18n:a}=O(),o=[{title:a.translate("xpack.snapshotRestore.restoreForm.navigation.stepLogisticsName",{defaultMessage:"Logistics"}),status:1===e?"selected":t>=1?"complete":"incomplete",onClick:()=>s(1)},{title:a.translate("xpack.snapshotRestore.restoreForm.navigation.stepSettingsName",{defaultMessage:"Index settings"}),status:2===e?"selected":t>=2?"complete":"incomplete",disabled:t<1,onClick:()=>s(2)},{title:a.translate("xpack.snapshotRestore.restoreForm.navigation.stepReviewName",{defaultMessage:"Review"}),status:3===e?"selected":t>=2?"complete":"incomplete",disabled:t<2,onClick:()=>s(3)}];return Object(x.jsx)(p.EuiStepsHorizontal,{steps:o})},Ie=({snapshotDetails:e,isSaving:t,saveError:s,clearSaveError:a,onSave:o})=>{const[i,n]=Object(r.useState)(1),[l,c]=Object(r.useState)(0),d={1:Me,2:Fe,3:ve}[i],[j,b]=Object(r.useState)({featureStates:[L.e]}),[g,m]=Object(r.useState)({isValid:!0,errors:{}}),h=e=>{l<e-1||(n(e),c(e-1),a())};return Object(x.jsx)(r.Fragment,null,Object(x.jsx)(De,{currentStep:i,maxCompletedStep:l,updateCurrentStep:h}),Object(x.jsx)(p.EuiSpacer,{size:"l"}),Object(x.jsx)(p.EuiForm,{"data-test-subj":"restoreSnapshotsForm"},Object(x.jsx)(d,{snapshotDetails:e,restoreSettings:j,updateRestoreSettings:e=>{const t={...j,...e},s=(e=>{const t=D.a.i18n,{indices:s,renamePattern:a,renameReplacement:o,indexSettings:i,ignoreIndexSettings:r}=e,n={isValid:!0,errors:{indices:[],renamePattern:[],renameReplacement:[],indexSettings:[],ignoreIndexSettings:[]}};if("string"==typeof s&&0===s.trim().length&&n.errors.indices.push(t.translate("xpack.snapshotRestore.restoreValidation.indexPatternRequiredError",{defaultMessage:"At least one index pattern is required."})),Array.isArray(s)&&0===s.length&&n.errors.indices.push(t.translate("xpack.snapshotRestore.restoreValidation.indicesRequiredError",{defaultMessage:"You must select at least one data stream or index."})),void 0!==a&&W(a)&&n.errors.renamePattern.push(t.translate("xpack.snapshotRestore.restoreValidation.renamePatternRequiredError",{defaultMessage:"Capture pattern is required."})),void 0!==o&&W(o)&&n.errors.renameReplacement.push(t.translate("xpack.snapshotRestore.restoreValidation.renameReplacementRequiredError",{defaultMessage:"Replacement pattern is required."})),"string"==typeof i)try{const e=JSON.parse(i),s=Object.keys(e),a=s.length,o=a>0?s.filter((e=>_.L.includes(e))):null;0===a&&n.errors.indexSettings.push(t.translate("xpack.snapshotRestore.restoreValidation.indexSettingsRequiredError",{defaultMessage:"At least one setting is required."})),o&&o.length>0&&n.errors.indexSettings.push(t.translate("xpack.snapshotRestore.restoreValidation.indexSettingsNotModifiableError",{defaultMessage:"You can’t modify: {settings}",values:{settings:o.map(((e,t)=>0===t?`${e} `:e))}}))}catch(e){n.errors.indexSettings.push(t.translate("xpack.snapshotRestore.restoreValidation.indexSettingsInvalidError",{defaultMessage:"Invalid JSON format"}))}if(Array.isArray(r)){const e=r.length,s=e>0?r.filter((e=>_.M.includes(e))):null;0===e&&n.errors.ignoreIndexSettings.push(t.translate("xpack.snapshotRestore.restoreValidation.ignoreIndexSettingsRequiredError",{defaultMessage:"At least one setting is required."})),s&&s.length>0&&n.errors.ignoreIndexSettings.push(t.translate("xpack.snapshotRestore.restoreValidation.indexSettingsNotRemovableError",{defaultMessage:"You can’t reset: {settings}",values:{settings:s.map(((e,t)=>0===t?`${e} `:e))}}))}return n.errors=Object.entries(n.errors).filter((([e,t])=>t.length>0)).reduce(((e,[t,s])=>(e[t]=s,e)),{}),Object.keys(n.errors).length>0&&(n.isValid=!1),n})(t);b(t),m(s)},errors:g.errors,updateCurrentStep:h}),Object(x.jsx)(p.EuiSpacer,{size:"xl"}),s?Object(x.jsx)(r.Fragment,null,s,Object(x.jsx)(p.EuiSpacer,{size:"m"})):null,Object(x.jsx)(p.EuiFlexGroup,null,i>1?Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiButtonEmpty,{iconType:"arrowLeft",onClick:()=>(()=>{const e=i-1;n(e),c(e-1),a()})(),disabled:!g.isValid,"data-test-subj":"backButton"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.backButtonLabel",defaultMessage:"Back"}))):null,i<3?Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiButton,{fill:!0,iconType:"arrowRight",onClick:()=>(()=>{if(!g.isValid)return;const e=i+1;c(Math.max(i,l)),n(e)})(),disabled:!g.isValid,"data-test-subj":"nextButton"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.nextButtonLabel",defaultMessage:"Next"}))):null,3===i?Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiButton,{fill:!0,color:"success",iconType:"check",onClick:()=>{g.isValid&&o(j)},isLoading:t,"data-test-subj":"restoreButton"},t?Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.savingButtonLabel",defaultMessage:"Restoring…"}):Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreForm.submitButtonLabel",defaultMessage:"Restore snapshot"}))):null)),Object(x.jsx)(p.EuiSpacer,{size:"m"}))},Ce=({children:e})=>{const{i18n:t}=O(),s=M(),[a,i]=Object(r.useState)(""),[n,l]=Object(r.useState)(!1),c=Object(r.useRef)(null),d=()=>{l(!1),i("")};return Object(x.jsx)(r.Fragment,null,e(((e,t=(()=>{}))=>{if(!e||!e.length)throw new Error("No policy name specified for execution");l(!0),i(e),c.current=t})),n?Object(x.jsx)(p.EuiConfirmModal,{title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.executePolicy.confirmModal.executePolicyTitle",defaultMessage:"Run '{name}' now?",values:{name:a}}),onCancel:d,onConfirm:()=>{Object(o.i)(a).then((({data:e,error:o})=>{const{snapshotName:i}=e||{snapshotName:void 0};if(i){const e=t.translate("xpack.snapshotRestore.executePolicy.successNotificationTitle",{defaultMessage:"Policy '{name}' is running",values:{name:a}});s.addSuccess(e),c.current&&c.current()}if(o){const e=t.translate("xpack.snapshotRestore.executePolicy.errorNotificationTitle",{defaultMessage:"Error running policy '{name}'",values:{name:a}});s.addDanger(e)}})),d()},cancelButtonText:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.executePolicy.confirmModal.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.executePolicy.confirmModal.confirmButtonLabel",defaultMessage:"Run policy"}),"data-test-subj":"srExecutePolicyConfirmationModal"}):null)},we=({children:e})=>{const{i18n:t}=O(),s=M(),[a,i]=Object(r.useState)([]),[n,l]=Object(r.useState)(!1),c=Object(r.useRef)(null),d=()=>{l(!1),i([])},j=()=>{const e=[...a];Object(o.d)(e).then((({data:a,error:o})=>{const{itemsDeleted:i,errors:r}=a||{itemsDeleted:void 0,errors:void 0};if(i&&i.length){const e=i.length>1?t.translate("xpack.snapshotRestore.deletePolicy.successMultipleNotificationTitle",{defaultMessage:"Deleted {count} policies",values:{count:i.length}}):t.translate("xpack.snapshotRestore.deletePolicy.successSingleNotificationTitle",{defaultMessage:"Deleted policy '{name}'",values:{name:i[0]}});s.addSuccess(e),c.current&&c.current([...i])}if(o||r&&r.length){const a=r&&r.length>1||o&&e.length>1?t.translate("xpack.snapshotRestore.deletePolicy.errorMultipleNotificationTitle",{defaultMessage:"Error deleting {count} policies",values:{count:r&&r.length||e.length}}):t.translate("xpack.snapshotRestore.deletePolicy.errorSingleNotificationTitle",{defaultMessage:"Error deleting policy '{name}'",values:{name:r&&r[0].name||e[0]}});s.addDanger(a)}})),d()};return Object(x.jsx)(r.Fragment,null,e(((e,t=(()=>{}))=>{if(!e||!e.length)throw new Error("No policy names specified for deletion");l(!0),i(e),c.current=t})),(()=>{if(!n)return null;const e=1===a.length;return Object(x.jsx)(p.EuiConfirmModal,{title:e?Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.deletePolicy.confirmModal.deleteSingleTitle",defaultMessage:"Delete policy '{name}'?",values:{name:a[0]}}):Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.deletePolicy.confirmModal.deleteMultipleTitle",defaultMessage:"Delete {count} policies?",values:{count:a.length}}),onCancel:d,onConfirm:j,cancelButtonText:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.deletePolicy.confirmModal.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.deletePolicy.confirmModal.confirmButtonLabel",defaultMessage:"Delete {count, plural, one {policy} other {policies}}",values:{count:a.length}}),buttonColor:"danger","data-test-subj":"srdeletePolicyConfirmationModal"},e?null:Object(x.jsx)(r.Fragment,null,Object(x.jsx)("p",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.deletePolicy.confirmModal.deleteMultipleListDescription",defaultMessage:"You are about to delete these policies:"})),Object(x.jsx)("ul",null,a.map((e=>Object(x.jsx)("li",{key:e},e))))))})())},Be=({children:e})=>{const{i18n:t}=O(),{docLinks:s}=y(),a=M(),[i,n]=Object(r.useState)(_.e),[l,c]=Object(r.useState)(!1),[d,j]=Object(r.useState)(!1),[g,m]=Object(r.useState)(!1),[h,f]=Object(r.useState)(null),[F,E]=Object(r.useState)(!1),R=Object(r.useRef)(null),[S,k]=Object(r.useState)({expression:_.e,frequency:_.d}),[L,T]=Object(r.useState)({}),[v,D]=Object(r.useState)(!1),I=()=>{c(!1)};return Object(x.jsx)(r.Fragment,null,e(((e,t=(()=>{}))=>{c(!0),E(Boolean(e&&e!==_.e)),e&&(j(!0),n(e)),R.current=t})),l?Object(x.jsx)(p.EuiModal,{onClose:I},Object(x.jsx)(p.EuiModalHeader,null,Object(x.jsx)(p.EuiModalHeaderTitle,null,d?Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepRetention.policyUpdateRetentionEditTitle",defaultMessage:"Edit retention schedule"}):Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepRetention.policyUpdateRetentionAddTitle",defaultMessage:"Add retention schedule"}))),Object(x.jsx)(p.EuiModalBody,null,h&&Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiCallOut,{title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepRetention.policyUpdateRetentionErrorTitle",defaultMessage:"Error saving retention schedule"}),color:"danger",iconType:"alert"},h.data&&h.data.message?Object(x.jsx)("p",null,h.data.message):null),Object(x.jsx)(p.EuiSpacer,{size:"m"})),F?Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiFormRow,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepRetention.policyUpdateRetentionScheduleLabel",defaultMessage:"Retention schedule"}),isInvalid:v,error:t.translate("xpack.snapshotRestore.policyForm.stepRetention.policyUpdateRetentionScheduleFieldErrorMessage",{defaultMessage:"Retention schedule is required."}),helpText:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepRetention.policyUpdateRetentionHelpText",defaultMessage:"Use cron expression. {docLink}",values:{docLink:Object(x.jsx)(p.EuiLink,{href:s.links.watcher.cronSchedule,target:"_blank"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepRetention.policyUpdateRetentionHelpTextDocLinkText",defaultMessage:"Learn more."}))}}),fullWidth:!0},Object(x.jsx)(p.EuiFieldText,{defaultValue:i,fullWidth:!0,onChange:e=>n(e.target.value)})),Object(x.jsx)(p.EuiSpacer,{size:"m"}),Object(x.jsx)(p.EuiText,{size:"s"},Object(x.jsx)(p.EuiLink,{onClick:()=>{E(!1),n(S.expression)},"data-test-subj":"showBasicCronLink"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepRetention.policyUpdateRetentionBasicLabel",defaultMessage:"Create basic interval"})))):Object(x.jsx)(r.Fragment,null,Object(x.jsx)(b.b,{fieldToPreferredValueMap:L,cronExpression:S.expression,frequency:S.frequency,onChange:({cronExpression:e,frequency:t,fieldToPreferredValueMap:s})=>{k({expression:e,frequency:t}),T(s),n(e)}}),Object(x.jsx)(p.EuiSpacer,{size:"m"}),Object(x.jsx)(p.EuiText,{size:"s"},Object(x.jsx)(p.EuiLink,{onClick:()=>{E(!0)},"data-test-subj":"showAdvancedCronLink"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepRetention.policyUpdateRetentionAdvancedLabel",defaultMessage:"Create cron expression"}))))),Object(x.jsx)(p.EuiModalFooter,null,Object(x.jsx)(p.EuiButtonEmpty,{onClick:I},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepRetention.policyUpdateRetentionCancelButtonLabel",defaultMessage:"Cancel"})),Object(x.jsx)(p.EuiButton,{onClick:async()=>{if(!i)return void D(!0);m(!0),f(null);const{error:e}=await Object(o.n)(i);m(!1),e?f(e):(I(),a.addSuccess(t.translate("xpack.snapshotRestore.policyForm.stepRetention.policyUpdateRetentionSuccessMessage",{defaultMessage:"Retention schedule updated"})),R.current&&R.current())},fill:!0,isLoading:g},d?Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepRetention.policyUpdateRetentionEditButtonLabel",defaultMessage:"Save changes"}):Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepRetention.policyUpdateRetentionSaveButtonLabel",defaultMessage:"Schedule"})))):null)},Pe=({children:e})=>{const{i18n:t}=O(),s=M(),[a,i]=Object(r.useState)(!1),l=()=>{i(!1)};return Object(x.jsx)(n.a.Fragment,null,e((()=>{i(!0)})),a?Object(x.jsx)(p.EuiConfirmModal,{title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.executeRetention.confirmModal.executeRetentionTitle",defaultMessage:"Run snapshot retention now?"}),onCancel:l,onConfirm:()=>{Object(o.k)().then((({error:e})=>{if(e){const e=t.translate("xpack.snapshotRestore.executeRetention.errorMessage",{defaultMessage:"Error running retention"});s.addDanger(e)}else{const e=t.translate("xpack.snapshotRestore.executeRetention.successMessage",{defaultMessage:"Retention is running"});s.addSuccess(e)}})),l()},cancelButtonText:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.executeRetention.confirmModal.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.executeRetention.confirmModal.confirmButtonLabel",defaultMessage:"Run retention"}),"data-test-subj":"executeRetentionModal"}):null)};var Ae=s(8);const Ne=({policy:e,updatePolicy:t,isEditing:s,currentUrl:a,errors:l})=>{const{error:c,isLoading:d,data:{repositories:j}={repositories:[]},resendRequest:g}=Object(o.r)(),{i18n:m,history:h}=O(),{docLinks:f}=y(),[M,F]=Object(r.useState)(!1),[E,R]=Object(r.useState)({name:!1,snapshotName:!1,repository:!1,schedule:!1}),[S,k]=Object(r.useState)({expression:_.c,frequency:_.b}),[L,T]=Object(r.useState)(Boolean(e.schedule&&e.schedule!==_.c)),[v,D]=Object(r.useState)({});return Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiTitle,null,Object(x.jsx)("h2",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepLogisticsTitle",defaultMessage:"Logistics"})))),Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiButtonEmpty,{size:"s",flush:"right",href:f.links.apis.putSnapshotLifecyclePolicy,target:"_blank",iconType:"help"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepLogistics.docsButtonLabel",defaultMessage:"Logistics docs"})))),M&&Object(x.jsx)(n.a.Fragment,null,Object(x.jsx)(p.EuiSpacer,{size:"m"}),Object(x.jsx)(p.EuiCallOut,{"data-test-subj":"repositoryNotFoundWarning",title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepLogistics.selectRepository.policyRepositoryNotFoundTitle",defaultMessage:"Repository not found"}),color:"danger",iconType:"alert"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepLogistics.selectRepository.policyRepositoryNotFoundDescription",defaultMessage:"Repository {repo} does not exist. Please select an existing repository.",values:{repo:Object(x.jsx)(p.EuiCode,null,e.repository)}}))),Object(x.jsx)(p.EuiSpacer,{size:"l"}),Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepLogistics.nameDescriptionTitle",defaultMessage:"Policy name"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepLogistics.nameDescription",defaultMessage:"A unique identifier for this policy."}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepLogistics.nameLabel",defaultMessage:"Name"}),isInvalid:E.name&&Boolean(l.name),error:l.name,fullWidth:!0},Object(x.jsx)(p.EuiFieldText,{defaultValue:e.name,fullWidth:!0,onBlur:()=>R({...E,name:!0}),onChange:e=>{t({name:e.target.value})},placeholder:m.translate("xpack.snapshotRestore.policyForm.stepLogistics.namePlaceholder",{defaultMessage:"daily-snapshots",description:"Example SLM policy name. Similar to index names, do not use spaces in translation."}),"data-test-subj":"nameInput",disabled:s}))),Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepLogistics.snapshotNameDescriptionTitle",defaultMessage:"Snapshot name"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepLogistics.snapshotNameDescription",defaultMessage:"The name for the snapshots. A unique identifier is automatically added to each name."}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepLogistics.policySnapshotNameLabel",defaultMessage:"Snapshot name"}),isInvalid:E.snapshotName&&Boolean(l.snapshotName),error:l.snapshotName,helpText:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepLogistics.policySnapshotNameHelpText",defaultMessage:"Supports date math expressions. {docLink}",values:{docLink:Object(x.jsx)(p.EuiLink,{href:f.links.date.dateMathIndexNames,target:"_blank"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepLogistics.policySnapshotNameHelpTextDocLink",defaultMessage:"Learn more."}))}}),fullWidth:!0},Object(x.jsx)(p.EuiFieldText,{defaultValue:e.snapshotName,fullWidth:!0,onChange:e=>{t({snapshotName:e.target.value})},onBlur:()=>R({...E,snapshotName:!0}),placeholder:m.translate("xpack.snapshotRestore.policyForm.stepLogistics.policySnapshotNamePlaceholder",{defaultMessage:"<daily-snap-\\{now/d\\}>",description:"Example date math snapshot name. Keeping the same syntax is important: <SOME-TRANSLATION-{now/d}>"}),"data-test-subj":"snapshotNameInput"}))),Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepLogistics.repositoryDescriptionTitle",defaultMessage:"Repository"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepLogistics.repositoryDescription",defaultMessage:"The repository where you want to store the snapshots."}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepLogistics.policyRepositoryLabel",defaultMessage:"Repository"}),isInvalid:E.repository&&Boolean(l.repository),error:l.repository,fullWidth:!0},(()=>{if(d)return Object(x.jsx)(le,null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.loadingRepositoriesDescription",defaultMessage:"Loading repositories…"}));if(c)return Object(x.jsx)(b.h,{title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.loadingRepositoriesErrorMessage",defaultMessage:"Error loading repositories"}),error:c,actions:Object(x.jsx)(p.EuiButton,{onClick:()=>g(),color:"danger",iconType:"refresh","data-test-subj":"reloadRepositoriesButton"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.reloadRepositoriesButtonLabel",defaultMessage:"Reload repositories"}))});if(0===j.length)return Object(x.jsx)(b.h,{title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.noRepositoriesErrorTitle",defaultMessage:"You don't have any repositories"}),error:{error:m.translate("xpack.snapshotRestore.policyForm.noRepositoriesErrorMessage",{defaultMessage:"You must register a repository to store your snapshots."})},actions:Object(x.jsx)(p.EuiButton,re()({},Object(Ae.reactRouterNavigate)(h,Object(i.d)(a)),{color:"danger",iconType:"plusInCircle","data-test-subj":"addRepositoryButton"}),Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.addRepositoryButtonLabel",defaultMessage:"Register a repository"}))});e.repository||t({repository:j[0].name});const s=!!e.repository&&j.some((t=>t.name===e.repository));return s||l.repository||t(e,{repositoryDoesNotExist:!0}),M!==!s&&F(!s),Object(x.jsx)(p.EuiSelect,{options:j.map((({name:e})=>({value:e,text:e}))),hasNoInitialSelection:!s,value:s?e.repository:"",onBlur:()=>R({...E,repository:!0}),onChange:e=>{t({repository:e.target.value})},fullWidth:!0,"data-test-subj":"repositorySelect"})})())),Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepLogistics.scheduleDescriptionTitle",defaultMessage:"Schedule"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepLogistics.scheduleDescription",defaultMessage:"The frequency at which to take the snapshots."}),fullWidth:!0},L?Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiFormRow,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepLogistics.policyScheduleLabel",defaultMessage:"Schedule"}),isInvalid:E.schedule&&Boolean(l.schedule),error:l.schedule,helpText:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepLogistics.policyScheduleHelpText",defaultMessage:"Use cron expression. {docLink}",values:{docLink:Object(x.jsx)(p.EuiLink,{href:f.links.apis.cronExpressions,target:"_blank"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepLogistics.policyScheduleHelpTextDocLink",defaultMessage:"Learn more."}))}}),fullWidth:!0},Object(x.jsx)(p.EuiFieldText,{defaultValue:e.schedule,fullWidth:!0,onChange:e=>{t({schedule:e.target.value})},onBlur:()=>R({...E,schedule:!0}),placeholder:_.c,"data-test-subj":"advancedCronInput"})),Object(x.jsx)(p.EuiSpacer,{size:"m"}),Object(x.jsx)(p.EuiText,{size:"s"},Object(x.jsx)(p.EuiLink,{onClick:()=>{T(!1),t({schedule:S.expression})},"data-test-subj":"showBasicCronLink"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepLogistics.policyScheduleButtonBasicLabel",defaultMessage:"Create basic interval"})))):Object(x.jsx)(r.Fragment,null,Object(x.jsx)(b.b,{frequencyBlockList:["MINUTE"],fieldToPreferredValueMap:v,cronExpression:S.expression,frequency:S.frequency,onChange:({cronExpression:e,frequency:s,fieldToPreferredValueMap:a})=>{k({expression:e,frequency:s}),D(a),t({schedule:e})}}),Object(x.jsx)(p.EuiSpacer,{size:"s"}),Object(x.jsx)(p.EuiText,{size:"s"},Object(x.jsx)(p.EuiLink,{onClick:()=>{T(!0)},"data-test-subj":"showAdvancedCronLink"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepLogistics.policyScheduleButtonAdvancedLabel",defaultMessage:"Create cron expression"}))))))},ze=({allSelected:e,selection:t,dataStreams:s,indices:a})=>be({dataStreams:s.map((s=>({label:s,append:Object(x.jsx)(xe,null),checked:e||t.includes(s)?"on":void 0}))),indices:a.map((s=>({label:s,checked:e||t.includes(s)?"on":void 0})))}),Ge=({onSelectionChange:e,selectedIndicesAndDataStreams:t,indices:s,dataStreams:a})=>{if(0===t.length)return Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepSettings.noDataStreamsOrIndicesHelpText",defaultMessage:"Nothing will be backed up. {selectAllLink}",values:{selectAllLink:Object(x.jsx)(p.EuiLink,{onClick:()=>{e("all")}},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepSettings.selectAllIndicesLink",defaultMessage:"Select all"}))}});const o=t.reduce(((e,t)=>s.includes(t)?e+1:e),0),i=t.reduce(((e,t)=>a.includes(t)?e+1:e),0);return Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepSettings.selectDataStreamsIndicesHelpText",defaultMessage:"{indicesCount} {indicesCount, plural, one {index} other {indices}} and {dataStreamsCount} {dataStreamsCount, plural, one {data stream} other {data streams}} will be backed up. {deselectAllLink}",values:{dataStreamsCount:i,indicesCount:o,deselectAllLink:Object(x.jsx)(p.EuiLink,{"data-test-subj":"deselectIndicesLink",onClick:()=>{e("none")}},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepSettings.deselectAllIndicesLink",defaultMessage:"Deselect all"}))}})},_e=({isManagedPolicy:e,dataStreams:t,indices:s,policy:a,onUpdate:o,errors:i})=>{const{i18n:n}=O(),{config:l={}}=a,c=s.concat(t),[d,j]=Object(r.useState)(null==l.indices||Array.isArray(l.indices)&&0===l.indices.length),b=e=>{o(e,{validateIndicesCount:!d})},[g,m]=Object(r.useState)((()=>Array.isArray(l.indices)&&!d?c.filter((e=>l.indices.includes(e))):[...c])),[h,y]=Object(r.useState)((()=>ze({selection:g,dataStreams:t,indices:s,allSelected:d||"string"==typeof l.indices}))),[f,M]=Object(r.useState)((()=>(({configuredIndices:e,indices:t,dataStreams:s})=>{const a=t.concat(s);return"string"==typeof e||a.length>100||Array.isArray(e)&&!e.every((e=>a.some((t=>t===e))))?"custom":"list"})({configuredIndices:l.indices,dataStreams:t,indices:s}))),[F,E]=Object(r.useState)((()=>"string"==typeof l.indices?l.indices.split(","):Array.isArray(l.indices)&&l.indices?l.indices:[])),R=Object(x.jsx)(p.EuiSwitch,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepSettings.allDataStreamsAndIndicesLabel",defaultMessage:"All data streams and indices"}),checked:d,disabled:e,"data-test-subj":"allIndicesToggle",onChange:e=>{const a=e.target.checked;j(a),a?(m(c),y(ze({allSelected:d||"string"==typeof l.indices,dataStreams:t,indices:s,selection:g})),b({indices:void 0})):o({indices:"custom"===f?F.join(","):[...g||[]]},{validateIndicesCount:!0})}});return Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepSettings.dataStreamsAndIndicesTitle",defaultMessage:"Data streams and indices"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepSettings.dataStreamsAndIndicesDescription",defaultMessage:"To back up indices and data streams, manually select them or define index patterns to dynamically match them."}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{hasEmptyLabelSpace:!0,fullWidth:!0},Object(x.jsx)(r.Fragment,null,e?Object(x.jsx)(p.EuiToolTip,{position:"left",content:Object(x.jsx)("p",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepSettings.indicesTooltip",defaultMessage:"Cloud-managed policies require all indices."}))},R):R,d?null:Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiSpacer,{size:"m"}),Object(x.jsx)(p.EuiFormRow,{className:"snapshotRestore__policyForm__stepSettings__indicesFieldWrapper",label:"list"===f?Object(x.jsx)(p.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepSettings.selectIndicesLabel",defaultMessage:"Select indices and data streams"})),Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiLink,{onClick:()=>{M("custom"),b({indices:F.join(",")})}},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepSettings.indicesToggleCustomLink",defaultMessage:"Use index patterns"})))):Object(x.jsx)(p.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepSettings.indicesPatternLabel",defaultMessage:"Index patterns"})),Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiLink,{"data-test-subj":"selectIndicesLink",onClick:()=>{M("list"),b({indices:g})}},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepSettings.dataStreamsAndIndicesToggleListLink",defaultMessage:"Select data streams and indices"})))),helpText:"list"===f?Object(x.jsx)(Ge,{onSelectionChange:e=>{"all"===e?(h.forEach((e=>{e.checked="on"})),b({indices:[...c]}),m([...c])):(h.forEach((e=>{e.checked=void 0})),b({indices:[]}),m([]))},selectedIndicesAndDataStreams:g,indices:s,dataStreams:t}):null,isInvalid:Boolean(i.indices),error:i.indices},"list"===f?Object(x.jsx)(p.EuiSelectable,{allowExclusions:!1,"data-test-subj":"indicesAndDataStreamsList",options:h,onChange:e=>{const t=[];e.forEach((({label:e,checked:s})=>{"on"===s&&t.push(e)})),y(e),b({indices:t}),m(t)},searchable:!0,height:300},((e,t)=>Object(x.jsx)(p.EuiPanel,{paddingSize:"s",hasShadow:!1},t,e))):Object(x.jsx)(p.EuiComboBox,{options:be({indices:s.map((e=>({label:e,value:{isDataStream:!1}}))),dataStreams:t.map((e=>({label:e,value:{isDataStream:!0}})))}),renderOption:({label:e,value:t})=>null!=t&&t.isDataStream?Object(x.jsx)(p.EuiFlexGroup,{responsive:!1,justifyContent:"spaceBetween",alignItems:"center"},Object(x.jsx)(p.EuiFlexItem,{grow:!1},e),Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(xe,null))):e,placeholder:n.translate("xpack.snapshotRestore.policyForm.stepSettings.indicesPatternPlaceholder",{defaultMessage:"Enter index patterns, i.e. logstash-*"}),selectedOptions:F.map((e=>({label:e}))),onCreateOption:e=>{if(!e.trim().length)return;const t=[...F,e];E(t),b({indices:t.join(",")})},onChange:e=>{const t=e.map((({label:e})=>e));E(t),b({indices:t.join(",")})}}))))))},We=({policy:e,onUpdate:t})=>{const{config:s={}}=e;return Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepSettings.includeGlobalStateDescriptionTitle",defaultMessage:"Include global state"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepSettings.includeGlobalStateDescription",defaultMessage:"Stores the global cluster state as part of the snapshot."}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{hasEmptyLabelSpace:!0,fullWidth:!0},Object(x.jsx)(p.EuiSwitch,{"data-test-subj":"globalStateToggle",label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepSettings.policyIncludeGlobalStateLabel",defaultMessage:"Include global state"}),checked:void 0===s.includeGlobalState||s.includeGlobalState,onChange:e=>{var a;const{checked:o}=e.target,i=!(null!=s&&null!==(a=s.featureStates)&&void 0!==a&&a.includes(L.e));t({includeGlobalState:o,featureStates:o&&!i?[]:s.featureStates||[]})}})))};var Ve=s(10);const Ue=({policy:e,onUpdate:t})=>{const{config:s={}}=e,{error:a,isLoading:o,data:i}=Object(Ve.h)(),l=Object(r.useMemo)((()=>((null==i?void 0:i.features)||[]).map((e=>e.name))),[i]),c=Object(r.useMemo)((()=>{var e;return null==s||null===(e=s.featureStates)||void 0===e?void 0:e.map((e=>({label:e})))}),[s.featureStates]),d=void 0!==s.featureStates&&!s.featureStates.includes(L.e);return Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepSettings.includeFeatureStatesDescriptionTitle",defaultMessage:"Include feature state"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepSettings.includeFeatureStatesDescription",defaultMessage:"Includes the configuration, history, and other data stored in Elasticsearch by a feature such as Elasticsearch security."}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{hasEmptyLabelSpace:!0,fullWidth:!0},Object(x.jsx)(p.EuiSwitch,{"data-test-subj":"featureStatesToggle",label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepSettings.policyIncludeFeatureStatesLabel",defaultMessage:"Include feature state from"}),checked:d,onChange:e=>{const{checked:s}=e.target;t({featureStates:s?[]:[L.e]})}})),d&&Object(x.jsx)(n.a.Fragment,null,Object(x.jsx)(p.EuiSpacer,{size:"m"}),a?Object(x.jsx)(p.EuiCallOut,{color:"warning",iconType:"alert",title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.errorLoadingFeatureStatesLabel",defaultMessage:"There was an error loading the list of feature states"})}):Object(x.jsx)(fe,{isLoadingFeatures:o,featuresOptions:l,selectedOptions:c,onUpdateFormSettings:t})))},$e=({policy:e,indices:t,dataStreams:s,updatePolicy:a,errors:o})=>{const{docLinks:i}=y(),{config:r={},isManagedPolicy:n}=e,l=(e,t={})=>{const s={...r,...e};a({config:s},t)};return Object(x.jsx)("div",{className:"snapshotRestore__policyForm__stepSettings"},Object(x.jsx)(p.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiTitle,null,Object(x.jsx)("h2",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepSettingsTitle",defaultMessage:"Snapshot settings"})))),Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiButtonEmpty,{size:"s",flush:"right",href:i.links.snapshotRestore.createSnapshot,target:"_blank",iconType:"help"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepSettings.docsButtonLabel",defaultMessage:"Snapshot docs"})))),Object(x.jsx)(p.EuiSpacer,{size:"l"}),Object(x.jsx)(_e,{isManagedPolicy:n,errors:o,dataStreams:s,indices:t,policy:e,onUpdate:l}),Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepSettings.ignoreUnavailableDescriptionTitle",defaultMessage:"Ignore unavailable indices"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepSettings.ignoreUnavailableDescription",defaultMessage:"Ignores indices that are unavailable when taking the snapshot. Otherwise, the entire snapshot will fail."}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{hasEmptyLabelSpace:!0,fullWidth:!0},Object(x.jsx)(p.EuiSwitch,{"data-test-subj":"ignoreUnavailableIndicesToggle",label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepSettings.ignoreUnavailableLabel",defaultMessage:"Ignore unavailable indices"}),checked:Boolean(r.ignoreUnavailable),onChange:e=>{l({ignoreUnavailable:e.target.checked})}}))),Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepSettings.partialDescriptionTitle",defaultMessage:"Allow partial indices"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepSettings.partialDescription",defaultMessage:"Allows snapshots of indices with primary shards that are unavailable. Otherwise, the entire snapshot will fail."}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{hasEmptyLabelSpace:!0,fullWidth:!0},Object(x.jsx)(p.EuiSwitch,{"data-test-subj":"partialIndicesToggle",label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepSettings.partialIndicesToggleSwitch",defaultMessage:"Allow partial indices"}),checked:Boolean(r.partial),onChange:e=>{l({partial:e.target.checked})}}))),Object(x.jsx)(We,{errors:o,policy:e,onUpdate:l}),Object(x.jsx)(Ue,{errors:o,policy:e,onUpdate:l}))},He=(e="0")=>Object.entries(L.h).map((([t,s])=>({text:D.a.getTimeUnitLabel(s,e),value:s}))),qe=({policy:e,updatePolicy:t,errors:s})=>{const{retention:a={}}=e,{docLinks:o}=y(),i=(e,s={})=>{const o={...a,...e};t({retention:o},s)},[n,l]=Object(r.useState)({expireAfterValue:!1,minCount:!1,maxCount:!1});return Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiTitle,null,Object(x.jsx)("h2",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepRetentionTitle",defaultMessage:"Snapshot retention (optional)"})))),Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiButtonEmpty,{size:"s",flush:"right",href:o.links.snapshotRestore.createSnapshot,target:"_blank",iconType:"help"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepRetention.docsButtonLabel",defaultMessage:"Snapshot docs"})))),Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepRetention.expirationTitle",defaultMessage:"Expiration"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepRetention.expirationDescription",defaultMessage:"The time to wait before deleting snapshots."}),fullWidth:!0},Object(x.jsx)(p.EuiFormRow,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepRetention.expireAfterLabel",defaultMessage:"Delete after"}),isInvalid:n.expireAfterValue&&Boolean(s.expireAfterValue),error:s.expireAfterValue,fullWidth:!0},Object(x.jsx)(p.EuiFlexGroup,null,Object(x.jsx)(p.EuiFlexItem,null,Object(x.jsx)(p.EuiFieldNumber,{value:a.expireAfterValue||"",onBlur:()=>l({...n,expireAfterValue:!0}),onChange:e=>{const t=e.target.value;i({expireAfterValue:""!==t?Number(t):t})},"data-test-subj":"expireAfterValueInput",min:0})),Object(x.jsx)(p.EuiFlexItem,null,Object(x.jsx)(p.EuiSelect,{value:a.expireAfterUnit,options:He(a.expireAfterValue?a.expireAfterValue.toString():void 0),onChange:e=>{i({expireAfterUnit:e.target.value})},"data-test-subj":"expireAfterUnitSelect"}))))),Object(x.jsx)(p.EuiDescribedFormGroup,{title:Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepRetention.countTitle",defaultMessage:"Snapshots to retain"}))),description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepRetention.countDescription",defaultMessage:"The minimum and maximum number of snapshots to store for the policy."}),fullWidth:!0},Object(x.jsx)(p.EuiFlexGroup,null,Object(x.jsx)(p.EuiFlexItem,null,Object(x.jsx)(p.EuiFormRow,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepRetention.minCountLabel",defaultMessage:"Mininum count"}),isInvalid:n.minCount&&Boolean(s.minCount),error:s.minCount,fullWidth:!0},Object(x.jsx)(p.EuiFieldNumber,{fullWidth:!0,value:a.minCount||"",onBlur:()=>l({...n,minCount:!0}),onChange:e=>{const t=e.target.value;i({minCount:""!==t?Number(t):t})},"data-test-subj":"minCountInput",min:0}))),Object(x.jsx)(p.EuiFlexItem,null,Object(x.jsx)(p.EuiFormRow,{label:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepRetention.maxCountLabel",defaultMessage:"Maximum count"}),isInvalid:n.maxCount&&Boolean(s.maxCount),error:s.maxCount,fullWidth:!0},Object(x.jsx)(p.EuiFieldNumber,{fullWidth:!0,value:a.maxCount||"",onBlur:()=>l({...n,maxCount:!0}),onChange:e=>{const t=e.target.value;i({maxCount:""!==t?Number(t):t})},"data-test-subj":"maxCountInput",min:0}))))))},Ye=({policy:e,updateCurrentStep:t})=>{const{i18n:s}=O(),{name:a,snapshotName:o,schedule:i,repository:n,config:l,retention:c}=e,{indices:d,includeGlobalState:j,featureStates:b,ignoreUnavailable:g,partial:m}=l||{indices:void 0,includeGlobalState:void 0,featureStates:[],ignoreUnavailable:void 0,partial:void 0},h=(e=>{const{snapshotName:t,schedule:s,repository:a,config:o,retention:i}=e,r={name:t,schedule:s,repository:a};return o&&(r.config=function(e){const{indices:t,ignoreUnavailable:s,includeGlobalState:a,featureStates:o,partial:i,metadata:r}=e,n={indices:T(t),ignore_unavailable:s,include_global_state:a,feature_states:o,partial:i,metadata:r};return Object.entries(n).reduce(((e,[t,s])=>(void 0!==s&&(e[t]=s),e)),{})}(o)),i&&v(i)&&(r.retention=v(i)),r})(e),{retention:y}=h,f=({step:e})=>Object(x.jsx)(p.EuiToolTip,{content:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepReview.summaryTab.editStepTooltip",defaultMessage:"Edit"})},Object(x.jsx)(p.EuiLink,{onClick:()=>t(e)},Object(x.jsx)(p.EuiIcon,{type:"pencil","aria-label":s.translate("xpack.snapshotRestore.policyForm.stepReview.editIconAriaLabel",{defaultMessage:"Edit step"})})));return Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiTitle,null,Object(x.jsx)("h2",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepReviewTitle",defaultMessage:"Review policy"}))),Object(x.jsx)(p.EuiSpacer,{size:"m"}),Object(x.jsx)(p.EuiTabbedContent,{tabs:[{id:"summary",name:s.translate("xpack.snapshotRestore.policyForm.stepReview.summaryTabTitle",{defaultMessage:"Summary"}),content:Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiSpacer,{size:"m"}),Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepReview.summaryTab.sectionLogisticsTitle",defaultMessage:"Logistics"})," ",Object(x.jsx)(f,{step:1}))),Object(x.jsx)(p.EuiSpacer,{size:"s"}),Object(x.jsx)(p.EuiFlexGroup,null,Object(x.jsx)(p.EuiFlexItem,null,Object(x.jsx)(p.EuiDescriptionList,{textStyle:"reverse"},Object(x.jsx)(p.EuiDescriptionListTitle,null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepReview.summaryTab.nameLabel",defaultMessage:"Policy name"})),Object(x.jsx)(p.EuiDescriptionListDescription,null,a))),Object(x.jsx)(p.EuiFlexItem,null,Object(x.jsx)(p.EuiDescriptionList,{textStyle:"reverse"},Object(x.jsx)(p.EuiDescriptionListTitle,null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepReview.summaryTab.snapshotNameLabel",defaultMessage:"Snapshot name"})),Object(x.jsx)(p.EuiDescriptionListDescription,null,o)))),Object(x.jsx)(p.EuiSpacer,{size:"s"}),Object(x.jsx)(p.EuiFlexGroup,null,Object(x.jsx)(p.EuiFlexItem,null,Object(x.jsx)(p.EuiDescriptionList,{textStyle:"reverse"},Object(x.jsx)(p.EuiDescriptionListTitle,null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepReview.summaryTab.repositoryLabel",defaultMessage:"Repository"})),Object(x.jsx)(p.EuiDescriptionListDescription,null,n))),Object(x.jsx)(p.EuiFlexItem,null,Object(x.jsx)(p.EuiDescriptionList,{textStyle:"reverse"},Object(x.jsx)(p.EuiDescriptionListTitle,null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepReview.summaryTab.scheduleLabel",defaultMessage:"Schedule"})),Object(x.jsx)(p.EuiDescriptionListDescription,null,i)))),Object(x.jsx)(p.EuiSpacer,{size:"xxl"}),Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepReview.summaryTab.sectionSettingsTitle",defaultMessage:"Snapshot settings"})," ",Object(x.jsx)(f,{step:2}))),Object(x.jsx)(p.EuiSpacer,{size:"s"}),Object(x.jsx)(p.EuiFlexGroup,null,Object(x.jsx)(p.EuiFlexItem,null,Object(x.jsx)(p.EuiDescriptionList,{textStyle:"reverse"},Object(x.jsx)(p.EuiDescriptionListTitle,null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepReview.summaryTab.dataStreamsAndIndicesLabel",defaultMessage:"Data streams and indices"})),Object(x.jsx)(p.EuiDescriptionListDescription,null,Object(x.jsx)(Re,{indices:d})))),Object(x.jsx)(p.EuiFlexItem,null,Object(x.jsx)(p.EuiDescriptionList,{textStyle:"reverse"},Object(x.jsx)(p.EuiDescriptionListTitle,null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepReview.summaryTab.ignoreUnavailableLabel",defaultMessage:"Ignore unavailable indices"})),Object(x.jsx)(p.EuiDescriptionListDescription,null,g?Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepReview.summaryTab.ignoreUnavailableTrueLabel",defaultMessage:"Yes"}):Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepReview.summaryTab.ignoreUnavailableFalseLabel",defaultMessage:"No"}))))),Object(x.jsx)(p.EuiSpacer,{size:"s"}),Object(x.jsx)(p.EuiFlexGroup,null,Object(x.jsx)(p.EuiFlexItem,null,Object(x.jsx)(p.EuiDescriptionList,{textStyle:"reverse"},Object(x.jsx)(p.EuiDescriptionListTitle,null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepReview.summaryTab.includeGlobalStateLabel",defaultMessage:"Include global state"})),Object(x.jsx)(p.EuiDescriptionListDescription,null,!1===j?Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepReview.summaryTab.includeGlobalStateFalseLabel",defaultMessage:"No"}):Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepReview.summaryTab.includeGlobalStateTrueLabel",defaultMessage:"Yes"})))),Object(x.jsx)(Le,{includeGlobalState:j,featureStates:b})),Object(x.jsx)(p.EuiSpacer,{size:"s"}),Object(x.jsx)(p.EuiFlexGroup,null,Object(x.jsx)(p.EuiFlexItem,null,Object(x.jsx)(p.EuiDescriptionList,{textStyle:"reverse"},Object(x.jsx)(p.EuiDescriptionListTitle,null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepReview.summaryTab.partialIndicesLabel",defaultMessage:"Allow partial indices"})),Object(x.jsx)(p.EuiDescriptionListDescription,null,m?Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepReview.summaryTab.partialTrueLabel",defaultMessage:"Yes"}):Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepReview.summaryTab.partialFalseLabel",defaultMessage:"No"}))))),y?Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiSpacer,{size:"m"}),Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepReview.retentionTab.sectionRetentionTitle",defaultMessage:"Snapshot retention"})," ",Object(x.jsx)(f,{step:3}))),Object(x.jsx)(p.EuiSpacer,{size:"s"}),Object(x.jsx)(p.EuiDescriptionList,{textStyle:"reverse"},c.expireAfterValue&&Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiDescriptionListTitle,null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepReview.retentionTab.expireAfterLabel",defaultMessage:"Delete after"})),Object(x.jsx)(p.EuiDescriptionListDescription,null,c.expireAfterValue,c.expireAfterUnit)),c.minCount&&Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiDescriptionListTitle,null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepReview.retentionTab.minCountLabel",defaultMessage:"Min count"})),Object(x.jsx)(p.EuiDescriptionListDescription,null,c.minCount)),c.maxCount&&Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiDescriptionListTitle,null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.stepReview.retentionTab.maxCountLabel",defaultMessage:"Max count"})),Object(x.jsx)(p.EuiDescriptionListDescription,null,c.maxCount)))):null)},{id:"json",name:s.translate("xpack.snapshotRestore.policyForm.stepReview.requestTabTitle",{defaultMessage:"Request"}),content:(()=>{const e=`PUT _slm/policy/${a}`,t=JSON.stringify(h,null,2);return Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiSpacer,{size:"m"}),Object(x.jsx)(p.EuiCodeBlock,{language:"json",isCopyable:!0},`${e}\n${t}`))})()}]}))},Xe=({currentStep:e,maxCompletedStep:t,updateCurrentStep:s,isFormValid:a})=>{const{i18n:o}=O(),i=[{title:o.translate("xpack.snapshotRestore.policyForm.navigation.stepLogisticsName",{defaultMessage:"Logistics"}),status:1===e?"selected":t>=1?"complete":"incomplete",disabled:!a&&1!==e,onClick:()=>s(1)},{title:o.translate("xpack.snapshotRestore.policyForm.navigation.stepSettingsName",{defaultMessage:"Snapshot settings"}),status:2===e?"selected":t>=2?"complete":"incomplete",disabled:t<1||!a&&2!==e,onClick:()=>s(2)},{title:o.translate("xpack.snapshotRestore.policyForm.navigation.stepRetentionName",{defaultMessage:"Snapshot retention"}),status:3===e?"selected":t>=3?"complete":"incomplete",disabled:t<2||!a&&3!==e,onClick:()=>s(3)},{title:o.translate("xpack.snapshotRestore.policyForm.navigation.stepReviewName",{defaultMessage:"Review"}),status:4===e?"selected":t>=3?"complete":"incomplete",disabled:t<3||!a&&4!==e,onClick:()=>s(4)}];return Object(x.jsx)(p.EuiStepsHorizontal,{steps:i})},Je=({policy:e,dataStreams:t,indices:s,currentUrl:a,isEditing:o,isSaving:i,saveError:n,clearSaveError:l,onCancel:c,onSave:d})=>{var j,b;const[g,m]=Object(r.useState)(1),[h,O]=Object(r.useState)(0),y={1:Ne,2:$e,3:qe,4:Ye},f=y[g],[M,F]=Object(r.useState)({...e,config:{featureStates:[],includeGlobalState:!0,...e.config||{}},retention:{...e.retention,expireAfterUnit:null!==(j=null===(b=e.retention)||void 0===b?void 0:b.expireAfterUnit)&&void 0!==j?j:L.h.DAY}}),E=Boolean(o&&M.isManagedPolicy),[R,S]=Object(r.useState)({isValid:!0,errors:{}}),k=e=>{h<e-1||(m(e),O(e-1),l())},T=Object.keys(y).length;return Object(x.jsx)(r.Fragment,null,Object(x.jsx)(Xe,{currentStep:g,maxCompletedStep:h,updateCurrentStep:k,isFormValid:R.isValid}),Object(x.jsx)(p.EuiSpacer,{size:"l"}),Object(x.jsx)(p.EuiForm,null,Object(x.jsx)(f,{policy:M,indices:s,dataStreams:t,updatePolicy:(e,t={})=>{const s={...M,...e},a=((e,t)=>{const s=D.a.i18n,{name:a,snapshotName:o,schedule:i,repository:r,config:n,retention:l}=e,{validateIndicesCount:c,repositoryDoesNotExist:p}=t,u={isValid:!0,errors:{name:[],snapshotName:[],schedule:[],repository:[],dataStreams:[],indices:[],expireAfterValue:[],minCount:[],maxCount:[]}};return V(a)&&u.errors.name.push(s.translate("xpack.snapshotRestore.policyValidation.nameRequiredErroMessage",{defaultMessage:"Policy name is required."})),V(o)&&u.errors.snapshotName.push(s.translate("xpack.snapshotRestore.policyValidation.snapshotNameRequiredErrorMessage",{defaultMessage:"Snapshot name is required."})),(e=>{const t=e.substring(0,e.search("{"))+e.substring(e.search("}>")+1,e.length);return t!==t.toLowerCase()})(o)&&u.errors.snapshotName.push(s.translate("xpack.snapshotRestore.policyValidation.snapshotNameLowerCaseErrorMessage",{defaultMessage:"Snapshot name needs to be lowercase."})),V(i)&&u.errors.schedule.push(s.translate("xpack.snapshotRestore.policyValidation.scheduleRequiredErrorMessage",{defaultMessage:"Schedule is required."})),(V(r)||p)&&u.errors.repository.push(s.translate("xpack.snapshotRestore.policyValidation.repositoryRequiredErrorMessage",{defaultMessage:"Repository is required."})),c&&n&&"string"==typeof n.indices&&0===n.indices.trim().length&&u.errors.indices.push(s.translate("xpack.snapshotRestore.policyValidation.indexPatternRequiredErrorMessage",{defaultMessage:"At least one index pattern is required."})),c&&n&&Array.isArray(n.indices)&&0===n.indices.length&&u.errors.indices.push(s.translate("xpack.snapshotRestore.policyValidation.indicesRequiredErrorMessage",{defaultMessage:"You must select at least one data stream or index."})),l&&l.minCount&&l.maxCount&&l.minCount>l.maxCount&&u.errors.minCount.push(s.translate("xpack.snapshotRestore.policyValidation.invalidMinCountErrorMessage",{defaultMessage:"Minimum count cannot be greater than maximum count."})),l&&l.expireAfterValue&&l.expireAfterValue<0&&u.errors.expireAfterValue.push(s.translate("xpack.snapshotRestore.policyValidation.invalidNegativeDeleteAfterErrorMessage",{defaultMessage:"Delete after cannot be negative."})),l&&l.minCount&&l.minCount<0&&u.errors.minCount.push(s.translate("xpack.snapshotRestore.policyValidation.invalidNegativeMinCountErrorMessage",{defaultMessage:"Minimum count cannot be negative."})),l&&l.maxCount&&l.maxCount<0&&u.errors.maxCount.push(s.translate("xpack.snapshotRestore.policyValidation.invalidNegativeMaxCountErrorMessage",{defaultMessage:"Maximum count cannot be negative."})),u.errors=Object.entries(u.errors).filter((([e,t])=>t.length>0)).reduce(((e,[t,s])=>(e[t]=s,e)),{}),Object.keys(u.errors).length>0&&(u.isValid=!1),u})(s,t);F(s),S(a)},isEditing:o,currentUrl:a,errors:R.errors,updateCurrentStep:k}),Object(x.jsx)(p.EuiSpacer,{size:"l"}),n?Object(x.jsx)(r.Fragment,null,n,Object(x.jsx)(p.EuiSpacer,{size:"m"})):null,Object(x.jsx)(p.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiFlexGroup,null,g>1?Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiButtonEmpty,{iconType:"arrowLeft",onClick:()=>(()=>{const e=g-1;m(e),O(e-1),l()})(),disabled:!R.isValid},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.backButtonLabel",defaultMessage:"Back"}))):null,g<T?Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiButton,{fill:!0,iconType:"arrowRight",onClick:()=>(()=>{if(!R.isValid)return;const e=g+1;O(Math.max(g,h)),m(e)})(),iconSide:"right",disabled:!R.isValid,"data-test-subj":"nextButton"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.nextButtonLabel",defaultMessage:"Next"}))):null,g===T?Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiButton,{fill:!E,color:E?"warning":"success",iconType:"check",onClick:()=>{R.isValid&&d(M)},isLoading:i,"data-test-subj":"submitButton"},i?Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.savingButtonLabel",defaultMessage:"Saving…"}):o?Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.saveButtonLabel",defaultMessage:"Save policy"}):Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.createButtonLabel",defaultMessage:"Create policy"}))):null)),Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiButtonEmpty,{onClick:()=>c()},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyForm.cancelButtonLabel",defaultMessage:"Cancel"}))))),Object(x.jsx)(p.EuiSpacer,{size:"m"}))},Ke=e=>{let t;try{t=decodeURI(e),t=decodeURIComponent(t)}catch(s){try{t=decodeURIComponent(e)}catch(s){t=e}}return t},Ze=()=>{const e=Object(c.useParams)(),t={};for(const[s,a]of Object.entries(e))a&&(t[s]=Ke(a));return t},Qe={sortField:"startTimeInMillis",sortDirection:"desc",pageIndex:0,pageSize:20},et=e=>({...e,searchField:void 0,searchValue:void 0,searchMatch:void 0,searchOperator:void 0}),tt=({repository:e})=>{const{settings:{client:t,container:s,basePath:a,compress:o,chunkSize:i,readonly:n,locationMode:l,maxRestoreBytesPerSec:c,maxSnapshotBytesPerSec:d}}=e,j=[];return void 0!==t&&j.push({title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.typeAzure.clientLabel",defaultMessage:"Client"}),description:t}),void 0!==s&&j.push({title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.typeAzure.containerLabel",defaultMessage:"Container"}),description:s}),void 0!==a&&j.push({title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.typeAzure.basePathLabel",defaultMessage:"Base path"}),description:a}),void 0!==o&&j.push({title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.typeAzure.compressLabel",defaultMessage:"Snapshot compression"}),description:String(o)}),void 0!==i&&j.push({title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.typeAzure.chunkSizeLabel",defaultMessage:"Chunk size"}),description:String(i)}),void 0!==d&&j.push({title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.typeAzure.maxSnapshotBytesLabel",defaultMessage:"Max snapshot bytes per second"}),description:d}),void 0!==c&&j.push({title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.typeAzure.maxRestoreBytesLabel",defaultMessage:"Max restore bytes per second"}),description:c}),void 0!==n&&j.push({title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.typeAzure.readonlyLabel",defaultMessage:"Read-only"}),description:String(n)}),void 0!==l&&j.push({title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.typeAzure.locationModeLabel",defaultMessage:"Location mode"}),description:l}),j.length?Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.settingsTitle",defaultMessage:"Settings"}))),Object(x.jsx)(p.EuiSpacer,{size:"s"}),Object(x.jsx)(p.EuiDescriptionList,{textStyle:"reverse",listItems:j})):null};s(47),s(48);const st=({repository:{name:e,settings:t}})=>Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.settingsTitle",defaultMessage:"Settings"}))),Object(x.jsx)(p.EuiSpacer,{size:"s"}),Object(x.jsx)(b.c,{mode:"json",theme:"textmate",width:"100%",isReadOnly:!0,value:JSON.stringify(t,null,2),setOptions:{showLineNumbers:!1,tabSize:2,maxLines:1/0},editorProps:{$blockScrolling:1/0},showGutter:!1,minLines:6,"aria-label":a.i18n.translate("xpack.snapshotRestore.repositoryDetails.genericSettingsDescription",{defaultMessage:"Readonly settings for repository '{name}'",values:{name:e}})})),at=({repository:e})=>{const{settings:{location:t,compress:s,chunkSize:a,maxRestoreBytesPerSec:o,maxSnapshotBytesPerSec:i,readonly:n}}=e,l=[{title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.typeFS.locationLabel",defaultMessage:"Location"}),description:t}];return void 0!==s&&l.push({title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.typeFS.compressLabel",defaultMessage:"Snapshot compression"}),description:String(s)}),void 0!==a&&l.push({title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.typeFS.chunkSizeLabel",defaultMessage:"Chunk size"}),description:String(a)}),void 0!==i&&l.push({title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.typeFS.maxSnapshotBytesLabel",defaultMessage:"Max snapshot bytes per second"}),description:i}),void 0!==o&&l.push({title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.typeFS.maxRestoreBytesLabel",defaultMessage:"Max restore bytes per second"}),description:o}),void 0!==n&&l.push({title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.typeFS.readonlyLabel",defaultMessage:"Read-only"}),description:String(n)}),Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.settingsTitle",defaultMessage:"Settings"}))),Object(x.jsx)(p.EuiSpacer,{size:"s"}),Object(x.jsx)(p.EuiDescriptionList,{textStyle:"reverse",listItems:l}))},ot=({repository:e})=>{const{settings:{bucket:t,client:s,basePath:a,compress:o,chunkSize:i,readonly:n,maxRestoreBytesPerSec:l,maxSnapshotBytesPerSec:c}}=e,d=[{title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.typeGCS.bucketLabel",defaultMessage:"Bucket"}),description:t||""}];return void 0!==s&&d.push({title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.typeGCS.clientLabel",defaultMessage:"Client"}),description:s}),void 0!==a&&d.push({title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.typeGCS.basePathLabel",defaultMessage:"Base path"}),description:a}),void 0!==o&&d.push({title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.typeGCS.compressLabel",defaultMessage:"Snapshot compression"}),description:String(o)}),void 0!==i&&d.push({title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.typeGCS.chunkSizeLabel",defaultMessage:"Chunk size"}),description:String(i)}),void 0!==c&&d.push({title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.typeGCS.maxSnapshotBytesLabel",defaultMessage:"Max snapshot bytes per second"}),description:c}),void 0!==l&&d.push({title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.typeGCS.maxRestoreBytesLabel",defaultMessage:"Max restore bytes per second"}),description:l}),void 0!==n&&d.push({title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.typeGCS.readonlyLabel",defaultMessage:"Read-only"}),description:String(n)}),Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.settingsTitle",defaultMessage:"Settings"}))),Object(x.jsx)(p.EuiSpacer,{size:"s"}),Object(x.jsx)(p.EuiDescriptionList,{textStyle:"reverse",listItems:d}))},it=({repository:e})=>{const{settings:t}=e,{uri:s,path:a,loadDefaults:o,compress:i,chunkSize:n,readonly:l,maxSnapshotBytesPerSec:c,maxRestoreBytesPerSec:d,"security.principal":j,...b}=t,g=[{title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.typeHDFS.uriLabel",defaultMessage:"URI"}),description:s||""},{title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.typeHDFS.pathLabel",defaultMessage:"Path"}),description:a||""}];return void 0!==o&&g.push({title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.typeHDFS.loadDefaultsLabel",defaultMessage:"Load defaults"}),description:String(o)}),void 0!==i&&g.push({title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.typeHDFS.compressLabel",defaultMessage:"Snapshot compression"}),description:String(i)}),void 0!==n&&g.push({title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.typeHDFS.chunkSizeLabel",defaultMessage:"Chunk size"}),description:String(n)}),void 0!==c&&g.push({title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.typeHDFS.maxSnapshotBytesLabel",defaultMessage:"Max snapshot bytes per second"}),description:c}),void 0!==d&&g.push({title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.typeHDFS.maxRestoreBytesLabel",defaultMessage:"Max restore bytes per second"}),description:d}),void 0!==l&&g.push({title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.typeHDFS.readonlyLabel",defaultMessage:"Read-only"}),description:String(l)}),void 0!==j&&g.push({title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.typeHDFS.securityPrincipalLabel",defaultMessage:"Security principal"}),description:j}),Object.keys(b).forEach((e=>{g.push({title:Object(x.jsx)(r.Fragment,null,e),description:String(t[e])})})),Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.settingsTitle",defaultMessage:"Settings"}))),Object(x.jsx)(p.EuiSpacer,{size:"s"}),Object(x.jsx)(p.EuiDescriptionList,{textStyle:"reverse",listItems:g}))},rt=({repository:e})=>{const{settings:{url:t}}=e,s=[{title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.typeReadonly.urlLabel",defaultMessage:"URL"}),description:t}];return Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.settingsTitle",defaultMessage:"Settings"}))),Object(x.jsx)(p.EuiSpacer,{size:"s"}),Object(x.jsx)(p.EuiDescriptionList,{textStyle:"reverse",listItems:s}))},nt=({repository:e})=>{const{settings:{bucket:t,client:s,basePath:a,compress:o,chunkSize:i,serverSideEncryption:n,bufferSize:l,cannedAcl:c,storageClass:d,readonly:j,maxRestoreBytesPerSec:b,maxSnapshotBytesPerSec:g}}=e,m=[{title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.typeS3.bucketLabel",defaultMessage:"Bucket"}),description:t||""}];return void 0!==s&&m.push({title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.typeS3.clientLabel",defaultMessage:"Client"}),description:s}),void 0!==a&&m.push({title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.typeS3.basePathLabel",defaultMessage:"Base path"}),description:a}),void 0!==o&&m.push({title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.typeS3.compressLabel",defaultMessage:"Snapshot compression"}),description:String(o)}),void 0!==i&&m.push({title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.typeS3.chunkSizeLabel",defaultMessage:"Chunk size"}),description:String(i)}),void 0!==n&&m.push({title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.typeS3.serverSideEncryptionLabel",defaultMessage:"Server-side encryption"}),description:String(n)}),void 0!==l&&m.push({title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.typeS3.bufferSizeLabel",defaultMessage:"Buffer size"}),description:l}),void 0!==c&&m.push({title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.typeS3.cannedAclLabel",defaultMessage:"Canned ACL"}),description:c}),void 0!==d&&m.push({title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.typeS3.storageClassLabel",defaultMessage:"Storage class"}),description:d}),void 0!==g&&m.push({title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.typeS3.maxSnapshotBytesLabel",defaultMessage:"Max snapshot bytes per second"}),description:g}),void 0!==b&&m.push({title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.typeS3.maxRestoreBytesLabel",defaultMessage:"Max restore bytes per second"}),description:b}),void 0!==j&&m.push({title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.typeS3.readonlyLabel",defaultMessage:"Read-only"}),description:String(j)}),Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.settingsTitle",defaultMessage:"Settings"}))),Object(x.jsx)(p.EuiSpacer,{size:"s"}),Object(x.jsx)(p.EuiDescriptionList,{textStyle:"reverse",listItems:m}))},lt=({repository:e})=>{const{type:t,settings:s}=e;switch(t){case L.g.fs:return Object(x.jsx)(at,{repository:e});case L.g.url:return Object(x.jsx)(rt,{repository:e});case L.g.source:const{delegateType:t}=s,a={...e,type:t};return Object(x.jsx)(lt,{repository:a});case L.g.azure:return Object(x.jsx)(tt,{repository:e});case L.g.gcs:return Object(x.jsx)(ot,{repository:e});case L.g.hdfs:return Object(x.jsx)(it,{repository:e});case L.g.s3:return Object(x.jsx)(nt,{repository:e});default:return Object(x.jsx)(st,{repository:e})}},ct=({repositoryName:e,onClose:t,onRepositoryDeleted:s})=>{const{i18n:a,history:l}=O(),{docLinks:c}=y(),{error:d,data:g}=Object(o.s)(e),[m,h]=Object(r.useState)(void 0),[f,M]=Object(r.useState)(void 0),[F,E]=Object(r.useState)(!1),[S,k]=Object(r.useState)(!1),L=async()=>{E(!0);const{data:t}=await Object(o.y)(e);h(t.verification),E(!1)},T=async()=>{k(!0);const{data:t}=await Object(o.c)(e);M(t.cleanup),k(!1)};Object(r.useEffect)((()=>{h(void 0),E(!1),M(void 0),k(!1)}),[e]);const v=()=>Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.verificationTitle",defaultMessage:"Verification status"}))),m?Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiSpacer,{size:"s"}),Object(x.jsx)(oe,{verificationResults:m}),Object(x.jsx)(p.EuiSpacer,{size:"s"}),Object(x.jsx)(p.EuiTitle,{size:"xs"},Object(x.jsx)("h4",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.verificationDetailsTitle",defaultMessage:"Details"}))),Object(x.jsx)(p.EuiSpacer,{size:"s"}),m?Object(x.jsx)(p.EuiCodeBlock,{language:"json","data-test-subj":"verificationCodeBlock"},JSON.stringify(m.valid?m.response:m.error,null,2)):null,Object(x.jsx)(p.EuiSpacer,{size:"m"}),Object(x.jsx)(p.EuiButton,{onClick:L,color:"primary",isLoading:F},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.verifyButtonLabel",defaultMessage:"Verify repository"}))):Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiSpacer,{size:"m"}),Object(x.jsx)(p.EuiButton,{onClick:L,color:"primary",isLoading:F,"data-test-subj":"verifyRepositoryButton"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.verifyButtonLabel",defaultMessage:"Verify repository"})))),I=()=>Object(x.jsx)(n.a.Fragment,null,Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.cleanupTitle",defaultMessage:"Repository cleanup"}))),Object(x.jsx)(p.EuiSpacer,{size:"s"}),Object(x.jsx)(p.EuiText,{size:"s"},Object(x.jsx)("p",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.cleanupRepositoryMessage",defaultMessage:"You can clean up a repository to delete any unreferenced data from a snapshot. This may provide storage space savings. Note: If you regularly delete snapshots, this functionality will likely not be as beneficial and should be used less frequently."}))),f?Object(x.jsx)(n.a.Fragment,null,Object(x.jsx)(p.EuiSpacer,{size:"s"}),f.cleaned?Object(x.jsx)("div",null,Object(x.jsx)(p.EuiTitle,{size:"xs"},Object(x.jsx)("h4",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.cleanupDetailsTitle",defaultMessage:"Details"}))),Object(x.jsx)(p.EuiCodeBlock,{language:"json","data-test-subj":"cleanupCodeBlock"},JSON.stringify(f.response,null,2))):Object(x.jsx)(b.h,{title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.cleanupErrorTitle",defaultMessage:"Error cleaning repository"}),error:f.error,"data-test-subj":"cleanupError"})):null,Object(x.jsx)(p.EuiSpacer,{size:"m"}),Object(x.jsx)(p.EuiButton,{onClick:T,color:"primary",isLoading:S,"data-test-subj":"cleanupRepositoryButton"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.cleanupButtonLabel",defaultMessage:"Clean up repository"})));return Object(x.jsx)(p.EuiFlyout,{onClose:t,"data-test-subj":"repositoryDetail","aria-labelledby":"srRepositoryDetailsFlyoutTitle",size:"m",maxWidth:550},Object(x.jsx)(p.EuiFlyoutHeader,null,Object(x.jsx)(p.EuiTitle,{size:"m"},Object(x.jsx)("h2",{id:"srRepositoryDetailsFlyoutTitle","data-test-subj":"title"},e))),Object(x.jsx)(p.EuiFlyoutBody,{"data-test-subj":"content"},g?(()=>{const{repository:t,isManagedRepository:s}=g;if(!t)return null;const{type:a}=t;return Object(x.jsx)(r.Fragment,null,s?Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiCallOut,{size:"s",color:"warning",iconType:"iInCircle",title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.managedRepositoryWarningTitle",defaultMessage:"This is a managed repository used by other systems. Any changes you make might affect how these systems operate."})}),Object(x.jsx)(p.EuiSpacer,{size:"l"})):null,Object(x.jsx)(p.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"flexStart"},Object(x.jsx)(p.EuiFlexItem,null,Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.typeTitle",defaultMessage:"Repository type"}))),Object(x.jsx)(p.EuiSpacer,{size:"s"}),Object(x.jsx)("span",{"data-test-subj":"repositoryType"},a===j.e.source?D.a.getRepositoryTypeName(a,t.settings.delegateType):D.a.getRepositoryTypeName(a))),Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiButtonEmpty,{size:"s",flush:"right",href:U(c,a),target:"_blank",iconType:"help","data-test-subj":"documentationLink"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.repositoryTypeDocLink",defaultMessage:"Repository docs"})))),Object(x.jsx)(p.EuiSpacer,{size:"l"}),Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.snapshotsTitle",defaultMessage:"Snapshots"}))),Object(x.jsx)(p.EuiSpacer,{size:"s"}),Object(x.jsx)("span",{"data-test-subj":"snapshotCount"},(()=>{const{snapshots:t}=g;return Number.isInteger(t.count)?0===t.count?Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.zeroSnapshotsDescription",defaultMessage:"Repository has no snapshots"}):Object(x.jsx)(p.EuiLink,Object(Ae.reactRouterNavigate)(l,Object(i.o)(e)),Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.snapshotsDescription",defaultMessage:"{count} {count, plural, one {snapshot} other {snapshots}} found",values:{count:t.count}})):Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.noSnapshotInformationDescription",defaultMessage:"No snapshot information"})})()),Object(x.jsx)(p.EuiSpacer,{size:"l"}),Object(x.jsx)(lt,{repository:t}),Object(x.jsx)(p.EuiHorizontalRule,null),v(),Object(x.jsx)(p.EuiHorizontalRule,null),I())})():d?(()=>{const t=404===d.status?{data:{error:a.translate("xpack.snapshotRestore.repositoryDetails.repositoryNotFoundErrorMessage",{defaultMessage:"The repository '{name}' does not exist.",values:{name:e}})}}:d;return Object(x.jsx)(b.h,{title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.loadingRepositoryErrorTitle",defaultMessage:"Error loading repository"}),error:t})})():Object(x.jsx)(ce,null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.loadingRepositoryDescription",defaultMessage:"Loading repository…"}))),Object(x.jsx)(p.EuiFlyoutFooter,null,Object(x.jsx)(p.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiButtonEmpty,{iconType:"cross",flush:"left",onClick:t,"data-test-subj":"srRepositoryDetailsFlyoutCloseButton"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.closeButtonLabel",defaultMessage:"Close"}))),g?Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiFlexGroup,{alignItems:"center"},Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(R,null,(t=>Object(x.jsx)(p.EuiButtonEmpty,{color:"danger","data-test-subj":"srRepositoryDetailsDeleteActionButton",onClick:()=>t([e],s),isDisabled:g.isManagedRepository,title:g.isManagedRepository?a.translate("xpack.snapshotRestore.repositoryDetails.removeManagedRepositoryButtonTitle",{defaultMessage:"You cannot delete a managed repository."}):void 0},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.removeButtonLabel",defaultMessage:"Remove"}))))),Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiButton,re()({},Object(Ae.reactRouterNavigate)(l,Object(i.f)(e)),{fill:!0,color:"primary"}),Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryDetails.editButtonLabel",defaultMessage:"Edit"}))))):null)))},pt=({repositories:e,managedRepository:t,reload:s,openRepositoryDetailsUrl:a,onRepositoryDeleted:o})=>{const{i18n:n,uiMetricService:l,history:c}=O(),[d,b]=Object(r.useState)([]),g=[{field:"name",name:n.translate("xpack.snapshotRestore.repositoryList.table.nameColumnTitle",{defaultMessage:"Name"}),truncateText:!0,sortable:!0,render:e=>Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiLink,re()({},Object(Ae.reactRouterNavigate)(c,a(e),(()=>l.trackUiMetric(_.y))),{"data-test-subj":"repositoryLink"}),e),"  ",t===e?Object(x.jsx)(p.EuiIconTip,{content:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryList.table.managedRepositoryBadgeLabel",defaultMessage:"This is a managed repository"}),position:"right"}):null)},{field:"type",name:n.translate("xpack.snapshotRestore.repositoryList.table.typeColumnTitle",{defaultMessage:"Type"}),truncateText:!0,sortable:!0,render:(e,t)=>e===j.e.source?D.a.getRepositoryTypeName(e,t.settings.delegateType):D.a.getRepositoryTypeName(e)},{field:"actions",name:n.translate("xpack.snapshotRestore.repositoryList.table.actionsColumnTitle",{defaultMessage:"Actions"}),actions:[{render:({name:e})=>{const t=n.translate("xpack.snapshotRestore.repositoryList.table.actionEditTooltip",{defaultMessage:"Edit"});return Object(x.jsx)(p.EuiToolTip,{content:t},Object(x.jsx)(p.EuiButtonIcon,re()({"aria-label":n.translate("xpack.snapshotRestore.repositoryList.table.actionEditAriaLabel",{defaultMessage:"Edit repository `{name}`",values:{name:e}}),iconType:"pencil",color:"primary"},Object(Ae.reactRouterNavigate)(c,Object(i.f)(e)),{"data-test-subj":"editRepositoryButton"})))}},{render:({name:e})=>Object(x.jsx)(R,null,(s=>{const a=e!==t?n.translate("xpack.snapshotRestore.repositoryList.table.actionRemoveTooltip",{defaultMessage:"Remove"}):n.translate("xpack.snapshotRestore.repositoryList.table.deleteManagedRepositoryTooltip",{defaultMessage:"You cannot delete a managed repository."});return Object(x.jsx)(p.EuiToolTip,{content:a},Object(x.jsx)(p.EuiButtonIcon,{"aria-label":n.translate("xpack.snapshotRestore.repositoryList.table.actionRemoveAriaLabel",{defaultMessage:"Remove repository `{name}`",values:{name:e}}),iconType:"trash",color:"danger","data-test-subj":"deleteRepositoryButton",onClick:()=>s([e],o),isDisabled:Boolean(e===t)}))}))}],width:"100px"}],m={onSelectionChange:e=>b(e),selectable:({name:e})=>Boolean(e!==t),selectableMessage:e=>e?"":n.translate("xpack.snapshotRestore.repositoryList.table.deleteManagedRepositoryTooltip",{defaultMessage:"You cannot delete a managed repository."})},h={toolsLeft:d.length?Object(x.jsx)(R,null,(e=>Object(x.jsx)(p.EuiButton,{onClick:()=>e(d.map((e=>e.name)),o),color:"danger","data-test-subj":"srRepositoryListBulkDeleteActionButton"},1===d.length?Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryList.table.deleteSingleRepositoryButton",defaultMessage:"Remove repository"}):Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryList.table.deleteMultipleRepositoriesButton",defaultMessage:"Remove repositories"})))):void 0,toolsRight:[Object(x.jsx)(p.EuiButton,{key:"reloadButton",color:"success",iconType:"refresh",onClick:s,"data-test-subj":"reloadButton"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryList.table.reloadRepositoriesButton",defaultMessage:"Reload"})),Object(x.jsx)(p.EuiButton,re()({key:"registerRepo"},Object(Ae.reactRouterNavigate)(c,Object(i.d)(name)),{fill:!0,iconType:"plusInCircle","data-test-subj":"registerRepositoryButton"}),Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryList.addRepositoryButtonLabel",defaultMessage:"Register repository"}))],box:{incremental:!0,schema:!0},filters:[{type:"field_value_selection",field:"type",name:n.translate("xpack.snapshotRestore.repositoryList.table.typeFilterLabel",{defaultMessage:"Type"}),multiSelect:!1,options:Object.keys(e.reduce(((e,t)=>(e[t.type]=!0,e)),{})).map((e=>({value:e,view:D.a.getRepositoryTypeName(e)})))}]};return Object(x.jsx)(p.EuiInMemoryTable,{items:e,itemId:"name",columns:g,search:h,sorting:{sort:{field:"name",direction:"asc"}},selection:m,pagination:{initialPageSize:20,pageSizeOptions:[10,20,50]},isSelectable:!0,rowProps:()=>({"data-test-subj":"row"}),cellProps:(e,t)=>({"data-test-subj":`${t.name}_cell`}),"data-test-subj":"repositoryTable"})},ut=({history:e})=>{const{repositoryName:t}=Ze(),{error:s,isLoading:a,data:{repositories:l,managedRepository:c}={repositories:void 0,managedRepository:{name:void 0}},resendRequest:d}=Object(o.r)(),{uiMetricService:j}=O(),{core:g}=h(),m=()=>{e.push(`${_.a}/repositories`)},y=e=>{t&&e.includes(t)&&m(),e.length&&d()};let f;return Object(r.useEffect)((()=>{j.trackUiMetric(_.x)}),[j]),Object(b.m)(g.executionContext,{type:"application",page:"snapshotRestoreRepositoryTab"}),f=a?Object(x.jsx)(b.g,null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryList.loadingRepositoriesDescription",defaultMessage:"Loading repositories…"})):s?Object(x.jsx)(b.f,{title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryList.LoadingRepositoriesErrorMessage",defaultMessage:"Error loading repositories"}),error:s}):l&&0===l.length?Object(x.jsx)(p.EuiPageContent_Deprecated,{hasShadow:!1,paddingSize:"none",verticalPosition:"center",horizontalPosition:"center"},Object(x.jsx)(p.EuiEmptyPrompt,{iconType:"managementApp",title:Object(x.jsx)("h1",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryList.emptyPromptTitle",defaultMessage:"Register your first repository"})),body:Object(x.jsx)(r.Fragment,null,Object(x.jsx)("p",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryList.emptyPromptDescription",defaultMessage:"Create a place where your snapshots will live."}))),actions:Object(x.jsx)(p.EuiButton,re()({},Object(Ae.reactRouterNavigate)(e,Object(i.d)()),{fill:!0,iconType:"plusInCircle","data-test-subj":"registerRepositoryButton"}),Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.addRepositoryButtonLabel",defaultMessage:"Register a repository"})),"data-test-subj":"emptyPrompt"})):Object(x.jsx)("section",{"data-test-subj":"repositoryList"},Object(x.jsx)(pt,{repositories:l||[],managedRepository:null==c?void 0:c.name,reload:d,openRepositoryDetailsUrl:e=>Object(i.k)(e),onRepositoryDeleted:y})),Object(x.jsx)(n.a.Fragment,null,t?Object(x.jsx)(ct,{repositoryName:t,onClose:m,onRepositoryDeleted:y}):null,f)};var dt=s(39);const jt=({state:e})=>{const{i18n:t}=O(),s={[_.h.IN_PROGRESS]:{icon:Object(x.jsx)(p.EuiLoadingSpinner,{size:"m"}),label:t.translate("xpack.snapshotRestore.snapshotState.inProgressLabel",{defaultMessage:"Taking snapshot…"})},[_.h.SUCCESS]:{icon:Object(x.jsx)(p.EuiIcon,{color:"success",type:"check"}),label:t.translate("xpack.snapshotRestore.snapshotState.completeLabel",{defaultMessage:"Snapshot complete"})},[_.h.FAILED]:{icon:Object(x.jsx)(p.EuiIcon,{color:"danger",type:"cross"}),label:t.translate("xpack.snapshotRestore.snapshotState.failedLabel",{defaultMessage:"Snapshot failed"})},[_.h.PARTIAL]:{icon:Object(x.jsx)(p.EuiIcon,{color:"warning",type:"alert"}),label:t.translate("xpack.snapshotRestore.snapshotState.partialLabel",{defaultMessage:"Partial failure"}),tip:t.translate("xpack.snapshotRestore.snapshotState.partialTipDescription",{defaultMessage:"Global cluster state was stored, but at least one shard wasn't stored successfully. See the 'Failed indices' tab."})},[_.h.INCOMPATIBLE]:{icon:Object(x.jsx)(p.EuiIcon,{color:"warning",type:"alert"}),label:t.translate("xpack.snapshotRestore.snapshotState.incompatibleLabel",{defaultMessage:"Incompatible version"}),tip:t.translate("xpack.snapshotRestore.snapshotState.incompatibleTipDescription",{defaultMessage:"Snapshot was created with a version of Elasticsearch incompatible with the cluster's version."})}};if(!s[e])return e;const{icon:a,label:o,tip:i}=s[e],n=i&&Object(x.jsx)(r.Fragment,null," ",Object(x.jsx)(p.EuiIconTip,{content:i}));return Object(x.jsx)(p.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",responsive:!1},Object(x.jsx)(p.EuiFlexItem,{grow:!1},a),Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)("div",null,o,n)))},bt=({snapshotDetails:e})=>{const{versionId:t,version:s,includeGlobalState:a,featureStates:o,dataStreams:r,indices:n,state:l,startTimeInMillis:c,endTimeInMillis:d,durationInMillis:j,uuid:b,policyName:g}=e,{history:m}=O();return Object(x.jsx)(p.EuiDescriptionList,{textStyle:"reverse"},Object(x.jsx)(p.EuiFlexGroup,null,Object(x.jsx)(p.EuiFlexItem,{"data-test-subj":"version"},Object(x.jsx)(p.EuiDescriptionListTitle,{"data-test-subj":"title"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.snapshotDetails.itemVersionLabel",defaultMessage:"Version / Version ID"})),Object(x.jsx)(p.EuiDescriptionListDescription,{className:"eui-textBreakWord","data-test-subj":"value"},s," / ",t)),Object(x.jsx)(p.EuiFlexItem,{"data-test-subj":"uuid"},Object(x.jsx)(p.EuiDescriptionListTitle,{"data-test-subj":"title"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.snapshotDetails.itemUuidLabel",defaultMessage:"UUID"})),Object(x.jsx)(p.EuiDescriptionListDescription,{className:"eui-textBreakWord","data-test-subj":"value"},b))),Object(x.jsx)(p.EuiFlexGroup,null,Object(x.jsx)(p.EuiFlexItem,{"data-test-subj":"state"},Object(x.jsx)(p.EuiDescriptionListTitle,{"data-test-subj":"title"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.snapshotDetails.itemStateLabel",defaultMessage:"State"})),Object(x.jsx)(p.EuiDescriptionListDescription,{className:"eui-textBreakWord","data-test-subj":"value"},Object(x.jsx)(jt,{state:l}))),Object(x.jsx)(p.EuiFlexItem,{"data-test-subj":"duration"},Object(x.jsx)(p.EuiDescriptionListTitle,{"data-test-subj":"title"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.snapshotDetails.itemDurationLabel",defaultMessage:"Duration"})),Object(x.jsx)(p.EuiDescriptionListDescription,{className:"eui-textBreakWord","data-test-subj":"value"},l===_.h.IN_PROGRESS?Object(x.jsx)(p.EuiLoadingSpinner,{size:"m"}):Object(x.jsx)(F,{data:j},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.snapshotDetails.itemDurationValueLabel","data-test-subj":"srSnapshotDetailsDurationValue",defaultMessage:"{seconds} {seconds, plural, one {second} other {seconds}}",values:{seconds:Math.ceil(j/1e3)}}))))),Object(x.jsx)(p.EuiFlexGroup,null,Object(x.jsx)(p.EuiFlexItem,{"data-test-subj":"includeGlobalState"},Object(x.jsx)(p.EuiDescriptionListTitle,{"data-test-subj":"title"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.snapshotDetails.itemIncludeGlobalStateLabel",defaultMessage:"Includes global state"})),Object(x.jsx)(p.EuiDescriptionListDescription,{className:"eui-textBreakWord","data-test-subj":"value"},!1===a?Object(x.jsx)(u.FormattedMessage,{"data-test-subj":"withoutGlobalState",id:"xpack.snapshotRestore.snapshotDetails.itemIncludeGlobalStateNoLabel",defaultMessage:"No"}):Object(x.jsx)(u.FormattedMessage,{"data-test-subj":"withGlobalState",id:"xpack.snapshotRestore.snapshotDetails.itemIncludeGlobalStateYesLabel",defaultMessage:"Yes"}))),Object(x.jsx)(Te,{featureStates:o})),Object(x.jsx)(p.EuiFlexGroup,null,Object(x.jsx)(p.EuiFlexItem,{"data-test-subj":"indices"},Object(x.jsx)(p.EuiDescriptionListTitle,{"data-test-subj":"title"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.snapshotDetails.itemIndicesLabel",defaultMessage:"Indices ({indicesCount})",values:{indicesCount:n.length}})),Object(x.jsx)(p.EuiDescriptionListDescription,{className:"eui-textBreakWord","data-test-subj":"value"},Object(x.jsx)(Re,{indices:n})))),Object(x.jsx)(p.EuiFlexGroup,null,Object(x.jsx)(p.EuiFlexItem,{"data-test-subj":"dataStreams"},Object(x.jsx)(p.EuiDescriptionListTitle,{"data-test-subj":"title"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.snapshotDetails.itemDataStreamsLabel",defaultMessage:"Data streams ({dataStreamsCount})",values:{dataStreamsCount:r.length}})),Object(x.jsx)(p.EuiDescriptionListDescription,{className:"eui-textBreakWord","data-test-subj":"value"},Object(x.jsx)(Se,{dataStreams:r})))),Object(x.jsx)(p.EuiFlexGroup,null,Object(x.jsx)(p.EuiFlexItem,{"data-test-subj":"startTime"},Object(x.jsx)(p.EuiDescriptionListTitle,{"data-test-subj":"title"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.snapshotDetails.itemStartTimeLabel",defaultMessage:"Start time"})),Object(x.jsx)(p.EuiDescriptionListDescription,{className:"eui-textBreakWord","data-test-subj":"value"},Object(x.jsx)(F,{data:c},Object(x.jsx)(E,{epochMs:c})))),Object(x.jsx)(p.EuiFlexItem,{"data-test-subj":"endTime"},Object(x.jsx)(p.EuiDescriptionListTitle,{"data-test-subj":"title"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.snapshotDetails.itemEndTimeLabel",defaultMessage:"End time"})),Object(x.jsx)(p.EuiDescriptionListDescription,{className:"eui-textBreakWord","data-test-subj":"value"},l===_.h.IN_PROGRESS?Object(x.jsx)(p.EuiLoadingSpinner,{size:"m"}):Object(x.jsx)(F,{data:d},Object(x.jsx)(E,{epochMs:d}))))),Object(x.jsx)(p.EuiFlexGroup,null,g?Object(x.jsx)(p.EuiFlexItem,{"data-test-subj":"policy"},Object(x.jsx)(p.EuiDescriptionListTitle,{"data-test-subj":"title"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.snapshotDetails.createdByLabel",defaultMessage:"Created by"})),Object(x.jsx)(p.EuiDescriptionListDescription,{className:"eui-textBreakWord","data-test-subj":"value"},Object(x.jsx)(p.EuiLink,Object(Ae.reactRouterNavigate)(m,Object(i.i)(g)),g))):null))},xt=({indexFailures:e,snapshotState:t})=>e.length?e.map(((t,s)=>{const{index:a,failures:o}=t;return Object(x.jsx)("div",{key:a,"data-test-subj":"indexFailure"},Object(x.jsx)(p.EuiTitle,{size:"xs","data-test-subj":"index"},Object(x.jsx)("h3",null,a)),Object(x.jsx)(p.EuiSpacer,{size:"s"}),o.map(((e,t)=>{const{status:s,reason:a,shard_id:i}=e;return Object(x.jsx)("div",{key:`${i}${a}`,"data-test-subj":"failure"},Object(x.jsx)(p.EuiText,{size:"xs","data-test-subj":"shard"},Object(x.jsx)("p",null,Object(x.jsx)("strong",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.snapshotDetails.failureShardTitle",defaultMessage:"Shard {shardId}",values:{shardId:i}})))),Object(x.jsx)(p.EuiCodeBlock,{paddingSize:"s","data-test-subj":"reason",language:"text"},`${s}: ${a}`),t<o.length-1?Object(x.jsx)(p.EuiSpacer,{size:"s"}):void 0)})),s<e.length-1?Object(x.jsx)(p.EuiSpacer,{size:"l"}):void 0)})):t===_.h.IN_PROGRESS?Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.snapshotDetails.snapshotIsBeingCreatedMessage",defaultMessage:"Snapshot is being created."}):Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.snapshotDetails.noIndexFailuresMessage",defaultMessage:"All indices were stored successfully."}),gt="summary",mt="failures",ht={[gt]:_.I,[mt]:_.H},Ot=({repositoryName:e,snapshotId:t,onClose:s,onSnapshotDeleted:a})=>{const{i18n:n,uiMetricService:l,history:c}=O(),{error:d,data:j}=Object(o.w)(e,t),[g,m]=Object(r.useState)(gt);let h,y;if(Object(r.useEffect)((()=>{m(gt)}),[e,t]),j){const{indexFailures:e,state:t}=j,s=[{id:gt,name:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.snapshotDetails.summaryTabTitle",defaultMessage:"Summary"})},{id:mt,name:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.snapshotDetails.failuresTabTitle",defaultMessage:"Failed indices ({failuresCount})",values:{failuresCount:e.length}})}];h=Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiSpacer,{size:"s"}),Object(x.jsx)(p.EuiTabs,null,s.map((e=>Object(x.jsx)(p.EuiTab,{onClick:()=>{l.trackUiMetric(ht[e.id]),m(e.id)},isSelected:e.id===g,key:e.id,"data-test-subj":"tab"},e.name))))),g===gt?y=Object(x.jsx)(bt,{snapshotDetails:j}):g===mt&&(y=Object(x.jsx)(xt,{snapshotState:t,indexFailures:e}))}else if(d){const s=404===d.status?{data:{error:n.translate("xpack.snapshotRestore.snapshotDetails.errorSnapshotNotFound",{defaultMessage:"Either the snapshot '{snapshotId}' doesn't exist in the repository '{repositoryName}' or the repository doesn't exist.",values:{snapshotId:t,repositoryName:e}})}}:d;y=Object(x.jsx)(b.h,{title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.snapshotDetails.errorLoadingRepositoryTitle",defaultMessage:"Error loading repository"}),error:s})}else y=Object(x.jsx)(ce,null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.snapshotDetails.loadingSnapshotDescription",defaultMessage:"Loading snapshot…"}));return Object(x.jsx)(p.EuiFlyout,{onClose:s,"data-test-subj":"snapshotDetail","aria-labelledby":"srSnapshotDetailsFlyoutTitle",size:"m",maxWidth:550},Object(x.jsx)(p.EuiFlyoutHeader,null,Object(x.jsx)(p.EuiText,null,Object(x.jsx)("h2",{id:"srSnapshotDetailsFlyoutTitle","data-test-subj":"detailTitle"},t),Object(x.jsx)("p",null,Object(x.jsx)("small",null,Object(x.jsx)(p.EuiLink,re()({},Object(Ae.reactRouterNavigate)(c,Object(i.k)(e)),{"data-test-subj":"repositoryLink"}),Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.snapshotDetails.repositoryTitle",defaultMessage:"'{repositoryName}' repository",values:{repositoryName:e}}))))),h),Object(x.jsx)(p.EuiFlyoutBody,{"data-test-subj":"content"},y),Object(x.jsx)(p.EuiFlyoutFooter,null,Object(x.jsx)(p.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiButtonEmpty,{iconType:"cross",flush:"left",onClick:s,"data-test-subj":"closeButton"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.snapshotDetails.closeButtonLabel",defaultMessage:"Close"}))),j?Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiFlexGroup,{alignItems:"center"},Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(ue,null,(s=>Object(x.jsx)(p.EuiButtonEmpty,{color:"danger","data-test-subj":"srSnapshotDetailsDeleteActionButton",onClick:()=>s([{repository:e,snapshot:t}],a),isDisabled:j.managedRepository&&j.isLastSuccessfulSnapshot,title:j.managedRepository&&j.isLastSuccessfulSnapshot?n.translate("xpack.snapshotRestore.snapshotDetails.deleteManagedRepositorySnapshotButtonTitle",{defaultMessage:"You cannot delete the last successful snapshot stored in a managed repository."}):void 0},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.snapshotDetails.deleteButtonLabel",defaultMessage:"Delete"}))))),Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiButton,re()({},Object(Ae.reactRouterNavigate)(c,Object(i.l)(e,t)),{fill:!0,color:"primary",isDisabled:j.state!==_.h.SUCCESS&&j.state!==_.h.PARTIAL}),Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.snapshotDetails.restoreButtonLabel",defaultMessage:"Restore"}))))):null)))};var yt=s(52),ft=s.n(yt);const Mt=a.i18n.translate("xpack.snapshotRestore.snapshotList.searchBar.onlyOneClauseMessage",{defaultMessage:"You can only use one clause in the search bar"}),Ft={strict:!0,fields:{snapshot:{type:"string"},repository:{type:"string"},policyName:{type:"string"}}},Et=({listParams:e,setListParams:t,reload:s,selectedItems:o,onSnapshotDeleted:i,repositories:l})=>{const[c,d]=Object(r.useState)(e);ft()((()=>{t(c)}),200,[c]);const j=o.length?Object(x.jsx)(ue,null,(e=>Object(x.jsx)(p.EuiButton,{onClick:()=>e(o.map((({snapshot:e,repository:t})=>({snapshot:e,repository:t}))),i),color:"danger","data-test-subj":"srSnapshotListBulkDeleteActionButton"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.snapshotList.table.deleteSnapshotButton",defaultMessage:"Delete {count, plural, one {snapshot} other {snapshots}}",values:{count:o.length}})))):[],b=[{type:"field_value_selection",field:"repository",name:a.i18n.translate("xpack.snapshotRestore.snapshotList.table.repositoryFilterLabel",{defaultMessage:"Repository"}),operator:"exact",multiSelect:!1,options:l.map((e=>({value:e,view:e})))}],g=Object(x.jsx)(p.EuiButton,{color:"success",iconType:"refresh",onClick:s,"data-test-subj":"reloadButton"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.snapshotList.table.reloadSnapshotsButton",defaultMessage:"Reload"})),[m,h]=Object(r.useState)(((e,t)=>{const{searchField:s,searchValue:a}=e;return s&&a?p.Query.parse(`${s}=${a}`,{schema:t}):p.Query.MATCH_ALL})(e,Ft)),[O,y]=Object(r.useState)(null);return Object(x.jsx)(n.a.Fragment,null,Object(x.jsx)(p.EuiSearchBar,{filters:b,query:m,onChange:t=>{const{query:s,error:a}=t;a?y(a):s&&(y(null),h(s),s.ast.clauses.length>1?y({name:Mt,message:Mt}):d(((e,t)=>{if(!t)return et(e);const s=t.ast.clauses[0];return s?"term"===s.type?{...e,searchField:"snapshot",searchValue:String(s.value),searchMatch:s.match,searchOperator:"eq"}:"field"===s.type?{...e,searchField:s.field,searchValue:String(s.value),searchMatch:s.match,searchOperator:s.operator}:et(e):et(e)})(e,s)))},toolsLeft:j,toolsRight:g,box:{schema:Ft,incremental:!0,"data-test-subj":"snapshotListSearch"}}),Object(x.jsx)(p.EuiSpacer,null),O?Object(x.jsx)(n.a.Fragment,null,Object(x.jsx)(p.EuiCallOut,{"data-test-subj":"snapshotListSearchError",iconType:"alert",color:"danger",title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.snapshotList.searchBar.invalidSearchMessage",defaultMessage:"Invalid search: {errorMessage}",values:{errorMessage:O.message}})}),Object(x.jsx)(p.EuiSpacer,null)):null)},Rt=e=>{const{snapshots:t,repositories:s,reload:a,onSnapshotDeleted:o,listParams:l,setListParams:c,totalItemCount:d,isLoading:j}=e,{i18n:g,uiMetricService:m,history:h}=O(),[y,f]=Object(r.useState)([]),M=(e=>e.filter((({state:e,repository:t,managedRepository:s})=>t===s&&"SUCCESS"===e)).sort(((e,t)=>+new Date(t.endTime)-+new Date(e.endTime)))[0])(t),R=[{field:"snapshot",name:g.translate("xpack.snapshotRestore.snapshotList.table.snapshotColumnTitle",{defaultMessage:"Snapshot"}),truncateText:!1,sortable:!0,render:(e,t)=>Object(x.jsx)(p.EuiLink,re()({},Object(b.j)(h,Object(i.n)(t.repository,e),(()=>m.trackUiMetric(_.K))),{"data-test-subj":"snapshotLink"}),e)},{field:"repository",name:g.translate("xpack.snapshotRestore.snapshotList.table.repositoryColumnTitle",{defaultMessage:"Repository"}),truncateText:!1,sortable:!0,render:e=>Object(x.jsx)(p.EuiLink,re()({},Object(b.j)(h,Object(i.k)(e)),{"data-test-subj":"repositoryLink"}),e)},{field:"indices",name:g.translate("xpack.snapshotRestore.snapshotList.table.indicesColumnTitle",{defaultMessage:"Indices"}),truncateText:!0,sortable:!0,width:"100px",render:e=>e.length},{field:"shards.total",name:g.translate("xpack.snapshotRestore.snapshotList.table.shardsColumnTitle",{defaultMessage:"Shards"}),truncateText:!0,sortable:!0,width:"100px",render:e=>e},{field:"shards.failed",name:g.translate("xpack.snapshotRestore.snapshotList.table.failedShardsColumnTitle",{defaultMessage:"Failed shards"}),truncateText:!0,sortable:!0,width:"100px",render:e=>e},{field:"startTimeInMillis",name:g.translate("xpack.snapshotRestore.snapshotList.table.startTimeColumnTitle",{defaultMessage:"Date created"}),truncateText:!1,sortable:!0,render:e=>Object(x.jsx)(F,{data:e},Object(x.jsx)(E,{epochMs:e}))},{field:"durationInMillis",name:g.translate("xpack.snapshotRestore.snapshotList.table.durationColumnTitle",{defaultMessage:"Duration"}),truncateText:!0,sortable:!0,width:"100px",render:(e,{state:t})=>t===_.h.IN_PROGRESS?Object(x.jsx)(p.EuiLoadingSpinner,{size:"m"}):Object(x.jsx)(F,{data:e},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.snapshotList.table.durationColumnValueLabel",defaultMessage:"{seconds}s",values:{seconds:Math.ceil(e/1e3)}}))},{name:g.translate("xpack.snapshotRestore.snapshotList.table.actionsColumnTitle",{defaultMessage:"Actions"}),actions:[{render:({snapshot:e,repository:t,state:s})=>{const a=s===_.h.SUCCESS||s===_.h.PARTIAL,o=a?g.translate("xpack.snapshotRestore.snapshotList.table.actionRestoreTooltip",{defaultMessage:"Restore"}):s===_.h.IN_PROGRESS?g.translate("xpack.snapshotRestore.snapshotList.table.actionRestoreDisabledInProgressTooltip",{defaultMessage:"Can't restore in-progress snapshot"}):g.translate("xpack.snapshotRestore.snapshotList.table.actionRestoreDisabledInvalidTooltip",{defaultMessage:"Can't restore invalid snapshot"});return Object(x.jsx)(p.EuiToolTip,{content:o},Object(x.jsx)(p.EuiButtonIcon,re()({"aria-label":g.translate("xpack.snapshotRestore.snapshotList.table.actionRestoreAriaLabel",{defaultMessage:"Store snapshot `{name}`",values:{name:e}}),iconType:"importAction",color:"primary","data-test-subj":"srsnapshotListRestoreActionButton"},Object(b.j)(h,Object(i.l)(t,e)),{isDisabled:!a})))}},{render:({snapshot:e,repository:t})=>Object(x.jsx)(ue,null,(s=>{const a=!!Boolean(M)&&e===M.snapshot,i=a?g.translate("xpack.snapshotRestore.snapshotList.table.deleteManagedRepositorySnapshotTooltip",{defaultMessage:"You must store the last successful snapshot in a managed repository."}):g.translate("xpack.snapshotRestore.snapshotList.table.actionDeleteTooltip",{defaultMessage:"Delete"});return Object(x.jsx)(p.EuiToolTip,{content:i},Object(x.jsx)(p.EuiButtonIcon,{"aria-label":g.translate("xpack.snapshotRestore.snapshotList.table.actionDeleteAriaLabel",{defaultMessage:"Delete snapshot '{name}'",values:{name:e}}),iconType:"trash",color:"danger","data-test-subj":"srsnapshotListDeleteActionButton",onClick:()=>s([{snapshot:e,repository:t}],o),isDisabled:a}))}))}],width:"100px"}],S={sort:{field:l.sortField,direction:l.sortDirection}},k={pageIndex:l.pageIndex,pageSize:l.pageSize,totalItemCount:d,pageSizeOptions:[10,20,50]},L={onSelectionChange:e=>f(e),selectable:({snapshot:e})=>!Boolean(M)||e!==M.snapshot,selectableMessage:e=>e?"":g.translate("xpack.snapshotRestore.snapshotList.table.deleteManagedRepositorySnapshotDescription",{defaultMessage:"You must retain the last successful snapshot in a managed repository."})};return Object(x.jsx)(n.a.Fragment,null,Object(x.jsx)(Et,{listParams:l,setListParams:c,reload:a,selectedItems:y,onSnapshotDeleted:o,repositories:s}),Object(x.jsx)(p.EuiBasicTable,{items:t,itemId:"uuid",columns:R,sorting:S,onChange:e=>{var t,s;const{page:{index:a,size:o}={},sort:{field:i,direction:r}={}}=e;c({...l,sortField:null!==(t=i)&&void 0!==t?t:l.sortField,sortDirection:null!==(s=r)&&void 0!==s?s:l.sortDirection,pageIndex:null!=a?a:l.pageIndex,pageSize:null!=o?o:l.pageSize})},loading:j,isSelectable:!0,selection:L,pagination:k,rowProps:()=>({"data-test-subj":"row"}),cellProps:()=>({"data-test-subj":"cell"}),"data-test-subj":"snapshotTable"}))},St=()=>{const e=Object(c.useHistory)();return Object(x.jsx)(p.EuiPageContent_Deprecated,{verticalPosition:"center",horizontalPosition:"center",color:"danger"},Object(x.jsx)(p.EuiEmptyPrompt,{iconType:"managementApp","data-test-subj":"repositoryErrorsPrompt",title:Object(x.jsx)("h1",{"data-test-subj":"title"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.snapshotList.emptyPrompt.errorRepositoriesTitle",defaultMessage:"Some repositories contain errors"})),body:Object(x.jsx)("p",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.snapshotList.emptyPrompt.repositoryWarningDescription",defaultMessage:"Go to {repositoryLink} to fix the errors.",values:{repositoryLink:Object(x.jsx)(p.EuiLink,Object(b.j)(e,Object(i.j)()),Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryWarningLinkText",defaultMessage:"Repositories"}))}}))}))},kt=()=>{const e=Object(c.useHistory)();return Object(x.jsx)(p.EuiPageContent_Deprecated,{hasShadow:!1,paddingSize:"none",verticalPosition:"center",horizontalPosition:"center","data-test-subj":"snapshotListEmpty"},Object(x.jsx)(p.EuiEmptyPrompt,{iconType:"managementApp",title:Object(x.jsx)("h1",{"data-test-subj":"title"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.snapshotList.emptyPrompt.noRepositoriesTitle",defaultMessage:"Start by registering a repository"})),body:Object(x.jsx)(n.a.Fragment,null,Object(x.jsx)("p",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.snapshotList.emptyPrompt.noRepositoriesDescription",defaultMessage:"You need a place where your snapshots will live."})),Object(x.jsx)("p",null,Object(x.jsx)(p.EuiButton,re()({},Object(b.j)(e,Object(i.d)()),{fill:!0,iconType:"plusInCircle","data-test-subj":"registerRepositoryButton"}),Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.snapshotList.emptyPrompt.noRepositoriesAddButtonLabel",defaultMessage:"Register a repository"})))),"data-test-subj":"emptyPrompt"}))},Lt=({policiesCount:e})=>{const{docLinks:t}=y(),s=Object(c.useHistory)();return Object(x.jsx)(p.EuiPageContent_Deprecated,{hasShadow:!1,paddingSize:"none",verticalPosition:"center",horizontalPosition:"center"},Object(x.jsx)(p.EuiEmptyPrompt,{iconType:"managementApp",title:Object(x.jsx)("h1",{"data-test-subj":"title"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.snapshotList.emptyPrompt.noSnapshotsTitle",defaultMessage:"You don't have any snapshots yet"})),body:Object(x.jsx)(b.i,{privileges:j.d.map((e=>`cluster.${e}`))},(({hasPrivileges:a})=>a?Object(x.jsx)(r.Fragment,null,Object(x.jsx)("p",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.snapshotList.emptyPrompt.usePolicyDescription",defaultMessage:"Run a Snapshot Lifecycle Policy to create a snapshot. You can also create a snapshot using {docLink}.",values:{docLink:Object(x.jsx)(p.EuiLink,{href:t.links.snapshotRestore.createSnapshot,target:"_blank","data-test-subj":"documentationLink"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.emptyPrompt.usePolicyDocLinkText",defaultMessage:"the Elasticsearch API"}))}})),Object(x.jsx)("p",null,0===e?Object(x.jsx)(p.EuiButton,re()({},Object(b.j)(s,Object(i.c)()),{fill:!0,iconType:"plusInCircle","data-test-subj":"addPolicyButton"}),Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.snapshotList.emptyPrompt.addPolicyText",defaultMessage:"Create a policy"})):Object(x.jsx)(p.EuiButton,re()({},Object(b.j)(s,Object(i.h)()),{fill:!0,iconType:"list","data-test-subj":"goToPoliciesButton"}),Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.snapshotList.emptyPrompt.goToPoliciesText",defaultMessage:"View policies"})))):Object(x.jsx)(r.Fragment,null,Object(x.jsx)("p",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.snapshotList.emptyPrompt.noSnapshotsDescription",defaultMessage:"Create a snapshot using the Elasticsearch API."})),Object(x.jsx)("p",null,Object(x.jsx)(p.EuiLink,{href:t.links.snapshotRestore.createSnapshot,target:"_blank","data-test-subj":"documentationLink"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.emptyPrompt.noSnapshotsDocLinkText",defaultMessage:"Learn how to create a snapshot"})," ",Object(x.jsx)(p.EuiIcon,{type:"link"})))))),"data-test-subj":"emptyPrompt"}))},Tt=({location:{search:e},history:t})=>{const{repositoryName:s,snapshotId:a}=Ze(),[l,c]=Object(r.useState)(Qe),{error:d,isInitialRequest:j,isLoading:g,data:{snapshots:m=[],repositories:y=[],policies:f=[],errors:M={},total:F},resendRequest:E}=Object(o.x)(l),{uiMetricService:R}=O(),{core:S}=h(),k=()=>{t.push(`${_.a}/snapshots`)},L=e=>{s&&a&&e.find((({snapshot:e,repository:t})=>e===a&&t===s))&&k(),e.length&&E()};let T;if(Object(b.m)(S.executionContext,{type:"application",page:"snapshotRestoreSnapshotTab"}),Object(r.useEffect)((()=>{if(e){const s=Object(dt.parse)(e.replace(/^\?/,""),{sort:!1}),{repository:a,policy:o}=s;o?(c((e=>({...e,searchField:"policyName",searchValue:String(o),searchMatch:"must",searchOperator:"exact"}))),t.replace(`${_.a}/snapshots`)):a&&(c((e=>({...e,searchField:"repository",searchValue:String(a),searchMatch:"must",searchOperator:"exact"}))),t.replace(`${_.a}/snapshots`))}}),[l,t,e]),Object(r.useEffect)((()=>{R.trackUiMetric(_.J)}),[R]),j&&g)T=Object(x.jsx)(b.g,null,Object(x.jsx)("span",{"data-test-subj":"snapshotListEmpty"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.snapshotList.loadingSnapshotsDescription",defaultMessage:"Loading snapshots…"})));else if(d)T=Object(x.jsx)(b.f,{title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.snapshotList.loadingSnapshotsErrorMessage",defaultMessage:"Error loading snapshots"}),error:d});else if(Object.keys(M).length&&0===y.length)T=Object(x.jsx)(St,null);else if(0===y.length)T=Object(x.jsx)(kt,null);else if(0!==F||l.searchField||g){const e=Object.keys(M).length?Object(x.jsx)(n.a.Fragment,null,Object(x.jsx)(p.EuiCallOut,{title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryWarningTitle",defaultMessage:"Some repositories contain errors"}),color:"warning",iconType:"alert","data-test-subj":"repositoryErrorsWarning"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryWarningDescription",defaultMessage:"Snapshots might load slowly. Go to {repositoryLink} to fix the errors.",values:{repositoryLink:Object(x.jsx)(p.EuiLink,Object(b.j)(t,Object(i.j)()),Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.repositoryWarningLinkText",defaultMessage:"Repositories"}))}})),Object(x.jsx)(p.EuiSpacer,null)):null;T=Object(x.jsx)("section",{"data-test-subj":"snapshotList"},e,Object(x.jsx)(Rt,{snapshots:m,repositories:y,reload:E,onSnapshotDeleted:L,listParams:l,setListParams:c,totalItemCount:F,isLoading:g}))}else T=Object(x.jsx)(Lt,{policiesCount:f.length});return Object(x.jsx)(n.a.Fragment,null,s&&a?Object(x.jsx)(Ot,{repositoryName:s,snapshotId:a,onClose:k,onSnapshotDeleted:L}):null,T)};var vt=s(35);const Dt=({shards:e})=>{const{i18n:t}=O(),s=({total:e,restored:s,percent:a})=>Object(x.jsx)(p.EuiToolTip,{position:"top",content:t.translate("xpack.snapshotRestore.restoreList.shardTable.progressTooltipLabel",{defaultMessage:"{restored} of {total} restored",values:{restored:s,total:e}})},Object(x.jsx)(p.EuiText,{size:"xs",textAlign:"center",style:{width:"100%"}},Object(x.jsx)(p.EuiProgress,{value:0===e?1:s,max:0===e?1:e,size:"xs"}),Object(x.jsx)(p.EuiSpacer,{size:"xs"}),a)),a=[{field:"id",name:t.translate("xpack.snapshotRestore.restoreList.shardTable.indexColumnTitle",{defaultMessage:"ID"}),width:"40px",render:(e,t)=>t.primary?Object(x.jsx)(p.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},Object(x.jsx)(p.EuiFlexItem,{grow:!1},e),Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiToolTip,{position:"right",content:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreList.shardTable.primaryTooltipLabel",defaultMessage:"Primary"})},Object(x.jsx)("strong",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreList.shardTable.primaryAbbreviationText",defaultMessage:"P",description:"Used as an abbreviation for 'Primary', as in 'Primary shard'"}))))):e},{field:"stage",name:t.translate("xpack.snapshotRestore.restoreList.shardTable.stageColumnTitle",{defaultMessage:"Stage"})},{field:"startTimeInMillis",name:t.translate("xpack.snapshotRestore.restoreList.shardTable.startTimeColumnTitle",{defaultMessage:"Start time"}),render:e=>e?Object(x.jsx)(E,{epochMs:e}):Object(x.jsx)(p.EuiLoadingSpinner,{size:"m"})},{field:"stopTimeInMillis",name:t.translate("xpack.snapshotRestore.restoreList.shardTable.endTimeColumnTitle",{defaultMessage:"End time"}),render:e=>e?Object(x.jsx)(E,{epochMs:e}):Object(x.jsx)(p.EuiLoadingSpinner,{size:"m"})},{field:"totalTimeInMillis",name:t.translate("xpack.snapshotRestore.restoreList.shardTable.durationColumnTitle",{defaultMessage:"Duration"}),render:e=>e?Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreList.shardTable.durationValue",defaultMessage:"{seconds} {seconds, plural, one {second} other {seconds}}",values:{seconds:Math.ceil(e/1e3)}}):Object(x.jsx)(p.EuiLoadingSpinner,{size:"m"})},{field:"repository",name:t.translate("xpack.snapshotRestore.restoreList.shardTable.repositoryColumnTitle",{defaultMessage:"Repository"})},{field:"snapshot",name:t.translate("xpack.snapshotRestore.restoreList.shardTable.snapshotColumnTitle",{defaultMessage:"Snapshot"})},{field:"version",name:t.translate("xpack.snapshotRestore.restoreList.shardTable.versionColumnTitle",{defaultMessage:"Version"})},{field:"targetHost",name:t.translate("xpack.snapshotRestore.restoreList.shardTable.targetHostColumnTitle",{defaultMessage:"Target host"})},{field:"targetNode",name:t.translate("xpack.snapshotRestore.restoreList.shardTable.targetNodeColumnTitle",{defaultMessage:"Target node"})},{field:"bytesTotal",name:t.translate("xpack.snapshotRestore.restoreList.shardTable.bytesColumnTitle",{defaultMessage:"Bytes"}),render:(e,{bytesRecovered:t,bytesPercent:a})=>Object(x.jsx)(s,{total:e,restored:t,percent:a})},{field:"filesTotal",name:t.translate("xpack.snapshotRestore.restoreList.shardTable.filesColumnTitle",{defaultMessage:"Files"}),render:(e,{filesRecovered:t,filesPercent:a})=>Object(x.jsx)(s,{total:e,restored:t,percent:a})}];return Object(x.jsx)(p.EuiBasicTable,{className:"snapshotRestore__shardsTable",compressed:!0,items:e,columns:a})},It=n.a.memo((({restores:e})=>{const{i18n:t,uiMetricService:s}=O(),[a,o]=Object(r.useState)({page:{},sort:{}}),[i,n]=Object(r.useState)({}),l=()=>{const{index:t,size:s}=a.page;return{pageIndex:null!=t?t:0,pageSize:null!=s?s:20,totalItemCount:e.length,pageSizeOptions:[10,20,50]}},c=()=>{const{field:e,direction:t}=a.sort;return{sort:{field:null!=e?e:"isComplete",direction:null!=t?t:"asc"}}},d=e=>{const{index:t}=e,a=!Boolean(j[t]);!0===a&&s.trackUiMetric(_.B),n({...j,[t]:a})},j=Object(r.useMemo)((()=>e.reduce(((e,t)=>{const{index:s,shards:a}=t;return i[s]&&(e[s]=Object(x.jsx)(Dt,{shards:a})),e}),{})),[i,e]),b=[{field:"index",name:t.translate("xpack.snapshotRestore.restoreList.table.indexColumnTitle",{defaultMessage:"Index"}),truncateText:!0,sortable:!0},{field:"isComplete",name:t.translate("xpack.snapshotRestore.restoreList.table.statusColumnTitle",{defaultMessage:"Status"}),truncateText:!0,sortable:!0,render:e=>e?Object(x.jsx)(p.EuiHealth,{color:"success"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreList.table.statusColumn.completeLabel",defaultMessage:"Complete"})):Object(x.jsx)(p.EuiHealth,{color:"warning"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreList.table.statusColumn.inProgressLabel",defaultMessage:"In progress"}))},{field:"latestActivityTimeInMillis",name:t.translate("xpack.snapshotRestore.restoreList.table.lastActivityTitle",{defaultMessage:"Last activity"}),truncateText:!0,render:(e,{isComplete:t})=>t?Object(x.jsx)(E,{epochMs:e}):Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreList.table.lastActivityColumn.nowLabel",defaultMessage:"now"})},{field:"shards",name:t.translate("xpack.snapshotRestore.restoreList.table.shardsCompletedTitle",{defaultMessage:"Shards completed"}),truncateText:!0,render:e=>e.filter((e=>Boolean(e.stopTimeInMillis))).length},{field:"shards",name:t.translate("xpack.snapshotRestore.restoreList.table.shardsInProgressTitle",{defaultMessage:"Shards in progress"}),truncateText:!0,render:e=>e.filter((e=>!Boolean(e.stopTimeInMillis))).length},{align:vt.RIGHT_ALIGNMENT,width:"40px",isExpander:!0,render:e=>Object(x.jsx)(p.EuiButtonIcon,{onClick:()=>d(e),"aria-label":j[e.index]?"Collapse":"Expand",iconType:j[e.index]?"arrowUp":"arrowDown"})}];return Object(x.jsx)(p.EuiBasicTable,{items:(()=>{const t=[...e],{sort:{field:s,direction:a}}=c(),{pageIndex:o,pageSize:i}=l();return Object(k.orderBy)(t,[s],[a]).slice(o*i,(o+1)*i)})(),itemId:"index",itemIdToExpandedRowMap:j,isExpandable:!0,columns:b,sorting:c(),pagination:l(),onChange:({page:e={},sort:t={}})=>{o({page:e,sort:t})},rowProps:e=>({"data-test-subj":"row",onClick:()=>d(e)}),cellProps:()=>({"data-test-subj":"cell"}),"data-test-subj":"restoresTable"})})),Ct=6e4,wt=[1e4,3e4,Ct,3e5],Bt=()=>{const[e,t]=Object(r.useState)(!1),[s,a]=Object(r.useState)(wt[1]),{error:n,isLoading:l,data:c=[],isInitialRequest:d,resendRequest:g}=Object(o.u)(s),{uiMetricService:m,history:y}=O(),{core:f}=h();let M;return Object(r.useEffect)((()=>{m.trackUiMetric(_.C)}),[m]),Object(b.m)(f.executionContext,{type:"application",page:"snapshotRestoreRestoreTab"}),d?l?M=Object(x.jsx)(b.g,null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreList.loadingRestoresDescription",defaultMessage:"Loading restores…"})):n&&(M=Object(x.jsx)(b.f,{title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreList.loadingRestoresErrorMessage",defaultMessage:"Error loading restores"}),error:n})):M=c&&0===c.length?Object(x.jsx)(p.EuiPageContent_Deprecated,{hasShadow:!1,paddingSize:"none",verticalPosition:"center",horizontalPosition:"center"},Object(x.jsx)(p.EuiEmptyPrompt,{iconType:"managementApp",title:Object(x.jsx)("h1",{"data-test-subj":"noRestoredSnapshotsHeader"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreList.emptyPromptTitle",defaultMessage:"No restored snapshots"})),body:Object(x.jsx)(r.Fragment,null,Object(x.jsx)("p",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreList.emptyPromptDescription",defaultMessage:"Go to {snapshotsLink} to start a restore.",values:{snapshotsLink:Object(x.jsx)(p.EuiLink,Object(Ae.reactRouterNavigate)(y,Object(i.o)()),Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreList.emptyPromptDescriptionLink",defaultMessage:"Snapshots"}))}}))),"data-test-subj":"emptyPrompt"})):Object(x.jsx)("section",{"data-test-subj":"restoreList"},Object(x.jsx)(p.EuiFlexGroup,{alignItems:"center",justifyContent:"flexStart",gutterSize:"s"},Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiPopover,{id:"srRestoreListIntervalMenu",button:Object(x.jsx)(p.EuiButtonEmpty,{size:"xs",iconType:"arrowDown",iconSide:"right",onClick:()=>t(!e)},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreList.intervalMenuButtonText",defaultMessage:"Refresh data every {interval}",values:{interval:s>=Ct?Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreList.intervalMenu.minutesIntervalValue",defaultMessage:"{minutes} {minutes, plural, one {minute} other {minutes}}",values:{minutes:Math.ceil(s/Ct)}}):Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreList.intervalMenu.secondsIntervalValue",defaultMessage:"{seconds} {seconds, plural, one {second} other {seconds}}",values:{seconds:Math.ceil(s/1e3)}})}})),isOpen:e,closePopover:()=>t(!1),panelPaddingSize:"none",anchorPosition:"downLeft"},Object(x.jsx)(p.EuiContextMenuPanel,{items:wt.map((e=>Object(x.jsx)(p.EuiContextMenuItem,{key:e,icon:"empty",onClick:()=>{g(),a(e),t(!1)}},e>=Ct?Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreList.intervalMenu.minutesIntervalValue",defaultMessage:"{minutes} {minutes, plural, one {minute} other {minutes}}",values:{minutes:Math.ceil(e/Ct)}}):Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreList.intervalMenu.secondsIntervalValue",defaultMessage:"{seconds} {seconds, plural, one {second} other {seconds}}",values:{seconds:Math.ceil(e/1e3)}}))))}))),Object(x.jsx)(p.EuiFlexItem,{grow:!1},l?Object(x.jsx)(p.EuiLoadingSpinner,{size:"m"}):null)),Object(x.jsx)(p.EuiSpacer,{size:"m"}),Object(x.jsx)(It,{restores:c})),Object(x.jsx)(b.i,{privileges:j.c.map((e=>`index.${e}`))},(({hasPrivileges:e,privilegesMissing:t})=>e?M:Object(x.jsx)(b.e,{title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreList.deniedPrivilegeTitle",defaultMessage:"You're missing index privileges"}),message:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreList.deniedPrivilegeDescription",defaultMessage:"To view snapshot restore status, you must have {privilegesCount, plural, one {this index privilege} other {these index privileges}} for one or more indices: {missingPrivileges}.",values:{missingPrivileges:t.index.join(", "),privilegesCount:t.index.length}})})))},Pt=({policy:e})=>{const{i18n:t,history:s}=O(),{version:a,name:o,modifiedDateMillis:l,snapshotName:c,repository:d,schedule:j,nextExecutionMillis:b,config:g,stats:m,retention:h,isManagedPolicy:y}=e,{includeGlobalState:f,featureStates:M,ignoreUnavailable:F,indices:R,partial:S}=g||{includeGlobalState:void 0,featureStates:[],ignoreUnavailable:void 0,indices:void 0,partial:void 0};return Object(x.jsx)(r.Fragment,null,y?Object(x.jsx)(n.a.Fragment,null,Object(x.jsx)(p.EuiCallOut,{size:"s",color:"warning",iconType:"iInCircle",title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyDetails.managedPolicyWarningTitle",defaultMessage:"This is a managed policy used by other systems. Any changes you make might affect how these systems operate."})}),Object(x.jsx)(p.EuiSpacer,{size:"l"})):null,m&&Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiPanel,{hasBorder:!0},Object(x.jsx)(p.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiStat,{title:m.snapshotsTaken,description:t.translate("xpack.snapshotRestore.policyDetails.snapshotsTakenStat",{defaultMessage:"Snapshots taken"}),titleSize:"s"})),Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiStat,{title:m.snapshotsFailed,description:t.translate("xpack.snapshotRestore.policyDetails.snapshotsFailedStat",{defaultMessage:"Failures"}),titleSize:"s"})),Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiStat,{title:m.snapshotsDeleted,description:t.translate("xpack.snapshotRestore.policyDetails.snapshotsDeletedStat",{defaultMessage:"Deleted"}),titleSize:"s"})),Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiStat,{title:m.snapshotDeletionFailures,description:t.translate("xpack.snapshotRestore.policyDetails.snapshotDeletionFailuresStat",{defaultMessage:"Deletion failures"}),titleSize:"s"})))),Object(x.jsx)(p.EuiSpacer,null)),Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyDetails.generalTitle",defaultMessage:"General"}))),Object(x.jsx)(p.EuiSpacer,{size:"s"}),Object(x.jsx)(p.EuiDescriptionList,{textStyle:"reverse"},Object(x.jsx)(p.EuiFlexGroup,null,Object(x.jsx)(p.EuiFlexItem,{"data-test-subj":"version"},Object(x.jsx)(p.EuiDescriptionListTitle,{"data-test-subj":"title"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyDetails.versionLabel",defaultMessage:"Version"})),Object(x.jsx)(p.EuiDescriptionListDescription,{className:"eui-textBreakWord","data-test-subj":"value"},a)),Object(x.jsx)(p.EuiFlexItem,{"data-test-subj":"modified"},Object(x.jsx)(p.EuiDescriptionListTitle,{"data-test-subj":"title"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyDetails.modifiedDateLabel",defaultMessage:"Last modified"})),Object(x.jsx)(p.EuiDescriptionListDescription,{className:"eui-textBreakWord","data-test-subj":"value"},Object(x.jsx)(E,{epochMs:l})))),Object(x.jsx)(p.EuiFlexGroup,null,Object(x.jsx)(p.EuiFlexItem,{"data-test-subj":"name"},Object(x.jsx)(p.EuiDescriptionListTitle,{"data-test-subj":"title"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyDetails.snapshotNameLabel",defaultMessage:"Snapshot name"})),Object(x.jsx)(p.EuiDescriptionListDescription,{className:"eui-textBreakWord","data-test-subj":"value"},Object(x.jsx)(p.EuiLink,Object(Ae.reactRouterNavigate)(s,Object(i.o)(void 0,o)),c))),Object(x.jsx)(p.EuiFlexItem,{"data-test-subj":"repository"},Object(x.jsx)(p.EuiDescriptionListTitle,{"data-test-subj":"title"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyDetails.repositoryLabel",defaultMessage:"Repository"})),Object(x.jsx)(p.EuiDescriptionListDescription,{className:"eui-textBreakWord","data-test-subj":"value"},Object(x.jsx)(p.EuiLink,Object(Ae.reactRouterNavigate)(s,Object(i.k)(d)),d)))),Object(x.jsx)(p.EuiFlexGroup,null,Object(x.jsx)(p.EuiFlexItem,{"data-test-subj":"schedule"},Object(x.jsx)(p.EuiDescriptionListTitle,{"data-test-subj":"title"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyDetails.scheduleLabel",defaultMessage:"Schedule"})),Object(x.jsx)(p.EuiDescriptionListDescription,{className:"eui-textBreakWord","data-test-subj":"value"},j)),Object(x.jsx)(p.EuiFlexItem,{"data-test-subj":"execution"},Object(x.jsx)(p.EuiDescriptionListTitle,{"data-test-subj":"title"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyDetails.nextExecutionLabel",defaultMessage:"Next snapshot"})),Object(x.jsx)(p.EuiDescriptionListDescription,{className:"eui-textBreakWord","data-test-subj":"value"},Object(x.jsx)(E,{epochMs:b})))),Object(x.jsx)(p.EuiFlexGroup,null,Object(x.jsx)(p.EuiFlexItem,{"data-test-subj":"indices"},Object(x.jsx)(p.EuiDescriptionListTitle,{"data-test-subj":"title"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyDetails.dataStreamsAndIndicesLabel",defaultMessage:"Data streams and indices"})),Object(x.jsx)(p.EuiDescriptionListDescription,{className:"eui-textBreakWord","data-test-subj":"value"},Object(x.jsx)(Re,{indices:R}))),Object(x.jsx)(p.EuiFlexItem,{"data-test-subj":"ignoreUnavailable"},Object(x.jsx)(p.EuiDescriptionListTitle,{"data-test-subj":"title"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyDetails.ignoreUnavailableLabel",defaultMessage:"Ignore unavailable indices"})),Object(x.jsx)(p.EuiDescriptionListDescription,{className:"eui-textBreakWord","data-test-subj":"value"},F?Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyDetails.ignoreUnavailableTrueLabel",defaultMessage:"Yes"}):Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyDetails.ignoreUnavailableFalseLabel",defaultMessage:"No"})))),Object(x.jsx)(p.EuiFlexGroup,null,Object(x.jsx)(p.EuiFlexItem,{"data-test-subj":"includeGlobalState"},Object(x.jsx)(p.EuiDescriptionListTitle,{"data-test-subj":"title"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyDetails.includeGlobalStateLabel",defaultMessage:"Include global state"})),Object(x.jsx)(p.EuiDescriptionListDescription,{className:"eui-textBreakWord","data-test-subj":"value"},!1===f?Object(x.jsx)(u.FormattedMessage,{"data-test-subj":"withoutGlobalState",id:"xpack.snapshotRestore.policyDetails.includeGlobalStateFalseLabel",defaultMessage:"No"}):Object(x.jsx)(u.FormattedMessage,{"data-test-subj":"withGlobalStateAndFeatureStates",id:"xpack.snapshotRestore.policyDetails.includeGlobalStateTrueLabel",defaultMessage:"Yes"}))),Object(x.jsx)(Le,{includeGlobalState:f,featureStates:M})),Object(x.jsx)(p.EuiFlexGroup,null,Object(x.jsx)(p.EuiFlexItem,{"data-test-subj":"partial"},Object(x.jsx)(p.EuiDescriptionListTitle,{"data-test-subj":"title"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyDetails.partialLabel",defaultMessage:"Allow partial shards"})),Object(x.jsx)(p.EuiDescriptionListDescription,{className:"eui-textBreakWord","data-test-subj":"value"},S?Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyDetails.partialTrueLabel",defaultMessage:"Yes"}):Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyDetails.partialFalseLabel",defaultMessage:"No"}))))),h&&Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiSpacer,{size:"s"}),Object(x.jsx)(p.EuiHorizontalRule,null),Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyDetails.retentionTitle",defaultMessage:"Retention"}))),Object(x.jsx)(p.EuiSpacer,{size:"s"}),Object(x.jsx)(p.EuiDescriptionList,{textStyle:"reverse"},h.expireAfterValue&&Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiDescriptionListTitle,null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyDetails.expireAfterLabel",defaultMessage:"Delete after"})),Object(x.jsx)(p.EuiDescriptionListDescription,null,h.expireAfterValue,h.expireAfterUnit)),h.minCount&&Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiDescriptionListTitle,null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyDetails.minCountLabel",defaultMessage:"Min count"})),Object(x.jsx)(p.EuiDescriptionListDescription,null,h.minCount)),h.maxCount&&Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiDescriptionListTitle,null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyDetails.maxCountLabel",defaultMessage:"Max count"})),Object(x.jsx)(p.EuiDescriptionListDescription,null,h.maxCount)))))},At=({policy:e})=>{const{lastSuccess:t,lastFailure:s,nextExecutionMillis:o,name:n,repository:l}=e,{history:c}=O();return t||s?Object(x.jsx)(r.Fragment,null,(()=>{if(!t)return null;const{time:e,snapshotName:s}=t;return Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyDetails.lastSuccessTitle",defaultMessage:"Last successful snapshot"}))),Object(x.jsx)(p.EuiSpacer,{size:"s"}),Object(x.jsx)(p.EuiDescriptionList,{textStyle:"reverse"},Object(x.jsx)(p.EuiFlexGroup,null,Object(x.jsx)(p.EuiFlexItem,{"data-test-subj":"successDate"},Object(x.jsx)(p.EuiDescriptionListTitle,{"data-test-subj":"title"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyDetails.lastSuccess.dateLabel",defaultMessage:"Date"})),Object(x.jsx)(p.EuiDescriptionListDescription,{className:"eui-textBreakWord","data-test-subj":"value"},Object(x.jsx)(E,{epochMs:e}))),Object(x.jsx)(p.EuiFlexItem,{"data-test-subj":"successSnapshot"},Object(x.jsx)(p.EuiDescriptionListTitle,{"data-test-subj":"title"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyDetails.lastSuccess.snapshotNameLabel",defaultMessage:"Snapshot name"})),Object(x.jsx)(p.EuiDescriptionListDescription,{className:"eui-textBreakWord","data-test-subj":"value"},Object(x.jsx)(p.EuiLink,Object(Ae.reactRouterNavigate)(c,Object(i.n)(l,s)),s))))))})(),t&&s?Object(x.jsx)(p.EuiHorizontalRule,null):null,(()=>{if(!s)return null;const{time:e,snapshotName:t,details:o}=s;return Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiTitle,{size:"s"},Object(x.jsx)("h3",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyDetails.lastFailureTitle",defaultMessage:"Last snapshot failure"}))),Object(x.jsx)(p.EuiSpacer,{size:"s"}),Object(x.jsx)(p.EuiDescriptionList,{textStyle:"reverse"},Object(x.jsx)(p.EuiFlexGroup,null,Object(x.jsx)(p.EuiFlexItem,{"data-test-subj":"failureDate"},Object(x.jsx)(p.EuiDescriptionListTitle,{"data-test-subj":"title"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyDetails.lastFailure.dateLabel",defaultMessage:"Date"})),Object(x.jsx)(p.EuiDescriptionListDescription,{className:"eui-textBreakWord","data-test-subj":"value"},Object(x.jsx)(E,{epochMs:e}))),Object(x.jsx)(p.EuiFlexItem,{"data-test-subj":"failureSnapshot"},Object(x.jsx)(p.EuiDescriptionListTitle,{"data-test-subj":"title"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyDetails.lastFailure.snapshotNameLabel",defaultMessage:"Snapshot name"})),Object(x.jsx)(p.EuiDescriptionListDescription,{className:"eui-textBreakWord","data-test-subj":"value"},t))),Object(x.jsx)(p.EuiFlexGroup,null,Object(x.jsx)(p.EuiFlexItem,{"data-test-subj":"failureDetails"},Object(x.jsx)(p.EuiDescriptionListTitle,{"data-test-subj":"title"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyDetails.lastFailure.detailsLabel",defaultMessage:"Details"})),Object(x.jsx)(p.EuiSpacer,{size:"s"}),Object(x.jsx)(p.EuiDescriptionListDescription,{className:"eui-textBreakWord","data-test-subj":"value"},Object(x.jsx)(b.c,{mode:"json",theme:"textmate",width:"100%",isReadOnly:!0,value:JSON.stringify(o,null,2),setOptions:{showLineNumbers:!1,tabSize:2},editorProps:{$blockScrolling:1/0},minLines:6,maxLines:12,wrapEnabled:!0,showGutter:!1,"aria-label":a.i18n.translate("xpack.snapshotRestore.policyDetails.lastFailure.detailsAriaLabel",{defaultMessage:"Last failure details for policy '{name}'",values:{name:n}})}))))))})()):Object(x.jsx)(p.EuiText,null,Object(x.jsx)("p",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyDetails.noHistoryMessage",defaultMessage:"This policy will run on {date} at {time}.",values:{date:Object(x.jsx)(E,{epochMs:o,type:"date"}),time:Object(x.jsx)(E,{epochMs:o,type:"time"})}})))},Nt="summary",zt="success",Gt={[Nt]:_.n,[zt]:_.m},_t=({policyName:e,onClose:t,onPolicyDeleted:s,onPolicyExecuted:a})=>{const{i18n:l,uiMetricService:c,history:d}=O(),{error:j,data:g,resendRequest:m}=Object(o.q)(e),[h,y]=Object(r.useState)(Nt),[f,M]=Object(r.useState)(!1);Object(r.useEffect)((()=>{y(Nt)}),[e]);const F=[{id:Nt,name:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyDetails.summaryTabTitle",defaultMessage:"Summary"})},{id:zt,name:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyDetails.historyTabTitle",defaultMessage:"History"})}];return Object(x.jsx)(p.EuiFlyout,{onClose:t,"data-test-subj":"policyDetail","aria-labelledby":"srPolicyDetailsFlyoutTitle",size:"m",maxWidth:550},Object(x.jsx)(p.EuiFlyoutHeader,null,Object(x.jsx)(p.EuiTitle,{size:"m"},Object(x.jsx)("h2",{id:"srPolicyDetailsFlyoutTitle","data-test-subj":"title"},e," ",Object(x.jsx)(p.EuiButtonIcon,{iconType:"refresh",color:"text","aria-label":l.translate("xpack.snapshotRestore.policyDetails.reloadButtonAriaLabel",{defaultMessage:"Reload"}),onClick:()=>m()}))),g&&g.policy&&g.policy.inProgress?Object(x.jsx)(n.a.Fragment,null,Object(x.jsx)(p.EuiSpacer,{size:"s"}),Object(x.jsx)(le,{size:"s"},Object(x.jsx)(p.EuiLink,re()({},Object(Ae.reactRouterNavigate)(d,Object(i.n)(g.policy.repository,g.policy.inProgress.snapshotName)),{"data-test-subj":"inProgressSnapshotLink"}),Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyDetails.inProgressSnapshotLinkText",defaultMessage:"'{snapshotName}' in progress",values:{snapshotName:g.policy.inProgress.snapshotName}})))):null,Object(x.jsx)(p.EuiTabs,null,F.map((e=>Object(x.jsx)(p.EuiTab,{onClick:()=>{c.trackUiMetric(Gt[e.id]),y(e.id)},isSelected:e.id===h,key:e.id,"data-test-subj":"tab"},e.name))))),Object(x.jsx)(p.EuiFlyoutBody,{"data-test-subj":"content"},(()=>{if(g){const{policy:e}=g;return h===zt?Object(x.jsx)(At,{policy:e}):Object(x.jsx)(Pt,{policy:e})}return j?(()=>{const t=404===j.status?{data:{error:l.translate("xpack.snapshotRestore.policyDetails.policyNotFoundErrorMessage",{defaultMessage:"The policy '{name}' does not exist.",values:{name:e}})}}:j;return Object(x.jsx)(b.h,{title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyDetails.loadingPolicyErrorTitle",defaultMessage:"Error loading policy"}),error:t})})():Object(x.jsx)(ce,null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyDetails.loadingPolicyDescription",defaultMessage:"Loading policy…"}))})()),Object(x.jsx)(p.EuiFlyoutFooter,null,Object(x.jsx)(p.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiButtonEmpty,{iconType:"cross",flush:"left",onClick:t,"data-test-subj":"srPolicyDetailsFlyoutCloseButton"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyDetails.closeButtonLabel",defaultMessage:"Close"}))),g?Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(Ce,null,(t=>Object(x.jsx)(we,null,(o=>Object(x.jsx)(p.EuiPopover,{id:"policyActionMenu",button:Object(x.jsx)(p.EuiButton,{"data-test-subj":"policyActionMenuButton",iconSide:"right",onClick:()=>M(!f),iconType:"arrowDown",fill:!0},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyDetails.manageButtonLabel",defaultMessage:"Manage policy"})),isOpen:f,closePopover:()=>M(!1),panelPaddingSize:"none",anchorPosition:"rightUp",repositionOnScroll:!0},Object(x.jsx)(p.EuiContextMenu,{"data-test-subj":"policyActionContextMenu",initialPanelId:0,panels:[{id:0,title:l.translate("xpack.snapshotRestore.policyDetails.managePanelTitle",{defaultMessage:"Policy options"}),items:[{name:l.translate("xpack.snapshotRestore.policyDetails.executeButtonLabel",{defaultMessage:"Run now"}),icon:"play",onClick:()=>{t(e,(()=>setTimeout((()=>{a(),m()}),2e3)))},disabled:Boolean(g.policy.inProgress)},{name:l.translate("xpack.snapshotRestore.policyDetails.editButtonLabel",{defaultMessage:"Edit"}),icon:"pencil",...Object(Ae.reactRouterNavigate)(d,Object(i.e)(e))},{name:l.translate("xpack.snapshotRestore.policyDetails.deleteButtonLabel",{defaultMessage:"Delete"}),icon:"trash",disabled:g.policy.isManagedPolicy,onClick:()=>o([e],s)}]}]}))))))):null)))},Wt=({policies:e,reload:t,openPolicyDetailsUrl:s,onPolicyDeleted:a,onPolicyExecuted:o})=>{const{i18n:n,uiMetricService:l,history:c}=O(),[d,j]=Object(r.useState)([]),b=[{field:"name",name:n.translate("xpack.snapshotRestore.policyList.table.policyNameColumnTitle",{defaultMessage:"Policy"}),truncateText:!0,sortable:!0,render:(e,{inProgress:t,isManagedPolicy:a})=>Object(x.jsx)(p.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiLink,re()({},Object(Ae.reactRouterNavigate)(c,s(e),(()=>l.trackUiMetric(_.q))),{"data-test-subj":"policyLink"}),e)," "),a?Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiIconTip,{content:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyList.table.managedPolicyBadgeLabel",defaultMessage:"This is a managed policy"}),position:"right"})):null,t?Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiToolTip,{content:n.translate("xpack.snapshotRestore.policyList.table.inProgressTooltip",{defaultMessage:"Snapshot in progress"})},Object(x.jsx)(p.EuiLoadingSpinner,{size:"m"}))):null)},{field:"snapshotName",name:n.translate("xpack.snapshotRestore.policyList.table.snapshotNameColumnTitle",{defaultMessage:"Snapshot name"}),sortable:!0,render:(e,{lastFailure:t,lastSuccess:s})=>s&&t&&t.time>s.time?Object(x.jsx)(p.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiToolTip,{position:"top",content:n.translate("xpack.snapshotRestore.policyList.table.lastSnapshotFailedTooltip",{defaultMessage:"Last snapshot failed"})},Object(x.jsx)(p.EuiIcon,{type:"alert",color:"danger"}))),Object(x.jsx)(p.EuiFlexItem,{grow:1},Object(x.jsx)(p.EuiText,{size:"s"},e))):e},{field:"repository",name:n.translate("xpack.snapshotRestore.policyList.table.repositoryColumnTitle",{defaultMessage:"Repository"}),truncateText:!0,sortable:!0},{field:"schedule",name:n.translate("xpack.snapshotRestore.policyList.table.scheduleColumnTitle",{defaultMessage:"Schedule"}),truncateText:!0,sortable:!0},{field:"retention",name:n.translate("xpack.snapshotRestore.policyList.table.retentionColumnTitle",{defaultMessage:"Retention"}),render:e=>e?Object(x.jsx)(p.EuiIcon,{type:"check","aria-label":n.translate("xpack.snapshotRestore.policyList.table.retentionColumnAriaLabel",{defaultMessage:"Retention configured"})}):null},{field:"nextExecutionMillis",name:n.translate("xpack.snapshotRestore.policyList.table.nextExecutionColumnTitle",{defaultMessage:"Next snapshot"}),truncateText:!0,sortable:!0,render:e=>Object(x.jsx)(E,{epochMs:e})},{name:n.translate("xpack.snapshotRestore.policyList.table.actionsColumnTitle",{defaultMessage:"Actions"}),actions:[{render:({name:e,inProgress:t,isManagedPolicy:s})=>Object(x.jsx)(p.EuiFlexGroup,{gutterSize:"s"},Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(Ce,null,(s=>Object(x.jsx)(p.EuiToolTip,{content:Boolean(t)?n.translate("xpack.snapshotRestore.policyList.table.actionExecuteDisabledTooltip",{defaultMessage:"Policy is running"}):n.translate("xpack.snapshotRestore.policyList.table.actionExecuteTooltip",{defaultMessage:"Run now"})},Object(x.jsx)(p.EuiButtonIcon,{"aria-label":n.translate("xpack.snapshotRestore.policyList.table.actionExecuteAriaLabel",{defaultMessage:"Run '{name}' immediately",values:{name:e}}),iconType:"play",color:"primary","data-test-subj":"executePolicyButton",onClick:()=>s(e,o),disabled:Boolean(t)}))))),Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiToolTip,{content:n.translate("xpack.snapshotRestore.policyList.table.actionEditTooltip",{defaultMessage:"Edit"})},Object(x.jsx)(p.EuiButtonIcon,re()({"aria-label":n.translate("xpack.snapshotRestore.policyList.table.actionEditAriaLabel",{defaultMessage:"Edit policy '{name}'",values:{name:e}}),iconType:"pencil",color:"primary"},Object(Ae.reactRouterNavigate)(c,Object(i.e)(e)),{"data-test-subj":"editPolicyButton"})))),Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(we,null,(t=>{const o=s?n.translate("xpack.snapshotRestore.policyList.table.deleteManagedPolicyTableActionTooltip",{defaultMessage:"You cannot delete a managed policy."}):n.translate("xpack.snapshotRestore.policyList.table.actionDeleteTooltip",{defaultMessage:"Delete"});return Object(x.jsx)(p.EuiToolTip,{content:o},Object(x.jsx)(p.EuiButtonIcon,{"aria-label":n.translate("xpack.snapshotRestore.policyList.table.actionDeleteAriaLabel",{defaultMessage:"Delete policy '{name}'",values:{name:e}}),iconType:"trash",color:"danger","data-test-subj":"deletePolicyButton",onClick:()=>t([e],a),isDisabled:s}))}))))}],width:"100px"}],g={onSelectionChange:e=>j(e),selectable:({isManagedPolicy:e})=>!e,selectableMessage:e=>e?"":n.translate("xpack.snapshotRestore.policyList.table.deleteManagedPolicySelectTooltip",{defaultMessage:"You cannot delete a managed policy."})},m={toolsLeft:d.length?Object(x.jsx)(we,null,(e=>Object(x.jsx)(p.EuiButton,{onClick:()=>e(d.map((({name:e})=>e)),a),color:"danger","data-test-subj":"srPolicyListBulkDeleteActionButton"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyList.table.deletePolicyButton",defaultMessage:"Delete {count, plural, one {policy} other {policies}}",values:{count:d.length}})))):void 0,toolsRight:[Object(x.jsx)(p.EuiButton,{key:"reloadPolicies",color:"success",iconType:"refresh",onClick:t,"data-test-subj":"reloadButton"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyList.table.reloadPoliciesButton",defaultMessage:"Reload"})),Object(x.jsx)(p.EuiButton,re()({key:"createNewPolicy"},Object(Ae.reactRouterNavigate)(c,Object(i.c)()),{fill:!0,iconType:"plusInCircle","data-test-subj":"createPolicyButton"}),Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyList.table.addPolicyButton",defaultMessage:"Create policy"}))],box:{incremental:!0,schema:!0},filters:[{type:"field_value_selection",field:"repository",name:n.translate("xpack.snapshotRestore.policyList.table.repositoryFilterLabel",{defaultMessage:"Repository"}),multiSelect:!1,options:Object.keys(e.reduce(((e,t)=>(e[t.repository]=!0,e)),{})).map((e=>({value:e,view:e})))}]};return Object(x.jsx)(p.EuiInMemoryTable,{className:"snapshotRestore__policyTable",items:e,itemId:"name",columns:b,search:m,sorting:{sort:{field:"name",direction:"asc"}},selection:g,pagination:{initialPageSize:20,pageSizeOptions:[10,20,50]},isSelectable:!0,rowProps:()=>({"data-test-subj":"row"}),cellProps:()=>({"data-test-subj":"cell"}),"data-test-subj":"policyTable"})},Vt=({retentionSettings:e,onRetentionScheduleUpdated:t,isLoading:s,error:a})=>{const{i18n:o}=O(),[i,l]=Object(r.useState)(!1);return s?Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiPanel,null,Object(x.jsx)(p.EuiLoadingContent,{lines:1})),Object(x.jsx)(p.EuiSpacer,null)):a?Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiCallOut,{title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyRetentionSchedulePanel.errorFetchingRetentionScheduleTitle",defaultMessage:"Error fetching retention schedule"}),color:"danger",iconType:"alert"},a.data&&a.data.message?Object(x.jsx)("p",null,a.data.message):null,Object(x.jsx)(p.EuiButton,{iconType:"refresh",color:"danger",onClick:t},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyRetentionSchedulePanel.errorFetchingRetentionScheduleReloadButtonLabel",defaultMessage:"Reload"}))),Object(x.jsx)(p.EuiSpacer,null)):e&&e.retentionSchedule?(c=e.retentionSchedule,Object(x.jsx)(n.a.Fragment,null,Object(x.jsx)(p.EuiPanel,{hasBorder:!0},Object(x.jsx)(p.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiText,null,Object(x.jsx)("p",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyRetentionSchedulePanel.retentionScheduleDescription",defaultMessage:"The cron schedule for retaining snapshots is: {cronSchedule}.",values:{cronSchedule:Object(x.jsx)("strong",null,c)}})))),Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(p.EuiFlexGroup,{gutterSize:"s"},Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(Pe,null,(e=>Object(x.jsx)(p.EuiToolTip,{position:"top",content:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyRetentionSchedulePanel.retentionScheduleExecuteLinkTooltip",defaultMessage:"Run retention now"})},Object(x.jsx)(p.EuiButtonIcon,{iconType:"play",onClick:()=>e(),"aria-label":o.translate("xpack.snapshotRestore.policyRetentionSchedulePanel.retentionScheduleExecuteLinkAriaLabel",{defaultMessage:"Run retention now"})}))))),Object(x.jsx)(p.EuiFlexItem,{grow:!1},Object(x.jsx)(Be,null,(e=>Object(x.jsx)(p.EuiToolTip,{position:"top",content:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyRetentionSchedulePanel.retentionScheduleEditLinkTooltip",defaultMessage:"Edit retention schedule"})},Object(x.jsx)(p.EuiButtonIcon,{iconType:"pencil",onClick:()=>e(c,t),"aria-label":o.translate("xpack.snapshotRestore.policyRetentionSchedulePanel.retentionScheduleEditLinkAriaLabel",{defaultMessage:"Edit retention schedule"})}))))))))),Object(x.jsx)(p.EuiSpacer,null))):Object(x.jsx)(n.a.Fragment,null,Object(x.jsx)(p.EuiCallOut,{title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyRetentionSchedulePanel.noScheduleConfiguredWarningTitle",defaultMessage:"Retention not scheduled"}),color:"warning",iconType:"alert"},Object(x.jsx)("p",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyRetentionSchedulePanel.noScheduleConfiguredWarningDescription",defaultMessage:"One or more policies have a retention period, but no retention is scheduled."})),Object(x.jsx)(Pe,null,(e=>Object(x.jsx)(Be,null,(s=>Object(x.jsx)(p.EuiPopover,{id:"retentionActionMenu",button:Object(x.jsx)(p.EuiButton,{"data-test-subj":"retentionActionMenuButton",iconSide:"right",color:"warning",onClick:()=>l(!i),iconType:"arrowDown"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyRetentionSchedulePanel.manageRetentionButtonLabel",defaultMessage:"Manage retention"})),isOpen:i,closePopover:()=>l(!1),panelPaddingSize:"none",anchorPosition:"rightUp",repositionOnScroll:!0},Object(x.jsx)(p.EuiContextMenu,{"data-test-subj":"retentionActionContextMenu",initialPanelId:0,panels:[{id:0,title:o.translate("xpack.snapshotRestore.policyRetentionSchedulePanel.managePanelTitle",{defaultMessage:"Retention options"}),items:[{name:o.translate("xpack.snapshotRestore.policyRetentionSchedulePanel.executeButtonLabel",{defaultMessage:"Run now"}),icon:"play",onClick:()=>e()},{name:o.translate("xpack.snapshotRestore.policyRetentionSchedulePanel.addButtonLabel",{defaultMessage:"Schedule"}),icon:"plusInCircle",onClick:()=>s(void 0,t)}]}]}))))))),Object(x.jsx)(p.EuiSpacer,null));var c},Ut=({history:e})=>{const{policyName:t}=Ze(),{error:s,isLoading:a,data:{policies:l}={policies:void 0},resendRequest:c}=Object(o.p)(),{uiMetricService:d}=O(),{core:g}=h(),{isLoading:m,error:y,data:f,resendRequest:M}=Object(o.v)(),F=e=>Object(i.i)(e),E=()=>{e.push(`${_.a}/policies`)},R=e=>{t&&e.includes(t)&&E(),e.length&&c()},S=()=>{c()};let k;if(Object(r.useEffect)((()=>{d.trackUiMetric(_.p)}),[d]),Object(b.m)(g.executionContext,{type:"application",page:"snapshotRestorePolicyTab"}),a)k=Object(x.jsx)(b.g,null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyList.loadingPoliciesDescription",defaultMessage:"Loading policies…"}));else if(s)k=Object(x.jsx)(b.f,{title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyList.LoadingPoliciesErrorMessage",defaultMessage:"Error loading policies"}),error:s});else if(l&&0===l.length)k=Object(x.jsx)(p.EuiPageContent_Deprecated,{hasShadow:!1,paddingSize:"none",verticalPosition:"center",horizontalPosition:"center"},Object(x.jsx)(p.EuiEmptyPrompt,{iconType:"managementApp",title:Object(x.jsx)("h1",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyList.emptyPromptTitle",defaultMessage:"Create your first snapshot policy"})),body:Object(x.jsx)(r.Fragment,null,Object(x.jsx)("p",null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyList.emptyPromptDescription",defaultMessage:"A policy automates the creation and deletion of snapshots."}))),actions:Object(x.jsx)(p.EuiButton,re()({},Object(Ae.reactRouterNavigate)(e,Object(i.c)()),{fill:!0,iconType:"plusInCircle","data-test-subj":"createPolicyButton"}),Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.createPolicyButton",defaultMessage:"Create a policy"})),"data-test-subj":"emptyPrompt"}));else{const e=l.map((e=>e.schedule)),t=e.length>new Set(e).size,s=Boolean(l.find((e=>e.retention)));k=Object(x.jsx)("section",{"data-test-subj":"policyList"},t?Object(x.jsx)(r.Fragment,null,Object(x.jsx)(p.EuiCallOut,{title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyScheduleWarningTitle",defaultMessage:"Two or more policies have the same schedule"}),color:"warning",iconType:"alert"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyScheduleWarningDescription",defaultMessage:"Only one snapshot can be taken at a time. To avoid snapshot failures, edit or delete the policies."})),Object(x.jsx)(p.EuiSpacer,null)):null,s?Object(x.jsx)(Vt,{retentionSettings:f,onRetentionScheduleUpdated:M,isLoading:m,error:y}):null,Object(x.jsx)(Wt,{policies:l||[],reload:c,openPolicyDetailsUrl:F,onPolicyDeleted:R,onPolicyExecuted:S}))}return Object(x.jsx)(b.i,{privileges:j.d.map((e=>`cluster.${e}`))},(({hasPrivileges:e,privilegesMissing:s})=>e?Object(x.jsx)(n.a.Fragment,null,t?Object(x.jsx)(_t,{policyName:t,onClose:E,onPolicyDeleted:R,onPolicyExecuted:S}):null,k):Object(x.jsx)(b.e,{title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyList.deniedPrivilegeTitle",defaultMessage:"You're missing cluster privileges"}),message:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.policyList.deniedPrivilegeDescription",defaultMessage:"To manage Snapshot Lifecycle Policies, you must have {privilegesCount, plural, one {this cluster privilege} other {these cluster privileges}}: {missingPrivileges}.",values:{missingPrivileges:s.cluster.join(", "),privilegesCount:s.cluster.length}})})))},$t=({match:{params:{section:e}},history:t})=>{const{slm_ui:s}=f(),{docLinks:a}=y(),o=[{id:"snapshots",name:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.home.snapshotsTabTitle",defaultMessage:"Snapshots"})},{id:"repositories",name:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.home.repositoriesTabTitle",defaultMessage:"Repositories"})},{id:"restore_status",name:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.home.restoreTabTitle",defaultMessage:"Restore Status"})}];return s.enabled&&o.splice(2,0,{id:"policies",name:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.home.policiesTabTitle",defaultMessage:"Policies"})}),Object(r.useEffect)((()=>{i.a.setBreadcrumbs(e||"home"),i.b.setTitle(e||"home")}),[e]),Object(x.jsx)(n.a.Fragment,null,Object(x.jsx)(p.EuiPageHeader,{bottomBorder:!0,pageTitle:Object(x.jsx)("span",{"data-test-subj":"appTitle"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.home.snapshotRestoreTitle",defaultMessage:"Snapshot and Restore"})),rightSideItems:[Object(x.jsx)(p.EuiButtonEmpty,{href:a.links.snapshotRestore.guide,target:"_blank",iconType:"help","data-test-subj":"documentationLink"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.home.snapshotRestoreDocsLinkText",defaultMessage:"Snapshot and Restore docs"}))],description:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.home.snapshotRestoreDescription",defaultMessage:"Use repositories to store and recover backups of your Elasticsearch indices and clusters."}),tabs:o.map((s=>({onClick:()=>{return e=s.id,void t.push(encodeURI(`${_.a}/${encodeURIComponent(e)}`));var e},isSelected:s.id===e,key:s.id,"data-test-subj":s.id.toLowerCase()+"_tab",label:s.name})))}),Object(x.jsx)(p.EuiSpacer,{size:"l"}),Object(x.jsx)(c.Switch,null,Object(x.jsx)(c.Route,{exact:!0,path:`${_.a}/repositories/:repositoryName*`,component:ut}),Object(x.jsx)(c.Route,{exact:!0,path:`${_.a}/snapshots`,component:Tt}),Object(x.jsx)(c.Route,{exact:!0,path:`${_.a}/snapshots/:repositoryName*/:snapshotId`,component:Tt}),Object(x.jsx)(c.Route,{exact:!0,path:`${_.a}/restore_status`,component:Bt}),Object(x.jsx)(c.Route,{exact:!0,path:`${_.a}/policies/:policyName*`,component:Ut})))},Ht=({history:e,location:{search:t}})=>{const[s,a]=Object(r.useState)(!1),[n,l]=Object(r.useState)(null);return Object(r.useEffect)((()=>{i.a.setBreadcrumbs("repositoryAdd"),i.b.setTitle("repositoryAdd")}),[]),Object(x.jsx)(p.EuiPageContentBody_Deprecated,{restrictWidth:!0,style:{width:"100%"}},Object(x.jsx)(p.EuiPageHeader,{pageTitle:Object(x.jsx)("span",{"data-test-subj":"pageTitle"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.addRepositoryTitle",defaultMessage:"Register repository"}))}),Object(x.jsx)(p.EuiSpacer,{size:"l"}),Object(x.jsx)(ae,{repository:{name:"",type:null,settings:{}},isSaving:s,saveError:n?Object(x.jsx)(b.h,{title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.addRepository.savingRepositoryErrorTitle",defaultMessage:"Cannot register new repository"}),error:n,"data-test-subj":"saveRepositoryApiError"}):null,clearSaveError:()=>{l(null)},onSave:async s=>{a(!0),l(null);const{name:i}=s,{error:r}=await Object(o.b)(s);if(a(!1),r)l(r);else{const{redirect:s}=Object(dt.parse)(t.replace(/^\?/,""),{sort:!1});e.push(s||encodeURI(`${_.a}/${encodeURIComponent("repositories")}/${encodeURIComponent(i)}`))}}}))},qt=({history:e})=>{const{i18n:t}=O(),{name:s}=Ze();Object(r.useEffect)((()=>{i.a.setBreadcrumbs("repositoryEdit"),i.b.setTitle("repositoryEdit")}),[]);const[a,l]=Object(r.useState)({name:"",type:null,settings:{}}),{error:c,isLoading:d,data:j}=Object(o.s)(s);Object(r.useEffect)((()=>{j&&j.repository&&l(j.repository)}),[j]);const[g,m]=Object(r.useState)(!1),[h,y]=Object(r.useState)(null);if(d)return Object(x.jsx)(pe,null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.editRepository.loadingRepositoryDescription",defaultMessage:"Loading repository details…"}));if(c)return(()=>{const e=404===c.status?{data:{error:t.translate("xpack.snapshotRestore.editRepository.repositoryNotFoundErrorMessage",{defaultMessage:"The repository '{name}' does not exist.",values:{name:s}})}}:c;return Object(x.jsx)(b.f,{title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.editRepository.loadingRepositoryErrorTitle",defaultMessage:"Error loading repository details"}),error:e})})();const{isManagedRepository:f}=j;return Object(x.jsx)(p.EuiPageContentBody_Deprecated,{restrictWidth:!0,style:{width:"100%"}},Object(x.jsx)(p.EuiPageHeader,{pageTitle:Object(x.jsx)("span",{"data-test-subj":"pageTitle"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.editRepositoryTitle",defaultMessage:"Edit repository"}))}),Object(x.jsx)(p.EuiSpacer,{size:"l"}),f?Object(x.jsx)(n.a.Fragment,null,Object(x.jsx)(p.EuiCallOut,{size:"m",color:"warning",iconType:"iInCircle",title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.editRepository.managedRepositoryWarningTitle",defaultMessage:"This is a managed repository. Changing this repository might affect other systems that use it. Proceed with caution."})}),Object(x.jsx)(p.EuiSpacer,{size:"l"})):null,Object(x.jsx)(ae,{repository:a,isManagedRepository:f,isEditing:!0,isSaving:g,saveError:h?Object(x.jsx)(b.h,{title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.editRepository.savingRepositoryErrorTitle",defaultMessage:"Cannot save repository"}),error:h}):null,clearSaveError:()=>{y(null)},onSave:async t=>{m(!0),y(null);const{error:a}=await Object(o.h)(t);m(!1),a?y(a):e.push(encodeURI(`${_.a}/${encodeURIComponent("repositories")}/${encodeURIComponent(s)}`))}}))},Yt=({history:e})=>{const{i18n:t}=O(),{repositoryName:s,snapshotId:a}=Ze();Object(r.useEffect)((()=>{i.a.setBreadcrumbs("restoreSnapshot"),i.b.setTitle("restoreSnapshot")}),[]);const[n,l]=Object(r.useState)({}),{error:c,isLoading:d,data:j}=Object(o.w)(s,a);Object(r.useEffect)((()=>{j&&l(j)}),[j]);const[g,m]=Object(r.useState)(!1),[h,y]=Object(r.useState)(null);return d?Object(x.jsx)(pe,null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreSnapshot.loadingSnapshotDescription",defaultMessage:"Loading snapshot details…"})):c?(()=>{const e=404===c.status?{data:{error:t.translate("xpack.snapshotRestore.restoreSnapshot.snapshotNotFoundErrorMessage",{defaultMessage:"The snapshot '{snapshot}' does not exist in repository '{repository}'.",values:{snapshot:a,repository:s}})}}:c;return Object(x.jsx)(b.f,{title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreSnapshot.loadingSnapshotErrorTitle",defaultMessage:"Error loading snapshot details"}),error:e})})():Object(x.jsx)(p.EuiPageContentBody_Deprecated,{restrictWidth:!0,style:{width:"100%"}},Object(x.jsx)(p.EuiPageHeader,{pageTitle:Object(x.jsx)("span",{"data-test-subj":"pageTitle"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreSnapshotTitle",defaultMessage:"Restore '{snapshot}'",values:{snapshot:a}}))}),Object(x.jsx)(p.EuiSpacer,{size:"l"}),Object(x.jsx)(Ie,{snapshotDetails:n,isSaving:g,saveError:h?Object(x.jsx)(b.h,{title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.restoreSnapshot.executeRestoreErrorTitle",defaultMessage:"Unable to restore snapshot"}),error:h}):null,clearSaveError:()=>{y(null)},onSave:async t=>{m(!0),y(null);const{error:i}=await Object(o.j)(s,a,t);i?(m(!1),y(i)):setTimeout((()=>{m(!1),e.push(`${_.a}/restore_status`)}),5e3)}}))},Xt=({history:e,location:{pathname:t}})=>{const[s,a]=Object(r.useState)(!1),[n,l]=Object(r.useState)(null),{error:c,isLoading:d,data:g}=Object(o.o)(),{indices:m,dataStreams:h}=null!=g?g:{indices:[],dataStreams:[]};Object(r.useEffect)((()=>{i.a.setBreadcrumbs("policyAdd"),i.b.setTitle("policyAdd")}),[]);const O={name:"",snapshotName:"",schedule:_.c,repository:"",config:{},retention:{expireAfterValue:"",expireAfterUnit:j.f.DAY,maxCount:"",minCount:""},isManagedPolicy:!1};return d?Object(x.jsx)(pe,null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.addPolicy.loadingIndicesDescription",defaultMessage:"Loading available indices…"})):c?Object(x.jsx)(b.f,{title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.addPolicy.LoadingIndicesErrorMessage",defaultMessage:"Error loading available indices"}),error:c}):Object(x.jsx)(p.EuiPageContentBody_Deprecated,{restrictWidth:!0,style:{width:"100%"}},Object(x.jsx)(p.EuiPageHeader,{pageTitle:Object(x.jsx)("span",{"data-test-subj":"pageTitle"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.addPolicyTitle",defaultMessage:"Create policy"}))}),Object(x.jsx)(p.EuiSpacer,{size:"l"}),Object(x.jsx)(Je,{policy:O,indices:m,dataStreams:h,currentUrl:t,isSaving:s,saveError:n?Object(x.jsx)(b.h,{title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.addPolicy.savingPolicyErrorTitle",defaultMessage:"Cannot create new policy"}),error:n,"data-test-subj":"savePolicyApiError"}):null,clearSaveError:()=>{l(null)},onSave:async t=>{a(!0),l(null);const{name:s}=t,{error:i}=await Object(o.a)(t);a(!1),i?l(i):e.push(encodeURI(`${_.a}/policies/${encodeURIComponent(s)}`))},onCancel:()=>{e.push(`${_.a}/policies`)}}))},Jt=({history:e,location:{pathname:t}})=>{const{name:s}=Ze(),{i18n:a}=O();Object(r.useEffect)((()=>{i.a.setBreadcrumbs("policyEdit"),i.b.setTitle("policyEdit")}),[]);const[l,c]=Object(r.useState)({name:"",snapshotName:"",schedule:"",repository:"",config:{},retention:{expireAfterValue:"",expireAfterUnit:L.h.DAY,maxCount:"",minCount:""},isManagedPolicy:!1}),{error:d,isLoading:j,data:g}=Object(o.o)(),{error:m,isLoading:h,data:y}=Object(o.q)(s);Object(r.useEffect)((()=>{if(null!=y&&y.policy){const{policy:e}=y,t={name:e.name,snapshotName:e.snapshotName,schedule:e.schedule,repository:e.repository,config:e.config,retention:e.retention,isManagedPolicy:e.isManagedPolicy};c(t)}}),[y]);const[f,M]=Object(r.useState)(!1),[F,E]=Object(r.useState)(null);return h||j?h?Object(x.jsx)(pe,null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.editPolicy.loadingPolicyDescription",defaultMessage:"Loading policy details…"})):Object(x.jsx)(pe,null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.editPolicy.loadingIndicesDescription",defaultMessage:"Loading available indices…"})):m||d?(()=>{if(m){const e=404===m.status?{data:{error:a.translate("xpack.snapshotRestore.editPolicy.policyNotFoundErrorMessage",{defaultMessage:"The policy '{name}' does not exist.",values:{name:s}})}}:m;return Object(x.jsx)(b.f,{title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.editPolicy.loadingPolicyErrorTitle",defaultMessage:"Error loading policy details"}),error:e})}return Object(x.jsx)(b.f,{title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.editPolicy.LoadingIndicesErrorMessage",defaultMessage:"Error loading available indices"}),error:d})})():Object(x.jsx)(p.EuiPageContentBody_Deprecated,{restrictWidth:!0,style:{width:"100%"}},Object(x.jsx)(p.EuiPageHeader,{pageTitle:Object(x.jsx)("span",{"data-test-subj":"pageTitle"},Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.editPolicyTitle",defaultMessage:"Edit policy"}))}),Object(x.jsx)(p.EuiSpacer,{size:"l"}),l.isManagedPolicy?Object(x.jsx)(n.a.Fragment,null,Object(x.jsx)(p.EuiCallOut,{size:"m",color:"warning",iconType:"iInCircle",title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.editPolicy.managedPolicyWarningTitle",defaultMessage:"This is a managed policy. Changing this policy might affect other systems that use it. Proceed with caution."})}),Object(x.jsx)(p.EuiSpacer,{size:"l"})):null,Object(x.jsx)(Je,{policy:l,dataStreams:g.dataStreams,indices:g.indices,currentUrl:t,isEditing:!0,isSaving:f,saveError:F?Object(x.jsx)(b.h,{title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.editPolicy.savingPolicyErrorTitle",defaultMessage:"Cannot save policy"}),error:F}):null,clearSaveError:()=>{E(null)},onSave:async t=>{M(!0),E(null);const{error:a}=await Object(o.g)(t);M(!1),a?E(a):e.push(encodeURI(`${_.a}/policies/${encodeURIComponent(s)}`))},onCancel:()=>{e.push(encodeURI(`${_.a}/policies/${encodeURIComponent(s)}`))}}))},Kt=()=>{const{slm_ui:e}=f(),{apiError:t}=Object(b.l)(),{core:s}=h(),a=["repositories","snapshots","restore_status"];e.enabled&&a.push("policies");const o=a.join("|");return Object(b.m)(s.executionContext,{type:"application",page:"snapshotRestore"}),t?Object(x.jsx)(b.f,{title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.app.checkingPrivilegesErrorMessage",defaultMessage:"Error fetching user privileges from the server."}),error:t}):Object(x.jsx)(b.i,{privileges:j.b.map((e=>`cluster.${e}`))},(({isLoading:t,hasPrivileges:s,privilegesMissing:a})=>t?Object(x.jsx)(pe,null,Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.app.checkingPrivilegesDescription",defaultMessage:"Checking privileges…"})):s?Object(x.jsx)("div",{"data-test-subj":"snapshotRestoreApp",className:d.APP_WRAPPER_CLASS},Object(x.jsx)(c.Switch,null,Object(x.jsx)(c.Route,{exact:!0,path:"/add_repository",component:Ht}),Object(x.jsx)(c.Route,{exact:!0,path:"/edit_repository/:name*",component:qt}),Object(x.jsx)(c.Route,{exact:!0,path:`/:section(${o})/:repositoryName?/:snapshotId*`,component:$t}),Object(x.jsx)(c.Redirect,{exact:!0,from:"/restore/:repositoryName",to:"/snapshots"}),Object(x.jsx)(c.Route,{exact:!0,path:"/restore/:repositoryName/:snapshotId*",component:Yt}),e.enabled&&Object(x.jsx)(c.Route,{exact:!0,path:"/add_policy",component:Xt}),e.enabled&&Object(x.jsx)(c.Route,{exact:!0,path:"/edit_policy/:name*",component:Jt}),Object(x.jsx)(c.Redirect,{from:"/",to:`/${_.f}`}),Object(x.jsx)(c.Redirect,{from:"",to:`/${_.f}`}))):Object(x.jsx)(p.EuiPageContent_Deprecated,{verticalPosition:"center",horizontalPosition:"center",color:"subdued"},Object(x.jsx)(b.e,{title:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.app.deniedPrivilegeTitle",defaultMessage:"You're missing cluster privileges"}),message:Object(x.jsx)(u.FormattedMessage,{id:"xpack.snapshotRestore.app.deniedPrivilegeDescription",defaultMessage:"To use Snapshot and Restore, you must have {privilegesCount, plural, one {this cluster privilege} other {these cluster privileges}}: {missingPrivileges}.",values:{missingPrivileges:a.cluster.join(", "),privilegesCount:a.cluster.length}})}))))},Zt=({appDependencies:e,children:t})=>{const{core:s,theme$:a}=e,{i18n:{Context:o},http:i}=s;return Object(x.jsx)(b.a,{httpClient:i,privilegesEndpoint:`${j.a}privileges`},Object(x.jsx)(o,null,Object(x.jsx)(b.d,{theme$:a},Object(x.jsx)(m,{value:e},t))))},Qt=({history:e})=>Object(x.jsx)(c.Router,{history:e},Object(x.jsx)(Kt,null));async function es(e,t,s,r){const{element:n,setBreadcrumbs:c,history:p,theme$:u}=r,[d]=await e.getStartServices(),{chrome:{docTitle:j}}=d;i.b.setup(j.change),i.a.setup(c);const b={core:d,config:s,services:{httpService:o.l,uiMetricService:t.uiMetricService,i18n:a.i18n,history:p},theme$:u},g=(m=n,h=b,Object(l.render)(Object(x.jsx)(Zt,{appDependencies:h},Object(x.jsx)(Qt,{history:h.services.history})),m),()=>{Object(l.unmountComponentAtNode)(m)});var m,h;return()=>{j.reset(),g()}}}])]);