/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.threatIntelligence_bundle_jsonpfunction=window.threatIntelligence_bundle_jsonpfunction||[]).push([[2],{72:function(e,t,s){"use strict";s.r(t),s.d(t,"initComponent",(function(){return O}));var a=s(0),i=s.n(a),n=s(3),c=s(6),r=s(30),o=s(24),u=s(73),j=s(74),l=s(1);const d=({metadata:e,rawDocument:t,"data-test-subj":s})=>t&&0!==Object.keys(t).length?Object(l.jsx)(i.a.Fragment,null,Object(l.jsx)(n.EuiTitle,null,Object(l.jsx)("h2",null,e.indicatorName)),Object(l.jsx)(n.EuiCodeBlock,{language:"json",lineNumbers:!0,"data-test-subj":"tiCasesFlyoutJsonCodeBlock"},JSON.stringify(t,null,2))):Object(l.jsx)(j.a,null),b=({metadata:e,rawDocument:t,closeFlyout:s})=>{const a=Object(n.useGeneratedHtmlId)({prefix:"simpleFlyoutTitle"});return Object(l.jsx)(n.EuiFlyout,{onClose:s,"aria-labelledby":a},Object(l.jsx)(n.EuiFlyoutHeader,{hasBorder:!0},Object(l.jsx)(n.EuiTitle,null,Object(l.jsx)("h2",{"data-test-subj":"tiCasesFlyoutTitle",id:a},Object(l.jsx)(c.FormattedMessage,{id:"xpack.threatIntelligence.cases.flyout.title",defaultMessage:"Indicator details"}))),Object(l.jsx)(n.EuiSpacer,{size:"s"}),Object(l.jsx)(n.EuiText,{size:"xs"},Object(l.jsx)("p",{"data-test-subj":"tiCasesFlyoutSubtitle"},Object(l.jsx)(c.FormattedMessage,{id:"xpack.threatIntelligence.cases.flyout.subTitle",defaultMessage:"First seen: "}),Object(l.jsx)(u.a,{date:e.indicatorFirstSeen}))),Object(l.jsx)(n.EuiSpacer,{size:"m"})),Object(l.jsx)(n.EuiFlyoutBody,null,Object(l.jsx)(d,{rawDocument:t,metadata:e})),Object(l.jsx)(n.EuiFlyoutFooter,null))},x=({id:e,metadata:t})=>{const[s,u]=Object(a.useState)(!1),{indicator:j,isLoading:d}=(e=>{const{services:{data:{search:t}}}=Object(o.e)(),[s,i]=Object(a.useState)(),[n,c]=Object(a.useState)(!0);return Object(a.useEffect)((()=>{const s={params:{index:["filebeat-*"],body:{query:{bool:{must:[{term:{_id:{value:e}}}]}}}}};t.search(s).subscribe({next:e=>{if(Object(r.isCompleteResponse)(e)){const t=e.rawResponse.hits;i(t.hits[0]),c(!1)}}})}),[e,t,i]),{indicator:s,isLoading:n}})(e),{indicatorName:x,indicatorType:O,indicatorFeedName:g}=t,m=Object(a.useMemo)((()=>s?Object(l.jsx)(b,{metadata:t,rawDocument:j,closeFlyout:()=>u(!1)}):null),[s,j,t]);return d?Object(l.jsx)(n.EuiLoadingLogo,{logo:"logoSecurity",size:"xl"}):Object(l.jsx)(i.a.Fragment,null,Object(l.jsx)(n.EuiFlexGroup,{css:{padding:"12px 24px"},gutterSize:"s",direction:"column"},Object(l.jsx)(n.EuiFlexGroup,{gutterSize:"s"},Object(l.jsx)(n.EuiFlexItem,{grow:!1},Object(l.jsx)(n.EuiText,{size:"s"},Object(l.jsx)("strong",null,Object(l.jsx)(c.FormattedMessage,{id:"xpack.threatIntelligence.cases.indicatorName",defaultMessage:"Indicator name:"})))),Object(l.jsx)(n.EuiFlexItem,{grow:!1},Object(l.jsx)(n.EuiText,{size:"s"},Object(l.jsx)(n.EuiLink,{"data-test-subj":"tiCasesIndicatorName",onClick:()=>u(!0)},x)," "))),Object(l.jsx)(n.EuiFlexGroup,{gutterSize:"s"},Object(l.jsx)(n.EuiFlexItem,{grow:!1},Object(l.jsx)(n.EuiText,{size:"s"},Object(l.jsx)("strong",null,Object(l.jsx)(c.FormattedMessage,{id:"xpack.threatIntelligence.cases.indicatorFeedName",defaultMessage:"Feed name:"})))),Object(l.jsx)(n.EuiFlexItem,{grow:!1},Object(l.jsx)(n.EuiText,{size:"s"},Object(l.jsx)("p",{"data-test-subj":"tiCasesIndicatorFeedName"},g)))),Object(l.jsx)(n.EuiFlexGroup,{gutterSize:"s"},Object(l.jsx)(n.EuiFlexItem,{grow:!1},Object(l.jsx)(n.EuiText,{size:"s"},Object(l.jsx)("strong",null,Object(l.jsx)(c.FormattedMessage,{id:"xpack.threatIntelligence.cases.indicatorType",defaultMessage:"Indicator type:"})))),Object(l.jsx)(n.EuiFlexItem,{grow:!1},Object(l.jsx)(n.EuiText,{size:"s"},Object(l.jsx)("p",{"data-test-subj":"tiCasesIndicatorTYPE"},O))))),m)},O=()=>e=>{const t=e.externalReferenceId,s=e.externalReferenceMetadata;return Object(l.jsx)(x,{id:t,metadata:s})}},73:function(e,t,s){"use strict";s.d(t,"a",(function(){return b}));var a=s(65),i=s.n(a),n=s(0),c=s.n(n),r=s(8),o=s(75),u=s(16),j=s(67),l=s.n(j),d=s(1);i.a.suppressDeprecationWarnings=!0;const b=({date:e,dateFormat:t})=>{const s=(()=>{const e=Object(u.useUiSetting)(r.b);return"Browser"===e?l.a.tz.guess():e})(),a=Object(u.useUiSetting)(r.a);if(null===e)return Object(d.jsx)(c.a.Fragment,null,r.c);const n="string"==typeof e?i()(e):e;return Object(d.jsx)(c.a.Fragment,null,Object(o.b)(n,s,t||a))}},74:function(e,t,s){"use strict";s.d(t,"a",(function(){return c}));var a=s(3),i=s(6),n=(s(0),s(1));const c=()=>Object(n.jsx)(a.EuiEmptyPrompt,{iconType:"alert",color:"danger",title:Object(n.jsx)("h2",null,Object(n.jsx)(i.FormattedMessage,{id:"xpack.threatIntelligence.indicator.flyoutTable.errorMessageTitle",defaultMessage:"Unable to display indicator information"})),body:Object(n.jsx)("p",null,Object(n.jsx)(i.FormattedMessage,{id:"xpack.threatIntelligence.indicator.flyoutTable.errorMessageBody",defaultMessage:"There was an error displaying the indicator fields and values."})),"data-test-subj":"indicatorEmptyPrompt"})},75:function(e,t,s){"use strict";s.d(t,"b",(function(){return r})),s.d(t,"a",(function(){return o}));var a=s(65),i=s.n(a),n=s(66),c=s(8);i.a.suppressDeprecationWarnings=!0;const r=(e,t,s)=>{const a="string"==typeof e?i.a.tz(e,t):e.tz(t);return a.isValid()?a.format(s):c.c},o=e=>{const t=((e,t)=>{const s=t.diff(e,"days");return s<=1&&!e.isSame(t)?2:s})(e.min,e.max),s=Object(n.niceTimeFormatByDay)(t);return Object(n.timeFormatter)(s)}}}]);