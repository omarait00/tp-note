/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.threatIntelligence_bundle_jsonpfunction=window.threatIntelligence_bundle_jsonpfunction||[]).push([[1],{73:function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var i=a(65),n=a.n(i),s=a(0),r=a.n(s),o=a(8),c=a(75),l=a(16),u=a(67),d=a.n(u),j=a(1);n.a.suppressDeprecationWarnings=!0;const b=({date:e,dateFormat:t})=>{const a=(()=>{const e=Object(l.useUiSetting)(o.b);return"Browser"===e?d.a.tz.guess():e})(),i=Object(l.useUiSetting)(o.a);if(null===e)return Object(j.jsx)(r.a.Fragment,null,o.c);const s="string"==typeof e?n()(e):e;return Object(j.jsx)(r.a.Fragment,null,Object(c.b)(s,a,t||i))}},74:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var i=a(3),n=a(6),s=(a(0),a(1));const r=()=>Object(s.jsx)(i.EuiEmptyPrompt,{iconType:"alert",color:"danger",title:Object(s.jsx)("h2",null,Object(s.jsx)(n.FormattedMessage,{id:"xpack.threatIntelligence.indicator.flyoutTable.errorMessageTitle",defaultMessage:"Unable to display indicator information"})),body:Object(s.jsx)("p",null,Object(s.jsx)(n.FormattedMessage,{id:"xpack.threatIntelligence.indicator.flyoutTable.errorMessageBody",defaultMessage:"There was an error displaying the indicator fields and values."})),"data-test-subj":"indicatorEmptyPrompt"})},75:function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return c}));var i=a(65),n=a.n(i),s=a(66),r=a(8);n.a.suppressDeprecationWarnings=!0;const o=(e,t,a)=>{const i="string"==typeof e?n.a.tz(e,t):e.tz(t);return i.isValid()?i.format(a):r.c},c=e=>{const t=((e,t)=>{const a=t.diff(e,"days");return a<=1&&!e.isSame(t)?2:a})(e.min,e.max),a=Object(s.niceTimeFormatByDay)(t);return Object(s.timeFormatter)(a)}},76:function(e,t,a){e.exports=a(9)(3397)},77:function(e,t){var a=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");e.exports=function(e){return a.test(e)}},78:function(e,t,a){var i=a(76),n=a(79);e.exports=function(e){return n(i(e).toLowerCase())}},79:function(e,t,a){var i=a(80)("toUpperCase");e.exports=i},80:function(e,t,a){var i=a(81),n=a(77),s=a(83),r=a(76);e.exports=function(e){return function(t){t=r(t);var a=n(t)?s(t):void 0,o=a?a[0]:t.charAt(0),c=a?i(a,1).join(""):t.slice(1);return o[e]()+c}}},81:function(e,t,a){var i=a(82);e.exports=function(e,t,a){var n=e.length;return a=void 0===a?n:a,!t&&a>=n?e:i(e,t,a)}},82:function(e,t,a){e.exports=a(9)(3424)},83:function(e,t,a){var i=a(84),n=a(77),s=a(85);e.exports=function(e){return n(e)?s(e):i(e)}},84:function(e,t){e.exports=function(e){return e.split("")}},85:function(e,t){var a="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",i="\\ud83c[\\udffb-\\udfff]",n="[^\\ud800-\\udfff]",s="(?:\\ud83c[\\udde6-\\uddff]){2}",r="[\\ud800-\\udbff][\\udc00-\\udfff]",o="(?:"+a+"|"+i+")?",c="[\\ufe0e\\ufe0f]?",l=c+o+"(?:\\u200d(?:"+[n,s,r].join("|")+")"+c+o+")*",u="(?:"+[n+a+"?",a,s,r,"[\\ud800-\\udfff]"].join("|")+")",d=RegExp(i+"(?="+i+")|"+u+l,"g");e.exports=function(e){return e.match(d)||[]}},86:function(e,t,a){e.exports=a.p+"4675c2990a45ad8bac7a3b6199bb939e.svg"},87:function(e,t){e.exports=function(e){if("function"!=typeof e)throw new TypeError("Expected a function");return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}},88:function(e,t,a){e.exports=a.p+"08153df199173c3869bc5930d76c1e36.svg"},89:function(e,t,a){"use strict";a.r(t),a.d(t,"APP_ID",(function(){return Nt})),a.d(t,"IndicatorsPageWrapper",(function(){return Gt}));var i=a(0),n=a.n(i),s=a(18),r=a(3),o=a(6),c=a(4),l=a(7),u=a(1);const d=c.b.Feed,j=l.i18n.translate("xpack.threatIntelligence.indicator.fieldSelector.label",{defaultMessage:"Stack by"}),b={asPlainText:!0},x=Object(i.memo)((({indexPattern:e,valueChange:t,defaultStackByValue:a=d})=>{const[n,s]=Object(i.useState)([{label:a}]),o=Object(i.useMemo)((()=>e?e.fields.map((e=>({label:e.name}))):[]),[e]),c=Object(i.useCallback)((e=>{e&&0!==e.length&&(t(e[0].label),s(e))}),[t]);return Object(u.jsx)(r.EuiComboBox,{css:{"max-width":"400px",width:"400px"},"data-test-subj":"tiIndicatorFieldSelectorDropdown",prepend:j,singleSelection:b,onChange:c,options:o,selectedOptions:n,isClearable:!1})}));var g=a(66);const p="copyClipboard",O=l.i18n.translate("xpack.threatIntelligence.indicators.table.copyToClipboardLabel",{defaultMessage:"Copy to clipboard"}),m=({value:e,"data-test-subj":t})=>Object(u.jsx)(r.EuiCopy,{textToCopy:e},(e=>Object(u.jsx)(r.EuiButtonEmpty,{"aria-label":O,iconType:p,iconSize:"s",color:"primary",onClick:e,"data-test-subj":t},O))),f=({value:e,"data-test-subj":t})=>Object(u.jsx)(r.EuiCopy,{textToCopy:e},(e=>Object(u.jsx)(r.EuiContextMenuItem,{key:"copyToClipboard",icon:p,size:"s",onClick:e,"data-test-subj":t},O)));var y=a(10);const h=!0,T=!1,I=({indicator:e,field:t,filterType:a})=>{const{filterManager:n}=Object(y.e)(),{key:s,value:r}="string"==typeof e?{key:t,value:e}:Object(y.c)(e,t),o=Object(i.useCallback)((()=>{const e=((e,t,a,i)=>{const n=((e,t,a)=>({meta:{alias:null,negate:a,disabled:!1,type:"phrase",key:e,params:{query:t}},query:{match_phrase:{[e]:t}}}))(t,a,!i),s=((e,t,a)=>e.find((e=>e.meta.key===t&&e.meta.params.query===a)))(e,t,a);return((e,t)=>null!=e&&t===e.meta.negate)(s,i)?[...e.filter((e=>e!==s)),n]:[...e,n]})(n.getFilters(),s,r,a);n.setFilters(e)}),[n,a,s,r]);return Object(y.b)(s,r)?{filterFn:o}:{}},v="plusInCircle",F=l.i18n.translate("xpack.threatIntelligence.queryBar.filterIn",{defaultMessage:"Filter In"}),C=({data:e,field:t,"data-test-subj":a})=>{const{filterFn:i}=I({indicator:e,field:t,filterType:h});return i?Object(u.jsx)(r.EuiToolTip,{content:F},Object(u.jsx)(r.EuiButtonIcon,{"aria-label":F,iconType:v,iconSize:"s",size:"xs",color:"primary",onClick:i,"data-test-subj":a})):Object(u.jsx)(n.a.Fragment,null)},E=({data:e,field:t,"data-test-subj":a})=>{const{filterFn:i}=I({indicator:e,field:t,filterType:h});return i?Object(u.jsx)(r.EuiToolTip,{content:F},Object(u.jsx)(r.EuiButtonEmpty,{"aria-label":F,iconType:v,iconSize:"s",color:"primary",onClick:i,"data-test-subj":a},F)):Object(u.jsx)(n.a.Fragment,null)},k=({data:e,field:t,"data-test-subj":a})=>{const{filterFn:i}=I({indicator:e,field:t,filterType:h});return i?Object(u.jsx)(r.EuiContextMenuItem,{key:"filterIn",icon:"plusInCircle",size:"s",onClick:i,"data-test-subj":a},F):Object(u.jsx)(n.a.Fragment,null)},S=({data:e,field:t,Component:a,"data-test-subj":i})=>{const{filterFn:s}=I({indicator:e,field:t,filterType:h});return s?Object(u.jsx)(r.EuiToolTip,{content:F},Object(u.jsx)(r.EuiFlexItem,{"data-test-subj":i},Object(u.jsx)(a,{"aria-label":F,iconType:v,onClick:s},F))):Object(u.jsx)(n.a.Fragment,null)},M="minusInCircle",w=l.i18n.translate("xpack.threatIntelligence.queryBar.filterOut",{defaultMessage:"Filter Out"}),P=({data:e,field:t,"data-test-subj":a})=>{const{filterFn:i}=I({indicator:e,field:t,filterType:T});return i?Object(u.jsx)(r.EuiToolTip,{content:w},Object(u.jsx)(r.EuiButtonIcon,{"aria-label":w,iconType:M,iconSize:"s",size:"xs",color:"primary",onClick:i,"data-test-subj":a})):Object(u.jsx)(n.a.Fragment,null)},B=({data:e,field:t,"data-test-subj":a})=>{const{filterFn:i}=I({indicator:e,field:t,filterType:T});return i?Object(u.jsx)(r.EuiToolTip,{content:w},Object(u.jsx)(r.EuiButtonEmpty,{"aria-label":w,iconType:M,iconSize:"s",color:"primary",onClick:i,"data-test-subj":a},w)):Object(u.jsx)(n.a.Fragment,null)},z=({data:e,field:t,"data-test-subj":a})=>{const{filterFn:i}=I({indicator:e,field:t,filterType:T});return i?Object(u.jsx)(r.EuiContextMenuItem,{key:"filterOut",icon:"minusInCircle",size:"s",onClick:i,"data-test-subj":a},w):Object(u.jsx)(n.a.Fragment,null)},A=({data:e,field:t,Component:a,"data-test-subj":i})=>{const{filterFn:s}=I({indicator:e,field:t,filterType:T});return s?Object(u.jsx)(r.EuiToolTip,{content:w},Object(u.jsx)(r.EuiFlexItem,{"data-test-subj":i},Object(u.jsx)(a,{"aria-label":w,iconType:M,onClick:s},w))):Object(u.jsx)(n.a.Fragment,null)},L=(e,t)=>({and:[],enabled:!0,id:`timeline-indicator-${e}-${t}`,name:t,excluded:!1,kqlQuery:"",queryMatch:{field:e,value:t,operator:":"}});var R=a(24);var _=a(65),q=a.n(_),N=a(17);const G=({indicator:e})=>{const t=Object(i.useContext)(N.a),{key:a,value:n}=Object(y.c)(e,c.b.Name),s=c.a[a];if(!Object(y.b)(a,n)||!s)return{};const r=[...s,a].map((e=>L(e,n))),o=Object(y.d)(e,c.b.TimeStamp),l=q()(o).subtract(10,"m").toISOString();return o&&l?{investigateInTimelineFn:null==t?void 0:t.getUseInvestigateInTimeline({dataProviders:r,from:l,to:o})}:{}},D="timeline",Q=l.i18n.translate("xpack.threatIntelligence.timeline.addToTimeline",{defaultMessage:"Add to Timeline"}),H=({data:e,field:t,"data-test-subj":a})=>{const s=Object(i.useRef)(null),o=Object(R.e)().services.timelines.getHoverActions().getAddToTimelineButton,{key:c,value:l}="string"==typeof e?{key:t,value:e}:Object(y.c)(e,t);if(!Object(y.b)(c,l))return Object(u.jsx)(n.a.Fragment,null);const d={dataProvider:[L(c,l)],field:c,ownFocus:!1};return d.defaultFocusedButtonRef=s,Object(u.jsx)(n.a.Fragment,null,Object(u.jsx)("div",{css:{display:"none"}},o(d)),Object(u.jsx)(r.EuiToolTip,{content:Q},Object(u.jsx)(r.EuiButtonEmpty,{"aria-label":Q,iconType:D,iconSize:"s",color:"primary",onClick:()=>{var e;return null===(e=s.current)||void 0===e?void 0:e.click()},"data-test-subj":a},Q)))},U=({data:e,field:t,"data-test-subj":a})=>{const s=Object(i.useRef)(null),o=Object(R.e)().services.timelines.getHoverActions().getAddToTimelineButton,{key:c,value:l}="string"==typeof e?{key:t,value:e}:Object(y.c)(e,t);if(!Object(y.b)(c,l))return Object(u.jsx)(n.a.Fragment,null);const d={dataProvider:[L(c,l)],field:c,ownFocus:!1};return d.defaultFocusedButtonRef=s,Object(u.jsx)(n.a.Fragment,null,Object(u.jsx)("div",{css:{display:"none"}},o(d)),Object(u.jsx)(r.EuiContextMenuItem,{key:"addToTimeline",icon:D,size:"s",onClick:()=>{var e;return null===(e=s.current)||void 0===e?void 0:e.click()},"data-test-subj":a},Q))},V=({data:e,field:t,Component:a,"data-test-subj":i})=>{const s=Object(R.e)().services.timelines.getHoverActions().getAddToTimelineButton,{addToTimelineProps:o}=(({indicator:e,field:t})=>{const{key:a,value:i}="string"==typeof e?{key:t,value:e}:Object(y.c)(e,t);return Object(y.b)(a,i)?{addToTimelineProps:{dataProvider:[L(a,i)],field:a,ownFocus:!1}}:{}})({indicator:e,field:t});return o?(o.Component=a,Object(u.jsx)(r.EuiToolTip,{content:Q},Object(u.jsx)(r.EuiFlexItem,{"data-test-subj":i},s(o)))):Object(u.jsx)(n.a.Fragment,null)},$=l.i18n.translate("xpack.threatIntelligence.timeline.investigateInTimelineButtonIcon",{defaultMessage:"Investigate in Timeline"}),W=({data:e,onClick:t,"data-test-subj":a})=>{const{investigateInTimelineFn:i}=G({indicator:e});return i?Object(u.jsx)(r.EuiContextMenuItem,{key:"investigateInTime",onClick:()=>(t&&t(),void i()),"data-test-subj":a},Object(u.jsx)(o.FormattedMessage,{defaultMessage:"Investigate in Timeline",id:"xpack.threatIntelligence.investigateInTimelineButton"})):Object(u.jsx)(n.a.Fragment,null)},K=({data:e,"data-test-subj":t})=>{const{investigateInTimelineFn:a}=G({indicator:e});return a?Object(u.jsx)(r.EuiToolTip,{content:$},Object(u.jsx)(r.EuiButtonIcon,{"aria-label":$,iconType:"timeline",iconSize:"s",size:"xs",color:"primary",onClick:a,"data-test-subj":t})):Object(u.jsx)(n.a.Fragment,null)},Y=l.i18n.translate("xpack.threatIntelligence.indicator.barChart.popover",{defaultMessage:"More actions"}),J=({data:e,field:t})=>{const[a,n]=Object(i.useState)(!1),s=[Object(u.jsx)(k,{data:e,field:t,"data-test-subj":"tiBarchartFilterInButton"}),Object(u.jsx)(z,{data:e,field:t,"data-test-subj":"tiBarchartFilterOutButton"}),Object(u.jsx)(U,{data:e,field:t,"data-test-subj":"tiBarchartTimelineButton"}),Object(u.jsx)(f,{value:e,"data-test-subj":"tiBarchartCopyToClipboardButton"})];return Object(u.jsx)(r.EuiPopover,{"data-test-subj":"tiBarchartPopoverButton",button:Object(u.jsx)(r.EuiToolTip,{content:Y},Object(u.jsx)(r.EuiButtonIcon,{"aria-label":Y,iconType:"boxesHorizontal",iconSize:"s",size:"xs",onClick:()=>n((e=>!e)),style:{height:"100%"}})),isOpen:a,closePopover:()=>n(!1),panelPaddingSize:"none",anchorPosition:"downLeft"},Object(u.jsx)(r.EuiContextMenuPanel,{size:"s",items:s}))};var X=a(75);const Z="tiIndicator",ee=({indicators:e,dateRange:t,field:a,height:i="200px"})=>Object(u.jsx)(r.EuiThemeProvider,null,Object(u.jsx)(g.Chart,{size:{width:"100%",height:i}},Object(u.jsx)(g.Settings,{showLegend:!0,legendPosition:g.Position.Right,legendSize:200,legendAction:({label:e})=>Object(u.jsx)(J,{field:a,data:e})}),Object(u.jsx)(g.Axis,{id:`${Z}TimeAxis`,position:g.Position.Bottom,labelFormat:Object(X.a)(t)}),Object(u.jsx)(g.Axis,{id:`${Z}IndicatorAxis`,position:g.Position.Left}),Object(u.jsx)(g.BarSeries,{id:`${Z}BarChart`,name:"Indicators",xScaleType:g.ScaleType.Time,yScaleType:g.ScaleType.Linear,xAccessor:"x",yAccessors:["y"],stackAccessors:["x"],splitSeriesAccessors:["g"],data:e}))),te=c.b.Feed,ae=Object(i.memo)((({timeRange:e,indexPattern:t,isLoading:a,isFetching:i,series:n,dateRange:s,field:c,onFieldChange:l})=>a?Object(u.jsx)(r.EuiFlexGroup,{justifyContent:"spaceAround"},Object(u.jsx)(r.EuiFlexItem,{grow:!1},Object(u.jsx)(r.EuiPanel,{hasShadow:!1,hasBorder:!1,paddingSize:"xl"},Object(u.jsx)(r.EuiLoadingSpinner,{size:"xl"})))):Object(u.jsx)("div",{style:{position:"relative"}},Object(u.jsx)(r.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(u.jsx)(r.EuiFlexItem,null,Object(u.jsx)(r.EuiTitle,{size:"s"},Object(u.jsx)("h2",null,Object(u.jsx)(o.FormattedMessage,{id:"xpack.threatIntelligence.indicator.barchartSection.title",defaultMessage:"Trend"})))),Object(u.jsx)(r.EuiFlexItem,{grow:!1},Object(u.jsx)(x,{indexPattern:t,defaultStackByValue:te,valueChange:l}))),i&&Object(u.jsx)(r.EuiProgress,{"data-test-subj":"tiBarchartWrapper-updating",size:"xs",color:"accent",position:"absolute"}),e&&Object(u.jsx)(ee,{indicators:n,dateRange:s,field:c}))));var ie=a(8),ne=a(26);const se=({indicator:e,onClick:t,"data-test-subj":a})=>{const{cases:i}=Object(R.e)().services,n=i.hooks.getUseCasesAddToNewCaseFlyout({}),s=e._id,c=Object(ne.b)(e),l=Object(ne.c)(s,c),d=c.indicatorName===ie.c;return Object(u.jsx)(r.EuiContextMenuItem,{key:"attachmentsNewCase",onClick:()=>(t(),void n.open({attachments:l})),"data-test-subj":a,disabled:d},Object(u.jsx)(o.FormattedMessage,{defaultMessage:"Add to new case",id:"xpack.threatIntelligence.addToNewCase"}))};var re=a(5);const oe=({indicator:e,onClick:t,"data-test-subj":a})=>{const{cases:i}=Object(re.b)().services,n=i.hooks.getUseCasesAddToExistingCaseModal({}),s=e._id,c=Object(ne.b)(e),l=Object(ne.c)(s,c),d=c.indicatorName===ie.c;return Object(u.jsx)(r.EuiContextMenuItem,{key:"attachmentsExistingCase",onClick:()=>(t(),void n.open({attachments:l})),"data-test-subj":a,disabled:d},Object(u.jsx)(o.FormattedMessage,{defaultMessage:"Add to existing case",id:"xpack.threatIntelligence.addToExistingCase"}))},ce=l.i18n.translate("xpack.threatIntelligence.indicator.table.moreActions",{defaultMessage:"More actions"}),le=({indicator:e})=>{const[t,a]=Object(i.useState)(!1),n=Object(r.useGeneratedHtmlId)({prefix:"smallContextMenuPopover"}),s=()=>{a(!1)},o=[Object(u.jsx)(oe,{indicator:e,onClick:s,"data-test-subj":"tiIndicatorTableAddToExistingCaseContextMenu"}),Object(u.jsx)(se,{indicator:e,onClick:s,"data-test-subj":"tiIndicatorTableAddToNewCaseContextMenu"})],c=Object(u.jsx)(r.EuiToolTip,{content:ce},Object(u.jsx)(r.EuiButtonIcon,{"aria-label":ce,iconType:"boxesHorizontal",iconSize:"s",size:"xs",onClick:()=>a((e=>!e)),style:{height:"100%"},"data-test-subj":"tiIndicatorTableMoreActionsButton"}));return Object(u.jsx)(r.EuiPopover,{id:n,button:c,isOpen:t,closePopover:s,panelPaddingSize:"none",anchorPosition:"downLeft"},Object(u.jsx)(r.EuiContextMenuPanel,{size:"s",items:o}))},ue=l.i18n.translate("xpack.threatIntelligence.indicator.table.viewDetailsButton",{defaultMessage:"View details"}),de=({indicator:e,onOpen:t,isOpen:a})=>Object(u.jsx)(r.EuiToolTip,{content:ue},Object(u.jsx)(r.EuiButtonIcon,{"data-test-subj":"tiToggleIndicatorFlyoutButton",color:a?"text":"primary",iconType:a?"minimize":"expand",isSelected:a,iconSize:"s","aria-label":ue,onClick:()=>t(e)})),je=Object(i.createContext)(void 0),be=({indicator:e})=>{const t=Object(i.useContext)(je);if(!t)throw new Error("indicatorTableContext has to be defined");const{setExpanded:a,expanded:n}=t;return Object(u.jsx)(r.EuiFlexGroup,{justifyContent:"center",gutterSize:"none"},Object(u.jsx)(r.EuiFlexItem,{grow:!1},Object(u.jsx)(de,{indicator:e,onOpen:a,isOpen:Boolean(n&&n._id===e._id)})),Object(u.jsx)(r.EuiFlexItem,{grow:!1},Object(u.jsx)(K,{data:e,"data-test-subj":"tiIndicatorTableInvestigateInTimelineButtonIcon"})),Object(u.jsx)(r.EuiFlexItem,{grow:!1},Object(u.jsx)(le,{indicator:e})))};var xe=a(25),ge=a(68);const pe=e=>{switch(e){case ge.KBN_FIELD_TYPES.IP:case ge.KBN_FIELD_TYPES.GEO_SHAPE:case ge.KBN_FIELD_TYPES.NUMBER:return"numeric";case ge.KBN_FIELD_TYPES.BOOLEAN:return"boolean";case ge.KBN_FIELD_TYPES.STRING:return"string";case ge.KBN_FIELD_TYPES.DATE:return"datetime";default:return}};var Oe=a(69);const me=c.b.TimeStamp,fe=({filters:e,filterQuery:t,timeRange:a})=>({query:Object(Oe.buildEsQuery)(void 0,[{query:ie.d,language:"kuery"},{query:t.query,language:"kuery"}],[...e,{query:{range:{[me]:{gte:null==a?void 0:a.from,lte:null==a?void 0:a.to}}},meta:{}}])});var ye=a(30);const he="barchartAggregation";let Te;!function(e){e.IndicatorGrid="indicatorGrid",e.Barchart="barchart"}(Te||(Te={}));const Ie=async(e,t,{inspectorAdapter:a,requestName:i,signal:n})=>{const s=`${Date.now()}`,r=a.start(i,{id:s});return new Promise(((i,o)=>{e.search(t,{abortSignal:n,strategy:"threatIntelligenceSearchStrategy"}).subscribe({next:e=>{var a;Object(ye.isCompleteResponse)(e)?(r.stats({}).ok({json:e}),r.json((null===(a=t.params)||void 0===a?void 0:a.body)||{}),i(e.rawResponse)):Object(ye.isErrorResponse)(e)&&(r.error({json:e}),o(e))},error:t=>{t instanceof Error&&t.name.includes("Abort")?a.resetRequest(s):r.error({json:t}),e.showError(t),o(t)}})}))};var ve=a(13);const Fe=({rowIndex:e,columnId:t,Component:a,indicators:i,pagination:s})=>{const r=i[e%s.pageSize],{key:o,value:c}=Object(xe.b)(r,t);return Object(xe.a)(o,c)?Object(u.jsx)(n.a.Fragment,null,Object(u.jsx)(S,{data:r,field:o,Component:a,"data-test-subj":"tiIndicatorsTableCellFilterInButton"}),Object(u.jsx)(A,{data:r,field:o,Component:a,"data-test-subj":"tiIndicatorsTableCellFilterOutButton"}),Object(u.jsx)(V,{data:r,field:o,Component:a,"data-test-subj":"tiIndicatorsTableCellTimelineButton"})):Object(u.jsx)(n.a.Fragment,null)};var Ce=a(70),Ee=a(73),ke=a(78),Se=a.n(ke);const Me={red:"danger",amber:"warning","amber+strict":"warning",green:"success",white:"hollow",clear:"hollow"},we=({value:e})=>{const t=null==e?void 0:e.toLowerCase().trim(),a=Me[t||""],s=Object(i.useMemo)((()=>null==t?void 0:t.replaceAll(/\W/g," ").split(" ").map(Se.a).join(" ")),[t]);return a?Object(u.jsx)(r.EuiBadge,{color:a},s):Object(u.jsx)(n.a.Fragment,null,ie.c)},Pe=({indicator:e,field:t})=>{const a=Object(R.a)()[t],i=Object(ve.a)(e,t);return t===c.b.MarkingTLP?Object(u.jsx)(we,{value:i}):"date"===a?Object(u.jsx)(Ee.a,{date:i}):i?Object(u.jsx)(n.a.Fragment,null,i):Object(u.jsx)(n.a.Fragment,null,ie.c)},Be=({browserFields:e,columnIds:t,onResetColumns:a,onToggleColumn:i})=>{const{triggersActionsUi:n}=Object(R.e)().services;return n.getFieldBrowser({browserFields:e,columnIds:t,onResetColumns:a,onToggleColumn:i,options:{preselectedCategoryIds:["threat"]}})};var ze=a(86),Ae=a.n(ze);const Le={tall:490,short:250},Re={maxWidth:500},_e=({height:e="tall"})=>Object(u.jsx)(r.EuiPanel,{color:"subdued","data-test-subj":"indicatorsTableEmptyState"},Object(u.jsx)(r.EuiFlexGroup,{style:{height:Le[e]},alignItems:"center",justifyContent:"center"},Object(u.jsx)(r.EuiFlexItem,{grow:!1},Object(u.jsx)(r.EuiPanel,{hasBorder:!0,style:Re},Object(u.jsx)(r.EuiFlexGroup,null,Object(u.jsx)(r.EuiFlexItem,null,Object(u.jsx)(r.EuiText,{size:"s"},Object(u.jsx)(r.EuiTitle,null,Object(u.jsx)("h3",null,Object(u.jsx)(o.FormattedMessage,{id:"xpack.threatIntelligence.empty.title",defaultMessage:"No results match your search criteria"}))),Object(u.jsx)("p",null,Object(u.jsx)(o.FormattedMessage,{id:"xpack.threatIntelligence.empty.description",defaultMessage:"Try searching over a longer period of time or modifying your search"})))),Object(u.jsx)(r.EuiFlexItem,{grow:!1},Object(u.jsx)(r.EuiImage,{size:"200",alt:"",src:Ae.a}))))))),qe=({indicator:e})=>{const[t,a]=Object(i.useState)(!1),n=Object(r.useGeneratedHtmlId)({prefix:"smallContextMenuPopover"}),s=()=>{a(!1)},c=[Object(u.jsx)(W,{data:e,onClick:s,"data-test-subj":"tiIndicatorFlyoutInvestigateInTimelineContextMenu"}),Object(u.jsx)(oe,{indicator:e,onClick:s,"data-test-subj":"tiIndicatorFlyoutAddToExistingCaseContextMenu"}),Object(u.jsx)(se,{indicator:e,onClick:s,"data-test-subj":"tiIndicatorFlyoutAddToNewCaseContextMenu"})],l=Object(u.jsx)(r.EuiButton,{iconType:"arrowDown",iconSide:"right",onClick:()=>a(!t)},Object(u.jsx)(o.FormattedMessage,{id:"xpack.threatIntelligence.indicators.flyout.take-action.button",defaultMessage:"Take action"}));return Object(u.jsx)(r.EuiPopover,{id:n,button:l,isOpen:t,closePopover:s,panelPaddingSize:"none",anchorPosition:"downLeft","data-test-subj":"tiIndicatorFlyoutTakeActionButton"},Object(u.jsx)(r.EuiContextMenuPanel,{size:"s",items:c}))};var Ne=a(74);const Ge=({indicator:e})=>0===Object.keys(e).length?Object(u.jsx)(Ne.a,null):Object(u.jsx)(r.EuiCodeBlock,{language:"json",lineNumbers:!0,"data-test-subj":"tiFlyoutJsonCodeBlock"},JSON.stringify(e,null,2)),De=l.i18n.translate("xpack.threatIntelligence.more-actions.popover",{defaultMessage:"More actions"}),Qe=({indicator:e,field:t,"data-test-subj":a})=>{const[n,s]=Object(i.useState)(!1),{key:o,value:c}=Object(xe.b)(e,t);if(!Object(xe.a)(o,c))return null;const l=`${a}FilterInButton`,d=`${a}FilterOutButton`,j=`${a}TimelineButton`,b=`${a}CopyToClipboardButton`,x=`${a}PopoverButton`,g=[Object(u.jsx)(U,{data:e,field:t,"data-test-subj":j}),Object(u.jsx)(f,{value:c,"data-test-subj":b})];return Object(u.jsx)(r.EuiFlexGroup,{justifyContent:"center",alignItems:"center"},Object(u.jsx)(C,{data:e,field:t,"data-test-subj":l}),Object(u.jsx)(P,{data:e,field:t,"data-test-subj":d}),Object(u.jsx)(r.EuiPopover,{"data-test-subj":x,button:Object(u.jsx)(r.EuiToolTip,{content:De},Object(u.jsx)(r.EuiButtonIcon,{"aria-label":De,iconType:"boxesHorizontal",iconSize:"s",size:"xs",onClick:()=>s((e=>!e)),style:{height:"100%"}})),isOpen:n,closePopover:()=>s(!1),panelPaddingSize:"none",anchorPosition:"downLeft"},Object(u.jsx)(r.EuiContextMenuPanel,{size:"s",items:g})))},He=({fields:e,indicator:t,"data-test-subj":a})=>{const n=Object(i.useMemo)((()=>[{name:Object(u.jsx)(o.FormattedMessage,{id:"xpack.threatIntelligence.indicator.fieldsTable.fieldColumnLabel",defaultMessage:"Field"}),render:e=>e},{name:Object(u.jsx)(o.FormattedMessage,{id:"xpack.threatIntelligence.indicator.fieldsTable.valueColumnLabel",defaultMessage:"Value"}),render:e=>Object(u.jsx)(Pe,{indicator:t,field:e})},{actions:[{render:e=>Object(u.jsx)(Qe,{field:e,indicator:t,"data-test-subj":a}),width:"72px"}]}]),[t,a]);return Object(u.jsx)(r.EuiInMemoryTable,{items:e,columns:n,sorting:!0,"data-test-subj":a})},Ue={box:{incremental:!0,schema:!0}},Ve=({indicator:e})=>{const t=Object.keys(e.fields);return 0===t.length?Object(u.jsx)(Ne.a,null):Object(u.jsx)(He,{"data-test-subj":"tiFlyoutTable",search:Ue,fields:t,indicator:e})};var $e=a(71);const We=({field:e})=>Object(u.jsx)(n.a.Fragment,null,Ke(e)),Ke=e=>{switch(e){case c.b.TimeStamp:return l.i18n.translate("xpack.threatIntelligence.field.@timestamp",{defaultMessage:"@timestamp"});case c.b.Name:return l.i18n.translate("xpack.threatIntelligence.field.threat.indicator.name",{defaultMessage:"Indicator"});case c.b.Type:return l.i18n.translate("xpack.threatIntelligence.field.threat.indicator.type",{defaultMessage:"Indicator type"});case c.b.Feed:return l.i18n.translate("xpack.threatIntelligence.field.threat.feed.name",{defaultMessage:"Feed"});case c.b.FirstSeen:return l.i18n.translate("xpack.threatIntelligence.field.threat.indicator.first_seen",{defaultMessage:"First seen"});case c.b.LastSeen:return l.i18n.translate("xpack.threatIntelligence.field.threat.indicator.last_seen",{defaultMessage:"Last seen"});case c.b.Confidence:return l.i18n.translate("xpack.threatIntelligence.field.threat.indicator.confidence",{defaultMessage:"Confidence"});case c.b.MarkingTLP:return l.i18n.translate("xpack.threatIntelligence.field.threat.indicator.marking.tlp",{defaultMessage:"TLP Marking"});default:return e}},Ye=$e.euiStyled.div`
  ${({theme:e})=>$e.css`
    & {
      height: 100%;
    }

    & .actionsWrapper {
      visibility: hidden;
      display: inline-block;
      margin-inline-start: ${e.eui.euiSizeS};
    }

    &:hover .actionsWrapper {
      visibility: visible;
    }
  `}
`,Je={color:"subdued",hasShadow:!1,borderRadius:"none",paddingSize:"s"},Xe=({field:e,indicator:t,"data-test-subj":a})=>Object(u.jsx)(r.EuiPanel,Je,Object(u.jsx)(Ye,{"data-test-subj":`${a}Item`},Object(u.jsx)(r.EuiText,null,Object(u.jsx)(We,{field:e})),Object(u.jsx)(r.EuiSpacer,{size:"s"}),Object(u.jsx)(r.EuiText,{size:"s"},Object(u.jsx)(Pe,{indicator:t,field:e}),Object(u.jsx)("span",{className:"actionsWrapper"},Object(u.jsx)(Qe,{indicator:t,field:e,"data-test-subj":a}))))),Ze=({indicator:e,"data-test-subj":t})=>{const a=Object(ve.a)(e,c.b.Type),n=Object(i.useMemo)((()=>Object.keys(e.fields).filter((e=>t=>t.startsWith(`threat.indicator.${e}`)||["threat.indicator.reference","threat.indicator.description","threat.software.alias","threat.indicator.confidence","threat.tactic.name","threat.tactic.reference"].includes(t))(a||""))),[e.fields,a]);return Object(u.jsx)(He,{search:!1,indicator:e,fields:n,"data-test-subj":t})},et=[c.b.Feed,c.b.Type,c.b.MarkingTLP,c.b.Confidence],tt="tiFlyoutOverviewHighLevelBlocks",at=({indicator:e,onViewAllFieldsInTable:t})=>{const a=Object(ve.a)(e,c.b.Type),s=Object(i.useMemo)((()=>Object(u.jsx)(r.EuiFlexGroup,{"data-test-subj":tt},et.map((t=>Object(u.jsx)(r.EuiFlexItem,{key:t},Object(u.jsx)(Xe,{indicator:e,field:t,"data-test-subj":tt})))))),[e]),l=Object(i.useMemo)((()=>{const t=Object(ve.a)(e,c.b.Description);return t?Object(u.jsx)(r.EuiText,null,t):null}),[e]),d=Object(ve.a)(e,c.b.Name)||ie.c;return a?Object(u.jsx)(n.a.Fragment,null,Object(u.jsx)(r.EuiTitle,null,Object(u.jsx)("h2",null,d)),l,Object(u.jsx)(r.EuiSpacer,null),s,Object(u.jsx)(r.EuiHorizontalRule,null),Object(u.jsx)(r.EuiFlexGroup,null,Object(u.jsx)(r.EuiFlexItem,null,Object(u.jsx)(r.EuiTitle,{size:"xxs"},Object(u.jsx)("h5",null,Object(u.jsx)(o.FormattedMessage,{id:"xpack.threatIntelligence.indicator.flyoutOverviewTable.highlightedFields",defaultMessage:"Highlighted fields"})))),Object(u.jsx)(r.EuiFlexItem,{grow:!1},Object(u.jsx)(r.EuiButtonEmpty,{onClick:t},Object(u.jsx)(o.FormattedMessage,{id:"xpack.threatIntelligence.indicator.flyoutOverviewTable.viewAllFieldsInTable",defaultMessage:"View all fields in table"})))),Object(u.jsx)(Ze,{indicator:e,"data-test-subj":"tiFlyoutOverviewTableRow"})):Object(u.jsx)(Ne.a,null)};var it;!function(e){e[e.overview=0]="overview",e[e.table=1]="table",e[e.json=2]="json"}(it||(it={}));const nt=({indicator:e,closeFlyout:t})=>{const[a,n]=Object(i.useState)(it.overview),s=Object(i.useMemo)((()=>[{id:it.overview,name:Object(u.jsx)(o.FormattedMessage,{id:"xpack.threatIntelligence.indicator.flyout.overviewTabLabel",defaultMessage:"Overview"}),content:Object(u.jsx)(at,{indicator:e,onViewAllFieldsInTable:()=>n(it.table)})},{id:it.table,name:Object(u.jsx)(o.FormattedMessage,{id:"xpack.threatIntelligence.indicator.flyout.tableTabLabel",defaultMessage:"Table"}),content:Object(u.jsx)(Ve,{indicator:e})},{id:it.json,name:Object(u.jsx)(o.FormattedMessage,{id:"xpack.threatIntelligence.indicator.flyout.jsonTabLabel",defaultMessage:"JSON"}),content:Object(u.jsx)(Ge,{indicator:e})}]),[e]),l=s.map(((e,t)=>Object(u.jsx)(r.EuiTab,{onClick:()=>{return t=e.id,n(t);var t},isSelected:e.id===a,key:t},e.name))),d=Object(i.useMemo)((()=>{var e;return null===(e=s.find((e=>e.id===a)))||void 0===e?void 0:e.content}),[a,s]),j=Object(ve.a)(e,c.b.FirstSeen),b=Object(r.useGeneratedHtmlId)({prefix:"simpleFlyoutTitle"});return Object(u.jsx)(r.EuiFlyout,{onClose:t,"aria-labelledby":b},Object(u.jsx)(r.EuiFlyoutHeader,{hasBorder:!0},Object(u.jsx)(r.EuiTitle,null,Object(u.jsx)("h2",{"data-test-subj":"tiIndicatorFlyoutTitle",id:b},Object(u.jsx)(o.FormattedMessage,{id:"xpack.threatIntelligence.indicator.flyout.panelTitleWithOverviewTab",defaultMessage:"Indicator details"}))),Object(u.jsx)(r.EuiSpacer,{size:"s"}),Object(u.jsx)(r.EuiText,{size:"xs"},Object(u.jsx)("p",{"data-test-subj":"tiIndicatorFlyoutSubtitle"},Object(u.jsx)(o.FormattedMessage,{id:"xpack.threatIntelligence.indicator.flyout.panelSubTitle",defaultMessage:"First seen: "}),Object(u.jsx)(Ee.a,{date:j}))),Object(u.jsx)(r.EuiSpacer,{size:"m"}),Object(u.jsx)(r.EuiTabs,{"data-test-subj":"tiIndicatorFlyoutTabs",style:{marginBottom:"-25px"}},l)),Object(u.jsx)(r.EuiFlyoutBody,null,d),Object(u.jsx)(r.EuiFlyoutFooter,null,Object(u.jsx)(r.EuiFlexGroup,{justifyContent:"flexEnd"},Object(u.jsx)(r.EuiFlexItem,{grow:!1},Object(u.jsx)(qe,{indicator:e})))))};var st=a(87),rt=a.n(st);const ot=[c.b.TimeStamp,c.b.Name,c.b.Type,c.b.Feed,c.b.FirstSeen,c.b.LastSeen].map((e=>({id:e,displayAsText:Ke(e)}))),ct=ot.map((e=>e.id)),lt="indicatorsTable",ut=l.i18n.translate("xpack.threatIntelligence.inspectTitle",{defaultMessage:"Inspect"}),dt={border:"horizontal",header:"underline",cellPadding:"m",fontSize:"s"},jt=({indicators:e,indicatorCount:t,onChangePage:a,onChangeItemsPerPage:s,pagination:l,isLoading:d,isFetching:j,browserFields:b,columnSettings:{columns:x,columnVisibility:g,handleResetColumns:p,handleToggleColumn:O,sorting:f}})=>{const[y,h]=Object(i.useState)(),T=Object(R.a)(),I=Object(i.useMemo)((()=>{return e=l.pageIndex*l.pageSize,({rowIndex:t,columnId:a,setCellProps:n})=>{const s=Object(i.useContext)(je);if(!s)throw new Error("this can only be used inside indicators table");const{services:{uiSettings:r}}=Object(R.e)(),o=r.get("theme:darkMode"),{indicators:c,expanded:l}=s,d=c[t-e];if(Object(i.useEffect)((()=>{l&&d&&l._id===d._id?n({style:{backgroundColor:o?Ce.euiDarkVars.euiColorHighlight:Ce.euiLightVars.euiColorHighlight}}):n({style:void 0})}),[o,l,d,n]),!d)return null;const j="Actions"===a?Object(u.jsx)(be,{indicator:d}):Object(u.jsx)(Pe,{indicator:d,field:a});return Object(u.jsx)("div",{css:{overflow:"hidden","text-overflow":"ellipsis","overflow-wrap":"initial","word-wrap":"initial","word-break":"initial"}},j)};var e}),[l.pageIndex,l.pageSize]),v=Object(i.useMemo)((()=>((e,t)=>a=>{const{rowIndex:i,columnId:s}=a,o=e[i%t.pageSize],{key:c,value:l}=Object(xe.b)(o,s);return Object(xe.a)(c,l)?Object(u.jsx)(n.a.Fragment,null,Object(u.jsx)(r.EuiPopoverTitle,{paddingSize:"m",css:{"max-width":"240px","word-break":"break-word"}},l),Object(u.jsx)(r.EuiFlexGroup,{gutterSize:"none"},Object(u.jsx)(r.EuiFlexItem,null,Object(u.jsx)(E,{data:o,field:c,"data-test-subj":"tiIndicatorsTableCellPopoverTimelineButton"})),Object(u.jsx)(r.EuiFlexItem,null,Object(u.jsx)(B,{data:o,field:c,"data-test-subj":"tiIndicatorsTableCellPopoverFilterInButton"}))),Object(u.jsx)(r.EuiFlexGroup,{gutterSize:"none"},Object(u.jsx)(r.EuiFlexItem,null,Object(u.jsx)(H,{data:o,field:c,"data-test-subj":"tiIndicatorsTableCellPopoverFilterOutButton"}))),Object(u.jsx)(r.EuiFlexGroup,{gutterSize:"none"},Object(u.jsx)(r.EuiFlexItem,null,Object(u.jsx)(m,{value:l})))):Object(u.jsx)(n.a.Fragment,null)})(e,l)),[e,l]),F=Object(i.useMemo)((()=>({expanded:y,setExpanded:h,indicators:e})),[y,e]),C=l.pageIndex*l.pageSize,k=C+l.pageSize,S=Object(i.useMemo)((()=>[{id:"Actions",width:84,headerCellRender:()=>Object(u.jsx)(o.FormattedMessage,{id:"xpack.threatIntelligence.indicator.table.actionColumnLabel",defaultMessage:"Actions"}),rowCellRender:I}]),[I]),M=Object(i.useMemo)((()=>x.map((t=>{var a;return{...t,isSortable:t.id!==c.b.Id&&(null===(a=b[t.id])||void 0===a?void 0:a.aggregatable),schema:pe(T[t.id]),cellActions:[({rowIndex:t,columnId:a,Component:i})=>Object(u.jsx)(Fe,{rowIndex:t,columnId:a,Component:i,indicators:e,pagination:l})]}}))),[b,x,T,e,l]),w=(({browserFields:e,start:t,end:a,indicatorCount:s,columns:o,onResetColumns:c,onToggleColumn:l})=>{const{onOpenInspector:d}=Object(R.b)();return Object(i.useMemo)((()=>({showDisplaySelector:!1,showFullScreenSelector:!0,additionalControls:{left:{prepend:Object(u.jsx)(r.EuiText,{style:{display:"inline"},size:"xs"},s&&a?Object(u.jsx)(n.a.Fragment,null,"Showing ",t+1,"-",a>s?s:a," of"," ",s," indicators"):Object(u.jsx)(n.a.Fragment,null,"-")),append:Object(u.jsx)(Be,{browserFields:e,columnIds:o.map((({id:e})=>e)),onResetColumns:c,onToggleColumn:l})},right:Object(u.jsx)(r.EuiButtonIcon,{iconType:"inspect",title:ut,"data-test-subj":"tiIndicatorsGridInspect",onClick:d})}})),[s,a,t,e,o,c,l,d])})({browserFields:b,start:C,end:k,indicatorCount:t,columns:x,onResetColumns:p,onToggleColumn:O}),P=Object(i.useMemo)((()=>y?Object(u.jsx)(nt,{indicator:y,closeFlyout:()=>h(void 0)}):null),[y]),z=Object(i.useMemo)((()=>d?Object(u.jsx)(r.EuiFlexGroup,{justifyContent:"spaceAround"},Object(u.jsx)(r.EuiFlexItem,{grow:!1},Object(u.jsx)(r.EuiPanel,{hasShadow:!1,hasBorder:!1,paddingSize:"xl"},Object(u.jsx)(r.EuiLoadingSpinner,{size:"xl"})))):t?Object(u.jsx)(n.a.Fragment,null,j&&Object(u.jsx)(r.EuiProgress,{"data-test-subj":"tiIndicatorsTable-updating",size:"xs",color:"accent",position:"absolute"}),Object(u.jsx)(r.EuiSpacer,{size:"xs"}),Object(u.jsx)(r.EuiDataGrid,{"aria-labelledby":"indicators-table",leadingControlColumns:S,rowCount:t,renderCellValue:I,renderCellPopover:v,toolbarVisibility:w,pagination:{...l,onChangeItemsPerPage:s,onChangePage:a},gridStyle:dt,"data-test-subj":"tiIndicatorsTable",sorting:f,columnVisibility:g,columns:M,rowHeightsOptions:{lineHeight:"30px"}})):Object(u.jsx)(_e,null)),[d,t,j,S,I,v,w,l,s,a,f,g,M]);return Object(u.jsx)(je.Provider,{value:F},Object(u.jsx)("div",{style:{position:"relative"}},P,z))},bt=c.b.TimeStamp,xt=c.b.Feed,gt="indicatorsBarchart";a(27);var pt=a(14);const Ot=[10,25,50],mt=Ot[1],ft="indicatorsTable";a(28);var yt=a(12);const ht=({children:e})=>{const t=Object(yt.a)().getPageWrapper();return Object(u.jsx)(t,null,e)},Tt=({children:e,pageTitle:t,border:a=!0,subHeader:i})=>Object(u.jsx)(ht,null,Object(u.jsx)(r.EuiPageHeader,{alignItems:"center",bottomBorder:a},Object(u.jsx)(r.EuiPageHeaderSection,null,t&&Object(u.jsx)(r.EuiText,null,Object(u.jsx)("h2",{"data-test-subj":"tiDefaultPageLayoutTitle"},t)),i?Object(u.jsx)(n.a.Fragment,null,Object(u.jsx)(r.EuiSpacer,{size:"m"}),i):null)),Object(u.jsx)(r.EuiSpacer,{size:"l"}),e),It=({children:e})=>{const t=Object(yt.a)().getFiltersGlobalComponent();return Object(u.jsx)(t,null,e)};var vt=a(40),Ft=a(41);const Ct=({children:e})=>{const t=Object(R.f)(),{services:{data:{query:{filterManager:a}}}}=Object(R.e)(),n=t.useFilters(),s=t.useQuery(),r=t.useGlobalTime(),o=Object(i.useMemo)((()=>({timeRange:r,filters:n,filterQuery:s,filterManager:a})),[n,s,r,a]);return Object(u.jsx)(Et.a.Provider,{value:o},e)};var Et=a(15);const kt=l.i18n.translate("xpack.threatIntelligence.updateStatus.updating",{defaultMessage:"Updating..."}),St=l.i18n.translate("xpack.threatIntelligence.updateStatus.updated",{defaultMessage:"Updated"}),Mt=({isUpdating:e,updatedAt:t})=>Object(u.jsx)(r.EuiFlexGroup,null,Object(u.jsx)(r.EuiFlexItem,{grow:!1},Object(u.jsx)(r.EuiText,{size:"xs",color:"subdued","data-test-subj":"updateStatus"},e?kt:Object(u.jsx)(n.a.Fragment,null,St," ",Object(u.jsx)(o.FormattedRelative,{value:new Date(t)}))))),wt=({indexPattern:e,queries:t})=>{const{SiemSearchBar:a,registerQuery:n,deregisterQuery:s}=Object(yt.a)();return Object(i.useEffect)((()=>(t.forEach(n),()=>t.forEach(s))),[t,s,n]),Object(u.jsx)(a,{id:"global",indexPattern:e})},Pt=({children:e})=>Object(u.jsx)(Ct,null,Object(u.jsx)(vt.b,null,Object(u.jsx)(Ft.b,null,e))),Bt=()=>{const{browserFields:e,indexPattern:t}=Object(pt.a)(),a=(()=>{const{services:{storage:e}}=Object(R.e)(),[t,a]=Object(i.useState)([]),n=Object(i.useMemo)((()=>({columns:t,onSort:a})),[t]),[s,r]=Object(i.useState)([]),[o,c]=Object(i.useState)([]);Object(i.useEffect)((()=>{const{visibleColumns:t=[],columns:i=[],sortingState:n=[]}=e.get(lt)||{visibleColumns:ct,columns:ot,sortingState:[]};c(t),r(i),a(n)}),[e]),Object(i.useEffect)((()=>{e.set(lt,{visibleColumns:o,columns:s,sortingState:t})}),[s,t,e,o]);const l=Object(i.useCallback)((e=>{r((t=>{const a=({id:t})=>t===e,i=rt()(a);return Boolean(t.find(a))?t.filter(i):[...t,{id:e,displayAsText:e}]})),c((t=>{const a=t=>t===e,i=rt()(a);return Boolean(t.find(a))?t.filter(i):[...t,e]}))}),[]),u=Object(i.useCallback)((()=>{r(ot),c(ct)}),[]),d=Object(i.useMemo)((()=>({visibleColumns:o,setVisibleColumns:c})),[o]);return{handleResetColumns:u,handleToggleColumn:l,columns:s,columnVisibility:d,sorting:n}})(),{timeRange:n,filters:r,filterQuery:o}=(()=>{const e=Object(i.useContext)(y.a);if(!e)throw new Error("Filters can only be used inside IndicatorFiltersContext");return e})(),{indicatorCount:c,indicators:l,onChangeItemsPerPage:d,onChangePage:j,pagination:b,isLoading:x,isFetching:g,dataUpdatedAt:p,query:O}=(({filters:e,filterQuery:t,sorting:a,timeRange:n})=>{const{services:{data:{search:r}}}=Object(R.e)(),{selectedPatterns:o}=Object(pt.a)(),{inspectorAdapters:c}=Object(R.b)(),l=Object(i.useCallback)((e=>j((t=>({...t,pageSize:e,pageIndex:0})))),[]),u=Object(i.useCallback)((e=>j((t=>({...t,pageIndex:e})))),[]),[d,j]=Object(i.useState)({pageIndex:0,pageSize:mt,pageSizeOptions:Ot});Object(i.useEffect)((()=>{u(0)}),[e,t,n,a,u]);const b=Object(i.useMemo)((()=>(({searchService:e,inspectorAdapter:t})=>async({pagination:a,selectedPatterns:i,timeRange:n,filterQuery:s,filters:r,sorting:o},c)=>{const l=fe({timeRange:n,filters:r,filterQuery:s}),u={size:a.pageSize,from:a.pageIndex,fields:[{field:"*",include_unmapped:!0}],sort:o.map((({id:e,direction:t})=>({[e]:t}))),...l},{hits:{hits:d,total:j}}=await Ie(e,{params:{index:i,body:u},factoryQueryType:Te.IndicatorGrid},{inspectorAdapter:t,requestName:"Indicators table",signal:c});return{indicators:d,total:j}})({searchService:r,inspectorAdapter:c.requests})),[c,r]),{isLoading:x,isFetching:g,data:p,refetch:O,dataUpdatedAt:m}=Object(s.useQuery)([ft,{timeRange:n,filterQuery:t,filters:e,selectedPatterns:o,sorting:a,pagination:d}],(({signal:e,queryKey:[t,a]})=>b(a,e)),{keepPreviousData:!0}),f=Object(i.useMemo)((()=>({refetch:O,id:ft,loading:x})),[x,O]);return{indicators:(null==p?void 0:p.indicators)||[],indicatorCount:(null==p?void 0:p.total)||0,pagination:d,onChangePage:u,onChangeItemsPerPage:l,isLoading:x,isFetching:g,dataUpdatedAt:m,query:f}})({filters:r,filterQuery:o,timeRange:n,sorting:a.sorting.columns}),{dateRange:m,series:f,selectedField:h,onFieldChange:T,isLoading:I,isFetching:v,query:F}=(({timeRange:e,filters:t,filterQuery:a})=>{const{services:{data:{search:n,query:r}}}=Object(R.e)(),{selectedPatterns:o}=Object(pt.a)(),{inspectorAdapters:c}=Object(R.b)(),[l,u]=Object(i.useState)(xt),d=Object(i.useMemo)((()=>(({inspectorAdapter:e,searchService:t,queryService:a})=>async({selectedPatterns:i,timeRange:n,field:s,filterQuery:r,filters:o},c)=>{const l=a.timefilter.timefilter.calculateBounds(n),u=l.min.toDate().getTime(),d=l.max.toDate().getTime(),j=fe({timeRange:n,filters:o,filterQuery:r}),b={fields:[bt,s],size:0,...j},{aggregations:{[he]:x}}=await Ie(t,{params:{index:i,body:b},factoryQueryType:Te.Barchart,dateRange:{from:u,to:d},field:s},{signal:c,inspectorAdapter:e,requestName:"Indicators barchart"});return(null==x?void 0:x.buckets).reduce(((e,t)=>e.concat(t.events.buckets.map((e=>({x:e.key_as_string,y:e.doc_count,g:t.key}))))),[])})({queryService:r,searchService:n,inspectorAdapter:c.requests})),[c,r,n]),{data:j,isLoading:b,isFetching:x,refetch:g}=Object(s.useQuery)([gt,{filters:t,field:l,filterQuery:a,selectedPatterns:o,timeRange:e}],(({signal:e,queryKey:[t,a]})=>d(a,e)),{keepPreviousData:!0}),p=Object(i.useMemo)((()=>r.timefilter.timefilter.calculateBounds(e)),[r.timefilter.timefilter,e]),O=Object(i.useMemo)((()=>({refetch:g,id:gt,loading:b})),[b,g]);return{dateRange:p,series:j||[],onFieldChange:u,selectedField:l,isLoading:b,isFetching:x,query:O}})({timeRange:n,filters:r,filterQuery:o});return Object(u.jsx)(vt.b,null,Object(u.jsx)(Tt,{pageTitle:"Indicators",subHeader:Object(u.jsx)(Mt,{isUpdating:g,updatedAt:p})},Object(u.jsx)(It,null,Object(u.jsx)(wt,{queries:[F,O],indexPattern:t})),Object(u.jsx)(ae,{dateRange:m,series:f,timeRange:n,indexPattern:t,field:h,onFieldChange:T,isFetching:v,isLoading:I}),Object(u.jsx)(jt,{browserFields:e,indexPattern:t,columnSettings:a,pagination:b,indicatorCount:c,indicators:l,isLoading:x,isFetching:g,onChangeItemsPerPage:d,onChangePage:j})))},zt=()=>Object(u.jsx)(Pt,null,Object(u.jsx)(Bt,null));var At=a(88),Lt=a.n(At),Rt=a(29);const _t=()=>{const e=Object(R.d)(),t=Object(R.g)();return Object(u.jsx)(Rt.a,{isEmptyState:!0},Object(u.jsx)(r.EuiEmptyPrompt,{icon:Object(u.jsx)(r.EuiImage,{size:"fullWidth",alt:l.i18n.translate("xpack.threatIntelligence.common.emptyPage.imgAlt",{defaultMessage:"Enable Threat Intelligence Integrations"}),src:Lt.a}),title:Object(u.jsx)("h3",null,Object(u.jsx)(o.FormattedMessage,{id:"xpack.threatIntelligence.common.emptyPage.title",defaultMessage:"Get started with Elastic Threat Intelligence"})),titleSize:"s",layout:"horizontal",color:"transparent",body:Object(u.jsx)(n.a.Fragment,null,Object(u.jsx)("p",null,Object(u.jsx)(o.FormattedMessage,{id:"xpack.threatIntelligence.common.emptyPage.body1",defaultMessage:"Elastic Threat Intelligence makes it easy to analyze and investigate potential security threats by aggregating data from multiple sources in one place."})),Object(u.jsx)("p",null,Object(u.jsx)(o.FormattedMessage,{id:"xpack.threatIntelligence.common.emptyPage.body2",defaultMessage:"You’ll be able to view data from all activated threat intelligence feeds and take action from this page."})),Object(u.jsx)("p",null,Object(u.jsx)(o.FormattedMessage,{id:"xpack.threatIntelligence.common.emptyPage.body3",defaultMessage:"To get started with Elastic Threat Intelligence, enable one or more Threat Intelligence Integrations from the Integrations page or ingest data using filebeat. For more information, view the {docsLink}.",values:{docsLink:Object(u.jsx)(r.EuiLink,{href:t,target:"_blank","data-test-subj":"tiEmptyPageDocsLink"},Object(u.jsx)(o.FormattedMessage,{id:"xpack.threatIntelligence.common.emptyPage.docsLinkText",defaultMessage:"Security app documentation"}))}}))),actions:Object(u.jsx)(r.EuiButton,{"data-test-subj":"tiEmptyPageIntegrationsPageLink",href:e,color:"primary",iconType:"plusInCircle",fill:!0},Object(u.jsx)(o.FormattedMessage,{id:"xpack.threatIntelligence.common.emptyPage.buttonText",defaultMessage:"Add Integrations"})),"data-test-subj":"tiEmptyPage"}))},qt=({children:e})=>{const{isLoading:t,count:a}=Object(y.f)(),{isLoading:i,data:s}=Object(R.c)();return i||t?Object(u.jsx)(Rt.a,{isEmptyState:!0},Object(u.jsx)(r.EuiLoadingLogo,{logo:"logoSecurity",size:"xl"})):a>0||(s||[]).length>0?Object(u.jsx)(n.a.Fragment,null,e):Object(u.jsx)(_t,null)},Nt="securitySolution",Gt=()=>{const{cases:e}=Object(R.e)().services,t=e.ui.getCasesContext(),a=new s.QueryClient;return Object(u.jsx)(t,{owner:[Nt],permissions:{all:!0,create:!0,read:!0,update:!0,delete:!0,push:!0}},Object(u.jsx)(s.QueryClientProvider,{client:a},Object(u.jsx)(qt,null,Object(u.jsx)(Rt.a,null,Object(u.jsx)(zt,null)))))};t.default=Gt}}]);