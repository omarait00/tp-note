/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.maps_bundle_jsonpfunction=window.maps_bundle_jsonpfunction||[]).push([[5],{162:function(e,t,s){"use strict";s.d(t,"a",(function(){return l})),s.d(t,"b",(function(){return a})),s.d(t,"c",(function(){return c}));var r=s(33),n=s.n(r),o=s(0);function i(e){return n.a.decode(decodeURIComponent(e).replace("%25","%"))}function l(e){return encodeURIComponent(n.a.encode(e).replace("%","%25"))}function a({encodedRequestBody:e,geometryFieldName:t,gridPrecision:s,hasLabels:r,index:n,renderAs:l=o.sb.POINT,x:a,y:c,z:u}){const d=i(e);return{path:`/${encodeURIComponent(n)}/_mvt/${t}/${u}/${a}/${c}`,body:{size:0,grid_precision:s,exact_bounds:!1,extent:4096,query:d.query,grid_agg:l===o.sb.HEX?"geohex":"geotile",grid_type:l===o.sb.GRID||l===o.sb.HEX?"grid":"centroid",aggs:d.aggs,fields:d.fields,runtime_mappings:d.runtime_mappings,with_labels:r}}}function c({encodedRequestBody:e,geometryFieldName:t,hasLabels:s,index:r,x:n,y:o,z:l}){const a=i(e);return{path:`/${encodeURIComponent(r)}/_mvt/${t}/${l}/${n}/${o}`,body:{grid_precision:0,exact_bounds:!0,extent:4096,query:a.query,fields:a.fields?a.fields:[],runtime_mappings:a.runtime_mappings,sort:a.sort?a.sort:[],track_total_hits:"number"==typeof a.size&&a.size+1,with_labels:s}}}},549:function(e,t,s){var r,n=function(){var e=String.fromCharCode,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",r={};function n(e,t){if(!r[e]){r[e]={};for(var s=0;s<e.length;s++)r[e][e.charAt(s)]=s}return r[e][t]}var o={compressToBase64:function(e){if(null==e)return"";var s=o._compress(e,6,(function(e){return t.charAt(e)}));switch(s.length%4){default:case 0:return s;case 1:return s+"===";case 2:return s+"==";case 3:return s+"="}},decompressFromBase64:function(e){return null==e?"":""==e?null:o._decompress(e.length,32,(function(s){return n(t,e.charAt(s))}))},compressToUTF16:function(t){return null==t?"":o._compress(t,15,(function(t){return e(t+32)}))+" "},decompressFromUTF16:function(e){return null==e?"":""==e?null:o._decompress(e.length,16384,(function(t){return e.charCodeAt(t)-32}))},compressToUint8Array:function(e){for(var t=o.compress(e),s=new Uint8Array(2*t.length),r=0,n=t.length;r<n;r++){var i=t.charCodeAt(r);s[2*r]=i>>>8,s[2*r+1]=i%256}return s},decompressFromUint8Array:function(t){if(null==t)return o.decompress(t);for(var s=new Array(t.length/2),r=0,n=s.length;r<n;r++)s[r]=256*t[2*r]+t[2*r+1];var i=[];return s.forEach((function(t){i.push(e(t))})),o.decompress(i.join(""))},compressToEncodedURIComponent:function(e){return null==e?"":o._compress(e,6,(function(e){return s.charAt(e)}))},decompressFromEncodedURIComponent:function(e){return null==e?"":""==e?null:(e=e.replace(/ /g,"+"),o._decompress(e.length,32,(function(t){return n(s,e.charAt(t))})))},compress:function(t){return o._compress(t,16,(function(t){return e(t)}))},_compress:function(e,t,s){if(null==e)return"";var r,n,o,i={},l={},a="",c="",u="",d=2,p=3,h=2,f=[],m=0,g=0;for(o=0;o<e.length;o+=1)if(a=e.charAt(o),Object.prototype.hasOwnProperty.call(i,a)||(i[a]=p++,l[a]=!0),c=u+a,Object.prototype.hasOwnProperty.call(i,c))u=c;else{if(Object.prototype.hasOwnProperty.call(l,u)){if(u.charCodeAt(0)<256){for(r=0;r<h;r++)m<<=1,g==t-1?(g=0,f.push(s(m)),m=0):g++;for(n=u.charCodeAt(0),r=0;r<8;r++)m=m<<1|1&n,g==t-1?(g=0,f.push(s(m)),m=0):g++,n>>=1}else{for(n=1,r=0;r<h;r++)m=m<<1|n,g==t-1?(g=0,f.push(s(m)),m=0):g++,n=0;for(n=u.charCodeAt(0),r=0;r<16;r++)m=m<<1|1&n,g==t-1?(g=0,f.push(s(m)),m=0):g++,n>>=1}0==--d&&(d=Math.pow(2,h),h++),delete l[u]}else for(n=i[u],r=0;r<h;r++)m=m<<1|1&n,g==t-1?(g=0,f.push(s(m)),m=0):g++,n>>=1;0==--d&&(d=Math.pow(2,h),h++),i[c]=p++,u=String(a)}if(""!==u){if(Object.prototype.hasOwnProperty.call(l,u)){if(u.charCodeAt(0)<256){for(r=0;r<h;r++)m<<=1,g==t-1?(g=0,f.push(s(m)),m=0):g++;for(n=u.charCodeAt(0),r=0;r<8;r++)m=m<<1|1&n,g==t-1?(g=0,f.push(s(m)),m=0):g++,n>>=1}else{for(n=1,r=0;r<h;r++)m=m<<1|n,g==t-1?(g=0,f.push(s(m)),m=0):g++,n=0;for(n=u.charCodeAt(0),r=0;r<16;r++)m=m<<1|1&n,g==t-1?(g=0,f.push(s(m)),m=0):g++,n>>=1}0==--d&&(d=Math.pow(2,h),h++),delete l[u]}else for(n=i[u],r=0;r<h;r++)m=m<<1|1&n,g==t-1?(g=0,f.push(s(m)),m=0):g++,n>>=1;0==--d&&(d=Math.pow(2,h),h++)}for(n=2,r=0;r<h;r++)m=m<<1|1&n,g==t-1?(g=0,f.push(s(m)),m=0):g++,n>>=1;for(;;){if(m<<=1,g==t-1){f.push(s(m));break}g++}return f.join("")},decompress:function(e){return null==e?"":""==e?null:o._decompress(e.length,32768,(function(t){return e.charCodeAt(t)}))},_decompress:function(t,s,r){var n,o,i,l,a,c,u,d=[],p=4,h=4,f=3,m="",g=[],y={val:r(0),position:s,index:1};for(n=0;n<3;n+=1)d[n]=n;for(i=0,a=Math.pow(2,2),c=1;c!=a;)l=y.val&y.position,y.position>>=1,0==y.position&&(y.position=s,y.val=r(y.index++)),i|=(l>0?1:0)*c,c<<=1;switch(i){case 0:for(i=0,a=Math.pow(2,8),c=1;c!=a;)l=y.val&y.position,y.position>>=1,0==y.position&&(y.position=s,y.val=r(y.index++)),i|=(l>0?1:0)*c,c<<=1;u=e(i);break;case 1:for(i=0,a=Math.pow(2,16),c=1;c!=a;)l=y.val&y.position,y.position>>=1,0==y.position&&(y.position=s,y.val=r(y.index++)),i|=(l>0?1:0)*c,c<<=1;u=e(i);break;case 2:return""}for(d[3]=u,o=u,g.push(u);;){if(y.index>t)return"";for(i=0,a=Math.pow(2,f),c=1;c!=a;)l=y.val&y.position,y.position>>=1,0==y.position&&(y.position=s,y.val=r(y.index++)),i|=(l>0?1:0)*c,c<<=1;switch(u=i){case 0:for(i=0,a=Math.pow(2,8),c=1;c!=a;)l=y.val&y.position,y.position>>=1,0==y.position&&(y.position=s,y.val=r(y.index++)),i|=(l>0?1:0)*c,c<<=1;d[h++]=e(i),u=h-1,p--;break;case 1:for(i=0,a=Math.pow(2,16),c=1;c!=a;)l=y.val&y.position,y.position>>=1,0==y.position&&(y.position=s,y.val=r(y.index++)),i|=(l>0?1:0)*c,c<<=1;d[h++]=e(i),u=h-1,p--;break;case 2:return g.join("")}if(0==p&&(p=Math.pow(2,f),f++),d[u])m=d[u];else{if(u!==h)return null;m=o+o.charAt(0)}g.push(m),d[h++]=o+m.charAt(0),o=m,0==--p&&(p=Math.pow(2,f),f++)}}};return o}();void 0===(r=function(){return n}.call(t,s,t,e))||(e.exports=r)},559:function(e,t,s){"use strict";s.r(t);var r=s(3),n=s.n(r),o=s(28),i=s.n(o),l=s(5),a=s.n(l),c=s(1),u=s(15),d=s(47),p=s(2);function h(){return Object(p.jsx)(u.EuiEmptyPrompt,{title:Object(p.jsx)("h2",null,Object(p.jsx)(d.FormattedMessage,{id:"xpack.maps.inspector.vectorTile.noRequestsLoggedTitle",defaultMessage:"No requests logged for vector tiles"})),body:Object(p.jsx)(a.a.Fragment,null,Object(p.jsx)("p",null,Object(p.jsx)(d.FormattedMessage,{id:"xpack.maps.inspector.vectorTile.noRequestsLoggedDescription.mapHasNotLoggedAnyRequestsText",defaultMessage:"This map does not have any vector tile search results."})))})}var f=s(66),m=s(16),g=s(549),y=s(4),b=s(0),v=s(162);function x(e){try{const{path:s,body:r}=function(e){const t=function(e){const t=e.split("?"),s=t.length<=1?"":t[1];return new URLSearchParams(s)}(e.tileUrl),s=t.has("requestBody")?t.get("requestBody"):"()";if(!t.has("index"))throw new Error("Required query parameter 'index' not provided.");const r=t.get("index");if(!t.has("geometryFieldName"))throw new Error("Required query parameter 'geometryFieldName' not provided.");const n=t.get("geometryFieldName"),o=!!t.has("hasLabels")&&"true"===t.get("hasLabels");if(e.tileUrl.includes(b.mb))return Object(v.b)({encodedRequestBody:s,geometryFieldName:n,gridPrecision:parseInt(t.get("gridPrecision"),10),hasLabels:o,index:r,renderAs:t.get("renderAs"),x:e.x,y:e.y,z:e.z});if(e.tileUrl.includes(b.nb))return Object(v.c)({encodedRequestBody:s,geometryFieldName:n,hasLabels:o,index:r,x:e.x,y:e.y,z:e.z});throw new Error("Unexpected path")}(e.tileRequest),n=`POST ${s}\n${JSON.stringify(r,null,2)}`;let o;if(Object(y.i)().show){var t;const e=Object(g.compressToEncodedURIComponent)(n);o=null===(t=Object(y.L)().url.locators.get("CONSOLE_APP_LOCATOR"))||void 0===t?void 0:t.useUrl({loadFrom:`data:text/plain,${e}`})}return Object(p.jsx)(u.EuiFlexGroup,{direction:"column",gutterSize:"s",wrap:!1,responsive:!0,style:{height:"100%"}},Object(p.jsx)(u.EuiFlexItem,{grow:!1},Object(p.jsx)(u.EuiSpacer,{size:"s"}),Object(p.jsx)(u.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"m",wrap:!0},Object(p.jsx)(u.EuiFlexItem,{grow:!1},Object(p.jsx)("div",null,Object(p.jsx)(u.EuiCopy,{textToCopy:n},(e=>Object(p.jsx)(u.EuiButtonEmpty,{size:"xs",flush:"right",iconType:"copyClipboard",onClick:e},c.i18n.translate("xpack.maps.inspector.vectorTileRequest.copyToClipboardLabel",{defaultMessage:"Copy to clipboard"})))))),void 0!==o&&Object(p.jsx)(u.EuiFlexItem,{grow:!1},Object(p.jsx)("div",null,Object(p.jsx)(u.EuiButtonEmpty,{size:"xs",flush:"right",onClick:()=>{Object(y.C)()(o)},iconType:"wrench"},c.i18n.translate("xpack.maps.inspector.vectorTileRequest.openInConsoleLabel",{defaultMessage:"Open in Console"})))))),Object(p.jsx)(u.EuiFlexItem,{grow:!0},Object(p.jsx)(m.CodeEditor,{languageId:f.XJsonLang.ID,value:n,options:{readOnly:!0,lineNumbers:"off",fontSize:12,minimap:{enabled:!1},folding:!0,scrollBeyondLastLine:!1,wordWrap:"on",wrappingIndent:"indent",automaticLayout:!0}})))}catch(t){return Object(p.jsx)(u.EuiCallOut,{title:c.i18n.translate("xpack.maps.inspector.vectorTileRequest.errorMessage",{defaultMessage:"Unable to create Elasticsearch vector tile search request"}),color:"warning",iconType:"help"},Object(p.jsx)("p",null,c.i18n.translate("xpack.maps.inspector.vectorTileRequest.errorTitle",{defaultMessage:"Could not convert tile request, '{tileUrl}', to Elasticesarch vector tile search request, error: {error}",values:{tileUrl:e.tileRequest.tileUrl,error:t.message}})))}}function j(){return Object(p.jsx)(u.EuiCallOut,{size:"s",title:c.i18n.translate("xpack.maps.inspector.vectorTile.requestsView",{defaultMessage:"You're viewing vector tile search requests. To view requests submitted to the search API, set View to Requests."}),iconType:"iInCircle"})}class vector_tile_inspector_VectorTileInspector extends l.Component{constructor(...e){super(...e),n()(this,"_isMounted",!1),n()(this,"state",{selectedLayer:null,selectedTileRequest:null,tileRequests:[],layerOptions:[]}),n()(this,"_onAdapterChange",(()=>{const e=this.props.adapters.vectorTiles.getLayerOptions();if(0===e.length)return void this.setState({selectedLayer:null,selectedTileRequest:null,tileRequests:[],layerOptions:[]});const t=this.state.selectedLayer&&e.some((e=>{var t;return(null===(t=this.state.selectedLayer)||void 0===t?void 0:t.value)===e.value}))?this.state.selectedLayer:e[0],s=this.props.adapters.vectorTiles.getTileRequests(t.value),r=this.state.selectedTileRequest&&s.some((e=>{var t,s,r,n;return(null===(t=this.state.selectedTileRequest)||void 0===t?void 0:t.layerId)===e.layerId&&(null===(s=this.state.selectedTileRequest)||void 0===s?void 0:s.x)===e.x&&(null===(r=this.state.selectedTileRequest)||void 0===r?void 0:r.y)===e.y&&(null===(n=this.state.selectedTileRequest)||void 0===n?void 0:n.z)===e.z}))?this.state.selectedTileRequest:s.length?s[0]:null;this.setState({selectedLayer:t,selectedTileRequest:r,tileRequests:s,layerOptions:e})})),n()(this,"_debouncedOnAdapterChange",i.a.debounce((()=>{this._isMounted&&this._onAdapterChange()}),256)),n()(this,"_onLayerSelect",(e=>{if(0===e.length)return void this.setState({selectedLayer:null,selectedTileRequest:null,tileRequests:[]});const t=e[0],s=this.props.adapters.vectorTiles.getTileRequests(t.value);this.setState({selectedLayer:t,selectedTileRequest:s.length?s[0]:null,tileRequests:s})}))}componentDidMount(){this._isMounted=!0,this._onAdapterChange(),this.props.adapters.vectorTiles.on("change",this._debouncedOnAdapterChange)}componentWillUnmount(){this._isMounted=!1,this.props.adapters.vectorTiles.removeListener("change",this._debouncedOnAdapterChange)}renderTabs(){return this.state.tileRequests.map((e=>{var t,s,r,n;const o=`${e.z}/${e.x}/${e.y}`;return Object(p.jsx)(u.EuiTab,{key:`${e.layerId}${o}`,onClick:()=>{this.setState({selectedTileRequest:e})},isSelected:e.layerId===(null===(t=this.state.selectedTileRequest)||void 0===t?void 0:t.layerId)&&e.x===(null===(s=this.state.selectedTileRequest)||void 0===s?void 0:s.x)&&e.y===(null===(r=this.state.selectedTileRequest)||void 0===r?void 0:r.y)&&e.z===(null===(n=this.state.selectedTileRequest)||void 0===n?void 0:n.z)},o)}))}render(){return 0===this.state.layerOptions.length?Object(p.jsx)(a.a.Fragment,null,Object(p.jsx)(j,null),Object(p.jsx)(h,null)):Object(p.jsx)(a.a.Fragment,null,Object(p.jsx)(j,null),Object(p.jsx)(u.EuiSpacer,null),Object(p.jsx)(u.EuiComboBox,{singleSelection:!0,options:this.state.layerOptions,selectedOptions:this.state.selectedLayer?[this.state.selectedLayer]:[],onChange:this._onLayerSelect,isClearable:!1,prepend:c.i18n.translate("xpack.maps.inspector.vectorTile.layerSelectPrepend",{defaultMessage:"Layer"})}),Object(p.jsx)(u.EuiSpacer,null),Object(p.jsx)(u.EuiTabs,{size:"s"},this.renderTabs()),Object(p.jsx)(u.EuiSpacer,{size:"s"}),this.state.selectedTileRequest&&Object(p.jsx)(x,{key:`${this.state.selectedTileRequest.layerId}${this.state.selectedTileRequest.x}${this.state.selectedTileRequest.y}${this.state.selectedTileRequest.z}`,tileRequest:this.state.selectedTileRequest}))}}t.default=vector_tile_inspector_VectorTileInspector}}]);