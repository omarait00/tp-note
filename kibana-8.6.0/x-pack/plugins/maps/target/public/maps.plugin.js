/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */!function(e){function t(t){for(var n,i,a=t[0],o=t[1],s=0,u=[];s<a.length;s++)i=a[s],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&u.push(r[i][0]),r[i]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(c&&c(t);u.length;)u.shift()()}var n={},r={2:0};function i(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.e=function(e){var t=[],n=r[e];if(0!==n)if(n)t.push(n[2]);else{var a=new Promise((function(t,i){n=r[e]=[t,i]}));t.push(n[2]=a);var o,s=document.createElement("script");s.charset="utf-8",s.timeout=120,i.nc&&s.setAttribute("nonce",i.nc),s.src=function(e){return i.p+"maps.chunk."+e+".js"}(e);var c=new Error;o=function(t){s.onerror=s.onload=null,clearTimeout(u);var n=r[e];if(0!==n){if(n){var i=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+i+": "+a+")",c.name="ChunkLoadError",c.type=i,c.request=a,n[1](c)}r[e]=void 0}};var u=setTimeout((function(){o({type:"timeout",target:s})}),12e4);s.onerror=s.onload=o,document.head.appendChild(s)}return Promise.all(t)},i.m=e,i.c=n,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i.oe=function(e){throw console.error(e),e};var a=window.maps_bundle_jsonpfunction=window.maps_bundle_jsonpfunction||[],o=a.push.bind(a);a.push=t,a=a.slice();for(var s=0;s<a.length;s++)t(a[s]);var c=o;i(i.s=44)}([function(e,t,n){"use strict";n.d(t,"fb",(function(){return i})),n.d(t,"e",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"f",(function(){return c})),n.d(t,"T",(function(){return u})),n.d(t,"eb",(function(){return d})),n.d(t,"M",(function(){return p})),n.d(t,"R",(function(){return f})),n.d(t,"G",(function(){return _})),n.d(t,"S",(function(){return b})),n.d(t,"Q",(function(){return m})),n.d(t,"L",(function(){return g})),n.d(t,"i",(function(){return y})),n.d(t,"nb",(function(){return h})),n.d(t,"mb",(function(){return E})),n.d(t,"pb",(function(){return O})),n.d(t,"W",(function(){return v})),n.d(t,"Jb",(function(){return S})),n.d(t,"Ib",(function(){return L})),n.d(t,"ab",(function(){return T})),n.d(t,"yb",(function(){return I})),n.d(t,"F",(function(){return A})),n.d(t,"V",(function(){return M})),n.d(t,"jb",(function(){return C})),n.d(t,"H",(function(){return N})),n.d(t,"vb",(function(){return P})),n.d(t,"xb",(function(){return R})),n.d(t,"wb",(function(){return x})),n.d(t,"ub",(function(){return j})),n.d(t,"kb",(function(){return D})),n.d(t,"gb",(function(){return w})),n.d(t,"p",(function(){return k})),n.d(t,"Gb",(function(){return F})),n.d(t,"v",(function(){return V})),n.d(t,"u",(function(){return U})),n.d(t,"t",(function(){return G})),n.d(t,"E",(function(){return B})),n.d(t,"ib",(function(){return z})),n.d(t,"B",(function(){return Y})),n.d(t,"C",(function(){return H})),n.d(t,"D",(function(){return J})),n.d(t,"K",(function(){return $})),n.d(t,"rb",(function(){return W})),n.d(t,"cb",(function(){return q})),n.d(t,"Y",(function(){return Z})),n.d(t,"A",(function(){return K})),n.d(t,"y",(function(){return X})),n.d(t,"z",(function(){return Q})),n.d(t,"a",(function(){return ee})),n.d(t,"b",(function(){return te})),n.d(t,"sb",(function(){return ne})),n.d(t,"N",(function(){return re})),n.d(t,"J",(function(){return ie})),n.d(t,"I",(function(){return ae})),n.d(t,"Cb",(function(){return oe})),n.d(t,"w",(function(){return se})),n.d(t,"k",(function(){return ce})),n.d(t,"l",(function(){return ue})),n.d(t,"Ab",(function(){return le})),n.d(t,"Z",(function(){return de})),n.d(t,"j",(function(){return pe})),n.d(t,"h",(function(){return fe})),n.d(t,"qb",(function(){return _e})),n.d(t,"Bb",(function(){return be})),n.d(t,"X",(function(){return me})),n.d(t,"s",(function(){return ge})),n.d(t,"q",(function(){return ye})),n.d(t,"r",(function(){return he})),n.d(t,"n",(function(){return Ee})),n.d(t,"m",(function(){return Oe})),n.d(t,"db",(function(){return ve})),n.d(t,"O",(function(){return Se})),n.d(t,"P",(function(){return Le})),n.d(t,"Eb",(function(){return Te})),n.d(t,"tb",(function(){return Ie})),n.d(t,"lb",(function(){return Ae})),n.d(t,"zb",(function(){return Me})),n.d(t,"U",(function(){return Ce})),n.d(t,"bb",(function(){return Ne})),n.d(t,"Db",(function(){return Pe})),n.d(t,"hb",(function(){return Re})),n.d(t,"o",(function(){return xe})),n.d(t,"x",(function(){return je})),n.d(t,"ob",(function(){return De})),n.d(t,"g",(function(){return we})),n.d(t,"Hb",(function(){return ke})),n.d(t,"Fb",(function(){return Fe}));var r=n(1);const i="map",a="maps",o="gisApp",s="logoKibana",c=r.i18n.translate("xpack.maps.visTypeAlias.title",{defaultMessage:"Maps"}),u="initialLayers",l=`app/${a}`,d="map",p=`api/${a}`,f=`${p}/indexSettings`,_=`${p}/fonts`,b=`${p}/docSource`,m=`/${p}/feature`,g=`/${p}/getMatchingIndexes`,y=`/${p}/checkIsDrawingIndex`,h="mvt/getTile",E="mvt/getGridTile",O="openLayerWizard",v="__kbn_is_centroid_feature__";function S(e){return`/${l}${L(e)}`}function L(e){return e?`/${d}/${e}`:`/${d}`}let T,I,A;!function(e){e.RASTER_TILE="RASTER_TILE",e.GEOJSON_VECTOR="GEOJSON_VECTOR",e.EMS_VECTOR_TILE="EMS_VECTOR_TILE",e.HEATMAP="HEATMAP",e.BLENDED_VECTOR="BLENDED_VECTOR",e.MVT_VECTOR="MVT_VECTOR",e.LAYER_GROUP="LAYER_GROUP"}(T||(T={})),function(e){e.EMS_TMS="EMS_TMS",e.EMS_FILE="EMS_FILE",e.ES_GEO_GRID="ES_GEO_GRID",e.ES_GEO_LINE="ES_GEO_LINE",e.ES_SEARCH="ES_SEARCH",e.ES_PEW_PEW="ES_PEW_PEW",e.ES_TERM_SOURCE="ES_TERM_SOURCE",e.ES_ML_ANOMALIES="ML_ANOMALIES",e.EMS_XYZ="EMS_XYZ",e.WMS="WMS",e.KIBANA_TILEMAP="KIBANA_TILEMAP",e.GEOJSON_FILE="GEOJSON_FILE",e.MVT_SINGLE_LAYER="MVT_SINGLE_LAYER",e.TABLE_SOURCE="TABLE_SOURCE"}(I||(I={})),function(e){e.SOURCE="source",e.JOIN="join"}(A||(A={}));const M="__kbnjoin__",C="meta",N="formatters",P="source",R=`${P}_${C}`,x=`${P}_${N}`,j=`${P}_bounds`,D=0,w=24,k=5,F=2,V=1e4,U=100,G=65535,B="__kbn_isvisibleduetojoin__",z="_";let Y;!function(e){e.GEO_POINT="geo_point",e.GEO_SHAPE="geo_shape"}(Y||(Y={}));const H=["geo_point","geo_shape"];let J,$;!function(e){e.INTERSECTS="INTERSECTS",e.DISJOINT="DISJOINT",e.WITHIN="WITHIN"}(J||(J={})),function(e){e.POINT="Point",e.MULTI_POINT="MultiPoint",e.LINE_STRING="LineString",e.MULTI_LINE_STRING="MultiLineString",e.POLYGON="Polygon",e.MULTI_POLYGON="MultiPolygon",e.GEOMETRY_COLLECTION="GeometryCollection"}($||($={}));const W=0,q=0,Z=1,K={type:"FeatureCollection",features:[]};let X,Q;!function(e){e.DRAW_SHAPES="DRAW_SHAPES",e.DRAW_POINTS="DRAW_POINTS",e.DRAW_FILTERS="DRAW_FILTERS",e.NONE="NONE"}(X||(X={})),function(e){e.BOUNDS="BOUNDS",e.DISTANCE="DISTANCE",e.POLYGON="POLYGON",e.POINT="POINT",e.LINE="LINE",e.SIMPLE_SELECT="SIMPLE_SELECT",e.DELETE="DELETE",e.WAIT="WAIT"}(Q||(Q={}));const ee="_of_";let te,ne,re;!function(e){e.AVG="avg",e.COUNT="count",e.MAX="max",e.MIN="min",e.SUM="sum",e.TERMS="terms",e.PERCENTILE="percentile",e.UNIQUE_COUNT="cardinality"}(te||(te={})),function(e){e.HEATMAP="heatmap",e.POINT="point",e.GRID="grid",e.HEX="hex"}(ne||(ne={})),function(e){e.COARSE="COARSE",e.FINE="FINE",e.MOST_FINE="MOST_FINE",e.SUPER_FINE="SUPER_FINE"}(re||(re={}));const ie="gridSplit",ae="gridCentroid",oe="__percentage",se=50,ce=r.i18n.translate("xpack.maps.aggs.defaultCountLabel",{defaultMessage:"count"}),ue="doc_count";let le,de,pe;!function(e){e.STATIC="STATIC",e.DYNAMIC="DYNAMIC"}(le||(le={})),function(e){e.VECTOR="VECTOR",e.HEATMAP="HEATMAP",e.TILE="TILE",e.EMS_VECTOR_TILE="EMS_VECTOR_TILE"}(de||(de={})),function(e){e.CATEGORICAL="CATEGORICAL",e.ORDINAL="ORDINAL"}(pe||(pe={}));const fe=["string","ip","boolean"],_e=["number","date"];let be,me;!function(e){e.CIRCLE="circle",e.ICON="icon"}(be||(be={})),function(e){e.NONE="NONE",e.SMALL="SMALL",e.MEDIUM="MEDIUM",e.LARGE="LARGE"}(me||(me={}));const ge="marker",ye=.25,he=.25,Ee=64,Oe="__kbn__custom_icon_sdf__",ve=16,Se=ve/2;let Le,Te,Ie,Ae;!function(e){e.CUSTOM="CUSTOM",e.MAKI="MAKI"}(Le||(Le={})),function(e){e.SYMBOLIZE_AS="symbolizeAs",e.FILL_COLOR="fillColor",e.LINE_COLOR="lineColor",e.LINE_WIDTH="lineWidth",e.ICON="icon",e.ICON_SIZE="iconSize",e.ICON_ORIENTATION="iconOrientation",e.LABEL_TEXT="labelText",e.LABEL_ZOOM_RANGE="labelZoomRange",e.LABEL_COLOR="labelColor",e.LABEL_SIZE="labelSize",e.LABEL_BORDER_COLOR="labelBorderColor",e.LABEL_BORDER_SIZE="labelBorderSize"}(Te||(Te={})),function(e){e.LIMIT="LIMIT",e.CLUSTERS="CLUSTERS",e.TOP_HITS="TOP_HITS",e.MVT="MVT"}(Ie||(Ie={})),function(e){e.STRING="String",e.NUMBER="Number"}(Ae||(Ae={}));const Me="SPATIAL_FILTERS_LAYER_ID";let Ce,Ne,Pe,Re,xe;!function(e){e.LAST_SAVED_LOCATION="LAST_SAVED_LOCATION",e.FIXED_LOCATION="FIXED_LOCATION",e.BROWSER_LOCATION="BROWSER_LOCATION",e.AUTO_FIT_TO_BOUNDS="AUTO_FIT_TO_BOUNDS"}(Ce||(Ce={})),function(e){e.ELASTICSEARCH="ELASTICSEARCH",e.REFERENCE="REFERENCE",e.SOLUTIONS="SOLUTIONS"}(Ne||(Ne={})),function(e){e.POINT="POINT",e.LINE="LINE",e.POLYGON="POLYGON"}(Pe||(Pe={})),function(e){e.GET="get",e.FEATURE_STATE="feature-state"}(Re||(Re={})),function(e){e.INTERPOLATE="INTERPOLATE",e.PERCENTILES="PERCENTILES"}(xe||(xe={}));const je=[50,75,90,95,99],De="none",we="autoselect",ke="world_countries";let Fe;!function(e){e.CHOROPLETH="choropleth",e.GEO_FILE="uploadGeoFile",e.LAYER_GROUP="layerGroup",e.NEW_VECTOR="newVectorLayer",e.OBSERVABILITY="observabilityLayer",e.SECURITY="securityLayer",e.EMS_BOUNDARIES="emsBoundaries",e.EMS_BASEMAP="emsBaseMap",e.CLUSTERS="clusters",e.HEATMAP="heatmap",e.GEO_LINE="geoLine",e.POINT_2_POINT="point2Point",e.ES_DOCUMENT="esDocument",e.ES_TOP_HITS="esTopHits",e.KIBANA_BASEMAP="kibanaBasemap",e.MVT_VECTOR="mvtVector",e.WMS_LAYER="wmsLayer",e.TMS_LAYER="tmsLayer"}(Fe||(Fe={}))},function(e,t){e.exports=__kbnSharedDeps__.KbnI18n},function(e,t){e.exports=__kbnSharedDeps__.EmotionReact},function(e,t,n){e.exports=n(30)(2)},function(e,t,n){"use strict";let r,i,a,o;function s(e,t){r=e,i=t,a=t.mapsEms,o=a.createEMSSettings()}n.d(t,"ab",(function(){return s})),n.d(t,"Y",(function(){return u})),n.d(t,"w",(function(){return l})),n.d(t,"r",(function(){return d})),n.d(t,"p",(function(){return p})),n.d(t,"t",(function(){return f})),n.d(t,"b",(function(){return _})),n.d(t,"u",(function(){return b})),n.d(t,"o",(function(){return m})),n.d(t,"T",(function(){return g})),n.d(t,"x",(function(){return y})),n.d(t,"s",(function(){return h})),n.d(t,"I",(function(){return E})),n.d(t,"q",(function(){return O})),n.d(t,"n",(function(){return v})),n.d(t,"Q",(function(){return S})),n.d(t,"R",(function(){return L})),n.d(t,"G",(function(){return T})),n.d(t,"e",(function(){return I})),n.d(t,"i",(function(){return A})),n.d(t,"z",(function(){return M})),n.d(t,"W",(function(){return C})),n.d(t,"j",(function(){return N})),n.d(t,"g",(function(){return P})),n.d(t,"h",(function(){return R})),n.d(t,"S",(function(){return x})),n.d(t,"d",(function(){return j})),n.d(t,"D",(function(){return D})),n.d(t,"f",(function(){return w})),n.d(t,"J",(function(){return k})),n.d(t,"l",(function(){return F})),n.d(t,"B",(function(){return V})),n.d(t,"U",(function(){return U})),n.d(t,"C",(function(){return G})),n.d(t,"H",(function(){return B})),n.d(t,"E",(function(){return z})),n.d(t,"K",(function(){return Y})),n.d(t,"N",(function(){return H})),n.d(t,"O",(function(){return J})),n.d(t,"a",(function(){return $})),n.d(t,"V",(function(){return W})),n.d(t,"X",(function(){return q})),n.d(t,"Z",(function(){return K})),n.d(t,"y",(function(){return X})),n.d(t,"M",(function(){return Q})),n.d(t,"F",(function(){return ee})),n.d(t,"A",(function(){return te})),n.d(t,"k",(function(){return ne})),n.d(t,"m",(function(){return re})),n.d(t,"P",(function(){return ie})),n.d(t,"L",(function(){return ae})),n.d(t,"v",(function(){return oe})),n.d(t,"c",(function(){return se}));let c=!1;function u(e){c=e}const l=()=>c,d=()=>i.fileUpload.IndexNameFormComponent,p=()=>i.fileUpload.FileUploadComponent,f=()=>i.data.dataViews,_=()=>i.unifiedSearch.autocomplete,b=()=>i.inspector,m=()=>i.fileUpload,g=()=>r.uiSettings,y=()=>g().get("theme:darkMode",!1),h=()=>i.unifiedSearch.ui.IndexPatternSelect,E=()=>i.unifiedSearch.ui.SearchBar,O=()=>r.http,v=()=>r.executionContext,S=()=>i.data.query.timefilter.timefilter,L=()=>r.notifications.toasts,T=()=>r.savedObjects.client,I=()=>r.chrome,A=()=>r.application.capabilities.dev_tools,M=()=>r.application.capabilities.maps,C=()=>r.application.capabilities.visualize,N=()=>r.docLinks,P=()=>r.overlays,R=()=>i.data,x=()=>i.uiActions,j=()=>r,D=()=>i.navigation,w=()=>r.i18n,k=()=>i.data.search,F=()=>i.embeddable,V=()=>r.application.navigateToApp,U=()=>r.application.getUrlForApp,G=()=>r.application.navigateToUrl,B=()=>i.savedObjectsTagging,z=()=>i.presentationUtil.ContextProvider,Y=()=>i.security,H=()=>i.spaces,J=()=>r.theme,$=()=>r.application,W=()=>i.usageCollection,q=()=>!!i.screenshotMode&&i.screenshotMode.isScreenshotMode();let Z;const K=e=>Z=e,X=()=>Z,Q=()=>X().showMapsInspectorAdapter,ee=()=>X().preserveDrawingBuffer,te=()=>a,ne=()=>o,re=()=>a.config.emsTileLayerId,ie=()=>a.config.tilemap?a.config.tilemap:{},ae=()=>i.share,oe=()=>i.dashboard.dashboardFeatureFlagConfig.allowByValueEmbeddables;async function se(){const e=i.charts?await i.charts.palettes.getPalettes():null;if(!e)return null;const t=e.get("default"),n={syncColors:!0};return e=>{const r=[{name:e,rankAtDepth:0,totalSeriesAtDepth:1}];return t.getCategoricalColor(r,n)||"#3d3d3d"}}},function(e,t){e.exports=__kbnSharedDeps__.React},function(e,t,n){"use strict";let r;async function i(){return void 0!==r||(r=new Promise((async(e,t)=>{try{const{MapEmbeddable:t,getIndexPatternService:r,getMapsCapabilities:i,renderApp:a,createSecurityLayerDescriptors:o,createTileMapLayerDescriptor:s,createRegionMapLayerDescriptor:c,createBasemapLayerDescriptor:u,createESSearchSourceLayerDescriptor:l,suggestEMSTermJoinConfig:d}=await Promise.all([n.e(0),n.e(3)]).then(n.bind(null,68));e({MapEmbeddable:t,getIndexPatternService:r,getMapsCapabilities:i,renderApp:a,createSecurityLayerDescriptors:o,createTileMapLayerDescriptor:s,createRegionMapLayerDescriptor:c,createBasemapLayerDescriptor:u,createESSearchSourceLayerDescriptor:l,suggestEMSTermJoinConfig:d})}catch(e){t(e)}}))),r}n.d(t,"a",(function(){return i}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(5),i=n(15),a=n(2);const o=()=>Object(a.jsx)(i.EuiDelayRender,null,Object(a.jsx)(i.EuiLoadingContent,{lines:3}));function s({getLazyComponent:e,lazyComponentProps:t}){const n=e();return Object(a.jsx)(i.EuiErrorBoundary,null,Object(a.jsx)(r.Suspense,{fallback:Object(a.jsx)(o,null)},Object(a.jsx)(n,t)))}},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/uiActions/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t){e.exports=__kbnSharedDeps__.ReactDom},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return a}));const r="tile_map_vis",i="tile_map";let a;!function(e){e.ScaledCircleMarkers="Scaled Circle Markers",e.Heatmap="Heatmap"}(a||(a={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));const r="region_map_vis",i="region_map"},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"g",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"h",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"e",(function(){return d})),n.d(t,"d",(function(){return p}));var r=n(1),i=n(0);function a(){return r.i18n.translate("xpack.maps.appTitle",{defaultMessage:"Maps"})}function o(){return r.i18n.translate("xpack.maps.embeddableDisplayName",{defaultMessage:"map"})}function s(){return r.i18n.translate("xpack.maps.source.dataSourceLabel",{defaultMessage:"Data source"})}function c(){return r.i18n.translate("xpack.maps.source.urlLabel",{defaultMessage:"Url"})}function u(e){switch(e){case i.D.INTERSECTS:return r.i18n.translate("xpack.maps.common.esSpatialRelation.intersectsLabel",{defaultMessage:"intersects"});case i.D.DISJOINT:return r.i18n.translate("xpack.maps.common.esSpatialRelation.disjointLabel",{defaultMessage:"disjoint"});case i.D.WITHIN:return r.i18n.translate("xpack.maps.common.esSpatialRelation.withinLabel",{defaultMessage:"within"});case i.D.CONTAINS:return r.i18n.translate("xpack.maps.common.esSpatialRelation.containsLabel",{defaultMessage:"contains"});default:return e}}function l(){return r.i18n.translate("xpack.maps.dataView.label",{defaultMessage:"Data view"})}function d(){return r.i18n.translate("xpack.maps.dataView.selectPlacholder",{defaultMessage:"Select data view"})}function p(e){return r.i18n.translate("xpack.maps.dataView.notFoundMessage",{defaultMessage:"Unable to find data view '{id}'",values:{id:e}})}},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/expressions/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t,n){"use strict";function r({attributes:e,references:t=[]}){if(!e.layerListJSON)return{attributes:e,references:t};const n=[];if(e.mapStateJSON)try{const t=JSON.parse(e.mapStateJSON);t.adHocDataViews&&t.adHocDataViews.length>0&&t.adHocDataViews.forEach((e=>{e.id&&n.push(e.id)}))}catch(e){throw new Error("Unable to parse attribute mapStateJSON")}const r=[];let i=[];try{i=JSON.parse(e.layerListJSON)}catch(e){throw new Error("Unable to parse attribute layerListJSON")}return i.forEach(((e,t)=>{if(e.sourceDescriptor&&"indexPatternId"in e.sourceDescriptor&&!n.includes(e.sourceDescriptor.indexPatternId)){const n=e.sourceDescriptor,i=`layer_${t}_source_index_pattern`;r.push({name:i,type:"index-pattern",id:n.indexPatternId}),delete n.indexPatternId,n.indexPatternRefName=i}if("joins"in e){const i=e;(i.joins?i.joins:[]).forEach(((e,i)=>{if("indexPatternId"in e.right&&!n.includes(e.right.indexPatternId)){const n=e.right,a=`layer_${t}_join_${i}_index_pattern`;r.push({name:a,type:"index-pattern",id:n.indexPatternId}),delete n.indexPatternId,n.indexPatternRefName=a}}))}})),{attributes:{...e,layerListJSON:JSON.stringify(i)},references:t.concat(r)}}function i(e,t){const n=t.find((({name:t})=>t===e));if(!n)throw new Error(`Could not find reference "${e}"`);return n}function a({attributes:e,references:t}){if(!e.layerListJSON)return{attributes:e};let n=[];try{n=JSON.parse(e.layerListJSON)}catch(e){throw new Error("Unable to parse attribute layerListJSON")}return n.forEach((e=>{if(e.sourceDescriptor&&"indexPatternRefName"in e.sourceDescriptor){const n=e.sourceDescriptor,r=i(n.indexPatternRefName,t);n.indexPatternId=r.id,delete n.indexPatternRefName}if("joins"in e){const n=e;(n.joins?n.joins:[]).forEach((e=>{if("indexPatternRefName"in e.right){const n=e.right,r=i(n.indexPatternRefName,t);n.indexPatternId=r.id,delete n.indexPatternRefName}}))}})),{attributes:{...e,layerListJSON:JSON.stringify(n)}}}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}))},function(e,t){e.exports=__kbnSharedDeps__.ElasticEui},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/kibanaReact/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t){e.exports=__kbnSharedDeps__.KbnAnalytics},function(e,t,n){"use strict";var r,i="object"==typeof Reflect?Reflect:null,a=i&&"function"==typeof i.apply?i.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};r=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function s(){s.init.call(this)}e.exports=s,e.exports.once=function(e,t){return new Promise((function(n,r){function i(n){e.removeListener(t,a),r(n)}function a(){"function"==typeof e.removeListener&&e.removeListener("error",i),n([].slice.call(arguments))}g(e,t,a,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&g(e,"error",t,{once:!0})}(e,i)}))},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var c=10;function u(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function l(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function d(e,t,n,r){var i,a,o,s;if(u(n),void 0===(a=e._events)?(a=e._events=Object.create(null),e._eventsCount=0):(void 0!==a.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),a=e._events),o=a[t]),void 0===o)o=a[t]=n,++e._eventsCount;else if("function"==typeof o?o=a[t]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),(i=l(e))>0&&o.length>i&&!o.warned){o.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=o.length,s=c,console&&console.warn&&console.warn(s)}return e}function p(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=p.bind(r);return i.listener=n,r.wrapFn=i,i}function _(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):m(i,i.length)}function b(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function m(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function g(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(a){r.once&&e.removeEventListener(t,i),n(a)}))}}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");c=e}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return l(this)},s.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var c=i[e];if(void 0===c)return!1;if("function"==typeof c)a(c,this,t);else{var u=c.length,l=m(c,u);for(n=0;n<u;++n)a(l[n],this,t)}return!0},s.prototype.addListener=function(e,t){return d(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return d(this,e,t,!0)},s.prototype.once=function(e,t){return u(t),this.on(e,f(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){return u(t),this.prependListener(e,f(this,e,t)),this},s.prototype.removeListener=function(e,t){var n,r,i,a,o;if(u(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,a=n.length-1;a>=0;a--)if(n[a]===t||n[a].listener===t){o=n[a].listener,i=a;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,o||t)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,a=Object.keys(n);for(r=0;r<a.length;++r)"removeListener"!==(i=a[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},s.prototype.listeners=function(e){return _(this,e,!0)},s.prototype.rawListeners=function(e){return _(this,e,!1)},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):b.call(e,t)},s.prototype.listenerCount=b,s.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return d}));var r=n(5),i=n(1),a=n(13),o=n(37),s=n(11),c=n(7),u=n(2);const l=i.i18n.translate("xpack.maps.regionMapMap.vis.title",{defaultMessage:"Region Map"}),d={name:s.b,title:l,icon:"visMapRegion",description:i.i18n.translate("xpack.maps.regionMap.vis.description",{defaultMessage:"Show metrics on a thematic map."}),editorConfig:{optionTabs:[{name:"",title:"",editor:function(e){return Object(u.jsx)(c.a,{getLazyComponent:()=>Object(r.lazy)((()=>n.e(10).then(n.bind(null,552)))),lazyComponentProps:e})}}]},visConfig:{defaults:{colorSchema:"Yellow to Red",mapZoom:2,mapCenter:[0,0]}},toExpressionAst:e=>{const t=Object(a.buildExpressionFunction)("regionmap",{visConfig:JSON.stringify({...e.params,mapCenter:e.uiState.get("mapCenter",[0,0]),mapZoom:parseInt(e.uiState.get("mapZoom",2),10),layerDescriptorParams:Object(o.a)(e)})});return Object(a.buildExpression)([t]).toAst()},requiresSearch:!0}},function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return d}));var r=n(5),i=n(1),a=n(13),o=n(38),s=n(10),c=n(7),u=n(2);const l=i.i18n.translate("xpack.maps.tileMap.vis.title",{defaultMessage:"Coordinate Map"}),d={name:s.c,title:l,icon:"visMapCoordinate",description:i.i18n.translate("xpack.maps.tileMap.vis.description",{defaultMessage:"Plot latitude and longitude coordinates on a map"}),editorConfig:{optionTabs:[{name:"",title:"",editor:function(e){return Object(u.jsx)(c.a,{getLazyComponent:()=>Object(r.lazy)((()=>n.e(11).then(n.bind(null,554)))),lazyComponentProps:e})}}]},visConfig:{defaults:{colorSchema:"Yellow to Red",mapType:s.a.ScaledCircleMarkers,mapZoom:2,mapCenter:[0,0]}},toExpressionAst:e=>{const t=Object(a.buildExpressionFunction)("tilemap",{visConfig:JSON.stringify({...e.params,mapCenter:e.uiState.get("mapCenter",[0,0]),mapZoom:parseInt(e.uiState.get("mapZoom",2),10),layerDescriptorParams:Object(o.a)(e)})});return Object(a.buildExpression)([t]).toAst()},requiresSearch:!0}},function(e,t,n){var r=n(42),i=n(43);e.exports=function(e,t,n){var a=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||r)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var s=0;s<16;++s)t[a+s]=o[s];return t||i(o)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"g",(function(){return f})),n.d(t,"f",(function(){return _})),n.d(t,"e",(function(){return m})),n.d(t,"d",(function(){return g}));var r=n(0);let i;!function(e){e.GEO_LINE_AGG="GEO_LINE_AGG",e.GEO_SHAPE_AGGS_GEO_TILE="GEO_SHAPE_AGGS_GEO_TILE",e.ON_PREM_EMS="ON_PREM_EMS"}(i||(i={}));const a={[i.GEO_LINE_AGG]:{name:"geo_line aggregation",license:"gold"},[i.GEO_SHAPE_AGGS_GEO_TILE]:{name:"geo_tile aggregation on geo_shape field-type",license:"gold"},[i.ON_PREM_EMS]:{name:"layer from local Elastic Maps Server",license:"enterprise"}};let o,s=!1;const c=()=>o,u=()=>s;let l,d;const p=new Promise((e=>{d=e})),f=async()=>{await p};async function _(e){b(await e.refresh()),l=e,l.license$.subscribe(b),d(void 0)}function b(e){const t=e.check(r.e,"gold");s="valid"===t.state,o=e.uid}function m(e){for(const t of Object.values(i))e.featureUsage.register(a[t].name,a[t].license)}function g(e){l?l.featureUsage.notifyUsage(a[i[e]].name):console.error("May not call notifyLicensedFeatureUsage before plugin start")}},function(e,t){e.exports=__kbnSharedDeps__.KbnEsQuery},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/kibanaUtils/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));const r=[];function i(e){r.push({checkVisibility:async()=>!0,getIsDisabled:async()=>!1,isBeta:!1,...e})}function a(e){if(e.order<100)throw new Error("layerWizard.order should be greater than or equal to '100'");i(e)}async function o(){const e=r.map((async e=>({...e,isVisible:await e.checkVisibility(),isDisabled:await e.getIsDisabled()})));return(await Promise.all(e)).filter((({isVisible:e})=>e)).sort(((e,t)=>e.order-t.order))}function s(e){return r.find((t=>t.id===e))}},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/embeddable/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t,n){"use strict";n.d(t,"a",(function(){return map_adapter_MapAdapter})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return vector_tile_adapter_VectorTileAdapter})),n.d(t,"d",(function(){return f}));var r=n(3),i=n.n(r),a=n(18);class map_adapter_MapAdapter extends a.EventEmitter{constructor(...e){super(...e),i()(this,"stats",void 0),i()(this,"style",void 0)}setMapState({stats:e,style:t}){this.stats=e,this.style=t,this._onChange()}getMapState(){return{stats:this.stats,style:this.style}}_onChange(){this.emit("change")}}var o=n(5),s=n(1),c=n(7),u=n(2);const l=()=>Object(o.lazy)((()=>n.e(15).then(n.bind(null,561)))),d={title:s.i18n.translate("xpack.maps.inspector.mapDetailsViewTitle",{defaultMessage:"Map details"}),order:30,help:s.i18n.translate("xpack.maps.inspector.mapDetailsViewHelpText",{defaultMessage:"View the map state"}),shouldShow:e=>Boolean(e.map),component:e=>Object(u.jsx)(c.a,{getLazyComponent:l,lazyComponentProps:e})};class vector_tile_adapter_VectorTileAdapter extends a.EventEmitter{constructor(...e){super(...e),i()(this,"_layers",{}),i()(this,"_tiles",[])}addLayer(e,t,n){this._layers[e]={label:t,tileUrl:n},this._onChange()}removeLayer(e){delete this._layers[e],this._onChange()}setTiles(e){this._tiles=e,this._onChange()}getLayerOptions(){return Object.keys(this._layers).map((e=>({value:e,label:this._layers[e].label})))}getTileRequests(e){if(!this._layers[e])return[];const{tileUrl:t}=this._layers[e];return this._tiles.map((n=>({layerId:e,tileUrl:t,...n})))}_onChange(){this.emit("change")}}const p=()=>Object(o.lazy)((()=>n.e(5).then(n.bind(null,559)))),f={title:s.i18n.translate("xpack.maps.inspector.vectorTileViewTitle",{defaultMessage:"Vector tiles"}),order:10,help:s.i18n.translate("xpack.maps.inspector.vectorTileViewHelpText",{defaultMessage:"View the vector tile search requests used to collect the data"}),shouldShow:e=>Boolean(e.vectorTiles),component:e=>Object(u.jsx)(c.a,{getLazyComponent:p,lazyComponentProps:e})}},function(e,t){e.exports=__kbnSharedDeps__.Lodash},function(e,t,n){e.exports=n(30)(3)},function(e,t){e.exports=__kbnSharedDeps_npm__},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/data/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));const r=[];function i(e){if(r.some((({type:t})=>e.type===t)))throw new Error(`Unable to register source type ${e.type}. ${e.type} has already been registered`);r.push(e)}function a(e){return r.find((t=>t.type===e))}},function(e,t){e.exports=__kbnSharedDeps__.RisonNode},function(e,t){e.exports=__kbnSharedDeps__.RxjsOperators},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c}));var r=n(28),i=n.n(r);const a="__kbn__feature_id__";let o=0;function s(){const e=o<Number.MAX_SAFE_INTEGER?o:0;return o=e+1,e}function c(e){const t=[];for(let n=0;n<e.features.length;n++){const e=s();t.push(e)}const n=i.a.shuffle(t),r=[];for(let t=0;t<e.features.length;t++){const i=n[t],o=e.features[t];r.push({type:"Feature",geometry:o.geometry,properties:{[a]:null==o.id?i:o.id,...o.properties},id:i})}return{type:"FeatureCollection",features:r}}},function(e,t,n){n.r(t);var r=__kbnBundles__.get("entry/core/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(19);function i(e,t){if("string"==typeof e)return e;const n=t.split(".");return 2===n.length?n[1]:void 0}function a(e){var t,n,a,o,s;const c={label:e.title?e.title:r.b,emsLayerId:e.params.selectedLayer.isEMS?i(e.params.selectedLayer.id,e.params.selectedLayer.layerId):void 0,leftFieldName:e.params.selectedLayer.isEMS?e.params.selectedJoinField.name:void 0,colorSchema:e.params.colorSchema,indexPatternId:null===(t=e.data.indexPattern)||void 0===t?void 0:t.id,metricAgg:"count"},u=null===(n=e.data)||void 0===n||null===(a=n.aggs)||void 0===a?void 0:a.byType("buckets");var l;null!=u&&u.length&&"terms"===u[0].type.dslName&&(c.termsFieldName=null===(l=u[0].getField())||void 0===l?void 0:l.name,c.termsSize=u[0].getParam("size"));const d=null===(o=e.data)||void 0===o||null===(s=o.aggs)||void 0===s?void 0:s.byType("metrics");var p;return null!=d&&d.length&&(c.metricAgg=d[0].type.dslName,c.metricFieldName=null===(p=d[0].getField())||void 0===p?void 0:p.name),c}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(31),i=n(20);function a(e){var t,n,a,o,s;const c={label:e.title?e.title:i.b,mapType:e.params.mapType,colorSchema:e.params.colorSchema,indexPatternId:null===(t=e.data.indexPattern)||void 0===t?void 0:t.id,metricAgg:"count"},u=null===(n=e.data)||void 0===n||null===(a=n.aggs)||void 0===a?void 0:a.byType("buckets");var l;if(null!=u&&u.length&&"geohash_grid"===u[0].type.dslName)c.geoFieldName=null===(l=u[0].getField())||void 0===l?void 0:l.name;else if(e.data.indexPattern){const t=e.data.indexPattern.fields.find((e=>!r.indexPatterns.isNestedField(e)&&e.aggregatable&&"geo_point"===e.type));t&&(c.geoFieldName=t.name)}const d=null===(o=e.data)||void 0===o||null===(s=o.aggs)||void 0===s?void 0:s.byType("metrics");var p;return null!=d&&d.length&&(c.metricAgg=d[0].type.dslName,c.metricFieldName=null===(p=d[0].getField())||void 0===p?void 0:p.name),c}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.c}));var r=n(25)},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/visualizations/common/utils");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t,n){"use strict";n.r(t);var r=n(0);n.d(t,"AGG_TYPE",(function(){return r.b})),n.d(t,"APP_ID",(function(){return r.e})),n.d(t,"COLOR_MAP_TYPE",(function(){return r.j})),n.d(t,"DECIMAL_DEGREES_PRECISION",(function(){return r.p})),n.d(t,"ES_GEO_FIELD_TYPE",(function(){return r.B})),n.d(t,"FIELD_ORIGIN",(function(){return r.F})),n.d(t,"INITIAL_LOCATION",(function(){return r.U})),n.d(t,"LABEL_BORDER_SIZES",(function(){return r.X})),n.d(t,"LAYER_TYPE",(function(){return r.ab})),n.d(t,"MAP_SAVED_OBJECT_TYPE",(function(){return r.fb})),n.d(t,"SCALING_TYPES",(function(){return r.tb})),n.d(t,"SOURCE_TYPES",(function(){return r.yb})),n.d(t,"STYLE_TYPE",(function(){return r.Ab})),n.d(t,"SYMBOLIZE_AS_TYPES",(function(){return r.Bb})),n.d(t,"LAYER_WIZARD_CATEGORY",(function(){return r.bb})),n.d(t,"MAX_ZOOM",(function(){return r.gb})),n.d(t,"MIN_ZOOM",(function(){return r.kb})),n.d(t,"VECTOR_SHAPE_TYPE",(function(){return r.Db})),n.d(t,"VECTOR_STYLES",(function(){return r.Eb}))},function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var i=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i}}},function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,i=n;return[i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]]].join("")}},function(e,t,n){n(45),__kbnBundles__.define("plugin/maps/public",n,46),__kbnBundles__.define("plugin/maps/common",n,41)},function(e,t,n){n.p=window.__kbnPublicPath__.maps},function(e,t,n){"use strict";n.r(t),n.d(t,"plugin",(function(){return le})),n.d(t,"MAP_SAVED_OBJECT_TYPE",(function(){return N.fb})),n.d(t,"MAPS_APP_LOCATOR",(function(){return R})),n.d(t,"GEOJSON_FEATURE_ID_PROPERTY_NAME",(function(){return ue.a}));var r=n(3),i=n.n(r),a=n(5),o=n.n(a),s=n(36),c=n(8),u=n(26),l=n(19),d=n(1),p=n(11);const f=()=>({name:"regionmap",type:"render",help:d.i18n.translate("xpack.maps.regionMap.function.help",{defaultMessage:"Regionmap visualization"}),args:{visConfig:{types:["string"],default:'"{}"',help:""}},async fn(e,t){const n=e.query;return{type:"render",as:p.a,value:{visType:p.b,visConfig:JSON.parse(t.visConfig),filters:e.filters,query:Array.isArray(n)?n[0]:n,timeRange:e.timeRange}}}});var _=n(9),b=n.n(_),m=n(7),g=n(2);const y=()=>Object(a.lazy)((()=>n.e(6).then(n.bind(null,553)))),h={name:p.a,reuseDomNode:!0,render:async(e,{filters:t,query:n,timeRange:r,visConfig:i},a)=>{a.onDestroy((()=>{Object(_.unmountComponentAtNode)(e)}));const o={onInitialRenderComplete:()=>{a.done()},filters:t,query:n,timeRange:r,visConfig:i};Object(_.render)(Object(g.jsx)(m.a,{getLazyComponent:y,lazyComponentProps:o}),e)}};var E=n(20),O=n(10);const v=()=>({name:"tilemap",type:"render",help:d.i18n.translate("xpack.maps.tileMap.function.help",{defaultMessage:"Tilemap visualization"}),args:{visConfig:{types:["string"],default:'"{}"',help:""}},async fn(e,t){const n=e.query;return{type:"render",as:O.b,value:{visType:O.c,visConfig:JSON.parse(t.visConfig),filters:e.filters,query:Array.isArray(n)?n[0]:n,timeRange:e.timeRange}}}}),S=()=>Object(a.lazy)((()=>n.e(7).then(n.bind(null,555)))),L={name:O.b,reuseDomNode:!0,render:async(e,{filters:t,query:n,timeRange:r,visConfig:i},a)=>{a.onDestroy((()=>{Object(_.unmountComponentAtNode)(e)}));const o={onInitialRenderComplete:()=>{a.done()},filters:t,query:n,timeRange:r,visConfig:i};Object(_.render)(Object(g.jsx)(m.a,{getLazyComponent:S,lazyComponentProps:o}),e)}};function T(e){var t,n;return"visualization"===e.type&&"function"==typeof e.getVis&&["region_map","tile_map"].includes(null===(t=e.getVis())||void 0===t||null===(n=t.type)||void 0===n?void 0:n.name)}var I=n(33),A=n.n(I),M=n(23),C=n(24),N=n(0),P=n(6);const R="MAPS_APP_LOCATOR";class locators_MapsAppLocatorDefinition{constructor(e){i()(this,"id",R),i()(this,"getLocation",(async e=>{const{mapId:t,filters:n,query:r,refreshInterval:i,timeRange:a,initialLayers:o,hash:s}=e,c=null!=s?s:this.deps.useHash,u={},l={};r&&(u.query=r),n&&n.length&&(u.filters=null==n?void 0:n.filter((e=>!Object(M.isFilterPinned)(e)))),a&&(l.time=a),n&&n.length&&(l.filters=null==n?void 0:n.filter((e=>Object(M.isFilterPinned)(e)))),i&&(l.refreshInterval=i);let d=`/map#/${t||""}`;if(d=Object(C.setStateToKbnUrl)("_g",l,{useHash:c},d),d=Object(C.setStateToKbnUrl)("_a",u,{useHash:c},d),o&&o.length){const e=A.a.encode_array(o);d=`${d}&${N.T}=${encodeURIComponent(e)}`}return{app:N.e,path:d,state:e.dataViewSpec?{dataViewSpec:e.dataViewSpec}:{}}})),this.deps=e}}class locators_MapsAppTileMapLocatorDefinition{constructor(e){i()(this,"id","MAPS_APP_TILE_MAP_LOCATOR"),i()(this,"getLocation",(async e=>{const{label:t,mapType:n,colorSchema:r,indexPatternId:i,geoFieldName:a,metricAgg:o,metricFieldName:s,filters:c,query:u,timeRange:l,hash:d=!0}=e,p=[],f=(await Object(P.a)()).createTileMapLayerDescriptor({label:t,mapType:n,colorSchema:r,indexPatternId:i,geoFieldName:a,metricAgg:o,metricFieldName:s});return f&&p.push(f),await this.deps.locator.getLocation({initialLayers:p,filters:c,query:u,timeRange:l,hash:d})})),this.deps=e}}class locators_MapsAppRegionMapLocatorDefinition{constructor(e){i()(this,"id","MAPS_APP_REGION_MAP_LOCATOR"),i()(this,"getLocation",(async e=>{const{label:t,emsLayerId:n,leftFieldName:r,termsFieldName:i,termsSize:a,colorSchema:o,indexPatternId:s,metricAgg:c,metricFieldName:u,filters:l,query:d,timeRange:p,hash:f=!0}=e,_=[],b=(await Object(P.a)()).createRegionMapLayerDescriptor({label:t,emsLayerId:n,leftFieldName:r,termsFieldName:i,termsSize:a,colorSchema:o,indexPatternId:s,metricAgg:c,metricFieldName:u});return b&&_.push(b),await this.deps.locator.getLocation({initialLayers:_,filters:l,query:d,timeRange:p,hash:f})})),this.deps=e}}var x=n(22),j=n(32),D=n(39);const w={createSecurityLayerDescriptors:async(e,t)=>(await Object(P.a)()).createSecurityLayerDescriptors(e,t),createBasemapLayerDescriptor:async()=>(await Object(P.a)()).createBasemapLayerDescriptor(),createESSearchSourceLayerDescriptor:async e=>(await Object(P.a)()).createESSearchSourceLayerDescriptor(e)};async function k(e){const t=await Object(P.a)();return await t.suggestEMSTermJoinConfig(e)}var F=n(12),V=n(34),U=n(14);const G=e=>{const t=e;if(!("attributes"in t)||void 0===t.attributes)return{state:e,references:[]};const{attributes:n,references:r}=Object(U.a)({attributes:t.attributes});return{state:{...e,attributes:n},references:r}},B=(e,t)=>{const n=e;if(!("attributes"in n)||void 0===n.attributes)return n;try{const{attributes:e}=Object(U.a)({attributes:n.attributes}),{attributes:r}=Object(U.b)({attributes:e,references:t});return{...n,attributes:r}}catch(e){return n}};var z=n(4);class map_embeddable_factory_MapEmbeddableFactory{constructor(){i()(this,"type",N.fb),i()(this,"savedObjectMetaData",{name:d.i18n.translate("xpack.maps.mapSavedObjectLabel",{defaultMessage:"Map"}),type:N.fb,getIconForSavedObject:()=>N.c}),i()(this,"createFromSavedObject",(async(e,t,n)=>(t.savedObjectId||(t.savedObjectId=e),this.create(t,n)))),i()(this,"create",(async(e,t)=>{const{MapEmbeddable:n}=await Object(P.a)(),r=Object(z.V)();return r&&Object(z.a)().currentAppId$.pipe(Object(V.first)()).subscribe((e=>{e&&r.reportUiCounter("map","loaded",`open_maps_vis_${e}`)})),new n({editable:await this.isEditable()},e,t)})),i()(this,"inject",B),i()(this,"extract",G)}async isEditable(){const{getMapsCapabilities:e}=await Object(P.a)();return e().save}canCreateNew(){return!1}getDisplayName(){return Object(F.g)()}}var Y=n(16);const H="FILTER_BY_MAP_EXTENT";function J(e){var t;return"dashboard"===(null===(t=e.parent)||void 0===t?void 0:t.type)?d.i18n.translate("xpack.maps.filterByMapExtentMenuItem.dashboardLabel",{defaultMessage:"dashboard"}):d.i18n.translate("xpack.maps.filterByMapExtentMenuItem.pageLabel",{defaultMessage:"page"})}function $(e){return d.i18n.translate("xpack.maps.filterByMapExtentMenuItem.displayName",{defaultMessage:"Filter {containerLabel} by map bounds",values:{containerLabel:J(e)}})}const W=Object(c.createAction)({id:H,type:H,order:20,getDisplayName:e=>$(e.embeddable),getDisplayNameTooltip:e=>d.i18n.translate("xpack.maps.filterByMapExtentMenuItem.displayNameTooltip",{defaultMessage:"As you zoom and pan the map, the {containerLabel} updates to display only the data visible in the map bounds.",values:{containerLabel:J(e.embeddable)}}),getIconType:()=>"filter",isCompatible:async({embeddable:e})=>(e.type===N.fb||T(e))&&!e.getInput().disableTriggers,execute:async e=>{const{FilterByMapExtentModal:t}=await n.e(8).then(n.bind(null,556)),{openModal:r}=Object(Y.createReactOverlays)(Object(z.d)()),i=r(Object(g.jsx)(t,{onClose:()=>i.close(),title:$(e.embeddable)}))}}),q="SYNCHRONIZE_MOVEMENT_ACTION",Z=Object(c.createAction)({id:q,type:q,order:21,getDisplayName:({embeddable:e})=>d.i18n.translate("xpack.maps.synchronizeMovementAction.title",{defaultMessage:"Synchronize map movement"}),getDisplayNameTooltip:()=>d.i18n.translate("xpack.maps.synchronizeMovementAction.tooltipContent",{defaultMessage:"Synchronize maps, so that if you zoom and pan in one map, the movement is reflected in other maps"}),getIconType:()=>"crosshairs",isCompatible:async({embeddable:e})=>{var t;const{mapEmbeddablesSingleton:r}=await n.e(14).then(n.bind(null,126));return!!r.hasMultipleMaps()&&("lens"===e.type&&"function"==typeof e.getSavedVis&&"lnsChoropleth"===(null===(t=e.getSavedVis())||void 0===t?void 0:t.visualizationType)||!!T(e)||e.type===N.fb)},execute:async({embeddable:e})=>{const{SynchronizeMovementModal:t}=await n.e(9).then(n.bind(null,557)),{openModal:r}=Object(Y.createReactOverlays)(Object(z.d)()),i=r(Object(g.jsx)(t,{onClose:()=>i.close()}))}});var K=n(21),X=n.n(K),Q=n(17);const ee=Object(c.createAction)({id:c.ACTION_VISUALIZE_GEO_FIELD,type:c.ACTION_VISUALIZE_GEO_FIELD,getDisplayName:()=>d.i18n.translate("xpack.maps.discover.visualizeFieldLabel",{defaultMessage:"Visualize in Maps"}),isCompatible:async()=>!!Object(z.W)().show,getHref:async e=>{const{app:t,path:n}=await te(e);return Object(z.d)().application.getUrlForApp(t,{path:n,absolute:!1})},execute:async e=>{const{app:t,path:n,state:r}=await te(e),i=Object(z.V)();null==i||i.reportUiCounter(N.e,Q.METRIC_TYPE.CLICK,`create_maps_vis_${e.originatingApp?e.originatingApp:"unknownOriginatingApp"}`),Object(z.d)().application.navigateToApp(t,{path:n,state:r})}}),te=async e=>{var t;const n=await Object(z.t)().get(e.dataViewSpec.id),r=(null==e||null===(t=e.contextualFields)||void 0===t?void 0:t.length)&&"_source"!==(null==e?void 0:e.contextualFields[0]),i=[{id:X()(),visible:!0,type:N.ab.MVT_VECTOR,sourceDescriptor:{id:X()(),type:N.yb.ES_SEARCH,tooltipProperties:r?e.contextualFields:[],label:n.getIndexPattern(),indexPatternId:e.dataViewSpec.id,geoField:e.fieldName,scalingType:N.tb.MVT}}],a=Object(z.L)().url.locators.get(R);return await a.getLocation({filters:Object(z.h)().query.filterManager.getFilters(),query:Object(z.h)().query.queryString.getQuery(),initialLayers:i,timeRange:Object(z.h)().query.timefilter.timefilter.getTime(),dataViewSpec:e.dataViewSpec})},ne={id:N.e,title:Object(F.a)(),subtitle:d.i18n.translate("xpack.maps.featureCatalogue.mapsSubtitle",{defaultMessage:"Plot geographic data."}),description:d.i18n.translate("xpack.maps.feature.appDescription",{defaultMessage:"Explore geospatial data from Elasticsearch and the Elastic Maps Service."}),icon:N.c,path:"/app/maps",showOnHomePage:!1,category:"data",solutionId:"kibana",order:400};var re=n(27),ie=n(40),ae=n(29),oe=n.n(ae);const se="lens_choropleth_chart_renderer",ce=()=>({name:"lens_choropleth_chart",type:"render",help:"A choropleth chart. Metrics are joined to vector features to compare values across political boundaries",args:{title:{types:["string"],help:""},description:{types:["string"],help:""},layerId:{types:["string"],help:""},emsField:{types:["string"],help:"Elastic Map Service boundaries layer field provides the vector feature join key"},emsLayerId:{types:["string"],help:"Elastic Map Service boundaries layer id that provides vector features"},regionAccessor:{types:["string"],help:"Bucket accessor identifies the region key column"},valueAccessor:{types:["string"],help:"Value accessor identifies the value column"}},inputTypes:["datatable"],fn(e,t,n){var r;if(null!=n&&null!==(r=n.inspectorAdapters)&&void 0!==r&&r.tables){n.inspectorAdapters.tables.reset(),n.inspectorAdapters.tables.allowCsvExport=!0;const r=Object(ie.prepareLogTable)(e,[[t.valueAccessor?[t.valueAccessor]:void 0,d.i18n.translate("xpack.maps.logDatatable.value",{defaultMessage:"Value"})],[t.regionAccessor?[t.regionAccessor]:void 0,d.i18n.translate("xpack.maps.logDatatable.region",{defaultMessage:"Region key"})]],!0);n.inspectorAdapters.tables.logDatatable("default",r)}return{type:"render",as:se,value:{data:e,args:t}}}});class plugin_MapsPlugin{constructor(e){i()(this,"_initializerContext",void 0),this._initializerContext=e}setup(e,t){var r,i;Object(x.e)(t.licensing);const a=this._initializerContext.config.get();Object(z.Z)({...a,preserveDrawingBuffer:!(null===(r=t.screenshotMode)||void 0===r||!r.isScreenshotMode())||a.preserveDrawingBuffer});const c=t.share.url.locators.create(new locators_MapsAppLocatorDefinition({useHash:e.uiSettings.get("state:storeInSessionStorage")}));return t.share.url.locators.create(new locators_MapsAppTileMapLocatorDefinition({locator:c})),t.share.url.locators.create(new locators_MapsAppRegionMapLocatorDefinition({locator:c})),t.inspector.registerView(re.d),t.inspector.registerView(re.b),t.home&&t.home.featureCatalogue.register(ne),t.visualizations.registerAlias(function(e){e.hideTypes(["region_map","tile_map"]);const t=d.i18n.translate("xpack.maps.visTypeAlias.description",{defaultMessage:"Create and style maps with multiple layers and indices."});return{aliasApp:N.e,aliasPath:`/${N.eb}`,name:N.e,title:N.f,description:t,icon:N.c,stage:"production",appExtensions:{visualizations:{docTypes:[N.fb],searchFields:["title^3"],toListItem(e){const{id:t,type:n,updatedAt:r,attributes:i}=e,{title:a,description:o}=i;return{id:t,title:a,description:o,updatedAt:r,editUrl:Object(N.Ib)(t),editApp:N.e,icon:N.c,stage:"production",savedObjectType:n,typeTitle:N.f}}}}}}(t.visualizations)),t.embeddable.registerEmbeddableFactory(N.fb,new map_embeddable_factory_MapEmbeddableFactory),e.application.register({id:N.e,title:Object(F.a)(),order:4e3,icon:`plugins/${N.e}/icon.svg`,euiIconType:N.d,category:s.DEFAULT_APP_CATEGORIES.kibana,async mount(n){var r,i;const[a,{savedObjectsTagging:s}]=await e.getStartServices(),c=null!==(r=null===(i=t.usageCollection)||void 0===i?void 0:i.components.ApplicationUsageTrackingProvider)&&void 0!==r?r:o.a.Fragment,{renderApp:u}=await Object(P.a)();return u(n,{coreStart:a,AppUsageTracker:c,savedObjectsTagging:s})}}),u=e,p=t.expressions,_=t.lens,p.registerRenderer((()=>function(e){return{name:se,displayName:"Choropleth chart",help:"Choropleth chart renderer",validate:()=>{},reuseDomNode:!0,render:async(t,r,i)=>{const[a,o]=await e.getStartServices(),{ChoroplethChart:s}=await Promise.all([n.e(0),n.e(12)]).then(n.bind(null,562)),{getEmsFileLayers:c}=await n.e(1).then(n.bind(null,74)),u=o.embeddable.getEmbeddableFactory("map");if(!u)return;let l=[];try{l=await c()}catch(e){}b.a.render(Object(g.jsx)(s,oe()({},r,{formatFactory:o.fieldFormats.deserialize,uiSettings:a.uiSettings,emsFileLayers:l,mapEmbeddableFactory:u})),t,(()=>{const e=i.getExecutionContext(),t=(e=>{if(e){var t;const n=e=>e.type?e:e.child?n(e.child):void 0;return null===(t=n(e))||void 0===t?void 0:t.type}})(e),n=(e=>{if(e){var t;const n=e=>e.child?n(e.child):e;return null===(t=n(e))||void 0===t?void 0:t.type}})(e);var r;t&&n&&(null===(r=o.usageCollection)||void 0===r||r.reportUiCounter(t,Q.METRIC_TYPE.COUNT,[`render_${n}_regionmap`])),i.done()})),i.onDestroy((()=>b.a.unmountComponentAtNode(t)))}}}(u))),p.registerFunction(ce),_.registerVisualization((async()=>{const[e,t]=await u.getStartServices(),{getEmsFileLayers:r}=await n.e(1).then(n.bind(null,74)),{getVisualization:i}=await n.e(4).then(n.bind(null,558));let a=[];try{a=await r()}catch(e){}return i({theme:e.theme,emsFileLayers:a,paletteService:await t.charts.palettes.getPalettes()})})),t.expressions.registerFunction(f),t.expressions.registerRenderer(h),t.visualizations.createBaseVisualization(l.a),t.expressions.registerFunction(v),t.expressions.registerRenderer(L),t.visualizations.createBaseVisualization(E.a),Object(z.Y)(!(null===(i=t.cloud)||void 0===i||!i.isCloudEnabled)),{registerLayerWizard:D.b,registerSource:j.b};var u,p,_}start(e,t){return Object(x.f)(t.licensing),Object(z.ab)(e,t),e.application.capabilities.maps.show&&t.uiActions.addTriggerAction(c.VISUALIZE_GEO_FIELD_TRIGGER,ee),t.uiActions.addTriggerAction(u.CONTEXT_MENU_TRIGGER,W),t.uiActions.addTriggerAction(u.CONTEXT_MENU_TRIGGER,Z),e.application.capabilities.maps.save||t.visualizations.unRegisterAlias(N.e),{createLayerDescriptors:w,suggestEMSTermJoinConfig:k}}}var ue=n(35);const le=e=>new plugin_MapsPlugin(e)},function(e,t){e.exports=__kbnSharedDeps__.KbnI18nReact},function(e,t){e.exports=__kbnSharedDeps__.Classnames},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/unifiedSearch/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t){e.exports=__kbnSharedDeps__.KbnUiTheme},function(e,t){e.exports=__kbnSharedDeps__.Rxjs},function(e,t){e.exports=__kbnSharedDeps__.KbnStd},function(e,t){e.exports=__kbnSharedDeps__.EmotionCache},function(e,t){e.exports=__kbnSharedDeps__.ElasticEuiLibServices},function(e,t){e.exports=__kbnSharedDeps__.Moment},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/data/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/savedObjects/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t){e.exports=__kbnSharedDeps__.ReactRouterDom},function(e,t){e.exports=__kbnSharedDeps__.TsLib},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/inspector/common/adapters/request");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t){e.exports=__kbnSharedDeps__.SaferLodashSet},function(e,t){e.exports=__kbnSharedDeps__.MomentTimezone},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/usageCollection/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/mapsEms/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/presentationUtil/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t){e.exports=__kbnSharedDeps__.KbnMonaco},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/lens/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))}]);