/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.stackAlerts_bundle_jsonpfunction=window.stackAlerts_bundle_jsonpfunction||[]).push([[2],{25:function(e,t,n){"use strict";var i,a=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),o=[];function s(e){for(var t=-1,n=0;n<o.length;n++)if(o[n].identifier===e){t=n;break}return t}function r(e,t){for(var n={},i=[],a=0;a<e.length;a++){var r=e[a],l=t.base?r[0]+t.base:r[0],d=n[l]||0,c="".concat(l," ").concat(d);n[l]=d+1;var u=s(c),p={css:r[1],media:r[2],sourceMap:r[3]};-1!==u?(o[u].references++,o[u].updater(p)):o.push({identifier:c,updater:g(p,t),references:1}),i.push(c)}return i}function l(e){var t=document.createElement("style"),i=e.attributes||{};if(void 0===i.nonce){var o=n.nc;o&&(i.nonce=o)}if(Object.keys(i).forEach((function(e){t.setAttribute(e,i[e])})),"function"==typeof e.insert)e.insert(t);else{var s=a(e.insert||"head");if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(t)}return t}var d,c=(d=[],function(e,t){return d[e]=t,d.filter(Boolean).join("\n")});function u(e,t,n,i){var a=n?"":i.media?"@media ".concat(i.media," {").concat(i.css,"}"):i.css;if(e.styleSheet)e.styleSheet.cssText=c(t,a);else{var o=document.createTextNode(a),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(o,s[t]):e.appendChild(o)}}function p(e,t,n){var i=n.css,a=n.media,o=n.sourceMap;if(a?e.setAttribute("media",a):e.removeAttribute("media"),o&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}var b=null,x=0;function g(e,t){var n,i,a;if(t.singleton){var o=x++;n=b||(b=l(t)),i=u.bind(null,n,o,!1),a=u.bind(null,n,o,!0)}else n=l(t),i=p.bind(null,n,t),a=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return i(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;i(e=t)}else a()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===i&&(i=Boolean(window&&document&&document.all&&!window.atob)),i));var n=r(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var i=0;i<n.length;i++){var a=s(n[i]);o[a].references--}for(var l=r(e,t),d=0;d<n.length;d++){var c=s(n[d]);0===o[c].references&&(o[c].updater(),o.splice(c,1))}n=l}}}},26:function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n,i,a,o=e[1]||"",s=e[3];if(!s)return o;if(t&&"function"==typeof btoa){var r=(n=s,i=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),a="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(i),"/*# ".concat(a," */")),l=s.sources.map((function(e){return"/*# sourceURL=".concat(s.sourceRoot||"").concat(e," */")}));return[o].concat(l).concat([r]).join("\n")}return[o].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,i){"string"==typeof e&&(e=[[null,e,""]]);var a={};if(i)for(var o=0;o<this.length;o++){var s=this[o][0];null!=s&&(a[s]=!0)}for(var r=0;r<e.length;r++){var l=[].concat(e[r]);i&&a[l[0]]||(n&&(l[2]?l[2]="".concat(n," and ").concat(l[2]):l[2]=n),t.push(l))}},t}},27:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));const i="stackAlerts"},28:function(e,t,n){e.exports=n(15)(3)},29:function(e,t,n){e.exports=n(15)(2)},31:function(e,t,n){e.exports=n(15)(6)},33:function(e,t,n){switch(window.__kbnThemeTag__){case"v8dark":return n(34);case"v8light":return n(36)}},34:function(e,t,n){var i=n(25),a=n(35);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);i(a,{insert:"head",singleton:!1}),e.exports=a.locals||{}},35:function(e,t,n){(t=n(26)(!1)).push([e.i,".kbnFieldButton{align-items:center;border-radius:6px;display:flex;font-size:14px;font-size:1rem;line-height:1.71429rem;margin-bottom:4px;transition:box-shadow .15s cubic-bezier(.694,.0482,.335,1),background-color .15s cubic-bezier(.694,.0482,.335,1)}.kbnFieldButton-isActive,.kbnFieldButton:focus-within{outline:2px solid currentColor}.kbnFieldButton-isActive:focus-visible,.kbnFieldButton:focus-within:focus-visible{outline-style:auto}.kbnFieldButton-isActive:not(:focus-visible),.kbnFieldButton:focus-within:not(:focus-visible){outline:none}.kbnFieldButton--isDraggable{background:#25262e}.kbnFieldButton--isDraggable:focus,.kbnFieldButton--isDraggable:focus-within,.kbnFieldButton--isDraggable:hover{border-radius:6px;box-shadow:0 .9px 4px -1px #0003,0 2.6px 8px -1px #00000026,0 5.7px 12px -1px rgba(0,0,0,.125),0 15px 15px -1px #0000001a;z-index:2}.kbnFieldButton--isDraggable .kbnFieldButton__button:focus,.kbnFieldButton--isDraggable .kbnFieldButton__button:hover{cursor:grab}.kbnFieldButton__button{align-items:flex-start;display:flex;flex-grow:1;line-height:normal;padding:8px;text-align:left}.kbnFieldButton__fieldIcon{flex-shrink:0;line-height:0;margin-right:8px}.kbnFieldButton__name{flex-grow:1;word-break:break-word}.kbnFieldButton__infoIcon{flex-shrink:0;margin-left:4px}.kbnFieldButton__fieldAction{margin-right:8px}.kbnFieldButton--small{font-size:12px}.kbnFieldButton--small .kbnFieldButton__button{padding:4px}.kbnFieldButton--small .kbnFieldButton__fieldAction,.kbnFieldButton--small .kbnFieldButton__fieldIcon{margin-right:4px}",""]),e.exports=t},36:function(e,t,n){var i=n(25),a=n(37);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);i(a,{insert:"head",singleton:!1}),e.exports=a.locals||{}},37:function(e,t,n){(t=n(26)(!1)).push([e.i,".kbnFieldButton{align-items:center;border-radius:6px;display:flex;font-size:14px;font-size:1rem;line-height:1.71429rem;margin-bottom:4px;transition:box-shadow .15s cubic-bezier(.694,.0482,.335,1),background-color .15s cubic-bezier(.694,.0482,.335,1)}.kbnFieldButton-isActive,.kbnFieldButton:focus-within{outline:2px solid currentColor}.kbnFieldButton-isActive:focus-visible,.kbnFieldButton:focus-within:focus-visible{outline-style:auto}.kbnFieldButton-isActive:not(:focus-visible),.kbnFieldButton:focus-within:not(:focus-visible){outline:none}.kbnFieldButton--isDraggable{background:#fff}.kbnFieldButton--isDraggable:focus,.kbnFieldButton--isDraggable:focus-within,.kbnFieldButton--isDraggable:hover{border-radius:6px;box-shadow:0 .9px 4px -1px #00000014,0 2.6px 8px -1px #0000000f,0 5.7px 12px -1px #0000000d,0 15px 15px -1px #0000000a;z-index:2}.kbnFieldButton--isDraggable .kbnFieldButton__button:focus,.kbnFieldButton--isDraggable .kbnFieldButton__button:hover{cursor:grab}.kbnFieldButton__button{align-items:flex-start;display:flex;flex-grow:1;line-height:normal;padding:8px;text-align:left}.kbnFieldButton__fieldIcon{flex-shrink:0;line-height:0;margin-right:8px}.kbnFieldButton__name{flex-grow:1;word-break:break-word}.kbnFieldButton__infoIcon{flex-shrink:0;margin-left:4px}.kbnFieldButton__fieldAction{margin-right:8px}.kbnFieldButton--small{font-size:12px}.kbnFieldButton--small .kbnFieldButton__button{padding:4px}.kbnFieldButton--small .kbnFieldButton__fieldAction,.kbnFieldButton--small .kbnFieldButton__fieldIcon{margin-right:4px}",""]),e.exports=t},50:function(e,t,n){"use strict";n.r(t),n.d(t,"GeoContainmentAlertTypeExpression",(function(){return D})),n.d(t,"default",(function(){return D}));var i=n(2),a=n.n(i),o=n(13),s=n(14),r=n(0),l=n(4),d=n(17),c=n(5),u=n(27);const p=["geo_point"],b=["geo_shape"];var x=n(29),g=n.n(x),f=n(12);class geo_index_pattern_select_GeoIndexPatternSelect extends i.Component{constructor(...e){super(...e),g()(this,"_isMounted",!1),g()(this,"state",{doesIndexPatternHaveGeoField:!1,noIndexPatternsExist:!1}),g()(this,"_loadIndexPattern",(async e=>{if(!e||0===e.length||!this.props.indexPatternService)return;let t;try{t=await this.props.indexPatternService.get(e)}catch(e){return}return this._isMounted&&t.id===e?(this.setState({doesIndexPatternHaveGeoField:t.fields.some((e=>this.props.includedGeoTypes.includes(e.type)))}),t):void 0})),g()(this,"_onIndexPatternSelect",(async e=>{const t=await this._loadIndexPattern(e);t&&this.props.onChange(t)})),g()(this,"_onNoIndexPatterns",(()=>{this.setState({noIndexPatternsExist:!0})}))}componentWillUnmount(){this._isMounted=!1}componentDidMount(){this._isMounted=!0,this.props.value&&this._loadIndexPattern(this.props.value)}_renderNoIndexPatternWarning(){return this.state.noIndexPatternsExist?Object(f.jsx)(a.a.Fragment,null,Object(f.jsx)(o.EuiCallOut,{title:r.i18n.translate("xpack.stackAlerts.geoContainment.noIndexPattern.messageTitle",{defaultMessage:"Couldn't find any data views"}),color:"warning"},Object(f.jsx)("p",null,Object(f.jsx)(s.FormattedMessage,{id:"xpack.stackAlerts.geoContainment.noIndexPattern.doThisPrefixDescription",defaultMessage:"You'll need to "}),Object(f.jsx)(o.EuiLink,{href:this.props.http.basePath.prepend("/app/management/kibana/dataViews")},Object(f.jsx)(s.FormattedMessage,{id:"xpack.stackAlerts.geoContainment.noIndexPattern.doThisLinkTextDescription",defaultMessage:"Create a data view."}))),Object(f.jsx)("p",null,Object(f.jsx)(s.FormattedMessage,{id:"xpack.stackAlerts.geoContainment.noIndexPattern.hintDescription",defaultMessage:"Don't have any data? "}),Object(f.jsx)(o.EuiLink,{href:this.props.http.basePath.prepend("/app/home#/tutorial_directory/sampleData")},Object(f.jsx)(s.FormattedMessage,{id:"xpack.stackAlerts.geoContainment.noIndexPattern.getStartedLinkText",defaultMessage:"Get started with some sample data sets."})))),Object(f.jsx)(o.EuiSpacer,{size:"s"})):null}render(){const e=this.props.IndexPatternSelectComponent,t=!!this.props.value&&!this.state.doesIndexPatternHaveGeoField,n=t?r.i18n.translate("xpack.stackAlerts.geoContainment.noGeoFieldInIndexPattern.message",{defaultMessage:"Data view does not contain any allowed geospatial fields. Must have one of type {geoFields}.",values:{geoFields:this.props.includedGeoTypes.join(", ")}}):"";return Object(f.jsx)(a.a.Fragment,null,this._renderNoIndexPatternWarning(),Object(f.jsx)(o.EuiFormRow,{label:r.i18n.translate("xpack.stackAlerts.geoContainment.indexPatternSelectLabel",{defaultMessage:"Data view"}),isInvalid:t,error:n},e?Object(f.jsx)(e,{isInvalid:t,isDisabled:this.state.noIndexPatternsExist,indexPatternId:this.props.value,onChange:this._onIndexPatternSelect,placeholder:r.i18n.translate("xpack.stackAlerts.geoContainment.indexPatternSelectPlaceholder",{defaultMessage:"Select data view"}),fieldTypes:this.props.includedGeoTypes,onNoIndexPatterns:this._onNoIndexPatterns,isClearable:!1}):Object(f.jsx)("div",null)))}}var m=n(3),h=n.n(m),j=n(28),y=n.n(j),k=n(31),F=n.n(k),v=n(18),O=n.n(v),I=["type","label","size","scripted","className"],_={iconType:"questionInCircle",color:"gray"},S={boolean:{iconType:"tokenBoolean"},conflict:{iconType:"alert",color:"euiColorVis9",shape:"square"},date:{iconType:"tokenDate"},date_range:{iconType:"tokenDate"},geo_point:{iconType:"tokenGeo"},geo_shape:{iconType:"tokenGeo"},ip:{iconType:"tokenIP"},ip_range:{iconType:"tokenIP"},match_only_text:{iconType:"tokenString"},murmur3:{iconType:"tokenSearchType"},number:{iconType:"tokenNumber"},number_range:{iconType:"tokenNumber"},histogram:{iconType:"tokenHistogram"},_source:{iconType:"editorCodeBlock",color:"gray"},string:{iconType:"tokenString"},text:{iconType:"tokenString"},keyword:{iconType:"tokenKeyword"},gauge:{iconType:"tokenMetricGauge"},counter:{iconType:"tokenMetricCounter"},nested:{iconType:"tokenNested"},version:{iconType:"tokenTag"}};function P(e){var t=e.type,n=e.label,i=e.size,a=void 0===i?"s":i,s=e.scripted,r=e.className,l=F()(e,I),d=S[t]||_;return Object(f.jsx)(o.EuiToken,y()({},d,{className:O()("kbnFieldIcon",r),"aria-label":n||t,title:n||t,size:a,fill:s?"dark":void 0},l))}n(33);function C(e){return e?e.map((e=>({value:e,label:e.name}))).sort(((e,t)=>e.label.toLowerCase().localeCompare(t.label.toLowerCase()))):[]}function w({placeholder:e,value:t,onChange:n,fields:i}){const a=[];if(t&&i){const e=i.find((e=>e.name===t));e&&a.push({value:e,label:t})}return Object(f.jsx)(o.EuiComboBox,{singleSelection:!0,options:C(i),selectedOptions:a,onChange:e=>{n(h.a.get(e,"0.value.name"))},isDisabled:!i,renderOption:function(e,t,n){return Object(f.jsx)(o.EuiFlexGroup,{className:n,gutterSize:"s",alignItems:"center"},Object(f.jsx)(o.EuiFlexItem,{grow:null},Object(f.jsx)(P,{type:e.value.type,fill:"none"})),Object(f.jsx)(o.EuiFlexItem,null,Object(f.jsx)(o.EuiHighlight,{search:t},e.label)))},isClearable:!1,placeholder:e,compressed:!0})}Object.keys({s:"kbnFieldButton--small",m:null});const B=({popoverContent:e,expressionDescription:t,defaultValue:n,value:a,isInvalid:s})=>{const[l,d]=Object(i.useState)(!1);return Object(f.jsx)(o.EuiPopover,{id:"popoverForExpression",button:Object(f.jsx)(o.EuiExpression,{display:"columns","data-test-subj":"selectIndexExpression",description:t,value:a||n,isActive:l,onClick:()=>d(!0),isInvalid:s}),isOpen:l,closePopover:()=>d(!1),ownFocus:!0,anchorPosition:"downLeft",zIndex:8e3,display:"block"},Object(f.jsx)("div",{style:{width:"450px"}},Object(f.jsx)(o.EuiPopoverTitle,null,Object(f.jsx)(o.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},Object(f.jsx)(o.EuiFlexItem,null,t),Object(f.jsx)(o.EuiFlexItem,{grow:!1},Object(f.jsx)(o.EuiButtonIcon,{"data-test-subj":"closePopover",iconType:"cross",color:"danger","aria-label":r.i18n.translate("xpack.stackAlerts.geoContainment.ui.expressionPopover.closePopoverLabel",{defaultMessage:"Close"}),onClick:()=>d(!1)})))),e))},E=({ruleParams:e,errors:t,boundaryIndexPattern:n,boundaryNameField:a,setBoundaryIndexPattern:s,setBoundaryGeoField:l,setBoundaryNameField:d,data:u,unifiedSearch:p})=>{const x=["string","number","ip"],{http:g}=Object(c.useKibana)().services,m=p.ui&&p.ui.IndexPatternSelect||null,{boundaryGeoField:h}=e,j={name:"<nothing selected>",type:"string"},y=(e=>{const t=Object(i.useRef)();return Object(i.useEffect)((()=>{t.current=e})),t.current})(n),k=Object(i.useRef)({geoFields:[],boundaryNameFields:[]});Object(i.useEffect)((()=>{var e;y!==n&&(k.current.geoFields=n.fields&&n.fields.length&&n.fields.filter((e=>b.includes(e.type)))||[],k.current.geoFields.length&&l(k.current.geoFields[0].name),k.current.boundaryNameFields=[...(null!==(e=n.fields)&&void 0!==e?e:[]).filter((e=>x.includes(e.type)&&!e.name.startsWith("_")&&!e.name.endsWith("keyword"))),j],k.current.boundaryNameFields.length&&d(k.current.boundaryNameFields[0].name))}),[x,n,j,y,l,d]);const F=Object(f.jsx)(i.Fragment,null,Object(f.jsx)(o.EuiFormRow,{id:"geoIndexPatternSelect",fullWidth:!0,error:t.index},Object(f.jsx)(geo_index_pattern_select_GeoIndexPatternSelect,{onChange:e=>{e&&s(e)},value:n.id,IndexPatternSelectComponent:m,indexPatternService:u.indexPatterns,http:g,includedGeoTypes:b})),Object(f.jsx)(o.EuiFormRow,{id:"geoField",fullWidth:!0,label:r.i18n.translate("xpack.stackAlerts.geoContainment.geofieldLabel",{defaultMessage:"Geospatial field"})},Object(f.jsx)(w,{placeholder:r.i18n.translate("xpack.stackAlerts.geoContainment.selectLabel",{defaultMessage:"Select geo field"}),value:h,onChange:l,fields:k.current.geoFields})),Object(f.jsx)(o.EuiFormRow,{id:"boundaryNameFieldSelect",fullWidth:!0,label:r.i18n.translate("xpack.stackAlerts.geoContainment.boundaryNameSelectLabel",{defaultMessage:"Human-readable boundary name (optional)"})},Object(f.jsx)(w,{placeholder:r.i18n.translate("xpack.stackAlerts.geoContainment.boundaryNameSelect",{defaultMessage:"Select boundary name"}),value:a||null,onChange:e=>{d(e===j.name?void 0:e)},fields:k.current.boundaryNameFields})));return Object(f.jsx)(B,{defaultValue:"Select a data view and geo shape field",value:n.title,popoverContent:F,expressionDescription:r.i18n.translate("xpack.stackAlerts.geoContainment.indexLabel",{defaultMessage:"index"})})},T=["string","number","ip"],A=({errors:e,entity:t,setAlertParamsEntity:n,indexFields:a,isInvalid:s})=>{const l=(e=>{const t=Object(i.useRef)();return Object(i.useEffect)((()=>{t.current=e})),t.current})(a),d=Object(i.useRef)({indexFields:[]});Object(i.useEffect)((()=>{h.a.isEqual(l,a)||(d.current.indexFields=function(e){return e.filter((e=>{const t=T.includes(e.type),n=e.name.startsWith("_"),i=!!e.aggregatable;return t&&i&&!n}))}(a),!t&&d.current.indexFields.length&&n(d.current.indexFields[0].name))}),[a,l,n,t]);const c=Object(f.jsx)(o.EuiFormRow,{id:"entitySelect",fullWidth:!0,error:e.index},Object(f.jsx)(w,{placeholder:r.i18n.translate("xpack.stackAlerts.geoContainment.topHitsSplitFieldSelectPlaceholder",{defaultMessage:"Select entity field"}),value:t,onChange:e=>e&&n(e),fields:d.current.indexFields}));return Object(f.jsx)(B,{isInvalid:s,value:t,defaultValue:"Select entity field",popoverContent:c,expressionDescription:r.i18n.translate("xpack.stackAlerts.geoContainment.entityByLabel",{defaultMessage:"by"})})},M=({setAlertParamsDate:e,setAlertParamsGeoField:t,errors:n,setIndexPattern:a,indexPattern:l,isInvalid:d,dateField:u,geoField:b,data:x,unifiedSearch:g})=>{const{http:m}=Object(c.useKibana)().services,h=g.ui&&g.ui.IndexPatternSelect||null,j=(e=>{const t=Object(i.useRef)();return Object(i.useEffect)((()=>{t.current=e})),t.current})(l),y=Object(i.useRef)({dateFields:[],geoFields:[]});Object(i.useEffect)((()=>{j!==l&&(y.current.geoFields=l.fields&&l.fields.length&&l.fields.filter((e=>p.includes(e.type)))||[],y.current.geoFields.length&&t(y.current.geoFields[0].name),y.current.dateFields=l.fields&&l.fields.length&&l.fields.filter((e=>"date"===e.type))||[],y.current.dateFields.length&&e(y.current.dateFields[0].name))}),[l,j,e,t]);const k=Object(f.jsx)(i.Fragment,null,Object(f.jsx)(o.EuiFormRow,{id:"geoIndexPatternSelect",fullWidth:!0,error:n.index},Object(f.jsx)(geo_index_pattern_select_GeoIndexPatternSelect,{onChange:e=>{e&&a(e)},value:l.id,IndexPatternSelectComponent:h,indexPatternService:x.indexPatterns,http:m,includedGeoTypes:p})),Object(f.jsx)(o.EuiFormRow,{id:"containmentTimeField",fullWidth:!0,label:Object(f.jsx)(s.FormattedMessage,{id:"xpack.stackAlerts.geoContainment.timeFieldLabel",defaultMessage:"Time field"})},Object(f.jsx)(w,{placeholder:r.i18n.translate("xpack.stackAlerts.geoContainment.selectTimeLabel",{defaultMessage:"Select time field"}),value:u,onChange:t=>t&&e(t),fields:y.current.dateFields})),Object(f.jsx)(o.EuiFormRow,{id:"geoField",fullWidth:!0,label:r.i18n.translate("xpack.stackAlerts.geoContainment.geofieldLabel",{defaultMessage:"Geospatial field"})},Object(f.jsx)(w,{placeholder:r.i18n.translate("xpack.stackAlerts.geoContainment.selectGeoLabel",{defaultMessage:"Select geo field"}),value:b,onChange:e=>e&&t(e),fields:y.current.geoFields})));return Object(f.jsx)(B,{isInvalid:d,value:l.title,defaultValue:r.i18n.translate("xpack.stackAlerts.geoContainment.entityIndexSelect",{defaultMessage:"Select a data view and geo point field"}),popoverContent:k,expressionDescription:r.i18n.translate("xpack.stackAlerts.geoContainment.entityIndexLabel",{defaultMessage:"index"})})};function N(e){try{"kuery"===e.language?Object(l.fromKueryExpression)(e.query):Object(l.luceneStringToDsl)(e.query)}catch(e){return!1}return!0}const D=({ruleParams:e,ruleInterval:t,setRuleParams:n,setRuleProperty:a,errors:l,data:p,unifiedSearch:b})=>{const{index:x,indexId:g,indexQuery:m,geoField:h,entity:j,dateField:y,boundaryType:k,boundaryIndexTitle:F,boundaryIndexId:v,boundaryIndexQuery:O,boundaryGeoField:I,boundaryNameField:_}=e,{http:S,docLinks:P,uiSettings:C,notifications:w,storage:B,usageCollection:T,dataViews:D}=Object(c.useKibana)().services,[G,z]=Object(i.useState)({id:"",title:""}),L=e=>{e&&(z(e),e.title&&n("index",e.title),e.id&&n("indexId",e.id))},[R,W]=Object(i.useState)(m||{query:"",language:"kuery"}),[q,V]=Object(i.useState)({id:"",title:""}),H=e=>{e&&(V(e),e.title&&n("boundaryIndexTitle",e.title),e.id&&n("boundaryIndexId",e.id))},[Q,U]=Object(i.useState)(O||{query:"",language:"kuery"});return r.i18n.translate("xpack.stackAlerts.geoContainment.fixErrorInExpressionBelowValidationMessage",{defaultMessage:"Expression contains errors."}),Object(i.useEffect)((()=>{(async()=>{if(a("params",{...e,index:null!=x?x:"",indexId:null!=g?g:"",entity:null!=j?j:"",dateField:null!=y?y:"",boundaryType:null!=k?k:"entireIndex",geoField:null!=h?h:"",boundaryIndexTitle:null!=F?F:"",boundaryIndexId:null!=v?v:"",boundaryGeoField:null!=I?I:"",boundaryNameField:null!=_?_:""}),p.indexPatterns){if(g){const e=await p.indexPatterns.get(g);L(e)}if(v){const e=await p.indexPatterns.get(v);H(e)}}})()}),[]),Object(f.jsx)(i.Fragment,null,null,Object(f.jsx)(o.EuiSpacer,{size:"l"}),Object(f.jsx)(o.EuiTitle,{size:"xs"},Object(f.jsx)("h5",null,Object(f.jsx)(s.FormattedMessage,{id:"xpack.stackAlerts.geoContainment.selectEntity",defaultMessage:"Select entity"}))),Object(f.jsx)(o.EuiSpacer,{size:"s"}),Object(f.jsx)(M,{dateField:y,geoField:h,errors:l,setAlertParamsDate:e=>n("dateField",e),setAlertParamsGeoField:e=>n("geoField",e),setRuleProperty:a,setIndexPattern:L,indexPattern:G,isInvalid:!g||!y||!h,data:p,unifiedSearch:b}),Object(f.jsx)(A,{errors:l,entity:j,setAlertParamsEntity:e=>n("entity",e),indexFields:G.fields,isInvalid:!!(g&&y&&h)&&!j}),Object(f.jsx)(o.EuiSpacer,{size:"s"}),Object(f.jsx)(o.EuiFlexItem,null,Object(f.jsx)(d.QueryStringInput,{disableAutoFocus:!0,bubbleSubmitEvent:!0,indexPatterns:G?[G]:[],query:R,onChange:e=>{e.language&&(N(e)&&n("indexQuery",e),W(e))},appName:u.a,deps:{unifiedSearch:b,notifications:w,http:S,docLinks:P,uiSettings:C,data:p,dataViews:D,storage:B,usageCollection:T}})),Object(f.jsx)(o.EuiSpacer,{size:"l"}),Object(f.jsx)(o.EuiTitle,{size:"xs"},Object(f.jsx)("h5",null,Object(f.jsx)(s.FormattedMessage,{id:"xpack.stackAlerts.geoContainment.selectBoundaryIndex",defaultMessage:"Select boundary"}))),Object(f.jsx)(o.EuiSpacer,{size:"s"}),Object(f.jsx)(E,{ruleParams:e,errors:l,boundaryIndexPattern:q,setBoundaryIndexPattern:H,setBoundaryGeoField:e=>e&&n("boundaryGeoField",e),setBoundaryNameField:e=>n("boundaryNameField",e||""),boundaryNameField:_,data:p,unifiedSearch:b}),Object(f.jsx)(o.EuiSpacer,{size:"s"}),Object(f.jsx)(o.EuiFlexItem,null,Object(f.jsx)(d.QueryStringInput,{disableAutoFocus:!0,bubbleSubmitEvent:!0,indexPatterns:q?[q]:[],query:Q,onChange:e=>{e.language&&(N(e)&&n("boundaryIndexQuery",e),U(e))},appName:u.a,deps:{unifiedSearch:b,notifications:w,http:S,docLinks:P,uiSettings:C,data:p,dataViews:D,storage:B,usageCollection:T}})),Object(f.jsx)(o.EuiSpacer,{size:"l"}))}}}]);