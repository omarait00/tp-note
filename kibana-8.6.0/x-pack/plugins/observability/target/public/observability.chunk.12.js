/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.observability_bundle_jsonpfunction=window.observability_bundle_jsonpfunction||[]).push([[12],{209:function(e,t,a){"use strict";a.r(t),a.d(t,"renderApp",(function(){return Je}));var l=a(1),s=a(0),r=a.n(s),n=a(76),i=a.n(n),u=a(18),o=a(8),c=a(45),d=a(6),m=a(23),b=a(112),p=a(103),E=a(100),g=a(99),y=a(113),v=a(84),f=a(10);const x=f.observabilityFeatureId,h=f.casesPath;var T=a(90),S=a(15),j=a(13);var k=a(154),O=a(42);const R=({paramsForApiCall:e,initialDataState:t,executeApiCall:a,shouldExecuteApiCall:l})=>{const{http:r}=Object(O.a)().services,[n,i]=Object(s.useState)(!1),[u,o]=Object(s.useState)(t),{fetch:c,cancel:d}=Object(s.useMemo)((()=>{const t=new AbortController;let s=!1;return{fetch:async()=>{if(l(e)){i(!0);const l=await a(e,t,r);s||(i(!1),o(l))}},cancel:()=>{s=!0,t.abort()}}}),[a,r,e,l]);return Object(s.useEffect)((()=>(c(),()=>{d()})),[c,d]),{loading:n,data:u}},M=e=>{const{observabilityRuleTypeRegistry:t}=Object(T.a)(),a=Object(s.useMemo)((()=>({id:e,ruleType:t})),[e,t]),l=Object(s.useCallback)((e=>!Object(j.isEmpty)(e.id)),[]),{loading:r,data:n}=R({paramsForApiCall:a,initialDataState:null,executeApiCall:C,shouldExecuteApiCall:l});return[r,n]},C=async(e,t,a)=>{const{id:l,ruleType:s}=e;try{const e=await a.get("/internal/rac/alerts",{query:{id:l},signal:t.signal});if(void 0!==e)return Object(k.a)(s)(e)}catch(e){}return null},D=e=>{const t=Object(s.useMemo)((()=>I(e)),[e]),a=Object(s.useCallback)((e=>e.length>0),[]),{loading:l,data:r}=R({paramsForApiCall:t,initialDataState:void 0,executeApiCall:F,shouldExecuteApiCall:a});return[l,null!=r?r:{}]},F=async(e,t,a)=>{try{const l=await a.post("/internal/rac/alerts/find",{body:JSON.stringify({query:{ids:{values:e}},track_total_hits:!1,size:1e4}),signal:t.signal});if(l)return P(l)}catch(e){}},P=e=>e.hits.hits.reduce(((e,{_id:t,_index:a,_source:l})=>({...e,[t]:{_id:t,_index:a,...l}})),{}),I=e=>e.filter((e=>!Object(j.isEmpty)(e)));var A=a(98);const L=r.a.memo((({permissions:e})=>{const{cases:t,http:{basePath:{prepend:a}},application:{navigateToUrl:l}}=Object(d.useKibana)().services,{observabilityRuleTypeRegistry:n}=Object(T.a)(),[i,u]=Object(s.useState)(""),o=Object(s.useCallback)((()=>{u("")}),[]),[c,m]=M(i);return r.a.createElement(r.a.Fragment,null,!1===c&&m&&""!==i&&r.a.createElement(s.Suspense,{fallback:null},r.a.createElement(S.LazyAlertsFlyout,{alert:m,observabilityRuleTypeRegistry:n,onClose:o})),t.ui.getCases({basePath:h,permissions:e,owner:[x],features:{alerts:{sync:!1,isExperimental:!1}},useFetchAlertData:D,showAlertDetails:e=>{u(e)},ruleDetailsNavigation:{href:e=>a(A.c.observability.ruleDetails(e)),onClick:async(e,t)=>{const s=a(A.c.observability.ruleDetails(e));return null!=t&&t.preventDefault(),l(s)}}}))}));L.displayName="Cases";var w=a(14),z=a.n(w),B=a(5),N=a(17);const _=a.n(N)()(B.EuiEmptyPrompt).withConfig({displayName:"EmptyPrompt",componentId:"sc-lbahp1-0"})(["align-self:center;max-width:60em;"]);_.displayName="EmptyPrompt";const U=r.a.memo((({actions:e,message:t,title:a,...l})=>{const n=Object.keys(e),i=Object(s.useMemo)((()=>Object.values(e).filter((e=>e.label&&e.url)).map((({icon:e,label:t,target:a,url:l,descriptionTitle:s,description:i,onClick:u,fill:o=!0},c)=>null!=s||null!=i?r.a.createElement(B.EuiFlexItem,{grow:!1,style:{maxWidth:283},key:`emptyPageAction-${n[c]}`},r.a.createElement(B.EuiCard,{title:null!=s&&s,description:null!=i&&i,footer:r.a.createElement(B.EuiButton,{href:l,onClick:u,iconType:e,target:a,fill:o,"data-test-subj":`emptyPageAction-${n[c]}`},t)})):r.a.createElement(B.EuiFlexItem,{grow:!1,style:{maxWidth:283},key:`emptyPageAction-${n[c]}`},r.a.createElement(B.EuiButton,{href:l,onClick:u,iconType:e,target:a,"data-test-subj":`emptyPageAction-${n[c]}`},t))))),[e,n]);return r.a.createElement(_,z()({iconType:"casesApp",title:r.a.createElement("h2",null,a),body:t&&r.a.createElement("p",null,t),actions:r.a.createElement(B.EuiFlexGroup,{justifyContent:"center"},i)},l))}));U.displayName="EmptyPageComponent";const H=r.a.memo(U);H.displayName="EmptyPage";const q=l.i18n.translate("xpack.observability.cases.caseFeatureNoPermissionsTitle",{defaultMessage:"Kibana feature privileges required"}),G=l.i18n.translate("xpack.observability.cases.caseFeatureNoPermissionsMessage",{defaultMessage:"To view cases, you must have privileges for the Cases feature in the Kibana space. For more information, contact your Kibana administrator."}),K=l.i18n.translate("xpack.observability.cases.caseView.goToDocumentationButton",{defaultMessage:"View documentation"}),W=r.a.memo((()=>{const e=Object(O.a)().services.docLinks,t=Object(s.useMemo)((()=>({savedObject:{icon:"documents",label:K,url:`${e.ELASTIC_WEBSITE_URL}guide/en/security/${e.DOC_LINK_VERSION}s`,target:"_blank"}})),[e]);return r.a.createElement(H,{actions:t,message:G,"data-test-subj":"noFeaturePermissions",title:q})}));W.displayName="CaseSavedObjectNoPermissions";var V=a(101),$=a(94),J=a(124),Y=a(137);const Q=r.a.memo((()=>{const e=Object(V.a)(),{docLinks:t,http:a}=Object(d.useKibana)().services,{ObservabilityPageTemplate:l}=Object(T.a)(),{hasAnyData:s,isAllRequestsComplete:n}=Object($.a)();if(!s&&!n)return r.a.createElement(J.a,null);const i=!0===s||!1===n&&void 0,u=Object(Y.a)({hasData:i,basePath:a.basePath,docsLink:t.links.observability.guide});return e.read?r.a.createElement(l,{isPageDataLoaded:n,"data-test-subj":u?"noDataPage":void 0,noDataConfig:u},r.a.createElement(L,{permissions:e})):r.a.createElement(W,null)}));Q.displayName="CasesPage";var X=a(125);const Z=new E.Type("JSON",E.any.is,((e,t)=>g.either.chain(E.string.validate(e,t),(a=>{try{return E.success(JSON.parse(a))}catch(a){return E.failure(e,t)}}))),(e=>JSON.stringify(e)));var ee=a(151),te=a(72),ae=a(77),le=a(81);const se={lastResponse:[],status:[]},re=Object(m.createStateContainer)(se,{setLastResponse:e=>t=>{const a=t;return t.forEach((t=>{e.lastResponse.includes(t)?a.filter((e=>e!==t)):a.concat(t)})),{...e,lastResponse:a}},setStatus:e=>t=>{const a=t;return t.forEach((t=>{e.status.includes(t)?a.filter((e=>e!==t)):a.concat(t)})),{...e,status:a}}}),{Provider:ne,useContainer:ie}=Object(m.createStateContainerReactHelpers)();var ue=a(46);l.i18n.translate("xpack.observability.rules.rulesTable.ruleStatusLicenseError",{defaultMessage:"License Error"}),l.i18n.translate("xpack.observability.rules.rulesTable.ruleStatusOk",{defaultMessage:"Ok"}),l.i18n.translate("xpack.observability.rules.rulesTable.ruleStatusActive",{defaultMessage:"Active"}),l.i18n.translate("xpack.observability.rules.rulesTable.ruleStatusError",{defaultMessage:"Error"}),l.i18n.translate("xpack.observability.rules.rulesTable.ruleStatusPending",{defaultMessage:"Pending"}),l.i18n.translate("xpack.observability.rules.rulesTable.ruleStatusUnknown",{defaultMessage:"Unknown"}),l.i18n.translate("xpack.observability.rules.rulesTable.ruleStatusWarning",{defaultMessage:"warning"}),l.i18n.translate("xpack.observability.rules.rulesTable.columns.lastResponseTitle",{defaultMessage:"Last response"});const oe=l.i18n.translate("xpack.observability.rulesTitle",{defaultMessage:"Rules"}),ce=l.i18n.translate("xpack.observability.breadcrumbs.rulesLinkText",{defaultMessage:"Rules"}),de=(l.i18n.translate("xpack.observability.rules.loadError",{defaultMessage:"Unable to load rules"}),l.i18n.translate("xpack.observability.rulesList.unableToLoadRuleTags",{defaultMessage:"Unable to load rule tags"}),l.i18n.translate("xpack.observability.rules.rulesTable.changeStatusAriaLabel",{defaultMessage:"Change status"}),["ruleName","ruleExecutionStatusLastDate","ruleSnoozeNotify","ruleExecutionStatus","ruleExecutionState"]);function me(){const{ObservabilityPageTemplate:e,observabilityRuleTypeRegistry:t}=Object(T.a)(),{http:a,docLinks:n,triggersActionsUi:i}=Object(O.a)().services,o=n.links.observability.createAlerts,c=Object(s.useMemo)((()=>t.list()),[t]),{status:d,setStatus:b,lastResponse:p,setLastResponse:E}=function(){const e=ie();!function(e){const t=Object(u.useHistory)();Object(s.useEffect)((()=>{const a=Object(m.createKbnUrlStateStorage)({history:t,useHash:!1,useHashQuery:!1}),{start:l,stop:s}=function(e,t){return Object(m.syncState)({storageKey:"_a",stateContainer:{...e,set:t=>{e.set({...se,...t})}},stateStorage:t})}(e,a);return l(),function(e,t){const a=t.get("_a");if(a){const t={...se,...a};e.set(t)}else e.set(se);t.set("_a",e.get())}(e,a),s}),[e,t])}(e);const{setLastResponse:t,setStatus:a}=e.transitions,{lastResponse:l,status:r}=Object(m.useContainerSelector)(e,(e=>e));return{lastResponse:l,status:r,setLastResponse:t,setStatus:a}}(),[g,y]=Object(s.useState)(!1),[v,f]=Object(s.useState)(new Date),{ruleTypes:x}=Object(ae.useLoadRuleTypes)({filteredRuleTypes:c}),h=[...x.values()].some((e=>{var t;return null===(t=e.authorizedConsumers[le.ALERTS_FEATURE_ID])||void 0===t?void 0:t.all}));Object(ue.a)([{text:l.i18n.translate("xpack.observability.breadcrumbs.alertsLinkText",{defaultMessage:"Alerts"}),href:a.basePath.prepend("/app/observability/alerts")},{text:ce}]);const S=Object(s.useMemo)((()=>i.getAddAlertFlyout({consumer:le.ALERTS_FEATURE_ID,onClose:()=>{y(!1)},onSave:()=>(f(new Date),Promise.resolve()),filteredRuleTypes:c})),[c]),j=Object(s.useMemo)((()=>r.a.createElement(r.a.Fragment,null,r.a.createElement(B.EuiFlexGroup,{direction:"column",gutterSize:"s"},r.a.createElement(B.EuiFlexItem,null,i.getRulesList({filteredRuleTypes:c,showActionFilter:!1,showCreateRuleButton:!1,ruleDetailsRoute:"alerts/rules/:ruleId",statusFilter:d,onStatusFilterChange:b,lastResponseFilter:p,onLastResponseFilterChange:E,refresh:v,rulesListKey:"observability_rulesListColumns",visibleColumns:de}))))),[i,c,d,b,p,E,v]);return r.a.createElement(e,{pageHeader:{pageTitle:r.a.createElement(r.a.Fragment,null,oe),rightSideItems:[r.a.createElement(B.EuiButton,{fill:!0,iconType:"plusInCircle",key:"create-alert","data-test-subj":"createRuleButton",disabled:!h,onClick:()=>y(!0)},r.a.createElement(te.FormattedMessage,{id:"xpack.observability.rules.addRuleButtonLabel",defaultMessage:"Create rule"})),r.a.createElement(B.EuiButtonEmpty,{href:o,target:"_blank",iconType:"help","data-test-subj":"documentationLink"},r.a.createElement(te.FormattedMessage,{id:"xpack.observability.rules.docsLinkText",defaultMessage:"Documentation"}))]}},j,g&&S)}function be(){return r.a.createElement(ne,{value:re},r.a.createElement(me,null))}var pe=a(36),Ee=a(152);l.i18n.translate("xpack.observability.ruleDetails.tagsTitle",{defaultMessage:"Tags"});const ge=l.i18n.translate("xpack.observability.ruleDetails.lastUpdatedMessage",{defaultMessage:"Last updated"}),ye=l.i18n.translate("xpack.observability.ruleDetails.byWord",{defaultMessage:"by"}),ve=l.i18n.translate("xpack.observability.ruleDetails.onWord",{defaultMessage:"on"}),fe=l.i18n.translate("xpack.observability.ruleDetails.createdWord",{defaultMessage:"Created"}),xe=(e,t,a)=>l.i18n.translate("xpack.observability.rules.deleteSelectedIdsConfirmModal.deleteButtonLabel",{defaultMessage:"Delete {numIdsToDelete, plural, one {{singleTitle}} other {# {multipleTitle}}} ",values:{numIdsToDelete:e,singleTitle:t,multipleTitle:a}}),he=l.i18n.translate("xpack.observability.rules.deleteSelectedIdsConfirmModal.cancelButtonLabel",{defaultMessage:"Cancel"}),Te=l.i18n.translate("xpack.observability.ruleDetails.ruleStatusLicenseError",{defaultMessage:"License Error"}),Se={ok:l.i18n.translate("xpack.observability.ruleDetails.ruleStatusOk",{defaultMessage:"Ok"}),active:l.i18n.translate("xpack.observability.ruleDetails.ruleStatusActive",{defaultMessage:"Active"}),error:l.i18n.translate("xpack.observability.ruleDetails.ruleStatusError",{defaultMessage:"Error"}),pending:l.i18n.translate("xpack.observability.ruleDetails.ruleStatusPending",{defaultMessage:"Pending"}),unknown:l.i18n.translate("xpack.observability.ruleDetails.ruleStatusUnknown",{defaultMessage:"Unknown"}),warning:l.i18n.translate("xpack.observability.ruleDetails.ruleStatusWarning",{defaultMessage:"Warning"})};function je({idsToDelete:e,apiDeleteCall:t,onDeleted:a,onCancel:n,onErrors:i,singleTitle:u,multipleTitle:o,setIsLoadingState:c}){const[d,m]=Object(s.useState)(!1);Object(s.useEffect)((()=>{m(e.length>0)}),[e]);const{http:b,notifications:{toasts:p}}=Object(O.a)().services,E=e.length;return d?r.a.createElement(B.EuiConfirmModal,{buttonColor:"danger","data-test-subj":"deleteIdsConfirmation",title:xe(E,u,o),onCancel:()=>{m(!1),n()},onConfirm:async()=>{m(!1),c(!0);const{successes:s,errors:r}=await t({ids:e,http:b});c(!1);const n=s.length,d=r.length;n>0&&p.addSuccess(((e,t,a)=>l.i18n.translate("xpack.observability.rules.deleteSelectedIdsSuccessNotification.descriptionText",{defaultMessage:"Deleted {numSuccesses, number} {numSuccesses, plural, one {{singleTitle}} other {{multipleTitle}}}",values:{numSuccesses:e,singleTitle:t,multipleTitle:a}}))(n,u,o)),d>0&&(p.addDanger(((e,t,a)=>l.i18n.translate("xpack.observability.rules.deleteSelectedIdsErrorNotification.descriptionText",{defaultMessage:"Failed to delete {numErrors, number} {numErrors, plural, one {{singleTitle}} other {{multipleTitle}}}",values:{numErrors:e,singleTitle:t,multipleTitle:a}}))(d,u,o)),await i()),await a(s)},cancelButtonText:he,confirmButtonText:xe(E,u,o)},((e,t,a)=>l.i18n.translate("xpack.observability.rules.deleteSelectedIdsConfirmModal.descriptionText",{defaultMessage:"You can't recover {numIdsToDelete, plural, one {a deleted {singleTitle}} other {deleted {multipleTitle}}}.",values:{numIdsToDelete:e,singleTitle:t,multipleTitle:a}}))(E,u,o)):null}function ke({size:e}){return r.a.createElement(B.EuiFlexGroup,{"data-test-subj":"centerJustifiedSpinner",justifyContent:"center"},r.a.createElement(B.EuiFlexItem,{grow:!1},r.a.createElement(B.EuiLoadingSpinner,{size:e||"xl"})))}var Oe=a(114);function Re({ruleId:e,http:t}){const[a,r]=Object(s.useState)({isRuleLoading:!0,rule:void 0,errorRule:void 0}),n=Object(s.useCallback)((async()=>{try{const a=await Object(ae.loadRule)({http:t,ruleId:e});r((e=>({...e,isRuleLoading:!1,rule:a})))}catch(e){r((t=>{return{...t,isRuleLoading:!1,errorRule:(a=e instanceof Error?e.message:"string"==typeof e?e:"",l.i18n.translate("xpack.observability.ruleDetails.ruleLoadError",{defaultMessage:"Unable to load rule. Reason: {message}",values:{message:a}}))};var a}))}}),[e,t]);return Object(s.useEffect)((()=>{n()}),[n]),{...a,reloadRule:n}}var Me=a(22),Ce=a.n(Me);function De(e){switch(e){case"active":return"success";case"error":return"danger";case"ok":return"primary";case"pending":return"accent";default:return"subdued"}}function Fe({rule:e}){const{triggersActionsUi:t}=Object(O.a)().services;return r.a.createElement(r.a.Fragment,null,r.a.createElement(B.EuiFlexGroup,{alignItems:"center"},r.a.createElement(B.EuiFlexItem,{grow:!1,"data-test-subj":"ruleName"},e.name)),r.a.createElement(B.EuiFlexItem,{grow:!1},r.a.createElement(B.EuiSpacer,{size:"m"}),r.a.createElement(B.EuiText,{size:"xs"},r.a.createElement(B.EuiBadge,{color:De(e.executionStatus.status)},e.executionStatus.status.charAt(0).toUpperCase()+e.executionStatus.status.slice(1))),r.a.createElement(B.EuiSpacer,{size:"m"})),r.a.createElement(B.EuiFlexGroup,{direction:"column",alignItems:"flexStart"},r.a.createElement(B.EuiFlexItem,{component:"span",grow:!1},r.a.createElement(B.EuiText,{color:"subdued",size:"xs"},r.a.createElement("b",null,ge)," ",ye," ",e.updatedBy," ",ve," ",Ce()(e.updatedAt).format("ll"),"  ",r.a.createElement("b",null,fe)," ",ye," ",e.createdBy," ",ve," ",Ce()(e.createdAt).format("ll"))),r.a.createElement(B.EuiSpacer,{size:"xs"})),e.tags.length>0&&t.getRuleTagBadge({tagsOutPopover:!0,tags:e.tags}),r.a.createElement(B.EuiSpacer,{size:"xs"}))}var Pe=a(102);function Ie(){var e;const{http:t,triggersActionsUi:{alertsTableConfigurationRegistry:a,ruleTypeRegistry:n,getEditAlertFlyout:i,getRuleEventLogList:o,getAlertsStateTable:c,getRuleAlertsSummary:m,getRuleStatusPanel:b,getRuleDefinition:p},application:{capabilities:E,navigateToUrl:g},notifications:{toasts:y}}=Object(d.useKibana)().services,{ruleId:v}=Object(u.useParams)(),{ObservabilityPageTemplate:x,observabilityRuleTypeRegistry:h}=Object(T.a)(),S=Object(u.useHistory)(),j=Object(u.useLocation)(),k=Object(s.useMemo)((()=>h.list()),[h]),{isRuleLoading:O,rule:R,errorRule:M,reloadRule:C}=Re({ruleId:v,http:t}),{ruleTypes:D}=Object(ae.useLoadRuleTypes)({filteredRuleTypes:k}),[F,P]=Object(s.useState)((()=>{var e;const t=(null===(e=Object(pe.b)(j.search))||void 0===e?void 0:e.tabId)||Oe.b;return[Oe.b,Oe.a].includes(t)?t:Oe.b})),[I,A]=Object(s.useState)(""),[L,w]=Object(s.useState)(),[z,N]=Object(s.useState)([]),[_,U]=Object(s.useState)(!1),[H,q]=Object(s.useState)(!1),[G,K]=Object(s.useState)(!1),[W,V]=Object(s.useState)(),$=Object(s.useRef)([{query:`kibana.alert.rule.uuid: ${v}`,language:"kuery"}]),J=Object(s.useRef)([]);Object(s.useEffect)((()=>{(async()=>{J.current=await Object(ae.getNotifyWhenOptions)()})()}),[]);const Y=Object(s.useCallback)((()=>{K(!1),R&&N([R.id])}),[R]),Q=Object(s.useCallback)((()=>{K(!1),q(!0)}),[]);Object(s.useEffect)((()=>{if(D.length&&R){const e=D.find((e=>e.id===R.ruleTypeId));w(e),R.consumer===le.ALERTS_FEATURE_ID&&e&&e.producer?A(e.producer):A(R.consumer)}}),[R,D]),Object(ue.a)([{text:l.i18n.translate("xpack.observability.breadcrumbs.alertsLinkText",{defaultMessage:"Alerts"}),href:t.basePath.prepend(Pe.a.observability.alerts)},{href:t.basePath.prepend(Pe.a.observability.rules),text:ce},{text:R&&R.name}]);const X=(e=>{var t;return null==e||null===(t=e.actions)||void 0===t?void 0:t.execute})(E),Z=R&&function(e,t){var a,l;return null!==(a=null==t||null===(l=t.authorizedConsumers[e.consumer])||void 0===l?void 0:l.all)&&void 0!==a&&a}(R,L)&&(X||!X&&0===R.actions.length),ee=Z&&!!n.has(R.ruleTypeId)&&!n.get(R.ruleTypeId).requiresAppContext,te=[{id:Oe.b,name:l.i18n.translate("xpack.observability.ruleDetails.rule.eventLogTabText",{defaultMessage:"Execution history"}),"data-test-subj":"eventLogListTab",content:r.a.createElement(B.EuiFlexGroup,{style:{minHeight:600},direction:"column"},r.a.createElement(B.EuiFlexItem,null,o({ruleId:null==R?void 0:R.id,ruleType:L})))},{id:Oe.a,name:l.i18n.translate("xpack.observability.ruleDetails.rule.alertsTabText",{defaultMessage:"Alerts"}),"data-test-subj":"ruleAlertListTab",content:r.a.createElement(r.a.Fragment,null,r.a.createElement(B.EuiSpacer,{size:"m"}),r.a.createElement(Ee.a,{appName:Oe.c,setEsQuery:V,urlStorageKey:Oe.e,queries:$.current}),r.a.createElement(B.EuiSpacer,{size:"s"}),r.a.createElement(B.EuiFlexGroup,{style:{minHeight:450},direction:"column"},r.a.createElement(B.EuiFlexItem,null,W&&I&&r.a.createElement(c,{alertsTableConfigurationRegistry:a,configurationId:f.observabilityFeatureId,id:Oe.d,flyoutSize:"s",featureIds:[I],query:W,showExpandToDetails:!1}))))}];if(_||O)return r.a.createElement(ke,null);if(!R||M)return r.a.createElement(B.EuiPanel,null,r.a.createElement(B.EuiEmptyPrompt,{iconType:"alert",color:"danger",title:r.a.createElement("h2",null,l.i18n.translate("xpack.observability.ruleDetails.errorPromptTitle",{defaultMessage:"Unable to load rule details"})),body:r.a.createElement("p",null,l.i18n.translate("xpack.observability.ruleDetails.errorPromptBody",{defaultMessage:"There was an error loading the rule details."}))}));const se=(null===(e=R.executionStatus.error)||void 0===e?void 0:e.reason)===le.RuleExecutionStatusErrorReasons.License?Te:Se[R.executionStatus.status];return r.a.createElement(x,{"data-test-subj":"ruleDetails",pageHeader:{pageTitle:r.a.createElement(Fe,{rule:R}),bottomBorder:!1,rightSideItems:ee?[r.a.createElement(B.EuiFlexGroup,{direction:"rowReverse",alignItems:"flexStart"},r.a.createElement(B.EuiFlexItem,null,r.a.createElement(B.EuiPopover,{id:"contextRuleEditMenu",isOpen:G,closePopover:()=>K(!1),button:r.a.createElement(B.EuiButton,{fill:!0,iconSide:"right",onClick:()=>K((e=>!e)),iconType:"arrowDown","data-test-subj":"actions"},l.i18n.translate("xpack.observability.ruleDetails.actionsButtonLabel",{defaultMessage:"Actions"}))},r.a.createElement(B.EuiFlexGroup,{direction:"column",alignItems:"flexStart"},r.a.createElement(B.EuiButtonEmpty,{"data-test-subj":"editRuleButton",size:"s",iconType:"pencil",onClick:Q},r.a.createElement(B.EuiSpacer,{size:"s"}),r.a.createElement(B.EuiText,{size:"s"},l.i18n.translate("xpack.observability.ruleDetails.editRule",{defaultMessage:"Edit rule"}))),r.a.createElement(B.EuiSpacer,{size:"s"}),r.a.createElement(B.EuiButtonEmpty,{size:"s",iconType:"trash",color:"danger",onClick:Y,"data-test-subj":"deleteRuleButton"},r.a.createElement(B.EuiText,{size:"s"},l.i18n.translate("xpack.observability.ruleDetails.deleteRule",{defaultMessage:"Delete rule"}))),r.a.createElement(B.EuiSpacer,{size:"s"})))),r.a.createElement(B.EuiSpacer,{size:"s"}))]:[]}},r.a.createElement(B.EuiFlexGroup,{wrap:!0,gutterSize:"m"},r.a.createElement(B.EuiFlexItem,{style:{minWidth:350}},b({rule:R,isEditable:ee,requestRefresh:C,healthColor:De(R.executionStatus.status),statusMessage:se})),r.a.createElement(B.EuiSpacer,{size:"m"}),r.a.createElement(B.EuiFlexItem,{style:{minWidth:350}},m({rule:R,filteredRuleTypes:k})),r.a.createElement(B.EuiSpacer,{size:"m"}),p({rule:R,onEditRule:()=>C()})),r.a.createElement(B.EuiSpacer,{size:"l"}),r.a.createElement(B.EuiTabbedContent,{"data-test-subj":"ruleDetailsTabbedContent",tabs:te,selectedTab:te.find((e=>e.id===F)),onTabClick:e=>{var t;t=e.id,P(t),(e=>{const t=e.tabId===Oe.a?{...Object(pe.b)(j.search),...e}:{tabId:Oe.b};S.replace({...j,search:Object(pe.a)(t)})})({tabId:t})}}),H&&i({initialRule:R,onClose:()=>{q(!1)},onSave:C}),r.a.createElement(je,{onDeleted:()=>{N([]),g(t.basePath.prepend(Pe.a.observability.rules))},onErrors:()=>{N([]),g(t.basePath.prepend(Pe.a.observability.rules))},onCancel:()=>N([]),apiDeleteCall:ae.deleteRules,idsToDelete:z,singleTitle:R.name,multipleTitle:R.name,setIsLoadingState:()=>U(!0)}),M&&y.addDanger({title:M}))}var Ae=a(82),Le=a(89);function we({alert:e}){const{http:t,cases:{hooks:{getUseCasesAddToExistingCaseModal:a}},triggersActionsUi:{getEditAlertFlyout:n,getRuleSnoozeModal:i}}=Object(O.a)().services,{rule:u,reloadRule:o}=Re({http:t,ruleId:(null==e?void 0:e.fields[Le.H])||""}),[c,d]=Object(s.useState)(!1),[m,b]=Object(s.useState)(!1),[p,E]=Object(s.useState)(!1),g=a(),y=e&&u?[{alertId:(null==e?void 0:e.fields[Le.V])||"",index:".internal.alerts-observability.metrics.alerts-*",rule:{id:u.id,name:u.name},type:Ae.CommentType.alert}]:[];return r.a.createElement(r.a.Fragment,null,r.a.createElement(B.EuiPopover,{isOpen:c,closePopover:()=>d(!1),button:r.a.createElement(B.EuiButton,{fill:!0,iconType:"arrowDown",iconSide:"right",onClick:()=>d(!c),"data-test-subj":"alert-details-header-actions-menu-button"},l.i18n.translate("xpack.observability.alertDetails.actionsButtonLabel",{defaultMessage:"Actions"}))},r.a.createElement(B.EuiFlexGroup,{direction:"column",alignItems:"flexStart"},r.a.createElement(B.EuiButtonEmpty,{size:"s",color:"text",disabled:!(null!=e&&e.fields[Le.H]),onClick:()=>{d(!1),b(!0)},"data-test-subj":"view-rule-details-button"},r.a.createElement(B.EuiText,{size:"s"},l.i18n.translate("xpack.observability.alertDetails.viewRuleDetails",{defaultMessage:"View rule details"}))),r.a.createElement(B.EuiButtonEmpty,{size:"s",color:"text",onClick:()=>{d(!1),E(!0)},"data-test-subj":"snooze-rule-button"},r.a.createElement(B.EuiText,{size:"s"},l.i18n.translate("xpack.observability.alertDetails.editSnoozeRule",{defaultMessage:"Snooze the rule"}))),r.a.createElement(B.EuiButtonEmpty,{size:"s",color:"text",onClick:()=>{d(!1),g.open({attachments:y})},"data-test-subj":"add-to-case-button"},r.a.createElement(B.EuiText,{size:"s"},l.i18n.translate("xpack.observability.alertDetails.addToCase",{defaultMessage:"Add to case"}))))),u&&m?n({initialRule:u,onClose:()=>{b(!1)},onSave:o}):null,u&&p?i({rule:u,onClose:()=>E(!1),onRuleChanged:o,onLoading:j.noop}):null)}var ze=a(49),Be=a(115);const Ne="MMM D, YYYY @ HH:mm:ss.SSS";function _e({alert:e}){var t,a,l,s,n;const i=null==e?void 0:e.fields[Le.B];return r.a.createElement("div",{"data-test-subj":"alert-summary-container"},r.a.createElement(B.EuiFlexGroup,null,r.a.createElement(B.EuiFlexItem,null,r.a.createElement(B.EuiTitle,{size:"xxs"},r.a.createElement("h5",null,r.a.createElement(te.FormattedMessage,{id:"xpack.observability.pages.alertDetails.alertSummary.actualValue",defaultMessage:"Actual value"}))),r.a.createElement(B.EuiSpacer,{size:"s"}),r.a.createElement(B.EuiText,{size:"s",color:"subdued"},null!==(t=null==e?void 0:e.fields[Le.e])&&void 0!==t?t:"-")),r.a.createElement(B.EuiFlexItem,null,r.a.createElement(B.EuiTitle,{size:"xxs"},r.a.createElement("h5",null,r.a.createElement(te.FormattedMessage,{id:"xpack.observability.pages.alertDetails.alertSummary.expectedValue",defaultMessage:"Expected value"}))),r.a.createElement(B.EuiSpacer,{size:"s"}),r.a.createElement(B.EuiText,{size:"s",color:"subdued"},null!==(a=null==e?void 0:e.fields[Le.d])&&void 0!==a?a:"-")),r.a.createElement(B.EuiFlexItem,null,r.a.createElement(B.EuiTitle,{size:"xxs"},r.a.createElement("h5",null,r.a.createElement(te.FormattedMessage,{id:"xpack.observability.pages.alertDetails.alertSummary.duration",defaultMessage:"Duration"}))),r.a.createElement(B.EuiSpacer,{size:"s"}),r.a.createElement(B.EuiText,{size:"s",color:"subdued"},Object(ze.a)(Number(null==e?void 0:e.fields[Le.b])))),r.a.createElement(B.EuiFlexItem,null,r.a.createElement(B.EuiTitle,{size:"xxs"},r.a.createElement("h5",null,r.a.createElement(te.FormattedMessage,{id:"xpack.observability.pages.alertDetails.alertSummary.alertStatus",defaultMessage:"Status"}))),r.a.createElement(B.EuiSpacer,{size:"s"}),null!=e&&e.fields[Le.L]?r.a.createElement(Be.a,{textSize:"s",alertStatus:(null==e?void 0:e.fields[Le.L])===Le.M?Le.M:Le.N}):r.a.createElement("div",{"data-test-subj":"noAlertStatus"},"-"))),r.a.createElement(B.EuiSpacer,{size:"m"}),r.a.createElement(B.EuiFlexGroup,null,r.a.createElement(B.EuiFlexItem,null,r.a.createElement(B.EuiTitle,{size:"xxs"},r.a.createElement("h5",null,r.a.createElement(te.FormattedMessage,{id:"xpack.observability.pages.alertDetails.alertSummary.source",defaultMessage:"Source"}))),r.a.createElement("div",null,r.a.createElement(B.EuiSpacer,{size:"s"}),"-")),r.a.createElement(B.EuiFlexItem,null,r.a.createElement(B.EuiTitle,{size:"xxs"},r.a.createElement("h5",null,r.a.createElement(te.FormattedMessage,{id:"xpack.observability.pages.alertDetails.alertSummary.started",defaultMessage:"Started"}))),r.a.createElement(B.EuiSpacer,{size:"s"}),r.a.createElement(B.EuiText,{size:"s",color:"subdued"},Ce()(null==e||null===(l=e.fields[Le.K])||void 0===l?void 0:l.toString()).format(Ne))),r.a.createElement(B.EuiFlexItem,null,r.a.createElement(B.EuiTitle,{size:"xxs"},r.a.createElement("h5",null,r.a.createElement(te.FormattedMessage,{id:"xpack.observability.pages.alertDetails.alertSummary.lastStatusUpdate",defaultMessage:"Last status update"}))),r.a.createElement(B.EuiSpacer,{size:"s"}),r.a.createElement(B.EuiText,{size:"s",color:"subdued"},Ce()(null==e||null===(s=e.fields[Le.fb])||void 0===s?void 0:s.toString()).fromNow(),", ",Ce()(null==e||null===(n=e.fields[Le.fb])||void 0===n?void 0:n.toString()).format(Ne))),r.a.createElement(B.EuiFlexItem,null,r.a.createElement(B.EuiTitle,{size:"xxs"},r.a.createElement("h5",null,r.a.createElement(te.FormattedMessage,{id:"xpack.observability.pages.alertDetails.alertSummary.ruleTags",defaultMessage:"Rule Tags"}))),r.a.createElement(B.EuiSpacer,{size:"s"}),r.a.createElement("div",null,i&&i.length>0?r.a.createElement(B.EuiBadgeGroup,null,i.map(((e,t)=>r.a.createElement(B.EuiBadge,{"data-test-subj":`ruleTagBadge-${e}`,key:t,color:"hollow"},r.a.createElement(B.EuiText,{size:"s"},e))))):r.a.createElement("div",{"data-test-subj":"noRuleTags"},"-")))))}var Ue=a(116),He=function(){const{ObservabilityPageTemplate:e}=Object(T.a)();return r.a.createElement(e,{"data-test-subj":"pageNotFound"},r.a.createElement(B.EuiCallOut,{color:"warning",iconType:"iInCircle",title:r.a.createElement(te.FormattedMessage,{id:"xpack.observability.notFoundPage.title",defaultMessage:"Page Not Found"}),"data-test-subj":"observabilityPageNotFoundBanner"},r.a.createElement("p",{"data-test-subj":"observabilityPageNotFoundBannerText"},r.a.createElement(te.FormattedMessage,{id:"xpack.observability.notFoundPage.bannerText",defaultMessage:"The Observability application doesn't recognize this route"}))))};function qe(){const{http:e,cases:{helpers:{canUseCases:t},ui:{getCasesContext:a}}}=Object(O.a)().services,{ObservabilityPageTemplate:s,config:n}=Object(T.a)(),{alertId:i}=Object(u.useParams)(),[o,c]=M(i),d=a(),m=t();return Object(ue.a)([{href:e.basePath.prepend(Pe.a.observability.alerts),text:l.i18n.translate("xpack.observability.breadcrumbs.alertsLinkText",{defaultMessage:"Alerts"})}]),o?r.a.createElement(ke,null):c&&!Object(Ue.a)(c,n)?r.a.createElement(He,null):o||c?r.a.createElement(s,{pageHeader:{pageTitle:r.a.createElement(Ge,{title:null==c?void 0:c.reason,active:Boolean(null==c?void 0:c.active)}),rightSideItems:[r.a.createElement(d,{owner:[f.observabilityFeatureId],permissions:m,features:{alerts:{sync:!1}}},r.a.createElement(we,{alert:c}))],bottomBorder:!1},"data-test-subj":"alertDetails"},r.a.createElement(_e,{alert:c})):r.a.createElement(B.EuiPanel,{"data-test-subj":"alertDetailsError"},r.a.createElement(B.EuiEmptyPrompt,{iconType:"alert",color:"danger",title:r.a.createElement("h2",null,l.i18n.translate("xpack.observability.alertDetails.errorPromptTitle",{defaultMessage:"Unable to load alert details"})),body:r.a.createElement("p",null,l.i18n.translate("xpack.observability.alertDetails.errorPromptBody",{defaultMessage:"There was an error loading the alert details."}))}))}function Ge({title:e,active:t}){const a=t?l.i18n.translate("xpack.observability.alertDetails.alertActiveState",{defaultMessage:"Active"}):l.i18n.translate("xpack.observability.alertDetails.alertRecoveredState",{defaultMessage:"Recovered"});return r.a.createElement("div",{"data-test-subj":"page-title-container"},e,r.a.createElement(B.EuiFlexGroup,null,r.a.createElement(B.EuiFlexItem,null,r.a.createElement("div",null,"boolean"==typeof t?r.a.createElement(B.EuiBadge,{color:"#BD271E","data-test-subj":"page-title-active-badge"},a):null))))}var Ke=a(48);function We({to:e}){return Object(u.useHistory)().replace(e),null}const Ve={"/":{handler:()=>r.a.createElement(We,{to:"/overview"}),params:{},exact:!0},"/landing":{handler:()=>r.a.createElement(We,{to:"/overview"}),params:{},exact:!0},"/overview":{handler:({query:e})=>r.a.createElement(Ke.b,null,r.a.createElement(J.b,null)),params:{},exact:!0},[f.casesPath]:{handler:()=>r.a.createElement(v.TrackApplicationView,{viewId:A.a.cases},r.a.createElement(Q,null)),params:{},exact:!1},"/alerts":{handler:()=>r.a.createElement(v.TrackApplicationView,{viewId:A.a.alerts},r.a.createElement(X.a,null)),params:{},exact:!0},"/exploratory-view/":{handler:()=>r.a.createElement(ee.a,null),params:{query:E.partial({rangeFrom:E.string,rangeTo:E.string,refreshPaused:Z.pipe(E.boolean),refreshInterval:Z.pipe(E.number)})},exact:!0},"/alerts/rules":{handler:()=>r.a.createElement(v.TrackApplicationView,{viewId:A.a.rules},r.a.createElement(be,null)),params:{},exact:!0},"/alerts/rules/:ruleId":{handler:()=>r.a.createElement(Ie,null),params:{},exact:!0},"/alerts/:alertId":{handler:()=>r.a.createElement(qe,null),params:{},exact:!0}};function $e(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(u.Switch,null,Object.keys(Ve).map((e=>{const t=e,{handler:a,exact:l}=Ve[t];return r.a.createElement(u.Route,{key:t,path:t,exact:l,component:()=>{const e=function(e){const t=Object(u.useLocation)(),a=Object(u.useParams)(),l=function(e){const t=new URLSearchParams(e.search),a={};return t.forEach(((e,t)=>{a[t]=e})),a}(t),{query:s,path:r}=Ve[e].params,n={queryRt:s?E.exact(s):E.strict({}),pathRt:r?E.exact(r):E.strict({})},i=n.queryRt.decode(l),o=n.pathRt.decode(a);return Object(g.isLeft)(i)&&console.error(y.PathReporter.report(i)[0]),Object(g.isLeft)(o)&&console.error(y.PathReporter.report(o)[0]),{query:Object(g.isLeft)(i)?{}:i.right,path:Object(g.isLeft)(o)?{}:o.right}}(t);return a(e)}})}))))}const Je=({core:e,config:t,plugins:a,appMountParameters:s,observabilityRuleTypeRegistry:n,ObservabilityPageTemplate:E,usageCollection:g,isDev:y})=>{var v;const{element:f,history:x,theme$:h}=s,T=e.i18n,S=e.uiSettings.get("theme:darkMode");e.chrome.setHelpExtension({appName:l.i18n.translate("xpack.observability.feedbackMenu.appName",{defaultMessage:"Observability"}),links:[{linkType:"discuss",href:"https://ela.st/observability-discuss"}]}),f.classList.add(o.APP_WRAPPER_CLASS);const j=null!==(v=null==g?void 0:g.components.ApplicationUsageTrackingProvider)&&void 0!==v?v:r.a.Fragment;return i.a.render(r.a.createElement(j,null,r.a.createElement(d.KibanaThemeProvider,{theme$:h},r.a.createElement(d.KibanaContextProvider,{services:{...e,...a,storage:new m.Storage(localStorage),isDev:y}},r.a.createElement(p.a.Provider,{value:{config:t,appMountParameters:s,observabilityRuleTypeRegistry:n,ObservabilityPageTemplate:E}},r.a.createElement(u.Router,{history:x},r.a.createElement(c.EuiThemeProvider,{darkMode:S},r.a.createElement(T.Context,null,r.a.createElement(d.RedirectAppLinks,{application:e.application,className:o.APP_WRAPPER_CLASS},r.a.createElement(b.b,null,r.a.createElement($e,null)))))))))),f),()=>{i.a.unmountComponentAtNode(f)}}}}]);