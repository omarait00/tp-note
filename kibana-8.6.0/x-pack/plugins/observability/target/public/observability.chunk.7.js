/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.observability_bundle_jsonpfunction=window.observability_bundle_jsonpfunction||[]).push([[7,15],{108:function(e,l,t){"use strict";t.d(l,"a",(function(){return c}));var n=t(13),a=t(0),i=t(119),o=t.n(i),u=t(37),r=t(7);const c=({sourceField:e,dataViewTitle:l,query:t="",filters:i,time:c,label:s,keepHistory:d,cardinalityField:b})=>{const[p,f]=Object(a.useState)(t),[m,g]=Object(a.useState)([]),{from:h,to:v}=null!=c?c:{};o()((()=>{f(t)}),350,[t]),Object(a.useEffect)((()=>{t||f(t)}),[t]);const E=((e,l)=>{if(!l)return"";let t="";return t=e===r.o?`*.${l.toLowerCase()}.*`:l[0].toLowerCase()===l[0]?`(${l}|${Object(n.capitalize)(l)}).*`:`(${l}|${l.toLowerCase()}).*`,t})(e,t),{data:y,loading:S}=Object(u.b)(Object(u.a)({index:l,body:{query:{bool:{filter:[...null!=i?i:[],...h&&v?[{range:{"@timestamp":{gte:h,lte:v}}}]:[]]}},size:0,aggs:{values:{terms:{field:e,size:50,...t?{include:E}:{}},...b?{aggs:{count:{cardinality:{field:b}}}}:{}}}}}),[p,h,v,JSON.stringify(i),l,e],{name:`get${s.replace(/\s/g,"")}ValuesList`});return Object(a.useEffect)((()=>{var e,l;const t=null==y||null===(e=y.aggregations)||void 0===e?void 0:e.values.buckets,a=null!==(l=null==t?void 0:t.map((({key:e,doc_count:l,count:t})=>t?{count:t.value,label:String(e)}:{count:l,label:String(e)})))&&void 0!==l?l:[];g(d?e=>((e,l)=>Object(n.uniqBy)([...e,...l],"label"))(a,e):a)}),[y,d,S,t]),{values:m,loading:S}}},109:function(e,l,t){"use strict";t.r(l),t.d(l,"FieldValueSelection",(function(){return b}));var n=t(17),a=t.n(n),i=t(0),o=t.n(i),u=t(5),r=t(1),c=t(13);const s=t(45).euiStyled.div`
  border-radius: ${({theme:e})=>e.eui.euiBorderRadius};
  background: ${({theme:e})=>e.eui.euiColorLightShade};
  padding: 0 ${({theme:e})=>e.eui.euiSizeXS};
`,d=(e,l,t,n)=>{const a={};return null==e||e.forEach((({label:e,count:l})=>{a[e]=l})),Object.entries(a).map((([e,a])=>({label:e,append:n?o.a.createElement(s,null,o.a.createElement(u.EuiText,{size:"xs"},a)):null,...null!=l&&l.includes(e)?{checked:"on"}:{},...null!=t&&t.includes(e)?{checked:"off"}:{}})))};function b({fullWidth:e,label:l,loading:t,query:n,setQuery:a,button:s,width:b,forceOpen:g,setForceOpen:h,anchorPosition:v,singleSelection:E,asFilterButton:y,showCount:S=!0,values:w=[],selectedValue:j,excludedValue:O,allowExclusions:C=!0,compressed:x=!0,useLogicalAND:k,showLogicalConditionSwitch:F=!1,onChange:L}){const{euiTheme:V}=Object(u.useEuiTheme)(),[_,P]=Object(i.useState)((()=>d(w,j,O,S))),[B,A]=Object(i.useState)(!1),[T,z]=Object(i.useState)(k);Object(i.useEffect)((()=>{z(k)}),[k]),Object(i.useEffect)((()=>{P(d(w,j,O,S))}),[w,j,S,O]);const $=()=>{A(!B)},q=o.a.createElement(u.EuiButton,{style:b?{width:b}:{},size:"m",color:"text",iconType:"arrowDown",iconSide:"right",onClick:$,"data-test-subj":"fieldValueSelectionBtn",fullWidth:e},l),W=(j||[]).length+(O||[]).length,D=o.a.createElement(u.EuiFilterButton,{"aria-label":r.i18n.translate("xpack.observability.filterButton.label",{defaultMessage:"expands filter group for {label} filter",values:{label:l}}),hasActiveFilters:W>0,iconType:"arrowDown",numActiveFilters:W,numFilters:_.length,onClick:$},l),N=()=>{const e=(null!=_?_:[]).filter((e=>"on"===(null==e?void 0:e.checked))).map((({label:e})=>e)),l=(null!=_?_:[]).filter((e=>"off"===(null==e?void 0:e.checked))).map((({label:e})=>e)),t=(null!=j?j:[]).length>0||(null!=O?O:[]).length>0;return Object(c.isEqual)(null!=j?j:[],e)&&Object(c.isEqual)(null!=O?O:[],l)&&!(T!==k&&t)};return o.a.createElement(p,null,o.a.createElement(u.EuiPopover,{id:"popover",panelPaddingSize:"none",button:s||(y?D:q),isOpen:B||g,closePopover:()=>{A(!1),null==h||h(!1)},anchorPosition:v,style:{width:"100%"}},o.a.createElement(u.EuiSelectable,{searchable:!0,singleSelection:E,searchProps:{placeholder:r.i18n.translate("xpack.observability.fieldValueSelection.placeholder",{defaultMessage:"Filter {label}",values:{label:l}}),compressed:x,onInput:e=>{a(e.target.value)},"data-test-subj":"suggestionInputField"},listProps:{onFocusBadge:!1},options:_,onChange:e=>{P(e)},allowExclusions:C,isLoading:t&&!n&&0===_.length},((e,a)=>o.a.createElement("div",{style:{width:240}},o.a.createElement(u.EuiPopoverTitle,{paddingSize:"s"},a),e,t&&n&&o.a.createElement(u.EuiText,{className:"eui-textCenter",color:"subdued"},r.i18n.translate("xpack.observability.fieldValueSelection.loading",{defaultMessage:"Loading"})," ",o.a.createElement(u.EuiLoadingSpinner,{size:"m"})),o.a.createElement(u.EuiPopoverFooter,{paddingSize:"s"},F&&o.a.createElement(o.a.Fragment,null,o.a.createElement(u.EuiSpacer,{size:"xs"}),o.a.createElement(f,null,o.a.createElement(m,{label:r.i18n.translate("xpack.observability.fieldValueSelection.logicalAnd",{defaultMessage:"Use logical AND"}),"data-test-subj":"tagsLogicalOperatorSwitch",checked:Boolean(T),compressed:!0,onChange:e=>{z(e.target.checked)},$_css:V.size.s,$_css2:V.colors.subduedText})),o.a.createElement(u.EuiSpacer,{size:"m"})),o.a.createElement(u.EuiButton,{"aria-label":r.i18n.translate("xpack.observability.fieldValueSelection.apply.label",{defaultMessage:"Apply the selected filters for {label}",values:{label:l}}),fill:!0,fullWidth:!0,size:"s",isDisabled:N(),onClick:()=>{const e=_.filter((e=>"on"===(null==e?void 0:e.checked))),l=_.filter((e=>"off"===(null==e?void 0:e.checked)));F?L(Object(c.map)(e,"label"),Object(c.map)(l,"label"),T):L(Object(c.map)(e,"label"),Object(c.map)(l,"label")),A(!1),null==h||h(!1)}},r.i18n.translate("xpack.observability.fieldValueSelection.apply",{defaultMessage:"Apply"}))))))))}l.default=b;const p=a.a.div.withConfig({displayName:"Wrapper",componentId:"sc-o6ohvj-0"})(["&&&{div.euiPopover__anchor{width:100%;.euiButton{width:100%;}}}"]);var f=a()("div").withConfig({displayName:"_StyledDiv",componentId:"sc-o6ohvj-1"})({display:"flex",justifyContent:"flex-end"}),m=a()(u.EuiSwitch).withConfig({displayName:"_StyledEuiSwitch",componentId:"sc-o6ohvj-2"})((e=>({flexDirection:"row-reverse",gap:e.$_css,color:e.$_css2})))},119:function(e,l,t){"use strict";Object.defineProperty(l,"__esModule",{value:!0});var n=t(47),a=t(0),i=n.__importDefault(t(120));l.default=function(e,l,t){void 0===l&&(l=0),void 0===t&&(t=[]);var n=i.default(e,l),o=n[0],u=n[1],r=n[2];return a.useEffect(r,t),[o,u]}},120:function(e,l,t){"use strict";Object.defineProperty(l,"__esModule",{value:!0});var n=t(0);l.default=function(e,l){void 0===l&&(l=0);var t=n.useRef(!1),a=n.useRef(),i=n.useRef(e),o=n.useCallback((function(){return t.current}),[]),u=n.useCallback((function(){t.current=!1,a.current&&clearTimeout(a.current),a.current=setTimeout((function(){t.current=!0,i.current()}),l)}),[l]),r=n.useCallback((function(){t.current=null,a.current&&clearTimeout(a.current)}),[]);return n.useEffect((function(){i.current=e}),[e]),n.useEffect((function(){return u(),r}),[l]),[o,r,u]}},128:function(e,l,t){"use strict";t.r(l),t.d(l,"FieldValueSuggestions",(function(){return f}));var n=t(0),a=t.n(n),i=t(108),o=t(109),u=t(13),r=t(5),c=t(1),s=t(17);const d=(e,l)=>{const t=Array.from(new Set(l&&(null!=e?e:[]).length>0?["ALL_VALUES",...null!=e?e:[]]:e));return(null!=t?t:[]).map((e=>({label:e})))};function b({label:e,selectedValue:l,loading:t,values:i,setQuery:o,usePrependLabel:s=!0,compressed:b=!0,required:f=!0,singleSelection:m=!1,allowAllValuesSelection:g,onChange:h}){const[v,E]=Object(n.useState)((()=>{var e;return d(Object(u.union)(null!==(e=null==i?void 0:i.map((({label:e})=>e)))&&void 0!==e?e:[],null!=l?l:[]),g)}));Object(n.useEffect)((()=>{var e;E(d(Object(u.union)(null!==(e=null==i?void 0:i.map((({label:e})=>e)))&&void 0!==e?e:[],null!=l?l:[]),g))}),[g,l,i]);const y=a.a.createElement(r.EuiComboBox,{fullWidth:!0,singleSelection:!!m&&{asPlainText:!0},compressed:b,placeholder:c.i18n.translate("xpack.observability.fieldValueSelection.placeholder.search",{defaultMessage:"Search {label}",values:{label:e}}),isLoading:t,onSearchChange:e=>{o(e)},options:v,selectedOptions:v.filter((e=>null==l?void 0:l.includes(e.label))),onChange:e=>{h(e.map((({label:e})=>e)))},isInvalid:f&&Object(u.isEmpty)(l)});return s?a.a.createElement(p,null,a.a.createElement(r.EuiFormControlLayout,{fullWidth:!0,prepend:e,compressed:!0},y)):a.a.createElement(r.EuiFormRow,{label:e,display:"center",fullWidth:!0},y)}const p=t.n(s).a.div.withConfig({displayName:"ComboWrapper",componentId:"sc-1ajik3y-0"})(["&&&{.euiFormControlLayout{height:auto;.euiFormControlLayout__prepend{margin:auto;}.euiComboBoxPill{max-width:250px;}.euiComboBox__inputWrap{border-radius:0;}}}"]);function f({fullWidth:e,sourceField:l,label:t,dataViewTitle:u,selectedValue:r,excludedValue:c,filters:s,button:d,time:p,width:f,forceOpen:m,setForceOpen:g,anchorPosition:h,singleSelection:v,compressed:E,asFilterButton:y,usePrependLabel:S,allowAllValuesSelection:w,required:j,allowExclusions:O=!0,cardinalityField:C,inspector:x,asCombobox:k=!0,keepHistory:F=!0,showLogicalConditionSwitch:L,useLogicalAND:V,onChange:_}){const[P,B]=Object(n.useState)(""),{values:A,loading:T}=Object(i.a)({dataViewTitle:u,query:P,sourceField:l,filters:s,time:p,inspector:x,cardinalityField:C,keepHistory:F,label:t}),z=k?b:o.FieldValueSelection;return a.a.createElement(z,{fullWidth:e,singleSelection:v,values:A,label:t,onChange:_,query:P,setQuery:B,loading:T,selectedValue:r,excludedValue:c,button:d,forceOpen:m,setForceOpen:g,anchorPosition:h,width:f,compressed:E,asFilterButton:y,usePrependLabel:S,allowExclusions:O,allowAllValuesSelection:!v&&w,required:j,showLogicalConditionSwitch:L,useLogicalAND:V})}l.default=f}}]);